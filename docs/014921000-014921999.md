# StackOverflow 问答 14921000-14921999

# sql-server - SQL 数据透视嵌套

> ID：14921002
> 
> 赞同：1
> 
> 时间：2013-02-17T12:18:23.677
> 
> 标签：sql-server, excel, tsql, pivot

我正在使用 Sql Server 2008 R2。我的工作是关于商业智能和报告。现在我有一张如下表。

```
声明@t 表（  
 prod_type NVARCHAR(20),  
 周 NVARCHAR(20),  
 COD_ACCT NVARCHAR(20),  
 BBH NVARCHAR(20)  
 );

 插入@t 值（'薪水'，'41306'，'12313'，'Vikas'），  
 （'工资'，'41306'，'311'，'Ramesh'），  
 （'薪水'，'41306'，'55'，'Vicky'），  
 （'薪水'，'41306'，'44'，'Vicky'），  
 （'工资'，'41313'，'33'，'Vikas'），  
 （'薪水'，'41313'，'22'，'Vikas'），  
 （'工资'，'41313'，'11'，'Ramesh'），  
 （'薪水'，'41313'，'99'，'Vicky'），  
 （'薪水'，'41320'，'88'，'Vicky'），  
 （'工资'，'41320'，'76'，'Vikas'），  
 （'薪水'，'41320'，'545'，'Ramesh'），  
 （'储蓄'，'41306'，'3'，'Vicky'），  
 （'储蓄'，'41306'，'27'，'Ramesh'），  
 （'储蓄'，'41306'，'324'，'Ramesh'），  
 （'储蓄'，'41306'，'887'，'Vikas'），  
 （'储蓄'，'41313'，'998'，'Vicky'），  
 （'储蓄'，'41313'，'6754'，'Vikas'），  
 （'储蓄'，'41313'，'3457'，'Ramesh'），  
 （'储蓄'，'41313'，'5434'，'Vicky'），  
 （'储蓄'，'41320'，'6554'，'Ramesh'），  
 （'储蓄'，'41320'，'3322'，'Ramesh'），  
 （“储蓄”、“41320”、“6542”、“维卡斯”）  
 ;
```

现在我想要以下格式的输出 -

```
           工资 ST 储蓄 STT GT

行标签 01-Feb-13 08-Feb-13 15-Feb-13 01-Feb-13 08-Feb-13 15-Feb-13    
拉梅什 1 1 1 3 2 1 2 5 8  
维姬 2 1 1 4 1 2 0 3 7
维卡斯 1 2 1 4 1 1 1 3 7
总计 4 4 3 11 4 4 3 11 22

```

注意 - ST= 工资总额，STT= 储蓄总额，GT= 总计（在 Excel 中的数据透视表中获得）

我现在要做的是将表格放入 Excel 并使用 Excel 中的值中的 COD_ACCT 计数和行中的 BBH 以及 Excel 中枢轴中的列中的 Prod_type 和周进行数据透视。

我可以在 TSql 中做同样的事情吗？它将为我省去所有 Pivot 的麻烦。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:13:55.910

您可以在 SQL Server 2008+ 中使用该[`PIVOT`](http://msdn.microsoft.com/en-us/library/ms177410%28v=sql.105%29.aspx)功能。[`GROUPING SETS`](http://msdn.microsoft.com/en-us/library/bb522495%28v=sql.105%29.aspx)

您的代码将与此类似：

```
select 
  case when bbh is null then 'Grand Total' else bbh end bbh,
  sum([Salary_2013-02-03]) [Salary_2013-02-03], 
  sum([Salary_2013-02-10]) [Salary_2013-02-10], 
  sum([Salary_2013-02-17]) [Salary_2013-02-17],
  sum([Salary_2013-02-03]+[Salary_2013-02-10]+[Salary_2013-02-17]) ST,
  sum([Savings_2013-02-03]) [Savings_2013-02-03],
  sum([Savings_2013-02-10]) [Savings_2013-02-10], 
  sum([Savings_2013-02-17]) [Savings_2013-02-17],
  sum([Savings_2013-02-03]+[Savings_2013-02-10]+[Savings_2013-02-17]) STT
from 
(
  select 
    prod_type +'_'+
    convert(varchar(10), cast(cast(week as int) as datetime), 120) week, 
    cod_acct, 
    bbh
  from t
) src
pivot
(
  count(cod_acct)
  for week in ([Salary_2013-02-03], [Salary_2013-02-10], 
               [Salary_2013-02-17], [Savings_2013-02-03],
               [Savings_2013-02-10], [Savings_2013-02-17])
) piv
group by grouping sets((bbh), ()) 
```

请参阅[SQL Fiddle with Demo](http://www.sqlfiddle.com/#!3/19086/44)。

这给出了结果：

```
|         BBH | SALARY_2013-02-03 | SALARY_2013-02-10 | SALARY_2013-02-17 | ST | SAVINGS_2013-02-03 | SAVINGS_2013-02-10 | SAVINGS_2013-02-17 | STT |
-----------------------------------------------------------------------------------------------------------------------------------------------------
|      Ramesh |                 1 |                 1 |                 1 |  3 |                  2 |                  1 |                  2 |   5 |
|       Vicky |                 2 |                 1 |                 1 |  4 |                  1 |                  2 |                  0 |   3 |
|       Vikas |                 1 |                 2 |                 1 |  4 |                  1 |                  1 |                  1 |   3 |
| Grand Total |                 4 |                 4 |                 3 | 11 |                  4 |                  4 |                  3 |  11 | 
```

# php - PHP：在for循环中只返回一个时间函数

> ID：14921009
> 
> 赞同：0
> 
> 时间：2013-02-17T12:19:27.073
> 
> 标签：php, wordpress, email, for-loop, upload

我有一个`for`循环，在里面我上传了多张图片。上传图片后，我会通过`wp_mail()`.

一切正常，并且也发送电子邮件通知。但是问题是通知电子邮件根据图像计数发送。表示如果 4 比 4 通知电子邮件（因为它在循环中），则上传 1 个图像而不是一封通知电子邮件。但是，我希望通知只发送一次，无论是一张还是 10 张图像。

这是我的整个代码：

```
global $wpdb, $post;
$upload_path = wp_upload_dir();            
$post_id = $post->ID;

$upload_dir = $upload_path['basedir'].'/review-media/'.$post_id.'/'.get_current_user_id().'/';
$thumbnail_dir = $upload_dir.'thumbnail/';
$upload_url = $upload_path['baseurl'].'/review-media/'.$post_id.'/'.get_current_user_id().'/thumbnail/';

self::create_path($thumbnail_dir);

if (isset($_FILES['photo']) === true) {

    $errors = array();            
    $allowed_ext = array('jpg', 'jpeg', 'png', 'gif');

    $files = $_FILES['photo'];

    for($x = 0; $x < count($files['name']); $x++) {

        $file_name = $files['name'][$x]; 
        $file_ext = strtolower(end(explode('.', $file_name)));
        $file_size = $files['size'][$x];
        $file_tmp = $files['tmp_name'][$x];

        if($file_tmp)
        list($img_width, $img_height) = getimagesize($file_tmp);

        $min_img_width = 1;
        $min_img_height = 1;
        $max_img_width = 2000;
        $max_img_height = 2000;

        if (!$file_tmp) {
            $errors[] = '<p>Please select the file</p>';    
        }

        if (($file_tmp) && (($img_width > $max_img_width) || ($img_width < $min_img_width)) && (($img_height > $max_img_height) || ($img_height < $min_img_height))) {
            $errors[] = '<p>Size of <strong>'.$file_name.'</strong> must be within '. $min_img_width .'px to '. $max_img_width .'px</p>';
        }

        if ( ($file_tmp) && (in_array($file_ext, $allowed_ext) === false) ) {                
            $errors[] = '<p>Extension <strong>'.$file_ext.'</strong> not allowed</p>';
            unlink($file_tmp);                                
        }

        if ($file_size > 2097152) {                
            $errors[] = '<p>File <strong>'.$file_name.'</strong> size must be under 2mb</p>';
            unlink($file_tmp);                
        }

        if(empty($errors)) {   

            move_uploaded_file($file_tmp, $upload_dir.$file_name);

            //crop and resize to images and thumbnails
            $target_file = $upload_dir.$file_name; // original file
            $resized_file = $upload_dir.$file_name; // max resized file
            $med_file = $upload_dir.'medium-'.$file_name; // medium resized fiel
            $thumbnail = $thumbnail_dir.$file_name; // thumbnail file
            $large_width = 1024; // upload resize max width
            $large_height = 1024; // upload resize max height
            $thumb_width = 150; // thumbnail width
            $thumb_height = 150; // thumbnail height
            $med_width = $thumb_width * 1.5; // medium resized image width
            $med_height = $thumb_height * 1.5; // medium resized image height

            // resize to maximum width and height
            self::resize_image($target_file, $resized_file, $large_width, $large_height, $file_ext);
            // resize with 1.5 multi of thumb width and height to generate thumbnail
            self::resize_image($target_file, $med_file, $med_width, $med_height, $file_ext);     
            // crop image uisng medium resized image               
            self::crop_thumbnai(file_exists($med_file) ? $med_file : $target_file, $thumbnail, $thumb_width, $thumb_height, $file_ext);

            // delete medium resized file after thumbnail creation.
            if (file_exists($med_file))
                unlink($med_file);

            self::insert_image($file_name);

            //self::get_uploaded_image();
            echo '<div class="upload-status-thumb">';
            echo '<img src="'.$upload_url.$file_name.'" alt="imge" />';
            echo '</div>';

            // send notification email to admin on image upload
            self::email_notification($post_id);                   

        } else {                
            foreach ($errors as $error) {                    
                echo $error;                    
            }                
        }

    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:25:34.473

将您的电子邮件内容存储在一个变量中（下面的 $msg），并在循环的每次迭代中修改信息。循环完成后，检查变量是否已被修改，如果是，则通过电子邮件发送其内容。

这应该有效：

```
 global $wpdb, $post;
    $upload_path = wp_upload_dir();            
    $post_id = $post->ID;
    $msg = false;

    $upload_dir = $upload_path['basedir'].'/review-media/'.$post_id.'/'.get_current_user_id().'/';
    $thumbnail_dir = $upload_dir.'thumbnail/';
    $upload_url = $upload_path['baseurl'].'/review-media/'.$post_id.'/'.get_current_user_id().'/thumbnail/';

    self::create_path($thumbnail_dir);

    if (isset($_FILES['photo']) === true) {

        $errors = array();            
        $allowed_ext = array('jpg', 'jpeg', 'png', 'gif');

        $files = $_FILES['photo'];

        for($x = 0; $x < count($files['name']); $x++) {

            $file_name = $files['name'][$x]; 
            $file_ext = strtolower(end(explode('.', $file_name)));
            $file_size = $files['size'][$x];
            $file_tmp = $files['tmp_name'][$x];

            if($file_tmp)
            list($img_width, $img_height) = getimagesize($file_tmp);

            $min_img_width = 1;
            $min_img_height = 1;
            $max_img_width = 2000;
            $max_img_height = 2000;

            if (!$file_tmp) {
                $errors[] = '<p>Please select the file</p>';    
            }

            if (($file_tmp) && (($img_width > $max_img_width) || ($img_width < $min_img_width)) && (($img_height > $max_img_height) || ($img_height < $min_img_height))) {
                $errors[] = '<p>Size of <strong>'.$file_name.'</strong> must be within '. $min_img_width .'px to '. $max_img_width .'px</p>';
            }

            if ( ($file_tmp) && (in_array($file_ext, $allowed_ext) === false) ) {                
                $errors[] = '<p>Extension <strong>'.$file_ext.'</strong> not allowed</p>';
                unlink($file_tmp);                                
            }

            if ($file_size > 2097152) {                
                $errors[] = '<p>File <strong>'.$file_name.'</strong> size must be under 2mb</p>';
                unlink($file_tmp);                
            }

            if(empty($errors)) {   

                move_uploaded_file($file_tmp, $upload_dir.$file_name);

                //crop and resize to images and thumbnails
                $target_file = $upload_dir.$file_name; // original file
                $resized_file = $upload_dir.$file_name; // max resized file
                $med_file = $upload_dir.'medium-'.$file_name; // medium resized fiel
                $thumbnail = $thumbnail_dir.$file_name; // thumbnail file
                $large_width = 1024; // upload resize max width
                $large_height = 1024; // upload resize max height
                $thumb_width = 150; // thumbnail width
                $thumb_height = 150; // thumbnail height
                $med_width = $thumb_width * 1.5; // medium resized image width
                $med_height = $thumb_height * 1.5; // medium resized image height

                // resize to maximum width and height
                self::resize_image($target_file, $resized_file, $large_width, $large_height, $file_ext);
                // resize with 1.5 multi of thumb width and height to generate thumbnail
                self::resize_image($target_file, $med_file, $med_width, $med_height, $file_ext);     
                // crop image uisng medium resized image               
                self::crop_thumbnai(file_exists($med_file) ? $med_file : $target_file, $thumbnail, $thumb_width, $thumb_height, $file_ext);

                // delete medium resized file after thumbnail creation.
                if (file_exists($med_file))
                    unlink($med_file);

                self::insert_image($file_name);

                //self::get_uploaded_image();
                echo '<div class="upload-status-thumb">';
                echo '<img src="'.$upload_url.$file_name.'" alt="imge" />';
                echo '</div>';

                // add to message var
               $msg .= 'image added: '.$post_id."\n";                   

            } else {                
                foreach ($errors as $error) {                    
                    echo $error;                    
                }                
            }

        }

     if($msg){ // if msg is no longer false email it to admin
        self::email_notification($msg);
     }

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:27:21.623

轻松工作：

```
$message = "" ;
for($x = 0; $x < count($files['name']); $x++) {
    if(empty($errors)) {  
       move_uploaded_file($file_tmp, $upload_dir.$file_name);
       $message .= "$file_name successfuly uploaded in ". Date("H:i:s") ." ".$post->ID." \n\r" ;
       # something else  ... 
    }
    # something else  ... 
}
if($message!='')
   self::email_notification($message); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T12:25:42.167

将要通知的帖子 ID 收集到一个数组中，然后在 for 循环调用 email_notification 之后将 ID 数组传递给它。修改 email_notification 函数以接受 ID 数组而不是一个 ID，并在电子邮件中包含所有 ID（例如，使用 foreach 循环遍历 ID 数组）。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-02-17T12:27:16.697

在循环内使用布尔变量。最初将其设置为 true，然后 && 与单个图像上传成功。

然后，在循环完成执行后，您可以检查该变量并发送您的电子邮件通知。

IE。

```
if ({success}) {
  $boolVar = $boolVar && true;
} else {
  $boolVar = $boolVar && false;
} 
```

如果您仍需要电子邮件中的 id，则需要在循环期间收集它们。

# javascript - JavaScript：我们是否总是能够像数组一样对字符串进行索引？

> ID：14921011
> 
> 赞同：1
> 
> 时间：2013-02-17T12:20:08.960
> 
> 标签：javascript, arrays, string, indexing

我一直认为，如果您想访问名为 的字符串中的第 n 个字符`str`，那么您必须执行类似的操作`str.charAt(n)`。今天我正在制作一个小的虚拟测试页面，我错误地访问了它，`str[n]`令我惊讶的是，它返回了字符串的第 n 个字符。我抛出了这个专门构建的小页面来展示这种意想不到的（对我而言）行为：

```
<!doctype html>
<html>
<body>
    <script>
        var str = "ABCDEFGH";
        if (str[4] === str.charAt(4)) alert("strings can be indexed directly as if they're arrays");
        var str2 = new String("ABCDEFGH");
        if (str2[4] === str2.charAt(4)) alert("even if they're declared as object type String");
    </script>
</body>
</html> 
```

并不总是这样，不是吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T12:24:35.497

> 有两种方法可以访问字符串中的单个字符。首先是`charAt`方法：
> 
> ```
> return 'cat'.charAt(1); // returns "a" 
> ```
> 
> 另一种方法是将字符串视为类似数组的对象，其中单个字符对应于数字索引：
> 
> ```
> return 'cat'[1]; // returns "a" 
> ```
> 
> > **类似数组的字符访问（上面的第二种方式）不是 ECMAScript 3 的一部分。它是 JavaScript 和 ECMAScript 5 的特性。**

[https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T12:23:46.303

不，这并不总是可能的。

如果您在足够旧的浏览器中运行代码，例如 IE 7，它将无法访问这样的字符串。在那些较旧的引擎上，您必须`.charAt(index)`改用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-17T12:27:33.257

只要我记得，但是：

> 类似数组的字符访问 [...] 不是 ECMAScript 3 的一部分。它是 JavaScript 和 ECMAScript 5 的特性。

（...并非所有浏览器都支持）[请参见此处。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String#Character_access)

# string - 给定一个回文字符串，我们可以通过多少种方式通过从中再删除一个字符将其转换为非回文字符串？

> ID：14921012
> 
> 赞同：6
> 
> 时间：2013-02-17T12:20:15.950
> 
> 标签：string, algorithm, math

给定一个回文字符串，我们可以通过多少种方式通过从中再删除一个字符将其转换为非回文字符串？

例如，如果字符串是“b99b”。然后我们可以通过 6 种方式做到这一点，

> i) 删除第一个字符："99b"
> ii) 删除第一个、第二个字符："9b"
> iii) 删除第一个、第三个字符："9b"
> iv) 删除第二个、第四个字符："b9"
> v) 删除第三个、第四个字符： "b9"
> vi) 删除第 4 个字符："b99"

如何接近这个？

PS：如果存在一个 i 使得索引 i 处的字符以一种方式被删除而不以另一种方式被删除，则两种方式被认为是不同的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T18:07:57.347

有一种动态规划算法用于计算字符串的回文子序列的数量；您可以使用它来计算非回文子序列的数量，方法是从子序列的数量（即 2 ^n）中减去回文子序列的数量。`O(n²)`

该算法按 OP 中的标准对子序列进行计数；如果用于选择元素的索引列表存在差异，则认为两个子序列不同，即使结果子序列具有相同的元素。

为了计算回文子序列，我们根据序列的间隔建立计数。具体来说，我们定义：

`S[i,j]`=`S`从 index 开始到 index`i`结束的子串`j`（含）

`P[i,j]`= 的回文子序列的数量`S[i,j]`

现在，每个单元素区间都是回文，所以：

`P[i,i] = 1`对所有人`i < n`

如果子串不是以相同的元素（即）开始和结束，则回文子序列包括：`S[i] ≠ S[j]`

*   包含但不包含的`S[i]``S[j]`

*   包含但不包含的`S[j]``S[i]`

*   既不包含也不包含`S[i]``S[j]`

现在，注意包括第一组和第三组子序列，同时包括第二组和第三组；正好是第三组。最后：`P[i,j-1]``P[i+1,j]``P[i+1,j-1]`

`P[i,j] = P[i+1,j] + P[i,j-1] − P[i+1,j-1]`如果`S[i] ≠ S[j]`

但万一呢？在这种情况下，我们必须添加由 组成的回文，后跟来自 的子序列回文，以及仅由开始和结束字符组成的回文子序列。（从技术上讲，一个空序列是一个回文，但我们在这里不计算它们。）我们添加的子序列的数量是 P [i+1,j-1] + 1，这抵消了上面等式中减去的双重计数。所以：`S[i] = S[j]``S[i]``S[i+1,j-1]``S[j]`

`P[i,j] = P[i+1,j] + P[i,j-1] + 1`如果.`S[i] = S[j]`

为了节省空间，我们实际上可以计算增加的​​值；我们只需要保留其中两个向量即可生成最终结果 P [0,|S|-1]。`P[i,i+k] for 0 ≤ i < |S|-k``k`

* * *

**编辑**：

这是一个小python程序；第一个计算回文子序列的数量，如上所述，驱动程序计算非回文子序列的数量（即删除零个或多个元素并产生非回文的方法的数量；如果原始序列是回文，那么它是删除一个或多个元素的方法数。）

```
# Count the palindromic subsequences of s
def pcount(s):
  length = len(s)
  p0 = [0] * (length + 1)
  p1 = [1] * length
  for l in range(1, length):
    for i in range(length - l):
      p0[i] = p1[i]
      if s[i] == s[i + l]:
        p1[i] += p1[i+1] + 1
      else:
        p1[i] += p1[i+1] - p0[i+1]
  # The "+ 1" is to account for the empty sequence, which is a palindrome.
  return p1[0] + 1

# Count the non-palindromic subsequences of s
def npcount(s):
  return 2**len(s) - pcount(s) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T12:43:27.910

这不是一个完整的答案，只是一个建议。

我会计算可以删除一个或多个字符**并使字符串保持**回文的方法的数量。然后从可以修改字符串的方式总数中减去它。

修改回文并使其保持回文的最明显方法是删除`i'th`和`(n-i)'th`字符（n 是字符串的长度）。有一些`2^(n/2)`方法可以做到这一点。

这种方法的问题在于它假设只有对称修改才能使字符串保持回文，您需要找到一种方法来处理诸如`"aaaa"`任何类型的修改仍会导致回文的情况。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T14:34:01.390

使用记忆的蛮力非常简单：

```
numWays(str): return 0 if str is empty
              return memo[str] if it exists
              memo[str] = numWays(str - firstChar) +
                          numWays(str - secondChar) +
                          ... +
                          1 if str is not a palindrome
              return memo[str] 
```

基本上，您依次删除每个字符并保存结果字符串的答案。字符串中的相同字符越多，速度就越快。

我不确定如何更有效地做到这一点，如果我弄明白了，我会更新这个。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-17T15:32:41.800

对于具有 N 个元素的字符串，有 2^N 个可能的子字符串（包括整个字符串和空子字符串）。因此，我们可以用一个数字对每个子字符串进行编码，在每个省略（或存在）的字符的位位置上使用“1”位，否则为“0”位。（假设字符串的长度小于 int 中的位数（此处为 size_t），否则您将需要位串的其他表示形式）：

```
#include <stdio.h>
#include <string.h>

char string[] = "AbbA";
int is_palindrome (char *str, size_t len, size_t mask);

int main(void)
{
size_t len,mask, count;

len = strlen(string);

count =0;
for (mask = 1; mask < (1ul <<len) -1; mask++) {
        if ( is_palindrome (string, len, mask)) continue;
        count++;
        }

fprintf(stderr, "Len:=%u, Count=%u \n"
        , (unsigned) len , (unsigned) count );

return 0;
}

int is_palindrome (char *str, size_t len, size_t mask)
{
size_t l,r,pop;

for (pop=l=0, r = len -1; l < r; ) {
        if ( mask & (1u <<l)) { l++; continue; }
        if ( mask & (1u <<r)) { r--; continue; }
        if ( str[l] == str[r] ) return 1;
        l++,r--; pop++;
        }
return (pop <1) ? 1: 0;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T16:50:49.627

这是一个 Haskell 版本：

```
import Data.List

listNonPalindromes string = 
  filter (isNotPalindrome) (subsequences string)
    where isNotPalindrome str
            | fst substr == snd substr  = False
            | otherwise                 = True
           where substr = let a = splitAt (div (length str) 2) str
                          in (reverse (fst a), if even (length str) 
                                                  then snd a 
                                                  else drop 1 (snd a))

howManyNonPalindromes string = length $ listNonPalindromes string 
```

*Main> listNonPalindromes "b99b"
["b9","b9","b99","9b","9b","99b"]
*Main> howManyNonPalindromes "b99b"
6

# ant - 如何从环境变量中设置密钥密码？

> ID：14921013
> 
> 赞同：1
> 
> 时间：2013-02-17T12:20:19.240
> 
> 标签：ant

我想避免在构建过程中提示输入密码，但我也想将其保留在文件之外，因此我尝试对其进行设置，以便可以在命令提示符中键入：

```
SET password=pword
ant release 
```

我的`ant.properties`文件如下所示：

```
key.store=../KeyStore/Project.keystore
key.alias=project
key.store.password=${env.password}
key.alias.password=${env.password} 
```

在我`build.xml`的行中：

```
<property environment="env" /> 
```

据我了解，[这](http://ant.apache.org/manual/Tasks/property.html)就是我所需要的，但它不起作用，说密码错误（注意我有三次检查它是否正确，并在`ant.properties`测试中对其进行硬编码）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:23:12.810

这只是 中行的顺序`build.xml`。

带有 的线`env`必须在该`ant.properties`线之上。

```
<property environment="env" />               
<property file="ant.properties" /> 
```

# vb.net - 委托参数是否需要匹配事件签名？

> ID：14921020
> 
> 赞同：1
> 
> 时间：2013-02-17T12:21:24.433
> 
> 标签：vb.net, delegates

请看下面的代码：

```
Public Delegate Sub TestButtonClick(ByVal test As Integer)

Public Class Person
    Private Name As String
    Private ID As Integer
    Public Event ButtonClick As TestButtonClick

    Public Sub DelegateTest1(ByVal Test As Integer)
        MsgBox(Test)
    End Sub

    Public Sub ChangeName()
        RaiseEvent ButtonClick(1)
    End Sub

    Public Sub DelegateTest2()
        MsgBox("Delegate Test 2")
    End Sub

    Public Sub DelegateTest3()
        MsgBox("Delegate Test 3")
    End Sub

End Class

Public Class Form1
    Private Sub Form1_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        Dim p1 As Person = New Person
        AddHandler p1.ButtonClick, AddressOf p1.DelegateTest1
        AddHandler p1.ButtonClick, AddressOf p1.DelegateTest2
        AddHandler p1.ButtonClick, AddressOf p1.DelegateTest3
        p1.ChangeName()
    End Sub
End Class 
```

输出是：

```
1
DelegateTest2
DelegateTest3 
```

我不明白为什么这个应用程序编译，即委托在其签名中接受一个整数，但`Person.DelegateTest2`不`Person.DelegateTest3`接受。

如果我将 Person.DelegateTest2() 更改为以下内容，那么我确实会收到一个错误，如我所料：

```
Public Sub DelegateTest2(ByVal Test As Integer, ByVal Test2 As Integer)
        MsgBox("Delegate Test 2")
    End Sub 
```

为什么当它有参数时，代表允许你传递零个参数，即在我的例子中是一个整数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T12:40:52.007

不要忘记 VB.NET 继承了深受喜爱的 VB 的所有遗留包袱。您可以通过将以下内容放在文件顶部来使其变得严格，以便它表现为真正的 .NET 编程语言而不是一些混合废话：

```
Option Strict On 
```

另外，我建议您将其设置为 ，[`default option`](https://stackoverflow.com/questions/5160669/option-strict-on-by-default-in-vb-net)这样您就不会发现自己在荒野中。

# c# - WPF 用户控件从 Web 服务或 dll 获取数据

> ID：14921025
> 
> 赞同：0
> 
> 时间：2013-02-17T12:21:51.927
> 
> 标签：c#, wpf, wcf, class-library

我有一个 WPF 用户控件，它在屏幕上显示一条数据。

我想使用相同的 WPF 前端，但数据来自两个可能的替代来源：

1.  链接的类库或
2.  WCF 服务

理由是我想创建我的软件的两个版本，一个用于销售，另一个用于试用。与其冒着创建一个受时间限制保护的完全包含的应用程序并让某人破解它的风险，我更愿意提供一个客户端-服务器版本的软件，在那里我可以从后面限制可用性 -结尾。

例如，假设用户控件显示星期几，而我从 GetDayOfWeek(DateTime dateTime) 方法中获取星期几。我希望能够从链接的类库或 WCF 服务调用该方法。（该决定可以基于配置参数，甚至可以自动检测链接库的存在）。

有任何想法吗？

# eventbrite - event_search 服务的“日期”参数上的值“未来”也返回旧事件

> ID：14921027
> 
> 赞同：1
> 
> 时间：2013-02-17T12:22:00.163
> 
> 标签：eventbrite

我正在使用 event_search 服务，从而传递了“关键字”参数和“日期”参数。因为我只对未来事件感兴趣，所以对于“日期”参数，我传递了值“未来”。所以 URL 如下所示：

[http://www.eventbrite.com/event_search?app_key=](http://www.eventbrite.com/event_search?app_key=) &keywords=&date=future

我发现我得到了相同的事件，就像我在没有“date=future”参数的情况下调用服务时一样，即包括过去的事件。我没有使用“日期”参数的其他值。

我遇到了错误吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-18T10:33:38.823

/event_search 方法不支持“date=future”，但默认返回应该只是未来事件。

如果您收到过去同时具有“start_date”**和**“end_date”的事件，那么您遇到了错误。

我最近做了一些测试，但无法重现。所以，希望你不再看到这个问题。

# ios - iOS：了解 positionFromPosition:inDirection:offset:

> ID：14921030
> 
> 赞同：3
> 
> 时间：2013-02-17T12:22:15.790
> 
> 标签：ios, ipad, uitextinput

我正在尝试实现我自己的 UITextInput 但是我无法使用蓝牙键盘上的光标键更新位置。我正在尝试创建一个循环的 TextInput，如果您想像这样编号的字符：

```
1 2 3
4 5 6
7 8 9 
```

然后在位置 2 向上按，应该带你到位置 8（在 6 上按向左带你到 4 等）。iOS 似乎调用 positionFromPosition:inDirection:offset: 来计算如何从当前位置移动。然后它调用 setSelectedTextRange: 来更新光标位置。

到目前为止这很好，但似乎有时 iOS 不会调用 positionFromPosition:inDirection:offset: 例如，如果我再次按向上然后向下，iOS 似乎会缓存以前的位置并使用之前的值调用 setSelectedTextRange:。我不明白这一点，有没有办法告诉 iOS 所选位置已更改并且它应该清除它的缓存，即如果有人按下“清除”按钮或其他东西？

缓存似乎只发生在 Up 和 Down 光标按键上，左右移动永远不会缓存以前的值，并且 positionFromPosition:inDirection:offset: 总是被调用。即使我不考虑重置光标位置的可能性，我仍然遇到不偶尔调用“positionFromPosition：inDirection：offset：”的问题，并且我只是不断将“setSelectedTextRange：”设置为iOS设置的相同值。因此，如果感觉我误解了 iOS 如何缓存光标移动。谁能帮我吗？

# java - 尝试将 EditText 值放入浮点变量时强制关闭

> ID：14921037
> 
> 赞同：1
> 
> 时间：2013-02-17T12:22:44.647
> 
> 标签：java, android

当我尝试将编辑文本值分配为浮动时，我的应用程序强制关闭。这是代码。我还尝试了 Float.parseFloat() 方法而不是 Float.valueOf()。如果我取消我的 getETvalue() 方法，那么应用程序就可以工作。请帮忙

```
package com.example.aviator_18;

import android.os.Bundle;
import android.app.Activity;
import android.graphics.Color;
import android.view.Menu;
import android.widget.EditText;
import android.widget.TextView;
import android.widget.Toast;

public class MainActivity extends Activity {
    float Remaining,Departure,TotUplift,SG,DiscResult;
    int CalUpliftResult;
    TextView RemainingTV,DepartureTV,UpliftTV,SGtv,CalcUpliftTV,DiscrepancyTV;
    EditText RemainingET,DepartureET,TotUpliftET,SGet,CalcUpliftET,DiscrepancyET;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        setupView();
        getETvalue();
        evaluation();
        CalcUpliftTV.setText(String.valueOf(CalUpliftResult));
        DiscrepancyTV.setText(String.valueOf(DiscResult));

    }

    private void getETvalue() {
        String a,b,c,d,e;
        Remaining=Float.valueOf(RemainingET.getText().toString());
        Departure=Float.valueOf(DepartureET.getText().toString());
        TotUplift=Float.valueOf(TotUpliftET.getText().toString());
        SG=Float.valueOf(SGet.getText().toString());

    }

    private void evaluation() {

        CalUpliftResult=Math.round(TotUplift*SG);
        DiscResult=((Departure-Remaining-CalUpliftResult)/CalUpliftResult)*100;

    }

    private void setupView() {
        RemainingET=(EditText)findViewById(R.id.remainingET);
        DepartureET=(EditText)findViewById(R.id.departureET);
        TotUpliftET=(EditText)findViewById(R.id.TotalUpliftET);
        SGet=(EditText)findViewById(R.id.SGet);

        CalcUpliftTV=(TextView)findViewById(R.id.CalUpliftResult);
        DiscrepancyTV=(TextView)findViewById(R.id.discResult);

    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T12:24:16.363

`Float.valueOf`将转换包含字符串形式的浮点数的字符串值。但是如果字符串包含任何不能解析成浮点数的东西，那么这个方法会抛出`NumberFormatException`

像：

`float f = Float.valueOf("12.35") //this is correct`

尽管

`float f = Float.valueOf("abcd") //this is incorrect`

这会导致力关闭，因为它必须投掷`NumberFormatException`

[来自 javadocs](http://docs.oracle.com/javase/6/docs/api/java/lang/Float.html#valueOf%28java.lang.String%29)

***的价值***

```
public static Float valueOf(String s)
                     throws NumberFormatException
Returns a Float object holding the float value represented by the argument string s.

Throws:
NumberFormatException - if the string does not contain a parsable number. 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:28:40.440

您需要确保可以将字符串解析为浮点数。您可以添加 try - catch

```
try {
   Remaining=Float.parseFloat(RemainingET.getText().toString());
} catch (NumberFormatException nfe) {
    // Handle exception
} 
```

# c# - Web API 操作过滤器 - Controller.TempData 等效？

> ID：14921041
> 
> 赞同：4
> 
> 时间：2013-02-17T12:22:57.943
> 
> 标签：c#, asp.net-mvc-4, asp.net-web-api

在我的 System.Web.Mvc 操作过滤器中，我以前使用 TempData 来存储我的 unitOfWork 服务的实例，如下所示：

```
public override void OnActionExecuting(ActionExecutingContext filterContext)
{
    filterContext.Controller.TempData[UnitOfWorkRequestKey] = UnitOfWork;
    UnitOfWork.Begin();
} 
```

然后提交事务我从这样的临时数据中检索它..

```
public override void OnActionExecuted(ActionExecutedContext filterContext)
{
    var unitOfWork = (IUnitOfWork)filterContext.Controller.TempData[UnitOfWorkRequestKey];
    try
    {
        if (filterContext.Exception == null)
        {
            unitOfWork.Complete();
        }
    }
    finally
    {
        unitOfWork.Dispose();
        filterContext.Controller.TempData[UnitOfWorkRequestKey] = null;
    }
} 
```

所以我的问题是：
在`System.Web.Http`Web Api 操作过滤器（使用`HttpActionContext`）中 - 是否有一个等效的位置来存储我的服务实例，所以我可以在执行操作时检索相同的实例？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-17T12:25:00.017

> 在 System.Web.Http Web Api 操作过滤器（使用 HttpActionContext）中 - 是否有一个等效的位置来存储我的服务实例，所以我可以在执行操作时检索相同的实例？

不，没有。API 的全部意义在于它应该是无状态的。这是第 1 条规则。如果您需要在 API 中使用 Session 或 TempData，从设计的角度来看，您可能会做一些非常错误的事情。

此外，您不应该在 MVC 应用程序中使用 TempData 来执行此任务。当您需要在多个请求之间保留信息时，使用 TempData。在您的情况下，这是相同的请求。所以你应该使用`HttpContext`来存储这些信息：

```
public override void OnActionExecuting(ActionExecutingContext filterContext)
{
    filterContext.HttpContext.Items[UnitOfWorkRequestKey] = UnitOfWork;
} 
```

进而：

```
public override void OnActionExecuted(ActionExecutedContext filterContext)
{
    var unitOfWork = (IUnitOfWork) filterContext.HttpContext.Items[UnitOfWorkRequestKey];
    try
    {
        if (filterContext.Exception == null)
        {
            unitOfWork.Complete();
        }
    }
    finally
    {
        unitOfWork.Dispose();
        filterContext.Controller.TempData[UnitOfWorkRequestKey] = null;
    }
} 
```

好的，现在我们已经修复了您的 MVC 应用程序，下面介绍如何使用`Request.Properties`集合在 Web API 中实现相同的功能：

```
public override void OnActionExecuting(HttpActionContext actionContext)
{
    actionContext.Request.Properties[UnitOfWorkRequestKey] = UnitOfWork;
} 
```

进而：

```
public override void OnActionExecuted(HttpActionExecutedContext actionExecutedContext)
{
    var unitOfWork = (IUnitOfWork) actionExecutedContext.Request.Properties[UnitOfWorkRequestKey];
    try
    {
        if (actionExecutedContext.Exception == null)
        {
            unitOfWork.Complete();
        }
    }
    finally
    {
        unitOfWork.Dispose();
    }
} 
```

# multithreading - .NET 4.5 中的内存模型发生了什么变化？

> ID：14921043
> 
> 赞同：5
> 
> 时间：2013-02-17T12:23:13.293
> 
> 标签：multithreading, .net-4.5, shared-memory

我刚刚在 Peter Richtie 博客中阅读了这条令人费解的线，我需要帮助来理解其含义`Prior to .NET 4.5 you really programmed to the .NET memory model`：[http ://msmvps.com/blogs/peterritchie/archive/2012/09/09/thread-synchronization-of-atomic-invariants-in -net-4-5.aspx](http://msmvps.com/blogs/peterritchie/archive/2012/09/09/thread-synchronization-of-atomic-invariants-in-net-4-5.aspx)

****.NET 4.5 中****的“常规”.NET 内存模型***（例如 Jeffrey Richter 的书 CLR via C# 第 1 版和第 2 版*（我没有读过 3d）中讨论的那个）是否发生了变化？**

 ****有没有有意识解释的文章？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-11-23T13:37:06.630

在 .NET 中处理并发的正确方法是基于弱内存模型。这在 .NET 4.5 中没有改变。

仅仅因为不再支持 Itanium 并不意味着您可以假设更强大的 x86 或 amd64 内存模型。例如，您有其他弱内存模型平台，例如 ARM。

永远记住，JIT 编译器可能会在第一次之后忽略对同一变量或字段的非易失性读取，以防它可以证明读取之间没有同步（内存屏障，监控对象的锁定是/曾经是监控器）未锁定、易失性读取易失性写入的变量、`Interlocked`对变量进行操作）。这尊重线程的观点一致性。

您链接到的文章显示了 Microsoft .NET Framework 的 JIT 编译器忽略读取的示例，例如`while`读取非易失性变量的循环，而循环内没有任何同步点。但请记住，JIT 编译器可以使用整个程序优化来概括调用者和被调用者之间的这种省略。

因此，.NET 中的无锁算法在没有内存屏障、锁、易失性语义或`Interlocked`操作的情况下读取变量或字段，前提是这些读取最终会看到来自其他线程的更改，这是在与 JIT 编译器赌博。从本质上讲，这些算法在可移植性方面是错误的。

这让我想知道，你为什么要问这个？****

# gcc - gcc 共享库在 ubuntu 12.04 中链接不正确

> ID：14921045
> 
> 赞同：0
> 
> 时间：2013-02-17T12:23:18.630
> 
> 标签：gcc, ubuntu, shared-libraries

> ```
> cat /etc/issue
> Ubuntu 12.04.2 LTS \n \l
> 
> gcc --version
> gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3 
> ```

```
CFLAGS = -g -O2 -Wall -fPIC -c $(INCLUDES)
OFLAGS = -g -O2 -shared -Wall $(LIBS) -Wl,-soname,$(TARGET_NAME) 
```

一个 cpp 所以，当我链接 so 时，依赖库不会出现在 ldd 结果中。在 CentOS6.3 中是可以的。LD_LIBRARY_PATH 设置为 OK，因为我制作的 ELF 可执行文件是 OK 的。先感谢您。

# php - 网站被部分下载

> ID：14921047
> 
> 赞同：3
> 
> 时间：2013-02-17T12:23:45.903
> 
> 标签：php, apache

我的网站后端的某些页面一直存在问题。它发生在多个浏览器（Firefox、Chrome、Safari）中。该网站使用 Zend Framework 1.11 并在共享主机环境（PHP、Apache）上运行

当我尝试加载某些页面时，Chrome 只会输出一个空白页面。它确实会下载 HTML，但有时只是部分下载。当我检查我的网络检查器时，我看到以下内容（见屏幕截图）。此外，当我尝试通过 Chrome 下载该页面时，我收到以下错误：“curl：（18）传输已关闭，剩余未完成的读取数据”。（实际上，只下载了部分 HTML）

截图：

1.  [http://cl.ly/image/2K371a1p3Y3S](http://cl.ly/image/2K371a1p3Y3S)
2.  [http://cl.ly/image/442d2r1y2u2O](http://cl.ly/image/442d2r1y2u2O)
3.  [http://cl.ly/image/3a1M060X182d](http://cl.ly/image/3a1M060X182d)
4.  [http://cl.ly/image/0q1p17143F07](http://cl.ly/image/0q1p17143F07)
5.  [http://cl.ly/image/2N2p3k0g3F1m](http://cl.ly/image/2N2p3k0g3F1m)
6.  [http://cl.ly/image/2X371V1t093O](http://cl.ly/image/2X371V1t093O)

我还注意到失败的请求不会出现在 Apache 的访问/错误日志中。

任何帮助都会很棒！

谢谢，

马汀

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T12:33:11.483

这难道不是由永远不会结束的 while 循环引起的吗？

# return-value - AutoIt - 返回值始终为 0

> ID：14921049
> 
> 赞同：-1
> 
> 时间：2013-02-17T12:23:47.083
> 
> 标签：return-value, autoit

我写了一个可以递归的方法，但是返回值总是0，即使它在控制台上有一个字符串值：

```
Func hasItTheThing($s)

$result = StringInStr(...,...)
local $newstring

$newstring = $s

If NOT $result > 0 Then

ConsoleWrite("newstring = " & $newstring & @CRLF)
return $newstring

Else

$newstring = ;Fix something with the string
hasItTheThing($newstring)

EndIf

EndFunc 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-08-09T15:00:50.547

此外，导致始终为零结果的错误：IF 的“Else”分支（如果不是 $result > 0）没有返回。因此，当结果 > 0 时，您的函数会调用自身，但当它返回一个值时，它会被丢弃，并且函数继续退出，不返回任何内容。

修复：

```
...
Else
    $newstring = ;Fix something with the string
    return hasItTheThing($newstring)   ; <== Added a "return" here
EndIf
EndFunc 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:09:58.703

啊，没关系，[http](http://www.autoitscript.com/wiki/Recursion) ://www.autoitscript.com/wiki/Recursion 回答了这个问题。

我通过将关键字 return 替换为在函数外部声明的局部变量来解决它，并将值设置为此变量。

# html - 我需要一种使用网络应用程序离线存储信息的方法

> ID：14921051
> 
> 赞同：1
> 
> 时间：2013-02-17T12:23:57.990
> 
> 标签：html, css, manifest

我想使用 HTML5、CSS3 和可能的 JQuery 移动创建一个网络应用程序。这个应用程序只是一个用于收集客户数据的表格，但它需要能够离线工作。

我之前创建了离线网络应用程序并使用清单文件使其离线，但是有没有办法在设备上制作表单存储数据以便稍后上传到计算机或服务器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:39:45.193

HTML5 中有很多离线存储的解决方案，但都取决于您要支持哪种浏览器？`localStorage`可能是目前支持最广泛的，还有 web SQL 数据库等等：[http ://www.html5rocks.com/en/tutorials/offline/storage/](http://www.html5rocks.com/en/tutorials/offline/storage/)

# python - python Image PIL到二进制十六进制

> ID：14921055
> 
> 赞同：8
> 
> 时间：2013-02-17T12:24:21.067
> 
> 标签：python, image, hex, python-imaging-library, binaryfiles

```
from PIL import Image
from PIL import ImageDraw
from PIL import ImageFont
import urllib.request
import io
import binascii

data = urllib.request.urlopen('http://pastebin.ca/raw/2311595').read()
r_data = binascii.unhexlify(data)
stream = io.BytesIO(r_data)
img = Image.open(stream)
draw = ImageDraw.Draw(img)
font = ImageFont.truetype("arial.ttf",14)
draw.text((0, 220),"This is a test11",(0,255,0),font=font)
draw = ImageDraw.Draw(img)

with open(img,'rb') as in_file: #error on here invalid file:
     hex_data = in_file.read()
# Unhexlify the data.
bin_data = binascii.unhexlify(bytes(hex_data))
print(bin_data) 
```

## 问题

将十六进制转换为图像并在图像上绘制文本，然后将图像转换为二进制十六进制，但是这里有问题`with open(img,'rb') as in_file:`，如何将 img 转换为十六进制？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-17T12:34:13.640

`img`对象需要再次保存；将其写入另一个`BytesIO`对象：

```
output = io.BytesIO()
img.save(output, format='JPEG') 
```

[`.getvalue()`然后使用以下方法](http://docs.python.org/3/library/io.html#io.BytesIO.getvalue)获取写入的数据：

```
hex_data = output.getvalue() 
```

PIL-for-python-3 目前的情况相当混乱。[Pillow fork](http://pypi.python.org/pypi/Pillow/)看起来是目前最好的维护版本。它包括使保存到`BytesIO`对象工作的修复。如果您使用上述代码遇到`io.UnsupportedOperation: fileno`异常，则您的版本尚未修复，在这种情况下，您将不得不求助于使用临时文件。

# python - onclick 函数 matplotlib

> ID：14921056
> 
> 赞同：0
> 
> 时间：2013-02-17T12:24:22.500
> 
> 标签：python, matplotlib, wxpython

```
cmap = mpl.colors.ListedColormap([[1,0,0], [0,0,1], [0,1,0], [1,1,0]])

    self.fig = plt.figure(figsize=(6,6))
self.ax = self.fig.add_axes([0.1, 0.1, 0.8, 0.8])
x_ax = self.fig.add_axes([0.05, 0.1, 0.05, 0.8])
x2_ax = self.fig.add_axes([0.05, 0.1, 0.05, 0.8])
y_ax = self.fig.add_axes([0.1, 0.05, 0.8, 0.05])
x_ax.imshow(xcolors, cmap=cmap, interpolation='none')
x_ax.set_aspect('auto')
x_ax.set_position((0.1,0.1,0.05,0.8))
y_ax.imshow(ycolors, cmap=cmap, interpolation='none')
x_ax.set_picker(5)
def on_pick(event):
    print hello

self.canvas = FigureCanvas(self, -1, self.fig)
self.canvas.mpl_connect('Pick_event',on_pick) 
```

我的 onclick 方法有问题，基本上我想点击颜色栏并用我拥有的代码打印出你好，它什么也没做我做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T16:55:59.817

主要问题是您正在创建一个新的`canvas`而不是使用`fig`已有的。有（至少）两种方法可以做你想做的事。

您可以通过将*图像*设置为响应选择事件来做到这一点（参见[本教程](http://matplotlib.org/examples/event_handling/pick_event_demo.html)示例 4）：

```
cmap = mpl.colors.ListedColormap([[1,0,0], [0,0,1], [0,1,0], [1,1,0]])

xcolors = arange(15).reshape(15,1)
ycolors = arange(15).reshape(1,15)
fig = plt.figure(figsize=(6,6))
ax = fig.add_axes([0.1, 0.1, 0.8, 0.8])
x_ax = fig.add_axes([0.05, 0.1, 0.05, 0.8])
x2_ax = fig.add_axes([0.05, 0.1, 0.05, 0.8])
y_ax = fig.add_axes([0.1, 0.05, 0.8, 0.05])
x_ax.imshow(xcolors, cmap=cmap, interpolation='none', picker=True)
x_ax.set_aspect('auto')
x_ax.set_position((0.1,0.1,0.05,0.8))
y_ax.imshow(ycolors, cmap=cmap, interpolation='none', picker=True)
def on_pick(event):
    artist = event.artist
    if isinstance(artist, matplotlib.image.AxesImage):
        im = artist
        A = im.get_array()
        print A.shape,
    print 'hello'

canvas = fig.canvas
canvas.mpl_connect('pick_event',on_pick) 
```

或者，您可以设置*轴*以响应选择事件（请参阅[颜色条 matplotlib python 上的 onclick 方法](https://stackoverflow.com/questions/14910963/onclick-method-on-a-colorbar-matplotlib-python)），如下所示：

```
cmap = mpl.colors.ListedColormap([[1,0,0], [0,0,1], [0,1,0], [1,1,0]])

xcolors = arange(15).reshape(15,1)
ycolors = arange(15).reshape(1,15)
fig = plt.figure(figsize=(6,6))
ax = fig.add_axes([0.1, 0.1, 0.8, 0.8])
x_ax = fig.add_axes([0.05, 0.1, 0.05, 0.8])
x2_ax = fig.add_axes([0.05, 0.1, 0.05, 0.8])
y_ax = fig.add_axes([0.1, 0.05, 0.8, 0.05])
x_ax.imshow(xcolors, cmap=cmap, interpolation='none')
x_ax.set_aspect('auto')
x_ax.set_position((0.1,0.1,0.05,0.8))
y_ax.imshow(ycolors, cmap=cmap, interpolation='none')

x_ax.set_picker(5)
y_ax.set_picker(5)

def on_pick(event):
    artist = event.artist
    if isinstance(artist, matplotlib.axes.Axes):

        print event.mouseevent.ydata,
        print event.mouseevent.xdata,
    print 'hello'

canvas = fig.canvas
canvas.mpl_connect('pick_event',on_pick) 
```

请注意活动所携带的艺术家类型的差异（以及您可以轻松访问的信息）。

# iphone - 模态视图不会关闭

> ID：14921058
> 
> 赞同：1
> 
> 时间：2013-02-17T12:24:28.617
> 
> 标签：iphone, ios, modalviewcontroller

我发现了许多类似的问题，但无论如何都找不到我的问题的解决方案。所以，我的应用程序（它由 tabView 组成）需要在第一次启动后从服务器下载数据。为此，它调用模态视图控制器，在其中使用 Reachability.h/m 和 NSNotification defaultCenter 检查互联网连接。如果可以访问互联网，则开始下载并保存数据。完成后，我想关闭模式打开的视图控制器，但它一遍又一遍地重新加载。我坚持了将近2天，请帮忙:)

这是我的代码的一部分：在第一个 ViewController

```
-(void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:animated];
    //checking for data if not calls modalViewController
    if(firstStart){
        [self performSegueWithIdentifier:@"startDownload" sender:self];
    }

} 
```

在第二个（模态视图控制器）

```
- (void)viewDidAppear:(BOOL)animated
{
    [super viewDidAppear:YES];
    // check for internet connection
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(checkNetworkStatus:) name:kReachabilityChangedNotification object:nil];

     internetReachable = [Reachability reachabilityForInternetConnection];
     [internetReachable startNotifier];

     // check if a pathway to a random host exists
     hostReachable = [Reachability reachabilityWithHostName: @"www.apple.com"];
     [hostReachable startNotifier];  

} 
```

在 checkNetworkStatus 完成 检查互联网连接是否存在互联网连接 执行 JSON 下载和解析，最后调用 Close 方法

```
-(void)Close
{
    [self dismissViewControllerAnimated:YES completion:nil];
} 
```

在这个调用之后，屏幕转到第一个 ViewController 并立即变为第二个，所有的东西都再次执行，它有点卡在循环中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:00:54.790

问题是第一个视图控制器`viewDidAppear`不仅在它第一次出现时被调用，而且在第二个视图控制器的模态被关闭并且第一个视图重新出现时也被调用。并`viewDidAppear`检查一些变量，`firstStart`但显然这个变量不是在第一个控制器的初始值和第一个控制器的第二个`firstStart`之间没有正确重置。`viewDidAppear``viewDidAppear`

您要么需要让第二个控制器以某种方式更新此`firstStart`变量的值（例如，通过委托协议），要么重新计算`firstStart`第一个视图重新出现的时间。

# c++ - 如何使 QTabWidget 在 Mac 上显示当前选项卡的图标？

> ID：14921061
> 
> 赞同：0
> 
> 时间：2013-02-17T12:24:40.580
> 
> 标签：c++, macos, qt

我 `QTabWidget::setTabIcon()`在 Mac 上使用时遇到问题。The icon is displayed only when the tab is not current. 带有图标的选项卡变为当前选项卡后，图标将替换为空白区域。

这是一个错误吗？操作系统限制？有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T07:51:15.487

正如我在 QMacStyle::drawControl 方法中看到的，没有用于绘制图标元素的代码：

```
p->save();
rotateTabPainter(p, myTab.shape, myTab.rect);

QPalette np = tab->palette;
np.setColor(QPalette::WindowText, QColor(0, 0, 0, 75));
QRect nr = subElementRect(SE_TabBarTabText, opt, w);
nr.moveTop(-1);
int alignment = Qt::AlignCenter | Qt::TextShowMnemonic | Qt::TextHideMnemonic;
proxy()->drawItemText(p, nr, alignment, np, tab->state & State_Enabled,
                           tab->text, QPalette::WindowText);

np.setColor(QPalette::WindowText, QColor(255, 255, 255, 255));
nr.moveTop(-2);
proxy()->drawItemText(p, nr, alignment, np, tab->state & State_Enabled,
                           tab->text, QPalette::WindowText);
p->restore(); 
```

就我而言，作为快速解决方案，我通过在前一个代码之前添加以下代码来解决此问题：

```
QString oldText = myTab.text;
myTab.text = "";
QCommonStyle::drawControl(ce, &myTab, p, w);
myTab.text = oldText; 
```

# c++ - 为函数创建别名

> ID：14921065
> 
> 赞同：0
> 
> 时间：2013-02-17T12:25:16.323
> 
> 标签：c++, visual-c++

我想为`CPPUNIT_ASSERT_EQUAL_MESSAGE(string message, T expected, T actual)`. 我试过了：

```
template<class T> void (&_assert)(string, T, T) = &CPPUNIT_ASSERT_EQUAL_MESSAGE; 
```

不确定它是否正确，但我收到了类似的错误

```
Error   1   error C2530: '_assert' : references must be initialized h:\dropbox\sch\cs3202\code\test\testqueryevaluator\testgetcandidatelist.h   22
Error   2   error C2998: 'void (__cdecl &__cdecl _assert)(std::string,T,T)' : cannot be a template definition   h:\dropbox\sch\cs3202\code\test\testqueryevaluator\testgetcandidatelist.h   22 
```

什么是正确的语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T12:34:10.413

只需创建一个转发功能：

```
template<class T> 
inline void _assert(const string& message, T expected, T actual) 
{ CPPUNIT_ASSERT_EQUAL_MESSAGE(message, expected, actual); } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:32:52.357

简单地说，没有正确的语法，因为正如 phoeagon 所说，那是一个宏，没有函数：

[请参阅参考资料](http://cppunit.sourceforge.net/doc/1.8.0/group___assertions.html#a1)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T12:40:16.950

`CPPUNIT_ASSERT_EQUAL_MESSAGE`是一个宏而不是一个函数，因此您可以使用`inline`函数的实际定义“包装”它（如先前的答案所建议的那样），或者只是`#define`一个别名宏：

```
#define _assert CPPUNIT_ASSERT_EQUAL_MESSAGE 
```

在这两者中，我会选择包装函数方法，以便可以在命名空间中声明它并避免命名冲突。

# .htaccess - ht访问pdf的链接

> ID：14921066
> 
> 赞同：0
> 
> 时间：2013-02-17T12:25:17.127
> 
> 标签：.htaccess, mod-rewrite

我有一个站点，其页面中的链接位于根目录中，其格式为：

/documents/mimecast-email_continuity_whitepaper.pdf（正确的物理路径）

但是当它出现在浏览器中时会导致以下错误（命名正确的路径）

“此网页存在重定向循环 位于 name-of-website/documents/Comtec-Relocations-Case-Study-v4.pdf 的网页导致重定向过多。清除此站点的 cookie 或允许第三方 cookie 可能会修复问题。如果不是，则可能是服务器配置问题，而不是您的计算机问题。以下是一些建议：稍后重新加载此网页。了解有关此问题的更多信息。

错误 310 (net::ERR_TOO_MANY_REDIRECTS)：重定向太多。”

我输入的规则是

-.htaccess（在文件中）----------（在我的根目录中-所有网页所在的位置）

```
Options +FollowSymLinks

RewriteBase /
RewriteEngine On
RewriteCond %{REQUEST_URI} \.(pdf)$
RewriteRule (.*) http://dev.comtec.com/$1 [R=301,L] 
```

（编辑为我的第一个问题不是很明确的道歉）

欣赏任何想法

ķ

# regex - 如何更改嵌套引号？

> ID：14921070
> 
> 赞同：2
> 
> 时间：2013-02-17T12:25:26.837
> 
> 标签：regex, perl

我正在寻找如何更改花哨的引号的方法：`"abc"`-> `«abc»`。

它在简单的情况下对我有用，我正在寻找的下一步是如何让它与嵌套引号一起工作：`"abc "d e f" ghi"`->`«abc «d e f» ghi»`

```
$pk =~ s/
  "(                          # first qoute, start capture
    [\p{Word}\.]+?            # at least one word-char or point
    .*?\b[\.,?!]*?            # any char followed boundary + opt. punctuation
  )"                          # stop capture, ending quote
  /«$1»/xg;                   # change to fancy 
```

我希望正则表达式能够匹配第一个和第三个引号并更改它们。它确实如此。问题是：我希望然后再次匹配第 2 和第 4，但它不会，因为第 2 已经落后了。一种解决方案是再次运行相同的替换，直到其中的引号字符少于 2 个。

有没有更好的方法来实现我的目标？当会有第三层嵌套时，我的方法将不起作用，这不是我的目标，我保留 2 层。

* * *

**注意！**在单独的替换中更改 startquote 和 enquote 将不起作用，因为这样也会替换单个双引号。只有当他们看起来像情侣时，我才需要更换！

更多示例：

```
"abc "d e f" -> «abc "d e f»
"abc"d e f" -> «abc"d e f» 
```

这似乎是不可能的：

```
"abc" d e f" -> «abc" d e f» 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T12:42:48.477

没有通用的方法来配对嵌套的双引号。如果您的引号总是紧挨着单词的开头或结尾，那么这可能会起作用。它将非空格字符之前的双引号替换为开引号，并将非空格字符之后的双引号替换为右引号。

```
use strict;
use warnings;
use utf8;

my $string = '"abc "d e f" ghi"';

$string =~ s/"(?=\S)/«/g;
$string =~ s/(?<=\S)"/»/g;

print $string; 
```

**输出**

```
«abc «d e f» ghi» 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T12:44:54.550

您可以使用否定的环视断言来找到您花哨的报价的匹配方向。双重否定有助于处理边缘情况（例如行的结束/开始）。为简单起见，我在这里使用`<<`and`>>`而不是您花哨的报价。

```
use strict;
use warnings;

while (<DATA>) {
    s/(?<!\S)"(?!\s)/<</g;
    s/(?<!\s)"(?!\S)/>>/g;
    print;
}

__DATA__
"abc "d e f" ghi" 
```

**输出：**

```
<<abc <<d e f>> ghi>> 
```

# android - 启动并绑定到同一个服务

> ID：14921076
> 
> 赞同：0
> 
> 时间：2013-02-17T12:25:42.610
> 
> 标签：绑定到该服务的活动都与它解除绑定时，无论您调用, stopservice, android, android-service

我对启动服务和绑定服务有点困惑。因此，对于[Android 开发人员 -](http://developer.android.com/guide/components/services.html#Lifecycle)如果您启动服务并在调用 stopservice 时绑定到它，则管理服务生命周期，只有当所有[绑定到该服务的活动都与它解除绑定时，无论您调用](/questions/tagged/bound "显示标记为“绑定”的问题")[stopservice](/questions/tagged/stopservice "显示标记为“停止服务”的问题")服务都会停止。我认为如果您调用 stopService 服务将立即停止。在我的活动中，我启动服务并仅从此活动绑定到它。所以当我想停止活动时，我还必须先调用 unbind 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T12:52:43.280

您应该在绑定到服务的活动的 onDestory() 方法上调用服务实例上的 unBind。这通常用于绑定和取消绑定服务。如果您在活动的 onCreate() 中绑定它，则必须在 onDestroy 中取消绑定()。

# android - Android“试图在光标关闭后访问它”

> ID：14921078
> 
> 赞同：2
> 
> 时间：2013-02-17T12:25:56.347
> 
> 标签：android, adapter, android-imageview, android-gridview, android-cursor

我正在尝试调整[HelloGridView](http://developer.android.com/guide/topics/ui/layout/gridview.html)示例，以便我可以显示存储在 SD 上的图像的图像缩略图，而不是 res/drawable 中的图像。这个想法是首先在 ImageView.initialize() 函数中创建一个包含图像的列表，然后使用它几乎与示例中的一样。

我的光标有问题，首先我尝试在 Imageview.initialize() 函数中将它设为私有（它只是被注释掉了，所以你可以看到我有它）因为对我来说它似乎只是被使用在那里，但后来我收到错误“试图在游标关闭后访问它。” 在该行的 onCreate() 函数中

gridview.setAdapter(imageAdapter);

所以这条线显然以某种方式使用它。下一次尝试是将光标设置为“全局”并在该行之后关闭它，但我得到了同样的错误，但现在当我离开 onCreate() 时。这就是现在的代码，我不知道该怎么做。另外，如果您发现任何其他看起来很奇怪的东西，请告诉我，因为我对 android 和 java 非常陌生。

```
package se.mmarks.hellogridview;

import java.util.ArrayList;

import android.app.Activity;
import android.content.Context;
import android.database.Cursor;
import android.os.Bundle;
import android.provider.MediaStore;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.BaseAdapter;
import android.widget.GridView;
import android.widget.ImageView;
import android.widget.Toast;

public class MainActivity extends Activity {

    private Cursor imagecursor;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        GridView gridview = (GridView) findViewById(R.id.gridview);
        ImageAdapter imageAdapter = new ImageAdapter(this, imagecursor);
        imagecursor = imageAdapter.initialize();
        gridview.setAdapter(imageAdapter);
        /* setAdapter needs the cursor,
         * this is why it is closed here and not in ImageAdapter.initialize()
        */
        imagecursor.close();

        gridview.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View v, int position, long id) {
            Toast.makeText(MainActivity.this, "" + position, Toast.LENGTH_SHORT).show();
            }
        });
    }
}

class ImageAdapter extends BaseAdapter {
    private ArrayList<ImageView> images = new ArrayList<ImageView>();
    Cursor imagecursor = null;

    private Context mContext;

    public ImageAdapter(Context c, Cursor cursor) {
        mContext = c;
        imagecursor = cursor;
    }

    public Cursor initialize() {
        final String[] columns = { MediaStore.Images.Thumbnails._ID };
        imagecursor = null;
        try {
            imagecursor = mContext.getContentResolver().query(
                        MediaStore.Images.Media.EXTERNAL_CONTENT_URI, columns, null, null, null);
        } catch(Exception e) {
            e.printStackTrace();
        }

        if(imagecursor != null){
            int image_column_index = imagecursor.getColumnIndex(MediaStore.Images.Thumbnails._ID);
            int count = imagecursor.getCount();
            for (int i = 0; i < count; i++) {
                imagecursor.moveToPosition(i);
                int id = imagecursor.getInt(image_column_index);
                ImageView imageItem = new ImageView(mContext);
                imageItem.setId(id);
                imageItem.setImageBitmap(
                    MediaStore.Images.Thumbnails.getThumbnail(mContext.getContentResolver(), id,
                    MediaStore.Images.Thumbnails.MICRO_KIND, null));
                images.add(imageItem);
            }
            //imagecursor.close();
        }
        return imagecursor;
    }

    @Override
    public int getCount() {
        return imagecursor.getCount();
    }

    @Override
    public Object getItem(int position) {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public long getItemId(int position) {
        // TODO Auto-generated method stub
        return 0;
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imageView;
        if (convertView == null) {  // if it's not recycled, initialize some attributes
            imageView = images.get(position);
            imageView.setLayoutParams(new GridView.LayoutParams(85, 85));
            imageView.setScaleType(ImageView.ScaleType.CENTER_CROP);
            imageView.setPadding(8, 8, 8, 8);
        } else {
            imageView = (ImageView) convertView;
        }
        return imageView;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T12:51:13.813

> Android“试图在光标关闭后访问它”</p>

在您工作/访问 中的数据时`Cursor`，需要将其打开！

一般建议在Activity的生命周期方法或者方法中关闭任何**数据源**和**游标**。`onStop()``onDestroy()`

基本示例：

```
public void onDestroy() {
   super.onDestroy();
   if (cursor != null) {
      c.close();
   }
   if (db != null) {
      db.close();
   }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-25T12:52:56.950

由于我没有足够的声誉来发表评论......

我必须补充一个事实，即使正确答案说您可以关闭光标**onDestroy()**，但这不是您应该做的事情。

onDestroy 方法不保证会调用 Cursor.close()，因为 android 本身不保证最终会调用 onDestroy。

从文档：

> onDestroy() = 在销毁活动之前收到的最后一个调用。这可能是因为 Activity 正在完成（有人在其上调用了 finish()，或者因为系统正在临时销毁该 Activity 实例以节省空间。您可以使用 isFinishing() 方法区分这两种情况。

# javascript - Javascript：在函数外部初始化变量并在函数内部使用

> ID：14921079
> 
> 赞同：0
> 
> 时间：2013-02-17T12:26:04.757
> 
> 标签：javascript, global-variables

这是我的 JavaScript 代码

```
var helper = document.getElementById("helper");

helper.style.position = "relative";
helper.style.width = "50px";
helper.style.height = "50px";
helper.style.border = "1px solid #000";

function move() {
    helper.style.left = event.offsetX + "px";
    helper.style.top = event.offsetY + "px";
} 
```

和我的html代码

```
<div id="grid" onmousemove="move()" onmousedown="down()">
    <div id="helper"></div>
</div> 
```

但是当我调用该函数时，什么也没有发生。我希望该变量助手具有全局性并且所有内容都已预先初始化，因此在调用函数时我不必重新初始化所有内容

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T12:28:40.253

您的`move`函数*确实*可以访问该`helper`变量。我的猜测是您显示的代码位于页面`script`元素*上方*的`helper`元素中，因此当您的`var helper = document.getElementById("helper");`行运行时，该元素尚不存在。

另请注意，您的`move`处理程序依赖于特定于 IE 的行为（全局`event`对象）。尽管其他一些浏览器也提供了此行为以实现兼容性，但并非所有人都提供。为了使其更广泛地兼容，接受`event`作为参数：

```
function move(event) {
    // ...
} 
```

...并像这样更新您的 DOM0 处理程序：

```
<div id="grid" onmousemove="move(event)" onmousedown="down(event)"> 
```

这是有效的，因为调用处理程序中的代码的范围`onXYZ`总是有一个`event`符号，即使没有全局符号。

或者，当然，使用`addEventListener`(`attachEvent`在较旧的 IE 版本上)。

# sql-server - EF 为 SQL OUTPUT 子句生成结果对象

> ID：14921080
> 
> 赞同：1
> 
> 时间：2013-02-17T12:26:13.123
> 
> 标签：sql-server, entity-framework, tsql

我该怎么做才能让 EF 了解`output`SP 中的子句并相应地生成结果对象？

```
 INSERT INTO goodtable
   (token,
   ip, long_ip,
  ) OUTPUT INSERTED.*
  VALUES
   (@token,
   @ip, @long_ip,
 ); 
```

我目前为避免这种情况所做的是编写一个虚拟选择，生成对象并注释掉虚拟选择留下输出。从长远来看，这不是一个好的解决方案。

**请不要建议更改 SQL。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:48:40.680

你有没有尝试过。将存储过程导入 EF 时，使用函数导入添加`returns a collection of`选项。 ![这是对话框](../Images/6a335979aa1653441aa0ed19346160fc.png)

我从未尝试过，但看不出它不起作用的原因。

# dynamics-crm-2011 - 从 CRM 2011 在其他数据库中创建记录

> ID：14921085
> 
> 赞同：2
> 
> 时间：2013-02-17T12:26:33.637
> 
> 标签：dynamics-crm-2011

是否有任何解决方案可以根据 CRM 2011 记录在其他数据库中创建记录？当在 CRM 2011 中创建诸如“成本”之类的记录时，我们希望在 Oracle DB 中创建记录。可以通过插件完成吗？或者应该为此创建一个服务？您能否为此提供参考或解决方案。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:14:10.650

您可以使用插件在另一个系统中创建记录，尽管您需要考虑同步并确保不会重复，但肯定可以做到。

插件教程可以在[这里](http://msdn.microsoft.com/en-us/library/gg695782.aspx)找到。

您需要编写一个插件来运行`Create`并使用所创建`Cost`实体的信息在`Oracle`数据库中创建记录。

举个例子：

```
public void Execute(IServiceProvider serviceProvider)
{
    var context = (IPluginExecutionContext)serviceProvider.GetService(typeof(IPluginExecutionContext));

    //get the created entity from CRM
    var theCreatedEntity = context.InputParameters["Target"] as Entity;

    //build up a stored procedure call
    using (OracleConnection objConn = new OracleConnection("connection string"))
    {
        var cmd = new OracleCommand();
        cmd.Connection = objConn;
        cmd.CommandText = "stored procedure name";
        cmd.CommandType = CommandType.StoredProcedure;
        cmd.Parameters.Add("param1", OracleType.Number).Value = theCreatedEntity.GetAttributeValue<int>("Attribute1");
        cmd.Parameters.Add("param2", OracleType.Number).Value = theCreatedEntity.GetAttributeValue<int>("Attribute2");

        //etc
        cmd.ExecuteNonQuery();
    }
} 
```

这应该给你足够的去开始

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T14:30:53.297

不久前，我们收到了一位客户的类似要求。他们声称 CRM 的数据库不值得信任，并希望安全地存储在 SQL Server 中创建的记录的副本——你猜怎么着——SQL Server。（是的，**我们**确实理解其中的讽刺意味。**他们**没有。）

我们解决它的方法是创建一个插件。但是，请记住，仅仅对*Create*的消息做出反应是行不通的。您需要为三个 CRUD 操作设置一个侦听器（检索不会影响外部数据库，因此它是 C_UD 操作）。

这是主要的*Execute*方法的框架。

```
public void Execute(IServiceProvider serviceProvider)
{
  Context = GetContextFromProvider(serviceProvider);
  Service = GetServiceFromProvider(serviceProvider);

  switch (Context.MessageName)
  {
    case "Create": ExecuteCreate(); break;
    case "Update": ExecuteUpdate(); break;
    case "Delete": ExecuteDelete(); break;
  }
} 
```

在此调度程序之后，您可以实现对其他数据库的实际调用。我想告诉你三个问题。

1.  当 CRM 没有为您提供合适的值时，请记住为外部数据库提供合适的值。
2.  将插件注册为异步，因为您将与外部资源交谈。
3.  考虑实体引用的问题，是否也递归存储它们。

[插件构建的演练](http://msdn.microsoft.com/en-us/library/gg695782.aspx)
[链接到 CRM SDK 如果你没有](http://www.microsoft.com/en-us/download/details.aspx?id=24004)
[注册插件的信息](http://www.resultondemand.nl/support/sdk/c0adf742-e0b7-4699-8972-afe0638af4e4.htm)
除此之外，我在我的博客中有一个演练（包括代码和结构）。它的 URL，你必须自己弄清楚 - 我不会自我推销，但这与我的名字和 WP 有关。谷歌是你的朋友。:)

# utf-8 - 将 BOM 附加到 plone.namedfile 字段

> ID：14921086
> 
> 赞同：1
> 
> 时间：2013-02-17T12:26:36.330
> 
> 标签：utf-8, plone, blob, zope, byte-order-mark

我需要将 BOM 预先添加到我的 Dexterity 类型上的 NamedBlobFile 字段，以使 Windows 用户满意，但将文件保留在 blobstorage 中。

在不更改文件系统上的实际文件的情况下连接到 Zope 的文件流的推荐方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:18:19.767

我会走向不同的方向：

*   禁止记事本。真的，坏软件就是坏软件，你只能去修复它的缺点。

*   *使用*BOM保存 UTF-8 文件；U+FEFF 表示“零宽度无间断空间”，“普通”软件大多会忽略它。

# c# - 递归获取目录和文件？

> ID：14921090
> 
> 赞同：2
> 
> 时间：2013-02-17T12:26:47.413
> 
> 标签：c#

可以通过递归获取所有目录、子目录和文件。

我这样做是因为我想增加我的编程逻辑，并了解递归是如何工作的。

我知道用这种方式做到这一点：

```
 string path = "D://";
            string rezdir,newpath;
            DirectoryInfo di = new DirectoryInfo(path);
            DirectoryInfo[] dir = di.GetDirectories().ToArray();
            for (int i = 0; i < di.GetDirectories().Length; i++)
            {
                Console.WriteLine(dir[i].ToString());
            }
            Console.WriteLine("\n\nChoose File: ");
            rezdir = Console.ReadLine();
            newpath = path + rezdir;
            di = new DirectoryInfo(newpath);
            dir = di.GetDirectories().ToArray();
            for (int i = 0; i < di.GetDirectories().Length; i++)
            {
                Console.WriteLine(dir[i].ToString());
            }
            Console.ReadKey(); 
```

但是我不使用递归方式来做到这一点，所以有人可以做到这一点，我会很感激他。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:31:38.860

是的，有可能。但我确实建议您首先了解什么是递归。简单来说，递归有*一次性执行*部分和*多次执行*部分。那一次触发多次部分。

在这个问题中，一次性执行部分可能是获取根目录下所有目录的列表。

然后对于每个目录，您将获得所有子目录和文件。这是很多次的部分。但是，要多次运行一批代码，您需要将它们捆绑到一个可调用的例程、过程、方法或函数中，无论您如何称呼它。只是代码包。

```
public void DoDirectories()
{
    // one-time part; get a list of directories to start with.
    List<string> rootDirectories = Directory.GetDirectories("c:\\").ToList();
    foreach (string rootDirectory in rootDirectories)
    {
        GetSubdirectories(rootDirectory);
    }
}

public List<string> GetSubdirectories(string parentDirectory)
{
    List<string> subdirecotries = Directory.GetDirectories(
        parentDirectory, "*.*", SearchOption.TopDirectoryOnly).ToList();
    foreach (string subdirectory in subdirecotries)
    {
        GetSubdirectories(subdirectory); // recursing happens here
    }
    return subdirecotries;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:33:35.413

我会避免编码，因为这是一个有价值的学习练习。尝试自己完成它：一旦完成，您就会*知道*您了解递归。

要递归，方法需要调用自身。想象一个方法

```
public static void ShowDirectory(int indentationLevel, DirectoryInfo path) 
```

已经为你写好了。这使得编写正文更容易：

1.  获取目录中的所有文件，并在循环中打印它们的名称
2.  获取目录中的所有目录，并在下一个缩进级别显示它们的内容。你需要另一个循环。

第一步是编写循环的简单练习。第二个练习也变得很容易，因为您可以将其`ShowDirectory`视为预先编写的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T12:45:26.477

按照您发布的代码 - 您似乎想要一些用户交互 - 所以尝试这样的事情：

```
 public static class RecursiveTest
{
    public static string Foo(DirectoryInfo currentPath)
    {
        if (!currentPath.Exists) return string.Empty;

        foreach (var directory in currentPath.EnumerateDirectories())
            Console.WriteLine("Directory {0}", directory.Name);

        foreach (var file in currentPath.EnumerateFiles())
            Console.WriteLine("File {0}", file.Name);

        while(true)
        {
            Console.WriteLine("Choose directory or file: ");
            string chosenPath = Console.ReadLine();

            string newPath = Path.Combine(currentPath.FullName, chosenPath);
            if(Directory.Exists(newPath))
                return Foo(new DirectoryInfo(newPath));

            if(File.Exists(newPath))
                return newPath;

            Console.WriteLine("File {0} doesn't exist!", newPath);
        }
    }
} 
```

并用这样的东西打电话：

```
class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine(RecursiveTest.Foo(new DirectoryInfo(@"d:\dev")));

        Console.ReadLine();
    }
} 
```

高温高压

# mysql - Mysql 表结构工作快吗？

> ID：14921092
> 
> 赞同：1
> 
> 时间：2013-02-17T12:27:00.490
> 
> 标签：mysql, sql, join, database-design, database-performance

我打算创建一个类似于 IMDB.com 的网站。为了减少执行时间，我使用以下结构。可以更快地工作吗？

```
表格1

Id Movie_name 描述

1 名称 1 一些描述
2 名称 2 一些描述
3 名称 三 一些 描述

表 2

id 演员名
1 个名字 1
2 名称 2
3 名称 3
4 名称 4

表3

id 电影id 演员id

1 1 1
2 1 2
3 1 3
4 1 9
5 2 6
6 2 5
7 2 8
8 2 1

```

当我想在电影节目中列出演员时，将从表 3 中检索演员 ID，并从表 2 中找到相应的名称（使用单个查询）。当我想列出演员的电影时，它将从表 3 中检索电影 ID，并从第一个表中找到相应的名称。它会正常工作吗？还有其他想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T12:32:49.770

这将给指定电影中的所有演员，

```
SELECT  c.ID, c.actorName
FROM    table1 a
        INNER JOIN table3 b
            ON a.ID = b.movieID
        INNER JOIN table2 c
            ON b.actorid = c.ID
WHERE   a.ID = 1 
```

这将为指定演员提供所有电影

```
SELECT  a.*
FROM    table1 a
        INNER JOIN table3 b
            ON a.ID = b.movieID
        INNER JOIN table2 c
            ON b.actorid = c.ID
WHERE   c.ID = 1 
```

*   [SQLFiddle 演示（*两个查询*）](http://www.sqlfiddle.com/#!2/ad951/2)

要进一步了解有关联接的更多信息，请访问以下链接：

*   [SQL 连接的可视化表示](http://www.codeproject.com/Articles/33052/Visual-Representation-of-SQL-Joins)

**更新 1**

这就是所谓的`Relational Division`

```
SELECT  a.ID, a.Movie_Name
FROM    table1 a
        INNER JOIN table3 b
            ON a.ID = b.movieID
        INNER JOIN table2 c
            ON b.actorid = c.ID
WHERE   c.ID IN (1, 2, 3)
GROUP   BY a.ID, a.Movie_Name
HAVING  COUNT(DISTINCT c.ID) = 3 
```

*   [关系划分的SQL](http://www.simple-talk.com/sql/t-sql-programming/divided-we-stand-the-sql-of-relational-division/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:37:04.310

我建议你通过去掉 id 字段来修改 table3。一起使用 movieid 和 actorid 作为主键。您可能希望在此表中添加其他字段，例如 Jermaine Xu 的评论中建议的角色名称和出现顺序。

# javascript - 默认情况下如何更改图纸管理器选择选项？

> ID：14921099
> 
> 赞同：13
> 
> 时间：2013-02-17T12:27:43.840
> 
> 标签：javascript, google-maps-api-3, drawing

我使用`google.maps.drawing.DrawingManager`它看起来像：

```
drawingManager = new google.maps.drawing.DrawingManager({
    drawingMode: google.maps.drawing.OverlayType.MARKER,
    markerOptions: {
        draggable: true,
        optimized: false,
        icon: new google.maps.MarkerImage('uxt/images/ap_gif.gif')
    },
    drawingControlOptions: {
        position: google.maps.ControlPosition.TOP_CENTER,
        drawingModes: [
        google.maps.drawing.OverlayType.MARKER,
        google.maps.drawing.OverlayType.POLYGON
        ]
    },

    polygonOptions: {
        fillColor: '#1E90FF',
        strokeWeight: 0,
        fillOpacity: 0.3,
        editable: true
    },
    map: mapA
}); 
```

所以我的工具栏看起来像： ![在此处输入图像描述](../Images/731f3041d97c8680b30d0d625a4cd425.png)

正如您在默认情况下看到的（页面重新加载后）标记被选中，但我需要选择“手”（“停止绘图”）。 ![在此处输入图像描述](../Images/7b1f9604a4520510239760dffcd0ffcc.png)

我如何配置drawingManager来做到这一点？

谢谢你。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-17T12:54:43.270

只需将`drawingMode`选项设置为`null`：

```
drawingManager = new google.maps.drawing.DrawingManager({
    drawingMode: null,
    ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:32:27.530

请检查以下代码。如果它不起作用，请查看这篇文章[Google Maps API v3: Drawing Manager](https://stackoverflow.com/questions/11020407/google-maps-api-v3-drawing-manager)这可能会有所帮助

```
 var markers = [];
  var infowindow = new google.maps.InfoWindow();

  function initialize() {
    map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    drawingManager.setMap(map);
    google.maps.event.addListener(drawingManager, 'overlaycomplete', function(event) {
      if(event.type == google.maps.drawing.OverlayType.POLYLINE) {
        alert("polyline complete");
      }
      else if(event.type == google.maps.drawing.OverlayType.MARKER) {
        var newMarker = event.overlay;
        newMarker.content = "marker #" + markers.length;
        google.maps.event.addListener(newMarker, 'click', function() {
          infowindow.setContent(this.content);
          infowindow.open(map, this);
        });
        markers.push(newMarker);
      }
    });
  } 
```

# django - 未定义 Django 错误全局名称“csrf”

> ID：14921103
> 
> 赞同：1
> 
> 时间：2013-02-17T12:28:14.867
> 
> 标签：django

我正在使用本教程创建一个论坛。[http://lightbird.net/dbe/forum1.html](http://lightbird.net/dbe/forum1.html)

我收到此错误，但我不知道 csrf 来自哪些模块？我怎么知道？

```
 NameError at /forum/forum/1/

 global name 'csrf' is not defined

 Request Method:    GET
 Request URL:   http://127.0.0.1:8000/forum/forum/1/
 Django Version:    1.4.3
 Exception Type:    NameError
 Exception Value:   

 global name 'csrf' is not defined

 Exception Location:    C:\djcode\mysite\forum\views.py in add_csrf, line 25
 Python Executable:     C:\Python26\python.exe
 Python Version:    2.6.0
 Python Path:   

 ['C:\\djcode\\mysite',
  'C:\\Python26\\python26.zip',
  'C:\\Python26\\DLLs',
  'C:\\Python26\\lib',
  'C:\\Python26\\lib\\plat-win',
  'C:\\Python26\\lib\\lib-tk',
  'C:\\Python26',
  'C:\\Python26\\lib\\site-packages',
  'C:\\Python26\\lib\\site-packages\\PIL']

 Server time:   Sun, 17 Feb 2013 23:21:02 +1100 
```

错误在这里。在我看来.py

```
 from django.core.urlresolvers import reverse
  from mysite.settings import MEDIA_ROOT, MEDIA_URL
  from forum.models import Forum
  from django.shortcuts import render_to_response
  from forum.models import Thread
  from django.core.paginator import Paginator, InvalidPage, EmptyPage
  def main(request):
      """Main listing."""
      forums = Forum.objects.all()
      return render_to_response("forum/list.html", dict(forums=forums, user=request.user))
  def forum(request, pk):
      """Listing of threads in a forum."""
      threads = Thread.objects.filter(forum=pk).order_by("-created")
      threads = mk_paginator(request, threads, 20)
      return render_to_response("forum/forum.html", add_csrf(request, threads=threads, pk=pk))
  def thread(request, pk):
      """Listing of posts in a thread."""
      posts = Post.objects.filter(thread=pk).order_by("created")
      posts = mk_paginator(request, posts, 15)
      title = Thread.objects.get(pk=pk).title
      return render_to_response("forum/thread.html", add_csrf(request, posts=posts, pk=pk,
    title=title, media_url=MEDIA_URL))
  def add_csrf(request, ** kwargs):
      d = dict(user=request.user, ** kwargs)
      d.update(csrf(request))
      return d

  def mk_paginator(request, items, num_items):
      """Create and return a paginator."""
      paginator = Paginator(items, num_items)
      try: page = int(request.GET.get("page", '1'))
      except ValueError: page = 1

      try:
          items = paginator.page(page)
      except (InvalidPage, EmptyPage):
          items = paginator.page(paginator.num_pages)
      return items 
```

我不知道要导入 csrf 的模块是什么

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T12:30:59.577

`django.core.context_processors import csrf`我从:]中找到了答案

# java - 有向图和无向图 - Java

> ID：14921108
> 
> 赞同：1
> 
> 时间：2013-02-17T12:28:44.313
> 
> 标签：java, graph

我正在实施一些算法来自学图表以及如何使用它们。你会推荐什么是在 Java 中做到这一点的最佳方法？

我只是想问你是否可以为有向图和加权有向图的简短非常简单的类定义提供简短的帮助？

我查看了网络，但我不想要它的实现，只是类的简短定义......你认为最好的数据结构是什么？相邻列表？

对于无向图，我将其定义如下：

```
public interface Graph { 
  Collection vertices();  // returns a collection of all the 
        //   Vertex objects in the graph 
  Collection edges();  // returns a collection of all the 
     //   Edge objects in the graph 
  Collection incidentEdges(Vertex v); // returns a collection of  
       //   Edges incident to v 
  boolean isAdjacent(Vertex v, Vertex w); // return true if v and     
}                 //   w are adjacent 

public class Vertex { 
  public boolean visited;  // initially false for all vertices 
} 

public class Edge { 
  Vertex v1, v2;     // undirected edge 
  Vertex opposite(Vertex v); // given a vertex return the one 
}          // at the other end of this edge 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:22:35.890

这是一个简单的实现（这对于许多基本用例来说应该足够好了）：

```
public class Graph { 
  public List<Node> nodes = new ArrayList<Node>();
}                

public class Node{
  public List<Node> neighbors = new ArrayList<Node>();
 //here you can add stuff like "public boolean visited;", if your algorithm requires it
} 
```

（这只是一个例子——有很多方法可以实现图结构）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:41:46.153

要使用的数据结构取决于您的代码的目的......列表通常做得很好，但如果图形高度连接（大多数节点连接到大多数节点），那么列表很麻烦，并且通常首选某种矩阵。

例如，要使用矩阵，请保留节点向量，然后使用整数的二维向量来引用节点。

另外，为了制作一个轻量级的类，你不必为节点声明一个类：你可以提供添加节点和边的函数，你可以用整数来识别这些元素。

如果您计划对它们进行子类化（例如，在执行显示图形的 GUI 时可能很有用），则拥有 Node 或 Edge 类可能是合适的，但如果您需要某些算法的图形，则使用整数识别节点/边会更快，并且更简单。

# java - 如何在 Java 中交换 2 个字符串数组的内容并写入另一个数组

> ID：14921113
> 
> 赞同：-3
> 
> 时间：2013-02-17T12:29:01.290
> 
> 标签：java, string

这是为了我的项目工作，我被困在这部分。我主要有2个字符串；

```
String str = "Testing split me Difficult ";

String str1 = "Testing me split"; 
```

我已根据空格将 str 和 str1 拆分为 2 个数组。它们是这样的：

```
String[] tokens = ["Testing","Split", "Me", "Difficult"]

String[] tokens1 = ["Testing","me", "Split"] 
```

对于 2 数组中的每个 2 索引，它应用百分比函数。如果百分比相同，它必须从第二个数组中获取 2 字符串并将其添加到数组列表中。

这是我所拥有的：

```
Public class SplitString {

/**
 * @param args
 */
public static void main(String[] args) {
    // TODO Auto-generated method stub
            ArrayList arrayList = new ArrayList();
    String str = "Testing split me Difficult;

    String str1 = "Testing me split";
    String[] tokens = str.split("\\s");
    String[] tokens1 = str1.split("\\s");
    for(int i =0;i<tokens.length;i++){
        if(tokens[i].equals(tokens1[i])){
                 arrayList.add(tokens[i]);

        }
        if(Percentage.getpercentagedifference(tokens[i], token[i++]) == Percentage.getpercentagedifference(tokens1[i], tokens1[i++]) ){

                     // I am stuck on how to take the 2 string and swap the contents

                    }
                 else{
                     arrayList.add(tokens[i]);

                 }
}

}
} 
```

Percentage.getpercentagedifference 只是一个接受 2 个字符串并返回其百分比差异的函数

结果输出是这样的：

```
String newlist = "Testing me split Difficult "; 
```

不明白的可以看看这个，或许有帮助：

![图片](../Images/24418f7c230a20d62dab3c6146e9acea.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:17:08.133

我想我们大多数人都不明白你在做什么。不过有一个提示，

您正在使用

```
getpercentagedifference(tokens[i], tokens[i++]) // changes i afterwards 
```

所以你给方法两次相同的字符串。你可能想要

```
getpercentagedifference(tokens[i], tokens[i + 1]) // doesn't change i 
```

由于我们仍然不明白您实际上要做什么，以下是如何从 2 个不同的数组中交换 2 个字符串：

```
String[] fruits = new String[]{"Apples", "Bananas", "Melons", "Oranges"};
String[] animals = new String[]{"Cats", "Dogs", "Horses", "Zebras"};
String temp = fruits[1]; // save Bananas
fruits[1] = animals[1];  // replace Bananas with Dogs in fruit array
animals[1] = temp;       // replace Dogs with Bananas in animals array
System.out.println(Arrays.toString(fruits)); // prints [Apples, Dogs, Melons, Oranges]
System.out.println(Arrays.toString(animals)); // prints [Cats, Bananas, Horses, Zebras] 
```

# java - 有没有办法检查二维数组中的索引/位置？对于java

> ID：14921117
> 
> 赞同：-1
> 
> 时间：2013-02-17T12:29:43.303
> 
> 标签：java, arrays

如果我构造一个二维数组，例如

```
Object[][] myArray = new Object[5][5]; 
```

我使用for循环遍历数组，有没有办法检查我当前的位置是否是某个索引？

喜欢

```
if(myArray[3][4]) {
    .....
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:32:29.577

像这样？

```
for(int i = 0; i < myArray.length; i++) {
    Object[] row = myArray[i];
    for(int j = 0; j < row.length; j++) {
        Object o = row[j];
        foo(o);
        if(i == 3 && j == 4) bar(o);
    }
} 
```

但是你为什么要这样做而不是`bar(myArray[3][4])`在循环后调用呢？

# wordpress - Wordpress 保留缓存旧式脚本

> ID：14921119
> 
> 赞同：0
> 
> 时间：2013-02-17T12:29:45.207
> 
> 标签：wordpress, caching

美好的一天

我有一个 wordpress 网站。现在我正在使用一个主题，并且我通过使用内联样式和 !important 基本上覆盖了样式表 (style.css) 中的样式。问题是当我刷新浏览器时，旧样式会返回。当我按 ctrl + f5 时，将应用我的新样式。好吧，你想……问题是，即使我完全清除了浏览器历史记录、cookie 等，并且我用 f5 加载页面，它也会再次加载旧样式。所以它真正加载我的新样式的唯一时间是当我按下 ctrl+f5 时。我尝试了不同的浏览器，但我的网站上没有任何缓存插件...

问题可能是什么？
谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:46:00.320

浏览器喜欢缓存。在包含样式表的标题中追加`?1`，`?2`等，并每次更新以强制浏览器刷新您的样式表。

```
<link rel="stylesheet" type="text/css" href="<?php bloginfo('stylesheet_url'); ?>?1" media="screen" />
                                                                                 ^^ 
```

或者看起来像这样

```
<link rel="stylesheet" type="text/css" href="<?php bloginfo('template_directory'); ?>/filename.css?1" media="screen" />
                                                                                                  ^^ 
```

这不会影响其中包含的 CSS。

# mysql - MySQL语句在两个表中查找数据

> ID：14921122
> 
> 赞同：0
> 
> 时间：2013-02-17T12:29:57.360
> 
> 标签：mysql, join

我很讨厌在 MySQL 中进行连接，我很确定这是我完成这项工作所需要的（尽管如果我错了，请纠正我）。

所以我有两张桌子。下面是建立一个简单数据库的 SQL：

```
CREATE TABLE IF NOT EXISTS `wp_usermeta` (
`umeta_id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
`user_id` bigint(20) unsigned NOT NULL DEFAULT '0',
`meta_key` varchar(255) DEFAULT NULL,
`meta_value` longtext,
PRIMARY KEY (`umeta_id`),
KEY `user_id` (`user_id`),
KEY `meta_key` (`meta_key`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

INSERT INTO `wp_usermeta` (`umeta_id`, `user_id`, `meta_key`, `meta_value`) VALUES
(1, 1, 'first_name', 'David'),
(2, 1, 'last_name', 'Jones'),
(3, 1, 'nickname', 'david'),
(4, 1, 'newsletter', '1'),
(5, 2, 'first_name', 'Greg'),
(6, 2, 'last_name', 'Smith'),
(7, 2, 'nickname', 'greg'),
(8, 2, 'newsletter', '0');

CREATE TABLE IF NOT EXISTS `wp_users` (
`ID` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
`user_login` varchar(60) NOT NULL DEFAULT '',
`user_pass` varchar(64) NOT NULL DEFAULT '',
`user_nicename` varchar(50) NOT NULL DEFAULT '',
`user_email` varchar(100) NOT NULL DEFAULT '',
PRIMARY KEY (`ID`),
KEY `user_login_key` (`user_login`),
KEY `user_nicename` (`user_nicename`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=1 ;

INSERT INTO `wp_users` (`ID`, `user_login`, `user_pass`, `user_nicename`, `user_email`) VALUES
(1, 'david', '$^*#NNR&Y&)Mn9emfdfsdfsdfsd', 'david', 'david@domain.com'),
(2, 'greg', 'fdfsdfsdfsd$^*#NNR&Y&)Mn9em', 'greg', 'greg@domain.com'); 
```

...并且我需要为一个基本页面编写一个语句，该页面仅查找订阅了时事通讯的用户（**meta_key**的**meta_value**为**1**）并显示他们的**first_name**和**user_email**。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:33:59.487

它需要一个相当简单的连接；

```
SELECT user_login FROM wp_users
JOIN wp_usermeta
  ON wp_users.id=wp_usermeta.user_id
WHERE meta_key='newsletter'
  AND meta_value=1; 
```

[SQLfiddle 玩](http://sqlfiddle.com/#!2/b260c4/4)。

# php - PHP：处理从 imap 附件获取的 CSV

> ID：14921123
> 
> 赞同：0
> 
> 时间：2013-02-17T12:30:12.720
> 
> 标签：php, imap, email-attachments

我知道，有`fgetcsv`处理每一行 csv 文件的函数。但是，如果我没有文件，而是通过 imap php 函数（如、、...）从电子邮件中获取的附件（字符串？）`imap_fetchstructure`怎么`imap_fetchbody`办`imap_base64`。

有没有简单的可能性，还是我必须手动处理？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T12:32:44.627

还有[`str_getcsv`](http://php.net/manual/en/function.str-getcsv.php)函数（来自 PHP >= 5.3）

# mercurial - 如何在.hgignore 中排除根目录中的路径？

> ID：14921136
> 
> 赞同：1
> 
> 时间：2013-02-17T12:31:40.823
> 
> 标签：mercurial

例如，我有文件结构：

```
app
- media
media 
```

如果我添加行

```
media 
```

对于 .hgignore，将排除两个文件夹（媒体、应用程序/媒体）。但我只想从项目根目录（./media）中排除媒体文件夹。我需要一个适用于 Linux 和 Windows 的解决方案。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T12:42:02.890

它只是一个正则表达式（除非您`syntax: glob`在文件中将其切换为 glob）。因此，您可以使用`^`匹配路径的开头（因为它在存储库中）并`$`匹配结尾。

```
^media$ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:37:35.080

我有类似的需求，我在忽略文件中输入了以下内容：

```
^target/.*
/target/.* 
```

第一个条目将忽略根目录中的目标目录。
第二个条目将忽略内部目录中的任何目标目录。

对我们很有效（win 和 linux）

我希望这有帮助。

# android - 安卓多点触控

> ID：14921138
> 
> 赞同：1
> 
> 时间：2013-02-17T12:31:43.047
> 
> 标签：android, multi-touch, touch-event

我正在尝试进行多点触控控制，但是当我以不同的顺序移开手指时，我总是会出错，因为我将手指放在屏幕上。

```
@Override
public boolean onTouchEvent(MotionEvent event) {
    pointers = event.getPointerCount();
    for(int a = 0; a < event.getPointerCount(); a++) {
        expos[a] = (int) event.getX(event.getPointerId(a));
        eypos[a] = (int) event.getY(event.getPointerId(a));
    }
    if(event.getAction() == MotionEvent.ACTION_DOWN) pressed = true;
    if(event.getAction() == MotionEvent.ACTION_UP) pressed = false;
    return true;
} 
```

我认为问题是当我移除第一根手指时，第二根手指仍然有 id 2，但我能做些什么来修复它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:49:01.223

据我了解，问题是当您松开其中一根手指时您没有收到 ACTION_UP 事件。解决方案是使用 ACTION_POINTER_UP。它将检测任何非主指针的释放并应该解决问题

# java - Android，如何防止屏幕来电显示

> ID：14921144
> 
> 赞同：1
> 
> 时间：2013-02-17T12:32:38.063
> 
> 标签：java, android

我正在开发来电显示应用程序，直到现在我能够检测来电并替换以下默认屏幕呼叫：

```
public class IncomingCallListener extends BroadcastReceiver {

@Override
public void onReceive(Context context, Intent intent) {
    Bundle extras = intent.getExtras();
    if (extras == null)
        return;
    String state = intent.getStringExtra(TelephonyManager.EXTRA_STATE);
    if (state == null)
        return;

    // phone is ringing
    if (state.equals(TelephonyManager.EXTRA_STATE_RINGING)) {

        Call.launch(context);

    } 
```

但是，我们面临的问题如下：当手机接到来电时，我们的自定义屏幕呼叫在 1 秒后开始，默认来电屏幕优先并显示。

我的问题是：有没有办法防止默认屏幕呼叫显示？或者有什么技巧可以让我的自定义来电屏幕获得优先权？谢谢。

# android - 数据库文件在android真实设备中不起作用

> ID：14921147
> 
> 赞同：-1
> 
> 时间：2013-02-17T12:32:45.027
> 
> 标签：android

我是android的初学者。我开发了一个测验应用程序。我创建的数据库在模拟器中运行良好，在此站点上搜索后，我知道它存储在数据/包名称/数据库位置。当我连接设备并将其用作模拟器时，它不会访问数据库。它显示一个空数据库。我搜索了该站点，并从评价很高的问题中找到了将数据库文件移动到设备的 sdcard 的问题，因此我使用了以下代码：

```
public class DatabaseFile extends SQLiteOpenHelper {

    public static final String DATABASE_NAME="Quiz.db";
    public static final String QUES="ques";
    public static final String OP1="op1";
    public static final String OP2="op2";
    public static final String OP3="op3";
    public static final String ANS="ans";
    public static final String NAME="name";
    public static final String CANS="cans";
    public static final String SCORE="score";

    public DatabaseFile(Context context)
    {
            super(context, DATABASE_NAME, null, 1);
            try {
                File sd = Environment.getExternalStorageDirectory();
                File data = Environment.getDataDirectory();

                if (sd.canWrite()) {
                     String currentDBPath ="/data/com.example.quizproject.StartQuiz/databases/Quiz.db";
                     String backupDBPath = "/backup/"+"Quiz.db";
                     File currentDB = new File(data, currentDBPath);
                     File backupDB = new File(sd, backupDBPath);

                     if (currentDB.exists()) {
                         FileChannel src = new   FileInputStream(currentDB).getChannel();
                         FileChannel dst = new FileOutputStream(backupDB).getChannel();
                         dst.transferFrom(src, 0, src.size());
                         src.close();
                         dst.close();
                     } else {
                         String TAG = null;
                        Log.e(TAG, "File does not exist: " + currentDBPath);
                     }
                }

             } catch (Exception e) {

                 Toast.makeText(getBaseContext(), e.toString(), Toast.LENGTH_LONG).show();

             }
    }

    public void onCreate(SQLiteDatabase db)
    {
        db.execSQL("CREATE TABLE quiztable (_id INTEGER PRIMARY KEY AUTOINCREMENT," +
        "ques TEXT, op1 TEXT, op2 TEXT, op3 TEXT, ans TEXT);");

    }

    private Context getBaseContext() {
        // TODO Auto-generated method stub
        return null;
    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        // TODO Auto-generated method stub

    }

} 
```

我还在清单文件中添加了在 sdcard 上写入的权限。上面的代码对我不起作用。它仍然显示一个空数据库，并且数据库的副本也没有在 sdcard 中创建。作为附加信息，我正在使用模拟器访问数据库

```
DatabaseFile dbfile;
SQLiteDatabase sqldb;
dbfile=new DatabaseFile(this);
sqldb=dbfile.getWritableDatabase(); 
```

当我将应用程序连接到真实设备时，代码是否会保持不变？？？？我连接的设备是 Galaxy y。

plzzz帮助我.....我已经到处搜索了bt找不到任何解决方案哪里出错了？？？为什么数据库文件没有传输到 sdcard？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T12:51:32.177

您不需要在您的 SD 卡上复制数据库。它在设备上也能正常工作。

从您的设备上卸载应用程序。清除所有数据。

从您的资产文件夹中删除数据库并再次复制。

如果不起作用。更改数据库名称并再次复制。

# python - 如何让python从导入的txt文件中检测字典中的空格？

> ID：14921153
> 
> 赞同：-1
> 
> 时间：2013-02-17T12:33:25.983
> 
> 标签：python, dictionary, translation

好的，我在这里遇到的问题是我有这个 .txt 文件 Python 导入字典。

它所做的是从文本文件中获取值，这些值是这种特定格式的：

```
a 0.01                   
b 0.11
c 1.11
d 0.02 
```

^（以代码格式，因为它不会像在 .txt 中那样堆叠它，而不是实际代码），然后将它们放入这样的字典中：

d = { 'a':'0.01', 'b':'0.11, 等....}

好吧，我正在使用它，以便它将用户输入的任何值（稍后在脚本中）更改为字典中定义的任何值。

问题是如果我尝试让它包含一个空间，它就是行不通的。

就像，我完成了字母，以及它们在 .txt 中的相应值，然后开始讨论符号：

例如：

```
& &
* * 
```

（这样当输入字典时，当我让它打印翻译后的消息时会打印相应的值）（我可以改变它们，但我决定保持原样）

当我尝试让用户输入中的空格对应于已翻译消息中的空格或其他值时，就会出现问题。

我尝试在我的 .txt 中将一行留空，这样（空格）就是（空格）

但后来，当它试图加载 .txt 时，它给了我一个错误，说：“需要多个值来解压”

有人可以帮我吗？

编辑：根据要求添加代码。

```
TRvalues = {}
with open(r"C:\Users\Owatch\Documents\Python\Unisung Net Send\nsed.txt") as f:
    for line in f:
        (key, val) = line.split()
        TRvalues[key] = val
if TRvalues == False:
    print("\n\tError encountered while attempting to load the .txt file")
    print("\n\t The file does not contain any values")
else:
    print("Dictionary Loaded-") 
```

示例文本文件：

```
a 0.01
b 0.11
c 1.11
d 0.02
e 0.22
f 2.22
g 0.03
h 0.33
i 3.33
j 0.04
k 0.44
l 4.44
m 0.05
n 0.55
o 5.55
p 0.06
q 0.66
r 6.66
s 0.07
t 0.77
u 7.77
v 0.08
w 0.88
x 8.88
y 0.09
z 0.99 
```

当我尝试运行脚本时出现此错误：

```
Traceback (most recent call last):
  File "C:/Users/Owatch/Documents/Python/Unisung Net Send/Input Encryption 0.02.py", line 17, in <module>
    (key, val) = line.split()
ValueError: need more than 0 values to unpack 
```

编辑：**感谢大家投票！我现在已经不能提问了。**

信不信由你，我确实知道这个网站的规则，并且在询问 Stack Overflow 之前做了研究。它对其他人也有帮助。多么美好的社区。希望回答的人没有投反对票。我很欣赏他们所做的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:05:55.443

如果我理解正确，您正在尝试将空格用作未引用的值和分隔符，这是行不通的。我会使用该`csv`模块及其引用规则。例如（假设您在`print`函数中使用 Python 3）：

```
import csv

with open('nsed.txt', newline='') as f:
    reader = csv.reader((line.strip() for line in f), delimiter=' ')
    TRvalues = dict(reader)

print(TRvalues) 
```

输入文件为

```
a 0.01
b 0.11
c 1.11
d 0.02
" " " " 
```

给

```
{' ': ' ', 'a': '0.01', 'b': '0.11', 'c': '1.11', 'd': '0.02'} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:53:34.190

看来您实际上是在尝试这样做。

```
In [177]: "a b".split()
Out[177]: ['a', 'b']

In [178]: "  ".split()
Out[178]: [] 
```

即有一个空行，并希望在执行 split() 时保留空格，但这不起作用。

因此`k, v = line.split()`不会工作。

**编辑**假设我理解这个问题。

也许您需要在将值放入文件时对其进行编码，然后在输出时进行解码。

一种天真的方法可能是使用`urrlib.quote`和`urllib.unquote`

在写。

```
In [188]: urllib.quote(' ')
Out[188]: '%20' 
```

这对于特殊情况来说有点棘手，`space`除非您对写入文件的所有值都这样做。

```
fd.write("%s %s\n" % (urllib.encode(val1), urllib.encode(val2))) 
```

然后就从文件中读取。

```
k,v = map(urrlib.unquote, lines.split()) 
```

# excel - Excel VBA :: 在循环中查找函数

> ID：14921155
> 
> 赞同：1
> 
> 时间：2013-02-17T12:33:34.690
> 
> 标签：excel, vba, macos, find

我正在尝试遍历几个工作表，其中包含一些必须复制到一个主工作表的源数据，这里称为“PriorityList”。首先，子不工作，我认为错误是在“**查找**”方法的某个地方。其次，子程序需要很长时间才能运行，我认为这可能是因为“查找”方法搜索整个工作表而不是仅搜索相关范围？

非常感谢您的回答！

帕特里克

```
Sub PriorityCheck()
'Sub module to actualise the PriorityList

Dim CurrWS As Long, StartWS As Long, EndWS As Long, ScheduleWS As Long
StartWS = Sheets("H_HS").Index
EndWS = Sheets("E_2").Index

Dim SourceCell As Range, Destcell As Range

For CurrWS = StartWS To EndWS

    For Each SourceCell In Worksheets(CurrWS).Range("G4:G73")

        On Error Resume Next

        'Use of the find method
        Set Destcell = Worksheets(CurrWS).Cells.Find(What:=SourceCell.Value, After:=Worksheets("PriorityList").Range("A1"), LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False)

        'Copying relevant data from source sheet to main sheet
        If Destcell <> Nothing Then
            Destcell.Offset(0, 2).Value = SourceCell.Offset(0, 5).Value + Destcell.Offset(0, 2).Value
            If SourceCell.Offset(0, 3).Value = "x" Then Destcell.Offset(0, 3).Value = "x"
            End If
        End If

        On Error GoTo 0

    Next SourceCell

Next CurrWS

End Sub 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T20:45:29.460

这里简短的示例如何**使用“查找”方法在 priorityList 中查找 source.Value 的第一次出现**。

**源单元格**是*“G4:G73”*范围内的单元格之一，**priorityList**用于*“PriorityList”*表上的范围。希望这可以帮助。

```
Public Sub PriorityCheck()
    Dim source As Range
    Dim priorityList As Range
    Dim result As Range

    Set priorityList = Worksheets("PriorityList").UsedRange

    Dim i As Long
    For i = Worksheets("H_HS").Index To Worksheets("E_2").Index
        For Each source In Worksheets(i).Range("G4:G73")
            Set result = priorityList.Find(What:=source.Value)
            If (Not result Is Nothing) Then
                ' do stuff with result here ...
                Debug.Print result.Worksheet.Name & ", " & result.Address
            End If
        Next source
    Next i
End Sub 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T13:38:56.310

这是一种使用`arrays`. 您将每个范围保存到一个数组中，然后遍历数组以满足您的 if-else 条件。顺便说一句，如果您想找到代码错误的确切行，那么您必须注释`On Error Resume Next`行.. :) 此外，您可以简单地将值存储到一个新数组中，稍后在遍历所有工作表后将其他所有内容转储到主工作表中。来回查看工作表、代码、工作表..代码..

```
Dim sourceArray as Variant, priorityArray as Variant
'-- specify the correct priority List range here
'-- if multi-column then use following method
priorityArray = Worksheets(CurrWS).Range("A1:B10").Value
'-- if single column use this method
' priorityArray = WorkSheetFunction.Transpose(Worksheets(CurrWS).Range("A1:A10").Value)

For CurrWS = StartWS To EndWS
   On Error Resume Next    
   sourceArray = Worksheets(CurrWS).Range("G4:J73").Value
   For i = Lbound(sourceArray,1) to UBound(sourceArray,1)
     For j = Lbound(priorityArray,1) to UBound(priorityArray,1)
        If Not IsEmpty(vArr(i,1)) Then    '-- use first column
        '-- do your validations here..
        '-- offset(0,3) refers to J column from G column, that means
        '---- sourceArray(i,3)...
        '-- you can either choose to update priority List sheet here or
        '---- you may copy data into a new array which is same size as priorityArray
        '------ as you deem..
        End If
     Next j
   Next i       
Next CurrWS 
```

PS：不是在安装了MS Excel的机器前试试这个。因此，将上述代码视为未经测试的代码。出于同样的原因，我无法运行您的`find`方法。但这似乎很奇怪。使用时不要忘记，`match`否则`find`进行正确的错误处理很重要。尝试查看`find`此处提供的基于 [ 的解决方案。

*   [VBA 在查找函数运行时错误 91](https://stackoverflow.com/questions/9199951/vba-in-find-function-runtime-error-91/9200091#9200091)
*   [Excel 2007 VBA 查找功能。试图在两张纸之间找到数据并将其放入第三张纸中](https://stackoverflow.com/questions/5095801/excel-2007-vba-find-function-trying-to-find-data-between-two-sheets-and-put-it)

我已经编辑了初始代码以包含使用两个数组的主要逻辑。由于您需要引用`J`源表列中的值，因此您需要将源数组调整为二维数组。因此，您可以使用第一列进行验证，然后根据需要检索数据。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T14:13:15.290

对于大家可能感兴趣，这是我最终使用的代码版本（与 Daniel Dusek 建议的版本非常相似）：

```
Sub PriorityCheck()
    Dim Source As Range
    Dim PriorityList As Range
    Dim Dest As Range

    Set PriorityList = Worksheets("PriorityList").UsedRange

    Dim i As Long

    For i = Worksheets("H_HS").Index To Worksheets("S_14").Index
        For Each Source In Worksheets(i).Range("G4:G73")
        If Source <> "" Then
            Set Dest = PriorityList.Find(What:=Source.Value)
            If Not Dest Is Nothing Then
                If Dest <> "" Then
                    Dest.Offset(0, 2).ClearContents
                    Dest.Offset(0, 2).Value = Source.Offset(0, 5).Value + Dest.Offset(0, 2).Value
                End If
            If Source.Offset(0, 3).Value = "x" Then Dest.Offset(0, 3).Value = "x"
                Debug.Print Dest.Worksheet.Name & ", " & Dest.Address
            End If
        End If
        Next Source
    Next i

    MsgBox "Update Priority List completed!"

End Sub 
```

# sockets - 使用 Java 套接字重现写入-写入-读取延迟

> ID：14921160
> 
> 赞同：3
> 
> 时间：2013-02-17T12:33:55.130
> 
> 标签：sockets, tcp, java-io, nagle

我已经读过三件事的组合会导致 TCP 延迟 200 毫秒：Nagle 算法、延迟确认和“写-写-读”组合。但是，我无法使用 Java 套接字重现这种延迟，因此我不确定我是否理解正确。

我正在使用 Java 7 在 Windows 7 上运行测试，其中两个线程在环回地址上使用套接字。我没有触及任何套接字上的 tcpNoDelay 选项（默认为 false），也没有在操作系统上使用任何 TCP 设置。客户端中的主要代码如下。服务器在从客户端接收到的每两个字节后响应一个字节。

```
for (int i = 0; i < 100; i++) {
    client.getOutputStream().write(1);
    client.getOutputStream().write(2);
    System.out.println(client.getInputStream().read());
} 
```

我没有看到任何延迟。为什么不？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-21T19:34:30.287

我相信您会看到延迟确认。您将 4 个和 4 个字节写入套接字。服务器的 TCP 堆栈接收一个段（可能包含来自 int 数的至少 4 个字节）并唤醒服务器应用程序线程。该线程将一个字节写回流中，并且该字节在 ACK 段内发送到客户端。即 TCP 堆栈让应用程序有机会立即发送回复。所以你看不到延迟。您可以编写流量转储，还可以在两台计算机之间进行实验以查看实际发生的情况。

# python - 两次对话时出现空白窗口？

> ID：14921178
> 
> 赞同：0
> 
> 时间：2013-02-17T12:36:59.403
> 
> 标签：python, linux, gtk, gnome, pygobject

我完成了一个应用程序设计，没有发生任何有用的事情，但我有两个窗口。一个是主窗口，一个是关于对话。它们都在 Glade 的一个 .ui 文件中。

当我使用帮助>关于（在我的程序中）打开关于对话框时，一切正常。使用相同的方法将其关闭并再次打开会导致空白窗口。

这是我的代码：

```
#! /usr/bin/env python3

from gi.repository import Gtk

class window():
    def __init__(self):
        self.builder = Gtk.Builder()

        self.builder.add_from_file("./personalinfo.ui")

        self.mainWindow = self.builder.get_object("mainWindow")

        self.mainWindow.connect("destroy", self.on_mainWindow_destroy)

        self.mainWindow.set_title("Persona")

        self.mainWindowMainBoxButtonBoxCancel = self.builder.get_object("mainWindowMainBoxButtonBoxCancel")

        self.mainWindowMainBoxButtonBoxCancel.connect("clicked", self.on_mainWindowMainBoxButtonBoxCancel_clicked)

        self.mainWindowMainBoxButtonBoxOK = self.builder.get_object("mainWindowMainBoxButtonBoxOK")

        self.mainWindowMainBoxButtonBoxOK.connect("clicked", self.on_mainWindowMainBoxButtonBoxOK_clicked)

        self.mainWindowMainBoxGenderBoxCombo  = self.builder.get_object("mainWindowMainBoxGenderBoxCombo")

        self.mainWindowMainBoxGenderBoxCombo.set_active(0)

        self.mainWindowMainBoxMenuFileMenuQuit = self.builder.get_object("mainWindowMainBoxMenuFileMenuQuit")

        self.mainWindowMainBoxMenuFileMenuQuit.connect("activate", self.on_mainWindowMainBoxMenuFileMenuQuit_activate)

        self.mainWindowMainBoxMenuHelpMenuAbout = self.builder.get_object("mainWindowMainBoxMenuHelpMenuAbout")

        self.mainWindowMainBoxMenuHelpMenuAbout.connect("activate", self.on_mainWindowMainBoxMenuHelpMenuAbout_activate)

        self.mainWindow.show_all()

    def on_mainWindow_destroy(self, widget):
        print("destroy: 'mainWindow'")

        Gtk.main_quit()

    def on_mainWindowMainBoxButtonBoxCancel_clicked(self, widget):
        print("clicked: 'mainWindowMainBoxButtonBoxCancel'")

        Gtk.main_quit()

    def on_mainWindowMainBoxButtonBoxOK_clicked(self, widget):
        print("clicked: 'mainWindowMainBoxButtonBoxOK'")

        Gtk.main_quit()

    def on_mainWindowMainBoxMenuFileMenuQuit_activate(self, widget):
        print("activate: 'mainWindowMainBoxMenuFileMenuQuit'")

        Gtk.main_quit()

    def on_mainWindowMainBoxMenuHelpMenuAbout_activate(self, widget):
        print("activate: 'mainWindowMainBoxMenuHelpMenuAbout'")

        self.aboutWindow = self.builder.get_object("aboutWindow")

        self.aboutWindow.set_title("About Persona")

        self.aboutWindowMainBoxButtonBoxOK = self.builder.get_object("aboutWindowMainBoxButtonBoxOK")

        self.aboutWindowMainBoxButtonBoxOK.connect("clicked", self.on_aboutWindowMainBoxButtonBoxOK_clicked)

        self.aboutWindow.show_all()

    def on_aboutWindowMainBoxButtonBoxOK_clicked(self, widget):
        print("clicked: 'aboutWindowMainBoxButtonBoxOK'")

        self.aboutWindow.destroy()

w = window()

Gtk.main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T23:19:51.710

每次调用`self.aboutWindow = self.builder.get_object("aboutWindow")`时都不会创建 About 窗口，它会在加载 UI 文件时创建一次。因此，当您调用`self.aboutWindow.destroy()`它时，它将永远销毁它，并且下次您尝试显示该窗口时，它不再存在。

您可能不想破坏窗口，而是想隐藏它`self.aboutWindow.hide()`

# c# - 摆脱列表中的空白 位于字典中

> ID：14921185
> 
> 赞同：1
> 
> 时间：2013-02-17T12:37:48.477
> 
> 标签：c#, list, dictionary, trim

我有一个以字符串为键、以列表为值的字典。

```
Dictionary<string, List<string>> dict = new Dictionary<string, List<string>>(); 
```

因此，对于每个键，都有几个与该键关联的字符串值。问题是列表值包含一些我需要摆脱的空白，我所做的是使用 trim() 方法将每个列表值的值传递给不同的列表，然后在循环之后将其分配回原始列表。

```
List<string> lstNoWhite = new List<string>();
foreach (var kvp in dict)
{

    for(int i = 0; i < kvp.Value.Count; i++)
    {
        lstNoWhite.Add(kvp.Value[i].Trim());
    }
    kvp.Value = lstNoWhite;
} 
```

但是，我确实收到了错误...由于该列表是只读的，因此无法分配给该列表。

哪个是摆脱空白的更好​​方法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T12:43:08.847

您可以稍微修改您的代码以摆脱中间列表：

```
foreach (var kvp in dict)
        {
            for(int i = 0; i < kvp.Value.Count; i++)
            {
                kvp.Value[i] = kvp.Value[i].Trim();
            }
        } 
```

这将修剪列表中所有字符串中的所有空格

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T12:47:34.827

试试这个代码：

```
// source dictionary
Dictionary<string, List<string>> dict = new Dictionary<string, List<string>>();

// target dictionary
Dictionary<string, List<string>> target = new Dictionary<string, List<string>>();

// using LINQ extension methods
dict.ToList().ForEach(i =>
{
    List<string> temp = i.Value.Select(x => x.Trim()).ToList();
    target.Add(i.Key, temp);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T12:47:52.340

你也可以这样做：

```
Dictionary<string, List<string>> dict = new Dictionary<string, List<string>>();

// var --> Dictionary<string, List<string>>
var trimmedDict = dict.ToDictionary(
    keyValue => keyValue.Key, // The key
    keyValue => keyValue.Value.Select(s => s.Trim()).ToList() // The value, trim all the strings in the value-list
); 
```

# c# - 错误：找不到路径

> ID：14921188
> 
> 赞同：0
> 
> 时间：2013-02-17T12:38:30.527
> 
> 标签：c#

我有一个小问题，这让我现在很生气。我的代码中有一个小错误，然后我发现了错误并且一切运行良好 - 几乎。我必须在解决方案中找到文件的路径，现在我找到了。但是如果我打开表单的设计，它会给我错误

“找不到路径 'C:\Windows\system32\Source\ChampsList.txt' 的一部分”

就行了，应该是哪里出了问题，什么都没有。我可以忽略这个问题，一切都运行良好。但是，我仍然讨厌这个：

![这个](../Images/70a570aa204d87e1f14b832504760d1a.png)

谢谢

```
this.AutoScaleDimensions = new System.Drawing.SizeF(6F, 13F);
        this.AutoScaleMode = System.Windows.Forms.AutoScaleMode.Font;
        this.ClientSize = new System.Drawing.Size(1083, 569);
        this.Controls.Add(this.guides1);
        this.Controls.Add(this.MainMenu); // this is line where "is" mistake
        this.Controls.Add(this.Panels);
        this.Controls.Add(this.Strip);
        this.MainMenuStrip = this.MainMenu;
        this.Name = "MainProgram";
        this.Text = "Porgram";
        this.WindowState = System.Windows.Forms.FormWindowState.Maximized;
        this.Load += new System.EventHandler(this.AppLoad);
        this.MainMenu.ResumeLayout(false);
        this.MainMenu.PerformLayout();
        this.Strip.ResumeLayout(false);
        this.Strip.PerformLayout();
        this.Panels.ResumeLayout(false);
        this.ResumeLayout(false);
        this.PerformLayout(); 
```

调用堆栈：

```
at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath)
at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)
at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options, String msgPath, Boolean bFromProxy, Boolean useLongPath, Boolean checkHost)
at System.IO.StreamReader..ctor(String path, Encoding encoding, Boolean detectEncodingFromByteOrderMarks, Int32 bufferSize, Boolean checkHost)
at System.IO.File.InternalReadAllText(String path, Encoding encoding, Boolean checkHost)
at System.IO.File.ReadAllText(String path)
at HelpApp.Guides.Guides_Load(Object sender, EventArgs e) in c:\Users\Lukáš\Documents\Visual Studio 2010\Projects\HelpApp\HelpApp\Guides.cs:line 28
at System.Windows.Forms.UserControl.OnLoad(EventArgs e)
at System.Windows.Forms.UserControl.OnCreateControl()
at System.Windows.Forms.Control.CreateControl(Boolean fIgnoreVisible)
at System.Windows.Forms.Control.CreateControl()
at System.Windows.Forms.Control.ControlCollection.Add(Control value)
at System.Windows.Forms.Form.ControlCollection.Add(Control value)
at System.Windows.Forms.Design.ControlDesigner.DesignerControlCollection.Add(Control c) 
```

# java - 在java中使用递归来反转整数列表数组

> ID：14921197
> 
> 赞同：0
> 
> 时间：2013-02-17T12:39:55.030
> 
> 标签：java, recursion

对此有任何帮助将不胜感激。我是一年级编程学生，这是一个关于递归的家庭作业。1.我们必须递归地构建一个数组列表（在下面完成并针对最小的问题工作，然后更高） 2.使用线束测试它（也在下面） 3.然后我们必须制作数组列表的克隆副本（我认为正在工作）并编写一个方法来递归地反转数组列表并将其包含在 ListMethodRunner 测试中；这就是我卡住的地方。我在下面包含了我的代码，它在“list = reverseList(list.remove(0));”上引发了一个错误 在 reverseList 方法中。我哪里出错了有什么建议吗？

//列出方法 import java.util.*;

```
public class ListMethods
{
//new method that produces an array list of integers (tempList) based on input of int n
public static ArrayList<Integer> makeList(int n)
{
  ArrayList<Integer> tempList = null;
  if (n <= 0)  // The smallest list we can make
  {

      tempList = new ArrayList<Integer>(); // ceate the list tempList
      return tempList;                      //return blank list for this if statement

  }
  else        // All other size lists are created here
  {

      tempList = makeList(n-1); //recursively go through each variation of n from top down, when reach 0 will create the list
      tempList.add(n); // program will then come back up through the variations adding each value as it goes

  }
  return tempList; //return the tempList population with all the variations

   }

//create a copy of the values in the array list (tlist) and put it in (list)- used in next method
public static ArrayList<Integer> deepClone(ArrayList<Integer> tList)
{
   ArrayList<Integer> list = new ArrayList<Integer>();
   for (Integer i : tList)
   {
       list.add(new Integer(i));
    }
    return list;
}
//method that creates arraylist
   public static ArrayList<Integer> reverseList(ArrayList<Integer> tList)
  {
   ArrayList<Integer> list = ListMethods.deepClone(tList);
 if (list.size()<=1)    // The list is empty or has one element
   {
      return list;// Return the list as is – no need to reverse!
 }
 else
 {
   list = reverseList(list.remove(0)); //recurse through each smaller list 
                                        //removing first value until get to 1 and will create list above
   list.add(0);
  // Use the solution to a smaller version of the problem
 // to solve the general problem
 }
 return list;
 }
}

//List  Methods Runner

import java.util.ArrayList;

public class ListMethodsRunner
{
 public static void main(String[] args)
{
  ArrayList<Integer> tempList = ListMethods.makeList(100);
  if (tempList.size() == 0)
  {
      System.out.println("The list is empty");
  }
  else
  {
     for (Integer i : tempList)
     {
        System.out.println(i);
     }
  }

     }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T12:49:46.990

代替

```
list = reverseList(list.remove(0)) 
```

和

```
list.remove(0);
list = reverseList(list); 
```

`ArrayList::remove(int)`返回从列表中删除的元素。（`Integer`在这种情况下输入）

`reverseList`需要一个`ArrayList<Integer>`as 参数。因此错误。

您还必须在再次插入之前存储元素。您的代码应如下所示：

```
Integer num = list.remove(0);
list = reverseList(list); 
list.add(num); 
```

# python - Python中的记忆

> ID：14921203
> 
> 赞同：0
> 
> 时间：2013-02-17T12:41:11.097
> 
> 标签：python

我真的很喜欢你在理解 Python 中的 Memoization 使用方面的帮助。我是 Python 新手，我不确定如何理解这种语法。

```
def fib_mem(n):
    return fib_mem_helper(n,[0,1]+[-1]*(n-1))

def fib_mem_helper(i,mem):
    if mem[i] == -1:
        mem[i]=fib_mem_helper(i-1,mem) + fib_mem_helper(i-2,mem)
        return mem[i] 
```

这是我看到的使用记忆化评估斐波那契数的代码，这是什么`[0,1]+[-1]*(n-1)`意思？你能解释一下这种类型的写作代表什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:45:20.950

`[0, 1] + [-1] * (n - 1)`意思是“连接两个列表，一个是`[0, 1]`，另一个是`-1`重复`n-1`次数”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:47:27.037

[-1]*5 将创建一个包含五个元素为 -1 的新列表，即 [-1 -1 -1 -1 -1]

[0 1]+[-1]*5 将追加两个列表成为 [0 1 -1 -1 -1 -1 -1]

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T13:23:36.150

记忆是一种避免重复计算相同问题的技术。我会回到你的问题，但这里有一个更容易理解的解决方案。

```
mem = {0:0, 1:1}

def fib(n):
    global mem
    if mem.get(n,-1) == -1:
        mem[n] = fib(n-1) + fib(n-2)
    return mem[n] 
```

通过创建`mem`一个全局变量，您可以利用对`fib()`. 该行`mem.get(n,-1) == -1`检查是否`mem`已经包含 的计算`n`。如果是，则返回结果`mem[n]`。否则，它会递归调用`fib()`计算`fib(n)`并将其存储在`mem[n]`.

* * *

让我们来看看你的代码。这里的第二个参数`fib_mem_helper(n,[0,1]+[-1]*(n-1))`传递一个 [0,1,-1,-1,...] 形式的列表，长度为`(n+1)`. 在`fib_mem_helper`函数中，此列表由变量引用`mem`。如果`mem[i]`结果是-1，则计算`m[i]`；否则使用已经计算的结果`mem[i]`。由于您没有坚持`mem`对 的调用`fib_mem()`，因此它的运行速度会慢一个数量级。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T12:45:28.493

不过，奇怪的编码。看起来像语法错误。但根据你的问题：

[0,1] 是一个包含两个元素的列表，第一个是整数 0，第二个是整数 1。

在 Python 中使用 memoization 的这种函数的合理实现是：

```
def fib(i):
    try:
        return fib._memory[i]
    except KeyError:
        pass
    if i == 1 or i == 2:
        return 1
    else:
        f = fib(i-1) + fib(i-2)
        fib._memory[i] = f
        return f
fib._memory = {} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T13:04:55.633

首先，我不得不说，即使在编辑之后，你的代码仍然有一个错误的缩进：`return mem[i]`应该是不缩进的。

在列表操作中，“+”表示串联，“*”表示重复，所以`[0,1]+[-1]*(n-1)`表示一个列表：[0, 1, -1, ..., -1](总共 (n-1) 个负 1)。

更多解释：

列表`[0, 1, -1, ..., -1]`存储计算的斐波那契序列（**记忆**）。最初它只包含两个有效值：0 和 1，所有“-1”元素表示该索引处的序列尚未计算。此备忘录作为第二个参数传递给 function `fib_mem_helper`。如果指定索引（即`i`）的斐波那契数尚未计算（测试是否`mem[i] == -1`），`fib_mem_helper`将递归计算它并将其存储到`mem[i]`. 如果已经计算过了，直接从备忘录中返回，无需重新计算。

这就是整个故事。

最后一句话：

这段代码效率不够高，尽管它使用了记忆。事实上，它每次调用时都会创建一个*新列表。*`fib_mem`例如，如果您调用`fib_mem(8)`两次，第二次调用仍然需要重新创建一个列表并重新计算所有内容。原因是您将备忘录存储*在*`fib_mem`. 要修复它，您可以将 memo 保存为外部的字典`fib_mem`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2014-11-08T23:30:33.203

当在某些函数上使用 memoization 时，python 的加速可以达到一百万倍或更多。这是斐波那契数列的一个例子。传统的递归方式是这样的，需要永远。

```
def recursive_fibonacci(number):
    if number==0 or number==1:
        return 1
    return recursive_fibonacci(number-1) + recursive_fibonacci(number-2)

print recursive_fibonacci(50), 
```

具有记忆化的相同算法需要几毫秒。自己试试吧！

```
def memoize(f):
    memo={}
    def helper(x):
        if x not in memo:
            memo[x]=f(x)
        return memo[x]
    return helper

@memoize
def recursive_fibonacci(number):
    if number==0 or number==1:
        return 1
    return recursive_fibonacci(number-1) + recursive_fibonacci(number-2)

print recursive_fibonacci(50), 
```

# ruby - 使用 Slim-lang 将数据传递给布局模板

> ID：14921206
> 
> 赞同：2
> 
> 时间：2013-02-17T12:41:57.413
> 
> 标签：ruby, slim-lang

我在将数据传递给 Slim 模板时遇到问题。我有以下**工作**代码（使用来自[此 SO 线程](https://stackoverflow.com/questions/7058993/specifying-a-layout-and-a-template-in-a-standalone-not-rails-ruby-app-using-s)的信息）：

```
l = Slim::Template.new { @layout } # How to pass data here?

_p = Slim::Template.new { @post_text }.render(Object.new, :post => post)
# Here passing data (post) works fine     -----------------^

out = l.render{ _p } 
```

我在模板中有什么：

**layout.slim**：

```
doctype
  html
  head
    title =my_title # < I cannot pass any parameters to this file
  body
    ==yield 
```

**post_text.slim**：

```
-unless post.nil?
  h1 =post[:title]
  hr
  =post[:text]
-else
  h2 No posts 
```

我的问题是在我的情况下如何将参数传递给布局模板？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T11:48:10.693

[phoet](https://stackoverflow.com/users/100731/phoet)应该写下他的评论作为答案，因为它有帮助：

```
l.render(Object.new, :my_title => 'bla') { _p } 
```

# java - appengine-application.xml

> ID：14921215
> 
> 赞同：12
> 
> 时间：2013-02-17T12:43:47.057
> 
> 标签：java, google-app-engine

更新到 GAE 1.7.5 后，运行时出现以下错误：

```
17/02/2013 11:27:50 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'D:\Workspaces\GoogleAppEng\cea-AppEngine\war' is not an EAR directory. File D:\Workspaces\GoogleAppEng\cea-AppEngine\war\appengine-application.xmlappengine-application.xml not detected.
17/02/2013 11:27:50 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'D:\Workspaces\GoogleAppEng\cea-AppEngine\war' is not an EAR directory. File D:\Workspaces\GoogleAppEng\cea-AppEngine\war\appengine-application.xmlappengine-application.xml not detected.
17/02/2013 11:27:50 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'D:\Workspaces\GoogleAppEng\cea-AppEngine\war' is not an EAR directory. File D:\Workspaces\GoogleAppEng\cea-AppEngine\war\appengine-application.xmlappengine-application.xml not detected.
17/02/2013 11:27:50 PM com.google.apphosting.utils.config.EarHelper logNotAnEar
INFO: Directory 'D:\Workspaces\GoogleAppEng\cea-AppEngine\war' is not an EAR directory. File D:\Workspaces\GoogleAppEng\cea-AppEngine\war\appengine-application.xmlappengine-application.xml not detected. 
```

我只有`appengine-web.xml`和没有`appengine-application.xml`。所以这`appengine-application.xml`是新的？我搜索 google 和 GAE，没有提及`appengine-application.xml`.

有什么帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-25T04:10:26.763

INFO 不是错误。请忽略。

我们可能会或可能不会工作的事情可能会或可能不会意外地提前泄漏。不说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-27T01:56:46.987

我有同样的错误。一旦我下载了最新的 Java JRE，它就消失了。我的项目仍然设置为使用 Java 6。我希望这会有所帮助。祝你好运。

# c# - 为什么取消大量HTTP请求时取消阻塞这么长时间？

> ID：14921218
> 
> 赞同：5
> 
> 时间：2013-02-17T12:44:52.473
> 
> 标签：c#, performance, .net-4.5, c#-5.0, cancellationtokensource

## 背景

我有一些代码使用来自一个特定主机的内容执行批处理 HTML 页面处理。它尝试使用`HttpClient`. 我相信同时连接的最大数量受 限制`ServicePointManager.DefaultConnectionLimit`，所以我没有应用我自己的并发限制。

将所有请求异步发送到`HttpClient`using`Task.WhenAll`后，可以使用`CancellationTokenSource`and取消整个批处理操作`CancellationToken`。通过用户界面可以查看操作的进度，并且可以单击按钮来执行取消。

## 问题

调用`CancellationTokenSource.Cancel()`阻塞大约 5 - 30 秒。这会导致用户界面冻结。怀疑发生这种情况是因为该方法正在调用注册取消通知的代码。

## 我所考虑的

1.  限制并发 HTTP 请求任务的数量。我认为这是一种解决方法，因为`HttpClient`似乎已经将多余的请求本身排队。
2.  `CancellationTokenSource.Cancel()`在非 UI 线程中执行方法调用。这效果不太好。直到大多数其他任务完成后，该任务才真正运行。我认为`async`该方法的一个版本会很好用，但我找不到。另外，我觉得它适合在 UI 线程中使用该方法。

## 示范

### 代码

```
class Program
{
    private const int desiredNumberOfConnections = 418;

    static void Main(string[] args)
    {
        ManyHttpRequestsTest().Wait();

        Console.WriteLine("Finished.");
        Console.ReadKey();
    }

    private static async Task ManyHttpRequestsTest()
    {
        using (var client = new HttpClient())
        using (var cancellationTokenSource = new CancellationTokenSource())
        {
            var requestsCompleted = 0;

            using (var allRequestsStarted = new CountdownEvent(desiredNumberOfConnections))
            {
                Action reportRequestStarted = () => allRequestsStarted.Signal();
                Action reportRequestCompleted = () => Interlocked.Increment(ref requestsCompleted);
                Func<int, Task> getHttpResponse = index => GetHttpResponse(client, cancellationTokenSource.Token, reportRequestStarted, reportRequestCompleted);
                var httpRequestTasks = Enumerable.Range(0, desiredNumberOfConnections).Select(getHttpResponse);

                Console.WriteLine("HTTP requests batch being initiated");
                var httpRequestsTask = Task.WhenAll(httpRequestTasks);

                Console.WriteLine("Starting {0} requests (simultaneous connection limit of {1})", desiredNumberOfConnections, ServicePointManager.DefaultConnectionLimit);
                allRequestsStarted.Wait();

                Cancel(cancellationTokenSource);
                await WaitForRequestsToFinish(httpRequestsTask);
            }

            Console.WriteLine("{0} HTTP requests were completed", requestsCompleted);
        }
    }

    private static void Cancel(CancellationTokenSource cancellationTokenSource)
    {
        Console.Write("Cancelling...");

        var stopwatch = Stopwatch.StartNew();
        cancellationTokenSource.Cancel();
        stopwatch.Stop();

        Console.WriteLine("took {0} seconds", stopwatch.Elapsed.TotalSeconds);
    }

    private static async Task WaitForRequestsToFinish(Task httpRequestsTask)
    {
        Console.WriteLine("Waiting for HTTP requests to finish");

        try
        {
            await httpRequestsTask;
        }
        catch (OperationCanceledException)
        {
            Console.WriteLine("HTTP requests were cancelled");
        }
    }

    private static async Task GetHttpResponse(HttpClient client, CancellationToken cancellationToken, Action reportStarted, Action reportFinished)
    {
        var getResponse = client.GetAsync("http://www.google.com", cancellationToken);

        reportStarted();
        using (var response = await getResponse)
            response.EnsureSuccessStatusCode();
        reportFinished();
    }
} 
```

### 输出

![控制台窗口显示取消阻止超过 13 秒](../Images/7a097cb25ad7a4f938072066ec660496.png)

**为什么取消阻止这么长时间？**另外，有什么我做错了或者可以做得更好吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T15:49:52.703

> 在非 UI 线程中执行 CancellationTokenSource.Cancel() 方法调用。这效果不太好。直到大多数其他任务完成后，该任务才真正运行。

这告诉我的是，您可能正遭受“线程池耗尽”的困扰，这是您的线程池队列中有太多项目（来自 HTTP 请求完成）的地方，需要一段时间才能完成所有项目。取消可能会阻塞某些正在执行的线程池工作项，并且它不能跳到队列的头部。

这表明您确实需要从考虑清单中选择选项 1。限制您自己的工作，以使线程池队列保持相对较短。无论如何，这对应用程序的整体响应能力是有好处的。

我最喜欢的限制异步工作的方法是使用[Dataflow](http://nuget.org/packages/microsoft.tpl.dataflow)。像这样的东西：

```
var block = new ActionBlock<Uri>(
    async uri => {
        var httpClient = new HttpClient(); // HttpClient isn't thread-safe, so protect against concurrency by using a dedicated instance for each request.
        var result = await httpClient.GetAsync(uri);
        // do more stuff with result.
    },
    new ExecutionDataflowBlockOptions { MaxDegreeOfParallelism = 20, CancellationToken = cancellationToken });
for (int i = 0; i < 1000; i++)
    block.Post(new Uri("http://www.server.com/req" + i));
block.Complete();
await block.Completion; // waits until everything is done or canceled. 
```

作为替代方案，您可以使用 Task.Factory.StartNew 传入 TaskCreationOptions.LongRunning 以便您的任务获得一个*新*线程（不隶属于线程池），这将允许它立即启动并从那里调用 Cancel。但是您可能应该解决线程池耗尽问题。

# javascript - 回发asp.net期间的进度条

> ID：14921228
> 
> 赞同：3
> 
> 时间：2013-02-17T12:46:06.873
> 
> 标签：javascript, jquery, asp.net

通过在`asp.net`. 然后在 Process Complete 之后显示一条插入数据的消息。我可以使用`Javascript`and来做到这一点`Jquery`吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T05:50:46.540

正如您必须了解的那样，没有简单的方法。

你必须做`pooling`or `web sockets`or `long pooling`，这意味着你必须在后台询问服务器他是否完成了工作。

```
Here is couple of examples to so: 
```

[http://www.singingeels.com/Articles/RealTime_Progress_Bar_With_ASPNET_AJAX.aspx](http://www.singingeels.com/Articles/RealTime_Progress_Bar_With_ASPNET_AJAX.aspx)

`here is on with SignalR`
[http://vivekcek.wordpress.com/2012/12/26/real-time-progress-bar-using-jquery-ui-and-signalr/](http://vivekcek.wordpress.com/2012/12/26/real-time-progress-bar-using-jquery-ui-and-signalr/) [http://msdn.microsoft.com/en-us/magazine/ hh852586.aspx](http://msdn.microsoft.com/en-us/magazine/hh852586.aspx)

# git - 如何删除 github 上的文件（远程）

> ID：14921229
> 
> 赞同：0
> 
> 时间：2013-02-17T12:46:13.467
> 
> 标签：git, github

我最近在`https://github.com/me/myRepo`. 然后在本地（在我的计算机上）我删除了一个`rm ~/myDir/myFile` 我现在正在尝试使其在 github 上消失但没有成功的文件。我做了：

```
cd ~/myDir
git rm myFile (I had already remove the file physically)
git add -A
git push 
```

但是文件还在...

当我做

```
git commit -a
git push 
```

这不起作用，我明白了

```
statquant@euclide:~/.vim$ git commit -a
# On branch master
# Your branch is ahead of 'origin/master' by 1 commit.
#
# Changes not staged for commit:
#   (use "git add <file>..." to update what will be committed)
#   (use "git checkout -- <file>..." to discard changes in working directory)
#   (commit or discard the untracked or modified content in submodules)
#
#   modified:   bundle/Align (untracked content)
#   modified:   bundle/Clang_Complete-Pathogen (untracked content)
#   modified:   bundle/Vim-R-plugin (untracked content)
#   modified:   bundle/bash-support.vim (untracked content)
#   modified:   bundle/git (untracked content)
#   modified:   bundle/nerdtree (untracked content)
#   modified:   bundle/perl-support.vim (untracked content)
#   modified:   bundle/snipmate (modified content, untracked content)
#   modified:   bundle/tasklist (modified content)
#
no changes added to commit (use "git add" and/or "git commit -a")
statquant@euclide:~/.vim$ git push
To https://github.com/statquant/.vim.git
 ! [rejected]        master -> master (non-fast-forward)
error: failed to push some refs to 'https://github.com/statquant/.vim.git'
To prevent you from losing history, non-fast-forward updates were rejected
Merge the remote changes (e.g. 'git pull') before pushing again.  See the
'Note about fast-forwards' section of 'git push --help' for details. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T12:47:48.040

您必须在推送之前提交删除：

```
rm file
git commit -a
git push 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:48:22.190

您缺少提交更改。

```
$ cd ~/myDir
$ git rm myFile
$ git commit -a -m "Your commit message"
$ git push origin master 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T12:48:40.197

如果您说要从 github 上的所有历史记录中删除该文件，[请阅读此](https://help.github.com/articles/remove-sensitive-data). 否则，是的，像其他人所说的那样进行更改。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-20T14:22:35.220

`git rm <file>`

`git commit -m "deleted a file"`

`git push`

但是，该文件仍然可以通过历史记录获得，例如，通过对首先将其放入存储库的提交进行挑选。

对于敏感数据，或者您希望确保永远不会重新进入项目的代码，建议使用`git filter-branch`.

警告：这将从最初添加（现在已删除）文件的位置更改分支中所有提交的 SHA-1 哈希，因此您将无法轻松地将重写的分支推送和分发到原始分支之上. 如果这是您要删除的最近提交，那么这种方法可能不会对其他人造成问题。

`git filter-branch --index-filter 'git rm --cached --ignore-unmatch <file>' HEAD`

为了能够使用 filter-branch 之类的选项，您应该始终在存储库中创建、编码和提交您自己的分支。

# javascript - 富文本编辑器，使用强标签的粗体文本

> ID：14921233
> 
> 赞同：6
> 
> 时间：2013-02-17T12:47:09.713
> 
> 标签：javascript, contenteditable, execcommand

我正在开发一个非常简单的富文本编辑器。我已经阅读了有关将 designMode = 'On' 应用于 iframe 的信息，然后我使用它来创建粗体文本：

```
nameOfiframe.document.execCommand('bold',false,null); 
```

即使它有效， execCommand() 使用`b`标签而不是`strong`制作粗体文本。我看了一些高级的富文本编辑器，所有这些都用来`strong`代替`b`标签。

我有一个简单的方法来解决这个问题吗？还是 execCommand() 根本不好用？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T20:47:56.020

不幸的是`document.execCommand()`，行为因浏览器而异。正如@1UnitedPower 的回答所提到的，`document.execCommand()`它是为了呈现而不是语义效果。

两种可能的选择是：

1.  编写自己的代码来做粗体样式。不幸的是，正确地做到这一点并非易事。你可以看看主要的所见即所得编辑器，如 CKEditor 和 TinyMCE 是如何做到的。
2.  调用后运行一些代码将`<b>`元素转换为元素。这似乎是更容易的选择。如果这对您很重要，您将需要一些方法来在进行转换时保留选择。`<strong>``document.execCommand()`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T12:58:37.093

`execCommand`不接受 html-tag-name 作为它的第一个参数，而是一个 MIDAS-command。有关可用命令的列表，请参阅[https://developer.mozilla.org/en-US/docs/Midas](https://developer.mozilla.org/en-US/docs/Midas)。

这种行为是希望的，因为它针对的是所见即所得编辑器的目标。WYSIWYG 不是为了语义，而是为了文体目的。您无法确定粗体文本背后的语义。

但是看看`insertHtml`和`styleWithCSS`命令。

# eclipse - PDT如何以php形式打开html文件？

> ID：14921234
> 
> 赞同：1
> 
> 时间：2013-02-17T12:47:14.757
> 
> 标签：eclipse, eclipse-pdt

试过这个：[Eclipse PDT 没有突出显示 .html 文件中的 PHP 语法？](https://stackoverflow.com/questions/4319708/eclipse-pdt-isnt-highlighting-php-syntax-in-html-files/4319759#4319759) 但是没有任何“PHP 内容类型”。

如何在 eclipse .html 文件中作为 PHP 脚本打开？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:07:16.607

你有没有安装网络工具包？你可以在[http://www.eclipse.org/webtools/找到它](http://www.eclipse.org/webtools/)

另请参阅[此参考](http://kb.zend.com/index.php?View=entry&EntryID=180)以了解如何将文件类型添加到您的 php 编辑器。

要不就

1.  转到窗口 > 首选项
2.  在首选项中，转到常规 > 内容类型
3.  选择 PHP Source File 并添加 *.html 作为文件关联
4.  单击 General > Editors > File Associations 上的 File Associations 链接
5.  选择 *.html 并将 PHP 编辑器添加为关联编辑器 - 将其设为默认值

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-05-30T15:02:55.293

检查过，但在我的 Eclipse PDT 中，所有文件扩展名似乎都可以。最后复制所有，将文件粘贴到记事本++中，将其保存为新名称，在eclipse中执行F5 ...结果很好...我认为有些字符很奇怪，复制并粘贴到NP++解决了这个问题。

# salesforce - 在 apex salesforce 中调试可调度作业

> ID：14921235
> 
> 赞同：3
> 
> 时间：2013-02-17T12:47:20.640
> 
> 标签：salesforce, apex-code, visualforce

我正在尝试运行可调度的工作我从未在销售人员中使用过可调度的工作

这是我的代码

```
global class scheduledMerge implements Schedulable{
   global void execute(SchedulableContext SC) {
      System.debug('Hello World'); 
   }
}

          created a cusom controller
public class schedulableMerge{

public schedulableMerge(){

}
public PageReference Hello(){
scheduledMerge m = new scheduledMerge();
        String sch = '0 10 * * 1-12 ? *';
        system.schedule('Merge Job', sch, m);
        return null;
}

} 
```

和visualforce页面是

```
<apex:page controller="schedulableMerge">
  <!-- Begin Default Content REMOVE THIS -->
    <h1>Congratulations</h1>
  This is your new Page
  <!-- End Default Content REMOVE THIS -->
  <apex:form >
  <apex:commandButton value="Press it" action="{! Hello}" />
</apex:form>

</apex:page> 
```

当我按下按钮按下它时，所有可调度作业中有一个作业，但只有一个选项删除它。没有管理选项。我认为这项工作应该每 10 分钟运行一次。我从 Monitoring>Debug Log 中看到了调试日志，它没有显示任何日志。你能告诉每分钟运行作业的表达式是什么以及在哪里查看调试日志吗？我的目标是看到可安排的工作

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T18:21:13.890

好消息 - 您不需要 visualforce 页面和控制器。坏消息 - 您不能以 1 分钟的间隔安排作业。我认为最少 5 分钟（但我不确定，你必须尝试一下）。

如何按需运行（一次）？从开发人员控制台或 Eclipse 的“执行匿名”块。

确保将您的用户添加到调试日志中，并简单地强制运行`execute`您必须作为接口的一部分实现的方法：

```
scheduledMerge sm = new scheduledMerge();
sm.execute(null); 
```

在您对一次运行成功完成感到满意后，尝试使用 cron 表达式。如果您对每天一次的频率感到满意 - 您根本不需要这些表达式，请转到设置 -> 开发 -> 类，然后单击 [Schedule Apex]。仅当您一天需要多次运行时才使用代码来安排课程。

最后但同样重要的是 - 转到设置并在搜索中键入“Apex 工作”。您应该看到最近执行的所有异步任务的信息（计划的作业、批处理、`@future`方法等）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-18T10:14:13.763

> 你能告诉每分钟运行作业的表达式是什么以及在哪里查看调试日志吗？

你不能每分钟都运行它。最少是一小时 - [Apex 调度程序](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_scheduler.htm)。有一个哈克 - 尽可能频繁地运行工作以启动大量工作。

您可以尝试在当前运行的作业中安排新作业（如果可能的话）以运行每个 Datetime.now().minute() + 1。这个想法刚刚出现在我的脑海中。我没试过。所以同一堂课将在一分钟后开始。但是不要忘记杀死这个类中的当前工作，这样你就不会创建大量的预定工作并用完调控器限制。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-04T04:16:07.413

我已经为 Scheduled Apex 执行了类似的操作，以运行 15、30、45、60 分钟（即每 15 分钟）

缺点是，我们需要创建 4 个不同的 Scheduled Apex 作业才能执行。

```
System.schedule('Every 0th min', '0 0 * * * ?', new scheduledMerge());
System.schedule('Every 15th min', '0 15 * * * ?', new scheduledMerge());
System.schedule('Every 30th min', '0 30 * * * ?', new scheduledMerge());
System.schedule('Every 45th min', '0 45 * * * ?', new scheduledMerge()); 
```

# javascript - Jvectormap 标记在 setFocus 调用后绘制错误

> ID：14921240
> 
> 赞同：2
> 
> 时间：2013-02-17T12:47:40.617
> 
> 标签：javascript, jvectormap

我想专注于美国州的选择。代码是这样的：

```
 var ddd = {
        "US-VA": 1,
        "US-PA": 1,
        "US-TX": 1,
        "US-RI": 1,
        "US-SC": 1,
        "US-OR": 1,
        "US-CO": 1,
        "US-KY": 1
    };
    var map = {};

  $(function(){
    map = new jvm.WorldMap({
        map: 'us_aea_en',
        backgroundColor: '#EEEEEE',
        container: $('#us-map'),
        regionsSelectable: true,
        regionsSelectableOne: true,
        regionStyle: {
            initial: {
                fill: '#777777',
                "fill-opacity": 1,
                stroke: 'none',
                "stroke-width": 0,
                "stroke-opacity": 1
            }
        },
        series: {
            regions: [{
                values: ddd,
                scale: ['#FF6633', '#FF6622'],
                normalizeFunction: 'linear'
            }]
        },
        markerStyle: {
        initial: {
        fill: '#F8E23B',
        stroke: '#383f47'
        }
        },
        markers: [
            {latLng: [41.17, -74.92], name: 'New York'},
            {latLng: [34.06, -118.25], name: 'Los Angeles'},
            {latLng: [29.98, -95.54], name: 'Houston'},
            {latLng: [42.42, -71.3], name: 'Boston'},
            {latLng: [32.79, -96.81], name: 'Dallas'},
            {latLng: [32.79, -79.95], name: 'Charleston'},
            {latLng: [38.02, -122.89], name: 'San Francisco'},
            {latLng: [35.17, -106.86], name: 'Albuquerque'},
            {latLng: [35.72, -97.99], name: 'Oklahoma City'},
            {latLng: [61.22, -149.91], name: 'Anchorage'},
            {latLng: [21.47, -158.08], name: 'Honolulu'}
        ],
        //onRegionSelected: function(event, isSelected, selectedRegions){
        onRegionSelected: function(selectedRegions){
            map.setFocus(9, selectedRegions);
        }
      });
    }); 
```

当我选择一个区域时，标记被绘制在错误的位置。可以看到一个小的变化，就像地图尝试那样`setFocus`，但标记位于左上角。我使用**jvectormap-1.1.1.min.js**和**jquery-1.8.3.min.js**

这是加载时的地图： ![在此处输入图像描述](../Images/0f0d4481c902072902b263566926a8b5.png)

这是选择状态后的地图： ![在此处输入图像描述](../Images/184baadc926c664a4cb686ae4e0cb9d0.png)

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T18:45:01.773

**将方法的定义更改`onRegionSelected`为：**

```
onRegionSelected: function(e, code, isSelected,  selectedRegions){
     map.setFocus(selectedRegions);
} 
```

该`setFocus`方法预计最多接收 3 个参数。第一个是比例、区域代码或区域代码数组。第二个和第三个参数是`centerX`和`centerY`指定视口的中心。

您将数字`9`作为第一个参数发送，然后第二个参数发送事件对象并且发生了奇怪的事情。

此外，如果您`regionsSelectableOne: false`为地图设置，您将看到它缩放到适当的级别以包含所选区域（州）。

# c# - 如何更改 ComboBox 主题 C# Windows 8

> ID：14921241
> 
> 赞同：0
> 
> 时间：2013-02-17T12:47:46.237
> 
> 标签：c#, wpf, windows

如何在 WPF 中更改自定义组合框主题？我试图更改整个应用程序的主题，但我的 DerivedComboBox 继续使用 Windows 8 主题（它适用于普通 ComboBox）。当我将 DerivedComboBox 放入 UserControl 时它可以工作，但我想避免这种情况。

# c# - Linq 查询不匹配的项目

> ID：14921245
> 
> 赞同：1
> 
> 时间：2013-02-17T12:48:04.467
> 
> 标签：c#, asp.net, linq, entity-framework

我有一个包含许多上传文件的应用程序。我正在尝试快速找到尚未与任何记录关联的孤立文件以进行删除以释放磁盘空间。

我已经创建了这种方法，但它让我的（可怜的）linq 窒息。

谁能看到我做错了什么？？

```
public static IQueryable GetOrphanedFiles(int skip = 0, int take = 100)
{
    using (var ctx = new CS3Entities())
    {
        var files = (from f in ctx.Files
                     select new
                                {
                                    FileID = f.ID
                                });

        var links = (from l in ctx.FileLinks
                     group l by l.FileID
                     into g
                     select new
                                {
                                    FileID = g.Key
                                });

        var orhpans = links.Where(f => files.Contains(f.FileID)); <-- dies here

        return orhpans.Skip(skip).Take(take);
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T12:55:09.060

更改如下：

```
var orhpans = links.Where(f => files.Select(x => x.FileID).Contains(f.FileID)); 
```

# asp.net-mvc - Razor Editor 不适用于解决方案中的某些项目

> ID：14921246
> 
> 赞同：1
> 
> 时间：2013-02-17T12:48:13.593
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4, visual-studio-2012

我正在使用 MVC 4 和 Razor 语法创建一个 CMS，但遇到了一个奇怪的问题。
在主项目中一切正常，但我在解决方案中有一些额外的项目（也是 MVC 4 项目），它们是主项目的扩展（在运行时加载），它们也有自己的视图/布局。

现在在这些额外的项目中，剃须刀编辑器会按应有的方式突出显示，但会强调所有内容都缺失（如 Html 帮助程序），否则它根本不起作用：
![失踪](../Images/a5b75bd49f90c985d0010375094f33a3.png)
或
![不工作](../Images/2d594d63d3acda9a00dbb6720d4e636f.png)

**有谁知道为什么？**这些文件通过“打开方式...”使用 Razor 编辑器打开，以确保使用 Razor 编辑器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:54:01.657

您只需在`web.config`类库的根目录中添加一个包含以下内容的虚拟文件，即可在 Razor 文件中欺骗 Visual Studio 的 Intellisense（取自[`this blog post`](http://blogs.msdn.com/b/webdev/archive/2011/01/20/how-to-get-razor-intellisense-for-model-in-a-class-library-project.aspx)）：

```
<?xml version="1.0"?>
<configuration>
    <configSections>
        <sectionGroup name="system.web.webPages.razor" type="System.Web.WebPages.Razor.Configuration.RazorWebSectionGroup, System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35">
            <section name="host" type="System.Web.WebPages.Razor.Configuration.HostSection, System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
            <section name="pages" type="System.Web.WebPages.Razor.Configuration.RazorPagesSection, System.Web.WebPages.Razor, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" requirePermission="false" />
        </sectionGroup>
    </configSections>

    <system.web.webPages.razor>
        <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <pages pageBaseType="System.Web.Mvc.WebViewPage">
            <namespaces>
                <add namespace="System.Web.Mvc" />
                <add namespace="System.Web.Mvc.Ajax" />
                <add namespace="System.Web.Mvc.Html" />
                <add namespace="System.Web.Routing" />
            </namespaces>
        </pages>
    </system.web.webPages.razor>

    <system.web>
        <compilation targetFramework="4.0">
            <assemblies>
                <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
                <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35"/>
                <add assembly="System.Data.Linq, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
                <add assembly="System.Web.Mvc, Version=3.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
            </assemblies>
        </compilation>
    </system.web>
</configuration> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T15:28:40.830

我发现了问题：
我将构建配置为直接构建到我的主项目的插件文件夹以便于调试，似乎剃须刀编辑器不喜欢那样。一旦我将输出设置回“bin\”，它就会再次工作。
我现在将创建后期构建步骤来进行复制...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T12:50:31.190

我用 MEF 做了类似的事情来创建插件。确保为“system.web.mvc”和“system.web.mvc.html”添加使用状态

认为那里是正确的......没有解决方案来检查

干得好：

```
@using System.Web.Mvc.Html;
@using System.Web.Mvc;
@model Terminals.Models.vmDeviceAdd
@{
    ViewBag.Title = "Index";
    Layout = "~/Areas/Terminals/Views/Shared/Master/_TerminalLayout.cshtml";
} 
```

# php - Smarty 在 Script 中使用 html 标签爆裂

> ID：14921249
> 
> 赞同：1
> 
> 时间：2013-02-17T12:48:19.773
> 
> 标签：php, jquery, codeigniter, smarty

我将 blueimp-jquery-file-upload 与 smarty 一起使用，因为 blueimp 使用了脚本中带有 html 标签的奇怪脚本标签，它与 smarty 引擎冲突，结果我遇到了脚本故障。

```
<script id="template-upload" type="text/x-tmpl"> 
```

这是用于上传的脚本标签 ![截屏](../Images/ca73103a564778ebdb52960653c1f1ad.png)

但是当它渲染时，它的顺序不正确，我试图更改分隔符但它仍然不起作用

这是呈现的html

![截屏](../Images/b53159cdefb510744de0cf24873abe7a.png)

请任何人告诉我如何解决它，当我放置一些其他 JS 而不是 blueimp 上传脚本时，它可以正常工作。

即使这样也行不通

```
{literal}
<script id="template-upload" type="text/x-tmpl">
var a = 3;
<div  class="B">sdfsdfs</div>
 var j = 5;
<div class="A"></div>
</script>
{/literal} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:18:23.423

这个 BlueImp 插件使用另一个名为[Templates 引擎](https://github.com/blueimp/JavaScript-Templates)的 jQuery 插件从 JavaScript 生成 HTML。他们碰巧使用与 Smarty 相同的语法，这似乎破坏了您的代码。然而，BlueImp 插件允许您通过手动将 HTML 定义为**插件选项**来覆盖此模板语言。你的 JavaScript 看起来像这样：

```
$('#fileupload').fileupload({
    filesContainer: $('#upload_files_container'),
    uploadTemplateId: null,
    downloadTemplateId: null,
    uploadTemplate: function (o) {
        var rows = $();
        $.each(o.files, function (index, file) {
            var row = $('<tr class="template-upload fade">' +
                '<td class="preview"><span class="fade"></span></td>' +
                '<td class="name"></td>' +
                '<td class="size"></td>' +
                (file.error ? '<td class="error" colspan="2"></td>' :
                        '<td><div class="progress">' +
                            '<div class="bar" style="width:0%;"></div></div></td>' +
                            '<td class="start"><button>Start</button></td>'
                ) + '<td class="cancel"><button>Cancel</button></td></tr>');
            row.find('.name').text(file.name);
            row.find('.size').text(o.formatFileSize(file.size));
            if (file.error) {
                row.find('.error').text(
                    locale.fileupload.errors[file.error] || file.error
                );
            }
            rows = rows.add(row);
        });
        return rows;
    },
    downloadTemplate: function (o) {
        var rows = $();
        $.each(o.files, function (index, file) {
            var row = $('<tr class="template-download fade">' +
                (file.error ? '<td></td><td class="name"></td>' +
                    '<td class="size"></td><td class="error" colspan="2"></td>' :
                        '<td class="preview"></td>' +
                            '<td class="name"><a></a></td>' +
                            '<td class="size"></td><td colspan="2"></td>'
                ) + '<td class="delete"><button>Delete</button> ' +
                    '<input type="checkbox" name="delete" value="1"></td></tr>');
            row.find('.size').text(o.formatFileSize(file.size));
            if (file.error) {
                row.find('.name').text(file.name);
                row.find('.error').text(
                    locale.fileupload.errors[file.error] || file.error
                );
            } else {
                row.find('.name a').text(file.name);
                if (file.thumbnail_url) {
                    row.find('.preview').append('<a><img></a>')
                        .find('img').prop('src', file.thumbnail_url);
                    row.find('a').prop('rel', 'gallery');
                }
                row.find('a').prop('href', file.url);
                row.find('.delete button')
                    .attr('data-type', file.delete_type)
                    .attr('data-url', file.delete_url);
            }
            rows = rows.add(row);
        });
        return rows;
    }
}); 
```

[请参阅他们的文档](https://github.com/blueimp/jQuery-File-Upload/wiki/Template-Engine)。这将允许您在不使用 Smarty 语法的情况下生成 HTML。

# xml - 存储 XML 数据的优雅解决方案

> ID：14921255
> 
> 赞同：3
> 
> 时间：2013-02-17T12:49:06.927
> 
> 标签：xml, vb.net, storing-data, dynamic-variables

我已经让我的应用程序从我的 xml 文档中读取一些值，但是我不确定我将如何存储它们，因为我目前对于文件中的每个元素总共有 6 条信息。

XML 示例

```
<?xml version="1.0" encoding="utf-8"?>
<App>
 <Name>First Application </Name>
 <FileName>1.exe</FileName>
 <FilePath>C:\</FilePath>
 <Third_Parameter>etc</Third_Parameter>
 <Forth_Parameter>etc</Forth_Parameter>
 <Name>Application 2</Name>
 <FilePath></FilePath>
 <Third_Parameter>etc</Third_Parameter>
 <Forth_Parameter>etc</Forth_Parameter>
</App> 
```

我正在考虑一个具有唯一 ID 的数组，因为无论如何我已经为每个应用程序都有一个，但我不知道如何动态创建一个具有另一个变量名称的数组。我看着使用字典，但是我有两个以上的变量，不知道如何使它与它一起工作。

基本上我需要一种在不使用数据库的情况下为可能无限量的应用程序存储所有这些信息的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:22:19.577

将 XML 结构更改为树会很有用，如下所示：

```
<?xml version="1.0" encoding="utf-8"?>
<Apps>
  <App Name="First Application">
    <FileName>1.exe</FileName>
    <FilePath>C:\</FilePath>
    <Third_Parameter>etc</Third_Parameter>
    <Forth_Parameter>etc</Forth_Parameter>
  </App>
  <App Name="Application 2">
    <FilePath></FilePath>
    <Third_Parameter>etc</Third_Parameter>
    <Forth_Parameter>etc</Forth_Parameter>
  </App>
</Apps> 
```

然后你可以有这个类：

```
Class App
  Public FileName As String
  Public FilePath As String
  Public Third_Parameter As String
  Public Forth_Parameter As String
  Public AppName As String
End Class 
```

还有一个 (String,App) 的字典 - 假设你会按名称索引。

您可以像这样填充它（其中`xml`type `XDocument`）：

```
Dim dict As New Dictionary(Of String, App)
For Each elem As XElement In xml.Elements()
  Dim app As New App 'each element would be App
  With app
    .AppName = elem.Attribute("Name").Value
    .FileName = elem.Element("FileName").Value
    .FilePath = elem.Element("FilePath").Value
    .Third_Parameter = elem.Element("Third_Parameter").Value
    .Forth_Parameter = elem.Element("Forth_Parameter").Value
  End With
  dict.Add(app.AppName, app)
Next 
```

如果您想要更少的代码，请考虑研究 XML 序列化。我通过谷歌搜索找到的一些示例：

*   [如何在 VB.NET 中编写对象以便轻松进行 XML 序列化？](https://stackoverflow.com/questions/223526/how-do-i-write-objects-for-easy-xml-serialization-in-vb-net)
*   [如何：在 Visual Basic .NET 中序列化和反序列化 XML](http://support.microsoft.com/kb/316730)
*   [XML 序列化 - CodeProject 上的第 1 部分](http://www.codeproject.com/Articles/23783/XML-Serialization-Part-1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:27:47.557

你只关心在应用程序运行时存储这些数据吗？我会使用数据表

```
Dim x As New DataTable
        x.ReadXml("c:\pathtoxml.xml")
        x.AcceptChanges() 
```

# css - 透视 webkit 变换和绝对位置问题

> ID：14921263
> 
> 赞同：0
> 
> 时间：2013-02-17T12:50:32.097
> 
> 标签：css, webkit, absolute, css-transforms

这是html：

```
<div class="row">
    <div></div>
    <ul></ul>
</div> 
```

这是我的CSS：

```
.row {
    width: 173px;
    height: 38px;
    position: absolute;
}

.row div {
    width: 200px;
    height: 32px;
    background: #51565b;
    -webkit-transform: perspective( 173px ) rotateY( -20deg ) translate(-33px, 2px);
    position: absolute;
    z-index: 9;
}

ul {
    background: red;
    position: absolute;
    width: 300px;
    height: 16px;
    left: 26px;
    top: 11px;
    z-index:10
} 
```

演示：http: [//jsfiddle.net/w3Wa4/](http://jsfiddle.net/w3Wa4/)

如您所见，我有一个带有透视变换的 div，我想在其上方显示一个简单的列表，但列表的一半在 div 后面。

所以它看起来像这样：

![在此处输入图像描述](../Images/524db71332f4100dbeaf327ac1dcd02b.png)

我尝试使用 z-index 但它不起作用。任何想法？

# javascript - 使用变量按类或 id 查找对象

> ID：14921266
> 
> 赞同：0
> 
> 时间：2013-02-17T12:50:57.093
> 
> 标签：javascript, html, css

我想使用 javascript 变量更改图像的来源，因为我有一个变量“vp_active_row_count”，它按数字显示哪个球是活动的。（“_a”=表示活动图像源）。

但我找不到任何使用较低 javascript 代码的对象。甚至可能吗？

**Javascript**

```
var vp_active_row_count=2;
var test = '"#'+vp_active_row_count+'"';
$(test).attr('src','assets/img/vp_a.png'); 
```

**HTML**

```
<div class="vp_balls" style="width: 48px;">
    <img id="1" src="assets/img/vp_a.png">
    <img id="2" src="assets/img/vp.png">
    <img id="3" src="assets/img/vp.png">
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T12:54:30.387

无需引用两次！引号用于告诉 JS 这是一个字符串，但 jQuery 不需要额外的一对

# javascript - jQuery在动画中运行父函数

> ID：14921267
> 
> 赞同：0
> 
> 时间：2013-02-17T12:51:11.360
> 
> 标签：javascript, jquery

我正在为 jQuery 制作一个插件，我需要在一些动画完成后重新运行相同的功能。我正在尝试`setTimeout()`在 animate 函数中执行此操作。

我正在努力的代码在底部是

```
jQuery(theslide).animate(theanimation,1000,function() {
        setTimeout('this.makemeslide()',3000)
}) 
```

控制台错误消息是***Uncaught TypeError: Object [object Window] has no method 'makemeslide'***可以看到，因为它指向动画对象。但我不知道如何实现我的目标。

这是我的完整代码

```
jQuery.fn.daSlider = function(options) {
    //Options
    var settings = $.extend( {
          'selector'         : 'slider',
          'width'      : 940,
          'height'     : 380
        }, options);

    //globals
    var sliderarray = [];
    var slidercount = 0;

    //Contruct
    this.construct = function()
    {
       jQuery('.slider .slide').each(function(){

              jQuery(this).css('display','none');
              sliderarray.push(this) ;

              jQuery(this).children().each(function(){
                    jQuery(this).css('display','none');
                    sliderarray.push(this) ;
                });
       });

      this.makemeslide();
    }
    //run the constuct

    this.makemeslide = function()
    {
      theslide = sliderarray[slidercount];
      slidercount++;

      way_to_slide = jQuery(theslide).attr('slide');

      slide_position =  jQuery(theslide).position();
      //console.log(slide_width);
      //console.log(slide_height);

      if(way_to_slide == 'right')
      {
        jQuery(theslide).css('left', slide_position.left + settings.width);
        theanimation = {'left' : '-='+settings.width};
      }
      if(way_to_slide == 'left')
      {
        jQuery(theslide).css('left', slide_position.left - settings.width);
        theanimation = {'left' : '+='+settings.width};
      }
      if(way_to_slide == 'up')
      {
        jQuery(theslide).css('top', slide_position.top - settings.height);
        theanimation = {'top' : '+='+settings.height};
      }
      if(way_to_slide == 'down')
      {
        jQuery(theslide).css('top', slide_position.top + settings.height);
        theanimation = {'top' : '-='+settings.height};
      }
      if(way_to_slide == 'fade')
      {
        jQuery(theslide).css('opacity', 0);
        theanimation = {'opacity' : 1};
      }

      jQuery(theslide).css('display','block') ;
      jQuery(theslide).animate(theanimation,1000,function(){setTimeout('this.makemeslide()',3000)})

    }
    this.construct();

}; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:58:06.777

切勿[`setTimeout`](https://developer.mozilla.org/en-US/docs/DOM/window.setTimeout)与要`eval`编辑的代码字符串一起使用！此外，您的[`this`参考](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/this)将不是来自父函数的参考。

```
var plugin = this;
jQuery(theslide).animate(theanimation, 1000, function() {
    // "this" references theslide element
    setTimeout(function() {
        // "this" references the global object (window)
        plugin.makemeslide();
    }, 3000);
}); 
```

顺便说一句，您可能希望使用带有回调[的 jQuery`delay`方法，而不是独立的超时。](http://api.jquery.com/delay/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:01:21.023

这是因为 javascript 中的*this*与 i Java 不同。 *这*是本例中的窗口对象。

你可以使用闭包来避免这个问题：

```
function Object(){
    self=this;
    this.inner = function(){

     setTimeout(function(){
        alert(self);
        alert(this);
     },100);
    }
}

var o = new Object();
o.inner(); 
```

请注意，第二个警报将向您显示 window-object，而不是 o-object

# java - Java 6 / 7 反编译命令行

> ID：14921272
> 
> 赞同：6
> 
> 时间：2013-02-17T12:51:46.637
> 
> 标签：java, decompiler

我知道之前已经问过其中的一部分，但是我的搜索继续空手而归。目前我正在使用 JD-Gui 反编译 jar 文件并已切换到 fernflower 但它似乎有枚举问题，不会通过抛出 NPE 来反编译特定类。我什至尝试过 Jode、JAD，甚至使用 JD-Core（从 JD-IntellJ 插件中提取 0.6.1 Snapshot/modified/loaded native），但都充满了错误、字节码等。（除了 JD-Gui 中的 JD-Core 0.6.2）我的问题是有没有人找到一个可以处理 Java 6 / 7 的合理反编译器，可以通过命令行甚至尚未发现的库访问。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:56:52.730

早在我从事逆向工程的时候，我的工具包里就有这个，

[http://www.softpedia.com/get/Programming/Debuggers-Decompilers-Dissasemblers/DJ-Java-Decompiler.shtml](http://www.softpedia.com/get/Programming/Debuggers-Decompilers-Dissasemblers/DJ-Java-Decompiler.shtml)。虽然它是试用版，但我发现它很有用，更不用说您总是将 ida-pro 作为选择的好武器。

# android - 如何指定两个设备进行admob测试？

> ID：14921273
> 
> 赞同：1
> 
> 时间：2013-02-17T12:51:55.717
> 
> 标签：android, testing, admob

我尝试输入`ads:testdevices`这样的内容：

```
ads:testdevices"TEST_EMULATOR, ID1, ID2" 
```

但恐怕它不起作用。

中`logcat`，有一条消息

> 要在此设备中获取测试广告，请调用 adRequest.addTestDevice("TEST_DEVICE_ID");

但我更喜欢将该数据添加到广告布局中。

而且它不适用于两个设备。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-22T13:26:20.287

**解决后关闭**

检查这个：developers.google.com/mobile-ads-sdk/docs/admob/best-practices

# ios - NSNumberFormatter 在设备和模拟器上不同

> ID：14921281
> 
> 赞同：3
> 
> 时间：2013-02-17T12:53:34.590
> 
> 标签：ios, nsnumberformatter

我有一个 UITextField，使用此代码，在底部的标签上打印值并对其进行格式化。

```
NSNumberFormatter *formatter = [[NSNumberFormatter alloc] init];
[formatter setNumberStyle:NSNumberFormatterDecimalStyle];
[formatter setUsesGroupingSeparator:NO];
[formatter setMaximumFractionDigits:2];
[formatter setMinimumFractionDigits:2];
NSNumber *calcolo = [NSNumber numberWithDouble:[value1 doubleValue]-[self.textfield.text doubleValue]];
formattedString = [formatter stringFromNumber:calcolo];
self.label.text = formattedString; 
```

在模拟器（美国）上，该值显示正确。在设备 (IT) 上，键盘上有逗号，但逗号后面的值始终为零。 ![在此处输入图像描述](../Images/e3056f951c1933b2e8d987a46d710560.png)

编辑：这有效

```
NSNumber *temporaryValue1 = [formatter numberFromString:[NSString stringWithFormat:@"%@",value1]];
NSNumber *temporaryTextField = [formatter numberFromString:self.textField.text];
NSNumber *calcolo = [NSNumber numberWithFloat:([temporaryValue1 floatValue] - [temporaryTextField floatValue])];
formattedString = [formatter stringFromNumber:calcolo]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:47:41.503

我不认为问题是你的输出。问题是您从`-[NSString doubleValue`] 获得的输入。该方法不尊重用户的语言环境。

您应该能够使用您制作的格式化程序将其转换`self.textField.text`为正确尊重语言环境的数字。或者您可以考虑使用`NSDecimalNumber`s，特别是如果这是货币（看起来像？）。然后`NSDecimalNumber`有一种方法`+decimalNumberWithString`也可以为您做正确的事情。

# ruby - 按 Ruby/Sinatra 中的相关模型属性排序

> ID：14921283
> 
> 赞同：0
> 
> 时间：2013-02-17T12:53:45.033
> 
> 标签：ruby, sinatra, datamapper

我有简单的预订和客户模型：

```
class Client
  include DataMapper::Resource
  property :id, Serial
  property :name, String, required: true
  property :email, String, required: true
  #....
  has n, :bookings, constraint: :destroy
end

class Booking  
  include DataMapper::Resource  
  property :id, Serial
  property :start_date, Date
  property :end_date, Date
  #....
  belongs_to :client
end 
```

在视图中按预期生成了一个表：

```
<% @bookings.each do |booking| %>
  <tr>
    <td><%= booking.client.name %></td>
    <td><%= booking.start_date %></td>
    <td><%= booking.end_date %></td>
    ....
  </tr>
<% end %> 
```

我想通过单击相应的表格列标题来订购表格。

我可以让表格按 :start_date 或 :end_date 排序，也可以按 :client_id 排序，但 :client_id 不是很有用；我希望能够通过 :client_id 的 Client 模型的 :name 属性进行排序

有人可以告诉我我的控制器需要采用什么格式吗？

```
get '/bookings' do
  @bookings = Booking.all(order: :client_id.name) #no method error
  @bookings = Booking.all(order: [:client_id][:name]) #can't convert to integer
  erb :bookings
end 
```

谢谢

# .htaccess - 使用 mod_rewrite 处理漂亮的 URL 冲突

> ID：14921285
> 
> 赞同：0
> 
> 时间：2013-02-17T12:53:56.170
> 
> 标签：.htaccess, mod-rewrite

我有 2 个页面用于会员资料页面和公司资料页面，对于会员，网址应该是：`site.com/users/USER_ID` 对于公司，网址应该是：`site.com/COMPANY_ID`

我有这个`.htaccess`：

```
#Members Profile Page
RewriteRule ^users/(.*)$ modules/members/members_profile.php?id=$1
RewriteRule ^users/(.*)/$ modules/members/members_profile.php?id=$1

#Companies Profile Page
RewriteRule ^(.*)$ modules/companies/companies_profile.php?id=$1
RewriteRule ^(.*)/$ modules/companies/companies_profile.php?id=$1 
```

但是，这两个规则有冲突，导致用户页面也被引导，`companies_profile.php`因为公司的规则在地址中也包含用户个人资料页面。

我怎么能解决这个问题？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T12:57:49.150

您可以使用[`L`重写标志](http://wiki.apache.org/httpd/RewriteFlags/L)；

```
RewriteRule ^users/(.*)$ modules/members/members_profile.php?id=$1 [L]
RewriteRule ^users/(.*)/$ modules/members/members_profile.php?id=$1 [L] 
```

一旦找到匹配项，它将停止处理文件。

# c - 为什么我们使用 FILE * 而不是 FILE 进行 I/O

> ID：14921292
> 
> 赞同：2
> 
> 时间：2013-02-17T12:54:47.517
> 
> 标签：c, visual-c++, gcc, cross-platform, c99

今天我正在学习关于 C 的标准 I/O 的东西。当我打开 stdio.h 文件时发现：

```
typedef struct _iobuf FILE; 
```

当检查 struct _iobuf 的定义时发现：

```
struct _iobuf {
    char *_ptr;
    int   _cnt;
    char *_base;
    int   _flag;
    int   _file;
    int   _charbuf;
    int   _bufsiz;
    char *_tmpfname;
}; 
```

为了了解更多，我已经给出了关于每个不正确与否的描述

```
struct _iobuf {
    char *_ptr;      /* next character position */
    int   _cnt;      /* characters left */
    char *_base;     /* location of buffer */
    int   _flag;     /* File status flags */
    int   _file;
    int   _charbuf;   /*Data transfer buffer */
    int   _bufsiz;    /* Buffer size */
    char *_tmpfname;  /* Temporary file indicator */
}; 
```

现在有两个问题在我的脑海里？

Q1：我是否提供了正确的名称以及结构如何帮助 I/O，如果我添加或删除任何东西会发生什么？这会相应地工作吗？这里提供的顺序重要吗？

Q2：这里没有使用指针，但为什么要使用 FILE * 打开文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T12:57:04.750

> 我提供了正确的名称吗？

这些都是特定于 Microsoft 实施和 AFAIK 的内部细节，未记录在案。

> 如果我添加或删除任何东西会发生什么？

那真的很糟糕；你可能会导致**未定义的行为**。

> 这里没有使用指针，但为什么要使用 FILE * 打开文件？

因为从应用程序代码的角度来看，实现细节并不重要；`FILE *`旨在成为一个[*不透明的指针*](http://en.wikipedia.org/wiki/Opaque_pointer)。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-17T12:58:21.423

A1。编辑标准标题会导致未定义的行为。

A2。结构通常在 C 中作为指针传递以避免复制。此外，它还可以用作句柄或不透明的指针。

更大的问题是为什么要做你所问的任何事情。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T15:51:03.713

您所有问题的答案：

[PJ Plauger 的标准 C 库](https://rads.stackoverflow.com/amzn/click/com/0131315099)

# java - 动态规划的记忆

> ID：14921294
> 
> 赞同：1
> 
> 时间：2013-02-17T12:55:21.910
> 
> 标签：java, dynamic-programming, memoization

我正在尝试学习动态编程的记忆，我正在观看麻省理工学院的 youtube 上的视频，试图跟随它。我不知道如何将第 N 个值与数组进行比较。

```
int[] memo;
public int fib(int n) {
    int f = 0;

    if n is in memo then return memo[n] <----not sure how to code this line.

    if (n<=2) {
        f = 1;
    } else {
        f = fib(n-1) + fib(n-2);
    }

    memo[n] = f;
    return f;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:08:35.347

这样做`ArrayList`：

```
ArrayList<Integer> memo = new ArrayList<Integer>();

public int fib(int n) {
    if (memo.size() == 0)
       memo.add(0); // element 0 is never accessed
    return fib2(n);
}

private int fib2(int n) {
    int f = 0;

    if (n < memo.size())
       return memo.get(n);

    if (n<=2) {
        f = 1;
    } else {
       f = fib2(n-2) + fib2(n-1);
    }

    memo.add(f); // elements inserted in order
    return f;
} 
```

用数组做：

```
int[] memo;

public int fib(int n) {
    memo = new int[n+1]; // all initialized to 0
    return fib2(n);
}

private int fib2(int n) {
    int f = 0;

    if (memo[n] != 0)
       return memo[n];

    if (n <= 2) {
        f = 1;
    } else {
        f = fib2(n-2) + fib2(n-1);
    }

    memo[n] = f;
    return f;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T12:59:35.437

您可以`memo`使用值初始化数组，`-1`因为算法永远不会插入`-1`数组中。

所以检查是否`memo[i]`已经被插入意味着你必须检查 if `memo[i] != -1`。

*注意：这个概念实际上被称为[记忆化](http://en.wikipedia.org/wiki/Memoization)*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T12:58:13.617

您不能将数组与单个元素进行比较。

您可能想要的是，假设您有一个未计算值的 -1 虚拟值：

`if (memo[n] != -1) return memo[n]`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-02-02T05:25:44.530

奇怪的是，这个问题有 0 个赞，但有 4 个答案，我觉得其中没有一个真正令人满意。这是使用 4 种不同方法并进行比较的实现 + 测试示例：

```
import java.util.ArrayList;
import java.util.HashMap;

public class Fib {

    // Straightforward implementation:
    public static int fib(int n) {
    if (n <= 1) {
        return n;
    }
    return fib(n - 1) + fib(n - 2);
    }

    // Using array:
    static int[] memoArray;
    public static int fibArray(int n) {
    memoArray = new int[n];
    return fibArrayHelper(n);
    }
    private static int fibArrayHelper(int n) {
    if (n <= 1) {
        return n;
    } else {
        if (memoArray[n - 2] != 0) {
        return memoArray[n - 2];
        }
        memoArray[n - 2] = fibArrayHelper(n - 2) + fibArrayHelper(n - 1);
        return memoArray[n - 2];
    }
    }

    // Using ArrayList:
    static ArrayList < Integer > memoArrayList = new ArrayList < Integer > ();

    public static int fibArrayList(int n) {
    return fibArrayListHelper(n);
    }

    private static int fibArrayListHelper(int n) {
    if (n <= 1) {
        return n;
    } else {
        if (n - 2 < memoArrayList.size())
        return memoArrayList.get(n - 2);
        else {
        memoArrayList.add(fibArrayListHelper(n - 2) + fibArrayListHelper(n - 1));
        return memoArrayList.get(n - 2);
        }
    }
    }

    // Using HashMap:
    static HashMap < Integer, Integer > memoHash = new HashMap < Integer, Integer > ();

    static public int fibHashMap(int n) {
    if (n <= 1)
        return n;
    if (memoHash.get(n) == null) {
        memoHash.put(n - 2, fibHashMap(n - 1) + fibHashMap(n - 2));
    }
    return memoHash.get(n - 2);
    }

    public static void main(String args[]) {
    long preTime, postTime;
    int x = 35;

    preTime = System.nanoTime();
    System.out.printf("%17s: %d", "fib(" + x + ")", fib(x));
    postTime = System.nanoTime();
    System.out.printf(", computed in %10d nanoseconds.\n", postTime - preTime);

    preTime = System.nanoTime();
    System.out.printf("%17s: %d", "fibArray(" + x + ")", fibArray(x));
    postTime = System.nanoTime();
    System.out.printf(", computed in %10d nanoseconds.\n", postTime - preTime);

    preTime = System.nanoTime();
    System.out.printf("%17s: %d", "fibArrayList(" + x + ")", fibArrayList(x));
    postTime = System.nanoTime();
    System.out.printf(", computed in %10d nanoseconds.\n", postTime - preTime);

    preTime = System.nanoTime();
    System.out.printf("%17s: %d", "fibHashMap(" + x + ")", fibHashMap(x));
    postTime = System.nanoTime();
    System.out.printf(", computed in %10d nanoseconds.\n", postTime - preTime);
    }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-20T14:23:38.563

我喜欢在 Java 中使用 HashMap。根据我的经验，HashMap 让记忆化变得非常容易实现。[https://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html](https://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html)

四个步骤：

1.  获取基本情况

2.  用于`m.get(n) == null`检查是否已计算子问题。

3.  如果 (2) 不成立，则递归计算并将其存储到 HashMap。

    HashMap的**key**是当前子问题的*标识符*（在 Fibonacci 的情况下，它是第**n****个 Fibonacci 序列**的n 。**value**是解决未解决问题的递归调用。

4.  如果 (2) 为真，则返回 m.get(n)。

这是一个使用 4 个步骤的斐波那契示例：

```
HashMap<Integer, Integer> memo = new HashMap<Integer,Integer>();

int fib(int n) {

    //1\. base case
    if (n <= 1) 
        return n; 

    //2\. check if sub problem is computed yet.
    if (m.get(n) == null) {

        //3\. if not, compute the sub problem.
        m.put(n, fib(n - 1) + fib(n - 2));
    }

    //4\. if so, return the result. 
    return m.get(n); 
} 
```

对于许多记忆问题，您可以使用相同的方法。

# javascript - 如何用另一个替换整个css文本？

> ID：14921295
> 
> 赞同：0
> 
> 时间：2013-02-17T12:55:36.143
> 
> 标签：javascript, jquery, css, coding-style, stylesheet

我有不同样式的网页，用户可以随时更改和构建。我有此代码可与浏览器 IE-9+、chrome、FF、safari 一起使用。

```
if($("#customCss").length>0)
     $("#customCss").empty();

$("#customCss").text(css_txt );
$('head').append('<style type="text/css" id="customCss"> ' + css_txt + '</style>'); 
```

我想让网站适合 IE-7,8。但是此代码不适用于 IE-7,8。我收到此错误代码：

```
Microsoft JScript runtime error: Unexpected call to method or property access. 
```

在这个 jquery func jquery 中：

```
append: function () {
            return this.domManip(arguments, true, function (elem) {
                if (this.nodeType === 1) {
                    this.appendChild(elem);
                }
            });
        }, 
```

我也试过这个，但没有运气：

```
document.getElementById("customCss").innerHTML=css_txt; 
```

知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:04:17.623

存储对`link`标记的引用，然后将其修改`href`为新脚本（如果它是外部脚本）。如果它是内部的，请尝试删除旧的，`.remove()`并`.append()`在`<body>`.

# c# - 是否可以忽略程序集清单不匹配？

> ID：14921297
> 
> 赞同：8
> 
> 时间：2013-02-17T12:55:43.060
> 
> 标签：c#, asp.net

我正在尝试在我的 asp.net 网站中使用我使用 NuGet 引入的几个库。

问题是我收到此错误：

```
Could not load file or assembly 'AWSSDK, Version=1.5.9.1, Culture=neutral, PublicKeyToken=cd2d24cd2bace800' or one of its dependencies. The located assembly's manifest definition does not match the assembly reference. (Exception from HRESULT: 0x80131040) 
```

我尝试使用的库之一需要使用 AWSSDK，但显然它正在寻找我无法再获得的旧版本。

是否可以忽略此错误？

这是一个全新的网站，里面还没有代码，只是被NuGet拉进来的，web.config是空的。

## 编辑：

我添加了 Fusion 日志记录，现在我得到：

```
=== Pre-bind state information ===
LOG: User = WIN-FSSH1EIG4NE\Max
LOG: DisplayName = AWSSDK, Version=1.5.9.1, Culture=neutral, PublicKeyToken=cd2d24cd2bace800
 (Fully-specified)
LOG: Appbase = file:///C:/Users/Max/Documents/Visual Studio 2010/WebSites/images.RepZio/
LOG: Initial PrivatePath = C:\Users\Max\Documents\Visual Studio 2010\WebSites\images.RepZio\bin
Calling assembly : ImageResizer.Plugins.S3Reader, Version=3.3.2.447, Culture=neutral, PublicKeyToken=null.
===
LOG: This bind starts in default load context.
LOG: Using application configuration file: C:\Users\Max\Documents\Visual Studio 2010\WebSites\images\web.config
LOG: Using machine configuration file from C:\Windows\Microsoft.NET\Framework\v2.0.50727\config\machine.config.
LOG: Post-policy reference: AWSSDK, Version=1.5.9.1, Culture=neutral, PublicKeyToken=cd2d24cd2bace800
LOG: Attempting download of new URL file:///C:/Users/Max/AppData/Local/Temp/Temporary ASP.NET Files/root/8dcd52e9/53da58e/AWSSDK.DLL.
LOG: Attempting download of new URL file:///C:/Users/Max/AppData/Local/Temp/Temporary ASP.NET Files/root/8dcd52e9/53da58e/AWSSDK/AWSSDK.DLL.
LOG: Attempting download of new URL file:///C:/Users/Max/Documents/Visual Studio 2010/WebSites/images/bin/AWSSDK.DLL.
WRN: Comparing the assembly name resulted in the mismatch: Revision Number
ERR: Failed to complete setup of assembly (hr = 0x80131040). Probing terminated. 
```

如果我按照下面的评论中提到的方式添加 bindingRedirect，我会得到同样的错误。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-18T23:26:36.977

最新的 (1.5.13.0) AWSSDK 版本似乎使用与以前版本不同的密钥进行签名。所以不幸的是 bindingRedirect 不起作用。

进行如下操作：

打开包管理器控制台（工具 > 库包管理器 > 包管理器控制台）并输入：

```
PM> Uninstall-Package -Force AWSSDK 
```

其次是：

```
PM> Install-Package AWSSDK -Version 1.5.12.1 
```

然后仔细检查您的 web.config 文件。确保它仅包含 AWSSDK 的以下绑定重定向：

```
<dependentAssembly>
    <assemblyIdentity name="AWSSDK" publicKeyToken="cd2d24cd2bace800" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-1.5.12.1" newVersion="1.5.12.1" />
</dependentAssembly> 
```

现在，您的项目应该可以开始了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:07:31.260

尝试编辑 .csproj 文件并从引用程序集 awssdk 的行中删除 Version=1.5.9.1 。

# indexing - Google Docs Embed：是否被 Google 抓取并编入索引

> ID：14921298
> 
> 赞同：1
> 
> 时间：2013-02-17T12:56:08.353
> 
> 标签：indexing, embed, google-docs, web-crawler

在我们的网站上，我们通过 Google Docs Embed 小部件显示了大量 PDF 和 Word Docs：

```
<iframe src="http://docs.google.com/viewer?url=http://our-url.com/view=file.doc&embedded=true" width="xxx" height="xxx" style="border: none;"></iframe> 
```

有什么方法可以让 Google 真正抓取这些盒子的内容并将其编入索引？

这将极大地帮助我们的排名，因为我们网站的性质，我们的整个独特内容都显示在 Google Docs 窗口中......在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T17:47:12.277

两件事情：

看起来您的链接将被 Google 抓取。[机器人会抓取 iframe 吗？](https://stackoverflow.com/questions/1453296/do-robots-crawl-iframes) （此外，如果您希望 Google 为文件内容编制索引，请将共享设置（在 Google Doc 上）设置为“在网络上公开”）。

其次，在[Google Webmaster Tools](https://www.google.com/webmasters/tools/home)上注册您的网站。这基本上可以确保 Google 知道您的网站，并且您可以检查 Google 抓取您网站的频率等。不过，您必须确认您是该域的所有者，因此您需要有权访问到名称服务器管理（我相信）。

# android - ListFragment 中的列表未更新

> ID：14921301
> 
> 赞同：0
> 
> 时间：2013-02-17T12:56:29.893
> 
> 标签：android, android-listview, android-listfragment

我尝试在 ListFragment 中实现一个永无止境的列表（它基于为活动实现的现有代码）。

我有一个带有下一个代码的 ListFragment：

```
public class MainFragment extends ListFragment {

    //how many to load on reaching the bottom
    int itemsPerPage = 15;
    boolean loadingMore = false;

    ArrayList<String> myListItems;
    ArrayAdapter<String> adapter;

    ListView listview;
    //For test data :-)
    Calendar d = Calendar.getInstance();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        Log.e("Test", "Create Stories Fragment");
    }

    @Override
    public void onActivityCreated(Bundle savedInstanceState) {
        super.onActivityCreated(savedInstanceState);

    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.listplaceholder, container, false);

        listview = (ListView) view.findViewById(android.R.id.list);
      //This will hold the new items
        myListItems = new ArrayList<String>();
        adapter = new ArrayAdapter<String>(getActivity(), android.R.layout.simple_list_item_1, myListItems);

        //add the footer before adding the adapter, else the footer will nod load!
        View footerView = ((LayoutInflater)getActivity().getSystemService(Context.LAYOUT_INFLATER_SERVICE)).inflate(R.layout.listfooter, null, false);
        listview.addFooterView(footerView);

        //Set the adapter
        listview.setAdapter(adapter);

        //Here is where the magic happens
        listview.setOnScrollListener(new OnScrollListener(){

            //useless here, skip!
            @Override
            public void onScrollStateChanged(AbsListView view, int scrollState) {}

            //dumdumdum         
            @Override
            public void onScroll(AbsListView view, int firstVisibleItem,
                int visibleItemCount, int totalItemCount) {

                //what is the bottom iten that is visible
                int lastInScreen = firstVisibleItem + visibleItemCount;             

                //is the bottom item visible & not loading more already ? Load more !
                if((lastInScreen == totalItemCount) && !(loadingMore)){                 
                    Thread thread =  new Thread(null, loadMoreListItems);
                    thread.start();
                }
            }
        });

        //Load the first 15 items
        Log.e("Test", "Load first items");
        Thread thread =  new Thread(null, loadMoreListItems);
        thread.start();

        return view;
    }

    //Runnable to load the items 
    private Runnable loadMoreListItems = new Runnable() {           
        @Override
        public void run() {
            //Set flag so we cant load new items 2 at the same time
            loadingMore = true;

            //Reset the array that holds the new items
            myListItems = new ArrayList<String>();

            Log.e("Test", "simulate delay");
            //Simulate a delay, delete this on a production environment!
            try { Thread.sleep(1000);
            } catch (InterruptedException e) {}

            //Get 15 new listitems
            for (int i = 0; i < itemsPerPage; i++) {        

                //Fill the item with some bogus information
                myListItems.add("Date: " + (d.get(Calendar.MONTH)+ 1) + "/" + d.get(Calendar.DATE) + "/" + d.get(Calendar.YEAR) );              

                Log.e("Test", "Date: " + (d.get(Calendar.MONTH)+ 1) + "/" + d.get(Calendar.DATE) + "/" + d.get(Calendar.YEAR));
            // +1 day :-D
                d.add(Calendar.DATE, 1);

            }

            //Done! now continue on the UI thread
            getActivity().runOnUiThread(returnRes);

        }
    };  

    //Since we cant update our UI from a thread this Runnable takes care of that! 
    private Runnable returnRes = new Runnable() {
        @Override
        public void run() {

            Log.e("Test", "returnRes");
            //Loop thru the new items and add them to the adapter
            if(myListItems != null && myListItems.size() > 0){
                for(int i=0;i<myListItems.size();i++)
                {
                    Log.e("Test", "adding " + myListItems.get(i));
                    adapter.add(myListItems.get(i));
                }
            }

            Log.e("Test", "notifyDataSetChanged");

            //Tell to the adapter that changes have been made, this will cause the list to refresh
            adapter.notifyDataSetChanged();

            //Done loading more.
            loadingMore = false;
        }
    };

} 
```

现在，listplaceholder.xml 很简单，与我从中获取的代码相同：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent">    

    <ListView
        android:id="@id/android:list"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:fastScrollEnabled="true"
        android:drawSelectorOnTop="false" />

    <TextView
        android:id="@id/android:empty"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:gravity="center"
        android:text="Loading data.."/>

</LinearLayout> 
```

问题是，在原始代码中，我可以在向下滚动时看到更新的日期，在我的代码中，我只看到页脚消息 "Loading Data.." 。为什么列表没有更新？

# ssis - 如何将平面文件上的日期值字段转换为 SSIS 中的标题列

> ID：14921302
> 
> 赞同：0
> 
> 时间：2013-02-17T12:56:31.673
> 
> 标签：ssis

我正在尝试上传多个包含日期的 CSV 文件，但我希望日期成为列的一部分，但我不知道它是如何在 SSIS 中完成的

CSV 文件在 Excel 中打开时如下所示。

### CSV 数据 1：

```
Relative Date: 02/01/2013
Run Date: 15/01/2013

Organisation,AreaCode,ACount
Chadwell,RM6,50
Primrose,RM6,60 
```

### CSV 数据 2：

```
Relative Date: 14/02/2013
Run Date: 17/02/2013

Organisation,AreaCode,ACount
Second Ave,E12,110
Fourth Avenue, E12,130 
```

在数据仓库中，我想要*`Relative Date`*和*`Run Date`*沿列，如下所示：

### 期望的输出：

```
| Organisation   | AreaCode | ACount | RelativeDate | RunDate    |
| ------------   | -------- | ------ | ------------ | ---------- |
| Second Avenue  |  E12     |  110   |  14/02/2013  | 17/02/2013 |
| Fourth Avenue  |  E12     |  130   |  14/02/2013  | 17/02/2013 |
| Chadwell       |  RM6     |  50    |  02/01/2013  | 15/01/2013 |
| Primrose       |  RM6     |  60    |  02/01/2013  | 15/01/2013 | 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-19T04:49:04.790

我会在控制流中添加一个脚本任务，大概是在 Foreach 循环容器中循环文件。脚本任务将从前两行读取日期并将它们分解为变量。

然后在平面文件源定义中，我会告诉它跳过前 3 行。最后，在数据流中，我将添加一个派生列转换，以从日期变量中添加两个必需的列。

# java - Java 泛型：按值对映射进行排序

> ID：14921303
> 
> 赞同：3
> 
> 时间：2013-02-17T12:56:44.190
> 
> 标签：java, generics, map, sorted

尝试编译以下对通用地图进行排序的函数时出现此错误：

```
"The method compareTo(V) is undefined for the type V" 
```

请帮助完成这项工作！

```
public class CollectionsPlus<K,V> {

    /**
     * Sort map by value
     * @param map
     * @return
     */
    public static<K,V> Map<K, V> sortMapByValue(Map<K, V> map) {
        List<Map.Entry<K, V>> list = new LinkedList<Map.Entry<K, V>>(
                map.entrySet());
        Collections.sort(list,
                new Comparator<Map.Entry<K, V>>() {
                    public int compare(Map.Entry<K, V> o1,
                            Map.Entry<K, V> o2) {
                        return (o2.getValue().compareTo(o1.getValue()));
                    }
                });

        Map<K, V> result = new LinkedHashMap<K, V>();
        for (Iterator<Map.Entry<K, V>> it = list.iterator(); it.hasNext();) {
            Map.Entry<K, V> entry = it.next();
            result.put(entry.getKey(), entry.getValue());
        }
        return result;
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-17T13:00:02.580

你需要有`V`实施`Comparable`。您可以通过以下方式明确要求它：

```
public static<K, V extends Comparable<V>> Map<K, V> sortMapByValue(Map<K, V> map) 
```

或者，您可以强制转换`o1.getValue()`为.`o2.getValue()``Comparable<V>`

# iphone - 使用 CFrealese 时应用程序崩溃

> ID：14921305
> 
> 赞同：0
> 
> 时间：2013-02-17T12:56:56.627
> 
> 标签：iphone, memory-management, ios6

![应用程序在此处崩溃，如屏幕截图所示](../Images/9dcc970acb027503cb86094a0c700b14.png)

我在后台线程上调用一个方法..写在下面

```
 imageRef = assetLbraryImp.defaultRepresentation.fullResolutionImage;
   [self saveBigImageFull:imageRef withName:mediafileName addToAlbum:isFromCamera];

   -(void)saveBigImageFull:(CGImageRef)bigImage withName:(NSString*)imageName addToAlbum:   (BOOL)addToAlbum{
         bigImageFulldata = [NSArray arrayWithObjects: imageName, [NSNumber  numberWithBool:addToAlbum], nil];
[self saveBigImage:bigImageFulldata :bigImage];
 }
 -(void)saveBigImage:(id)data:(CGImageRef)imageRefere{
     _iName = (NSString *)[data objectAtIndex:0] ;
     bigImagefileName = [[NSString alloc]initWithFormat:@"%@.jpg", _iName] ;
    bigImageFilepath = [photoPath stringByAppendingPathComponent:bigImagefileName] ;
   [self savePhotoBig:imageRefere toPath:bigImageFilepath];
 }

   -(void)savePhoto:(CGImageRef)photo toPath:(NSString *)path{
       image = [UIImage imageWithCGImage:photo];
       imageData = UIImagePNGRepresentation(image);
       [imageData writeToFile:path atomically:NO];
       if(photo)
            CFRelease(photo);
   } 
```

但是由于 CFRelease 导致应用程序崩溃。当我删除 CFRelease 时，代码工作正常。如果保存 100 张图像，则保存 100 张图像。即使在最终应用程序崩溃保存后。应用程序在进程结束时崩溃，而不是介于两者之间。

任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:13:02.810

> 由于 CFRelease，应用程序崩溃。当我删除 CFRelease 时，代码工作正常。

我建议检查你`photo`在调用的方法中做了什么`savePhoto:`；你`photo`打电话后访问`savePhoto:`吗？

> 如果我保存 100 张图像，则保存 100 张图像。即使在最终应用程序崩溃保存后。

我认为这是一个内存填充问题。使用 Instruments 的内存分配工具检查您的应用程序，以确认它由于内存填满而被终止。

编辑：

阅读上面的代码，您似乎正在保存以下图像：

```
imageRef = assetLbraryImp.defaultRepresentation.fullResolutionImage; 
```

这与您稍后通过 发布的图像相同`CFRelease`。这里有两件事：

1.  可能assetLibraryImp 是图像的实际所有者，所以你最好让它发布（但我无法从你的代码中判断这一点，所以你会知道的）；

2.  如果你想在 中发布`savePhoto`，那么我真的认为你应该使用`CGImageRelease`而不是`CFRelease`，即：

    ```
     if(photo)
           CGImageRelease(photo); 
    ```

此外，您说您正在后台线程中执行该方法：请注意 UIKit 不是线程安全的，因此这很可能是您崩溃的原因。尝试在主线程上执行该方法（尽管它会阻塞 UI，只是为了测试），看看会发生什么。

# postgresql - pg_dump 创建一个原始数据库的四倍的文件

> ID：14921306
> 
> 赞同：3
> 
> 时间：2013-02-17T12:56:59.463
> 
> 标签：postgresql, pg-dump

我有一个 13GB 大小的数据库。当我用这个命令备份它时：

```
pg_dump -f out.sql --format=p -b -o -O -x -U postgres mydb 
```

文件 out.sql 有 53GB 大小。它大约是原始数据库大小的 4 倍。为什么会发生这种情况，我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T00:26:48.253

这实际上取决于您保存的数据类型和使用的数据类型，特别是如果您只是将其转储到 sql 文件中。除了压缩之外，如果你的数据库设计得很好，它应该比转储占用更少的空间。

例如，`int`数据类型总是使用 4 个字节——本段中的每个字母、空格、句号或逗号的大小为 1 个字节，但每个数字保存为 32 位`int`大小始终为 4 个字节。然而，这允许从正 20 亿到负 20 亿的数字范围，即可能是 10 位数长的数字。换句话说，如果您以书面形式转储该信息，如您在此处看到的，那么任何超过 9999 或低于 -999 的数字实际上都会比保存它的格式“更大”，因此如果 db 主要是数字那么这可以解释这种差异。（这也意味着数字 100 及以下或 -10 及以上在书面形式中实际上会“更小”，但离题不谈，总是有 smallint (int2) - 如果你真的很挑剔，我相信有一个 tinyint如果该字节对您意义重大，则扩展名）。

另一个想法可能是一个 dna 数据库，如果你只有字母 ACG 和 T 意味着只有 4 种可能性，那么你可以将每个“字母”保存在 2 位信息中 - 因为一个字节有 8 位，那么你可以有效地将所有内容存储在四分之一的大小。

无论数据库使用哪种形式，无论是数字、二进制文件、日期、浮点数、枚举类型......无论如何，如果数据库不是纯文本，那么转储可能会比原始文件大。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:14:03.323

> 我有一个 13GB 大小的数据库

那是什么尺寸？/data/ 目录占用的大小？这与垃圾场有很大不同。转储是数据的文本表示，可以预期它占用比二进制表示更多的空间（例如：时间戳字段在内部占用 8 个字节，在转储中将表示为肯定会占用超过 8 个字节的字符串人物）。另一方面，二进制数据包含附加信息（更重要的是，索引数据，不进入转储）。因此，将二进制大小与转储大小进行比较是无关紧要的

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T13:06:56.093

如果大小很重要，为什么不使用自定义格式？--格式=c

它默认使用压缩。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T13:06:08.657

```
pg_dump mydb -oOxU postgres | bzip2 > out.sql.bz2 
```

# report - 在 Openerp RML 报告中获取页码

> ID：14921309
> 
> 赞同：2
> 
> 时间：2013-02-17T12:57:11.773
> 
> 标签：report, openerp

我想问一下openerp 6.1 报告rml

我想检查我的报告中是否有页数如果我有不止一页我必须打印“下一页还有另一个数据”如果我在第二页打印“上一页还有另一个数据页”等到最后一页

有没有办法在报告中检查它

```
 [["" if pagenumber()>1 else "second page paragraph" ]] 
 [["" if pagenumber()==pagecount else "last page" ]] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T07:09:57.540

`<pageNumber/>`在 rml 文件中使用标签，例如

```
<pageGraphics>
    <drawCentredString x="10.5cm" y="0.8cm">Page: <pageNumber/>
    </drawCentredString>
</pageGraphics> 
```

供参考，请转到`settings > company > header/footer`选项卡。在此您将获得页码的参考。

# c++ - 写入新分配内存的访问冲突

> ID：14921318
> 
> 赞同：-4
> 
> 时间：2013-02-17T12:58:11.217
> 
> 标签：c++, windows, memory

我有一个程序在**长时间**运行时会因“访问冲突”而**间歇性**崩溃。调试后，我遇到了一个非常奇怪的现象。

 **该程序在将一个分配（复制）`std::vector`到另一个的代码上崩溃，如下所示：

```
struct Data
{
int int1;
int int2;
}
//vec1 is empty
//vec2 contains a couple of thousands Data structs 
std::vector<struct Data> vec1 = vec2;//**crash happens here** 
```

发生的事情很简单——STL 为 分配一个内存块`vec1`，然后从中`vec2`复制数据。分配顺利。当 STL 尝试`vec1`用来自`vec2`. 更奇怪的是，该复制过程的某些部分被正确执行，而崩溃发生在该过程中间的某个地方。

我的问题是 - 新分配的内存块如何“部分”不可写？谢谢你。

**编辑：伙计们，我并不是说这段代码有问题——当然没有。我在问为什么这种类型的代码会崩溃？即我的程序的另一部分如何修改STL新分配的内存块？以及如何调试这种内存损坏？**

是的，这是真正的代码

补充：我已经启用**页堆**来查看问题是否发生在这段代码执行之前。它什么也没抓住。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T17:40:25.250

好的，我发现原因是不正确的同步，即在初始化过程中`vec2`从辅助线程修改。`vec1`与原始帖子中的向量分配相对应的 STL 代码如下：

```
if (_Buy(_Right.size())) 
    _Mylast = _Ucopy(_Right._Myfirst, _Right._Mylast, _Myfirst); 
```

第一行为新向量分配内存，第二行复制内容。

发生的事情是在第一行完成（并分配了内存）之后，从外部线程修改了向量并增加了它的大小。所以第二行试图复制比分配的内存大小更多的元素。这导致访问冲突。**

# ios - 带有数学符号的 iOS 自定义键盘

> ID：14921321
> 
> 赞同：0
> 
> 时间：2013-02-17T12:58:15.363
> 
> 标签：ios

在我的应用程序中，我有一些可以编辑的 UITextViews。由于该应用程序是一个数学应用程序，我想在普通 iOS 键盘上添加某种键盘或选项卡，用户可以在其中选择普通 iOS 键盘中不存在的某些数学符号，例如平方根、函数、分数。

这可能吗？有没有这样做的第三方sdk？

# android - 无法在对话框上设置按钮的侦听器？

> ID：14921324
> 
> 赞同：0
> 
> 时间：2013-02-17T12:58:26.093
> 
> 标签：android

我对对话框上的按钮的事件侦听器有问题。我有一个快速操作，当我单击菜单快速操作上的项目时，我想显示一个对话框，并且我想将 clickListener 设置为按钮 YES 和 NO。请帮我！我的代码：在函数 onCreate() 中，我声明

```
dialog1 = new Dialog(this,R.style.FullHeightDialog);    
        btnDialogYes = (Button)dialog1.findViewById(R.id.bmessageDialogYes);
        btnDialogNo = (Button)dialog1.findViewById(R.id.bmessageDialogNo);
        message = (TextView)dialog1.findViewById(R.id.tvmessagedialogtext);
        dialog1.setContentView(R.layout.custom_dialog);
        dialog1.setCancelable(true); 
```

和

```
class MyClass implements OnClickListener{

} 
```

我覆盖

```
onClick(){
        switch(v.getId()){
            case R.id.bmessageDialogYes:{
                board.setCurrentPiece(Board.WHITE);
                threadComputer = new myThread(doBackgroundThreadProcessing);
                threadComputer.start();
                dialog1.dismiss();
                break;              
            }
            case R.id.bmessageDialogNo:{
                board.setCurrentPiece(Board.BLACK);
                threadComputer = new myThread(doBackgroundThreadProcessing);
                threadComputer.start();
                dialog1.dismiss();
                break;              
            }

        }
} 
```

当我单击菜单快速操作项时，我调用提及 Play()

```
Play(){
     message.setText("YES to AI first play!");      
        btnDialogYes.setOnClickListener(this); // error here
        btnDialogNo.setOnClickListener(this);

        dialog1.show();
} 
```

但是当我运行应用程序不起作用时，我在文件布局中检查了小部件的 ID :(

```
my layout
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout_root"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:background="#ffffff"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="10dp"
        android:orientation="horizontal" >

        <!-- This is for the info image -->
        <ImageView
            android:id="@+id/imageView1"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginLeft="20dp"
            android:src="@android:drawable/ic_menu_info_details" />

        <!-- Title -->
        <TextView
            android:id="@+id/tvmessagedialogtitle"
            android:layout_width="184dp"
            android:layout_height="wrap_content"
            android:layout_marginLeft="10dp"
            android:layout_marginTop="4dip"
            android:layout_weight="0.01"
            android:padding="8dp"
            android:text="Message"
            android:textColor="#343434"
            android:textSize="16dip"
            android:textStyle="normal"
            android:typeface="normal" />
    </LinearLayout>

    <!-- Underline with this bluish color -->
    <View
        android:layout_width="fill_parent"
        android:layout_height="2dip"
        android:background="#09adb9" />

    <!-- The message -->
    <TextView
        android:id="@+id/tvmessagedialogtext"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_margin="10dp"
        android:layout_marginBottom="10dp"
        android:layout_marginTop="4dip"
        android:gravity="left"
        android:padding="8dp"
        android:text="Message"
        android:textColor="#343434"
        android:textSize="15dip"
        android:textStyle="normal"
        android:typeface="normal" />

    <LinearLayout
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginBottom="10dp"
        android:orientation="horizontal" >

        <!-- Yes button -->
        <Button

            android:id="@+id/bmessageDialogYes"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="4dip"
            android:layout_marginLeft="60dp"
            android:background="#ffffff"
            android:padding="8dp"
            android:text="Yes"
            android:textColor="#343434"
            android:textSize="13dip"
            android:textStyle="normal"
            android:typeface="normal" />

        <!-- No Button -->

        <Button
            android:id="@+id/bmessageDialogNo"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_marginTop="4dip"
            android:layout_marginLeft="80dp"
            android:background="#ffffff"
            android:padding="8dp"
            android:text="No"
            android:textColor="#343434"
            android:textSize="13dip"
            android:textStyle="normal"
            android:typeface="normal" />
    </LinearLayout>

</LinearLayout>

logcat
02-17 19:34:38.760: E/AndroidRuntime(374): FATAL EXCEPTION: main
02-17 19:34:38.760: E/AndroidRuntime(374): java.lang.NullPointerException
02-17 19:34:38.760: E/AndroidRuntime(374):  at my.quoc.caro_final.ComputerActivity.Play(ComputerActivity.java:254)
02-17 19:34:38.760: E/AndroidRuntime(374):  at my.quoc.caro_final.ComputerActivity.access$4(ComputerActivity.java:219)
02-17 19:34:38.760: E/AndroidRuntime(374):  at my.quoc.caro_final.ComputerActivity$2.onItemClick(ComputerActivity.java:68)
02-17 19:34:38.760: E/AndroidRuntime(374):  at my.quoc.caro_final.QuickAction$2.onClick(QuickAction.java:169)
02-17 19:34:38.760: E/AndroidRuntime(374):  at android.view.View.performClick(View.java:2485)
02-17 19:34:38.760: E/AndroidRuntime(374):  at android.view.View$PerformClick.run(View.java:9080)
02-17 19:34:38.760: E/AndroidRuntime(374):  at android.os.Handler.handleCallback(Handler.java:587)
02-17 19:34:38.760: E/AndroidRuntime(374):  at android.os.Handler.dispatchMessage(Handler.java:92)
02-17 19:34:38.760: E/AndroidRuntime(374):  at android.os.Looper.loop(Looper.java:123)
02-17 19:34:38.760: E/AndroidRuntime(374):  at android.app.ActivityThread.main(ActivityThread.java:3683)
02-17 19:34:38.760: E/AndroidRuntime(374):  at java.lang.reflect.Method.invokeNative(Native Method)
02-17 19:34:38.760: E/AndroidRuntime(374):  at java.lang.reflect.Method.invoke(Method.java:507)
02-17 19:34:38.760: E/AndroidRuntime(374):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-17 19:34:38.760: E/AndroidRuntime(374):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-17 19:34:38.760: E/AndroidRuntime(374):  at dalvik.system.NativeStart.main(Native Method)
02-17 19:34:40.700: I/Process(374): Sending signal. PID: 374 SIG: 9 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:09:43.537

它接缝`btnDialogYes`不引用您的按钮，因为您`dialog1.setContentView(R.layout.custom_dialog);`在`btnDialogYes = (Button)dialog1.findViewById(R.id.bmessageDialogYes);`

`setContentView`在 Dialog 实例创建后尝试调用方法。例如：

```
dialog1 = new Dialog(this,R.style.FullHeightDialog);
dialog1.setContentView(R.layout.custom_dialog);

btnDialogYes = (Button)dialog1.findViewById(R.id.bmessageDialogYes);
btnDialogNo = (Button)dialog1.findViewById(R.id.bmessageDialogNo);
message = (TextView)dialog1.findViewById(R.id.tvmessagedialogtext);

dialog1.setCancelable(true); 
```

# html - 单页网站，固定位置导航栏：如何在相应的div上更改“当前链接”的属性？

> ID：14921325
> 
> 赞同：-1
> 
> 时间：2013-02-17T12:58:29.767
> 
> 标签：html, css, singlepage, portfolio

我正在创建一个单页投资组合网站。我的导航栏是固定位置。单击链接时，它将向上/向下滚动到它链接到的相应 div（因为导航栏不会这样做）。有没有一种干净的方法可以使导航栏中的链接颜色在它们位于相应的 div 上时发生变化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:45:14.800

我不确定确切的目的。但是您可以为 a:active 使用 css 样式，或者您可以使用 jQuery 根据位置应用样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T17:29:26.010

我可以想到一个使用php的解决方案

如果您使用 $_SERVER 获取当前 url；当您在同一页面上时，您的网址将如下所示：[http ://example.com/#divid](http://example.com/#divid)

现在你可以炸开链接，得到对应的div的值。然后你需要在每个菜单项上运行一个 php if 语句来检查当前视图上是否是 div 并将 css 类更改为活动（使用你喜欢的样式）

希望有帮助。如果您尝试，请发布一些代码。

我们可以一起找到解决方案

# struts - 如何在 struts 2 应用程序中加载 index.jsp(welcome) 页面之前调用自定义拦截器

> ID：14921327
> 
> 赞同：1
> 
> 时间：2013-02-17T12:58:50.250
> 
> 标签：struts, struts-config

Struts 2 中有什么方法可以像 ServletContextListener 一样工作吗？我尝试这样做的原因是我确实有一些可以从数据库中获取的值，并且我希望这些值在主页被加载时可以在我的应用程序主页中使用

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:10:14.543

您需要在`PreResultListener`操作中添加一个：

```
public class MyInterceptor extends AbstractInterceptor {
  private static final long serialVersionUID = 5065298925572763728L;
    @Override
    public String intercept(ActionInvocation invocation) throws Exception {
      // Register a PreResultListener and implement the beforeReslut method
      invocation.addPreResultListener(new PreResultListener() {
        @Override
        public void beforeResult(ActionInvocation invocation, String resultCode) {
          //dostuff
        }
      });

      // Invocation Continue
      return invocation.invoke();
    }
  }
} 
```

取自[这里](http://blog.agilelogicsolutions.com/2011/05/struts-2-interceptors-before-between.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-27T05:49:35.473

我解决了我的问题，在 webContent 文件夹中创建索引文件并设置索引并在 struts.xml 中创建一个名称为 index 的操作。

# git - 撤消 git pull --rebase，日志不显示提交？

> ID：14921328
> 
> 赞同：0
> 
> 时间：2013-02-17T12:59:03.840
> 
> 标签：git, version-control

我对 git 很陌生，所以不知道如何解决我发现自己遇到的当前问题。有人告诉我做一个

```
git pull --rebase
git push 
```

将我的本地提交合并到服务器上的提交。然而现在，我所有的提交和代码更改都消失了，我不知道如何取回它们。如果我做一个

```
git log 
```

它没有显示我的本地提交。我如何从这里前进？理想情况下，我希望我的提交与服务器合并，但如果我能回到 --rebase 之前的阶段，那么我也会很高兴。

git reflog 确实显示了我所做的一些提交，这是一位专家。

![在此处输入图像描述](../Images/445fb339c773d9c6c5232152f66dfb4c.png)

提交“添加丢失的 jars”是我在本地执行的最后一次。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:30:29.547

您是否首先重置了 origin/master（请参阅您的 reflog 中的 HEAD@{2}）？这将使您失去本地更改。

无论如何，你可以再试一次。要回到原来的位置，请执行以下操作：

```
git reset --hard HEAD@{3} 
```

然后你可以再次使用 rebase 尝试你的 git pull 。

如果这感觉有点不安全，你可以在执行 git pull 之前创建一个备份分支。

```
git branch backup 
```

# java - 在java oop中创建多个对象

> ID：14921330
> 
> 赞同：1
> 
> 时间：2013-02-17T12:59:18.770
> 
> 标签：java, oop

我不能只是解决这个问题。我有一个用户类：

```
public class user {

private String name;
private int age;

public user()
{
}

public String getName()
{
    return name;
}

public int getAge()
{
    return age;
}

public void setName(String kname)
{
    name = kname;
}

public void setAge(int kage)
{
    alter = kage;
}

} 
```

我正在我的 userUI 类中创建和列出用户

```
public class PersonalUI {

public static void main (String args[]) {
    int menu = 0;
    int i = 0;
    while (menu != 3)
    {   
    System.out.println("Please choose: \n (1) Create User \n (2) List User                \n              (3) Quit");
    menu = Console.readInt();
    if (menu = 1)
    {   
    User user[i] = new User();
    System.out.println("Please enter a name");
    String kname = Console.readString();
    user[i].setName(kname);
    }
} 
```

我的问题：当我收到 User user[i] = new User(); 的错误时，如何创建多个对象 猜我只是做错了

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-17T13:02:51.993

在您的情况下，数组不是要走的路。使用[清单](http://docs.oracle.com/javase/6/docs/api/java/util/List.html)：

```
List<User> users = new ArrayList<User>;

if (menu == 1)
{   
    User newUser = new User();
    users.add(newUser);
    newUser.setName(kname);
} 
```

您不知道将预先输入的用户数量 - 因此使用动态数据结构。

您的问题是您试图同时做两件事：创建一个数组并将值分配给它的特定元素。

这是你应该如何操作一个数组：

```
int length = 5; // predetermined by you constant
User []users = new User[length];
//....
users[i] = new User(); 
```

正是由于预先确定的常数，我建议使用 List。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T13:33:45.753

你可以检查这个错误。

```
User user[i] = new User();

user[i] = new User();   // add this in your code

System.out.println("Please enter a name");
String kname = Console.readString();
user[i].setName(kname); 
```

许多人认为语句 User user[i] = new User() 创建了 User 的对象，但它创建了一个引用变量。需要将引用变量转换为对象，如下所示：

用户[i] = 新用户（）；

您可以在[Confusion of reference variables and objects in arrays (array of array objects)中找到更多信息](http://way2java.com/arrays/confusion-of-reference-variables-and-objects-in-arrays-array-of-array-objects/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T13:01:12.077

首先，您应该从命令行读取用户数组的大小，以定义循环外数组的大小。然后在循环内用适当的元素填充数组。

```
 System.out.println("please enter size of the user");
    int size=console.readInt();
    User[] user = new User[size]
    while (menu != 3)
    {   
    System.out.println("Please choose: \n (1) Create User \n (2) List User                \n              (3) Quit");
    menu = Console.readInt();
    if (menu == 1)//changed, you were using assigning here (menu=1)
    {   
    user[i] = new User(); 
```

但是，如果您想要一个动态数组，请使用像[**ArrayList**](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)**这样的List**实现类，它不需要您在创建数组时提供大小。[](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)

 **```
 List<User> usersList = new ArrayList<User>();
   //then inside the loop populate the list with its `List#add(elem)` method 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-17T13:04:34.770

它应该是// 在这里你创建大小的对象
`User user[] = new User[size];` 数组`User``size`

然后对于每个`user`：
`user[i] = new User();` //在这里您正在初始化每个用户对象

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-17T13:10:59.540

您检查菜单值的比较是错误的。

它不应该是`menu = 1`，而是应该是`menu == 1`。

我不知道您将如何存储用户，但我建议制作一个`ArrayList`将存储用户对象并在创建新 `User`对象时将其添加到列表中的方法。

在列出 users 时，只需遍历创建的数组列表。

我认为这是你需要的：

```
public static void main (String args[]) {
    int menu = 0;
    int i = 0;
    List<User> list = new ArrayList<User>();
    while (menu != 3)
    {   
    System.out.println("Please choose: \n (1) Create User \n (2) List User                \n              (3) Quit");
    menu = Console.readInt();
    if (menu == 1)
    {   
    User user = new User();
    System.out.println("Please enter a name");
    String kname = Console.readString();
    user.setName(kname);
    // add this user to the list
    list.add(user);
    }
} 
```**

# sdk - 如何检测 Corona 中的重叠对象？

> ID：14921331
> 
> 赞同：1
> 
> 时间：2013-02-17T12:59:21.207
> 
> 标签：sdk, collision-detection, coronasdk, target, overlapping

检测十字准线瞄准**圆形**目标的最佳方法是什么？我尝试在十字准线中间添加一个小圆圈，并检测该圆圈与目标何时发生碰撞。但我无法让它工作。

我已经尝试过使用目标的 x 和 y 坐标，但如果能够检测到十字准线“圆圈”和圆形目标何时重叠，以及何时不重叠，那就更好了。

我已经尝试过重叠图像： http: [//developer.coronalabs.com/code/flashs-hittestobject-emulated-using-contentbounds](http://developer.coronalabs.com/code/flashs-hittestobject-emulated-using-contentbounds)但这不能识别圆形，只能识别矩形。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T13:59:39.650

The crosshairs is on the object if the distance from the x,y of the crosshairs to the center of the object is less than or equal to the radius of the object. Pythagoras is your friend here. Check this in `enterFrame` event.

You don't need to do the square root calculation for this, by the way. Just compute `((x1-x2)*(x1-x2)) + ((y1-y2)*(y1-y2))` each time through `enterFrame`, and compare it to the object's radius squared, which will be constant and can therefore be calculated just once.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-25T01:36:26.353

查看这篇关于非物理碰撞的博客文章。其中涵盖了两种方法（框重叠和圆半径）。我在很多不需要物理的应用程序中使用它们。

[http://omnigeek.robmiracle.com/2011/12/14/collision-detection-without-physics/](http://omnigeek.robmiracle.com/2011/12/14/collision-detection-without-physics/)

# android - 具有自定义视图的 AlertDialog 不会“调整大小”

> ID：14921339
> 
> 赞同：5
> 
> 时间：2013-02-17T13:00:13.007
> 
> 标签：android, android-layout, android-alertdialog, android-dialog

我遇到了 AlertDialog 和自定义内容/视图的问题。简单地说，当软键盘打开时，AlertDialog 不会自行调整大小。以下屏幕截图最能说明我的问题是什么以及我想要实现的目标：

当前行为（左）和想要的行为（右）

![当前行为](../Images/ba9200b764f5e721ff408a1ea28c880c.png) ![想要的行为](../Images/1d2cdd7d1b44294b3d3109af8e9bd5fc.png)

我知道在 SO 上还有其他一些类似问题的线程。不幸的是，提供的解决方案都不适合我。按照我的示例代码：

XML

```
<?xml version="1.0" encoding="utf-8"?>
<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="vertical" >

        <EditText
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >
        </EditText>
    </LinearLayout>

</ScrollView> 
```

Java - CustomAlertDialog.class

```
public class CustomAlertDialog extends AlertDialog{

    private Context context;

    public CustomAlertDialog(Context context) {
        super(context);
        this.context = context;
    }

    public void buildDialog(){
        LayoutInflater inflater = getLayoutInflater();
        View layout = inflater.inflate(R.layout.dialog_content, null);
        builder = new AlertDialog.Builder(context);
        builder.setTitle("EditText");
        builder.setView(layout);
        builder.setPositiveButton("Ok", new OnClickListener() {

            @Override
            public void onClick(DialogInterface arg0, int arg1) {
                dismiss();
            }
        });
        builder.create();
    }

    public void showDialog(){
        builder.show();
    }
} 
```

上面的类/函数在我的 Main.java 类中按下按钮时调用

```
btnAlertDialog.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View arg0) {
            CustomAlertDialog dialog = new CustomAlertDialog(Main.this);
            dialog.buildDialog();
            dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
            dialog.showDialog();
        }
    }); 
```

我尝试了以下事情：

像这样向 LinearLayout 添加滚动条

```
android:scrollbars="vertical" 
android:scrollbarAlwaysDrawVerticalTrack="true" 
```

结果：没有任何改变

为对话框设置标志：

```
dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE); 
```

结果：没有任何改变

将自定义样式应用于 AlertDialog：

```
<style name="AlertDialog" parent="@android:style/Theme.Holo.Light">
        <item name="android:windowFullscreen">false</item>
</style> 
```

爪哇

```
builder = new AlertDialog.Builder(context, R.style.AlertDialog); 
```

这行得通。不幸的是，它产生了一些问题，您可以在以下屏幕截图中看到

![自定义样式 - 新问题](../Images/da330667a17e7c55259015642cb3b84d.png)

我感谢任何帮助，因为我已经为这个问题苦苦挣扎了好几天。谢谢！

# **解决方案**

我现在使用以下方法在我的`CustomAlertDialog.class`. 请参阅我在[nandeesh](https://stackoverflow.com/users/1109425/nandeesh)答案下方的评论，以了解为什么它以前不起作用的更多详细信息。

```
public void startDialog(){
        LayoutInflater inflater = getLayoutInflater();
        View layout = inflater.inflate(R.layout.dialog_content, null);
        builder = new AlertDialog.Builder(context);
        builder.setTitle("EditText");
        builder.setView(layout);
        builder.setPositiveButton("Ok", new OnClickListener() {

            @Override
            public void onClick(DialogInterface arg0, int arg1) {
                dismiss();
            }
        });
        AlertDialog aDialog = builder.create();
        aDialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
        aDialog.show();
    } 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-02-20T14:31:29.707

我不确定你在哪里做了 setSoftInputmode 而是

```
builder.show(); 
```

采用

```
AlertDialog mDialog = builder.create();
mDialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
mDialog.show(); 
```

如果这不起作用，请发布 CustomAlertDialog 类

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T14:13:03.323

显然，这个问题与对话框的构建方式无关，如果您使用自定义视图等，则问题是 windowSoftInputMode。

更改 Activity 的 AndroidManifest.xml 中的 windowSoftInputMode 除了为 Window 更改它应该可以解决问题。

确保对话框中的视图是 ScrollView。

# .net - “www”对我的端点绑定有什么作用？

> ID：14921340
> 
> 赞同：0
> 
> 时间：2013-02-17T13:00:29.827
> 
> 标签：.net, wcf, web-services, silverlight, silverlight-4.0

所以我最近一直在部署一个 Silverlight 网站，我刚刚注意到一些非常可怕的错误。

我的 Silverlight 应用程序有 5 个绑定到托管在同一网站上的 Web 应用程序上的 wcf 服务，前面只有一个文件夹。假设我的网站是**www.test.com**。下面是来自 silverlight 应用的 ServiceReferences.ClientConfig 的绑定：

```
<client>
    <endpoint address="http://www.test.com/MyWebService/Service1.svc"
        binding="customBinding" bindingConfiguration="CustomBinding_IService1"
        contract="Service1.IService1" name="CustomBinding_IService1" />
    <endpoint address="http://www.test.com/MyWebService/Service2.svc"
        binding="customBinding" bindingConfiguration="CustomBinding_IService2"
        contract="Service2.IService2" name="CustomBinding_IService2" />
    <endpoint address="http://www.test.com/MyWebService/Service3.svc"
        binding="customBinding" bindingConfiguration="CustomBinding_IService3"
        contract="Service3.IService3" name="CustomBinding_IService3" />
    <endpoint address="http://www.test.com/MyWebService/Service4.svc"
        binding="customBinding" bindingConfiguration="CustomBinding_IService4"
        contract="Service4.IService4" name="CustomBinding_IService4" />
    <endpoint address="http://www.test.com/MyWebService/Service5.svc"
        binding="customBinding" bindingConfiguration="CustomBinding_IService5"
        contract="Service5.IService5" name="CustomBinding_IService5" />
</client> 
```

所以我的问题是，当我加载 Silverlight 应用程序时，在托管在我的 IIS 网站根目录的默认 aspx 页面上，连接仅在我在 URL 地址中键入**test.com**时才起作用，而不是在我键入**www.test时.com** _ 它没有失败，但是应该通过服务提取的数据只是没有显示，而且我无法连接我的凭据。（因为我的一项服务用于身份验证）

**我尝试通过删除www**更改我的应用程序的 ServiceReferences.ClientConfig 的值，但情况并没有改变一点。如果没有网址中的 www，它仍然可以很好地连接，并且在打开 www 时连接不好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T16:12:36.230

好吧，多亏了[这篇可爱的帖子](http://tonychampion.net/blog/index.php/2011/02/deploying-silverlight-with-wcf-services/)，我才能克服这个问题。我将在这里解释我必须做什么，以防万一链接失效。

我所要做的就是在我的 Silverlight 代码中更改每个服务客户端的每个实例：

```
Service.IService proxy = new Service.ServiceClient(); 
```

对此：

```
Uri servUri = new Uri("../MyWebService/Service.svc", UriKind.Relative);
EndpointAddress servAddr = new EndpointAddress(servUri);
Service.IService proxy = new Service.ServiceClient("CustomBinding_IService", servAddr); 
```

如博客文章中所述，“..”是必需的，因为 Silverlight 应用程序（通常）位于**ClientBin**文件夹中。

这对我有用！

# bash - 从 bash 脚本分叉交互式 bash

> ID：14921341
> 
> 赞同：1
> 
> 时间：2013-02-17T13:00:30.380
> 
> 标签：bash, fork

我正在尝试从 bash 脚本中分叉交互式 bash，如下所示：

```
#!/bin/bash
bash -c 'bash -i -l' & 
```

运行上述脚本进程 'bash -i -l' 后，CPU 使用率达到 100%。这种行为的原因是什么？

我正在 Fedora 16 上进行测试。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T14:03:27.567

有趣的问题。请注意，这相当于运行：

`bash -c "bash -c 'bash -i -l' &"`

在您的命令提示符下。我刚刚运行得到了相同的结果：

`bash -c "bash -i &"`

很确定发生了什么是 Bash 正在轮询试图访问控制终端（因为它试图进行交互），但它是不允许的（因为它是一个后台进程）。我试着跑步`bash -c 'strace -o bash_trace.txt bash -i &'`。它在循环中执行此操作：

```
...
    rt_sigaction(SIGTTIN, {SIG_DFL, [], 0}, {SIG_IGN, [], 0}, 8) = 0
kill(0, SIGTTIN)                        = 0
--- SIGTTIN (Stopped (tty input)) @ 0 (0) ---
rt_sigaction(SIGTTIN, {SIG_IGN, [], 0}, {SIG_DFL, [], 0}, 8) = 0
ioctl(255, TIOCGPGRP, [9964])           = 0
rt_sigaction(SIGTTIN, {SIG_DFL, [], 0}, {SIG_IGN, [], 0}, 8) = 0
kill(0, SIGTTIN)                        = 0
--- SIGTTIN (Stopped (tty input)) @ 0 (0) ---
rt_sigaction(SIGTTIN, {SIG_IGN, [], 0}, {SIG_DFL, [], 0}, 8) = 0
ioctl(255, TIOCGPGRP, [9964])           = 0
rt_sigaction(SIGTTIN, {SIG_DFL, [], 0}, {SIG_IGN, [], 0}, 8) = 0
kill(0, SIGTTIN)                        = 0
--- SIGTTIN (Stopped (tty input)) @ 0 (0) ---
... 
```

进程在尝试访问控制终端时会获得 SIGTTIN，但它们是后台运行的 - [http://www.lindevdoc.org/wiki/SIGTTIN](http://www.lindevdoc.org/wiki/SIGTTIN)。我不知道这样旋转是否正确。

# c# - 无法在构造函数中打开数据集

> ID：14921343
> 
> 赞同：-2
> 
> 时间：2013-02-17T13:00:58.277
> 
> 标签：c#, asp.net, constructor, dataset

我正在编写 ASP.NET C# web 项目，并创建了 DataSet 和几个表适配器和 MySQL 查询。

突然，计算机关闭，当再次打开它并在 Visual Studio 中打开我的项目时，我无法在构造函数中打开我的 DataSet。DataSet 仅在如下代码中打开：

![在此处输入图像描述](../Images/09fb991263cd86da852489375b090d87.png)

有人知道如何在构造函数中打开数据集吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:17:43.050

右键单击它并选择`Open With`- 然后从那里选择`DataSet Editor`

或者重置 VS 设置 -`devenv /resetskippkgs`从 VS 命令提示符

# opencv - 以随机比例识别相似形状并进行平移

> ID：14921347
> 
> 赞同：8
> 
> 时间：2013-02-17T13:01:20.320
> 
> 标签：opencv, image-processing, computer-vision, fft, image-recognition

在图形屏幕上寻找东西，我目前不知道如何在图像中找到给定的形状。图像中的形状可能具有不同的比例，并且当然会有一些未知的 x,y 偏移。

除了不同尺度导致的像素伪影之外，两张图像中也有一点噪音，所以我需要一个稍微宽容的搜索。

这是我正在寻找的图像。

![农夫框架](../Images/692be52004ae4ab11e6dbc704bb0f934.png)

它应该出现在我的（双）屏幕缓冲区的屏幕转储中，大小约为 3300 x 1200 像素。我当然希望在浏览器窗口中找到它，但这些信息不应该是必需的。

这个练习的目的（到目前为止）是想出一个结果：

*   是的，在我的屏幕上（或没有）找到了木制框架（颜色近似，形状可能略有截断）；和
*   游戏的客户区（框架内的黑色区域）占据了从`(x1,y1)`到的矩形`(x2,y2)`。

我希望对缩放和抖动可能引入的噪声具有鲁棒性。另一方面，我可以排除一些常见的 CV 挑战，例如旋转或非刚性。这种框架形状对于人脑来说非常容易辨别，对于专用软件来说有多难？这是一个 Adob​​e Flash 应用程序，直到最近我还认为从游戏 GUI 中感知图像应该很容易。

我正在寻找一种算法，该算法能够找到针和干草堆之间发生最大可能重叠的 x、y 平移，并且如果可能的话，无需通过一系列可能的比例因子进行迭代。理想情况下，该算法可以以一种独立于比例的方式抽象出图像的“形状”。

我读过一些关于傅立叶变换的有趣的东西来完成类似的事情：给定一个相同比例的目标图像，FFT 和一些矩阵数学在更大的图像中产生了与搜索模式相对应的点。但我没有将其付诸实践的理论背景，也不知道这种方法是否能优雅地处理规模问题。帮助将不胜感激！

技术：我正在使用 Clojure/Java 编程，但可以适应其他语言的算法。我认为我应该能够与遵循 C 调用约定的库进行交互，但我更喜欢纯 Java 解决方案。

* * *

您可能会理解为什么我回避展示实际图像。这只是一个愚蠢的游戏，但事实证明，屏幕阅读的任务比我想象的更具挑战性。

我显然能够对我的屏幕缓冲区进行详尽的搜索，以查找构成我的图像的像素（不包括黑色），甚至可以在一分钟内运行。但我的目标是找到使用一种与形状相匹配的技术的木制框架，而不管缩放和抖动可能产生的差异。

事实上，抖动是我在这个项目中遇到的许多挫折之一。我一直致力于通过边缘提取来提取一些有用的向量，但是边缘非常难以捉摸，因为任何给定区域的像素具有广泛不一致的颜色 - 所以很难从局部抖动伪影中分辨出真正的边缘。我不知道如此简单的游戏会产生软件难以感知的图形。

在我开始寻找特征之前，我应该从局部平均像素开始吗？我应该通过丢弃像素颜色值的最低有效位来减少颜色深度吗？

我正在*尝试*一个纯 Java 解决方案（实际上是在 Clojure/Java 混合中编程），所以我对 opencv（它使用 C 代码安装 .DLL 或 .so）并不感兴趣。请不要担心我的语言选择，学习体验对我来说比表演更有趣。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-26T14:34:42.847

作为一名计算机视觉专家，我通常会指出特征提取和匹配（SIFT、SURF、LBP 等），但这几乎可以肯定是矫枉过正，因为这些方法中的大多数都提供了更多的不变性（= 对转换的容忍度）比你实际需要的（例如反对旋转，亮度变化，......）。此外，使用功能将涉及 OpenCV 或*大量*编程。

所以这是我对一个简单解决方案的建议——你判断它是否通过了智能阈值：

看起来您正在寻找的图像具有一些非常独特的结构（字母、徽标等）。我建议您对每种可能的翻译以及许多不同的比例进行像素到像素匹配（我假设比例范围是有限的） - 但仅适用于您正在寻找的图像**的一小块独特的补丁**（例如，黄色文本的正方形部分）。这比匹配整个事情要快得多。如果您想要一个花哨的名称：在图像处理中，它被称为相关性模板匹配。“模板”是您正在寻找的东西。

一旦你为你的小独特补丁找到了几个候选位置，你可以通过测试整个图像或更有效地测试图像的**其他几个独特补丁来****验证**你是否命中（当然，使用翻译/你找到的规模）。这使您的搜索对原始补丁的意外匹配具有鲁棒性，而不会窃取太多性能。

 **关于抖动容限，我将对两个图像（您正在寻找的模板和作为您的搜索空间的图像）进行简单的预过滤。根据抖动的属性，您可以开始尝试简单的框模糊，如果不起作用，可能会继续使用小内核 (3 x 3) 的中值滤波器。这不会让您在模板和搜索图像之间获得 100% 的同一性，但您可以比较可靠的数字分数。

**根据评论编辑**

我知道 (1) 您想要更强大、更“类似 CV”并且更花哨的解决方案，并且 (2) 您对通过简单地扫描一大堆不同的尺度来实现尺度不变性持怀疑态度。

**关于（1）**，如上所述，规范方法是使用特征描述符。特征描述符不描述完整的图像（或形状），而是描述图像的一小部分，其方式对各种变换是不变的。看看[SIFT](http://www.cs.ubc.ca/~lowe/keypoints/)和[SURF](http://www.vision.ee.ethz.ch/~surf/)，以及[VLFeat](http://www.vlfeat.org)，它具有良好的 SIFT 实现并且还实现了[MSER](http://en.wikipedia.org/wiki/Maximally_stable_extremal_regions)和[HOG](http://en.wikipedia.org/wiki/Histogram_of_oriented_gradients)（并且比 OpenCV 小得多）。SURF 比 SIFT 更容易实现，两者都拥有大量专利。两者都有一个“直立”版本，没有旋转不变性。这应该会增加您的情况的稳健性。

您在评论中描述的策略更多地朝着形状描述符的方向发展，而不是图像特征描述符。*确保您了解它们之间的区别！*2D 形状描述符针对通常由轮廓或二进制掩码描述的形状。图像特征描述符（在上述意义上使用）针对具有强度值的图像，通常是照片。一个有趣的形状描述符是[形状上下文](http://en.wikipedia.org/wiki/Shape_context)，[这里总结了](http://math.uci.edu/icamp/summer/research/classification/shape_descriptors_survey_part3.pdf)*许多*其他的。我不认为你的问题最好通过形状描述符来解决，但也许我误解了一些东西。我会非常小心图像边缘的形状描述符，因为边缘是一阶导数，可以通过抖动噪声强烈改变。

**关于（2）**：我想说服你，扫描一堆不同的尺度对于那些不了解计算机视觉的人来说不仅仅是一个愚蠢的黑客！实际上，它在视觉上做了很多，我们只是给它起了一个花哨的名字来误导外行——[尺度空间](http://en.wikipedia.org/wiki/Scale_space)搜索。这有点过于简单化了，但实际上只是一点点。在实践中使用的大多数图像特征描述符使用尺度空间来实现尺度不变性，尺度空间是不断缩小（和低通滤波）图像的堆栈。他们添加的唯一技巧是在尺度空间中寻找极值并仅在这些极值处计算描述符。但是，仍然会计算并遍历完整的尺度空间以找到那些极值。看看[原始的 SIFT 论文](http://www.cs.ubc.ca/~lowe/keypoints/)对此有一个很好的解释。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-25T20:23:22.210

好的。我曾经通过捕获屏幕在 Flash 游戏上实现了一些作弊 :)。如果您需要找到您在图像中给出的确切边框，您可以创建一个颜色过滤器，从而删除所有其余部分，最终得到一个可以用于进一步处理的二进制图像（手头的任务是找到一个具有一定边框比例的匹配矩形。此外，您可以实现四个内核，以找到几个不同比例的角。

如果您有图像流并且知道有运动，您还可以通过使用背景建模解决方案监控帧之间的差异以捕捉屏幕中的动作部分。结合这些，我猜你会走得很远，而无需诉诸更奇特的方法，比如多尺度分析之类的东西。

它的性能有问题吗？我的作弊使用了大约 20 fps，因为它需要足够快地点击一个球。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T16:49:18.767

我正在报告我自己的问题的答案，让人们知道我最终去了哪里。

* * *

在我寻求的魔法比例不变形状描述符上没有找到或得到任何提示，我决定按照 DCS 的建议在整个屏幕上执行几乎直接的像素搜索。

首先，我搜索了 512 x 60 的徽标块。但事实证明，最终成为四嵌套循环（完整图像的行/列 x 搜索图像的行/列）将运行一个多小时，最坏的情况。不可接受。

我可以通过选择较小的搜索图像（大约 48 x 32 像素的补丁）来线性缩小问题。我认为这花了我大约 30 秒，但仍然比我希望的要慢。此外，当我后来尝试搜索其他一些功能时，时间会越来越长。

我的解决方案是只搜索我的搜索图像的单个扫描线，甚至通过代理而不是完全搜索。由于我正在搜索的图像的漫画色彩性质，我认为平均色调可以很好地代表我正在寻找的像素。我选择了搜索图像的“中间”行，提取了每个像素的色调（作为 0 到 7200 之间的整数），并计算了这些色调值的总和。在屏幕图像中，我计算了与搜索图像宽度相对应的像素数的移动总数，因此对于每个像素位置，我只需减去最旧的像素并添加一个新像素。使用 Java`Color.rgbToHSB`留下了一些优化潜力，特别是考虑到转换为`float`并返回，但整个屏幕可以在几百毫秒内进行预采样。

因此，我为我的搜索图像中间线创建了一个屏幕色调总和之间的差异列表，找到了最佳（即最小）差异，然后对那些共享第一名以获得最佳差异的位置进行了完整的逐像素比较。这些最佳颜色总匹配通常少于 10 个，因此 10 个逐个像素的比较花费的时间可以忽略不计。

所以现在我在大约半秒内找到了我的搜索图像，还有一些优化潜力尚未开发。如果我需要“做”更多不同的比例，希望不同的分辨率能让我选择不同的搜索图像而无需反复试验，但在最坏的情况下，只需要多次运行一小部分比较工作，我预计仍会停留在一秒钟之内。

我没有达到我最初的目标，即对我所寻找的图像的不同抖动（即细节像素再现）非常有抵抗力；我的算法需要很好的颜色匹配。但考虑到这将是一个多么困难的问题，我决定如果有必要我会越过那座桥。**

# xml - 如何使用 xsl 模板和递归来构建新的 xml 文档？

> ID：14921352
> 
> 赞同：0
> 
> 时间：2013-02-17T13:01:42.670
> 
> 标签：xml, xslt, xpath

我想知道如何使用 xsl 模板将我的 xml 文档转换为另一个**具有原始元素层次结构的 xml 文档。**我还想为新生成的 XML 中的元素添加一些属性。

我的原始 XML 文件如下所示：

```
<shop> 
  <product>
    <cookie ID="001">
    <price>2</price>
    </cookie>
  </product>

  <product>
    <bread ID="002">
    <price>5</price>
    </bread>
  </product>

  <product>
    <milk ID="003">
    <price>2</price>
    </milk>
  </product>
</shop> 
```

我想将其转换为以下 XML：

```
<newXML> 
  <newElement>
    <newElement ID="001">
    <newElement price="2"/>
    </newElement>
  </newElement>

  <newElement>
    <newElement ID="002">
    <newElement price="5"/>
    </newElement>
  </newElement>

  <newElement>
    <newElement ID="003">
    <newElement price="2"/>
    </newElement>
  </newElement>
</newXML> 
```

什么是这样做的好方法？这可以使用带有模板的递归来完成，还是有更好的方法？我一直在尝试使用以下逻辑：

1.  制作一个创建元素的模板
2.  读取当前元素 ID（如果存在）并将其放入 newElement
3.  如果当前元素有一个子元素，则将此模板应用于它（某种递归）

尽管进行了多次尝试，但我仍然无法完成这项工作。您的帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:25:37.057

为此，您将构建 XSLT 身份转换，这是 XSLT 中非常常见的设计模式。首先，您只需一个模板，该模板可以复制元素并完全按原样输出]

```
<xsl:template match="@*|node()">
   <xsl:copy>
      <xsl:apply-templates select="@*|node()"/>
   </xsl:copy>
</xsl:template> 
```

然后你要做的是添加额外的模板来匹配你的元素，并添加代码来重命名它们，或者根据需要添加属性。例如，要重命名根元素，您将添加以下模板：

```
<xsl:template match="shop">
  <newXML>
    <xsl:apply-templates select="@*|node()"/>
  </newXML>
</xsl:template> 
```

您也不必在此处使用特定的元素名称。如果您想将具有**ID**属性的元素重命名为相同的名称，您可以执行以下操作

```
<xsl:template match="product/*[@ID]">
   <newElement>
      <xsl:apply-templates select="@*|node()"/>
   </newElement>
</xsl:template> 
```

对于您的**价格**元素，如果您想根据元素的文本内容创建一个属性，您可以像这样添加一个模板：

```
<xsl:template match="price">
   <newElement price="{.}" />
</xsl:template> 
```

（注意，这使用**属性值模板**来创建属性。这通常比使用**xsl:attribute**更可取）

初学者试试这个 XML：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="shop">
      <newXML>
         <xsl:apply-templates select="@*|node()"/>
      </newXML>
   </xsl:template>

   <xsl:template match="product">
      <newElement>
         <xsl:apply-templates select="@*|node()"/>
      </newElement>
   </xsl:template>

   <xsl:template match="product/*[@ID]">
      <newElement>
         <xsl:apply-templates select="@*|node()"/>
      </newElement>
   </xsl:template>

   <xsl:template match="price">
      <newElement price="{.}" />
   </xsl:template>

   <xsl:template match="@*|node()">
      <xsl:copy>
         <xsl:apply-templates select="@*|node()"/>
      </xsl:copy>
   </xsl:template>
</xsl:stylesheet> 
```

这将输出以下内容：

```
<newXML>
   <newElement>
      <newElement ID="001">
         <newElement price="2"/>
      </newElement>
   </newElement>
   <newElement>
      <newElement ID="002">
         <newElement price="5"/>
      </newElement>
   </newElement>
   <newElement>
      <newElement ID="003">
         <newElement price="2"/>
      </newElement>
   </newElement>
</newXML> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:14:15.993

听起来您只是想转换文档，那么为什么不尝试 XQuery 而不是 XSLT？就简单多了。。

您只需编写要创建的 xml，`{..}`如果您想从输入文件中插入一些内容，并`for $variable in //xpath`使用 xpath 表达式匹配的输入文件部分重复它。

因此，这将创建所需的 xml 文件：

```
<newXML>{
  for $prod in /shop/product/* return
    <newElement>
      <newElement>{
        $prod/@ID,
        for $value in $prod/* return 
          <newElement price="{$value}"/>
      }</newElement>
    </newElement>
}</newXML> 
```

# c# - 从用户控件访问表单

> ID：14921354
> 
> 赞同：3
> 
> 时间：2013-02-17T13:02:05.443
> 
> 标签：c#, user-controls

我有一个用户控件，需要访问 Form1.cs 上的变量和静态类。我在谷歌上找不到工作示例。请问有什么提示吗？谢谢！

```
namespace WinApp1
{
public partial class Form1 : Form
{
    Public MyCustomClass myClass; // need to access this
    public Form1()
    {

    }
}
public static class Global {
   public static myGlobalVar; // Need to Access This
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T13:12:27.513

在 UserControl 中使用`this.Parent`以获取父表单：

```
Form1 myParent = (Form1)this.Parent; 
```

然后您可以访问公共字段/属性：

```
myParent.myClass 
```

请注意，如果将 UserControl 放置在 Form 内的 Panel 中，您将需要获取父级的父级。

您可以通过其名称访问静态类：

```
Global.myGlobalVar 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-17T13:27:52.027

您可以使用 FindForm()

但是你应该退后一步，看看这是否是最好的解决方案。这是一个强依赖关系，它会降低控件的可测试性和重用因素。

例如，考虑引入一个包含控件所需成员的接口，并在父级 hiracy 中搜索它或将其作为参数注入，...

从那里你可以控制我的情况。可能还有更多的解决方案。只是想让你想如果没有什么比依赖表格更好的了..

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-07-01T06:51:58.500

利用 ：

```
frm_main frm;     //frm_main is your main form which user control is on it
frm=(frm_main)this.FindForm();     //It finds the parent form and sets it to the frm 
```

现在你有了你的主要形式。frm 上的任何更改都将反映在主窗体上。如果您想访问主窗体上的指定控件，请使用：

1-创建您要访问的类型的控件（例如：标签）：

```
Label lbl_main; 
```

2-使用从搜索结果返回的控件设置标签：

```
frm.Controls.FindControl("controlId",true); 
```

3-在标签上进行更改：

```
lbl_main.Text="new value changed by user control"; 
```

您的更改将反映在控件上。希望有帮助。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-17T13:20:39.777

我以为 this.Parent 返回放置用户控件的实际页面？然后你访问公共成员

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-09-11T19:40:44.903

在您的 UserControl 代码中，在 Click 事件或其他任何内容下：

```
private void sendParamToMainForm_Button_Click(object sender, EventArgs e)
{
    mainForm wForm;
    wForm = (mainForm)this.FindForm();

    wForm.lblRetrieveText.text = "whatever ...";
} 
```

希望这可以帮助 ：-）

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2019-04-06T14:41:58.957

In case your user control is inside panels and you want to access the form
you can use

```
 Main_Form myform = (Main_Form)ParentForm;
        MessageBox.Show(myform.Label2.Text); 
```

# excel - 使用数组值对列应用自动过滤器

> ID：14921355
> 
> 赞同：1
> 
> 时间：2013-02-17T13:02:31.570
> 
> 标签：excel, vbscript, vba

我正在检索特定列的所有值并将所有值存储在一个数组中，以便我可以使用这些值来应用自动过滤器。

```
rowcount=objExcel.Activeworkbook.Sheets(1).UsedRange.Rows.count

Dim a()
Redim Preserve a(rowcount)
'msgbox rowcount

'Storing all column values in an array'

for i=2 to rowcount
  a(i-2) = objSrcWorksheet.Cells(i,7).Value
Next

'Checking values of array'
for i=2 to rowcount
  msgbox a(i-2)

'Applying Autofilter'
 With objSrcWorksheet

.Range("G1").AutoFilter 2,"=a(i-2)"  'Problem is here'
'.Range("G1").AutoFilter 2,"=2"     'While hardcoded values are working'

 End With
Next 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:10:49.820

VBScript 不解析字符串中的变量。当您放入`a(i-2)`双引号时，它会变成文字字符串，而不是array`"a(i-2)"`的字段值。`i-2``a`

换成`.AutoFilter 2, "=a(i-2)"`，`.AutoFilter 2, "=" & a(i-2)`问题就会消失。

# facebook - Facebook - 通过 Graph API 将图像上传到粉丝页面，但未公开显示

> ID：14921361
> 
> 赞同：2
> 
> 时间：2013-02-17T13:03:44.177
> 
> 标签：facebook, facebook-graph-api, facebook-php-sdk, image-upload

在[本教程](http://www.webspeaks.in/2011/12/upload-photos-to-facebook-fan-page.html)之后，我使用图形 API 将一些图片上传到了我的粉丝页面相册（时间轴照片）。一切正常，但

用户、公众无法看到上传的图片。只有我 ( Page ) 可以看到图像。即使特定图像的权限已设置为“公共”。

任何想法 ？任何权限问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-26T06:47:33.620

此外，如果应用程序处于“沙盒”模式，则图像仅对管理员/开发人员/测试人员用户可见。公共用户将看不到图像

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T10:47:05.857

我遇到了同样的问题-看起来您需要用户的“manage_pages”和“publish_stream”权限-“manage_pages”本身可以让您上传照片，并返回成功，但任何人都看不到照片.

# c++ - C++11 最佳实践：何时按值接受 vs const&？

> ID：14921364
> 
> 赞同：2
> 
> 时间：2013-02-17T13:04:03.903
> 
> 标签：c++, c++11, copy, move

当您打算*存储*对象时，我对“按值接受”的“规则”感到满意，而当您只需要访问它时，通过 const 引用接受。这样，您（类的编写者）不会选择是复制类变量的用户还是移动它，他们会选择。但在使用过程中，我越来越不确定该建议是否合理。*move*在成本操作中不是统一的...

```
struct Thing
{
    std::array<int, 10000> m_BigArray;
};

class Doer
{
    public:
        Doer(Thing thing) : m_Thing(std::move(thing)) {}

    private:
        Thing m_Thing;
};

int main()
{
    Thing thing;
    Doer doer1(std::move(thing)); // user can decide to move 'thing'
    // or
    Doer doer2(thing); // user can decide to copy 'thing'
} 
```

在上面的示例中，移动与复制一样昂贵。因此，您最终会移动它（有效地复制它）两次，而不是获取一个 const 引用并复制一次对象。用户在您的论点中执行一次，您在您的成员中再次执行。

即使移动比复制便宜得多，这种情况也会进一步恶化（假设移动的成本低于某些未知成本，但比复制便宜）：

```
struct A
{
    A(Thing thing) : m_Thing(std::move(thing)) {}
    Thing m_Thing;
};

struct B : A
{
    B(Thing thing) : A(std::move(thing)) {}
};

struct C : B
{
    C(Thing thing) : B(std::move(thing)) {}
};

struct D : C
{
    D(Thing thing) : C(std::move(thing)) {}
}; 
```

在这里，您要么以 1 个副本和 4 个动作结束，要么以 5 个动作结束。如果所有构造函数都接受一个 const 引用，那么它只会是 1 个副本。现在我必须权衡什么是昂贵的移动，1 副本或 5 移动。

处理这些情况的最佳建议是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T17:26:38.700

> 处理这些情况的最佳建议是什么？

我最好的建议是做你正在做的事情：自己思考。不要相信你听到的一切。措施。

下面我获取了您的代码并使用打印语句对其进行了检测。我还添加了第三种情况：从纯右值初始化：

测试尝试两种方式：

1.  按值传递。
2.  通过`const&`and时重载`&&`：

代码：

```
#include <utility>
#include <iostream>

struct Thing
{
    Thing() = default;
    Thing(const Thing&) {std::cout << "Thing(const Thing&)\n";}
    Thing& operator=(const Thing&) {std::cout << "operator=(const Thing&)\n";
                                    return *this;}
    Thing(Thing&&) {std::cout << "Thing(Thing&&)\n";}
    Thing& operator=(Thing&&) {std::cout << "operator=(Thing&&)\n";
                                    return *this;}
};

class Doer
{
    public:
#if PROCESS == 1
        Doer(Thing thing) : m_Thing(std::move(thing)) {}
#elif PROCESS == 2
        Doer(const Thing& thing) : m_Thing(thing) {}
        Doer(Thing&& thing) : m_Thing(std::move(thing)) {}
#endif

    private:
        Thing m_Thing;
};

Thing
make_thing()
{
    return Thing();
}

int main()
{
    Thing thing;
    std::cout << "lvalue\n";
    Doer doer1(thing); // user can decide to copy 'thing'
    std::cout << "\nxvalue\n";
    Doer doer2(std::move(thing)); // user can decide to move 'thing'
    std::cout << "\nprvalue\n";
    Doer doer3(make_thing()); // user can decide to use factor function
} 
```

对我来说，当我使用 -DPROCESS=1 编译时，我得到：

```
lvalue
Thing(const Thing&)
Thing(Thing&&)

xvalue
Thing(Thing&&)
Thing(Thing&&)

prvalue
Thing(Thing&&) 
```

并使用 -DPROCESS=2：

```
lvalue
Thing(const Thing&)

xvalue
Thing(Thing&&)

prvalue
Thing(Thing&&) 
```

因此，对于 lvalue 和 xvalue 情况，按值传递比通过重载引用传递要花费额外的移动构造。正如您所指出的，搬家建设并不一定便宜。它可能与复制构造一样昂贵。从好的方面来说，您只需编写 1 个带值传递的重载。通过重载引用传递需要 2^N 重载，其中 N 是参数的数量。在 N==1 时相当可行，在 N==3 时变得笨拙。

此外，正如您所指出的，您的第二个例子只是您的第一个例子加剧了。

当性能是您最关心的问题时，尤其是当您不能指望廉价的移动构造函数时，请通过重载的右值引用传递。当您可以依靠便宜的移动构造，和/或您不想处理不合理的（您可以为自己定义不合理的）数量的重载时，请使用按值传递。没有一个答案在任何情况下都对每个人都是正确的。C++11 程序员仍然需要思考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:29:43.210

经常被引用的[想要速度？按值传递。](http://cpp-next.com/archive/2009/08/want-speed-pass-by-value/)给这个问题一个详细的处理：

> ...虽然编译器通常需要在函数参数按值传递时进行复制（因此对函数内部参数的修改不会影响调用者），但允许省略副本，只需使用源对象本身，当源是右值时。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T18:00:46.780

您没有将其作为选择，但我可以建议完美转发吗？

```
class Doer
{
public:
    template<typename T>
    Doer(T&& thing) : m_Thing(std::forward<T>(thing)) {}

private:
    Thing m_Thing;
}; 
```

这将导致左值/右值的单个复制/移动，这正是我们想要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T13:46:42.383

仅部分回答，但在您给出的第二个示例中，可以通过显式继承 A 的基本 ctor 来避免这些移动：

```
struct B : A
{
    using A::A;
};

struct C : B
{
    using A::A;
};

struct D : C
{
    using A::A;
}; 
```

在这里，您最终会得到 1 个副本对 1 个动作。

* * *

## 回答 #5

> 赞同：-6
> 
> 时间：2013-02-17T13:16:50.613

以下是一些可以解决问题的附加规则：

1.  永远不要从具体类派生。一个具体的、可实例化的类已经完全实现了。从它派生是对继承的不良使用。=> 你的构造函数参数成本消失了。
2.  根据数据是在当前对象内部还是外部，决定数据成员中的按值传递和按常量引用传递。
3.  *如果一个类中有构造函数参数，那么同*一个类中也应该有一个数据成员。将参数传递给基类不是一个好主意。
4.  忘记 std::move。复制数据的成本不够大。程序员在任何地方键入 std::move 所花费的时间比实践节省的执行时间要多。
5.  如果您不断地创建和销毁这些对象，那将比您使用 std::move 保存的任何时间花费更多的时间。

# javascript - 在 Dojo 中为 DIV 或 SPAN 的宽度设置动画

> ID：14921366
> 
> 赞同：0
> 
> 时间：2013-02-17T13:04:18.833
> 
> 标签：javascript, dojo

我试过这样做但没有成功*（所有这些东西在 jQuery 中都很容易。arrrrr !!!）*

我尝试了以下*（和各种排列）*但没有成功：

```
<body>
<span id="responseMsg" style="width:250px">Hi There</span>
</body> 
```

JS：

```
dojo.animateProperty({
    node: dojo.byId("responseMsg"), duration: 1000,
    properties: {
        backgroundColor: { start: "white", end: "#66CC00" }
    }
}).play();
dojo.animateProperty({
    node: dojo.byId("responseMsg"), duration: 1000,
    properties: {
        width: 0
    }
}).play(); 
```

[我在这里](http://jsfiddle.net/VfEye/)把它弄乱了，所以你可以明白我的意思。*（我猜 dojo 动画 css 属性而不是标签变量）*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:08:50.640

给你的跨度元素一个块级布局，它应该可以工作。

```
<span id="responseMsg" style="width:250px;display:block;">Hi There</span> 
```

顺便说一句，inline-css 很难维护。

您更新的小提琴：http: [//jsfiddle.net/VfEye/1/](http://jsfiddle.net/VfEye/1/)

# java - Hibernate：如何强制休眠为集合设置类型？

> ID：14921370
> 
> 赞同：4
> 
> 时间：2013-02-17T13:04:37.533
> 
> 标签：java, mysql, spring, hibernate

我对休眠问题感到很困惑，希望你能帮助我=）！

这是我的问题：

我有一个包含两个表的数据库，地址簿和联系人，在我的场景中，它们之间的关系是 1:n。

现在 Hibernate 在“AbstractAddressbook”类中生成以下代码，经过逆向工程：

```
private Set contacts = new HashSet(0); 
```

但我需要的是这样的：

```
private Set<Contact> contacts = new HashSet<Contact>(0); 
```

我怎样才能做到这一点，我必须在哪里为逆向工程设置它？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-03-23T14:25:12.523

在“休眠代码生成配置”中的导出器上选择“使用 Java 5 语法”

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-25T14:46:50.080

当您使用 MyEclipse 时，只需添加 MyEclipse 附带的 HibernateTemplate

我建议您按照本教程进行操作：

[http://www.myeclipseide.com/documentation/quickstarts/hibernate/](http://www.myeclipseide.com/documentation/quickstarts/hibernate/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T16:07:36.900

感谢您的澄清（我已经删除了这里的垃圾）。我不能说我对 Hibernate 逆向工程有任何经验。我建议使用 Eclipse JPA 工具 (eclipse.org) 并通过简单的 JDBC 连接从新的 JPA 项目“生成实体”。（那里有很多教程）。它在映射数据库方面做得很好，并且在推断正确的类型方面做得很好（您可能必须将 Set 更改为 List 或类似的小东西）。我在 4 天前针对一个中等复杂的数据库运行了这个，它做得很好。

除非你有一个奇怪的要求（比如它需要在纯 Hibernate XML 配置或其他东西中），否则 JPA 工具通常做得很好并且它们是免费的。（附注：JBoss 工具，一个 Eclipse 插件，也应该有 Hibernate 工具，并且可能会生成 xml 映射）。

# drupal - 用户之间的 Drupal 内容共享

> ID：14921371
> 
> 赞同：0
> 
> 时间：2013-02-17T13:04:41.807
> 
> 标签：drupal, reference

我正在创建一个网站，用户可以在其中与其他用户共享他们的内容，这样只有选定的用户才能看到您的内容。

事件内容类型有一个用户参考字段，用户可以在其中勾选要向其显示内容的所需用户。这是一个好的解决方案吗？问题是在尝试创建显示这些事件的视图时。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T17:07:02.497

是的，在 Drupal 中实现这一点的标准（好的）方法是使用[用户关系](http://dgo.to/user_relationships)模块。安装用户关系，以便用户可以与其他用户建立新的关系（例如，“朋友”、“可以看到我的一些东西”、“可以看到我所有的东西”等）

您需要创建一个自定义模块，通过在显示或列出内容之前检查是否存在所需的关系来扩展访问控制权限。这可以通过直接的过程逻辑来完成，但请注意您如何构建迭代循环，以便您的自定义代码随着您网站的用户增长而扩展。

或者，您可以使用[Flag Friend](http://dgo.to/flag_friend)模块，这是 UR 的一个更轻量级的替代方案，它允许您以与 UR 大致相同的方式定义用户之间的标志，但没有一些额外的复杂性。

最后，根据您的实际用户案例，您可能需要查看[OG](http://drupal.org/project/og)（有机组），它允许您创建可以在其组内共享内容的用户组。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:12:09.060

Drupal 的节点系统提供了一个 API 来实现细粒度的访问控制。该 API 通过实现[hook_node_grants()](http://api.drupal.org/api/drupal/modules!node!node.api.php/function/hook_node_grants/7)和[hook_node_access_record()](http://api.drupal.org/api/drupal/modules!node!node.api.php/function/hook_node_access_records/7)来使用。在您这样做之前，请查看[节点访问模块概述，](http://drupal.org/node/270000)看看是否有任何满足您的需求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T09:14:00.880

解决了这个问题，我不得不使用“实体引用”，而不是在共享字段中使用“用户引用”数据类型。然后将“实体引用”关系添加到所需的视图并过滤用户 = 当前用户。奇迹般有效。据我了解，实体引用有搜索字段，这样我就可以在该字段中搜索登录用户:)

# math - 假人的光线追踪

> ID：14921376
> 
> 赞同：0
> 
> 时间：2013-02-17T13:05:12.103
> 
> 标签：math, graphics, 3d, pixel, raytracing

这是一个困难的问题：我正在寻找关于光线追踪（Kd-trees，重心坐标）的巧妙解释/特别解释的书籍/教程/任何东西。

通过“巧妙地解释”，我的意思是那些看起来不像发表在 ieee 上的乳胶概念证明论文，但通过示例彻底解释了一个概念（如果书很大，则无关紧要）并且不假设读者是数学家，可能对任何事情都有疑问。

有人可以帮助我完成这个任务吗？可选地，可以链接与图形相关的数学资源和其他用于光线追踪的资源（如果相同的参数不属于一个类别）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:20:15.657

Matt Pharr 和 Greg Humpreys 的“基于物理的渲染，第二版”是全面的，尽管重点是路径跟踪而不是光线跟踪。该网站有 PBRT 的源代码，这是一个功能齐全的路径跟踪器。这本书比较高级。

Kevin Suffern 的“Ray Tracing from the Ground Up”是一个更温和的介绍，重点是光线追踪。后面的章节介绍路径追踪。这是一本比较适合初学者的书。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T16:02:05.657

[](http://books.google.com/books/about/An_Introduction_to_Ray_Tracing.html?id=YPblYyLqBM4C)*由 Andrew S. Glassner 编辑的[*An Introduction to Ray Tracing以单独的文章形式涵盖了光线追踪的许多核心主题。*](http://books.google.com/books/about/An_Introduction_to_Ray_Tracing.html?id=YPblYyLqBM4C)该组织使您可以轻松地跳过并专注于您想要的主题。*

# c# - 序列化异常：不需要数据合同

> ID：14921378
> 
> 赞同：1
> 
> 时间：2013-02-17T13:05:26.623
> 
> 标签：c#, serialization

在将对象序列化为 XML 时，我收到以下异常消息：

```
{"Type 'Alerter.EmailSender' with data contract name  'EmailSender:http://schemas.datacontract.org/2004/07/Alerter' is not expected. Consider using a DataContractResolver or add any types not known statically to the list of known types - for example, by using the KnownTypeAttribute attribute or by adding them to the list of known types passed to DataContractSerializer."} 
```

这是我试图将其对象序列化为 XML 文件的类：

```
namespace Alerter
{
  [DataContract]
  public class EmailSender : IAction
  {
    private EmailSetting _emailSetting;
    private SmtpClient _smtpClient;
    [DataMember]
    public bool IncludeFullDetails
    {
        get;
        set;
    }
    [DataMember]
    public string[] Receivers
    {
        get;
        set;
    }

    public EmailSender()
    {
        _emailSetting = new EmailSetting();
        SetupClient();
    }

    private void SetupClient()
    {
        // Some Logic
    }

    public void Report(LogDictionary logDictionary)
    {
       // Some Logic
    }
   }
 } 
```

这是我用于序列化的代码：

```
 using (FileStream writer = new FileStream(fileName, FileMode.Create))
        {
            DataContractSerializer ser =
                new DataContractSerializer(typeof(List<Rule>));
            ser.WriteObject(writer, list);
        } 
```

我感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:13:27.873

确保您已使用以下命令将此类指定`EmailSender`为序列化程序的已知类型[`proper constructor`](http://msdn.microsoft.com/en-us/library/aa344259.aspx)：

```
DataContractSerializer ser = new DataContractSerializer(
    typeof(List<Rule>), 
    new[] { typeof(EmailSender) }
);
ser.WriteObject(writer, list); 
```

你需要这个的原因是因为可能在`Rule`类的对象图中你只使用了`IAction`所有成员的接口，而序列化器甚至不知道`EmailSender`实现的存在。

`Rule`您应该对对象图中静态未知的所有其他类型执行相同的操作。

# java - 定点数的 DecimalFormat 和舍入

> ID：14921379
> 
> 赞同：1
> 
> 时间：2013-02-17T13:05:28.547
> 
> 标签：java, precision, floating-accuracy, decimalformat

在使用 时[`DecimalFormat`](http://docs.oracle.com/javase/7/docs/api/java/text/DecimalFormat.html)，我对它在使用定点模式舍入数字时的行为感到困惑。为了使事情更具体：

```
double n = 2082809.080589735D;

// Output the exact value of n
System.out.println("value:       " + new BigDecimal(n).toPlainString());

System.out.println("double:      " + n);

DecimalFormat format = new DecimalFormat("0.00000000");

System.out.println("format:      " + format.format(n));
System.out.println("format (BD): " + format.format(new BigDecimal(n))); 
```

此代码段的输出是：

```
value:       2082809.080589734949171543121337890625
double:      2082809.080589735
format:      2082809.08058974
format (BD): 2082809.08058973 
```

从第一行输出中，我们注意到实际值*低于*`2082809.08058973`和`2082809.08058974`( `...49...`)之间的中点。尽管如此，`DecimalFormat`在提供`double`参数时将值向上舍入。

其他值向下舍入：

```
value:       261285.2738465850125066936016082763671875
double:      261285.273846585
format:      261285.27384658
format (BD): 261285.27384659 
```

这并非在所有情况下都会发生：

```
value:       0.080589734949171543121337890625
double:      0.08058973494917154
format:      0.08058973
format (BD): 0.08058973

value:       0.2738465850125066936016082763671875
double:      0.2738465850125067
format:      0.27384659
format (BD): 0.27384659 
```

在我看来，a 的格式化字符串`double`是使用[半偶数舍入舍入](http://en.wikipedia.org/wiki/Rounding#Round_half_to_even)的，该舍入基于一个不精确的十进制值，该十进制值是由 的行产生的`Double.toString()`，而不是所讨论的实际数学值`double`。当格式化的精度非常接近（或超过）`double`类型提供的精度时，事情开始变得有些随机。

在上面介绍的所有情况下，格式化相应的`BigDecimal`似乎可以按预期执行舍入。

`DecimalFormat`在这种情况下，我找不到任何描述正确行为的规范。

*   这种行为是否记录在某处？

*   从正确性的角度来看，将实际数学值四舍五入不是更可取吗？

    我知道写作的人`1.0...35`会（天真地？）期望它被四舍五入`1.0...4`，但`1.0...35`甚至可能无法用 Java 中可用的任何原始数据类型表示......

**编辑：**

我已经向 Oracle 提交了一份报告——希望他们能够解决或澄清这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-18T22:39:08.050

这显然是已[在 Java 8 中修复的](http://www.oracle.com/technetwork/java/javase/8-compatibility-guide-2156366.html#A999387)[已知问题](http://bugs.java.com/bugdatabase/view_bug.do?bug_id=7131459)。

`DecimalFormat`在 Java 8 中，无论开发人员选择何种格式，都应该始终正确执行舍入。自然，与 Java 7 相比，这会导致稍微不兼容的行为——这是否重要取决于每个应用程序的具体情况。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:15:13.660

根据[Java Language Specification](http://docs.oracle.com/javase/specs/jls/se7/html/jls-4.html)，java 使用 IEEE 754 - 1985，而你（来自假设 IEEE754 - 2008 的评论）

> 浮点类型为 float 和 double，它们在概念上与 IEEE 二进制浮点算术标准、ANSI/IEEE 中指定的单精度 32 位和双精度 64 位格式 IEEE 754 值和运算相关联标准 754-1985（IEEE，纽约）。

用于指定舍入行为`setRoundingMode()`。`DecimalFormat`

> 这种行为是否记录在某处？

[请参阅DecimalFormat](http://docs.oracle.com/javase/6/docs/api/java/text/DecimalFormat.html)的javadoc以及[RoundingMode](http://docs.oracle.com/javase/6/docs/api/java/math/RoundingMode.html) 和[IEEE 754 - 1985](http://en.wikipedia.org/wiki/IEEE_floating_point)和 JLS 中的详细信息（此答案中的第一个声明）

默认情况下，如文档所述，是半偶数舍入模式。半偶数

```
public static final RoundingMode HALF_EVEN 
```

> 舍入模式向“最近的邻居”舍入，除非两个邻居是等距的，在这种情况下，向偶数邻居舍入。如果丢弃的分数左边的数字是奇数，则表现与 RoundingMode.HALF_UP 相同；如果是偶数，其行为与 RoundingMode.HALF_DOWN 相同。请注意，这是一种舍入模式，当在一系列计算中重复应用时，可在统计上最小化累积误差。它有时被称为“银行家四舍五入”，主要用于美国。这种舍入模式类似于 Java 中用于 float 和 double 算术的舍入策略。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-18T15:56:16.080

看起来这可能是由于双舍入造成的。

标记为“double”的输出看起来正确四舍五入为 16 位。标记为“格式”的输出看起来像是从 16 位值四舍五入（四舍五入到偶数）。

（我需要查看更多示例来验证这一点。）

# iphone - UIPageViewController 背面视图

> ID：14921381
> 
> 赞同：2
> 
> 时间：2013-02-17T13:05:34.853
> 
> 标签：iphone, objective-c, uipageviewcontroller

我在我的应用程序中设置了一个工作 UIPageviewcontroller。我想自定义用户翻页时显示的页面背面。现在的默认行为是以 40% 左右显示前视图。是否可以以背面是我指定的视图的方式进行设置？

编辑：也许我应该澄清一下，我希望视图的背面始终是相同的视图。例如纯红色。同样的问题已经在这里问过[如何将阴影背景白色更改为其他颜色](https://stackoverflow.com/questions/12381773/uipageviewcontroller-how-to-change-shadow-background-white-to-other-colors-i)

这是我在脊椎位置方法中使用的代码。在我阅读的 setViewControllers 方法的评论中：

`For transition style 'UIPageViewControllerTransitionStylePageCurl', if 'doubleSided' is 'YES' and the spine location is not 'UIPageViewControllerSpineLocationMid', two view controllers must be included, as the latter view controller is used as the back.`

所以如果我这样做：

```
-(UIPageViewControllerSpineLocation)pageViewController:
(UIPageViewController *)pageViewController spineLocationForInterfaceOrientation    (UIInterfaceOrientation)orientation
{
    UIViewController *currentViewController = self.pageViewController.viewControllers[0];
    UIViewController *backsideViewController = [[BackSideViewController alloc]init];
    self.pageViewController.doubleSided = YES;
    NSArray *viewControllers = @[currentViewController,backsideViewController];
    [self.pageViewController setViewControllers:viewControllers     direction:UIPageViewControllerNavigationDirectionReverse animated:YES completion:NULL];
    return UIPageViewControllerSpineLocationMax;
} 
```

我得到错误： `The number of provided view controllers (2) doesn't match the number required (1) for the requested spine location (UIPageViewControllerSpineLocationMax)`

# c# - 从查询中返回最大值

> ID：14921382
> 
> 赞同：2
> 
> 时间：2013-02-17T13:05:36.580
> 
> 标签：c#, .net, sql, linq

我想找出哪个员工的订单最多：这段代码带来了所有用户的所有订单数：

```
 public void GetBestEmployeeFromDates(DateTime fromDate, DateTime toDate)
    {
        using (NorthwindDataContext db = new NorthwindDataContext())
        {
            var query =
                from z in db.Employees
                select new
                {
                    OrderNumber = z.Orders.Where(x => x.OrderDate > fromDate.Date).Count()
                };

        }

    } 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:08:19.260

尝试使用`MaxBy`（[http://code.google.com/p/morelinq/](http://code.google.com/p/morelinq/)）：

```
var maxOrders = query.MaxBy(o => o.OrderNumbers); 
```

您还可以调整查询以包含客户名称：

```
var query =
            from z in db.Employees
            select new
            {   
                Customer = z.CustomerName,
                OrderNumber = z.Orders.Where(x => x.OrderDate > fromDate.Date).Count()
            };

var person = query.OrderByDescending(o => o.OrderNumber).Select(c=>c.Customer).First();

Console.WriteLine("The customer with the most orders is: " + person); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T13:18:40.050

我在想这样的事情：

```
using (NorthwindDataContext db = new NorthwindDataContext())
{
 var query =
   (from z in db.Employees
   select new
   {
      OrderNumber = z.Orders.Where(x => x.OrderDate > fromDate.Date).Count(),
      Employee = z
   }).OrderByDescending(x => OrderNumber).Select(x => x.Employee).FirstOrDefault()
} 
```

# ios - 带有详细描述的图片库

> ID：14921383
> 
> 赞同：-1
> 
> 时间：2013-02-17T13:05:47.327
> 
> 标签：ios, uiwebview, uiscrollview, image-gallery

我尝试创建图片库，其中画廊将有很长的描述，如下图所示。

![在此处输入图像描述](../Images/697aed76318c9de32019cda37af2f305.png)

问题是因为`UIWebView`可以是任何高度（取决于文本高度）。所以我添加`UIScrollView`所以如果描述高于页面，我可以滚动。那么如何设置高度`UIWebView`以及如何放置`UIView`（带有图像）将始终位于`UIWebView`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:14:59.380

也许尝试从情节提要界面生成器中为您的画廊设置 UIWebView 和 UIView 的大小。拖放并将每个调整到您想要的高度。

假设您有一个名为 GalleryView 的 UIView 子类，并且您的 IBOutlets 如下所示：

```
@property (weak, nonatomic) IBOutlet UIWebView *webView;
@property (weak, nonatomic) IBOutlet GalleryView *galleryView; 
```

加载您的网页

```
- (void)viewDidLoad
{
[super viewDidLoad];
self.webView.scalesPageToFit = YES; //NO is the default. 
[self.webView loadRequest:[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://google.com"]]];
} 
```

您会看到 UIWebView 是可滚动的，因此无需将其嵌入到滚动视图中。

此外，UIWebView 参考中有一条警告：“您不应该在 UIScrollView 对象中嵌入 UIWebView 或 UITableView 对象。如果这样做，可能会导致意外行为，因为这两个对象的触摸事件可能会混淆并错误处理。” 所以，就是这样。

# android - Android Camera FC（未知方法）

> ID：14921386
> 
> 赞同：1
> 
> 时间：2013-02-17T13:06:02.200
> 
> 标签：android, camera, forceclose, methodnotfound

我使用的是三星 Fascinate，构建版本是 4.2.1 AOSP（CM10.1 Nightly）。

相机太差了，所以我换了它。新相机 FC 在启动时，我拉了一个 log-cat 并获得了堆栈跟踪：

```
E/AndroidRuntime( 1814): FATAL EXCEPTION: Thread-175 
E/AndroidRuntime( 1814): java.lang.NoSuchMethodError: **android.hardware.Camera$Parameters.setCameraMode** E/AndroidRuntime( 1814):     at com.android.camera.Camera.updateCameraParametersPreference(Camera.java:2249) 
E/AndroidRuntime( 1814): at com.android.camera.Camera.setCameraParameters(Camera.java:2339) 
E/AndroidRuntime( 1814):    at com.android.camera.Camera.startPreview(Camera.java:2083) 
E/AndroidRuntime( 1814):    at com.android.camera.Camera.access$3700(Camera.java:86) 
E/AndroidRuntime( 1814):    at com.android.camera.Camera$5.run(Camera.java:1255) 
E/AndroidRuntime( 1814):    at java.lang.Thread.run(Thread.java:856) 
```

我对此没意见，但有一件事：这不是在开玩笑，没有这样的方法......我在任何地方都找不到关于那个愚蠢方法（**setCameraMode()**）的任何文档。到底是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T23:26:12.253

该方法在早期版本的 JB 上可用（我认为是 android-4.1.1_r1 AOSP）。看看： [https ://github.com/CyanogenMod/android_frameworks_base/blob/jellybean/core/java/android/hardware/Camera.java](https://github.com/CyanogenMod/android_frameworks_base/blob/jellybean/core/java/android/hardware/Camera.java)

因此，请使用库存相机或从 Play 商店安装其他相机。

# android - 无法在我的平板电脑上安装 OEM USB 驱动程序

> ID：14921387
> 
> 赞同：0
> 
> 时间：2013-02-17T13:06:05.597
> 
> 标签：android, eclipse, debugging

我正在尝试在我的 Windows 7 上安装驱动程序，以便可以直接在我的 Android 手机上从 Eclipse 调试我的应用程序。我已按照此处给出的说明[http://developer.android.com/tools/extras/oem-usb.html](http://developer.android.com/tools/extras/oem-usb.html)（适用于 Windows 7），但是当我点击搜索时，它告诉我 Windows 无法在该位置找到驱动程序. 到目前为止，我已经尝试重新安装所有内容，在 SDK Manager 上安装所有可能的包。如果相关的话，我的 Android 是 4.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:27:26.853

多年来，我一直在使用不同的手机在 eclipse 下调试应用程序，但我不必安装任何 USB 驱动程序。Windows 自动识别了手机并安装了相应的 USB 驱动程序。我知道文档告诉您需要手动安装 OEM 驱动程序，但根据我的经验，没有必要这样做。

# git - 删除早于指定日期的提交的脚本

> ID：14921388
> 
> 赞同：3
> 
> 时间：2013-02-17T13:06:08.183
> 
> 标签：git, bash

如何删除超过 X 天的提交？

我想这样做的原因是 repo 变得非常大，过滤和 gc 不再有帮助，而且我们不再需要超过 5 年的提交。只有 4 名开发人员使用此 repo。

有没有可以自动执行此操作的脚本？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:03:23.593

我想到了两个选择：

*   通过使用参数克隆原始存储库来创建一个新存储库`--depth=N`；这将创建一个新的历史记录，仅保留历史记录中的`N`最后一次提交。然后，所有开发人员都将切换到这个新的存储库。

    要找出`N`必须是什么，您可以使用以下内容

    ```
    git log --format=oneline HEAD@{5 years ago} | wc -l 
    ```

    但是，这将重写您的所有提交 SHA1。

*   为了保留您的 SHA1，您将使用`git replace`，将历史记录分成两部分，[遵循此博客文章](http://git-scm.com/2010/03/17/replace.html)。

# c++ - c++ 结构中的运行时大小的数组

> ID：14921390
> 
> 赞同：0
> 
> 时间：2013-02-17T13:06:22.947
> 
> 标签：c++, arrays, struct, g++, flexible-array-member

在 C（使用 gcc）中，我曾经有一些数据结构是一个包含一些额外信息的数组：

```
struct song {
    uint tempo;
    uint key;
    note play[0]; // or play[] depending on compiler flavour
}; 
```

Iirc，这被称为“灵活数组”（[http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html#Zero-Length](http://gcc.gnu.org/onlinedocs/gcc/Zero-Length.html#Zero-Length)`malloc(sizeof(song)+N*sizeof(note))` ），然后我可以在运行时分配一首包含 N 个音符的歌曲。如果我这次不打算使用向量，也不打算在中引入无用的`note*`指针，那么 g++ 支持到什么程度`song`？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T13:21:11.533

[即使在 C 中，这是 undefined 和 non-portable](https://stackoverflow.com/questions/3711233/is-the-struct-hack-technically-undefined-behavior)。GCC 故意让您摆脱它，但其他实现可能不会。这是因为您正在访问超出其边界的数组。

[这个“技巧”在 C++ 中与在 C 中一样有效](https://stackoverflow.com/questions/9573748/variable-length-struct-nonstandard-in-c11?lq=1)。也就是说，可以随意在 GCC 文档中说它受支持的 GCC 中使用它，但它永远不会是“定义明确的、有效的 C++”。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-17T13:13:00.447

除了使用固定长度或音符*之外别无他法，因为编译器必须知道您的歌曲结构有多长，并且每个结构都具有相同的长度。

所以你必须使用注释*或矢量

# mysql - Timestamp vs datetime vs int - 有和没有索引 - 测试

> ID：14921391
> 
> 赞同：3
> 
> 时间：2013-02-17T13:06:23.633
> 
> 标签：mysql, performance, datetime, timestamp

就我而言，我只会测试哪种日期时间格式最适合我的查询持续时间。这是我的查询：

```
 SELECT 
    max(ColumnA), -- bigint
    CreateDate, 
    ColumnB, 
    EndTime, 
    ColumnC, 
    ColumnD, 
    ColumnE, 
    ColumnF, -- int
    StartTime, -- timestamp or datetime or int - UNIX_TIMESTAMP(StartTime)
    ColumnG, 
    ColumnH, 
    ColumnI, 
    ColumnJ, 
    UpdateDate, 
    ColumnK FROM TABLE 
```

条件：

```
-- with indexes
  (Iteration 1) WHERE StartTime BETWEEN "2013-01-18 16:50:00" AND "2013-10-18 18:05:00" AND ColumnF in(5428) GROUP BY ColumnF,StartTime
  (Iteration 2) WHERE StartTime BETWEEN "2013-05-18 11:00:00" AND "2013-06-23 22:05:00" AND ColumnF in(5428) GROUP BY ColumnF,StartTime
  (Iteration 3) WHERE StartTime BETWEEN "2013-08-18 11:00:00" AND "2013-08-23 22:05:00" AND ColumnF in(7752) GROUP BY ColumnF,StartTime
  (Iteration 4) WHERE StartTime BETWEEN "2013-01-18 16:50:00" AND "2013-10-18 18:05:00" AND ColumnF in(5428,5675,444) GROUP BY ColumnF,StartTime
  (Iteration 5) WHERE StartTime BETWEEN "2013-09-01 16:50:00" AND "2013-09-15 18:05:00" AND ColumnF in(5428,5675,444) GROUP BY ColumnF,StartTime
-- and same without indexes 
```

测试信息：

```
Count = 400K
Engine version = 5.6.10
DBEngine = InnoDB
Tests procedure - MySQL restart before any query. 
```

结果：

```
With index on StartTime, with index on ColumnF                      

    Iteration   1      2       3       4       5
timestamp   0.094   0.094   0.124   0.124   0.125
datetime    0.125   0.109   0.141   0.156   0.156
int         0.125   0.124   0.094   0.156   0.156
Rows            38     8       1       128  8

Without index on StartTime, with index on ColumnF                   
    Iteration   1      2       3       4      5
timestamp   0.078   0.062   0.062   0.109   0.125
datetime    0.078   0.078   0.078   0.140   0.125
int         0.078   0.078   0.078   0.140   0.125
Rows            38     8       1       128      8 
```

所以我决定使用没有索引的时间戳（但没有索引的结果看起来非常相似）。

编辑：我真的不知道为什么我决定只使用一个查询。也许是懒惰，也许我不应该在星期天工作:) 现在测试无关紧要，结论是错误的。当我进行测试时，我会重写所有测试信息......通常:)

EDIT2：固定

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:12:25.070

有一天，我问了一个关于[我们何时选择 Datetime 而不是 Timestamp](https://stackoverflow.com/questions/12617347/when-do-we-chose-datetime-over-timestamp)的问题。我认为你不会用整数时间戳赢得很多时间。 ~~另外，请记住`TIMESTAMP`and`DATETIME`是 MySQL 中的别名，~~如果您使用 PostgreSQL，您将只有`TIMESTAMP`. 所以在这里，你的测试似乎无关紧要。

**编辑**：它们*不是*等效的。它们只是以相同的方式格式化。事实上`Timestamp`，它只是一种时区不敏感类型。它让你摆脱这件事。但它会使您的自定义减少，并且限制在 1970 年到 2038 年。如果您有其他日期要存储（更早或更晚），您将失败。

有两件事让我这么说：

*   两次迭代
*   没有色散度量
*   您正在测试的所有内容几乎没有区别

`INT`和之间的最大区别在于`TIMESTAMP`内存中的位置。你不测试它。观察到的时间跨度真的很短。

我想你猜我完全赞成 DateTime 而不是整数。

# c++ - 关于 GLM 网格中的碰撞检测

> ID：14921392
> 
> 赞同：0
> 
> 时间：2013-02-17T13:06:41.913
> 
> 标签：c++, opengl

我是opengl和glm的新手，目前我正在做一个类项目，我上传了两个对象汽车如下

```
void CARMODEL:: drawmodel_box()
{
    glPushMatrix();
    glTranslatef(carx,cary ,carz);
    if (!pmodel1){
        pmodel1 = glmReadOBJ("Car.obj");
    }

    glmDraw(pmodel1, GLM_SMOOTH | GLM_TEXTURE | GLM_MATERIAL);
    glPopMatrix();
}

void OpponentCarModel::drawopponentmodel()
{
    glPushMatrix();
    srand(time(NULL));
    opcarx=rand() % 7-3+(double)rand()/(RAND_MAX+1)*(1-0)+0;

    glTranslatef(opcarx,0,-20);

    if (!pmodel2){
        pmodel2 = glmReadOBJ("car.obj");
    }

    glmDraw(pmodel2, GLM_SMOOTH | GLM_TEXTURE | GLM_MATERIAL);
    glPopMatrix();
} 
```

现在，到目前为止一切都很好，现在我来到碰撞检测部分，我不知道如何在两辆车之间进行，因为我不知道它们的坐标或顶点，所以请帮忙..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:48:34.550

是的，但是您可以确切地知道模型在矩阵中的放置位置，因为您之前调用`glTranslatef()`过`glmDraw()`将它们放置在那里。现在，由于您知道模型的*x、y、z*坐标，您可以开始检查简单的碰撞。

但是，如果您正在寻找更真实/更复杂的碰撞检测，您应该打开`glm.h`并检查`GLMmodel`结构的定义，因为它存储了在屏幕上绘制模型所需的所有内容，包括顶点信息、法线、纹理坐标等：

```
/* GLMmodel: Structure that defines a model.
 */
typedef struct _GLMmodel {
  char*    pathname;            /* path to this model */
  char*    mtllibname;          /* name of the material library */

  GLuint   numvertices;         /* number of vertices in model */
  GLfloat* vertices;            /* array of vertices  */

  GLuint   numnormals;          /* number of normals in model */
  GLfloat* normals;             /* array of normals */

  GLuint   numtexcoords;        /* number of texcoords in model */
  GLfloat* texcoords;           /* array of texture coordinates */

  GLuint   numfacetnorms;       /* number of facetnorms in model */
  GLfloat* facetnorms;          /* array of facetnorms */

  GLuint       numtriangles;    /* number of triangles in model */
  GLMtriangle* triangles;       /* array of triangles */

  GLuint       nummaterials;    /* number of materials in model */
  GLMmaterial* materials;       /* array of materials */

  GLuint       numgroups;       /* number of groups in model */
  GLMgroup*    groups;          /* linked list of groups */

  GLfloat position[3];          /* position of the model */

} GLMmodel; 
```

# objective-c - NSPointerArray 中的二维数组

> ID：14921395
> 
> 赞同：1
> 
> 时间：2013-02-17T13:06:58.903
> 
> 标签：objective-c, multidimensional-array, calloc

我正在创建许多 2D int 和 float C 数组，并将它们的指针分配给 NSPointerArray。当我创建并用数据填充它们时一切都很好，但是当我在数组上添加指针时，我得到 EXEC_BAD_ACCESS。Q1-为什么这是错误的？Q2-提供对使用 calloc 创建的许多 2D 数组的访问的最佳方法是什么？

```
- (NSPointerArray *)treeData{
   if (_treeData == nil) {
      _treeData = [[NSPointerArray alloc] init];
      int** VVD = createIntArray(3000,200); 
      [_treeData addPointer:VVD];
   }
  return _treeData; // addеd later to the post, exists in live code
} 
```

以供参考

```
int** createIntArray(int n, int m)
{    
  int i=0;
   int* values = calloc(m*n, sizeof(int));
   int** rows = malloc(n*sizeof(int*));
   for ( i=0; i<n; ++i)
   {
       rows[i] = values + i*m;
   }
   return rows; 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:35:06.887

NSPointerArray 必须使用正确的选项进行初始化。默认情况下，他尝试保留传递的指针，并且由于 int** 不是 NSObject，它会崩溃。**相反，您必须告诉数组不要触摸您添加的内存！使用不透明内存选项初始化它**

你只调用了 init 等于`initWithOptions: NSPointerFunctionsStrongMemory`
你有调用`initWithOptions:NSPointerFunctionsOpaqueMemory`

```
#import <Foundation/Foundation.h>

int** createIntArray(int n, int m)
{
    int i=0;
    int* values = calloc(m*n, sizeof(int));
    int** rows = malloc(n*sizeof(int*));
    for ( i=0; i<n; ++i)
    {
        rows[i] = values + i*m;
    }
    return rows;
}

int main(int argc, char *argv[]) {
    @autoreleasepool {
        id _treeData = [[NSPointerArray alloc] initWithOptions:NSPointerFunctionsOpaqueMemory];
        int** VVD = createIntArray(3000,200);
        [_treeData addPointer:VVD];
    }

    NSLog(@"EOF");
} 
```

# wpf - WPF 绑定：绑定到 DataContext 的父级

> ID：14921396
> 
> 赞同：3
> 
> 时间：2013-02-17T13:07:03.177
> 
> 标签：wpf, mvvm, binding, viewmodel

好的。它是 WPF，我正在尝试将我的窗口绑定到我的 ViewModel。虚拟机如下所示：

```
public class VM
{
    public SalesRecord SR {get; set;} 
    public List<string> AllSalesTypes {get; set;}
}

public class SalesRecord
{
    public int ID {get; set;} 
    public DateTime Date {get; set;}
} 
```

这是我的 XAML：

```
...
<TextBox Text="{Binding Path=ID, Mode=TwoWay}"  />
<TextBox Text="{Binding Path=Date, Mode=TwoWay}"  />
<ComboBox ItemsSource="{Binding AllSalesTypes}" Text="{Binding Path=SalesType, Mode=TwoWay}" />
... 
```

我`VM`在运行时将数据上下文设置为对象，如下所示：

```
this.DataContext = _vm.SR; 
```

现在绑定表达式适用于所有`TextBoxes`指向`SR`对象属性的 my （例如`ID`和`Date`），但是`ComboBox`需要显示所有 SalesTypes 列表的绑定表达式不起作用，显然是因为`AllSalesTypes`它是`VM`类的成员。

我的问题是：有没有办法编写一个绑定表达式来查看当前的父级`DataContext`而不是自身？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:44:41.803

我不知道您可以使用 Binding 来获取 DataContext 的父级。
就像你有一个类`A`，它有一个名为的属性`MyProperty`，你写：

```
 object o = MyAInstance.MyProperty; 
```

您无法`MyAInstance`从`o`.

您的选择是使用：`this.DataContext = _vm`并访问如下属性：

```
 <TextBox Text="{Binding SR.ID}" /> 
```

或者添加一个`Parent`属性`SalesRecord`并手动将其设置为指向虚拟机，然后这样的事情就会起作用：

```
 <TextBox Text="{Binding ID}" />
 <ComboBox ItemsSource="{Binding Parent.AllSalesTypes}" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:44:28.097

您最好将视图模型（数据上下文）设为视图模型（因此得名）并将文本框绑定更改为：

```
<TextBox Text="{Binding SR.ID}" />
<TextBox Text="{Binding SR.Date}" /> 
```

如果您使用 MVVM，我也强烈建议您使用 MVVM 框架。你真的应该`INotifyPropertyChanged`在你的视图模型类型上实现——MVVM 框架提供了一个实现。

# sql - 使用 MAX 函数

> ID：14921399
> 
> 赞同：0
> 
> 时间：2013-02-17T13:07:16.193
> 
> 标签：sql, oracle

下面的语句给我错误
SQL 错误：**ORA-00934**：此处不允许使用组函数
有谁知道如何解决这个错误？

```
update revisit set visitcounter=1234 where  visittimestamp=MAX(visittimestamp) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:09:27.377

尝试：

```
update revisit set visitcounter=1234 where  visittimestamp = (select MAX(visittimestamp) from revisit) 
```

# c++ - 代理项目中的慢速套接字读取（）

> ID：14921400
> 
> 赞同：1
> 
> 时间：2013-02-17T13:07:23.477
> 
> 标签：c++, sockets

我正在为一个学校项目编写一个 http 1.0 网络代理。我已经完成了所有工作，但我的`read()`通话速度很慢。我在呼叫周围放置了一个计时器`read()`（来自 C 的 stdlib 的那个）。我看到一堆 0 读取，然后是一个需要 5-20 秒的读取。这是在简单的高速网站（谷歌、debian 等）上。在杂乱的网站上，事情会超时并且页面永远不会加载（cnn、yahoo 等）。

我正在从请求`Host:`行打开一个到服务器的套接字，并从代理浏览器（在本例中为 firefox）写入确切的 GET 请求。写入需要 0。这是一个示例请求（哈希用于可视化）。

```
#########
GET http://debian.org/ HTTP/1.0
Host: debian.org
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.8; rv:18.0) Gecko/20100101 Firefox/18.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Connection: keep-alive

######### 
```

（包括最后的两`\r\n`行。）我读错了吗？还是我提出了错误的要求？在 chrome 中加载页面，甚至在 telnet 中使用 GET 请求都非常快。

这是读取的代码。“实际读取时间”输出通常类似于 0、0、...、0、15。

```
boost::shared_ptr<std::string> SocketBase::read(bool toEof) const
{
  if (!this->isConnected())
  {
    Exceptions::raise<std::runtime_error>(__FILE__, __LINE__, "Socket is not connected.");
  }

  boost::shared_ptr<std::string> bytes = boost::shared_ptr<std::string>(new std::string());
  while (toEof || bytes->rfind(CRLFCRLF) == std::string::npos)
  {
    char buffer[BufferSize];
    time_t before = ::time(0);
    int rc = ::read(this->socket, buffer, BufferSize);
    time_t after = ::time(0);
    std::cerr << "Actual read time: " << after - before << "s." << std::endl;

    if (rc == 0)
    {
      break;
    }
    else if (rc < 0)
    {
      Exceptions::raise<Exceptions::ReadException>(__FILE__, __LINE__, ::strerror(errno));
    }
    else
    {
      bytes->append(buffer, buffer + rc);
    }
  }

  return bytes;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:36:36.500

您正在使用“Connection: keep-alive”行，它告诉服务器您希望在同一连接上可能有多个请求。服务器将发送响应并坐在那里空闲等待进一步的请求。如果它没有得到一个，它最终会关闭连接。这可能是您看到的行为。如果您希望服务器在处理请求后关闭连接，请通过“连接：关闭”要求它这样做。对于保持活动连接（和更高的性能），您确实应该使用 HTTP/1.1 并使用 Content-Length 标头...

# ajax - 视图MVC3中强类型实体的多个实例

> ID：14921403
> 
> 赞同：1
> 
> 时间：2013-02-17T13:07:36.800
> 
> 标签：ajax, asp.net-mvc, asp.net-mvc-3, jquery

我对 MVC 很陌生，所以这可能是一个非常新手的问题。我正在玩产品目录。我有一个要以表格格式（表格或 div）显示的产品列表。每行将显示一个产品信息，并有两个链接“编辑和删除”。我想使用 Jquery Ajax 向我的控制器提交请求。对于编辑，我想显示一个模式对话框。为了删除，我想从目录中删除产品。每一项操作都将在完成后更新网格。

* * *

这是一些伪代码：

模型：

```
 public class ProductModel
    {
        public string Name { get; set; }
        public string Description { get; set; }
        public int Id { get; set; }
        public bool IsReadOnly { get; set; }
    } 
```

控制器：

```
public class ProductController : Controller
    {
        //
        // GET: /Product/

        public ActionResult Edit(ProductModel product)
        {

        }

        public ActionResult Delete(ProductModel product)
        {

        }

    } 
```

编辑视图：

```
@model Generic.Controller.Models.ProductModel

if Model.IsReadOnly
    Render display editor
else
    Render editor 
```

列表显示：

```
@model Generic.Controller.Models.ProductModel

@using (Html.BeginForm())
{
    //for each model item
    <div class="some-css">
        <div class="column-div">
            //display the model
        </div>

        <div class="column-div">
            //display the edit link   
        </div>

        <div class="column-div">
            //display the delete link   
        </div>
    </div>
} 
```

替代列表视图 - 从列表视图呈现的部分视图

//对于每个模型：

```
@using (Html.BeginForm())  //id this form with the product id?
{
    //for each model item
    <div class="some-css">
        <div class="column-div">
            //display the model
        </div>

        <div class="column-div">
            //display the edit link   
        </div>

        <div class="column-div">
            //display the delete link   
        </div>
    </div>
} 
```

这是一些骨架Javascript：

> ```
> var open = function (methodName, url) {        
>     $("#dialogDiv").dialog({
>        buttons: {
>             Save: function () {
>                 var form = $(options.formToPost);
>                 $.ajax({
>                     type: "POST", 
> ```

**这里有什么？通常我可以：**

```
 url: form.attr('action'),
               data: form.serialize() 
```

**但这是否意味着每个实体都有一个表格？**

```
success: function (data, status, xhr) {
                    if (data.IsValid) {
                        //how do I identify the div I need to update?
                    } else {

                    }
                }
            });
        },

        Cancel: function () {
            $("#dialogDiv").dialog('close');
            $("#dialogDiv").empty();
        }
    }
});
$.ajax(
    {
        Type: methodName,
        url: url,
        success: function (data, status, xhr) {
            openDialog(data);
        }
    });

function openDialog(data) {
    $("#dialogDiv").html(data);
    $("#dialogDiv").dialog('open');
}
};

return {
    open: open
}; 
```

以下是我的问题：

1.  现在我唯一知道如何轻松发布的是表格。为了向我的控制器发布 ajax 请求，我是否必须有多个表单（每个产品 1 个）？
2.  如果我使用 JQuery 找到与单击的链接最近的 div 并将其发送到控制器，模型绑定器会自动将 div 的内容绑定到我的 ProductModel 吗？
3.  编辑或删除产品后更新视图的最佳方式是什么？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:23:11.780

*   使用 [HttpPost] 装饰您的控制器操作以进行编辑和删除，以防止 GET 请求被编辑/删除。
*   如果您使用模态框编辑行，则**每个呈现的模态框都需要是一个表单**，以便将值发布到控制器操作。
*   每次编辑或删除后执行 return RedirectToAction("NameOfListMethod") 并且列表将被更新。

如果你想用 jQuery 处理所有事情，它会变得有点棘手，因为你需要能够在客户端更新表。

# java - 如果类型是原始类型或类型是对象，则检查反射

> ID：14921406
> 
> 赞同：4
> 
> 时间：2013-02-17T13:07:44.057
> 
> 标签：java, reflection, primitive-types, generic-programming

我使用以下代码在反射中查找原始和某些对象的类成员，我的问题是有一种方法可以识别字段是否为原始类型、对象、类引用，因为我想根据类型调用特定的方法。例如，如果字段是对 handlePrimitive 的原始调用，如果字段类型为其他类型引用（在下面的示例中 SalesOrderItemPK primaryKey; ）调用方法 handleClassReference 等

只是为了了解我需要获取课程并调查它并根据成员类型创建数据......

```
for (Object clsObj : listClsObj) {
        Field[] declaredFields = clsObj.getClass().getDeclaredFields();
        numOfEntries = 1;
        do {
            Object newInstance = clsObj.getClass().newInstance();

            for (Field field : declaredFields) {

                // Get member name & types

                Class<?> fieldType = field.getType();
                Type genericType = field.getGenericType();
                String fieldTypeName = fieldType.getName();
                String memberName = field.getName();

                if (genericType instanceof ParameterizedType) {
                    ParameterizedType pt = (ParameterizedType) genericType;
                    for (Type typeOfReferance : pt.getActualTypeArguments()) {

                        String classTypeName = typeOfReferance.toString();
                        String[] parts = classTypeName.split(" ");
                        memberReferance = parts[1]; 
```

在这里，我想调用可以根据数据类型处理字段的特定方法

```
public static SwitchInputType<?> switchInput(final String typeName, final String memberName, final int cnt) {
    if (typeName.equals("java.lang.String")) {
        return new SwitchInputType<String>(new String(memberName + " " + cnt));
    } else if (typeName.equals("char")) {
        return new SwitchInputType<Character>(new Character('a')); 
```

例如，该类应如下所示，我需要知道 primaryKey 键才能创建对象。

```
@Entity
public class SalesOrderItem 
{
    @EmbeddedId
    SalesOrderItemPK primaryKey; 
    private String ProductId;
    private String Notes; 
```

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-17T13:18:47.787

如果你不打电话`.toString()`，而是投到`Type`，`Class`你会得到`.isPrimitive()`

# mysql - 按每行多个字段中出现的字符串计数对结果进行排序

> ID：14921414
> 
> 赞同：2
> 
> 时间：2013-02-17T13:08:51.273
> 
> 标签：mysql, sql

我正在尝试在 MySQL DB 上创建（某种）全文搜索：我想在 2 个字段中查找字符串“abc”的出现，`TITLE`并按`DESCRIPTION`出现次数（每行）对结果进行排序，最好是加权的，即在 中找到的每个“abc”的`TITLE`计数是`DESCRIPTION`.

这是否可能在一个（可能又长又丑）查询中实现，还是我必须创建一些单词索引表？

到目前为止，我的方法发现了这些事件，但没有排序，但只有权重。（我在 PHP 中做后者，但这开始变得非常昂贵）：

```
SELECT * FROM CONTENT WHERE (`TITLE` like '%abc%' OR DESCRIPTION like '%abc') 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:20:13.790

尝试：

```
SELECT 2*(LENGTH(`TITLE`)-LENGTH(REPLACE(`TITLE`,'abc',''))) + 
         (LENGTH(DESCRIPTION)-LENGTH(REPLACE(DESCRIPTION,'abc',''))) sort_num,
       c.* FROM CONTENT c
WHERE (`TITLE` like '%abc%' OR DESCRIPTION like '%abc')
ORDER BY 1 DESC 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T13:25:27.507

您可以使用`replace`搜索命中数来缩短字符串。这样，您可以计算列中字符串的出现次数。您可以在每个出现计数前面放置一个因素以增加其权重。此示例计算`col1`两次：

```
select  *
,       (
          2 * (char_length(col1) - char_length(replace(col1,'abc',''))) +
          (char_length(col2) - char_length(replace(col2,'abc','')))
        ) / char_length('abc') as Occurances
from    YourTable
order by
        Occurances desc 
```

[SQL Fiddle 上的实时示例。](http://sqlfiddle.com/#!2/837a4/3/0)

# vb.net - 实体框架将数据保留在内存中，即使它已被释放

> ID：14921419
> 
> 赞同：0
> 
> 时间：2013-02-17T13:09:42.237
> 
> 标签：vb.net, entity-framework, memory, using

我目前正在使用 EF，因为我想在一个新项目中使用它，但我遇到了一个我无法向自己解释的小内存问题。

情况如下：

我打开一个包含显示数据的网格的新表单。如果`OnLoad`我使用实体框架模型从数据库中获取数据：

```
 Using db As New OfficeDatabaseModelContainer(DatabaseManager.Instance.ProductiveConnectionString)
        Dim groupList As List(Of String) = New List(Of String)
        groupList.Add("Active")
        GridUtils.AssignObjectListToGrid(grdUser, db.User, GetType(User), groupList)
   End Using 
```

这段代码增加了大约 10MB 的内存（由于测试我从数据库中读取了 15k 行）。当我关闭表单时，我以编程方式处理表单以及包含数据的网格。但是数据库模型上下文的 10MB 保留在内存中。即使它应该在我在 using 块中获取数据时被处理。

如果我打开表单 10 次，它总是将新的数据量添加到内存中（这是有道理的），但不会清除已处理的数据。

我什至试图`GC.Collect()`在关闭表单时打电话，但它也无济于事。

内存泄漏不是来自网格或其他东西。我证明了使用以下代码：

```
Dim userList = DatabaseManager.Instance.ProductiveDatabase.User
Dim groupList As List(Of String) = New List(Of String)
groupList.Add("Active")
GridUtils.AssignObjectListToGrid(grdUser, userList, GetType(User), groupList) 
```

这样，我在单例类中就有了数据库模型的静态属性。其中`ProductiveDatabase`是模型的实例，用户代表表用户。我可以随时调用表单，因为我希望内存使用量保持在 ~10MB，这非常有意义，因为我总是以这种方式对相同对象使用相同的引用。

一定有什么我做错了。我已经在互联网上搜索了模型的使用情况并尽可能降低内存使用量。似乎这里的最佳实践是在使用模型时使用 using 块。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T15:43:19.873

对 dbcontext 的第一次调用将构建所有配置等，并将其静态存储在进程内存中。要确认这一点，请尝试添加第二次和第三次调用，并且内存占用应该保持一致。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:02:07.957

在您在代码中完成列表后，我将处理该列表，实际上处理任何 IDisposable 对象

groupList.dispose

# javascript - JavaScript getElementByName().value 不起作用

> ID：14921421
> 
> 赞同：2
> 
> 时间：2013-02-17T13:09:50.937
> 
> 标签：javascript

如果没有选择文件，我想要警报。但是在这段代码中当一个文件被选中时。它仍然显示警报。请告诉我如何解决它。

```
<script>
function null_upload()
{
 var a = document.getElementsByName("upload_file").value;
 if(a == null)
 {
    alert('Please Select Min 1 File.');
    return false;
 }
}
</script> 
```

上传表格是

```
<input type="file" name="upload_file">
<input type="image" src="img/upload.png"  id="upload_botton" title="Upload Image" name="submit" onclick="return null_upload()"/> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T13:10:54.877

方法[`getElementsByName`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByName)返回一个集合（即一组多个元素）而不是单个 DOM 元素（例如，[`getElementById`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)这样做）。

要获取第一个匹配的元素，请使用以下命令：

```
var a = document.getElementsByName("upload_file")[0].value; 
```

# mysql - 如何在netbeans中创建一个自动化的mysql脚本

> ID：14921422
> 
> 赞同：0
> 
> 时间：2013-02-17T13:09:56.563
> 
> 标签：mysql, netbeans

有没有办法使用 NetBeans 自动执行 MySQL 脚本？我有两个`.sql`可以从命令行运行的脚本，但是有没有办法将它集成到 NetBeans 中以使用单击、按钮或 GUI 中的任何东西来运行它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:18:43.783

> Netbeans 中有一个运行 SQL 按钮。我不知道这是否仅在您在数据库资源管理器中时显示。我现在没有安装 netbeans 来测试。
> 
> 阅读本指南的更多内容：http: [//netbeans.org/kb/docs/ide/mysql.html#running](http://netbeans.org/kb/docs/ide/mysql.html#running)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T01:42:30.547

从 IDE 的主菜单中选择“文件”>“打开文件”。在文件浏览器中导航到您之前保存 .sql 的位置，然后单击打开。该脚本会自动在 SQL 编辑器中打开。确保从编辑器顶部工具栏中的连接下拉框中选择了与（数据库名称）的连接。SQL 编辑器工具栏中的连接下拉框位于工具栏中编辑器的正上方。

单击 SQL 编辑器任务栏中的运行 SQL（运行 SQL 按钮）按钮。该脚本针对选定的数据库执行，并在“输出”窗口中生成任何反馈。

# php - php : 使用文件 _get_content 读取 php 中的 json 数据

> ID：14921424
> 
> 赞同：0
> 
> 时间：2013-02-17T13:10:03.117
> 
> 标签：php, jquery, json

我正在尝试从 php 文件中读取 json 数据。这是我的代码。

category-query.php（这是我的 json 数据）

```
<script>
var json_data = 
[
                /*
                !please notice
                you can add the category name SpecialFeature, 
                but it will be igone in the main menu
                */
                //cat 1
                {
                        "categoryName"      : "Dishes",  
                        "categoryImageUrl"  : "cat_01.jpg" ,
                        "categoryRootMenu"  : false ,
                        "categoryStyle" : "one"
                },
                //cat 2
                {
                        "categoryName"          : "Dessert",  
                        "categoryImageUrl"  : "cat_02.jpg" ,
                        "categoryRootMenu"  : false ,
                        "categoryStyle" : "two"

                },
                //cat 3
                {
                        "categoryName"          : "Dimsum",  
                        "categoryImageUrl"  : "cat_04.jpg" ,
                        "categoryRootMenu"  : false ,
                        "categoryStyle" : "submenu"

                }   ] 
```

这是我在 index .php 上所做的以读取上述值

```
 $get_category = file_get_contents("res3/resproj-data/category-query.php");
                        $decode = json_decode($get_category);
                        print $decode;
                        ?> 
```

不幸的是，我无法在`$decode` 变量中获得这些值，请告诉我如何读取这些值

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:13:13.260

您文件的内容不是 JSON；它们看起来像是包含 JavaScript 代码的 HTML `<script>`。

为了`json_decode`处理数据，需要删除前两行：

```
<script>
var json_data = 
```

完全不清楚为什么您的文件有`.php`扩展名，或者为什么它需要包含 JavaScript 代码。如果此数据文件与您的应用程序的其他部分之间存在交互，您应该在问题中提及它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:25:41.227

一个简单的解决方案允许您只使用 php。JS 不是必需的。

**案例1：** 如果你使用一个php文件，你可以只包含它（它将被执行）文件：category-query.php

```
<?php
  $categories = array() ;

      //Push categories and cast them to objects
      $categories[] = (object) array(
        "categoryName"     => "Dimsum",  
        "categoryImageUrl" => "cat_04.jpg",
        "categoryRootMenu" => false,
        "categoryStyle"    => "submenu"
      ) ;   

    header('Content-Type: application/json');
    echo json_encode($categories) ; 
?> 
```

**案例二：** 如果您不需要执行脚本并想使用 file_get_contents：

文件：category-query.php

```
[{"categoryName":"Dimsum","categoryImageUrl":"cat_04.jpg","categoryRootMenu":false,"categoryStyle":"submenu"}] 
```

文件：index.php

```
<?php
$data = file_get_contents("category-query.php") ;
$categories = json_decode($data) ;

if (!is_null($categories)){
  Use your array with objects
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T13:16:54.853

如果你得到一个格式良好的 JSON 脚本，我想你想在 php 中有一个关联数组，所以使用 : `json_decode($datas,true);`。然后测试你的数组是否被很好地解析，它不是你想要使用的“打印”，而是`var_dump`. 除了显示它之外，如果您想遍历它，请使用 foreach 循环。

如果您没有像 Jon 认为的那样获得格式良好的 JSON，请检查您的脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T14:27:23.423

除此之外，使用 file_get_contents() 从您控制的文件中获取数据是非常奇怪的，如果源是 utf8，您只能成功地将 JSON 解码为 PHP 数组。尝试这个：

```
$get_category = utf8_encode(file_get_contents("res3/resproj-data/category-query.php"));
$decode = json_decode($get_category, true);
print_r $decode; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T13:36:54.723

请参阅我的代码示例

```
$Link = SITE.'service/Controller.php?request='.ABS.'&action='.SEARCH_CLIENT.'&data='.json_encode($data);  
$ResultArray = array();
  $Result = file_get_contents($Link);
  $jsonResponse = json_decode($Result,true);
  $ResultArray = $jsonResponse[JSON_DATA]; 
```

如果您 p​​rint_r $jsonResponse 变量，您将拥有一个关联数组，那么您将从关联数组中获取值。因为 json decode 将 json 转换为数组。

# sqlite - 使用 djgpp 在 dos 上编译 sqlite3

> ID：14921430
> 
> 赞同：0
> 
> 时间：2013-02-17T13:10:28.987
> 
> 标签：sqlite, dos, djgpp

我想在 DOS 上编译 Sqlite 最新版本。当我尝试时，我能够制作 libsqlite3.a 为了使其工作，我使用了 fchown-stub.c 但是当我尝试将它链接到 shell.o 以制作 exe 时，它​​给了我错误 mmap undefined 和 munmap undefined。它们都在 sys/stat.h 中定义，我认为 mmap 和 munmap 是 linux 特有的，没有 equ。在dos。在将 unix 移植到 dos 时，许多程序员应该面临同样的问题。请告诉我，如何解决这个问题。感谢您。

# python - 2个列表的字符串比较

> ID：14921431
> 
> 赞同：1
> 
> 时间：2013-02-17T13:10:46.140
> 
> 标签：python, string, list

我有 2 个清单。

```
a = ['this;mango', 'is:red', 'test;cat']
b = ['man', 'is', 'can'] 
```

我想迭代 b 的每个元素并检查该字符串是否存在于列表 a 中。我怎样才能做到这一点 ？

对于上面的示例输出将是：

```
# is 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:14:20.747

```
a = ['this;mango', 'is:red', 'test;cat']
b = ['man', 'is', 'can']

import re

for elem in b:
    for test in a:
        if re.search(r'\b' + re.escape(elem) + r'\b', test):
            print elem 
```

使用*列表理解：*

```
>>> a = ['this;mango', 'is:red', 'test;cat']
>>> b = ['man', 'is', 'can']
>>> 
>>> import re
>>> [elem for elem in b if any(re.search(r'\b' + re.escape(elem) + r'\b', test) for test in a)]
['is'] 
```

* * *

另一个带有`map`和`lambda`避免`explicit`循环的版本`a`：

```
>>> [elem for elem in b if any(map(lambda test: re.search(r'\b' + re.escape(elem) + r'\b', test), a))]
['is'] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:14:11.037

```
In [13]: words = set(reduce(operator.add, (re.split(r'[:;]', s) for s in a)))

In [14]: words
Out[14]: set(['this', 'is', 'cat', 'mango', 'test', 'red'])

In [15]: [w for w in b if w in words]
Out[15]: ['is'] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T13:23:49.083

我认为你真的必须在 a 中指定你的分隔符，否则也应该找到“man”。

```
>>> a = ['this;mango', 'is:red', 'test;cat']
>>> b = ['man', 'is', 'can']
>>> [elem for elem in b if elem in " ".join(a)]
['man', 'is'] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-17T13:48:59.517

采用@NPE 的解决方案并希望非单词字符`\W`可以。

```
In [221]: a = ['this;mango', 'is:red', 'test;cat']

In [222]: right = set(reduce(operator.add, list(re.split(r'[\W]', s) for s in a)))

In [223]: right
Out[223]: set(['this', 'is', 'cat', 'mango', 'test', 'red'])

In [224]: left = set(['man', 'is', 'can'])

In [225]: left
Out[225]: set(['is', 'can', 'man'])

In [226]: left &  right
Out[226]: set(['is']) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-02-17T14:05:06.457

这个怎么样？

```
[i for i in b if any(i in re.split(r'\W', j) for j in a)] 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-17T14:15:23.183

您可以组合 b 的元素以避免第二个循环：

```
import re

a = ['this;mango', 'is:red', 'test;cat']
b = ['man', 'is', 'can']

def words_in_strings(words, strings):
    pat = re.compile('|'.join(words))
    for i in strings:
        m = pat.search(i)
        if m:
            yield m.group(0)

for i in words_in_strings(b, a):
    print i 
```

# php - 如何将 url 图像从 codigniter 中的资产保存到数据库中？

> ID：14921432
> 
> 赞同：0
> 
> 时间：2013-02-17T13:10:46.070
> 
> 标签：php, mysql

我保存了图像，`../assets/images/`我想在数据库中保存每个图像的链接，以便使用 foreach 在视图中显示它们。如何将所有图像保存在数据库中，以便每个图像都有一个 id？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:15:21.173

假设问题是您不知道将从哪个 URL/目录级别调用图像，请在您的视图中使用绝对路径，这无关紧要：

```
<img src='/assets/images/123.jpg' /> 
```

编辑。我想我的假设是错误的。您不需要数据库来显示它们。如果这样做，请修改下面的代码以将它们插入到数据库中，并在其中回显图像标签。

followiung 将遍历您的目录，抓取 jpg、png 和 gif 文件（只要它们具有小写扩展名）并创建适当的 HTML 图像标签。

```
 $path = 'assets/images';

        $img = array();
        if ($handle = opendir('.'.$path)) {
            while (false !== ($entry = readdir($handle))) {
                $n++;
                if  (       (substr($entry,-4)=='.jpg') || (substr($entry,0,4)!='.gif') || (substr($entry,0,4)!='.png') ){
                    $img[$n]=$entry;    
                }
            }
            closedir($handle);
        }

        foreach($img as $v){
            echo "<img src='$path$v' />";
        } 
```

通常，在此处提问之前，请尝试更好地描述您的问题并展示您已经完成的一些工作。

# c# - 使用 LAN 时自托管 WCF 服务 EndpointNotFoundException

> ID：14921434
> 
> 赞同：0
> 
> 时间：2013-02-17T13:10:55.830
> 
> 标签：c#, wcf, service, wcf-endpoint

我编写了 2 个简单的控制台应用程序，一个是托管 wcf 服务的，第二个是 wcf 服务客户端。

如果我在一台机器（主机和客户端）上运行这两个应用程序，它可以正常工作，但是如果我尝试将客户端或主机移动到另一台机器，我会`EndpintNotFountException`在尝试连接到主机时得到。

这是我的服务代码：

```
namespace ConsoleApplication7
{
    using System.ServiceModel;

    [ServiceContract]
    public interface ISimpleService
    {
        [OperationContract]
        void Register(string name);
    }
} 
```

并实现类：

```
namespace ConsoleApplication7
{
    public class SimpleService : ISimpleService
    {
        public void Register(string name)
        {
            DataBase.Save(name);
        }
    }
} 
```

如您所见，这是非常简单的服务:)

这是主机程序的代码：

```
using System;
using System.ServiceModel;

class Program
{
    static void Main(string[] args)
    {
        var service = new ServiceHost(typeof(SimpleService));
        service.Open();

        while (true)
        {
            Console.ReadLine();
            foreach (var s in DataBase.Get())
            {
                Console.WriteLine(s);
            }
        }
    }
} 
```

它打开服务，当按下回车键时，它将打印数据库的内容。我知道它没有`Close()`其他东西，但它只是为了显示我的问题。

这是`app.config`文件：

```
 <system.serviceModel>
    <bindings>
      <netTcpBinding>
        <binding name ="myBinding">
          <security mode="None"></security>
        </binding>
      </netTcpBinding>
    </bindings>
    <client />
    <services>
      <service name="ConsoleApplication7.SimpleService" behaviorConfiguration="ServiceBehavior">
        <endpoint address="" binding="netTcpBinding" bindingConfiguration="myBinding" contract="ConsoleApplication7.ISimpleService"/>
        <endpoint address="" binding="basicHttpBinding" contract="ConsoleApplication7.ISimpleService"/>
        <endpoint address ="mex" binding="mexHttpBinding" contract="IMetadataExchange" />
        <host>
          <baseAddresses>
            <add baseAddress="net.tcp://localhost:9101"/>
            <add baseAddress="http://localhost:9102"/>
          </baseAddresses>
        </host>
      </service>
    </services>
    <behaviors>
      <serviceBehaviors>
        <behavior name="ServiceBehavior" >
          <serviceMetadata httpGetEnabled="false" />
        </behavior>
      </serviceBehaviors>
    </behaviors>
  </system.serviceModel> 
```

客户端代码：

```
using System;
using System.ServiceModel;

class Program
{
    static void Main(string[] args)
    {
        Console.WriteLine("Click to open");
        Console.ReadLine();

        try
        {
            var service = new ServiceReference1.SimpleServiceClient(new BasicHttpBinding(), new EndpointAddress("http://192.168.1.11:9102/"));
            service.Open();
            service.Register("itsMe");
        }
        catch (Exception  e)
        {
            Console.WriteLine(e);
        }

        Console.ReadLine();
    }
} 
```

客户`app.config`端由 Visual Studio 通过`AddServiceReference`选项创建。

我托管`app.config`了我尝试过的文件`http://localhost:9102`和`http://192.168.1.11:9102`作为基地址的文件。

在一台机器上打开主机和客户端应用程序时，它工作正常。当我将其中一个应用程序移动到另一台机器`System.EndpointNotFoundException`时，它会在`client.Open()`.

有什么想法我可能做错了吗？我尝试过`net.tcp`绑定，结果相同。

两台机器上都禁用了 Windows 防火墙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T06:33:22.257

当您将客户端或服务移动到另一台机器时，您没有提及更改服务地址。您正在使用的地址 -`localhost:xxxx`只会在程序所在的机器上被识别，因此例如，如果您的服务在 Machine1 上并且您将客户端移动到 Machine2，则客户端将无法看到该服务预计它会出现在 Machine2 上。您可能在 IP 地址方面遇到了类似的问题，尽管它看起来更像是路由器地址。

我建议更新服务的配置文件以使用机器名称（例如，`http://machine1:9102`），并使用该地址从客户端访问服务。例如：

```
var service = new ServiceReference1.SimpleServiceClient(new BasicHttpBinding(), new EndpointAddress("http://machine1:9102/")); 
```

# python - Python - 查找文本文件中单词列表的单词频率

> ID：14921436
> 
> 赞同：14
> 
> 时间：2013-02-17T13:11:48.560
> 
> 标签：python, text, frequency

我正在尝试加快我的项目来计算词频。我有 360 多个文本文件，我需要获取单词总数和另一个单词列表中每个单词出现的次数。我知道如何使用单个文本文件来做到这一点。

```
>>> import nltk
>>> import os
>>> os.chdir("C:\Users\Cameron\Desktop\PDF-to-txt")
>>> filename="1976.03.txt"
>>> textfile=open(filename,"r")
>>> inputString=textfile.read()
>>> word_list=re.split('\s+',file(filename).read().lower())
>>> print 'Words in text:', len(word_list)
#spits out number of words in the textfile
>>> word_list.count('inflation')
#spits out number of times 'inflation' occurs in the textfile
>>>word_list.count('jobs')
>>>word_list.count('output') 
```

获取“通货膨胀”、“工作”、“产出”个体的频率太繁琐了。我可以把这些词放到一个列表中，同时找出列表中所有词出现的频率吗？基本上[这](https://stackoverflow.com/questions/4520876/counting-the-frequency-of-specific-words-in-text-file)与Python。

示例：而不是这个：

```
>>> word_list.count('inflation')
3
>>> word_list.count('jobs')
5
>>> word_list.count('output')
1 
```

我想这样做（我知道这不是真正的代码，这是我寻求帮助的内容）：

```
>>> list1='inflation', 'jobs', 'output'
>>>word_list.count(list1)
'inflation', 'jobs', 'output'
3, 5, 1 
```

我的单词列表将有 10-20 个术语，因此我需要能够将 Python 指向单词列表以获取计数。如果输出能够复制+粘贴到Excel电子表格中，其中单词为列，频率为行，那也很好

例子：

```
inflation, jobs, output
3, 5, 1 
```

最后，任何人都可以帮助为所有文本文件自动执行此操作吗？我想我只是将 Python 指向文件夹，它可以从新列表中为 360 多个文本文件中的每一个进行上述字数计数。似乎很容易，但我有点卡住了。有什么帮助吗？

像这样的输出会很棒：Filename1 通货膨胀，工作，输出 3、5、1

```
Filename2
inflation, jobs, output
7, 2, 4

Filename3
inflation, jobs, output
9, 3, 5 
```

谢谢！

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-17T13:15:07.257

如果我理解您的问题，[collections.Counter()已经涵盖了这一点。](http://docs.python.org/2/library/collections.html#collections.Counter)

文档中的示例似乎与您的问题相匹配。

```
# Tally occurrences of words in a list
cnt = Counter()
for word in ['red', 'blue', 'red', 'green', 'blue', 'blue']:
    cnt[word] += 1
print cnt

# Find the ten most common words in Hamlet
import re
words = re.findall('\w+', open('hamlet.txt').read().lower())
Counter(words).most_common(10) 
```

从上面的例子你应该能够做到：

```
import re
import collections
words = re.findall('\w+', open('1976.03.txt').read().lower())
print collections.Counter(words) 
```

**编辑**天真的方法来展示一种方式。

```
wanted = "fish chips steak"
cnt = Counter()
words = re.findall('\w+', open('1976.03.txt').read().lower())
for word in words:
    if word in wanted:
        cnt[word] += 1
print cnt 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-17T14:12:24.810

一种可能的实现（使用计数器）...

我认为不是打印输出，而是写入 csv 文件并将其导入 Excel 会更简单。查看[http://docs.python.org/2/library/csv.html](http://docs.python.org/2/library/csv.html)并替换`print_summary`.

```
import os
from collections import Counter
import glob

def word_frequency(fileobj, words):
    """Build a Counter of specified words in fileobj"""
    # initialise the counter to 0 for each word
    ct = Counter(dict((w, 0) for w in words))
    file_words = (word for line in fileobj for word in line.split())
    filtered_words = (word for word in file_words if word in words)
    return Counter(filtered_words)

def count_words_in_dir(dirpath, words, action=None):
    """For each .txt file in a dir, count the specified words"""
    for filepath in glob.iglob(os.path.join(dirpath, '*.txt')):
        with open(filepath) as f:
            ct = word_frequency(f, words)
            if action:
                action(filepath, ct)

def print_summary(filepath, ct):
    words = sorted(ct.keys())
    counts = [str(ct[k]) for k in words]
    print('{0}\n{1}\n{2}\n\n'.format(
        filepath,
        ', '.join(words),
        ', '.join(counts)))

words = set(['inflation', 'jobs', 'output'])
count_words_in_dir('./', words, action=print_summary) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-04-12T03:05:45.463

```
import re, os, sys, codecs, fnmatch
import decimal
import zipfile
import glob
import csv

path= 'C:\\Users\\user\\Desktop\\sentiment2020\\POSITIVE'

files=[]
for r,d,f in os.walk(path):
    for file in f:
        if'.txt' in  file:
            files.append(os.path.join(r,file))

for f in files:
    print(f)
    file1= codecs.open(f,'r','utf8',errors='ignore')
    content=file1.read()

words=content.split()
for x in words:
    print (x)

dicts=[]
if __name__=="__main__":  
    str =words
    str2 = [] 
    for i in str:              
        if i not in str2: 
              str2.append(i)  
    for i in range(0, len(str2)):
        a= {str2[i]:str.count(str2[i])}
        dicts.append(a)
for i in dicts:        
    print(dicts)

#  for i in range(len(files)):
  #    with codecs.open('C:\\Users\\user\\Desktop\\sentiment2020\\NEGETIVE1\\sad1%s.txt' % i, 'w',"utf8") as filehandle:
  #         filehandle.write('%s\n' % dicts) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-02-19T20:05:42.760

一个简单的功能代码来计算文本文件中的词频：

```
{
import string

def process_file(filename):
hist = dict()
f = open(filename,'rb')
for line in f:
    process_line(line,hist)
return hist

def process_line(line,hist):

line = line.replace('-','.')

for word in line.split():
    word = word.strip(string.punctuation + string.whitespace)
    word.lower()

    hist[word] = hist.get(word,0)+1

hist = process_file(filename)
print hist
} 
```

# jquery - jquery，html函数中的textarea，光标消失

> ID：14921443
> 
> 赞同：0
> 
> 时间：2013-02-17T13:12:46.693
> 
> 标签：jquery, cursor, textarea

我有这个简单的 Jquery 代码：

```
$('.answerComment').click(function() {
    $(this).children('.answerForm').html('<textarea></textarea>');  
}); 
```

但是只要我点击文本区域，光标就会消失，如果我想写点东西，我需要保持点击鼠标的左键

知道为什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:19:33.657

试试这个：

```
$('.answerComment').click(function(e) {
    if (e.target.nodeName == 'TEXTAREA') return;
    $(this).children('.answerForm').html('<textarea></textarea>');  
}); 
```

但是您选择的不是显示 textarea 的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:22:23.390

这是因为单击子元素时也会调用 click()

您可以通过检查实际单击了哪个元素来避免这种情况

```
$('.answerComment').click(function(e) {

    if ($(e.target).hasClass("answerComment")){
        $(this).children('.answerForm').html('<textarea></textarea>');    
    }

}); 
```

# java - 从 JTable 中获取整数值？

> ID：14921446
> 
> 赞同：3
> 
> 时间：2013-02-17T13:12:58.513
> 
> 标签：java, swing, jtable

我不明白；我正在使用`DefaultTableModel`，而我的尝试是将表格中的值作为`int`：

```
Integer.parseInt( tableModel.getValueAt(i, 1) ); 
```

Eclipse 说需要 from `Object`to演员`String`表，所以 Eclipse 做到了：

```
Integer.parseInt( (String) tableModel.getValueAt(i, 1) ); 
```

在运行时，程序会崩溃，因为无法将“int 转换为字符串”。为什么？我期望“对象->字符串-> int”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T13:19:15.557

尝试使用：

```
Integer.parseInt( tableModel.getValueAt(i, 1).toString() ); 
```

只需使用 . 设置对象的字符串表示形式`toString()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T13:16:05.063

您获得的价值`tableModel.getValueAt(i, 1)`已经是`Integer`. 只需适当地转换它：（`Integer value = (Integer) tableModel.getValueAt(i, 1);` 或者`int`如果你想使用原始类型）。

# javascript - DOMContentLoaded 事件没有被触发

> ID：14921452
> 
> 赞同：0
> 
> 时间：2013-02-17T13:13:44.260
> 
> 标签：javascript

我在文档的头部执行此代码：

```
 console.log('DOMContentLoaded event');
 document.addEventListener( "DOMContentLoaded", ready, false ); 
```

但是，即使页面准备好，该函数也不会被调用？控制台日志中的内容会被打印出来

请注意，我动态添加了一个 javascript 文件（它不是硬编码的），我认为它在脚本中已经很晚了.. 它是在 window.onload 事件之后？这可能是原因吗？有什么办法可以触发事件？

# c# - 在 Windows 8 中更改组合框背景颜色

> ID：14921453
> 
> 赞同：0
> 
> 时间：2013-02-17T13:13:58.523
> 
> 标签：c#, wpf, windows

如何更改 Combobox.Background？由于 Windows 8 `ComboBox.Background=Brushes.Red` 对 ComboBox 没有影响

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-27T19:49:13.393

我偶然发现了同样的问题，它把我带到了这里。

亚历克斯的回答给了我一个想法，在查看了 Windows 8 ComboBox 的控件模板之后，我得出了这个解决方案：

```
private void ComboBox_Loaded(Object sender, RoutedEventArgs e)
{
    var comboBox = sender as ComboBox;
    var comboBoxTemplate = comboBox.Template;
    var toggleButton = comboBoxTemplate.FindName("toggleButton", comboBox) as ToggleButton;
    var toggleButtonTemplate = toggleButton.Template;
    var border = toggleButtonTemplate.FindName("templateRoot", toggleButton) as Border;

    border.Background = new SolidColorBrush(Colors.Red);
} 
```

这个解决方案的优点是它非常简单，但它也有一个缺点：它似乎覆盖了所有状态，因此鼠标悬停等几乎没有视觉反馈。如果我想出一个更好的主意，我会编辑我的答案。

只需确保添加一些错误检查，因为一旦代码在 Windows 8.x 以外的系统上执行，或者 Microsoft 曾经尝试修复相关问题并修改模板，这可能会失败，并且很可能会失败.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T01:53:23.107

我知道已经很晚了，但我找到了一些方法来解决它。只需使用更正后的 ComboBox。

```
using System.Windows.Controls;
using System.Windows;
using System.Windows.Data;
namespace Utils {
    class ComboBoxWin8 : ComboBox {
        public ComboBoxWin8() {
            Loaded += ComboBoxWin8_Loaded;
        }
        void ComboBoxWin8_Loaded(object sender, RoutedEventArgs e) {
            ControlTemplate ct = Template;
            Border border = ct.FindName("Border", this) as Border;

            // if Windows8
            if (border != null) {
                border.Background = Background;

                // In the case of bound property
                BindingExpression be = GetBindingExpression(ComboBoxWin8.BackgroundProperty);
                if (be != null) {
                    border.SetBinding(Border.BackgroundProperty, be.ParentBindingBase);
                }
            }
        }
    }
} 
```

# c++ - 如何使数组不重复？

> ID：14921457
> 
> 赞同：0
> 
> 时间：2013-02-17T13:14:16.323
> 
> 标签：c++, arrays, random, shuffle

这是我的一个简单游戏的代码。粘贴并尝试。

```
#include <iostream>
#include <string>
#include <ctime>
#include <cstdlib>
using namespace std;

int main (void)
{
    string  g[4],
    b[4],
    a[4],
    l[4];

    srand((unsigned int)time(0));

    cout << "Welcome!\n\n";
    cout << "Type 4 girl names.\n";
    for (int gi = 0; gi < 4; gi++) 
        cin >> g[gi];

    cout << "Type 4 boy names.\n";
    for (int bi = 0; bi < 4; bi++)
        cin >> b[bi];

    cout << "\nWhat they do (enter 4 actions)?\n";
    for (int ai = 0; ai < 4; ai++)
        getline(cin, a[ai]);

    cout << "\nWhere is happening (enter 4 locations)?\n";
    for (int li = 0; li < 4; li++)
        getline(cin, l[li]);

    for (int c = 0; c < 4; c++)
        cout << g[rand() % 4] << " and " << b[rand() % 4] << " are " << a[rand() %     4] << " from a " << l[rand() % 4] << endl;

    return (0);
} 
```

在 4 行的末尾，一些名称、动作和位置重复。我如何让他们不重复并使用您将输入的每个名称？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:22:38.723

使用`std::random_shuffle`：

```
std::random_shuffle(g, g + 4);
std::random_shuffle(b, b + 4);
std::random_shuffle(a, a + 4);
std::random_shuffle(l, l + 4); 
```

然后遍历所有洗牌的数组：

```
for (int c = 0; c < 4; c++)
    cout << g[c] << " and " << b[c] << " are " << a[c] << " from a " << l[c] << endl; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:41:27.753

```
for (int c = 0; c < 4; c++)
    cout << g[rand() % 4] << " and " << b[rand() % 4] << " are "
         << a[rand() %     4] << " from a " << l[rand() % 4] << endl; 
```

您已经假设连续调用`rand()`保证*不会*产生与之前调用相同的结果`rand()`，但这是毫无根据的。

因此，您总是有可能会重复；*事实上，你每次*得到相同答案的几率是 64分之一。

要么删除随机性，要么在循环之前执行随机数组洗牌（[如 @Eladidan 先生所示](https://stackoverflow.com/a/14921546/560648)）。或者，创建一个数字数组，将其`0,1,2,3`打乱*，*然后将其用作数据数组的索引。

*这是随机洗牌*（而不是随机*提取*）的本质，它会给你一个不重复的答案。

# apache - 如何使用 Dropbox 文件夹作为 Apache 的文档根目录

> ID：14921461
> 
> 赞同：2
> 
> 时间：2013-02-17T13:14:22.977
> 
> 标签：apache, dropbox, virtualbox, web-testing

我最近在 Virtualbox 上安装了 Windows 7 Ultimate 以使用 IE 等测试我的 Web 项目。我使用 Dropbox 在我的主机操作系统（Ubuntu 12.04）和我的来宾操作系统中拥有相同的文档根目录而不是共享文件夹（这是因为我也在测试另一台机器）。

我已经将文档根目录更改为正确的文件夹，但是当我想访问 localhost 时，它给了我错误代码 403，因为 Apache 无法访问该文件夹

我现在的问题是：如何在 Ubuntu 和 Windows 中更改该文件夹的权限以让 Apache 访问它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-09T03:59:47.590

尝试这个...

**从 Ubuntu 访问**

*CHMOD -R 777 /your/directory/*（或 755）将是一种简单的方法来授予所有人访问权限，或者您可以使用*chown -R apache:apache /your/directory/* <-- 可能需要确保用户实际上是被称为“Apache”...首先尝试 CHMOD 位，看看它是否有效。

**从 Windows 访问**

我真的不认为围栏的这一边会有问题，除非 Ubuntu 以某种方式阻止它访问它？如果是这样，上面的 CHMOD -R 777 可以有效地解决这个问题。

# google-app-engine - 通道 API 和服务器亲和性

> ID：14921462
> 
> 赞同：0
> 
> 时间：2013-02-17T13:14:29.837
> 
> 标签：google-app-engine, channel-api

随着 GAE 实例的添加和删除，Channel API 如何维护服务器和客户端浏览器之间的连接。也就是说，是否由单个服务器维护连接并单独负责将消息推送到客户端浏览器。或者是否有任何服务器能够在通道上发送数据，如果可以，如何在所有服务器之间维护通道状态？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:22:16.347

你不需要担心任何这些。

任何服务器实例都可以在知道客户端 ID 的情况下向通道发送数据，而不管是哪个服务器创建了它等等。就是这样。

再加上 1.7.5 版本，您会得到：

> Channel API 现在能够从任何应用程序版本或后端发送通道消息，无论通道是在哪里创建的。

因此，您现在可以通过通道 API 使用后端，而无需任何变通方法。

[http://code.google.com/p/googleappengine/wiki/SdkReleaseNotes](http://code.google.com/p/googleappengine/wiki/SdkReleaseNotes)

# linux - 如何为微处理器 SA1100 安装交叉编译器（在 ubuntu 12.04 LTS 上）？

> ID：14921463
> 
> 赞同：8
> 
> 时间：2013-02-17T13:14:33.567
> 
> 标签：linux, gcc, ubuntu, compiler-construction, arm

有人可以告诉我如何为 SA1100 微处理器安装交叉编译器（编程语言 C）吗？我有 ubuntu 12.04 LTS。我是 Linux 的新手，我昨天刚安装了 Ubuntu。我需要一个名为“arm-unknown-linux-gnu-gcc”的 GCC 编译器的特殊变体，但不知道该怎么做。

有人可以帮帮我吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-17T16:24:22.103

正如我在评论中所说，尝试

```
apt-get install gcc-arm-linux-gnueabi 
```

或者

```
apt-get install gcc-4.7-arm-linux-gnueabi 
```

我还强烈建议能够为您的 Linux 系统编译一个普通的 C 程序（即学习`gcc`, `make`... 命令的基础知识以及如何使用诸如`emacs`或`gedit`...之类的一些编辑器），并且您想要的交叉编译器也取决于系统在您的 SA1100 硬件板上运行。不要忘记传递`-Wall`给任何 GCC 编译。您可能希望能够调试您的程序（`-g`在编译时传递给 GCC，并使用`gdb`调试器）。当你的程序运行良好时，编译它`-O2`以要求 GCC 优化它的机器代码。

学习使用 GNU -eg 通过阅读其[文档](http://www.gnu.org/software/make/manual/html_node/index.html)`make`来编写-s-并将其用作交叉编译器程序。（当没有足够的帮助时，您可能希望使用-s来调试您的）`Makefile``arm-linux-gnueabi-gcc``remake``Makefile``make`

您可以获取与软件包一起安装的文件列表，例如`dpkg -L gcc-arm-linux-gnueabi`

`libc`ARM 的交叉编译程序可执行文件很可能需要至少在 ARM 主板上带有一些（或静态链接）的 Linux 内核，并且您需要某种方式将二进制程序从 Linux 桌面传输到 ARM 硬件。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-09-27T09:51:47.257

添加 ppa：[https](https://launchpad.net/gcc-arm-embedded) ://launchpad.net/gcc-arm-embedded 两者的源代码相同。目前支持 Ubuntu 10.04/12.04/13.04/13.10/14.04 32 位和 64 位。

可以在[https://help.launchpad.net/Packaging/](https://help.launchpad.net/Packaging/)找到 Launchpad PPA 的详细说明。该网站解释了如何设置 PPA 以及如何添加现有 PPA 并从中安装软件。

以下是在 14.04 之前在 Ubuntu 上从此 PPA 安装工具链的快速步骤。打开终端并输入：

1.  `sudo add-apt-repository ppa:terry.guo/gcc-arm-embedded`
2.  `sudo apt-get update`
3.  `sudo apt-get install gcc-arm-none-eabi`

要删除已安装的工具链，只需执行以下操作：

`sudo apt-get remove gcc-arm-none-eabi`

要更新工具链，只需重复步骤 2 和 3。

# data-binding - 某处缺少绑定

> ID：14921466
> 
> 赞同：0
> 
> 时间：2013-02-17T13:14:52.957
> 
> 标签：data-binding, mvvm, combobox, selecteditem, itemssource

处理 mvvm 演示项目（不是家庭作业）

1.  继承 ObservableCollection 的类 Friends
2.  Class Friends ToString 是 FirstName + " " + LastName 等
3.  具有 Friends 和 SelectedFriend 属性的 ViewModel
4.  ComboBox ItemsSource 绑定到 ViewModel Friends 属性
5.  ComboBox SelectedItem 绑定到 ViewModel Friends 属性
6.  TextBoxes 文本绑定到 ViewModel SelectedFriend.FirstName 属性等

我进行以下更改

1.  选择史蒂夫
2.  更改为斯蒂芬 - 更改是因为如果数据被保存并重新加载是显示斯蒂芬
3.  ComboBox 仍然显示史蒂夫
4.  删除 ComboBox 列表并选择 Sara
5.  Drop ComboBox 列表 - 显示 Steve
6.  从 ComboBox 列表中选择 Steve
7.  ComboBox 现在显示 Stephen 和 FirstName TextBox
8.  选择萨拉
9.  删除 ComboBox 列表，它显示史蒂夫
10.  在保存并重新加载数据之前，组合框列表不会更改

数据被持久化到一个 xml 文件中。我遗漏了什么，以便 ComboBox 列表显示对 SelectedItem 的更新更改？

模型类

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using System.Text;

namespace MVVM_Example.Models
{
    public enum Gender : int
    {
        None = 0,
        Male,
        Female
    }

    public class Friend : INotifyPropertyChanged
    {
        private string _firstName;

        public string FirstName 
        {
            get { return _firstName; }
            set
            {
                if (_firstName != value)
                {
                    _firstName = value;
                    OnPropertyChanged("FirstName");
                }
            }
        }

        public string LastName { get; set; }
        public DateTime HireDate { get; set; }
        public Gender Gender { get; set; }
        public bool IsContractor { get; set; }
        public string FullName { get { return string.Format("{0}, {1}", LastName, FirstName); } }

        public override string ToString()
        {
            return string.Format("{0} {1}: Hired {2}, Gender {3}, Status: {4}", FirstName, LastName, HireDate.ToString("MMM dd, yyyy"), Gender, IsContractor ? "Contractor" : "Employee");
        }

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        protected void OnPropertyChanged(string propertyName)
        {
            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        #endregion
    }
}

using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.ComponentModel;
using System.Linq;

using MVVM_Example.Models;

namespace MVVM_Example.Models
{
    public class Friends : ObservableCollection<Friend>
    {
        public Friends()
            : this(loadFriends())
        {
        }

        public Friends(List<Friend> friends)
            : this(friends.ToArray())
        {
        }

        public Friends(IEnumerable<Friend> friends)
            : base(friends)
        {
        }

        public static implicit operator Friends(List<Friend> friends)
        {
            return new Friends(friends);
        }

        public Friends Sort()
        {
            return this.Cast<Friend>().OrderBy(f => f.LastName).ThenBy(f => f.FirstName).ThenByDescending(f => f.HireDate).ToList();
        }

        private static List<Friend> loadFriends()
        {
            return new List<Friend>
            {
                new Friend { FirstName = "Steve", LastName = "Wilson", Gender = Gender.Male, HireDate = new DateTime(2004, 3, 12), IsContractor = false },
                new Friend { FirstName = "Adam", LastName = "Flowers", Gender = Gender.Male, HireDate = new DateTime(2012, 12, 28), IsContractor = false },
                new Friend { FirstName = "Sara", LastName = "Fennema", Gender = Gender.Female, HireDate = new DateTime(2006, 8, 15), IsContractor = false },
                new Friend { FirstName = "Gary", LastName = "Winey", Gender = Gender.Male, HireDate = new DateTime(2012, 4, 6), IsContractor = true },
            }.OrderBy(f => f.LastName).ThenBy(f => f.FirstName).ToList();
        }
    }
} 
```

视图模型

```
using System;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Collections.Specialized;
using System.ComponentModel;
using System.IO;
using System.Linq;
using System.Windows;
using System.Windows.Controls;
using System.Windows.Input;
using System.Xml;
using System.Xml.Serialization;

using MVVM_Example.Models;

namespace MVVM_Example.ViewModels
{
    public class FriendsViewModel : INotifyPropertyChanged
    {
        #region Properties

        #region AreFriendsLoaded

        public bool AreFriendsLoaded
        {
            get { return _areFriendsLoaded; }
            private set
            {
                if (_areFriendsLoaded != value)
                {
                    _areFriendsLoaded = value;
                    OnPropertyChanged("AreFriendsLoaded");
                }
            }
        }
        private bool _areFriendsLoaded;

        #endregion

        #region Friends

        public Friends Friends
        {
            get { return _friends; }
            private set
            {
                if (_friends != value)
                {
                    _friends = value;
                    OnPropertyChanged("Friends");
                    HasFriends = value != null && value.Count > 0;
                }
            }
        }
        private Friends _friends;

        #endregion

        #region HasFriends

        public bool HasFriends 
        { 
            get { return _hasFriends; }
            private set
            {
                if (_hasFriends != value)
                {
                    _hasFriends = value;
                    OnPropertyChanged("HasFriends");
                }
            }
        }
        private bool _hasFriends;

        #endregion

        #region SelectedFriend

        public Friend SelectedFriend
        {
            get { return _selectedFriend; }
            set
            {
                if (_selectedFriend != value)
                {
                    _selectedFriend = value;
                    OnPropertyChanged("SelectedFriend");
                    transferData(true);
                }
            }
        }
        private Friend _selectedFriend;

        #endregion

        #region FirstName

        public string FirstName
        {
            get { return _firstName; }
            set
            {
                if (_firstName != value)
                {
                    _firstName = value;
                    OnPropertyChanged("FirstName");
                    transferData("FirstName");
                }
            }
        }
        private string _firstName;

        #endregion

        #endregion

        #region Constructors

        public FriendsViewModel()
            : base()
        {
            verifyFriends();
        }

        #endregion

        #region Methods

        protected virtual void DeleteSelectedFriend()
        {
            if (Friends.Contains(SelectedFriend))
            {
                Friends.Remove(SelectedFriend);
            }
        }

        private void transferData(bool fromSelectedFriend)
        {
            transferData(fromSelectedFriend, null);
        }

        private void transferData(string propertyName)
        {
            transferData(false, propertyName);
        }

        private void transferData(bool fromSelectedFriend, string propertyName)
        {
            if (fromSelectedFriend)
            {
                FirstName = SelectedFriend == null ? null : SelectedFriend.FirstName;
            }
            else if (SelectedFriend != null)
            {
                if (propertyName == null)
                {
                    throw new InvalidOperationException("Missing propertyName argument in transferData method.");
                }

                switch (propertyName.Trim().ToLowerInvariant())
                {
                    case "firstname":
                        SelectedFriend.FirstName = FirstName;
                        break;
                    default:
                        throw new InvalidOperationException(string.Format("Unexpected property name '{0} in transferData method.", propertyName));
                }
            }
        }

        private void verifyFriends()
        {
            if (Friends == null)
            {
                Friends = new Friends();
            }
        }

        #endregion

        #region INotifyPropertyChanged Members

        public event PropertyChangedEventHandler PropertyChanged;

        protected void OnPropertyChanged(string propertyName)
        {

            PropertyChangedEventHandler handler = PropertyChanged;
            if (handler != null)
            {
                handler(this, new PropertyChangedEventArgs(propertyName));
            }
        }

        #endregion
    }
} 
```

视图 - 用户控件

```
<UserControl x:Class="MVVM_Example.Views.FriendsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:j2a="http://j2associates.com/MVVMBase"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:vms="clr-namespace:MVVM_Example.ViewModels"
             mc:Ignorable="d" 
             d:DesignHeight="320" d:DesignWidth="400" Name="userControl">

    <UserControl.DataContext>
        <vms:FriendsViewModel />
    </UserControl.DataContext>

    <Grid Margin="5">
        <StackPanel>
            <DockPanel LastChildFill="False">
                <Label DockPanel.Dock="Top" Content="Friends" />
                <ComboBox DockPanel.Dock="Bottom" Name="friendsComboBox" Margin="0,5,0,0" ToolTipService.ShowOnDisabled="True" VerticalContentAlignment="Center" 
                          ItemsSource="{Binding Friends}" SelectedItem="{Binding SelectedFriend}" IsEnabled="{Binding HasFriends}" />
            </DockPanel>

            <GroupBox Header="Selected Friend" Margin="0,5,0,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                        <RowDefinition Height="auto"/>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>

                    <Label Grid.Row="0" Grid.Column="0" Content="First Name" Margin="10,5,0,0" />
                    <Label Grid.Row="1" Grid.Column="0" Content="Last Name" Margin="10,5,0,0" />
                    <Label Grid.Row="2" Grid.Column="0" Content="Hire Date" Margin="10,5,0,0" />
                    <Label Grid.Row="3" Grid.Column="0" Content="Gender" Margin="10,5,0,0" />
                    <Label Grid.Row="4" Grid.Column="0" Content="Contractor" Margin="10,5,0,0" />

                    <TextBox Grid.Row="0" Grid.Column="1" Margin="5,5,0,0" VerticalContentAlignment="Center" 
                             Text="{Binding FirstName, UpdateSourceTrigger=PropertyChanged, TargetNullValue=Undefined}" />
                    <TextBox Grid.Row="1" Grid.Column="1" Margin="5,5,0,0" VerticalContentAlignment="Center" 
                             Text="{Binding SelectedFriend.LastName, UpdateSourceTrigger=PropertyChanged, FallbackValue=Undefined}" />
                    <DatePicker Grid.Row="2" Grid.Column="1" Margin="5,5,0,0" VerticalContentAlignment="Center" 
                                SelectedDate="{Binding SelectedFriend.HireDate}" />
                    <TextBox Grid.Row="3" Grid.Column="1" Margin="5,5,0,0" VerticalContentAlignment="Center" 
                             Text="{Binding SelectedFriend.Gender, UpdateSourceTrigger=PropertyChanged, FallbackValue=Undefined}" />
                    <CheckBox Grid.Row="4" Grid.Column="1" VerticalAlignment="Center" Margin="5,5,0,0" VerticalContentAlignment="Center" 
                              IsChecked="{Binding SelectedFriend.IsContractor, FallbackValue={x:Null}}" />
                </Grid>
            </GroupBox>

            <DockPanel LastChildFill="False">
                <Button DockPanel.Dock="Left" Content="Save data" Margin="5,5,0,0" Width="70" Click="saveDataButton_Click" />
            </DockPanel>
        </StackPanel>
    </Grid>
</UserControl> 
```

ViewModel Code Behind - 使用事件而不是命令来最小化显示的代码

```
 private void saveDataButton_Click(object sender, RoutedEventArgs e)
    {
        string path = Directory.GetCurrentDirectory();
        path = new DirectoryInfo(Path.Combine(path, "..\\..\\Data\\friends.xml")).FullName;

        // Create a new file stream to write the serialized object to a file.
        using (TextWriter fileStreamWriter = new StreamWriter(path))
        {
            // Create a new XmlSerializer instance with the type.
            XmlSerializer serializer = new XmlSerializer(typeof(Friends));
            serializer.Serialize(fileStreamWriter, ((MVVM_Example.ViewModels.FriendsViewModel)DataContext).Friends);

            // Cleanup.
            fileStreamWriter.Close();
        }

        MessageBox.Show(File.ReadAllText(path), "Data Saved", MessageBoxButton.OK, MessageBoxImage.Information);
    } 
```

主窗口

```
<Window x:Class="MVVM_Example.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:views="clr-namespace:MVVM_Example.Views"
        Title="Main Window" Height="350" Width="425">
    <Grid>
        <views:FriendsView x:Name="friendsView1" />
    </Grid>
</Window> 
```

# android - 如何在 phonegap 中使用自定义字体

> ID：14921472
> 
> 赞同：4
> 
> 时间：2013-02-17T13:15:16.757
> 
> 标签：android, cordova

建议的字体（css）方式在 android google 模拟器中不起作用。请帮助我，我想使用自定义 utf-8 字体而不是 android 默认字体。

# c++ - 尝试使用 std::function 实例化模板时出现错误 C2371

> ID：14921474
> 
> 赞同：0
> 
> 时间：2013-02-17T13:15:43.020
> 
> 标签：c++, templates, visual-c++, c++11

考虑以下 C++ 程序

```
#include <cwchar>
#include <cwctype>
#include <string>
#include <functional>
template <typename Ty>
struct Tokenize {
    Ty m_delim;
    Tokenize(Ty& delim):m_delim(delim){}
};

int main() {
    std::function<bool (wchar_t)> foo = iswdigit; //Compiles fine
    Tokenize<std::string >(std::string("")); //Compiles fine
    Tokenize<std::function<bool (wchar_t)> >(foo); // Fails
    return 0;
} 
```

在尝试使用 VC++ 编译时，因编译器错误而失败

```
error C2371: 'foo' : redefinition; different basic types
error C2512: 'Tokenize<Ty>' : no appropriate default constructor available 
```

看起来它试图重新定义 foo，但不知道怎么做

**注意**仔细检查表明编译器认为

```
Tokenize<std::function<bool (wchar_t)> >(foo) 
```

作为构造`Tokenize<std::function<bool (wchar_t)> >`具有默认参数的类型的对象，即

```
Tokenize<std::function<bool (wchar_t)> >  foo 
```

但问题仍然是为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:30:43.903

您习惯于看到如下代码：

```
T(arg1, arg2) 
```

为了创建一个*临时*的类型`T`。您习惯于在表达式中看到这一点，例如：

```
f(T(arg1, arg2)) 
```

你也看到了它的一个论点：

```
f(T(arg1)) 
```

但是，当您假定的临时创建是一行代码中的*完整*语句时，它在语法上与声明没有区别。

那是：

```
T(arg1); 
```

是相同的：

```
T arg1; 
```

如果一段代码可能是声明*或*表达式，它始终是声明。这本质上是一个[**最令人头疼的解析**](http://en.wikipedia.org/wiki/Most_vexing_parse)示例。

您可以使用`()`消除歧义，强制将语句读取为表达式：

```
(T(arg1)); 
```

但是我通常会问为什么你觉得有必要在自己的线路上创建一个临时的，然后你什么都不做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:18:42.827

你想定义一个对象，不是吗？

那么，`Tokenize<std::function<bool (wchar_t)> >(foo);`应该是`Tokenize<std::function<bool (wchar_t)> > tokenizer(foo);`

# objective-c - 核心文本视图内存泄漏

> ID：14921476
> 
> 赞同：0
> 
> 时间：2013-02-17T13:15:49.520
> 
> 标签：objective-c, ipad, core-graphics, ios5.1

我创建了一个核心文本视图，在视觉上它工作得很好，但我运行了 30 分钟，有大量数据进入，它崩溃了。调试器开始说“收到内存警告”。我认为我在从 telnet 进入的每条新行上刷新的视图并没有完全在重绘时留下内存。下面的代码。这段代码的第一部分可能是个问题。我发现在重绘时我必须清除旧视图，否则它会覆盖或绘制在顶部并且文本会出现乱码。但它可能是我创建的任何变量变得持久。

```
- (void)buildFrames
{

    for (UIView __strong *view in self.subviews) {
        [view removeFromSuperview];
        view = nil;
    }

    frameXOffset = 20; //1
    frameYOffset = 0;
    double height=0;
    double oldHeight = 0;
    int columnIndex = 0;
    self.frames=nil;
    self.frames = [NSMutableArray array];
    // self.pagingEnabled = YES;
    self.delegate = self;
    CGRect textFrame = CGRectInset(self.bounds, frameXOffset, frameYOffset);
    // set string
    int spot =0;
    if(self.chatLog != nil && self.chatLog != NULL)
      if(self.chatLog.total > 300)
          spot = self.chatLog.total - 300;
    if(spot < 0)
        spot=0; // double check for thread saftey;
    int _total = self.chatLog.total;
    if(_total < 0 || _total > self.chatLog.max)
        return;

    if(self.chatLog != nil && self.chatLog != NULL)
        for(int index = spot; index < _total; index ++)
        {

            NSString *theTell = [self.chatLog getChatAt:index];
             NSString *chatType = [self.chatLog getTypeAt:index];

            if(theTell == nil || theTell == NULL)
            {    theTell=@"nil";

                 chatType = @"line";
            }
        attString=nil;
        attString = [[NSMutableAttributedString alloc] initWithString:theTell];

            //else
    //    attString = [[NSAttributedString alloc] initWithString:@"Hello core text world"];

    CTFontRef font = CTFontCreateWithName(CFSTR("Courier"), self.fontSize, NULL);
    CFAttributedStringSetAttribute((__bridge CFMutableAttributedStringRef)(attString), CFRangeMake(0, CFAttributedStringGetLength((__bridge CFAttributedStringRef)(attString))), kCTFontAttributeName, font);
if([chatType isEqual: @"line"])
{
CFAttributedStringSetAttribute((__bridge CFMutableAttributedStringRef)(attString), CFRangeMake(0, CFAttributedStringGetLength((__bridge CFAttributedStringRef)(attString))), kCTForegroundColorAttributeName, _lineColor);    

}
else if([chatType isEqual: @"notify"])
{
CFAttributedStringSetAttribute((__bridge CFMutableAttributedStringRef)(attString), CFRangeMake(0, CFAttributedStringGetLength((__bridge CFAttributedStringRef)(attString))), kCTForegroundColorAttributeName, _notifyColor);
}
else if([chatType isEqual: @"tell"])
{
    CFAttributedStringSetAttribute((__bridge CFMutableAttributedStringRef)(attString), CFRangeMake(0, CFAttributedStringGetLength((__bridge CFAttributedStringRef)(attString))), kCTForegroundColorAttributeName, _tellColor);
}
else
{
CFAttributedStringSetAttribute((__bridge CFMutableAttributedStringRef)(attString), CFRangeMake(0, CFAttributedStringGetLength((__bridge CFAttributedStringRef)(attString))), kCTForegroundColorAttributeName, _defaultColor);        
}

    textFrame =  CGRectMake(0, 0, self.bounds.size.width, self.fontSize+4);
    CGMutablePathRef path = CGPathCreateMutable(); //2
       CGPathAddRect(path, NULL, textFrame );

    CTFramesetterRef framesetter = CTFramesetterCreateWithAttributedString((__bridge CFAttributedStringRef)attString);
    int textPos = 0; //3

    while (textPos < [attString length]) { //4

    //  CGPoint colOffset = CGPointMake( (columnIndex+1)*frameXOffset + columnIndex*(textFrame.size.width), 20 );
        CGPoint colOffset = CGPointMake(  20, (columnIndex+1)*frameYOffset + columnIndex*(textFrame.size.height) );
        CGRect colRect = CGRectMake(0, 0 , textFrame.size.width-10, textFrame.size.height);// was -40

        CGMutablePathRef path = CGPathCreateMutable();
        CGPathAddRect(path, NULL, colRect);

        //use the column path
        CTFrameRef frame = CTFramesetterCreateFrame(framesetter, CFRangeMake(textPos, 0), path, NULL);
        CFRange frameRange = CTFrameGetVisibleStringRange(frame); //get visiblestringrange
        //create an empty column view
        CTColumnView *content = [[CTColumnView alloc] initWithFrame: CGRectMake(0, 0, self.contentSize.width, self.contentSize.height)];
        content.backgroundColor = [UIColor clearColor];
        content.frame = CGRectMake(colOffset.x, colOffset.y, colRect.size.width, colRect.size.height) ;

        //set the column view contents and add it as subview
        [content setCTFrame:(__bridge id)frame];  //6
        [self.frames addObject: (__bridge id)frame];
        [self addSubview: content];

        //prepare for next frame
        textPos += frameRange.length;

        //CFRelease(frame);
        CFRelease(path);

        columnIndex++;
        oldHeight = height;
        height= [self measureFrameHeight:frame];

    }
        }// end while
    //set the total width of the scroll view
    int totalPages = (columnIndex) ; //7
   // self.contentSize = CGSizeMake(totalPages*self.bounds.size.width, textFrame.size.height);

    self.contentSize = CGSizeMake(textFrame.size.width, (textFrame.size.height ) * (totalPages -1) + height + 40 );

   [self scrollRectToVisible:CGRectMake(0, 0 , textFrame.size.width-10,  (textFrame.size.height) * (totalPages -1) + height +40 ) animated: FALSE];

} 
```

类定义是：

```
@interface ConsoleView :UIScrollView<UIScrollViewDelegate>
{
    float frameXOffset;
    float frameYOffset;

    NSMutableArray *frames;

}
@property  (strong, nonatomic) NSAttributedString *attString;
-(void) addNewText:(NSString *) text;
@property (weak, nonatomic) NSMutableArray *frames;// was reatin not strong
- (void)buildFrames;
@property (strong, nonatomic) ChatTextQueue *chatLog;
@property (nonatomic) int fontSize;
@property  (strong, nonatomic) UIColor *userColor;
@property (nonatomic) CGColorRef notifyColor;
@property (nonatomic) CGColorRef lineColor;
@property (nonatomic) CGColorRef defaultColor;
@property (nonatomic) CGColorRef tellColor;

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:26:19.990

`font`您没有释放某些对象，例如`framesetter`和`frame`。使用 xCode 中的分析命令查找`buildFrames`方法中的所有内存泄漏。

# c# - 为什么在 listBox 上单击鼠标右键时，它在 listBox 区域的任何地方都可以工作？

> ID：14921478
> 
> 赞同：0
> 
> 时间：2013-02-17T13:15:51.603
> 
> 标签：c#

我在 Form1 中有这两个事件：

```
private void contextMenuStrip1_Opening(object sender, CancelEventArgs e)
        {
            //clear the menu and add custom items
            contextMenuStrip1.Items.Clear();
            contextMenuStrip1.Items.Add(string.Format("Edit - {0}", listBox1.SelectedItem.ToString()));
        }

        private void listBox1_MouseUp(object sender, MouseEventArgs e)
        {
            if (e.Button == System.Windows.Forms.MouseButtons.Right)
            {
                int index = listBox1.IndexFromPoint(e.Location);
                if (index == -1) return;
                contextMenuStrip1.Show(listBox1,listBox1.PointToClient(System.Windows.Forms.Cursor.Position));                
            }
        } 
```

在设计器中，我有一个 ContextMenuStrip 和一个 listBox 控件。

我需要它做的是，当我在 listBox 区域的任意位置单击鼠标右键时，它不会执行任何操作。但是，如果我只单击 listBox 中的选定项目，则会显示 contextMenuStrip。仅当鼠标在列表框中的选定项目上方/上时。

当我的程序正在运行时，第一个项目已被选中，因此我需要在运行程序后将鼠标移到所选项目上方并右键单击按钮，它将起作用。如果我不在所选项目上，它将不起作用。我的意思是只有当鼠标光标位于所选项目上方时，右键单击才会起作用并显示上下文菜单条。

如果我现在将鼠标放在所选项目上，如果我单击鼠标右键，则不会将鼠标移到所选项目上，它会起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:32:00.127

ListBox.IndexFromPoint() 接受的内容非常自由。超出列表中最后一项的位置将返回最后一项的索引。您可以通过根据鼠标位置仔细检查返回项目的位置来解决此问题，如下所示：

```
 private void listBox1_MouseDown(object sender, MouseEventArgs e) {
        if (e.Button == MouseButtons.Right) {
            var idx = listBox1.IndexFromPoint(e.Location);
            if (idx >= 0 && listBox1.GetItemRectangle(idx).Contains(e.Location)) {
                listBox1.SelectedIndex = idx;
                contextMenuStrip1.Show(listBox1, e.Location);
            }
        }
    } 
```

请注意，我没有按照您的要求强制用户仅单击所选项目。放弃这样的用户操作是非常不合理的，简单地选择单击的项目要直观得多。如果您不想这样做，请更改 GetItemRectangle() 调用以使用 listBox1.SelectedIndex 而不是*idx*。只要确保在还没有选定项目时不会遇到麻烦。

# objective-c - clang 编译错误（未定义对 objc_autoreleasepoolpush 的引用）

> ID：14921482
> 
> 赞同：6
> 
> 时间：2013-02-17T13:16:09.833
> 
> 标签：objective-c, clang, gnustep

所以，我安装了 Ubuntu 和 clang3.0 以及一个简单的 program.m：

```
#include <Foundation/Foundation.h>
int main()
{
        @autoreleasepool{
            NSLog(@"Hi");
        }

        return 0;
} 
```

我尝试像这样编译它：

```
clang first.m -I /usr/include/GNUstep/ -lgnustep-base -fconstant-string-class=NSConstantString -objc 
```

我得到

```
undefined reference to objc_autoreleasePoolPush
undefined reference to objc_autoreleasePoolPop 
```

所以我用谷歌搜索了一下并安装了 objc2 并尝试了：

```
clang first.m -I /usr/include/GNUstep/ -lgnustep-base -fconstant-string-class=NSConstantString -objc2 
```

但没有任何改变。也许有人解决了同样的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T23:17:38.200

在我的 Ubuntu 系统上安装 libobjc2 后，您的 first.m 文件的副本将使用以下行为我编译：

```
clang first.m `gnustep-config --objc-flags` `gnustep-config --objc-libs` \
-I /usr/include/GNUstep/ -lgnustep-base 
```

但也许这只是命令行末尾的错字？

第一个示例末尾的 -objc 和第二个示例末尾的 -objc2 指示 clang 编译器分别创建名称为 bjc 和 bjc2 的可执行文件。你是说-lobj吗？我认为 obj 库中的链接对于获取 Objective-C 运行时库至关重要。即使使用 libobjc2 项目，生成的库仍然命名为 libobjc.so.xy 如果您的命令不包含 -lobjc，我看不出它如何正确链接。我可能是错的，但没有它对我不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:53:33.140

我不确定这是否适用于 GNUstep，但在 OS X 上，`-fobjc-arc`如果要使用 ARC 编译，则必须添加编译器标志。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T16:53:54.933

尝试用 GNUmakefile 构建它？

这是如何写一个。

[http://www.gnustep.it/nicola/Tutorials/WritingMakefiles/node2.html](http://www.gnustep.it/nicola/Tutorials/WritingMakefiles/node2.html)

可以像这样编译和链接

clang first.m -c -MMD -MP -DGNUSTEP -DGNUSTEP_BASE_LIBRARY=1 -DGNU_GUI_LIBRARY=1 -DGNU_RUNTIME=1 -DGNUSTEP_BASE_LIBRARY=1 -fobjc-runtime=gnustep-1.7 -fno-strict-aliasing -fexceptions -fobjc-exceptions -D_NATIVE_OBJC_EXCEPTIONS -fobjc-nonfragile-abi -D_NONFRAGILE_ABI -pthread -fPIC -DDEBUG -fno-omit-frame-pointer -Wall -DGSWARN -DGSDIAGNOSE -Wno-import -g -fgnu-runtime -fconstant-string-class=NSConstantString -I。-I/usr/local/include -o obj/first.obj/first.mo

clang -rdynamic -pthread -shared-libgcc -fexceptions -fobjc-nonfragile-abi -fgnu-runtime -o obj/first ./obj/first.obj/first.mo -L/usr/local/lib -lgnustep-base - lobjc -lm

取决于你如何配置 GNUstep make 包。

# asp.net - 如何让列表视图进入选定项目模板

> ID：14921485
> 
> 赞同：1
> 
> 时间：2013-02-17T13:16:26.867
> 
> 标签：asp.net, events, listview, selectedindexchanged

我有一个带有 itemtemplate 和 Selecteditemtemplate 的列表视图。我有一个带有 commandname="Select" 的选择按钮。我无法将我的列表视图带入 selectedItem 模板。我的代码是 -

```
 <asp:ListView ID="Listview1" runat="server" DataKeyNames="BikeTypeId"    
        OnItemDeleted="delete" OnSelectedIndexChanged="ListView1_SelectedIndexChanged" 
   OnItemEditing="editing">
        <LayoutTemplate>
        <table>
            <tr>

            </tr>
            <asp:PlaceHolder ID="itemplaceholder" runat="server"></asp:PlaceHolder>
        </table>
        </LayoutTemplate>
    <ItemTemplate>
    <tr>
    <td> <%# DataBinder.Eval(Container.DataItem,"BikeTypeId") %></td>
    <td> <%# DataBinder.Eval(Container.DataItem,"Name") %></td>
    <td height="20px"> <%# DataBinder.Eval(Container.DataItem,"Description") %></td>
    <td><asp:Image ID="i" runat="server"   ImageUrl='<%# "Handler.ashx?b_id=" +      Eval     ("BikeTypeId") %> ' /></td>
  <td><asp:Button ID="select"  runat="server" CommandName="Select" Text="Select" /></td>
    </tr>

  </ItemTemplate>

 <SelectedItemTemplate>
  <tr bgcolor="yellow"></tr>            
  <td> <%# DataBinder.Eval(Container.DataItem,"BikeTypeId") %></td>
  <td> <%# DataBinder.Eval(Container.DataItem,"Name") %></td>
  <td height="20px"> <%# DataBinder.Eval(Container.DataItem,"Description") %></td>
  <td><asp:Image ID="i" runat="server"   ImageUrl='<%# "Handler1.ashx?b_id=" + Eval("BikeTypeId") %> ' /></td>
  <td><asp:Button ID="Edit" CommandName="Edit" runat="server" Text="Edit" /></td>
  <td><asp:Button ID="Delete" runat="server" Text="Delete" CommandName="Delete" /></td>
  </tr>   

  </SelectedItemTemplate>

 <EditItemTemplate>
 <tr>
 <td> <asp:Label ID="ID" runat="server" Text='<%# Bind("BikeTypeId") %>'><asp:Label></td>
 <td><asp:TextBox ID="Name" runat="server" Text='<%# Bind("Name") %>'>' ></asp:TextBox></td>
 <td><asp:TextBox ID="Des" runat="server" Text='<%# Bind("Descrription") %>' TextMode="MultiLine" ></asp:TextBox> </td>
  <td><asp:FileUpload runat="server" ID="File" /></td>
 <td><asp:Button ID="Update" runat="server" Text="Update" CommandName="Update" /></td>
  <td><asp:Button ID="Cancel" runat="server" Text="Cancel" CommandName="Cancel" /></td>
      </tr> 

    </EditItemTemplate> 
```

后面的代码是 -

```
 protected void ListView1_SelectedIndexChanged(object sender,   ListViewSelectEventArgs e)
     {
        Listview1.SelectedIndex = e.NewSelectedIndex;
        string id = Listview1.SelectedDataKey.Value.ToString();
        Response.Write(id);
        bind();} 
```

当我单击选择按钮时没有任何变化。请帮忙.....

# ember.js - 余烬js中的查询字符串

> ID：14921486
> 
> 赞同：1
> 
> 时间：2013-02-17T13:16:39.583
> 
> 标签：ember.js

我想构建类似于谷歌搜索的东西，顶部有不同的过滤器（文本搜索，按时间过滤......）。在底部用户可以有不同的视图，所以网页搜索、图片搜索、视频搜索......

我想底部视图将是不同的 ember 控制器。这是一个示例 jsFiddle。我有两个控制器，一个网络和一个图像，都从导航控制器获取数据。

[http://jsfiddle.net/FMk7R/](http://jsfiddle.net/FMk7R/)

我的导航控制器

```
App.NavigationController = Ember.ObjectController.extend({
    search: ''
}); 
```

其他控制器将获取信息并对其采取行动。

```
App.SearchController = Ember.ObjectController.extend({
    needs: ['navigation'],

    updateResults: function () {
        return this.get('controllers.navigation.search');
    }.property('controllers.navigation.search')
}); 
```

我想将这些过滤器放入查询字符串中，以便可以传递 url。我怎样才能实现类似的目标：

```
http://myApp/#/web?find=someText&date=lastMonth
http://myApp/#/image?find=otherText&date=lastYear 
```

这可以在ember中完成吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T10:31:05.290

目前它不受支持，但有计划在未来实施支持 - 请参阅他们[github 页面](https://github.com/emberjs/ember.js/issues/1773)上的最新问题。与此同时，该线程中的一个回复甚至实现了他们自己的支持，所以也许这值得研究。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-25T13:24:48.057

我刚刚为此发布了一个库，但是它目前仅适用于历史位置。见[https://github.com/alexspeller/ember-query](https://github.com/alexspeller/ember-query)

# oracle - ORACLE：在 SELECT 语句中使用函数返回的列名

> ID：14921490
> 
> 赞同：1
> 
> 时间：2013-02-17T13:16:52.363
> 
> 标签：oracle, function, plsql

我想自动将列别名分配给多个列。我的表通常至少有 20 列。我试图避免写“column1 AS XXX_column1，column2 AS XXX_column2 ... x20”之类的东西。

我是 PLSQL 的新手，但我希望在标准 SELECT 子句中直接使用函数返回的乘法“列 AS XXX_column”的输出。

所以我写了一个函数（RETURN数据类型是VARCHAR2）来生成一个列名。我想直接在我的 SELECT 语句中使用它。下面是一个简化的例子：

- - 功能

```
CREATE OR REPLACE FUNCTION simple RETURN varchar2 IS
BEGIN
  RETURN ‘my_column’;
END simple; 
```

- - 选择

```
SELECT simple FROM my_table; 
```

这不起作用。似乎函数的输出作为引号传递，即

```
SELECT ‘my_column’ FROM my_table; 
```

所以 SELECT 的输出是一个填充了 my_table 值的行列表：

```
COLUMN  simple
ROW1    my_column
ROW2    my_column
ROW3    my_column 
```

请有人帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:50:41.820

```
CREATE OR REPLACE FUNCTION simple RETURN varchar2 IS
BEGIN
  RETURN ‘my_column’;
END simple;

--- Select
DECLARE
    myCol VARCHAR2(128);
BEGIN
    myCol := simple;
    EXECUTE IMMEDIATE 'SELECT ' || myCol || ' FROM my_table';
END; 
```

# php - 服务层是我所有真实方法的所在吗？

> ID：14921492
> 
> 赞同：1
> 
> 时间：2013-02-17T13:16:55.343
> 
> 标签：php, oop, domain-driven-design, datamapper

从我读过的所有教程中，服务层似乎只有一两个方法，所以我不确定服务是否应该只是轻量级/瘦身，而不是胖，有尽可能多的方法

如果我有一个`Post`域对象并且有一个`PostService`类，那么如果你想删除一个帖子，你应该从控制器中执行以下操作：

```
$postService = $this->serviceFactory->build('post');
$postService->deletePost($id); 
```

`deletePost()`里面的方法是`PostService`这样的：

```
$postMapper = $this->dataMapperFactory->build('post');
$post = $postMapper->fetchById($id);
// Check if the post exists
// Check if it belongs to this user
// Some other checks
$postMapper->delete($post); 
```

那是对的吗？本质上，域对象只是值对象，所有工作都在服务层完成吗？

任何帮助都会非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:37:00.670

看来，您的那部分问题实际上出在映射器中。恕我直言，映射器不应该负责创建域对象。因此，您的示例代码实际上应该更像：

```
$mapper = $this->dataMapperFactory->build('post');
$post = $this->domainObjectFactory->build('post');

$post->setId( $id );
$mapper->fetch($post);
// Check if the post exists
// Check if it belongs to this user
// Some other checks
$postMapper->delete($post); 
```

此外，大多数“其他检查”实际上都是在域对象上完成的。例如：

```
if ( $post->belongsTo($user) )
{
    ...
} 
```

服务的作用是“应用程序逻辑”，它是描述域对象和映射器之间交互的术语。服务与其他服务交互也很常见。

### 作为旁注

拥有一个`PostService`对我来说毫无意义。服务应该代表模型层中领域业务逻辑的主要部分。

*   你有`Recognition`service 而不是`UserService`and `LoginService`。
*   你有`Content`服务而不是`DocumentService`and `CommentService`and`UserService`

哦.. 而且，您不再需要添加`..Service`或`..Controller`后缀。PHP 现在有命名空间。

# php - 想要遍历我从 facebook Graph Api - Oauth2.0 带回来的这个对象数组

> ID：14921494
> 
> 赞同：1
> 
> 时间：2013-02-17T13:17:30.900
> 
> 标签：php, facebook-graph-api, multidimensional-array, oauth-2.0, iteration

```
 $education = $user->education;

    Array ( [0] => stdClass Object ( [school] => stdClass Object ( [id] => 112629628784911 [name] => Vardhman Shiksha Mandir ) [year] => stdClass Object ( [id] => 136328419721520 [name] => 2009 ) [type] => High School ) [1] => stdClass Object ( [school] => stdClass Object ( [id] => 115934828416686 [name] => jamia hamdrad ) [concentration] => Array ( [0] => stdClass Object ( [id] => 187549374618419 [name] => B.Tech Computer Science ) ) [type] => College ) [2] => stdClass Object ( [school] => stdClass Object ( [id] => 133233016699548 [name] => Hamdard University ) [type] => College [classes] => Array ( [0] => stdClass Object ( [id] => 196267900399898 [name] => 2nd year [with] => Array ( [0] => stdClass Object ( [id] => 553736429 [name] => Ahmed Abdul Zahra ) ) [from] => stdClass Object ( [id] => 553736429 [name] => Ahmed Abdul Zahra ) ) ) ) [3] => stdClass Object ( [school] => stdClass Object ( [id] => 104008189635968 [name] => Jamia Hamdard ) [year] => stdClass Object ( [id] => 138879996141011 [name] => 2013 ) [type] => Graduate School ) ) 
```

我试过用嵌套的foreach循环迭代它..

```
 foreach($education as $educationFirstArray){
     foreach($educationFirstArray as $educationSecondArray){
        foreach($educationSecondArray as $key=>$value){
         echo "<strong>".$key."</strong> -> ".$value."<br/>";
        }
     }
   } 
```

输出：

```
 id -> 112629628784911
 name -> Vardhman Shiksha Mandir
 id -> 136328419721520
 name -> 2009

 Warning: Invalid argument supplied for foreach() in index.php on line 73
  id -> 115934828416686
   name -> jamia hamdrad

 Catchable fatal error: Object of class stdClass could not be converted to string in     index.php on line 74 
```

任何有关使该数组高于迭代的帮助都将非常可观，在此先感谢..

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:37:00.590

首先，我必须说，这个数据结构非常复杂。数组或对象乱七八糟。反正..

我认为您需要一个简单地遍历所有数据结构的递归函数；

```
function looper($input) {
    foreach ($input as $key => $val) {
        // control here
        if (is_array($val) || is_object($val)) {
            looper($val);
        } else {
            printf("%s -> %s\n", $key, $val);
        }
    }
}

// call
looper($education); 
```

输出;

```
ID -> 112629628784911
名称-> Vardhman Shiksha Mandir
ID -> 136328419721520
名称 -> 2009
类型 -> 高中
ID -> 115934828416686
名称->贾米亚·哈姆德拉德
ID -> 187549374618419
名称 -> B.Tech 计算机科学
类型 -> 学院
ID -> 133233016699548
名称 -> 哈姆达德大学
类型 -> 学院
ID -> 196267900399898
姓名 -> 第二年
编号 -> 553736429
名称 -> 艾哈迈德·阿卜杜勒·扎赫拉
编号 -> 553736429
名称 -> 艾哈迈德·阿卜杜勒·扎赫拉
ID -> 104008189635968
名称 -> 杰米亚·哈姆达德
ID -> 138879996141011
名称 -> 2013
类型 -> 研究生院

```

这是您的数据结构的模拟，它给出了您自己的相同打印；

```
$education = array(
    (object) array(
        'school' => (object) array('id' => '112629628784911', 'name' => 'Vardhman Shiksha Mandir'),
        'year' => (object) array('id' => '136328419721520', 'name' => '2009'),
        'type' => 'High School'
    ),
    (object) array(
        'school' => (object) array('id' => '115934828416686', 'name' => 'jamia hamdrad'),
        'concentration' => array(
            (object) array('id' => '187549374618419', 'name' => 'B.Tech Computer Science')
        ),
        'type' => 'College'
    ),
    (object) array(
        'school' => (object) array('id' => '133233016699548', 'name' => 'Hamdard University'), 
        'type' => 'College', 
        'classes' => array (
            (object) array('id' => '196267900399898', 'name' => '2nd year', 
                'with' => array((object) array('id' => 553736429, 'name' => 'Ahmed Abdul Zahra')),
                'from' => (object) array('id' => 553736429, 'name' => 'Ahmed Abdul Zahra')
            )
        )
    ),
    (object) array(
        'school' => (object) array('id' => '104008189635968', 'name' => 'Jamia Hamdard'),
        'year' => (object) array('id' => '138879996141011', 'name' => 2013),
        'type' => 'Graduate School'
    ) 
); 
```

# python - xml中的Python编码问题

> ID：14921496
> 
> 赞同：0
> 
> 时间：2013-02-17T13:18:07.963
> 
> 标签：python, xml, utf-8, decode, encode

我有一个媒体播放器，我想将我正在播放的内容发送到 trakt.tv，除了标题/路径中的外国字母外，一切正常。系统运行python 2.7.3

```
def getStatus(self,ip,timeout=10.0):
    oPchStatus = PchStatus()
    try:
        oResponse = urlopen("http://" + ip + ":8008/playback?arg0=get_current_vod_info",None,timeout)
        oPchStatus = self.parseResponse(oResponse.readlines()[0])
    return oPchStatus 
```

这将返回类似这样的东西。

```
<?xml version="1.0"?>
<theDavidBox>
  <request>
    <arg0>get_current_vod_info</arg0>
    <module>playback</module>
  </request>
  <response>
    <currentStatus>pause</currentStatus>
    <currentTime>3190</currentTime>
    <downloadSpeed>0</downloadSpeed>
    <fullPath>/opt/sybhttpd/localhost.drives/HARD_DISK/Storage/NAS/Videos/FILMS/A.Haunted.House.(2013)/A Haunted House.avi</fullPath>
    <lastPacketTime>0</lastPacketTime>
    <mediatype>OTHERS</mediatype>
    <seekEnable>true</seekEnable>
    <title/>
    <totalTime>4860</totalTime>
  </response>
  <returnValue>0</returnValue>
</theDavidBox> 
```

下一步采用上述方法并将每个项目分配给一个变量。

```
class PchStatus:
    def __init__(self):
        self.status=EnumStatus.NOPLAY
        self.fullPath = u""
        self.fileName = u""
        self.currentTime = 0
        self.totalTime = 0
        self.percent = 0
        self.mediaType = ""
        self.currentChapter = 0 # For Blu-ray Disc only
        self.totalChapter = 0 # For Blu-ray Disc only
        self.error = None

class PchRequestor:

    def parseResponse(self, response):
        oPchStatus = PchStatus()
        try:
            response = unescape(response)
            oXml = ElementTree.XML(response)
            if oXml.tag == "theDavidBox": # theDavidBox should be the root
                if oXml.find("returnValue").text == '0' and int(oXml.find("response/totalTime").text) > 90:#Added total time check to avoid scrobble while playing adverts/trailers
                    oPchStatus.totalTime = int(oXml.find("response/totalTime").text)
                    oPchStatus.status = oXml.find("response/currentStatus").text
                    oPchStatus.fullPath = oXml.find("response/fullPath").text
                    oPchStatus.currentTime = int(oXml.find("response/currentTime").text) 
```

等等。使用上面返回的 xml，

oPchStatus.totalTime 为“4860” oPchStatus.status 为“暂停” oPchStatus.fullPath 为“/opt/sybhttpd/localhost.drives/HARD_DISK/Storage/NAS/Videos/FILMS/A.Haunted.House.(2013) /A Haunted House.avi" oPchStatus.currentTime 将是 "3190"

就像我说的那样，这在标题中出现外国字母之前效果很好。像 Le.Fabuleux.Destin.d'Amélie.Poulain.(2001).avi 这样的标题将使 oPchStatus.fullPath 包含字符串“/opt/sybhttpd/localhost.drives/HARD_DISK/Storage/NAS/Videos/Le.Fabuleux。 Destin.d'Am\xe9lie.Poulain.(2001).avi"

并不是

“/opt/sybhttpd/localhost.drives/HARD_DISK/Storage/NAS/Videos/Le.Fabuleux.Destin.d'Amélie.Poulain.(2001).avi”

正如我想要的那样。

进一步在脚本中有例程来扫描 xml 文件的文件名并创建 FILENAME.watched 所以我需要文件名与实际文件名匹配，而不是替换任何字母。

确保正确编码这些类型的文件名的最佳方法是什么？我试图提供尽可能多的信息，但如果您需要更多信息，请询问。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:33:35.390

Python 只是通过向您显示字符的转义码来使您的字符串值以 ASCII 可打印`é`，`\xe9`.

关于链接源代码的一些注释：

*   您不应该*将*要解析的响应转换为 unicode。*改为解析原始字节*。解析器希望自己解码内容。事实上，ElementTree 解析器将**再次对数据进行编码，**以便能够对其进行解析。

*   当您在字节串中有 XML 时，我会改用该`ElementTree.fromstring()`函数；是的，在它下面`ElementTree.XML()`像你一样使用，但是记录在案`fromstring()`的[API](http://docs.python.org/2/library/xml.etree.elementtree.html#parsing-xml)。

否则，您的示例输入将*完全按照应有*的方式工作。如果我在文件路径中使用非 ASCII 字符从您的示例创建 XML 文档，我会得到以下信息：

```
>>> tree = ElementTree.fromstring(response)
>>> print tree.find("response/fullPath").text
/opt/sybhttpd/localhost.drives/HARD_DISK/Storage/NAS/Videos/Le.Fabuleux.Destin.d'Amélie.Poulain.(2001).avi
>>> tree.find("response/fullPath").text
u"/opt/sybhttpd/localhost.drives/HARD_DISK/Storage/NAS/Videos/Le.Fabuleux.Destin.d'Am\xe9lie.Poulain.(2001).avi" 
```

如您所见，`unicode()`结果中`.text`包含一个`é`字符（Unicode 代码点 U+00E9，LATIN SMALL LETTER E WITH ACUTE）。当打印为 Python 文字时，Python 通过为我提供该代码点的 Python 转义码来确保它可以在 ASCII 上下文中打印，`\xe9`. **这是正常**的，没有任何损坏。

# javascript - chrome.extension.getBackgroundPage() 一段时间后返回 null

> ID：14921500
> 
> 赞同：4
> 
> 时间：2013-02-17T13:18:32.157
> 
> 标签：javascript, google-chrome-extension, null

当我的 chrome 扩展在 chrome 启动时加载时，一切似乎都正常，并且 chrome.extension.getBackgroundPage() 返回正确的值（从 popup.js 午餐）。但过了一会儿（2-3 分钟），特别是如果不考虑浏览器，该函数返回 null。只有关闭和重新打开 chrome 才能解决问题。我试图通过以下方式操纵它：

```
if (chrome.extension.getBackgroundPage() == null) window.location.reload(true); 
```

正如在[Why does chrome.extension.getBackgroundPage() return null 中所建议的那样？](https://stackoverflow.com/questions/7971566/chrome-extension-getbackgroundpage-returns-null-why)，这有时会有所帮助，但大多数时候它只是不断刷新应用程序，因此必须关闭 chrome。有人知道可能出了什么问题吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-02T14:47:35.240

根据引用的页面（[事件和背景页面之间的区别](https://developer.chrome.com/extensions/event_pages.html)），有一个更好的选择来获取背景，同时仍然使用事件页面：

> 如果您的扩展使用 extension.getBackgroundPage，请改用 runtime.getBackgroundPage。较新的方法是异步的，因此如果需要，它可以在返回之前启动事件页面。

这对我来说效果很好，只需在异步回调中完成你的工作，它接收背景页面作为函数参数。

这是方法[runtime.getBackgroundPage的规范](https://developer.chrome.com/extensions/runtime.html#method-getBackgroundPage)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T17:24:47.430

将您的背景（事件页面）更改为真实的背景页面。

修改清单文件

```
"background": {
        "scripts": [
            "background.js"
        ],
        "persistent": false
    } 
```

**至**

```
"background": {
        "scripts": [
            "background.js"
        ],
        "persistent": true
    } 
```

事件页面与背景页面非常相似，但有一个重要区别：事件页面仅在需要时加载。当事件页面没有主动做某事时，它会被卸载，释放内存和其他系统资源。

# 参考

*   [事件页面和背景页面之间的区别](https://developer.chrome.com/extensions/event_pages.html)

# java - 从 main 方法访问 java jTextField

> ID：14921505
> 
> 赞同：-1
> 
> 时间：2013-02-17T13:18:47.317
> 
> 标签：java, swing, netbeans, applet, awt

我使用netbeans在swing中创建了GUI，其中java文件的结构层次如下，

```
public class NewJFrame extends javax.swing.JFrame
    private void initComponents
-->         jTextField1 = new javax.swing.JTextField();

    public static void main
         // one thread 
-->              jTextField1.setText("abc"); 
```

因此在主函数内部的线程中设置 jTextField1 的值时，会发生错误**"Non-static variable jTextField1 cannot be reference from static context"**。

我只想访问那个特定**的****jTextField1 的**值，我不想在主函数中创建一个新的 TextField 对象。

我可以从按钮的点击事件中访问文本文件，

并且在 jList1 中添加/删除项目时会发生同样的错误，因此有任何解决方案可以**访问**main() 函数中的该控件吗？

我有java的基本知识，我正在将vb6中的项目切换到java......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:22:51.073

错误说明了一切 - > **Non-static variable jTextField1 cannot be reference from static context**。
`jTextfield1`是非静态的，为了从静态上下文（此处`main`方法）访问它，您需要该类的对象引用。

尝试这个：

```
NewJFrame obj = new NewJFrame();
obj.jTextField1.setText("abc"); 
```

应使用对象访问实例字段

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:24:52.640

想过阅读摇摆包吗？学习足够的知识来制作基本的窗口和文本字段并自己与它们交互并不难，而不是使用 netbeans。

一个技巧可能是将您的 GUI 分成一个类，在其中创建 getter 和 setter。在另一个类中创建一个 GUI 类对象并实例化它......然后通过它并使用 setter 方法来操作文本字段等。有很多方法可以做到这一点，但我认为你需要在我看来阅读它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T13:21:54.513

您可以更改`jTextField1`为静态或在内部实例化它`main`

移动这一行：

```
JTextField jTextField1 = new javax.swing.JTextField(); 
```

发挥`main`作用。

# c# - 使用实体框架对 WCF Rest 服务进行单元测试

> ID：14921510
> 
> 赞同：-1
> 
> 时间：2013-02-17T13:19:16.823
> 
> 标签：c#, .net, wcf, entity-framework, rest

我创建了一个 wcf 休息服务并添加了一个实体框架数据库，在对某些方法进行单元测试时遇到了问题。我收到错误断言连接字符串不存在或无效。我正在使用实际的数据库进行测试。首先，我将web.config文件复制到测试项目中，还有什么我需要做的吗，比如编辑这个配置文件

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:23:02.810

假设你的测试项目不是 web 项目，记得将配置文件重命名为 app.config

# ruby-on-rails - Rails 3 路由错误，带有 Devise::OmniauthCallbacksController 的用户类

> ID：14921512
> 
> 赞同：1
> 
> 时间：2013-02-17T13:19:25.590
> 
> 标签：ruby-on-rails, devise, routing

我正在尝试为我的用户创建个人资料页面，但由于路由错误，我在用户登录后就卡住了。即使我尝试加载第一页，我也会再次遇到同样的问题。当我执行 rake 路由时，我得到这些用户路径：

```
new_user_session GET    /users/sign_in(.:format)               devise/sessions#new
            user_session POST   /users/sign_in(.:format)               devise/sessions#create
    destroy_user_session DELETE /users/sign_out(.:format)              devise/sessions#destroy
 user_omniauth_authorize        /users/auth/:provider(.:format)        users/omniauth_callbacks#passthru {:provider=>/facebook|twitter/}
  user_omniauth_callback        /users/auth/:action/callback(.:format) users/omniauth_callbacks#(?-mix:facebook|twitter)
           user_password POST   /users/password(.:format)              devise/passwords#create
       new_user_password GET    /users/password/new(.:format)          devise/passwords#new
      edit_user_password GET    /users/password/edit(.:format)         devise/passwords#edit
                         PUT    /users/password(.:format)              devise/passwords#update
cancel_user_registration GET    /users/cancel(.:format)                devise/registrations#cancel
       user_registration POST   /users(.:format)                       devise/registrations#create
   new_user_registration GET    /users/sign_up(.:format)               devise/registrations#new
  edit_user_registration GET    /users/edit(.:format)                  devise/registrations#edit
                         PUT    /users(.:format)                       devise/registrations#update
                         DELETE /users(.:format)                       devise/registrations#destroy

users GET    /users(.:format)                       users#index
                         POST   /users(.:format)                       users#create
                new_user GET    /users/new(.:format)                   users#new
               edit_user GET    /users/:id/edit(.:format)              users#edit
                    user GET    /users/:id(.:format)                   users#show
                         PUT    /users/:id(.:format)                   users#update
                         DELETE /users/:id(.:format)                   users#destroy 
```

这就是我的 Users::OmniauthCallbacksController 的样子：

```
class Users::OmniauthCallbacksController < Devise::OmniauthCallbacksController
  def facebook
    @user = User.find_for_facebook_oauth(request.env["omniauth.auth"], current_user)
    if @user.persisted?
      sign_in_and_redirect @user, :event => :authentication
      set_flash_message(:notice, :success, :kind => "Facebook") if is_navigational_format?
    else
      session["devise.facebook_data"] = request.env["omniauth.auth"]
      redirect_to new_user_registration_url
    end
  end
end 
```

我不确定这一点，但我认为我应该创建一个用户控制器，我可以在其中实现设备之外的方法。这是它的样子：

```
class UsersController < ApplicationController

    def index
        @users = User.all

        respond_to do |format|
      format.html # index.html.erb
      format.json { render json: @ingredients }
    end
    end

    def profile
        @user = current_user

        respond_to do |format|
      format.html 
      format.json { render json: @ingredients }
    end
    end

    def show
        @user = User.find(params[:id])

        respond_to do |format|
      format.html 
      format.json { render json: @ingredients }
    end
    end

end 
```

在我的 routes.rb 我有以下用户相关的行：

```
devise_for :users, :controllers => { :omniauth_callbacks => "users/omniauth_callbacks" }
resources :users 
```

现在，如果我在用户登录时加载第一页，我会收到错误消息：

```
Routing Error

No route matches {:action=>"show", :controller=>"users"}" 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T14:17:23.030

“设计用户”和“用户”都试图控制“/用户”路线。解决这个问题的最简单方法是告诉设计使用前缀：

```
devise_for :users, 
  :path_prefix => 'auth', 
  :controllers => {
    :omniauth_callbacks => "users/omniauth_callbacks" 
  }
resources :users 
```

现在设计身份验证将发布到“auth_users”，并且您的 CRUD 仍将对“/users”执行

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T15:23:47.260

`routes.rb`下面是使用 Devise 和自定义用户控制器时的示例文件。我遇到了一些路径冲突的问题，我希望请求转到我的用户控制器，但他们却要改为设计。

我对注册 URL 有一些具体问题。您可能必须对遇到问题的 URL 执行类似的操作，或者您可能只需指定自定义用户控制器的最后一行即可。

```
Railsappname::Application.routes.draw do
  root :to => "home#index"

  devise_for :users, :skip => [:sessions, :registrations]

  devise_scope :user do
    # make some pretty URLs
    get "login" => "devise/sessions#new", :as => :new_user_session
    post 'login' => 'devise/sessions#create', :as => :user_session
    delete "logout" => "devise/sessions#destroy", :as => :destroy_user_session
    # rewrite the registrations URLs so they don't collide with my custom Users Controller
    get "signup" => "devise/registrations#new", :as => :new_user_registration
    put "update-registration" => "devise/registrations#update", :as => :update_user_registration
    delete "delete-registration" => "devise/registrations#destroy", :as => :delete_user_registration
    get "edit-registration" => "devise/registrations#edit", :as => :edit_user_registration
    get "cancel-registration" => "devise/registrations#cancel", :as => :cancel_user_registration
    post "create-registration" => "devise/registrations#create", :as => :user_registration
  end

  resources :users, :controller => "users"
end 
```

# symfony - Symfony 和 JMSSerializerBundle

> ID：14921513
> 
> 赞同：1
> 
> 时间：2013-02-17T13:19:28.537
> 
> 标签：symfony, jmsserializerbundle

我在使用 JMSSerializerBundle 时遇到了两个问题（但我是 php 编程的菜鸟，当然还有 symfony ..）。

所以.. 让我们从第一个更紧急的开始：序列化/反序列化日期。

我的服务接受格式为“yyyy-mm-dd”的日期参数（格式为“通用”。我的意思是 4 位数的年份、2 位数的月份和 2 位数的日期）。

我必须反序列化和序列化它。所以..因为我认为注释可能更容易我添加了`* @SerializerAnnotation\Type("DateTime<'Y-m-d'")`注释......它不起作用，文档说我应该使用双引号来指定格式，但如果我这样做，就会发生解析异常。

有什么建议吗？我也可以尝试 .yml 配置，但我不知道把它放在哪里..

第二：当我创建一个`Person`对象（PO​​ST 操作）时，我也有一个密码字段。所以我想反序列化它。当然我不想反序列化它。有没有办法指定一个排除策略用于序列化和另一个用于反序列化？

编辑：目前我删除了捆绑包并手动从数组映射到我的对象（反之亦然）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-18T08:49:02.963

似乎您忘记写“大于”字符来完成格式部分：

```
* @SerializerAnnotation\Type("DateTime<'Y-m-d'>") 
```

至于排除方法，请查看 JMS 食谱上的[排除策略](http://jmsyst.com/libs/serializer/master/cookbook/exclusion_strategies)章节！

# php - 如何限制上传中的文件类型，使其不包含 php 脚本

> ID：14921517
> 
> 赞同：0
> 
> 时间：2013-02-17T13:19:49.877
> 
> 标签：php

我们有一个免费的分类部分，用户可以在其中上传图片，如果在其中上传 php 文件，如何限制用户显示错误

我们尝试设置一个如果 $StrFiles 等于 text/php，它不会执行并且仍然上传一个 php 文件。如何阻止它。请建议

```
 $FILE_PATH="uploads/classifieds/ads";
        $StrFiles="";
        $StrFiles2="";

        if((file_exists($_FILES['pic']['tmp_name']))){
            if($_FILES['pic']['name']!="")
                {
                $dt = time()."s";
                if(!JFile::upload($_FILES['pic']['tmp_name'],$FILE_PATH.JFile::makeSafe($dt."_".$_FILES['pic']['name']))){
                        return JError::raiseWarning( 500, "Unable To upload File".$_FILES['pic']['name']);
                    }else{
                        $StrFiles=JFile::makeSafe($dt."_".$_FILES['pic']['name']);
                    }
                }
        }
        if((file_exists($_FILES['pic2']['tmp_name']))){
            if($_FILES['pic2']['name']!=""){
                $dt = time()."s";
                if(!JFile::upload($_FILES['pic2']['tmp_name'],$FILE_PATH.JFile::makeSafe($dt."_".$_FILES['pic2']['name']))){
                        return JError::raiseWarning( 500, "Unable To upload File".$_FILES['pic2']['name']);
                    }else{
                        $StrFiles2=JFile::makeSafe($dt."_".$_FILES['pic2']['name']);
                    }
                }
        }

           if ($StrFiles =="text/php")
             {
            echo "No PHP files<br>";
             $ok=0;
              } 

            if ($StrFiles2 =="text/php")
              {
            echo "No PHP files<br>";
            $ok=0;
              }              

    if($StrFiles){
        $pic= $StrFiles;
    }
    if($StrFiles2){
        $pic2= $StrFiles2;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:25:20.900

由于您使用的是 Joomla，您可以定义所有允许的图像扩展名的列表，然后用于`JFile::getExt($filename)`检查扩展名是否属于允许的扩展名。

例如

```
$allowed = array('jpg', 'png');
if(in_array(JFile::getExt($filename), $allowed) {
} 
```

# c - C++ 从串口输出可读的十六进制代码

> ID：14921521
> 
> 赞同：1
> 
> 时间：2013-02-17T13:20:18.417
> 
> 标签：c, serial-port, hex

我在这里得到了一些从串行设备读取输出的 C 代码。我目前正在使用 perl 从设备读取数据并且工作正常，但我更愿意用 C 编写一些东西来完成同样的工作。

这是我到目前为止得到的代码；

```
#include<stdio.h>   /* Standard input/output definitions */
#include<stdlib.h>
#include<string.h>  /* String function definitions */
#include<unistd.h>  /* UNIX standard function definitions */
#include<fcntl.h>   /* File control definitions */
#include<errno.h>   /* Error number definitions */
#include<termios.h> /* POSIX terminal control definitions */
#include<string.h>
#include<unistd.h>

char *buf;
int fd; /* File descriptor for the port */
int i,n;

int open_port(void)
{
    fd = open("/dev/ttyUSB1", O_RDWR | O_NOCTTY | O_NDELAY);

if (fd == -1)     {
    perror("cannot open");
}
else
    fcntl(fd, F_SETFL, 0);
struct termios options;
tcgetattr(fd, &options);
cfsetispeed(&options, B38400);
cfsetospeed(&options, B38400);
options.c_cflag |= (CLOCAL | CREAD);
tcsetattr(fd, TCSANOW, &options);
options.c_cflag &= ~CSIZE;
options.c_cflag &= ~PARENB;
options.c_cflag &= ~CSTOPB;
options.c_cflag &= ~CSIZE;
options.c_cflag |= CS8;
//    options.c_cflag |= (IXON | IXOFF | IXANY); // xon & xoff on
return (fd);
}

int main(int argc) {
    buf=malloc(4095);
    open_port();
    free(buf);
    while(1){
        read(fd,buf,128);
         printf("%s\n",buf);
    }
    close(fd);
} 
```

当我编译并运行它时输出数据，但我看到的数据是垃圾格式......我想看到的是可读的十六进制数据，如 0AEA4E2A ......任何人都知道如何轻松地将数据转换为可读的十六进制代码？我已经在谷歌上搜索了一段时间，但似乎没有什么能真正完成这项工作。

这就是我在 perl 中所做的；

```
while ($timeout>0) {
        my ($count,$saw)=$PortObj->read(1); # will read _up to_ 255 chars
        if ($count > 0) {
                $chars+=$count;
                $buffer.=$saw; my $hex = unpack 'H*', $saw; printf ($hex); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T13:31:00.690

大概你想要“统一”的十六进制代码，必要时用零填充，并且你还想打印**所有**数据（`"%s"`格式说明符需要一个以 NUL 结尾的字符串，所以如果你的二进制数据中有零，那将不起作用当然）：

```
read(fd, buf, 128);
int i;
for (i = 0; i < 128; i++) {
    printf("%02x ", buf[i]);
} 
```

您还需要声明`buf`为`unsigned char *;`，并且您还应该始终检查 . 的返回值`read()`。

# delphi - 包含非可视组件的类的声明

> ID：14921526
> 
> 赞同：0
> 
> 时间：2013-02-17T13:20:42.173
> 
> 标签：delphi, components

我正在编写一个类来控制和处理设备的输入和输出。部分 I/O 将通过串行端口进行，为此我使用了 Comport 库（Tcomport，Dejan Crnila）。Tcomport 和 TcomDataPacket 组件被声明为 TComponent 后代。

然后将我自己的类声明为：

1.  一个简单的类（ TThingy = 类）
2.  一个组件（TThingy = 类（TComponent）

如果是 1)，我应该将什么传递给 TComPort.create 调用？目前我打算手动处理实例的创建和释放。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T13:31:14.800

*   如果您希望用户能够将其中一个组件放到表单上，或者允许使用该`TComponent`机制处理所有权，那么从`TComponent`.
*   否则，派生自`TObject`。

创建框架`Owner`时指定一个是可选的。`TComponent`如果你想退出，那么只需传递`nil`给 a 的构造函数`TComponent`。当你这样做时，你就获得了组件的所有权，`Free`当你完成它时调用它是你的工作。

所以，我怀疑你想做的是像这样声明你的类：

```
type
  TThingy = class
  private
    FComport: TComport;
  public
    constructor Create;
    destructor Destroy; override;
  end;

....

constructor TThingy.Create;
begin 
  inherited;
  FComport := TComport.Create(nil);
end;

destructor TThingy.Destroy;
begin
  FComport.Free;
  inherited;
end; 
```

# c# - 在 windows mobile 6 中检索 NMEA 数据

> ID：14921527
> 
> 赞同：1
> 
> 时间：2013-02-17T13:21:04.433
> 
> 标签：c#, gps, windows-mobile-6

我想从我的集成 gps 硬件中检索数据..我已经阅读了有关 stackoverflow 的更多帖子，但我没有找到 c# 源代码。非常感谢...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T17:44:02.270

在这里查看我的 GPSsample [http://www.hjgode.de/wp/2010/06/11/enhanced-gps-sample-update/](http://www.hjgode.de/wp/2010/06/11/enhanced-gps-sample-update/)

获取原始 NMEA 数据的线索是使用 GPSID 直接端口。它在注册表中编码：

```
 private string GetGPSPort()
    {
        string szStr="";
        if (Registry.GetStringValue(Registry.HKLM,
                        "System\\CurrentControlSet\\GPS Intermediate Driver\\Multiplexer",
                        "DriverInterface",
                        ref szStr)
            == 0)
        {
            return szStr;
        }
        else 
        {
            if (Registry.GetStringValue(Registry.HKLM,
                "System\\CurrentControlSet\\GPS Intermediate Driver\\Drivers",
                "CurrentDriver",
                ref szStr) == 0)
            {
                string szPath = "System\\CurrentControlSet\\GPS Intermediate Driver\\Drivers\\" + szStr;
                if (Registry.GetStringValue(Registry.HKLM, szPath, "CommPort", ref szStr) == 0)
                {
                    return szStr;
                }
            }
        }
        return "";
    } 
```

以上给出了可用于打开和读取 RAW NMEA 数据的端口名称。

以上假设设备支持 MS GPSID。

此外，还有两种使用原始端口的可能性：a) 使用串行通信或 b) 使用流。访问和读取方法都在可通过网站获得的完整源代码中使用。

# php - 图像转入 js iframe

> ID：14921529
> 
> 赞同：0
> 
> 时间：2013-02-17T13:21:08.173
> 
> 标签：php, javascript, image, iframe

我在 js 中设置了一个 iframe ... iframe 加载了一个显示的 url，我可以在该 iframe 顶部添加一个徽标图像，以便 iframe 的 hte 页面内容位于后面，而我的徽标位于该 iframe 顶部？

代码 ：

```
var filePath = 'https://blablabla.com';
var iframe='<iframe id="frame" name="widget" src ="#" width="100%" height="1" margin=auto frameborder="no" scrolling="no"></iframe>';
document.write(iframe);
var myIframe = parent.document.getElementById("frame");
myIframe.height = 1280;
myIframe.width = 1024;
myIframe.src = filePath; 
```

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:33:33.717

你不能为此使用 CSS 绝对定位吗？

像这样：http: [//jsfiddle.net/MPPqV/](http://jsfiddle.net/MPPqV/)

```
img {
    position: absolute;
    top: 0;
    left: 0;
    width: 200px;
} 
```

# c++ - 通过new和allocator分配内存有什么区别

> ID：14921531
> 
> 赞同：5
> 
> 时间：2013-02-17T13:21:18.017
> 
> 标签：c++, memory-management, stl, allocator

`new`通过/`malloc`和分配内存有什么区别`allocator`？

`new`如果我们有 和 的选项，为什么我们需要一个单独的内存分配器来分配向量`malloc`？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T15:25:20.493

当您使用 new 或 malloc 时，内存管理硬连接到编译器运行时中的相应函数。相反，当使用分配器时，内存管理被委托给分配器，分配器是可交换的。这允许您更改使用的内存管理功能。

拥有这种额外级别的抽象和控制是有充分理由的。例如，请参阅： [自定义 C++ STL 分配器的引人注目的示例？](https://stackoverflow.com/questions/826569/compelling-examples-of-custom-c-stl-allocators).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T15:22:13.117

呃，我认为`new`和`malloc`是不同的，`allocator`提供不同的功能。`malloc`返回未初始化的数据，并`calloc`返回*零*数据。但是`new`，如果您正在创建某个类的实例（不是`int`，`bool`这些*原始*类型，顺便说一下，它们也可以被初始化），则会调用构造函数。`delete`会调用析构函数，而`free`不会。

至于`allocator`，它为用户提供了一个抽象层。`allocator`可以返回构造的对象、未初始化的内存空间，或者销毁对象或释放空间。STL 容器用于`allocator` 获取内存空间和创建对象。

但请注意，由于`allocator`可以自定义， an`allocator`不一定像`new`/那样管理内存`delete`。它可以创建一大块内存然后做一些*分配缓存*。*它可以返回映射到磁盘上文件的区域中的内存地址，以便内部数据在被上层容器*修改时进入文件系统。它也可以调用`new`来获取内存。通过这种方式，`allocator`使用户能够构建位于内存特定区域的容器。所以，有了`allocator`s，容器的内部逻辑就和内存存储的管理方式分离了。

实际上，您可以编写一个派生类`std::allocator`来实现上述每个功能。

* * *

您可能想阅读[这篇](http://www.drdobbs.com/the-standard-librarian-what-are-allocato/184403759)文章以获得关于 s 的更详细的讨论`allocator`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T15:25:55.803

在`allocator`类中有一个`allocate()`，它接受两个参数，如下所示：

```
pointer allocate (size_type n, allocator<void>::const_pointer hint=0); 
```

根据[allocate() 的参考，](http://www.cplusplus.com/reference/memory/allocator/allocate/)提示参数可用于通过提及您需要分配与指定内存相邻的新内存块来提高性能。所以我相信使用提示你可以分配块，使得它们像数组一样是连续的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T15:40:44.307

分配器是内存管理器。例如，STL 容器提供默认分配器，但可以按照本文（STL 分配器教程）中的说明自定义它们：http: [//www.codeguru.com/cpp/cpp/cpp_mfc/stl/article.php/c4079 /分配器-STL.htm](http://www.codeguru.com/cpp/cpp/cpp_mfc/stl/article.php/c4079/Allocators-STL.htm)。

# ruby-on-rails - rails 教程预期的带有文本的 css 标题以返回某些内容

> ID：14921541
> 
> 赞同：0
> 
> 时间：2013-02-17T13:22:12.883
> 
> 标签：ruby-on-rails, ruby, rspec, capybara, railstutorial.org

我正在研究 ruby​​.railstutorial.org 上的 RoR 教程，目前正在阅读第 4 章。测试没有验证，我不知道为什么。我的规范文件的顶部看起来像这样。其他方法看起来都与 Help 相同：

```
describe "StaticPages" do
 let(:page_title) {"Ruby on Rails Tutorial Sample App"}
 let(:h1_test) {"should have the h1"}
 let(:title_test) {"should have the title"}
 describe "Home page" do |title_test, h1_test|
  it "#{h1_test} 'Sample App'" do
   visit '/static_pages/home'
   page.should have_selector('h1',:text=>'Sample App')
  end

  it "#{title_test} 'Home'" do
   visit '/static_pages/home'
   page.should have_selector('title', :text=> '#{page_title}')
  end

  it "should not have a custom page title" do
   visit '/static_pages/home'
   page.should_not have_selector('title', :text=> '| Home')
  end
end

describe "Help page" do |title_test, h1_test|
 it "#{h1_test} 'Help'" do
  visit '/static_pages/help'
  page.should have_selector('h1', :text =>'Help')
 end

 it "#{title_test} 'Help'" do
  visit '/static_pages/help'
  page.should have_selector('title',
    :text=>'#{page_title} | Help')
 end
end 
```

我的 application_helper.rb：

```
module ApplicationHelper
  def full_title(page_title)
    base_title = "Ruby on Rails Tutorial Sample App"
  if page_title.empty?
    base_title
  else
    "#{base_title} | #{page_title}"
    end
  end
end 
```

我的 application.html.haml 文件：

```
!!!
%html
  %head
    %title= full_title(yield(:title))
    = stylesheet_link_tag "application", :media => "all"
    = javascript_include_tag "application"
    = csrf_meta_tags
  %body= yield 
```

现在 4 个错误是相同的减去一个单词的变化，所以我只发布一个：

```
 1) StaticPages Contact#<Class:0x0000000446e818> 'Contact'
     Failure/Error: page.should have_selector('title', :text=>'#{page_title} | Contact')
       expected css "title" with text "\#{page_title} | Contact" to return something
     # ./spec/requests/static_pages_spec.rb:65:in `block (3 levels) in <top (required)>' 
```

我很困惑，因为我只是直接从指南中复制它，而不是使用 haml 并在我的规范文件中添加前几行以最小化重复文本。我没有包含页面 html 文件，因为我看不出它们是如何成为问题的。特别是因为 home.html.haml 不像`- provide(:title, 'Home')`其他的那样，但仍然抛出与上面相同的错误。任何帮助将不胜感激！

编辑：这是我的 Gemfile：

```
 gem 'rails',       '3.2.12'
  gem 'haml',        '4.0.0'
group :development, :test do
  gem 'sqlite3',     '1.3.5'
  gem 'rspec-rails', '2.11.0'
  gem 'haml-rails',  '0.4'
  gem 'guard-rspec', '1.2.1'
  gem 'guard-spork', '1.4.2'
  gem 'spork',       '0.9.2'
end
group :assets do
  gem 'sass-rails',  '3.2.5'
  gem 'coffee-rails','3.2.2'
  gem 'uglifier',    '1.2.3'
end

gem 'jquery-rails',  '2.0.2'

group :test do
  gem 'capybara',    '1.1.2'
  gem 'rb-inotify',  '0.8.8'
  gem 'libnotify',   '0.5.9'
end

group :production do
  gem 'pg',          '0.12.2'
end 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T14:06:41.127

确保您使用的是`Capybara`版本`1.*`（如教程中所用）。的新版本`Capybara`，从 开始`2.0`，改变了它检查页面内容的方式。现施工

```
page.should have_selector(selector, :text=> text) 
```

仅适用于可见 DOM 元素（`h1`、`p`、`span`等），但不适用于不可见元素，如`title`or `script`。

您可以`Capybara`在`Gemfile`

```
group :test do
  gem 'capybara', '1.1.2'
end 
```

或修改您的测试：

```
page.source.should have_selector(selector, :text=> text) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-19T09:58:17.710

我解决了这个问题。`'#{page_title}'`我说它应该在哪里`"#{page_title}"`。双引号而不是单引号 -_-。有人可以告诉我为什么会这样吗？特别是因为我`'Sample App'`在同一个 have_selector 检查中有类似的东西，并且不会引发任何类型的错误。希望这至少对将来的某人有所帮助。

# jaxb - 将 XmlIDREF/XmlID 与接口和泛化一起使用时出现 EclipseLink 错误 50035

> ID：14921547
> 
> 赞同：1
> 
> 时间：2013-02-17T13:22:44.677
> 
> 标签：jaxb, eclipselink, moxy

我正在尝试 `@XmlIDREF`参考方法。注释是：

```
 /**
   * getter for Attribute/List<Attribute> attributes
   * @return attributes
   */
  @XmlElementWrapper(name="attributes")
  @XmlElements({
    @XmlElement(name="Attribute", type=AttributeJaxbDao.class)
  })
  @XmlIDREF
  public List<Attribute> getAttributes() { 
```

这导致错误消息：

```
javax.xml.bind.JAXBException: 
Exception Description: Since the property or field [attributes] is set as XmlIDREF, the target type of each XmlElement declared within the XmlElements list must have an XmlID property.  Please ensure the target type of XmlElement [Attribute] contains an XmlID property.
 - with linked exception:
[Exception [EclipseLink-50035] (Eclipse Persistence Services - 2.3.2.v20111125-r10461): org.eclipse.persistence.exceptions.JAXBException
Exception Description: Since the property or field [attributes] is set as XmlIDREF, the target type of each XmlElement declared within the XmlElements list must have an XmlID property.  Please ensure the target type of XmlElement [Attribute] contains an XmlID property.]
    at org.eclipse.persistence.jaxb.JAXBContext$TypeMappingInfoInput.createContextState(JAXBContext.java:832)
    at org.eclipse.persistence.jaxb.JAXBContext.<init>(JAXBContext.java:143) 
```

虽然`AttributeJaxbDao`有注释：

```
 /**
   * getter for xsd:string/String id
   * @return id
   */
  @XmlAttribute(name="id")  
  @XmlID
  public String getId() { 
```

`@XmlIDREF`“标准使用” /有两个不同之处`@XmlID`：

1.  AttributeJaxbDao 是派生类——注解在超类中
2.  `@XmlElement`属性是一个接口 - 类型已在注释中专门命名为 AttributeJaxbDao.class

在这种情况下如何出现错误？有没有办法解决这个问题。我想避免被迫不使用接口和泛化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T12:17:48.553

**注意：** 我是[**EclipseLink JAXB (MOXy)**](http://www.eclipse.org/eclipselink/moxy.php)负责人，也是[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)专家组的成员。

不幸的是，我们阻止了这个用例正常工作的 2 个错误。

*   [http://bugs.eclipse.org/401074](http://bugs.eclipse.org/401074)
*   [http://bugs.eclipse.org/401294](http://bugs.eclipse.org/401294)

这些错误已在 EclipseLink 2.4.2 和 2.5.0 流中得到修复。这些流目前正在开发中，可以从以下链接下载每晚构建的版本（从 2013 年 2 月 22 日开始）：

*   [http://www.eclipse.org/eclipselink/downloads/nightly.php](http://www.eclipse.org/eclipselink/downloads/nightly.php)

* * *

**完整示例**

下面是一个比您问题中给出的模型稍微复杂一点的模型，我将用它来证明现在一切正常。

***富***

该类`Foo`有两个类型的属性`List<Attribute>`，`Attribute`一个是接口。两者都带有注释，`@XmlElements`其中包含`@XmlElement`指定具体类型的注释。该`attributeRefs`属性也用 注释`@XmlIDREF`。

```
import java.util.*;
import javax.xml.bind.annotation.*;

@XmlRootElement
public class Foo {

    @XmlElementWrapper(name="Attributes")
    @XmlElements({
        @XmlElement(name="AttributeFoo", type=AttributeJaxbDao.class),
        @XmlElement(name="AttributeBar", type=AttributeJaxbDao2.class)
      })
    List<Attribute> attributes = new ArrayList<Attribute>();;

    @XmlElementWrapper(name="AttributeRefs")
    @XmlElements({
      @XmlElement(name="AttributeRefFoo", type=AttributeJaxbDao.class),
      @XmlElement(name="AttributeRefBar", type=AttributeJaxbDao2.class)
    })
    @XmlIDREF
    List<Attribute> attributeRefs = new ArrayList<Attribute>();

} 
```

***属性***

`Attribute`只是一个非常简单的界面。

```
public interface Attribute {

} 
```

***属性JaxbDao***

这是一个`Attribute`包含一个注释的字段的实现，注释`@XmlID`将利用该字段`@XmlIDREF`。

```
import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class AttributeJaxbDao implements Attribute {

    @XmlAttribute(name="id")  
    @XmlID
    String id;

    String name;

} 
```

***属性JaxbDao2***

这也是一个`Attribute`具有用 注释的字段的实现`@XmlID`。

```
import javax.xml.bind.annotation.*;

@XmlAccessorType(XmlAccessType.FIELD)
public class AttributeJaxbDao2 implements Attribute {

    @XmlAttribute(name="id")  
    @XmlID
    String id;

    String name;

} 
```

**演示**

下面是一些演示代码，您可以运行这些代码来证明一切正常：

```
import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Foo.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum14921547/input.xml");
        Foo foo = (Foo) unmarshaller.unmarshal(xml);

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(foo, System.out);
    }

} 
```

***输入.xml/输出***

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<foo>
    <Attributes>
        <AttributeFoo id="a">
            <name>A</name>
        </AttributeFoo>
        <AttributeBar id="b">
            <name>B</name>
        </AttributeBar>
        <AttributeFoo id="c">
            <name>C</name>
        </AttributeFoo>
    </Attributes>
    <AttributeRefs>
        <AttributeRefFoo>a</AttributeRefFoo>
        <AttributeRefBar>b</AttributeRefBar>
        <AttributeRefFoo>c</AttributeRefFoo>
    </AttributeRefs>
</foo> 
```

# windows-phone-7 - 通话结束后如何启动应用程序？

> ID：14921548
> 
> 赞同：1
> 
> 时间：2013-02-17T13:22:47.270
> 
> 标签：windows-phone-7, windows-phone-8, windows-phone

我是从 android 来到 wp 开发的——所以我还在用 android 的方式思考。可能是个问题。

所以。

我想创建一个每次用户结束通话时启动的应用程序。有什么方法可以收听“通话结束”事件吗？

在android中它很容易实现（使用启动活动的服务） - 但是有没有办法在windows phone中做同样的事情（至少在wp8中）

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T22:24:41.220

从当前 SDK 开始，Windows Phone 中没有“通话结束”事件。

Windows Phone 应用程序在封闭环境中运行，因此某些功能对通用开发人员是封闭的，就像您要查询的那样！

# android - 按键不工作

> ID：14921551
> 
> 赞同：3
> 
> 时间：2013-02-17T13:23:29.610
> 
> 标签：android

嗨，我想在每次按键时从其他文本框的输入中填充一个文本框，但这没有发生。代码是这样的

```
leftside.setOnKeyListener(new OnKeyListener()
    {

        @Override
        public boolean onKey(View arg0, int arg1, KeyEvent arg2) 
        {
            if(arg2.getAction() == KeyEvent.ACTION_DOWN)
            {
                Log.v("keyevent", "down");
                float value = Float.parseFloat(leftside.getText().toString());
                rightside.setText(String.valueOf(SelectConverter(Float.parseFloat(leftside.getText().toString()))));
            }
            // TODO Auto-generated method stub
            return false;
        }

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:35:48.293

> 嗨，我想在每次按键时从其他文本框的输入中填充一个文本框，但这没有发生。代码是这样的

我建议您使用`TextChangedListener`with`TextWatcher`而不是`KeyListener`. 我认为它更适合用于实现您的目标并且使用它更舒适。

这是示例：

*   [`Android EditText text change listener example`](http://www.mysamplecode.com/2012/06/android-edittext-text-change-listener.html)

# django - Rest Framework 序列化器方法

> ID：14921552
> 
> 赞同：11
> 
> 时间：2013-02-17T13:23:31.073
> 
> 标签：django, django-models, django-rest-framework

我有以下使用[Django REST Framework](http://www.django-rest-framework.org/api-guide/fields/#serializermethodfield)的序列化程序。

这是我目前所拥有的......

**序列化程序.py**

```
class ProductSerializer(serializers.ModelSerializer):

    score = serializers.SerializerMethodField('get_this_score')

    class Meta:
        model = Product
        fields = ('id', 'title', 'active', 'score')

    def get_this_score(self, obj):

        profile = Profile.objects.get(pk=19)
        score = [val for val in obj.attribute_answers.all() if val in profile.attribute_answers.all()]
        return (len(score)) 
```

**网址.py**

```
 url(r'^products/(?P<profile_id>.+)/$', ProductListScore.as_view(), name='product-list-score'), 
```

这段代码存在一些问题。

1）婴儿车 pk=19 是硬编码的，`self.kwargs['profile_id'].`我应该已经尝试过，但我不知道如何将 kwarg 传递给方法，并且无法让 profile_id 工作。即我无法从 url 获取它。

2）这些代码中的任何一个都应该在模型中吗？我尝试添加到模型，但再次可以传递参数。

**models.py** 即方法类

```
 def get_score(self, profile):

        score = [val for val in self.attribute_answers.all() if val in 
profile.attribute_answers.all()]
            return len(score) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-17T14:00:32.200

序列化程序被传递一个上下文字典，其中包含视图实例，因此您可以通过执行以下操作来获取 profile_id：

```
view = self.context['view']
profile_id = int(view.kwargs['profile_id']) 
```

但是在这种情况下，我认为您不需要这样做，因为 'obj' 在任何情况下都会设置为配置文件实例。

是的，您可以将“get_this_score”方法放在模型类上。您仍然需要“SerializerMethodField”，但它会简单地调用“return obj.get_this_score(...)”，从序列化器上下文中设置任何参数。

请注意，序列化程序上下文还将包括“请求”，因此如果需要，您还可以访问“请求.用户”。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2015-01-08T04:12:17.733

要回答 jason 对 Tom 的回答的问题，您可以像这样通过相同的上下文机制访问请求对象。您从 ModelMethod 定义中引用请求对象，而不是传递它们。我能够使用它来访问当前的 request.user 对象，如下所示：

```
class ProductSerializer(serializers.ModelSerializer):
    score = serializers.SerializerMethodField('get_this_score')

    class Meta:
        model = Product
        fields = ('id', 'title', 'active', 'score')

    def get_this_score(self, obj):

        profile = self.context['request'].user
        score = [val for val in obj.attribute_answers.all() if val in profile.attribute_answers.all()]
        return (len(score)) 
```

# android - 'Android API 版本 2.1' 没有 webview 吗？

> ID：14921553
> 
> 赞同：-1
> 
> 时间：2013-02-17T13:23:35.260
> 
> 标签：android, android-webview, android-sdk-2.1

我的测试手机版本是 Android api 2.1 。我想知道 webview 是在 api 2.1 中运行的。因此，我试图在下面的代码，但它没有运行。

调色板（当您可以看到 activity_main.xml GraphicalLayout 时）没有 webview 控件。但是，4.0版本有它。所以我输入了 XmlCode，但显示消息“找不到以下类：-webview（修复构建路径，编辑 XML）”

你知道如何在api 2.1中操作webview吗？

ps）我尝试重新启动eclipse并清理项目。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:layout_height="fill_parent" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_centerHorizontal="true"
    android:layout_centerVertical="true"
    android:text="@string/hello_world"
    tools:context=".MainActivity" />
<webview android:id="@+id/webview" android:layout_width="fill_parent" android:layout_height="fill_parent"> 
```

```
import android.app.Activity;
import android.os.Bundle;
import android.view.Menu;
import android.webkit.WebView;
public class MainActivity extends Activity {
    WebView webview;
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        webview = (WebView) findViewById(R.id.webview);
        webview.getSettings().setJavaScriptEnabled(true);
        webview.loadUrl("http://google.com");  
    }
    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-17T13:31:06.443

布局 XML 区分大小写。您应该使用的正确 XML 如下所示：

```
<WebView
    android:id="@+id/webview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:28:54.327

文档 ( [http://developer.android.com/reference/android/webkit/WebView.html](http://developer.android.com/reference/android/webkit/WebView.html) ) 说 WebView 从 API 1 开始就可用。

您可能还有其他问题 - API 从一开始就支持这一点。

# php - preg_match_all 模式 html 标记问题

> ID：14921566
> 
> 赞同：0
> 
> 时间：2013-02-17T13:25:47.283
> 
> 标签：php, regex, preg-match-all

有 4 个不同的 img 标签

```
<img src="img1.jpg" alt="test" />
<img src="img2.jpg" height="21"/>
<img src="img3.jpg" border="1">
<img src="img4.jpg" > 
```

我使用 PHP 代码

```
preg_match_all('#<img (.*?)([/>| />|>| >])#si',$this->Data,$img); 
```

但是这个 PHP 代码结果

```
Array
  (
[1] => Array
    (
        [0] => src="img1.jpg"
        [1] => src="img2.jpg"
        [2] => src="img3.jpg"
        [3] => src="img4.jpg"

    ) 
```

我想要结果：

```
 Array
  (
[1] => Array
    (
        [0] => src="img1.jpg" alt="test"
        [1] => src="img2.jpg" height="21"
        [2] => src="img3.jpg" border="1"
        [3] => src="img4.jpg"

    ) 
```

你能帮我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:34:25.387

试试这个：

```
preg_match_all('#<img (.*?)\s?/?>#is', $this->Data, $img); 
```

`\s?`可选地匹配由可选斜杠 sollowed 的空格`/?`。

这将基本上从格式良好的 img 标签中获取任何内容。（假设您在属性值中没有任何 >）。

作为要记住的事情，正则表达式不是解析 html 的正确工具 - 但对于小型 - 有限 - 匹配非常有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:53:15.723

这看起来像是给了你想要的东西；

```
$s = '<img src="img1.jpg" alt="test" />
      <img src="img2.jpg" height="21"/>
      <img src="img3.jpg" border="1">
      <img src="img4.jpg" >';
preg_match_all('~<img\s+(.+?)([\s/>]|)>~i', $s, $m);
print_r($m); 
```

出去;

```
大批
(
    ...
    [1] => 数组
        (
            [0] => src="img1.jpg" alt="测试"
            [1] => src="img2.jpg" height="21"
            [2] => src="img3.jpg" 边框="1"
            [3] => src="img4.jpg"
        )

```

顺便说一句，据我所知，你不需要使用`s`flag for `preg_match_all`，因为它是 matching `*_all`。

# c# - .Net MySQL 通用 CRUD 存储库

> ID：14921567
> 
> 赞同：0
> 
> 时间：2013-02-17T13:25:56.947
> 
> 标签：c#, mysql, .net, vb.net, repository

是否可以在不依赖任何第三方 ORM 的情况下在 VB.Net 中为 MySQL 连接创建通用 CRUD 存储库？

我的意思是，MySQL CRUD 依赖于字符串来识别您想要访问的表和字段，同时我们拥有的是一个 .Net 对象。

实现这一目标的唯一方法是使用 ORM 和/或反射类吗？我们不能对对象或字符串做点什么来相互匹配吗？

假设我有这个存储库接口：

```
public interface IRepository<T> where T:class
{
    void Insert(T entity);
    void Delete(T entity);
    IQueryable<T> GetAll();
    T GetById(string id);
} 
```

看到这个界面后，我想到的是为我的每个对象创建一个个人存储库，即使 CRUD 方法非常相似。

例如，我必须为 Employee CRUD 创建一个存储库。

```
class EmployeeRepository : IRepository<Employee>
{
    private string _query;

    public IQueryable<Employee> GetAll(Employee entity)
    {
        _query = "SELECT * FROM tbl_msemployee";
        //Do query here, which will eventually return a list of Employee object
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-25T17:47:44.080

我想最好使用现有的 ORM 来处理 CRUD 操作。然后，您在这个 orm 层之上构建您的存储库（可能是 t4 或其他代码生成）和您的服务层。

# ruby - 在 Module#included 中的 class_eval 中定义类变量

> ID：14921569
> 
> 赞同：5
> 
> 时间：2013-02-17T13:26:17.373
> 
> 标签：ruby, mongodb

如何在 class_eval 块中定义类变量？我有以下内容：

```
module Persist
    def self.included(base)
        # base is the class including this module
        base.class_eval do
            # class context begin
            @@collection = Connection.new.db('nameofdb').collection(self.to_s.downcase)
            def self.get id # Class method
                #...
            end
        end
    end
    # Instance methods follow
    def find
        @@collection.find().first
        #...
    end
end

class User
    include Persist
end

class Post
    include Persist
end 
```

User 和 Post 类都`:get`在使用`User.methods`or进行内省时显示`Post.methods`。这是有道理的，因为它们是在 class_eval 的上下文中定义的，并且正是我所需要的。同样，该方法`:find`显示为各个类的 instance_method。

然而，我认为是一个类变量，即`@@collection`，原来是一个模块级别的class_variable。当我反省`User.class_variables`or`Post.class_variables`时，它们变成了空的。然而`Persist.class_variables`显示`:@@collection`。

**这怎么可能？块内的上下文不是`class_eval`类的上下文。那么变量不应该`@@collection`在类而不是模块上定义吗？**

此外， 的值`@@collection`始终是包含它的最后一个类的名称。所以在这种情况下，它始终是“帖子”，而不是“用户”。我认为这是因为它是一个模块级变量，它会在每次包含时发生变化。它是否正确？

*最后，我将如何在这种情况下定义一个类变量，以便每个类都有自己的`@@collection`定义。*

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T14:55:41.720

一种方法是为类变量创建访问器方法。

```
module Persist
    def self.included(base)
        # Adds class methods from 'ClassMethods' to including class.
        base.extend(ClassMethods)
        base.class_eval do
            self.collection = Connection.new.db('nameofdb').collection(self.to_s.downcase)
            # ...
        end
    end
    module ClassMethods
        def collection=(value)
            @@collection = value
        end
        def collection
            @@collection
        end
    end
    # Instance methods follow
    def find
        self.class.collection.find().first
        #...
    end
end

class User
    include Persist
end

class Post
    include Persist
end 
```

另一种方法是通过访问器**class_variable_set**等访问模块中包含类的类变量。

```
def self.included(base)
    base.class_eval do
        class_variable_set('@@collection', Connection.new.db('nameofdb').collection(self.to_s.downcase))
        # …
    end
end 
```

我将尝试回答您的问题“这怎么可能？class_eval 块中的上下文不是类的上下文。”

class_eval方法确实使**self****引用**它在给定块内被调用的类。这允许您调用类方法等。但是，类变量将在块绑定到的上下文中进行评估 - 这里是模块。

 **例如，尝试这样做：

```
class Foo
    @@bar = 1
end

Foo.class_eval { puts @@bar } 
```

这将导致异常“NameError: uninitialized class variable @@bar in Object”。这里给定的块绑定到顶级命名空间“Object”的上下文。**

# django - 没有找到带有参数'（''，）'和关键字参数'{}'的'forum'的Django错误反转

> ID：14921572
> 
> 赞同：0
> 
> 时间：2013-02-17T13:26:42.453
> 
> 标签：django

我正在使用本教程[http://lightbird.net/dbe/forum1.html制作一个简单的论坛](http://lightbird.net/dbe/forum1.html)

我遇到了这个错误，我不知道该怎么办。你能帮我解决这个错误吗

```
 NoReverseMatch at /forum/post/reply/1/

  Reverse for 'forum' with arguments '('',)' and keyword arguments '{}' not found.

  Request Method:   GET
  Request URL:  http://127.0.0.1:8000/forum/post/reply/1/
  Django Version:   1.4.3
  Exception Type:   NoReverseMatch
  Exception Value:  

  Reverse for 'forum' with arguments '('',)' and keyword arguments '{}' not found.

  Exception Location:   C:\Python26\Lib\site-packages\django\template\defaulttags.py in render, line 424
  Python Executable:    C:\Python26\python.exe

  Error during template rendering

  In template C:\djcode\mysite\forum\templates\forum\post.html, error at line 1
  Reverse for 'forum' with arguments '('',)' and keyword arguments '{}' not found.

  1     <a href="{% url ben:forum forum_pk %}">&lt;&lt; back to list of topics</a> 
```

我的 Post.html 是

```
 <a href="{% url ben:forum forum_pk %}">&lt;&lt; back to list of topics</a> 
```

我的观点是：

```
 from django.core.urlresolvers import reverse
 from mysite.settings import MEDIA_ROOT, MEDIA_URL
 from forum.models import Forum
 from django.shortcuts import render_to_response
 from forum.models import Thread
 from django.core.paginator import Paginator, InvalidPage, EmptyPage
 from django.core.context_processors import csrf
 from forum.models import Post

 def main(request):
     """Main listing."""
     forums = Forum.objects.all()
     return render_to_response("forum/list.html", dict(forums=forums,   user=request.user))
 def forum(request, pk):
          """Listing of threads in a forum."""
     threads = Thread.objects.filter(forum=pk).order_by("-created")
     threads = mk_paginator(request, threads, 20)
     return render_to_response("forum/forum.html", add_csrf(request, threads=threads, pk=pk))
 def thread(request, pk):
     """Listing of posts in a thread."""
     posts = Post.objects.filter(thread=pk).order_by("created")
     posts = mk_paginator(request, posts, 15)
     title = Thread.objects.get(pk=pk).title
     return render_to_response("forum/thread.html", add_csrf(request, posts=posts, pk=pk,
         title=title, media_url=MEDIA_URL))
 def add_csrf(request, ** kwargs):
     d = dict(user=request.user, ** kwargs)
     d.update(csrf(request))
     return d

 def mk_paginator(request, items, num_items):
     """Create and return a paginator."""
     paginator = Paginator(items, num_items)
     try: page = int(request.GET.get("page", '1'))
     except ValueError: page = 1

     try:
         items = paginator.page(page)
     except (InvalidPage, EmptyPage):
         items = paginator.page(paginator.num_pages)
     return items
 def post(request, ptype, pk):
     """Display a post form."""
     action = reverse("ben:%s" % ptype, args=[pk])
     if ptype == "new_thread":
         title = "Start New Topic"
         subject = ''
     elif ptype == "reply":
         title = "Reply"
         subject = "Re: " + Thread.objects.get(pk=pk).title

     return render_to_response("forum/post.html", add_csrf(request, subject=subject,
    action=action, title=title))
 def new_thread(request, pk):
     """Start a new thread."""
     p = request.POST
     if p["subject"] and p["body"]:
         forum = Forum.objects.get(pk=pk)
         thread = Thread.objects.create(forum=forum, title=p["subject"], creator=request.user)
         Post.objects.create(thread=thread, title=p["subject"], body=p["body"], creator=request.user)
     return HttpResponseRedirect(reverse("ben:forum", args=[pk]))

 def reply(request, pk):
     """Reply to a thread."""
     p = request.POST
     if p["body"]:
         thread = Thread.objects.get(pk=pk)
         post = Post.objects.create(thread=thread, title=p["subject"], body=p["body"],
             creator=request.user)
     return HttpResponseRedirect(reverse("ben:thread", args=[pk]) + "?page=last") 
```

我的网址：

```
 from django.conf.urls import patterns,include,url
 from django.contrib import admin
 from django.conf import settings

 urlpatterns = patterns('forum.views',
                        url(r'^$','main',name='main'),
                        url("^forum/(\d+)/$", "forum",name ="forum"),
                        url("^thread/(\d+)/$","thread",name = "thread"),
                        url(r"^post/(new_thread|reply)/(\d+)/$", "post",name = "post"),
                        url(r"^reply/(\d+)/$", "reply" , name ="reply"),
                        url(r"^new_thread/(\d+)/$", "new_thread" , name ="new_thread"),
 ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:39:38.633

这有点令人困惑，这`'('',)'`意味着`url`参数列表由一个空字符串组成，就好像模板是`{% url ben:forum '' %}`. 没有您的视图代码，就不可能知道它是如何发生的。

既然您发布了所有观点，我们仍然不知道是哪一个导致了错误:) 但是，我们所知道的是，**它们都没有**`forum_pk`将上下文变量传递给`render_to_response`.

是`post`吗？您需要弄清楚论坛 pk 并将其传递给您的模板：

```
 def post(request, ptype, pk):
     """Display a post form."""
     action = reverse("ben:%s" % ptype, args=[pk])
     if ptype == "new_thread":
         title = "Start New Topic"
         subject = ''
         forum_pk = pk
     elif ptype == "reply":
         title = "Reply"
         thread = Thread.objects.get(pk=pk)
         forum_pk = thread.forum.pk
         subject = "Re: " + thread.title

     return render_to_response("forum/post.html", add_csrf(request, subject=subject,
         action=action, title=title, forum_pk=forum_pk)) 
```

我不赞成这种`post`视图设计，这`pk`意味着不同的东西取决于`ptype`. 然而，如果`ptype`is `new_thread`，我们已经有了`forum_pk`as `pk`。如果是`reply`，我们需要获取`Thread`by `pk`，并获取主题论坛的`pk`as `forum_pk`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-01T22:14:23.057

除了添加`forum_pk = pk`

我调整了一个回复：

forum_pk = Thread.objects.get(pk=pk).forum.pk

# javascript - KnockoutJs 和 JSON 数据模型的剖析

> ID：14921574
> 
> 赞同：0
> 
> 时间：2013-02-17T13:26:56.663
> 
> 标签：javascript, jquery, asp.net-mvc, knockout.js, knockout-2.0

我已经开始探索 KnockoutJS 只是为了看看我是否可以将它与我的 ASP.NET MVC 应用程序一起使用。我正在努力找出许多灰色地带。我必须承认更多，因为我对 JSON 的理解很差，如果我没有错，那也可能是因为特别是 ASP.NET JSON 格式，或者我完全错了，无论我需要答案。

我只想知道如何复制 ASP.NET MVC 通过 $.get 返回的数据模型。通过 JavaScript 模型。

1.  一个简单的对象
2.  嵌套/复杂对象

代码：

```
list = ko.observableArray([]);
ko.applyBindings(list);

function loadTeamMembers(projectId) {
    $.ajax({
        type: "GET",
        url: "/Project/GetTeamMembers?projectId=" + projectId,

        success: function (data) {

            $(data).each(function (index, item) {
                list.push(item);
            });
        }
    });
}

loadTeamMembers(6); 
```

我在我的表上使用了上面的代码，我将它与 Knockout 列表（有效）进行了数据绑定。如何在列表中添加/删除新项目？我希望我在客户端需要一个 JavaScript 模型。我应该如何在客户端上创建 JavaScript 模型（寻找上述两个示例）以便它与 ASP.NET MVC JSON 数据一起使用？

任何信息或链接将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T15:26:50.057

下面是一个使用带有附加函数的映射来操作模型内的集合的示例：

```
var MainViewModel = function (jsonObj) {
    //needed for accesing this inside functions
    var self = this;

    //Mapping from json object
    ko.mapping.fromJS(jsonObj, {}, self);

    //Additional properties that you might need Client-Side but that you don't have on your server viewModel
    self.CustomProperty = ko.observable();
    self.AnotherProperty = ko.observable();

    //Example of functions used to add or delete objects inside an observable array
    self.addRow = function () {
        self.loanEntries.push(new LoanEntryViewModel());
    };
    self.deleteRow = function (row) {
        self.loanEntries.remove(row);
    };
}; 
```

ko.mapping.fromJS 接受一个 json 对象并创建 ViewModel，而无需再次定义服务器端类的所有属性。我的控制器上通常有一个名为“GetMappingObject”的方法，它返回一个用于映射的空对象。

希望有帮助。请务必查看以下内容：

*   [http://learn.knockoutjs.com/](http://learn.knockoutjs.com/)
*   [http://www.knockmeout.net/2011/06/10-things-to-know-about-knockoutjs-on.html](http://www.knockmeout.net/2011/06/10-things-to-know-about-knockoutjs-on.html)
*   [http://pluralsight.com/training/courses/TableOfContents?courseName=knockout&highlight=steve-michelotti_knockoutjs-m1-intro](http://pluralsight.com/training/courses/TableOfContents?courseName=knockout&highlight=steve-michelotti_knockoutjs-m1-intro)
*   [http://pluralsight.com/training/courses/TableOfContents?courseName=knockout-mvvm&highlight=john-papa_knockout-mvvm-m1](http://pluralsight.com/training/courses/TableOfContents?courseName=knockout-mvvm&highlight=john-papa_knockout-mvvm-m1)

# meteor - Meteor js作为前端，后端有什么用？

> ID：14921576
> 
> 赞同：15
> 
> 时间：2013-02-17T13:27:22.240
> 
> 标签：meteor, backend

我想问一下创建 Meteor 后端的最佳实践。

我使用 Meteor js 作为前端，我计划在另一个端口使用一堆 apache/php/yii 框架/YiiMongoDbSuite 作为后端（管理面板）。

也许有人建议我最好的方法来轻松创建流星应用程序的管理部分？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-17T14:45:17.067

如果您已经在 PHP/Rails 等中构建了后端，则可以考虑使用 DDP 客户端或 REST 在流星和后端之间中继消息。[与 REST 相比， DDP](http://meteor.com/blog/2012/03/21/introducing-ddp)有几个优点

它是一个开放的连接，您甚至可以获取实时更新。

不过，我不确定是否有任何用于 PHP 的 DDP 客户端。有几个：

*   Nodejs ( [https://github.com/oortcloud/node-ddp-client](https://github.com/oortcloud/node-ddp-client) )
*   .NET ( [https://github.com/sonyarouje/DDPClient.NET](https://github.com/sonyarouje/DDPClient.NET) )
*   红宝石（[https://github.com/tmeasday/ruby-ddp-client](https://github.com/tmeasday/ruby-ddp-client)）
*   Python ( [https://github.com/meteor/meteor/tree/master/examples/unfinished/python-ddp-client](https://github.com/meteor/meteor/tree/master/examples/unfinished/python-ddp-client) )

您也可以使用[REST](https://github.com/tmeasday/meteor-router)进行通信，但您会错过很多功能。使用 DDP，您可以`Meteor.methods`非常轻松地访问和订阅。

最后，您可以直接连接到您的 mongodb 并将您的更改放入。 Meteor 将在 10 秒内处理它们。

*但是*为什么不使用 Meteor 本身作为后端呢？使用单独的 Meteor 实例可能会使您的管理区域更加安全。使用 Meteor 作为后端，维护起来会容易得多，您可以在两者之间共享兼容的代码。您可以使用[Meteor.connect](http://docs.meteor.com/#meteor_connect)访问客户端实例。

如果你的动机是安全，你可以这样做。当 Meteor 已经让它变得如此简单时，使用单独的语言和堆栈几乎没有任何好处。

**更新**：Meteor 0.7.0 引入了 oplog 拖尾功能，因此您不必再等待 10 秒才能看到更新。它们就像流星本身一样是瞬间的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-02T13:58:53.567

Meteor 直接监听 MongoDB 数据库，因此那里的任何更改都会自动更新应用程序。这意味着如果你想从 PHP 写入 MongoDB，你可以，然后流星将自动检测更改并更新字体结尾。

我相信这也适用于[numtel 的流星 mysql 包](https://github.com/numtel/meteor-mysql)。如果您想开始将流星用于需要实时更新或在项目中缓慢迁移的组件，这将变得非常容易。

我们目前正在为我们的实时通知系统尝试这个。我认为我们必须学习使用 DDP，但实际上它就像让两个系统都监听同一个数据库一样简单。

# c# - C#：在 datagridview 中捕获值无法正常工作

> ID：14921583
> 
> 赞同：1
> 
> 时间：2013-02-17T13:28:17.523
> 
> 标签：c#

我在 C# 中从 DataGridView 获取值时遇到了一些问题。

我目前正在使用此代码，例如：

```
private void GridView_Discount_CellContentClick(object sender, DataGridViewCellEventArgs e)
    {
        Label_DiscountID.Text = GridView_Discount.Rows[e.RowIndex].Cells[0].Value.ToString();
        Field_DiscountName.Text = GridView_Discount.Rows[e.RowIndex].Cells[1].Value.ToString();
        Field_DiscountRate.Text = GridView_Discount.Rows[e.RowIndex].Cells[2].Value.ToString();
    } 
```

...它确实有效。

但是，它仅在我单击具有值的单元格部分时才有效，但是当我单击单元格中的空白部分时，它不会捕获数据。我正在调整单元格的大小，使其适合 DataGridView 组件。

另外，我做了`SelectionMode`to `FullRowSelect`，所以一旦我点击其中一个单元格，它会选择整行，但是当我点击空白时它仍然不起作用。

任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:30:46.520

我建议你尝试处理[`CellClick`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellclick.aspx)而不是[`CellContentClick`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.cellcontentclick.aspx).

从链接，`CellClick`事件：

> 在单击单元格的任何部分时发生。

`CellContentClick`：

> 单击单元格内的内容时发生。

# vim - 如何关闭一个窗口并指定剩余窗口的扩展？

> ID：14921584
> 
> 赞同：2
> 
> 时间：2013-02-17T13:28:20.423
> 
> 标签：vim

是否可以在 vim 中关闭一个窗口并指定哪个将填充剩余空间？

假设有一个“six-pak”布局并关闭左上窗口 XI 想要设置底部窗口 (B) 将扩展并填充关闭窗口而不是右侧 (A) 占用的空间：

```
----------------------- //Closing top left window X
|       |       |     |
|    X  |   A   |     |
|       |       |     |
-----------------------
|       |       |     |
|   B   |       |     |
|       |       |     |
-----------------------

----------------------- //The desired result B is expanded upwards
|       |       |     |
|       |   A   |     |
|       |       |     |
|   B   |--------------
|       |       |     |
|       |       |     |
|       |       |     |
-----------------------

----------------------- //Actual result
|          |          |
|     A    |          |
|          |          |
-----------------------
|       |       |     |
|   B   |       |     |
|       |       |     |
----------------------- 
```

* * *

## 编辑

我正在寻找一个通用的解决方案，不一定要关闭左上角的窗口。我想指定任何相邻的窗口来填充当前窗口位置。这可能是关闭中间底部并指定右底部展开。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:42:40.470

试试这三个步骤：

1.  关闭左上角的窗口。

    :q

2.  移动到左下角的窗口。

    CTRL-W w CTRL-W w

3.  将左下窗口移至最左侧。

    CTRL-w H

然后，您可以将这些命令记录到寄存器中以保存击键，例如，

```
let @q = ":q^M^Ww^Ww^Ww^WH" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T15:15:31.393

如果您的光标在窗口中`X`：

```
Ctrl-W j Ctrl-W H Ctrl-W p :q 
```

如果您的光标可能在任何窗口中，请尝试：

```
Ctrl-W t Ctrl-W j Ctrl-W H Ctrl-W p :q 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T17:55:20.060

您可以在您的`~/.vimrc`:

```
map <F2> :q \| wincmd j \| wincmd H <CR> 
```

解释：

*   `map <F2>`- 按下即可使用的功能`F2`
*   `q`- 关闭当前窗口
*   `wincmd j`- 转到底部窗口
*   `wincmd H`- 将此（当前）窗口移动到最左侧

`\|`用于组合所有这些命令。

**来源**

*   [:帮助:\栏](http://vimdoc.sourceforge.net/htmldoc/cmdline.html#%3a%5Cbar)
*   [:help :wincmd](http://vimdoc.sourceforge.net/htmldoc/windows.html#%3awincmd)

# scala - Scala 选项映射到另一个选项

> ID：14921591
> 
> 赞同：1
> 
> 时间：2013-02-17T13:29:35.940
> 
> 标签：scala, option

从选项映射时，有没有办法避免将可能为空的结果包装在另一个选项中。

```
option.flatMap(arg => Option(arg.somePotentiallyNullValue)) 
```

例如像

```
option.optionMap(arg => arg.somePotentiallyNullValue ) 
```

我的代码库中只有很多 Java 代码，这意味着永远将映射的结果包装在进一步的 Option 调用中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:37:26.280

从可空类型隐式转换到`Option`? 在范围内的某处声明：

```
implicit def toOption[T](x: T) : Option[T] = Option(x) 
```

稍后编译器会弄清楚：

```
option.flatMap(_.somePotentiallyNullValue) 
```

由于`flatMap`期望`Option[T]`作为结果值，编译器使用`toOption`如下隐式转换：

```
option.flatMap(arg => toOption(arg.somePotentiallyNullValue)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T16:00:58.293

为了使事情变得更容易，您可以引入一种新类型：

```
implicit class CheckedOption[T](val option:Option[T])

object CheckedOption {
  @inline implicit def toOption[T](checkedOption:CheckedOption[T]):Option[T] =
    checkedOption.option.flatMap(Option.apply)
} 
```

然后在您的代码中，在您使用选项实例的地方执行以下操作：

```
def use(o:CheckedOption[String]) = {
  o map { value =>
    value + "-Some"
  } getOrElse "None"
}

val option1:Option[String] = Some(null)
val option2:Option[String] = Some("foo")

use(option1) //> res0: String = None
use(option2) //> res1: String = foo-Some 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T15:16:01.583

工厂方法`Option`将 a`null`变成 a `None`：

```
scala> val os1: Option[String] = Option(null)
os1: Option[String] = None 
```

**附录**

我可能误解了你的问题...

如果您明智地限制其范围，则可以使用隐式转换：

```
scala> implicit def nullable2Option[T >: Null](t: T): Option[T] = if (t == null) None else Some(t)
warning: there were 1 feature warnings; re-run with -feature for details
nullable2Option: [T >: Null](t: T)Option[T]

scala> val os2: Option[String] = "foo"
os2: Option[String] = Some(foo)

scala> val nullS: String = null
nullS: String = null

scala> val os3: Option[String] = nullS
os3: Option[String] = None 
```

只要有可用的类型信息供编译器用来驱动尝试将可空类型的值桥接到`Option`. 例如，在调用方法时（类型总是显式的）。

# java - 使用字节的Java定点算术

> ID：14921593
> 
> 赞同：0
> 
> 时间：2013-02-17T13:29:46.757
> 
> 标签：java, byte, fixed-point

我有一些属于 [-1,1] 的值。我不需要很高的准确性，但我需要很多这些值。现在我更像是一个硬件专家，所以我毫不费力地找到了解决方案：使用定点算法。我希望通过使用 8 位 Java 字节类型来节省内存，其精度为 2^(-7)=0.0078125。有没有一种方法可以做到这一点并处理截断/过（下）流问题？

我还想尽可能避免计算开销，因为这些值也将涉及大量计算。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:49:57.010

> 有没有一种方法可以做到这一点并处理截断/过（下）流问题？

这取决于你想如何处理这些问题。您似乎提议的是将这些`byte`值视为缩放值。现在 Java 没有对缩放数字的任何内置支持，因此您将不得不小心地进行算术......自己处理截断、下溢和缩放调整。

它可以做到......如果你小心的话。

* * *

但是这值得吗？

首先要考虑的是字段或局部变量与字段或`byte`字段占用完全相同的空间...... 32 位。（或者在 64 位机器上可能更多。）`int``float`

实际上，只有当字节实际上是 a 的成员时，您才会节省内存`byte[]`。

然后你必须问自己，实现空间缩减的努力是否真的值得。您是否*测量*过这些按比例缩放的字节值中有多少？您是否将其与应用程序中的其他内存使用情况进行了比较？您甚至知道需要表示多少个这些缩放的字节值吗？

> 我还想尽可能避免计算开销，因为这些值也将涉及大量计算。

有问题。具有缩放值的算术将需要额外的指令，特别是如果您想检测上溢/下溢。这往往会使您的应用程序变慢。

* * *

我倾向于简单地使用`float`它将自动处理所有上溢和下溢问题来实现应用程序。然后在真实数据上运行应用程序，看看它有多快，以及它使用了多少内存：

*   如果两者都可以接受，那就别管它了。
*   如果内存使用量太大或速度太慢，那么请寻找解决此问题的方法。如果您决定尝试按比例缩放的数字方法：
    *   `float`使用和实现关键计算`byte`
    *   测试以校正缩放的算术代码，并且
    *   仔细对两个版本进行基准测试以量化差异。

我无法预测结果会是什么。但我可以告诉你，很多人浪费时间优化不需要优化的代码。不要犯那个错误——不要过早优化。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-02-17T13:40:13.357

我理解你这样的问题。由于最终变量，以下代码也提供了性能。

最后一个字节 x = -1；最后一个字节 y = 1;

请记住，对于字节数据类型，您必须小心谨慎。

字节 b1 = x*y; 给出错误。执行以下操作。

字节 b1 = (字节) (x*y);

# html - 绝对定位的 div 如何影响其子级？

> ID：14921596
> 
> 赞同：1
> 
> 时间：2013-02-17T13:30:12.690
> 
> 标签：html, css, positioning

我们正在构建一个单页 Web 应用程序，其中包含用户可以与之交互的多个部分。我目前需要构建应用程序的主要布局，该布局应该将页面划分为这些单独的部分。**我无法控制将添加到每个部分的内部内容。**

每个部分都应该能够被用户放大并将其他部分推出视图区域。因此，我正在考虑对每个部分使用绝对定位，以便正确定位它们并允许轻松更改视图上的位置。

理想的情况是，如果有人可以像在自己的页面上开发一样开发每个部分的内部内容。所以我担心的是 - 绝对定位父 div 如何影响将添加的子元素？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:56:22.143

我认为`position: absolute|relative|...`这里的属性表示所描述的元素相对于其父母/祖先的行为方式，而不是其子项的行为方式。

如果你在每个部分都使用绝对定位，它们都将超出正常流程。这意味着您将不得不重新创建-正常-流程机制。我建议您阅读[正常流、浮动和定位的比较部分](http://www.w3.org/TR/css3-positioning/#comparison)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:05:18.080

与名称所暗示的相反，只要您不指定宽度或高度，绝对定位元素就会随着其中的内容扩展或收缩。[http://jsfiddle.net/M3CZg/](http://jsfiddle.net/M3CZg/)

```
#abs1 {
position:absolute;
top:0;
}
#abs2 {
position:absolute;
top:50px;
width: 400px;
}

<div id="abs1"></div>
<div id="abs2"></div> 
```

用任何内容填充这两个 div，它们将相应地扩展。

对于您所说的用户操作的 div，您可以使用 min-width 和 min-height 以及 max-width 和 max-height 将扩展保持在一个范围内。如果内容大于最大属性，这也需要溢出：隐藏。[http://jsfiddle.net/M3CZg/3/ 玩弄](http://jsfiddle.net/M3CZg/3/)它并移动窗口以查看 div 是如何弯曲的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T10:08:40.580

发布此内容以跟进调查结果。

主要问题是，将元素定位为非静态确实会对任何定位为绝对的子元素产生直接影响。

这是因为父元素将成为这些子元素的包含块，而不是静态的。在后一种情况下，子项的包含块将是第一个具有非静态位置的祖先。请参阅[包含块的](http://www.w3.org/TR/css3-positioning/#containing-block0)[绝对定位](http://www.w3.org/TR/css3-positioning/#absolute-positioning)和定义（感谢@Edouard Lopez）。因此，子元素的任何定位都将与绝对父元素相关。

此外，正如@fredsbend 所述，绝对定位的 div 元素将根据其包含的元素的宽度而不是根据其容器进行扩展，静态定位的 div 就是这种情况。如果孩子们没有明确的宽度设置，这也会影响他们。

# java - 通过给定的字段对象查找类实例

> ID：14921597
> 
> 赞同：1
> 
> 时间：2013-02-17T13:30:23.577
> 
> 标签：java

是否可以使用期望字段对象作为参数的公共静态方法找到对象实例？

这就是我搜索的内容：

```
public class Foo {
    private Bar myObject;

    public static Foo get(Bar bar) {
        // return an instance of Foo which has stored a
        // reference to bar inside myObject or null if not found
    }
} 
```

我希望，你能理解我的担心。谷歌没有帮助，我只是猜测可能有一个使用 Java 反射的解决方案。非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:32:21.867

不，没有办法知道这一点。

一个给定的`Bar`对象可以被任意数量的实例引用`Foo`，或者实际上没有。除非您*明确地*引用了`Bar`to `Foo`，否则无法找到它们。

（当然，如果你知道`Foo`系统中的所有实例，你可以这样搜索......）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:39:34.023

不，我不认为，但是如果您有一个已知对象的列表（例如，使用静态列表并添加每个新实例），您可以创建一个搜索方法，将 bar 与 fiel 对象进行比较.. 或者您可以简单地创建此方法中的新实例:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T13:32:11.767

不，你不能那样回溯一个领域。方法接收的引用是传入引用的副本`bar`。*可能*有几十个对同一对象的引用，或者没有。如果您有系统中所有对象的列表，您可以（通过反射，因为是私有的）找出哪些对象具有相同的引用，但很可能存在不止一个，或者没有，因为有无法知道您收到的内容是否被任何实例引用，也没有任何理由只能被其中一个引用。`get`*`Bar``Foo``myObject``Foo``bar``Foo`*

 ** * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T13:35:15.710

不容易，而且我的直觉反应是，除非有非常特殊的情况，否则您可能以错误的方式处理问题。

如果您确实需要这样做，您可以使用[检测](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/instrument/package-summary.html)来注册您感兴趣的可能引用 Foo 的类的构造函数，然后在某处保留对已创建对象的引用。

然后，您可以根据需要逐步浏览所有这些引用，并使用反射检查是否有任何包含您所追求的字段类型。

它不漂亮，不高效，在大多数情况下完全不切实际，但纯粹从技术角度回答问题是我能想到的唯一方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T13:37:16.000

不确定这与反射有关，您只需要跟踪您`Foo`，因此您需要保留所有创建的 Foos 的静态地图。

```
public class Foo {
  private static final Map<Bar, Foo> BAR_FOO_MAP = new HashMap<>();
  private final Bar bar;

  private Foo(final Bar bar) {
   this.bar = bar;
  }

  public static Foo newInstance(final Bar bar) {
   final Foo foo = new Foo(bar);
   BAR_FOO_MAP.put(bar, foo);
   return foo;
  }
  public static Foo findFoo(final Bar bar) {
   return BAR_FOO_MAP.get(bar);
  }
} 
```

正如其他人所指出的，除非您有 unqiue 映射，否则这将不起作用 - 您可能必须使用 a`Map<Bar, Collection<Foo>>`甚至是[guava](http://code.google.com/p/guava-libraries/) `Multimap`。*

# initialization - AngularJS，防止控制器上的init方法在茉莉花测试期间启动

> ID：14921602
> 
> 赞同：9
> 
> 时间：2013-02-17T13:30:59.790
> 
> 标签：initialization, angularjs, jasmine

我有一个控制器，它在实例化时启动了一个 init() 方法。它做了很多对我的应用程序在实时环境中有用的事情，但这会弄乱我的单元测试间谍。

在单元测试环境中实例化控制器时，有没有办法阻止它的调用？或者可能是一种在 webapp 上下文中自动调用它而不在控制器代码末尾显式调用 init() 的方法？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-17T16:04:00.577

在没有看到实时代码示例的情况下提供精确的指导有点困难（这就是为什么提供一个具有 Jasmine 测试模板的 plunk 通常是一个好主意）但听起来你的`init`方法执行了一些应该是的设置逻辑因环境而异。如果是这样，前进的方法是将这个初始化逻辑封装到一个专用服务中，并在测试期间模拟这个服务（这正是@Joe Dyndale 所建议的）。

前提是您的控制器如下所示：

```
app.controller('MainCtrl', function($scope) {
  $scope.init = function() {
    //something I really don't want to call during test
    console.log("I'm executing");
  };
}); 
```

它可以重构为：

```
app.factory('InitService', function() {
  return {
    init = function() {
      //something I really don't want to call during test
      console.log("I'm executing");
    }
  };
});

app.controller('MainCtrl', function($scope, InitService) {
  InitService.init();
}); 
```

然后模拟测试可能如下所示：

```
describe('Testing an initializing controller', function() {
  var $scope, ctrl;

  //you need to indicate your module in a test
  beforeEach(module('plunker'));
  beforeEach(module(function($provide){
    $provide.factory('InitService', function() {
      return {
        init: angular.noop
      };
    });
  }));
  beforeEach(inject(function($rootScope, $controller) {
    $scope = $rootScope.$new();
    ctrl = $controller('MainCtrl', {
      $scope: $scope
    });
  }));

  it('should test sth on a controller', function() {
    //
  });
}); 
```

最后[，这](http://plnkr.co/edit/fgZMJNfPQeKLt0IEva7d?p=preview)是 plunker 中的实时代码

# matlab - 在matlab上从矩阵中绘制点

> ID：14921608
> 
> 赞同：3
> 
> 时间：2013-02-17T13:31:46.323
> 
> 标签：matlab, sorting, vector, matrix, plot

我有一个矩阵，可以显示骑士在骑士巡回赛中的位置。我正在寻找一种方法，首先按顺序找到数字并输出它们的位置，例如在较小的板上 X

```
X=[1 3; 4 2] 
```

输出

```
A=[1 2 3 4]

b= [1 1; 2 4; 1 2; 1 3] 
```

像这样的东西，其中 b 是矩阵中 A 的值的位置

我能想到的唯一方法是使用`find (n)`where的一系列函数，`n=1..64`然后连接结果

然后我想使用这些信息来创建带有线/矢量图的移动图，但我也很难弄清楚如何做到这一点。

谢谢，泰莎

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T14:10:03.097

您可以使用`find`识别访问过的棋盘坐标，然后根据移动的顺序对其进行排序。

```
%# find the visited coordinates
[rows,cols,moveNumber]=find(A);

%# find out how to reorder the positions so that
%# the moves are in the right order
[~,sortIdx] = sort(moveNumber);

%# plot the moves
figure
plot(rows(sortIdx),cols(sortIdx),'-o') 
```

# jquery - 在选择时禁用悬停功能

> ID：14921616
> 
> 赞同：1
> 
> 时间：2013-02-17T13:32:26.883
> 
> 标签：jquery

我目前正在尝试构建一个缩略图库，允许用户突出显示某个类别的缩略图，但是当没有选择任何类别或未突出显示的缩略图时，高亮显示在悬停时。

悬停功能

```
$(window).load(function(){
$('.print, .campaign, .identity, .photography').each(function(){  
$(this).css('opacity', 0);
$(this).css('display', 'block');  
});  

$('.box_print, .box_campaign, .box_identity, .box_photography').hover(function(){  
$(this).children('.print, .campaign, .identity, .photography').stop().fadeTo(300, 4);  
},function(){  
$(this).children('.print, .campaign, .identity, .photography').stop().fadeTo(000, 0);  
}); 

}); 
```

类别功能

```
 $(document).ready(function(){

    $(".cat-all").click(function(){
    $(this).css('font-weight', 'bold')
    $(".cat-print, .cat-identity, .cat-photography, .cat-campaign").css('font-weight', 'normal')
    $(".print, .identity, .photography, .campaign").fadeTo(100, 0);
    $(this).toggleClass("active"); return false;
});

$(".cat-print").click(function(){
    $(this).css('font-weight', 'bold')
    $(".cat-all, .cat-identity, .cat-photography, .cat-campaign").css('font-weight', 'normal')      
    $(".print").fadeTo(600, 4);
    $(".identity, .photography, .campaign").fadeTo(100, 0);
    $(this).toggleClass("active"); return false;
});

$(".cat-identity").click(function(){
    $(this).css('font-weight', 'bold')
    $(".cat-all, .cat-print, .cat-photography, .cat-campaign").css('font-weight', 'normal')     
    $(".identity").fadeTo(600, 4);
    $(".print, .photography, .campaign").fadeTo(100, 0);
    $(this).toggleClass("active"); return false;
});

$(".cat-photography").click(function(){
    $(this).css('font-weight', 'bold')
    $(".cat-all, .cat-print, .cat-identity, .cat-campaign").css('font-weight', 'normal')        
    $(".photography").fadeTo(600, 4);
    $(".identity, .print, .campaign").fadeTo(100, 0);
    $(this).toggleClass("active"); return false;
});

$(".cat-campaign").click(function(){
    $(this).css('font-weight', 'bold')
    $(".cat-all, .cat-print, .cat-photography, .cat-identity").css('font-weight', 'normal')     
    $(".campaign").fadeTo(600, 4);
    $(".identity, .photography, .print").fadeTo(100, 0);
    $(this).toggleClass("active"); return false;
});

}); 
```

JS 小提琴 - [http://jsfiddle.net/XL3G3/5/](http://jsfiddle.net/XL3G3/5/)

如果您看过，我无法解决的最后一件事是如何仅在类别选择中突出显示的缩略图上禁用悬停功能。

根据我一直在阅读的内容，我感觉它可能与事件命名空间有关，使我能够绑定和取消绑定悬停功能？但我不确定，如果有人能指出我正确的方向，我会很感激的！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:05:14.973

如果我理解你 - 我有一个解决方案给你：

当您执行悬停功能时：

```
$('.box_print, .box_campaign, .box_identity, .box_photography').hover(function () {
        //when mouse hover over the wrapper div  
        //get it's children elements with class description '  
        //and show it using fadeTo  
        $(this).children('.print, .campaign, .identity, .photography').stop().fadeTo(300, 4);
    }, function () {
        //when mouse out of the wrapper div  
        //use fadeTo to hide the div  
        $(this).children('.print, .campaign, .identity, .photography').stop().fadeTo(0, 0);
    }); 
```

而不是调用每个缩略图类，如下所示：

```
$('.box_print, .box_campaign, .box_identity, .box_photography') 
```

您可以为所有缩略图添加相同的类，并像这样执行悬停功能：

```
$('.box') 
```

然后，当用户选择一个类别时 -`.box`从当前类别的所有缩略图中删除类别。

# php - 从图像创建 PDF 时设置文档名称

> ID：14921618
> 
> 赞同：2
> 
> 时间：2013-02-17T13:32:34.637
> 
> 标签：php, pdf, imagemagick

我正在使用以下代码从 jpg 图像创建 pdf：

```
$im = new Imagick();
$im->readImage('./image.jpg');
$im->setImageFormat('pdf');
$im->writeImage('../images/pdf/image.pdf'); 
```

现在我最近看到谷歌索引了 image.pdf 文件，但作为谷歌搜索页面上的标题，它显示“无标题”而不是“图像”，因为名称是 image.pdf。

所以对我来说，PDF 似乎有它自己的命名，而我的代码中已经忽略了它。如何使用 Imagemagick 将“无标题”更改为实际标题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:57:53.620

这似乎与 ImageMagick 无关。您还有其他一些选择：

*   购买和使用 PDFLib 库： http: [//php.net/manual/en/book.pdf.php](http://php.net/manual/en/book.pdf.php)
*   使用 Zend PHP 框架；如何使用它的示例在这里：[通过 PHP 将元数据添加到 PDF 并](https://stackoverflow.com/questions/3060078/adding-metadata-to-pdf-via-php)在此处提供更多信息：http: [//framework.zend.com/about/faq/](http://framework.zend.com/about/faq/)
*   使用PHP exec() 函数调用可以设置标题的外部程序
*   OP 在评论中提到的还有 FPDF：[http](http://www.fpdf.org/) : //www.fpdf.org/ 这似乎是合适的，因为它能够编写 PDF 文件并使用其 SetTitle() 设置标题。FPDF 自 2011 年以来和 2008 年之前就没有更新过。但是，再次，它似乎是合适的。

对于它的价值，Zend PHP 框架可能是我的选择。尽管如果这不是您经常要做的事情，那么 exec() 函数可能更有意义。

# android - 如何检查支持的 S Pen 设备？

> ID：14921620
> 
> 赞同：2
> 
> 时间：2013-02-17T13:32:51.173
> 
> 标签：android

如何确定设备是否有 S Pen？

请注意，我`SDrawLibrary.isSupportedModel()`在三星 S3 上使用它返回 true，我们都知道 S3 没有 S Pen。

任何华而不实或帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T15:10:43.010

您使用的方法已从 S Pen SDK 中删除。更新 SDK 到 2.2.5 版本，因为有很多改进。

目前该库不提供任何方法来检查设备是否有 S Pen。使用`Build`该类获取有关设备的信息，准备一个包含具有 S Pen 的型号的列表，然后检查该设备是否在列表中。这可能不是您期望的答案，因为它需要使列表保持最新。

```
private static final String SAMSUNG = "SAMSUNG";
private static final String NOTE = "GT-N";
private static final String SPEN_FEATURE = "com.sec.feature.spen_usp";
private final List<String> mSPenDevices;

public boolean isSPenSupported() {
    FeatureInfo[] infos = getPackageManager().getSystemAvailableFeatures();
    for (FeatureInfo info : infos) {
        if (SPEN_FEATURE.equalsIgnoreCase(info.name)) {
            return true;
        }
    }

    if (Build.MODEL.toUpperCase(Locale.ENGLISH).startsWith(NOTE)) {
        return true;
    }

    if (SAMSUNG.equalsIgnoreCase(Build.MANUFACTURER)) {
        for (String model : mSPenDevices) {
            if (model.equalsIgnoreCase(Build.MODEL)) {
                return true;
            }
        }
    }

    return false;
} 
```

**编辑：**因为 Galaxy Note 系列的大多数型号都以“GT-N”开头，所以我在代码中添加了检查。我知道美国的设备有其他命名，所以这仍然不是最好的解决方案。

另一种可能的方法是检查设备是否具有`com.sec.feature.spen_usp`功能，但据我所知，它从 JB 开始工作。我更新了上面的代码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-04-08T00:18:53.260

您还可以通过 InputManager 检测 S-Pen：

```
 boolean sPen = false;
    if(Build.VERSION.SDK_INT > 15) {
        InputManager inptmgr = (InputManager)getSystemService(INPUT_SERVICE);
        int[] inputs = inptmgr.getInputDeviceIds();
        for(int i = 0;i<inputs.length;i++) {
            if(inptmgr.getInputDevice(inputs[i]).getName().toLowerCase().contains("pen")) sPen = true;
        }
    } 
```

# node.js - 带有 Node.js 的 MongoDB，脚本正在等待……为了什么？

> ID：14921626
> 
> 赞同：1
> 
> 时间：2013-02-17T13:33:48.183
> 
> 标签：node.js, mongodb

所以我第一次尝试使用`mongodb`（`test.js`从教程中复制并过去）：

```
// Retrieve
var MongoClient = require('mongodb').MongoClient;

// Connect to the db
MongoClient.connect("mongodb://localhost:27017/local", function(err, db) {
  if(!err) {
    console.log("We are connected");
  }
}); 
```

当我启动时`node test.js`，终端没有显示任何错误，但我没有结束。登录“我们已连接”后它卡住了，等待我不知道的东西。这是正常的吗？谢谢。

另一方面，我使用`mongo`可执行文件没有问题：

```
mongo
show dbs 
```

休息界面有效，`http://localhost:28017/listDatabases?text=1`显示：

```
{ "databases" : [ 
    { "name" : "local",
      "sizeOnDisk" : 1,
      "empty" : true } ],
  "totalSize" : 0 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:38:32.130

正如 Roman 所指出的，您需要在完成后关闭与 MongoDB 的连接，否则它将使程序保持打开状态。

```
// Retrieve
var MongoClient = require('mongodb').MongoClient;

// Connect to the db
MongoClient.connect("mongodb://localhost:27017/local", function(err, db) {
  if(!err) {
    console.log("We are connected");
  }

  // Use db
  ...

  // Done with db so close it.
  db.close();
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:09:21.437

MongoClient 打开到 mongodb 的 tcp 连接。每当您这样做时，它都会阻止节点事件循环终止您的应用程序，因为它正在等待 tcp 套接字上的数据。

在您的示例中，您已经连接，所以现在您可以开始在回调中对数据库进行查询。

# c - XCode 分配不适用于 C？

> ID：14921627
> 
> 赞同：-2
> 
> 时间：2013-02-17T13:33:49.930
> 
> 标签：c, xcode

我尝试将 XCode 4.6 分配工具用于 C 编程代码：

```
#include <stdlib.h>
int main(void){

    char c[5] = "Hello";
    unsigned char *p;
    p = (unsigned char *) malloc(sizeof(p));
    *p = 255;

    return 0;
} 
```

但它没有显示任何分配：

![Xcode 4.6 分配](../Images/5f8710f687bf446ef2aa2000dc8435c6.png)

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:24:25.793

谢谢 2cnicutar

问题是 XCode 4.6 的分配工具正在处理程序的发布版本，因此代码进行了优化。

解决方案是为 Profile 选项选择“Debug”模式而不是“Release”

![在此处输入图像描述](../Images/113772d5252343cf35dcc741c65afabd.png)

# linux - 为什么删除虚拟机中的大文件时主机上的磁盘映像文件没有减少？

> ID：14921633
> 
> 赞同：5
> 
> 时间：2013-02-17T13:34:26.897
> 
> 标签：linux, virtualbox

我在 virtualbox 上安装了 CentOS（主机操作系统是 Windows 7）。我创建了磁盘映像文件，即 VDI 文件（**动态分配的映像**）。最近，当我在 CentOS 中删除大文件时，我磁盘上的 VDI 文件并没有减少。为什么？如何解决这个问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T22:48:26.800

当您删除 VM 中的文件时，VirtualBox 不会自动回收磁盘空间（在主机上）。要缩小磁盘映像，您需要

首先，将所有可用空间清零（对于 HDD 上的所有分区和逻辑卷），然后关闭 VM。

`cat /dev/zero > z;sync;sleep 3;sync;rm -f z`

然后，使用以下命令压缩 VDI。

`VBoxManage modifyhd /path/to/image.vdi --compact`

[VBox 文档](https://www.virtualbox.org/manual/ch08.html#vboxmanage-modifyvdi)

> 使用 --compact 选项，可用于压缩磁盘映像，即删除仅包含零的块。这将再次缩小动态分配的图像；它将减小映像的物理大小，而不会影响虚拟磁盘的逻辑大小。压缩既适用于基础图像，也适用于作为快照的一部分创建的差异图像。

顺便说一句：对于 VMWare (.vmdk)，您需要使用`vmware-vdiskmanager -k xxx.vmdk`来执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:43:03.973

主机如何知道提供给 VM 的哪些扇区正在被 VM 使用，哪些是免费的？

它唯一知道的是当虚拟机请求一个仍未在磁盘文件中分配的扇区时（当它增加它时）。

也许“碎片整理”或类似的过程可以很好地重新组织磁盘使用，以便您可以手动告诉主机减少空间。到目前为止，我不知道有任何提供该功能的 VM 主机（并且使用它总是非常危险）。

最简单的替代方法是将您的虚拟机克隆到新的虚拟机。

# tfs - 在 TFS 2012 中删除构建控制器

> ID：14921635
> 
> 赞同：4
> 
> 时间：2013-02-17T13:34:34.720
> 
> 标签：tfs

几个月前，我在虚拟机中为 TFS 2012 配置了构建控制器，并为此配置了 2 个代理。现在我删除了包含**代理**的虚拟机，当我想从 TFS 中删除**构建控制器**时，它会显示以下错误消息：

![无法删除构建控制器](../Images/948362dbf77b705758f1a565afc4326a.png)

而且它也没有向我显示删除它们的代理。

![构建配置](../Images/484d6644f18b11a72d10799cacfe727f.png)

我想知道有没有办法删除控制器并重新配置它而不访问代理机器？

*如果我的问题不够清楚，请告诉我完成它。*

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-17T17:38:14.353

打开 Visual Studio 2012。导航到 Team Explorer - Builds (Ctrl 0,B)。左上角有一个操作下拉菜单，单击它并选择管理构建控制器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:37:54.787

要删除构建服务器，请登录到构建服务器并打开构建配置。然后删除代理。之后，您可以取消注册构建服务器。

我不能 100% 确定是否没有其他方法，但这就是我从 2010 TFS 安装中删除不推荐使用的构建服务器的方式。

# asp.net - ELMAH 未登录 Azure

> ID：14921649
> 
> 赞同：4
> 
> 时间：2013-02-17T13:36:04.540
> 
> 标签：asp.net, asp.net-mvc, azure, elmah

我尝试使用 elmah 在我的服务器上记录错误。如果我的本地电脑发生异常，elmah 将保存此错误。但是在我将它上传到天蓝色之后，它就不再起作用了。数据库配置是正确的，因为我可以使用以下语句（本地/Azure）记录错误：

```
Elmah.ErrorSignal.FromCurrentContext().Raise(e); 
```

我建议这是配置错误，因为 azure 具有不同的 IIS 版本以及不同的服务器配置。

这是我的 web.config

```
<?xml version="1.0" encoding="utf-8"?>
<configuration>
  <configSections>
    <section name="RetryPolicyConfiguration" type="Microsoft.Practices.EnterpriseLibrary.WindowsAzure.TransientFaultHandling.Configuration.RetryPolicyConfigurationSettings, Microsoft.Practices.EnterpriseLibrary.WindowsAzure.TransientFaultHandling, Version=5.1.1209.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" requirePermission="true" />
    <section name="typeRegistrationProvidersConfiguration" type="Microsoft.Practices.EnterpriseLibrary.Common.Configuration.TypeRegistrationProvidersConfigurationSection, Microsoft.Practices.EnterpriseLibrary.Common, Version=5.0.505.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
    <sectionGroup name="elmah">
      <section name="security" requirePermission="false" type="Elmah.SecuritySectionHandler, Elmah" />
      <section name="errorLog" requirePermission="false" type="Elmah.ErrorLogSectionHandler, Elmah" />
      <section name="errorFilter" requirePermission="false" type="Elmah.ErrorFilterSectionHandler, Elmah" />
    </sectionGroup>
  </configSections>
  <RetryPolicyConfiguration defaultRetryStrategy="Fixed Interval Retry Strategy">
    <incremental name="Incremental Retry Strategy" maxRetryCount="5" retryIncrement="00:00:03" />
    <fixedInterval name="Fixed Interval Retry Strategy" maxRetryCount="6" retryInterval="00:00:04" />
    <exponentialBackoff name="Exponential Backoff Retry Strategy" />
  </RetryPolicyConfiguration>
  <typeRegistrationProvidersConfiguration>
    <clear />
    <add name="Caching" sectionName="cachingConfiguration" />
    <add name="Cryptography" sectionName="securityCryptographyConfiguration" />
    <add name="Exception Handling" sectionName="exceptionHandling" />
    <add name="Instrumentation" sectionName="instrumentationConfiguration" />
    <add name="Logging" sectionName="loggingConfiguration" />
    <add name="Policy Injection" sectionName="policyInjection" />
    <add name="Security" sectionName="securityConfiguration" />
    <add name="Data Access" providerType="Microsoft.Practices.EnterpriseLibrary.Data.Configuration.DatabaseSyntheticConfigSettings, Microsoft.Practices.EnterpriseLibrary.Data" />
    <add name="Validation" providerType="Microsoft.Practices.EnterpriseLibrary.Validation.Configuration.ValidationTypeRegistrationProvider, Microsoft.Practices.EnterpriseLibrary.Validation" />
    <add sectionName="RetryPolicyConfiguration" name="RetryPolicyConfiguration" />
  </typeRegistrationProvidersConfiguration>
  <connectionStrings>
    <add providerName="System.Data.SqlClient" name="elmah" connectionString="..." />
  </connectionStrings>
  <system.web>
    <globalization fileEncoding="utf-8" requestEncoding="utf-8" responseEncoding="utf-8" responseHeaderEncoding="utf-8" uiCulture="en-US" culture="en-US" enableClientBasedCulture="false" />
    <httpRuntime maxRequestLength="2000" enableVersionHeader="false" />
    <compilation debug="true" targetFramework="4.5">
      <assemblies>
        <add assembly="System.Web.Abstractions, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Helpers, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Routing, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Web.WebPages, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
        <add assembly="System.Data.Entity, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" />
        <add assembly="System.Web.WebPages.Razor, Version=2.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
      </assemblies>
    </compilation>
    <authentication mode="Forms">
      <forms loginUrl="~/#login" defaultUrl="~/" timeout="7200" />
    </authentication>
    <customErrors mode="On"></customErrors>
    <trust level="Full" />
    <machineKey validationKey="..." decryptionKey="..." validation="SHA1" decryption="AES" />
    <pages enableSessionState="false" enableViewState="false" validateRequest="false" controlRenderingCompatibilityVersion="4.0">
      <namespaces>
        <add namespace="System.Web.Helpers" />
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />
        <add namespace="System.Web.WebPages" />
      </namespaces>
    </pages>
    <sessionState mode="Off" timeout="120" />
    <httpHandlers>
      <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    </httpHandlers>
    <httpModules>
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
      <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" />
    </httpModules>
  </system.web>
  <runtime>
    <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Helpers" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.Mvc" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0-4.0.0.0" newVersion="4.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="0.0.0.0-2.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="System.Web.WebPages.Razor" publicKeyToken="31bf3856ad364e35" />
        <bindingRedirect oldVersion="1.0.0.0" newVersion="2.0.0.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="Microsoft.Practices.TransientFaultHandling.Core" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-5.1.1209.0" newVersion="5.1.1209.0" />
      </dependentAssembly>
      <dependentAssembly>
        <assemblyIdentity name="WebGrease" publicKeyToken="31bf3856ad364e35" culture="neutral" />
        <bindingRedirect oldVersion="0.0.0.0-1.3.0.0" newVersion="1.3.0.0" />
      </dependentAssembly>
    </assemblyBinding>
  </runtime>
  <startup>
    <supportedRuntime version="v4.0" sku=".NETFramework,Version=v4.0" />
  </startup>
  <system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" preCondition="managedHandler" />
      <add name="ErrorFilter" type="Elmah.ErrorFilterModule, Elmah" preCondition="managedHandler" />
    </modules>
    <staticContent>
      <clientCache cacheControlMode="UseMaxAge" cacheControlMaxAge="2.00:00:00" />
    </staticContent>
    <urlCompression doStaticCompression="true" doDynamicCompression="true" dynamicCompressionBeforeCache="false" />
    <handlers>
      <add name="Elmah" path="elmah.axd" verb="POST,GET,HEAD" type="Elmah.ErrorLogPageFactory, Elmah" preCondition="integratedMode" />
    </handlers>
    <validation validateIntegratedModeConfiguration="false" />
    <httpErrors errorMode="Custom">
      <clear />
      <error statusCode="404" path="/error404" responseMode="ExecuteURL" />
    </httpErrors>
  </system.webServer>
  <elmah>
    <security allowRemoteAccess="true" />
    <errorLog type="Elmah.SqlErrorLog, Elmah" connectionStringName="elmah" applicationName="..." />
  </elmah>
  <location path="elmah.axd" inheritInChildApplications="false">
    <system.web>
      <authorization>
        <allow roles="admin" />
        <deny users="*" />
      </authorization>
      <httpHandlers>
        <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
      </httpHandlers>
    </system.web>
    <system.webServer>
      <handlers>
        <add name="ELMAH" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" preCondition="integratedMode" />
      </handlers>
    </system.webServer>
  </location>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-11T14:56:30.133

您可能已经解决了这个问题，所以以防万一 - 在将我的 web.config 与您的进行比较时，您似乎缺少节点中的`<modules>`部分。`<system.webServer>`同样适用于`<system.web>`节点。

这是我的：

```
<system.web>
    <httpModules>
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
    </httpModules>
    <httpHandlers>
      <add verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    </httpHandlers>
</system.web>

<system.webServer>
    <modules runAllManagedModulesForAllRequests="true">
      <add name="ErrorLog" type="Elmah.ErrorLogModule, Elmah" />
    </modules>
    <handlers>
      <add name="Elmah" verb="POST,GET,HEAD" path="elmah.axd" type="Elmah.ErrorLogPageFactory, Elmah" />
    </handlers>
</system.webServer> 
```

再次，注意`<httpModules>`和`<modules>`节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T14:17:28.873

出于好奇，从`<location>`节点中删除 Elmah 处理程序并将它们移回`<system.web>` and`<system.webServer>`节点下，看看是否有效。我知道这不是一个理想的解决方案，但它可以确保您的日志记录是开箱即用的，无需特殊处理。

我建议这样做是因为我在 Azure 上遇到了与 Elmah 完全相同的问题。它在没有在节点中处理的情况下正常工作，但在我移动它以保护它的那一刻，它就停止了工作。我还没有时间深入研究根本原因，但这可能会让您有所调查。

# javascript - KnockoutJS，批量更新 observableArray？

> ID：14921653
> 
> 赞同：1
> 
> 时间：2013-02-17T13:36:32.740
> 
> 标签：javascript, dom, mvvm, knockout.js

我有以下情况：

由 observableArray 表示的项目列表，除了内容/标题等。我想让它们中的每一个都可以在视图中折叠。

现在问题变成了我是否应该将此状态存储为每个项目的可观察对象：**如果是这样，我如何实现一个触发器来有效地切换所有项目的打开/关闭**- 即。最小化dom更新。

**ko.utils.arrayForEach**似乎是要走的路，它是否仅在循环结束时触发视图刷新？有没有更好的办法？

```
ko.utils.arrayForEach(this.items(), function(item) {
    ...
    item.close(true);
    ...
}); 
```

**编辑**：这是 DOM 中发生的事情（在淘汰赛 foreach 循环内）

```
<div class="item">
    <!-- ko 'if': !close() -->
    <div class="article" data-bind="html: article"></div>
    <!-- /ko -->
</div> 
```

所以基本上我可以单击此页面上某处的按钮，该按钮运行 ko.utils.arrayForEach 来切换所有项目。它有效，我只是不知道这是否是最好的方法（例如，只触发一次 dom 更新而不是每个项目）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:02:25.477

在我看来，您需要实现过滤。根据您的数组创建新的过滤数组并显示项目取决于您的属性。

```
vm.filteredItems = ko.computed(function () {
    return ko.utils.arrayFilter(this.items(), function (fitem) {
        if ('open' == fitem.state()) {
            return true;
        }
        return false;
    });
}, vm); 
```

`state`在每个项目的适当事件中更改属性并绑定`filteredItems`到您的列表控件。

查看[下一个示例](http://knockoutjs.com/examples/animatedTransitions.html)以获取更多详细信息

# php - 我如何用 mysql COUNT() 做到这一点

> ID：14921663
> 
> 赞同：1
> 
> 时间：2013-02-17T13:37:29.773
> 
> 标签：php, mysql, sql

我正在使用这个 UNION 查询来计算查询给出的记录。

这是我的查询：

```
// Count the number of records:
$q = "SELECT COUNT( DISTINCT i.institute_id)    
          FROM institutes AS i
            INNER JOIN institute_category_subject AS ics 
                ON ics.institute_id = i.institute_id
            INNER JOIN subjects AS s 
                ON ics.subject_id = s.subject_id
          WHERE s.subject_name LIKE '%mathematics%'
        UNION
        SELECT COUNT( DISTINCT t.tutor_id)
          FROM tutors AS t
            INNER JOIN tutor_category_subject  AS tcs
                ON tcs.tutor_id = t.tutor_id
            INNER JOIN subjects AS s
                ON tcs.subject_id = s.subject_id
          WHERE s.subject_name LIKE '%mathematics%'"; 
```

执行此查询后，我得到以下结果作为我的输出。

```
+---------------------------------+
| COUNT( DISTINCT i.institute_id) |
+---------------------------------+
|                               3 |
|                               2 |
+---------------------------------+ 
```

这不是我预期的结果。我需要通过添加 3 + 2 得到 5 作为结果。添加两个选择查询。

谁能告诉我我是怎么想出来的？

想你。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T13:39:04.050

用子查询包装`UNION`ed 查询

```
SELECT SUM(total) totalSum
FROM
    (
        SELECT  COUNT( DISTINCT i.institute_id) total
        FROM    institutes AS i
                INNER JOIN institute_category_subject AS ics 
                    ON ics.institute_id = i.institute_id
                INNER JOIN subjects AS s 
                    ON ics.subject_id = s.subject_id
        WHERE   s.subject_name LIKE '%mathematics%'
        UNION
        SELECT  COUNT( DISTINCT t.tutor_id)   total
        FROM    tutors AS t
                INNER JOIN tutor_category_subject  AS tcs
                    ON tcs.tutor_id = t.tutor_id
                INNER JOIN subjects AS s
                    ON tcs.subject_id = s.subject_id
        WHERE   s.subject_name LIKE '%mathematics%'
    ) s 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T13:41:36.763

由于您正在计算行数，因此不需要 sum + count + count 的额外开销。

只需这样做：

```
$q = "SELECT COUNT(*) FROM (
    SELECT DISTINCT i.institute_id
      FROM institutes AS i
        INNER JOIN institute_category_subject AS ics 
            ON ics.institute_id = i.institute_id
        INNER JOIN subjects AS s 
            ON ics.subject_id = s.subject_id
      WHERE s.subject_name LIKE '%mathematics%'
    UNION ALL
    SELECT DISTINCT t.tutor_id
      FROM tutors AS t
        INNER JOIN tutor_category_subject  AS tcs
            ON tcs.tutor_id = t.tutor_id
        INNER JOIN subjects AS s
            ON tcs.subject_id = s.subject_id
      WHERE s.subject_name LIKE '%mathematics%'
  ) mysubquery"; 
```

# winforms - Windows 8 密码框占位符

> ID：14921664
> 
> 赞同：2
> 
> 时间：2013-02-17T13:37:30.193
> 
> 标签：winforms, windows-runtime, windows-store-apps, passwordbox

如何在没有文本且没有获得焦点的情况下将文本占位符添加到 Windows 8 App 中的 PasswordBox 控件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-02T15:42:26.003

WinRT XAML Toolkit 现在有一个[WatermarkPasswordBox](https://winrtxamltoolkit.codeplex.com/SourceControl/changeset/view/8ed4b738d64c35c85396f431ae20dd36e651d562#WinRTXamlToolkit/Controls/WatermarkPasswordBox/WatermarkPasswordBox.cs)。您可以从[NuGet](http://nuget.org/packages/winrtxamltoolkit)获得它。此外，对于 Windows 8.1，您可以使用 PlaceholderText 属性。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:23:20.287

看起来没有实现的功能，你需要自己做。

[你可以从Callisto WatermarkTextBox](https://github.com/timheuer/callisto/wiki/WatermarkTextBox)得到一些想法

或从下一个问题和答案 - [WPF 中的水印/提示文本文本框](https://stackoverflow.com/questions/833943/watermark-hint-text-textbox-in-wpf)

# sql - RESTRICT 和 NO ACTION 的区别

> ID：14921668
> 
> 赞同：39
> 
> 时间：2013-02-17T13:38:08.993
> 
> 标签：sql, postgresql, postgresql-9.2

来自[postgresql 文档](http://www.postgresql.org/docs/9.2/static/ddl-constraints.html)：

> RESTRICT 防止删除引用的行。NO ACTION 表示如果在检查约束时仍然存在任何引用行，则会引发错误；如果您不指定任何内容，这是默认行为。（这两种选择的本质区别在于 NO ACTION 允许将检查**推迟到事务的后期**，而 RESTRICT 不允许。）

让我们检查一下。创建父子表：

```
CREATE TABLE parent (
  id serial not null,
  CONSTRAINT parent_pkey PRIMARY KEY (id)
);

CREATE TABLE child (
  id serial not null,
  parent_id serial not null,
  CONSTRAINT child_pkey PRIMARY KEY (id),
  CONSTRAINT parent_fk FOREIGN KEY (parent_id)
    REFERENCES parent (id) 
    ON DELETE NO ACTION
    ON UPDATE NO ACTION
); 
```

填充一些数据：

```
insert into parent values(1);
insert into child values(5, 1); 
```

并且测试确实检查确实延迟了：

```
BEGIN;
delete from parent where id = 1; -- violates foreign key constraint, execution fails
delete from child where parent_id = 1;
COMMIT; 
```

在第一次删除完整性被破坏后，第二次它会被恢复。但是，第一次删除时执行失败。

更新相同：

```
BEGIN;
update parent set id = 2 where id = 1; -- same as above
update child set parent_id = 2 where parent_id = 1;
COMMIT; 
```

在删除的情况下，我可以交换语句以使其工作，但在更新的情况下，我无法执行它们（可以通过删除两行并插入新版本来实现）。

许多数据库在 RESTRICT 和 NO ACTION 之间没有任何区别，而 postgres 则假装不这样做。它（仍然）是真的吗？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-17T13:42:31.983

仅当您将约束定义为`DEFERRABLE`使用`INITIALLY DEFERRED`or`INITIALLY IMMEDIATE`模式时，才会出现差异。

见[`SET CONSTRAINTS`](http://www.postgresql.org/docs/current/static/sql-set-constraints.html)。

# java - 具有不同方法参数的接口

> ID：14921671
> 
> 赞同：10
> 
> 时间：2013-02-17T13:38:42.457
> 
> 标签：java, class, interface

我想声明一个接口与几个类一起使用，这些
类有不同参数的方法

界面：

```
public interface Operation {

public int Add();

} 
```

A类：

```
public class CLASSA implement Operation{

     public int Add(int id,String name);

} 
```

B类：

```
public class CLASSB implement Operation{

     public int Add(String name);

} 
```

如何实现这个接口？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-17T13:41:23.853

你可以制作一个操作数对象

```
public interface Operation {

public int Add(Operand o);

} 
```

或者

```
public interface Operation {

 public int Add(Operand... o);

} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2016-01-21T01:42:57.537

关于其他答案，有几点值得一提：

*   拥有多个函数实现（每组参数一个）和接口违反了[接口隔离原则](https://en.wikipedia.org/wiki/Interface_segregation_principle)。
*   让类忽略未使用的参数违反了[Liskov 替换原则](https://en.wikipedia.org/wiki/Liskov_substitution_principle "里氏替换原则")。

我的建议是实现类似[命令](https://en.wikipedia.org/wiki/Command_pattern)模式的东西。将命令实现与其实现分离正是它的意图。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T13:51:57.683

在这种情况下，您没有使用相同的界面，但您可以创建一个自动插入一些参数的遗传系统：

```
public class CLASSA{
     public int Add(int id,String name){
         //something
     }
}

public class CLASSB extends CLASSA{
     public int Add(String name){
         super.Add(this.FIXED_ID, name);
         //something
     }
}

public class OPERATION extends CLASSA{
     public int Add(){
         super.Add(this.FIXED_ID, this.FIXED_NAME);
         //something
     }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-17T15:12:31.450

两种解决方案
要么在接口中定义两个方法：

```
public interface Operation {

public int addName(String name);
public int addIdName(int id, String name);

} 
```

或使用通用参数

```
public interface Operation {

    public int add(HashMap<String,String> keyValueParams);
} 
```

但是对于运营来说，这应该有所不同。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-03-17T07:14:32.430

更好的方法是将参数声明为类中的字段。现在将它作为参数传递给构造函数，因此现在在创建类的新实例时指定它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-17T13:43:43.697

你不能这样做。如果接口操作是您的（不是预定义的或其他人的），请在其中重载抽象方法。这是唯一的方法。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-02-17T13:45:56.337

最好尝试一下：

```
public interface Operation {
    public int add();
}

public class SimpleOperation implements Operation {

    @Override
    public int add() {
        return 0;
    }

    public int add(int id, String name) {
        return id;
    }

} 
```

使用时：

```
Operation op = new SimpleOperation();
op.add(); // Valid
op.add(2, "two"); // Invalid 
```

基本上，虽然您可以将该方法添加到类中，但如果接口中不存在该方法，那么如果您调用它的实例属于该接口，则您无法调用它。

然而，这是有效的，因为实例属于 class `SimpleOperation`，它声明了重载方法：

```
SimpleOperation op = new SimpleOperation();
op.add(); // Valid
op.add(2, "two"); // Also valid 
```

然而，这降低了接口的有用性。如果您热衷于重载方法，请考虑使用定义了方法的抽象超类并在子类中覆盖它们。或者，将原始方法和重载方法都添加到接口中。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-02-17T13:53:39.170

这是一个坏主意，它违反了面向对象设计和接口背后的理念。接口应该用作从实现中抽象出方法调用的一种方式。

我的建议是在接口中使用带有两个参数的方法，只是不要在 CLASSB 中使用 ID 参数，或者在接口中没有 add 方法，并且每个类中只有不同的版本。

# asp.net-mvc-4 - 如何使用 RegisterType 和控制器工厂将参数传递给 autofac

> ID：14921677
> 
> 赞同：3
> 
> 时间：2013-02-17T13:39:23.970
> 
> 标签：asp.net-mvc-4, autofac

我有这堂课：

```
public class MessageService
{
    private readonly IMessageSender messageSender;

    public MessageService(IMessageSender messageSender)
    {
        this.messageSender = messageSender;
    }
} 
```

如何注册autofac以在构造函数中传递参数：

```
var builder = new ContainerBuilder();
builder.RegisterControllers(typeof(MvcApplication).Assembly);
var container = builder.Build();
DependencyResolver.SetResolver(new AutofacDependencyResolver(container));
builder.RegisterType<MandrillMessageSender>().As<IMessageSender>();

builder.RegisterType<MessageService>(new MandrillMessageSender()); // NOTE THIS STRING IS NOT WORKING 
```

所以结果应该是这样的，当我在控制器构造函数中传递参数时，应该使用插入的 MandrillMessageSerder 创建 messageService 对象。

```
public Home(MessageService messageService) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:49:02.190

您需要在`RegisterType`调用之前完成所有调用 `builder.Build()`

```
var builder = new ContainerBuilder();
builder.RegisterControllers(typeof(MvcApplication).Assembly);
builder.RegisterType<MandrillMessageSender>().As<IMessageSender>();
builder.RegisterType<MessageService>();

var container = builder.Build();
DependencyResolver.SetResolver(new AutofacDependencyResolver(container)); 
```

`MessageService`请注意，如果您只有一个接口实现，则不需要在注册中传递任何内容`IMessageSender`（Autofac 会发现您需要该接口`MandrillMessageSender`）

# c# - 查询以返回具有最多操作的小时

> ID：14921678
> 
> 赞同：0
> 
> 时间：2013-02-17T13:39:26.877
> 
> 标签：c#, linq

我正在运行查询以查找“最佳时间”，最佳时间 = 订单最多的时间。
我尝试：

```
 public void ShowBestHour()
    {
        using (NorthwindDataContext db = new NorthwindDataContext())
        {
            var query=
                from z in db.Order_Details
                select new
                {
                    bestHour = z.Order.OrderDate.Value.Hour.Count()
                }; 
        }
    } 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:58:49.363

尝试这个：

```
public void ShowBestHour()
{
    using (NorthwindDataContext db = new NorthwindDataContext())
    {            
        var bestHour = db.Order_Details.GroupBy(x => x.Order.OrderDate.Value.Hour).OrderByDescending(x => x.Count()).Select(x => x.Key).First();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:44:00.733

解决方案应该是使用**let**子句会有所帮助。

所以按计数分组，在计数上用 let 定义一个变量，然后在这个变量上排序。这个问题和你的类似：

[如何使用 LINQ 获取 Count() 的 Max()](https://stackoverflow.com/questions/4200126/how-to-get-the-max-of-a-count-with-linq)

# wordpress - WP简易购物车

> ID：14921683
> 
> 赞同：-2
> 
> 时间：2013-02-17T13:39:48.157
> 
> 标签：wordpress, shopping-cart

我正在寻找一个非常简单的 WP 购物车。一个包含几个产品的单一类别。无需结帐，用户只需填写地址信息，点击“完成订单”，一封包含这些信息的邮件就会发送给我。

有小费吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:49:58.870

根据您发布的要求，我会选择[WP Order Cart](http://wordpress.org/extend/plugins/wp-order-cart/)。

# java - Java - 关于 JTextField 和 JPasswordField 的问题

> ID：14921685
> 
> 赞同：0
> 
> 时间：2013-02-17T13:40:11.190
> 
> 标签：java, swing, jtextfield, jpasswordfield

```
import javax.swing.*;
import javax.swing.text.JTextComponent;
import java.awt.*;
import java.awt.event.FocusEvent;
import java.awt.event.FocusListener;

public class HintTextField extends JTextField implements FocusListener
{

    private String hint;

    public HintTextField ()
    {
        this("");
    }

    public HintTextField(final String hint)
    {
        setHint(hint);
        super.addFocusListener(this);
    }

    public void setHint(String hint)
    {
        this.hint = hint;
        setUI(new HintTextFieldUI(hint, true));
        //setText(this.hint);
    }

    public void focusGained(FocusEvent e)
    {
        if(this.getText().length() == 0)
        {
            super.setText("");
        }
    }

    public void focusLost(FocusEvent e)
    {
        if(this.getText().length() == 0)
        {
            setHint(hint);
        }
    }

    public String getText()
    {
        String typed = super.getText();
        return typed.equals(hint)?"":typed;
    }
}

class HintTextFieldUI extends javax.swing.plaf.basic.BasicTextFieldUI implements FocusListener
{

    private String hint;
    private boolean hideOnFocus;
    private Color color;

    public Color getColor()
    {
        return color;
    }

    public void setColor(Color color)
    {
        this.color = color;
        repaint();
    }

    private void repaint()
    {
        if(getComponent() != null)
        {
            getComponent().repaint();
        }
    }

    public boolean isHideOnFocus()
    {
        return hideOnFocus;
    }

    public void setHideOnFocus(boolean hideOnFocus)
    {
        this.hideOnFocus = hideOnFocus;
        repaint();
    }

    public String getHint()
    {
        return hint;
    }

    public void setHint(String hint)
    {
        this.hint = hint;
        repaint();
    }

    public HintTextFieldUI(String hint)
    {
        this(hint, false);
    }

    public HintTextFieldUI(String hint, boolean hideOnFocus)
    {
        this(hint, hideOnFocus, null);
    }

    public HintTextFieldUI(String hint, boolean hideOnFocus, Color color)
    {
        this.hint = hint;
        this.hideOnFocus = hideOnFocus;
        this.color = color;
    }

    protected void paintSafely(Graphics g)
    {
        super.paintSafely(g);
        JTextComponent comp = getComponent();
        if(hint != null && comp.getText().length() == 0 && (!(hideOnFocus && comp.hasFocus())))
        {
            if(color != null)
            {
                g.setColor(color);
            }
            else
            {
                g.setColor(Color.gray);
            }
            int padding = (comp.getHeight() - comp.getFont().getSize()) / 2;
            g.drawString(hint, 5, comp.getHeight() - padding - 1);
        }
    }

    public void focusGained(FocusEvent e)
    {
        if(hideOnFocus) repaint();

    }

    public void focusLost(FocusEvent e)
    {
        if(hideOnFocus) repaint();
    }

    protected void installListeners()
    {
        super.installListeners();
        getComponent().addFocusListener(this);
    }

    protected void uninstallListeners()
    {
        super.uninstallListeners();
        getComponent().removeFocusListener(this);
    }
} 
```

这是我的代码（`JTextField`带有输入提示）。有人可以帮助我改进我的代码吗？

1）当我单击文本字段时，我不希望提示消失。我希望只有当我在文本字段中输入内容时提示才会消失。

2) 如何`JPasswordField`使用输入提示进行编码？

如何创建类似 Facebook 移动登录页面的 JTextField 和 JPasswordField（圆形`JTextField`/`PasswordField`并粘在一起）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T18:49:28.190

> 当我单击文本字段时，我不希望提示消失。我希望只有当我在文本字段中输入内容时提示才会消失。

[文本提示](http://tips4java.wordpress.com/2009/11/29/text-prompt/)提供此功能。

我之前没有尝试过使用 JPasswordField，但它也应该在那里工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:01:23.430

```
public class Hints
{
    public static void main (String [] args)
    {
        Box mainPanel = Box.createVerticalBox ();
        mainPanel.setBackground (Color.LIGHT_GRAY);
        mainPanel.setOpaque (true);
        mainPanel.add (new HintedTextField (12, "Login"));
        mainPanel.add (Box.createVerticalStrut (1));
        mainPanel.add (new HintedPasswordField (12, "Password"));

        JPanel panel = new JPanel (new BorderLayout ());
        panel.add (mainPanel, BorderLayout.CENTER);
        panel.setBorder (BorderFactory.createEmptyBorder (8, 8, 8, 8));

        JFrame frame = new JFrame ();
        frame.setDefaultCloseOperation (JFrame.EXIT_ON_CLOSE);
        frame.getContentPane ().setLayout (new BorderLayout ());
        frame.getContentPane ().add (panel, BorderLayout.CENTER);
        frame.pack ();
        frame.setVisible (true);
    }

    private static class RoundedRectableBorder implements Border
    {
        private final boolean top;
        private final boolean bottom;

        public RoundedRectableBorder (boolean top, boolean bottom)
        {
            this.top = top;
            this.bottom = bottom;
        }

        @Override
        public void paintBorder (Component c, Graphics g, int x, int y,
                int width, int height)
        {
            Area clipArea = new Area (new Rectangle (x, y, width, height));
            clipArea.subtract (
                new Area (
                    new Rectangle (
                        x + 5, top ? y + 5 : y, width - 10, height - (top ? 5 : 0) - (bottom ? 5 : 0))));

            g.setClip (clipArea);

            g.setColor (c.getParent ().getParent ().getBackground ());
            g.fillRect (x, y, width, height);
            g.setColor (c.getBackground ());
            g.fillRoundRect (x, top ? y : (y - 5), width - 1, height + (top ? 5 : 0) + (bottom ? 5 : 0) - 1, 10, 10);
            g.setColor (c.getParent ().getBackground ());
            g.drawRoundRect (x, top ? y : (y - 5), width - 1, height + (top ? 5 : 0) + (bottom ? 5 : 0) - 1, 10, 10);
        }

        @Override
        public Insets getBorderInsets (Component c)
        {
            return new Insets (5, 5, 5, 5);
        }

        @Override
        public boolean isBorderOpaque ()
        {
            return false;
        }
    }

    private static class HintedTextField extends JTextField
    {
        private final JTextField hintField;

        public HintedTextField (int columns, String hint)
        {
            super (columns);

            setBorder (new RoundedRectableBorder (true, false));

            hintField = new JTextField (hint);
            hintField.setBorder (BorderFactory.createEmptyBorder (5, 5, 5, 5));
        }

        @Override
        protected void paintComponent (Graphics g)
        {
            super.paintComponent (g);

            if (getText ().isEmpty ())
            {
                hintField.setBounds (getBounds ());
                hintField.setForeground (getDisabledTextColor());
                hintField.setOpaque (false);
                hintField.paint (g);
            }
        }
    }

    private static class HintedPasswordField extends JPasswordField
    {
        private final JTextField hintField;

        public HintedPasswordField (int columns, String hint)
        {
            super (columns);

            setBorder (new RoundedRectableBorder (false, true));

            hintField = new JTextField (hint);
            hintField.setBorder (BorderFactory.createEmptyBorder (5, 5, 5, 5));
        }

        @Override
        protected void paintComponent (Graphics g)
        {
            super.paintComponent (g);

            if (getPassword ().length == 0)
            {
                hintField.setBounds (getBounds ());
                hintField.setForeground (getDisabledTextColor());
                hintField.setOpaque (false);
                hintField.paint (g);
            }
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T14:11:49.997

我不是摇摆迷，但我认为您的第一个问题在于这种方法：

```
public void focusGained(FocusEvent e)
{
    if(this.getText().length() == 0)
    {
        super.setText("");
    }
} 
```

为此，您说您必须创建一个线程来控制文本字段中包含的文本：

```
new Thread(){
    public void run(){
        while(true){
          String s = this.getText();
          if(s.length == 0 || s.equals(hint))
              super.setText(hint);
          else //significa che è cambiato il testo
              if(s.contains(hint))
                 super.setText(s.replace(hint, ""));
        }
    }
}.start(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-05-01T20:06:58.273

无需为 JTextField 设置文本，只需直接绘制提示即可。参见`paintComponent()`本例中的方法：

```
import java.awt.*;
import javax.swing.*;
import javax.swing.text.Document;

public class PlaceholderTextField extends JTextField {

    public static void main(final String[] args) {
        final PlaceholderTextField tf = new PlaceholderTextField("");
        tf.setColumns(20);
        tf.setPlaceholder("All your base are belong to us!");
        final Font f = tf.getFont();
        tf.setFont(new Font(f.getName(), f.getStyle(), 30));
        JOptionPane.showMessageDialog(null, tf);
    }

    private String placeholder;

    public PlaceholderTextField() {
    }

    public PlaceholderTextField(
        final Document pDoc,
        final String pText,
        final int pColumns)
    {
        super(pDoc, pText, pColumns);
    }

    public PlaceholderTextField(final int pColumns) {
        super(pColumns);
    }

    public PlaceholderTextField(final String pText) {
        super(pText);
    }

    public PlaceholderTextField(final String pText, final int pColumns) {
        super(pText, pColumns);
    }

    public String getPlaceholder() {
        return placeholder;
    }

    @Override
    protected void paintComponent(final Graphics pG) {
        super.paintComponent(pG);

        if (placeholder.length() == 0 || getText().length() > 0) {
            return;
        }

        final Graphics2D g = (Graphics2D) pG;
        g.setRenderingHint(
            RenderingHints.KEY_ANTIALIASING,
            RenderingHints.VALUE_ANTIALIAS_ON);
        g.setColor(getDisabledTextColor());
        g.drawString(placeholder, getInsets().left, pG.getFontMetrics()
            .getMaxAscent() + getInsets().top);
    }

    public void setPlaceholder(final String s) {
        placeholder = s;
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-17T15:01:24.940

为了在您输入文本字段时消失您的提示，您应该实现 Keylistener。您可以在其 keyPressed 实现中编写。

```
@Override
public void keyPressed(KeyEvent e) {
    // TODO Auto-generated method stub
    if(hideOnFocus) repaint();
} 
```

还要注释掉 focusGained() 实现。

# algorithm - 就通用数据结构而言，如何有效地列出树数据结构中某个节点下的所有叶子？

> ID：14921687
> 
> 赞同：0
> 
> 时间：2013-02-17T13:40:55.523
> 
> 标签：algorithm, data-structures, tree, linked-list

一段时间以来，我一直在想并寻找这个问题的答案，即：如何有效地（具体地在时间方面）列出树数据结构中节点下的所有叶子？

我最初认为可以通过连接该节点下所有叶子的链表来完成。

如果这是可能的，那么我们可以在 O(n) 的线性时间内遍历子树下的叶子，其中 n 是该子树下的叶子数。

但是，考虑到每个子树都需要有不同的链表，这听起来不切实际。

所以，如果有人能指出它是否可能，我将不胜感激，为什么？

在这种情况下，让我们考虑一个简单的二叉树。

问候

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:54:02.800

[B+ 树](http://en.wikipedia.org/wiki/B+_tree)允许叶子之间的指针（下一个，上一个）。假设您的所有数据都存储在叶级别，那么 B+ 树可能是完成您的要求的最佳方式。

![在此处输入图像描述](../Images/e658f84c5c97505fb9236bb5e554d9ae.png)

如果您要问，只有具有公共根节点（而不是整个树的根）的叶子节点，您可以找到该根下最左边的节点并继续关注“下一个”链接，直到您点击一个叶子节点 whos值大于根节点的右节点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T13:53:35.140

好吧，在没有特殊功能的通用树中（每个节点只有有效负载索引和指向子树的指针），您必须遍历整个子树，至少第一次没有其他方法

如果您需要使用快速方法再次访问这些叶子节点，您可以设置一个指针向量/数组，这几乎可以为您提供 O(1) 时间访问，但您必须管理指针，以便在插入新节点时你不再引用旧叶子而是新叶子

如果您需要与多个子树相对应的叶子，那么在正常情况下，一个简单快速的解决方案可能是一个多维数组（在这种情况下为 2D），但如果您的数据集非常大或内存有限（在这种情况下，您可能想要交换到对您的需求更友好的 B+Tree）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T13:45:38.520

这根本不是不切实际的。

您可以为每个叶子设置“下一个”叶子，然后在每个节点中只存储一个指向第一个（或最小）叶子和最后一个叶子（最大叶子）的指针

然后您可以从每个节点（子树）到达第一个叶子并遍历叶子。

第一个和最后一个叶子可以在插入时更新，复杂度为 O(logn)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T14:18:18.487

速度和内存大小始终是一个权衡。

科学中有数百种不同的尝试。但是所有这些额外的指针或列表等都需要额外的内存。
当速度问题在大多数情况下不是树时，这对于通用解决方案是不切实际的。
如果您需要一个非常特殊的树，对于想要列出树节点下所有叶子的特定应用程序，那么当您想要比简单地迭代左右子树更快的东西时，您将不得不使用专门的实现，我认为合理的快。

还有谁想知道所有子节点的叶子？
这是树的内部主题，从外部你甚至**不应该知道**节点下面是什么。（想想平衡的树，改变它们的结构）。

# ruby-on-rails - Json 无法在 Windows 上安装

> ID：14921688
> 
> 赞同：2
> 
> 时间：2013-02-17T13:41:04.807
> 
> 标签：ruby-on-rails, ruby, windows

我查看了很多这样的错误，但没有一个适合我的解决方案。我让 Rails 工作到几天前，我真的不明白它有什么问题。捆绑安装新应用程序，它提供：

```
Installing json (1.7.7) with native extensions
Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.

C:/RailsInstaller/Ruby193/bin/ruby.exe extconf.rb
creating Makefile

make
generating generator-i386-mingw32.def
make: *** [generator-i386-mingw32.def] Error 253

Gem files will remain installed in C:/RailsInstaller/Ruby193/lib/ruby/gems/1.9.1
/gems/json-1.7.7 for inspection.
Results logged to C:/RailsInstaller/Ruby193/lib/ruby/gems/1.9.1/gems/json-1.7.7/
ext/json/ext/generator/gem_make.out
An error occured while installing json (1.7.7), and Bundler cannot continue.
Make sure that `gem install json -v '1.7.7'` succeeds before bundling. 
```

我安装了 DevKit，用 RailsInstaller 重新安装了所有东西，然后自己安装了 DevKit。我已经安装了 MinGW。

我对 Rails 并不陌生，我无法弄清楚出了什么问题，几天前一切正常……而且我想不出我安装的可能会产生冲突的东西

谢谢。

使用解决方案进行编辑：我终于通过重新安装操作系统让它工作了（发布后几天）:) 然后我明白了再次尝试它并对命令行发誓，故障是 ansicon，通过命令使每个可执行文件崩溃线路和通过 Windows 服务。我尝试过的每个最新版本都会这样做，我无法解释。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-19T08:55:16.313

在 Rubyinstaller wiki 查看此故障排除指南：[https ://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun)

我的情况是在更新 Windows 和“场景 B”之后执行“技巧”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-13T20:35:21.270

我有同样的问题并尝试过

```
gem 'jquery-rails'
platforms :ruby do
  gem 'json'
end

platforms :mswin, :mingw do
  gem 'json_pure'
end 
```

在 gem 文件中，我得到了它的工作

# sql - 我无法在 SQL 中正确使用 MAX()

> ID：14921689
> 
> 赞同：1
> 
> 时间：2013-02-17T13:41:04.443
> 
> 标签：sql, count, group-by, max

假设我的桌子是这样的：

```
id  code    newCode
-------------------
1   30002   3000231
2   30002   3000232
3   30002   300021
4   30002   300021
5   30009   300093
6   30009   300093
7   30012   3001231
8   30012   3001232
9   30012   300124
10  30012   300121
11  30012   300121
12  30013   3001331
13  30013   3001332
14  30013   300134 
```

我想获得最多的重复项`newCode`（在这种情况下为 2 - 例如 num 10 和 11 相同，所以 2）

我的 SQL 命令是：

```
SELECT MAX(c.newCode)
FROM
            SELECT COUNT(c.newCode)
            FROM courseTaun c
            GROUP BY c.newCode 
```

我只是得到语法错误。

如果我只运行：

```
SELECT COUNT(c.newCode)
            FROM courseTaun c
            GROUP BY c.newCode 
```

我得到：

```
COUNT(c.newCode)
2
1
1
2
2
1
1
1
1
1
1 
```

如果我只跑

```
SELECT MAX(c.newCode)
FROM courseTaun c 
```

我得到值：300134

为什么我似乎不能将 2 结合起来给我需要的价值？

非常感谢帮助者:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:37:45.390

```
select max(dups) from (select count(newCode) as dups from courseTaun group by newCode) as temp1; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:44:51.600

*我猜* `NewCode`列被保存为`string`. 为了获得最大值，您需要先将其转换为数字，

```
SELECT  MAX(CAST(newCode as SIGNED))
FROM
(
    SELECT  newCode
    FROM    tableName
    GROUP   BY newCode
    HAVING  COUNT(*) > 1
) s 
```

*   [SQLFiddle 演示（*MySQL 版本*）](http://www.sqlfiddle.com/#!2/e0b98/3)

**更新 1**

```
SELECT  MAX(CAST(newCode as INT))
FROM
(
    SELECT  newCode
    FROM    table1
    GROUP   BY newCode
    HAVING  COUNT(*) > 1
) s 
```

*   [SQLFiddle 演示（*TSQL 版本*）](http://www.sqlfiddle.com/#!3/e2ac6/2)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T13:45:57.117

因为你后面缺少**括号**`FROM`

```
... FROM ( statement ) x 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T22:45:46.930

您的 SQL 命令出现语法错误，但在 SQLServer2005+ 中，您可以像这样编写没有子查询的查询

```
SELECT TOP 1 MAX(COUNT(c.newCode)) OVER()
FROM courseTaun c
GROUP BY c.newCode 
```

# android - 如何为活动的 oncreate 方法中声明的列表视图创建 onclick 列表器

> ID：14921703
> 
> 赞同：0
> 
> 时间：2013-02-17T13:43:14.190
> 
> 标签：android, listview, onclick

我有一个填充列表视图的活动。我在活动的 onCreate 方法中创建了列表视图。现在我想为列表实现一个 onclick 列表器。如何做到这一点？

这是我的列表视图活动课程：

```
public class PollStationActivity extends Activity {

    static String response_str=null;
    static String response_code=null;

    String ac_code;
    String ac_id;
    String ac_lat;
    String ac_lon;
    String ac_name;

    // Hashmap for ListView
            ArrayList<HashMap<String, String>> PSList = new ArrayList<HashMap<String, String>>();

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // no more this
         setContentView(R.layout.activity_poll_station);

         //sendPostRequest();

         //Log.i("I am here","1");

            final String status_code_from_prev= getIntent().getExtras().getString("status");

            //Log.i("ss",status_code_from_prev);

            ArrayList<PSItem> PSList = new ArrayList<PSItem>();

            DatabaseHelper db = new DatabaseHelper(PollStationActivity.this);
            ContentValues values = new ContentValues();

             try {
              db.createDataBase();

              PSList = db.select(status_code_from_prev); 

              //Log.i("Count : ", " " + PSList.isEmpty());

             } catch (IOException e) {
              e.printStackTrace();
               }

             db.close();

         String[] fromColumns = {"name"};
            int[] toViews = {R.id.list_label_name}; // The TextView in simple_list_item_1

            ListView listView1 = (ListView) findViewById(R.id.poll_list_listView);  
            List<HashMap<String, String>> fillMaps = new ArrayList<HashMap<String, String>>();

            Iterator<PSItem> i = PSList.iterator();

            while(i.hasNext())
            {
                HashMap<String, String> map = new HashMap<String, String>();
                PSItem objPSItem = i.next();

                map.put("name", objPSItem.PS_NAME);
                map.put("ps_Id", objPSItem.PS_ID);
                fillMaps.add(map);
            }

            // fill in the grid_item layout
            SimpleAdapter adapter = new SimpleAdapter(this, fillMaps, R.layout.list_layout, fromColumns, toViews);
            listView1.setAdapter(adapter);

    }
} 
```

我应该把listview onclick listner放在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T13:48:22.490

如果您使用 ListView，那么您应该使用 OnItemClickListener。在您分配适配器后，我将添加侦听器。

我更喜欢使用以下解决方案来处理点击事件。

```
public class StartActivity extends Activity implements OnItemClickListener {

    @Override
    public void onCreate(Bundle savedInstanceState) {

        setContentView(R.layout.activity_start);

        // Create adapter for the list view

        ListView lw = (ListView) findViewById(R.id.WordsListView);
        lw.setAdapter(adapter);
        lw.setOnItemClickListener(this);    
    }

    @Override
    public void onItemClick(AdapterView<?> parent, View view, int position, long id) {

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T13:56:43.570

您可以在初始化后立即设置侦听器，例如：

```
ListView listView1 = (ListView) findViewById(R.id.poll_list_listView); 
    listView1.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {
            //Handle the click
        }           
    }); 
```

即使您还没有为列表设置适配器，这意味着没有显示任何项目，只要您已经通过`findViewById`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T13:48:40.667

您必须使用 AdapterView.OnItemClickListener。

见[http://developer.android.com/reference/android/widget/AdapterView.html#setOnItemClickListener(android.widget.AdapterView.OnItemClickListener)](http://developer.android.com/reference/android/widget/AdapterView.html#setOnItemClickListener(android.widget.AdapterView.OnItemClickListener))

单击项目时将调用此处理程序，并为您提供单击项目的位置。

# c# - MinWidth 无效

> ID：14921708
> 
> 赞同：1
> 
> 时间：2013-02-17T13:43:46.733
> 
> 标签：c#, wpf, statusbar, textblock, css

我有一个带有两个 TextBlock 项的状态栏：

```
 <StatusBar 
        x:Name="MainStatusBar"
        Grid.Row="1" Grid.ColumnSpan="2" Height="30"
        HorizontalContentAlignment="Left" VerticalContentAlignment="Center">
        <StatusBarItem HorizontalAlignment="Stretch">
            <TextBlock
                x:Name="StatusBarTextBlock"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center"
                TextWrapping="NoWrap"
                Text="{Binding StatusBarText, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
        <StatusBarItem HorizontalAlignment="Right">
            <TextBlock 
                x:Name="StatusBarTimeBlock"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center"
                TextWrapping="NoWrap"
                MinWidth="75"
                Text="{Binding SearchTime, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
    </StatusBar> 
```

什么时候`StatusBarTextBlock`长，`StatusBarTimeBlock`就会短`75px`。

你有什么想法为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T15:27:11.693

那是因为你的第一个`StatusBarItem`占据了完整的位置，而第二个`StatusBarItem`不适合`StatusBar`

试试这段代码看看它做了什么

```
<StatusBar
    x:Name="MainStatusBar" Margin="14,462,0,0" HorizontalAlignment="Left" Width="600" VerticalAlignment="Top">
        <StatusBarItem MaxWidth="550">
            <TextBlock
            x:Name="StatusBarTextBlock"
            TextWrapping="NoWrap"
            Text="{Binding StatusBarText, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
        <StatusBarItem HorizontalAlignment="Right" MinWidth="75">
            <TextBlock 
            x:Name="StatusBarTimeBlock"
            TextWrapping="NoWrap"
            Text="{Binding SearchTime, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
</StatusBar> 
```

你有 600px`StatusBar`和 Max of 550px 第一个 StatusBarItem... 所以第二个只剩下 50px`StatusBarItem`所以它不适合你的 StatusBar。在您的代码中，您没有`Width`为您指定属性，`StatusBarTextBlock`因此需要全部（如果文本足够长）。

现在让我们尝试一些不同的东西......

```
<StatusBar
    x:Name="MainStatusBar" Margin="14,462,0,0" HorizontalAlignment="Left" Width="600" VerticalAlignment="Top">
        <StatusBarItem HorizontalAlignment="Right" MinWidth="250">
            <TextBlock 
            x:Name="StatusBarTimeBlock"
            TextWrapping="NoWrap"
            Text="{Binding SearchTime, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
        <StatusBarItem>
            <TextBlock
            x:Name="StatusBarTextBlock"
            TextWrapping="NoWrap"
            Text="{Binding StatusBarText, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
</StatusBar> 
```

我切换了 order of`StatusBarItems`并将 MinWidth of 设置`TimeBlock StatusBarItem`为 250px ......好吧，它被添加到了`StatusBar`并且它不再忽略 MinWidth 因为它是第一项并且它适合 600px `StatusBar`。

所以`MinWidth`只有在没有足够的空间时才被忽略`StatusBar`。

但是，如果您注意我提供的代码，您可能会注意到一些东西。有

```
<StatusBarItem HorizontalAlignment="Right" ... > 
```

这并不是说你的`StatusBarItem`with`StatusBarTimeBlock`会在右边......因为`StatusBar`无论如何，项目总是从左到右添加。所以它可能会向右对齐，但`StatusBar`如果没有其他项目，它只会与下一个项目或末尾对齐。

**编辑**

我的回答是为了回答你的问题

**当 StatusBarTextBlock 太长时，StatusBarTimeBlock 会小于 75px。你有什么想法为什么？**

它确实做到了，但它似乎不是你想要的。

正如我所说，`StatusBar`无论如何，总是从左到右添加项目。那是因为它的项目托管在`DockPanel`. 如果您知道如何`DockPanel`工作，您也知道，您可以将一些项目停靠在右侧。

所以你可以这样做。它恰好是你想要的，但没有要求。

```
<StatusBar x:Name="MainStatusBar" Margin="14,490,0,0" HorizontalAlignment="Left" Width="600" VerticalAlignment="Top">
        <StatusBarItem DockPanel.Dock="Right" HorizontalAlignment="Right" MinWidth="75">
            <TextBlock 
            x:Name="StatusBarTimeBlock"
            TextWrapping="NoWrap"
            Text="{Binding SearchTime, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
        <StatusBarItem>
            <TextBlock
            x:Name="StatusBarTextBlock"
            TextWrapping="NoWrap"
            Text="{Binding StatusBarText, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>
</StatusBar> 
```

请注意，这`StatusBarTimeBlock`又是“XAML 中的第一个”，但它停靠在右侧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-21T20:52:47.210

你说的对！

```
 <StatusBar 
        x:Name="MainStatusBar"
        Grid.Row="1" Grid.ColumnSpan="2" Height="30"
        HorizontalContentAlignment="Left" VerticalContentAlignment="Center">

        <StatusBarItem HorizontalAlignment="Right"
                       DockPanel.Dock="Right">
            <TextBlock 
                x:Name="StatusBarTimeBlock"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                TextWrapping="NoWrap"
                MinWidth="75"
                Text="{Binding SearchTime, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>

        <StatusBarItem HorizontalAlignment="Left">
            <TextBlock
                x:Name="StatusBarTextBlock"
                HorizontalAlignment="Stretch"
                VerticalAlignment="Center"
                TextWrapping="NoWrap"
                Text="{Binding StatusBarText, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>
        </StatusBarItem>

    </StatusBar> 
```

如果 StatusBarTimeBlock 是第一个块并且 StatusBarItem 具有 DockPanel.Dock="Right"，那么我的 MinWidth 始终保持 75 px！

谢谢！

# c# - 连接字符串中的数据源设置

> ID：14921720
> 
> 赞同：2
> 
> 时间：2013-02-17T13:44:36.970
> 
> 标签：c#, sql-server-2008, connection-string

考虑这两个仅因数据源设置不同而不同的连接字符串：

```
Data Source=OEM-PC\SQLEXPRESS;Initial Catalog=<databasename>;
Integrated Security=False;Persist Security Info=False;
User ID=<userid>;Password=<password>;Connect Timeout=30

Data Source=.;Initial Catalog=<databasename>;
Integrated Security=False;Persist Security Info=False;
User ID=<userid>;Password=<password>;Connect Timeout=30 
```

为什么当我使用第一个时，我会抛出错误

> *用户登录失败原因：尝试使用 SQL 身份验证登录失败。服务器配置为仅用于 Windows 身份验证。[客户： ]*

我正在使用 SQL Server 2008 Express，并且服务器配置为混合身份验证，并且我已经三倍检查使用

(a) `master.dbo.xp_instance_regread`、
(b)`SERVERPROPERTY()`和
(c) `master.sys.xp_loginconfig`。

此外，启用`sa`登录没有任何区别。

让我知道是否需要其他数据。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T17:47:40.893

听起来您安装了几个不同的 SQL Server 实例。

默认的（也使用 . 访问）设置并启用了 SQL 身份验证，而 SQLExpress 实例则没有。

使用[SQL Server 配置管理器](http://technet.microsoft.com/en-us/library/ms174212.aspx)找出您拥有的实例并正确配置它们。

# batch-file - 如果用户关闭程序，如何制作打开程序的批处理文件？

> ID：14921722
> 
> 赞同：0
> 
> 时间：2013-02-17T13:44:43.747
> 
> 标签：batch-file

我现在得到了这个：

```
@echo off
:Start
start /w run.exe
goto start 
```

我希望当你关闭程序时它不会问你什么`run.exe`。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T13:57:40.187

只需省略 start /w

```
@echo off
:Start
run.exe
goto Start 
```

# ios - CMake 2.8.10.2 使用 Xcode 4.6 失败

> ID：14921725
> 
> 赞同：1
> 
> 时间：2013-02-17T13:45:14.177
> 
> 标签：ios, xcode, cmake, allegro, allegro5

我正在尝试为 iOS 构建[Allegro](http://alleg.sf.net) 5.0.8 游戏库，似乎 CMake 2.8.10.2 在 Xcode 4.6 上失败了：

```
本地主机：构建史蒂夫$ cmake -DCMAKE_TOOLCHAIN_FILE=../cmake/Toolchain-iphone.cmake -G Xcode ..
-- C 编译器标识为 Clang 4.2.0
-- CXX 编译器标识为 Clang 4.2.0
-- 检查工作的 C 编译器使用：Xcode
-- 检查工作的 C 编译器使用：Xcode -- 损坏
/usr/local/Cellar/cmake/2.8.10.2/share/cmake/Modules/CMakeTestCCompiler.cmake:61 处的 CMake 错误（消息）：
  C 编译器
  “/Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang”
  无法编译简单的测试程序。

  它失败并显示以下输出：

   更改目录：/Users/steve/DEV/allegro/allegro-5.0.8/build/CMakeFiles/CMakeTmp

  运行构建命令：/usr/local/Cellar/cmake/2.8.10.2/bin/cmakexbuild -project
  CMAKE_TRY_COMPILE.xcodeproj 构建-目标 cmTryCompileExec2759687021
  -配置调试

  === 构建本机目标 cmTryCompileExec2759687021 OF PROJECT
  CMAKE_TRY_COMPILE WITH CONFIGURATION 调试 ===

  检查依赖项

  目标指定产品类型“com.apple.product-type.tool”，但没有
  'iphoneos' 平台的此类产品类型

  ** 构建失败 **

  以下构建命令失败：

    检查依赖项

  （1 次失败）

  CMake 将无法正确生成此项目。
调用堆栈（最近的调用优先）：
  CMakeLists.txt:31（项目）

-- 配置不完整，出现错误！
本地主机：构建史蒂夫$ cmake --version
cmake 版本 2.8.10.2
本地主机：构建史蒂夫$

```

有任何想法吗？

# perl - Moose：通过创建对象进行属性检查

> ID：14921728
> 
> 赞同：3
> 
> 时间：2013-02-17T13:45:16.173
> 
> 标签：perl, moose

我与 Moose 一起迈出了第一步，我有以下问题。似乎我可以分配模块中未指定的属性。如果我尝试访问此属性，则会出现错误消息。如何防止模块中未指定的属性的分配？在下面的示例中，我指定了年龄，尽管我没有在模块中指定。除非我试图说出来，否则这是默默接受的。我希望该错误消息已经出现在 ->new 语句之后。

编码：

```
 #!/usr/bin/perl
 use strict;
 use warnings;

 use 5.012;
 package People;
 use Moose;
 use namespace::autoclean;
 has 'name' => (is => 'rw');
 __PACKAGE__->meta->make_immutable;

 package main;
 my $friend = People->new( name => 'Peter', age => 20 ); # no error.
 say $friend->name;
 say $friend->age; # here comes the error message. 
```

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T15:41:45.777

试试这个：

```
use MooseX::StrictConstructor; 
```

当您将年龄传递给构造函数时，会抛出这样的错误：

```
Found unknown attribute(s) passed to the constructor: age ... 
```

# macos - 将跳转命令写入 x86-64 二进制文件

> ID：14921735
> 
> 赞同：3
> 
> 时间：2013-02-17T13:46:27.173
> 
> 标签：macos, assembly, x86-64, patch

我正在使用 GDB 调试 Mac OS X 64 位应用程序。我看到跳过一大段代码解决了我所有的问题。

但：

如何修补可执行文件以实现跳转？我希望应用程序在没有调试器的情况下自动跳转到代码中的定义点。

这就是我想要做的：

在 address `0x1000027a9`（由调试器给出）跳转到 address `0x100003b6e`。我正在努力通过 HexEdit 做到这一点，但没有成功。我在任何地方读到了关于 jmp 到绝对地址操作码的信息（`FF`似乎是正确的操作码，但它是一个调用，而不是一个跳转......）但没有任何效果。访问不正确，段错误。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T14:59:25.160

你要的不是a `call`，而是a `jmp`，而且你要的是直接的`jmp`。直接跳转通常使用相对于下一条指令地址的寻址（请参阅[我对 SO 问题的回答：How encode a relative short jmp in x86](https://stackoverflow.com/questions/14889643/how-encode-a-relative-short-jmp-in-x86/14893159#14893159)）。相对于跳转指令的*结束*是另一种看待它的方式。

所以，你在`0x1000027a9`并且想要跳到`0x100003b6e`.

`0x100003b6e`- `0x1000027a9`= `0x000013C5`= `5061d`，因此绝对不适合短跳转（`rel8`在英特尔文档中），但您需要`jmp rel32`. 它也适合`rel16`，但 x86-64（在 64 位模式下）不支持。

所以，你想要一个`jmp rel32`. **这是相对于 之后的下一条指令进行`jmp`**编码的，并且由于指令的长度是 5 个字节（`E9 xx xx xx xx`），`rel32`因此将是`0x000013C0`。由于 x86 是 little-endian 架构，因此它被编码为`E9 C0 13 00 00`.

为了确认这一点，我用 NASM 组装了一个小型测试可执行文件，并用 ndisasm 反汇编它（注意我留下了第一个`0x10000000`字节，但由于跳转是相对的，它不会改变编码中的任何内容）：

```
000027A8  90                nop
000027A9  E9C0130000        jmp dword 0x3b6e ; this is the instruction you need.
000027AE  90                nop 
```

# ios - Objective-C Returning years & days since a particular date

> ID：14921738
> 
> 赞同：1
> 
> 时间：2013-02-17T13:46:44.910
> 
> 标签：ios, objective-c, cocoa-touch

I have observed the documentation for a particular method which gets an interval between a date:

```
- (NSTimeInterval)timeIntervalSinceDate:(NSDate *)anotherDate 
```

What I need this this method (or an alternative) to provide me with the Years and Days since a given date.

How would I be able to calculate this? I could use days/365 and then the remainder be the days but this isn't very accurate and I need accuracy for this.

Thanks!

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:51:36.027

using `- (NSTimeInterval)timeIntervalSinceDate:(NSDate *)anotherDate` will fail in many cases (Daylight saving times, leap seconds,…), you should take a calendar into account, as those are aware this.

```
NSCalendar *gregorianCalendar = [[NSCalendar alloc] initWithCalendarIdentifier:NSGregorianCalendar];
NSDateComponents *components = [gregorianCalendar components:(NSDayCalendarUnit |NSYearCalendarUnit )
                                                    fromDate:startDate
                                                      toDate:[NSDate date]
                                                     options:0];

NSLog(@"%ld", [components day]);
NSLog(@"%ld", [components year]); 
```

# scala - Play Framework 2 / 如何确保表单输入日期为 4 位数字的年份？

> ID：14921740
> 
> 赞同：1
> 
> 时间：2013-02-17T13:47:30.513
> 
> 标签：scala, playframework-2.0

我使用 PlayFramework 2.1 和 Scala 作为主要语言。

我有一个带有输入日期的网络表单。我想强制用户按照这种模式输入日期：`dd/MM/yyyy`.

因此，我在控制器中精确了这样的模式：

```
 val myForm = Form(
    mapping(
      "date" -> date("dd/MM/yyyy")
    )(MyModel.apply)(MyModel.unapply)
  ) 
```

然而，类似模式也`dd/mm/yyy`被接受......例如：`17/02/201`而不是`17/02/2013`. 相反，`dd/mm`不接受，我所期望的。

是否有一种有效且干净的方法来保证全年 4 位数的预期模式？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T16:20:47.643

我会从稍微不同的角度来看待它。您可能希望确保年份大于 999（甚至更高）。

为此，您需要`verify`映射。为此，您可以创建`Constraint`与此类似的：

```
def minYear(minYear: Int): Constraint[Date] = 
  Constraint[Date]("constraint.minYear", minYear) { o =>
    if (o.getYear >= minYear) Valid
    else Invalid(ValidationError("error.minYear", minYear))
  } 
```

然后你可以像这样使用它：

```
val myForm = Form(
  mapping(
    "date" -> date("dd/MM/yyyy").verifying(minYear(999))
  )(MyModel.apply)(MyModel.unapply)
) 
```

不要忘记将`constraint.minYear`和添加`error.minYear`到您的[`messages`](http://www.playframework.com/documentation/2.1.0/ScalaI18N)文件中。

# android - Android如何更新列表视图中的进度条，同时使用aws sdk将文件上传到亚马逊

> ID：14921742
> 
> 赞同：0
> 
> 时间：2013-02-17T13:47:44.467
> 
> 标签：android, amazon-web-services, android-listview, amazon-s3, android-progressbar

我正在使用 aws SDK 上传一组图像。我有一个 ListView，每个列表项都包含一个 ProgressBar(Style:Horizo​​ntal)，我需要根据上传的文件设置进度。

我使用来自 aws SDK ( [http://aws.amazon.com/releasenotes/Java/3538638977238478](http://aws.amazon.com/releasenotes/Java/3538638977238478) ) 的 TransferManager 来获取上传的数据。

我试过这个，但它不起作用：

```
public class SyncFragment extends Fragment {

    ListView uploadList;
    public UploadAdapter uploadAdapter;

    public ArrayList<QueueItem> queueList = new ArrayList<QueueItem>();

    AWSCredentials myCredentials = new BasicAWSCredentials(Constants.ACCESS_KEY_ID, Constants.SECRET_KEY);
    TransferManager tm = new TransferManager(myCredentials);

    // Empty cons as per documentation of Fragments
    public SyncFragment() {
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        setHasOptionsMenu(true);
        // Set the queue list
        queueList = ((NSApplication) getActivity().getApplication()).queueList;
        // Init Adapter
        uploadAdapter = new UploadAdapter(getActivity());
        super.onCreate(savedInstanceState);
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View view = inflater.inflate(R.layout.upload_list, container, false);

        uploadList = (ListView) view.findViewById(R.id.uploadList);
        uploadList.setAdapter(uploadAdapter);

        return view;
    }

    class UploadAdapter extends ArrayAdapter<QueueItem> {

        private LayoutInflater layoutInflater;
        private BitmapFromId bitmapFromId;
        QueueItem item;

        public UploadAdapter(Context context) {
            super(context, 0);
            layoutInflater = (LayoutInflater) context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);
            bitmapFromId = new BitmapFromId(context);
        }

        @Override
        public int getCount() {
            // Set the total list item count
            return queueList.size();
        }

        @Override
        public QueueItem getItem(int position) {
            return queueList.get(position);
        }

        @Override
        public long getItemId(int position) {
            return position;
        }

        @Override
        public View getView(int position, View convertView, ViewGroup parent) {

            ViewHolder holder;
            if (convertView == null) {
                convertView = layoutInflater.inflate(R.layout.listitem_upload, null);
                holder = new ViewHolder();

                holder.albumName = (TextView) convertView.findViewById(R.id.albumTitle);
                holder.thumb = (ImageView) convertView.findViewById(R.id.thumb);
                holder.progressBar = (ProgressBar) convertView.findViewById(R.id.progressbar_Horizontal);

                convertView.setTag(holder);
            } else {
                holder = (ViewHolder) convertView.getTag();
            }

            item = getItem(position);

            item.progress = 0;

            // load bitmap from id
            bitmapFromId.DisplayImage(Long.parseLong(item.itemId), holder.thumb);

            holder.albumName.setText(item.itemName);

            S3PutObjectTask task = new S3PutObjectTask();
            task.execute(item.itemActualPath, item.itemId);

            holder.progressBar.setProgress(item.progress);

            return convertView;
        }

        private class S3PutObjectTask extends AsyncTask<String, Integer, S3TaskResult> {

            int progress;

            protected void onPreExecute() {
                progress = 0;
            }

            protected S3TaskResult doInBackground(String... params) {

                S3TaskResult result = new S3TaskResult();
                // The file location of the image selected.
                String imagePath = params[0];

                // Put the image data into S3.
                try {

                    File image = new java.io.File(imagePath);

                    Transfer myUpload = tm.upload(Constants.getPictureBucket(), params[1] + ".jpg", image);

                    while (myUpload.isDone() == false) {
                        progress = (int) (myUpload.getProgress().getBytesTransfered() * 100 / image.length());
                        publishProgress(progress);
                    }

                    myUpload.waitForCompletion();

                } catch (Exception exception) {

                    result.setErrorMessage(exception.getMessage());
                }

                return result;
            }

            @Override
            protected void onProgressUpdate(Integer... values) {
                item.progress = values[0];
                uploadAdapter.notifyDataSetChanged();
            }

            protected void onPostExecute(S3TaskResult result) {

                Toast.makeText(getActivity(), "uploaded sucessfully!", Toast.LENGTH_SHORT).show();

                if (result.getErrorMessage() != null) {

                    Toast.makeText(getActivity(), "upload failed...", Toast.LENGTH_SHORT).show();
                }
            }

        }

        public class S3TaskResult {
            String errorMessage = null;
            Uri uri = null;

            public String getErrorMessage() {
                return errorMessage;
            }

            public void setErrorMessage(String errorMessage) {
                this.errorMessage = errorMessage;
            }

            public Uri getUri() {
                return uri;
            }

            public void setUri(Uri uri) {
                this.uri = uri;
            }
        }
    }

    public static class ViewHolder {
        ImageView thumb;
        TextView albumName;
        ProgressBar progressBar;
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T18:17:50.800

这是我从您的代码中看到的：

*   您使用 TransferManager 的方式和更新传输进度的想法是正确的。但是，我建议您在 while 循环之外再次更新进度以获取正确的完成状态。
*   UploadAdapter 中的“QueueItem item”非常可疑。您的所有 S3PutObjectTask 对象共享一个项目，其值在 getView 中分配，并在 Android 绘制每个列表项目时被覆盖。我相信当有多个任务在运行时，进度会一团糟。最好将队列项和任务关联在一起，以便任务可以通过关联的队列项更新其进度。
*   由于 Android 中的视图回收，重绘列表项时可以重新启动任务。

我希望以上内容可以帮助您诊断问题。

# spring-security - 使用 Spring Security 进行 Websocket 身份验证

> ID：14921748
> 
> 赞同：5
> 
> 时间：2013-02-17T13:48:24.827
> 
> 标签：spring-security, websocket, tomcat7

我正在 Tomcat7 上使用 Spring MVC 构建一个 webapp，并且我正在使用 Spring Security 进行用户身份验证。除了标准控制器，我还有一个需要对连接进行身份验证的 websocket servlet。

流程如下：客户端连接到服务器并重定向到登录页面，认证成功后，他收到的视图尝试连接到套接字。我需要确保只有经过身份验证的用户才能启动 websocket 连接。

经过一番研究，我发现验证启动 websocket 连接的 Http Upgrade 请求应该足够了。但是，对于如何使用我使用的技术来做到这一点，我感到很困惑。简单拦截指向 websocket 的 url 似乎不起作用，因为尝试使用 302 响应连接到套接字端，所以我猜身份验证失败，我被重定向到我的登录页面。对于解决问题的一些帮助，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-06-17T16:02:07.320

Spring security 4.x 具有原生 websocket 支持，它可以很好地与您通过 HTTP 进行的身份验证集成。

您可以在此处查看文档：http: [//docs.spring.io/autorepo/docs/spring-security/4.0.x/reference/html/websocket.html](http://docs.spring.io/autorepo/docs/spring-security/4.0.x/reference/html/websocket.html)

# python - 试图跳过带有缩写的州

> ID：14921752
> 
> 赞同：0
> 
> 时间：2013-02-17T13:49:02.547
> 
> 标签：python, nfa

我试图在这个 nfa 中使用缩写来从一个州到另一个州。

NFA 定义为

```
nfa = NFA(
start = 0,
finals = [6],
abrs = {1:5, 3:5},
edges=[
(0,'h', 1),
(1,'a', 2),
(2,'z', 3),
(3,'a', 4),
(4,'r', 5),
(5,'d', 6)
]) 
```

我在处理字符串时创建了这个内部方法。

```
 char = ":"
 elif char is tape[index]:
        print " abreviation found!!"
        #goto to state

        gotoState = set([e[2] for e in nfa.abrs
                        if e[0] in nfa.edges and
                        tape[index+1] == e[1]
                        ])
        index += 1 
```

当尝试使用 test print =>`print nrec("h:d", nfa, 1)`它返回 false 事情是它没有创建状态。当`:`-sign 出现时，我想创建来自`("h:z")`应该给出所有这些状态 =>的示例的状态`('h'->'a'->'z'->'a'->'r'->'d')`，我该如何修改这个方法来执行这个任务？`NFA`这是在创建结构后处理字符串的定义方法。

```
def nrec(tape, nfa, trace=0):
"""Recognize in linear time similarly to transform NFA to DFA """
char = ":"
index = 0
states = [nfa.start]
while True:
    if trace > 0: print " Tape:", tape[index:], "   States:", states
    if index == len(tape): # End of input reached
        successtates = [s for s in states
                          if s in nfa.finals]
        # If this is nonempty return True, otherwise False.
        return len(successtates)> 0
    elif len(states) == 0:
        # Not reached end of string, but no states.
        return False
    elif char is tape[index]:
        print " abreviation found!!"
        #skip to state

        gotoState = set([e[2] for e in nfa.abrs
                        if e[0] in nfa.edges and
                        tape[index+1] == e[1]
                        ])
        index += 1
    # the add on method to take in abreviations by sign: :
    else:
        # Calculate the new states.
        states = set([e[2] for e in nfa.edges
                           if e[0] in states and
                              tape[index] == e[1] 
                      ])
        # Move one step in the string
        index += 1 
```

如何使缩写正常工作并返回 true？

# javascript - COM 对象 c++/cli

> ID：14921753
> 
> 赞同：0
> 
> 时间：2013-02-17T13:49:03.803
> 
> 标签：javascript, windows, internet-explorer, com, c++-cli

我正在尝试将 maged c++/cli 程序集用作 html 中的对象。

```
<object classid="http://127.0.0.1/xxx/yyy_CLI.dll#FooClass" id="dummy" ></object> 
```

班级好像是这样的

```
#pragma once

using namespace System;
using namespace System::Runtime::InteropServices;

[Guid("D81FDD51-ABB0-480b-A5F9-0DE209C8456E")]
[ComVisibleAttribute(true)]
public interface class IFooClass
{
    virtual void Initialize() = 0;
};

[Guid("D0556663-B16C-403f-B6E1-C5154BE54EF9")]
[ComVisibleAttribute(true)]
public ref class FooClass: public IFooClass
{
public:
    FooClass(void);
    virtual ~FooClass(void);

    virtual void Initialize();

}; 
```

但是，当 javascript 尝试调用 Initialize 方法时，它会显示“...错误：对象不支持此属性或方法...”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T00:38:19.617

我可能离这里很远，自从我接触 COM 以来已经有很多年了，但它是这样的：

我认为您需要通过`InterfaceType`属性设置接口类型。就像是：

```
[InterfaceType(ComInterfaceType::InterfaceIsDual)]
[Guid("D81FDD51-ABB0-480b-A5F9-0DE209C8456E")]
[ComVisibleAttribute(true)]
public interface class IFooClass
{
...
} 
```

此外，**您需要**使用[Tlbexp.exe](http://msdn.microsoft.com/en-us/library/hfzzah2c%28VS.80%29.aspx)（类型库导出器）将托管类导出到 COM。

# c# - 将在 C# 刷新 CPU 缓存中使用内核对象吗？

> ID：14921754
> 
> 赞同：3
> 
> 时间：2013-02-17T13:49:12.297
> 
> 标签：c#, .net, multithreading, .net-4.0, .net-4.5

如果我有类似这样的代码：

```
ManualResetEvent me = new ManualResetEvent(false);
. . .
int a = 10;
. . .
me.WaitOne();
. . . 
```

假设`a`是在 CPU 缓存中赋值后，*会调用 WaitOne 将其刷新到 RAM 中吗？*

或者（更重要的是）

**从 .NET 访问内核同步对象（如 WaitHangle）会导致 CPU 缓存刷新/内存屏障吗？**

或者

**切换到内核模式是否需要内存屏障？**

# php - 在多个浏览器中维护自动登录

> ID：14921755
> 
> 赞同：0
> 
> 时间：2013-02-17T13:49:39.870
> 
> 标签：php, cookies, login

我的网站将提供“记住我”选项，通过该选项设置登录 cookie，并更新数据库中的 cookie 字段。虽然这对于只使用一个浏览器的用户非常有效，但当他们在多个浏览器上使用“记住我”选项时会出现问题：第二个浏览器覆盖数据库中的 cookie 列，从而使第一个 cookie 无法使用。在代码中，这看起来类似于：

**浏览器1、登录并记住**

```
$db->setLoginCookie();
setcookie(login cookie); 
```

**浏览器一、用cookie登录**

```
if (db_has_valid_cookie()) login();
else show_login_form(); 
```

**浏览器2、登录并记住**

```
$db->replaceCookie();
setcookie(new cookie); 
```

**浏览器 1，尝试使用 cookie 登录**

```
if (db_has_valid_cookie()) login(); //Does not work because it's been overridden
else show_login_form(); //Login form is shown 
```

有人可以建议解决此问题的方法吗？

# android - 设置背景图片代码

> ID：14921756
> 
> 赞同：1
> 
> 时间：2013-02-17T13:49:40.273
> 
> 标签：android, image, background, onclick, wallpaper

```
 ImageView im1_b;
    im1_b = (ImageView)findViewById(R.id.b_01_b);
    im1_b.setOnClickListener(new OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            AlertDialog.Builder builder = new AlertDialog.Builder(Next_2Activity.this);
            builder.setTitle("Project Gmelon");
            builder.setMessage("Are you sure set Wallpaper?");
            builder.setNegativeButton("NO", new DialogInterface.OnClickListener() {
                @Override
                public void onClick(DialogInterface dialog, int which) {
               Toast.makeText(getApplicationContext(),
                       "You Select NO", Toast.LENGTH_LONG) .show();
                }
            });
            builder.setPositiveButton("YES", new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {

                    WallpaperManager myWallpaperManager
                    = WallpaperManager.getInstance(getApplicationContext());
                   try {
                    myWallpaperManager.setResource(R.drawable.b_01_i);
                   } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                   }
                    Toast.makeText(getApplicationContext(),
                           "Setting Complete, Thanks.", Toast.LENGTH_LONG) .show();
                }

            });

            builder.show();
        }
    }); 
```

我写了这样的代码来设置墙纸..但是

我的形象是这样设置的。( [http://wemakeucc.com/1.jpg](http://wemakeucc.com/1.jpg) )

我想要这样.. ( [http://wemakeucc.com/2.JPG](http://wemakeucc.com/2.JPG) )

我能怎么做..？

**编辑1>**

```
ImageView im1_b;
im1_b = (ImageView)findViewById(R.id.b_01_b);
im1_b.setScaleType(ImageView.ScaleType.CENTER_INSIDE);
im1_b.setOnClickListener(new OnClickListener() { 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:01:38.970

如果你想在代码中做到这一点，你可以这样做：

```
YOUR_IMAGE_VIEW.setScaleType(ImageView.ScaleType.CENTER_INSIDE); 
```

如果您愿意，您可以选择尝试其他比例类型而不是 CENTER_INSIDE！

如果要在 xml 中执行此操作，请使用所需的比例类型设置 scaleType 属性：

```
android:scaleType="centerInside" 
```

检查此链接以了解秤类型：[秤类型](http://developer.android.com/reference/android/widget/ImageView.ScaleType.html)

# java - 是否可以通过命令提示符在 Eclipse 中编译 Python 源文件？

> ID：14921760
> 
> 赞同：-1
> 
> 时间：2013-02-17T13:50:03.700
> 
> 标签：java, python, eclipse, cmd

我已经能够在 Eclipse 中编译一个完美运行的 C 程序。我已经安装了 python 解释器并且已经在 Windows 中设置了环境变量。

这些是 C 的代码。如何修改它以编译 .py(Python) 源文件。谢谢

```
public class C_Compile {
public static void main(String args[]){

    String ret = compile();
    System.out.println(ret);

}
    public static String compile()
    {
        String log="";
        String myDirectory = "C:\\";
         try {
             String s= null;
           //change this string to your compilers location
             Process p = Runtime.getRuntime().exec("cmd /C gcc Hello.c", null, new java.io.File(myDirectory));

         BufferedReader stdError = new BufferedReader(new 
              InputStreamReader(p.getErrorStream()));
         boolean error=false;

         log+="";
         while ((s = stdError.readLine()) != null) {
             log+=s;
             error=true;
             log+="\n";

         }
         if(error==false) log+="Compilation Successful !!!";

     } catch (IOException e) {
         e.printStackTrace();
     }
         return log;
    }

  public int runProgram() 
    {
        int ret = -1;
       try
         {            
             Runtime rt = Runtime.getRuntime();
             Process proc = rt.exec("cmd.exe /c start a.exe");
             proc.waitFor();
             ret = proc.exitValue();
         } catch (Throwable t)
           {
             t.printStackTrace();
             return ret;
           }
       return ret;                      
    }} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:00:41.560

默认情况下，eclipse 没有 python 运行时。`Pydev`是一个流行的 eclipse 插件，它为你提供了这个功能。

引用[Pydev](http://pydev.org)的网站：

> PyDev 是一个用于 Eclipse 的 Python IDE，可用于 Python、Jython 和 IronPython 开发。

但是，如果您正在寻找从命令提示符运行它，并且设置了 python 环境变量，则可以使用 command `python <path>`，其中 path 是 python 源文件的相对/绝对路径。

# opengl - 纹理不显示循环

> ID：14921761
> 
> 赞同：0
> 
> 时间：2013-02-17T13:50:09.450
> 
> 标签：opengl

跟进问题：

*   我需要为 FBO 设置不同的活动纹理吗？这可能是原因，因为我没有考虑到这一点。无论哪种方式，我的活动纹理都有问题。如果我在这一切之前将活动纹理设置为 TEXTURE_1，我会得到对象的纹理（但是错误的纹理）。

    ```
    for (int side = 0; side < 2; side++)
    {

        glPushAttrib(GL_ALL_ATTRIB_BITS);
        glBindTexture(GL_TEXTURE_2D, 0); // Delete this line and a, wrong, texure pops up for the second iteration
        glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, modelsFboId[side]);

        glViewport(0,0,screenWidth,screenHeight);
        glMatrixMode(GL_PROJECTION);
        glLoadIdentity();
        gluPerspective(SCREEN_FOV, SCREEN_RAT, NEAR, FAR);
        glMatrixMode(GL_MODELVIEW);
        glLoadIdentity();
        glShadeModel(GL_SMOOTH);
        glHint(GL_PERSPECTIVE_CORRECTION_HINT,
            GL_NICEST);
        glDisable(GL_BLEND);
        glEnable(GL_DEPTH_TEST);
        glDepthFunc(GL_LESS);
        glDepthMask(true);
        glClearColor(0.0f, 0.0f, 0.0f, 1.0f);
        glClearDepth(1.0f);
        glClear (GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT);

        glLoadIdentity (); 

        camera.look();

        drawObject();

        glDisable(GL_DEPTH_TEST);
        glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0);

        glPopAttrib();
    } 
    ```

我循环了两个 fbo，它们也是在一个循环中创建的。fbo 工作正常，但是纹理不想绑定的第二次迭代。我尝试为第二次迭代切换到不同的活动纹理，我禁用了一个着色器，我也尝试设置 clientactivetexture。如果我跳过第一次迭代，则第二个循环不起作用。当我附加颜色而不是纹理时，对象会显示（它根本不显示纹理绑定）。

我试图追踪这个错误两天了，但无济于事。

此外，在这个循环之后，我有第二个循环，它是相同的，除了它使用一个显示列表，它对两个迭代都很好，这可能表明了一些事情。

```
 for (int side = 0; side < 2; side++) {
        modelsFboId[side] = glGenFramebuffersEXT();                                     
        modelsFboTextureId[side] = glGenTextures();                                     
        modelsDepthRenderBufferId[side] = glGenRenderbuffersEXT();

        glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, modelsFboId[side]);    

        glBindTexture(GL_TEXTURE_2D, modelsFboTextureId[side]);                             
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MIN_FILTER, GL_LINEAR);                       
        glTexParameterf(GL_TEXTURE_2D, GL_TEXTURE_MAG_FILTER, GL_LINEAR);           
        glTexImage2D(GL_TEXTURE_2D, 0, GL_RGBA8, screenWidth, screenHeight, 0,GL_RGBA, GL_INT, (java.nio.ByteBuffer) null); 
        glFramebufferTexture2DEXT(GL_FRAMEBUFFER_EXT,GL_COLOR_ATTACHMENT0_EXT,GL_TEXTURE_2D, modelsFboTextureId[side], 0); 

        glBindRenderbufferEXT(GL_RENDERBUFFER_EXT, modelsDepthRenderBufferId[side]);         
        glRenderbufferStorageEXT(GL_RENDERBUFFER_EXT, GL_DEPTH_COMPONENT, screenWidth, screenHeight);
        glFramebufferRenderbufferEXT(GL_FRAMEBUFFER_EXT,GL_DEPTH_ATTACHMENT_EXT,GL_RENDERBUFFER_EXT, modelsDepthRenderBufferId[side]); 
        glBindFramebufferEXT(GL_FRAMEBUFFER_EXT, 0);
      } 
```

绘制对象（）：

```
 // using bind slick, texture int doesn't change in this function nor any other

    if (textureMode == 1) {
        glColor3f(color.x, color.y, color.z);
    } else if (textureMode == 0) {
        glColor3f(1.0f, 1.0f, 1.0f);
        glEnable(GL_TEXTURE_2D);
        textures[texture].bind();
    }

    glPushMatrix();
    ..rotations.. all seems definitely fine here and certainly doesn't change in correspondence to the prev iteration.

    .. draw actual object.. tried LWJGL sphere, a simple cube and some other LWJGL objects
    glPopMatrix();

    if (textureMode == 0)
        glDisable(GL_TEXTURE_2D); 
```

数组初始化..

```
int skyFboId[] = {-1, -1};
int skyFboTextureId[] = {-1, -1};

int modelsFboId[] = {-1, -1};
int modelsFboTextureId[] = {-1, -1};
int modelsDepthRenderBufferId[] = {-1, -1};

int listModelsFboId[] = {-1, -1};
int listModelsFboTextureId[] = {-1, -1};
int listModelsDepthRenderBufferId[] = {-1, -1};
int listModelsTextureLocation = -1; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T13:32:09.180

显然，Slick 库需要使用 TextureImpl.unbind() 取消绑定纹理。

# java - 字段变量产生的结果与递归的局部变量不同

> ID：14921763
> 
> 赞同：1
> 
> 时间：2013-02-17T13:50:16.497
> 
> 标签：java, variables, global-variables

我有这个非常奇怪的问题，我不知道为什么。

```
public class QuickSort
{
  private int pivLocation;
  private void quickSort(Integer[] input, int low, int high)
  {
    if(low < high)
    {
      this.pivLocation = partition(input, low, high);
      quickSort(input, low, pivLocation-1);
      quickSort(input, pivLocation+1, high);
      Inversions.comparisons += high - low;
    }
  }
}

private int partition(Integer[] input, int low, int high)
{

        int arrLength = high - low;

        if(arrLength%2 == 0){

            int pivot = input[low];
        }
        else
        {
            int pivot = 1;
        }
    int i = low+1;
    for(int j=low+1; j<= high; j++ )
    {

        if(input[j]< pivot)
        {

            swap(input, j, i);
            i++;
        }
    }
    swap(input, low, i-1);

    return i-1;

} 
```

与编写完全相同的代码相比，这给出了不同的比较计数，但我没有使用字段变量，而是将 pivLocation 转换为局部变量。

```
int pivLocation = partition(input, low, high); 
```

我不明白为什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T13:52:15.793

因为递归。每次调用该方法时都会初始化局部变量。

当你有：

```
int var;
void mymethod() {
   mymethod();
} 
```

`var`只初始化一次。

与

```
void mymethod() {
   int var;
   mymethod();
} 
```

`var`每次`mymethod()`调用时都会被初始化（设置为零），因为变量范围在方法内是有限的。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-17T13:54:21.923

使用类变量时，请考虑以下事项：

```
pivLocation = partition(input,low,high);
// pivLocation changes in this function (specifically to a lower value)
quickSort(input, low, pivLocation-1);
// pivLocation is now lower than expected
quickSort(input, pivLocation+1, high); 
```

因此，第二个`quickSort`被调用的索引可能包括已经排序的元素。因此，比较的次数将高于所需的次数。

当你使用一个局部变量时，每个递归调用都有它自己的`pivLocation`变量，所以你没有这个问题。

# c - 为什么以 0 开头的整数会奇怪地打印出来？

> ID：14921765
> 
> 赞同：2
> 
> 时间：2013-02-17T13:50:28.693
> 
> 标签：c

我正在用 C 语言（使用 Eclipse）编写一个函数，它有一个名为 的整数`alpha`，它的赋值是`077`.

但是当我打印出来时，它会打印`63`而不是`77`or `077`。

事实上，不仅仅是`077`任何带前导的整数*都*`0`在打印一个意想不到的值。当我从中删除`0`时`077`，它*会*打印正确的值`77`。

这种领先`0`有什么影响？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-17T13:51:11.283

以 a 开头的数字`0`是八进制数。

`077`是`7 x 8 + 7 == 63`

# mysql - 在表或列的标题中使用 SQL 关键字

> ID：14921770
> 
> 赞同：4
> 
> 时间：2013-02-17T13:50:55.293
> 
> 标签：mysql, sql, keyword

我想将我的一张表命名为`ORDER`. 我可以在 SQL 中使用关键字作为名称吗？这种做法有多糟糕？是否要这样做？

如果这种情况已经存在，那么如何在查询中使用该表的名称？例如，我想要：

```
SELECT * FROM ORDER; 
```

或者

```
SELECT * FROM ORDER ORDER BY NAME; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T13:51:36.407

用反引号包装 tableName 作为`ORDER`保留关键字。

```
SELECT * FROM `ORDER` ORDER BY NAME; 
```

*   [MySQL 保留关键字列表](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)

在我自己看来，使用保留关键字很好，只是你不要忘记正确处理它，因为它会给你带来如此痛苦的脖子。

但是通过多年的架构设计，我从未使用过保留关键字`:D`

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-17T13:59:11.900

正如在另一个答案中所观察到的，在 MySQL 中使用反引号表示一个词是数据库对象，从而防止与保留词混淆 - 在 SQL 的其他方言中，使用方括号`[ ]`(SQLServer) 或双引号`" "`（大多数其他方言）代替.

根据我的经验，在表结构中使用保留字往往会导致问题，尤其是在编写新查询时 - 可能需要一段时间才能意识到返回的错误是由于保留字是列名。还有一点（正如这个问题的存在所表明的那样）不是每个人都知道您可以通过在查询中使用适当的引用字符来解决问题。

# python - backref 类属性

> ID：14921777
> 
> 赞同：8
> 
> 时间：2013-02-17T13:51:50.747
> 
> 标签：python, sqlalchemy

如何在不通过会话进行一些查询的情况下初始化映射器的反向引用？例如，我有两个模型，分别在以下代码中命名为“Client”和“Subject”：

```
Base = declarative_base()

class Client(Base):
    __tablename__ = "clients"

    id = Column(Integer, primary_key=True)
    created = Column(DateTime, default=datetime.datetime.now)
    name = Column(String)

    subjects = relationship("Subject",  cascade="all,delete",
        backref=backref("client"))

class Subject(Base):
    __tablename__ = "subjects"

    id = Column(Integer, primary_key=True)
    client_id = Column(Integer, ForeignKey(Client.id, ondelete='CASCADE')) 
```

然后，在我的代码中的某个地方，我想像这样获取`client`类的 backref `Subject`，但这会引发异常：

```
>>> Subject.client
AttributeError: type object 'Subject' has no attribute 'client' 
```

查询后点`Client`赞：

```
>>> session.query(Client).first()
>>> Subject.client
<sqlalchemy.orm.attributes.InstrumentedAttribute at 0x43ca1d0> 
```

属性`client`是在查询相关模型（映射器）后创建的。
我不想做这样的“温暖”查询！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-17T14:48:03.387

或者，您可以使用：

```
from sqlalchemy.orm import configure_mappers

configure_mappers() 
```

这样做的好处是它可以一步创建所有模型的所有反向引用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-17T14:05:54.323

因为 SQLAlchemy 使用元类，所以在另一个类上创建反向引用的代码将不会运行，直到您创建了该类的至少*一个*实例`Client`。

补救方法很简单：创建一个`Client()`实例，然后再次丢弃它：

```
>>> Subject.client
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
AttributeError: type object 'Subject' has no attribute 'client'
>>> Client()
<__main__.Client object at 0x104bdc690>
>>> Subject.client
<sqlalchemy.orm.attributes.InstrumentedAttribute object at 0x104be9e10> 
```

或使用[`configure_mappers`](http://docs.sqlalchemy.org/ru/latest/orm/mapper_config.html#sqlalchemy.orm.configure_mappers)实用功能：

```
from sqlalchemy.orm import configure_mappers 
```

扫描您的模型以获取此类引用并初始化它们。实际上，创建任何一个实例都会在后台调用此方法。

# javascript - 创建构造函数和适配器以读取 xml

> ID：14921780
> 
> 赞同：1
> 
> 时间：2013-02-17T13:52:01.937
> 
> 标签：javascript, xml

```
 <Analysis id="1" name="Agricultural Resources" >
    <MapObjects>
      <MapObject Instance="mobject_2" name_area="Ukraine">
        <Contact>
          <Name>Testing</Name>
      <Tell>012312</Tell>
    </Contact>
      </MapObjects>
  </Analysis> 
```

这是 XML ..我需要编写一个构造函数和一个调用函数的适配器。我需要用分析填充下拉列表和一个带有和细节的 HTML ..

```
 function getData() {
        var d = new Date();
        var tt = d.getMilliseconds();
        durl = 'data.xml?tt' + tt;
        $.ajax({
            type: "GET",
            url: durl,
            dataType: "xml",
            success: parseXml
        });
    } 
```

我写这个是为了提取 xml ..我需要更进一步。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:08:34.850

你应该从修复你的 XML 开始，你`<MapObject>`没有关闭：

```
<Analysis id="1" name="Agricultural Resources">
    <MapObjects>
        <MapObject Instance="mobject_2" name_area="Ukraine">
            <Contact>
                <Name>Testing</Name>
                <Tell>012312</Tell>
            </Contact>
        </MapObject>
    </MapObjects>
</Analysis> 
```

然后您可以在`parseXml`函数中查询 XML 以提取您感兴趣的值。例如，为了提取`Name`and`Tell`节点，您可以首先遍历所有 MapObject 节点并检索相应的值：

```
function parseXml(xml) {
    $(xml).find('MapObject').each(function() {
        var nameArea = $(this).attr('name_area');
        var name = $(this).find('Name').text();
        var phone = $(this).find('Tell').text();
        alert('name_area: ' + nameArea  + ', name: ' + name + ', telephone: ' + phone);    
    });
} 
```

另外，我建议您使用以下`cache: false`设置，而不是使用一些数据时间来破坏缓存：

```
function getData() {
    $.ajax({
        url: 'data.xml',
        type: 'GET',
        cache: false,
        dataType: 'xml',
        success: parseXml
    });
} 
```

# laravel - Laravel 4 Input::all() 将请求路径附加到输入数组？

> ID：14921781
> 
> 赞同：1
> 
> 时间：2013-02-17T13:52:07.663
> 
> 标签：laravel, laravel-4

在全新安装 L4 时：

**路由.php**

```
Route::post('/test', 'TestController@store'); 
```

**测试控制器.php**

```
class TestController extends Controller  {

        /**
         * Store a newly created resource in storage.
         *
         * @return Response
         */
        public function store()

        {

                print_r(Input::get());
                //
        }

} 
```

**冰壶网址**

```
curl --data "param1=value1&param2=value2" http://example.com/test 
```

**输出**：

```
Array
(
    [param1] => value1
    [param2] => value2
    [/test] => 
) 
```

请求 URI 在这里做什么？

PS：使用 Nginx / Php-fpm 堆栈应该很重要。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-18T09:29:24.133

原来是我使用的 ngixn clean URL 片段。将其更改为：

```
 if (!-d $request_filename)
    {
        rewrite ^/(.*)$ /index.php?/$1 last;
    } 
```

到：

```
 try_files $uri $uri/ /index.php?$args; 
```

不过在上次更新之前它工作正常。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:04:20.270

问题出在代码的其他地方，而不是 Laravel 4。

我刚刚使用 Laravel 4 的最新 beta 版本运行了以下测试：

```
Route::post('/test', function()
{
    print_r($_POST);
    print_r(Input::get());
}); 
```

**看法：**

```
<h1>Test</h1>
<form method="post" action="">
    <input type="hidden" name="test1" id="test1" value="testfield1" />
    <input type="hidden" name="test2" id="test2" value="testfield2" />
    <button type="submit">Submit</button>
</form> 
```

**结果：**

```
Array ( [test1] => testfield1 [test2] => testfield2 )
Array ( [test1] => testfield1 [test2] => testfield2 ) 
```

您是否在代码中的其他任何地方使用输入类，也许在之前的过滤器中？

在你的代码中尝试上面的代码测试——它会给你什么结果？

# android - 无法在我的应用上添加 admob 广告

> ID：14921784
> 
> 赞同：1
> 
> 时间：2013-02-17T13:52:26.883
> 
> 标签：android, admob

我正在尝试在我的应用程序上添加 admob 广告（这是第一次）我的应用程序到目前为止运行良好，直到我添加广告现在它崩溃并且无法打开。我做了以下更改，之后应用程序崩溃了。

在主要课程中：

```
AdView adView;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    adView = (AdView)findViewById(R.id.ad);
             adView.loadAd(new AdRequest()); 
```

在清单中：

```
 <uses-permission android:name="android.permission.INTERNET"/>
       <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
        <meta-data android:value="true" android:name="ADMOB_ALLOW_LOCATION_FOR_ADS" />

 <activity android:name="com.google.ads.AdActivity"
          android:configChanges="keyboard|keyboardHidden|orientation|screenLayout|uiMode|screenSize|smallestScreenSize" /> 
```

在 xml 中：

```
 <com.google.ads.AdView

     xmlns:ads="http://schemas.android.com/apk/lib/com.google.ads"

    android:id="@+id/ad"
   android:layout_width="fill_parent"
       android:layout_height="wrap_content"

     ads:adUnitId="a15120ccc0ed0ee"
     ads:adSize="SMART_BANNER"
   android:layout_alignParentBottom="true"
   ads:loadAdOnCreate="true"
 /> 
```

我的应用程序在我安装并尝试在我的设备上打开后立即崩溃。我通过进入 prop-> 外部 jars 添加了 admob sdk，现在 jar 显示在 admob 的引用库 sdk 版本中是 6.3.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:40:03.410

解决了..

我直接从硬盘位置取出了外部jar文件。

然后我尝试将它移动到 libs 文件夹中，然后在程序中添加 adsdk 的外部 jar。

现在它工作正常并且没有发生崩溃。

# java - Wicket 是适合单页应用程序的 Web java 框架吗？

> ID：14921785
> 
> 赞同：3
> 
> 时间：2013-02-17T13:52:42.093
> 
> 标签：java, scala, web-applications, wicket, single-page-application

还是这种应用程序（SPA）有最佳选择（框架）？

我对仅使用 Scala 或 Java 框架进行后端开发感兴趣。

对我来说选择后端 Web 框架的主要要点是：

*   良好的文档、资源和许多示例
*   成熟度和社区的广泛采用，并具有相当多的实际用例。
*   一个简单而简短的学习曲线。
*   一个简单而广泛的架构，可以轻松使用或添加身份验证、授权和其他 Web 应用程序中常见的功能。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T19:33:51.060

是的，你可以用 Wicket 构建一个 SPA，它的组件架构实际上使它非常简单。

基本上，通常应用程序中的页面是什么，您变成一个面板，并使用 Ajax 制作单页面切换面板，而不是在页面之间导航。您可以为页面的多个部分使用多个面板等。所有这些对于框架来说都是非常简单和自然的。自 5.x 以来添加的事件架构使得使用跨部门通信变得更加简单。

但是，您失去的一件事是页面的书签功能。

由于它是单个页面，浏览器地址栏中的 URL 永远不会改变，如果用户创建书签，它将始终点击初始页面，而不是创建书签时显示的页面。

客户端（基于javascript）框架（如GWT）通常通过使用动态锚（URL中#之后的字符串）来编码当前状态，以便应用程序可以在需要时重建它，但作为服务器-中心框架，Wicket 做不到（至少，没有太多自定义代码）。可能的，可行的，但需要一些思考和工作。

很多时候，这不是必需的功能（甚至可能是不受欢迎的行为）。如果是这样的话，Wicket 真的可以帮助你。

关于使用基于动作的框架（Struts、Spring MVC、Play 等），如果您想要一个重客户端的架构，它们更合适。但是您将不可避免地使用 Javascript 编写大部分应用程序，或者使用一些 Java-to-javascript-compiler (GWT)，并使用该框架来进行查询，我的意思是，实现服务（XML、JSON 或一些变体）。

# xcode - 如何将表格视图控制器单元格链接到另一个视图？

> ID：14921787
> 
> 赞同：1
> 
> 时间：2013-02-17T13:53:06.763
> 
> 标签：xcode

我想要的是当您单击表格中的任何单元格时，您会转到一个视图。我还需要为您单击的每个不同的单元格提供不同的字符串。然而我不知道

1.  按下时如何将表格单元格链接到另一个视图
2.  您如何更改您单击的每个不同单元格的详细视图控制器。

谢谢你试图帮助我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T16:38:37.127

您需要更好地了解如何使用故事板，然后如何根据`UItableView`需要自定义单元格。

[您可以在此链接](http://www.raywenderlich.com/5138/beginning-storyboards-in-ios-5-part-1)中了解有关使用情节提要的更多信息

而在熟悉了storyboards之后，你应该考虑自定义`UItableView`单元格，你可以根据自己的需要进行自定义。

看到[这个链接](http://www.cocoawithlove.com/2009/04/easy-custom-uitableview-drawing.html)，一定会对你有所帮助。

在复制粘贴任何代码之前，请仔细阅读这些内容。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-17T14:04:46.040

1.  创建从 tableview 到详细视图控制器的 segue

2.  使用`prepareForSegue:sender:`和类似的东西

`[segue.destinationViewController setDetail:[self detailForIndexPath:[self.tableView indexPathForSelectedRow]]];`在那个方法里面

* * *

只是谷歌 segue UITableView 或类似的一些例子/分步教程/..

* * *

*（还有其他选项，比如使用 UITableView 委托方法`tableView: tableViewdidSelectRowAtIndexPath:`，但我认为 segueing 最容易理解）*

# android - Android Wi-Fi Direct 读取 rssi 信号强度

> ID：14921796
> 
> 赞同：13
> 
> 时间：2013-02-17T13:54:04.520
> 
> 标签：android, android-wifi, wifimanager, wifi-direct

我需要测量两部 Android 手机之间的 Wi-Fi Direct 信号（RSSI 信号）。我怎么能这样做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T17:03:20.403

在当前版本的 Android (v4.2.2 r1) 之前，WiFi Direct 的 RSSI 是硬编码的。

[关联](https://stackoverflow.com/questions/10603309/signal-strength-in-p2p-connection-with-wifi-direct?rq=1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-22T08:16:54.770

在您的活动类中创建一个广播接收器类，该类在 RSSI 的强度发生变化时执行一些操作（在变量中显示一些消息/存储）。这可以按如下方式完成：

```
public class myReceiver extends BroadcastReceiver
{
    @Override
    public void onReceive(Context context, Intent intent)
    {
        String myAction = intent.getAction();
        if (myAction.equals(WifiManager.RSSI_CHANGED_ACTION))
        {
            manageNewRssi(intent.getIntExtra(WifiManager.EXTRA_NEW_RSSI,0));
        }
    }
} 
```

manageNewRssi 是一种方法，您必须定义执行所需任务的方法。

# c# - MediaElement 和 BackgroundAudioPlayer 之间的更改

> ID：14921800
> 
> 赞同：1
> 
> 时间：2013-02-17T13:54:33.497
> 
> 标签：c#, windows-phone-7, background-audio

现在我正在使用`MediaElement`以下代码在我的应用程序中播放视频：

```
mediaElement1.Source = new Uri(fileurl);
mediaElement1.Play(); 
```

我想添加当用户转到后台并继续播放音频（不需要视频）时的可能性，所以我想用`BackgroundAudioPlayer`这个。而且我想知道是否可以使用它们中的两个或者如何在它们之间混合。

# android - sqlite数据库中没有创建列？

> ID：14921801
> 
> 赞同：2
> 
> 时间：2013-02-17T13:54:35.237
> 
> 标签：android, android-sqlite

```
public static final String Database_Name="content.db";
public static final int Database_Version=1;
public static final String Table_Name="images";
public static final String Column1="contentid";
public static final String Column2="content_type";
public static final String Column3="content";
public static final String Column4="has_update";
public static final String Column5="server";
public static final String Column6="_id";
public static final String Create_Database="CREATE TABLE" + Table_Name +
        "(" + Column6 + "INTEGER PRIMARY KEY AUTOINCREMENT,"+ Column1 + "LONG," + Column2 + "TEXT," 
+ Column3 + "TEXT," + Column4 + "INTEGER," + Column5 + "INTEGER" + ");"; 
```

我正在使用上面的声明和执行代码在 android 中创建一个 sqlite 表，代码执行成功，但在 logcat 中给出了一个异常，说列内容尚未创建，是什么导致我无法理解的问题。请帮助...... …………

这是 logcat 语句

```
02-17 19:36:15.658: E/SQLiteLog(31602): (1) table images has no column named content 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T13:57:25.370

你能复制/粘贴错误信息吗？

我认为你的创建查询中的一个问题是你不会在列名和类型之间有空格。不知道这是否是实际问题，但对我来说听起来足够有问题。

编辑：我的意思是你创建的查询应该看起来像

```
public static final String Create_Database = 
"CREATE TABLE " + Table_Name +
        " (" + Column6 + " INTEGER PRIMARY KEY AUTOINCREMENT, " +
        Column1 + " LONG, " + 
        Column2 + " TEXT, " + 
        Column3 + " TEXT, " + 
        Column4 + " INTEGER, " + 
        Column5 + " INTEGER);"; 
```

# r - 将因子转换为指标变量？

> ID：14921805
> 
> 赞同：3
> 
> 时间：2013-02-17T13:55:34.370
> 
> 标签：r

如何将 R 中的一个因子转换为多个指标变量，每个级别一个？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-17T14:10:36.100

一种方法是使用`model.matrix()`：

```
model.matrix(~Species, iris)

    (Intercept) Speciesversicolor Speciesvirginica
1             1                 0                0
2             1                 0                0
3             1                 0                0 
```

……

```
148           1                 0                1
149           1                 0                1
150           1                 0                1
attr(,"assign")
[1] 0 1 1
attr(,"contrasts")
attr(,"contrasts")$Species
[1] "contr.treatment" 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-17T14:11:15.240

有几种方法可以做到这一点，但您可以使用`model.matrix`：

```
color <- factor(c("red","green","red","blue"))
data.frame(model.matrix(~color-1))
#   colorblue colorgreen colorred
# 1         0          0        1
# 2         0          1        0
# 3         0          0        1
# 4         1          0        0 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-17T14:15:19.113

如果我正确理解了您的问题，请使用`model.matrix`命令，如下所示。

```
dd <- data.frame(a = gl(3,4), b = gl(4,1,12))
model.matrix(~ a + b, dd)
   (Intercept) a2 a3 b2 b3 b4
1            1  0  0  0  0  0
2            1  0  0  1  0  0
3            1  0  0  0  1  0
4            1  0  0  0  0  1
5            1  1  0  0  0  0
6            1  1  0  1  0  0
7            1  1  0  0  1  0
8            1  1  0  0  0  1
9            1  0  1  0  0  0
10           1  0  1  1  0  0
11           1  0  1  0  1  0
12           1  0  1  0  0  1
attr(,"assign")
[1] 0 1 1 2 2 2
attr(,"contrasts")
attr(,"contrasts")$a
[1] "contr.treatment"

attr(,"contrasts")$b
[1] "contr.treatment" 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-17T14:11:03.577

尝试这个：

```
myfactors<-factor(sample(c("f1","f2","f3"),10,replace=T));
myIndicators<-diag(nlevels(myfactors))[myfactors,]; 
```

# android - 从 android 中的肥皂响应中获取值，

> ID：14921806
> 
> 赞同：0
> 
> 时间：2013-02-17T13:55:36.927
> 
> 标签：android

我正在使用下面的代码从响应中获取值，但是我在主线程异常上收到以下错误网络，但是我确定 url、命名空间、方法和肥皂操作是正确的，因为它们在浏览器中工作，我在解析 SoapObject 和 soaSerializationEnvelope 时也遇到错误，我该如何解决这个问题，或者我是否可以有一个简单的例子来解析一个肥皂请求并获得一个非常好的项目的价值

公共无效测试（）{

textView = (TextView) findViewById(R.id.textView1);

```
 SoapObject reSoapObject = new SoapObject(NAMESPACE, METHOD_NAME);

    SoapSerializationEnvelope soaSerializationEnvelope = new SoapSerializationEnvelope(
            SoapEnvelope.VER11);

    soaSerializationEnvelope.setOutputSoapObject(reSoapObject);
    HttpTransportSE httpTransportSE = new HttpTransportSE(URL);

    String ip = null;

    try {
        httpTransportSE.call(SOAP_ACTION, soaSerializationEnvelope);
        SoapObject soapObjectResultRoot = (SoapObject) soaSerializationEnvelope.bodyIn;

        Log.e(">>>>>>>>>>>>>>>>>>", "Root elemtn body: "
                + soapObjectResultRoot.toString());

        SoapObject soapObjectGetProperty = (SoapObject) soapObjectResultRoot.getProperty("return");
        ip = soapObjectGetProperty.getProperty("return").toString();

    } catch (IOException e) {
        e.printStackTrace();
    } catch (XmlPullParserException e) {
        e.printStackTrace();
    }

    textView.setText(" \nIP --> " + ip);

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:01:40.553

再次仔细阅读异常名称并尝试理解它的含义：

```
Network on main thread exception 
```

这意味着您正在执行网络操作，就像任何其他 IO 操作一样，在主线程（阅读：UI 线程）上等待硬件响应需要几毫秒的时间来处理。

所以这意味着你阻塞了 UI 线程，让你的应用程序滞后并运行缓慢，没有人想要这样。

只需使用几种不同的线程方法之一。最常见的是[AsyncTask](http://developer.android.com/reference/android/os/AsyncTask.html)，但如果您想进一步探索，您可以研究用于较低级别交互的线程、用于活动生命周期的加载器（通过一些不错的自动数据处理触摸进行管理）或用于更高级别多线程控制的执行器。

# javascript - 如何转到一个页面，单击一个按钮，然后获取它的 DOM

> ID：14921808
> 
> 赞同：1
> 
> 时间：2013-02-17T13:55:56.160
> 
> 标签：javascript, jquery, dom, google-chrome-extension, xmlhttprequest

我正在用 javascript/jquery 编写一个脚本，一旦执行必须转到一个子页面，单击一个按钮，然后获取该结果页面的 DOM。之后我可以做一些操作并获取一些需要的数据。

经过一番挖掘，我写了这个脚本：

```
var pageDOM = null;
var xhr = new XMLHttpRequest();
xhr.overrideMimeType('text/xml');
xhr.open('GET', '/newsfeed-simulator', true);
xhr.onreadystatechange = function() {
  if (xhr.readyState == 4)  { 
      pageDOM = xhr.responseXML;
      pageDOM.getElementById("simulate-button").click();
  }
};
xhr.send(null); 
```

使用此脚本，我可以访问所需的子页面，但 xhr.responseXML 始终返回 null。我用谷歌搜索并添加了`xhr.overrideMimeType('text/xml');`，但它仍然不起作用。奇怪的是`xhr.responseText;`效果很好。

不知道出了什么问题，这应该是一个简单的任务？有关如何解决此问题的任何想法/意见/建议？

最好的，

PS：这是这里的第一篇文章，所以嗨：D

**EDIT1** newsfeed-simulator 基本上是一个带有我需要单击的按钮的页面。单击后，页面会加载元素，然后我可以使用这些元素获取一些数据。

**EDIT2**经过几个小时的谷歌搜索，我想出了这个

```
var xhr = new XMLHttpRequest();
xhr.open('GET', '/newsfeed-simulator', true);
xhr.responseType = 'document';
xhr.onload = function(e) {
  if (this.status == 200) {
    console.log(xhr.response)
    xhr.response.getElementById("simulate-button").click();
    console.log(xhr.response.body)
  }
};

xhr.send(); 
```

使用 XMLHttpRequest2 我现在可以轻松地获取源（作为文档而不是文本）并且不会得到空值。问题是（正如 charlietfl 所暗示的）`xhr.response.getElementById("simulate-button").click();`工作不正常。IE 我在没有点击按钮的情况下得到了 DOM 的主体。任何想法如何模拟鼠标点击，因为我的方式不起作用？

# jquery - jQuery：每个元素的 append()

> ID：14921812
> 
> 赞同：2
> 
> 时间：2013-02-17T13:57:00.127
> 
> 标签：jquery

我有一张桌子和一张清单：

```
<table>
  <tr>
       <td>Jack</td>
       <td class="date"></td>
  </tr>

  <tr>
       <td>David</td>
       <td class="date"></td>
  </tr>

  ...
</table>

<hr />

<span class="inline-date">2012</span>
<span class="inline-date">2013</span> 
```

我想像这样将每个附加`span.inline-date`到每个`td.date`：

```
<table>
  <tr>
       <td>Jack</td>
       <td class="date"><span class="inline-date">2012</span></td>
  </tr>

  <tr>
       <td>David</td>
       <td class="date"><span class="inline-date">2013</span></td>
  </tr>

  ...
</table> 
```

我累了：

```
  $("span.inline-date").appendTo('table td.date'); 

```

但我`span`在每个`td`.

我想念什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T14:00:10.627

你可以[`each()`](http://api.jquery.com/each)这样使用；

```
var cells = $('table td.date');

$('span.inline-date').each(function (i) {
    cells.eq(i).append($(this));
}); 
```

# sql-server - 将 csv 文件导入 sql-我的 txt 在每个字段之间有 ' ' 和 ,

> ID：14921814
> 
> 赞同：1
> 
> 时间：2013-02-17T13:57:08.347
> 
> 标签：sql-server, import, export-to-csv

我需要将 2 个`.txt`文件导入到我的 SQL Server 表中。下面是我的代码的两部分 - 首先是创建表，第二部分是用第一个文件填充它。

第一部分很好，但第二部分给了我一个错误-

> *消息 4864，级别 16，状态 1，第 1
> 行第 1 行第 1 列 (TestAcctID) 的批量加载数据转换错误（指定代码页的类型不匹配或无效字符）。
> 消息 4864，级别 16，状态 1，第 1
> 行第 2 行第 1 列 (TestAcctID) 的批量加载数据转换错误（指定代码页的类型不匹配或无效字符）。*

```
Create Table TestAcct(TestAcctID int identity(1,1),
                 LastName varchar(30), 
                 FirstName varchar(30), 
                 PhoneNumber varchar(10),
                 AccountType varchar(5),
                 AccountNumber varchar(30),
    constraint PKTestAcct Primary Key(TestAcctID))

/*Insert info from .txt file*/

BULK INSERT TestAcct
FROM 'c:\Users\lraffi\desktop\File1.txt'
WITH
(
FIELDTERMINATOR = ',',
ROWTERMINATOR = '\n'
)
GO 
```

我认为我的问题是我的 CSV 文件中的文本`''`围绕每个单词 - 我已经为`FIELD TERMINATOR= ','`and写过`ROW TERMINATOR= '\n'`- 但是我如何写还有`' '`呢？有没有人认为这是问题所在？

这是我的 .txt 文件的内容：

File1.txt：'FirstName'，'LastName'，'AccountNumber'，'PhoneNumber'，'AccountType''Bob'，'Jones'，'123456789'，'8451111111'，'RES''Jane'，'DOE'， '987654321'、'8452222222'、'COM'、'Mike'、'Smith'、'123459876'、'8453333333'、'RES'

File2.txt：'RecordCount=3''AccountNumber'，'PhoneNumber'，'AccountType'，'FirstName'，'LastName'，'222222222'，'8454444444'，'RES'，'Bill'，'James''333333333' ,'8455555555', 'COM','John','Barton' '444444444','8456666666','RES','William', 'Stark' 'End'

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T03:40:28.490

我相信您将需要一个格式文件。这里有几个示例可以帮助您入门

*   [使用格式文件批量导入数据 (SQL Server)](http://msdn.microsoft.com/en-us/library/ms178129.aspx)

*   [使用文本限定符“批量插入”的帮助](http://social.msdn.microsoft.com/Forums/en-US/transactsql/thread/c484899e-6d77-4441-9737-696d6299bb85)

*   [示例 XML 格式文件](http://msdn.microsoft.com/en-us/library/ms191234%28v=sql.105%29.aspx)

然后，您需要考虑格式文件中的文本限定符 (')。

```
<?xml version="1.0"?>
<BCPFORMAT xmlns="http://schemas.microsoft.com/sqlserver/2004/bulkload/format" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
 <RECORD>
  <FIELD ID="1" xsi:type="CharTerm" TERMINATOR="'," MAX_LENGTH="30"/>
  <FIELD ID="2" xsi:type="CharTerm" TERMINATOR="','" MAX_LENGTH="30"/>
  <FIELD ID="3" xsi:type="CharTerm" TERMINATOR="'\r\n" MAX_LENGTH="30"/>
 </RECORD>
 <ROW>
  <COLUMN SOURCE="1" NAME="FirstName" xsi:type="SQLNVARCHAR"/>
  <COLUMN SOURCE="2" NAME="LastName" xsi:type="SQLNVARCHAR"/>
  <COLUMN SOURCE="3" NAME="AccountNumber" xsi:type="SQLNVARCHAR"/>
 </ROW>
</BCPFORMAT> 
```

# oracle - Oracle：缺少右括号

> ID：14921816
> 
> 赞同：2
> 
> 时间：2013-02-17T13:57:33.117
> 
> 标签：oracle, sql-like

我有一个查询：

```
SELECT (column LIKE '%string%') AS bool FROM table 
```

它返回：

> “缺少右括号”

为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T14:02:33.150

由于`LIKE`操作符的原因，我们无法使用该`DECODE`功能。我猜以下内容虽然丑陋，但与您正在寻找的内容相匹配：

```
SELECT
    login,
    CASE 
        WHEN login LIKE 'admin' THEN 1
        ELSE 0
    END
FROM users; 
```

或者，使用类似布尔值：

```
SELECT
    login,
    CASE 
        WHEN login LIKE 'admin' THEN 'TRUE'
        ELSE 'FALSE'
    END
FROM users; 
```

如果您正在使用`LIKE`运算符，您希望`%`在“admin”字符串中使用一些通配符，否则一个简单的相等就足够了。

[小提琴](http://sqlfiddle.com/#!4/86034/7)

[文档](http://www.techonthenet.com/oracle/functions/case.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:21:41.783

你应该使用：

```
SELECT DECODE(login,'admin','TRUE','FALSE') as bool FROM users; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T15:17:59.740

官方在 SQL 中没有布尔数据类型，在 Oracle 中也没有。

这样做的标准方法是使用 WHERE 子句：

```
select whatever 
from your_table
where column LIKE '%string%'; 
```

如果您真的想要一列，则需要将字符串探针与 DECODE() 或 CASE() 结合使用。像这样...

```
select decode(instr(column, 'string'), 0, 'FALSE', 'TRUE') as bool
from your_table 
```

... 或这个 ...

```
select case when column like '%string%' then 'TRUE' else 'FALSE' end as bool
from your_table 
```

...或其他一些排列。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T15:29:12.287

它返回 1 - 找到的字符串，否则返回 0：

```
SELECT LEAST(1,INSTR(login,'admin')) AS bool FROM users 
```

# jsf-2 - 如何创建一个健壮的模式以将动态和通用组件添加到 JSF 2

> ID：14921818
> 
> 赞同：0
> 
> 时间：2013-02-17T13:57:48.600
> 
> 标签：jsf-2

我有一个高度可参数化和动态的 web 应用程序。我将 JSF 2 与 Mojarra 2.1.19 和 Primefaces 3.5 一起使用。

组件是指高级组件：与 xhtml 文件关联的 backbean。xhtml 模板中支持的 bean 始终具有 EL 名称“comp”。

我实现的功能如下：

*   我有一个容器组件（一个选项卡、一个面板……），我希望能够在其中呈现任何组件。容器是通过用户操作和配置文件动态提供的，无法预测哪些组件将包含该容器以及有多少组件。
*   组件“A”可以在组件树中的任何位置刷新组件“B”，而无需硬耦合。组件“A”不知道组件“B”，组件“A”只知道它需要刷新组件“B”实现的功能。

使用组件模式，我可以使用组件树构建高级应用程序。我实际上使用 c:forEach 模式来动态添加组件：

```
<c:forEach items="#{comp.values}" var="value">
    <ui:include src="#{value.uri}">
        <ui:param name="comp" value="#{value}"/>
    </ui:include>
</c:forEach> 
```

我使用通用通道消息来链接组件。要刷新我使用绑定

我读过以下所有模式都可以创建不一致的状态并抛出令人恐惧的重复 Id 异常：

*   c:forEach
*   会话绑定
*   通过java添加组件

我总有一种走在雷区的感觉。现在我遇到了一个令人讨厌的重复 id 错误。

有没有办法创建一个健壮的模式来向 JSF 2 添加动态和通用组件？

感谢您的回答！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T11:41:03.437

确保您没有在整个视图范围内将物理上不同的组件绑定到同一个 bean 属性。该`binding`属性必须指向一个请求范围的属性，并且在视图范围内绝对不能在物理上不同的组件之间共享，即使它最多同时被一个组件使用。

仅当您将唯一组件绑定到会话范围的 bean 属性，但在同一会话的不同浏览器选项卡/窗口中多次打开同一视图时，“会话绑定”问题才适用。

# hadoop - pig 忽略 maxReducers 并改用 mapred.reduce.tasks

> ID：14921821
> 
> 赞同：2
> 
> 时间：2013-02-17T13:58:29.333
> 
> 标签：hadoop, apache-pig

我的猪脚本生成了大约 5 个 MR 作业。当它开始执行时，pig 会打印：

```
 BytesPerReducer=1000000000 maxReducers=999 
```

并继续用一个 reducer 创建一个 MR-job：

```
 Neither PARALLEL nor default parallelism is set for this job. Setting number of reducers to 1 
```

但是，对于从同一脚本生成的后续作业，它不会打印这一行，并且在其中一个中创建`mapred.reduce.tasks`减速器，在我的集群中是 4992。

这是一个已知的错误？或者我在这里错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-23T21:44:44.003

在你的猪脚本中使用它：

```
SET pig.exec.reducers.max 4000 
```

[阅读此内容以获取更多信息。](http://pig.apache.org/docs/r0.14.0/api/org/apache/pig/backend/hadoop/executionengine/mapReduceLayer/InputSizeReducerEstimator.html)

# loops - 在Arduino上运行程序时连续运行循环？

> ID：14921826
> 
> 赞同：2
> 
> 时间：2013-02-17T13:59:40.343
> 
> 标签：loops, arduino

我有一个关于在 Arduino 中运行循环的问题。我已经对 Arduino 进行了编程，使其慢慢淡入 LED，我想添加一个在程序运行时闪烁的 LED。我可以更改整个程序并让 LED 在所有行之间闪烁，但我想知道是否有一种方法可以单独完成？是否可以在*void setup()*下运行一个循环，或者运行一个循环，然后继续运行下一个循环，同时继续运行第一个循环？

闪烁的灯当然不是很重要，但我只是好奇它是否可以做到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:24:42.517

我建议为此目的使用 msTimer2 库。

[http://playground.arduino.cc/Main/MsTimer2](http://playground.arduino.cc/Main/MsTimer2)

在最近的德国 Arduino 论坛讨论中也可以找到一个使用示例：

[http://arduino.cc/forum/index.php?PHPSESSID=cf3a483ed1812def070ebeaae09691c3&topic=146086.msg1100336#msg1100336](http://arduino.cc/forum/index.php?PHPSESSID=cf3a483ed1812def070ebeaae09691c3&topic=146086.msg1100336#msg1100336)

你不需要懂德语。只需获取代码并尝试一下。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:07:00.157

确实。最优雅的解决方案是设置一个独立于主运行循环的计时器，并使用其中断处理程序向量来打开和关闭 LED。通过这种方式，您可以精确控制闪烁的频率，并且您不必担心主循环的快慢（如果随着时间的推移添加或删除计算量大的代码，这可能会发生很大变化）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-17T14:12:25.313

您不能同时运行两个或多个独立循环，但您可以通过以下方式实现相同的效果：

```
void do_stuff_0 ();
void do_stuff_1 ();

unsigned long last_millis_0 = 0;
unsigned long last_millis_1 = 0;

const unsigned long delay_0 = ...;
const unsigned long delay_1 = ...;

void loop ()
{
  now = millis();

  if ((now - last_millis_0) >= delay_0) {
    last_millis_0 = now;
    do_stuff_0 ();
  }
  if ((now - last_millis_1) >= delay_1) {
    last_millis_1 = now;
    do_stuff_1 ();
  }
  ...
} 
```

这只是为了说明，您很可能希望使用一个对其进行抽象的库，例如[metro](http://playground.arduino.cc/code/metro)。

# cocos2d-iphone - 触摸时向上移动精灵并将其设置为起始位置

> ID：14921832
> 
> 赞同：1
> 
> 时间：2013-02-17T14:00:36.827
> 
> 标签：cocos2d-iphone

我是 Cocos2D 的新手，遇到了一个问题。我也搜索了很多，但似乎没有找到我的问题的答案。情况是：

游戏开始时，主精灵应该继续下降（就像计划崩溃一样）。如果用户触摸屏幕上的任何位置，精灵应该向上移动到触摸点的 Y 坐标，当精灵到达该点时，它应该从该点再次开始下降。想象一架飞机坠毁（下降），当用户点击任何地方时，它会上升（起飞一点），然后又开始下降。我们只是不必让它坠毁在地上。

所以，我已经实现了下降部分。以及上涨的部分。**但问题是当精灵完成上升时，它并没有从那里开始下降，而是从上升的地方继续下降。**

请帮助我实现这个目标。

这是我在该`init()`方法中的代码：

```
 [plane runAction:[CCRepeatForever actionWithAction:[CCSequence actions:[CCMoveBy actionWithDuration:1 position:ccp(0,-20)],
                                                       nil]]]; 
```

在方法中上升的代码`touchesBegan`：

```
 [plane runAction:[CCMoveBy actionWithDuration:1 position:ccp(0,20)]]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:18:48.077

问题是你使用了一个可重复的动作，一旦你应用了“上移”动作，你就会有不一致的地方，因为这两个动作都在同一个对象上工作（我不记得前一个动作是否被取消，但这种方法不起作用）。

所以我会为`init()`：

```
.
.
[self startDownMovement];
.
. 
```

然后实现`startDownMovement()`为：

```
[plane runAction:[CCSequence actions:[CCMoveBy actionWithDuration:1 position:ccp(0,-plane.potision.y)],
                                     [CCCallBlock actionWithBlock:
                                     ^{
                                           // Do game over logic. (i.e. plain crashed)
                                      }],nil]]; 
```

对于`touchBegan()`：

```
 [plane stopAllActions];
 CGPoint location = [touch locationInView:touch.view];
 [plane runAction:[CCSequence actions:[CCMoveBy actionWithDuration:1 position:ccp(0,location.y)],
                                      [CCCallBlock actionWithBlock:
                                      ^{
                                           [self startDownMovement];
                                      }],nil]]; 
```

我在这里所做的是开始向下移动（我假设 y=0 是崩溃点）所以我移动精灵减去它的 y 位置。

如果用户触摸屏幕，平面 y 位置将移动到触摸点，之后再次调用向下移动（因为我使用 CCSequence 向下移动只会在向上移动完成后才会发生）

# android - 调用 MediaRecorder 的 start() 方法时抛出 IllegalStateException - Android

> ID：14921833
> 
> 赞同：0
> 
> 时间：2013-02-17T14:00:38.723
> 
> 标签：android, exception, illegalstateexception, android-mediarecorder

我知道这个问题已经问了好几次了。但是我仍然找不到原因；他们都没有帮助解决这个问题。

我正在尝试使用 android MediaRecorder 录制音频剪辑并想要播放它。但是我在下面的代码行中得到了 IllegalStateException 。

```
recorder.start(); 
```

这是我的代码：

```
private void startRecording() {
    try {

        mFileName = Environment.getExternalStorageDirectory()
                .getAbsolutePath();
        mFileName += "/audio_recording.3gp";

        recorder = new MediaRecorder();

        recorder.setAudioSource(MediaRecorder.AudioSource.MIC);
        recorder.setOutputFormat(MediaRecorder.OutputFormat.THREE_GPP);
        recorder.setAudioEncoder(MediaRecorder.AudioEncoder.AMR_NB);
        // recorder.setOutputFile(fos.getFD()); 
        recorder.setOutputFile(mFileName);
        try {
            recorder.prepare();
            recorder.start();
        } catch (IllegalStateException e) {
            System.out.println("Error in preparing recorder!!! IllegelStateException");
        }catch (IOException e) {
            System.out.println("Error in preparing recorder!!!");
        }

    } catch (IOException e) {
        System.out.println("IOException caught during recording!!! IO Exception");
        e.printStackTrace();
    }

} 
```

错误日志：

```
02-17 19:09:40.086: E/AndroidRuntime(25620): FATAL EXCEPTION: main
02-17 19:09:40.086: E/AndroidRuntime(25620): java.lang.IllegalStateException: Could not execute method of the activity
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.view.View$1.onClick(View.java:3103)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.view.View.performClick(View.java:3574)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.view.View$PerformClick.run(View.java:14293)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.os.Handler.handleCallback(Handler.java:605)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.os.Handler.dispatchMessage(Handler.java:92)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.os.Looper.loop(Looper.java:137)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.app.ActivityThread.main(ActivityThread.java:4448)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at java.lang.reflect.Method.invokeNative(Native Method)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at java.lang.reflect.Method.invoke(Method.java:511)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:823)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:590)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at dalvik.system.NativeStart.main(Native Method)
02-17 19:09:40.086: E/AndroidRuntime(25620): Caused by: java.lang.reflect.InvocationTargetException
02-17 19:09:40.086: E/AndroidRuntime(25620):    at java.lang.reflect.Method.invokeNative(Native Method)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at java.lang.reflect.Method.invoke(Method.java:511)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.view.View$1.onClick(View.java:3098)
02-17 19:09:40.086: E/AndroidRuntime(25620):    ... 11 more
02-17 19:09:40.086: E/AndroidRuntime(25620): Caused by: java.lang.RuntimeException: start failed.
02-17 19:09:40.086: E/AndroidRuntime(25620):    at android.media.MediaRecorder.start(Native Method)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at com.example.audiorecordtest.MainActivity.startRecording(MainActivity.java:146)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at com.example.audiorecordtest.MainActivity.onRecord(MainActivity.java:94)
02-17 19:09:40.086: E/AndroidRuntime(25620):    at com.example.audiorecordtest.MainActivity.onSayButtonClick(MainActivity.java:66)
02-17 19:09:40.086: E/AndroidRuntime(25620):    ... 14 more 
```

我也声明了所需的权限。

```
<uses-permission android:name="android.permission.RECORD_AUDIO" />
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 
```

我该如何解决这个问题？

# c# - 如何在richTextBox上制作字符串的特定部分Bold？

> ID：14921835
> 
> 赞同：0
> 
> 时间：2013-02-17T14:00:53.607
> 
> 标签：c#, .net, richtextbox

我有一个基于 Form 和 2 richTextBoxes 的聊天应用程序！

`richTextBox1`用于显示所有对话
`richTextBox_TextToSend`用于输入要发送的消息

当用户输入消息并按下回车按钮时，输入的文本将出现在richTextBox1

```
private void button1_Click(object sender, EventArgs e)
    {
        // insert message to database
        if(richTextBox_TextToSend.TextLength>0) {

        string txt = richTextBox_TextToSend.Text;

        // send the typed message
        sendMessage(from,to,task_id,txt);

        // show the typed text in the richTextBox1
        richTextBox1.Text += from+": "+richTextBox_TextToSend.Text+"\n";
        richTextBox_TextToSend.Clear();

        }
    } 
```

字符串类型的变量`from`保存发送消息的人的名称（使用应用程序的用户）

如何仅以粗体显示名称并以正常字体样式显示其他文本，因此在键入消息后，我看到

**Chakib Yousfi** : Hello....

而不是

Chakib Yousfi : Hello...

任何帮助将不胜感激。

![在此处输入图像描述](../Images/b7b4d360d6a9f73d0337ee0ccf150b26.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T15:15:56.440

使用此代码：

```
private void button1_Click(object sender, EventArgs e)
{
    // insert message to database
    if(richTextBox_TextToSend.TextLength>0) {

    string txt = richTextBox_TextToSend.Text;
    int start = richTextBox1.TextLength;
    string newMessage = from + ": " + richTextBox_TextToSend.Text + Environment.NewLine;

    // send the typed message
    sendMessage(from,to,task_id,txt);

    // show the typed text in the richTextBox1
    richTextBox1.AppendText(newMessage);
    richTextBox_TextToSend.Clear();

    richTextBox1.Select(start, from.Length);
    richTextBox1.SelectionFont = New Font(richTextBox1.Font, FontStyle.Bold);

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:18:35.553

首先，您应该选择要加粗的文本：

```
richTextBox1.SelectionStart = 0;
richTextBox1.SelectionLength = 13; 
```

然后您可以定义所选文本的样式：

```
richTextBox1.SelectionFont = new Font(richTextBox1.Font, FontStyle.Bold); 
```

# php - PHP Mail 函数向 Gmail 发送两次相同的邮件

> ID：14921838
> 
> 赞同：1
> 
> 时间：2013-02-17T14:01:19.187
> 
> 标签：php, email, gmail

我有一个有点烦人的问题：我的 gmail 帐户收到了 php 邮件功能发送的两次邮件。当我使用不同的电子邮件时，邮件只会收到一次（hotmail，自己的域）。我想问题出在我的标头代码中。

```
$headers = 'MIME-Version: 1.0' . "\r\n";
$headers .= 'Content-type: text/html; charset=iso-8859-1' . "\r\n";
$headers .= 'From: '.$naammail.' <'.$afzender.'>' . "\r\n"; 
```

`$naammail`是发件人的名称，`$afzender`是发件人的电子邮件。

邮件功能：`mail($email,$onderwerp,$bericht,$headers);`

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-08-18T21:37:58.300

在我的情况下，我只需将**空白**传递给第一个参数，因为我已经在**$headers**参数中拥有电子邮件地址 TO 字段。

```
mail( "", $subject, $message, $headers); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-16T00:26:15.997

```
mail($email, $subject, $message, $headers); 
```

确保你使用正确。电子邮件应该只发送到存储在 $email 中的电子邮件地址。使用上面的代码并为变量使用正确的名称。它有助于轻松区分问题（如果有）。

# jquery - jQuery - 根据下拉选择显示元素集合的数量

> ID：14921839
> 
> 赞同：0
> 
> 时间：2013-02-17T14:01:22.073
> 
> 标签：jquery

我需要能够根据下拉列表中的用户选择显示多个段落。

这些段落是这样的：

```
<p id="addActor1">
<p id="addActor2">
... etc 
```

这是我**尝试过**的 jQuery ，但不起作用（因为它显示了所有段落）：

```
$('#ddlSelectNumActorsToAdd').change(function () {
    var num = $(this).val();

    for (var i = 1; i < num; i++) {
        $.each($('#addActors p'), function (i, value) {
            $(this).fadeIn(200);
        });
    }
}); 
```

我*知道*上面是错误的，我只是不确定如何正确地实现 $.each() 函数来做我需要做的事情......

[这是一个 jsFiddle](http://jsfiddle.net/eventide/quyRW/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:06:03.090

您可以使用`:lt`选择器，并将其缩短为：

```
$('#ddlSelectNumActorsToAdd').change(function () {
    $('#addActors p').hide().filter(':lt(' + $(this).val() + ')').fadeIn(200);
}); 
```

在这里，我们隐藏了所有的`p`' 开始，然后只选择那些位置是`:lt`选定值 ( `$(this).val()`) 的，然后`fadeIn`'ing 他们。

您现在可以在这里看到它；[http://jsfiddle.net/quyRW/3/](http://jsfiddle.net/quyRW/3/)

或者，您可以使用`slice()`，这可能会在微观上更快；

```
$('#ddlSelectNumActorsToAdd').change(function () {
    $('#addActors p').hide().slice(0, $(this).val()).fadeIn(200);
}); 
```

[http://jsfiddle.net/quyRW/8/](http://jsfiddle.net/quyRW/8/)

* * *

另请注意，在大多数情况下，您不需要使用`each()`; jQuery 将对每个匹配的元素执行操作。例如，代替；

```
$('#addActors p').each(function () {
    $(this).hide();
}); 
```

......你可以拥有;

```
$('#addActors p').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:05:34.570

```
$('#addActors p').each(function () {
    $(this).hide();
});

$('#ddlSelectNumActorsToAdd').change(function () {
    var num = $(this).val();
    $('#addActors p').each(function (i, actor) {
        $(this).hide();
        if (i < num) {
            $(actor).fadeIn(200);
        }
    });
}); 
```

[http://jsfiddle.net/quyRW/5/](http://jsfiddle.net/quyRW/5/)

# http - 考虑到以下可能性，最有效的 ETag 生成是什么？

> ID：14921842
> 
> 赞同：5
> 
> 时间：2013-02-17T14:01:26.343
> 
> 标签：http, caching, http-headers, go

我最近在 Go 中一直在玩缓存 http 响应，我试图找出最有效的方法来生成正确的 ETag。

现在我有以下可用数据：

1.  当我渲染模板时要渲染的模板的名称。
2.  传递到模板或响应的动态数据以用于 json 响应。
3.  整个响应体。
4.  身体的长度。
5.  我可能会丢失的东西？

经过一番思考，我得出的结论是，如果我将模板的名称和正在生成的动态数据结合起来，理论上这应该以最少的开销创建一个合法的唯一 ETag，但我不知道如果这样做会有多糟糕我开始想要返回 30kb 的 html 值的数据库结果。

我正在使用 Go 的 stdlib 中的 crc32 例程从我传递给它的数据中生成 ETag。

有没有更好的方法来生成 ETag，甚至缓存动态数据？我不能只监视文件的最后修改时间，因为数据可以在不更改文件的情况下更改。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:10:07.567

通常，您希望使用计算成本低的东西作为 ETag。这样做的原因是，如果客户端发送条件请求（例如通过`If-None-Match`HTTP 请求标头），您可以决定是否适合发送`304 Not Modified`响应，而无需对页面进行所有处理。

例如，如果您有某种页面内容的修订标识符，那么这可能是一个很好的 ETag。

如果您需要完成所有必要的工作来渲染页面以生成 ETag，那么您也可以只使用渲染页面内容的哈希值，或者根本不使用 ETag。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T19:00:50.300

如果您正在寻找一种有效的[ETag](http://en.wikipedia.org/wiki/HTTP_ETag "ETag 上的维基百科条目")机制并且不需要加密强的东西，我建议您使用 CRC-32。为了帮助防止冲突，您可以结合模板名称、数据长度和 crc 等一些内容：

```
func etag(name string, data []byte) string {
    crc := crc32.ChecksumIEEE(data)
    return fmt.Sprintf(`W/"%s-%d-%08X"`, name, len(data), crc)
} 
```

[这](http://play.golang.org/p/PyPMccIjYs "使用 crc 演示 etag 的游乐场链接")将产生一个像`W/"tpl-17-3074C885"`.

# string - 如何使用变量中的值拆分字符串？（批）

> ID：14921843
> 
> 赞同：1
> 
> 时间：2013-02-17T14:01:30.650
> 
> 标签：string, batch-file

我有一个变量充当要打印的行，但我需要通过它们在行中的位置来编辑该行中的单个字符。但是我每次都需要使用变量来指定位置，并且 CMD 以错误的方式解释我的变量。

```
 @echo off
    set fv=0
    set fh=1
    set /a fh1=%fh%+1
    set linev=line%fv%

    set line%fv%=%linev:~0,%fh%%%NEWCHARACTER%%linev:~%fh1%% 
```

对不起，我的代码很乱，但我希望它被理解。我希望 CMD 将代码解释为：
%fv% %fh% %newcharacter% %fh1% 然后将两个字符串操作符转换为子字符串。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T17:39:58.423

我不确定我是否理解脚本示例最后一行中的评估顺序，即使您的口头解释也是如此。但是，我想我至少可以通过简单的示例向您展示如何实现您想要的，并且您将弄清楚如何在您的情况下应用该技术。

基本上，您需要在这里使用两种扩展：立即（或`%`扩展）和延迟。

批处理文件中存在适当的延迟扩展，必须首先启用（通常使用 command `SETLOCAL EnableDelayedExpansion`），然后使用`!`而不是`%`用于变量评估。考虑以下示例：

```
SET ind=1
SET line%ind%=ABC
SETLOCAL EnableDelayedExpansion
ECHO !line%ind%!
ENDLOCAL 
```

在上面的示例中，创建了两个变量，`ind`并且`line1`. 第二个名称部分是使用第一个变量构造的。当您将值*设置*为此类变量时，不需要延迟扩展，因为不需要评估名称，即赋值的左侧部分。但是当它确实需要评估时，您需要使用延迟扩展。`ECHO`上面脚本中的命令是这样工作的：

*   `%ind%`首先被评估；

*   作为`%ind%`评估的结果，命令变为`ECHO !line1!`;

*   由于延迟扩展刚刚启用，`!`现在具有特殊含义，即（延迟）变量评估，因此`!line1!`评估为`ABC`;

*   `ECHO`打印`ABC`。

虽然这种延迟扩展通常是首选，但在上面的示例中，您也可以使用`CALL`-expansion 实现相同的效果。这是使用`CALL`-expansion 重写的相同示例脚本：

```
SET ind=1
SET line%ind%=ABC
CALL ECHO %%line%ind%%% 
```

基本上，`%`一路都有扩展，但不同的部分在不同的时间进行评估。以下是第二个示例的延迟评估的工作原理：

*   第一个`%%`变成`%`;

*   `%ind%`被评估为`1`;

*   剩下的`%%`变成`%`;

*   CALL 现在接收要执行的命令：`ECHO %line1%`;

*   `%line1%`评估为`ABC`;

*   `ECHO`打印`ABC`。

扩展速度较慢，这`CALL`可能特别体现在循环中。`!`另一方面，扩展具有一些含义，特别是由于该命令`SETLOCAL`用于启用语法这一事实。[在我对另一个问题的回答中](https://stackoverflow.com/questions/5816178/how-to-replace-string-inside-a-bat-file-with-command-line-parameter-string/5821366#5821366 "如何用命令行参数字符串替换bat文件中的字符串")有更多关于这个主题的内容。

# excel - VBA 粘贴范围

> ID：14921846
> 
> 赞同：0
> 
> 时间：2013-02-17T14:01:39.853
> 
> 标签：excel, excel-2003, vba

我想知道是否有人可以帮助我：

如果给定的单元格范围与特定的公式结果匹配，我正在使用下面的代码（我得到了一些帮助）将数据行从一张表复制到另一张表。

```
Sub test()
    Set Sht = Sheets("Sheet 1")
    rw = 5
    Do While Len(Sht.Cells(rw, "A").Value) > 0
        If Sht.Cells(rw, "B").Value > 0 Then
            ResourcesAllUsed = True
            For colm = 3 To 25 Step 2
                If (Sht.Cells(rw, colm + 1).Value < (Sht.Cells(rw, colm).Value * 0.85)) Or (Sht.Cells(rw, colm + 1 + 25).Value < (Sht.Cells(rw, colm + 25).Value * 0.85)) Then
                    ResourcesAllUsed = False
                    Exit For
                End If
            Next colm
            If Not ResourcesAllUsed Then
                With Sheets("Sheet 2")
                    NextRw = .Cells(.Rows.Count, "A").End(xlUp).Row + 1
                    .Cells(NextRw, "A").Resize(, 26).Value = Sht.Cells(rw, "A").Resize(, 26).Value
                    .Cells(NextRw, "AD").Value = Sht.Cells(rw, "AD").Value
                End With
            End If
        End If
        rw = rw + 1
    Loop
    End Sub 
```

副本工作正常，但我在开始粘贴的行上遇到了一些麻烦。

我想从“A5”开始粘贴，但由于某种原因，粘贴从“A2”开始。

我只是想知道是否有人可以看看这个，让我知道我哪里出错了。

非常感谢和亲切的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T15:36:19.077

第一次通过循环将`NextRow`变量设置为 A2，这意味着唯一的数据在 A1 中（或者 A1 中也没有任何数据）。要强制它从 A5 开始，您可以将行更改为：

```
NextRw = Application.WorksheetFunction.Max(.Cells(.Rows.Count, "A").End(xlUp).Row + 1,5) 
```

这意味着您将在第 2 行（或第 1 行）到第 4 行中有空白单元格。

# jquery - jQuery初学者选择

> ID：14921850
> 
> 赞同：0
> 
> 时间：2013-02-17T14:01:46.317
> 
> 标签：jquery

我有以下html代码：

```
<div class="first-div">
    <p><a>click this</a></p>
</div>
<br />
<div class="second">
    <p>show this</p>
</div> 
```

我隐藏`.second`在文件加载中。当我单击唯一的锚点时，我想选择带有 class 的 div `second`，尝试了一切但仍然没有运气。

这是我的 JavaScript：

```
$(document).ready(function(e) {
    $(".second").hide()
    $("a").click(function(e) {
        $(this).parent().parent().next(".second").toggle()
    });
}); 
```

另外，我有几个在 PHP 中动态加载的 div。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:05:42.913

改变，

```
$(this).parent().parent().next(".second").toggle() 
```

到

```
$(this).parent().parent().nextAll(".second").toggle() 
```

`next`元素不是`.second`但是`br`。

还，

`$(this).closest('.first-div').nextAll(".second").toggle()`应该管用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:07:35.897

使用`hide()`和`show()`

对于您的链接：

```
<a href="#" onclick="ShowIt()">Show</a> 
```

在您的代码中：

```
function ShowIt() {
    $('.second').show()
} 
```

# c# - 将模型转换为 ViewModel

> ID：14921857
> 
> 赞同：1
> 
> 时间：2013-02-17T14:03:06.477
> 
> 标签：c#, mvvm, automapper

这是我的类别模型：

```
public class Category :IAggregateRoot
    {
        public Guid Id { get; set; }
        public string Name { get; set; }

    } 
```

这是我的 CategoryViewModel ：

```
 public class CategoryViewModel
    {
        public Guid  CategoryId { get; set; }
        public string Name { get; set; }
    } 
```

我想用 Automapper 将此 Category 转换为 CategoryViewModel ，如果我将 CategoryViewModel 中的 CategoryId 更改为 Id ，就可以了！但在这种情况下，我的控制器中没有得到 Guid 值！我怎样才能将这些转换为相互指导？这也是我的映射器类：

```
public static CategoryViewModel ConvertToCategoryViewModel(this Category category)
        {
            return Mapper.Map<Category, CategoryViewModel>(category);
        } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T14:08:55.450

在某些时候，您可能正在通过调用来设置自动映射器映射

```
Mapper.CreateMap<CategoryModel, CategoryViewModel>(); 
```

在 CreateMap 之后，调用

```
.ForMember(m=>m.CategoryId, c=>c.mapfrom(d=>d.Id)). 
```

这告诉自动映射器从属性映射 categoryId`Id`属性。

编辑：完整的代码看起来像：

```
// in app start
Mapper.CreateMap<CategoryModel, CategoryViewModel>()
    .ForMember(cvm => cvm.CategoryId, c => c.MapFrom(cm => cm.Id));

// in you mapping method:
return Mapper.Map<CategoryModel, CategoryViewModel>(categoryModel); 
```

# seo - 延迟“延迟”加载 YouTube 视频内容和 SEO 效果

> ID：14921858
> 
> 赞同：3
> 
> 时间：2013-02-17T14:03:14.837
> 
> 标签：seo, load, lazy-evaluation

我的网站使用了来自 YouTube 视频、Facebook 和 SoundCloud 的大量插件/活动内容。这些效果会增加页面的加载时间。

我使用 Jquery .ready() 事件开发了在页面加载后使用嵌入式 Iframe 填充 DIV 的代码。这并不聪明，但它大大改善了页面加载时间：

```
<script type="text/javascript">

$(document).ready(function() { 
    $("#video").html("<iframe width='350' height='230' src='http://www.youtube.com/embed/myid?wmode=transparent' frameborder='0'></iframe> ");
});

</script> 
```

从 SEO 的角度来看，只要视频内容与页面内容相关，谷歌就会喜欢它。我的代码在页面加载后依靠 Javascript 加载视频。我知道 Googlebot 使用 Javascript，但这种方法使用安全吗？它会影响我的 SEO 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-20T03:32:27.383

一般来说，谷歌不会索引用 JS 呈现的东西。您的视频代码很好，因为它有助于减少页面加载时间。

您可以尝试在#video 元素中包含与视频相关的内容。这将有助于为您的视频提供一些 SEO 上下文，并帮助没有打开 JS 的任何人。

# java - JAXB 注释 - 马歇尔列表

> ID：14921866
> 
> 赞同：4
> 
> 时间：2013-02-17T14:04:03.400
> 
> 标签：java, xml, jakarta-ee, jaxb, marshalling

我有这个简单的对象：

```
@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
public class SimilarityInfoResult {

    private String name;

    private List<String[]> parameters;

    public SimilarityInfoResult() {
    }

    public SimilarityInfoResult(String name, List<String[]> parameters) {
        this.name = name;
        this.parameters = parameters;
    }

...

} 
```

它被映射为：

```
 <similarityInfoResult>
        <name>SubstructureSimilarity</name>
        <parameters>
            <item>treshold</item>
            <item>Double</item>
        </parameters>
        <parameters>
            <item>numberOfResults</item>
            <item>Integer</item>
        </parameters>
    </similarityInfoResult> 
```

期望的输出：

```
<similarityInfoResult>
    <name>SubstructureSimilarity</name>
    <parameters>
        <parameter>
            <name>treshold</name>
            <type>Double</type>
        </parameter>
        <parameter>
            <name>results</name>
            <type>Integer</type>
        </parameter>
    </parameters>
</similarityInfoResult> 
```

我应该如何使用注释来做到这一点？可能吗？也许我将不得不制作特殊的参数对象和`List<Parameter>`？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T14:07:30.657

您需要添加`Parameter`类来持有`name`和`type`。并更改`List<String[]>`为`List<Parameter>`.

这样您可以更轻松地控制参数对象的 XML 解析。

并使用：

```
@XmlElementWrapper(name="parameters")
@XmlElement(name="parameter")
private List<Parameter> parameters; 
```

和：

```
public class Parameter{

    private String name;
    private String type;
...

} 
```

# c# - Http 服务器 - 监听响应

> ID：14921869
> 
> 赞同：2
> 
> 时间：2013-02-17T14:04:32.737
> 
> 标签：c#, http, service, request, listener

我已经阅读了以下关于创建简单 http 服务的文章： [使用 C# 创建简单的线程 HTTP 服务器](http://www.prodigyproductionsllc.com/articles/programming/create-a-simple-threaded-http-server-with-c/) 在实现某些东西之前，我有点进退两难。

我有一项服务将 http 请求发送到多个目的地（同时限制最大目的地），并从每个目的地接收响应。响应很短，只有一个状态（如果正常，则为 200，或其他代码），如果请求被正确处理。

上面的文章在 while 循环中创建了一个侦听器，该侦听器被阻塞并正在侦听请求。

```
23          private static void Listen()
24          {
25              listener.Start();
26              WriteLog("Listening On: " + port.ToString());
27   
28              while (true)
29              {
30                  WriteLog("Waiting for connection...");
31                  TcpClient client = listener.AcceptTcpClient();
32                  Thread listenThread 
                       = new Thread(new ParameterizedThreadStart(ListenThread));
33                  listenThread.Start(client);
34              }
35          } 
```

我需要向设备发送请求并听取每个设备的响应。如果我得到一个响应，并且直到循环返回到监听命令（31），是否有可能另一个响应会溜走？

如果我处理的 http 请求数量有限，我应该为每个侦听器创建一个侦听器还是一个侦听器更好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:07:19.277

你考虑过 T ASP.net Webapi 吗？这应该正是您需要的 dp :-) 您还可以拥有异步控制器，并且有大量示例。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:11:07.080

等待的 TCP 连接`accept`放在连接积压中（默认为 100 IIRC，您可以在侦听器构造函数中更改它）。这意味着可能有 100 个并发 TCP 连接请求等待被接受。

因此，除非您有超过该数量的连接等待处理，否则您不会丢失任何连接。

# selenium - 它是一种在配置阶段在 TestNG 侦听器中获取测试方法名称的方法吗？

> ID：14921880
> 
> 赞同：0
> 
> 时间：2013-02-17T14:05:34.313
> 
> 标签：selenium, webdriver, testng, thucydides

我有一个实现 IInvokedMethodListener 的 TestNG 侦听器。在@BeforeMethod 上，我需要设置一些测试上下文，示例如下：

```
public class ThucydidesInvokedMethodListener implements IInvokedMethodListener2 {

    public void beforeInvocation(final IInvokedMethod method, final ITestResult testResult) {

    boolean areBeforeMethods = method.getTestMethod().getTestClass().getBeforeTestMethods().length > 0;
    if ((areBeforeMethods && method.getTestMethod().getTestClass().getBeforeTestMethods()[0] == method.getTestMethod()) ||
            !areBeforeMethods && method.isTestMethod()) {

        final ThucydidesTestContext context = new ThucydidesTestContext(testResult);
        testResult.setAttribute(contextKey(), context);
        context.before();
    }
} 
```

但我还需要一个将在 BeforeMethod 之后执行的测试名称，以便在报告中使用此测试名称。这可能使用TestNG吗？我还尝试了另外具有 ITestContext 的 IInvokedMethodListener2，但它也没有提供测试名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T08:52:55.217

使用监听器来配置测试对我来说听起来是错误的——这就是 @Before* 注释的用途。

我不知道如何通过侦听器获取您想要的信息，但使用 @BeforeMethod 很简单：只需将 java.reflect.Method 类型的参数添加到您的方法签名中，TestNG 将注入当前方法，然后您可以请求该方法它的名字和你想知道的一切。

TestNG 注释的所有“魔法”都记录在这里：[TestNG 依赖注入](http://testng.org/doc/documentation-main.html#native-dependency-injection)

高温高压

/詹斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-02-19T17:48:36.033

```
import java.lang.reflect.Method;

public class TestToGetMethodName
{ 

    @BeforeMethod
    public void handleTestMethodName(Method method)
    {
        String testName = method.getName(); 
    }

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-20T18:09:42.537

好吧，使用 IInvokedMethodListener，beforeInvocation 方法为您提供了 IInvokedMethod 方法。

`method.getTestMethod.getMethodName()`给你方法名。

# html - 向左浮动不适用于菜单

> ID：14921886
> 
> 赞同：0
> 
> 时间：2013-02-17T14:06:06.873
> 
> 标签：html, css

我想创建菜单栏及其内容如下，但内容显示在另一个下方：

HTML：

```
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>Login</title>
    <link rel="stylesheet" type="text/css" href="style.css"/>
</head>
<div class="menuheader"> Facebook, Twitter, Youtube </div>
<div class="menu">
    <ul>  Home </ul>
    <ul> About Us 
        <li>  Establishment </li>
    </ul>
    <ul>  Careers  
        <li>  Current Openings  </li>
        <li>  Working with us  </li>
        <li> Work Culture  </li>
    </ul>
    <ul>  Contact Us  </ul>
</div> 
```

CSS：

```
.menu{
    background-color:#999999;
    color:#FFFFFF;
    width:940px;
    height:50px;
    margin:20px;
    padding:20px;
    font-size:12px;
    float:left;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:12:49.967

float:left 正在工作，但是，您向右填充 20px 会导致问题。我为你做了一个小提琴， http: [//jsfiddle.net/tsJ7r/1/](http://jsfiddle.net/tsJ7r/1/) 更改：

```
 padding:20px; 
```

至：

```
padding:0px; 
```

它应该可以工作如果您希望除了左侧之外的所有侧面都有填充，您可以使用

```
padding-top:20px;
padding-bottom:20px; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:20:42.267

您的无序列表标记不正确。尝试这样的事情：

```
<ul class="menu">
    <li>Home</li>
    <li>About Us</li>
    <li>Careers
       <ul>
           <li>Current Openings</li>
           <li>Working With Us</li>
           <li>Working Culture</li>
       </ul>
    </li>
    <li>Contact Us</li>
</ul> 
```

然后您的 CSS 将如下所示：

```
ul.menu {
    float: left;
}

ul.menu li {
     float: left;
     padding: 20px;
     // etc.
} 
```

# c - 如何将文本与终端的中心对齐？

> ID：14921887
> 
> 赞同：5
> 
> 时间：2013-02-17T14:06:08.910
> 
> 标签：c

我想让我的文本与终端的中心水平对齐。我怎样才能在 C 中做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T14:21:42.220

要扩展@eyalm 的答案：如果你有`COLUMNS`var，你可以像这样将字符串居中：

```
int columns = strtol(getenv("COLUMNS"), NULL, 10);
int fwidth = strlen(s) + (columns - strlen(s)) / 2;
printf("%*s\n", fwidth, s); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T14:15:48.687

如果您正在使用 bash，请使用`COLUMNS`环境变量来获取宽度并计算中心。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2014-04-18T04:44:49.730

如果您像我一样懒惰，在这里编写所有代码是一个简单的解决方案。

```
 Console.WriteLine("                  Hello World");
 Console.ReadLine(); 
```

如果需要，添加更多空间，直到其中心 LOL

# php - 无法修改标头信息 - 标头已发送

> ID：14921888
> 
> 赞同：-1
> 
> 时间：2013-02-17T14:06:09.633
> 
> 标签：php, session, login, header, mysqli

亲爱的朋友，我遇到了无法解决的奇怪错误，需要您的帮助。当登录不正确并且登录正确时，代码工作正常，它仍然会创建一个会话，但不会重定向到 index.php，而是会引发错误**“无法修改标头信息 - 标头已由...发送”。**我已经搜索过类似的帖子，但无法解决问题

这是代码

```
<?php include ("scripts/connection.php");
session_start();
$myusername = $_POST["myusername"];
$myusername = preg_replace('/[^a-zA-Z0-9\']/','',$_POST['myusername']);
$mypassword = $_POST["mypassword"];
$mypassword = preg_replace('/[^a-zA-Z0-9\']/','',$_POST['mypassword']);
$LoginQuery = "SELECT * FROM users WHERE username='$myusername' and password='$mypassword'";
?>
<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Admin Login</title>
</head>
<body>
<table width="300" border="0" align="center" cellpadding="0" cellspacing="1" bgcolor="#CCCCCC">
<tr><form name="form1" method="post">
<td>
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#FFFFFF">
<?php if($_SERVER["REQUEST_METHOD"] == "POST")
{ $result = $mysql->query($LoginQuery);
  if($result->num_rows ==1) 
{
$_SESSION['login_user']=$myusername;
header("Location:index.php");
exit();
}
else
{
echo '<tr><td width="78">&nbsp;</td><td width="6"></td><td width="294"><font style="color:#f00; font-weight:bold;">Invalid!</font></td></tr>';
}
}
?>
<tr>
<td colspan="3"><strong>Member Login </strong></td>
</tr>
<tr>
<td width="78">Username</td>
<td width="6">:</td>
<td width="294"><input name="myusername" type="text" id="myusername"></td>
</tr>
<tr>
<td>Password</td>
<td>:</td>
<td><input name="mypassword" type="text" id="mypassword"></td>
</tr>
<tr>
<td>&nbsp;</td>
<td>&nbsp;</td>
<td><input type="submit" name="Submit" value="Login"></td>
</tr>
</table>
</td>
</form>
</tr>
</table>
</body>
</html> 
```

朋友们可以找到我做错了什么并帮助我纠正它。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T14:08:57.943

`header`您应该在编写任何其他文本之前使用函数

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:09:53.073

你必须了解 HTTP：

通过 HTTP-Header 实现重定向。在 HTTP 中，**在**任何输出之前发送标头（例如网页本身）

因此，您在发送有效负载后尝试发送 Redirect-Header。

这是不可能的。

简而言之，在页面上打印出某些内容后，切勿使用 header()。

# c++ - 如何以短时间格式验证输入字符串

> ID：14921889
> 
> 赞同：1
> 
> 时间：2013-02-17T14:06:21.320
> 
> 标签：c++, validation, time-format

我有一个表示 24 小时时间的输入字符串。有效输入是字符串，例如：

> 7:04
> 07:4
> 7:4
> 07:04

一个无效的输入字符串显然是这样的`25:68`。有没有简单的方法来**验证**时间格式，然后在时间为今天的情况下以纪元格式**解析时间？**这里有可能派上用场的任何 boost 库吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T14:09:39.973

您可以使用 strptime 来完成，这是类 Unix 系统上的标准：http: [//www.kernel.org/doc/man-pages/online/pages/man3/strptime.3.html](http://www.kernel.org/doc/man-pages/online/pages/man3/strptime.3.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T14:50:47.970

我看到两个选项：

1.  简单的正则表达式或 boost::xpressive（我更喜欢它）。

2.  获取分号之间的数字并将它们转换为数字，然后检查它们的值。像这样的东西：

    > ```
    > string sTime("53:30");
    > int iSemiColon = sTime.find(':');       
    > if (atoi(sTime.substr(0, iSemiColon).c_str()) >= 24) return false;
    > if (atoi(sTime.substr(iSemiColon + 1).c_str()) >= 60) return false; 
    > ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T14:10:38.317

看到[这个答案](https://stackoverflow.com/questions/14005842/convert-and-validate-string/14007098#14007098)。如果您不限于 STL，则可以将`boost.Regex`其用于验证部分，尽管这是一个非常简单的问题，您可以轻松推出自己的解决方案。

# android - 使用服务器端验证设置在 Android Google 身份验证中获取用户信息

> ID：14921896
> 
> 赞同：0
> 
> 时间：2013-02-17T14:07:20.407
> 
> 标签：android, google-oauth, google-play-services

我在使用 Google Play 服务让 Google 身份验证在我的 android 应用程序中工作时遇到了一些问题。首先，我使用库提供的示例使用以下范围获取令牌

```
GoogleAuthUtil.getToken(getActivity(), mEmail,"oauth2:https://www.googleapis.com/auth/userinfo.profile"); 
```

然后我使用令牌来获取有关用户的更多信息：

```
URL url = new URL("https://www.googleapis.com/oauth2/v1/userinfo?access_token=" + token);
HttpURLConnection con = (HttpURLConnection) url.openConnection(); 
```

那行得通。然后，我使用Google Developers Blog 上的“验证[来自 Android 应用程序的后端调用”](http://android-developers.blogspot.ro/2013/01/verifying-back-end-calls-from-android.html?utm_source=feedburner&utm_medium=feed&utm_campaign=Feed%3a%20blogspot/hsDu%20%28Android%20Developers%20Blog%29&utm_content=Google%20Reader)帖子向我的 Web 服务器验证应用程序用户。所以我将 getToken 的范围替换为

```
audience:server:client_id:<webapp_clientId_for_localhost>.apps.googleusercontent.com 
```

并使用与文章中类似的检查器来验证服务器端的受众和 clientId（Android 客户端 ID）。这也有效，但是，如果我尝试使用 userinfo API 从 android 应用程序或 Web 应用程序获取有关用户（名字和姓氏）的更多信息，我会得到：

> {“错误”：{“错误”：[{“域”：“全局”，“原因”：“authError”，“消息”：“无效凭据”，“位置类型”：“标题”，“位置”：“授权”}]，“代码”：401，“消息”：“无效凭证”}}

我使用的代码是：

```
URL url = new URL("https://www.googleapis.com/oauth2/v1/userinfo");
HttpURLConnection con = (HttpURLConnection) url.openConnection();
con.setRequestProperty("Authorization", "OAuth " + token);
con.setRequestProperty("ContentType", "application/json; charset=UTF-8"); 
```

知道为什么 userinfo 不起作用吗？还有什么我应该添加到范围的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-18T04:14:58.167

您用于后端验证的令牌适用于您的服务器，而带有 oauth2: 的令牌适用于 Google。此时没有同时请求两个令牌的机制，因此您需要对 GoogleAuthUtil 进行两次调用。在一个同意步骤之后，您应该能够请求两者（一次一个）。实际上，oauth2: 令牌的使用频率应该较低，因为您可以将用户的个人资料数据与您在家庭服务器中从他们那里获得的帐户相关联。

# asp.net-mvc - 如何将过滤器属性中的角色与我的数据库相关联？

> ID：14921897
> 
> 赞同：0
> 
> 时间：2013-02-17T14:07:25.390
> 
> 标签：asp.net-mvc, roles

Asp.net MVC 使用什么数据源来查看用户是否属于哪个角色。以及如何更改它以使其与我自己的数据库表一起使用（当我编写`[Autorize(Roles="admin")]`它时，如果用户处于角色中，则检查表）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T14:13:17.907

> Asp.net MVC 使用什么数据源来查看用户是否属于哪个角色。

它使用`RoleProvider`在您的 web.config 中配置的内容。如果您想使用自定义表，您可以[`custom role provider`](http://msdn.microsoft.com/en-us/library/8fw7xh74%28v=vs.100%29.aspx)通过从[`RoleProvider`](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.aspx)类继承并实现抽象成员来编写。该[`IsUserInRole`](http://msdn.microsoft.com/en-us/library/system.web.security.roleprovider.isuserinrole%28v=vs.100%29.aspx)方法是您应该始终实现的方法，因为在这种情况下将使用该方法：

```
public class MyRoleProvider: RoleProvider
{
    public override bool IsUserInRole(string username, string roleName)
    {
        // go and hit your custom datasource to verify if the user 
        // is in the required role and return true or false from this
        // method
        ...
    }
} 
```

然后您可以在 web.config 中注册您的自定义角色提供程序以替换默认角色提供程序：

```
<system.web>
    ...
    <roleManager enabled="true" defaultProvider="MyRoleProvider"> 
        <providers> 
            <add name="MyRoleProvider" type="Mynamespace.MyRoleProvider" /> 
        </providers> 
    </roleManager>
</system.web> 
```

如果您不想使用任何提供程序（从您的情况来看[`previous question`](https://stackoverflow.com/questions/14913271/why-using-telling-net-about-provider)似乎是这种情况），那么您应该编写一个自定义`Authorize`属性，该属性根本不使用角色提供程序，而是使用您的一些自定义代码：

```
public class MyAuthorizeAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        if (!httpContext.User.Identity.IsAuthenticated)
        {
            // no user is authenticated => no need to go any further
            return false;
        }

        // at this stage we have an authenticated user
        string username = httpContext.User.Identity.Name;
        return IsInRole(username, this.Roles);
    }

    private bool static IsInRole(string username, string roles)
    {
        // the username parameter will contain the currently authenticated user
        // the roles parameter will contain the string specified in the attribute
        // (for example "admin")
        // so here go and hit your custom tables and verify if the user is
        // in the required role
        ... 
    }
} 
```

最后用这个自定义属性装饰你的控制器操作，而不是依赖基于角色提供者的默认属性：

```
[MyAutorize(Roles = "admin")]
public ActionResult Index()
{
    ...
} 
```

# google-app-engine - 如何在 Google 应用引擎中动态创建表格

> ID：14921901
> 
> 赞同：2
> 
> 时间：2013-02-17T14:07:55.943
> 
> 标签：google-app-engine

嘿，谁能告诉我如何在 GAE 中动态创建表格。我想在 Facebook 中创建一个朋友列表，我可以在其中存储我朋友的详细信息。同样，每个人都会有自己的表格。我不能制作一张桌子因为如果某人是我的朋友，他可能有不是我朋友的人，所以我为什么要存储他们的详细信息。我搜索了很多，但没有找到任何东西。如果可能，请提出一些替代方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-17T15:19:03.313

在这种情况下，您可以使用命名空间。

[https://developers.google.com/appengine/docs/java/multitenancy/multitenancy](https://developers.google.com/appengine/docs/java/multitenancy/multitenancy)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-18T23:51:57.713

有关动态表创建的示例，您可以在[https://developers.google.com/appengine/articles/sharding_counters](https://developers.google.com/appengine/articles/sharding_counters)上查看 Google 的 ShardedCounter 类，以了解如何在运行时组合表的名称（实际上是 GAE 中的实体） .

# html - CSS：响应式设计 - 在两列列表中缩小图像

> ID：14921903
> 
> 赞同：1
> 
> 时间：2013-02-17T14:08:18.600
> 
> 标签：html, css, responsive-design

我有一个包含 6 张图片的无序列表。我希望列表仅在两列中显示图像，然后在窗口调整大小时缩小图像。

这是 jsFiddle 示例的链接：http: [//jsfiddle.net/WuwYZ/](http://jsfiddle.net/WuwYZ/)

目前，如果您的窗口宽度超过 450 像素，那么您将看到 3 列或更多列，如果它小于 300 像素，您将看到 1 列。

如何将列表的最大宽度设置为 300 像素，这样一列就不会超过两列？我怎样才能让图像缩小而不是合并成一列？

两列中的大图像：

```
 X X
 X X
 X X 
```

当窗口扩展时，它看起来像这样（但我希望它与上面保持相同）：

```
 X X X X 
 X X 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T14:16:15.753

您只需将宽度设置`li`为`50%`;

```
#thumbs{
    max-width:300px;
}
#thumbs li {
    width: 50%;
    float: left;
}
#thumbs li img {
    width: 100%;
} 
```

[http://jsfiddle.net/WuwYZ/2/](http://jsfiddle.net/WuwYZ/2/)

# tomcat - 在静态 IP 地址上运行我的应用程序

> ID：14921904
> 
> 赞同：0
> 
> 时间：2013-02-17T14:08:25.613
> 
> 标签：tomcat, ip, tomcat7

我有一个示例 Web 应用程序，它在 192.168.x.xxx:8080(Tomcat 7) 上运行。我想运行这个应用程序以在我的静态 IP 地址上运行。
我用谷歌搜索并找到了一个网站，它[在这里](http://www.nirsoft.net/show_my_ip_address.php)告诉我我的静态 IP 地址。现在我如何使用静态 IP 地址运行部署在 192.168.X.XXX 和端口 8080 中的应用程序？ [链接](http://www.nirsoft.net/show_my_ip_address.php)提供我的 ip 和运行端口。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-18T08:59:45.523

您必须配置路由器才能将数据包转发到绑定`TCP 8080 port`的内部地址。`Tomcat`

如何执行此操作取决于您的路由器。`Port Forwarding`一般的方法是在路由器控制面板里面搜索菜单，设置上面的规则。

# php - 如何将一个 PHP 文件的内容包含在另一个主文件中？

> ID：14921913
> 
> 赞同：0
> 
> 时间：2013-02-17T14:09:05.943
> 
> 标签：php, include

```
//Grab and assign List ID from confirmation URL 
$L = $_GET["L"]; 

//Set Redirects based on List ID  
if($L == "1") { 
header("Location: http://stat.domain.com/");
exit();
} 
```

这是我创建的重定向规则的内容，但我正在考虑将它们放在单独的文件中，而不是主文件 MASTER.php。我在网上阅读，有不同的方法可以从单独的文件中读取内容，其中包括 include() include_once() 之类的函数。但是，在网上阅读了一些资料后，我仍然不太确定应该怎么做才能将上述内容包含在主文件中。

有什么有效的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:12:40.220

您只想在某个位置包含该文件一次。也许添加一个 include 到`redirects.php`from `master.php`：

```
require_once 'redirects.php'; 
```

您也可以使用`include_once`，但如果找不到文件并且会静默失败，这不会停止脚本 - 这通常比显式更糟糕。

# c - 链表，在前面插入一个节点

> ID：14921915
> 
> 赞同：1
> 
> 时间：2013-02-17T14:09:11.887
> 
> 标签：c, linked-list

给定一个包含链表的对象，当我无法返回该链表的内存地址时，如何将新节点添加到该链表的头部？

```
struct group {
    char *name;
    struct user *users;
    struct xct *xcts;
    struct group *next;
};

struct user {
    char *name;
    double balance;
    struct user *next;
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T14:12:40.537

它比你想象的要简单得多：

```
usr->next = group->users;
group->users = usr; 
```

# java - 没有调用我的 PhoneStateListener 来显示信号强度

> ID：14921916
> 
> 赞同：0
> 
> 时间：2013-02-17T14:09:12.010
> 
> 标签：java, android, location, signal-strength, 3g-network

我试图在我的 3g 网络应用程序中显示当前信号强度和当前小区 ID 和 Lac。由于它必须与 API-8 兼容，因此我正在使用来自 android.telephony 的 SignalStrength 类。当我单击一个按钮时，现在我希望它显示当前单元格的 CID、Lac 和信号强度。我正在获取 CID 和 lac，但信号强度始终显示为 0。代码如下：

```
public void onClick(View v) {
    switch (v.getId()) {
    case R.id.bShowCell:
        GsmCellLocation location;
        String cellID = "";
        String lac = "";
        Context context = (Context) getApplicationContext();
        TelephonyManager tm = (TelephonyManager) context
                .getSystemService(Context.TELEPHONY_SERVICE);
        location = (GsmCellLocation) tm.getCellLocation();
        cellID = String.valueOf(location.getCid());
        lac = String.valueOf(location.getLac());
        CurCell.setText(cellID);
        CellLac.setText(lac);
        CurStrgth.setText(getRSSI());
    }
}

public String getRSSI() {
    MyListener = new MyPhoneStateListener();
    Tel = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
    Tel.listen(MyListener, PhoneStateListener.LISTEN_SIGNAL_STRENGTHS);
    String strength = MyListener.getStrength();
    return strength;
}

class MyPhoneStateListener extends PhoneStateListener {

    public int singalStrengths;

    @Override
    public void onSignalStrengthsChanged(SignalStrength signalStrength) {
        super.onSignalStrengthsChanged(signalStrength);
        int asu = signalStrength.getGsmSignalStrength();
        singalStrengths = -113 + 2 * asu;
    }

    public String getStrength() {
        return String.valueOf(singalStrengths);
    }
} 
```

我在网上查了很多例子，我认为我的代码还可以。但是当我在调试模式下检查它时，我看到当我单击按钮时，程序永远不会进入 onSignalStrengthsChanged。有什么我想念的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-08T15:30:24.890

好吧，这就是我后来尝试的方式，效果很好。我必须使 CurStrgth.setText() 独立于 Button 和 PhoneStateListener 内部，并从 OnCreate() 方法调用侦听器。它工作正常，只要信号强度发生变化，就会更新 CurStrgth TextView。我的代码如下：

```
public class MainActivity extends Activity implements OnClickListener {

TextView CurStrgth;
MyPhoneStateListener MyListener;
TelephonyManager Tel;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    CurStrgth = (TextView) findViewById(R.id.tvCurCellStrength);

    MyListener = new MyPhoneStateListener();

    Tel = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);
    Tel.listen(MyListener, PhoneStateListener.LISTEN_SIGNAL_STRENGTHS);

}

@Override
protected void onPause() {
    super.onPause();
    Tel.listen(MyListener, PhoneStateListener.LISTEN_NONE);
}

@Override
protected void onResume() {
    super.onResume();
    Tel.listen(MyListener, PhoneStateListener.LISTEN_SIGNAL_STRENGTHS);
}

private class MyPhoneStateListener extends PhoneStateListener {
    String gsmStrength = "";

    @Override
    public void onSignalStrengthsChanged(SignalStrength signalStrength) {
        super.onSignalStrengthsChanged(signalStrength);
            gsmStrength = String
                .valueOf(signalStrength.getGsmSignalStrength() * 2 - 113);
        CurStrgth.setText(MyListener.getStrength() + "dBm");
    }

    public String getStrength() {
        return gsmStrength;
    }

}
} 
```

现在，我检查了只是调用

```
 CurStrgth.setText(MyListener.getStrength() + "dBm"); 
```

在按钮的 OnClick() 方法中，它只显示一次值，但如果我稍后按下按钮，它永远不会更新强度并继续显示初始值。

# python - 读取 SDF（化学）文件的 Python 程序

> ID：14921929
> 
> 赞同：2
> 
> 时间：2013-02-17T14:10:16.770
> 
> 标签：python, chemistry

我想读取[sdf](http://en.wikipedia.org/wiki/Chemical_table_file#SDF)文件（包含许多分子）并返回分子的加权邻接矩阵。原子应被视为顶点，而键应被视为边。如果*i*和*j*顶点通过单键、双键或三键连接，则邻接矩阵中的对应条目应分别为 1、2 和 3。我需要进一步获取每个顶点的*距离向量*，其中列出了不同距离的顶点数。

有没有可用的python包来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-24T02:57:14.933

我会推荐[Pybel](http://openbabel.org/docs/2.3.1/UseTheLibrary/Python_Pybel.html)在 Python 中读取和操作 SDF 文件。要获取绑定信息，您可能还需要使用功能更全面但 Pythonic 更少的[openbabel 模块](http://openbabel.org/docs/2.3.1/UseTheLibrary/PythonDoc.html)，它可以与 Pybel 一起使用（如 pybel.ob）。

首先，您将编写如下内容：

```
import pybel

for mol in pybel.readfile('sdf', 'many_molecules.sdf'):
  for atom in mol:
    coords = atom.coords
    for neighbor in pybel.ob.OBAtomAtomIter(atom.OBAtom):
      neighbor_coords = pybel.atom(neighbor).coords 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T20:40:44.783

看

[http://code.google.com/p/cinfony/](http://code.google.com/p/cinfony/)

但是，对于您的确切问题，您需要查阅文档。

# macos - 在 OSX 中复制包时权限更改

> ID：14921930
> 
> 赞同：2
> 
> 时间：2013-02-17T14:10:26.263
> 
> 标签：macos, filesystems, file-permissions

我有一个具有完全权限的捆绑目录（777）（包括子目录）

每当我使用 cp -r 将它复制到另一个目录时，我都会看到它失去了一些权限。

造成这种情况的原因是什么？如何在保持其权限不变的同时移动此捆绑包？

我有狮子版。

谢谢你

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T14:15:06.197

使用`-p`标志：

```
cp -Rp whatever whereever 
```

从`cp`手册页：

> ```
> Cause cp to preserve the following attributes of each source file
> in the copy: modification time, access time, file flags, file mode,
> user ID, and group ID, as allowed by permissions.  Access Control
> Lists (ACLs) and Extended Attributes (EAs), including resource
> forks, will also be preserved.
> 
> If the user ID and group ID cannot be preserved, no error message
> is displayed and the exit value is not altered.
> If the source file has its set-user-ID bit on and the user ID can-
> not be preserved, the set-user-ID bit is not preserved in the
> copy's permissions.  If the source file has its set-group-ID bit on
> and the group ID cannot be preserved, the set-group-ID bit is not
> preserved in the copy's permissions.  If the source file has both
> its set-user-ID and set-group-ID bits on, and either the user ID or
> group ID cannot be preserved, neither the set-user-ID nor set-
> group-ID bits are preserved in the copy's permissions. 
> ```

# javascript - 如何防止在 knockout.js 自定义绑定中递归调用更新和值更改回调？

> ID：14921949
> 
> 赞同：0
> 
> 时间：2013-02-17T14:12:18.550
> 
> 标签：javascript, jquery, recursion, knockout.js

我需要像绑定一样进行自定义`value`绑定。这是我的代码：

```
ko.bindingHandlers.myValue= {
    init: function(element, valueAccessor) {
        $(element).change(function() {
            var value = valueAccessor();
            value($(this).val());
        });
    },
    update: function(element, valueAccessor) {
        var value = valueAccessor();

        $(element).val(ko.utils.unwrapObservable(value))
    }
}; 
```

现在，如果我改变了 observable 的值，`update`将被调用并且元素的值将被改变，因此将执行`change`中描述的回调。 它将改变，所以回调将被调用，依此类推。我对吗？ `init`
`value``update`

如果是，我该如何防止这种递归？
如果不是，为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T20:08:53.120

您的代码不应导致递归情况；该`.val`方法不会触发`.change`事件。

在此处查看使用您的代码的示例：http: [//jsfiddle.net/CCNtR/13/](http://jsfiddle.net/CCNtR/13/)

# php - 我怎样才能有 php preg_match 的计数器？

> ID：14921953
> 
> 赞同：0
> 
> 时间：2013-02-17T14:12:25.553
> 
> 标签：php, preg-match

```
function getContent($xml,$tag,$id="") {
    if ($id=="") {
        $tag_regex = '/<'.$tag.'[^>]*>(.*?)<\/'.$tag.'>/si';
    } else {
        $tag_regex = '/<'.$tag.'[^>]*id=[\'"]'.$id.'[\'"]>(.*?)<\/'.$tag.'>/si';
    }
    preg_match($tag_regex,$xml,$matches);
    return $matches[1];
}

$omg = file_get_contents("Generated/index.php");
$extract = getContent($omg,"div","lolz2");
echo $extract; 
```

例如我有这样的东西。html里面有这样的东西：

```
<div id="lolz">qwg1eqwe</div>
<div id="lolz1"><div id='lolz2'>qwdqw2cq</div>asd3qwe</div> 
```

如果我们搜索 id lolz 我们会得到正确的答案，但是如果我们搜索 lolz1 我们首先会停下来，`</div>`那就是 inner `<div id="lolz2">`。可以为 preg_match 保留类似 counter 的东西，这将保持多少`<div>`'si pass 直到我找到`</div>`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:16:19.987

HTML 不是一种常规语言，因此构建类似的东西将是多余的，并且是 HTML 解析器的工作。请参阅：[RegEx 匹配除 XHTML 自包含标签以外的开放标签](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags)。

但是，您的代码失败的原因是因为您在输入中同时使用了单引号和双引号，但您的正则表达式没有考虑到它。这对我有用：

```
function getContent($xml,$tag,$id="") {
    if ($id=="") {
        $tag_regex = '/<'.$tag.'[^>]*>(.*?)<\/'.$tag.'>/si';
    } else {
        $tag_regex = '/<'.$tag.'[^>]*id=[\\\'"]'.$id.'[\\\'"]>(.*?)<\/'.$tag.'>/si';;
    }
    preg_match($tag_regex,$xml,$matches);
    return $matches[1];
}

$omg = '<div id="lolz">qwg1eqwe</div>
<div id="lolz1"><div id="lolz2">qwdqw2cq</div>asd3qwe</div>';
$extract = getContent($omg,"div","lolz2");
var_dump($extract); 
```

只要您没有嵌套元素，此代码就可以工作，并且您不需要使用 DOM 解析器，尽管您确实应该处理任何*可能*嵌套的更复杂的内容（例如，您无法控制输入） .

# c# - 从按钮到文本框的值

> ID：14921962
> 
> 赞同：-8
> 
> 时间：2013-02-17T14:13:25.210
> 
> 标签：c#

我在 Windows 窗体上有一个 textbox.text 和两个按钮。我希望如果我按下 A 按钮 A 显示在 textbox.text 中，当按下 B 按钮 B 显示在 textbox.text 中请帮助我？我在 Visual Studio 中使用 C#

```
textBox1.Text = button1.Text;
textBox2.Text = button2.Text; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:14:58.223

在 button1 中添加点击处理程序：

```
textBox1.Text = button1.Text; 
```

在按钮2中：

```
textBox2.Text = button2.Text; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-17T14:17:51.080

`==`是一个[布尔比较运算符](http://msdn.microsoft.com/en-us/library/53k8ybth.aspx)，对于`a == b`均值**a 与 b 相同**。您正在寻找的是`=` [赋值运算符](http://msdn.microsoft.com/en-us/library/sbkb459w.aspx)，它`a = b`表示**为 a 分配 b 的值**。将您的代码更改为：

```
textBox1.Text = button1.Content;  //button1.Text if ASP.NET vs. WPF.
//or
textBox1.Text = button2.Content; 
```

如果要基于按钮单击进行分配，则需要为按钮单击事件设置事件处理程序，然后将处理程序注册到按钮实例。我假设您使用的是 XAML，因为您指出了 Windows 窗体。

在 XAML 中：

```
<Button Name="buttonA" Click="buttonA_OnClick">A</Button>
<Button Name="buttonB" Click="buttonB_OnClick">B</Button>
<TextBox Name="text1" /> 
```

在您的 XAML 代码中：

```
void buttonA_OnClick(object sender, RoutedEventArgs e)
{
    text1.Text = buttonA.Content;
}

void buttonB_OnClick(object sender, RoutedEventArgs e)
{
    text1.Text = buttonB.Content;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-18T10:44:31.620

使用两个按钮的 Click 事件处理程序来设置文本框的文本。

在第一个按钮的 Click 事件上设置 textbox1.Text= button1.Text

在第二个按钮的 Click 事件上设置 textbox1.Text= button2.Text

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-10T23:00:39.983

```
 private void zero_Click(object sender, RoutedEventArgs e)
        {
            textbox.Text += "0";

        } 
```

# hibernate - JPA 循环引用。“对象引用了一个未保存的瞬态实例”

> ID：14921963
> 
> 赞同：2
> 
> 时间：2013-02-17T14:13:28.350
> 
> 标签：hibernate, jakarta-ee, jpa, orm, many-to-one

我正在使用 JPA / Hibernate。

假设我有文件夹和文件。每个文件夹可以包含更多的文件夹和文件。每个文件都知道它的根文件夹是什么（不是父文件夹）。

```
@Entity
public class Folder{
    ...

    @OneToMany
    @JoinColumn("folder_id")
    private List<Folder> folders;

    @OneToMany
    @JoinColumn("file_id")
    private List<File> files;

    ...
}

@Entity
public class File {
    ...

    @ManyToOne
    private Folder rootFolder;

    ...
} 
```

我创建了一个新文件和一个新文件夹。我把文件放在文件夹里。现在该文件位于文件夹“files”-collection 中，并且该文件夹在文件“rootFolder”-变量中被引用。

如果我坚持这一点，我会得到“对象引用了一个未保存的瞬态实例”或“在刷新之前保存瞬态实例：entities.file.rootFolder -> entities.Category”（取决于首先持久化的内容）。

必须有一种方法可以对此进行注释，因此无论我先保存什么，它都会起作用！？我可以以某种方式以编程方式解决它，在不引用另一个实体的情况下插入第一个实体，然后插入另一个实体，然后放入引用，但我认为这里不应该这样做。

我搜索了这个，但我能找到的只是@OneToMany 与@ManyToOne 的结合，但就我而言，我无法使用它。文件夹不应该知道它是否是根文件夹。

我会很感激任何关于教程的想法或方向。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-17T15:33:02.780

这些映射或您描述的场景没有问题，假设这一切都发生在一个事务中，或者更准确地说，两者之间没有刷新。您描述的错误*仅*发生在刷新时，这通常发生在事务提交时。它甚至会在错误中告诉您“在刷新之前保存瞬态实例”。不允许刷新部分保存的对象图。只要在刷新发生之前保存图表中的所有对象，就可以了。

我根据您的代码在 Github 上创建了一个工作示例。您可以[浏览代码](https://github.com/zzantozz/testbed/tree/master/stackoverflow/14921963-hibernate-circular-reference)和/或克隆项目并使用以下命令运行它：

```
git clone git://github.com/zzantozz/testbed.git tmp
cd tmp/stackoverflow/14921963-hibernate-circular-reference
mvn -q compile exec:java -D exec.mainClass=com.foo.Main 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T15:36:39.287

如果您在同一事务中保留两个对象，您的代码应该可以工作。

但是，在文件和文件夹之间的关系中，您错误地标记了所有者。多对一的一方[几乎总是关系的所有者](http://docs.jboss.org/hibernate/annotations/3.5/reference/en/html_single/)。因此，正确的方法是：

```
@Entity
public class File {
  @ManyToOne
  @JoinColumn(name = "folder_id") // this table has a foreign key
  private Folder rootFolder;
}

@Entity
public class Folder {
  @OneToMany(mappedBy = "rootFolder") // 'File' is the owner of this relationship
  private List<File> files;
}
```

同样，在 中`Folder`，它应该只是：

```
@OneToMany 
private List<Folder> folders;
```

或者，您可以使用双向关系：

```
@Entity
public class Folder {
  @ManyToOne
  private Folder parent;

  @OneToMany(mappedBy = "parent")
  private List<Folder> folders;
```

我希望这有帮助。

# c# - 显示/隐藏文本框 - 可见

> ID：14921965
> 
> 赞同：0
> 
> 时间：2013-02-17T14:13:32.023
> 
> 标签：c#

我目前正在使用文本框上的可见属性。下面我复制/粘贴了我的代码片段。加载表单时，我总共有 8 个文本框设置为可见 false。然后我有两个相应地显示文本框的单选按钮。一个`radioButton`将显示前 4 个文本框，另一个将显示所有 8 个文本框。问题是当切换回`radioButton1`只显示 4 个文本框时，它仍然会显示所有 8 个文本框吗？

```
 private void radioButton1_CheckedChanged(object sender, EventArgs e)
    {

        int count = 0;
        int txtBoxVisible = 3;

        foreach (Control c in Controls)
        {
            if (count <= txtBoxVisible)
            {
                TextBox textBox = c as TextBox;
                if (textBox != null) textBox.Visible = true; 
                count++;
            }
        }
    }

private void radioButton2_CheckedChanged(object sender, EventArgs e)
    {

        int count = 0;
        int txtBoxVisible = 7;

        foreach (Control c in Controls)
        {
            if (count <= txtBoxVisible)
            {
                TextBox textBox = c as TextBox;
                if (textBox != null) textBox.Visible = true; 
                count++;
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-17T14:18:05.240

尝试改变这个：

```
private void radioButton1_CheckedChanged(object sender, EventArgs e)
{
    RadioButton rb = sender as RadioButton;
    if (rb != null && rb.Checked)
    {
        int count = 0;
        int txtBoxVisible = 3;
        HideAllTextBox();
        foreach (Control c in Controls)
        {

            if(count > txtBoxVisible) break;

            TextBox textBox = c as TextBox;

            if (count <= txtBoxVisible && textBox != null)
            {
                textBox.Visible = true; 
                count++;
            }
        }
    }
}

private void radioButton2_CheckedChanged(object sender, EventArgs e)
{
    RadioButton rb = sender as RadioButton;
    if (rb != null && rb.Checked)
    {

        foreach (Control c in Controls)
        {
            TextBox textBox = c as TextBox;
            if (textBox != null) textBox.Visible = true; 
        }
    }
}

private void HideAllTextBox()
{
    foreach (Control c in Controls)
    {
        TextBox textBox = c as TextBox;
        if (textBox != null) textBox.Visible = false; 
    }
} 
```

在任何情况下，最好遍历控件或类似名称，以提高受影响控件的准确性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-17T14:20:49.073

当控件的属性发生变化时发生该`CheckedChanged`事件。这意味着无论是选中还是未选中。`Checked``RadioButton``RadioButton`

尝试编写类似于以下内容的内容：

```
private void radioButton1_CheckedChanged(object sender, EventArgs e)
{
    if (radioButton1.Checked)
    {
        // Display the first 4 TextBox controls code.
    }
}

private void radioButton2_CheckedChanged(object sender, EventArgs e)
{
    if (radioButton2.Checked)
    {
        // Display all TextBox controls code.
    }
} 
```

# asp.net-mvc - 日期在 Asp.Net MVC 中显示选项

> ID：14921966
> 
> 赞同：3
> 
> 时间：2013-02-17T14:13:38.783
> 
> 标签：asp.net-mvc

我在 .Net MVC4 应用程序中的模型中有一个 DateTime 字段。我希望编辑视图显示日期值，同时向用户提供使用日历控件的选项。

添加属性`[DisplayFormat(DataFormatString = "{0:d}",ApplyFormatInEditMode = true)]`向用户显示当前值作为文本字段： ![显示格式输出](../Images/add71e4e1859617f0c82572441be6451.png)

添加`[DataType(DataType.Date)]`显示“mm/dd/yyyy”并隐藏当前值： ![DateFormat(DataType.Date) 输出](../Images/b38c7a4f01133eee54c3d59a5d5facdb.png)

并在选择向下箭头时提供了一个不错的日历小部件：
![日历小部件](../Images/bbc2b9e64960b4fb46aefe5c469de3d7.png)

有没有办法结合这个功能，让用户可以看到当前选择的日期和日历小部件？

**更新**

这是浏览器行为。控件生成的标记包含当前日期值：

```
 <input class="text-box single-line" data-val="true" data-val-date="The field Dining Date must be a date." data-val-required="The Dining Date field is required." id="DiningDate" name="DiningDate" type="date" value="2/15/2013"> 
```

IE9 通过显示没有小部件的日期来呈现此标记，而 Chrome 隐藏日期。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-17T14:39:01.030

> IE9 通过显示没有小部件的日期来呈现此标记

IE9 根本不支持日期输入，因此您可以忘记此 Web 浏览器中的任何小部件。甚至 IE10 都不支持 :-) 请[`following article`](http://caniuse.com/input-datetime)查看支持 HTML5 日期输入的网络浏览器。所有其他不支持它的浏览器只会显示一个标准文本框，而没有任何日期时间选择器小部件。

> 而 Chrome 隐藏了日期。

[`HTML specification`](http://dev.w3.org/html5/markup/input.date.html)声明日期输入字段的属性`value`必须使用[`RFC 3339 format`](https://www.rfc-editor.org/rfc/rfc3339)才能显示此默认值：

```
<input id="Date" name="Date" type="date" value="2013-02-17" /> 
```

如果`value`使用不同的格式，则不会显示此默认值。

因此，如果您不想获得未定义的行为，请确保遵守规范：

```
[DisplayFormat(DataFormatString = "{0:yyyy-MM-dd}", ApplyFormatInEditMode = true)] 
```

然后你会得到预期的结果：

![在此处输入图像描述](../Images/e537754b1424a66ec56a9a335bd31e03.png)

# c# - C# MVC 类对象引用未设置为对象的实例

> ID：14921968
> 
> 赞同：3
> 
> 时间：2013-02-17T14:13:54.273
> 
> 标签：c#, .net, asp.net-mvc

任何人都可以帮我解决我的课堂问题吗？

我有一个地址类：

```
public class Address
{
    public string addressDescription { get; set; }
    public string addressNumber { get; set; }
    public string adddressLine1 { get; set; }
    public string adddressLine2 { get; set; }
    public string adddressLine3 { get; set; }
    public string addressPostCode { get; set; }
    public double addressLatitude { get; set; }
    public double addressLongitude { get; set; }
} 
```

我有一个路线类：

```
public class Route
{
    public Address from { get; set; }
    public Address to { get; set; }
} 
```

在我的控制器中，我设置了一些像这样的虚拟信息：

```
public ActionResult FareCalculator(string from , string to)
    {

        var myroute = new Route();

        myroute.from.addressDescription = from;
        myroute.from.addressLatitude = 51.481581;
        myroute.from.addressLongitude = -3.179090;
        myroute.to.addressDescription = to;
        myroute.to.addressLatitude = 51.507335;
        myroute.to.addressLongitude = -0.127683;

        return View(myroute);
    } 
```

但是当我运行该项目时，它会落在 myroute.from.addressDescription = from; 表示对象引用未设置为对象实例的行。

我看不出我做错了什么。有人可以帮忙吗？

谢谢

特雷夫

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T14:15:08.000

您需要创建一个新实例`Address`并将其分配给`from`and `to`：

```
public ActionResult FareCalculator(string from , string to)
{

    var myroute = new Route();
    myroute.from = new Address(); // new instance
    myroute.from.addressDescription = from;
    myroute.from.addressLatitude = 51.481581;
    myroute.from.addressLongitude = -3.179090;

    myroute.to = new Address(); // new instance
    myroute.to.addressDescription = to;
    myroute.to.addressLatitude = 51.507335;
    myroute.to.addressLongitude = -0.127683;

    return View(myroute);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-17T14:22:05.287

我可以建议使用构造函数来初始化 from 和 to 字段吗？否则，每次使用 Route 类时都必须新建对象。

```
public class Route
{
    public Address from { get; set; }
    public Address to { get; set; }

    public Route()
    {
        from = new Address();
        to = new Address();
    }
} 
```

这样您就可以使用您提供的代码：

```
 var myroute = new Route();

    myroute.from.addressDescription = from;
    myroute.from.addressLatitude = 51.481581;
    myroute.from.addressLongitude = -3.179090;
    myroute.to.addressDescription = to;
    myroute.to.addressLatitude = 51.507335;
    myroute.to.addressLongitude = -0.127683;

    return View(myroute); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-17T14:15:11.017

您已创建`Route`实例，但忘记创建`Address`(for `from`and `to`) 的新实例：

```
var myroute = new Route
{
    from = new Address(),
    to = new Address()
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-17T14:17:34.707

`myroute.from`并且`myroute.to`应该是`Address`类的一个实例。

```
 public ActionResult FareCalculator(string from , string to)
 {
        var myroute = new Route();

        myroute.from = new Address();
        myroute.from.addressDescription = from;
        myroute.from.addressLatitude = 51.481581;
        myroute.from.addressLongitude = -3.179090;

        myroute.to = new Address();
        myroute.to.addressDescription = to;
        myroute.to.addressLatitude = 51.507335;
        myroute.to.addressLongitude = -0.127683;

        return View(myroute);
    } 
```

# python - 查询分层映射器

> ID：14921978
> 
> 赞同：1
> 
> 时间：2013-02-17T14:15:19.097
> 
> 标签：python, sqlalchemy

我有两个模型，与多对多相关，其中一个是分层模型：

```
#hierarchical model
class Tag(Base):
    __tablename__ = "tags"

    id = Column(Integer, primary_key=True)
    name = Column(String)

Tag.parent_id = Column(Integer, ForeignKey(Tag.id, ondelete='CASCADE'))
Tag.childs = relationship(Tag, backref=backref('parent', remote_side=[Tag.id]),
     cascade="all, delete")

class Subject(Base):
    __tablename__ = "subjects"

    id = Column(Integer, primary_key=True, doc="ID")
    name = Column(String)
    tags = relationship(Tag, secondary="tags_subjects", backref="subjects")

#many-to-many relations model
class TagsSubjects(Base):
    __tablename__ = "tags_subjects"
    id = Column(Integer, primary_key=True)
    tag_id = Column(Integer, ForeignKey("tags.id"))
    subject_id = Column(Integer, ForeignKey("subjects.id")) 
```

所以，我将尝试解释我想要做什么......我想进行一个（或几个）查询，以搜索所有主题的对象，这些对象具有像 'foo' 这样的“名称”字段值或具有相关标签的具有诸如“foo”之类的值的名称或具有相关标签的名称，该名称具有一个或多个父级（或按层次结构高于）具有诸如“foo”之类的“名称”值的标签

我试过这样做：

```
>>> subjects = session.query(Subject).filter(or_(
                Subject.name.ilike('%{0}%'.format('foo')),
                Subject.tags.any(
                Tag.name.ilike('%{0}%'.format('foo')))
            )).order_by(Subject.name).all() 
```

但它不是正确和“扁平”的查询，没有分层功能:(如何通过 SQLAlchemy 的 API 做到这一点？谢谢！

PS 我正在使用 SQLite 后端

# programming-languages - 谁能帮我识别这种语言？

> ID：14921990
> 
> 赞同：-4
> 
> 时间：2013-02-17T14:15:54.037
> 
> 标签：programming-languages

我从第三方系统继承了一些代码。供应商将向我提供他们的文档，但如果他们的语言是更通用语言的某种变体，那么了解它会很有用。下面是几个片段：

```
 for var i = 0 to short_q.getSize()-1 
 { 
    sumq+=short_q[i];
    sumpq+=short_q[i]*short_p[i];
 } 

 Number trd_qty_short := trd_qty_short1 + trd_qty_short2; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T14:25:33.533

您可以尝试[SourceClassifier](https://github.com/chrislo/sourceclassifier)：

> 源分类器使用在计算机语言基准游戏生成的语料库上训练的贝叶斯分类器识别编程语言。它是用 Ruby 编写的，可以作为 gem 使用。要训​​练分类器识别新语言，请从 github 下载源代码。
> 
> 开箱即用的 SourceClassifier 可识别 Css、C、Java、Javascript、Perl、Php、Python 和 Ruby。

# javascript - angularjs ng-repeat 在两个级别上，但只有一个输出

> ID：14921992
> 
> 赞同：3
> 
> 时间：2013-02-17T14:16:19.693
> 
> 标签：javascript, angularjs, ng-repeat

我有一个看起来像这样的大对象：

```
scope.marketplaces = {

    first_example : { ... },
    second_example : { ... },

    ...

}; 
```

我想做的是像这样循环遍历大对象：

```
<section>
    <ul>
        <li ng-repeat="(key, value) in marketplaces"></li>
    </ul>
</section> 
```

在循环内部，再次循环每个对象，而不是附加到 DOM 中，例如：

```
<li> ... first level loop ...

    <li> ... second level loop ... </li>
</li> 
```

`<li></li>`尽管我正在循环播放关卡，但我只想拥有一个。我想要这样的原因是因为我需要`key`从第一个循环向下引用级别循环并且仍然只有一个`li`.

我读过它`ng-repeat="friend in friends | filter:searchText"`可以做我想做的事，但我不确定在过滤器表达式中我是否可以动态指定`key`需要的或其他东西，而不是`searchText`（我猜这是对象的已知属性）。

所以我的问题是，我可以实现我刚才解释的内容，`filter`还是有另一种方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-17T15:57:27.293

我希望我已经理解了问题：您希望在嵌套对象上有一个 ngRepeat。如此线性化对象。

第一种方法是创建过滤器：

```
app.filter('linear', function() {
  return function(value) {
    var result = {};
    for(var key in value) {
      for(var cKey in value[key]) {
        result[key+'_'+cKey] = value[key][cKey];
      }      
    }
    return result;
  };
}); 
```

在 thml 中：

```
<li ng-repeat="(key, value) in marketplaces | linear">
          {{key}}: {{value}}
</li> 
```

**但不幸**的是，AngularJS 在过滤器中创建新元素时会出现问题。您可以在控制台类型中显示错误消息：

```
10 $digest iterations reached 
```

如果没有 hack，`$$hash`您现在无法实现该功能*（如果我错了，请纠正我）*。

所以我认为目前的解决方案是在控制器中观看“市场”并使用与在 ngRepeat 中使用的控制器中相同的代码创建新对象：

```
$scope.$watch('marketplaces', function(value) {
    var result = {};
    for(var key in value) {
      for(var cKey in value[key]) {
        result[key+'_'+cKey] = value[key][cKey];
      }      
    }
    $scope.linearMarketplaces = result;

  }, true); 
```

在 HTML 中：

```
 <li ng-repeat="(key, value) in linearMarketplaces">
      {{key}}: {{value}}
    </li> 
```

Plunker 两种解决方案：[http ://plnkr.co/edit/pYWFhqSqKAa9gpzek77P?p=preview](http://plnkr.co/edit/pYWFhqSqKAa9gpzek77P?p=preview)

# php - 了解 HTML 净化器

> ID：14921995
> 
> 赞同：0
> 
> 时间：2013-02-17T14:17:01.533
> 
> 标签：php, codeigniter, security, xss

我目前正在使用 CodeIgniter。我有 4 个表单（学生登录、登录表单、创建帐户和请求帐户）

我目前正在使用它来过滤我在其中一种表单上的输入（创建帐户）：

```
function create()
    {
        $this->load->library('bcrypt'); 
        $this->load->library('form_validation');

        $this->form_validation->set_rules('fname', 'First Name', 'trim|required|alpha|max_length[14]');
        $this->form_validation->set_rules('lname', 'Last Name', 'trim|required|alpha|max_length[14]');
        $this->form_validation->set_rules('email', 'Email Address', 'trim|required|is_unique[users.email]|valid_email');
        $this->form_validation->set_rules('username', 'Username', 'trim|is_unique[users.username]|required|alpha_numeric||min_length[4]|max_length[15]');
        $this->form_validation->set_rules('password', 'Password', 'trim|required|min_length[7]|alpha_dash|max_length[20]');
        $this->form_validation->set_rules('passwordconf', 'Confirm Password', 'trim|required|min_length[7]|max_length[20]|matches[password]|alpha_dash');

        if($this->form_validation->run() == FALSE)
        {
            $this->view();
        } 
```

据我了解，仅当用户数据将在表格、论坛、博客（等）中以 HTML 形式回显/输出时，才应使用 HTML Purifier。我对此的理解是否正确？我问是因为我的学生登录表单将用于将数据输入数据库。然后我的学生队列页面将用于 SELECT ... FROM ... 该数据库。所以这让我感到困惑，因为当我为学生队列创建输出时，数据将存储在数据库中。它不会直接发布。

所以反过来我的思路如下：

*   验证数据以确保它是您所期望的
*   像我现在一样使用 xss_clean 过滤数据。
*   使用 PDO 准备查询将数据插入数据库
*   （现在这一步让我感到困惑）我应该如何回显我的数据库数据？我应该在这一步使用 HTML Purifier 吗？

抱歉，如果这个问题已经被问了一百万次，我似乎找不到我要找的东西。我没有完全理解 HTML 净化器的概念。

编辑 1：在配置文件中使用全局 xss_clean 过滤器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T16:05:55.117

HTML Purifier 适用于当您有一个数据类型为 HTML 的字符串并且您想要限制可能出现在其中的 HTML 种类时。

但是，您在此处拥有的所有字段都不是 HTML——它们都只是字符串。因此，要显示它们，您只需转义字符串以在 HTML 中显示，就像对任何字符串一样。

更新版本的 CodeIgniter 有一个`html_escape()`功能。在您的视图中使用它，如下所示：

```
<p><?=html_escape($mystring)?></p> 
```

如果您使用的是旧版本，请`htmlspecialchars($mystring, ENT_NOQUOTES, 'utf-8')`直接使用。您可能应该将其包装在一个单参数函数中。