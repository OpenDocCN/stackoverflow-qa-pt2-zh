# StackOverflow 问答 13998000-13998999

# asp.net - 中继器控制的 URL

> ID：13998001
> 
> 赞同：0
> 
> 时间：2012-12-21T22:28:06.723
> 
> 标签：asp.net, vb.net, repeater

我在转发器控件中有一个链接，我正在链接到另一个启用了分页的转发器控件。该链接在某种程度上有效，只是它链接到的页面比我想要的更大。我知道这是因为我的分页转发器的第一页没有与之关联的页码，即第一页有url default2.aspx，转发器的第二页则为default2.aspx?Page=1 . 我希望这是有道理的。在第一个中继器的链接上，我有以下代码：

```
<asp:HyperLink ID="HyperLink1" runat="server" NavigateUrl='<%# Eval("ID", "default2.aspx?Page={0}")%>'>Review</asp:HyperLink> 
```

如果它正在搜索的内容在此页面上，是否有任何方法可以获取此链接以选择 default2.aspx 页面？或者有没有办法让第一页（default2.aspx）的url为default2.aspx？Page=1？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:26:33.783

尝试这个

```
NavigateUrl='<%# Eval("ID").ToString() == "1" ? "default2.aspx" : String.Format("default2.aspx?Page={0}", Eval("ID"))%>' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T11:50:31.110

通过将以下内容添加到 NavigateUrl 部分，我能够使链接正常工作。

```
NavigateUrl='<%# If(Eval("MReviewID").ToString().Equals("1"), "Default2.aspx", String.Format("Default2.aspx?Page={0}", getInt(Eval("MReviewID"))))%>' 
```

为了让第二页链接转到正确的页面，我必须在后面的 VB 代码中创建以下函数：

```
Function getInt(ByVal MReviewID As String) As Integer
    Dim rID As String
    rID = MReviewID
    Dim ID As Integer
    ID = Convert.ToInt32(rID)
    ID = ID - 1

    Return ID
End Function 
```

# android - Flash Pro 在我的 Android 上生成微小的组件

> ID：13998004
> 
> 赞同：1
> 
> 时间：2012-12-21T22:28:42.557
> 
> 标签：android, flash

我用 Eclipse 构建了应用程序，没有组件大小问题，但是当我使用 Flash 时，组件在我的 Android 设备上显得很小。有什么办法可以扩大组件的大小，或者这是使用闪光灯的缺点吗？

# c - 如何在宏中扩展可变参数？

> ID：13998005
> 
> 赞同：0
> 
> 时间：2012-12-21T22:28:45.520
> 
> 标签：c, gcc, c-preprocessor, c99, variadic-macros

我想基本上有一个宏缩短器。

宏，`FOO(A,B,C)`应扩展为 `defined(_FOO_A) || defined(_FOO_B) || defined(_FOO_C)`.

在 GCC 中使用可变参数宏参数而不是实际编写 3 个函数 ( `FOO(A)`, `FOO(A,B)`, `FOO(A,B,C)`) 是否可行？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:51:48.270

无法将宏扩展为包含`defined`关键字的内容：

> 如果令牌`defined`是作为替换过程的结果生成的，或者`defined`一元运算符的使用与宏替换之前的两种指定形式之一不匹配，则行为未定义。

所以你不能用`defined`. 如果您愿意通过仅测试`FOO_A_`, `FOO_B_`, ... 的值来放松该约束，则可以使用[P99](http://p99.gforge.inria.fr)来做到这一点。例如，只做一个逻辑或变量列表将是

```
#if P99_ORS(A, B, C)
...
#endif 
```

`P99_ORS`表达式扩展为

```
((((A) || (B))) || (C)) 
```

然后对`#if`表达式求值。

如果您想做一些宏编程，也有办法将它首先扩展到您喜欢的令牌列表

```
#define P00_NAME_X(NAME, X, I) P99_PASTE2(NAME, X)
#define CONDITION(NAME, ...) P99_ORS(P99_FOR(FOO_, P99_NARG(__VA_ARGS__), P00_SEQ, P00_NAME_X, __VA_ARGS__)) 
```

这样

```
CONDITION(A, B, C, toto); 
```

会扩大到

```
((((((FOO_A) || (FOO_B))) || (FOO_C))) || (FOO_toto)); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:45:32.360

像这样的东西？

```
#include <stdio.h>

#define FOO(A, B, C) (FOO_X(A) || FOO_X(B) || FOO_X(C))
#define FOO_X(x) defined(_FOO_##x)

// just to print it
#define QUOTE(...) QUOTE_AUX(__VA_ARGS__)
#define QUOTE_AUX(...) #__VA_ARGS__

int main(void)
{
    puts(QUOTE(FOO(a, b, c)));
} 
```

**编辑**：实际上这会导致**未定义的行为**，在所有 C 标准中。

# javascript - Knockout - 将 CSS 类分配给视图模型的输入

> ID：13998006
> 
> 赞同：0
> 
> 时间：2012-12-21T22:28:54.073
> 
> 标签：javascript, jquery, knockout.js

我有一个视图模型，它具有绑定到 html 输入的可观察“yearsOld”。

```
<input type="text" data-bind="value:yearsOld">

    var viewModel = {
      yearsOld: ko.observable("");
    } 
```

有没有办法将 css 类添加到 viewModel 的输入中？我问的原因是因为我需要在绑定到 yearsOld 的输入中添加一个名为“正整数”的 css 类，以便我的第 3 方 jQuery 库将限制该绑定输入字段上的非数字输入。

注意：我知道淘汰赛提供的用于放置在输入字段上的[css 绑定](http://knockoutjs.com/documentation/css-binding.html)，但这对我没有帮助，因为 css 不一定是动态的。我只是希望能够在 viewModel 的输入上放置一个 css 类，而不是直接将它放在每个单独的输入上。即使这对*你*没有意义，我只是好奇它是否可能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:48:02.877

这当然是可能的，您可以通过 css 绑定来实现。我不明白为什么您认为 css 绑定对您不起作用。

这是我的做法：

```
<input data-bind="value: yearsOld, css: { 'positive-integer': positiveIntegersOnly }" />

var viewModel = {
   yearsOld: ko.observable(),
   positiveIntegersOnly: ko.observable(false)
} 
```

要应用“正整数”类：

```
viewModel.positiveIntegersOnly(true); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T05:41:29.037

起初我的回答是否定的，这是不可能的。但经过一番研究，我发现这是完全可能的。

在这里使用这个问题的精彩答案：[knockoutjs overriding bindinghandlers](https://stackoverflow.com/questions/9002163/knockoutjs-overriding-bindinghandlers)您可以覆盖值绑定的行为，并添加所需的必要行为。

```
var originalInit = ko.bindingHandlers.value.init,
    originalUpdate = ko.bindingHandlers.value.update;

ko.bindingHandlers.value= {
    init: originalInit,
    update: function(element, valueAccessor, allBindingsAccessor, viewModel) {
        var $element = $(element);
        var value = ko.utils.unwrapObservable(valueAccessor());
        // only apply to inputs, and if value is a number and is greater than 0
        if ($element.prop("tagName").toLowerCase() == "input" && !isNaN(value) && value > 0) {
            $element.addClass('positive-integer');
        }
        else {
            // otherwise ensure the class is removed
            $element.removeClass('positive-integer');
        }
        // call the original update function
        originalUpdate(element, valueAccessor, allBindingsAccessor, viewModel);
    }
}; 
```

此代码将在常规`value:`绑定代码之前运行，并更新您的元素类（需要 jQuery，但这只是因为我很懒 - 如果需要，应该很容易转换）。

完整的 JS 小提琴可在此处获得：http: [//jsfiddle.net/sp3uF/](http://jsfiddle.net/sp3uF/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T20:20:14.637

您想要下一个场景：用户输入一些非数字并且您的输入改变了样式？

两种方式：jQuery和css绑定：

```
//jQuery
var viewModel = {
    hasNonNumeric: function(){//not implemented},
    yearsOld: ko.observable(),
    yearsOld.subscribe(function(newValue) {
        if (this.hasNonNumeric(newValue)) {
            $('input').addClass("positive-integer");
        }
        else {
            $('input').removeClass("positive-integer");
        }
    });
}​

//knockout
var viewModel = {
        hasNonNumeric: function() { //not implemented},
        yearsOld: ko.observable(),
        scareUser: ko.computed(function() {
            var result = false;
            if (this.hasNonNumeric(this.yearsOld())) {
                result = true;
            }            
            return result;
        });
    }​

<input data-bind="value: yearsOld, css: { 'positive-integer': scareUser}" /> 
```

# c# - 为“随机”的不同实例创建不同的种子

> ID：13998009
> 
> 赞同：12
> 
> 时间：2012-12-21T22:29:18.240
> 
> 标签：c#, .net, random

人们通常会问为什么他们在使用 . 时总是得到相同的数字`Random`。在他们的情况下，他们无意中创建了`Random`每次的新实例（而不是只使用一个实例），这当然会导致始终相同的数字。但就我而言，**我确实需要**几个`Random`返回不同数字流的实例。

在我看来，使用硬编码种子不是一个好主意，因为在重新启动程序后你会一次又一次地获得相同的值。那这个呢：

```
int seed1 = (int)DateTime.Now.Ticks - 13489565;
int seed2 = (int)DateTime.Now.Ticks - 5564; 
```

我知道这看起来很愚蠢和幼稚，但它会在每次重新启动后避免相同的值，并且两个种子应该不同。或者可能

```
Random helper = new Random();
int seed1 = helper.Next(1, int.MaxValue);
int seed2 = helper.Next(1, int.MaxValue); 
```

如您所见，我在这里有点缺乏创造力，需要您的帮助。谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:38:12.827

Jon Skeet 建议使用辅助`Random`对象和锁来创建`Random`对象工厂。例如：

```
 public static Random NewRandom() 
    { 
        lock (globalLock) 
        { 
            return new Random(secondaryRandom.Next()); 
        } 
    } 
```

[查看 Jon Skeet 博客中的完整源代码。](http://msmvps.com/blogs/jon_skeet/archive/2009/11/04/revisiting-randomness.aspx)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T22:34:18.517

我会使用你的第二种方法：

```
int randomCount = 10;
Random seeder = new Random();
var randoms = Enumerable.Range(0, randomCount)
    .Select(i => new Random(seeder.Next()))
    .ToList(); 
```

这使用 linq 创建一个包含 10 个不同种子的 Random 实例的列表。因此，您需要`using System.Linq;`访问`Select`扩展方法。

您还可以重用播种机作为您的实例之一：

```
int randomCount = 10;
Random seeder = new Random();
var randoms = Enumerable.Range(0, randomCount - 1)
    .Select(i => new Random(seeder.Next()))
    .Concat(new [] { seeder })
    .ToList(); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T22:55:33.307

You could use a cryptographic generator to create your seeds e.g.

```
public static Random CreateRandom()
{
    using (var rng = new System.Security.Cryptography.RNGCryptoServiceProvider())
    {
        byte[] bytes = new byte[4];
        rng.GetNonZeroBytes(bytes);
        int seed = BitConverter.ToInt32(bytes, 0);
        return new Random(seed);
    }
} 
```

Of course, if you just need ints then you could use `RNGCryptoServiceProvider` to generate them directly, although `System.Random` is probably faster.

# lucene - Mahout 0.7 是否与 Lucene 4.0.0 兼容？

> ID：13998013
> 
> 赞同：3
> 
> 时间：2012-12-21T22:29:45.740
> 
> 标签：lucene, mahout

我正在尝试直接使用 Mahout 0.7 Java API 从我的 Lucene 4.0.0 中检索向量。指数。但是，在调用该方法时，`org.apache.mahout.utils.vectors.lucene.Driver.dumpVectors()`我得到一个`ClassNotFoundException: org.apache.lucene.index.TermVectorMapper`. 这是真的；该类在 lucene-core-4.0.0.jar 中不存在，但在 lucene-core-3.6.0.jar 中确实存在。

那么我是否正确假设问题是 Mahout 与 Lucene 的 3.6.0 紧密耦合，并且鉴于这些版本，不可能做我在这里尝试的事情？还是我疯了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T08:50:04.017

是的，Mahout 0.7 使用 Lucene 3.6。有[一个补丁](https://issues.apache.org/jira/browse/MAHOUT-1112)支持 Lucene 4.0，但尚未合并到源代码树中。

# c#-4.0 - 在 C# 中使用 C++ dll 文件方法

> ID：13998015
> 
> 赞同：0
> 
> 时间：2012-12-21T22:30:14.180
> 
> 标签：c#-4.0

我有一个在 c++ 中创建的 dll，它使用 .def 文件导出函数。函数编写如下：

```
__declspec(dllexport) int __stdcall MethodA(int par1,int par2,char *par3)
{....} 
```

然后该方法在 .def 文件中声明为

```
MethodA       @1 
```

现在我的问题是如何在我的 C# 应用程序中使用这种方法？我尝试在我的 C# 应用程序中添加 dll 文件作为参考，我收到以下消息

```
"A reference to the filename.dll could not be added please make sure that the file is accessible and that the file is a valid assembly or COM component." 
```

**编辑：** 阅读此处发布的评论后。我正在尝试以下列方式使用该文件

```
 [DllImport("C:\\Filename.dll")]
        public static extern int MethodA(int par1,int par2,String par3); 
```

我正在使用它

```
 MethodA(1,2,"SomeString); 
```

这是我得到的错误

```
An attempt was made to load a program with an incorrect format. (Exception from HRESULT: 0x8007000B) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:35:27.797

虽然您在 C++ 方面做得很好 AFAIK，但您需要在 C# 方面做更多事情，您需要创建一个 C# 方法声明，如下所示：

```
[DllImport ("your_dll_name")]
extern int MethodA (int par1, int par2); 
```

根据需要和需要用 等`static`装饰。`unsafe`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:34:41.327

C# 与 C++ dll 交互的最简单方法是使用 COM Interop。您想在 C++ 中创建一个封装 C++ dll 功能的 COM 组件。然后，您可以从 C# 项目中引用 COM 组件。

# css - 文字阴影或类似效果 子弹？

> ID：13998017
> 
> 赞同：10
> 
> 时间：2012-12-21T22:30:20.357
> 
> 标签：css, glow

正如标题所说，我正在尝试找到一种为子弹添加文本阴影效果的方法。我正在使用 text-shadow 来显示一些文本后面的光晕，我想为子弹完成同样的效果，而不必创建自己的子弹图像。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-21T22:41:03.450

试试这个

```
ul {
  list-style: none;
}

li:before {
  content: '\2022';
  padding: 10px;
  text-shadow: 1px 1px 2px red;
} 
```

[http://jsbin.com/apoviv/2/edit](http://jsbin.com/apoviv/2/edit)

UPD：您真的可以将 unicode charachtest 用于特殊符号，这非常棘手，但有一篇很好的文章可以帮助[http://css-tricks.com/css-content/](http://css-tricks.com/css-content/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T22:42:13.743

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-08T22:01:26.360

Another option would be to to use pure CSS bullets. Something like this:

```
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
            <title>CSS Bullets</title>
        <style type="text/css" media="screen">

            html, body {
            font-size: 16px; 
        }

        article ul li {
            position:relative;
            overflow:hidden;
            list-style:none;
            padding-left:20px;
            line-height: 1.35em;
            margin: 0 0 .5em 0;
        }

        article li:before {
            margin:-8px 0 0;
            background:#ededed;
            overflow:hidden;
            list-style:none;
            content:"";
            position:absolute;
            top:0.95em;
            left:0;
            width:7px;
            height:7px;
            border-radius:2px;
            -webkit-border-radius:2px;
            -moz-border-radius:2px;
            box-shadow: 1px 1px 5px #888888;
        }
        </style>
    </head>
<body>
    <article>
        <ul>
            <li>Bullet 1</li>
            <li>Bullet 2</li>
            <li>Bullet 3</li>
        </ul>
    </article>
</body>
</html> 
```

# asp.net - 如何创建秒表计时器

> ID：13998023
> 
> 赞同：0
> 
> 时间：2012-12-21T22:30:53.743
> 
> 标签：asp.net, timer, stopwatch

我有一个 asp.net 应用程序，它应该像秒表计时器一样工作。我已经尝试过如何让计时器使用秒来计算时间。我使用了一种效率很低的算法。然后我尝试使用日期时间数学来使用时间跨度对象，但由于这基本上是一个时钟，所以它是不可取的。现在我正在尝试实现 System.Diagnostics，以便可以使用 Stopwatch 对象。当我运行我的程序时，应该随时间更新的标签只显示全 0。

这是带有计时器和更新面板的 .aspx 页面中的代码：

```
 <asp:UpdatePanel ID="UpdatePanel1" runat="server">
                    <ContentTemplate>
                        <asp:Timer ID="Timer1" runat="server" Enabled="false" 
                            Interval="1000" OnTick="Timer1_Tick"></asp:Timer>
                        <asp:Label ID="Label1" runat="server"></asp:Label>
                    </ContentTemplate>
                </asp:UpdatePanel> 
```

这是我的开始按钮启动秒表和计时器的事件：

```
 protected void Start_Click(object sender, EventArgs e)
    {
        //Start the timer
        Timer1.Enabled = true;
        stopWatch.Start();
    } 
```

这是 timer1 的事件（currentTime 是一个时间跨度对象）：

```
 protected void Timer1_Tick(object sender, EventArgs e)
    {
        currentTime = stopWatch.Elapsed;
        Label1.Text = String.Format("{0:00}:{1:00}:{2:00}", 
        currentTime.Hours.ToString(), currentTime.Minutes.ToString(), 
        currentTime.Seconds.ToString()); 
```

老实说，我不知道我做错了什么。我认为这将是制作秒表计时器的最简单方法，但标签内没有任何变化。我将不胜感激任何帮助。如有必要，我将提供更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:01:34.297

试试下面的代码。这个对我有用。

在 web 源代码中添加以下代码：

```
<asp:scriptmanager ID="Scriptmanager1" runat="server"></asp:scriptmanager>
<asp:UpdatePanel ID="UpdatePanel1" runat="server">
  <ContentTemplate>
    <asp:Label ID="Label1" runat="server" Font-Size="XX-Large"></asp:Label>
    <asp:Timer ID="tm1" Interval="1000" runat="server" ontick="tm1_Tick" />
  </ContentTemplate>
  <Triggers>
    <asp:AsyncPostBackTrigger ControlID="tm1" EventName="Tick" />
  </Triggers>
</asp:UpdatePanel> 
```

在您的 cs 文件中添加以下源代码：

```
using System.Diagnostics;

public partial class ExamPaper : System.Web.UI.Page
{
    public static Stopwatch sw;

    protected void Page_Load(object sender, EventArgs e)
    {
        if (!IsPostBack)
        {
            sw = new Stopwatch();
            sw.Start();
        }
    }

    protected void tm1_Tick(object sender, EventArgs e)
    {
        long sec = sw.Elapsed.Seconds;
        long min = sw.Elapsed.Minutes;

        if (min < 60)
        {
            if (min < 10)
                Label1.Text = "0" + min;
            else
                Label1.Text = min.ToString();

            Label1.Text += " : ";

            if (sec < 10)
                Label1.Text += "0" + sec;
            else
                Label1.Text += sec.ToString();
        }
        else
        {
            sw.Stop();
            Response.Redirect("Timeout.aspx");
        }
    }
} 
```

# apc - APC.php 文件中没有显示图表

> ID：13998025
> 
> 赞同：1
> 
> 时间：2012-12-21T22:31:04.990
> 
> 标签：apc

我在我的 WordPress 网站上使用 APC 和 W3 Total Cache。今天我不得不升级到更大的 VPS 服务器。主人说一切都很好，一切都像以前一样工作。

但是 APC.php 文件不再显示图表。它仍然显示所有统计数据等......但不显示图表。知道是什么原因造成的吗？

谢谢你。

截图：http: [//i.stack.imgur.com/aA717.png](http://i.stack.imgur.com/aA717.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T09:20:19.403

找到了解决方案。由于迁移，显然需要重新安装GD。安装 GD 并重建 EasyApache 修复了它。

# java - Euler 11\. 一定有比这更好的方法

> ID：13998037
> 
> 赞同：0
> 
> 时间：2012-12-21T22:32:10.620
> 
> 标签：java, matrix

我正在研究 Euler 问题项目，但我对问题 11 的解决方案并不满意。有没有一种方法可以用更少的步骤或更快速地遍历矩阵？或者一般来说，有没有更好的方法来解决它？

numbers.txt 是问题 11 中给出的数字矩阵。

[http://projecteuler.net/problem=11](http://projecteuler.net/problem=11)

```
import java.io.File;
import java.io.FileNotFoundException;
import java.util.Scanner;

public class Project {

    public static void main(String[] args){
        int [][] matrix = new int [20][20];
        populateMatrix(matrix, "numbers.txt");
        System.out.println( greatestProduct(matrix) );
    }
    public static long greatestProduct(int [][] matrix){
        final int NUMBER = 4; 
        final int LIMIT = matrix.length - NUMBER;
        long max = 0;

        for(int i= 0; i < matrix.length; i++){
            for(int j= 0; j <= LIMIT; j++){
                long diagTrack = 1, diagTrack2 = 1, horTrack = 1, horTrack2 = 1;
                int y = j;
                int x = i;
                int r = matrix.length-i-1;
                for(int index =0; index<NUMBER; index++){
                    if(i <= LIMIT){
                        diagTrack *= matrix[x][y];
                        diagTrack2*= matrix[r][y];
                        x++;
                        r--;
                    }
                    horTrack *= matrix[i][y];
                    horTrack2*= matrix[y][i];
                    y++;
                }
                if(max < diagTrack) max = diagTrack;
                if(max < diagTrack2) max = diagTrack2;
                if(max < horTrack) max= horTrack;
                if(max < horTrack2) max = horTrack2;
            }
        }
        return max;     
    }

    public static void populateMatrix(int [][] matrix, String fileName){
        File file = new File(fileName);

        try {

            Scanner scanner = new Scanner(file);

            for(int i= 0; scanner.hasNextLine(); i++) {
                String line[] = ( (String) scanner.nextLine() ).split(" ");
                for(int j= 0; j < line.length; j++)
                    matrix[i][j]= Integer.parseInt(line[j].trim() );
            }
            scanner.close();
        } catch (FileNotFoundException e) {
            e.printStackTrace();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-23T18:48:00.430

我能想到的一个技巧是使用事实，如果你有 a,b,c,d,e,f 你可以通过

```
val1 = a*b*c*d
val2 = val1*e/a
val3 = val2*f/b 
```

但由于除法非常昂贵，我认为这甚至比 2 次乘法还要糟糕。可能还有其他一些超级技巧会使代码变得更加复杂。例如。

```
If a>e than a*b*c*d > b*c*d*e 
```

但这只是复杂性过大。让我们假设由于某种原因乘法非常慢。这将不是通过记忆和表达来实现的。

```
a*b*c*d =  multiply(a,b)*multiply(c,d) 
```

最后，我认为实际上乘法与存储一样快，然后再从中读取（如果不是更快），这意味着您的方法与其他任何方法一样好，但最重要的是它可以轻松实现这种幼稚的解决方案.

# c# - 将联接和分组依据从 SQL 转换为 LINQ

> ID：13998040
> 
> 赞同：1
> 
> 时间：2012-12-21T22:32:29.890
> 
> 标签：c#, asp.net, .net, sql, linq

我是 LINQ 新手，需要帮助转换此 SQL 代码：到 LINQ

```
 SELECT UserId_FK,COUNT(OrderId),SUM(Quantity)
    FROM Orders o
    JOIN OrderDetails od
    ON(o.OrderId = od.OrderId_FK)
    GROUP BY UserId_FK; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:47:25.367

在没有看到您的架构文件的情况下，我将在这里猜测一下：

```
var userDetail =
    context.Orders
        .GroupBy(i => i.UserId_Fk)
        .Select(i => new {
                         UserId_Fk = i.Key,
                         OrderCount = i.Count(),
                         ProductQuantity = i.Sum(j => context.OrderDetails.Where(k=> k.OrderId_Fk == j.OrderId).Sum(k=> k.Quantity))
                      }); 
```

# android - 使用多个活动关闭应用程序中的 SQLite 数据库

> ID：13998043
> 
> 赞同：0
> 
> 时间：2012-12-21T22:32:42.777
> 
> 标签：android, sqlite, destroy

我有使用 SQLite 数据库（PlaceDbProvider）的课程。它是单调的。问题是我有三个使用 PlaceDbProvider 的活动。什么时候为 PlaceDbProvider 调用 destroy 方法更好？我很困惑，因为每个活动都有自己的 onDestroy 方法。

```
public class PlaceDbProvider {
private static final String DB_NAME = "com.placesmanager";
private static final String TABLE_NAME = "places";
private static final int DB_VESION = 1;
private static final String KEY_ID = "_id";
private static final int ID_COLUMN = 0;
private static final String KEY_NAME = "name";
private static final int NAME_COLUMN = 1;

private Context context;
private Cursor cursor;
private SQLiteDatabase database;
private DbOpenHelper dbOpenHelper;

private static PlaceDbProvider mInstance = null;

private PlaceDbProvider(Context context) {
    this.context = context;
    init();
}

public static PlaceDbProvider getInstance(Context context) {
    if(mInstance == null) {
        mInstance = new PlaceDbProvider(context);
    }
    return mInstance;
}

public int getCount() {
    return cursor.getCount();
}

public Place getItem(int position) {
    if (cursor.moveToPosition(position)) {
        Place placeOnPositon = new Place();     
        placeOnPositon.setId(cursor.getLong(ID_COLUMN));
        placeOnPositon.setName(cursor.getString(NAME_COLUMN));
        return placeOnPositon;
    } else {
        throw new CursorIndexOutOfBoundsException(
                "Cant move cursor to postion");
    }
}

public long getItemId(int position) {
    if (cursor.moveToPosition(position)) {  
        return cursor.getLong(ID_COLUMN);
    } else {
        throw new CursorIndexOutOfBoundsException(
                "Cant move cursor to postion");
    }
}
public long addItem(Place place) {
    ContentValues values = new ContentValues();
    values.put(KEY_NAME, place.getName());
    long id = database.insert(TABLE_NAME, null, values);
    refresh();
    return id;
}
public boolean removeItem(Place placeToRemove) {
    boolean isDeleted = (database.delete(TABLE_NAME, KEY_NAME + "=?",
            new String[] { placeToRemove.getName() })) > 0;
    refresh();
    return isDeleted;
}

public boolean updateItem(long id, String key,String newValue) {
    ContentValues values = new ContentValues();
    values.put(key, newValue);
    boolean isUpdated = (database.update(TABLE_NAME, values, KEY_ID + "=?",
            new String[] {id+""})) > 0;
    return isUpdated;
}

public void destroy() {
    dbOpenHelper.close();
    mInstance = null;
}

private void refresh() {
    cursor = getAllEntries();
}

public Cursor getAllEntries() {

    String[] columnsToTake = { KEY_ID, KEY_NAME, KEY_LAT, KEY_LNG, KEY_TYPE, KEY_INFO, KEY_OWNER};

    return database.query(TABLE_NAME, columnsToTake,
            null, null, null, null, KEY_ID);
}

private void init() {
    dbOpenHelper = new DbOpenHelper(context, DB_NAME, null, DB_VESION);
    try {
        database = dbOpenHelper.getWritableDatabase();
    } catch (SQLException e) {
        Log.e(this.toString(), "Error while getting database");
        throw new Error("The end");
    }
    cursor = getAllEntries();
}

//class for creation, opening and db version control
private static class DbOpenHelper extends SQLiteOpenHelper {

    public DbOpenHelper(Context context, String name,
            CursorFactory factory, int version) {
        super(context, name, factory, version);
    }  

    @Override
    public void onCreate(SQLiteDatabase db) {
        final String CREATE_DB = "CREATE TABLE " + TABLE_NAME + " ("
                + KEY_ID + " INTEGER PRIMARY KEY AUTOINCREMENT, "
                + KEY_NAME + " TEXT NOT NULL);";
        db.execSQL(CREATE_DB);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS " + TABLE_NAME);
        onCreate(db);
    }
} 
```

}

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:54:34.323

单例模式不推荐用于 Android，因为根据 Android 的应用程序生命周期，持有单例对象的活动或服务可能会被销毁。我建议您扩展应用程序的应用程序对象并部署对数据库的静态引用。

另一方面，尝试使用 ContentProvider 进行数据库处理。起初，对于简单的任务来说听起来工作量太大，但是 ContentProvider-ContentResolver 组合在使用 CursorAdapters 和 Loaders 显示 SQLite 数据时提供了很大的帮助。如果使用此方法，则不需要数据库初始化或关闭。

希望能帮助到你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:46:54.907

1) 使用应用程序上下文实例化 PlaceDbProvider (context.getApplicationContext() )

2）创建您的应用程序类

3）在您的应用程序类中，在 onTerminate() 方法中，调用 (PlaceDbProvider) onDestroy() 方法

（有关创建应用程序类的信息，请参阅我在此链接上的其他答案：[https](https://stackoverflow.com/a/13994622/1789730) ://stackoverflow.com/a/13994622/1789730 ）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T22:56:28.117

最好像这样实现方法打开和关闭：

```
public DbAdapter open() throws SQLException
{
    dbHelper = new DbHelper(mCtx);
    db = dbOpenHelper.getWritableDatabase();
    return this;
}

public void close()
{
    dbHelper.close();
} 
```

注意： DbAdapter 它是您使用数据库的类。你应该在你想从数据库中读取/插入/更新数据之前打开你的数据库，然后立即关闭，这在 onDestroy() 中是不必要的。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T23:18:02.463

只要您正确实现它，我看不出使用单例模式有什么特别的问题。确实，使用单例的 Activity 或服务可能会被销毁，但是如果您可以重新创建单例，这并不重要。只要您记得保持线程安全，就可以将数据库引用作为单例。如果引用被破坏，只需重新打开数据库。

无论您身在何处都可以关闭它，您可以从任何您想要的地方调用 Database.close()，然后在调用 SQLiteDatabase.close() 之前签入单例以查看数据库是否已关闭。您可能会决定在每次完成数据库时都关闭它，即使您的应用程序仍处于打开状态。

我同意您等待打开数据库，直到您准备好读/写。

请注意，如果在调用 SQLiteDatabase.close() 之前调用 SQLiteDatabase.isOpen()，则尝试关闭它的位置无关紧要。

# qt-creator - Qt Creator 不会从外部生成的 .creator.user 文件加载设置

> ID：13998046
> 
> 赞同：2
> 
> 时间：2012-12-21T22:33:03.977
> 
> 标签：qt-creator

我正在尝试`.creator.user`为许多通用 Qt Creator 项目生成文件。我正在使用自定义构建工具，并希望每个 Qt Creator 项目都使用自定义构建命令来调用此工具，这就是我弄乱`.creator.user`文件的原因。不幸的是，`.creator.user`我生成的文件`.creator.user.1.3`被 Qt Creator 重命名和忽略，然后生成`.creator.user`不使用我的设置的默认文件。有关如何使 Qt Creator 正确加载我的设置的任何建议？

编辑：这是一个示例`.creator.user`文件。我已将工作目录名称更改为`@DIRECTORY@`；在实际文件中，这是一个实际目录。

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE QtCreatorProject>
<!-- Written by SwT 0.8.0, 12/21/2012 15:17:33\. -->
<qtcreator>
 <data>
  <variable>ProjectExplorer.Project.Target.0</variable>
  <valuemap type="QVariantMap">
   <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">SwT</value>
   <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName">SwT</value>
   <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">{86eb24f3-777f-41df-b796-d5d8d9a9739a}</value>
   <value type="int" key="ProjectExplorer.Target.ActiveBuildConfiguration">0</value>
   <value type="int" key="ProjectExplorer.Target.ActiveDeployConfiguration">0</value>
   <value type="int" key="ProjectExplorer.Target.ActiveRunConfiguration">0</value>
   <valuemap type="QVariantMap" key="ProjectExplorer.Target.BuildConfiguration.0">
    <value type="QString" key="GenericProjectManager.GenericBuildConfiguration.BuildDirectory"></value>
    <valuemap type="QVariantMap" key=with open(creatorf,'w') as f:
                    f.write('[General'"ProjectExplorer.BuildConfiguration.BuildStepList.0">
     <valuemap type="QVariantMap" key="ProjectExplorer.BuildStepList.Step.0">
      <value type="bool" key="ProjectExplorer.BuildStep.Enabled">true</value>
      <value type="QString" key="ProjectExplorer.ProcessStep.Arguments">build -j3</value>
      <value type="QString" key="ProjectExplorer.ProcessStep.Command">swt</value>
      <value type="QString" key="ProjectExplorer.ProcessStep.WorkingDirectory">@DIRECTORY@</value>
      <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Custom Process Step</value>
      <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
      <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.ProcessStep</value>
     </valuemap>
     <value type="int" key="ProjectExplorer.BuildStepList.StepsCount">1</value>
     <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Build</value>
     <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
     <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.BuildSteps.Build</value>
    </valuemap>
    <valuemap type="QVariantMap" key="ProjectExplorer.BuildConfiguration.BuildStepList.1">
     <valuemap type="QVariantMap" key="ProjectExplorer.BuildStepList.Step.0">
      <value type="bool" key="ProjectExplorer.BuildStep.Enabled">true</value>
      <value type="QString" key="ProjectExplorer.ProcessStep.Arguments">clean</value>
      <value type="QString" key="ProjectExplorer.ProcessStep.Command">swt</value>
      <value type="QString" key="ProjectExplorer.ProcessStep.WorkingDirectory">@DIRECTORY@</value>
      <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Custom Process Step</value>
      <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
      <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.ProcessStep</value>
     </valuemap>
     <value type="int" key="ProjectExplorer.BuildStepList.StepsCount">1</value>
     <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Clean</value>
     <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
     <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.BuildSteps.Clean</value>
    </valuemap>
    <value type="int" key="ProjectExplorer.BuildConfiguration.BuildStepListCount">2</value>
    <value type="bool" key="ProjectExplorer.BuildConfiguration.ClearSystemEnvironment">false</value>
    <valuelist type="QVariantList" key="ProjectExplorer.BuildConfiguration.UserEnvironmentChanges"/>
    <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName"></value>
    <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName">Debug</value>
    <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">GenericProjectManager.GenericBuildConfiguration</value>
   </valuemap>
   <value type="int" key="ProjectExplorer.Target.BuildConfigurationCount">1</value>
   <valuemap type="QVariantMap" key="ProjectExplorer.Target.DeployConfiguration.0">
    <valuemap type="QVariantMap" key="ProjectExplorer.BuildConfiguration.BuildStepList.0">
     <value type="int" key="ProjectExplorer.BuildStepList.StepsCount">0</value>
     <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Deploy</value>
     <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
     <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.BuildSteps.Deploy</value>
    </valuemap>
    <value type="int" key="ProjectExplorer.BuildConfiguration.BuildStepListCount">1</value>
    <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Deploy locally</value>
    <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
    <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.DefaultDeployConfiguration</value>
   </valuemap>
   <value type="int" key="ProjectExplorer.Target.DeployConfigurationCount">1</value>
   <valuemap type="QVariantMap" key="ProjectExplorer.Target.RunConfiguration.0">
    <value type="bool" key="Analyzer.Project.UseGlobal">true</value>
    <valuelist type="QVariantList" key="Analyzer.Valgrind.AddedSuppressionFiles"/>
    <value type="bool" key="Analyzer.Valgrind.Callgrind.CollectBusEvents">false</value>
    <value type="bool" key="Analyzer.Valgrind.Callgrind.CollectSystime">false</value>
    <value type="bool" key="Analyzer.Valgrind.Callgrind.EnableBranchSim">false</value>
    <value type="bool" key="Analyzer.Valgrind.Callgrind.EnableCacheSim">false</value>
    <value type="bool" key="Analyzer.Valgrind.Callgrind.EnableEventToolTips">true</value>
    <value type="double" key="Analyzer.Valgrind.Callgrind.MinimumCostRatio">0.01</value>
    <value type="double" key="Analyzer.Valgrind.Callgrind.VisualisationMinimumCostRatio">10</value>
    <value type="bool" key="Analyzer.Valgrind.FilterExternalIssues">true</value>
    <value type="int" key="Analyzer.Valgrind.NumCallers">25</value>
    <valuelist type="QVariantList" key="Analyzer.Valgrind.RemovedSuppressionFiles"/>
    <value type="bool" key="Analyzer.Valgrind.TrackOrigins">true</value>
    <value type="QString" key="Analyzer.Valgrind.ValgrindExecutable">valgrind</value>
    <valuelist type="QVariantList" key="Analyzer.Valgrind.VisibleErrorKinds">
     <value type="int">0</value>
     <value type="int">1</value>
     <value type="int">2</value>
     <value type="int">3</value>
     <value type="int">4</value>
     <value type="int">5</value>
     <value type="int">6</value>
     <value type="int">7</value>
     <value type="int">8</value>
     <value type="int">9</value>
     <value type="int">10</value>
     <value type="int">11</value>
     <value type="int">12</value>
     <value type="int">13</value>
     <value type="int">14</value>
    </valuelist>
    <value type="QString" key="ProjectExplorer.CustomExecutableRunConfiguration.Arguments"></value>
    <value type="int" key="ProjectExplorer.CustomExecutableRunConfiguration.BaseEnvironmentBase">2</value>
    <value type="QString" key="ProjectExplorer.CustomExecutableRunConfiguration.Executable"></value>
    <value type="bool" key="ProjectExplorer.CustomExecutableRunConfiguration.UseTerminal">false</value>
    <valuelist type="QVariantList" key="ProjectExplorer.CustomExecutableRunConfiguration.UserEnvironmentChanges"/>
    <value type="QString" key="ProjectExplorer.CustomExecutableRunConfiguration.WorkingDirectory">%{buildDir}</value>
    <value type="QString" key="ProjectExplorer.ProjectConfiguration.DefaultDisplayName">Custom Executable</value>
    <value type="QString" key="ProjectExplorer.ProjectConfiguration.DisplayName"></value>
    <value type="QByteArray" key="ProjectExplorer.ProjectConfiguration.Id">ProjectExplorer.CustomExecutableRunConfiguration</value>
    <value type="uint" key="RunConfiguration.QmlDebugServerPort">3768</value>
    <value type="bool" key="RunConfiguration.UseCppDebugger">true</value>
    <value type="bool" key="RunConfiguration.UseMultiProcess">false</value>
    <value type="bool" key="RunConfiguration.UseQmlDebugger">false</value>
    <value type="bool" key="RunConfiguration.UseQmlDebuggerAuto">true</value>
   </valuemap>
   <value type="int" key="ProjectExplorer.Target.RunConfigurationCount">1</value>
  </valuemap>
 </data>
 <data>
  <variable>ProjectExplorer.Project.TargetCount</variable>
  <value type="int">1</value>
 </data>
 <data>
  <variable>ProjectExplorer.Project.Updater.EnvironmentId</variable>
  <value type="QString">{250c1e28-1243-4796-af2e-509ff8b0cce9}</value>
 </data>
 <data>
  <variable>ProjectExplorer.Project.Updater.FileVersion</variable>
  <value type="int">12</value>
 </data>
</qtcreator> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T10:13:38.800

Creator generates .user.version files when it finds the .user file to be in need of upgrading. The reasoning is this: If you run an version of Creator and have your project configured for that and you want to e.g. test a new beta release, then that will most likely require changes to the configuration. So it copies your current settings to .user.version and then updates whatever is in .user.

So you seem to be generating an old version of the .user file. While creator tries to keep everything intact, upgrades can go wrong, especially when going through several steps in the conversion process (going from 1.3 to 2.0, to 2.1, ...).

I recommend using a newer template for your .user-file creator and starting with that. If you set up targets/kits/build steps, etc. creator will also throw them out and regenerate them if it thinks they are broken, so make sure they are indeed valid.

You might also consider to move some settings into .shared files. These get recombined with the .user file (the .user has precedence) and can be used to initialize settings when the project is opened for the first time. Since creator uses instance-specific ids for Qt versions, etc. that does not work too well to set up targets yet, but with 2.6 and the kits you can get pretty far there, too, if you make sure every user has kits with the same Ids (e.g. by using those from the Qt 5 version).

*PS: Make sure to add ProjectExplorer.Project.Updater.FileVersion variable which defines the schema version used in the file.*

# c++ - 用于基于任务的并行性的通用 c++11 函数包装器

> ID：13998059
> 
> 赞同：5
> 
> 时间：2012-12-21T22:34:39.513
> 
> 标签：c++, c++11

我正在实现一个工作窃取算法，并且正在编写一个通用函数包装器，它将一个承诺作为包装器模板的可变参数之一。我想用这些函数包装器创建任务，并让每个节点使用 Promise 与依赖节点通信。每个节点维护一个依赖节点和承诺/期货的列表。每个节点都可以通过检查是否已设置所有期货来运行。Promise 可以根据函数包装器正在执行的返回不同对象的工作而有所不同。如果可以将单个算法分解为单独的操作，例如读取消息和解码消息，对对象执行检查，返回所有检查的结果，则每个操作都将返回不同的 Promise（对象、布尔值、结果）。

这本书，*C++ Concurrency in Action*，有一个函数包装器实现，但是它不处理这个用例。在其他在线参考资料中，我看到了对诸如 std::promise 之类的承诺的硬编码参考，这只是一种类型。

有人可以建议我如何编写一个包装器来实现以下目标......

```
void add(int a, int b, std::promise<int>&& prms)
{
   int res = a + b;
   try {
      prms.set_value(res);
   }
   catch(...)
   {
      prms.set_exception(std::current_exception());
   }
}

int main()
{
   std::promise<int> prms;
   std::future<int> fut = prms.get_future();
   FunctionWrapper myFunctor(a, 10, 20, std::move(prms));

   // add the functor to the queue and it will be retrieved by a thread
   // that executes the task. since i have the future, i can pass it to the 
   // dependent worknode
} 
```

我尝试编写如下代码......但在让它工作时遇到了困难。

```
#ifndef FUNCTIONWRAPPER_HPP
#define FUNCTIONWRAPPER_HPP

template<typename F, typename R, typename... Args>
class FunctionWrapper
{
  class implbase
  {
  public:
    virtual ~implbase();
    virtual R execute(Args...)=0;
  };

  class impl : public implbase
  {
  public:
    impl(F&& f) : func(std::move(f)) {}
    virtual R execute(Args... args) { return func(args...); }

  private:
    F func;
  };

  std::shared_ptr<impl> internalFunc;

public:
  FunctionWrapper(F&& f) : internalFunc(0)
  {
    internalFunc = new impl<F, R, Args...>(f);
  }

  FunctionWrapper(const FunctionWrapper& other)
    : internalFunc(std::move(other.internalFunc))
  {}

  ~FunctionWrapper()
  {
    if(internalFunc)
      delete internalFunc;
  }

  R operator()(Args... args)
  {
    return internalFunc->execute(args...);
  }

  void swap(FunctionWrapper& other)
  {
    impl<R, Args...>* tmp = internalFunc;
    internalFunc = other.internalFunc;
    other.internalFunc = tmp;
  }

  FunctionWrapper& operator=(const FunctionWrapper& other)
  {
    FunctionWrapper(other).swap(*this);
    return *this;
  }

  FunctionWrapper& operator=(const F& f)
  {
    FunctionWrapper(f).swap(*this);
    return *this;
  }
};

#endif // FUNCTIONWRAPPER_HPP 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T06:12:04.183

C++11 有一个包装器可以做到这一点！它被称为[`packaged_task`](http://en.cppreference.com/w/cpp/thread/packaged_task)。

它的作用是包装一个可调用对象（函数对象、lambda、函数指针、绑定表达式等），并通过`get_future()`与传入函数的返回类型相匹配的方法为您提供未来。

考虑以下示例：

```
#include <thread>
#include <future>
#include <functional>
#include <iostream>

using namespace std;

int add(int a, int b)
{
    return a + b;
}

int main()
{
    // Create a std::packaged_task and grab the future out of it.
    packaged_task<int()> myTask(bind(add, 10, 20));
    future<int> myFuture = myTask.get_future();

    // Here, is where you would queue up the task in your example.
    // I'll launch it on another thread just to demonstrate how.
    thread myThread(std::move(myTask));
    myThread.detach();

    // myFuture.get() will block until the task completes.
    // ...or throw if the task throws an exception.
    cout << "The result is: " << myFuture.get() << endl;
    return 0;
} 
```

正如你所看到的，我们没有传递 a `promise`，而是依靠`packaged_task`来创造承诺并给我们未来。

此外，使用绑定表达式允许我们有效地将参数传递给任务以保持直到它被调用。

使用`packaged_task`也将通过未来推动异常的负担交到`packaged_task`. 这样，您的函数就不需要调用`set_exception()`. 他们只需要返回或抛出。

# lucene - 语言语料库搜索引擎

> ID：13998063
> 
> 赞同：4
> 
> 时间：2012-12-21T22:35:11.313
> 
> 标签：lucene, nlp, search-engine, sphinx, information-retrieval

我正在尝试找到一个好的库来构建语言语料库搜索引擎。这样的引擎必须产生绝对透明的搜索结果（找到的匹配的确切数量，即使整个语料库都匹配也不会切割结果），基本的查询语法（AND，OR，NOT 运算符，距离搜索，通配符搜索）和精炼搜索的能力设置为搜索的文档（即设置一个 subcirous）。一个重要的细节是索引分区和并行执行搜索的能力（语料的大小有10^8个单词的量级，并且搜索服务必须是实时的）。

主要的选择是在 Sphinx 和 Clucene（一个 C++ Lucene 端口）之间。不幸的是，我对这些图书馆的组织了解不多，所以知道哪一个更符合我的要求会很有帮助。

（我还尝试了一个专门的引擎 - IMS Corpus Workbench - 结果证明它的可扩展性不如需要）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-11T20:57:47.377

我建议设置 SOLR 服务器，它是 Lucene 的衍生产品，具有 Restful 接口。Lucene(SOLR) 的新功能在其他同类产品中是无可比拟的。10 ^ 8 个不同单词的语料库，也许是一个问题，但我希望它们是不明确的。最多，在我的猜测中，它可能会导致一些性能损失。在裸露的 Lucene 上并行提供分区和搜索将是一项退化的工作。SOLR 提供了这两种功能。我不太了解狮身人面像。但到目前为止，Lucene 及其衍生产品处于最前沿。

# python - Pip 安装不正确

> ID：13998068
> 
> 赞同：2
> 
> 时间：2012-12-21T22:35:50.703
> 
> 标签：python, pip

我在 Mac 上运行并使用 Enthought python 我已经安装了 PIP，但在安装软件包时遇到了困难。

当我尝试安装 Pygame 时，软件包正在下载并开始构建，但随后出现错误。我意识到 Pygame 是一个相对复杂的包，但我对更简单的包也有类似的问题。因为我认为这可能与我安装的 Python 有关，所以我在最后显示了我的环境变量。任何帮助，将不胜感激

跟踪看起来像：

```
running build_ext

building 'pygame._numericsurfarray' extension

creating build/temp.macosx-10.5-i386-2.7

creating build/temp.macosx-10.5-i386-2.7/src

gcc -fno-strict-aliasing -fno-common -dynamic -arch i386 -DNDEBUG -g -O3 -arch i386 -I/NEED_INC_PATH_FIX -I/Library/Frameworks/Python.framework/Versions/7.3/include/python2.7 -c src/_numericsurfarray.c -o build/temp.macosx-10.5-i386-2.7/src/_numericsurfarray.o

In file included from src/_numericsurfarray.c:23:

src/pygame.h:106:17: error: SDL.h: No such file or directory

In file included from src/_numericsurfarray.c:23:

src/pygame.h:350: error: expected specifier-qualifier-list before ‘SDL_VideoInfo’

src/pygame.h:388: error: expected specifier-qualifier-list before ‘SDL_Surface’

src/_numericsurfarray.c:26:27: error: SDL_byteorder.h: No such file or directory
....
....
...
....
src/_numericsurfarray.c:1097: error: expected declaration specifiers or ‘...’ before ‘SDL_Surface’

error: command 'gcc' failed with exit status 1 
```

* * *

```
Command /Library/Frameworks/Python.framework/Versions/7.3/Resources/Python.app/Contents/MacOS/Python -c "import setuptools;__file__='/var/folders/9m/qcp8h8ss4ng1v8429jvnkkrc0000gn/T/pip-build/pygame/setup.py';exec(compile(open(__file__).read().replace('\r\n', '\n'), __file__, 'exec'))" install --record /var/folders/9m/qcp8h8ss4ng1v8429jvnkkrc0000gn/T/pip-roxs9O-record/install-record.txt --single-version-externally-managed failed with error code 1 in /var/folders/9m/qcp8h8ss4ng1v8429jvnkkrc0000gn/T/pip-build/pygame
Storing complete log in /Users/jc_macpro/.pip/pip.log 
```

我的环境变量是：

```
TERM_PROGRAM=Apple_Terminal
TERM=xterm-256color
SHELL=/bin/bash
TMPDIR=/var/folders/9m/qcp8h8ss4ng1v8429jvnkkrc0000gn/T/
Apple_PubSub_Socket_Render=/tmp/launch-iwuiuZ/Render
TERM_PROGRAM_VERSION=309
TERM_SESSION_ID=FDC661E1-1196-448F-8D69-28AD9D7C496B
USER=jc_macpro
COMMAND_MODE=unix2003
SSH_AUTH_SOCK=/tmp/launch-pH83z9/Listeners
__CF_USER_TEXT_ENCODING=0x1F5:0:0
Apple_Ubiquity_Message=/tmp/launch-s4tuBY/Apple_Ubiquity_Message
PATH=/Library/Frameworks/Python.framework/Versions/Current/bin:/Library/Frameworks/Python.framework/Versions/Current/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/local/bin
PWD=/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages
LANG=en_US.UTF-8
SHLVL=1
HOME=/Users/jc_macpro
LOGNAME=jc_macpro
SECURITYSESSIONID=186a4
_=/usr/bin/env
OLDPWD=/Library/Frameworks/Python.framework/Versions/Current/bin 
```

我将不胜感激任何帮助。

更新：12/22/12 我已经筛选了所有的建议和反馈，非常感谢。在 Enthought 上安装二进制文件的所有努力都没有奏效。我不想在 Macports 上增加更多的复杂性，所以我决定淘汰我的 Enthought python 并简单地使用官方的 Python 2.7。我是 Enthought 的忠实粉丝，当我开始使用 Python 时，它是提供稳定工作基础的好方法。然而，正如所指出的，它有一些局限性。

使用 Python 2.7 作为我的默认设置，我重新安装了 pip，添加了基本功能，然后能够安装 pygame、numpy、matplotlib 和 wxPython 所需的二进制文件。所以现在我开始工作了，但又一次危险了——就在官方的 Python 2.7 上！！谢谢你们。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:38:47.257

您缺少依赖项 SDL。

如果您安装了 macports，请使用它来安装`libsdl`.

或者更好的是，下载[Mac 的 Pygame 二进制文件](http://www.pygame.org/download.shtml)；它在安装程序中包含 SDL 库。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-21T22:49:16.273

问题是您需要 SDL 来安装 PyGame。您可能还想安装各种 SDL 附加包（用于字体的 SDL_ttf 等）。

正如 Martijn Pieters 所建议的，Pygame 带有一个适用于 Mac 的二进制安装程序。我不知道它是否适用于 Enthought Python，但我会先尝试一下。

如果失败，SDL 也有一个适用于 Mac的[二进制安装程序。](http://www.libsdl.org/download-1.2.php)再说一次，我不知道它是否对你有用，但我会尝试下一次。

如果失败，我会使用[Homebrew](http://mxcl.github.com/homebrew/)。Homebrew（与 MacPorts 和 Fink 不同）旨在与您想要使用的任何 Python 安装以及该 Python 的`pip`. （有关详细信息，请参阅[此处](https://github.com/mxcl/homebrew/wiki/Homebrew-and-Python)和[此处](https://github.com/mxcl/homebrew/wiki/Gems,-Eggs-and-Perl-Modules)。）因此，键入`brew search sdl`以获取所有附加软件包的列表，然后`brew install sdl sdl_foo sdl_bar etc.`安装它们。

对于您的其他问题，由于“/Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages/”中的权限错误，您无能为力，这很简单：您不这样`pip install` *做*t 有权写入该目录。有两种方法可以修复它：

1.  使用`sudo pip install foo`而不是`pip install foo`.
2.  用来`sudo chmod -R a+w /Library/Frameworks/Python.framework/Versions/7.3/lib/python2.7/site-packages/`给自己写权限，这样你就可以`pip install foo`. （您可能需要添加一些其他目录。）

第二个非常符合 Homebrew 的精神（请参阅上面的两个链接，其中详细介绍了如何以及为什么要这样做），它与 python.org 软件包配合得很好，因为许多人经常以这种方式使用它，但我不能保证 Enthought 包是个好主意，但我*可以*保证第一个。

# php - 是否有 Eclipse 模块可以在 PDT 中放置分号？

> ID：13998073
> 
> 赞同：2
> 
> 时间：2012-12-21T22:36:05.460
> 
> 标签：php, eclipse

eclipse 的 java 编辑器选项包括一个选项，如果您在行中的任何位置键入分号，它会自动在语句末尾放置一个分号。

Eclipse PDT 似乎没有类似的 PHP 选项。是否有人知道添加此功能的模块（或任何其他方式以避免手动将光标移出嵌套的括号集以添加语句终止符？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T11:27:07.337

目前 PDT 不支持此类功能。

对于 Java，您可以在**Window -> Preferences -> Java -> Editor -> Typing**下找到它，并在此处**自动插入正确的位置：分号**。
但是**PHP -> Editor -> Typing**下**没有这样的选项**。

 **据我所知，有人曾想过实现此功能，但是 PDT 团队近年来确实在苦苦挣扎（您很可能在 Eclipse Helios PDT 上工作，它基于 2010 年的 Helios Eclipse 版本，而当前版本的 Eclipse 是 2012 年中期的 Juno，Eclipse 团队正在努力进入 Kepler 版本）所以我不会指望在任何可预见的将来实现这个特性。

据我所知 - PHP 中也没有额外的插件来支持此类功能。**

# javascript - 验证 iOS 仪器中的复选标记

> ID：13998074
> 
> 赞同：1
> 
> 时间：2012-12-21T22:36:12.670
> 
> 标签：javascript, ios, automation, instruments

在通过应用程序的 iOS 自动化选择后，我正在尝试验证单元格旁边是否有**复选标记。**

有人可以帮我弄这个吗？

例如：

```
UIATarget.localTarget().frontMostApp().mainWindow().tableViews()[\"Empty list\"].cells()[\"Page Curl\"].______ 
```

应用程序开发人员告诉我他正在使用辅助功能类型，但我不确定这些命令是否适用。

# bash - 使用 env 在 bash 中为一个程序调用设置环境变量

> ID：13998075
> 
> 赞同：43
> 
> 时间：2012-12-21T22:36:13.100
> 
> 标签：bash, unix, environment-variables, environment

我正在尝试通过命令调用具有修改环境的 shell 命令`env`。

根据说明书

```
env HELLO='Hello World' echo $HELLO 
```

应该 echo `Hello World`，但事实并非如此。如果我做

```
HELLO='Hello World' bash -c 'echo $HELLO' 
```

它按预期打印`Hello World`（感谢[this answer](https://stackoverflow.com/a/10856348/1922650) for this info）。

我在这里想念什么？

干杯，尼克拉斯

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-12-21T22:45:14.223

这是因为在您的第一种情况下，您当前的 shell`$HELLO`在运行命令之前扩展了变量。`HELLO`并且您当前的 shell 中没有设置变量。

```
env HELLO='Hello World' echo $HELLO 
```

会这样做：

*   展开任何给定的变量，在这种情况下`$HELLO`
*   使用 3 个参数运行 env 和（一个空字符串`'HELLO=Hello World'`，因为当前 shell 中没有设置变量）`'echo'``''``HELLO`
*   该`env`命令将运行并`HELLO='Hello World'`在其环境中设置
*   `env`将`echo`使用参数`''`（空字符串）运行

如您所见，当前 shell 扩展了`$HELLO`未设置的变量。

```
HELLO='Hello World' bash -c 'echo $HELLO' 
```

会这样做：

*   `HELLO='Hello World`为以下命令设置变量
*   使用 2 个参数运行 bash`'-c'`和`'echo $HELLO'`
*   因为最后一个参数用单引号括起来，所以里面没有任何东西被扩展
*   新的 bash 将依次运行命令`echo $HELLO`
*   `$HELLO`为了在新的 bash 子 shell 中运行 echo ，bash 首先扩展它可以扩展的任何东西，`$HELLO`在这种情况下，父 shell`Hello World`为我们设置它。
*   子shell运行`echo 'Hello World'`

如果您尝试这样做：

```
env HELLO='Hello World' echo '$HELLO' 
```

*   当前的 shell 会扩展它可以扩展的任何东西，因为它`$HELLO`是用单引号括起来的
*   使用 3 个参数运行 env `'HELLO=Hello World'`，`'echo'`并且`'$HELLO'`
*   env 命令将运行并`HELLO='Hello World'`在其环境中设置
*   env 将使用参数运行 echo`'$HELLO'`

在这种情况下，没有外壳可以扩展`$HELLO`，因此`echo`接收字符串`$HELLO`并打印出来。变量扩展仅由 shell 完成。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-21T22:41:35.417

我想发生的事情类似于我也感到困惑的[这种情况。](https://unix.stackexchange.com/questions/58397/environment-variable-set-but-not-respected#comment80557_58422)

`$HELLO`简而言之，第一种情况下的变量扩展是由其环境中没有的当前 shell 完成的。但是，在第二种情况下，单引号会阻止当前 shell 进行变量扩展，因此一切都按预期工作。

请注意将单引号更改为双引号如何阻止此命令按您想要的方式工作：

```
HELLO='Hello World' bash -c "echo $HELLO" 
```

现在这将失败，原因与您问题中的第一个命令相同。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-04-18T17:23:56.047

这有效，对我有好处

```
$ MY_VAR='Hello' ANOTHER_VAR='World!!!' && echo "$MY_VAR $ANOTHER_VAR"
Hello World!!! 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-03-17T14:06:32.500

这是确认 shell 是否按预期工作的更简单方法。

```
env A=42 env
env 
```

第一个命令设置`A`为 42 并运行`env`。第二个命令也运行`env`。比较两者的输出。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2021-03-25T11:14:16.510

如前所述，传递给的变量的扩展`echo`发生在该变量设置之前。

较早的答案中尚未提到的一种替代方法是使用：

```
$ a=abc eval 'echo $a'
abc

$ echo $a
<blank> 
```

请注意，您必须使用`a=abc cmd`语法而不是`env a=abc cmd`语法；显然`env`与内置的`eval`.

# ruby-on-rails - 重置密码的问题 - 设计

> ID：13998076
> 
> 赞同：3
> 
> 时间：2012-12-21T22:36:18.567
> 
> 标签：ruby-on-rails, ruby, devise, erb

使用 Devise 重置密码时遇到问题。

当我单击“向我发送重置密码说明”时，我得到：

```
ArgumentError at /users/password
Missing host to link to! Please provide the :host parameter, set default_url_options[:host], or set :only_path to true 
```

它说问题出`/views/devise/mailer/reset_password_instructions.html.erb`在第 5 行。

在该文件的第 5 行有：

```
<p><%= link_to 'Change my password', edit_password_url(@resource, :reset_password_token => @resource.reset_password_token) %></p> 
```

尽管我已经尝试过，但我不知道如何在 Rails 中设置邮件程序。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T22:41:06.197

最后，您需要在每个环境中为邮件程序设置默认 url 选项。这是“config/environments/development.rb”的配置：

```
config.action_mailer.default_url_options = { :host => 'localhost:3000' } 
```

您需要指定主机，以便它可以显示在确认电子邮件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-12T05:16:56.143

您可以像这样创建默认过滤器：

```
 # application_controller.rb
    before_filter :mailer_set_url_options 
```

...

```
def mailer_set_url_options
  ActionMailer::Base.default_url_options[:host] = request.host_with_port
end 
```

# wordpress - wp_redirect 函数在本地工作，但不在服务器上

> ID：13998077
> 
> 赞同：0
> 
> 时间：2012-12-21T22:36:22.497
> 
> 标签：wordpress

我直接使用本教程中的代码：http: [//voodoopress.com/how-to-post-from-your-front-end-with-no-plugin/](http://voodoopress.com/how-to-post-from-your-front-end-with-no-plugin/)。在本地设置时，重定向工作正常。当完全相同的站点托管在机架空间云站点上时，它不会。这是怎么回事？

值得注意的一块：

```
if( 'POST' == $_SERVER['REQUEST_METHOD'] && !empty( $_POST['action'] ) &&  $_POST['action'] == "new_post") {

// Do some minor form validation to make sure there is content
if (isset ($_POST['title'])) {
    $title =  $_POST['title'];
} else {
    echo 'Please enter the wine name';
}
if (isset ($_POST['description'])) {
    $description = $_POST['description'];
} else {
    echo 'Please enter some notes';
}

$tags = $_POST['post_tags'];

// ADD THE FORM INPUT TO $new_post ARRAY
$new_post = array(
'post_title'    =>  $title,
'post_content'  =>  $description,
'post_category' =>  array($_POST['cat']),  // Usable for custom taxonomies too
'tags_input'    =>  array($tags),
'post_status'   =>  'publish',           // Choose: publish, preview, future, draft, etc.
'post_type' =>  'post'  //'post',page' or use a custom post type if you want to
);

//SAVE THE POST
$pid = wp_insert_post($new_post);

         //SET OUR TAGS UP PROPERLY
wp_set_post_tags($pid, $_POST['post_tags']);

//REDIRECT TO THE NEW POST ON SAVE
$link = get_permalink( $pid );
wp_redirect( $link );

} // END THE IF STATEMENT THAT STARTED THE WHOLE FORM

//POST THE POST YO
do_action('wp_insert_post', 'wp_insert_post');` 
```

这很简单。该代码使用`wp_insert_post`并随后重定向到该帖子的链接发布帖子。一切都很好，它适用于我的 XAMPP 设置。但问题是：我无法对它进行任何排列以在实时服务器上工作。我已经开始多次安装新的 WP，只将此代码放在 home.php 中，但无济于事。知道到底是什么问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:41:23.150

快速思考一下，您的任何页面中的重定向上方是否有任何空白？必须在将任何空白或其他元素添加到页面之前调用重定向，因此如果您在重定向之前回显某些内容，它将不起作用。

# javascript - NetUtil.async 从一个文件复制到 Firefox 扩展中的另一个文件

> ID：13998080
> 
> 赞同：1
> 
> 时间：2012-12-21T22:36:43.373
> 
> 标签：javascript, asynchronous, io, firefox-addon

我正在尝试使用 NetUtil.asyncCopy 将来自一个文件的数据附加到来自 Firefox 扩展的另一个文件的末尾。我基于[https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O](https://developer.mozilla.org/en-US/docs/Code_snippets/File_I_O)上的一些示例编写了此代码，特别是“将流复制到文件”示例。鉴于它在该页面上所说的内容，我的代码如下：

1.  为要复制的文件和要附加到的文件创建 nsIFile 对象，并使用正确的路径初始化这些对象。

2.  创建输出文件的输出流。

3.  运行`NetUtil.asyncCopy`函数以在文件（我相信它的行为类似于 nsIInputStream）和输出流之间进行复制。

我将此代码运行为`append_text_from_file("~/CopyFrom.txt", "~/AppendTo.txt");`，但没有任何内容被复制。和转储出现在控制台上，但不出现`Appending Text`或转储。`After ostream``Done``Error`

有谁知道我在这里做错了什么？我对 Firefox 扩展和 javascript 都很陌生（尽管我是一个相当有经验的程序员）——所以我可能在做一些非常愚蠢的事情。如果我的整个方法是错误的，那么请告诉我 - 我原以为这种方法可以让我轻松地异步附加文件，但由于某种我不知道的原因，这可能是不可能的。

```
function append_text_from_file(from_filename, to_filename) {
        var from_file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
        from_file.initWithPath(from_filename);

        var to_file = Components.classes["@mozilla.org/file/local;1"].createInstance(Components.interfaces.nsILocalFile);
        to_file.initWithPath(to_filename);

        dump("Appending text\n");

        var ostream = FileUtils.openFileOutputStream(to_file, FileUtils.MODE_WRONLY | FileUtils.MODE_APPEND)
        dump("After ostream\n");
        NetUtil.asyncCopy(from_file, ostream, function(aResult) {
            dump("Done\n");
            if (!Components.isSuccessCode(aResult)) {
                // an error occurred!
                dump(aResult);
                dump("Error!\n")
            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-26T03:40:53.967

asyncCopy() 需要输入流而不是文件。你可以这样做：

```
 var fstream = Cc["@mozilla.org/network/file-input-stream;1"].createInstance(Ci.nsIFileInputStream);
    fstream.init(from_file, 0x01, 4, null);

    NetUtil.asyncCopy(fstream, ostream, function(aResult).... 
```

# ios - UITableView 部分索引不更新

> ID：13998083
> 
> 赞同：2
> 
> 时间：2012-12-21T22:37:14.633
> 
> 标签：ios, uitableview, nsfetchedresultscontroller, uisearchdisplaycontroller

我有一个带有字母部分和部分索引的表格视图工作正常。它由 NSFetchedResultsController 支持。

问题在于针对相同数据生成的搜索结果表。搜索结果显示正确，部分标题正确。然而，即使表格中只有一个部分，表格旁边的部分索引仍会显示完整的字母表。

我为这两个表使用单独的获取结果控制器。search fetched results controller 显示它有正确的节数并且它的`sectionIndexTitles`数组是正确的。尽管如此，表视图仍显示完整表中的索引。

我曾尝试调用`reloadSearchIndexTitles`搜索结果表视图，但索引仍显示旧索引。也研究过 using `UILocalizedIndexedCollation`，但如果我理解正确，那不会改变任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-28T20:54:48.950

我仍然不完全理解这一点，但我发现问题出在我的视图控制器层次结构上。具体来说，我将表视图和表视图控制器 (TVC) 嵌入到容器视图和控制器以及 TVC 子类 UITableViewController 中。

Apple 的 Table View Programming Guide 建议在这种情况下，您的 TVC 应该继承 UIViewController。UITableViewController 做出了不再适用于这种情况的假设。进行此更改后，我的搜索索引开始正常工作。

# jquery - 二级伪选择？

> ID：13998088
> 
> 赞同：4
> 
> 时间：2012-12-21T22:38:06.150
> 
> 标签：jquery, pseudo-element

我不知道是否已经有一个帖子，因为我不知道如何准确地表达这个问题，所以我举个例子..

```
<ul class=filters>
     <li class=segment-1>
         <a href="#">Web</a>
     </li>
</ul> 
```

该代码用于在您单击列表项时过滤库的列表。

我想我应该能够使用代码来选择“Web”，这样我就可以在页面加载时自动过滤图库。

```
$('element*="Web"').click(); 
```

这是最好的做事方式吗？如果是..我应该用什么代替“元素”来选择 Web

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:45:34.420

```
$('ul.filters li a:contains("Web")').trigger('click'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:03:32.673

有更好的方法，不必在每次标记文本略有变化时更新。

将一个类添加到锚标记，并使用与其用途相关的一些有意义的名称，然后执行以下操作（我用作`navLink`类名）：

```
$('.navLink').click(); 
```

或者使用现有的标记层次结构：

```
$('ul.filters > li.segment-1 > a').click(); 
```

PS请注意，我在您的标记中修复了您的属性值周围的引号：

```
<ul class="filters">
     <li class="segment-1">
         <a href="#" class="navLink" >Web</a>
     </li>
</ul> 
```

# c++ - 用于 3 个面板的 Qt 布局，全部垂直扩展以填充

> ID：13998090
> 
> 赞同：3
> 
> 时间：2012-12-21T22:38:14.853
> 
> 标签：c++, qt, pyqt, pyside

我对桌面 GUI 开发相当陌生。

我正在尝试获得一个带有 3 个平行垂直面板的框架，所有面板都垂直扩展以填充窗口。

我希望前两个面板不是灵活的，而是具有固定的尺寸。

前任：

```
 Fixed W.
|========|
############################ 
#    #    #                # ^
#Fix.#Fix.#                # |
#|--|#|--|# <--Flexible--> # Flexible vertically all 3 panels.
#    #    #                # |
#    #    #                # v
############################ 
```

我怎样才能获得这个布局？我尝试过网格，垂直，水平，但我认为我得到了所有意大利面条般的和困惑。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T22:47:23.080

你需要一个

```
QHBoxLayout 
```

您只需为固定小部件设置固定宽度（在左侧）。

这是一个完整的 C++ 工作示例：

```
#include <QApplication>
#include <QtGui>

int main(int argc, char *argv[])
{
    QApplication a(argc, argv);
    QFrame* w1 = new QFrame;
    w1->setFixedWidth(100);
    w1->setStyleSheet("background-color: red");

    QFrame* w2 = new QFrame;
    w2->setFixedWidth(100);
    w2->setStyleSheet("background-color: blue");

    QFrame* w3 = new QFrame;
    w3->setStyleSheet("background-color: green");
    w3->setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Expanding);

    QHBoxLayout* layout = new QHBoxLayout;

    layout->addWidget(w1);
    layout->addWidget(w2);
    layout->addWidget(w3);

    QWidget* app = new QWidget;
    app->setLayout(layout);
    app->show();
    return a.exec();
} 
```

和截图：

![在此处输入图像描述](../Images/768b38db8aea8465d5b4e9e63cdfa3dc.png)

# complexity-theory - 如何计算这个循环的复杂度？

> ID：13998094
> 
> 赞同：1
> 
> 时间：2012-12-21T22:38:58.870
> 
> 标签：complexity-theory

这个循环的复杂度是多少？我无法绕过它。

```
for (i = 0; i < n; ++i) { 
    for (j = i; j < n; ++j) {
        for (k = 0; k < j; ++k) {
            // Do something
        }
    } 
```

}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:02:35.583

`O(n^3)`， 我相信。请参阅[方形金字塔数](http://en.wikipedia.org/wiki/Square_pyramidal_number)。

`i`循环有`n`迭代。

`j`循环：(1 + 2 + ... + n)，以`n`迭代开始，以 . 结束`1`。

`k`循环：(1² + 2² + ... n²)，`j`每次循环迭代的次数`j`。

最后：

![在此处输入图像描述](../Images/903280d7677bcfb579dcb7f7062cbe1c.png)

# matlab - MATLAB - 根据向量的排序方式对矩阵进行排序

> ID：13998098
> 
> 赞同：3
> 
> 时间：2012-12-21T22:39:18.143
> 
> 标签：matlab, sorting, vector, matrix

> **可能重复：**
> [如何在 MATLAB 中针对一列对二维数组进行排序？](https://stackoverflow.com/questions/134712/how-can-i-sort-a-2-d-array-in-matlab-with-respect-to-one-column)
> [用另一个矩阵对一个矩阵进行排序](https://stackoverflow.com/questions/2679022/sort-a-matrix-with-another-matrix)

我有一个包含 429 个值的向量“A”和一个包含 429x200 个值的矩阵“B”。A 和 B 中的行共享相同的索引。我的向量“A”包含值 1:1:429，但它们在整个向量中是随机排序的。我想对 A 重新排序，使其按从 1 到 429 的顺序进行索引，并且我还想以与新排序的“A”相同的顺序对矩阵“B”中的行进行排序。

如果没有 for 循环，这可以快速简单地完成吗？

这是一个例子来说明我的观点：

```
A =
    5
    3
    1
    2
    4

 B =
    3   7   0   4   6
    1   2   5   0   8
    4   0   2   0   0
    3   0   1   0   5
    2   2   3   4   4

sortedA = 

1
2
3
4
5

sortedB =

4   0   2   0   0
3   0   1   0   5
1   2   5   0   8
2   2   3   4   4
3   7   0   4   6 
```

谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:47:49.713

示例数据：

```
A = [ 5, 3, 1, 2, 4 ]';

B = [ 3, 7, 0, 4, 6; 1, 2, 5, 0, 8; 4, 0, 2, 0, 0; 3, 0, 1, 0, 5; 2, 2, 3, 4, 4 ] 
```

对矩阵进行排序：

```
[sortedA,IX] = sort(A);

sortedB = B(IX,:);

sortedA =
 1
 2
 3
 4
 5

sortedB =
 4     0     2     0     0
 3     0     1     0     5
 1     2     5     0     8
 2     2     3     4     4
 3     7     0     4     6 
```

# javascript - 解释在 javascript 中将全局变量重新绑定到本地变量的模式

> ID：13998103
> 
> 赞同：3
> 
> 时间：2012-12-21T22:39:59.180
> 
> 标签：javascript

> **可能重复：**
> [此 JavaScript/JQuery 语法如何工作：(function(window, undefined) {})(window)？](https://stackoverflow.com/questions/2716069/how-does-this-javascript-jquery-syntax-work-function-window-undefined)

[我在jquery 源代码（第 13 行）](http://www.dustingetz.com/client-side-designer-templates/assets/javascripts/jquery-1.8.2.js)中看到了这种模式，他们将“窗口”和“未定义”重新绑定到本地：

```
(function(window, undefined) {
     window.something = 42;
     var dummy = 42 === undefined;
}(window)); 
```

我认为将“窗口”重新绑定到本地是严格模式的事情（防止意外访问窗口） - 但看看它们是如何绑定`undefined`到本地的。为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:51:16.957

在 JavaScript 中，您可以为 undefined 赋值，例如：

```
undefined=42; 
```

jQuery 表示法确保在块中 undefined 确实是未定义的。

[根据 MDN](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/undefined)：

> 根据 ECMAScript 5 规范，从 JavaScript 1.8.5 开始，undefined 是不可写的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:53:01.230

如果有人改变`undefined`你的代码行为将是不可预测的：

```
 undefined = 42; 
```

因此，您通过在调用期间不传递该参数来强制`undefined`您的函数始终正确：

```
 function safe(undefined) {
   // undefined is really undefined here
 }

 function unsafe() {
   // undefined could be 42 here
 }

 undefined = 42;
 safe();
 unsafe(); 
```

与 类似`window`。也传递`window`给你额外的adantage，你可以测试你的功能而不会实际影响真实的窗口。即您的“模拟”窗口可以自定义`setTimeout`测试功能的计时行为。

```
 function complex(window)
 {
    window.setTimeout(callback, 1000);
 } 

 var mockWindow = {setTimeout:...};
 complex(mockWindow);
 // here you can make sure setTimout was called and if necessary
 // call the callback. 
```

# perl - 如何为具有可继承数据的角色编写 Moose 基类？

> ID：13998107
> 
> 赞同：1
> 
> 时间：2012-12-21T22:40:10.490
> 
> 标签：perl, moose

我有一组与数据库交互的 Moose 角色（很快就会变大）。它们具有 create_foo_record、update_foo_record、delete_foo_record 等方法。（它们不是数据库访问的简单包装器，因为它们执行诸如转换和规范化数据、记录操作等操作。在某些情况下，它们也可以创建和更新相关记录.)

这段代码非常通用，所以我想要一个实现这些方法的基本模块，而不是有两个模块的剪切和粘贴代码，使用配置参数告诉他们哪些表、列、规范化函数等。

我的直觉是写一些“高阶”的东西来生成这些函数，但我认为用 Moose 的方式来做更合适。（不过，我是 Moose 新手……）

天真的方法是让基类成为一个角色，它的方法采用配置参数，但这看起来很混乱。

理想情况下，我希望基类具有使用它的角色设置的私有配置，例如

```
__PACKAGE__->config( foo => 'bar' ); 
```

但我不确定如何使用 Moose 来做到这一点。我的尝试遇到了错误，抱怨将类扩展为角色。或者配置参数被证明不是私有的，并且会干扰其他角色或被使用角色的 Catalyst 控制器中的相应配置干扰。

如果可以在基类中使用“Catalyst::Component”，但以某种方式将其扩展到角色，那将是理想的。但我不知道该怎么做，或者即使有可能。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T03:41:19.797

撇开这听起来很像[DBIx::Class::SchemaLoader 不说](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aSchema%3a%3aLoader)，如果我理解正确的话，你想要......

*   存储系统配置信息的东西。
*   它有默认值。
*   这些默认值可以在每个类的基础上被覆盖。

一种方法是[创建一个角色并利用构建器方法](http://search.cpan.org/dist/Moose/lib/Moose/Manual/Attributes.pod#Builders_work_well_with_roles)。角色通过构建器方法定义默认值，并且每个类都可以覆盖。

```
use v5.10;

{
  package MyConfig;

  use Moose::Role;

  has user => (
      is      => 'ro',
      lazy    => 1,
      builder => '_build_user',
  );

  sub _build_user {
    return "default_user";
  }
}

{
  package MyApp;
  use Moose;

  with 'MyConfig';

  sub _build_user {
    return "some_user";
  }
}

{
  package DefaultApp;
  use Moose;

  with 'MyConfig';
}

say MyApp->new->user;        # some_user
say DefaultApp->new->user;   # default_user 
```

另一种是利用[属性继承](http://search.cpan.org/dist/Moose/lib/Moose/Manual/Attributes.pod#ATTRIBUTE_INHERITANCE)。

```
use v5.10;

{
  package MyConfig;

  use Moose::Role;

  has user =>
      is      => 'ro',
      lazy    => 1,
      default => "default_user",
  ;
}

{
  package MyApp;
  use Moose;

  with 'MyConfig';

  has '+user' =>
      default => 'some_user'
  ;
}

{
  package DefaultApp;
  use Moose;

  with 'MyConfig';
}

say MyApp->new->user;        # some_user
say DefaultApp->new->user;   # default_user 
```

它们基本上是一样的。前者以更传统的 OO 风格完成，更机械化。后者是使用一点 Moose 魔法完成的，并且更具声明性和紧凑性。各有优缺点，适合您的使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T17:13:40.803

我认为我需要的是参数化角色[http://metacpan.org/pod/MooseX::Role::Parameterized](http://metacpan.org/pod/MooseX::Role::Parameterized)

# javascript - 如何根据来自 javascript 的调用向通知栏添加通知？

> ID：13998116
> 
> 赞同：0
> 
> 时间：2012-12-21T22:41:23.690
> 
> 标签：javascript, android, notifications

如何根据来自 javascript 的调用向通知栏添加通知？

我有这个：

```
package com.CheckInventory;

import android.app.Activity;
import android.os.Bundle;
import android.view.KeyEvent;
import android.view.WindowManager;
import android.webkit.WebChromeClient;
import android.webkit.WebSettings;
import android.webkit.WebStorage;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.Toast;

@SuppressWarnings("unused")
public class CheckInventoryActivity extends Activity {
    WebView webview;
    String username; 
    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        getWindow().addFlags(WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON);
        setContentView(R.layout.main);
        webview = (WebView) findViewById(R.id.webview);
        WebView webView = (WebView) findViewById(R.id.webview);
        webView.setBackgroundColor(0);
        webView.setBackgroundResource(R.drawable.myimage);
        webView.addJavascriptInterface(new JavaScriptInterface(this), "Android");
        WebSettings webSettings = webview.getSettings();
        webSettings.setLoadWithOverviewMode(true);

        webview.setScrollBarStyle(WebView.SCROLLBARS_OUTSIDE_OVERLAY);

        webSettings.setJavaScriptEnabled(true);
        webSettings.setJavaScriptCanOpenWindowsAutomatically(true);
        webSettings.setDatabasePath("/data/data/"+this.getPackageName()+"/databases/");
        webSettings.setDomStorageEnabled(true);
        webview.setWebChromeClient(new WebChromeClient());
        webview.loadUrl("http://192.168.0.124/android");
        webview.setWebViewClient(new HelloWebViewClient());

    }
    private class HelloWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            view.loadUrl(url);
            return true;
        }

        @Override
        public void onReceivedError(WebView view, int errorCode, String description, String failingUrl)
        {
            super.onReceivedError(view, errorCode, description, failingUrl);
            webview.loadUrl("file:///android_asset/nodata.html");
            Toast.makeText(getApplicationContext(),"Not online", Toast.LENGTH_LONG).show();
        }
    }

    @Override
    public boolean onKeyDown (int keyCode, KeyEvent event) {
        if((keyCode == KeyEvent.KEYCODE_BACK) && webview.canGoBack()){
            //webview.goBack();
            return true;
        }

        return super.onKeyDown(keyCode, event);
    }
} 
```

Javascript接口.Java

```
package com.CheckInventory;
import android.widget.Toast;
import android.content.Context;

public class JavaScriptInterface {
    Context mContext;

    /** Instantiate the interface and set the context */
    JavaScriptInterface(Context c) {
        mContext = c;
    }

    /** Show a toast from the web page */
    public void showToast(String toast) {
        Toast.makeText(mContext, toast, Toast.LENGTH_LONG).show();
    }
} 
```

我的 Javascript 与 android 应用程序正确交互，因为我看到了 toast，如何向通知栏添加通知？我对 android 很陌生，不知道如何从我在互联网上找到的示例转到我的应用程序中的有用状态。

先感谢您！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:07:32.087

另请[参阅通知用户](http://developer.android.com/training/notify-user/index.html)。您应该能够用通知替换您的 showToast。但是，您还应该查看 JavaScriptInterface 的参考文档；Java 对象需要使用@JavascriptInterface 进行注释。

# java - 在 Lucene 文档中添加字段

> ID：13998124
> 
> 赞同：4
> 
> 时间：2012-12-21T22:42:00.593
> 
> 标签：java, spring, lucene

您好，我有一个 32mb 的文件。它是一个简单的字典文件，编码为 1250，其中包含 280 万行。每一行只有一个唯一的单词：

```
cat
dog
god
... 
```

我想使用 Lucene 搜索特定单词字典中的每个字谜。例如：

我想搜索单词**dog**和 lucene 的每个字谜应该搜索我的字典并返回**dog**和**god**。在我的 webapp 中，我有一个 Word 实体：

```
public class Word {
    private Long id;
    private String word;
    private String baseLetters;
    private String definition;
} 
```

baseLetters 是按字母顺序排序的变量，用于搜索此类字谜[神和狗词将具有相同的 baseLetters：dgo]。我成功地在不同的服务中使用这个 baseLetters 变量从我的数据库中搜索了这样的字谜，但是我在创建字典文件的索引时遇到了问题。我知道我必须添加到字段：

word 和 baseLetters 但我不知道该怎么做 :( 有人可以告诉我一些实现这个目标的方向吗？

现在我只有这样的东西：

```
public class DictionaryIndexer {

private static final Logger logger = LoggerFactory.getLogger(DictionaryIndexer.class);

@Value("${dictionary.path}")
private String dictionaryPath;

@Value("${lucene.search.indexDir}")
private String indexPath;

public void createIndex() throws CorruptIndexException, LockObtainFailedException {
    try {
        IndexWriter indexWriter = getLuceneIndexer();
        createDocument();           
    } catch (IOException e) {
        logger.error(e.getMessage(), e);
    }       
 }

private IndexWriter getLuceneIndexer() throws CorruptIndexException, LockObtainFailedException, IOException {
    StandardAnalyzer analyzer = new StandardAnalyzer(Version.LUCENE_36);
    IndexWriterConfig indexWriterConfig = new IndexWriterConfig(Version.LUCENE_36, analyzer);
    indexWriterConfig.setOpenMode(OpenMode.CREATE_OR_APPEND);
    Directory directory = new SimpleFSDirectory(new File(indexPath));
    return new IndexWriter(directory, indexWriterConfig);
}

private void createDocument() throws FileNotFoundException {
    File sjp = new File(dictionaryPath);
    Reader reader = new FileReader(sjp);

    Document dictionary = new Document();
    dictionary.add(new Field("word", reader));
}

} 
```

PS：还有一个问题。如果我在 Spring 中将 DocumentIndexer 注册为 bean，每次我重新部署我的 webapp 时，索引是否会创建/附加？未来的 DictionarySearcher 也会如此吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-28T16:35:19.840

Lucene 不是最好的工具，因为你不是在做搜索：你是在做查找。所有实际工作都发生在“索引器”中，然后您只需存储所有工作的结果。在任何散列类型的存储机制中，查找都可以是 O(1)。

这是您的索引器应该执行的操作：

1.  将整个字典读成一个简单的结构，如`SortedSet`or`String[]`
2.  创建一个空的`HashMap<String,List<String>>`（可能大小相同，以提高性能）用于存储结果
3.  按字母顺序遍历字典（实际上任何顺序都可以，只要确保你点击了所有条目）
    1.  对单词中的字母进行排序
    2.  在您的存储集合中查找已排序的字母
    3.  如果查找成功，则将当前单词添加到列表中；否则，创建一个包含该单词的新列表并将其放入存储中`Map`
4.  如果以后需要这张地图，把地图存到磁盘上；否则，将其保存在内存中
5.  丢弃字典

这是您的查找过程应该执行的操作：

1.  对示例单词中的字母进行排序
2.  在您的存储集合中查找已排序的字母
3.  打印`List`从查找返回的（或 null），注意从输出中省略示例单词

如果要节省堆空间，请考虑使用[DAWG](http://en.wikipedia.org/wiki/Directed_acyclic_word_graph)。你会发现你可以用几百千字节而不是 32MiB 来表示整个英语单词词典。我将把它作为练习留给读者。

祝你的家庭作业好运。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-01T11:11:36.777

函数 createDocument() 应该是

```
private void createDocument() throws FileNotFoundException {
    File sjp = new File(dictionaryPath);
    BufferedReader reader = new BufferedReader(new FileReader(sjp));

    String readLine = null;
    while((readLine = reader.readLine() != null)) {
        readLine = readLine.trim();
        Document dictionary = new Document();
        dictionary.add(new Field("word", readLine));
        // toAnagram methods sorts the letters in the word. Also makes it
        // case insensitive.
        dictionary.add(new Field("anagram", toAnagram(readLine)));
        indexWriter.addDocument(dictionary);
    }
} 
```

如果您将 Lucene 用于很多功能，请考虑使用[Apache Solr](http://lucene.apache.org/solr/)，这是一个构建在 Lucene 之上的搜索平台。

您还可以为每个字谜组仅使用一个条目来建模您的索引。

```
{"anagram" : "scare", "words":["cares", "acres"]}
{"anagram" : "shoes", "words":["hoses"]}
{"anagram" : "spore", "words":["pores", "prose", "ropes"]} 
```

这将需要在处理您的字典文件时更新索引中的现有文档。在这种情况下，Solr 将有助于使用更高级别的 API。例如，[IndexWriter 不支持更新文档](http://wiki.apache.org/lucene-java/LuceneFAQ#How_do_I_update_a_document_or_a_set_of_documents_that_are_already_indexed.3F)。Solr 支持更新。

这样的索引将为每个字谜搜索提供一个结果文档。

希望能帮助到你。

# usb - 使用带有 monodroid 的 USB 指纹扫描仪

> ID：13998126
> 
> 赞同：0
> 
> 时间：2012-12-21T22:42:07.550
> 
> 标签：usb, xamarin.android

我想使用 monodroid 构建一个从 USB 设备读取指纹的应用程序。那里有我可以用来执行此操作的 SDK 吗？

[如果我使用像http://www.neurotechnology.com/](http://www.neurotechnology.com/)这样的现有指纹 Java SDK ，它可以混合到一个 monodroid 项目中吗？如果我在 monodroid 中使用 USB api，我能否以某种方式将现有驱动程序用于外部 USB 指纹设备？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T10:57:59.307

我怀疑是否有为 Mono for Android 编写的用于指纹生物识别的 SDK。但是，您可以将 Java 与 C# 混合使用，因此您不会不走运。

因此，您基本上可以做的是使用您链接到的指纹 SDK 编写一堆类，并将其编译并打包到一个 jar 中。如果您很聪明，您还可以在 Java 中编写几个帮助程序类来完成繁重的工作，您唯一需要做的就是绑定它，以便可以从 Mono for Android 调用它。

有关如何绑定 jar 的更多信息，请参阅[Mono for Android 文档。](http://docs.xamarin.com/Android/Guides/Advanced_Topics/Java_Integration_Overview/Binding_a_Java_Library_%28.jar%29)

# c# - 从任何进程中获取密钥

> ID：13998131
> 
> 赞同：2
> 
> 时间：2012-12-21T22:42:29.190
> 
> 标签：c#, keyboard, console-application, user32

我在网上看到了很多解决方案，但没有一个完全符合我的要求。当我的应用程序在后台运行时，在给定进程（不是我的控制台应用程序）中按下任何键的最佳/最简单方法是什么。我不需要修饰符或任何东西。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:00:20.063

If you don't particularly care which process the keys are being pressed in the easiest method would be to call [GetAsyncKeyState](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms646293%28v=vs.85%29.aspx). It's rather limited though as it does not hook the keyboard and requires you to call it continuously. The best approach in my opinion is to hook the keyboard.

Using [SetWindowsHookEx](http://msdn.microsoft.com/en-gb/library/windows/desktop/ms644990%28v=vs.85%29.aspx) you can actually explicitly specify the identifier of the thread with which the hook procedure is to be associated so you can hook keys for a specific process (see **dwThreadId**).

Here's a class that you can use (originally found on a Micrsoft blog but I cannot seem to find the authors name at the moment!)

```
public delegate IntPtr KeyboardProcess(int nCode, IntPtr wParam, IntPtr lParam);

public sealed class KeyboardHook
{
    public static event EventHandler<KeyPressedEventArgs> KeyPressed;
    private const int WH_KEYBOARD = 13;
    private const int WM_KEYDOWN = 0x0100;
    private static KeyboardProcess keyboardProc = HookCallback;
    private static IntPtr hookID = IntPtr.Zero;

    public static void CreateHook()
    {
        hookID = SetHook(keyboardProc);
    }

    public static void DisposeHook()
    {
        UnhookWindowsHookEx(hookID);
    }

    private static IntPtr SetHook(KeyboardProcess keyboardProc)
    {
        using (Process currentProcess = Process.GetCurrentProcess())
        using (ProcessModule currentProcessModule = currentProcess.MainModule)
        {
            return SetWindowsHookEx(WH_KEYBOARD, keyboardProc, GetModuleHandle(currentProcessModule.ModuleName), 0);
        }
    }

    private static IntPtr HookCallback(int nCode, IntPtr wParam, IntPtr lParam)
    {
        if (nCode >= 0 && wParam == (IntPtr)WM_KEYDOWN)
        {
            int vkCode = Marshal.ReadInt32(lParam);

            if (KeyPressed != null)
                KeyPressed(null, new KeyPressedEventArgs((Keys)vkCode));
        }
        return CallNextHookEx(hookID, nCode, wParam, lParam);
    }

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr SetWindowsHookEx(int idHook, KeyboardProcess lpfn, IntPtr hMod, uint dwThreadId);

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr CallNextHookEx(IntPtr hhk, int nCode, IntPtr wParam, IntPtr lParam);

    [DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr GetModuleHandle(string lpModuleName);

    [DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool UnhookWindowsHookEx(IntPtr hhk);

}

public class KeyPressedEventArgs : EventArgs
{
    public Keys KeyCode { get; set; }
    public KeyPressedEventArgs(Keys Key)
    {
        KeyCode = Key;
    }
} 
```

Implementation via Console Application:

```
class Program
{
    static void Main(string[] args)
    {
        KeyboardHook.CreateHook();
        KeyboardHook.KeyPressed += KeyboardHook_KeyPressed;
        Application.Run();
        KeyboardHook.DisposeHook();
    }

    static void KeyboardHook_KeyPressed(object sender, KeyPressedEventArgs e)
    {
        Console.WriteLine(e.KeyCode.ToString());
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T22:54:33.720

您正在寻找的东西称为全局键盘挂钩。[您可以在 MSDN 上](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644959%28v=vs.85%29.aspx)找到更多信息和示例。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T23:01:13.707

哦，所以您正在寻找老式游戏术语中的“自动开火”？

与其编写自己的键盘钩子应用程序（除非你是为了好玩/刺激它/锻炼），你可能想看看 AutoIt 或 AutoHotkey，它们都非常适合键盘/鼠标自动化。

例如，请参阅此线程... [http://www.autohotkey.com/board/topic/40598-autofire-keyboard/](http://www.autohotkey.com/board/topic/40598-autofire-keyboard/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-11-14T02:15:25.123

我找到了一种只挂钩一个进程的方法。你可能需要它。

```
int ProcessId = GetProcessesByName("Your_app_here").FirstOrDefault().Id;
private IntPtr SetHook(KeyboardHookHandler proc)
    {
        return SetWindowsHookEx(13, proc, GetModuleHandle(Process.GetProcessById(ProcessId).MainModule.ModuleName), GetWindowThreadProcessId(GetModuleHandle(Process.GetProcessById(ProcessId).MainModule.ModuleName), out int MainThreadId));
    } 
```

请记住导入这些方法。

```
[DllImport("user32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr SetWindowsHookEx(int idHook, KeyboardHookHandler lpfn, IntPtr hMod, uint dwThreadId);

[DllImport("kernel32.dll", CharSet = CharSet.Auto, SetLastError = true)]
    private static extern IntPtr GetModuleHandle(string lpModuleName);

[DllImport("user32.dll", SetLastError = true)]
    static extern uint GetWindowThreadProcessId(IntPtr hWnd, out int lpdwProcessId); 
```

# asp.net-web-api - 带有 DataJs 的 Asp.Net WebApi OData 引发错误

> ID：13998133
> 
> 赞同：1
> 
> 时间：2012-12-21T22:42:39.890
> 
> 标签：asp.net-web-api, odata, datajs

我刚刚创建了一个非常简单的 ASP.Net WebApi 项目。我使用 NuGet 下载了 WebAPI 中的最新 OData – RC 版本。我还通过 NuGet 下载 DataJs 和 Knockout。我所有的依赖项都是最新的。我创建了一个简单的“书籍”类，并使用 HttpConfiguration.EnableOData(IEdmModel) 将所有内容连接在一起。我还在控制器中的 Get 操作中添加了 [Queryable] 属性。不涉及数据库，我硬编码了我想要返回的数据。基本上，我做了最少的更改来使用 WebApi 和 OData 运行我的项目。

当我尝试使用 DataJs 查询 OData 服务时，我在响应中收到 500 Internal Server Error，但如果我直接浏览到 URL，我可以看到 XML 数据。我已经包含了请求、响应、我的 C# 类、Javascript 代码和 Global.asax 代码。我缺少什么让这个工作？

**要求**

```
Response Headers
Cache-Control   private
Content-Length  966
Content-Type    application/json; odata=fullmetadata; charset=utf-8
DataServiceVersion  3.0;
Date    Fri, 21 Dec 2012 22:13:27 GMT
Server  Microsoft-IIS/8.0
X-AspNet-Version    4.0.30319
X-Powered-By    ASP.NET
X-SourceFiles   =?UTF-8?B?YzpcdXNlcnNcanVzdGluXGRvY3VtZW50c1x2aXN1YWwgc3R1ZGlvIDIwMTJcUHJvamVjdHNcRGF0YUpzU3Bpa2VcRGF0YUpzU3Bpa2VcYXBpXEJvb2tz?=
Request Headers
Accept  application/atomsvc+xml;q=0.8, application/json;odata=fullmetadata;q=0.7, application/json;q=0.5, */*;q=0.1
Accept-Encoding gzip, deflate
Accept-Language en-US,en;q=0.5
Connection  keep-alive
Cookie  glimpseState=null; glimpseLatestVersion=0.87; glimpseOptions=null; glimpseClientName=null
Host    localhost:31652
MaxDataServiceVersion   3.0
Referer http://{localhost}/
User-Agent  Mozilla/5.0 (Windows NT 6.2; WOW64; rv:17.0) Gecko/20100101 Firefox/17.0 
```

**回复**

```
{
  "odata.error":{
    "code":"","message":{
      "lang":"en-US","value":"An error has occurred."
    },"innererror":{
      "message":"The 'ObjectContent`1' type failed to serialize the response body for content type 'application/json; odata=fullmetadata; charset=utf-8'.","type":"System.InvalidOperationException","stacktrace":"","internalexception":{
        "message":"The related entity set could not be found. The related entity set is required to serialize the payload.","type":"System.Runtime.Serialization.SerializationException","stacktrace":"   at System.Web.Http.OData.Formatter.Serialization.ODataFeedSerializer.WriteObject(Object graph, ODataMessageWriter messageWriter, ODataSerializerContext writeContext)\r\n   at System.Web.Http.OData.Formatter.ODataMediaTypeFormatter.<>c__DisplayClass8.<WriteToStreamAsync>b__7()\r\n   at System.Threading.Tasks.TaskHelpers.RunSynchronously(Action action, CancellationToken token)"
      }
    }
  }
} 
```

**C# 类**

```
namespace DataJsSpike.Models
{
    public class Book
    {
        public string ISBN { get; set; }

        public string Title { get; set; }

        public string Author { get; set; }

        public string Publisher { get; set; }
    }
} 
```

**Javascript代码**

```
// the URL of the first page to retrieve
var startPage = "api/Books";

var viewModel = new Object();
viewModel.books = ko.observable();

// On initialization, make a request for the first page
$(document).ready(function () {
    LoadDataJs();

    function LoadDataJs() {
        OData.read(startPage, function (data) {
            viewModel.books(data.results);
            ko.applyBindings(viewModel);
        });
    }
}); 
```

**全球.asax**

```
public class WebApiApplication : HttpApplication
{
    protected void Application_Start()
    {
        AreaRegistration.RegisterAllAreas();

        WebApiConfig.Register(GlobalConfiguration.Configuration);
        FilterConfig.RegisterGlobalFilters(GlobalFilters.Filters);

        RouteConfig.RegisterRoutes(RouteTable.Routes);
        BundleConfig.RegisterBundles(BundleTable.Bundles);

        var modelBuilder = new ODataConventionModelBuilder();
        EntityTypeConfiguration<Book> bookConfiguration = modelBuilder.Entity<Book>();

        bookConfiguration.HasKey(x => x.ISBN);
        modelBuilder.EntitySet<Book>("Books");

        IEdmModel model = modelBuilder.GetEdmModel();

        GlobalConfiguration.Configuration.EnableOData(model, "api");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:43:26.747

EnableOData 实际上为您注册了一条路线，但由于您在运行之前注册了路线，因此这些路线优先。如果删除此行：

```
RouteConfig.RegisterRoutes(RouteTable.Routes); 
```

我认为应该可以解决。该请求需要进入 OData 路由，OData 格式才能正常工作，因为该路由解析 OData 路径并为格式化程序提供有关正在访问的实体集等内容的信息。

# postgresql - 优化 Postgres 对时间戳范围的查询

> ID：13998139
> 
> 赞同：16
> 
> 时间：2012-12-21T22:43:40.100
> 
> 标签：postgresql, indexing, query-optimization, database-partitioning, postgresql-performance

我定义了下表和索引：

```
CREATE TABLE ticket (
  wid bigint NOT NULL DEFAULT nextval('tickets_id_seq'::regclass),
  eid bigint,
  created timestamp with time zone NOT NULL DEFAULT now(),
  status integer NOT NULL DEFAULT 0,
  argsxml text,
  moduleid character varying(255),
  source_id bigint,
  file_type_id bigint,
  file_name character varying(255),
  status_reason character varying(255),
  ...
) 
```

我在时间戳上创建了一个索引，`created`如下所示：

```
CREATE INDEX ticket_1_idx
  ON ticket
  USING btree
  (created ); 
```

这是我的查询：

```
select * from ticket 
where created between '2012-12-19 00:00:00' and  '2012-12-20 00:00:00' 
```

在记录数量开始增长（大约 500 万条）之前，这一直运行良好，现在它需要永远返回。

解释分析揭示了这一点：

```
Index Scan using ticket_1_idx on ticket  (cost=0.00..10202.64 rows=52543 width=1297) (actual time=0.109..125.704 rows=53340 loops=1)
  Index Cond: ((created >= '2012-12-19 00:00:00+00'::timestamp with time zone) AND (created <= '2012-12-20 00:00:00+00'::timestamp with time zone))
Total runtime: 175.853 ms 
```

到目前为止，我已经尝试过设置：

```
random_page_cost = 1.75 
effective_cache_size = 3 
```

还创建了：

```
create CLUSTER ticket USING ticket_1_idx; 
```

没有任何效果。我究竟做错了什么？为什么选择顺序扫描？索引应该使查询快速。有什么可以优化的吗？

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-12-23T01:28:26.617

### [`CLUSTER`](https://www.postgresql.org/docs/current/sql-cluster.html)

如果您打算使用`CLUSTER`，则显示的语法无效。

~~`create CLUSTER ticket USING ticket_1_idx;`~~

运行一次：

```
CLUSTER ticket USING ticket_1_idx; 
```

这*对*更大的结果集有很大帮助。对于返回的单行或几行而言，并没有那么多。
Postgres 记住用于后续调用的索引。如果您的表不是只读的，则效果会随着时间的推移而恶化，您需要以一定的时间间隔重新运行：

```
CLUSTER ticket; 
```

可能仅在易失性分区上。见下文。

**但是**，如果您有很多更新，`CLUSTER`（或`VACUUM FULL`）实际上可能对性能不利。适量的膨胀允许`UPDATE`将新的行版本放置在同一数据页上，并避免过于频繁地物理扩展底层物理文件的需要。您可以使用经过仔细调整`FILLFACTOR`的方式来获得两全其美：

*   [顺序索引的填充因子为 PK](https://stackoverflow.com/questions/14187192/fill-factor-for-a-sequential-index-that-is-pk/14187367#14187367)

### [`pg_repack`](https://github.com/reorg/pg_repack/blob/master/doc/pg_repack.rst)/[`pg_squeeze`](https://github.com/cybertec-postgresql/pg_squeeze)

`CLUSTER`对表进行排他锁，这在多用户环境中可能是个问题。[引用手册：](https://www.postgresql.org/docs/current/sql-cluster.html)

> 当一个表被集群时，`ACCESS EXCLUSIVE`会在它上面获取一个锁。这可以防止任何其他数据库操作（**读取和写入**）在完成之前对表进行操作`CLUSTER`。

大胆强调我的。考虑替代方案！

[**`pg_repack`**](https://github.com/reorg/pg_repack/blob/master/doc/pg_repack.rst)：

> 与它不同`CLUSTER`的`VACUUM FULL`是它可以在线工作，在处理过程中不会对已处理的表持有独占锁。pg_repack 启动效率很高，性能堪比`CLUSTER`直接使用。

和：

> pg_repack 需要在重组结束时采取排他锁。

当前版本 1.4.7 适用于 PostgreSQL 9.4 - 14。

[**`pg_squeeze`**](https://github.com/cybertec-postgresql/pg_squeeze)是一种较新的替代方案，它声称：

> 事实上，我们尝试替换[`pg_repack`](https://reorg.github.io/pg_repack/)扩展名。

当前版本 1.4 适用于 Postgres 10 - 14。

### 询问

查询很简单，不会导致任何性能问题。

*然而，关于正确性*的一句话：[`BETWEEN`](https://www.postgresql.org/docs/current/functions-comparison.html)结构*包括*边界。您的查询选择 12 月 19 日的所有记录，*以及*12 月 20 日 00:00 时的记录。这是一个*极不可能*的要求。很有可能，你真的想要：

```
SELECT *
FROM   ticket 
WHERE  created >= '2012-12-19 0:0'
AND    created <  '2012-12-20 0:0'; 
```

### 表现

首先，你问：

> 为什么选择顺序扫描？

您的`EXPLAIN`输出清楚地显示了*Index Scan*，而不是顺序表扫描。一定是有什么误解。

您也许能够提高性能，但必要的背景信息不存在问题。可能的选项包括：

*   仅查询所需的列，而不是`*`降低传输成本（和其他性能优势）。

*   查看[**分区**](https://www.postgresql.org/docs/current/ddl-partitioning.html)并将实际时间片放入单独的表中。根据需要向分区添加索引。

*   如果分区不是一种选择，另一种相关但侵入性较小的技术是添加一个或多个[**部分索引**](https://www.postgresql.org/docs/current/indexes-partial.html)。
    例如，如果您主要查询*当前月份*，则可以创建以下部分索引：

    ```
     CREATE INDEX ticket_created_idx ON ticket(created)
      WHERE created >= '2012-12-01 00:00:00'::timestamp; 
    ```

    `CREATE`*新月开始前*的新指数。您可以使用 cron 作业轻松地自动执行任务。可以选择`DROP`为过去几个月的部分索引。

    保留*总*索引`CLUSTER`（不能对部分索引进行操作）。如果旧记录永远不会改变，表分区将对这项任务有很大帮助，因为您只需要重新集群新分区。
    再说一次，如果记录根本不改变，你可能不需要`CLUSTER`.

### 性能基础

您可能缺少其中一项基础知识。所有通常的性能建议都适用：

*   [https://wiki.postgresql.org/wiki/Slow_Query_Questions](https://wiki.postgresql.org/wiki/Slow_Query_Questions)
*   [https://wiki.postgresql.org/wiki/Performance_Optimization](https://wiki.postgresql.org/wiki/Performance_Optimization)

# php - wp_list_pages 在 3.5 中不起作用

> ID：13998144
> 
> 赞同：0
> 
> 时间：2012-12-21T22:44:22.280
> 
> 标签：php, wordpress

自更新到 3.5 以来，我用于输出子页面列表的代码不再有效。

```
<?php if(  $post->post_parent ) {
  $children = wp_list_pages("title_li=&child_of=".$post->post_parent."&echo=0&sort_order=ASC&sort_column=post_date");
} else {
  $children = wp_list_pages("title_li=&child_of=".$post->ID."&echo=0&sort_order=ASC&sort_column=post_date");
} 
```

任何人对可能导致它在 3.5 中停止输出的原因有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:22:08.277

`wp_list_pages()`在 WordPress 3.5 中没有改变。因此，您改变行为的原因可能在其他地方找到，可能是因为 WordPress 3.5 的新行为，但在您的代码之前发生了几行。你能在之前的每一步用断点检查执行吗？或者你能简单地给我们你的代码，包括前面的部分吗？（考虑到问题可能不在您隔离的这个小部分中）。

# php - 在文本文件中搜索字符串

> ID：13998145
> 
> 赞同：0
> 
> 时间：2012-12-21T22:44:25.650
> 
> 标签：php, text-files

我得到一个 user.txt 文件。以这种格式保存的所有用户：

```
Vorname: Michael | Nachname : Schmidt | Username: DarkDecipio | Passwort: 3609e297fb0b6fb1105cba71d5c024b3
Vorname: John | Nachname : Doe | Username: Dummy | Passwort: d78c03d72e72b44a131d255aec3c8a11 
```

现在，当新用户向 php 文件发送注册表单时，我想查看用户名是否已被占用。所以我必须搜索所有用户名，如果有发送的用户名。但我不能这样做`strstr()`或类似的东西，因为前名（Vorname）或姓氏（Nachname）可以与用户名相同。或者用户名可以包含发送的用户名的一部分......

希望你能理解。
注意：我知道将用户保存在文本文件中是一个丑陋的解决方案，但这是我学校的一个项目，我们必须使用文本文件......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:47:40.820

在我的脑海中，我可以想到两个选择。假设 $line 是文件中的当前行，并且您正在寻找“DarkDecipio”：

首先，使用正则表达式来确保你选择了你想要的部分：

```
if ( preg_match('/Username:\s*DarkDecipio/', $line) ) {
    echo 'Match';
} 
```

其次，用 | 分割行 然后在每个数组的第三个项目上使用 strstr：

```
$items = explode('|', $line);
if ( strstr($items[2], 'DarkDecipio') ) {
    echo 'Match';
} 
```

# php - cURL 和 fsockopen 哪个更快？

> ID：13998148
> 
> 赞同：1
> 
> 时间：2012-12-21T22:44:35.553
> 
> 标签：php, curl

我需要非常快速地调用两三个已知的 URL。我正在编写一个速度至关重要的命令行应用程序！

curl 会自己打开一个套接字吗？

有没有基准？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T22:48:48.210

我会说你最好使用 cURL（是的，它会打开自己的套接字），因为它比使用 fsockopen() 拼凑非标准客户端更了解 HTTP，朋友们*可能*会。

好吧——如果你真的需要超快的 HTTP 加载性能（定义“非常快”），你就必须使用 PHP 以外的东西*。*

**编辑：**页面是否经常更改？如果没有，（mem）在本地缓存它们的内容，你应该不会有太多问题。

# jquery-validation-engine - 在 jquery.validationEngine.js onValidationComplete 之后调用函数

> ID：13998154
> 
> 赞同：1
> 
> 时间：2012-12-21T22:45:25.373
> 
> 标签：jquery-validation-engine

我正在使用[jquery.validationEngine](http://github.com/posabsolute/jQuery-Validation-Engine) 并让它在我的注册和登录表单上工作。在将密码字段发送到服务器以进行额外的哈希处理并保存到数据库之前，我可以使用源自[此处评论的 javascript 对密码字段进行哈希处理。](http://www.wikihow.com/Discussion%3aCreate-a-Secure-Login-Script-in-PHP-and-MySQL)但是，我无法调用散列脚本然后让表单继续提交。谁能指出我正确的方向？

哈希脚本：

```
function formhash(form, password, p) {
p.value = hex_sha512(password.value);
password.value = ""; 
```

Validator 的相关负责人：我只是不知道用什么来代替一串问号。我尝试了许多不同的组合，但似乎无法得到它。验证有效，但如果验证通过，表单会在不运行我的 formhash 脚本的情况下提交。

```
<script>
jQuery(document).ready( function() {
    jQuery("#login").validationEngine('attach', 
    {onValidationComplete: function(form, status){
         if (status == true) {
             $("form#login").bind('submit', function(e) {
                  e.preventDefault();
              });
                   // your function or your action 
                   ???????????????????
              }
         }  
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T01:20:46.760

好吧，我想通了，我想我会分享给其他人学习这一切。关于验证器的文档不多，尽管我的主要问题是 javascript。请注意，如果出现错误，我希望验证器停止表单，并且如果验证通过，我的函数可以提交表单...

1.  删除绑定语句并将我的问题中的问号替换为您的函数

    ```
    <script>
    jQuery(document).ready( function() {
    jQuery("#formID").validationEngine('attach',{
    onValidationComplete: function(form, status){
    if (status == true){
    YourFunction();}}});
    });
    </script> 
    ```

2.  使用访问表单变量和提交表单的 DOM 方法，例如，

    ```
    function YourFunction() {
    var password = document.getElementById("password");
    document.forms["formID"].submit();
    } 
    ```

    为我工作。希望这对将来的人有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-21T02:48:28.197

是的，克里斯，onValidationComplete 需要一个布尔值

你需要

```
$('#form1').validationEngine('attach', {
onValidationComplete: function(form, status){
    if (status) {                   
        startProgressBar();
        YouFunctionPreLoad();
        return true;

    }
}           
}); 
```

# c# - 我将如何使用 EF-5 代码优先定义 1-1 关系

> ID：13998158
> 
> 赞同：0
> 
> 时间：2012-12-21T22:46:08.420
> 
> 标签：c#, vb.net, theory, entity-framework-5

我将如何为具有以下关系的实体框架 5 定义一组 POCO 类：

Primary 与 1-1 关系`Secondary.Data`，Primary 与 1-1 关系`Tertiary.Data`

```
 ---------(1)- Secondary.Data
Primary +
        ---------(1)- Tertiary.Data 
```

这样 Primary 有一个自动编号（SQL Server 中的 IDENTITY）主键（`Primary.PrimaryID`），并且每个子类主键也是 Primary 的外键（例如 `Secondary.Data.PrimaryID`，既是主键又是外键`Primary.PrimaryID`）

## 编辑

`Secondary`并`Tertiary`表示 SQL Server 中的架构，并在代码中由命名空间表示。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-27T19:01:19.710

在Primary类中如下：

```
 [Key, DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public int PrimaryID { get; set; }

    public virtual Secondary SecondaryEntity { get; set; }
    public virtual Tertiary TertiaryEntity { get; set; } 
```

在其他两个类中，您将为 ID 执行此操作：

```
 [Key, ForeignKey("PrimaryEntity")]
    public int PrimaryID { get; set; }

    public virtual Primary PrimaryEntity { get; set; } 
```

ForeignKey 属性需要指向您在对象上拥有的虚拟属性的名称，在本例中为 PrimaryEntity。

我希望这有帮助。

编辑：根据 Ladislav 对[这个问题](https://stackoverflow.com/questions/8547150/ef-code-first-how-to-register-same-table-name-with-different-schema)的回答以及我们在 Chat 中讨论的内容，您需要确保您的 Secondary 和 Tertiary 类虽然位于不同的命名空间和模式中，但具有不同的类名。

# c# - 多个异步调用

> ID：13998159
> 
> 赞同：0
> 
> 时间：2012-12-21T22:46:27.580
> 
> 标签：c#, async-await

我需要创建多个异步调用，例如

```
IList<Task> Ts = new List<Task>();
Ts.Add(GetInformationFromServer(ID)); 
```

但我没有在线程中等待，我从

所以应该可以这样做（旧方法之一，但有新方法吗？），来自另一个电话

```
GetInformation(string ID) {
   while (!Finish) {
      Thread.Sleep(100);
   }
   return _Information.First(a=>a.ID==ID);
 } 
```

我当然可以将任务保存在一个变量中，但是我该如何启动它们呢？我如何获得状态？
我想我可以在另一个线程中等待它们，但是如何检查它们是否完成？我应该自己实施吗？
以及如何启动它们（我应该只使用 Task.WhenAll 而不等待）？

**更新**

我想通了，我必须实现自己的方式，所以答案是这样的，但我需要使用 Task 而不是 Func

```
/// The executed elements
private IList<T> _ExecutedElements;

/// The Stack over the elements to be executed
private Stack<T> _ExecutingElements;

/// The method to be runned
private Func<object, Task<T>> _Method;

/// Should the while-loop start?
private bool _Running;

/// The Task
private Task<T> _Task;

/// Construct the class
/// <param name="Method">The function to be executed</param>
public MultiAsync(Func<object, T> Method) {
   _Method = Method;
}

/// Add an element
/// <param name="Item">The item to be added</param>
public void AddItem(T Element) {
   _ExecutingElements.Push(Element);
}

/// Execute the method
public async void ExecuteAsync() {

   // Set it to start running
   _Running = true;

   // While there are elements left
   while (_ExecutingElements.Count > 0) {

      // Check if it is not running, and if it isn't break out
      if (!_Running) { break; }

      // The current element
      T Element = default(T);

      // Pop out the element, that has not been runned through
      do { Element = _ExecutingElements.Pop(); }
      while (!_ExecutedElements.Contains(Element));

      // Check if there is an element, and if there is execute the method and await it
      if (Element != default(T)) {
         await ExecuteMethodAsync(Element);
      }
   }
}

/// Execute the item
/// <param name="Item">The item to be executed</param>
/// <returns>The executed item (due to reflection in FillInformation, the Item is filled)</returns>
public async Task<T> ExecuteItemAsync(T Item) {

   // Check if the item has not been executed, and if it is not executed
   if (!_ExecutedElements.Contains(Item)) {

      // Stop the while-loop
      _Running = false;

      // Check if the Task is running, and if it is await it
      if (_Task != default(Task) && !_Task.IsCompleted && !_Task.IsFaulted) {
         await _Task;
      }

      // Execute the method using the specific item
      await ExecuteMethodAsync(Item);
   }

   // Start the while-loop
   ExecuteAsync();

   // Return the element
   return Item;
}

/// Execute the method
/// <param name="Item">The item to run</param>
/// <returns>The Task to be executed</returns>
private async Task ExecuteMethodAsync(T Item) {

   // Set the Task
   _Task = _Method.Invoke(Item)

   // Start the task
   T Element = await _Task;

   // Add the item to the List
   _ExecutedElements.Add(Element);

   // Fill the information
   FillInformation(Element);
} 
```

通话是这样的

```
private async void FillTasksAsync(IEnumerable<Model.Task> Tasks) {
   _InfoLoader = new MultiAsync<Model.Task>(Tsk => { return GetTaskAsync(Tsk); });

   foreach (var Tsk in Tasks) {
      _InfoLoader.AddItem(Tsk);
   }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:09:49.610

我有一篇博客文章讨论了[异步初始化](http://nitoprograms.blogspot.com/2012/08/asynchronous-lazy-initialization.html)，这听起来像是您需要的。它源自 Stephen Toub 的一个原创想法。

在这种情况下，您可以使用：

```
List<AsyncLazy<string>> Ts = ...
Ts.Add(new AsyncLazy<string>(() => GetServerStringAsync(ID)); 
```

要开始一次下载，您可以执行以下操作：

```
Ts[0].Start(); 
```

当你需要它时，你可以这样做：

```
var result = await Ts[0]; 
```

如果尚未完成下载，它将（异步）等待它完成下载。如果它已经存在，那么您将立即获得结果。

# homebrew - OSX Lion - 无法删除 imagick

> ID：13998161
> 
> 赞同：3
> 
> 时间：2012-12-21T22:46:50.540
> 
> 标签：homebrew, imagick, rmagick

我正在尝试删除`imagick`，它是通过`brew`. 如果我运行`brew remove imagick`or `brew uninstall imagick`，我会得到

```
Error: No such keg: /usr/local/Cellar/imagick 
```

如何解决？谷歌并没有真正帮助我。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T22:48:12.957

尝试运行

```
brew doctor 
```

并按照说明进行操作。希望能解决它。

# django - Django 模板 [初学者]

> ID：13998163
> 
> 赞同：0
> 
> 时间：2012-12-21T22:46:59.260
> 
> 标签：django

我是 Django 的一个完整的菜鸟，并且已经在谷歌上搜索了一段时间，但我无法弄清楚这个模板的一部分在做什么。

[https://github.com/oppian/oppian/blob/master/oppianproj/templates/about.html](https://github.com/oppian/oppian/blob/master/oppianproj/templates/about.html)

```
{% load set_vars_from_json %}   
{% set_vars_from_json_block %}
    { "menu":
      [{"name":"About", "url":"{% url about %}"},
       {"name":"People", "url":"{% url people %}"},
       {"name":"Labs", "url":"{% url labs %}"},
       {"name":"Blog", "url":"{% url blog %}"},
       {"name":"Contact", "url":"{% url contact %}"}
      ]}   
{% end_set_vars_from_json_block %} 
```

为什么开发人员从 json_block 加载和设置变量？这有什么好处？我的猜测是菜单网址是动态更改的？

简单的附带问题：对于网站内容，例如其中的信息

```
<p>....</p> 
```

，这属于模板还是应该使用模块将其作为静态数据处理？

编辑：或者对于附带问题，如果我打算存储大量静态数据，我是否只是为每个页面创建一个模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:54:25.187

参考以下[网址](https://github.com/oppian/oppian/blob/master/oppianproj/apps/oppianapp/templatetags/set_vars_from_json.py)

`set_vars_from_json_block`是一个模板标签

```
{ "menu":
      [{"name":"About", "url":"{% url about %}"},
       {"name":"People", "url":"{% url people %}"},
       {"name":"Labs", "url":"{% url labs %}"},
       {"name":"Blog", "url":"{% url blog %}"},
       {"name":"Contact", "url":"{% url contact %}"}
      ]} 
```

这会加载 json 片段，并在模板标签中解析`end_set_vars_from_json_block`它以使其成为基于块的实现。

通过指定“类型”，您可以只保存一个模型。查看[Django Picklefield](http://pypi.python.org/pypi/django-picklefield/)

# php - 在 php 中获取和操作来自其他服务器的答案

> ID：13998167
> 
> 赞同：0
> 
> 时间：2012-12-21T22:47:11.460
> 
> 标签：php, mysql

我正在尝试在两台服务器之间进行某种通信（可以称为许可证验证）。

已经得到这个：

**索引.php**

```
if ($verification == 1) {
    echo "license validated";
}
else {
    echo "this license key does not exist.";
} 
```

**验证.php**

```
$license_key = mysql_real_escape_string($_GET['license_key']);

$query = "SELECT license_key FROM users WHERE license_key = '$license_key'";
$mysqli = new mysqli();
$mysqli->connect($db_hostname, $db_username, $db_password, $db_name);
if ($mysqli->connect_errno) {
    echo "Failed to connect to MySQL: " . $mysqli->connect_error;
}
$result = $mysqli->query($query);
$row_cnt = $result->num_rows;
if ($row_cnt == 1) {
    return true;
}
else {
    return false;
} 
```

我想不通的是如何将该请求从 index.php 发送到 validate.php （这两个文件不在同一服务器中）以及如何返回 index.php 信息它返回的内容（真或假）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:52:42.883

可能最简单的方法是设置服务。这是众多教程[之一。](http://www.9lessons.info/2012/05/create-restful-services-api-in-php.html)

例如，假设验证服务器的主机名为 val.com。您可以在那里设置一个服务，如下所示：

`val.com/validation/validate?dataToValidae=<validationString>`

如果您不希望它被拦截，请务必通过 SSL 发送请求。

然后，无论验证是否成功，您都可以让服务返回，然后在您的代码中检查它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:53:49.690

使用 file_get_contents：

```
$verify_result = file_get_contents("http://validation.domain.com/validate.php?license_key=$key");
if ($verify_result == 'license validated') {
  ...
} 
```

# mysql - MySQL UPDATE SET 字段等于 SELECT

> ID：13998172
> 
> 赞同：1
> 
> 时间：2012-12-21T22:47:36.123
> 
> 标签：mysql, insert-update

我正在尝试使用电子邮件地址更新几行。T1.email 将根据 T2.name 中存在的 T1.name 使用 T2.email 进行更新。

目前，查询如下所示。

```
UPDATE T1
SET T1.email = T2.email
FROM Table1 T1
INNER JOIN Table2 T2 ON T1.name = T2.name
WHERE T1.name = T2.name
AND (Some conditions)
LIMIT 1398 
```

这里提出了一个类似的问题，但给出了语法错误。 [SQL UPDATE SET 一列等于另一列引用的相关表中的值？](https://stackoverflow.com/questions/707371/sql-update-set-one-column-to-be-equal-to-a-value-in-a-related-table-referenced-b)

我也尝试过使用 ANY 进行更新。

```
UPDATE Table1
SET Table1.email = ANY
    (
        SELECT Table2.email FROM Table2 
        WHERE Table1.accountid = 901234 
        AND Table2.pid = 123 
        AND Table2.email IS NOT NULL 
    )

WHERE Table1.name IN
    (
        SELECT Table2.name FROM Table2
        WHERE Table1.accountid = 19574
        AND Table2.pid = 123 
        AND Table2.email IS NOT NULL
    ) 

LIMIT 1398 
```

目前，这会返回错误“SQL 错误 (1242)：子查询返回超过 1 行”。

可能是复制和粘贴工作的开始！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:49:39.907

正如[`UPDATE`语法](http://dev.mysql.com/doc/en/update.html)中详述的那样，对于您想要的 MySQL：

```
UPDATE Table1 T1 JOIN Table2 T2 USING (name)
SET    T1.email = T2.email
WHERE  (Some conditions)
LIMIT  1398 
```

# internet-explorer - 如何在 IE 8 中找到 knockoutjs 错误

> ID：13998181
> 
> 赞同：0
> 
> 时间：2012-12-21T22:48:32.467
> 
> 标签：internet-explorer, knockout.js

我有一个我开发的 knockoutjs 2.1.0 视图模型，它适用于 Firefox 和 Chrome，但不适用于 IE 8 或 9。当我在 IE 中打开开发人员视图时，我在控制台中没有收到任何错误消息，但视图从不被束缚。我有另一个在 IE、Chrome 和 FF 中都使用 Knockout 的应用程序。我正在寻找有关如何确定错误位置的建议。

**解决方案：** 解决方案是以下行

```
<script type="application/javascript"> 
```

代替

```
<script type="text/javascript"> 
```

Chrome & FF 不在乎，但 IE 不喜欢它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:08:24.210

您可以尝试调试它。在 处设置断点`ko.applyBindings`，开始调试，然后逐步执行代码。如果有任何例外，您应该得到通知。如果没有异常，您可以尝试查找执行路径与其他浏览器的不同之处。

如果没有显示错误消息，并且您无法通过调试找到它，请尝试缩小您的视图和模型。一次一件，直到它开始工作。

当您发现一个在 IE 上损坏的部分时，请尝试通过删除其他所有内容来隔离它。如果它需要多块才能破坏，您可能需要一次继续移除一块。

# android - 在向数据库中插入记录以验证是否存在之前

> ID：13998182
> 
> 赞同：0
> 
> 时间：2012-12-21T22:48:37.427
> 
> 标签：android, sqlite

在向数据库中插入一条记录以验证是否存在之前，例如，我有一个有两个字段的表，表字段 VA 和客户，首先，我想验证该字段是否没有客户注册，如果有插入

我想在 android 中使用 Sqlite

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T22:57:18.790

```
String sql = "SELECT * FROM TABLE WHERE id = '" + id + "'";
Cursor data = database.rawQuery(sql, null); 
```

After this check by following code

```
if (cursor.moveToFirst()) {
    // record exists
} else {
    // record not found
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T22:59:43.910

You have 2 possibilities :

1)make a select to check if there is the same key in database, then insert or update.

2)make directly an update. update will return the number of row updated, if the number is 0, so you can do an insert.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:02:39.397

查看 SQLite 约束。这真的不是 Android 特有的。这是 SQLite 的一个特性。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T23:08:59.937

试试这个，它对我有用。

```
String[] args = { myDataToCheck };
c = ourDatabase.query(DATABASE_TABLE, columns,
                    myColumnToCheck + "=?", args, null, null,  null);
            if (c.getCount() == 0) {
// doesn't exists 
 }else{
//exists
} 
```

# c# - 用foreach迭代字典，按什么顺序完成？

> ID：13998185
> 
> 赞同：15
> 
> 时间：2012-12-21T22:49:00.410
> 
> 标签：c#, .net, collections, dictionary

假设我有一个，然后按特定顺序`Dictionary`添加每个`key`和条目。 现在，如果我希望以后能够以添加条目的相同顺序对其进行迭代，这是我在这本字典上使用简单循环获得的顺序吗？ `value`
`Dictionary``foreach`

如果没有，我会很高兴听到我该怎么做，我知道这可以很容易地完成`List`，`Dictionary`但我不想这样做。

谢谢

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-21T22:58:39.260

Normal `Dictionary` does not guarantee order of items.

You need [`OrderedDictionary`](http://msdn.microsoft.com/en-us/library/system.collections.specialized.ordereddictionary(v=VS.80).aspx) if you want to maintain order items where added to it. Note that there is no generic version of this class in .Net framework, so either have to give up some type-safety or find other implementation (i.e. [https://www.codeproject.com/Articles/18615/OrderedDictionary-T-A-generic-implementation-of-IO](https://www.codeproject.com/Articles/18615/OrderedDictionary-T-A-generic-implementation-of-IO) as [suggested by Tim S](https://stackoverflow.com/questions/13998185/iterating-over-dictionary-with-foreach-in-what-order-is-this-done/13998263#comment19323194_13998263)).

Alternatively if O(log n) lookup is fine and keys should be sorted - [SortedDictionary](https://msdn.microsoft.com/en-us/library/f7fta44c(v=vs.110).aspx).

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T23:08:11.387

听起来你想要的是：http `Queue<T>`: [//msdn.microsoft.com/en-us/library/7977ey2c.aspx](http://msdn.microsoft.com/en-us/library/7977ey2c.aspx)

`KeyValuePair<T, U>`按照您想要的顺序将您的项目添加到其中，然后`foreach`按先进/先出顺序将其添加。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-21T22:52:59.297

`Dictionary`s 是哈希表，这意味着您不能保证迭代这些对将按照添加它们的相同顺序返回它们。

每对都是 a `KeyValuePair<T_K, T_V>`，因此您可以拥有 a `List<KeyValuePair<string, string>>`，如果这是您需要的话，您可以按照添加它们的顺序进行迭代。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-21T22:53:41.233

字典的内部排序将取决于使用的散列函数。但是，如果您需要数据的排序视图，您可以使用`Enumerable.OrderBy`.

# c++ - C++：查找 MS PowerPoint Viewer 的安装目录

> ID：13998195
> 
> 赞同：2
> 
> 时间：2012-12-21T22:50:05.970
> 
> 标签：c++, windows, winapi, registry

我想**从我的 C++ 应用程序中调用 MS PowerPoint Viewer 可执行文件 (PPTVIEW.exe)。**

我不想问用户，MS PowerPoint 查看器的安装位置。我相信，它不专业，并且依赖于用户做出适当的输入。相反，我希望能够自己识别安装目录的位置。

例如，MS PowerPoint Viewer 2007 的默认位置如下：

*   **c:\程序文件\microsoft office\office12\PPTVIEW.exe**

当然，这不一定总是正确的，尤其是不同的版本（2003、2007、2010）有不同的位置。

如果根本没有安装 MS PowerPoint 查看器，您能否建议**在哪里获得正确的路径，甚至更好地识别？**

注册表中一定有一些东西，但哪个键是正确的？

我用：

*   非托管 C++
*   需要兼容WinXP
*   应该与 bot 32 和 64 位操作系统兼容
*   应该能够识别2003年以后所有版本的Powerpoint Viewer的位置（包括。）

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T19:58:36.573

到目前为止，我发现的最佳解决方案是通过读取以下注册表项在注册表中搜索适当的路径：

*   **HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\pptview.exe**

上面的键为我提供了安装 PowerPoint Viewer 的位置。但是，我不知道该密钥是否存在于每个安装了 PowerPoint Viewer 的工作站中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-17T21:33:33.167

如果您将问题改写为“我想在我的 C++ 应用程序中以幻灯片模式显示幻灯片”。那么很容易通过查询注册的文件处理程序并使用适用的 COM 对象来实现这一点。

如果存在已注册的扩展处理程序，则将存在以下注册表项：

```
HKEY_CLASSES_ROOT\.pptx\ 
```

# ruby-on-rails - best_in_place gem：样式确定按钮

> ID：13998198
> 
> 赞同：2
> 
> 时间：2012-12-21T22:50:29.387
> 
> 标签：ruby-on-rails, font-awesome

[best_in_place](https://github.com/bernat/best_in_place)运行良好，但我想为可选的“确定”按钮使用[fontawesome](http://fortawesome.github.com/Font-Awesome/)图标，而不是字符串。如何将`'<i class="icon-ok"></i>'.html_safe`语法合并到`:ok_button`哈希中？

```
 = best_in_place @book, :default_price_amount, :html_attrs => {:class => 'medium_no_dropdown'}, :ok_button => "OK" 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-31T23:43:25.360

这是一个老问题，现在使用 :ok_button_class 选项在 best_in_place gem 中支持所需的功能。用法是这样的：

```
<%= best_in_place @post, :title, :ok_button => "Submit", :ok_button_class => "btn post-title" %> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T22:58:59.060

有一个解决方案，但不完全是向 ok_button 添加样式。如果您不介意使用 unicode glyphs ，可以尝试：

```
= best_in_place @book, :default_price_amount, :html_attrs => {:class => 'medium_no_dropdown'}, :ok_button => "&#x2713;".html_safe 
```

[包含所有 unicode](http://www.danshort.com/unicode/)字符的表可以作为您对另一个变体的参考。

ok_button 真正样式的问题在于，哈希仅接受数据属性来定义 button 。可能在 BIP 的下一个版本中，这将得到改进。

在创建按钮的源代码中（best_in_place.js）：

```
 if(this.okButton) {
    output.append(
      jQuery(document.createElement('input'))
      .attr('type', 'submit')
      .attr('value', this.okButton)
    )
  } 
```

'value' 是我们传递给 hash 的值。如果有办法引用由 awesome font ( `&#xf00c;`for icon-ok) 定义的 glyph-codes ，那就太好了。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-02-14T07:23:35.297

由于我花了几个小时来做​​同样的事情，我发现我们可以覆盖[这个函数](https://github.com/bernat/best_in_place/blob/bc00bb7912193ea5c9c8984455cb5fe01905e6cb/lib/assets/javascripts/best_in_place.js#L356-L375)的原型来创建`<button>`而不是`<input type="button">`. 但是，该[`activateForm`函数](https://github.com/bernat/best_in_place/blob/bc00bb7912193ea5c9c8984455cb5fe01905e6cb/lib/assets/javascripts/best_in_place.js#L410)只等待点击事件`input[type="button"]`，因为我无法覆盖它，所以我尝试了另一种（有点脏）的方法——它可以工作。

在另一个 js 标记/文件处覆盖此脚本

```
 BestInPlaceEditor.prototype.placeButtons = function (output, field){
    'use strict'
    // the ok button isn't changed
    if (field.okButton) {
      output.append(
        jQuery('<button>').html(field.okButton).attr({
          type: 'submit',
          class: field.okButtonClass
        })
      )
    }

    if (field.cancelButton) {
      // create new cancel "<button>"
      var $resetBtn = jQuery('<button>').html(field.cancelButton).attr({
        type: 'reset',
        class: field.cancelButtonClass
      }),
      // and traditional cancel '<input type="button">', but this should be hidden
      $_resetBtn = jQuery('<input>').val(field.cancelButton).css({ display: 'none' })
      .attr({
        type: 'button',
        class: '__real-btn-close-best_in_place'
      });
      // and bind event to 'trigger' click traditional button when the new <button> is clicked 
      $resetBtn.bind('click', function (event) {
        $(event.currentTarget).parents('form.form_in_place').find('input.__real-btn-close-best_in_place').trigger('click');
        event.stopPropagation(); // << also neccessary
      });
      // append both
      output.append($_resetBtn).append($resetBtn);
    }
  }
} 
```

# c# - 如何将表单设置在屏幕中心？

> ID：13998201
> 
> 赞同：3
> 
> 时间：2012-12-21T22:50:49.063
> 
> 标签：c#

我正在使用这段代码：

```
private void notifyIcon1_MouseDoubleClick(object sender, MouseEventArgs e)
{
    this.Show();
    this.WindowState = FormWindowState.Normal;
    //this.Location = new Point(form1_location_on_x, form1_location_on_y);
    //this.StartPosition = FormStartPosition.CenterScreen; 
```

无论是线

```
this.Location = new Point(form1_location_on_x, form1_location_on_y); 
```

或线

```
this.StartPosition = FormStartPosition.CenterScreen; 
```

当我使用原始屏幕分辨率 1920x1080 时正在工作，但是一旦我将分辨率更改为 1024x768，表单就在右下角没有隐藏我看到它全部但它不在中心。

form1_location_on_x 和 on_y 是：

```
form1_location_on_x = this.Location.X;
form1_location_on_y = this.Location.Y; 
```

问题是我应该怎么做才能使其适用于任何其他分辨率，如 1024x768 或任何其他分辨率？我尝试了很多改变，但到目前为止没有任何效果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:04:59.120

```
Size screenSize = Screen.PrimaryScreen.WorkingArea.Size;
Location = new Point(screenSize.Width / 2 - Width / 2, screenSize.Height / 2 - Height / 2); 
```

确保您设置 `StartPosition = FormStartPosition.Manual;`

经过测试并使用 1920x1080 和 1024 x 768

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:00:14.850

您可以使用以下公式计算表单的顶部和左侧位置：

```
int formWidth = yourForm.Width;
int formHeight = yourForm.Height;
int screenH = (Screen.PrimaryScreen.WorkingArea.Top + 
              Screen.PrimaryScreen.WorkingArea.Height) / 2;
int screenW = (Screen.PrimaryScreen.WorkingArea.Left + 
              Screen.PrimaryScreen.WorkingArea.Width) / 2;

int top = screenH - formWidth / 2;
int left = screenW - formHeight / 2;
yourForm.Location = new Point(top, left); 
```

当然，这些天来，您遇到了双显示器的问题。
我不知道您是否希望您的表单始终出现在主屏幕上，或者您希望表单出现在当前屏幕（当前显示表单的屏幕）中。在第二种情况下，您需要找到表单的显示位置

```
private void CenterForm(Form yuorForm)
{    
    foreach(var s in Screen.AllScreens)
    {
       if(s.WorkingArea.Contains(yourForm.Location))
       {
            int screenH = s.WorkingArea.Height / 2;
            int screenW = s.WorkingArea.Width / 2;

            int top = (screenH + s.WorkingArea.Top) - formWidth / 2;
            int left = (screenW + s.WorkingArea.Left) - formHeight / 2;
            yourForm.Location = new Point(top, left);
            break;
       }
    }
} 
```

编辑：感谢@alex，我将使用[SystemEvents](http://msdn.microsoft.com/en-us/library/microsoft.win32.systemevents%28v=vs.100%29.aspx)类的信息完成答案

如果您想在用户突然更改屏幕分辨率时收到系统通知，您可以订阅该事件`SystemEvents.DisplaySettingsChanged`（`using Microsoft.Win32;`需要）

```
SystemEvents.DisplaySettingsChanged += new EventHandler(SystemEvents_DisplaySettingsChanged); 
```

然后在事件中处理表单的重新定位

```
// This method is called when the display settings change.
void SystemEvents_DisplaySettingsChanged(object sender, EventArgs e)
{
    RecenterForm(yourForm);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-13T11:01:18.860

在调整大小后尝试使用其中之一：

```
this.CenterToScreen(); 
```

或者

```
this.CenterToParent(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-02-20T07:08:36.070

您可以使用对象的`StartPosition` *属性*。`Form`它决定了表单的**位置**。`CenterScreen`如果您希望表单在屏幕中央打开，请将其值设置为

# java - 未找到方法 init()v

> ID：13998202
> 
> 赞同：16
> 
> 时间：2012-12-21T22:50:51.273
> 
> 标签：java, parameters, applet

我正在重写我拥有的一个小程序，但是当它加载时它给了我一个运行时异常。例外是

```
Exception in thread "main" java.lang.NoSuchMethodError: ClientSettings: method <
init>()V not found
        at RunClient.<init>(RunClient.java:41)
        at RunClient.main(RunClient.java:63) 
```

这是运行客户端：

```
import java.applet.Applet;
import java.awt.BorderLayout;
import java.awt.Container;
import java.awt.Desktop;
import java.awt.Dimension;
import java.awt.Rectangle;
import java.awt.Robot;
import java.awt.Toolkit;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.image.BufferedImage;
import java.io.File;
import java.io.FilenameFilter;
import java.io.IOException;
import java.net.URI;
import java.net.URISyntaxException;
import java.net.URL;
import java.util.Properties;

import javax.imageio.ImageIO;
import javax.swing.JFrame;
import javax.swing.JMenu;
import javax.swing.JMenuBar;
import javax.swing.JMenuItem;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JPopupMenu;
import javax.swing.JSeparator;

public class RunClient extends Applet implements ActionListener {

    private Robot robot;
    private static final long serialVersionUID = 1L;
    public static Properties params = new Properties();
    public JFrame mainFrame;
    public JPanel mainPane = new JPanel();
    public static String[] data;
    public String mainurl = getParameter("ip");
    public int lang = 0;
    public String frameName = getParameter("servername");
    public JPanel totalPanel;
    private JMenuBar menuBar = new JMenuBar();
    private int capNum;
    private FilenameFilter filter = new FilenameFilter() {

        @Override
        public boolean accept(File arg0, String arg1) {
            if (arg0.getName().equals("images") && arg1.endsWith("png")) {
                return true;
            }
            return false;
        }

    };
    public static final Object[][] JMENU_BUTTONS = new Object[][]{{"File", new JMenuItem("New Client"), new JSeparator(), new JMenuItem("Exit")}, {"Guides", new JMenuItem("Getting Started"), new JMenuItem("Fighting Monsters"), new JMenuItem("Money Making")}, {"Links", new JMenuItem("Wiki"), new JMenuItem("Forums"), new JMenuItem("Youtube"), new JMenuItem("Donate")}, {"Tools", new JMenuItem("Take a screenshot")}};
    public String[] getLoaderParameters() {
        return new String[]{getParameter("servername"), getParameter("ip"), getParameter("port")};
    }
    public static void main(String[] strings) {
        data = getLoaderParameters();
        new ClientSettings(data);
        RunClient runclient = new RunClient();
        runclient.doFrame();
    }

    public RunClient() {
        try {
            loadCaptureAmts();
            robot = new Robot();
        } catch(Exception e) {
            e.printStackTrace();
        }
    }

    private void loadCaptureAmts() {
        capNum = new File("./images/").listFiles(filter).length;
    }

    public void init() {
        doApplet();
    }

    void doApplet() {
        try {
            readVars();
            startClient();
        } catch (Exception exception) {
            exception.printStackTrace();
        }
    }

    public void doFrame() {
        try {
            readVars();
            openFrame();
            startClient();
        } catch (Exception exception) {
            exception.printStackTrace();
        }
    }

    public void readVars() throws IOException {
        params.put("cabbase", "g.cab");
        params.put("java_arguments", "-Xmx1024m -Dsun.java2d.noddraw=true");
        params.put("colourid", "0");
        params.put("worldid", "16");
        params.put("lobbyid", "15");
        params.put("demoid", "0");
        params.put("demoaddress", "");
        params.put("modewhere", "0");
        params.put("modewhat", "0");
        params.put("lang", "0");
        params.put("objecttag", "0");
        params.put("js", "1");
        params.put("game", "0");
        params.put("affid", "0");
        params.put("advert", "1");
        params.put("settings", "wwGlrZHF5gJcZl7tf7KSRh0MZLhiU0gI0xDX6DwZ-Qk");
        params.put("country", "0");
        params.put("haveie6", "0");
        params.put("havefirefox", "1");
        params.put("cookieprefix", "");
        params.put("cookiehost", "127.0.0.1");
        params.put("cachesubdirid", "0");
        params.put("crashurl", "");
        params.put("unsignedurl", "");
        params.put("sitesettings_member", "1");
        params.put("frombilling", "false");
        params.put("sskey", "");
        params.put("force64mb", "false");
        params.put("worldflags", "8");
        params.put("lobbyaddress", mainurl);
    }

    public void openFrame() {
        JPopupMenu.setDefaultLightWeightPopupEnabled(false);
        mainPane.setLayout(new BorderLayout());
        mainPane.add(this);
        mainPane.setPreferredSize(new Dimension(765, 503));
        totalPanel = new JPanel();
        totalPanel.setPreferredSize(new Dimension(765, 503));
        totalPanel.setLayout(new BorderLayout());
        totalPanel.add(mainPane, BorderLayout.CENTER);
        mainFrame = new JFrame(frameName);
        mainFrame.setLayout(new BorderLayout());
        mainFrame.getContentPane().add(totalPanel, BorderLayout.CENTER);
        mainFrame.setDefaultCloseOperation(3);
        //setMenuBar();
        mainFrame.pack();
        mainFrame.setVisible(true);
    }

    private void setMenuBar() {
        int id = 0;
        for (int y = 0; y < JMENU_BUTTONS.length; y++) {
            JMenu menu = new JMenu();
            for (int i = 0; i < JMENU_BUTTONS[y].length; i++) {
                if (i == 0) {
                    menu.setText((String) JMENU_BUTTONS[y][i]);
                } else if (JMENU_BUTTONS[y][i] instanceof JMenuItem){
                    JMenuItem item = (JMenuItem) JMENU_BUTTONS[y][i];
                    menu.add(item);
                    item.setActionCommand(""+ id++);
                    item.addActionListener(this);
                } else {
                    menu.add((JSeparator) JMENU_BUTTONS[y][i]);
                }
            }
            menuBar.add(menu);
        }
        mainFrame.setJMenuBar(menuBar);

    }

    public void startClient() {
        try {
            //RuntimeLoader loader = new RuntimeLoader();
            //Class clientclass = loader.loadClass("client");

            //Applet clientApplet = (Applet) clientclass.newInstance();
            //clientclass.getMethod("provideLoaderApplet",
            //      new Class[] { java.applet.Applet.class }).invoke(null,
            //              new Object[] { this });
            //clientApplet.init();
            //clientApplet.start();
            client.provideLoaderApplet(this);
            client var_client = new client();
            var_client.init();
            var_client.start();
        } catch (Exception exception) {
            exception.printStackTrace();
        }
    }

    public URL getDocumentBase() {
        return getCodeBase();
    }

    public URL getCodeBase() {
        URL url;
        try {
            url = new URL(new StringBuilder().append("http://").append(mainurl)
                    .toString());
        } catch (Exception exception) {
            exception.printStackTrace();
            return null;
        }
        return url;
    }

    @Override
    public void actionPerformed(ActionEvent e) {
        switch (Integer.parseInt(e.getActionCommand())) {
        case 1:
            if (JOptionPane.showConfirmDialog(this, "Are you sure you want to quit?") == 0)
                System.exit(0);
            break;
        case 2:
            browse("http://dementhium.wikia.com/wiki/Getting_Started");
            break;
        case 3:
            browse("http://forums.dementhium.com/showthread.php?t=143");
            break;
        case 4:
            browse("http://dementhium.wikia.com/wiki/Dementhium_Wiki");
            break;
        case 5:
            browse("http://dementhium.wikia.com/wiki/Dementhium_Wiki");
            break;
        case 6:
            browse("http://forums.dementhium.com/");
            break;
        case 7:
            browse("http://www.youtube.com/DementhiumOfficial");
            break;
        case 8:
            browse("http://forums.dementhium.com/payments.php");
            break;
        case 9:
            writeImage(robot.createScreenCapture(getGameScreenRectangle()));
            break;
        default:
            System.out.println(Integer.parseInt(e.getActionCommand()));
        }

    }

    private Rectangle getGameScreenRectangle() {
        Rectangle rect = getBounds();
        rect.setLocation(this.getLocationOnScreen());
        return rect;
    }

    private void writeImage(BufferedImage createScreenCapture) {
        try {
            ImageIO.write(createScreenCapture, "PNG", new File("./images/capture-" + capNum++ + ".png"));
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    private void browse(String string) {
        if (Desktop.isDesktopSupported() && Desktop.getDesktop().isSupported(Desktop.Action.BROWSE)) {
            try {
                Desktop.getDesktop().browse(new URI(string));
            } catch (IOException e1) {
                e1.printStackTrace();
            } catch (URISyntaxException e1) {
                e1.printStackTrace();
            }
        }

    }

} 
```

这是ClientSettings.java，它是从各种文件中调用的，args总是使用定义的

```
public String[] data; 
```

在 RunClient 中

```
public class ClientSettings {
    public int PORT;
    public String IPADDRESS;
    public String SERVERNAME;
    public ClientSettings(String[] args) {
        PORT = Integer.parseInt(args[2]);
        IPADDRESS = args[1];
        SERVERNAME = args[0];

    }
    } 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-12-21T22:53:53.447

第 41 行`RunClient`正在寻找`ClientSettings`不存在的默认构造函数。您已经定义了一个接受 a 的构造函数`String[]`，因此不会生成默认构造函数。看起来您发布的代码不是正在运行的代码，因为它似乎显示了正确的构造函数调用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-06-04T13:22:50.610

我有同样的问题，但是在编写单元测试时。创建我要测试的对象时，测试失败并出现此异常。我确实在我正在测试的类中添加了一个新的构造函数，我认为我正在运行一个没有这个构造函数的旧代码。清理和重建工作区（使用 maven）为我解决了这个问题。

# ios - 如何防止 UIImageView 使用 Autolayout 调整大小

> ID：13998203
> 
> 赞同：1
> 
> 时间：2012-12-21T22:50:53.537
> 
> 标签：ios, ios6, uiimageview, autolayout

我正在使用自动布局重新创建我的 UI，并在顶部有一个导航栏和一个 2x2 的 UIImageView 网格填充屏幕的其余部分。我设置了所有约束，因此它可以在任何方向上保持这种排列，并且当 UIImageViews 中没有图像时它运行良好。当我以编程方式在 UIImageViews 中加载图像时，它们会改变大小和位置，即使我有应该阻止这种情况的约束。

我为所有内容关闭了所有自动调整大小的遮罩，并将 UIImageViews 设置为 Aspect fit。

这种自动布局的东西对我来说是新的，但我认为我已经让它工作了......直到我在那里放了一张图片。为什么这会改变 UIImageViews 的大小和位置？

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T06:58:23.070

如果将它们与视图控制器中的插座链接，则可以在运行时修改它们。

对于您的情况，您将添加宽度和高度约束并将它们链接到两个出口。然后在您知道图像尺寸后，您将更改常量值。

我正在详细描述我在这里遇到的类似用例：http: [//www.cocoanetics.com/2012/11/first-good-auto-layout-use-case/](http://www.cocoanetics.com/2012/11/first-good-auto-layout-use-case/)

# vbscript - 最小化窗口，应用程序启动

> ID：13998205
> 
> 赞同：1
> 
> 时间：2012-12-21T22:51:10.840
> 
> 标签：vbscript, minimize

有没有办法在启动应用程序时自动最小化所有窗口？

我尝试使用上述内容调用 .vbs 文件：

```
Set shell = wscript.CreateObject("Shell.Application")
Shell.MinimizeAll 
```

但是这样做，应用程序也被最小化了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:43:39.453

我不确定这是否会最小化窗口，但它可能会满足您的要求：

```
set objShell = CreateObject("shell.application")
objShell.ToggleDesktop 
```

这相当于单击显示桌面按钮。

或者只是扩展您的代码：

```
shell.ToggleDesktop 
```

编辑：没关系......这与您上面的代码相同。但是为什么不直接运行它然后显示你的窗口呢？例如，如果它是您的应用程序...调用 vbs 然后显示窗口。或者，如果您无法控制该应用程序，请从 .bat 文件中调用它并运行此 vbs，然后运行您的程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-02-09T22:35:13.103

您要做的是首先最小化所有应用程序或切换桌面；然后（也许甚至在延迟之后）打开您的应用程序。

# r - R lubridate 将秒转换为日期

> ID：13998206
> 
> 赞同：28
> 
> 时间：2012-12-21T22:51:13.603
> 
> 标签：r, lubridate

我有一个关于 R 的 lubridate 包的简单问题。自纪元以来，我有一系列以秒为单位的时间戳。我想将其转换为 YYYY-MM-DD-HH 格式。在base R中，我可以做这样的事情首先将其转换为日期格式

```
> x = as.POSIXct(1356129107,origin = "1970-01-01",tz = "GMT")
> x
[1] "2012-12-21 22:31:47 GMT" 
```

请注意，上面只是将其转换为日期格式，而不是 YYYY-MM-DD-HH 格式。我将如何在 lubridate 中做到这一点？我将如何使用基础 R 来做到这一点？

非常感谢提前

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2017-10-13T17:18:17.480

*`lubridate`*有一个`as_datetime()`恰好将 UNIX 纪元时间作为默认*起始*时间，以使这变得非常简单：

```
> as_datetime(1356129107)
[1] "2012-12-21 22:31:47 UTC" 
```

更多细节可以在这里找到：[https ://rdrr.io/cran/lubridate/man/as_date.html](https://rdrr.io/cran/lubridate/man/as_date.html)

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2012-12-21T23:21:34.203

德克是正确的。但是，如果您打算使用 lubridate 函数：

```
paste( year(dt), month(dt), mday(dt), hour(dt) sep="-") 
```

另一方面，如果您想以`POSIXct`应该使用的方式处理对象，那么这应该满足：

```
format(x, format="%Y-%m-%d-%H") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-04T16:41:12.647

I use the lubridate solution provided by @leerssej

But in case anyone prefers @IRTFM's solution in base R, but *also wants minutes and seconds*, here's an example of how to do that:

```
as.POSIXct("2019-03-15 16:17:42" , format="%Y-%m-%d %H:%M:%OS") 
```

# r - 从矩阵中提取后访问丢失的列名

> ID：13998208
> 
> 赞同：2
> 
> 时间：2012-12-21T22:52:10.853
> 
> 标签：r, matrix

我有一个矩阵：

```
a<-c(0,1,3,5,56,3)
b<-c(1,4,3,10,3,50)
c<-cbind(a,b)
c<-as.matrix(c) 
```

然后我创建了一个 c 的子集：

```
d<-c[1,1] 
```

我想获得 d 的列名。colnames(d) 不起作用。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T22:58:48.413

`[` will drop dimensions by default when possible, which here causes the structure to change from a matrix to a vector. Disable this behavior:

```
x <- cbind(a,b)
d <- x[1,1,drop=FALSE]

> colnames(d)
[1] "a" 
```

Note that you didn't lose the names. They just were no longer column names:

```
d <- x[1,1]
names(d)
[1] "a" 
```

In the case where you have row and column names, and use the default of `drop=TRUE` while choosing a single element, names will not be present in the result. R can't know whether you want to retain row or column names.

```
rownames(x) <- letters[7:12]
names(x[1,1])
NULL 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T16:32:07.147

尝试使用“names”而不是“colnames”

```
names (d)

[1] "a" 
```

# php - PHP 提取字符串的一部分

> ID：13998209
> 
> 赞同：2
> 
> 时间：2012-12-21T22:52:31.747
> 
> 标签：php, string, extract, substr

我知道对此有很多疑问，但似乎没有简单的方法可以做我想做的事。以以下字符串为例：

```
expires  Friday, December 21, 2012 @ 11:59pm ET
expires  Saturday, December 22, 2012 @ 9:59pm ET 
```

两个字符串相似，但以下代码不一致：

```
echo substr($string, 14, 27); 
```

因为它输出以下内容：

```
Friday, December 21, 2012 @
Saturday, December 21, 2012 
```

显然，我不想保留 @ 符号。有没有办法在删除“过期”和“@##:##pm ET”的同时简单地保留日期？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T22:55:07.010

```
preg_replace('/expires\s*(.*?)@/', '\1', $string); 
```

你也不需要使用正则表达式，但我会因为它看起来更简单。这是一个非正则表达式解决方案：

```
//I took 14 from you, but it seems to be 9
substr($string, 14, strpos($string, '@') - strlen($string)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:14:39.033

你想看看[http://php.net/manual/wn/function.strpos.php](http://php.net/manual/wn/function.strpos.php)

strpos "查找字符串中子字符串第一次出现的位置"

所以你想做这样的事情：

```
$string = "expires  Friday, December 21, 2012 @ 11:59pm ET";
$string = str_replace("expires ", "", $string); //remove "expires "
$string = substr($string, 0, strpos($string, "@")-1); // Copy anthing up to the first "@"
echo($string); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:18:17.783

我必须在我工作的网站上格式化完全相同的字符串。这就是我使用的。似乎工作正常：

```
 <?PHP

function FormatDate($string)
    {
        $exploded = explode(" ", $string);
        $newstring = $exploded['2']." ".$exploded['3']." ".$exploded['4']." ".$exploded['5'];
        return $newstring;
    }

echo FormatDate('expires  Friday, December 21, 2012 @ 11:59pm ET'); 
```

# java - 从任意位置加载自定义类

> ID：13998210
> 
> 赞同：3
> 
> 时间：2012-12-21T22:52:36.473
> 
> 标签：java, dynamic, classloader, urlclassloader, classnotfound

我在 Java 中的类加载有一些问题。在我的项目中，我试图从任何地方动态加载一个类。但是，我目前无法加载硬编码的文件，并且经过 6 小时的谷歌搜索和堆栈溢出检查后仍然一无所知。

我怀疑我正在加载的类的包名有问题。我的目标是在*project/resources/dynamicFolderNonInClassPath/loadThis*目录中加载 Class *LoadAClass.java 。*由于我将我的 URLClassLoader 设置为上面的文件夹，因此它的包已设置为

 *```
package loadThis;

public class LoadAClass{
static{
System.out.println("I am loaded");
}

(...)
} 
```

但是我不断收到一个类未找到异常。

```
File file = new File("C:/Users/Robert/Documents/workspace/project/resources/dynamicFolderNonInClassPath/");
if (!file.exists()) System.out.println("typo!"); //debug print
URL url = file.toURI().toURL();
URLClassLoader loader = new URLClassLoader(new URL[]{url});
String classToBeLoaded = "loadThis.LoadAClass";

Class classy = loader.loadClass(classToBeLoaded);
System.out.println(classy.getCanonicalName()); //debug print 
```

我尝试了不同的组合，例如直接将 URLClassLoader 设置为文件或将完整的*/resources/dynamicFolderNonInClassPath/loadThis*作为 URL 但到目前为止没有成功。

有圣诞气氛的人看到问题了吗？我对这个功能似乎有一些误解，我希望看到它得到修复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:58:48.350

.java 文件不是类文件。你编译过吗？您需要在“loadThis”目录中创建一个 LoadAClass.class 文件，并且您的类加载器指向包含“loadThis”的目录。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:00:33.637

您缺少正斜杠“/”

```
File file = new File("C:/Users/Robert/Documents/workspace/project/resources/dynamicFolderNonInClassPath");
if (!file.exists()) System.out.println("typo!"); //debug print
URL url = new URL("C:/Users/Robert/Documents/workspace/project/resources/dynamicFolderNonInClassPath/");
URLClassLoader loader = new URLClassLoader(new URL[]{url});
String classToBeLoaded = "loadThis.LoadAClass";

Class classy = loader.loadClass(classToBeLoaded);
System.out.println(classy.getCanonicalName()); //debug print 
```

见第三行*

# php - 如何从 ODBC 查询中转义单引号

> ID：13998213
> 
> 赞同：4
> 
> 时间：2012-12-21T22:52:42.637
> 
> 标签：php, mysql, odbc

> **可能重复：**
> [在传递给 ODBC 之前转义输入数据的正确方法](https://stackoverflow.com/questions/5713837/correct-way-to-escape-input-data-before-passing-to-odbc)

我从查询 ODBC 查询中得到的错误是：

```
(pos: 72 '...M = 'Owen O'^Donavon' AND...') - syntax error 
```

当我试图逃避它时：

```
(pos: 73 '... = 'Owen O\'^Donavon' AND...') - syntax error 
```

^ 表示它正在中断的地方

我尝试了以下方法：

```
NAM = '".$var."' 
```

还有这个：

```
NAM = '".mysql_escape_string($var)."' 
```

然后我绝望了

```
NAM = \"".$var."\" 
```

其中 $var 是其中包含 ' 的任何名称。

如果您需要整个查询：

```
UPDATE TABLE SET COLUMN1 = 'ERR' WHERE COLUMN_NAM = '".mysql_escape_string($var)."' AND COLUMN7 = 0"); 
```

有人知道我怎样才能正确地逃脱报价吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:14:50.917

要在 MySQL 字符串文字中包含单引号（由单引号分隔），请使用两个单引号字符。例如

```
'I don''t like it' 
```

实际上，当 MySQL 解析它时，它将看到两个单引号字符，并将其解释为文字中的一个单引号，而不是看到字符串文字的“结束”。

但是（正如您所发现的）当您在那里只有一个单引号时，MySQL 解析器对其进行了调整。考虑这个例子：

```
'I don't like it' 
```

MySQL 解析器看到的是一个字符串文字，长度为五个字符，包含`'I don'`. 然后 MySQL 认为该文字后面跟着一些需要解析的标记：`t like it`. 解析器不会将其视为字符串文字的一部分。前面的单引号标记了字符串文字的结尾。

所以现在，MySQL 解析器无法对`t like it`应该是什么做出正面或反面。它将这些标记后面的单引号视为另一个字符串文字的开头。（因此，您可以非常聪明地了解那里出现的内容，并设法获得 MySQL 确实理解的东西......这可能会更糟。）

（注意：此问题并非特定于 ODBC；这会影响在 MySQL 查询文本中使用字符串文字的客户端。）

* * *

避免此类问题的一种方法是在查询文本中使用绑定变量，而不是字符串文字。（但是对于 MySQL，无论如何，发生的事情是转义，发送到 MySQL 服务器的内容（可以说是在幕后）是字符串文字。

有时我们确实需要在查询文本中包含字符串文字，并且我们不应该被要求使用绑定变量作为解决方法。因此，最好知道如何在用单引号括起来的字符串文字中“转义”单引号。

# java - 切换活动出现错误

> ID：13998214
> 
> 赞同：0
> 
> 时间：2012-12-21T22:52:51.867
> 
> 标签：java, android, android-activity

我想从登录活动切换......我有所有的表格，但是当我点击按钮时......它会强制关闭。

这是我的代码。

头等舱

```
public class MainActivity extends Activity {
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    final EditText pass = (EditText)findViewById(R.id.editText1);
    final Intent myIntent = new Intent(getApplicationContext(), Menu.class);

    String mydate = java.text.DateFormat.getDateInstance().format(Calendar.getInstance().getTime());

    TextView fecha = (TextView)findViewById(R.id.textView2);
    fecha.setText(mydate);

    Button next = (Button) findViewById(R.id. button1);
    next.setOnClickListener(new View.OnClickListener() {
        public void onClick(View v) {

            if("12345".equals(pass.getText().toString())) {
            //Toast.makeText(getApplicationContext(), "Clave Correcta", Toast.LENGTH_SHORT).show();

            startActivity(myIntent);
            }
            else {

                Toast.makeText(getApplicationContext(), "Clave Incorrecta", Toast.LENGTH_SHORT).show();

            }
        }

    });

} 
```

二等。

```
public class Menu extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.menu);

} 
```

}

原木猫：

```
12-21 17:04:53.710: E/Trace(2389): error opening trace file: No such file or directory (2)
12-21 17:04:57.680: E/AndroidRuntime(2389): FATAL EXCEPTION: main
12-21 17:04:57.680: E/AndroidRuntime(2389): android.content.ActivityNotFoundException: Unable to find explicit activity class {com.example.pizzasjaps/android.view.Menu}; have you declared this activity in your AndroidManifest.xml?
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.Instrumentation.checkStartActivityResult(Instrumentation.java:1541)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.Instrumentation.execStartActivity(Instrumentation.java:1416)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.Activity.startActivityForResult(Activity.java:3351)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.Activity.startActivityForResult(Activity.java:3312)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.Activity.startActivity(Activity.java:3522)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.Activity.startActivity(Activity.java:3490)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at com.example.pizzasjaps.MainActivity$1.onClick(MainActivity.java:39)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.view.View.performClick(View.java:4084)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.view.View$PerformClick.run(View.java:16966)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.os.Handler.handleCallback(Handler.java:615)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.os.Handler.dispatchMessage(Handler.java:92)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.os.Looper.loop(Looper.java:137)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at android.app.ActivityThread.main(ActivityThread.java:4906)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at java.lang.reflect.Method.invokeNative(Native Method)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at java.lang.reflect.Method.invoke(Method.java:511)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:791)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:558)
12-21 17:04:57.680: E/AndroidRuntime(2389):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:56:38.173

```
if("12345".contentEquals(pass.getText().toString())) 
```

AND

```
final Intent myIntent = new Intent(MainActivity.this, Menu.class); 
```

Try this?

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T22:57:33.780

From your LogCat:

```
Unable to find explicit activity class {com.example.pizzasjaps/android.view.Menu} 
```

This line is trying to load the class `android.view.Menu` instead of *your* Menu Activity:

```
final Intent myIntent = new Intent(getApplicationContext(), Menu.class); 
```

Scope `Menu` to the appropriate class (and consider using `this` instead of `getApplicationContext()`):

```
final Intent myIntent = new Intent(this, com.example.pizzasjaps.Menu.class); 
```

# excel - 分组计数值

> ID：13998218
> 
> 赞同：2
> 
> 时间：2012-12-21T22:53:04.320
> 
> 标签：excel, excel-formula

我有一张桌子，学生证按组分开。我需要一种方便的方法来计算每组中的学生总数，并将其填充在每组的最后一行之后（标有`??`）

![在此处输入图像描述](../Images/83011927f7ae205a82754bbaebd56dc9.png)

目前我只是输入`=COUNT()`然后手动找出每个组的范围的顶部和底部边界。一点都不方便。

我在想一个可能的解决方案可能是以下之一：

1.  某种**数据透视表**排列。这个我失败了。
2.  Excel**数据->大纲->小计**函数。再次，失败。它不断在我的表中创建新行。
3.  可以粘贴到每个单元格中的通用**公式**`??`。不是最优雅的解决方案，但仍然可以。
4.  一个**宏**。如果没有其他方法，作为最后的补救措施。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T02:21:43.573

以下步骤将计算小计，同时保留工作表的结构和格式。

1.  将此公式放入单元格 C1 并将公式复制到列中：

    ```
    =IF(NOT(ISERROR(SEARCH("Total",A1))),COUNTA(INDIRECT("B"&MATCH(LEFT(A1,LEN(A1)-7),A:A,0)+1&".B"&(MATCH(A1,A:A,0)+1))),IF(B1="","",B1)) 
    ```

2.  使用公式规则 =(MOD(ROW(C1),2)=0) 将条件格式应用于单元格 C1，并使用蓝色填充以匹配其他行的阴影。使用粘贴特殊格式将格式复制到列中。

3.  隐藏 B 列，或使用“粘贴特殊值”将 C 列中的值复制到 B 列并隐藏 C 列。如果您决定将值复制到 B 列，则无需设置条件格式。

这是公式的作用：

*   首先，通过使用 SEARCH 函数在行的 A 列中的单元格中搜索单词“Total”来检查公式的行是否为 Total 行。

    **如果找到单词“Total”：**

    确定工作表中该总行的组的学生 ID 范围：

    *a) 使用 MATCH 函数确定在其中找到单词“GroupX”和“GroupX Total”的行。这样，您就知道该组的 ID 位于从 x 行开始到 y 行结束的范围内。*

    *b) 使用起始行号和结束行号，构造 ID 所在的地址范围，该范围必须是字符串“B”+（行 x）+“。” +“B”+（第 y 行）。*

    *c) 使用 INDIRECT 函数将字符串转换为可以在公式中实际使用的范围引用。*

    使用 COUNTA 函数和范围计算小组中的学生人数，并将其显示为公式的结果。

    **如果找不到“总计”一词**

    检查B列的单元格是否为空

    *a) 如果为空，则显示空白作为公式的结果*

    *b) 如果不为空，则必须是学生ID，所以显示ID作为公式的结果。*

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T00:47:08.660

添加一列（我通常将其添加到现有矩阵的左侧），从第 2 行开始输入一个公式，填充旧列 A 中的空白。然后可以在数据透视表中使用包含新列的旧矩阵。

1.  因此，在矩阵左侧插入一列，现在是 A 列。在单元格 A1 中放置一个标题，例如“Group Name1”

2.  在单元格 B2 中输入以下公式并将其扩展到末尾： `=IF(B2="",A1,B2)`这样您的空白将被填充。

3.  现在在这个矩阵上应用一个枢轴，你就在那里。

也许不是最好看的解决方案，但它快速且运行良好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T20:23:06.860

如果你有这样的桌子

学生编号 学生组名称 ..........

然后你可以使用 countif/countifs 公式

# ruby - 加入具有多个空格的数组

> ID：13998222
> 
> 赞同：0
> 
> 时间：2012-12-21T22:53:34.790
> 
> 标签：ruby, arrays, whitespace

我有一个数组`["hello", "there", "buddy"]`，我想将这些字符串连接在一起。问题是我想将它们与多个空格连接在一起，特别是其中三个。我的代码运行为

```
sentence = sentence.join("   ") 
```

然而，而不是返回

```
hello   there   buddy 
```

它返回为

```
hello there buddy 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T22:59:06.097

It just works as expected:

```
p ["hello", "there", "buddy"].join("   ")
# => "hello   there   buddy" 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T02:40:23.567

> 文本位于 li 标签内。页面来源显示
> 
> *   你好哥们

问题是浏览器会折叠单词之间的空格。你可以通过几种方式看到这一点并加以反驳。

```
<p>1   2   3</p> 
```

在 Stack Overflow 上显示多个空格，因此在您的浏览器上显示，因为我告诉它使用代码格式。我也可以这样做：

```
1 2 3
```

它告诉浏览器使用`<pre>`格式显示，这也是一种尊重空格的固定宽度字体。

如果您不使用旨在保留空白的固定宽度格式，则必须变得棘手。

在 HTML 中，您可以使用不间断空格：

1 2 3

其中，在 HTML 中看起来像：

```
1&nbsp;&nbsp;&nbsp;2&nbsp;&nbsp;&nbsp;3 
```

如果我使用常规空格，它看起来像：

1 2 3

也有可以玩的 CSS 游戏，但使用`&nbsp;`可能是最常见的。

要在家尝试，请将以下内容保存到名为“test.html”的文件中，然后使用浏览器打开它：

```
<html><body><p>collapsed    whitespaces   here</p>
<p>non-breaking&nbsp;&nbsp;&nbsp;spaces&nbsp;&nbsp;&nbsp;here</p>
</body></html> 
```

# c++ - 确定参数的数量和类型以及作为函数的类型参数的返回类型

> ID：13998227
> 
> 赞同：1
> 
> 时间：2012-12-21T22:54:09.437
> 
> 标签：c++, c++11

给定一个 C++11 函数：

```
X f(A, B, C); 
```

无论如何在这个函数中：

```
template<typename T>
void g(T t)
{
    ...
} 
```

调用如下：

```
g(f); 
```

确定：

*   f的参数个数
*   f 的参数 i 的类型
*   f 的返回类型

...

```
template<typename F>
void g(F f)
{
    constexpr size_t n = num_params<F>::n; // 3
    return_type<F>::type x; // X
    tuple<param_types<F>::type...> a; // tuple<A, B, C>
} 
```

?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T22:56:04.370

Sure:

```
template <typename R, typename ...Args>
void g(R(&f)(Args...))
{
    typedef R return_type;
    unsigned int const n_args = sizeof...(Args);

    // ...
} 
```

Usage:

```
int foo(char, bool);

g(foo); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:33:15.387

我所做的事情可以满足您的想法-但是，它仅限于定义最多一个函数调用运算符的仿函数（lambda 符合此限制）。它也适用于 MSVC 2012 CTP。

```
namespace detail {
    ////////////////////////////////////////////////////////////////////////////
    //! Select between function pointer types
    ////////////////////////////////////////////////////////////////////////////
    template <typename T>
    struct callable_helper_ptr;

    //! non-member functions
    template <typename R, typename... Args>
    struct callable_helper_ptr<R (*)(Args...)> {
        typedef void                object_t;
        typedef R                   result_t;
        typedef std::tuple<Args...> args_t;
    };

    //! member functions
    template <typename R, typename O, typename... Args>
    struct callable_helper_ptr<R (O::*)(Args...)> {
        typedef O                   object_t;
        typedef R                   result_t;
        typedef std::tuple<Args...> args_t;
    };

    //! const member functions
    template <typename R, typename O, typename... Args>
    struct callable_helper_ptr<R (O::*)(Args...) const> {
        typedef O                   object_t;
        typedef R                   result_t;
        typedef std::tuple<Args...> args_t;
    };

    ////////////////////////////////////////////////////////////////////////////
    //! Select between function pointers and functors
    ////////////////////////////////////////////////////////////////////////////
    template <typename T, typename is_ptr = typename std::is_pointer<T>::type>
    struct callable_helper;

    //! specialization for functors (and lambdas)
    template <typename T>
    struct callable_helper<T, std::false_type> {
        typedef callable_helper_ptr<decltype(&T::operator())> type;
    };

    //! specialization for function pointers
    template <typename T>
    struct callable_helper<T, std::true_type> {
        typedef callable_helper_ptr<T> type;
    };
} //namespace detail

////////////////////////////////////////////////////////////////////////////////
//! defines the various details of a callable object T
////////////////////////////////////////////////////////////////////////////////
template <typename T>
struct callable_traits {
    typedef typename detail::callable_helper<T>::type::object_t object_t;
    typedef typename detail::callable_helper<T>::type::result_t result_t;
    typedef typename detail::callable_helper<T>::type::args_t   args_t;

    template <unsigned N>
    struct arg : public std::tuple_element<N, args_t> {};
}; 
```

如果有人感兴趣，我会写下写作背后的过程：http: [//bkentel.wordpress.com/2012/12/12/defining-a-traits-type-for-callable-objects/](http://bkentel.wordpress.com/2012/12/12/defining-a-traits-type-for-callable-objects/)

# java - 如何选择要打印的文件 - java

> ID：13998235
> 
> 赞同：1
> 
> 时间：2012-12-21T22:54:41.203
> 
> 标签：java

大家好，我下面有一些代码可以打印我已经写入应用程序（mText）的文本，但是我希望能够选择一个.txt文件并将其打印出来，而不是仅仅在程序中写入内容相反，我如何修改下面的代码来实现这一点？

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
/**
 * The PrintText application expands on the
 * PrintExample application in that it images
 * text on to the single page printed.
 */
public class PrintText implements Printable {
    /**
     * The text to be printed.
     */
    private static final String mText = 
        "Four score and seven years ago our fathers brought forth on this "
        + "continent a new nation, conceived in liberty and dedicated to the "
        + "proposition that all men are created equal. Now we are engaged in "
        + "a great civil war, testing whether that nation or any nation so "
        + "conceived and so dedicated can long endure. We are met on a great "
        + "battlefield of that war. We have come to dedicate a portion of "
        + "that field as a final resting-place for those who here gave their "
        + "lives that that nation might live. It is altogether fitting and "
        + "proper that we should do this. But in a larger sense, we cannot "
        + "dedicate, we cannot consecrate, we cannot hallow this ground." 
        + "The brave men, living and dead who struggled here have consecrated "
        + "it far above our poor power to add or detract. The world will "
        + "little note nor long remember what we say here, but it can never "
        + "forget what they did here. It is for us the living rather to be "
        + "dedicated here to the unfinished work which they who fought here "
        + "have thus far so nobly advanced. It is rather for us to be here "
        + "dedicated to the great task remaining before us--that from these "
        + "honored dead we take increased devotion to that cause for which "
        + "they gave the last full measure of devotion--that we here highly "
        + "resolve that these dead shall not have died in vain, that this "
        + "nation under God shall have a new birth of freedom, and that "
        + "government of the people, by the people, for the people shall "
        + "not perish from the earth.";
    /**
     * Our text in a form for which we can obtain a
     * AttributedCharacterIterator.
     */
    private static final AttributedString mStyledText = new AttributedString(mText);
    /**
     * Print a single page containing some sample text.
     */
    static public void main(String args[]) {
        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(new PrintText(), new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight()? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

我在打印其他代码时遇到了一些问题，但上面的代码对我来说成功地工作得很好，这就是我想修改它的原因

我的文件阅读器：

```
import java.io.*; 
class FileReaderDemo { 
    public static void main(String args[]) throws Exception { 
        FileReader fr = new FileReader("D:/Documents/testDocToPrintUsingJava.txt"); 
        BufferedReader br = new BufferedReader(fr); 
        String s; 
        while((s = br.readLine()) != null) { 
            System.out.println(s); 
        } 
        fr.close(); 
    } 
} 
```

下面的当前代码，我对如何使用此代码感到困惑，

```
import java.awt.*;
import java.awt.font.*;
import java.awt.geom.*;
import java.awt.print.*;
import java.text.*;
import java.io.*; 
import javax.swing.*;
import static java.nio.file.StandardOpenOption.*;
import java.io.FileReader;
import java.io.FileWriter; 
import java.io.BufferedWriter; 
import java.io.BufferedReader; 
import java.io.InputStreamReader; 
import java.io.InputStream; 
import java.io.PrintWriter; 
import java.io.IOException;
import java.io.BufferedInputStream; 
import java.io.Console;
import java.util.Arrays;
import java.io.IOException;
import java.io.DataOutputStream;
import java.io.DataInputStream;
import java.io.FileInputStream;
import java.io.EOFException;
import java.io.FileNotFoundException;
import java.nio.file.Files;
import java.lang.System;
import java.lang.String;
import java.nio.file.Files; 
import java.nio.file.Paths;
import java.nio.file.FileSystemException;
import java.nio.file.InvalidPathException;
import java.nio.file.FileSystemNotFoundException;
import java.lang.IllegalArgumentException;
import java.lang.SecurityException;
import java.nio.channels.FileChannel;
import java.nio.channels.*;
import static java.nio.file.StandardOpenOption.*;
import java.lang.Enum;
import java.nio.charset.Charset;

/**
 * The PrintText application expands on the
 * PrintExample application in that it images
 * text on to the single page printed.
 */
public class PrintText implements Printable {
    //Create a file chooser
    //final JFileChooser fc = new JFileChooser();
    /**
     * The text to be printed.
     */
    private static final String mText = 
        "test";
    /**
     * Our text in a form for which we can obtain a
     * AttributedCharacterIterator.
     */

        public static void main(String[] args) {
            JFileChooser chooser = new JFileChooser();
            chooser.showOpenDialog(null);
            File file = chooser.getSelectedFile();
            String filename = file.getName();
            System.out.println("You have selected: " + filename);
        }

    public static String readFile(String file, String csName)
    throws IOException {
        Charset cs = Charset.forName(csName);
        return readFile(file, cs);
    }

    public static String readFile(String file, Charset cs)
    throws IOException {
        // No real need to close the BufferedReader/InputStreamReader
        // as they're only wrapping the stream
        FileInputStream stream = new FileInputStream(file);
        try {
            Reader reader = new BufferedReader(new InputStreamReader(stream, cs));
            StringBuilder builder = new StringBuilder();
            char[] buffer = new char[8192];
            int read;
            while ((read = reader.read(buffer, 0, buffer.length)) > 0) {
                builder.append(buffer, 0, read);
            }
            return builder.toString();
        } finally {
            // Potential issue here: if this throws an IOException,
            // it will mask any others. Normally I'd use a utility
            // method which would log exceptions and swallow them
            stream.close();
        }        
    }

    private static final AttributedString mStyledText = new AttributedString(mText);
    /**
     * Print a single page containing some sample text.
     */
    static public void main(String args[]) {
        /* Get the representation of the current printer and 
         * the current print job.
         */
        PrinterJob printerJob = PrinterJob.getPrinterJob();
        /* Build a book containing pairs of page painters (Printables)
         * and PageFormats. This example has a single page containing
         * text.
         */
        Book book = new Book();
        book.append(new PrintText(), new PageFormat());
        /* Set the object to be printed (the Book) into the PrinterJob.
         * Doing this before bringing up the print dialog allows the
         * print dialog to correctly display the page range to be printed
         * and to dissallow any print settings not appropriate for the
         * pages to be printed.
         */
        printerJob.setPageable(book);
        /* Show the print dialog to the user. This is an optional step
         * and need not be done if the application wants to perform
         * 'quiet' printing. If the user cancels the print dialog then false
         * is returned. If true is returned we go ahead and print.
         */
        boolean doPrint = printerJob.printDialog();
        if (doPrint) {
            try {
                printerJob.print();
            } catch (PrinterException exception) {
                System.err.println("Printing error: " + exception);
            }
        }
    }

    /**
     * Print a page of text.
     */
    public int print(Graphics g, PageFormat format, int pageIndex) {
        /* We'll assume that Jav2D is available.
         */
        Graphics2D g2d = (Graphics2D) g;
        /* Move the origin from the corner of the Paper to the corner
         * of the imageable area.
         */
        g2d.translate(format.getImageableX(), format.getImageableY());
        /* Set the text color.
         */
        g2d.setPaint(Color.black);
        /* Use a LineBreakMeasurer instance to break our text into
         * lines that fit the imageable area of the page.
         */
        Point2D.Float pen = new Point2D.Float();
        AttributedCharacterIterator charIterator = mStyledText.getIterator();
        LineBreakMeasurer measurer = new LineBreakMeasurer(charIterator, g2d.getFontRenderContext());
        float wrappingWidth = (float) format.getImageableWidth();
        while (measurer.getPosition() < charIterator.getEndIndex()) {
            TextLayout layout = measurer.nextLayout(wrappingWidth);
            pen.y += layout.getAscent();
            float dx = layout.isLeftToRight()? 0 : (wrappingWidth - layout.getAdvance());
            layout.draw(g2d, pen.x + dx, pen.y);
            pen.y += layout.getDescent() + layout.getLeading();
        }
        return Printable.PAGE_EXISTS;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:09:20.933

将文本复制到文件中，然后查看这些。将这些解决方案之一放入一个名为`readStringFromFile`. 然后，将此行替换为：

```
private static final AttributedString mStyledText = new AttributedString( readStringFromFile( "c:\\myfile.txt" ); 
```

[如何从文件内容创建 Java 字符串？](https://stackoverflow.com/questions/326390/how-to-create-a-java-string-from-the-contents-of-a-file)

确实，这听起来像是通过文件 IO 教程学到的最多的东西。你不只是想要答案吗？这是一个小教程：

[http://docs.oracle.com/javase/tutorial/essential/io/index.html](http://docs.oracle.com/javase/tutorial/essential/io/index.html)

完成此操作后，您将学到足够多的知识，可以自己提出解决方案。

# email - Magento - 交易电子邮件不显示

> ID：13998238
> 
> 赞同：0
> 
> 时间：2012-12-21T22:55:16.977
> 
> 标签：email, magento, transactions

我在管理区域的交易电子邮件中创建新电子邮件模板时遇到问题。

在本节中，如果我单击添加新模板，则“模板”的下拉框为空。

在目录 app/locale/en_US/template/email 中有相关的 html 文件。

任何帮助深表感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T15:05:57.857

如果您不修改任何核心文件，请检查您的`core_email_template`表格。如果此表不为空，则需要调试

# sql - 获取记录进行比较：一项一项或一次？

> ID：13998242
> 
> 赞同：0
> 
> 时间：2012-12-21T22:55:49.847
> 
> 标签：sql, database, hibernate, data-access-layer, dao

我有一个产品列表，我必须将列表中的每个产品与数据库中存在的原始产品进行比较。哪个是正确的方法？

*   从 db 中获取所有记录（保留在 arraylist 中），比较每个记录，更新

或者

*   从 db 获取一个，比较它，更新，获取下一个

db 模式中有很多连接，因此第二种方式似乎不合适。另一方面，产品表包含超过 5000 条记录，我怀疑是否将所有记录（可以通过某些查询减少到 ~500 条）保留在内存中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T22:58:38.583

就数据库而言，5000 个结果很小。我会提取所有记录并在内存中对它们采取行动。这在数据库和应用服务器上都会轻得多。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:01:36.613

最好的方法是介于两个选项之间：

在一次查询中获取从数据库返回的所有行，但在读取每一行时对其进行处理，以便一次只有一个产品在内存中。

这种方法是完全可扩展的。

# javascript - jQuery ContextMenu DropDown

> ID：13998244
> 
> 赞同：2
> 
> 时间：2012-12-21T22:56:03.170
> 
> 标签：javascript, jquery, contextmenu

I am using this contextMenu template: [http://medialize.github.com/jQuery-contextMenu/index.html](http://medialize.github.com/jQuery-contextMenu/index.html)

and i would like to change the place where the menu appears, i mean i want it to ALWAYS Appear from the point i click to the bottom cause sometimes the lists contains lots of items and when its appears from the point clicked to upward Most of the list Disappear. i tried looking at the documentation and i came across the `$.ui.position` but i dont know if thats it and actually i didnt understand it.

Thanks In advance.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:17:55.583

```
$('.item').contextMenu('menu',{
    onShowMenu: function(e, menu) {
        e.pageX=100;
        e.pageY=400;
        return menu;
    }
  }
); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2022-01-03T13:21:54.077

**确定**位置 - 在插件的文档中提供。

确定菜单相对于给定触发对象的位置。

确定位置：函数（opt.$menu）

前任：

```
$.contextMenu({
    selector: 'span.context-menu',
    determinePosition: function($menu){
        // Position using jQuery.ui.position 
        // http://api.jqueryui.com/position/
        $menu.css('display', 'block')
            .position({ my: "center top", at: "center bottom", of: this, offset: "0 5"})
            .css('display', 'none');
    }
}); 
```

为我工作！！我知道这是一个 9 年前的问题，我希望下一个查看它的人不会花一个小时来解决它。

# javascript - 简化javascript函数代码

> ID：13998256
> 
> 赞同：-1
> 
> 时间：2012-12-21T22:57:29.860
> 
> 标签：javascript

我正在尝试用 javascript 简化（或改进）我的代码。

我有

```
task.prototype.init = function (){

      //for loop and create bunch of links
            var size=document.createElement('a');
                size.innerHTML='test'
                size.id=value;
                size.onclick=this.changeSize.bind(this);

                body.appendChild(size);
}

task.prototype.changeSize = function(e){
  for(var i=0; i<e.target.parentNode.childNodes.length; i++){
   e.target.parentNode.childNodes[i].style.backgroundColor='white';
  }
 e.target.style.backgroundColor='red';
 return false;
} 
```

我的 html 就像

```
<div>
   <a href='#' id='1'>test</a>
   <a href='#' id='2'>test</a>
   <a href='#' id='3'>test</a>
<div> 
```

我的代码会将所有`<a>`链接的背景颜色更改为白色，并为选定`<a>`的标签提供红色背景。它适合我的需要，但我觉得它在我的 changeSize 函数中可能更漂亮。

有没有更好的写法？非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:02:17.087

使用变量来避免意大利面条式代码。

```
task.prototype.changeSize = function(e) {
    var target = e.target,
        nodes = e.target.parentNode.childNodes, node;

    for (var i = nodes.length, node = nodes[i]; i--;) {
        node.style.backgroundColor = 'white';
    }

    target.style.backgroundColor = 'red';
    return false;
}; 
```

甚至会？：

```
task.prototype.changeSize = function(e) {
    var target = e.target,
        nodes = e.target.parentNode.childNodes, 
        i = nodes.length, node;

    for (node = nodes[i]; i-- && node.style.backgroundColor = 'white';);

    return !(target.style.backgroundColor = 'red');
}; 
```

# vb.net - 在 vb.net 中使用 linq 分组数据表

> ID：13998258
> 
> 赞同：9
> 
> 时间：2012-12-21T22:57:38.740
> 
> 标签：vb.net, linq, datatable, group-by

我正在尝试从数据表中获取汇总值。但无法弄清楚如何。在 c# 中看到了一些示例，但无法将这些示例转换为 vb.net。

我有数据表

```
Month, campaign, sales, leads, gross
1           1                5         10       1000
1            2               0          5         0
2            1               2          0         300
2            2               1          3         200 
```

我需要得到一个结果：

```
Month, sales, leads, gross
1           5        15       1000
2           3         3         500 
```

我不想手动循环和组合值。请帮忙

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-21T23:11:00.637

你想`Group by Month`吗？您可以使用`Sum`对组求和：

```
Dim query = From row In dt
        Group row By Month = row.Field(Of Int32)("Month") Into MonthGroup = Group
        Select New With {
            Key Month,
            .Sales = MonthGroup.Sum(Function(r) r.Field(Of Int32)("Sales")),
            .Leads = MonthGroup.Sum(Function(r) r.Field(Of Int32)("Leads")),
            .Gross = MonthGroup.Sum(Function(r) r.Field(Of Int32)("Gross"))
       }

For Each x In query
    Console.WriteLine("Month:{0} {1} {2} {3}", x.Month, x.Sales, x.Leads, x.Gross)
Next 
```

这是 Linq 查询语法和方法语法的混合体。

# angularjs - Mixing global/static views with dynamic views in an Angular JS application

> ID：13998259
> 
> 赞同：1
> 
> 时间：2012-12-21T22:57:46.700
> 
> 标签：angularjs

I have a Yeoman scaffolded Angular-JS+Twitter Bootstrap seed project. I use the Bootstrap navbar on every page of the site for, you guessed it, navigation.

What is the best way to include this in an Angular project... directly within index.html, as a view? Ideally I ought to encapsulate the entire navbar div as a template and simply call it out, just not sure exactly how to do so.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:00:43.167

如果它应该包含在每个“页面”中，请使用 ng-include 将其包含在您的 index.html 中。

你会有类似的东西：

```
<body>
   <div ng-include='"path/to/partials/navbar.html"'></div>
   ...
</body> 
```

# java - error while getting data from file to array

> ID：13998261
> 
> 赞同：0
> 
> 时间：2012-12-21T22:58:34.497
> 
> 标签：java

I'm trying to get saved data in a text file to an array to use it in my code and then search this array for a string submitted from the user from the GUI , but for some reason I print out the data in the array it is all null. here's the code !!

```
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileWriter;
import java.io.IOException;
import java.io.PrintWriter;
import java.util.Scanner;

public class IO {

    File f = new File("DB.txt");
    PrintWriter write;
    Scanner input;
    String[][] data;
    String nameToSearch;

    // search constructor
    public IO(String name) {
        super();
        nameToSearch = name;
        try {
            input = new Scanner(f);
        } catch (FileNotFoundException e) {
            System.out.println("File not found please restart the program");
        }
        data = new String[linesCounter()][2];
        int i = 0;
        while (input.hasNext()) {
            data[i][0] = input.nextLine();
            data[i][1] = input.nextLine();
            i++;
        }
    }

    public IO(String name, String number) {
        try {
            write = new PrintWriter(new FileWriter(f, true));
        } catch (IOException e) {
            System.out.println("Error");
        }
        write.println(name);
        write.println(number);
        write.close();
    }

    int linesCounter() {
        try {
            input = new Scanner(f);
        } catch (FileNotFoundException e) {
            System.out.println("File not found please restart the program");
        }
        int counter = 0;
        while (input.hasNext()) {
            input.nextLine();
            counter++;
        }
        return counter / 2;
    }

    int contactFinder() {
        int i = 0;
        while (input.hasNext()) {
            if (data[i][0].equalsIgnoreCase(nameToSearch))
                return i;
            i++;
        }
        return -1;
    }

    String nameGetter() {
        return data[contactFinder()][0];
    }

    String numGetter() {
        return data[contactFinder()][1];
    }

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:03:37.840

看起来你从文件中读取了所有行来计算有多少行，然后当你去读取数据时，你从你离开的地方开始，这将是文件的结尾。

还值得注意的是，您可以使用[commons-io FileUtils](http://commons.apache.org/io/api-release/org/apache/commons/io/FileUtils.html#readLines%28java.io.File%29)轻松读取文件中的所有行。

例如：

```
List<String> lines = FileUtils.readLines(f);
String[][] data = new String[lines.length][2];
for (int i = 0; i < lines.size(); i++) {
    data[i][i % 2] = lines.get(i);
} 
```

如果您也不想使用（非常有用的）第三方库，您可以很简单地加载数据：

```
List<String> lines = new ArrayList<String>();
Scanner input = new Scanner(f);
while (input.hasNextLine()) {
    lines.add(input.nextLine());
}
input.close(); 
```

然后进入数组种群。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:14:08.913

我建议您使用[**RandomAccessFile**](http://docs.oracle.com/javase/7/docs/api/java/io/RandomAccessFile.html)。这具有`readLine()`读取行和`seek(long pos)`设置文件读取指针等方法。您可以使用`seek(0L)`重新开始读取文件。

# ruby - 如何正确实现 Net::SSH 端口转发

> ID：13998267
> 
> 赞同：4
> 
> 时间：2012-12-21T22:58:49.157
> 
> 标签：ruby, port, forward, portforwarding, net-ssh

我一直在尝试让端口转发与 Net::SSH 一起正常工作。据我了解，如果我希望能够从同一个 Ruby 程序中使用 Net::SSH 会话，我需要分叉出它，以便事件处理循环实际上可以处理通过连接发送的数据包。但是，这会导致您在下面看到的丑陋：

```
#!/usr/bin/env ruby -w
require 'net/ssh'
require 'httparty'
require 'socket'
include Process

log = Logger.new(STDOUT)
log.level = Logger::DEBUG

local_port = 2006
child_socket, parent_socket = Socket.pair(:UNIX, :DGRAM, 0)
maxlen = 1000
hostname = "www.example.com"

pid = fork do
  parent_socket.close
  Net::SSH.start("hostname", "username") do |session|
    session.logger = log
    session.logger.sev_threshold=Logger::Severity::DEBUG
    session.forward.local(local_port, hostname, 80)
    child_socket.send("ready", 0)
    pidi = fork do
      msg = child_socket.recv(maxlen)
      puts "Message from parent was: #{msg}"
      exit
    end
    session.loop do
      status = waitpid(pidi, Process::WNOHANG)
      puts "Status: #{status.inspect}"
      status.nil?
    end
  end
end

child_socket.close

puts "Message from child: #{parent_socket.recv(maxlen)}"
resp = HTTParty.post("http://localhost:#{local_port}/", :headers => { "Host" => hostname } )
# the write cannot be the last statement, otherwise the child pid could end up
# not receiving it
parent_socket.write("done")
puts resp.inspect 
```

任何人都可以向我展示一个更优雅/更好的工作解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-18T09:37:43.557

我花了很多时间试图弄清楚如何正确实现端口转发，然后我从 net/ssh/gateway 库中获得了灵感。我需要一个强大的解决方案，可以在各种可能的连接错误后工作。这是我现在正在使用的，希望它有帮助：

```
require 'net/ssh'

ssh_options = ['host', 'login', :password => 'password']
tunnel_port = 2222
begin
  run_tunnel_thread = true
  tunnel_mutex = Mutex.new
  ssh = Net::SSH.start *ssh_options
  tunnel_thread = Thread.new do
    begin
      while run_tunnel_thread do
        tunnel_mutex.synchronize { ssh.process 0.01 }
        Thread.pass
      end
    rescue => exc
      puts "tunnel thread error: #{exc.message}"
    end
  end
  tunnel_mutex.synchronize do
    ssh.forward.local tunnel_port, 'tunnel_host', 22
  end

  begin
    ssh_tunnel = Net::SSH.start 'localhost', 'tunnel_login', :password => 'tunnel_password', :port => tunnel_port
    puts ssh_tunnel.exec! 'date'
  rescue => exc
    puts "tunnel connection error: #{exc.message}"
  ensure
    ssh_tunnel.close if ssh_tunnel
  end

  tunnel_mutex.synchronize do
    ssh.forward.cancel_local tunnel_port
  end
rescue => exc
  puts "tunnel error: #{exc.message}"
ensure
  run_tunnel_thread = false
  tunnel_thread.join if tunnel_thread
  ssh.close if ssh
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:31:21.677

这就是 SSH 的一般情况。如果您对它的丑陋程度感到不快，您可能应该将该功能包装到某种端口转发类中，以便暴露的部分更加简洁。像这样的界面，也许：

```
forwarder = PortForwarder.new(8080, 'remote.host', 80) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-23T15:05:20.063

所以我找到了一个更好的实现。它只需要一个分叉，但仍然使用套接字进行通信。它`IO#read_nonblock`用于检查消息是否准备好。如果没有，该方法将引发异常，在这种情况下，块继续返回 true，并且 SSH 会话继续为请求提供服务。一旦父级完成连接，它会发送一条消息，导致`child_socket.read_nonblock(maxlen).nil?`返回 false，使循环退出，从而关闭 SSH 连接。

我对此感觉好多了，所以在这和@tadman 的建议之间，将它包装在一个端口转发类中，我认为它已经达到了最好的水平。但是，非常欢迎任何进一步的改进建议。

```
#!/usr/bin/env ruby -w
require 'net/ssh'
require 'httparty'
require 'socket'

log = Logger.new(STDOUT)
log.level = Logger::DEBUG

local_port = 2006
child_socket, parent_socket = Socket.pair(:UNIX, :DGRAM, 0)
maxlen = 1000
hostname = "www.example.com"

pid = fork do
  parent_socket.close
  Net::SSH.start("ssh-tunnel-hostname", "username") do |session|
    session.logger = log
    session.logger.sev_threshold=Logger::Severity::DEBUG
    session.forward.local(local_port, hostname, 80)
    child_socket.send("ready", 0)
    session.loop { child_socket.read_nonblock(maxlen).nil? rescue true }
  end
end

child_socket.close

puts "Message from child: #{parent_socket.recv(maxlen)}"
resp = HTTParty.post("http://localhost:#{local_port}/", :headers => { "Host" => hostname } )
# the write cannot be the last statement, otherwise the child pid could end up
# not receiving it
parent_socket.write("done")
puts resp.inspect 
```

# c# - 使用 linq (C#) 比较两个列表的内容以查看一个特定值是否在某个范围内

> ID：13998270
> 
> 赞同：0
> 
> 时间：2012-12-21T22:59:31.060
> 
> 标签：c#, linq, loops, lambda, foreach

好的，我现在已经在我的头上砸了。

我有两个自定义对象列表，两个列表中的一个属性相同。我需要遍历两个列表并查看属性是否相同。

我可以用嵌套的 for-each 循环来做到这一点，但如果我能用 LINQ 做同样的事情，我很不情愿（我确信我能做到）。我几乎尝试了所有方法，但我根本无法找到我正在寻找的解决方案。

这是我用于列表的对象的代码。

```
public class Game
{
    // Fields
    private short maxPlayers;
    private Team axis;
    private Team allies;

    // Properties
    public string Name { get; set; }
    public short MaxPlayers
    {
        get
        {
            return maxPlayers;
        }
        set
        {
            if (value > 8)
                maxPlayers = 8;
            else if (value < 2)
                maxPlayers = 2;
            else
                maxPlayers = value;
        }
    }
    public short CurrentPlayers
    {
        get
        {
            int players = axis.Players.Count + allies.Players.Count;
            return (short)players;
        }
    }
    public bool IsFull
    {
        get
        {
            if (CurrentPlayers == MaxPlayers)
                return true;
            else
                return false;
        }
    }
    public Team Axis { get; set; }
    public Team Allies { get; set; }
    public List<Player> Players
    {
        // Somehow this does not work either, so I had to stick with one single team in the for-each loops. Ideas to fix?
        get
        {
            if (allies.Players.Count == 0)
                return axis.Players.Concat(allies.Players).ToList();
            else
                return allies.Players.Concat(axis.Players).ToList();

        }
    }

    //Constructor
    public Game()
    {
        axis = new Team();
        allies = new Team();
    }
}

public class Team
{
    public List<Player> Players { get; set; }

    public EFaction Faction { get; set; }

    public enum EFaction
    {
        Allies,
        Axis,
        Random
    }

    public Team()
    {
        Players = new List<Player>();
        Faction = EFaction.Random;
    }
}

public class Player
{
    private int skillRange = 200;

    public string Name { get; set; }
    public int Skill { get; set; }
    public int SkillRange
    {
        get
        {
            return skillRange;
        }
        set
        {
            if (value >= 200)
                skillRange = value;
            else
                skillRange = 200;
        }
    }
} 
```

在启动时，我从数据库中填充列表并对列表执行相同操作。我想要做的是遍历游戏列表并将游戏中每个玩家的技能属性与团队中每个玩家的技能属性进行比较。这是我使用的 for-each 循环。这行得通。但是你清楚地可以看到我为什么要如此糟糕地削减它。

```
 // Loop through each player in the Automatch queue.
        foreach (Team team in match.TeamsInQueue)
        {
            // Loop through every game in the Atomatch queue.
            foreach (Game game in match.AvailableGames)
            {
                int teamPlayersInSkillRange = 0;

                // Loop through every player in the team and loop through every player in the game.
                foreach (Player teamPlayer in team.Players)
                {
                    int gamePlayersInSkillRange = 0;
                    foreach (Player gamePlayer in game.Allies.Players)
                    {
                        // Compare beoth skill values. If they are in a certain range increase the counter.
                        if (Math.Abs(teamPlayer.Skill - gamePlayer.Skill) <= 200) // The range is currently set for 200, but I want to make it variable later.
                            gamePlayersInSkillRange++;
                    }

                    // Check if the player in the team is in skill range of the game he wants to join. If yes increase the counter.
                    if (gamePlayersInSkillRange == game.Allies.Players.Count)
                        teamPlayersInSkillRange++;
                  }
                // Check if the whole team is in skill range of the game they want to join. If yes return true.
                if (teamPlayersInSkillRange == team.Players.Count)
                {
                    // ToDo: Implement join process here.
                }
            }
        } 
```

任何帮助，将不胜感激。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:59:25.153

对于给定的球队和比赛，如果球队的所有球员都在所有比赛球员的技能范围内，您希望球队加入比赛。这听起来像是[All()](http://msdn.microsoft.com/en-us/library/bb548541.aspx)方法的工作！

```
// Loop through each player in the Automatch queue.
foreach (Team team in match.TeamsInQueue)
{
    // Loop through every game in the Atomatch queue.
    foreach (Game game in match.AvailableGames)
    {
        bool allInSkillRange = team.Players.All(t =>
            game.Allies.Players.All(g => Math.Abs(t.Skill - g.Skill) <= 200));
        if(allInSkillRange)
        {
            // ToDo: Implement join process here.
        }
    }
} 
```

如果您对将代码转换为 LINQ 的自动化方式感兴趣，请查看[Resharper](http://www.jetbrains.com/resharper/)。

以下是我提出解决方案的方法。使用此过程并熟悉 LINQ 的方法并获得经验可以使重构变得更加容易。我不只是看代码并立即想到使用`All()`. 我从重构较小的部分开始，然后从那里开始。在阅读完所有代码后，我专注于最内层的循环。

```
int gamePlayersInSkillRange = 0;
foreach (Player gamePlayer in game.Allies.Players)
{
    // Compare beoth skill values. If they are in a certain range increase the counter.
    if (Math.Abs(teamPlayer.Skill - gamePlayer.Skill) <= 200) // The range is currently set for 200, but I want to make it variable later.
        gamePlayersInSkillRange++;
} 
```

这会计算满足条件的玩家数量，可以将其重构为`Count()`调用：

```
int gamePlayersInSkillRange = game.Allies.Players.Count(g => 
    (Math.Abs(teamPlayer.Skill - g.Skill) <= 200); 
```

下面的 if 语句检查 gamePlayersInSkillRange 是否等于 game.Allies.Players 中的项目数，这是我们最初计算的列表。哦，所以我们正在检查*所有*这些列表成员是否都满足谓词！我们可以通过更改`Count()`为`All()`. 这是下一个最里面的循环现在的样子：

```
foreach (Player teamPlayer in team.Players)
{
    bool allGamePlayersInRange = game.Allies.Players.All(g => 
        (Math.Abs(teamPlayer.Skill - g.Skill) <= 200);

    // Check if the player in the team is in skill range of the game he wants to join. If yes increase the counter.
    if (allGamePlayersInRange)
        teamPlayersInSkillRange++; 
```

}

现在这个循环看起来可以重构为一个`Count()`调用。但是，如果我们仔细检查它之后的代码，我们会发现它与我们刚刚重构的循环完全相同，这意味着我们可以直接将其重构为`All()`调用，从而完成重构。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:14:29.207

试试这个：

```
foreach(Team team in match.TeamsInQueue)
{
    if(team.Players.Insersect(match
           .SelectMany(m => m.AvailableGames, g=> g.Allies.Players), 
            new PlayerSkillComparer().Count() == team.Players.Count()) {
         // ToDO: Implement join process here.
    }
} 
```

如果两个给定对象的技能差异 <= 200，则`PlayerSkillComparer`implements`IEqualityComparer<Player>`及其`Equals`方法返回 true 。请参见[此处](http://msdn.microsoft.com/en-us/library/bb355408.aspx)`Player`的示例。

# graphics - Radial gradient equation

> ID：13998274
> 
> 赞同：0
> 
> 时间：2012-12-21T23:00:05.950
> 
> 标签：graphics, modeling

Given:

A point P, circle 1 and circle 2's positions and radii

What is:

The equation for T, the 'mix level' between color 1 and 2 (a value between 0 to 1)

Many radial gradient equations only apply to concentric circles or circles that share a position. I'm looking for something that matches the image below, created using Quartz (Core Graphics). I am writing a GLSL shader, but I need to understand the math first.

![enter image description here](../Images/de611371c024e95bc0d5b561daf5997f.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:03:32.147

如果这是二维的，那么您可以将您的点所在的圆的参数写为：

```
x3=T*x1+(1-T)*x2
y3=T*y1+(1-T)*y2
r3=T*r1+(1-T)*r2 
```

编辑：当然，该圆圈可以表示为：

```
(x3-xP)^2+(y3-yP)^2=r3^2 
```

您可以将前 3 个方程代入最后一个方程（并记住 (xP, yP) 是您的观点）以得到 1 个方程，其中只有 T 作为 T 中的二次变量，因此很容易求解 T。这样做给我们：

```
T=(-r2*(r1-r2)+(x1-x2)*(x2-xP)+(y1-y2)(y2-yP)
    {+-}sqrt(r2^2*((x1-xP)^2+(y1-yP)^2)-2*r1*r2*((x1-xP)*(x2-xP)
               +(y1-yP)*(y2-yP))+r1^2*((x2-xP)^2+(y2-yP)^2)
               -(x2*y1-xP*y1-x1*y2+xP*y2+x1*yP-x2*yP)^2))
 /((r1-r2)^2-(x1-x2)^2-(y1-y2)^2) 
```

我知道这有点难以阅读，但在数学上实际上并没有那么糟糕。它只是加法、乘法和平方（实际上只是乘法）。

# algorithm - Generate all lists of size n, such that each element is between 0 and m (inclusive)

> ID：13998275
> 
> 赞同：1
> 
> 时间：2012-12-21T23:00:09.337
> 
> 标签：algorithm, list, language-agnostic, combinatorics, exponent

Generate all lists of size `n`, such that each element is between 0 and `m` (inclusive).

There are `(m+1)^n` such lists.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:34:34.433

这就像枚举 n 位基数 (m+1) 中的所有数字一样。

```
start with a list of n zeros
do the following loop
    yeld the list as a new answer
    increment the first element, counting in base (m+1), and propagate the carry recursively on its next element
    if there is a carry left, exit the loop 
```

更新：只是为了好玩，如果我们添加所有数字必须保持不同的限制（如彩票号码，如最初所述 - 当然我们假设 m >= n），那么解决方案是什么？

我们继续枚举具有上述限制的所有数字，并且任何元素都必须大于列表中的后继元素（即 rank`k < n`的数字大于 rank 的数字`k+1`）。这是通过在计算进位时简单地检查当前数字不会等于其前任数字来实现的，如果是，则进一步传播进位。

然后，对于通过枚举产生的每个列表，计算所有可能的排列。有已知的算法可以执行该计算，例如参见[Johnson-Trotter 算法](http://en.m.wikipedia.org/wiki/Steinhaus%E2%80%93Johnson%E2%80%93Trotter_algorithm)，但可以构建一个更简单的递归算法：

```
 function select l r:
   if the list r is empty, yeld l
   else
     for each element x of the list r
        let l' be the list of x and l
        and r' the remaining elements of r
        call select l' r' 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T00:01:35.137

编写一般情况有两种简单的方法。一个在@didierc 的现有答案中进行了描述。另一种方法是递归。

例如，考虑一个将 String 作为参数的方法：

```
if(input string is long enough)
  print or store it
else
  iterate over digit range
    recursive call with the digit appended to the string 
```

# bash - 将多个剪切命令组合成变量赋值为一个剪切命令

> ID：13998281
> 
> 赞同：5
> 
> 时间：2012-12-21T23:00:29.867
> 
> 标签：bash, shell

给定先前在 shell 脚本中定义的 $LINE，我执行以下操作

```
var1=$(echo $LINE | cut -d, -f4)
var2=$(echo $LINE | cut -d, -f5)
var3=$(echo $LINE | cut -d, -f6) 
```

我有什么办法可以将它组合成一个命令，剪切只运行一次？就像是

```
var1,var2,var3=$(echo $LINE | cut -d, -f4,5,6) 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T04:10:53.180

内置`read`命令可以分配给多个变量：

```
IFS=, read _ _ _ var1 var2 var3 _ <<< "$LINE" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T23:06:27.473

是的，如果你对数组没问题：

```
var= ( $(echo $LINE | cut -d, --output-delimiter=' ' -f4-6) ) 
```

请注意，这会使`var`0-indexed。

尽管将 CSV 转换为 bash 括号可以理解的内容可能会更快更容易`$LINE`，然后只需执行`var = ( $LINE )`.

编辑：如果您的 $LINE 中有空格，上述内容会导致问题...如果是这样，您需要更加小心，而 AWK 可能是添加引号的更好选择：

```
var= ( $( echo $LINE | awk IFS=, '{print "\"$4\" \"$5\" \"$6\""}' ) ) 
```

# javascript - 从 URL 中删除用户 ID 的 Javascript 函数

> ID：13998286
> 
> 赞同：-1
> 
> 时间：2012-12-21T23:00:51.883
> 
> 标签：javascript, strip

我需要一个 javascript 函数来从给定的 URL 中删除用户 ID。例如。我有这个 URL [http://www.example.com/member.php?id=100001877097904](http://www.example.com/member.php?id=100001877097904) 如何从该 URL 检索用户的 ID？提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:04:10.303

```
function getParameterByName(url, name)
{
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(url);
  if(results == null)
    return "";
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "));
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:02:32.863

一种可能的解决方案：

```
var url = "http://www.example.com/member.php?id=100001877097904",
    id  = (url.match(/[?&#]id=(\d+)/) || []).pop();

console.log(id); 
```

# wcf - 如何显示 SOAP WCF 调用中使用的用户名凭据？

> ID：13998289
> 
> 赞同：0
> 
> 时间：2012-12-21T23:01:25.133
> 
> 标签：wcf, web-services, soap

下面的 SOAP 调用使用我的凭据可以正常工作，但是当其他人使用调用 WCF 服务的我的 .EXE 时，我得到 401 拒绝。我试图找出正在传递的凭据是什么。

我可以查看 IIS 日志，但我正在尝试以编程方式进行操作，谢谢：

```
 public static Guid GetServerID(string serverName, string soapUrl)
    {
        Guid result;
        try
        {
            Guid vServerId = new ControllerWS.Controller
            {
                Url = soapUrl,
                Timeout = Config.SoapCallTimeOut,
                Credentials = CredentialCache.DefaultCredentials
            }.GetServerId(serverName);
            result = vServerId;

            //Console.WriteLine("CredentialCache.DefaultCredentials: " + CredentialCache.DefaultCredentials.ToString());
            //ICredentials Credentials = CredentialCache.DefaultCredentials.GetCredential()
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T21:39:07.620

这实际上取决于您使用的身份验证类型。当具有模拟的 Windows 凭据时，您可以获得如下用户名：

```
string userName = System.Security.Principal.WindowsIdentity.GetCurrent().Name 
```

如果您使用的是普通用户名和密码，则这些值可以存储在请求标头中并如下所示：

```
MessageHeaders headers = OperationContext.Current.IncomingMessageHeaders;
string userId = headers.GetHeader<Guid>("MyKey", "MyNamespce"); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T03:23:04.817

您可以在服务器端使用[IDispatchMessageInspector](http://msdn.microsoft.com/en-us/library/system.servicemodel.dispatcher.idispatchmessageinspector.aspx)来拦截包括标头在内的完整消息。从那里您可以检查正在传递的凭据。

[这是一篇博客文章](http://cgeers.com/2011/05/10/wcf-message-logging/)，概述了如何从消息检查器记录完整消息，包括连接它所需的配置步骤。

# c# - 如何检查 mscorlib 到 system.runtime 的类型转发？

> ID：13998298
> 
> 赞同：3
> 
> 时间：2012-12-21T23:02:57.747
> 
> 标签：c#, .net, reflection, .net-4.5

我在运行时分析代码，当在 .Net 4.5 应用程序中运行时，IObservable 似乎来自 System.Runtime 程序集。

现在我知道 IObservable 是在 mscorlib （[系统命名空间](http://msdn.microsoft.com/en-us/library/dd990377.aspx)）中定义的。

我已阅读有关 TypeForwardedToAttribute 和 TypeForwardedFromAttribute 属性并了解其原理。

**但是我如何检查这些属性的使用情况以及重要的是在哪里？**

我尝试反映 mscorlib 以找到这些属性中的任何一个，但找不到那里的用法 - 请参见下面的示例代码：

```
 var assembly = typeof (IObservable<>).Assembly;

 var tmp = assembly.GetCustomAttributes(true).Where(a => a is TypeForwardedToAttribute).ToList();
 var tmp2 = assembly.GetCustomAttributes(true).Where(a => a is TypeForwardedFromAttribute).ToList();

 var tmp3 = typeof (IObservable<>).GetCustomAttributesData();

 var tmp4 = typeof(IObservable<>).GetCustomAttributes(true).Where(a => a is TypeForwardedToAttribute).ToList();
 var tmp5 = typeof(IObservable<>).GetCustomAttributes(true).Where(a => a is TypeForwardedFromAttribute).ToList();

 var tmp6 = typeof(IObservable<>).GetCustomAttributesData();

 var tmp7 = typeof (IObservable<>).Attributes; 
```

# azure-storage - “Microsoft.WindowsAzure.Storage.CloudStorageAccount”和“Microsoft.WindowsAzure.CloudStorageAccount”类在使用方面的区别？

> ID：13998299
> 
> 赞同：2
> 
> 时间：2012-12-21T23:03:01.503
> 
> 标签：azure-storage, azure-diagnostics

从 Azure SDK 1.7 => 1.8 升级后，我们注意到有两个基本相同的类：

`Microsoft.WindowsAzure.Storage.CloudStorageAccount`(v1.7) `Microsoft.WindowsAzure.CloudStorageAccount`(v1.8)

在我们在代码中迁移到 1.8 之前（我们仍然可以参考 Azure SDK 1.7 并进行编译），有没有人知道更新的好处是什么以及是否有一些示例代码可以使用它？这是从 Azure 诊断的角度来看的，因此启动和停止按需传输。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T19:16:19.447

Microsoft.WindowsAzure.Storage 命名空间是随 Azure SDK 1.8 附带的 Storage Client Library 2.0 引入的。但出于向后兼容性的原因，SDK 1.8 中也存在 Storage Client Library 1.7。有关 Storage Client Library 2.0 的更多信息，请参阅[此博客文章](http://blogs.msdn.com/b/windowsazurestorage/archive/2012/10/29/introducing-windows-azure-storage-client-library-2-0-for-net-and-windows-runtime.aspx)。

# java - 我有一个主要方法和三个类，我需要编译 - eclipse

> ID：13998301
> 
> 赞同：-3
> 
> 时间：2012-12-21T23:03:17.730
> 
> 标签：java, html, pong

我正在使用 Eclipse，并且正在根据教程制作游戏乒乓球。我已将 4 个类（一个主类）的代码复制到记事本中，因此我也可以根据需要使用它们……我还有 HTML 代码可以使用……

我正在使用 ecplise ......我如何让这些代码块连接和工作？三个单独的.java 和一个.class？或者其他的东西

请帮忙。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:10:56.753

创建一个项目，将现有文件添加到您的项目中。就是这样。

# qt - 在 QGraphicsPixmap 上显示许多带有 QLabel 的像素图

> ID：13998302
> 
> 赞同：0
> 
> 时间：2012-12-21T23:03:24.077
> 
> 标签：qt, text, widget, icons, clickable

我需要一个小部件，我可以在其中放置各种可点击的图标，并在这些图标下使用 QLabel 一些文本。

这是一张图片：![在此处输入图像描述](../Images/11d550d0c64d34861b8b3875f3afcf31.png)

我知道这需要一些调整和子分类。最好的方法是什么？我知道那些可点击的图标将显示在 QGraphicsView 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:17:00.407

我建议你使用 QGraphicsView。

这是可点击像素图的示例：

```
ClickablePixmap::ClickablePixmap( QGraphicsItem* itemParent )
    : QObject(0)
    , QGraphicsPixmapItem(itemParent)
    , m_pressed(false)
{
    setFlags(QGraphicsItem::ItemIsFocusable |
             QGraphicsItem::ItemIsSelectable |
             QGraphicsItem::ItemSendsGeometryChanges |
             QGraphicsItem::ItemIgnoresParentOpacity
             );
    setAcceptedMouseButtons(Qt::LeftButton);
    setCursor(Qt::ArrowCursor);
}

void ClickablePixmap::mouseReleaseEvent( QGraphicsSceneMouseEvent* event )
{
    setCursor(Qt::ArrowCursor);
    m_pressed = false;
    update();
    if( boundingRect().contains(event->pos()) )
        emit clicked();
    event->accept();
}

void ClickablePixmap::mousePressEvent( QGraphicsSceneMouseEvent* event )
{
    setCursor(Qt::ArrowCursor);
    m_pressed = true;
    update();
    QGraphicsPixmapItem::mousePressEvent(event);
}

void ClickablePixmap::paint( QPainter* painter, const QStyleOptionGraphicsItem* option, QWidget* widget )
{
    Q_UNUSED(option);
    Q_UNUSED(widget);

    QRect rect(0,0, boundingRect().width(), boundingRect().height());

    // Create the pushed effet
    if( m_pressed ) {
        rect.adjust(2,2,-2,-2);
    }
    painter->drawPixmap(rect, pixmap());
} 
```

接下来要做的是将此小部件嵌入到容器小部件中，其中包含：

```
QVBoxLayout 
```

然后你可以在下面添加你的 QLabel。

# ios - iOS：没有断点的信号 SIGTRAP？

> ID：13998307
> 
> 赞同：6
> 
> 时间：2012-12-21T23:04:03.860
> 
> 标签：ios, crash, signals

我正在开发一个 iPad 应用程序，我最近所做的一项更改导致该应用程序因“信号 SIGTRAP”而死机。堆栈跟踪没有帮助，我无法确定代码的哪一部分导致这种情况发生（但我知道它从哪个函数开始）。

在不深入了解应用程序的详细信息的情况下，我想知道是否有一些调试此类事情的一般技巧（SIGTRAP）？

我已经设法缩小导致这种情况发生的函数调用的范围。奇怪的是，如果我打破并进入该功能，那么它就可以正常工作。但是如果我让它在没有断点的情况下运行，那么它就会崩溃。

该函数调用了一堆其他也涉及异步网络连接的东西。我将日志放在我的代码中，并且我的所有日​​志都打印得很好，所以似乎是“幕后”的东西导致了这个失败。我也在使用可能导致此问题的第 3 方框架？

这甚至是与代码相关的问题吗？我在某处读到 SIGTRAP 是一个调试器。

是什么导致了这种崩溃，我应该在哪里集中精力修复它？

非常感谢您提供的任何帮助。

谢谢！

# sql - 从表 A 中删除记录，其中表 B 中的字段 x = y

> ID：13998309
> 
> 赞同：0
> 
> 时间：2012-12-21T23:04:24.237
> 
> 标签：sql, sql-delete, delete-record

我一直在使用以下查询，它足以显示我想在 phpMyAdmin 中删除的记录：

```
SELECT zen_customers_basket.*
FROM zen_customers_basket, zen_products
WHERE zen_customers_basket.products_id = zen_products.products_id
            AND zen_products.products_availability = 'out of stock' 
```

然后我检查所有记录，然后删除它们。它相当快速且轻松，但我需要一个能够自动删除这些记录的查询，这样我就可以使用其他一些计划每小时运行一次的查询来自动化它。任何和所有的帮助将不胜感激。我知道如何删除记录，但我不确定这里的语法是否正确，因为我从两个不同的表中选择内容，我不想搞砸任何事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:13:56.230

根据您的查询使用相同的条件删除。不确定基于小时的删除。请说清楚。

```
DELETE FROM zen_customers_basket
   INNER JOIN zen_products
   ON zen_customers_basket.products_id = zen_products.products_id
   WHERE zen_products.products_availability = 'out of stock' 
```

参考：[T-SQL：通过连接选择要删除的行](https://stackoverflow.com/questions/439750/t-sql-selecting-rows-to-delete-via-joins)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:11:54.890

```
DELETE zen_customers_basket
FROM zen_customers_basket, zen_products
WHERE zen_customers_basket.products_id =          zen_products.products_id
        AND zen_products.products_availability =    'out of stock' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:11:59.877

```
 DELETE FROM Table  WHERE EXISTS (SELECT zen_customers_basket.*
FROM zen_customers_basket, zen_products
WHERE zen_customers_basket.products_id = zen_products.products_id
            AND zen_products.products_availability = 'out of stock') 
```

[https://stackoverflow.com/questions/8019957/delete-from-where-in](https://stackoverflow.com/questions/8019957/delete-from-where-in) _

# css - 在 CSS 中使用 OS 样式和 rgba

> ID：13998310
> 
> 赞同：0
> 
> 时间：2012-12-21T23:04:39.650
> 
> 标签：css

具体来说，我有一个 CSS 属性`border-color: rgba(82, 168, 236, 0.8);`。我想改变颜色，但不考虑不透明度。颜色也将是一个名为`Highlight`（[使用 OS 样式](http://www.sitepoint.com/css-system-styles/)）的属性。

这怎么可能，即使是这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:24:03.040

这是不可能的，或者至少没有命名颜色。

您应该使用`rgba()`or`hsla()`以便能够控制不透明度。

# php - 将 Wordpress 中的 CSS 与 PHP 和 bloginfo() 链接起来

> ID：13998311
> 
> 赞同：0
> 
> 时间：2012-12-21T23:04:48.700
> 
> 标签：php, html, css, wordpress

我正在尝试将我的 CSS 文件与我正在处理的 Wordpress 网站的 header.php 文件链接，但我在跟进时遇到了一些麻烦。

我被告知要这样设置：

```
<link href="<?php bloginfo('stylesheet_url');?>" rel="stylesheet"> 
```

以下是我当前的代码：

```
<link href="<?php bloginfo('/style.css');?>" rel="stylesheet"> 
```

但是，如果您查看站点的当前状态[http://thenerdup.com](http://thenerdup.com)，很明显 CSS 文件没有正确链接。

对于它的价值，这是我正在关注的教程：http: [//blog.teamtreehouse.com/responsive-wordpress-bootstrap-theme-tutorial](http://blog.teamtreehouse.com/responsive-wordpress-bootstrap-theme-tutorial)

我目前正在编辑标题。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T23:09:04.617

其实应该是

```
<link href="<?php bloginfo('stylesheet_url');?>" rel="stylesheet"> 
```

所以它会`echo/print`是`url`你的`stylesheet`。

这`bloginfo()`是一个函数，`stylesheet_url`是这个函数的一个参数。还有其他参数，例如，如果您写，`bloginfo('name')`那么它将打印您的博客名称。

你也可以使用

```
<link href="<?php echo get_stylesheet_uri();?>" rel="stylesheet"> 
```

[在 Codex](http://codex.wordpress.org/Function_Reference/bloginfo)阅读更多信息。

# swt - 尝试在 SWT 选项卡中设置按钮的大小/位置

> ID：13998317
> 
> 赞同：1
> 
> 时间：2012-12-21T23:05:28.683
> 
> 标签：swt

这应该很简单，但这是我第一次使用 SWT。这就是我到目前为止所拥有的。

```
public class TabsTest {

private Shell shell;
private CTabFolder folder;

public TabsTest(Display display){

    shell = new Shell(display);
    shell.setText("TabsTest");
    shell.setLayout(new FillLayout());

    CTabFolder folder = new CTabFolder(shell, SWT.CLOSE | SWT.BOTTOM);
    folder.setUnselectedCloseVisible(false);
    folder.setSimple(false);

    initUI(folder);

    shell.pack();
    shell.setBounds(500, 500, 400, 500);
    shell.open ();

    while(!shell.isDisposed()){
        if(!display.readAndDispatch())
            display.sleep();
    }   
}

public void initUI(CTabFolder folder){
    CTabItem NFL = new CTabItem(folder, SWT.NONE);
    NFL.setText("NFL Bets");

    Button okButton = new Button(folder, SWT.PUSH);
    okButton.setText("OK");
    okButton.setSize(10,10);

    NFL.setControl(okButton);

    CTabItem NBA = new CTabItem(folder,SWT.NONE);
    NBA.setText("NBA Bets");

    CTabItem CFB = new CTabItem(folder,SWT.NONE);
    CFB.setText("CFB Bets");        

    folder.setSize(800,500);

}

public static void main (String [] args) {
    Display display = new Display();
    new TabsTest(display);
    display.dispose();
} 
```

}

这目前给我的是这个......

![图片](../Images/55b571052953f28ab3b5ddb858dcf273.png)

我如何在右下角制作一个小按钮？或者只是一般将其变小并将其移动到某个地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:47:43.193

由于您使用的`FillLayout`是控件，因此该控件占用了整个可用空间。你需要的是一种不同的布局。我会建议你阅读[这篇文章](http://www.eclipse.org/articles/article.php?file=Article-Understanding-Layouts/index.html)，这将是一个好的开始。

我通常更喜欢`GridLayout`它，因为它非常易于使用并且可以满足大多数需求。

**已编辑**：修改您的代码以使用`GridLayout`

```
public class TabsTest {

    private Shell shell;
    private CTabFolder folder;

    public TabsTest(Display display) {
        shell = new Shell(display);
        shell.setText("TabsTest");
        shell.setLayout(new GridLayout());

        CTabFolder folder = new CTabFolder(shell, SWT.CLOSE | SWT.BOTTOM);
        folder.setUnselectedCloseVisible(false);
        folder.setSimple(false);
        folder.setLayoutData(new GridData(GridData.FILL_BOTH));

        initUI(folder);

        shell.pack();
        shell.setBounds(500, 500, 400, 500);
        shell.open();

        while (!shell.isDisposed()) {
            if (!display.readAndDispatch())
                display.sleep();
        }
    }

    public void initUI(CTabFolder folder) {
        CTabItem NFL = new CTabItem(folder, SWT.NONE);
        NFL.setText("NFL Bets");

        Composite nflParent = new Composite(folder, SWT.NONE);
        nflParent.setBackground(folder.getDisplay().getSystemColor(SWT.COLOR_BLUE));
        nflParent.setLayout(new GridLayout());

        Button okButton = new Button(nflParent, SWT.PUSH);
        okButton.setText("OK");

        GridData gd = new GridData();
        gd.verticalAlignment = GridData.END;
        gd.horizontalAlignment = GridData.END;
        gd.grabExcessHorizontalSpace = true;
        gd.grabExcessVerticalSpace = true;
        okButton.setLayoutData(gd);

        NFL.setControl(nflParent);

        CTabItem NBA = new CTabItem(folder, SWT.NONE);
        NBA.setText("NBA Bets");

        CTabItem CFB = new CTabItem(folder, SWT.NONE);
        CFB.setText("CFB Bets");

        folder.setSize(800, 500);
    }

    public static void main(String[] args) {
        Display display = new Display();
        new TabsTest(display);
        display.dispose();
    }
} 
```

# java - Safari/Webkit 上的后退按钮从缓存加载页面而不是新副本

> ID：13998319
> 
> 赞同：0
> 
> 时间：2012-12-21T23:05:48.777
> 
> 标签：java, javascript, web-applications, safari, webkit

我在 Mac OSX 系统上遇到与后退按钮的功能相关的 Safari/Webkit 的“奇怪”行为问题，同时在浏览器上**禁用了 javascript 。**

我的场景是一个 Web 应用程序，它包含一个登录页面，在成功登录后，它将引导用户进入 page1。如果用户退出 page1，那么他/她将被重定向到 page2。对 page1 的会话外和未经身份验证的请求将通过 302 HTTP 响应重定向到初始登录页面。

还值得一提的是，对 page1 的请求的响应中存在以下 HTTP 标头，以防止浏览器缓存该页面：

```
Cache-Control: no-cache, no-store, max-age=0, must-revalidate
Expires: Thu, 1 JAN 1970
Pragma: no-cache 
```

从 page1 成功注销后，用户将被重定向到 page2。如果此时用户决定单击后退按钮，则浏览器将从其缓存加载 page1，而不是再次访问服务器以检索新副本。**请注意，这一切都是在 Safari 中禁用 javascript 时发生的，启用它会产生从 Web 服务器重新加载 page1 的预期结果，从而使用户被重定向到初始登录页面**

我试图在页面正文标记上设置一个卸载事件处理程序，以防止 Webkit 将页面加载到其页面缓存中，但这似乎并没有解决问题。

其他主流浏览器，FF、IE 和 Chrome 似乎在 JS 和非 JS 情况下都产生了预期的结果。

我是否在这里遗漏了什么，或者这听起来更像是 Safari/WebKit 的错误？

干杯;

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-27T11:37:23.463

这是因为 Webkit/Safari 中的页面缓存功能。您可以在以下链接中找到有关此的更多信息

[导航返回/未触发事件时 iOS 5 Safari 中的页面缓存问题](https://stackoverflow.com/questions/7988967/problems-with-page-cache-in-ios-5-safari-when-navigating-back-unload-event-not)

作为快速修复，您可以尝试向窗口卸载事件添加一个空函数。当它出现时，Webkit/Safari 不会将页面添加到 pageCache 中——让页面像其他浏览器一样正常加载。

# c++ - SFML 2.0 等效于 SetFromRect()？

> ID：13998320
> 
> 赞同：0
> 
> 时间：2012-12-21T23:05:59.307
> 
> 标签：c++, view, camera, scroll, sfml

我需要为 SFML 2.0 找到等效的 SetFromRect()。我在相机类中使用它，我正在更新精灵可以自由移动的矩形的位置。一旦它到达屏幕中间，它将通过使用新坐标重新更新矩形来开始滚动相机。

```
void Camera::Update(int x, int y)
{
    cameraX = -(ScreenWidth / 2) + x;
    cameraY = -(ScreenHeight / 2) + y;

    std::cout << "cameraX: " << cameraX << std::endl;
    std::cout << "cameraY: " << cameraY << std::endl;

    if(cameraX < 0)
        cameraX = 0;
    if(cameraY < 0)
        cameraY = 0;

    CameraPosition.setViewport(sf::FloatRect(cameraX, cameraY, cameraX + ScreenWidth, cameraY + ScreenHeight));
    std::cout << "cameraX + ScreenWidth: " << cameraX + ScreenWidth << std::endl;
    std::cout << "cameraY + ScreenWidth: " << cameraY + ScreenWidth << std::endl;
} 
```

一切正常，除了：

```
CameraPosition.setViewport(sf::FloatRect(cameraX, cameraY, cameraX + ScreenWidth, cameraY + ScreenHeight)); 
```

它获得了所有正确的数字，但我认为这是错误的功能。

我确实尝试了 reset() 但它也没有工作。

编辑：

正确的代码是：

```
CameraPosition.reset(sf::FloatRect(cameraX, cameraY, ScreenWidth, ScreenHeight));
CameraPosition.setViewport(sf::FloatRect(0,0,1,1)); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:07:50.857

SFML 2.0 矩形类型从 (left, top, right, bottom) 更改为 (left, top, width, height)。我也经常犯这个错误。

要移动相机，您需要做的就是移动`sf::View`. 在您的代码中，就像调用`CameraPosition.setCenter(x, y);`.

# coldfusion - 在字符串中查找电子邮件地址 - ColdFusion 9

> ID：13998321
> 
> 赞同：3
> 
> 时间：2012-12-21T23:06:00.853
> 
> 标签：coldfusion, coldfusion-9

我想知道 Coldfusion 是否具有在字符串中查找电子邮件地址的内置功能。

我正在尝试通读查询输出前。“John Smith jsmith@example.com”并只发送电子邮件。

我过去做过类似的事情，我在计算字符串的空格，在第二个字符串之后，我清除了左侧的所有字符，它只保留了电子邮件地址。

尽管这可以在我的情况下工作，但它并不安全，并且几乎可以保证错误和滥用可能以不同格式出现的数据，例如“John jsmith@example.com”，在这种情况下，我将清除所有信息。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-12-21T23:35:17.583

正则表达式可能是最简单的方法。电子邮件有一个非常大的终极正则表达式。这应该涵盖大多数有效的电子邮件。例如，这不包括 unicode。请注意，最大 TLD 长度为 63（请参阅[此 SO question & answer](https://stackoverflow.com/questions/9238640/how-long-can-a-tld-possibly-be)）。

```
<cfset string="some garbae@.ca garbage@ca.a real@email.com another@garbage whatever another@email.com oh my!">

<cfset results = reMatchNoCase("[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,63}", string)>

<cfdump var="#results#"> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:27:17.720

您可以使用Ray Camden[的 cflib.org 中的这个 UDF 。](http://cflib.org/udf/getEmails)这对我很有效

```
<cfscript>
/**
 * Searches a string for email addresses.
 * Based on the idea by Gerardo Rojas and the isEmail UDF by Jeff Guillaume.
     * New TLDs  
     * v3 fix by Jorge Asch
                     * 
 * @param str    String to search. (Required)
 * @return Returns a list. 
 * @author Raymond Camden 
 * @version 3, June 13, 2011 
 */
function getEmails(str) {
    var email = "(['_a-z0-9-]+(\.['_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*\.    ((aero|coop|info|museum|name|jobs|travel)|([a-z]{2,3})))";
var res = "";
var marker = 1;
var matches = "";

matches = reFindNoCase(email,str,marker,marker);

while(matches.len[1] gt 0) {
    res = listAppend(res,mid(str,matches.pos[1],matches.len[1]));
    marker = matches.pos[1] + matches.len[1];
    matches = reFindNoCase(email,str,marker,marker);        
}
return res;
}
</cfscript> 
```

# shell - bash命令拆分xpath的元素

> ID：13998325
> 
> 赞同：0
> 
> 时间：2012-12-21T23:06:42.213
> 
> 标签：shell, xpath

我正在寻找一些 linux shell 命令来帮助我检查 XPath 的元素。
例如，给定：

```
/a[@e=2]/bee/cee[@e<9]/@dee 
```

我需要分别返回三个命令：

```
a
[@e=2]
/bee/cee[@e<9]/@dee 
```

后来我可以重复这个过程，以便分析所有的Xpath。

我试过使用**sed**和正则表达式，但我做不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T13:27:21.320

`sed`奇怪的请求...但是您可以使用该模式轻松完成此操作`^/\([-a-zA-Z0-9_]*\)\(\[[^]]*\]\)\(.*\)$`。您请求的段是三个捕获。

```
zsh% data='/a[@e=2]/bee/cee[@e<9]/@dee'
zsh% pattern='^/\([-a-zA-Z0-9_]*\)\(\[[^]]*\]\)\(.*\)$'
zsh% sed "s#$pattern#\1#" <($data)
a
zsh% sed "s#$pattern#\2#" <($data)
[@e=2]
zsh% sed "s#$pattern#\3#" <($data)
/bee/cee[@e<9]/@dee
zsh% 
```

该模式非常专门用于请求。XPath 表达式很难在 shell 中拆分 - 既麻烦又昂贵。根据您要完成的工作，您最好根据语言偏好将 shell 脚本翻译成 Python、Ruby 或 Perl。您可能还想看看使用[zsh](http://zsh.sourceforge.net)而不是 Bash。我发现它更适合高级脚本。

# javascript - 使用 jquery 从侧面滑动（没有 Jquery UI）

> ID：13998326
> 
> 赞同：2
> 
> 时间：2012-12-21T23:07:00.247
> 
> 标签：javascript, jquery, jquery-animate

我想让它`specialist_pagecontent`从左边出现（滑动），就像`blindleftin`从[这里开始](http://jsfiddle.net/ARTsinn/65QsU/)一样，但我无法让它与[this](http://jsfiddle.net/Jwkw6/)一起工作。实际上，计划是，而不是`hide()`理想`blindLeftOut('fast');hide()`，而不是`show()`我需要`show();blindLeftOut('slow')`，但正如我所说，我不能让blindLeftOut 和blindLeftIn 为我工作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:16:07.410

我认为 jQuery 的[动画](http://api.jquery.com/animate/)功能可能对你有用。

您需要做的是将位于窗口外的隐藏 div 添加到您的 HTML 中（或者`document.ready`如果您愿意，可以在事件上使用 jquery 动态添加它）并使用上述动画函数将其滑入并out 并将其绑定到菜单项的单击功能。

# 工作小提琴

这是一个适合您的[JSFiddle](http://jsfiddle.net/QPhB3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:12:42.820

给你想要动画进出的元素一个`viweport`. 一个层，您可以通过它查看其中的元素。然后将 this`viewport`的`overflow`属性设置为`hidden`并给它一个特定的宽度/高度。

通过这种方式，您可以为其中的元素设置动画，`viewport`使它们看起来可以滑入/滑出。

以下是我对您的 JS 所做的更改：

```
//notice the use of the "active" class to save state
$('.specialist_pagecontent').eq(0).addClass("active").animate({ left : 0 }, 500);
$('.specialist').click(function() {  
    //stop() is used to stop the current animation, so animations don't queue up if many buttons are clicked rapidly
    $('.specialist_pagecontent').filter(".active").removeClass("active").stop(true).animate({ left : '-100%' }, 500); 
    $('.selected-specialist').removeClass('selected-specialist');
    $(this).addClass('selected-specialist');
     $('.specialist_pagecontent').eq($(this).index('.specialist')).addClass("active").stop(true).animate({ left : 0 }, 500);
}); 
```

以下是我对 CSS 的建议编辑：

```
.specialist_pagecontent {
    position:absolute;
    top:0;
    left:-100%;
}
#specialist_lists {
    float:left;
    border: 1px solid #000000;
    position:relative;
    width:200px;
    height:200px;
    overflow:hidden;
} 
```

这是一个演示：http: [//jsfiddle.net/Jwkw6/1/](http://jsfiddle.net/Jwkw6/1/)

这绝对定位了要动画的元素，这非常有用，因为它从文档的常规流中删除了元素（这意味着它在动画时不会触发整个页面重绘）。这也创建了`viewport`我提到的，创建了一个窗口，我们可以在其中查看动画。

# web-services - 肥皂绑定风格的消息之间有什么区别：文档与 RPC？

> ID：13998341
> 
> 赞同：0
> 
> 时间：2012-12-21T23:08:30.013
> 
> 标签：web-services

肥皂绑定风格的消息之间有什么区别：文档与 RPC？

我知道文档样式填充了 xsd 的详细信息，其中包含输入/输出的详细信息 - 请求/响应消息以文档样式而不是 RPC，从而使客户端的开发人员更容易理解最终将离开客户端/服务器的消息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T04:11:52.293

是的。有很多不同之处。SOAP 在 XSD 出现之前就出现了。阅读此[SOAP 绑定：文档和 RPC 样式 Web 服务之间的区别](http://java.globinch.com/enterprise-java/web-services/soap-binding-document-rpc-style-web-services-difference/)以了解更多信息

# c# - 将对象转换为单元素列表的快速方法？

> ID：13998343
> 
> 赞同：4
> 
> 时间：2012-12-21T23:08:53.290
> 
> 标签：c#, list, .net-2.0

`C# 2.0`从单个对象创建单元素列表最快的方法是什么？

例如：

```
MyObject obj = new MyObject();
List<MyObject> list = new List<MyObject> { obj };    // is this possible? 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T23:15:18.323

您的示例代码

```
List<MyObject> list = new List<MyObject> { obj }; 
```

使用集合初始化程序，这在 C# 2.0 中不可用。您可以使用数组初始值设定项，而不是：

```
List<MyObject> list = new List<MyObject>(new MyObject[] { obj }); 
```

或者，只需制作列表并添加对象：

```
List<MyObject> list = new List<MyObject>(1);
list.Add(obj); 
```

请注意，“单例”通常指的是[单例模式](http://en.wikipedia.org/wiki/Singleton_pattern)；正如您从评论中看到的那样，使用该术语来指代包含一个元素的集合是令人困惑的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-01-24T04:42:22.440

您可以创建以下扩展名，然后在要创建自身列表的任何对象上调用它。

唯一的缺点是它会污染扩展空间......所以如果你发现自己经常使用它，我只会这样做。

```
public static partial class Extensions
{
    public static List<T> ToListOfSelf<T>(this T item)
    {
        return new List<T>() { item };
    }
} 
```

例如 myObject.ToListOfSelf();

# gdb - 如何让 GDB 按字面意思打印字符串（不转义）？

> ID：13998349
> 
> 赞同：8
> 
> 时间：2012-12-21T23:09:45.457
> 
> 标签：gdb

我有一个大而长的字符串，我想将它捕获到一个文件中。我可以使用日志记录来获得大部分的方式：

```
设置登录
设置日志文件 gdb.log
```

…但是如果我使用`p`or`x/s`来打印字符串，引号和垃圾都会被转义。如何按原样获取字符串？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-24T18:52:49.517

对于*非常*大的字符串，您还可以使用：

```
(gdb) set variable $s = MY_STRING
(gdb) dump binary memory FILE $s $s + (size_t)strlen($s) 
```

它可以很容易地适应处理带有空字节的缓冲区。此外 FILE 的内容永远不会包含字符串以外的任何内容。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-21T23:09:45.457

啊，我完全忘记了`printf`：

```
printf "%s\n", some_string
```

# php - PHP Mail 使用多个函数调用隐藏其他收件人地址

> ID：13998355
> 
> 赞同：3
> 
> 时间：2012-12-21T23:10:14.087
> 
> 标签：php, email

我有一个 PHP 脚本，它在函数调用中向多个收件人发送电子贺卡（采用逗号分隔的电子邮件地址数组，并分别发送`mail()`给每个收件人）。但是，在查看收到的电子邮件时，每个客户都可以看到电子邮件发送到的其他地址，这让我相信它们都是在一封电子邮件中发送的，尽管是单独的`mail()`电话。这是我当前的代码：

```
<?php
$headers  = "From: ".$_POST['email']."\r\n"; 
$headers .= "Content-type: text/html\r\n";
$array=explode(",", $_POST['sendto']);
for ($i = 0; $i < count($array); ++$i) {
    mail(trim($array[$i]), "Happy Holidays!", $body, $headers);
}
?> 
```

如何解决此问题，以便收件人只能在“收件人”字段中看到他们的电子邮件地址？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T23:12:09.157

您要使用的是密件抄送字段。

*   [https://en.wikipedia.org/wiki/Blind_carbon_copy](https://en.wikipedia.org/wiki/Blind_carbon_copy)

代码：

```
<?php

$_POST['email'] = str_replace(array("\n", "\r"), '', $_POST['email']);
$_POST['sendto'] = str_replace(array("\n", "\r"), '', $_POST['sendto']);

$headers = "From: " . $_POST['email'] . "\r\n"
         . "Content-Type: text/html\r\n"
         . "BCC: " . $_POST['sendto'] . "\r\n";
mail($_POST['email'], 'Happy Holidays!', $body, $headers);

?> 
```

Send the email to the sender, but BCC the recipients. Also I removed \r and \n chars from the BCC and FROM field otherwise will allow mail header injection attack. Make sure to do the same to $body.

# java - Java 中的可变关键字和同步关键字

> ID：13998357
> 
> 赞同：0
> 
> 时间：2012-12-21T23:10:30.093
> 
> 标签：java

> **可能重复：**
> [JAVA (j2me) 中 volatile 和 synchronized 之间的区别](https://stackoverflow.com/questions/3519664/difference-between-volatile-and-synchronized-in-java-j2me)

我对 2 个 java 关键字`synchronized`和`volatile`.

据我了解，由于 java 是一种`multi-threaded`语言，并且通过使用关键字`synchronized`将强制它在 1 个线程中执行。我对么 ？

并且`volatile`也做同样的事情？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T23:19:00.050

volatile 和 synchronized 都保证了可见性，但 synchronized 也提供了原子性：

*   如果一个线程线程读取一个 volatile 变量，它可以保证看到之前对同一变量的写入，包括它们是否由其他线程完成
*   同步块提供相同的保证（假设写入和读取完成并持有相同的监视器）但也提供原子性保证：同步块中的所有指令从在同一锁上同步的另一个线程看起来都是原子的。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-21T23:13:45.373

for`long`和`double`读写操作不是原子的。 `volatile`是一个修饰符，您可以放在变量上以使读写操作原子化（包括`long`and `double`）

文章[Atomic Access](http://docs.oracle.com/javase/tutorial/essential/concurrency/atomic.html)获得了有关它的更多信息。

基本上它是为了确保如果一个线程更改了变量的值，其余线程将看到该更改并且在写入时将无法读取它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-21T23:26:37.683

Java 多线程涉及两个问题，确保可以一致地完成多个操作，而不会混合不同线程的操作，以及使变量值的更改对执行更改以外的线程可用。

实际上，变量自然不会存在于硬件中的单个位置。不同线程的内部状态中可能存在副本，或者在不同的硬件缓存中。从执行分配的线程的角度来看，简单地分配给变量会自动更改其值。

如果变量被标记为“volatile”，其他线程将获得更改后的值。

“同步”还确保更改变得可见。具体来说，在同步块结束之前在一个线程中完成的任何更改对于在同一对象上同步的后续块中的另一个线程完成的读取都是可见的。

此外，在同一对象上同步的块被强制按顺序运行，而不是并行运行。这允许人们做一些事情，比如将一个变量加一，知道它的值在读取旧值和写入新值之间不会改变。它还允许对多个变量进行一致的更改。

我知道学习用 Java 编写可靠的并发代码所需的最佳方法是阅读[Java Concurrency in Practice](https://rads.stackoverflow.com/amzn/click/com/0321349601)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-21T23:13:17.260

本质上， volatile 用于指示变量的值将被不同的线程修改。

Synchronized 是一个关键字，其总体目的是一次只允许一个线程进入特定的代码部分，从而允许我们保护变量或数据不被来自不同线程的同时修改破坏。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-12-21T23:14:09.100

[它和Java 内存模型](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html)中描述的一样复杂。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-12-21T23:16:37.440

同步意味着在给定时间只有一个线程可以访问方法或代码块。

Volatile 处理线程之间的通信。这是一个很好的解释：http: [//jeremymanson.blogspot.be/2008/11/what-volatile-means-in-java.html](http://jeremymanson.blogspot.be/2008/11/what-volatile-means-in-java.html)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-12-21T23:19:25.907

Volatile 关键字将使每个线程在内存位置中读取或写入作为原子操作。如果您不使用 volatile，则该变量可能会被线程缓存，并且线程可能正在读取/写入缓存副本而不是实际副本。

# rspec - has_one 和 belongs_to 关联的 FactoryGirl 问题

> ID：13998360
> 
> 赞同：6
> 
> 时间：2012-12-21T23:11:16.897
> 
> 标签：rspec, ruby-on-rails-3.2, factory-bot

我已经与我的协会斗争了 3 天，不知道还能去哪里。我确信问题很简单，但我对 Ruby on Rails 还很陌生，这让我很困惑......

我创建了一个 User 模型，它包含所有用于 Devise 身份验证的登录凭据。我有另一个 Profile 模型，其中包含所有用户的设置（名字等）。最后，我有一个地址模型，它使用与配置文件关联的多态关联。

用户`has_one`配置文件。配置文件`belongs_to`用户和`has_one`地址。Address 是一个多态关联，它使我的应用程序中的其他模型能够具有与之关联的地址。

有一次，我的所有 FactoryGirl 定义都在工作，但我正在解决一个`accepts_nested_attributes_for`问题并添加了一个`after_initialize`回调来构建用户的配置文件和配置文件的地址。现在我的工厂之间有一个循环引用，我的 rspec 输出充满了：

```
stack level too deep 
```

由于过去几天我对配置进行了如此多的修改，我觉得最好停下来寻求帮助。:) 这就是我在这里的原因。如果有人可以帮助我，我将不胜感激。

这是我的出厂配置：

**用户工厂**

```
FactoryGirl.define do
  sequence(:email) {|n| "person-#{n}@example.com"}
  factory :user do
    profile
    name 'Test User'
    email 
    password 'secret'
    password_confirmation 'secret'
    # required if the Devise Confirmable module is used
    confirmed_at Time.now
  end
end 
```

**型材厂**

```
FactoryGirl.define do
  factory :profile do
    address
    company_name "My Company"
    first_name "First"
    last_name "Last"
  end
end 
```

**地址工厂**

```
FactoryGirl.define do
  factory :address do
    association :addressable, factory: :profile
    address "123 Anywhere"
    city "Cooltown"
    state "CO"
    zip "12345"
    phone "(123) 555-1234"
    url "http://mysite.com"
    longitude 1.2
    latitude 9.99
  end
end 
```

理想情况下，我希望能够独立地测试每个工厂。在我的用户模型测试中，我希望有一个像这样的有效工厂：

```
describe "user"
  it "should have a valid factory" do
    FactoryGirl.create(:user).should be_valid
  end
end

describe "profile"
  it "should have a valid factory" do
    FactoryGirl.create(:profile).should be_valid
  end
end

describe "address"
  it "should have a valid factory" do
    FactoryGirl.create(:address).should be_valid
  end
end 
```

秘方是什么？我查看了 Factory Girl 的 wiki 和整个网络，但我担心我在搜索中没有使用正确的术语。此外，在我偶然发现的每个搜索结果中，似乎有 4 种不同的方法可以在 FactoryGirl 中使用混合语法来完成所有操作。

提前感谢您的任何见解...

## 更新：2012 年 12 月 26 日

我的个人资料/用户关联倒退了。我没有让 User 引用 Profile 工厂，而是将其翻转以让 Profile 引用 User 工厂。

这是最终的工厂实现：

**用户工厂**

```
FactoryGirl.define do
  sequence(:email) {|n| "person-#{n}@example.com"}
  factory :user do
    #profile <== REMOVED THIS!
    name 'Test User'
    email 
    password 'please'
    password_confirmation 'please'
    # required if the Devise Confirmable module is used
    confirmed_at Time.now
  end
end 
```

**型材厂**

```
FactoryGirl.define do
  factory :profile do
    user # <== ADDED THIS!
    company_name "My Company"
    first_name "First"
    last_name "Last"
  end
end 
```

**地址工厂**

```
FactoryGirl.define do
  factory :address do
    user
    association :addressable, factory: :profile
    address "123 Anywhere"
    city "Cooltown"
    state "CO"
    zip "90210"
    phone "(123) 555-1234"
    url "http://mysite.com"
    longitude 1.2
    latitude 9.99
  end
end 
```

所有测试通过！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T06:53:58.523

根据提问者的要求，

你`profile`留空了。为了链接用户和配置文件，您需要填写剩余的行并让 FactoryGirl 知道用户和配置文件已链接。

# ember.js - 使用 ember 单击时打开一个新窗口

> ID：13998363
> 
> 赞同：5
> 
> 时间：2012-12-21T23:11:41.607
> 
> 标签：ember.js

用户单击链接时如何打开新窗口？

我试过添加`target="_blank"`和 bindAttr 但它不起作用。

不起作用的代码：

```
<a target="_blank" {{action goToSettings href=true}}>App Settings</a> 
```

或者

```
<a {{bindAttr target="_blank"}} {{action goToSettings href=true}}>App Settings</a> 
```

这是第一个示例的 html 输出：

```
<a target="_blank" href="#/settings" data-ember-action="5">App Settings</a> 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T03:13:55.193

你有两个选择：

1.  发送一个动作，并在处理该动作的 javascript 中，调用 `window.open(...)`以打开一个新窗口到特定 URL
2.  不要使用操作，而是将其设为静态链接，或者如果您需要动态更改目标 URL，请使用`<a target="_blank" {{bindAttr href="yourBoundPropForTheUrl"}}>Click here</a>`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-11-04T04:30:17.020

This has been added to [LinkView](http://emberjs.com/api/classes/Ember.LinkView.html#property_target), and therefore is now supported directly in `{{link-to}}`.

Pull request is at [https://github.com/emberjs/ember.js/pull/4718](https://github.com/emberjs/ember.js/pull/4718)

# android - LibGDX：Android SpriteBatch 不绘图

> ID：13998369
> 
> 赞同：1
> 
> 时间：2012-12-21T23:12:15.123
> 
> 标签：android, libgdx

我很难让 spriteBatch 在 LibGDX 中呈现。它显示了我何时在桌面上运行它，但在 Android 上却没有。我要渲染的精灵是星星背景。

桌面：http: [//i.stack.imgur.com/6a4m5.png](http://i.stack.imgur.com/6a4m5.png)

安卓：http: [//i.stack.imgur.com/mOvo2.png](http://i.stack.imgur.com/mOvo2.png)

这是我的代码：

```
@Override
public void render(float delta) {
    Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT | GL10.GL_DEPTH_BUFFER_BIT);
    Gdx.gl.glClearColor(0, 0, 0, 1);

    update(delta);

    spriteBatchBack.begin();
    sprite.draw(spriteBatchBack);
    spriteBatchBack.end();

    stage.act(delta);
    stage.draw();
}

public void update(float delta) {
    scrollTimer += delta * 0.03f;
    if (scrollTimer > 1.0f)
        scrollTimer = 0.0f;

    sprite.setU(scrollTimer);
    sprite.setU2(scrollTimer + 1);
}

int width = Gdx.graphics.getWidth();
int height = Gdx.graphics.getHeight();

@Override
public void resize(int width, int height) {
    if (stage == null) {
        stage = new Stage(width, height, true);
        stage.clear();
        addMusic();
        addBackground();
        addScence();
        stage.addActor(play);
        stage.addActor(options);
        stage.addActor(quit);
        stage.addActor(logoHead);
        stage.addActor(lblPlay);
        stage.addActor(lblOptions);
        stage.addActor(lblQuit);
    }
    Gdx.input.setInputProcessor(stage);
}

public void addBackground() {
    spriteBatchBack = new SpriteBatch();
    Texture spriteTexture = new Texture(
            Gdx.files.internal("pictures/menuBackground.png"));

    spriteTexture.setWrap(TextureWrap.Repeat, TextureWrap.Repeat);
    sprite = new Sprite(spriteTexture, 0, 0, spriteTexture.getWidth(), spriteTexture.getHeight());
    sprite.setSize(width, height);
} 
```

如果我遗漏了任何重要的内容，请发表评论并告诉我。谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-02T00:24:27.833

我发现了我的问题。结果很简单，我使用的手机不支持 Open GL 2.0。为了解决这个问题，我将所有纹理的大小重新调整为 2 的幂，并将配置设置更改为 Open GL 1.1。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-24T07:49:39.067

尝试使用“图像”演员作为舞台背景，而不是使用 spritebatch 和自己绘制。

# android - 如何比较字符串中的两个字符？

> ID：13998374
> 
> 赞同：-3
> 
> 时间：2012-12-21T23:12:48.987
> 
> 标签：android, eclipse

嘿，谁能帮忙，我有一个包含 4 个字符的字符串，我需要确保这些字符中没有一个是彼此相同的。怎么做？我已经查找了一个类似的问题，但不完全是

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:16:12.380

尝试使用正则表达式作为`(\\w)\\1+`. 如果您找到匹配项，则表示字符串中有重复字符，例如

```
 Pattern pattern = Pattern.compile("(\\w)\\1+");
    Matcher matcher = pattern.matcher("aabc");//your string to be passed here
    if(matcher.find()){
        System.out.println("Duplicate Characters exist");
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:23:10.253

```
char a = str.charAt(0);
char b = str.charAt(1);
char c = str.charAt(2);
char d = str.charAt(3);

return a != b && a != c && a != d && b != c && b != d && c != d; 
```

粗略，仅在这种特殊情况下有效，但可能是最佳的。

# system-verilog - 为什么我不能在 SystemVerilog 的逻辑中存储 16 位？！

> ID：13998376
> 
> 赞同：0
> 
> 时间：2012-12-21T23:13:01.860
> 
> 标签：system-verilog

我目前在尝试将来自模块输入的 16 位数字存储到我的逻辑变量之一时遇到问题。当我在测试台上将所有位设置为高时，我得到一个值：0000000000000001。希望您能提供帮助！PS：对不起，不知道如何在这里插入代码......

我的代码如下所示：

[http://pastebin.com/cZCYKJqV](http://pastebin.com/cZCYKJqV)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T03:27:18.273

我认为您的问题可能与这条线有关：

```
regy = (!regy)+1; 
```

`regy`是一个 16 位的值。`(!)`对多位值使用否定运算符等效于`(value != 0)`. 因此，对于`regy`除零以外的任何值都将设置`regy`为 1。

如果您尝试反转所有位并加 1，则需要使用`~`运算符。

例子：

```
regy = (~regy)+1; 
```

# java - 目录监视java中的变化

> ID：13998379
> 
> 赞同：14
> 
> 时间：2012-12-21T23:13:20.740
> 
> 标签：java, nio

我正在使用 WatchService 来观察目录的变化，特别是在目录中创建新文件。下面是我的代码 -

```
package watcher;

import java.nio.file.*;
import static java.nio.file.StandardWatchEventKinds.ENTRY_CREATE;
import static java.nio.file.StandardWatchEventKinds.OVERFLOW;
import java.io.*;

public class Watch {
    public static void main(String[] args) throws IOException {
        Path dir = Paths.get("c:\\mk\\");
        WatchService service = FileSystems.getDefault().newWatchService();
        WatchKey key = dir.register(service, ENTRY_CREATE);

        System.out.println("Watching directory: "+dir.toString());
        for(;;){
            WatchKey key1;
            try {
                key1 = service.take();
            } catch (InterruptedException x) {
                break;
            }

            for (WatchEvent<?> event: key1.pollEvents()) {
                WatchEvent.Kind<?> kind = event.kind();

                if (kind == OVERFLOW) {
                    continue;
                }

                WatchEvent<Path> ev = (WatchEvent<Path>)event;
                Path filename = ev.context();
                Path child = dir.resolve(filename);
                System.out.println("New file: "+child.toString()+" created.");
                try{
                    FileInputStream in = new FileInputStream(child.toFile());
                    System.out.println("File opened for reading");
                    in.close();
                    System.out.println("File Closed");
                }catch(Exception x){
                    x.printStackTrace();
                }
            }

            boolean valid = key.reset();
            if (!valid) {
                break;
            }
        }
    }
} 
```

当我在“mk”目录中创建文件时，我会收到通知。但是当我在这个目录中复制一些文件时，我在打开那个复制的文件时遇到了异常。

我的猜测是 Windows Copier 对话框仍然锁定了该文件，我无法打开该文件。所以基本上我想知道的是如何获得通知文件已被其他进程关闭。

上面代码的输出就像 -

```
Watching directory: c:\mk
New file: c:\mk\New Text Document (2).txt created.
File opened for reading
File Closed
New file: c:\mk\Config.class created.
java.io.FileNotFoundException: c:\mk\Config.class (The process cannot access the file because it is being used by another process)
        at java.io.FileInputStream.open(Native Method)
        at java.io.FileInputStream.<init>(FileInputStream.java:138)
        at watcher.Watch.main(Watch.java:36)
New file: c:\mk\New Text Document (3).txt created.
File opened for reading
File Closed 
```

文件“ `New Text Document (2).txt`”和“ `New Text Document (3).txt`”我已创建，但文件“ `Config.class`”我已从其他目录复制。

请帮助我。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-03T18:18:59.557

我通过实现算法得到了这个工作：观察线程将把文件名放在 BlockingQueue 中，其他线程将轮询这个队列，获取文件名，尝试几次打开文件。如果文件被打开，Windows Copier 已释放文件锁定，我们可以继续。因此，当其他线程发现文件已被解锁时，其他线程会将这个文件名放入已处理队列中，我的应用程序将从那里检索文件名。还有另一个线程在打开文件检查文件解锁时，如果运行时间长了解锁文件，我们可以把这个文件名放回BlockingQueue中处理其他文件名，前者可以稍后处理。

**解决方案：希望这对其他人有帮助：**

```
package dirwatch;

import java.nio.file.*;
import static java.nio.file.StandardWatchEventKinds.ENTRY_CREATE;
import static java.nio.file.StandardWatchEventKinds.OVERFLOW;
import static java.nio.file.LinkOption.*;
import java.nio.file.attribute.*;
import java.io.*;
import java.util.*;
import java.util.concurrent.ArrayBlockingQueue;
import java.util.concurrent.BlockingQueue;
import java.util.concurrent.TimeUnit;

public class WatchDir {
    private final WatchService watcher;
    private final Map<WatchKey,Path> keys;
    private final boolean recursive;
    private boolean trace = false;

    private BlockingQueue<String> fileProcessingQueue;

    //******* processedFileQueue **** will be used by other threads to retrive unlocked files.. so I have 
    // kept as public final
    public final BlockingQueue<String> processedFileQueue;
    private volatile boolean closeProcessingThread;
    private volatile boolean closeWatcherThread;

    private void processFiles(){
        System.out.println("DirWatchProcessingThread Started");
        String fileName;
        outerLoop: while(!closeProcessingThread || !fileProcessingQueue.isEmpty()){
            try{
                fileName = fileProcessingQueue.poll(1000, TimeUnit.MILLISECONDS);
            }catch(InterruptedException ie){
                fileName = null;
            }

            if(fileName == null || fileName.equals("")){
                continue outerLoop;
            }

            long startTime = System.currentTimeMillis();
            innerLoop: while(true){
                FileInputStream fis = null;
                File file = new File(fileName);
                try{
                    fis = new FileInputStream(fileName);
                    break innerLoop;
                }catch(FileNotFoundException fnfe){
                    if(!file.exists() || file.isDirectory()){
                        System.out.println("File: '"+fileName+"has been deleted in file system or it is not file. Not processing this file.");
                        continue outerLoop;
                    }
                    try{
                        Thread.sleep(WatchDirParameters.millisToPuaseForFileLock);
                    }catch(InterruptedException ie){
                    }
                    if((System.currentTimeMillis() - startTime) > WatchDirParameters.millisToSwapFileForUnlocking){
                        if(fileProcessingQueue.offer(fileName)){
                            continue outerLoop;
                        }else{
                            startTime = System.currentTimeMillis();
                            continue innerLoop;
                        }
                    }
                }finally{
                    if(fis != null){
                        try{
                            fis.close();
                        }catch(IOException ioe){
                            ioe.printStackTrace();
                        }
                    }
                }
            }

            System.out.println("Queuing File: "+fileName);
            processedLoop:while(true){
                try{
                    if(processedFileQueue.offer(fileName, 1000, TimeUnit.MILLISECONDS)){
                        break processedLoop;
                    }
                }catch(InterruptedException ie){
                    //ie.printStackTrace();
                }
            }
        }
        closeWatcherThread = true;
        closeProcessingThread = true;
        System.out.println("DirWatchProcessingThread Exited");
    }

    /**
     * Process all events for keys queued to the watcher
     */
    private void processEvents(){
        System.out.println("DirWatcherThread started.");
        while(!closeWatcherThread) {
            // wait for key to be signalled
            WatchKey key;
            try {
                key = watcher.take();
            } catch (InterruptedException x) {
                // if we are returning from these method, it means we no longer wants to watch directory
                // we must close thread which may be waiting for file names in queue
                continue;
            }catch(ClosedWatchServiceException cwse){
                break;
            }

            Path dir = keys.get(key);
            if (dir == null) {
                System.err.println("WatchKey not recognized!!");
                continue;
            }

            try{
                for (WatchEvent<?> event: key.pollEvents()) {
                    WatchEvent.Kind kind = event.kind();

                    if (kind == OVERFLOW) {
                        continue;
                    }

                    // Context for directory entry event is the file name of entry
                    WatchEvent<Path> ev = cast(event);
                    Path name = ev.context();
                    Path child = dir.resolve(name);
                    if(kind.equals(ENTRY_CREATE)){
                        // if directory is created, and watching recursively, then
                        // register it and its sub-directories
                        if (recursive) {
                            try {
                                if (Files.isDirectory(child, NOFOLLOW_LINKS)) {
                                    registerAll(child);
                                    continue;
                                }
                            } catch (IOException x) {
                                // ignore to keep sample readbale
                            }
                        }
                        while(true){
                            if(fileProcessingQueue.remainingCapacity() < 2){
                                // if only one last can be inserted then don't queue this we need 1 empty space in queue
                                // for swaping file names..
                                // sleep for some time so processing thread may have made some rooms to queue in fileQueue
                                // this logic will not create any problems as only one this thread is inserting in queue
                                try{
                                    Thread.sleep(200);
                                }catch(InterruptedException ie){
                                }
                                continue;
                            }
                            if(!fileProcessingQueue.offer(child.toString())){
                                // couldn't queue this element by whatever reason.. we will try to enqueue again by continuing loop
                                continue;
                            }else{
                                // file name has been queued in queue
                                break;
                            }
                        }
                    }
                }
                // reset key and remove from set if directory no longer accessible
                boolean valid = key.reset();
                if (!valid) {
                    keys.remove(key);

                    // all directories are inaccessible
                    if (keys.isEmpty()) {
                        break;
                    }
                }
            }catch(ClosedWatchServiceException cwse){
                break;
            }

        }
        closeProcessingThread = true;
        closeWatcherThread = true;
        System.out.println("DirWatcherThread exited.");
    }

    public void stopWatching(){
        try{
            watcher.close();
        }catch(IOException ioe){
        }
        closeProcessingThread = true;
        closeWatcherThread = true;
    }

    public static WatchDir watchDirectory(String dirName, boolean recursive) throws InvalidPathException, IOException, Exception{
        try{
            Path dir = Paths.get(dirName);
            final WatchDir watchDir = new WatchDir(dir, recursive);
            watchDir.closeProcessingThread = false;
            watchDir.closeWatcherThread = false;
            new Thread(new Runnable() {
                public void run() {
                    watchDir.processFiles();
                }
            }, "DirWatchProcessingThread").start();
            new Thread(new Runnable() {
                public void run() {
                    watchDir.processEvents();
                }
            }, "DirWatcherThread").start();
            return watchDir;
        }catch(InvalidPathException ipe){
            throw ipe;
        }catch(IOException ioe){
            throw ioe;
        }catch(Exception e){
            throw e;
        }
    }

    @SuppressWarnings("unchecked")
    private static <T> WatchEvent<T> cast(WatchEvent<?> event) {
        return (WatchEvent<T>)event;
    }

    /**
     * Register the given directory with the WatchService
     */
    private void register(Path dir) throws IOException {
        //WatchKey key = dir.register(watcher, ENTRY_CREATE, ENTRY_DELETE, ENTRY_MODIFY);
        WatchKey key = dir.register(watcher, ENTRY_CREATE);
        if (trace) {
            Path prev = keys.get(key);
            if (prev == null) {
                System.out.format("register: %s\n", dir);
            } else {
                if (!dir.equals(prev)) {
                    System.out.format("update: %s -> %s\n", prev, dir);
                }
            }
        }
        keys.put(key, dir);
    }

    /**
     * Register the given directory, and all its sub-directories, with the
     * WatchService.
     */
    private void registerAll(final Path start) throws IOException {
        // register directory and sub-directories
        Files.walkFileTree(start, new SimpleFileVisitor<Path>() {
            @Override
            public FileVisitResult preVisitDirectory(Path dir, BasicFileAttributes attrs) throws IOException {
                register(dir);
                return FileVisitResult.CONTINUE;
            }
        });
    }

    /**
     * Creates a WatchService and registers the given directory
     */
    private WatchDir(Path dir, boolean recursive) throws IOException {
        fileProcessingQueue = new ArrayBlockingQueue<String>(WatchDirParameters.fileQueueSize, false);
        processedFileQueue = new ArrayBlockingQueue<String>(WatchDirParameters.fileQueueSize, false);
        this.watcher = FileSystems.getDefault().newWatchService();
        this.keys = new HashMap<WatchKey,Path>();
        this.recursive = recursive;
        //CreateTxtFile.createFile(dir, 1);
        if (recursive) {
            System.out.format("Scanning %s ...\n", dir);
            registerAll(dir);
            System.out.println("Done.");
        } else {
            register(dir);
        }

        // enable trace after initial registration
        this.trace = true;
    }
} 
```

**参数类：**

```
package dirwatch;

public class WatchDirParameters {
    public static final int millisToPuaseForFileLock = 200;
    public static final int fileQueueSize = 500;
    public static final int millisToSwapFileForUnlocking = 2000;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-02-09T00:56:41.383

制作了@UDPLover 提供的文件的更新版本，该版本专为在高速率文件访问环境中使用而 `HashMap<String, WatchEvent>`构建本身。还制作了一个 print() 方法，允许启用或禁用由 WatchCore 打印到控制台的任何内容。原始示例中的文件轮询 for 循环已更新为使用 JDK8 函数 for 循环，使所有部分线程化/中断。这还没有经过测试，当我可以测试它时会更新修复。

```
package filewatcher;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.PrintStream;
import java.nio.file.ClosedWatchServiceException;
import java.nio.file.FileSystems;
import java.nio.file.FileVisitResult;
import java.nio.file.Files;
import static java.nio.file.LinkOption.NOFOLLOW_LINKS;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.nio.file.SimpleFileVisitor;
import static java.nio.file.StandardWatchEventKinds.ENTRY_CREATE;
import static java.nio.file.StandardWatchEventKinds.OVERFLOW;
import java.nio.file.WatchEvent;
import java.nio.file.WatchKey;
import java.nio.file.WatchService;
import java.nio.file.attribute.BasicFileAttributes;
import java.util.HashMap;
import java.util.Map;
import java.util.Map.Entry;
import java.util.logging.Level;
import java.util.logging.Logger;

/**
 *
 * @author Nackloose
 * http://stackoverflow.com/questions/13998379/directory-watching-for-changes-in-java
 */
public abstract class WatchCore extends Thread {

    //make class a thread by default
    /**
     * After the WatchCore recieves an event for a file and deems it unlocked,
     * it will be passed to this function
     *
     * @param e WatchEvent for the file, after it has been affirmed to be
     * unlocked.
     */
    public abstract void onEventAndUnlocked(WatchEvent e);
    private final WatchService watcher;
    private final Map<WatchKey, Path> keys;
    private final boolean recursive;
    private boolean trace = false;
    //converted to HashMap to remove the limitation as I need this in a high rate of file access enviroment.
    //as well as to carry the event passed for that folder into the block check itself.
    //got rid of the finished queue and made events pass to the abstract void above 
    private final HashMap<String, WatchEvent> fileProcessingQueue;
    //create a varible to keep track of the thread checking the file blocking, so we can start and stop it.
    private final WatchBlocker blocker;

    public WatchCore(String dir) throws IOException {
        //defaultly  dont recurse
        this(dir, false);
    }

    public WatchCore(String dir, boolean recursive) throws IOException {
        this(Paths.get(dir), recursive);

    }

    public WatchCore(Path dir) throws IOException {
        //defaultly  dont recurse
        this(dir, false);
    }

    public WatchCore(Path dir, boolean recursive) throws IOException {
        fileProcessingQueue = new HashMap<>();
        this.watcher = FileSystems.getDefault().newWatchService();
        this.keys = new HashMap<>();
        this.recursive = recursive;
        //CreateTxtFile.createFile(dir, 1);
        if (recursive) {
            print("Scanning %s ...", dir);
            registerAll(dir);
            print("Done.");
        } else {
            register(dir);
        }
        // enable trace after initial registration
        this.trace = true;
        //start the thread to process files to be checked for file blocking
        blocker = new WatchBlocker();
    }

    @SuppressWarnings("unchecked")
    private static <T> WatchEvent<T> cast(WatchEvent<?> event) {
        return (WatchEvent<T>) event;
    }

    @Override
    public synchronized void start() {
        //start up our thread _FIRST_
        super.start();
        //then start the blocking thread
        blocker.start();
    }

    @Override
    public void interrupt() {
        //Everything backwards, stop the blocker _FIRST_
        blocker.interrupt();
        //then stop our thread.
        super.interrupt();
    }

    /**
     * Register the given directory with the WatchService
     */
    private void register(Path dir) throws IOException {
        //WatchKey key = dir.register(watcher, ENTRY_CREATE, ENTRY_DELETE, ENTRY_MODIFY);
        WatchKey key = dir.register(watcher, ENTRY_CREATE);
        if (trace) {
            Path prev = keys.get(key);
            if (prev == null) {
                print("register: %s\n", dir);
            } else {
                if (!dir.equals(prev)) {
                    print("update: %s -> %s\n", prev, dir);
                }
            }
        }
        keys.put(key, dir);
    }

    /**
     * Register the given directory, and all its sub-directories, with the
     * WatchService.
     */
    private void registerAll(final Path start) throws IOException {
        // register directory and sub-directories
        Files.walkFileTree(start, new SimpleFileVisitor<Path>() {
            @Override
            public FileVisitResult preVisitDirectory(Path dir, BasicFileAttributes attrs) throws IOException {
                register(dir);
                return FileVisitResult.CONTINUE;
            }
        });
    }

    /**
     * Process all events for keys queued to the watcher
     */
    @Override
    public void run() {
        //this was previous called processEvents()
        //pruned any un-nessicary continues, labels, and labels on breaks, a lot of them
        //were redundant
        print("DirWatcherThread started.");
        //as long as we're not interrupted we keep working
        while (!interrupted()) {
            // wait for key to be signalled
            WatchKey key;
            try {
                key = watcher.take();
            } catch (InterruptedException x) {
                // if we are returning from these method, it means we no longer wants to watch directory
                // we must close thread which may be waiting for file names in queue
                continue;
            } catch (ClosedWatchServiceException cwse) {
                break;
            }

            Path dir = keys.get(key);
            if (dir == null) {
                printe("WatchKey not recognized!!");
                continue;
            }

            try {
                //converted to functional for loop.
                key.pollEvents().stream().filter((event) -> {
                    WatchEvent.Kind kind = event.kind();
                    return !(kind == OVERFLOW); //make sure we do the filter
                }).forEach((event) -> {
                    WatchEvent.Kind kind = event.kind();
                    // Context for directory entry event is the file name of entry
                    WatchEvent<Path> ev = cast(event);
                    Path name = ev.context();
                    Path child = dir.resolve(name);
                    if (kind.equals(ENTRY_CREATE)) {
                        // if directory is created, and watching recursively, then
                        // register it and its sub-directories
                        if (recursive) {
                            try {
                                if (Files.isDirectory(child, NOFOLLOW_LINKS)) {
                                    registerAll(child);
                                    return; //continue;
                                }
                            } catch (IOException x) {
                                // ignore to keep sample readbale
                            }
                        }
                        fileProcessingQueue.put(child.toString(), ev);
                    }
                });
                // reset key and remove from set if directory no longer accessible
                boolean valid = key.reset();
                if (!valid) {
                    keys.remove(key);

                    // all directories are inaccessible
                    if (keys.isEmpty()) {
                        break;
                    }
                }
            } catch (ClosedWatchServiceException cwse) {
                break;
            }

        }
        print("DirWatcherThread exited.");
    }

    /**
     *
     * @author
     * http://stackoverflow.com/questions/13998379/directory-watching-for-changes-in-java
     * Nackloose
     */
    private class WatchBlocker extends Thread {

        @Override
        public synchronized void start() {
            //get it going
            super.start();
        }

        @Override
        public void interrupt() {
            //interupt our thread
            super.interrupt();
        }

        @Override
        public void run() {
            //this was perviously processFiles()
            //pruned any un-nessicary continues, labels, and labels on breaks, a lot of them
            //were redundant
            print("DirWatchProcessingThread Started");
            Entry<String, WatchEvent> fileEvent;
            outerLoop:
            //as long as we're not interrupted we keep working
            while (!interrupted()) {
                if (fileProcessingQueue.isEmpty()) {
                    try {
                        Thread.sleep(WatchCoreParameters.timeToIdle);
                    } catch (InterruptedException ex) {
                        Logger.getLogger(WatchCore.class.getName()).log(Level.SEVERE, null, ex);
                    }
                    continue;
                }
                fileEvent = fileProcessingQueue.entrySet().iterator().next();
                fileProcessingQueue.remove(fileEvent.getKey());

                long startTime = System.currentTimeMillis();
                while (true) {
                    FileInputStream fis = null;
                    File file = new File(fileEvent.getKey());
                    try {
                        fis = new FileInputStream(fileEvent.getKey());
                        break;
                    } catch (FileNotFoundException fnfe) {
                        if (!file.exists() || file.isDirectory()) {
                            print("File: '" + fileEvent + "has been deleted in file system or it is not file. Not processing this file.");
                            continue outerLoop;
                        }
                        try {
                            Thread.sleep(WatchCoreParameters.millisToPauseForFileLock);
                        } catch (InterruptedException ie) {
                        }
                        if ((System.currentTimeMillis() - startTime) > WatchCoreParameters.millisToSwapFileForUnlocking) {
                            fileProcessingQueue.put(fileEvent.getKey(), fileEvent.getValue());
                        }
                    } finally {
                        if (fis != null) {
                            try {
                                fis.close();
                            } catch (IOException ioe) {
                                ioe.printStackTrace();
                            }
                        }
                    }
                }
                print("Queuing File: " + fileEvent);
                //pass the unlocked file event to the abstract method
                onEventAndUnlocked(fileEvent.getValue());
            }
            print("DirWatchProcessingThread Exited");
        }
    }

    /**
     *
     * @author
     * http://stackoverflow.com/questions/13998379/directory-watching-for-changes-in-java
     * Nackloose
     */
    public static class WatchCoreParameters {

        public static int timeToIdle = 2000, millisToPauseForFileLock = 200,
                millisToSwapFileForUnlocking = 2000;
        public static boolean verbose = false;

    }

    //<editor-fold defaultstate="collapsed" desc="Printing methods">
    private void print(String s) {
        //defaultly we're not writing an error
        print(s, false);
    }

    public static final void print(String s, boolean error) {
        //check verbosity, exit if none.
        if (!WatchCoreParameters.verbose) {
            return;
        }
        //if this is an error, assign System.err to a temp varible
        //otherise assign System.out for normal printing
        PrintStream out = (!error ? System.out : System.err);
        if (s.contains("\n")) { // check to see if theirs a new line
            out.print(s); //print accordingly
        } else {
            out.println(s); //print accordingly
        }
    }

    public static final void printe(String s) {
        //shortcut/convenience method for printing an error
        print(s, true);
    }

    public static final void print(String s, Object... formatObj) {
        //check verbosity, exit if none.
        if (!WatchCoreParameters.verbose) {
            return;
        }
        //format the object into the string, and if no newline is there, add it.
        System.out.format(s + (s.contains("\n") ? "" : "\n"), formatObj);
    }
//</editor-fold>
} 
```

# scheme - 使用 DrRacket 运行 SICP 第 3.5.4 节中的代码

> ID：13998388
> 
> 赞同：3
> 
> 时间：2012-12-21T23:14:24.407
> 
> 标签：scheme, sicp, racket

我在运行 SICP（计算机程序的结构和解释）第 3.5.4 节（流和延迟评估）中的示例代码时遇到问题；SICP 部分可以在这里找到：http: [//mitpress.mit.edu/sicp/full-text/book/book-ZH-24.html#%_sec_3.5.4](http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-24.html#%_sec_3.5.4)。

我正在使用 DrRacket 版本 5.2.1，使用 Neil Van Dyke ( **SICP PLaneT 1.17** ) 的 SICP 支持语言设置，可以在此处找到：http: [//www.neilvandyke.org/racket-sicp/#%28part ._安装%29](http://www.neilvandyke.org/racket-sicp/#%28part._installation%29)。

下面显示的代码使用了流。如上所述设置环境后，DrRacket 已经提供了`cons-stream`程序和`force`。`delay`但是不可用`stream-car`；`stream-cdr`所以，我必须定义它们。在下面的代码中，我还定义了一些通用流函数：`stream-map`、`stream-ref`和。`add-streams``scale-stream`

我试图使工作的整个代码如下。`solve`它包括使用积分程序 ( )对一阶微分方程进行数值求解的程序 ( `integral`)，该程序使用延迟参数 ( `delayed-integrand`)；这些程序来自第 3.5.4 节。

```
(define (stream-car stream) (car stream))
(define (stream-cdr stream) (force (cdr stream)))
(define (stream-map proc . argstreams)
  (if (stream-null? (car argstreams))
      the-empty-stream
      (cons-stream
       (apply proc (map stream-car argstreams))
       (apply stream-map
              (cons proc (map stream-cdr argstreams))))))
(define (stream-ref s n)
  (if (= n 0)
      (stream-car s)
      (stream-ref (stream-cdr s) (- n 1))))

(define (add-streams s1 s2)
  (stream-map + s1 s2))

(define (scale-stream stream factor)
  (stream-map (lambda (x) (* x factor)) stream))

(define (integral delayed-integrand initial-value dt)
  (define int
    (cons-stream initial-value
                 (let ((integrand (force delayed-integrand)))
                   (add-streams (scale-stream integrand dt)
                                int))))
  int)

(define (solve f y0 dt)
  (define y (integral (delay dy) y0 dt))
  (define dy (stream-map f y))
  y) 
```

当我将上面的定义放入 DrRacket 并单击运行时，不会出现错误。但是，当我尝试在交互窗口中执行以下行时，会发生错误：

```
(stream-ref (solve (lambda (y) y) 1 0.001) 1000) 
```

错误信息是：

```
mcar: expects argument of type <mutable-pair>; given #<undefined> 
```

出现此错误时，DrRacket 会高亮显示程序定义的主体`stream-car`，如下图所示：

![DrRacket 错误](../Images/37e0a38b94a06971e7d468c601734512.png)

* * *

是什么导致了这个错误？我已经在前面的示例（`stream-car`、`stream-cdr`、`stream-map`和）中使用了上面的流过程`add-streams`并且`scale-stream`它们有效。`integral`当我在程序之外使用它时，该程序也有效`solve`；例如，如果我定义`(define ones (cons-stream 1 ones))`然后我定义`(define s (integral (delay ones) 1 1))`然后我执行`(stream-ref s 1000)`，它会正确地给出输出`1001`。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T00:42:40.300

您报告的错误很奇怪，我看不到在哪里`mcar`使用 - 或可变状态。试试这个设置，它适用于我，无需使用 Neil Van Dyke 的支持语言：

```
#lang racket

(define the-empty-stream '())

(define (stream-null? stream)
  (null? stream))

(define-syntax cons-stream
  (syntax-rules ()
    ((cons-stream head tail)
     (cons head (delay tail)))))

(define (stream-car stream)
  (car stream))

(define (stream-cdr stream)
  (force (cdr stream)))

; ... the rest is the same as in your question 
```

# php - php Preg_replace - 将数据库中的匹配词转换为本地 url

> ID：13998391
> 
> 赞同：-2
> 
> 时间：2012-12-21T23:14:31.813
> 
> 标签：php, regex, preg-replace

假设在下面的代码中，#bob 和 #test 匹配，**那么 preg_replace 表达式将是什么，以便 #bob 和 #to 是 url（即[http://test.com/read.php?id=bob](http://test.com/read.php?id=bob)）** ? 注意 id=bob 部分没有标签。

```
$text = "my name is #bob and I like #to #test things.";

preg_match_all("/(#\w+)/", $text, $matches);

foreach($matches['0'] as $match){

$substring = substr($match, 1);

$titlerows = mysql_num_rows(mysql_query("SELECT title FROM title WHERE title='$substring'"));

if($titlerows == 1) {

    $text = preg_replace('/$match/', replace?? , $text);

}

}

echo $text; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:47:46.817

如果我很好地理解了您的问题，我希望这对您有所帮助。

```
$text = preg_replace('/'.$match.'/', 'http://test.com/read.php?id='.substr($match,1) , $text); 
```

编辑：

```
$text = preg_replace("/$match/", '<a href="http://test.com/read.php?id='.$substring.'">'.$match.'</a>' , $text); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:17:33.460

就像 FeRtoll 的回答一样，但这利用了我们之前已经做过的事实`substr()`：

```
$text = preg_replace("/$match/", "http://test.com/read.php?id=.$substring", $text); 
```

对于评论中更复杂的替换，请执行以下操作：

```
$text = preg_replace("/$match/", "<a href='http://test.com/read.php?id=$substring'>$match</a>", $text); 
```

我喜欢插值而不是串联。

# java - 从 HttpSession 存储/检索常用数据的最佳方法

> ID：13998397
> 
> 赞同：0
> 
> 时间：2012-12-21T23:14:56.870
> 
> 标签：java, google-app-engine, jakarta-ee, servlets

我有一个带有 Java servlet 的标准 GAE 应用程序。我想在整个系统中实现用户角色功能。为此，我想从数据库中检索用户角色并将其存储在会话中，这样所有 servlet 都可以访问这些数据。我阅读了一些关于它的文章，基本的方法是使用过滤器为 HttpSession 填充必要的数据。但是，在这种情况下，我应该以相同的方式从每个 servlet 中的 HttpSession 检索数据，这会导致代码重复。这个问题的明显解决方案是从 HttpServlet 类派生并创建自己的 Servlet，并使用处理 HttpSession 的必要方法（例如受保护的角色 getUserRole()）。这使得过滤器的使用毫无意义。在这种情况下有什么理由使用过滤器吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:30:43.363

您可以拥有一个直接从 HttpServlet 继承的主 servlet，该 servlet 知道如何通过**protected Role getUserRole()**从 HttpSession 获取用户角色。然后，您的应用程序中的所有其他 servlet 都应将该主 servlet 子类化，以使它们具有可用的通用功能。

Servlet 过滤器在调用任何其他 servlet 之前被调用，过滤器的主要目的是在将请求/响应交给 servlet 进行进一步处理之前装饰它们。您可以选择从过滤器中访问您的数据库并相应地填充 HttpSession，然后每个 servlet 稍后将知道如何从 HttpSession 中检索该信息。

我在这里推荐的另一个选项是使用处理请求的第一个 servlet 中的用户角色填充 HttpSession（您可以使用主 servlet 的另一种常用方法来执行此操作，例如 protected void populateUserRole(HttpSession httpSession)）。

干杯;

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:22:14.587

您应该有一个顶级过滤器，它映射到`/*`. 如果会话中不存在此过滤器，它将从数据库中获取角色。现在您扩展`HttpServletRequest`并创建了一个包装器覆盖`isUserInRole()`方法，以便根据需要获取该角色。创建这个对象的一个`request`​​对象并`chain.doFilter`在Filter中使用。

所以所有的 Servlet 都可以调用`request.isUserInRole()`来检查角色

# android - Android - android:onClick 和实现 OnClickListener 的效率有什么区别（主要是指一个 Button）

> ID：13998399
> 
> 赞同：0
> 
> 时间：2012-12-21T23:15:13.090
> 
> 标签：android, xml, performance, button, onclick

我刚刚遇到了`android:onClick="myCrazyMethod"`XML 属性，看起来很干净和简单。

我只是想知道这种方法在性能上是否有任何差异——声明一个简单的方法和创建一个`OnClickListener`类？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:16:29.370

没有明显的区别。选择只是开发人员的偏好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:22:17.917

没有显着差异，因此您应该使用哪个清洁剂。`android:onClick`是使用运行时内省实现的，所以它在技术上更慢，但我们现在正在分裂头发=）

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:23:57.283

在 XML 中声明它会稍微慢一些，但不会慢很多。但是，在 xml 中定义 onClick 可能会导致 proguard 出现问题（除非您实现下面的代码）。就我个人而言，我觉得最简单的方法是在 onclicklistener 中使用 switch 和 case，但如果方法更长，那么最好给它自己的方法，以便“隐藏”它。但是，如果您需要在按下任何按钮后运行通用代码（例如 UI 刷新），最好将其留给 switch 和 case 或 if/else。不过，这一切当然是我对此事的看法。

// 只是为那些想在 xml 和 proguard 中使用 OnClick 的人添加

添加这个：

```
-keepclassmembers class * extends android.app.Activity { 
 public void *(android.view.View); 
} 
```

# html - 没有宽度的中心浮动容器

> ID：13998402
> 
> 赞同：1
> 
> 时间：2012-12-21T23:15:42.030
> 
> 标签：html, css, width, center

我有这个 HTML：

```
<div id="container">
    <article></article>
    <article></article>
    <article></article>
    <article></article>
    <article></article>
</div> 
```

这个CSS：

```
#container {
    overflow: hidden
}

article {
    float:left;
    height: 200px;
    width: 200px;
    background-color: red;
    margin: 5px;
} 
```

​​我想在不指定宽度的情况下将#container居中。是否可以？
这是[小提琴](http://jsfiddle.net/eSCQ5/6/)。

编辑：我需要更改#container 的宽度以适应文章。如果 body 是 450px 宽度，那么每行会有两篇文章，所以容器的宽度应该是 400px aprox。如果 body 是 1100px 宽度，那么每行将有 5 篇文章，所以容器的宽度应该是 1000px aprox。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:29:03.603

你可以尝试这样的事情（[jsfiddle](http://jsfiddle.net/eSCQ5/29/)）：

HTML：

```
<html>
    <body>
        <div id="container">
            <article></article>
            <article></article>
            <article></article>
            <article></article>
            <article></article>
        </div>
    </body>
</html>​ 
```

CSS：

```
html, body { margin: 0; padding: 0; }
body { text-align: center; }

#container {
    overflow: hidden;
    margin: 0 auto;
    width: 90%;
    text-align: left;
}

article {
    display:inline-block;
    height: 200px;
    width: 200px;
    background-color: red;
    margin: 5px;
}
​ 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T01:25:55.457

### 2015 年更新

我注意到以前的设置有一个小问题。将文章保留在第一个占位符内会使边距增加一倍。这导致在跨每个文章换行点调整页面大小时出现轻微的不一致。

这个更新的小提琴摆脱了这些问题：

[http://jsfiddle.net/C4fbX/4/](http://jsfiddle.net/C4fbX/4/)

然而，现在这种布局很可能通过 Flexbox 以更好的方式实现。

[https://css-tricks.com/snippets/css/a-guide-to-flexbox/](https://css-tricks.com/snippets/css/a-guide-to-flexbox/)

## 回答 2012

以下方法有效，但有点疯狂。很烦人的是，这不是 CSS 可以轻松处理的：

### 小提琴

[http://jsfiddle.net/C4fbX/](http://jsfiddle.net/C4fbX/)

### 方法

此方法适用于 Nick 发布的基本思想，并使用此方法定位左浮动系统......这解决了您总是在居中容器中居中对齐元素的问题。

所以而不是：

```
[][][][]
  [][] 
```

你得到：

```
[][][][]
[][] 
```

需要以下规定：

1.  您需要包含与文章一样多的占位符元素。该方法使用这些来计算从哪里缩进文章。这也意味着占位符元素的宽度和水平边距/填充必须与文章的匹配。
2.  文章需要放在第一个占位符内。
3.  为了解决与 相关的空白问题`inline-block`，`font-size`和`line-height`被清零，这意味着必须为文章再次手动设置它们。您可以通过从 css 中删除这些归零属性并确保您的占位符标记没有任何空格来解决此问题。
4.  我非常怀疑这是否适用于旧版浏览器 - 但似乎适用于当前的现代浏览器。
5.  依赖绝对位置意味着您的文章不会占用文档中通常的空间，因此您必须在设计中考虑到这一点或在`#container`元素上设置固定高度

**标记**

```
<div class="container">
  <div class="placeholder">
    <div class="position">
      <article>a</article>
      <article>b</article>
      <article>c</article>    
      <article>d</article>
      <article>e</article>
    </div>
  </div>
  <div class="placeholder"></div>
  <div class="placeholder"></div>
  <div class="placeholder"></div>
  <div class="placeholder"></div>
</div> 
```

**css**

```
.container {
  font-size: 0;
  line-height: 0;
  text-align: center;
}

.placeholder {
  display: inline-block;
  width: 200px;
  margin-left: 5px;
  margin-right: 5px;
  height: 0px;
}

.position {
  position: absolute;
}

article {
 font-size: 12pt;
 line-height: 1.2em;
 float: left;
 margin: 5px;
 width: 200px;
 height: 100px;
 background: red;    
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T00:39:33.073

您是指将物品放在容器中的中心，同时让它们仍然可以包装吗？在这种情况下（[jsfiddle](http://jsfiddle.net/eSCQ5/30/)）：

```
#container {
    text-align: center;
}

article {
    display:inline-block;
    height: 200px;
    width: 200px;
    background-color: red;
    margin: 5px;
}
​ 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-31T02:52:17.683

在考虑了几个选项后，我发现使用媒体查询是更简单的方法。

在这种情况下，它将是这样的：

```
@media (max-width: 420px) {
    #container {
        width: 210px;
    }
}

@media (min-width: 420px) and (max-width: 630px) {
    #container {
        width: 420px;
    }
}

@media (min-width: 630px){
    #container {
        width: 630px;
    }
} 
```

这是[小提琴](http://jsfiddle.net/eSCQ5/35/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T23:22:06.143

取出`float: left;`并添加`margin:auto;`

# javascript - 在 javascript 中替代使用 eval

> ID：13998403
> 
> 赞同：0
> 
> 时间：2012-12-21T23:15:43.963
> 
> 标签：javascript, function, onclick, eval

我听说在 JavaScript 中使用 eval 函数是个坏主意，但我有这段代码：

```
// this string (function)  is generated dynamically...
var funVal = 'alert("a")' ;        
//.....

var Button1 = document.getElementById("BtnSave");
// onclick event of button
eval("Button1.onclick = function () { " + funVal + " };"); 
```

我不想使用`eval`. 还有其他解决方案吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T23:17:21.060

只需在没有 的情况下编写非常接近的代码`eval`，就没有什么需要它了：

```
var funVal = function() {
    alert("a");
};

var Button1 = document.getElementById("BtnSave");
Button1.onclick = funVal; 
```

* * *

在您所说的评论中，代码是在服务器端动态生成的。这根本不是问题，只需让服务器输出预期 JavaScript 代码的代码（在`<script>...</script>`标签内，或作为您将通过 加载的响应的完整内容`<script src="..."></script>`）。无论哪种情况，关键是确保您发送*给浏览器*的内容是有效代码。

**示例 1**：动态生成的内联`script`标签（您还没有说服务器端技术是什么，所以我选择了相当常见的 PHP）：

```
<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Inline Dynamically Generated Script</title>
</head>
<body>
<p>Each time you load this page, the script in the inline
<code>script</code> tag at the end is different.</p>
<button id="theButton">Click Me</button>
<script>
document.getElementById("theButton").onclick = function() {
    alert("<?php echo("Hi there, this page's magic number is " . rand(0, 10000)); ?>");
};
</script>
</body>
</html> 
```

[现场示例](http://www.crowdersoftware.com/so/dynamic-inline.php)

**示例 2**：在单独文件中动态生成的脚本：

HTML：

```
<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Dynamically Generated Script from File</title>
</head>
<body>
<p>Each time you load this page, the script in the file
loaded by the <code>script</code> tag at the end
is different.</p>
<button id="theButton">Click Me</button>
<script src="dynamic-script.php"></script>
</body>
</html> 
```

JavaScript 文件 ( `dynamic-script.php`):

```
<?php header('Content-type: application/javascript'); ?>
document.getElementById("theButton").onclick = function() {
    alert("<?php echo("Hi there, this page's magic number is " . rand(0, 10000)); ?>");
}; 
```

[现场示例](http://www.crowdersoftware.com/so/dynamic-from-file.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:16:59.467

我不知道你为什么要这样做，但更好的方法是使用`Function`构造函数：

```
new Function("Button1.onclick = function () { " + funVal + " };")(); 
```

但你不必使用这个或`eval`解决方案。这样做在输出中是完全等价的：

```
Button1.onclick = function() { alert('a'); }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:19:48.800

Javascript 允许您将函数视为变量。您可以将它们分配给其他变量，可以将它们作为参数传递给其他函数，甚至可以拥有返回其他函数的函数。这可以在大多数使用~~evil()~~ eval() 的情况下使用。

# android - 软键盘实现可以确定它的调用者吗？

> ID：13998404
> 
> 赞同：0
> 
> 时间：2012-12-21T23:15:49.213
> 
> 标签：android, android-softkeyboard, android-input-method

我正在考虑创建一个修改后的软键盘。

我的问题：是否可以确定软键盘是如何被调用的？软键盘实现是否可以确定它来自 FooBarBaz 应用程序中的输入字段，或者来自指向[http://www.foobarbaz.com/whatever.html](http://www.foobarbaz.com/whatever.html)的浏览器中的输入字段？

或者软键盘是完全不可知的，因为它只知道需要输入，并且会在不知道谁是调用者的情况下将该输入发送回调用者？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:39:23.973

如果它知道，那将是一个巨大的安全风险。您可以在[developer.android.com](http://developer.android.com/)阅读有关 Android[输入法](http://developer.android.com/guide/topics/text/creating-input-method.html)的更多信息。

# java - 是否可以让休眠查询跳过多记录查询中的不良记录？

> ID：13998410
> 
> 赞同：2
> 
> 时间：2012-12-21T23:16:12.713
> 
> 标签：java, hibernate

我有一个在其设置器中进行验证的对象。例如：

```
class Employee {
   private String name;
   public void setName(String theName) {
     if (theName.contains("*")) {
       throw new IllegalArgumentException("You can't have an asterisk in a name!");
     }
     name = theName
   }
} 
```

当 Hibernate 查询尝试使用无效数据（例如`Employee`名称为“John Smith*”）实例化对象时，`IllegalArgumentException`会导致整个查询失败。对于这个特定的应用程序——加载缓存——理想的行为是 Hibernate 捕获异常，拒绝记录，并返回在初始化期间没有抛出任何异常的对象列表。

我知道许多替代解决方案：

*   [通过直接字段访问](http://www.velocityreviews.com/forums/t272767-direct-field-access-in-hibernate.html)设置 Hibernate ，绕过设置器
*   与其在 setter 中抛出异常，不如将对象标记为无效，然后将它们从返回的 List 中过滤出来`org.hibernate.Query.list()`，或者保存验证以备后`list()`返回。
*   保证数据库数据的清洁（如果这在我的能力范围内！）

我的偏好是允许对象继续从 setter 中抛出异常，并避免对 Hibernate 结果进行后处理，并避免为 Hibernate 实例化的对象引入新的验证生命周期步骤。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:23:35.920

不，在 Hibernate 中没有忽略这样的无声错误。在 SQL/HQL 级别过滤此类记录怎么样？就像是：

```
...
WHERE name NOT LIKE "%*%" 
```

我知道 Hibernate 可以自动将此类过滤器应用于每个查询。另一种方法是有一个（物化的）视图。

当然，这种方法引入了一些重复（通常`Employee`类中的规则必须与 SQL 中的规则完全匹配），但它似乎仍然是最干净的方法。

# iphone - 将 int 类型的变量传递给 parentViewController [iOS]

> ID：13998412
> 
> 赞同：0
> 
> 时间：2012-12-21T23:16:31.200
> 
> 标签：iphone, objective-c, ios, xcode, uiviewcontroller

我正在构建一个使用 Jeremy Fox`JFDepthView`库的 iPad 应用程序。对于那些不熟悉的人来说，它基本上允许一个新的视图控制器放在前面和中心，将父视图发送到背景并对其应用模糊算法以将用户焦点带到呈现的顶视图上。这一切都很完美，但我在设置 int 的值并将其`parentViewController`从呈现的 topView 传递回时遇到问题。

我有`TTViewController`哪个是原始视图控制器。在这个视图上点击一个按钮并启动并在被调用`JFDepthView`的顶部呈现一个新视图。当点击按钮时，我希望关闭该视图并在父级上发生特定操作，具体取决于我在按下按钮时设置的回传。`TTViewController``IndustryViewController``IndustryViewController``TTViewController``int`

我在原始（父）viewController 中为我的 int 创建了一个属性。

```
@interface TTViewController : UIViewController <JFDepthViewDelegate> {

}

@property (nonatomic, assign) int          defence;

@end 
```

在我的子视图控制器（JFDepthView 在顶部显示的那个）中，我试图访问父视图并设置变量的值，然后关闭视图。

```
@implementation IndustryViewController

- (IBAction)defenceBtnPressed:(id)sender
{
    TTViewController *viewController = (TTViewController *)self.parentViewController;
    viewController.defence = 1;
    [self.depthViewReference dismissPresentedViewInView:self.presentedInView animated:YES];
} 
```

我没有收到任何错误或警告，一切正常。但是 int 'defence' 的值始终为 0。我显然做错了什么，对 parentViewController 设置缺乏了解。任何人都可以填写空白或指出正确的方向吗？

编辑：似乎如果我注销`parentViewController`并且`presentingViewController`它们都是`NULL`. 在设置防御变量后，我也立即注销了它，它实际上从未设置为“1”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:19:00.807

检查是否`self.parentViewController`是`nil`. 我猜想 JFDepthView 不会`parentViewController`为您自动设置。

如果`self.depthViewReference`是父视图控制器（即您调用`presentViewController:xxx inView:self.view`以呈现当前 VC 的那个），则将其简化转换为所需的类`TTViewController`并`defence = 1`在其上进行设置。

# android - Android多线程应用——共享状态

> ID：13998415
> 
> 赞同：2
> 
> 时间：2012-12-21T23:16:44.893
> 
> 标签：android, multithreading, gps

我正在开发具有多个线程的 Android 应用程序 - 其中一个线程每秒从 GPS 接收器获取数据 1 次。我希望其他线程能够访问来自 GPS 线程的信息。

我已经尝试过使用消息队列来做这件事，但它使代码变得非常混乱——我创建的所有新线程都必须以自己的方式处理消息，所以我必须在每个线程类中做很多新的实现。

我希望能够以这种方式简单地获取数据：

```
ApplicationState.getLocation(); 
```

所以我可以使用最新的数据。我怎样才能实现它？我不想创建具有同步字段的静态类，因为我不想锁定线程太久，因为我正在其他线程中进行一些在线图像分析。

这里最好的方法是什么？

干杯，内布里尔

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:30:26.683

您是否考虑过使用事件总线系统？[来自 Square 的 Apache 许可库 Otto](http://corner.squareup.com/2012/07/otto.html)非常简洁。

您可以创建一个触发 new 的位置更新类`LocationUpdateEvents`。任何有兴趣接收此更新的对象都可以有一个用 注释的方法`@Subscribe`。这是进程间通信的好方法，它不依赖于混乱的侦听器接口。

Otto 的另一个优点是您的 LocationUpdater 类可以有一个用@Produce 注释的方法。这样，任何正在`begins`侦听的对象`LocationUpdateEvents`都将立即收到一个带有您找到的最后一个位置的对象`LocationUpdater`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:31:00.243

1）创建您的应用程序类“MyApp”：

1.1）在清单文件中：

```
<application
    android:name=".MyApp"
    ....
/> 
```

1.2）创建类：

```
public class MyApp extends Application {
    public void onCreate() {
          super.onCreate();
    }

    private volatile Location mLastLocation = null;
    public Location getLastLocation(){
        return mLastLocation;
    }
    public void setLastLocation(Location mLastLocation){
        this.mLastLocation = mLastLocation;
    }
} 
```

2）在同一进程中从应用程序（服务、任何活动）中的任何上下文设置位置（小心有一个进程。您可以在 android 中拥有 1 个进程和多线程）：

```
((MyApp)context.getApplicationContext()).setLastLocation(location); 
```

3）在同一过程中从应用程序中的任何上下文获取最新位置：

```
((MyApp)context.getApplicationContext()).getLastLocation(); 
```

注意：您也可以使用侦听器来获得更好的性能。在 MyApp 监听器的列表中注册并从 onLocationChanged 触发监听器

# ruby-on-rails - url_for 不适用于自定义路由

> ID：13998420
> 
> 赞同：0
> 
> 时间：2012-12-21T23:17:14.333
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有一个自定义路线，如下所示：

```
match 'firsttime' => 'registrations#new', :via => :get, \
    :defaults => {:promotion_path => :firsttime} 
```

上述路线的目标是能够有一个像[http://www.mysite.com/firsttime](http://www.mysite.com/firsttime)这样的 url ，它映射到注册控制器的“新”方法，该注册的推广是“第一次”晋升。

在我的一个模型中，我有一个快捷方法来尝试生成这个 url：

```
class Registration < ActiveRecord::Base
  include ActionView::Helpers
  include ActionDispatch::Routing
  include Rails.application.routes.url_helpers

  belongs_to :promotion

  def get_share_link()
    promotion_path = promotion.url_path

    url_to_share = url_for :controller => 'registrations', :action => 'new', :promotion_path => promotion_path
  end
end 
```

调用方法 get_share_links() 失败并出现错误：

> 没有路线匹配 {:controller=>"registrations", :action=>"new", :promotion_path=>"firsttime"}

我做错了什么，或者我是否为此使用了正确的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:21:49.430

路由在控制器中使用。将其作为之前的过滤器粘贴在您的控制器中。

# 编辑#1

这是用于身份验证的设计还是其他宝石？

# 编辑#2

当然，您现在可以`http://www.mysite.com/registrations/new?promotion=firsttime`假设它是 localhost，因为您处于开发模式。

# 问题 #1

“在我的一个模型中，我有一个快捷方法可以尝试生成这个 url：”你是什么意思？邮件？您的路线似乎有效，只是没有在您想要的时候制作，并且不清楚您希望在哪里使用它。

# 回答

它可以 `only_path: false`作为选项提供吗？

# sql - 用于更新记录的 SQL 脚本，从字段中删除重复的内容

> ID：13998424
> 
> 赞同：0
> 
> 时间：2012-12-21T23:17:27.477
> 
> 标签：sql, apostrophe

我遇到了一个错误的 SQL 存储过程引起的情况，现在我面临着一项可能令人生畏的数据清理任务。

总而言之，我们的数据库中有可能包含任意数量的重复撇号的数据。因此，数据可能如下所示：

```
“这是一条评论”
“这条评论没问题，但不受影响”
“此评论的文字有双撇号”
“这条评论''''''''''''''''''''''''''''''s text has many double apostrophes”

```

因此，我们可以轻松地查找行 WHERE Comment LIKE '%''''%' 来查找错误数据，但是有没有办法创建一个 UPDATE 脚本可以一举解决这些问题？

我充满希望，但并不期待。我希望手动完成不会是一项痛苦的任务，但是嘿'我内心很懒 :-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:41:04.877

假设您的文本中有一个未表示的字符，例如 Char(0)，这里是伪代码：

```
UPDATE Yourtable
SET Col = Replace(Replace(Replace("'", Char(0) + "'"), "'" + Char(0), ""), Char(0), "")
WHERE Col LIKE "%''%" 
```

这会将任意数量的单引号重复变成一个。我不知道您的 DBMS，或者我可以尝试给出确切的语法。

我知道我上面的双引号对于大多数 DBMS 来说必须是单引号。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:27:30.997

欢迎来到堆栈溢出。

如果这些数据始终是固定长度，我会通过查询找到集合并用单个“替换”函数替换坏数据。如果还有更多内容，您可以使用 charindex 来查找要查找和替换的模式。通常，对于大规模替换，当我想进行自我更新时，我会测试逻辑。

这是一个带有表变量的简单示例：

```
declare @Table table ( data varchar(32) );

insert into @Table values ('stut""""""'),('stu""""""');

select 
    *
,   replace(data, '""""""', '')
from @Table

update @Table 
set data = replace(data, '""""""', '')

select *
from @Table 
```

# mysql - ERROR 1045 (28000): Access denied for user for EVERY mysql command

> ID：13998425
> 
> 赞同：2
> 
> 时间：2012-12-21T23:17:39.607
> 
> 标签：mysql, linux

无论我在我的 bluehost 连接服务器上的 shell 中输入什么 mysql 命令，我都会遇到以下错误。

```
ERROR 1045 (28000): Access denied for user 'myuser'@'localhost' (using password: YES) 
```

我试过的最简单的命令可以解决这个错误是

```
mysql -u myuser -pMypass
ERROR 1045 (28000): Access denied for user 'myuser'@'localhost' (using password: YES) 
```

我 100% 确定用户和密码是正确的，因为我尝试了几个不同的用户。我尝试向每个用户授予所有权限。我尝试以我的 root 用户身份执行。我也尝试过使用 -e 进行简单查询。

有谁知道是否有一个全局设置阻止我使用最简单的命令？

我可以使用 PuTTy 访问并且可以正确查看/编辑我的文件。

**编辑:::: SOLUTION:::: 我的密码包含一个需要转义的'$'....**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:40:29.127

当你跑

```
mysql -u myuser -p 
```

并得到了这个错误

```
ERROR 1045 (28000): Access denied for user 'myuser'@'localhost' (using password: YES) 
```

mysqld 期待您以`myuser@localhost`

尝试创建`myuser@localhost`

```
CREATE USER myuser@localhost IDENTIFIED BY 'passpass';
grant all privileges on *.* to myuser@localhost with grant option; 
```

如果要远程连接，则必须使用 TCP/IP 指定 DNS 名称、公共 IP 或 127.0.0.1：

```
mysql -u myuser -p -hmydb@mydomain.com
mysql -u myuser -p -h10.1.2.30
mysql -u myuser -p -h127.0.0.1 --protocol=TCP 
```

登录后，请运行此

```
SELECT USER(),CURRENT_USER(); 
```

[USER()](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_user)报告您如何尝试在 MySQL 中进行身份验证

[CURRENT_USER()](http://dev.mysql.com/doc/refman/5.5/en/information-functions.html#function_current-user)报告您是如何被允许从**mysql.user**表在 MySQL 中进行身份验证的

这将使您更好地了解允许您登录 mysql 的方式和原因。为什么知道这个观点很重要？它与用户身份验证排序协议有关。

# javascript - CoffeeScript：需要帮助将函数调用作为第一个参数转换为 CoffeeScript

> ID：13998426
> 
> 赞同：0
> 
> 时间：2012-12-21T23:17:54.287
> 
> 标签：javascript, coffeescript

我正在尝试将以下 JavaScript 转换为 CoffeeScript：

```
$(window).afterResize( function() {

        var adjusted_window_height = $(window).height() - $('header').height() - $('footer').height();
        var vid_width = $('#section').width();
        var vid_height = adjusted_window_height - 20;
        var vid_margin = (adjusted_window_height - vid_height)/2;

        $('iframe.vimeo_player').css({
            width: vid_width,
            height: vid_height
        });

        if(vid_margin > 0){
            $('iframe.vimeo_player').css('margin-top',vid_margin+'px');
        }

        //Adjusts for scroll-bar follies 
        if($('iframe.vimeo_player').width() < $('#section').width()){
            $('iframe.vimeo_player').css({
                width: $('#section').width(),
                height: $(window).height() - $('header').height() - $('footer').height() - 20
            });
        }

}, true, 200 ); 
```

而我将函数作为函数调用的第一个参数传递的事实正在搞砸一切。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:26:48.967

将函数替换`->`为咖啡脚本需要。您还需要删除 var statents

```
$(window).afterResize ->  
   foo()
, true 
```

# android - 无法在 Android 上使用 Dropbox 进行身份验证

> ID：13998429
> 
> 赞同：0
> 
> 时间：2012-12-21T23:18:08.140
> 
> 标签：android, dropbox, dropbox-api

我正在尝试使用 OAuth 的通用类对 Dropbox 上的用户进行身份验证。似乎 Dropbox 并没有像 API 所说的那样返回令牌秘密。

```
private CommonsHttpOAuthProvider mOAuthProvider;
private CommonsHttpOAuthConsumer mOAuthConsumer;

mOAuthConsumer = new CommonsHttpOAuthConsumer(mConsumerKey, mConsumerSecret);
//mConsumerKey and Secret are provided by Dropbox

mOAuthProvider = new CommonsHttpOAuthProvider(
mRequestTokenEndpointUrl, mAccessTokenEndpointUrl, mAuthorizationWebsiteUrl);

String url = null;
try {
    url = mOAuthProvider.retrieveRequestToken(mOAuthConsumer, mCallback);
}catch(Exception e){} 
```

API 说 url 现在应该包含 token/token_secret 对。但是，网址如下所示：

```
https://www.dropbox.com/1/oauth/authorize?oauth_token=xxxxxx&oauth_callback=xxxxx 
```

难道我做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T19:04:24.067

看起来您正在使用 oauth-signpost 库。您获得的 URL 不是检索令牌和秘密。相反，您必须使用该 URL 来启动浏览器窗口以让用户验证自己。要检索 DropBox 返回的令牌和机密，您必须执行以下操作：

```
String url = null;
try {
    url = mOAuthProvider.retrieveRequestToken(mOAuthConsumer, mCallback);

    //Retrieve token and secret here
    String token = mOAuthConsumer.getToken();
    String secret = mOAuthConsumer.getTokenSecret();
}
catch(Exception e){} 
```

然后，您可以使用从调用 retrieveRequestToken() 中获得的 URL 启动浏览器窗口，例如：

```
startActivity(new Intent(Intent.ACTION_VIEW, Uri.parse(url))); 
```

一个提示，请确保在启动浏览器窗口之前保存您的请求令牌和密码（我建议将它们保存在*SharedPreferences*中），因为一旦您退出活动，您的***mOAuthConsumer***实例将丢失。然后，您必须重新创建***mOAuthConsumer***并设置您检索到的请求令牌和密码，然后才能检索 ACCESS 令牌和密码。

祝你好运！

# java - 向图形进程发送输入？

> ID：13998433
> 
> 赞同：0
> 
> 时间：2012-12-21T23:18:30.903
> 
> 标签：java, io

我正在尝试制作一个小型 Java 应用程序，它接受我的输入，打开另一个应用程序（*Windows Calculator / "calc"*）并用我的输入提供该应用程序。

目前，我正在尝试对简单的 Windows Calculator 执行此操作，但它似乎不适用于传统方法：

```
public Feeder(String processID) throws Exception {
    rt = Runtime.getRuntime();
    proc = rt.exec("calc");

    input = new BufferedWriter(new OutputStreamWriter(proc.getOutputStream()));
}

public void sendCommand(int cmd) throws Exception {
    input.write(cmd);
    input.flush();
    input.close();

    proc.waitFor();
} 
```

（[部分取自其他来源，归功于作者](https://stackoverflow.com/questions/2877609/in-java-send-commands-to-another-command-line-program)）

然而，与上面发送到另一个命令行进程的代码相反，WinCalc 是图形化的。是否仍然可以向它发送输入而不必经历逆向工程等各种麻烦？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:21:11.433

您可以使用 java.awt.Robot 将文本发送到当前活动窗口，并为您移动和单击鼠标。如果您需要更高级的消息传递，那么您将需要 JNI 或（我的推荐）JNA。

其他选项包括将您的应用程序绑定到 AutoHotKey 或 AutoIt V3。

就我自己而言，我已经成功地运行了结合了 JNA、Robot 和 AutoIt 的其他应用程序，并使用了最适合这种情况的应用程序。

# python - Twitter API 1.1 的最佳 Python-Wrapper 是什么？

> ID：13998434
> 
> 赞同：7
> 
> 时间：2012-12-21T23:18:35.677
> 
> 标签：python, twitter, wrapper, python-twitter

我最近阅读了《挖掘 Twitter 的 21 个秘诀》一书，他们在那里使用了来自 Sixohsix 的[python-twitter](https://github.com/sixohsix/twitter) - Wrapper。

在我看来，这个库有点过时了，因为它仍然有搜索 API 和 REST API 之间的区别。它似乎是为 API 版本 1 制作的，但版本 1.1[需要身份验证才能搜索 Twitter](https://github.com/sixohsix/twitter)。

在 Sixohsix 的方法中，您通过以下方式建立 Twitter 搜索：

```
twitter_search = twitter.Twitter(domain="search.twitter.com")
...
twitter_search.search(q="myquery") 
```

同时，与“常规”REST API 的连接需要这样的东西：

```
twitter.Twitter(domain='search.twitter.com', api_version='1.1',\
                     auth=twitter.oauth.OAuth(access_token, access_token_secret,\
                    consumer_key, consumer_secret)) 
```

但我想在 1.1 中，搜索也需要 OAuth！要么 Twitter 文档很混乱，要么 Sixohsix 的库真的有点过时了。

最后一个问题：我应该使用哪个 Python 库来轻松且最重要的是：始终如一地建立对 API 1.1 的搜索和其他 REST 调用？我看到了[熊的图书馆](https://github.com/bear/python-twitter)，这似乎更一致。

但也许我完全走错了路。我想听听一些经验丰富的 Python 人的建议，他们经常与 Twitter 的 1.1 API 交互。谢谢。

**编辑** 参见[Sixohsix 的 Github 上的#issue 109](https://github.com/sixohsix/twitter/issues/109) - 该问题已得到修复，并且 Search API v1.1 现在已包含在包装器中

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:21:19.403

我以前使用过 Sixohsix 库。我还使用了 tweepy 和 python-twitter（我在 github 上找到了它）。这真的是一个偏好问题。我创建了几个 virtualenv 项目，其中一些有 Django 或 CherryPy，并且只是尝试了不同的 API，直到找到我喜欢的那个。Tweepy 似乎有很好的文档记录，但 Sixohsix 似乎更新得更频繁。

# android - 将 Appcloud 与 Jquery Mobile 一起使用

> ID：13998442
> 
> 赞同：3
> 
> 时间：2012-12-21T23:20:10.883
> 
> 标签：android, jquery, html, mobile, appcloud

我正在使用 Appcloud 制作一个 android 应用程序。我的问题是，我设置了“页面”，所以它只是一个图片链接 (HTML)，它会将您发送到一个新页面（HTML 文件）我知道有更好的方法来做到这一点。我问过某人，他们说使用 Jquery Mobile 在页面之间进行转换。1\. 如何使用 AppCloud 设置 Jquery Mobile。2\. 使用 Jquery Mobile 进行页面和转换的最佳方式是什么。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T14:57:50.413

在这篇回复中，我假设您对 App Cloud 有所了解，对 jQuery Mobile 以及 JavaScript/jQuery 有所了解。答案会有点长，但如果不假设其中一些知识，它会更长。

问题 1：如何使用 App Cloud 设置 jQuery Mobile。

这很简单。您需要包含这两种技术的 CSS 和脚本。我已经将它用于标题并成功了。

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="bc-manifest" content="manifest.json" />
<title>App Cloud</title>
<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
<script type="text/javascript" src="javascripts/lib/brightcove-app-cloud-1.12.min.js"></script>
<script type="text/javascript" src="javascripts/views/appcloud.js"></script>
<script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>
</head>
<body>
… 
```

问题 2：使用 Jquery Mobile 进行页面和转换的最佳方式是什么。

我将以两种方式回答这个问题。如果您不使用 jQuery Mobile (jQM)，则为第一种方式，如果您使用的是第二种方式。由于您正在寻找一种进行转换的方法，因此您不必使用 jQM，因为 App Cloud 中内置了页面转换。

在标准 App Cloud 中，您希望将每个 HTML 页面创建为 App Cloud 视图。粗略地说，视图是应用程序的可导航部分，对应于 HTML 页面。视图可以包含多个逻辑页面。例如，一个视图可以包含一个页面，该页面显示一个项目列表以供点击选择，然后另一个页面显示点击项目的详细信息。在页面之间转换时，App Cloud API forwardPage() 方法内置了转换，默认为 SLIDE_LEFT。此场景中的页面使用 App Cloud 的 CSS 来使用 class 属性定义页面，如下所示：

```
<section id="pageone" class="page">` 
```

如果您将 App Cloud 与 jQM 一起使用，那么您很可能正在使用 jQM 的导航工具。我仍然会在 jQM 中使用 App Cloud 视图，但 jQM 中的逻辑页面是使用 jQuery 的 CSS 定义的，而不是 App Cloud 的。与 App Cloud 一样，jQM 将多个逻辑页面放在一个 HTML 文件中，使用 jQuery 的标准工具（包括 jQM 的转换）导航到这些逻辑页面不是问题。

问题正在更改为 App Cloud 视图。通常在 jQM 中，您会使用 an 转到页面，但在 App Cloud 下，这将导致打开一个模式窗口并且您会离开您的应用程序，这很可能是您不想要的。相反，在仍然使用锚标记的同时，删除 href，如下所示：

```
<a rel="external" data-role="button" class="mainNavTargetBC"> 
```

我添加了 mainNavTargetBC 类，然后在 JavaScript 中你可以监听链接上的点击事件，如下所示：

```
$("body").on( "tap", ".mainNavTargetBC", topNavClickedBC); 
```

然后，在事件处理程序中，您可以使用 navigateToView() 方法转换到新的 App Cloud 视图，如下所示：

```
bc.device.navigateToView("brightcove.html"); 
```

就这样。使用标准 App Cloud 和 jQM 的页面转换。回顾一下，App Cloud 中内置了页面转换，但如果使用 jQM，请使用它们的转换。

# noise - 这种“噪音产生”的术语是什么？

> ID：13998443
> 
> 赞同：0
> 
> 时间：2012-12-21T23:20:28.297
> 
> 标签：noise, terrain

我在查找这方面的信息时遇到了很多麻烦，但由于它不能成为编程中未探索的领域，我假设我的麻烦源于缺少一些关键术语。

基本上，我想要一种 2d 噪声生成。

我一直在使用 2 个单纯形噪声层，以不同的方式缩放并添加在一起以创建平滑的地形“高度图”。但是我现在要做的是用来指定“区域”。

我的高度图方法的问题是，从上面看，它在“环”中发生变化，例如，较高的值是“内部”较低的值。看到这张图片： [http ://s8.postimage.org/pvvtnn0px/figure1.png](http://s8.postimage.org/pvvtnn0px/figure1.png)

左侧是我当前的功能 - 我非常了解它。我想要做的是得到类似于右侧的东西 - 值是随机分布的，而不是堆叠成环。

输入：x坐标，z坐标

所需输出：整数“区域 id”值

我之前尝试过问这个问题并且已经关闭了这个问题，我试图让它更具体，但由于我显然缺乏一些术语，这非常困难。我希望有人会看到这可以以任何方式启发我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:29:10.723

不确定它对地形的适用性如何，但通常如果您想要在程序纹理中使用这种结构，您会查看某种细胞噪声函数。通常通过采用随机位移网格的 voronoi 集，或类似的。

![有点像这个。。。](../Images/d407e5b87470e742569381f921937b73.png)

# c# - 如何制作网页并将其放入 Windows 商店 C# 应用程序

> ID：13998444
> 
> 赞同：1
> 
> 时间：2012-12-21T23:20:34.600
> 
> 标签：c#, windows-8, microsoft-metro, windows-store

基本上我想在我的 Windows Store C# 应用程序`html/js`中的浏览器中显示一些内容。`WebView`我一直在尝试这样做，但没有成功 - 我可以让本地网页显示在 a 中`WebView`- 但就是这样。

您如何执行以下操作：

1.  文件中的引用`JS`和文件加载到- 可以在文件中使用相对 url 到和那些（例如）还是必须使用（例如）？`CSS``html``WebView``html``JS``CSS``scripts/eg.js``ms-appx-web:///``ms-appx-web:///ScriptrHTML/scripts/eg.js`

2.  `html`将,`JS`和`CSS`资源包含到您的项目中并保证它们将与最终应用程序一起导出的最佳方式是什么？

我找不到这方面的教程，如果可以的话，我很想看看！

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:47:36.840

1.  是的，相对参考将起作用
2.  确保将各种文件的构建操作设置为内容（就像徽标一样）

# javascript - 使用 JavaScript/JQuery 仅在滚动事件上显示文本

> ID：13998445
> 
> 赞同：0
> 
> 时间：2012-12-21T23:20:35.833
> 
> 标签：javascript, jquery, javascript-events

我正在尝试创建一个包含隐藏文本的页面，该隐藏文本仅在有人滚动时才会显示。

当有人滚动经过 a`div`时，该文本应该消失，而新文本会显示出来。

我只能找到垂直或水平滚动等的解决方案。

我使用 jsFiddle 创建了一个[**更简单的版本**](http://jsfiddle.net/sandeepj/x8tzg/21/)，但无论我在 JS 部分添加什么代码，似乎都没有任何效果。

**这是CSS：**

```
body {
    background-color: #f8f8f8;
    margin: 5px;
    font-family: arial, sans-serif;
}

div#mainText {
    width: 960px;
    margin: o auto;
    padding: 10px;
    background-color: #f8f8f8;
    font-size: 1em;
}

h1 {
    text-transform:uppercase;
    color: gray;
}

h2 {
    font-family:"Times New Roman", Times, serif;
    font-size:2.5em;
}

.partOne
{
    color: gray;
    display:none;
}

.partTwo
{
    color: gray;
    display:none;
}

.partThree
{
    color: gray;
    display:none;
}

.kicker
{
    color: gray;
    display:none;
} 
```

**这是HTML：**

```
<h1 id="preHead">Catchy Title</h1>
<h2 id="headline">Headline goes here</h2>
<P></p>
<p id="introBlurb">A very compelling blurb here. Praesent volutpat rhoncus purus,         ullamcorper dapibus ante pulvinar non. Maecenas fringilla justo nec justo blandit non rhoncus nunc elementum.</p>

<div class="partOne">
    <p>Part one here. This appears on first scroll event.</p>
</div>

<div class="partTwo">
    <p>Part two here. This appears on second scroll event.</p>
</div>   

<div class="kicker">
    <p>Kicker here. This appears on 3rd scroll event.</p>
</div>​ 
```

**JavaScript/Jquery：**

```
$(window).scroll(function () { 
    $("kicker").css("display"); 
}); 
```

到目前为止没有任何工作。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-21T23:36:36.350

您的示例不够长，无法滚动，因此我在第一个元素中添加了一些额外的文本。主要问题是您的 jQuery。你打电话没用`$('kicker').css('display')`。

选择器`'kicker'`需要更改为，`'.kicker'`因为它是一个类，而我更改`.css('display')`为`.show()`正常工作的。

工作示例：http: [//jsfiddle.net/x8tzg/24/](http://jsfiddle.net/x8tzg/24/)

注意：如果您想检测何时到达某个滚动点，您可以在`scroll`事件中添加代码以检查`$(window).scrollTop()`与`$(compareElement).offset().top`此处提到的比较：[如果向下滚动超过它，则让 div 紧贴屏幕顶部](https://stackoverflow.com/questions/2907367/have-a-div-cling-to-top-of-screen-if-scrolled-down-past-it)。

# python - python中具有常量键的字典字典

> ID：13998446
> 
> 赞同：-2
> 
> 时间：2012-12-21T23:20:41.987
> 
> 标签：python

所以我有一个这样的对象列表：

```
['bob', 'tob', 'mom'], ['tom', 'apa'], ['cat'] 
```

我想创建一个这样的字典字典：

```
{
    {0: 'bob', 1: 'tob', 2: 'mom'},
    {0: 'tom', 1: 'apa'},
    {0: 'cat'}
} 
```

完成这项工作的pythonic方法是什么？谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:22:43.257

看起来您只想将 a `list`of `list`s 转换为 a `set`of `dict`s ，其中索引映射到值。

好吧，你不能这样做，因为 a`set`不能保存像`dict`s 这样的不可散列值。但是您可以轻松地将其转换为其中的`list`一个`dicts`。

每一个`list`都可以转换成一个`dict`just by `dict(enumerate(l))`。这为您提供了一个列表，该列表的使用方式与原始列表完全相同`list`（因此`d[0]`返回与 相同的内容`l[0]`），这似乎是您想要的。

要将它们放在一个列表中，只需使用列表推导即可。

```
>>> l=[['bob','tob','mom'],['tom','apa'],['cat']]
>>> d=[dict(enumerate(i)) for i in l]
>>> d
[{0: 'bob', 1: 'tob', 2: 'mom'}, {0: 'tom', 1: 'apa'}, {0: 'cat'}] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:23:34.723

```
index_as_key = dict(enumerate(['bob','tob','mom'])) 
```

如果您在遍历列表时只想要列表项的索引，则无需创建中间字典：

```
for i, item in enumerate(['bob','tob','mom']):
    # do something 
```

# c# - 为什么 catch 块永远不会在设备上执行？

> ID：13998447
> 
> 赞同：2
> 
> 时间：2012-12-21T23:20:58.057
> 
> 标签：c#, xamarin.ios, task-parallel-library, xamarin

考虑这段代码：

```
Task.Factory.StartNew (() => {
    try {
        Console.WriteLine ("Throwing");
        throw new Exception ();
    } catch {
        Console.WriteLine ("Gotcha!");
    }
}); 
```

`Throwing`在 iOS 模拟器上，它`Gotcha!`按预期打印。
但是，**当为设备编译时**，它只打印`Throwing`而从不打印`Gotcha!`。

为什么会这样？
我正在使用 MonoTouch 6.0.8。
我也可以在 6.0.6 上重现它。

我在这里放了一个[示例项目，你可以尝试在设备上运行它](http://rghost.net/42418971)。
（别管这个名字——当我发现这个时，我正在调查另一个崩溃）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:28:30.260

我刚刚发现它只发生在启用 LLVM 的情况下。
也许这是一个错误，所以我会将它报告给 Xamarin。

有趣的是，添加

```
BeginInvokeOnMainThread (() => {
    new UIAlertView ("Gotta catch 'em all!", "", null, "OK", null).Show ();
}); 
```

通话后`Console.WriteLine`帮助 - 我看到警报和日志条目。

这是我的[示例项目](http://rghost.net/42418971)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:29:41.557

也许是一个愚蠢的问题，但是否满足了需要 catch 命令的条件？

如果是这样，应用程序可能会在返回“Gotcha”之前中断，并且 iOS 命令会接管。

我相信 iOS 会倾听您的命令/应用程序是否以及何时中断，因为默认功能会启动来处理这个问题。类似于 dealloc 命令。

# javascript - Javascript 函数无法在 Google Chrome 中执行任务

> ID：13998448
> 
> 赞同：1
> 
> 时间：2012-12-21T22:05:46.433
> 
> 标签：javascript, google-chrome

我研究这个问题已经有一段时间了，鉴于 Google Chrome 似乎在 Javascript 上存在大量问题，我一直很难找到有同样问题的人。

问题是这样的：当锚点调用一个替换 div 内容的新函数时，它会暂时显示正确的结果，然后在 Javascript 进行任何更改之前恢复为 div 的默认内容。

这是脚本：

```
function prologueThree() {
    document.getElementById('content').innerHTML = document.getElementById('prologue3').innerHTML;
}

function prologueFour() {
    userName = document.getElementById('yourname').value;
    if(userName.length === 0) {
        alert("Erm... are you sure that\'s your name?");
        prologueThree();
    } else {
        document.getElementById('content').innerHTML = '<center> \
<img src="http://pokemonroleplay.thedevhome.net/images/Gameboy/characters/red.png"><br> \
Right, so your name is ' + userName + '! \
<br><br> \
<a onclick="prologueFive()"><button>>>Continue>></button></a></center>';
    }
} 
```

这只是脚本的一个片段，但整个事情在 Firefox 中运行良好，对于前三个序言函数，它在 Chrome 中运行良好。只有当它尝试运行 prologueFour 时，它才会惊慌失措并返回。我也尝试过 Chrome 开发者控制台，但它从未注册过错误。

预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T03:00:17.730

我去了你的[网站](http://pokemonroleplay.thedevhome.net) ，我注意到你正在将一个按钮绑定`onclick`到`submit`表单中的一个按钮，而不会阻止执行默认行为，默认行为是刷新页面的表单提交，从而使你失去位置并回到开头. 使用一个普通的旧按钮或锚标签，就像你之前的序幕一样。如果您出于某种原因坚持使用提交，请阻止默认行为，如下所示：

```
function prologueFour(e) {
    typeof e.preventDefault === 'function'
        ? e.preventDefault()
        : e.returnValue = false;
    // now rest of code can continue without page refresh
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T02:44:04.157

我不知道是否还有其他问题，但`>>Continue>>`不是完全符合标准的 html，这可能会导致问题。你应该`&gt;`改用。

# ios - 如何从 JSON 加载并解析到 iOS 5 上的 tableView

> ID：13998452
> 
> 赞同：0
> 
> 时间：2012-12-21T23:21:14.487
> 
> 标签：ios, json, parsing, ios5, tableview

我有一个播放一些链接的音频播放器，我希望通过 JSON 将链接加载到 tableView 中。

继承人我的 tableView 显示链接：（注释掉了，但没有 json 也可以工作）

```
/*
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {
    static NSString *CellIdentifier = @"CellIdentifier";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if(cell == nil) {
        cell = [[[UITableViewCell alloc] initWithStyle:UITableViewCellStyleSubtitle reuseIdentifier:CellIdentifier] autorelease];
    }

    int row = indexPath.row;

    [[cell textLabel] setText:[_radioNames objectAtIndex:row]];
    [[cell detailTextLabel] setText:[_radioSubtitles objectAtIndex:row]];
    if(row == _currentRadio) {
        [cell setAccessoryView:[[[UIImageView alloc] initWithImage:[UIImage imageNamed:@"now_playing.png"]] autorelease]];
    } else {
        [cell setAccessoryView:nil];
    }

    return cell;
}
 */ 
```

这是我获取 JSON 文件的地方：

```
// Download JSON
    NSString *jsonString = [NSString
                            stringWithContentsOfURL:[NSURL URLWithString:@"http://www.xxxxxxxxx/radioliste.json"]
                            encoding:NSStringEncodingConversionAllowLossy
                            error:nil];
    // Create parser
    SBJSON *parser = [[SBJSON alloc] init];
    NSDictionary *results = [parser objectWithString:jsonString error:nil];
    [parser release], parser = nil;
    // Set tableData
    [self setTableData:[results objectForKey:@"items"]];

    NSLog(jsonString); // THIS IS SHOWING ME THE WHOLE JSON FILE, DON'T KNOW IF THAT OK? 
```

这是JSON数据列表：（或者我认为）

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        // Change UITableViewCellStyle
        cell = [[[UITableViewCell alloc]
                 initWithStyle:UITableViewCellStyleSubtitle
                 reuseIdentifier:CellIdentifier] autorelease];
    }

    // Get item from tableData
    NSDictionary *item = [tableData objectAtIndex:[indexPath row]];
    // Set text on textLabel
    [[cell textLabel] setText:[item objectForKey:@"title"]];
    // Set text on detailTextLabel
    [[cell detailTextLabel] setText:[item objectForKey:@"description"]];

    return cell;
} 
```

这是我的 JSON 文件：

```
{
    "radioliste": {
    "items": [
        {
            "id": "The Voice",
            "string": "Afspil The Voice",
            "string": "LINK"
        }
    ]
    }
} 
```

所以这是我的问题......我如何从 JSON 文件中正确加载我的流链接并将它们解析到 tableView 中？JSON文件甚至有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:31:56.860

首先，不要使用 initWithContentsOfURL... 这是一个阻塞调用，会冻结您的应用程序。在异步模式下使用 NSURLConnection 从网络中获取数据。

其次，NSJSONSerialization 从 iOS 5 开始就可用。使用它。

所以，NSURLConnection 会建立一个 NSData。NSJSONSerialization JSONObjectWithData: 将把 NSData 变成一个对象。在您的情况下，它将是一个 NSDictionary。

您粘贴的 JSON 文件与您在 cellForRowAtIndexPath 中使用的对象键名称不匹配。我不确定会发生什么，因为第一项中的两个键是“字符串”。但假设你的意思是标题和描述，你可以使用类似的东西：

```
cell.textLabel.text = tableData[@"items"][indexPath.row][@"title"]; 
```

将标题放入表格单元格中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:28:53.180

像这样使用本机 JSON 库怎么样：

```
NSData* data = [NSJSONSerialization dataWithJSONObject:dict options:0 error:nil]; 
```

和

```
NSDictionary* dict = [NSJSONSerialization JSONObjectWithData:(__bridge NSData *)data options:NSJSONReadingMutableContainers error:nil]; 
```

而不是SBJSON？

编辑：刚刚注意到您的 JSON 存在一些问题。您在字典中有一个重复的键：字符串。

# android - 在片段之间滑动时消失的操作栏按钮

> ID：13998473
> 
> 赞同：9
> 
> 时间：2012-12-21T23:24:24.370
> 
> 标签：android, android-fragments, actionbarsherlock, android-viewpager

我有一个在操作栏中包含多个选项卡的应用程序，每个选项卡都有一组不同的选项菜单图标显示在操作栏中。有些选项卡有两个图标，有些则没有。

问题是当我在屏幕之间滑动时，各个屏幕的按钮可能会显示，也可能不会显示。即在应该有两个图标的屏幕上，操作栏中将没有图标！

但是，当我单击选项卡时，屏幕始终会显示正确的图标。

我尝试在调试器中分析问题。我确定`FragmentPagerAdapter`正确调用`setMenuVisibility(true)`了新选择的 Fragment，其他 Fragment 使用`setMenuVisibility(false)`.

我找不到按钮出现/消失的确切模式。我可以在两个屏幕之间左右滑动，每个屏幕都有两个不同的按钮。该问题将在 1 到 20 次滑动后出现在任何地方。

滑动到带有一个图标的屏幕然后回到带有两个图标的屏幕似乎会加剧消失。

我曾尝试将调用添加到其中，`Activity.invalidateOptionsMenu()`但似乎没有任何影响。例如，我将此调用添加到 TabAdapter 的 onPageScrollStateChanged() 中，该调用在滑动动画完成后调用。我也尝试将其添加到 Fragments 的 onResume() 或 TabAdapter.onTabSelected() 完成后，但无济于事。

我正在使用 ActionBarSherlock 4.1.0（由于不同的问题，我已替换为最新的 android-support-v4.jar）。我的 Activity 扩展`SherlockFragmentActivity`并简单地实例化了一个`ViewPager`. 我已经覆盖了`FragmentPagerAdapter`ViewPager 的适配器（遵循 ViewPager Android 文档上的标准示例）。

我的手机运行的是 Android 2.3.5。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-04T15:11:06.520

[ViewPager / ActionBar, Menu Items not displayed](http://code.google.com/p/android/issues/detail?id=29472)中提供了针对此问题的几种解决方法。第 8 项中讨论的修复对我有用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-10-13T14:49:02.133

只需点击此[链接](https://stackoverflow.com/questions/9338122/action-items-from-viewpager-initial-fragment-not-being-displayed)

```
if (viewPager.getCurrentItem() != position)
  viewPager.setCurrentItem(position); 
```

在 onCreate 中推迟对 viewPager.setCurrentItem 的调用

```
public void onCreate(...) {
    ...
    view.post(new Runnable() {
        public void run() {
            // guarded viewPager.setCurrentItem
        }
    }
} 
```

# tortoisesvn - 如何在 Tortoise SVN 中清理我的存储库

> ID：13998479
> 
> 赞同：0
> 
> 时间：2012-12-21T23:25:54.680
> 
> 标签：tortoisesvn

我有一个 Assembla 存储库，我使用 Tortoise SVN。

文件和版本一团糟，所以我想回到旧版本。我使用“Checkout SVN”选项在我的计算机中获取该版本。

现在我想将我计算机上的所有内容传输到存储库（并删除那里的内容）。

我可以删除存储库中的所有内容，但我不想丢失信息、版本等。

我尝试执行 Commit，但没有传输您未修改的文件的选项。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T01:36:24.927

**在head**修订版中查看存储库的新副本。

在 Windows 资源管理器中，

右键单击存储库顶部 --> TortoiseSVN --> 显示日志

找到要返回的修订版，然后单击鼠标右键。选择“恢复到此版本”。（**不要**将此与“从该版本恢复更改”混淆。）确认您确实想要这样做。

**这将还原本地副本中的**所有更改。要将您的存储库恢复到该版本，只需提交这些本地更改。（并在您的提交消息中清楚地记录您已恢复到特定版本。）

我认为这可能是最简单的方法。据我所知，您无法从 SVN 的记录中删除错误的修订，除非您有意外添加的敏感信息，否则这样做并没有太多好处。

# c# - 一个成员的列表如何有用？

> ID：13998482
> 
> 赞同：0
> 
> 时间：2012-12-21T23:26:13.423
> 
> 标签：c#, .net, generic-collections

我读了一个 SO，它要求最简单的方法来创建一个包含一个成员的列表。

[将对象转换为单元素列表的快速方法？](https://stackoverflow.com/questions/13998343/quick-way-to-turn-object-into-singleton-list)

这对我提出了一个问题，这什么时候有用？

`List<T>`当我将 a与单个成员一起使用而不是`T`变量本身时，我想不出一个例子。

有人可以解释或提供一个例子吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:28:58.140

您可能必须实现一个需要返回对象集合的接口。您有时可能希望返回单个对象，但您仍然必须实现接口，一种方法是创建一个包含单个对象的列表，然后返回该列表。

```
class ConstantValue : IValueProvider
{
    public override IList<int> getValues()
    {
         return new List<int> { 1 };
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:34:10.957

通常，当您有一个恰好包含一个成员的元素的逻辑集合时，就会发生这种情况。例如，您可能有一个 House 类，其中包含一组 Room 项目，但 OneRoomSchoolhouse 类在其 Rooms 集合中只有一个对象。

另一个例子，你可能有一个带有这个签名的方法：

```
void LogNewItems(List<Item> newItems); 
```

如果您只有一项，则必须这样传递它：

```
LogNewItems(new List<Item> { item }); 
```

事实上，如果您正在设计 item-logging API，您可能会创建一个方便的方法，这样开发人员就不必这样做了。该方法可能如下所示：

```
void LogNewItem(Item item)
{
    LogNewItems(new List<Item> { item });
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:42:51.940

所以我不必拥有`DoSomethingWithAListOfFoo(List<Foo> items)`AND`DoSomethingWithAFoo(Foo item)`实现。 `DoSomethingWithAFoo`可以简单地创建单个项目列表并将其传递给`DoSomethingWithAListOfFoo`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-01T21:13:34.973

因为已经没有`IEnumerable<T> Except(T)`可用的重载。

# php - 在选择选项中显示周数

> ID：13998487
> 
> 赞同：2
> 
> 时间：2012-12-21T23:26:49.987
> 
> 标签：php, html

我已经有一个这样的选择选项：

```
<?php
    echo 'Age : <select id="age" name ="age" class="selecta">';
    for($i = 0; $i <= 24; $i += 0.25) 
    { 
?>
    <option value="<?php echo $i ;?>" 
    <?php
    if ($_SESSION['age'] == $i) 
    { 
        echo " selected='selected'"; 
    } 
    ?> > 
    <?php echo $i .'&nbsp&nbsp' ?>
    </option>  
    <?php 
    }
    echo '</select> months <br />';
?> 
```

效果很好并显示：

```
 0           // means 0 month
  0.25        // means 1 week   or  0.25 of month
  0.50        // means 2 weeks  or half month
  0.75
  1           // means 1 month
  1.25
  ....
  24 
```

但它对用户来说看起来不太好。所以我想要的是让它们像这样：

```
0      // 0month
1 week  
2 weeks
3 weeks
4 weeks  
1 month
1 month and 1 week
1 month and 2 weeks
.....
24 months 
```

完全一样不是我的最终愿望，但我想要那样。

这可能吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:56:40.093

```
for($i = 0; $i <= 24; $i += 0.25) { 
```

您在这里有一个 97 次迭代的序列。它同样是

```
range(0, 96); 
```

然后，您将这些步骤中的任何一个映射到特定数字：

```
$map = function($step) {
    return $step * 0.25;
} 
```

例如，这将创建以下序列：

```
0, 0.25, 0.5, 0.75, 1, 1.25, 1.5, 1.75, 2, ... , 23, 23.25, 23.5, 23.75, 24 
```

所以现在你不想要这些数字，只想要美好的月份。如果您更轻松地采取步骤（而不是小数），则可以计算它们：

```
month: floor($step / 4)   - division (integer)
weeks: $step % 4          - modulo   (integer) 
```

或者作为将其转换为文本的映射函数：

```
$map = function ($step) {
    $month = floor($step / 4);
    $week  = $step % 4;

    $buffer = '';

    if ($month) {
        $buffer .= "$month month";
    }

    if ($week) {
        if ($month) {
            $buffer .= ' and ';
        }

        $buffer .=  "$week week" . ($week == 1 ? '' : 's');
    }

    return $buffer;
}; 
```

例如：

```
$map(0)   # (empty)
$map(1)   # 1 week
$map(10)  # 2 month and 3 weeks
$map(95)  # 23 month and 3 weeks
$map(96)  # 24 month 
```

因此，现在您只需将范围作为键映射到它们的值，然后您可以使用这些值执行选择框的标准输出：

```
$list = range(0, 96);

$selected = 12; // $_SESSION['age']

echo "Age : \n<select id='age' name ='age' class='selecta'>\n";
foreach ($list as $value)
{
    $label = $map($value);
    printf("  <option value='%d'%s>%s</option>\n", $value, $value === $selected ? " selected='selected'" : '', $label);
}
echo "</select>\n"; 
```

这为您提供了输出（[Demo](http://eval.in/5118)）：

```
Age : 
<select id='age' name ='age' class='selecta'>
  <option value='0'></option>
  <option value='1'>1 week</option>
  <option value='2'>2 weeks</option>
  <option value='3'>3 weeks</option>
  <option value='4'>1 month</option>
  ...
  <option value='11'>2 month and 3 weeks</option>
  <option value='12' selected='selected'>3 month</option>
  <option value='13'>3 month and 1 week</option>
  ...
  <option value='50'>12 month and 2 weeks</option>
  <option value='51'>12 month and 3 weeks</option>
  <option value='52'>13 month</option>
  <option value='53'>13 month and 1 week</option>
  <option value='54'>13 month and 2 weeks</option>
  ...
  <option value='92'>23 month</option>
  <option value='93'>23 month and 1 week</option>
  <option value='94'>23 month and 2 weeks</option>
  <option value='95'>23 month and 3 weeks</option>
  <option value='96'>24 month</option>
</select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:49:11.627

实际上，当您处于 for 循环中时，您可以使用一些简单的算术和内置函数来分解 $i 的值。也许您可以执行以下操作：

```
$months = intval($i);
$weeks = ($i - floatval($months)) / .25;
echo "{$months} month(s) and {$weeks} week(s)"; 
```

# python - 什么时候应该使用 iteritems() 而不是 items()？

> ID：13998492
> 
> 赞同：167
> 
> 时间：2012-12-21T23:27:24.523
> 
> 标签：python, python-3.x

`items()`在所有地方使用而不是在所有地方使用是否合法`iteritems()`？为什么`iteritems()`从 Python 3 中移除？似乎是一个了不起和有用的方法。背后的原因是什么？

**编辑：**为了澄清，我想知道以与 Python 2 和 Python 3 兼容的方式以类似生成器的方式（一次一个项目，而不是全部进入内存）迭代字典的正确习惯用法是什么?

* * *

## 回答 #1

> 赞同：158
> 
> 时间：2012-12-21T23:31:48.193

在 Python 2.x 中 -[`.items()`](https://docs.python.org/2/library/stdtypes.html#dict.items)返回 (key, value) 对的列表。在 Python 3.x 中，[`.items()`](https://docs.python.org/3/library/stdtypes.html#dict.items)现在是一个`itemview`对象，它的行为不同 - 所以它**必须**被迭代或物化......所以，对于Python 2.x 中`list(dict.items())`的内容是必需的。`dict.items()`

Python 2.7 也有一些用于密钥处理的后端端口，因为你有[`viewkeys`](https://docs.python.org/2/library/stdtypes.html#dict.viewkeys),[`viewitems`](https://docs.python.org/2/library/stdtypes.html#dict.viewitems)和[`viewvalues`](https://docs.python.org/2/library/stdtypes.html#dict.viewvalues)方法，最有用的是`viewkeys`它的行为更像 a `set`（你希望从 a 中得到它`dict`）。

简单的例子：

```
common_keys = list(dict_a.viewkeys() & dict_b.viewkeys()) 
```

会给你一个公共键的列表，但同样，在 Python 3.x 中 - 只是使用`.keys()`。

Python 3.x 通常变得更加“懒惰”——即[`map`](https://docs.python.org/3/library/functions.html#map)现在是有效的[`itertools.imap`](https://docs.python.org/2/library/itertools.html#itertools.imap)，[`zip`](https://docs.python.org/3/library/functions.html#zip)是的[`itertools.izip`](https://docs.python.org/2/library/itertools.html#itertools.izip)，等等。

* * *

## 回答 #2

> 赞同：108
> 
> 时间：2012-12-21T23:29:17.047

`dict.iteritems`被删除是因为`dict.items`现在`dict.iteritems`在 python 2.x 中做了这件事，甚至通过使它成为一个[`itemview`](http://docs.python.org/3.3/library/stdtypes.html#dict-views).

* * *

## 回答 #3

> 赞同：66
> 
> 时间：2014-08-01T14:27:50.503

[这六个库](https://pythonhosted.org/six/)有助于编写与 python 2.5+ 和 python 3 兼容的代码。它有一个 iteritems 方法，可以在 python 2 和 3 中工作。示例：

```
import six

d = dict( foo=1, bar=2 )

for k, v in six.iteritems(d):
    print(k, v) 
```

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2012-12-21T23:32:54.730

[正如python 2](http://docs.python.org/2/library/stdtypes.html#dict)和[python 3](http://docs.python.org/3/library/stdtypes.html#dict)的字典文档会告诉你的那样，在 python 2 中`items`返回一个列表，而`iteritems`返回一个迭代器。

在 python 3 中，`items`返回一个[view](http://docs.python.org/3/library/stdtypes.html#dict-views)，它与迭代器几乎相同。

如果您使用的是 python 2，如果您正在处理大型字典，您可能想要 user`iteritems`并且您想要做的就是迭代项目（不一定将它们复制到列表中）

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2013-12-02T12:53:02.833

正如@Wessie 所指出的，`dict.iteritems`,`dict.iterkeys`和`dict.itervalues`（在 Python2.x 中返回**迭代器**）以及`dict.viewitems`,`dict.viewkeys`和`dict.viewvalues`（在 Python2.x 中返回**视图对象**）都在 Python3.x 中被删除

和`dict.items`, `dict.keys`and`dict.values`用于在 Python2.x 中返回字典列表的**副本**，现在在 Python3.x 中返回**视图对象，***但*它们仍然与**迭代器**不同。

如果要在 Python3.x中返回**迭代器**[`iter(dictview)`](http://docs.python.org/3.3/library/stdtypes.html#dictionary-view-objects)，请使用：

```
$ python3.3

>>> d = {'one':'1', 'two':'2'}
>>> type(d.items())
<class 'dict_items'>
>>>
>>> type(d.keys())
<class 'dict_keys'>
>>>
>>>
>>> ii = iter(d.items())
>>> type(ii)
<class 'dict_itemiterator'>
>>>
>>> ik = iter(d.keys())
>>> type(ik)
<class 'dict_keyiterator'> 
```

* * *

## 回答 #6

> 赞同：7
> 
> 时间：2014-07-04T08:23:29.933

你不能在 Python 的所有地方都`items`使用它。`iteritems`例如，下面的代码：

```
class C:
  def __init__(self, a):
    self.a = a
  def __iter__(self):
    return self.a.iteritems()

>>> c = C(dict(a=1, b=2, c=3))
>>> [v for v in c]
[('a', 1), ('c', 3), ('b', 2)] 
```

如果你使用会打破`items`：

```
class D:
  def __init__(self, a):
    self.a = a
  def __iter__(self):
    return self.a.items()

>>> d = D(dict(a=1, b=2, c=3))
>>> [v for v in d]
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
TypeError: __iter__ returned non-iterator of type 'list' 
```

[viewitems](https://docs.python.org/2/library/stdtypes.html#dict.viewitems)也是如此，它在 Python 3 中可用。

此外，由于[items](https://docs.python.org/2/library/stdtypes.html#dict.items)返回字典对列表的副本`(key, value)`，因此效率较低，除非您无论如何都想创建副本。

在 Python 2 中，最好使用`iteritems`迭代。如果您决定升级到 Python 3，该`2to3`工具可以替换它。`items`

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2020-03-31T09:23:29.607

`future.utils`允许 python 2 和 3 的兼容性。

```
# Python 2 and 3: option 3
from future.utils import iteritems
heights = {'man': 185,'lady': 165}
for (key, value) in iteritems(heights):
    print(key,value)

>>> ('lady', 165)
>>> ('man', 185) 
```

请参阅此链接：[https ://python-future.org/compatible_idioms.html](https://python-future.org/compatible_idioms.html)

# python - Python脚本在一段时间后停止

> ID：13998496
> 
> 赞同：0
> 
> 时间：2012-12-21T23:27:54.427
> 
> 标签：python, linux, crash, cron, debian

我有一个带有 raspbian 的树莓派，并且我创建了一个我需要一直运行的 python 脚本。问题是，运行一个小时左右，脚本突然停止，python进程关闭。我不知道为什么，而且我对 linux 很陌生，所以我不知道如何调试它或任何东西。我认为这不是内存问题，因为在 while 循环中我释放并重新初始化所有使用的对象。如何找出问题所在，或者至少在程序停止后自动重新启动程序？

这是代码：

```
import time
import sys
import ftputil
import pygame
import pygame.camera
import logging

pygame.camera.init()
#pygame.camera.list_camera() #Camera detected or not
cam = pygame.camera.Camera("/dev/video0",(640,480))
count = 5
logging.basicConfig(filename='log.log', level=logging.INFO)
logging.info(str(time.time())+" : Script was started")

while True:
        cam.start()
        img = cam.get_image()
        pygame.image.save(img,"current.jpeg")
        cam.stop()
        host = ftputil.FTPHost(**)
        host.upload("./current.jpeg", "/domains/*/public_html/webcam.jpg", mode='b')
        host.close()
        if not count:
                host = ftputil.FTPHost(**)
                filename = str(time.time()) + ".jpg"
                host.upload("./current.jpeg", "/webcamarchive/"+filename, mode='b')
                host.close()
                count = 10
                logging.info(str(time.time())+": Still running")
        count -= 1
        time.sleep(3) 
```

我从 ssh 运行脚本。但是我也想让它在计算机启动时启动，我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:31:41.640

我们不必担心每次计算机启动时都运行它，直到您可以让它在正常登录会话中连续运行。

如果您正在`ssh`进入计算机并启动它，只需将会话保持`ssh`打开状态，然后观察它打印出来的内容。如果您出于某种原因无法做到这一点，请通过执行来捕获输出，例如，`python foo.py >foo.out 2>foo.err`而不是仅仅`python.py`. 无论哪种方式，您都可以看到它停止的*原因*，而不仅仅是知道它已经停止。

您还应该查看`log.log`您在代码中显式创建的文件，以及系统日志（`/var/log/syslog`默认情况下在大多数 linux 发行版上），看看那里是否有任何相关内容。

另外，请告诉我们您是*如何*“从 ssh 运行 [ning] 脚本”的。如果您使用 将其作为后台`&`，将其作为`ssh`命令发送等，则需要修改上述说明。（但您不必等待修改后的版本——只需这一次，`ssh`进入一个正常的登录脚本，在没有后台的情况下运行它，然后让它继续运行。）

仅凭您迄今为止提供给我们的信息，不可能确切地知道发生了什么。但我的第一个猜测是你得到了一个未处理的异常，你会看到它是一个异常回溯，如下所示：

```
Traceback (most recent call last):
  File "exc.py", line 7, in <module>
    foo()
  File "exc.py", line 5, in foo
    print(1/x)
ZeroDivisionError: integer division or modulo by zero 
```

解决方法是处理它。最简单的修复是这样的：

```
while True:
    try:
        cam.start()
        img = cam.get_image()
        pygame.image.save(img,"current.jpeg")
        cam.stop()
        host = ftputil.FTPHost(**)
        host.upload("./current.jpeg", "/domains/*/public_html/webcam.jpg", mode='b')
        host.close()
        if !count:
                host = ftputil.FTPHost(**)
                filename = str(time.time()) + ".jpg"
                host.upload("./current.jpeg", "/webcamarchive/"+filename, mode='b')
                host.close()
                count = 10
                logging.info(str(time.time())+": Still running")
        count -= 1
    except Exception as e:
        logging.error('Caught exception: ' + str(e))
    time.sleep(3) 
```

但是，您最好查看可能遇到的每种异常——或者查看实际遇到的异常*——*并在每个地方放置适当的错误处理和日志记录，并且仅将其用作最后——沟回退。

此外，您应该真正使用`with`子句而不是手动`close`调用。例如，如果`host.upload()`加注，`host.close()`永远不会被跟注。所以，而不是这个：

```
host = ftputil.FTPHost(**)
host.upload("./current.jpeg", "/domains/*/public_html/webcam.jpg", mode='b')
host.close() 
```

做这个：

```
with contextlib.closing(ftputil.FTPHost(**)) as host:
    host.upload("./current.jpeg", "/domains/*/public_html/webcam.jpg", mode='b') 
```

（许多类型甚至不需要`closing`，因为它们本身就是上下文管理器，所以先尝试一下——但如果你收到关于`ftputil.FTPHost`没有`__enter__`or的错误`__exit__`，这就是你可以处理的方法。）

# css - IE7 和 IE8 不将 CSS 应用于 HTML5

> ID：13998499
> 
> 赞同：1
> 
> 时间：2012-12-21T23:28:28.077
> 
> 标签：css, html, internet-explorer-8, internet-explorer-7

我一直在努力让 HTML5 标签在 IE7 和 IE8 上工作。最后我使用了 html5shiv.js 并且问题解决了。元素显示在屏幕上，就像它们显示在任何现代浏览器上一样。

但是现在，我不知道为什么 IE7 和 IE8 不会应用我声明的 css 规则。例如：

```
header
{
    background-color: #000000;
} 
```

不将黑色背景颜色应用于标题标签或任何背景颜色。当我在 IE7 和 IE8 上搜索该声明时，它似乎未声明，但是当我在 IE9 模式下尝试 IE 时，我声明的相同 css 规则会出现并使用黑色背景颜色设置元素的样式。任何帮助或解决方案将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T05:49:24.340

希望这对你有帮助，

所有浏览器都能正确呈现 HTML5 标记 - 甚至 IE6：

[http://net.tutsplus.com/tutorials/html-css-techniques/how-to-make-all-browsers-render-html5-mark-up-correctly-even-ie6/](http://net.tutsplus.com/tutorials/html-css-techniques/how-to-make-all-browsers-render-html5-mark-up-correctly-even-ie6/)

谢谢。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:47:02.137

无法重现。使用[http://browserstack.com](http://browserstack.com)，我在 Windows XP 上本机运行的 IE7 和 IE8 中测试了以下代码，它们都按预期正确应用了 CSS：

我只能怀疑你在某个地方错过了一些东西，因此没有得到你期望的结果。尝试将您的项目缩减为一个小型测试用例，就像我在这里所做的那样。确保您已经引用了所有适当的依赖项。

```
<!DOCTYPE html>
<html lang="en">
    <head>
        <title>HTML5 Elements in IE7/8</title>
        <!--[if lt IE 9]>
            <script src="html5shiv.js"></script>
        <![endif]-->
        <style type="text/css">
            header {
                background-color: #000000;
                color: #FFFFFF;
            }
        </style>
    </head>
    <body>
        <header>Hello, world!</header>
    </body>
</html> 
```

截屏：

![在此处输入图像描述](../Images/6f35b45d46583fefcccf7cfd470c15e0.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:52:55.087

当你想用一种跨浏览器的方式来设置这些元素的样式同时仍然保留它们的语义含义时，你可以将它们中的每一个包装在一个 div 中，并将 CSS 作为一个类应用于该 div。大多数语义标记的用例无论如何都不需要样式——它们的主要目的是将这些信息传递给通过 CSS 样式传递给人类的机器。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-01-05T23:29:35.197

好吧，您必须检查标题区域，例如

如果您之前添加了一些评论

```
<!DOCTYPE html> 
```

然后您也会遇到诸如缺少css类或属性之类的问题

# sql - 如何使用左连接有效地连接 2 个表以根据字段仅获得一个结果

> ID：13998504
> 
> 赞同：0
> 
> 时间：2012-12-21T23:29:01.713
> 
> 标签：sql, left-join

我有两张桌子

登记处

```
ClientID  Name  Incube
----------------------
1         Joe    as
2         Jack   gt
3         Jor    ee 
```

订金

```
DepositID  ClientID Quantum
----------------------------
1                1    100.45 
2                1    34.5
3                1    22.0
4                2    1000.0 
```

我只想得到一个结果，这是注册表中的名称、Incube 以及该人所有存款的总和，所有这些都对应于某个 ClientID

首先我做了2个查询

```
SELECT [Name],[Incube] FROM Registry WHERE [ClientID] = 1;
SELECT DISTINCTROW Sum([Deposit].[Quantum]) As Total FROM Deposit WHERE [ClienteID] = 1; 
```

然后我做了一个左连接让一切变得更容易

```
SELECT 
[a].[ClientID],
[a].[Name],
[a].[Incube],
Sum([b].[Quantum]) as Total
FROM Registry a
LEFT JOIN Deposit b 
ON a.ClientID=b.ClientID 
group by a.Name, a.ClientID, a.Incube; 
```

如何过滤 de WHERE 子句？我想获取 ClientID=1 的所有数据，而不是全部，这里的问题是如何只计算必要的 ClientID 而不是所有的 clientsID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:33:11.043

除非我遗漏了什么，否则您只需要添加该`WHERE`子句：

```
SELECT 
  [a].[ClientID],
  [a].[Name],
  [a].[Incube],
  Sum([b].[Quantum]) as Total
FROM Registry a
LEFT JOIN Deposit b 
  ON a.ClientID=b.ClientID 
where a.clientid = 1
group by a.Name, a.ClientID, a.Incube; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/d3673/3)

结果是：

```
| CLIENTID | NAME | INCUBE |  TOTAL |
-------------------------------------
|        1 |  Joe |     as | 156.95 | 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:42:52.253

出于您的目的，根本不需要 Left Join。仅当您还需要不匹配的列时才使用它。简单的内部连接就可以了，

```
select r.ClientID,r.Name,r.Incube,nvl(sum(d.Quantum),0) as quantum
from Registry r,Deposit d where r.clientId=d.clientID 
and r.clientID=1
group by r.clientID,r.Name,r.Incube; 
```

[SqlFiddleDemo](http://sqlfiddle.com/#!4/b0272/2)

# ruby-on-rails - Heroku - ActionView::Template::Error (PG::Error: ERROR: column category_products.desc 不存在

> ID：13998507
> 
> 赞同：0
> 
> 时间：2012-12-21T23:29:14.677
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, heroku

我正在使用 RailsAdmin，这是我`CategoryProduct`在 RailsAdmin 中单击模型时遇到的错误。

这是错误的样子：

```
Started GET "/admin/category_product" for 67.230.41.62 at 2012-12-21 23:20:07 +0000
2012-12-21T23:20:07+00:00 app[web.1]: 
2012-12-21T23:20:07+00:00 app[web.1]: ActionView::Template::Error (PG::Error: ERROR:  column category_products.desc does not exist
2012-12-21T23:20:07+00:00 app[web.1]: LINE 1: ...ry_products".* FROM "category_products"  ORDER BY category_p...
2012-12-21T23:20:07+00:00 app[web.1]:                                                              ^
2012-12-21T23:20:07+00:00 app[web.1]: : SELECT  "category_products".* FROM "category_products"  ORDER BY category_products. desc LIMIT 20 OFFSET 0):
2012-12-21T23:20:07+00:00 app[web.1]:     120:       %tbody
2012-12-21T23:20:07+00:00 app[web.1]:     121:         - @objects.each do |object|
2012-12-21T23:20:07+00:00 app[web.1]:     122:           %tr
2012-12-21T23:20:07+00:00 app[web.1]:     123:             %td
2012-12-21T23:20:07+00:00 app[web.1]:     124:               = check_box_tag "bulk_ids[]", object.id, false
2012-12-21T23:20:07+00:00 app[web.1]:     125:             - if @other_left_link ||= other_left && index_path(params.except('set').merge(params[:set].to_i != 1 ? {:set => (params[:set].to_i - 1)} : {}))
2012-12-21T23:20:07+00:00 app[web.1]:     126:               %td.other.left= link_to "...", @other_left_link, :class => 'pjax'^ 
```

这些是我的`category`, `product`&`category_product`模型：

`Category.rb`

```
# == Schema Information
#
# Table name: categories
#
#  id         :integer          not null, primary key
#  name       :string(255)
#  created_at :datetime         not null
#  updated_at :datetime         not null
#

class Category < ActiveRecord::Base
  attr_accessible :name
    has_many :category_products do
         def with_products
           includes(:product)
         end
       end

  has_many :products, :through => :category_products

  def top_products(number)
    category_products.with_products.order("purchases_count DESC").limit(number).map {|c| c.product} # product included
  end

end 
```

`Product.rb`

```
# == Schema Information
#
# Table name: products
#
#  id          :integer          not null, primary key
#  name        :string(255)
#  description :string(255)
#  price       :float
#  vendor_id   :integer
#  created_at  :datetime         not null
#  updated_at  :datetime         not null
#  image       :string(255)
#

class Product < ActiveRecord::Base
  attr_accessible :name, :description, :price, :vendor_id, :image, :category_ids
    mount_uploader :image, ImageUploader

    belongs_to :vendor
    has_many :category_products do
           def with_categories
             includes(:category)
           end
    end

    has_many :categories, :through => :category_products

  def top_categories(number)
    category_products.with_categories.order("purchases_count DESC").limit(number).map {|c| c.category} # category included
  end

end 
```

`Category_Product`

```
# == Schema Information
#
# Table name: category_products
#
#  id              :integer          not null, primary key
#  product_id      :integer
#  category_id     :integer
#  purchases_count :integer          default(0)
#  created_at      :datetime         not null
#  updated_at      :datetime         not null
#

class CategoryProduct < ActiveRecord::Base
  attr_accessible :product_id, :category_id, :purchases_count

    belongs_to :product
  belongs_to :category

  validates_uniqueness_of :product_id, :scope => :category_id
end 
```

有什么想法可能导致这种情况吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T05:02:29.057

原来问题出在 Heroku 这边（我假设）。

我对代码库进行了一次不同的更新，然后这个问题似乎消失了。

# javascript - javascript函数的编排

> ID：13998512
> 
> 赞同：2
> 
> 时间：2012-12-21T23:29:32.797
> 
> 标签：javascript, jquery, orchestration

我正在尝试运行 2 个函数，然后在单击处理程序中重新定位用户。代码如下。

```
$(".myLink").click( function() {
  function1(param1); // This function contains an ajax call that updates a DB.
  function2(param1); // This function does as well.
  window.location="foo.php";
}); 
```

虽然我的 window.location 正确重新定位，但功能未正确触发。我被困在 jQuery 1.43 上，所以我不能使用延迟对象。

处理上述编排的公认架构是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:32:10.030

回调

```
$(".myLink").click( function() {
  function1(param1, { success: function() {
    function2(param1, { success: function() {
      window.location = "foo.php";
    }});
  }});
}); 
```

或者也许是这样，这将允许他们同时开火：

```
$(".myLink").click( function() {
  completed = 0;
  var success = function() {
    completed++;
    if (completed === 2) {
      window.location = "foo.php";
    }
  }
  function1(param1, { success: success });
  function2(param1, { success: success });
}); 
```

这基本上是你可以在没有合适的`Defered`库的情况下做到这一点的方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:32:18.977

您`success`的第一个 ajax 调用函数必须触发第二个 ajax 调用。

# database - 数据库中的冗余是否可以接受，或者它总是设计不良的标志？

> ID：13998515
> 
> 赞同：1
> 
> 时间：2012-12-21T23:30:03.000
> 
> 标签：database

我有两张桌子：

*   `auth`包含认证信息
*   `users`包含用户个人资料信息

`auth`有一个`username`专栏。这既可用作登录凭据，又可用作用户配置文件 URL 的一部分（例如`example.com/profiles/username`）。

检索用户列表时，需要他们的用户名来创建他们个人资料的 URL。目前，我查询`users`表并加入`auth`表以获取此信息。`username`但是，如果也是 中的列，则可以避免该连接`users`，从而在两个不同的表中创建两个相同的列。

我不喜欢重复列的想法，但少一个连接总是好的。这是否表明数据库模式（或其他内容）需要重新设计，或者这是可以接受冗余的示例？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T23:35:28.287

规范化您的模式（即消除冗余）并非旨在解决时间效率问题，而是a）空间效率（通过消除数据的重复副本）和b）一致性（通过不在多个地方存储相同的信息，您不会冒着让他们不同意的风险）。从这个角度来看，必须使用联接是这些其他好处的代价。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:52:23.853

如果没有对您的应用程序进行更广泛的了解，很难给您一个好的答案。我个人认为复制用户名等信息并不是一个好主意。

当您做出此类设计决策时，您应该考虑系统维护/未来发展等。几点：

*   用户名将来会被用户更改吗？对于重复的列，简单的更新有时会变得非常具有挑战性来更新多个表（如果您复制一次信息，其他团队可以效仿该示例并一次又一次地进行）。
*   如果您的系统是由不同的团队开发或维护的（他们不一定对您的系统有足够的了解），他们可能会错过一些表的重复并导致数据不一致。

希望这会有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-22T00:31:37.057

“少一个连接总是好的”。我对此有异议。数据库设计用于将表连接在一起。额外的连接通常需要以下工作：

1.  在第二个表的索引中找到包含键的页面。非常快，因为索引应该在内存中。
2.  在第二个表中检索该值。
3.  处理页面上的数据。

虽然这听起来像是很多工作，但实际上最多只有几毫秒的努力。

如果第二个表适合内存——或者您在索引中包含用户名字段，因此不需要第二次读取——那么这一切都发生得很快。诚然，如果您试图从平庸的硬件中获得每秒 5,000 个事务，那么您可能会关心。对于大多数目的，额外的几毫秒（最多！）并不昂贵。

这些额外的工作能给你带来什么？它确保用户名是最新的用户名（如果已更改）。

您可能对您的应用程序有其他要求。性能可能很关键，在这种情况下，非规范化数据可能很有用（尽管复合索引可能在性能方面非常接近）。您可能处于内存有限的环境中，在这种情况下，在单个页面读取中加载所有用户数据可能很重要。用户名可能永远不会改变，在这种情况下，您可能会考虑将用户名作为表上的主键。也就是说，在某些情况下，非规范化将是一个严肃的选择。

肯定还有其他情况。例如，几乎所有的分析都来自非规范化的数据结构。

# vim - 创建读取单个键的 vim 函数

> ID：13998520
> 
> 赞同：3
> 
> 时间：2012-12-21T23:30:31.873
> 
> 标签：vim, map, macros

如何让 vim 函数等待单次按键？

例子：

*   创建一个函数 NextOccur，该函数映射为在`f`按下键时执行
*   `f`按下时没有任何帮助
*   在按下下一个键（比如说`x`）后，光标应该移动到下一个`x`

> PS：是的，我知道这正是`f`默认情况下所做的（尽管它只是逐行），但我想知道我们是否可以自己实现这样的功能

如果我想等待接下来的两个按键怎么办，这也可能吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T01:51:13.140

您可以使用内置`getchar()`功能。它等待一个按键然后返回它。对于一个普通的 8 位字符，你必须使用`nr2char(getchar())`它来将其转换为字符串。

您似乎也想扩展`f`/`t`命令以涵盖多行。请注意，已经有插件可以做到这一点，例如[ft_improved](http://www.vim.org/scripts/script.php?script_id=3877)。

# css - Django 管理员 css 问题

> ID：13998524
> 
> 赞同：1
> 
> 时间：2012-12-21T23:30:46.083
> 
> 标签：css, django, apache, django-admin

我在我的网络服务器上安装了 django，但我遇到了 css 和 iamge 文件的问题。我创建了一个 apache 别名，将请求重新路由到管理员的 css 文件所在的正确文件夹。问题是它在 Firefox 中正确显示，但不是 chrome 或 IE。在 chrome 或 IE 中，它不使用任何 css 或图像文件。转到以下 url 会显示该位置的 css，因此我知道它正在正确重新路由，并且管理 html 文件正在使用此 url。但它只是不使用 chrome 或 IE 中的 css。

“http://www.mysite.com/static/admin/css/dashboard.css”

static/admin/ 是我的 apache 设置中的别名。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T11:50:25.327

您可以使用检查元素来找出真正加载或缓存在 Firefox 中的 css 文件。如果已加载但无法在 chrome 和 IE 中显示，则问题是由于您使用的 css 但如果未加载，则应更正别名

我认为拥有良好路由的更好方法是嵌入 urls.py 文件中，这样 django 服务器会处理它，当然你可以在你的电脑上检查它然后上传到服务器。

如果你能把你的网站地址，也许我可以做更多的帮助。

问候穆罕默德

# jboss - 使用Nginx去除url中的项目名

> ID：13998525
> 
> 赞同：1
> 
> 时间：2012-12-21T23:30:45.893
> 
> 标签：jboss, nginx

我正在使用我们的主要项目在其上运行的 JBOSS 应用程序服务器。在顶部，我们使用 nginx 作为网络服务器来侦听端口 80，该端口充当代理，将所有连接转发到运行 jboss 项目的 8080 端口。下面是我们添加的配置。现在第一页使用`http://domain_name`登录页面 url 可以正常工作。但是在我们登录页面后重定向到下一页并两次附加项目名称，因此抛出错误，因为它在该路径中找不到页面。如何重写将为使用 nginx 的用户删除项目名称的 url？我知道我们可以通过更改 web.xml 中的上下文根标记来默认使用这个项目，除了我们可以做的任何事情。

**Nginx 配置**

```
location / {
        proxy_pass http://localhost:8080/project1/;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
#       proxy-set_header Host $host;
    } 
```

错误

```
HTTP Status 404 - /project1/project1/

type Status report

message /project1/project1/

description The requested resource (/project1/project1/) is not available. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T08:19:00.103

只需使用`proxy_pass http://localhost:8080;`

也就是说，`project1`从代理传递指令中删除。

* * *

要让用户只输入`http://domain.com`而不输入`http://domain.com/project_name`，您需要在 nginx 中使用[root](http://wiki.nginx.org/HttpCoreModule#root)指令。

`root /server/path/to/domain.com/project_name;`

您的其他服务器应使用等效指令进行设置。对于 Apache，这是[DocumentRoot](http://httpd.apache.org/docs/current/mod/core.html#documentroot)指令。

# kendo-ui - Kendo UI Mobile - 无法打开外部链接

> ID：13998531
> 
> 赞同：5
> 
> 时间：2012-12-21T23:31:32.353
> 
> 标签：kendo-ui

如何使用 Kendo UI Mobile 2012.3.1114 打开外部链接。

```
<ul data-role="listview">
    <li><a href="tel:1-555-555-5555" data-rel="external">tel:1-555-555-5555</a></li>
    <li><a href="mailto:test@test.com" data-rel="external">mailto:test@test.com</a></li>
    <li><a href="geo:0,0?q=google" data-rel="external">geo:0,0?q=google</a></li>
    <li><a href="http://google.com/" data-rel="external">http://google.com/</a></li>
</ul> 
```

[http://jsfiddle.net/macwebdev/uQmcD/](http://jsfiddle.net/macwebdev/uQmcD/)

难道我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-08T19:14:16.017

HTML5 属性 data-rel="external" 应该可以工作，或者使用 Javascript/jQuery 来更改 url。

剑道 HTML5 示例：

```
<a href="http://kendoui.com/" data-rel="external">Visit KendoUI</a> 
```

更多信息： [http ://docs.kendoui.c​​om/getting-started/mobile/application#linking-to-external-pages](http://docs.kendoui.com/getting-started/mobile/application#linking-to-external-pages)

Javascript/jQuery 示例：

```
$("body").on("click",'a[data-rel="external"]', function(e) {
    e.preventDefault();
    window.open($(this).attr("href"));
}); 
```

示例：http: [//jsfiddle.net/uQmcD/4/](http://jsfiddle.net/uQmcD/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T08:05:17.577

尝试下载更新版本的 Kendo Mobile。有一个错误以类似的方式表现出来。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:09:16.923

尝试将 target="_blank" 添加到您的链接。

PS：它适用于 2012 版的 Kendo，但不适用于最新版本以及最新的 PhoneGap。

# android - AsyncTask 和大量的执行

> ID：13998533
> 
> 赞同：0
> 
> 时间：2012-12-21T23:31:47.490
> 
> 标签：android, android-asynctask

我需要`AsyncTask`遍历大约 100,000 个数字并为每个数字检索数据。当提交 1,000 个参数时它工作正常，甚至可以处理 10,000 个参数，但是非常缓慢和滞后。首先，我提交了所有要执行的数字的数组，但注意到当我有时会得到大约 60,000 个数字时`RejectedExecutionException`，但通常它只是退出我的应用程序而没有任何`Exeptions`错误或错误。

这是这种情况下的代码：

```
for(int i = 0; i < 70000; i++){
    numbers[i] = i;
}

new NetTask().execute(numbers); 
```

在这种情况下还有 AsyncTask ：

```
public class NetTask extends AsyncTask<Integer, String, String>
    {
        @Override
        protected String doInBackground(Integer... params)
        {   
            for (Integer number : params) {
                    try {
                        // DO NETWORK STUFF
                        publishProgress(number+" Successful");
                    } catch (Exception ex) {
                        publishProgress(number+" Failed");
                    }
            }
            return "";
        }
    } 
```

然后我在某处读到，如果需要执行具有这样数量参数的任务，那么最好在单个 AsyncTask 中处理它，例如通过循环每个值，因为我之前使用的代码创建了大量的 AsyncTask。所以我尝试提交由“：”分隔的单个字符串中的数字，然后在 AsyncTask 中将它们切回单个数字并使用它们执行任务，但仍然得到与之前尝试类似的结果。

这是本例中的 AsyncTask：

```
public class NetTask extends AsyncTask<String, String, String>
    {
        @Override
        protected String doInBackground(String... params)
        {

            for (String line : params) {

                String[] numbers = line.split(":");

                for (int i = 0; i < numbers.length; i++) {
                    int number = Integer.parseInt(numbers[i]);
                    try {
                        // DO NETWORK STUFF
                        publishProgress(number+" Successful");
                    } catch (Exception ex) {
                        publishProgress(number+" Failed");
                    }
                }
            }
            return "";
        } 
```

有没有人知道任何更好和更有效的方法来实现我所追求的目标？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:13:29.843

> 那么完成如此大量任务的正确方法是什么？

首先，正如常先生所指出的，这确实需要一项或几项任务。每个任务都应该一次“检索”有关大量“数字”的数据。例如，如果“检索数据”的意思是“进行 Web 服务调用”，那么进行 100,000 次 Web 服务调用，可能会消耗 100MB 的带宽，这是非常荒谬的。或者，如果“检索数据”的意思是“对 SQLite 数据库运行查询”，则使用`IN`运算符在一次数据库操作中“检索有关大量“数字”的数据，而不是尝试执行 100,000 个单独的数据库查询。

此外，假设您确实关心您选择“检索”的这些“数据”，则`AsyncTask`可能不是合适的引擎。如果无论 UI 层发生什么都应该进行这项工作，请改用 an `IntentService`，因为它可以独立于您的任何活动运行。

不过，让我们假设，`AsyncTask`出于某种原因，做 100,000 件事情实际上是合适的。我从未尝试将 100,000 个参数传递给可变参数样式的方法。这可能运行良好。如果数字是连续的，您只需要传递第一个和最后一个值，并且`AsyncTask`可以很好地计数。或者，如果您确实需要将 100,000 个不同的数字传递给`AsyncTask`，并且如果 Traceview 指示将 100,000 个参数传递给`execute()`是不好的，那么创建一个`ArrayList<Integer>`并以这种方式传递它们。

# validation - Symfony2：集合验证导致实体字段错误

> ID：13998535
> 
> 赞同：0
> 
> 时间：2012-12-21T23:31:53.733
> 
> 标签：validation, symfony

在具有集合字段的表单中，其中集合包含实体字段（成员类型中的 eid），添加集合验证会导致实体字段引发以下错误：

> 在渲染模板期间抛出异常（“注意：类 Mana\ClientBundle\Entity\Ethnicity 的对象无法转换为 int

如果没有验证，实体字段会被正确处理。并且将实体字段添加到验证器没有任何效果。

收藏：

```
->add('members', 'collection', array(
    'type' => new MemberType(),
    'allow_add' => true,
    'allow_delete' => true,
    'by_reference' => false,
    'prototype' => true,
)) 
```

会员类型：

```
->add('include', 'choice', array(
    'choices' => array('Yes' => 'Yes', 'No' => 'No'),
    'empty_value' => false,
    'required' => false))
->add('fname', null, array('required' => false))
->add('sname', null, array('required' => false))
->add('dob', 'dob_age')
->add('gender', 'choice', array(
    'choices' => array('Male' => 'Male', 'Female' => 'Female'),
    'empty_value' => false,
    'required' => false))
->add('eid', 'entity', array(
    'property' => 'abbr',
    'label' => '',
    'class' => 'ManaClientBundle:Ethnicity',
    'query_builder' => function(EntityRepository $er) {
        return $er->createQueryBuilder('e')
                ->orderBy('e.abbr', 'ASC');
    }
)); 
```

验证：

```
/**
* @Assert\Collection(
 *  fields = {
 *      "fname" = @Assert\NotBlank(message = "Member first name may not be blank"),
 *      "dob" = @Assert\NotBlank(message = "Member DOB may not be blank"),
 *      },
 *      allowExtraFields = true
 * )
 */ 
```

会员单位：

```
class Member 
{

    /**
     * @var integer $id
     *
     * @ORM\Column(name="hid", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

     /**
     * @ORM\ManyToOne(targetEntity="Client",inversedBy="members",cascade={"remove", "persist"})
     * @ORM\JoinColumn(name="clientId", referencedColumnName="id")
     * 
     */
     protected $client;

    public function setClient(Client $client)
    {
        $this->client = $client;
        return $this;
    }

    public function getClient()
    {
        return $this->client;
    }

   /**
     * @var string $fname
     *
     * @ORM\Column(name="fname", type="string", length=30, nullable=false)
     */
    private $fname;

    /**
     * @var string $sname
     *
     * @ORM\Column(name="sname", type="string", length=45, nullable=false)
     */
    private $sname;

    /**
     * @var \DateTime $dob
     *
     * @ORM\Column(name="dob", type="date", nullable=true)
     */
    private $dob;

    /**
     * @var string $include
     *
     * @ORM\Column(name="include", type="string", nullable=false)
     */
    private $include;

    /**
     * @var string $gender
     *
     * @ORM\Column(name="gender", type="string", nullable=false)
     */
    private $gender;

    /**
     * @var \DateTime $excludeDate
     *
     * @ORM\Column(name="exclude_date", type="date", nullable=true)
     */
    private $excludeDate;

    /**
     * @var integer $eid
     *
     * @ORM\Column(name="eid", type="integer", nullable=true)
     */
    private $eid;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId() {
        return $this->id;
    }

    /**
     * Set fname
     *
     * @param string $fname
     * @return member
     */
    public function setFname($fname) {
        $this->fname = $fname;

        return $this;
    }

    /**
     * Get fname
     *
     * @return string 
     */
    public function getFname() {
        return $this->fname;
    }

    /**
     * Set sname
     *
     * @param string $sname
     * @return member
     */
    public function setSname($sname) {
        $this->sname = $sname;

        return $this;
    }

    /**
     * Get sname
     *
     * @return string 
     */
    public function getSname() {
        return $this->sname;
    }

    /**
     * Set dob
     *
     * @param \DateTime $dob
     * @return member
     */
    public function setDob($dob) {
        $this->dob = $dob;

        return $this;
    }

    /**
     * Get dob
     *
     * @return \DateTime 
     */
    public function getDob() {
        return $this->dob;
    }

    /**
     * Set include
     *
     * @param string $include
     * @return member
     */
    public function setInclude($include) {
        $this->include = $include;

        return $this;
    }

    /**
     * Get include
     *
     * @return string 
     */
    public function getInclude() {
        return $this->include;
    }

    /**
     * Set gender
     *
     * @param string $gender
     * @return member
     */
    public function setGender($gender) {
        $this->gender = $gender;

        return $this;
    }

    /**
     * Get gender
     *
     * @return string 
     */
    public function getGender() {
        return $this->gender;
    }

    /**
     * Set excludeDate
     *
     * @param \DateTime $excludeDate
     * @return member
     */
    public function setExcludeDate($excludeDate) {
        $this->excludeDate = $excludeDate;

        return $this;
    }

    /**
     * Get excludeDate
     *
     * @return \DateTime 
     */
    public function getExcludeDate() {
        return $this->excludeDate;
    }

    /**
     * Set eid
     *
     * @param integer $eid
     * @return member
     */
    public function setEid($eid) {
        $this->eid = $eid;

        return $this;
    }

    /**
     * Get eid
     *
     * @return integer 
     */
    public function getEid() {
        return $this->eid;
    } 
```

种族实体：

```
class Ethnicity
{
    public function __toString() {
        return strval($this->id);
    }

    public function __construct()
    {
        $this->members = new ArrayCollection();
        $this->clients = new ArrayCollection();
    }

    /**
     * @var integer $id
     *
     * @ORM\Column(name="id", type="integer", nullable=false)
     * @ORM\Id
     * @ORM\GeneratedValue(strategy="IDENTITY")
     */
    private $id;

    /**
     * @var string $description
     *
     * @ORM\Column(name="description", type="string", length=45, nullable=false)
     */
    private $description;

    /**
     * @var string $abbr
     *
     * @ORM\Column(name="abbr", type="string", length=5, nullable=true)
     */
    private $abbr;

    /**
     * Get id
     *
     * @return integer 
     */
    public function getId()
    {
        return $this->id;
    }

    /**
     * Set description
     *
     * @param string $description
     * @return Ethnicity
     */
    public function setDescription($description)
    {
        $this->description = $description;

        return $this;
    }

    /**
     * Get description
     *
     * @return string 
     */
    public function getDescription()
    {
        return $this->description;
    }

    /**
     * Set abbr
     *
     * @param string $abbr
     * @return Ethnicity
     */
    public function setAbbr($abbr)
    {
        $this->abbr = $abbr;

        return $this;
    }

    /**
     * Get abbr
     *
     * @return string 
     */
    public function getAbbr()
    {
        return $this->abbr;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T15:00:13.977

您的会员实体与您的种族实体有关系吗？从名称“eid”来看，您似乎正试图将 Ethnicity 类强制转换为整数字段（“eid”）。

如果没有看到这两个实体，真的很难找到任何东西。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T19:07:30.417

原来我的错误是假设集合字段需要集合验证器。相反，验证器只需要位于包含集合的实体上。在这种情况下，我真正需要做的就是在成员实体中指定验证（并删除客户端实体中的注释断言。）当我简化时，种族实体字段得到了正确处理。所以我的错误还包括 Symfony 更复杂的概念 - 并非总是如此，有时是真的！

# c# - 我是否需要在以下 c# 代码中使用锁定？

> ID：13998539
> 
> 赞同：4
> 
> 时间：2012-12-21T23:03:48.900
> 
> 标签：c#, multithreading, thread-safety

在下面的代码中，我在这个例子中使用两个线程来共享理智的资源，`queue`所以我需要使用`lock`，`en-queueing or dequeuing`如果是，那么为什么，因为程序似乎工作正常。

```
class Program
{   
    static Queue<string> sQ = new Queue<string>();

    static void Main(string[] args)
    {
        Thread prodThread = new Thread(ProduceData);
        Thread consumeThread = new Thread(ConsumeData);
        prodThread.Start();
        consumeThread.Start();
        Console.ReadLine();
    }

    private static void ProduceData()
    {
        for (int i = 0; i < 100; i++)
        {
            sQ.Enqueue(i.ToString());               
        }
    }

    private static void ConsumeData()
    {
        while (true)
        {
            if (sQ.Count > 0)
            {
                string s = sQ.Dequeue();
                Console.WriteLine("DEQUEUE::::" + s);
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T23:40:33.923

是的，你这样做，`System.Collections.Generic.Queue<T>`对于同时写入和读取来说不是线程安全的。您需要在 enquing 或 dequing 之前锁定同一个对象，或者如果您使用的是 .NET 4/4.5，请改用`System.Collections.Concurrent.ConcurrentQueue<T>`该类并使用该`TryDequeue`方法。

到目前为止，您当前的实现没有给您带来问题的原因是由于`Thread.Sleep(500)`调用（不是您应该在生产代码中使用的东西），这意味着自读取操作以来从`prodThread`队列中读取时不会写入队列`consumeThread`耗时不到 500 毫秒。如果您消除`Thread.Sleep`可能性，它会在某个时候抛出异常。

# android - 了解 Android 屏幕分辨率和密度

> ID：13998548
> 
> 赞同：0
> 
> 时间：2012-12-21T23:33:20.723
> 
> 标签：android, android-layout, screen-size

我一直在 eeepad 10" 平板电脑上开发一个应用程序。它报告的屏幕尺寸为 1280x752 和 mdpi 密度。

图像目前看起来像这样

![平板电脑截图](../Images/74b57e99a7f8bc6796620a7985deee2a.png)

我最近买了一个 Nexus 4（屏幕尺寸 1184 x 768 ，密度 xhdpi ）。我假设如果我在手机上运行该应用程序，它看起来会一样，只是更小。

我实际上得到的是：

![手机截图](../Images/f916b36a073b882a275776cb8b653b42.png)

不是我所期望的。

左侧列表视图的布局视图如下所示 -

```
 <?xml version="1.0" encoding="utf-8"?>
        <RelativeLayout  xmlns:tools="http://schemas.android.com/tools" android:orientation="horizontal"
            android:layout_width="match_parent" 
            android:layout_height="match_parent" 
            android:layout_marginRight="5dp"
            xmlns:android="http://schemas.android.com/apk/res/android">

                    <TextView android:id="@+id/tvName" 
                        android:gravity="center"
                        android:layout_width="80dp" 
                        android:layout_height="40dp" 
                        android:layout_marginLeft="10dp"
                        android:layout_marginRight="20dp"
                        android:layout_marginTop="5dp" 
                        android:text="XXX"
                        android:textSize="30sp"  
                        android:background="@drawable/rectanglesegment" 
                        android:textAppearance="?android:attr/textAppearanceMedium" />

                    <TextView android:id="@+id/tvLongName"
                        android:layout_toRightOf="@+id/tvName"
                        android:layout_width="wrap_content" 
                        android:layout_height="wrap_content" 
                        android:text="dfdfdsfdfdfdsfdsf" 
                        android:textAppearance="?android:attr/textAppearanceMedium" />

                    <TextView android:id="@+id/tvUsage" 
                        android:layout_below="@+id/tvLongName"
                        android:layout_toRightOf="@+id/tvName"
                        android:layout_height="wrap_content" 
                        android:layout_width="wrap_content"
                        android:layout_marginRight="5dp"
                        android:textColor="#ff0000"
                        android:gravity="right"
                        android:text="Required" 
                        android:textAppearance="?android:attr/textAppearanceMedium" />  

                    <TextView android:id="@+id/tvCardinality" 
                        android:layout_below="@+id/tvLongName"
                        android:layout_toRightOf="@+id/tvUsage"
                        android:layout_height="wrap_content" 
                        android:layout_width="wrap_content"
                        android:layout_alignParentRight="true" 
                        android:layout_marginRight="5dp"
                        android:layout_marginLeft="5dp"
                        android:text="(0..1)" 
                        android:textAppearance="?android:attr/textAppearanceMedium" />

        </RelativeLayout> 
```

我该怎么做才能让手机上的布局看起来更像平板电脑？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:43:55.767

[这](http://developer.android.com/training/multiscreen/screensizes.html)最好从多屏上的 android 开发人员指南中解释。专门为您的 xml 使用大小限定符。如果您使用大型 7 英寸平板电脑，则包括在内。

# android - 除非还使用旋转，否则 android alpha overridePendingTransition 不起作用

> ID：13998549
> 
> 赞同：2
> 
> 时间：2012-12-21T23:33:27.507
> 
> 标签：android, android-animation, fade, alpha, transitions

我无法自行过渡到工作。如果另一个转换同时发生，Alpha 会起作用，但它是单独进行的。
以下淡入淡出*（但如果“fromDegrees”和“toDegrees”都等于 0，则不会，这本质上就像离开 <rotation> 标签一样）*：

**淡入淡出.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@android:anim/accelerate_interpolator"
    android:duration="5000" >
    <alpha android:fromAlpha="0.0" android:toAlpha="1.0" />
    <rotate android:fromDegrees="1" android:toDegrees="0" />
</set> 
```

**淡出.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@android:anim/decelerate_interpolator"
    android:duration="5000" >
    <alpha android:fromAlpha="1.0" android:toAlpha="0.0" />
    <rotate android:fromDegrees="1" android:toDegrees="0" />
</set> 
```

但这些不起作用：

**淡入淡出.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@android:anim/accelerate_interpolator"
    android:duration="5000" >
    <alpha android:fromAlpha="0.0" android:toAlpha="1.0" />
    <!-- <rotate android:fromDegrees="1" android:toDegrees="0" /> -->
</set> 
```

**淡出.xml**

```
<?xml version="1.0" encoding="UTF-8"?>
<set xmlns:android="http://schemas.android.com/apk/res/android"
    android:interpolator="@android:anim/decelerate_interpolator"
    android:duration="5000" >
    <alpha android:fromAlpha="1.0" android:toAlpha="0.0" />
    <!-- <rotate android:fromDegrees="1" android:toDegrees="0" /> -->
</set> 
```

事实上，如果我在这个例子中不使用旋转，那么**5000**的持续时间不会持续 5 秒而是 0 秒。

**新信息：** 显然，fadeout.xml 可以省略旋转标签，但 fadein.xml 仍然需要它。

**澄清：** 如果fadein.xml 没有旋转，那么fadein 和fadeout 都不起作用。如果淡入淡出确实有旋转淡入淡出和淡出都**可以**工作。

**新信息：**如果我不使用 set，但直接使用 alpha，它仍然不起作用......我必须将旋转和 alpha 放在一个集合中。

# css - Magento Checkout 小错误

> ID：13998550
> 
> 赞同：0
> 
> 时间：2012-12-21T23:33:34.543
> 
> 标签：css, magento, checkout

我遇到了一些与 Internet Explorer 上的 magento 结帐流程设计相关的问题。当第一步正确完成并单击“继续”按钮时，第一步表单中的某些元素仍然可见，即使包含它们的 div 的样式设置为`display:none`.

我不知道为什么会发生这种情况，大家可以[看看](http://www.tapet-online.ro)吗？您需要尝试订购一些东西，然后进入结帐流程并尝试通过第一步。

该问题仅出现在 IE 8 和 9 上，因为我在此网站上限制了旧版本。

一切顺利！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T06:38:37.873

首先检查您的标签。我认为 li 标签没有正确关闭。

```
It's showing </li/> for the <li id="opc-billing" class="allow"> opening tag. 
```

这显然是错误的。

如果检查不起作用，请尝试给出样式

> 溢出：隐藏

到

```
<li> or the DIV 
```

在里面。

我认为这会奏效。

# ruby-on-rails - 如何在 Rails 中为集成测试设置 cookie？

> ID：13998551
> 
> 赞同：8
> 
> 时间：2012-12-21T23:33:39.280
> 
> 标签：ruby-on-rails, ruby-on-rails-3, cookies, integration-testing

我有根据 cookie 内容更改的一般应用程序行为，需要对其进行测试。例如，如果用户没有设置表明他们已接受网站法律条款的 cookie，则需要将他们重定向到 T&C 页面。

我可以使用在功能测试中设置 cookie

```
request.cookies["legal_accepted"] = "yes" 
```

但是，这在集成测试中不起作用——没有可使用的请求对象。我一直找不到任何文档说明为什么会这样、还有什么不同以及处理差异的最佳实践。如何为给定的请求设置 cookie？原因和原因是否记录在任何地方？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2015-03-24T10:36:01.700

在 Rails 3.2.x（当然是 3.2.16）中，您可以直接在集成测试中分配 cookie：

```
cookies['foo'] = 'bar' 
```

您现在可以在测试和应用程序中访问 c​​ookie 'foo'：

```
puts cookies['foo']  (returns 'bar') 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-22T16:34:57.430

我发现这样做的唯一方法是在请求中手动设置 cookie 标头，例如

```
get "/", {}, { "HTTP_COOKIE" => "legal_accepted=yes; cookie2=value2; "} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2018-03-31T16:54:13.153

对于 Rails 5 集成测试，metkat 的答案应该稍微改变一下：

```
get "/", headers: {"HTTP_COOKIE" => "legal_accepted=yes; cookie2=value2;"} 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2016-07-29T23:54:28.387

如果你想使用 Poltergeist，有一些我在集成测试中使用过的处理 cookie 的方法。

[https://github.com/teampoltergeist/poltergeist#manipulating-cookies](https://github.com/teampoltergeist/poltergeist#manipulating-cookies)

需要注意的一点是，如果要更新 cookie，则必须先删除 cookie，然后再设置它。

```
page.driver.remove_cookie("cookie_name")
page.driver.set_cookie("cookie_name", "some_value") 
```

# sql - 为什么我们需要 GROUP BY 和 AGGREGATE FUNCTIONS？

> ID：13998552
> 
> 赞同：26
> 
> 时间：2012-12-21T23:34:09.933
> 
> 标签：sql

我看到了一个例子，其中有一个员工列表（表格）以及他们各自的月薪。我计算了工资的总和，并在输出中看到了完全相同的表格。那很奇怪。

这是必须要做的——我们必须找出这个月我们支付了多少钱作为员工工资。为此，我们需要在数据库中汇总他们的工资金额，如下所示：

```
SELECT EmployeeID, SUM (MonthlySalary) 
FROM Employee
GROUP BY EmpID 
```

我知道如果我不在`GROUP BY`上面的代码中使用，我会得到一个错误。这是我不明白的。

我们从 Employee 表中选择 EmployeeID。`SUM()`被告知它必须从 Employee 表中添加 MonthlySalary 列。因此，它应该直接将这些数字相加，而不是将它们分组然后相加。

这就是一个人的做法——查看员工表并添加所有数字。为什么他们会不厌其烦地把它们分组然后加起来呢？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-21T23:41:43.520

如果为了解释起见，您将 GROUP BY 视为“每个人”，则可能会更容易。下面的查询：

```
SELECT empid, SUM (MonthlySalary) 
FROM Employee
GROUP BY EmpID 
```

是说：

“给我**每个**empid 的月薪总和”

因此，如果您的表格如下所示：

```
+-----+------------+
|empid|MontlySalary|
+-----+------------+
|1    |200         |
+-----+------------+
|2    |300         |
+-----+------------+ 
```

结果：

```
+-+---+
|1|200|
+-+---+
|2|300|
+-+---+ 
```

Sum 似乎不会做任何事情，因为一个数字的总和就是那个数字。另一方面，如果它看起来像这样：

```
+-----+------------+
|empid|MontlySalary|
+-----+------------+
|1    |200         |
+-----+------------+
|1    |300         |
+-----+------------+
|2    |300         |
+-----+------------+ 
```

结果：

```
+-+---+
|1|500|
+-+---+
|2|300|
+-+---+ 
```

然后是因为有两个 empid 1 相加。不确定这个解释是否有帮助，但我希望它能让事情变得更清楚一些。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-12-21T23:37:00.463

如果您想将所有数字相加，则不会有 GROUP BY：

```
 SELECT SUM(MonthlySalary) AS TotalSalary
FROM Employee 
```

```
+-----------+
|TotalSalary|
+-----------+
|777400     |
+-----------+ 
```

GROUP BY 的要点是您可以为每个员工获得单独的总数。

```
+--------+------+
|Employee|Salary|
+--------+------+
|John    |123400|
+--------+------+
|Frank   |413000|
+--------+------+
|Bill    |241000|
+--------+------+ 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-12-22T00:19:44.593

可悲的是，有一个数据库支持您建议的语法：

```
SELECT EmployeeID, SUM (MonthlySalary) 
FROM Employee 
```

然而，MySQL 并*没有*达到您的预期。它返回每个人的 MonthlySalary 的总和，以及一个任意的 EmployeeId。唉。

您的问题是关于 SQL 语法的。答案是 SQL 是这样定义的，并且不会改变。从`SELECT`子句中确定聚合字段并非不合理，但这并不是这种语言的定义方式。

不过，我确实对这个问题表示同情。许多学习 SQL 的人认为“分组”是在对行进行排序的上下文中完成的。诸如“对美国的城市进行排序并在输出中按州对它们进行分组”。说得通。但是 SQL 中的“分组依据”实际上意味着“汇总”而不是“保持在一起”。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-21T23:40:16.763

如果您不指定`GROUP BY`，聚合函数将对所有选定的记录进行操作。在这种情况下，同时选择特定列（如`EmployeeID`. 您想要每个员工的总计，在这种情况下，您选择员工 ID 和按员工分组，或者您想要整个表的总计，因此您省略了员工 ID 和`GROUP BY`子句。

在您的查询中，如果您省略`GROUP BY`，您希望它显示哪个员工 ID？

# heroku - Heroku 上的 Postgres - 间歇性错误

> ID：13998554
> 
> 赞同：3
> 
> 时间：2012-12-21T23:34:19.160
> 
> 标签：heroku

将现有的 Rails 3 应用程序迁移到 Heroku 后，我收到很多间歇性 Postgres 错误报告给 Airbrake。特别是，每隔几个小时就会出现一堆这样的错误：`ActiveRecord::StatementInvalid: PGError: ERROR: out of memory DETAIL: Failed on request of size 1375.`

错误的根源通常是一个基本的 SELECT 语句来检索应用程序主页的数据（没有太重），例如`SELECT "warnings".* FROM "warnings" WHERE (latitude::numeric != 0) ORDER BY published_at DESC LIMIT 100`

有谁知道可能导致这些错误的原因是什么？我目前使用 1 个 Web Dyno 和 1 个 Worker Dyno（每 2 分钟运行一次后台作业）和 Postgres 开发计划（少于 10,000 行）。

谢谢！

# session - 检测在 Symfony 2 中是否可以访问请求服务？

> ID：13998557
> 
> 赞同：4
> 
> 时间：2012-12-21T23:34:41.207
> 
> 标签：session, symfony, request, locale, symfony-2.1

我的服务中定义的Function`getCurrentOrDefaultLocale()`可以从控制器或通过命令行脚本调用。

从 CLI访问`request`服务会引发异常，我正在使用它来检测 CLI 调用。但是，仅为此目的捕获异常对我来说似乎很糟糕。

是否有任何可靠的方法来检查请求是否可以在当前上下文（执行，浏览器与 CLI）中访问？

```
/**
 * @return string
 */
protected function getCurrentOrDefaultLocale()
{
    try {
        $request = $this->container->get('request');
    }
    catch(InactiveScopeException $exception) {
        return $this->container->getParameter('kernel.default_locale');
    }

    // With Symfony < 2.1.0 current locale is stored in the session
    if(version_compare($this->sfVersion, '2.1.0', '<')) {
        return $this->container->get('session')->getLocale();
    }

    // Symfony >= 2.1.0 current locale from the request
    return $request->getLocale();
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T01:03:22.053

您可以使用/简单地检查当前容器实例是否具有`request`服务/范围。[`ContainerInterface::has()`](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/DependencyInjection/ContainerInterface.php#L72)[`ContainerInterface::hasScope()`](https://github.com/symfony/symfony/blob/master/src/Symfony/Component/DependencyInjection/ContainerInterface.php#L144)

### 编辑：

我的错。您必须使用[`ContainerInterface::isScopeActive()`](http://api.symfony.com/2.2/Symfony/Component/DependencyInjection/ContainerInterface.html#method_isScopeActive), 来确定`request`服务是否功能齐全：

```
public function __construct(ContainerInterface $container, RouterInterface $router) {
    if ($container->isScopeActive('request')) {
        $this->request = $container->get('request');
        $this->router = $router;
    }
} 
```

这段代码来自我自己的项目，在那里我遇到了一个非常相似的问题。

# javascript - 将参数传递给 Mocha

> ID：13998565
> 
> 赞同：1
> 
> 时间：2012-12-21T23:36:03.653
> 
> 标签：javascript, mocha.js

我以编程方式使用 Mocha，如下所述：

[https://github.com/visionmedia/mocha/wiki/Using-mocha-programmatically](https://github.com/visionmedia/mocha/wiki/Using-mocha-programmatically)

与示例的编写方式非常相似：

测试运行器.js：

```
var Mocha = require('mocha');
var mocha = new Mocha();
mocha.addFile('spec.js');
mocha.run(function() {}); 
```

在测试规范中，我正在启动一个无头浏览器以在特定 url 上运行测试：

规范.js：

```
var Browser = new Browser();
browser.visit(url, function(){}); 
```

有没有办法将所需的 url 从 test-runner.js 传递给 spec.js？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T07:35:42.863

在您的规范文件中，您可以要求一个包含这些测试配置的模块：

```
var url = require('./config.js').url;
describe("blah", function(){
    ...
}); 
```

这个配置模块也可以从最初的 mocha 测试中设置（例如）：

```
var Mocha = require('mocha');
var mocha = new Mocha();

var config = require('./config.js');
config.setOptions({url:"localhost/testme.html"});

mocha.addFile('spec.js');
mocha.run(function() {}); 
```

查看这个关于节点模块是单例的[相关 SO 。](https://stackoverflow.com/questions/5794968/in-node-js-am-i-creating-a-new-object-when-require)

# unit-testing - 如何配置vs2012只保留最新的测试结果？

> ID：13998566
> 
> 赞同：3
> 
> 时间：2012-12-21T23:36:19.573
> 
> 标签：unit-testing, visual-studio-2012, mstest

默认情况下，Visual Studio 似乎保留了所有单元测试结果。这会随着时间的推移而增加：大约 2 个月的工作需要 7GB。有没有我可以调整的配置让它只保留最后几个（比如 3 个）或最后 24 小时的测试结果？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T10:11:37.237

Go to Tools->Options->Test Tools and configure the "Limit number of Test Results" to 3

# wcf - CORS + WCF (SOAP)

> ID：13998568
> 
> 赞同：2
> 
> 时间：2012-12-21T23:36:42.553
> 
> 标签：wcf, soap, cors

我在集成 CORS 和 WCF（SOAP，而不是 REST）时遇到问题。当我从 js 发出请求时，WCF 跟踪日志中的异常是“无法读取消息正文，因为它是空的”（从逻辑上讲，与 OPTION CORS 请求有关）

身体：

```
<s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" xmlns:a="http://www.w3.org/2005/08/addressing/">
    <s:Header>
    </s:Header>
    <s:Body>
        <GetInfo xmlns="http://tempuri.org/"></GetInfo>
    </s:Body>
</s:Envelope> 
```

JS请求：

```
$.ajax({
   type: "POST",
   url: "http://localhost:8081/service_deploy/service1.svc/serviceSoap",    
   headers: { "SOAPAction": "http://tempuri.org/IService/GetInfo" },
   data: body,      
   contentType: "text/xml",   
   timeout: 10000
}); 
```

CORS 请求：

```
OPTIONS http://localhost:8081/service_deploy/service1.svc/serviceSoap
HTTP/1.1
Host: localhost:8081
User-Agent: Mozilla/5.0 (Windows NT 6.1; WOW64; rv:16.0) Gecko/20100101 Firefox/16.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Connection: keep-alive
Origin: http://localhost:49209
Access-Control-Request-Method: POST
Access-Control-Request-Headers: content-type,soapaction
Pragma: no-cache
Cache-Control: no-cache 
```

例外：

```
Type: System.ServiceModel.ProtocolException, System.ServiceModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
Mes: There is a problem with the XML that was received from the network. See inner exception for more details.
  Inner type: System.Xml.XmlException, System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
  Inner mes: The body of the message cannot be read because it is empty. 
```

堆栈跟踪：

```
System.ServiceModel.Channels.HttpChannelListener.HttpContextReceived(HttpRequestContext context, Action callback)    System.ServiceModel.Activation.HostedHttpTransportManager.HttpContextReceived(HostedHttpRequestAsyncResult result)
System.ServiceModel.Activation.HostedHttpRequestAsyncResult.HandleRequest()
System.ServiceModel.Activation.HostedHttpRequestAsyncResult.BeginRequest()
System.ServiceModel.Activation.HostedHttpRequestAsyncResult.OnBeginRequest(Object state)
System.ServiceModel.AspNetPartialTrustHelpers.PartialTrustInvoke(ContextCallback callback, Object state)
System.ServiceModel.Activation.HostedHttpRequestAsyncResult.OnBeginRequestWithFlow(Object state)
System.Runtime.IOThreadScheduler.ScheduledOverlapped.IOCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(UInt32 error, UInt32 bytesRead, NativeOverlapped* nativeOverlapped)
System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP) 
```

如何集成 CORS 和 WCF SOAP 或处理这个低级 WCF 异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T13:55:24.910

您需要在您的 servlet 容器中使用过滤器来处理 OPTIONS 请求并使用适当的标头集进行回答。

您的`web.xml`文件可能如下所示

```
[...]
<filter>
   <filter-name>CORSFilter</filter-name>
   <filter-class>my.namespace.CORSFilter</filter-class>
 </filter>
 <filter-mapping>
   <filter-name>CORSFilter</filter-name>
   <url-pattern>/*</url-pattern>
 </filter-mapping>
[...] 
```

这是一个 CORS 过滤器的例子

```
public class CORSFilter implements Filter {
  // For security reasons set this regex to an appropriate value
  // example: ".*example\\.com"
  private static final String ALLOWED_DOMAINS_REGEXP = ".*";

  public void doFilter(ServletRequest servletRequest,
      ServletResponse servletResponse, FilterChain filterChain)
      throws IOException, ServletException {

    HttpServletRequest req = (HttpServletRequest) servletRequest;
    HttpServletResponse resp = (HttpServletResponse) servletResponse;

    String origin = req.getHeader("Origin");
    if (origin != null && origin.matches(ALLOWED_DOMAINS_REGEXP)) {
      resp.addHeader("Access-Control-Allow-Origin", origin);
      if ("options".equalsIgnoreCase(req.getMethod())) {
        resp.setHeader("Allow", "GET, HEAD, POST, PUT, DELETE, TRACE, OPTIONS");
        if (origin != null) {
          String headers = req.getHeader("Access-Control-Request-Headers");
          String method = req.getHeader("Access-Control-Request-Method");
          resp.addHeader("Access-Control-Allow-Methods", method);
          resp.addHeader("Access-Control-Allow-Headers", headers);
          resp.setContentType("text/plain");
        }
        resp.getWriter().flush();
        return;
      }
    }

    // Fix the ios6 issue: caching post requests
    if ("post".equalsIgnoreCase(req.getMethod())) {
      resp.addHeader("Cache-Control", "no-cache");
    }

    if (filterChain != null) {
      filterChain.doFilter(req, resp);
    }
  }

  @Override public void destroy() {}
  @Override public void init(FilterConfig arg0) throws ServletException {}
} 
```

# windows - MinGW 创建 dll.a 文件？那些是什么类型的库文件？

> ID：13998575
> 
> 赞同：26
> 
> 时间：2012-12-21T23:37:32.580
> 
> 标签：windows, linker, mingw, static-libraries, static-linking

我对 Windows 和 Linux 库的编译相当熟悉，但至于今天，当我`MinGW`在我的 Windows 机器上看到 OpenCV 编译后的文件被抛出时`dll.a`，`.a` 我已经开始认真思考了。

这些是我`\lib`从 OpenCV 编译的输出：

```
2012-12-21  23:35         1 338 420 libopencv_core243.dll.a
2012-12-21  23:33           224 994 libopencv_core_pch_dephelp.a
2012-12-21  23:38           830 820 libopencv_features2d243.dll.a 
```

我的`\bin`输出：

```
2012-12-21  23:40           356 178 libopencv_perf_core.dll.a
2012-12-21  23:45           362 702 libopencv_perf_features2d.dll.a
2012-12-21  23:35         4 086 052 libopencv_core243.dll
2012-12-21  23:38         2 102 896 libopencv_features2d243.dll 
```

（我显然有更多的二进制文件，但在这里列出它没有意义）

有人可以告诉我这些是否是我可以链接的普通静态库吗？我应该如何链接他们？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-06-12T13:31:04.057

.a 文件是静态库。.dll.a 文件是仅帮助您链接到 dll（这是一个动态库）的文件。我的猜测是您的 dll 包含所有内容，而 dll.a 文件只是指向 dll。

# javascript - 如何修改此滑动 div 以使其实际工作？

> ID：13998577
> 
> 赞同：2
> 
> 时间：2012-12-21T23:37:51.130
> 
> 标签：javascript, html

嗨，我正在尝试合并我在这个 jfiddle 上找到的代码：http: [//jsfiddle.net/x2qk7/158/](http://jsfiddle.net/x2qk7/158/)

进入我的网站，但它不起作用。

从我的实际页面粘贴它看起来像这样：

```
<script type="text/javascript"> $(document).ready(function(){

    $('a.next').click(function(){             
        $('.slide').animate({left:-720})
    })

});​ </script>

<style>.form-slides {width:100000px;} .slide {width:300px;float:left;left:0;position:relative;}​&lt;/style>

<div class="form-slides">
    <div class="slide">
        <p>Lipsum blah blah blah</p>
        <a href="#" class="next">Next</a> 
    </div>
    <div class="slide">
        <p>Lipsum blah blah blah</p>
        <a href="#" class="next">Next</a> 
    </div>
    <div class="slide">
        <p>Lipsum blah blah blah</p>
        <a href="#" class="next">Next</a> 
    </div> </div> 
```

这似乎是准确的，但它根本不起作用。我错过了什么吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:43:51.643

1.  jQuery 加载了吗？

2.  我不知道你的目标是什么，但我认为改变`left`动画可能有助于进入第三张幻灯片

    ```
    $('a.next').click(function(){             
        $('.slide').animate({left: "-=785px"})
    }) 
    ```

    试试这个。

3.  回答@Daniel Fein[评论](https://stackoverflow.com/questions/13998577/how-can-i-modify-this-sliding-div-to-actually-work/13998615#comment19324156_13998615)：是的，有一种方法，而且很简单。用 a 包裹它`<div>`并为其添加`overflow:hidden`属性。就像[这样](http://jsfiddle.net/x2qk7/165/)

# c# - 使用代理搜索谷歌

> ID：13998579
> 
> 赞同：0
> 
> 时间：2012-12-21T23:38:57.483
> 
> 标签：c#, search, bots

我正在做一个小软件，它使用谷歌搜索在桌面软件中为人们显示结果。

用户输入关键字，搜索结果显示在列表框中。到目前为止，我对此没有任何问题。

我的实际问题是有时谷歌会阻止我的 IP 地址搜索，我必须等待一段时间才能正常搜索。

顺便说一句，虽然谷歌在软件中阻止了我的 IP 地址，但我仍然可以在网络浏览器中使用谷歌，很奇怪吧？

通常，我收到的错误消息是：

```
The remote server returned an error: (503) Server Unavailable. 
```

这是我用来搜索谷歌的方法：

```
 private string PROCESS_URL(string url)
    {
        HttpWebRequest request1 = (HttpWebRequest)WebRequest.Create(url);
        request1.UserAgent = "Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.95 Safari/537.11";
        request1.Proxy = new WebProxy("xx.xx.xx.xx:xx"); // << my proxy address : port

        HttpWebResponse response1 = (HttpWebResponse)request1.GetResponse();
        StreamReader sr1 = new StreamReader(response1.GetResponseStream(), Encoding.UTF8);
        string page_source1 = sr1.ReadToEnd();

        return page_source1;
    } 
```

知道我应该考虑什么吗？也许我需要连同请求一起发送 cookie？我错过了一些属性吗？

那么这里的想法是让谷歌认为我是人而不是机器人

# c# - 如何显示从 ASP.NET 中的数据库中获取的固定大小的图像

> ID：13998582
> 
> 赞同：0
> 
> 时间：2012-12-21T23:39:08.587
> 
> 标签：c#, asp.net, image, binary-data

数据库中的我的表包含一个类型为：图像的列。

我已经设法将图像上传到数据库。

但是几乎所有的教程都向我们展示了如何为图像控制器提供一个包含页面名称的 URL，以及一个包含数据库中所选行的 ID 的参数

例子：

```
//Database codes here... (query..etc..)
SqlDataReader myReader = myCommand.ExecuteReader();
if (myReader.HasRows == true)
{
    myReader.Read();
    Response.ContentType = "image/jpg";
    Response.BinaryWrite((byte[])myReader[0]);
    Image1.ImageUrl="User.aspx?imgid=1";
} 
```

因此，当我单击应从数据库中获取此图像的特定按钮，然后将该 URL 提供给图像时，图像会全屏打开。但我不希望这样，假设我的页面中有空白空间对于 50px 宽和 50px 高的图像，我如何在这个空间内显示图像？并保留所有其他内容？就像用户页面，个人资料页面一样。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:00:41.703

您可以使用`<img>`标签控制图像的显示。因此，假设您获取并显示图像的 ASP.NET 页面称为`ShowImage.aspx?ID=xxx`.

创建一个名为的新页面`ShowImageAt50px.aspx`，并在该页面中添加以下标记：

```
<img src="ShowImage.aspx?ID=xxx" style="width:50px;" alt="" /> 
```

现在，当您访问时`ShowImageAt50px.aspx`，它将显示限制在 50 像素宽的图像。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-21T23:43:24.260

将图像存储在文件系统中并使用图像的文件名引用数据库中的图像通常更容易且不易出错。

我从来没有遇到过将图像存储在数据库中的充分理由。

此外，当您想编辑存储在数据库中的图像时，您必须将其从数据库中导出，然后重新导入。

# c# - 如何刷新ListBox的项目？

> ID：13998587
> 
> 赞同：3
> 
> 时间：2012-12-21T23:40:09.790
> 
> 标签：c#, winforms, listbox

> **可能重复：**
> [C# 强制列表框更新元素](https://stackoverflow.com/questions/519538/c-sharp-force-listbox-to-update-elements)

让我们考虑一下这段小代码：

```
listbox.DataSource = base_items;
listbox.DisplayMember = "Name";
// ... a bit later in the program
base_items.Add(  new Base_Item("Unnamed")  ); 
```

从这一点来看，我该如何让列表框更新其项目？我看到更新的唯一方法是关闭窗口并重新加载。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-21T23:51:29.913

只需删除并再次添加数据绑定。您可以创建可在首次加载和添加新项目时使用的方法：

```
 void BindData()
    {
        listBox.DataSource = null;
        listBox.DataSource = base_items;
        listbox.DisplayMember = "Name";
    } 
```

所以这里是添加新项目和刷新列表框的代码：

```
 base_items.Add(new Base_Item("Unnamed"));
    BindData(); 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-12-21T23:54:17.297

正如 Marc G 的回答中提到的那样。

[C# 强制 ListBox 更新元素](https://stackoverflow.com/questions/519538/c-sharp-force-listbox-to-update-elements)

如果您知道列表需要刷新，只需更新`DisplayMember`列表框即可。

```
listbox.DisplayMember = "";
listbox.DisplayMember = "Name"; 
```

# c++ - 跳表如何工作？

> ID：13998591
> 
> 赞同：1
> 
> 时间：2012-12-21T23:40:35.203
> 
> 标签：c++, c, performance, latency

在以下文档的第 4-5 页中：

[http://www.open-std.org/jtc1/sc22/wg21/docs/ESC_Boston_01_304_paper.pdf](http://www.open-std.org/jtc1/sc22/wg21/docs/ESC_Boston_01_304_paper.pdf)

```
typedef int (* jumpfnct)(void * param); 
static int CaseError(void * param) 
{ 
  return -1; 
} 
static jumpfnct const jumptable[] = 
{ 
  CaseError, CaseError, ... 
  . 
  . 
  . 
  Case44,    CaseError, ... 
  . 
  . 
  . 
  CaseError, Case255 
}; 
  result = index <= 0xFF ? jumptable[index](param) : -1; 
```

它正在比较 IF-ELSE 和 SWITCH，然后介绍这个“跳转表”。显然，这是三者中最快的实现。它到底是什么？我看不出它是如何工作的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:46:57.603

jumptable 是一种将某些输入整数映射到动作的方法。它源于您可以使用输入整数作为数组的索引这一事实。

该代码设置了一个指向函数的指针数组。然后使用您的输入整数来选择这些函数指针。一般来说，它看起来像是一个指向函数的指针`CaseError`。但是，时不时地，它会被指向一个不同的功能。

它的设计是这样的

```
 jumptable[62] = Case62;
  jumptable[95] = Case95;
  jumptable[35] = Case35;
  jumptable[34] = CaseError; /* For example... and so it goes on */ 
```

因此，选择要调用的正确函数是恒定的时间......使用 if-elses 和选择，选择正确函数所花费的时间取决于输入整数......假设编译器没有将选择优化为jumptable 本身......如果它用于嵌入式代码，那么这种优化有可能被禁用......你必须检查。

一旦找到正确的函数指针，最后一行简单地调用它：

```
result = index <= 0xFF ? jumptable[index](param) : -1; 
```

变成

```
result = index <= 0xFF  /* Check that the index is within
                           the range of the jump table */

         ? jumptable[index](param) /* jumptable[index] selects a function
                                      then it gets called with (param) */

         : -1; /* If the index is out of range, set result to be -1
                  Personally, I think a better choice would be to call
                  CaseError(param) here */ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:58:26.510

Jumpfnct 是指向函数的指针。Jumptable 是一个由许多 jumpfnc 组成的数组。这些函数可以通过引用它们在数组中的位置来调用。

例如， jumptable0 将执行第一个函数，传递参数。jumptable1 将执行第二个函数，等等。

如果您不了解函数指针，则不应使用此技巧。它们非常方便，在一个狭窄的领域。

当您正在做的是在大量类似的函数调用之间切换时，它非常快速且节省空间。您正在添加 switch 语句不一定具有的函数调用开销，因此它可能不适用于所有情况。如果您的代码是这样的：

```
switch(x) {
  case 1:
    function1();
    break;
  case 2:
    function2();
    break;
...
} 
```

跳转表可能是一个很好的替代品。但是，如果您的开关是这样的：

```
switch(x) {
  case 1:
    y++;
    break;
  case 1023:
    y--;
    break;
...
} 
```

这可能不值得做。

我已经在玩具 FORTH 语言解释器中使用它们，它们在其中非常宝贵，但在大多数情况下，您不会看到使它们值得使用的速度优势。如果它使您的程序逻辑更清晰，而不是为了优化，请使用它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:45:33.950

这个跳转表通过它的索引返回一个指向函数的指针。您以这样一种方式定义此表：无效索引指向返回一些无效代码的函数（如示例中的 -1），而有效索引指向您需要调用的函数。

建造

```
jumptable[index] 
```

返回指向函数的指针并调用此函数

```
jumptable[index](param) 
```

`param`一些自定义参数在哪里。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T00:00:25.187

Jump-Table 是一种显而易见但很少使用的优化，由于某种原因似乎已经失宠。

简而言之，不是测试一个值并退出 switch/case 或 if-else 块以分支到函数或代码路径，而是创建一个数组，其中填充了程序可以分支到的函数的地址。

一旦完成，这种安排就消除了 if-else 和 switch/case 块伴随的无情的 if 测试。该代码使用否则将使用 if 测试的变量作为函数指针数组的下标，并直接继续执行适当的代码 - 没有任何 if 测试。一个完美高效的分支。汇编代码实际上应该是一个跳转。

如果您分析代码，并找到程序花费大量时间的热点，请查看这种优化以提高性能。如果它是代码热点的一部分，那么其中的一点点可能会有很长的路要走。

感谢您的链接。很好的发现！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T23:55:50.727

正如上面评论中提到的，这种解决方案是否比例如 switch 语句更有效或更不有效，取决于每种情况需要完成的工作量。

为要处理的值编写一个常规的 switch 语句肯定是一种更清晰的方式来查看代码的作用。因此，除非空间或速度要求要求更复杂的解决方案，否则我建议这不是一个“更好”的解决方案。

然而，函数指针表是解决某些问题的有效且好方法。我经常在表中使用函数指针来执行诸如“对问题进行基准测试 11 种不同的解决方案”之类的事情，其中​​我有一个带有函数名称和函数名称的结构，也许还有一些参数。然后我有一个函数来计时和循环代码几百万次（或者任何需要足够长的测量才能有意义的东西）

# vb.net - 在 Win Forms vb.net 应用程序中的全局变量类以外的表单之间共享变量数据

> ID：13998592
> 
> 赞同：1
> 
> 时间：2012-12-21T23:40:44.533
> 
> 标签：vb.net, winforms

目前在 Win Form 应用程序中，我使用一个全局变量类，其中包含用于共享数据的变量。我的问题是，还有什么其他方法可以实现这一目标？最佳实践？为什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T02:43:22.563

全局变量不好的原因有很多，但最明显的原因可能是因为，理想情况下，每次调用相同的方法，传递相同的参数时，它应该总是做相同的事情并得到相同的结果。Globals 打破了这一规则。突然间，您的代码开始以不可预知的方式运行，因为在其他地方没有正确初始化某些东西，或者某些全局变量被错误地修改了。

我发现摆脱对全局变量的需求的最佳方法是遵守依赖注入 (DI) 的原则。网上有很多关于该主题的材料，但简而言之，与其让类自行创建或查找它们的依赖项，不如简单地请求将依赖项提供给它们，通常是在构造函数中。根据定义，您通过全局变量访问的任何内容都将被视为访问它们的类的依赖项。因此，而不是，例如，有一个全局设置对象，像这样：

```
Global settings As New Settings() 
```

然后是一个像这样使用它的类：

```
Public Class MyClass
    Public Sub DoSomething()
        If settings.SomethingEnabled Then
            ' ...
        End If
    End Sub
End Class 
```

相反，你会这样做：

```
Public Class MyClass
    Public Sub New(settings As Settings)
        _settings = settings
    End Sub

    Private _settings As Settings

    Public Sub DoSomething()
        If _settings.SomethingEnabled Then
            ' ...
        End If
    End Sub
End Class 
```

这使您的代码更简洁、更灵活、更可靠。它还使代码也更具可测试性，这是一个很大的附加好处。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:59:08.577

应根据将如何使用数据来共享数据。如果整个应用程序都需要一个变量，那么它可以被视为具有全局范围，并且全局变量概念（例如公共静态共享）可能是合适的。

通常情况并非如此，因为应该真正避免使用全局变量（查看[此处](http://c2.com/cgi/wiki?GlobalVariablesAreBad)和[此处](https://stackoverflow.com/questions/484635/are-global-variables-bad)以获得更多推理）

数据应封装在所需的级别 - 例如，如果表单中包含适用于其功能的数据/变量，但其他表单现在需要该值，这将是公共只读属性的理想情况表格，它将从应用程序的其余部分掩盖变量的实际细节。

# ios - 这张图片使用了什么样的视图

> ID：13998593
> 
> 赞同：0
> 
> 时间：2012-12-21T23:41:02.333
> 
> 标签：ios, xcode, view

[![很酷的应用程序](../Images/ad4da1a8723492fd790fa60c5ddb5893.png)](https://i.stack.imgur.com/4S3S9.png)

您可以将上面的图像滚动到左侧，当您点击它们时，它会全屏打开（您可以再次全屏滚动）

我通过 json 获取图像作为链接，所以......我怎样才能制作这样的东西？一些提示/教程？

图像下方是一个表格视图，对吗？

这些只是控制器中的两个视图吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:47:47.197

您可以使用水平（[此处](http://www.cocoawithlove.com/2009/01/multiple-virtual-pages-in-uiscrollview.html)`UIScrollView`为教程）和. 所以是的，我相信 2 次观看就足够了。`UITableView`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-21T23:46:58.257

第一个是`UIScrollView`其中包含一组图像的 a。它启用了水平滚动。您可以在图像上添加点击手势以提供缩放功能。

第二个可以是`UITableView`或`UIScrollView`基于内容。这两个视图可以作为子视图添加`self.view.`

检查[raywenderlich](http://www.raywenderlich.com/tutorials)以获取有关 iOS 的教程。

# windows-8 - 如何使用 JavaScript 递归读取文件和文件夹

> ID：13998595
> 
> 赞同：1
> 
> 时间：2012-12-21T23:41:22.403
> 
> 标签：windows-8, windows-store-apps, winjs

我刚刚开始发现 Windows StoreApps（这就是微软所说的），并且我正在关注**有关**使用[FolderPicker](http://msdn.microsoft.com/en-us/library/windows/apps/windows.storage.pickers.folderpicker.aspx)的示例代码。

 **我想遍历文件夹并读取所有子文件夹和文件。

我看过两个我认为是我需要的功能，但在尝试了几个小时后我无法正确完成。

在上面的链接中，这行说：

```
WinJS.log && WinJS.log("Picked folder: " + folder.name, "sample", "status"); 
```

我试图通过以下方式深入挖掘文件夹：

```
folder.getFoldersAsync().then(function (folderItem) {
    document.getElementById('musicFolder').innerHTML += folderItem.length + " folders)<br/>";
    folderItem.forEach(function (x) {
        document.getElementById('musicFolder').innerHTML += "--" + x.name + "<br/>";
        x.getFilesAsync().then(function (items) {
            document.getElementById('musicFolder').innerHTML += items.length + " files"+"<br>";
        });
    });
}); 
```

**更新：**

我一直在努力，但在迭代文件夹和子文件夹时无法组织这些东西。

@Damir 的代码没有挖掘最深的文件夹。我们需要一个递归函数。我可以想出以下功能，但正如我所说的结果没有组织

```
function scanFolder(folder) {
    var isInc = false;
    folder.getFoldersAsync().then(function (folderItem) {
        if (folderItem.length > 0) {
            folderItem.forEach(function (x) {
                if (!isInc) {
                    isInc = true;
                    hyphen += "-";
                }
                document.getElementById('musicFolder').innerHTML += hyphen + x.name + "</br>";
                x.getFilesAsync().then(function (items) {
                    items.forEach(function (item) {
                        allTracks.push({
                            name: item.name,
                            path: item.path
                        });
                        document.getElementById('musicFolder').innerHTML += hyphen +"-"+ item.name + "</br>";
                    });
                }).done(function () {
                    scanFolder(x);
                });
            });
        }
    });
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T05:59:42.190

您想阅读所有子文件夹和其中的文件吗？像这样的东西应该工作：

```
folder.getFoldersAsync().then(function (folderItem) {
    document.getElementById('musicFolder').innerHTML += "(" + folderItem.length + " folders)<br/>";
    folderItem.forEach(function (x) {
        x.getFilesAsync().then(function (items) {
            document.getElementById('musicFolder').innerHTML += "--" + x.name + " (" + items.length + " files)<br>";
            items.forEach(function(item) {
                document.getElementById('musicFolder').innerHTML += "----" + item.name + "<br>";
            });
        });
    });
}); 
```

编辑：

实际上不需要递归来递归地扫描 WinRT 中的文件夹及其子文件夹。您可以改用[StorageFolder.CreateFileQueryWithOptions()](http://msdn.microsoft.com/en-us/library/windows/apps/br211591.aspx)：

```
var options = new Windows.Storage.Search.QueryOptions(Windows.Storage.Search.CommonFileQuery.defaultQuery, ['*']);
options.folderDepth = Windows.Storage.Search.FolderDepth.deep;
folder.createFileQueryWithOptions(options).getFilesAsync().then(function (files) {
    var paths = new Array();
    files.forEach(function(file) {
        paths.push(file.path);
    });
    paths.sort();
    paths.forEach(function(path) {
        document.getElementById('musicFolder').innerHTML += path + "<br>";
    });
}); 
```

从这里开始，您可以将文件的平面列表转换为您需要的任何内容，而不仅仅是打印出它们的路径。**

# ruby - 如何将两个添加到通过它的任何数字（Ruby）？

> ID：13998596
> 
> 赞同：-1
> 
> 时间：2012-12-21T23:41:26.187
> 
> 标签：ruby

我正在做 Ruby Monk 教程，但遇到了一个问题。这里是：

“编写一个名为 add_two 的方法，将传递给它的任何数字加 2 并返回结果。是的，除了简单地将整数 2 加到传入数字的更明显的方法之外，请随意尝试使用 next。”

我开始：

```
def add_two(number)
 number + number
end 
```

但我不知道如何解释负数

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:48:17.213

基本上他们要求你做的是使用`next`哪个是 Integer 类的方法。

[Ruby API - 整数#next](http://www.ruby-doc.org/core-1.9.3/Integer.html#method-i-next)

它应该看起来像这样

```
def add_two(number)     
  number.next.next
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:48:36.950

我想你误解了挑战。这不是“任意数加二*”* ——而是“任意数加二*”*。所以“明显”的答案是

```
def add_two(number)
  number + 2
end 
```

这适用于负数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:46:02.870

如果我把 6 传给你，你就给我 8。这就是函数应该做的。

`next`您可以在中找到有关信息[`Integer Class API`](http://www.ruby-doc.org/core-1.9.3/Integer.html#method-i-next)。

# python - 如何通过从文件中读取来构建 python 数据结构

> ID：13998597
> 
> 赞同：4
> 
> 时间：2012-12-21T23:41:27.513
> 
> 标签：python, serialization

我想通过从文本文件中读取来构建一个列表或列表列表。

例如，我有一个文件“mylist.txt”说

```
mylist = [
1,
2,
3,
4]

myotherlist = [
 [1, 3, 4, 5],
 [3, 5, 3, 6]
] 
```

我想阅读该文本文件，然后在我的 python 脚本中使用它。

那可能吗？我只是在 python 语法中使用了上面的示例。我的目标是避免自己编写解析逻辑。对于我的目的来说，XML 似乎太复杂了。

谢谢你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:52:44.210

如果我有以下数据文件（data.txt）：-

```
[1,2,3,4] 
```

然后这段代码会将它读入一个列表。

```
from ast import literal_eval

with open('data.txt') as fsock:
   mylist = literal_eval( fsock.read() ) 
```

这也适用于其他数据类型，例如字典。有关更多详细信息，请参阅[literal_eval](http://docs.python.org/2/library/ast.html#ast.literal_eval)文档。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-21T23:56:51.687

如果它是列表列表，那么您应该在 mylists.txt 文件中“直接”定义它。

例如

```
MYLISTS = [
    [1, 2, 3],
    [2, 3, 4],
    ...
] 
```

并将 mylists.txt 重命名为 mylists.py。

然后，在同一目录中使用另一个 Python 脚本，您可以这样做

```
import mylists
for sublist in mylists.MYLIST:
    for elem in sublist:
        .... 
```

这不需要您解析代码，Python“数据”文件也很容易手动编辑。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:55:29.083

如果您有 形式的东西`[1, 2, 3, 4]`，在这种情况下，您可以使用`ast`：

```
In [1]: import ast

In [2]: with open('lists.txt', 'rb') as f:
   ...:     lists = f.readlines()
   ...:     
   ...:     

In [3]: list_container = [ast.literal_eval(line.strip()) for line in lists]

In [4]: list_container
Out[4]: [[1, 2, 3], [[1, 2, 3], [4, 5, 6]]] 
```

在这种情况下，`lists.txt`看起来像这样：

```
[1, 2, 3]
[[1, 2, 3], [4, 5, 6]] 
```

但是，如果您的文件看起来与上面所说的完全一样，则可以使用`exec`，尽管应该始终谨慎使用类似`exec`and之类的东西：`eval`

```
In [2]: with open('test.txt', 'rb') as f:
   ...:     contents = f.read()
   ...:     
   ...:     

In [3]: exec(contents)

In [4]: mylist
Out[4]: [1, 2, 3, 4]

In [5]: myotherlist
Out[5]: [[1, 3, 4, 5], [3, 5, 3, 6]]

In [6]: print contents
mylist = [
1,
2,
3,
4]

myotherlist = [
 [1, 3, 4, 5],
 [3, 5, 3, 6]
] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-22T00:00:23.257

由于您似乎暗示将列表作为文本存储到文件中然后将其读回，因此草莓的`ast`示例可能是最好的。但是如果你不熟悉它，我也将[`pickle`](http://docs.python.org/2/library/pickle.html)方法扔掉，这是一个二进制序列化。它将产生更小的文件和更快的读/写时间，但代价是 Python 之外的人类可读性和可移植性。

来写：

```
import pickle # or cPickle

myList = [1, 2, 3, 4]

with open('data.txt', 'w') as f:
    pickle.dump(myList, f) 
```

读书：

```
import pickle

with open('data.txt', 'w') as f:
    myList = pickle.load(f) 
```

# axapta - AX 2009 / 2012 CS 数据库整理

> ID：13998598
> 
> 赞同：1
> 
> 时间：2012-12-21T23:41:30.947
> 
> 标签：axapta, collation, dynamics-ax-2009, dynamics-ax-2012, ax

我发现了一些不支持区分大小写的数据库排序规则的文章、帖子和线程。到 2009 年和 2012 年都不会。在 Installation-progress 中，您将面临这个，最新的。但我无法找到这种行为的具体原因。

那么 - 是什么原因，不允许 CS 排序规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T07:19:05.180

字符串比较在 X++ 中不区分大小写。在不区分大小写的编程环境中使用区分大小写的数据库确实很奇怪。

示例：可以使用货币“usd”或“USD”创建交易。不同的货币？

# java - 从 Java 调用 scala.Function.tupled()

> ID：13998599
> 
> 赞同：2
> 
> 时间：2012-12-21T23:41:36.933
> 
> 标签：java, function, scala, tuples

我想用 Java 表达以下所有 Scala 代码：

```
object TupleDemo {
  val tuple = (3, "Hello, world! ")

  /** @return str replicated x times */
  def foo(x: Int, str: String) = str * x

  val tupledFoo1 = (foo _).tupled // partially applied function

  val tupledFoo2 = Function.tupled(foo _) // desugared syntax for same partially applied function
}

object TupleDemoApp extends App {
  import TupleDemo._

  println(tupledFoo1(tuple)) // Hello, world! Hello, world! Hello, world!
  println(tupledFoo2(tuple)) // Hello, world! Hello, world! Hello, world!
} 
```

这是我能想到的 Java 等价物：

```
import scala.Function1;
import scala.Function2;
import scala.Tuple2;
import scala.collection.immutable.WrappedString;
import scala.runtime.AbstractFunction2;

public class JavaTupleDemo {
   /** @return str replicated x times */
   static final Function2<Integer, String, String> foo = new AbstractFunction2<Integer, String, String>() {
       public String apply(Integer x, String str) {
           return new WrappedString(str).$times(x);
       }

       // perhaps the types for this method are incorrect?
       public Function1<Tuple2<Integer, String>, String> tupled(Tuple2 tuple2) {
           return null; // what to write here instead of null?
       }
   };

  public static void main(String[] args) {
      // works: Invoke tupled function defined in Scala from Java using Tuple2 defined in Java
      Tuple2<Object, String> tuple = new Tuple2<Object, String>(3, "Hello, World! ");
      System.out.println(TupleDemo.tupledFoo1().apply(tuple));

      // works: Invoke regular function defined in Java from Java
      System.out.println(JavaTupleDemo.foo.apply(3, "Hello, planet! "));

      // stumped: Invoke tupled function defined in Java from Java using both the Scala and the Java Tuple2 instances
  }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T02:51:59.783

`tupled`是在`Function2`（因此也是`AbstractFunction2`）中实现的，所以这里不需要定义它——你可以这样写：

```
import scala.Function;
import scala.Function2;
import scala.Tuple2;
import scala.collection.immutable.WrappedString;
import scala.runtime.AbstractFunction2;

public class JavaTupleDemo {
  static final Function2<Integer, String, String> foo =
    new AbstractFunction2<Integer, String, String>() {
      public String apply(Integer x, String str) {
        return new WrappedString(str).$times(x);
      }
    };

  public static void main(String[] args) {
    Tuple2<Integer, String> tuple =
      new Tuple2<Integer, String>(3, "Hello, World! ");

    System.out.println(JavaTupleDemo.foo.tupled().apply(tuple));
    System.out.println(Function.tupled(JavaTupleDemo.foo).apply(tuple));
  }
} 
```

请注意，我们需要编写`foo.tupled()`，因为 Java 将其视为一种方法，并且在这两种情况下我们都会得到 a `Function1`，所以我们必须编写`.apply(tuple)`，否则这与 Scala 版本基本相同。

* * *

为了解决您关于将`Integer`元组中的`Object`:`Integer`

```
Tuple2<Object, String> scalaTuple = TupleDemo.tuple();

Tuple2<Integer, String> tuple = new Tuple2<Integer, String>(
  (Integer) scalaTuple._1(),
  scalaTuple._2()
); 
```

即，只需将元组拆开，投射`Integer`，然后将其重新组合在一起。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T21:13:28.513

Travis Brown 的答案的问题在于他没有包含所有代码。这是完整的代码，无法编译。

```
import scala.Function;
import scala.Function2;
import scala.Tuple2;
import scala.collection.immutable.WrappedString;
import scala.runtime.AbstractFunction2;

public class JavaTupleDemo {
   /** tupled() is implemented in Function2 (and therefore in AbstractFunction2)
    * @return str replicated x times */
   static final Function2<Integer, String, String> foo = new AbstractFunction2<Integer, String, String>() {
       public String apply(Integer x, String str) {
           return new WrappedString(str).$times(x);
       }
   };

  public static void main(String[] args) {
      // Invoke tupled function defined in Scala from Java using Tuple2 defined in Java
      Tuple2<Object, String> tuple = new Tuple2<Object, String>(3, "Hello, World! ");
      System.out.println(TupleDemo.tupledFoo1().apply(tuple));

      // Invoke regular function defined in Java from Java
      System.out.println(JavaTupleDemo.foo.apply(3, "Hello, planet! "));

      // Invoke tupled function defined in Java from Java using both the Scala and the Java Tuple2 instances
      System.out.println(JavaTupleDemo.foo.tupled().apply(tuple));
      System.out.println(Function.tupled(JavaTupleDemo.foo).apply(tuple));
  }
} 
```

错误消息是：

```
error: method apply in interface Function1<T1,R> cannot be applied to given types;
required: Tuple2<Integer,String>
found: Tuple2<Object,String>
reason: actual argument Tuple2<Object,String> cannot be converted to Tuple2<Integer,String> by method invocation conversion
where T1,R are type-variables:
T1 extends Object declared in interface Function1
R extends Object declared in interface Function1 
```

您不能简单地将元组转换为 Tuple2<Integer, String>。如果您尝试以下操作：

```
System.out.println(JavaTupleDemo.foo.tupled().apply((Tuple2<Integer, String>)tuple));
System.out.println(Function.tupled(JavaTupleDemo.foo).apply((Tuple2<Integer, String>)tuple)); 
```

错误信息是：

```
error: inconvertible types
required: Tuple2<Integer,String>
found:    Tuple2<Object,String> 
```

进行此编译的唯一方法是做一些非常讨厌的事情 - 首先将元组转换为 Object，然后转换为 Tuple2<Integer, String>：

```
System.out.println(JavaTupleDemo.foo.tupled().apply((Tuple2<Integer, String>)((Object)javaTuple)));
System.out.println(Function.tupled(JavaTupleDemo.foo).apply((Tuple2<Integer, String>)((Object)javaTuple))); 
```

有一个更好的方法吗？

# c# - 将委托指向类中的方法

> ID：13998604
> 
> 赞同：-1
> 
> 时间：2012-12-21T23:42:28.957
> 
> 标签：c#, delegates

我正在尝试将委托分配给属于另一个类对象的方法。

```
TestingClass testObj = new TestingClass();
Delegate myDelegate = testObj.testMethod;   //syntax error 
```

我的意图是`myDelegate`指出`testMethod`. `testObj`上面的代码有语法错误。

在 C# 中执行此操作的正确语法是什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:45:03.880

您应该将其分配给具有兼容委托类型的变量，例如

```
Action myDelegate = testObj.testMethod; 
```

委托类型取决于`testMethod`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:49:30.343

如果你真的打算使用委托——这对于创建一个命名良好的类型很方便——定义你自己的一个：

```
class Program
{
    delegate void D1();

    static void Main(string[] args)
    {
        var testObj = new Program();
        D1 myDelegate = testObj.TestMethod;
        myDelegate.Invoke();
    }

    void TestMethod()
    {
        Console.WriteLine("Foo!");
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:44:51.063

看看 Jon Skeets 教程，了解如何使用和创建委托，它简单易懂地理解[委托和事件](http://csharpindepth.com/Articles/Chapter2/Events.aspx)

这是一个简单的示例，并根据我为您编写的示例说明了如何使用它

```
//Define a delegate here in your Class
public delegate void MyMessageHandler(string message); 
```

然后你可以像这样使用它：

```
public void DoWork(MyMessageHandler callback)
{
    string message = "";
    ....
    callback(message);
} 
```

然后你这样称呼它：

```
public Main()
{
    DoWork(ProcessMessages);
}
public void ProcessMessages(string message)
{
    ....
} 
```

# python - 基于 Python Web 框架中的 Accept 标头路由请求

> ID：13998607
> 
> 赞同：3
> 
> 时间：2012-12-21T23:42:43.653
> 
> 标签：python, django, flask, pyramid, cherrypy

我对不同的 Web 框架（Django、web.py、Pyramid 和 CherryPy）有一些经验，我想知道在哪个框架中更容易并且希望更清洁地实现路由调度程序到不同的“视图/处理程序”基于“接受”标头和 HTTP 方法，例如：

```
Accept: application/json
POST /post/ 
```

处理方式不同于：

```
Accept: text/html
POST /post/ 
```

因此，请求被路由到 MIME“application/json”和 HTTP 方法“POST”的相应处理程序的特定视图。

我确实知道如何在 CherryPy 中实现类似的东西，但是我失去了使用 CherryPy 工具来进行请求的内部重定向，因为我直接调用特定方法而不是从调度程序自动调用。另一种选择是从头开始实现一个全新的调度程序，但这是最后一个选择。

我知道在 url 中使用扩展名的替代方法，例如`/post.json`or `/post/.json`，但我希望保持相同的 url？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-22T15:00:27.330

如果您正在寻找的只是*一个*可以轻松完成此任务的框架，那么请使用[`pyramid`](http://www.pylonsproject.org/projects/pyramid/about).

Pyramid 视图定义由[predicates](http://docs.pylonsproject.org/projects/pyramid/en/1.3-branch/narr/viewconfig.html#view-configuration-parameters)组成，而不仅仅是路由，并且仅当所有谓词都匹配时，视图才匹配。一个这样的谓词是`accept`谓词，它完全符合您的要求。根据`Accept`标题轻松切换视图：

```
from pyramid.view import view_config

@view_config(route_name='some_api_name', request_method='POST', accept='application/json')
def handle_someapi_json(request):
    # return JSON

@view_config(route_name='some_api_name', request_method='POST', accept='text/html')
def handle_someapi_html(request):
    # return HTML 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-15T04:37:46.510

我需要在 Django 中执行此操作，因此我编写了一个中间件以使其成为可能：[http ://baltaks.com/2013/01/route-requests-based-on-the-http-accept-header-in -django](http://baltaks.com/2013/01/route-requests-based-on-the-http-accept-header-in-django)

这是代码：

```
# A simple middleware component that lets you use a single Django
# instance to serve multiple versions of your app, chosen by the client
# using the HTTP Accept header.
# In your settings.py, map a value you're looking for in the Accept header
# to a urls.py file.
# HTTP_HEADER_ROUTING_MIDDLEWARE_URLCONF_MAP = {
#     u'application/vnd.api-name.v1': 'app.urls_v1'
# }

from django.conf import settings

class HTTPHeaderRoutingMiddleware:

    def process_request(self, request):
        try:
            for content_type in settings.HTTP_HEADER_ROUTING_MIDDLEWARE_URLCONF_MAP:
                if (request.META['HTTP_ACCEPT'].find(content_type) != -1):
                    request.urlconf = settings.HTTP_HEADER_ROUTING_MIDDLEWARE_URLCONF_MAP[content_type]
        except KeyError:
            pass # use default urlconf (settings.ROOT_URLCONF)

    def process_response(self, request, response):
        return response 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:19:23.410

我不确定您所说的“内部重定向”是什么意思，但是如果您查看[代码](https://bitbucket.org/cherrypy/cherrypy/src/a2c05b87434edd49fe0b6d8ed06943245c99a3a6/cherrypy/_cptools.py?at=default#cl-502)，您会发现 tools.accept 是一个非常薄的[lib.cptools.accept](http://docs.cherrypy.org/dev/refman/lib/cptools.html#cherrypy.lib.cptools.accept)包装器，您可以轻松地从自己的代码中调用它. 将您的服务器可以发送的 Content-Types 列表交给它，它会告诉您客户端更喜欢哪一个，或者如果您发出的类型和客户端接受的类型不重叠，则引发 406。

# php - createLookAtLH-变换

> ID：13998609
> 
> 赞同：-2
> 
> 时间：2012-12-21T23:43:11.573
> 
> 标签：php, matrix, 3d, linear-algebra

我仍在学习使用线性代数和矩阵。所以请尽量避免使用技术术语：D

我创建了这个“createLookAtLH”函数：

```
 function createLookAtLH($cameraPosition, $cameraTarget, $cameraUpVector)
  {
    $zAxis = normalized3(array(
      $cameraPosition[0] - $cameraTarget[0],
      $cameraPosition[1] - $cameraTarget[1],
      $cameraPosition[2] - $cameraTarget[2]
    ));
    $xAxis = cross(normalized3($cameraUpVector), $zAxis);
    $yAxis = cross($zAxis, $xAxis);
    return inverseMatrix(array(
      $xAxis[0], $yAxis[0], $zAxis[0], 0,
      $xAxis[1], $yAxis[1], $zAxis[1], 0,
      $xAxis[2], $yAxis[2], $zAxis[2], 0,
      $cameraPosition[0], $cameraPosition[1], $cameraPosition[2], 1
    ));
  } 
```

normalized3，cross 和 inverseMatrix 工作没有问题（通过几个测试检查）

现在我正在创建矩阵并用一个小例子进行测试

```
 $view = createLookAtLH(array(-10,0,0), array(0,0,0), array(0,0,-1));
  $v = array(0, 1, 1, 0);
  $v = doSomething($view, $v);
  print_r($v); 
```

“doSomething”函数（不知道如何调用此操作）如下：

```
 function doSomething($matrix, $vector)
  {
    return array(
      ($matrix[00] * $vector[0]) + ($matrix[01] * $vector[1]) + ($matrix[02] * $vector[2]) + ($matrix[03] * $vector[3]),
      ($matrix[04] * $vector[0]) + ($matrix[05] * $vector[1]) + ($matrix[06] * $vector[2]) + ($matrix[07] * $vector[3]),
      ($matrix[08] * $vector[0]) + ($matrix[09] * $vector[1]) + ($matrix[10] * $vector[2]) + ($matrix[11] * $vector[3]),
      ($matrix[12] * $vector[0]) + ($matrix[13] * $vector[1]) + ($matrix[14] * $vector[2]) + ($matrix[15] * $vector[3])
    );
  } 
```

这是我得到的预期结果： Array ( [0] => 1 [1] => -1 [2] => 0 [3] => 10 )

但现在当我尝试使用

```
$v = array(100, 1, 1, 0); 
```

然后结果不会改变。不应该是 (1, -1, 100, ...) 吗？还是我想错了什么？

任何答案都会让我开心=）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T19:35:08.757

您正在使用[齐次坐标](http://en.wikipedia.org/wiki/Transformation_matrix#Other_kinds_of_transformations)。点通常具有以下形式`(X, Y, Z, 1)`（尽管坐标还有其他用途`W`）。由于 cameraPosition 导致的平移应该在列中：`[0][3], [1][3], [2][3]`，仅通过设置应用`W = 1`。

# python - 有没有办法在 python 中调用左键？

> ID：13998610
> 
> 赞同：1
> 
> 时间：2012-12-21T23:43:12.687
> 
> 标签：python, windows, automation, mouse, ctypes

我只有python 2.6。我可以在不使用外部库的情况下做到这一点吗？我只想在光标当前所在的任何位置执行左键单击。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:02:58.893

好的，首先你必须知道如何打开 user32 windll `ctypes`，这是[微不足道](http://docs.python.org/2/library/ctypes.html#loading-dynamic-link-libraries)的：

```
from ctypes import *
user32 = windll.user32 
```

接下来，您要调用的 Win32 函数可能是[SendInput](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646310%28v=vs.85%29.aspx)，尽管您可能希望查看`mouse_event`并可能`SendMessage`（以及 WM_* 消息对应于鼠标单击的文档）进行比较和对比。

假设您使用`SendInput`，您将先发送一个，`MOUSEEVENTF_LEFTDOWN`然后发送一个`MOUSEEVENTF_LEFTUP`，除 0 之外的所有参数都为 0 `dwFlags`。

那么，你怎么称呼这个？好吧，这是 C API：

```
UINT WINAPI SendInput(
  _In_  UINT nInputs,
  _In_  LPINPUT pInputs,
  _In_  int cbSize
); 
```

这`LPINPUT`意味着你有一个指向[`INPUT`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646270%28v=vs.85%29.aspx)结构数组的指针。由于`INPUT`结构本身具有、 和的联合`MOUSEINPUT`，因此您还需要定义它们（尽管您可以只定义第一个并假装其他不存在，因为第一个是您唯一需要的） .`KBDINPUT``HARDWAREINPUT`

因此，执行此操作的步骤`ctypes`是：

*   定义[`Structure`](http://docs.python.org/2/library/ctypes.html#structures-and-unions)s[`MOUSEINPUT`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646273%28v=vs.85%29.aspx)和[`INPUT`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646270%28v=vs.85%29.aspx)。
*   加载`user32`windll。
*   设置[`argtypes`](http://docs.python.org/2/library/ctypes.html#specifying-the-required-argument-types-function-prototypes)为`user32.SendInput`.
*   创建您的第一个`MOUSEINPUT`实例，使用`dwFlags= MOUSEEVENTF_LEFTDOWN`，以及与之配套的`INPUT`实例。
*   呼叫`user32.SendInput(1, [myinput], len(INPUT))`或`user32.SendInput(1, addressof(myinput), len(INPUT))`其他（取决于您如何定义`argtypes`）。
*   创建您的第二个`MOUSEINPUT`实例，使用`dwFlags= MOUSEEVENTF_LEFT`，以及与之配套的`INPUT`实例。
*   再打电话`user32.SendInput()`。

最后一点：在 Vista 及更高版本上，您必须具有正确的“完整性级别”才能执行此操作。例如，普通应用程序无法将点击发送到“提升的”应用程序（例如，安装程序）。希望这对您来说不是问题。如果是这样，您需要阅读 UIPI 和 UAC……如果最坏的情况发生，您可能需要退回到较低级别的技巧。

这是否足够，或者您需要帮助解决其中的某些特定部分吗？

# python - 列表中字典中的 Python 列表 - 引用不带整数（字符串？）

> ID：13998612
> 
> 赞同：0
> 
> 时间：2012-12-21T23:43:19.237
> 
> 标签：python, python-3.x, python-2.7

这个问题问题来自代码学院。我想出了一个解决方案，虽然不是很满意，因为我认为我在以编程方式作弊以使代码工作。有没有其他方法可以解决这个问题。我见过更难的代码。这是相当直截了当的。

三个有四个键的学生词典。其中三个键是列表。计算平均值的函数 计算字母等级的函数 计算每个孩子的平均值的函数

好吧，调用每个孩子函数的平均值来计算平均值就像所有函数一样工作正常。

但是，如果创建一个新列表以包含所有 3 个学生 --- 即生成学生列表，其中包含 3 个列表项。每个项目都有一个字典，有四个键。四个键中的三个是列表。呸！！！

我在 getClassAverage 函数中使用了一个带有计数器和增量的 for 循环来计算平均值。

问题：

*   是否有另一种方法来计算平均值而无需 for 循环，即仅在函数内，因为仅使用“谁”传递的参数使其具有学生（数据）并且不能很好地引用列表。给出字符串索引，而不是整数”错误？

*   列表内键，列表内。如何从 getClassAverage 函数打印学生姓名？

谢谢！

```
Lloyd = {
    "name":"Lloyd",
    "homework": [90,97,75,92],
    "quizzes": [ 88,40,94],
    "tests": [ 75,90]
    }
Alice = {
    "name":"Alice",
    "homework": [100,92,98,100],
    "quizzes": [82,83,91],
    "tests": [89,97]
    }
Tyler = {
    "name":"Tyler",
    "homework": [0,87,75,22],
    "quizzes": [0,75,78],
    "tests": [100,100]
    }

def average(stuff):
    return sum(stuff)/len(stuff)

def getLetterGrade(score):
    score = round(score)
    if  score >= 90: return "A"
    elif  90 > score >= 80: return "B"
    elif  80 > score >= 70: return "C"
    elif  70 > score >= 60: return "D"
    elif  60 > score: return "F"

def getAverage(kid):
    bar = average
    return bar(kid["homework"])*.1 + bar(kid["quizzes"])*.3 + bar(kid["tests"])*.6

students = [Lloyd,Alice,Tyler]

def getClassAverage(who):
    class_ave = 0
    class_avetot = 0
    count = 0
    for x in who:
        class_avetot = class_avetot + getAverage(who[count])
        #print who[count]
        stu_score = getAverage(who[count])
        print stu_score
        print getLetterGrade(stu_score)
        count = count + 1
    class_ave = class_avetot / len(who)
    return class_ave

print str(getClassAverage(students)) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-25T21:34:37.490

使用您已有的代码和功能，试试这个：

```
def getClassAverage (who):
    return average ( [getAverage (kid) for kid in who] ) 
```

你的代码很好。我将发布我可能会如何实现这一点，以便为您提供另一点，而不是说我的版本更好或更好：

```
#! /usr/bin/python3.2

def ave (x): return sum (x) / len (x)

def getLetterGrade (score):
    score = round (score)
    if score >= 90: return 'A'
    if score >= 80: return 'B'
    if score >= 70: return 'C'
    if score >= 60: return 'D'
    #Why no grade E?
    return 'F'

class Student:
    def __init__ (self, name, homework, quizzes, tests):
        self.name = name
        self.homework = homework
        self.quizzes = quizzes
        self.tests = tests

    @property
    def average (self):
        return ave (self.homework) * .1 + ave (self.quizzes) * .3 + ave (self.tests) * .6

    def printAverage (self):
        print ('{} has an average of {:.2f} ({})'.format (self.name, self.average, getLetterGrade (self.average) ) )

class Class:
    def __init__ (self, students):
        self.students = students

    @property
    def average (self):
        return ave ( [student.average for student in self.students] )

    def printStudents (self):
        for student in students:
            student.printAverage ()

    def printAverage (self):
        print ('The class has an average of {:.2f}'.format (self.average) )

students = [Student ('Lloyd', [90,97,75,92], [88,40,94], [75,90] ),
    Student ('Alice', [100,92,98,100], [82,83,91], [89,97] ),
    Student ('Tyler', [0,87,75,22], [0,75,78], [100,100] ) ]

myClass = Class (students)
myClass.printStudents ()
myClass.printAverage () 
```

（inb4 PEP8，我知道，我看过，我选择忽略它。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T02:26:02.427

为了估计平均值，numpy 有一个可以使用的函数。

```
from numpy import average 
```

在 getClassAverage 函数中，您将传递一个包含学生姓名的列表。所以如果你这样做：

```
for x in who:
        print x  # This prints the name of the student
        class_avetot = class_avetot + getAverage(who[count]) 
```

当您估计他的平均成绩以添加到班级平均水平时，它将打印学生的姓名。

希望有帮助。

# javascript - Javascript ReferenceError：左侧分配无效

> ID：13998619
> 
> 赞同：0
> 
> 时间：2012-12-21T23:44:02.933
> 
> 标签：javascript, referenceerror

我的 JavaScript 代码：

```
$(function(){
    function replace(code){
            var textbox = $("textbox[name=textbox]");

            var len = $(textbox).val().length;
            var start = $(textbox)[0].selectionStart;
            var end = $(textbox)[0].selectionEnd;

            var sel = $(textbox).val().substring(start, end);

            var replace = '['+code+']' + sel + '[/'+code+']';

            $(textbox).val($(textbox).val().substring(0,start)
                 + replace + $(textbox).val().substring(end,len);
            );
    }
}); 
```

这个萤火虫错误：

**ReferenceError: 无效赋值左侧 $(textbox).val() = $(textbox).val().substring(0,start) + replace +**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-21T23:46:20.967

在：

```
$(textbox).val($(textbox).val().substring(0,start) + replace +
        $(textbox).val().substring(end,len); //<-- here
        ); 
```

你有一个分号。删除那个分号。

# c# - 匿名委托事件侦听器会阻止垃圾收集吗？

> ID：13998621
> 
> 赞同：2
> 
> 时间：2012-12-21T23:44:16.473
> 
> 标签：c#, silverlight, garbage-collection, anonymous-delegates

我不确定在以下情况下是否能够对子窗口进行垃圾收集。

1.  用户控件包含“显示弹出”命令
2.  该命令创建一个子窗口，并为“Closed”事件添加一个匿名侦听器。

* * *

```
public partial class MainPage : UserControl
{
    public ICommand PopupCommand { get; private set; }

    public MainPage()
    {
        InitializeComponent();

        PopupCommand = new DelegateCommand(arg => 
        {
            var child = new ChildWindow();
            child.Closed += (sender, args) =>
            {
                MessageBox.Show("You closed the window!");
            };
            child.Show();
        });
    }
} 
```

由于`PopupCommand`的委托表面上仍然包含对局部`child`变量的引用，因此每次调用都会`PopupCommand`泄漏内存吗？或者垃圾收集器会以某种方式认识到它可以`child`在关闭后处理吗？

* * *

**相关：[从 C# 中的事件和垃圾收集中分离匿名侦听器](https://stackoverflow.com/q/9591195/1001985)**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:05:42.023

以下测试表明，不，该方案不会导致内存泄漏。

```
public partial class LeakTest : UserControl
{
    public ICommand PopupCommand { get; private set; }

    public LeakTest()
    {
        InitializeComponent();

        PopupCommand = new DelegateCommand(arg =>
        {
            var child = new ChildWindow();
            child.Closed += (sender, args) =>
            {
                System.Diagnostics.Debug.WriteLine("Closed window");
            };

            // when the window has loaded, close it and re-trigger the command
            child.Loaded += (sender, args) =>
            {
                child.Close();
                PopupCommand.Execute(null);
            };
            child.Show();
        });
    }
} 
```

原因在[Jwosty 链接到的（Winforms）帖子](https://stackoverflow.com/q/9591195/1001985)的答案中提出：

> 在您的示例中，发布者仅存在于您的私有方法的范围内，因此对话框和处理程序都将在方法返回后的某个时间点被垃圾收集。

换句话说，内存泄漏问题实际上是相反的——事件发布者（`ChildWindow`控件）持有对订阅者（the `DelegateCommand`）的引用，但不是相反。因此，一旦`ChildWindow`关闭，垃圾收集器将释放其内存。

# android - Android - 平板电脑到手机的屏幕尺寸

> ID：13998625
> 
> 赞同：0
> 
> 时间：2012-12-21T23:44:42.797
> 
> 标签：android, android-layout, android-ui

我有一个具有这样屏幕的应用程序（在 10 英寸平板电脑上）：

![在此处输入图像描述](../Images/7f8e4f71f6c8dafb3baeb8fc7d637055.png)

现在我需要修改该应用程序以使其也可以在手机上运行。由于屏幕会更小，我想采用“拆分视图” UI 并对其进行更改，以便单独显示左侧列表视图，然后在选择一行时显示适当的右侧列表视图。

我如何在应用程序中处理这个问题，因为一个活动当前处理两个列表视图，我猜手机每个列表视图都需要两个。

我如何检测要执行哪一个？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:47:45.590

您应该查看 MasterDetailedFlow 导航模板。Eclipse:NewProject>检查创建活动>选择“MasterDetailedFlow”导航类型。看看Android上的[数据绑定](https://stackoverflow.com/questions/6007941/android-data-binding-similar-to-wpf)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:57:29.667

请参阅[支持不同的屏幕尺寸](http://developer.android.com/training/multiscreen/screensizes.html#TaskUseSWQuali)。

通常这是使用 Fragments 完成的，但无论您是否使用 Fragment，基本思想都是相同的。您可以根据屏幕大小为 Activity 创建两种不同的布局。

*   将手机的默认布局单窗格保存在`res/layout/activity_main.xml`
*   将双窗格平板电脑布局保存在`res/layout/activity_main_twopane.xml`

然后，您使用具有链接中描述的屏幕尺寸限定符的布局别名文件来确定何时应使用平板电脑布局。例如，要在`large`屏幕和最宽方向至少 600dp 的屏幕上显示双窗格布局（包括 Galaxy S3 等大屏幕手机），您可以这样做：

*   `res/values-large/layout.xml`包含：

    ```
    <resources>
        <item name="activity_main" type="layout">@layout/activity_main_twopane</item>
        <bool name="twopane">true</bool>
    </resources> 
    ```

*   `res/values-sw600dp/layout.xml`包含：

    ```
    <resources>
        <item name="activity_main" type="layout">@layout/activity_main_twopane</item>
        <bool name="twopane">true</bool>
    </resources> 
    ```

当您的 Activity 加载布局时，Android 系统将负责加载正确的布局文件（或`res/layout/activity_main.xml`或）：`res/layout/activity_main_twopane.xml`

```
setContentView(R.layout.activity_main); 
```

请记住，当您尝试访问它们时，单窗格布局中不存在的视图将为空（例如，不再有两个`ListView`s）。检查某个 View 是否存在是检测您正在使用的布局的一种方法。

还要注意在 XML 文件中使用可选的[布尔资源](http://developer.android.com/guide/topics/resources/more-resources.html#Bool)。这是将“是大屏幕还是小屏幕”变量传递给 Java 代码的便捷方式。您可以像这样在 Activity 中访问布尔资源：

```
boolean isTwoPane = getResources().getBoolean(R.bool.twopane); 
```

# c++ - printf 导致崩溃

> ID：13998626
> 
> 赞同：-3
> 
> 时间：2012-12-21T23:44:48.727
> 
> 标签：c++, c, printf

```
#include <stdio.h>
int main(char sendbuf[100]) 
{
  printf (sendbuf);
  return 0;
} 
```

当我尝试使用它时，这个非常基本的程序会以某种方式崩溃，它意味着打印出作为参数输入的任何内容。如果我删除“printf (sendbuf);”行 崩溃消失了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:47:47.230

第一个参数`main`是参数的数量。第二个参数是一个字符串数组。第二个参数的第一个元素（索引 0）是程序的名称：

```
#include <stdio.h>
int main(int c, char **argv) 
{
  printf ("%s\n", c > 1 ? argv[1] : "No Argument");
  return 0;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:46:29.613

您的第一个参数必须是整数，而不是 char 数组。这是正确的程序：

```
#include <stdio.h>
int main(int argc, char* argv[]) 
{
    if (argc > 1) {
        printf( argv[1] );
    }
    else { 
        printf( "No arguments provided" );
    }
    return 0;
} 
```

argv[0] 是您的程序名称，因此 argv[1] 是命令行中提供的第一个参数。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:46:42.500

C 支持两种形式的 main 函数：

```
int main() { /* ... */ }
and
int main(int argc, char* argv[]) { /* ... */ } 
```

要从 main 中获取参数，您需要将代码更改为：

```
#include <stdio.h>
int main(int argc, char* argv[]) 
{    
  if (argc > 1){
    printf ("%s\n", argv[0]);
  }
  return 0;
} 
```

或使用流：

```
#include <iostream>
int main(int argc, char* argv[]) 
{    
   if (argc > 1){
     std::cout << argv[0]) << std::endl;
   }
   return 0;
} 
```

argv[0] 是应用程序名称，输入参数从 argv[1] 开始（如果有）。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T23:48:24.177

实现必须支持以下两个定义`main`：

```
int main() { }
int main(int argc, char* argv[]) { } 
```

它们是否支持任何其他定义是实现定义的。我不知道任何允许的实现`int main(char*)`（这就是你的等价物）。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T23:54:49.363

这将在程序名称之后打印您在命令行上键入的所有内容，即使带有空格。如果您在程序名称后不输入任何内容，它不会崩溃。

```
#include <stdio.h>
int main(int argc, char **argv) 
{
    for(int i=1; i<=argc; ++i) { 
        printf("%s\n", argv[i]);
    }
} 
```

# octave - 如何在 OSX 10.6.8 上以八度打开 .m 文件

> ID：13998630
> 
> 赞同：3
> 
> 时间：2012-12-21T23:45:17.290
> 
> 标签：octave, osx-leopard

这个文件 ex1.m，我用八度“打开”，但它什么也没做。前几行代码是....

```
%% Machine Learning Online Class - Exercise 1: Linear Regression

%  Instructions
%  ------------
% 
%  This file contains code that helps you get started on the
%  linear exercise. You will need to complete the following functions 
%  in this exericse:
%
%     warmUpExercise.m
%     plotData.m
%     gradientDescent.m
%     computeCost.m
%     gradientDescentMulti.m
%     computeCostMulti.m
%     featureNormalize.m
%     normalEqn.m
%
%  For this exercise, you will not need to change any code in this file,
%  or any other files other than those mentioned above.
%
% x refers to the population size in 10,000s
% y refers to the profit in $10,000s
%

%% Initialization
clear ; close all; clc

%% ==================== Part 1: Basic Function ====================
% Complete warmUpExercise.m 
fprintf('Running warmUpExercise ... \n');
fprintf('5x5 Identity Matrix: \n');
warmUpExercise()

fprintf('Program paused. Press enter to continue.\n');
pause; 
```

等等......还有更多文件，我不知道如何让它运行......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-24T00:53:50.650

这看起来像是 www.coursera.org 提供的 Andrew Ng 在线机器学习课程的一部分 在尝试自己学习教程之后，您可能会更幸运地在课程网站的论坛中提出这些问题。

您需要首先在目录中拥有所有相关文件。然后实际完成任务。在您完成代码部分之前，这些分配中的大多数都不会执行任何操作。

**该文件包含帮助您开始线性练习的代码。您将需要在本练习中完成以下功能：**

```
 warmUpExercise.m
 plotData.m
 gradientDescent.m
 computeCost.m
 gradientDescentMulti.m
 computeCostMulti.m
 featureNormalize.m
 normalEqn.m 
```

完成后，打开一个mac终端并cd到所在目录`ex1.m`。您可以通过启动`octave`并输入**不带**扩展`.m`名的文件名来运行程序。键入`ex1`。或者，`octave -q ex1.m`如果您不想在程序运行完成后进入 octave shell，您可以从终端键入。

# ios - 为左右按钮设置自定义 UINavigationBar 图像

> ID：13998631
> 
> 赞同：3
> 
> 时间：2012-12-21T23:45:18.270
> 
> 标签：ios, image, cocoa-touch, button, uinavigationbar

这是我的故事板上的内容：
![在此处输入图像描述](../Images/e3a9e29d89e3651c08aeeddd264e3fef.png)

我想改变两个按钮的图像。我有一个 13x46 的图像，但我在使用它作为按钮的图像时遇到了问题。我四处寻找一些代码，但我对它们不是很成功。
有任何想法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-21T23:49:31.023

这是非常简单的东西，只需 alloc/initWithImage 几个条形按钮项，然后应用它们。

```
UIBarButtonItem *leftItem = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"myImage"] style:UIBarButtonItemStyleBordered target:self action:@selector(someMethod)];
UIBarButtonItem *rightItem = [[UIBarButtonItem alloc] initWithImage:[UIImage imageNamed:@"myImage"] style:UIBarButtonItemStyleBordered target:self action:@selector(someMethod)];

[[self navigationItem] setLeftBarButtonItem:leftItem];
[[self navigationItem] setRightBarButtonItem:rightItem]; 
```

这当然假设您实际上正在使用导航控制器。如果您只是在界面构建器中拖放了一个导航栏，那么您需要为导航栏创建一个 IBOutlet，将其链接起来，然后使用如下内容：

```
UINavigationItem *item = [[UINavigationItem alloc] initWithTitle:@"Title"];
[item setRightBarButtonItem:rightItem];
[myNavBar pushNavigationItem:item animated:NO]; 
```

您可能需要在两者之间添加一个灵活的空间。

# spotify - Spotify 应用程序无法加载

> ID：13998639
> 
> 赞同：0
> 
> 时间：2012-12-21T23:46:30.473
> 
> 标签：spotify

我已经通过 SO 进行了广泛的研究，但是尽管尝试了几乎所有的建议，但还没有找到任何关于这个问题的帮助。

[https://github.com/danwaz/powerhour](https://github.com/danwaz/powerhour)

试图在 Spotify 上安装这个应用程序。我确实有一个开发者帐户，并且在 ~/documents/Spotify 中创建了必要的目录

无论出于何种原因，当我尝试根据清单详细说明捆绑包的方式加载应用程序时，都会显示一个加载栏。我确实收到了“元数据启动”消息，但没有加载任何内容......它只是坐在那里旋转它的轮子。

任何人的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T10:44:02.510

你在哪个平台？

如果您使用的是 Mac 或 Linux，则该文件夹应该是`~/Spotify`，`~`您的主目录在哪里。

如果您在 Windows 上，它应该在`Spotify`您的`My Documents`文件夹的目录中。

# iphone - CGPDFScannerPopString 返回奇怪的结果

> ID：13998640
> 
> 赞同：0
> 
> 时间：2012-12-21T23:46:41.710
> 
> 标签：iphone, ios, pdf, cgpdf

我终于可以使用某种 pdf 扫描仪了。它毫无问题地读入回调函数，但是当我尝试 NSLog 来自 CGPDFScannerPopString 的结果时，我得到如下结果：

```
ˆ ˛˝     #    ˜˜˜      #˜'  ˜˜˜      "˜   '˜˜      " '   ˜˜ 
```

这里找不到字符串...

关于它可能是什么的任何想法？这是我的回调函数：

```
static void op_Tj (CGPDFScannerRef s, void *info)
{
    CGPDFStringRef string;

    if (!CGPDFScannerPopString(s, &string))
        return;

    NSLog(@"string: %@", (__bridge NSString *)CGPDFStringCopyTextString(string));
} 
```

已经谢谢了！

编辑：[示例 PDF](http://www.flitelinesoftware.com/example.pdf)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:19:01.163

您应该知道 CGPDFStringRef 根本不是 ASCII 字符串或类似的东西。参照。[http://developer.apple.com/library/mac/documentation/graphicsimaging/Reference/CGPDFString/Reference/reference.html](http://developer.apple.com/library/mac/documentation/graphicsimaging/Reference/CGPDFString/Reference/reference.html) ---它是一个“字节系列 - 0到255范围内的无符号整数值”根据最新的 PDF 参考进行解释。

PDF 参考反过来会告诉您，字节的解释取决于所使用的字体，虽然类似 ASCII 的解释在欧洲语言中很常见，但它们不是强制性的，在亚洲语言的情况下，字体子集嵌入是很常见，解释可能看起来很随意。

CGPDFStringCopyTextString 尝试相应地解释这些字节，但不必将其解释为常规字符串。

**编辑**对 Ron 提供的样本 PDF 的检查表明，在这个样本的情况下，对象 3 0 中的字体编码（在文档的大多数页面上占主导地位）不是标准编码，而是：

```
<</Type/Encoding
  /Differences[0/.notdef/C/O/V/E/R/space/slash/H/L/F/underscore/W/B/five/eight/four
                /zero/two/six/D/one/period/three/Z/I/N/G/U/S/T/colon/seven/A/M/P/Y
                /plus/nine/X/hyphen/i/s/p/a/t/c/h/n/f/o/K/greater/equal/l/m/y/J/Q
                /parenleft/parenright/comma/dollar/ampersand/d/r/v/b/e/u/w/k/g/x/bar
                /quotesingle/asterisk/q/question/percent]
>> 
```

查看第一个文档页面的顶部

```
COVER / HLF_CWEB_58408485 / 58408485 / 26DEC12 10.30.22Z

BRIEFING INCLUDES FOLLOWING FLIGHTS:

26DEC12 OR0337 EHAM0630 MUVR1710 PHOYE VSM+2/8 179

NEXT FLIGHTS OF AIRCRAFT:

26DEC12 OR0338 MUVR1830 MMUN1940 PHOYE VSM+2/8 213
26DEC12 OR0338 MMUN2105 EHAM0655 PHOYE GPT+2/7 263
27DEC12 OR0365 EHAM0900 TNCB1930 PHOYE BAH+1/8 272
27DEC12 OR0366 TNCB2030 TNCC2110 PHOYE BAH+1/8 250
27DEC12 OR0366 TNCC2250 EHAM0835 PHOYE ASD+1/8 199 
```

该编码似乎是通过为下一个所需的字形处理从一个开始的下一个数字来创建的。这显然会导致高度个性化的编码......

话虽如此，字体对象确实包括 /Encoding 条目和 /ToUnicode 条目。因此，如果 CGPDFStringCopyTextString 方法在这里被提供了对字体的引用并真正尝试过，那么它很容易能够将这些字节正确地转换为相应的文本。它没有取得任何体面的结果，似乎表明它根本没有信息来解释字节的字体——我不认为它不会尝试......

因此，为了准确提取文本，您必须自己使用内容流中的字体信息来解释 CGPDFStringRef 中的字节。如果您不想从头开始，您可能会对[PDFKitten](https://github.com/KurtCode/PDFKitten)感兴趣，这是一个在 iOS 中从 PDF 中提取数据的框架。虽然它还不是完美的（一些字体结构可能会让它感到困惑），但它是一个很好的起点。

# c++ - 错误 1 错误 LNK1104：无法打开文件 'winmm.lib'

> ID：13998642
> 
> 赞同：2
> 
> 时间：2012-12-21T23:46:50.493
> 
> 标签：c++, visual-studio-2010, compiler-errors, directx

好的，所以我正在运行 Visual Basic 2010 Express，并尝试在 Direct X SDK 中运行教程 #2；但是，由于某种原因，该程序无法编译，尽管在我现在阅读的教程中它说我只需要 Direct X SDK 和 Visual Basic 2010 Express。我打开 Tutorial02_2010.sln，并尝试编译它。这是主文件的代码：

```
//--------------------------------------------------------------------------------------
// File: Tutorial02.cpp
//
// This application displays a triangle using Direct3D 10
//
// Copyright (c) Microsoft Corporation. All rights reserved.
//--------------------------------------------------------------------------------------
#include <windows.h>
#include <d3d10.h>
#include <d3dx10.h>
#include "resource.h"

//--------------------------------------------------------------------------------------
// Structures
//--------------------------------------------------------------------------------------
struct SimpleVertex
{
    D3DXVECTOR3 Pos;
};

//--------------------------------------------------------------------------------------
// Global Variables
//--------------------------------------------------------------------------------------
HINSTANCE               g_hInst = NULL;
HWND                    g_hWnd = NULL;
D3D10_DRIVER_TYPE       g_driverType = D3D10_DRIVER_TYPE_NULL;
ID3D10Device*           g_pd3dDevice = NULL;
IDXGISwapChain*         g_pSwapChain = NULL;
ID3D10RenderTargetView* g_pRenderTargetView = NULL;
ID3D10Effect*           g_pEffect = NULL;
ID3D10EffectTechnique*  g_pTechnique = NULL;
ID3D10InputLayout*      g_pVertexLayout = NULL;
ID3D10Buffer*           g_pVertexBuffer = NULL;

//--------------------------------------------------------------------------------------
// Forward declarations
//--------------------------------------------------------------------------------------
HRESULT InitWindow( HINSTANCE hInstance, int nCmdShow );
HRESULT InitDevice();
void CleanupDevice();
LRESULT CALLBACK    WndProc( HWND, UINT, WPARAM, LPARAM );
void Render();

//--------------------------------------------------------------------------------------
// Entry point to the program. Initializes everything and goes into a message processing 
// loop. Idle time is used to render the scene.
//--------------------------------------------------------------------------------------
int WINAPI wWinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPWSTR lpCmdLine, int nCmdShow )
{
    UNREFERENCED_PARAMETER( hPrevInstance );
    UNREFERENCED_PARAMETER( lpCmdLine );

    if( FAILED( InitWindow( hInstance, nCmdShow ) ) )
        return 0;

    if( FAILED( InitDevice() ) )
    {
        CleanupDevice();
        return 0;
    }

    // Main message loop
    MSG msg = {0};
    while( WM_QUIT != msg.message )
    {
        if( PeekMessage( &msg, NULL, 0, 0, PM_REMOVE ) )
        {
            TranslateMessage( &msg );
            DispatchMessage( &msg );
        }
        else
        {
            Render();
        }
    }

    CleanupDevice();

    return ( int )msg.wParam;
}

//--------------------------------------------------------------------------------------
// Register class and create window
//--------------------------------------------------------------------------------------
HRESULT InitWindow( HINSTANCE hInstance, int nCmdShow )
{
    // Register class
    WNDCLASSEX wcex;
    wcex.cbSize = sizeof( WNDCLASSEX );
    wcex.style = CS_HREDRAW | CS_VREDRAW;
    wcex.lpfnWndProc = WndProc;
    wcex.cbClsExtra = 0;
    wcex.cbWndExtra = 0;
    wcex.hInstance = hInstance;
    wcex.hIcon = LoadIcon( hInstance, ( LPCTSTR )IDI_TUTORIAL1 );
    wcex.hCursor = LoadCursor( NULL, IDC_ARROW );
    wcex.hbrBackground = ( HBRUSH )( COLOR_WINDOW + 1 );
    wcex.lpszMenuName = NULL;
    wcex.lpszClassName = L"TutorialWindowClass";
    wcex.hIconSm = LoadIcon( wcex.hInstance, ( LPCTSTR )IDI_TUTORIAL1 );
    if( !RegisterClassEx( &wcex ) )
        return E_FAIL;

    // Create window
    g_hInst = hInstance;
    RECT rc = { 0, 0, 640, 480 };
    AdjustWindowRect( &rc, WS_OVERLAPPEDWINDOW, FALSE );
    g_hWnd = CreateWindow( L"TutorialWindowClass", L"Direct3D 10 Tutorial 2: Rendering a Triangle",
                           WS_OVERLAPPEDWINDOW,
                           CW_USEDEFAULT, CW_USEDEFAULT, rc.right - rc.left, rc.bottom - rc.top, NULL, NULL, hInstance,
                           NULL );
    if( !g_hWnd )
        return E_FAIL;

    ShowWindow( g_hWnd, nCmdShow );

    return S_OK;
}

//--------------------------------------------------------------------------------------
// Create Direct3D device and swap chain
//--------------------------------------------------------------------------------------
HRESULT InitDevice()
{
    HRESULT hr = S_OK;

    RECT rc;
    GetClientRect( g_hWnd, &rc );
    UINT width = rc.right - rc.left;
    UINT height = rc.bottom - rc.top;

    UINT createDeviceFlags = 0;
#ifdef _DEBUG
    createDeviceFlags |= D3D10_CREATE_DEVICE_DEBUG;
#endif

    D3D10_DRIVER_TYPE driverTypes[] =
    {
        D3D10_DRIVER_TYPE_HARDWARE,
        D3D10_DRIVER_TYPE_REFERENCE,
    };
    UINT numDriverTypes = sizeof( driverTypes ) / sizeof( driverTypes[0] );

    DXGI_SWAP_CHAIN_DESC sd;
    ZeroMemory( &sd, sizeof( sd ) );
    sd.BufferCount = 1;
    sd.BufferDesc.Width = width;
    sd.BufferDesc.Height = height;
    sd.BufferDesc.Format = DXGI_FORMAT_R8G8B8A8_UNORM;
    sd.BufferDesc.RefreshRate.Numerator = 60;
    sd.BufferDesc.RefreshRate.Denominator = 1;
    sd.BufferUsage = DXGI_USAGE_RENDER_TARGET_OUTPUT;
    sd.OutputWindow = g_hWnd;
    sd.SampleDesc.Count = 1;
    sd.SampleDesc.Quality = 0;
    sd.Windowed = TRUE;

    for( UINT driverTypeIndex = 0; driverTypeIndex < numDriverTypes; driverTypeIndex++ )
    {
        g_driverType = driverTypes[driverTypeIndex];
        hr = D3D10CreateDeviceAndSwapChain( NULL, g_driverType, NULL, createDeviceFlags,
                                            D3D10_SDK_VERSION, &sd, &g_pSwapChain, &g_pd3dDevice );
        if( SUCCEEDED( hr ) )
            break;
    }
    if( FAILED( hr ) )
        return hr;

    // Create a render target view
    ID3D10Texture2D* pBuffer;
    hr = g_pSwapChain->GetBuffer( 0, __uuidof( ID3D10Texture2D ), ( LPVOID* )&pBuffer );
    if( FAILED( hr ) )
        return hr;

    hr = g_pd3dDevice->CreateRenderTargetView( pBuffer, NULL, &g_pRenderTargetView );
    pBuffer->Release();
    if( FAILED( hr ) )
        return hr;

    g_pd3dDevice->OMSetRenderTargets( 1, &g_pRenderTargetView, NULL );

    // Setup the viewport
    D3D10_VIEWPORT vp;
    vp.Width = width;
    vp.Height = height;
    vp.MinDepth = 0.0f;
    vp.MaxDepth = 1.0f;
    vp.TopLeftX = 0;
    vp.TopLeftY = 0;
    g_pd3dDevice->RSSetViewports( 1, &vp );

    // Create the effect
    DWORD dwShaderFlags = D3D10_SHADER_ENABLE_STRICTNESS;
#if defined( DEBUG ) || defined( _DEBUG )
    // Set the D3D10_SHADER_DEBUG flag to embed debug information in the shaders.
    // Setting this flag improves the shader debugging experience, but still allows 
    // the shaders to be optimized and to run exactly the way they will run in 
    // the release configuration of this program.
    dwShaderFlags |= D3D10_SHADER_DEBUG;
    #endif
    hr = D3DX10CreateEffectFromFile( L"Tutorial02.fx", NULL, NULL, "fx_4_0", dwShaderFlags, 0,
                                         g_pd3dDevice, NULL, NULL, &g_pEffect, NULL, NULL );
    if( FAILED( hr ) )
    {
        MessageBox( NULL,
                    L"The FX file cannot be located.  Please run this executable from the directory that contains the FX file.", L"Error", MB_OK );
        return hr;
    }

    // Obtain the technique
    g_pTechnique = g_pEffect->GetTechniqueByName( "Render" );

    // Define the input layout
    D3D10_INPUT_ELEMENT_DESC layout[] =
    {
        { "POSITION", 0, DXGI_FORMAT_R32G32B32_FLOAT, 0, 0, D3D10_INPUT_PER_VERTEX_DATA, 0 },
    };
    UINT numElements = sizeof( layout ) / sizeof( layout[0] );

    // Create the input layout
    D3D10_PASS_DESC PassDesc;
    g_pTechnique->GetPassByIndex( 0 )->GetDesc( &PassDesc );
    hr = g_pd3dDevice->CreateInputLayout( layout, numElements, PassDesc.pIAInputSignature,
                                          PassDesc.IAInputSignatureSize, &g_pVertexLayout );
    if( FAILED( hr ) )
        return hr;

    // Set the input layout
    g_pd3dDevice->IASetInputLayout( g_pVertexLayout );

    // Create vertex buffer
    SimpleVertex vertices[] =
    {
        D3DXVECTOR3( 0.0f, 0.5f, 0.5f ),
        D3DXVECTOR3( 0.5f, -0.5f, 0.5f ),
        D3DXVECTOR3( -0.5f, -0.5f, 0.5f ),
    };
    D3D10_BUFFER_DESC bd;
    bd.Usage = D3D10_USAGE_DEFAULT;
    bd.ByteWidth = sizeof( SimpleVertex ) * 3;
    bd.BindFlags = D3D10_BIND_VERTEX_BUFFER;
    bd.CPUAccessFlags = 0;
    bd.MiscFlags = 0;
    D3D10_SUBRESOURCE_DATA InitData;
    InitData.pSysMem = vertices;
    hr = g_pd3dDevice->CreateBuffer( &bd, &InitData, &g_pVertexBuffer );
    if( FAILED( hr ) )
        return hr;

    // Set vertex buffer
    UINT stride = sizeof( SimpleVertex );
    UINT offset = 0;
    g_pd3dDevice->IASetVertexBuffers( 0, 1, &g_pVertexBuffer, &stride, &offset );

    // Set primitive topology
    g_pd3dDevice->IASetPrimitiveTopology( D3D10_PRIMITIVE_TOPOLOGY_TRIANGLELIST );

    return S_OK;
}

//--------------------------------------------------------------------------------------
// Clean up the objects we've created
//--------------------------------------------------------------------------------------
void CleanupDevice()
{
    if( g_pd3dDevice ) g_pd3dDevice->ClearState();

    if( g_pVertexBuffer ) g_pVertexBuffer->Release();
    if( g_pVertexLayout ) g_pVertexLayout->Release();
    if( g_pEffect ) g_pEffect->Release();
    if( g_pRenderTargetView ) g_pRenderTargetView->Release();
    if( g_pSwapChain ) g_pSwapChain->Release();
    if( g_pd3dDevice ) g_pd3dDevice->Release();
}

//--------------------------------------------------------------------------------------
// Called every time the application receives a message
//--------------------------------------------------------------------------------------
LRESULT CALLBACK WndProc( HWND hWnd, UINT message, WPARAM wParam, LPARAM lParam )
{
    PAINTSTRUCT ps;
    HDC hdc;

    switch( message )
    {
        case WM_PAINT:
            hdc = BeginPaint( hWnd, &ps );
            EndPaint( hWnd, &ps );
            break;

        case WM_DESTROY:
            PostQuitMessage( 0 );
            break;

        default:
            return DefWindowProc( hWnd, message, wParam, lParam );
    }

    return 0;
}

//--------------------------------------------------------------------------------------
// Render a frame
//--------------------------------------------------------------------------------------
void Render()
{
    // Clear the back buffer 
    float ClearColor[4] = { 0.0f, 0.125f, 0.3f, 1.0f }; // red,green,blue,alpha
    g_pd3dDevice->ClearRenderTargetView( g_pRenderTargetView, ClearColor );

    // Render a triangle
    D3D10_TECHNIQUE_DESC techDesc;
    g_pTechnique->GetDesc( &techDesc );
    for( UINT p = 0; p < techDesc.Passes; ++p )
    {
        g_pTechnique->GetPassByIndex( p )->Apply( 0 );
        g_pd3dDevice->Draw( 3, 0 );
    }

    // Present the information rendered to the back buffer to the front buffer (the screen)
    g_pSwapChain->Present( 0, 0 );
} 
```

我是否需要安装其他任何东西，例如库或其他东西，我是否只需要按照我必须为 Direct x lib 文件采取的相同步骤进行操作？

[http://www.rastertek.com/dx11tut01.html](http://www.rastertek.com/dx11tut01.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:02:12.287

1.  安装 Visual Studio Express C++。
2.  安装适用于 Windows 7 的 Windows SDK。
3.  为该复制+粘贴代码重新创建一个新项目后，将项目属性指向 windows sdk，以及直接 X sdk。这包括包含文件夹和 lib 文件夹。如果您不知道该怎么做，请前往 msdn.com 上查看 Visual Studio 2010 的“我如何”视频。
4.  编译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-08T09:53:57.153

我在使用 Visual Studio 2013 Express 时遇到了一个非常相似的错误：

```
LINK : fatal error LNK1181: cannot open input file 'winmm.lib' 
```

对我来说，事实证明我安装了“Visual Studio 2013 Express for Windows”，而实际上我需要“Visual Studio 2013 Express for Windows Desktop”。

安装“Visual Studio 2013 Express for Windows Desktop”为我解决了这个错误。

# python - Python 自定义文本到 html 语法

> ID：13998647
> 
> 赞同：0
> 
> 时间：2012-12-21T23:47:12.740
> 
> 标签：python, regex

我正在尝试为我的用户创建自定义语法来格式化一些 html

因此用户可以输入如下内容：

```
**some text here**
the some more text down here
**Another bunch of stuff**
then some other junk

and I get:

<h1>some text here</h2>
<p>the some more text down here</p>
<h1>Another bunch of stuff</h1>
<p>then some other junk</p> 
```

并希望留出一些空间来弥补我需要的其他标签

编辑：所以我的问题是我将如何编写正则表达式函数来转换一些给定的文本并让它找到打开和关闭 ** 的每个实例并用适当的 or 标记替换它们。我有：进口重新

header_pattern = re.compile(r'(?P**)(?P.*)(?P**)', re.MULTILINE)

```
def format_headers(text):
    def process_match(m):
        return "<h2>%s</h2>" % m.group('header')

    new_text = header_pattern.sub(process_match, text)

    print new_text 
```

但这只会抓住第一个 ** 和最后一个 ** 并忽略中间的那些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:16:26.977

你有什么理由不能使用像 Cheetah 这样的简单模板语言并将逻辑构建到甚至处理程序中？Cheetah 将允许您创建一个模板对象，其中包含一组对操作 HTML 有用的方法。几周前，当我尝试使用 CherryPy 创建网页时，我遇到了类似的问题，在教程中我找到了 Cheetah 模板，它使编写表单变得更加容易！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:39:17.800

**使用一些标准溶液。像降价**。它是最优选的。

要匹配您的标题字符串，请使用`r'\*\*(.*?)\*\*'`. 查看示例

```
>>> re.sub(r'\*\*(.*?)\*\*','<h1>\\1</h1>', '**some text here** and **another**')
'<h1>some text here</h1> and <h1>another</h1>' 
```

# matlab - Matlab问题：linprog

> ID：13998650
> 
> 赞同：3
> 
> 时间：2012-12-21T23:47:32.283
> 
> 标签：matlab, optimization, constraints, zero

晚上好，

我对 Matlab 的 linprog 函数有疑问，这是我得到的消息：

> 由于不可行而退出：约束矩阵中的全零行在相应的右侧条目中没有零。

根据帮助，这意味着我在 Aeq 中至少有一行全为零（比如说，第 i 行），但 beq(i) 不等于零。

我检查了我的矩阵：

```
checkmat=full(sum(abs(Aeq')))';
checkmat=horzcat(checkmat,beq);

for i=1:length(checkmat)
   if (checkmat(i,1)==0 && checkmat(i,2)~=0) || (checkmat(i,2)==0 && checkmat(i,1)~=0)
      i
   end
end 
```

但这似乎没问题。有人知道它可能来自哪里吗？如果缺少任何信息，我会很乐意尝试收集它们。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T17:28:45.623

使用的默认内点方法`linprog`在实际迭代开始之前执行一些预处理步骤。因此，虽然您`Aeq`可能不包含对应元素为非零的全零行`beq`，但这可能发生在预处理之后。

您可以尝试`linprog`使用另一种算法（使用`optimset('LargeScale', 'off')`和/或`optimset('LargeScale', 'off', 'Simplex', 'on')`）运行并查看在这种情况下的输出。

但是，我怀疑在所有情况下你都会得到一个“不可行的问题”退出标志，因为你的等式约束似乎无法满足。

有关Matlab 可用的线性规划算法及其预处理步骤的[更多信息。](http://www.mathworks.com/help/optim/ug/linear-programming-algorithms.html)

# r - 向 CRAN 提交 R 包的步骤是什么？每个步骤需要多长时间？

> ID：13998660
> 
> 赞同：18
> 
> 时间：2012-12-21T23:48:04.310
> 
> 标签：r, cran

我注意到，一旦提交到传入（[ftp://cran.r-project.org/incoming](ftp://cran.r-project.org/incoming)），包名称就会收到以下后缀 .save、.pending 和 .noemail。然后，包裹从传入中消失。我想下一步是 CRAN 维护者把它放在主服务器上（[http://cran.r-project.org/src/contrib/](http://cran.r-project.org/src/contrib/) [http://cran.r-project.org/web/packages/](http://cran.r-project.org/web/packages/)）然后它被传播到镜子。

我的问题：

(1) 有人可以确认这些步骤并提供详细信息。特别是在包裹从传入中消失后会发生什么（没有找到检查该步骤状态的方法）

(2) 每一步平均需要多长时间？

谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T00:21:23.637

有关 CRAN 政策的所有公共信息都在这里：

[http://cran.r-project.org/web/packages/policies.html](http://cran.r-project.org/web/packages/policies.html)

如果您寻找的信息不存在，那么只有 CRAN 的众神知道。我不会依赖那些对我们有任何重大意义的后缀。那将是 CRAN 的内部处理，它可能会随着 CRAN 之神的一时兴起而改变。

问题 2 的答案与“一根绳子有多长？”的答案相同。

# coldfusion - 如何在 ColdFusion 中生成用于缓存项目的唯一键

> ID：13998662
> 
> 赞同：2
> 
> 时间：2012-12-21T23:48:05.793
> 
> 标签：coldfusion, coldfusion-10

我在 Adob​​e 社区论坛上发布了一个类似的问题，但也有人建议在这里提问。

我正在尝试缓存与特定数据库关联的不同查询，并且需要能够刷新该数据库的所有查询，同时保持其他缓存查询不变。所以我想我会利用 ColdFusion 的 ehcache 功能。我创建了一个特定的缓存区域来用于来自这个特定数据库的查询，因此我可以使用 cacheRemoveAll(myRegionName) 来刷新那些存储的查询。

由于我需要每个不同的查询都可以轻松地被缓存和检索，我想我会将查询参数散列成一个唯一的字符串，用于每个查询的缓存键。这是我迄今为止尝试过的方法：

1.  创建一个包含参数键值对（参数名称、参数值）的结构。
2.  使用 SerializeJSON() 将 Struct 转换为字符串。
3.  使用 Hash() 对字符串进行散列。

这种方法有意义吗？我想知道其他人是如何处理缓存密钥生成的。此外，“MD5”算法是否足以满足此目的，它会保证唯一的密钥生成，还是我需要使用“SHA”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:29:59.553

**更新**：使用`cacheRegion`CF10 中引入的属性！

[http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html](http://help.adobe.com/en_US/ColdFusion/10.0/CFMLRef/WSc3ff6d0ea77859461172e0811cbec22c24-7fae.html)

然后您需要做的就是指定`cachedAfter`or `cachedWithin`，而忘记如何生成唯一键。CF 将通过“散列”为您完成：

*   查询“姓名”
*   SQL 语句
*   数据源
*   用户名和密码
*   数据库类型

参考： http: [//www.coldfusionmuse.com/index.cfm/2010/9/19/safe.caching](http://www.coldfusionmuse.com/index.cfm/2010/9/19/safe.caching)

我认为这将是最简单的，除非您确实需要通过键获取特定查询，否则您可以使用`cacheID`CF10 中引入的另一个新属性来提供您自己的哈希。

# web-services - 为什么这个简单的 web 服务（部署到 weblogic11g）会收到这个错误：“wsa:MessageAddressingHeaderRequired”？

> ID：13998668
> 
> 赞同：0
> 
> 时间：2012-12-21T23:48:33.390
> 
> 标签：web-services, weblogic, jax-ws

***问题：*** 我已经多次重新创建和部署了这个非常简单的 jax-ws 网络服务（见下文）。但是，我一直无法让这个简单的网络服务应用程序工作！

也就是说，当我提交简单的 SOAP 请求（请参阅下面的“服务请求”）时，我收到以下错误：“ *wsa:MessageAddressingHeaderRequired* ”

***问题：*** 是什么导致了这个错误：“wsa:MessageAddressingHeaderRequired”？

***更多信息，如下...***

*这是实现类...*

```
package aaa.bbb.ccc;

import ccc.bbb.aaa.testws.ObjectFactory;
import ccc.bbb.aaa.testws.ResponseType;
import javax.jws.WebService;

@WebService(serviceName = "testws", portName = "testwsSOAP", endpointInterface = "ccc.bbb.aaa.testws.Testws", targetNamespace = "http://aaa.bbb.ccc/testws/", wsdlLocation = "WEB-INF/wsdl/testws.wsdl")
public class testws
{
    public ccc.bbb.aaa.testws.ResponseType multiplyOperation(ccc.bbb.aaa.testws.RequestType request)
    {
        Integer value1 = new Integer(request.getParmValue1());
        Integer value2 = new Integer(request.getParmValue2());
        Integer product = value1 * value2;
        ObjectFactory factory = new ObjectFactory();
        ResponseType response = factory.createResponseType();
        response.setValue1(value1.toString());
        response.setValue2(value2.toString());
        response.setProduct(product.toString());
        return response;
    }
} 
```

*这是WSDL...*

```
<?xml version="1.0" encoding="UTF-8"?>
<wsdl:definitions xmlns:wsdl="http://schemas.xmlsoap.org/wsdl/"
    xmlns:soap="http://schemas.xmlsoap.org/wsdl/soap/"
    xmlns:tns="http://aaa.bbb.ccc/testws/"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema" name="testws"
    targetNamespace="http://aaa.bbb.ccc/testws/" xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsp1="http://www.w3.org/ns/ws-policy" xmlns:fi="http://java.sun.com/xml/ns/wsit/2006/09/policy/fastinfoset/service" xmlns:tcp="http://java.sun.com/xml/ns/wsit/2006/09/policy/soaptcp/service" xmlns:wsaw="http://www.w3.org/2005/08/addressing" xmlns:wsrm="http://schemas.xmlsoap.org/ws/2005/02/rm/policy" xmlns:sunrm="http://sun.com/2006/03/rm" xmlns:net="http://schemas.microsoft.com/net/2005/02/rm/policy">
    <wsdl:types>
        <xsd:schema targetNamespace="http://aaa.bbb.ccc/testws/"
            xmlns:xsd="http://www.w3.org/2001/XMLSchema"
            xmlns:Q1="http://aaa.bbb.ccc/testws">
            <xsd:import schemaLocation="testws.xsd"
                namespace="http://aaa.bbb.ccc/testws">
            </xsd:import>
            <xsd:element name="multiplyOperation">
                <xsd:complexType>
                    <xsd:sequence>
                        <xsd:element name="request"
                            type="Q1:requestType" />
                    </xsd:sequence>
                </xsd:complexType>
            </xsd:element>
            <xsd:element name="multiplyOperationResponse">
                <xsd:complexType>
                    <xsd:sequence>
                        <xsd:element name="response"
                            type="Q1:responseType" />
                    </xsd:sequence>
                </xsd:complexType>
            </xsd:element>
        </xsd:schema>
    </wsdl:types>
    <wsdl:message name="multiplyOperationRequest">
        <wsdl:part element="tns:multiplyOperation" name="parameters" />
    </wsdl:message>
    <wsdl:message name="multiplyOperationResponse">
        <wsdl:part element="tns:multiplyOperationResponse"
            name="parameters" />
    </wsdl:message>
    <wsdl:portType name="testws">
        <wsdl:operation name="multiplyOperation">
            <wsdl:input message="tns:multiplyOperationRequest" />
            <wsdl:output message="tns:multiplyOperationResponse" />
        </wsdl:operation>
    </wsdl:portType>
    <wsdl:binding name="testwsSOAP" type="tns:testws">
     <wsaw:UsingAddressing wsdl:required="true" xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl"/>

        <soap:binding style="document"
            transport="http://schemas.xmlsoap.org/soap/http" />
        <wsdl:operation name="multiplyOperation">
            <soap:operation
                soapAction="http://aaa.bbb.ccc/testws/multiplyOperation" />
            <wsdl:input>
                <soap:body use="literal" />
            </wsdl:input>
            <wsdl:output>
                <soap:body use="literal" />
            </wsdl:output>
        </wsdl:operation>
    </wsdl:binding>
    <wsdl:service name="testws">
        <wsdl:port binding="tns:testwsSOAP" name="testwsSOAP">
            <soap:address location="http://aaa.bbb.ccc/" />
        </wsdl:port>
    </wsdl:service>
</wsdl:definitions> 
```

*这是XSD...*

```
<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema"
    targetNamespace="http://aaa.bbb.ccc/testws"
    xmlns:tns="http://aaa.bbb.ccc/testws"
    elementFormDefault="qualified">

    <element name="query" type="tns:queryType"></element>

    <complexType name="queryType">
        <choice>
            <element name="request" type="tns:requestType"></element>
            <element name="response" type="tns:responseType"></element>
        </choice>
    </complexType>

    <complexType name="requestType">
        <sequence>
            <element name="parmValue1" type="string"></element>
            <element name="parmValue2" type="string"></element>
        </sequence>
    </complexType>

    <complexType name="responseType">
        <sequence>
            <element name="value1" type="string"></element>
            <element name="value2" type="string"></element>
            <element name="product" type="string"></element>
        </sequence>
    </complexType>
</schema> 
```

*这是测试请求...*

```
<env:Envelope xmlns:env="http://schemas.xmlsoap.org/soap/envelope/">
  <env:Header />
    <env:Body>
    <multiplyOperation xmlns="http://aaa.bbb.ccc/testws/" xmlns:tes="http://aaa.bbb.ccc/testws">
      <request xmlns="">
        <tes:parmValue1>3</tes:parmValue1>
        <tes:parmValue2>4</tes:parmValue2>
      </request>
    </multiplyOperation>
  </env:Body>
  </env:Envelope> 
```

*这是测试响应...*

```
<S:Envelope xmlns:S="http://schemas.xmlsoap.org/soap/envelope/">
  <S:Header>
    <FaultDetail xmlns="http://www.w3.org/2005/08/addressing">
      <ProblemHeaderQName>{http://www.w3.org/2005/08/addressing}Action</ProblemHeaderQName>
    </FaultDetail>
  </S:Header>
    <S:Body>
    <SOAP-ENV:Fault xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/">
      <faultcode xmlns:wsa="http://www.w3.org/2005/08/addressing">wsa:MessageAddressingHeaderRequired</faultcode>
      <faultstring>A required header representing a Message Addressing Property is not present</faultstring>
    </SOAP-ENV:Fault>
  </S:Body>
  </S:Envelope> 
```

*这是我使用的 Maven 构建脚本...*

```
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
  <modelVersion>4.0.0</modelVersion>

  <groupId>aaa.bbb.ccc</groupId>
  <artifactId>testwswaronly</artifactId>
  <packaging>war</packaging>
  <version>1</version>

  <name>testwswaronly</name>
  <url>http://maven.apache.org</url>

  <dependencies>
    <dependency>
      <groupId>javax.servlet</groupId>
      <artifactId>servlet-api</artifactId>
      <version>2.5</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>javax.servlet.jsp</groupId>
      <artifactId>jsp-api</artifactId>
      <version>2.1</version>
      <scope>provided</scope>
    </dependency>
    <dependency>
      <groupId>com.sun.xml.ws</groupId>
      <artifactId>webservices-rt</artifactId>
      <version>1.4</version>
      <scope>provided</scope>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <version>2.3.2</version>
        <configuration>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.jvnet.jax-ws-commons</groupId>
        <artifactId>jaxws-maven-plugin</artifactId>
        <version>2.2</version>
        <executions>
          <execution>
            <goals>
              <goal>wsimport</goal>
            </goals>
            <configuration>
              <wsdlFiles>
                <wsdlFile>testws.wsdl</wsdlFile>
              </wsdlFiles>
              <staleFile>${project.build.directory}/jaxws/stale/testws.stale</staleFile>
            </configuration>
            <id>wsimport-generate-testws</id>
            <phase>generate-sources</phase>
          </execution>
        </executions>
        <dependencies>
          <dependency>
            <groupId>javax.xml</groupId>
            <artifactId>webservices-api</artifactId>
            <version>1.4</version>
          </dependency>
        </dependencies>
        <configuration>
          <sourceDestDir>${project.build.directory}/generated-sources/jaxws-wsimport</sourceDestDir>
          <xnocompile>true</xnocompile>
          <verbose>true</verbose>
          <extension>true</extension>
          <catalog>${basedir}/src/jax-ws-catalog.xml</catalog>
        </configuration>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>2.0.2</version>
        <configuration>
          <webResources>
            <resource>
              <directory>src</directory>
              <targetPath>WEB-INF</targetPath>
              <includes>
                <include>jax-ws-catalog.xml</include>
                <include>wsdl/**</include>
              </includes>
            </resource>
          </webResources>
        </configuration>
      </plugin>
    </plugins>
  </build>
    <properties>
        <netbeans.hint.deploy.server>WebLogic9</netbeans.hint.deploy.server>
    </properties>
</project> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-24T18:25:01.647

您的 WSDL 包含：

```
<wsaw:UsingAddressing wsdl:required="true" xmlns:wsaw="http://www.w3.org/2006/05/addressing/wsdl"/> 
```

请注意，该`required`属性设置为`true`。但是您的测试请求不包含任何标头：

```
<env:Header /> 
```

我相信响应的`FaultDetail`标头会告诉您需要哪个请求标头：

```
<ProblemHeaderQName>{http://www.w3.org/2005/08/addressing}Action</ProblemHeaderQName> 
```

# c++ - Cpp 指针和数组

> ID：13998669
> 
> 赞同：2
> 
> 时间：2012-12-21T23:48:35.473
> 
> 标签：c++, arrays, pointers

你能帮我理解这一点吗？

我有需要“ **char ***argv** ”的功能；

据我了解，它是： *指向 char 指针数组的指针*。

像这样的东西：“ **char *arr[]** ”？

```
char xx1 = '1';
char xx2 = '2';
char *argv[] = {&xx1,&xx2}; 
```

**然后我用gtk_init (&argc, &argv);**调用我的函数。

 **并得到错误：

```
main.cpp:43:31: error: cannot convert ‘char* (*)[2]’ to ‘char***’ for argument ‘2’ to ‘void gtk_init(int*, char***)’ 
```

感谢您的任何帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-21T23:59:48.590

A`char***`是“指向指向 char 的指针的指针”。根本不涉及数组。您`argv`是“2 个指向 char 的指针的数组”。在某些情况下，数组的名称`argv`, 将衰减为指向其第一个元素的指针 - 该指针将具有 type`char**`或“指向 char 的指针的指针”。

当你这样做时`&argv`，你会得到一个`char* (*)[2]`，或“指向 2 个指向 char 的指针的数组的指针”。这不是你想要的。那是因为您正在获取数组的地址，而不是指针。

此外，您将遇到问题，因为您的指针`argv`只是指向单个`char`s，而不是指向以空字符结尾的字符串。`gtk_init`几乎肯定会期待以空结尾的字符串。

那你能做什么？试试这个：

```
char xx1[] = "1"; // Now these are null-terminated strings
char xx2[] = "2";
char* argv[] = {xx1, xx2};
char** argvp = argv; // Use the fact that the array will decay
gtk_init(&argc, &argv); // &argv will now be a char*** 
```

对字符串使用数组的原因是因为我们需要`char`s 是非常量的，但`char* str = "hello";`不推荐使用样式声明——它必须是`const char*`. 但是，通过使用数组，字符串文字的内容被复制到我们的数组中，因此我们可以自由地将其设为非`const`.

`gtk_init`真的只是希望您将主函数的`argc`和参数传递给它，如下所示：`argv`

```
int main(int argc, char* argv[])
{
  gtk_init(&argc, &argv);
  // ...
} 
```

您现在可能会问“但为什么`&argv`现在允许？`argv`与问题中的类型相同！为什么我们不再获得指向数组的指针？” 实际上，`argv`不是同一种类型，尽管它看起来很像。当你定义一个接受数组参数的函数时，它实际上被转换为一个指针。所以 的定义`main`等价于：

```
int main(int argc, char** argv); 
```

所以当我们这样做时`&argv`，我们完全没问题，因为它给了我们一个`char***`.

正如@OmnipotentEntity 在评论中所说 - 你最好有一个很好的借口不传递`main`to的参数`gtk_init`。**

# java - imageView 中图像的新尺寸

> ID：13998671
> 
> 赞同：1
> 
> 时间：2012-12-21T23:48:55.803
> 
> 标签：java, android, android-imageview

我想知道我的图像在图像视图中设置时的新大小。

我试过这个：

```
System.out.println("Imagesize 1 w:" + imageView.getDrawable().getIntrinsicWidth()+" h "+imageView.getDrawable().getIntrinsicHeight());
System.out.println("Imagesize 2  w:" +loadedImage.getWidth()+ " h " +loadedImage.getHeight()); 
```

imageView的xml1：

```
android:layout_width="fill_parent"
android:layout_height="fill_parent" 
```

我有这个结果

```
Imagesize 1 w:400 h 577
Imagesize 2 w:400 h 577 
```

imageView的xml2：

```
android:layout_width="wrap_content"
android:layout_height="wrap_content" 
```

结果相同：

```
Imagesize 1 w:400 h 577
Imagesize 2 w:400 h 577 
```

显然，在 xml1 和 xml2 的情况下，我的图像不会以相同的大小显示在我的屏幕上。我想当我 getWidth 或 getHeight 时，它是图像的实际大小，但我想要屏幕上显示的图像大小。

有任何想法吗？

更新1：

我忘了说loadedImage是我图像的位图

更新 2：

xml。

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:padding="1dip" >

<ImageView
    android:id="@+id/image"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_gravity="center"
    android:adjustViewBounds="true"
    android:contentDescription="@string/descr_image"
    android:layout_alignParentBottom="true" />

<ProgressBar
    android:id="@+id/loading"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:visibility="gone" />

<WebView  xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/webView1"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
/>

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:06:07.960

要在创建屏幕对象后获取它们的大小，您需要使用如下视图观察器：

```
ViewTreeObserver viewTreeObserver = YOURLAYOUT.getViewTreeObserver();
if (viewTreeObserver.isAlive()) {
viewTreeObserver.addOnGlobalLayoutListener(new OnGlobalLayoutListener() {
      public void onGlobalLayout() {
         YOURLAYOUT.getViewTreeObserver().removeGlobalOnLayoutListener(this);
         //do some things
         //YOURLAYOUT.getWidth() should give a correct answer
      }
});
} 
```

# php - 使用 javascript 时，我将如何为所选选项创建 if 语句

> ID：13998673
> 
> 赞同：2
> 
> 时间：2012-12-21T23:49:17.447
> 
> 标签：php, javascript

我是 javascript 新手，但是我正在尝试使用以下选项创建 if else 语句。

```
<select name="remote_server" class="required">
<option></option>
<option value="1" <?php if($remote=="1") echo 'selected="selected"'; ?>>Yes</option>
<option value="0" <?php if($remote=="0") echo 'selected="selected"'; ?>>No</option>
</select> 
```

我想做类似的事情

```
if remote_server = 1 then 
    document.getElementByName("hostname").disabled = true;
else 
    nothing 
```

编辑1：

我现在正在尝试以下但没有成功

```
var e = document.getElementsByName("remote_server");
var strUser = e.options[e.selectedIndex].value;

if ( strUser == 0 ) {
    document.getElementsByName("ftp_hostname").disabled = true;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:27:31.277

`getElementsByName`返回一个元素数组，所以如果你想要第一个名为“remote_server”的元素，你应该使用`document.getElementsByName("remote_server")[0]`.

同样，您需要使用`document.getElementsByName("ftp_hostname")[0].disabled`.

# html - HTML CSS 按钮定位

> ID：13998677
> 
> 赞同：3
> 
> 时间：2012-12-21T23:49:35.533
> 
> 标签：html, css, button, position, pressed

我在标题 div 中有 4 个按钮。我已将它们全部放置在 css 中的顶部和左侧边距，因此它们都在一行中彼此相邻。没有什么花哨。

现在我正在尝试在按下按钮时执行一项操作，按钮文本会向下移动一点。

我在 CSS 中使用这段代码：

```
 #btnhome:active{
    line-height : 25px;
} 
```

HTML：

```
<div id="header">           
        <button id="btnhome">Home</button>          
        <button id="btnabout">About</button>
        <button id="btncontact">Contact</button>
        <button id="btnsup">Help Us</button>           
        </div> 
```

按钮 CSS 示例：

```
#btnhome {  
    margin-left: 121px;
    margin-top: 1px;
    width: 84px;
    height: 45px;   
    background: transparent;
    border: none;
    color: white;   
    font-size:14px;
    font-weight:700;
} 
```

这些按钮也适用于标题背景，我确信它与这些设置有关：

```
#header {
    background-image: url(images/navbar588.png);
    height: 48px;
    width: 588px;
    margin: 2em auto;   
    } 
```

它运作良好，但唯一的问题是所有其他按钮也将其文本向下移动？这是为什么？我不是清楚地澄清我只想使用#btnhome 吗？所有按钮都有完全不同的 ID。除边距外，所有按钮都具有相同的 CSS 设置。我需要编辑什么？

非常感谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-22T00:10:39.153

正如我所料，是的，这是因为整个 DOM 元素都被下推了。您有多种选择。您可以将按钮放在单独的 div 中，`float`这样它们就不会相互影响。更简单的解决方案是将`:active`按钮设置为`position:relative;`并使用`top`而不是边距或行高。小提琴示例：http: [//jsfiddle.net/5CZRP/](http://jsfiddle.net/5CZRP/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:59:32.353

尝试将 line-height 更改更改为 margin-top 或 padding-top 更改

```
#btnhome:active{
margin-top : 25px;
} 
```

编辑：您也可以尝试在按钮内添加一个跨度

```
<div id="header">           
    <button id="btnhome"><span>Home</span></button>          
    <button id="btnabout">About</button>
    <button id="btncontact">Contact</button>
    <button id="btnsup">Help Us</button>           
</div> 
```

然后样式

```
#btnhome span:active { padding-top:25px;} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-21T23:58:59.130

使用边距而不是行高，然后将浮动应用于按钮。默认情况下，它们显示为`inline-block`，因此当一个人被推下时，洞线被他推下。浮动解决了这个问题：

```
#header button {
    float:left;
} 
```

这是一个有效的[jsfiled](http://jsfiddle.net/3pc6K/)。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2015-04-23T08:56:20.277

```
[type=submit]{
    margin-left: 121px;
    margin-top: 19px;
    width: 84px;
    height: 40px;   
    font-size:14px;
    font-weight:700;
} 
```

# cordova - Phonegap 2.2 moveTo() 无法执行回调

> ID：13998678
> 
> 赞同：0
> 
> 时间：2012-12-21T23:49:35.987
> 
> 标签：cordova

我正在使用 navigator.camera.getPicture api 调用的以下代码：

```
function getImageURI(imageURI) {
    //resolve file system for image to move.
    window.resolveLocalFileSystemURI(imageURI, gotPicture, function(error) {onfail(error,'Get Target Image');}); 

function gotPicture(targetImg) {    
    //move the image into the post_(n) directory.
    targetImg.moveTo(Globals.POSTDIR_OBJ,Utils.getImageName(), moveSuccess2, function(error){alert('Move Error')} ); 

        function moveSuccess2(){
            alert('addPicture moveSuccess');

            //update the picture counts in the client and DB.
            Globals.pictCount++;
            updateFilesById();
            setTimeout("Gallery.show()",500);  
        };
    }; //gotPicture 

}; //getImageURI 
```

问题是大约 30% 的时间没有调用成功或失败回调函数。

移动其实每次都是成功的，但是成功函数执行失败的时间大约有1/3。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T03:30:01.250

只是想对这个进行疯狂的猜测。我的猜测是，由于成功回调的异步性质，有时由于线程的不可预测性，尚未定义成功函数。尝试将 moveSuccess2 函数的声明移动到某个地方，它的声明将始终在调用 moveTo 函数之前完成。这可能意味着声明为 gotPicture 函数之外的函数，或者声明为像错误处理程序一样的匿名函数，或者在调用 moveTo 之前声明它。

# java - 无法理解这个jdbc，ibatis错误

> ID：13998680
> 
> 赞同：0
> 
> 时间：2012-12-21T23:50:32.647
> 
> 标签：java, sql, hibernate, jakarta-ee

我是 JDBC，iBatis 的菜鸟。我试图让我的 Java EE 应用程序在 sql 服务器上执行存储的过程，但是服务器抛出了一个奇怪的错误，这对我来说没有任何意义。有人可以帮我理解我做错了什么。

这是错误：

```
20121221 18:42:38:960 [CONFERENCE] INFO  320 AppController             - Error : Error Occurred while Speakers List data retrival: SqlMapClient operation; bad SQL grammar []; nested exception is com.ibatis.common.jdbc.exception.NestedSQLException:   
--- The error occurred in com/ABCD/conference/model/Conference.xml.  
--- The error occurred while applying a parameter map.  
--- Check the conference_get_speakers-InlineParameterMap.  
--- Check the statement (update procedure failed).  
--- Cause: com.microsoft.sqlserver.jdbc.SQLServerException: Could not find stored procedure 'imconference..conference_get_speakers'.
20121221 18:42:38:960 [CONFERENCE] INFO  323 AppController             - handleException >> 
```

这是xml文件中的映射：

```
<resultMap id="result-speakers" class="com.jpmorgan.conference.model.Attendee">
    <result property="confId" column="conf_Id" />       
    <result property="attendeeId" column="attendee_id" />
    <result property="firstName" column="first_name" />
    <result property="lastName" column="last_name" />
</resultMap>
<procedure id="getSpeakers" resultMap="result-speakers">
    {call
    imconference..get_speakers_details(#confId#)}
</procedure>                   
<procedure id="conference_get_speakers" resultMap="result-speakers">
    {call           
    imconference..conference_get_speakers(#confId#)}
</procedure> 
```

我能够在数据库上独立执行存储过程。我想我在映射 xml 文件时犯了一个错误。任何帮助，想法将不胜感激。如果你们需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-26T15:34:15.243

指示如何调用存储过程的一般形式应具有以下形式。

```
{call dbname.procname(#param#} 
```

我可以看到，从你的句子中删除一个点应该会产生魔力。

# css - 将子设置为内容宽度，忽略父宽度，并使父滚动

> ID：13998682
> 
> 赞同：2
> 
> 时间：2012-12-21T23:50:53.063
> 
> 标签：css

仅使用 CSS，是否可以获得以下示例[http://jsfiddle.net/LdJ7t/](http://jsfiddle.net/LdJ7t/)，而无需事先明确知道子元素的宽度？

期望的最终结果：

*   父元素可滚动到子元素
*   子元素的宽度设置为内容

![可滚动到子内容的父元素](../Images/25c2dd23e03e9ddff4e0f04a15052798.png)

```
#Parent {
    width: 100px;
    height:200px;
    background: #ccc;
    overflow:auto;
    padding: .5em;
    margin: .5em;
}

#Child {
    width:300px;
    height:100px;
    background:yellow;
}​

<div id="Parent">
    <div id="Child">
        This is a test. This is a test.
    </div>
</div>​ 
```

看起来`display:inline-block;`几乎可以工作：http: [//jsfiddle.net/LdJ7t/1/](http://jsfiddle.net/LdJ7t/1/)

我认为这是可能的。我只是找不到解决方案。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T00:00:53.083

您的`inline-block`解决方案是正确的 - 如果您将较长的文字或图像放入，则会出现滚动条。默认情况下，文本在空白处被破坏。

如果您不希望文本在空白处中断，您可以`white-space: nowrap;`像这里一样添加到子 div：http: [//jsfiddle.net/LdJ7t/2/](http://jsfiddle.net/LdJ7t/2/)

# html - 引导/下拉按钮

> ID：13998683
> 
> 赞同：5
> 
> 时间：2012-12-21T23:51:00.033
> 
> 标签：html, twitter-bootstrap

您好我正在尝试使用引导程序创建一个下拉按钮。但它似乎没有正确出来？

```
<div class="btn-group">
    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        Action
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">Foo</a></li>
        <li><a href="#">Bar</a></li>
    </ul>
</div> 
```

一个 jsfiddle 在这里[http://jsfiddle.net/UrgP8/](http://jsfiddle.net/UrgP8/)

有任何想法吗 ？

谢谢，

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-22T00:40:03.697

通过将几乎完整的 boostrap html 源代码粘贴到 html 视图中，您将大量外部资源加载到 jsfiddle 中。

这是一个更简单的版本，它只加载三个外部文件。

[http://jsfiddle.net/BqKNV/65/](http://jsfiddle.net/BqKNV/65/)

基本 html 是相同的（所以不会让我在不输入代码的情况下发布......）

```
<div class="dropdown btn-group">
    <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
        Action
        <span class="caret"></span>
    </a>
    <ul class="dropdown-menu">
        <li><a href="#">Foo</a></li>
        <li><a href="#">Bar</a></li>
    </ul>
</div> 
```

请注意，jQuery 是通过 jsFiddle 的框架面板加载的，bootstrap css 和 js 是通过[BootstrapCDN](http://www.bootstrapcdn.com/)加载的：

//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css
//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/js/bootstrap.min.js

* * *

如果将此 html 保存为页面并在浏览器中运行会发生什么？

```
<!DOCTYPE html>
    <html>
    <head>
      <meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <title> - jsFiddle demo</title>
      <script type='text/javascript' src='http://code.jquery.com/jquery-1.8.2.js'></script>
        <script type='text/javascript' src="http://twitter.github.com/bootstrap/assets/js/bootstrap.min.js"></script>
        <link rel="stylesheet" type="text/css" href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css">
    </head>
    <body>
      <div class="dropdown btn-group">
        <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">
            Action
            <span class="caret"></span>
        </a>
        <ul class="dropdown-menu">
            <li><a href="#">Foo</a></li>
            <li><a href="#">Bar</a></li>
        </ul>
      </div>
    </body>
    </html> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-22T00:55:32.317

好的，发现您的小提琴中似乎存在问题。

这是您正在加载：

```
<link href="http://flip.hr/css/bootstrap.min.css" rel="stylesheet" type="text/css" /> 
```

我将其更改为：

```
<link href="http://twitter.github.com/bootstrap/assets/css/bootstrap.css" rel="stylesheet" type="text/css" /> 
```

这基本上解决了它。你可以在这里看到它：http: [//jsfiddle.net/6hPMb/1/](http://jsfiddle.net/6hPMb/1/)

* * *

但除此之外，我在评论中提到的问题仍然存在，您正在加载**bootstrap-dropdown.js**和**bootstrap.min.js**

你应该只使用一个。

# android - 如何禁用 onCreateOptionsMenu

> ID：13998685
> 
> 赞同：0
> 
> 时间：2012-12-21T23:51:24.597
> 
> 标签：android, eclipse, eclipse-juno

我刚开始使用 Juno，我想知道这个方法到底是什么。而且自从我

不要使用它，我不希望每次创建项目时都创建它。我怎样才能禁用她？

```
 @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T23:57:49.237

所有这一切都是创建您的菜单，当您按下菜单键时会显示该菜单。它也可能会显示在操作栏中，具体取决于您的应用程序的设置方式和运行它的 API 版本。除非您有想要以这种方式向用户显示的额外选项，否则不需要它。

默认情况下，此方法是从 ADT 活动模板创建的。

# python - 在数百万行的文件之间查找常用短语

> ID：13998693
> 
> 赞同：1
> 
> 时间：2012-12-21T23:52:23.893
> 
> 标签：python

我有两个具有以下行数的文件：

```
file1 - 110433003
file2 - 4838810 
```

我需要在这些之间找到常用短语。每行的形式为：

p1 ||| p2 ||| …………

file1 的 p1 可以是 file2 中的 p2。不幸的是，我编写的代码要花很长时间才能做到这一点。

```
import sys
import os

if(len(sys.argv)<2):
        print 'python CommonPhrases.py enFr hrEn commonFile'
        sys.exit()
enFr = open(sys.argv[1],'r')
hrEn = open(sys.argv[2],'r')
common = open(sys.argv[3],'w')
sethrEn = set([])
setenFr= set([])
for line in hrEn:
        englishPhrase = line.split(' ||| ')[1]
        sethrEn.add(englishPhrase)

for line in enFr:
        englishPhrase = line.split(' ||| ')[0]
        if(englishPhrase in sethrEn):
                common.write(englishPhrase+'\n') 
```

有没有更快的方法来做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:55:59.533

这听起来像一个树问题。也许这个想法可以帮助你。

使用树可以帮助找到常用词。我认为基于创建树的想法可以有两种解决方案。

一棵树，一旦实现，将需要存储一个文件（只有一个文件）的每个单词。然后，开始读取第二个文件并在树中搜索该文件中的每个单词。

当然，这个解决方案有一些问题。在内存中存储这么多字（或行）的树可能需要大量 MB 的 RAM。

假设您设法使用固定数量的 RAM 来存储数据，因此，只计算数据本身（行的字符）。在最坏的情况下，您将需要 255^N 个字节，其中 N 是最长行的长度（假设您使用 almos 每个单词组合的 N 扩展）。因此，存储长度为 10 的字的所有可能组合，您将需要 1.16252367019e+24 字节的 RAM。那是很多。请记住，这个解决方案（据我所知）是“快的”，但需要的 RAM 可能比你能找到的更多。

所以，其他解决方案，非常非常慢，是读取文件 A 的一行，然后将其与文件 B 的每一行进行比较。它几乎不需要 RAM，但需要太多时间，也许你无法做到真的等待它。

所以，也许另一种解决方案是划分问题。

你说你有一个行列表，我们不知道它们是否按字母顺序排序。因此，也许您可​​以开始读取文件 A，并创建新文件。例如，每个新文件都将存储“A”起始行，其他以“B”开头的行等。然后，对文件 B 执行相同操作，结果是两个以“A”开头的文件行，一个用于原始 A 文件，另一个用于原始 B 文件。然后，将它们与一棵树进行比较。

在最好的情况下，行将被平均划分，让您在内存中使用树。在最坏的情况下，您将只完成一个文件，与起始 A 文件相同，因为可能所有行都以“A”开头。

因此，也许，如果文件仍然太大，您可以实现一种方法来划分更多文件，首先，按行上的第一个字符。然后，'A'开始行，将它们划分为'AA'，'AB'，'AC'等，当然，删除之前的划分文件，直到文件足够小，可以使用更好的方法搜索相同行（也许在内存上使用树）。

此解决方案也可能需要很长时间，但可能不会像低内存选项那样长，而且不需要太多内存即可工作。

这些是我此刻能想到的解决方案。也许他们工作，也许没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:50:00.923

你肯定需要尝试这样的事情。似乎您将花费大部分时间来寻找匹配的集合。

此外，每次我发现自己试图让 python 运行得更快时，我都会切换到 pypy。( [http://pypy.org/](http://pypy.org/) ) 设置起来非常简单（只需下载二进制文件，将其放入路径中，然后将 #!/usr/bin/env python 更改为 #!/usr/bin/env pypy）和为此类任务提供 5-10 倍的加速。

有关使用 PyTrie 的参考实现，请参见下文。

```
#!/usr/bin/env pypy

import sys
import os
sys.path.append('/usr/local/lib/python2.7/dist-packages/PyTrie-0.1-py2.7.egg/')
from pytrie import SortedStringTrie as trie

if(len(sys.argv)<2):
        print 'python CommonPhrases.py enFr hrEn commonFile'
        sys.exit()
enFr = open(sys.argv[1],'r')
hrEn = open(sys.argv[2],'r')
common = open(sys.argv[3],'w')

sethrEn = trie()

for line in hrEn:
        englishPhrase = line.strip().split(' ||| ')[1]
        sethrEn[englishPhrase] = None

for line in enFr:
        englishPhrase = line.strip().split(' ||| ')[0]
        if(englishPhrase in sethrEn):
                common.write(englishPhrase+'\n') 
```

请注意，它需要最少的更改（4 行），并且您需要安装 PyTrie 0.1。在我的 ubuntu 系统上，“sudo easy_install PyTrie”成功了。

希望有帮助。

# php - PHP 中的 preg/正则表达式

> ID：13998698
> 
> 赞同：1
> 
> 时间：2012-12-21T23:52:54.523
> 
> 标签：php, regex, html-parsing, preg-replace

我在使用正则表达式时遇到问题。从来没有完全理解它真正的问题是：有没有人有一个很好的网站来解释表达之间的区别，而不是仅仅发布类似的东西

```
$regexp = "/^[^0-9][A-z0-9_]+([.][A-z0-9_]+)*[@][A-z0-9_]+([.][A-z0-9_]+)*[.][A-z]{2,4}$/"; 
```

然后喋喋不休地说那条线作为一个整体会做什么。而不是每个表达式会做什么。我试过用谷歌搜索许多不同版本的 preg_replace 和 regex 教程，但他们似乎都假设我们已经知道像 \b[^>]* 这样的东西会做什么。

次要的。我试图这样做的原因：我想转

```
<span style="color: #000000">*ANY NUMBER*</span> 
```

进入

```
<span style="color: #0000ff">*ANY NUMBER*</span> 
```

我已经尝试过的一些变体有些只是没有用，有些使脚本变得废话。

```
$data = preg_replace("/<span style=\"color: #000000\">([0-9])</span>/", "<span style=\"color: #FFCC00\">$1</span>", $data);//just tried to match atleast 0-9

$data = preg_replace("/<span style=\"color: #000000\"\b[^>]*>(.*?)</span>/", "<span style=\"color: #FFCC00\">$1</span>", $data);

$data = preg_replace("/<span style=\"color: #000000\"\b[^>]*>([0-9])</span>/", "<span style=\"color: #FFCC00\">$1</span>", $data); 
```

这个特定问题的答案对我来说并不像网站那么重要，所以检查一下。尝试了很多不同的网站，我很确定它不会超出我的理解范围，我只是找不到适合所有糟糕教程/示例农场的好东西。w3 和 phpdotnet 的正常后备没有我这次需要的东西。

**EDIT1**对于那些最终在这里寻找类似答案的人：

```
$data = preg_replace("/<span style=\"color: #000000\">([0-9]{1,})<\/span>/", "<span style=\"color: #FFCC00\">$1</span>", $data); 
```

做了它需要做的事。可悲的是，这是我尝试的第一件事，但是因为我没有放 </span> 而不是它不起作用，而且我不知道“[0-9]{1,}”是否是匹配任何内容的最合适的方式number （告诉它匹配任何整数 0-9 与 [0-9] 至少一次和尽可能多次与 {1,} 它仍然符合目的）

ROY Finley 发布： http: [//www.macronimous.com/resources/writing_regular_expression_with_php.asp](http://www.macronimous.com/resources/writing_regular_expression_with_php.asp) 它是一个很好的站点，其中包含表达式定义列表和下面的一个很好的示例处理。

另外：regular-expressions.info/tutorial.html 被发布了几次。它是一个更慢更深入的步行，但如果你像我一样被困住，那就太好了。

在我有机会玩它们之后，会弹出关于 regex101 和解析器的信息。

**EDIT2** DWright 在“掌握正则表达式”下面发布了一个书籍链接。如果您查看正则表达式并且无法确定字符卷积的头部或尾部，那么绝对值得选择它。花了大约一个半小时阅读了大约一半，但与花在谷歌上的时间和用来避免它的混乱工作相比，这根本不算什么。

下面链接的 html 解析也适用于这个特定问题。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-21T23:56:06.763

要解释正则表达式，您可以查看[Regex101](http://www.regex101.com)。要真正学习正则表达式（我推荐），[这是一个非常好的、深入的教程](http://www.regular-expressions.info/tutorial.html)。读完之后，[PHP.net 上的 PCRE 文档](http://php.net/manual/en/reference.pcre.pattern.syntax.php)似乎不再晦涩难懂，阅读它将帮助您了解 PHP 的一些特定差异。

但是，对于手头的问题，[您实际上根本不应该使用正则表达式](https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454)。DOM 解析器是要走的路。[这](http://simplehtmldom.sourceforge.net)是一个非常方便使用的 3rd 方，[这](http://php.net/manual/en/book.dom.php)就是 PHP 自带的。正如 hakre 所提到的，[这里有一个更广泛的可用于此目的的库列表](https://stackoverflow.com/questions/3577641/how-to-parse-and-process-html-xml-with-php/3577662#3577662)。

PHP 中正则表达式的另一个一般建议：使用单引号`'/pattern/'`，因为双引号会给转义序列带来很多麻烦（否则你需要加倍一些反斜杠）。

最后，您收到错误的原因是您的正则表达式分隔符（您使用`/`）显示在您的模式中（在结束`span`标记中）而没有被转义。这意味着引擎认为模式在第一个结束`/`并且`span>/`是 6 个不同的修饰符（其中大部分实际上并不存在）。您可以`<\/span>`像`'~yourPattern/Here~'`.

**编辑：**自从我发布这个答案以来，已经发布了两个新网站，它们试图通过可视化来解释正则表达式。现在他们只支持（相当有限的）JavaScript 风格，但这是一个很好的起点：

*   [正则表达式](http://www.regexper.com/)
*   [调试器](http://www.debuggex.com/?re=&str=)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-21T23:55:59.023

[http://www.macronimous.com/resources/writing_regular_expression_with_php.asp](http://www.macronimous.com/resources/writing_regular_expression_with_php.asp)

看看这个。它似乎涵盖了相当不错的过程。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-21T23:57:43.697

试试这个[网站](http://www.regular-expressions.info/tutorial.html)，也许。就个人而言，我想说如果你真的对正则表达式感兴趣，那么值得买一本这样的[书](https://rads.stackoverflow.com/amzn/click/com/0596528124)。

# filenotfoundexception - Xinput.h：没有这样的文件或目录

> ID：13998701
> 
> 赞同：1
> 
> 时间：2012-12-21T23:53:46.490
> 
> 标签：filenotfoundexception, xbox, xinput

我正在尝试从 xbox 控制器获取输入，我去了这个页面：

[http://www.codeproject.com/Articles/26949/Xbox-360-Controller-Input-in-C-with-XInput](http://www.codeproject.com/Articles/26949/Xbox-360-Controller-Input-in-C-with-XInput)

我只是在测试运行他的源代码，我做了一件好事，因为它发现了一个错误：

```
C:\Users\me;)\Desktop\XBOX360Test\XBOX360Test\CXBOXController.h|9|fatal error: Xinput.h:  No such file or directory| 
```

我可以不知道问题是什么，Xinput 不附带 Windows 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-07T10:34:36.740

我知道晚了，但我得到了同样的错误。在 Visual Studio 中打开项目可以正常工作，但使用 gcc 编译则不行。似乎 VS 的编译器比 gcc 知道的更多，你需要用那个编译它。方法如下：http: [//msdn.microsoft.com/en-us/library/ms235639 (v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/ms235639(v=vs.80).aspx)

# android - 应用内购买无法完全正常工作

> ID：13998702
> 
> 赞同：1
> 
> 时间：2012-12-21T23:53:47.607
> 
> 标签：android

我刚刚编写了一个测试应用程序来测试应用程序购买，它只是一个测试应用程序，你必须按下一个按钮，然后你购买一个“高级”会员资格，这将使该按钮不可见（这只是一个测试应用程序）

所以当我的朋友按下按钮后，他得到了支付屏幕，他支付了，但是当他回到应用程序时，按钮仍然存在

这就是我开始购买的方式

```
 // User clicked the "Upgrade to Premium" button.
    public void onUpgradeAppButtonClicked(View arg0) {
        Log.d(TAG, "Upgrade button clicked; launching purchase flow for upgrade.");
   //     setWaitScreen(true);
        mHelper.launchPurchaseFlow(this, SKU_PREMIUM, RC_REQUEST,   mPurchaseFinishedListener);
    } 
```

以及购买完成时

```
// Callback for when a purchase is finished
IabHelper.OnIabPurchaseFinishedListener mPurchaseFinishedListener = new IabHelper.OnIabPurchaseFinishedListener() {
    public void onIabPurchaseFinished(IabResult result, Purchase purchase) {
        Log.d(TAG, "Purchase finished: " + result + ", purchase: " + purchase);

        int duration = Toast.LENGTH_SHORT;
        if (result.isFailure()) {
            // Oh noes!
         //   complain("Error purchasing: " + result);
         //   setWaitScreen(false);
            Toast.makeText(getBaseContext(), "Failed to purchase", duration).show();
            return;
        }

        Log.d(TAG, "Purchase successful.");

        if (purchase.getSku().equals(SKU_PREMIUM)) {
            // bought the premium upgrade!
            Log.d(TAG, "Purchase is premium upgrade. Congratulating user.");
          //  alert("Thank you for upgrading to premium!");
            mIsPremium = true;

            Toast.makeText(getBaseContext(), "You are now premium", duration).show();
            Button test = (Button) findViewById(R.id.test);
            test.setVisibility(View.INVISIBLE);
          //  updateUi();
         //   setWaitScreen(false);
        }
    }
}; 
```

代码取自谷歌提供的示例应用程序，我删除了我不需要的部分，也许我删除了一些需要的东西？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-25T04:10:51.280

实际上，您还必须将`onActivityResult`示例活动中的方法复制到您的活动中。完成此操作后，它应该可以工作。

# database - DynamoDB - 查询查找表

> ID：13998703
> 
> 赞同：0
> 
> 时间：2012-12-21T23:53:55.560
> 
> 标签：database, amazon-web-services, amazon-dynamodb

我刚刚开始在 DynamoDB 中构建一个社交网站。

我将拥有大量与用户相关的数据，并且我计划将所有这些数据放入一个表中 - 例如：

*   用户身份
*   出生日期
*   头发
*   照片网址
*   细节

等等 - 可能有几百个属性。

问题：

*   把这么多数据放到一张表里有什么问题吗？
*   我如何查询该数据（我可以进行这样的查询“这个年龄，这个颜色头发，这个位置，并且这次登录的所有成员） - 假设所有这些数据都包含在表中？
*   如果表的内容很长，并且我正在像上面那样对该表运行查询，那么读取 IO 的成本是否会很高 - 从长远来看，表中可能会有很多条目......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:08:19.610

不可以。您不能以这种方式查询 DynamoDB。您只能查询主键（以及可选的单个范围）。扫描 DynamoDB 中的表既慢又昂贵，并且会导致您的其他查询挂起。

如果您有少量属性，您可以轻松地为这些属性创建索引表。但是如果你有多个，它就会变得太复杂。

主表：

```
Primary Key (Type: Hash) - userid
Attributes - the rest of the attributes 
```

“头发”的索引表：

```
Primary Key (Type: Hash and Range) - hair and userid 
```

您可以查看为其他属性添加索引的[Amazon SimpleDB](http://aws.amazon.com/simpledb/)，从而允许您根据需要进行此类查询。但它的规模和支持低延迟的能力有限。

您还可以考虑结合使用多个数据存储和表格，因为您的实时和报告要求不同：

*   用于快速实时用户查找的 DynamoDB
*   SimpleDB/RDBMS（如 MySQL 或[Amazon RDS](http://aws.amazon.com/rds/)）用于附加属性过滤器和查询
*   在内存数据库（如 Redis、Casandra）中用于计数器和表格作为排行榜或群组
*   您可以分析以发现模式和趋势的活动日志

# actionscript-3 - 计算复杂字符串中关键字数量的其他方法

> ID：13998705
> 
> 赞同：1
> 
> 时间：2012-12-21T23:54:47.483
> 
> 标签：actionscript-3, flash, actionscript

我正在阅读一个包含大约 1200 个单词的文件，格式如下：

> 词：a:/zenb:/fixx:/wew:/sina:/benb:/sixx:/hew:/bin

我需要找到该文本文件中有多少关键字，我的意思是关键字：

> 禅修我们罪本六和斌

现在我正在尝试像这样使用 RegExp 来做到这一点：

```
var s:String = "words:b:sa:/zenb:/fixx:/wew:/sina:/benb:/sixx:/hew:/bin";
var pattern:RegExp = /:/+/g;
var results:Array = s.match(pattern);
trace(results.length); 
```

它产生一个错误，因为我是一个初学者，我真的不明白这个 RegExp 是如何工作的，有没有其他方法可以得到相同的结果？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:00:14.047

您`var pattern:RegExp = /:/+/g;`有语法错误，您跳过了反斜杠，将其`\`更改为：

```
var pattern:RegExp = /:\/+/g; 
```

它应该可以工作，或者使用这种格式，您可以使用字符串拆分方法来获取总字数。尝试这个：

```
var s:String = "words:b:sa:/zenb:/fixx:/wew:/sina:/benb:/sixx:/hew:/bin";
var wordCount:Number = s.split(":/").length -1;
trace( wordCount ); 
```

希望有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T08:37:50.053

```
package
{
    import flash.display.Sprite;

    public class CountWordsExample extends Sprite
    {
        public function CountWordsExample()
        {
            super();
            // 8 7 0
            trace(countWords(
                "words:b:sa:/zenb:/fixx:/wew:/sina:/benb:/sixx:/hew:/bin",
                ":/"),
                countWords(
                    "words:b:sa:/:/fixx:/wew:/sina:/benb:/sixx:/hew:/bin",
                    ":/"),
                countWords(
                    "words:b:sa::zenb::fixx::wew::sina::benb::sixx::hew::bin",
                    ":/"));
        }

        public static function countWords(words:String, delimiter:String, 
                                          countBlanks:Boolean = false):uint
        {
            var result:uint;
            var wordPointer:int = -1;
            var delimiterPointer:int;
            var delimiterLength:uint = delimiter.length;

            if (words.length >= delimiterLength)
            {
                do
                {
                    delimiterPointer = wordPointer;
                    wordPointer = words.indexOf(
                        delimiter, wordPointer + delimiterLength);
                    if (countBlanks || 
                        // we moved by more characters, then the length of
                        // delimiter
                        wordPointer - delimiterLength > delimiterPointer) 
                        result++;
                }
                while (wordPointer > -1)
            }
            return result;
        }
    }
} 
```

这是一个如何在不创建原始字符串的其他数组或子字符串的情况下计算单词的示例。它还验证计数的单词是否具有至少一个字符长度。

# php - php长查询执行

> ID：13998708
> 
> 赞同：0
> 
> 时间：2012-12-21T23:55:22.063
> 
> 标签：php

我运行了一个大约需要 20 分钟才能完成的过程，我只是想知道 PHP 是否可以在该过程完成之前保持连接处于活动状态。

需要明确的是，这个页面会有一个按钮，当你按下它时，它会调用一个 php 页面来运行一个 sql 查询，在主页面中我只是等待 Http 请求完成以发送成功消息。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:47:34.967

对于设置为占用一些时间的查询，您应该将一些自动化请求移动到组合中，如果您可以访问 linux 服务器，最好是 cronjobs。

使用 cronjobs，您可以在数据库中为特定值创建条目，链接到用户。如果挂起的查询已完成，cronjob 将启动，每 5 分钟执行一次查询。这将最大限度地减少用户需要坐在页面上直到完成的事实。因为您应该知道，用户离开活动页面的那一秒；所有活动连接、查询等都将停止。

脚本完成后，在最后制作一条自定义消息发送给用户，让他们知道他们的过程已经完成。

您还应该知道，PHP 从第 1 行到最后执行脚本；因此，例如，如果您的挂起在第 40 行；该脚本将位于该行，直到查询完成然后继续处理。

**编辑：这仅是为了向您指出我要达到的方向，而不应该像您看到的那样使用它。这只是一个标记示例**

```
<?php
    if (isset($_POST['ButtonToExecute']))
    {
        // Query to update a table in your database which an external PHP script will work with
        // Example Table Structure:
        /*
            Username
            State

        */
        if ($state == 0)
        {
            // Then update state to 1 with username to the username for the query to take place on

        }
        else
        {
            // Warn user that their process will take longer to complete as their already is an active query in process
            // but add them to a secondry pipeline which will be picked up on the next cronjob interval
        }
    }
?> 
```

在您的 cronjob 中，可能有：

```
<?php

if ($state=='1')
{
    // Execute your script
    // After query execution update state to 2

    // if state == 2 then insert custom message/email to send
}

?> 
```

编辑您的 crontab：

```
yourpreferrededitor /etc/crontab 
```

^ yourpreferrededitor 表示您的文本编辑器，无论是 nano 还是其他。

和你的 cronjob 行：

```
* * * * *  root /usr/bin/php /var/www/cron.php 
```

^ 这取自我每天每一分钟都在不断运行的当前 cronjob

*Cronjob 将使用户能够离开页面，因为正如我上面提到的，用户离开脚本的第二秒......所有正在进行的进程都会停止。cronjob 将继续运行，无需用户交互（除了他们发出初始请求）*

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:43:59.950

如果您设置超时限制并忽略用户中止，您可以在普通的 php 脚本中执行此操作，但这是一个坏主意，因为如果脚本有效，您的用户将没有任何反馈。

在我工作的公司，我们遇到了同样的问题我们做了什么：

1.  在单独的脚本中运行查询。
2.  在不等待结果的情况下启动脚本
3.  将查询拆分为多个部分（使用限制和偏移）
4.  让查询脚本将消息写入临时文件
5.  实现一个状态屏幕，通过 ajax 从日志中获取当前状态

顺便说一句，所有智者的例子都在问为什么需要这么长时间：

如果您必须处理具有数百万个节点的树但构建它可能需要几个小时，那么使用[传递外壳](http://en.wikipedia.org/wiki/Transitive_closure)可以大大加快您的应用程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:08:43.963

在您的 PHP ini 中，您可以设置脚本的最大执行时间，但是您永远不希望用户在页面加载屏幕上坐那么久。

我可以建议的一件事是将您的最大执行时间增加到大约 30 分钟，然后在页面已经呈现后在 javascript 中调用它，这样用户就不会被留在黑暗中不知道脚本是什么正在做。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-21T23:58:21.403

你可以试试：

```
set_time_limit(0); 
```

您可能想看看[设置时间限制](http://php.net/manual/en/function.set-time-limit.php)

# php - 验证没有重定向的表单

> ID：13998709
> 
> 赞同：0
> 
> 时间：2012-12-21T23:55:24.827
> 
> 标签：php, javascript, jquery, yii, fancybox

我用 yii 创建了应用程序，我需要在 Fancy-box 中加载一个视图表单。
我这样做了，但我的问题是当我单击提交按钮时，表单将我重定向到控制器操作而不验证表单。

如何在 Fancy-box 内没有重定向的情况下验证表单？

我的观点：

```
<?php
    $config = array( 
);

$this->widget('application.extensions.fancybox.EFancyBox', array(
'target'=>'#getaction',
'config'=>$config,));

echo CHtml::link('Add Section',array('section/create'),array('id'=>'getaction'));
?> 
```

FormView _from 来自另一个视图的调用

```
<div class="form">

<?php $form=$this->beginWidget('CActiveForm', array(
    'id'=>'section-form',
    'enableAjaxValidation'=>true,
)); ?>

    <p class="note">Fields with <span class="required">*</span> are required.</p>

    <?php echo $form->errorSummary($model); ?>

    <div class="row">
        <?php echo $form->labelEx($model,'name'); ?>
        <?php echo $form->textField($model,'name',array('size'=>60,'maxlength'=>255)); ?>
        <?php echo $form->error($model,'name'); ?>
    </div>

    <div class="row buttons">
        <?php echo CHtml::submitButton($model->isNewRecord ? 'Create' : 'Save'); ?>
    </div>

<?php $this->endWidget(); ?>

</div><!-- form --> 
```

控制器 ：

```
public function actionCreate()
{
    $model=new Section;       

    if(isset($_POST['Section']))
    {
        $model->attributes=$_POST['Section'];
        if($model->validate())
        //// Do Som code here 
            $this->redirect(array('view','id'=>$model->id));
    }

    $this->render('create',array(
        'model'=>$model,
    ));
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T19:40:24.717

我的兄弟 seeivasan 在 Yii 论坛上解决了这个问题，所以我将在这里分享代码

_form.php

```
<?php $form=$this->beginWidget('CActiveForm', array(
        'id'=>'section-form',
        'enableAjaxValidation'=>true,
        //'enableClientValidation'=>true,
        'clientOptions'=>array('validateOnSubmit'=>true), //This is very important
)); ?>

        <p class="note">Fields with <span class="required">*</span> are required.</p>

        <?php echo $form->errorSummary($model); ?>

        <div class="row">
                <?php echo $form->labelEx($model,'name'); ?>
                <?php echo $form->textField($model,'name',array('size'=>60,'maxlength'=>64)); ?>
                <?php echo $form->error($model,'name'); ?>
        </div>

        <div class="row buttons">
                <?php echo CHtml::submitButton($model->isNewRecord ? 'Create' : 'Save'); ?>
        </div>

<?php $this->endWidget(); ?> 
```

在控制器中

```
public function actionCreate()
        {
                $model=new Section;

                // Uncomment the following line if AJAX validation is needed
                 $this->performAjaxValidation($model);//You have enabled ajax validation. You have to uncomment this line.

                if(isset($_POST['Section']))
                {
                        $model->attributes=$_POST['Section'];
                        if($model->save())
                                $this->redirect(array('view','id'=>$model->id));
                }

                if(Yii::app()->request->getIsAjaxRequest())
          echo $this->renderPartial('_form',array('model'=>$model),true,true);//This will bring out the view along with its script.

                else $this->render('create',array(
                        'model'=>$model,
                ));
        } 
```

参考链接：

[Yii 论坛](http://www.yiiframework.com/forum/index.php/topic/38740-load-view-with-fancybox/page__p__186260__fromsearch__1#entry186260)

![花式盒子](../Images/33728d99559945e3b9d9b6abf4fb7cff.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T11:19:08.063

只需`'enableClientValidation'=>true,`在`beginwidget`.

# python - 为 MS-SQL 创建不区分大小写的 SQLAlchemy 查询

> ID：13998712
> 
> 赞同：1
> 
> 时间：2012-12-21T23:55:34.497
> 
> 标签：python, sql-server, sqlalchemy

我目前正在尝试将专为 MySQL 数据库设计的程序转移到 MS-SQL 数据库上，但遇到了一些麻烦。我发现 MySQL 默认情况下不像 MS-SQL 那样区分大小写。这导致类似于下面列出的代码出现一些问题。

```
class Employee(Base):
    __tablename__ = "Employees"
    Id = Column(Integer(unsigned=True),
                primary_key=True, nullable=False, unique=True)
    DisplayName = Column(String(64),
                         nullable=False)
    #more columns

def get_employees(sql_session, param, columns=None, partial_match=True):
    if not columns:
        columns = [Employee.Id, Employee.DisplayName]
    clauses = []

    if partial_match:
        clauses.append(Employee.DisplayName.startswith(param))

    whereclause = and_(*clauses)
    stmt = select(columns, whereclause)
    return sql_session.execute(stmt) 
```

我知道 SQL 关键字 COLLATE，但我不确定如何实现它，或者它是否是在这种情况下使用的最佳选择。对于使用 SQLAlchemy 创建不区分大小写的 LIKE 查询，您会给出什么建议？

*   Python 2.7.7
*   SQLAlchemy 0.7.7

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:45:16.817

这有点奇怪，根据我的经验，MS SQL Server 默认情况下不区分大小写，尽管您可以选择使用数据库的排序规则设置将其设置为区分大小写。

您可以`COLLATE`与 SqlAlchemy 一起使用（请参见[此处](http://docs.sqlalchemy.org/en/rel_0_7/core/expression_api.html#sqlalchemy.sql.expression.collate)），因此您应该可以这样做（我自己没有尝试过）：

```
clauses.append(Employee.DisplayName.startswith(collate(param, 'SQL_Latin1_General_CP1_CI_AS'))) 
```

SQL Server 还支持与`LIKE`查询进行类似正则表达式的模式匹配，因此您也可以在参数值中使用它，例如`'[vV]alue%'`

# hibernate - 强制休眠删除连接表行

> ID：13998721
> 
> 赞同：0
> 
> 时间：2012-12-21T23:56:39.800
> 
> 标签：hibernate, one-to-many, many-to-one, cascading-deletes

我有点困惑，因为我不能强制 Hibernate 删除连接表中的行。可能我需要配置一些不同的东西。

我有一个表 Component 和 Task 以及一个连接它们 Component_Tasks 的表。在我的课堂组件中，我有：

```
@OneToMany(cascade = CascadeType.ALL)
@JoinTable(name = "Component_Tasks",
           joinColumns = @JoinColumn(name = "ComponentID"), inverseJoinColumns = @JoinColumn(name = "TaskID"))
public List<Task> getTasks() {
    return tasks;
} 
```

在我的课堂任务中，我有

```
@ManyToOne
@JoinColumn(name = "ComponentID")
public Component getComponent() {
    return component;
} 
```

我想要的是，当我删除任务时，我默认删除 Component_Tasks 表中的下划线行。基本上我的删除因为外键关系而失败

```
ALTER TABLE Component_Tasks ADD FOREIGN KEY (TASKID)  REFERENCES Tasks (ID); 
```

我相信如果我将任务中的组件设置为 null 然后我保存对象然后尝试删除它，我可以实现相同的行为。但我希望 Hibernate 默认执行此操作。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T12:45:05.177

你的映射是错误的。在 Component 中，您是说 Component 和 Task 之间的关联是由连接表映射的。

在任务中，您是说相同的关联由任务表中的连接列映射。

下定决心。如果关联是 OneToMany 双向关联，通常不需要连接表，只需要

```
@OneToMany(cascade = CascadeType.ALL, mappedBy = "component")
public List<Task> getTasks() {
    return tasks;
} 
```

和

```
@ManyToOne
@JoinColumn(name = "ComponentID")
public Component getComponent() {
    return component;
} 
```

# ruby - 在 Ruby 中复制队列？

> ID：13998724
> 
> 赞同：1
> 
> 时间：2012-12-21T23:56:58.703
> 
> 标签：ruby, multithreading, queue

我需要一个[Queue](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/thread/rdoc/Queue.html)对象当前状态的副本来对其内容执行另一个操作。我不想打扰原始队列，只需复制它，然后在我运行线程时将其清空。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-21T23:59:04.693

您是否尝试过[#dup](http://ruby-doc.org/core-1.9.3/Object.html#method-i-dup)或[#clone](http://ruby-doc.org/core-1.9.3/Object.html#method-i-clone)？我不确定您是否需要在实际副本周围使用互斥锁，但这是一个起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-16T12:39:54.227

你也可以试试 deep_dive gem。

此外，请查看 queue_ding gem，因为它可以做一个 tee，从而消除了复制队列的需要。不过，T 恤必须在不同的螺纹中。

# c - malloc+strdup 是否会泄漏内存？

> ID：13998725
> 
> 赞同：2
> 
> 时间：2012-12-21T23:57:13.557
> 
> 标签：c, memory, memory-management, malloc, strdup

和：

```
char *x = malloc(1024);
strcpy(x, "asdf");
x = strdup(x);
free(x); // OK
free(x); // Segfault 
```

如果我只释放一次，我还会泄漏吗？如果是这样，如何避免呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T23:58:12.763

你泄漏内存是因为你忘记了第一个指针。像这样做：

```
char * x = malloc(1024);
strcpy(x, "asdf");
char * y = strdup(x);

free(x); 
free(y); 
```

# jekyll - 如何将 Jekyll 帖子分成两个不同的文件夹？

> ID：13998729
> 
> 赞同：9
> 
> 时间：2012-12-21T23:57:38.340
> 
> 标签：jekyll

我有一个`_posts`文件夹，我只是想要一种简单的方法将文件夹中的帖子分成两个不同的文件夹，并且没有任何永久链接更改，纯粹出于组织原因。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-25T18:02:34.927

只需在您的`_posts`目录中创建子目录；Jekyll 生成永久链接时，子目录将被忽略。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-12-08T18:09:38.530

我最近对我的 _posts 文件夹执行此操作，因为我有 200 多个文件。我决定创建代表我每年都有帖子的文件夹。但是这样做，破坏了 post_url。运行时错误如下`jekyll build`

> 液体异常：在标签“post_url”中找不到帖子“blah-blah”。确保帖子存在且名称正确。在_posts/2007/blah-blah.md

我不得不回去，在我使用过 post_url 的地方，我必须在每个帖子 url 链接前面添加 /year/。

[https://github.com/jekyll/jekyll/issues/1714#issuecomment-28167702](https://github.com/jekyll/jekyll/issues/1714#issuecomment-28167702)

# javascript - 通过点击更改元素，如 PHPAdmin

> ID：13998731
> 
> 赞同：1
> 
> 时间：2012-12-21T23:57:46.073
> 
> 标签：javascript, jquery, forms, text, phpmyadmin

我是js的初学者。我想做一个像 PHPAdmin 这样的编辑器。单击其表格时，该字段将变为文本区域。当单击文本区域之外的其他位置时，它将变回字段并执行 sql。

以下是我想用 jQuery 编写的内容，我完全不明白我应该如何进一步编码，请指教。

```
$('#editor #gird_edit').bind({
  click: function() { //When Click
      var content = $(this).text(); // read what is in the filed
      $("#gird_edit").text('<textarea>'+a+'</textarea>'); // This is not work, will only add html code,not change to text-area
  },
  /* ??? */: function() { //Outside click of the text-area 
      var content = $(this).text(); // read what is in the text-area
      $("#gird_edit").text(????);  // change back to the filed 
  }
}) 
```

html

```
<div id='editor'>
   <div id='gird_edit'>hallo world</div>
   <div id='gird_edit'>hallo world 2</div>
   <div id='gird_edit'>hallo world 3</div>
</div> 
```

我只有 3 个声望，昨天才加入...对不起，我不能投票给你，因为它需要 15 个声望。但是，我将非常感谢您的帮助！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:01:09.037

如果您想检测元素外部的点击，只需在整个页面上检测它们，然后丢弃来自元素内部的任何点击。换句话说：

```
$('body').on('click', : function(e) { //Outside click of the text-area 
    if ($(this).parents().is('#gird_edit')) return false;
    var content = $('textarea').text(); // read what is in the text-area
    $("#gird_edit").text(????);  // change back to the filed 
}); 
```

但是，听起来您真正要寻找的是“模糊”处理程序，只要有人在文本区域内并离开它，就会触发它；您可以使用与您制作点击处理程序相同的基本方式来制作其中之一：

```
$('#gird_edit textarea').bind({
    blur: function() {
        // do the reverse of the click handler
} 
```

# c - C - fgets() 产生乱码

> ID：13998734
> 
> 赞同：0
> 
> 时间：2012-12-21T23:58:04.190
> 
> 标签：c, malloc, fgets

我使用 VS 2010 作为我的 IDE，这段代码可以正常工作，直到 fgets 被称为 puts 参数的行。它可以很好地记下文件中的数字，但也会打印出一些烦人的乱码。也许我在某处错过了 \0，不知道。其他人在 mingw 或 gcc 等其他编译器上尝试过它，它工作正常。

```
#include <stdio.h>
#include <stdlib.h>

int main()
{
    int *a, n, i;
    char str[512];
    FILE *f;
    printf("Insert array size: ");
    scanf("%d", &n);
    if(n <= 0)
    {
        printf("%d is not an allowed value!\n", n);
        return 1;
    }
    a = (int*)malloc(n * sizeof(int));
    if(a == NULL)
        return 2;
    putchar('\n');
    f = fopen("myarray.txt", "r+");
    if(f == NULL)
        return 3;
    for(i = 0; i < n; ++i)
    {
        printf("Insert %d. element of the array: ", i + 1);
        scanf("%d", &a[i]);
        fprintf(f, "%d ", a[i]);
    }
    putchar('\n');
    puts(fgets(str, 512, f));
    free(a);
    fclose(f);
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:06:17.430

在代码中调用`fgets`文件指针的位置应位于文件末尾。

因此，[`fgets`](http://www.cplusplus.com/reference/cstdio/fgets/)应该返回`NULL`指针，因为它在读取任何字符之前命中 EOF。

因此，您将`NULL`指针传递给[`puts`](http://www.cplusplus.com/reference/cstdio/puts/).

# ruby - 由于找不到 Ruby 开发标头，无法安装乘客

> ID：13998735
> 
> 赞同：-1
> 
> 时间：2012-12-21T23:58:07.577
> 
> 标签：ruby, rvm, passenger

运行`rvmsudo passenger-install-nginx-module`，我得到：

```
Checking for required software...

 * GNU C++ compiler... found at /usr/bin/g++
 * The 'make' tool... found at /usr/bin/make
 * A download tool like 'wget' or 'curl'... found at /usr/bin/wget
 * Ruby development headers... not found 
```

没有运气

> 请`apt-get install ruby1.8-dev`以root身份运行

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T01:07:25.297

你有没有尝试过：

```
rvm get head
rvm reload
gem install passenger
rvmsudo passenger-install-nginx-module 
```

# c++ - intToStr 递归

> ID：13998741
> 
> 赞同：1
> 
> 时间：2012-12-21T23:58:53.250
> 
> 标签：c++, c, arrays, recursion

这是学校的一项任务，我应该编写一个递归函数，将给定的 int 转换为字符串，我知道我很接近但我不能指出我的代码中缺少的东西，欢迎提供提示。

```
void intToStr(unsigned int num, char s[])
{
    if (num < 10)
    {   
        s[0] = '0' + num;
    }

    else
    {
        intToStr(num/10, s);
        s[strlen(s)] = '0' + num%10;
    }
} 
```

**编辑：**我的问题是该函数仅适用于预先初始化的数组，但如果我让该函数在未初始化的函数上工作，它将无法工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:04:17.700

除非您的数组是零初始化的，否则您在修改它时会忘记附加一个空终止符。

只需在最后一个字符之后添加它：

```
void intToStr(unsigned int num, char s[])
{
    if (num < 10)
    {   
        s[0] = '0' + num;
        s[1] = 0;
    }

    else
    {
        intToStr(num/10, s);
        s[strlen(s)+1] = 0; //you have to do this operation here, before you overwrite the null terminator
        s[strlen(s)] = '0' + num%10;
    }
} 
```

此外，您的函数假设 s 有足够的空间来容纳所有数字，因此您最好确保它确实如此（我认为 INT_MAX 的长度为 10 位，因此您至少需要 11 个字符）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:34:07.343

Andrei Tita 已经向您展示了您在使用 NULL 终止符时遇到的问题。我将向您展示一种替代方法，以便您可以比较和对比不同的方法：

```
int intToStr(unsigned int num, char *s)
{   
    // We use this index to keep track of where, in the buffer, we
    // need to output the current character. By default, we write
    // at the first character.
    int idx = 0;

    // If the number we're printing is larger than 10 we recurse
    // and use the returned index when we continue.
    if(num > 9)
        idx = intToStr(num / 10, s);

    // Write our digit at the right position, and increment the
    // position by one. 
    s[idx++] = '0' + (num %10);

    // Write a terminating NULL character at the current position
    // to ensure the string is always NULL-terminated.
    s[idx] = 0;

    // And return the current position in the string to whomever
    // called us.
    return idx;
} 
```

您会注意到，我的替代方案还返回了它输出到缓冲区的字符串的最终长度。

祝你的课程工作顺利！

# objective-c - Objective C - 结构化类逻辑

> ID：13998757
> 
> 赞同：0
> 
> 时间：2012-12-22T00:00:36.217
> 
> 标签：objective-c, architecture, singleton, logic, structure

我对Objective C编码比较陌生，所以请帮助我：

在我的代码中，我有一个名为 GameData 的类，它是一个单例，它包含一些方法，并且正是这个类来管理评分系统。我的问题是，我应该为存储在 GameData 中的分数创建另一个类，还是应该保持这种方式？我想确定一下，因为我有很多分数管理方法！谢谢！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:05:08.610

[职责分离 (pdf)](https://docs.google.com/file/d/0ByOwmqah_nuGNHEtcU5OekdDMkk/edit?pli=1)是一个很好的软件设计原则。根据您的需求以及您在代码中预见的更改向量，将代码移动到专用的记分类应该会有所帮助。

此外，请务必检查其他重要的面向对象设计原则，例如[SOLID 原则](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:05:09.223

一般来说，如果您发现您在对象 A 中创建了很多方法来处理 A 中包含的特定值或特定值集，则应将这些值或值组合到具有所有 B 值关联方法的类 B 中。

当您自己注意到这个问题时，您可能应该将与`Score`数据关联的值和方法移动到一个单独的对象中。

对于你移动的方法，问问自己这个方法是一个`Score`应该知道的东西，还是`GameData`经理应该知道的东西。

例如，a`Score`可能不应该知道其他分数的存在，因为它有`GameData`责任管理这些分数的组成。相反，`GameData`经理不应根据某些内部`Score`指标（例如`pointsGained`或`secondsToFinish`）手动对分数进行排序，而应依赖于`Score`实现与其他有意义的对象的比较方法`Score`。在这个例子中，通过只给对象提供对他们重要的信息，你可以很容易地改变一个`Score`排名到其他分数的方式，而无需修改`GameData`类。

# javascript - 使用函数数组的 HTML 表单验证无限循环

> ID：13998758
> 
> 赞同：0
> 
> 时间：2012-12-22T00:00:35.913
> 
> 标签：javascript, html, loops

在填写 3 / 7 个表单字段后按提交时出现无限循环。我填写名字和姓氏，以及电子邮件地址。

这是我怀疑无限循环来自的函数：

```
function runValidation()
{
    // Element Variables
    var name_first = document.forms[0].elements["name_first"];
    var name_last = document.forms[0].elements["name_last"];
    var address_email = document.forms[0].elements["address_email"];
    var address_number = document.forms[0].elements["address_number"];
    var address_postal = document.forms[0].elements["address_postal"];
    var url_link = document.forms[0].elements["other_website"];
    var user_age = document.forms[0].elements["other_age"];

    // Arrays of elements and functions
    var userVariables = new Array(name_first, name_last, address_email, address_number, address_postal, url_link, user_age);    
    var userFunctions = new Array(valName, valName, valEmail, valNum, valCode, valLink, valAge);
    var userFuncExec = new Array();

    for (i = 0; i < userVariables.length - 1; i++)
    {
        userFuncExec[i] = userFunctions[i](userVariables[i]);

        if ( userFuncExec[i] == false )
        {       
            userVariables[i].value = "";
            userVariables[i].focus();
            return false;
        }
    }

    // If the function has not returned false , then the form is valid;
    document.forms[0].submit();

} 
```

这是整个 .js 文件：

[http://pastie.org/5563532](http://pastie.org/5563532)

```
// This is the validation for the contact form of Exquisite Taste
var debugOn = true; // toggles debug alerts.

function runValidation()
{
    // Element Variables
    var name_first = document.forms[0].elements["name_first"];
    var name_last = document.forms[0].elements["name_last"];
    var address_email = document.forms[0].elements["address_email"];
    var address_number = document.forms[0].elements["address_number"];
    var address_postal = document.forms[0].elements["address_postal"];
    var url_link = document.forms[0].elements["other_website"];
    var user_age = document.forms[0].elements["other_age"];

    // Arrays of elements and functions
    var userVariables = new Array(name_first, name_last, address_email, address_number, address_postal, url_link, user_age);    
    var userFunctions = new Array(valName, valName, valEmail, valNum, valCode, valLink, valAge);
    var userFuncExec = new Array();

    for (i = 0; i < userVariables.length - 1; i++)
    {
        userFuncExec[i] = userFunctions[i](userVariables[i]);

        if ( userFuncExec[i] == false )
        {       
            userVariables[i].value = "";
            userVariables[i].focus();
            return false;
        }
    }

    // If the function has not returned false , then the form is valid;
    document.forms[0].submit();

}

function valName(nam)
{
    // This validates whatever name is passed.

    if(nam.value.length > 1)
    {
        if(debugOn)
            alert("Name is valid");
        return true;
    }else{

        alert("Please enter a name that is at least 2 characters long.");
        return false;
    }
}

function valEmail(email)
{
    // This function checks to see if the email address entered is valid.

    // Check if the email field is less than 10 characters ( 3@3.2-3 = 10 - 11 characters for the shortest email address)

    if ( email.value.length < 10 )
    {
        alert("Your email is too short to be valid.")
        return false;
    }

    // Check to see the email has at least one period and one @ symbol

    if ( email.value.indexOf(".") < 0 || email.value.indexOf("@") < 0)
    {
        alert("The format of your email is invalid. All emails require a '.' and a '@'");
        return false;
    }

    // Check if the last index of the '.' is after the '@' symbol & make sure there is only one index of '@'

    if ( email.value.lastIndexOf(".") < email.value.indexOf("@") || email.value.indexOf("@") != email.value.lastIndexOf("@") )
    {   
        alert("Your email is invalid and may have too many @ symbols or have them in the wrong place");
        return false;
    }

    // Check to see that the index of the last '.' has at least two characters after it.

    if ( email.value.lastIndexOf(".") > email.value.length-3 )
    {
        alert("Your top level domain has to be at least 2 characters");
        return false;       
    }

    // Check to see if the split array has at least 3 characters in each section except for the last (TLD).

    var email_attributes = new Array();
    var email_attributes = email.value.split("."); // tiessen-b@webmail.uwinnipeg.ca

    for ( i = 0; i < email_attributes.length - 2; i++ ) // -2 = (-1 so length = index; and -1 so the last section isn't included.)
    {
        // If one of the characters in the array value is '@' and the string length is < 3 then it isn't long enough.
        if ( email_attributes[i].indexOf("@") > -1 )
        {
            // If the length of the string - 1 (for the '@') symbol is not considered a valid symbol.
            if ( ( email_attributes[i].length - 1 ) < 3 )
            {
                alert("Your email doesn't have a long enough section");
                return false;
            }

        }

    }

    // If it got this far it is probably a valid email address.
    alert("Your email is valid!");
    return true;

}

function valNum(num)
{
    // This function validates a 10 or 12 digit phone number

    var isNum = /[0-9]/; // If the value is a number

    // Check to see if the number length is either 10 or 12
    if ( num.value.length == 10 || num.value.length == 12)
    {
        // Make sure every character is a number.
        for (i = 0; i < num.value.length; i++)
        {
            if ( !isNum.test( num.value.charAt(i) ) )
            {
                alert("You have entered an invalid number.");
                return false;
            }
        }
    }

    else if ( num.value.length == 12 )
    {
        // split all numbers into an array with a delimiter of '-'
        var numbers = num.value.split("-");

        // check if the array length is not 3 or has 4 digits in the last section
        if ( numbers.length != 3 || numbers[0].length > 3 || numbers[1].length > 3 );
        {
            alert("Your number is not formatted correctly. Make sure it is formatted like this: 204-290-9611.");
            return false;
        }

        // loop through each section of the numbers array and make sure they are all numbers

        for ( l = 0; l < numbers.length - 1; l++ )
        {
            for ( i = 0; i < numbers[l].length; i++)
            {
                if ( !isNum.test(numbers[l].charAt(i)) )
                {
                    alert("Your phone number has invalid characters");
                    return false;
                }
            }
        }
    }else{

        alert("Phone number is invalid");
        return false;
    }
        if(debugOn)
            alert("Phone number is invalid");
        return true;    
}

function valCode(code)
{
    // This function validates a postal code.

    var valid = true;
    var isChar = /[A-z]/;
    var isNum = /[0-9]/;

    // Make sure the postal code is 6 characters long.
    if( code.value.length != 6)
    {
        alert("Please enter a 6 digit/character postal code");
        return false;

    }else{

        if ( !isChar.test( code.value.charAt(0) ) )
            valid  = false;
        if ( !isNum.test( code.value.charAt(1) ) )
            valid  = false;
        if ( !isChar.test(  code.value.charAt(2) ) )
            valid  = false;
        if ( !isNum.test( code.value.charAt(3) ) )
            valid  = false;
        if ( !isChar.test( code.value.charAt(4) ) )
            valid  = false;
        if ( !isNum.test( code.value.charAt(5) ) )
            valid  = false;

        if (valid)
        {
            if(debugOn)
                alert("Postal Code is valid");
            return true;
        }else{
            alert("Your Postal Code is formatted incorrectly.");
            return false;       
        }
    }

}

function valLink(link)
{

    if(link.value.length > 0)
    {
        linkParts = link.value.split(".");
        if ( linkParts[0] == "www" || linkParts[0] == "http://www")
        {
            if( linkParts[linkParts.length-1].length < 2 || linkParts.length < 3)
            {
                alert("Invalid domain");
                focusEmpty(link);
            }else{
                return true;
            }
        }else{
            alert("invalid host");
            focusEmpty(link);
        }
    }else{
        return true;
    }
}

function valAge(age)
{
    // This function validates the users age.
    var parsedAge = parseInt(age.value, 10);

    if( age.value.length > 0 )
    {
        if(  isNaN(parsedAge) )
        {
            alert("invalid age");
            focusEmpty(age);

        }else{

            if(age.value < 1 || age.value > 125)
            {
                alert("Is that your real age? Please try again...");
                focusEmpty(age);

            }else{
                return true;
            }
        }
    }else{
        // If the user doesn't submit anything return true and validate (Age is optional).
        if(debugOn)
            alert("Age is empty but valid.");
        return true;
    }
} 
```

这是 HTML 表单的代码：

```
<form method="post" enctype="text/plain" action="http://www.cs.tut.fi/cgi-bin/run/~jkorpela/echo.cgi" name="contactForm">

                <div>
                  <p>First Name:</p>
                  <input name="name_first" type="text" />
                </div>
                <div>
                  <p>Last Name:</p>
                  <input name="name_last" type="text" />
                </div>
                <div>
                  <p>Email Address:</p>
                  <input name="address_email" type="text" />
                </div>
                <div>
                  <p>Phone Number:</p>
                  <input name="address_number" type="text" />
                </div>
                <div>
                  <p>Postal Code:</p>
                  <input name="address_postal" type="text" />
                </div>
                <div>
                  <p>Website:</p>
                  <input name="other_website" type="text" />
                </div>
                <div>
                  <p>Age:</p>
                  <input name="other_age" type="text" />
                </div>
                <div style="text-align:right; margin-right:20px;">
                  <input name="submit" type="button" value="Send" onclick="runValidation();"/>
                </div>
              </form> 
```

为什么我得到一个无限循环？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T04:57:49.213

`for (var i = 0;...`在循环定义中使用而不是`for (i = 0`.

javascript 中的变量范围可能很难理解。[JavaScript 中变量的作用域是什么](https://stackoverflow.com/questions/500431/javascript-variable-scope)？有一个很好的解释。

# python - python中是否有类似于调用`initctl list`的函数？

> ID：13998774
> 
> 赞同：0
> 
> 时间：2012-12-22T00:04:08.460
> 
> 标签：python, linux, unix, process

我需要从系统中获取所有可能正在运行的进程的列表（无论它们当前是否已停止），而无需自己记录。

我想知道是否有更好的方法可以在 python 中获取这些进程的列表，而不必对调用进行可怕的`subprocess`输出解析`initctl list`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:07:59.330

我不认为 Python 有这方面的标准工具。有非标准的[psutil](http://code.google.com/p/psutil/)包。根据您要执行的操作，在`/proc`文件系统中四处游荡可能比解析命令行实用程序的输出更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:09:33.717

您可以通过`/proc/<pid>/cmdline`获取正在运行的进程名称。您需要列出文件`/proc`并过滤数字文件以访问系统上运行的进程列表。

但是，我不会将这种访问称为*“所有可能的正在运行的进程”*，因为这也包括内核线程。

# c++ - 总合并搜索优化

> ID：13998776
> 
> 赞同：0
> 
> 时间：2012-12-22T00:04:41.547
> 
> 标签：c++, algorithm, search, optimization, recursion

假设有一个大小为 N 的向量 VA，每个元素都是另一个类型为 T 的向量。对类型 T 进行一个操作并返回一个类型为 T 的新值，即`bool merge(T a, T b, T &ret);`。如果a和c可以合并，则将结果存入`ret`并返回true；否则，返回假。合并操作是反射和传递的。

如果出现以下任一情况，则可以找到解决方案：

1.  ∃ x [0] , x [1] , ..., x [N-1]。合并（VA[0][x [0] ]，VA[1][x [1] ]，合并（VA[2][x [2] ]，...，合并（VA[N-2][x [N-2] ]， VA[N-1][x [N-1] ], ret)...));
2.  可以合并来自 N-1 （**不是 N** ）子向量的任何元素（选择任何 N-1 ，只有一个例外）。

例如：VA 的大小为 3。元素 a 可以与元素 b 合并，结果为 c。元素 c 可以与元素 d 合并，结果为 e。

*   VA[0] = {一个}
*   VA[1] = {b, q}
*   VA[2] = {d, r}

上例中的所有解都是：{a,b}, {a,d}, {b,d}, {a,b,d}。

任务是找到给定向量 VA 中的所有解。

我的 C++ 代码是：

```
void findAll(unsigned int step, unsigned int size, const T pUnifier, int hole_id) {
  if(step == size) printOneResult(pUnifier);
  else {
    _path[step] = -1;
    findAll(step + 1, pUnifier, step);
  }
  std::vector<T> vec = VA[step];
  for(std::vector<T>::const_iterator it = vec.begin(); it < vec.end(); it++) {
    T nextUnifier();
    if( merge( *it, pUnifier, nextUnifier )) {
       _path[lit_id] = it->getID();
       findAll(step + 1, nextUnifier, hole_id);
    }
  }
} 
```

代码包含递归调用；但是，它不是尾递归的。它在实践中运行缓慢。实际上，VA 的大小可能是数百，每个子向量的大小也可能是数百。我想知道它是否可以优化。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T06:26:07.827

如果我正确理解了您的代码，那么您正在执行（递归）蛮力搜索。这效率不高，因为您获得了一些有关您的搜索空间的信息。

我认为这里的一个很好的候选者是[A* algorithm](https://en.wikipedia.org/wiki/A%2a_search_algorithm)。您可以使用当前最大链大小作为启发式，或者甚至可以使用链大小的平方和。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-12-22T01:13:24.813

为了改进您的代码，当您使用向量时，您应该使用 [] 运算符，使用`int`计数器而不是简单的迭代器，这要慢得多。您可以通过最小化任一循环中的函数调用来进一步改进它，就像之前堆叠您将使用的值一样。由于您没有解释什么是真正的 T_VEC，我不能不编写完整的无迭代器版本，但这应该已经是速度方面的一大优势。

# arrays - 将目录文件夹名称存储到阵列 Powershell

> ID：13998777
> 
> 赞同：16
> 
> 时间：2012-12-22T00:04:46.590
> 
> 标签：arrays, powershell, directory

我正在尝试编写一个脚本，该脚本将获取特定目录中所有文件夹的名称，然后将每个文件夹作为数组中的一个条目返回。从这里开始，我将使用每个数组元素来运行一个更大的循环，该循环将每个元素用作稍后函数调用的参数。所有这些都是通过 powershell 完成的。

目前我有这个代码：

```
function Get-Directorys
{
    $path = gci \\QNAP\wpbackup\

    foreach ($item.name in $path)
    {
        $a = $item.name
    }
} 
```

该`$path`行是正确的，并且为我提供了所有目录，但是 foreach 循环是它实际存储第一个目录的各个字符而不是每个目录的每个元素的全名的问题。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-22T08:59:28.040

这是使用管道的另一个选项：

```
$arr = Get-ChildItem \\QNAP\wpbackup | 
       Where-Object {$_.PSIsContainer} | 
       Foreach-Object {$_.Name} 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-05-31T22:53:11.227

$array = (dir *.txt).FullName

$array 现在是目录中所有文本文件的路径列表。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2014-09-05T11:03:38.443

为了完整性和可读性：

这会将“somefolder”中以“F”开头的所有文件放到一个数组中。

```
$FileNames = Get-ChildItem -Path '.\somefolder\' -Name 'F*' -File 
```

这将获取当前目录的所有目录：

```
$FileNames = Get-ChildItem -Path '.\' -Directory 
```

* * *

## 回答 #4

> 赞同：6
> 
> 时间：2017-03-26T20:38:22.377

```
# initialize the items variable with the
# contents of a directory

$items = Get-ChildItem -Path "c:\temp"

# enumerate the items array
foreach ($item in $items)
{
      # if the item is a directory, then process it.
      if ($item.Attributes -eq "Directory")
      {
            Write-Host $item.Name//displaying

            $array=$item.Name//storing in array

      }
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-22T00:07:53.277

我相信问题在于您的`foreach`循环变量是`$item.name`. 您想要的是一个名为 的循环变量`$item`，您将访问`name`每个变量的属性。

IE，

```
foreach ($item in $path)
{
    $item.name
} 
```

另请注意，我没有`$item.name`分配。在 Powershell 中，如果结果未存储在变量中、未通过管道传输到另一个命令或以其他方式捕获，则它包含在函数的返回值中。

# playframework-2.0 - Playframework2：Ebean 和 OptimisticLockException

> ID：13998779
> 
> 赞同：1
> 
> 时间：2012-12-22T00:05:04.683
> 
> 标签：playframework-2.0, ebean

我对 Ebean 和更新有疑问。我需要的一切都是这样的：

```
public static Result cancelOrder(Long id){
Order order = Order.findByID(id);
if(order != null){
    order.canceled = true;
    order.update(id);
}
return OK();
} 
```

我的模型：

```
@Entity 
@Table(name="order")
public class Order extends Model {
    @Id
    @Column(name="ID")
    public long id;

    @Constraints.Required
    public String date;

    @Constraints.Required
    public String name;

    public Boolean canceled;

    public Order(String date, String name){
         this.date = date;
         this.name = name;
    }
    public static Model.Finder<String,Order> find = new Model.Finder(String.class, Order.class);

    public static Order findByID(long id) {
        return find.where().eq("ID", id).findUnique();
    }
} 
```

但它不起作用，因为我收到异常“OptimisticLockException：数据已更改。更新 [0] 行”。我发现了一些类似的问题，但一切都与形式有关，但没有像这样。你能帮助我吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-03-05T18:50:42.640

我在使用 Float 数据类型时遇到了类似的问题。我仅在 DB 中更改为 Decimal 数据类型，并使用 @Column 表示法定义长度：

@Column(columnDefinition = "Decimal(10,3)") 公共浮点示例；

...而且它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T14:24:03.760

有同样的问题。

发生的情况是 ebean 以一种奇怪的方式构建更新查询，而不仅仅是使用“WHERE id =？” 但是“WHERE id = ? AND field1 = ? AND blabla”。如果表中有一个 float 字段，那么 mysql 就会出现怪癖，即使 float_field 为 0.1，float_field = 0.1 也不总是返回 true，它是近似值：/

因此，一种解决方案是将浮点字段转换为十进制。

另一种解决方案是让 ebean 仅使用 @Id 构建更新查询......无法弄清楚如何或即使它可能......

# ios - iOS UIButton 文本没有被截断

> ID：13998786
> 
> 赞同：0
> 
> 时间：2012-12-22T00:05:47.927
> 
> 标签：ios, ipad, uibutton, uistoryboard, truncate

我正在制作一个从数据生成 UITableView 的应用程序。我有一个自定义 UITableViewCell ，其中包含一个带有文本的 UIButton。生成的按钮之一的标题对于 UIButton 来说太长了，但并没有像我在 UIStoryBoard 中选择的那样被截断。单元格在我的 UITableViewController 函数 `- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`中像原型单元格一样正常创建。

我是新用户，无法添加图片，但这里有几个图片链接：

UIStoryBoard 设置：[截断设置](http://i.imgur.com/w3kfQ.png)

UIButton 边界外的标题溢出：[溢出的文本](http://i.imgur.com/j52kL.png)

有谁知道如何解决这一问题。它早些时候工作。我更改了 UIButton 的大小和标题文本的字体，但我认为这不会产生影响。

这是我在其中设置按钮文本的代码`- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath`

```
 CellIdentifier = @"PopoverCell";
    cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    ((MSPopoverCell *)cell).nameLabel.text = data.FullName; //setting the label, works fine
    [((MSPopoverCell *)cell).button setTitle:data.DisplayString forState:UIControlStateNormal];//setting the button title, bleeds over 
```

另外，我是stackoverflow的新手，所以如果我错过了我应该包括的任何内容，请给我一些友好的建议。谢谢，马克斯

# python - Python 对象的良好风格

> ID：13998790
> 
> 赞同：4
> 
> 时间：2012-12-22T00:06:35.137
> 
> 标签：python, oop, data-structures, styles

在 Python 之前，我的大部分编程都是用 C++ 或 Matlab 编写的。我没有计算机科学学位（几乎完成了物理学博士学位），但已经完成了一些课程和大量的实际编程。现在，我正在 Coursera 上学习算法课程（顺便说一句，与斯坦福大学的教授一起学习的课程非常好）。我决定用 Python 实现作业。然而，有时我发现自己想要一些语言不容易支持的东西。我非常习惯在 C++ 中为事物创建类和对象，只是为了将数据组合在一起（即当没有方法时）。然而，在 Python 中，您可以动态添加字段，而我基本上一直想要的是 Matlab 结构。我认为这可能表明我没有使用良好的风格并且没有以“Pythonic”的方式做事。

下面是我对联合查找数据结构的实现（用于 Kruskal 算法）。尽管实现相对较短且运行良好（没有太多错误检查），但还是有一些奇怪的地方。例如，我的代码假定最初传递给 union-find 的数据是一个对象列表。但是，如果传入的是显式数据片段列表（即整数列表），则代码将失败。有没有更清晰、更 Pythonic 的方式来实现它？我试图用谷歌搜索这个，但大多数示例都非常简单，并且更多地与程序代码相关（即在 python 中执行 for 循环的“正确”方法）。

```
class UnionFind:
    def __init__(self,data):
        self.data = data

        for d in self.data:
            d.size = 1
            d.leader = d
            d.next = None
            d.last = d

    def find(self,element):
        return element.leader

    def union(self,leader1,leader2):
        if leader1.size >= leader2.size:
            newleader = leader1
            oldleader = leader2
        else:
            newleader = leader2
            oldleader = leader1

        newleader.size = leader1.size + leader2.size

        d = oldleader
        while d != None:
            d.leader = newleader
            d = d.next

        newleader.last.next = oldleader
        newleader.last = oldleader.last

        del(oldleader.size)
        del(oldleader.last) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T02:28:28.917

一般来说，以 Python 方式做这种事情意味着你试图让你的代码不在乎给它什么，至少不超过它*真正*需要的。

让我们以联合查找算法为例。union-find 算法实际上对传递给它的值所做的唯一一件事就是比较它们是否相等。因此，要创建一个普遍有用的`UnionFind`类，您的代码不应依赖于它接收到的具有除相等性测试之外的任何行为的值。特别是，您不应该依赖能够为值分配任意属性。

我建议解决这个问题的方法是`UnionFind`使用包含给定值和使算法工作所需的任何属性的包装器对象。您可以[`namedtuple`](http://docs.python.org/2/library/collections.html#collections.namedtuple)按照另一个答案的建议使用，或者制作一个小型包装类。将元素添加到 时`UnionFind`，首先将其包装在其中一个对象中，然后使用包装器对象存储属性`leader`、`size`等。访问被包装的事物的唯一时间是检查它是否等于另一个值.

实际上，至少在这种情况下，假设您的值是可散列的应该是安全的，这样您就可以将它们用作 Python 字典中的键来查找与给定值对应的包装器对象。当然，并非 Python 中的所有对象都必须是可散列的，但那些不是相对罕见的对象，并且要制作能够处理这些对象的数据结构将需要做更多的工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T01:12:32.923

更 Pythonic 的方法是避免不必要的乏味对象。

```
class UnionFind(object):
    def __init__(self, members=10, data=None):
        """union-find data structure for Kruskal's algorithm
        members are ignored if data is provided
        """
        if not data:
            self.data = [self.default_data() for i in range(members)]
            for d in self.data:
                d.size   = 1
                d.leader = d
                d.next   = None
                d.last   = d
        else:
            self.data = data

    def default_data(self):
        """create a starting point for data"""
        return Data(**{'last': None, 'leader':None, 'next': None, 'size': 1})

    def find(self, element):
        return element.leader

    def union(self, leader1, leader2):
        if leader2.leader is leader1:
            return
        if leader1.size >= leader2.size:
            newleader = leader1
            oldleader = leader2
        else:
            newleader = leader2
            oldleader = leader1

        newleader.size = leader1.size + leader2.size

        d = oldleader
        while d is not None:
            d.leader = newleader
            d = d.next

        newleader.last.next = oldleader
        newleader.last = oldleader.last

        oldleader.size = 0
        oldleader.last = None

class Data(object):
    def __init__(self, **data_dict):
        """convert a data member dict into an object"""
        self.__dict__.update(**data_dict) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T01:21:56.303

要检查参数是否为预期类型，请使用内置[`isinstance()`](http://docs.python.org/2/library/functions.html#isinstance)函数：

```
if not isinstance(leader1, UnionFind):
    raise ValueError('leader1 must be a UnionFind instance') 
```

[此外，将文档字符串](http://www.python.org/dev/peps/pep-0257/)添加到函数、类和成员函数中是一个好习惯。函数或方法的此类文档字符串应该描述它的作用、要传递给它的参数以及如果适用，返回什么以及可以引发哪些异常。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-22T06:19:42.157

一种选择是使用字典来存储您需要的有关数据项的信息，而不是直接存储该项目的属性。例如，与其指代`d.size`你，不如指代`size[d]`（where `size`is a `dict`instance）。这要求您的数据项是可散列的，但它们不需要允许对其分配属性。

这是您当前代码的直接翻译以使用此样式：

```
class UnionFind:
    def __init__(self,data):
        self.data = data
        self.size = {d:1 for d in data}
        self.leader = {d:d for d in data}
        self.next = {d:None for d in data}
        self.last = {d:d for d in data}

    def find(self,element):
        return self.leader[element]

    def union(self,leader1,leader2):
        if self.size[leader1] >= self.size[leader2]:
            newleader = leader1
            oldleader = leader2
        else:
            newleader = leader2
            oldleader = leader1

        self.size[newleader] = self.size[leader1] + self.size[leader2]

        d = oldleader
        while d != None:
            self.leader[d] = newleader
            d = self.next[d]

        self.next[self.last[newleader]] = oldleader
        self.last[newleader] = self.last[oldleader] 
```

一个最小的测试用例：

```
>>> uf = UnionFind(list(range(100)))
>>> uf.find(10)
10
>>> uf.find(20)
20
>>> uf.union(10,20)
>>> uf.find(10)
10
>>> uf.find(20)
10 
```

除此之外，您还可以考虑稍微更改您的实现以减少初始化。这是一个不做任何初始化的版本（它甚至不需要知道它要处理的数据集）。它使用路径压缩和按等级联合，而不是始终为集合的所有成员维护最新`leader`值。它应该比您当前的代码渐进地快，特别是如果您正在做很多联合：

```
class UnionFind:
    def __init__(self):
        self.rank = {}
        self.parent = {}

    def find(self, element):
        if element not in self.parent: # leader elements are not in `parent` dict
            return element
        leader = self.find(self.parent[element]) # search recursively
        self.parent[element] = leader # compress path by saving leader as parent
        return leader

    def union(self, leader1, leader2):
        rank1 = self.rank.get(leader1,1)
        rank2 = self.rank.get(leader2,1)

        if rank1 > rank2: # union by rank
            self.parent[leader2] = leader1
        elif rank2 > rank1:
            self.parent[leader1] = leader2
        else: # ranks are equal
            self.parent[leader2] = leader1 # favor leader1 arbitrarily
            self.rank[leader1] = rank1+1 # increment rank 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-12-22T00:13:24.110

我猜这里的缩进问题只是将代码输入SO的简单错误。您能否创建一个简单的内置数据类型的子类？例如，您可以通过将数据类型放在括号中来创建列表数据类型的子类：

```
class UnionFind(list):
'''extends list object''' 
```

# java - Java 碰撞检测未按预期运行

> ID：13998791
> 
> 赞同：1
> 
> 时间：2012-12-22T00:06:36.260
> 
> 标签：java, collision-detection, collision, lwjgl

使用以下代码，可以检测到碰撞，但边注册不正确。

```
public int checkBoxes(int aX, int aY, int aWidth, int aHeight, int bX, int bY, int bWidth, int bHeight){

    /*
     * Returns int
     * 0 - No collisions
     * 1 - Top
     * 2 - Left
     * 3 - Bottom
     * 4 - Right
     */

    Vector2f aMin = new Vector2f(aX, aY);
    Vector2f aMax = new Vector2f(aX + aWidth, aY + aHeight);

    Vector2f bMin = new Vector2f(bX, bY);
    Vector2f bMax = new Vector2f(bX + bWidth, bY + bHeight);

    float left = bMin.x - aMax.x;
    float right = bMax.x - aMin.x;
    float top = bMin.y - aMax.y;
    float bottom = bMax.y - aMin.y;

    if(left > 0) return 0;
    if(right < 0) return 0;
    if(top > 0) return 0;
    if(bottom < 0) return 0;

    int returnCode = 0;

    if (Math.abs(left) < right)
    {
        returnCode = 2;
    } else {
        returnCode = 4;
    }

    if (Math.abs(top) < bottom)
    {
        returnCode = 1;
    } else {
        returnCode = 3;
    }

    return returnCode;
} 
```

当 A 与形状 B 的顶部、左侧或右侧碰撞时，返回数字 3，当与底部碰撞时，返回数字 1。我真的不知道是什么原因造成的。我的代码有什么问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:15:56.767

使用这些 if 块，您将始终得到`1`or`3`因为第二个 if 块将始终独立于您在第一个中设置的内容执行。

```
if (Math.abs(left) < right)
{
    returnCode = 2;
} else {
    returnCode = 4;
}

if (Math.abs(top) < bottom)
{
    returnCode = 1;
} else {
    returnCode = 3;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T15:53:45.467

问题是您正在检查一侧，但是当您通过示例检查左侧并且底部也发生碰撞时，您忽略了那一侧。我在这里测试了代码：[http ://wonderfl.net/c/i90L](http://wonderfl.net/c/i90L)

我所做的是首先获取侧面 X 和 Y 的距离。然后检查哪个距离是最大的，乘以矩形本身的大小，因为那一边总是正方形上的好边。

```
 Vector2f returnCode = new Vector2f(0, 0);

    returnCode.x = (Math.abs(left) - right) * aWidth;
    returnCode.y = (Math.abs(top) - bottom) * aHeight;

    int temp = 0;

    if(returnCode.x > 0){
        //Hits left
        temp = 2;
    }else{
        //Hits right
        temp = 4;
    }

    if(returnCode.y > 0){
        //Hits top
        if(returnCode.y > Math.abs(returnCode.x)){
            temp = 1;
        }
    }else{
        //Hits bottom
        if(returnCode.y < -Math.abs(returnCode.x)){
            temp = 3;
        }
    }

    return temp; 
```

# javascript - 构建 Node.js 和 AngularJS 应用程序

> ID：13998793
> 
> 赞同：77
> 
> 时间：2012-12-22T00:06:44.043
> 
> 标签：javascript, angularjs, node.js

我即将尝试我的第一个 AngularJS 项目，使用 Node.js 作为后端是有意义的，即使这意味着同时从头开始学习 AngularJS 和 Node.js。

我试图弄清楚的第一件事是一个好的文件结构。到目前为止，我的纯 HTML/CSS 模板具有以下目录结构...

```
_site/
Fonts/
Javascript/
SASS/
Stylesheets/
Index.html 
```

（ _site 是 PSD 等的工作目录。）

[我在这里](https://github.com/btford/angular-express-seed)找到了 Node.js/AngularJS 应用程序的示例目录结构....

...这表明以下目录结构。

```
app.js              --> Application configuration
package.json        --> For npm
public/             --> All of the files to be used in on the client side
  css/              --> CSS files
    app.css         --> Default stylesheet
  img/              --> Image files
  js/               --> JavaScript files
    app.js          --> Declare top-level application module
    controllers.js  --> Application controllers
    directives.js   --> Custom AngularJS directives
    filters.js      --> Custom AngularJS  filters
    services.js     --> Custom AngularJS services
    lib/            --> AngularJS  and third-party JavaScript libraries
      angular/
        angular.js            --> The latest AngularJS
        angular.min.js        --> The latest minified AngularJS
        angular-*.js          --> AngularJS add-on modules
        version.txt           --> Version number
routes/
  api.js            --> Route for serving JSON
  index.js          --> Route for serving HTML pages and partials
views/
  index.jade        --> Main page for the application
  layout.jade       --> Doctype, title, head boilerplate
  partials/         --> AngularJS view partials (partial jade templates)
    partial1.jade
    partial2.jade 
```

所以，这对我来说看起来相当不错（除了我不会使用 Jade 的事实）。

我还有以下问题...

1.  我想将所有前端和后端文件分开。此解决方案将所有前端文件放在 public/ 目录中，这很有意义，因为大多数文件都需要公开，但是将 SASS 和 _site 文件夹放在这里有意义吗？我可以将它们保留在那里，但在将它们投入生产时不上传它们，但这似乎是错误的，因为它们不应该公开。它们也不属于所有后端内容的根级别。

2.  [从CDN](http://en.wikipedia.org/wiki/Content_delivery_network)加载 AngularJS 不是更好吗？

3.  鉴于服务器只需要提供一个模板（主应用程序模板），所有其他 HTML 将在前端构建，保持 index.html 文件静态是否更有意义，删除视图文件夹并在 public/ 下创建一个 partials/ 文件夹，就像原来的 AngularJS Seed 应用程序一样？

我意识到这完全是一个见仁见智的问题，从技术上讲，我可以将它们放在任何我想要的地方，但我希望比我更有经验的人能告诉我各种目录结构的缺陷。

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2013-06-09T02:43:58.950

随着时间的推移，事情变得越来越容易。我已经将 Yeoman 用于 AngularJS 前端，它让生活变得更加轻松：http: [//yeoman.io/](http://yeoman.io/)

# 选项 1，MEAN.io

MEAN 是一个很棒的首字母缩写词！我更喜欢 MEAN 堆栈目录结构。让我们使用约定俗成的人！只需使用[mean.io](http://mean.io)中的目录结构。MEAN 也很方便，因为它包含[Grunt](http://gruntjs.com/)、[Bower](https://bower.io/)等所有好东西。

![在此处输入图像描述](../Images/82af376831b49f24366e994413ffb5e8.png)

# 选项 2，Angular-seed + Express.js

我在 GitHub 上搜索了 Node.js/AngularJS 项目（可能还不够难），但没有看到任何非常适合起始目录结构的东西。因此，我将 Node.js Express.js（既不使用[EJS](https://www.npmjs.com/package/ejs)也不使用[Jade/Pug](https://pugjs.org/api/getting-started.html)[从命令行运行 Express.js](http://expressjs.com/guide.html)）框架与 angular-seed 项目（[从 GitHub 克隆它](https://github.com/angular/angular-seed.git)）合并。然后我搬了很多东西。这是我想出的：

* * *

*   `developer`- 只有开发人员会使用的东西。不需要部署。
    *   `config`- 业力配置文件和其他。
    *   `scripts`- 开发人员脚本（构建、测试和部署）
    *   `test`- e2e 和单元测试。
*   `logs`
*   `node_modules`-[这个 Stack Overflow 的答案](https://stackoverflow.com/a/19416403/1804678)建议把它放在 Git 中。 **然而这现在可能已经过时了**。
*   `public`- 这几乎直接来自 angular-seed 应用程序文件夹。
    *   `css`, `img`, `js`, `lib`, `partials`- 非常明显，漂亮而简短。
*   `routes`- Node.js 路由。
*   `server`- 服务器端“shebang”Node.js 程序、守护进程、cron 程序等等。
*   `server.js`- 从 app.js 重命名只是为了更明显这是服务器端。

* * *

![在此处输入图像描述](../Images/2af307cf52d7aea476824577edc4d7fd.png)

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-12-22T06:50:04.363

1) 公开文件通常是有意义的，`saas/less`因为您可能希望在调试时使用客户端的 less->css 转换（less.js 会这样做）。但是不确定您`_site`包含什么*（顺便说一句，您应该为您的项目使用小写文件夹，特别是对于公共内容）*。

2) 在生产中从谷歌 CDN 加载 AngularJS 通常是一个好习惯，只使用本地版本进行开发，根据您的环境，您可以有两个单独的布局。

3）即使客户端渲染是要走的路，您也可以保留服务器端布局/视图渲染，您可能会在某些时候需要它（管理员访问、电子邮件渲染等）。但是，在 public 文件夹中使用来自 AngularJS 的名称会很有帮助，这`partials`有助于避免 server-side`views`和 client-side之间的混淆`partials`。

你应该清楚地去做目前看起来最合乎逻辑的事情，当你熟悉 express 时，你可能会移动事情。

* * *

你应该检查现有的 express 框架，看看他们是如何构建他们的应用程序的。例如，[TowerJS](http://towerjs.org/)有一个非常干净的`config`文件夹，但是它们混淆了我个人不喜欢的服务器端和客户端代码。

检查这个 NodeJS [MVC 框架](http://ocdevel.com/blog/nodejs-frameworks-comparison)的比较，看看其他人是如何做的。但是，我显然会从 vanilla express 代码开始，以便在过度提交任何这些框架之前完全控制并了解事情是如何工作的。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-26T20:59:42.277

正如建议的那样，这主要取决于个人喜好以及您当时正在从事的项目的工作方式。与您交谈的每个人都会有不同的想法，每个项目都有自己的设计——对一个人有用的东西可能对另一个人不起作用。我希望你会尝试很多不同的结构，很快就会找到最舒服的一种——但这仍然会随着时间的推移而发展。

我发现 Angular Seed 结构是最干净的，但这也是个人喜好（不过，它是由 Angular 团队设计的。）

您也可以考虑使用[Yeoman](http://yeoman.io)来生成项目骨架。

> *Yeoman 是一套强大且自以为是的工具、库和工作流程，可以帮助开发人员快速构建漂亮、引人注目的 Web 应用程序。*

它是一个很好的引导和管理项目的工具（类似于 Rails 的方式），并且会创建一个目录结构和框架文件供您构建。Brian Ford 写了一篇关于在 Angular 中使用 Yeoman的[优秀文章。](http://briantford.com/blog/angular-yeoman.html)

我还建议在他们的 YouTube 频道上观看 Angular 聚会的录音。我最近在山景城参加了一个聚会，会上提出了这些问题。Miško 推荐了 Angular Seed 和 Yeoman（至少作为一个很好的起点。）

要回答您的个人问题：

1.  在服务器端编译的任何文件都应保存在您的公用文件夹之外。我建议不要将主 PSD、模型或任何其他不适合公共使用（浏览器或用户）的文件保存在公共文件夹中。

2.  如果您期望大量流量，从 CDN 提供静态资产（JS、图像、CSS）总是好的。对于访问量较少的网站来说，这并不是那么重要，但仍然是一个好主意。我将首先在本地提供文件以进行初始开发。将资产优化留到接近上线日期时。当这个时候到来时，您还需要正确设置缓存。例如，Yeoman 提供了一种对资产进行版本控制的好方法。这为您提供了长期缓存的优势，但允许您将文件更新推送到客户端。

3.  如果您的索引文件不需要任何服务器端渲染，请静态提供。我喜欢使用 Angular 应用程序尽可能地让我的后端与后端分离。它有助于保持关注点分离；在开发客户端文件时，您根本不需要考虑后端（Angular 非常适合。）

真的，你只需要到处玩；尝试不同的事情，阅读博客文章，从其他人那里获得想法，提出问题（就像你在这里所做的那样，在 Angular Google+ 社区页面上），观看视频，如果可以的话，参加聚会——聚会真的很适合这个。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2016-09-24T10:52:57.207

我不同意之前的所有帖子。它们要么是从另一个地方粘贴的，要么没有自己的想法。根据我的经验，最好扁平化您的客户端代码。我的意思是您的客户端目录中的代码应该在您的根目录中。

为什么我建议这种方式？因为如果您想将您的全栈 JavaScript 项目更改为没有后端但只包含前端的项目，那会容易得多。我的意思是大多数用 JavaScript 编写的项目都集中在前端。

最好把你的后端代码放在与“css”、“image”一样的文件夹级别的“server”之类的目录中……这样做的好处是，当你需要或不需要后端时，只需添加或者删除“服务器”目录，它不会影响原始项目结构。

像这样：

[![在此处输入图像描述](../Images/c8acd5aa3c0a7765d4ef7d2ac9e71a2c.png)](https://i.stack.imgur.com/EGhcI.png)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-02-19T23:57:56.347

我正在调查同样的事情。

我最初的想法是使用[Express Generator](http://expressjs.com/en/starter/generator.html)和[Angular Seed](https://github.com/angular/angular-seed)。

然后我找到了一个更好的解决方案：

*   [http://yeoman.io/](http://yeoman.io/)
*   [http://yeoman.io/generators/](http://yeoman.io/generators/)
*   *（最受欢迎的生成器之一）* [https://github.com/angular-fullstack/generator-angular-fullstack](https://github.com/angular-fullstack/generator-angular-fullstack)

最受欢迎的**yeoman 生成器**之一为您提供了 Node.js 和 AngularJS 应用程序的结构。

我相信标准化的力量，新加入该项目的人会欣赏统一的结构。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-07-26T07:42:38.823

看到这个骨架

[https://github.com/Giancarlo1974/SailsAngular](https://github.com/Giancarlo1974/SailsAngular)

它为客户端集成了 Angular 4 + Bootstrap 4，为服务器集成了 Node Sails JS

该解决方案的优点之一是：1)[任务自动化](http://sailsjs.com/documentation/concepts) 2)[数据库不可知论](http://sailsjs.com/documentation/concepts/models-and-orm)

# javascript - JavaScript / JQuery 双重执行

> ID：13998794
> 
> 赞同：0
> 
> 时间：2012-12-22T00:06:58.490
> 
> 标签：javascript, jquery, ruby-on-rails

我使用以下代码作为调试 - 我只是想观察单选按钮的点击并适当地设置它们的样式。

```
$("#item-select-form label.radio").click(function() {
  var child_input, input_id;
  console.log("clicked!");
  child_input = $(this).children("input");
  input_id = child_input.attr("id");
  return console.log(input_id);
}); 
```

代码似乎工作正常。我得到了“点击！” 我看到了孩子输入的正确 id。但是，这段代码被执行了两次，我不知道为什么（如果这有什么不同，我正在使用 Rails）。

我如何追踪它的调用位置和原因？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T01:02:26.170

如果您在 ajax 响应上绑定此事件，它将被触发多次，您应该在再次绑定之前取消绑定该事件（如果在它不会导致错误之前没有绑定），您的代码也有改进，你可以使用这个：

```
$("#item-select-form").find("label.radio").click... 
```

或者

```
$("#item-select-form").click(function(e){ 
    var elemPressed = $(e.target);
    if( elemPressed ).is("label.radio") ){
      //do your stuff
    }
}); 
```

这两种技术都比您的原始选择器（使用[sizzle](http://www.myinkblog.com/sizzle-a-look-at-jquerys-new-css-selector-engine/) ）和第二个（我最喜欢的）更快让我们为页面的整个部分创建一个事件，而不是创建多个事件（从而降低性能）到 DOM

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:49:31.580

这几乎可以肯定是因为该事件被多次绑定。jQuery 执行所有绑定的事件处理程序。

为了确保它只执行一次，你应该只绑定一次。*或者*你应该`unbind`在再次绑定之前处理任何绑定的处理程序。例如：

```
// unbind the previously bound handler
$("#item-select-form label.radio").unbind('click');

// bind your click
$("#item-select-form label.radio").click(function() {
...
}); 
```

# spotify - Spotify 播放按钮生成器不允许选择浅色或深色选项/专辑封面？

> ID：13998795
> 
> 赞同：0
> 
> 时间：2012-12-22T00:07:03.587
> 
> 标签：spotify

当我在 Spotify 开发者部分使用 Spotify 播放按钮生成器时，我无法选择浅色或深色/专辑封面。只有大型播放器或小型...是我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T10:46:25.833

The light/dark and list/cover options are only changeable for play buttons based on playlists. For artists, tracks and albums you can't change them.

# javascript - 对新数组的多重响应

> ID：13998796
> 
> 赞同：0
> 
> 时间：2012-12-22T00:07:04.247
> 
> 标签：javascript, arrays, loops, if-statement

好的，所以我在搞乱数组，现在我正在尝试回答第二个问题，以提出新消息而不是“正确！” 当在这种情况下发现它正确时，如果第二个问题正确，我希望它回复“gerp”。但我不完全确定该怎么做。我在搞砸什么？

```
 var i = 0;

 var myArray = new Array({
   q: "What was her favorite Color?",
   a: "purple"
 }, {
   q: "gymhoaccetpptfe",
   a: "rev six nine eleven"
 });

 function myFunction() {
   var x;
   var name = prompt(myArray[i].q);
   if (name == myArray[i].a) {
     x = document.getElementById("demo").innerHTML + " " + "correct!";
     i = i + 1;
     document.getElementById("demo").innerHTML = x;
   } else if ((name == myArray[i + 1].a) {
     x = document.getElementById("demo").innerHTML + " " + "gerp!";
   } else {
     x = document.getElementById("demo").innerHTML + name + " " + "is" + " " + "wrong!";
     document.getElementById("demo").innerHTML = x;
   }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:09:49.973

检查您的错误控制台 ( `F12`)。你在这里有一个语法错误：

```
else if ((name == myArray[i + 1].a)
{
... 
```

你缺少一个结束括号。这些错误（语法错误）经常被浏览器捕获，所以一个简单的检查应该可以修复它。

另外，你没有得到输出“gerp！”的原因 是因为您将变量设置为`innerHTML`，但实际上并未更新`innerHTML`元素的 。因此，将这一行添加到`else if`语句和`else`语句中。

```
document.getElementById("demo").innerHTML = x; 
```

# c - 带有发送的结构内的指针

> ID：13998798
> 
> 赞同：0
> 
> 时间：2012-12-22T00:07:46.030
> 
> 标签：c, pointers, struct

我有以下结构，我正在尝试通过网络发送到另一个应用程序

```
 struct protocol
  {

     char protocol;
     char field1;
     char field2;
     char field3;
     char field4;
     char field5;
     char field6;
     char field7;
     char field8;
     char msg_id;
     char msg_length;
     char *msg;

  }; 
```

我遇到的问题是我不确定如何通过网络发送这个结构，因为其中有一个指向字符串的指针，并且 memcpy 到缓冲区的结构不起作用，这是唯一的方法去做吧？

```
memcpy (buffer, protocol->protocol, char)
memcpy (buffer, protocol->field1, char)
...
memcpy (buffer, protocol->msg, protocol->length) 
```

然后发送缓冲区

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T00:16:52.830

是的，如果您要发送到（可能）在您自己的流程之外的东西，那么这种编组或序列化是唯一可行的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:20:36.220

您需要将结构序列化为某种缓冲区。您的副本顺序仅在概念上是正确的；有无数细节需要解决：

```
char buffer[sizeof(struct protocol) + protocol->msg_length]; // Over-allocation

buffer[0] = protocol->protocol;
buffer[1] = protocol->field1;
...
buffer[8] = protocol->field8;
buffer[9] = protocol->msg_id;
buffer[10] = protocol->msg_len;
memcpy(&buffer[11], protocol->msg, protocol->msg_len); 
```

`11 + protocol->msg_len`现在您可以写入要发送的缓冲区 ( ) 的正确长度。

这特别简单；无需担心字节顺序问题。`short`通常，对于像or`int`或之类的多字节值`long long`，您必须担心传输的字节顺序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:33:41.300

如果您可以限制您发送的数据的某些方面，例如“msg_len 永远不会超过 X 字节”，您可以执行以下操作：

```
#define MAX_MSG_LEN 1000
struct protocol
{
 char protocol;
 char field1;
 char field2;
 char field3;
 char field4;
 char field5;
 char field6;
 char field7;
 char field8;
 char msg_id;
 char msg_length;
 char msg[MAX_MESSAGE_LEN];
}; 
```

您需要计算在 msg 之前有多少开销，然后使用 msg_length 确定您需要发送的缓冲区的总大小。

或者，另一种方法是：

```
struct protocol
{
 char protocol;
 char field1;
 char field2;
 char field3;
 char field4;
 char field5;
 char field6;
 char field7;
 char field8;
 char msg_id;
 char msg_length;
 char msg[1];
}; 
```

然后`struct procotol *msg_ptr = malloc(sizeof(struct protocol) + msg_len-1);`在需要形成消息时使用。

这两种方法都有一个缺点，如果你在结构中有“间隙”，你需要在另一端处理它（如果它是用不同的编译器编译的，对于不同的处理器，它可能有不同的间隙规则，或者只是使用不同的编译器开关）

# c# - Regex.Match 帮助：-93-11.html，想得到11（例子）

> ID：13998803
> 
> 赞同：0
> 
> 时间：2012-12-22T00:07:57.363
> 
> 标签：c#, regex, windows-phone-7

关于文件结尾的 RegexMatch (c#)，我需要您的帮助：

我总是需要扩展名 .html 和第一个减号之前的数字（如果您从右到左阅读）

例子：

-213.html 寻找 213

-93-32.html 寻找 32

我已经尝试过 -([^\"]*).html，但在第二个示例中它给了我 -93-32。

（顺便说一句。使用上面我当前的解决方案，我也得到了减号，如果你知道我可以如何排除它，请告诉我，目前我正在用“”替换“-”）

提前致谢， 拉尔夫

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:10:54.427

`(\d+)\.html$`应该这样做。这里`$`的意思是线锚的末端。

如果您不想捕获`.html`使用`(\d+)(?:\.html)$`（虽然还没有测试过）。

没有锚，如果你从左到右阅读，它会是`-(\d+)\.html`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:11:24.637

你的模式是`"-([0-9]+?).html"`

# python - Mac：Eclipse 错误导入 MySQLdb 在命令行上工作正常

> ID：13998805
> 
> 赞同：2
> 
> 时间：2012-12-22T00:08:02.940
> 
> 标签：python, mysql, eclipse, macos

我一直在尝试在 MAC 上安装 Mysql 和 Python 以及 MySQLdb 模块。我已经能够成功地做到这一点。当我从命令行导入 MySQLdb 时，它工作正常。但是，我将 Eclipse 配置为指向我的 Python27 解释器，当我尝试从 Eclipse 导入 MySQLdb 时，出现架构不匹配错误。这是确切的错误

```
ImportError:
dlopen(/Users/bhaskaar/.python-eggs/MySQL_python-1.2.3-py2.7-macosx-10.7-intel.egg-tmp/_mysql.so,2): no suitable image found.
Did find: /Users/bhaskaar/.python-eggs/MySQL_python-1.2.3-py2.7-macosx-10.7-intel.egg-tmp/_mysql.so: mach-o, but wrong architecture 
```

在 Pythonpath 下的 External Library 选项卡中，我指向

```
/usr/local/lib/python2.7/site-packages/MySQL_python-1.2.4c1-py2.7-macosx-10.7-x86_64.egg/_mysql.so 
```

这是更多信息

```
$ file $(which python)
/usr/local/bin/python: Mach-O 64-bit executable x86_64
$ file $(which mysql)
/usr/local/bin/mysql: Mach-O 64-bit executable x86_64 
```

你能帮我解决这个问题吗？对我来说，Eclipse 似乎将所有东西都构建为 32 位而不是 64 位，但我不确定。谢谢

# mongodb - 使用 MongoDB Mongoose 驱动程序检索数组中的单个对象

> ID：13998812
> 
> 赞同：1
> 
> 时间：2012-12-22T00:08:57.023
> 
> 标签：mongodb, mongoose

我有一个与此类似的文档：

```
{
    'user_id':'{1231mjnD-32JIjn-3213}',
    'name':'John',
    'campaigns':
        [
            {
                'campaign_id':3221,
                'start_date':'12-01-2012',
                'worker_id': '00000'
            },
            {
                'campaign_id':3222,
                'start_date':'13-01-2012',
                'worker_id': '00000'
            },
            ...
            etc
            ...
        ]
} 
```

我正在尝试检索`campaigns`数组中的对象。
例如，我想在给定的位置元素`campaign_id`下找到，比如 7。 换句话说，找到并返回数组中位置 7 的位置。 `name: "John"`
`campaign_id``campaigns`

使用猫鼬驱动程序：

`camps.findOne({name: 'John'}, {name: 1, "campaigns.7.campaign_id": 1}, function(err, camp) {etc});`
`camps.findOne({name: 'John'}, {name: 1, "campaigns[7].campaign_id": 1}, function(err, camp) {etc});`

在这里，我试图`"campaigns.7.campaign_id": 1`在位置 7检索。
不幸的是，这不会返回特定的`campaign_id`.

关于如何在数组内的位置 7 检索对象的任何建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:23:53.907

使用[`$slice`](http://docs.mongodb.org/manual/reference/operators/#_S_slice)投影运算符执行此操作：

```
camps.findOne({name: 'John'}, {
    name: 1, 
    'campaigns.campaign_id': 1, 
    campaigns: {$slice: [7, 1]}
}, ... 
```

# c# - 为什么 RDLC Report 直接打印到 POS 打印机时会缩小报表

> ID：13998813
> 
> 赞同：2
> 
> 时间：2012-12-22T00:08:58.543
> 
> 标签：c#, printing, report, rdlc

我正在尝试使用 MSDN（[链接](http://msdn.microsoft.com/en-us/library/ms252091.aspx)`RDLC`）中的源代码将报告直接打印到 POS 打印机，通过将报告导出到（）图像，然后使用将图像打印到打印机，我根据数字计算报告的高度行数（一行的高度 = 0.6 厘米）。`EMF``PrintDocument`

问题是当报告太长（超过一页）时，我将其行彼此收缩（压缩）。

如何解决这个问题呢 ？我是否必须使用 POS 打印机库 (.NET POS) 而不是将报告导出到图像并打印图像？. [您可以从 (这里](http://www.c-sharpcorner.com/Forums/UploadFile/houssam11350/12212012184019PM/exportrdlcreport.rar))下载源代码。

先谢谢了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T15:05:47.900

另一种解决方案是将大图像（我将报告导出到它）打印到许多页面：

```
private void PrintPage(Object sender, PrintPageEventArgs ev)
        {
            if (pageImage == null)
                return;
            ev.Graphics.PageUnit = GraphicsUnit.Pixel;

            ev.Graphics.InterpolationMode = InterpolationMode.HighQualityBicubic;
            ev.Graphics.PixelOffsetMode = PixelOffsetMode.HighQuality;
            float a = (ev.PageSettings.PrintableArea.Width / 100) * ev.Graphics.DpiX;
            float b = ((ev.PageSettings.PrintableArea.Height / 100) * ev.Graphics.DpiY);
            float scale = 1500;
            scale = 0;
            RectangleF srcRect = new RectangleF(0, startY, pageImage.Width, b - scale);
            RectangleF destRect = new RectangleF(0, 0, a, b);
            ev.Graphics.DrawImage(pageImage, destRect, srcRect, GraphicsUnit.Pixel);
            startY = startY + b - scale;
            float marignInPixel = (0.5f / 2.54f) * ev.Graphics.DpiY;
            ev.HasMorePages = (startY + marignInPixel < pageImage.Height);
        } 
```

[你可以从（这里](http://www.c-sharpcorner.com/Forums/UploadFile/houssam11350/12222012095334AM/exportrdlcreport_update_2.rar)）下载源代码

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T15:02:00.683

我通过改变纸张的大小来解决它：

```
PaperSize pkCustomSize = new System.Drawing.Printing.PaperSize("Custom Paper Size", Convert.ToInt32((WidthInInCM / 2.54) * 100), Convert.ToInt32((HeightInInCM / 2.54) * 100));
            printDoc.DefaultPageSettings.PaperSize = pkCustomSize;
            printDoc.DefaultPageSettings.Margins.Top = 0;
            printDoc.DefaultPageSettings.Margins.Bottom = 0;
            printDoc.DefaultPageSettings.Margins.Left = 0;
            printDoc.DefaultPageSettings.Margins.Right = 0;

            if (!printDoc.PrinterSettings.IsValid)
            {
                String msg = String.Format("Can't find printer \"{0}\".", PrinterName);
                MessageBox.Show(msg, "Print Error");
                return;
            }
            printDoc.PrinterSettings.DefaultPageSettings.PaperSize = printDoc.DefaultPageSettings.PaperSize;
            printDoc.PrinterSettings.DefaultPageSettings.Margins = printDoc.DefaultPageSettings.Margins; 
```

[您可以从（此处](http://www.c-sharpcorner.com/Forums/UploadFile/houssam11350/12222012095334AM/exportrdlcreport_updated.rar)）下载更新的源代码。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-01T20:02:24.223

我一直被困在一个类似的问题上。

我已经设法使用以下方法修复它：

```
 private void PrintPage(object sender, PrintPageEventArgs ev)
    {

        Metafile pageImage =
          new Metafile(m_streams[m_currentPageIndex]);
//That's the fix - Units set to Display
        ev.Graphics.PageUnit = GraphicsUnit.Display;
//Drawing it scaled
        ev.Graphics.DrawImage(pageImage, 0, 0, ev.MarginBounds.Width, ev.MarginBounds.Height);

        m_currentPageIndex++;
        ev.HasMorePages = (m_currentPageIndex < m_streams.Count);            
    } 
```

页面被绘制到缩放的打印机画布上。

# wcf - WCF Windows 服务故障转移机制（两个 WCF Windows 服务之间的通信）

> ID：13998814
> 
> 赞同：1
> 
> 时间：2012-12-22T00:09:07.567
> 
> 标签：wcf, windows-services, msmq, failover

我需要为以下场景设置故障转移机制。我有一个 WCF windows 服务，它将有 4 个实例（位置“A”将有一个主 (PA) 和辅助 (SA)，位置“B”将有两个实例主 (PB) 和辅助 (SB)）。在任何给定时间，每个位置的一个实例都应该启动并运行（即活动），而另一个是非活动的。考虑一次一个位置，辅助（非活动）应该能够 PING 主要（活动）以获取健康信息。如果发现它不是“健康的”，那么辅助（非活动）应该自行激活。

如果将 Primary 和 Secondary 视为在两台不同的机器/同一台机器本身上，解决方案会有多大不同？

对于如何实现相同行为，我将不胜感激您的专家意见。

问候！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T12:43:25.937

我认为你应该重新考虑你的故障转移策略。

将服务配置为在主动-被动故障转移/负载平衡配置中运行存在许多问题

1.  需要复杂的管理 - 服务需要相互了解，这会产生复杂性和耦合。
2.  您可以丢弃消息/请求 - 例如，服务 A 在处理消息时失败，那么服务 B 将不会处理该消息，除非服务 B 有某种方式知道该消息未被处理。

我已经实现了两种主动-主动服务配置模式：*依次过滤*或*完全冗余*。

在过滤器配置中，消息/请求将通过网络负载平衡器进入可用服务之一。

在完全冗余的配置中（这是我更喜欢的配置），消息/请求同时广播到所有可用的服务。这意味着您向每个服务发送多个相同的调用副本，并同时处理它们。

这两种故障转移配置都会给您带来好处，但我认为完全冗余的配置更好，因为您不需要负载均衡器。

# java - 必须捕获或声明抛出未报告的异常

> ID：13998815
> 
> 赞同：-1
> 
> 时间：2012-12-22T00:09:28.740
> 
> 标签：java

> **可能重复：**
> [为什么我得到“异常；当我尝试编译我的 Java 代码时，必须被捕获或声明被抛出？](https://stackoverflow.com/questions/908672/why-do-i-get-exception-must-be-caught-or-declared-to-be-thrown-when-i-try-to)

谢谢家伙解决了我的第一个问题，我现在遇到了一个新错误

```
import java.io.*;
import javax.swing.*;

public class FileBrowser {
    public static void main(String[] args) throws IOException {

        JFileChooser chooser = new JFileChooser();
        chooser.showOpenDialog(null);
        File file = chooser.getSelectedFile();
        String filename = file.getName();
        System.out.println("You have selected: " + filename);

        FileReader fr = new FileReader("filename"); 
        BufferedReader br = new BufferedReader(fr); 
        String s; 
        while((s = br.readLine()) != null) { 
            System.out.println(s); 
        } 
        fr.close(); 
    }
} 
```

错误 ：

```
java.io.FileNotFoundException: filename (The system cannot find the file specified)
    at java.io.FileInputStream.open(Native Method)
    at java.io.FileInputStream.<init>(FileInputStream.java:138)
    at java.io.FileInputStream.<init>(FileInputStream.java:97)
    at java.io.FileReader.<init>(FileReader.java:58)
    at FileBrowser.main(FileBrowser.java:13) 
```

是没有从文件浏览器正确获取文件名的错误吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-22T00:11:44.673

Java中有已检查和未检查的异常。必须声明您的方法抛出的已检查异常。构造[`FileReader`函数](http://docs.oracle.com/javase/6/docs/api/java/io/FileReader.html#FileReader%28java.lang.String%29)可以抛出一个`FileNotFoundException`已检查异常。代码中的一些其他方法调用也可能引发检查异常。

如果您调用一个可以抛出已检查异常的方法，那么您要么需要捕获异常并处理它，要么声明您的方法抛出此异常。即使您相信永远不会抛出异常，您也必须执行其中一项。不这样做是编译错误。

添加一个`throws`：

```
public static void main(String[] args) throws IOException { 
```

或者用 try/catch 块包围代码：

```
try {
    // ...
} catch (IOException e) {
    e.printStackTrace();
    // Or ask the user for a different filename...
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:12:00.570

包围`FileReader fr = new FileReader("filename")`；尝试并捕获如下：

```
try {
     FileReader fr = new FileReader("filename"); 
} catch (Exception e) {
    System.out.println("Error: " + e);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:24:41.540

除了**Adel Boutrons 和 Mark Byers**的 答案。您还需要进行一些更改。

首先，您正在选择文件选择器，因此您还需要

```
 String path = file.getAbsolutePath(); 
```

这将给出您的文件的绝对路径，包括您的文件名。

```
 FileReader fr = new FileReader("filename"); 
```

在这里你没有给出任何文件名，只是字符串，删除“文件名”。

```
 FileReader fr = new FileReader(path.replace("\\", File.separator)); 
```

如果未找到文件，则会抛出 FileNotFoundException。

# c++ - Qt5 使用 QWidget 和 QtQuick2

> ID：13998817
> 
> 赞同：4
> 
> 时间：2012-12-22T00:09:37.997
> 
> 标签：c++, qwidget, qt-quick, qt5

Qt5 和 QtQuick2 的组合存在一些问题。每当您想使用许多基于 QWidget 的类时，您首先会遇到以下问题：

您应该使用`QApplication`而不是 Qt5 的`QGuiApplication`. 那么这很容易改变，对吧？

所以现在我正在使用`QApplication`，但每当我尝试使用基于 QWidget 的类时，我的程序要么崩溃，要么导致一些无意义的错误消息。

**那我应该如何将旧的 QWidgets 与 Qt5 一起使用？**我知道它们不是 Qt5 的最佳解决方案，但它们非常有用......

*PS我正在Linux中为所有平台开发我的应用程序。
我还使用自动生成的 QtQuick2ApplicationViewer 类来渲染基于 QtQuick 2.0 的应用程序。*

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-11-09T12:11:26.880

在 Qt 5.1 中（大概从现在开始）你应该使用 QWidget::createWindowContainer。您的应用程序应该是基于 QWidget 的应用程序，并将 QML 放在 QWidgets 中。不支持将 QWidgets 放入 QML 应用程序。请参阅此[博客条目](http://blog.qt.digia.com/blog/2013/02/19/introducing-qwidgetcreatewindowcontainer "博客条目")。

如果您有一个表单类并且您想将 qml 放入容器小部件中。

如果你有这个 QML：

```
import QtQuick 2.0

Rectangle {
    property alias text: textItem.text
    width: 156
    height: 35
    Text {
        width: 150
        height: 20
        text: qsTr("Hello World")
        id: textItem
    }
} 
```

在名为 myqml.qml 的文件中，然后将其路径放入资源文件的 qml 前缀中。

然后放入表单构造函数：

```
ui->setupUi(this); // as normal
QQuickView* view = new QQuickView();
QWidget* widget = QWidget::createWindowContainer(view, ui->container);
view->setSource(QUrl("qrc:/qml/myqml.qml"));
if(view->status()!=QQuickView::Ready)
    qDebug("can't initialise view");
widget->setMinimumSize(500,100);
QQuickItem* container = view->rootObject(); 
```

然后当你想与 QML 交互时：

```
container->setProperty("text", "Hello alternate universe"); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-22T20:36:55.527

看来这是一个已知的错误： [https ://bugreports.qt.io/browse/QTBUG-25​​643](https://bugreports.qt.io/browse/QTBUG-25643)

这似乎也有可能的解决方案/解决方法的链接，但我没有检查它们。

关于 QWidgets 和“它们不是最好的解决方案”：首先，在具有完整桌面 Qt Quick 组件的未来 Qt 5.1（或任何版本）之前，它们是常规桌面应用程序的唯一明智选择，并且只有根据定义，选项是最佳选项；）

但即使在未来，QWidgets 也是 Qt5 应用程序 100% 有效的选择。他们唯一的问题是，他们不太可能发展太多，所以你现在拥有的，是你将拥有的最好的。如果没问题，那么他们就是选择的解决方案。

# javascript - Google Street View API：通过双击禁用更改位置

> ID：13998823
> 
> 赞同：2
> 
> 时间：2012-12-22T00:10:53.073
> 
> 标签：javascript, google-maps, google-maps-api-3, dom-events

我正在使用 Google Street view API 并且想要禁用除平移和缩放之外的所有控件。如果您单击或双击它会将您的位置更改为该位置。现在我正在使用 'position_changed' 事件来检查用户是否更改了位置，然后尝试将位置重置为原始位置。这是一个黑客，但我发现这一切都是可能的。我遇到的问题是我陷入了无限循环。

```
 var origPosY = panorama.getPosition().Ya,
            origPosX = panorama.getPosition().Za,
            originalPos = new google.maps.LatLng(panorama.getPosition().Ya, panorama.getPosition().Za);

        google.maps.event.addListener(panorama, 'position_changed', function() {
            //console.log('Position changed',panorama.getPosition().Ya, panorama.getPosition().Za);
            //var newPos = new google.maps.LatLng(panorama.getPosition().Ya, panorama.getPosition().Za);
            if( origPosY != panorama.getPosition().Ya ){
                console.log('Resetting pos');
                panorama.setPosition(originalPos); 
            }

        }); 
```

看来，当我检查以确保它们不同时，它仍在 if 语句中。有谁知道禁用此功能的任何其他方法？它们允许您禁用所有控件，但不能禁用双击和鼠标滚轮。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-22T01:53:16.243

设置选项`clickToGo`和`scrollwheel`_`panorama``false`

# python - 在可分发的 Python 模块中包含 pdftk

> ID：13998830
> 
> 赞同：2
> 
> 时间：2012-12-22T00:12:07.230
> 
> 标签：python, ghostscript, pdftk

如何在可分发的 Python 程序中包含 pdftk 和 gsprint？

我编写[了一个简短的 Python 模块](https://github.com/mmparker/printpack/blob/master/printpack.py)，它接收几个源 PDF，重新排列页面，然后将它们打印成正确排序、有用的装订数据包（我也会感谢[GitHub](https://github.com/mmparker/printpack/blob/master/printpack.py)上有关该模块的任何反馈）。这使得一次打印大量这些数据包变得容易得多。我使用[pdftk](http://www.pdflabs.com/tools/pdftk-the-pdf-toolkit/)和[gsprint](http://pages.cs.wisc.edu/~ghost/gsview/gsprint.htm) (via `subprocess.call`) 来整理和打印 PDF。

现在，我希望能够将其分发给我在全国其他研究地点的同事。我对它们做了三个假设：

1.  他们在技术上比我少得多，因此安装 pdftk 和 gsprint 并进入他们的系统路径可能会很困难（假设他们的本地 IT 甚至允许这样的事情）；
2.  他们几乎都在使用 Windows。
3.  用户不会安装 Python（实际上有些人会安装，但谁知道呢）

我的*理想*是一个可执行文件，其中包含一个 Python 解释器、我的模块、pdftk、Ghostscript 和 gsprint。这可行吗？如果可行，怎么做？我看过一些关于使用 C 和 Java 库的教程，但似乎我只是没有词汇和概念知识来解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T03:06:57.610

要创建单个独立的可执行文件，您可以使用[pyinstaller](http://www.pyinstaller.org/) *...完全自包含，它在没有任何外部依赖的情况下运行。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T13:59:41.767

您需要冻结您的 Python 项目，为此使用冷冻机：

*   [http://cx-freeze.sourceforge.net/](http://cx-freeze.sourceforge.net/)
*   [http://www.py2exe.org/](http://www.py2exe.org/)

该任务通常就像执行一个简单的命令一样简单，例如`cxfreeze main.py --target-dir dist`或创建一个`setup.py`文件，其中调用了冷冻机的特定方法。在大多数情况下，它会自动计算依赖关系，但请查看文档。

# php - 客人使用“立即付款”按钮结账 (dwolla)

> ID：13998832
> 
> 赞同：4
> 
> 时间：2012-12-22T00:12:11.580
> 
> 标签：php, dwolla

我查看了文档，但找不到如何使用“立即付款”按钮将 AllowFundingSources 设置为“true”的示例。

访客结帐是否仅用于服务器到服务器结帐？

是否有使用访客结帐的完整示例？（不仅仅是片段）。

这是我的按钮代码：

```
<a data-key="YOUR-KEY-HERE" 
data-tax="0" data-shipping="0" data-amount="941.00"
data-desc="Invoice: WDGR112612" 
data-name="October - November " class="dwolla_button" 
href="http://mysite.com/paym/?type=success">Continue</a> 
```

表格代码：

```
 <p> <?php
    $key = "YOUR_APPLICATION_KEY";
    $secret = "YOUR_APPLICATION_SECRET";
    $timestamp = time();
    $order_id = 1;

    $signature = hash_hmac('sha1', "{$key}&{$timestamp}&{$order_id}", $secret);
    ?>
    <form accept-charset="UTF-8" action="https://www.dwolla.com/payment/pay"
    method="post">

    <input id="key" name="key" type="hidden" value="abcdefg" />
    <input id="signature" name="signature" type="hidden" value="abcd" />
    <input id="callback" name="callback" type="hidden"
    value="http://www.mywebsite.com/callback.aspx" />
    <input id="redirect" name="redirect" type="hidden"
    value="http://www.mywebsite.com/redirect.aspx" />
    <input id="test" name="test" type="hidden" value="true" />
    <input id="name" name="name" type="hidden" value="Purchase" />
    <input id="description" name="description" type="hidden"
    value="Description" />
    <input id="destinationid" name="destinationid" type="hidden"
    value="812-111-1111" />
    <input id="amount" name="amount" type="hidden" value="1.00" />
    <input id="shipping" name="shipping" type="hidden" value="0.00" />
    <input id="tax" name="tax" type="hidden" value="0.00" />
    <input id="orderid" name="orderid" type="hidden" value="188375" />
    <input id="timestamp" name="timestamp" type="hidden"
    value="1323302400" />

    <button type="submit">Pay Now</button>
    </form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-14T20:01:42.607

实际上有一种更简单的方法可以在付款按钮上启用访客结帐......

只需将“allow-guest-checkout”属性添加到标签中，如下所示：

`<a href="http://www.example.com" class="dwolla_button" data-key="..." data-tax="0" data-shipping="0.99" data-amount="0.00" data-desc="A button [1]" data-name="Testing mode [1]" data-guest-checkout="true" >A button with GC</a>`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-28T22:00:19.437

要在异地网关会话中启用访客结帐，您需要在 POST 请求中将“AllowFundingSources”的值设置为“true”。那是以下行：

```
<input id="AllowFundingSources" name="AllowFundingSources" type="hidden" value="true" /> 
```

为此，您需要形成一个类似于以下内容的请求：

```
{
  "Key": "testkey",
  "Secret": "testsecret",
  "PurchaseOrder": {
  "DestinationId": "000-000-0000",
  "Discount": 0.00,
  "AllowFundingSources": "true",
  "OrderItems": [
      {
          "Description": "Information about an item",
          "Name": "An item",
          "Price": 5.00,
          "Quantity": 1
      }
  ],
  "Shipping": 0.00,
  "Tax": 0.00,
  "Total": 5.00
  }
} 
```

可以在[此处](http://developers.dwolla.com/dev/docs/gateway/guest)找到有关此主题的任何更新。

# cuda - CUDA nvcc 编译器设置 Ubuntu 12.04

> ID：13998834
> 
> 赞同：5
> 
> 时间：2012-12-22T00:12:35.013
> 
> 标签：cuda, nvcc

我在 64 位 Ubuntu 12.04 机器上成功安装了 cuda 5（但不是示例）的 nvidia 驱动程序和工具包。即使我之前运行过，样本也无法安装

> $ sudo apt-get install freeglut3-dev build-essential libx11-dev libxmu-dev libxi-dev libgl1-mesa-glx libglu1-mesa libglu1-mesa-dev

我似乎无法找到 nvcc。我跑了

> $ export LD_LIBRARY_PATH=/usr/local/cuda-5.0/lib:/usr/local/cuda-5.0/lib64:$LD_LIBRARY_PATH

nvcc -v 报告找不到编译器：

> nvcc -V No command 'nvcc' found, 你的意思是：命令 'nvlc' from package 'vlc-nox' (universe) nvcc: command not found

入门指南在这里没有太大帮助：http: [//docs.nvidia.com/cuda/cuda-getting-started-guide-for-linux/index.html](http://docs.nvidia.com/cuda/cuda-getting-started-guide-for-linux/index.html)

这里发生了什么？我是否需要安装 gpu 计算 sdk 示例才能获得 nvcc？：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-08-13T05:02:25.817

考虑在 Ubuntu 12.04 中安装 CUDA 5.5。5.5 版本具有将其安装为 debian 软件包的特殊优势。请参阅以下链接，

[https://developer.nvidia.com/content/cudacasts-episode-5-install-cuda-55-linux-package-manager](https://developer.nvidia.com/content/cudacasts-episode-5-install-cuda-55-linux-package-manager)

[https://developer.nvidia.com/cuda-downloads](https://developer.nvidia.com/cuda-downloads)

这确实比您到目前为止所尝试的所有方法都容易得多！个人经验 ！:-)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T11:06:36.020

未能安装示例是一个常见问题，如[https://sn0v.wordpress.com/2012/12/07/installing-cuda-5-on-ubuntu-12-04/#comment-869中所述](https://sn0v.wordpress.com/2012/12/07/installing-cuda-5-on-ubuntu-12-04/#comment-869)

解决方案是找到“libglut.so”并在/usr/lib 下创建一个指向它的软链接。然后重新运行 cuda*.run 并选择仅安装示例。

```
sudo find /usr -name libglut\*

sudo ln -s /usr/lib/x86_64-linux-gnu/libglut.so.3 /usr/lib/libglut.so

sudo ./cuda*.run #when prompted only install samples. ie do not install drivers and toolkit. 
```

在 ubuntu 12.04 上为我工作希望它也适合你

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-16T10:02:30.440

我在安装过程中遇到了问题，但我发现`sudo ln -s /usr/lib/x86_64-linux-gnu/libglut.so.3 /usr/lib/libglut.so`没有用。我的解决方案是先安装freeglut3：

```
`sudo apt-get install freeglut3` 
```

然后使用：

`sudo ln -s /usr/lib/libglut.so.3 /usr/lib/libglut.so`

在此之后，CUDA 示例已成功安装。

# java - 用 OpenGL 读取像素颜色？

> ID：13998836
> 
> 赞同：2
> 
> 时间：2012-12-22T00:13:06.297
> 
> 标签：java, opengl, collision-detection, lwjgl

我试图通过读取对象旁边像素的像素颜色来进行碰撞，但我对如何实现这一点感到困惑。

我读过关于`glreadpixels`，但我不太了解参数，尤其是最后一个，它应该是 type `ByteBuffer`。谁能向我解释我该如何做到这一点，或者可能是一种更好的方法来进行简单的碰撞检测？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:55:48.393

这绝对不是进行碰撞检测的最简单或最有效的方法，但要回答您的问题；

```
ByteBuffer RGB = ByteBuffer.allocateDirect(3); //create a new byte buffer (r, g, b)

int x=1, y=1;

GL11.glReadPixels(x, y, //the x and y of the pixel you want the colour of
1, 1,                   //height, width of selection. 1 since you only want one pixel
GL11.GL_RGB,            //format method uses, get red green and blue
GL11.GL_UNSIGNED_BYTE,  //how the method is performed; using unsigned bytes
RGB);                   //the byte buffer to write to

float red, green, blue;

red = RGB.get(0)/255f,   //get the first byte
green = RGB.get(1)/255f, //the second
blue = RGB.get(2)/255f;  //and third 
```

要获得进行碰撞检测的最佳方法，请快速搜索：[2D 中的基本碰撞检测 - 第 1 部分](http://devmag.org.za/2009/04/13/basic-collision-detection-in-2d-part-1/)。

它看起来非常有用。

# html - 微数据——撰写评论文章

> ID：13998838
> 
> 赞同：2
> 
> 时间：2012-12-22T00:13:24.750
> 
> 标签：html, schema.org, microdata

我只是想知道是否有人可以帮助我处理一些微数据。这就是我正在使用的：

> 我正在制作一个网站，他们可以在其中查看其他网站。所以评论是一篇文章。每条评论/文章都包含名称和文本以及评级。有两种评级，一种是网站/作者制作的，另一种是访问者的。评分在 1-10 之间。

这是我到目前为止所做的（我正在使用 schema.org）：

正文是一个[WebPage](http://schema.org/WebPage)。然后我有一个内容区域是[Review](http://schema.org/Review)。评论包含名称/标题和评论本身（reviewBody）。

然后我有评分。我说有作者评分和访客评分。所以我把它们做成了[AggregateRating](http://schema.org/AggregateRating)。像这样：

```
<div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
    <meta itemprop="worstRating" content="1">
    <meta itemprop="bestRating" content="10">
    <strong itemprop="ratingValue">8.33</strong>
    <span>by "the site"</span>
</div> 
```

所以我的问题是：这是正确的做法吗？这甚至是实际评级吗？你会怎么做？

[此外，当使用Google 的结构化数据工具](http://www.google.com/webmasters/tools/richsnippets)检查我的示例页面时，数据的定义符合我的预期，但我没有得到漂亮的丰富片段，即带有星星的片段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-28T22:24:44.550

您错过`revewCount`了 aggregateRating 的属性。

```
<div itemscope itemtype="http://schema.org/WebPage">
  <div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
    <meta itemprop="worstRating" content="1">
    <meta itemprop="bestRating" content="10">
    <meta itemprop="reviewCount" content="20">
    <strong itemprop="ratingValue">8.33</strong>
    <span>by "the site"</span>
  </div>
</div> 
```

这个标记应该可以正常工作。使用 Google 的[结构化数据工具对其进行了检查。](http://www.google.com/webmasters/tools/richsnippets?url=&html=%3Cdiv%20itemscope%20itemtype=%22http://schema.org/WebPage%22%3E%0D%0A%20%20%3Cdiv%20itemprop=%22aggregateRating%22%20itemscope%20itemtype=%22http://schema.org/AggregateRating%22%3E%0D%0A%20%20%20%20%3Cmeta%20itemprop=%22worstRating%22%20content=%221%22%3E%0D%0A%20%20%20%20%3Cmeta%20itemprop=%22bestRating%22%20content=%2210%22%3E%0D%0A%20%20%20%20%3Cmeta%20itemprop=%22reviewCount%22%20content=%2220%22%3E%0D%0A%20%20%20%20%3Cstrong%20itemprop=%22ratingValue%22%3E8.33%3C/strong%3E%0D%0A%20%20%20%20%3Cspan%3Eby%20%22the%20site%22%3C/span%3E%0D%0A%20%20%3C/div%3E%0D%0A%3C/div%3E)

# c++ - 如何找到数组中特定值的频率？

> ID：13998839
> 
> 赞同：0
> 
> 时间：2012-12-22T00:13:25.470
> 
> 标签：c++

我是 C++ 编程的新手，我正在关注 Alex Alllain 的这本书，名为 jumping into C++，书中有一个井字游戏练习，我很难完成那个练习，到目前为止我'已经完成的是提示用户输入 X 或 O 值，它们存储在二维数组中，我想跟踪例如 char X 是否在数组中出现 3 次，到目前为止我使用 counter++ 但它只增加一次。下面是我到目前为止所做的事情的来源，希望它能让我的问题更加清晰，并让我知道我在代码的外观方面是如何做的，比如它的结构和功能：

```
#include "stdafx.h"
#include "iostream"
#include "string"

using namespace std;

void display_array(char array[][3]);
void check_input(char array[][3], int input);
void check_winner(char array[][3]);
int check_x(char array[][3]);
int check_o(char array[][3]);

int _tmain(int argc, _TCHAR* argv[])
{
    char array[3][3];
    int counter = 0;

    for(int row = 0; row < 3; row++){

        cout << "\n";

        for(int col = 0; col < 3; col++){
            counter++;
            array[row][col] = counter;
        }
    }

    display_array(array);

    system("PAUSE");
    return 0;
}

void display_array(char array[][3]){

    int position_input;
    string symbol_input;

    do{

    for(int i=0; i < 3; i++){

        for(int j=0; j < 3; j++){
            cout << " [ ";
            cout << array[i][j];
            cout << " ] ";
        }
        cout << "\n";
    }

    cout << "Position: ";
    cin >> position_input;

    check_input(array, position_input);

    }while(position_input != 0);
} 

void check_input(char array[][3], int input)
{
    char user_input = input;

    for(int i = 0; i < 3; i++)
    {
        for(int j = 0; j < 3; j++)
        {
            if(user_input == array[i][j])
            {
                cout << "array[" << i << "][" << j << "] replace with: ";
                cin >> array[i][j];

            }   

        }
    }
    check_winner(array);
}
void check_winner(char array[][3]){
    cout << check_x(array);

    if(check_x(array) == 3){
        cout << check_x(array);
    }

    else if(check_o(array) == true){
        cout << "o";
    }

}
int check_x(char array[][3]){
    int counter, x[3];
    counter = 0;

    for(int i = 0; i < 3; i++){
        for(int j = 0; j < 3; j++){
            if(array[i][j] == array[i][j]){
                counter++;
            }
            x[i] = counter;
            return x[i];
        }
    }

}
int  check_o(char array[][3]){

    int counter;
    counter = 0;

    for(int i = 0; i < 3; i++){
        for(int j = 0; j < 3; j++){
            if(array[i][j] == 'o'){
                counter++;
                return counter;
            }else{
                return counter;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:28:21.217

你有一堆小问题，但最直接的问题似乎是这种事情：

```
for(int i = 0; i < 3; i++){
    for(int j = 0; j < 3; j++){
        if(array[i][j] == 'o'){
            counter++;
            return counter;
        }else{
            return counter;
        }
    }
} 
```

无论测试的元素是否为“o”，您都将在一个循环后返回。把它改成这样：

```
for(int i = 0; i < 3; i++){
    for(int j = 0; j < 3; j++){
        if(array[i][j] == 'o')
            counter++;
    }
}

return counter; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-30T18:21:07.313

**我的答案：**

首先是问题的最后一部分：编码看起来不错，如果您对某些操作进行评论，即使程序非常引人注目（// /* */），我也会很高兴。

在我看来，你的问题在解决练习方面有点误导。我一开始也是这样想你的。问题是模式不仅仅被频率 3 检测到，因为它会允许错误的检查模式。使其可视化：

```
7 8 9
4 5 6
1 2 3 
```

fe 3 的频率如 1,2,5 或 9 6 5 不是正确答案，但 - 1 5 9 是。即使你计算了每一个频率模式——它也会比我在我的解决方案的以下博客中定义的解决方案编码更多：

```
 status_check = possibilities(field,player,2,0,1,1,0,2); //diagonal 1 5 9
    status_check = possibilities(field,player,0,0,1,1,2,2); //diagonal 7 5 3
    status_check = possibilities(field,player,0,0,1,0,2,0); //vertical 7 4 1
    status_check = possibilities(field,player,0,1,1,1,2,1); //vertical 8 5 2
    status_check = possibilities(field,player,0,2,1,2,2,2); //vertical 9 6 3
    status_check = possibilities(field,player,0,0,0,1,0,2); //horizontal 7 8 9
    status_check = possibilities(field,player,1,0,1,1,1,2); //horizontal 4 5 5
    status_check = possibilities(field,player,2,0,2,1,2,2); //horizontal 1 2 3 
```

*这就是我认为可以使用数字键盘进行锻炼的方式。（我为那段代码感到非常自豪。:-)）

顺便说一句，我很喜欢那本书，但很遗憾，我想不出那本书：“奖励：你能不能让你的程序在整个格子填满之前检测出比赛是否不能由任何一方获胜？” 但如果有人跳过那一章 - 这个解决方案肯定会有所帮助：*

*练习如下*（第 121 页，跳转到 Cpp）：

> 编写一个小型井字游戏程序，让两个玩家竞争性地玩井字游戏。您的程序应检查是否有任何玩家获胜，或者棋盘是否已完全填满（游戏以平局结束）。奖励：你可以让你的程序在整个网格被填满之前检测到任何一方都无法赢得比赛吗？

以下代码可以使用 c++ 17 标准进行简单编译和执行，并且所有库都应该在 gcc (GCC) 8.2.1 中可用

```
#include <iostream>
#include <string>
#include <limits> //just for the input validation

using namespace std;

int input_check(char field[3][3],char player);
void display_field(char field[3][3],int size);
void initialize_field(char field[3][3],int size,char player);
string win_check(char field[3][3],char player,int size);
int code(char field[3][3],int i,int j,char player);
int possibilities(char field[3][3],char player,int a,int aa,int b,int bb,int c,int cc);

int main()
{
  char field[3][3];
  int size = 3;
  char player ='-';

  initialize_field(field,size,player);
  display_field(field,size);

  while (field[0][0]!='w')
    {
      player = 'X';
      input_check(field,player);
      system("clear");
      display_field(field,size);
      cout << win_check(field,player,size);

      if (field[0][0] =='w')
      {
        cout << endl;
        break;
      }
      player = 'O';
      input_check(field,player);
      system("clear");
      display_field(field,size);
      cout << win_check(field,player,size);

      if (field[0][0] =='w')
      {
        cout << endl;
        break;
      }
    }
return 0;
}

void initialize_field(char field[3][3],int size,char player)
{
  int i,k;
  for (i = 0; i < size; i++)
    {
      for (k = 0; k < size; k++)
        {
          field[i][k]= player;
        }
    }
}

int input_check(char field[3][3],char player)
{
  int input = 0;
  bool def = false;
  while (def != true)
  {
    while(!(cin >> input))
      {  //check the Input format for integer the right way
        cin.clear();
        cin.ignore(numeric_limits<streamsize>::max(), '\n');
        cout << "Invalid input.  Try again: ";
      }
    switch (input)
    {
      case 1:{
        def = code(field,2,0,player);
        break;}
      case 2:{
        def = code(field,2,1,player);
        break;}
      case 3:{
        def = code(field,2,2,player);
        break;}
      case 4:{
        def = code(field,1,0,player);
        break;}
      case 5:{
        def = code(field,1,1,player);
        break;}
      case 6:{
        def = code(field,1,2,player);
        break;}
      case 7:{
        def = code(field,0,0,player);
        break;}
      case 8:{
        def = code(field,0,1,player);
        break;}
      case 9:{
        def = code(field,0,2,player);
        break;}
      default:{
        cout << "Invalid input.  Try again: " << endl;
        break;}
    }
  }
/*
7 8 9   00 01 02
4 5 6   10 11 12
1 2 3   20 21 22
*/
  return input;
}

int code(char field[3][3],int i,int j,char player)
{
  int def=0;
  if (field[i][j]=='-')
    {
      field[i][j]=player;
      def = true;
    }
  else
    {
      cout << "Invalid input.  Try again: " << endl;
    }
  return def;
}

void display_field(char field[3][3],int size)
{
  int i,k;
  for (i = 0; i < size; i++)
    {
      for (k = 0; k < size; k++)
        {
          cout << field[i][k];
          cout << " ";
            if (k==2) //seperate with new line after the third k
              {
                cout << endl;
              }
        }
    }
}

string win_check(char field[3][3],char player,int size)
{
  string status;
  int status_check;

  /*
  7 8 9   00 01 02
  4 5 6   10 11 12
  1 2 3   20 21 22
  */

  if ((field[0][0]!='-')&&(field[0][1]!='-')&&(field[0][2]!='-') &&(field[1][0]!='-')&&(field[1][1]!='-')&&(field[1][2]!='-')&&(field[2][0]!='-')&&(field[2][1]!='-')&&(field[2][2]!='-'))
    {
      status = "Rien ne va plus - Nichts geht mehr meine Lieben. Unentschieden";
      field[0][0]='w';
    }

    status_check = possibilities(field,player,2,0,1,1,0,2); //diagonal 1 5 9
    status_check = possibilities(field,player,0,0,1,1,2,2); //diagonal 7 5 3
    status_check = possibilities(field,player,0,0,1,0,2,0); //vertical 7 4 1
    status_check = possibilities(field,player,0,1,1,1,2,1); //vertical 8 5 2
    status_check = possibilities(field,player,0,2,1,2,2,2); //vertical 9 6 3
    status_check = possibilities(field,player,0,0,0,1,0,2); //horizontal 7 8 9
    status_check = possibilities(field,player,1,0,1,1,1,2); //horizontal 4 5 5
    status_check = possibilities(field,player,2,0,2,1,2,2); //horizontal 1 2 3

    if (status_check == true)
    {
      status = "Player " + string(1, player) + " won!!";
      field[0][0] ='w';
    }
return status;
}

int possibilities(char field[3][3],char player,int a,int aa,int b,int bb,int c,int cc)
{
  int status;

  if ((field[a][aa]==player)&&(field[b][bb]==player)&&(field[c][cc]==player))
  {
    status = true;
  }

  return status;
} 
```

# objective-c - 调试 NSMutableArray 给出超出范围的消息

> ID：13998841
> 
> 赞同：0
> 
> 时间：2012-12-22T00:14:23.967
> 
> 标签：objective-c

我在头文件中声明了一个 NSMutableArray，然后初始化它并按如下方式填充它：

```
pointArray = [[NSMutableArray alloc] initWithCapacity:200];

[pointArray addObject:[NSValue valueWithCGPoint:CGPointMake( 167.9688, 285.1563)]];
[pointArray addObject:[NSValue valueWithCGPoint:CGPointMake(   141.9678, 286.6211)]]; 
```

调试时，我看到 pointArray 的计数是正确的，但我无法查看数组中各个 CGPoint 对象的值。对于数组中的每个元素，我从调试器收到了超出范围摘要不可用的消息。

有人问过类似的问题，但我还没有找到适用于这种情况的答案。如果我遗漏了什么，我深表歉意。

提前谢谢了。

乔恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:41:27.300

我不确定你到底尝试了什么，但如果你想要例如你可以使用的第一个 CGPoint：

```
 CGPoint p = [[pointArray objectAtIndex:0] CGPointValue]; 
```

如果您只想查看它们，打印 NSValues 可以正常工作：

```
 for (NSValue *v in pointArray)
        NSLog(@"%@", v); 
```

**编辑：**

对不起，我可能误解了你的问题。我不经常使用调试器，所以我不是回答这个问题的合适人选，但[这个问题](https://stackoverflow.com/questions/5301582/xcode-4-debugging-shows-summary-unavailable-for-most-objects)可能会有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T04:23:49.760

使用 GDB/LLDB 控制台命令。

```
po pointArray 
po [pointArray objectAtIndex:0]
p (CGPoint) [[pointArray objectAtIndex:0] CGPointValue] 
```

# android-contacts - 以编程方式从 Android 中删除联系人图片

> ID：13998842
> 
> 赞同：3
> 
> 时间：2012-12-22T00:14:33.033
> 
> 标签：android-contacts

我正在尝试通过代码删除联系人图片。我通过将 Photo.PHOTO 设置为 null 来尝试此操作。但是，该语句会引发异常。这是代码：

```
ContentValues values = new ContentValues();
int             result = 0;

values.put(Data.RAW_CONTACT_ID, contactId);
values.put(Data.MIMETYPE, Photo.CONTENT_ITEM_TYPE);
values.put(Photo.PHOTO, (byte[])null);

result = getContext().getContentResolver().update(Data.CONTENT_URI, values, Data.RAW_CONTACT_ID + "=?", new String[]{String.valueOf(contactId)}); 
```

这是例外

> android.database.sqlite.SQLiteException：未知错误（代码 0）：无法在 android.database.CursorWindow.getString(CursorWindow.java:434) 的 android.database.CursorWindow.nativeGetString(Native Method) 将 BLOB 转换为字符串.database.AbstractWindowedCursor.getString(AbstractWindowedCursor.java:51) 在 com.android.providers.contacts.DataRowHandler.getAugmentedValues(DataRowHandler.java:332) 在 com.android.providers.contacts.DataRowHandlerForStructuredName.update(DataRowHandlerForStructuredName.java:70) ) 在 com.android.providers.contacts.ContactsProvider2.updateData(ContactsProvider2.java:4490) 在 com.android.providers.contacts.ContactsProvider2 的 com.android.providers.contacts.ContactsProvider2.updateData(ContactsProvider2.java:4507)。 updateInTransaction(ContactsProvider2.java:第 3875 章(ContentProvider.java:235) 在 android.content.ContentResolver.update(ContentResolver.java:990)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-04T11:22:13.297

这是删除照片的方法（基于[此帖子](https://stackoverflow.com/a/9924883/878126)）：

```
ContentProviderOperation.Builder builder = ContentProviderOperation.newUpdate(ContactsContract.Data.CONTENT_URI);

builder.withSelection(ContactsContract.Data.CONTACT_ID + "=?" + " AND " + ContactsContract.Data.MIMETYPE + "=?",
        new String[] { ContactsContract.CommonDataKinds.Photo.CONTENT_ITEM_TYPE });
builder.withValue(Integer.toString(id),ContactsContract.CommonDataKinds.Photo.PHOTO, (byte[0])null);

final ArrayList<ContentProviderOperation> ops = new ArrayList<ContentProviderOperation>();
ops.add(builder.build());
getContentResolver().applyBatch(ContactsContract.AUTHORITY, ops); 
```

# c# - 在 C# 中将 .bz2 流解压缩到文件

> ID：13998844
> 
> 赞同：6
> 
> 时间：2012-12-22T00:14:57.747
> 
> 标签：c#, sharpziplib, bzip2

我在尝试使用 SharpZipLib 库中的 .bz2 内容时遇到了真正的麻烦，而且我无法在其他地方找到任何帮助。

任何帮助或建议将不胜感激，如果有人能指出我可以从中学习的现有解决方案，那就太棒了！

以下是我正在尝试做的事情，但显然它不起作用。目前我遇到的问题是标记线上未处理“EndOfStreamException”。代码有点乱，我以前从来没有尝试过这样的事情......

正如您可能知道的那样，我是在解压缩之前从网上下载它的，但我很确定这部分代码可以正常工作。

```
while ((inputByte = responseStream.ReadByte()) != -1)
{
    using (MemoryStream ms = new MemoryStream())
    {
        using (BinaryWriter writer = new BinaryWriter(ms))
        {
            writer.Write((byte)inputByte);
        }

        using (BZip2InputStream unzip = new BZip2InputStream(ms)) //Exception occurs here
        {
            buffer = new byte[unzip.Length];
            unzip.Read(buffer, 0, buffer.Length);
        }

        using (FileStream fs = new FileStream(fPath, FileMode.OpenOrCreate, FileAccess.Write))
        {
            fs.Write(buffer, 0, buffer.Length);
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:22:25.923

您正在使用`using`语句。 语句是用于将 a包裹在代码块周围的`using`编译器指令，并将在执行时调用。`try finally``IDisposible.Dispose()``finally`

长话短说，在 , 上调用 dispose `BinaryWriter`，`BZip2InputStream`并且`FileStream`可能会过早地对 parent 进行处理`MemoryStream`。

尝试`using`从内部删除三个块`MemoryStream`，看看是否能解决您的问题。

**编辑**

您`BinaryWriter`正在`byte`向`MemoryStream`. 我不相信你需要一个`BinaryWriter`方法。`MemoryStream``WriteByte()`

然后你`BZip2InputStream`正试图从`MemoryStream`. 但是`MemoryStream`它的位置在流的末尾。没有要读取的数据，因此`EndOfStreamException`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-10-09T12:33:37.667

OP的代码有两个问题。**第一个**，正如 Jason Whitted 所提到的，是实例处理原因的`using`代码块，所以我们应该删除该块，因为它本身有一个方法，这可以使用以下方法以最干净的方式实现：`BinaryWriter``MemoryStream``MemoryStream``write`

```
var ms = new MemoryStream();
ms.Write(inputBytes,0,inputBytes.Length); 
```

**第二个问题**是，当我们写入`MemoryStream`实例（ms）时，我们走到了它的末尾，所以在我们尝试使用之前，`BZip2InputStream`我们必须将位置改回内存流的开头：

```
ms.Seek(0, SeekOrigin.Begin); //THIS IS NECESSARY to change the position to the beginning
byte[] buffer = null;
using (var bz2InputStream = new BZip2InputStream(ms))
{
       buffer = new byte[bz2InputStream.Length];
       bz2InputStream.Read(buffer, 0, buffer.Length);
} 
```

# mysql - 提高 MySQL 查询的性能

> ID：13998845
> 
> 赞同：1
> 
> 时间：2012-12-22T00:15:05.087
> 
> 标签：mysql, performance, optimization

我有一个 MySQL 查询，当前运行时间为 2.5 秒，我想将其缩短到最多 2 秒。

这是查询：

```
SELECT SQL_CALC_FOUND_ROWS Distinct(c.id) 
FROM   `content` c 
       INNER JOIN `actions` AS action 
               ON c.parent_id = action.primary_id 
WHERE  1 = 1 
       AND c.site_id IN ( 1, 2 ) 
       AND c.type IN ( 'topic' ) 
       AND c.status = 'visible' 
       AND ( c.lock = 0 
              OR c.site_id = 1 ) 
       AND ( c.level IN ( 0 ) 
              OR ( c.level IN ( 10 ) 
                   AND action.user_id = 123 
                   AND action.type IN ( 'group_follow' ) ) ) 
ORDER  BY c.date_updated DESC 
LIMIT  20 
```

以下是目前的统计数据：

*   表格内容有 55k 行
*   表操作有 87k 行

对于内容，我有以下索引：

*   parent_id (parent_id)
*   用户 ID（用户 ID）
*   type_status_date（类型、状态、日期）
*   type_status_updateddate（类型，状态，date_updated）
*   站点 ID（站点 ID）
*   type_status_level（类型、状态、级别）
*   type_parentid_level（类型，parent_id，级别）

对于操作，我有以下索引：

*   primary_id (primary_id)
*   站点 ID（站点 ID）
*   类型（类型）

任何帮助和建议将不胜感激。

谢谢大家！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:35:02.800

由于您正在执行“ORDER BY c.date_updated DESC LIMIT 20”，因此您可能需要在 c.date_updated 上创建索引。这样，mysql 可以先以相反的`date_updated`顺序扫描该表，并在它获得 20 行后立即停止。

您绝对应该`EXPLAIN`在更改之前和之后检查您的查询，以查看优化器是否选择了该顺序。`date_updated`如果优化器没有自然地选择索引，有一些方法可以强制使用索引。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-23T16:32:15.603

在 where 子句中你必须有顺序。firsts 必须是具有索引的列。

例如对于索引 type_status_updateddate (type, status, date_updated)

如果我们写

```
where status = 'blabla' and type = '1' 
```

索引不使用螺母

```
where type='1' and status='blala' 
```

使用索引。

如果列保留在索引中（在多列索引中），mysql 使用索引。例如对于索引 type_status_updateddate (type, status, date_updated)

如果我们写 where status = 'blablabla' index not using

这个事实确实使用多列索引并不酷

和

```
c.type IN ( 'topic' ) 
```

可能会被替换

```
c.type = 'topic' 
```

对不起我的英语不好。

# android - 使用后台崩溃应用程序中的对话框

> ID：13998847
> 
> 赞同：1
> 
> 时间：2012-12-22T00:15:47.997
> 
> 标签：android, android-layout

我有一堆获取数据的异步任务。它们在执行时通过显示对话框来更新进度。有时这会导致应用在后台（不可见）时崩溃。我的代码在下面调用。在不完全重构对话框的情况下，我可以做哪些检查来防止应用程序崩溃？

这些在 DownloadAsyncTask 中声明并在构造函数中传递

```
protected ProgressDialog mDialog;
protected String mDialogMessage = "Loading Data";
protected ProgressBar progBar;

doInBackground() {
    if ( mProgressBar != null && mProgressBar.getVisibility() == View.INVISIBLE) {
        mUIThreadHandler.post(new Runnable() {
            @Override
            public void run() {
                mProgressBar.setVisibility(View.VISIBLE);
            }
        });
    } else if ( mDialog != null && !mDialog.isShowing() ) {
        mUIThreadHandler.post(new Runnable() {
            @Override
            public void run() {
                mDialog.setMessage(mDialogMessage);
                mDialog.show();
            }
        });
    }
} 
```

然后`onPostExecute()`：

```
@Override
protected void onPostExecute(DefaultHandler handler) {
    super.onPostExecute(handler);
    if ( progBar != null && progBar.getVisibility() == View.VISIBLE ) {
        progBar.setVisibility(View.INVISIBLE);
    } else if ( mDialog != null && mDialog.isShowing() ) {
        try {
            mDialog.dismiss();
        } catch (Exception e) {
        }   
    }   
} 
```

更新的崩溃日志：

> 12-20 15:19:15.802: E/AndroidRuntime(9529):
> android.view.WindowManager$BadTokenException: 无法添加窗口——令牌android.os.BinderProxy@41a37908 无效；您的活动正在运行吗？12-20 15:19:15.802: E/AndroidRuntime(9529): 在 android.view.ViewRootImpl.setView(ViewRootImpl.java:567) 12-20 15:19:15.802: E/AndroidRuntime(9529): 在 android. view.WindowManagerGlobal.addView(WindowManagerGlobal.java:246) 12-20 15:19:15.802: E/AndroidRuntime(9529): 在 android.view.WindowManagerImpl.addView(WindowManagerImpl.java:69) 12-20 15:19: 15.802: E/AndroidRuntime(9529): 在 android.app.Dialog.show(Dialog.java:281) 12-20 15:19:15.802: E/AndroidRuntime(9529): 在 com.*.DownloadAsyncTask$2.run(下载AsyncTask.java:119) 12-20 15:19:15.802: E/AndroidRuntime(9529): at android.os.Handler.handleCallback(Handler.java:725) 12-20 15:19:15.802:

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T02:47:24.027

您正在从后台线程触摸 UI。Android 技术上说“不要更新”，但最好将其理解为“不要在后台线程上与 UI 交互”。您的`if`声明本质上是说“如果（...）关于 UI 是正确的，则发布此任务以*在未来某个时间在 UI 线程上*执行”。当您`Runnable`在 UI 线程上执行时，UI 的状态可能已经改变。封装整个逻辑并将其发送到要执行的 UI 线程可能会更好。您可以通过组合`Runnable`您拥有的两个 s 并在一个 s 中发送来做到这一点`post`，但`AsyncTask`设计为您不需要直接与处理程序打交道。如果您调用`publishProgress()`doInBackGround ，它将在 UI 线程上向`onProgressUpdate()`成员。因此，更容易做的事情是结合你`Runnable`的 s 中的代码并移动到`onProgressUpdate()`方法。

就像是 -

```
 void onProgressUpdate() {
            if (mProgressBar != null && mProgressBar.getVisibility() == View.INVISIBLE) {
                mProgressBar.setVisibility(View.VISIBLE);
            } else if (mDialog != null && !mDialog.isShowing()) {
                mDialog.setMessage(mDialogMessage);
                mDialog.show();
            }
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-04-06T07:30:33.223

您应该检查活动是否尚未完成。

用这个：

```
if (!isFinishing()) {
    mDialog.show();
    } 
```

查看此页面以获取更多描述：

[http://dimitar.me/android-displaying-dialogs-from-background-threads/](http://dimitar.me/android-displaying-dialogs-from-background-threads/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T05:29:51.967

使用 runOnUiThread(runnable) 避免崩溃：这实质上是在 UI 线程上运行 run 方法中的代码段。将您想要在 run 方法中执行的所有 UI 操作包装起来，如下所示。

所以代码会是这样的：

yourActivity.runOnUiThread(new Runnable() {

```
 @Override
            public void run() {
                // whatever UI operations..
                ..
                mDialog.setMessage(mDialogMessage);
                mDialog.show();
            } 
```

});

# jquery - JQuery如何限制可排序链表中的项目数 - 连接列表

> ID：13998850
> 
> 赞同：0
> 
> 时间：2012-12-22T00:16:44.703
> 
> 标签：jquery, image, linked-list, draggable, jquery-ui-sortable

我想限制可以拖入每个列表的图像数量。每次用户将克隆拖到一个连接列表中。我需要限制它们可以放入可排序列表的项目数量。

我需要自定义停止功能吗？我试过了，但它只限制了特定的图像，而不是所有的图像。我还可以做些什么？

我怎样才能做到这一点？

这是我的代码：

```
<!doctype html>
<html lang="en">
 <head>
<meta charset="utf-8" />
<link rel="stylesheet" href="http://code.jquery.com/ui/1.9.2/themes/base/jquery-ui.css" />
<script src="http://code.jquery.com/jquery-1.8.3.js"></script>
<script src="http://code.jquery.com/ui/1.9.2/jquery-ui.js"></script>
<link rel="stylesheet" href="/resources/demos/style.css" />

    <style>
        #sortable1, #sortable2, #sortable3, #sortable4 { 
            list-style-type: none; padding: 0; float: left; margin: 10px; padding: 5px; width: 95px; border: 1px dotted grey;
        }
        #sortable1 li, #sortable2 li, #sortable3 li , #sortable4 li { 
            margin: 5px; border: 1px solid grey; height:75px;
        }
        .top_area {
            margin: 10px; border: 1px solid black; width: 550px;
        }
        .drag { 
            margin: 10px;
        }
        .container {
            width:550px; margin: 10px; border: 1px solid black; height: 400px; background: lightgrey;
        }
    </style>

<script>
$(function() {
      $('.drag').draggable({
            connectToSortable: ".droptrue",
            helper: "clone",
            revert: "invalid"
       });
        $( "ul.droptrue" ).sortable({
            connectWith: "ul"
        });
     $( "#sortable1, #sortable2, #sortable3, #sortable4" ).disableSelection();
});
</script>
 </head>
 <body>
<div class="top_area">
    <img class="drag" id="1" src="small/Koala.jpg"/>
    <img class="drag" id="2" src="small/Desert.jpg"/>
    <img class="drag" id="3" src="small/Tulips.jpg"/>
</div>
<!-- 4 columns -->
<div class="container">
    <ul class="droptrue" id="sortable1" ></ul>
    <ul class="droptrue" id="sortable2" ></ul>
    <ul class="droptrue" id="sortable3" ></ul>
    <ul class="droptrue" id="sortable4" ></ul>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-20T14:00:00.553

非常类似于这个线程

[jQuery Sortable - 限制列表中的项目数](https://stackoverflow.com/questions/2438516/jquery-sortable-limit-number-of-items-in-list)

最好的方法是做这样的事情

```
$( "#slots" ).on( "sortreceive", function(event, ui) {
                                 if($("#slots li").length > 7){
                                         $(ui.sender).sortable('cancel');
                     }
        }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-24T20:49:18.877

这对我有用

```
 $("#sortable1, #sortable2, #sortable3, #sortable4").on("sortreceive", function(event, ui) {
    var list = $(this);
    if (list.children().length > 1) {
   $(ui.sender).sortable('cancel');
   }
}); 
```

# java - 具有ms访问权限的jdbc-odbc桥看不懂希腊字符？

> ID：13998855
> 
> 赞同：1
> 
> 时间：2012-12-22T00:18:20.287
> 
> 标签：java, ms-access, netbeans, jdbc, odbc

我有一个 java appl，我可以在我的 ms access 数据库和我的 appl 之间建立连接，但是当我在文本字段中写希腊字符时，我的数据库会出现不理解的字符。如果没有解决方案，我该如何更改我的数据库和源代码？

* * *

那么我怎样才能改变我的源代码来改变数据库呢？我不知道我必须使用哪个数据库（java Embedded、mysql）。我只想接受希腊字符并轻松更正我的源代码！

这是我使用数据库的源代码中的一部分......

```
String dbuser = "";
String dbpasswd = "";
String DriverPrefix = "jdbc:odbc:";
Sting DataSource = "mydatabase";
....
....
....
....
String User = usernameLoginTxtField.getText();
String Password = pwLoginField.getText();
String SQLString = "select * from Administrators where username = '"+User+"' and password = '"+Password+"'";
Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");
con = DriverManager.getConnection(DriverPrefix+DataSource, dbuser, dbpasswd);
stmt = con.createStatement();
rset = stmt.executeQuery("select * from Administrators where username = '"+User+"' and password = '"+Password+"'"; 
```

请帮助我...我想确切地解释我必须如何在源代码中进行更正，如何转换 ms access 数据库等......

提前致谢

# jquery - javascript 2 个浏览器 2 个不同的值

> ID：13998857
> 
> 赞同：-2
> 
> 时间：2012-12-22T00:18:36.677
> 
> 标签：jquery, ajax, json, google-chrome, firefox

这是一个 jQuery ajax 函数的成功回调：

```
success: function(data){
    console.log(data);
    if(data.error==1){
        $("#error").show();
    }else{
        console.log("sucess");
        //window.location=staticData.main;
    }
} 
```

这是我从服务器获取的 json：

```
{"error":1} 
```

在 Chrome 上我收到一个错误，但在 Firefox 上它总是显示成功。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:48:40.410

你确定这是一个 json 对象还是只是一个代表 json 对象的字符串？

我会试试这个：

```
data = JSON.parse( data ) || data;
console.log( data ); // this should be now a json object
if(data.error==1){
   $("#error").show();
}else{
   console.log("sucess");
} 
```

希望这会有所帮助，或者您可以使用变量中的实际 ajax 响应创建一个 jsbin，我们可以帮助您解决这个问题。干杯!

# ruby-on-rails - TODO 列表：创建一个新任务直接到一个空白页

> ID：13998858
> 
> 赞同：0
> 
> 时间：2012-12-22T00:18:39.557
> 
> 标签：ruby-on-rails

***这些是我的应用程序的页面：***

***首先，索引：***

![在此处输入图像描述](../Images/6a38f498a6f4db7b451b442a18774e85.png)

***然后，如果我按：“添加新任务”：***

![在此处输入图像描述](../Images/cf8471298ba7770ad2be79faf07dc08f.png)

***如果我填写字段并按：“添加新任务”，我必须直接进入索引页面，但我得到了一个空白页面：***

![在此处输入图像描述](../Images/b459f847d46a23dc2c58738b2de91c04.png)

***如果我刷新它，我得到：***

![在此处输入图像描述](../Images/c01f48c161fca2e28467f4f3c573d5df.png)

**这是以下文件：tasks_controller.rb：**

![在此处输入图像描述](../Images/93ee5e1110ee02fec8bdc432269f5fa6.png)

**这是文件：new.html.erb**

![在此处输入图像描述](../Images/f92e88d71e07b1ddda902a62e291e359.png)

**我的问题是：如何解决我的问题并获取索引页（tasks_path）而不是空白页？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:31:59.617

问题是您没有重定向到对象本身。如果你这样做：

```
redirect_to @task, :notice => "Your post was saved" 
```

你应该很高兴。

另外，我应该补充一点，您的脚本有问题。无论格式如何，它都会重定向。但是，根据您的其他代码，您似乎也在接受 JSON 请求。您可能应该将代码切换为：

```
format.html { redirect_to @task, notice: 'Your task was created.' }
format.json { render json: @task, status: :created, location: @task } 
```

但是，您的系统也可以正常工作，因为使用 API 应该正确重定向。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-22T00:43:47.660

如果你想重定向到同一个控制器的索引，你不需要使用辅助方法，你可以简单地写

```
flash[:notice] = 'your post was saved'
redirect_to action: "index" 
```

也许你可以在同一行设置通知，我不确定，但这样它应该可以工作。

编辑：虽然我不明白为什么你会得到一个空白页......也许你也应该发布你的索引方法/erb

# rspec - should_not_receive 对于 Class 方法不会失败

> ID：13998866
> 
> 赞同：1
> 
> 时间：2012-12-22T00:19:29.883
> 
> 标签：rspec, sinatra

我不太清楚为什么，但我的 Sinatra rspec 测试在应该失败的时候没有正确失败。这是我的 Rspec 的一部分：

```
context "invalid params" do
        before do
            @params = {}
        end
        it "does not call the Count model" do
            Count.should_not_receive(:increment)
            post '/counts' , @params
        end
end 
```

虽然它没有失败。但是，如果我将 should_not_receive 行切换为：

```
Count.should_receive(:increment).exactly(2).times 
```

它响应以下错误：

```
Failure/Error: Count.should_receive(:increment).exactly(2).times
   (<Count (class)>).increment(any args)
       expected: 2 times
       received: 1 time 
```

那么为什么第一个测试如果被调用一次就不会失败呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-22T16:53:19.880

在执行 puts last_response.body 和 last_response.status 之后，事实证明 Sinatra 正在引发异常并返回 500 状态。

进一步调试后出现这种情况的原因是 Rack 环境设置为开发而不是测试。Sinatra 的文档说你应该可以把

```
set :environment, :test 
```

在您的规范文件的顶部，但这实际上不起作用。解决方案是在您开始需要任何文件之前，在您的规范文件的最开头添加以下行：

```
ENV['RACK_ENV'] = 'test' 
```

就是这样！

# regex - htaccess 在单独的目录中重写规则

> ID：13998868
> 
> 赞同：0
> 
> 时间：2012-12-22T00:20:00.773
> 
> 标签：regex, .htaccess, mod-rewrite

我有一个名为“私人”的目录。您可以使用 url 访问 index.php 文件

> [http://www.example.com/private/](http://www.example.com/private/)

index.php 寻找“page”参数来 require_once() 请求的页面。

> [http://www.example.com/private/?page=archive](http://www.example.com/private/?page=archive)。

我想制定一个重写规则以在用户键入时返回相同的查询：

> [http://www.example.com/private/archive](http://www.example.com/private/archive)。

我试过这个规则，但它似乎不起作用。

```
RewriteEngine On
RewriteRule ^private/([a-z]+)/?$ private/?page=$1 [L] 
```

如果我将 .htaccess 放在“私人”文件夹或站点的根目录中，它就不会工作。不是应该在“私人”文件夹而不是根文件夹中吗？我的重写模块已打开。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:55:58.417

忘记添加“RewriteBase”

```
RewriteEngine On
RewriteBase /private/

RewriteRule ^([a-z]+)/?$ ?page=$1 [L] 
```

无需在重写规则中写入“private/”，因为重写基础已设置为它。.htaccess 文件当然应该在私有文件夹中。

# c++ - 在 C++ 中的基类构造函数中构造派生类

> ID：13998869
> 
> 赞同：2
> 
> 时间：2012-12-22T00:20:14.500
> 
> 标签：c++, oop, polymorphism

假设我有一个从基类派生的类。多态性允许我通过指向基类的指针（使用虚函数）调用派生类的函数。换句话说，我可以让派生类的成员“假装”成为基类的成员。牢记这一点，基类是否有可能在其构造函数中实际构造派生类的成员（然后“假装”为基类的成员，因此没有任何问题）？从逻辑上讲，我认为这不应该起作用，但我无法弄清楚如何在语法上做到这一点。如果这是不可能的，为什么不呢？

我知道我可以有一个单独的函数来构造派生类的成员并将其作为基类的成员返回。如果这最终是不可能的，这就是我将要做的，但是将它作为构造函数会更干净（因为这就是这个单独的函数基本上是什么）。

编辑：这是我正在寻找的一个例子：

```
class base
{
  base()
  {
    this=new derived(); //This is what I am looking for
  }

  virtual func();
};

class derived : public base
{
  derived() : base()
    {}

  func()
  {
    ...
  }
}; 
```

如上所述，这可以通过以下方式实现：

```
base *fake_base_constructor()
{
  return new derived();
} 
```

实际上，会有多个派生类，基类构造函数会根据参数在它们之间进行选择，但从概念上讲，您只需要一个。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T00:26:54.453

听起来您想要[奇怪地重复出现的模板模式](http://en.wikipedia.org/wiki/Curiously_recurring_template_pattern)。它允许基类通过给它一个模板参数来知道从它派生的类型，该模板参数是派生类型：

```
template <class D>
class Base
{ };

class Derived : public Base<Derived>
{ }; 
```

现在您可以`Derived`在`Base`. 例如，构造函数`Base`可以做：

```
template <class D>
void Base<D>::some_base_member()
{
  D d;
}; 
```

事实上，这种模式的一个重要结果是您可以`Derived`从`Base`类中调用成员。例如：

```
template <class D>
void Base<D>::some_base_member()
{
  static_cast<D*>(this)->some_derived_member();
}; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T02:35:38.427

听起来您想通过将某些内容传递给构造函数来选择获得的事物类型？您的示例提供了静态选择，但文本暗示将有多种选择。我很好奇你打算如何使用它，特别是。

假设你想做这样的事情：

```
enum Types
{
    Type_A,
    Type_B,
};

class Base
{
public:
    Base(Types t)
    {
        switch (t)
        {
        case Type_A:
            this = <magic> A;
            break;

        case Type_B:
            this = <magic> B;
            break;
        }
    }
}; 
```

但问题是这不是 C++ 的工作方式；您的对象空间在构造函数被命中时已经分配，​​因此您不能只是将派生项填充到该空间中。例如，假设您将其作为类成员变量：

```
struct SomeStruct
{
    int i;
    Base b;
    float f;

    SomeStruct();
}

SomeStruct::SomeStruct() : i(4), b(Type_A), f(3.14f)
{
} 
```

这根本行不通。听起来最直接的解决方案是使用工厂功能；它明确表明您必须处理指针，这是程序员习惯看到的东西：

```
Base* BaseFactory(Types t)
{
    switch (t)
    {
    case Type_A:
        return new A;

    case Type_B:
        return new B;
    }
} 
```

你可以用奇怪的重复模板模式做类似的事情，但它不像另一个答案中建议的那么简单（部分原因是你可能想要运行时多态性，这在 Wikipedia 文章中没有提到），但这并不是真的必要；无论您的解决方案如何，构建这些东西的代码模块都必须了解可以创建的所有内容，并考虑到一个约束，最好在基类之外的某个地方拥有这些知识。只是我的意见，但我认为从长远来看，避免构建大束字符串是最安全的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T01:32:07.740

你问：

> “基类是否有可能在其构造函数中实际构造派生类的成员（然后“假装”为基类的成员，因此没有任何问题）？”

是的，有很多方法可以在基类中进行派生类特定的初始化。

这是我写的一篇博客文章中的一个例子，题为[“如何使用零件工厂避免后期施工”](http://alfps.wordpress.com/2010/05/12/how-to-avoid-post-construction-by-using-parts-factories/)：

```
#include <stdio.h>

namespace apiLevel {
    enum Handle {};

    Handle newButton( char const title[] )
    {
        printf( "apiLevel::newButton(\"%s\")\n", title );
        return Handle();
    }

    Handle newListbox( char const [] = "" )  { return Handle(); }
    Handle newStatic( char const [] = "" )   { return Handle(); }
}  // namespace apiLevel

class Widget
{
private:
    apiLevel::Handle    handle_;

protected:
    struct ApiWidgetFactory
    {
        virtual apiLevel::Handle newWidget( char const title[] ) const
        {
            return apiLevel::newStatic( title );  // Reasonable.
        }
    };

public:
    explicit Widget(
        char const                  title[] = "\"? (unspecified)\"",
        ApiWidgetFactory const&     factory = ApiWidgetFactory()
        )
        : handle_( factory.newWidget( title ) )
    {}
};

class Button
    : public Widget
{
protected:
    struct ApiWidgetFactory: Widget::ApiWidgetFactory
    {
        virtual apiLevel::Handle newWidget( char const title[] ) const
        {
            return apiLevel::newButton( title );    // Derived class specific.
        }
    };

public:
    explicit Button(
        char const                  title[],
        ApiWidgetFactory const&     factory = ApiWidgetFactory()
        )
        : Widget( title, factory )
    {}
};

int main()
{
    Button  button( "Just a button" );
} 
```

上述方法的主要优点是它为客户端代码提供了一个**类型安全**的接口，具有普通的面向 RAII 的构造（即，充分利用类不变量）。

主要缺点是它需要维护两个并行的类层次结构，尽管这主要是一个将代码放在哪里的问题。

有关更多信息，请参阅该博客文章，该文章还进一步链接到[常见问题解答](http://www.parashift.com/c++-faq-lite/calling-virtuals-from-ctor-idiom.html)，其中还提供了一些其他方法。博客帖子有点直接来自马的嘴，即我的。常见问题解答项目是我说服马歇尔为常见问题解答编写该问题和解决方案的结果。

# compilation - 用于 g++/make 的类似 SBT 的连续编译

> ID：13998873
> 
> 赞同：2
> 
> 时间：2012-12-22T00:20:48.200
> 
> 标签：compilation, g++, makefile, sbt

SBT 允许使用`~ compile`. 它监视源文件目录并在文件被修改时重新编译项目。这样，您无需在更改源代码后等待重新编译您的项目。

有没有人知道使用 GNU c++/make 来做这件事的任何等价物？这种持续编译功能对于我正在处理的 C++ 项目非常有用。我正在使用 g++ 4.7.2 和 GNU make 3.81 。

# python - python类方法全局返回？

> ID：13998878
> 
> 赞同：2
> 
> 时间：2012-12-22T00:21:22.643
> 
> 标签：python, inheritance, global

我有以下问题：
我希望在没有本地实例化对象的情况下全局使用类的方法。

前任。文件：a.py

```
class A(object):    
    def __init__(self):
        return

    def sp_a(self):
        print "a"

if __name__ == "__main__":
    return A() 
```

文件：test_a.py

```
import A

def run():
    sp_a() 
```

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T01:25:01.620

如果它是一个需要全局的方法，为什么要让它成为一个类的一部分呢？

一个.py

```
def sp_a():
    print "a" 
```

test_a.py

```
from a import sp_a

def run():
    sp_a() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:26:48.733

除了建议使用`staticmethod`您的其他答案之外，您还可以这样做：

```
class A(object):
  @staticmethod
  def foo():
    # code

foo = A.foo 
```

从那时起，它`foo`是一个独立的名称，您可以直接从模块中导入，而无需导入`A`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:25:11.400

如果它是无状态的，那么您可以通过使用 @staticmethod 装饰它来使其成为静态方法

```
class A(object):    
    def __init__(self):
        return

    @staticmethod
    def sp_a():
        print "a"

if __name__ == "__main__":
    return A() 
```

文件：test_a.py

```
import A

def run():
    A.sp_a() 
```

# c - fminunc 如何优化梯度下降中的学习率（步长比例）值？

> ID：13998880
> 
> 赞同：1
> 
> 时间：2012-12-22T00:21:53.520
> 
> 标签：c, matlab, machine-learning, gradient-descent

我目前正在研究一种机器学习算法，我注意到当我使用 Matlab`fminunc`时，与手动更新参数时相比，算法收敛到全局最小值的速度非常快（迭代次数很少）：

`thetas[j] = thetas[j] - (alpha*gradient)/sampleNum;`

我认为这是因为我天真地假设`alpha`（步长比例）是恒定的。

那么，如何`fminunc`在 C 中实现类似的东西呢？

我试着从一个大的开始，`alpha`如果当前的成本比以前的成本大，我会调整它。当最小化函数的形状不是线性时，就会出现问题，因为`alpha`最初可以得到一个非常小的值，并且当函数形状趋于“平坦”时无法返回到更大的值（并且可以采取更大的步骤） .

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-22T01:33:43.967

Matlab`fminunc`实际上并不使用梯度下降，而是使用类似牛顿的方法（[基于 BFGS 的准牛顿或信任区域](http://www.mathworks.com/help/optim/ug/unconstrained-nonlinear-optimization-algorithms.html)，具体取决于问题大小），无论您如何选择步骤，它们通常都比梯度下降快得多尺寸。

如果您想要更快的收敛，也许您应该研究这种方法。

# mysql - 我想将表 A 中的字段 (X,Y) 更新为表 B 中字段 (X,Y) 中的值，其中字段 Z 在两者中都相等

> ID：13998886
> 
> 赞同：1
> 
> 时间：2012-12-22T00:23:39.930
> 
> 标签：mysql, sql

```
SELECT
    a_fees a
    a_temp b
SET
    b.fee_source_id = a.fee_source, 
    b.filing_date = a.filingdate
WHERE
    b.fee_id = a.fee_id; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T00:30:20.037

多表更新的 MySQL 语法：

```
UPDATE a_fees AS a, a_temp AS b
SET a.fee_source = b.fee_source_id, 
    a.filingdate = b.filing_date
WHERE a.fee_id = b.fee_id; 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/d2adc/1)

使用`INNER JOIN`：

```
UPDATE a_fees AS a
INNER JOIN a_temp AS b
ON a.fee_id = b.fee_id
SET a.fee_source = b.fee_source_id, 
    a.filingdate = b.filing_date; 
```

在线查看它：[sqlfiddle](http://sqlfiddle.com/#!2/c03afb/1)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-22T00:28:38.307

您应该使用`UPDATE`语句来更新表中的字段。如果您在 SQL Server 中，您将使用 JOIN 使用不同表中的值更新一个表中的字段，如下所示：

```
UPDATE b
SET
    b.fee_source_id = a.fee_source, 
    b.filing_date = a.filingdate
FROM 
    a_fees a
    JOIN a_temp b
    ON a.fee_id = b.fee_id 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-22T00:35:43.843

我知道跨数据库工作的唯一语法是：

```
update a_temp
    set fee_source_id = (select a_fees.fee_source from a_fees f where a_temp.fee_id = af.fee_id),
        filing_date = (select a_fees.filing_date from a_fees f where a_temp.fee_id = af.fee_id)
    where a_temp.fee_id in (select fee_id from a_fees) 
```

非常丑陋的语法，使用两个相关的子查询（该`where`子句是处理不匹配的 fee_ids 的情况），这就是为什么大多数数据库都有支持`update`查询连接的机制的原因。

# django - 在 django 中刷新提交的表单时数据库中的重复条目

> ID：13998891
> 
> 赞同：0
> 
> 时间：2012-12-22T00:24:08.527
> 
> 标签：django, django-forms, django-templates, django-views

在我使用 GET 方法提交表单然后刷新页面后，数据被重新提交，我正在使用 javascript 进行表单验证

我的观点是：

```
def show(request,post_id):
    try:
        p = post.objects.get(pk=post_id)
        c = comment.objects.filter(blog_id=p)
        if 'cbox' in request.GET:
            c = comment(text=request.GET['cbox'],name=request.GET['cname'],blog=p)
            c.save()
        c_list = comment.objects.filter(blog_id=p)   
    except  post.DoesNotExist:
        raise Http404
    return render_to_response('show.html',{'post':p,'c_list':c_list}) 
```

我的表格是：

```
<form  name="comment" action="" method="get" onsubmit="return validateForm()">
    <input id="carea"  type="text" placeholder="leave a comment" name="cbox" >
    <input id="cb"  type="submit"  value="Post" />
    <input id="cn"  type="text"  placeholder="Name" name="cname">
</form> 
```

我希望当我刷新我的页面时我的数据不应该被重新提交谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-22T18:26:51.290

如果你真的坚持使用 GET 提交，这实际上不是一个好方法。您应该使用服务器端的 HttpResponseRedirect 进行请求重定向，这将从 url 中删除查询字符串。这样它就不会恢复表单。

```
def show(request,post_id):
    try:
        p = post.objects.get(pk=post_id)
        c = comment.objects.filter(blog_id=p)
        if 'cbox' in request.GET:
            c = comment(text=request.GET['cbox'],name=request.GET['cname'],blog=p)
            c.save()
            #Do a redirect here 
            return HttpResponseRedirect("URL of the page you would like to redirect")
        c_list = comment.objects.filter(blog_id=p)   
    except  post.DoesNotExist:
        raise Http404
    return render_to_response('show.html',{'post':p,'c_list':c_list}) 
```

# css - 在 iframe 上自定义 css

> ID：13998892
> 
> 赞同：0
> 
> 时间：2012-12-22T00:24:18.867
> 
> 标签：css, iframe

> **可能重复：**
> [如何将 CSS 应用于 iFrame？](https://stackoverflow.com/questions/217776/how-to-apply-css-to-iframe)

我正在使用轮播显示 YouTube 视频，使用`<iframe />`. 问题是我想自定义`<iframe />`. 我试图强制我的 CSS，它不起作用，我试图通过 JavaScript 添加 CSS 属性，但不可能考虑任何属性。是否有可能通过另一种方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-22T00:28:45.000

如果 iFrame 的 SRC 具有不同的源或协议（http://、https://），那么您根本无法使用任何东西访问它。如果它是相同的源和协议，那么我过去使用过去没有`jQueryObject.content().find('#ObjectID').css()`问题

# php - 在 PHP 应用程序中正确使用 markdown

> ID：13998894
> 
> 赞同：3
> 
> 时间：2012-12-22T00:24:47.900
> 
> 标签：php, markdown

我在一个使用 Markdown 作为其语法的 Web 应用程序上工作，我面临的唯一问题是如何验证服务器端的用户输入，以便它实际上是 Markdown 而不是一些可以使用 POST 请求或注入的 XSS 攻击通过禁用javascript。

我知道 StackOverflow 会这样做，但他们是如何做到的，并允许某些 HTML 标签包括容易受到 XSS 攻击的图像？任何可以提供帮助的开源软件包（示例）。

因为我听说 StackOverflow 使用它，所以我将尝试使用[Pagedown](http://code.google.com/p/pagedown/)作为客户端验证器。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-22T00:38:29.947

你需要投资约。一到两周的正确编码，并完成一些 tagoup 解析器/处理程序，可以清理传入的 HTML（通过 Markdown）。

我强烈建议采用三遍验证和处理方案：

1.  混合模式：将作为 Markdown 文档一部分的传入 HTML 标签列入白名单。
2.  Markdown Parser：将 Markdown 转换为 HMTL
3.  HTML 模式：将作为 HTML 文档的 HTML 标记列入白名单。

然后就可以输出了。存储 Markdown 源和“支持的”HTML 数据，这样您就不需要为每个显示操作都执行此操作。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-22T00:31:34.523

Markdown 允许在其中包含任意 HTML。由于这包括`<script>`元素，因此您可以拥有有效的 Markdown，这也是 XSS 攻击。

通过 Markdown 解析器运行传入数据以获取 HTML，然后将其视为任何其他用户提交的 HTML（通过将[白名单应用于元素和属性](https://stackoverflow.com/questions/1975613/how-can-i-allow-html-in-a-whitelist-with-php)的 HTML 解析器传递它）。