# StackOverflow 问答 14635000-14635999

# jsf - Primefaces DataTable 的特定于列的上下文菜单

> ID：14635003
> 
> 赞同：9
> 
> 时间：2013-01-31T20:57:18.310
> 
> 标签：jsf, jsf-2, primefaces, datatable, contextmenu

如何在 Primefaces 数据表中为每一列定义不同的上下文菜单？放入`<p:contextMenu>`内部`<p:column>`无法正常工作。我希望上下文菜单根据用户右键单击的列而有所不同。

这不起作用（为所有列创建相同的上下文菜单）：

```
<p:dataTable value="#{values}" var="value" selectionMode="single" selection="#{selectedValue}" id="table">
    <p:column headerText="Col 1">
        <h:outputText value="#{value.balance}">
            <f:convertNumber type="currency"></f:convertNumber>
        </h:outputText>
        <p:contextMenu>
            <p:menuitem value="Report"></p:menuitem>
            <p:menuitem value="Change"></p:menuitem>
        </p:contextMenu>
    </p:column>
    <p:column headerText="col 2" >
        <h:outputText value="#{value.balance2}">
            <f:convertNumber type="currency"></f:convertNumber>
        </h:outputText>
    <p:contextMenu>
        <p:menuitem value="Something else"></p:menuitem>
    </p:contextMenu>
    </p:column>
</p:dataTable> 
```

如何通过使用 PF 组件、扩展 PF 组件或添加自定义 JavaScript 在 Primefaces dataTable 中添加特定于列的上下文菜单？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-20T13:57:04.147

你试过了吗（我刚刚用 Primefaces 3.5 测试过）： ContextMenu 可以附加到任何 JSF 组件，primefaces 数据表中的每一行都有私有和动态 id（例如：：carList：0：test1：carList：1：test1 .. .)，所以我认为你应该在列内使用 contextMenu：

```
 <p:column headerText="Model">  
                    <p:panel id="test1">
                        <h:outputText value="#{carr.model}" />
                        <p:contextMenu for="test1" widgetVar="cMenu">
                            <p:menuitem value="Edit Cell" icon="ui-icon-search"
                                        onclick="product.showCellEditor();return false;" />
                            <p:menuitem value="Hide Menu" icon="ui-icon-close"
                                        onclick="cMenu.hide()" />
                        </p:contextMenu>
                    </p:panel>
                </p:column>  
                <p:column headerText="MANUFAC" style="width:20%">  
                    <p:panel id="test2">
                        <h:outputText value="#{carr.manufacturer}" />
                        <p:contextMenu for="test2" widgetVar="cMenu2">
                            <p:menuitem value="Edit Cell" icon="ui-icon-search"
                                        onclick="product.showCellEditor();return false;" />
                            <p:menuitem value="Hide Menu" icon="ui-icon-close"
                                        onclick="cMenu2.hide()" />
                            <p:menuitem value="Hide Menu" icon="ui-icon-close"
                                        onclick="cMenu2.hide()" />
                        </p:contextMenu>
                    </p:panel>
                </p:column> 
```

如果要指定行：

```
<p:column headerText="Model" style="width:30%">  
                    <p:panel id="test1">
                        <h:outputText value="#{carr.model}" />
                        <p:contextMenu rendered="#{carr.model eq 'SENT'}" for="test1" widgetVar="cMenu">
                            <p:menuitem value="Edit Cell" icon="ui-icon-search"
                                        onclick="product.showCellEditor();return false;" />
                            <p:menuitem value="Hide Menu" icon="ui-icon-close"
                                        onclick="cMenu.hide()" />
                        </p:contextMenu>
                        <p:contextMenu rendered="#{carr.model eq 'WAITING'}" for="test1" widgetVar="cMenu3">

                            <p:menuitem value="Hide Menu" icon="ui-icon-close"
                                        onclick="cMenu3.hide()" />
                        </p:contextMenu>
                    </p:panel>
                </p:column> 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T15:18:35.887

另一种方法是使用 p:menuButton 代替。p:menuButton 可以更改为看起来像 ap:contextMenu 它都是关于 styleClass。

1.  创建自定义样式类以更改向下箭头

    > ```
    > .contextButton .ui-state-default .ui-icon{
    >     background:url(YOUR_IMAGE_PATH);
    > } 
    > ```

2.  创建自定义样式类以隐藏按钮边框和背景

    > . **contextButton** .ui-button { 边框：无；背景：无；}
    > 
    > . **contextButton** .ui-button.ui-state-hover，.ui-button.ui-state-focus，.ui-button.ui-state-active { 边框：无；背景：无；}

3.  在 p:menuButton 中使用自定义 styleClass

    > <p:menuButton value="" styleClass=" **contextButton** ">
    > P:MENUITEM HERE
    > </p:menuButton>

您可以[在此处](http://kianworknotes.blogspot.com/2013/03/workaround-for-primefaces-contextmenu.html)参考工作示例

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T21:34:24.127

> 可选的属性定义 contextMenu 附加到哪个组件。当未定义for时，contextMenu附加到页面含义，在页面任意位置右击会显示菜单。

这就是[Primefaces 文档](http://primefaces.org/documentation.html)对`contextMenu`标签的描述。因此，按照您的方式，它附加到页面含义。使用*for*属性，您将能够与 Primefaces 组件集成，但可能无法与特定的表列集成。

文档还`Datatable`建议您只能在对表格进行选择时这样做，因为它似乎有特殊的方法可以使其适应**树节点**。

但是，我强烈建议您在询问之前查看文档。

# sql - 如何从 SQL Server 2008 上的 SQL 字符串中删除模式？

> ID：14635007
> 
> 赞同：0
> 
> 时间：2013-01-31T20:57:42.710
> 
> 标签：sql, sql-server-2008

我目前有这个 SQL 存储过程：

```
 DECLARE @old nvarchar(MAX)
    SELECT @old = ReadPostIds FROM CrmUserDetails  WHERE MemberNumber = @memNum

     UPDATE CrmUserDetails SET ReadPostIds = CONVERT(NVARCHAR(MAX),REPLACE(@old,CONVERT(NVARCHAR(50), @postId), '') + CONVERT(NVARCHAR(50), @postId) + ',' )
     WHERE MemberNumber = @memNum 
```

而不是 1,2,3 等，我想为每个逗号分隔的元素和另一个数字添加一个管道，如 1|2,3|4,5|6 等。

问题是我不知道第二个数字是多少。所以我在哪里这样做：

```
 CONVERT(NVARCHAR(MAX),REPLACE(@old,CONVERT(NVARCHAR(50), @postId), '') 
```

我想这样做：

```
 CONVERT(NVARCHAR(MAX),REPLACE(@old,CONVERT(NVARCHAR(50), @postId) + * + '|', '') 
```

其中 * 是任何东西。我知道解决方案将与 PATINDEX() 有关，但我的截止日期是昨天，我已经工作了 16 个小时，并且在 SQL 方面很糟糕。

任何帮助都会很棒。

谢谢，

乔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T03:35:10.887

以此为例：

```
DECLARE @old nvarchar(MAX), @pattern nvarchar(20), @replace nvarchar(20)
SELECT @old = ReadPostIds FROM CrmUserDetails  WHERE MemberNumber = @memNum

SET @pattern = L'%2|_%' -- Note how the pattern must be declared, the actual searched string in the pattern is 2|*, as per your example
SET @replace = L''

WHILE PATINDEX(@pattern, @old) > 0
BEGIN
    @old = STUFF(@old, PATINDEX(@pattern, @old), LEN(@pattern)-2, @replace)
END 

UPDATE CrmUserDetails SET ReadPostIds = @old
WHERE MemberNumber = @memNum 
```

我建议为 WHILE 循环创建一个函数并立即使用它，如下所示：

```
UPDATE CrmUserDetails SET ReadPostIds = dbo.udfReplacePattern(ReadPostIds, '%2|_%', '')
WHERE MemberNumber = @memNum 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-03-18T20:33:22.603

使用 Cha 响应，但使用 SQL 服务器格式并举例说明：

```
DECLARE @old nvarchar(MAX), @pattern nvarchar(20), @replace nvarchar(20)
SELECT @old = '0,1,2'

SET @pattern = '%,%' 
SET @replace = '|'

select PATINDEX(@pattern, @old)
WHILE PATINDEX(@pattern, @old) > 0
BEGIN
    SET @old = STUFF(@old, PATINDEX(@pattern, @old), LEN(@pattern)-2, @replace)
END 

SELECT @old 
```

# java - Java 等价于 C++ 输出流重载

> ID：14635008
> 
> 赞同：2
> 
> 时间：2013-01-31T20:57:44.847
> 
> 标签：java

我正在从 C++ 背景进入 Java，我目前正在掌握不重载运算符的概念，就像 Java 方式一样。我目前正试图弄清楚如何处理这样一种情况，如果我用 C++ 编写，我会`operator<<`为我的班级超载并收工。

在Java中应该如何处理这种情况？是否有具有特定语法的特定过程，或者就像编写类似的东西一样简单

```
public void PrintMyStuff( final MyClass myClass ){
    System.out.print( /*MyClass member1*/ );
    System.out.print( /*MyClass member2*/ );
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T21:00:49.223

我想你已经回答了你自己的问题。为了在事物中添加更多“仪式”和“正确的做事方式”——约定是将此“打印方法”称为 toString()，并且它应该返回一个字符串——然后显式打印该字符串。

（......虽然如果你只是按照你想要的方式打印，我不会对你说三道四......特别是如果它只是为了你自己的目的......）

这是有关此约定的重要链接：[http ://www.javapractices.com/topic/TopicAction.do?Id=55](http://www.javapractices.com/topic/TopicAction.do?Id=55)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:06:14.560

你想得到一个对象的字符串表示吗？如果是这样，只需覆盖该`toString()`方法。例如：

```
@Override
public String toString() {
    StringBuilder sb = new StringBuilder();
    sb.append(member1);
    ...
    sb.append(member2);
    return sb.toString();
} 
```

我猜A`StringBuilder`将是最接近的等价物。`std::stringstream`

*hth*

# java - Android 如何使用/显示 MediaController 与 SurfaceView 和 MediaPlayer 的视频？

> ID：14635013
> 
> 赞同：6
> 
> 时间：2013-01-31T20:57:57.670
> 
> 标签：java, android, android-widget

我必须使用 MediaPlayer 播放视频，而不是 VideoView。我在 Xml 布局中有一个 SurfaceView，在 Activity 端有一个 MediaPlayer 和一个 MediaController。

我找不到将 MediaController 与 SurfaceView 和 MediaPlayer 一起使用的方法。使用 VideoView 非常简单，但无法弄清楚如何使用 MediaPlayer。

我在网上找到了一些例子，但它们都是关于播放音频，而不是视频。

这是我创建 MediaPlayer 的 surfaceCreated 方法

```
@Override
    public void surfaceCreated(SurfaceHolder holder) {
        try {
            mMediaPlayer = new MediaPlayer();
            mMediaPlayer.setDisplay(mSurfaceHolder);
            mMediaPlayer.setDataSource(this, Uri.parse(mUrl));
            mMediaPlayer.setOnPreparedListener(this);
            mMediaPlayer.prepare();
            mMediaController = new MediaController(this);

        } catch (Exception e) {
            Log.e(TAG, "MediaPlayer Prepare: " + e.getMessage());
        }
    } 
```

和这个 MediaPlayer onPrepared 方法

```
@Override
    public void onPrepared(MediaPlayer mp) {

        mVideoWidth = mp.getVideoWidth();
        mVideoHeight = mp.getVideoHeight();
        mSurfaceHolder.setFixedSize(mVideoWidth, mVideoHeight);
        startVideoPlayback();

        mMediaController.setMediaPlayer(this);              

        handler.post(new Runnable() {

            public void run() {
                mMediaController.setEnabled(true);
                mMediaController.show();
            }
        });    
    } 
```

上面的代码没有在 SurfaceView 上显示 MediaController。
我怎样才能做到这一点？

提前致谢。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-08-08T20:16:10.390

为此，您必须实施活动

```
OnBufferingUpdateListener, OnCompletionListener, OnPreparedListener,
OnVideoSizeChangedListener, SurfaceHolder.Callback, MediaPlayerControl 
```

检查下面的工作代码

```
package com.example.demo;
import android.app.Activity;
import android.media.AudioManager;
import android.media.MediaPlayer;
import android.media.MediaPlayer.OnBufferingUpdateListener;
import android.media.MediaPlayer.OnCompletionListener;
import android.media.MediaPlayer.OnPreparedListener;
import android.media.MediaPlayer.OnVideoSizeChangedListener;
import android.net.Uri;
import android.os.Bundle;
import android.os.Handler;
import android.view.MotionEvent;
import android.view.SurfaceHolder;
import android.view.SurfaceView;
import android.view.View;
import android.widget.MediaController;
import android.widget.MediaController.MediaPlayerControl;
import android.widget.ProgressBar;

public class MainActivity extends Activity implements  OnBufferingUpdateListener, OnCompletionListener, OnPreparedListener,
OnVideoSizeChangedListener, SurfaceHolder.Callback, MediaPlayerControl{
    String url = "your video url";
    MediaPlayer mMediaPlayer ;
    SurfaceView mSurfaceView ;
    SurfaceHolder holder ;
    private ConstantAnchorMediaController controller = null;
    ProgressBar progressBar1 ;
    MediaController mcontroller ;
    Handler handler ;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        progressBar1 = (ProgressBar)findViewById(R.id.progressBar1);
        SurfaceView v = (SurfaceView) findViewById(R.id.surface); 
        handler = new Handler();
        holder = v.getHolder(); 
        holder.addCallback(this);
        playVideo();

    }
    private void playVideo() {
        try {
            mcontroller = new MediaController(this);
            mMediaPlayer = MediaPlayer.create(this, Uri.parse(url));
            mMediaPlayer.setOnBufferingUpdateListener(this);
            mMediaPlayer.setOnCompletionListener(this);
            mMediaPlayer.setOnPreparedListener(this);
            mMediaPlayer.setScreenOnWhilePlaying(true);
            mMediaPlayer.setOnVideoSizeChangedListener(this);
            mMediaPlayer.setAudioStreamType(AudioManager.STREAM_MUSIC);

        } catch (Exception e) {
            e.printStackTrace();
        }
    }
    @Override
    public boolean onTouchEvent(MotionEvent event) {
         mcontroller.show();
         return false;
    }
    @Override
    public void surfaceChanged(SurfaceHolder arg0, int arg1, int arg2, int arg3) {
        // TODO Auto-generated method stub
    }
    @Override
    public void surfaceCreated(SurfaceHolder arg0) {
        mMediaPlayer.setDisplay(holder); 
        try {
            mMediaPlayer.start();
        } catch (IllegalStateException e) {
            e.printStackTrace();
        }
    }
    @Override
    public void surfaceDestroyed(SurfaceHolder arg0) {
        // TODO Auto-generated method stub
    }
    @Override
    public void onVideoSizeChanged(MediaPlayer mp, int width, int height) {
        // TODO Auto-generated method stub
    }

    @Override
    public void onPrepared(MediaPlayer mp) {
        // TODO Auto-generated method stub
        progressBar1.setVisibility(View.GONE);
        mcontroller.setMediaPlayer(this);
        mcontroller.setAnchorView(findViewById(R.id.surface));
        mcontroller.setEnabled(true);

        handler.post(new Runnable() {
            public void run() {
                mcontroller.show();
            }
        });
    }

    @Override
    public void onCompletion(MediaPlayer mp) {
        // TODO Auto-generated method stub
    }
    @Override
    public void onBufferingUpdate(MediaPlayer mp, int percent) {
        // TODO Auto-generated method stub
    }
    public void start() {
        mMediaPlayer.start();
    }

    public void pause() {
        mMediaPlayer.pause();
    }

    public int getDuration() {
        return mMediaPlayer.getDuration();
    }

    public int getCurrentPosition() {
        return mMediaPlayer.getCurrentPosition();
    }

    public void seekTo(int i) {
        mMediaPlayer.seekTo(i);
    }

    public boolean isPlaying() {
        return mMediaPlayer.isPlaying(); 
    }

    public int getBufferPercentage() {
        return 0;
    }

    public boolean canPause() {
        return true;
    }

    public boolean canSeekBackward() {
        return true;
    }

    public boolean canSeekForward() {
        return true;
    }
} 
```

# messages - Buddypress ajax 最新消息

> ID：14635015
> 
> 赞同：1
> 
> 时间：2013-01-31T20:58:05.080
> 
> 标签：messages, buddypress

我正在使用以下代码在模板中显示最新消息。这很好用，但是需要刷新页面才能更新。

[图片 最新消息](http://www.taraj.sk/zaklad-header-sparvy1-vrch.jpg)

```
<?php if ( bp_has_message_threads('per_page=3') ) : ?>

<?php while ( bp_message_threads() ) : bp_message_thread(); ?>

<?php if ( bp_message_thread_has_unread() ) : ?> <?php else: ?> <?php endif; ?>

<?php bp_message_thread_avatar() ?>

<?php bp_message_thread_from() ?>

<a href="<?php bp_message_thread_view_link() ?>#send-reply">

<img src="/images/odpovedat.png" alt="reply">

</a>

<?php endwhile; ?>

<?php else: ?>

<?php endif;?> 
```

该脚本的主要目的是显示最新的未读消息，如果用户收到任何消息，它应该通过 ajax 更新，最新的未读消息无需重新加载页面。

# mysql - 如果表中不存在，则 MySQL SELECT 字段为 NULL

> ID：14635017
> 
> 赞同：0
> 
> 时间：2013-01-31T20:58:18.090
> 
> 标签：mysql, sql, select, not-exists

**以下查询检索**第 0 年的季度数据。此查询成功检索第 1、2 和 3 季度。

```
Year    Quarter    Quarterly_Yield
2012       3             6.6
2012       6             5.58
2012       9             7.28 
```

**问题：**无论该季度是否存在数据记录，我都需要返回所有四个季度的“结果”。

**期望的解决方案：**我想指示每个季度选择字段“如果没有记录存在，则返回 NULL”。这样，我的表将包含所有 4 个季度的结果，无论记录是否存在数据。

```
set @ID_CARTERA = 1;

select    

LEFT(A.F_ANOTRIMESTRE, 4 ) Year,
RIGHT(A.F_ANOTRIMESTRE, 2 ) Quarter,
ROUND ( A.POR_RENTABILIDAD, 2 ) Quarterly_Yield

from      dr_rent_carteras_trimestres A

where     A.ID_CARTERA = @ID_CARTERA
And       LEFT(A.F_ANOTRIMESTRE, 4 ) = ( select    MAX(left(F_ANOTRIMESTRE, 4 ) ) - 0
                                         from      dr_rent_carteras_trimestres
                                         where     ID_CARTERA = @ID_CARTERA ) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:38:07.103

对于这种类型的查询，您需要设置一个驱动程序表，该表在输出中包含您想要的所有行。您可以通过交叉连接年份和季度来获得此信息——如果我正确理解数据（即，季度是每年 1、2、3、4）。

下面显示了这是如何完成的：

```
select driver.year, driver.quarter,
       ROUND ( A.POR_RENTABILIDAD, 2 ) Quarterly_Yield
from (select y.year, q.Quarter
       from (select distinct  LEFT(F_ANOTRIMESTRE, 4 ) as Year
             from dr_rent_carteras_trimestres
            ) y cross join
            (select distinct  RIGHT(F_ANOTRIMESTRE, 2 ) as Quarter
             from dr_rent_carteras_trimestres
            ) q
     ) driver left outer join
     dr_rent_carteras_trimestres A
     on LEFT(A.F_ANOTRIMESTRE, 4 ) = driver.y and RIGHT(A.F_ANOTRIMESTRE, 2 ) = driver.q
where A.ID_CARTERA = @ID_CARTERA And
      driver.year = (select MAX(left(F_ANOTRIMESTRE, 4 ) ) - 0
                     from dr_rent_carteras_trimestres
                     where ID_CARTERA = @ID_CARTERA ) 
```

注意：我没有测试过这个查询，所以它可能有语法错误。

# objective-c - 使用 objc_msgSendSuper 调用类方法

> ID：14635024
> 
> 赞同：2
> 
> 时间：2013-01-31T20:58:28.230
> 
> 标签：objective-c, objective-c-runtime

我正在经历并用这种方法替换@synthesized(self) 锁

```
void _ThreadsafeInit(Class theClassToInit, void *volatile *theVariableItLivesIn, void(^InitBlock)(void))
{
    //this is what super does :X
    struct objc_super mySuper = {
        .receiver = (id)theClassToInit,
        .super_class = class_getSuperclass(theClassToInit)
    };

id (*objc_superAllocTyped)(struct objc_super *, SEL, NSZone *) = (void *)&objc_msgSendSuper;
//    id (*objc_superAllocTyped)(id objc_super, SEL, NSZone *) = (void *)&objc_msgSend;

    do {
        id temp = [(*objc_superAllocTyped)(&mySuper /*theClassToInit*/, @selector(allocWithZone:), NULL) init];//get superclass in case alloc is blocked in this class;
        if(OSAtomicCompareAndSwapPtrBarrier(0x0, temp, theVariableItLivesIn)) { //atomic operation forces synchronization
            if( InitBlock != NULL ) {
                InitBlock(); //only the thread that succesfully set sharedInstance pointer gets here
            }
            break;
        }
        else
        {
            [temp release]; //any thread that fails to set sharedInstance needs to clean up after itself
        }
    } while (*theVariableItLivesIn == NULL);
} 
```

虽然有点冗长，但在无争议的情况下表现出明显更好的性能

连同这个小宏（请原谅格式不好，它很简单）。为了允许在初始 nil 检查之后声明块，看起来可以帮助 LLVM 保持“已经初始化”的路径非常快。这是我唯一关心的一个。

```
#define ThreadsafeFastInit(theClassToInit, theVariableToStoreItIn, aVoidBlockToRunAfterInit) if( theVariableToStoreItIn == nil) { _ThreadsafeInitWithBlock(theClassToInit, (void *)&theVariableToStoreItIn, aVoidBlockToRunAfterInit); } 
```

所以最初使用 objc_superAllocTyped 的注释部分来实现它（实际上首先使用 [theClassToInit allocWithZone:NULL]，这绝对是最好的方法 :)），在我意识到项目中的大多数单例已经覆盖 allocWithZone 之前效果很好返回单例方法...无限循环。所以我认为使用 objc_msgSendSuper 应该快速解决它，但我得到了这个错误。

```
[51431:17c03] +[DataUtils allocWithZone:]: unrecognized selector sent to class 0x4f9584 
```

该错误似乎与实际问题无关，因为...

```
(lldb) po 0x4f9584

$1 = 5215620 DataUtils

(lldb) print (BOOL)[$1 respondsToSelector:@selector(allocWithZone:)]

(BOOL) $2 = YES 
```

所以我肯定遗漏了一些东西......我与一个空类中的 [super allocWithZone:NULL] 方法生成的程序集进行了比较......除了被调用的函数具有不同的名称（可能只是使用不同的符号，不知道）之外，几乎相同, 不能很好地阅读它）。

有任何想法吗？我可以在超类上使用 class_getClassMethod 并直接调用 IMP，但我试图合理地滥用运行时:)

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-01T04:05:37.450

好吧，当我回忆起元类包含通过 -[self class] 或 +[self] 获得的 Class 实例的所有方法信息时，这实际上并没有那么棘手 -> 感谢[http://www.cocoawithlove.com /2010/01/what-is-meta-class-in-objective-c.html](http://www.cocoawithlove.com/2010/01/what-is-meta-class-in-objective-c.html)

发生此错误是因为我要求运行时在 NSObject 的一组实例方法中查找该方法，该方法显然不包含 allocWithZone: 。错误日志中的错误可能源于接收者是元类实例，Apple 让他们的实习生实现错误日志。

因此，通过 objc_msgSendSuper 调用普通的实例方法时，您可以将元类实例作为 objc_super.super_class 传递，以调用类方法，需要元类本身（一切都在上一级）。

示例和帮助我理解这一点的图表 - ( [http://www.sealiesoftware.com/blog/archive/2009/04/14/objc_explain_Classes_and_metaclasses.html](http://www.sealiesoftware.com/blog/archive/2009/04/14/objc_explain_Classes_and_metaclasses.html) )

```
struct objc_super mySuper;
mySuper.receiver = theClassToInit; //this is our receiver, no doubt about it
//either grab the super class and get its metaclass
mySuper.super_class = object_getClass( class_getSuperclass( theClassToInit ) );
//or grab the metaclass, and get its super class, this is the exact same object
mySuper.super_class = class_getSuperclass( object_getClass( theClassToInit ) ); 
```

然后可以正确解析该消息。现在我开始关注了，这很有意义：P

无论如何，现在我发现了我的错误，我觉得我已经提高了我对 Objc 运行时的理解。我还能够修复两年前一个我从未见过的人犯的架构错误，而无需修改和重新测试跨 3 个项目和 2 个静态库的数十个类（上帝，我喜欢 Objective-C）。用一个简单的函数调用替换 @synchronized 结构也将这些方法的编译代码大小减半。作为奖励，我们所有的单例访问器现在（更多）线程安全，因为这样做的性能成本现在可以忽略不计。天真地多次（或在循环中）重新获取单例对象的方法已经看到了*巨大*的加速，因为它们不必每次调用多次获取和释放互斥锁。总而言之，我很高兴这一切都如我所愿。

我在 NSObject 类别上为此创建了一个“普通”的 Objective-C 方法，该方法适用于实例和类对象，以允许您在外部调用超类的消息实现。警告：这只是为了好玩，或单元测试，或混合方法，或者可能是一个非常酷的游戏。

```
@implementation NSObject (Convenience)

-(id)performSelector:(SEL)selector asClass:(Class)class
{
    struct objc_super mySuper = {
        .receiver = self,
        .super_class = class_isMetaClass(object_getClass(self)) //check if we are an instance or Class
                        ? object_getClass(class)                //if we are a Class, we need to send our metaclass (our Class's Class)
                        : class                                 //if we are an instance, we need to send our Class (which we already have)
    };

    id (*objc_superAllocTyped)(struct objc_super *, SEL) = (void *)&objc_msgSendSuper; //cast our pointer so the compiler can sort out the ABI
    return (*objc_superAllocTyped)(&mySuper, selector);
} 
```

所以

```
[self performSelector:@selector(dealloc) asClass:[self superclass]]; 
```

相当于

```
[super dealloc]; 
```

继续运行时资源管理器！不要让反对者把你拖进他们挥手和黑色魔法盒子的土地，在那里很难制作出毫不妥协的精彩节目*。

*请负责任地享受 Objective-C 运行时。对于任何持续时间超过四个小时的错误，请咨询您的 QA 团队。

# database-design - 为长问卷设计数据库

> ID：14635027
> 
> 赞同：1
> 
> 时间：2013-01-31T20:58:52.537
> 
> 标签：database-design

嘿，我一直在为一个困扰我很长一段时间的问题挠头。

基本上我有一个很长的在线问卷，我不太确定我应该如何设计 mySQL 数据库来存储答案。

所以这是我的问题：

1.  我应该每人（参加调查的人）创建 1 行吗？
2.  有很多家长/孩子的问题（例如，如果回答是，则回答以下问题，否则忽略）。拿他们怎么办？
3.  对于一个问题，此人可以回答超过 1 个答案。如何处理它们？

我想到的是创建一个表格，每列都是问题。如果有一个不考虑调查者的父母/孩子问题，它将被留下`blank`。对于可以有多个答案的问题，我将创建`n`列（其中`n`代表可能答案的数量）。

你怎么看？这是合适的还是有更好的方法来设计数据库。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:05:52.797

每列都是问题对我来说听起来是个坏主意，因为很难更改/添加问题。很少更改数据库结构。

**表：答案**

对于答案，我会说一张包含所有答案的表格，其中包含以下列：

*   人员 ID（回答此特定问题的人）
*   问题 ID（在这一行中回答了哪个问题）
*   答案（答案本身，可以是字符串/数字）

如果该人对同一问题回答了多个答案，我会为 2 个答案分别放置 2 行。如您所见，每个答案（由一个人）都有一行。因此，如果我们总共有 10 个问题，并且每个问题有 2 人回答一次，那么表格中将有 20 行。

如果一个人没有回答其中一个问题，那么您根本就没有这个问题+这个人的行。

**表：question_order**

在我看来，您还有另一个要求，那就是控制问题的流程——哪些问题紧随其后。我们需要将此流程保存在另一个表中，其中包含以下列：

*   问题 ID（当前问题）
*   回答条件（字符串\数字，取决于您的问题）
*   下一个问题 ID

在此表中，您保存了问题之间的所有联系。如果问题 1 总是导致问题 2，则 put `[1, NULL, 2]`- 在这种情况下，NULL 表示所有可能的答案。如果只有在您回答“是”时问题 2 才导致问题 3，则输入`[2, "yes", 3]`. 如果只有当您回答“否”时，问题 2 才导致问题 4，则放置`[2, "no", 4]`，依此类推。

**表：问题**

您可能会发现另一个有用的潜在表格是问题表格，它提供了有关问题可以接受的更多信息。例如，如果您想知道哪些问题支持多个答案，请使用以下列：

*   问题id（我们正在讨论的问题）
*   支持多个答案（布尔）

在此表中，每个问题通常会有一行。

# flume - Flume 标准输出到 IRC

> ID：14635028
> 
> 赞同：0
> 
> 时间：2013-01-31T20:58:54.447
> 
> 标签：flume

我正在尝试将集群应用程序中每个节点的输出合并到一个简单、一目了然的位置。我不需要永久存储数据，我只想在同一个位置查看所有标准输出。最终我会想要存储更少的信息，可能使用日志文件，但现在，我只想要 app -> stdOut -> IRC，而 Flume 似乎是一个不错的选择。

我看到的所有使用 exec 源代码的示例都显示了使用 tail 的命令，即使文档使您看起来可以使用任何输出到标准输出的进程。我的配置（见下文）将我的应用程序作为命令运行，但为了进行故障排除，它运行一个简单的 shell 脚本，以设定的时间间隔回显“测试”。

我让一切都在运行，IRC 接收器加入了 IRC 通道，但它从不发送任何消息。日志中的最后一项是 Exec 正在启动。

**编辑：** 水槽版本flume-ng-1.2.0+24.43-1~squeeze

水槽.config：

```
agent.sources = exec1
agent.channels = mem1
agent.sinks = irc1
agent.sources.exec1.type = exec
agent.sources.exec1.command = sh /var/lib/app/test.sh
agent.sources.exec1.channels = mem1
agent.sinks.irc1.type = irc
agent.sinks.irc1.hostname = 192.168.17.16
agent.sinks.irc1.nick = flume
agent.sinks.irc1.chan = agents
agent.sinks.irc1.channel = mem1
agent.channels.mem1.type = memory
agent.channels.mem1.capacity = 100 
```

log4j.properties：

```
flume.root.logger=INFO,LOGFILE
flume.log.dir=/var/log/flume-ng
flume.log.file=flume.log
log4j.logger.org.apache.flume.lifecycle = INFO
log4j.logger.org.jboss = WARN
log4j.logger.org.mortbay = INFO
log4j.logger.org.apache.avro.ipc.NettyTransceiver = WARN
log4j.rootLogger=${flume.root.logger}
log4j.appender.LOGFILE=org.apache.log4j.RollingFileAppender
log4j.appender.LOGFILE.MaxFileSize=100MB
log4j.appender.LOGFILE.MaxBackupIndex=10
log4j.appender.LOGFILE.File=${flume.log.dir}/${flume.log.file}
log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout
log4j.appender.LOGFILE.layout.ConversionPattern=%d{ISO8601} %p %c{2}: %m%n
log4j.appender.console=org.apache.log4j.ConsoleAppender
log4j.appender.console.target=System.err
log4j.appender.console.layout=org.apache.log4j.PatternLayout
log4j.appender.console.layout.ConversionPattern=%d (%t) [%p - %l] %m%n 
```

测试.sh：

```
#!/bin/bash
x=1
while [ $x -ge 1 ]
do
  echo "Test $x"
  x=$(( $x + 1 ))
  sleep 5
done 
```

水槽.日志：

```
2013-01-31 12:45:08,184 INFO nodemanager.DefaultLogicalNodeManager: Node manager starting
2013-01-31 12:45:08,184 INFO properties.PropertiesFileConfigurationProvider: Configuration provider starting
2013-01-31 12:45:08,184 INFO lifecycle.LifecycleSupervisor: Starting lifecycle supervisor 9
2013-01-31 12:45:08,186 INFO properties.PropertiesFileConfigurationProvider: Reloading configuration file:/etc/flume-ng/conf/flume.conf
2013-01-31 12:45:08,194 INFO conf.FlumeConfiguration: Processing:irc1
2013-01-31 12:45:08,194 INFO conf.FlumeConfiguration: Added sinks: irc1 Agent: agent
2013-01-31 12:45:08,194 INFO conf.FlumeConfiguration: Processing:irc1
2013-01-31 12:45:08,194 INFO conf.FlumeConfiguration: Processing:irc1
2013-01-31 12:45:08,194 INFO conf.FlumeConfiguration: Processing:irc1
2013-01-31 12:45:08,194 INFO conf.FlumeConfiguration: Processing:irc1
2013-01-31 12:45:08,207 INFO conf.FlumeConfiguration: Post-validation flume configuration contains configuration  for agents: [agent]
2013-01-31 12:45:08,208 INFO properties.PropertiesFileConfigurationProvider: Creating channels
2013-01-31 12:45:08,249 INFO instrumentation.MonitoredCounterGroup: Monitoried counter group for type: CHANNEL, name: mem1, registered successfully.
2013-01-31 12:45:08,249 INFO properties.PropertiesFileConfigurationProvider: created channel mem1
2013-01-31 12:45:08,262 INFO sink.DefaultSinkFactory: Creating instance of sink: irc1, type: irc
2013-01-31 12:45:08,266 INFO nodemanager.DefaultLogicalNodeManager: Starting new configuration:{ sourceRunners:{exec1=EventDrivenSourceRunner: { source:org.apache.flume.source.ExecSource@498665a0 }} sinkRunners:{irc1=SinkRunner: { policy:org.apache.flume.sink.DefaultSinkProcessor@167a1116 counterGroup:{ name:null counters:{} } }} channels:{mem1=org.apache.flume.channel.MemoryChannel@27f7c6e1} }
2013-01-31 12:45:08,266 INFO nodemanager.DefaultLogicalNodeManager: Starting Channel mem1
2013-01-31 12:45:08,266 INFO instrumentation.MonitoredCounterGroup: Component type: CHANNEL, name: mem1 started
2013-01-31 12:45:08,266 INFO nodemanager.DefaultLogicalNodeManager: Starting Sink irc1
2013-01-31 12:45:08,267 INFO irc.IRCSink: IRC sink starting
2013-01-31 12:45:08,267 INFO nodemanager.DefaultLogicalNodeManager: Starting Source exec1
2013-01-31 12:45:08,267 INFO source.ExecSource: Exec source starting with command:sh /var/lib/app/test.sh 
```

**编辑**批量大小似乎是问题所在，因为它一直等到 20 条消息（默认？），在我看到任何输出之前是 100 秒。现在使用 batchsize = 1，标准记录器输出结果，但 IRC 抱怨 NullPointerException，可能是因为 Event.body 不知何故为空？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:54:10.307

IRC 接收器的文档（在此处找到：[Flume 1.x 用户指南](http://flume.apache.org/FlumeUserGuide.html#irc-sink)）说不需要配置分割线是错误的。它在代码中没有默认值，因此您*必须*对其进行配置。

查看源代码（在此处找到：[IRCSink.java](http://svn.apache.org/repos/asf/flume/trunk/flume-ng-sinks/flume-irc-sink/src/main/java/org/apache/flume/sink/irc/IRCSink.java)），您还必须指定“splitlines”或遭受 NullPointerException。有处理“splitchars”为空的代码，但不是分割线。报告为[FLUME-1892](https://issues.apache.org/jira/browse/FLUME-1892)（**编辑：**这张票已在一月份解决。这应该不再是问题。）

# sql - 在关系数据库中选择 On COUNT < x

> ID：14635033
> 
> 赞同：0
> 
> 时间：2013-01-31T20:59:20.563
> 
> 标签：sql, select, relational-database

我有以下 3 个表：

**测试组**
记录号 (pk)

**测试**
记录号 (pk)测试组记录
号 (fk)

**结果**
记录号 (pk)测试记录
号 (fk)

基本上，TestGroup 是一组测试，每个测试包含多个结果。我想选择所有结果少于 X 的测试组。什么查询将实现这一目标？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T21:05:39.820

你应该使用*有*子句：

```
SELECT count(1), tg.recordNumber FROM testgroup tg
LEFT JOIN test t ON t.TestGRoupRecordNumber = tg.recordNumber
LEFT JOIN result r ON r.testRecordNumber = t.recordNumber
GROUP by tg.recordNumber
HAVING count(1) < 10 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T21:07:05.607

你只需要使用`GROUP BY`and `HAVING`：

```
SELECT TG.RecordNumber
FROM TestGroup TG
   LEFT JOIN Test T ON TG.RecordNumber = T.TestGroupRecordNumber 
   LEFT JOIN Result R ON T.RecordNumber = R.TestRecordNumber 
GROUP BY TG.RecordNumber
HAVING COUNT(R.TestRecordNumber) < X 
```

`LEFT JOIN`如果测试组没有结果或没有测试，我也会使用。

# hibernate - 什么时候在 Hibernate 中使用 Criteria 更好？

> ID：14635034
> 
> 赞同：0
> 
> 时间：2013-01-31T20:59:20.787
> 
> 标签：hibernate, hql, hibernate-criteria

假设，我需要根据某些条件使用 Hibernate 计算数据库表中的行数，我可以`org.hibernate.criteria`像下面这样使用。

```
@Service
@Transactional(readOnly = true, propagation=Propagation.REQUIRES_NEW)
public final class StateDAO implements StateService
{
    private SessionFactory sessionFactory;

    public void setSessionFactory(SessionFactory sessionFactory)
    {
        this.sessionFactory = sessionFactory;
    }

    @Override
    @SuppressWarnings("unchecked")
    public Object rowCount(String id)
    {
        return sessionFactory.getCurrentSession()
              .createCriteria(State.class)
              .setProjection(Projections.rowCount())
              .add(Restrictions.eq("countryId", Long.parseLong(id)))
              .uniqueResult();
    }
} 
```

它根据`id`通过 Spring 提供的行数来计算行数。

这也可以通过使用类似的 HQL 查询来实现。

```
sessionFactory.getCurrentSession()
              .createQuery("select count(*) as cnt from State where countryId=:id")
              .setParameter("id", Long.valueOf(id).longValue())
              .uniqueResult(); 
```

哪个更好且更常见（关于性能和其他方面）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:07:05.457

在您的情况下，这是一个偏好问题。Criteria API 是类型安全的，并且*可能*更快（您无需为解析 HQL 付出代价）。另一方面，HQL 可能更容易阅读，尤其是对于具有 SQL 背景的人。

*您应该*使用条件 API的唯一地方是查询是动态的，例如，基于某些输入，可以选择 WHERE 条件的任何子集。使用 HQL，您将不得不从字符串构建 HQL（看起来很糟糕），或者有指数级数量的略有不同的 per-coined 查询。

# java - 在 WiFi 上向所有可用机器广播消息

> ID：14635036
> 
> 赞同：6
> 
> 时间：2013-01-31T20:59:27.340
> 
> 标签：java, android, python

如果这是一个微不足道的问题，我深表歉意。

我最近开始做一些 android 编程，我正在编写一个简单的应用程序，它允许你使用你的 android 设备作为你的 windows PC 的控制器。具体来说，它允许用户执行诸如关闭机器、使其睡眠、重新启动等操作。我目前正在使用名为 CherryPy 的 python 库作为 Windows 机器上的服务器来执行实际的 win32api 调用以执行所需的功能。我不确定的是如何（动态地）发现网络上的哪台机器实际上正在托管服务器。如果我将我的机器公共 IP 硬编码到 android 应用程序中，一切都会正常工作，但显然这远不理想。我考虑过让用户在应用程序中手动输入他们的机器公共 IP，但是如果有办法，比如说，向 WiFi 上的所有机器广播一条快速消息，并检查我的 Python 服务器会发出的预先准备好的响应，这太棒了。那可能吗？

提前谢谢各位。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:03:17.240

*尝试向特殊广播地址*255.255.255.255发送 UDP 数据包。网络中的每个设备都应该收到该数据包的副本（防火墙除外），您可以安排让服务器以其身份回复数据包。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:13:15.580

[使用alljoyn](/questions/tagged/alljoyn "显示标记为“alljoyn”的问题")框架 编写您的应用程序。[AllJoyn](https://www.alljoyn.org)将为您处理这些细节。

# javascript - 在 Ember.js 中重定向回的规范方法是什么？

> ID：14635042
> 
> 赞同：4
> 
> 时间：2013-01-31T20:59:50.863
> 
> 标签：javascript, redirect, ember.js

我在控制器中有动作去另一条路线

```
App.FirstNewController = Ember.ObjectController.extend({
    action: function(data){
        this.transitionTo('albums.new');
        }
    }); 
```

接下来，我在那里创建一个新专辑（与用户交互），我想重定向回第一个 url。

```
App.AlbumsNewController = Ember.ObjectController.extend({
    save: function(data) {
        App.store.commit();
        this.transitionTo('index'); 
```

在这里，我转到索引页面，但我不想这样做。我应该如何将数据传递给 albums.new 路线以返回到 first.new 路线？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-01T12:31:12.513

我觉得最简单的方法是

```
 window.history.go(-1) 
```

# django - 通过网页/模板更改 settings.py 中的设置

> ID：14635046
> 
> 赞同：0
> 
> 时间：2013-01-31T21:00:02.597
> 
> 标签：django, django-templates, django-admin

我最近被要求“破解” django/python 并编辑一个项目。我从来没有用任何接近这两种语言的编程，所以我在旅途中学习它们。

我做了功课并搜索了几个主题

[我可以从 Django 中的模板访问 settings.py 中的常量吗？](https://stackoverflow.com/questions/433162/)

[Django - 用于在管理界面中编辑 settings.py 中的常量的应用程序](https://stackoverflow.com/questions/4157678/)

然后 [http://blog.chipx86.com/2008/08/05/django-development-with-djblets-dynamic-site-configuration/](http://blog.chipx86.com/2008/08/05/django-development-with-djblets-dynamic-site-configuration/)

然而，由于这不是我编程的东西，我被要求向管理配置页面添加一些功能，以便从那里进行编辑并增强网站的其他部分。我也明白那些需要重新启动 django 服务器。

这样做的人有 site_config.py 和 settings.py 。在项目的实时版本中，只有 site_config.py 中的常量是可访问/可编辑的。我设法重现了这就是 site_config.py 的一部分的样子。

```
## SITE #
# Populate default site config values here
SITE_DISPLAY_NAME = 'testing123'
SITE_COMPANY_NAME = 'another123' 
```

现在的问题是如何将 urls.py 中的一部分添加到给定的 site_config.py

```
urlpatterns = patterns('',
    # We don't yet have a top-level main view, redirect to AIM app
   (r'^$', 'django.views.generic.simple.redirect_to', {'url': '/aim/'}), 
```

这是我想合并到 site_config.py 的部分。我该怎么办？

如果您需要更多信息，请告诉我，如果这是一个新手问题，我很抱歉，但我真的从来没有做过这样的事情。谢谢你。

# c# - 数据直方图 - 优化的 binwidth 优化

> ID：14635047
> 
> 赞同：3
> 
> 时间：2013-01-31T21:00:05.517
> 
> 标签：c#, statistics

我正在寻找从给定数据集生成数据直方图。我已经阅读了有关构建直方图的不同选项，并且我对基于以下工作的方法最感兴趣

> 岛崎，H。筱本，S.（2007 年）。“一种选择时间直方图bin大小的方法”

上述方法使用估计来确定最佳的 bin 宽度和分布，这在我的情况下是必需的，因为样本数据的分布会有所不同，并且很难提前确定 bin 的数量和宽度。

有人可以推荐一个好的源代码或在 c# 中编写这样的函数的起点，或者有足够接近的 c# 直方图代码。

非常感谢。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-11T09:20:29.493

下面是我从[这里](http://toyoizumilab.brain.riken.jp/hideaki/res/code/histsample.py)写的这个算法的 Python 版本的移植。我知道 API 可以做一些工作，但这应该足以让你开始。此代码的结果与 Python 代码针对相同输入数据生成的结果相同。

```
public class HistSample
{
    public static void CalculateOptimalBinWidth(double[] x)
    {
        double xMax = x.Max(), xMin = x.Min();
        int minBins = 4, maxBins = 50;
        double[] N = Enumerable.Range(minBins, maxBins - minBins)
            .Select(v => (double)v).ToArray();
        double[] D = N.Select(v => (xMax - xMin) / v).ToArray();
        double[] C = new double[D.Length];

        for (int i = 0; i < N.Length; i++)
        {
            double[] binIntervals = LinearSpace(xMin, xMax, (int)N[i] + 1);
            double[] ki = Histogram(x, binIntervals);
            ki = ki.Skip(1).Take(ki.Length - 2).ToArray();

            double mean = ki.Average();
            double variance = ki.Select(v => Math.Pow(v - mean, 2)).Sum() / N[i];

            C[i] = (2 * mean - variance) / (Math.Pow(D[i], 2));
        }

        double minC = C.Min();
        int index = C.Select((c, ix) => new { Value = c, Index = ix })
            .Where(c => c.Value == minC).First().Index;
        double optimalBinWidth = D[index];
    }

    public static double[] Histogram(double[] data, double[] binEdges)
    {
        double[] counts = new double[binEdges.Length - 1];

        for (int i = 0; i < binEdges.Length - 1; i++)
        {
            double lower = binEdges[i], upper = binEdges[i + 1];

            for (int j = 0; j < data.Length; j++)
            {
                if (data[j] >= lower && data[j] <= upper)
                {
                    counts[i]++;
                }
            }
        }

        return counts;
    }

    public static double[] LinearSpace(double a, double b, int count)
    {
        double[] output = new double[count];

        for (int i = 0; i < count; i++)
        {
            output[i] = a + ((i * (b - a)) / (count - 1));
        }

        return output;
    }
} 
```

像这样运行它：

```
double[] x =
{
    4.37, 3.87, 4.00, 4.03, 3.50, 4.08, 2.25, 4.70, 1.73,
    4.93, 1.73, 4.62, 3.43, 4.25, 1.68, 3.92, 3.68, 3.10,
    4.03, 1.77, 4.08, 1.75, 3.20, 1.85, 4.62, 1.97, 4.50,
    3.92, 4.35, 2.33, 3.83, 1.88, 4.60, 1.80, 4.73, 1.77,
    4.57, 1.85, 3.52, 4.00, 3.70, 3.72, 4.25, 3.58, 3.80,
    3.77, 3.75, 2.50, 4.50, 4.10, 3.70, 3.80, 3.43, 4.00,
    2.27, 4.40, 4.05, 4.25, 3.33, 2.00, 4.33, 2.93, 4.58,
    1.90, 3.58, 3.73, 3.73, 1.82, 4.63, 3.50, 4.00, 3.67,
    1.67, 4.60, 1.67, 4.00, 1.80, 4.42, 1.90, 4.63, 2.93,
    3.50, 1.97, 4.28, 1.83, 4.13, 1.83, 4.65, 4.20, 3.93,
    4.33, 1.83, 4.53, 2.03, 4.18, 4.43, 4.07, 4.13, 3.95,
    4.10, 2.27, 4.58, 1.90, 4.50, 1.95, 4.83, 4.12
};

HistSample.CalculateOptimalBinWidth(x); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-07-03T19:35:23.310

Check the Histogram function. If any data elements are unlucky to be equal to a bin boundary (other than the first or last bin), they will be counted in both consecutive bins. The code needs to check (lower <= data[j] && data[j] < upper) and handle the case that all elements equal to xMax go into the last bin.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-06-13T08:30:38.067

nick_w 答案的一个小更新。

如果你之后真的需要垃圾箱。加上优化了 histogram 函数中的双循环，加上去掉了 linspace 函数。

```
 /// <summary>
     /// Calculate the optimal bins for the given data
     /// </summary>
     /// <param name="x">The data you have</param>
     /// <param name="xMin">The minimum element</param>
     /// <param name="optimalBinWidth">The width between each bin</param>
     /// <returns>The bins</returns>
     public static int[] CalculateOptimalBinWidth(List<double> x, out double xMin, out double optimalBinWidth)
     {
        var xMax = x.Max();
        xMin = x.Min();
        optimalBinWidth = 0;
        const int MIN_BINS = 1;
        const int MAX_BINS = 20;

        int[] minKi = null;
        var minOffset = double.MaxValue;

        foreach (var n in Enumerable.Range(MIN_BINS, MAX_BINS - MIN_BINS).Select(v => v*5))
        {
           var d = (xMax - xMin)/n;
           var ki = Histogram(x, n, xMin, d);
           var ki2 = ki.Skip(1).Take(ki.Length - 2).ToArray();

           var mean = ki2.Average();
           var variance = ki2.Select(v => Math.Pow(v - mean, 2)).Sum()/n;

           var offset = (2*mean - variance)/Math.Pow(d, 2);

           if (offset < minOffset)
           {
              minKi = ki;
              minOffset = offset;
              optimalBinWidth = d;
           }
        }
        return minKi;
     }

     private static int[] Histogram(List<double> data, int count, double xMin, double d)
     {
        var histogram = new int[count];
        foreach (var t in data)
        {
           var bucket = (int) Math.Truncate((t - xMin)/d);
           if (count == bucket) //fix xMax
              bucket --;
           histogram[bucket]++;
        }
        return histogram;
     } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-24T06:13:47.543

我建议使用二分搜索来加快对班级间隔的分配。

```
public void Add(double element)
{
  if (element < Bins.First().LeftBound || element > Bins.Last().RightBound)
    return;

  var min = 0;
  var max = Bins.Length - 1;
  var index = 0;

  while (min <= max)
  {
    index = min + ((max - min) / 2);

    if (element >= Bins[index].LeftBound && element < Bins[index].RightBound)
      break;

    if (element < Bins[index].LeftBound)
      max = index - 1;
    else
      min = index + 1;
  }

  Bins[index].Count++;
} 
```

“Bins”是“HistogramItem”类型的项目列表，它定义了“Leftbound”、“RightBound”和“Count”等属性。

# php - 如何使用 Apache、PHP 和 LDAP 从计算机获取 AD 用户凭据

> ID：14635053
> 
> 赞同：2
> 
> 时间：2013-01-31T21:00:34.613
> 
> 标签：php, apache, authentication, active-directory, ldap

我们正在尝试实现一个集成了 AD 和 PHP Web 应用程序的单点登录解决方案。当用户尝试访问 Intranet 网站时，应该会发生以下情况：

*   Web 应用程序要求服务器读取存储在已登录 Windows/AD 的用户计算机中的 AD 凭据。
*   AD“将 AD 用户名传递给 Apache”
*   使用 PHP，我读取了存储在 $_SERVER['PHP_AUTH_USER'] 中的凭据 - 据我所知

这一切都意味着只能在 Intranet 中工作。在它之外，我们只显示一个登录表单。

我们对这个过程有些困惑。从[其他](http://software.danielwatrous.com/access-apache-ldap-authentication-details-in-php/) [来源](http://cokeroman.blogspot.com/2011/02/autenticar-apache-contra-ldap.html)，我们使用以下指令配置 Apache，但最终不成功，带有内部服务器错误消息并且错误日志中没有任何内容。

```
<Location "/">
    Options -Indexes MultiViews FollowSymLinks
    Order allow,deny
    Allow from all
    AuthType Basic
    AuthName "VALIDAUTHNAME"
    AuthBasicProvider ldap
    AuthzLDAPAuthoritative   Off
    AuthLDAPURL "ldap://IP.FOR.THE.SERVER:389/DC=MYCOMPANY,DC=CL?sAMAccountName?sub?(objectClass=*)"
    AuthLDAPBindDN "DC=MYCOMPANY,DC=MYCOUNTRY"
    Require ldap-attribute gidNumber=10000
</Location> 
```

对我们必须实施的流程有明确的解释吗？我们已经阅读了很多关于逆过程、将凭据传递给 AD 的内容，但关于这个案例的内容并不多。我们的系统管理员在这方面并没有真正的经验，所以他们没有多大帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:57:29.023

A few months ago, I did exatly what you're trying to do with [`mod_auth_nltm_winbind`](http://adldap.sourceforge.net/wiki/doku.php?id=mod_auth_ntlm_winbind). The configuration of it isn't very difficult, but it helps to be familiar with `winbind`. Your sysadmins should be able to help with that if you aren't. `winbind` is a part of the `samba` package, so it's probably already installed on your server. Once you get winbind set up, you just need to enable the apache module and do a little bit of configuration. The site for the module should be able to guide you through it. When I originally set this up, I tested it with IE8, Chrome, and an older version of Firefox (5 or 6 maybe) and they all natively support the NTLM authentication. If everything is configured and working correctly, the apache module will automagically fill `$_SERVER['PHP_AUTH_USER']` with the user name without needing any interaction with the user and you can do whatever you want to with it from there. There is a lot more documentation available now and even with the lacking documentation before, I only had one major problem for which a fix is now well documented.

# android - 停止在子进程中执行的 android logcat

> ID：14635057
> 
> 赞同：0
> 
> 时间：2013-01-31T21:00:47.993
> 
> 标签：android, ruby, process, android-logcat, kill-process

我正在编写一个 ruby​​ 脚本，在其中我想在子进程中执行 android logcat -v time 命令，并在一段时间后终止该进程（当父进程完成 xyz 时）。

例如我有： childpid = Process.fork { `adb -s <device-serial> logcat -c` `adb -s <device-serial> logcat -v time>/path-to-file/forkLog.log` }

```
sleep(30)
    #parent do thing else here ...
Process.kill("SIGHUP", childpid)  #kill the child process 
```

* * *

根据我读过的 adb logcat 代码是在另一个子进程中执行的，所以当我尝试执行 Process.kill 时，childpid 会停止，但它的子进程不会。

如何从父进程中杀死 logcat -v time>forklog.log 进程？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:37:07.087

通常，当您使用 fork 调用 bash 脚本时，您需要使用[Kernel::exec()](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-exec)而不是 Kernel::system() 或 Kernel::`

```
Process.fork{exec('adb -s <device-serial> logcat -c && adb -s  <device-serial> logcat -v time>/path-to-file/forkLog.log'} 
```

不同之处在于 exec 将用 shell 脚本*替换*Ruby 进程，而另外两个将创建一个子进程。

# r - 如何使用循环遍历一组列表

> ID：14635060
> 
> 赞同：1
> 
> 时间：2013-01-31T21:00:50.267
> 
> 标签：r

我正在尝试创建一个 r 循环以在一系列数据集上运行命令。该命令`make.design.data`来自`RMark`库。它需要的唯一参数是列表的名称。我有 17 个列表要传递给 make.design.data 这是我一直在尝试使用的代码

```
DFNames<-c("DFAmerican.Goldfinch", "DFAmerican.Robin","DFBarn.Swallow","DFBobolink",     "DFBrown.head.Cowbird", "DFCedar.Waxwing", "DFCommon.Grackle","DFCommon.Yellowthroat", "DFEuropean.Starling","DFHorned.Lark", "DFKilldeer","DFRed.wing.Blackbird", "DFSavannah.Sparrow", "DFSong.Sparrow","DFTree.Swallow", "DFVesper.Sparrow", "DFYellow.Warbler")

#in my environment each of the names given to DFNames represents a list

for (x in DFNames){
n<-make.design.data(x)
assign(paste0("ddl",x),n)
 } 
```

这给了我错误

```
 Error in data$model : $ operator is invalid for atomic vectors 
```

任何人都可以建议一种方法来修复我的代码，或者解决这个问题的不同方法吗？

谢谢，裘德

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:06:20.993

相反，您可以制作`list`实际数据集，而不是其名称的向量。

```
x <- list(DFAmerican.Goldfinch, ...) 
```

然后你可以使用：

```
 lapply(x, make.design.data)`. 
```

或者`get`在你的 for 循环中使用：

```
for (x in DFNames) {
  make.design.data(get(x))
} 
```

“R”方式是前者使用列表和`apply`家庭。然后你可以避免体操`assign`。

# elasticsearch - Couchbase XDCR Elasticsearch 速度和删除

> ID：14635063
> 
> 赞同：2
> 
> 时间：2013-01-31T21:00:58.130
> 
> 标签：elasticsearch, couchbase

我们正在考虑实现某种消息缓存，它会保存我们发送到搜索索引的消息，这样我们就可以在索引下降很长一段时间（例如完全重新索引）时持续存在，然后're-应用'消息。这些消息是我们索引的文档的创建或更新。如果空间足够便宜，使用像 Couchbase 这样可扩展的东西，我们甚至可以保存所有消息，但我还没有对消息大小和数量进行任何类型的估计。无论如何，我建议 Couchbase + XDCR + Elasticsearch 完成这项任务，因为大部分工作将自动完成，但是我还有 4 个问题：

1.  如果我们将其实现为缓存，我不希望 Elasticsearch 删除任何不在 Couchbase 中的文档，这可能吗（甚至可能是默认行为）？

2.  是否可以应用某种版本控制，以便索引中的文档不会被来自 Couchbase 的旧版本覆盖？

3.  如果我要向索引添加一个新字段，我可能需要从实际的文档数据源重新索引，然后重新应用存储在 Couchbase 中的所有消息。我可能在 Elasticsearch 中有 1 亿个文档，并且说 Couchbase 中有 500,000 个文档我想重新应用到 Elasticsearch？速度会怎样。

4.  我可以在 Couchbase 和 Elasticsearch 之间应用任何类型的逻辑吗？

**更新：**

因此，我们将文档存储在 RDBMS 中，因为我们需要即时访问插入的文档以及其他一些内容。我们通过消息将文档的有限版本发送到搜索引擎。如果我们想向索引中添加一个字段，我们需要以某种方式从 RDBMS 重新索引系统。如果我们有这个 Couchbase 消息缓存，我们可以先将字段添加到消息中，然后关闭旧消息的索引并从 RDBMS 重新索引。然后我们可以重新打开消息的索引，整个消息“队列”将被索引而不会丢失任何内容。

该系统（如果有效）将不再需要 MQ 服务器、消息侦听器并确保索引中没有丢失任何文档。

版本控制是必要的，因为我们不想对实际上包含更新文档的索引应用“更新”（现在我想不知道这是否会发生）。

我很欣赏通过更改 Elasticsearch 插件代码来实现第 1 点和第 4 点的工作可能不是太好，但我想首先确认这个想法是合理的！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T08:25:59.917

今天的 Couchbase-Elasticsearch 集成应该被视为 Couchbase 的索引引擎。这意味着索引由 Couchbase 中的数据“管理/控制”。

XDCR 用于将“所有事件”发送到 Elasticsearch。这意味着每次创建、修改或删除文档（存储在 Couchbase 中）时都会更新/删除索引。

因此，存储在 Couchbase 存储桶中的“所有文档”都会被索引到 Elasticsearch 中。

让我们根据 Couchbase-Elasticsearch 的当前实现，一一回答您的问题。

1.  当从 Couchbase 中删除文档时，Elasticsearch 索引会更新（条目已删除）。

2.  不确定是否理解问题。“旧”版本如何来自 Couchbase？无论如何，每次修改存储在 Couchbase 中的文档时，都会更新 Elasticsearch 中的索引。

3.  不确定要在哪里添加新字段？如果这是存储在 Couchbase 中的文档，那么当文档将被发送到 Elasticsearch 时，索引将被更新。但根据我之前所说的：所有“存储”到 Couchbase 中的文档都将出现在 Elasticsearch 索引中。

4.  不像今天那样使用插件，但正如您所知，它是一个开源项目，因此您可以为其添加一些逻辑，甚至可以将您的想法贡献给项目（[https://github.com/couchbaselabs/elasticsearch-transport -沙发底](https://github.com/couchbaselabs/elasticsearch-transport-couchbase)）

所以让我问你更多问题： - 你如何将文件插入到你的应用程序中？（以及 Couchbase 在哪里？Elasticsearch？） - 文档的类型是什么？- 你想在 Couchbase 中缓存什么？

# css - 整个 Google Chrome 浏览器的自定义 CSS

> ID：14635064
> 
> 赞同：3
> 
> 时间：2013-01-31T21:01:00.763
> 
> 标签：css, browser

是否可以更改谷歌浏览器应用于网站的 CSS。

我想隐藏一些元素，例如在 facebook 上看不到它，因为它占用了我一半的空闲时间。

`.facebook-wall{display:none;}`每次我去fb时都会应用-auto之类的东西 。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:05:02.560

假设我正确理解你...

*   这不适用于您正在制作的网站
*   这仅供您个人使用

使用 Tampermonkey。

[https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=en](https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo?hl=en)

它应该像 Greasemonkey（Firefox 插件）一样工作，并且应该满足您的需求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:11:31.413

[Stylebot](https://chrome.google.com/webstore/detail/stylebot/oiaejidbmkiecgbjeifoejpgmdaleoha?hl=en)是一个很好的扩展。您可以交互地构建一些自定义 CSS 以应用于您选择的网站。

它甚至似乎有一个附带的网站，其他人在其中分享了他们的混合物，因此可能有人已经整理了一些东西来过滤 Facebook 提要。

# asp.net - ASP.NET 4.5 成员在设计时无法识别 SQL Server 数据提供程序？

> ID：14635066
> 
> 赞同：2
> 
> 时间：2013-01-31T21:01:03.923
> 
> 标签：asp.net, sql, sql-server-2008-r2, membership-provider

我是 Visual Studio 2012 / ASP.NET 4.5 Web 表单的新手。

我正在尝试`ASP.NET`在我的`asp.net 4.5 web forms`应用程序（使用`Visual Studio 2012`）中使用表单身份验证（成员资格），因为我已经成功使用`asp.net version 4.0`.

问题似乎是，当我在 中进行测试时`Visual Studio 2012`，它无法识别我`web.config`指向`SQL Server 2008R2 aspnetdb`. 它似乎正在使用该`SQL Express aspnetdb.mdf`文件来存储我的用户。

我尝试`aspnetdb.mdf`从我的网络应用程序中完全删除它，但它仍然无法识别我`web.config`指向的设置`SQL Server`，而是使用其他地方的设置（不知道在哪里！）。我知道这一点，因为`Membership.CreateUser()`如果我不提供问题和答案作为参数，该方法会引发错误。此外，Web 配置工具需要问答才能创建新用户。我的`web.config`设置专门没有！

当我托管 Web 应用程序时，它会在`SQL Server`数据库中查找我的用户，因为当我尝试使用使用 VS2012 中的 Web 配置工具成功创建的用户名登录时，我的应用程序找不到该用户！它似乎在寻找，`SQL Server`但找不到它。

我一定错过了一些基本设置......有人有什么想法吗？

我在下面包含了我的 web.config 设置：

```
<connectionStrings>    

  <add name="ApplicationServices" connectionString="Data Source=localhost;Initial Catalog=aspnetdb;Persist Security Info=True;User ID=studentid;Password=password" providerName="System.Data.SqlClient"/>
  <add name="StudentAttendanceConnectionString" connectionString="Data Source=localhost;Initial Catalog=StudentAttendance;Persist Security Info=True;User ID=studentid;Password=password" providerName="System.Data.SqlClient"/>
</connectionStrings>

<authentication mode="Forms">
<forms loginUrl="~/Account/Login.aspx" timeout="2880"/>      
</authentication>

<profile defaultProvider="DefaultProfileProvider">
  <providers>
    <add name="DefaultProfileProvider" type="System.Web.Providers.DefaultProfileProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" connectionStringName="ApplicationServices" applicationName="/"/>
  </providers>
</profile>
<membership>
  <providers>
    <add connectionStringName="ApplicationServices" enablePasswordRetrieval="true"
      enablePasswordReset="false" requiresQuestionAndAnswer="false"
      requiresUniqueEmail="false" maxInvalidPasswordAttempts="5" minRequiredPasswordLength="6"
      minRequiredNonalphanumericCharacters="0" passwordAttemptWindow="10"
      applicationName="/" name="DefaultMembershipProvider" type="System.Web.Providers.DefaultMembershipProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
 </membership>
 <roleManager>
  <providers>
    <add connectionStringName="ApplicationServices" applicationName="/"
      name="DefaultRoleProvider" type="System.Web.Providers.DefaultRoleProvider, System.Web.Providers, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" />
  </providers>
  </roleManager> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:17:48.603

一些东西...

1) 用户或某些帐户是否有权访问 SQL 数据库？我没有看到这里提到的。
2) 使用启动 SQL Management Studio 时出现的 SQL 服务器的服务器名称，如果 IIS 和 SQL 在同一台服务器上，则不要使用 localhost。
3) 检查您的 machine.config 文件以了解您正在使用的 .Net 版本。我最终不得不将 SQL Express 设置更改为服务器的 IP 地址，以便在类似的情况下为我工作，同时删除（通过控制面板）SQL Express 或任何测试数据库 VS 2012 安装。我最近在构建服务器时遇到了与此相关的错误。

：：编辑：：

还将以下内容添加到“connectionStrings”部分上方的 Web.Config 文件中：

```
 <startup>
    <supportedRuntime version="4.0" sku=".NETFramework,Version=v4.5" />
    </startup> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T18:24:07.860

您可以尝试使用 ASP.Net Config 创建角色和用户吗？

**VS2010**

![在此处输入图像描述](../Images/2d3a6cc2a3f9f5f60f75d154177be34c.png)

或者

**VS 2012** > 项目 > ASP.Net 配置

另一种是添加 clear -[添加提供程序时不要忘记](http://weblogs.asp.net/scottgu/archive/2006/11/20/common-gotcha-don-t-forget-to-clear-when-adding-providers.aspx)

# git - 撤消在 git commit 中所做的更改并将它们移动到不同的分支

> ID：14635067
> 
> 赞同：0
> 
> 时间：2013-01-31T21:01:06.737
> 
> 标签：git

我有一个对文件 A、B、C、D、E 进行更改的提交。此提交已被推送到远程服务器。

我想对文件 C 和 E 进行更改并将它们移动到单独的分支，因为它们在不稳定时被推送，我们将没有时间在发布前“稳定”它们。

我想我要问的是在 C 和 E 上对 HEAD 进行先前的提交，并将所做的更改暂时放在他们自己的分支中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:04:48.387

从当前开始创建一个分支`HEAD`：

```
git branch newbranch 
```

撤消对 的更改`HEAD`：

```
git revert --no-commit <the-faulty-commit>
git checkout -- A B D
git commit 
```

您可以稍后合并`newbranch`（但请确保选择正确的合并策略，否则将`revert`优先）或.`revert``revert`

# javascript - 如何创建没有 html 表格的两列布局？

> ID：14635070
> 
> 赞同：0
> 
> 时间：2013-01-31T21:01:19.207
> 
> 标签：javascript, html, css, tablelayout

有人多次告诉我，我不应该使用表格进行布局设计，但是当我不知道如何做某事时，我经常发现自己会回到表格中。

我需要创建一个两列布局。左列是 300px 宽度，右列占据页面上其余的宽度。我无法弄清楚如何使用纯 HTML 正确执行此操作，我什至无法完全弄清楚如何使用表格执行此操作。

为了让右列占据其余的宽度，我似乎需要用百分比指定左列的宽度，以便右列的宽度可以比左列的百分比小 100%。但我需要左列正好是 300px。

我唯一能想到的就是在运行时用 JS 计算右列的宽度。任何想法如何在没有表格和/或没有 Javascript 的情况下完成此任务？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:20:05.287

[带有 floats 的列非常简单](http://codepen.io/zzzzBov/pen/CubLd)。困难在于让父[容器清除浮动的子容器](https://stackoverflow.com/questions/211383/which-method-of-clearfix-is-best)。

[HTML：]

```
<div class="container">
  <div class="column column-a">
    ...
  </div>
  <div class="column column-b">
    ...
  </div>
</div> 
```

[CSS：]

```
.container {
  background-color: red;
  color: white;
  width: 520px;
  zoom: 1;
}
.container:before,
.container:after {
  content: '';
  display: table;
}
.container:after {
  clear: both;
}
.column-a {
  background-color: blue;
  float: left;
  width: 300px;
}
.column-b {
  background-color: green;
  float: right;
  width: 200px;
} 
```

您应该注意，两列中较短的一个不会延伸到容器的底部。通常，两列的背景在包含元素上垂直重复。

如果您需要填充列，我通常会`div.inner`在每个`.column`元素中添加元素，但如果您想避免“divitis”，您可以简单地添加：

```
.column {
    box-sizing: border-box;
    padding: 20px;
} 
```

对于流体宽度列，您所要做的就是确保您的宽度加起来达到 100%：

```
.column-a {
    width: 80%;
}
.column-b {
    width: 20%;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:05:15.890

`<div>`元素从根本上填充其容器的宽度，或者它的剩余部分。因此，如果您有一个 300px 宽的 div，然后在它旁边有一个没有指定宽度的 div，则第二个 div 将填充容器的其余部分。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:07:06.007

在我们有[flexbox 布局](http://www.w3.org/TR/css3-flexbox/)之前，我会使用绝对定位：

html:

```
<div id="container">
    <div id="left">left one</div>
    <div id="right">right one</div>
</div> 
```

CSS：

```
#container {
    position: relative;
    height: 150px;
}

#left, #right {
    position: absolute;
    top: 0px; 
    bottom: 0px;
}

#left {
    left: 0px; 
    width: 300px;
    background: red;
}

#right {
    left: 300px; 
    right: 0px;    
    background: green;
} 
```

[jsfiddle](http://jsfiddle.net/V4etF/1/)

如果您希望布局适应内容而不是容器，还有其他选择。如果您的右栏有更多内容，您可以使用：

```
#container {
    position: relative;
}

#left {
    position: absolute;
    left: 0px; 
    width: 300px;
    top: 0px; bottom: 0px;
    background: red;
}

#right {
    margin-left : 300px; 
    background: green;
} 
```

[jsfiddle](http://jsfiddle.net/V4etF/2/)

如果您的左列有更多内容，请使用：

```
#container {
    position: relative;
}

#left {
    width: 300px;
    background: red;
}

#right {
    position: absolute;
    left: 300px; 
    right: 0px;
    top: 0px; bottom: 0px;
    background: green;
} 
```

[jsfiddle](http://jsfiddle.net/V4etF/3/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T21:10:15.727

将左列设置为 300px，将右列设置为 100%……完成。为避免任何跨浏览器的怪异现象，请按照 Matt Ball 的链接访问... [http://matthewjamestaylor.com/blog/ultimate-2-column-left-menu-pixels.htm](http://matthewjamestaylor.com/blog/ultimate-2-column-left-menu-pixels.htm)。他正在使用我认为没有必要的神秘的第二个包装，但小步骤:)

一旦进入包装器，要获得列高 = 我相信您需要将 min-height 设置为 100%。您可以调整溢出 css 属性以处理任何文本溢出。非常直接的东西，我记得我花了很长时间寻找如何做相等的列，包装器是关键。另外，不要为此使用 JS，使用 JS 的人要么在做更高级的事情，要么对 html/css 完全陌生。

# c# - htmlagilitypack xpath 不工作

> ID：14635073
> 
> 赞同：3
> 
> 时间：2013-01-31T21:01:31.520
> 
> 标签：c#, xpath, html-agility-pack

我有一个问题，我的 xpath 无法正常工作。

我正在尝试在底部获取 Google.com 的下一个链接的网址。

但我无法使用 Xpath 访问 url。

请帮我纠正我的xpath。还告诉我应该在什么地方？？

```
HtmlWeb hw = new HtmlWeb();

HtmlAgilityPack.HtmlDocument doc = hw.Load("http://www.google.com/search?q=seo");
HtmlNodeCollection linkNodes = doc.DocumentNode.SelectNodes("//*[@id='pnnext']");

foreach (HtmlNode linkNode in linkNodes)
{
    HtmlAttribute link = linkNode.Attributes["href"];
    MessageBox.Show(link.Value );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:54:33.660

~~这里奇怪的是，不知何故 HtmlAgilityPack 无法识别`id`“Next”链接的属性。~~

~~这可能是 HtmlAgilityPack 中的一个错误；您可以将其发布在[HAP 问题跟踪器](http://htmlagilitypack.codeplex.com/workitem/list/basic)中。~~

但是，与此同时，我发现了这种解决方法：

*   找到包含分页元素的表（带有 的表`id="nav"`）。对于这个元素，id 被正确识别
*   取表中的第一个（也是唯一`tr`的）和最后一个`td`（使用 XPath`last()`函数）
*   取我们在上一步获得的`a`里面的元素。`td`

长话短说，代码如下：

```
var doc = new HtmlWeb().Load("http://www.google.com/search?q=seo");

var nextLink = doc.DocumentNode
    .SelectSingleNode("//table[@id='nav']/tr/td[last()]/a");

Console.WriteLine(nextLink.GetAttribute("href", "err")); 
```

* * *

### 更新

在 Simon 的评论之后，我再次检查了这个，结论是这不是 HTML Agility Pack 中的错误；该`id="pnnext"`属性仅在浏览器发出请求时出现（可能取决于*UserAgent*标头值）。在执行`HttpWebRequest`from 代码时，输​​出中的“Next”链接如下所示：

```
<a href="/search?q=seo&amp;hl=en&amp;ie=UTF-8&amp[...]" style="text-align:left"> 
```

# c# - Parallel.For 有异常行为

> ID：14635081
> 
> 赞同：1
> 
> 时间：2013-01-31T21:01:55.950
> 
> 标签：c#, math, for-loop, parallel-processing

我正在尝试将此素筛分功能转移到使用 Parallel.For 以便它可以利用多个核心。

但是，当我运行它时，b 变量的值似乎随机跳跃甚至根本没有变化，尤其是对于较高的 To 值。

```
static List<long> Sieve(long To)
{
    long f = 0;
    To /= 2;

    List<long> Primes = new List<long>();
    bool[] Trues = new bool[To];

    if (To > 0)
        Primes.Add(2);

    long b = 0;

    Parallel.For(1L, To, a =>
    {
        b++;

        if (Trues[b])
            return;

        f = 2 * b + 1;
        Primes.Add(f);

        for (long j = f + b; j < To; j += f)
            Trues[j] = true;
    });

    return Primes;
} 
```

发生了什么事，我怎样才能阻止这种情况发生？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:08:19.880

欢迎来到多线程的美妙世界。

马上，我可以看到循环的每次迭代都执行 a `b++`，然后`b`在整个过程中使用。这意味着循环的每次迭代都将`b`在所有其他迭代中修改 的值。

您*可能*想要做的是使用`a`在您的内联函数中提供的变量，这正是您似乎试图用`b`. 如果情况并非如此，那么您应该在`b`对其进行处理之前研究锁定并将其值复制到本地（每次迭代）变量。

试试这个，让我知道这是否是你想做的：

```
static List<long> Sieve(long To)
{
    To /= 2;

    List<long> Primes = new List<long>();

    if (To > 0)
        Primes.Add(2);

    Parallel.For(1L, To, a =>
    {
        long f = 2 * a + 1;
        Primes.Add(f);
    });

    Primes.Sort();

    return Primes;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:02:53.540

您在这里面临的问题称为`race conditions`，当多个 CPU 内核将相同的变量加载到各自的缓存中，处理它，然后将值写回 RAM 时会发生这种情况。显然，在此期间，写回 RAM 的值可能已经过时了（例如，当核心在变量被另一个值覆盖之前加载变量时）

首先：我不会使用`b++`，而是`int i = Interlocked.Increment(ref b);`。Interlocked.Increment 确保没有 2 个线程尝试同时增加相同的值。结果是将增加的值保存到变量`i`中。这**非常**重要，因为您需要该值在 for 循环的每次迭代中保持不变，否则这是不可能的，因为其他线程将递增该变量。

接下来是您的变量`f`和`a`（定义为 For-iterator）。忘记`f`，`a`改用。

```
f = 2 * b + 1; // wrong
a = 2 * b + 1; // correct 
```

最后： System.Collections.Generic.List**不是**，我重复一遍（因为它很重要）**不是**线程安全的。有关详细信息，请参阅[http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx 。](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)

```
Primes.Add(f); // will likely break something
lock (Primes)  // LOCK the list
{
    Primes.Add(a); // don't forget, we're using 'a' instead of 'f' now
} 
```

该`lock`关键字仅接受引用类型变量作为参数，这是因为锁定变量不会**阻止**另一个线程访问它。相反，您可以将其想象为在引用之上设置一个标志，以便向其他线程发出信号`I'm working here, please do not disturb!`

当然，如果另一个线程在`Primes`没有事先要求锁定它的情况下尝试访问，该线程仍然可以访问该变量。

不过，您应该已经学会了所有这些，因为 Parallel Prime Sieve 是第一次学习多线程时最常见的初学者练习之一。

**编辑：**

完成上述所有步骤后，程序不应该乱跑；**但这**并不意味着解决方案是正确的，或者您将获得加速，因为您的许多线程将做重复的工作。

假设`Thread a`有责任标记每个 3 的倍数，而`Thread n`有责任标记 9 的倍数。当顺序运行时，当`Thread n`开始处理 9 的倍数时，它会看到 9 已经是另一个的倍数 (素数）数。但是，由于您的代码现在是并行的，因此**无法保证**`Thread n`在开始工作时会标记 9 。更不用说 - 因为 9 可能没有被标记 - 可能会被添加到素数列表中。

因此，您必须**依次**找到 1 和 的平方根之间的所有素数`To`。为什么是平方根`To`？那是你必须自己找出来的东西。

一旦你找到了从 1 到 的平方根的所有素数`To`，你就可以开始你的平行素数筛，以便使用之前找到的所有素数来找到剩余的素数。

最后一个值得注意的一点是，只有在填充**之后**`Primes`才应该构建它。那是因为： **`Trues`**

 ****1.**你的线程只需要处理 2 的平方根的倍数`To`，因此在当前实现中不会在根之外添加更多元素`Primes`。

**2.**如果您选择让您的线程超出根目录，您将面临一个问题，即您的一个线程将`Primes`在另一个线程将该数字标记为非素数之前不久添加一个非素数，这不是什么你要。

**3.**即使你很幸运，所有元素`Primes`确实都是 1 和 之间的素数`To`，它们也不一定是有序的，需要`Primes`先排序。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:05:10.030

`b`跨线程共享。如果多个线程同时敲击那个糟糕的变量，你*期望*会发生什么？

在您的代码中似乎`b`并且`a`总是相等（或相差一个）。使用`a`. 并同步访问所有其他共享状态（如列表）。**

# ios - 具有透明背景的 PNG 在旧 iPad 上显示为黑色

> ID：14635084
> 
> 赞同：1
> 
> 时间：2013-01-31T21:02:01.497
> 
> 标签：ios, ipad, png

我的 iPad 应用程序中有一个让我发疯的错误。该应用程序允许用户将剪贴画放到页面上。剪贴画图像是具有透明背景的PNG。我创建了一个简单的 UIImageView 并将 opaque 设置为 NO。在我所有的测试中，一切正常。但是，使用旧 iPad（可能是 iPad 2？）的人似乎有黑色背景。这似乎不是 iOS 的问题，但似乎是 iPad 的问题。

您可以在其中看到 90-95% 的剪贴画图像非常好，而 5-10% 具有黑色背景的网站：http: [//www.printpad.com](http://www.printpad.com)

我用于 UIImageView 的代码：

```
UIImageView *imageView = [[UIImageView alloc] initWithImage:resized imageBorderColor:borderColor imageBorderWidth:borderWidth];
[imageView.layer setOpaque:NO];
imageView.opaque = NO;
imageView.frame = rect;
[view addSubview:imageView]; 
```

我真的希望有人遇到过这个问题并且可以提供帮助，因为我什至想不出如何调试或任何东西。谢谢！！！！！

编辑：原始图像被下载到 Documents 目录中，然后像这样调整大小：

```
UIImage *image = [UIImage imageWithContentsOfFile:path];
CGSize newSize = [MyUtility getNewSize:image.size maximumSize:CGSizeMake(200, 200)];
UIImage *resized = [UIImage imageWithImage:image scaledToSize:newSize]; 
```

这是 imageWithImage 类别：

```
+ (UIImage *)imageWithImage:(UIImage*)image scaledToSize:(CGSize)newSize
{
    [self beginImageContextWithSize:newSize];
    [image drawInRect:CGRectMake(0,0,newSize.width,newSize.height)];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    [self endImageContext];
    return newImage;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-25T20:30:07.563

与这里的答案一样：[https ://stackoverflow.com/a/23355129/1751266](https://stackoverflow.com/a/23355129/1751266)

您是否有可能将图像创建为不透明而不是透明？如果你使用 UIGraphicsBeginImageContextWithOptions 或类似的，那么第二个参数应该是 NO。

# c# - MVC TempData 传递给 Jquery

> ID：14635096
> 
> 赞同：2
> 
> 时间：2013-01-31T21:03:12.463
> 
> 标签：c#, asp.net-mvc

我正在尝试将 HTML 分配给 TempData，如下所示：

```
 TempData["FilesUploaded"] = "<option value= '" +  file.FileName + "'>" + file.FileName + "</option>"; 
```

我需要在 Jquery 中获取这个值。因此，我执行以下操作：

```
 var val = '@TempData["FilesUploaded"]';

    alert(val); 
```

我发现这些角色是这样来的：

```
 &lt;option value= &#39;PS Report #36178.pdf&#39;&gt;PS Report #36178.pdf&lt;/option&gt; 
```

我尝试将 TempData 包含在 @Html.Raw(... 中，但效果不佳。

这是我尝试过的：

```
 var val = '@Html.Raw((string)TempData["FilesUploaded"])';
    alert(val); 
```

奇怪的是它不起作用，因为警报甚至没有出现。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T21:07:37.233

用于[`HttpUtility.JavaScriptStringEncode`](http://msdn.microsoft.com/en-us/library/dd991914.aspx)将字符串编码为 JavaScript：

```
var val = '@Html.Raw(HttpUtility.JavaScriptStringEncode((string)TempData["FilesUploaded"]))'; 
```

# c++ - 在 2 个不同的程序之间复制 std::string

> ID：14635100
> 
> 赞同：0
> 
> 时间：2013-01-31T21:03:17.273
> 
> 标签：c++, string, visual-studio-2010, copy, inter-process-communicat

我有一个在某些程序中生成的 std::string 。我有另一个程序应该使用这个字符串。同时（出于调试目的）这些程序是独立的 - 但我仍然想在其他程序中获取和处理这个字符串。我该怎么做？我可以将字符串复制为文本（例如在调试器中表示字符串 bu 文本可视化器），然后在第二个程序中使用 std::string(text) 生成该字符串的副本。文本约为 200 行。

# sql - 以不同 ID 出现多次的 SQL 选择

> ID：14635103
> 
> 赞同：0
> 
> 时间：2013-01-31T21:03:30.443
> 
> 标签：sql

我有一个包含大量列的大表，但为此我只会对 3 列感兴趣，所以我的日期如下。

```
PartNumber  BrandID PartTerminonogyID
1234AD      343
DD93873 DAB 343
1-8383-343  STE 4424
444 OTE 5656
444 NYT 4543
3434    IDY 4543
64545   IDH 3455
64545   IDH 8585 
```

我想要的是找到具有多个 PartTerminologyID 的每个 PartNumber/BrandID 组合

请记住，我不能单独确定零件编号，因为不同的制造商可能对完全不同的物品有相同的零件编号。所以标识符是 PartNumber/BrandID 组合，如果有帮助，您可以将其视为 SKU。而我想要查看的是同一 SKU 具有多个 PartTerminologyID 的所有情况。我也希望看到每个 PartTerminologyID 的结果。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:07:49.863

您可以使用以下实现一个`HAVING`子句和一个`GROUP BY`：

```
select partnumber, brandid, PartTerminonogyID
from yourtable t
where exists (select partnumber, brandid
              from yourtable t1
              where t.partnumber = t1.partnumber
                and t.brandid = t1.brandid
              group by partnumber, brandid
              having count(distinct PartTerminonogyID) >1); 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/2a2dc/5)

如果您想包含其他表格，那么您将只使用`JOIN`它们：

```
select t.partnumber, t.brandid, t.PartTerminonogyID, p.partTerminologyName 
from yourtable t
inner join parts p
  on t.PartTerminonogyID = p.PartTerminonogyID
where exists (select partnumber, brandid
              from yourtable t1
              where t.partnumber = t1.partnumber
                and t.brandid = t1.brandid
              group by partnumber, brandid
              having count(distinct PartTerminonogyID) >1); 
```

# r - 从 R 的 FDA/CollocInfer 包中的平滑数据中检索值

> ID：14635105
> 
> 赞同：0
> 
> 时间：2013-01-31T21:03:36.120
> 
> 标签：r

我在 R 中使用严重依赖 fda 包的 CollocInfer 包来估计常微分方程的参数。我能够成功实施广义分析方法来获得这些参数估计值，但我无法弄清楚如何使用 Profile.LS() 函数的输出来评估 t0 时 ODE 的估计解，这将给出估计值基于数据的 ODE 的初始条件。

**编辑**我之前的例子太简单了，没有捕捉到问题。下面是修改后的例子。

**简单示例**假设我有数据 x，y，我使用 B 样条基础对其进行平滑处理

```
require(fda)
x <- seq(0, 25)
y <- 3 + sin(x) + rnorm(1, 0, 1)
b.basis <- create.bspline.basis(range(x), nbasis=8, norder=4)
smooth.y <- smooth.basis(x, y, b.basis)
yfd <- smooth.y$fd
yfdPar <- fdPar(yfd, 1, 1)
yfd1 <- smooth.fd(yfd, yfdPar) 
```

在 x=0 处计算 yfd1 的值的（最简单的）方法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:51:32.613

您可以使用指定的参数值评估功能数据对象`eval.fd`

```
eval.fd(0,yfd1)
        rep1
[1,] 3.27759 
```

# bash - 在bash（debian）中连接变量

> ID：14635108
> 
> 赞同：1
> 
> 时间：2013-01-31T21:03:45.447
> 
> 标签：bash, variables, concatenation

我已经看到了多种变量连接应该如何工作的方式，但它们没有按我的预期工作，也不知道为什么......
我正在将一个 txt 文件读入一个数组，每一行都是我想要做的域名区域传输输出到文件名为 domain.zone 简单权限的文件....

好的，这是我已经完成了实际挖掘部分的脚本

```
#!/bin/bash
filecontent=($(cat goodFvzones.txt))
for t in "${filecontent[@]}"
do
n=".zone"
x=$t$n
echo "$x"
#dig @dnsserver -t axfr $t > $x
done 
```

当我运行上述脚本时，如果它正在处理的域名是 domain.com，我得到的输出是：.zonen.com

预期的输出将是 domain.com.zone
变量 n（5 个字符）的内容覆盖了变量 t 的前 5 个字符有人能解释我做错了什么吗？我认为它一定与期间有关，但还没有能够弄清楚。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T21:38:32.853

当您注意到较短的字符串“覆盖”了较长字符串的开头时，首先要考虑的应该是`CR`字符（用于 Windows 和 Mac 行尾）。命令替换会删除换行符，但它会删除*Unix*换行符 ( `LF`) 并且对回车没有任何作用。

您可以过滤输入`tr -d '\r'`以摆脱回车，或使用`dos2unix`实用程序就地转换损坏的文件。

查看输出`less -U`有助于调试此类问题（`less -U`将回车、制表符和退格显示为控制字符，如`^M` `^I` `^H`）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:55:12.303

您可以在 IFS 中添加回车符 (\r)，使其成为另一个空格字符，用于参数解析：

```
IFS=$(printf "$IFS\r")
filecontent=($(cat goodFvzones.txt))
for t in "${filecontent[@]}"
do
  n=".zone"
  x=$t$n
  echo "$x"
  #dig @dnsserver -t axfr $t > $x
done 
```

# c++ - SDL_ttf 框架不会在 xCode 上运行，给出错误链接器命令失败，退出代码为 1

> ID：14635109
> 
> 赞同：1
> 
> 时间：2013-01-31T21:03:46.163
> 
> 标签：c++, xcode, sdl

我正在尝试将 SDL_ttf 框架添加到 xCode 4.6。但是，当我使用它的一些功能时，我得到了错误：

架构 x86_64 的未定义符号：“_TTF_CloseFont”，引用自：main.o “_TTF_Init”中的 clean_up()，引用自：main.o “_TTF_OpenFont”中的 init()，引用自：main.o “_TTF_Quit”中的 load_files() ”，引用自：main.o 中的 clean_up() “_TTF_RenderText_Solid”，引用自：main.o 中的 _SDL_main ld：未找到架构 x86_64 的符号：错误：链接器命令失败，退出代码为 1（使用 -v查看调用）

使用的东西是类型 TTF_font*、TTF_Init()、TTF_OpenFont()、TTF_RenderText_Solid、TTF_CloseFont() 和 TTF_Quit()

我该如何解决这个问题？

我之前已经添加了 SDL 框架和 SDL_image 框架，它们都花了一些时间才能工作，主要是因为 xcode 找不到标头。Stackoverflow 提供了大部分帮助，谢谢。但这一次我已经挣扎了很久，必须寻求帮助。“clang: error: linker command failed with exit code 1 (use -v to see invocation)”的问题早先出现在stackoverflow上，但没有一个回复适用于这种情况。我还尝试按照不同的指南在 xCode 上设置框架。它没有工作，我认为这不是问题，因为我已经设法让 SDL 和 SDL_image 都工作。但是，如果它有帮助，我确实使用本教程添加它们： http: [//lazyfoo.net/SDL_tutorials/lesson03/mac/xcode/index.php](http://lazyfoo.net/SDL_tutorials/lesson03/mac/xcode/index.php)

由于上述问题，我目前正在关注 LazyFoos SDL 教程，并被困在这部分[http://lazyfoo.net/SDL_tutorials/lesson07/index.php上。](http://lazyfoo.net/SDL_tutorials/lesson07/index.php)

（无关的小问题，为了让编译器编译主 SDL 框架，我必须在构建阶段的编译源中添加 -fno-objc-arc，（[如何为项目中的单个文件禁用 ARC？](https://stackoverflow.com/questions/6646052/how-can-i-disable-arc-for-a-single-file-in-a-project)）。我有不知道它做了什么，但它让我能够很好地运行程序，但是这以后会回来咬我吗？）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T20:47:38.743

您是否只看到 x86_64 架构的这些错误？最后我检查了一下，SDL 库不是为 64 位构建的。听起来快速简单的解决方法是将目标架构更改为 i386，它在 64 位版本的 Mac OS X 下仍然可以正常运行。

如果您真的希望您的应用程序构建为 64 位，请尝试使用[MacPorts](http://www.macports.org/install.php)来获得 SDL_ttf.framework 的 64 位构建：

```
sudo port install libsdl_ttf-framework 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-08-08T23:51:44.197

我有同样的问题（当我切换目标架构时出现额外的错误），但解决了它。我意识到我忘记了您发布的安装新库的链接中的一个步骤：

[http://lazyfoo.net/SDL_tutorials/lesson03/mac/xcode/index.php](http://lazyfoo.net/SDL_tutorials/lesson03/mac/xcode/index.php)

第 3 步，您需要在项目构建设置中告诉链接器有关新库的信息。

# sql - SQL 从 3 位小数舍入到 2 位小数

> ID：14635110
> 
> 赞同：3
> 
> 时间：2013-01-31T21:03:47.483
> 
> 标签：sql, ssrs-2008, rounding

我有一个 SSRS 2008 报告，其数据集运行一个返回计算列的 SQL 查询。此数据集填充报表中的表格。

计算的列最多返回 4 位小数。我想四舍五入到最接近的 2 位小数。即，8660.125 应该变成 8660.13，1487.8521 应该变成 1487.85

查询示例：

```
select [Hours] * [Rate] * [Complexity] * [Efficiency] from Hours 
```

我更喜欢在 SQL 查询而不是 SSRS 表中执行此舍入，因为我们试图使表保持“非智能”，因此我们可以将所有逻辑封装在 SQL 查询本身中。建议？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T21:09:48.067

这里有两个问题。

首先是四舍五入。这可以通过`Round`SQL 中的函数轻松完成：

```
SELECT Round(8660.125, 2);
-- returns 8660.130 
```

如您所见，第二个是它仍然返回小数点后的 3 位数字。这是由于数据类型。你得到了四舍五入的值，但它仍然显示一个额外的数字。

您可以通过以下方式解决此问题：

```
SELECT Convert(decimal(16, 2), 8660.125);
--returns 8660.13 by implicitly rounding--you could round first but not needed 
```

但是，上面这两个值在数值上是**相同**的。在我看来，您根本不应该在 SQL Server 端处理演示文稿。如果您想要两位小数，只需将 SSRS 报告中的单元格格式设置为`#.00`. 无论如何，这将确保您获得所需的（四舍五入）小数位数！不需要任何功能。只是一个简单的属性。

日期的原理相同。日期的基础价值只是*一个数字*。但是有无数种方法可以向用户显示日期——使用长名称或不同的部分顺序或使用不同的分隔符。每次更改日期格式时，您会一直回到 SQL 并更改`Convert()`样式吗？

您不希望 SQL Server 确定报表中这些数字的字体、颜色、大小、填充、样式、位置或可见性。这些都必须在设计时手动设置。那么为什么值的显示方式（当值完全相等时）会有所不同？在我看来，将其推送到 SQL 查询中会将关注的区域移到错误的位置。这增加了不需要存在的查询的复杂性（而不是“智能”）！而且我也没有看到将单元格的数字格式设置为“增加智能”。

这是一个演示问题，因此请将其放在解决所有其他演示元素的适当位置——SSRS 报告。

**更新**

我可以想到一种情况，您希望在查询中执行转换，那时该值将在更多计算中进一步使用，并且有关所述计算的业务规则需要它。例如，如果你在计算银行利息，他们可能有这样的规则：“在第 1 步之后四舍五入到小数点后 4 位，然后在步骤 3 之后最终四舍五入到小数点后 2 位（美元和美分）。” 但那是另一回事：现在*价值*很重要，而不仅仅是它的*展示*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:09:29.753

尝试使用类似的东西`CAST`——它应该为你处理四舍五入。

```
SELECT CAST(col as DECIMAL(10,2)) 
```

这是[SQL 小提琴](http://sqlfiddle.com/#!3/d41d8/8339)。

使用上面的示例查询，使用：

```
select CAST([Hours] * [Rate] * [Complexity] * [Efficiency] as DECIMAL(10,2)) from Hours 
```

祝你好运。

# php - 如何使 ZEND_BEGIN_ARG_INFO_EX 控制参数数量，传递给 PHP 扩展？

> ID：14635111
> 
> 赞同：5
> 
> 时间：2013-01-31T21:03:48.003
> 
> 标签：php, c, php-extension, php-internals

我正在使用 C 开发一个 PHP 扩展。到目前为止，我正在对参数进行正确验证，从 PHP 用户空间传递给扩展的函数。

该宏`ZEND_BEGIN_ARG_INFO_EX`可用于向 Zend Engine 提供有关函数参数的信息。宏的第 4 个参数，命名为`required_num_args`，让引擎自动控制参数的数量，免去了我的麻烦。但是，我找不到让它工作的方法：引擎总是在没有任何警告的情况下运行扩展的函数，即使 PHP 脚本没有传递足够的参数也是如此。

这是我对函数参数的定义：

```
ZEND_BEGIN_ARG_INFO_EX(test_func_swt_arginfo, 0, 0, 3)
    ZEND_ARG_INFO(1, firstArg)
    ZEND_ARG_ARRAY_INFO(0, secondArg, true)
    ZEND_ARG_OBJ_INFO(1, thirdArg, SomeClass, false)
ZEND_END_ARG_INFO() 
```

这是我对函数的定义，由 PHP 扩展导出：

```
static const zend_function_entry test_func_functions[] = {
    PHP_FE(sample_with_types, test_func_swt_arginfo)
    PHP_FE_END
}; 
```

这是我的功能：

```
PHP_FUNCTION(sample_with_types)
{
    RETURN_TRUE;
} 
```

这是我运行的 PHP 脚本：

```
<?php
sample_with_types(); 
```

预期结果：PHP 显示错误/警告/异常，例如*“没有足够的参数传递给函数”*；该功能不执行。

实际结果：函数执行并返回`true`。

如何正确配置函数参数结构，以便 Zend Engine 自动检查参数数量？还是我误解了宏中`required_num_args`参数的目的？`ZEND_BEGIN_ARG_INFO_EX`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-01T16:45:44.423

据我所知，这不是`ZEND_BEGIN_ARG_INFO_EX`目的。

`ZEND_BEGIN_ARG_INFO_EX`是 PHP 5 的新增功能，用于生成更简洁的代码、启用类型提示、引用传递和反射。考虑以下 arginfo 声明，用于只返回 true 的实际函数：

```
ZEND_BEGIN_ARG_INFO_EX(arginfo_test, 0, 0, 3)
    ZEND_ARG_INFO(0, firstArg)
    ZEND_ARG_OBJ_INFO(0, objNonNull, stdClass, 0)
    ZEND_ARG_OBJ_INFO(0, obj, stdClass, 1)
    ZEND_ARG_OBJ_INFO(1, objByRef, stdClass, 1)
ZEND_END_ARG_INFO() 
```

它具有以下效果：

```
sample_with_types();                          // ok
sample_with_types(1, null);                   // error: arg #2 should be stdClass
sample_with_types(1, new stdClass, null);     // ok
sample_with_types(1, new stdClass, 1);        // error: arg #3 should be stdClass
sample_with_types(1, new stdClass, null, 2);  // error: arg #4 must be reference 
```

此外，它还为您的函数提供反射功能：

```
$ref = new ReflectionFunction('sample_with_types');
var_dump($ref->getParameters()); 
```

...给出类似于以下内容的输出：

```
array(4) {
  [0]=>
  &object(ReflectionParameter)#2 (1) {
    ["name"]=>
    string(8) "firstArg"
  }
  [1]=>
  &object(ReflectionParameter)#3 (1) {
    ["name"]=>
    string(10) "objNonNull"
  }
  [2]=>
  &object(ReflectionParameter)#4 (1) {
    ["name"]=>
    string(3) "obj"
  }
  [3]=>
  &object(ReflectionParameter)#5 (1) {
    ["name"]=>
    string(8) "objByRef"
  }
} 
```

如果省略 arginfo，则`ReflectionFunction::getParameters()`返回一个空数组。

宏参数专门用于反射，`required_num_args`表示反射函数时需要多少个参数。

如果您需要使参数成为必需，而不仅仅是在使用反射时将它们标记为必需，您仍然必须使用`zend_parse_parameters`，在大多数情况下，您仍然需要获取参数的实际值：

```
PHP_FUNCTION(sample_with_types)
{
    long arg1;
    zval *arg2 = NULL, *arg3 = NULL, *arg4 = NULL;
    zend_class_entry ce2, ce3, ce4;

    if (zend_parse_parameters(ZEND_NUM_ARGS() TSRMLS_CC, "looo", &arg1, 
                              &arg2, &ce2, &arg3, &ce3, &arg4, &ce4) == FAILURE)
    {
        return;
    }

    RETURN_TRUE;
} 
```

请注意我在上面如何使用`"looo"`（通用对象类型）而不是`"lOO!O!"`（具有空说明符的特定对象类型）。类型提示已经用 arginfo 指定了，所以不需要重复两次。

所以，没有 arginfo：

*   您必须使用少量`zend_fetch_class`调用和类条目来键入提示您的对象参数。
*   它不会启用反射。
*   您将无法声明通过引用传递的参数。
*   它显然会产生不太干净的代码。

出于显而易见的原因，您需要确保 arginfo 声明和`zend_parse_parameters`调用匹配。

# highcharts - 如何更改已渲染的仪表的刻度盘半径长度？

> ID：14635113
> 
> 赞同：0
> 
> 时间：2013-01-31T21:03:50.903
> 
> 标签：highcharts

如何更改已渲染的仪表的刻度盘半径长度？

像这样的东西：

```
chart.options.plotOptions.gauge.dial.radius = (Math.random() * 200);
chart.redraw(); 
```

[http://jsfiddle.net/noahpeters/NzxUa/](http://jsfiddle.net/noahpeters/NzxUa/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T08:08:49.163

有可能，您必须在系列项目上设置选项并将系列标记为脏以告诉 Highcharts 重绘它。

```
function (chart) {
    setInterval(function () {
        chart.series[0].options.dial.radius = Math.random() * 200;
        chart.series[0].isDirty = true;
        chart.redraw();

    }, 3000);
}); 
```

[http://jsfiddle.net/highcharts/NzxUa/1/](http://jsfiddle.net/highcharts/NzxUa/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T05:29:16.160

根据`highcharts.js`redraw 方法的源代码，我怀疑您所描述的内容是不可能的。调用时仅更新轴`redraw`。这也在[文档](http://api.highcharts.com/highcharts#Chart.redraw%28%29)中注明。

但是，您可以自己重新绘制东西，但这可能有点矫枉过正。

# python - 如何在 Django 模板的集合中访问特定对象？

> ID：14635114
> 
> 赞同：0
> 
> 时间：2013-01-31T21:03:55.077
> 
> 标签：python, django

该模型：

```
class Panel(models.Model):
loc = models.IntegerField()
title = models.CharField(max_length=200)

def __unicode__(self):
    return self.title 
```

该模板由视图中的 Panel 实例提供：

```
def index(request):
return render_to_response('application/index.html', 
                          {"DEBUG": True,
                           "panels": Panel.objects.all() },
                          context_instance=RequestContext(request)) 
```

模板尝试访问特定模型实例，如下所示：

```
{% with panel = panels[1] %}
...presentation logic....
{% endwith %} 
```

目前这导致

/appplicatino/ u'with' 处的 TemplateSyntaxError 需要至少一个变量赋值

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:07:37.390

`panels.1`您可以使用模板访问面板，如下所示：

```
{% with panel=panels.1 %}
   ...
{% endwith %} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:08:48.703

也许你可以这样做：

```
list(Panel.objects.all()) 
```

在您的控制器中，然后在模板中您可以执行以下操作：

```
{% for panel in panels %}
    <!-- your code here -->
{% endfor %} 
```

# android - 应用程序中的内存泄漏（下载、保存和在它们之间循环）

> ID：14635119
> 
> 赞同：3
> 
> 时间：2013-01-31T21:03:59.820
> 
> 标签：android, memory-leaks, bitmap, android-imageview

我正在构建一个应用程序，它从服务器下载 2 张图像，将它们保存到 SD 卡并显示它们（循环，每 15 秒更改一次图像）。

我完成了，但几分钟后程序崩溃：OutOfMemoryError：位图超出 VM 预算的大小。

因此，某处一定存在内存泄漏。我对 android 编程还是很陌生：不太确定我需要做哪些 VM 不会做的清理工作。

有什么帮助吗？

```
private ImageView mImageView;
private Bitmap mImageBitmap;
public static String rslt="";
/** Called when the activity is first created. */
@SuppressLint("NewApi")
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    //Remove title bar
    this.requestWindowFeature(Window.FEATURE_NO_TITLE);

    //Remove notification bar
    this.getWindow().setFlags(WindowManager.LayoutParams.FLAG_FULLSCREEN, WindowManager.LayoutParams.FLAG_FULLSCREEN);
    setContentView(R.layout.main);

    mImageView = (ImageView) findViewById(R.id.imageView1);

    mImageBitmap=null;

    final Handler handler = new Handler();
    Runnable runnable = new Runnable() {
        int count = 1;
        public void run() {
            Bitmap bm = getNewImages();
            if (bm != null){
                mImageView.setImageBitmap(bm);
                bm=null;
                System.gc();
                handler.postDelayed(this, 15* 1000);
            }else if(count==1){
                File img1 = new File(Environment.getExternalStorageDirectory(), "1.jpg");
                if(img1.exists()){
                    bm = BitmapFactory.decodeFile(img1.getAbsolutePath());
                    if (bm != null){
                        mImageView.setImageBitmap(bm);
                        bm=null;
                    }
                }

                count = 2;
                System.gc();
                handler.postDelayed(this, 15* 1000);
            }else if (count==2){
                File img2 = new File(Environment.getExternalStorageDirectory(), "2.jpg");
                if(img2.exists()){
                    bm = BitmapFactory.decodeFile(img2.getAbsolutePath());
                    if (bm != null){
                        mImageView.setImageBitmap(bm);

                        bm=null;
                    }
                }

                count=1;
                System.gc();
                handler.postDelayed(this, 15* 1000);
            }

        }
        private Bitmap getNewImages() {
            ConnectivityManager connManager = (ConnectivityManager) getSystemService(CONNECTIVITY_SERVICE);
            NetworkInfo mWifi = connManager.getNetworkInfo(ConnectivityManager.TYPE_WIFI);
            mImageBitmap=null;
            if (mWifi.isConnected()) {
                try{
                    //              EditText ed1=(EditText)findViewById(R.id.editText1);
                    //              String rego=ed1.getText().toString();
                    String rego="AGR905";
                    rslt="START";
                    Caller c=new Caller();
                    c.rego=rego;
                    c.join();
                    c.start();
                    while(rslt=="START")
                    {
                        try
                        {
                            Thread.sleep(10);
                        }
                        catch(Exception ex)
                        {
                        }
                    }
                }
                catch(Exception ex){
                }

                if (rslt.length()<=1600){
                }else{
                    byte[] decodedString = Base64.decode(rslt, Base64.DEFAULT);
                    mImageBitmap = BitmapFactory.decodeByteArray(decodedString, 0, decodedString.length);

                    ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                    mImageBitmap.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

                    File from = new File(Environment.getExternalStorageDirectory(), "1.jpg");
                    if(from.exists()){
                        File to = new File(Environment.getExternalStorageDirectory(), "2.jpg");
                        from.renameTo(to);
                        from.delete();

                    }
                    //you can create a new file name "test.jpg" in sdcard folder.
                    File f = new File(Environment.getExternalStorageDirectory()+ File.separator + "1.jpg");
                    try {
                        f.createNewFile();

                        //write the bytes in file
                        FileOutputStream fo = new FileOutputStream(f);
                        fo.write(bytes.toByteArray());

                        // remember close de FileOutput
                        fo.close();
                    } catch (IOException e) {
                        e.printStackTrace();
                    }
                }
            }
            return mImageBitmap;
        }
    };
    handler.postDelayed(runnable, 2000); //for initial delay.. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:07:02.553

有一些事情应该有助于平滑这里的记忆。

1.  完成位图后运行 bitmap.recycle()。
2.  之后，将它们设置为 null。
3.  每次通过时运行垃圾收集器。`System.gc()`.
4.  确保您从清单中请求大堆。`android:largeHeap="true"`进入应用程序。
5.  对您的应用程序进行内存分析。有关如何完成此操作的更多详细信息，请参阅[此答案。](https://stackoverflow.com/a/9987237/544198)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:14:07.613

我不认为问题是内存泄漏。通过同时将两个图像保存在内存中，您可能超出了内存预算。请记住，每个位图使用**height_in_px * width_in_px * 4**字节，而您的应用程序的内存预算为**24...48 MB**（取决于设备）。

有一个关于位图有效使用的[很棒的教程。](http://developer.android.com/training/displaying-bitmaps/index.html)使用它来找出问题所在并加以解决。

# oracle - 具有多个数据源的 Spring/JNDI：ORA-12519，TNS：找不到合适的服务处理程序

> ID：14635125
> 
> 赞同：2
> 
> 时间：2013-01-31T21:04:09.797
> 
> 标签：oracle, spring, jpa, jndi, openjpa

当前的 Spring 应用程序需要使用 JNDI 设置多个数据源。所以这是我的主要配置：

在 Context.xml/vFabric tc

```
<Resource name="jdbc/app_A" auth="Container" type="javax.sql.DataSource"
    driverClassName="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@myhost:1521:orcl"
    username="usernameA" password="passwordA" maxActive="20" maxIdle="10" maxWait="-1" />
<Resource name="jdbc/app_B" auth="Container" type="javax.sql.DataSource"
    driverClassName="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@myhost:1521:orcl"
    username="usernameB" password="usernameB" maxActive="20" maxIdle="10" maxWait="-1" /> 
```

在应用程序的 Web.xml 中：

```
<resource-ref>
    <description>Oracle Datasource for app_A</description>
    <res-ref-name>jdbc/app_A</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
</resource-ref>
<resource-ref>
    <description>Oracle Datasource for app_B</description>
    <res-ref-name>jdbc/app_B</res-ref-name>
    <res-type>javax.sql.DataSource</res-type>
    <res-auth>Container</res-auth>
</resource-ref> 
```

在 ApplicationContext.xml 中

```
<jee:jndi-lookup id="dataSource1" jndi-name="java:comp/env/jdbc/app_A" resource-ref="true" />
<jee:jndi-lookup id="dataSource2" jndi-name="java:comp/env/jdbc/app_B" resource-ref="true" /> 
```

最后我得到这样的异常堆积：

```
Jan 31, 2013 3:36:55 PM org.apache.catalina.core.NamingContextListener addResource
WARNING: Failed to register in JMX: javax.naming.NamingException: ORA-01017: invalid username/password; logon denied

Jan 31, 2013 3:36:56 PM org.apache.naming.NamingContext lookup
WARNING: Unexpected exception resolving reference
java.sql.SQLException: Listener refused the connection with the following error:
ORA-12519, TNS:no appropriate service handler found

at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:412)
at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:531)
at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:221)
at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:32)
at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:503)
at org.apache.tomcat.jdbc.pool.PooledConnection.connectUsingDriver(PooledConnection.java:278)
at org.apache.tomcat.jdbc.pool.PooledConnection.connect(PooledConnection.java:182)
at org.apache.tomcat.jdbc.pool.ConnectionPool.createConnection(ConnectionPool.java:699)
at org.apache.tomcat.jdbc.pool.ConnectionPool.borrowConnection(ConnectionPool.java:631)
at org.apache.tomcat.jdbc.pool.ConnectionPool.init(ConnectionPool.java:485)
at org.apache.tomcat.jdbc.pool.ConnectionPool.<init>(ConnectionPool.java:143)
at org.apache.tomcat.jdbc.pool.DataSourceProxy.pCreatePool(DataSourceProxy.java:116)
at org.apache.tomcat.jdbc.pool.DataSourceProxy.createPool(DataSourceProxy.java:103)
at org.apache.tomcat.jdbc.pool.DataSourceFactory.createDataSource(DataSourceFactory.java:539)
at org.apache.tomcat.jdbc.pool.DataSourceFactory.getObjectInstance(DataSourceFactory.java:237)
at org.apache.naming.factory.ResourceFactory.getObjectInstance(ResourceFactory.java:143)
at javax.naming.spi.NamingManager.getObjectInstance(NamingManager.java:304)
at org.apache.naming.NamingContext.lookup(NamingContext.java:843)
at org.apache.naming.NamingContext.lookup(NamingContext.java:154)
at org.apache.naming.NamingContext.lookup(NamingContext.java:831)
at org.apache.naming.NamingContext.lookup(NamingContext.java:168)
at org.apache.catalina.core.NamingContextListener.addResource(NamingContextListener.java:1061)
at org.apache.catalina.core.NamingContextListener.createNamingContext(NamingContextListener.java:671)
at org.apache.catalina.core.NamingContextListener.lifecycleEvent(NamingContextListener.java:270)
at org.apache.catalina.util.LifecycleSupport.fireLifecycleEvent(LifecycleSupport.java:119)
at org.apache.catalina.util.LifecycleBase.fireLifecycleEvent(LifecycleBase.java:90)
at org.apache.catalina.core.StandardContext.startInternal(StandardContext.java:5173)
at org.apache.catalina.util.LifecycleBase.start(LifecycleBase.java:150)
at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:901)
at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:877)
at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:618)
at org.apache.catalina.startup.HostConfig.deployDirectory(HostConfig.java:1100)
at org.apache.catalina.startup.HostConfig$DeployDirectory.run(HostConfig.java:1618)
at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)
at java.util.concurrent.FutureTask.run(FutureTask.java:138)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:662)
Caused by: oracle.net.ns.NetException: Listener refused the connection with the following error:
ORA-12519, TNS:no appropriate service handler found

at oracle.net.ns.NSProtocol.connect(NSProtocol.java:385)
at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1042)
at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:301)
... 38 more
Jan 31, 2013 3:36:56 PM org.apache.catalina.core.NamingContextListener addResource
WARNING: Failed to register in JMX: javax.naming.NamingException: Listener refused the  connection with the following error:
ORA-12519, TNS:no appropriate service handler found

Jan 31, 2013 3:36:56 PM org.apache.naming.NamingContext lookup
WARNING: Unexpected exception resolving reference
java.sql.SQLException: Listener refused the connection with the following error:
ORA-12519, TNS:no appropriate service handler found 
```

真的不知道为什么会弹出“找不到合适的服务处理程序”错误，似乎连接不被 orcl 监听器接受/理解。

这是我插入persistentence.xml的内容

```
<persistence-unit name="persistenceUnit1">
....
<jta-data-source>jdbc/app_A</jta-data-source>
....
</persistence-unit>

<persistence-unit name="persistenceUnit2">
....
<jta-data-source>jdbc/app_B</jta-data-source>
....
</persistence-unit> 
```

以下是一些有趣的发现和困惑：

1.  我在 SQL Developer 中使用 jdbc url "jdbc:oracle:thin:@myhost:1521:orcl" 来建立连接，当我测试它时，有时它可以毫无问题地连接，但有时它会启动相同的问题：“适当的服务处理程序找到”。但是，相同的 jdbc url 可以在以前的 Spring 应用程序中正常工作。那么诀窍是什么？

2.  如何使用 JNDI 部署多个数据源？我们可以像在 context.xml 中那样提供多个标签作为解决方案吗？

提前感谢您的任何建议。

## 更新 1

我将其中一个数据源恢复为常规 jdbc 数据连接，将另一个保留为 JNDI，现在应用程序运行起来就像一个魅力。所以肯定问题是由多个数据源引起的，我敢打赌应该有特定的配置协议来使多个 jndi 数据源一起工作。如果两个数据源来自同一个数据库（相同的 url）但不同的方案（用户名/密码），那么配置参数的正确语法是什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-09T20:59:52.000

发现问题是Oracle内存溢出引起的，从JNDI设置：

```
maxActive="20" maxIdle="10" 
```

太多的连接要求 Oracle 提供。除非 Oracle 服务器设置了测试环境可以花费的过多连接，否则最好将范围缩小为

```
maxActive="1" maxIdle="1" 
```

所以修改活动号码，重新启动应用程序（如果遇到 oracle 错误则重新启动 oracle），问题应该不会发生。干杯。

# llvm - klee .bca 文件丢失

> ID：14635126
> 
> 赞同：4
> 
> 时间：2013-01-31T21:04:22.137
> 
> 标签：llvm, klee

在我的 LLVM 2.9 上安装 Klee 时（根据需要），我遵循了[http://klee.llvm.org/GetStarted.html ，意思是：](http://klee.llvm.org/GetStarted.html)

1.  安装依赖完成

    `export C_INCLUDE_PATH=/usr/include/i386-linux-gnu/`完毕

    `export CPLUS_INCLUDE_PATH/usr/include/i386-linux-gnu/`完毕

2.  构建 LLVM 2.9 完成

    安装 llvm-gcc 完成

    将 llvm-gcc 添加到我的 PATH DONE

    导出路径=`$PATH:/home/alex/llvm2.9/llvm/llvm-gcc-4.2-2.9-i686-linux/llvm-gcc-4.2-2.9-i686-linux/bin/`

    下载并构建 LLVM 2.9 完成

3.  `--with-cryptominisat2`使用at configuration 和`make OPTIMIZE=-O2 CFLAGS_M32= install`at make `ulimit -s unlimited`DONE构建 STP DONE
4.  使用 llvm-gcc DONE 构建 uclibc
5.  svn klee 完成
6.  配置 KLEE DONE

    。/配置`--with-llvm=/home/alex/llvm2.9/llvm/ --with-stp=/home/alex/llvm2.9/llvm/stp/ --with-uclibc=/home/alex/llvm2.9/llvm/klee-uclibc-0.02-i386/ --with-llvm-build-mode=Release+Asserts --enable-posix-runtime`

7.  建造 KLEE 完成

    和`ENABLE_OPTIMIZED=1`

    没有错误，但我有警告“ `/home/alex/llvm2.9/llvm/klee/Makefile.rules:1175: Bytecode libraries require LLVM capable compiler but none is available ****`”

但是，当我尝试教程时，出现段错误：klee：错误：找不到链接器输入' `/home/alex/llvm2.9/llvm/klee/Release+Asserts/lib/libkleeRuntimeIntrinsic.bca`'

它们在 Klee 编译期间根本没有构建。你能告诉我我能做什么吗？也许我的问题与这个线程有关： http: [//thread.gmane.org/gmane.comp.compilers.llvm.klee/923](http://thread.gmane.org/gmane.comp.compilers.llvm.klee/923)。

感谢您的任何帮助 ！

# javascript - Weather Underground API - 预测帮助 - Javascript

> ID：14635133
> 
> 赞同：1
> 
> 时间：2013-01-31T21:04:43.257
> 
> 标签：javascript, json, api, weather-api

我正在尝试使用以下方法从 Weather Underground API 获得 3 天的预报：

```
var Forcast = parsed_json['forecast']['txt_forecast']['period'][0]['fcttext_metric']; 
```

它不工作，我没有使用 json 的经验，所以我不知道我需要做什么才能让它工作。Bellow是我想要的json文件的一部分：

```
"forecast": {
"txt_forecast": {
"date": "2:00 PM PDT",
"forecastday": [{
"period": 0,
"icon": "partlycloudy",
"icon_url": "http://icons-ak.wxug.com/i/c/k/partlycloudy.gif",
"title": "Tuesday",
"fcttext": "Partly cloudy in the morning, then clear. High of 68F. Breezy. Winds from the West at 10 to 25 mph.",
"fcttext_metric": "Partly cloudy in the morning, then clear. High of 20C. Windy. Winds from the West at 20 to 35 km/h.",
"pop": "0"
}, { 
```

有人可以告诉我如何获得我需要的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-12T16:04:21.327

在官方 Wunderground 论坛上的一位用户的帮助下，我设法解决了这个问题。这是我正在使用的新代码以及更多添加的位。

```
jQuery('#GetWeather').click(function() {
var PostCode=" ";
$.ajax({ url : "http://api.wunderground.com/api/2508132ae0c7601a/geolookup/forecast/q/UK/"+PostCode +".json",
dataType : "jsonp",
success : function(parsed_json) {

var Forcast = parsed_json['forecast']['simpleforecast']['forecastday'];

for (index in Forcast) {
var imageurl = "http://.....";
/* Weather Box 0 Day 1, 1st period */
$('.Wicon').css('background-image',"url("+imageurl+Forcast[0]['icon']+".svg)");
$('#GetWeatherDay').html(Forcast[0]['date']['weekday']);
$('#GetWeatherState').html(Forcast[0]['conditions']);
$('#GetWeatherTempHigh').html('High of '+Forcast[0]['high']['celsius']+'&#8451');
$('#GetWeatherTempLow').html('Low of '+Forcast[0]['low']['celsius']+'&#8451');
$('#GetWeatherMaxWind').html('Max Wind '+Forcast[0]['maxwind']['mph']+' Mph');
$('#GetWeatherAveWind').html('Average Wind '+Forcast[0]['avewind']['mph']+' Mph');
$('#GetWeatherWindDir').html('Wind Direction '+Forcast[0]['avewind']['dir']);
$('#GetWeatherHumidityA').html('Average '+Forcast[0]['avehumidity']+'%'); 
```

# java - 将用空格分隔的整数读入 int[] 数组

> ID：14635136
> 
> 赞同：29
> 
> 时间：2013-01-31T21:04:51.853
> 
> 标签：java, arrays, int, inputstream

我读了

```
BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
reader.readLine(); 
```

示例输入是

```
1 4 6 32 5 
```

读取输入并将其放入整数数组的最快方法是什么`int[]`？

如果可能的话，我也在寻找一些单线解决方案。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-31T21:10:51.903

你可以使用`Scanner`：

```
Scanner scanner = new Scanner(System.in);
List<Integer> list = new ArrayList<Integer>();
while (scanner.hasNextInt())
  list.add(scanner.nextInt());
int[] arr = list.toArray(new int[0]); 
```

直到我们在 java 中有闭包，这可能是你能得到的最短的。

`int[] arr = list.toArray(new int[0]);`不起作用，因为没有从整数到整数的转换。您不能将 int 用作泛型的类型参数。

但是是的，如果您使用的是 Java 8，那么您可以使用 Stream API 和下面的代码片段（更好的做事方式）。

`int[] array = list.stream().mapToInt(i->i).toArray();`

* * *

## 回答 #2

> 赞同：26
> 
> 时间：2016-10-18T08:54:48.523

***简答***

**BufferedReader 比 Scanner 更快**

使用`BufferedReader`然后拆分和解析每个 Integer 值比`nextInt()`使用`Scanner`.

* * *

***解释***

1.  使用`readLine()`方法`BufferedReader`并扫描整个字符串。
2.  将此字符串拆分为`str.split("\\s")`
3.  遍历上面的数组并使用解析每个整数值`Integer.parseInt()`

`nextInt()`上面的方法经过测试可以解析 1000 个不同的整数，并且被证明比使用类方法快两倍`Scanner`。

*测试 BufferedReader 类的代码*

```
import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

class BufferedReaderTest
{
    public static void main(String[] args) throws IOException {
        BufferedReader bi = new BufferedReader(new InputStreamReader(System.in));

        int num[] = new int[1000];
        String[] strNums;
        long startTime, endTime;

        /*________ TEST STARTS ________*/
        startTime = System.nanoTime();
        strNums = bi.readLine().split("\\s");
        for(int i=0; i<strNums.length; i++) {
            num[i] = Integer.parseInt(strNums[i]);
        }
        endTime = System.nanoTime();
        /*________ TEST ENDS ________*/

        System.out.println("Total Time Taken: " + (endTime - startTime));
    }
} 
```

*测试 Scanner 的 nextInt() 的代码*

```
import java.util.Scanner;
import java.io.IOException;

class ScannerTest
{
    public static void main(String[] args) throws IOException {
        Scanner sc = new Scanner(System.in);
        int[] nums = new int[1000];
        int i=0;
        long startTime, endTime;

        /*________ TEST STARTS ________*/
        startTime = System.nanoTime();
        while(sc.hasNext())
            nums[i++] = sc.nextInt();
        endTime = System.nanoTime();
        /*________ TEST ENDS ________*/

        System.out.println("Total Time Taken: " + (endTime - startTime));
        for(i=0; i<nums.length; i++) {
            System.out.print(nums[i] + " ");
        }
    }
} 
```

*输入*

```
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 145 146 147 148 149 150 151 152 153 154 155 156 157 158 159 160 161 162 163 164 165 166 167 168 169 170 171 172 173 174 175 176 177 178 179 180 181 182 183 184 185 186 187 188 189 190 191 192 193 194 195 196 197 198 199 200 201 202 203 204 205 206 207 208 209 210 211 212 213 214 215 216 217 218 219 220 221 222 223 224 225 226 227 228 229 230 231 232 233 234 235 236 237 238 239 240 241 242 243 244 245 246 247 248 249 250 251 252 253 254 255 256 257 258 259 260 261 262 263 264 265 266 267 268 269 270 271 272 273 274 275 276 277 278 279 280 281 282 283 284 285 286 287 288 289 290 291 292 293 294 295 296 297 298 299 300 301 302 303 304 305 306 307 308 309 310 311 312 313 314 315 316 317 318 319 320 321 322 323 324 325 326 327 328 329 330 331 332 333 334 335 336 337 338 339 340 341 342 343 344 345 346 347 348 349 350 351 352 353 354 355 356 357 358 359 360 361 362 363 364 365 366 367 368 369 370 371 372 373 374 375 376 377 378 379 380 381 382 383 384 385 386 387 388 389 390 391 392 393 394 395 396 397 398 399 400 401 402 403 404 405 406 407 408 409 410 411 412 413 414 415 416 417 418 419 420 421 422 423 424 425 426 427 428 429 430 431 432 433 434 435 436 437 438 439 440 441 442 443 444 445 446 447 448 449 450 451 452 453 454 455 456 457 458 459 460 461 462 463 464 465 466 467 468 469 470 471 472 473 474 475 476 477 478 479 480 481 482 483 484 485 486 487 488 489 490 491 492 493 494 495 496 497 498 499 500 501 502 503 504 505 506 507 508 509 510 511 512 513 514 515 516 517 518 519 520 521 522 523 524 525 526 527 528 529 530 531 532 533 534 535 536 537 538 539 540 541 542 543 544 545 546 547 548 549 550 551 552 553 554 555 556 557 558 559 560 561 562 563 564 565 566 567 568 569 570 571 572 573 574 575 576 577 578 579 580 581 582 583 584 585 586 587 588 589 590 591 592 593 594 595 596 597 598 599 600 601 602 603 604 605 606 607 608 609 610 611 612 613 614 615 616 617 618 619 620 621 622 623 624 625 626 627 628 629 630 631 632 633 634 635 636 637 638 639 640 641 642 643 644 645 646 647 648 649 650 651 652 653 654 655 656 657 658 659 660 661 662 663 664 665 666 667 668 669 670 671 672 673 674 675 676 677 678 679 680 681 682 683 684 685 686 687 688 689 690 691 692 693 694 695 696 697 698 699 700 701 702 703 704 705 706 707 708 709 710 711 712 713 714 715 716 717 718 719 720 721 722 723 724 725 726 727 728 729 730 731 732 733 734 735 736 737 738 739 740 741 742 743 744 745 746 747 748 749 750 751 752 753 754 755 756 757 758 759 760 761 762 763 764 765 766 767 768 769 770 771 772 773 774 775 776 777 778 779 780 781 782 783 784 785 786 787 788 789 790 791 792 793 794 795 796 797 798 799 800 801 802 803 804 805 806 807 808 809 810 811 812 813 814 815 816 817 818 819 820 821 822 823 824 825 826 827 828 829 830 831 832 833 834 835 836 837 838 839 840 841 842 843 844 845 846 847 848 849 850 851 852 853 854 855 856 857 858 859 860 861 862 863 864 865 866 867 868 869 870 871 872 873 874 875 876 877 878 879 880 881 882 883 884 885 886 887 888 889 890 891 892 893 894 895 896 897 898 899 900 901 902 903 904 905 906 907 908 909 910 911 912 913 914 915 916 917 918 919 920 921 922 923 924 925 926 927 928 929 930 931 932 933 934 935 936 937 938 939 940 941 942 943 944 945 946 947 948 949 950 951 952 953 954 955 956 957 958 959 960 961 962 963 964 965 966 967 968 969 970 971 972 973 974 975 976 977 978 979 980 981 982 983 984 985 986 987 988 989 990 991 992 993 994 995 996 997 998 999 1000 
```

以下是针对 1000 个不同输入测试这两个代码时的结果

```
 Scanner         BufferedReader  
                    (time ns)       (time ns)

Test Case 01        33855662        14202880    
Test Case 02        32779163        17772490    
Test Case 03        33421010        16625859    
Test Case 04        31901801        14552859    
Test Case 05        34890568        13943169    
Test Case 06        32913570        15342349    
Test Case 07        31733063        14153896    
Test Case 08        32063369        14368770    
Test Case 09        34354742        19922145    
Test Case 10        31760603        14441492    

Average             32967355.1      15532590.9 
```

* * *

## 回答 #3

> 赞同：18
> 
> 时间：2017-07-02T13:18:31.987

好吧，使用 Java 8 Streams，这实际上可以在一行中完成：

```
int[] array = Arrays.stream(reader.readLine().split("\\s")).mapToInt(Integer::parseInt).toArray(); 
```

`reader`你的`BufferedReader`对象在哪里。

**说明**：

*   `reader.readLine()`将输入读取为`String`
*   `reader.readLine().split("\\s")``String`在返回 a 的空白处拆分`String[]`
*   `Arrays.stream(reader.readLine().split("\\s"))``Stream`从中创建一个`String[]`
*   `Arrays.stream(reader.readLine().split("\\s")).mapToInt(Integer::parseInt)`适用`Integer::parseInt`于其中的每个元素`Stream`并返回`IntStream`由应用函数的结果组成的
*   `Arrays.stream(reader.readLine().split("\\s")).mapToInt(Integer::parseInt).toArray()`返回`int[]`包含该元素的`IntStream`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-10-07T13:47:13.997

由于您不知道输入的大小，您可以将输入读取为字符串，然后将字符串数组解析为整数数组

```
String[] arr=reader.readLine().split(" ");
int[] intarr=new int[arr.length];

for(int i=0;i<arr.length;i++)
 intarr[i]=Integer.parseInt(arr[i]); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-02-17T17:32:03.897

只需实现这个名为 FastReader 的类，如下所示：

```
static class FastReader
{
    BufferedReader br;
    StringTokenizer st;

    public FastReader()
    {
        br = new BufferedReader(new InputStreamReader(System.in));
    }

    String next()
    {
        while (st == null || !st.hasMoreElements())
        {
            try
            {
                st = new StringTokenizer(br.readLine());
            }
            catch (IOException  e)
            {
                e.printStackTrace();
            }
        }
        return st.nextToken();
    }

    int nextInt()
    {
        return Integer.parseInt(next());
    }

    long nextLong()
    {
        return Long.parseLong(next());
    }

    double nextDouble()
    {
        return Double.parseDouble(next());
    }

    String nextLine()
    {
        String str = "";
        try
        {
            str = br.readLine();
        }
        catch (IOException e)
        {
            e.printStackTrace();
        }
        return str;
    }
} 
```

现在像往常一样将用空格分隔的整数读入 int[] 数组：

```
FastReader fr = new FastReader();
int size = fr.nextInt();
int arr[] = new int[size];
for(int i=0; i<size; i++)
    arr[i] = fr.nextInt(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-01-31T21:07:15.420

尝试

```
 line = reader.readLine();
 String[] s = line.split(" ");
 ... 
```

您也可以查看 StringTokenizer，但最快的方法之一是读取字节并迭代它们并自己转换 ascii（utf8？）编码数字；）

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-09-28T03:53:05.367

```
BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
String [] s = reader.readLine().split(" ");
int []i= new  int[s.length];
for(int k =0;k<s.length;k++){
    i[k]= Integer.parseInt(s[k]);
 } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-01-31T21:38:17.680

您也可以预编译正则表达式`Pattern`来拆分字符串。

```
 Pattern pattern = Pattern.compile("(\\d+)\\s+"); //$NON-NLS-1$
    Matcher matcher = pattern.matcher(line);
    List<Integer> numbers = new LinkedList<Integer>();

    while (matcher.find()) {
        numbers.add(Integer.valueOf(matcher.group(1)));
    }
    Integer[] output = numbers.toArray(new Integer[numbers.size()]); 
```

或者你也可以直接使用 pattern.split

```
 Pattern pattern = Pattern.compile("(\\d+)"); //$NON-NLS-1$
    String[] numberAsString = pattern.split(line);
    int[] numbers = new int[numberAsString.length];
    for (int i = 0; i < numberAsString.length; i++) {
        numbers[i] = Integer.valueOf(numberAsString[i]).intValue();
    } 
```

必须爱正则表达式：D

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-20T11:04:31.543

简单的答案将使用扫描仪类的方法在`for`循环内读取整数。`nextInt()`

这是实现：

```
import java.util.Scanner;

public class DriverMain {
    public static void main(String args[]){
        Scanner scanner = new Scanner(System.in);

        System.out.println("Enter the size of an array: ");
        int size = scanner.nextInt();

        System.out.println("Enter array elements separated by single space.");
        int[] numbers = new int[size];
        for(int i=0;i<size;i++){
            numbers[i] =  scanner.nextInt();
        }

        for(int i=0;i<size;i++){
            System.out.println(numbers[i]);
        }

    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-07-28T13:47:30.753

使用拆分方法：

```
BufferedReader reader = new BufferedReader(new InputStreamReader(System.in));
String input[];
int arr[];
input = reader.readLine().split("\\s");
for (int i = 0; i < input.length; i++) {
    arr[i] = Integer.parseInt(input[i]);
} 
```

* * *

## 回答 #11

> 赞同：-1
> 
> 时间：2020-07-20T07:50:24.280

```
 Scanner sc = new Scanner(System.in);
    String n=sc.nextLine();
    String[] no=n.split(" ");
    int sum=0;
    for(String i:no){
        sum+=Integer.parseInt(i);}
    System.out.println(sum); 
```

* * *

上面的代码是如何使用 java 编程获取空间分隔的整数输入并执行您选择的任何任务，在我的情况下，我已经添加了数字。

# c# - 将 C# 结构传递给 C++/CLI

> ID：14635138
> 
> 赞同：2
> 
> 时间：2013-01-31T21:05:00.760
> 
> 标签：c#, c++, interop, c++-cli

使用 C# 和 C++/CLI 开始互操作的最佳在线指南/教程是什么？我正在寻找将 C# 制作的结构传递给 C++/CLI 的良好指南。我看到的许多教程都没有涉及将 C# 中制作的自定义结构传递给 C++/CLI。有什么建议么 ？

谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T21:14:20.380

你找不到很多教程的原因是它真的什么都没有。您将托管结构从 C# 传递到 C++/CLI，就像传递给另一个 C# 类/方法一样

假设你在 C# 中有结构：

```
public struct TheStruct
{
  public int i;
  public String str;
} 
```

您将在 C++/CLI 中编写如下所示的方法：

```
// *.h
void PassStruct(TheStruct ^myStruct); 

// *.cpp
void classnamegoeshere::PassStruct(TheStruct ^myStruct)
{
   int j = myStrict->i;
   String ^localStr = myStruct->str;
} 
```

所以，有几点注意...

1.  您需要确保将 using 语句放在 C++/CLI 代码中以获取 C# 参考
2.  在 C++/CLI 参考列表中包含 C# 程序集（定义结构）
3.  托管对象始终使用 ^ 指针表示法（与 * 相比）
4.  要使用方法或成员，请使用标准指针表示法 ( -> )
5.  您需要注意不要创建循环引用，因此您可能希望在 C++/CLI 中定义 TheStruct，在这种情况下，它看起来像：

    公共参考结构 TheStruct { public: int i; 字符串 ^str; }

容易吗？

# python - 在递归函数中保持计数

> ID：14635150
> 
> 赞同：1
> 
> 时间：2013-01-31T21:05:36.430
> 
> 标签：python, recursion, global-variables

第二个递归问题。我需要为递归函数中的值分配唯一 ID。

考虑一个文件夹结构，其中每个文件夹都可以包含项目或其他文件夹。但其中每一个都需要一个唯一的“id”。

我想，因为我不能在 python 的递归函数中使用任何全局变量，所以我会在每次调用时增加 id。但我大错特错了。想想下面的情况。

> 1 - 文件夹
> 
> > 2-文件夹
> > 
> > 3 - 物品
> > 
> > 4 - 物品
> 
> 2 - 文件夹

由于递归的工作方式，id 被分配了两次，并且没有办法检查。我该怎么做呢？（我正在使用 python。每当我有一个变量 'uniqueid' 递增时，我都会收到错误消息：

> 赋值前引用的局部变量“uniqueid”

) 我的代码： make_link_item 只返回一个字符串。

```
def build_xml(node,depth,itemid):
    #if 'Children' in node:
        #print colleges
    depth += 1
    for child in node['Children']:
        itemid += 1
        print ("  " * (depth - 1)) + "<item identifier=\"%s\" identifierref=\"%s\">" % (("itm" + ("%05d" % itemid)),("res" + ("%05d" % itemid)))
        print ("  " * depth) + "<title>%s</title>" % child['Name'].encode('utf-8')
        build_xml(child,depth,itemid)
        print ("  " * (depth - 1)) + "</item>"
    lectures = getlectures(node['Id'])
    if lectures:
        build_lectures(lectures,itemid,itemid)

def build_lectures(lectures,itemid,parentid):
    for x in range(len(lectures)):
        itemid += 1
        if x % 2 == 0:
            print "<item identifier=\"%s\" identifierref=\"%s\">" % (("itm" + ("%05d" % itemid)),("res" + ("%05d" % itemid)))
            print "<title>" + lectures[x].encode('utf-8') + "</title>"
            print "</item>"
        else:
            make_link_item(lectures[x-1].encode('utf-8'),lectures[x].encode('utf-8'),itemid,parentid) 
```

谢谢，

垫子

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:48:20.500

我希望我不会错过这个问题。

您可以使用一个`class Builder`用于构建 xml 树状结构的对象。你的班级有一个成员`increment`，你每次遇到一个新项目时都会增加一个。这样，就没有两个相同的 ID。

```
class Builder:

   def __init__(self):
        self.increment = 0

   #other methods you need 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T06:42:10.990

使用集合中的 Counter() 类的帮助解决了这个问题。

出于某种明显的原因：

```
counter = Counter() 
```

工作正常，我可以像这样增加它。

```
counter['id'] += 1 
```

即使在我的递归循环中。我不知道为什么，但我认为这与引用传递和值传递有关。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T14:38:32.523

您可以让每个 build_xml 调用返回其子项的最大标识符。然后您可以将下一个节点设置为该 id + 1。类似于：

```
def build_xml(node,depth,itemid):
    depth += 1
    for child in node['Children']:
        itemid += 1
        print ("  " * (depth - 1)) + "<item identifier=\"%s\" identifierref=\"%s\">" % (("itm" + ("%05d" % itemid)),("res" + ("%05d" % itemid)))
        print ("  " * depth) + "<title>%s</title>" % child['Name'].encode('utf-8')
        itemid = build_xml(child,depth,itemid)
        print ("  " * (depth - 1)) + "</item>"
    lectures = getlectures(node['Id'])
    if lectures:
        build_lectures(lectures,itemid,itemid)
    return itemid 
```

# python - 姜戈 || 同步数据库 || 创建 nvarchar 字段

> ID：14635156
> 
> 赞同：1
> 
> 时间：2013-01-31T21:05:46.760
> 
> 标签：python, django, django-models, nvarchar

我刚从 Django 开始，并试图用 nvarchar 字段而不是 varchar 创建一个 db 表。

我正在使用 MySQL 并在我的类中创建 models.CharField() 类型的对象。

有任何想法吗？

干杯，帕特里克

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T02:52:32.947

据我所知，MySQL 相当于`NVARCHAR`一个`VARCHAR`带有 utf8 字符集的 a。这是该主题的[MySQL 参考页面](http://dev.mysql.com/doc/refman/4.1/en/charset-national.html)（假设您使用的是 4.1 或更高版本）。

因此，如果您的列已经默认为 utf8，那么您就可以了。

如果您默认使用不同的字符集（不确定 Django 是否支持这一点）并且只需要一些 utf8 列，您可以子类化`models.CharField`和覆盖`db_type`. 这是[自定义字段的 Django 文档](https://docs.djangoproject.com/en/1.4/howto/custom-model-fields/#django.db.models.Field.db_type)。

# bash - 如何替换 Tcl 中以某个字符串开头的行？在 Tcl 中使用 bash 有错吗？

> ID：14635157
> 
> 赞同：1
> 
> 时间：2013-01-31T21:05:50.913
> 
> 标签：bash, replace, sed, tcl

我正在编写 Tcl 脚本，其中一部分涉及将包含某些字符串模式的行的第一次出现替换为另一行。我在 Tcl 中使用 sed 作为 bash 命令来完成它，如下所示：

```
exec bash -c {sed 0,/Apple/{s/Apple/Banana/ File} 
```

我的问题是有没有使用 Tcl 命令的直接方法，在 Tcl 中使用大量 Bash 命令是错误的还是不推荐？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:49:00.013

有一个`regsub`命令可以做到这一点：

```
regsub -- {Apple} $line Banana line 
```

这是[官方文档。](http://www.tcl.tk/man/tcl/TclCmd/regsub.htm)

如果您在阅读文件的第一行时需要帮助，[此页面](http://wiki.tcl.tk/367)可能会有所帮助。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-01T20:21:55.143

您可以使用以下`[string]`命令组合来执行此操作：

```
proc replaceFirst {text find replace} {
    set idx [string first $find $text]
    if {$idx == -1} {return $text}     ;# search string not found in text
    set end [expr {$idx + [string length $find] - 1}]
    string replace $text $idx $end $replace
}

replaceFirst "I hear Apple makes many popular Apple products." Apple Banana
# => I hear Banana makes many popular Apple products. 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T07:01:26.590

首先，在这里伸出援手`sed`似乎很整洁（由于`sed`'s 的声明性表达），但是多余的并且使您的程序的维护更加困难，因为添加每个“移动部分”会增加复杂性。

基本上，在纯 Tcl 中重新实现代码段所需遵循的步骤是：

1.  打开源文件。
2.  反复调用`gets`文件的通道，逐行读取数据。
3.  在每一行上执行正确构造的调用`regsub`，这将尝试将“Apple”替换为“Banana”。
4.  一旦调用`regsub`返回 1 或更多意味着字符串与您的正则表达式匹配，退出文件读取循环。

实施的其余部分取决于您对数据的处理方式。

其次，即使您选择`sed`从您的 Tcl 脚本执行，您当然也不需要在此处涉及 shell，因为 Tcl 的`exec`命令能够自行处理命令管道和流重定向。

您当前方法的另一个不明显的问题是，将一个脚本 (for `sed`) 内联到另一个脚本 (for shell) 中可能很容易造成逃避噩梦：尝试考虑如果您的源模式或替换模式可能是任意数据会发生什么包含空格字符以及单引号和双引号。

`bash`第三，当你需要调用*shell*时，永远不要调用，除非你真的意味着你*需要*在传递给 shell 的脚本中有一个[bashism](https://www.google.com/search?q=bashism)。在所有其他 99.9% 的情况下，您应该调用`/bin/sh`它，它是标准 shell 的标准路径，它保证为它运行的脚本实现 POSIX shell 语义。这样做的原因是某些系统（特别是 Debian 和至少它的一些衍生产品）已经`/bin/sh`链接到另一个 shell（在 Debian 中是 it's `dash`），该 shell 缺乏交互功能，`bash`但作为交换，它可以更快地启动和运行其脚本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T18:57:38.970

如果要替换文本块中的字符串：

```
set text [string map {Apple Banana} $text] 
```

如果你想更新文件中的字符串，这个`fileutil`包只有票`fileutil::updateInPlace`：：

```
package require fileutil
proc processLine {line} { return [string map {Apple Banana} $line] }
fileutil::updateInPlace file.txt processLine 
```

请注意，该`string map`命令可以一次替换多个字符串：

```
string map {Apple Banana Monkey Ape Coke Pepsi} $text 
```

### 更新

事实证明，字符串映射将替换 Apple 的所有实例，这不是 Ahmed 想要的（感谢 Glenn 指出这一点）。我们应该使用 acheong87 的 regsub 解决方案：

```
package require fileutil
proc processLine {line} { return [regsub -- {Apple} $line "Banana"] }
fileutil::updateInPlace file.txt processLine 
```

# geocoding - 我可以使用 NOKIA \Here API (REST) 来获取 GeoLocations(Lat\Long)，并将地址信息作为输入

> ID：14635164
> 
> 赞同：4
> 
> 时间：2013-01-31T21:06:42.877
> 
> 标签：geocoding, nokia, here-api

我正在编写一个 Geocoder C# 测试应用程序。我可以使用 NOKIA \Here API (REST) 来获取 GeoLocations(Lat\Long)，并将地址信息作为输入。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T10:13:05.730

直到最近，诺基亚才向公众提供免费的 RESTful 地理编码 API（见下文）：

显然，这样的服务确实存在，因为[here.com](http://here.com)使用它，并且各种 API（如 Maps API for JavaScript）能够使用[**nokia.places.search.manager**](http://developer.here.net/docs/maps_js/topics_api_pub/nokia.places.search.manager.html)处理地理编码请求，而后者又必须将 http 调用包装到RESTful 地理编码服务。

对于地理编码，您有三个选项：

*   您可以直接从 Maps API for Javascript 使用地理编码 - 这当然不是 RESTful

[http://developer.here.net/apiexplorer/examples/api-for-js/places-search/search-by-address.html](http://developer.here.net/apiexplorer/examples/api-for-js/places-search/search-by-address.html)

*   您可以通过将地址放入 RESTful Places API 来进行非结构化搜索。这是一个本地搜索 API，并非设计为地理编码器。

[http://demo.places.nlp.nokia.com/places/v1/discover/search?at=37.7851%2C-122.4047&q=10+Downing+Street&app_id=_peU-uCkp-j8ovkzFGNU&app_code=gBoUkAMoxoqIWfxWA5DuMQ&accept=application%2Fjson](http://demo.places.nlp.nokia.com/places/v1/discover/search?at=37.7851%2C-122.4047&q=10+Downing+Street&app_id=_peU-uCkp-j8ovkzFGNU&app_code=gBoUkAMoxoqIWfxWA5DuMQ&accept=application%2Fjson)

*   [您可以直接联系诺基亚（请参阅定价计划页面](http://developer.here.net/web/guest/plans)底部的链接 ）并请求定制套餐，包括访问“适当的”地理编码服务。该服务不是免费的，但会返回更高质量的正确地理编码结果。

# 更新：

As of Sept 2013, use of the RESTful Geocoding API is now **available** to signed in customers - the documentation can be found [here](https://developer.here.com/rest-apis/documentation/geocoder)

# python - python可以集成到HTML、JavaScript...在线吗？

> ID：14635166
> 
> 赞同：0
> 
> 时间：2013-01-31T21:06:47.260
> 
> 标签：python

我有一个想要在线托管的 python 多人游戏。到目前为止，我只看到过使用某种用户下载库（例如 Flash 或 java 运行时虚拟盒）的在线游戏，当然，许多游戏玩家不会安装 python。对于游戏，它是通过库套接字和tcp协议使用多人游戏。我希望有人有一些框架，甚至只是一些可以提供帮助的链接。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:09:40.123

这只是一个想法，因为我对你的游戏一无所知，但你听说过[Django](https://www.djangoproject.com/)吗？它是一个基于 Python 的 Web 框架。

如果您的游戏不能与 Flash、HTML5 或 JavaScript 很好地交互，这可能无法解决您游戏的图形部分。但这将允许您直接在网页框架中引用您的 Python 类和游戏库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:10:06.130

打包你的游戏是一种选择吗？如果是，也许[http://www.tidesdk.org/](http://www.tidesdk.org/)会有所帮助。据我所知，它允许在安装程序中包含 python 运行时。

我还看到了 javascript 中的 python 实现 - [http://www.skulpt.org/](http://www.skulpt.org/)

# python - 使用 python 保存和绘制多个数据集

> ID：14635172
> 
> 赞同：2
> 
> 时间：2013-01-31T21:07:15.073
> 
> 标签：python, arrays, numpy, plot

我又遇到了一个问题 - 我有多个文件，格式如下：

频率 AB

1000 1.2 0.0014

100 1.2 0.00013

10 1.2 0.0012

所有文件都在同一个文件夹中；到目前为止，我能够读取所有文件，进行我想要的计算，然后保存一个包含所有需要数据的大文件（代码见下文）

在我保存我想要的数据之前：

将数据分解为原始文件的数量，使用新数据，并使用与输入名称相同的名称（代码中的N是每个文件的行数，我用它来识别我有多少个文件从总行数中获得）

并且，要在一个图中绘制所有不同的数据（假设我有 3 个像上面这样的文件，我想要一个有 3 行的图，都在同一个图上） - 我似乎无法做到这一点，因为我所有的尝试只给我一行

*** 更新 - 我可以读取数据，并将所有内容放在第一个循环中，然后我可以查看所有数据 - 现在我想自动化保存功能，但代码（见下面的简化版本）只保存一个数据集（可能会覆盖文本文件？）*** UPDATE 2 - 现在可以使用 - 需要在第二个循环中添加保存功能

```
import os
import numpy as np

datadirectory = '/media/data'
os.chdir( datadirectory)

listing = os.listdir(datadirectory) 
my_array=np.zeros(shape=(0,3))

for infile in listing: 
   dataset = open(infile).readlines()
   data = np.genfromtxt(dataset, usecols=(0,1,2))
   my_array = np.vstack((my_array, data))
   lta= my_array 
```

### 此处进行一些处理 - lta 现在有 5 列

```
 Results=np.column_stack((lta[:,0], lta[:,1], lta[:,2], lta[:,3], lta[:,4]))
   for i in listing:
       date = i
       np.savetxt((os.path.join(resultpath, date)) + '.txt', Results, fmt='%s', delimiter='\t') 
   my_array = np.vstack((my_array, Results)) 
```

# 绘制数据 - 在 my_array 数组中我有所有数据，每 N 行（给定数字）我有一个不同的数据集 - 我想在同一个图中绘制所有数据，每 N 行我想更改符号颜色

```
import matplotlib.pylab as plt

plt.figure(figsize=(10,5))
#graph_axes = plt.subplot(N,2,1)
graph = plt.semilogx(my_array[:,0], my_array[:,2])
plt.ylim(0, 25)
plt.xlim(0.1, 1000)
plt.show()
plt.savefig(os.path.join(resultpath, 'image.png')) 
```

任何帮助/指导表示赞赏！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T06:35:28.140

如果您可以提供 中的内容示例会更好`my_array`，但据我了解，此代码可以帮助您实现所需的内容。首先，这是我为伪造数据而编写的代码。

```
import numpy as np
from random import random

# generate fake data
num_files = 5
N = 20
my_array = []
for f in range(num_files):  # simulate multiple files
    for n in range(N):  # simulate multiple samples per file
        # fake data
        my_array.append([10 ** n / N, random() + f, 10 + f + random()])
my_array = np.asarray(my_array) 
```

希望此时 my_array 的内容与您所拥有的内容相似（我只模拟了 3 列而不是处理数据后的 5 列，但这不应该影响下面的绘图代码：

```
import matplotlib.pyplot as plt

# now plot it
for i in range(0, num_files * N, N):
    # plot column-0 vs column-1 in one subplot
    plt.subplot(2, 1, 1)
    plt.semilogx(my_array[i:i + N, 0], my_array[i:i + N, 1])
    plt.hold(True)
    # plot column-0 vs column-2 in another subplot
    plt.subplot(2, 1, 2)
    plt.semilogx(my_array[i:i + N, 0], my_array[i:i + N, 2])
    plt.hold(True)
plt.show() 
```

诀窍是使用`plt.hold(True)`，它将保留之前绘制的任何内容，并为下一个要绘制的数据分配新颜色。如果 N 不是常数，此解决方案也将起作用（但您必须修改循环数据的方式）。

希望有帮助！

# javascript - javascript 对象仅提醒第一个选项

> ID：14635173
> 
> 赞同：0
> 
> 时间：2013-01-31T21:07:22.097
> 
> 标签：javascript, oop, object

您好，我在弄乱 Javascript 中的一个对象。这是我在单独的 .js 文件中的对象。

**json-webservice.js**

```
 //create object
function objdata(tool, product, details) {

    //create object properties
    this.tool = tool;
    this.product = product;
    this.details = details;

    //create object methods
    this.validate = function () {
        var error = 0;
        for (var prop in this) {

            if (this.hasOwnProperty(prop)) {
                if (prop != 'validate' || prop != 'submit') {
                    if (this[prop] == null || this[prop] == undefined || this[prop] == "") {
                        error += 1;
                    }
                }

            }
        }

        return error;
    }

    this.submit = function () {

        var error = this.validate();

        if (error > 0) {
            alert("errors: " + error);
        }
        else {
            alert(this.tool + " " + this.product + " " + this.details);
        }
    }

}

} 
```

我将此脚本包含在我的页面顶部`index-main.html`。

然后文件准备好，然后初始化新对象并提交。

```
$(document).ready(function () {

    var userdata = new objdata('5', 'Main Page', '9');
    userdata.submit();

}); 
```

我的问题是为什么它只会提醒

```
---------------------------
Windows Internet Explorer
---------------------------
5
---------------------------
OK   
--------------------------- 
```

并不是

```
---------------------------
Windows Internet Explorer
---------------------------
5 Main Page 9
---------------------------
OK   
--------------------------- 
```

就像我认为应该的那样。我的对象是否正确编码？我没有在 IE 中报告任何 javascript 错误。

奇怪的部分是我可以复制 json-webservice.js 文件内容（上面的对象）并且它工作得很好。但它不能作为外部文件工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:16:07.393

您需要使用`this[prop]`而不是`this.prop`; 前者查找名称为 in 字符串的属性`prop`，而后者查找名称字面上为“prop”的属性。

（我无法让它重现您的输出。正如所写，它只是警告“错误”，上面的更改导致它提供所需的输出。）

# batch-file - 批处理 - 如何在 for 循环块之外获取变量？

> ID：14635175
> 
> 赞同：1
> 
> 时间：2013-01-31T21:07:29.477
> 
> 标签：batch-file

我有以下属性文件

```
jmx.connector.ip=127.0.0.1
jmx.connector.port=12345 
```

我想读取和解析键值对

```
@ECHO OFF

set FILE=file.properties

REM initialize???
set JMXPORT=0
set JMXHOST=0

REM set their value???
for /F "tokens=1,2 delims==" %%i in (%FILE%) do (
    if "%%i"=="jmx.connector.port" JMXPORT=%%j
    if "%%i"=="jmx.connector.ip" JMXHOST=%%j
)

REM can't use their value
echo %JMXHOST%
echo %JMXPORT% 
```

这行不通。我想在 for 循环中设置值`JMXPORT`并`JMXHOST`在循环外使用它们。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:12:00.853

您`set`在循环中缺少适当的调用。将循环更改为：

```
for /F "tokens=1,2 delims==" %%i in (%FILE%) do (
    if "%%i"=="jmx.connector.port" set JMXPORT=%%j
    if "%%i"=="jmx.connector.ip" set JMXHOST=%%j
) 
```

然后它应该可以工作（至少它在 Windows 7 上对我有用）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:14:14.307

尝试添加`set`到`if`语句中，如下所示：

```
if "%%i"=="jmx.connector.port" set JMXPORT=%%j
if "%%i"=="jmx.connector.ip" set JMXHOST=%%j 
```

如果这不起作用，那么您需要在批处理文件的开头启用延迟扩展并使用`!`而不是`%`您的变量，如下所示：

```
@ECHO OFF

setlocal ENABLEDELAYEDEXPANSION

set FILE=file.properties

REM initialize???
set JMXPORT=0
set JMXHOST=0

REM set their value???
for /F "tokens=1,2 delims==" %%i in (%FILE%) do (
    if "%%i"=="jmx.connector.port" set JMXPORT=%%j
    if "%%i"=="jmx.connector.ip" set JMXHOST=%%j
)

REM can't use their value
echo !JMXHOST!
echo !JMXPORT!

setlocal 
```

# php - PHP 服务器创建一个无法删除的文件

> ID：14635177
> 
> 赞同：0
> 
> 时间：2013-01-31T21:07:34.733
> 
> 标签：php, permissions, unlink

我最初发布了一个非常不同的问题，因为我不知道为什么我不能取消链接（删除）服务器已经创建的文件；我发现了更多信息，因此觉得改写我的问题是合适的。

PHP 脚本通过 fopen 创建一个文件，并为用户提供一个下载链接。下载后，该脚本旨在通过取消链接删除文件。我似乎无法让它工作。我检查了权限，这就是文件和目录的样子：

```
drwxrwxr-x+  55 root        _www    1870 Jan 31 09:49 .
-rw-r--r--    1 _www        _www     1362 Jan 30 12:46 file.csv 
```

这告诉我 _www 组具有目录的读取、写入和执行权限以及文件的读取和写入权限（更不用说 _www 用户拥有该文件！）。当然，_www 是服务器。因此，如果服务器有足够的权限来读取和写入目录并且对它创建和拥有的文件有足够的权限，那么它为什么不删除该文件呢？我在脚本中没有收到任何错误说取消链接失败，但是在运行脚本后文件仍然存在。似乎没有必要，但 _www 是否出于某种原因也需要具有执行权限？我对此表示怀疑。

另外，这里是代码。对我来说似乎很好，但我可能会疯：

```
echo "<form action='' method='post'><input type='submit' name='delete' value='Delete File'></form></div>";
   if (isset($_POST['delete'])) {
        unlink("file.csv") or die("Could not delete file! O, noes!");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:27:00.827

最后的加号告诉我有一些时髦的 Linux ACL 正在进行。

这可能会帮助你 [http://www.softpanorama.info/Commercial_linuxes/linux_acl.shtml](http://www.softpanorama.info/Commercial_linuxes/linux_acl.shtml)

# google-app-engine - 为什么 distinct 在我的查询类的 run 方法中不起作用？

> ID：14635180
> 
> 赞同：1
> 
> 时间：2013-01-31T21:07:38.313
> 
> 标签：google-app-engine, python-2.7

我想根据实体属性获得一组不同的结果。我正在尝试运行以下代码。

```
db.Query(EntityName, projection = ("entityProperty",)).run(distinct=True) 
```

我收到以下错误

```
Unknown configuration option ('distinct') 
```

根据 GAE 文档 distinct 是 run 方法的一部分

[https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_run](https://developers.google.com/appengine/docs/python/datastore/queryclass#Query_run)

知道我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T10:26:54.473

我看不出你的查询有什么问题。

您使用的是 GAE 开发服务器 1.7.4 吗？那个版本应该没问题。

# android - 从活动调用片段方法时出现空指针异常

> ID：14635186
> 
> 赞同：1
> 
> 时间：2013-01-31T21:08:11.063
> 
> 标签：android, nullpointerexception, fragment

我有一个片段活动，它通过以下方式调用其他片段：

```
FragmentView1 f = (FragmentView1) this.getSupportFragmentManager()
                .findFragmentByTag(getFragmentTag(0)); 
```

我的 getFragmentTag() 函数是：

```
private String getFragmentTag(int pos){
    return "android:switcher:"+R.id.viewpager+":"+pos;   //fragmentpageradapter auto generated tag
} 
```

不是问题是每当我调用 f.somemethod 时，我都会得到一个空指针异常。

我试过了

```
Log.w("HELLO1",""+ f.getTag()); 
```

它返回 nullpointerexception 。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:39:00.270

[findFragmentByTag() 正在返回 null，因为它没有按照docs](http://developer.android.com/reference/android/app/FragmentManager.html#findFragmentByTag%28java.lang.String%29)找到具有指定标签的片段。确保您在布局中或在事务时以编程方式设置片段的标签。

有关这方面的更多信息，请参阅[此](https://stackoverflow.com/questions/6374170/how-to-set-a-fragment-tag-by-code)问题。

# javascript - 在 http 站点上设置来自 https 的 cookie

> ID：14635189
> 
> 赞同：1
> 
> 时间：2013-01-31T21:08:21.813
> 
> 标签：javascript, jquery, ajax, asp.net-mvc, cross-domain

我们正在尝试在我们的页面上创建一个 ajax 登录控件。问题是，我们希望它是安全的，所以当您在我们的主页上时，fe **http://page.com**并且您想登录，然后带有您的登录名和密码的 ajax 请求（使用 jquery）正在运行到**https://page.com/sign-in/**操作。

问题是，由于跨域安全性，通常我们不能像这样发送请求。在我们的 singnin 操作中，我们将标头`Access-Control-Allow-Origin`的值指向我们的 http 站点 url，因此它可以发出登录请求。

这很好用，除了一个非常重要的问题：

Https 站点返回一个登录用户面板，我们用它替换登录表单。它还返回一个 cookie（典型的 .net 身份验证 cookie）。cookie 不想停留在我们的页面上 - 我想我们的 http 页面不希望以某种方式接受来自 https 操作的 cookie...

当我们在其他一些 https 站点上并尝试登录时，它工作正常并设置了 cookie。

**我们怎样才能避免这种情况？我们如何允许 https 操作在 http 站点上设置 cookie？**

这仍然是同一个域名，只是协议不同..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T13:12:12.417

正如一些用户所说，事实证明这是一个不安全的解决方案。Quentin 指出，这很容易受到中间人攻击，因此解决方案是将整个页面放在 https 域上，而不是根据内容类型来区分协议。

# python - Numpy - ValueError：无法使用序列设置数组元素

> ID：14635193
> 
> 赞同：0
> 
> 时间：2013-01-31T21:08:42.230
> 
> 标签：python, csv, numpy

因此，我编写了小测试代码来计算文件夹中所有 csv 文件的平均值。

```
parser = argparse.ArgumentParser(description='avg data from csv to csv')
parser.add_argument('--input', required = True)
parser.add_argument('--output', required = True)
args = parser.parse_args()

# Get command arguments
input_files_path = args.input
output = args.output

avg = []
for infile in glob.glob(input_files_path+"*.csv"):
        a = np.loadtxt(infile, delimiter=",")
        mean = np.mean(a, axis=0)
        avg.append((mean))
        print infile
np.savetxt(output,(avg), fmt = "%.1f", delimiter=", ") 
```

但是现在的问题是，当我尝试将文件名也保存在 csv 文件中时，如下所示：

```
parser = argparse.ArgumentParser(description='avg data from csv to csv')
parser.add_argument('--input', required = True)
parser.add_argument('--output', required = True)
args = parser.parse_args()

# Get command arguments
input_files_path = args.input
output = args.output

avg = []
for infile in glob.glob(input_files_path+"*.csv"):
        a = np.loadtxt(infile, delimiter=",")
        mean = np.mean(a, axis=0)
        avg.append((infile,(mean)))
        print infile
np.savetxt(output,(avg), fmt = "%.1f", delimiter=", ") 
```

它抛出一个错误：

```
 np.savetxt(output,(avg), fmt = "%.1f", delimiter=", ")
  File "/usr/lib/python2.7/dist-packages/numpy/lib/npyio.py", line 963, in savetxt
    X = np.asarray(X)
  File "/usr/lib/python2.7/dist-packages/numpy/core/numeric.py", line 235, in asarray
    return array(a, dtype, copy=False, order=order)
ValueError: cannot set an array element with a sequence 
```

我似乎不明白问题是什么。也许是因为我试图将一个字符串附加到一个浮点数？我检查了`fmt`numpy 中的 s .. 但我没有发现任何有趣的东西。

```
/usr/lib/python2.7/dist-packages/numpy/lib/npyio.py:773: UserWarning: loadtxt: Empty input file: "../robalo-31.1/op.csv"
  warnings.warn('loadtxt: Empty input file: "%s"' % fname)
/usr/lib/python2.7/dist-packages/numpy/core/fromnumeric.py:2374: RuntimeWarning: invalid value encountered in double_scalars
  return mean(axis, dtype, out) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:28:22.637

我猜你提供的格式字符有问题`np.savetxt`。（你有一个字符串浮点元组，你是分隔符意味着你只使用浮点数）。我建议`csv`这样做：

```
>>> import csv
>>> import StringIO
>>> g = StringIO.StringIO()
>>> writer = csv.writer(g,delimiter=',')  #this is the part that is applicable
>>> writer.writerows(lst)
>>> g.seek(0)
>>> print g.read()
foo,2
bar,4 
```

所以我猜你的代码可能很简单：

```
with open(output,'wb') as fout:
    writer = csv.writer(fout,delimiter=',') 
    writer.writerows(avg) 
```

代替

```
np.savetxt(output,(avg), fmt = "%.1f", delimiter=", ") 
```

# python - 从联合登录中获取用户名

> ID：14635194
> 
> 赞同：0
> 
> 时间：2013-01-31T21:08:44.823
> 
> 标签：python, google-app-engine, openid

我正在使用 Google App Engine 上的联合登录来让用户登录。

使用联合登录信息； [https://developers.google.com/appengine/articles/openid](https://developers.google.com/appengine/articles/openid)

以及对用户对象的引用； [https://developers.google.com/appengine/docs/python/users/](https://developers.google.com/appengine/docs/python/users/)

我可以让用户登录并对其进行身份验证。我可以得到他们的电子邮件地址和昵称。

唯一的问题是我不知道如何获得他们的真实姓名。当我使用此服务登录时，会提供用户名，stackoverflow 从 openid 登录中获取用户名（至少使用 Google 和 Yahoo）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:30:53.347

它应该取决于 OpenID 提供者，以及它们作为 OpenID 标识符返回的内容。您使用的是哪个 OpenID 提供商？

[关于 User.nickname()：](https://developers.google.com/appengine/docs/python/users/userclass)

> 返回用户的“昵称”，一个可显示的名字。**对于 Google 帐户用户，如果地址与应用程序在同一个域中，则昵称是用户电子邮件地址的“名称”**部分，否则是用户的完整电子邮件地址。**对于 OpenID 用户，昵称是 OpenID 标识符**。

所以默认情况下，它只是他们的 OpenID 标识符。您是否可以通过他们的 OpenID 提供程序检索他们拥有的用户名（如果不是标识符）可能只取决于提供程序。

# javascript - JavaScript 库中组件的大小？

> ID：14635197
> 
> 赞同：0
> 
> 时间：2013-01-31T21:08:52.360
> 
> 标签：javascript

我将我的 JavaScript 组织成模块。

在某些地方，有很多不同的方法可以组织代码以获得一定的大小。

这个问题不是为了产生意见或猜测。

我只想很好地组织我的代码。如果没有最佳大小，是否存在编写良好代码的平均大小？

这是[哥伦比亚大学在](http://dl.acm.org/citation.cfm?id=567176.567181)[此](https://stackoverflow.com/questions/840092/whats-the-optimum-size-for-a-class-file/840102#840102)类似问题上发布的一项研究的链接

> 足够的代码来完成这项工作

是类似问题的最佳答案，但如果您认为鸡蛋先出现，那么 JavaScript 中编写良好的组件（鸡蛋）的平均大小是多少？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:23:45.790

与其根据代码行来考虑大小，我发现根据类或模块中的职责数量来考虑大小是有帮助的。

根据[单一职责原则](http://en.wikipedia.org/wiki/Single_responsibility_principle)，每个模块应该只有一个职责——或者说一个改变的理由，这是[鲍勃大叔](http://en.wikipedia.org/wiki/Robert_Cecil_Martin)推广的另一种方式。以这种方式组织代码的好处是它迫使您分离关注点，这往往使代码更容易维护。

当你从职责的角度考虑你的代码时，关于模块大小的决定就变得更容易了。

# c++ - 我应该在 DirectX 中使用 std::string 还是 Windows 数据类型？

> ID：14635199
> 
> 赞同：4
> 
> 时间：2013-01-31T21:08:59.267
> 
> 标签：c++, windows, string, winapi, directx

我现在一直在做一个基于 DirectX 的项目，我正在努力解决一些问题。尽管 DirectX SDK 严重依赖于 Windows 数据类型，如`LPSTR`, `LPCSTR`, ... 我一直在使用我自己的类`std::string`，这很容易使用，但是混合两种处理字符串的方式看起来很奇怪。虽然这是一个模糊的问题，但您有什么建议 - 我应该使用`string`s 还是使用 Windows 指针来处理不同的字符串类型以保持一致性？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:12:50.077

`LPSTR`只是一个别名`char*`和`LCPSTR`是一个别名`const char*`，所以你的问题实际上听起来像*“我应该使用 C++ 字符串还是 C 字符串？”*

好吧，C++`std::string`有一个名为`c_str()`（或与 STL 兼容的等效`data()`函数）的成员函数，它返回一个（不可修改的）C 字符串。因此，任何时候函数接受一个`LPCTSTR`，您都可以提供`c_str()`作为参数的输出。

`std::string`我建议您尽可能使用 C++ ，它更安全。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:31:55.597

在现代 C++ 代码中，我只会使用一个**健壮的字符串类**，比如`std::string`，或者更好地`std::wstring`用于Windows 的**Unicode** UTF-16 支持。*然后，您可以在 API 边界处*转换为“原始”C 字符串。

要获取*只读的*“原始”C 字符串指针，可以使用`std::[w]string::c_str()`method.

相反，如果要*修改* `std::[w]string`缓冲区，可以先调用`.resize()`方法准备字符串缓冲区，使其足够大；然后您可以使用`&str[0]`这些 API 访问内部缓冲区，而不是写入其中。

请注意，在特定于 Windows 的代码中，ATL`CString`是您可能想要使用的另一个方便的字符串类。它有一些特定于平台的便利设施，比如从资源中加载字符串（这对应用程序本地化很有好处）。

由于`CString`提供了到 的隐式转换`LPCTSTR`，因此您只需将`CString`实例传递给期望原始`LPCTSTR`. 相反，如果需要修改内部`CString`缓冲区，可以使用`GetBuffer()`/`ReleaseBuffer()`方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:22:33.877

基于@Andy Prowl 的回答，您可能希望使用“T”字符串（即`LPTSTR`代替`LPSTR`or `LPWSTR`）对所有内容进行编码。T （真的）的确切类型`TCHAR`是在编译时根据您是否拥有`UNICODE`and来设置的`_UNICODE` `#defined`。这使您与两者兼容。

您仍然可以通过以下方式派生一个`tstring`类来使用这种技术的 C++ 字符串`basic_string<>`：

```
typedef std::basic_string<TCHAR> tstring; 
```

# vba - 如何检查单个值以查看它是否包含 18 个值之一

> ID：14635202
> 
> 赞同：0
> 
> 时间：2013-01-31T21:09:09.953
> 
> 标签：vba, range, lookup

我正在尝试进行反向查找。

有：句子（字符串） 寻找：关键字（数组）

我知道我可以用 if(iser(find("Missing",B1,1)),if(isrr(find("Located",B1,1)),.. 做一个相当疯狂的复合语句。

但是考虑到我需要使用这个 1000 次，并且 if then's 将是 18 深。那是没有意义的。我知道我可以很清楚地用 VBA 做到这一点，但我似乎无法弄清楚语法。

这是我到目前为止所拥有的：

```
Function FindValue(ByRef strToSearch As String, rngLookUpValues As Range) As String
On Err GoTo err_capture
'strToSearch is the sentence I am searching
'rngLookUpValue is a two column Range.
'      The first column is what I'm searching for.  If it exists in the sentence, 
'               return the second column
'      The second column is the category that applies when the word from column one 
'                is found in the sentence

i = 0
For Each row In rngLookUpValues
    i = i + 1
    If InStr(1, strToSearch, row.cell(i, 1).Value, vbTextCompare) > 0 Then
        FindValue = row.cell(i, 2).Value
    End If
Next

Exit Function
err_capture:
    Debug.Print Err.Number & ": " & Err.Description
End Function 
```

当我运行它时，它返回一个#Value。但是当我调试它或观察它运行时，没有错误。它只是在 instr() 函数期间死亡。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:16:33.767

不需要VBA，一个数组公式就可以了：

```
=IFERROR(INDEX($B:$B,MATCH(TRUE,FIND($A:$A,D1)>0,0)),"")

```

其中 column`B`是类别， column`A`是单词列表和`D1`要检查的句子。

注意：用`Ctrl`- `Shift`-输入数组公式`Enter`！

对于 Excel 2003 和您的特定示例，请使用以下公式：

```
=IF(ISERROR(MATCH(TRUE,FIND('Intake Chart'!$A$2:$A$18,E26)>0,0)),"不匹配",
INDEX('摄入量表'!$B$2:$B$18,MATCH(TRUE,FIND('摄入量表'!$A$2:$A$18,E26)>0,0)))

```

看看[这个文件](https://mega.co.nz/#!bNYDGZCT!BPRKgWAfqsnCo3_2W1YRrV9NwtNXzCJx1ywxhCn-aEA)- 它具有完全相同的结构和工作公式。

# ruby-on-rails - Ruby with RailsInstaller，无法在 Windows 上构建 gem 原生扩展

> ID：14635203
> 
> 赞同：4
> 
> 时间：2013-01-31T21:09:10.173
> 
> 标签：ruby-on-rails, ruby, windows, devkit

使用 RailsInstaller 在 Windows 上安装 Ruby + Rails 后，我无法安装构建本机扩展所需的任何 gem。错误：

```
C:\Users\Admin>gem install rdiscount
Building native extensions.  This could take a while...
ERROR:  Error installing rdiscount:
        ERROR: Failed to build gem native extension.

        C:/Rails/Ruby1.9.2/bin/ruby.exe extconf.rb

Gem files will remain installed in C:/Rails/Ruby1.9.2/lib/ruby/gems/1.9.1/gems/r
discount-1.6.8 for inspection.
Results logged to C:/Rails/Ruby1.9.2/lib/ruby/gems/1.9.1/gems/rdiscount-1.6.8/ex
t/gem_make.out 
```

gem_make.out 的内容：

```
C:/Rails/Ruby1.9.2/bin/ruby.exe extconf.rb 
```

我已经浏览了[这个故障排除页面](https://github.com/oneclick/rubyinstaller/wiki/Troubleshooting#wiki-gems_fails_comspec_autorun)，但它没有解决这个错误。Ruby 似乎无法生成子进程，因为当我手动运行 extconf.rb 时，它可以工作。

小路：

```
C:\Rails\DevKit\bin;C:\Rails\DevKit\mingw\bin;C:\Rails\Git\cmd;C:\Rails\Ruby1.9.2\bin;C:\Program Files\AMD APP\bin\x86;C:\Program Files\NVIDIA Corporation\PhysX\Common;%SystemRoot%\system32;%SystemRoot%;%SystemRoot%\System32\Wbem;%SYSTEMROOT%\System32\WindowsPowerShell\v1.0\;C:\Program Files\nodejs\ 
```

我希望有人可以帮助我解决这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-14T04:33:07.470

除非你有真正令人信服的理由在 Windows 上本地运行，否则我会安装[VirtualBox](http://www.virtualbox.org "虚拟盒子")，然后只运行 Ubuntu 或你最喜欢的 Linux 风格来进行 Rails 开发。事情最终会顺利得多。

# algorithm - 如何根据 BST 中的后继节点获取节点的父节点？

> ID：14635205
> 
> 赞同：1
> 
> 时间：2013-01-31T21:09:17.660
> 
> 标签：algorithm, binary-search-tree

在 BST 中，如果每个节点都没有指向其父节点的指针，则相反，有一个指向其后继节点的指针（也有左右子指针）。我们如何设计一种算法来根据后继指针获取其父代？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:26:38.937

对于一个节点`n`，我们可以反复得到后继者`s`，直到我们得到一个那个`s.left == n`。`s`然后是父母。如果没有找到这样的节点，`n`是一个正确的孩子，我们重复获取后继者`s`，从第一个元素开始（通过重复调用很容易得到`e = e.left`）直到我们得到`s.right == n`，然后`s`是父节点。

# rvm - rbenv版本显示在zsh右键提示不刷新

> ID：14635206
> 
> 赞同：3
> 
> 时间：2013-01-31T21:09:19.580
> 
> 标签：rvm, zsh, rbenv, zshrc

我的 .zshrc 中有以下代码：

```
local ruby_version=''
if which rvm-prompt &> /dev/null; then
  ruby_version="$(rvm-prompt i v g)"
else
  if which rbenv &> /dev/null; then
    ruby_version="$(rbenv version | sed -e "s/ (set.*$//")"
  fi
fi 
```

我的 RPS1 提示符中有此代码：

```
RPS1='${PR_GREEN}$(virtualenv_info)%{$reset_color%} ${PR_RED}${ruby_version}%{$reset_color%}' 
```

（为简洁起见，我没有显示设置 PR_ 颜色或确定虚拟环境的代码 - 这两者都有效。）

当创建一个新的 shell（iTerm2 中的新窗口或新选项卡）时，Ruby 信息是正确的。但是，如果我切换到使用不同 Ruby 的项目（由`.ruby-version`文件确定），则右侧提示中显示的 Ruby 信息不会刷新。如果我重新获取我的`.zshrc`文件，则正确提示会刷新。

我是否需要将确定 Ruby 版本的代码包含在函数中？顺便说一句，我`setopt promptsubst`的 .zshrc 中也有。

当我更改目录时，我错过了什么阻止正确提示刷新？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T03:28:53.350

您不应该使用此代码

```
local ruby_version=''
if which rvm-prompt &> /dev/null; then
  ruby_version="$(rvm-prompt i v g)"
else
  if which rbenv &> /dev/null; then
    ruby_version="$(rbenv version | sed -e "s/ (set.*$//")"
  fi
fi 
```

直接在 zshrc 中：切换到另一个项目时不会更新 ruby​​_version 变量。您可以将其更改为

```
function ruby_version()
{
    if which rvm-prompt &> /dev/null; then
      rvm-prompt i v g
    else
      if which rbenv &> /dev/null; then
        rbenv version | sed -e "s/ (set.*$//"
      fi
    fi
} 
```

并将`${ruby_version}`您的提示更改为`$(ruby_version)`. 或者，如果您确定不需要在每个提示符上检查它（它会减慢速度），您可以使用

```
function _update_ruby_version()
{
    typeset -g ruby_version=''
    if which rvm-prompt &> /dev/null; then
      ruby_version="$(rvm-prompt i v g)"
      rvm-prompt i v g
    else
      if which rbenv &> /dev/null; then
        ruby_version="$(rbenv version | sed -e "s/ (set.*$//")"
      fi
    fi
}
chpwd_functions+=(_update_ruby_version) 
```

，它只会在您更改当前目录时更新 ruby​​_version。另请注意，您的代码具有误导性：`local ruby_version=''`直接放入 zshrc 等同于`typeset -g ruby_version=''`或只是简单地`ruby_version=''`定义了全局变量，但没有导出变量。zsh 中没有文件局部变量（除了实际表示函数的自动加载文件）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:59:52.860

使用这个：

```
export ruby_version
if
  which rvm-prompt &> /dev/null
then
  ruby_version='$(rvm-prompt i v g)'
elif
  which rbenv &> /dev/null
then
  ruby_version='$(rbenv version | sed -e "s/ (set.*$//")'
else
  ruby_version=''
fi

RPS1='${PR_GREEN}$(virtualenv_info)%{$reset_color%} ${PR_RED}'"${ruby_version}"'%{$reset_color%}' 
```

这会将`ruby_version`变量代码注入`RPS1`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T01:46:48.270

看起来您需要使用`precmd`每次执行命令时执行的钩子，例如切换文件夹。与您执行此操作的方式不同，它仅在您启动新实例时执行一次。

```
precmd () {

  local ruby_version=''
  if which rvm-prompt &> /dev/null; then
    ruby_version="$(rvm-prompt i v g)"
  else
    if which rbenv &> /dev/null; then
      ruby_version="$(rbenv version | sed -e "s/ (set.*$//")"
    fi
  fi

  #you can use RPROMPT
  RPS1='${PR_GREEN}$(virtualenv_info)%{$reset_color%} ${PR_RED}${ruby_version}%{$reset_color%}'
} 
```

确保不要覆盖此函数，仅当它不是在其他地方创建时才创建它。B 因为它很可能已经在您`.zshrc`或其他 zsh 相关文件中的某处定义，特别是如果您使用诸如*oh-my-zsh 之*类的东西或其他在提示或事物上显示 git（或其他一些版本控制）信息的东西像那样。

[对此事更清楚一些](http://zsh.sourceforge.net/Doc/Release/Functions.html)。

# php - 更改与数据库的连接方式后清空 SESSION

> ID：14635207
> 
> 赞同：0
> 
> 时间：2013-01-31T21:09:23.110
> 
> 标签：php, constructor

我正在创建一个购物车类，它以前在我使用全局 db 变量时工作，但现在在我在构造函数中建立连接后，get 变量变为空。这导致一个空篮子。

```
<?php
require_once 'config.class.php';
class cart
{
        private $db;

        public function __construct()
        {
            $this->db = new db();
            $this->db = $this->db->connect();
        }

            function writeShoppingCart() {
                $cart = $_SESSION['cart'];
                var_dump($cart);
                if (!$cart) {
                    return '<p>You have no items in your shopping cart</p>';
                } else {
                    // Parse the cart session variable
                    $items = explode(',',$cart);
                    $s = (count($items) > 1) ? 's':'';
                    return '<p>You have <a href="index.php?page=cart.php">'.count($items).' item'.$s.' in your shopping cart</a></p>';
                }
            }

            function showCart() {
                $cart = $_SESSION['cart'];
                if ($cart) {
                    $items = explode(',',$cart);
                    $contents = array();
                    foreach ($items as $item) {
                        $contents[$item] = (isset($contents[$item])) ? $contents[$item] + 1 : 1;
                    }
                    $output[] = '<form action="index.php?page=cart.php&action=update" method="post" id="cart">';
                    $output[] = '<table>';
                    foreach ($contents as $id=>$quantity) {
                        if($result = $this->db->prepare('SELECT * FROM book WHERE id = '.$id))
                        {
                            $result->execute();
                            $result->bind_result($id, $title, $author, $price);
                            $result->fetch();

                            $output[] = '<tr>';
                            $output[] = '<td><a href="index.php?page=cart.php?action=delete&id='.$id.'" class="r">Remove</a></td>';
                            $output[] = '<td>'.$title.' by '.$author.'</td>';
                            $output[] = '<td>&pound;'.$price.'</td>';
                            $output[] = '<td><input type="text" name="qty'.$id.'" value="'.$quantity.'" size="3" maxlength="3" /></td>';
                            $output[] = '<td>&pound;'.($price * $quantity).'</td>';
                            $total += $price * $quantity;
                            $output[] = '</tr>';
                        }

                    }
                    $output[] = '</table>';
                    $output[] = '<p>Grand total: <strong>&pound;'.$total.'</strong></p>';
                    $output[] = '<div><button type="submit">Update cart</button></div>';
                    $output[] = '</form>';
                } else {
                    $output[] = '<p>You shopping cart is empty.</p>';
                }
                return implode('',$output);
            }

                function addChart(){
                    $sql = 'SELECT * FROM book ORDER BY id';
                    $result = $this->db->prepare($sql);
                    $output[] = '<ul>';
                    while ($row = $result->fetch())
                    {
                        $output[] = '<li>"'.$row['title'].'" by '.$row['author'].': &pound;'.$row['price'].'<br /><a href="index.php?page=cart.php&action=add&id='.$row['id'].'">Add to cart</a></li>';
                    }
                    $output[] = '</ul>';
                    return implode('',$output);
                }
}
?> 
```

```
<?php
session_start();
require_once('../resources/library/cart.class.php');
$obj_cart = new cart();
// Process actions
$cart = $_SESSION['cart'];
$action = $_GET['action'];
switch ($action) {
    //
    case 'add':
        if ($cart) {
            $cart .= ','.$_GET['id'];
        } else {
            $cart = $_GET['id'];
        }
        break;

    //in this case the foreach searches for product id which we arent deleting, and puts them in the $newcart
    case 'delete':
        if ($cart)
        {
            $items = explode(',',$cart);
            $newcart = '';
            //
            foreach ($items as $item) {
                if ($_GET['id'] != $item) {
                    if ($newcart != '') {
                        $newcart .= ','.$item;
                    } else {
                        $newcart = $item;
                    }
                }
            }
            $cart = $newcart;
        }
        break;
    //
    case 'update':
    if ($cart) {
        $newcart = '';
        foreach ($_POST as $key=>$value) {
            if (stristr($key,'qty')) {
                $id = str_replace('qty','',$key);
                if($newcart != '')
                {
                    $items = explode(',',$newcart);
                }
                else
                {
                    $items =  explode(',',$cart);
                }

                $items = ($newcart != '') ? explode(',',$newcart) : explode(',',$cart);
                $newcart = '';
                //
                foreach ($items as $item) {
                    if ($id != $item) {
                        if ($newcart != '') {
                            $newcart .= ','.$item;
                        } else {
                            $newcart = $item;
                        }
                    }
                }
                for ($i=1;$i<=$value;$i++) {
                    if ($newcart != '') {
                        $newcart .= ','.$id;
                    } else {
                        $newcart = $id;
                    }
                }
            }
        }
    }
    $cart = $newcart;
    break;

}

$_SESSION['cart'] = $cart;
$output[] = '<div id=\'shoppingcart\'>';

$output[] = '<h1>Your Shopping Cart</h1>';

$output[] = $obj_cart->writeShoppingCart();

$output[] = '</div>';

$output[] = '<div id=\'contents\'>';

$output[] = '<h1>Please check quantities...</h1>';

$output[] = $obj_cart->showCart();

$output[] = '<p><a href=\'index.php?page=add.php\'>Back to bookshop...</a></p>';

$output[] = '</div>';

echo implode($output);
?> 
```

```
<?php
class db
{
    public $db = '';

            function connect()
            {
                try
                {
                    $this->db = new mysqli('localhost', 'root', '', 'webgame');
                }
                catch (Exception $e)
                {
                    echo 'cannot connect to database: ',  $e->getMessage(), "\n";
                }

                return $this->db;
            }
}
?> 
```

# asp.net - 如何让 Response.Redirect 指定 rel="nofollow"？

> ID：14635214
> 
> 赞同：2
> 
> 时间：2013-01-31T21:09:42.280
> 
> 标签：asp.net, seo, postback, response.redirect, nofollow

我有一个`asp:LinkButton`触发 a `PostBack`，将一些东西推送到数据库中，然后执行 a`Response.Redirect`将用户发送到下一页。

出于 SEO 的目的，我们不希望蜘蛛跟随链接到下一页。有什么`Response.Redirect`方法可以指定`nofollow`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:21:23.553

蜘蛛没有“跟随”来自该 LinkBut​​tons 的 PostBack。

为什么 ？因为他们需要运行 javascript，然后 javascript 做一些事情，然后发回页面以及蜘蛛所遵循的所有内容。他们不这样做，他们只遵循指向其他页面的明确链接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:20:21.857

`Response.Redirect`不处理`nofollow`，因为那发生在服务器端。

要获得与 no follow 类似的行为，您必须插入一个“中间人”页面，该页面是一个链接`nofollow`并包含告诉中间页面重定向到哪个页面的信息。这是尝试收集外部站点链接信息或拦截链接以添加附属代码等时使用的常见做法。

例如，中间人页面的链接：

```
<a href="redirect.aspx?url=www.google.com" rel="nofollow">Your Link</a> 
```

然后在您的重定向页面中，您只需`www.google.com`从查询字符串中选择并执行任何跟踪或您需要的任何操作，然后`Response.Redirect`访问提供的 url。

编辑：我完全错过了您使用`LinkButton`. Aristos 是正确的，因为蜘蛛不会执行 javascript 来执行`PostBack`.

[http://www.keyrelevance.com/articles/search-engine-listings.htm](http://www.keyrelevance.com/articles/search-engine-listings.htm)

> JavaScript 是一种很棒的技术，但它对所有搜索引擎都是不可见的。如果您使用 JavaScript 来控制网站的导航，蜘蛛可能会在抓取您的网站时遇到严重问题。

但谷歌在这方面不断进步，所以你永远不知道：

[http://www.youtube.com/watch?v=8yTn_HLDaJs&feature=player_embedded](http://www.youtube.com/watch?v=8yTn_HLDaJs&feature=player_embedded)

没有具体的标准说他们将来不能这样做，但这并不容易/不太可能。如果您真的很担心，请实施类似于我发布的解决方案的方法。

# asp.net-mvc - 如何让 Knockout 将选择框的值绑定到列表项的属性

> ID：14635216
> 
> 赞同：3
> 
> 时间：2013-01-31T21:09:49.017
> 
> 标签：asp.net-mvc, knockout.js, ko.observablearray

如何让 Knockout 将选择框的值绑定到列表项的属性？

我对 MyViewModel 的 IEnermerable 有一个 ASP.NET MVC 强类型视图，MyViewModel 定义为

```
public class MyViewModel{
    public int Id {get;set;}
    public string Name {get;set;}
    public int Status{get;set;}
} 
```

我正在使用、尝试使用、敲除数据来绑定 MyViewModel 的集合，以便用户可以使用下拉菜单更改状态。我的视图 js 看起来像：

```
$(document).ready(function () {
    ko.applyBindings(new ViewModel());
});

var statusItems = [
        { id: 0, name: 'New' },
        { id: 1, name: 'Improved' },
        { id: 2, name: 'Bad' }
];

function ViewModel() {
    var self = this;

    self.Items = ko.observableArray(@Html.Raw(Json.Encode(Model)));

    self.statuses = statusItems;

    self.remove = function () {
        if (confirm('Are you sure you want to remove the entry?\nThis operation cannot be undone.')) {
            self.Items.remove(this);
        }
    }
} 
```

我的标记是

```
<div id="dashboard-div">
    @using (Ajax.BeginForm("Save", "Dashboard", new AjaxOptions { HttpMethod = "Post" }, new { id = "dashboardForm" }))
    {
    <table>
        <thead>
            <tr>
                <th>Name</th>
                <th>Status</th>
            </tr>
        </thead>
        <tbody data-bind="foreach: Items">
            <tr>
                <td><span data-bind="text: Name" /><input type="hidden" data-bind="value: Id, attr: { name: '['+$index()+'].Id'}" /></td>
                <td>
                    <select id="status-dropdown" data-bind="options: $parent.statuses, optionsText: 'name', optionsValue: 'id', value: Status" />
                </td>
            </tr>
        </tbody>
    </table>
    </div>
    <button data-bind="enable: Items().length > 0" type="submit">Save</button>
    }
</div> 
```

我遇到的问题是下拉值未绑定到状态。在初始页面加载时，下拉值已正确设置。即，如果它在数据库中为 1，则将选择“改进”，但是当我进入控制器中的 Save 方法时，每个项目 (MyViewModel) 的状态为 0。如果我将状态属性更改为键入字符串，一切都会再次工作，直到你到达所有状态值都为空的控制器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T21:22:34.030

布伦特 说：

我一问就知道我会弄清楚我的问题。我需要将属性名称添加到选择中，以便模型绑定起作用。

只需在此处添加此内容，以便其他人更快地找到他的解决方案...

# c# - 启动组合问题

> ID：14635224
> 
> 赞同：0
> 
> 时间：2013-01-31T21:10:17.477
> 
> 标签：c#, wpf, mvvm, mef, constructor-injection

我有一个`View`：

```
internal partial class StartWindow : Window
{
    public StartWindow()
    {
        InitializeComponent();
    }

    [ImportingConstructor]
    public StartWindow(IStartWindowViewModel viewModel)
        :this()
    {
        ViewModel = viewModel;
    }

    public IStartWindowViewModel ViewModel { get; private set; }
} 
```

和一个适当的`ViewModel`：

```
 [Export]
    internal class StartWindowViewModel : IStartWindowViewModel
    {
        public IEnumerable<Customer> Customers { get; set; }
    } 
```

**UPD**（基于@Blachshma 回答）：我无法使用代码将 StartWindow 视图注入我的应用程序：

```
public class App
{
     [ImportingConstructor]
     public App(StartWindow window)
     {
          // Do whatever you need
     } 
```

因为 App.g.cs 需要无参数构造函数：

```
internal partial class App : System.Windows.Application {

        /// <summary>
        /// Application Entry Point.
        /// </summary>
        [System.STAThreadAttribute()]
        [System.Diagnostics.DebuggerNonUserCodeAttribute()]
        [System.CodeDom.Compiler.GeneratedCodeAttribute("PresentationBuildTasks", "4.0.0.0")]
        public static void Main() {
            TransparentNotification.App app = new TransparentNotification.App();
            app.Run();
        }
    } 
```

现在，我想在`app.cs`我的`view`via中实例化`constructor injection`。我该怎么做？

此外，我的`m looking for best practices for`MEF `/`MVVM 解决方案（一些示例代码将是一个好主意）。

ps .NET 4.5

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:18:45.443

如果要使用 MEF 获取视图的实例，首先需要导出视图。因此，将`[Export]`属性添加到您的 StartWindow 类：

```
[Export]
partial class StartWindow : Window
{
  ... 
```

现在，在你的`App`类中使用 ImportingConstrutor 来获取实例：

```
public class App
{
     [ImportingConstructor]
     public App(StartWindow window)
     {
          // Do whatever you need
     } 
```

关于 MVVM 的好文章，我推荐[Josh Smith 的博客](http://joshsmithonwpf.wordpress.com/advanced-mvvm/)

# git - 如何在 git 历史记录中搜索对文件夹中文件的引用并清除没有的文件？

> ID：14635228
> 
> 赞同：2
> 
> 时间：2013-01-31T21:10:40.580
> 
> 标签：git

我们有一个存储库，将其中的一些静态媒体文件保存在存储库之外，我们的一名初级人员负责将使用过的文件移动到存储库中，以便我们可以进行静态文件处理。问题是他不是很勤奋，把整个文件夹放到了 repo 中，而不是挑选我们需要的文件。

我们如何搜索对媒体文件的引用，显示历史中没有引用的文件列表并将它们从 repo 中完全清除？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:25:46.397

> “他们不是很久以前添加的”

一种解决方案是：

*   将分支重置到文件“转储”之前
*   仅添加正确的文件（并提交）
*   挑选转储后最近的提交

# ruby-on-rails - Rails 安装 Ubuntu 12.04 期间出错

> ID：14635232
> 
> 赞同：7
> 
> 时间：2013-01-31T21:11:09.233
> 
> 标签：ruby-on-rails, gem, rvm, ubuntu-12.04

我正在 Ubuntu 机器上安装 rails，到目前为止，阅读以下教程没有问题：

[https://www.digitalocean.com/community/articles/how-to-install-ruby-on-rails-on-ubuntu-12-04-lts-precise-pangolin-with-rvm](https://www.digitalocean.com/community/articles/how-to-install-ruby-on-rails-on-ubuntu-12-04-lts-precise-pangolin-with-rvm) [http://pragashblog.blogspot .com/2012/05/setting-up-rvm-ruby-and-rails-on-ubuntu.html](http://pragashblog.blogspot.com/2012/05/setting-up-rvm-ruby-and-rails-on-ubuntu.html)

但是，当我尝试安装导轨时：

宝石安装导轨

我收到以下错误：

```
Building native extensions.  This could take a while...
ERROR:  Error installing rails:
ERROR: Failed to build gem native extension.

    /usr/local/rvm/rubies/ruby-1.9.3-p374/bin/ruby extconf.rb
creating Makefile

make
compiling generator.c
make: I.: Command not found
make: [generator.o] Error 127 (ignored)
linking shared-object json/ext/generator.so
make: shared: Command not found
make: [generator.so] Error 127 (ignored)

make install
compiling generator.c
make: I.: Command not found
make: [generator.o] Error 127 (ignored)
linking shared-object json/ext/generator.so
make: shared: Command not found
make: [generator.so] Error 127 (ignored)
 /usr/bin/install -c -m 0755 generator.so /usr/local/rvm/gems/ruby-1.9.3-p374/gems/json-    1.7.6/lib/json/ext
/usr/bin/install: cannot stat `generator.so': No such file or directory
make: *** [/usr/local/rvm/gems/ruby-1.9.3-p374/gems/json-1.7.6/lib/json/ext/generator.so] Error 1

Gem files will remain installed in /usr/local/rvm/gems/ruby-1.9.3-p374/gems/json-1.7.6 for inspection.
 Results logged to /usr/local/rvm/gems/ruby-1.9.3-p374/gems/json-1.7.6/ext/json/ext/generator/gem_make.out 
```

显然，我已经检查过 make 是否可用，并且它在 PATH 上。实际上，**which make**和 which **which rvm**给出以下结果： /usr/bin/make /usr/local/rvm/bin/rvm

所以......我认为它与PATH无关。

有任何想法吗？？我应该怎么办？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T23:55:48.620

您缺少必需的软件包：

```
rvm get head
rvm requirements run
rvm remove 1.9.3
rvm use 1.9.3 --install --default
gem install rails 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T22:48:08.307

我有同样的问题......在“sudo apt-get install build-essentials”为我修复它之后运行“rvm reinstall 1.9.3”。我想也许当我安装 gcc 时 ruby​​ 没有注意到，并且仍然相信我没有它。

# javascript - 使用 Google Apps 脚本复制数据

> ID：14635234
> 
> 赞同：0
> 
> 时间：2013-01-31T21:11:18.053
> 
> 标签：javascript, google-apps-script

我正在尝试在 Google Apps Script 中编写一个脚本，该脚本从一张表中获取单元格信息并将其复制到另一张表中，既用于抓取某些列以显示在第二张表上，也用于基于某个单元格内的值的条件柱子。这是我到目前为止所拥有的：

```
function onMyEdit() {
  var myMaster    = SpreadsheetApp.openById("xxxxx");
  var masterSheet = myMaster.setActiveSheet(myMaster.getSheets()[0]);
  var myNames     = SpreadsheetApp.openById("xxxxx");
  var namesSheet  = myNames.setActiveSheet(myNames.getSheets()[0]);
  var row1        = masterSheet.getRange(1, 1, masterSheet.getLastRow(), 1);
  var rowV        = row1.getValues();
  var firstArray  = masterSheet.getDataRange().getValues();
  var dataList    = [];
  for (var i = 1; i < rowV.length; i++) {
    dataList.push(firstArray[i][0]);
    dataList.push(firstArray[i][1]);
    dataList.push(firstArray[i][2]);
    dataList.push(firstArray[i][3]);

  }
  for (var j = 0; j < rowV.length - 1; j++) {
    namesSheet.getRange(2, j + 1, 1, 1).setValue(dataList[j]);
  }
} 
```

因此，到目前为止，它仅适用于从第二行开始的一行（以允许列标题）。而且我想当我想根据单元格数据有条件地抓取行时，我将在“for”循环内对条件使用“if”语句，但我希望数据复制到两个工作表中的下一个可用行。我想我会使用类似的东西：' getLastRow + 1 '或类似的东西。由于数据量及其用途，我需要此代码尽可能高效。我对编程很陌生，所以请详细解释一下，再次感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T13:27:15.547

我不确定我是否完全理解您想要做的事情，但是-据我所知-此代码片段应该为您提供更好的开始...

（我在代码本身中添加了一些注释来解释）

```
function onMyEdit() {
  var myMaster    = SpreadsheetApp.openById("MasterSheet ID");
  var masterSheet = myMaster.getSheets()[0]; // get 1rst sheet
  var myNames     = SpreadsheetApp.openById("NamesSheet ID");
  var namesSheet  = myNames.getSheets()[0]; // get 1rst sheet
  var firstArray  = masterSheet.getDataRange().getValues();
  var dataList    = [];
  for ( r = 1; r < firstArray.length; r++) { // iterate the first col of masterSheet
      if(firstArray[r][0]=='some condition'){ // if value in the first column == 'some condition get the second column cell in the new array (here you could change what you want to get)
        dataList.push([firstArray[r][1]])
  }
  }
  Logger.log(dataList)
  if(dataList.length>0){
namesSheet.getRange(1,namesSheet.getLastColumn()+1,dataList.length,1).setValues(dataList);//copy data in a column after last col
}
} 
```

# nuget-package - 如何对 SymbolSource Server Basic 进行故障排除

> ID：14635243
> 
> 赞同：5
> 
> 时间：2013-01-31T21:12:14.337
> 
> 标签：nuget-package, debug-symbols, nuget-server, symbol-server

我按照[此博客条目](http://www.xavierdecoster.com/setting-up-your-own-symbolsource-server-step-by-step)中的说明安装并运行了[SymbolSource Server Basic](http://www.symbolsource.org/Public/Blog/View/2012-03-13/Releasing_the_community_edition_of_SymbolSource)。

我可以成功地将包（*.nupkg 和 *.symbols.nupkg）从 TeamCity 推送到我的服务器而没有错误。然而，虽然 NuGet 端在 Visual Studio 中运行良好，但符号服务器却无法运行。我发现我本地网站的 Data 文件夹包含我推送的标准 NuGet 包，但没有任何源代码的迹象。

我应该在哪里查找错误消息，或者我如何才能知道为什么我的 *.symbols.nupkg 似乎没有被正确推送到服务器？

# sql - 我是否需要 SQL Server 数据库项目中的链接服务器的数据库引用？

> ID：14635244
> 
> 赞同：13
> 
> 时间：2013-01-31T21:12:19.887
> 
> 标签：sql, sql-server, visual-studio, visual-studio-2012, sql-server-data-tools

在我的数据库项目中，我添加了对链接服务器的引用。当我在视图中使用此链接服务器并尝试构建我的数据库项目时，SSDT 报告错误，因为它无法理解对链接服务器上引用的任何架构的引用：

```
[LinkedServer].[DB1].[dbo].[Table1] 
```

以上将返回 SSDT 无法破译对`[DB1].[dbo].[Table1]`. 我尝试添加对此数据库的引用，但 SSDT 需要`.dacpac`文件（由另一个数据库项目生成）或与我项目中的数据库位于同一服务器上的系统数据库。

如何处理引用外部数据库？在某些用例中，项目需要引用**不是**SSDT 数据库项目的远程数据库。就我而言，我正在访问另一家公司的数据库，并将该数据库置于版本控制之下，因为 SSDT 项目是不可能的。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-04-05T03:12:38.937

为远程数据库创建一个新的 SQL 项目，在项目中放置您需要引用的任何对象（不必是整个数据库），然后将该项目作为数据库引用添加到您的项目中。您不必部署远程数据库，只需定义您使用的对象，以便可以引用它们。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-05T15:35:43.157

我们最终确定的选项是使用 SSIS 导入数据。这样，远程数据的传输就发生在 ETL 层中。我们的数据库没有以这种方式引用任何远程数据库，这也可以提高性能（消除网络传输、跨服务器连接等）。

我建议使用 SSIS 或类似方法将您的数据 ETL 到您的数据库项目可以引用的本地表中（无需外部项目引用）。

# python - Python用反斜杠替换正斜杠

> ID：14635248
> 
> 赞同：6
> 
> 时间：2013-01-31T21:12:35.800
> 
> 标签：python, regex

我有

```
foo = '/DIR/abc' 
```

我想把它转换成

```
bar = '\\MYDIR\data\abc' 
```

所以，这就是我在 Python 中所做的：

```
>>> foo = '/DIR/abc'
>>> bar = foo.replace(r'/DIR/',r'\\MYDIR\data\')
  File "<stdin>", line 1
    bar = foo.replace(r'/DIR/',r'\\MYDIR\data\')
                                                 ^
SyntaxError: EOL while scanning string literal 
```

但是，如果我尝试通过输入来逃避最后一个反斜杠`bar = foo.replace(r'/DIR/',r'\\MYDIR\data\\')`，那么我会得到这个怪物：

```
>>> bar2
'\\\\MYDIR\\data\\\\abc' 
```

帮助！这让我发疯。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T21:16:33.280

第二个参数应该是一个字符串，而不是一个正则表达式模式：

```
foo.replace(r'/DIR/', '\\\\MYDIR\\data\\') 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T21:22:00.650

您遇到这种情况的原因是由于`r""`语法的行为，从[Python 文档中获取一些解释](http://docs.python.org/2/reference/lexical_analysis.html#string-literals)

> r"\"" 是由两个字符组成的有效字符串文字：反斜杠和双引号；r"\" 不是有效的字符串文字（即使原始字符串也不能以奇数个反斜杠结尾）。具体来说，a原始字符串不能以单个反斜杠结尾（因为反斜杠会转义后面的引号字符）。

因此，您需要对最后一个参数使用普通的转义字符串。

```
>>> foo = "/DIR/abc"
>>> print foo.replace(r"/DIR/", "\\\\MYDIR\\data\\")
\\MYDIR\data\abc 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2017-06-13T14:55:15.633

我只是`r`在前面放了一个`/`来更改正斜杠。

```
inv_num = line.replace(r'/', '-') 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T21:23:49.197

两个问题：

1.  原始文字根本不能以单个反斜杠结尾，因为它被解释为转义引号字符。因此，使用带有转义符的常规（非原始）文字：`'\\\\MYDIR\\data\\'`。
2.  显示时（使用`repr`样式），字符串将出现转义。因此，`'\\\\'`只有两个实际的反斜杠。所以，`'\\\\MYDIR\\data\\\\abc'`真的`\\MYDIR\data\\abc`。

# matlab - Matlab和积分计算

> ID：14635252
> 
> 赞同：-2
> 
> 时间：2013-01-31T21:12:54.820
> 
> 标签：matlab, integral

有人可以帮助我并告诉我有什么问题吗？我必须计算一些积分，并且不断收到此错误。

例子：

```
quad('(x.^3)*(sqr.((x.^4)+1))',1,8)

??? Error using ==> inline.subsref at 14
Not enough inputs to inline function.

Error in ==> quad at 77
y = f(x, varargin{:}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:21:49.467

你的功能是错误的：

```
(x.^3)*(sqr.((x.^4)+1)) 
```

不是一个合法的功能。sqr 未定义，如果 x 是向量，则不能 *。你的意思是用 sqrt 代替 sqr 吗？要修复 *，只需使用 .*（逐个元素相乘），但您已经知道了。

它应该是：

```
(x.^3).*(sqrt((x.^4)+1)) 
```

您可以将代码更改为：

```
quad(@(x)((x.^3).*(sqrt((x.^4)+1))),1,8) 
```

或者

```
quad('((x.^3).*(sqrt((x.^4)+1)))',1,8) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:28:45.327

您必须先定义函数：

```
f = inline ('(x.^3).*(sqrt.((x.^4)+1))'); % define function f(x) = (x^3)*(sqrt(x^4 + 1))
q = quad(f, 1, 8);  %evaluate integral 
```

然后你可以用 q 绘制或做任何你想做的事情。

干杯!

# python - SQLAlchemy 最新项目

> ID：14635254
> 
> 赞同：0
> 
> 时间：2013-01-31T21:13:02.033
> 
> 标签：python, sqlalchemy

这应该很简单，但我似乎无法弄清楚。

这是我的桌子：

```
class UserEvent(Base):
    __tablename__ = 'user_events'

    user_id = Column(Integer, ForeignKey('users.user_id'),
                            primary_key=True, nullable=False)
    event_time = Column(DateTime, primary_key=True, nullable=False)
    detect_time = Column(DateTime, nullable=False)
    new_state = Column(Boolean, nullable=False) 
```

这是一些示例数据：

```
+---------+---------------------+---------------------+-----------+
| user_id | event_time          | detect_time         | new_state |
+---------+---------------------+---------------------+-----------+
|       1 | 2012-11-12 16:12:00 | 2013-01-31 20:55:31 |         1 |
|       1 | 2012-11-12 18:24:00 | 2013-01-31 20:55:33 |         0 |
+---------+---------------------+---------------------+-----------+ 
```

我想为每个 user_id 找到最新的（event_time）UserEvent。

我试过这个：

```
for event, current in session.query(
        UserEvent, func.max(UserEvent.event_time)).group_by(
            UserEvent.user_id): 
```

查询返回正确的“事件”（2012-11-12 18:24:00）。但是，它是不正确的（或某些东西），因为“当前”是 True。

无论表中有多少行，我总是取回最近的 event_time 和 OLDEST new_state。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:39:32.957

你在使用 MySQL 吗？该特定表达式将生成查询：

```
SELECT
    user_events.user_id,
    user_events.event_time,
    user_events.detect_time,
    user_events.new_state,
    max(user_events.event_time)
FROM
    user_events
GROUP BY
    user_events.user_id 
```

这在大多数数据库上是无效的，但会给你一个随机的 MySQL 行。[您可以从http://news.ycombinator.com/item?id=5122798](http://news.ycombinator.com/item?id=5122798)（巧合的是，由 SQLAlchemy 的作者编写）了解更多关于该行为的信息

这个表达式可以工作：

```
for user_id, current in session.query(
    UserEvent.user_id, func.max(UserEvent.event_time)).group_by(
        UserEvent.user_id): 
```

虽然它返回`user_id`而不是`UserEvent`.

像这样的东西可能会给你想要的东西：

```
t = session.query(
    UserEvent.user_id,
    func.max(UserEvent.event_time).label('max_time'),
).group_by(
    UserEvent.user_id,
).subquery().alias('t')

query = session.query(
    UserEvent,
).filter(and_(
    UserEvent.user_id == t.c.user_id,
    UserEvent.event_time == t.c.max_time,
)) 
```

# html - 如何设置第二个div的高度占用剩余空间？

> ID：14635269
> 
> 赞同：0
> 
> 时间：2013-01-31T21:14:13.417
> 
> 标签：html, css

我在以下代码中有两个面板。第一个应该是固定大小（或自动），但第二个应该获得剩余的可用空间。

所以这就是我设置的原因，`height:100%;`但它仍然无法正常工作。

```
<html style="height:100%;">
    <body style="height:100%;">
        <div style="background-color:green;">a
        </div>
        <div style="background-color:gray; height:100%;">d
        </div>
    </body>
</html> 
```

在视图的其余部分显示第二个面板我缺少什么。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:23:04.793

我个人喜欢使用位置：绝对。

```
<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>JS Bin</title>
</head>
<body>
<style>  
  html,body {
    width:100%;
    height:100%;
  }

  #Green {
    position:absolute;
    top:0;
    left:0;
    right:0;
    height:30px;
    background-color:green;
  }

  #Gray {
    background-color:gray;
    position:absolute;
    top:30px;
    left:0;
    right:0;
    bottom:0;
  }
</style>
<body>
  <div id="Green">a</div>
  <div id="Gray">d</div>
</body>
</html> 
```

这将强制继承尊重前 30px 的 div 的全长。

# c - 是否可以在现有音频流的末尾添加音频？

> ID：14635273
> 
> 赞同：2
> 
> 时间：2013-01-31T21:14:18.243
> 
> 标签：c, ffmpeg, audio-recording, libavcodec, libavformat

我设法用 libavformat 实现了我的解码和编码音频类。我可以创建和阅读 mp3、ogg、...

现在，我想添加一个功能来“在现有音频文件的末尾录制”。即：将一些新帧（音频数据）添加到现有流的末尾。（我的文件只是带有 1 且只有流的音频文件）。

总而言之，我尝试了这个但没有成功：

```
av_register_all(); 
avformat_open_input(&AVFormatContext , filename, NULL, NULL) 
avformat_find_stream_info(AVFormatContext , NULL) 
audio_stream_idx = av_find_best_stream(AVFormatContext , AVMEDIA_TYPE_AUDIO, -1, -1, NULL, 0); 
AVStream = AVFormatContext ->streams[audio_stream_idx_]; 
AVCodec = avcodec_find_encoder(AVStream->codec->codec_id); 
avcodec_open2(AVStream->codec, AVCodec, NULL); 
AVFrame = avcodec_alloc_frame(); 

... 

loop 
{    avcodec_encode_audio2(AVStream->codec, &AVPacket, AVFrame, &got_packet_); 
     av_write_frame(AVFormatContext, &AVPacket); 
} 

... 
```

它在第一个 av_write_frame 上崩溃。

我看到 3 个可能的原因，但我不知道该怎么做：

*   输入和输出文件是一样的。我应该如何初始化我的 AVFormatContext 和 AVOutputFormat ？

    avformat_alloc_output_context2(&AVFormatContext , NULL, NULL, 文件名); AVOutputFormat = AVFormatContext ->oformat; avformat_open_input(&AVFormatContext , 文件名, NULL, NULL)

*   当我得到我的 AVStream 时，我必须寻求它的结束吗？如何 ？

*   我必须使用 avio_open(&AVFormatContext->pb, filename, AVIO_FLAG_WRITE); ?

提前致谢。我在样本中一无所获，但如果你有一些样本或想法...... :)

# node.js - Node.js 和本机 MongoDB 连接失败

> ID：14635274
> 
> 赞同：1
> 
> 时间：2013-01-31T21:14:19.513
> 
> 标签：node.js, mongodb

我正在尝试在我的 app.js 节点应用程序中设置一个简单的 mongodb 测试服务器，但我不断收到“TypeError：无法读取未定义的属性 'arbiterOnly'”。我在本地主机上运行它，我已经通过在我正在制作应用程序的文件夹中运行 npm install mongodb 安装了 mongo db。任何帮助我做错了什么都会非常感谢

这是我的应用程序代码

```
var express = require('express')
  , routes = require('./routes')
  , user = require('./routes/user')
  , http = require('http')
  , path = require('path');
  var Db = require('mongodb').Db;
var Server = require('mongodb').Server;
var client = new Db('test', new Server('localhost:', 3100, {}));

var insertData = function(err, collection) {
    collection.insert({name: "Kristiono Setyadi"});
    collection.insert({name: "Meghan Gill"});
    collection.insert({name: "Spiderman"});
    // you can add as many object as you want into the database
}

var removeData = function(err, collection) {
    collection.remove({name: "Spiderman"});
}

var updateData = function(err, collection) {
    collection.update({name: "Kristiono Setyadi"}, {name: "Kristiono Setyadi", sex: "Male"});
}

var listAllData = function(err, collection) {
    collection.find().toArray(function(err, results) {
        console.log(results);
    });
}

var app = express();

app.configure(function(){
  app.set('port', process.env.PORT || 3000);
  app.set('views', __dirname + '/views');
  app.set('view engine', 'jade');
  app.use(express.favicon());
  app.use(express.logger('dev'));
  app.use(express.bodyParser());
  app.use(express.methodOverride());
  app.use(express.cookieParser('your secret here'));
  app.use(express.session());
  app.use(app.router);
  app.use(express.static(path.join(__dirname, 'public')));
});

client.open(function(err, pClient) {
    client.collection('test_insert', insertData);
  //  client.collection('test_insert', removeData);
    // etc.
});

var people = [{name:'Keth',age:'33',email:'ktater@gmail.com'},
{name:'Donny',age:'20',email:'donjuan86@hotmail.com'},
{name:'Loran',age:'26',email:'geegeenat@facebook.com'},
{name:'Max',age:'18',email:'axxanan@gmail.com'}];

app.configure('development', function(){
  app.use(express.errorHandler());
});

app.get('/', routes.index);
app.get('/users', user.list);
app.get('/people', function(req, res){
  res.render('peeps', {people:people});
});

app.get('/people/:id', function(req, res){
var guy;
  for (var i =0 ; i < people.length ; i++)
  {
    if(people[i].name == req.params.id)
      guy = people[i];

  }
  res.render('viewPerson', {guy:guy});
});

http.createServer(app).listen(app.get('port'), function(){
  console.log("Express server listening on port " + app.get('port'));
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:26:03.317

我的第一个猜测是连接没有打开。尝试在 client.open 函数中`err`登录。`console.log`此外，您从中获取测试代码的帖子大约有 18 个月的历史，代码可能已过时。

# c# - 两台分辨率不同的显示器上的 Windows 8 应用 XNA

> ID：14635279
> 
> 赞同：1
> 
> 时间：2013-01-31T21:14:32.923
> 
> 标签：c#, windows-8, xna, monogame

我正在使用 Monogame 为 Windows 8 应用商店编写 XNA 游戏。我还在使用连接到外接显示器的笔记本电脑。自然，我的外接显示器的分辨率比我笔记本电脑的屏幕高得多。当我将应用程序从一个屏幕拖到另一个屏幕时，视口上的分辨率会发生变化。

在我的构造函数中，我正在使用

```
 _graphics = new GraphicsDeviceManager(this);
 _graphics.PreferredBackBufferHeight = 768;
 _graphics.PreferredBackBufferWidth = 1366; 
```

设置我的视口分辨率。当应用程序在任一监视器上运行时，这使得应用程序可以正常工作，但是将应用程序从一个监视器拖到另一个监视器会更改 GraphicsDeviceManager 上的分辨率。有没有办法阻止这种变化？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-01-06T20:13:36.900

我得到与原始海报相同的东西，但使用 XNA，而不是 MonoGame。当我在两个监视器之间拖动窗口时，分辨率会发生变化，但不会（当然）触发 ClientSizeChanged 事件。上面使用 SizeChanged 事件的建议很有帮助，但文档说仅适用于 Windows8。

我似乎通过处理 Window.ScreenDeviceNameChanged 事件来修复它——我将它连接到与 ClientSizeChanged 相同的处理程序。

我会将此作为对原始帖子的评论，但我没有足够的“声誉”点让系统让我这样做。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:35:20.290

所以我想通了

首先我写了一个方法来检查图形设备上的端口分辨率是否改变了

```
 private bool hasResolutionChanegd()
    {
        if ((GraphicsDevice.Viewport.Width != ScreenManager.Instance.ScreenWidth) || (GraphicsDevice.Viewport.Height != ScreenManager.Instance.ScreenHeight))
        {
            return true;
        }
        else
        {
           return false;
        }

    } 
```

我在每次更新时调用此方法

```
if (hasResolutionChanegd())
        {
             Debug.WriteLine("Resolution Change new width= " + GraphicsDevice.Viewport.Width +" new height="+ GraphicsDevice.Viewport.Height);

            _graphics.PreferredBackBufferHeight = 768;
            _graphics.PreferredBackBufferWidth = 1366;
            _graphics.ApplyChanges();
        } 
```

这样，每当图形设备管理器上的分辨率发生变化时（当用户将应用程序从一个屏幕环境拖到另一个屏幕环境时），就会强制执行首选分辨率。

# javascript - 将 $.when() / $.promise() 与内部具有 AJAX 的函数一起使用

> ID：14635283
> 
> 赞同：4
> 
> 时间：2013-01-31T21:15:01.887
> 
> 标签：javascript, ajax, jquery, jquery-deferred

这个问题真的很难解决，我知道`$.when()`可以像这样使用（使用多个 AJAX 语句）来向你保证它们都完成了。

[http://jsfiddle.net/M93MQ/](http://jsfiddle.net/M93MQ/)

```
 $.when(
        $.ajax({ url: '/echo/html/', success: function(data) {
            alert('request 1 complete')
          }
        }),

        $.ajax({ url: '/echo/html/', success: function(data) {
            alert('request 2 complete')
          }
        })
    ).then( function () { alert('all complete'); }); 
```

但这仅适用于 raw `$.ajax()`，是否有**与函数调用**相同的功能，而其中又包含 ajax（和其他随机逻辑）？

伪代码思路：

```
 // The functions having the AJAX inside them of course
    $.when(ajaxFunctionOne, ajaxFunctionTwo).then(function () {
        alert('all complete'); 
    }); 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T21:16:42.017

当然，让函数返回一个承诺对象。

```
function ajaxFunctionOne() {
    return $.ajax(...)
}
function ajaxFunctionTwo() {
    var dfd = $.Deferred();
    // on some async condition such as dom ready:
    $(dfd.resolve);
    return dfd.promise();
}

function ajaxFunctionThree() {
    // two ajax, one that depends on another
    return $.ajax(...).then(function(){
        return $.ajax(...);
    });
}   

$.when(ajaxFunctionOne(),ajaxFunctionTwo(),ajaxFunctionThree()).done(function(){
    alert("all complete")
}); 
```

# jquery - 用于 jquery 对话框操作的 getter

> ID：14635285
> 
> 赞同：1
> 
> 时间：2013-01-31T21:15:05.330
> 
> 标签：jquery, forms, action, getter

我为 updpunchform jquery 对话框分配了一个操作：

```
 $(".punch").click(function(event) {
    ......
    $('#updpunchform').attr('action', '/asistencias/updatePunch/'+$(this).attr("id"));
    $updpunch.dialog("open");
    ...
    etc. 
```

-这是生成的-

```
<form action="/asistencias/updatePunch/a-77" id="updpunchform" method="post"> 
    <fieldset>
        <div style="display: block;" id="anypunchfieldContainter">
        ... 
        ... 
```

这一切都很好。

现在，在关闭我的对话框之前，我需要恢复表单的操作，例如：

```
 beforeClose: function( event, ui ) {
        // getter
       var title = $("#updpunch").dialog( "option", "title" ); 
```

返回标题字符串确定。我得到了表格的标题，但不知道如何得到它的动作，试过了

```
var title = $("#updpunch").dialog( "option", "action" ); // ( target, url, href, etc. 
```

并得到了这个文本：

```
[object Object] 
```

如上所示，如何以文本形式获取表单的操作？它在我的 dom 上，只是不知道如何获取它以供进一步使用。

你能帮我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:17:16.740

你可能想多了，直接问`action`属性：

```
var targetUrl = $('#updpunchform').attr('action'); 
```

# java - 将单个侦听器链接到多个按钮

> ID：14635286
> 
> 赞同：0
> 
> 时间：2013-01-31T21:15:09.323
> 
> 标签：java, swing, variables, actionlistener, japplet

您好我在将单个侦听器链接到多个按钮时遇到问题。我正在尝试使用内部类，但似乎我在某处弄错了。有人可以指出我正确的方向吗？如果它有助于自动更正的东西（ :D ）指向第 59 行说：

> “createChampButton 无法解析为变量”

代码：

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;

public class GUI extends JApplet{

    public void init(){
        Container guiContainer = getContentPane();
        LayoutManager layout = new FlowLayout();
        guiContainer.setLayout(layout);

        //Create Championship Button
        final JButton createChampButton = new JButton("Create Championship");
        guiContainer.add(createChampButton);

        //Create Club Button
        final JButton createClubButton = new JButton ("Create Club");
        guiContainer.add(createClubButton);

        //Create Athlete Button
        final JButton createAthleteButton = new JButton ("Create Athlete");
        guiContainer.add(createAthleteButton);

        //Print Athletes Button
        final JButton printAthletesButton = new JButton ("Print all Athletes");
        guiContainer.add(printAthletesButton);

        //The quiet Listener
        ButtonListener aListener = new ButtonListener();
        printAthletesButton.addActionListener(aListener);
        createAthleteButton.addActionListener(aListener);
        createClubButton.addActionListener(aListener);
        createChampButton.addActionListener(aListener);

    }

     class ButtonListener implements ActionListener {
        public void actionPerformed(ActionEvent event){
            JButton button = (JButton) event.getSource();
            //if (button.equals(printAthletesButton)){
                //JOptionPane.showMessageDialog(null, "Athlete name is: " +anAthlete.GetAthleteName());
            //  JOptionPane.showMessageDialog(null, "Athlete age is: " + anAthlete.GetAge());
                //}
            if(button.equals(createChampButton)){
                    Championship aChampionship = new Championship("","");
                    aChampionship.champName = JOptionPane.showInputDialog("Enter Championship Name: ");
                    aChampionship.duration = JOptionPane.showInputDialog("Enter Championship Duration: ");
            }       
        }
    }
} 
```

在此先感谢，克里斯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:18:16.583

`createChampButton`是一个局部变量`init()`

要在其他地方访问它，您需要将其更改为类中的一个字段。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:23:54.063

`createChampButton`未在您的其他方法中定义，因此您无法访问该范围。我看到三个选项可以解决这个问题：

1）您`component.getActionCommand()`改用 - 您可以将它与您的 JButton 保存的文本进行比较（类似于`if( evt.getSource().getActionCommand().equals("Create Championship")`

2）您可以在您的 init 方法中定义您的 ActionListener ：

```
public void init(){
    Container guiContainer = getContentPane();
    LayoutManager layout = new FlowLayout();
    guiContainer.setLayout(layout);

    //Create Championship Button
    final JButton createChampButton = new JButton("Create Championship");
    guiContainer.add(createChampButton);

    //Create Club Button
    final JButton createClubButton = new JButton ("Create Club");
    guiContainer.add(createClubButton);

    //Create Athlete Button
    final JButton createAthleteButton = new JButton ("Create Athlete");
    guiContainer.add(createAthleteButton);

    //Print Athletes Button
    final JButton printAthletesButton = new JButton ("Print all Athletes");
    guiContainer.add(printAthletesButton);

    //The quiet Listener
    ActionListener aListener = new ActionListener() {
        @Override
        public void actionPerformed(ActionEvent event){
            JButton button = (JButton) event.getSource();
            //if (button.equals(printAthletesButton)){
                //JOptionPane.showMessageDialog(null, "Athlete name is: " +anAthlete.GetAthleteName());
            //  JOptionPane.showMessageDialog(null, "Athlete age is: " + anAthlete.GetAge());
                //}
            if(button.equals(createChampButton)){
                    Championship aChampionship = new Championship("","");
                    aChampionship.champName = JOptionPane.showInputDialog("Enter Championship Name: ");
                    aChampionship.duration = JOptionPane.showInputDialog("Enter Championship Duration: ");
            }       
        }
    };
    printAthletesButton.addActionListener(aListener);
    createAthleteButton.addActionListener(aListener);
    createClubButton.addActionListener(aListener);
    createChampButton.addActionListener(aListener);

} 
```

}

3）您将 JComponents 定义为实例变量 - 在您的 init() 方法之外声明它们（但仍然在内部分配它们）

问候，
丹尼尔

# import - CQRS/ES：批量操作/导入

> ID：14635287
> 
> 赞同：9
> 
> 时间：2013-01-31T21:15:18.523
> 
> 标签：import, cqrs, event-sourcing

我正在尝试围绕整个 CQRS/ES 想法进行思考，并考虑编写一个概念证明和技术规范，说明如何在我们当前的应用程序中实现它。

有问题的操作（在如何将它们映射到 CQRS/ES 方面）是通过文件导入批量更新复杂的文章数据——数据文件中的单行扩展到文章组、文章、标题、单位和属性、批量-加载将买方分类链接到供应商分类的文件，并导出部分或整个分类。

我在某处（可能是 DDDCQRS Google Group）读到，为文章导入 BC（读取 Excel 文件或其他网格文件）建模的最佳方法是将单行导入数据汇总，然后整个导入成为聚合根。这样，在解析文件之后，我所要做的就是创建一个导入聚合，并为每一行添加该行到导入。这会将事件存储在 BC 的事件存储中，并发布文章管理 BC 将订阅的事件。这有意义吗？

在当前系统中，导入在单个长时间运行的事务中运行。长时间运行应该在 5 到 40 分钟之间读取，具体取决于导入的数据量和给定用户已经存在的数据量（因为数据与先前导入的文件和当前数据进行比较）。当操作中途失败时，当前整个操作被回滚。这在 CQRS/ES 中是如何工作的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-17T11:26:11.537

与 CQRS/ES 无关。一个非常幼稚的方法如下：

*   找到你的工作单位，
*   为这些单位设计一个升序识别方案，
*   将原始输入转换为这些工作单元（失败和快速的可能性较小）并在此过程中分配身份，
*   现在将每个工作单元作为事务处理，将最后处理的工作单元身份更新为每个事务的一部分（如果您打算并行处理，则更新多个），
*   从最后一个处理的工作单元开始故障恢复时，无论是自动的还是在 ops 给了绿灯之后。

在所有劣质 IMO 的背后是否有事件源或基于状态的模型。

# ruby - 猴子修补 PageObject::PageFactory#visit_page 是个好主意吗？

> ID：14635290
> 
> 赞同：1
> 
> 时间：2013-01-31T21:15:30.640
> 
> 标签：ruby, monkeypatching, page-object-gem

一位开发人员最近询问我们的测试是否可以在每次打开页面时执行一些 javascript。有关详细信息，请参阅[错误 44299](https://bugzilla.wikimedia.org/show_bug.cgi?id=44299)。

执行 javascript 很简单：

```
browser.execute_script('return mw.loader.getModuleNames().filter(function (module) { return mw.loader.getState(module) === "error"; }).length === 0;')
#=> true 
```

我们正在使用page [-object](https://github.com/cheezy/page-object)[`#visit_page`](https://github.com/cheezy/page-object/blob/master/lib/page-object/page_factory.rb#L52-L54)打开页面。确保每次打开页面时执行上述示例中的 javascript 的一种简单方法是对该`#visit_page`方法进行猴子修补。

`alias_method`链（来自问题[4470108](https://stackoverflow.com/a/4471202/17469)）看起来是一种简单的方法。

有没有更好的办法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T13:00:28.460

您可以简单地在您的页面对象类上创建一个名为`initialize_page`. 此方法将在页面加载后立即调用。在该方法中，您可以调用`execute_script`（页面上的方法）传递您希望执行的 javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:12:34.523

在我看来，你为一些非常简单的事情做了太多的工作。我不确定您使用的是什么框架，但是您有应用程序范围的 JavaScript 文件吗？对于 Rails 应用程序，我会编写一个 test.js.erb：

```
<%= %q+browser.execute_script('return mw.loader.getModuleNames().filter(function (module) { return mw.loader.getState(module) === "error"; }).length === 0;')+ if Rails.env.test? %> 
```

并添加`//= test`到您的应用程序清单

# vim - vim 需要很长时间才能启动

> ID：14635295
> 
> 赞同：51
> 
> 时间：2013-01-31T21:16:16.413
> 
> 标签：vim

自从我上次注销并重新登录以来，我在使用 vim 以及其他不相关的程序时遇到了非常缓慢的启动时间。以下是 vim 的启动时间日志：

```
> times in msec  clock   self+sourced   self:  sourced script  clock  
> elapsed:              other lines
> 
> 000.005  000.005: --- VIM STARTING ---
> 000.073  000.068: Allocated generic buffers
> 000.168  000.095: locale set
> 000.180  000.012: GUI prepared
> 000.181  000.001: clipboard setup
> 000.188  000.007: window checked
> 000.621  000.433: inits 1
> 000.626  000.005: parsing arguments
> 000.627  000.001: expanding arguments
> 000.637  000.010: shell init
> 000.909  000.272: Termcap init
> 000.942  000.033: inits 2
> 001.031  000.089: init highlight
> 023.418  000.234  000.234: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/syncolor.vim
> 023.543  001.811  001.577: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/synload.vim
> 044.397  015.231  015.231: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/filetype.vim
> 044.449  025.111  008.069: sourcing /grid/common/pkgs/vim/latest/share/vim/vim73/syntax/syntax.vim
> 052.532  000.199  000.199: sourcing /grid/common/pkgsData/vim-v7.3/Linux/RHEL4.0-2007-x86_64/share/vim/vim73/syntax/nosyntax.vim
> 059.858  000.175  000.175: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/syncolor.vim
> 059.966  003.842  003.667: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/synload.vim
> 060.002  010.259  006.218: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/syntax.vim
> 069.085  000.178  000.178: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/syncolor.vim
> 072.326  000.173  000.173: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/syncolor.vim
> 076.317  000.175  000.175: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/syntax/syncolor.vim
> 076.477  013.311  012.785: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/colors/desert.vim
> 079.768  000.019  000.019: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/filetype.vim
> 080.322  065.921  017.221: sourcing $HOME/.vimrc
> 080.330  013.378: sourcing vimrc file(s)
> 106.526  000.376  000.376: sourcing /home/haitham/.vim/plugin/genutils.vim
> 111.139  001.435  001.435: sourcing /home/haitham/.vim/plugin/multiselect.vim
> 113.534  000.147  000.147: sourcing /home/haitham/.vim/plugin/omap-param.vim
> 119.245  000.073  000.073: sourcing /home/haitham/.vim/plugin/qfixtoggle.vim
> 122.821  000.696  000.696: sourcing /home/haitham/.vim/plugin/surround.vim
> 172.247  000.098  000.098: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/getscriptPlugin.vim
> 176.387  000.252  000.252: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/gzip.vim
> 179.876  000.183  000.183: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/matchparen.vim
> 182.748  000.620  000.620: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/netrwPlugin.vim
> 186.171  000.051  000.051: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/rrhelper.vim
> 189.739  000.046  000.046: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/spellfile.vim
> 193.406  000.195  000.195: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/tarPlugin.vim
> 199.206  000.060  000.060: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/tohtml.vim
> 202.299  000.152  000.152: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/vimballPlugin.vim
> 205.345  000.147  000.147: sourcing /grid/common/pkgs/vim/v7.3/share/vim/vim73/plugin/zipPlugin.vim
> 205.394  120.533: loading plugins
> 12343.581  12138.187: inits 3
> 12349.592  006.011: reading viminfo
> 18421.239  6071.647: setup clipboard
> 18421.264  000.025: setting raw mode
> 18421.270  000.006: start termcap
> 18421.293  000.023: clearing screen
> 18421.504  000.211: opening buffers
> 18421.564  000.060: BufEnter autocommands
> 18421.566  000.002: editing files in windows
> 18425.833  004.267: VimEnter autocommands
> 18425.835  000.002: before starting main loop
> 18426.587  000.752: first screen update
> 18428.334  001.747: --- VIM STARTED --- 
```

显然最大的组件是“inits 3”和“设置剪贴板”。

任何线索该怎么做？

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-07-18T09:25:35.333

# 设置剪贴板

首先，尝试使用以下命令运行 Vim：

```
$ vim -X 
```

您可以尝试将这些`-X --startuptime <file>`选项一起使用，以查看“设置剪贴板”组件是否仍然很慢。

如果`-X`有帮助，您可以通过将以下行添加到您的 vimrc 文件来获得相同的效果：

```
set clipboard=exclude:.* 
```

## 解释

如果这有帮助，那么正在发生的事情是在启动时 Vim 试图连接到 X 服务器以允许它使用剪贴板。该`-X`选项告诉 Vim 不要尝试连接到 X 服务器。从`:help -X`

```
-X          Do not try connecting to the X server to get the current
            window title and copy/paste using the X clipboard.  This
            avoids a long startup time when running Vim in a terminal
            emulator and the connection to the X server is slow.
            See --startuptime to find out if affects you.
            Only makes a difference on Unix or VMS, when compiled with the
            +X11 feature.  Otherwise it's ignored.
            To disable the connection only for specific terminals, see the
            'clipboard' option.
            When the X11 Session Management Protocol (XSMP) handler has
            been built in, the -X option also disables that connection as
            it, too, may have undesirable delays. 
```

剪贴板选项可用于通过您的 vimrc 文件更永久地实现相同的目的。从`:help 'clipboard'`

> 要从不连接到 X 服务器，请使用： exclude:.* 这与使用 -X 参数的效果相同。请注意，当没有连接到 X 服务器时，窗口标题将不会恢复，剪贴板也无法访问。

`clipboard=exclude:.*`如果您希望 Vim 在某些情况下连接到 X 服务器，可以将该选项细化为仅适用于特定终端。查看`:help 'clipboard'`更多关于此的信息。

对我来说，这个问题正在发生，因为我在我的 ssh 客户端上启用了“X11 转发”，但并不总是在 ssh 客户端机器上运行 X 服务器。

当我在目标机器上运行 X 服务器时，Vim 的启动速度要快得多（尽管还是有点慢）。

在这个设置中，我想维护 X11 Forwarding，但不需要 Vim 来使用 X 剪贴板，所以我在`set clipboard=exclude:.*`我的 vimrc 中添加了该行。现在 Vim 启动对我来说又快了。

# 初始 3

您似乎已经通过尝试消除了您的插件/自定义作为可能的原因`vim -u NONE`（并且您说您的 vimrc 是空的）。

我不熟悉这个问题，但如上所述，它*可能*与您的 viminfo 文件有关。

您可以通过使用以下命令启动 Vim 来确定是否是这种情况：

```
$ vim -i NONE 
```

根据`:help slow-start`：

> 如果您启用了“viminfo”，加载 viminfo 文件可能需要一段时间。您可以通过暂时禁用 viminfo 来确定这是否是问题（使用 Vim 参数“-i NONE”）。尝试使用 ":set viminfo='20,<50,s10" 减少存储在寄存器中的行数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-11-21T03:43:15.443

我正在使用 v7.4。使用 +clipboard 编译 vim 时，-X 选项会成功增加启动时间。但是，由于现在禁用了与 X 的连接，我们不能再从 x 剪贴板复制和粘贴。

同时，vim 是我在发送到电子邮件、推特、电报等之前唯一的编写方式。所以从 vim 复制+粘贴是必须的。刚刚找到了简单的解决方案：

```
别名 v='nvim'
```

Nvim`.vimrc`自动使用我的旧版本。剪贴板功能无缝工作，没有任何配置麻烦。

不会激怒使用 nvim。我刚刚发现它是我现在问题的最短解决方案。

# python - 断点诱导的 Python 与 IPython 的交互式调试

> ID：14635299
> 
> 赞同：34
> 
> 时间：2013-01-31T21:16:33.197
> 
> 标签：python, debugging, breakpoints, ipython

假设我有一个 IPython 会话，我从中调用了一些脚本：

```
> run my_script.py 
```

有没有办法诱导一个断点`my_script.py`，我可以从 IPython 检查我的工作区？

我记得在以前版本的 IPython 中读到过，可以这样做：

```
from IPython.Debugger import Tracer;     

def my_function():
    x = 5
    Tracer()
    print 5; 
```

但子模块`Debugger`似乎不再可用。

假设我已经打开了一个 IPython 会话：**如何在我选择的位置停止我的程序并使用 IPython 检查我的工作区**？

一般来说，我更喜欢不需要我预先指定行号的解决方案，因为我希望可能有不止一个这样的调用`Tracer()`，而不必跟踪它们所在的行号。

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2013-09-20T07:58:38.730

`Tracer()`仍然存在于 ipython 的不同模块中。您可以执行以下操作：

```
from IPython.core.debugger import Tracer

def my_function():
    x = 5
    Tracer()()
    print 5 
```

注意周围的附加调用括号`Tracer`

**编辑**：对于 IPython 6 及以上版本`Tracer` [已弃用](http://ipython.readthedocs.io/en/stable/api/generated/IPython.core.debugger.html)，因此您应该`set_trace()`改用：

```
from IPython.core.debugger import set_trace

def my_function():
    x = 5
    set_trace()
    print 5 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-01-31T21:22:37.357

您可以运行它并在给定行设置断点：

```
run -d -b12 myscript 
```

其中 -b12 在第 12 行设置断点。当您进入该行时，您将立即进入 pdb，并且您需要输入`c`才能执行到该断点。

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2017-08-10T16:18:07.467

这是使用该`set_trace()`方法的版本，而不是已弃用的版本`Tracer()`。

```
from IPython.core.debugger import Pdb

def my_function():
    x = 5
    Pdb().set_trace()
    print 5 
```

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-31T21:21:43.927

在 IPython shell 里面，你可以做

```
from IPython.core.debugger import Pdb
pdb = Pdb()
pdb.runcall(my_function) 
```

例如，或者`pdb.set_trace()`在你的函数内部做正常的事情。

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-05-16T16:39:51.017

我一直有同样的问题，我发现最好的解决方法是添加一个会破坏我的代码的行，如下所示：

```
...
a = 1+2
STOP
... 
```

然后，当我运行该代码时，它会中断，我可以执行 %debug 去那里检查。您还可以打开 %pdb 以始终转到代码中断的位置，但如果您不想在每次代码中断时到处检查，这可能会很麻烦。我想要一个更优雅的解决方案。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2021-04-14T09:14:44.497

在 Python 3 (v3.7+) 中，有了新[`breakpoint()`](https://docs.python.org/3/library/functions.html#breakpoint)功能。您可以修改它的行为，以便它会为您调用 ipython 的调试器。

基本上你可以设置一个指向调试器函数[的环境变量。](https://docs.python.org/3.8/library/sys.html#sys.breakpointhook)（如果不设置变量，`breakpoint()`默认调用 pdb。）

要设置`breakpoint()`调用 ipython 的调试器，请设置环境变量（在您的 shell 中），如下所示：

```
# for bash/zsh users
export PYTHONBREAKPOINT='IPython.core.debugger.set_trace'
# powershell users
$env:PYTHONBREAKPOINT='IPython.core.debugger.set_trace' 
```

（注意，显然如果你想永久设置环境变量，你需要修改你的 shell 配置文件或系统首选项。）

你可以写：

```
def my_function():
    x = 5
    breakpoint()
    print 5; 
```

它会为你闯入 ipython 的调试器。我认为这比必须 import`from IPython.core.debugger import set_trace`和 call更方便`set_trace()`。

# javascript - 无法在 for 循环中访问全局数组值

> ID：14635303
> 
> 赞同：-1
> 
> 时间：2013-01-31T21:16:44.320
> 
> 标签：javascript

为什么我的全局数组值不能在 for 循环中使用，提供：

```
testing = [];

for (var x=0; x<10; x++){
    console.log(testing); 
} 
```

**“测试”变量用数组动态填充**

*   这个for循环代码上面，会出现这样的错误， http: [//i.stack.imgur.com/NBjH2.png](http://i.stack.imgur.com/NBjH2.png)

* * *

*这就是console.log(testing)*的样子；**w/o for 循环 [http://i.stack.imgur.com/xKhqA.png](http://i.stack.imgur.com/xKhqA.png)*

 ***这是填充数组的函数**

```
 function showMyVideos(data)
    {
        var feed = data.feed;
        var entries = feed.entry || [];
         for (var i = 0; i < entries.length; i++)
        {
            var entry = entries[i];
            var vid = (getVideoId(entry.link[0].href));
            testing[i] = vid;
        }       
  console.log(testing)
    } 
```

如果我在此函数中使用 console.log，这就是它的样子

http*//goo.gl/nVfQn

*用（冒号）替换（星号）以查看链接

> 为什么会这样，它只在函数范围内有效，而我已经在全局范围内声明了它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:18:46.643

那不是错误。这会在您的控制台中向您显示一个空数组，这正是您的`testing`声明的内容。

您可能没有收到任何条目，并且它正在初始化为空字符串。

```
 var entries = feed.entry || []; 
```

然后当你尝试循环`entries.length == 0`

尝试做一个`console.log(entries.length);`在你的循环之前做一个。

尝试这个：

```
 testing = ["foo"];

for (var x=0; x<10; x++){
    console.log(testing);  
 } 
```

您应该在控制台中看到如下内容：

```
 >["foo"]
 >["foo"]
 >["foo"]
  ...and so on 
```*

# javascript - ZeroClipboard（点击链接）无法正常工作

> ID：14635305
> 
> 赞同：3
> 
> 时间：2013-01-31T21:16:57.877
> 
> 标签：javascript, jquery, zeroclipboard

我正在使用 zeroclipboard 进行复制功能，但它似乎无法正常工作..

我正在尝试通过单击链接从页面复制数据。

我在我的 html 中包含了必要的文件，

```
<script type="text/javascript" src="/DataTables-1.9.4/zeroclipboard/ZeroClipboard.js"></script>
<script language="JavaScript">
    ZeroClipboard.setMoviePath('/DataTables-1.9.4/zeroclipboard/ZeroClipboard.swf');    
</script> 
```

我的 js 文件中有以下函数

```
<a href='javascript:void(0);' onclick=copy(\""+idValue+"\") id=d_clip_button><font size=2 color=blue>Copy to clipboard</a>

function copy(elementIdValue){

var value=$("#"+elementIdValue).html();
var clip = new ZeroClipboard.Client();
var myTextToCopy = $(value).text();  

clip.glue('d_clip_button');
clip.addEventListener('onMouseover', clipboardEvent);
function clipboardEvent() {
            clip.setText( finalText);
} 
```

当我双击链接时复制功能工作正常，但如果我单击复制链接则不起作用。同样由于某种原因，最初复制的数据没有被删除。当我打开一个新页面并尝试复制数据时，它仍然有旧数据。有人可以让我知道如何解决这个问题吗？

# c++ - C ++中的指针和汇编语言中的指针之间的区别？

> ID：14635306
> 
> 赞同：1
> 
> 时间：2013-01-31T21:16:59.220
> 
> 标签：c++, pointers, assembly

此外，远近指针......谁能详细说明一下？

在 C++ 中，我不知道指针如何在直接操作码级别或电路级别工作，但我知道它是访问其他内存的内存，反之亦然，等等。

但是在汇编中你也可以使用指针。

这里有什么值得了解的显着差异，还是相同的概念？它在低级微处理器特定组件的助记符级别上是否有不同的应用？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:48:52.563

Near 和 far 指针仅与 16 位操作系统相关。除非您真的需要它们，否则请忽略它们。您可能仍会在当今的编译器中找到向后兼容的关键字，但它们实际上不会做任何事情。在 16 位术语中，`near`指针是 16 位偏移量，其中内存段已被上下文知道，并且`far`指针包含 16 位段和 16 位偏移量。

在汇编程序中，指针只是指向内存位置。在 C++ 中也是如此，但在 C++ 中，内存可能包含一个对象；根据指针的类型，地址可能会改变，即使它是同一个对象。考虑以下：

```
class A
{
public:
    int a;
};

class B
{
public:
    int b;
};

class C : public A, B
{
public:
    int c;
};

C obj;
A * pA = &obj;
B * pB = &obj; 
```

`pA`并且`pB`不会平等！它们将指向`C`对象的不同部分；当您将指针从一种类型转换为另一种类型时，编译器会进行自动调整。由于它知道类的内部布局，它可以计算适当的偏移量并应用它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:28:24.490

通常，指针是允许您访问其他东西的东西，因为它指向它。
在计算机中，“某物”和“其他东西”是内存内容。由于内存是通过指定其内存地址来访问的，因此指针（某物）是存储其他某物的内存地址的内存位置。
在编程语言、高级语言或汇编语言中，您可以给内存地址命名，因为名称比内存地址（通常以十六进制数字形式）更容易记住。该名称是编译器（高级）或汇编器（机器级）与十六进制数完全相同的常量名称，或者是存储十六进制数的变量（内存位置）的名称。
因此，对于像 C++ 这样的高级语言或像汇编程序这样的低级语言，指针的概念没有区别。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-01T15:56:15.093

除了大家所说的近/远：不同之处在于，在 C++ 中，指针是类型化的——编译器知道它们指向什么，并在幕后为你做一些地址算术。例如，如果您有一个`int *p`and 访问权限`p[i]`，编译器会将 4*i 添加到该地址的值`p`并访问该地址的内存。这是因为整数（在大多数现代操作系统中）是 4 个字节长。与指向结构/类的指针相同 - 编译器将悄悄地计算数据项在结构中的偏移量并相应地调整内存地址。

使用汇编内存访问，没有这样的运气。在汇编级别，从技术上讲，几乎没有可变数据类型的概念。具体来说，整数和指针之间几乎没有区别。当您使用大于一个字节的数组时，跟踪数组项的长度是您的责任。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T21:35:52.510

重新近/远：

过去，一些平台，特别是 16 位 DOS 和 16 位 Windows，使用内存段的概念。近指针是指向假定默认段的指针，基本上只是一个偏移量，而远指针包含段部分和偏移部分，因此可以表示内存中的任何地址。

在 DOS 中，您可以为 C/C++ 选择一堆不同的内存模型，其中一个只有一个数据段，因此所有数据指针都隐式靠近，有几个只有一个代码段，一个代码和数据指针都很远，依此类推。

分段编程是一个真正的 PITA。

# postgresql - 如何在 Postgres 中使用 Returning 和 Commit，以便获得已提交的记录集？

> ID：14635307
> 
> 赞同：0
> 
> 时间：2013-01-31T21:17:04.493
> 
> 标签：postgresql

我正在使用 postgres 构建一个 FIFO 队列，并基于 apinstein 对[作业队列的回答作为具有多个消费者的 SQL 表（PostgreSQL）](https://stackoverflow.com/questions/6507475/job-queue-as-sql-table-with-multiple-consumers-postgresql)

问题是，如果我使用事务，那么语句看起来像：

```
 begin;
lock table queued_message in exclusive mode;
update 
    queued_message
set 
    status='IN_PROGRESS'
where
    id in (
        select
            id
        from
            queued_message
        where
            status='SUBMITTED' and queue='BACKFILL_REQUEST'
        order by 
            id asc
        limit 1
    )
returning *;
commit; 
```

然后我的返回值被丢弃。如果我在没有开始/提交的情况下运行相同的语句，则记录集返回正常。

显然我更喜欢交易；没有它，该语句甚至可能不安全。那么如何返回我提交的记录集呢？

***编辑*** 我正在标记答案，因为它让我走上了正确的轨道，但这是我最终得到的功能：

```
CREATE TYPE returned_message as (id bigint, body json, status character varying(50) , queue character varying(150), last_modified timestamp without time zone)

CREATE OR REPLACE FUNCTION get_next_message(desiredQueue character varying(150)) 
RETURNS returned_message AS $$
    DECLARE result returned_message;
    BEGIN
    lock table queued_message in exclusive mode;
    update queued_message
    set 
        status='IN_PROGRESS'
    where
        id in (
        select
            id
        from
            queued_message
        where
            status='SUBMITTED' and queue=desiredQueue
        order by 
            id asc
        limit 1
        )
    returning * into result;
    RETURN result; 
END;$$LANGUAGE plpgsql; 

select * from get_next_message('BACKFILL_REQUEST') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:39:28.813

您可以创建一个返回所需值的函数。每个函数都作为事务执行。不要放置“开始；” 和“承诺”；在函数体内。我相信下面的功能应该可以工作。

```
create or replace function set_in_progress()
returns setof queued_message 
language sql as $$
    lock table queued_message in exclusive mode;
    update 
        queued_message
    set 
        status='IN_PROGRESS'
    where
        id in (
            select
                id
            from
                queued_message
            where
                status='SUBMITTED' and queue='BACKFILL_REQUEST'
            order by 
                id asc
            limit 1
        )
    returning *;
$$;

select * from set_in_progress(); 
```

# php - 如何用 MySQL 中的数据填充 PHP 数组？

> ID：14635309
> 
> 赞同：0
> 
> 时间：2013-01-31T21:17:10.020
> 
> 标签：php

我正在使用 Twilio API 发送短信。我正在尝试更改它，以便我可以从 mysql 结果发送到收件人列表。

给出的示例代码是：

```
$people = array(
    "+14155551212" => "First Lastname",
); 
```

我的代码是：

```
$people = array(
    while($res = mysql_fetch_array($usersphone)) {
    $people[$res['UserMobile']] = $res['UserFirstName'];
    }
); 
```

语法不好，但我不知道在哪里。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:20:13.083

您不能将控制结构放入数组中。

```
$people = array();
while ($res = mysql_fetch_array($usersphone)) {
    $people[$res["UserMobile"]] = $res["UserFirstName"];
}; 
```

此外，这里有大量关于 SO 的帖子会告诉您不再使用这些`mysql_*`功能，因为它们已被弃用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:20:27.037

您的数组定义中有逻辑。您应该定义数组，然后用 while 填充它。

```
// define the array
$people = array();
while($res = mysql_fetch_array($usersphone)) {
    // populate key with mobile and value with name
    $people[$res['UserMobile']] = $res['UserFirstName'];
} 
```

# mysql - MySQL -> SQL Server Migration Assistant 与 LARGE 表问题

> ID：14635311
> 
> 赞同：5
> 
> 时间：2013-01-31T21:17:16.100
> 
> 标签：mysql, sql-server, database, database-migration

我正在尝试将我公司的旧 MySQL 数据库迁移到 SQL Server 2008。

我正在使用 MySQL 软件的 SQL Server 迁移助手，除了大表（一些包含大约 1.5 亿行以上）之外，一切都很好 - 它创建了架构等，当我选择迁移数据时，我得到它卡住了在`Migrating myTable > myTable with 0 of 159216578 rows processed`- 它保持这种状态大约 1-2 小时然后崩溃并说它无法创建错误文件。

我可以更改任何内容/设置以使其正常工作吗？有没有更好的方法（如果我也可以这样做，我可以访问`.frm`, `.MYD`,`.MYI`文件） - 只要我迁移这些表，我就可以接受任何事情。

谢谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T21:17:57.067

我认为您想一次导出大约 1000 万行（取决于 MySQL 硬件），使用 WHERE 子句中允许您分离数据（ID、日期等）的内容。

```
SELECT * FROM Table1 WHERE ID BETWEEN x and y INTO OUTFILE 'C:\temp\data.csv'; 
```

您可以使用 SQL Server 导入/导出向导将其导入 MSSQL。

# llvm - 用于解析数学表达式的 LLVM

> ID：14635317
> 
> 赞同：3
> 
> 时间：2013-01-31T21:17:48.957
> 
> 标签：llvm

我对 LLVM 的实际作用感到困惑……我是否可以假设它可以用于在 C++ 程序中在运行时解析数学表达式？

现在在运行时，我正在获取数学表达式并从中构建一个 C 程序，通过对 gcc 进行系统调用来动态编译它。然后我动态加载由 gcc 生成的 .so 并提取我的 eval 函数......

我想用更简单甚至更快的方法替换这个工作流程...... LLVM 可以帮我吗？有什么资源可以让我开始吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:20:24.697

您正在描述使用 LLVM 作为 JIT 编译器，这绝对是可能的。如果您生成 LLVM IR 代码（在内存中）并将其交给库，它将为您生成机器代码（仍在内存中）。然后，您可以随心所欲地运行该代码。

如果要从 C 代码生成 LLVM IR，也可以链接[`clang`](http://clang.llvm.org)为库。

[这](http://llvm.org/devmtg/2008-08/Begeman_EfficientJIT.pdf)是我在[此答案](https://stackoverflow.com/a/6869192/116908)中找到的 PDF ，其中包含一些有关如何将 LLVM 用作 JIT 的示例。

# ruby - 当调用者进程被杀死时，有一个 IO.popen 命令被杀死

> ID：14635318
> 
> 赞同：2
> 
> 时间：2013-01-31T21:17:51.670
> 
> 标签：ruby, process, io, popen, kill

我有一个启动子进程的 Ruby 脚本。我希望他们在整个过程被杀死时被杀死。

```
IO.popen('testacular start unit.conf.js', 'w') 
```

运行我的脚本：

```
user.name:/my/repo [git: my-branch] $ ruby my-script.rb 
```

睾丸的输出：

```
user.name:/my/repo [git: my-branch] $ info: Testacular server started at http://localhost:8000/
info (launcher): Starting browser PhantomJS
info (PhantomJS 1.7): Connected on socket id uVAO41Q2niyLA8AqbZ8w
PhantomJS 1.7: Executed 44 of 44 SUCCESS (0.213 secs / 0.115 secs) 
```

点击 Control-C 终止进程。检查正在运行的进程：

```
user.name:/my/repo [git: my-branch] $ ps
  PID TTY           TIME CMD
 # ...
39639 ttys019    0:01.28 node /usr/local/bin/testacular start unit.conf.js
39649 ttys019    0:00.09 node /usr/local/bin/phantomjs /var/folders/2p/dklw3xys2n3f4hqmx73zvz6w0000gp/T/testacular-61981618/capture.js
39650 ttys019    0:00.82 /usr/local/lib/node_modules/phantomjs/lib/phantom/bin/phantomjs /var/folders/2p/dklw3xys2n3f4hqmx73zvz6w0000gp/T/testacular-61981618/capture.js 
```

我们可以看到睾丸进程仍在运行。

手动杀死它并查看典型的睾丸关闭输出：

```
user.name:/my/repo [git: my-branch] $ kill 39639
info: Disconnecting all browsers
error (launcher): Cannot start PhantomJS

user.name:/my/repo [git: my-branch] $ 
```

有没有办法让`IO.popen`我以后不必手动杀死`testacular`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:10:24.593

是的，您只需要在主进程中安装一个[信号处理](http://www.ruby-doc.org/core-1.9.3/Signal.html#method-c-trap)程序来捕获 Ctrl-C (SIGINT)，然后将该信号发送到子进程。

这个例子应该解释一些事情：

```
# Start child and save its pid
io  = IO.popen("sleep 600")
pid = io.pid

# Print the output of the ps command (just for demonstration)
puts "Checking #{pid} ..."
system("ps #{pid}")

puts "Installing signal handler..."

Signal.trap("INT") {
  # Ctrl-C was pressed...
  puts "Caught interrupt - killing child..."

  # Kill child process...
  Process.kill("INT", pid)

  # This prevents the process from becoming defunct
  io.close

  # Just for demonstration purposes - check that it died
  puts "Checking #{pid} ..."
  system("ps #{pid}")

  # Forward the INT signal back to the parent
  # ...or you could just call "exit" here too.
  puts "Forwarding signal to myself..."
  Signal.trap("INT", "DEFAULT")
  Process.kill("INT", 0)
}

# Make the parent "do some stuff"...
puts "Sleeping parent..."
sleep 600 
```

输出：

```
> ruby popen_test.rb
Checking 2474 ...
  PID TTY      STAT   TIME COMMAND
 2474 pts/0    S+     0:00 sleep 600
Installing signal handler...
Sleeping parent...

# Press Ctrl-C ...  

Caught interrupt - killing child...
Checking 2474 ...
  PID TTY      STAT   TIME COMMAND
Forwarding signal to myself...
kill.rb:20: Interrupt
        from kill.rb:24:in `call'
        from kill.rb:24:in `sleep'
        from kill.rb:24 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T21:27:44.503

请注意，当信号是 SIGKILL 时，上述方法不起作用。为了解决这个问题，您可以实现基于管道的方法，如下所示：[https ://github.com/vaneyckt/Adeona/blob/master/lib/adeona.rb](https://github.com/vaneyckt/Adeona/blob/master/lib/adeona.rb)

# perl - 迫切需要帮助使用 Strawberry Perl 编译 Font::FreeType CPAN 模块

> ID：14635323
> 
> 赞同：-1
> 
> 时间：2013-01-31T21:18:09.953
> 
> 标签：perl

从字面上看，现在几天来，我一直在网上搜索，诅咒和撕扯我的头发，尝试使用**dmake**为*dwimperl-5.14.2.1-v7-32bit* (Strawberry Perl 5.14.2.1)编译[Font::FreeType 。](http://search.cpan.org/~geoffr/Font-FreeType-0.03/lib/Font/FreeType.pm)**对于开瓶器， FreeType.xs**文件中有几个错误，我在[错误 #32713 for Font-FreeType: patch for Font-FreeType-0.03](https://rt.cpan.org/Public/Bug/Display.html?id=32713)中找到了一个补丁。迷人的。这个模块的最后一次更新是 2004 年 9 月 11 日（注意这一天），所以它肯定已经死了，但我需要它来使用带有 perlcairo 的 REAL 字体。所以我决心（不顾一切地）让它发挥作用。到目前为止，除了这个模块之外，我在使用 cpan 时没有遇到任何问题。事实上**草莓 Perl*********是我使用过的唯一一个可以直接与 CPAN 一起使用的 Windows perl。这显然是一个流氓模块。甚至 *nix 用户也遇到过问题。*******

 *******我阅读了[如何修复 Perl 的 Font::FreeType 编译错误？](https://stackoverflow.com/questions/2104569/how-do-i-fix-perls-fontfreetype-compilation-errors)但那里没有帮助，所以我认为一个新线程是合理的。

```
Number found where operator expected at Makefile.PL line 17, near "my $font_filename = catfile($data_dir, '5"
  (Might be a runaway multi-line '' string starting on line 9)
    (Do you need to predeclare my?) 
```

生成文件.pl：

```
1  use ExtUtils::MakeMaker;
2  use File::Spec::Functions;
3  
4  WriteMakefile(
5      NAME            => 'Font::FreeType',
6      AUTHOR          => 'Geoff Richards <qef@laxan.com>',
7      VERSION_FROM    => 'lib/Font/FreeType.pm',
8      LIBS            => [ '-lfreetype' ],
9      INC             => '-I/usr/include/freetype2',
10     NO_META         => 1,
11 );
12 
13 
14 # Generate a listing of the characters in the BDF test font, for checking
15 # that the library can find them all.  See t/10metrics_5x7bdf.t
16 my $data_dir = catdir(qw( t data ));
17 my $font_filename = catfile($data_dir, '5x7.bdf'); 
```

使用 perl 运行得很好，那么 dmake 的问题是什么？如果我只是用 perl 运行它，**dmake**会重新运行它。我不知道如何让**dmake只使用那里的东西，而且我在****dmake**上找不到真正的文档，只有无用的帮助和手册页（至少对我来说没用）。

**我尝试在$data_dir**中添加一个斜杠，但同样的错误。最后我只是将**$font_filename**设置为完整路径。粗制滥造，我知道，但它有效。

所以这现在创建了**FreeType.c**但现在存在路径问题：

```
gcc -c  -I/usr/include/freetype2    -s -O2 -DWIN32 -DPERL_TEXTMODE_SCRIPTS -DUSE_SITECUSTOMIZE -DPERL_IMPLICIT_CONTEXT -DPERL_IMPLICIT_SYS -fno-strict-aliasing -mms-bitfields -s -O2     -DVERSION=\"0.03\"    -DXS_VERSION=\"0.03\"  "-IC:\Dwimperl\perl\lib\CORE"   FreeType.c
FreeType.xs:19:22: fatal error: ft2build.h: No such file or directory 
```

FreeType.c 包含：

```
#include <ft2build.h>
#include FT_FREETYPE_H 
```

我尝试更改*Makefile.pl*中的包含路径，但我真的不知道这样做的“正确”方法：

```
WriteMakefile(
    .
    LIBS            => '-LC:/gtk/lib -lfreetype',
    INC             => '-IC:/gtk/include/freetype2 -IC:/gtk/include -IC:/Dwimperl/c/include', 
```

我认为现在的问题是将 *nix 路径转换为 ​​Windows 路径，以便编译器可以找到所有头文件。有没有人使用任何编译器在 Windows 中成功编译了这个该死的模块？或者至少有人知道如何为*WriteMakefile*指定 Windows 路径吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T07:05:53.433

我还尝试使用 cpan 将最新的 FreeType 模块安装在 cygwin 上，如下所示：

```
$ cpan

cpan shell -- CPAN exploration and modules installation (v1.9800)
Enter 'h' for help.

cpan[1]> install Font::FreeType 
```

我遇到的第一个问题是在制作阶段。Make 抱怨找不到 ft2build.h。

那时我意识到我必须先下载并编译/安装 FreeType 库（doh！）。所以，我从 FreeType[下载](http://download.savannah.gnu.org/releases/freetype/ "下载")页面下载了最新的，并像这样安装它：

```
$ cd cygwin/freetype-2.4.0
$ ./configure
...
$ make
...
$ make install 
```

下一个问题是，当我再次尝试在 cpan 中制作模块时，它在 ft2build.h 中的以下行失败：

```
#include <freetype/config/ftheader.h> 
```

如果您查看实际文件（在我的系统上的 /usr/local/include/ft2build.h 中，但它可能在您的其他地方），您会在该行之前看到此注释：

```
/* `<prefix>/include/freetype2' must be in your current inclusion path */ 
```

所以，我设置了适当的环境变量（我相信“正确”的方式——比修改 make 文件中的“INC”行更好）：

```
$ C_INCLUDE_PATH=/usr/local/include/freetype2
$ export C_INCLUDE_PATH 
```

修复后，我遇到的下一个问题是左值错误：

```
$ cpan install Font::FreeType
CPAN: Storable loaded ok (v2.27)
...
FreeType.xs:808:21: error: lvalue required as left operand of assignment
...
Makefile:340: recipe for target `FreeType.o' failed
make: *** [FreeType.o] Error 1
  GEOFFR/Font-FreeType-0.03.tar.gz
  /usr/bin/make -- NOT OK
CPAN: YAML loaded ok (v0.84)
Running make test
  Can't test without successful make
Running make install
  Make had returned bad status, install seems impossible 
```

我知道你已经解决了这个问题，但我会在这里发布信息以防其他人遇到它。[将此处](https://stackoverflow.com/questions/2104569/how-do-i-fix-perls-fontfreetype-compilation-errors "这里")的补丁文件保存到 FreeType.xs.diff（您的 Font-FreeType-0.03 目录可能命名不同），应用它，然后像下面这样进行编译/编译。请注意，由于我们修改了模块，我们不能再使用 cpan，因此我们手动进行：

```
$ cd ~/.cpan/build/Font-FreeType-0.03
$ patch FreeType.xs FreeType.xs.diff
patching file FreeType.xs

$ make
Makefile out-of-date with respect to Makefile.PL
...
==> Your Makefile has been rebuilt. <==
==> Please rerun the make command.  <==
false
Makefile:866: recipe for target `Makefile' failed
make: *** [Makefile] Error 1

$ make
cp lib/Font/FreeType.pm blib/lib/Font/FreeType.pm
...
Manifying blib/man3/Font.FreeType.3pm

$ make install
Files found in blib/arch: installing files in blib/lib into architecture dependent library tree
...
Appending installation info to /usr/lib/perl5/5.14/i686-cygwin-threads-64int/perllocal.pod 
```

瞧！编译好了！需要指出的另一件事是，正如 Borodin 之前指出的那样，我使用了常规的 gnu make 而不是 dmake。FreeType 安装说明说您必须运行 GNU Make 3.80 或更高版本。您可以像这样检查已安装的 make 版本：

```
$ make -v
GNU Make 3.82.90
Built for i686-pc-cygwin
Copyright (C) 2010  Free Software Foundation, Inc.
License GPLv3+: GNU GPL version 3 or later <http://gnu.org/licenses/gpl.html>
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law. 
```*******

# ssis - 如何从 SSIS 中的另一个数据源向输出记录集添加附加列？

> ID：14635324
> 
> 赞同：0
> 
> 时间：2013-01-31T21:18:11.987
> 
> 标签：ssis

我在 SSIS 包中有一个数据流，它使用 OLE DB 源（调用它*`source1`*）从 SQL 服务器获取数据。我正在使用 OLE DB 目标将该数据保存到我的最终目标数据库中。*`source2`*我们的用户提出了一个新要求，即在源和最终目的地之间根据从 中提取的列值键从另一个源数据库（称为它）中提取一条数据*`source1`*。*`source1`*然后将合并的数据*`source2`*保存到目的地。有没有办法在 SSIS 中做到这一点？我唯一能想到的就是从源 2 中获取所有可能的数据并将其保存到目标的临时表中，然后将其链接起来。我不想这样做，因为这可能是很多数据！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:21:09.820

如果我了解您的需求，您正在寻找[Lookup Transformation](http://msdn.microsoft.com/en-us/library/ms141821.aspx)。为了获得最佳性能，您将需要使用查询并仅检索进行匹配所需的列 + 需要添加到输出中的列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:21:08.693

使用源 1 中的记录集目标并将源 1 中的所有内容保存在其中。在另一个 DFT 中，您可以从 Source 2 中读取，然后将 1 和 2 结合起来转储到目标中。希望这可以帮助。

# php - PHP块未在html中解析

> ID：14635325
> 
> 赞同：0
> 
> 时间：2013-01-31T21:18:14.990
> 
> 标签：php, html

我正在编写以下 html 代码：

```
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
 <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /> 

<script type="text/javascript">
    function detectBrowser(){
        if(navigator.appName === "Microsoft Internet Explorer"){
            window.open("redirect.html", "_parent");
        }
    }
</script>
</head>

<body onload="detectBrowser()">
<div class="mainBody">  
<?php
    echo "test";
?>
</div>
</body>
</html> 
```

但是 php 块没有为我显示测试。看起来它没有被解析，我可以在网页的源代码中看到 php 代码。任何人都可以说出问题吗？
谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:23:25.270

您可以在 httpd.conf 文件中启用对带有 .html 扩展名的文件的 PHP 解析。

寻找这样的一行并确保 .html 是一个选项。

```
 AddType application/x-httpd-php .php .php3 .phtml .html 
```

您也可以将它添加到您网站的 docroot 中的 .htaccess 文件中，但我没有亲自尝试过。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:30:52.177

你可以在你的`.htaccess`文件中改变它。（如果它不存在，只需在与您的文件相同的文件夹中创建文件（仅文本））

```
AddType application/x-httpd-php .html 
```

但是，这会使所有静态文件也通过 PHP 解析器，这是不必要的。

我建议最好的解决方案是用 extension 重命名文件`.php`。然后在您的`.htaccess`文件中，您可以只重写此地址，然后您将能够使用 .html 扩展名访问它。

```
RewriteEngine on
RewriteRule ^myfile.html$ myfile.php 
```

# sql-server - 将 IIF() 访问语句转换为 SQL Server

> ID：14635335
> 
> 赞同：1
> 
> 时间：2013-01-31T21:19:10.863
> 
> 标签：sql-server, sql-server-2008, ms-access, iif

我正在尝试将访问代码转换为 sql 2008。但刚刚发现 sql 2008 不支持 IIF 语句！这是我尝试重写查询的两种方法，我知道我弄乱了语法：

```
select distinct (IIf(IsNull([dbo_TASK]![act_start_date])
,IIf(IsNull([dbo_TASK]![restart_date]),[dbo_TASK]![target_start_date],[dbo_TASK]![restart_date]),[dbo_TASK]![act_start_date]) AS [Estimated Start Date] from dbo.task

ATTEMPT1:
if dbo.task.act_start_date=null
    then
        if(dbo.task.restart_date=null)
            then dbo.task.target_start_date
        else dbo.task.restart_date
    else dbo.task.act_start_date

ATTEMP2:
select (case when dbo.task.act_start=null then 
                (case when dbo.task.restart_date=null
                then (dbo.task.target_start_date)
                else dbo.task.restart_date
                end)                
    else (dbo.task.act_start_date)
    end) from dbo.task 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:24:53.837

您的查询非常接近。当检查一个值是否等于`null`你使用`Is Null`not`=null`

因此，如果您实现它，您可以使用以下内容：

```
select distinct 
    case 
        when [act_start_date] is null
        then 
            case 
                when [restart_date] is null
                then [target_start_date]
                else [restart_date]
        else [act_start_date] 
    end AS [Estimated Start Date] 
from dbo.task 
```

或者更容易使用[`COALESCE()`](http://msdn.microsoft.com/en-us/library/ms190349.aspx)它将返回第一个非空值：

```
select distinct 
    coalesce([act_start_date], [restart_date], [target_start_date]) as [Estimated Start Date] 
from dbo.task 
```

# ember.js - 在 Ember 中访问父模型

> ID：14635336
> 
> 赞同：1
> 
> 时间：2013-01-31T21:19:12.477
> 
> 标签：ember.js

因此，我想将所有 API 密钥存储在后端的配置文件中，这样我就不会将它们分散在各处。所以我想我可以在前端创建一个模型来在 /config 上执行 GET，然后我会返回一个配置对象，其中包含我需要的任何 API 密钥。所以我基本上是在尝试从 ApplicationRoute 访问模型。需要明确的是，请求现在发生，但我不知道如何从索引模板访问数据。我已经尝试过`{{App.Config.apiKey}}`，`{{apiKey}}`尝试`@get.controllerFor('application').get('model')`在索引控制器中进行设置，看看我是否可以查看值，但都没有奏效。我正在使用 Ember 1.0.0 .4pre。谢谢

所以我有这样的事情：

```
App = Ember.Application.create
   rootElement: '#app'

# Models
App.Store = DS.Store.extend
  revision: 11

App.User = DS.Model.extend
  firstName: DS.attr 'string'
  lastName: DS.attr 'string'
  accountType: DS.attr 'string'
  email: DS.attr 'string'
  _id: DS.attr 'string'
  password: DS.attr 'string'
  fullName: (->
    "#{@get('firstName')} #{@get('lastName')}"
  ).property('firstName', 'lastName')

App.Config = DS.Model.extend
  secret: DS.attr 'string'
  apikey: DS.attr 'string'

# Controller
# This is has validations for a form in it but I don't think its relivent
App.IndexController = Ember.ObjectController.extend()

# Routes
App.ApplicationRoute = Ember.Route.extend
  model: ->
    App.Config.find()

App.IndexRoute = Ember.Route.extend
  model: ->
    App.User.createRecord()

DS.RESTAdapter.configure "plurals", {
  config: "config"
}

App.Router.map ->
  @resource 'index' 
```

我的模板看起来像这样：

```
<!--- index.html --->

<html>
  <head></head>

  <body>
    <div id="app"></div>
  </body>

</html> 

<!--- application.hbs --->
<div class="container">
  {{outlet}}
</div>

<--- index.hbs --->

<div>
  {{apiKey}} <!-- This is a value from the Config Model -->
  {{firstName}} <!-- This is a value from the User Model -->
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T01:42:27.713

将您的 ApplicationController 明确定义为 ObjectController

```
App.ApplicationController = Ember.ObjectController.extend() 
```

然后在您的 ApplicationRoute 中将控制器的内容设置为配置对象

```
App.ApplicationRoute = Ember.Route.extend
  setupController: (controller, model) ->
    this._super(controller,model);
    controller.set('content',App.Config.find(1)); 
```

或者，在索引控制器中设置您的配置，例如

```
 App.IndexRoute = Ember.Route.extend({
     setupController: function(controller,model) {
       this._super(controller,model);
       controller.set('config',App.Config.find(1));
     }
    }) 
```

然后在你的模板中

```
<div>
  {{config.apiKey}} <!-- This is a value from the Config Model -->
  {{config.firstName}} <!-- This is a value from the User Model -->
</div> 
```

使用第一种方法查看有效的[jsfiddle](http://jsfiddle.net/wQJrg/3/)

[您可以在此处](http://emberjs.com/guides/controllers/)了解 ember 支持的不同类型的控制器

# java - 遍历所有非空的插槽，二维数组？

> ID：14635337
> 
> 赞同：2
> 
> 时间：2013-01-31T21:19:16.003
> 
> 标签：java, arrays, loops

我必须使用二维数组。数组中行槽的最大长度为 100。通常情况下，这些数组槽中的 5-20 个将被填充，而不是更多，但是，我必须将我的代码构建为最多 100 行。我的问题是，有没有办法只遍历已设置的数组槽，在最后一个未设置的空槽之前停止？

```
//initialize array
String[][] variables = new String[numVariables][100];

//System.out.printf("%s \n", numVariables);

for(int i=0; i < numVariables; i++){
    //reads in variable line
    String variableLine = fin.nextLine();

    //turn variable line into array
    varArray = variableLine.split(" ");

    numRules = Integer.parseInt(varArray[0].replaceAll("\\s",""));

    for(int j=0; j < numRules+1; j++){
        variables[i][j] = varArray[j+1];

        System.out.printf("%s ", variables[i][j]);
    }
    System.out.println("\n");
}

//**LATER IN MY CODE ****//
//ITERATE THROUGH 'variables' array and PRINT OUT ONLY VALUES THAT ARE SET 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:32:19.663

如果按从 0 到 100 的顺序填充数组。如果前 51 个元素填充了字符串，则可以使用：

```
 for(int i=0; i < numVariables; i++){
        for(int j=0; j < numRules+1; j++){
            if (variables[i][j] == null)
                break;
            System.out.printf("%s ", variables[i][j]);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:40:27.633

如果不需要它们，为什么还要存储空值？A`String[][]`是 String 数组的数组 - 这些内部数组不需要具有相同的长度。因此，您可以使用所需的元素数量创建每个内部数组：

```
 //initialize array
            String[][] variables = new String[numVariables][];

            //System.out.printf("%s \n", numVariables);

            for(int i=0; i < numVariables; i++){
                //reads in variable line
                String variableLine = fin.nextLine();

                //turn variable line into array
                varArray = variableLine.split(" ");

                numRules = Integer.parseInt(varArray[0].replaceAll("\\s",""));

                variables[i] = Arrays.copyOfRange(varArray, 1, numRules - 1);
            } 
```

然后迭代：

```
for (String[] var : variables) {
    for (String s : var) {
        System.out.print(s);
    }
    System.out.println();
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T21:24:57.473

您可以使用数组，`List<String>`也可以跟踪所有行的长度。

```
int [] rowLength = new int[numVariables]

for(int i=0; i < numVariables; i++){
    /* ... */

    numRules = Integer.parseInt(varArray[0].replaceAll("\\s",""));

    // store the number of slots in variable[i]
    rowLength[i] = numRules+1;

    /* ... */
} 
```

然后你只从零迭代到你的行的长度（`rowLength[i]`）。

第三种方法（**也是我更喜欢的**方法）是不指定数组中行槽的长度：

```
String [][] variables = new String[numVariables][]; 
```

然后在计算完 numRules 之后：

```
variables[i] = new String[numRules+1]; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T21:36:52.983

鉴于您所描述的情况，您可能最好使用其他数据结构，但如果您不能，您可以记录已更改的值。

因此，您可以保留每行长度的数组，并在那里结束对该行的每次搜索。

```
 String[][] variables = new String[numVariables][100];
    int rowLength[] = new int[numVariables];

    //...
    // get and record the rowLength
    //...

    for(int x=0; x < numVariables; x ++) {
        for(int y=0; y < rowLength[x]; y ++) {
            // do your stuff
        }
    }
} 
```

或者，您可以使用地图或 ArrayList 来跟踪每个包含数字的位置。

# ruby - 遇到 Ruby 舍入错误问题

> ID：14635338
> 
> 赞同：0
> 
> 时间：2013-01-31T21:19:21.357
> 
> 标签：ruby, rounding, rounding-error

我一生都无法弄清楚为什么 my:`generate_receipt`方法`54.9`在我的“进口餐盘项目”应该等于时返回`54.65`。我编写了 RSpec 测试来确认数组确实返回了正确的值。

```
47.50 + 4.75 + 2.40 = 54.65 
```

为什么它返回`54.9`而不是返回`54.65`？！这种围捕发生在哪里？如何让它返回正确的值？我难住了。

```
describe :calcualte_sales_tax do

  it "should return the correct array" do
    calculate_sales_tax(@receipt).should eq([0, 4.75])
  end

end

describe :calculate_import_tax do

  it "should return the correct array" do
    calculate_import_tax(@receipt).should eq([0.50, 2.40])
  end

end 

@receipt = {
    "1"=>{:item=>"imported chocolates", :price=>10.00, :quantity=>1},    
    "2"=>{:item=>"imported dinner plates", :price=>47.50, :quantity=>1}
    }

def generate_receipt(receipt)
  n = 0
  while n < receipt.length 
    receipt["#{n+1}"][:price]+=calculate_sales_tax(receipt)[n]
    receipt["#{n+1}"][:price]+=calculate_import_tax(receipt)[n]
    n+=1
  end
  receipt
end

def calculate_import_tax(receipt)
  taxes = []
  receipt.each do |k,v|
    if (v[:item] =~ /imported/)
      subtotal = v[:price]
      # v[:price]+=(((((5 * subtotal)/100)*20.ceil) / 20.0))
      # taxes<<(5 * subtotal)/100
      taxes<<((5 * subtotal/100)*20).ceil/20.0.round(2)
    else
      taxes<<0
    end
  end
  taxes
end

def calculate_sales_tax(receipt)
  tax_free_items = ["book", "chocolate bar", "chocolates", "pills"]
  taxes = []
  receipt.each do |k,v|
    if (v[:item] =~ /chocolate\s/) ||
      (v[:item] =~ /chocolates/) || 
      (v[:item] =~ /book/) || 
      (v[:item] =~ /pills/)
      taxes<<0
    else
      subtotal = v[:price]
      # v[:price]+=(((((10 * subtotal)/100)*20.ceil) / 20.0))
      # taxes<<(10 * subtotal)/100
      taxes<<((10 * subtotal/100)*20).ceil/20.0
    end
  end
  taxes
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:35:14.973

```
def generate_receipt(receipt)
  n = 0
  while n < receipt.length
    puts receipt["#{n+1}"][:price].inspect
    receipt["#{n+1}"][:price]+=calculate_sales_tax(receipt)[n].round(2)
    puts receipt["#{n+1}"][:price].inspect
    puts calculate_import_tax(receipt)[n]
    receipt["#{n+1}"][:price]+=calculate_import_tax(receipt)[n].round(2)
    puts receipt["#{n+1}"][:price].inspect
    puts "-----"
    n+=1
  end
  receipt
end 
```

回报：

```
47.5
52.25
2.65
54.9 
```

该错误在您的 calculate_import_tax 方法中。它返回 2.65，而不是 2.40。

编辑：

知道了 ：）。

```
 receipt["#{n+1}"][:price]+=calculate_sales_tax(receipt)[n]
    receipt["#{n+1}"][:price]+=calculate_import_tax(receipt)[n] 
```

这些行正在更新收据的价格。*因此，您的测试是独立运行的，但在计算进口税之前*，销售税会修改原始价格......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:38:40.160

1) Ruby 将没有小数部分的数字视为 INTEGERS。除非计算包括浮点数，否则不会创建具有小数部分的结果。

2) 10 * X / 100 * 20 == X * 2

3）法律计数可能需要指定的准确性，因此您可能需要使用专门的库来进行此类数字运算。

快速的解决方案是将代码更改为：

10.0 * 小计 / 100.0 * 20.0

现在 Ruby 会将所有这些数字视为浮点数。

# android - .NET 的 DataGridView 或 Android Java 的 ListView 是否有等价物？

> ID：14635345
> 
> 赞同：1
> 
> 时间：2013-01-31T21:20:06.427
> 
> 标签：android

我对 Android 开发真的很陌生，我正在尝试为 Android 应用程序创建一个包含可排序列的表。有没有一种类似于.NET`DataGridView`或`Details` `View`.NET`ListView`控制的？

例子：![ListView 的详细信息视图示例](../Images/9c1651f855c633a0f83905adda335ba2.png)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:52:59.243

Android 有“listview”，用于创建滚动列表。您将需要实现标题，然后自己单独按列排序。（每个标题都应该监听点击。）要使这项工作按预期工作，您需要设计它以进行复杂的排序，即按此列排序，然后按该列排序，然后按第三列等。

要创建用于保存数据的列，您需要为列表视图提供一个 xml 文件，该文件是您对单个行的布局。然后，您可以通过使用 AdapterView（例如 SimpleCursorAdapter、ArrayAdapter 或其他）将数据绑定到列表视图的行。像 SimpleCursorAdapter 这样的普通适配器假定它们将提供字符串，您可以通过使用自定义 ViewBinder。

长话短说-不，android中没有可排序的表，但是您应该能够使用基本的android组件创建自己的表。

# html - onclick、onmousedown 和 onmouseup 的不透明度

> ID：14635347
> 
> 赞同：1
> 
> 时间：2013-01-31T21:20:07.483
> 
> 标签：html, timer, toggle, image, opacity

我是 javascript 编程的新手，但我正在取得进步！我正在为自闭症儿童开发一个网络应用程序，用于触摸屏浏览器（55 英寸触摸屏 PC 和 Nexus 7 平板电脑）。我们只会使用 Firefox，因为它看起来最兼容。孩子们将点击图像“按钮”来做出选择并传达他们的需求。按钮需要在触摸时提供视觉反馈。我通过使用 CSS 中的活动状态解决了这个问题：

```
img { opacity:1.0 };
img:active { opacity:0.4 }; 
```

这工作正常。悬停不适合在触摸屏上使用。我还需要使某些图像不可见，但要保持在原处，并在长按时打开和关闭。为此，我找到了一个切换功能和一个计时器功能并将它们组合在一起。

JAVASCRIPT（`<head>`页内）：

```
var t
function tog_vis(id) {
   var e = document.getElementById(id);
   if(e.style.opacity == 1 )
      e.style.opacity = 0 ;
   else
      e.style.opacity = 1 ; 
```

HTML：

```
<img id="myimg" onclick="DoSomething();" onmousedown="t=setTimeout(function(){ tog_vis('myimg'); }, 1500);" onmouseup="clearTimeout(t);" src="images/img1.png"> 
```

问题是活动状态被 onmousedown 和 onmouseup 事件接管（我已经读过这是因为它们都是 click 事件的一部分 - 有道理！），我猜 onclick 事件也可能会进一步搞砸.

预期/期望的行为：

1.正常点击时，图片不透明度变为0.4，释放时返回1，完成onclick请求。

2.长按图片不透明度为0，第二次长按不透明度为1，无onclick事件。

该应用程序最终将有@ 100 个必须执行第一个行为的相似图像，而第二个行为将仅在@ 10 个按钮上需要，因此我可以在必要时愉快地单独编码功能。我还发现 55" 触摸屏（Windows 7）没有响应 img:active CSS，所以猜测这些都依赖于 touchdown 和 touchup 事件，而平板电脑的表现非常好。

非常感谢这里的任何帮助。

蒂姆

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T00:54:23.137

你可以为这个用例提供 css3 转换和一些 javascript。看看这个小提琴：http: [//jsfiddle.net/Ce8J5/](http://jsfiddle.net/Ce8J5/)

您也可以使用 javascript/jquery 实现悬停，只需删除悬停 css 语句并定义一些附加 css 类并通过 javascript 添加它们。

例如

```
$("#element").mouseenter(function(){
$(this).addClass(".hover");
});

$("#element").mouseleave(function(){
$(this).removeClass(".hover");
}); 
```

# actionscript-3 - 如何修复 AS3 TypeError：错误 #1009：无法访问空对象引用的属性或方法？

> ID：14635355
> 
> 赞同：-1
> 
> 时间：2013-01-31T21:20:33.680
> 
> 标签：actionscript-3

我收到此错误：

```
TypeError: Error #1009: Cannot access a property or method of a null object reference.
    at Skool_fla::MainTimeline/frame1()[Skool_fla.MainTimeline::frame1:10]
    at flash.display::MovieClip/gotoAndStop()
    at Skool_fla::MainTimeline/goback()[Skool_fla.MainTimeline::frame2:22] 
```

是什么导致了这个错误，我该如何解决？

这是我的两个框架的代码：

框架 1：这是您可以访问信用部分的主菜单屏幕

```
 import flash.events.MouseEvent;

//setting up the variables
//events
//stop the timeline

stop();

//the play button
play_btn.addEventListener(MouseEvent.CLICK, playani);
function playani(e:MouseEvent)
{
    //asking it to progress to the load menu
    gotoAndStop(3);
}
//the credits button

credit_btn.addEventListener(MouseEvent.CLICK, creditslide);
function creditslide(e:MouseEvent)
{
    //asking it to go the credits frame
    gotoAndStop(2);
} 
```

第 2 帧：这是演职员表出现的地方

```
 //
//
//all the imports

//events

var credit:credits_bck = new credits_bck ();
var credits_name: credit_nm = new credit_nm ();
var back_butn: back_button = new back_button ();
addChild (credit);
addChild (credits_name);
addChild (back_butn);

back_butn.addEventListener(MouseEvent.CLICK,goback);

function goback(G:MouseEvent)
{

removeChild (credit);
removeChild (credits_name);

gotoAndStop(1);

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:26:36.167

要么 要么`play_btn`为`back_butn`空。您的错误消息的行号与您的代码不对应，因此很难说。但要点是您正在尝试访问什么*都不是*的东西的属性。检查以确保您正在正确初始化变量/引用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-19T18:48:59.190

也许您的问题也是 Flash 错误。

在我的 FLA 中有一个带有一个空关键帧的图层。如果我在上面放一个矢量图形，错误就消失了。如果有一个或多个 MovieClip 并且没有矢量图形 - 错误又出现了。

然后我创建了一个新图层并将所有对象从损坏的图层复制粘贴到新图层并删除了损坏的图层。它解决了这个问题。注意：不要复制关键帧。只复制内容。

现在我的项目要复杂得多，遗憾的是错误又回来了。

经常测试影片，如果错误再次出现，请检查您创建的最后一个关键帧和图层。

# c# - 重定向到另一个页面信息

> ID：14635365
> 
> 赞同：0
> 
> 时间：2013-01-31T21:21:18.377
> 
> 标签：c#, asp.net, redirect

如何重定向到另一个页面并从上一页获取信息？我需要这个来完成一项任务。任务是：

*通过使用 GridView 将 Northwind 数据库中所有员工的姓名显示为超链接。所有链接都应重定向到另一个页面，其中有关员工的详细信息显示在 DetailsView 中。添加后退按钮以返回上一页。*

我被困在这里：

*所有链接都应重定向到另一个页面，其中有关员工的详细信息显示在 DetailsView 中。*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:26:10.440

您可以使用 GridView 的超链接字段，它可以定义查询字符串参数并将它们从数据库中绑定。看看[这个教程](http://www.ezzylearning.com/tutorial.aspx?tid=8093456)。

取自该网站的示例：

```
<asp:HyperLinkField 
      DataTextField="UnitPrice" 
      DataTextFormatString="GBP {0}" 
      DataNavigateUrlFields="ProductID" HeaderText="Unit Price"
      DataNavigateUrlFormatString="ProductDetails.aspx?ProductID={0}"   /> 
```

# linq - Linq 连接语句

> ID：14635367
> 
> 赞同：0
> 
> 时间：2013-01-31T21:21:24.117
> 
> 标签：linq

我正在尝试从实体模型中的多个表中进行选择。但是我想选择两列，但它没有成功。我的 LINQ 语句是：

```
var searchResult = from i in _imEntities.Issues
                   join dept in _imEntities.Departments
                   on i.Issued_to_dept equals dept.Dept_ID
                   where i.State == 1
                   select new {
                       i.ID_No,
                       i.Issue_Date,
                       Raised_By = dept.Dept_Name
                                       .Where(i.Raised_by_Dept == dept.Dept_ID),
                       Issued_To = dept.Dept_Name
                                       .Where(i.Issued_to_dept == dept.Dept_ID),
                       Details = i.Details
                   }; 
```

列名都是正确的，但我无法将 dept_Names 放入 Raised_By 和 Issued_To 字段。还有其他方法可以执行此操作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:27:46.427

目前尚不清楚您要达到的目标。但是您肯定会尝试对单个名称字符串应用*where*过滤器（谓词语法也不正确）。这是有条件地返回和属性`Dept_Name`的查询：`Raised_By``Issued_To`

```
var query = from i in _imEntities.Issues
            join dept in _imEntities.Departments
            on i.Issued_to_dept equals dept.Dept_ID
            where i.State == 1 
            select new {
                i.ID_No, 
                i.Issue_Date, 
                Raised_By = (i.Raised_by_Dept == dept.Dept_ID) ? dept.Dept_Name : null,
                Issued_To = (i.Issued_to_dept == dept.Dept_ID) ? dept.Dept_Name : null, 
                Details = i.Details
            }; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:31:21.537

试试这个：

```
var query = from i in _imEntities.Issues
            join dept_r in _imEntities.Departments
            on i.Issued_to_dept equals dept_r.Dept_ID
            join dept_i in _imEntities.Departments
            on i.Issued_to_dept equals dept_i.Dept_ID
            where i.State == 1 
            select new {
                i.ID_No, 
                i.Issue_Date, 
                Raised_By = dept_r.Dept_Name,
                Issued_To = dept_i.Dept_Name, 
                Details = i.Details
            }; 
```

# exception-handling - 从原始渲染异常渲染 500 屏幕时避免双重渲染错误

> ID：14635369
> 
> 赞同：1
> 
> 时间：2013-01-31T21:21:28.993
> 
> 标签：exception-handling, ruby-on-rails-2

在我的应用程序控制器中，我有这个来捕获所有其他未捕获的异常......

```
 if Rails.env != "test"
     rescue_from Exception, :with => :render_500
 end 
```

它很好地捕获异常并调用我的“render_500”操作，该操作将异常记录到数据库中，然后呈现包含异常参考 GUID 的自定义 500 页面（因此我可以稍后查找详细信息）。

我遇到的问题是，如果在渲染页面时发生捕获的异常（例如，视图中的错误代码，视图中引用的未定义变量），我最终会因为双重渲染错误而触发第二个异常。

关于如何在渲染 500 页面时避免这种双重渲染错误的想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T13:39:00.513

通过第二次渲染避免双重渲染错误的方法似乎是检查是否已经存在`response body`...

```
render unless response_body 
```

因为，如果我理解正确，您希望第二个渲染替换第一个渲染，您可以尝试用`response_body`您自己的替换现有的。由于`response_body`是一个字符串数组，您可能可以使用[render_to_string](http://apidock.com/rails/ActionController/Base/render_to_string)然后替换响应正文，如：

```
def render_500
   ...stuff...
   response = render_to_string "myController/view"
   status = 500
   unless response_body
     render :inline=> response
   else
     response_body = [response]
   end
end 
```

加上您需要调整的任何其他标题。这没有经过测试，感觉有点不愉快，但我认为它应该可以工作。我很高兴听到是否有更清洁的方法。

# salesforce - Apex 创建任务说成功，但数据库没有新记录

> ID：14635372
> 
> 赞同：1
> 
> 时间：2013-01-31T21:21:50.340
> 
> 标签：salesforce, apex-code

我试图通过 apex 创建一个任务。测试工作说它是成功的。但是，当我从 Task 导出数据时，没有其他行。我无法从调试日志中判断是否有任何问题。任务上没有自定义的验证规则。请帮助并提供一种方法来解决销售队伍环境中的这种情况。

这是测试代码：

```
@isTest(SeeAllData=true) class HelloWorldTestClass {
    static testMethod void validateHelloWorld() {

       Task newTask = new Task(Description = 'test task',
                                    Priority = 'Normal', 
                                    Status = 'Not Started', 
                                    Subject = 'Other', 
                                    WhoId = '003P000000dnR35IAE',
                                    WhatId = '001P000000Zc5G6',
                                    Type = 'Internal Action',
                                    ActivityDate = system.today());             
       insert newTask;

    }
} 
```

这是调试日志：

```
26.0 APEX_CODE,DEBUG;APEX_PROFILING,INFO;CALLOUT,INFO;DB,INFO;SYSTEM,DEBUG;VALIDATION,INFO;VISUALFORCE,INFO;WORKFLOW,INFO
13:24:30.080 (80288000)|EXECUTION_STARTED
13:24:30.080 (80360000)|CODE_UNIT_STARTED|[EXTERNAL]|01pP00000000ziy|HelloWorldTestClass.validateHelloWorld
13:24:30.080 (80837000)|METHOD_ENTRY|[2]|01pP00000000ziy|HelloWorldTestClass.HelloWorldTestClass()
13:24:30.080 (80852000)|METHOD_EXIT|[2]|HelloWorldTestClass
13:24:30.102 (102146000)|SYSTEM_METHOD_ENTRY|[15]|System.today()
13:24:30.102 (102204000)|SYSTEM_METHOD_EXIT|[15]|System.today()
13:24:30.102 (102294000)|DML_BEGIN|[23]|Op:Insert|Type:Task|Rows:1
13:24:30.115 (115312000)|ENTERING_MANAGED_PKG|APXTConga4
13:24:30.215 (215194000)|DML_END|[23]
13:24:30.267 (215259000)|CUMULATIVE_LIMIT_USAGE
13:24:30.267|LIMIT_USAGE_FOR_NS|(default)|
  Number of SOQL queries: 0 out of 100
  Number of query rows: 0 out of 50000
  Number of SOSL queries: 0 out of 20
  Number of DML statements: 1 out of 150
  Number of DML rows: 1 out of 10000
  Number of code statements: 2 out of 200000
  Maximum heap size: 0 out of 6000000
  Number of callouts: 0 out of 10
  Number of Email Invocations: 0 out of 10
  Number of fields describes: 0 out of 100
  Number of record type describes: 0 out of 100
  Number of child relationships describes: 0 out of 100
  Number of picklist describes: 0 out of 100
  Number of future calls: 0 out of 10
13:24:30.267|LIMIT_USAGE_FOR_NS|APXTConga4|
  Number of SOQL queries: 0 out of 100
  Number of query rows: 0 out of 50000
  Number of SOSL queries: 0 out of 20
  Number of DML statements: 0 out of 150
  Number of DML rows: 0 out of 10000
  Number of code statements: 2 out of 200000
  Maximum heap size: 0 out of 6000000
  Number of callouts: 0 out of 10
  Number of Email Invocations: 0 out of 10
  Number of fields describes: 0 out of 100
  Number of record type describes: 0 out of 100
  Number of child relationships describes: 0 out of 100
  Number of picklist describes: 0 out of 100
  Number of future calls: 0 out of 10
13:24:30.267|CUMULATIVE_LIMIT_USAGE_END
13:24:30.215 (215338000)|CODE_UNIT_FINISHED|HelloWorldTestClass.validateHelloWorld
13:24:30.215 (215346000)|EXECUTION_FINISHED 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:44:16.917

测试用例从不提交它们的数据库事务，因此您将无法在测试代码之外看到此记录。

# coldfusion - 在 cfloop 中对查询进行分组

> ID：14635376
> 
> 赞同：1
> 
> 时间：2013-01-31T21:22:11.400
> 
> 标签：coldfusion, coldfusion-8, cfquery, cfloop

我正在寻找循环查询，并想使用分组，就像使用`cfoutput`. 我知道 CF10 添加了该支持，但是是否有模拟该行为的脚本以便可以轻松地迭代项目？

* * *

**编辑：**`cfloop`有一些方法可以通过重新排列标签 来解决缺少分组的问题`cfoutput`，因此它们不是嵌套的。我正在寻找`cfloop`解决方法的原因是嵌套时`cfoutput`，您需要使用来自同一查询的结果。我想使用我自己的 QoQ 并循环查看结果。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:17:53.933

好的，所以你想做这样的事情：

```
<cfoutput query="query1">
    <!--- stuff --->
    <cfoutput query="query2" group="col>
        <!--- more stuff --->
        <cfoutput>
            <!--- still more stuff --->
        </cfoutput>
        <!--- almost the last stuff --->
    </cfoutput>
    <!--- last stuff --->
</cfoutput> 
```

?

第二个循环给你一个错误：

```
Invalid tag nesting configuration.

A query driven cfoutput tag is nested inside a cfoutput tag that also has a query attribute. This is not allowed. Nesting these tags implies that you want to use grouped processing. However, only the top-level tag can specify the query that drives the processing. 
```

您应该能够将其修改为：

```
<cfloop query="query1">
    <cfoutput>
        <!--- stuff --->
    </cfoutput>
    <cfoutput query="query2" group="col>
        <!--- more stuff --->
        <cfoutput>
            <!--- still more stuff --->
        </cfoutput>
        <!--- almost the last stuff --->
    </cfoutput>
    <cfoutput>
        <!--- last stuff --->
    </cfoutput>
</cfloop> 
```

如果必须，还有另一个选项可以模拟组循环。但这是一堆思考和打字，如果可能的话，我宁愿避免，所以让我知道这种方法是否首先有效。

# java - Java 硬件加速不适用于英特尔集成显卡

> ID：14635377
> 
> 赞同：9
> 
> 时间：2013-01-31T21:22:14.047
> 
> 标签：java, hardware, hardware-acceleration, integrated

大家好，我希望有人可以帮助我解决这个问题。我无法让硬件加速在配备英特尔集成显卡的笔记本电脑上工作。

# 问题：

在使用带有 JFrame 的 BufferStrategy 的 Windows 7 和 8 机器上，使用 Java 7 更新 11 的硬件加速似乎无法与英特尔集成显卡一起使用。

* * *

# 细节

显卡：Intel(R) HD Graphics 4000
JRE：Java 7 Update 11
操作系统：Windows 7、Windows 8

* * *

# 预期成绩

![预期结果的图像 (http://i.stack.imgur.com/PmCoZ.png)。](../Images/16fc1f212dee993f189e0040f17bf17b.png)

* * *

# 实际结果

![实际结果的图像 (http://i.stack.imgur.com/P3gkb.png)。](../Images/6cb1db5743d049ee17525f73ca9c87e8.png)

* * *

# 资源

如果您想验证问题，您可以下载我为测试创建的应用程序：http: [//ndcubed.com/downloads/GraphicsTest.zip](http://ndcubed.com/downloads/GraphicsTest.zip)

如果您不喜欢下载已编译的 JAR 文件，您可以使用自己编译应用程序以下源代码：

```
package graphicstest;

import javax.swing.*;
import java.awt.*;
import java.awt.image.BufferStrategy;

public class GraphicsTest extends JFrame {

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new GraphicsTest();
            }
        });
    }

    GraphicsConfiguration gc = GraphicsEnvironment.getLocalGraphicsEnvironment().getDefaultScreenDevice().getDefaultConfiguration();
    BufferCapabilities bufferCapabilities;
    BufferStrategy bufferStrategy;

    int y = 0;
    int delta = 1;

    public GraphicsTest() {

        setTitle("Hardware Acceleration Test");
        setSize(500, 300);
        setLocationRelativeTo(null);
        setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);

        setVisible(true);

        createBufferStrategy(2);
        bufferStrategy = getBufferStrategy();

        bufferCapabilities = gc.getBufferCapabilities();

        new AnimationThread().start();
    }

    class AnimationThread extends Thread {
        @Override
        public void run() {

            while(true) {
                Graphics2D g2 = null;
                try {
                    g2 = (Graphics2D) bufferStrategy.getDrawGraphics();
                    draw(g2);
                } finally {
                    if(g2 != null) g2.dispose();
                }
                bufferStrategy.show();

                try {
                    Thread.sleep(16);
                } catch(Exception err) {
                    err.printStackTrace();
                }
            }
        }
    }

    public void draw(Graphics2D g2) {
        if(!bufferCapabilities.isPageFlipping() || bufferCapabilities.isFullScreenRequired()) {
            g2.setColor(Color.black);
            g2.fillRect(0, 0, getWidth(), getHeight());
            g2.setColor(Color.red);
            g2.drawString("Hardware Acceleration is not supported...", 100, 100);
            g2.setColor(Color.white);
            g2.drawString("Page Flipping: " + (bufferCapabilities.isPageFlipping() ? "Available" : "Not Supported"), 100, 130);
            g2.drawString("Full Screen Required: " + (bufferCapabilities.isFullScreenRequired() ? "Required" : "Not Required"), 100, 160);
            g2.drawString("Multiple Buffer Capable: " + (bufferCapabilities.isMultiBufferAvailable() ? "Yes" : "No"), 100, 190);
        } else {
            g2.setColor(Color.black);
            g2.fillRect(0, 0, getWidth(), getHeight());
            g2.setColor(Color.white);
            g2.drawString("Hardware Acceleration is Working...", 100, 100);
            g2.drawString("Page Flipping: " + (bufferCapabilities.isPageFlipping() ? "Available" : "Not Supported"), 100, 130);
            g2.drawString("Full Screen Required: " + (bufferCapabilities.isFullScreenRequired() ? "Required" : "Not Required"), 100, 160);
            g2.drawString("Multiple Buffer Capable: " + (bufferCapabilities.isMultiBufferAvailable() ? "Yes" : "No"), 100, 190);
        }

        y += delta;
        if((y + 50) > getHeight() || y < 0) {
            delta *= -1;
        }

        g2.setColor(Color.blue);
        g2.fillRect(getWidth()-50, y, 50, 50);
    }
} 
```

# 结论

在没有硬件加速的情况下，我创建的许多应用程序需要它在具有集成显卡的机器上运行缓慢。我真的很困惑为什么它不能专门使用这种类型的显卡。无论如何，感谢您阅读所有这些内容，希望我们能够深入了解 :)！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T04:52:17.063

我只是为遇到同样问题的任何人解决了这个问题。它是安装的 JRE 类型。我在 64 位机器上安装了 32 位 JRE 环境，由于某种原因，它没有使用集成的英特尔图形芯片。但是，在安装了适当的 64 位 JRE 后，页面翻转和硬件加速可以与 Intel 集成芯片配合使用。

您可以从以下网址下载其他版本的 JRE：[http ://www.oracle.com/technetwork/java/javase/downloads/jre7-downloads-1880261.html](http://www.oracle.com/technetwork/java/javase/downloads/jre7-downloads-1880261.html)

真的很奇怪，不敢相信我偶然发现了答案。希望这对将来的某人有所帮助:)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-19T20:01:50.863

尝试将环境变量 J2D_D3D_NO_HWCHECK 设置为“true”。

* * *

第一种方法

控制面板->系统->高级系统设置->环境变量->系统变量->新建->

```
 Variable name: J2D_D3D_NO_HWCHECK
         Variable value: true 
```

* * *

第二种方法

在批处理文件中：

```
 set J2D_D3D_NO_HWCHECK=true

         java -jar myapp.jar 
```

* * *

# solr - 索引期间的Solr连接超时？

> ID：14635381
> 
> 赞同：3
> 
> 时间：2013-01-31T21:22:29.120
> 
> 标签：solr, indexing, timeout, connection-timeout, solr4

我有无限超时的 solrj 客户端（Solr4）

```
server.server.setSoTimeout(0)
server.server.setConnectionTimeout(0) 
```

当我索引我的数据时，我在服务器端有很多超时。我在哪里可以更新 solrconfig.xml 或可能的 tomcat 配置中的服务器端超时？

客户端异常：

```
Caused by: java.net.SocketException: Broken pipe
    at java.net.SocketOutputStream.socketWrite0(Native Method)
    at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)
    at java.net.SocketOutputStream.write(SocketOutputStream.java:136) 
```

服务器端异常：

```
 Jan 31, 2013 8:55:54 PM org.apache.solr.common.SolrException log
    SEVERE: org.apache.solr.common.SolrException: Read timed out
        at org.apache.solr.handler.loader.XMLLoader.load(XMLLoader.java:159)
        at org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:92)
        at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:74)
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1699)
Caused by: java.net.SocketTimeoutException: Read timed out
    at java.net.SocketInputStream.socketRead0(Native Method)
    at java.net.SocketInputStream.read(SocketInputStream.java:129)
    at org.apache.coyote.http11.InternalInputBuffer.fill(InternalInputBuffer.java:751) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-04-12T15:42:34.113

*我们对Solr 4*也有同样的问题。在阅读了 Uwe Schindler （*Solr提交者）的*[博客文章后，](http://blog.thetaphi.de/2012/07/use-lucenes-mmapdirectory-on-64bit.html)我们解决了这个问题。

 *使用*Solr 4*和几个*Solr 3*版本，您必须释放重要的 RAM 份额，以便系统可以正确使用[*mmap*系统调用](http://en.wikipedia.org/wiki/Mmap)。这可能很微妙，具体取决于您的系统配置（博客文章提供了大量关于这一点的信息）。在我们的例子中，这解决了问题：我们最终可以索引而没有任何*超时*问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-22T08:26:22.153

tomcat server.xml 配置的信息将解决这个问题。我们得到了相同的堆栈跟踪，下面为我们解决了它： [http ://forums.alfresco.com/ja/node/8458](http://forums.alfresco.com/ja/node/8458)*

# powerpoint - MS PowerPoint：如何将形状的位置和大小转换为屏幕坐标？

> ID：14635383
> 
> 赞同：3
> 
> 时间：2013-01-31T21:22:30.583
> 
> 标签：powerpoint, shape, pixels

我为 PowerPoint (2010) 写了一个小 VBA 宏，当悬停在某个形状上时，它会打开一个带有解释的弹出窗口。这工作正常。唉，再次离开该区域时不会触发任何事件，因此我现在想扩展代码，以便它监视弹出窗口的区域，并且当指针离开该区域时，它会再次删除弹出窗口。

但现在我遇到了一些愚蠢的问题：Shape 的坐标（.Left、.Top、.Width 和 .Height）以一些“文档单位”给出（不知道具体是什么单位）。然而，指针坐标显然是以屏幕像素为单位的。为了能够合理地比较两者以计算指针是在内部还是外部，我需要首先将 Shape 的尺寸转换为屏幕像素。

我在谷歌上搜索了很多，但虽然我最初发现了几个很有希望的代码片段，但这些都不起作用（因为大多数是用于 Excel 和 PowerPoint 显然具有不同的文档模型）。

有没有好心人能给我一个提示或一些参考，如何将形状的尺寸转换为屏幕像素（即考虑缩放、窗口位置、缩放因子等）。

M。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T13:36:12.180

如果有人感兴趣 - 这是我在进一步谷歌搜索后的解决方案：

```
Type POINTAPI
   x As Long
   y As Long
End Type

Type Rectangle
    topLeft As POINTAPI
    bottomRight As POINTAPI
End Type

Private Declare Function GetCursorPos Lib "user32" (lpPoint As POINTAPI) As Long
Private Declare Function GetDeviceCaps Lib "gdi32" (ByVal hDC As Long, ByVal nIndex As Long) As Long
Private Declare Function GetDC Lib "user32" (ByVal hwnd As Long) As Long
Private Declare Function ReleaseDC Lib "user32" (ByVal hwnd As Long, ByVal hDC As Long) As Long

Private Declare Function ClientToScreen Lib "user32" (ByVal hwnd As Long, lpPoint As POINTAPI) As Long

Private Function TransformShape(osh As Shape) As Rectangle
    Dim zoomFactor As Double
    zoomFactor = ActivePresentation.SlideShowWindow.View.zoom / 100

    Dim hndDC&
    hndDC = GetDC(0)
    Dim deviceCapsX As Double
    deviceCapsX = GetDeviceCaps(hndDC, 88) / 72 ' pixels per pt horizontal (1 pt = 1/72')
    Dim deviceCapsY As Double
    deviceCapsY = GetDeviceCaps(hndDC, 90) / 72 ' pixels per pt vertical (1 pt = 1/72')

    With TransformShape
        ' calculate:
        .topLeft.x = osh.Left * deviceCapsX * zoomFactor
        .topLeft.y = osh.Top * deviceCapsY * zoomFactor
        .bottomRight.x = (osh.Left + osh.width) * deviceCapsX * zoomFactor
        .bottomRight.y = (osh.Top + osh.height) * deviceCapsY * zoomFactor
        ' translate:
        Dim lngStatus As Long
        lngStatus = ClientToScreen(hndDC, .topLeft)
        lngStatus = ClientToScreen(hndDC, .bottomRight)
    End With

    ReleaseDC 0, hndDC
End Function

...
Dim shapeAsRect As Rectangle
shapeAsRect = TransformShape(someSape)

Dim pointerPos As POINTAPI
Dim lngStatus As Long
lngStatus = GetCursorPos(pointerPos)

If ((pointerPos.x <= shapeAsRect.topLeft.x) Or (pointerPos.x >= shapeAsRect.bottomRight.x) Or _
    (pointerPos.y <= shapeAsRect.topLeft.y) Or (pointerPos.y >= shapeAsRect.bottomRight.y)) Then
    ' outside:
    ...
Else ' inside
    ...
End If
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T03:31:05.673

> > 形状的坐标（.Left、.Top、.Width 和 .Height）以一些“文档单位”给出（不知道具体是什么单位）。

点。72 磅为英寸。

```
Sub TryThis()
    Dim osh As Shape
    Set osh = ActiveWindow.Selection.ShapeRange(1)
    With ActiveWindow
        Debug.Print .PointsToScreenPixelsX(.Left)
        Debug.Print .PointsToScreenPixelsY(.Top)
    End With
End Sub 
```

# javascript - 移动网站视频页面模态窗口中的链接问题

> ID：14635387
> 
> 赞同：1
> 
> 时间：2013-01-31T21:22:37.463
> 
> 标签：javascript, jquery, css, jquery-mobile, modal-dialog

我有一个移动视频网站，我想在视频页面上显示一个模式窗口。此模式窗口将在视频暂停时显示。在模式内部，它有一个链接。“我的问题是，视频暂停后链接无法点击。” 我不知道如何解决它，但它似乎是 css 问题。

```
#lean_overlay {
position: fixed;
z-index:100;
top: 0px;
left: 0px;
height:100%;
width:100%;
background: #000;
display: none;
} 
```

演示：http: [//jsfiddle.net/asBPR/3/](http://jsfiddle.net/asBPR/3/)

在这个演示中，它在网络浏览器上运行良好。所以请使用您的移动设备访问该页面并单击播放视频然后暂停。暂停后，点击播放器上方的链接，显示模态窗口。您将在模态框内看到一个链接，尝试触摸该链接将其打开。

PS：我只在我的 iPhone 4 上测试过。

# java - 如果字符串包含非法字符，则返回 Java 函数

> ID：14635391
> 
> 赞同：21
> 
> 时间：2013-01-31T21:22:55.060
> 
> 标签：java, regex, string

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-01-31T21:27:33.267

You can make use of [`Pattern`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html) and [`Matcher`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html) class here. You can put all the filtered character in a character class, and use [`Matcher#find()`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#find%28%29) method to check whether your pattern is available in string or not.

You can do it like this: -

```
public boolean containsIllegals(String toExamine) {
    Pattern pattern = Pattern.compile("[~#@*+%{}<>\\[\\]|\"\\_^]");
    Matcher matcher = pattern.matcher(toExamine);
    return matcher.find();
} 
```

`find()` method will return true, if the given pattern is found in the string, even once.

* * *

Another way that has not yet been pointed out is using [`String#split(regex)`](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html#split%28java.lang.String,%20int%29). We can split the string on the given pattern, and check the length of the array. If length is `1`, then the pattern was not in the string.

```
public boolean containsIllegals(String toExamine) {
    String[] arr = toExamine.split("[~#@*+%{}<>\\[\\]|\"\\_^]", 2);
    return arr.length > 1;
} 
```

If `arr.length > 1`, that means the string contained one of the character in the pattern, that is why it was splitted. I have passed `limit = 2` as second parameter to `split`, because we are ok with just single split.

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-01-31T21:27:25.413

> I need the method to scan every character in the string

If you must do it character-by-character, regexp is probably not a good way to go. However, since all characters on your "blacklist" have codes less than 128, you can do it with a small `boolean` array:

```
static final boolean blacklist[] = new boolean[128];

static {
    // Unassigned elements of the array are set to false
    blacklist[(int)'~'] = true;
    blacklist[(int)'#'] = true;
    blacklist[(int)'@'] = true;
    blacklist[(int)'*'] = true;
    blacklist[(int)'+'] = true;
    ...
}

static isBad(char ch) {
    return (ch < 128) && blacklist[(int)ch];
} 
```

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2013-01-31T21:49:12.463

Use a **constant** for avoids recompile the regex in every validation.

```
private static final Pattern INVALID_CHARS_PATTERN = 
                               Pattern.compile("^.*[~#@*+%{}<>\\[\\]|\"\\_].*$"); 
```

And change your code to:

```
public boolean containsIllegals(String toExamine) {
    return INVALID_CHARS_PATTERN.matcher(toExamine).matches();
} 
```

This is the most efficient way with Regex.

* * *

## 回答 #4

> 赞同：8
> 
> 时间：2013-01-31T21:30:19.637

If you can't use a matcher, then you can do something like this, which is cleaner than a bunch of different if statements or a byte array.

```
 for(int i = 0; i < toExamine.length(); i++) {
    char c = toExamine.charAt(i);
    if("~#@*+%{}<>[]|\"_^".contains(c)){
         return true;
    }
 } 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2013-01-31T21:30:48.870

Try the negation of a character class containing all the blacklisted characters:

```
public boolean containsIllegals(String toExamine) {
    return toExamine.matches("[^~#@*+%{}<>\\[\\]|\"\\_^]*");
} 
```

This will return `true` if the string contains illegals (your original function seemed to return `false` in that case).

The caret `^` just to the right of the opening bracket `[` negates the character class. Note that in `String.matches()` you don't need the anchors `^` and `$` because it automatically matches the whole string.

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-31T21:47:31.647

A pretty compact way of doing this would be to rely on the `String.replaceAll` method:

```
public boolean containsIllegal(final String toExamine) {
    return toExamine.length() != toExamine.replaceAll(
            "[~#@*+%{}<>\\[\\]|\"\\_^]", "").length();
} 
```

# php - 在 Javascript 循环中增加 PHP 变量

> ID：14635392
> 
> 赞同：0
> 
> 时间：2013-01-31T21:23:01.367
> 
> 标签：php, javascript, variables, loops, reset

我正在尝试制作一个图表（通过谷歌图表），显示过去 24 小时我服务器上的用户活动。每 15 分钟（通过 cron）获取用户活动的数据并存储在本地数据库中。由于数据库每 15 分钟更新一次，因此该图不是静态的。

该图显然需要一些数字作为输入，以便它可以绘制。这是一个简单的 javascript 工作示例：

```
dataTable.setValue(0, 0, 0);
dataTable.setValue(1, 0, 25.0);
dataTable.setValue(2, 0, 50.0);
dataTable.setValue(3, 0, 75.0);
dataTable.setValue(4, 0, 100.0); 
```

上面的代码将绘制一条从 (x,y) = (0,0) 开始到 (x,y)=(4,100) 结束的对角线

所以我现在要做的是循环 96 次（每 15 分钟更新一次，持续 24 小时 = 15 x 24 = 96）。

所以这是我尝试过的：

```
for(x=0;x<96;x++){ //copy PHP array into javascript array
  javaArray[x] = <?php echo $sqlArray[$count]['clients_online'];?>;
  <?php $cnt++; ?>
}
for (var x=0;x<96;x++){ //draw graph
      dataTable.setValue(x, 0, javaArray[x]);
} 
```

在第一个 for 循环中，我将 PHP 数组**中的数据**（从数据库中获取）传递**到 javascript 数组**中。完成后，我在第二个 for 循环中绘制图形。

$count 变量在 for 循环中正确递增，但我的问题是**它在每次循环后重置**。

我意识到 PHP 是服务器端，而 javascript 是客户端，因此是问题所在，但我该如何解决这个问题？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:30:29.323

可以循环遍历`$sqlArray`，用key作为计数器，每次迭代输出js。

```
<?php
foreach($sqlArray as $count => $val) 
{
?>
    dataTable.setValue(<?php echo $count; ?>,0,<?php echo $val['clients_online']; ?>);
<?php
}
?> 
```

如果您的数据类似于下面的数组，这将起作用

```
Array
(
  [0] => Array
    (
        [clients_online] => 44
    )

  ...
  [95] => Array
    (
        [clients_online] => 66
    ) 
```

你的预期输出应该是这样的

```
 dataTable.setValue(0,0,44);
  ...
  dataTable.setValue(95,0,66); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:42:35.527

对于这些类型的事情，最好进行 Ajax 调用。这允许前端和后端代码的解耦，这是您开始关注的问题之一。

这是您可以用来转储变量的 PHP。让我们称之为`ajax-data-table.php`。如果您的 sqlArray 有不同的布局，您可以相应地更改它。

```
<?php

$sqlArray = array(
    0 => 0.0,
    1 => 25.0,
    2 => 50.0,
    3 => 75.0,
    4 => 100.0,
);

echo json_encode($sqlArray, JSON_FORCE_OBJECT); 
```

当它渲染时，它看起来像这样：

```
{"0":0,"1":25,"2":50,"3":75,"4":100} 
```

然后，您可以使用 JS 使用 AJAX 进行调用。假设你有 jQuery：

```
request = $.getJSON('ajax-data-table.php');
var dataTable = request.responseText.evalJSON(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:25:24.980

首先，我建议将实际时间存储在 DB 中（因此 Google graph 也可以理解它并且可以绘制轴）。但是要解决从 php 到 JS 的数据传递问题，您可以只对数组进行 json_encode，将其传递给 Javascript，例如：

```
<?php
  $data = array (
    array('Iterator', 'Visitors'),
    array(1, 25),
    array(2, 23),
    array(3, 17),
    array(4, 22),
    array(5, 15),
    array(6, 19),
    array(7, 17),
    array(8, 19),
  );
?> 
```

和 JS/HTML 方面

```
var dataTable = <?= json_encode($data); ?>; // <?= is short for <?php echo - always available from 5.4

google.load("visualization", "1", {
    packages: ["corechart"]
});
google.setOnLoadCallback(drawChart);

function drawChart() {

    var data = google.visualization.arrayToDataTable(dataArray);

    var options = {
        title: 'Visitors by 15min iterator'
    };

    var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
    chart.draw(data, options);
} 
```

JSFiddle 示例在这里：http: [//jsfiddle.net/hTKGK/1/](http://jsfiddle.net/hTKGK/1/)

# nfc - 使用覆盖的权限位恢复 Mifare Classic 1k 中的扇区

> ID：14635394
> 
> 赞同：6
> 
> 时间：2013-01-31T21:23:09.177
> 
> 标签：nfc, mifare

我错误地覆盖了我的 Mifare 经典 1k 标签之一的扇区 1 块 7。它用于测试，我在第 7 块中写入的 16 字节数据如下所示：

```
0xaa 0xaa 0xaa 0xaa
0xbb 0xbb 0xbb 0xbb
0xcc 0xcc 0xcc 0xcc  
0xdd 0xdd 0xdd 0xdd

```

如果没有记错的话，通过这样做，我的访问密钥和权限位变为如下：

*   键-A：`0xaa 0xaa 0xaa 0xaa 0xbb 0xbb`
*   键-B：`0xcc 0xcc 0xdd 0xdd 0xdd 0xdd`
*   权限位：-->`0xbb 0xbb 0xcc`

我曾尝试使用`Key-A`和`Key-B`如上所示读取/写入`block 7`. `sector 1`但是我不再能够访问（不能读取或写入）任何块`sector 1`。

我知道所有其他部门（例如`sector 0`和`sectors 2-15`）的密钥并且能够访问它们。

考虑到这种情况，我想知道是否有任何方法可以重置`sector 1`或`block 7`重新获得我的访问权限。非常感谢。

**更新：**

我已经确认上面显示的 Key-A 和 Key-B 都是正确的，我可以使用它们对卡进行身份验证。此外，根据[Mifare Classic 规范](http://www.nxp.com/documents/data_sheet/MF1S50YYX.pdf)（[截图](https://i.imgur.com/agcnHaJ.png)），我的访问位如下：

```
字节 6 = 0xbb = 0b10111011
--------------------------
C2_3 C2_2 C2_1 C2_0 C1_3 C1_2 C1_1 C1_0
  1 1 0 1 1 1 0 1

字节 7 = 0xbb = 0b10111011
--------------------------
C1_3 C1_2 C1_1 C1_0 C3_3 C3_2 C3_1 C3_0
  1 1 0 1 1 1 0 1

```

现在，考虑到规范/屏幕截图，`C1_3`和`C2_3`位`C3_3`启用对`sector-trailer`. 就我而言，对于第 7 块（第 7 区的预告片），它们都设置为`1`. 那么我是否应该没有对该块的写访问权？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T19:34:40.990

一旦访问控制位配置不正确（例如，应该相互补码的位不是互补的，就像您的情况一样），则根本无法再访问该扇区。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-29T20:46:32.813

在您链接的 Mifare 经典规范中说：

> **备注**：每次内存访问时，内部逻辑都会验证访问条件的格式。如果它检测到格式违规，则整个扇区将被不可逆转地阻止。

您的访问字节不会验证格式。下表中**~**表示**倒置**

```
Byte 6 
--------------------------
~C2_3 ~C2_2 ~C2_1 ~C2_0 ~C1_3 ~C1_2 ~C1_1 ~C1_0
  1     0     1     1     1     0     1     1

Byte 7 
--------------------------
 C1_3  C1_2  C1_1  C1_0 ~C3_3 ~C3_2 ~C3_1 ~C3_0
   1     0     1     1     1     0     1     1

Byte 8 
--------------------------
 C3_3  C3_2  C3_1  C3_0  C2_3  C2_2  C2_1  C2_0
   1     1     0     0     1     1     0     0 
```

因此，例如，C2_3 = 1 和 ~C2_3 = 1。它们不是互补的。格式未验证，扇区被不可逆转地阻塞。

在同一个文档中，有一个表（表 7）显示 keyA 始终可以被读取。也许这就是您可以进行身份​​验证的原因。

# r - 为什么读入的变量会比 R 中文件的存储大小消耗更多的内存

> ID：14635395
> 
> 赞同：1
> 
> 时间：2013-01-31T21:23:09.297
> 
> 标签：r, memory, read.table

当我尝试将一个实际大小为 672MB 的大文件读入 R 时，结果发现系统内存使用量从 0.98 G 激增至 3.6 G（我使用的是 4 GB 内存桌面）。这意味着将文件存储到内存中需要数倍的空间，并且在我读入内存不足后我无法进行任何计算。这正常吗？我使用的代码：`a=read.table(file.choose(),header=T,colClasses="integer",nrows=16777777,comment.char="",sep="\t")` 该文件包含 167772XX 行。

gc() 在我跑步之前和之后![在此处输入图像描述](../Images/36541d1e6d57c269eb9b7edc28be067e.png)

不知道这是什么意思。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T23:04:15.813

您的文本文件为 672MB。假设你所有的整数都是 1 位，那么你的 R 对象大约是 2*672MB 是完全合理的。

文本文件中的每个字符为 1 个字节。R 将整数存储在 4 个字节中（请参阅 参考资料`?integer`）。这意味着您的文件包含`"\t"`存储为 1 字节字符的 ~336MB 和 ~336MB 整数。

R 读取这些 1 字节字符，将它们存储为 4 字节整数和... 336*4 = 1344MB。输出的第二行和第二列`gc`读取 1345.6，等于 1344MB + 原始 1.6MB。

# android - 如何在 SQLite 中制作自动表创建器

> ID：14635396
> 
> 赞同：0
> 
> 时间：2013-01-31T21:23:15.783
> 
> 标签：android, database, android-sqlite

是否有任何选项如何在 Android SQL Lite 中制作类似于自动表创建器的东西？我的问题是我想存储多个具有不同名称（由用户选择）和不同列（对用户的要求设置参数）的表。然后能够找到所有这些表并使用它们。这是可能的还是我应该使用不同类型的保存这些数据？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:32:25.040

为什么不使用外键？使用“表名”创建一个表，并在其他表中使用 _id 作为外键。

# javascript - 将返回的 ajax 设置为 done() 给我一个对象

> ID：14635399
> 
> 赞同：1
> 
> 时间：2013-01-31T21:23:28.293
> 
> 标签：javascript, jquery

怎么来的

```
ajaxFunction().done(function(p){
 console.log(p);
}); 
```

`dataType`以 ajaxFunction中指定的 HTML 格式返回数据，但是

```
var data = ajaxFunction().done(function(p){
    console.log(data) 
    //returns what appears to be the entire deferred object
    //to see the returned HTML string, I have to do console.log(data.responseText);
}); 
```

一旦我将它存储在数据中，拥有该对象的实际应用是什么？我可以用它做进一步的事情吗？还是不打算这样使用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T19:27:52.210

您的变量`data`是*由*`ajaxFunction()`.

对它的引用允许您添加更多的`.done`回调和回调，如果您没有内置的错误处理`.fail`，后者会很方便。`ajaxFunction()`

在你的回调函数中，嗯，直接访问该变量是*不寻常*`p`的——你应该使用它。

# python - Python：反转函数的解释

> ID：14635409
> 
> 赞同：0
> 
> 时间：2013-01-31T21:24:10.167
> 
> 标签：python, recursion

我的教授在下面发布了功能。我不完全理解它是如何工作的。有人可以解释一下吗？

```
def rev(a):
    if a == []:
        return []
    else:
        return rev(a[1:]) + [a[0]] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:27:09.923

这样做是递归地反转列表。了解其工作原理的最简单方法是[跟踪执行](http://www.pythontutor.com/visualize.html#code=def+rev%28a%29%3A%0A++++if+a+%3D%3D+%5B%5D%3A%0A++++++++return+%5B%5D%0A++++else%3A%0A++++++++return+rev%28a%5B1%3A%5D%29+%2B+%5Ba%5B0%5D%5D%0A++++%0Ainitial+%3D+%5B1,+2,+3,+4%5D%0Aafter+%3D+rev%28initial%29&mode=display&cumulative=false&heapPrimitives=false&drawParentPointers=false&textReferences=false&py=2&curInstr=2)。

该函数获取字符串并通过返回除第一项 ( ) 之外的所有项的反转版本`a[1:]`并将第一项附加到末尾来解决它。

请注意，这是在实际情况下执行此操作的不好方法（我假设您的教授只是展示了递归的想法），因为 Python 没有针对递归进行优化。相反，使用[内置](http://docs.python.org/2/library/functions.html#reversed)[的`reversed()`](http://docs.python.org/2/library/functions.html#reversed).

此外，它不是特别 Pythonic 的代码。如果*必须*有一个递归解决方案，而不是使用高效、有效、经过良好测试、易于使用的内置解决方案，请考虑：

```
def rev(seq):
    return rev(seq[1:]) + [seq[0]] if seq else [] 
```

*   我们使用三元运算符来压缩`if/else`.
*   替换`a`为`seq`使函数更清晰 - Python 没有严格的类型，因此使用可以为函数提供线索的名称（在本例中为*sequence*），使其更清晰。
*   `a == []`我们还通过简单地检查来替换`seq`。当列表评估为`False`空时，无需与空列表进行比较。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:30:40.513

a 是一个列表。如果 a 是空列表，则返回空列表。如果没有，您将（递归）您的“反向”函数应用于列表但第一个元素，然后附加第一个元素。这样，在每次递归调用 reverse 时，您都会从最右边的元素开始构建反向列表。

这是一个例子：

```
l=[1,4,6,7]

rev(l) returns rev([4,6,7])+[1]
rev([4,6,7]) returns rev([6,7])+[4]
... 
```

最后你有 rev([]) 返回空列表并终止递归调用。

顺便说一句，要反转列表`l`，只需使用

```
l[::-1] 
```

# facebook - 标签应用程序链接无法正常工作

> ID：14635410
> 
> 赞同：0
> 
> 时间：2013-01-31T21:24:14.410
> 
> 标签：facebook, tabs, facebook-page

所以我找到了这篇文章，但它并没有真正回答我的问题......（[Facebook页面标签iframe应用程序不起作用](https://stackoverflow.com/questions/10777511/facebook-page-tab-iframe-app-not-working)）

我已成功将选项卡添加到我的页面并正确显示。问题是由于某种原因标签链接到[https://www.facebook.com/MyPage/app_XXXXXXXXXX](https://www.facebook.com/MyPage/app_XXXXXXXXXX)。当您单击此链接时，它只会打开一个空白画布页面。

但是，当我使用我的应用设置[https://apps.facebook.com/MyAppName](https://apps.facebook.com/MyAppName)中提供的链接时，页面加载得很好。

根据我发现的其他文章（旧文章），iFrame 和 FBML 之间存在设置问题，但这是我昨天（2013 年，FBML 更改后）刚刚创建的全新应用程序。

关于如何使应用程序链接转到正确页面的任何想法？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-01-31T21:38:33.660

[https://raw.github.com/mozillahispano/asksumo-fb/master/doc/2install.png](https://raw.github.com/mozillahispano/asksumo-fb/master/doc/2install.png)

可能是配置问题。应用程序。我将与您分享我的 Facebook 应用程序的一些配置的图像。我希望能帮助你。

# python - Python Unicode解码错误

> ID：14635411
> 
> 赞同：7
> 
> 时间：2013-01-31T21:24:16.120
> 
> 标签：python, python-3.x

我正在编写一个 Python 程序来读取输出到文本文档中的 DOS 树命令。当我到达循环的第 533 次迭代时，Eclipse 给出了一个错误：

```
Traceback (most recent call last):
  File "E:\Peter\Documents\Eclipse Workspace\MusicManagement\InputTest.py", line 24, in  <module>
    input = myfile.readline()
  File "C:\Python33\lib\encodings\cp1252.py", line 23, in decode
   return codecs.charmap_decode(input,self.errors,decoding_table)[0]
UnicodeDecodeError: 'charmap' codec can't decode byte 0x81 in position 3551: character maps  to undefined 
```

我已阅读其他帖子，将编码设置为 latin-1 并不能解决此问题，因为它`UnicodeDecodeError`在另一个字符上返回 a，并且与尝试使用 utf-8 相同。

以下是代码：

```
import os
from Album import *

os.system("tree F:\\Music > tree.txt")

myfile = open('tree.txt')
myfile.readline()
myfile.readline()
myfile.readline()

albums = []
x = 0

while x < 533:
    if not input: break
    input = myfile.readline()
    if len(input) < 14:
        artist = input[4:-1]
    elif input[13] != '-':
        artist = input[4:-1]
    else:
        albums.append(Album(artist, input[15:-1], input[8:12]))
    x += 1

for x in albums:
    print(x.artist + ' - ' + x.title + ' (' + str(x.year) + ')') 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T21:41:45.617

您需要弄清楚`tree.com`使用了什么编码；根据[这篇文章](https://stackoverflow.com/questions/138576/saving-tree-f-a-results-to-a-textfile-with-unicode-support)，可以使用任何 MS-DOS 代码页。

您可以浏览每个[MS-DOS 编码](http://www.kostis.net/charsets/trans130/cpdos.htm)；其中大多数[在 python 标准库中有一个编解码器](http://docs.python.org/3/library/codecs.html#standard-encodings)。我会先尝试`cp437`；`cp500`后者我认为是 cp1252 的 MS-DOS 前身。

将编码传递给`open()`：

```
myfile = open('tree.txt', encoding='cp437') 
```

你真的应该考虑使用`os.walk()`而不是使用`tree.com`这个任务，它至少可以让你不必处理这些问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:34:22.540

在这一行：

```
myfile = open('tree.txt') 
```

您应该指定文件的编码。在 Windows 上尝试：

```
myfile = open('tree.txt',encoding='cp1250') 
```

# javascript - 运行两个版本的 jQuery，无法让“noConflict”工作

> ID：14635412
> 
> 赞同：2
> 
> 时间：2013-01-31T21:24:17.917
> 
> 标签：javascript, jquery

我正在为客户建立一个网站，该网站使用两个版本的 jQuery。一个版本是用于顶部站点导航链接的“熔岩灯”导航效果。另一个版本用于“Smooth Div”图像滑块。我只能让一个或另一个工作，即使我插入“noConflict”脚本，也不能同时工作。此后，我删除了 noConflict 脚本并将其重新上传到服务器。

这是网站：[http ://www.webexplosive.com/spokes](http://www.webexplosive.com/spokes)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:57:51.230

当您声明：

```
var jQuery_1_2_3 = $.noConflict(true); 
```

它删除了`$`jQuery 的别名。所以你不能写：

```
$(function(){
   jQuery_1_2_3(selector).doSomething();
}); 
```

初始`$`值未定义。

需要是：

```
jQuery_1_2_3(function(){
       jQuery_1_2_3(selector).doSomething();
}); 
```

或者（如果想在`$`里面使用`document.ready`）：

```
/* pass "$" to ready handler argemnent*/
jQuery_1_2_3(function($){
       /* can use "$" inside read now*/
       $(selector).doSomething();
}); 
```

API 文档有很好的说明和示例

[http://api.jquery.com/jQuery.noConflict/](http://api.jquery.com/jQuery.noConflict/)

# c++ - 如何检查两个模板参数是否完全相同？

> ID：14635413
> 
> 赞同：7
> 
> 时间：2013-01-31T21:24:19.510
> 
> 标签：c++, templates, c++11

*如何修改以下函数模板，使其返回 42 如果模板参数`T`和`U`完全相同的类型？*

```
template<typename T,typename U>
int Foo()
{
  return 0;
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-31T21:27:52.600

使用[`std::is_same`](http://en.cppreference.com/w/cpp/types/is_same)可以提供所需的行为：

```
#include <type_traits>

template<typename T,typename U>
int Foo()
{
    return std::is_same<T, U>::value ? 42 : 0;
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T21:36:49.820

一种惯用的方法是将工作委托给`detail`命名空间中的辅助函数对象，您可以部分专门`T`化与 相同的情况`U`（或您可以在类模板中使用的任何其他编译时模式）。

```
namespace detail {

template<typename T, typename U>
struct foo
{
     int operator()() const
     {
         return 0;
     }
};

template<typename T>
struct foo<T, T>
{
     int operator()() const
     {
         return 42;
     }
};

} // namespace detail 

template<typename T, typename U>
int Foo()
{
     return detail::foo<T, U>()();
} 
```

对于也具有可推导参数的函数（例如，a will `Foo(T x, U y)`），这结合了函数模板的参数推导功能和类模板的专业化能力，而不需要用户都更聪明（好吧，你需要他们不调用任何东西的约定直接来自`namespace detail`）

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-01T07:27:10.510

只是为了答案的完整性，以下是在没有类的情况下在编译时做出此选择的方法：

```
namespace detail
{
    int Foo(std::true_type)
    {
        return 42;
    }

    int Foo(std::false_type)
    {
        return 0;
    }
}

template <typename T, typename U>
int Foo()
{
    return detail::Foo(std::is_same<T, U>());
} 
```

当两个不同的代码路径对您的参数有不同的要求时（尽管在这种情况下没有要求），这种编译时分支很重要。例如，在一个路径中使用成员函数`x()`，而在另一个路径中`y()`；或者正如您所指出的，甚至是完全“不同”的功能。

对我来说，这比管理班级要简单得多。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T21:38:28.123

那这个呢？

```
#include <iostream>

template<typename T,typename U>
struct Foo {
  int operator()()
  {
    return 0;
  }
};

template<typename T>
struct Foo<T, T> {
  int operator()()
  {
    return 42;
  }
};

int main() {
   std::cout << Foo<int, int>()() << std::endl;
   std::cout << Foo<int, double>()() << std::endl;
} 
```

# excel - Excel 数据透视表计算字段

> ID：14635414
> 
> 赞同：2
> 
> 时间：2013-01-31T21:24:22.673
> 
> 标签：excel, pivot-table

我有一个简单的表格，其中按日期和产品名称列出了一些金额。

```
Month | Product | Amount
-------------------------
05-'12| Prod A  | 10     
05-'12| Prod A  | 3      
05-'12| Prod B  | 4      
05-'12| Prod C  | 13     
05-'12| Prod C  | 5 
```

从这个表中，我派生了一个数据透视表，其中 SUM(Amount) 显示为列总数的百分比。

```
Month | Product | SUM of Amount
--------------------------------
05-'12| Prod A  | 28.89%           
05-'12| Prod B  | 8.89%        
05-'12| Prod C  | 62.22% 
```

到目前为止很好...现在我想在我的数据透视表中添加一个额外的列，它给出了总和字段中百分比值乘以 1000 的结果。添加计算值`=SUM(Amount)*1000`并没有给我正确的值。Excel给了我。

```
Month | Product | SUM of Amount | Field 1 
---------------------------------------------------------
05-'12| Prod A  | 28.89%         | 13,000                     
05-'12| Prod B  | 8.89%          | 4,000                 
05-'12| Prod C  | 62.22%         | 28,00 
```

它不是取百分比值，而是取数量和乘以 1000 的总和。我可以在数据透视表之外做一个简单的公式，但表格的线条会移动很多，所以最好完成它桌子里面。如何做到这一点？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-26T13:57:19.040

您获得的值是实际总和时间 1000。要获得所需的值，您只需为第一列中的数字提供适当的格式 (*1000)。这可以通过#'%%%% 实现，但是这确实显示了很多百分比符号，其中只有一个就足够了。

或者，只需存储每个条目在数据中贡献的百分比并使用它。

# c# - 如果它卡住了如何停止 socket.connect() 函数？

> ID：14635422
> 
> 赞同：2
> 
> 时间：2013-01-31T21:25:08.377
> 
> 标签：c#, multithreading, .net-micro-framework, netduino

我面临停止 socket.connect() 函数的问题。有时我的本地机器和远程机器之间的物理链接可能很好，但由于某种原因，无法访问远程端点，可能是防火墙或远程机器上的端口被关闭。在这种情况下，socket.connection() 函数会卡在那里等待无限长的时间……即使以后禁用防火墙，该函数仍然会永远卡在那里。

所以我试图找到一种方法来在遇到上述情况时停止 socket.connect() 。

问题是我正在使用一个 .net 微框架，其中我没有超时机制或任务或 socket.beginconnect();

我正在尝试使 socket.connect() 本身成为一个线程，并尝试在 2 秒后中止它 (!thread.join(2000))。但是，我不太了解 abort() 函数，而且我听说这是一种不明智的做法，而且它毕竟不起作用。

现在我不知道该怎么办？谁能帮忙？多谢

```
 main function
 {
 m_socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);//Set up socket    
 remoteEndPoint = new IPEndPoint(IPAddress.Parse(IP_add), 30000);
 m_socket.Connect(remoteEndPoint);
 myThread.Start();
        if (!myThread.Join(2000))
         {
          Debug.Print(myThread.ThreadState.ToString());
          myThread.abort();                       
         }
 }

 private static void socket_connect()
    {
        m_socket.Connect(remoteEndPoint);//Connect to remote device  
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T10:57:55.293

建议`Connect`通过忙等待来使呼叫超时。我强烈不同意 a) 这种哲学和 b) WinSock 没有提供更好的方法来解决这个常见问题的命题。

这是一个更好的解决方案：

```
 using (var socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp))
        {
            Task.Factory.StartNew(() =>
                {
                    Thread.Sleep(1000);
                    socket.Close();
                });
            try
            {
                socket.Connect("192.168.2.123", 1234);
            }
            catch (SocketException sex)
            {
                if (sex.ErrorCode == 10038)
                    Console.WriteLine("Timeout");
                else
                    throw;
            }
        } 
```

您自己检测超时并关闭套接字。该程序运行大约需要 1 秒，因此超时机制起作用。

请注意，上面的代码是演示代码，应该使用计时器并且没有竞争。

忙着等待有什么问题？

*   不好维护
*   引入延迟
*   在许多套接字的情况下出现性能问题。在服务器系统上完全无法启动
*   在客户端上，CPU 无法断电并且您会烧电池

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:17:20.233

如果您的框架支持非阻塞连接，您可以尝试此代码。我在 Win7 中为 .net 4 编写了这个。

```
 Socket socket = new Socket(AddressFamily.InterNetwork, SocketType.Stream, ProtocolType.Tcp);
        Console.WriteLine("Trying to connect");
        socket.Blocking = false;
        try
        {
            socket.Connect("8.8.8.8", 5050);
        }
        catch (Exception ex)
        {
            if (ex is SocketException) && ((SocketException)ex).ErrorCode == 10035) // There is a socket problem and this problem is because of being in non-blocking mode? Then this is just a warning
            {
                // Waiting for connection
                int time = 0;
                while (time < 1000) // If it was lower than 1 second
                {
                    // Do what you want
                    if (socket.Connected) // If connected then break
                        break;
                    System.Threading.Thread.Sleep(50); // Wait 50milisec
                    time += 50;
                }
            }
            else
            {
                Console.WriteLine("Failed");
            }
        }

        if (!socket.Connected)
            Console.WriteLine("Aborted");
        else
            Console.WriteLine("Connected"); 
```

# jquery - jQuery outerHeight() 错误 - 在版本以下无法正常工作。1.8.3

> ID：14635425
> 
> 赞同：3
> 
> 时间：2013-01-31T21:25:35.170
> 
> 标签：jquery, height, outerheight

所以我有一个脚本可以在它的 x 轴上均衡其他元素的高度。该脚本运行良好......但仅当我使用 jQuery 1.8.3+ 时。问题似乎是由于`outerHeight()`功能。

我试图找出`outerHeight()`对 1.8.3+ 进行了哪些更新，但我运气不佳。

请参阅this [fiddle](http://jsfiddle.net/norsewulf/82Fuw/)，其中 jQuery 1.8.3 一切正常。

而这个[小提琴](http://jsfiddle.net/norsewulf/QYq4Q/9/)使用 jQuery 1.7.2 脚本中断的地方。

任何人都可以帮助解释为什么会发生问题，并希望能解决我的困境！（理想情况下，我需要它来为 jQuery 1.7.1+ 工作）

为了进一步说明我为什么要使用`outerHeight()`，当其中一个选择器在顶部/底部有边距或填充时`height()`不会起作用。看看我的意思 > [http://jsfiddle.net](http://jsfiddle.net)

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T20:19:59.553

为了解决需要`outerHeight()`在不支持它的 jQuery 版本中添加 setter 的问题，我简单地添加了[jQuery++](http://jquerypp.com/)提供的[以下帮助](https://github.com/jupiterjs/jquerymx/blob/master/dom/dimensions/dimensions.js#L72)器。

```
var weird = /button|select/i, //margin is inside border
getBoxes = {},
    checks = {
        width: ["Left", "Right"],
        height: ['Top', 'Bottom'],
        oldOuterHeight: $.fn.outerHeight,
        oldOuterWidth: $.fn.outerWidth,
        oldInnerWidth: $.fn.innerWidth,
        oldInnerHeight: $.fn.innerHeight
    };
/**
* @add jQuery.fn
*/
$.each({

/**
* @function outerWidth
* @parent dimensions
* Lets you set the outer width on an object
* @param {Number} [height]
* @param {Boolean} [includeMargin=false] Makes setting the outerWidth adjust
* for margin. Defaults to false.
*
* $('#hasMargin').outerWidth(50, true);
*
* @return {jQuery|Number} If you are setting the value, returns the jQuery wrapped elements.
*/
width:
/**
* @function innerWidth
* @parent dimensions
* Lets you set the inner height of an object
* @param {Number} [height]
*/
"Width",
/**
* @function outerHeight
* @parent dimensions
* Lets you set the outer height of an object where: <br/>
* <code>outerHeight = height + padding + border + (margin)</code>.
* @codestart
* $("#foo").outerHeight(100); //sets outer height
* $("#foo").outerHeight(100, true); //uses margins
* $("#foo").outerHeight(); //returns outer height
* $("#foo").outerHeight(true); //returns outer height with margins
* @codeend
* When setting the outerHeight, it adjusts the height of the element.
* @param {Number|Boolean} [height] If a number is provided -> sets the outer height of the object.<br/>
* If true is given -> returns the outer height and includes margins.<br/>
* If no value is given -> returns the outer height without margin.
* @param {Boolean} [includeMargin] Makes setting the outerHeight adjust for margin.
* @return {jQuery|Number} If you are setting the value, returns the jQuery wrapped elements.
* Otherwise, returns outerHeight in pixels.
*/
height:
/**
* @function innerHeight
* @parent dimensions
* Lets you set the outer width on an object
* @param {Number} [height]
*/
"Height" }, function(lower, Upper) {

    //used to get the padding and border for an element in a given direction
    getBoxes[lower] = function(el, boxes) {
        var val = 0;
        if (!weird.test(el.nodeName)) {
            //make what to check for ....
            var myChecks = [];
            $.each(checks[lower], function() {
                var direction = this;
                $.each(boxes, function(name, val) {
                    if (val)
                        myChecks.push(name + direction+ (name == 'border' ? "Width" : "") );
                })
            })
            $.each($.curStyles(el, myChecks), function(name, value) {
                val += (parseFloat(value) || 0);
            })
        }
        return val;
    }

    //getter / setter
    $.fn["outer" + Upper] = function(v, margin) {
        var first = this[0];
if (typeof v == 'number') {
            first && this[lower](v - getBoxes[lower](first, {padding: true, border: true, margin: margin}))
            return this;
        } else {
            return first ? checks["oldOuter" + Upper].call(this, v) : null;
        }
    }
    $.fn["inner" + Upper] = function(v) {
        var first = this[0];
if (typeof v == 'number') {
            first&& this[lower](v - getBoxes[lower](first, { padding: true }))
            return this;
        } else {
            return first ? checks["oldInner" + Upper].call(this, v) : null;
        }
    }
    //provides animations
var animate = function(boxes){
return function(fx){
if (fx.state == 0) {
fx.start = $(fx.elem)[lower]();
fx.end = fx.end - getBoxes[lower](fx.elem,boxes);
}
fx.elem.style[lower] = (fx.pos * (fx.end - fx.start) + fx.start) + "px"
}
}
    $.fx.step["outer" + Upper] = animate({padding: true, border: true})

$.fx.step["outer" + Upper+"Margin"] = animate({padding: true, border: true, margin: true})

$.fx.step["inner" + Upper] = animate({padding: true})

}) 
```

对这个发现非常满意！希望它可以帮助别人。干杯!

# javascript - WebSocket 协议二进制数据字节序

> ID：14635427
> 
> 赞同：6
> 
> 时间：2013-01-31T21:25:42.970
> 
> 标签：javascript, python, websocket, endianness

**我正在编写基于 WebSocket 协议的服务器和客户端。**

服务器是使用 Python 和 Twisted 制作的。

现在我可以将二进制数据从服务器发送到客户端并返回，唯一的问题是，根据一些消息来源，从浏览器发送的二进制数据的字节序是基于机器字节序的。我想确认一下，是真的吗？

如果这是真的，那么我是否应该以某种方式检查客户端有什么字节序并使用他的字节序从/向他读取/发送数据？检查客户端字节序的最佳方法是什么，只需从客户端发送

```
var view_buffer = new UInt8Array(new ArrayBuffer(1));
view_buffer[0] = 1; 
```

这个数据，并在服务器上检查它是否返回 1 或 128？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T21:31:04.657

根据[RFC 6455](https://www.rfc-editor.org/rfc/rfc6455)：

> 多字节长度量以网络字节顺序表示。

网络字节顺序是大端。服务器和客户端都应该使用这个字节顺序，不管它们的本机顺序是什么。

在 Python 中，该[`struct`模块](http://docs.python.org/2/library/struct.html#byte-order-size-and-alignment)可用于确保带有说明符的正确字节顺序`'>'`。我不确定它会如何在 Javascript 中完成。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:28:27.347

Endianess 仅与由多于一个字节组成的数据类型相关。由于您正在使用一组 uint8 字节序，因此并不重要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:31:59.487

要检查字节顺序，您需要发送至少两个字节的值。

您不能仅通过发送单个字节进行检查，因为此时已为您整理好位级字节序。

因此，字节序仅对*字节交换*（如果需要）以及如果您尝试使用特定于字节序的规则打包单个位（例如在 C 中使用位域时）很重要。

如果您的问题与您自己在 WebSocket 有效负载中携带的消息有关，通常的过程是自己选择一个字节顺序，然后执行您必须执行的任何打包或解包操作，以将本机字节顺序转换为您的首选字节顺序。我知道的大多数协议都使用大端序，也就是“网络顺序”。

因此，如果您有一个 16 位值，请使用移位和按位运算符自行将其转换为两个 8 位字节，然后先发送最高字节，然后发送第二个字节。在服务器端，反转该过程。大多数服务器端语言都可以很容易地将值从网络顺序转换为本地字节顺序。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-04-13T16:03:44.607

在[RFC 6455中有关于](https://www.rfc-editor.org/rfc/rfc6455#section-5.5.1)**关闭**消息顺序的注释：

> 如果有正文，正文的前两个字节必须是一个 2 字节无符号整数（按网络字节顺序），表示具有值 /code/ 在第 7.4 节中定义的状态代码。

因此，如果您要在 WS 消息中使用二进制数据，该协议通常会希望您使用大端序。我想这不是强制性的，通过。

如果您想允许其中任何一个，您可以在消息的开头添加一个幻数。那将是 2 个不同的字节，例如 (('M' << 8) | 'G')。如果你收到“M”然后是“G”，它是大端。如果你收到“G”然后是“M”，它是小端。现在每条消息都会告诉你它的字节序。没有更多的猜测工作。

正如 Mark Ransom 在评论中指出的那样，可以从 JavaScript 以任一字节序发送数据，但必须交换所有字节可能很烦人。因此，具有指示当前字节顺序的 2 字节值通常是解决问题的一个非常好的方法。接收数据的服务器可以检查这两个字节并相应地交换 short、int、long int 数据。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-06-08T20:34:04.010

让客户端向服务器发送 126 字节或更多（但小于 65535）（例如 200）的文本消息。Payload_Length 字段将为 126。

然后检查扩展有效负载长度的下两个字节，以确定客户端是否以大端（可能）发送它，或者客户端是否搞砸并以小端格式发送。

对于大端，紧挨着 8 位有效负载长度的字节（应该是 126 表示接下来的两个字节实际上包含实际有效负载长度）应该是 16 位长度的最高有效字节。

# css - IE 中的链接有奇怪的行为

> ID：14635428
> 
> 赞同：0
> 
> 时间：2013-01-31T21:25:42.307
> 
> 标签：css

在我的网页顶部，我有一些由 CSS 格式化的文本链接。在 Chrome 和 Firefox 中，它们的行为正常；在 IE 中，当单击每个链接时，格式会发生变化，文本链接会稍微变大；将链接移到右侧。如果您单击几个链接，最后一个链接会被撞到下一行。这是该问题的链接。 [http://riverswest.com/dl/riverswest-site/index.html](http://riverswest.com/dl/riverswest-site/index.html)

这是CSS代码！链接开始于：#topnav，结束于：#bottom-nav-left 谢谢！

```
/* Color and Font Legend 

font-family: 'Open Sans Condensed', sans-serif;
font-family: 'Open Sans', sans-serif;
font-family: 'Source Sans Pro', sans-serif;

font-family: 'PT Sans', sans-serif;
font-family: 'PT Sans Narrow', sans-serif;
font-family: 'PT Serif', serif;

font-family: 'Droid Sans', sans-serif;
font-family: 'Droid Sans Mono', sans-serif;
font-family: 'Droid Serif', serif;

*/

/* Reset */

html, body { margin: 0; padding: 0; border: 0;  
            background: transparent; font-size:10px; }

div, span, article, aside, footer, header, hgroup, nav, section,
h1, h2, h3, h4, h5, h6, p, blockquote, a, ol, ul, li, 
table, tr, th, td, tbody, tfoot, thead {
margin: 0;
padding: 0;
border: 0;
vertical-align: baseline;
background: transparent;
}

img     { margin:0; padding:0; border:0; }

table, tr, th, td, tbody, tfoot, thead {
margin: 0; padding: 0; border: 0;
vertical-align: baseline;
background: transparent;
}

table { border-collapse: collapse; border-spacing: 0; }

input, select, textarea, form, fieldset {
margin: 0; padding: 0; border: 0;
}

blockquote, q { quotes: none; }

article, aside, details, figcaption, figure, footer, header, hgroup, menu, nav, section      

{   display:block; }

h1, h2, h3, h4, h5, h6, p, li, blockquote, td, th, a, caption, em, strong, strike { 
font-family: Arial, Helvetica, sans-serif;
font-size:100%;
font-weight: normal;
font-style: normal;
line-height: 100%; 
text-indent: 0;
text-decoration: none;
text-align: left;
color: #000;
}

ol, ul, li  { list-style: none; }

img         { max-width:100%; }

/* Global */

html    {   }
body        { background-color:#000;
        -webkit-font-smoothing: antialiased; 
        -webkit-text-size-adjust: 100%;  }

/* Headings */

h1, h2, h3, h4, h5, h6 { font-weight: bold; color: #FFF; }

h1 { font-size:24px; padding-bottom: 5px;  color:#FFF; font-style:italic;
        border-bottom:1px #FFF solid; margin:5px 0px 0px 15px;}
h2 { font-size:20px; }
h3 { font-size:16px; }
h4 { font-size:14px; }
h5 { font-size:14px; }
h6 { font-size:14px; }

h1 img, h2 img, h3 img, h4 img, h5 img, h6 img { margin: 0; }

/* Text Elements */

 p, li, a       { font-family:'Source Sans Pro', Arial, Helvetica, sans-serif; }

 p              { color:#FFF; font-size:12px; line-height:150%; margin:15px 0; }
p .left     { margin: 1.5em 1.5em 1.5em 0; padding: 0; }
p .right        { margin: 1.5em 0 1.5em 1.5em; padding: 0; }

a               { font-size:11px; font-weight:bold;  } 
a:link          { font-size:11px; font-weight:bold;  }
a:visited       { font-size:11px; font-weight:bold;  }
a:active        { font-size:11px; font-weight:bold;  }
a:focus         { font-size:11px; font-weight:bold;  }
a:hover         { font-size:11px; font-weight:bold;  }

 blockquote     { color:#000; font-size:12px; }

strong          { font-weight: bold; }
em           { font-style: italic; }

/* Images */

.image-frame    { padding:0px; border:1px #666 solid; margin:0px 0px 0px 48px; }

/* Lists */

ul li       { color:#000; font-size:12px; }
ol li        { color:#000; font-size:12px; }

li          {   }

ul.square   { list-style: square outside; }
ul.circle   { list-style: circle outside; }
ul.disc     { list-style: disc outside; }

ul          { list-style: none outside; }
ol          { list-style: decimal; }

dl              {   }
dt              {   }
dd              {   }

/* Tables */

table           { width:100%; }

tr          {   }
.odd            { background-color:#eee; }
.even       { background-color:#fff; }

th              { font-weight: bold; }
thead, th       { background: #ccc; }

tbody       {    }

th,td,caption   {   }
caption         {   }

tfoot           {   }
.tfooter        { background-color:#ccc; text-align:center; font-style:italic; }

caption         { background: #efefef; }

/* Miscellaneous */

sup, sub        { line-height: 0; }

abbr, acronym  { border-bottom: 1px dotted #666; }
address         {    }
del             { background:#FFCECE; color:#f00; }

code, pre       { background-color:#FF9; padding:2px 0px; margin:4px 25px;
                font-family:"Courier New", Courier, monospace;                   
          font-size:12px; font-weight:normal; line-height:150%; }

/* Containers */

#outer              { width:960px; margin:0 auto; background-color:#000; }

#wrapper            { width:900px; margin:0 auto; background-color:#000; }

#logo               { margin:30px 0px 10px 0; float:left; }

#social-media       { float:right;  }
#social-media ul    { margin:30px 0px 0px 0px; }
#social-media ul li { float:right;  }
#social-media img   {   }

#topnav             { clear:both;  }
#topnav ul          { border-top:1px #FFF solid; border-bottom: 1px #FFF solid;
                    margin:10px 0; padding:10px 0 } 
#topnav ul li       { display:inline;   }
#topnav ul li a     { padding:0 15px; }

#topnav a:link      { color:#F60;   font-size:11px; font-weight:bold;} 
#topnav a:visited   { color:#F60;   font-size:11px; font-weight:bold;}
#topnav a:active    { color:#9C0;   font-size:11px; font-weight:bold;}
#topnav a:focus     { color:#9C0;   font-size:11px; font-weight:bold;}
#topnav a:hover     { color:#9C0;   font-size:11px; font-weight:bold;}

#banner             {  margin-bottom:30px; }
#slider             {  margin-bottomp:30px; }
/* LOWER NAVIGATION  */

#bottom-nav-left            {float:left; }
#bottom-nav-left ul         { margin:0px 0; padding:7px 0 } 
#bottom-nav-left ul li      { display:inline;   }
#bottom-nav-left ul li a        { padding:0 10px;   }

#bottom-nav-left a:link     { color:#9C0;  font-size:11px; font-weight:bold;}
#bottom-nav-left a:visited  { color:#9C0;  font-size:11px; font-weight:bold;}
#bottom-nav-left a:active   { color:#F60;  font-size:11px; font-weight:bold;}
#bottom-nav-left a:focus    { color:#F60;  font-size:11px; font-weight:bold;}
#bottom-nav-left a:hover    { color:#F60;  font-size:11px; font-weight:bold;}

/* LOWER NAVIGATION SPLIT */

#bottom-nav-right           {float:right; }
#bottom-nav-right ul            { margin:0px 0; padding:7px 0 } 
#bottom-nav-right ul li     { display:inline;   }
#bottom-nav-right ul li a       { padding:0 10px;   }

#bottom-nav-right a:link    { color:#9C0;   font-size:11px; font-weight:bold;}
#bottom-nav-right a:visited { color:#9C0;   font-size:11px; font-weight:bold;}
#bottom-nav-right a:active  { color:#F60;   font-size:11px; font-weight:bold;}
#bottom-nav-right a:focus   { color:#F60;   font-size:11px; font-weight:bold;}
#bottom-nav-right a:hover   { color:#F60;   font-size:11px; font-weight:bold;}

#bottom-nav-border  { clear:both; border-bottom:1px #fff solid; margin:10px 0 0 0;}

#content-wrapper    {    }

#leftnav            {    }
#leftnav h2     {   }
#leftnav h3     {   }
#leftnav p      {   }
#leftnav img        {   }
#leftnav li     {   }
#leftnav a      {   }

#leftnav a:link     { color:#000;   }
#leftnav a:visited      { color:#000;   }
#leftnav a:active       { color:#000;   }
#leftnav a:hover        { color:#000;   }
#leftnav a:focus        { color:#000;   }

#leftside       {    }
#leftside h2        {   }
#leftside h3        {   }
#leftside p     {   }
#leftside img       {   }
#leftside li        {   }
#leftside a     {   }

#rightside      {    }
#rightside h2       {   }
#rightside h3       {   }
#rightside p        {   }
#rightside img      {   }
#rightside li       {   }
#rightside a        {   }

#rightside a:link       { color:#000;   }
#rightside a:visited    { color:#000;   }
#rightside a:active     { color:#000;   }
#rightside a:hover      { color:#000;   }
#rightside a:focus      { color:#000;   }

#content            { clear:both; width:900px;  }

#content h1         {   }
#content h2         {   }
#content h3         {   }
#content p          {  font-weight:normal;  }
#content img        {   }
#content li         {   }
#content a          {   }

#content a:link         { color:#000;   }
#content a:visited      { color:#000;   }
#content a:active       { color:#000;   }
#content a:hover        { color:#000;   }
#content a:focus        { color:#000;   }
#border-bottom          { border-bottom:1px #FFF solid; margin:0 15px 0   

15px;  }

#lower-content          { }
#lower-content img      { margin:20px 0px 0px 33px; border:1px #966 solid;}

 #gallery           {   }

#team           {   }

#faq                {   }

#events         {   }

#bottom-banner      {   }

#footer             { clear:both; margin-top:20px ; border-top:1px #FFF solid;    

padding-bottom:20px; }

#footer p           {   }

#footer a:link          { color:#000;   }
#footer a:visited       { color:#000;   }
#footer a:active        { color:#000;   }
#footer a:hover         { color:#000;   }
#footer a:focus         { color:#000;   }

#box1 {   }

#box2 {   }

#box3 {   }

#box4 {   }

#box5 {   }

#box6 {   }

#box7 {   }

#box8 {   }

#box9 {   }

/* Hide Print Headings */

#print-header       { display:none; }
#print-header h1    { display:none; }
#print-header h2    { display:none; }
#print-header h3    { display:none; }
#print-header p     { display:none; }

#print-footer       { display:none; }
#print-footer h4    { display:none; }

/* Hide Skip Links For Visually Impaired Screen Reader Users */

#skip   { display:none; }

/* Layout Extra */

/* Navigation Extra */

/* Forms */

#form1                  { margin:0 0 0 0;   }

ol li                   { display:block; padding:20px 0px 5px 0px;  

}

form ol                 { list-style-type:none; }

label                   { display: block; margin:10px 0 8px 0; 
                        font-family:Arial, Helvetica, sans-      

serif; font-size:14px;
                        text-transform:uppercase;  } 

input, textarea, select         { display: block; width:400px;
                        pading:5px; }

input                   {   }

textarea                    { height:150px; }

select                  {   }

.submit                 { padding:5px 20px; width:140px; }

/* Miscellaneous  */
.center-text   { font-size:18px; font-style:italic; color:#9C0; text-align:center; }
.copyright-text { font-size:10px; font-style:italic; color:#333; }
.footer-text    { font-size:12px; font-style:normal; color:#FFF; text-align:center; 

}

.title          { font-size:18px; font-weight:bold; color:#333;  }
.subtitle           { font-size:14px; font-style:italic; color:#333;  }

.artist         { font-size:16px; font-weight:bold; color:#333;  }
.author         { font-size:14px font-weight:bold; color:#555;  }
.editor         { font-size:14px font-style:italic; color:#555;  }

.pub-date           { font-size:10px font-style:italic; color:#555; }
.article-date       { font-size:10px font-style:italic; color:#555;  }
.location           { font-size:10px font-style:italic; color:#555;  }

.address            { font-size:10px; font-style:normal; color:#000; }
.city           { font-size:10px; font-style:normal; color:#000; }
.telephone      { font-size:10px; font-style:normal; color:#000; }
.email          { font-size:10px; font-style:normal; color:#000; }
.website            { font-size:10px; font-style:normal; color:#000; }

.float-right        { float:right; }
.float-left     { float:left; }
.clear          { clear:both; }

.left           { text-align:left; }
.center         { text-align:center; }
.right          { text-align:right; }

.hide           { display:none; }
.block          { display:block; }
.inline         { display:inline; }
.inline-block       { display:inline-block; }
.inline-table       { display:inline-table; }

.first          { font-weight:bold; }
.last           { font-weight:bold; }
.left           { font-weight:bold; text-align:left; }
.right          { font-weight:bold; text-align:right; }

.added              { background:#D7D7FF; }
.removed            { background:#FFCECE; color:#f00; }
.changed            { background:#FFB; }

.red-bg         { background-color:#900; background-   

image:url(../images/bg/red.fw.png); background-repeat:repeat-x; }
.yellow-bg      { background-color:#E6E600; background- 

image:url(../images/bg/yellow.fw.png); background-repeat:repeat-x; }
.orange-bg      { background-color:#F96;    background-

image:url(../images/bg/orange.fw.png); background-repeat:repeat-x; }
.green-bg           { background-color:#393; background-  

image:url(../images/bg/green.fw.png); background-repeat:repeat-x; }
.blue-bg            { background-color:#36F; background-

image:url(../images/bg/blue.fw.png); background-repeat:repeat-x; }
.purple-bg      { background-color:#66F; background-

image:url(../images/bg/purple.fw.png); background-repeat:repeat-x; }

.red-txt        { color:#994D4D; }
.yellow-txt     { color:#FF0; }
.orange-txt     { color:#F90; }
.green-txt      { color:#0F0 }
.blue-txt       { color:#00A5F4; }
.purple-txt     { color:#93F; }

/* Success, info, notice and error/alert boxes - from Blueprint CSS Framework */

 .error, .alert, .notice, .success, .info {
padding: 0.8em; margin-bottom: 1em; border: 2px solid #ddd; }

.error, .alert { background: #fbe3e4; color: #8a1f11; border-color: #fbc2c4; }

.notice     { background: #fff6bf; color: #514721; border-color: #ffd324; }

.success    { background: #e6efc2; color: #264409; border-color: #c6d880; }

.info       { background: #d5edf8; color: #205791; border-color: #92cae4; }

.error a        { color: #8a1f11; }
.alert a        { color: #8a1f11; }

.notice a       { color: #514721; }
.success a      { color: #264409; }
.info a     { color: #205791; } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:51:45.407

将此 CSS 添加到您的 styles.css 文件中：

```
#topnav a:visited {
    font-weight:bold
} 
```

`a`出于某种原因， with上的默认样式`font-weight:bold`在 IE 中没有级联。作为一般提示，您可能希望使用更多类而不是样式元素。它最终会导致奇怪的错误，因为 CSS 应用于您的预期元素，但也适用于非预期元素，因为范围如此之大。我添加`#topnav`了新的 CSS，因此范围将仅限于该部分中的链接。

# matlab - 在Matlab中求解符号方程组

> ID：14635433
> 
> 赞同：0
> 
> 时间：2013-01-31T21:25:47.613
> 
> 标签：matlab, matrix

是否可以在Matlab中符号式地求解以下方程组？例如， a 和 b 未在下面定义：

x1 - (5-a)x2 = 2
2x1 + 5x2 = b
x1+x2+x3=0

Matlab（没有高级库）可以用来解决这个系统吗？我知道 Mathematica 提供了这种可能性，但我被要求在 Matlab 中这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:30:37.423

是的！

[http://www.mathworks.com/help/symbolic/solve.html](http://www.mathworks.com/help/symbolic/solve.html)

它看起来不像 Mathematica 那样酷，但它确实有效。

# javascript - 如何构建这些自定义 Box-shadow css3 效果？

> ID：14635434
> 
> 赞同：1
> 
> 时间：2013-01-31T21:25:53.390
> 
> 标签：javascript, html, css

我试图得到这些 ![在此处输入图像描述](../Images/aba3143603116fb28de64a64805dbaad.png)

这些是我正在使用的标记

```
<ol>
  <li><a>Campo</a>
    <ol>
      <li><a>Informacion Agricola</a></li>
      <li><a>Fabrica</a></li>
    </ol>
  </li>
  <li><a>Gastos Reales Campo</a>
</ol> 
```

我遇到的问题是 box-shadown 没有 3 侧边框效果，我最初的想法是第一个菜单有 3 侧阴影，顶部，左侧和右侧，然后子菜单将具有 4 边框shadown 并位于该菜单后面并稍微向上，因此它被叠加但它不起作用，因为我不能有一个 3 侧框 shadown。

有没有其他最佳方法来制作这些？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:51:23.103

您必须创建三个没有（或很少）模糊的单独阴影，并在三个方向上偏移它们。

有关类似示例，请参[见此答案。](https://stackoverflow.com/a/5363378/212443)

# websphere - 启动服务器 WebSphere 时出错

> ID：14635437
> 
> 赞同：0
> 
> 时间：2013-01-31T21:26:14.710
> 
> 标签：websphere

我正在 RAD 和 websphere 中创建一个 webService。我正在尝试运行该项目，但自从我第一次尝试运行它以来就出现了这个错误。

```
WSVR0221I: application started: ivtApp
SRVE0250I: The Web module PlantsByWebSphere Web Application has been bound to default_host[*:9080,*:80,*:9443].
SRVE0169I: Loading Web Module: Default Web Application.
SRVE0250I: Web Module Default Web Application has been bound to default_host [*: 9080, *: 80, *: 9443].
SRVE0169I: Loading Web Module: adminconsole redirector.
SRVE0250I: Web Module adminconsole redirector has been bound to admin_host [*: 9060, *: 9043].
WSVR0221I: Application started: DefaultApplication
SRVE0169I: Loading Web Module: PlantsByWebSphere Sample Web Application Gallery.
WSVR0221I: Application started: adminconsole
SRVE0250I: Web Module PlantsByWebSphere Sample Gallery Web Application has been bound to default_host [*: 9080, *: 80, *: 9443].
WSVR0221I: Application started: PlantsByWebSphere
TCPC0001I: TCP Channel TCP_1 is listening on host * (IPv4) port 9060.
CHFW0019I: Transport Channel Service has started chain WCInboundAdmin.
TCPC0001I: TCP Channel TCP_2 is listening on host * (IPv4) port 9080.
CHFW0019I: Transport Channel Service has started chain WCInboundDefault.
TCPC0001I: TCP Channel TCP_3 is listening on host * (IPv4) port 9043.
CHFW0019I: Transport Channel Service has started chain WCInboundAdminSecure.
TCPC0001I: TCP Channel TCP_4 is listening on host * (IPv4) port 9443.
CHFW0019I: Transport Channel Service has started chain WCInboundDefaultSecure.
CHFW0019I: Transport Channel Service has started chain SOAPAcceptorChain1.
CHFW0019I: Transport Channel Service has started chain SOAPAcceptorChain2.
CHFW0019I: Transport Channel Service has started chain SOAPAcceptorChain3.
CHFW0019I: Transport Channel Service has started chain SOAPAcceptorChain4.
SCHD0077I: The Scheduler Service is starting the planners.
SCHD0078I: The Scheduler Service has completed starting the planners.
ADMC0026I: The RMI Connector is available at port 2809
WKSP0023I: Workspace configuration consistency check is enabled.
WSVR0001I: Server server1 open for e-business
SRVE0242I: [transfer]: Initialization successful.
WKSP0023I: Workspace configuration consistency check is enabled.
WKSP0023I: Workspace configuration consistency check is enabled.
WKSP0023I: Workspace configuration consistency check is enabled.
WKSP0023I: Workspace configuration consistency check is enabled.
WKSP0023I: Workspace configuration consistency check is enabled.
at org.apache.soap.server.ServerUtils.readEnvelopeFromInputStream (Unknown Source)
at com.ibm.ws.management.connector.soap.SOAPUtils.extractSoapCall (SOAPUtils.java: 91)
at com.ibm.ws.management.connector.soap.SOAPConnector.service (SOAPConnector.java: 107)
at com.ibm.ws.management.connector.soap.SOAPConnection.handleRequest (SOAPConnection.java: 55)
at com.ibm.ws.http.HttpConnection.readAndHandleRequest (HttpConnection.java: 641)
at com.ibm.ws.http.HttpConnection.run (HttpConnection.java: 469) 
```

我真的很感激你的帮助。

# wordpress - 通过 .htaccess 从 url 中删除尾随数字

> ID：14635438
> 
> 赞同：1
> 
> 时间：2013-01-31T21:26:23.310
> 
> 标签：wordpress, .htaccess, mod-rewrite

我添加了这条规则

```
RewriteRule ^(.*)-[0-9]+/$ /$1/ [L,QSA] 
```

从 WordPress 网站上的 url 中删除以连字符开头的尾随数字

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
RewriteRule ^(.*)-[0-9]+/$ /$1/ [L,QSA]
</IfModule> 
```

但这似乎没有用，对我来说，正则表达式似乎没问题，但我认为它与其他规则冲突

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T04:14:31.460

你可以试试这个：

```
# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /

# Additional 2 lines to remove the trailing -Number from the URL
RewriteCond %{REQUEST_URI}  ^/(.*)-(?:[0-9]*)?/?$    [NC]
RewriteRule .*   %1        [R=301,L]

RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php   [L]
</IfModule> 
```

额外的 2 行永久重定向

`http://example.com/any/number/of/folders/anything-NUMBER`

到：

`http://example.com/any/number/of/folders/anything`

该`-NUMBER`组合必须是 URL 中的尾随字符串，带有或不带有斜杠。

连字符`-`总是被删除，即使没有数字。如果你想保留它，请更换

`RewriteRule .* %1 [R=301,L]` 和

`RewriteRule .* %1- [R=301,L]`

永久重定向用于在浏览器的地址栏中显示替换 URL。对于静默映射，`R=301`从 [R=301,L] 中删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-31T20:09:50.730

重定向匹配 301 ^(.*)-[0-9]+/?$ $1/

# c# - 作为 RemoteApp 运行时 C# 检索 System.Evironment

> ID：14635441
> 
> 赞同：1
> 
> 时间：2013-01-31T21:26:38.170
> 
> 标签：c#, remoteapp

我将 C# 应用程序设置为在服务器上运行的远程应用程序。

当应用程序运行时，我从 System.Environment 中获取 MyDocuments 文件夹，以保存用户生成的文件。我返回的 MyDocuments 的路径自然是服务器上的路径。

有没有办法获取客户端机器的 MyDocuments 文件夹路径？或者至少以某种方式获取调用远程应用程序的机器的名称（或 IP）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T20:09:05.330

找到了解决方案。

可以使用 \tsclient\\... 访问客户端计算机

我首先将我的应用程序中的 MyDocuments 路径默认为 Environment.SpecialFolder.MyDocuments 这当然是远程应用程序的“服务器”的机器。然后我检查客户端计算机上以下文件夹的存在和写入访问级别

```
\\tsclient\C\Users\<username>\Documents
\\tsclient\C\Users\<domainname>.<username>\Documents
\\tsclient\D\Users\<username>\Documents
\\tsclient\D\Users\<domainname>.<username>\Documents 
```

然后对于 XP...

```
\\tsclient\C\Documents and Settings\<username>\Documents
\\tsclient\D\Documents and Settings\<username>\Documents 
```

如果这些都不存在，那么我使用远程应用程序的“服务器”上的文件夹。

不是最优雅的，但它有效。

# c# - 如何添加/删除动态创建的用户控件

> ID：14635443
> 
> 赞同：2
> 
> 时间：2013-01-31T21:26:40.720
> 
> 标签：c#, asp.net, dynamic, user-controls, webforms

因此，我试图通过详细说明我在网上找到的一个示例来动态添加和删除页面上的用户控件，该示例展示了如何动态添加用户控件。但我似乎无法让移除工作正常进行。我遵循的程序大致是......

*   在主页中，当单击添加按钮时，我创建一个用户控件并将其`deleteBtnClk`事件实例分配给 method `deleteBtn_Click(object sender, EventArgs e)`，我`ucSimpleControl_deleteBtnClk`从后面的主页代码中传递方法

    ```
    protected void btnAddControl_Click(object sender, EventArgs e)
    {
        // Create instance of the UserControl SimpleControl
        usercontrols.SimpleControl ucSimpleControl =
          LoadControl("~/usercontrols/SimpleControl.ascx")
          as usercontrols.SimpleControl; 
    ```

    …………

    ```
     ucSimpleControl.deleteBtnClk +=
            new usercontrols.deleteBtn_Click(ucSimpleControl_deleteBtnClk); 
    ```

我也这样做是方法后面的代码`CreateUserControl(string controlID)`，它是从`OnPreInit`方法调用的......

```
 protected override void OnPreInit(EventArgs e)
        {
  ...
  ...
  ...
        if ((control != null && control.ClientID ==
                        btnAddControl.ClientID) || createAgain)
        {
        ...
        ...
        ...

            CreateUserControl(controlID);
        } 
```

我的用户控件中删除按钮的 OnClick 方法设置为 deleteBtn_Click

```
 protected void deleteBtn_Click(object sender, EventArgs e)
    {
        onDelBtnClk(e);
    } 
```

它调用虚拟方法 onDelBtnClk

```
 protected virtual void onDelBtnClk(EventArgs e)
        {
            deleteBtnClk(this, e);
        } 
```

并将 this 和 eventargs 传递给委托，在用户控件创建和呈现时将其分配给方法 ucSimpleControl_deleteBtnClk 后面的代码

```
 void ucSimpleControl_deleteBtnClk(object sender, EventArgs e)
        {
            usercontrols.SimpleControl ucSimpleControl =
                ((usercontrols.SimpleControl)(sender));
            ucSimpleControl.Parent.Controls.Remove(ucSimpleControl);
            Session.Remove((ucSimpleControl.Num).ToString());
            CreateUserControl(controlID);
        } 
```

在这里，我尝试通过获取父控件并以发送方用户控件作为参数调用 Controls.Remove 方法来删​​除用户控件。然后我从 Session 中移除与用户控件关联的键值对，最后再次调用 CreateUserControl 来渲染 Session 中的所有用户控件。但是这种行为很奇怪，只删除了最近创建的用户控件，而不是与单击的删除按钮关联的那个，而且在我删除一个用户控件后，我不能添加超过当时存在的用户控件的数量这页纸。例如，如果页面上有 5 个用户控件，我删除了一个，然后尝试添加更多，我将无法添加超过 5 个，尽管我应该可以添加无限多个。这是完整的来源...

显示页面.aspx.cs

```
namespace UserControls4
{
    public partial class DisplayPage : System.Web.UI.Page
    {
    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void btnAddControl_Click(object sender, EventArgs e)
    {
        // Create instance of the UserControl SimpleControl
        usercontrols.SimpleControl ucSimpleControl =
          LoadControl("~/usercontrols/SimpleControl.ascx")
          as usercontrols.SimpleControl;

        // Set the Public Properties
        ucSimpleControl.FirstName.Text = "Milind";
        ucSimpleControl.LastName.Text = "Chavan";

        //Create Event Handler for btnPost Click 
        ucSimpleControl.btnPostClk +=
                new usercontrols.btnPost_Click(ucSimpleControl_btnPostClk);
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////
        ucSimpleControl.deleteBtnClk +=
            new usercontrols.deleteBtn_Click(ucSimpleControl_deleteBtnClk);
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////

        //Add the SimpleControl to Placeholder
        Placeholder1.Controls.Add(ucSimpleControl);

        // Add the instance of the SimpleControl to Session Variable
        Session.Add((Session.Count + 1).ToString(), ucSimpleControl);

        // Set createAgain = true
        createAgain = true;
    }

    void ucSimpleControl_btnPostClk(object sender, EventArgs e)
    {
        usercontrols.SimpleControl ucSimpleControl =
                    ((usercontrols.SimpleControl)(sender));
        lblUser.Text = "Welcome " + ucSimpleControl.FirstName.Text +
                       " " + ucSimpleControl.LastName.Text;
    }

    ///////////////////////////////////////////////////////////////////////////////////////////////////////
    void ucSimpleControl_deleteBtnClk(object sender, EventArgs e)
    {
        usercontrols.SimpleControl ucSimpleControl =
            ((usercontrols.SimpleControl)(sender));
        ucSimpleControl.Parent.Controls.Remove(ucSimpleControl);
        Session.Remove((ucSimpleControl.Num).ToString());
        CreateUserControl(controlID);
    }
    ////////////////////////////////////////////////////////////////////////////////////////////////////////

    // Declare 2 variable to handle user control after postback
    const string controlID = "MyUserControl";
    static bool createAgain = false;

    protected Control GetPostBackControl(Page page)
    {
        Control control = null;
        try
        {
            string ctrlName = page.Request.Params.Get("__EVENTTARGET");

            if (ctrlName != null && ctrlName != String.Empty)
            {
                control = page.FindControl(ctrlName);
            }
            else
            {
                ContentPlaceHolder cph =
                  (ContentPlaceHolder)page.FindControl("Main");
                for (int i = 0, len = page.Request.Form.Count; i < len; i++)
                {
                    string[] ctl = page.Request.Form.AllKeys[i].Split('$');
                    if (ctl.Length > 3)
                    {
                        control = cph.FindControl(ctl[2])
                                  as System.Web.UI.WebControls.Button;
                    }

                    if (control != null) break;
                }
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
        return control;
    }

    protected override void OnPreInit(EventArgs e)
    {
        base.OnPreInit(e);

        Control control = GetPostBackControl(this.Page);

        // Check if the postback is caused by the button 
        // Titled "Click to Create a Dynamic Control"
        // OR
        // createAgain field is true 
        // which means a call is made to the server while the 
        // user control is active  

        if ((control != null && control.ClientID ==
                        btnAddControl.ClientID) || createAgain)
        {
            //should be set before the CreateUserControl method
            createAgain = true;

            CreateUserControl(controlID);
        }
    }

    protected void CreateUserControl(string controlID)
    {
        // createAgain field is set to true in the OnPreInit method
        // when the 'Create User Control' button is clicked 

        // the createAgain field is used to check if the
        // user control is on the page before the call 
        // if so create the control again and add it to the
        // Control Hierarchy again
        try
        {
            if (createAgain && Placeholder1 != null)
            {
                if (Session.Count > 0)
                {
                    Placeholder1.Controls.Clear();
                    int simpleControlCount = 0;
                    for (int i = 0; i < Session.Count; i++)
                    {
                        switch (Session[i].ToString())
                        {
                            case "ASP.usercontrols_simplecontrol_ascx":
                                {
                                    // Keep count of all SimpleControls
                                    simpleControlCount++;
                                    // Create instance of the UserControl SimpleControl
                                    usercontrols.SimpleControl ucSimpleControl =
                                      LoadControl("~/usercontrols/SimpleControl.ascx")
                                      as usercontrols.SimpleControl;

                                    // Set the Public Properties
                                    ucSimpleControl.FirstName.Text =
                                      ((usercontrols.SimpleControl)(Session[i])).FirstName.Text;
                                    ucSimpleControl.LastName.Text =
                                      ((usercontrols.SimpleControl)(Session[i])).LastName.Text;
                                    ucSimpleControl.Num = simpleControlCount;

                                    //Create Event Handler for btnPost Click 
                                    ucSimpleControl.btnPostClk +=
                                      new usercontrols.btnPost_Click(ucSimpleControl_btnPostClk);

                                    /////////////////////////////////////////////////////////////////////////////////////////////////////////
                                    ucSimpleControl.deleteBtnClk +=
                                         new usercontrols.deleteBtn_Click(ucSimpleControl_deleteBtnClk);
                                    //////////////////////////////////////////////////////////////////////////////////////////////////////////

                                    //Add the SimpleControl to Placeholder
                                    Placeholder1.Controls.Add(ucSimpleControl);
                                    break;
                                }
                        }
                    }
                }
            }
        }
        catch (Exception ex)
        {
            throw ex;
        }
    }

} 
```

}

显示页面.aspx

```
<head id="Head1" runat="server">
    <title>This is example of how to add usercontrol dynamically</title>
</head>
<body>
    <form id="form1" runat="server">
    <div>
            <asp:Button ID="btnAddControl" runat="server" 
              Text="Click to add SimpleControl" 
              onclick="btnAddControl_Click" />
            <br />
            <asp:PlaceHolder runat="server" 
           ID="Placeholder1" ></asp:PlaceHolder>
            <br />
            <asp:Label ID="lblUser" 
              runat="server"></asp:Label>
    </div>
    </form>
</body>
</html> 
```

简单控制.ascx.cs

```
namespace UserControls4.usercontrols
{
    public delegate void btnPost_Click(object sender, System.EventArgs e);
    public delegate void deleteBtn_Click(object sendre, System.EventArgs e);

    public partial class SimpleControl : System.Web.UI.UserControl
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        private int num;

        #region Public Event

        public event btnPost_Click btnPostClk;
        public event deleteBtn_Click deleteBtnClk;

        #endregion

        #region Public Properties

        public TextBox FirstName
        {
            get
            {
                return txtFirstName;
            }
            set
            {
                txtFirstName = value;
            }
        }

        public TextBox LastName
        {
            get
            {
                return txtLastName;
            }
            set
            {
                txtLastName = value;
            }
        }

        public int Num
        {
            get { return this.num; }
            set { this.num = value; }
        }
        #endregion

        #region Vitual Methods

        protected virtual void OnbtnDelQtnMrClk(EventArgs e)
        {
            // Call btnPost_Click event delegate instance
            btnPostClk(this, e);
        }

        /// ///////////////////////////////////////////////////////////////////////////////////////
        protected virtual void onDelBtnClk(EventArgs e)
        {
            deleteBtnClk(this, e);
        }

        /// /////////////////////////////////////////////////////////////////////////////////////////

        #endregion

        protected void btnPost_Click(object sender, EventArgs e)
        {
            //Call Virtual Method
            OnbtnDelQtnMrClk(e);
        }

        ///////////////////////////////////////////////////////////////////////////////////////////
        protected void deleteBtn_Click(object sender, EventArgs e)
        {
            onDelBtnClk(e);
        }

    }
} 
```

简单控制.ascx

```
<table>
    <tr>
        <td><asp:Label ID="label1" runat="server" 
            Text="First Name" ></asp:Label></td>
        <td> <asp:TextBox ID="txtFirstName" 
            runat="server"></asp:TextBox></td>
    </tr>
     <tr>
        <td><asp:Label ID="label2" runat="server" 
           Text="Last Name" ></asp:Label></td>
        <td> <asp:TextBox ID="txtLastName" 
           runat="server"></asp:TextBox></td>
    </tr>
    <tr>
        <td><asp:Button ID="btnPost"  runat="server" 
            Text="Send Info" OnClick="btnPost_Click" />
        </td>
    </tr>
</table>
<obout:SuperForm ID="UserControlSuperForm" 
    Width="630" Title="SuperForm"
    AutoGenerateRows="false"
    RunAt="server"
    DefaultMode="Insert"
    FolderStyle="styles/black_glass">
    <Fields>
        <obout:TemplateField HeaderText="SuperForm">
            <EditItemTemplate>
                <asp:TextBox ID="superFormTxt" runat="server"></asp:TextBox>
            </EditItemTemplate>
        </obout:TemplateField>
    </Fields>
</obout:SuperForm>
<asp:Button ID="removeBtn" runat="server" Text="Remove" OnClick="deleteBtn_Click"/> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:34:55.957

除了 El Ronnoco 的评论，动态添加和删除控件需要在回发期间添加每个控件，但更重要的是，每个控件都有唯一的 ID。ASP.NET 运行时按 ID 连接事件，因此如果您添加的每个控件都没有唯一 ID，则不会触发事件。

# python - pytz 时区标签以调整模板中打印的日期

> ID：14635446
> 
> 赞同：4
> 
> 时间：2013-01-31T21:26:44.197
> 
> 标签：python, django, datetime, pytz

在我的应用程序中，我使用普通的日期时间对象。在我的模板中：

```
{% load tz %}

{{datetimeobject|timezone:"Europe/Paris"}}

{% timezone "Europe/Paris" %}
{{datetimeobject}}
{% endtimezone %} 
```

这会打印出这样的内容：

```
Dec. 5, 2012, 4 p.m.
Dec. 5, 2012, 3 p.m. 
```

所以时区过滤器会调整日期，但时区标签不会。

这是为什么？以及如何正确使用标签？我的目标是调整整个模板中的所有日期时间对象，而不为模板中打印的每个日期时间对象添加过滤器。

* * *

编辑

我试图让我的 dateobjects 时区知道：

```
offset = timezone('Europe/London')
datetimeobj.replace(tzinfo=offset) 
```

但这并没有帮助 - 仍然是以前的代码，但具有 tz 意识的 datetimeobject 是：

```
Dec. 5, 2012, 4 p.m.
Dec. 5, 2012, 3 p.m. 
```

* * *

已解决：我在上面的代码中有一个错误 - 应该是：

```
offset = timezone('Europe/London')
datetimeobj = datetimeobj.replace(tzinfo=offset) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T23:54:51.793

您说您使用“普通日期时间对象”，但显然它们是[时区天真而不是时区感知](https://docs.djangoproject.com/en/1.7/topics/i18n/timezones/#concepts)。

[时区过滤器](https://docs.djangoproject.com/en/1.7/topics/i18n/timezones/#std:templatefilter-timezone)“强制将单个值转换为任意时区”，而[时区标签](https://docs.djangoproject.com/en/1.4/topics/i18n/timezones/#timezone)只设置当前时区直到`endtimezone`标签。

您`datetimeobject`的时区是天真的，时区过滤器会将其转换为具有默认时区的时区感知日期时间，然后在给过滤器的时区中表示它。

# android - LazyAdapter 复制图像

> ID：14635453
> 
> 赞同：1
> 
> 时间：2013-01-31T21:27:17.443
> 
> 标签：android, multithreading, listview, android-asynctask, android-lazyadapter

我有一个将标题、副标题和图片添加到 ListView 的惰性适配器。最近我在我的 ListView 中注意到我的图像被复制了。

这是我将数组添加到适配器的地方

```
protected void onPostExecute(String result) {                   
    LazyAdapter adapter = new LazyAdapter(Services.this,menuItems);     
    serviceList.setAdapter(adapter);
} 
```

这是我调用异步方法来添加图像的地方（它是一个 url，这就是它在异步方法中的原因）

```
vi.findViewById(R.id.thumbnail).setVisibility(View.VISIBLE);
title.setText(items.get("title")); // Set Title
listData.setText(items.get("htmlcontent")); // Set content          
thumb_image.setBackgroundResource(R.layout.serviceborder);//Adds border
new setLogoImage(thumb_image).execute(); // Async Method call 
```

这是我设置位图图像的地方

```
private class setLogoImage extends AsyncTask<Object, Void, Bitmap> {
        private ImageView imv;            

        public setLogoImage(ImageView imv) {
             this.imv = imv;                 
        }

    @Override
    protected Bitmap doInBackground(Object... params) {
        Bitmap bitmap = null;
        try {               
            bitmap = BitmapFactory.decodeStream((InputStream)new URL(items.get("thumburl")).getContent());

        } catch (MalformedURLException e) {             
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        return bitmap;
    }
    @Override
    protected void onPostExecute(Bitmap result) {           
        imv.setImageBitmap(Bitmap.createScaledBitmap(result, 50, 50, false));
    }
} 
```

该`items`变量是存储我的信息的 HashMap。我得到提供给适配器的数据的位置并将其分配给项目 HashMap。像这样：

```
items = new HashMap<String, String>();
items = data.get(position); 
```

这似乎是随机发生的，大约 30% 的时间在那里看到错误的图片会很烦人，尤其是当我尝试调试时。

任何帮助都会很棒。谢谢

这是一张图片，看看发生了什么 ![在此处输入图像描述](../Images/d6115bad56f486347affbdd0701838af.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:32:46.603

任何时候你有随机发生的事情，并且你有任何类型的线程，你应该认为两个工作，Race Condition。基本上，您的 AsyncTasks 都在加载相同的图像。它们应该传入要加载的值。我注意到你没有对参数做任何事情。我不确定你应该做什么，但问题出在你的 AsyncTask 中。

```
@Override
protected Bitmap doInBackground(Object... params) {
    Bitmap bitmap = null;
    try {               
        bitmap = BitmapFactory.decodeStream((InputStream)new URL(items.get("thumburl")).getContent());

    } catch (MalformedURLException e) {             
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return bitmap;
} 
```

您可能应该传入 URL（或它所代表的字符串）。在此示例中，我传入了 URL，但您可以随意更改它。关键是，您应该将图像位置的表示传递给函数，而不是在函数中尝试找出要使用的图像。

```
new setLogoImage(new Url(items.get("thumburl"))).execute(); // Async Method call

@Override
protected Bitmap doInBackground(Url... input) {
    Bitmap bitmap = null;
    try {               
        bitmap = BitmapFactory.decodeStream((InputStream)input[0]).getContent());

    } catch (MalformedURLException e) {             
        e.printStackTrace();
    } catch (IOException e) {
        e.printStackTrace();
    }

    return bitmap;
} 
```

# php - Doctrine2 实体问题

> ID：14635472
> 
> 赞同：1
> 
> 时间：2013-01-31T21:28:28.870
> 
> 标签：php, symfony, doctrine-orm

我有以下问题。我正在使用 Symfony2。在我的程序中，我使用了两个类：`Users`和`Posts`. 我的`Post`实体有一个名为`uploader(A User Object)`.

当我尝试插入新的`Post`. 由于某种原因，它不是插入一个与会话中登录的对象`Post`相同的新对象，而是在数据库中插入一个新对象并使用该用户 ID 设置新对象。`User``User``Post`

以下是一些代码示例：

```
/**
  * Posts
  *
  * @ORM\Table(name="posts")
  * @ORM\Entity(repositoryClass="Main\ClientBundle\Entity\PostsRepository")
  */
class Posts {
    /**
     * @var \Users
     *
     * @ORM\ManyToOne(targetEntity="Users",cascade={"persist"})
     * @ORM\JoinColumns({
     *   @ORM\JoinColumn(name="uploader", referencedColumnName="id")
     * })
     */
    private $uploader;

    /**
     * Set uploader
     *
     * @param \Main\ClientBundle\Entity\Users $uploader
     * @return Posts
     */
    public function setUploader(\Main\ClientBundle\Entity\Users $uploader = null)
    {
        $this->uploader = $uploader;

        return $this;
    }
} 
```

这是将新`Post`数据插入数据库的代码：

```
$post = new Posts();
$post->setType(0);
$post->setDate(new \DateTime());
$post->setTitle($postTitle);
$post->setSafeForWork($isSafe);

$session = $this->getRequest()->getSession();
$post->setUploader($session->get('user'));
$post->setImage($hashFileName);

$em = $this->getDoctrine()->getManager();
$em->persist($post);
$em->flush(); 
```

如您所见，用户是从会话中获取的。为什么这段代码会创建一个新`User`实例？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:01:39.477

你应该使用这样的东西

`posts.php`

```
/**
     * @ORM\ManyToOne(targetEntity="Users", inversedBy="posts")
     * @ORM\JoinColumn(name="uploader_id", referencedColumnName="id")
     **/
    protected $uploader; 
```

并且在`Users.php`

```
 /**
     * @ORM\OneToMany(targetEntity="Posts", mappedBy="uploader")
     **/
    protected $posts; 
```

我认为你不需要级联

# ruby-on-rails - 如何在 Capybara finder 中使用正则表达式？

> ID：14635474
> 
> 赞同：9
> 
> 时间：2013-01-31T21:28:30.557
> 
> 标签：ruby-on-rails, ruby, rspec, tdd, capybara

以下效果很好：

```
find "img[src='https://www.example.com/image']" 
```

但我也想找到

```
find "img[src='https://www.example.com/image?foo=bar']" 
```

如何在查找器的属性中使用正则表达式？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-01-31T22:02:58.483

您可以使用以下命令检查属性是否以某个值开头`^=`：

```
find("img[src^='https://www.example.com/image']") 
```

文章[The Skinny on CSS Attribute Selectors](http://css-tricks.com/attribute-selectors/)描述了各种检查（等于、开始于、结束于等）：

```
#Equals
find("img[src='https://www.example.com/image']")

#Contains somewhere
find("img[src*='https://www.example.com/image']")

#Begins with
find("img[src^='https://www.example.com/image']")

#Ends with
find("img[src$='https://www.example.com/image']") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-21T08:34:12.907

您可以使用`class`选项，如`find("div", class: /some-class/)`.

# reporting-services - SSRS Rollup 多个级别和多个汇总

> ID：14635475
> 
> 赞同：1
> 
> 时间：2013-01-31T21:28:30.783
> 
> 标签：reporting-services, reportingservices-2005

我正在尝试为 SSRS 设置汇总，但遇到了一些问题。我有两个要显示的层次结构，但我只能弄清楚如何显示 1。

层次结构 1

分配

地区

领土

层次结构 2

所有产品的总和

产品A/产品B/产品C

现在我有一份报告，可以让我从汇总到 Division 的所有内容开始，当我单击它时，它会下降到 Region 等。问题是我希望能够在另一个层次结构的每个层次上对产品层次结构进行另一个层次的深入研究。

例如，当您处于部门级别时，假设您想具体了解产品 A 的表现，因此您可以单击展开按钮，而不是获取所有 3 种产品的总和，您会看到该值损坏了每个产品。当您处于区域级别和区域级别时，您也可以执行此操作。

我现在能做的是将产品扩展添加到其他层次结构中，例如：

分配

地区

领土

产品

或者

分配

产品

地区

领土

因此，当您到达区域级别时，您可以再次单击并展开到 3 个产品，但这不允许我查看区域或部门级别的产品细分。

有谁知道这是否可能？谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:59:31.367

我很好奇这是否是您的意思，“所以当您到达区域级别时，您可以再次单击并展开到 3 个产品，但这不允许我查看区域或部门级别的产品细分。 " 您的意思是一直向下折叠但不是一次全部展开吗？我的意思是'我可以扩展对前者的依赖'吗？

如果你问我认为你在问什么，你可以设置它。我在 2008 年和 2012 年已经这样做了，但是如果这在 2005 年有效，我就生疏了。通过对父级的分组依赖及其可见性。这让 SSRS 知道只有您要扩展的父级才能扩展。一个简单的例子可能会有所帮助。假设我有一个简单的数据集：

```
declare @Table Table ( personID int identity, person varchar(8), orders int, level1 int, level2 int);

insert into @Table values ('Brett',10, 1,1),('John',20,1,1),('Peter',15,2,1),('Jessica',25, 2,1),('Eddie', 7, 3,1),('Jimi',50, 3,1),('Robert',5, 1,2)

select *
from @Table 
```

1.  我可以定义一个表，然后到目前为止只使用两个值 [person] 和 [Sum(orders)]。
2.  然后我去'行组'>右键单击>添加父组>'分组方式：'level1还添加'添加组标题'
3.  现在您可以在当前空白的 [orders] 上方创建一个单元格值，并将其更改为“[Sum(orders)]”，这现在将仅聚合其分组的订单。但我意识到这仍然没有解决接下来的问题
4.  返回到“行组”>右键单击详细信息>“组属性”>左窗格上的“可见性”>“报表最初运行时”：选择“隐藏”>选中“可以通过此报表项切换显示： '选择'level1'。您现在已将详细信息窗格绑定到它的父对象，以便根据需要为每个父对象折叠，而不是一次全部折叠。因此，您可以一次折叠一个级别。但是等等还有更多......
5.  我可以返回“行组”>右键单击“级别 1”>“添加父组”>“分组方式：”级别 2 并继续为父级添加父级进行层次结构分组。

您可以根据需要再次按照说明操作多个级别。您也可以对带有矩阵的列执行此操作。这些报告的真正力量在于可见性选项，并知道要显示什么和不显示什么，以及如何有效地组织数据并以最终用户可以在需要时获得所需内容的方式呈现。

# javascript - 在 ExtJS 4 的 tabpanel 中，当我点击一个 tab 时，如何捕捉 tabchange 事件？

> ID：14635476
> 
> 赞同：6
> 
> 时间：2013-01-31T21:28:35.427
> 
> 标签：javascript, extjs, tabpanel, floating

对于选项卡面板中的每个选项卡，我都有一个位于固定位置的浮动面板。当我切换标签时，我需要将相应的浮动面板带到前面。但是，tabchange 事件仅在第一次触发。单击选项卡时，如何捕获此选项卡更改或其他类似事件？

Alexey，这是我的示例代码，其中包含更具体的问题：

```
Ext.onReady(function() {
    panel1 = Ext.create('Ext.panel.Panel', {
        title: 'title1', width: 800, height: 50,
        listeners: { 'beforeshow': { fn: function() { 
            console.log("beforeshow on title1"); 
        }, scope: this, single: true } }
    });
    panel2 = Ext.create('Ext.panel.Panel', {
        title: 'title2', width: 800, height: 50,
        listeners: { 'beforeshow': { fn: function() { 
            console.log("beforeshow on title2"); 
        }, scope: this, single: true } }
    });
    panel3 = Ext.create('Ext.panel.Panel', {
        title: 'title3', width: 800, height: 50,
        listeners: { 'beforeshow': { fn: function() { 
            console.log("beforeshow on title3"); 
        }, scope: this, single: true } }
    });
    var tabpanel = Ext.createWidget('tabpanel', {
        renderTo: document.body,
        activeTab: 0,
        width: 800, height: 50, plain: true,
        items: [panel1, panel2, panel3],
        listeners: {
            'tabchange': { fn: function() {
                 console.log("tabchange");
            }, scope: this, single: true }
        }
    });
}); 
```

“tabchange”消息只打印一次。我真正想要的是每次单击选项卡时都显示“在...之前显示”消息。

雷欧，你就是男人！原来我的代码中的问题是“fn”。以下代码通过删除“fn”、“scope”和“single”完美运行。我不知道为什么。谁能解释一下？

```
Ext.onReady(function() {
    panel1 = Ext.create('Ext.panel.Panel', {
      title: 'title1', width: 800, height: 50,
      listeners: { 'beforeshow': function() { console.log("beforeshow on title1"); } }
    });

    panel2 = Ext.create('Ext.panel.Panel', {
      title: 'title2', width: 800, height: 50,
      listeners: { 'beforeshow': function() { console.log("beforeshow on title2"); } }
    });

    panel3 = Ext.create('Ext.panel.Panel', {
      title: 'title3', width: 800, height: 50,
      listeners: { 'beforeshow': function() { console.log("beforeshow on title3"); } }
    });

  var tabpanel = Ext.createWidget('tabpanel', {
    renderTo: document.body,
    activeTab: 0,
    width: 800,
    height: 50,
    plain: true,
    items: [panel1, panel2, panel3],
    listeners: {
        'tabchange': function() {
             console.log("tabchange");
        }
    }
  });
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-01T16:17:31.057

请在事件 tabchange 中附加一个功能

```
Ext.onReady(function () {
    panel1 = Ext.create('Ext.panel.Panel', {
        title: 'title1'

    });
    panel2 = Ext.create('Ext.panel.Panel', {
        title: 'title2'

    });
    panel3 = Ext.create('Ext.panel.Panel', {
        title: 'title3'

    });
    var tabpanel = Ext.createWidget('tabpanel', {
        renderTo: document.body,
        activeTab: 0,
        width: 800,
        height: 50,
        plain: true,
        items: [panel1, panel2, panel3],
        listeners: {
            'tabchange': function (tabPanel, tab) {
                console.log(tabPanel.id + ' ' + tab.id);
            }
        }
    });
}); 
```

**[现场演示在这里](http://jsfiddle.net/UyasD/)**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:52:53.973

您可以尝试在选项卡更改后显示的面板上使用 beforeshow 事件

# c++ - 如果连接到子字符串的 else 语句使用仅导致用户输入的 else 语句

> ID：14635478
> 
> 赞同：0
> 
> 时间：2013-01-31T21:28:38.610
> 
> 标签：c++, if-statement

当我编译代码时，它总是会因为我未知的原因导致最后一个 else 语句。我的时间不多了，所以快速帮助会派上用场。我承诺在我在电子课程中提交作业后立即进行研究。

```
#include <iostream> 
#include <iomanip> 
#include <conio.h> 
#include <string> 
#include <string.h>
using namespace std;

int main()
{   
    string K; 
    cout << "Sisestage isikukood:\n "; 
    getline(cin, K);
                  /* Küsin kasutajalt isikukoodi*/
    std::string(str2) = K.substr (1,1);  
    std::string(str3) = K.substr (2,2);  
    std::string(str4) = K.substr (4,2); 
    std::string(str5) = K.substr (6,2);  
    std::string(str6) = K.substr (8,2);
    cout << "Isikukoodi I andmed:\n ";

    if (str2 == "1") 
    {                  
        cout << " *mees\n"; 
    } 
    else if (str2 == "2") 
    {                  
        cout << " *naine\n"; 
    } 
    else if (str2 == "3") 
    {                  
        cout << " *mees\n";
    } 
    else if (str2 == "4") 
    {                  
        cout << " *naine\n"; 
    } 
    else if (str2 == "5") 
    {                  
        cout << " *mees\n"; 
    } 
    else if (str2 == "6") 
    {   
        cout << " *naine\n";           
    } 

    if (str2 == "2" || str2 == "1") 
    {                  
         cout << "* sundis " << str3 << "." << str4 << "." << "18" << str5; 
    }
    else if (str2 == "3" || str2 == "4") 
    {                  
         cout << "* sundis " << str3 << "." << str4 << "." << "19" << str5; 
    }
    else if (str2== "5" || str2 == "6") 
    {                  
        cout << "* sundis " << str3 << "." << str4 << "." << "20" << str5; 
    }

    if (str6 == "00") 
    {                  
        cout << " * Kuressaare Haigla\n"; /* Leian haigla, kus on isikukoodi omanik sundinud */
    }  
    else if (str6== "02") 
    {                  
        cout << " * Ida-Tallinna Keskhaigla, Hiiumaa, Keila, Rapla haigla\n";
    }     
    else if (str6 == "22") 
    {                  
        cout << " *  Ida-Viru Keskhaigla\n";
    }  
    else if (str6 == "27") 
    {                  
        cout << " *  Maarjamõisa Kliinikum,Jõgeva Haigla \n";
    }  
    else if (str6 == "37") 
    {                  
        cout << " *  Narva  Haigla \n";
    }     
    else if (str6 == "42") 
    {                  
        cout << " *  Pärnu Haigla \n";
    }    
    else if (str6 == "47") 
    {                  
        cout << " * Pelgulinna Sünnitusmaja , Haapsalu haigla \n";
    }              
    else if (str6 == "49") 
    {                  
        cout << " * Järvamaa haigla \n";
    }  
    else if (str6 == "52") 
    {                  
        cout << " * Rakvere, Tapa haigla \n"; 
    } 
    else if (str6 == "57") 
    {                  
        cout<<" * Valga haigla \n"; 
    } 
    else if  (str6 == "60") 
    {                  
        cout << " * Viljandi haigla \n"; 
    }
    else if  (str6 == "65") 
    {                  
        cout<<" *  Lõuna-Eesti Haigla (Võru), Põlva Haigla \n"; 
    }                       
    else
    {
        /*Tulemus,kui isikukood on sisestatud valesti*/ 
        cout << " Sisestasite isikukoodi " << K << " .Palun proovige uuesti.\n";  
    }  
    getch();
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:33:32.307

您可以执行以下操作：

```
 static std::map<std::string, std::string>  message1 = /* Initialize once */;
  static std::map<std::string, std::string>  message2 = /* Initialize once */;

  cout << message1[str2] << "\n";
  cout << message2[str2 + ":" + str6] << "\n"; 
```

# excel - 根据序列删除整行

> ID：14635481
> 
> 赞同：3
> 
> 时间：2013-01-31T21:28:58.313
> 
> 标签：excel, sequence, vba

我有一些从 MYOB 转储的数据需要排序。MYOB 转储的数据格式如下：

*   BSB 编号：000-000
*   银行账号：123456789
*   银行帐户名称：公司名称

我在这些单元格的右侧添加了一个 if 语句，该语句返回一个 1 或 2 或 3 我已确定为序列。

如果不保留 1,2,3 的序列，是否有宏或方法可以删除整行数据？

例子：

*   BSB 编号：000-000 1
*   银行账号：123456789 2
*   银行账户名称：企业名称 3
*   BSB 编号：000-000 1
*   银行账号：123456789 2
*   银行账户名称：企业名称 3
*   BSB 编号：000-000 1
*   银行账户名称：企业名称 3
*   BSB 编号：000-000 1
*   银行账号：123456789 2
*   BSB 编号：000-000 1
*   银行账号：123456789 2
*   银行账户名称：企业名称 3

序列必须保持为 1 然后 2 然后 3。如果序列中断，则必须删除该行。

这可能吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:02:59.427

一个快速的 VBA 宏。假设您的数据是 C 列（=3）。
如果应该删除一行，它将向 D 列写入一个“x”

```
Sub sort()
Application.ScreenUpdating = False
For i = Columns(3).Find("*", [C1], , , , xlPrevious).Row To 4 Step -1

  Merge = Cells(i - 0, 3).Value _
        & Cells(i - 1, 3).Value _
        & Cells(i - 2, 3).Value _
        & Cells(i - 3, 3).Value

  If Merge = "4321" Then
    i = i - 3
  Else
    Cells(i, 4) = "x"
  End If

Next i
Application.ScreenUpdating = True
End Sub 
```

不完美，因为前 4 行没有排序。但它是一个开始。
也许其他人可以改进答案。

![在此处输入图像描述](../Images/f769a950166251a26d936be5bfc94f01.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:28:05.220

我真的很喜欢你的问题并且有点难过 - 为此+1！

我能想出的唯一方法是用一个相当丑陋的公式来列举你的 3 种可能性。假设您在 B 列中有数字，从 cell 开始`B1`，这个公式将从单元格`B4`开始起作用（这意味着您必须自己查看前 3 个结果）。

```
=IF(OR(AND(B4=1,B5=2,B6=3),AND(B3=1,B4=2,B5=3),AND(B2=1,B3=2,B4=3)),TRUE,FALSE) 
```

然后，您可以删除此公式返回`FALSE`值的行。

我仍然会考虑更多并尝试想出一个更优雅的解决方案，但这肯定会成功。

**编辑（基于评论）**

为了允许`4`您的屏幕截图显示，您从公式开始`B5`，它将如下所示：

```
=IF(OR(AND(B5=1,B6=2,B7=3, B8=4),AND(B4=1,B5=2,B6=3,B7=4),AND(B3=1,B4=2,B5=3,B6=4),AND(B2=1,B3=2,B4=3,B5=4)),TRUE,FALSE) 
```

# c++ - 在给定位置可见的类型名称列表

> ID：14635482
> 
> 赞同：3
> 
> 时间：2013-01-31T21:29:00.543
> 
> 标签：c++, libclang

我需要一种方法来以编程方式检索在 C++ 源中的给定位置可见的所有类型名称的列表，即使源不完整（例如正在编辑）。

我了解 LibClang 可能已经在[代码完成](http://clang.llvm.org/doxygen/group__CINDEX__CODE__COMPLET.html)模块的底层创建了这样一个列表，但据我从规范中可以看出，它不会公开它。

现在，我不怕弄脏 Clang 源代码，但是在我开始破解它之前，有没有一种简单的方法可以让我得到我需要的东西？或者，是否有不同的库或*命令行*工具可以让我获取列表？

# android - android在一个片段中映射V2片段不想膨胀

> ID：14635484
> 
> 赞同：0
> 
> 时间：2013-01-31T21:29:09.593
> 
> 标签：android, google-maps, fragment

我有一个带有查看器的操作栏。如果我理解正确，我必须为将在我的操作栏中单击的每个选项卡创建片段。为此，我创建了从 Fragment 继承的 xml 布局文件和类。在`onCreateView`这些课程中，我返回`inflater.inflate(xml_layout, container, false)`。Everyting 工作正常，但我的问题如下。

现在我希望这些片段中的一个是包含地图 V2 片段的布局。

实际上我希望我的片段看起来像下面的 xml：

```
 <LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/fragment_mappart"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:background="@color/grey" >

<LinearLayout
    android:id="@+id/map_heading"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <View
        android:background="@drawable/rectangle_shape"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_marginLeft="50dp" />

    <TextView 
        android:id="@+id/map_title"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@android:color/black"
        android:layout_gravity="bottom"
        android:textSize="16sp"
        android:layout_marginLeft="10dp"
        android:layout_marginBottom="2dp" />

</LinearLayout>

<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/horizontal_layout_map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="horizontal"
    android:layout_marginBottom="50dp" >

    <View 
        android:background="@drawable/rectangle_shape_yellow"
        android:layout_width="50dp"
        android:layout_height="50dp"
        android:layout_marginTop="250dp" />

    <fragment xmlns:android="http://schemas.android.com/apk/res/android"
        android:id="@+id/mapfragment"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        class="com.google.android.gms.maps.SupportMapFragment" />

</LinearLayout>

<View
    android:background="@drawable/rectangle_shape"
    android:layout_width="50dp"
    android:layout_height="50dp"
    android:layout_marginLeft="175dp"
    android:layout_marginTop="-50dp" />

    </LinearLayout> 
```

现在，当我创建一个从 Fragment 扩展并扩展此 xml 的类时，它在我的地图 V2 片段开始的 xml 行上给了我一个错误。

我想说，当我从 SupportMapFragment 扩展并返回`super.onCreateView()`他自己的 onCreateView 时，一切正常，但是我无法控制地图周围的布局。我希望将地图嵌套到我自己的特定布局中。所以，我几乎可以肯定everyting 设置为displat maps V2，但问题确实是我不能将片段膨胀为片段。

我希望我解释得足够好，如果有人可以帮助我，非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:48:24.477

不幸的是，您不能*嵌套*片段，这是您在这里尝试做的。这将是一个方便的功能，我可以在我自己的应用程序中使用它，但要绕过这个限制可能很复杂。

一个视图中的片段可以在同一父层次结构中的不同视图中实例化片段，但它不能在其自己的视图层次结构中实例化片段。

有很多方法可以做你想做的事；你只需要考虑你的设计。

# javascript - id 加 1

> ID：14635485
> 
> 赞同：0
> 
> 时间：2013-01-31T21:29:11.060
> 
> 标签：javascript

我想要以下内容：当用户单击按钮时，id 必须增加 1。现在我使用熟悉的函数来为我的行设置唯一 id，并且可以正常工作。现在我对唯一的输入字段使用了相同的代码片段，但这不起作用。同样奇怪的是，以下代码在 name 属性上正确工作。

```
 clone.find('#dsmeta_image_caption').prop('name', 'dsmeta_image_caption[' + row.length + ']'); // we now need to set the new ID for the row - ID's cannot be duplicated. This again will use the row.length 
```

所以我想要的是将每个字段 id 增加 1。

代码JS：

```
function create_row_event(event) {
    // Declared variable
    var row = jQuery('tbody tr.row');
    var clone = row.last().clone(true);

    // Find the cloned fields and reset the values of it
    clone.find('input[type=text], text, textarea, select, input.upload_image').val(''); // Reset the values
    clone.find('.preview_image').attr('src', ''); // Reset the values

    row.parent('tbody.ui-sortable').append(clone); // Append the new row to the body
    clone.prop('id', 'repeatable-[' + row.length + ']'); // we now need to set the new ID for the row - ID's cannot be duplicated. This again will use the row.length
            clone.find('input#dsmeta_image_caption').prop('id', '[' + row.length + ']');

} 
```

在这里你可以看到代码：http: [//jsfiddle.net/Caspert/ttgMc/7/](http://jsfiddle.net/Caspert/ttgMc/7/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T21:09:43.703

该`find('#id')`操作将不起作用，因为那里涉及重复的 ID。一旦文档中有重复的 ID，您就不能期望基于 ID 的选择器/过滤器能够正常工作。

使用 eg`find('input:text')`代替它会起作用。

# python - 当timedelta.days小于1时在python中确定“天”

> ID：14635486
> 
> 赞同：18
> 
> 时间：2013-01-31T21:29:13.050
> 
> 标签：python, date, datetime, timedelta

如果这很密集，请提前道歉。我试图找出自上次发布推文以来的日子。我遇到的问题是日期不同时，例如今天和昨天，但没有足够的时间过去成为一个完整的“一天”。

```
# "created_at" is part of the Twitter API, returned as UTC time. The 
# timedelta here is to account for the fact I am on the west coast, USA 
lastTweetAt =  result.created_at + timedelta(hours=-8)

# get local time
rightNow = datetime.now()

# subtract the two datetimes (which gives me a timedelta)
dt = rightNow - lastTweetAt

# print the number of days difference
print dt.days 
```

问题是，如果我昨天下午 5 点发布了一条推文，而今天上午 8 点运行脚本，则只过去了 15 个小时，即 0 天。但很明显，如果是昨天，我想说距离我上一条推文已经过去了 1 天。添加“+1”的杂乱无章不会有帮助，因为如果我今天发了推文，我希望结果为 0。

有没有比使用 timedelta 更好的方法来获得差异？

* * *

***Matti Lyra 提供的***解决方案****

 ***答案是在日期时间上调用 .date() ，以便将它们转换为更粗略的日期对象（没有时间戳）。正确的代码如下所示：

```
# "created_at" is part of the Twitter API, returned as UTC time.
# the -8 timedelta is to account for me being on the west coast, USA
lastTweetAt =  result.created_at + timedelta(hours=-8)

# get UTC time for right now
rightNow = datetime.now()

# truncate the datetimes to date objects (which have dates, but no timestamp)
# and subtract them (which gives me a timedelta)
dt = rightNow.date() - lastTweetAt.date()

# print the number of days difference
print dt.days 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-31T21:36:37.497

只处理日期时间的“日期”部分怎么样？

以下代码中输出“0”后的部分：

```
>>> a = datetime.datetime.now()
>>> b = datetime.datetime.now() - datetime.timedelta(hours=20)
>>> (a-b).days
0
>>> b.date() - a.date()
datetime.timedelta(-1)
>>> (b.date() - a.date()).days
-1 
```

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-31T21:35:42.677

您可以使用`datetime.date()`比较两个日期（注意：不是带时间的日期），这会截断`datetime`以具有天而不是小时的分辨率。

```
...
# subtract the two datetimes (which gives me a timedelta)
dt = rightNow.date() - lastTweetAt.date()
... 
```

文档永远是你的朋友

[http://docs.python.org/2/library/datetime#datetime.datetime.date](http://docs.python.org/2/library/datetime#datetime.datetime.date)***

# jquery - 使用 jQuery 从 CDN 加载 Dojo

> ID：14635490
> 
> 赞同：4
> 
> 时间：2013-01-31T21:29:35.410
> 
> 标签：jquery, dojo, cdn

这是我从[文章](http://dojotoolkit.org/documentation/tutorials/1.8/dojo_config/)中获取的示例，并进行了一些更改。这个例子完美地工作

```
<!DOCTYPE HTML>
<html lang="en">
    <head>
        <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dijit/themes/claro/claro.css" media="screen">
        <script type="text/javascript">
            dojoConfig = {
                parseOnLoad: false,
                async: true
            };
        </script>   
        <script src="http://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/dojo.js" type="text/javascript"></script>
        <script type="text/javascript">
            /// Require the registry, parser, Dialog, and wait for domReady
            require(["dijit/registry", "dojo/parser", "dojo/json", "dojo/_base/config", "dijit/Dialog"], function (registry, parser, JSON, config) {
                // Explicitly parse the page
                parser.parse();
                // Find the dialog
                var dialog = registry.byId("dialog");
                // Set the content equal to what dojo.config is
                dialog.set("content", "<b>it works!</b>");
                // Show the dialog
                dialog.show();
            });
        </script>
    </head>
    <body class="claro">
        <div id="dialog" data-dojo-type="dijit.Dialog"></div>
    </body>
</html> 
```

现在我想修改它并使用 jQuery 动态加载 Dojo。这是我如何执行此操作的示例：

```
<!DOCTYPE HTML>
<html lang="en">
<head>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dijit/themes/claro/claro.css" media="screen">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            dojoConfig = {
                parseOnLoad: false,
                async: true
            };

            $.getScript("http://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/dojo.js")
            .done(function (script, textStatus) {
                /// Require the registry, parser, Dialog, and wait for domReady
                require(["dijit/registry", "dojo/parser", "dojo/json", "dojo/_base/config", "dijit/Dialog"], function (registry, parser, JSON, config) {
                    // Explicitly parse the page
                    parser.parse();
                    // Find the dialog
                    var dialog = registry.byId("dialog");
                    // Set the content equal to what dojo.config is
                    dialog.set("content", "<b>it works!</b>");
                    // Show the dialog
                    dialog.show();
                });
            })
            .fail(function (jqxhr, settings, exception) {
                alert('Cannot load Dojo.js');
            });
        });
    </script>
</head>
<body class="claro">
    <div id="dialog" data-dojo-type="dijit.Dialog">
    </div>
</body>
</html> 
```

但看起来我做错了什么，因为它引发了下一个错误

```
NotFoundError: Node was not found
http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js
Line 2 
```

我怀疑 Dojo 还没有准备好，但也许我错了......是否可以使用 jQuery 来动态加载 Dojo？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T11:48:26.167

“未找到节点”错误是由加载程序试图定位加载它的脚本标签引起的。这是 Dojo 在从 CDN（如您使用的谷歌）加载时使用的一种*技巧*，以尝试找到加载模块的 url 路径。

jQuery $.getScript() 函数实际上并不是将脚本标签注入页面，而是通过 XHR 加载然后评估代码。因此，找不到 Dojo 正在寻找的标签。这仅在使用 CDN 时发生。如果您使用自己的 Dojo 本地副本而不是 CDN，则可以使其正常工作。

我不确定通过 jQuery 加载 Dojo 是一种好习惯。最好分别加载它们或以相反的方式加载它们（即在 Dojo 中加载 jQuery）。我假设你需要两者的功能，否则你不会尝试这个。

要将 jQuery 作为 Dojo 模块加载，您可以按如下方式更改代码：

```
<!DOCTYPE HTML>
<html lang="en">
<head>
    <link
        rel="stylesheet"
        href="//ajax.googleapis.com/ajax/libs/dojo/1.8.3/dijit/themes/claro/claro.css"
        media="screen"
    />
    <script type="text/javascript">
        var dojoConfig = {
            "parseOnLoad": false,
            "async": true,
                "packages": [{
                    "name": "jquery",
                    "location": "//ajax.googleapis.com/ajax/libs/jquery/1.9.0",
                    "main": "jquery.min"
                }]
        };
    </script>
    <script
        type="text/javascript"
        src="//ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/dojo.js"
    ></script>
    <script type="text/javascript">
        define.amd.jQuery = true;  // jQuery will be loaded as an AMD module

        require([
            "jquery",
        ], function($){
            // NB: $ is only available within the scope it has been loaded
            // as it is loading as an AMD module.  Hence, $ is not globally
            // available and must be required into any scope it is used.

            $(document).ready(function () {
                require([
                    "dijit/registry",
                    "dojo/parser",
                    "dojo/json",
                    "dojo/_base/config",
                    "dijit/Dialog"
                ], function (registry, parser, JSON, config) {
                    // Explicitly parse the page
                    parser.parse();
                    // Find the dialog
                    var dialog = registry.byId("dialog");
                    // Set the content equal to what dojo.config is
                    dialog.set("content", "<b>it works!</b>");
                    // Show the dialog
                    dialog.show();
                });
            });
        })
    </script>
</head>
<body class="claro">
    <div id="dialog" data-dojo-type="dijit/Dialog">
    </div>
</body>
</html> 
```

坚持使用 Dojo 可能比同时使用两者要好。但是，以上将允许两者一起使用。Dojo，有它自己的准备函数（[dojo/ready](http://dojotoolkit.org/reference-guide/1.8/dojo/ready.html)），可以替代 $(document).ready()。jQuery 的大部分功能都在 Dojo 中的某个庄园中复制。

将 jQuery 作为 Dojo 模块加载意味着它仅在 require 回调中可用。因此，$ 不像通常情况那样被放置在全局范围内。您必须将其要求到您需要的任何 JavaScript 中。

**注意：**我将代码中的 dijit.Dialog 更改为 dijit/Dialog，因为如果您使用点格式，它将不会在 1.8 版中加载。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T15:23:22.170

好的，最后看起来我找到了基于[文章](http://www.nczonline.net/blog/2009/07/28/the-best-way-to-load-external-javascript/)的可靠解决方案......这是工作示例：

```
<!DOCTYPE HTML>
<html lang="en">
<head>
    <link rel="stylesheet" href="http://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dijit/themes/claro/claro.css" media="screen">
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script type="text/javascript">
        function loadScript(url, callback) {
            var script = document.createElement("script")
            script.type = "text/javascript";

            if (script.readyState) {  //IE
                script.onreadystatechange = function () {
                    if (script.readyState == "loaded" ||
                    script.readyState == "complete") {
                        script.onreadystatechange = null;
                        callback();
                    }
                };
            } else {  //Others
                script.onload = function () {
                    callback();
                };
            }

            script.src = url;
            document.body.appendChild(script);
        }

        $(document).ready(function () {
            dojoConfig = {
                parseOnLoad: false,
                async: true
            };

            loadScript("http://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/dojo.js", function () {
                /// Require the registry, parser, Dialog, and wait for domReady
                require(["dijit/registry", "dojo/parser", "dojo/json", "dojo/_base/config", "dijit/Dialog"], function (registry, parser, JSON, config) {
                    // Explicitly parse the page
                    parser.parse();
                    // Find the dialog
                    var dialog = registry.byId("dialog");
                    // Set the content equal to what dojo.config is
                    dialog.set("content", "<b>it works!</b>");
                    // Show the dialog
                    dialog.show();
                });
            });
        });
    </script>
</head>
<body class="claro">
    <div id="dialog" data-dojo-type="dijit.Dialog">
    </div>
</body>
</html> 
```

这不是纯粹的 jQuery 解决方案，但它对我来说更好，然后在页面上包含 Dojo 脚本......

# javascript - 如何在 emberjs 中呈现相同大小的表格

> ID：14635493
> 
> 赞同：0
> 
> 时间：2013-01-31T21:29:49.467
> 
> 标签：javascript, ember.js, handlebars.js

基本上我得到了一个包含 4 个对象的数组，每个对象都包含一个我想渲染到表中的数组。但是子数组的大小不同，我需要表具有相同数量的行（在我没有数据的地方只渲染空的 cels）

数据看起来像这样：

```
App.budgetdata = [
    Ember.Object.create({
        omschrijving: 'Week',
        rules: [
            Em.Object.create({
                omschrijving: 'zakgeld',
                bedrag: 20.00,
                richting: 'af'
            })
        ]
    }),
    Ember.Object.create({
        omschrijving: 'Maand',
        'default': true,
        rules: [
            Em.Object.create({
                omschrijving: 'salaris',
                bedrag: 1300.00,
                richting: 'bij'
            }),
            Em.Object.create({
                omschrijving: 'internet',
                bedrag: 60.00,
                richting: 'af'
            }),
            Em.Object.create({
                omschrijving: 'auto kosten',
                bedrag: 300.00,
                richting: 'af'
            })
        ]
    }),

    Ember.Object.create({
        omschrijving: 'Kwartaal',
        rules: [
            Em.Object.create({
                omschrijving: 'sp',
                bedrag: 5.00,
                richting: 'af'
            })
        ]
    }),
    Ember.Object.create({
        rules: [

        ]
    }),
]; 
```

如何让 emberjs 将其呈现为 4 个具有相同行数的表（所以这些表都有 4 行）？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T20:20:48.897

解决了它，基本上我在数组控制器中为最大大小创建了一个属性，然后我在一个集合视图中显示了子数组，该集合视图绑定了该最大大小。

之后，我可以轻松定义具有相同大小数组的内容属性。

# batch-file - 按体系结构复制和启动可执行文件的批处理文件

> ID：14635495
> 
> 赞同：1
> 
> 时间：2013-01-31T21:29:54.960
> 
> 标签：batch-file, login-script

我正在尝试创建一个登录批处理文件以将 32 位和 64 位可执行文件从服务器复制到用户的本地计算机，然后根据操作系统类型/架构执行这些文件。这是我到目前为止所拥有的，它似乎没有工作，因为它只启动 32 位文件并且没有检测和启动 64 位文件。我是新手，因此将不胜感激。

```
@echo off
c:
MD c:\temp
xcopy \\server\NETLOGON\SEPRemoval c:\temp /e /y
cd c:\temp
if /i "%PROCESSOR_ARCHITECTURE%" EQU "x86" goto ARCH32
if /i "%PROCESSOR_ARCHITECTURE%" EQU "AMD64" goto ARCH64

:ARCH32
start /wait SEPprep.exe
goto done

:ARCH64
start /wait SEPprep64.exe
goto done

:done

timeout 15
cd \
del c:\temp /q
exit 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T19:40:22.327

This is what I finally came up with that works with assistance from some guys over at the Microsoft Scripting Guys forum:

```
@echo off
c:
MD c:\temp
xcopy \\server\NETLOGON\SEPRemoval c:\temp\ /e /y
cd /d c:\temp
if {%PROCESSOR_ARCHITEW6432%} EQU {} (
  set TRUE_ARCH=%PROCESSOR_ARCHITECTURE%
   start /b /wait SEPprep.exe
   goto Done
) else (
  set TRUE_ARCH=%PROCESSOR_ARCHITEW6432%
  start /b /wait SEPprep64.exe
  goto Done
)
echo Processor Architecture is %PROCESSOR_ARCHITECTURE%

:Done
timeout 15
rd /s /q c:\temp 1>nul 2>nul
exit 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T02:37:35.803

查看`systeminfo`

```
%SystemRoot%\system32\systeminfo.exe 
```

或者像这样简单的东西

```
if defined ProgramFiles(x86) 
```

这将检查是否定义了 ProgramFiles(x86) 环境变量（仅在 64 位版本的 Windows 上定义）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T21:54:36.307

The problem isn't your batch file, it's that you're relying on an environment variable that doesn't do what you think it does.

On my 64-bit Windows 7 machine, `ENV` shows:

```
PROCESSOR_ARCHITECTURE=x86
PROCESSOR_ARCHITEW6432=AMD64
PROCESSOR_IDENTIFIER=Intel64 Family 6 Model 42 Stepping 7, GenuineIntel
PROCESSOR_LEVEL=6 
```

...so relying on PROCESSOR_ARCHITECTURE to differentiate between 32 & 64 bit machines isn't going to work.

There *is* a [Microsoft Knowledge Base article](http://support.microsoft.com/kb/556009) on the topic.

Fix your method of detecting processor architecture, and you should be OK.

# c# - 异常：system.IO.FileNotFoundException：找不到程序集或文件 Mysql.Data

> ID：14635497
> 
> 赞同：0
> 
> 时间：2013-01-31T21:30:07.220
> 
> 标签：c#, .net, mysql, runtime-error

当我执行我的独立程序时，它崩溃并说：

```
Exception: System.IO.FileNotFoundException: cannot find assembly or file Mysql.Data  or load one of the dependable sources at project3.class.executesend<> at project3.class.initialize<> at project3.class.main<> 
```

经过一番搜索，我发现我应该将这些`.dll`文件作为资源添加到程序中。在我这样做之后，它产生了同样的错误。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:33:36.910

如果我理解得很好，您在项目的引用文件夹中添加了 Mysql.Data。

现在，在 VS Explorer 中右键单击它，转到属性，并将属性“复制本地”设置为 true。

因此，每当您构建应用程序时，它将被复制到“调试”或“发布”文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-01-30T16:28:15.257

对于 MySQL Workbench 8.0.19 版本，我需要安装 Visual C++ 2015-2019 DLL。

我安装了 2008、2010、2013 和 2015，有 x64 和 x32 两种版本，但遇到了这个错误。

Visual C++ Redistributables 在这里...

[https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads](https://support.microsoft.com/en-us/help/2977003/the-latest-supported-visual-c-downloads)

# image - 如何使用 calc (width - X) 保持图像比例

> ID：14635500
> 
> 赞同：1
> 
> 时间：2013-01-31T21:30:21.810
> 
> 标签：image, css, image-resizing

我知道仅以百分比指定宽度或高度将使图像保持正确的比例，但是，如果我尝试类似的方法，似乎：

```
img {width: calc(100% - 60px);} 
```

我失去了比例。图像将变窄 60 像素。然后我尝试了这个：

```
img {width: calc(100% - 60px); height: calc(100% - 60px);} 
```

..但图像仍然无法保持正确的比例。

有谁知道使用 CSS 或可能是一些轻量级 js 的方法来使用 calc 单位，同时保持正确的比例？

最终目标是让所有图像在一个大（包含每个页面上的大部分内容）div 中分配 css 以减小其图像大小以适应移动设备（特别是 iphone 纵向），而不会溢出并导致水平滚动，或其他具有 100% 宽度的元素（为了跨越页面，例如横幅）低于整个页面宽度。

我想使用特定于设备宽度的媒体查询，以便在添加我的总边距 % 填充后为所有图像提供最大 px 宽度，但我宁愿使用 calc 值，如果没有别的，我我很生气我不能使用它们。

这是 codepen 的链接：[https](https://codepen.io/spicedham/pen/qMKLYq) ://codepen.io/spicedham/pen/qMKLYq 附加信息：我可以访问 data-height 和 data-width 属性，但我不能将图像包装在容器中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-09-08T06:05:40.293

如果您只想为图像设置一个维度，请将另一个维度设置为`auto`。浏览器将处理比例。以下内容应该适合您：

```
img {
  width: calc(100% - 60px);
  height: auto;
} 
```

# python - 在访问表中使用 Unicode 值并连接标签表达式

> ID：14635503
> 
> 赞同：1
> 
> 时间：2013-01-31T21:30:36.940
> 
> 标签：python, function, unicode

我在 ArcGIS 中使用 unicode 值。基本上，我正在尝试在存储 unicode 值的访问表中设置一个字段。我发现这个脚本示例可以对 unicode 值进行编码。

```
import locale
locale.getdefaultlocale()
print u'Libert\u00e9' 
```

这将返回：

```
Liberté 
```

结尾带有重音 é

在我无限的智慧中，基于在 python 中使用 unicode 编码的新手经验，我想我可以做到这一点：

1.  在访问表中创建文本字段

2.  使用 unicode 值填充该字段，因此 u00e9

3.  定义一个python函数，如

像这样：

```
def FindLabel ( [Unicode] ):
  import locale
  locale.getdefaultlocale()
  return u'Libert\ + [Unicode] + "'" 
```

我正在使用它在 ArcGIS 中创建标签。

这不起作用，我已经玩过 return 声明了一点，但我似乎无法让它工作......或者真的知道我想要做的事情是否应该工作。

基本上，如果我让它工作，我想将 unicode 存储在访问表的字段中，这样我就可以从中定义一个 python 函数。

但话又说回来，也许我要出去吃午饭了，我想在这里尝试什么。

欢迎任何建议！麦克风

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:29:35.143

似乎对 Unicode 的性质有一点误解。Unicode 是严格存在于 Python 程序范围内的东西。当您将数据写入文件或数据库表中的字段时，您必须对该数据进行编码。

有了这个基础，让我们继续代码。与 相关的两条线`locale`目前没有做任何有成效的事情。我怀疑你想做的更像是：

```
import locale

# if you're on Windows in the US most likely 
# the following is returned: ('en_US', 'cp1252')
deflang, defencoding = locale.getdefaultlocale() 

# now that you have encoded your data (from Unicode) 
# you may commit it to the database 
write_this_to_db = u'Libert\u00e9'.encode(defencoding)
# -> 'Libert\xe9' 
```

# c++ - MongoDB C++ 分段错误

> ID：14635506
> 
> 赞同：5
> 
> 时间：2013-01-31T21:30:38.610
> 
> 标签：c++, mongodb, segmentation-fault

### 问题

我正在尝试用 C++ 连接到 MongoDB。以下代码确实可以编译。但是，当我尝试运行该程序时，我遇到了分段错误。

### - 编辑 -

这是我在 gdb 中运行它后得到的（源代码或 makefile 没有变化）：

### GDB 运行：

```
Starting program: /home/nathanw/devel/Linux/mkfarina-cpp/mkfarina 
[Thread debugging using libthread_db enabled]
Using host libthread_db library "/lib/x86_64-linux-gnu/libthread_db.so.1".
[New Thread 0x7ffff69ae700 (LWP 13314)]

Program received signal SIGSEGV, Segmentation fault.
[Switching to Thread 0x7ffff69ae700 (LWP 13314)]
0x00007ffff6d79034 in pthread_mutex_unlock () from /lib/x86_64-linux-gnu/libpthread.so.0 
```

### GDB 地点：

```
#0  0x00007ffff6d79034 in pthread_mutex_unlock () from /lib/x86_64-linux-gnu/libpthread.so.0
#1  0x00007ffff7bca948 in boost::detail::thread_data_base::~thread_data_base() () from /usr/local/lib/libboost_thread.so.1.52.0
#2  0x000000000046c74b in boost::detail::thread_data<boost::_bi::bind_t<void, boost::_mfi::mf1<void, mongo::BackgroundJob, boost::shared_ptr<mongo::BackgroundJob::JobStatus> >, boost::_bi::list2<boost::_bi::value<mongo::BackgroundJob*>, boost::_bi::value<boost::shared_ptr<mongo::BackgroundJob::JobStatus> > > > >::~thread_data() ()
#3  0x00007ffff7bc7d39 in thread_proxy () from /usr/local/lib/libboost_thread.so.1.52.0
#4  0x00007ffff6d75e9a in start_thread () from /lib/x86_64-linux-gnu/libpthread.so.0
#5  0x00007ffff6aa2cbd in clone () from /lib/x86_64-linux-gnu/libc.so.6
#6  0x0000000000000000 in ?? () 
```

### 环境

```
- Ubuntu 12.04 LTS
- MongoDB 2.2.2
- MongoDB C++ Driver 2.2.2
- boost 1.52.0 
```

### 源代码

```
#include <cstdlib>
#include <iostream>

// #include <cppcms/application.h>
// #include <cppcms/applications_pool.h>
// #include <cppcms/service.h>
// #include <cppcms/http_response.h>

#include "mongo/client/dbclient.h"

int main( int argc, char** argv ){
    try {
        mongo::DBClientConnection c;
        c.connect( "localhost" );

        std::cout << "connected ok" << std::endl;

    } catch( const mongo::DBException& e ){
        std::cout << "caught " << e.what() << std::endl;

    }

    return 0;

} 
```

### 生成文件

```
CXX = clang++

TARGET = mkfarina

FLAGS = -c -v -00

LIBRARIES = \
    -lbooster \
    -pthread \
    -lmongoclient \
    -lcppcms \
    -lboost_thread \
    -lboost_filesystem \
    -lboost_program_options \
    -lboost_system \

INCLUDE_PATHS = \
    -I/usr/local/include \
    -I/usr/local/include/boost \
    -I/usr/local/include/mongo \
    -I/usr/local/include/cppcms \
    -I/home/nathanw/devel/_include \

LIBRARY_PATHS = \
    -L/usr/lib \
    -L/usr/local/lib \

SOURCES = \
    main.cpp \

OBJECTS = $(SOURCES:.cpp=.o)

$(TARGET): $(OBJECTS)
    $(CXX) $(OBJECTS) $(LIBRARY_PATHS) $(LIBRARIES) -o $(TARGET)

%.o: %.cpp
    $(CXX) $(FLAGS) $(INCLUDE_PATHS) $(LIBRARY_PATHS) $(LIBRARIES) $< -o $@

clean:
    rm -f $(TARGET) $(OBJECTS) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-06T12:27:15.480

上面的代码工作正常...

您很可能在代码和编译的 mongodb 库中使用了不同版本的 boost。

确保：

*   Mongo DB 使用与您使用的**完全相同**版本的 boost 库和头文件。
*   确保他们正在查看完全相同的标题。
*   确保 libmongoclient 使用 clang 编译器编译，并且 boost 库也使用 clang 编译
*   确保链接到正确的增强版本。
*   确保对所有编译使用相同的 C++ 标志（即 C++0x 之类的东西）

混合不同版本的 boost 是很常见的情况，而且 Boost 对标志和代码/编译器的变化非常敏感。

例如，Ubuntu 12.04 带有 Boost-1.46，因此您可能包含操作系统特定文件而不是您的版本文件，与链接等相同。您也可能不小心使用或链接到 OS mongo-db，它是针对 boost 的编译器-1.46

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-06-19T21:55:42.713

如果您使用的是 OS X 10.9 Mavericks 并且 mongo 使用的 C++ 标准库的实现与 boost（libstdc++ 与 libc++）不同，则可能会发生此错误。为防止这种情况，当您使用 scons 构建 C++ 驱动程序时，请务必通过：

**--osx-version-min=10.9**

一个示例构建命令可能是：

**scons --prefix=$HOME/mongo-client-install --extrapath=/usr/local/Cellar/boost/1.55​​.0_2 install-mongoclient --osx-version-min=10.9**

# css - Chrome、打印和百分比 div

> ID：14635509
> 
> 赞同：0
> 
> 时间：2013-01-31T21:30:45.903
> 
> 标签：css, google-chrome, printing

我正在设计一个简单的 html 页面，其唯一目的是打印。我不在乎它在屏幕上的外观，但它必须在单页（A4 或字母）上和任何浏览器上打印。因此，我需要使用仅具有百分比大小的 div。

以下骨架代码的问题在于，在 Chrome 打印预览中，两个单词都显示在第一行，与网页中显示的内容相反。我在 FF 和 IE 中没有遇到这个问题。

```
<!DOCTYPE html>

<html>

<head>
    <style type="text/css">
    html, body, div, p, span { margin:0px;padding:0px; }
    html, body { width:100%;height:100%;min-height:100%;}
    </style>
</head>

<body>

    <div style="height:70%;">
      first
    </div>

    <div style="height:30%;">
      second
    </div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:56:07.680

Letter is the smallest size of the so to say "standard" paper types. It is a little wider than A4 though. So why not constrain yourself to the height of Letter and the width of A4? You'll want to incorporate some margin space anyways, which should account for a a good portion of width differences.

To that end, what about switching from percentages to actual inches or even millimeters (more precise). CSS does support these units.

For example calculate your 70% of page size in millimeters for the tallest paper size you support and the smallest paper size you support. Lets use Letter and A4\. So 70% of 279mm (Letter) = 195.3 rounded down (safer) to 195\. So put `min-height: 195mm;` Then for A4 70% of 297 = 207.9 rounded down = 207 so `max-height: 207mm;`

Calculating for 30%...

```
min-height: 83mm;
max-height: 89mm; 
```

Seems sound to me, not sure why it wouldn't work?

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:39:01.517

使用@media 打印，检查 css 媒体类型以及如何使用它。例如这里是编写的示例，您可以删除仅为测试添加的边框。

```
<!DOCTYPE html>
<html>
<head>
    <style type="text/css">
    @media screen {
    html, body, div, p, span { margin:0px;padding:0px; }
    html, body { width:100%;height:100%;}
    div.first {height:70%; width:100%;   }
    div.second {height:30%; width:100%; }
    }
    @media print {
    html, body, div, p, span { margin:0px;padding:0px; }
    html, body { width:100%;height:100%;}
    div.first {height:70%; width:100%; border:1px solid red; display:block;   position:fixed; top:0; left:0;  }
    div.second {height:30%; width:100%; border:1px solid blue; display:block; position:fixed; bottom:0; left:0; }

    }
    </style>
</head>
<body>
    <div class="first">
     first
    </div>
    <div class="second">
      second
    </div>
</body>
</html> 
```

# javascript - 选择单选按钮时触发事件

> ID：14635518
> 
> 赞同：0
> 
> 时间：2013-01-31T21:31:14.373
> 
> 标签：javascript, backbone.js

我正在构建一个小 js 问答游戏。使用下面的代码，用户选择一个答案，然后必须单击答案按钮提交，这会检查答案是否正确。换句话说，有两个步骤。首先，选择。第二，提交。我想知道是否有办法消除第二步，以便在选择时触发事件。

如有必要，这是一个小提琴。

[http://jsfiddle.net/mjmitche/D5H9z/](http://jsfiddle.net/mjmitche/D5H9z/)

我想我不知道如何为所有启动检查的选择框创建一个通用事件，但与此同时，能够检查选择是否正确，如果这有意义的话。

请注意，游戏最终将使用诸如下划线模板之类的东西来在字段中插入问题和答案选项，因此如果这会影响您的设置方式，请考虑到这一点。

先感谢您

**html**

```
 <fieldset id="question1">
        <legend>What is the answer to this question?</legend>
        <label><input type="radio" name="q1" value="right"> Right answer</label>
        <label><input type="radio" name="q1" value="wrong"> Wrong answer</label>
            <ul>

    </fieldset>

            <input type="button" id="answer"> 
```

**js**

```
 document.getElementById("answer").onclick = validate;
    function validate() {
            var radios;
            var i;
            var right;
            radios = document.getElementById("question1").getElementsByTagName("input");

            right = false;
            for(i = 0; i < radios.length; i++) {
                    if(radios[i].value == "right" && radios[i].checked == true) {
                          right = true;
                    }
            }

            if(right) {
                    alert("You answered correctly");
            } else {
                    alert("Wrong answer");
            }
    } 
```

**更新，**游戏的最终版本将使用 Backbone，它支持这样的事件

```
events:{ 'click #sayhello': 'validate'
    }, 
```

这个问题的前两个答案提出了一个“内联”解决方案，但我希望有一些适合主干事件处理的东西。`#sayhello`为了触发此代码中的验证功能，我将用什么替换。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:34:56.700

将`onclick`处理程序应用于每个单选按钮：

```
<input type="radio" name="q1" value="right" onclick="validate"> 
```

[在这里摆弄](http://jsfiddle.net/mjmitche/D5H9z/)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-31T21:53:08.137

试试这个：

```
<fieldset id="question1">
    <legend>What is the answer to this question?</legend>
    <label><input type="radio" name="q1" value="right" onclick="javascript:check('right')"/> Right answer</label>
    <label><input type="radio" name="q1" value="wrong" onclick="javascript:check('wrong')"/> Wrong answer</label>

<script>
    function check(answer){
        alert(answer+" answer");
    }

</script> 
```

[http://jsfiddle.net/D5H9z/3/](http://jsfiddle.net/D5H9z/3/)

# android - LayoutInflater 未按预期工作

> ID：14635520
> 
> 赞同：0
> 
> 时间：2013-01-31T21:31:16.837
> 
> 标签：android, xml

有人告诉我创建自定义布局来更改对话框的默认大小。我似乎无法让它工作。

这是构建对话框的位置：

```
AlertDialog.Builder builder = new AlertDialog.Builder(context);
AlertDialog ad = builder.create();
LayoutInflater inflater = context.getLayoutInflater();
builder.setView(inflater.inflate(R.layout.dialog_layout, null));
ad.setMessage("message");
ad.show(); 
```

这是布局 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:orientation="horizontal" >

    <View android:id="@+id/dialog_view"
        android:layout_width="400dp"
        android:layout_height="400dp"
        android:layout_weight="1" />

</FrameLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:46:05.283

设置视图后从构建器创建警报对话框：

```
AlertDialog.Builder builder = new AlertDialog.Builder(context);
LayoutInflater inflater = context.getLayoutInflater();
builder.setView(inflater.inflate(R.layout.dialog_layout, null));
AlertDialog ad = builder.create();
ad.setMessage("message");
ad.show(); 
```

# android - 无法水平居中 TextView

> ID：14635522
> 
> 赞同：0
> 
> 时间：2013-01-31T21:31:20.207
> 
> 标签：android

我是 android 新手，我正在尝试创建一个简单的 TextView 东西。不过，我无法将其水平居中。这是我的 main.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
>

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:gravity="center"
        android:text="@string/text"
        android:textSize="45sp" />

</LinearLayout> 
```

![在此处输入图像描述](../Images/39058d83ddf030f4f5b2d9dcab8d6dbd.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:32:17.347

将方向更改为垂直解决了问题

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:39:02.580

将方向更改为垂直

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
>

    <TextView
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_gravity="center"
        android:gravity="center"
        android:text="@string/text"
        android:textSize="45sp" />

</LinearLayout> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T21:50:41.540

您需要将方向设置为“水平”并将重力属性设置为“center_horizo​​ntal”

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="fill_parent"
android:gravity="center_horizontal"
android:orientation="horizontal" >

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_gravity="center"
    android:gravity="center"
    android:text="@string/text"
    android:textSize="45sp" /> 
```

# c# - 无法将“<>d__6”类型的对象转换为“System.Object[]”类型

> ID：14635546
> 
> 赞同：4
> 
> 时间：2013-01-31T21:33:13.473
> 
> 标签：c#, static, yield-return

我正在尝试延迟加载（使用收益返回的扩展）二维对象数组中的行。我收到以下错误：

> c# 无法将“<>d__6”类型的对象转换为“System.Object[]”类型。

异常发生在`Parse`方法中找到的这一行：

```
yield return (TSource) conversion(o); 
```

我不明白为什么`C#`认为返回值是`<>d__6`而不是`Object[]`. 我通常会编程，`VB.NET`所以我认为我不理解`C#`. 我究竟做错了什么？我查看了其他类似的问题/答案，但仍然感到困惑。

```
public static IEnumerable<TSource> Parse<TSource>(this object[,] array
        , Func<IEnumerable<object[]>, IEnumerable<TSource>> conversion
        , int rowStart, int columnStart, int rowCount, int columnCount)
    {

        IEnumerable<object[]> o 
            = array.ForEachRow(rowStart, columnStart, rowCount, columnCount);

        yield return (TSource) conversion(o);

    } 
```

ForEachRow 方法：

```
 public static IEnumerable<object[]> ForEachRow(this object[,] array, 
               int rowStart, int columnStart, int rowCount, int columnCount)
    {

        object[] array1d=new object[columnCount];
        for (int row = rowStart; row < rowCount; row++)
        {
            for (int column = columnStart; column < columnCount; column++)
            {
                array1d[column] = array[row, column];
            }
            yield return (object[]) array1d;
        }
    } 
```

我知道以前有人问过这个问题，但不幸的是，其他答案对我来说没有意义（我主要在 VB 中编程）。

**可用于编译和测试的代码 (In `VB.NET`)：**

基本上我从 Excel 中得到一个 2D 对象数组，并想把它放在一个类中并使用 Linq 来评估。

```
 Dim oData As Object(,) = {{"OrderDate", "Region", "Rep", "Item", "Units", "Unit Cost", "Total"} _
        , {New DateTime(2011, 1, 6), "East", "Jones", "Pencil", 95, 1.99, 189.05} _
        , {New DateTime(2011, 1, 23), "Central", "Kivell", "Binder", 50, 19.99, 999.5} _
        , {New DateTime(2011, 2, 9), "Central", "Jardine", "Pencil", 36, 4.99, 179.64} _
        , {New DateTime(2011, 2, 26), "Central", "Gill", "Pen", 27, 19.99, 539.73} _
        , {New DateTime(2011, 3, 15), "West", "Sorvino", "Pencil", 56, 2.99, 167.44} _
        }

    Dim clsSales = oData.Parse(Of SaleOrder)(Function(o As Object()) New SaleOrder( _
                                         If(IsDate(o(0)), o(0), #1/1/1900#) _
                                         , o(1).ToString _
                                         , o(2).ToString _
                                         , o(3).ToString _
                                         , If(IsNumeric(o(4)), CInt(o(4)), 0) _
                                         , If(IsNumeric(o(5)), o(5), 0) _
                                         ), 1, 0, oData.GetUpperBound(0), 6)

    For Each cls In clsSales
        Console.WriteLine(cls.ToString)
    Next 
```

**班级在哪里：**

```
 Class SaleOrder

Public Sub New(ByVal date_ As Date, ByVal region_ As String, ByVal rep As String, ByVal item_ As String, ByVal units As Integer _
               , ByVal cost As Double)

    OrderDate = date_
    Region = region_
    Representative = rep
    Item = item_
    UnitCount = units
    UnitCost = cost

End Sub

Public OrderDate As DateTime
Public Region As String
Public Representative As String
Public Item As String
Public UnitCount As Integer = 5
Public UnitCost As Double
Public ReadOnly Property Total() As Double
    Get
        Return UnitCount * UnitCost
    End Get
End Property

Public Overrides Function ToString() As String
    Return String.Format("{0} {1} {2} {3} {4} {5} {6}", OrderDate, Region, Representative, Item, UnitCount, UnitCost, Total)
End Function

End Class 
```

**最终解决方案**

```
 public static IEnumerable<TSource> Parse<TSource>(this object[,] array
        , Func<object[], TSource> conversion
        , int rowStart, int columnStart, int rowCount, int columnCount)
    {

        for (int row = rowStart; row < rowCount; row++)
        {
            object[] array1d = new object[columnCount];
            for (int column = columnStart; column < columnCount; column++)
            {
                array1d[column] = array[row, column];
            }
            yield return conversion(array1d);
        }

    } 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:56:45.817

有了评论中的所有信息，现在很清楚这里发生了什么。让我们做一个更简单的复制：

```
public static IEnumerable<Tiger> Parse()
{
  object obj = ForEachRow();
  yield return (Tiger) obj;
}

public static IEnumerable<Tiger> ForEachRow()
{
  yield return new Tiger();
} 
```

OK，编译器对bottom方法做了什么？它像这样重写它：

```
class ForEachRowEnumerable : IEnumerable<Tiger>
{
    ... a class which implements an IEnumerable<Tiger> 
    that yields a single tiger...
}

public static IEnumerable<Tiger> ForEachRow()
{
  return new ForEachRowEnumerable();
} 
```

那么现在第一种方法是做什么的呢？

你打电话给 ForEachRow。这将返回一个新的 ForEachRowEnumerable。您将其转换为对象。然后，您将对象投射到老虎身上。但是 ForEachRowEnumerable 不是老虎；这是一门会给你一系列老虎的课程。所以运行时会给出错误“无法将 ForEachRowEnumerable 转换为 Tiger”。

C# 编译器当然不会将该类命名为“ForEachRowEnumerable”。它命名它`<>d__6`是为了确保您实际上不可能按名称使用该类。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T21:41:13.477

`o`是一个`IEnumerable<object[]>`。

`conversion(o)`是一个`IEnumerable<TSource>`。您正在将一系列对象转换为一系列`TSource`项目。

然后，您将其`IEnumerable<TSource>`转换为`TSource`. 您基本上是在说，“将这一系列`TSource`项目视为一个`TSource`项目。” 运行时告诉你的是，“我不允许将项目序列视为一个`TSource`项目，因为它不是这样的。

您几乎可以肯定*实际上*想要做的只是将最后一行替换为：

```
return conversion(o); 
```

您有一系列`TSource`项目，而这正是您需要返回的。您尝试使用迭代器块时想多了。

如果您真的非常想使用迭代器块，那么您需要产生序列中的每个项目，如下所示：

```
foreach (TSource item in conversion(o))
    yield return item; 
```

但何苦呢。

# python - 如何安装 python-Levenshtein windows

> ID：14635547
> 
> 赞同：2
> 
> 时间：2013-01-31T21:33:22.787
> 
> 标签：python, windows-8, levenshtein-distance

我看到有一个关于在 python 中安装 levenshtein 的类似问题，但被另一个用户指示启动我自己的，所以就这样了。

我正在运行 Windows 8 64 位。当我尝试安装 Levenshtein 时，出现以下错误。

```
C:\Python27\Lib\site-packages\python-Levenshtein-0.10.2>python setup.py install
running install
running bdist_egg
running egg_info
writing requirements to python_Levenshtein.egg-info\requires.txt
writing python_Levenshtein.egg-info\PKG-INFO
writing namespace_packages to python_Levenshtein.egg-info\namespace_packages.txt

writing top-level names to python_Levenshtein.egg-info\top_level.txt
writing dependency_links to python_Levenshtein.egg-info\dependency_links.txt
writing entry points to python_Levenshtein.egg-info\entry_points.txt
reading manifest file 'python_Levenshtein.egg-info\SOURCES.txt'
reading manifest template 'MANIFEST.in'
warning: no files found matching '*' under directory 'docs'
warning: no previously-included files matching '*pyc' found anywhere in distribu
tion
warning: no previously-included files matching '.project' found anywhere in dist
ribution
warning: no previously-included files matching '.pydevproject' found anywhere in
 distribution
writing manifest file 'python_Levenshtein.egg-info\SOURCES.txt'
installing library code to build\bdist.win32\egg
running install_lib
running build_ext
building 'Levenshtein' extension
error: Unable to find vcvarsall.bat 
```

我被指示安装安装工具，我已经完成了。也

> [从http://www.microsoft.com/en-us/download/details.aspx?id=6506](http://www.microsoft.com/en-us/download/details.aspx?id=6506)下载 vcsetup.exe运行它
> 
> 完成后打开你的 command.exe
> 
> 输入 :easy_install python-Levenshtein （假设你已经有 setuptools）

但是，当我键入“easy_install”时，我收到以下消息。我也对措辞感到困惑。我应该指向 setup.py 吗？

```
C:\Python27\Lib\site-packages\python-Levenshtein-0.10.2>easy_install python-Leve
nshtein
'easy_install' is not recognized as an internal or external command,
operable program or batch file. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:01:34.053

发生问题是`easy_install`因为您的 python 脚本文件夹不在 PATH 中。只需将以下内容添加到 PATH 中：

```
 C:\Python27\Scripts 
```

至于你最初的问题，你应该看看[这个问题](https://stackoverflow.com/questions/2817869/error-unable-to-find-vcvarsall-bat)的答案。

# python - Python 矢量变换（归一化、缩放、旋转等）

> ID：14635549
> 
> 赞同：0
> 
> 时间：2013-01-31T21:33:31.933
> 
> 标签：python, math, vector-graphics

我即将在 python 中编写我自己的缩放、旋转、规范化函数。有没有方便的方法来避免这种情况？我找到了 NumPy，但对于我的小 2D 需求来说，它似乎有点过头了。

标准 python 库中是否有可用的基本向量操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:41:46.900

不，中的标准`numpy`。我不会认为它是矫枉过正，将其视为一个编写良好且经过测试的库，即使您只需要它的一小部分。所有基本的向量和矩阵运算都有效地实现（回退到 C 和 Fortan），这使其快速且内存高效。不要自己制作，使用 numpy.

# android - 小部件：无异常且小部件未打开

> ID：14635555
> 
> 赞同：0
> 
> 时间：2013-01-31T21:34:05.693
> 
> 标签：android, android-widget

我的小部件在加载小部件时出现问题，并且它不起作用。

这是我在 logcat 输出中收到的输出，但我不确定它的含义。

```
W/de.vogella.android.widget.example(1613): onUpdate method called
W/AppWidgetHostView(412): updateAppWidget couldn't find any view, using error view
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHostView.updateAppWidget(AppWidgetHostView.java:394)
W/AppWidgetHostView(412):   at com.android.launcher2.LauncherAppWidgetHostView.updateAppWidget(LauncherAppWidgetHostView.java:54)
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHost.updateAppWidgetView(AppWidgetHost.java:376)
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHost$UpdateHandler.handleMessage(AppWidgetHost.java:101)
W/de.vogella.android.widget.example(1664): onUpdate method called
W/de.vogella.android.widget.example(1664): onUpdate method called
W/de.vogella.android.widget.example(1664): onUpdate method called
W/de.vogella.android.widget.example(1705): onUpdate method called
W/de.vogella.android.widget.example(1744): onUpdate method called
W/AppWidgetHostView(412): updateAppWidget couldn't find any view, using error view
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHostView.updateAppWidget(AppWidgetHostView.java:394)
W/AppWidgetHostView(412):   at com.android.launcher2.LauncherAppWidgetHostView.updateAppWidget(LauncherAppWidgetHostView.java:54)
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHost.updateAppWidgetView(AppWidgetHost.java:376)
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHost$UpdateHandler.handleMessage(AppWidgetHost.java:101)
W/de.vogella.android.widget.example(1744): onUpdate method called
W/AppWidgetHostView(412): updateAppWidget couldn't find any view, using error view
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHostView.updateAppWidget(AppWidgetHostView.java:394)
W/AppWidgetHostView(412):   at com.android.launcher2.LauncherAppWidgetHostView.updateAppWidget(LauncherAppWidgetHostView.java:54)
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHost.updateAppWidgetView(AppWidgetHost.java:376)
W/AppWidgetHostView(412):   at android.appwidget.AppWidgetHost$UpdateHandler.handleMessage(AppWidgetHost.java:101) 
```

`OnUpdate()`方法是使用服务触发的。我在下面发布了服务内容：

```
public void onUpdate(Context context, AppWidgetManager appWidgetManager,
      int[] appWidgetIds) {

    Log.w(LOG, "onUpdate method called");
    // Get all ids
    ComponentName thisWidget = new ComponentName(context,
        MyWidgetProvider.class);
    int[] allWidgetIds = appWidgetManager.getAppWidgetIds(thisWidget);

    // Build the intent to call the service
    Intent intent = new Intent(context.getApplicationContext(),
        UpdateWidgetService.class);
    intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_IDS, allWidgetIds);

    // Update the widgets via the service
    context.startService(intent);
  } 
```

我认为问题出在布局上。如果我想将其更改为字幕文本，那么我会遇到这个问题。布局是：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/layout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:layout_margin="8dip"
    android:background="@drawable/myshape" >

    <TextView
        android:id="@+id/update"
        android:layout_width="200dp"
        android:duplicateParentState="true"
        android:ellipsize="marquee"
        android:focusable="true"
        android:focusableInTouchMode="true"
        android:marqueeRepeatLimit="marquee_forever"
        android:scrollHorizontally="true"
        android:singleLine="true"
        android:text="Loading... More text to see if it spans or not and want more" >

        <requestFocus
            android:duplicateParentState="true"
            android:focusable="true"
            android:focusableInTouchMode="true" />
    </TextView>

</LinearLayout> 
```

错误消息是什么意思，为什么我的小部件没有加载？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:58:23.163

我认为这可能对其他人有用。

通常，为了让选取框运行，在活动中，我们设置`TextView.setSelected(true)`. 在小部件中，这应该在 xml 文件中使用标记完成`requestfocus`。以防万一，我已经发布了工作 xml 文件。

```
<TextView
    android:id="@+id/update"
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:ellipsize="marquee"
    android:focusable="true"
    android:focusableInTouchMode="true"
    android:freezesText="true"
    android:marqueeRepeatLimit="marquee_forever"
    android:paddingLeft="15dip"
    android:paddingRight="15dip"
    android:scrollHorizontally="true"
    android:singleLine="true" >

    <requestFocus
        android:duplicateParentState="true"
        android:focusable="true"
        android:focusableInTouchMode="true" />
</TextView> 
```

干杯。

# java - 无法访问实例化类的受保护方法

> ID：14635559
> 
> 赞同：1
> 
> 时间：2013-01-31T21:34:23.027
> 
> 标签：java, jsp, protected, aem

我正在尝试访问这个受保护的类：`protected boolean canDraw()`，并将其值放入变量中。我尝试访问它的两种方法不起作用：

```
 <%@ page import="com.day.cq.wcm.foundation.Image" %>
    <%@include file="/apps/tju/global.jsp"%>
    <% //..... 
       Image thisImage = new Image(resource); %> 
```

`boolean foo = thisImage.canDraw();`throws **Image 类型的方法 canDraw() 不可见**

和

`boolean foo = super.canDraw();`throws **HttpJspBase 类型的方法 canDraw() 未定义**

可以在此处找到正在使用的类的完整 javadoc：http: [//dev.day.com/docs/en/cq/5-3/javadoc/com/day/cq/wcm/foundation/Image.html](http://dev.day.com/docs/en/cq/5-3/javadoc/com/day/cq/wcm/foundation/Image.html)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:37:16.130

该方法受到保护。因此，您不能从包外部和从该类继承的类访问它。

您正试图从 JSP 页面访问受保护的方法。JSP 页面不是 Image 的子类，因此无法访问该方法。

如果没有更好的方法来做您想做的事情，请子类化 Image 并为您尝试访问的属性创建一个公共访问器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:39:10.760

好吧，它是受保护的，并且您正试图从`Servlet`子类中访问它（JSP 被编译成 Servlet）。按照 java 规范，你不能这样做。

将其公开（如果您有源代码），或将原始类扩展为具有提供相同数据的公共方法的类。或者（不推荐），使用反射来改变它的可访问性。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T14:31:23.610

如其他答案中所述，您必须扩展 Image，覆盖 canDraw 并使被覆盖的方法的可见性公开。

检查canDraw()后你打算做什么？我想它受到保护是有原因的。这是推测性的，但如果您所做的只是检查 canDraw()，然后在它返回 true 时进行绘图，您实际上可以直接调用 draw()。JavaDoc 声明它在内部检查 canDraw()：

[http://dev.day.com/docs/en/cq/current/javadoc/com/day/cq/commons/ImageResource.html#draw(java.io.Writer)](http://dev.day.com/docs/en/cq/current/javadoc/com/day/cq/commons/ImageResource.html#draw(java.io.Writer))

# c++ - 如何提出高缓存未命中率示例？

> ID：14635562
> 
> 赞同：9
> 
> 时间：2013-01-31T21:34:34.457
> 
> 标签：c++, c, caching, perf

我正在尝试提出一个具有高缓存未命中率的示例程序。我想我可以尝试像这样逐列访问矩阵：

```
#include <stdlib.h>

int main(void)
{
    int i, j, k;

    int w = 1000;
    int h = 1000;

    int **block = malloc(w * sizeof(int*));
    for (i = 0; i < w; i++) {
        block[i] = malloc(h * sizeof(int));
    }

    for (k = 0; k < 10; k++) {
        for (i = 0; i < w; i++) {
            for (j = 0; j < h; j++) {
                block[j][i] = 0;
            }
        }
    }

    return 0;
} 
```

当我用`-O0`标志编译它并使用它运行时，`perf stat -r 5 -B -e cache-references,cache-misses ./a.out`它给了我：

```
 Performance counter stats for './a.out' (5 runs):

    715,463 cache-references                                      ( +-  0.42% )
    527,634 cache-misses          #   73.747 % of all cache refs  ( +-  2.53% )

0.112001160 seconds time elapsed                                  ( +-  1.58% ) 
```

这对我的目的来说已经足够好了。但是，如果我继续并将矩阵大小更改为`2000x2000`它给出：

```
 Performance counter stats for './a.out' (5 runs):

  6,364,995 cache-references                                      ( +-  2.32% )
  2,534,989 cache-misses          #   39.827 % of all cache refs  ( +-  0.02% )

0.461104903 seconds time elapsed                                  ( +-  0.92% ) 
```

如果我进一步增加它，`3000x3000`我会得到：

```
 Performance counter stats for './a.out' (5 runs):

 59,204,028 cache-references                                      ( +-  1.36% )
  5,662,629 cache-misses          #    9.565 % of all cache refs  ( +-  0.11% )

1.116573625 seconds time elapsed                                  ( +-  0.32% ) 
```

这很奇怪，因为随着大小的增加，我希望获得更多的缓存未命中率。我需要尽可能独立于平台的东西。计算机体系结构课很久以前，所以任何见解都会受到欢迎。

**笔记**

我说我需要一些相对独立于平台的东西，但这些仍然是我的规格：

*   英特尔® 酷睿™ i5-2467M
*   4 GiB 内存
*   64 位 Ubuntu 12.04

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T21:44:41.007

当心现代 CPU 中的自动预取 - 它通常可以检测跨步访问。也许尝试随机访问模式，例如：

```
int main(void)
{
    int i;

    int n = 1000 * 1000;

    int *block = malloc(n * sizeof(int));

    for (i = 0; i < n / 10; i++) {
         int ri = rand() % n;
         block[ri] = 0;
    }

    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:00:06.110

我不完全确定您可以比较这些程序或真正保证任何事情，因为这取决于操作系统如何分配单个内存块。

您至少应该将所有内存分配为单个块，然后索引到该块以获取所有数组（`int*`和`int`）。这样你就有一个一致的起点。您可能希望将数组大小作为参数传递，而不是每次都重新编译。

您还可以对其进行调整，以便分配比您需要的内存更多的内存并放置每一行（或列，您编写它的方式），以保证矩阵的只有一行（列）将在任何时候加载到缓存中一度。 *即*找出缓存的大小，并将每个块至少分开那么多字节。

请注意，您应该`free`在退出之前真正记住您的记忆。

正如其他人已经指出的那样，随机化您的访问模式是一个好主意。

# vb.net - 无论如何要使用 linq 到 sql 实体类和成员的“名称引用”？

> ID：14635575
> 
> 赞同：1
> 
> 时间：2013-01-31T21:35:22.053
> 
> 标签：vb.net, linq, linq-to-sql

我想使用类似收藏的东西

```
from m in myDataContext.Customers select m.("FirstName") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:44:16.903

似乎您正在寻找动态 LINQ

[http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx](http://weblogs.asp.net/scottgu/archive/2008/01/07/dynamic-linq-part-1-using-the-linq-dynamic-query-library.aspx)

# twitter-bootstrap - 将自定义属性添加到使用 Angular 的 ng-options 生成的选项 使用 Bootstrap，您可以很好地为 <select>选项 (stackoverflow.com) 定义工具提示，而 Angular 可以方便地使用</select> 元素上的 ngOptions 属性生成和绑定选项。但是，如何向这些生成的选项元素添加属性，然后引导工具提示插件可以使用这些属性？查看当前版本（1.0.4 和 1.1.2）中 AngularJS 的源代码，这是不可能的，

> ID：14635576
> 
> 赞同：3
> 
> 时间：2013-01-31T21:35:26.787
> 
> 标签：twitter-bootstrap, angularjs, tooltip

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:25:49.327

查看当前版本（1.0.4 和 1.1.2）中 AngularJS 的[源代码](https://github.com/angular/angular.js/blob/master/src/ng/directive/select.js)，这是不可能的，因为`option`元素是在 JavaScript 代码中创建的，无法指定任何附加属性。

# google-chrome - svg chrome bug 在移动或移除对象时留下黑框

> ID：14635578
> 
> 赞同：0
> 
> 时间：2013-01-31T21:35:35.890
> 
> 标签：google-chrome, svg, webkit

我正在动态创建一个加载外部 svg 的 html 对象类型，然后将其 appendChild 到文档中。（我会注意到它在画布区域，但我认为这并不重要）。这一切都很好。

当我修改左侧或顶部，或者只是删除对象时，它会在其高度和宽度的原始 svg 区域中留下一个黑框。如果我正在移动它在新位置呈现的 svg，它只是在原始位置留下一个黑框。

这只发生在 chrome 中。（Firefox 中没有黑框）。阅读一些 chrome 文档，我看到他们过去处理过一些 webkit 问题，留下了一个黑匣子。

在 svg 文件中，如果我使用视口，或者不使用，我会得到同样的错误

有人见过这个吗？有解决办法吗？（我必须使用对象，而不是图像）

创建 svg 的一部分...

```
var object2 = document.createElement("object");
object2.setAttribute("type", "image/svg+xml");
object2.setAttribute("data", "bitmaps/whirl.svg");
object2.className += " roomObj3";
object2.style.left=''+(xxx+8)+'px';
object2.style.top=''+(18)+'px';
object2.id="tornado"+xx;
document.getElementById('objLayer').appendChild(object2); 
```

移动留下一个黑盒子（但也正确移动）......

```
var id2="tornado"+xx;
ele=document.getElementById(id2);
var xpos=parseInt(ele.style.left);
ele.style.left=""+(xpos+100)+"px";

.roomObj3 {
position:absolute;
z-index:1;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:57:57.493

尝试强制 Chrome 使用 GPU：

```
.roomObj3 {
  position:absolute;
  z-index:1;
  -webkit-backface-visibility: hidden;
} 
```

# java - Does Mule FunctionalTestCase needs org.junit.rules.TestRule class to run

> ID：14635581
> 
> 赞同：1
> 
> 时间：2013-01-31T21:35:46.077
> 
> 标签：java, junit, junit4, mule, junit-rule

I'm trying to run a simple `Functional test` in Mule 3.3\. Below is my sample code:

```
import java.util.Map;    
import org.junit.Test;
import org.mule.api.MuleMessage;
import org.mule.api.client.MuleClient;
import org.mule.tck.junit4.FunctionalTestCase;
import static org.junit.Assert.*;

public class SoapServiceTest extends FunctionalTestCase {

    @Override
    protected String getConfigResources() {
        return "mule-config.xml,core-config.xml";
    }       

    @Test
    public void testSend() throws Exception
    {
        MuleClient client = muleContext.getClient();
        String payload = "foo";
        Map<String, Object> properties = null;
        MuleMessage result = client.send("http://localhost:61005/service", payload, properties);
        assertNotNull(result.getPayloadAsString());
    }    
} 
```

But it complains `java.lang.NoClassDefFoundError: org/junit/rules/TestRule`. I've `junit4.8.1.jar` in my classpath but that doesn't have `TestRule` class which guess is `junit4.9` onwards.

Does Mule needs this class? I'm not using any of the annotations of `TestRule`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:39:21.307

From [Mule's parent POM](http://svn.codehaus.org/mule/tags/mule-3.3.1/pom.xml):

```
<dependency>
    <groupId>junit</groupId>
    <artifactId>junit</artifactId>
    <version>4.9</version>
</dependency> 
```

So yes, Mule relies on JUnit 4.9, whether you depend on it directly or not.

When you add:

```
<dependency>
    <groupId>org.mule.tests</groupId>
    <artifactId>mule-tests-functional</artifactId>
    <version>3.3.1</version>
    <scope>test</scope>
</dependency> 
```

to your project's POM, JUnit 4.9 should be pulled in for you.

# mysql - 从 H2 切换到 MySQL 时 Grails 更改表名的大小写

> ID：14635583
> 
> 赞同：1
> 
> 时间：2013-01-31T21:35:58.803
> 
> 标签：mysql, hibernate, grails, grails-orm

我有一个 Grails 应用程序已经在 H2 数据库中正常工作了几个月。所有的表名和列名都是大写的。我在投入生产时切换到 MySQL，应用程序停止工作。即使是简单的事情，比如计算表的行数，也会返回 0。我知道我已成功连接到 MySQL 数据库，所以我认为这不是问题。

当我在 GUI 中查看表格内容时，我注意到正在创建的其他表格名称相似，但都是小写而不是大写。所以我的好数据都在表'FOO'下，但我的Grails应用程序正在根据转储到控制台的Hibernate查询在'foo'（它是空的）中查找。除了 url（更新为指向 MySQL 数据库而不是 H2 数据库）、驱动程序类（com.mysql.jdbc.Driver）和方言（org.hibernate）之外，我没有更改 Grails 设置中的任何内容.dialect.MySQL方言）

应用程序也在对列名做同样的事情。我检查了我的 MySQL 服务器设置，我的 lower_case_table_names 变量设置为 0。

有谁知道问题可能是什么？

# javascript - 用 ContentEditable 属性替换 textarea - Javascript 运行多次

> ID：14635584
> 
> 赞同：3
> 
> 时间：2013-01-31T21:36:05.220
> 
> 标签：javascript, jquery, prototype

我正在编写一个脚本来监听属性`contenteditable`并模拟更改的处理程序。并且代码运行多次。我不确定为什么会这样。Edit2：更新了解决问题的代码。代码如下所示：

```
 Event.observe(window, 'load', init, false);

    function init() {
        makeEditable('myeditablediv');
    }

    function makeEditable(id) {
        Event.observe(id, 'click', function(){test($p(id))}, false);
    }

    function test(obj) {
        var pre = obj.innerHTML;

        $(obj).one("focusout", function(){
            newcontent = obj.innerHTML
            alert(pre + ' ' + newcontent);
            if (newcontent !== pre) {alert('content is not the same')};         
        });
    } 
```

这最初是一个原型脚本，这就是为什么`$p`我不得不改变它的选择器，因为我也使用 jQuery。

在`test()`我输出之前的值，然后是新的值。然后我尝试比较这两者。下次我单击元素`myeditablediv`时，会显示以前的变量，然后显示新变量。我第三次点击，前两次，然后是新的第三次。等等等等。我敢打赌你们中的一些人现在已经准备好了你的脸，但我还不够好，无法发现这一点。是因为`Event.observe`? 编辑：编辑了 if 语句。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:57:28.917

您可以使用[.one()](http://api.jquery.com/one/)附加`.focusout`处理程序并让它只运行一次，而不是每次添加越来越多的处理程序。

所以：

```
$(obj).one("focusout", function(){
    //....
}); 
```

# date - 具有当前时间戳的流星集合查询

> ID：14635587
> 
> 赞同：2
> 
> 时间：2013-01-31T21:36:16.800
> 
> 标签：date, collections, find, meteor

我需要安排具有属性 'scheduledAt 和时间戳的项目，包括当前的和预计的。不幸的是，参考日期只计算一次。

如何解决？

```
Items.find({scheduledAt : {$lt : new Date()}}).observe(...) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-27T23:07:14.073

因为 Meteor 是一个单页应用程序，所以“new Date()”不会被调用，除非你通过执行以下操作使其具有响应性：

函数 findItems() { Session.get Items.find({scheduledAt : {$lt : new Date()}}).observe(...) }

您可以通过执行 Session.set('triggerEvent'); 来触发

如果您只想定期执行此操作，请使用 Meteor.setTimeout()

# java - 如何使用 PushbackInputStream 检查字节数组？

> ID：14635592
> 
> 赞同：0
> 
> 时间：2013-01-31T21:36:44.033
> 
> 标签：java, io

我想检查中的字节是`ostream`表示序列化对象还是字节数组：

```
ByteArrayOutputStream ostream = new ByteArrayOutputStream();
ObjectOutputStream out = new ObjectOutputStream(ostream);
out.writeObject(new TestClass());
out.flush();
out.close();

byte[] bytes = ostream.toByteArray();
isSerializedObject(new ObjectInputStream(
  new ByteArrayInputStream(bytes)))); // returns false
isSerializedObject(new ByteArrayInputStream(bytes))); // returns true 
```

的代码`isSerializedObject`如下所示：

```
public static boolean isSerializedObject(InputStream istream) throws Exception {
  int size = 2;
  PushbackInputStream pis = new PushbackInputStream(istream, size);
  byte[] buffer = new byte[size];
  pis.read(buffer);
  // serialized data can be identified by the following two bytes
  boolean flag = buffer[0] == 0xAC && buffer[1] == 0xED;
  pis.unread(buffer);
  return flag;
} 
```

有人可以解释为什么我使用 an时`isSerializedObject`返回但使用 a 时返回吗？`false``ObjectInputStream``true``ByteArrayInputStream`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:35:49.307

为什么？只需 (a) 使用 writeObject() 而不是 write() 写入字节数组，然后 (b) 读取对象并在之后使用“instanceof”。容易得多，而且它不涉及窥探协议。

# visual-studio-2010 - 多个浏览器中的 Visual Studio 2010 预览版

> ID：14635594
> 
> 赞同：1
> 
> 时间：2013-01-31T21:36:48.493
> 
> 标签：visual-studio-2010, cross-browser, expression-web

VS2010 中是否有任何扩展或功能可以在多个浏览器中（同时）进行预览，与 Microsoft Expression Web 4 中的一样？我知道有“默认浏览器切换器”扩展，但这只能让您一次查看一个浏览器。干杯意志

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:43:53.333

当您右键单击页面执行“浏览方式...”时，您可以设置多个默认值。将多个浏览器添加到列表后，您可以 CTRL 单击您想要的每个浏览器（突出显示多个浏览器）。突出显示所需的选项后，单击“设置为默认值”。从那时起，每当您点击“浏览”时，它都应该在您突出显示的所有“默认”浏览器中打开。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-21T21:10:06.340

我找到了一个解决方案，如何通过将几个答案加在一起来在多个浏览器中预览 MVC 应用程序。您所做的是在您的项目中添加一个 .aspx 页面，并在您运行项目时将其设置为启动页面。然后在您的项目中进行设置，以便您自动重定向到另一个页面，无论是“登录”还是“主页”页面。最后一步是使用@Walls 回答

当您右键单击页面执行“浏览方式...”时，您可以设置多个默认值。将多个浏览器添加到列表后，您可以 CTRL 单击您想要的每个浏览器（突出显示多个浏览器）。突出显示所需的选项后，单击“设置为默认值”。从那时起，每当您点击“浏览”时，它都应该在您突出显示的所有“默认”浏览器中打开。

现在，当您运行项目时，它将启动所有默认浏览器进行测试。

# c# - 从那时起将数据返回到 Windows 剪贴板

> ID：14635599
> 
> 赞同：6
> 
> 时间：2013-01-31T21:37:01.323
> 
> 标签：c#, copy, clipboard, paste

我想获取当前存储在 Windows 剪贴板中的数据并将其保存在一个变量中，然后将数据放回剪贴板。

现在我正在使用这段代码：

```
object l_oClipBrdData = Clipboard.GetDataObject();
Clipboard.SetDataObject(l_oClipBrdData ,true); 
```

但是在这样做之后剪贴板是空的。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:48:19.100

这是一个演示“剪贴板”对象的示例：

```
string text;
string[] a;

if (Clipboard.ContainsText())
   {
      text = Clipboard.GetText(TextDataFormat.Text);

      //  the following could have been done simpler with
      //  a Regex, but the regular expression would be not
      //  exactly simple

      if (text.Length > 1)
          {
              //  unify all line breaks to \r
              text = text.Replace("\r\n", "\r").Replace("\n", "\r");

              //  create an array of lines
              a = text.Split('\r');

              //  join all trimmed lines with a space as separator
              text = "";

              //  can't use string.Join() with a Trim() of all fragments
              foreach (string t in a)
              {
                  if (text.Length > 0)
                      text += " ";
                  text += t.Trim();
              }

            Clipboard.SetDataObject(text, true);
          }
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T21:57:20.633

`Clipboard.GetDataObject()` will return the `IDataObject` from the clipboard, if you want to get the actual data you can call `GetData(typeof(dataType))`

Example:

```
 int mydata = 100;

        Clipboard.SetDataObject(mydata, true);

        var clipData = Clipboard.GetDataObject().GetData(typeof(int)); 
```

There are also a lot of predifined dataTypes you can use

Example:

```
 if (Clipboard.ContainsData(DataFormats.Bitmap))
        {
            var clipData = Clipboard.GetData(DataFormats.Bitmap);
        } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:44:27.977

传递给 SetDataObject() 的对象应该支持序列化。如果这是您自己的类型，请使用 [Serializable] 属性对其进行标记。

更多信息：

[http://msdn.microsoft.com/en-gb/library/cs5ebdfz(v=vs.90).aspx](http://msdn.microsoft.com/en-gb/library/cs5ebdfz(v=vs.90).aspx)

[http://www.codeproject.com/Articles/8102/Saving-and-obtaining-custom-objects-to-from-Window](http://www.codeproject.com/Articles/8102/Saving-and-obtaining-custom-objects-to-from-Window)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-06-20T17:18:31.087

`Clipboard.Flush();`之后尝试调用`SetDataObject()`。

# java - 在java中将字符存储为单个字节

> ID：14635600
> 
> 赞同：0
> 
> 时间：2013-01-31T21:37:01.800
> 
> 标签：java, char, byte

我读到我们应该使用 Reader/Writer 读取/写入字符数据，使用 InputStream/OutputStream 读取/写入二进制数据。此外，在 java 中字符是 2 个字节。我想知道以下程序是如何工作的。它从标准输入中读取字符，将它们存储在一个字节中并打印出来。两个字节字符在这里如何适合一个字节？

[http://www.cafeaulait.org/course/week10/06.html](http://www.cafeaulait.org/course/week10/06.html)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T21:39:21.300

评论解释得很清楚：

```
// Notice that although a byte is read, an int
// with value between 0 and 255 is returned.
// Then this is converted to an ISO Latin-1 char 
// in the same range before being printed. 
```

所以基本上，这*假设*传入的字节代表 ISO-8859-1 中的一个字符。

如果您使用具有不同编码的控制台，或者可能提供不在*ISO* -8859-1 中的字符，您最终会遇到问题。

基本上，这*不是*好的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:39:48.037

Java 将字符存储为 2 个字节，但对于普通 ASCII 字符，实际数据适合 1 个字节。因此，只要您可以假设正在读取的文件是 ASCII，那么它就可以正常工作，因为字符的实际数值适合单个字节。

# java - IntelliJ IDEA“自动制作项目”的困境

> ID：14635602
> 
> 赞同：18
> 
> 时间：2013-01-31T21:37:11.303
> 
> 标签：java, eclipse, intellij-idea, jrebel

早在 12 月，我就从 Eclipse 切换到 IntelliJ IDEA，但几天后我又切换回来了。今天我再次尝试了 IntelliJ，基本上我只剩下一个问题了。

问题是我想在保存时编译 Java 类。原因是我正在使用 JRebel 来学习新课程。我不想打`⌘</kbd>+`F9` every time to compile the changed class.`

我阅读了有关 EclipseModel 插件的信息，但这似乎不起作用（不再），可以在插件页面上的评论中阅读：[http ://plugins.jetbrains.com/plugin/?id=3822](http://plugins.jetbrains.com/plugin/?id=3822)

我还尝试了“*自动生成项目*”，但这会编译所有类，而不仅仅是更改后的类。这不仅不会更耗时，还会导致 JRebel 重新加载所有类。

有什么建议么？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-02-01T13:16:28.523

我最终创建了一个执行 Save 和 Make Build 的宏。然后我为这个宏分配了 Ctrl+S 快捷方式，然后它就可以正常工作了。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T23:29:26.743

如果您只是将键从`Ctrl`+重新映射`F9`到`Ctrl`+`S`怎么办？基本上，您将保持按`Ctrl`+的习惯，`S`因为您在 Eclipse 中这样做 - 只需在 IntelliJ 中按不同的键即可。

IntelliJ IDEA 12 确实带有进程外编译器，它会自动编译项目类，但这似乎是不可预测的——您可能刷新页面并且该类尚未编译。因此，不幸的是，在使用 JRebel 的场景中，进程外编译是没有用的。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-10-09T21:56:32.290

这可能不是你想要的，但通常我会打开自动保存，当我需要编译我正在处理的当前类时，我只是这样做`Ctrl + Shift + F9.`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-02-08T02:59:23.163

我的 IntelliJ IDEA 版本是 2017.3.4，我修改了一些值，使其自动编译。

[![设置](../Images/b2af3a0ed3cfd73ec5123e5b32f2bfe2.png)](https://i.stack.imgur.com/zPFqb.png)

[![登记处](../Images/7e1e7689ae78f200ca79c71e8106fec7.png)](https://i.stack.imgur.com/Eo8ht.png)

# visual-studio - MFC CDocument：如何读取已失效应用程序创建的数据库文件的内容？

> ID：14635605
> 
> 赞同：0
> 
> 时间：2013-01-31T21:37:28.717
> 
> 标签：visual-studio, mfc

我在 Visual Studio、MFC 等方面的编码经验几乎为零。但是我有几个数据文件是在一个现已失效的 MFC 应用程序中创建的，我需要将它们迁移到另一种格式。

不幸的是，在应用程序本身中确实没有好的方法来提取数据（缺少单独复制粘贴数百甚至数千条记录）。事实证明，在十六进制编辑器中查看文件本身是徒劳的；即使应用程序存储的原始数据是基于文本的，数据库文件也以某种神秘的二进制格式编码。

到目前为止，我已经能够确定该应用程序是使用 MFC 编写的，并且它使用 CDocument 类（或其简单派生类）来存储文件。我知道基于 CDocument 的数据文件与序列化数据有关，但我不确定如何理解编码。

1.  有没有人足够了解 MFC 来向我解释 CDocument 的实际工作原理？

2.  有人对我如何能够解码这些文件以提取文本有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T05:33:16.380

我曾经遇到过几乎相同的情况。我最终制定了反序列化数据的代码，但这并不容易。

编写一个小型 MFC 应用程序来完成这项工作，这样您就可以利用原始应用程序使用的相同序列化代码。逆向工程数据格式的主题太复杂了，无法在这里回答。它可能没有加密；更有可能被压缩。

如果您是一位经验丰富的程序员，您应该能够阅读 MFC 源代码，然后将这些知识应用于原始数据。不是所有的事情都可以通过观察原始数据来启发式地确定，但如果你有一种独立的方式来确定实际内容，那么通过足够的工作肯定是可能的。

# java - Java - 找不到符号构造函数

> ID：14635606
> 
> 赞同：2
> 
> 时间：2013-01-31T21:37:27.950
> 
> 标签：java, methods, constructor, main

我对Java完全陌生，所以如果我的问题很愚蠢，我很抱歉。我正在做这个任务，我已经阅读了几个小时的主要方法，但我就是想不通。我把我的一些代码放在下面。我可能离这里很远，但我希望完成的是让 main 方法启动构造函数，但是当我编译时，我得到一个错误，说“找不到符号 - 构造函数 Player”。现在，我猜这与构造函数的字符串参数有关，但我全力以赴。如果有人能对此有所了解，可能是非常简单的问题，我会很高兴:)

```
public class Player {
private String nick;
private String type;
private int health;

public static void main(String[] args)
{
    Player player = new Player();
    player.print();
}

public Player(String nickName, String playerType) 
{

    nick = nickName;
    type = playerType;
    health = 100;
    System.out.println("Welcome " + nick +" the " + type + ". I hope you are ready for an adventure!");
}

   public void print()
{
    System.out.println("Name: " + nick);
    System.out.println("Class: " + type);
    System.out.println("Remanining Health: " + health);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:39:16.747

`Player`没有无参数构造函数，你可以使用：

```
Player player = new Player("My Nickname", "Player Type"); 
```

如果您希望提示用户输入`Player`参数，您可以这样阅读：

```
Scanner scanner = new Scanner(System.in);
System.out.print("Enter Player Name:");
String nickName = scanner.nextLine();
System.out.print("Enter Player Type:");
String playerType = scanner.nextLine();
Player player = new Player(nickName, playerType); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:39:00.080

显然，您正在使用`0-arg constructor`，当您还没有时：-

```
Player player = new Player(); 
```

请注意，当您在类中提供参数化构造函数时，编译器不会添加默认构造函数。如果您正在使用它，则必须手动添加一个 0-arg 构造函数。

因此，您可以`0-arg constructor`像这样添加一个：-

```
public Player() {
    this.nick = "";
    this.type = "";
    this.health = -1;
} 
```

或者，使用参数化构造函数来创建对象。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T21:38:44.217

当您的类显式定义[构造函数](http://docs.oracle.com/javase/tutorial/java/javaOO/constructors.html)时，不会创建隐式无参数构造函数。

你的类中有显式构造函数

```
public Player(String nickName, String playerType) 
{

    nick = nickName;
    type = playerType;
    health = 100;
    System.out.println("Welcome " + nick +" the " + type + ". I hope you are ready for an adventure!");
} 
```

并尝试调用无参数构造函数

```
 Player player = new Player(); 
```

您需要在上面的代码中传递参数（或）创建无参数构造函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T21:51:35.210

当缺少构造函数时，java会创建一个默认构造函数，这个构造函数只是调用超类。当您定义一个显式构造函数时，java 不会创建一个。因此，您可以在类中定义一个默认构造函数，例如

```
public Player() 
{   nick = "abc";
    type = "type";
    health = 100;
    System.out.println("Welcome " + nick +" the " + type + ". I hope you are ready for an adventure!");
} 
```

或者修改代码来调用你定义的构造函数。

```
 Player player = new Player("nick","type"); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T22:00:37.600

您在 - 方法中尝试做的`main()`是创建一个新的 Player 对象。但问题是你必须使用你实现的构造函数（`Player(String, String)`），但是你使用了一个没有任何参数的构造函数（`Player()`）。

您应该使用空字符串（例如，如果您想获得一个玩家假人）

```
Player player = new Player("",""); 
```

或者您应该为新玩家实例指定您想要的名称和类型，例如

```
Player player = new Player("flashdrive2049","Player"); 
```

问候。

# html - html、css。给定字体大小占用了多少垂直像素？

> ID：14635610
> 
> 赞同：0
> 
> 时间：2013-01-31T21:37:50.757
> 
> 标签：html, css

我有一个已知高度的 div，以 px 为单位。在这个 div 中，我有一些字体大小已知的文本，以 px 为单位。现在我想使用 padding-top 将文本向下推，使其接触到其下方的元素。但是，它不能通过推得太远来扩展 div。

如何计算填充？只需从 div-height 中减去 font-size，就会导致 div 扩展，即使我设置了 line-height:100%。是否有基于字体定义的高度 - 它总是相同的吗？还是取决于字体系列。我想它至少必须取决于字体粗细。

（不想使用 position:absolute 来解决下推问题。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:10:07.610

它因字体系列而异。每种字体都有不同的基线。如果您将容器的高度设置为与字体的高度匹配，那么字体仍将悬挂在容器下方。这可以使用 line-height 居中，但是在字体上方和下方仍然会有一些空间。

这是一篇更好地解释这一点的文章。

[http://blog.typekit.com/2010/07/14/font-metrics-and-vertical-space-in-css/](http://blog.typekit.com/2010/07/14/font-metrics-and-vertical-space-in-css/)

**演示：**

这也是我开始的演示。您可以轻松判断基线在哪里以及顶部有多少额外空间。当 line-height 设置为等于 font-size 时，它​​会垂直居中字体。但是，如您所见，顶部和底部仍有一些空白区域。所以字体本身与容器的高度并不完全相同。

**HTML**

```
<h1>ABCDEFGHIJKLMNOPQRSTUVWXYZ</h1>
<h1>abcdefghijklmnopqrstuvwxyz</h1>

<h2>ABCDEFGHIJKLMNOPQRSTUVWXYZ</h2>
<h2>abcdefghijklmnopqrstuvwxyz</h2>

<h3>ABCDEFGHIJKLMNOPQRSTUVWXYZ</h3>
<h3>abcdefghijklmnopqrstuvwxyz</h3>

<h4>ABCDEFGHIJKLMNOPQRSTUVWXYZ</h4>
<h4>abcdefghijklmnopqrstuvwxyz</h4> 
```

**CSS**

```
h1 { 
    font-family:sans-serif;
    font-size:34px;
    height:34px;
    margin-bottom:5px;
    border:1px solid #CCC;
}

h2 { 
    font-family:serif;
    font-size:34px;
    height:34px;
    margin-bottom:5px;
    color:blue;
    border:1px solid #CCC;
    line-height:34px; /*NOTE THIS ONE HAS LINE-HEIGHT*/
}

h3 { 
    font-family:"impact";
    font-size:34px;
    height:34px;
    margin-bottom:5px;
    border:1px solid #CCC;
}

h4 {
    font-family:"Courier New";
    font-size:34px;
    height:34px;
    margin-bottom:5px;
    border:1px solid #CCC;
} 
```

**小提琴网址：**

[http://jsfiddle.net/KtY4F/9/](http://jsfiddle.net/KtY4F/9/)

# java - 如何读取整个文件并列出文件中的项目？

> ID：14635611
> 
> 赞同：-3
> 
> 时间：2013-01-31T21:37:52.663
> 
> 标签：java

我有一个看起来像这样的文本文件：

```
acorn squash 2365989335
alfalfa sprouts 3988549919
almond 9277904615
anchovy 3352461607
anise 0846115239
apple 7827295890
apricot 0662812477
artichoke 5974131818
asparagus 8485010646 
```

它继续进行另外几百项。该列表有项目名称，然后是它旁边的 UPC，然后是一个新行，它就这样继续。

我应该阅读此文件（foodUPC.txt）并将所有项目放入列表中以备后用。我被困在试图将所有这些项目放入列表中。稍后，我必须阅读所有商品，然后根据商品的 UPC 退回商品。我也不知道该怎么做。

感谢您的所有帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:44:00.503

我认为 NIO API 可以派上用场，因为您可以轻松地从文件中读取所有行（看到您的项目由换行符分隔）：

```
List<String> lines = Files.readAllLines( Paths.get("foodUPC.txt"), Charset.forName( "MyCharset" ) /* or Charset.defaultCharset(), although this is not recommended for portable apps! */ );
for( String line : lines ) {
    String[] arr = line.split( " " );
    // here comes your code
} 
```

问候。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:40:45.787

[BufferedReader](http://docs.oracle.com/javase/6/docs/api/index.html?overview-summary.html)，[String.split(...)](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#split%28java.lang.String%29)和[HashMap](http://docs.oracle.com/javase/6/docs/api/index.html?overview-summary.html)是你想要的。我会让你把这三个放在一起。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:05:28.017

我会使用 hashmap-upc 代码是键，值是名称

获取映射 - 使用正则表达式分割线

```
InputStream    inputStream;
BufferedReader buffreader;

HashMap<String, String> hm= new HashMap<String,String>();

inputStream= new FileInputStream("foodUPC.txt");
buffreader= new BufferedReader(new InputStreamReader(inputStream, Charset.forName("UTF-8")));
while ((line = buffreader.readLine()) != null) {
   String[] datas=line.split(" ");[if its a tab use \t]
hm.put(datas[0],datas[1]);
} 
```

在你需要的地方使用这张地图。

# .net - Entity Framework 5.0 Code First 映射异常

> ID：14635612
> 
> 赞同：0
> 
> 时间：2013-01-31T21:37:59.140
> 
> 标签：.net, c#-4.0, ef-code-first, sql-server-ce, entity-framework-5

我有以下类，我用 [NotMapped] 属性标记了所有非基元。然而它继续给我以下错误：

我在用：

*   VS 2010 SP1
*   .Net 4.0 (C#) - WinForms
*   实体框架 5.0 代码优先
*   SQL 紧凑型 (CE) 3.5

`The type 'MySolution.Core.Blob' was not mapped. Check that the type has not been explicitly excluded by using the Ignore method or NotMappedAttribute data annotation. Verify that the type was defined as a class, is not primitive, nested or generic, and does not inherit from EntityObject.`

```
[System.ComponentModel.DataAnnotations.Schema.Table("Blob")]
public partial class Blob
{
    [System.ComponentModel.DataAnnotations.Schema.NotMapped]
    private AForge.Imaging.Blob BlobInternal { get; set; }

    public Blob ()
    {
        this.BlobInternal = new AForge.Imaging.Blob(0, new System.Drawing.Rectangle());
    }

    public Blob (int id, System.Drawing.Rectangle rect)
    {
        this.BlobInternal = new AForge.Imaging.Blob(id, rect);
    }

    public Blob (AForge.Imaging.Blob source)
    {
        this.BlobInternal = new AForge.Imaging.Blob(source);
    }

    [System.ComponentModel.DataAnnotations.Schema.Column("OriginalSize")]
    public bool OriginalSize { get { return (this.BlobInternal.OriginalSize); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("Id")]
    public int Id { get { return (this.BlobInternal.ID); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("Area")]
    public int Area { get { return (this.BlobInternal.Area); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("Fullness")]
    public double Fullness { get { return (this.BlobInternal.Fullness); } }

    [System.ComponentModel.DataAnnotations.Schema.NotMapped]
    public AForge.Point CenterOfGravity { get { return (this.BlobInternal.CenterOfGravity); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("CenterOfGravityX")]
    public float CenterOfGravityX { get { return (this.BlobInternal.CenterOfGravity.X); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("CenterOfGravityY")]
    public float CenterOfGravityY { get { return (this.BlobInternal.CenterOfGravity.Y); } }

    [System.ComponentModel.DataAnnotations.Schema.NotMapped]
    public System.Drawing.Rectangle Rectangle { get { return (this.BlobInternal.Rectangle); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("RectangleX")]
    public int RectangleX { get { return (this.BlobInternal.Rectangle.X); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("RectangleY")]
    public int RectangleY { get { return (this.BlobInternal.Rectangle.Y); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("RectangleW")]
    public int RectangleW { get { return (this.BlobInternal.Rectangle.Width); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("RectangleH")]
    public int RectangleH { get { return (this.BlobInternal.Rectangle.Height); } }

    [System.ComponentModel.DataAnnotations.Schema.NotMapped]
    public System.Drawing.Color ColorMean { get { return (this.BlobInternal.ColorMean); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorMeanA")]
    public byte ColorMeanA { get { return (this.BlobInternal.ColorMean.A); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorMeanR")]
    public byte ColorMeanR { get { return (this.BlobInternal.ColorMean.R); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorMeanG")]
    public byte ColorMeanG { get { return (this.BlobInternal.ColorMean.G); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorMeanB")]
    public byte ColorMeanB { get { return (this.BlobInternal.ColorMean.B); } }

    [System.ComponentModel.DataAnnotations.Schema.NotMapped]
    public System.Drawing.Color ColorStdDev { get { return (this.BlobInternal.ColorStdDev); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorStdDevA")]
    public byte ColorStdDevA { get { return (this.BlobInternal.ColorStdDev.A); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorStdDevR")]
    public byte ColorStdDevR { get { return (this.BlobInternal.ColorStdDev.R); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorStdDevG")]
    public byte ColorStdDevG { get { return (this.BlobInternal.ColorStdDev.G); } }

    [System.ComponentModel.DataAnnotations.Schema.Column("ColorStdDevB")]
    public byte ColorStdDevB { get { return (this.BlobInternal.ColorStdDev.B); } }

    [System.ComponentModel.DataAnnotations.Schema.NotMapped]
    public AForge.Imaging.UnmanagedImage Image { get { return (this.BlobInternal.Image); } }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T17:56:42.740

如果要在 SQL CE 中使用 EF Code Fisrt，则需要为其配置 ConectionFactory。

您可以看到使用 SQL CE 运行 EF 的唯一行是：

Database.DefaultConnectionFactory = new SqlCeConnectionFactory("System.Data.SqlServerCe.3.5");

可以[在 MSDN Gallery中下载的示例](http://code.msdn.microsoft.com/Using-SqlServer-Compact-a476bf83)

# c# - 将 WebSecurity 与 .Net winForms 应用程序一起使用

> ID：14635614
> 
> 赞同：4
> 
> 时间：2013-01-31T21:38:07.830
> 
> 标签：c#, asp.net-mvc-4

我正在尝试`WebMatrix.WebData.WebSecurity()`在桌面应用程序中实现该方法`.Net`，该应用程序将与项目一起连接到服务器上的数据库，`MVC4`因此我想在两个应用程序上使用当前提供程序来验证用户。

我想知道这是否可能，因为我遇到了异常：

```
{System.InvalidOperationException: To call this method, the 
"Membership.Provider" property must be an instance of 
"ExtendedMembershipProvider".
 at WebMatrix.WebData.WebSecurity.VerifyProvider() 
```

`Web.Config`我已将我的应用程序复制`MVC4`到我的`app.config`文件中，但我似乎仍然无法让它工作。任何方向将不胜感激

**编辑** 这与位于 MVC4 控制器上的 [InitializeSimpleMembership] 属性有关。这将为 WebSecurity 执行一些初始化。谁能看到如何在没有属性的情况下初始化此代码？

再次感谢

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T18:54:57.540

> 我正在尝试在 .Net 桌面应用程序中实现 WebMatrix.WebData.WebSecurity() 方法

忘掉它。Membership 提供程序与 ASP.NET 上下文紧密耦合，不打算在桌面应用程序中使用。它取决于桌面应用程序中不存在的诸如 HttpContext、cookies 之类的东西。

相反，您可以做的是定义一个可重用的服务层，您可以直接在桌面应用程序中使用该服务层，然后实现 ASP.NET 成员资格提供程序调用此服务层的方法，从而在两者之间重用相同的功能。

# jquery - 在 iframe jquery 中访问内容

> ID：14635625
> 
> 赞同：0
> 
> 时间：2013-01-31T21:38:41.683
> 
> 标签：jquery

我在 iframe 中有一个文本区域。当我尝试在 textarea 中进行任何类型的 jquery 操作时，它不会响应。

文本区域最初使用这个简单的代码在 iframe 中加载数据。

```
//txtHozSliderEmail is the textarea in the iframe
 $('#txtHozSliderEmail').val(notificationTemplate.Body) 
```

但是当我在后续调用中更改 notificationTemplate.Body 的值时，会显示第一次调用的数据。文本区域不会更新。我验证了 notificationTemplate.Body 在每次通话中都有不同的数据，所以不是这样。

iframe 嵌套在主页面内。

当我检查“框架”集合时，我可以看到它有 2 个框架，我如何才能看到它们的名称？当我在 html 中查看 iframe 时，它​​似乎没有 id。我是否必须给它一个“id”才能访问它或其他一些属性？

iframe 位于我没有访问外部域的同一域/服务器上。iframe 正在 jHtmlArea.js 库中使用

这里是创建 iframe 的库中的代码：

```
 var iframe = this.iframe = $("<iframe/>").height(textarea.height());
        iframe.width('580px');
        iframe.height('180px');
        //iframe.width(textarea.width() - ($.browser.msie ? 0 : 4));
        var htmlarea = this.htmlarea = $("<div/>").append(iframe); 
```

# asp.net - iPad 6_0_1 ScriptManager.SupportsPartialRendering ASP.Net

> ID：14635631
> 
> 赞同：1
> 
> 时间：2013-01-31T21:39:01.373
> 
> 标签：asp.net, ajax, ipad, scriptmanager

几个月前我们开始收到以下错误，它看起来像 mac os 6。有人可以帮我解释一下下面的问题吗？我们的网站上有很多部分渲染，但似乎 asp.net 认为 ipad 6_0_1 无法处理。

事件目标：ctl00$ScriptManager1

异常：System.Web.HttpUnhandledException (0x80004005)：引发了“System.Web.HttpUnhandledException”类型的异常。---> System.InvalidOperationException：页面正在执行异步回发，但 ScriptManager.SupportsPartialRendering 属性设置为 false。确保在异步回发期间将该属性设置为 true。在 System.Web.UI.ScriptManager.OnPageInitComplete(Object sender, EventArgs e) 在 System.EventHandler.Invoke(Object sender, EventArgs e) 在 System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint) 在 System。 System.Web.UI.Page.ProcessRequest 处的 Web.UI.Page.HandleError（异常 e） System.Web.UI.Page.ProcessRequestMain（布尔 includeStagesBeforeAsyncPoint，布尔 includeStagesAfterAsyncPoint）（布尔 includeStagesBeforeAsyncPoint，

用户代理：Mozilla/5.0 (iPad; CPU OS 6_0_1 like Mac OS X) AppleWebKit/536.26 (KHTML, like Gecko) Version/6.0 Mobile/10A523 Safari/8536.25

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-07T04:50:29.030

由于我整天都在做这件事，所以我想除了上面的评论之外，我还会发布我最终做的事情。看起来重要的浏览器功能是

```
ecmascriptversion=1.5
w3cdomversion=1.0
supportscallback=true 
```

如果其中任何一个不存在，则不会创建 Sys.WebForms 对象。

我最终在 App_Browsers 文件夹中创建了一个自定义浏览器文件：

```
<browsers>
   <gateway id="IPad" parentID="Safari">
      <identification>
         <userAgent match="iPad" />
      </identification>

      <capabilities>
         <capability name="ecmascriptversion" value="1.5" />
         <capability name="w3cdomversion" value="1.0" />
         <capability name="supportscallback" value="true" />
         <capability name="supportsxmlhttp" value="true" />
      </capabilities>
   </gateway>
</browsers> 
```

最后一个功能对于创建 Sys.WebForms 对象不是必需的，但是我不太确定在*没有*XMLHttpRequest 对象的情况下 Ajax 应该如何工作。

# c# - Add Indexed (Duplicated OK) to access database C#

> ID：14635642
> 
> 赞同：0
> 
> 时间：2013-01-31T21:39:40.107
> 
> 标签：c#, ms-access

I have an application which inserts large amount of data in Access database. So to speed up the things i have set Indexed property to No.

So at the end of insertion i need to set the index to the column of the one of the table to Indexed (Duplicates OK) through C#.

I tried:

```
string addIndex = "CREATE INDEX columnName ON table(columnName) WITH IGNORE NULL";
OleDbCommand cmd = new OleDbCommand(addIndex, conn);
cmd.ExecuteNonQuery(); 
```

but it didn't work.

Help would be appreciated.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:50:42.610

Try not using the column name as the index name:

```
CREATE INDEX idx_columnName ON table(columnName) WITH IGNORE NULL 
```

Access may not let you name an index the same as an existing column (or table)

# php - 带有AND运算符的Mysql搜索查询：过滤掉空参数

> ID：14635644
> 
> 赞同：0
> 
> 时间：2013-01-31T21:39:49.297
> 
> 标签：php, mysql

我有一个使用 OR 构建的搜索查询，但我想使用 AND 来获得更少的结果。不幸的是，由于某些参数（VatStatut、VarDomaine 等）在输入表单中为空，我根本没有得到任何结果。如何过滤掉这些空参数？

```
$VarStatut_jeu_res1 = "%";
if (isset($_POST['choix_statut'])) {
$VarStatut_jeu_res1 = $_POST['choix_statut'];
}

$VarSujet_jeu_res1 = "%";
if (isset($_POST['choix_sujet'])) {
$VarSujet_jeu_res1 = $_POST['choix_sujet'];
}

$VarDateEcheance1_jeu_res1 = "%";
if (isset($_POST['choix_dateecheance1'])) {
$VarDateEcheance1_jeu_res1 = $_POST['choix_dateecheance1'];
}

$VarDateEcheance2_jeu_res1 = "%";
if (isset($_POST['choix_dateecheance2'])) {
$VarDateEcheance2_jeu_res1 = $_POST['choix_dateecheance2'];
}

$VarDateOrigine1_jeu_res1 = "%";
if (isset($_POST['choix_dateorigine1'])) {
$VarDateOrigine1_jeu_res1 = $_POST['choix_dateorigine1'];
}

$VarDateOrigine2_jeu_res1 = "%";
if (isset($_POST['choix_dateorigine2'])) {
$VarDateOrigine2_jeu_res1 = $_POST['choix_dateorigine2'];
}

$VarTheme_jeu_res1 = "%";
if (isset($_POST['choix_theme'])) {
$VarTheme_jeu_res1 = $_POST['choix_theme'];
}

$VarAuteur_jeu_res1 = "%";
if (isset($_POST['choix_auteur'])) {
$VarAuteur_jeu_res1 = $_POST['choix_auteur'];
}

$VarDomaine_jeu_res1 = "%";
if (isset($_POST['choix_domaine'])) {
$VarDomaine_jeu_res1 = $_POST['choix_domaine'];
}

mysql_select_db($database_ConnJournal, $ConnJournal);

$query_jeu_res1 = sprintf("SELECT * FROM Projets1 WHERE Projets1.Statut LIKE %s OR       Projets1.Domaine LIKE %s OR Projets1.Auteur LIKE %s OR Projets1.Theme LIKE %s OR Projets1.DateOrigine BETWEEN %s AND %s OR Projets1.DateEcheance BETWEEN %s AND %s OR MATCH (Sujet) AGAINST (%s) ORDER BY Projets1.DateHeure DESC", 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:42:42.360

尝试使用`empty()`而不是`isset`. 这样，如果变量存在但为空字符串，则不会设置参数。

IE

```
$VarDomaine_jeu_res1 = "%";
if (!empty($_POST['choix_domaine'])) {
    $VarDomaine_jeu_res1 = $_POST['choix_domaine'];
} 
```

（注意我们使用的是`!empty()`）

# c# - 将 IIS 托管的 WCF 服务添加到注册表编辑器以允许写入事件日志

> ID：14635650
> 
> 赞同：0
> 
> 时间：2013-01-31T21:40:05.143
> 
> 标签：c#, windows, wcf, registry, event-log

我有一个无法写入事件日志的 WCF 服务，因为它没有创建事件源的权限。我已按照[此处](http://support.microsoft.com/kb/310516)找到的 MSDN 站点上的说明进行操作，但是它们相对不具描述性。

将 WCF 服务引用添加到注册表编辑器的正确过程是什么`[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Eventlog\Application\MySourcesName]`

我需要除, ,之外的任何`Name`, `Type`,`Data`值吗`(Default)``REG_SZ``(value not set)`

# php - 在 xpath 查询中使用 php 变量

> ID：14635654
> 
> 赞同：3
> 
> 时间：2013-01-31T21:40:23.363
> 
> 标签：php, variables, xpath

我想在 xpath 语句中使用 php 变量。[这里](https://stackoverflow.com/questions/2109161/adding-php-variable-into-xpath)有一个类似的线程，其答案不能解决我的问题。

这是示例代码（ $r1 或 $r2 都没有创建预期的数组）

```
<?php
$xml = simplexml_load_file("menu.xml");
$term = "one";
$r1 = $xml->xpath("//category[@name=$term]");
$r2 = $xml->xpath("//category[@name=" . $term . "]");
$r3 = $xml->xpath("//category[@name='one']");

echo ('$r1 = '); print_r($r1);
echo ('<br>$r2 = '); print_r($r2);
echo ('<br>$r3 = '); print_r($r3);
?> 
```

XML

```
<?xml version="1.0" encoding="ISO-8859-1"?>
<menu>
<category name="one">
    <item>Tomato and Cheese</item>
    <item>Onions</item>
    <item>Broccoli</item>
</category>
<category name="two">
    <item>Burger and Fries</item>
    <item>Chicken Sandwich</item>
</category>
<category name="three">
    <item>Filet of Fish</item>
    <item>Exotic Meat Stew</item>   
</category> 
```

输出

```
$r1 = Array ( )
$r2 = Array ( ) 
$r3 = Array ( [0] => SimpleXMLElement Object ( [@attributes] => Array ( [name] => one ) [item] => Array ( [0] => Tomato and Cheese [1] => Onions [2] => Broccoli ) ) ) 
```

我可能错过了一些非常简单但被卡住的东西！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:44:39.483

您应该在变量周围添加单引号

```
$xml = simplexml_load_string($xml);
$term = "one";
$r1 = $xml->xpath("//category[@name='$term']");
$r2 = $xml->xpath("//category[@name='" . $term . "']");
$r3 = $xml->xpath("//category[@name='one']");

echo ('$r1 = '); print_r($r1);
echo ('<br>$r2 = '); print_r($r2);
echo ('<br>$r3 = '); print_r($r3); 
```

输出

```
$r1 = Array ( [0] => SimpleXMLElement Object ( [@attributes] => Array ( [name] => one ) [item] => Array ( [0] => Tomato and Cheese [1] => Onions [2] => Broccoli ) ) )
$r2 = Array ( [0] => SimpleXMLElement Object ( [@attributes] => Array ( [name] => one ) [item] => Array ( [0] => Tomato and Cheese [1] => Onions [2] => Broccoli ) ) )
$r3 = Array ( [0] => SimpleXMLElement Object ( [@attributes] => Array ( [name] => one ) [item] => Array ( [0] => Tomato and Cheese [1] => Onions [2] => Broccoli ) ) ) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:44:42.540

自从我使用 xpath 语法以来已经有一段时间了，但是，通过推论，它看起来像单引号的唯一区别：

以下是*等价*的。

```
$xml = simplexml_load_file("menu.xml");
$term = "one";
$r1 = $xml->xpath("//category[@name='$term']");
$r2 = $xml->xpath("//category[@name='" . $term . "']");
$r3 = $xml->xpath("//category[@name='one']"); 
```

# javascript - 将 Twitter 页面提要更改为我自己的 Twitter

> ID：14635658
> 
> 赞同：0
> 
> 时间：2013-01-31T21:40:32.667
> 
> 标签：javascript, twitter, twitter-bootstrap

几周前我买了一个 WrapBootstrap 主题，我正试图弄清楚如何将 twitter 提要从创建者更改为我自己的。我已经发布了 twitter.js 文件。用户名会发布在其他地方吗？

```
function tz_format_twitter(twitters) {
  var statusHTML = [];
  for (var i=0; i<twitters.length; i++){
    var username = twitters[i].user.screen_name;
    var status = twitters[i].text.replace(/((https?|s?ftp|ssh)\:\/\/[^"\s\<\>]*    [^.,;'">\:\s\<\>\)\]\!])/g, function(url) {
      return '<a href="'+url+'">'+url+'</a>';
    }).replace(/\B@([_a-z0-9]+)/ig, function(reply) {
      return  reply.charAt(0)+'<a     href="http://twitter.com/'+reply.substring(1)+'">'+reply.substring(1)+'</a>';
    });
    statusHTML.push('<li><span>'+status+'</span> <br/><b><a     href="http://twitter.com/'+username+'/statuses/'+twitters[i].id_str+'">'+relative_time(twitter    s[i].created_at)+'</a></b></li>');
  }
  return statusHTML.join('');
}

function relative_time(time_value) {
  var values = time_value.split(" ");
  time_value = values[1] + " " + values[2] + ", " + values[5] + " " + values[3];
  var parsed_date = Date.parse(time_value);
  var relative_to = (arguments.length > 1) ? arguments[1] : new Date();
  var delta = parseInt((relative_to.getTime() - parsed_date) / 1000);
  delta = delta + (relative_to.getTimezoneOffset() * 60);

  if (delta < 60) {
    return 'less than a minute ago';
  } else if(delta < 120) {
    return 'about a minute ago';
  } else if(delta < (60*60)) {
    return (parseInt(delta / 60)).toString() + ' minutes ago';
  } else if(delta < (120*60)) {
    return 'about an hour ago';
  } else if(delta < (24*60*60)) {
    return 'about ' + (parseInt(delta / 3600)).toString() + ' hours ago';
  } else if(delta < (48*60*60)) {
    return '1 day ago';
  } else {
    return (parseInt(delta / 86400)).toString() + ' days ago';
  }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T14:11:54.353

在 custom.js 文件中找到它

# c# - 从 CLRProfiler 运行应用程序时出现 UnauthorizedAccessException

> ID：14635660
> 
> 赞同：0
> 
> 时间：2013-01-31T21:40:38.370
> 
> 标签：c#, performance, clrprofiler

我有一个尝试使用 CLRProfiler 分析的应用程序，它是用 .NET 4.0 编写的，并且 WPF 在 .NET Framework 4 Client Profile 上运行。应用程序在启动后不久加载一个数据文件，该文件的位置在 app.config 中（因此在程序运行时不会以交互方式选择它）。从 Visual Studio 或 Windows 资源管理器启动应用程序时，一切正常。

但是，当从 CLRProfiler 启动应用程序时，应用程序在`UnauthorizedAccessException`尝试加载文件时崩溃。

尝试解决此问题时，我将所述文件的完全控制权限授予我自己、域用户和所有人，但问题仍然存在。监视任务管理器时，显示的短暂进程已在我的用户 ID 下启动。

有谁知道如何用 CLRProfiler 解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T16:13:55.100

最终，这被证明是两个问题的结合：

1.  没有以管理员身份运行。

2.  上面引用的数据文件在配置文件中指定了路径，但路径是相对的。当 CLRProfiler 启动应用程序时，工作目录仍然是分析器的工作目录，而不是切换到正在分析的应用程序。由于我是非特权运行的，因此无法打开数据文件实际上表现为一个，`UnauthorizedException`因为应用程序没有权限在安装探查器的文件夹中进行 root。

在更正这两个之后（第一个通过以管理员身份运行，第二个通过更改配置文件以使用绝对路径），问题消失了。

# wpf - 打开的windows C# WPF

> ID：14635663
> 
> 赞同：2
> 
> 时间：2013-01-31T21:40:43.297
> 
> 标签：wpf, windows

我有这个问题：

在 C# WPF 应用程序中：

> 1.  我打开一个新窗口`(showOnTaskBar=true, noresize, centered);`
>     
>     
> 2.  从这个打开的窗口中，我打开另一个打开的窗口上方的另一个窗口。新窗口没有蓝色顶栏，并且 `showOnTaskbar=false, showDialog();`
>     
>     
> 3.  一切都很好，但如果我改变焦点，我的意思是，例如，我打开 Firefox 或其他程序，然后我想回到我打开的窗口我只看到第一个打开的窗口（从步骤 1 开始）另一个模态窗口来了仅与`ALT+TAB.`

那么，有没有办法让两个窗口始终显示？

打开第二个窗口的代码（从步骤 1 中的第一个正常打开的窗口开始）：

```
 Form2 form2 = new Form2();
    formA2.ShowInTaskbar = false;
    form2.ShowDialog(); 
```

谢谢你，阿德里安

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T08:39:16.623

如果我认为您已经说过要从第一个窗口打开第二个窗口，那么我很确定您想尝试像这样设置对话框的所有者：

```
form2.Owner = Window.GetWindow(this); 
```

请参阅[WPF：如何设置用户控件显示的对话框的所有者窗口？](https://stackoverflow.com/questions/607370/wpf-how-do-i-set-the-owner-window-of-a-dialog-shown-by-a-usercontrol)

希望这会有所帮助，杰伊

# vb.net - VB 2010 express 的情况非常糟糕

> ID：14635666
> 
> 赞同：1
> 
> 时间：2013-01-31T21:40:47.037
> 
> 标签：vb.net, visual-studio-2010, crash

我在 vb 2010 express 上遇到了智能感知错误。我尝试编辑代码并且智能感知崩溃了。我尝试禁用智能感知，但它也崩溃了。它变得更糟了，现在当我打开 vb 时它会导致我的计算机崩溃。我试过修复它，它说它无法安装 Microsoft 错误报告。我试图卸载它，它说 .dll 有问题，并告诉我看看我是否可以访问它。该dll存在，我很容易找到它。我试过重新启动计算机并卸载它，但没有任何效果。请帮帮我，这非常严重。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T06:59:57.247

最好卸载并重新安装 Visual Studio。重新启动系统后尝试卸载。如果这不起作用，请尝试以安全模式启动并卸载。如果这不起作用，请尝试使用“修复”选项重新安装。如果这不起作用，作为最后的手段，您也许可以在计算机上重新安装 Visual Studio 的第二个副本并使用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-01T09:25:36.637

我会重新安装整个计算机。重新安装 Windows 并从那里开始。
不修，不修。干净安装。

# sql - 将具有平面数据的旧数据库复制到具有规范化数据的新数据库

> ID：14635668
> 
> 赞同：1
> 
> 时间：2013-01-31T21:40:58.830
> 
> 标签：sql, sql-server, tsql

我有一个旧数据库，它是一个单一的平面表。我想将旧数据复制到新的数据库结构中。两者都是 MSSQL 数据库。这是我想要做的一个简化示例：

```
OLD_DB                                     New_DB

Customers_Table             Customers_Table         Phone_Numbers
---------------             --------------          -------------  
FirstName                   CustomerID              PhoneNumberID
LastName          -->       FirstName               CustomerID
PhoneNumber1                LastName                PhoneNumber
PhoneNumber2
PhoneNumber3 
```

我了解如何复制平面数据。这似乎工作得很好：

```
INSERT INTO   New_DB.dbo.Customers_Table (FirstName, LastName)
SELECT        FirstName, LastName
FROM          OLD_DB.dbo.Customers_Table 
```

我只是不知道如何将电话号码输入新结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:48:09.843

如果您的 FirstName 和 LastName 是您的唯一标识符，则可以`UNION`在运行上述语句后使用：

```
INSERT INTO New_DB.dbo.Phone_Numbers (CustomerId, PhoneNumber)
SELECT C.CustomerID, OldC.PhoneNumber1
FROM New_DB.dbo.Customers_Table C
  JOIN OLD_DB.dbo.Customers_Table OldC ON C.FirstName = OldC.FirstName 
     AND C.LastName = OldC.LastName 
     AND OldC.PhoneNumber1 IS NOT NULL
UNION
SELECT C.CustomerID, OldC.PhoneNumber2
FROM New_DB.dbo.Customers_Table C
  JOIN OLD_DB.dbo.Customers_Table OldC ON C.FirstName = OldC.FirstName 
     AND C.LastName = OldC.LastName 
     AND OldC.PhoneNumber2 IS NOT NULL
UNION
SELECT C.CustomerID, OldC.PhoneNumber3
FROM New_DB.dbo.Customers_Table C
  JOIN OLD_DB.dbo.Customers_Table OldC ON C.FirstName = OldC.FirstName 
     AND C.LastName = OldC.LastName 
     AND OldC.PhoneNumber3 IS NOT NULL 
```

或者，您可以使用`UNPIVOT`并运行类似的东西（我已经将其压缩以进行测试，但概念相同）：

```
SELECT Id, Phone 
FROM ( SELECT id, phone1, phone2, phone3 FROM Phone ) p
UNPIVOT
(Phone FOR Phones IN (phone1, phone2, phone3))AS Phone 
```

这是用于的[SQL Fiddle](http://sqlfiddle.com/#!3/339e3/1)`UNPIVOT`：

祝你好运。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:50:44.067

选择电话号码，加入新的公司表以获取 id（当然假设 FirstName 和 LastName 组合是唯一的），对三个电话号码的三个查询进行并集，然后插入到新表中：

```
insert into New_DB.dbo.Phone_Numbers

select c.CustomerID, o.PhoneNumber1
from New_DB.dbo.Customers_Table c
inner join OLD_DB.dbo.Customers_Table o
  on o.FirstName = c.FirstName and o.LastName = c.LastName
where o.PhoneNumber1 is not null

union all

select c.CustomerID, o.PhoneNumber2
from New_DB.dbo.Customers_Table c
inner join OLD_DB.dbo.Customers_Table o
  on o.FirstName = c.FirstName and o.LastName = c.LastName
where o.PhoneNumber2 is not null

union all

select c.CustomerID, o.PhoneNumber3
from New_DB.dbo.Customers_Table c
inner join OLD_DB.dbo.Customers_Table o
  on o.FirstName = c.FirstName and o.LastName = c.LastName
where o.PhoneNumber3 is not null 
```

注意：如果客户在多个字段中具有相同的电话号码，这将创建重复的电话号码。您可以使用`union`而不是`union all`删除这些重复项。

# spring - 带有类名和字段名的 Hibernate Validator 自定义消息键

> ID：14635669
> 
> 赞同：0
> 
> 时间：2013-01-31T21:41:07.293
> 
> 标签：spring, hibernate, validation, messages, field-names

我一直在尝试为 @Controller 类中由 Spring MVC 管理的 REST 服务添加验证错误的自定义消息。

员工类：

```
public class Employee {

    @NotNull
    @NotEmpty
    private String company;
    ...
} 
```

我的 REST 服务：

```
@ResponseStatus(value = HttpStatus.CREATED)
@RequestMapping(method = RequestMethod.POST)
public void add(@RequestBody @Valid Employee employee) {
    employees.add(employee);
} 
```

并且验证错误解析

```
@ResponseStatus(value = HttpStatus.BAD_REQUEST)
@ExceptionHandler(MethodArgumentNotValidException.class)
public @ResponseBody
List<String> validationExceptions(MethodArgumentNotValidException e) {
    List<String> errors = new ArrayList<String>();

    for (FieldError error : e.getBindingResult().getFieldErrors()) {
        errors.add(error.getDefaultMessage());
    }

    return errors;
} 
```

因此，我在类路径的根目录上放置了一个 ValidationMessages.properties，但我无法使用以下 key 获取我的自定义消息`NotEmpty.employee.company`。

我知道有很多方法可以使用 ResourceBundle 和 error.getCode()，甚至使用 key `org.hibernate.validator.constraints.NotEmpty.message`，但我希望有特定对象的特定字段的特定消息。

我也不想这样做`@NotEmpty(message = "NotEmpty.employee.company}")`。我想要最简单的。

我应该怎么办？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T02:42:59.033

您是否尝试过实现自己的

```
org.springframework.validation.MessageCodesResolver 
```

然后在配置文件中声明你的实现：

```
<mvc:annotation-driven message-codes-resolver="org.example.YourMessageCodesResolverImpl"/> 
```

我会试一试，似乎这个能够构建自定义错误代码，就像你想要的那样：

```
String[]    resolveMessageCodes(String errorCode, String objectName, String field, Class<?> fieldType) 
```

我不确定的唯一*重要的事情是它是否会覆盖休眠验证器生成的错误代码......*

我希望它有帮助（并且有效）。

干杯，

奇科。

# git - 对单个 Git 提交进行变基

> ID：14635672
> 
> 赞同：139
> 
> 时间：2013-01-31T21:41:22.720
> 
> 标签：git, rebase

有没有办法将单个提交从一个分支重新定位到另一个分支？

我有这个分支结构：

```
-- -- -- -- -- (Master)
            \
              -- -- -- -- -- XX (Feature-branch) 
```

我要做的就是将最后一次提交重新定位`Feature-branch`到 master 并回滚`Feature-branch`一次提交。

```
-- -- -- -- -- XX (Master)
            \
              -- -- -- -- -- (Feature-branch) 
```

我怎么做？

* * *

## 回答 #1

> 赞同：136
> 
> 时间：2013-01-31T21:46:50.963

您可以挑选 XX 来掌握。

```
git checkout master
git cherry-pick <commit ID of XX> 
```

并使用 git reset 从功能分支中删除最后一次提交。

```
git checkout Feature-branch
git reset --hard HEAD^ 
```

* * *

## 回答 #2

> 赞同：121
> 
> 时间：2013-01-31T21:46:00.067

```
git rebase --onto master branch~1 branch 
```

这表示“在 master 分支的尖端重新调整 last-before-branch 和分支（即 XX 提交）之间的提交范围”

`branch`在提交此操作提示后`XX`，您希望将其设置回来

```
git checkout branch
git reset --hard branch@{1}^ 
```

上面写着“将分支提示重置为之前状态之前的提交”

所以樱桃采摘是一个更简单的解决方案......

* * *

## 回答 #3

> 赞同：75
> 
> 时间：2017-10-26T19:53:15.027

其实做起来很简单。解决方案是进行交互式变基并“删除”您不想包含在变基中的所有提交。

`git rebase -i <target_branch>``target_branch`您要重新定位到的分支在哪里

然后你将编辑打开的文件和`pick`你想要的提交和`drop`（或`d`简称）你不想带来的所有提交。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-09-25T14:50:54.597

@Charles 的回答是正确的。无论如何，我最终使用了很多次，最重要的是在项目上重新设置特定配置

```
  * a8f9182 (HEAD -> production) 生产配置
  | * daa18b7 (pre) 预生产配置
  |/  
  | * d365f5f (local) 本地配置
  |/  
  * 27d2835 (dev) 将拯救世界的惊人新功能
* | 56d2467 (master) 钻孔最先进的项目
|/

```

我为它创建了一个新命令：

```
$ 猫 ~/bin/git-rebaseshot
提交=$1
DEST=${2:-HEAD}
git rebase ${COMMIT}^ ${COMMIT} --onto $DEST

```

通常你想自动完成该命令的分支名称，所以添加它来获取这个函数（添加到 .bashrc 或 .profile）：

```
_git_rebaseshot ()
{
    __gitcomp_nl "$(__git_refs)"
}

```

git autocomplete 将搜索它

你可以像这样使用这个命令：

```
# rebase config on prepro on actual HEAD
$ git rebaseshot prepro 
# rebase config on local onto dev
$ git rebaseshot local dev
# rebase production config on master
$ git rebaseshot pro master 
```

当你正确地划分特征时，可能性是无穷无尽的。

```
* a8f9182 (HEAD -> postgres) BBDD 配置
* a8f9182（本地）本地配置
* a8f9182（调试）日志级别配置
* a8f9182（开发）新功能
|

```

我想这就是[被子](http://linux.die.net/man/1/quilt)人喜欢做的事情。

不管你提供什么 sha/ref，这个命令都可以工作：

```
$ git rebaseshot <Feature branch> master
$ git rebaseshot <commit of XX> master 
```

# python - celery, postgresql -> 配置后端

> ID：14635673
> 
> 赞同：6
> 
> 时间：2013-01-31T21:41:34.010
> 
> 标签：python, celery, backend

所以我刚刚开始使用芹菜并尝试做一些简单的测试来感受它。我试图设置一个芹菜来为我的后端使用 postgres。在此页面上： http:
[//docs.celeryproject.org/en/latest/getting-started/first-steps-with-celery.html#keeping-results](http://docs.celeryproject.org/en/latest/getting-started/first-steps-with-celery.html#keeping-results) 我看到了这个例子

```
celery = Celery('tasks', backend='redis://localhost', broker='amqp://') 
```

所以在我的代码中我尝试

```
celery = Celery('tasks', 
               backend='sqla+postgresql://celery_exp:celery_exp@myhost/celery_exp',
                broker='sqla+postgresql://celery_exp:celery_exp@myhost/celery_exp',) 
```

但我在启动时不断收到此错误：

```
ImportError: No module named sqla+postgresql 
```

在文档中，我尝试了不同的变体，例如

```
postgresql://  
postgresql+psycopg2:// 
```

我知道连接字符串是正确的，因为在 Celery 构造函数中取出后端参数可以按预期工作。
我在这里做错了什么？我觉得这一定很愚蠢，因为我在网上找不到任何东西。

提前致谢。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-07-14T16:52:25.493

答案就在这里[http://celery.readthedocs.org/en/latest/configuration.html#database-url-examples](http://docs.celeryproject.org/en/latest/userguide/configuration.html#database-backend-settings)

您需要在常规 SQL Alchemy url 字符串前面加上`db+`，例如

```
CELERY_RESULT_BACKEND = "db+postgresql+psycopg2://..." 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T17:39:42.660

Celery 获取您传递给它的 URL，查看前缀（在本例中为“sqla+postgresql”）并查找与之匹配的后端。仅使用数据库就没有“通用”加载后端。您可以检查系统上 celery 文件夹中的 backend/ **init** .py 以查看整个别名字典，然后添加您自己的。

# javascript - jQuery添加没有标记的CSS属性

> ID：14635676
> 
> 赞同：0
> 
> 时间：2013-01-31T21:41:47.963
> 
> 标签：javascript, jquery, html, css

我有一个即时生成标记的网站（Wordpress3.5），所以我不能直接将数据工具提示添加到 html 中。因此，我试图通过 Javascript 添加属性。在提供的小提琴中，我添加了一些示例 HTML，有人可以帮助这个[小提琴](http://jsfiddle.net/fkdh8/)尝试成功地将“工具提示”添加到标记或解释为什么我的脚本当前无法正常工作吗？谢谢。

```
// set the tooltip content
jQuery('li#menu-item-75 a:hover:before').prop('tooltipText', 'w00t');
jQuery('li#menu-item-75 a:hover:after').prop('tooltipText', 'w00t'); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T00:43:47.230

使用 data 方法 ( [http://api.jquery.com/data/](http://api.jquery.com/data/) ) 读取和设置数据：

```
$("#myelement").data("tooltip", "my tooltip text"); 
```

# excel - 如何将多个选择从excel复制到word（手动和/或VBA）

> ID：14635677
> 
> 赞同：0
> 
> 时间：2013-01-31T21:41:52.163
> 
> 标签：excel, vba, ms-word

使用 Excel/Word 2007 我正在尝试将多个选择从 Excel 复制到 Word。当我将它粘贴到 Word 中时，就好像它忽略了范围中的中断，只是粘贴了一个包含我试图遗漏的所有内容的范围。

例如，如果我打算复制/粘贴`"A2:D4, A6:D7, A10:D11"`实际粘贴在 word is 中的内容`"A2:D11"`，那么它会忽略选择中的中断。我似乎在任何地方都找不到有关此问题的任何文档。如果有人知道任何事情，我会非常感激。我知道我选择了正确的范围，因为如果我在 Excel 中复制并粘贴多个范围，它的工作原理就应该如此。

实际问题是我在宏中自动执行了这些操作，我真的不希望循环遍历各个范围，因为它们存储在字典中，这真的很麻烦。尽管如此，我什至无法手动完成任务似乎很奇怪。

我已经做了很多挖掘工作，但似乎无法提出任何建议。我考虑过使用 Office 剪贴板，但您不能将表格粘贴为 RTF。使用办公室剪贴板粘贴时似乎没有任何选项。

AFAIK 这似乎不可能，在发帖之前，我已经尝试用尽所有正常的知识途径。如果有人刚刚经历过这种情况，知道我并不孤单会很欣慰。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:01:32.590

我不知道如何防止这种情况发生，但是您可以通过将非连续选择粘贴到新的临时工作表/工作簿中的连续区域中，然后从临时工作表/工作簿中复制连续区域来解决它成词。

有点麻烦，是的，但它应该可以完成工作。

# java - HttpServletRequest isUserInRole() - 如何获取完整的角色列表？

> ID：14635678
> 
> 赞同：6
> 
> 时间：2013-01-31T21:42:04.117
> 
> 标签：java, servlets, basic-authentication, user-roles

HttpServletRequest isUserInRole() 方法将根据角色是否存在返回一个布尔值。现在，如果它正在这样做，它应该在某处拥有登录用户的完整角色列表。我如何获得完整的角色列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:02:11.433

`isUserInRole()`使用`SecurityContext`您的身份验证器需要设置的请求。该`SecurityContext`接口不提供允许您访问此信息的方法，但您可以在身份验证器中执行某些操作以使信息作为提供者可访问，或者将其添加为请求属性并以这种方式访问​​它。

# ios - 在 NSURLConnection 中委托并声明变量 receivedData

> ID：14635679
> 
> 赞同：0
> 
> 时间：2013-01-31T21:42:12.743
> 
> 标签：ios, objective-c, nsurlconnection

我想在 Xcode 4.5.2 for iOS 中创建一个 NSURLConnection 委托，因为[文档](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/URLLoadingSystem/Tasks/UsingNSURLConnection.html#//apple_ref/doc/uid/20001836-BAJEAIEE)建议这样做。现在我将以下代码（直接取自文档）放入我的 AppDelegate.m 方法中`application didFinishLaunchingWithOptions:`。

```
// Create the request.
NSURLRequest *theRequest=[NSURLRequest requestWithURL:[NSURL URLWithString:@"http://www.apple.com/"]
                        cachePolicy:NSURLRequestUseProtocolCachePolicy
                    timeoutInterval:60.0];
// create the connection with the request
// and start loading the data
NSURLConnection *theConnection=[[NSURLConnection alloc] initWithRequest:theRequest delegate:self];
if (theConnection) {
    // Create the NSMutableData to hold the received data.
    // receivedData is an instance variable declared elsewhere.
    receivedData = [[NSMutableData data] retain];
} else {
    // Inform the user that the connection failed.
} 
```

如何在 AppDelegate.h 中创建委托？我在哪里以及如何声明变量`receivedData`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:52:27.403

您不应该在 AppDelegate 中执行此操作，而只是为了使其工作，这就是您需要执行的操作。

1) 在您的 AppDelegate.h 中，将接口声明替换为 ::

```
@interface AppDelegate : UIResponder <UIApplicationDelegate, NSURLConnectionDataDelegate> {
    NSMutableData *receivedData;
} 
```

2) 在您的 AppDelegate.m 中，添加此方法 ::

```
- (void)connection:(NSURLConnection *)connection didReceiveData:(NSData *)data {
    [receivedData setData:data];
    NSLog(@"receivedData : %@", receivedData);
} 
```

# c - C程序帮助：内存分配不足但仍然有效...为什么？

> ID：14635680
> 
> 赞同：0
> 
> 时间：2013-01-31T21:42:12.570
> 
> 标签：c

> **可能重复：**
> [malloc(0) 的行为](https://stackoverflow.com/questions/10684595/behaviour-of-malloc0)

我正在尝试了解 C 中的内存分配。所以我正在尝试使用`malloc`. 我为这个指针分配了 0 个字节，但它仍然可以保存一个整数。事实上，无论我在 的参数中放入什么数字`malloc`，它仍然可以容纳我给它的任何数字。为什么是这样？

```
#include <stdio.h>
#include <stdlib.h>

int main(void)
{
    int *ptr = (int*)malloc(0);

    *ptr = 9;

    printf("%i", *ptr); // 9

    free(ptr);

    return 0;
} 
```

它仍然打印 9，这是怎么回事？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:47:07.987

> 如果 size 为 0，则 malloc() 返回 NULL 或稍后可以成功传递给 free() 的唯一指针值。

我猜你遇到了第二种情况。无论如何，该指针只是错误地恰好位于您可以写入而不会产生分段错误的区域中，但您可能正在写入一些其他变量的空间，从而弄乱了它的值。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:08:32.747

一方面，您的编译器可能会看到这两行背靠背并对其进行优化：

```
*ptr = 9;
printf("%i", *ptr); 
```

使用这样一个简单的程序，您的编译器实际上可能正在优化整个内存分配/释放周期并改用常量。程序的编译器优化版本最终可能看起来更像是：

```
printf("9"); 
```

判断这是否确实发生的唯一方法是检查编译器发出的程序集。如果您想了解 C 的工作原理，我建议您在构建代码时明确禁用所有编译器优化。

关于您的特定`malloc`用法，请记住，如果分配失败，您将返回一个 NULL 指针。 在将它用于任何事情之前，请*务必*检查它的返回值。`malloc`盲目地取消引用它是使程序崩溃的好方法。

尼克发布的链接很好地解释了为什么`malloc(0)`看起来有效（注意“有效”和“似乎有效”之间的显着差异）。总结那里的信息，`malloc(0)`允许返回 NULL 或指针。如果它返回一个指针，则明确禁止您将其用于除将其传递给`free()`. 如果您*确实*尝试使用这样的指针，那么您将调用未定义的行为，并且无法判断结果会发生什么。它可能看起来对你有用，但这样做你可能会覆盖属于另一个程序的内存并破坏它们的内存空间。简而言之：不会发生什么好事，所以不要管那个指针，不要在`malloc(0)`.

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T22:51:03.183

这里有很多很好的答案。但这绝对是未定义的行为。有些人声称未定义的行为意味着紫龙可能会飞出您的计算机或类似的东西......我失踪的离谱声称背后可能有一些历史，但我向您保证，无论何时紫龙都不会出现未定义的行为将是什么。

首先，让我提一下，在没有 MMU 的情况下，在没有虚拟内存的系统上，您的程序将可以直接访问系统上的**所有**内存，而不管其地址如何。在这样的系统上，`malloc()`它只是帮助您以有序的方式划分内存的人；系统实际上不能强制您只使用`malloc()`给您的地址。在有虚拟内存的系统上，情况*稍微有点*不同...嗯，好吧，很多不同。但是在您的程序中，您程序中的任何代码都可以访问通过 MMU 映射到真实物理内存的虚拟地址空间的任何部分。无论您是从 malloc() 获得地址，还是调用 rand() 并碰巧获得了位于程序映射区域中的地址，都无关紧要。如果它已映射且未标记为仅执行，则可以阅读它。如果它没有标记为只读，您也可以编写它。是的。即使你没有从`malloc()`.

让我们考虑`malloc(0)`未定义行为的可能性：

*   `malloc(0)`返回 NULL。

好的，这很简单。在大多数计算机中确实有一个物理地址 0x00000000，甚至在**所有**进程中都有一个虚拟地址 0x00000000，但是操作系统故意不将任何内存映射到该地址，以便它可以捕获空指针访问。那里有一整页（通常是 4KB）根本没有映射，甚至可能超过 4KB。因此，如果您尝试通过空指针读取或写入，即使有一个偏移量，您也会碰到这些甚至没有映射的虚拟内存页面，并且 MMU 将抛出异常（*硬件*异常或*中断*) 被操作系统捕获，并声明一个 SIGSEGV（在 Linux/Unix 上）或非法访问（在 Windows 上）。

*   `malloc(0)`将有效地址返回到最小可分配单元的先前未分配的内存。

有了这个，你实际上得到了一块你可以合法地称之为你自己的真正的记忆，大小你不知道。你真的不应该在那里写任何东西（也可能不读），因为你不知道它有多大，就此而言，你不知道这是否是你正在经历的特殊情况（见下文例）。如果是这种情况，您获得的内存块几乎可以保证至少为 4 个字节，并且可能是 8 个字节甚至更大；这一切都取决于您的实现的最小可分配单元的大小。

*   `malloc(0)`有意返回 NULL 以外的未映射内存页的地址。

这对于实现来说可能是一个不错的选择，因为它允许您或系统跟踪并配对 malloc() 调用及其相应的 free() 调用，但本质上，它与返回 NULL 相同。如果您尝试通过此指针访问（读/写），您将崩溃（SEGV 或非法访问）。

*   `malloc(0)`返回“其他人”可能使用的其他映射内存页中的地址。

我发现商业上可用的系统不太可能采用这种方法，因为它只是为了隐藏错误而不是尽快将它们找出来。但如果是这样， malloc() 将返回一个指向**您不拥有**的内存某处的指针。如果是这种情况，当然，您可以随心所欲地对其进行写入，但是您会破坏其他代码的内存，尽管它会是您程序进程中的内存，因此您可以放心，您至少不会会踩到另一个程序的内存。（我听到有人准备说，“但它是 UB，所以从技术上讲它**可以**踩在其他程序的内存上。是的，在某些环境中，例如嵌入式系统，这是正确的。没有现代商业操作系统会让一个进程访问另一个进程的内存，就像简单地调用 malloc(0) 一样容易；事实上，如果不通过操作系统为你做这件事，你根本无法从一个进程到另一个进程的内存。） ***无论如何，***回到现实......这是“未定义行为”真正发挥作用的地方：如果您正在写入“其他人的记忆”（在您自己的程序的进程中），您将很难改变程序的行为- 预测方式。了解程序的结构以及所有内容在内存中的布局，这是完全可以预测的。但是从一个系统到另一个系统，事物会被布置在内存中（在内存中出现不同的位置），因此对一个系统的影响不一定与对另一个系统的影响相同，或者对同一系统的不同时间。

*   最后......不，就是这样。真的，真的，只有这四种可能性。您可以为上述最后两个中的特殊情况子集点争论，但最终结果将是相同的。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-31T21:49:10.247

您可以在此处找到未崩溃的`malloc(0)`/呼叫的答案：`free()`

[零大小的malloc](https://stackoverflow.com/questions/1073157/zero-size-malloc)

关于`*ptr = 9`, 就像溢出缓冲区（例如 malloc'ing 10 个字节并访问第 11 个字节），您正在写入您不拥有的内存，这样做是在寻找麻烦。在这个特定的实现`malloc(0)`中，恰好返回一个指针而不是 NULL。

最重要的是，即使它似乎适用于一个简单的案例，也是错误的。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T21:49:45.147

一些内存分配器具有“最小可分配大小”的概念。因此，即使您传递零，这也会返回指向例如字长内存的指针。您需要检查您的系统分配器文档。但是，如果它确实返回指向某个内存的指针，那么依赖它是错误的，因为该指针只应该被传递给传递 realloc() 或 free()。

# ruby - 慢性病有 24 小时时间设置吗？

> ID：14635683
> 
> 赞同：1
> 
> 时间：2013-01-31T21:42:30.987
> 
> 标签：ruby, gem, chronic

我偶然发现了一个使用 Chronic gem 的有趣（并且暂时停止了令人费解的）行为。

解析字符串`1/21/13 2:20`：

```
Chronic.parse('1/21/13 2:20')
=> 2013-01-21 14:20:00 -0800 
```

但是，如果 a`0`位于 前面`2`：

```
Chronic.parse('1/21/13 02:20')
 => 2013-01-21 02:20:00 -0800 
```

现在，我可以将 AM 或 PM 放在字符串的末尾，这基本上会覆盖此行为（因此前导是否存在并不重要`0`），但这显然是解析的额外步骤，并否定了很多优势使用慢性。是否有另一种选择来适当地处理这个领先的零问题？这让我措手不及，这还没有弄清楚。

我应该注意，我需要解析的字符串可能是上述两种情况中的任何一种。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:36:07.123

好吧，你可以减去 12 小时：

```
time = Chronic.parse('1/21/13 2:20')
time -= - 12 * 60 * 60 if time.hour >= 12
#=> 2013-01-22 02:20:00 0800 
```

# sql-server-2008 - SQL Server 2008 中的 SQL 查询 - 分组和排序

> ID：14635684
> 
> 赞同：2
> 
> 时间：2013-01-31T21:42:34.100
> 
> 标签：sql-server-2008, sorting, grouping

我正在寻找 SQL 查询来解决我遇到的问题。

我有 2 列 - 第一列是“员工全名”（包含全名），第二列是“小时”。

```
Employee Full Name | Hours | grading
-------------------------------------
john ran             122
john medi            177
john mat             138
jack rom             66
jack ton             88 
```

我想通过以下方式使用“评分”列更新数据库：

按员工的名字对员工进行分组，然后按工作时间对他们进行评分（按升序排列）（具有特定名字的员工的最高工作时间）得到 1 级，第二个 2 级等...）。

结果应该是这样的：

```
Employee Full Name | Hours | grading
------------------------------------
john ran             122      3
john medi            177      1
john mat             138      2
jack rom             66       2
jack ton             88       1 
```

没有2名同名员工

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:03:49.937

您可以使用 a`CTE`来执行此更新`row_number()`

```
;with cte as
(
  select *,
    row_number() 
      over(partition by substring([EMPLOYEE FULL NAME], 1, charindex(' ', [EMPLOYEE FULL NAME])) 
           order by hours desc) rn
  from yourtable
)
update cte
set grading = rn; 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!3/9a411/11)

理想情况下，您将希望规范化您的数据库，使名字和姓氏在不同的列中。

# ruby-on-rails - 在 Centos 6.3 上运行“rails s”时，我得到一个“找不到 JavaScript 运行时”。错误

> ID：14635687
> 
> 赞同：1
> 
> 时间：2013-01-31T21:42:43.327
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, centos, javascript

我已经在互联网和 stackoverflow 上搜索了答案，但没有一个答案对我有用，而且我无法将 nodejs 安装到我的服务器上。

我正在使用 Rails 3.2.3、Ruby 1.9.3p374。

当我运行“捆绑安装”和“捆绑更新”时，我没有收到任何错误。

这是运行“rails s”后的错误：

```
/home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/execjs-1.4.0/lib/execjs/runtimes.rb:51:in `autodetect': Could not find a JavaScript runtime. See https://github.com/sstephenson/execjs for a list of available runtimes. (ExecJS::RuntimeUnavailable)
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/execjs-1.4.0/lib/execjs.rb:5:in `<module:ExecJS>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/execjs-1.4.0/lib/execjs.rb:4:in `<top (required)>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/coffee-script-2.2.0/lib/coffee_script.rb:1:in `<top (required)>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/coffee-script-2.2.0/lib/coffee-script.rb:1:in `<top (required)>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/coffee-rails-3.2.2/lib/coffee-rails.rb:1:in `<top (required)>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:68:in `block (2 levels) in require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `each'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:66:in `block in require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `each'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler/runtime.rb:55:in `require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@global/gems/bundler-1.2.3/lib/bundler.rb:128:in `require'
from /home/Nameo0/rails_projects/first_app/config/application.rb:7:in `<top (required)>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands.rb:53:in `require'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands.rb:53:in `block in <top (required)>'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands.rb:50:in `tap'
from /home/Nameo0/.rvm/gems/ruby-1.9.3-p374@rails3tutorial2ndEd/gems/railties-3.2.3/lib/rails/commands.rb:50:in `<top (required)>'
from script/rails:6:in `require'
from script/rails:6:in `<main>' 
```

这是我安装的宝石：

```
actionmailer (3.2.3)
actionpack (3.2.11, 3.2.3)
activemodel (3.2.11, 3.2.3)
activerecord (3.2.3)
activeresource (3.2.3)
activesupport (3.2.11, 3.2.3)
arel (3.0.2)
builder (3.0.4)
bundler (1.2.3)
coffee-rails (3.2.2)
coffee-script (2.2.0)
coffee-script-source (1.4.0)
erubis (2.7.0)
execjs (1.4.0)
hike (1.2.1)
i18n (0.6.1)
journey (1.0.4)
jquery-rails (2.2.0, 2.0.1)
json (1.7.6)
libv8 (3.11.8.13 x86_64-linux)
mail (2.4.4)
mime-types (1.19)
multi_json (1.5.0)
polyglot (0.3.3)
rack (1.4.4)
rack-cache (1.2)
rack-ssl (1.3.3)
rack-test (0.6.2)
rails (3.2.3)
railties (3.2.3)
rake (10.0.3)
rdoc (3.12)
ref (1.0.2)
rubygems-bundler (1.1.0)
rubygems-update (1.8.24)
rvm (1.11.3.6)
sass (3.2.5)
sass-rails (3.2.6, 3.2.4)
sprockets (2.2.2, 2.1.3)
sqlite3 (1.3.7, 1.3.5)
therubyracer (0.11.3)
thor (0.14.6)
tilt (1.3.3)
treetop (1.4.12)
tzinfo (0.3.35)
uglifier (1.3.0, 1.2.3) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-01T05:49:30.163

我通过打开 gem 文件并添加以下行来解决此问题：

```
gem "therubyracer", :require => 'v8' 
```

希望对遇到此问题的其他人有所帮助。

# javascript - Javascript 闭包函数不返回正确的值

> ID：14635690
> 
> 赞同：3
> 
> 时间：2013-01-31T21:42:52.957
> 
> 标签：javascript, closures, return-value, settimeout, alert

我的 Javascript 代码有问题，不知道为什么它不能运行。

这是我的计时器：

```
var time = 0;
startTimer();

function startTimer(){
    setInterval(function(){
    time=time+1;
    },10);
} 
```

此处的代码有效（我在单击按钮时运行 timeoutTester()，然后它会发出警报并向我显示时差）：

```
function timeoutTester(){
    var snap_time1 = time;
    setTimeout(function(){
        var snap_time2 = time;
        var diff = snap_time2-snap_time1;
        alert(diff);            //works: ~100 everytime...
    },1000);
} 
```

但是这里的代码不起作用（我通过单击按钮运行 testTimer()）：

```
function timeoutTester(){
    var snap_time1 = time;
    var result;
    setTimeout(function(){
        var snap_time2 = time;
        result = snap_time2-snap_time1;
    },1000);
    alert(result); //doesn't work! It always shows me: "undefined"
    return result;
}

function testTimer(){
    var counter = 0;
    setInterval(function(){
        counter = counter + 1;
        alert(counter);         //works: 1,2,3,....
        var result = timeoutTester();
        alert(result);  //doesn't work! It always shows me: "undefined"
    }, 3000);
} 
```

你知道问题可能出在哪里吗？（在浏览器中调试时没有错误！）

**更新**：

我了解到警报（结果）；立即执行，而 result 还没有值。

但是由于我从外部调用 timeoutTester()，我仍然需要这个函数的返回值！

有任何想法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:45:09.830

在您的最后一个示例（不起作用的示例）中，调用`setTimeout(function()...)`不会立即执行该函数，但会立即返回。当它返回时，`result`仍然是未定义的，因为该函数尚未执行。

出于同样的原因，前面的示例（`alert()`在 timeout 函数内部调用）之所以有效，是因为调用`alert()`发生在 after`result`被分配了一个值。

如果出于某种原因您不想`alert()`直接从 timeout 函数中调用，您可以将最后一个示例重写为：

```
function timeoutTester(){
    var snap_time1 = time;
    setTimeout(function(){
        var snap_time2 = time;
        alertResult(snap_time2-snap_time1);
    },1000);
}
function alertResult(result) {
    alert(result);
} 
```

（顺便说一句，这个电话`startTimer(1000000000000);`看起来很吓人，直到我意识到这个论点被忽略了。:-)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:57:21.463

要完成此操作，您需要使用全局：

```
var timeoutTesterResult;

function timeoutTester(){
    var snap_time1 = time;
    var result;
    setTimeout(function(){
        var snap_time2 = time;
        timeoutTesterResult = snap_time2-snap_time1;
        alert(timeoutTesterResult);                    //works: ~100
    },1000);
} 
```

只有在设置/更改后才获得此全局的第二次超时：

```
function testTimer(){
    var counter = 0;
    setInterval(function(){
        counter = counter + 1;
        alert(counter);         //works: 1,2,3,....
        timeoutTester();
        setTimeout("alert(timeoutTesterResult)",1000); //works: ~100
    }, 3000);
} 
```

这就是“通过全球”解决方案。

# php - Codeigniter：如何捕获路由中的斜线并传递给控制器 ？

> ID：14635692
> 
> 赞同：1
> 
> 时间：2013-01-31T21:42:57.530
> 
> 标签：php, codeigniter, routing, routes

我正在尝试从 url 中捕获斜线并将它们传递到我的控制器中。这是我的问题的一个例子：

假设我 GET`http://localhost/here/is/an/example`我的路线如下所示：

```
$routes['here/is/(:any)'] = 'my_controller/$1'; 
```

我有以下函数定义`my_controller`：

```
public function index($rest_of_the_path) {
...
} 
```

**我希望`$rest_of_the_path`to 的值是`'an/example'`，但它实际上等于`'an'`。**如何构建我的代码以便得到我想要的？

PS：我正在使用 Codeigniter 2.1.3

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:11:14.473

你可以简单地这样做：

```
public function index() {
    $rest_of_the_path = implode("/", func_get_args());  
    ...
} 
```

# python - GAE MapReduce，如何编写多个输出

> ID：14635693
> 
> 赞同：0
> 
> 时间：2013-01-31T21:42:59.997
> 
> 标签：python, google-app-engine, mapreduce

我有一个数据集，我对其进行了多次映射。

假设我有 3 个用于 reduce 函数的键值对，如何修改输出以使我有 3 个 blobfiles - 每个键值对一个？

如果我能进一步澄清，请告诉我。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-12-19T18:12:39.630

我认为 GAE Mapreduce 库中不存在这样的功能（还没有？）。

根据数据集的大小和所需的输出类型，您可以通过将 reducer 选为另一个输出编写器来进行少量投资。例如，如果一个 reducer 输出应该直接返回到数据存储，而另一个输出应该进入一个文件，您可以自己打开一个文件并将输出写入其中。或者，您可以使用 序列化中间映射结果并将其显式存储到临时数据存储中`operation.db.Put`，并在该数据存储上执行单独的 Map 或 Reduce 作业。当然，这最终会比第一个解决方法更昂贵。

在您的特定键值示例中，我建议写入 Google Cloud Storage File，并对其进行后处理以根据需要将其拆分为三个文件。这也可以让您更好地控制最终文件名。

# arrays - Perl 哈希。遍历 foreach

> ID：14635698
> 
> 赞同：1
> 
> 时间：2013-01-31T21:43:17.300
> 
> 标签：arrays, perl, hash, foreach

Perl 哈希有一些问题。我有一个 XML：

```
<?xml version="1.0" encoding="utf-8"?>
<SvnRequestUsers>
  <AccessCode>$TR0ngP@ssvv0rd!</AccessCode>
  <SvnUsers>
    <SvnUser>
      <Username>svn.testname</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>
    <SvnUser>
      <Username>svn.testname2</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>
  </SvnUsers>
</SvnRequestUsers> 
```

我想遍历 SvnUser 节点。当我使用

我的 $usersList = $ref->{'SvnUsers'};

```
foreach my $key ( @{$usersList->{'SvnUser'}} )
{ ..... } 
```

这在有多个节点但不适用于一个节点时有效。

使用时

我的@usersList = $ref->{'SvnUsers'}->{'SvnUser'};

```
foreach my $key ( @usersList )
{ ..... } 
```

这仅在只有一个节点存在时才有效。诀窍在哪里？？？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:23:34.617

如果您使用 XML::Simple，您可能希望全局启用 ForceArray（这可能需要您在代码中添加更多数组取消引用）或可能具有一个或多个节点的特定元素；见[https://metacpan.org/module/XML::Simple#ForceArray-names-in---important](https://metacpan.org/module/XML::Simple#ForceArray-names-in---important)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:55:07.530

这看起来像是 far-from-simple 的工作[`XML::Simple`](https://metacpan.org/module/XML%3a%3aSimple)。我确信它通过成为第一个声明其命名空间的人而赢得了人气，而 IMO 它有很多缺点。

[如果我的猜测是正确的，那么您可以通过启用该`ForceArray`选项](https://metacpan.org/module/XML%3a%3aSimple#ForceArray-1-in---important)来克服一些尴尬。模块的 POD 说

> 查看 ForceArray，因为您几乎肯定会想要打开它

在您的情况下，这将确保它`$ref->{SvnUsers}{SvnUser}`始终*是*一个数组引用，即使`<SvnUser>`XML 中的那个点只有一个元素。因此`$ref->{SvnUsers}{SvnUser}[0]`将始终如一地访问第一个或唯一的用户元素。

我的建议是升级到更一致的 XML 模块。[`XML::Smart`](https://metacpan.org/module/XML%3a%3aSmart)允许以与结构非常相似的方式访问数据`XML::Simple`，但它广泛使用`tie`以提供更好的 DWIM 接口。例如，可以使用或访问`XML::Smart`第`SvnUser`一个元素中的第一个。`SvnUsers``$ref->{SvnUsers}{SvnUser}``$ref->{SvnUsers}[0]{SvnUser}[0]`

只需切换到即可`XML::Smart`解决您的直接问题。例如，下面的代码将列出所有用户的用户名，无论是一个还是多个（或者实际上没有，因为在这种情况下对象将返回一个空列表）。

我自己的偏好是一个“适当的”XML 模块，比如[`XML::LibXML`](https://metacpan.org/module/XML%3a%3aLibXML)or [`XML::Twig`](https://metacpan.org/module/XML%3a%3aTwig)，但当然选择是你的。

```
use strict;
use warnings;

use XML::Smart;

my $ref = XML::Smart->new(\*DATA);

my $users_list= $ref->{SvnRequestUsers}{SvnUsers};

foreach my $key ( @{ $users_list->{SvnUser} } ) {
  print $key->{Username}, "\n";
}

__DATA__
<?xml version="1.0" encoding="utf-8"?>
<SvnRequestUsers>
  <AccessCode>$TR0ngP@ssvv0rd!</AccessCode>
  <SvnUsers>
    <SvnUser>
      <Username>svn.testname</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>
    <SvnUser>
      <Username>svn.testname2</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>
  </SvnUsers>
</SvnRequestUsers> 
```

**输出**

```
svn.testname
svn.testname2 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T21:58:10.407

您使用哪个模块来读取 ahref 中的 XML？我猜如果有更多用户，您将需要像这样访问您的数据：

```
my @usersList = $ref->{'SvnUsers'}->[0]->{'SvnUser'}; 
```

这会给你第一个用户，因为在'SvnUsers'键下会有一个arrayref作为值

迭代可能如下所示：

```
my $maxusers = scalar(@{$ref->{'SvnUsers'}}); # get the number of elements in your ref
for my $i(0 .. $maxusers){
    my $svnuser = $ref->{'SvnUsers'}->[$i]->{'SvnUser'}; # get current
    ....... # do your stuff
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T22:03:01.227

尝试这样做：

```
#!/usr/bin/perl
use strict;
use warnings;

use XML::XPath;
use XML::XPath::XMLParser;

my $xp = XML::XPath->new(filename => 'file.xml');

my $nodeset = $xp->find('/SvnRequestUsers/SvnUsers/SvnUser'); # find svn users

foreach my $node ($nodeset->get_nodelist) {
    print "FOUND\n\n",
        XML::XPath::XMLParser::as_string($node),
        "\n\n";
} 
```

结果 ：

```
FOUND

<SvnUser>
      <Username>svn.testname</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>

FOUND

<SvnUser>
      <Username>svn.testname2</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser> 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T04:53:13.523

像往常一样，我会推荐[Mojo::DOM](http://mojolicio.us/perldoc/Mojo/DOM)，它是[Mojolicious](http://mojolicio.us)套件的一部分。使用选择器和变换/迭代器方法，问题变得非常简单：

```
#!/usr/bin/env perl

use strict;
use warnings;

use Mojo::DOM;

my $dom = Mojo::DOM->new(<<'END');
<?xml version="1.0" encoding="utf-8"?>
<SvnRequestUsers>
  <AccessCode>$TR0ngP@ssvv0rd!</AccessCode>
  <SvnUsers>
    <SvnUser>
      <Username>svn.testname</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>
    <SvnUser>
      <Username>svn.testname2</Username>
      <Password>jA=B*+q%</Password>
      <Create>true</Create>
    </SvnUser>
  </SvnUsers>
</SvnRequestUsers>
END

# get an array

my @users = $dom->find('SvnUser')
                ->pluck('Username')
                ->pluck('text')
                ->each;

# or do something with each element

$dom->find('SvnUser')
    ->pluck('Username')
    ->pluck('text')
    ->each(sub{ print "$_\n" }); 
```

当然，如果您实际上只是想要用户名，则可以使用更定制的选择器`find('SvnUser Username')`，我上面的示例是展示一个方法。

# c# - 如何检测文件夹是否已完成复制？

> ID：14635700
> 
> 赞同：3
> 
> 时间：2013-01-31T21:43:31.937
> 
> 标签：c#, file, filesystemwatcher

在一个项目中，我有一个工作文件夹。如果我们将文件或文件文件夹从某个地方复制到该文件夹​​，我需要检测复制是否已完成。之后，我将处理此工作文件夹中的文件。

```
FileSystemWatcher theWatcher = new FileSystemWatcher(workingFolder);
theWatcher.NotifyFilter = NotifyFilters.LastAccess | NotifyFilters.LastWrite |
                          NotifyFilters.FileName | NotifyFilters.DirectoryName |
                          NotifyFilters.Size;
theWatcher.IncludeSubdirectories = true;
theWatcher.Created += OnFolderChanged;
theWatcher.EnableRaisingEvents = true; 
```

每当复制文件时，都会触发 OnFolderChanged 事件。所以一开始我尝试获取 2 个文件复制之间的 eclipse 时间，但由于网络速度和文件大小，很难确定 eclipse 时间。我还尝试了[Find if a Copy process is in progress on Directory 中](http://social.msdn.microsoft.com/Forums/en/csharpgeneral/thread/f213919d-b424-45a5-9036-b8365f12fab4)的方法，但是在复制过程中仍然可以打开令牌文件。

有什么好的方法来处理这个吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T15:40:57.987

您不可能使用 FileSystemWatcher 对您一无所知的进程的操作进行逆向工程。有许多可能的故障模式。一个很好的例子是用户使用资源管理器复制文件并显示一个对话框，因为目标文件已经存在。用户不去洗手间，因为他指望它需要一段时间。

你**永远不**应该对正在发生的事情做出任何假设。任意地，在收到通知时启动一分钟计时器，并在收到另一个通知时重新启动它。当计时器滴答作响时，您就有理由猜测复制操作已完成*。*只要确保当您猜错时它永远不会成为问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:51:45.240

如果您可以控制复制文件/文件夹的过程 - 您可以在文件/文件夹完成复制时附加后缀 (.complete) 并将文件系统观察程序设置为仅响应具有.complete 扩展名。

更新 - 由于您无法控制复制的文件/文件夹名称 - 我将在`FolderChaged`方法中使用异常处理。我假设您正在使用该方法对文件/文件夹进行一些处理，并且当您尝试访问未完成复制的文件/文件夹时 - 您会遇到某种`System.IO`异常。

我也遇到了 FSW 的这个问题，我通过捕获异常、暂停几秒钟然后再次尝试访问文件来处理它。我把这个逻辑放在一个循环中，在 10 秒内重试访问文件 5 次。如果我们在 5 次尝试后仍然无法处理该文件 - 我们将抛出异常并由我们的标准错误处理接管。

当然，对于你来说合适的循环参数是什么仍然是一个悬而未决的问题，如果你达到了这些参数的限制，你将如何处理失败？

# python - 启动本地 SMTP 服务器

> ID：14635702
> 
> 赞同：0
> 
> 时间：2013-01-31T21:43:37.077
> 
> 标签：python, windows, smtp

我将通过邮件机制将故障转储从客户端传输给我。因此，我不能使用任何公共 SMTP 服务器，因为将任何帐户的凭据与应用程序打包在一起是不可接受的。

因此，我需要通过我的应用程序将邮件直接发送到目标邮件服务器。

我怎样才能在python中实现这一点？（我使用的是 Windows，所以`sendmail`不是一个选项）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:56:14.177

只需[`smtplib`](http://docs.python.org/2/library/smtplib.html)在标准库中使用。

尝试编写可以向任何人发送邮件的代码是有问题的，因为`smtplib`连接到服务器的客户端到服务器风格而不是服务器到服务器中继风格。

但是，如果您只需要将邮件发送到您控制的一台特定服务器，那就很简单了。只需在“mail.example.com”配置您的服务器以接受从“crash-reports@example.com”到“crash-reports@example.com”的任何邮件。

您的代码将如下所示：

```
import smtplib
addr = 'crash-reports@example.com'
def send_crash_report(crash_report):
    msg = ('From: {}\r\nTo: {}\r\n\r\n{}'.format(
           addr, addr, crash_report)
    server = smtplib.SMTP('mail.example.com')
    server.sendmail(addr, [addr], msg)
    server.quit() 
```

附带说明一下，如果您刚开始使用崩溃报告收集器，您可能需要考虑使用 Web 服务而不是邮件地址。您将遇到无法通过公司防火墙/代理访问端口 25、编写从收件箱中提取崩溃报告的代码（和/或通过 IMAP 或 mbox 或其他方式搜索）、处理垃圾邮件发送者的问题对于每个实际的崩溃报告等，他们以某种方式找到`crash-reports@example.com`并用 900 条关于 Cialis 的消息充斥它。

# java - 哪个websocket服务器实现可以和rabbitmq结合？

> ID：14635703
> 
> 赞同：1
> 
> 时间：2013-01-31T21:43:40.190
> 
> 标签：java, grails, groovy, websocket, rabbitmq

您好，我们计划将 websocket 服务器实现集成为我们的 RabbitMQ 系统的前端。目前我们正在运行一些使用 RabbitMQ 服务器的基于 Java/Groovy/Grails 的应用程序。

我们想要一个简单的 websocket 服务器实现来处理连接等，并将请求传递给我们的 RabbitMQ 层。

客户端（硬件设备）将连接到处理对 RabbitMQ 的请求的 websocket 层。其他一些进程负责处理请求并在需要时将数据放回队列中，以便 RabbitMQ 能够通过 websocket 将数据传递回客户端。

我有点迷失在 websockets 的土地上，所以我想知道其他人会建议使用什么。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T08:43:19.710

您可以将 rabbitmq 本身与 webstomp 插件和 sock.js 一起用于 Web 前端。您可以直接公开它，也可以通过 haproxy 之类的方式公开它。

[http://www.rabbitmq.com/blog/2012/05/14/introducing-rabbitmq-web-stomp/](http://www.rabbitmq.com/blog/2012/05/14/introducing-rabbitmq-web-stomp/)

在 3.x 版本中，它现在默认包含在内，只需启用插​​件即可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:44:31.117

对于 Java，有两种选择：

*   气氛
*   顶点x
*   玩 2.0
*   Netty 直接

给猫剥皮的方法有很多。如果您已经在使用 Grails，Atmosphere 可能会让您更进一步。您将不得不编写一个自定义`Broadcaster`IIRC，RabbitMQ 没有一个，但您可以复制现有的一个。

此外，对于 RabbitMQ 或任何队列，您必须决定是为每个用户（使用 websocket 的浏览器）创建队列，还是基于一些哈希进行聚合，然后在内部调度（即制作一个巨大的邮箱地图） . Akka 将是映射到邮箱的不错选择。

# javascript - 在jsp中显示来自servlet的范围的动态单元格颜色

> ID：14635705
> 
> 赞同：2
> 
> 时间：2013-01-31T21:43:43.370
> 
> 标签：javascript, html, jsp, servlets

我正在尝试基于库存管理系统制作一个简单的 Web 应用程序。我的问题如下，

我正在从数据库中获取产品数据到一个 servlet，其中包括它的数量。我想在我的 JSP 中以表格格式显示该数据。我还想根据某个阈值动态更改数量的单元格颜色。比如 ..如果我的门槛是 50 那么

如果数量 < 49，则单元格颜色应为红色

如果数量 > 51，则单元格颜色应为蓝色

如果数量为 50,49 或 51，则单元格颜色应为绿色。

如何实现该代码？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T00:25:20.817

首先在健全的 CSS 样式类中定义这些颜色。

```
.understock {
    color: red;
}
.normal { 
    color: green;
}
.overstock {
    color: blue;
} 
```

然后只需让 JSP 生成所需的样式类。

```
<table>
  <c:forEach items="${products}" var="product">
    <tr>
      <td class="${product.quantity < 49 ? 'understock' : product.quantity < 51 ? 'normal' : 'overstock'}">${product.quantity}</td>
    </tr>
    ...
  </c:forEach>
</table> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:52:29.623

如果你想用 Javascript 来做，我将使用 AJAX 从数据库中获取信息。 [http://www.tizag.com/ajaxTutorial/ajax-javascript.php](http://www.tizag.com/ajaxTutorial/ajax-javascript.php)

不过，我建议您使用 PHP 而不是 Javascript。用于制作的 Javascript 开发相当复杂且不需要。

这是您从数据库中获取信息所需的信息。 [http://www.tizag.com/mysqlTutorial/](http://www.tizag.com/mysqlTutorial/)

一旦你得到信息，它只是 PHP

```
 if($value < 50){
     echo '<tr><td style="background-color:red;">text of the cell</td></tr>';
    }elseif($value == 50,49 OR $value == 51){
echo '<tr><td style="background-color:blue;">text of the cell</td></tr>';
}elseif($value > 51){
echo '<tr><td style="background-color:blue;">text of the cell</td></tr>';
} 
```

*您也可以使用switch*功能执行上面的代码。

# javascript - 使用下划线合并重复的主干模型数据

> ID：14635706
> 
> 赞同：1
> 
> 时间：2013-01-31T21:43:44.903
> 
> 标签：javascript, backbone.js, underscore.js

我有一个包含一堆模型的集合，如下例所示：

```
{
    metricName : 'clicks',
    metricValue : 100
} 
```

我想要的是搜索集合并将所有具有相同 metricName 的模型合并到一个模型中，该模型具有所有值的总和。

所以

```
{
    metricName : 'clicks',
    metricValue : 100
}

{
    metricName : 'otherMetric',
    metricValue : 100
}

{
    metricName : 'clicks',
    metricValue : 100
} 
```

变成

```
{
    metricName : 'clicks',
    metricValue : 200
}

{
    metricName : 'otherMetric',
    metricValue : 100
} 
```

我试图通过使用下划线来尽可能高效和轻松地解决这个问题。

我可以看到一种解决方案是使用 _.each 并循环并跟踪指标名称，同时对值求和并消除欺骗（听起来很蹩脚）。

我的问题是，是否有另一种更好的方法可以使用以下划线的其他方法之一来做到这一点。我可以看到地图、查找、查找位置、过滤器等可能是选项，但我不确定。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:41:24.673

`groupBy`你可以用and做一些可爱的事情`reduce`：

```
collection.reset(_.map(_.groupBy(collection.toJSON(), 'metricName'), function(group) {
  return _.reduce(group, function(memo, item) {
    if(!memo) return item;
    memo.metricValue+=item.metricValue;
    return memo;
  });
})); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:53:22.353

`collection.add`你可以

```
function onAdd(model){
    _.each(collection.where({metricName: model.get('metricName')}), function(item, i, array){
        item.set('metricValue', item.get('metricValue') + model.get('metricValue');
    });
} 
```

# javascript - 尝试添加显示/隐藏按钮，但被主题的 javascript 覆盖

> ID：14635708
> 
> 赞同：1
> 
> 时间：2013-01-31T21:43:49.187
> 
> 标签：javascript

编辑 - 我能够找到 js 文件并删除悬停效果。

我正在研究WP。我有一个选择表单，需要在单击按钮时显示。主题提供的功能在悬停时显示表单，但它有问题并且使用户体验不佳。

我设法添加了按钮，但我不知道如何覆盖当前的悬停功能。

这是我有的

Javascript

```
<script language="JavaScript">
    function toggle(id) {
        var state = document.getElementById(id).style.display;
            if (state == 'block') {
                document.getElementById(id).style.display = 'none';
            } else {
                document.getElementById(id).style.display = 'block';
            }
        } 
</script> 
```

HTML

```
<div id="nav_subscription" class="subscription_form clearfix">
<span id="subscribe_dd" class="contrast"><?php gb_e( 'Get the Latest Deals' ) ?><span><a href="#" onclick="toggle('subscription_form_wrap');">Toggle Div</a></spa>

</div><!-- #main_navigation --> 

    <div id="subscription_form_wrap" style="display:none;">
    <div class="optinbar_close" style="bottom: 202px; left: -10px;"></div>                           
    <p class="fillout2">Συμπλήρωσε την παρακάτω φόρμα και μπες στο club επικοινωνίας του Fitness Forum για να σου στείλουμε αμέσως με email το δώρο σου. Απλά, γράψε το όνομα και το email σου και κλίκαρε 'Στείλτε το δώρο μου'.</p>   

<!-- Begin MailChimp Signup Form -->                                    
    <div id="mc_embed_signup">                  

    </div>
</div><!-- #header_subscription.subscription_form --> 
```

CSS

```
#subscription_form_wrap {
    -webkit-border-bottom-right-radius: 0;
    -webkit-border-bottom-left-radius: 0;
    -moz-border-radius-bottomright: 0;
    -moz-border-radius-bottomleft: 0;
    border-bottom-right-radius: 0;
    border-bottom-left-radius: 0;
    background: none;
    background-color: #FFFFFF;
    padding: 0;
    float: left;
    position: absolute;
    top: 34px;
    right: 0;
    height: auto;
    min-width: 200px;
    border: 1px solid #CCC;
    font-size: 13px;
    }

#subscribe_dd {
    color: white;
    font-size: 16px;
    text-align: center;
    line-height: 17px;
    background-color: #999;
    width: 255px;
    height: 19px;
    -moz-border-radius-bottomright: 0;
    -webkit-border-bottom-right-radius: 0;
    border-bottom-right-radius: 0;
    }

.optinbar_close {
    float: right;
    background: url(assets/images/close3.png) no-repeat;
    display: inline;
    height: 32px;
    width: 32px;
    cursor: pointer;
    text-decoration: underline;
    color: white;
    position: absolute;
    right: 10px;
    } 
```

这是该网站的[链接]。

我正在尝试修复导航栏上写着：“Έχεις ήδη κερδίσει ένα δώρο!”的灰色框。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:27:07.637

不确定这是否是您想要的，而不是：

```
<span id="subscribe_dd" class="contrast">Έχεις ήδη κερδίσει ένα δώρο!<span>
    <a href="#" onclick="toggle('subscription_form_wrap');">Toggle Div</a></spa> 
```

您可以尝试将跨度包装到 a href 中：

```
<a href="#" onclick="toggle('subscription_form_wrap');">
    <span id="subscribe_dd" class="contrast">Έχεις ήδη κερδίσει ένα δώρο!<span>
</a> 
```

如果您真的只想使用 Javascript，这也可以：

```
<span id="subscribe_dd" class="contrast" onclick="toggle
    ('subscription_form_wrap')>Έχεις ήδη κερδίσει ένα δώρο!<span> 
```

不知道那个标签是什么

```
</spa> 
```

差不多吧。;)

# node.js - 更改查询字符串服务器端

> ID：14635712
> 
> 赞同：0
> 
> 时间：2013-01-31T21:43:58.793
> 
> 标签：node.js, express, request, query-string

我有一个 Express 应用程序，它通过查询字符串获取搜索参数和页码。

```
var name = req.query.name;
var state = req.query.state;
var category = req.query.category;
var pageNum = req.query.pagenum; 
```

我想要的是，如果搜索查询有页码并且没有产生结果，则在没有页码的情况下进行搜索并将其传递回客户端。这工作正常，前端正确接收数据。

唯一的事情是我希望 URL 反映更改后的页码搜索，所以`website.com/search?page=4&state=AL`我不想让它的页码被剥离或更改为 1。我可以通过前端的 Javascript 来做到这一点，但是我宁愿在服务器端更改 url（至少对我来说更有意义，而不是必须更改每个模板才能做到这一点）。

# 编辑：

看起来这样做的唯一方法是重定向到没有页面查询字符串参数的 URL。看来[这](https://stackoverflow.com/questions/1634748/how-can-i-delete-a-query-string-parameter-in-javascript)将帮助我完成这项工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:17:41.820

我不太了解您的环境，但通常 URL 不能在服务器端“更改”，因为它们显示在客户端的浏览器中。用户看到最后一个整页请求的 url。您只能使用 HTTP 重定向标头从服务器端强制 URL 更新（实际上是使用不同 URL 重新加载页面）。

您可以检查是否有任何带有页码的查询结果，如果没有，只需将重定向发送到不带页码的 URL，这样用户就会看到带有正确（无页）URL 的扩展结果。

希望它有所帮助。

# c++builder - 安装组件时找不到所需的包“rtl”

> ID：14635713
> 
> 赞同：1
> 
> 时间：2013-01-31T21:44:00.070
> 
> 标签：c++builder

安装 TMS 软件包时，我突然收到错误“找不到所需的包 'rtl'”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T21:46:07.167

经过几次尝试，我发现在 \bin\dcc32.cfg 文件中，库的路径不知何故得到了错误的驱动器：D:\Program Files\Embarcadero\RAD Studio\7.0\lib 而不是 C:\Program Files\Embarcadero\RAD Studio \7.0\库。我不知道这是怎么发生的。修复它后，安装工作正常。

# ruby - ruby: "\x0F":String (NoMethodError) 的未定义方法`>>'

> ID：14635716
> 
> 赞同：3
> 
> 时间：2013-01-31T21:44:19.743
> 
> 标签：ruby, redmine, fastcgi

使用带有 FastCGI 的 Apache 访问我的 Redmine 安装时出现此类错误。这可能是什么原因？

```
/usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:454:in `read_length': undefined method `>>' for "\x0F":String (NoMethodError)
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:448:in `read_pair'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:441:in `parse_values'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:435:in `parse'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:195:in `read_record'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:126:in `next_request'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:116:in `session'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:104:in `each_request'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/fcgi-0.8.8/lib/fcgi.rb:36:in `each'
        from /usr/local/rvm/rubies/ruby-1.9.3-p374/lib/ruby/gems/1.9.1/gems/rack-1.4.4/lib/rack/handler/fastcgi.rb:27:in `run'
        from /var/www/redmine/public/dispatch.fcgi:21:in `<main>' 
```

错误中提到的行如下所示（带有行号），它是 fcgi.rg 文件的片段：

```
453   def self::read_length(buf)
454     if buf[0] >> 7 == 0
455     then buf.slice!(0,1)[0]
456     else buf.slice!(0,4).unpack('N')[0] & ((1<<31) - 1)
457     end
458   end 
```

谢谢，马克

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-05T17:35:04.060

Well, I don't know exactly what's going on, but the error itself is telling you that buf[0] is a String, and it doesn't respond to the bitwise shift operator (>>).

I'm not sure if this is 100% the correct way to debug this, but if you try to unpack that string, you get it's decimal value:

```
irb(main):053:0> "\x0F".unpack "c"
=> [15] 
```

And if you look that up on [http://www.asciitable.com/](http://www.asciitable.com/), apparently it's the "shift in" character. So somehow a "shift in" character is getting read by the buffer and when it tries to do a bitwise shift on that character, ruby is complaining.

I would check the file that it's processing and see if there are any suspect or illegal characters in there.

# zend-framework - Zend/Controller/Action.php 文件丢失

> ID：14635717
> 
> 赞同：1
> 
> 时间：2013-01-31T21:44:20.293
> 
> 标签：zend-framework

我是 Zend 框架的新手，正在尝试 Zend 在其网站上提供的留言簿教程。我已正确下载并设置了最新的框架；php.ini include_files 的库位置设置正确。在Guestbook 教程中，GuestbookController 扩展了Zend_Controller_Action，这就是我输入的内容，但我不断收到错误消息，指出找不到Zend_Controller_Action。结果发现，/library/Zend 中缺少 Controller 文件夹。我尝试重新下载 Zend Framework，以为我可能不小心删除了它，但它也不在新下载的框架目录中。那么，我在哪里可以获得包含所有必需类文件的 Controller 文件夹？或者我该如何解决这个问题？任何帮助深表感谢。

谢谢

国度

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T23:46:05.243

听起来您正在遵循的教程是针对 ZF1 的。ZF2 于去年发布，工作方式完全不同。您可能想尝试当前手册中的快速入门：

[http://framework.zend.com/manual/2.0/en/user-guide/overview.html](http://framework.zend.com/manual/2.0/en/user-guide/overview.html)

或者，您仍然可以从 Zend 站点下载 1.12 版。

# microdata - 微数据未显示在谷歌搜索结果中

> ID：14635722
> 
> 赞同：1
> 
> 时间：2013-01-31T21:44:35.890
> 
> 标签：microdata, schema.org

我的网站中有一个“评论聚合”微数据片段，谷歌已经缓存了它，但它没有出现在谷歌搜索结果中并带有评级星。

包含微数据的 URL 是：

[http://www.rnsalert.com/](http://www.rnsalert.com/)

这是片段：

```
<div class="ui-corner-bottom" id="micro-data-reviews" itemscope="" itemtype="http://data-vocabulary.org/Review-aggregate">

<span itemprop="itemreviewed">RNSalert</span> is rated 
<span itemprop="rating" itemscope="" itemtype="http://data-vocabulary.org/Rating">
<span itemprop="average">9.0</span>
out of <span itemprop="best">10</span>
</span>
based on <a href="http://www.trustpilot.co.uk/review/rnsalert.com" target="_blank"><span itemprop="votes">16</span> independent ratings</a>.

</div> 
```

使用谷歌的结构化数据测试工具，它表明微数据被正确解析......

[http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fwww.rnsalert.com%2F&html=](http://www.google.com/webmasters/tools/richsnippets?url=http%3A%2F%2Fwww.rnsalert.com%2F&html=)

然而谷歌搜索结果并没有显示它。该页面已被缓存。

在谷歌搜索“RNS 警报”，您将获得列为第一个自然结果的页面。

有什么想法吗？

非常感谢，

担

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T16:43:31.913

我有 95% 的把握，要让您的评分/评论星出现在 Google 的网络结果中，您还必须设置 Google 对网站/页面的作者身份。6 个多月前，不需要此步骤。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T21:49:19.090

Google 应该能够识别 schema.org 中定义的所有类型，但它仅支持在搜索结果中针对这些内容类型的丰富网页摘要：

*   评论
*   人们
*   产品
*   企业和组织
*   食谱
*   活动
*   音乐

资源：

[http://support.google.com/webmasters/bin/answer.py?hl=en&answer=99170&topic=1088472&ctx=topic](http://support.google.com/webmasters/bin/answer.py?hl=en&answer=99170&topic=1088472&ctx=topic)

此外，您可能需要一段时间才能在搜索结果中看到它们 - 甚至可能需要几天时间。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-15T23:47:32.373

您的页面包含评论聚合的微数据，但与产品或项目无关。

在此处查看示例[https://schema.org/AggregateRating](https://schema.org/AggregateRating)

聚合需要在另一个项目的范围内：

```
<div itemscope itemtype="http://schema.org/Restaurant">
  <span itemprop="name">GreatFood</span>
  <div itemprop="aggregateRating" itemscope itemtype="http://schema.org/AggregateRating">
    <span itemprop="ratingValue">4</span> stars -
based on <span itemprop="reviewCount">250</span> reviews
  </div>
  <div itemprop="address" itemscope itemtype="http://schema.org/PostalAddress">
    <span itemprop="streetAddress">1901 Lemur Ave</span>
    <span itemprop="addressLocality">Sunnyvale</span>,
<span itemprop="addressRegion">CA</span> <span itemprop="postalCode">94086</span>
  </div>
  <span itemprop="telephone">(408) 714-1489</span>
  <a itemprop="url" href="http://www.dishdash.com">www.greatfood.com</a>
  Hours:
  <meta itemprop="openingHours" content="Mo-Sa 11:00-14:30">Mon-Sat 11am - 2:30pm
  <meta itemprop="openingHours" content="Mo-Th 17:00-21:30">Mon-Thu 5pm - 9:30pm
  <meta itemprop="openingHours" content="Fr-Sa 17:00-22:00">Fri-Sat 5pm - 10:00pm
  Categories:
  <span itemprop="servesCuisine">
Middle Eastern
  </span>,
  <span itemprop="servesCuisine">
Mediterranean
  </span>
  Price Range: <span itemprop="priceRange">$$</span>
  Takes Reservations: Yes
</div> 
```

不幸的是，仅仅因为你在你的网站上放了一些东西并不意味着谷歌必须在他们的搜索结果中显示它。

我假设他们需要对您的网站有一定的信任，然后才会显示任何内容。如果不是，那么每个人都会用 5 星标记他们自己的产品/帖子，这样它在搜索列表页面中看起来不错。

以我的经验，当您的网站包含对其他人产品评分的投票比您自己的产品评分时，在列表中获得评分要容易得多。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-08-16T06:41:41.600

[谷歌帮助](https://support.google.com/webmasters/answer/6398748?__RICH_CARD_BLUE_LINKS)：

> *   **搜索预览是近似的。**
>     
>     
>     
>     您的数据的真实 Google 搜索结果可能看起来不同。
>     
>     
> *   **搜索预览是说明性的。**
>     
>     
>     
>     我们不保证您预览的内容会显示在搜索结果中。您的内容可能会出现在相关查询的搜索结果中，但该内容必须首先通过我们的系统才能被适当地编入索引和排名，然后才能出现在实际的搜索结果中。如果任何结果违反我们的质量指南，我们保留自行决定过滤掉任何结果的权利。最后，您的内容的任何预览工具 URL 仅在有限的期限内有效（例如几周）。

# java - 构建和导入 EMF 比较 2

> ID：14635726
> 
> 赞同：0
> 
> 时间：2013-01-31T21:44:44.070
> 
> 标签：java, eclipse, emf, emf-compare

我试图在独立的 Java 应用程序中使用 EMF 比较。在 Eclipse 论坛中，有人建议我使用 git 中的版本。

我克隆了存储库。然后，我在工作区中导入了所有项目。我读到我只需要主 EMF 比较库，所以我将项目 org.eclipse.emf.compare 导出到一个可部署的插件和片段中，我把它放在我的默认 eclipse 目录的 plugins 文件夹中。

在我的项目中，我现在可以导入 org.eclipse.emf.compare，但是当我运行时出现以下错误：

```
Exception in thread "main" java.lang.NoClassDefFoundError: com/google/common/collect/Sets
    at org.eclipse.emf.compare.scope.AbstractComparisonScope.<init>(AbstractComparisonScope.java:55)
    at org.eclipse.emf.compare.scope.FilterComparisonScope.<init>(FilterComparisonScope.java:63) 
```

这显然是因为它没有找到这个番石榴谷歌库。

我应该如何进行？只需要改变我生成插件的方式，或者我应该生成一个jar（在这种情况下，如何将google lib一起导出？）

提前致谢，

杜索

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T13:37:09.183

好的，我回答得太晚了（我不遵循“emf”标签：s），但无论如何：EMF Compare wiki 解释了如何独立使用它，以及最小的依赖集是什么（请参阅此[常见问题解答条目](http://wiki.eclipse.org/EMF_Compare/FAQ#Can_EMF_Compare_be_used_standalone.3F)）。

包含 Guava 11 的第一个 Orbit（包含第三方依赖项的 Eclipse 存储库）构建[在这里，](http://download.eclipse.org/tools/orbit/downloads/drops/R20130118183705/)或者您可以直接使用它的[p2 更新站点](http://download.eclipse.org/tools/orbit/downloads/drops/R20130118183705/repository/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-15T02:51:35.860

第一张图片可以在这个网站上找到。 [图1](https://i.stack.imgur.com/anqll.png) [https://www.eclipse.org/emf/compare/documentation/latest/FAQ.html](https://www.eclipse.org/emf/compare/documentation/latest/FAQ.html)

第二张照片就是我的工作方式。 [图二](https://i.stack.imgur.com/T6ubL.png)

# omniauth - 使用omniauth salesforce 刷新令牌

> ID：14635727
> 
> 赞同：2
> 
> 时间：2013-01-31T21:44:49.680
> 
> 标签：omniauth

这是一个使用omniauth-salesforce 的红宝石问题。我有omniauth 1.1.1 和omniauth-salesforce 1.0.3，我可以获得用户身份验证。但是，默认情况下不返回 refresh_token。我只得到access_token。我的回调 URL 是 http://localhost:3000/auth/salesforce/callback

根据“在Force.com上深入挖掘OAuth2.0”的描述，[https](https://login.salesforce.com/services/oauth2/authorize) ://login.salesforce.com/services/oauth2/authorize的默认范围是id api refresh_token。但这种情况并非如此。

然后我尝试在omniauth.rb中指定范围参数

提供者：salesforce、salesforce_client_id、client_secret、{:scope => "id api refresh_token"}

然后我收到一条错误消息：不允许请求的范围

此外，如果我尝试将以下内容放在浏览器上，我会收到相同的错误消息

[https://login.salesforce.com/services/oauth2/authorize?response_type=code&client_id=3MVG9rFJvQRVOvk4RuIKaSYwf07LcsMtIAUK7h3Q6n5OHfD.IbFpEsROli3SqxWo67RklJ5FBdnYf4ejHNFrq&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fauth%2Fsalesforce%2Fcallback&display=page&scope=api](https://login.salesforce.com/services/oauth2/authorize?response_type=code&client_id=3MVG9rFJvQRVOvk4RuIKaSYwf07LcsMtIAUK7h3Q6n5OHfD.IbFpEsROli3SqxWo67RklJ5FBdnYf4ejHNFrq&redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Fauth%2Fsalesforce%2Fcallback&display=page&scope=api)

任何帮助将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T02:50:13.130

您在*omniauth.rb*的`provider`声明中设置范围是正确的。但是，在 salesforce.com 发出之前`refresh_token`，必须将应用程序配置为支持此 OAuth 范围。

1.  在 salesforce.com 上，导航到您的应用程序的配置位置。（设置 > 创建 > 应用程序）
2.  在 Connected Apps 下，单击您的应用程序名称以查看其设置，然后单击 Edit。
3.  在选定的 OAuth 范围下，确保选中“随时代表您执行请求”。即使您已经选择了“完全访问”，您也必须包含此内容。
4.  保存，然后再次尝试您的 OAuth 流程。更新需要一段时间才能传播。

在您的回调控制器操作中，`refresh_token`现在将在`request.env["omniauth.auth"].credentials.refresh_token`.

# html - 如何在不支持 flash 的 iPhone/Android 上显示替代文本

> ID：14635731
> 
> 赞同：0
> 
> 时间：2013-01-31T21:45:11.317
> 
> 标签：html

我正在尝试在不支持 Flash 的浏览器/设备上显示替代文本。我搜索了不同的网站并尝试了不同的代码，但我没有得到任何有效的东西。

代码如下，flash 显示动画文本：

```
class="result10435918"
codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,40,0"
width="595"
height="39"
id="haxe"
align="middle">
<param name="movie" value="logo70644855.swf"/>
<param name="allowScriptAccess" value="always" />
<param name="quality" value="high" />
<param name="wmode" value="transparent" />

<embed src="images/homeheader2.swf"
       wmode="transparent"
       width="595"
       height="39"
       name="haxe"
       quality="high"
       allowScriptAccess="always"
       type="application/x-shockwave-flash"
       pluginspage="http://www.macromedia.com/go/getflashplayer"

></embed> 
```

谢谢夏兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:47:55.497

尝试使用对象标签来包装 Flash 片段，并在其中包含您的后备文本。在对象标签中设置宽度和高度定义了闪存占用的特定空间量。如果该 Flash 未加载，它将显示对象标记内的其他内容（后备文本）。您还可以包含图像或其他内容来代替后备文本。

```
<object type="application/x-shockwave-flash" data="yourmovie.swf" width="400" height="300">
    <param name="movie" value="yourmovie.swf" />
    Fallback Text Here
</object> 
```

# ruby-on-rails - 根据邀请计数成员 - 查询

> ID：14635733
> 
> 赞同：0
> 
> 时间：2013-01-31T21:45:15.803
> 
> 标签：ruby-on-rails

我计算了许多用户生成的操作，并且在大多数情况下它很容易，但是对于一个更复杂的查询，我遇到了麻烦。

我有一个邀请模型和一个用户模型，我可以轻松计算用户发送的邀请数量，但**我想根据现有成员发出的邀请来计算注册的新成员数量。**

在邀请中，受邀者的电子邮件保存为`recipient_email` 然后，我知道我可以通过某种方式检查新成员`email`，但不清楚语法。

任何帮助将不胜感激。更多信息如下。

邀请模型：

```
class Invitation < ActiveRecord::Base
  attr_accessible :recipient_email, :sender_id, :sent_at, :token
  belongs_to :sender, :class_name => 'User'
  has_one :recipient, :class_name => 'User'

  validates_presence_of :recipient_email
  validates_uniqueness_of :recipient_email, :message => '%{value} has already been invited'
  validate :recipient_is_not_registered
  validate :sender_has_invitations, :if => :sender

  default_scope order: 'invitations.created_at DESC'

  before_create :generate_token
  before_create :decrement_sender_count, :if => :sender

  after_create do |invitation|
   InvitationMailer.delay.invitation_email(self)
  end

  def invitee
    User.find_by_email(self.recipient_email)
  end

  def invitee_registered?
    !invitee.blank?
  end

  def invitee_submitted?
      !invitee.try(:submissions).blank?
  end

  private
  def recipient_is_not_registered
    errors.add :recipient_email, 'is already registered' if User.find_by_email(recipient_email)
  end

  def sender_has_invitations
    unless sender.invitation_limit > 0
      errors.add_to_base "You have reached your limit of invitations to send. 
                      You can contact Lumeo if you'd like to request more."
    end
  end

  def generate_token
    self.token = Digest::SHA1.hexdigest([Time.now, rand].join)
  end

  def decrement_sender_count
    sender.decrement! :invitation_limit
  end
end 
```

用户模型：

```
class User < ActiveRecord::Base
  devise :database_authenticatable, :registerable,
         :recoverable, :rememberable, :trackable, :validatable, :mailchimp

  attr_accessible :name, :email, :password, :password_confirmation, 
                  :remember_me, :role_id, :role_ids, :image_attributes,
                  :terms, :profile_attributes, :current, :image, :roles,
                  :invitation_token, :join_mailing_list, :affiliate_id,
                  :invitation_affiliate_token, :affiliation, :referrer_id
  validates_uniqueness_of :email
  VALID_NAME_REGEX = /[\w]+([\s]+[\w]+){1}+/
  validates :name, presence: true, 
                    format: {with: VALID_NAME_REGEX} 

  #invitation
  has_many :sent_invitations, :class_name => 'Invitation', :foreign_key => 'sender_id'
  belongs_to :invitation

  def invitation_token
    invitation.token if invitation
  end
  def invitation_token=(token)
    self.invitation = Invitation.find_by_token(token)
  end
  before_create :set_invitation_limit
  has_one :invitation_affiliate, :class_name => "Affiliate", :foreign_key => 'token', :primary_key => 'invitation_affiliate_token'

  private

  def set_invitation_limit
    self.invitation_limit = 100
  end
end 
```

邀请和用户表：

```
create_table "users", :force => true do |t|
  t.string   "email",                      :default => "",    :null => false
  t.string   "encrypted_password",         :default => "",    :null => false
  t.string   "reset_password_token"
  t.datetime "reset_password_sent_at"
  t.datetime "remember_created_at"
  t.integer  "sign_in_count",              :default => 0
  t.datetime "current_sign_in_at"
  t.datetime "last_sign_in_at"
  t.string   "current_sign_in_ip"
  t.string   "last_sign_in_ip"
  t.datetime "created_at",                                    :null => false
  t.datetime "updated_at",                                    :null => false
  t.integer  "role_id"
  t.string   "name"
  t.integer  "invitation_id"
  t.integer  "invitation_limit"
end

create_table "invitations", :force => true do |t|
  t.integer  "sender_id"
  t.string   "recipient_email"
  t.string   "token"
  t.datetime "sent_at"
  t.datetime "created_at",      :null => false
  t.datetime "updated_at",      :null => false
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:07:51.747

我可以想到两种不同的方法：

1.  `accepted`在邀请中添加字段

    您可以为名为 的邀请添加一个布尔字段`accepted`，默认值为 false，当接收者接受邀请时将其设置为 true。然后创建一个名为的范围`accepted`，它只返回接受的邀请 `scope :accepted, where(accepted: true)`

你得到你想要的`@user.sent_invitations.accepted.count`

2\. 执行以下查询

`User.where(email: @user.sent_invitations.map(&:recipient_email)).count`

# c# - 如何有效地计算移动标准差

> ID：14635735
> 
> 赞同：23
> 
> 时间：2013-01-31T21:45:26.287
> 
> 标签：c#, algorithm, finance, moving-average, standard-deviation

您可以在下面看到我的 C# 方法来计算每个点的布林带（移动平均线、上升带、下降带）。

如您所见，此方法使用 2 个 for 循环来使用移动平均值计算移动标准偏差。它曾经包含一个额外的循环来计算过去 n 个周期的移动平均值。我可以通过在循环开始时将新点值添加到 total_average 并在循环结束时删除 i - n 点值来删除这一点。

我现在的问题基本上是：我能否以与移动平均线类似的方式移除剩余的内部循环？

```
 public static void AddBollingerBands(SortedList<DateTime, Dictionary<string, double>> data, int period, int factor)
    {
        double total_average = 0;

        for (int i = 0; i < data.Count(); i++)
        {
            total_average += data.Values[i]["close"];

            if (i >= period - 1)
            {
                double total_bollinger = 0;
                double average = total_average / period;

                for (int x = i; x > (i - period); x--)
                {
                    total_bollinger += Math.Pow(data.Values[x]["close"] - average, 2);
                }

                double stdev = Math.Sqrt(total_bollinger / period);

                data.Values[i]["bollinger_average"] = average;
                data.Values[i]["bollinger_top"] = average + factor * stdev;
                data.Values[i]["bollinger_bottom"] = average - factor * stdev;

                total_average -= data.Values[i - period + 1]["close"];
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-02-01T01:13:59.870

计算平方和的方法的问题是它和平方和可能会变得非常大，计算它们的差可能会引入[**非常**大的误差](http://www.johndcook.com/blog/2008/09/26/comparing-three-methods-of-computing-standard-deviation/)，所以让我们想想更好的办法。为什么需要这样做，请参阅[关于计算方差的算法](http://en.wikipedia.org/wiki/Algorithms_for_calculating_variance)的维基百科文章和[关于数值结果的理论解释的约翰库克](http://www.johndcook.com/blog/2008/09/28/theoretical-explanation-for-numerical-results/)）

首先，我们不计算标准差，而是关注方差。一旦我们有了方差，stddev 就是方差的平方根。

`x`假设数据在一个名为;的数组中。将 n 大小的窗口滚动 1 可以认为是移除 的值`x[0]`并添加 的值`x[n]`。让我们分别用 µ 和 µ'表示`x[0]..x[n-1]`和的平均值。和`x[1]..x[n]`的方差之间的差异是，在取消一些项并应用 后：`x[0]..x[n-1]``x[1]..x[n]``(a²-b²) = (a+b)(a-b)`

```
Var[x[1],..,x[n]] - Var[x[0],..,x[n-1]] 
= (\sum_1^n x[i]² - n µ’²)/(n-1) - (\sum_0^{n-1} x[i]² - n µ²)/(n-1)
= (x[n]² - x[0]² - n(µ’² - µ²))/(n-1) 
= (x[n]-µ’ + x[0]-µ)(x[n]-x[0])/(n-1) 
```

因此，方差会受到不需要您保持平方和的东西的干扰，这对数值准确性更好。

您可以在开始时使用适当的算法（[Welford 方法](http://www.johndcook.com/standard_deviation.html)）计算一次均值和方差。之后，每次您必须用`x[0]`另一个值替换窗口中的值时，`x[n]`您都会像这样更新平均值和方差：

```
new_Avg = Avg + (x[n]-x[0])/n
new_Var = Var + (x[n]-new_Avg + x[0]-Avg)(x[n] - x[0])/(n-1)
new_StdDev = sqrt(new_Var) 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2013-02-01T00:23:50.027

答案是肯定的，你可以。在 80 年代中期，我在 FORTRAN 中开发了这样一种算法（可能不是原创的），用于过程监视和控制应用程序。不幸的是，那是 25 多年前的事了，我不记得确切的公式，但该技术是移动平均线的扩展，使用二阶计算而不仅仅是线性计算。

* * *

在看了你的代码之后，我想我可以弄清楚我当时是怎么做到的。注意你的内部循环是如何产生平方和的？：

```
 for (int x = i; x > (i - period); x--)
            {
                total_bollinger += Math.Pow(data.Values[x]["close"] - average, 2);
            } 
```

与您的平均值最初必须具有值总和的方式大致相同？唯一的两个区别是顺序（它的幂 2 而不是 1）以及在平方之前减去每个值的平均值。现在这可能看起来不可分割，但实际上它们可以分开：

```
SUM(i=1; n){ (v[i] - k)^2 } 
```

是

```
SUM(i=1..n){v[i]^2 -2*v[i]*k + k^2} 
```

变成

```
SUM(i=1..n){v[i]^2 -2*v[i]*k} + k^2*n 
```

这是

```
SUM(i=1..n){v[i]^2} + SUM(i=1..n){-2*v[i]*k} + k^2*n 
```

这也是

```
SUM(i=1..n){v[i]^2} + SUM(i=1..n){-2*v[i]}*k + k^2*n 
```

现在第一项只是平方和，您处理它的方式与对平均值求和的方式相同。最后一项 ( `k^2*n`) 只是 的平均平方乘以`period`。由于您将结果除以周期，因此您只需添加新的平均平方而无需额外的循环。

最后，在第二项 ( `SUM(-2*v[i]) * k`) 中，`SUM(v[i]) = total = k*n`您可以将其更改为：

```
-2 * k * k * n 
```

或者只是`-2*k^2*n`，它是平均平方的 -2 倍，一旦周期 ( `n`) 再次被划分。所以最终的组合公式是：

```
SUM(i=1..n){v[i]^2} - n*k^2 
```

或者

```
SUM(i=1..n){values[i]^2} - period*(average^2) 
```

（一定要检查这个的有效性，因为我是从头顶推导出来的）

并入您的代码应如下所示：

```
public static void AddBollingerBands(ref SortedList<DateTime, Dictionary<string, double>> data, int period, int factor)
{
    double total_average = 0;
    double total_squares = 0;

    for (int i = 0; i < data.Count(); i++)
    {
        total_average += data.Values[i]["close"];
        total_squares += Math.Pow(data.Values[i]["close"], 2);

        if (i >= period - 1)
        {
            double total_bollinger = 0;
            double average = total_average / period;

            double stdev = Math.Sqrt((total_squares - Math.Pow(total_average,2)/period) / period);
            data.Values[i]["bollinger_average"] = average;
            data.Values[i]["bollinger_top"] = average + factor * stdev;
            data.Values[i]["bollinger_bottom"] = average - factor * stdev;

            total_average -= data.Values[i - period + 1]["close"];
            total_squares -= Math.Pow(data.Values[i - period + 1]["close"], 2);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T21:48:47.533

我已经使用了 commons-math（并为该库做出了贡献！）与此非常相似。它是开源的，移植到 C# 应该像商店购买的馅饼一样容易（您是否尝试过从头开始制作馅饼！？）。看看：[http](http://commons.apache.org/math/api-3.1.1/index.html) ://commons.apache.org/math/api-3.1.1/index.html 。他们有一个 StandardDeviation 类。去镇上！

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-10-07T11:51:06.280

上面已经给出了最重要的信息——但也许这仍然是普遍感兴趣的。

此处提供了一个用于计算移动平均值和标准差的小型 Java 库： [https ://github.com/tools4j/meanvar](https://github.com/tools4j/meanvar)

该实现基于上述 Welford 方法的变体。已衍生出可用于移动值窗口的移除和替换值的方法。

**免责声明：**我是上述图书馆的作者。

# ruby-on-rails - Rspec + Capybara + FactoryGirl：已经登录错误

> ID：14635739
> 
> 赞同：0
> 
> 时间：2013-01-31T21:45:58.237
> 
> 标签：ruby-on-rails, rspec, capybara, factory-bot

我尝试使用 Capybara、Rspec 和 FactoryGirls on Rails 来传递这种友谊特性规范。

出于某种原因，我不明白为什么，我总是在这个错误上失败。看起来会话在运行测试后没有被破坏。

```
 1) Friendships user requests friendship signed in POST /:username/friendships requests friendship
     Failure/Error: page.should have_content 'Successfully requested friendship.'
       expected there to be text "Successfully requested friendship." in "× You are already signed in. meeter Messages Notifications Settings Settings Logout Explore Dates nearby Suggestions You Messages Notifications Friends Publish Help No ideas found with your criteria."
     # ./spec/features/friendships_spec.rb:32:in `block (5 levels) in <top (required)>' 
```

完整的规格

```
require 'spec_helper'

include Warden::Test::Helpers
Warden.test_mode!

describe "Friendships" do 

  before(:each) do 
    @user = FactoryGirl.create(:user, :male)
    @friend = FactoryGirl.create(:user, :female)
  end

  describe "GET /:username/friendships" do 
    pending "display friendships"
  end

  context "user requests friendship" do

    context "signed in" do

      after(:each) do 
        Warden.test_reset! 
      end

      describe "POST /:username/friendships" do 
        it "requests friendship" do 
          login_as(@user, scope: :user)
          visit user_path(@friend)
          click_button 'Request Friendship'
          page.should have_content 'Successfully requested friendship.'
          logout(@user)
        end
        pending "friend receives confirmation notification"
      end

      describe "POST /:username/friendships/cancels" do
        pending "cancels a friendship request sent"
      end

    end

    context "not signed in" do 

      describe "POST /:username/friendships" do 
        it "requests friendship" do 
          visit user_path(@friend)
          click_button 'Request Friendship'
          page.should have_content 'You need to sign in first to continue.'
        end
      end
    end

  end 
```

知道如何通过这个吗？

# ms-access - 如何对一行执行校验和

> ID：14635746
> 
> 赞同：1
> 
> 时间：2013-01-31T21:46:37.727
> 
> 标签：ms-access, ms-access-2010

有没有办法使用 ms 访问对一行执行校验和？我需要比较两个查询是否相等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T19:07:12.020

Access 中没有内置任何内容来返回一行的校验和。我过去为验证两行中的数据是否相同所做的是所有字段上的左连接和右连接的联合。如果要输入很多字段，这会很痛苦，但它确实有效。您还可以在 VBA 中编写自己的 MD5 哈希并在查询中返回。

# c# - 反应式扩展主题使用

> ID：14635747
> 
> 赞同：0
> 
> 时间：2013-01-31T21:46:39.393
> 
> 标签：c#, system.reactive

我正处于学习 Rx 的早期阶段，并且遇到了 Subject 课程。我不太明白为什么这个类存在。我知道它同时实现了 IObservable 和 IObserver，但是 Subjects 有什么用？

据我所知，他们可以充当源和一群订阅者之间的代理，但订阅者不能直接订阅源吗？当我看到 Subject 的实例被用作可观察对象和观察者时，我会感到困惑。

我确信我在这里没有得到一些基本事实，但我不知道主题给游戏带来了什么。我想我正在寻找一些基本的（但希望是现实世界）示例，说明主题何时有用，何时无用（因为我还读过主题通常不被使用，替换为 Observable.Create）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:41:55.403

首先，很多人会告诉你`Subject<T>` **不**属于，因为它违反了 Rx 框架中的其他一些原则/模式。

也就是说，它们充当 an`IObservable`或 an `IObserver`，因此您可以从中获得一些有用的功能 - 我通常在初始开发阶段使用它们：

*   某种“调试点”，我可以在其中订阅`IObservable`与 a 内联的链`Subject<T>`，并使用调试器检查内容。

*   一个“按需观察”，我可以手动调用`OnNext`并传入我想注入流的数据

*   曾经使用它们来复制`ConnectableObserable`现在所做的事情 - 多个订阅者的“广播”机制到单个`Observable`，但现在可以完成`Publish`。

*   不同系统之间的桥接层；同样，现在对于各种`FromAsync`,`FromEvent`扩展，这在很大程度上是不必要的，但它们仍然可以这样使用（基本上，“旧”系统将事件注入`Subject<T>`via `OnNext`，然后从正常的 Rx 流程开始。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-28T13:10:13.067

使用主题意味着我们现在正在管理状态，这可能会发生变化。变异状态和异步编程很难做到正确。此外，许多运算符（扩展方法）都经过精心编写，以确保订阅和序列的正确和一致的生命周期得以维持。当你介绍主题时，你可以打破这一点。

Create 方法相对于主题的一个显着好处是序列将被延迟评估。

在这个例子中，我们展示了我们如何首先通过标准阻塞热切评估调用返回一个序列，然后我们展示了返回一个可观察序列而不通过延迟评估阻塞的正确方法。

下面的示例将在他们收到 IObservable 之前被阻止至少 1 秒，无论他们是否确实订阅了它。

```
private IObservable<string> BlockingMethod()
{
var subject = new ReplaySubject<string>();
subject.OnNext("a");
subject.OnNext("b");
subject.OnCompleted();
Thread.Sleep(1000);
return subject;
} 
```

在 bleow 示例中，消费者立即收到 IObservable，并且只有在订阅时才会产生线程休眠的成本。

```
private IObservable<string> NonBlocking()
{

return Observable.Create<string>(

(IObserver<string> observer) =>
{

observer.OnNext("a");
observer.OnNext("b");
observer.OnCompleted();
Thread.Sleep(1000);
return Disposable.Create(() => Console.WriteLine("Observer has unsubscribed"));
//or can return an Action like 
//return () => Console.WriteLine("Observer has unsubscribed"); 
});
} 
```

# polygon - 从纬度/经度多边形获取边界框

> ID：14635758
> 
> 赞同：3
> 
> 时间：2013-01-31T21:47:41.360
> 
> 标签：polygon, latitude-longitude, contains, point

我有一个边界列表（多边形）和一个由纬度和经度表示的方式列表。我想知道一种方式是否在多边形内。我在 perl 中执行此操作，但找不到任何有用的计算方法。Math::Polygon (::Calc) 具有有趣的功能，但不适用于 lat/lon，仅适用于 x/y。

所以我正在考虑让它更容易并为每个多边形生成一个边界框，这样我就更容易检查一个点是否在边界框内。

有谁知道算法如何获得边界框。一个伪代码就足够了，所以我可以用 perl 对其进行编码。

在不将多边形转换为边界框的情况下检查是否在多边形内会更好，但我无法在网上找到任何有用的东西。有一些用于简单的基于 2d x/y 的坐标系，但不适用于球形纬度/经度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:53:18.667

首先，将每个多边形线段的起点和终点放在一个数组中。然后遍历数组以找到 MinX、MinY、MaxX 和 MaxY。然后点 (MinX, MinY) 是你盒子的左下角， (MaxX, MaxY) 是右上角。

# ios - NSString 的方法 'getCString' 为阿拉伯文本返回 false

> ID：14635759
> 
> 赞同：1
> 
> 时间：2013-01-31T21:47:44.650
> 
> 标签：ios, objective-c, nsstring, arabic

我正在生成 QR 码，如果文本只有英文，一切正常。当我想用一些阿拉伯文本生成二维码时，它在 NSString 的方法“getCString:maxLength:encoding:”处失败。

假设，我有两个字符串：

```
NSString *englishText = @"Some text English";
NSString *englishArabicMixText = @"Some text بالعربي";

char strEng [[englishText length] + 1];
char strArb [[englishArabicMixText length] + 1];

1- [englishText getCString:strEng maxLength:[englishText length] + 1 encoding:NSUTF8StringEncoding];
2- [englishArabicMixText getCString:strArb maxLength:[englishArabicMixText length] + 1 encoding:NSUTF8StringEncoding]; 
```

在 Case#1 'getCString' 返回 true 并生成 QR 码，在 Case#2 返回 false 并无法生成代码。我应该怎么做，以便在 case#2 中它也应该返回 true ？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:07:01.903

`length`返回 Unicode 字符的数量。您必须使用`lengthOfBytesUsingEncoding:`，它返回以给定编码存储接收器所需的字节数。

```
NSUInteger arbLength = [englishArabicMixText lengthOfBytesUsingEncoding:NSUTF8StringEncoding] + 1;
char strArb [arbLength];
[englishArabicMixText getCString:strArb maxLength:arbLength encoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:58:46.183

2 由于两个可能的原因返回 false：

1) 字符串不能用指定的编码进行转换。

2) 保存编码字符串的缓冲区太小。

我猜（或者至少我建议你开始调查）问题是 nr. 2.

因为当您转换为 UTF8 时，单个未编码字符可能会导致多个编码字符。'A' 是一个值为 65 的单字节，但阿拉伯字符或某种符号可能需要更多字节。

您假设您的目标缓冲区需要与您的 NSString 相同数量的字符相同的字节数

所以你应该这样做：

```
NSUInteger size = [englishArabicMixText lengthOfBytesUsingEncoding : NSUTF8StringEncoding];

if(size>0)
{
    size++;

    strArb = malloc(size);  // NOTE: you should allocate space for your string at runtime!!

    [englishArabicMixText getCString:strArb maxLength:size encoding:NSUTF8StringEncoding];
} 
```

你也应该对纯英文字符串做同样的事情。

而且我建议在运行时使用 malloc 为 C 字符串动态分配空间，然后在您不再需要它时释放它。

# mysql - 如何从两个表中检索数据？我必须使用加入吗？

> ID：14635763
> 
> 赞同：0
> 
> 时间：2013-01-31T21:48:14.947
> 
> 标签：mysql, sql, select, join

我有两张表，用户和最喜欢的歌曲。

用户注册到该站点，并且必须登录。所以查询是：

```
SELECT * FROM users WHERE Username='$Name' AND Password='$Pass' 
```

最喜欢的歌曲表中也有他们的用户名。如何更改查询以便也选择他们最喜欢的歌曲？登录后，我希望这首歌回响给他们。

歌单：

```
Username  Song:
test1   | Singing in the rain
test2   | Nightdance
test3   | Firestorm 
```

用户表：

```
Username  Password
test1   | 123123
test2   | 123123
test3   | 123123 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:51:26.677

```
SELECT u.Username, COALESCE(s.Song, 'Oh, you have no favorite song ?')
FROM users u
LEFT JOIN song s 
   ON s.UserName = u.UserName
WHERE Username='$Name' AND Password='$Pass' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T21:52:27.277

我假设最喜欢的歌曲表被命名为`favorite_songs_table`

```
SELECT u.*, f.song FROM users u
INNER JOIN favorite_songs_table f ON f.user_name = u.name
WHERE Username='$Name' AND Password='$Pass' 
```

# c - Hello.c：在函数'main'中：Hello.c:13：警告：'main'的返回类型不是'int'？

> ID：14635786
> 
> 赞同：5
> 
> 时间：2013-01-31T21:49:43.320
> 
> 标签：c, int

> **可能重复：**
> [main() 在 C/C++ 中应该返回什么？](https://stackoverflow.com/questions/204476/what-should-main-return-in-c-c)

大约一个小时前才开始编写 C 代码，经过几个月的基本 java 编码后，在编译基本的 hello world 程序时遇到了问题。

这是我的代码：

```
#include < stdio.h>

void main()
{
    printf("\nHello World\n");
} 
```

这就是我尝试编译时得到的结果：

```
 Hello.c: In function ‘main’:
 Hello.c:13: warning: return type of ‘main’ is not ‘int’ 
```

任何帮助将不胜感激，谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T21:57:01.713

The standard signatures for `main` are either

```
int main(void) 
```

or

```
int main(int argc, char **argv) 
```

Your compiler is simply enforcing the standard.

Note that an implementation *may* support `void main()`, but it must be explicitly documented, otherwise the behavior is undefined. Like dandan78 says, a *large* number of books and online references get this wrong.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T21:51:26.900

它应该是

```
int main() {} 
```

那么`return 0`如果程序正确终止或任何其他数字（如果出现错误），您应该这样做。这是 Unix 约定，因此脚本可以检查程序是否正确终止或发生错误。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T21:51:50.277

c 中的 main-function 必须返回一个 int：

```
#include < stdio.h>

int main()
{
  printf("\nHello World\n");
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-01-31T21:51:39.983

无论您选择哪个原型`main()`，它的返回值都不能是`void`. 它必须是`int`。许多书籍和教程都犯了这个错误，一些编译器倾向于抱怨，而另一些则没有。

# java - 在 SQLite 数据库更改时更新光标

> ID：14635789
> 
> 赞同：0
> 
> 时间：2013-01-31T21:49:52.870
> 
> 标签：java, android, class, android-activity, android-sqlite

这是我的场景：

**活动 1**，是我有一个项目列表的地方。

**Activity 1**包含一个**Class A**的对象，它处理通过设置的 Loader Manager 获取和返回由 SQLite 数据库检索的数据游标到**Activity 1**。

在**活动 1**中，列表中的每个视图都有按钮。按下按钮时， 执行**B 类**。

**B 类**更改 SQLite 数据库中的单个值。

在**Class B**中，如何通知加载器管理器数据已更改，以便刷新游标。请记住，Loader Manager 是在**Class A**中设置的。

本质上，如果以上没有意义，我需要在底层 sql 数据发生变化时刷新游标，但我需要从没有直接连接到加载器管理器的类中执行此操作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:57:37.483

您可以让两个类都可以访问彼此，例如在 Activity1 中的 onCreate

```
ClassA obj1 = new ClassA(...);
ClassB obj2 = new ClassB(...);
obj2.setClasssA(obj1); 
```

在您的 ClassB 代码中，完成更新数据库后，您只需调用 classA 中的方法来更新游标。很长的东西：

```
obj1.onNewData(); 
```

我希望这是有道理的

# vba - 如果用户从另一个应用程序返回 Excel，请执行操作

> ID：14635790
> 
> 赞同：0
> 
> 时间：2013-01-31T21:49:56.990
> 
> 标签：vba, excel

我有一个包含网页链接的 Excel 工作簿。用户可以单击链接，从而最小化 Excel 窗口并打开他们的浏览器。当他们完成网站后，他们会最小化或关闭浏览器，这会将他们返回到 Excel（因为这是他们之前的活动窗口）。

当用户返回 Excel 时，我希望 VBA 采取行动（更新表格）。

我查看了 Workbook_WindowActivate 事件，但这仅适用于您在 Excel 应用程序中从一个 Excel 工作簿移动到另一个工作簿时。

也许我可以以某种方式使用 Application.name 或 Windows 函数 GetActiveWindow 但我不确定如何最好地做到这一点。

有任何想法吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T00:42:07.833

您想要为 Workbook_SheetFollowHyperlink 添加事件处理程序。然后，您可以使用下面的代码。这只是检查网页是否有焦点。'DO EVENTS' 是您添加代码然后退出子的地方

```
'********************* References used
'* Microsoft Shell Controls An Automation : shell32.dll*
'* Microsoft HTML Objects Library: MSHTML.dll expand » *
'* Microsoft Internet Controls: IEFRAME.dll *

Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)
Dim ie As InternetExplorer 'IE window variable
Dim sUrl 'url of the webpage
Dim dt As Date 'timer

'set the url to look for
sUrl = Target.Address
'set initial timeout period *used instead of browser ready due to page redirection.
'you should also check the browser ready status
dt = DateAdd("s", 5, DateTime.Now)
    Do While dt > DateTime.Now
        DoEvents
    Loop

'reset the timeout period to allow time to view and select
dt = DateAdd("s", 30, DateTime.Now)
Dim shShell As New Shell ' windows shell variable
    'continue loop until we hit the timeout or the webpage no longer has focus
    Do While dt > DateTime.Now
        'Loop through all the IE windows
        For Each ie In shShell.Windows
            'check to see if the URL's match
            If InStr(ie.LocationURL, sUrl) Then

            Dim hDoc As HTMLDocument
            'get the webpage document
            Set hDoc = ie.document
                'check to see if it has focus
                If Not hDoc.hasFocus Then
                    ThisWorkbook.Activate
                    '''''''''''''
                    ' DO EVENTS '
                    '''''''''''''
                    Exit Sub
                End If
            Set hDoc = Nothing
            End If
        Next ie
    Loop
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T22:25:48.453

这就是我最终要做的。我从这篇文章中借了很多东西：[如何制作一个在 Excel 中定期执行的宏？](https://stackoverflow.com/questions/211715/how-to-make-a-macro-which-executes-periodically-in-excel/211779#211779)

当用户单击超链接时，代码开始定期检查 Excel 是否是他们的活动窗口。我发现如果用户不在 Excel 应用程序中，GetActiveWindow 函数返回零，如果是，则返回一些正数。如果代码发现用户从不同的窗口返回到 Excel（之前的检查发现他们在不同的窗口中，而当前的检查发现他们在 Excel 中）然后我的表会更新并且计时器停止检查活动窗口.

这样做的好处是适用于任何网络浏览器。

```
Option Explicit

Dim ExcelIsActive As Boolean
Private Declare Function GetActiveWindow Lib "user32" () As Long
Dim m_dtNextTime As Date
Dim m_dtInterval As Date
Dim DisableFlag As Boolean

Private Sub Workbook_SheetFollowHyperlink(ByVal Sh As Object, ByVal Target As Hyperlink)
    Call start
End Sub

Public Sub Enable(Interval As Date)
    Call Disable
    m_dtInterval = Interval
    Call starttimer
End Sub

Private Sub starttimer()
    m_dtNextTime = Now + m_dtInterval
    Application.OnTime m_dtNextTime, "TestActive"
End Sub

Public Sub TestActive()
    If GetActiveWindow > 0 Then
        If ExcelIsActive = False Then
            ExcelIsActive = True
            Call RefreshQuery
        End If
    Else
        ExcelIsActive = False
    End If
    If Not DisableFlag Then
        Call starttimer
    Else
        Call Disable
    End If
End Sub

Public Sub Disable()
    Dim dtZero As Date
    If m_dtNextTime <> dtZero Then
        ' Stop timer if it is running
        On Error Resume Next
        Application.OnTime m_dtNextTime, "TestActive", , False
        On Error GoTo 0
        m_dtNextTime = dtZero
    End If
    m_dtInterval = dtZero
End Sub

Sub start()
    'Start the timer
    DisableFlag = False
    ExcelIsActive = True
    'Sets the interval to be three seconds
    Call Enable(#12:00:03 AM#)
End Sub

Public Sub RefreshQuery()

'I do my stuff here

'Stop the timer until the next time the user launches the browser
DisableFlag = True

End Sub 
```

# python - 尝试模拟模块时出现 ImportError

> ID：14635791
> 
> 赞同：4
> 
> 时间：2013-01-31T21:50:07.237
> 
> 标签：python, unit-testing, mocking

我有一个正在测试的模块依赖于另一个在测试时不可用的模块。为了解决这个问题，我（基本上）写道：

```
import mock
import sys

sys.modules['parent_module.unavailable_module'] = mock.MagicMock()
import module_under_test 
```

只要`module_under_test`执行以下操作之一，它就`import parent_module`可以正常工作`import parent_module.unavailable_module`。但是，以下代码会生成回溯：

```
>>> from parent_module import unavailable_module
ImportError: cannot import name unavailable_module 
```

这是怎么回事？我可以在我的测试代码中做什么（不更改导入语句）以避免此错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-04T18:59:28.737

好吧，我想我已经想通了。在声明中似乎：

```
from parent_module import unavailable_module 
```

Python 查找被调用的*属性*。因此，以下设置代码完全替换inside ：`parent_module``unavailable_module``unavailable_module``parent_module`

```
import mock
import sys

fake_module = mock.MagicMock()
sys.modules['parent_module.unavailable_module'] = fake_module
setattr(parent_module, 'unavailable_module', fake_module) 
```

我测试了我知道的四个导入习语：

```
import parent_module
import parent_module.unavailable_module
import parent_module.unavailable_module as unavailabe_module
from parent_module import unavailable_module 
```

并且每个都使用上述设置代码。

# javascript - Javascript 中的 Ruby

> ID：14635802
> 
> 赞同：1
> 
> 时间：2013-01-31T21:51:26.490
> 
> 标签：javascript, ruby-on-rails-3, url-routing

我正在尝试将 Rails 路径输入 JavaScript。

看起来有点像这样

视图.html.erb

```
 <script type="text/javascript" charset="utf-8">
      grid.load("/users/:user_id/actions/:action_id/tasks/data.xml");
    </script> 
```

但是，这显然并没有真正主动地输入 :user_id 和 :action_id 。有没有办法将红宝石嵌入其中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:53:35.753

您可以使用您的路线生成的辅助方法，假设您已经为您的路线提供了合理的名称：

```
<script type="text/javascript" charset="utf-8">
  grid.load("<%= user_actions_tasks_data_path(@user, @action) %>");
</script> 
```

# java - java防止类覆盖equals

> ID：14635808
> 
> 赞同：1
> 
> 时间：2013-01-31T21:51:32.990
> 
> 标签：java, interface, overriding, final

我想使用`java.util.Set`（和其他集合）但有一个转折：我希望`contains()`,`add()`等始终调用 Object's `equals()`（更普遍地基于身份而不是平等进行操作）。我想我有办法，但它有很大的缺点。有没有合适的方法来做到这一点？抱歉，如果我遗漏了一些明显的东西。

这是我所做的：

```
public class OnlySelfEqual {
    public final boolean equals(Object o){
        return super.equals(o);
    }
}

public class Example{
    private Set<T extends OnlySelfEqual> set;
    //etc
} 
```

我看到的主要问题（可能还有很多其他问题）是所有 T 都必须从一个类扩展而不是实现一个接口，这是非常严格的。我想我想要的是一个“反向”接口，它列出了子类型无法实现（覆盖）的方法。我很确定那不存在。有什么建议么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T21:55:11.820

`java.util.IdentityHashMap`是一种通过使用而不是`Map`故意违反合同的实现，因此您可以使用例如获得具有相同行为的 a`Map``==``equals()``Set`

```
Set<String> set = Collections.newSetFromMap(new IdentityHashMap<String, Boolean>()); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:09:36.287

您可以将对象包装在一个容器中，该容器将`equals()`使用包装对象的身份来实现：

```
public class Wrapper<T> {
    // Either public (it's final), or private with a getter
    public final T element;

    public Wrapper(T element) {
        this.element = element;
    }

    public boolean equals(Object o) {
        if (o == this) {
            return true;
        } else if (o == null || o.getClass() != getClass()) {
            return false;
        }
        return element == ((Wrapper<?>) o).element;
    }

    public int hashCode() {
        return System.identityHashCode(element);
    }
} 
```

然后，您使用`Set<Wrapper<T>>`,`List<Wrapper<T>>`等。

如果你使用[Guava](https://code.google.com/p/guava-libraries/)（它包含很多有用的东西来补充 JDK），你可以直接使用它的[`Equivalence`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/index.html?com/google/common/base/Equivalence.html)类 (and [`Equivalence.Wrapper`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/index.html?com/google/common/base/Equivalence.Wrapper.html)) 来获得[该结果](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Equivalence.html#identity%28%29)，或者基于[不同](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Equivalence.html#equals%28%29) [策略](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Equivalence.html#onResultOf%28com.google.common.base.Function%29)的其他类。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-31T21:55:22.607

如果我没记错的话，您正在寻找的是：

```
T t = ...
((Object)t).equals( other ); 
```

我可能会误认为语法..

# django - Django CSRF验证在post方法上失败

> ID：14635811
> 
> 赞同：1
> 
> 时间：2013-01-31T21:51:35.953
> 
> 标签：django, django-forms, django-templates, django-views

看不懂这个。。。

令牌在模板中，“django.middleware.csrf.CsrfViewMiddleware”在 MIDDLEWARE_CLASSES 中定义

视图.py：

```
from django.shortcuts import render_to_response
from ezmapping.models import *
from django.forms.models import modelformset_factory

def setMapOptions(request):
    ezMapFormSet = modelformset_factory(ezMap, fields=('map_name', 'zoom_level', 'center_lat', 'center_long', 'map_width', 'map_height'))
    if request.method == 'POST':
        formset = ezMapFormSet(request.POST, request.FILES)
    if formset.is_valid():
        formset.save()

    else:
        formset = ezMapFormSet(queryset=ezMap.objects.filter(map_name ='first test'))
    return render_to_response("ezmapping/manage_mapOptions.html", {'formset': formset,}) 
```

模板：

```
<html>
<head>
    <title>Manage Map Options</title>
</head>
<body>
    <h1>Define map options</h1>
    <form method="post" action="">{% csrf_token %}
        {{ formset.management_form }}
        {% for form in formset %}
            {{ form.as_p }} 
        {% endfor %}
        <input type="submit" value="Submit" />
    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:58:19.873

您需要使用`RequestContext`CSRF 标签。

[https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext](https://docs.djangoproject.com/en/dev/ref/templates/api/#subclassing-context-requestcontext)

```
context = RequestContext(request, {
        'foo': 'bar',
    })

# or

render_to_response('foo.html', {}, context_instance=RequestContext(request)) 
```

`RequestContext`获取请求对象并自动加载各种变量，包括 CSRF。

# javascript - Jquery .live 事件未触发

> ID：14635812
> 
> 赞同：2
> 
> 时间：2013-01-31T21:51:39.447
> 
> 标签：javascript, jquery, jquery-mobile

我有一个关于`.live`触摸事件的简单问题。我想要做的是当用户点击/触摸页面主体（容器）时，该`refreshCanvas`函数被调用。但是，这似乎对我不起作用。

**JavaScript：**

```
<script type="text/javascript">
  function refreshCanvas () {
    var code = document.getElementById('iframe');
    code.src = code.src; // that is the essence here
  }
  setInterval(refreshIframe1, 20000);
  function refreshIframe1() {
    $("#iframe")[0].src = $("#iframe")[0].src;
  }
  $('#container').live("tap", function() {
    refreshCanvas();
  });
</script> 
```

**HTML：**

```
 <a href="javascript:refreshCanvas()"><img src="data/refresh.jpg"></a>
  <div id="container">  
    <iframe id="iframe" src="data/canvas.html"  z-index: 0; style="border: 0; position:absolute; top:0; left:0; right:0; bottom:0; width:100%; height:100%"></iframe> 
  </div> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T21:54:01.893

如果您使用的是最新版本的 jQuery (1.9)，[他们已经`.live()`完全删除了绑定事件的方法，](http://jquery.com/upgrade-guide/1.9/#live-removed)并建议您使用/学习该[`.on()`](http://api.jquery.com/on/)方法。

```
$('.something').live('event', function(){...}); 
```

相当于

```
$(document).on('event', '.something', function(){...}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:05:02.607

[`.live`](http://api.jquery.com/live/)自 v1.7 起已在 jQuery 中弃用，并已在 v1.9 中删除。

您应该将其替换为[`.on()`](http://api.jquery.com/on/).

`.on`有 2 种用于绑定元素的语法，而`.live`只有 1 种。

如果元素在您绑定时存在，您可以这样做：

`$('.element').on('click', function(){ });`

您甚至可以使用速记：

`$('.element').click(function(){ });`

如果该元素当时不存在，或者将添加新元素（这是`.live`通常使用的），则需要使用“事件委托”：

`$(document).on('click', '.element', function(){ });`

注意：您希望绑定到最近的静态元素，而不是总是`document`. 同时，可以使用[**jQuery Migrate 插件**](http://jquery.com/upgrade-guide/1.9/#jquery-migrate-plugin)`.live()`来恢复功能。

# sql - 条件 SQL where 子句

> ID：14635823
> 
> 赞同：4
> 
> 时间：2013-01-31T21:52:10.210
> 
> 标签：sql, sql-server

我将徽标存储在 varbinary(max) 字段中。我正在寻找一条 SQL 语句，它说，

`select logo where customerid=5`

但如果特定客户 ID 的徽标为 NULL，那么，

`select logo where customerid=18`

这是默认徽标。如果可能，我想在单个查询中执行此操作。这可以做到吗？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T21:58:36.083

```
SELECT COALESCE(b.logo, dflt.logo) AS logo 
FROM mytable dflt
LEFT OUTER JOIN mytable b ON b.customerid=5
WHERE dflt.customerid=18 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T21:57:14.097

```
SELECT TOP 1 logo
FROM [Table]
WHERE logo is not null and customerid IN (@CustomerID, 18)
ORDER BY CASE WHEN customerid= 18 THEN 1 ELSE 0 END 
```

请注意我是如何处理订单的。我怀疑您可能有一些 ID 为 <18 的客户和一些 ID 为 >18 的客户，因此您需要在这里小心。

# c# - 使 Wpf 更流畅

> ID：14635824
> 
> 赞同：0
> 
> 时间：2013-01-31T21:52:19.997
> 
> 标签：c#, wpf, multithreading, asynchronous, async-await

我从文本文件加载大量数据并将其显示在 Datatgrid 中，问题是窗口很慢而且不流畅，我怎样才能更好地实现下面的代码？

**按钮代码：**

```
 private async void MILoadLogFile_Click(object sender, RoutedEventArgs e) {
        // Configure open file dialog box
        OpenFileDialog oFD = new OpenFileDialog();

        // Did they click on the OK button?
        if (oFD.ShowDialog() == true) {
           await myLogSession.LoadfromFileAsync(oFD.FileName);
        }
    } 
```

**locad 方法：（抱歉代码太长）**

```
 public async Task LoadfromFileAsync(String fileName) {

        compassLogCollection.Clear();

        StreamReader streamReader = new StreamReader(fileName);
        if (fileName.Contains("Compass")) {
            String temp = "";
            String line;

            DateTime dateTime = new DateTime();
            LoggingLvl loggingLvl = new LoggingLvl();
            LoggingLvl.ELoggingLvl eLoggingLvl = new LoggingLvl.ELoggingLvl();
            char[] delimiters = new[] {' '};
            string threadId = "";
            string loggingMessage;
            string dateAndTimestamp = "";
            int ff = 0;

            try {
                using (streamReader) {
                    while ((line = await streamReader.ReadLineAsync()) != null) {
                        //while ((line = streamReader.ReadLine()) != null) {
                        string[] parts = line.Split(delimiters, StringSplitOptions.RemoveEmptyEntries);

                        foreach (string t in parts) {
                            switch (ff) {
                                case 0:
                                    dateAndTimestamp = t;
                                    break;
                                case 1:
                                    dateAndTimestamp += " " + t.Replace(",", ".");
                                    dateTime = DateTime.Parse(dateAndTimestamp);
                                    dateAndTimestamp = "";
                                    break;
                                case 2:
                                    eLoggingLvl = loggingLvl.ParseLoggingLvl(t);
                                    break;
                                case 3:
                                    threadId = t;
                                    break;

                                default:
                                    temp += t;
                                    break;
                            }

                            ff++;
                        }
                        loggingMessage = temp;

                        temp = "";
                        ff = 0;

                        loggingLvl = new LoggingLvl(eLoggingLvl);
                        CompassLogData cLD = new CompassLogData(dateTime, loggingLvl, threadId, loggingMessage);
                        compassLogCollection.Add(cLD);
                    }
                    Console.Out.WriteLine("DOOOOOOOOOOOOONE");
                }
            } catch (Exception e) {
                Console.WriteLine("The file could not be read:");
                Console.WriteLine(e.Message);
            }
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T21:58:24.323

我在您的代码中没有看到 UI 更新的任何地方，所以我假设导致缓慢的原因是从磁盘读取数据。您可以尝试将线程从磁盘读取数据的优先级设置为低于 Normal 的值，以便 UI 线程有更好的 CPU 周期机会。请参阅[线程优先级属性](http://msdn.microsoft.com/en-us/library/system.threading.threadpriority.aspx)。

此外，如果文件中行的长度不大，并且鉴于读取文件的代码已经在后台线程中运行，我将只使用`ReadLine`而不是使用`ReadLineAsync`并将工作传递给另一个线程。

# c - 使用 read() 获取用户输入而不是 scanf

> ID：14635827
> 
> 赞同：0
> 
> 时间：2013-01-31T21:52:27.970
> 
> 标签：c, linux, io, low-level-code

我试图使用 read() 函数来获取用户输入，但我在文档中唯一能找到的是关于从文件中读取，这是在 Linux c 语言中。我还想使用 write() 向控制台显示一些内容。

有谁知道这是怎么做到的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T21:59:12.377

> 但我在文档中唯一能找到的是关于从文件中读取

别担心，标准输入是一个文件。

```
char buf[128];
read(STDIN_FILENO, buf, sizeof(buf)); 
```

> 我还想使用 write() 向控制台显示一些内容。

让我不要重复自己。

```
const char *s = "Hello World!\n";
write(STDOUT_FILENO, s, strlen(s)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:00:09.597

这应该给你一个印象如何做到这一点（0是标准输入，1是标准输出）

```
#include <unistd.h>
#include <string.h>
int main () {
  char buf[100];
  char *msg="you wrote:";
  while (1) {
    int n;
    n=read (0, buf, sizeof(buf));
    write (1, msg, strlen(msg));
    write (1, buf, n);
  }
} 
```

# javascript - 如何在列表中点击进入 Sencha 的详细视图？

> ID：14635831
> 
> 赞同：1
> 
> 时间：2013-01-31T21:52:48.377
> 
> 标签：javascript, extjs, sencha-touch, sencha-touch-2

Sencha 的新手，但我设法创建了一个包含项目的列表。单击列表项时，我想显示包含信息的详细视图。我该怎么做呢？我添加了一个监听器并尝试了一些东西，但似乎没有任何效果。

**我的列表**

```
Ext.define("GS.view.LoggedInView", {
    extend: "Ext.Container",
    config: {
        id: 'acution-list',
        layout: 'vbox',
        fullscreen: true,
        items: [{
            xtype: "toolbar",
            docked: "top",
            title: "Pågående anbud"
        },{ 
            xtype: 'list',
            itemTpl: '<div class="contact"><h1>{name} <tpl if="active != null"><span class="active">{active}</span></tpl><tpl if="inactive != null"><span class="inactive">{inactive}</span></tpl></h1><span class="rating">{rating}</span> &middot; <span class="rating">{amount}</span> </div>',
            grouped: true,
            flex: 1,
            store : 'Auction',
            listeners:{
                itemtap: function(){               
                     //go to the Auction Detial view
                }
            }
        }]
    }
}); 
```

**我的详细视图**

```
Ext.define('GS.view.AuctionDetail', {
    extend: 'Ext.Panel',
    alias: 'widget.auctiondetail',

    config: {
        styleHtmlContent: true,
        scrollable: 'vertical',
        title: 'Details',
        html: 'Hello!'

    }
}); 
```

感谢所有帮助！

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T12:59:25.127

行！我设法通过稍微编辑我的代码来解决它。见下文

**我的列表**

```
Ext.define("GS.view.LoggedInView", {
    extend: "Ext.navigation.View",
    xtype: 'mainAuctionList',
    config: {
        layout: {
            type: 'card',
            animation: {
                type: 'pop'
            }
        },
        fullscreen: true,

        items: [{ 
            title: "Pågående anbud",
            xtype: 'list',
            itemTpl: '<div class="contact"><h1>{name} <tpl if="active != null"><span class="active">{active}</span></tpl><tpl if="inactive != null"><span class="inactive">{inactive}</span></tpl></h1><span class="details">{date}</span> &middot; <span class="details">{rating}</span> &middot; <span class="details">{amount}</span> <i class="arrow"></i></div>',
            grouped: false,
            id: 'auctionlist',
            flex: 1,
            store : 'Auction',
            listeners:{
                itemtap: function (view, index) {
                    var record = this.store.getAt(index)
                    Ext.dispatch({
                        controller: GS.controllers.AuctionController,
                        action: 'showDetail',
                        data: record.data,
                        type: 'slide'
                    });
                },
            }           
        }]
    }
}); 
```

**我的详细视图**

```
Ext.define('GS.view.AuctionDetail', {
    extend: 'Ext.Panel',
    xtype: 'autionDetails',
    alias: 'widget.auctiondetail',

    config: {
        styleHtmlContent: true,
        scroll: 'vertical',
        title: 'Date',
        layout: 'card',
        tpl: '<div id="company-info">'+
                    '<div class="content heading">'+     
                        '{name}'+
                        '<p class="details">{orgnr}</p>'+
                    '</div>'+

                    '<div class="content">'+
                        '<table><tbody><tr><td>{rating}</td><td>{turnover}</td><td>{amount}</td></tr></tbody><tfoot><tr><td><p class="details">Rating</p></td><td><p class="details">Omsättning</p></td><td><p class="details">Uppskattat belopp</p></td></tr></tfoot></table>'+
                    '</div>'+
                 '</div>'

    }
}); 
```

奇迹般有效！

# c - 有没有办法在 C90 标准中使枚举无符号？（符合 MISRA-C 2004 标准）

> ID：14635833
> 
> 赞同：7
> 
> 时间：2013-01-31T21:52:55.393
> 
> 标签：c, enums, standards, misra

我正在尝试找到一种使枚举“未签名”的方法。

```
enum{
     x1 = 0,
     x2,
     x3
};
uint8_t = x2; /* <--- PC-LINT MISRA-C 2004 will complain about mixing signed and unsigned here */ 
```

当然，我可以添加一个类型转换来消除错误，这既费时又容易出错。

```
uint8_t = (uint8_t)x2; /* This works, but is a lot of extra work over the course of 1000s of lines of code*/ 
```

那么，有没有办法让 MISRA-C 2004 喜欢的特定枚举未签名？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-31T21:55:05.077

没有标准的 C 方法来控制为`enum`. 有时您可以通过特定于实现的方式来执行此操作，例如通过向枚举中添加一个值来强制类型为无符号：

```
enum {
  x1,
  x2,
  x3,
  giant_one_for_forcing_unsigned = 0x80000000;
}; 
```

但这甚至也不是标准的 C 语言（因为提供的值不适合 an `int`）。不幸的是，你很不走运。这是标准中的相关位：

> **6.7.2.2 枚举说明符**，第 4 段
> 
> 每个枚举类型应与**`char`**有符号整数类型或无符号整数类型兼容。类型的选择是实现定义的，但应该能够表示枚举的所有成员的值。枚举类型在**`}`**终止枚举器声明列表之后立即是不完整的，并在其后完成。

您最好使用`#define`而不是`enum`制作常量：

```
#define x1 0U
#define x2 1U
#define x3 2U

uint8_t x = x2; 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-01T10:31:27.857

这里有几个问题，其中有轻微的转换错误的可能性，MISRA 试图让你避免：

*   枚举常量，即`x1`您的示例中的等，保证为`int`(1) 类型。但是 enum*变量*和变量类型 enum 不保证是同一类型（2），如果你不走运，它被定义为一个小整数类型，从而受到整数提升规则的约束。

*   MISRA 禁止将大整数类型隐式转换为较小的整数类型，主要是为了避免无意截断值，同时也是为了避免各种隐式提升规则。

您的特定 MISRA 合规错误实际上来自上述后一个问题，即违反规则 10.3 (3)。

您可以通过向“基础类型”（预期类型）添加显式强制转换来解决此问题，在本例中为 uint8_t。或者你可以通过根本不使用枚举来解决它，用#defines替换它们。这听起来可能非常激进，但请记住，C 没有任何类型安全性，因此除了可读性之外，使用枚举没有明显的好处。

以这种方式替换枚举有点常见：

```
#define FALSE 0
#define TRUE  1
typedef uint8_t BOOL; 
```

（虽然这个例子的目的主要是使 BOOL 类型可移植，保证是 8 位而不是 16 位，如果它是一个枚举则可能发生这种情况。）

* * *

参考：

(1) C11 6.2.7.7/2：

> “定义枚举常量值的表达式应为整数常量表达式，其值可表示为 int。”

(2) C11 6.2.7.7/4：

> “每个枚举类型应与 char、有符号整数类型或无符号整数类型兼容。类型的选择是实现定义的，但应能够表示枚举所有成员的值。”

(3) MISRA-c:2004 规则 10.3：

> “整数类型的复杂表达式的值只能转换为更窄且与表达式的基础类型具有相同符号的类型。”

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-31T22:02:41.087

不仅在 C90 中没有办法指定`enum`采用无符号类型，而且在 C90 中：

> 声明为枚举常量的标识符具有 int 类型

这也适用于 C99 (6.4.4.3)。如果你想要一个无符号类型，你正在寻找一个语言扩展。

*枚举类型*可能不是，`int`但常量本身必须有`int`类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-03-29T10:00:42.547

您可以通过包含一个足够大以使其无法放入 int 的值（根据规范）来强制它无符号。这对于 >= sizeof int 类型非常简单，但 unsigned char/short 更复杂，需要编译器特定的打包。当然，从技术上讲，实现仍然可以将 UINT_MAX 表示为 unsigned long long ......虽然我从未见过。

```
#include <stdio.h> //only included for printf example
#include <limits.h>
#include <stdint.h>

/** set up some helper macros **/
#ifdef _MSC_VER 
    #define PACK( ... ) __pragma( pack(push, 1) ) __VA_ARGS__ __pragma( pack(pop) )
#else /* for gcc, clang, icc and others */
    #define PACK( ... ) __VA_ARGS__ __attribute__((__packed__))
#endif
#define _PASTE(x,y) x ## y
#define PASTE(x,y) _PASTE(x,y)

/* __LINE__ added for semi-unique names */
#define U_ENUM(n, ... ) \
    enum n { __VA_ARGS__ , PASTE( U_DUMMY , __LINE__ ) = UINT_MAX }
#define UL_ENUM(n, ... ) \
    enum n { __VA_ARGS__ , PASTE( UL_DUMMY , __LINE__ ) = ULONG_MAX }
#define SZ_ENUM(n, ... ) /* useful for array indices */ \
    enum n { __VA_ARGS__ , PASTE( SZ_DUMMY , __LINE__ ) = SIZE_MAX }
#define ULL_ENUM(n, ... ) \
    enum n { __VA_ARGS__ , PASTE( ULL_DUMMY , __LINE__ ) = ULLONG_MAX }
#define UC_ENUM(n,...) \
    PACK(enum n { __VA_ARGS__ , PASTE( UC_DUMMY , __LINE__ ) = UCHAR_MAX })
#define US_ENUM(n,...) \
    PACK(enum n { __VA_ARGS__ , PASTE( US_DUMMY , __LINE__ ) = USHRT_MAX }) 
```

这是检查它是否按预期工作：

```
typedef UC_ENUM(,a) A_t;
typedef US_ENUM(,b) B_t;
typedef U_ENUM(,c) C_t;
typedef UL_ENUM(,d) D_t;
typedef ULL_ENUM(,e) E_t;
typedef SZ_ENUM(,e) F_t;
int main(void) {
  printf("UC %d,\nUS %d,\nU %d,\nUL %d,\nULL %d,\nSZ %d,\n",sizeof(A_t),
    sizeof(B_t),sizeof(C_t),sizeof(D_t),sizeof(E_t),sizeof(F_t));
  return 0;
} 
```

为了更像一个标准的枚举语句，这与我使用的更简单的版本略有不同，它为最后一个枚举使用一个额外的命名参数而不是`__LINE__`hack（这对于在错误时返回 -1 的函数也很有用，因为它会转换为 U*_MAX) 这是该版本的外观：

```
#define U_ENUM( n, err, ...)      enum n { __VA_ARGS__ , err = UINT_MAX  }
#define UL_ENUM(n, err, ...)      enum n { __VA_ARGS__ , err = ULONG_MAX }
#define ULL_ENUM(n,err, ...)      enum n { __VA_ARGS__ , err = ULLONG_MAX}
#define SZ_ENUM(n, err, ...)      enum n { __VA_ARGS__ , err = SIZE_MAX  }
#define UC_ENUM(n, err, ...) PACK(enum n { __VA_ARGS__ , err = UCHAR_MAX })
#define US_ENUM(n, err, ...) PACK(enum n { __VA_ARGS__ , err = USHRT_MAX }) 
```

除了将枚举打包为 char 或紧凑的缩写之外，size_t 枚举是最有趣的，因为它们可以用作数组索引而无需额外的 MOV 指令。

```
typedef SZ_ENUM(message_t,MSG_LAST,MSG_HELLO,MSG_GOODBYE,MSG_BAD) message_t;
static const char *messages[]={"hello","goodbye","bad message"};
void printmsg(message_t msg){
  if (msg > MSG_BAD) msg = MSG_BAD;
  (void) puts(messages[msg]);
} 
```

请注意，如果您使用 C++11 与 C，您可以`enum Foo : char { A, B, C};`或`enum class Bar : size_t { X, Y, Z};`

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-04-13T16:30:03.837

除了[@Carl's answer](https://stackoverflow.com/a/14635860/2410359)之外，为了获得`enum`声明的一些好处并产生一些无符号类型，代码可以使用下面的代码。

```
// Form values 0, 5, 6
enum { 
 x1, 
 x2 = 5, 
 x3
};

// Form values 0u, 5u, 6u
#define ux1 (1u * x1)
#define ux2 (1u * x2)
#define ux3 (1u * x3) 
```

这可能对超出范围的枚举常量没有帮助`int`。

当然，正如 OP 所知，代码可以进行转换。

```
// uint8_t = x2;
uint8_t = x2 * 1u; 
```

# jquery - 为 jQuery .toggle() 方法添加 HTML5 隐藏属性支持

> ID：14635847
> 
> 赞同：3
> 
> 时间：2013-01-31T21:54:11.150
> 
> 标签：jquery, html, accessibility

我想将[HTML5`hidden`](http://www.w3.org/html/wg/drafts/html/master/editing.html#the-hidden-attribute)支持与 jQuery 的 .toggle() 方法配对。

所以给定`<p id="myElement">Hi there</p>`

`$('#myElement').toggle()`将隐藏元素，并设置`hidden="hidden"`：

`<p id="myElement" style="display: none;" hidden="hidden">Hi there</p>`

并再次执行相同的`$('#myElement').toggle()`脚本将显示（切换）元素，并删除`hidden="hidden"`属性（它是一个布尔值）：

`<p id="myElement" style="display: inline">Hi there</p>`

我可能想使用该[方法](http://api.jquery.com/toggle/)的完整功能，也许类似于

```
$('#myElement').toggle(
    if ($this.css('display')==='none'){
       $this.prop('hidden', 'hidden');
    }
    else
    {
       $this.removeProp('hidden');
    }
) 
```

**`.toggle()`扩展HTML5`hidden`属性的最高效解决方案是什么？这样做是多余的吗？**

这个问题是[为 jQuery .toggle() 方法添加 WAI-ARIA 支持](https://stackoverflow.com/questions/14596769/adding-wai-aria-support-to-jquery-toggle-method)的变体；已确定在切换`aria-hidden`状态的同时切换元素的显示是多余的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:04:31.873

可以使用方法的`hidden`完整功能来切换属性`.toggle()`：

```
$('#myElement').toggle(function() {
    if ($(this).css('display')==='none'){
       $(this).prop('hidden', 'hidden');
    }
    else
    {
       $(this).removeProp('hidden');
    }
}) 
```

有关工作示例，请参见[http://jsfiddle.net/jhfrench/g8Sqy/](http://jsfiddle.net/jhfrench/g8Sqy/)

笔记：

*   使用`$(this)`，而不是`$this`
*   需要声明一个函数 ( `.toggle(function() {...})`, not `.toggle(...`)
*   使用回调来切换`hidden`真的[比](http://jsperf.com/hidden-premium/4)普通[的*慢*](http://jsperf.com/hidden-premium/4)`.toggle()`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-05T04:14:34.287

对此的一些评论可能有用也可能没有用 - 将其作为答案，因为它太长而无法放入评论:-) -

虽然背后的想法`hidden`是它有可能提供更好的可访问性`display:none`（它不需要可访问性工具来了解 CSS），但目前我所知道的没有具体或可测试的好处 - 鉴于屏幕阅读器支持 CSS 方法反正。

（......或者更确切地说，屏幕阅读器使用的浏览器已经解析了 CSS 并通过平台的辅助功能 API 将隐藏信息传递给屏幕阅读器。可能受益的主要工具`hidden`将是其他直接与他们自己一起工作的辅助工具DOM 的副本，而不是与“主机”浏览器通信。）

（此外，虽然在一个完美的世界中，CSS 将纯粹是展示性的，但它通常不是。使用`display:none`是一种不相关的情况 - 它通常用于指示内容当前不相关，这是*语义*信息；并且`hidden`确实解决了这种情况；但还有其他情况也必须解决：生成的内容可能是主要的其他情况。）

在我可以*验证它们的行为和按计划工作*之前，我有点犹豫是否采用新功能：新功能以一种方式指定的情况并不少见，但最终以一种微妙不同的方式实现，这对如何功能实际上可以使用。（使用 ARIA 角色 =“应用程序” 是一个很好的例子，该功能有[很多警告](http://www.marcozehe.de/2012/02/06/if-you-use-the-wai-aria-role-application-please-do-so-wisely/)。）归根结底，它不遵守使页面可访问或不可访问的规范，因为它是如何内容、浏览器和屏幕阅读器（或其他可访问性工具）的整体组合对最终用户很重要。

另一个需要注意的问题：[HTML5 规范提到了`hidden`属性](http://www.w3.org/html/wg/drafts/html/master/editing.html#the-hidden-attribute)：

> [...] 例如，使用 hidden 隐藏选项卡式对话框中的面板是不正确的，因为选项卡式界面只是一种溢出呈现 [...]

但是，选项卡式对话框是 jQuery 的`toggle`// `show`/ `hide`etc 方法的常见用例；所以`hidden`在所有这些情况下应用可能[技术上]违反规范。似乎同样的推理也适用于页面菜单栏及其弹出菜单。

# capistrano - 用于创建数据库的 Capistrano 命令

> ID：14635848
> 
> 赞同：12
> 
> 时间：2013-01-31T21:54:19.273
> 
> 标签：capistrano

我正在尝试使用 capistrano 命令来创建数据库。我只找到了一个类似的命令`deploy:migrate`。有命令`db:create`吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-01T11:44:41.483

[Capistrano](http://capitate.rubyforge.org/recipes/deploy.html)不提供任何用于创建数据库的方法。正如这个[capistrano googlegroups 线程](https://groups.google.com/forum/?fromgroups=#!topic/capistrano/a9ukNw8VAAM)中提到的：

> 它不是通用到足以保证包含在核心中的东西，它确实属于我们试图避免的“管理”领域

其他人通过直接从脚本调用数据库创建命令，成功地通过 capistrano 自动创建数据库。

上面提到的同一个线程提供了[一个 capistrano 脚本的链接，该脚本](https://gist.github.com/527117)`mysql`通过从 capistrano 运行命令来创建一个 mysql 数据库。

这是另一篇有用的博文：[使用 Capistrano 创建 MySQL 数据库](http://www.grahambrooks.com/development/software%20development/2011/01/24/create-mysql-database-with-capistrano.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2016-07-01T07:30:59.283

正如上面@prakash 所提到的，capistrano 并没有真正提供任何用于执行 rake 任务以创建数据库的方法。然而，有一个 capistrano 附加在 gem 上，使这个过程无缝无痛。

在您的 gemfile 上，添加

```
 gem 'capistrano-rails-collection' 
```

之后进行捆绑安装，然后像这样在您的 capfile 中要求它

```
 require 'capistrano/rails/collection' 
```

现在您可以像这样运行 rake 任务来创建数据库

```
 cap production rails:rake:db:reset
   cap production rails:rake:db:seed 
```

# javascript - 这个简短的 Javascript 代码有什么问题？

> ID：14635850
> 
> 赞同：0
> 
> 时间：2013-01-31T21:54:26.223
> 
> 标签：javascript, dom-events, javascript-framework

我试图让简短的 Javascript 代码发出警报并显示 93 而不是 0-93 但它不起作用？

```
<html>
    <head>
    <script type="text/javascript">
    function numberFromInput(value) {
  return  alert(Number(value.match(/[-]?(\d*)$/).pop()));
}
</script>
</head>
<body>

numberFromInput(0-93);

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T21:57:05.533

您必须调用该函数（您只是将其调用代码显示为内容）。而且您必须将值作为字符串传递（您需要引号`0-93`）：

```
<script type="text/javascript">
function numberFromInput(value) {
    return alert(Number(value.match(/[-]?(\d*)$/).pop()));
}
numberFromInput("0-93");
</script> 
```

# c# - Mvc ActionResult redirect using Json on success

> ID：14635853
> 
> 赞同：0
> 
> 时间：2013-01-31T21:54:46.407
> 
> 标签：c#, asp.net-mvc, model-view-controller

I'm attempting to redirect users after successfully completing a form.

Controller:

```
public ActionResult Create(Acquisition acquisitions)
{
    return Json(new
    {
        redirectUrl = Url.Action("Index", "Acquisitions"),
        isRedirect = true
    });
} 
```

After adding the return Json to my controller I'm getting this error message:

> Error 6 The type 'System.Web.Routing.RouteValueDictionary' is defined in an assembly that is not referenced. You must add a reference to assembly 'System.Web, Version=4.0.0.0, Culture=neutral...

JavaScript:

```
$.ajax({
    type: "POST",
    url: "/Acquisitions/Create",
    data: $("form").serialize(),
    success: function (data) {
        if (data.isRedirect) {
            window.location.href = data.redirectUrl;
        }
    },
    error: function () {
        alert("error");
    }
}); 
```

# php - PHP not accepting single quotes?

> ID：14635855
> 
> 赞同：0
> 
> 时间：2013-01-31T21:54:50.993
> 
> 标签：php

All of a sudden, code that has worked for weeks will throw a syntax error on single quotes.

For example

```
$dueshtml .= '>'. $value .'</option>' . "\n"; 
```

now throws a parse error, and it executed perfectly before. Changing the single quotes to double quotes and escaping any double quotes in literal text allows the line to pass, but I have no burning desire to go though 675 lines of code to convert all of them.

The single quote is indeed ascii 39.

Any suggestions as to why?

# qt - 如何在 Qt 中触发信号

> ID：14635856
> 
> 赞同：4
> 
> 时间：2013-01-31T21:54:53.553
> 
> 标签：qt, triggers, signals

我有一个简单的 GUI 窗口：带有 QPushButton 的 QLineEdit。我想在单击按钮并验证输入时触发一个信号（它满足条件语句，不要介意细节）。

通常我会使用`connect (object, signal, subject, slot)`. 我猜 QPushButton 单击应该触发在小部件插槽内处理的中间信号。小部件插槽可能会触发另一个信号 - 到我的目的地点。但是怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-31T21:59:30.603

你必须在课堂上声明你的信号：

```
class myClass
{
    /* stuff */
public signals: 
    void mySignal();
} 
```

并在验证后的代码中：

```
void myClass::dataValidation()
{
    /*validate data*/
    emit mySignal();
} 
```

# database - Database and design assistance for large number of simple records

> ID：14635857
> 
> 赞同：1
> 
> 时间：2013-01-31T21:54:53.347
> 
> 标签：database, postgresql, database-design

I'm hoping to get some help choosing a database and layout well suited to a web application I have to write (outlined below), I'm a bit stumped given the large number of records and fact that they need to be able to be queried in any manner.

The web app will basically allow querying of a large number of records using any combination of criteria that make up the records, date is the only mandatory item. A record consists of only eight items (below), but there will be about three million new records a day, with very few duplicate records. Data will be constantly inserted into the database real time for the current day.

I know the biggest interest will be in the last 6 months -> 1 years worth of data, but the rest will still need to be available for the same type of queries.

I'm not sure what database is best suited for this, nor how to structure it. The database will be on a reasonably powerful server. I basically want to start with a good db design, and see how the queries perform. I can then judge if I'd rather do optimizations or throw more powerful hardware at it. I just don't want to have to redo the base db design, and it's fine initially if we're doing a lot of optimizations we have time but not $$$.

We need to use something open source, not something like oracle. Right now I'm leaning towards postgres.

A record consists of:

1 Date
2 unsigned integer
3 unsigned integer
4 unsigned integer
5 unsigned integer
6 unsigned integer
7 Text 16 chars
8 Text 255 chars

I'm planning on creating yearly schemas, monthly tables, and indexing the record tables on date for sure.

I'll probably be able to add another index or two after I analyze usage patterns to see what the most popular queries are. I can do lots of tricks on the app site as far as caching popular queries and what not, it's really the db side I need assistance with. Field 8 will have some duplicate values so I'm planning on having that column be an id into a lookup table to join on. Beyond that I guess the remaining fields will all be in one monthly table...

I could break it into weekly tables i suppose as well and use a view for queries so the app doesn't have to deal with trying to assemble a complex query....

anyway, thanks very much for any feedback or assistance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:29:48.280

一些简短的建议...

1.  每天 300 万条记录已经很多了！（至少我是这么认为的，其他人可能甚至不会眨眼。）我会尝试编写一个工具来插入虚拟记录，看看 Postgres 之类的东西如何处理一个月的数据。

2.  最好研究一下 NoSQL 解决方案，它为您提供开源 + 可扩展性。从 Couchbase 和 Mongo 开始。如果您要在线保存一个月的数据以进行实时查询，我不确定 Postgres 将如何处理 9000 万条记录。也许很棒，但也许不是。

3.  考虑在您决定的任何系统中使用“离线”数据库。你将实时数据保存在最好的机器上，它已经准备好了，但是你将旧数据移到另一个更便宜的服务器上（阅读：更慢）。通过这种方式，您始终可以回答查询，但有些查询比其他查询要快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:50:21.907

以我的经验，主要使用具有类似记录插入频率（数十亿行表）的 Oracle，您可以通过仔细分区数据（可能按日期，在您的情况下）和索引表来实现良好的 Web 应用程序查询性能。你如何准确地处理你的数据库架构将取决于很多因素，但是网络上有很多很好的资源可以帮助你获得这些东西。

听起来你的数据库比较扁平，所以也许另一个数据库解决方案会更好，但 Oracle 一直对我很好。

# c# - 在 WPF 应用程序中使用手写笔或手指按下 TouchScreen 上的按钮时发生异常

> ID：14635862
> 
> 赞同：4
> 
> 时间：2013-01-31T21:55:08.987
> 
> 标签：c#, wpf, stylus-pen

我有一个带有初始窗口的 WPF 应用程序，该窗口在启动时显示为 Splashscreen。在启动期间有一个后台线程，我们可以通过单击启动画面中的按钮来取消该线程。使用鼠标并单击按钮取消时，这一切都很好。但是，如果我使用触摸屏单击此按钮，则应用程序偶尔会崩溃，以下是堆栈跟踪。该应用程序是在 Windows 7 64 位上运行的 64 位目标。

```
Severity:
Fatal

Stack Trace:
Exception 0
Message: Object reference not set to an instance of an object.

StackTrace:

at MS.Internal.PointUtil.TryClientToRoot(Point point, PresentationSource presentationSource, Boolean throwOnError, Boolean& success)
at System.Windows.Input.StylusDevice.GetPosition(IInputElement relativeTo)
at System.Windows.Input.StylusDevice.ChangeStylusOver(IInputElement stylusOver)
at System.Windows.Input.StylusLogic.PreProcessInput(Object sender, PreProcessInputEventArgs e)
at System.Windows.Input.InputManager.ProcessStagingArea()
at System.Windows.Input.InputProviderSite.ReportInput(InputReport inputReport)
at System.Windows.Interop.HwndMouseInputProvider.ReportInput(IntPtr hwnd, InputMode mode, Int32 timestamp, RawMouseActions actions, Int32 x, Int32 y, Int32 wheel)
at System.Windows.Interop.HwndMouseInputProvider.PossiblyDeactivate(IntPtr hwndCapture, Boolean stillActiveIfOverSelf)
at System.Windows.Interop.HwndMouseInputProvider.Dispose()
at System.Windows.Interop.HwndMouseInputProvider.FilterMessage(IntPtr hwnd, WindowMessage msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
at System.Windows.Interop.HwndSource.InputFilterMessage(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)
at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)
at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Int32 numArgs)
at MS.Internal.Threading.ExceptionFilterHelper.TryCatchWhen(Object source, Delegate method, Object args, Int32 numArgs, Delegate catchHandler)
at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Int32 numArgs, Delegate catchHandler)
at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Int32 numArgs)
at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)

FromSubsystem:
PresentationCore
Help Link:
Not specified 
```

有没有人遇到过这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-08T12:50:43.800

您使用的是 Elo 触摸屏吗？我在带有 Elo 触摸屏的 StylusLogic OnDispatcherShutdown 中遇到了类似的崩溃。我已经解决了这个问题，禁用了 wpf 的 RealTimeStylus（[禁用了 WPF 应用程序的 RealTimeStylus](http://msdn.microsoft.com/en-us/library/vstudio/ee230087%28v=vs.100%29.aspx)）。在我看来，事件被处理了两次（在显示驱动程序和 wpf 触控笔中），但是在 wpf Stylus 处理程序上，窗口已经被破坏了。在调用关闭窗口之前还有一点延迟对我有用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-10T16:55:00.673

根据 Luz De Gan 的回答，我发现延迟关闭窗口效果最好，而无需禁用 RealTimeStylus。

在您的取消事件处理程序中，使用它来延迟窗口的关闭：

```
Dispatcher.InvokeAsync(this.Close, DispatcherPriority.Input); 
```

它需要是`DispatcherPriority.Input`为了确保在处理触摸输入事件之后发生关闭。

# actionscript-3 - AS3：组合来自不同类中多个对象的计数器（分数）变量

> ID：14635870
> 
> 赞同：1
> 
> 时间：2013-01-31T21:55:23.617
> 
> 标签：actionscript-3, oop, flashdevelop, class-variables

我正在 AS3 中开发一个相当基本的目标类太空射击类 Flash 游戏。游戏最初包含 1 个具有随机变量参数的敌方目标，例如速度和生命值，但组合得分计数器仍然是预定义的，一个。

从那以后，我将我的游戏扩展到我有几个敌方目标，每个目标都有自己的类，因此，它们有自己的可变参数值。我还冒昧地增加了综合分数，以反映每个敌方目标的难度。

我遇到的问题是，我用于组合分数计数器的原始代码行仍然设置为“score++;”，每次“if 语句”发生时它只会添加一个值 1。

我的问题是，我怎样才能让我的分数计数器根据为每个班级分配的值来增加分数？

以下是一些相关代码，并附有注释以帮助解释我的观点：

杀死敌方目标时的“If 语句”（位于我的 Level 课程中）：

```
// if the bullet is touching the ship
if (MyMaths.hitTest(sh, bullets[bcount])) {
sh.health--; // lose 1 heath point
score++;
removeChild(bullets[bcount]); // remove the bullet from the screen
bullets.splice(bcount, 1); // remove the bullet from the list
} 
```

Ship1（位于我的 Ship1 类中）分值

```
public function Ship1() {
score=1; // set point value
} 
```

Ship2（位于我的 Ship2 类中）分值

```
public function Ship1() {
score=2; // set point value
} 
```

Ship3（位于我的 Ship3 类中）分值

```
public function Ship1() {
score=3; // set point value
} 
```

我只是不确定是否需要创建一个新函数来组合分数值，并拥有我的“score++”；从中拉出来，我该怎么做呢？

我觉得这是许多面向目标的程序员认为相关的问题，因为将来自多个类的变量组合到单个计数器并不像看起来那么容易。此外，除了游戏开发之外，这还可以用于广泛的其他开发人员领域——在网络中创建多个计算机模型的数据库，并在使用新操作系统刷新工作站后计算“总完成”字段或所需的软件。

我真的很感激任何可以提供他们的专业知识、意见和/或鼓励的话的人。

非常感谢，亚历克斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:02:30.783

为什么不让**每**艘船与之通信的单例，而不是那样做。

每当您增加分数时：

```
ScoreManager.getInstance().incrementScore(ShipX.getScoreDelta()) 
```

每次收集后where`getScoreDelta()`将重置为 0。

然后当游戏结束时：

```
ScoreManager.getInstance().getCurrentScore(); 
```

# dll - 配置脚本不允许 make 生成共享库

> ID：14635871
> 
> 赞同：5
> 
> 时间：2013-01-31T21:55:27.573
> 
> 标签：dll, linker, shared-libraries, static-libraries, libjpeg

这与编译 libjpeg v6b（如果相关）有关。

我像安装文档所说的那样运行 ./configure --prefix=/c/tmp/jpeg-6b-build --enable-shared --enable-static 但 libtool 没有它。

```
checking dynamic linker characteristics... no
checking if libtool supports shared libraries... no
checking whether to build shared libraries... no
checking whether to build static libraries... yes 
```

我想我需要这个共享库来编译一些函数。libjpeg 本身编译得很好，它生成的 .exe 可以工作，但我需要将源代码用于其他用途。由于某种原因，v6b 不会生成 .DLL，而 v9 会生成。

./configure 命令的完整输出：

```
ild
checking for gcc... gcc
checking whether the C compiler (gcc  ) works... yes
checking whether the C compiler (gcc  ) is a cross-compiler... no
checking whether we are using GNU C... yes
checking how to run the C preprocessor... gcc -E
checking for function prototypes... yes
checking for stddef.h... yes
checking for stdlib.h... yes
checking for string.h... yes
checking for size_t... yes
checking for type unsigned char... yes
checking for type unsigned short... yes
checking for type void... yes
checking for working const... yes
checking for inline... __inline__
checking for broken incomplete types... ok
checking for short external names... ok
checking to see if char is signed... yes
checking to see if right shift is signed... yes
checking to see if fopen accepts b spec... yes
checking for a BSD compatible install... /bin/install -c
checking for ranlib... ranlib
checking host system type... i386-pc-mingw32
checking for ranlib... ranlib
checking for gcc... gcc
checking whether we are using GNU C... yes
checking for gcc option to produce PIC... -fPIC
checking if gcc PIC flag -fPIC works... no
checking if gcc static flag -static works... -static
checking whether ln -s works... no
checking for ld used by GCC... ./c:/mingw/bin/../lib/gcc/mingw32/4.7.2/../../../
../mingw32/bin/ld.exe
checking if the linker (./c:/mingw/bin/../lib/gcc/mingw32/4.7.2/../../../../ming
w32/bin/ld.exe) is GNU ld... yes
checking whether the linker (./c:/mingw/bin/../lib/gcc/mingw32/4.7.2/../../../..
/mingw32/bin/ld.exe) supports shared libraries... yes
checking for BSD-compatible nm... /mingw/bin/nm
checking command to parse /mingw/bin/nm output... no
checking how to hardcode library paths into programs... immediate
checking for ./c:/mingw/bin/../lib/gcc/mingw32/4.7.2/../../../../mingw32/bin/ld.
exe option to reload object files... -r
checking dynamic linker characteristics... no
checking if libtool supports shared libraries... no
checking whether to build shared libraries... no
checking whether to build static libraries... yes
checking for objdir... .libs
creating libtool
checking libjpeg version number... 62
creating ./config.status
creating Makefile
creating jconfig.h
jconfig.h is unchanged 
```

相关问题：[需要帮助从 libjpeg 编译 jpegtran.c 代码](https://stackoverflow.com/q/14631530/1666510)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2016-03-03T09:06:00.717

您可能应该尝试运行

```
./configure --help 
```

并查看所有可用的配置标志，也许你拼错了一些或者你需要`--enable-dynamic`或不同的东西。

对于配置输出，您还可以参考`config.log`，即在项目（在您的情况下是 libjpeg 的）目录中，就在`configure`文件旁边。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-07-07T12:34:35.240

我遇到了同样的问题，我相信这是因为 jpeg-6b 是使用非常旧版本的 autotools 构建的（如果 sourceforge 页面正确，jpeg-6b 版本可以追溯到 1998 年）。

特别是，问题在于它检查 gcc 是否支持 -fPIC 标志的方式：

```
检查 gcc 选项以生成 PIC... -fPIC
检查 gcc PIC 标志 -fPIC 是否有效...否
```

这就是他们从 config.log 执行检查的方式：

```
ltconfig:547: 检查 gcc PIC 标志 -fPIC 是否有效
ltconfig:548: gcc -c -fPIC -DPIC -I/local/include conftest.c 1>&5
conftest.c:1:0: 警告：-fPIC 忽略目标（所有代码都与位置无关）

 ^
```

请注意 gcc 如何返回警告，它可能返回退出代码 1 导致检查失败。并且位置无关的代码对于共享库来说是必要的，所以这使它认为它无法制作它们，然后它会输出：

```
检查是否构建共享库...否
```

将其与 libjpeg9 进行比较，我假设它使用了更新版本的 autotools：

```
检查 gcc -std=gnu99 选项以生成 PIC... -DDLL_EXPORT -DPIC
检查 gcc -std=gnu99 PIC flag -DDLL_EXPORT -DPIC 是否有效...是
```

并且来自 config.log：

```
配置：10108：检查 gcc -std=gnu99 选项以生成 PIC
配置：10115：结果：-DDLL_EXPORT -DPIC
配置：10123：检查 gcc -std=gnu99 PIC 标志 -DDLL_EXPORT -DPIC 是否有效
配置：10141：gcc -std=gnu99 -c -g -O2 -I/local/include -DDLL_EXPORT -DPIC -DPIC conftest.c >&5
配置：10145：$？= 0
配置：10158：结果：是
```

我最终编译了 libjpeg9，但我认为如果您可以使用更新版本的自动工具重新创建 ./configure 脚本，libjpeg6 也可能是可编译的。

# model-view-controller - 蓝点菜单 MVC - 在 MVC 中使用服务器控制

> ID：14635872
> 
> 赞同：1
> 
> 时间：2013-01-31T21:55:29.040
> 
> 标签：model-view-controller, intuit-partner-platform

我正在使用 MVC 应用程序来集成 Intuit Anywhere 和 MVC 应用程序。我看到蓝点菜单有一个服务器控件：

```
 <!-- Blue Dot Menu -->
            <div runat="server" id="blueDotDiv">
                <ipp:bluedot></ipp:bluedot>
            </div> 
```

如何将此服务器控件集成到 MVC 站点中？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T13:31:36.307

有一个可用作参考的 Azure MVC Web 角色模板：

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0300_Windows_Azure_Program_for_Intuit_Anywhere/0003_Intuit_Anywhere_Azure_Web_Role_Templates](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0200_DevKits_for_Intuit_Partner_Platform/0300_Windows_Azure_Program_for_Intuit_Anywhere/0003_Intuit_Anywhere_Azure_Web_Role_Templates)

在 ASP.NET WebForms 示例项目中包装蓝点菜单的 div 用于控制其在服务器端的可见性（当用户连接时隐藏），但您可以以任何方式实现隐藏控件。

单击按钮时，它会调用您在 intuit.ipp.anywhere.setup javascript 函数中指定的服务器端资源，该函数又会调用 AppMenu API 来检索菜单的内容：

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0025_Intuit_Anywhere/0020_Connect/0010_From_Within_Your_App/Add_the_Connect_Button](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0025_Intuit_Anywhere/0020_Connect/0010_From_Within_Your_App/Add_the_Connect_Button)

[https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0025_Intuit_Anywhere/0060_Reference/0010_AppMenu_API](https://ipp.developer.intuit.com/0010_Intuit_Partner_Platform/0025_Intuit_Anywhere/0060_Reference/0010_AppMenu_API)

# scorm - Adobe Captivate & SCORM: Navigate to next SCO

> ID：14635881
> 
> 赞同：0
> 
> 时间：2013-01-31T21:56:33.790
> 
> 标签：scorm, scorm2004, adobe-captivate

I am attempting to navigate to the next SCO using the call "adl.nav.request" in SCORM 2004\. However, I am relatively new to creating SCORM content using Captivate and what I am trying doesn't seem to be working. The code I am using is:

```
// NOT WORKING IN DEFAULT CAPTIVATE TEMPLATE HTML/JS FILES
CaptivateObj.SetScormVariable("adl.nav.request","{target=sco2_item}choice");
CaptivateObj.SetScormVariable("terminate", ""); 
```

To verify that it's an issue with this particular code, I bypassed the default Captivate HTML/JS files and used my own along with a custom SCORM Wrapper in which I was able to connect to the SCORM API and successfully navigate to the next SCO using the parameters below:

```
// WORKING IN CUSTOM SCORM WRAPPER
 setScormVariable("adl.nav.request","{target=sco2_item}choice");
 setScormVariable("terminate",""); 
```

With that said, I assume the initial Captivate code is not correct. Can someone point me in the correct direction?

Thanks, in advance.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T16:41:30.823

这有效：

```
SCORM2004_CallSetValue("adl.nav.request","{target=sco2_item}choice");
SCORM2004_CallTerminate(); 
```

# sql - Extract one value from a column containing multiple delimited values

> ID：14635882
> 
> 赞同：3
> 
> 时间：2013-01-31T21:56:36.067
> 
> 标签：sql, sql-server, tsql, sql-server-2008-r2, tokenize

How can I get the value from the sixth field in the following column? I am trying to get the 333 field:

```
ORGPATHTXT
2123/2322/12323/111/222/333/3822 
```

I believe I have to use `select substring`, but am unsure how to format the query

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:10:16.037

> **假设 SQL Server**

我能想到的最简单的方法是创建一个基于“/”拆分的拆分函数，然后提取如下所示的第六项

```
declare @text varchar(50) = '2123/2322/12323/111/222/333/3822'

select txt_value from fn_ParseText2Table(@text, '/') t where t.Position = 6 
```

我使用了[这个 url](http://www.codeproject.com/Articles/7938/SQL-User-Defined-Function-to-Parse-a-Delimited-Str)中的函数。[**看到它在 SQLFiddle 工作**](http://sqlfiddle.com/#!3/c6a04/1)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:30:10.780

试试这个 - 一个字符串`variable` 或包装成一个`function`与选择查询一起使用（[Sql-Demo](http://sqlfiddle.com/#!3/d41d8/8370)）

```
Declare @s varchar(50)='2123/2322/12323/111/222/333/3822'

Select @s = right(@s,len(@s)- case charindex('/',@s,1) when 0 then len(@s) 
                              else charindex('/',@s,1) end)
From ( values (1),(2),(3),(4),(5)) As t(num)

Select case when charindex('/',@s,1)>0 then left(@s,charindex('/',@s,1)-1) 
            else @s end

--Results
333 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T01:11:53.980

I'd like to offer a solution that uses `CROSS APPLY` to split up any delimited string in MSSQL and `ROW_NUMBER()` to return the 6th element. This assumes you have a table with ORGPATHTXT as a field (it can easily be converted to work without the table though):

```
SELECT ORGPATHTXT
FROM (
  SELECT 
    Split.a.value('.', 'VARCHAR(100)') AS ORGPATHTXT,
    ROW_NUMBER() OVER (PARTITION BY ID ORDER BY (SELECT 1)) RN
  FROM  
    (SELECT ID, CAST ('<M>' + REPLACE(ORGPATHTXT, '/', '</M><M>') + '</M>' AS XML) AS String  
     FROM  MyTable
  ) AS A 
  CROSS APPLY String.nodes ('/M') AS Split(a)
  ) t 
WHERE t.RN = 6; 
```

Here is some sample [Fiddle](http://sqlfiddle.com/#!3/ba08d/8) to go along with it.

Good luck.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-01T04:26:07.303

对于 sql，您可以使用

```
declare @string varchar(65) = '2123/2322/12323/111/222/333/3822'

select substring(string,25,27) from table_name 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-31T22:09:53.343

如果您使用的是 MySQL，那么您可以使用：

```
select substring_index(orgpathtxt, '/', 6) 
```

我只想说，在大多数其他数据库中它不太方便。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-01T16:58:29.087

您也可以使用带有动态管理功能[sys.dm_fts_parser的选项](http://msdn.microsoft.com/ru-ru/library/cc280463%28v=sql.105%29.aspx)

```
DECLARE @s nvarchar(50) = '2123/2322/12323/111/222/333/3822' 

SELECT display_term
FROM sys.dm_fts_parser('"'+ @s + '"', 1033, NULL, 0) 
WHERE display_term NOT LIKE 'nn%' AND occurrence = 6 
```

# php - How to display XML in a dropdown list with JQuery

> ID：14635885
> 
> 赞同：1
> 
> 时间：2013-01-31T21:56:45.533
> 
> 标签：php, jquery, xml, json

Hi I am trying to create a dropdown list that has the abilty to show a list of XML files and will allow the user to click on their names and display the XML in a table below the list. I've been trying for the last week and keep hitting brick walls and getting very confused can someone please help me? The closes i've gotten is using a pair of buttons to display the XML in a table below.

*edit

The XML files are in the same directory as the HTML file. I am trying to have the drop-down list box and table populated using Ajax and the Server/Client Ajax interactions using JSON to exchange data.

The only thing I have managed to write because I am really bad at this at the moment is this:

HTML

```
<!DOCTYPE html>
<html>
<head>
<script>
function loadXMLDoc(url)
{
var xmlhttp;
var txt,x,xx,i;
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    txt="<table border='1'><tr><th>City</th><th>Team</th></tr>";
    x=xmlhttp.responseXML.documentElement.getElementsByTagName("team");
    for (i=0;i<x.length;i++)
      {
      txt=txt + "<tr>";
      xx=x[i].getElementsByTagName("city");
        {
        try
          {
          txt=txt + "<td>" + xx[0].firstChild.nodeValue + "</td>";
          }
        catch (er)
          {
          txt=txt + "<td> </td>";
          }
        }
      xx=x[i].getElementsByTagName("name");
        {
        try
          {
          txt=txt + "<td>" + xx[0].firstChild.nodeValue + "</td>";
          }
        catch (er)
          {
          txt=txt + "<td> </td>";
          }
        }
      txt=txt + "</tr>";
      }
    txt=txt + "</table>";
    document.getElementById('teamInfo').innerHTML=txt;
    }
  }
xmlhttp.open("GET",url,true);
xmlhttp.send();
}
</script>
</head>
<body>

<div id="teamInfo">
<button onclick="loadXMLDoc('econ.xml')">Eastern Conference</button>
<button onclick="loadXMLDoc('westernCon.xml')">Western Conference</button>
<br>

</div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T01:26:02.377

好吧，如果您让按钮工作，那么您只需要转换为使用选择并在它们更改值时触发您的 JS 函数

```
<select onChange="loadXMLDoc(this.value)">
    <option value="null.xml">Please Select</option>
    <option value="econ.xml">Eastern Conference</option>
    <option value="westernCon.xml">Western Conference</option>
</select> 
```

请注意，在我的示例中，您希望在 loadXMLDoc 函数中添加一个检测来确定 url == "null.xml" 是否清除您的表而不是填充它...或者只是添加一个空文本文件和名称它是 null.xml。

# c# - 在 finally 块中调用 .ConfigureAwait(false) 是否安全？

> ID：14635887
> 
> 赞同：1
> 
> 时间：2013-01-31T21:57:00.657
> 
> 标签：c#, async-await, c#-5.0

我有一个包装的“休息客户端”，`HttpClient`其方法是异步的。除其他原因外，我需要使用我的休息客户端控制登录/注销过程，以免超过会话数。

其余客户端实现`IDisposable`并在处理客户端后，我需要检查客户端是否“仍然登录”，如果是则退出。由于在 Dispose 方法中进行任何类型的外部调用都被认为是不好的做法，因此我有以下内容

```
public class MappingsController : RestController
{
    [HttpGet]
    public async Task<HttpResponseMessage> GetYears()
    {
        return await ProcessRestCall(async rc => await rc.GetYearsAsync());
    }
}

public class RestController : ApiController
{
    protected async Task<HttpResponseMessage> ProcessRestCall<T>(Func<RestClient, Task<T>> restClientCallback)
    {
        RestClient restClient = null;
        try
        {
            var credentials = GetCredentialsFromRequestHeader();
            if (credentials == null)
            {
                return Request.CreateErrorResponse(HttpStatusCode.Unauthorized, "Missing credentials from header!");
            }
            var username = credentials["Username"];
            var password = credentials["Password"];

            restClient = new RestClient(username, password);
            var authenticated = await restClient.SignInAsync();
            if (!authenticated)
            {
                return CreateErrorResponseWithRestStatus(HttpStatusCode.Unauthorized, restClient);
            }
            var result = await restClientCallback(restClient);
            // Following works, but since I need to do it in finally block in case exception happens, perhaps It should be done in finally anyways...
            //await restClient.SignOutAsync(); 
            var response = Request.CreateResponse(HttpStatusCode.OK, result);
            return response;
        }
        catch (Exception e)
        {
            return CreateErrorResponseWithRestStatus(HttpStatusCode.BadRequest, restClient, e);
        }
        finally
        {
            if (restClient != null)
            {
                if (restClient.IsSignedIn)
                {
                    //var signedOutOk = restClient.SignOutAsync();//.Result; //<-- problem - this blocks!!!
                    restClient.SignOutAsync().ConfigureAwait(false); // seems to work, but I am not sure if this is kosher + I can't get return var

                    //Logger.Warn(CultureInfo.InvariantCulture, m => m("Client was still signed in! Attempt to to sign out was {0}", signedOutOk ? "successful" : "unsuccessful"));
                }
                restClient.Dispose();
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T22:01:53.170

的使用`.ConfigureAwait(false)`不是问题。 **你根本没有在等待任务。** 既然你不这样做，那么配置做`await`什么都没关系。`await`

您正在做的只是基本的“一劳永逸”（您可能接受也可能不接受）。

无论如何，您都应该删除`ConfigureAwait(false)`它，因为它什么都不做并且让读者感到困惑。如果您可以发送退出请求但实际上并未退出，那么这没关系。

如果您需要确保`restClient.Dispose();`在退出请求返回之前不会调用它，那么您有一点......问题。问题源于注销请求可能不成功，或者更糟糕的是，它可能根本没有响应。你需要一些方法来处理它。

你不能`await`在一个`finally`块中使用，但你可以或多或少地通过延续来模仿它的行为。您可能需要执行以下操作：

```
public static async Task DoStuff()
{
    IDisposable disposable = null;
    try { }
    finally
    {
        var task = GenerateTask();
        var continuation = Task.WhenAny(task, Task.Delay(5000))
            .ContinueWith(t =>
            {
                if (task.IsCompleted) //if false we timed out or it threw an exception
                {
                    var result = task.Result;
                    //TODO use result
                }

                disposable.Dispose();
            });
    }
} 
```

请注意，由于您没有使用`await`从返回的任务`DoStuff`，因此一旦它第一次到达 finally 块，它将表明它已“完成”；不是在延续触发并且对象被处置时。这可能会或可能不会被接受。

# php - PHP 使用 $this->variable 作为类方法参数默认值

> ID：14635890
> 
> 赞同：11
> 
> 时间：2013-01-31T21:57:06.690
> 
> 标签：php, class, variables, default

好的，所以这似乎是一个非常愚蠢的问题，但 PHP 告诉我我不能这样做，或者更确切地说是我的 IDE ......

在下面的示例中，它告诉我不能使用 $this->somevar 作为该方法的默认值。

IE...

```
class something {

public somevar = 'someval';

private function somefunc($default = $this->somevar) {

}

} 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-31T22:00:45.093

恐怕您的IDE是正确的。这是因为“默认值必须是常量表达式，而不是（例如）变量、**类成员**或函数调用”。—*[函数参数](http://php.net/manual/en/functions.arguments.php)*

你需要做这样的事情：

```
class something {

    public $somevar = 'someval';

    private function somefunc($default = null) {
        if ($default === null) {
            $default = $this->somevar;
        }
    }
} 
```

这也可以使用[三元运算符](https://php.net/manual/en/language.operators.comparison.php#language.operators.comparison.ternary)编写：

```
$default = $default ?: $this->somevar; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-01-31T21:58:38.437

> “[函数参数]的默认值必须是常量表达式，而不是（例如）变量、类成员或函数调用。”

[http://php.net/manual/en/functions.arguments.php](http://php.net/manual/en/functions.arguments.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-09T10:44:43.210

在这种情况下，您可以使用我的小型库[ValueResolver](https://github.com/LapaLabs/ValueResolver)，例如：

```
class something {

    public somevar = 'someval';

    private function somefunc($default = null) {
        $default = ValueResolver::resolve($default, $this->somevar); // returns $this->somevar value if $default is empty
    }
} 
```

并且不要忘记使用命名空间`use LapaLabs\ValueResolver\Resolver\ValueResolver;`

还有类型转换的能力，例如如果你的变量的值应该是`integer`，所以使用这个：

```
$id = ValueResolver::toInteger('6 apples', 1); // returns 6
$id = ValueResolver::toInteger('There are no apples', 1); // returns 1 (used default value) 
```

查看[文档](https://github.com/LapaLabs/ValueResolver)以获取更多示例

# ruby - Sinatra json rendering not working as expected

> ID：14635894
> 
> 赞同：6
> 
> 时间：2013-01-31T21:57:27.110
> 
> 标签：ruby, sinatra

I'm having a problem in Sinatra where I can't respond with just a json and I can't find good sinatra docs anywhere, most of things seems outdated.

Anyways, here's the code:

```
module MemcachedManager
  class App < Sinatra::Base
    register Sinatra::Contrib
    helpers Sinatra::JSON

    get '/' do
      json({ hello: 'world' })
    end
  end
end

MemcachedManager::App.run! if __FILE__ == $0 
```

The response that I do get is:

```
"<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\" \"http://www.w3.org/TR/REC-html40/loose.dtd\">\n<html><body><p>{\"hello\":\"world\"}</p></body></html>\n" 
```

Where it should have been only the json part. Why is it rendering html tags when I didn't ask for it?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T00:02:13.997

你看过[这篇博文](http://nathanhoad.net/how-to-return-json-from-sinatra)吗？

```
require 'json'

get '/example.json' do
  content_type :json
  { :key1 => 'value1', :key2 => 'value2' }.to_json
end 
```

我还将其修改为：

```
get '/example.json', :provides => :json do 
```

停止使用路由的 HTML/XML 调用。由于您使用的是 sinatra-contrib gem，并且由于 Ruby 不需要所有这些括号等，您还可以将您作为示例给出的代码简化为：

```
require 'sinatra/json'

module MemcachedManager    
  class App < Sinatra::Base
    helpers Sinatra::JSON
    get '/', :provides => :json do
      json hello: 'world'
    end
  end
end

MemcachedManager::App.run! if __FILE__ == $0 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:05:41.620

试着放

```
content_type :json 
```

`json(...)`通话前

# jquery - Highchart 单个网页中的多个条形图

> ID：14635897
> 
> 赞同：2
> 
> 时间：2013-01-31T21:57:29.827
> 
> 标签：jquery, charts, highcharts

我试图在一页中添加多个条形图，但是当它们显示时，只有最后一个被正确显示。在其他之前的图表中，未绘制条形图

* * *

每个图表我都有这 2 个变量（GraphOptionsX 和 GraphSeriesX）。

```
var GraphOptions0 = {
    chart:{renderTo: null,type: 'bar',height: 200,width: 300},
    title:{text:null},
    subtitle:{text:null},
    xAxis:{
        categories:null
    },
    yAxis:{min:0,title:{text: null},labels:{overflow: 'justify'}},
    tooltip:{formatter:function(){return '' + this.x + ' = ' + this.y;}},
    plotOptions:{bar:{dataLabels:{enabled: true}}},
    legend:{enabled: false},
    credits:{enabled: false},
    exporting:{enabled: false},
    series:[]
};
var GraphSeries0 = {
        name:"",
        data:[],
        point:{events:{click: null}}
}; 
```

在我生成图表之后（x = 0, 1,...）：

```
var graphSeries = eval("GraphSeries" + x);

        graphSeries.name = "GraphSeries" + x;
        graphSeries.data.push({ y: parseInt(107),   color: 'red' });
        graphSeries.data.push({ y: parseInt(31),    color: 'blue' });
        graphSeries.data.push({ y: parseInt(635),   color: 'green' });
        graphSeries.data.push({ y: parseInt(203),   color: 'yellow' });
        graphSeries.data.push({ y: parseInt(2),     color: 'orange' });
        graphSeries.point.events.click = function() {
            alert ('Category: '+ this.category +', value: '+ this.y);
        }

        var graphOptions = eval("GraphOptions" + x);
        graphOptions.xAxis.categories = ['Category 1', 'Category 2', 'Category 3', 'Category 4', 'Category 5'];
        graphOptions.chart.renderTo = 'containerChart'+x;
        graphOptions.series.push(graphSeries);

        new Highcharts.Chart(graphOptions); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:20:55.317

无法理解您的问题是什么，而是一个根据您的数据创建三个图表的演示：在每个循环中，您只需要清除数据数组和系列数组。

```
for(x = 0; x < 3; x++)
    {
    var graphSeries = eval("GraphSeries");
        graphSeries.data = [];

    graphSeries.name = "GraphSeries" + x;
    graphSeries.data.push({ y: parseInt(107 + x),   color: 'red' });
    graphSeries.data.push({ y: parseInt(31),    color: 'blue' });
    graphSeries.data.push({ y: parseInt(635),   color: 'green' });
    graphSeries.data.push({ y: parseInt(203),   color: 'yellow' });
    graphSeries.data.push({ y: parseInt(2),     color: 'orange' });
    graphSeries.point.events.click = function() {
        alert ('Category: '+ this.category +', value: '+ this.y);
    }

    var graphOptions = eval("GraphOptions");
        graphOptions.series = [];
    graphOptions.xAxis.categories = ['Category 1', 'Category 2', 'Category 3', 'Category 4', 'Category 5'];
    graphOptions.chart.renderTo = 'containerChart'+x;
    graphOptions.series.push(graphSeries);

    new Highcharts.Chart(graphOptions);
    } 
```

这是一个演示：http: [//jsfiddle.net/De8MB/1/](http://jsfiddle.net/De8MB/1/)

# php - When should the Controller get instantiated?

> ID：14635899
> 
> 赞同：3
> 
> 时间：2013-01-31T21:57:32.290
> 
> 标签：php, oop, model-view-controller

I am building an AJAX web app, using PHP for my back end. I am trying to design a routing system that will let me easily drop new pages in, and let me focus on the Javascript. The actual pages that PHP will be serving up are simple, just views that are essentially containers for Javascript charts (built with [d3.js](http://d3js.org/)). Thus, my controller won't even have to interact with my model until I start making AJAX calls.

I am new to OOP, especially in back end. I've been doing a bit with Javascript, but I am brand new to incorporating OOP with MVC & solving the issue of routing. I know there are modules/plugins out there that have Routing classes written, but as the back end part of this project is very straight-forward - essentially, how best to serve up an 'About' page on a blog - I'd like to take this opportunity to learn it thoroughly myself.

I have one controller:

```
<?php
//controller.php
include 'views/view.php';

class Controller
{

    public function homeAction() {
        $view = new View();
        $view->setTemplate('views/home.php');
        $view->render();
    }

    public function categoryAction($category) {
        $view = new View();
        $view->setTemplate("views/Monitor/{$category}/{$category}.php");
        $view->setCategory($category);
        $view->render();
    }

    public function monitorAction($category, $monitor) {
        $view = new View();
        $view->setTemplate("views/Monitor/{$category}/{$monitor}.php");
        $view->setCategory($category);
        $view->setMonitor($monitor);
        $view->render();
    }

}

?> 
```

Right now, I instantiate my controller at the beginning of `index.php`:

```
<?php
// Load libraries
require_once 'model.php';
require_once 'controller.php';

$controller = new Controller();

$uri = str_replace('?'.$_SERVER['QUERY_STRING'], '', $_SERVER['REQUEST_URI']);

// home action
if ($uri == '/') {
  $controller->homeAction();

// /{category}/{monitor}
} elseif (preg_match("#/(.+)/(.+)#", $uri, $matches) ) {
  $category = $matches[1];
  $monitor  = $matches[2];
  $controller->monitorAction($category, $monitor);

// /{category}
} elseif (preg_match("#/([^/.]+)#", $uri, $matches) ) {
  $category = $matches[1];
  $controller->categoryAction($category);

// 404  
} else {
    header('Status: 404 Not Found');
    echo '<html><body><h1>Page Not Found</h1></body></html>';
}

if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && (!empty($_GET)) && $_GET['action'] == 'get_data') {

    $function = $_GET['chart'] . "_data";
    $dataJSON = call_user_func($function);
    header('Content-type: application/json');
    echo $dataJSON;

}

?> 
```

I have read a bit about PHP's autoloader, but I'd like to get it down manually first, because I want to make sure and understand the fundamentals.

Is this the appropriate place to instantiate my `Controller` object?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:18:00.973

首先，您的架构面临一些重大问题。您需要一个路由器来处理用户请求的 URI，接下来您需要系统的初始化状态。`Controller`创建s的常用方法是创建`extend`一个父类，然后在您的父类`__construct`方法中您可以初始化您的子控制器，但是，您的系统状况不佳。

这是我从不删除的黄金链接：

[http://johnsquibb.com/tutorials/mvc-framework-in-1-hour-part-one](http://johnsquibb.com/tutorials/mvc-framework-in-1-hour-part-one)

# php - 如何获得一个月中某一天的下一次出现

> ID：14635901
> 
> 赞同：2
> 
> 时间：2013-01-31T21:57:37.843
> 
> 标签：php, stripe-payments

我试图让条带在用户选择的月份中的任何一天的下一次出现时设置一个 end_trial 日期。即如果今天是 16 号并且用户选择了 15 号，我需要下个月 15 号的 unix 时间戳。但是，如果今天是 14 号，我需要明天的时间戳。

我尝试了在这个 SO question [Find the date for next 15th using php](https://stackoverflow.com/questions/6709659/find-the-date-for-next-15th-using-php)上找到的解决方案。

当我运行该问题中建议的代码并将 15 替换为 31 时

```
$nextnth = mktime(0, 0, 0, date('n') + (date('j') >= 31), 31);

echo date('Y-m-d', $nextnth); 
```

结果是2013-03-03

我也试过这个[获取下一次出现的 18th 的日期](https://stackoverflow.com/questions/3774645/get-the-date-of-the-next-occurrence-of-the-18th)。

当我运行它时，第二个实际上会给我 2013-03-31 2013-1-31。

两者都有意想不到的结果。2月有问题吗？任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T01:17:54.120

这是一种方法。

```
function nextDate($userDay){      

  $today = date('d'); // today

  $target = date('Y-m-'.$userDay);  // target day

  if($today <= $userDay){

   $return = strtotime($target);

  }
  else{

   $thisMonth = date('m') + 1;
   $thisYear = date('Y');

   if($userDay >= 28 && $thisMonth == 2){
       $userDay = 28;
   }

   while(!checkdate($thisMonth,$userDay,$thisYear)){

     $thisMonth++;

     if($thisMonth == 13){

       $thisMonth = 1;
       $thisYear++;

     }

   }      

   $return = strtotime($thisYear.'-'.$thisMonth.'-'.$userDay);

  }

  return $return; 

}

// usage
echo date('Y-m-d',nextDate(29)); 
```

我们今天得到用户的选择并进行比较。

*   如果今天小于或等于用户选择，我们返回本月的时间戳。

*   如果今天大于用户选择，我们遍历日期，添加一个月（如果 $thisMonth 达到 13，则添加一年）。一旦这个日期再次存在，我们就有了答案。

我们使用php的[checkdate 函数](http://php.net/manual/en/function.checkdate.php/ "php的checkdate函数")[strtotime](http://php.net/manual/en/function.strtotime.php)和[date](http://php.net/manual/en/function.date.php)检查日期。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:01:44.983

我真的不完全理解这个问题。例如，您可以轻松确定接下来 30 天的日期

```
$next_ts = time() + 30 * 86400; // add 30 days to current timestamp
$next = date('Y-m-d', $next_ts);   // format string as Y-m-d 
echo $next; 
```

如果这不是您需要的，请解释问题所在。

# c# - 使用 C# 合并 CSV 中的记录

> ID：14635903
> 
> 赞同：0
> 
> 时间：2013-01-31T21:57:40.133
> 
> 标签：c#, csv

我在 c# 中工作，至少可以说我的编程技能很生疏。File1.csv 具有列标题和主键。File2.txt 用 ; 分隔 并且没有标题。两张表都包含有关商品的信息，包括 SKU 和价格。基本上，如果 SKU 存在于 File1.csv 上，则将 File2.csv 上的价格更新为数学，否则不理会它。file1 大约 10MB，file2 大约 50MB+。实现这一目标的最简单方法是什么？

# c++ - parsing fairly complex but structure files in c++

> ID：14635904
> 
> 赞同：1
> 
> 时间：2013-01-31T21:57:44.640
> 
> 标签：c++, parsing, file-io

I'm trying to parse a fairly complicated, but structured file using c++.

```
011 FistName MiddleName LastName age(int) date(4/6/2001) position status ...
012 FistName MiddleName LastName age(int) date(4/6/2001) position status ...
... 
```

That's what the file format looks like. I'm trying to store the data as individual field of a struct but the first middle last name are of variable size and may not have the middle name in them, so how would you distinguish that?

For example,

```
014 Jon Smith ...
015 Jon J Smith, Jr. ... 
```

I want to store the whole name in a name field rather than separate them. Say we have

```
struct{
    std::string name;
    int id;
    int age;
    std::string position;
    ...

} 
```

How would i go about parsing everything?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T00:56:30.673

For your purposes, if you're using C++11, you could adapt the [std::regex match example](http://en.cppreference.com/w/cpp/regex/regex_match) to accomplish what you want.

If you're not, you should use [boost::regex](http://www.boost.org/doc/libs/1_52_0/libs/regex/doc/html/boost_regex/ref/regex_match.html) to accomplish what you want.

Here's an example of a regular expression you could use:

```
^\d+ (\w+) ?(\w*) (\w+),? ?(\w+\.)? age\((\d+)\) date\((\d\/\d\/\d+)\) (\w+) (\w+) 
```

To find out what that regular expression means and how it matches things, check out [this link](http://regexr.com?33kup).

To learn more about regular expressions, I'd highly recommend [this book](https://rads.stackoverflow.com/amzn/click/com/0596528124) by Jeffrey Friedl.

It would match the following:

```
014 Jon Smith age(32) date(4/6/2001) position status
014 Jon J Smith, Jr. age(16) date(4/6/2001) position status
015 FistName MiddleName LastName, Title. age(45) date(4/6/2001) position status
016 FistName MiddleName LastName age(7) date(4/6/2001) position status
039 FistName MiddleName LastName age(100) date(4/6/2001) position status 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:36:43.903

Well you could simply use fstream and then take it 1 word at a time. First into an int, then into a string until the next value is an int (age). If i recall correctly from my infinite loops, doing a stream input to an int when the stream isnt a number doesnt take the value from the stream so you could do >> int, >> string >> int >> etc until you know you have the age.

etc etc. you get the point :)

PS: remember to use .get() and not .eof() for your input loops :)

# orchardcms - 果园 CMS 主题图像未显示

> ID：14635907
> 
> 赞同：3
> 
> 时间：2013-01-31T21:57:55.077
> 
> 标签：orchardcms

我正在使用正确的助手调用来获取主题中图像的 URL：

```
@Url.Content(Html.ThemePath(WorkContext.CurrentTheme, "/Content/Images/my-image.png") 
```

...而且我知道图像在那里并且是可读的。然而，当我尝试浏览它时它没有出现！为什么会这样？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T21:57:55.077

从文档（[http://docs.orchardproject.net/Documentation/Anatomy-of-a-theme](http://docs.orchardproject.net/Documentation/Anatomy-of-a-theme)）：

> *要启用文件，每个包含静态文件（如样式表、图像或 JavaScript 代码）的文件夹都应包含一个包含以下内容的 web.config 文件*：

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
  <system.web>
    <httpHandlers>
      <!-- iis6 - for any request in this location,
           return via managed static file handler -->
      <add path="*" verb="*" type="System.Web.StaticFileHandler" />
    </httpHandlers>
  </system.web>
  <system.webServer>
    <handlers accessPolicy="Script,Read">
      <!-- iis7 - for any request to a file exists on disk,
           return it via native http module.
           accessPolicy 'Script' is to allow for a managed 404 page. -->
      <add name="StaticFile" path="*" verb="*" modules="StaticFileModule"
           preCondition="integratedMode" resourceType="File"
           requireAccess="Read" />
    </handlers>
  </system.webServer>
</configuration> 
```

# jquery - jScrollPane：在Webkit中拖动jspDrag位时水平滚动条左移

> ID：14635909
> 
> 赞同：6
> 
> 时间：2013-01-31T21:58:05.283
> 
> 标签：jquery, google-chrome, safari, webkit, jscrollpane

将水平滚动条与锚标记结合使用时，我遇到了一个特定于 Webkit 的问题。此处显示了该问题的一个示例：[http ://www.splinterarchitecten.nl/wonen-combinatie/](http://www.splinterarchitecten.nl/wonen-combinatie/)

请采取以下步骤：

1.  使用 Chrome（我使用的是 24.0.1312.57 版）或 Safari（5.1.7）转到给定的地址。
2.  使用滚动条滚动到前三个之外的图像。
3.  单击该图像。
4.  点击右下角的“overzicht”链接。
5.  这会将您返回到概览，单击的图像在左侧（锚标记功能）。
6.  抓住滚动条拖动位并将其移动到左侧。
7.  整个滚动条消失在左侧徽标的后面。
8.  刷新页面，滚动条自行运行。

CSS 包含在 javascript 之前。我试过'autoReinitialise：true'，没有区别。我现在使用以下代码：

```
if ( window.location.hash ) {
    api.scrollToElement( $j( window.location.hash ), 1 );
} 
```

这似乎对某些人有所帮助（至少滚动条最初显示在适当的位置），但拖动问题仍然存在。任何帮助将不胜感激。

亲切的问候，

薇薇安

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T11:51:12.303

**解决方法**

我一直在玩你的滚动条，我唯一得到的是滚动条的位置奇怪地似乎取决于你的滚动条`jspPane`。想不通为什么。

无论如何，如果您可以控制`jsscrollpane`初始化窗格的方式，似乎如果您移动`jspHorizontalBar`以使其成为`tiascrollpanehor`类似的直接子级：

```
<div id="tiascrollpanehor" class="scroll-pane jspScrollable" style="overflow: hidden; padding: 0px; width: 525px; " tabindex="0"> 
    <div class="jspHorizontalBar">
    <div class="jspContainer" style="width: 525px; height: 439px; ">
    .... 
```

它可以很好地定位自己，**但**不是用户可控的。要解决此问题，请添加

```
.jspHorizontalBar{
    ...
    z-index:2;
} 
```

我仍然无法解释它为什么会这样，但我希望这会为你解决这个错误（因为我无法在页面渲染之前修改 CSS 和 HTML 结构）。

# php - Zend Php Foreach 循环数组

> ID：14635913
> 
> 赞同：0
> 
> 时间：2013-01-31T21:58:11.410
> 
> 标签：php, zend-framework, loops, foreach

我有一个输入字段和一组来自 DB 表的电子邮件。

我正在比较输入字段与数组的相似性。

但是有些方法，我被困在循环中。

该循环检查是否将每封电子邮件与输入字段进行比较？

无论我输入的内容是否相同，它总是将我带到 google.com

这是来自控制器的代码：

```
if (isset($_POST['btn_free_download']))
                {
                    // Get current input email from input field
                    $email = $this->getRequest()->getParam('email');
                    // Get all emails from the user
                    $referred_users = $this->_helper->user()->getReferredUsers()->toArray();
                    // Check the similarity which it with a loop
                    foreach ($referred_users as $referred_user)
                    {
                       similar_text($email, $referred_user['email'], $similar);
                    }
                    // If yes, Pop up message or redirect to some page
                    if ($similar < 97)
                    {
                        $this->_redirect('http://google.com');
                    }
                    // If not, redirect user to free download page
                    else 
                    {
                        $this->_redirect('http://yahoo.com');
                    }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T03:54:01.850

我认为您需要查看[手册](http://php.net/manual/en/control-structures.foreach.php)。Foreach 函数与您在 zend 或任何其他框架或仅原始 php 上使用它相同。

```
$referred_users = $this->_helper->user()->getReferredUsers()->toArray(); 
```

> $referred_users 可能会保存来自表用户的一系列电子邮件，例如：

```
$referred_users = array("one@email.com", "two@email.com", "three@email.com") 
```

> 然后当您使用 foreach 循环时，它将遍历数组中的每封电子邮件

```
foreach ($referred_users as $referred_user)
{
   // for the first loop $referred_user = one@email.com, for second time $referred_user = two@email.com and goes on
    similar_text($email, $referred_user['email'], $similar);
} 
```

> 现在让我们在这里讨论您的逻辑：

```
 // If yes, Pop up message or redirect to some page
                    if ($similar < 97)
                    {
                        $this->_redirect('http://google.com');
                    }
                    // If not, redirect user to free download page
                    else 
                    {
                        $this->_redirect('http://yahoo.com');
                    } 
```

直到和除非数组 $referred_users 中的最后一个元素完全等于您的 $email

```
i.e. $email = "three@email.com" 
```

您将始终获得 $similar 低于 97% 的结果，这意味着您将被重定向到谷歌。

我假设您没有尝试这样做，并且可能不熟悉 foreach 函数，这就是您没有得到预期结果的原因。

假设您正在尝试执行类似的操作，如果数组中的任何电子邮件匹配，则检查数组中的电子邮件（如果数组来自表检查从参数输入的电子邮件是否等于表中的任何电子邮件）然后重定向到某个地方或显示一些其他消息。以下解决方案可能对您有所帮助。

```
 $similarText = false;
   foreach ($referred_users as $referred_user)
   {
       // for the first loop $referred_user = one@email.com, for second time $referred_user = two@email.com and goes on
        similar_text($email, $referred_user['email'], $similar);
        if ($similar > 97) {
            $similarText = true;
            break;
        }
    }

                   // If yes, Pop up message or redirect to some page
                    if ($similarText)
                    {
                        $this->_redirect('http://google.com');
                    }
                    // If not, redirect user to free download page
                    else 
                    {
                        $this->_redirect('http://yahoo.com');
                    } 
```

希望你明白了。但请在将来发布问题之前检查手册。

# python - 压缩“n”次对象成员调用

> ID：14635914
> 
> 赞同：3
> 
> 时间：2013-01-31T21:58:17.417
> 
> 标签：python, for-loop, lambda, beautifulsoup

是否有任何非显式`for`方法可以在对象上调用成员`n`时间？

我正在考虑一些`map/reduce/lambda`方法，但我想不出一种方法来做到这一点——如果可能的话。

只是为了添加上下文，我正在使用`BeautifulSoup`，并且我正在从 html 表中提取一些元素；我提取了一些元素，然后是最后一个。

因为我有：

```
# First value
print value.text

# Second value
value = value.nextSibling
print value.text

# Ninth value
for i in xrange(1, 7):
    value = value.nextSibling
print value.text 
```

我想知道是否有任何`lambda`方法（或其他方法）可以让我这样做：

```
# Ninth value
((value = value.nextSibling) for i in xrange(1, 7))
print value.text 
```

PS：不，这种方法没有任何问题`for`，除了我真的很喜欢单线解决方案，这非常适合我的代码。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T22:02:43.127

我对循环有强烈的偏好，但你*可以*使用`reduce`：

```
>>> class Foo(object):
...     def __init__(self):
...        self.count = 0
...     def callme(self):
...        self.count += 1
...        return self
... 
>>> a = Foo()
>>> reduce(lambda x,y:x.callme(),range(7),a)
<__main__.Foo object at 0xec390>
>>> a.count
7 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-31T22:07:09.847

你想要一个相当于这个的单行：

```
for i in xrange(1, 7):
    value = value.nextSibling 
```

这是一行：

```
for i in xrange(1, 7): value = value.nextSibling 
```

如果您正在寻找更实用的东西，那么您真正想要的是一个[`compose`](https://stackoverflow.com/questions/8977612/compose-function-and-functional-module)功能，因此您可以编写`callme()`（或`attrgetter('my_prop')`，或其他）7 次。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T22:18:31.117

如果`BS`您可以使用`nextSiblingGenerator()`with`itertools.islice`来获取第 n 个兄弟姐妹。它还可以处理没有第 n 个元素的情况。

```
from itertools import islice

nth = 7
next(islice(elem.nextSiblingGenerator(), nth, None), None) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-01-31T22:49:14.410

免责声明：`eval`是邪恶的。

```
value = eval('value' + ('.nextSibling' * 7)) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-31T22:35:22.073

啊! 但`reduce`在 Python3 中不可用，至少不是作为内置的。

所以这是我的尝试，可移植到 Python2/3 并基于 OP 失败的尝试：

```
[globals().update(value=value.nextSibling) for i in range(7)] 
```

假设这`value`是一个全局变量。如果 value 恰好是成员变量，则改为：

```
[self.__dict__.update(value=value.nextSibling) for i in range(7)] 
```

您不能使用`locals()`，因为列表推导创建了一个嵌套的本地范围，因此 real`locals()`不能直接使用。但是，您可以通过一些工作来捕获它：

```
(lambda loc : [loc.update(x=x.nextSibling) for i in range(7)])(locals()) 
```

如果您不介意复制行数，或者更容易：

```
loc = locals()
[loc.update(value=value.nextSibling) for i in range(7)] 
```

或者，如果您真的喜欢单线：

```
loc = locals() ; [loc.update(value=value.nextSibling) for i in range(7)] 
```

是的，Python 也可以使用`;`8-)

**更新**：

另一个奇特的变体，现在用`map`列表理解代替：

```
list(map(lambda d : d.update(value=value.nextSibling), 7 * [locals()])) 
```

请注意巧妙地使用列表乘法来捕获当前`locals()` *并同时*创建初始迭代。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-02-01T09:27:08.120

最直接的写法是：

```
value = reduce(lambda x, _: x.nextSibling, xrange(1,7), value) 
```

# google-maps - Google Maps API：当前交通的旅行时间

> ID：14635926
> 
> 赞同：1
> 
> 时间：2013-01-31T21:58:59.713
> 
> 标签：google-maps, google-maps-api-3

我想知道是否有人有办法使用谷歌 API（我对版本不挑剔）来找出当前流量的路线时间。我知道没有交通的总旅行时间是可用的，但我只需要那个数字。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:09:24.123

购买营业执照，您将能够通过将 DirectionsRequest 的`durationInTraffic`-option设置为 来获取这些信息（如果可用） `true`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2019-09-23T04:25:15.013

[您可以使用 googlemaps 客户端 API 来获取使用google 路线 API](https://developers.google.com/maps/documentation/directions/start)的行车持续时间，. 对于 python API，参考[github 页面](https://github.com/googlemaps/google-maps-services-python)

示例代码

```
import googlemaps as gmaps
import datetime
import os

SRC = FROM_ADDRESS
DEST = TO_ADDRESS
CLIENT_KEY = os.getenv('GOOGLE_API_KEY')  # Set your directions api key as an env variable
gmaps_client = gmaps.Client(CLIENT_KEY)

now = datetime.datetime.now()
directions = gmaps_client.directions(SRC, DEST, mode="driving",departure_time=now)

# debug
# print(directions)

directions = directions[0].get('legs')[0].get('duration_in_traffic').get('text')
print(directions) 
```

# c# - 访问常量键值数据的有效方法

> ID：14635927
> 
> 赞同：0
> 
> 时间：2013-01-31T21:59:10.203
> 
> 标签：c#, dictionary, keyvaluepair

我想存储键值数据并能够以有效的方式访问它。

基本上：我有一个自定义对象（EquipmentObj），并且该对象中有一个名为“DeviceType”的属性。在对象的构造函数中，我将一个字符串传递给字典（设备对象的局部变量），如果字典有键，则返回一个值。

为了尽量减少在堆上初始化 Dictionary 25 次（EquipmentObj 被实例化 25-50 次），我想知道是否有更有效的方法来做到这一点。

我的第一个想法是XML，但我不能添加反序列化；我不会进入这个。

我的下一个想法可能是使用静态类。但是我仍然需要定义 KeyValuePair 或 Dictionary 并且静态类不能有实例成员。

大家会有什么建议？

这是我现在基本上正在做的一个示例。

```
class EquipmentObj
    {
        public EquipmentObj(string deviceType)
        {
            addItems(); 
            this.DeviceType = EquipmentList.ContainsKey(device_Type) ? EquipmentList[deviceType] : "Default";
        }
        public string DeviceType { get; set; }
        private Dictionary<string, string> EquipmentList = new Dictionary<string, string>();

        private void addItems()
        {
            //Add items to Dictionary 
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:08:21.137

类`static`不能有实例成员，但非静态类可以有`static`成员。您可以在不改变自身的情况下制作`EquipmentList`和`addItems()`两者。`static``EquipmentObj`

```
class EquipmentObj
{
    public EquipmentObj(string deviceType)
    {
        addItems(); 
        this.DeviceType = EquipmentList.ContainsKey(device_Type) ? EquipmentList[deviceType] : "Default";
    }
    public string DeviceType { get; set; }
    private static Dictionary<string, string> EquipmentList = new Dictionary<string, string>();

    public static void addItems()
    {
        //Add items to Dictionary 
    }
} 
```

你可以这样称呼它：

```
EquipmentObj.addItems(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:13:58.593

您可以创建一个 Manager 类来处理设备类型，它不是必需的，但它确实分离了逻辑并使从应用程序中的其他区域访问设备类型更容易一些。

```
public class EquipmentObj
{
    public EquipmentObj(string deviceType)
    {
        this.DeviceType = EquipmentObjManager.GetDeviceType(deviceType);
    }
    public string DeviceType { get; set; }
}

public class EquipmentObjManager
{
    private static Dictionary<string, string> EquipmentList = new Dictionary<string, string>();

    public static string GetDeviceType(string deviceType)
    {
        return EquipmentList.ContainsKey(deviceType) ? EquipmentList[deviceType] : "Default";
    }

    public static void AddDeviceType(string deviceTypeKey, string deviceType)
    {
        if (!EquipmentList.ContainsKey(deviceTypeKey))
        {
            EquipmentList.Add(deviceTypeKey, deviceType);
        }
    }
} 
```

我不确定您在哪里填充您的字典，但您可以调用`EquipmentObjManager.AddDeviceType`将项目添加到字典中。

可能不是您的最佳解决方案，但它可能会有所帮助:)

# java - 在java中比较两个ArrayLists时出错

> ID：14635929
> 
> 赞同：1
> 
> 时间：2013-01-31T21:59:13.317
> 
> 标签：java, loops, arraylist, boolean, compare

我正在尝试编写一个方法，该方法采用 2 个双精度数组列表并返回 set1 中未在 set2 中找到的所有值。这些数字应在 set3 中返回。我不断收到内存不足错误。谁能指出我正确的方向？

```
ArrayList<Double> setDiff(ArrayList<Double> set1, ArrayList<Double> set2){
    ArrayList<Double> set3 = new ArrayList<Double>();
    int count = 0;
    while(count < set1.size()){
        boolean inList = false;
        while(inList == false){
            int count2 = 0;
            while(count2 < set2.size() && set1.get(count) == set2.get(count2)){
                count2++;
            }
            if(count2 != set2.size()){
                set3.add(set1.get(count));
            }
            else{
                inList = true;
                count++;
            }
        }
    }

    return set3;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:00:44.947

我建议使用[Collection utils Disjunction](http://commons.apache.org/collections/apidocs/org/apache/commons/collections/CollectionUtils.html#disjunction%28java.util.Collection,%20java.util.Collection%29)

> 返回一个包含给定集合的排他析取（对称差）的集合。
> 
> 返回集合中每个元素 e 的基数将等于 max(cardinality(e,a),cardinality(e,b)) - min(cardinality(e,a),cardinality(e,b))。
> 
> 这等价于减法(union(a,b),intersection(a,b)) 或 union(减法(a,b),subtract(b,a))。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:01:55.203

某些循环可能不会像您期望的那样停止。

以下代码片段将完成与您尝试做的几乎相同的事情。

```
for (Double d : set1) {
    if (!set2.contains(d)) {
        set3.add(d);
    }
} 
```

更新：既然你说你不能使用 contains()，你可以自己执行检查：

```
for (Double d : set1) {
        boolean found = false;
        for (int i=0; i<set2.size() && !found; i++) {
                if (d.equals(set2.get(i))) {
                    found = true;
            }
        }
        if (!found) {
            set3.add(d);
        }
} 
```

编辑：此外，您的代码中的问题在于该行

```
 if(count2 != set2.size()){ 
```

你应该用>改变!=，因为在count2小于set2的情况下，外部count变量不会增加，导致无限循环，几秒钟后，OutOfMemoryError。

此外，您的算法也不是 100% 正确，因为通过第二个列表的循环并不一致。您可以在下面的 while 循环中看到类似的方法：

```
 int count = 0;
                while (count < set1.size()) {
                    boolean inList = false;
                    int count2 = 0;
                    while (inList == false && count2 < set2.size()) {
                        if (set1.get(count).equals(set2.get(count2))) {
                            inList = true;
                        }
                        count2++;
                    }
                    if (!inList) {
                            set3.add(set1.get(count));
                    }
                    count++;
               } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-31T22:02:13.700

在进行这些比较之前对列表进行排序可能是有利的，然后可以更有效地执行搜索项目。

您也可以尝试这样做：

```
set1.removeAll(set2) 
```

set1 中剩余的项目是 set2 中没有的项目

# html - MVC3/Razor - 选择标签中的禁用选项不回发

> ID：14635930
> 
> 赞同：0
> 
> 时间：2013-01-31T21:59:17.287
> 
> 标签：html, asp.net-mvc, asp.net-mvc-3, razor

我有一个`Employee`实体，我绑定到 MVC3/Razor 应用程序中的“编辑”视图。该`Employee`实体具有 的属性`OccupationTypeId`。`OccupationTypeId`指向`OccupationType`包含多个查找值的表。自然的选择是使用`@Html.DropDownListFor`来呈现`<select>`包含职业列表的标签。

表`OccupationType`模式是相当标准的：`Id, Name, Description, IsEnabled`. 由于可以禁用 OccupationTypes，我希望`OccupationTypeId`下拉菜单仍然呈现禁用的选项，以便用户在禁用时始终可以看到他们的选择，但用户无法选择禁用的选项。换句话说，用户不能将现有选项更改`OccupationTypeId`为禁用选项。

我考虑创建一个`@Html`扩展方法来使用选项构建我的`<select>`标签，并简单地将`disabled`属性附加到禁用的选项。我认为这将是直截了当的...

但是，禁用的选定选项似乎不会回发到控制器方法。换句话说，`Employee.OccupationTypeId`当我发布到编辑时将为空。

有什么方法可以改变这种行为，或者它是内置在 MVC 3 中的吗？我考虑过使用隐藏字段，但是如果需要 OccupationTypeId 并且我启用了验证怎么办？

有没有其他人遇到过这个？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:04:45.133

[当下拉列表中发生更改](http://api.jquery.com/change/)事件时，您可能会有一个隐藏字段得到更新。这样该`OccupationTypeId`字段总是被传递。

```
<input name='CurrentOccupationId' type='hidden' value='@Model.Employee.OccupationTypeId' />

<script>
    $(function() {
        $('#dropDownId').change(function() {
            $('input[name="CurrentOccupationTypeId"]').val($(this).val());
        });
    });
</script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:20:23.057

> 有什么方法可以改变这种行为，或者它是内置在 MVC 3 中的吗？我考虑过使用隐藏字段，但是如果需要 OccupationTypeId 并且我启用了验证怎么办？

它与 MVC 3 无关。所有禁用的 html 元素通常不会回发。

我使用的解决方案是通过使用 CSS 设置适当元素的样式来“模拟”禁用元素。例如，您可以将元素的背景（或前景）颜色设置为灰色，并改为设置[readonly](http://www.w3schools.com/tags/att_input_readonly.asp)属性（当它有意义时）。

[看到这个类似的线程。](https://stackoverflow.com/questions/3262296/html-input-field-disable-input-but-still-post)

# objective-c - NSCollectionView 中的悬停效果

> ID：14635933
> 
> 赞同：11
> 
> 时间：2013-01-31T21:59:23.800
> 
> 标签：objective-c, xcode, cocoa, nsview, nscollectionview

我有一个里面`NSCollectionView`有几个`NSView`s。`NSView`里面有一个，当`NSBox`它被选中时会改变颜色。我也想`NSBox`在悬停时改变颜色。

我子类`NSBox`化并添加了`mouseEntered`and`mouseExited`方法。我使用了`addTrackingRect`inside，`viewWillMoveToWindow`但问题是只有在我首先选择框所在的子视图时才会发生悬停效果。

此外，只有选中的框才会发生悬停效果。如何实现 Hover Over 效果，以便`NSView`我的所有 s`NSCollectionView`立即显示效果？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2016-03-07T04:42:41.680

您可以`updateTrackingAreas`在子类中重写`NSView`以完成此行为：

**界面**

```
@interface HoverView : NSView

@property (strong, nonatomic) NSColor *hoverColor;

@end 
```

**执行**

```
@interface HoverView ()

@property (strong, nonatomic) NSTrackingArea *trackingArea;
@property (assign, nonatomic) BOOL mouseInside;

@end

@implementation HoverView

- (void) drawRect:(NSRect)dirtyRect {
    [super drawRect:dirtyRect];

    // Draw a white/alpha gradient
    if (self.mouseInside) {
        [_hoverColor set];
        NSRectFill(self.bounds);
    }
}

- (void) updateTrackingAreas {
    [super updateTrackingAreas];

    [self ensureTrackingArea];
    if (![[self trackingAreas] containsObject:_trackingArea]) {
        [self addTrackingArea:_trackingArea];
    }
}

- (void) ensureTrackingArea {
    if (_trackingArea == nil) {
        self.trackingArea = [[NSTrackingArea alloc] initWithRect:NSZeroRect
                                                         options:NSTrackingInVisibleRect | NSTrackingActiveAlways | NSTrackingMouseEnteredAndExited
                                                           owner:self
                                                        userInfo:nil];
    }
}

- (void) mouseEntered:(NSEvent *)theEvent {
    self.mouseInside = YES;
}

- (void) mouseExited:(NSEvent *)theEvent {
    self.mouseInside = NO;
}

- (void) setMouseInside:(BOOL)value {
    if (_mouseInside != value) {
        _mouseInside = value;
        [self setNeedsDisplay:YES];
    }
}

@end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-12-10T07:19:23.143

斯威夫特 5

```
 var mouseInside : Bool = false { didSet {
        needsDisplay = true
    }}
    @IBInspectable var hoverColor : NSColor = .controlAccentColor
    var trackingArea : NSTrackingArea?

    override func draw(_ dirtyRect: NSRect) {
        super.draw(dirtyRect)

        if mouseInside {
            hoverColor.setFill()
            bounds.fill()
        }
    }

    override func updateTrackingAreas() {
        super.updateTrackingAreas()

        ensureTrackingArea()

        if let trackingArea = trackingArea, !trackingAreas.contains(trackingArea) {
            addTrackingArea(trackingArea)
        }
    }

    func ensureTrackingArea() {
        if trackingArea == nil {
            trackingArea = NSTrackingArea(rect: .zero,
                                          options: [
                                            .inVisibleRect,
                                            .activeAlways,
                                            .mouseEnteredAndExited],
                                          owner: self,
                                          userInfo: nil)
        }
    }

    override func mouseEntered(with event: NSEvent) {
        mouseInside = true
    }

    override func mouseExited(with event: NSEvent) {
        mouseInside = false
    }

} 
```

# c# - 如何自动使低于给定音量阈值的音频部分静音？

> ID：14635934
> 
> 赞同：1
> 
> 时间：2013-01-31T21:59:29.550
> 
> 标签：c#, signal-processing, wav, transcription

我正在使用 C# 编写单声道音乐转录应用程序。我想将 WAV 文件的所有部分静音到某个音量阈值以下。知道怎么做吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T01:32:44.183

你需要一个[噪音门](http://en.wikipedia.org/wiki/Noise_gate)。噪音门是一种音频效果，可以使任何低于设定音量阈值的安静部分静音（或降低音量）。

使用现有的噪声门实现可能会更容易，而不是创建自己的。理解和实现一个基本的噪声门并不难，但没有单一的正确方法可以做到这一点。任何实现都需要仔细微调以获得最佳结果。

一个基本的噪声门通常会有一个包络跟随器来估计音频的音量。下图显示了一些音频（黑色）覆盖有一个包络（红色）。当包络（红色）低于阈值时，音频的音量会降低。音频可以降低到 0，但用于音乐制作的噪声门通常只会将音频降低固定范围（例如 50db）。降低到零听起来不自然，完全没有声音/噪音会吸引听众的注意力。

![在此处输入图像描述](../Images/8908b36a35192603fe5897edc8b11b0a.png)

# ipython - 静默或压缩 IPython 并行异常

> ID：14635935
> 
> 赞同：0
> 
> 时间：2013-01-31T21:59:30.040
> 
> 标签：ipython, ipython-notebook

是否可以使包含错误 IPython 并行工作者的复合异常的详细信息静音？我有一个大型集群（500 多个工作人员），如果我的（错误的）代码在所有工作人员上引发异常，则在 IPython Notebook 中解析和呈现异常需要很长时间。我只想让工作人员错误的细节保持沉默，并从单个工作人员那里得到一个简单的小异常，因为其余的在我的使用中往往是相同的。

我知道我可以将我的 DirectView 切换为指向一个工作人员来测试我的代码，但我会很方便地不要操纵 dview，而只需设置一个全局标志以避免巨大的堆栈跟踪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T04:54:14.890

第 1 步：问这个问题 第 2 步：签出[这个 Pull Request](https://github.com/ipython/ipython/pull/2871)

如果您只想查看第一个异常，您可以注册一个自定义异常处理程序，该处理程序正是这样做的：

```
from IPython.parallel import error
def only_the_first(self, etype, value, tb, tb_offset=None):
    value.print_traceback(0)

ip = get_ipython()
ip.set_custom_exc((error.CompositeError, ), only_the_first) 
```

# c++ - 想要提高矩阵计算、OpenMP 或 CUDA 的计算速度？

> ID：14635938
> 
> 赞同：-1
> 
> 时间：2013-01-31T21:59:32.690
> 
> 标签：c++, cuda, openmp

我的程序有一堆矩阵乘法和求逆，这很耗时。

我的电脑：CPU：intel i7；GPU：512MB NVIDIA® Quadro® NVS3100M

哪一个更适合提高计算速度？OpenMP 还是 CUDA？

（ps。我认为一般来说，GPU 的核心比 cpu 多，因此，CUDA 可以比 OpenMP 提高数倍？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:59:14.757

根据我的经验（作为学校项目工作，在大多数情况下，中等大小数组的计算时间，我会说小于 2000 * 2000，几乎相同，实际计算时间取决于您的工作负载计算机（通常当您在使用 openMP 时，您会与其他人共享一个集群，因此请确保您单独运行您的应用程序，这样您可能会得到更好的结果））

但是如果你擅长CUDA，GPU在这些计算方面非常强大，当我在做我的CUDA项目时，官网上有很多很好的资料。对于openMP来说，它只是一个库，如果你擅长c或c++，你使用它应该没有问题（但是openMP的编译器有问题~~，不要相信它，尝试记录任何东西）。

我假设你有 CUDA 的经验，我认为不难找到一些好的例子。但是 CUDA 真的是 dummy，不能调试，所以我建议你先尝试 openMP，它应该更容易。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T22:41:36.313

我猜这取决于您的应用程序是什么以及您如何尝试实施改进。请记住，每个优化都有权衡。例如，GPU 通常使用半精度浮点，并且有一些编译器选项允许您绕过 IEEE 标准的某些方面，从而以牺牲精度为代价为您带来一些额外的速度等。

# database - 在 Play Framework 中测试 Actor 但数据库已关闭

> ID：14635939
> 
> 赞同：1
> 
> 时间：2013-01-31T21:59:41.663
> 
> 标签：database, testing, playframework-2.0, akka

我正在使用 Play 2.0.4，并且正在为使用数据库的演员做一个测试单元。测试开始很好，但是在给定时刻与数据库的连接关闭并且正在运行的参与者失败。

代码：

```
public class ActorTest extends Helpers {

    private FakeApplication app;
    private ActorSystem actorSystem;
    private ActorRef actorRef;
    private BankAccount account;

    @Before
    public void initTest() {

        Map<String, String> params = new HashMap<String, String>();
        params.put("db.default.driver", "com.mysql.jdbc.Driver");
        params.put("db.default.url", "mysql://root:XXXX@localhost/YYY");
        params.put("ebean.default", "models.*");

        app = fakeApplication(params);
        actorSystem = play.api.libs.concurrent.Akka.system(app.getWrappedApplication());
    }

    @Test
    public void updateAccountTransaction() {
        running(app, new Runnable() {
            @Override
            public void run() {

                account = BankAccount.find.byId(new Long(1));

                actorRef = actorSystem.actorOf(new Props(new UntypedActorFactory() {
                    @Override
                    public UntypedActor create() {
                        return new AccountTaskActor(account);
                    }
                }));

                Calendar fromDate = Calendar.getInstance();
                ....
                ....  
                Calendar toDate = Calendar.getInstance();

                final InputRangeDateMessage param = new InputRangeDateMessage(fromDate, toDate);

                junit.framework.Assert.assertNotNull(account);

                Future<Object> future = Patterns.ask(actorRef, param, 1000000);

                Promise<Object> sdf = Akka.asPromise(future);
                Promise<Result> r2 = sdf.map(new Function<Object, Result>() {
                    @Override
                    public Result apply(Object response) throws Throwable {
                        if (response instanceof ErrorMessage) {
                            ErrorMessage e = (ErrorMessage) response;
                            System.out.println("Error Message " + e.getErrorText());

                            junit.framework.Assert.assertEquals(e.getErrorCode(), -1);

                        } else if (response instanceof BankAccountMessage) {
                            BankAccount a = ((BankAccountMessage) response).getAccount();
                            System.out.println("BankAccount " + a.accountsLastUpdate);
                        }
                        return ok();
                    }
                });

                Result test2;
                test2 = async(r2);

            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-31T22:14:28.190

AFAIK，你必须等待你的结束`Promise`：

```
...
Result test2 = r2.get(); 
```

# c++ - 我无法更改 char 指针（数组）

> ID：14635940
> 
> 赞同：-2
> 
> 时间：2013-01-31T21:59:42.287
> 
> 标签：c++, pointers, char

我有一些这样的功能：

```
void MClass::GetS(char* buf, int max) const  {
char *temp = new char[max];
temp[max] = '\0';
for (int i = 0; i < max - 1; i++)
    temp[i] = src[i]; // src is class member (char *)
buf = temp; // buf is null after this o.O
} 
```

因此，我无法更改此函数中的 buf 值。为什么会发生？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:06:04.147

传递`char *`给函数会传递指向该函数的指针的副本。您可以将其视为按值传递的指针。修改这个复制的指针不会改变原始指针。

您需要通过引用（对指针的引用）传递它：

```
void MClass::GetS(char *&buf, int max) const 
```

或指针（指向指针的指针）：

```
void MClass::GetS(char **buf, int max) const 
```

或返回指针：

```
char *MClass::GetS(int max) const 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:10:50.310

问题：

1.  您正在写出堆数组的末尾`temp[max] = '\0';`- 这会在缓冲区之后放置一个 0 1 点。

2.  谁知道src有多大。您正在传递“最大值”并在没有检查大小的情况下读取 src - 非常危险。

3.  您正在返回一个带有指针的指针。您需要传入一个双指针并正确返回实际的指针值（或在return语句中返回指针。）

如有疑问，请在调试器中跟踪您的代码。我的猜测是，您的编译器正在通过优化最后一个分配并将其保留为 NULL 来帮助您 - 然后让您稍后因现在损坏的堆和内存泄漏而愉快地崩溃......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-31T22:11:12.587

这显然是一个家庭作业问题。

我猜你正在传递一个`buf`size的缓冲区`max`。你不需要`temp`，你应该非常小心不要注销结束。就像是...

```
void MClass::GetS(char* buf, int max) const  {
  if(!buf) {
    return;
  }

  for (int i = 0; i < max - 1; i++) {
      buf[i] = src[i]; // How long is `src`?
  }
} 
```

这不是现代 C++，如果您自己这样做，该函数将被声明为`std::string MClass::GetS() const { return src; }`（假设`src`已`null`终止）。请纠正你的导师。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-31T22:05:05.713

您正在引用数组之外的元素（因为它有 MAX 元素和索引开始和 0）因此 UB/Error。对于空字符顺便说一句，字符数组总是需要 1 个额外的字符。

有关 src 是什么的更多信息也会有所帮助。

但在这种情况下，您正在更改 buf 的值（作为参数）而不返回/更改您传入的值。

您需要传递指向指针的指针或对指针 (* *) 或 (* &) 的引用，而不仅仅是简单的指针。

# php - PHPGraphLib 科学计数法问题

> ID：14635941
> 
> 赞同：1
> 
> 时间：2013-01-31T21:59:43.947
> 
> 标签：php, graph, scientific-notation, phpgraphlib

我正在使用这个图形库来生成一些基本的图表。我遇到的问题是 Y 轴的值超过一百万的情况，该图以科学计数法呈现数字。

我不确定这是 PHP 问题还是库中的问题。我查看了源代码，但无法解决问题。

这是一个代码示例：

```
<?php 
include('phpgraphlib.php'); 
include('phpgraphlib_stacked.php'); 
$graph = new PHPGraphLibStacked(500,300); 
$popularity = array('Windows 7'=>8000000, 'Mac OS 10'=>3500000, 'Fedora'=>900000); 
$cost = array('Windows 7'=>1000000, 'Mac OS 10'=>3000000, 'Fedora'=>9000000); 
$speed = array('Windows 7'=>5000000,'Mac OS 10'=>5000000,'Fedora'=>8000000); 
$graph->addData($popularity, $cost, $speed); 
$graph->setTitle('Operating System Scores'); 
$graph->setTitleLocation('left'); 
$graph->setXValuesHorizontal(TRUE); 
$graph->setTextColor('blue'); 
$graph->setBarColor('#0066CC', '#669999', '#66CCCC'); 
$graph->setLegend(TRUE); 
$graph->setLegendTitle('Popularity', 'Cost', 'Speed'); 
$graph->setDataFormat('comma');
$graph->setupYAxis(20);
$graph->createGraph(); 
?> 
```

这是这个库的来源：
[http ://www.ebrueggeman.com/phpgraphlib](http://www.ebrueggeman.com/phpgraphlib)

谢谢

# ruby - 为什么ruby的单操作系统线程在复制文件时不会阻塞？

> ID：14635942
> 
> 赞同：4
> 
> 时间：2013-01-31T21:59:45.030
> 
> 标签：ruby, multithreading, concurrency, io

我的假设：

*   MRI ruby​​ 1.8.X 没有原生线程，而是绿色线程。

*   操作系统不知道这些绿色线程。

*   发出一个 IO 繁重的操作应该暂停整个过程，直到发出适当的 IO 中断。

有了这些，我创建了一个[简单的 ruby​​ 程序](https://gist.github.com/4686889)，它执行以下操作：

*   启动打印“工作！”的线程 每一秒。

*   发出 IO 请求以在“主”线程上复制一个大 (1gb) 文件。

现在有人会猜测，作为操作系统不可见的绿色线程，它会将整个进程放在“阻塞”队列和“工作！”队列中。绿色线程不会执行。令人惊讶的是，它有效：S

有谁知道那里发生了什么？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-31T23:26:56.820

没有原子内核文件复制操作。这是进入和退出内核的许多相当短的读取和写入。

结果，该过程不断地重新获得控制权。信号被传递。

绿色线程通过将 Ruby 级别的线程调度程序连接到低级别 I/O 和信号接收来工作。只要这些钩子周期性地捕获控制，绿色线程就会像更多并发线程那样运行。

Unix 最初为用户进程环境提供了一个完全不感知线程但非常简单的抽象机器模型。

随着岁月的流逝，对一般并发的支持，特别是线程以两种不同的方式逐位添加。

1.  添加了许多小组件来检查 I/O 是否会阻塞，如果 I/O 会阻塞则失败（稍后重试），中断慢速 tty I/O 以获取信号，然后透明地返回，等等。当 Unix API 被合并，每一个 kludge 都以一种以上的形式存在。*很多选择。*^(1.)
2.  还添加了对共享地址空间的多个内核可见进程形式的线程的直接支持。这些[线程很危险且无法测试，](https://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&ved=0CDIQFjAA&url=http://www.eecs.berkeley.edu/Pubs/TechRpts/2006/EECS-2006-1.pdf&ei=pkALUY62IeOsigKfzIDACg&usg=AFQjCNFKbD8gsVjP71jOd1-cFbUiGK96Cw&bvm=bv.41867550,d.cGE)但得到了广泛的支持和使用。大多数情况下，程序不会崩溃。随着时间的推移，随着硬件支持更真实的并发性，潜在的错误变得可见。我一点也不担心 Ruby 不完全支持[那个噩梦。](http://en.wikipedia.org/wiki/Simultaneous_multithreading)

* * *

^(1\. 标准的好处是有这么多。)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:43:24.090

当 MRI 1.9 启动时，它会产生两个本地线程。一个线程用于 VM，另一个用于处理信号。Rubinis 使用这种策略，JVM 也是如此。管道可用于传递来自其他进程的任何信息。

至于`FileUtils`模块，`cd`, `pwd`, `mkdir`, `rm`, `ln`, `cp`, `mv`, `chmod`,`chown`和`touch`方法在某种程度上都是使用`StreamUtils`子模块的内部 API 外包给 OS 本地实用程序的，而第二个线程则等待来自 an 的信号。外部过程。由于这些方法是相当线程安全的，因此无需锁定解释器，因此这些方法不会相互阻塞。

编辑：

> MRI 1.8.7 相当聪明，它知道当 Thread 正在等待一些外部事件（例如浏览器发送 HTTP 请求）时，可以将 Thread 置于睡眠状态，并在检测到数据时将其唤醒。- Evan Phoenix 来自 Engine Yard 的[Ruby、并发和你](https://blog.engineyard.com/2011/ruby-concurrency-and-you)

FileUtils 的实现基本实现从查看源代码来看，1.8.7 并没有太大的改变。1.8.7 还使用休眠定时器线程来等待 IO 响应。1.9 的主要区别在于使用原生线程而不是绿色线程。线程[源代码](https://github.com/ruby/ruby/blob/trunk/thread_pthread.c#L1344-L1395)也更加精致。

线程安全的意思是，由于进程之间没有共享任何内容，因此没有理由锁定全局解释器。有一种误解认为 Ruby 在执行某些任务时会“阻塞”。每当一个线程必须阻塞时，即在不使用任何 cpu 的情况下等待，Ruby 会简单地调度另一个线程。然而，在某些情况下，例如机架服务器使用 20% 的 CPU 等待响应，解锁解释器并允许并发线程在等待期间处理其他请求可能是合适的。从某种意义上说，这些线程是并行工作的。GIL 通过`rb_thread_blocking_region`API 解锁。这是一个关于这个[主题](http://www.spacevatican.org/2012/7/5/whos-afraid-of-the-big-bad-lock/)的好帖子。

# c - free()：fclose 上的下一个大小（正常）无效。但不是在 Valgrind 运行时

> ID：14635945
> 
> 赞同：2
> 
> 时间：2013-01-31T22:00:10.113
> 
> 标签：c, crash, valgrind

下面的代码在`fclose()`通话中中断。

```
void output_gauss_transform(char* filename, char* mode, double** T, 
                            double shift, int len)
{
    FILE* fp;

    printf("Outputting gauss transform to %s.\n", filename);

    if ((fp = fopen(filename, mode)) == NULL){
    perror("Could not open file");
    return;
    }

    int i;

    for (i = 0; i < len; ++i) {
    fprintf(fp, "%lf %lf\n", T[0][i], T[1][i] + shift);
    }

    if (fclose(fp)){
    printf("error closing\n");
    }
} 
```

`glibc`给我这个错误，以及内存映射。

```
*** glibc detected *** [sourcedir]/.libs/lt-launcher: free(): invalid next size (normal): 0x0821da38 ***
======= Backtrace: =========
/lib/i386-linux-gnu/libc.so.6(+0x75ee2)[0xb739dee2]
/lib/i386-linux-gnu/libc.so.6(fclose+0x154)[0xb738d424]
/src/.libs/libfile_util.so.0(output_gauss_transform+0xa9)[0xb77b5859]
/src/.libs/lt-launcher[0x804a0f9]
/src/.libs/lt-launcher[0x804a2a5]
/src/.libs/lt-launcher[0x804983b]
/lib/i386-linux-gnu/libc.so.6(__libc_start_main+0xf3)[0xb73414d3]
/src/.libs/lt-launcher[0x8049915] 
```

尝试使用 进行调试时`valgrind`，我没有收到任何错误，并输出以下内容。到底是怎么回事？

```
==30396== HEAP SUMMARY:
==30396==     in use at exit: 0 bytes in 0 blocks
==30396==   total heap usage: 1,059 allocs, 1,059 frees, 78,149 bytes allocated
==30396== 
==30396== All heap blocks were freed -- no leaks are possible
==30396== 
==30396== For counts of detected and suppressed errors, rerun with: -v
==30396== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 0 from 0) 
```

编辑：运行`valgrind`，`-v`我最后得到了这个东西。也许它与正在发生的事情有关？

```
 --31325-- REDIR: 0x454cac0 (operator delete(void*)) redirected to 0x402bb98 (operator delete(void*)) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-31T22:13:17.023

这段代码是*受害者*，你需要找到肇事者。当你调用时`fclose`，一些结构被释放。此时，代码发现空闲池已损坏并报告错误。但是，破坏空闲池的是其他代码块，而不是这段代码。

此错误的最常见原因是两次释放相同的内存块并在释放内存块后访问它。`valgrind`无法捕捉到这一点很奇怪，因为这些正是它通常捕捉到的那种错误。

# facebook - facebook graph api 错误：请求此资源需要访问令牌

> ID：14635946
> 
> 赞同：2
> 
> 时间：2013-01-31T22:00:18.503
> 
> 标签：facebook, facebook-graph-api

我想通过该应用在 Facebook 上的给定个人资料上发布一个链接。使用 access_token 和其他必要参数发布到[https://graph.facebook.com/PROFILE_ID/links 。](https://graph.facebook.com/PROFILE_ID/links)出于测试目的，我使用 Graph API Explorer 获得了 access_token，并获得了 publish_stream 和 share_item 扩展权限。

然后我得到了错误

```
{
   "error": {
      "message": "An access token is required to request this resource.",
      "type": "OAuthException",
      "code": 104
   }
} 
```

我为 PROFILE_ID 尝试了 fb_id 和 fb_username 但得到了同样的错误。哪里不对了？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T01:10:44.353

是的。`/links`是只读的。要创建链接，您需要 POST 到`/USER_ID/feed`.

[https://developers.facebook.com/docs/reference/api/user/#links](https://developers.facebook.com/docs/reference/api/user/#links)

# mysql - 在不同的表中计算和分组相同的命名列（mysql）

> ID：14635948
> 
> 赞同：0
> 
> 时间：2013-01-31T22:00:20.367
> 
> 标签：mysql

好的，我有两个表：表 1 如下所示：

```
id age gender
1   10   M
2   11   F
3   11   F 
```

表 2 看起来像这样（不同的值相同）：

```
id age gender
1  11   F
2  12   M
3  10   M 
```

现在我希望我的最终输出如下所示：

```
age count
10   2
11   3
12   1 
```

实现这一目标的最有效方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T22:13:10.060

您要聚合联合：

```
select age, count(*)
from (select id, age, gender from table1 union all
      select id, age, gender from table2
     ) t
group by age 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T22:09:20.030

尝试这个

```
select age ,count(age) count from table1 group by age
union
select age, count(age)  count from table2 group by age 
```

# java - Java Layout Proportions：创建可扩展的方形面板

> ID：14635952
> 
> 赞同：2
> 
> 时间：2013-01-31T22:00:42.060
> 
> 标签：java, user-interface, layout

我正在制作一个 GUI 组件来表示窗口中的棋盘之类的东西。通常它将是一个 8x8 方格的网格，尽管有些变体需要 10x8 板等。第一步是制作一个包含 8x8 组件网格的面板。

该类`Board`扩展`JPanel`并使用 a`GridLayout`对 8x8 组件的网格进行建模。为了完成某件事，这些只是`Square`扩展的类`JButton`。问题是它们不是正方形！

已`Board`添加到新实例化`JFrame`、打包并呈现在屏幕上的 . 当然，现在板子在用户调整大小时占据了整个框架。网格与板一起缩放，这会将正方形扭曲成矩形。

这并非完全不受欢迎的行为。我希望电路板与框架一起缩放。但是，我想确保正方形始终保持正方形。该板可以是矩形（10x8），但应保持固定的比例。

我如何获得正方形？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-31T23:08:21.703

You can choose to use a `LayoutManager` that honors the preferred size of the cells instead. `GridLayout` will provide a equal amount of the available space to each cell, which doesn't appear to be quite what you want.

For example, something like `GridBagLayout`

![enter image description here](../Images/d2aa5e7bf879feaa15e69d14edbd95bb.png)

```
public class TestChessBoard {

    public static void main(String[] args) {
        new TestChessBoard();
    }

    public TestChessBoard() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new ChessBoardPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class ChessBoardPane extends JPanel {

        public ChessBoardPane() {
            int index = 0;
            setLayout(new GridBagLayout());
            GridBagConstraints gbc = new GridBagConstraints();
            for (int row = 0; row < 8; row++) {
                for (int col = 0; col < 8; col++) {
                    Color color = index % 2 == 0 ? Color.BLACK : Color.WHITE;
                    gbc.gridx = col;
                    gbc.gridy = row;
                    add(new Cell(color), gbc);
                    index++;
                }
                index++;
            }
        }

    }

    public class Cell extends JButton {

        public Cell(Color background) {

            setContentAreaFilled(false);
            setBorderPainted(false);
            setBackground(background);
            setOpaque(true);

        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(25, 25);
        }

    }

} 
```

**Updated with proportional example**

Now, if you want to do a proportional layout (so that each cell of the grid remains proportional to the other regardless of the available space), things begin to get ... fun ...

![enter image description here](../Images/bf5caaff5fad71c7fc5bc5c55f8baaf0.png)

```
public class TestChessBoard {

    public static void main(String[] args) {
        new TestChessBoard();
    }

    public TestChessBoard() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (Exception ex) {
                }

                JFrame frame = new JFrame("Test");
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.add(new TestChessBoard.ChessBoardPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class ChessBoardPane extends JPanel {

        public ChessBoardPane() {
            int index = 0;
            setLayout(new ChessBoardLayoutManager());
            for (int row = 0; row < 8; row++) {
                for (int col = 0; col < 8; col++) {
                    Color color = index % 2 == 0 ? Color.BLACK : Color.WHITE;
                    add(new TestChessBoard.Cell(color), new Point(col, row));
                    index++;
                }
                index++;
            }
        }
    }

    public class Cell extends JButton {

        public Cell(Color background) {

            setContentAreaFilled(false);
            setBorderPainted(false);
            setBackground(background);
            setOpaque(true);

        }

        @Override
        public Dimension getPreferredSize() {
            return new Dimension(25, 25);
        }
    }

    public class ChessBoardLayoutManager implements LayoutManager2 {

        private Map<Point, Component> mapComps;

        public ChessBoardLayoutManager() {
            mapComps = new HashMap<>(25);
        }

        @Override
        public void addLayoutComponent(Component comp, Object constraints) {
            if (constraints instanceof Point) {

                mapComps.put((Point) constraints, comp);

            } else {

                throw new IllegalArgumentException("ChessBoard constraints must be a Point");

            }
        }

        @Override
        public Dimension maximumLayoutSize(Container target) {
            return preferredLayoutSize(target);
        }

        @Override
        public float getLayoutAlignmentX(Container target) {
            return 0.5f;
        }

        @Override
        public float getLayoutAlignmentY(Container target) {
            return 0.5f;
        }

        @Override
        public void invalidateLayout(Container target) {
        }

        @Override
        public void addLayoutComponent(String name, Component comp) {
        }

        @Override
        public void removeLayoutComponent(Component comp) {
            Point[] keys = mapComps.keySet().toArray(new Point[mapComps.size()]);
            for (Point p : keys) {
                if (mapComps.get(p).equals(comp)) {
                    mapComps.remove(p);
                    break;
                }
            }
        }

        @Override
        public Dimension preferredLayoutSize(Container parent) {
            return new CellGrid(mapComps).getPreferredSize();
        }

        @Override
        public Dimension minimumLayoutSize(Container parent) {
            return preferredLayoutSize(parent);
        }

        @Override
        public void layoutContainer(Container parent) {
            int width = parent.getWidth();
            int height = parent.getHeight();

            int gridSize = Math.min(width, height);

            CellGrid grid = new CellGrid(mapComps);
            int rowCount = grid.getRowCount();
            int columnCount = grid.getColumnCount();

            int cellSize = gridSize / Math.max(rowCount, columnCount);

            int xOffset = (width - (cellSize * columnCount)) / 2;
            int yOffset = (height - (cellSize * rowCount)) / 2;

            Map<Integer, List<CellGrid.Cell>> cellRows = grid.getCellRows();
            for (Integer row : cellRows.keySet()) {
                List<CellGrid.Cell> rows = cellRows.get(row);
                for (CellGrid.Cell cell : rows) {
                    Point p = cell.getPoint();
                    Component comp = cell.getComponent();

                    int x = xOffset + (p.x * cellSize);
                    int y = yOffset + (p.y * cellSize);

                    comp.setLocation(x, y);
                    comp.setSize(cellSize, cellSize);

                }
            }

        }

        public class CellGrid {

            private Dimension prefSize;
            private int cellWidth;
            private int cellHeight;

            private Map<Integer, List<Cell>> mapRows;
            private Map<Integer, List<Cell>> mapCols;

            public CellGrid(Map<Point, Component> mapComps) {
                mapRows = new HashMap<>(25);
                mapCols = new HashMap<>(25);
                for (Point p : mapComps.keySet()) {
                    int row = p.y;
                    int col = p.x;
                    List<Cell> rows = mapRows.get(row);
                    List<Cell> cols = mapCols.get(col);
                    if (rows == null) {
                        rows = new ArrayList<>(25);
                        mapRows.put(row, rows);
                    }
                    if (cols == null) {
                        cols = new ArrayList<>(25);
                        mapCols.put(col, cols);
                    }
                    Cell cell = new Cell(p, mapComps.get(p));
                    rows.add(cell);
                    cols.add(cell);
                }

                int rowCount = mapRows.size();
                int colCount = mapCols.size();

                cellWidth = 0;
                cellHeight = 0;

                for (List<Cell> comps : mapRows.values()) {
                    for (Cell cell : comps) {
                        Component comp = cell.getComponent();
                        cellWidth = Math.max(cellWidth, comp.getPreferredSize().width);
                        cellHeight = Math.max(cellHeight, comp.getPreferredSize().height);
                    }
                }

                int cellSize = Math.max(cellHeight, cellWidth);

                prefSize = new Dimension(cellSize * colCount, cellSize * rowCount);
                System.out.println(prefSize);
            }

            public int getRowCount() {
                return getCellRows().size();
            }

            public int getColumnCount() {
                return getCellColumns().size();
            }

            public Map<Integer, List<Cell>> getCellColumns() {
                return mapCols;
            }

            public Map<Integer, List<Cell>> getCellRows() {
                return mapRows;
            }

            public Dimension getPreferredSize() {
                return prefSize;
            }

            public int getCellHeight() {
                return cellHeight;
            }

            public int getCellWidth() {
                return cellWidth;
            }

            public class Cell {

                private Point point;
                private Component component;

                public Cell(Point p, Component comp) {
                    this.point = p;
                    this.component = comp;
                }

                public Point getPoint() {
                    return point;
                }

                public Component getComponent() {
                    return component;
                }

            }

        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:34:25.517

*这有点长，所以这里是一个快速的答案：*如果用户可以调整它的大小，你不能在给定板尺寸（8x8、10x8）的情况下维护一个带有方形的方形板并完全填满屏幕。您应该限制板子的大小，以便它保持纵横比，即使这意味着您的框架中有一些空白空间。好的，请继续阅读冗长的解释...

有两种方法可以使这项工作。您可以限制 的可能大小`JFrame`，或者您可以限制您的大小，`Board`这样它就不会总是填满框架。限制板的大小是更常见的方法，所以让我们从它开始。

**选项 1：限制董事会**

如果您使用一组固定的棋盘尺寸（8x8、10x8 和其他几个），并假设每个方格都有一些最小尺寸（棋盘上的 1 像素方格听起来不太实用），那么只有如此多的框架尺寸，板可以完全填满。如果您的框架是 80 像素 x 80 像素，那么您的 8x8 板非常适合。但是，一旦用户将大小调整为 85x80 之类的东西，您就会被卡住，因为您无法在保持与您给定的板尺寸相同的正方形的同时完全填充它。

在这种情况下，您希望将 5 个像素留空，无论是高于或低于 5 个，还是高于或低于 2.5 个，或者其他什么，都无所谓。这听起来应该很熟悉 - 这是一个纵横比问题，基本上是为什么您可以根据电视与电影尺寸在电视边缘出现黑条。

**选项 2：限制框架**

如果您希望板子始终完全填满框架，可能不是您想要的，那么您必须在用户调整框架大小后调整框架的大小。假设您使用的是 10x8 板，并且用户将框架设置为 107x75。这还不错，通过一些数学运算，您可以计算出 100x80 是您最接近的有效纵横比，并修复窗口。如果窗口一直在他们身上跳来跳去，这可能会让用户有点沮丧，特别是如果他们试图让它像 50x200 那样偏离。

**最后的想法/示例**

限制董事会很可能是正确的解决方案。从游戏到桌面应用程序的一切都遵循这一原则。以 MS Office 产品中的功能区为例。随着窗口变大，功能区将扩展（保持其比例）直到达到最大尺寸，然后您就可以为文档获得更多空间。当您使窗口变小时，色带会变小（再次保持其比例），直到达到最小尺寸，然后您开始丢失部分窗口（请记住，不要在板上出现 1x1 方块）。

另一方面，您可以完全阻止用户调整窗口大小。我很确定这就是 MineSweeper 的工作方式（不要在这台计算机上仔细检查），并且可能是您需要的更好/更简单的解决方案。

# python - 让 mod_wsgi.so 与 django 一起工作时遇到问题

> ID：14635955
> 
> 赞同：0
> 
> 时间：2013-01-31T22:00:49.150
> 
> 标签：python, django, xampp

我开始学习 django ，我正在尝试建立一个开发环境，如[http://www.venkysblog.com/setup-django-on-windows-with-apache-and-mysql](http://www.venkysblog.com/setup-django-on-windows-with-apache-and-mysql)。我无法使其正常工作，因此我正在向后工作以确保一切正确。

我可以到第 5 步。我已经确认 python 、 xampp 和 django 工作。我使用 phpmyadmin 创建了一个名为 django 的数据库。我已经确认 mysql 和 django 之间的连接使用

```
manage.py syncdb 
```

在第 5 步中，按照我下载正确的 mod_wsgi.so 并将其放入 F:\xampp\apache\modules 文件夹的说明，我已将其添加到 httpd.conf：

```
LoadModule wsgi_module modules/mod_wsgi.so 
```

文章作者指出：

```
Before we move further, copy your Django testProject folder into "C:/wamp/www".
This is not mandatory, but I did this, and the remaining instructions below are based on that. 
```

我无法超越这一点。从这一点我能做些什么来确认 python/django 与 mod_wsgi.so 一起正常工作

提前致谢，

账单

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T08:59:15.883

我不太明白你的问题是什么。你说你不能“越过”作者建议你复制你的 testProject 文件夹的地方。发生什么了？

但是，我必须说这是一个非常非常糟糕的教程。以该复制步骤为例，这不仅是“非强制性的”，而且强烈建议不要这样做。没有充分的理由将您的项目代码放在 web 根目录下，并且有很多理由不这样做：这是一个潜在的安全风险，因为错误配置很容易将您的代码文件暴露给 web，包括您的 settings.py 包含的东西就像您的数据库密码一样。

然而，本教程还有一个更严重的问题。出于开发目的尝试使用 mod_wsgi 进行设置并不是一个好主意，当您刚开始时更是如此。`manage.py runserver`正是出于这个原因，Django 包含了一个开发服务器（

# ios - iOS - 由于未捕获的异常“NSInvalidArgumentException”而终止应用程序

> ID：14635958
> 
> 赞同：0
> 
> 时间：2013-01-31T22:01:09.453
> 
> 标签：ios, objective-c, cocoa-touch

所以我在为 iOS 开发方面真的很新，我一直在尽我所能，寻找答案，调试它以及我能想出的任何东西。

虽然，我还没有找到解决这个问题的办法。

我一直在尝试获取一个外部 JSON 文档，它工作正常，但是在解析它时，它就出错了。

首先，这是我收到的错误消息，全部内容。

```
2013-01-31 22:40:19.261 demodh[6205:c07] View Loaded
2013-01-31 22:40:19.479 demodh[6205:c07] -[__NSCFStringcountByEnumeratingWithState:objects:count:]: unrecognized selector sent to instance 0x7554f90 
2013-01-31 22:40:19.480 demodh[6205:c07] *** Terminating app due to uncaught exception 'NSInvalidArgumentException', reason: '-[__NSCFString countByEnumeratingWithState:objects:count:]: unrecognized selector sent to instance 0x7554f90'
*** First throw call stack:
(0x1c93012 0x10d0e7e 0x1d1e4bd 0x1c82bbc 0x1c8294e 0x28d3 0xbd6589 0xbd4652 0xbd589a 0xbd460d 0xbd4785 0xb21a68 0x4615911 0x4614bb3 0x4652cda 0x1c358fd 0x465335c 0x46532d5 0x453d250 0x1c16f3f 0x1c1696f 0x1c39734 0x1c38f44 0x1c38e1b 0x1bed7e3 0x1bed668 0x14ffc 0x1d6d 0x1c95 0x1)
libc++abi.dylib: terminate called throwing an exception
(lldb) 
```

这是我目前正在使用的代码：

```
- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSDictionary *allDataDictionary = [NSJSONSerialization JSONObjectWithData:webData options:0 error:nil];

    for(NSDictionary *dict in allDataDictionary)
    {
        if (![allDataDictionary isKindOfClass:[NSDictionary class]])
        {
            NSLog(@"2Unable to process temp array because it's an instance of %@", [allDataDictionary class]);
        }
        else
        {
            for(NSDictionary *deal in dict)
            {
                if (![deal isKindOfClass:[NSDictionary class]])
                {
                    NSLog(@"Unable to process temp array because it's an instance of %@", [deal class]);
                }
                else
                {
                    NSString *title = [deal objectForKey:@"title"];
                    NSLog(title);
                }
            }
        }

    }
} 
```

我正在加载的 JSON 是：[链接](http://dealhunter.dk/json)

我希望你能帮助我找到解决方案。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-31T22:08:57.243

问题是你正在快速枚举 a`NSDictionary`并期望得到它的值，而实际上你会得到它的键。当您尝试快速枚举 an时，`NSString`您会得到您所看到的断言。你可能想要这个：

```
for(NSObject *key in allDataDictionary) {
    NSDictionary *dict = allDataDictionary[key];
    ...
    for (NSObject *dealKey in dict) {
         NSDictionary *deal = dict[dealKey];
    }
    ... 
```

或者，如果您真的想枚举值并且不需要键：

```
for(NSDictionary *dict in [allDataDictionary allValues]) {
    ... 
```

# javascript - 如何从 jQuery 中退出这个递归轮询？

> ID：14635963
> 
> 赞同：3
> 
> 时间：2013-01-31T22:01:25.793
> 
> 标签：javascript, jquery, ajax

我之前使用以下 jQuery Ajax 请求每 3 秒从服务器轮询一次使用 Ajax 的问题：

```
function getData() {
    $.ajax({
        url : 'http://example.com',
        type: 'GET',
        success : function(data) {
            // process data here
            setTimeout(getData, 3000);
        },
        dataType : 'json'
    });
} 
```

似乎另一种方法是将 setTimeout 放在 $.ajax() 块之外：

```
function getData() {
    setTimeout( function() {
    $.ajax({
        url : 'http://example.com',
        type: 'GET',
        success : function(data) {
            //process data here
        },
        dataType : 'json'
    }) }, 3000);
} 
```

那么这两种方法有什么区别吗？它们是否具有每 3 秒连续轮询服务器的相同效果？

另外，在成功回调函数中，如果满足某些条件，例如 data.length>1000，我如何终止这个无限轮询，那么我想终止这个循环并调用另一个函数？我应该做这样的事情：

```
function getData() {
        var tID = setTimeout( function() {
        $.ajax({
            url : 'http://example.com',
            type: 'GET',
            success : function(data) {
                //process data here
                if(data.length > 1000) { 
                   funcOutside();
                   clearTimeout(tID);
                }
            },
            dataType : 'json'
        }) }, 3000);
    } 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-31T22:04:47.663

第二个选项不会每 3 秒轮询一次；它只会轮询一次。

要有条件地继续或停止轮询，您应该使用第一个选项的变体：在`setTimeout`调用周围添加条件。

```
function getData() {
    $.ajax({
        url : 'http://example.com',
        type: 'GET',
        success : function(data) {
            // depending on the data, either call setTimeout or simply don't
            if( /* data says continue polling */) {
                setTimeout(getData, 3000);
            }
        },
        dataType : 'json'
    });
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T22:05:42.560

> 那么这两种方法有什么区别吗？它们是否具有每 3 秒连续轮询服务器的相同效果？

是的，有一个重要的区别！第一个版本将*在响应到达后对*函数的调用进行排队。因此，调用之间的间隔将（大约）3000 毫秒加上请求/响应所花费的时间。

第二个版本将在 3 秒后发出请求，然后停止。如果您更改`setTimeout`为`setInterval`，它将每 3 秒发出一个新请求，但不能保证在发出新请求时前一个请求已经完成（如果一个请求需要大约 3000 毫秒）。所以第一个版本可能就是你要找的。

关于终止循环：是的，只需添加一个条件，就像您在代码中的条件一样。但是不要清除超时，只是不要添加一个新的：

```
//process data here
if(data.length > 1000) { 
    funcOutside();
} else {
    setTimeout(getData, 3000);
} 
```

最后一点：从技术上讲，这不是递归，因为它不是在`getData`调用自己，而是一直`setTimeout`调用的回调`getData`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-22T19:44:04.587

```
(function loopsiloop(){
   setTimeout(function(){
   $.ajax({
       url: 'foo.htm',
       success: function( response ){
           // do something with the response

           loopsiloop(); // recurse
       },
       error: function(){
           // do some error handling.  you
           // should probably adjust the timeout
           // here.

           loopsiloop(); // recurse, if you'd like.
       }
   });
   }, 5000);
})(); 
```

这将为您完成工作。我在这里做三件事：

1.  声明一个立即调用的函数 loopsiloop（注意末尾的括号）。
2.  声明超时处理程序在 5 秒后触发。
3.  在超时时间内轮询服务器，无论成功/失败都会调用 loopsiloop 并继续轮询。

# select - Simple.Data 选择特定列

> ID：14635966
> 
> 赞同：1
> 
> 时间：2013-01-31T22:01:30.250
> 
> 标签：select, simple.data

我打电话给 Simple.Data，我想在其中限制要返回的列。但是我遇到了问题..

这工作正常：

```
var db = Database.Open();

var questionIdRow = db.Question.FindByFriendlyId(friendlyId);

if (questionIdRow == null) return Guid.Empty;

return questionIdRow.QuestionId; 
```

但是，以下不起作用（我得到一个`Simple.Data.UnresolvableObjectException`“未找到列”）

```
var db = Database.Open();

var questionIdRow = db.Question.FindByFriendlyId(friendlyId)
                               .Select(db.Question.QuestionId);

if (questionIdRow == null) return Guid.Empty;

return questionIdRow.QuestionId; 
```

Simple.Data 文档给我的印象是，这就是我需要做的所有事情来限制选定的列。请注意，选择只是选择稍后引用的同一列。

实际的异常被抛出就`var questionIdRow =`行了。

**有人可以给我一些指导吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:32:01.677

这是一个常见问题，实际上导致 FindBy 在我们到达 1.0 之前就被弃用了。问题是 FindBy 立即返回一条记录，因此您无法继续对其调用查询方法。

正确的方法是调用 FindAllBy 并以 First 或 FirstOrDefault 结束：

```
var db = Database.Open();

var questionIdRow = db.Question.FindAllByFriendlyId(friendlyId)
                           .Select(db.Question.QuestionId)
                           .FirstOrDefault();

if (questionIdRow == null) return Guid.Empty;

return questionIdRow.QuestionId; 
```

# javascript - 调用 apply 到一个包装的（匿名）函数

> ID：14635969
> 
> 赞同：0
> 
> 时间：2013-01-31T22:01:36.290
> 
> 标签：javascript, closures

这可能是愚蠢的，但我有这样的代码：

```
var f = functionWrapper();
f.apply(this, []);

function functionWrapper() {
    return new function () {
        console.log("Called function");
    }
} 
```

为什么它会崩溃并给出以下错误：

```
Uncaught TypeError: Object [object Object] has no method 'apply' test.html:28(anonymous function) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-31T22:04:52.027

改变这个：

```
 return new function () { 
```

（它立即将函数作为构造函数调用，并返回构造的对象）到此：

```
 return function () { 
```

（返回函数本身）。

# c# - 检查FTP服务器上是否存在目录

> ID：14635970
> 
> 赞同：10
> 
> 时间：2013-01-31T22:01:39.617
> 
> 标签：c#, ftp, ftpwebrequest

我正在检查我的 FTP 服务器上是否存在目录：

```
 public bool DirectoryExists(string directory)
    {
        bool directoryExists;

        var request = (FtpWebRequest)WebRequest.Create(directory);
        request.Method = WebRequestMethods.Ftp.ListDirectory;
        request.Credentials = new NetworkCredential("user", "pass");

        try
        {
            using (request.GetResponse())
            {
                directoryExists = true;
            }
        }
        catch (WebException)
        {
            directoryExists = false;
        }

        return directoryExists;
    } 
```

在这种情况下：

```
directory = @"ftp://ftp.example.com/Rubicon"; 
```

在我的服务器上，我有一个名为`Rubicon1`. 这导致我的支票退回`true`。除非它与目录名称完全匹配，否则如何确保它失败？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-01T16:06:30.163

我通过将目录更改为：

```
directory = @"ftp://ftp.example.com/Rubicon/"; 
```

# google-maps - 谷歌地图中国卫星地图和路线图不对应

> ID：14635984
> 
> 赞同：2
> 
> 时间：2013-01-31T22:02:26.263
> 
> 标签：google-maps

使用 Google Maps JavaScript API 时，Google Maps 的卫星视图和路线图视图不对齐。似乎从一个转移到另一个；也就是说，在卫星视图中显示道路的地方，同一条道路在路线图视图中向右移动了一点。

[直接从maps.google.com](http://maps.google.com)使用 Google 地图时也是如此。是否有针对此问题的程序化修复？这对美国地图来说似乎不是问题，只是中国。

# javascript - 输入：检查 jQuery 和 CSS？

> ID：14635985
> 
> 赞同：0
> 
> 时间：2013-01-31T22:02:27.663
> 
> 标签：javascript, jquery, css

除非我弄错了。jQuery 和 CSS 处理`:checked`选择器的方式非常不同。在我使用的 CSS 中，当`:checked`我单击时会适当地应用样式，但在 jQuery 中，它似乎只识别页面加载时最初在 DOM 中的内容。我错过了什么吗？

这是我的[小提琴](http://jsfiddle.net/cssguru/8rDXd/)

在 jQuery 中：

```
$('input:checked').click(function () { 
   $('input:checked').css('background','#FF0000');
   $('input:checked+label').css('background','#ff0000');
}); 
```

在 CSS 中：

```
input:checked+label {font-weight:bold;color:#5EAF1E} 
```

**更新：** 我应该澄清一下，如果用户单击已选择的单选按钮，我要做的是触发行为。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-31T22:04:53.120

尝试以这种方式设置处理程序：

```
$('body').on('click', 'input:checked', function() {
  // ...
}); 
```

按照您的方式，您将找到*在该代码运行时*检查的所有元素。以上使用事件冒泡，以便在每次“点击”发生时进行测试。

在您的处理程序中，您正在更新*所有*选中元素的样式，即使任何特定的点击只会改变一个。如果复选框的数量不是太大，这不是什么大问题。

*编辑*——一些进一步的思考和一个有用的后续问题，让我意识到在单选按钮“单击”事件的事件处理程序中，该按钮将*始终*为“：选中”。“checked”属性的值在事件被调度之前由浏览器更新。（如果事件的默认操作被阻止，则将被逆转。）

我认为有必要添加一个类或使用`.data()`来跟踪“已检查”属性的阴影。单击按钮时，您会看到是否设置了自己的标志；如果是这样，这意味着该按钮是在被点击之前设置的。如果没有，则设置标志。您还需要清除所有同名单选按钮的标志。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-31T22:06:07.963

您仅将事件绑定到最初检查的输入。从第一个选择器中删除`:checked`，它可以按预期工作（但很难看。）

[http://jsfiddle.net/8rDXd/19/](http://jsfiddle.net/8rDXd/19/)

```
$('input').click(function () { 
    $('input:checked').css('background','#FF0000');
    $('input:checked+label').css('background','#ff0000');
}); 
```

您当然需要“撤消”您使用 jQuery 所做的 css 更改，以使其在未选中输入时消失。

```
$('input').click(function () { 
    $('input').css('background','').filter(":checked").css('background','#FF0000');
    $('input+label').css('background','');
    $('input:checked+label').css('background','#ff0000');
}); 
```

[http://jsfiddle.net/8rDXd/20/](http://jsfiddle.net/8rDXd/20/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-31T22:15:22.950

## 更新后

跟踪单选按钮的状态。例如，用于`.data()`保持单选按钮的内存状态。

```
$(function () {
    var $radio = $(":radio");
    $radio.filter(":checked").data("checked", true);
    $radio.on("click", function () {
        if ($(this).data("checked")) {
            alert("Already selected");
        }
        $radio.data("checked", false).filter(":checked").data("checked", true);
    });
}); 
```

[看到它住在这里。](http://jsfiddle.net/hDKXF/)

* * *

## 更新前

我想你想在`.change()`这里使用。

```
$('input:radio').change(function () {
    $('input, input+label').css('background', '');
    $('input:checked, input:checked+label').css('background', '#f00');
}).change(); 
```

~~[看到它住在这里。](http://jsfiddle.net/BWQED/)~~

# .net - Office 互操作和设置项目

> ID：14635990
> 
> 赞同：1
> 
> 时间：2013-01-31T22:03:00.537
> 
> 标签：.net, interop, setup-project

我创建了 XBAP 应用程序，它使用 Office 互操作（Interop.Word.dll、Office.dll 等）。我想知道是否可以在不违反 Microsoft 许可协议的情况下将此 dll 包含到我提供给客户的应用程序设置项目中。

PS。对不起我的英语不好。

谢谢你的帮助。

# python - 简单定义函数 Python 27

> ID：14635992
> 
> 赞同：0
> 
> 时间：2013-01-31T22:03:04.813
> 
> 标签：python, function, python-2.7

我正在编写一个对列表中的每个元素进行平方的函数。

```
def square(num):
    for i in range(len(num)):
        square[i] = square[i] ** 2

def action():
    nums = [2, 3, 4]
    print square(nums)

action() 
```

它返回一个错误：

```
 square[i] = square[i] ** 2
TypeError: 'function' object has no attribute `__getitem__`. 
```

想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T22:06:34.123

在您的`square`函数中，您将函数称为列表：

```
def square(num):
    for i in range(len(num)):
        square[i] = square[i] ** 2 
```

因为`square`不是列表，Python 尝试`i`使用该`__getitem__`方法向它询问项目，但这也不存在。

也许您打算`num`改用？

```
def square(num):
    for i in range(len(num)):
        num[i] = num[i] ** 2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-31T23:16:27.580

以Martijn的回答为基础：

```
def square(seq):
    for index in range(len(seq)):
        seq[index] = seq[index] ** 2
    return seq # this gives the output of the function 
```

请参阅：[Python 中的“返回”](http://docs.python.org/2/reference/simple_stmts.html#the-return-statement)。

另一种方法（使用单行列表理解）：

```
def square(seq): return [x**2 for x in seq] 
```

有关列表推导，请参阅：[Python 列表推导](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-24T22:31:49.813

您不能将 [] 用于函数，它用于列表或字典。

```
def square(num):
    l= [None] * len(num)
    for i in range(len(num)):
        l[i] = num[i] ** 2
    return l 
```

# ajax - 不支持 Primefaces Ajax ItemSelect 事件

> ID：14635994
> 
> 赞同：0
> 
> 时间：2013-01-31T22:03:18.263
> 
> 标签：ajax, jsf, primefaces

我在对话框中有一个 pieChart。当我单击 pieChart 上的一个饼图时，我应该能够像[示例一样获取饼图的索引。](http://www.primefaces.org/showcase-labs/ui/interactiveCharts.jsf). 但是，我收到此错误：

> ```
> <p:ajax> Event:itemSelect is not supported. 
> ```

这是我使用的代码：

```
 <p:dialog widgetVar="pieCharts" dynamic="true" id="pieCharts" closable="true" draggable="true" minimizable="true">
           <p:outputPanel autoUpdate="true" >
                  <h:form prependId="false">  
                                <p:pieChart id="typePie" value="#{browse.typePie}" legendPosition="e" fill="false" showDataLabels="true" sliceMargin="2"
                                            title="Type" style="width:400px;height:300px"/>   

                                <p:ajax event="itemSelect" listener="#{browse.createPieForFamily}" />
                  </h:form>
           </p:outputPanel>
 </p:dialog> 
```

我该如何解决这个不受支持的错误？

注意：我使用 primefaces 3.5RC1 版本。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-31T23:42:56.243

将您的 p:ajax 放入 p:pieChart

```
<p:dialog widgetVar="pieCharts" dynamic="true" id="pieCharts" closable="true" draggable="true" minimizable="true">
   <p:outputPanel autoUpdate="true" >
       <h:form prependId="false">  
           <p:pieChart id="typePie" value="#{browse.typePie}" legendPosition="e" fill="false" showDataLabels="true" sliceMargin="2" title="Type" style="width:400px;height:300px">
                <p:ajax event="itemSelect" listener="#{browse.createPieForFamily}" />
            </p:pieChart>
        </h:form>
    </p:outputPanel>
</p:dialog> 
```

# powershell - 将 Powershell 脚本作为计划任务运行

> ID：14635995
> 
> 赞同：0
> 
> 时间：2013-01-31T22:03:20.437
> 
> 标签：powershell, scripting, ms-word, taskmanager

我正在使用`powershell`下面的脚本打开几个 word 文档，更新其中的表单字段，然后关闭它们。首先，我要注意，如果这个脚本是从命令行运行的，或者通过右键单击文件并选择`Run with Powershell`基本上以任何方式手动执行，它将执行得很好。但是，如果我尝试将此作为计划任务运行，则会发生两件事之一。

我为此尝试了几种不同形式的语法，但都产生了相同的两个结果之一。A）脚本说它开始并在大约 3 秒内完成而没有做任何事情，或者 B）脚本开始，我可以看到 Word 在任务管理器中打开，但是没有像正常情况那样显示进度的命令窗口，而 Word 只是大约2分钟后挂断。真正让我选择选项 B 的唯一语法是把`powershell`.\Script1.ps1 作为参数，将文件夹作为起始位置。我尝试了这种语法的一些细微变化，例如使用 的完整路径`powershell`等。当我在任务管理器中结束 Word 时它挂起时，计划任务说它已成功完成。有人有想法么？脚本如下：

```
 $filearray = 1..12
    $filename="E:\Form0801"
    $word=new-object -com Word.Application
    $word.Visible=$False            #Making this true 
    #does not show word if run from scheduled task
    Write-Host "DO NOT CLOSE THIS WINDOW!"

    try
    {
    foreach ($i in $filearray)
    {
        if($i -lt 10){$filename="E:\Form080" + $i + ".dot"}
        else{$filename="E:\Form08" + $i + ".dot"}
        $doc=$word.Documents.Open($filename)
        $word.ActiveDocument.Fields.Update()
        $doc.SaveAs([REF]$filename)
        $doc.Close()
        Write-Host "File " $filename " has been updated successfully"
    }

    }
    catch [System.Management.Automation.ActionPreferenceStopException] 
    {
        "A problem occurred while opening one of the files."
        $error[0]
    }

$word.Quit()
# End Word Application 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-01T20:13:47.323

弄清楚了。我什至没有想过在 32 和 64 版本的 powershell 中设置执行策略。当手动运行它时，它正在使用一个，而通过计划任务运行它正在使用另一个。一旦我确定两者都设置好了，一切都很好。谢谢大家的回复。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-01T10:20:44.333

保持脚本不变，然后从 Powershell 命令行尝试以下操作。

```
$Schedule = "schtasks /CREATE /TN 'Word Doc' /SC WEEKLY /RL HIGHEST /TR powershell 'C:\temp\Script1.ps1' /F"
$Start = "schtasks /RUN /TN 'Word Doc'"
$Schedule = [ScriptBlock]::Create($Schedule)
$Start = [ScriptBlock]::Create($Start)
Invoke-Command -ScriptBlock $Schedule
Invoke-Command -ScriptBlock $Start 
```

这将创建一个每周任务，最后一行将立即执行计划任务，以便您测试它是否有效。如果是这样，那么您可以修改 $Schedule 以匹配您需要的开始时间。

我找不到从 schtasks 命令行使用两个不同日期运行任务的方法，但我找到了如下解决方法：

1) 创建以下 XML，其中包含时间定义：

```
 <?xml version="1.0" encoding="UTF-16"?>
<Task version="1.2" xmlns="http://schemas.microsoft.com/windows/2004/02/mit/task">
  <Triggers>
    <CalendarTrigger>
      <StartBoundary>2013-02-01T00:00:00</StartBoundary>
      <Enabled>true</Enabled>
      <ScheduleByDay>
        <DaysInterval>1</DaysInterval>
      </ScheduleByDay>
    </CalendarTrigger>
    <CalendarTrigger>
      <StartBoundary>2013-02-01T05:30:00</StartBoundary>
      <Enabled>true</Enabled>
      <ScheduleByDay>
        <DaysInterval>1</DaysInterval>
      </ScheduleByDay>
    </CalendarTrigger>
  </Triggers>
  <Actions Context="Author">
    <Exec>
      <Command>powershell</Command>
      <Arguments>C:\temp\Script1.ps1</Arguments>
    </Exec>
  </Actions>
</Task> 
```

2) 设置 $Schedule 变量如下：

```
$Schedule = "schtasks /CREATE /XML 'C:\temp\Word Doc.xml' /TN 'Word Doc'" 
```

确保在需要的地方更改值以反映正确的文件名。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-01T10:26:57.723

你确定你的脚本不仅仅是因为你的shell内存不足而失败了吗？您可以通过以下方式增加它：

```
 Set-item wsman:localhost\Shell\MaxMemoryPerShellMB 512 
```

我们遇到了具有诸如您这样的问题的脚本的问题，因此它总是值得一试。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T03:19:54.293

请使用 Write-Host 注释每一行，并尝试使用计划任务运行此 powershell。使用计划任务管理器时出现写入主机错误。

```
 $filearray = 1..12
    $filename="E:\Form0801"
    $word=new-object -com Word.Application
    $word.Visible=$False            #Making this true 
    #does not show word if run from scheduled task
    #Write-Host "DO NOT CLOSE THIS WINDOW!"

    try
    {
    foreach ($i in $filearray)
    {
        if($i -lt 10){$filename="E:\Form080" + $i + ".dot"}
        else{$filename="E:\Form08" + $i + ".dot"}
        $doc=$word.Documents.Open($filename)
        $word.ActiveDocument.Fields.Update()
        $doc.SaveAs([REF]$filename)
        $doc.Close()
        #Write-Host "File " $filename " has been updated successfully"
    }

    }
    catch [System.Management.Automation.ActionPreferenceStopException] 
    {
        "A problem occurred while opening one of the files."
        $error[0]
    }

$word.Quit()
# End Word Application 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-01T12:59:36.120

听起来您想在脚本运行时查看它的进度，但如果这不重要，您可以尝试创建一个 .vbs 脚本并运行它。

```
command = "powershell.exe -command C:\test\C:\temp\Script1.ps1"
set shell = CreateObject("WScript.Shell")
shell.Run command,0
Set WinScriptHost = Nothing 
```

# java - 在资源路径中找不到 JNA 本机支持 (/com/sun/jna/linux-arm/libjnidispatch.so)

> ID：14635999
> 
> 赞同：7
> 
> 时间：2013-01-31T22:03:41.703
> 
> 标签：java, jna, raspberry-pi

我已经开始构建一个包含 JNA 来加载本机 C/C++ 库的 java 服务，我想在 Raspberry PI aka arm 平台上运行 java 服务。我已经成功地建立了一个稳定的服务基础，它可以在 Windows7 和 linux-amd64/debian 上运行，但是.. 在 RPI 平台上，我收到上述错误：线程“main”中的异常 java.lang.UnsatisfiedLinkError: JNA native在资源路径中找不到支持 (/com/sun/jna/linux-arm/libjnidispatch.so)

在 RPI 上，我做了以下工作： * 安装了带有 arm 硬浮点支持的 openjdk7 和 java8 beta。* 安装 libjna-java 库。

设置如下：

**爪哇**

```
root@pisces:/opt/TellstickReplay# java -version
java version "1.8.0-ea"
Java(TM) SE Runtime Environment (build 1.8.0-ea-b36e)
Java HotSpot(TM) Client VM (build 25.0-b04, mixed mode)
root@pisces:/opt/TellstickReplay# 
```

**LD_LIBRARY_PATH**

```
root@pisces:/opt/TellstickReplay# echo $LD_LIBRARY_PATH
/opt/lib/jna 
```

**类路径**

```
root@pisces:/opt/TellstickReplay# echo $CLASSPATH
/usr/lib/jna 
```

这些设置似乎都不能满足 JNA 支持的 JAVA。我什至尝试将 jna.jar 和 linux-arm.jar 都导出到 Eclipse 中的项目中，然后一起将 jar 重新构建到导出的 jar 中，但仍然出现相同的错误。导出的 jar 已在 windows 和 linux 上成功测试，因此 jar 文件可以正常工作。

我也尝试在 jar 文件的 Manifest 中使用 CLASSPATH，但没有成功。我还尝试从绝对路径显式加载 libjnidispatch.so，但 JAVA 然后开始抱怨它无法找到 libjnidispatch.so 的文件，即使路径是 100% 正确的。

那么.. 有谁知道如何在 Raspberry PI 平台上正确获得 JNA 支持才能正常工作？拜托，我非常沮丧，很快就放弃了解决这个问题的希望..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-01T16:16:22.433

您系统上的 libjnidispatch.so 在哪里？如果它不在您的系统上，JNA 将尝试从指定资源路径的 jna.jar 中解压它。如果它也不存在，您将获得`UnsatisfiedLinkError`.

建议您尽可能在系统上显式安装 libjnidispatch.so；jna.jar 捆绑主要是为了方便在更常见的桌面平台上使用。

`linux-arm.jar`包含 libjnidispatch.so 的最新版本，但只有 WebStart 知道如何从这样的 jar 中自动加载本机。如果将其解压缩到 /opt/lib/jna（或 LD_LIBRARY_PATH 上的其他位置），则应避免链接错误。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-11T18:28:53.397

我正在为 RPI2 重新编译[Apache Spark](https://spark.apache.org/)，我花了几天时间来解决这个问题。然后我找到了最简单的解决方案。您只需要在默认 JVM 的本机 lib 路径中添加一个 libjnidispatch.so 链接。

```
sudo -s ln -s /usr/lib/arm-linux-gnueabihf/jni/libjnidispatch.so /usr/lib/jvm/default-java/jre/lib/arm/libjnidispatch.so 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-01-16T00:16:20.523

我打包了新的 jna.jar (4.0)，它包括 linux-arm/libjnidispatch.so。我试图运行的代码现在可以工作了。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-01T00:17:58.293

我会说它更多的是“您使用的操作系统中“libjnidispatch.so”的位置配置故障或特定的JRE系统内部文件夹/包/JNDI结构，它可能不是相同布局的Debian或Java JRE。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-08-31T22:51:14.847

我执行以下操作：

1.  sudo apt-get 安装 libjna-java
2.  获取安装的jar /usr/share/java/jna.jar
3.  将 jna.jar 安装为 maven 依赖项

他们对我工作...