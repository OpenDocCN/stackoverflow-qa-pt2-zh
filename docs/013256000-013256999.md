# StackOverflow 问答 13256000-13256999

# c# - 如何使用 FakeItEasy 访问 Returns() 中的参数值？

> ID：13256001
> 
> 赞同：28
> 
> 时间：2012-11-06T17:12:41.050
> 
> 标签：c#, fakeiteasy

我有一个用于创建一些数据对象的工厂的接口。

```
interface IFactory
{
    IData Create (string name, string data);
}

interface IData
{
    // ....
}

class Data : IData
{
    public Data (string name, string data)
    {
        // .....
    }
} 
```

我需要创建一个模拟工厂来传递给另一个模块，这个模块将使用这个模拟来创建数据。

举个简单的例子，一个简单的模块如下所示：

```
class QuickModule
{
    private readonly IFactory _factory;

    public QuickModule (IFactory factory)
    {
        _factory = factory;
    }

    public IEnumerable<IData> GetData ()
    {
        yield return _factory.Create ("name1", "abc");
        yield return _factory.Create ("name2", "def");
    }
} 
```

因此，使用两组参数调用工厂两次。

使用起订量，这很容易：

```
var factoryMock = new Mock<IFactory> ();
factoryMock.Setup (x => x.Create (It.IsAny<string> (), It.IsAny<string> ()))
                    .Returns ((string name, string data) => new Data (name, data));
var module = new QuickModule (factoryMock.Object);
var list = module.GetData (); 
```

然而，使用 FakeItEasy 这似乎是不可能的：

```
var factory = A.Fake<IFactory> ();
A.CallTo (() => factory.Create (A<string>.Ignored, A<string>.Ignored))
              .Returns (new Data (???, ???));
var module = new QuickModule (factory);
var list = module.GetData (); 
```

如何访问参数值？

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-11-06T17:29:00.350

好的，看来 ReturnsLazily() 是答案。

所以这就是我所做的：

```
var factory = A.Fake<IFactory> ();
A.CallTo (() => factory.Create (A<string>.Ignored, A<string>.Ignored))
              .ReturnsLazily ((string name, string data) => new Data (name, data));
var module = new QuickModule (factory);
var list = module.GetData (); 
```

这是推荐的方式还是有其他方式？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2017-06-09T22:32:17.737

以下是如何返回传递给方法的对象。

```
ManufacturedPart inputPart;

A.CallTo(() => partRepo.InsertPart(A<ManufacturedPart>._))
  .ReturnsLazily(x => inputPart = x.Arguments.Get<ManufacturedPart>("part")); 
```

# android - Titanium - Android 模拟器 - INSTALL_FAILED_MISSING_SHARED_LIBRARY

> ID：13256004
> 
> 赞同：1
> 
> 时间：2012-11-06T17:12:43.980
> 
> 标签：android, google-maps, sdk, titanium

我在 Titanium 中创建了一个应用程序，它在 iPhone 模拟器上运行，但我无法让它在 Android 模拟器上运行。

我认为问题与 Google 地图有关，Java 报告该类未找到。

模拟器使用包含 Google Maps API 的目标 Google API（API 级别 16）。

这是带有 Google 地图的 Titanium 应用程序的正确目标吗，是否需要其他一些设置？

例如在您的 Tiapp.xml

```
<uses-library android:name="com.google.android.maps"/> 
```

我将 Windows 7 用于 Android 版本。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T14:28:54.387

您是在安装 Android SDK 的特定部分还是整个东西？我找不到以前在哪里找到的，但请确保为目标安装了所有组件，看看是否适合您。这个错误很烦人，它并没有准确地告诉你为什么它没有安装或者它缺少哪一部分。

# java - 运行时执行更改路径

> ID：13256016
> 
> 赞同：1
> 
> 时间：2012-11-06T17:13:05.943
> 
> 标签：java, runtime, exec

我需要在运行时启动另一个 Java 程序，这是我的代码

```
 try {
                                 String cmd2 = "java -jar c:\\test\\deploy\\framework_e_app.jar";

                                 Process p = Runtime.getRuntime().exec(cmd2);  
                                 BufferedReader in = new BufferedReader(  
                                                     new InputStreamReader(p.getInputStream()));  
                                 String line = null;  
                                 while ((line = in.readLine()) != null) {  
                                         System.out.print("<STDOUT>");
                                     System.out.print(line);
                                     System.out.println("</STDOUT>");
                                 }  

                                 InputStream stderr = p.getErrorStream();
                                 InputStreamReader isr = new InputStreamReader(stderr);
                                 BufferedReader br = new BufferedReader(isr);
                                 String line2 = null;
                                 System.out.print("<STDERROR>");
                                 while ( (line2 = br.readLine()) != null)
                                     System.out.print(line2);
                                 System.out.println("</STDERROR>");

                         } catch (IOException e) {  
                             e.printStackTrace();  
                         } 
```

这是我让它工作的唯一方法，但它很烦人，因为它在当前路径中搜索配置文件。

我尝试将其用作 cmd2：

```
String[] cmd2 = new String[4];
cmd2[0] = "cmd";
cmd2[1] = "/C";
cmd2[2] = "cd test\\deploy";
cmd2[3] = "java -jar framework_e_app.jar"; 
```

**我无法进行目录更改。**什么是正确的语法？（显然，我在 Windows 环境中）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:32:40.013

cd 不粘。每个命令在不同的进程中执行。使用具有工作目录的 exec 形式，例如 http://docs.oracle.com/javase/7/docs/api/java/lang/Runtime.html#exec%28java.lang.String[],%20java。 lang.String[],%20java.io.File%29

# java - 获取列表中的对象 using the equals method? how to get a specific java object from java.util.List using equals method exemple : Class Person{ String name; 问问题 问问题 2012-11-06T17:13:23.610 3879 次 This question shows research effort; it is useful and clear 1 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. how to get a specific java object from java.util.List using equals method exemple : Class Person{ String name; int age; //... @Override public boolean equals(String str) { return (this.name.equals(str.name)); } } main{ List <person>list = personDao.findAll(); if(list.contain("joe")){ // how to get the Person named joe ???? } } MySQL Select AND OR I'm not having success with my query statement and I think it has to do with the way I'm executing it. $query5 = "select * from ".$db_prefix."customer_det where (fname = '".$fname."' and lname = '".$lname."') or phone = '".$phone."'"; Essentially I want to select all from customer_det when the first and last name match the posted first and last name. If there's no posted first and last name, then I want it to select all where the posted phone number matches. My three variables $fname, $lname, and $phone are all set to read from the previous form $_POST['fname']; etc... Is this the right logic to be using? java 4 6 回答 6 This answer is useful 3 如果您想获得对列表中特定人员的引用： Person foo = null; for (Person p : list) { if (p.getName().equals("joe")) { foo = p; break; } } // now foo is your person (if he exists) or null (if he doesnt exist); 这只会找到第一个名为 joe 的人。 于 2012-11-06T17:15:31.533 回答 This answer is useful 2 您的 Person.equals() 方法的签名不正确...参数类型应始终为“对象”，如下所示： @Override public boolean equals(Object obj) { return (obj instanceof Person) && ((Person) obj).name.equals(this.name); } 然后 jlordoless 使用 list.contains(new Person("name") 的建议将起作用。 于 2012-11-06T17:18:49.130 回答 This answer is useful 2 简单地迭代。接口上没有List从列表中返回对象的方法。 Person joe = null; List <person>persons = personDao.findAll(); for (Person thisPerson : persons) { if ("joe".equals(thisPerson.getName())) { joe = thisPerson; break; } } 这将设置Person joe为名为 joe的第一个人。如果您要查找集合中的最后一个，请删除该break语句。 于 2012-11-06T17:21:07.003 回答 This answer is useful 1 我认为你在这里有一个设计缺陷。如果有 2 个 joe-s 会发生什么？ 如果您没有重复的名称，您可以为以下名称创建一个 getter Person： public String getName() { return name; } 之后你可以这样做： Person joe = null; for(Person person : list) { if("joe".equals(person.getName()) { joe = person; break; } } 这样可以避免创建不必要的Person. 于 2012-11-06T17:20:37.660 回答 This answer is useful 1 你不应该这样使用equals。覆盖equals有些复杂，hashcode例如，您也必须覆盖。具有最小更改的基于列表的解决方案： Class Person{ String name; int age; //... public String getName() { return name; } } main { List <person>list = personDao.findAll(); Person foundPerson = null; for(Person person : list) { if (person.getName().equals("joe")) { foundPerson = person; break; } } if (foundPerson != null) { // do something } } 但是，我会考虑使用Map<string, person="">, 名称作为键。在忽略equals年龄的情况下压倒一切听起来不太好，真的。 于 2012-11-06T17:24:42.000 回答 This answer is useful 0 @Hyde：无法回答您的答案。当且仅当使用散列时，才需要覆盖“hashCode”。如果人们想使用 HashMap 或 Hashing 相关的其他 API，那么他必须重写 hashCode 和 equals...否则“equals”可以正常工作。 于 2012-11-06T18:13:19.963 回答 Related 7 jquery - 在选择选项上绑定点击事件 2 vba - 在一个函数或子例程中定义多个 VBA 对象？ 0 visual-studio - Visual Studio 2012 中的测试菜单 0 c++ - Qt OpenCv“VIDIOC_QUERYCTRL：输入/输出错误”导致应用程序关闭 3 generator - 从噪声发生器中确定稀有值？（也就是我的世界如何放置矿石） 1 spring - 从日志记录附加程序类访问spring bean 1 php - 输入和上传的不匹配方法？ 1 knockout.js - 带有 HTML 到 PDF 转换器的 Knockout JS 1 javascript - 如何自动刷新jqgrid？ 7 php - 在我的页面中打印 HTML 关闭标记 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：13256017
> 
> 赞同：1
> 
> 时间：
> 
> 标签：java

how to get a specific `java` object from `java.util.List<Object>` using `equals` method exemple :

```
 Class Person{
       String name;
       int age;
       //...

       @Override
       public boolean equals(String str) {
            return (this.name.equals(str.name));
       }
    }

main{
   List<Person> list = personDao.findAll();

   if(list.contain("joe")){
      // how to get the Person named joe ????
   }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:15:31.533

如果您想获得对列表中特定人员的引用：

```
Person foo = null;
for (Person p : list) {
    if (p.getName().equals("joe")) {
        foo = p;
        break;
    }
}
// now foo is your person (if he exists) or null (if he doesnt exist); 
```

这只会找到第一个名为 joe 的人。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T17:18:49.130

您的 Person.equals() 方法的签名不正确...参数类型应始终为“对象”，如下所示：

```
@Override
public boolean equals(Object obj) {
    return (obj instanceof Person) && ((Person) obj).name.equals(this.name);
} 
```

然后 jlordoless 使用 list.contains(new Person("name") 的建议将起作用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T17:21:07.003

简单地迭代。接口上没有`List`从列表中返回对象的方法。

```
Person joe = null;
List<Person> persons = personDao.findAll();
for (Person thisPerson : persons) {
  if ("joe".equals(thisPerson.getName())) {
     joe = thisPerson;
     break;
  }
} 
```

这将设置`Person joe`为名为 joe的*第一个人。*如果您要查找集合中的*最后*一个，请删除该`break`语句。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T17:20:37.660

我认为你在这里有一个设计缺陷。如果有 2 个 joe-s 会发生什么？

如果您没有重复的名称，您可以为以下名称创建一个 getter `Person`：

```
public String getName() {
    return name;
} 
```

之后你可以这样做：

```
Person joe = null;
for(Person person : list) {
    if("joe".equals(person.getName()) {
        joe = person;
        break;
    }
} 
```

这样可以避免创建不必要的`Person`.

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T17:24:42.000

你不应该这样使用equals。覆盖`equals`有些复杂，`hashcode`例如，您也必须覆盖。具有最小更改的基于列表的解决方案：

```
Class Person{
   String name;
   int age;
   //...

   public String getName() {
        return name;
   }
}

main {
   List<Person> list = personDao.findAll();

   Person foundPerson = null;
   for(Person person : list) {
       if (person.getName().equals("joe")) {
           foundPerson = person;
           break;
       }
   }

   if (foundPerson != null) {
       // do something
   }
} 
```

但是，我会考虑使用`Map<String, Person>`, 名称作为键。在忽略`equals`年龄的情况下压倒一切听起来不太好，真的。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T18:13:19.963

@Hyde：无法回答您的答案。当且仅当使用散列时，才需要覆盖“hashCode”。如果人们想使用 HashMap 或 Hashing 相关的其他 API，那么他必须重写 hashCode 和 equals...否则“equals”可以正常工作。</string,></person></person></person>

# android - 如何实现水平滚动视图的点击监听器

> ID：13256019
> 
> 赞同：1
> 
> 时间：2012-11-06T17:13:27.673
> 
> 标签：android, android-layout

我已经实现了 Horizo​​ntalScrollView 来显示图像。但我无法找到实现 onclick 侦听器的方法，以便在 Horizo​​ntalScrollView 上单击特定图像。

我已经在 imageview 1 上实现了 onclick，我也在调用 imageview 期间设置了 ID，但在 toast 消息上它只显示“14”..

任何人请帮助我

**更新**

感谢山姆，他指出了错误；现在我想在每个图像下方显示文本。所以我正在尝试实现相对布局和以下代码，但它不起作用。

这是我的代码

```
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.cfragment, container, false);
    }
@Override
public void onStart() {
    super.onStart();
    /** Setting the multiselect choice mode for the listview */
    initfrag();
}
private void initfrag() {
    RelativeLayout layout = new RelativeLayout(getActivity());
     TextView tv1 = new TextView(getActivity());
     tv1.setText("xyzxyzyxyzxyz"); tv1.setId(1);
     TextView tv2 = new TextView(getActivity());
     tv2.setText("xyzxyzyxyzxyz");tv2.setId(2);
     RelativeLayout.LayoutParams lp = new RelativeLayout.LayoutParams(
             RelativeLayout.LayoutParams.WRAP_CONTENT, RelativeLayout.LayoutParams.FILL_PARENT);
     lp.addRule(RelativeLayout.BELOW, tv1.getId());
     layout.addView(tv1);        
     layout.addView(tv2, lp);
    final LinearLayout linearlayout1 = (LinearLayout)getView().findViewById(R.id.container);
    LinearLayout linearlayout2 = (LinearLayout)getView().findViewById(R.id.container2);
    LinearLayout linearlayout3 = (LinearLayout)getView().findViewById(R.id.container3);
    for (int i = 0; i < 15; i++) { 
        iv = new ImageView(getActivity());
        iv.setPadding(20, 5, 5, 5);
        iv.setId(i);
         iv.setImageResource(R.drawable.test_play_image);
         linearlayout1.addView(iv, 200, 220);
         ImageView iv2 = new ImageView(getActivity());
         iv2.setPadding(20, 5, 5, 5);
         iv2.setImageResource(R.drawable.test_play_image);
         linearlayout2.addView(iv2, 200, 220);

         ImageView iv3 = new ImageView(getActivity());
            iv3.setPadding(20, 5, 5, 5);
             iv3.setImageResource(R.drawable.test_play_image);
             linearlayout3.addView(iv3, 200, 220);
             iv.setOnClickListener(new OnClickListener() {
                public void onClick(View v) {
                    // TODO Auto-generated method stub
                    int s =iv.getId();
                    Toast t = Toast.makeText(getActivity(), "id is "+s, Toast.LENGTH_SHORT);
                    t.show();
                }
            }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:20:49.640

您想获取刚刚单击的视图的 id，而不是循环中创建的最后一个视图。因此，只需将 OnClickListener 中的变量从`iv`：

```
int s =iv.getId(); 
```

到`v`，视图传递给`onClick()`：

```
int s = v.getId(); 
```

# ruby-on-rails - Rails：在部署 Rails 应用程序之前要采取的步骤（例如将数据库更改为 postgres 等）？

> ID：13256023
> 
> 赞同：-2
> 
> 时间：2012-11-06T17:13:41.183
> 
> 标签：ruby-on-rails

嗨，我即将部署我制作的 Rails 应用程序（在 heroku 上），并想知道程序是什么。我知道你必须通过更改来更改数据库，`gem 'sqlite3'`但是`gem 'pg'`在我这样做并继续我的 localhost:3000 之后它给了我错误：

`ActiveRecord::ConnectionNotEstablished`

我还缺少什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:40:12.410

你不需要改变宝石。heroku 默认应用程序中使用的数据库是 postgres。保留`gem 'sqlite3'`并将其添加到您的 Gemfile 中：

```
group :production do
  gem "pg", "0.14.0"
end 
```

# sql-server - 存储过程 ENCRYPTION 选项取决于构建模式

> ID：13256026
> 
> 赞同：5
> 
> 时间：2012-11-06T17:13:50.657
> 
> 标签：sql-server, visual-studio, encryption, msbuild, sql-server-data-tools

我正在研究企业项目中的存储过程加密。我们有一堆 SP 应该在生产中受到保护。在中的每个 SP 中设置参数
是没有问题的。但我想将此指令设为可选：如果我在调试模式下构建项目 - 不要应用此过程选项，否则 - 使用它。实际上这里的主要目标是在没有加密的情况下为开发人员获取数据库，但在生产 - 加密的 SP 上。 在构建任务中使用脚本我可以修改生成的 sql 文件并因此获取带有加密参数的脚本，但我想知道它如何与. 有什么建议么？`WITH ENCRYPTION``sqlproj`
`PowerShell``dacpac`

**更新：**

玩了一段时间后`msbuild`。我决定在目标之后停止（至少现在）使用`PowerShell`脚本任务的解决方案`SqlCore`：

```
<Import Project="$(ExtensionTasksPath)MSBuild.ExtensionPack.tasks" Condition="Exists('$(ExtensionTasksPath)MSBuild.ExtensionPack.dll')" />
  <UsingTask TaskFactory="PowershellTaskFactory" TaskName="CreateDecryptedScript" AssemblyFile="$(PowerShellTaskAssembly)" Condition="Exists('$(PowerShellTaskAssembly)')">
    <ParameterGroup>
      <File Required="true" ParameterType="System.String" />
      <ResultFile Required="true" ParameterType="System.String" />
    </ParameterGroup>
    <Task>
      <![CDATA[      
      (Get-Content $file) | Foreach-Object {$_ -replace 'WITH ENCRYPTION', '--WITH ENCRYPTION'} | Set-Content $resultfile    
    ]]>
    </Task>
  </UsingTask>
<Target Name="CreateDecryptedScript" AfterTargets="SqlCore">
    <CreateDecryptedScript File="$(OutputPath)$(CreateScriptFileName)" ResultFile="$(OutputPath)$(DecryptedScriptName)" Condition="Exists('$(PowerShellTaskAssembly)')" />
</Target> 
```

结果，在重建项目后，我们有用于创建数据库的脚本而不加密。

但是`publish`从项目中调用并不会强制这些事情发生，我们将使用加密更改所有 SP。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:01:18.127

很容易解密“加密”的存储过程。我建议你不要费心加密它们。

*   [无论如何要解密加密的sql server存储过程？](https://stackoverflow.com/questions/1787629/anyway-to-decrypt-an-encrypted-sql-server-stored-procedure)

*   [https://duckduckgo.com/?q=decrypt+sql+server+stored+procedure](https://duckduckgo.com/?q=decrypt+sql+server+stored+procedure)

如果您必须对它们进行加密，我建议在 DEV 中执行部署后步骤，逐个解密每个加密的存储过程。您可以使用链接中的信息轻松创建这样一个步骤`sp_execsql`。

# ios - 设置iphone相机的白平衡和曝光模式+枚举默认

> ID：13256027
> 
> 赞同：4
> 
> 时间：2012-11-06T17:13:49.810
> 
> 标签：ios, opengl-es, avcapturesession, avcapturedevice

我正在使用 iphone4 的后置摄像头并执行创建 AVCaptureSession 并向其添加 AVCaptureDevice 的标准而漫长的过程。

在将该相机的 AvCaptureDeviceInput 附加到会话之前，我正在测试我对白平衡和曝光的理解，所以我正在尝试这个：

```
[self.theCaptureDevice lockForConfiguration:nil];
[self.theCaptureDevice setWhiteBalanceMode:AVCaptureWhiteBalanceModeLocked];
[self.theCaptureDevice setExposureMode:AVCaptureExposureModeContinuousAutoExposure];
[self.theCaptureDevice unlockForConfiguration]; 
```

1-鉴于白平衡模式的各种选项都在一个枚举中，我会认为默认值始终为零，因为从未为枚举 Typedef 变量赋值。我发现，如果我在调试器中设置断点和 po 值，默认白平衡模式实际上设置为 2。不幸的是，AVCaptureDevice 的头文件没有说明不同相机设置的默认值。

2-这听起来可能很傻，但我可以假设一旦我停止应用程序，白平衡、曝光模式的所有设置都会恢复到默认值。因此，如果我之后立即启动另一个应用程序，相机设备不会以某种方式卡在那些“硬件设置”上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T22:57:00.450

经过更多的研究和帮助，我找到了答案：

1- 所有相机设置（白平衡、对焦和曝光）默认为“连续”设置，以便相机不断调整所有相机。检查 AVCaptureDevice.h 的枚举值。

2-所有应用程序都在孤岛中运行。当调用它的应用程序移到后台时，相机会停止。当一个新的应用程序调用相机时，上述默认设置再次设置。

# c# - 使用 TPL 和任务的生产者消费者模式

> ID：13256030
> 
> 赞同：2
> 
> 时间：2012-11-06T17:13:56.127
> 
> 标签：c#, task-parallel-library, async-await

我们有一个标准的生产者消费者实现，其中 BlockingCollection 与任务一起使用。

使用阻塞集合上的 GetConsumingEnumerable() 完成项目的消耗，然后在消费者线程上使用 RunSynchronously() 执行每个任务。

这对我们来说很好，但现在一些任务不是很短命，而是与后端 Web 服务对话。

所以问题是，以这种方式完成执行长时间运行活动的任务是否可以接受，或者这会消耗更多资源并且从块集合中获取的循环需要以某种方式调整以使用延续？如果它不在循环中，那么我将始终对这些操作使用延续。

当前代码看起来像

```
foreach(var task in _Queue.GetConsumingEnumerable())
{
    if (!task.IsCanceled)
    {
        task.RunSynchronously();
    }
} 
```

鉴于我们也是针对的平台，使用 async await 是不可能的。

# java - 自治 Talend 作业失败并显示“错误：无法找到或加载主类...”

> ID：13256044
> 
> 赞同：4
> 
> 时间：2012-11-06T17:15:15.710
> 
> 标签：java, jvm, talend

我已将 Talend (5.2.0) 作业导出为自主作业并将其部署到我的生产服务器（Windows 2008 R2 Standard 64 位）。我找到了 JVM 并将其添加到服务器的 PATH 环境变量中，因为它没有被找到。

有问题的 JVM 是 Java(TM) SE Runtime Environment (build 1.7.0_05-b05)

当我尝试运行批处理文件时，出现以下错误。错误：无法找到或加载主类

自动化过程在我的笔记本电脑（本地也安装了 Talend）上正常运行。服务器未安装 Talend。如果我将作业导出为自主作业，我认为不需要在服务器上安装 Talend。

是否有我需要实施的设置才能使这项工作正常工作？

编辑为添加——经过进一步测试后，我发现我一直在使用稍微不同版本的打包作业进行测试。工作的一个是从 Talend 5.1.2 生成的，而一个不工作的来自 Talend 5.2.0。这可能是问题的原因。

另一个编辑-> 进一步调查显示，5.2.0 正在为只有 1KB 大小的作业类生成 jar 文件，而 5.1.2 的 jar 文件要大得多（大约 128KB）。我认为这可能是 Talend 5.2.0 的一个错误。我已经向正在调查的 Talend 提出了这个问题。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T09:23:21.707

作业编译失败的原因是工作区文件夹路径中有一个空格。这导致作业的编译失败。

为了缓解这种情况，请始终使用位于不包含空格字符的路径中的 Talend 工作区文件夹。

例如 C:\Talend\TalendWorkspace 将起作用，而 C:\Talend\Talend Workspace 将不起作用。

# c# - 如何获取我在 facebook 上喜欢的所有页面的列表并在他们的墙上发布

> ID：13256048
> 
> 赞同：0
> 
> 时间：2012-11-06T17:15:33.027
> 
> 标签：c#, facebook, facebook-c#-sdk

我试过这个

```
string accessToken = "MYTOKEN";
        FacebookClient fbClient = new FacebookClient(accessToken);
        var args = new Dictionary<string, object>();
        args["message"] = richTextBoxMessage.Text;           
        fbClient.Post("/PAGENAME/feed", args); 
```

我有这个错误

> (OAuthException - #200) (#200) 用户未授权应用程序执行此操作

如果我可以通过该代码在页面墙上发布，那么我应该在应用程序设置中添加的权限名称是什么。以及如何获取我喜欢的所有页面的名称

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:25:29.707

与`fbClient.get("me/likes");`您可以获得您喜欢的所有页面。

并且`fbClient.Post("/PAGEID/feed", args);`您可以发布到页面墙，前提是您的应用已`publish_stream`获得当前用户的许可。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:32:46.957

您的应用程序应请求的权限是**publish_stream**

有关权限的更多信息，请参阅 facebook 开发者文档。 [https://developers.facebook.com/docs/reference/login/extended-permissions/](https://developers.facebook.com/docs/reference/login/extended-permissions/)

# objective-c - 调整 UIView 框架矩形的大小，子层是否调整大小？

> ID：13256052
> 
> 赞同：1
> 
> 时间：2012-11-06T17:15:41.113
> 
> 标签：objective-c

我有一个 UIView 并且我更改了框架大小，但我不认为图层正在调整大小。如何在不覆盖 layoutSubviews 的情况下使用框架调整图层的大小？

# http - 为什么 SNDBUF 太低会破坏 HTTP？

> ID：13256053
> 
> 赞同：2
> 
> 时间：2012-11-06T17:15:43.657
> 
> 标签：http, sockets, networking, tcp

我有一个简单的自定义 HTTP 服务器服务客户端。

将 SNDBUF 设置为 512000 一切正常。但是，将其设置为较低或将其保留为默认值（无论如何）会导致 Chrome 和 Firefox 无法接收所有响应数据 - Firefox 在大约 150000 - 250000 字节后截断它（偏移量每次都会改变，即使内容保持不变相同），并且 Chrome 给出了一个没有详细信息的错误。

有问题的特定响应大约是 300000 字节，并且全部在一个块中发送。

[Rex Swain 的 HTTP 查看器](http://www.rexswain.com/httpview.html)、curl 和 wget 等工具不会报告此类问题，并显示所有数据。

为什么设置 SNDBUF 会影响 Chrome 和 Firefox 接收数据的能力？我了解 SNDBUF 如何影响性能，但我不明白将其设置得太低会如何破坏流？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-21T03:25:36.503

您一次可以写入底层套接字的数据量受当时可用的发送缓冲区大小的限制。正如 Nikolai 所说，您需要检查 send() 或等效函数的返回值，以确定您在函数中传递的所有数据是否已写入发送缓冲区。如果不是，那么您将需要等待套接字再次变为“可写”，然后写入未完成的数据。

不同浏览器/HTTP 客户端之间截断点不同的原因有很多。一个原因可能是其套接字的接收方（客户端）的接收缓冲区大小，因为该大小决定了 TCP 拥塞窗口大小（用于流量控制），这也会影响实际传输速度。另一个可能的原因是 HTTP 查看器/curl/wget 读取套接字的速度可能比 Chrome 或 Firefox 的读取速度快，等等。

# c# - 如何以编程方式将工具提示添加到 XamDataGrid 记录

> ID：13256056
> 
> 赞同：0
> 
> 时间：2012-11-06T17:15:49.177
> 
> 标签：c#, wpf, c#-4.0, xamdatagrid

我已经知道如何使用样式为 XamDataGrid 设置工具提示，例如：

```
<Style TargetType={x:Type ig:DataRecordCellArea>... 
```

但是，出于特定原因（没有时间解释这一切），我确实需要以编程方式调用工具提示，最好是与`MouseOver`事件挂钩。

如果有人能说明方法，我将不胜感激。到目前为止我做了什么？不多，因为 Infragistics 站点充满了 XAML 示例，并且没有提供任何有关以编程方式执行此操作的指导（除了一个简单的单元级工具提示示例）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:30:54.633

```
<XamlDataGrid MouseEnter="XamlDataGridMouseEnter"/>

private void XamlDataGridMouseEnter(object Sender, MouseEventArgs e)
{
    ToolTipService.SetIsEnabled((XamlDataGrid)Sender, true);
} 
```

# c# - Azure 2012 年 10 月 sdk - 如何删除表实体而不先检索它？

> ID：13256059
> 
> 赞同：8
> 
> 时间：2012-11-06T17:15:59.060
> 
> 标签：c#, .net, azure, azure-storage, azure-table-storage

在以前的版本中，我们可以这样做来删除一个实体而不知道它是否存在。

```
svc = new TestContext();
item = new TestEntity("item2pk", "item2rk");
svc.AttachTo("TestTable", item, "*");
svc.DeleteObject(item);
svc.SaveChanges(); 
```

[（来源）](http://blog.smarx.com/posts/deleting-entities-from-windows-azure-without-querying-first)

新的 TableOperations 没有这种语法。我必须使用这种旧方法还是有办法？我想保持一致，因为现在我的所有代码都使用版本 2 的新类。

编辑：标题具有误导性

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T20:03:37.060

您需要使用`TableOperation.Delete`：

```
var storageAccount = CloudStorageAccount.DevelopmentStorageAccount;
var table = storageAccount.CreateCloudTableClient()
                            .GetTableReference("tempTable");
table.CreateIfNotExists();

// Add item.
table.Execute(TableOperation.Insert(new TableEntity("MyItems", "123")));

// Load items.
var items = table.ExecuteQuery(new TableQuery<TableEntity>());
foreach (var item in items)
{
    Console.WriteLine(item.PartitionKey + " - " + item.RowKey);
}

// Delete item (the ETAG is required here!).
table.Execute(TableOperation.Delete(new TableEntity("MyItems", "123") { ETag = "*" })); 
```

删除仅适用于存在的实体。即使旧客户端有`ContinueOnError`选项，但它与`Batch`操作不兼容（[如此处所述](http://blogs.msdn.com/b/windowsazurestorage/archive/2010/11/06/how-to-get-most-out-of-windows-azure-tables.aspx)）。

如果您不知道实体是否存在，那么获得成功批量删除的唯一方法是首先添加它们（或者如果它们已经存在则替换它们）：

```
var ensureItemsBatch = new TableBatchOperation();
ensureItemsBatch.InsertOrReplace(new MyEntity("MyItems", "123") { Active = false });
ensureItemsBatch.InsertOrReplace(new MyEntity("MyItems", "456") { Active = false });
ensureItemsBatch.InsertOrReplace(new MyEntity("MyItems", "789") { Active = false });
table.ExecuteBatch(ensureItemsBatch);

var deleteItemsBatch = new TableBatchOperation();
deleteItemsBatch.Delete(new MyEntity("MyItems", "123") { ETag = "*" });
deleteItemsBatch.Delete(new MyEntity("MyItems", "456") { ETag = "*" });
deleteItemsBatch.Delete(new MyEntity("MyItems", "789") { ETag = "*" });
table.ExecuteBatch(deleteItemsBatch); 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-11-21T10:06:29.303

我使用自己的方法来捕获实体不存在时发生的 StorageException。此外，它返回实体是否被删除为布尔值。

```
public bool DeleteTableEntity(string partitionKey, string rowKey)
{
    try
    {
        _table.Execute(TableOperation.Delete(new TableEntity(partitionKey, rowKey) { ETag = "*" }));
        return true;
    }
    catch (StorageException e)
    {
        if (e.RequestInformation.HttpStatusCode == (int)HttpStatusCode.NotFound)
            return false;
        throw;
    }
} 
```

_table 成员变量的类型为 CloudTable (Microsoft.WindowsAzure.Storage.Table.CloudTable)。对于此示例，我使用随 NuGet 一起安装的 Microsoft.WindowsAzure.Storage.dll v2.1.0.3 程序集。

# php - 切换托管服务提供商后，其中一项重写规则停止工作

> ID：13256062
> 
> 赞同：1
> 
> 时间：2012-11-06T17:16:12.377
> 
> 标签：php, apache, mod-rewrite

```
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^(.*)$ $1.php
RewriteRule ^([a-zA-Z0-9]+)$ photo?p=$1
RewriteRule ^page/([a-zA-Z0-9]+)$ index?page=$1  // up to this point included works fine
RewriteRule ^waitingroom/page/([a-zA-Z0-9]+)$ waitingroom?page=$1 //doesnt work, 500 error 
```

photo, index 和 waitingroom 其实都是 php 文件，比如 photo.php,index.php,waitingroom.php

它在与之前的相同的最后一个重写规则旁边工作 :( 在我切换到 hostgator 之前它工作正常

我的语法有什么问题？

# ssis - 如何为 Foreach 文件枚举器上的 FileSpec 属性设置表达式？

> ID：13256066
> 
> 赞同：9
> 
> 时间：2012-11-06T17:16:24.300
> 
> 标签：ssis, sql-server-2012

我正在尝试创建一个 SSIS 包来处理包含多年文件的目录中的文件。这些文件都以数字命名，因此为了节省处理所有内容，我想向 SSIS 传递一个最小数字，并且只枚举名称（转换为数字）高于我的最小值的文件。

我试过让**ForEach File**循环枚举所有内容，然后在脚本任务中排除文件，但是在处理数十万个文件时，这太慢了，不适合。

FileSpec属性允许您指定一个文件掩码来指示您希望在集合中**包含**哪些文件，但我不太明白如何指定一个表达式来使其工作，因为它本质上是一个字符串匹配。

如果组件中有一个表达式基本上是说`Should I Enumerate? - Yes / No`，那将是完美的。我一直在试验下面的表达式，但找不到应用它的属性。

> (DT_I4)REPLACE(SUBSTRING(@[User::ActiveFilePath],FINDSTRING(@[User::ActiveFilePath], "\", 7) + 1 ,100),".txt","") > @[User: :MinIndexId] ? “真假”

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-06T20:05:03.023

这是实现这一目标的一种方法。您可以使用`Expression Task`组合 with`Foreach Loop Container`来匹配文件名的数值。这是一个说明如何执行此操作的示例。该示例使用`SSIS 2012`.

这可能不是很有效，但它是这样做的一种方式。

假设有一个文件夹，其中包含以 YYYYMMDD 格式命名的文件。该文件夹包含自 1921 年以来每个月的第一天的文件，例如*19210101*、*19210201*、*19210301* .... 直到当前月份的所有*20121101*。这增加了`1,103`文件。

假设要求仅遍历自 1948 年 6 月以来创建的文件。这意味着 SSIS 包必须仅遍历大于`19480601`.

![文件](../Images/e33e0d4815b4992e344c6d98794b642f.png)

在 SSIS 包上，创建以下三个参数。最好为这些配置参数，因为这些值可以跨环境配置。

*   `ExtensionToMatch`- 这个`String`数据类型的参数将包含包必须循环的扩展。这将补充`FileSpec`将在 Foreach 循环容器上使用的变量的值。

*   `FolderToEnumerate`- 此`String`数据类型参数将存储包含要循环遍历的文件的文件夹路径。

*   `MinIndexId`- 此`Int32`数据类型参数将包含文件应与模式匹配的最小数值。

![参数](../Images/c3b2107af4572498cca8d130a15d305d.png)

创建以下四个参数来帮助我们遍历文件。

*   `ActiveFilePath`- 这个数据类型的变量`String`将保存文件名，因为 Foreach 循环容器循环遍历文件夹中的每个文件。此变量用于另一个变量的表达式。为避免错误，请将其设置为非空值，例如 1。

*   `FileCount`- 这是一个`Int32`数据类型的虚拟变量，将用于此示例以说明 Foreach 循环容器将循环通过的文件数。

*   `FileSpec`- 这个数据类型的变量`String`将保存要循环的文件模式。将此变量的表达式设置为下面提到的值。此表达式将使用参数上指定的扩展名。如果没有扩展名，它将`*.*`遍历所有文件。

> "*" + (@[$Package::ExtensionToMatch] == "" ? ".*" : @[$Package::ExtensionToMatch])

*   `ProcessThisFile`- 此数据类型变量`Boolean`将评估特定文件是否符合条件。

![变量](../Images/866dadcc9c085f72f58f69c92c996c6b.png)

如下所示配置包。Foreach 循环容器将遍历与`FileSpec`变量指定的模式匹配的所有文件。表达式任务上指定的表达式将在运行时进行计算，并将填充变量 ProcessThisFile。然后，该变量将用于 Precedence 约束以确定是否处理文件。

`FileCount`Foreach 循环容器中的脚本任务将为每个成功匹配表达式的文件将变量的计数器增加1。

Foreach 循环外的脚本任务将简单地显示 Foreach 循环容器循环了多少文件。

![控制流](../Images/768366a8218608ac367e54cff3e4b7db.png)

配置 Foreach 循环容器以循环使用参数的文件夹和使用变量的文件。

![Foreach 循环集合](../Images/2e88c38a57b2591ca4eda87b3f135adf.png)

`ActiveFilePath`当循环通过每个文件时，将文件名存储在变量中。

![Foreach 循环变量映射](../Images/c917a3da4738618ed9d17ad2598d9acb.png)

在表达式任务中，将表达式设置为以下值。该表达式会将不带扩展名的文件名转换为数字，然后检查其计算结果是否大于参数中的给定数字`MinIndexId`

> @[User::ProcessThisFile] = (DT_BOOL)((DT_I4)(REPLACE(@[User::ActiveFilePath], @[User::FileSpec] ,"")) > @[$Package::MinIndexId] ? 1: 0)

![表达任务](../Images/0b72a4675daa7002bdd9c1c27413f8f0.png)

右键单击 Precedence 约束并将其配置为使用`ProcessThisFile`表达式上的变量。这告诉包仅在文件与表达式任务上设置的条件匹配时才处理文件。

> @[用户::ProcessThisFile]

![优先约束](../Images/a2ab33dd450b78f567d463ce764600f3.png)

在第一个脚本任务中，我将变量`User::FileCount`设置为*ReadWriteVariables*和脚本任务中的以下 C# 代码。这会增加成功匹配条件的文件的计数器。

```
public void Main()
{
    Dts.Variables["User::FileCount"].Value = Convert.ToInt32(Dts.Variables["User::FileCount"].Value) + 1;
    Dts.TaskResult = (int)ScriptResults.Success;
} 
```

在第二个脚本任务中，我将变量`User::FileCount`设置为*ReadOnlyVariables*和脚本任务中的以下 C# 代码。这只是输出已处理的文件总数。

```
public void Main()
{
    MessageBox.Show(String.Format("Total files looped through: {0}", Dts.Variables["User::FileCount"].Value));
    Dts.TaskResult = (int)ScriptResults.Success;
} 
```

当 MinIndexId 设置为`1948061`（不包括 this）执行包时，它输出 value `773`。

![输出 1](../Images/ac1d9e9b896e775a973bed70364bfe63.png)

当 MinIndexId 设置为`20111201`（不包括 this）执行包时，它输出 value `11`。

希望有帮助。

![输出 2](../Images/18230ec7b39e108376197ed3a02b4623.png)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-12T17:02:39.660

通过调查 ForEach 循环在 SSIS 中的工作方式（以创建我自己的方式来解决问题），似乎它的工作方式（据我所知）是在任何掩码之前先枚举文件集合指定的。如果不查看 ForEach 循环的底层代码，很难准确判断发生了什么，但它似乎是这样做的，导致处理超过 100k 文件时性能下降。

虽然@Siva 的解决方案非常详细，并且绝对是对我最初方法的改进，但它基本上只是相同的过程，除了使用表达式任务来测试文件名，而不是脚本任务（这似乎确实提供了一些改进）。

因此，我决定采用完全不同的方法，而不是使用基于文件的 ForEach 循环，而是自己在脚本任务中枚举集合，应用我的过滤逻辑，然后遍历剩余的结果。这就是我所做的：

![示例控制流显示了一个脚本任务，用于枚举提供给 ForEach 变量枚举器的文件](../Images/9a604a17efbb91ed9005447151512258.png)

在我的脚本任务中，我使用异步`DirectoryInfo.EnumerateFiles`方法，这是大型文件集合的推荐方法，因为它允许流式传输，而不是在应用任何逻辑之前必须等待创建整个集合。

这是代码：

```
public void Main()
{
    string sourceDir = Dts.Variables["SourceDirectory"].Value.ToString();
    int minJobId = (int)Dts.Variables["MinIndexId"].Value;

    //Enumerate file collection (using Enumerate Files to allow us to start processing immediately
    List<string> activeFiles = new List<string>();

    System.Threading.Tasks.Task listTask = System.Threading.Tasks.Task.Factory.StartNew(() =>
    {
         DirectoryInfo dir = new DirectoryInfo(sourceDir);
         foreach (FileInfo f in dir.EnumerateFiles("*.txt"))
         {
              FileInfo file = f;
              string filePath = file.FullName;
              string fileName = filePath.Substring(filePath.LastIndexOf("\\") + 1);
              int jobId = Convert.ToInt32(fileName.Substring(0, fileName.IndexOf(".txt")));

              if (jobId > minJobId)
                   activeFiles.Add(filePath);
         }
    });

    //Wait here for completion
    System.Threading.Tasks.Task.WaitAll(new System.Threading.Tasks.Task[] { listTask });
    Dts.Variables["ActiveFilenames"].Value = activeFiles;
    Dts.TaskResult = (int)ScriptResults.Success;
} 
```

因此，我枚举了集合，在发现文件时应用我的逻辑，并立即将文件路径添加到我的列表中以供输出。完成后，我将其分配给名为**ActiveFilenames**的 SSIS 对象变量，我将使用该变量作为 ForEach 循环的集合。

我将 ForEach 循环配置为**ForEach From Variable Enumerator**，它现在迭代一个小得多的集合（`List<string>`与我只能假设`List<FileInfo>`在 SSIS 的内置**ForEach File Enumerator**中未过滤或类似的东西相比，后过滤。

所以我的循环中的任务可以专门用于处理数据，因为它在进入循环之前已经被过滤了。尽管它似乎与我的初始包或 Siva 的示例没有太大不同，但在生产中（无论如何，对于这种特殊情况），过滤集合和异步枚举似乎比使用内置 ForEach 文件提供了巨大的提升枚举器。

我将继续研究 ForEach 循环容器，看看是否可以在自定义组件中复制此逻辑。如果我得到这个工作，我会在评论中发布一个链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T18:06:42.400

正如你所说，你能做的最好的事情就是使用 FileSpec 来指定一个掩码。您可以在其中至少包含一些规范，例如 2010、2011 和 2012 以“201”开头的文件。然后，在其他一些任务中，您可以过滤掉那些您不想处理的文件（例如，2010）。

# sitecore - 隐藏项目存储桶内容时显示站点核心模板

> ID：13256068
> 
> 赞同：2
> 
> 时间：2012-11-06T17:16:28.673
> 
> 标签：sitecore, sitecore6, buckets

项目桶的主要目的之一是包含内容项目的大型存储库，而不处理内容树中的正常结构。话虽如此，显示这些**隐藏项目**将是不必要的，因为它们会自动评估并放置在为您格式化的文件夹结构中。

但是我遇到了一个问题，如果未选中“**视图”**选项卡中的“**隐藏项目**” ，“模板”文件夹就会消失。

 **Bucket Item 配置或基本 Sitecore 设置中是否有可以设置为在使用 Item Bucket 时显示模板的设置？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T08:08:00.290

这是一个已知问题.. 现在您必须使用模板管理器来访问模板。在新版本中，此问题已得到解决，用户界面中没有使用“隐藏”复选框，而是使用单独的“桶”可见性复选框来控制桶的隐藏和显示。**

# delphi - 为什么我得到 E2356 属性访问器必须是实例字段或方法

> ID：13256070
> 
> 赞同：3
> 
> 时间：2012-11-06T17:16:41.453
> 
> 标签：delphi, delphi-2007

编译本单元时：

```
unit Test;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs;

type
  TForm1 = class(TForm)
  private
    class var StartDate, EndDate: TDateTime;   // Line 12
    fTest: TNotifyEvent;
  public
    property OnTest: TNotifyEvent read fTest;  // Line 15.
  end;

implementation

{$R *.dfm}

end. 
```

我收到以下编译器错误：

> [DCC 错误] Test.pas(15): E2356 属性访问器必须是实例字段或方法

但是如果我注释掉第 12 行，它编译得很好。有人可以解释为什么吗？我需要将日期作为类变量来存储日期间隔。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T17:53:11.613

该错误应该是不言自明的。让我们尝试解构它。

> 属性访问器必须是实例字段或方法。

*属性访问*器是`read`. 如果你的属性是可写的，那么后面的表达式`write`也将是一个属性访问器。

因此，在您的代码中，属性访问器是`fTest`.

实例*字段*是类的普通字段。因此，类字段不符合条件。同样，*实例方法*是类的普通方法。类方法不是实例方法。事实上，任何不是类方法的方法都是实例方法。

因此，该错误表明这`fTest`不是实例字段。

这是正确的。它是一个类字段。

```
private
  class var StartDate, EndDate: TDateTime;   
  fTest: TNotifyEvent; // class var applies to fTest also 
```

我猜你的意思不是要`fTest`成为一个类领域。您需要像这样编写类：

```
TForm1 = class(TForm)
private
  class var StartDate, EndDate: TDateTime;   
private
  fTest: TNotifyEvent;
public
  property OnTest: TNotifyEvent read fTest;  
end; 
```

也许：

```
TForm1 = class(TForm)
private
  class var
    StartDate, EndDate: TDateTime;   
  var 
    fTest: TNotifyEvent;
public
  property OnTest: TNotifyEvent read fTest;  
end; 
```

我赞成前者，因为它在类和实例字段之间提供了更清晰的区别。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T18:24:15.437

`class var`扩展到该字段`fTest`，使其成为类字段。避免了`var`之前那个简单的地方`fTest`。

# javascript - HTML5 Canvas 重影动画问题？

> ID：13256072
> 
> 赞同：1
> 
> 时间：2012-11-06T17:16:54.060
> 
> 标签：javascript, html, animation, graphics, canvas

我一直在看很多关于如何使用 javascript 和请求动画帧做正确的 HTML5 动画的教程，即使在演示中，动画看起来也很模糊，就像被重绘的图像在短时间内留下了自己的幻影图像。但后来我看到像微软移植版的割绳子这样的游戏似乎已经解决了这个问题。有谁知道使这种画布效果不那么明显的方法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:58:08.750

我猜你遇到的问题是在清除前一个图像之前重新绘制新图像。我建议确保画布被清除，或者至少是图像被重新绘制的区域。虽然，我尝试清除整个画布与清除画布的特定部分，并达到一定大小（大约 800x600），但清除整个画布更快。

我在我的（正在进行的）游戏中使用画布：[http ://www.dacheng.me/dBoom](http://www.dacheng.me/dBoom)

随意浏览JS源代码！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:31:20.163

我认为您正在寻找的是窗口缓冲：

[http://en.wikipedia.org/wiki/Multiple_buffering](http://en.wikipedia.org/wiki/Multiple_buffering)

基本上，这个想法是使用两个不同的窗口/画布元素，它们在完全绘制后互换，以便您在完全绘制的“框架”之间切换。该技术用于 OpenGL 和当今存在的几乎所有其他合法图形程序。

# wpf - 如何将一组样式转换为枚举类型的 DataTemplates？

> ID：13256076
> 
> 赞同：0
> 
> 时间：2012-11-06T17:17:05.940
> 
> 标签：wpf

目前我们有一个枚举类型，其中每个唯一值都由唯一的样式表示：

```
<Style x:Key="EnumValue1" TargetType="CheckBox">
<Setter Property="FontSize" Value="11" />
<Setter Property="Margin" Value="0 0 1 0" />
<Setter Property="VerticalAlignment" Value="Top" />
<Setter Property="Height" Value="18" />
<!-- ... common property setters etc. -->

<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="CheckBox">
            <Border>
                <StackPanel>
                    <!-- custom enum value-specific control content -->
                    <ContentPresenter Content="{TemplateBinding Content}" />
                </StackPanel>
            </Border>
            <ControlTemplate.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Trigger.Setters>
                        <Setter Property="Foreground" Value="WhiteSmoke" />
                    </Trigger.Setters>
                </Trigger>
                   <!-- ... custom triggers etc ... -->
            </ControlTemplate.Triggers>
        </ControlTemplate>
    </Setter.Value>
</Setter>
</Style> 
```

目前，复选框是在代码隐藏中以编程方式创建的-我将其更改为绑定到这些枚举值集合的 ListBox，我认为将它们转换为 DataTemplate 是有意义的-问题是，我如何最大化重新-利用？

我有大约 10 个唯一值和 10 个唯一样式 ...9/10 的样式使用相同的 Setter，ControlTemplate.Triggers 对于所有 10 个都是相同的，但显然 ControlTemplate 中的视觉树是不同的

我考虑过使用基本 Style 类并让每个特定变体派生 / 用另一个 Style 覆盖它并使用 StyleSelector，但是我如何在不必重新定义触发器的情况下改变每种样式的 ControlTemplate 视觉树？

但这似乎在“哲学上”是错误的……我觉得我应该使用 DataTemplates，因为根据定义，这就是它们的用途

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T23:37:54.673

您可以创建一个评估枚举值并返回适当模板的 ValueConverter 吗？

```
public enum TemplateEnum
{
    firstValue,
    secondValue
}

public class TemplateConverter : IValueConverter
{

    public object Convert(object value, Type targetType, object parameter, System.Globalization.CultureInfo culture)
    {

        var templateEnum = (TemplateEnum)value;
        switch (templateEnum)
        {
            case TemplateEnum.firstValue:
                return Application.Current.Resources["FirstValueTemplate"];
            case TemplateEnum.secondValue:
                return Application.Current.Resources["SecondValueTemplate"];
            default:
                return null;
        }
    }
}

<ContentPresenter Content="{Binding EnumVal, Converter={x:Static local:Converters.templateConverter}}" /> 
```

# objective-c - AFNetworking 错误的 URL

> ID：13256083
> 
> 赞同：3
> 
> 时间：2012-11-06T17:17:56.360
> 
> 标签：objective-c, ios, afnetworking

我在这里遇到了一个奇怪的问题，很惊讶我没有发现其他人有同样的问题。

我`AFNetworking`用来做一个`AFJSONRequestOperation`.

它在第一次建立网络连接时工作。但是，一旦建立网络连接，相同的代码就会失败并显示“错误的 URL”错误。

奇怪的是，该应用程序在失败之前甚至从未 ping 服务器，我正在使用 Charles 来嗅探所有请求。

有没有其他人经历过这个？

作为参考，这里是代码：

```
 NSURL *url = [NSURL URLWithString:JOIN_URL];
     AFHTTPClient *httpClient = [[AFHTTPClient alloc] initWithBaseURL:url];

   // httpClient.parameterEncoding = AFJSONParameterEncoding;
     NSString *path = [NSString stringWithFormat:@"%@?%@",JOIN_URL, getString];

     NSMutableURLRequest *request = [httpClient requestWithMethod:@"GET" path:path parameters:nil];

    AFJSONRequestOperation *operation = [AFJSONRequestOperation JSONRequestOperationWithRequest:request

                                                                                      success:^(NSURLRequest *request, NSHTTPURLResponse *response, id JSON) {

                                                                                          NSLog(@"SUCCESS JSON: %@", JSON);

                NSLog(@"RESPONSE URL: %@",response.URL);
    } failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, id JSON) {
        NSLog(@"FAIL JSON: %@", JSON);
        NSLog(@"FAIL ERROR: %@", error.description);
        NSLog(@"RESPONSE URL: %@",response.URL);

        UIAlertView *alert = [[UIAlertView alloc]initWithTitle:@"Connection Error" message:@"Cannot connect now, please try again" delegate:nil cancelButtonTitle:@"Okay" otherButtonTitles: nil];
        [alert show];

    }];

    [operation start]; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T17:21:36.550

你真的应该`path`像这样编码你的 URL 字符串：

```
NSString* escapedUrlString =[path stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-06T17:28:46.007

据我了解`AFHTTPClient`，您向它提供了一个`baseURL`基本**URL**，您指定的所有路径都**将附加**到该 URL 。然后当你提供一个路径时，你只提供**这个路径的相对部分**。

因此，如果您在[http://www.example.com/webservice/](http://www.example.com/webservice/)有一个 WebService，它有一些方法`/listAll?n=10`，例如，您将只提供参数`"listAll"`的参数和参数的字典。`path``requestWithMethod:path:parameters:``@{ @"n" : @10 }``parameters`

*无论如何，您已经`JOIN_URL`在实例化时提供了您`AFHTTPClient`的，所以如果您`JOIN_URL`在路径中再次传递它，它将在`AFHTTPClient`内部构建的 URL 中出现两次！*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-11-06T20:31:53.163

目标-C：

```
[query stringByAddingPercentEncodingWithAllowedCharacters:
        [NSCharacterSet URLQueryAllowedCharacterSet]]; 
```

迅速：

```
query.stringByAddingPercentEncodingWithAllowedCharacters(
       NSCharacterSet.URLQueryAllowedCharacterSet()) 
```

# java - 带有星号的 Java 应用程序

> ID：13256085
> 
> 赞同：0
> 
> 时间：2012-11-06T17:18:09.917
> 
> 标签：java, asterisk

我正在做一个项目。我只想从我的 Java 应用程序中获取 Asterisk 服务器的 sip 帐户状态？有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:32:50.707

您的星号服务的配置是什么？它在数据库上运行吗？您是否使用任何 3rd 方计费软件和星号？你在什么操作系统上运行？它是什么版本的星号？

肯定有办法做你想做的事。你看过'asterisk-java'库吗？[http://www.asterisk-java.org/development/tutorial.html](http://www.asterisk-java.org/development/tutorial.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:20:52.217

您可以直接从 Java（JDBC 驱动程序）访问星号数据库并从 sip.flags 中读取吗？

# java - EJB 中基于 Zookeeper 的锁

> ID：13256090
> 
> 赞同：0
> 
> 时间：2012-11-06T17:18:24.487
> 
> 标签：java, multithreading, ejb, pool, apache-zookeeper

我想利用 zookeeper 来创建分布式锁。我有工厂创建允许锁定/解锁某些值的 LockObject。Factory 创建的每个 LockObject 都使用相同的 org.apache.zookeeper.Zookeeper 对象。

现在，我想将这个工厂用作 EJB，以便其他服务可以使用它。我们可以假设多个线程将同时使用同一个 Zookeeper 对象。我正在处理的是限制可以从应用程序创建的连接数。zookeeper 是否有任何类型的连接池或单个 org.apache.zookeeper.Zookeeper 对象适合这个问题？

最好的，一个

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T04:45:54.830

一个 org.apache.zookeeeper.Zookeeper 可以被多个线程共享。

与其围绕 zookeeper 编写自己的代码，不如查看[Curator](https://github.com/Netflix/curator/wiki)库。

# android - Android Gingerbread 中的 OpenGL 性能不佳

> ID：13256091
> 
> 赞同：5
> 
> 时间：2012-11-06T17:18:24.893
> 
> 标签：android, performance, opengl-es, android-2.3-gingerbread

我正在使用 OpenGL 1.0 开发适用于 Android 的视频游戏。

我遵循了本教程： [http ://www.javacodegeeks.com/2011/06/android-game-development-tutorials.html](http://www.javacodegeeks.com/2011/06/android-game-development-tutorials.html)

我在当前的手机中创建了一个运行良好且流畅（限制为 30 FPS）的小演示：HTC Sensation（Android 4.0.3 Ice Cream Sandwich）。

此外，我在朋友的手机上测试了我的游戏，结果如下：

*   Galaxy S2 = 完美！(30FPS)
*   Galaxy Note = 完美！(30FPS)
*   HTC One S = 完美！(30FPS)
*   索尼 Xperia Tipo = 完美！(30FPS)
*   三星 Galaxy Ace GT-S5830 = 性能非常差 >_<'（<10FPS 并在两部手机上测试）

如果您比较 Xperia Tipo 和 Samsung Ace 的规格，您会发现它们几乎是同一款手机。

XPERIA 提示：

*   320 x 480 分辨率
*   512MB 内存
*   高通 MSM7227A 800MHz，GPU Adreno 200

三星银河王牌：

*   320 x 480 分辨率
*   278MB 内存
*   高通 MSM7227 800 MHz，GPU Adreno 200

好吧，内存不一样，不过我的游戏很简单，不超过200MB！但表现完全不同。没道理！

然而……只有一件事不同！三星 Galaxy Ace 使用 Android 2.3.X (Gingerbread)，而 Xperia Tipo 使用 Android 4.0.3 (ICS)。

所以，我的矛头指向问题出在 Android 2.3.X - Gingerbread 或 Galaxy Ace 是垃圾手机。

但是...我强迫我的朋友安装 AndEngine 示例并对其进行测试，结果 Nexus ParticleSystem 测试运行良好且流畅。

我完全迷路了！为什么这在性能上有所不同？我做错了什么？

一些额外的信息：

1.  我遵循该教程中的所有步骤。
2.  我使用 GL10 (OpenGL 1.0)。
3.  没有着色器。
4.  丢失 FPS 没有增量时间（我认为这件事不会解决我的问题）。
5.  没有本机代码，只有 Java。
6.  SystemClock.uptimemillis() 和 sleep() 来控制 FPS。
7.  MediaPlayer 播放一首 MIDI 歌曲（不再有声音）。
8.  具有大量 alpha 的纹理（2D 游戏，对于精灵来说是必需的）。
9.  minSDKversion=8

如果您需要更多信息，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-01T17:26:44.370

RAM 可能是瓶颈。您知道 Android 不能很好地处理图像。你在回收你的位图吗？为什么不使用 OpenGL ES 2.0？我正在三星 Galaxy Ace 和 LG p500（都带有 Gingerbread）上开发游戏和测试，没有问题。我可以获得近 50 FPS。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:28:41.357

1.  千万不要`Thread.sleep`在UI线程中使用，非常非常糟糕。

2.  使用`statics`；这是一种糟糕的 OOP 做法，但在这里很有用。

3.  利用`vertex-buffer objects`

4.  也在这里初始化`onSurfaceChanged`并获取位置 ( `glget***location`)。

5.  这不是你的错，因为在 Froyo 上，垃圾收集器很糟糕，然后在 Gingerbread 上，`the touch drivers fire way too many events`（Google I_O 2011_ Android 应用程序的内存管理）。因此，请逐渐为您的应用/游戏切换到其他不使用触摸的输入法，例如 android 运动和位置传感器

# ios - MVC 和 KVO 的设计协助

> ID：13256093
> 
> 赞同：0
> 
> 时间：2012-11-06T17:18:30.643
> 
> 标签：ios, performance, model-view-controller, key-value-observing

我有数据保存在需要与我的服务器同步的设备上，就设计而言，我是否走在正确的轨道上？

我有一个带有返回本地对象的方法的模型，我们称之为`[model objects]';`

在此方法中，它会立即返回本地对象，但我还想检查服务器是否需要更新这些对象中的任何一个，因此在后台线程中我运行了一个使用 an 的方法，该方法`async NSUrlConnection`将返回需要更新的每个对象的 JSON更新，我将把它保存到核心数据中。在表视图控制器中，我将设置一个 KVO 来观察值何时更改，`updatedObjects`然后重新加载显示在`objectTableView`.

**问题：这是处理这个问题的正确方法吗？我错过了什么吗？我可以以某种方式改进吗？**

我也在考虑禁用正在更新的对象的 UITableViewCells 并`UIActivityIndicator`在下载和保存阶段显示，但我不确定这是否会导致 UX 中的任何竞争条件。

希望这已经解释得足够好让您理解，如果您有任何问题，我会立即回复。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:32:56.330

CoreData 中支持此类问题。并且有多种方法。

基本要点是您在后台线程中为异步 Web 调用创建一个新上下文，然后将您的本地数据与您管理更新的新接收数据进行比较。然后执行从线程上下文到主上下文的合并。此时您可以在 CoreData 中收到更新数据的通知并更新您的视图。

您甚至可以使用它`NSFetchedResultsController`来进一步简化它。

# python - 此代码如何交换两个数字？

> ID：13256099
> 
> 赞同：-1
> 
> 时间：2012-11-06T17:18:56.280
> 
> 标签：python, c, ruby, math, swap

> **可能重复：**
> [交换两个变量值而不使用第三个变量](https://stackoverflow.com/questions/1826159/swapping-two-variable-value-without-using-3rd-variable)

我在 Quora 上看到了这段代码。对于 C：

```
a^=b^=a^=b; 
```

对于 Ruby/Python：

```
a,b=b,a 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T17:20:58.860

```
a ^= b ^= a ^=b; 
```

`^`是二元异或运算符。请注意，此代码具有未定义的行为： 和 的值在两个序列点`a`之间`b`被修改两次。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T17:20:48.910

C 示例使用了几个愚蠢的技巧来交换两个数字，您可以在这个[相同的问题](https://stackoverflow.com/questions/756750/swap-the-values-of-two-variables-without-using-third-variable)中阅读。

Ruby/Python 示例使用元组解包，这更加明智/可读。

更多详情：

C：这是没有第三个变量的大肆吹嘘的交换的变体，但它不可读，具有未定义的行为（正如 Kirilenko 指出的那样）并且通常是一个坏主意。整数版本有溢出问题引导。在 C++ 中，只需使用`std::swap(a,b)`，因为它可以正常工作。编写交换方法时要非常小心的一件事是，您可能会两次传递相同的东西，特别是如果您在 C 中使用引用或指针。

Ruby/Python：元组由 a 和 b 的值构成，并且通过拆分匿名元组并分配各个变量值来解释对以逗号分隔的变量列表的赋值。该方法确实使用了“第三个变量”，即匿名元组。

# .net - plinq 选择计数，其中所有函数评估为真

> ID：13256102
> 
> 赞同：1
> 
> 时间：2012-11-06T17:19:21.053
> 
> 标签：.net, plinq

我有一组数据全部翻倍：100 行 20 列

我将数据拉到一个 IEnumerable 列表中：

```
var RowsOfData = File.ReadLines(dll.Globals.OutputDir +     dll.Globals.filename).Select(a => a.Split(',').ToList());

var FilteredRowsToday = (from n in RowsOfData
       where n[1] == 1
       orderby n[0] descending
       select n); 
```

然后我有一组函数，它们对每个数据行进行简单的检查，每个都返回一个 Bool。我想要的是计算每个函数评估为真的行数。然后，当我扩大项目规模时，如果可能的话，我希望尽快并行处理，我尝试过：

```
foreach (var row in FilteredRowsToday) {  
is f1() true, is f2() true 
etc
} 
```

我尝试并行执行似乎很慢

```
foreach (var row in FilteredRowsToday.AsParallel()) 
```

没有更快

我现在在想这样的事情：

```
var TotalTrue = FilteredRowsToday.Select(item => f1() & f2() & f3()).Count(); 
```

如果这是一个更好的陈述点，我可以预处理数据以将每个函数的评估结果作为一种二进制网格提供？

```
F1, f2, f3 etc
1, 0, 0 row 1
1, 1, 1 row 2 etc 
```

欢迎提出建议！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T20:43:46.640

如果您只对所有三个函数评估为真的计数感兴趣，那么这应该足够了：

```
var TotalTrue = FilteredRowsToday.Count(item => f1() & f2() & f3()); 
```

至于为什么它很慢，你的功能可能是这背后的原因。

您可以尝试只评估行，直到所有三个函数都返回 true，或者其中至少一个返回 false，例如

```
var TotalTrue = FilteredRowsToday.Count(item => f1() && f2() && f3()); 
```

即，如果`f1()`评估为`false`，则不必费心进行其余的验证。

**更新：**如果您的函数没有进行任何资源密集型检查，那么并行 LINQ 不会对您有多大好处（更多信息[在这里](http://msdn.microsoft.com/en-us/library/dd997399.aspx)）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T22:33:15.057

正如我所见，您正在一次读取文件，它是一种逗号分隔的文件。如果您在阅读时从文件中产生记录，它将允许您处理它们，直到您等待下一次阅读。

```
private IEnumerable<string> GetRecords(string fileName) {
    using (StreamReader reader = File.OpenText(fileName))
            {
                string line = reader.ReadLine();
                while (line != null)
                {   
                   yield return line.Split(',');
                   line = reader.ReadLine();
                 }
             }
} 
```

您还花了一些时间将结果`Split`转换`List`为已经是 `array`并且具有执行查询所需的索引访问权限。

我还建议应用之前建议的优化，例如使用`.Count(item => f1() & f2() & f3());`而不是`.Select(item => f1() & f2() & f3()).Count();`.

尽管如此，我不相信这些优化中的任何一个都会用如此少量的数据带来任何改进。如果您发布有关处理部分代码的一些详细信息，我认为我们可以为您提供更好的帮助。

# jquery - 如果某个按钮在一段时间内未单击，则显示一条消息

> ID：13256114
> 
> 赞同：1
> 
> 时间：2012-11-06T17:20:21.717
> 
> 标签：jquery, html, css

在检查特定按钮是否在一段时间内（即 20 秒）内没有被点击后，我怎么能显示一条消息`jQuery`？

我已经有一个功能示例，如果鼠标在[此处30 秒后保持空闲状态，则会显示一条消息](http://dev.kyleboyd.co.uk/SocialContainer/)

谢谢，凯尔

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T20:09:50.203

当您开始超时时，将它返回的 ID 分配给一个 var：

```
function visible_a_message(){
  $('#warningMessage').show();
}
var timeout = 20000; //20 secs
var showWarningBox = setTimeout(visible_a_message, timeout); 
```

然后，当单击按钮时，清除该超时：

```
<input type='button' onClick='clearTimeout(showWarningBox);'" /> 
```

这不依赖于按钮会将用户带到不同页面的假设（无论浏览器在做*什么*，它都会在单击按钮后取消显示消息）并且它跳过了使用类作为变量的麻烦.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:27:31.923

```
$(function () {
  var pageLoaded = new Date();

  $("#preventButton").click(function () {
    // mark as clicked only within 20 seconds after page load
    if (new Date() - pageLoaded <= 20000) {
      $(this).addClass("clicked");
    }
  });

  setTimeout(function conditionalMessage() {
    // show a message if #preventButton had not been marked as clicked
    if ( !$("#preventButton").is(".clicked") ) {
      alert("a message appears");
    }
  }, 30000);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:27:40.557

from your page source I would use something like this:

```
setTimeout(function(){
    $("#idletimeout").slideDown(); // show the warning bar
  },20000 //20 seconds
) 
```

so whenever user do on that page he will see warning box unless he clicks on the button (leave the page actually)

# xml - spss到xml的转换

> ID：13256118
> 
> 赞同：2
> 
> 时间：2012-11-06T17:20:37.493
> 
> 标签：xml, spss

我已经使用 SPSS 20 完成了缺失值分析，我想将缺失值分析转换为 XML，以便我可以将该 XML 导入 PASW 建模器。我该怎么做 ？请注意，PASW Statistics 在我的版本中不起作用

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-15T15:21:33.507

您始终可以将生成的输出复制到 excel（用 2007 年测试），应用 XML 映射，然后保存为 XML DATA 格式，冗长但它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T01:58:17.527

Are you looking for a PMML file? MVA does not support that. If you just want the output tables as XML, you can do that with OMS, but it's not obvious how Modeler would use them.

# jquery - 在另一个函数中获取 JSON 值

> ID：13256119
> 
> 赞同：0
> 
> 时间：2012-11-06T17:20:40.503
> 
> 标签：jquery, json, getjson

我对 JSON 有疑问。它看起来像这样 - 只是摘录：

```
{
    "Pizza Margharita": {
        "id": "0",        
        "price1": "4,50"        
    },
    "Pizza Caprese ": {
        "id": "1",
        "price1": "4,00"
    },
    "Pizza Salami": {
        "id": "2",
        "price1": "4,00"
    }
} 
```

我的功能如下所示：

```
$(function() {
    $.getJSON('data/food01.json', function(data) {

        $.each(data, function(name, price) {
            $('section#food01').find('ul').append('<li><a id="+order' + price.id + '" href="#order"><h3>' + name + '</h3><span>' + price.price1 + '</span></a></li>');
        }); <!-- /each -->

        $('#food01 li a').live('click', data, function(name, price) {
            var foo = name;
            $('#foodname h3').append(foo);
        });
    });
}); 
```

通过`$.each()`我从 JSON 中获取数据并将其附加到`<li>`-elements。这工作正常。现在我想在另一个函数中获取值，该函数仍然包含在 $getJSON 函数中。这是可能的还是我做错了什么？如果有人可以帮助我会很棒 - 非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:23:24.083

数据可在您的函数中访问，因此您无需将其传入！

```
$(function() {
        $.getJSON('data/food01.json', function(data) {

            $.each(data, function(name, price) {
                $('section#food01').find('ul').append('<li><a id="+order' + price.id + '" href="#order"><h3>' + name + '</h3><span>' + price.price1 + '</span></a></li>');
            }); <!-- /each -->

            $('#food01 li a').live('click', function(name, price) {
                //you can just access data here...
    var foo = name;
                $('#foodname h3').append(foo);
            });
        });

}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:48:05.217

有用！

```
$(function() {
     $.getJSON('data/food01.json', function(data) {

         $.each(data, function(name, price) {
              $('section#food01').find('ul').append('<li><a id="order'+price.id+'" href="#order"><h3>'+name+'</h3><span>'+price.price1+'</span></a></li>');
              var foodname = name;
              var id = price.id;
              $('#food01 li a').live('click', function(name, price){
                  var indexNo = $(this);
                  var indexNo2 = ($('#food01 a').index(indexNo));

                  if(indexNo2 == id) {
                         $('#foodname h3').append(foodname);
                  }<!-- if -->
              });<!-- /live -->
          });<!-- /each -->

     });<!-- /getJSON -->
   });<!-- /function --> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:35:44.623

传递给`live`或`on`可以通过事件的数据属性访问的数据参数。这是一个如何迭代的示例`data`，例如：

```
 $('#food01 li a').on('click', null, data, function(e) {
        $.each(e.data, function(name, price){
            var foo = name;
            $('#foodname h3').append(foo);
        });
    }); 
```

我不确定你需要做什么`data`，但这很容易适应。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:51:23.200

这是我尝试的答案：

```
$(function() {

    $.getJSON('data/food01.json', function(data) {

        $.each(data, function(name, price) {

            $('section#food01').find('ul').append('<li><a id="+order' + price.id + '" href="#order"><h3>' + name + '</h3><span>' + price.price1 + '</span></a></li>');

            if( /* some condition like price > 100 or name == 'Margharita'*/ ){
                $('#food01 li a').on('click', function() {
                    $('#foodname h3').append(name);
                }); // click 

            }  // if

        }); // each

    }); // getJSON

}); // ready 
```

# jquery - 检查json字符串中是否存在变量

> ID：13256123
> 
> 赞同：1
> 
> 时间：2012-11-06T17:20:52.120
> 
> 标签：jquery, json

我有一个问题，我找不到自己，所以任何帮助表示赞赏。

我有一个动态购物车，里面装满了一些 JSON 数据。在购物车中，运费也由相同的 json 数据填充。当方法可用时，脚本本身就可以工作。当该国家/地区不提供运输方式时，脚本应显示“不可用”或类似的内容。相反，它返回一个未定义的错误，导致购物车无法工作。经过一番搜索，我发现当用户来自 A 国（由购物车支持）时，Json 字符串中存在变量“methods”。当用户来自 B 国（不受支持）时，json 字符串中不存在变量“methods”。显然这会导致错误。所以我试图实现的是检查变量“方法”是否存在。我找到了一些答案，比如使用 typeof，

我的剧本

```
 <script type="text/javascript">

        function getPriceDynamicCart(price){
          price = parseFloat(price).toFixed(2);
            price = '€ ' + price.replace('.', ',');
          return price;
        }
        function loadDynamicCart(){
          var url = "{{ '/cart/' | url }}?format=json";

          $.getJSON(url,function(data){

            var cartHtml = '';
            var priceTotal = 0;
            var foundShipment = false;

             $.each(data.cart.products, function(index, product){                  

              priceTotal = priceTotal + parseFloat(product.price.price_incl);
              productTitleLimit = jQuery.trim(product.fulltitle).substring(0, 19);

              cartHtml = cartHtml +
                '<div class="cart-product"><div class="cart-quantity">' +product.quantity+'&nbsp;x&nbsp;</div><div class="cart-title"><a href="'+ product.url +'" alt="'+ product.fulltitle + '" title="'+ product.fulltitle + '">' + productTitleLimit + '</a></div><div class="cart-price">' + getPriceDynamicCart(product.price.price_incl) + '</div></div>';
            });

            $.each(data.cart.shipping.methods, function(index, method){

              if(!foundShipment && !method.cod && !method.pickup) {
                priceTotal = priceTotal + parseFloat(method.price.price_incl);
                cartHtml = cartHtml +
                  '<div class="cart-shipping"><a class="vracht" style="cursor:pointer;" rel="nofollow">Verzendkosten:<br />(Vervallen bij afhalen)</a><div class="cart-price"> ' + getPriceDynamicCart(method.price.price_incl) + '</div></div>';

                foundShipment = true;                
              }
            });

            cartHtml = cartHtml +
              '<div class="cart-total"><div class="total">Totaal(incl. btw): <span>' + getPriceDynamicCart(priceTotal) + '</span></div>';

            $('#dynamic_cart').html(cartHtml);

          });
        }

        $().ready(function(){
          loadDynamicCart();
        });
      </script> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:28:32.487

```
if(data.cart.shipping.methods !== undefined){

    $.each(data.cart.shipping.methods, function(index, method){

          if(!foundShipment && !method.cod && !method.pickup) {
            priceTotal = priceTotal + parseFloat(method.price.price_incl);
            cartHtml = cartHtml +
              '<div class="cart-shipping"><a class="vracht" style="cursor:pointer;" rel="nofollow">Verzendkosten:<br />(Vervallen bij afhalen)</a><div class="cart-price"> ' + getPriceDynamicCart(method.price.price_incl) + '</div></div>';

            foundShipment = true;                
          }
        });
}else{
  cartHtml = cartHtml +
              '<div class="cart-shipping"><a class="vracht" style="cursor:pointer;" rel="nofollow">Verzendkosten:<br />(Vervallen bij afhalen)</a><div class="cart-price">**Anything you care to write**</div></div>';
} 
```

那应该行得通。

编辑，我添加了一条 else 语句来设置 cartHtml 变量，这样您就可以更加灵活地供将来使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:27:27.767

您可以在调用之前检查该`data.cart.shipping.methods`属性是否为空/未定义`each`：

```
if (data.cart.shipping.methods) {
    $.each(data.cart.shipping.methods, function(index, method){
    //...
    }
} 
```

# c# - KinectColorViewer 和 SDK 1.6

> ID：13256124
> 
> 赞同：2
> 
> 时间：2012-11-06T17:20:55.450
> 
> 标签：c#, wpf, xaml, visual-studio-2012, kinect

我是 Kinect 和 VS 开发的新手，我使用的是[Windows Kinect Quickstart Series](http://channel9.msdn.com/Series/KinectQuickstart)，但不幸的是，它适用于 Kinect SDK v1.00。

我被 KinectColorView 的使用卡住了，我无法继续（我已经用谷歌搜索了 2 天了）。我还发现了这个非常相似的问题：在 StackOverflow 上[的 SDK1.5 中使用 KinectColorViewer](https://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5)但无法解决我的问题。我知道我很接近，但我需要帮助。

**问题是：我无法让我的 KinectColorViewer 工作。**

我将它添加到 XAML 设计器，但似乎我无法将它绑定到 SensorManager。这是我的 XAML 代码：

```
<Window
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:WpfViewers="clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers" xmlns:Toolkit="clr-namespace:Microsoft.Kinect.Toolkit;assembly=Microsoft.Kinect.Toolkit" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d" x:Class="KinectSetupDev.MainWindow"
    Title="MainWindow" Height="768" Width="1024" Loaded="Window_Loaded_1" Closed="Window_Closed_1">

    <Grid HorizontalAlignment="Left" Height="736" VerticalAlignment="Top" Width="1012" Margin="2,2,0,0">
         <TextBlock x:Name="tbMessages" HorizontalAlignment="Left" Height="60" Margin="10,662,0,0" TextWrapping="Wrap" VerticalAlignment="Top" Width="992"/>
         <WpfViewers:KinectColorViewer x:Name="KinectColorViewer" KinectSensorManager="{Binding KinectSensorManager}" HorizontalAlignment="Left" Height="240" Margin="608,27,0,0" VerticalAlignment="Top" Width="320" BorderThickness="1" BorderBrush="Black"/>
    </Grid>
</Window> 
```

没有关于 XAML 代码的报告，除了我必须添加块

```
"KinectSensorManager="{Binding KinectSensorManager}" 
```

在 KinectColorViewer 项目中通过编写它，因为我无法通过 XAML 设计器的 GUI 找到解决方法（所以我对它的可行性有些怀疑）。

这是我的代码隐藏（*我几乎完全复制了它的问题：[Using KinectColorViewer in SDK1.5](https://stackoverflow.com/questions/12609858/using-kinectcolorviewer-in-sdk1-5) so I can't understand why it's not working!!*）

```
namespace KinectSetupDev
{
  public partial class MainWindow : Window
  {
    // Automatically finds a Kinect for you.
    private readonly KinectSensorChooser sensorChooser = new KinectSensorChooser();

    public KinectSensorManager KinectSensorManager01 { get; private set; }

    public MainWindow()
    {
        InitializeComponent();
        DataContext = this;

    }

    private void Window_Loaded_1(object sender, RoutedEventArgs e)
    {
        // Initialize the Kinect sensor manager.
        KinectSensorManager01 = new KinectSensorManager();
        KinectSensorManager01.KinectSensorChanged += this.KinectSensorChanged;

        // Locate an available sensor.
        sensorChooser.Start();

        // Bind chooser's sensor value to the local sensor manager.
        var kinectSensorBinding = new Binding("Kinect") { Source = this.sensorChooser };
        BindingOperations.SetBinding(this.KinectSensorManager01, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);
    }

    private void Window_Closed_1(object sender, EventArgs e)
    {
        UninitializeKinectServices(KinectSensorManager01.KinectSensor);
    }

    #region Kinect Discovery & Setup

    private void KinectSensorChanged(object sender, KinectSensorManagerEventArgs<KinectSensor> args)
    {
        if (null != args.OldValue)  
            UninitializeKinectServices(args.OldValue);

        if (null != args.NewValue)
            InitializeKinectServices(KinectSensorManager01, args.NewValue);
    }

    // Kinect enabled apps should customize which Kinect services it initializes here.
    private void InitializeKinectServices(KinectSensorManager kinectSensorManager, KinectSensor sensor)
    {
        // Application should enable all streams first.
        kinectSensorManager.ColorStreamEnabled = true;
        kinectSensorManager.DepthStreamEnabled = true;
        kinectSensorManager.SkeletonStreamEnabled = true;

        // Start the sensor!
        try
        {
            sensor.Start();
            sensorChooser.Kinect.ElevationAngle = 10;
            tbMessages.Text = "Kinect Started";
        }
        catch (System.IO.IOException)
        {
            sensor = null;
            tbMessages.Text = "Kinect Not Started" + "\r";
        }
    }

    // Kinect enabled apps should uninitialize all Kinect services that were initialized in InitializeKinectServices() here.
    private void UninitializeKinectServices(KinectSensor sensor)
    {
        if (sensor != null)
        {

            if (sensor.IsRunning)
            {
                sensorChooser.Kinect.ElevationAngle = 0;
                sensor.Stop();
                sensor.AudioSource.Stop();

            }
        }
    }

    #endregion Kinect Discovery & Setup

  }
} 
```

我试图在构造函数中添加该行 `DataContext = this;` ，但它不起作用。

**应用程序运行，我的 Kinect 启动，但 KinectColorViewer 不显示任何内容。**

*此外，谁能说出和之间的* `sensor.SkeletonStream.Enable();` *区别* `kinectSensorManager.SkeletonStreamEnabled = true;` *？？*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T19:27:37.383

在您的 XAML 中，您绑定到`KinectSensorManager`，它不存在。您在代码中调用它`KinectSensorManager01`，因此您需要在 XAML 中正确反映它。

这可能会解决它。但我看到的另一件事是，您至少以 3 种不同的方式访问传感器。这涉及到你的第二个问题。

你用`sensor.SkeletonStream.Enabled()`and做同样的事情`kinectSensorManager.SkeletonStreamEnabled = true`，你只是用不同的方式去做。这`KinectSensorManager`是一个包裹在 Kinect 硬件上的数据模型，它为你管理许多平凡的小事情。如果您要使用它（我个人一直都这样做），那么您应该始终使用它来访问硬件。这将确保您的参考资料永远不会不同步。

因此，在您的`InitializeKinectServer`函数中，您不想使用`sensor.Start()`and `sensorChooser.Kinect.ElevationAngle`。您想使用相应的`KinectSensorManager`调用。

这是一个快速而肮脏的应用程序，仅显示 KinectColorChooser：

主窗口.xaml

```
<Window x:Class="SimpleKinectStart.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:viewer="clr-namespace:Microsoft.Samples.Kinect.WpfViewers;assembly=Microsoft.Samples.Kinect.WpfViewers"
        Title="MainWindow" Height="350" Width="525">
    <Grid>
        <viewer:KinectColorViewer KinectSensorManager="{Binding KinectSensorManager}" />
    </Grid>
</Window> 
```

主窗口.xaml.cs

```
using System.ComponentModel;
using System.Windows;
using System.Windows.Data;
using Microsoft.Kinect;
using Microsoft.Kinect.Toolkit;
using Microsoft.Samples.Kinect.WpfViewers;

namespace SimpleKinectStart
{
    /// <summary>
    /// Interaction logic for MainWindow.xaml
    /// </summary>
    public partial class MainWindow : Window
    {
        private readonly KinectSensorChooser _sensorChooser = new KinectSensorChooser();

        public MainWindow()
        {
            InitializeComponent();

            DataContext = this;

            if (DesignerProperties.GetIsInDesignMode(this))
            {
                // do something special, only for design mode
            }
            else
            {
                KinectSensorManager = new KinectSensorManager();
                KinectSensorManager.KinectSensorChanged += OnKinectSensorChanged;

                _sensorChooser.Start();

                if (_sensorChooser.Kinect == null)
                {
                    MessageBox.Show("Unable to detect an available Kinect Sensor");
                    Application.Current.Shutdown();
                }

                // Bind the KinectSensor from the sensorChooser to the KinectSensor on the KinectSensorManager
                var kinectSensorBinding = new Binding("Kinect") { Source = _sensorChooser };
                BindingOperations.SetBinding(this.KinectSensorManager, KinectSensorManager.KinectSensorProperty, kinectSensorBinding);
            }
        }

        #region Kinect Discovery & Setup

        private void OnKinectSensorChanged(object sender, KinectSensorManagerEventArgs<KinectSensor> args)
        {
            if (null != args.OldValue)
                UninitializeKinectServices(args.OldValue);

            if (null != args.NewValue)
                InitializeKinectServices(KinectSensorManager, args.NewValue);
        }

        /// <summary>
        /// Initialize Kinect based services.
        /// </summary>
        /// <param name="kinectSensorManager"></param>
        /// <param name="sensor"></param>
        private void InitializeKinectServices(KinectSensorManager kinectSensorManager, KinectSensor sensor)
        {
            // configure the color stream
            kinectSensorManager.ColorFormat = ColorImageFormat.RgbResolution640x480Fps30;
            kinectSensorManager.ColorStreamEnabled = true;

            // configure the depth stream
            kinectSensorManager.DepthStreamEnabled = true;

            kinectSensorManager.TransformSmoothParameters =
                new TransformSmoothParameters
                {
                    // as the smoothing value is increased responsiveness to the raw data
                    // decreases; therefore, increased smoothing leads to increased latency.
                    Smoothing = 0.5f,
                    // higher value corrects toward the raw data more quickly,
                    // a lower value corrects more slowly and appears smoother.
                    Correction = 0.5f,
                    // number of frames to predict into the future.
                    Prediction = 0.5f,
                    // determines how aggressively to remove jitter from the raw data.
                    JitterRadius = 0.05f,
                    // maximum radius (in meters) that filtered positions can deviate from raw data.
                    MaxDeviationRadius = 0.04f
                };

            // configure the skeleton stream
            kinectSensorManager.SkeletonStreamEnabled = true;

            // enable the sensor
            kinectSensorManager.KinectSensorEnabled = true;
        }

        /// <summary>
        /// Uninitialize all Kinect services that were initialized in InitializeKinectServices.
        /// </summary>
        /// <param name="sensor"></param>
        private void UninitializeKinectServices(KinectSensor sensor)
        {
            // do what needs to be done
        }

        #endregion Kinect Discovery & Setup

        #region Properties

        public KinectSensorManager KinectSensorManager { get; private set; }

        #endregion Properties
    }
} 
```

使用时，`KinectSensorManager`您总是希望尽可能使用传感器管理器提供的包装器。因此，您可能希望`kinectSensorManager.ElevationAngle`在 init 函数或`KinectSensorManager.ElevationAngle`其他地方使用（注意本地调用与全局调用之间的区别）。这允许传感器管理器尝试并按照您的要求进行操作，并在需要时优雅地失败。

在该`UninitializeKinectServices`功能中，您只会直接处理传感器。当您点击此功能时，`KinectSensorChooser`要么选择了新的 Kinect，要么丢失了它并将传感器设置为`null`。您正在处理此函数中的*旧*传感器值，清理曾经链接到它的服务。您所做的任何参考都`KinectSensorManager`将是新传感器或`null`参考。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-11T18:54:32.720

我手动添加了 Path 属性，它对我有用：

```
<WpfViewers:KinectColorViewer HorizontalAlignment="Left" Height="221" Margin="75,84,0,0" VerticalAlignment="Top" Width="372" Kinect="{Binding ElementName=kinectSensorChooser1, Mode=OneWay,Path=Kinect}"/> 
```

# email - 没有gmail的内联图像嵌入？

> ID：13256127
> 
> 赞同：0
> 
> 时间：2012-11-06T17:21:07.610
> 
> 标签：email, gmail, inline, embedding

您可以在不是 gmail 的电子邮件中嵌入内联图像吗？我找到了这个，但我认为它仅适用于 gmail？

[Gmail 中的 HTML 电子邮件 - 嵌入图像](https://stackoverflow.com/questions/7292760/html-email-in-gmail-embedding-images/13256105#13256105)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:40:37.340

[http://email.about.com/od/windowslivehotmailtips/qt/et_inline_image.htm](http://email.about.com/od/windowslivehotmailtips/qt/et_inline_image.htm) 有一篇博文详细解释了这一点，我其实认为大多数电子邮件服务都支持内联图像嵌入

# python - 根据Python中的不等式选择数组的子集

> ID：13256128
> 
> 赞同：2
> 
> 时间：2012-11-06T17:21:23.263
> 
> 标签：python, arrays, numpy

假设我有以下设置：

```
x=np.array(range(0,100))
y=x**0.5
z=x**2 
```

我怎样才能获得 4 到 8 之间的所有 y 值，并创建一个新数组，其中包含这些 y 值的一行，以及相应的 z 值的一行？

即 x 中的 25 的 y 值为 5，介于 4 和 8 之间，我想要这个值，但我也想要下面行中的 z 值 625。

数学方程只是一个例子，论坛可以是任何东西，包括贝塞尔函数。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:26:21.707

```
>>> np.vstack((y, z))[:,(y >= 4) & (y <= 8)]
array([[  4.00000000e+00,   4.12310563e+00,   4.24264069e+00,
          4.35889894e+00,   4.47213595e+00,   4.58257569e+00,
          4.69041576e+00,   4.79583152e+00,   4.89897949e+00,
          ...
          7.81024968e+00,   7.87400787e+00,   7.93725393e+00,
          8.00000000e+00],
       [  2.56000000e+02,   2.89000000e+02,   3.24000000e+02,
          3.61000000e+02,   4.00000000e+02,   4.41000000e+02,
          ...
          3.72100000e+03,   3.84400000e+03,   3.96900000e+03,
          4.09600000e+03]]) 
```

在这里，`vstack()`创建一个包含两行的矩阵，一行包含`y`，一行包含`z`。然后`[...]`消除那些不满足标准的列。

# javascript - 作用域中的所有指令都准备好后如何运行事件？

> ID：13256130
> 
> 赞同：0
> 
> 时间：2012-11-06T17:21:32.307
> 
> 标签：javascript, angularjs

我正在使用修改 DOM 的指令，因此必须在调用所有 postLink fns 后完成。（[参见 angular-ui 模块/指令/select2/select2.js:103](https://github.com/angular-ui/angular-ui/blob/5279043da2885d7bdeb487a3569ec9dea83e6217/modules/directives/select2/select2.js#L103)）

给定某些先决条件（未在 URL 中编码），我想将焦点设置到页面上的第一个 select2 元素。这是有问题的，因为在设置焦点之前，必须初始化 select2，并且没有一些俗气的任意延迟 > 0，我无法安排要设置焦点的广播事件。

我创建了以下指令，它将侦听焦点 primaryInput/focus 事件并设置焦点。

```
# TODO - should we create a directive for tab order instead?
app.directive "primaryInput", () ->
  {
    name: "primaryInput"
    link: (scope, element, attrs) ->
      scope.$on "primaryInput/focus", ->
        element.focus()
  } 
```

更改 primaryInput 指令的优先级不起作用，因为任何优先级都将在调度 setTimeout 函数之前运行。

理想情况下，我希望能够拥有一组承诺，每个延迟指令推送到堆栈，然后在所有这些承诺完成后得到解决的承诺。我会把我的问题集中在如何最好地实现这一点上，但我已经想到了一个不太好的方法，想探索更好的方法，并想避免[XY 问题](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)。

谢谢！

# 更新

在经历了在这里描述问题的努力之后，退后一步，我想到了一种可以接受的方法来解决我的问题，并将回答我自己的问题，但如果有人有更好的方法，请保持开放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:16:55.957

由于延迟执行的复杂性存在于处理 Select2 的指令中，所以我现在决定在此处隔离该复杂性。

我在我的 Select2 指令中覆盖了元素上的焦点函数，因此一旦它可用，焦点调用就会转发到 select2 实例。这样，可以告诉元素在 select2 之前聚焦。

我的焦点指令：

```
app.directive "input", ($injector) ->
  primaryMatcher = (e,attrs) ->
    attrs.primary?
  {
    name: "inputFocus"
    restrict: 'E'
    link: (scope, element, attrs) ->
      scope.$on "focus", (e, matcher)->
        if ((matcher || primaryMatcher)(element, attrs))
          console.log("focus", element, attrs)
          element.focus()
  } 
```

在我的 Select2 指令中：

```
app.directive "s2Factor", () ->
  # ...
  {
    name: "s2Factor"
    require: "?ngModel"
    priority: 1
    restrict: "A"
    link: (scope, el, attr, controller) ->
      select2_p = $.Deferred()
      # ...
      setTimeout ->
        el.select2 opts
        select2_p.resolve(el.data("select2"))

      el.focus = () ->
        select2_p.then (select2) ->
          select2.focus()
  } 
```

它涉及实例猴子修补，但我发现在这种情况下它是可以接受的。

# android - Android SQLite 旧数据

> ID：13256132
> 
> 赞同：0
> 
> 时间：2012-11-06T17:21:37.753
> 
> 标签：android, sqlite

我正在使用 SQLite 数据库测试应用程序。当我在模拟器中运行项目（即重新安装）时，以前安装的旧数据仍然存在于数据库中。是否可以调用类似 unInstall 方法来擦除旧数据并重新开始？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:28:23.097

您可以从 DDMS 中删除应用程序的数据。在文件资源管理器中找到您的应用程序的主文件夹（通常是`/data/data/<package_name>`）并在那里删除您的数据库文件。在您的应用程序的下一次运行期间，将创建一个新数据库。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:52:50.143

您可以简单地更改代码中的 DATABASE_VERSION 字段。在下一次运行中，将重新创建数据库。

# syntax-error - 如何编写多行错误格式字符串？

> ID：13256135
> 
> 赞同：1
> 
> 时间：2012-11-06T17:22:02.617
> 
> 标签：syntax-error, opencl, vim, errorformat

我想为[vim-opencl 插件](https://github.com/petRUShka/vim-opencl)编写 OpenCL 语法检查器。OpenCL 编译器对输出错误进行了一些奇怪的格式化。有两种类型的错误。

正常（带有小错误说明）：

```
"/tmp/OCLUKvOsF.cl", line 143: error: expression must have integral type
        rec_table[PRIME_P - ri] = PRIME_P - i;
                  ^ 
```

并且错误解释中的换行符不正常：

```
"/tmp/OCLUKvOsF.cl", line 148: error: a value of type "uint16" cannot be used
          to initialize an entity of type "uint"
    uint a = value, b = PRIME_P, u = 0, v = 0;
             ^ 
```

因此，麻烦在于将第二种情况下的损坏错误解释和第一种情况下的正常错误处理的两部分串联起来。

我使用[syntastic](https://github.com/scrooloose/syntastic)作为通用语法检查器。现在我有这样的代码：

```
let errorformat = '%E"%f"\, line %l: error: %m,%+C%.%#,%-Z%p^,'.
                  \'%W"%f"\, line %l: warning: %m,%-C%.%#,'.
                  \'%-G%.%#' 
```

因此，第一个和第二个错误如下所示：

```
program.cl|143 error| expression must have integral type rec_table[PRIME_P - ri] = PRIME_P - i; ^
program.cl|148 col 14 error| a value of type "uint16" cannot be used to initialize an entity of type "uint" uint a = value, b = PRIME_P, u = 0, v = 0; 
```

几乎没问题（尤其是在第二种情况下），但我不知道如何做到这一点：

```
program.cl|143 col 19 error| expression must have integral type
program.cl|148 col 14 error| a value of type "uint16" cannot be used to initialize an entity of type "uint" 
```

或者至少是这样的：

```
program.cl|143 col 19 error| expression must have integral type rec_table[PRIME_P - ri] = PRIME_P - i;
program.cl|148 col 14 error| a value of type "uint16" cannot be used to initialize an entity of type "uint" uint a = value, b = PRIME_P, u = 0, v = 0; 
```

你有什么想法吗？

UPD。更新了错误格式和期望

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T00:46:00.217

我不知道测试这个的有用方法，但你也需要用反斜杠转义你的空格。

我还可以在 s 之后放置一个 -space，`%C`以便它们只匹配以空格开头的行。

最后，对于警告，您忽略了一些行并且永远没有`%Z`任何地方。（我认为您不需要 Z 前面的减号，但我不清楚；我自己不使用减号。

祝你好运。

# wordpress - .htaccess mod_rewrite 域到子目录（多个站点）

> ID：13256138
> 
> 赞同：0
> 
> 时间：2012-11-06T17:22:17.983
> 
> 标签：wordpress, apache, .htaccess, mod-rewrite, rewrite

我正在尝试使用 .htaccess 文件将域重写到托管服务提供商中的子目录，因为我无权访问 Apache 配置文件。在我的 web 目录中，我在 web 根目录 (/home/www/) 中有一个 Wordpress 安装。假设域 www.main-site.com 指向该站点。这个 WP 安装服务于我的主要网站。

然后在这个目录中，我为客户托管了 3 个其他 Wordpress 安装。文件结构类似于（/home/www/example1、/home/www/example2 和 /home/www/example3）。这些网站中的每一个都需要自己的域。（即 www.example1.com、www.example2.com、www.example3.com）。

我如何使用 .htaccess 文件来确保当有人点击 www.main-site.com 时，他们会登陆我的个人网站，但是当他们导航到 www.example1.com 时，它会将他们指向子目录“/example1”？

目前，如果我去 www.main-site.com 一切正常。此外，如果我访问 www.example1.com，它会正确转发到我的子目录站点（我认为这是通过我的网络托管服务提供商的管理面板自动设置的。）但是，一旦我单击第一个链接转到另一个页面www.example1.com，而不是看起来像 www.example1.com/new-page.html，它看起来像 www.main-site.com/example1/new-page.html。您可以看到它正在拉入我的主站点的网址。我不想要这个。

有什么想法吗？

我的代码如下。

**我的网络根 .htaccess 文件中的代码：**

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /index.php [L]
</IfModule> 
```

**我的子目录的 .htaccess 文件中的代码：**

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteBase /example1/
RewriteRule ^index\.php$ - [L]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule . /example1/index.php [L] 
```

# php - 如何使用 CSS 在图像上创建虚线阴影效果？

> ID：13256143
> 
> 赞同：-2
> 
> 时间：2012-11-06T17:22:36.643
> 
> 标签：php, html, css

当您将鼠标悬停在他们的图像上时，我想创建可以在网站[http://www.murmure.me/上看到的效果。](http://www.murmure.me/)

我知道他们使用两张不同的图像，但我希望能够在没有 2 张图像的情况下实现这种效果，只需一张图片（没有圆点的那张）并使用 CSS。是否可以 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:38:44.113

这非常接近：http: [//jsfiddle.net/LfXN3/8/](http://jsfiddle.net/LfXN3/8/)

但是，它需要第二个元素（不是图像，只是元素）。伪元素方法不起作用，因为它的不透明度无法动画化。

```
<div>
    <div id="overlay"></div>
</div>​ 
```

CSS

```
div{
    background:url(http://placekitten.com/600/600) center center;
    width:400px;
    height:400px;

    -webkit-transition:all 2s;
    -webkit-filter: grayscale(100%);
}

div:hover{
    -webkit-filter: grayscale(0%);
}

div #overlay{
    opacity:.5;
    display:block;
    background: -webkit-linear-gradient(45deg, #777 25%, transparent 25%, transparent), -webkit-linear-gradient(-45deg, #777 25%, transparent 25%, transparent), -webkit-linear-gradient(45deg, transparent 75%, #777 75%), -webkit-linear-gradient(-45deg, #000 75%, #777 75%);

    background-size:2px 2px;
    width:400px;
    height:400px;

    -webkit-transition:opcaity 2s;
}

div:hover #overlay{
    opacity:0;   
} 
```

通过将 Dudley Storey 的技术融入我的技术中，我设法让这一点更接近：http: [//jsfiddle.net/LfXN3/14/](http://jsfiddle.net/LfXN3/14/)

主要区别在于：

```
div #overlay{
    opacity:1;
    display:block;
    background: -webkit-radial-gradient(rgba(0,0,0,0) 45%, rgba(0,0,0,0.4) 46%),
-webkit-radial-gradient(rgba(0,0,0,0) 45%, rgba(0,0,0,0.4) 46%),
    url(http://placekitten.com/600/600);
    background-position: 0 0, 2px 2px, center center;
    background-size:4px 4px, 4px 4px, 600px 600px;
    width:400px;
    height:400px;

    -webkit-transition:opacity 2s;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T16:12:46.457

[是的，可以在我的博客上使用纯 CSS3 和过滤器：演示和简要说明，](http://demosthenes.info/blog/613/Create-a-Silkscreen-Effect-For-Web-Images-With-CSS3)使用单个图像来完成。现在，在 Firefox 中灰度到颜色的转换似乎特别慢（因为它必须使用与过滤器等效的 SVG），所以我暂时从演示中删除了它。

```
div#silkscreen {
background:
-webkit-radial-gradient(rgba(0,0,0,0) 45%, rgba(0,0,0,0.4) 46%),
-webkit-radial-gradient(rgba(0,0,0,0) 45%, rgba(0,0,0,0.4) 46%), 
url(lotus.jpg);
background: -moz-radial-gradient(rgba(0,0,0,0) 45%, rgba(0,0,0,0.4) 46%),
-moz-radial-gradient(rgba(0,0,0,0) 45%, rgba(0,0,0,0.4) 46%), 
url(lotus.jpg);
background-position: 0 0, 2px 2px;
background-size:4px 4px, 4px 4px, cover;
-webkit-filter: grayscale(1);
filter: url(desaturate.svg#greyscale);
filter: grayscale(1);
transition: 1.3s;
}
div#silkscreen:hover { -webkit-filter: grayscale(0); filter: none; }
div#silkscreen img { max-width: 100%; opacity: 0; }}
div#silkscreen:hover { -webkit-filter: grayscale(0); }
div#silkscreen img { max-width: 100%; opacity: 0; }

<div id=silkscreen>
<img src=lotus.jpg alt="">
</div> 
```

我希望这有帮助！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:33:18.840

Mikel，您无法使用 CSS 和单个图像来实现丝印效果。
它不会以任何跨浏览器兼容的方式很快发生。

也许，最终，当您可以使用 HLSL 或类似工具自定义编程 CSS 过滤器时......
但就目前而言，即使使用近乎未来的 CSS 过滤器，我认为他们不会提供丝绸-screen，然后，您需要担心这一点，以及过渡效果，然后您需要担心浏览器支持，以及其他浏览器的 2-image 后备...

即：您必须首先创建第二张图像并编写您希望有一个 CSS 过滤器的 2 张图像后备，以避免制作第二张图像。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:47:02.427

虽然可以使用 css3 灰度滤镜将彩色图像转换为灰度，但它目前仅适用于 Chrome。

```
-webkit-filter: grayscale(100%); 
```

在不使用 jQuery 的情况下获得该效果的一种解决方法是使用两个图像和 css3 过渡。

```
-webkit-transition: opacity 0.5s;
-moz-transition:    opacity 0.5s;
-o-transition:      opacity 0.5s; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T18:05:45.980

如何使用原始图片（不带点）和另一个仅由一个小点组成的图像（类似于[http://www.scottecatalog.com/images.nsf/Images/dot/$FILE/Dot.gif](http://www.scottecatalog.com/images.nsf/Images/dot/)）和使用重复属性，在原始图像上重复点，点之间有正确的空间并具有 z-index 属性（以便将点放置在原始图像的字体中）？

我们仍在使用 2 张图片，但至少可以轻松地为任何图像复制此效果，无论您在其下拥有什么原始图像。这有意义吗？

# html - Twitter Bootstrap 标头中的 Z-Index 问题

> ID：13256144
> 
> 赞同：1
> 
> 时间：2012-11-06T17:22:52.380
> 
> 标签：html, css, twitter-bootstrap, header, z-index

我有以下代码创建 Twitter Bootstrap 标头。标题在功能上工作得很好，但是当我使用较小的浏览器并且标题最小化为下拉菜单时，标题的背景不会显示在网页上的内容前面。因此，例如，标题的文本将在前面，但图像和文本输入之类的内容会显示在下拉背景的前面。我没有更改任何 twitter bootstrap css，这是我的 HTML：

```
<div class="navbar navbar-fixed-top">
              <div class="navbar-inner">
                <div class="container">
                  <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                  </a>
                  <a class="brand" href="/">Exployre</a>
                  <div class="nav-collapse">
                    <ul class="nav">

                      <li><a href="/map">Find</a></li>
                      <li><a href="/shareadventure">Share</a></li>
                      <li><a href="/connect">Connect</a></li>
                      <li><a href="/posts">Discuss</a></li>
                      <li><a href="/profile">Profile</a></li>
                      <li><a href="/about">About</a></li>
                      <li>
                  <li>        
                <form action="/search" class="navbar-search">
                  <div>
                    <input type="text" placeholder="Search" class="search-query pull-right" name="q" size="55" />
                  </div>
                </form>
                  </li>

                    </ul>
                  </div><!--/.nav-collapse -->
                </div>
              </div>
            </div> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T19:54:33.873

设计问题？也许（如果您没有更改 CSS 样式表中的任何内容）

这个选择器有这个 CSS 属性

```
.navbar-fixed-top, .navbar-fixed-bottom {
  position: fixed;
  /* other properties */
} 
```

但是在媒体查询得到这个之后

```
@media (max-width: 979px)
.navbar-fixed-top, .navbar-fixed-bottom {
  position: static;
} 
```

那`position: static;`是罪魁祸首......它应该是`relative/fixed`或者只是删除它。

**来源**：

[....position: static 表示“忽略左侧、顶部、z-index 等所有定位指令”。](https://stackoverflow.com/a/8486532/1055987)

# wpf - 如何使用静态方法作为 CallMethodAction 的目标？

> ID：13256145
> 
> 赞同：1
> 
> 时间：2012-11-06T17:23:08.577
> 
> 标签：wpf, xaml

```
xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
xmlns:ei="http://schemas.microsoft.com/expression/2010/interactions"
 <Button Content="Status">
        <i:Interaction.Triggers>
            <i:EventTrigger EventName="Click">
                <ei:CallMethodAction MethodName="ResetStatus" TargetObject="{StaticResource Domain.Adapters.IIS}"/>
            </i:EventTrigger>
        </i:Interaction.Triggers>
    </Button> 
```

启动时抛出异常。可以`CallMethodAction`调用静态方法吗？

# c++ - 构造函数问题

> ID：13256147
> 
> 赞同：6
> 
> 时间：2012-11-06T17:23:17.300
> 
> 标签：c++

> **可能重复：**
> [带空括号的默认构造函数](https://stackoverflow.com/questions/180172/default-constructor-with-empty-brackets)

这是我处理的代码，我不明白它在构造函数 Package obj2() 上发生了什么；输出时仅显示值 4 (Package obj1(4)) 和 2 (Package obj3(2))

```
#include <iostream>
using namespace std;
class Package
{
private:
    int value;
public:
    Package()
    {
        cout<<"constructor #1"<<endl;
        value = 7; cout << value << endl;

    }
    Package(int v)
    {
        cout<<"constructor #2"<<endl;
        value = v; cout << value << endl;

    }
    ~Package()
    {
        cout<<"destructor"<<endl;
        cout << value << endl;
    }
};

int main()
{
    Package obj1(4);
    Package obj2();
    Package obj3(2);

} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T17:25:49.097

这不声明一个对象：

```
Package obj2(); 
```

信不信由你，它声明了一个返回`Package`对象的函数。它被称为“[最令人头疼的解析](http://en.wikipedia.org/wiki/Most_vexing_parse)”。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T17:28:14.177

线

```
Package obj2(); 
```

需要是

```
Package obj2; 
```

更多信息

[http://www.parashift.com/c++-faq/empty-parens-in-object-decl.html](http://www.parashift.com/c++-faq/empty-parens-in-object-decl.html)

或者，替代方案（来自谷歌缓存，真实站点已关闭，并对其持保留态度，它会提高优点，但会尽力使它们听起来比实际更糟）：

[http://webcache.googleusercontent.com/search?q=cache:http://yosefk.com/c%2B%2Bfqa/ctors.html#fqa-10.2](http://webcache.googleusercontent.com/search?q=cache:http://yosefk.com/c%2B%2Bfqa/ctors.html#fqa-10.2)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-06T17:30:00.347

如果您使用的是 C++11，并且想要解决“最棘手的解析”问题，您可以替换

```
Package obj2(); 
```

和

```
Package obj2{}; 
```

这是C++11[统一初始化语法](http://en.wikipedia.org/wiki/C%2B%2B11#Uniform_initialization)的一部分，主要是为了解决这个问题而设计的。

# cocoa - windowWillResize 移动窗口的原点

> ID：13256150
> 
> 赞同：0
> 
> 时间：2012-11-06T17:23:27.997
> 
> 标签：cocoa, nswindow

我目前正在使用 windowWillResize 来控制我的一个窗口相对于它的一个视图的纵横比。一切似乎都工作正常，除了调整窗口大小也会垂直移动它，每次调整大小时都会稍微移动它。使用 setContentAspectRatio 不会产生这种情况，但这不是我的选择，因为我在窗口中有其他视图。

关于为什么窗户可能会移动的任何想法，更重要的是，它是否可以预防？这是代码：

```
- (NSSize)windowWillResize:(NSWindow *)sender toSize:(NSSize)frameSize
{
    NSRect windowFrame = [self.window frame];
    NSRect viewRect = [self.screen convertRect:[self.screen bounds] toView: nil];
    NSRect contentRect = [self.window contentRectForFrameRect:windowFrame];

    float marginY = viewRect.origin.y + windowFrame.size.height - contentRect.size.height;
    float marginX = contentRect.size.width - viewRect.size.width;

    frameSize.height = (frameSize.width - marginX) * HEIGHT_DEFAULT / WIDTH_DEFAULT + marginY;

    return frameSize;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T16:26:07.363

我通过更改“frameSize”的宽度而不是高度来解决此问题：

```
frameSize.width = (frameSize.height - marginY) / (HEIGHT_DEFAULT / WIDTH_DEFAULT) + marginX; 
```

如果窗口缩小到负大小，这会产生奇怪的窗口大小调整伪影，但设置最小大小限制可以解决此问题。

# css - 使用 CSS3 对阴影的角度效果

> ID：13256151
> 
> 赞同：2
> 
> 时间：2012-11-06T17:23:27.657
> 
> 标签：css

我想创建一个类似于[http://www.thegrovechurch.org 滑块上的阴影。](http://www.thegrovechurch.org)

我已经在 Photoshop 中重新创建了它，但我不确定如何使用纯 CSS 来完成它，这会更好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:25:43.210

这是一个生成器，因此您可以随意自定义阴影：

[http://css3gen.com/box-shadow/](http://css3gen.com/box-shadow/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:26:01.780

你可以试试这个，几乎接近那个；）

[**演示**](http://jsfiddle.net/QEm24/1/)

```
.shadow {
    box-shadow: 0 8px 6px -6px #000;
    -webkit-box-shadow: 0 8px 6px -6px #000;
    -moz-box-shadow: 0 8px 6px -6px #000;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:36:23.467

我不认为你可以用 CSS 做到这一点。[http://www.thegrovechurch.org/](http://www.thegrovechurch.org/)使用图像。

如果您使用的语言实际上可以在数学系中进行一些繁重的工作，您可能能够产生类似的东西 - jquery 和 javascript 将是我寻找的下一个地方，如果没有，那么还有一个 java 小程序 - 但即使那样我也会担心大多数浏览器处理起来太麻烦和太慢。

# java - 带有 cacerts 的自定义 trustStore 作为不在自定义 trustStore 中的密钥的后备

> ID：13256154
> 
> 赞同：14
> 
> 时间：2012-11-06T17:23:51.727
> 
> 标签：java, ssl

有没有办法通过命令行或自定义信任管理器来创建由 cacerts 支持的自定义 trustStore？

该应用程序使用自定义 trustStore：

```
-Djavax.net.ssl.trustStore=/SSL/CATrust.jks 
```

持有我们自己的信任证书，这是在自定义文件中完成的，以简化 JDK 的升级，而无需迁移 cacerts。

问题是 cacerts 携带了这么多标准证书，我们还没有将它们导入 CATrust.jks。因此，我们收到 SSL 错误，因为通过命令行属性提供的自定义 CATrust.jks 是独占的，而不是附加的（除了 cacerts 证书）。

那么有没有办法提供自定义的信任库，如果在该信任库中找不到证书，服务器/应用程序将回退到尝试在 cacerts（或辅助信任库）中查找证书？

到目前为止，从最初的阅读和其他帖子来看，信息只讨论了所有 CA 证书所在的单个 trustStore。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-07T02:51:50.017

作为部署的一部分，您可以复制默认值`cacerts`并将您自己的密钥库的内容导入其中（或相反）：

```
cp /path/to/cacerts merged.jks
keytool -importkeystore -srckeystore /SSL/CATrust.jks -destkeystore merged.jks 
```

避免使用相同的别名肯定会更好（检查选项以`keytool -importkeystore`获取更多详细信息，特别是如果这必须是脚本的一部分）。

# javascript - 在Javascript中第N次出现插入中断

> ID：13256158
> 
> 赞同：0
> 
> 时间：2012-11-06T17:24:09.657
> 
> 标签：javascript, string

我正在尝试找到将中断插入到时间字符串中的“最佳”方法，以便它占用两行并始终在同一个地方拆分（例如，11 月 5 日星期五上午 11:11 到 11 月 5 日星期五休息 11：上午11点）。

我不想更改字符串所在的 div 的宽度，因为如果没有选择时间，则会显示警告消息。我知道我可以使用 .split() 函数将字符串拆分为空格并将其重建为我想要的字符串，但我认为必须有更好的方法。

最好有一种方法来遍历（不一定划分）字符串以找到不止一次出现的元素。所以你可以做一些像词汇工具这样的东西，它可以改变你下次使用单词的颜色，或者像赎金票据生成器、剪报式信件这样的东西，它使用不同的字母类型来表示相同的内容单词。

例如，我要解决的是这个问题，但通用解决方案会很好。 ![在此处输入图像描述](../Images/8a9c3e164224d5654b15d7f5d389f986.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:34:17.390

```
var date = 'Fri Nov 5 11:11 AM'
date.replace(/(\w+ \w+ \d{1,2}) (\d{1,2}:\d{1,2} AM|PM)/, '$1 <br> $2') 
```

这将在 2 个单词和一个数字之后拆分字符串`1 or 2-digit`，如果它们后面是`two` `1 or 2-digit`用冒号分隔的数字，然后是`AM`or `PM`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:01:27.610

**原型**

```
String.prototype.addLine = function(str, splitter) {
    var args = str.split(splitter);  

    return this.replace(/{(\d+)}/g, function(match, number) {
       return typeof args[number] != 'undefined'? args[number]: match;
    });
}; 
```

**用法**（用于 html 替换`\n`为`<br />`）

```
var d1 = "Fri Nov 5 11:11 AM"; //Original format
var d2 = "{0} {1} {2}\n {3} {4}".addLine(d1,' '); //With the new line break 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:17:41.827

对我来说，这似乎是一个[XY 问题](https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem)。

您想要做的是防止时间与其 AM/PM 指示符分开。与其尝试修复脚本，不如更改内容本身，以便在时间和指示符之间出现[不间断的空格：](http://en.wikipedia.org/wiki/Non_breaking_space)

[例如：]

```
8:00&nbsp;AM 
```

这将允许内容流畅地填充其容器，而无需使用换行符将时间与指示符分开。

如果内容本身是为了保留空格（因此是换行符），那么内容的样式应该具有：

[在 CSS 中：]

```
white-space: pre; 
```

或包含在一个`<pre>`元素中。

或者，如果内容*不是*预先格式化的，但应该总是分成多行，`<br>`则应该使用一个元素：

```
Fri Nov 5<br>11:11 AM 
```

在这种特殊情况下，我建议使用`&nbsp;`实体而不是`<br>`元素，因为该`<br>`元素用于表示需要多行的内容，例如诗歌或`<address>`.

如果您无法从服务器更改文本的格式，则可以使用`.replace`相对轻松地插入不间断空格字符：

```
newStr = yourStr.replace(/(\d\d) ([AP]M)/g, '$1&nbsp;$2'); 
```

以下是模式的细分：`/(\d\d) ([AP]M)/g`

*   RegExp 文字由`/`字符分隔
*   parens 用于捕获字符组，替换字符串中的`$1`and`$2`引用捕获的字符。
*   `\d\d`用于匹配两个连续的数字，代表时间中的分钟。
*   空格用于匹配分钟和 AM/PM 指示符之间的空格。`\s+`如果 HTML 内容中有多个空格字符，您可能需要使用。
*   `[AP]`用于匹配`A`or`P`字符
*   `[AP]M`匹配`AM`或`PM`. 这也可以写成 (AM|PM)
*   该`g`标志用于告诉在字符串中找到的每个匹配项都发生替换。

# eclipse - Eclipse 插件：通过首选项页面配置范围首选项

> ID：13256161
> 
> 赞同：3
> 
> 时间：2012-11-06T17:24:23.767
> 
> 标签：eclipse, eclipse-plugin

我正在使用 Eclipse 3.7 (Indigo) 作为 Eclipse 插件。这个插件将通过产品文件打包成一个独立的应用程序。安装将是多用户安装，[如此链接](http://help.eclipse.org/indigo/index.jsp?topic=/org.eclipse.platform.doc.isv/reference/misc/multi%255Fuser%255Finstalls.html)的方案 2 中所述。所以会有很多用户共享一个安装区域。

基于[这个答案](https://stackoverflow.com/a/1805577)，我认为我可以将 设置`osgi.configuration.area`为一个`user.home`位置，以便每个用户都有自己的设置。我了解如何[通过代码](http://wiki.eclipse.org/FAQ_How_do_I_load_and_save_plug-in_preferences?)访问首选项，但现在我希望能够通过 Eclipse 窗口下的首选项对话框访问这些。对于我看到的所有示例，首选项对话框仅满足实例范围首选项。我有什么方法可以将配置范围首选项添加到首选项页面。

我也在stackoverflow上查看[了这个答案](https://stackoverflow.com/a/5795901)，但这又迎合了实例范围，因此我发布了一个单独的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T09:23:03.970

您的首选项页面是[PreferencePage](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/preference/PreferencePage.html)的子类（很可能是[FieldEditorPreferencePage](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/jface/preference/FieldEditorPreferencePage.html)的子类）。

通过实现[IWorkbenchPreferencePage](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/IWorkbenchPreferencePage.html)接口，您可以实现[init](http://help.eclipse.org/indigo/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/IWorkbenchPreferencePage.html#init%28org.eclipse.ui.IWorkbench%29)方法并设置要在您的实现中使用的自定义[PreferenceStore 。](http://help.eclipse.org/helios/topic/org.eclipse.platform.doc.isv/reference/api/org/eclipse/ui/preferences/ScopedPreferenceStore.html)

例如

```
public void init(IWorkbench workbench) {
    setPreferenceStore(
            new ScopedPreferenceStore(ConfigurationScope.INSTANCE, 
                    "com.nem.plugin") );
    setDescription("A preference page using configuration scope");
} 
```

# c# - 在 Dispatchertimer.Tick 事件中发送一个额外的参数

> ID：13256164
> 
> 赞同：7
> 
> 时间：2012-11-06T17:24:45.190
> 
> 标签：c#, wpf, dispatchertimer

我的问题是如何在 Dispatchertimer.Tick 事件中发送一些参数，这里是代码：我想要的是在 dispatcheTimer_Tick 接收一个整数值

```
 dispatcherTimer.Tick += new EventHandler(dispatcherTimer_Tick);

    private void dispatcherTimer_Tick(object sender, EventArgs e)
    {
        //.Text = DateTime.Now.Second.ToString();

    } 
```

我想做的是这样的

```
 private void dispatcherTimer_Tick(object sender, EventArgs e,int a)
    {
        //.Text = DateTime.Now.Second.ToString();

    } 
```

如何从调用点发送值？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T17:28:57.840

While there are a number of ways, I find it most convenient to use anonymous methods to close over variables when doing this:

```
dispatcherTimer.Tick += (s, args) => myControl.Text = DateTime.Now.Second.ToString(); 
```

If you have a handful of lines you could also do something more like:

```
int number = 5;
dispatcherTimer.Tick += (s, args) => 
{
    string value = someMethod();
    string otherValue = DateTime.Now.Second.ToString()
    myControl.Text = value + otherValue + number;
} 
```

If you have more than just a handful of lines then you probably still want another method, but you can use a lambda to call that method:

```
int value = 5;
dispatcherTimer.Tick += (s, args) => myRealMethod(someControl, value);

public void myRealMethod(Control someControl, int value)
{
    someControl.Text = value;
} 
```

This is convenient for both ignoring parameters of the event handler's delegate when you don't need them (I almost never use `sender`, I pass the actual object myself if I need it so that it's not cast to `object` first.) as well as adding in additional local variables.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:28:45.007

If you know `a` at the time you're attaching the event handler, you can do something like this:

```
int a = 0;
dispatcherTimer.Tick += (sender, e) => 
    {
       /* a is available here */
    }; 
```

# google-chrome - 查找网页的标题

> ID：13256166
> 
> 赞同：1
> 
> 时间：2012-11-06T17:24:47.057
> 
> 标签：google-chrome, google-chrome-extension

假设我的 Chrome 扩展中有这个 AJAX 代码

```
//bind to all links
$('a').click( function() {
   //get the url
   var url = $(this).prop('href');
   //send the url to your server
   $.ajax({
        type: "POST",
        url: "http://yourserver.com/process.php",
        data: "url=" + url
   });
}); 
```

现在，我不仅要发送 URL，还要发送页面标题（在 HTML`<title>`标记中指定）。我怎样才能获得该标题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:29:45.467

您可以尝试使用`document.title`：

```
//bind to all links
$('a').click( function() {
   //get the url
   var url = $(this).prop('href');
   var title = document.title;
   //send the url to your server
   $.ajax({
        type: "POST",
        url: "http://yourserver.com/process.php",
        // Haven't tested this yet :)
        data: '{"url": "' + url + '", "title": "' + title + '"}';
   });
}); 
```

# configuration-files - 使用 fsx 文件中的 app.config

> ID：13256167
> 
> 赞同：7
> 
> 时间：2012-11-06T17:24:48.653
> 
> 标签：configuration-files, f#-scripting

是否可以使用 F# 脚本 (fsx) 文件中的 app.config 文件？如果是这样，怎么做？我应该把文件放在哪里，它会被称为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-09-07T08:39:29.713

@JoeB 的链接问题提供了 2 个答案，这些答案比 .fsx 脚本更适合 F# Interactive。我为下面的 F# 脚本提供了一个很好的解决方案：

鉴于此 app.config 文件：

```
<configuration>
    <appSettings>
        <add key="foo" value="bar"/>
    </appSettings>
</configuration> 
```

这样读`foo`：

```
let appConfigPath = System.IO.Path.Combine(Directory.GetCurrentDirectory(), "app.config")
let fileMap = ExeConfigurationFileMap()
fileMap.ExeConfigFilename <- appConfigPath
let config = ConfigurationManager.OpenMappedExeConfiguration(fileMap, ConfigurationUserLevel.None)
let foo = config.AppSettings.Settings.["foo"].Value
Console.WriteLine(foo) 
```

# entity-framework - 实体框架条目更改跟踪问题

> ID：13256168
> 
> 赞同：1
> 
> 时间：2012-11-06T17:25:03.293
> 
> 标签：entity-framework

我有下面列出的 Profile 模型。此模型通过 ajax 调用发送到客户端，然后通过另一个 ajax 调用更新并发送回服务器。

当客户端进行更改时，他们负责设置他们正在使用的模型的 ObjectState。例如，如果他们正在更改 Name 属性，他们会将 Name 属性设置为新值，并将 ObjectState 属性设置为 2（已修改），并向地址添加新地址，他们会将新地址的 ObjectState 设置为 1 （添加）。这一切都很好， ApiController 正确接收新的 Profile 对象。

```
public enum ObjectState
{
    Unchanged = 0,
    Added = 1,
    Modified = 2,
    Deleted = 3
}

public interface IObjectState
{
    ObjectState ObjectState { get; set; }
}

static class EntityStateHelper
{
    public static EntityState ConvertState(ObjectState objectState)
    {
        switch (objectState)
        {
            case ObjectState.Added:
                return EntityState.Added;
            case ObjectState.Deleted:
                return EntityState.Deleted;
            case ObjectState.Modified:
                return EntityState.Modified;
            default:
                return EntityState.Unchanged;
        }
    }
}

// Models
public class Profile : IObjectState
{
    public int Id { get; set; }
    public string Name { get; set; }
    public DateTime? BirthDay { get; set; }

    // Navigation Properties
    public ICollection<Address> Addresses { get; set; }

    public ObjectState ObjectState { get; set; }
}

public class Address : IObjectState
{
    public int Id { get; set; }
    public string Street1 { get; set; }
    public string Street2 { get; set; }
    public string City { get; set; }
    public string State { get; set; }
    public string Zip { get; set; }
    public ObjectState ObjectState { get; set; }
} 
```

在我的 ProfileRepository 内部，我实际上已经分离了 Insert 和 Update，对于 Profile 对象，客户端没有删除配置文件的服务调用，所以他们对配置文件所能做的就是修改它。在我的 Update 方法中，我选择使用`_context.Entry<T>(entity)`asapposed`_context.Entry<T>(entity).State = EntityState.Modified`导致抛出异常，指出*ObjectStateManager 中已经存在具有相同键的对象。ObjectStateManager 无法使用相同的 key 跟踪多个对象*。

```
public void Update(T entity)
{
    _context.Entry<T>(entity);
    _context.ApplyStateChanges();
} 
```

首先让我说我在 Update 方法中实际上没有 ApplyStateChanges，但对于这个示例，它将显示正在发生的事情。下面是 ApplyStateChanges 方法的代码。

```
public static class DbContextEntensions
{
    public static void ApplyStateChanges(this DbContext context)
    {
        foreach (var trackableEntry in context.ChangeTracker.Entries<IObjectState>())
        {
            IObjectState state = trackableEntry.Entity;
            trackableEntry.State = EntityStateHelper.ConvertState(state.ObjectState);
        }
    }
} 
```

所以这就是问题所在。假设客户端的 Profile 是 Name 属性是 John，Addresses 属性包含 1 个地址。如果客户端将名称更改为 Steve 并修改 1 地址，那么当 ApplyStateChanges 被调用时，每个 DbEntityEntries 都会被标记为正确的 EntityState。当客户端将新地址添加到状态为 1（已添加）的地址集合时，就会出现问题。当调用 ApplyStateChanges 时，`context.ChangeTracker.Entries<IObjectState>()`对它的调用不会将新添加的地址作为已被 ChangeTracker 更改的条目返回。

我很确定代码`_context.Entry<T>(entity)`应该是`_context.Entry<T>(entity).State = EntityState.Modified`，但无论我尝试了什么，我似乎都无法解决这个异常。

我将 EntityFramework 5.0 与 .NET 4.0 一起使用，这意味着 EntityFramework 版本为 4.4。我错过了什么？我已经阅读了我能找到的关于这个主题的每一篇文章，这看起来应该有效。我从 Julie Lerman 的 PluralSight video [Entity Framework in the Enterprise](http://pluralsight.com/training/courses/TableOfContents?courseName=efarchitecture&highlight=julie-lerman_efarchitecture-m2-boundedcontext!julie-lerman_efarchitecture-m3-archrepo!julie-lerman_efarchitecture-m4-testing!julie-lerman_efarchitecture-m1-overview#efarchitecture-m2-boundedcontext)获得了这个状态变化跟踪代码。

任何帮助我指出正确的方向将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-29T17:18:37.567

我建议在 Update 方法中使用 .Add(entity) 添加实体，这会将新地址标记为已添加并修复其导航属性。然后，当您调用 ApplyStateChanges 时，它会更正状态。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-08T10:10:49.667

这篇文章很旧，但它可能会帮助其他人：

问题出在更新方法中。我假设您在断开连接模式下工作。以下方法：

```
_context.Entry<T>(entity); 
```

从上下文中获取实体。
如果它不在其中，它将使用“Detached”EntityState 添加它（及其导航属性作为地址），**不会将它添加到“context.ChangeTracker.Entries()”**。

**您应该改用“.Add(entity)”或“.Attach(entity)”**。唯一的区别是状态：

*   .Add 将使用 EntityState 添加客户及其地址：“已添加”

*   .Attach 将使用 EntityState 添加客户及其地址：“未更改”

当您在下面的行中更改它们的状态（再次！）时，两者都将在您的代码中工作：

```
_context.ApplyStateChanges(); 
```

这意味着您不关心您之前应用的状态，只要它们被跟踪（不是处于分离状态）。

> 我很确定代码 _context.Entry(entity) 应该是 _context.Entry(entity).State = EntityState.Modified 但无论我尝试了什么，我似乎都无法解决这个异常。

如果您之后不执行 ApplyStateChanges()，则其更新实体及其整个图形将被标记为**脏**，从而产生意想不到的结果（当然就像添加其图形元素一样。请检查此[答案](https://stackoverflow.com/questions/30987806/dbset-attachentity-vs-dbcontext-entryentity-state-entitystate-modified)与整个解释）。

> ObjectStateManager 中已存在具有相同键的对象。ObjectStateManager 无法跟踪具有相同键的多个对象。

这意味着您的数据库/测试中已经拥有相同的对象（或者更确切地说是它的导航属性之一）。这与您的“真正”问题无关，更有可能是副作用。签入数据库的 Seed 方法，您必须有一个重复的导航实体。

# asp.net - 如何避免每次 Visual Studio 2010 编译时 ASP.NET 超时

> ID：13256171
> 
> 赞同：0
> 
> 时间：2012-11-06T17:25:14.003
> 
> 标签：asp.net, visual-studio-2010

我有两个项目，一个是最近的，一个是很旧的。

在为最近的项目（MVC3、EF5 等）编码时，我只是在 VS2010 上构建并在浏览器上更新网站。一切正常。

在旧项目（不是我用 WebForms、LINQ2SQL、自定义成员资格编码）上，每次我编译它并更新浏览器时，我都会被重定向到登录页面。

为什么会发生这种情况以及如何找到导致它的原因？

非常感谢。

# ios - 调用 locationInView 时出错：

> ID：13256173
> 
> 赞同：0
> 
> 时间：2012-11-06T17:25:28.993
> 
> 标签：ios, events, appkit

请帮我。我有下一个问题：

我想`touchesMoved:`在我的子类中处理事件`UIViewController`（我有一个带有视图控制器的视图），但是当我调用时`[aTouch locationInView:self]`出现异常`'NSInvalidArgumentException', reason: '-[MySomeSubclass convertPoint:fromView:]: unrecognized selector sent to instance 0xdc64000'`。

谁能解释我，为什么我得到那个异常以及如何解决它。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:33:47.670

应该：`[aTouch locationInView:self.view]`

# javascript - 如何在构造函数中创建数组？

> ID：13256177
> 
> 赞同：0
> 
> 时间：2012-11-06T17:25:42.737
> 
> 标签：javascript

创建新实例后，我想创建一个新数组作为对象的属性。但我在 Chrome 中收到以下错误：“Uncaught TypeError: Cannot call method 'push' of undefined”。玩家似乎不为人知。但为什么？

```
function Team(name) {
    this.Name = name;
    this.Players = new Array();
}

Team.prototype.AddPlayer = new function (player) {
    this.Players.push(player); //error
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:30:19.520

只需删除此行中的“新”

```
Team.prototype.AddPlayer = function (player) { 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:28:56.350

您的代码是正确的，但您需要确保`Team`使用`new`.

```
var t = new Team("foo");
t.AddPlayer("bar"); 
```

* * *

糟糕，您的代码中有一个错误。`new`从作业`function`中删除`.prototype`。

```
function Team(name) {
    this.Name = name;
    this.Players = new Array();
}

Team.prototype.AddPlayer = /*new*/ function (player) {
    this.Players.push(player);
} 
```

因为`new`在函数之前，您实际上是在使用匿名函数*作为构造函数*，这意味着它正在被*调用*。

需要明确的是，除非将其放在构造函数之前，否则`new` *不会创建新函数。*`Function`

# android - 通过广播意图传递 ArrayList

> ID：13256181
> 
> 赞同：1
> 
> 时间：2012-11-06T17:25:54.550
> 
> 标签：android, android-intent, nullpointerexception, broadcast, parcelable

我按照[Help 中的示例传递 ArrayList 和 parcelable Activity](https://stackoverflow.com/questions/5819238/help-with-passing-arraylist-and-parcelable-activity?rq=1)但对于我的情况，我试图将意图从我的服务类（内部 Asynctask）广播到这样的 Activity 类。

```
ArrayList<Malware> addyExtras = new ArrayList <Malware>();

for (int i = 0; i < fetch.size(); i++) {
    addyExtras.add (fetch.get(i));
}
Intent d = new Intent();
d.setAction(COMPLETED_INTENT);
d.putExtra("CurrentProgress", "completed");
d.putParcelableArrayListExtra("MalwareArray", addyExtras);
sendBroadcast(d); 
```

我如何接收广播意图

```
ArrayList<Malware> myList;
myList = getIntent().getParcelableArrayListExtra("MalwareArray");
Log.d("onReceive", "got myList");

for (int i = 0; i < myList.size(); i++) {
    Malware a = myList.get(i);
    Log.d("onReceive", "App Name:" + a.getApp());
    //tv1.setText(a.getName() + " is from " + a.getState());
} 
```

尝试接收意图时遇到空指针异常

```
11-07 01:21:51.315: E/AndroidRuntime(18769): FATAL EXCEPTION: main
11-07 01:21:51.315: E/AndroidRuntime(18769): java.lang.RuntimeException: Error receiving broadcast Intent { act=com.analyze.project.CompletedReceiver flg=0x10 (has extras) } in com.analyze.project.AnalyzeActivity$1@41889670
11-07 01:21:51.315: E/AndroidRuntime(18769):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:737)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at android.os.Handler.handleCallback(Handler.java:605)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at android.os.Handler.dispatchMessage(Handler.java:92)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at android.os.Looper.loop(Looper.java:137)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at android.app.ActivityThread.main(ActivityThread.java:4513)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at java.lang.reflect.Method.invokeNative(Native Method)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at java.lang.reflect.Method.invoke(Method.java:511)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:974)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:741)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at dalvik.system.NativeStart.main(Native Method)
11-07 01:21:51.315: E/AndroidRuntime(18769): Caused by: java.lang.NullPointerException
11-07 01:21:51.315: E/AndroidRuntime(18769):    at com.analyze.project.AnalyzeActivity$1.onReceive(AnalyzeActivity.java:197)
11-07 01:21:51.315: E/AndroidRuntime(18769):    at android.app.LoadedApk$ReceiverDispatcher$Args.run(LoadedApk.java:728)
11-07 01:21:51.315: E/AndroidRuntime(18769):    ... 9 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:39:00.713

从日志 AnalyzeActivity.java:197 中，您在第 197 行有一个变量，意外地为 null。

```
private BroadcastReceiver mMessageReceiver = new BroadcastReceiver() {
@Override
public void onReceive(Context context, Intent intent) {

    Log.d("TAG", "onReceive1()");
    //setIntent(intent);

    ArrayList<Malware> myList;
    // use local var intent 
    myList = intent.getParcelableArrayListExtra("MalwareArray");
    Log.d("onReceive", "got myList");

    for (int i = 0; i < myList.size(); i++) {
        Malware a = myList.get(i);
        Log.d("onReceive", "App Name:" + a.getApp());
        //tv1.setText(a.getName() + " is from " + a.getState());
    }
} 
```

# java - 在所有线程完成后退出 Java 程序

> ID：13256188
> 
> 赞同：1
> 
> 时间：2012-11-06T17:26:15.087
> 
> 标签：java, multithreading, runtime

我有一个密码保存程序，可以将密码保存到文本文件中。用户可以添加或删除密码，数据将被重新写入文本文件。为了防止程序真的很慢，每次程序需要保存时，我都会创建一个新线程。我有一个扩展 Thread 的类，并将所有数据写入指定的文本文件。我遇到的问题是当我尝试在用户想要退出之前保存所有数据时。当按下退出按钮时，我创建一个新线程来保存数据，然后调用 System.exit() 函数退出。

```
Thread t = new SaveThread();
t.start();
System.exit(0); 
```

我注意到程序将在线程完成之前退出。有什么方法可以告诉java只在我的线程停止运行时退出？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:30:12.640

您可以使用[`Runtime.addShutdownHook()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29)来注册应该在 JVM 关闭之前运行的代码。

或者

您可以使用`Thread.join()`等待线程。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:31:51.920

你有几个选择：

1.  在调用之前`System.exit()`，调用`thread.join()`你的每个线程。
2.  与其调用`System.exit()`，不如让你的主线程从它的`main()`函数中返回。这将在进程关闭之前等待所有非守护线程终止。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T17:39:59.587

你有三个选择：

1.  [`t.join()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#join%28%29)启动线程后调用
2.  使用[`t.run()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#run%28%29)代替[`t.start()`](http://docs.oracle.com/javase/6/docs/api/java/lang/Thread.html#start%28%29)
3.  通过添加您的保存线程作为关闭挂钩[`Runtime.addShutdownHook`](http://docs.oracle.com/javase/6/docs/api/java/lang/Runtime.html#addShutdownHook%28java.lang.Thread%29)。

**选项1**

这个很简单：

```
Thread t = new SaveThread();
t.start();
t.join();
System.exit(0); 
```

**选项 2**

也很容易：

```
Thread t = new SaveThread();
t.run();
System.exit(0); 
```

**选项 3**

也很容易，但是在您的应用程序启动时完成。在您的应用初始化代码中，执行以下操作：

```
Runtime.getRuntime().addShutdownHook(new SaveThread()); 
```

它会在应用程序关闭时自动运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:32:26.627

如果这`SaveThread`是要执行的最后一个操作，为什么不将`System.exit()`调用移到该线程中呢？

* * *

有更好的解决方案，同意，但是如果您想使用这种方法并多次使用此保存线程的实例，那么您可以轻松地对其进行参数化：

```
public SaveThread extends Thread {

   private exitAfterSave = false;

   public SaveThread() {
     this(false);
   }

   public SaveThread(boolean exitAfterSave) {
     this.exitAfterSave = exitAfterSave;
   }

   @Overwrite
   public void run() {

      // Save what has to be saved

      if (exitAfterSave) {
        System.exit(0);
      }
   }
} 
```

# c++ - 使用opencv跟踪移动车辆的可能方法

> ID：13256191
> 
> 赞同：2
> 
> 时间：2012-11-06T17:26:23.600
> 
> 标签：c++, opencv, machine-learning, computer-vision, object-detection

我正在做一个项目，我必须能够跟踪进入和离开某个区域的汽车的运动。我正在使用带有 C++ 的 OpenCV 库。在搜索完所有功能后，我不确定要使用哪种方法。我正在考虑使用opticalFlow进行移动并为进入/退出设置两个感兴趣区域，但我不确定如何检测实际车辆。任何对 OpenCV 更有经验的人能给我一些见解吗？

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-07T11:02:49.740

您应该首先检测进入图像的对象。我猜你有一个固定的相机，不会移动。如果是这样，您可以从背景减除技术开始：使用固定相机，并且没有任何物体移入/移出图像，您可以估计图像中每个像素的颜色（或其他一些属性）的高斯模型。之后，您可能需要重新估计模型以使其适应例如照明的变化。估计模型后，您可以检测进入图像和从图像中移动的对象，因为那里的像素将具有与预期不同的值。然后，重新使用光流以在图像中跟踪它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T11:20:54.733

Genis 的答案无疑是一个很好的答案。如果照明条件不会发生大的变化并且相机处于汽车物体不会重叠的角度，则背景减法然后进行斑点检测可能是最好的方法。

就我个人而言，我会选择直接的光流和向量分段。如果处理时间很关键，您可以在 Sobel 边缘图像上运行光流。

有很多方法可以给这只猫剥皮。也许如果您发布一些场景的屏幕截图，您会得到更具体的解决方案。

# html - 无法让后台工作

> ID：13256192
> 
> 赞同：2
> 
> 时间：2012-11-06T17:26:24.707
> 
> 标签：html, css

好的，这是我的代码：

```
echo "<span style='float:right; text-align:right; background-image:url('" . $icon_url . "') no-repeat top right; height:86px; width:86px; display:block;'>" . $curr_temp . "<br />" . $curr_cond . "</span>"; 
```

这很完美，页面右侧显示的温度和条件正是我想要的，但背景图像不起作用。当我在 chrome 中查看源代码时，我得到：

```
<span style='float:right; text-align:right; background-image:url('http://forecast.weather.gov/images/wtf/medium/sct.png') no-repeat top right; height:86px; width:86px; display:block;'>35&deg;F<br />Fair</span> 
```

至少在我看来是正确的，但如果我去检查元素（在 Chrome 中），它显示的大小为 31px*40px，代码为：

```
<span style="float:right; text-align:right; background-image:url(" http:="" forecast.weather.gov="" images="" wtf="" medium="" sct.png')="" no-repeat="" top="" right;="" height:86px;="" width:86px;="" display:block;'="">35°F<br>Fair</span> 
```

这绝对是不正确的。如果我在检查元素框中将其更改为正确，它会很好地显示背景图像，但仍然只有其中的一部分，因为跨度保持在 31x40 而不是我定义的 86*86。我在这里搞砸什么？我就是想不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:32:35.410

根据标准，元素属性应该用双引号括起来。此外，`background` `url`根本不应该包含任何引号。

尝试：

```
echo '<span style="float:right; text-align:right; background:url(' . $icon_url . ') no-repeat top right; height:86px; width:86px; display:block;">' . $curr_temp . '<br />' . $curr_cond . '</span>'; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:31:02.373

我看到两个问题。1）当您查看生成的代码时，您没有正确使用规则中的引号。2）您正在使用带有背景图像选择器的背景速记语法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:32:36.863

一方面，您需要使用`background`而不是`background-image`：

```
echo "<span style='float:right; text-align:right; background:url('" . $icon_url . "') no-repeat top right; height:86px; width:86px; display:block;'>" . $curr_temp . "<br />" . $curr_cond . "</span>"; 
```

然而，唯一的问题是它本身不足以搞砸 url，只是样式。我会查看您的 $icon_url 在该函数之外的外观，以查看它是否生成了正确的字符串值。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:52:18.613

您的代码中有一些小错误（引号和文本位置）。如果我了解您希望如何显示文本和图像，则可以这样做：

```
<div style='float: right; text-align:right; 
    background-image:url("http://forecast.weather.gov/images/wtf/medium/sct.png");
    no-repeat top right; height:86px; width:86px; display:block;'>
</div>
<div style='float: right'>
    35&deg;F<br />Fair
</div> 
```

[jsfiddle](http://jsfiddle.net/bzT8q/2/)

如果您希望您的图像内的文本，你可以使用这个：

```
<span style='float:right; text-align:right; 
background-image:url("http://forecast.weather.gov/images/wtf/medium/sct.png"); 
no-repeat top right; height:86px; width:86px; display:block;'>
    35&deg;F<br />Fair
</span> 
```

希望能为您解决。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T17:30:20.100

您用单引号打开样式属性，但也用单引号打开`url`in `background-image`。有效地过早关闭您的样式属性。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-06T17:31:28.583

看起来你的报价有问题。尝试这个：

```
echo '<span style="float:right; text-align:right; background-image:url(\'' . $icon_url . '\') no-repeat top right; height:86px; width:86px; display:block;">' . $curr_temp . '<br />' . $curr_cond . '</span>'; 
```

希望能帮助到你。祝你好运。

# jquery - jquery 一次从一个不同的随机 div 循环一个孩子

> ID：13256193
> 
> 赞同：1
> 
> 时间：2012-11-06T17:26:38.560
> 
> 标签：jquery, cycle

我在一个页面上有多个内容预告片，每个预告片都有多个可以循环播放的图像。我希望能够使用 jquery 循环，以便它选择一个随机预告片并循环到下一个图像，然后选择另一个随机预告片并重复相同的操作。结果应该是一页图像，其中一个图像一次在页面上的某个位置移动。

HTML -

```
<div class="video-slidehow">
<span class="video-thumb slideshow"><img src=""></span>
<span class="video-thumb slideshow"><img src=""></span>
<span class="video-thumb slideshow"><img src=""></span>
</div>

<div class="video-slidehow">
<span class="video-thumb slideshow"><img src=""></span>
<span class="video-thumb slideshow"><img src=""></span>
<span class="video-thumb slideshow"><img src=""></span>
<span class="video-thumb slideshow"><img src=""></span>
</div>

<div class="video-slidehow">
<span class="video-thumb slideshow"><img src=""></span>
<span class="video-thumb slideshow"><img src=""></span>
</div> 
```

所以它选择一个随机的“视频幻灯片”包装器，然后将该包装器的“视频拇指”子循环到下一个。然后它选择一个不同的“video-slideshow”包装器并将“video-thumb”子代循环到下一个。

请注意，我已经清理了这个 html 以使其更容易，每个视频幻灯片 div 确实有额外的父 div 等。

我一直在尝试通过将一个类移动到不同的 div 并将其作为 jquery 元素来做到这一点，但这显然不是解决方案！

jQuery -

```
var elements = $('.video-slidehow');
$(elements[Math.floor(Math.random()*elements.length)]).addClass('someClass');

 $('.someClass').cycle({
    fx: 'scrollRight',      
    easing: 'easeInOutBack',
    speed:  700, 
    timeout: 7000, 
    after: doAfter
});

function doAfter() {
    $('.someClass').removeClass('someClass');   
       var elements = $('.video-slidehow'); 
           $(elements[Math.floor(Math.random()*elements.length)]).addClass('someClass');

        } 
```

关于“随机”要求。理想情况下，它不能连续两次执行相同的包装 div。

在puppybeard的回答之后，我尝试了以下方法无济于事，但我觉得这开始走上正轨了！-

```
var elements = $('.video-slidehow');

$('.video-slidehow').cycle({
    fx: 'scrollRight',      
    easing: 'easeInOutBack',
    speed:  700, 
    timeout: 7000, 
    after: doAfter
});

function doAfter() {

    $('.video-slidehow').cycle('pause');    
   $(elements[Math.floor(Math.random()*elements.length)]).cycle('resume');

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:38:08.467

您应该在加载时对所有元素使用 Cycle 的暂停选项。

> $('.video-thumb').cycle('pause');

当您想要恢复项目时，恢复功能就在那里。

```
function doAfter() {

       $(elements[Math.floor(Math.random()*elements.length)]).cycle('resume');

    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T11:12:14.847

感谢 Puppybeard 让我朝着正确的方向前进。

我使用的解决方案如下：

首先 - 创建一个包含所有实例的数组以在它们之间循环。

```
var elements = $('.video-slideshow'); 
```

其次 - 为您想要一次循环的所有元素启动幻灯片：

```
 $('.video-slideshow').cycle({
    fx: 'scrollRight',      
    easing: 'easeInOutBack',
    speed:  700, 
    timeout: 700
}); 
```

第三次运行一个函数，该函数暂停所有元素的幻灯片放映并恢复单个随机选择的元素的幻灯片放映（使用先前设置的数组）。此功能需要以设定的时间间隔重新运行，以相应地暂停和恢复幻灯片放映。我为此使用了 setTimeout 函数。请注意，此解决方案不会在周期之间创建一致的暂停。我敢肯定，比我自己更好的程序员可以提供更强大的解决方案，从而提供这种准确度。

```
(function (){
    $('.video-slideshow').cycle('pause');
$(elements[Math.floor(Math.random()*elements.length)]).cycle('resume');
   setTimeout(arguments.callee, 700);
})(); 
```

# javascript - qunit 返回单元测试

> ID：13256196
> 
> 赞同：1
> 
> 时间：2012-11-06T17:26:52.990
> 
> 标签：javascript, jquery, qunit

Qunit 有没有办法返回它当前运行的测试。我是 QUnit 的新手。回调 Qunit.log 仅返回消息、结果、实际、预期。但我想要使用原始代码。创建的实际单元测试。我正在创建一个网站，允许用户将单元测试编写为指定函数的普通字符串，并且我的网站运行它。但是，如果用户决定复合单元测试，例如：

```
var a = 1; 
var b = 2; 
 function plus(a,b) { return a + b; } equal(plus(a,b), 3); equal( 1 == '2', 'Fail!' ); 
```

然后 Qunit 将单独运行测试，但只是说每个单元测试的通过或失败，但没有给出实际运行的代码。我可以使用后端来跟踪字符串输入，但我想知道是否有人知道 Qunit 告诉我的简单方法：

> “我运行了测试 x，结果是 Y，消息是 W，实际是 A，等等”

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-06T20:57:20.400

equal() 或 ok() 可以将消息作为参数。例如，

`ok (1 == 1, "One equals one.");`

这有帮助吗？似乎您可以使用字符串解析技能自动发送消息。

# android - Android：在以前未创建的目录中创建文件时出错

> ID：13256198
> 
> 赞同：0
> 
> 时间：2012-11-06T17:27:00.577
> 
> 标签：android, file

我正在尝试下载一个名为flower.jpg 的文件

```
 String fileName = Environment.getExternalStorageDirectory().getAbsolutePath() + "/flower.jpg";

 File f = new File(fileName);
 if(!f.exists())
 {
      f.createNewFile();
 }
 DataOutputStream fos = new DataOutputStream(new FileOutputStream(f));
    fos.write(buffer);
    fos.flush();
    fos.close(); 
```

效果很好。

但我想把我的文件放在一个新目录 (images) 中，它还不存在。如果我尝试

```
 String fileName = Environment.getExternalStorageDirectory().getAbsolutePath() + "/images/flower.jpg"; 
```

我得到：

```
 11-06 18:19:01.570: W/System.err(17601): java.io.IOException: No such file or directory
 11-06 18:19:01.580: W/System.err(17601):   at java.io.File.createNewFileImpl(Native Method)
 11-06 18:19:01.580: W/System.err(17601):   at java.io.File.createNewFile(File.java:1115) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:29:42.993

You need to check whether directory 'images' exists and if not create it.

```
 if (isMediaMounted()) {

                File cnxDir = new File(
                        Environment.getExternalStorageDirectory()
                                + File.separator + "folderName");
                if (!cnxDir.exists()) {

                    cnxDir.mkdir();

                }} 
```

//

```
 private boolean isMediaMounted() {
    if (Environment.MEDIA_MOUNTED.equals(Environment
            .getExternalStorageState())) {
        return true;
    } else {
        return false;
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:32:10.250

您需要先创建一个目录：

```
String dirName = Environment.getExternalStorageDirectory().getAbsolutePath() + "/images";
File dir = new File(dirName);
if(!d.exists())
{
     d.mkdirs();
}

String fileName = Environment.getExternalStorageDirectory().getAbsolutePath() + "/images/flower.jpg";

File f = new File(fileName);
if(!f.exists())
{
     f.createNewFile();
} 
```

# php - MySQL 选择与或

> ID：13256202
> 
> 赞同：0
> 
> 时间：2012-11-06T17:27:28.180
> 
> 标签：php, mysql, forms, select

我的查询语句没有成功，我认为这与我执行它的方式有关。

```
$query5 = "select * from ".$db_prefix."customer_det where (fname = '".$fname."' and lname = '".$lname."') or phone = '".$phone."'"; 
```

本质上，当名字和姓氏与发布的名字和姓氏匹配时，我想从 customer_det 中选择所有内容。如果没有发布的名字和姓氏，那么我希望它选择所有发布的电话号码匹配的地方。我的三个变量 $fname、$lname 和 $phone 都设置为从之前的表单 $_POST['fname']; 中读取。ETC...

这是要使用的正确逻辑吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:29:50.177

The right logic is not used, since its combined into 1 query. If only 1 query is used, it will search for `$fname=''` and `$lname=''` when neither of that is posted, along with the $phone part.

Try:

```
if( !empty($fname) && !empty($lname) )
  $query5 = "select * from ".$db_prefix."customer_det where (fname = '".$fname."' and lname = '".$lname."')";
 else
    $query5 = "select * from ".$db_prefix."customer_det where phone = '".$phone."'"; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:33:37.030

您的查询现在正在执行的操作将返回名称匹配的所有行和电话号码匹配的所有行。如果您只想返回电话号码匹配的行，但仅当提交的名字和姓氏为空时，您需要将其添加到 where 子句中，如下所示：

```
$query5 = "select * from ".$db_prefix."customer_det where (fname = '".$fname."' and lname = '".$lname."') or ('".$fname."' = '' and '".$lname."' = '' and phone = '".$phone."'"); 
```

这确保了电话号码仅在提交的名字和姓氏都为空时用于匹配行，并且不需要编写两个单独的查询。

# php - Inserting Data From Database Into View - Codeigniter

> ID：13256204
> 
> 赞同：0
> 
> 时间：2012-11-06T17:27:31.800
> 
> 标签：php, codeigniter-2

Okay, so I'm grabbing the data I need properly from the database. However, how do I take the "echo data" and echo it as a variable in my view?

For example,

```
<? echo $row1->title; ?> 
```

is not working when placed in the view.

Here's a portion of my controller:

```
// Pricing and package details insert from db
    $query = $this -> db -> query('SELECT title, price, number_sites, number_entries, white_label FROM pricing');

    $row1 = $query->row(0); // 0 grabs first row in table: Package 1         

    echo $row1->title;
    echo $row1->price;
    echo $row1->number_sites; 
```

If you want to view the entire controller, check it here: [http://codepad.org/4nRrywzl](http://codepad.org/4nRrywzl)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:09:23.463

您需要将数据从控制器传递到视图。

当前您正在传递`$data`给视图，在该数组中为该行添加另一个字段。

```
$data['row1'] = $row1;
$this->load->view('shared/header_view', $data); // or any other view 
```

这应该在视图中起作用

```
echo $row1->$title; 
```

没有测试上面的代码 - 但它应该可以工作。

# c# - XslTransformException 在什么程序集中？

> ID：13256209
> 
> 赞同：5
> 
> 时间：2012-11-06T17:27:46.223
> 
> 标签：c#, exception, dll, .net-3.5, xslt-1.0

我有一些抛出 XslTransformException 的代码。这是所需的行为（XSL 包含一个 xsl:message 元素，其中 @terminate 设置为 yes）。

我试图在我的代码中捕获此异常，但找不到包含此异常类的程序集，并且在 MSDN 中找不到有关此异常的任何文档以了解合适的继承类（即避免使用我的 catch 块中的 Exception 类）。

我引用了 System.Xml 和 Sytem.Xml.Linq 程序集，并具有以下 using 语句：

```
using System.Xml;
using System.Xml.Xsl; 
```

例外是在 System.Xml.Xsl 命名空间中；IE：

```
System.Xml.Xsl.XslTransformException 
```

知道我需要参考哪个程序集吗？

**编辑：** 根据要求，请在下面找到重现此异常的示例代码：

```
using System;
using System.Xml;
using System.Xml.Xsl;
using System.Text;

namespace StackOverflowDemo
{
    class Program
    {
        static void Main(string[] args)
        {

            XmlDocument xmsl = new XmlDocument();
            xmsl.LoadXml("<?xml version=\"1.0\" encoding=\"utf-8\"?><xsl:stylesheet version=\"1.0\" xmlns:xsl=\"http://www.w3.org/1999/XSL/Transform\" xmlns:msxsl=\"urn:schemas-microsoft-com:xslt\" exclude-result-prefixes=\"msxsl\"><xsl:output method=\"xml\" indent=\"yes\"/><xsl:template match=\"@* | node()\"><xsl:message terminate=\"yes\">this should throw an exception</xsl:message><xsl:copy><xsl:apply-templates select=\"@* | node()\"/></xsl:copy></xsl:template></xsl:stylesheet>");

            XslCompiledTransform xsl = new XslCompiledTransform();
            xsl.Load(xmsl.CreateNavigator());

            XmlDocument xml = new XmlDocument();
            xml.LoadXml("<root />");

            StringBuilder sb = new StringBuilder();
            XmlWriter writer = XmlWriter.Create(sb);
            /*
            try
            {
            */
                xsl.Transform(xml.CreateNavigator(), writer);
            /*
            }
            catch(XslTransformException e) //<-- this class does not exist
            {
                Console.WriteLine(e.ToString());
            }            
            */
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T17:55:23.237

添加以下`catch`块会显示所有内容：

```
catch (Exception e)
{
    var t = e.GetType();
    while (t != null)
    {
        Console.WriteLine(t.AssemblyQualifiedName);
        t = t.BaseType;
    }
} 
```

输出：

```
System.Xml.Xsl.XslTransformException, System.Data.SqlXml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
System.Xml.Xsl.XsltException, System.Xml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
System.SystemException, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
System.Exception, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089
System.Object, mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089 
```

我会忽略这`XslTransformException`一点 - 你应该抓住它`XsltException`。毕竟，这[`XslCompiledTransform.Transform`](http://msdn.microsoft.com/en-us/library/ms163430.aspx)就是记录在案的东西。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T17:34:35.630

在里面`System.Data.SqlXml, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089`

但是，例外是`internal`，因此您将无法直接捕获它。它扩展`XsltException`了，所以正如 Jon Skeet 提到的，只是 catch `XsltException`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:32:28.640

虽然我`XslTransformException`在命名空间中没有看到对 System.Xsl 的引用，但 System.Xsl 的其余部分存在 System.Xml.dll - 您可以[在 MSDN](http://msdn.microsoft.com/en-us/library/system.xml.xsl.xslcompiledtransform.aspx)上看到（我选择命名空间中的第一种类型作为示例）在**Assembly:**行上，就在上面语法块。

# svn - SVN（Subclipse）在合并冲突后创建.edited文件

> ID：13256220
> 
> 赞同：0
> 
> 时间：2012-11-06T17:28:22.560
> 
> 标签：svn, subclipse

我的 Google-fu 在这个问题上显然很弱，所以我希望你们中的一个可以帮助我！我最近升级到了实现 SVN 1.7 的 Subclipse 1.8，我注意到在解决合并冲突后它总是会创建一个 .edited 文件。例如，如果我解决了名为“foo.txt”的文件的合并冲突，则剩下“foo.txt”和“foo.txt.edited”。这个 .edited 文件是什么，有什么方法可以配置 SVN 或 Subclipse 以停止生成它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:47:13.357

该文件由 Subversion 创建。见： http: [//svn.apache.org/viewvc/subversion/branches/1.7.x/subversion/libsvn_wc/merge.c ?view=markup](http://svn.apache.org/viewvc/subversion/branches/1.7.x/subversion/libsvn_wc/merge.c?view=markup)

我认为它是一个临时文件，一旦您告诉 SVN 冲突已解决，它就不会保留在磁盘上。我鼓励您记录一步一步的复制配方并将其报告给 Subclipse 社区。

[http://subclipse.tigris.org/ds/viewForumSummary.do?dsForumId=1047](http://subclipse.tigris.org/ds/viewForumSummary.do?dsForumId=1047)

我假设这是我们只需要在某些场景出现后要求 Eclipse“刷新”的地方。

# c++ - 可变参数模板数组引用参数的语法是什么？

> ID：13256231
> 
> 赞同：7
> 
> 时间：2012-11-06T17:29:10.637
> 
> 标签：c++, c++11, variadic-templates

我不知道我所拥有的是否是编译器错误，或者我只是不知道我正在尝试做的事情的语法。想象一个需要 2 个数组引用的函数：

```
void takeArrays(const char (&str1)[4], const char (&str2)[4]) {
} 
```

当使用以下命令调用时，这编译得很好：

```
takeArrays("foo", "bar"); 
```

我为什么要这样做？因为传递`const char*`会丢失字符串文字的大小信息，这对我正在做的事情很重要。

然而，我真正想做的是传递可变数量的数组引用。这就是事情变得有点难看（变得更糟）的地方。我天真地尝试了这个：

```
template<typename... Args>
void takeArrays(const char (&Args... strs)[4]) {
} 
```

并得到`"error: variable or field ‘takeArrays’ declared void"`和`"error: expected primary-expression before ‘const’"`（gcc 4.6）。所以我尝试了这个：

```
template<typename... Args>
void takeArrays(const char (&(Args... strs))[4]) {
} 
```

并得到`"no matching function for call to ‘takeArrays(const char [4], const char [4])’"`和`"candidate is template<class ... Args> void takeArrays(const char (& (*)(Args ...))[4])"`。这是不可读的，但似乎接近我想要的。我尝试了很多变体，但似乎无法编译。

假设有一种正确的方法来编写上述内容，我真正想做的是调用：

```
takeArrays("foo", "foobar", "longerstring"); 
```

并获得不同大小的数组的可变参数列表，即编译器应将上面的调用扩展为：

```
void takeArrays(const char (&str1)[4], const char (&str2)[7],
                const char (&str3)[13]); 
```

这是我尝试做的第一个想法，我的尝试是这样的：

```
template<size_t... Sizes>
void takeArrays(const char (&strs)[Sizes]...); 
```

不用说我得到的只是错误信息。我知道我正在尝试做的事情有点疯狂，但我真的很想知道这是否可能，如果可以，合适的语法是什么。提前致谢。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T17:54:45.960

相同元素类型的可变参数数组的语法是：

```
template<size_t... Sizes>
void takeArrays(const char (&...args)[Sizes]); 
```

这类似于一般的可变参数 const 参考语法：

```
template<typename... Args>
void takeArrays(const Args &...args); 
```

一个容易记住的方法是省略号紧接在参数名称之前。

# time - How does ntpdate update the time?

> ID：13256232
> 
> 赞同：0
> 
> 时间：2012-11-06T17:29:18.323
> 
> 标签：time, linux-kernel, ntp

I used `strace` on `ntpdate` command which calls adjtimex to adjust time. I got this:

```
adjtimex({modes=ADJ_OFFSET|0x8000, offset=-479139, freq=0, maxerror=16000000, esterror=16000000, status=STA_UNSYNC, constant=2, precision=1, tolerance=32768000, time={1352220968, 428418}, tick=10000, ppsfreq=0, jitter=0, shift=0, stabil=0, jitcnt=0, calcnt=0, errcnt=0, stbcnt=0}) = 5 (TIME_ERROR) 
```

Then I looked into implementation of adjtimex API in do_adjtimex main funcition. But from the code I can not see how `ntpdate` adjusts the time.

```
modes=ADJ_OFFSET|0x8000=ADJ_OFFSET|ADJ_ADJTIME

int do_adjtimex(struct timex *txc)
{
    struct timespec ts;
    int result;
/* Validate the data before disabling interrupts */
if (txc->modes & ADJ_ADJTIME) { **<----this is true. modes as ADJ_OFFSET|ADJ_ADJTIME**
    /* singleshot must not be used with any other mode bits */
    if (!(txc->modes & ADJ_OFFSET_SINGLESHOT))
        return -EINVAL;
    if (!(txc->modes & ADJ_OFFSET_READONLY) &&
        !capable(CAP_SYS_TIME))
        return -EPERM;
} else {
    .....
}

if (txc->modes & ADJ_SETOFFSET) { **《===this is false**
    .....
}

getnstimeofday(&ts);**《------------just get the walk time**

spin_lock_irq(&ntp_lock);

if (txc->modes & ADJ_ADJTIME) {<----this is true.
    long save_adjust = time_adjust; **<----this is global valu eoffset=-479139**

    if (!(txc->modes & ADJ_OFFSET_READONLY)) {
        /* adjtime() is independent from ntp_adjtime() */
        time_adjust = txc->offset;
        ntp_update_frequency();
    }
    txc->offset = save_adjust;
} else {

    .......
}

result = time_state;    /* mostly `TIME_OK' */ this is 
/* check for errors */
if (is_error_status(time_status)) **<----this is STA_UNSYNC**
    result = TIME_ERROR;

txc->freq      = shift_right((time_freq >> PPM_SCALE_INV_SHIFT) *
                 PPM_SCALE_INV, NTP_SCALE_SHIFT);
txc->maxerror      = time_maxerror;
txc->esterror      = time_esterror;
txc->status    = time_status;
txc->constant      = time_constant;
txc->precision     = 1;
txc->tolerance     = MAXFREQ_SCALED / PPM_SCALE;
txc->tick      = tick_usec;
txc->tai       = time_tai;

/* fill PPS status fields */
pps_fill_timex(txc);

spin_unlock_irq(&ntp_lock);

txc->time.tv_sec = ts.tv_sec;
txc->time.tv_usec = ts.tv_nsec;
if (!(time_status & STA_NANO))
    txc->time.tv_usec /= NSEC_PER_USEC;

notify_cmos_timer(); <---- call sync_cmos_clock.

return result;
} 
```

sync_cmos_clock checks whether ntp is synced. time_status is STA_UNSYNC. Just do nothing and return.

```
if (!ntp_synced()) { /*
                      * Not synced, exit, do not restart a timer (if one is
                      * running, let it run out). */
return; } 
```

Am I missing something?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T10:30:18.687

[ntp.c](http://www.cs.fsu.edu/~baker/devices/lxr/http/source/linux/kernel/time/ntp.c#L449)已从 from`kernel/timer.c`和`kernel/time.c`

在里面`ntp.c`你会找到对 的调用`ntp_update_frequency()`。

```
if (!(txc->modes & ADJ_OFFSET_READONLY)) {
   /* adjtime() is independent from ntp_adjtime() */
   time_adjust = txc->offset;
   ntp_update_frequency();
}
txc->offset = save_adjust; 
```

将`ntp_update_frequency()`更新`u64 tick_length`和`static tick_length_base`。`adjtime`注意和的独立性`ntp_adjtime`。

# php - php/pdo/msql - 访问被拒绝

> ID：13256237
> 
> 赞同：6
> 
> 时间：2012-11-06T17:29:47.063
> 
> 标签：php, mysql, pdo

有一个小 pdo 问题，我已经研究了一段时间。由于我不知道这里出了什么问题，所以我想把它放到这个列表中。也许你们中的一些人知道更多...

我有一个带有登录名的网站，可以根据 mysql 驱动的数据库检查用户和密码。当在同一个文件中建立 pdo 连接时，一切正常，可以登录，没有任何问题。就像它应该工作一样......

但是，当将数据库连接部分移动到我从另一个文件中包含的单独函数时，pdo 对我失败，并给了我：

> SQLSTATE [28000] [1045] 用户'...'@'...'的访问被拒绝（使用密码：否）致命错误：在/.../中的非对象上调用成员函数prepare（） .../...在第 41 行

为了清楚起见，这里是代码：

**版本 1：**

这有效：

```
<?php
    require "./vars_and_functions.php";

    /* open database connection */
    try {
    $pdo = new PDO("mysql:host=$db_host;dbname=$db_name", $db_user, $db_pass);

    /* query */
    $query = "SELECT uname, passw FROM members WHERE uname = ? AND passw = ?";
    $q = $pdo->prepare($query);
    $q->execute(array($u_name, $p_word_md5));
    $result = $q->rowCount();

    if($result == 1) { /* we have a match */                       
    /* close the database connection */
               $pdo = null;  

                /* and redirect */
                header("...");

    } /* if */
    else { /* wrong credentials */
        /* close the database connection */                
                $pdo = null;

                /* and go back to the login page */ 
        header("...");
    } /* else */
        } /* try */ 
    catch(PDOException $e) {  
        echo $e->getMessage();  
    } /* catch */
?> 
```

**这里是版本 2**

这不起作用：

```
<?php
        require "./vars_and_functions.php";

        /* open database connection */
        $pdo = database_connection();

    /* query */
            $query = "SELECT uname, passw FROM members WHERE uname = ? AND passw = ?";
            $q = $pdo->prepare($query);
            $q->execute(array($u_name, $p_word_md5));
            $result = $q->rowCount();

        if($result == 1) { /* we have a match */                       
               /* close the database connection */
                   $pdo = null;  

                    /* and redirect */
                    header("...");

        } /* if */
        else { /* wrong credentials */
            /* close the database connection */                
                    $pdo = null;

                    /* and go back to the login page */ 
            header("...");
        } /* else */
            } /* try */ 
    catch(PDOException $e) {  
        echo $e->getMessage();  
    } /* catch */
?> 
```

我的包含文件 vars_and_functions.php 如下所示：

```
$db_host = "...";       
$db_name = "...";           
$db_user = "...";       
$db_pass = "...";       

function database_connection() {
    try {
    $pdo = new PDO("mysql:host=$db_host;dbname=$db_name", $db_user, $db_pass);
}  
catch(PDOException $e) {  
    echo $e->getMessage();  
}  

return $pdo;
} 
```

在我看来，唯一真正的区别是，在这里，pdo 连接是通过函数调用建立的，而函数位于包含文件 vars_and_functions.php 中。

这里有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:36:38.657

您的函数`database_connection()`未在正确范围内接收连接变量，因此在尝试连接时未设置它们，因此传递为`NULL`，并且 PDO 将连接主机默认为`localhost`.

将它们作为参数传递给函数：

```
// Defined at global scope...
$db_host = "...";       
$db_name = "...";           
$db_user = "...";       
$db_pass = "...";       

// Pass the 4 variables as parameters to the function, since they were defined at global
// scope.
function database_connection($db_host, $db_name, $db_user, $db_pass) {
    try {
    $pdo = new PDO("mysql:host=$db_host;dbname=$db_name", $db_user, $db_pass);
}  

// Called as:
$pdo = database_connection($db_host, $db_name, $db_user, $db_pass); 
```

如果您*仅*在连接函数中使用这些变量并且在其他地方不需要它们，请考虑在函数范围内定义它们，这样您就可以将它们作为参数传递。

```
function database_connection() {
    // Only needed here, so define in function scope
    $db_host = "...";       
    $db_name = "...";           
    $db_user = "...";       
    $db_pass = "...";       

    try {
    $pdo = new PDO("mysql:host=$db_host;dbname=$db_name", $db_user, $db_pass);
} 
```

最后一个也是最不希望的选项是像您所做的那样在全局范围内定义变量，但通过函数中的`$GLOBALS[]`（或`global`关键字）访问它们：

```
function database_connection() {
    try {
    $pdo = new PDO("mysql:host={$GLOBALS['db_host']};dbname={$GLOBALS['db_name']}", $GLOBALS['db_user'], $GLOBALS['db_pass']);
} 
```

请注意，如果您在`error_reporting`打开的情况下进行开发并且`display_errors`应该如此，您会看到有关未定义变量的通知。

```
error_reporting(E_ALL);
ini_set('display_errors', 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:41:20.830

除了 Michael Berkowski 的回答之外，您还可以像这样传递 global 关键字：

```
function database_connection() {
    global $db_host, $db_name, etc;
    // your code here
} 
```

有关 PHP 中变量作用域的更多信息，请参见[http://php.net/manual/en/language.variables.scope.php](http://php.net/manual/en/language.variables.scope.php)。

# python - 在 Django 中从查询集中消除对象的最简单方法

> ID：13256238
> 
> 赞同：0
> 
> 时间：2012-11-06T17:29:47.330
> 
> 标签：python, django

我有一个查询集 ， `categories = unipart.categories.all()`它是一个 unipart 对象链接到的所有类别。

但是，我想从这个列表中删除顶级类别——即。那些具有 unipart 也列在其中的子类别。

或者那些 parent_id 等于查询集中的 category_id 之一的类别。

例如，如果 unipart 列在：Nutmeg (parent = Spices) 和 Spices (parent = Food)

那么我只想包括 Nutmeg——所以基本上我想从查询集中“弹出”Spices。

做这个的最好方式是什么？我宁愿不使用列表。

这是我的模型：

```
class UniPart (models.Model):
categories=models.ManyToManyField(Category, related_name = 'unipart')

class Category (MPTTModel):
    category = models.CharField(max_length=250)
    oc_id= models.IntegerField()
    parent = TreeForeignKey('self', blank=True, null=True, related_name='children')
    def __unicode__(self): 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:32:31.560

您可以排除那些将子类别绑定到此单部分项的类别：

```
categories = unipart.categories.exclude(
                 categorieschild__unipart = unipart).distinct() 
```

这`categorieschild`是子类别的相关名称。

# expressionengine - 渠道还是类别？

> ID：13256241
> 
> 赞同：8
> 
> 时间：2012-11-06T17:29:56.890
> 
> 标签：expressionengine

我已经导出了大约 2000 个论坛帖子（分为 9 个论坛类别），每个帖子最多有 10 个回复。

我将它们作为频道条目和评论导入。最好使用单个频道并为每个条目分配一个类别，还是为每个旧论坛类别设置一个频道？

感谢您的任何意见。

最好的祝愿李

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T17:46:56.890

将它们设置为单个频道可能会给您在类别方面的更多灵活性。如果您将它们分解为各自独立的通道，则移动条目将更加困难。此外，设置类别更容易（如果您有其他人帮助您管理这些，您可以设置可以访问的成员组）并且更容易移动条目。我知道论坛总是看到访问者在错误的部分发帖。使用类别系统，您可以根据需要移动它们。在我的脑海中给你更多的灵活性。

我希望这会有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T08:05:37.977

我肯定会选择一个频道，因为将条目移动到另一个类别（以及另一个论坛）只需单击一次，而将其移动到另一个频道则要困难得多。

# python - 使用shutil忽略某些目录/文件时移动目录/文件的Python脚本？

> ID：13256243
> 
> 赞同：3
> 
> 时间：2012-11-06T17:30:01.923
> 
> 标签：python, shutil

我正在寻找一个python脚本，将文件/目录从一个目录移动到另一个目录，同时引用一个记录要复制的文件的列表。

到目前为止，这是我所拥有的：

```
import os, shutil

// Read in origin & destination from secrets.py Readlines() stores each line followed by a '/n' in a list

    f = open('secrets.py', 'r')
    paths = f.readlines()

// Strip out those /n

    srcPath = paths[0].rstrip('\n')
    destPath = paths[1].rstrip('\n')

// Close stream

    f.close()

// Empty destPath

    for root, dirs, files in os.walk(destPath, topdown=False):
        for name in files:
            os.remove(os.path.join(root, name))
        for name in dirs:
            os.rmdir(os.path.join(root, name))

// Copy & move files into destination path

    for srcDir, dirs, files in os.walk(srcPath):
        destDir = srcDir.replace(srcPath, destPath)
        if not os.path.exists(destDir):
            os.mkdir(destDir)
        for file in files:
            srcFile = os.path.join(srcDir, file)
            destFile = os.path.join(destDir, file)
            if os.path.exists(destFile):
                os.remove(destFile)
            shutil.copy(srcFile, destDir) 
```

secrets.py 文件包含 src/dest 路径。

目前，这会传输所有文件/目录。我想读入另一个文件，该文件允许您指定要传输的文件（而不是制作“忽略”列表）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:29:37.677

你应该阅读文件列表

```
 f = open('secrets.py', 'r')
 paths = f.readlines()

 f_list = open("filelist.txt", "r")
 file_list = map(lambda x: x.rstrip('\n'), f_list.readlines())

 ....
 .... 
```

并在复制前检查

```
 for file in files: 
       if file in file_list# <--- this is the condition you need to add to your code
          srcFile = os.path.join(srcDir, file)
       .... 
```

如果您的文件列表包含要复制的文件名模式，请尝试使用 python 的“re”模块来匹配您的文件名。

# hibernate - 可以用 XML 做这样的映射吗？

> ID：13256245
> 
> 赞同：0
> 
> 时间：2012-11-06T17:30:06.953
> 
> 标签：hibernate, hibernate-mapping

我在这里找到了我的任务的解决方案：[mixing-joined-and-single-table-inheritance](https://stackoverflow.com/questions/8494367/mixing-joined-and-single-table-inheritance-and-querying-for-all-objects)。问题包含混合两种继承策略的示例：与单个表连接。但是，是否可以将此注解映射转换为 XML 映射？

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
@Table(name = "animals")
public abstract class Animal { ...

@MappedSuperclass
@Inheritance(strategy = InheritanceType.SINGLE_TABLE)
@DiscriminatorColumn(name = "type")
public abstract class Mammal extends Animal { ...

@Entity
@Table(name = "mammals")
@PrimaryKeyJoinColumn(name = "mammal_id")
@DiscriminatorValue(value = "dog")
public class Dog extends Mammal { ...

@Entity
@Table(name = "mammals")
@PrimaryKeyJoinColumn(name = "mammal_id")
@DiscriminatorValue(value = "cat")
public class Cat extends Mammal { ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T21:22:38.027

抱歉，昨天我刚刚发布了一些从一级继承概念化的代码摘录。你遇到的问题是由

```
 <discriminator column="type" type="string"/> 
```

不能放在 <subclass> 下并且 <joint-subclass> 不能嵌套。我今天尝试运行类似的代码来实现您可能需要的功能。我试图将 <join> 放在 <subclass> 下以模拟 <joint-subclass>，但 <discriminator> 不会以这种方式工作。

所以我唯一能想到的就是在动物和哺乳动物之间建立一对一的关联。这是我尝试过的代码，这个概念可能看起来很尴尬。

```
 <hibernate-mapping>
<class name="bean.Animal" table="animal">
    <id name="id" type="java.lang.Integer">
        <column name="id" length="50" scale="0" />
    </id>
     <many-to-one name="mammal" 
    column="mammal_id"
    not-null="true"/>
</class>

<class name="bean.Mammal" table="mammal">
    <id name="mammal_id" type="java.lang.Integer">
        <column name="mammal_id" length="50" scale="0" />
    </id>
    <discriminator column="type" type="string"/>

     <subclass name="bean.Dog" extends="bean.Mammal" discriminator-value="dog">
        </subclass>
        <subclass name="bean.Cat" extends="bean.Mammal" discriminator-value="cat">
        </subclass>
</class> 
```

结果表是：

```
+------------------------------+
|桌子 |
+------------------------------+
|动物 |
|哺乳动物 |
+------------------------------+

```

这些表中的模式是

```
+------------------------------+
|动物 |
+------------------------------+
|标识 |
|哺乳动物 ID |
+------------------------------+

+------------------------------+
|哺乳动物 |
+------------------------------+
|哺乳动物 ID |
|类型 |
+------------------------------+

```

希望这会有所帮助。顺便说一句，我仍然想知道你不使用注释来解决这个问题的原因是什么，因为你有解决方案，只是好奇:)。

# c# - linq 到实体框架与连接

> ID：13256246
> 
> 赞同：2
> 
> 时间：2012-11-06T17:30:10.743
> 
> 标签：c#, .net, wpf, entity-framework

我的 DB 2 表中有：

1.  文档（Document_Id，document_Name）

2.  Person_Documents (person_ID ,Documet_Id document_Done)

我使用实体框架，我想用`DataGrid`数据填充`document_Name`，`document_Done`

我尝试了以下没有结果：

```
 vagEntities projectE = new vagEntities();
      var doc = from c in projectE.Person_Documents                   
          join cw in projectE.Documents on c.Document_Id equals cw.Document_Id
          where c.Person_Id == 150
          select c;

      DocGrid.ItemsSource = doc; 
```

请问，我哪里错了？在 xaml 我写这个

```
 <DataGridTextColumn Binding="{Binding Path=Document_Name}" MinWidth="100"   Header="document"  />

            <DataGridCheckBoxColumn  Binding="{Binding Path=Document_done}" Header="Do" /> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:35:34.773

我认为您希望将结果投影到这样的匿名类型：

更新 - 项目到具体类

```
public class NameAndDone {
  public string document_Name { get; set; }
  public bool document_Done { get; set; }
}

var doc = from c in projectE.Person_Documents
          join cw in projectE.Documents on c.Document_Id equals cw.Document_Id
          where c.Person_Id == 150
          select new NameAndDone {
            cw.document_Name,
            c.document_Done
          }; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:38:48.030

我会这样做

```
 vagEntities projectE = new vagEntities();
  var doc = from c in projectE.Person_Documents                   
      from cw in projectE.Documents where c.Person_Id == 150 && c.Documents.Contains(cw)
      select c;

  DocGrid.ItemsSource = doc; 
```

# asp.net - 如何为 DataList 项模板中的标签控件分配动态 ID？

> ID：13256251
> 
> 赞同：1
> 
> 时间：2012-11-06T17:30:18.373
> 
> 标签：asp.net, asp.net-4.0

我有一个由 SQLDataSource 绑定的 DataList 控件。数据源正在获取两个列值，即：ID、名称。

DataList ItemTemplate 如下所示：

```
<DataList>
   <ItemTemplate>
       <asp:Label ID="Label1" runat="server" Text='<%# Eval(Name) %>' />
   </ItemTemplate>
</DataList> 
```

我希望将标签 ID 绑定到第一列，例如：

```
<asp:Label ID='<%# Eval(ID) %> ...../> 
```

但它给出的错误是 ID 应该很简单。

有没有办法使用 Eval 值生成分配给标签 ID？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:12:31.427

您不能使用数据绑定来分配它，但您可以访问 ClientID 并使用它。

```
<label for='<%# Container.FindControl("TargetControlID").ClientID %>'>
    Label Text
</label>
<asp:Label ID="TargetControlID" runat="server" Text="Target Control" /> 
```

# symfony - Symfony2 自定义错误异常监听器 - 渲染模板或传递给控制器

> ID：13256252
> 
> 赞同：3
> 
> 时间：2012-11-06T17:30:23.017
> 
> 标签：symfony, twig

我正在尝试找出在 Symfony2 中处理自定义错误页面的最佳方法。这包括 500 和 404 等。

我可以创建自己的自定义模板（error404.html.twig 等）并将它们渲染得很好，问题是，应用程序需要将一些变量传递到基本模板中以使页面保持一致。使用内置的异常处理程序会导致所需的变量不可用。

我已成功设置自定义异常事件侦听器，并将其注册为服务：

```
namespace MyCo\MyBundle\Listener;

use Symfony\Component\HttpKernel\Event\GetResponseForExceptionEvent;
use Symfony\Component\HttpFoundation\Response;
use Symfony\Component\HttpKernel\Exception\HttpExceptionInterface;
use Symfony\Component\DependencyInjection\ContainerInterface;
use Symfony\Bundle\TwigBundle\TwigEngine;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Template;

class MyErrorExceptionListener
{

    public function onKernelException(GetResponseForExceptionEvent $event)
    {
        // We get the exception object from the received event
        $exception = $event->getException();

        if($exception->getStatusCode() == 404)
        {

            //$engine = $this->container->get('templating');
            //$content = $engine->render('MyBundle:Default:error404.html.twig');    
            //return $response = new Response($content);

            /* Also Tried */
            //$templating = $this->container->get('templating');    
            //return $this->render('MyBundle:Default:index.html.twig');

            $response = new Response($templating->render('MyBundle:Exception:error404.html.twig', array(
                    'exception' => $exception
            )));

            $event->setResponse($response);

        }

    }
} 
```

这不起作用，因为 :$container 不可用，这意味着我无法呈现我的自定义页面。

所以真的有两个问题，这是处理自定义错误页面的正确方法，还是我应该将响应传递给控制器​​？如果是这样，最好的方法是什么？

如果这是正确的，我怎样才能使模板引擎在我的 Listener 中可用？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T18:31:40.317

你应该添加到你的 Listener

```
/**
 *
 * @var ContainerInterface
 */
private $container;

function __construct($container) {
    $this->container = $container;
} 
```

你如何注册你的监听器？您应该像服务一样注册侦听器

像那样

```
core.exceptlistener:
  class: %core.exceptlistener.class%
  arguments: [@service_container]
  tags:
        - { name: kernel.event_listener, event: kernel.exception, method: onKernelException, priority: 200 } 
```

最好的方法是不要使用 service_container。最好的方法是只注册必要的服务。

像那样

```
/**
 *
 * @var Twig_Environment
 */
private $twig;

function __construct($twig) {
    $this->twig = $twig;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-30T15:49:07.960

我解决类似问题的方法是：我不知道它是否可以帮助你。

```
const GENERIC_CODE = 550;
public function onKernelException(GetResponseForExceptionEvent $event)
{
    $exception = $event->getException();
    if ($exception instanceof RedirectableException) {
        $request = $event->getRequest();
        $url = $exception->getUrl($this->_authentication['base']['url']);
        $response = new Response();
        $response->setStatusCode(self::GENERIC_CODE, AuthenticationException::GENERIC_MESSAGE);
        $response->setContent($url);
        $event->setResponse($response);
   }
} 
```

# c# - REST 标准 - 输出模型是否应该始终与输入模型匹配？

> ID：13256258
> 
> 赞同：10
> 
> 时间：2012-11-06T17:30:59.953
> 
> 标签：c#, rest, asp.net-web-api

所以我要求部分输出模型必须包含 UI 重要信息。这些信息本质上是文本翻译和日期、价格、长度的建议格式。

因此，输出模型的示例可能是：

```
{
  statuses : {
    enumValue1 : "Display This Text",
    enumValue2 : "Display This Text2",
  },
  thePrice : {
    value : 3.50,
    formattedValue : "$3.50"
  },
  length : {
    meters 3,
    formattedValue : "3 ft."
  },
  iAmAPropertyOnlyInGet : 42
} 
```

现在，如果我将其作为输出模型，那么具有完全不同的输入模型是否“可以”？

```
{
  status : {
    enumValue1,
    enumValue2,
  },
  thePrice : 3.50,
  lengthInMeters : 3  
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T23:50:57.553

您发送到原始服务器的表示可能与您收到的表示完全不同。考虑网络浏览器的工作方式。你 GET`text/html`和你 POST `application/x-www-urlencoded-form`。

使用 PUT 方法时，如果不完全相同，您 PUT 和 GET 的内容相似是正常的。

REST 架构风格对 HTTP 有效负载的形状没有任何限制，除了必须在消息中明确指定语义这一事实。

因此，事实上，在客户端和服务器之间共享模型类型而不在消息中明确标识该类型违反了自描述 REST 子约束。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T17:56:44.033

这取决于您希望为客户（REST 服务消费者）提供什么样的灵活性。

如果您维护相同的模型，那么消费者可以加载现有模型，修改值，然后将其发回，这对于 CRUD 场景来说是非常自然的。

但是，如果您希望有两个不同的场景：1- 导入数据和 2- 导出数据，那么它们可能会有所不同。

通常，将其视为您的应用程序（您的问题域）中的模型。定义服务器端模型结构（这显然**只有一个**），然后想办法暴露它。对我来说，在查看问题中概述的这两个模型时，它们看起来很相似。我什至建议支持任何输入格式（其中任何一种）和一种输出格式（一次，可能取决于请求标头）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:31:54.390

除了数据本身，我会将元信息保存在单独的对象中。

所以在 JSON 响应中，第一个对象就像

```
{ meta:  { priceformat: $, lengthformat: ft },
 thePrice: 3.50,
 length: X
} 
```

# javascript - 如何在动态加载的表上调用 jQuery 表排序器

> ID：13256262
> 
> 赞同：1
> 
> 时间：2012-11-06T17:31:15.977
> 
> 标签：javascript, jquery, jquery-selectors, tablesorter

我有一个 jsp 文件，我在其中进行了 ajax 调用，该调用返回了一些 html。现在我将它填充到一个div中。html 结果的一个元素是我的表格。所以，在我做 ajax 调用之前，这个表不会被包含。所以，我无法使用表格排序器。例如：

我写了一些这样的东西：

```
 $('#sortByDate').on('click',(function(){

         sort = [[ 7, 0]];
    $('#resultsTable').trigger("sorton",[sort]);     
    });

 })); 
```

我遇到了一些异常，例如：

> “**未捕获的类型错误：无法读取未定义的属性‘7’** ”

我尝试了实时查询并得到了同样的错误。我能够在具有此结果表的 js 文件中成功使用表排序器。但我想要的只是从其他动态获取此表的 js 文件中调用表排序器。

我正在寻找类似 jquery live 功能的东西来自动为我做这件事..

请分享您的观点。

谢谢

# java - 使用 Java 中的 HttpClient 连接到具有更改值的表单

> ID：13256267
> 
> 赞同：0
> 
> 时间：2012-11-06T17:31:47.550
> 
> 标签：java, apache-httpclient-4.x

我正在尝试使用具有以下值的表单连接到 URL：

[http://aulavirtual.uv.es/](http://aulavirtual.uv.es/)

如果每次我记录值更改（时间、token_id、哈希），我该怎么做？请帮我 ！！我尝试使用 HttpUrlConnection，现在使用 HttpClient 4。

```
 <form name="login" method="post" action="/register/">
  <input type="hidden" name="form:mode" value="edit">
  <input type="hidden" name="form:id" value="login">
  <input type="hidden" name="__confirmed_p" value="0">
  <input type="hidden" name="__refreshing_p" value="0">
  <input type="hidden" name="return_url" value="/dotlrn/index">
  <input type="hidden" name="time" value="1352222384">
  <input type="hidden" name="token_id" value="423">
  <input type="hidden" name="hash" value="3F8865DB5E6603C296428A5A7C0D66C0256D5626">
      <tr>
            <td class="formulari">Nom d'usuari</td>
            <td class="formulari">
               <input type="text" id="username" name="username" value="" size="25" alt="Nom d'usuari"></td>
      </tr>
      <tr>
            <TD class="formulari">Contrasenya</TD>
            <TD class="formulari">
                <input type="password" id="password" name="password" size="25" ALT="Contrasenya d'accés"></TD>
      </tr>
      <TR>
            <TD COLSPAN="2"  class="formulari1">
               <div align="center">
                 <input id="login" type="submit" value="     Entreu      " alt="Entrar al Aula Virtual">
                 <A HREF="https://aulavirtual.uv.es"><IMG BORDER="0" HEIGHT="25" WIDTH="25" SRC="/resources/key.gif" ALT="Entrar en modo seguro" TITLE="Entrar en modo seguro"></A>
               </div>
            <!--
            <Table COLSPAN="2"  class="fonsgifs">
              <div align="center" class="titol3">
              <strong><A HREF="/altrescursos" class="font2nivell"><U>Altres cursos acad&egrave;mics</U></A></SPAN></strong>
            </table>
              <BR><BR><BR>
              <CENTER>
            -->
            <!--
              <A HREF="/dotlrn/clubs/openacslrnconference/xowiki/"><img align="center" src="/images/cabeceraOPEN.png" border = 0 align="center" alt="Conferencia OPEN" /></a>

              <BR><A HREF="/dotlrn/clubs/openacslrnconference/xowiki/"><img align="center" src="/images/ConferenciaSofwareLibre.png" border = 0 align="center" alt="Conferencia Software Libre" /></a>
              <BR><A HREF="/dotlrn/clubs/openacslrnconference/xowiki/">7th OpenACS / .LRN Conference </A> 
              <BR><A HREF="/dotlrn/clubs/openacslrnconference/xowiki/">Conferencia sobre Software Libre en Educación Superior</A>                   
              </CENTER>
            -->
        </TD>
        </TR>

      <TR>
            <TD  class="formulari1" COLSPAN="2" style="text-align:center">

            <BR><BR><BR>
            </TD>
      </TR>
    </FORM> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:28:44.250

出于安全目的，此表单使用隐藏参数。每次显示[http://aulavirtual.uv.es/](http://aulavirtual.uv.es/)时，这些隐藏的参数都会发生变化。

您可以尝试更改代码以执行以下操作：

1.  获取[http://aulavirtual.uv.es/](http://aulavirtual.uv.es/)页面。
2.  解析生成的 HTML 以从表单元素中提取 、 和 hidden 参数`time`的`token_id`值。`hash`
3.  Do the POST as you do now, but pass in these three values instead of the fixed values you are using now.

# java - 用字符或字符串替换下划线的有效方法

> ID：13256283
> 
> 赞同：1
> 
> 时间：2012-11-06T17:32:26.333
> 
> 标签：java, replace, append, stringbuilder

我已经研究了这个话题一段时间，但没有太大的成功。我确实找到了 StringBuilder 并且它创造了奇迹，但这就是我所得到的。以下是我如何让刽子手程序正常工作的方法：

```
 if(strGuess.equalsIgnoreCase("t")){
        mainword.replace(0,1,"T");
        gletters.append('T');      
    }
        else if(strGuess.equalsIgnoreCase("e")){
        mainword.replace(1,2,"E");
        gletters.append('E');       
    }
        else if(strGuess.equalsIgnoreCase("c")){
        mainword.replace(2,3,"C");
        gletters.append('C');         
    }
        else if(strGuess.equalsIgnoreCase("h")){
        mainword.replace(3,4,"H");
        gletters.append('H');      
    }
        else if(strGuess.equalsIgnoreCase("n")){
        mainword.replace(4,5,"N");
        gletters.append('N');      
    }
        else if(strGuess.equalsIgnoreCase("o")){
        mainword.replace(5,6,"O");
        mainword.replace(7,8,"O");
        gletters.append('O');       
    }
        else if(strGuess.equalsIgnoreCase("l")){
        mainword.replace(6,7,"L");
        gletters.append('L');       
    }
         else if(strGuess.equalsIgnoreCase("g")){
        mainword.replace(8,9,"G");
        gletters.append('G');      
    }
        else if(strGuess.equalsIgnoreCase("y")){
        mainword.replace(9,10,"Y");
        gletters.append('Y'); 
    }
        else{
        JOptionPane.showMessageDialog(null, "Sorry, that wasn't in the word!");
        errors++;
        gletters.append(strGuess.toUpperCase());
    }
        SetMain = mainword.toString();
        GuessedLetters = gletters.toString();
        WordLabel.setText(SetMain);
        GuessedLabel.setText(GuessedLetters);
        GuessText.setText(null);
        GuessText.requestFocusInWindow(); 
```

但是，我不能对每个单词的每个字母都这样做，那么有没有一种简单有效的方法来做到这一点？我想要的是有一个循环，这样我只需要对任何单词使用一次。所以这个词可能是技术（就像上面一样）或苹果或泡菜或圣诞节或你好或其他任何东西。

我尝试过使用 for 循环，我觉得答案就在于此。如果有人可以解释 charAt() 方法以及如何/在哪里使用它，那就太好了。我最接近更有效率的是：

```
for(i = 0; i < GuessWord.length(); i++) { 
    if (GuessWord.charAt(i) == guess2) { 
        mainword.replace(i,i,strGuess.toUpperCase()); 
    } 
```

因此，如果您可以以此为基础并摆脱它，例如修复它？或者告诉我一些我没有想到的事情。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:07:46.897

这是个好问题。有明显重复的代码，那么你如何用可重用的东西替换所有这些。实际上，您可以省去所有代码。

整个代码块可以只替换为一行（适用于每个单词）！

```
String word = "TECHNOLOGY"; // This is the word the user must guess
mainword = word.replaceAll("[^" + gletters + "]", "_"); 
```

这[`replaceAll()`](http://docs.oracle.com/javase/6/docs/api/java/lang/String.html#replaceAll%28java.lang.String,%20java.lang.String%29)与表示“任何尚未猜到的字母”的正则表达式一起使用，并将其替换为下划线字符`"_"`。请注意，字符串是不可变的，并且该`replaceAll()`方法*返回*修改后的字符串 - 它不会修改调用的字符串。

这里有一些测试代码来展示它的实际效果：

```
public static void main(String[] args) {
    String word = "TECHNOLOGY"; // what the user must guess
    StringBuilder gletters = new StringBuilder("GOTCHA"); // letters guessed
    String mainword = word.replaceAll("[^" + gletters + "]", "_");
    System.out.println(mainword);
} 
```

输出：

```
T_CH_O_OG_ 
```

# java - Java 文件异常处理

> ID：13256285
> 
> 赞同：1
> 
> 时间：2012-11-06T17:32:29.000
> 
> 标签：java, exception

我应该为我的 java 分配创建一个用于文件操作异常处理的示例程序。因为我是 C++ 人，所以我很难理解。如果有人能指出我下面代码中的缺陷，那将非常有帮助。我指的是[这篇](http://www.akadia.com/services/java_exceptions.html)文章。Eclipse 给了我*“FileNotFoundException 无法到达的 catch 块。这个异常永远不会从 try 语句体中抛出”*错误。

```
import java.io.*;

public class file {

    public static void main(String[] args) {
        String arg1 = args[0];
        String arg2 = args[1];
        System.out.println(arg1);
        System.out.println(arg2);
        File f1, f2;

        try {
            f2 = new File(arg2);
            f1 = new File(arg1);
        }
        catch(FileNotFoundException e) {
        /*
            if(!f1.exists()) {
                System.out.println(arg1 + " does not exist!");
                System.exit(0);
            }
            if(!f2.exists()) {
                System.out.println(arg2 + " does not exist!");
                System.exit(0);
            }

            if(f1.isDirectory()) {
                System.out.println(arg1 + " is a Directory!");
                System.exit(0);
            }
            if(f2.isDirectory()) {
                System.out.println(arg2 + " is a Directory!");
                System.exit(0);
            }

            if(!f1.canRead()) {
                System.out.println(arg1 + " is not readable!");
                System.exit(0);
            }
            if(!f2.canRead()) {
                System.out.println(arg2 + " is not readable!");
                System.exit(0);
            }*/
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-06T17:34:46.700

查看[`File`您正在调用的构造函数](http://docs.oracle.com/javase/7/docs/api/java/io/File.html#File%28java.lang.String%29)的文档。它声明抛出的*唯一*异常是`NullPointerException`. 因此它*不能*throw `FileNotFoundException`，这就是你收到错误的原因。您不能尝试捕获编译器可以证明从未在相应`try`块中抛出的已检查异常。

创建`File`对象不会检查其是否存在。如果您正在*打开*文件（例如，使用`new FileInputStream(...)`then*可能*会抛出`FileNotFoundException`......但不仅仅是创建一个`File`对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T17:39:09.083

这是因为类的构造函数[`File`](http://docs.oracle.com/javase/6/docs/api/java/io/File.html)只有一个参数

```
public File(String pathname)  
Parameters:pathname - A pathname string Throws: NullPointerException - If the pathname argument is null
Throws: NullPointerException - If the pathname argument is null 
```

只抛出一个异常，那就是`NullPointerException`. 您的代码试图捕获一个`FileNotFoundException`不相关的`NullPointerException`，这就是您在 Eclipse 中收到此错误的原因。

一种方法是捕获类的异常，`Exception`这是`super`Java中所有异常的类。另一种方法是捕获`catch`被调用构造抛出的所有异常（每个异常都在不同的块中）（可以通过其 API 轻松获得）。第三种方法是只捕获对您的应用程序有意义的异常（同样是由构造实际抛出的）并忽略其他异常。

# c# - WPF MultiBinding 在 Syncfusion TabItemExt 标头中失败

> ID：13256286
> 
> 赞同：1
> 
> 时间：2012-11-06T17:32:30.670
> 
> 标签：c#, wpf, xaml, multibinding, syncfusion

我有一个`TabItem`如下的子类，我正在尝试为其设置`Header`属性。我试过这个`MultiBinding`：

```
<DataEditPane x:TypeArguments="MyType" x:Class="MyDataEditPane">
    <DataEditPane.Header>
        <MultiBinding StringFormat="Hello world {0} {1}">
            <Binding Path="BoundVariable1" />
            <Binding Path="BoundVariable2" />
        </MultiBinding>    
    </DataEditPane.Header>
</DataEditPane> 
```

但它失败了：

```
System.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object')
System.Windows.Data Error: 28 : MultiBinding failed because it has no valid Converter. MultiBindingExpression:target element is 'MyDataEditPane' (Name=''); target property is 'Header' (type 'Object') 
```

我一直认为`StringFormat`转换器的角色，但也许不是？

将字段包装在某种容器中，例如 a `Label`，似乎也不起作用：

```
<DataEditPane x:TypeArguments="MyType" x:Class="MyDataEditPane">
    <DataEditPane.Header>
        <Label>
            <Label.Text>
                <MultiBinding StringFormat="Hello world {0} {1}">
                    <Binding Path="BoundVariable1" />
                    <Binding Path="BoundVariable2" />
                </MultiBinding>    
            </Label.Text>
        </Label>
    </DataEditPane.Header>
</DataEditPane> 
```

在这种情况下，`.ToString()`标签 (" `System.Windows.Controls.Label`") 的表示形式显示为标题。

请注意，单个绑定可以正常工作：

```
<DataEditPane x:TypeArguments="MyType" x:Class="MyDataEditPane">
    <DataEditPane.Header>
        <Binding Path="BoundVariable1" />
    </DataEditPane.Header>
</DataEditPane> 
```

如果重要的话，我将 Syncfusion`TabItemExt`用作继承层次结构中的超类之一，但由于该类不会覆盖该`Header`属性，我认为这没有什么不同。

我究竟做错了什么？我知道我可以在 ViewModel 中创建另一个属性作为标题（然后单绑定），但我想学习如何在 XAML 中正确执行此操作。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:06:07.317

尝试使用 TextBlock 而不是 Label。以下代码对我来说很好。

我试过这个：

```
<Window x:Class="ListBox.Window1"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:local="clr-namespace:ListBox" Title="Window1" Height="300" Width="300">
    <Window.DataContext>
        <local:TextVM/>
    </Window.DataContext>
    <StackPanel>
        <TextBox Text="{Binding Text1}"  />
        <TextBox Text="{Binding Text2}" />
        <TextBlock>
            <TextBlock.Text>
                <MultiBinding StringFormat="Hello World {0} - {1}">
                    <Binding Path="Text1" />
                    <Binding Path="Text2" />
                </MultiBinding>
            </TextBlock.Text>
        </TextBlock>
    </StackPanel>
</Window> 
```

我想知道 StringFormat 是否仅在需要字符串而不是对象的情况下才有效。

MSDN 上有一个例子：http: [//msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.stringformat.aspx](http://msdn.microsoft.com/en-us/library/system.windows.data.bindingbase.stringformat.aspx)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T18:48:24.640

多重绑定需要一个转换器，我认为您可能使用的转换器是`StringFormatConverter`，它`IMultiValueConverter`适用于多重绑定。也许你应该适应你的情况。

希望这对您有用...

# c++ - 如何使用用户界面线程关闭 DLL？

> ID：13256288
> 
> 赞同：0
> 
> 时间：2012-11-06T17:32:32.437
> 
> 标签：c++, multithreading, dll, mfc

我制作了一个带有打开非模式窗口的函数的 DLL。

```
class CMainFrame : public CFrameWnd
{
protected:
    CMainFrame() {}
    DECLARE_DYNCREATE(CMainFrame)
public:
    virtual void PostNcDestroy()
    { AfxPostQuitMessage(0); }
public:
    virtual ~CMainFrame() {}
};
IMPLEMENT_DYNCREATE(CMainFrame, CFrameWnd)

class CDllApp : public CWinApp
{
public:
    CDllApp() :
        m_pDocTemplate(NULL)
    {};
public:
    virtual BOOL InitInstance()
    {
        CWinApp::InitInstance();
        m_pDocTemplate = new CMultiDocTemplate(IDR_MAINFRAME, RUNTIME_CLASS(C3DGraphDoc),
            RUNTIME_CLASS(CMainFrame), RUNTIME_CLASS(C3DGraphView));
        return TRUE;
    }
public:
    CMultiDocTemplate* m_pDocTemplate;
};

CDllApp theApp;

class C3DThread : public CWinThread
{
    DECLARE_DYNCREATE(C3DThread)
public:
    virtual BOOL InitInstance()
    {
        theApp.m_pDocTemplate->OpenDocumentFile(NULL);
    }
};
IMPLEMENT_DYNCREATE(C3DThread, CWinThread)

void __stdcall ExportedFunction()
{
    AfxBeginThread(RUNTIME_CLASS(C3DThread));
} 
```

如果我在退出主应用程序之前关闭所有窗口，那么一切看起来都很好，否则我的线程会挂起。所以，我认为我需要通过关闭所有打开的文档来进行清理，我想知道优雅地完成它的最简单方法是什么。`m_pDocTemplate->CloseAllDocuments()`from theApp 不起作用，因为文档的框架窗口属于不同的线程。

# c# - EF获取添加对象的键值

> ID：13256290
> 
> 赞同：0
> 
> 时间：2012-11-06T17:32:34.910
> 
> 标签：c#, sql, entity-framework

是否可以获取添加对象的实体键值？

键值在 context.SaveChanges() 之后设置。但不幸的是，在 context.SaveChanges 之后，EntityState.Added 消失了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:53:25.800

您是在谈论添加到上下文中的实体的主键吗？如果是这样，您可以直接在 SaveChanges() 之后访问它。通过调用实体对象的主键属性。

IE。

```
context.AddToMyTable(entity);
context.SaveChanges();
int primaryKey = entity.Id; 
```

保存更改后，实体对象应该会更新。

# knockout.js - 为简单的 jQuery 插件创建一个 knockoutJS 自定义绑定

> ID：13256293
> 
> 赞同：7
> 
> 时间：2012-11-06T17:32:40.947
> 
> 标签：knockout.js

KnockoutJS 开发人员是否需要采取通用方法或至少一组步骤来为简单的 jquery 插件创建绑定。

例如，如果在“通用代码”中像这样触发插件：

`$('#tag1').tagsInput({ // my parameters here });`

这个插件的最简单的自定义 KO 绑定会是什么样子？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T17:36:33.220

这是一种常见的方式，例如对于 jQuery 按钮：

```
ko.bindingHandlers.jqButton = {
    init: function(element, valueAccessor) {
        var options = valueAccessor() || {};
        $(element).button(options);
    }
};

<button data-bind="click: greet, jqButton: { icons: { primary: 'ui-icon-gear' } }">Test</button> 
```

阅读本文了解一些最佳实践：[http ://www.knockmeout.net/2011/07/another-look-at-custom-bindings-for.html](http://www.knockmeout.net/2011/07/another-look-at-custom-bindings-for.html)

# jquery - 使用方向检测来确定图像的位置

> ID：13256295
> 
> 赞同：0
> 
> 时间：2012-11-06T17:32:47.720
> 
> 标签：jquery, html, css

我在标题居中的 HTML 页面上有一个标题（h1）。纵向模式允许图像位于该标题上方，并且我希望图像在将方向更改为横向时位于标题的左侧。

我尝试与`<br>`@media screen`(orientation:portrait/landscape)` 和不同的设置结合使用，但没有任何进展。如果我使用左浮动图像仍然停留在标题等上方的行上。我真的不知道如何解决它..

```
<!DOCTYPE HTML> 
<html> 
<body> 
<h1><img>"picture"</img><br>Car</h1> 
</body> 
</html> 
```

有没有人有什么建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:19:58.247

希望这段代码对您有所帮助。

**html代码**

```
<h1><img src="img.jpg" /> <span>Call</span></h1> 
```

**普通视图的 CSS 代码**

```
h1{
    text-align:center;
}
h1 img{
    display:inline;
}
h1 span{
    display:block;
} 
```

**横向视图的CSS代码**

```
h1 span{
    display:inline;
    background-color:#3CF;
    position:relative;
    top:-25px;
} 
```

根据您的图像高度调整顶部位置。

# expression - 创建表达式 在一个循环中

> ID：13256300
> 
> 赞同：2
> 
> 时间：2012-11-06T17:33:06.830
> 
> 标签：expression, func

我需要创建一个表达式来使它像：

```
 Expression<Func<MyDataSet, bool>> searchfilter = null;

 string[] strsearchvalues = Searchvalues.Split(',');

 searchfilter = p => p.searchcolumn.contains(strsearchvalues[0]) && p.searchcolumn.contains(strsearchvalues[1]) && .... 
```

我试过这个，但它不起作用：

```
Expression<Func<MyDataSet, bool>> columnfilter = null;

foreach(var s in strsearchvalues)
{
   columnfilter =  p => p.searchcolumn.contains(s);
  searchfilter = columnfilter.And(columnfilter);
} 
```

如果搜索值为“bob Smith”，我希望结果返回包含 bob 和 smith 的列，例如“boby smither”或“smither boby”。使用上面的代码，它返回“boby something”或“smith something” '。

如何创建一个带有循环的表达式来完成它？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:49:53.690

尝试这样做：

```
Expression<Func<MyDataSet, bool>> columnfilter = null;

foreach(var s in strsearchvalues)
{
   columnfilter = columnfilter == null ? p => p.searchcolumn.contains(s) : columnfilter.And(p => p.searchcolumn.contains(s)) ;
}
searchfilter  = columnfilter; 
```

希望这对你有帮助......

# shell - 如何让我的带有 1 个参数的 shell 脚本在命令行中接受默认的 unix 命令

> ID：13256305
> 
> 赞同：0
> 
> 时间：2012-11-06T17:33:25.477
> 
> 标签：shell, unix

我需要编写一个 shell 脚本来查找文件的模式，并且代码需要能够接受其他 Unix 命令作为可选参数。

例如：

```
mycode 644 ls -l 
```

应该对当前目录中模式为 644 的所有文件执行命令 ls -l。我只需要知道 shell 脚本的哪些方面帮助我在这里运行`ls -l`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:21:02.640

我认为对你来说最好的方法是使用 find。

因此，例如您正在寻找的操作可以通过这个简单的命令执行：

```
find . -perm 0644 -exec ls -l {} \; 
```

您的脚本可能如下所示：

```
#!/bin/sh
perm=$1
shift
find . -perm $perm $* {} \; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:37:04.907

以下将做到这一点：

```
#!/bin/bash
mode=$1
shift
$* 
```

它将第一个参数删除到变量中，并将其余参数作为单个 shell 命令执行。它不会尝试处理`mode`，但您表示您的问题与此无关。

# .net - 使用 .NET 检查每个 HTTP 请求中的会话变量

> ID：13256308
> 
> 赞同：0
> 
> 时间：2012-11-06T17:33:44.863
> 
> 标签：.net, session, authentication

.NET 中是否有一种方法可以在每个 HTTP 请求时检查某些 Session 变量的存在，而不必在每个页面的代码中包含此检查？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:40:24.577

一种简单的方法是创建一个所有页面都继承自的基页面类，并在那里进行检查。

在 IIS 7.5 中，您可以设置自定义[请求过滤器](http://www.iis.net/configreference/system.webserver/security/requestfiltering)规则。

# internet-explorer - 在没有标签/id的HTML/JAVA网页中使用VBA输入值

> ID：13256319
> 
> 赞同：2
> 
> 时间：2012-11-06T17:34:38.027
> 
> 标签：internet-explorer, vba, excel

在过去的两天里，我一直盯着屏幕试图了解如何解决这个问题……但无济于事。

我创建了一个简单的 VBA 搜索工具，可以有效地找到一个值。我想创建一些进一步的代码来将此值输入到通过 URL 访问的内部数据库中。

我知道如何使用 vba excel 填写 html Web 表单，但是数据库有一个界面表单，我喜欢做同样的事情，除了将密钥发送到活动屏幕。

我认为问题在于没有引用我认为是 JAVA 的 HTML 代码部分，这是我想更改其值的输入。

[站点/数据库的源代码]

```
<HTML><HEAD><TITLE></TITLE></HEAD>
<FRAMESET id="Frame1" frameSpacing="4" border="1" cols="280,80%" frameBorder="0">
<FRAME src="/frames/topics.html" name="topics" />
<FRAMESET id="Frame2" rows="50%,50%">
<FRAMESET id="Frame3" rows="40,*">
<FRAME src="/frames/uppermenu.html" name="uppermenu" scrolling="no" NOSCROLL="" /><FRAME src="/frames/upper.html" name="upper" />
</FRAMESET>
<FRAMESET id="Frame4" rows="40,*">
<FRAME src="/frames/lowermenu.html" name="lowermenu" scrolling="no" NOSCROLL="" /><FRAME src="/bin/lower_frame?CLASS_NAME=DRAWING_2D" name="lower" />
</FRAMESET>
</FRAMESET>
</FRAMESET>
</HTML> 
```

然而，这只是主脚本，我试图更改的值嵌入在第 3 帧部分中，这似乎是 JAVA。在 VBA 中单步执行一些其他代码时，它只会将“upper”视为标签名称。并且表单搜索在 VBA 中没有任何指示，即使它在 HTML 代码中有表单引用。

具体的代码行是：

```
<input name="NAME" type="text" size="15" value=""/> 
```

我很想弄清楚这一点，记住我只使用过 VBA，这绝对是一个跳跃。如果有人可以给我任何指导，我将不胜感激。

谢谢

Ps 抱歉，如果我没有使用该网站的正确报价，这是我第一次在任何论坛上发帖。

# java - 在正则表达式（Java）中循环一组

> ID：13256322
> 
> 赞同：1
> 
> 时间：2012-11-06T17:34:59.510
> 
> 标签：java, regex

我有一个包含类似`([A-Za-z]\s)+`. 它返回一组包含所有字母，后跟一个空格。但是，它只保留组中的最后一个元素，例如，如果文本包含`a b c d`，我尝试打印组匹配，但它只返回字母 (d)。这是我的程序

```
while (m.find()) {
      L = m.group(1);
      System.out.println(L);
                  } 
```

我的问题是为什么我只收到字母 (d) 而不是所有字母？是不是因为他们都是通过一组抓到的？我该如何纠正？我怎样才能遍历一组。例如，遍历检测为一组的所有匹配项？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:52:15.943

您的正则表达式的问题在于它匹配*一个字符后跟一个空格*的所有序列。

在您的示例中，`group()`将返回整个`a b c d`字符串。但是，当捕获大括号在重复中（例如您的`+`）时，只能检索最后捕获的值，因此`group(1)`返回`d`。

要解决您的问题，只需`+`从您的正则表达式中删除。这将使`find()`成功几次，每次你都会得到不同的匹配。在这种情况下，您甚至可以删除括号并简单地使用`group()`.

# javascript - JQuery/Flask - 以 JSON 格式将数据从服务器发送到浏览器

> ID：13256325
> 
> 赞同：0
> 
> 时间：2012-11-06T17:35:12.867
> 
> 标签：javascript, python, jquery, flask

首先请原谅我的无知，我对这一切都很陌生。

我的问题是我试图将存储在 mongodb 坐标中的 json 数据发送到客户端浏览器。我有一个 python 模块，它使用 Twitter 的 Streaming API 存储到数据库中。这很好用，但是当我尝试将其发送到客户端时，它什么也不显示，即使我可以看到服务器终端获取更多数据。我以前没有使用过 Flask 或 JQuery，因此基于[http://flask.pocoo.org/docs/patterns/jquery/](http://flask.pocoo.org/docs/patterns/jquery/)上的示例。

这是我的代码：

```
from flask import Flask, jsonify, render_template, request
from pymongo import Connection 

app = Flask(__name__)

@app.route('/_reader')
def reader():
    db = Connection().tstream
    coll = db.tweets_tail
    cursor = coll.find({"coordinates.type" : "Point" }, {"coordinates" :1},tailable=True,timeout=False)
    ci=0
    while cursor.alive:
        try:
            doc = cursor.next()
            ci += 1
            print doc
            print ci
        except StopIteration:
            pass
    return jsonify(ci, doc)

@app.route('/')
def index():
    return render_template('index.html')

if __name__ == '__main__':
    app.run(debug=True, port= 8888) 
```

这是我的 html 客户端：

```
{% extends "layout.html" %}
{% block body %}
<script type=text/javascript>
  $(function() {
       $.getJSON($SCRIPT_ROOT + '/_reader', 
       function(data) {
        $("#result").text(data.result);
      });
      return false;
    });

</script>
<h1>Coordinates</h1>
<p>
   <span id=result>?</span>
{% endblock %} 
```

我希望收到新的坐标数据，并将其推送给客户端。

我希望有人能帮忙。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:09:21.373

不确定您的线路 return jsonify(ci, doc)

你确定这会正确返回吗？参数应该是字典格式。你可以试试这个吗

```
return jsonify(dict(ci=ci, doc=doc)) 
```

# ironpython - 分发 IronPython：MissingMethodException InitializeModuleEx

> ID：13256327
> 
> 赞同：0
> 
> 时间：2012-11-06T17:35:40.553
> 
> 标签：ironpython

我有一个用 IronPython 编写的应用程序，我想将它作为 .exe 分发到其他 PC 上。我一直按照[此处](https://stackoverflow.com/questions/6195781/ironpython-exe-compiled-using-pyc-py-cannot-import-module-os/6205193#6205193)的说明使用 pyc.py ，并且取得了一定的成功。我最终得到一个目录，其中包含：

*   my_app.exe
*   my_app.dll
*   StdLib.DLL [这包含标准 IronPython 库，如上面引用的 SO 帖子中所建议的]
*   IronPython.dll
*   IronPython.Modules.dll
*   Microsoft.Dynamic.dll
*   Microsoft.Scripting.dll
*   Microsoft.Scripting.Metadata.dll

我正在使用 IronPython 2.7.3；在我的开发机器上，我有 .NET 4.0.30319.17929。

我遇到的问题是，当我将上述内容分发到其他机器时，在某些机器上它运行良好，而在其他机器上我得到以下信息：

```
Unhandled Exception: System.MissingMethodException: Method not found: 'Int32 Iro
nPython.Runtime.Operations.PythonOps.InitializeModuleEx(System.Reflection.Assemb
ly, System.String, System.String[], Boolean)'.
   at PythonMain.Main() 
```

它运行的机器包括 Windows 7 和 Windows XP 机器，它失败的机器还包括 Windows 7 和 Windows XP。我检查了 .NET 版本，比较了可以工作的机器和不工作的机器，我看不到任何明显的东西。例如，在失败的 XP 机器上，我有一个 .NET 配置文件：

```
<32Bit>
1.1.4322.2494
  ->C:\WINDOWS\Microsoft.NET\Framework\v1.1.4322
2.0.50727.3634
  ->C:\WINDOWS\Microsoft.NET\Framework\v2.0.50727
4.0.30319.269
  ->C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319

< Installed .NET Frameworks >
.NET FW 1.1 SP 1
.NET FW 2.0 SP 2
.NET FW 3.0 SP 2
.NET FW 3.5 SP 1
.NET FW 4.0 Client
.NET FW 4.0 Full 
```

在运行良好的 XP 机器上，我有一个 .NET 配置文件：

```
<32Bit>
1.1.4322.2494
  ->C:\Windows\Microsoft.NET\Framework\v1.1.4322
2.0.50727.3634
  ->C:\Windows\Microsoft.NET\Framework\v2.0.50727
4.0.30319.269
  ->C:\Windows\Microsoft.NET\Framework\v4.0.30319

< Installed .NET Frameworks >
.NET FW 1.1 SP 1
.NET FW 2.0 SP 2
.NET FW 3.0 SP 2
.NET FW 3.5 SP 1
.NET FW 4.0 Client
.NET FW 4.0 Full 
```

这看起来和我一模一样。

我真的不知道接下来该看什么；任何线索？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T10:56:47.770

上面 Jeff Hardy 的评论就是答案：出现错误的机器已经安装了旧版本的 IronPython，并且使用的是这些程序集，而不是与 exe 分布在同一目录中的本地程序集。通过在有问题的机器上卸载 IronPython 来解决。

# jquery - Jquery每个循环，然后等待点击

> ID：13256328
> 
> 赞同：0
> 
> 时间：2012-11-06T17:35:40.653
> 
> 标签：jquery

我真的很想知道如何让它工作（或者即使有可能），但我需要做的是在每个循环中：

每个循环的开始 更改 iframe 的源 等待框架加载 运行一个修改页面内容的 get 然后等待用户单击 2 个按钮之一 循环中的下一个项目

用jquery可以吗？到目前为止，我有：

```
$.each(arr, function (index, value) {

var url = this.url;
$('#frameid').attr('src',url);
//need to wait for iframe to finish loading here
$.get("ajax.php", {action:'findfields',url:url}, function(result){
    //do some stuff which I already have working
});
//wait for button click and then next in loop

}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:41:38.827

一个暂定的解决方案是简单地将其余代码绑定到负载处理程序，并使用函数递归进行迭代。

```
var arr = [...];
var index = 0;

function iterate() {
    var url = this.url;
    $('#frameid').attr('src',url);
    $('#frameid').unbind("load");
    $('#somebutton').unbind("click");

    //need to wait for iframe to finish loading here
    $('#frameid').on("load",function(){
        $.get("ajax.php", {action:'findfields',url:url}, function(result){
            //do some stuff which I already have working
            $("#somebutton").click(iterate);
        });
    });
    index++;
}); 
```

# asp.net - 我的 ImageHandler 不起作用

> ID：13256331
> 
> 赞同：0
> 
> 时间：2012-11-06T17:36:18.460
> 
> 标签：asp.net, ashx

我正在尝试编写一个简单的处理程序，它应该返回一个图像 URL，以便我可以在我的网站上显示它。这就是我的处理程序的样子：

```
<%@ WebHandler Language="C#" Class="KameraHandler" %>

using System;
using System.Web;

public class KameraHandler : IHttpHandler {

    public void ProcessRequest (HttpContext context) {
        context.Response.Write("http://web.scott.k12.va.us/martha2/dmbtest.gif");
    }

    public bool IsReusable {
        get {
            return false;
        }
    }
} 
```

这就是我调用我的处理程序的方式，但它不起作用。

```
protected void AraLinkButton_Click(object sender, EventArgs e)
{
     KameraImage.Src = "~/GenericHandler/KameraHandler.ashx;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:39:52.333

您的图像处理程序应该返回图像的原始字节（并带有适当的`Content-Type`），而不是图像的 URL。

您应该将其`src`直接设置为该（外部）URL。

或者，您可以让 ASHX 向该 URL 发送重定向，或使其转发该 URL 的内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:39:58.407

您必须从该其他 URL 下载图像并将其字节写出。您还需要设置 MIME 类型。

# sql - 用序列填充空列

> ID：13256336
> 
> 赞同：0
> 
> 时间：2012-11-06T17:36:34.303
> 
> 标签：sql, sql-server, sql-server-2008, tsql

有没有办法用从 1 开始的升序数字填充一个空列，而不使用标识？

我尝试了以下游标，但它为列中的所有行填充相同的值（450）：

```
declare cur3 cursor for
select new_id from sheet1$
declare @no int
declare @no1 int
set @no1 = 1
open cur3
fetch next from cur3 into @no
while(@@FETCH_STATUS = 0)
begin
update sheet1$ set new_id = @no1
set @no1 = @no1 + 1
fetch next from cur3 into @no
end
close cur3
deallocate cur3 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:50:35.483

问题是您`WHERE`在更新查询中缺少一个子句，因此每个循环都在更新所有行。它应该是：

```
UPDATE  sheet1$ 
SET     new_id = @no1
WHERE   New_ID = @No    -- ONLY UPDATE 1 ROW 
```

顺便说一句，假设您的 SQL-Server 标记是正确的，您可以使用`ROW_NUMBER()`函数在没有光标的情况下执行此操作

```
WITH CTE AS
(   SELECT  New_ID, [RN] = ROW_NUMBER() OVER(ORDER BY New_ID)
    FROM    yourTable
)
UPDATE  CTE
SET     New_ID = RN 
```

**编辑 - 解释**

ROW_NUMBER 只是提供了一个数字序列，[Common Table Expression](http://msdn.microsoft.com/en-us/library/ms190766%28v=sql.105%29.aspx)就像一个动态视图：

```
If you run:

WITH CTE AS
(   SELECT  New_ID, [RN] = ROW_NUMBER() OVER(ORDER BY New_ID)
    FROM    yourTable
)
SELECT  *
FROM    CTE 
```

您应该更好地了解 CTE 中正在做什么，那么 CTE 的美妙之处在于您可以直接更新它们而无需参考回原始表，因此更新 CTE 相当于：

```
UPDATE  yourTable
SET     New_ID = RN
FROM    yourTable
        INNER JOIN
        (   SELECT  New_ID, [RN] = ROW_NUMBER() OVER(ORDER BY New_ID)
            FROM    yourTable
        ) n
            ON n.New_ID = yourTable.New_ID; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:49:05.123

是的，`ROW_NUMBER`。

像下面这样使用：

```
select ROW_NUMBER()OVER(ORDER BY Somefield) As Id
      ,*
  from SomeTable 
```

您可以阅读所有相关信息：http: [//msdn.microsoft.com/en-us/library/ms186734 (v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms186734(v=sql.105).aspx)

# perl - 如何使用 foreach 控制结构在 perl 中标准化我的结果？

> ID：13256338
> 
> 赞同：0
> 
> 时间：2012-11-06T17:36:42.000
> 
> 标签：perl, normalization

我有这个输出：

```
10dvex2_miRNA_ce.out.data|6361
10dvex2_miRNA_ce.out.data|6361
10dvex2_misc_RNA_ce.out.data|0
10dvex2_rRNA_ce.out.data|239 
```

在 Perl 中使用这个脚本：

```
#!/usr/bin/perl

use warnings;
use strict;

open(MYINPUTFILE, $ARGV[0]); # open for input
my @lines = <MYINPUTFILE>; # read file into list
my $count = 0;
print "Frag"."\t"."ncRNA"."\t"."Amount"."\n";

foreach my $lines (@lines){
my $pattern = $lines;
$pattern =~ s/(.*)dvex\d_(.*)_(.*).(out.data)\|(.*)/$1 $2   $3  $5/g;
$count += $5;
print $1."\t".$2.$3."\t".$5."\n";
}
close(MYINPUTFILE);
exit; 
```

我提取此信息：

```
Frag    ncRNA   Amount
10  miRNAce 6361
10  misc_RNAce  0
10  rRNAce  239 
```

但在金额列中，我想报告这些数字除以总结果（6600）。在这种情况下，我想要这个输出：

```
Frag    ncRNA   Amount
10  miRNAce 0.964
10  misc_RNAce  0
10  rRNAce  0.036 
```

我的问题是在循环中提取 TOTAL 结果......以规范化这些数据。一些想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T20:47:20.143

也许以下内容会有所帮助：

```
use strict;
use warnings;

my ( %hash, $total, %seen, @array );

while (<>) {
    next if $seen{$_}++;
    /(\d+).+?_([^.]+).+\|(\d+)$/;
    $hash{$1}{$2} = $3;
    $total += $3;
}

print "Frag\tncRNA\tAmount\n";

while ( my ( $key1, $val1 ) = each %hash ) {
    while ( my ( $key2, $val2 ) = each %$val1 ) {
        my $frac = $val2 / $total == 0 ? 0 : sprintf( '%.3f', $val2 / $total );
        push @array, "$key1\t$key2\t$frac\n";
    }
}

print map { $_->[0] }
  sort    { $b->[1] <=> $a->[1] }
  map { [ $_, (split)[2] ] }
  @array; 
```

数据集的输出：

```
Frag    ncRNA   Amount
10  miRNA_ce    0.964
10  rRNA_ce 0.036
10  misc_RNA_ce 0 
```

跳过相同的行，然后从每行中捕获所需的元素。为后续计算保留运行总计。您想要的输出显示从高到低排序，这就是为什么每条记录都被`push`编辑到`@array`. 但是，如果不需要排序，您可以只打印该行并省略[Schwartzian 变换](http://en.wikipedia.org/wiki/Schwartzian_transform)on `@array`。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T21:00:36.893

为此，您需要对数据进行两次传递。

```
#! /usr/bin/env perl

use warnings;
use strict;

print join("\t",qw'Frag ncRNA Amount'),"\n";

my @data;
my $total = 0;

# parse the lines
while( <> ){
  my @elem = /(.+?)(?>dvex)\d_(.+)_([^._]+)[.]out[.]data[|](d+)/;
  next unless @elem;

  # running total
  $total += $elem[-1];

  # combine $2 and $3
  splice @elem, 1, 2, $2.$3; # $elem[1].$elem[2];

  push @data, \@elem;
}

# print them
for( @data ){
  my @copy = @$_;
  $copy[-1] = $copy[-1] / $total;
  $copy[-1] = sprintf('%.3f', $copy[-1]) if $copy[-1];
  print join("\t",@copy),"\n";
} 
```

# wso2 - WSO2 BAM 设备上没有剩余空间

> ID：13256340
> 
> 赞同：2
> 
> 时间：2012-11-06T17:36:48.007
> 
> 标签：wso2, wso2carbon, wso2bam

嗨，我在服务器上运行 BAM 进行测试，该服务器具有以下文件系统分布：

```
root@serv:/# df -h
Filesystem                             Size  Used Avail Use% Mounted on
/dev/mapper/VG-LV_root_                3.8G  2.3G  1.4G  62% /
udev                                   3.0G  4.0K  3.0G   1% /dev
tmpfs                                  1.2G  224K  1.2G   1% /run
none                                   5.0M     0  5.0M   0% /run/lock
none                                   3.0G     0  3.0G   0% /run/shm
/dev/mapper/VG-LV_var                  7.3G  4.5G  2.5G  65% /var 
```

我将 BAM 放入具有 7.3GB 空间的 var 中。如您所见，我有足够的空间来运行 WSO2 产品，但 BAM :-D

运行 BAm 3 天后，我面临空间问题：

在 tmp 我有 1GB 的 hadoop

```
root@serv:/# du -sh /tmp/*
1023M   /tmp/hadoop
4.0K    /tmp/hadoop-root
4.0K    /tmp/hsperfdata_root
4.0K    /tmp/mc-root
117M    /tmp/root 
```

在 BAM 内部，它在 tmp 中使用了 2.9GB。

```
root@serv:/# du -sh /var/BAM/wso2bam-2.0.1/*
160K    /var/BAM/wso2bam-2.0.1/bin
236K    /var/BAM/wso2bam-2.0.1/dbscripts
8.0K    /var/BAM/wso2bam-2.0.1/INSTALL.txt
5.0M    /var/BAM/wso2bam-2.0.1/lib
52K     /var/BAM/wso2bam-2.0.1/LICENSE.txt
12K     /var/BAM/wso2bam-2.0.1/README.txt
8.0K    /var/BAM/wso2bam-2.0.1/release-notes.html
540M    /var/BAM/wso2bam-2.0.1/repository
80K     /var/BAM/wso2bam-2.0.1/resources
14M     /var/BAM/wso2bam-2.0.1/samples
2.9G    /var/BAM/wso2bam-2.0.1/tmp
88K     /var/BAM/wso2bam-2.0.1/webapp-mode
4.0K    /var/BAM/wso2bam-2.0.1/wso2carbon.pid 
```

我的问题与以下事实有关，即我仍然有磁盘空间，并且在短短 3 天内 BAM 使用了 4GB，所以：长时间部署的最佳 HDD 大小是多少，或者我可以做些什么来避免这个错误（在生产环境中我可以使用更多的磁盘空间，但这是我的客户关心的问题）：注意到在这 3 天里，我只监控 2 台服务器，AS 和 ESB，负载最小。

```
TID: [0] [BAM] [2012-11-06 12:00:00,026]  INFO {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Running script executor task for script esb_stats_0\. [Tue Nov 06 12:00:00 CST 2012] {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
TID: [0] [BAM] [2012-11-06 12:00:00,026]  INFO {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Running script executor task for script service_stats_848\. [Tue Nov 06 12:00:00 CST 2012] {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
TID: [0] [BAM] [2012-11-06 12:00:01,213] ERROR {org.apache.hadoop.hive.ql.exec.ExecDriver} -  Exception: /var/BAM/wso2bam-2.0.1/tmp/root/hive_2012-11-06_12-00-00_487_706674934402805629/-local-10000/plan.xml (No space left on device) {org.apache.hadoop.hive.ql.exec.ExecDriver}
TID: [0] [BAM] [2012-11-06 12:00:01,213] ERROR {org.apache.hadoop.hive.ql.exec.ExecDriver} -  Exception: /var/BAM/wso2bam-2.0.1/tmp/root/hive_2012-11-06_12-00-00_487_706674934402805629/-local-10000/plan.xml (No space left on device) {org.apache.hadoop.hive.ql.exec.ExecDriver}
TID: [0] [BAM] [2012-11-06 12:00:01,216] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-11-06 12:00:01,216] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-11-06 12:00:01,219] ERROR {org.apache.hadoop.hive.ql.exec.ExecDriver} -  Exception: /var/BAM/wso2bam-2.0.1/tmp/root/hive_2012-11-06_12-00-00_500_8714455975079609718/-local-10000/plan.xml (No space left on device) {org.apache.hadoop.hive.ql.exec.ExecDriver}
TID: [0] [BAM] [2012-11-06 12:00:01,219] ERROR {org.apache.hadoop.hive.ql.exec.ExecDriver} -  Exception: /var/BAM/wso2bam-2.0.1/tmp/root/hive_2012-11-06_12-00-00_500_8714455975079609718/-local-10000/plan.xml (No space left on device) {org.apache.hadoop.hive.ql.exec.ExecDriver}
TID: [0] [BAM] [2012-11-06 12:00:01,221] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-11-06 12:00:01,221] ERROR {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl} -  Error while executing Hive script.
Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl}
java.sql.SQLException: Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask
    at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:189)
    at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
    at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-11-06 12:00:01,221] ERROR {org.apache.hadoop.hive.ql.Driver} -  FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask {org.apache.hadoop.hive.ql.Driver}
TID: [0] [BAM] [2012-11-06 12:00:01,223] ERROR {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl} -  Error while executing Hive script.
Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask {org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl}
java.sql.SQLException: Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask
    at org.apache.hadoop.hive.jdbc.HiveStatement.executeQuery(HiveStatement.java:189)
    at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:325)
    at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl$ScriptCallable.call(HiveExecutorServiceImpl.java:225)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-11-06 12:00:01,231] ERROR {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Error while executing script : esb_stats_0 {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
org.wso2.carbon.analytics.hive.exception.HiveExecutionException: Error while executing Hive script.Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask
    at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl.execute(HiveExecutorServiceImpl.java:110)
    at org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask.execute(HiveScriptExecutorTask.java:60)
    at org.wso2.carbon.ntask.core.impl.TaskQuartzJobAdapter.execute(TaskQuartzJobAdapter.java:56)
    at org.quartz.core.JobRunShell.run(JobRunShell.java:213)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-11-06 12:00:01,232] ERROR {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask} -  Error while executing script : service_stats_848 {org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask}
org.wso2.carbon.analytics.hive.exception.HiveExecutionException: Error while executing Hive script.Query returned non-zero code: 9, cause: FAILED: Execution Error, return code 1 from org.apache.hadoop.hive.ql.exec.MapRedTask
    at org.wso2.carbon.analytics.hive.impl.HiveExecutorServiceImpl.execute(HiveExecutorServiceImpl.java:110)
    at org.wso2.carbon.analytics.hive.task.HiveScriptExecutorTask.execute(HiveScriptExecutorTask.java:60)
    at org.wso2.carbon.ntask.core.impl.TaskQuartzJobAdapter.execute(TaskQuartzJobAdapter.java:56)
    at org.quartz.core.JobRunShell.run(JobRunShell.java:213)
    at java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)
    at java.util.concurrent.FutureTask$Sync.innerRun(Unknown Source)
    at java.util.concurrent.FutureTask.run(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source)
TID: [0] [BAM] [2012-11-06 12:00:01,743]  INFO {org.wso2.carbon.core.services.util.CarbonAuthenticationUtil} -  'admin@carbon.super [-1234]' logged in at [2012-11-06 12:00:01,742-0500] {org.wso2.carbon.core.services.util.CarbonAuthenticationUtil}
TID: [0] [BAM] [2012-11-06 12:00:01,750]  INFO {org.wso2.carbon.dashboard.gadgetrepopopulator.GadgetRepoPopulator} -  Couldn't find a Dashboard at '/var/BAM/wso2bam-2.0.1/repository/resources/gadget-repo/gadget-repo.xml'. Giving up. {org.wso2.carbon.dashboard.gadgetrepopopulator.GadgetRepoPopulator}
TID: [0] [BAM] [2012-11-06 12:00:04,213] ERROR {org.apache.tiles.jsp.context.JspTilesRequestContext} -  JSPException while including path '/hive-explorer/listscripts.jsp'.  {org.apache.tiles.jsp.context.JspTilesRequestContext}
javax.servlet.jsp.JspException: ServletException while including page.
    at org.apache.tiles.jsp.context.JspUtil.doInclude(JspUtil.java:102)
    at org.apache.tiles.jsp.context.JspTilesRequestContext.include(JspTilesRequestContext.java:88)
    at org.apache.tiles.jsp.context.JspTilesRequestContext.dispatch(JspTilesRequestContext.java:82)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:465)
    at org.apache.tiles.jsp.taglib.InsertAttributeTag.render(InsertAttributeTag.java:140)
    at org.apache.tiles.jsp.taglib.InsertAttributeTag.render(InsertAttributeTag.java:117)
    at org.apache.tiles.jsp.taglib.RenderTagSupport.execute(RenderTagSupport.java:171)
    at org.apache.tiles.jsp.taglib.RoleSecurityTagSupport.doEndTag(RoleSecurityTagSupport.java:75)
    at org.apache.tiles.jsp.taglib.ContainerTagSupport.doEndTag(ContainerTagSupport.java:80)
    at org.apache.jsp.admin.layout.template_jsp._jspx_meth_tiles_insertAttribute_7(template_jsp.java:539)
    at org.apache.jsp.admin.layout.template_jsp._jspService(template_jsp.java:290)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:97)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:332)
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:314)
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:264)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.wso2.carbon.ui.JspServlet.service(JspServlet.java:161)
    at org.wso2.carbon.ui.TilesJspServlet.service(TilesJspServlet.java:80)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.eclipse.equinox.http.helper.ContextPathServletAdaptor.service(ContextPathServletAdaptor.java:36)
    at org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:90)
    at org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:111)
    at org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:67)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.wso2.carbon.tomcat.ext.servlet.DelegationServlet.service(DelegationServlet.java:68)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:690)
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:477)
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:402)
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:329)
    at org.eclipse.equinox.http.servlet.internal.RequestDispatcherAdaptor.forward(RequestDispatcherAdaptor.java:30)
    at org.eclipse.equinox.http.helper.ContextPathServletAdaptor$RequestDispatcherAdaptor.forward(ContextPathServletAdaptor.java:258)
    at org.apache.tiles.servlet.context.ServletTilesRequestContext.forward(ServletTilesRequestContext.java:198)
    at org.apache.tiles.servlet.context.ServletTilesRequestContext.dispatch(ServletTilesRequestContext.java:185)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:419)
    at org.apache.tiles.impl.BasicTilesContainer.render(BasicTilesContainer.java:370)
    at org.wso2.carbon.ui.action.ActionHelper.render(ActionHelper.java:52)
    at org.wso2.carbon.ui.TilesJspServlet.service(TilesJspServlet.java:101)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.eclipse.equinox.http.helper.ContextPathServletAdaptor.service(ContextPathServletAdaptor.java:36)
    at org.eclipse.equinox.http.servlet.internal.ServletRegistration.handleRequest(ServletRegistration.java:90)
    at org.eclipse.equinox.http.servlet.internal.ProxyServlet.processAlias(ProxyServlet.java:111)
    at org.eclipse.equinox.http.servlet.internal.ProxyServlet.service(ProxyServlet.java:67)
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    at org.wso2.carbon.tomcat.ext.servlet.DelegationServlet.service(DelegationServlet.java:68)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.wso2.carbon.tomcat.ext.filter.CharacterSetFilter.doFilter(CharacterSetFilter.java:61)
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
    at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:225)
    at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
    at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:98)
    at org.wso2.carbon.tomcat.ext.valves.CompositeValve.invoke(CompositeValve.java:172)
    at org.wso2.carbon.tomcat.ext.valves.CarbonStuckThreadDetectionValve.invoke(CarbonStuckThreadDetectionValve.java:156)
    at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:927)
    at org.wso2.carbon.tomcat.ext.valves.CarbonContextCreatorValve.invoke(CarbonContextCreatorValve.java:52)
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
    at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1001)
    at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:579)
    at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.run(NioEndpoint.java:1653)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
    at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T06:29:37.270

您可以清理这些 tmp 文件，这些文件是在 Hadoop map reduce 作业执行期间以及特定作业完成后生成的。删除这些文件是安全的。因此，如果在过去 24 小时内未触摸或访问文件，则删除临时文件应该是安全的。您可以使用 cron 作业来执行此操作。见[1]。

[1] [http://mail-archives.apache.org/mod_mbox/hadoop-general/201011.mbox/%3CABC24175AFD3BE4DA15F4CD375ED413D0639E23F45@hq-ex-mb02.ad.navteq.com%3E](http://mail-archives.apache.org/mod_mbox/hadoop-general/201011.mbox/%3CABC24175AFD3BE4DA15F4CD375ED413D0639E23F45@hq-ex-mb02.ad.navteq.com%3E)

谢谢，卡松。

# java - 将图像添加到 java awt Canvas 背景

> ID：13256343
> 
> 赞同：0
> 
> 时间：2012-11-06T17:36:59.050
> 
> 标签：java, image, awt, java-canvas

我正在尝试向 java awt canvas 添加背景图像，但仍然无法通过。任何机构都可以解决这个问题或解决这个问题的任何代码。代码如下，

谢谢。

```
import java.awt.*;
import java.applet.*;
import java.util.Vector;
import java.util.Enumeration;

public class DiagramEditor extends Canvas {

private Vector diagrams = new Vector(16);
Diagram currentDiagram;
DiagramEditorControls controls;
Tool tool;
Image offscreen;
public final static int RECTANGLE = 0;

public final static int SELECTION = 3;
public String toolNames[] = {"Rectangle", "", "", "Selection"};

public DiagramEditor() {
    setBackground(Color.white);
    newDiagram();
}

public void setControls(DiagramEditorControls c) {
    controls = c;
}

public void setTool(int t) {
    switch (t) {
        case RECTANGLE:
            tool = new WrectangleTool(currentDiagram);
            break;

        case SELECTION:
            tool = new SelectionTool(currentDiagram);
            break;
    }
    repaint();
    if (controls != null) {
        controls.toolChoice.select(t);
    }
}

public void paint(Graphics g) {
    update(g);
}

public void update(Graphics g) {
    Dimension canvasSize = size();
    if (offscreen == null) {
        offscreen = this.createImage(canvasSize.width, canvasSize.height);
    }
    Graphics og = offscreen.getGraphics();
    og.setColor(getBackground());
    og.fillRect(0, 0, canvasSize.width, canvasSize.height);
    og.setColor(Color.black);
    og.drawRect(0, 0, canvasSize.width - 1, canvasSize.height - 1);
    og.setColor(Color.blue);
    currentDiagram.draw(og);
    tool.draw(og);
    g.drawImage(offscreen, 0, 0, this);
}

public void deleteElements() {
    tool.delete();
    repaint();
}

public void nextDiagram() {
    if (currentDiagram == diagrams.lastElement()) {
        currentDiagram = (Diagram) diagrams.firstElement();
    } else {
        int diagramIndex = diagrams.indexOf(currentDiagram);
        currentDiagram = (Diagram) diagrams.elementAt(diagramIndex + 1);
    }
    setTool(RECTANGLE);
}

public void newDiagram() {
    currentDiagram = new Diagram();
    diagrams.addElement(currentDiagram);
    setTool(RECTANGLE);
}

public boolean mouseDown(Event e, int x, int y) {
    tool.press();
    repaint();
    return true;
}

public boolean mouseDrag(Event e, int x, int y) {
    tool.move(new Point(x, y));
    repaint();
    return true;
}

public boolean mouseMove(Event e, int x, int y) {
    tool.move(new Point(x, y));
    repaint();
    return true;
}

public boolean mouseUp(Event e, int x, int y) {
    tool.release();
    repaint();
    return true;
}
} 
```

这是一个绘图画布。默认背景颜色为白色..我希望将其更改为图像...？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:05:59.030

下面的行：

```
offscreen = this.createImage(canvasSize.width, canvasSize.height); 
```

应该变成这样：

```
try {
  offscreen = ImageIO.read(new File("path/to/image"));
} catch (IOException e) {
  e.printStackTrace();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:49:56.867

你能不能只在画布上添加一个 JLabel，然后以这种方式添加背景图像？你用的是java编译器吗？

# php - 格式化单元格内的文本

> ID：13256346
> 
> 赞同：0
> 
> 时间：2012-11-06T17:37:14.183
> 
> 标签：php, fpdf

我被指示编写一个将合同文档输出为 PDF 的脚本。我被指定使用的合同模板包含带有粗体、斜体和下划线的文本块，这些文本块散布在其他基本的新罗马时代字符串中。目前，我有 HTML 和 MS Doc 格式的合同模板。

我的第一个想法是使用 FPDF 库，但 FPDF 似乎一次只能以一种文本格式绘制单元格。有一个更好的方法吗？

我找到了 FPDF Multicell Advanced 库，但我想找到一个在我跑向雇主要钱之前不花钱的解决方案。 [http://interpid.eu/fpdf-multicell](http://interpid.eu/fpdf-multicell)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:42:53.640

我在 Zend PDF（Zend 框架的一部分）方面取得了非常好的成功

API文档在这里： http: [//framework.zend.com/manual/1.12/en/zend.pdf.html](http://framework.zend.com/manual/1.12/en/zend.pdf.html)

教程在这里： [http ://devzone.zend.com/1064/zend_pdf-tutorial/](http://devzone.zend.com/1064/zend_pdf-tutorial/)

您可以在生成 PDF 时通过创建帮助程序类来重复多单元格功能。

# facebook - Facebook API - all.js

> ID：13256348
> 
> 赞同：0
> 
> 时间：2012-11-06T17:37:23.567
> 
> 标签：facebook

我正在尝试在我的网页上使用 Facebook API 来获得喜欢。当前尝试使用`all.js`，它无法在下面的 url 加载文件，因为它会将其转换为`file://connect.`

```
//connect.facebook.net/en_US/all.js#xfbml=1 
```

显式更改 url 以`http:`给出不同的错误。

我们是否需要 APPID 来初始化此 API 并使用`all.js`，还是可以在没有 APPID 的情况下使用它？

参考网址：http: [//developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:44:02.077

根据这个[答案](https://stackoverflow.com/questions/5574443/do-i-need-an-appid-for-a-xfbml-version-of-the-facebook-like-button)，AppId 是必需的。您列出的参考 URL 中的工具会将您的 AppId 插入它生成的代码中。

```
(function(d, s, id) {
    ...
    js.src = "//connect.facebook.net/en_US/all.js#xfbml=1&appId=xxxxxxxx";
    ...
}(document, 'script', 'facebook-jssdk')); 
```

您可能会收到`file://connect`错误消息，因为您正在通过在 Web 浏览器中打开本地文件而不是由真实 Web 服务器提供的文件进行测试。当您没有在链接中指定协议时，浏览器将假定它与当前页面的协议相同。

来自 Facebook 文档：

> 注意：代码中的 URL 是协议相关的。这允许浏览器通过与包含页面相同的协议（HTTP 或 HTTPS）加载 SDK，这将防止“不安全内容”警告。代码中缺少 http 和 https 是故意的。

# java - ColumnText 中的列表丢失直接添加到文档时存在的数据

> ID：13256350
> 
> 赞同：0
> 
> 时间：2012-11-06T17:37:31.133
> 
> 标签：java, itext

我正在使用 iText 5.1.3。ColumnText 中的列表不完整，如添加到文档时成功实现的完整列表所示。如果我取消注释该行：

```
// list2.add(new ListItem(new Chunk("Level 2 - Item 3"))); 
```

它们看起来都是一样的；但是，我想要的列表格式是完全删除了该行。

```
public class TestList
{

    public static void main(String[] args) throws IOException, DocumentException
    {
        Document document = new Document();
        PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream("testlist.pdf"));
        document.open();
        List list1 = new List(List.ALPHABETICAL, 20);
        list1.add(new ListItem(new Chunk("Level 1 - Item 1")));
        list1.add(new ListItem(new Chunk("Level 1 - Item 2")));
        list1.add(new ListItem(new Chunk("Level 1 - Item 3")));

        List list2 = new List(List.ORDERED, 20);
        list2.add(new ListItem(new Chunk("Level 2 - Item 1")));
        list2.add(new ListItem(new Chunk("Level 2 - Item 2")));

        List list3 = new List(List.ORDERED, 20);
        list3.add(new ListItem(new Chunk("Level 3 - Item 1")));
        list3.add(new ListItem(new Chunk("Level 3 - Item 2")));
        list3.add(new ListItem(new Chunk("Level 3 - Item 3")));
        list3.add(new ListItem(new Chunk("Level 3 - Item 4")));
        list2.add(list3);

        // list2.add(new ListItem(new Chunk("Level 2 - Item 3")));
        list1.add(list2);

        list1.add(new ListItem(new Chunk("Level 1 - Item 4")));
        document.add(list1);
        document.newPage();

        ColumnText cols = new ColumnText(writer.getDirectContent());
        cols.setSimpleColumn(36, 36, 549, 806);
        cols.addElement(list1);
        cols.go();

        document.close();
    }
} 
```

我怎样才能在 ColumnText 中获得这种期望的行为。我已经尝试了我能想到的一切，但我很茫然。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T19:03:25.680

我不知道它为什么起作用，但我只是在玩，如果你将注释掉的行更改为 list2.add(""); 它按预期工作。不过，对我来说似乎更像是一个黑客。最终代码如下所示：

```
public class TestList
{

    public static void main(String[] args) throws IOException, DocumentException
    {
        Document document = new Document();
        PdfWriter writer = PdfWriter.getInstance(document, new FileOutputStream("testlist.pdf"));
        document.open();
        List list1 = new List(List.ALPHABETICAL, 20);
        list1.add(new ListItem(new Chunk("Level 1 - Item 1")));
        list1.add(new ListItem(new Chunk("Level 1 - Item 2")));
        list1.add(new ListItem(new Chunk("Level 1 - Item 3")));

        List list2 = new List(List.ORDERED, 20);
        list2.add(new ListItem(new Chunk("Level 2 - Item 1")));
        list2.add(new ListItem(new Chunk("Level 2 - Item 2")));

        List list3 = new List(List.ORDERED, 20);
        list3.add(new ListItem(new Chunk("Level 3 - Item 1")));
        list3.add(new ListItem(new Chunk("Level 3 - Item 2")));
        list3.add(new ListItem(new Chunk("Level 3 - Item 3")));
        list3.add(new ListItem(new Chunk("Level 3 - Item 4")));
        list2.add(list3);

        list2.add(""); // Changed line.
        list1.add(list2);

        list1.add(new ListItem(new Chunk("Level 1 - Item 4")));
        document.add(list1);
        document.newPage();

        ColumnText cols = new ColumnText(writer.getDirectContent());
        cols.setSimpleColumn(36, 36, 549, 806);
        cols.addElement(list1);
        cols.go();

        document.close();
    }
} 
```

必须与关闭第 2 级列表有关。我到处都看到过这个问题，但从未回答过，所以我希望有人觉得这很有帮助。

# jquery - 如何使 jQuery UI 按钮集流畅？

> ID：13256351
> 
> 赞同：0
> 
> 时间：2012-11-06T17:37:39.263
> 
> 标签：jquery, html, css, jquery-ui

我有一个非常简单的网络应用程序 (http://www.tntech.edu/cafe-menu.php)，它被 iframe 化为 ATT 构建的移动应用程序。不同手机上的按钮大小不同，我需要弄清楚如何使它们变得流畅。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:03:27.397

我需要将 label.ui-button 上的宽度设置为百分比，然后它就起作用了。多谢你们！

# c - 在 C 中返回两个不同的值（结构、列表）

> ID：13256352
> 
> 赞同：0
> 
> 时间：2012-11-06T17:37:40.667
> 
> 标签：c

> **可能重复：**
> [从函数返回多个值](https://stackoverflow.com/questions/3829167/returning-multiple-values-from-a-function)

我正在尝试在 C 中创建一个双向链表。我有一个 main 函数，它调用另一个函数来创建节点并构建列表。我需要最后一个函数将两个不同的指针（一个指向列表的开头，一个指向列表的结尾）返回给 main。有没有办法使用“ **return** ”返回两个东西？在这种情况下，两个指针。我想返回一个包含两个元素的结构，两个指针。但是有简单的方法吗？

*这就是我主要调用函数（insertacomienzo）的方式：*

```
primero = insertacomienzo (primero, ultimo, tamaniomax); 
```

*（primero 是一个指针）并且函数返回这个指针现在已修改。*

```
return primero; 
```

**我现在需要的是返回两个指针，一个指向列表的开头，另一个指向列表的结尾。**

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:07:25.950

使用 InOut 参数返回任何额外的参数（这通常是在 C 中完成的）。InOut 参数是 '* *' 类型，而不仅仅是 '* ' （在 CPP 中它们是 '&*' 类型，但 C 中没有 '&'）

这是一个 inout 函数的原型

```
node* GenerateList(node* currentListItem,node** InOutLastListItem,int currentNodes) 
```

# c# - 如何在 MVC 中实现多个下拉列表

> ID：13256355
> 
> 赞同：3
> 
> 时间：2012-11-06T17:38:03.300
> 
> 标签：c#, javascript, jquery, asp.net-mvc-3

假设我想使用@Html.DropDownList 在视图中显示多个下拉框，每个下拉框都具有相同的值。有没有一种简单的方法可以渲染所有这些下拉框，而不必将 ViewBag 之类的东西绑定到每个返回的月份？

例如：

控制器

```
List<SelectListItem> items = new List<SelectListItem>();

var values = (from v in db.Values select v);

foreach (var value in values)
{
    items.Add(new SelectListItem { Text = value.Name, Value = value.Id });
}

ViewBag.Values = PopulateSelectList("Values"); 
```

看法

```
@Html.DropDownList("Values") 
```

但目标是拥有类似的东西

```
<div class="control-group">
    @Html.LabelFor(model => model.DesignStyle)
    <div class="controls">
        @Html.DropDownList("Values")    @Html.DropDownList("Values")
        @Html.DropDownList("Values")    @Html.DropDownList("Values")
        @Html.DropDownList("Values")    @Html.DropDownList("Values")
        @Html.DropDownList("Values")    @Html.DropDownList("Values")
        @Html.DropDownList("Values")    @Html.DropDownList("Values")
    </div>
</div> 
```

我的猜测是我需要某种方式`@foreach (item in Model)`来填充视图上的每个 DropDowns

这是我最初关于如何进行的想法的示例。

```
List<SelectListItem> results = new List<SelectListItem>();
SelectListItem item = null;

var values = (from v in db.Values select v);

for (int i = 0; i <= 15; i++)
{
     item = new SelectListItem();

     item.Text = "Select a value";
     item.Value = "1";

     results.Add(item);

     foreach (var thread in threads)
     {
         item.Text = thread.Name;
         item.Value = thread.Id;

         results.Add(item);
     }
 } 
```

我不想做的是重复逻辑以多次填充 SelectListItem 并将每个逻辑放在一个单独的 ViewBag 项目中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T17:43:00.277

您可以重复使用选择列表 - 只需使用 or 的正确[`DropDownList`](http://msdn.microsoft.com/en-us/library/dd492738%28v=vs.108%29.aspx)覆盖[`DropDownListFor`](http://msdn.microsoft.com/en-us/library/ee703462%28v=vs.108%29.aspx)。您应该（通常）做的是给下拉列表提供不同的名称。例如：

```
 @Html.DropDownListFor( m => m.PickedValue1, ViewBag.Values)
 @Html.DropDownListFor( m => m.PickedValue2, ViewBag.Values) 
```

或者，如果您更喜欢非强类型`DropDownList`：

```
 @Html.DropDownList( "PickedValue1", ViewBag.Values)
 @Html.DropDownList( "PickedValue2", ViewBag.Values) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T20:13:22.023

我最终使用 EditorTemplate 功能来解决/渲染这个问题。

模型从此改变：

```
public class ValueModel
{
    public Guid Id { get; set; }
    public string Name { get; set; }
} 
```

对此：

```
public class ValueModel
{
    public Guid Id { get; set; }
    public string Name { get; set; }

    public List<ValueDropDownModel> DropDown { get; set; }
}

public class ValueDropDownModel
{
    [Range(0, 15)]
    public int DropDown { get; set; }

    public int Id { get; set; }
    public string Name { get; set; }

    public List<SelectListItem> AvailableDropDown { get; set; }
} 
```

在`Views`的文件夹下`Value`，现在有一个名为 的子文件夹`EditorTemplates`。这包含 2 个视图。一个`ValueModel.cshtml`和一个`ValueDropDownModel.cshtml`。

`ValueModel.cshtml`包含：

```
@model SomeSolution.Web.Models.ValueModel

<div class="row-fluid">

    <div class="span6">
        <div class="control-group">
            @Html.LabelFor(m => m.Name)
            <div class="controls">
                @Html.EditorFor(m => m.Name)
                @Html.ValidationMessageFor(m => m.Name)
            </div>
        </div>

    </div>
</div>

<div class="row-fluid">
    <div class="span4">
        @for (int i = 0; i < 5; ++i)
        {
            @Html.EditorFor(m => m.DropDown[i])
        }
    </div>

    <div class="span4">
        @for (int i = 5; i < 10; ++i)
        {
            @Html.EditorFor(m => m.DropDown[i])
        }
    </div>

    <div class="span4">
        @for (int i = 10; i < 15; ++i)
        {
            @Html.EditorFor(m => m.DropDown[i])
        }
    </div>
</div> 
```

`ValueDropDownModel.cshtml`包含：

```
@model SomeSolution.Web.Models.ValueDropDownModel

<div class="control-group">
    @Html.HiddenFor(m => m.DropDown)
    @String.Format("DropDown {0}", Model.DropDown)
    <div class="controls">
        @Html.DropDownListFor(m => m.Id, Model.AvailableDropDown)
        @Html.ValidationMessageFor(m => m.Id)
    </div>
</div> 
```

现在`ValueController`包括一些辅助方法来填充下拉列表

```
 private void FillAvailableValues(ValueModel modelValue, Entities db)
    {
        var values = (from v in db.Values
                       orderby v.Name
                       select v);

        foreach (var model in modelValue.Values)
        {
            model.AvailableDropDown = new List<SelectListItem>();
            model.AvailableDropDown.Add(new SelectListItem()
            {
                Text = "Unassigned",
                Value = "0",
                Selected = (model.Id == 0)
            });

            foreach (var value in values)
            {
                model.AvailableDropDown.Add(new SelectListItem()
                {
                    Text = value.Name,
                    Value = value.Id,
                    Selected = (model.Id.ToString() == colour.Id)
                });
            }
        }
    }

    private void InitDefaultDropDown(ValueModel model)
    {
        model.DropDown = new List<ValueDropDownModel>();
        for (int i = 0; i < 15; i++)
        {
            model.DropDown.Add(new ValueDropDownModel()
            {
                DropDown = i + 1,
                Id = 0
            });
        }
    } 
```

该`FillAvailableValues`方法被调用`Create` `ActionResult`以及`Edit` `ActionResult`初始化下拉菜单。`InitDefaultDropDown`在页面上调用该方法`Create` `ActionResult`以设置下拉菜单。

# installshield-le - Installshield LE 与 ASP.NET MVC

> ID：13256357
> 
> 赞同：0
> 
> 时间：2012-11-06T17:38:07.797
> 
> 标签：installshield-le

我正在尝试使用带有 VS.NET 2012 的 installshield LE 构建 ASP.NET MVC 安装。我选择了 SingleImage 的解决方案配置管理器并尝试构建项目。我有一个 UAT web.config 转换到位。安装后安装文件夹中的 web.config 为空。如何在打包时强制安装选择正确的 web.config 文件。非常感谢任何帮助。

-乔治

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-16T14:14:23.147

在您的 Msbuild 命令中，您想要

目标=包和配置=“发布”

这样，它将使用您指定的配置转换..

此外，您还需要通过安装屏蔽中的动态链接添加配置文件。

# java - 试图画一个六边形

> ID：13256359
> 
> 赞同：-2
> 
> 时间：2012-11-06T17:38:16.637
> 
> 标签：java, graphics, polygon, polygons

我正在尝试在我为班级制作的小行星克隆上绘制六边形小行星。

```
 sprite = new Polygon();
    sprite.addPoint(0,0);
    sprite.addPoint(0,-40);
    sprite.addPoint(30,-40);
    sprite.addPoint(60,-10);
    sprite.addPoint(60,20);
    sprite.addPoint(40,50);
    sprite.addPoint(-20,50);
    sprite.addPoint(-50,20);
    sprite.addPoint(50,-10);
    sprite.addPoint(20,-40); 
```

然而，当我这样做时，我最终得到了这个 ![：](../Images/6335bbe727cba8323f1f7c74eb3a800e.png)

那么出了什么问题呢？我在坐标平面上画了出来，然后复制了这些点。我的理解是 Java 会按照我列出点的顺序绘制它，并且我在其中有 (0,0) 是为了旋转小行星以进行游戏。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-14T07:18:55.560

Zane is close, he forgot to include i in his formula:

```
for(i=0; i<6; i++) {
    sprite.addpoint(x + r*cos(i*2*pi/6), y + r*sin(i*2*pi/6))
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-11-06T17:44:22.177

首先，如果它应该是一个六边形，那么它应该有 6 个点，而不是 10 个点。其次，只需根据您的坐标在纸上绘制这个，就可以得到一个与您图片中的多边形非常相似的多边形。所以我猜你的坐标是错误的。再次检查它们。

如果你想画一个对称的六边形，那么你只需要它的中心，比如 (x,y) 和它的半径 r。那么六边形的点是

```
for(i=0; i<6; i++) {
   sprite.addpoint(x + r*cos(i*2*pi/6), y + r*sin(i*2*pi/6))
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-06T17:45:48.743

不是真的六边形，最后两点看起来很奇怪

```
sprite.addPoint(50,-10);
sprite.addPoint(20,-40); 
```

认为最后两个应该是：

```
sprite.addPoint(-50,-10);
sprite.addPoint(-20,-40); 
```

但即便如此，它看起来还是一个不平衡的吃豆人——我想回到绘图板上。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T17:47:18.293

我会检查你的坐标。最后几个过渡在我看来并不正确，尤其是 (-50, 20) 到 (50, -10)。它在 x 方向上有 100 个单位的跳跃，比任何其他坐标变化都大。(-50, -10) 似乎更合理。

# jdbc - 如果设置为“元数据”，Glassfish DB 连接验证不起作用

> ID：13256362
> 
> 赞同：0
> 
> 时间：2012-11-06T17:38:42.870
> 
> 标签：jdbc, glassfish

如果 glassfish 服务器失去与数据库的连接，则连接都会消失。我想检测它并恢复连接。

当我将它设置为使用“表”时，这可以工作，但是当我将其设置为“元数据”时，这似乎不起作用。有人知道为什么或者这是一个已知的玻璃鱼虫吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T19:18:49.663

可能不是 GlassFish 中的错误，而是缓存元数据的 JDBC 驱动程序。[GlassFish 文档](http://docs.oracle.com/cd/E18930_01/html/821-2431/abehp.html)中也提到了这一点：

> *table*：对指定的表执行查询。如果选择此选项，则还必须设置表名。如果 JDBC 驱动程序缓存对 setAutoCommit() 和 getMetaData() 的调用，则可能需要选择此选项。

# jquery - 按名称选择 div 中的输入

> ID：13256372
> 
> 赞同：5
> 
> 时间：2012-11-06T17:39:32.823
> 
> 标签：jquery, jquery-selectors, css-selectors

我需要使用来自第二个（动态生成的）div 的值来更新表单的某些输入字段的值。

这是代码

```
$("#second_update_form_data :input").each(function(index) {

//find all input fields in the second div
                var FieldName = $(this).attr("name");
                var FieldValue = $(this).val();

  //try to get the corresponding field from the original form to change it
                var Selector = "#TT_CartForm__form input[name=" + FieldName + "]";
                var OriginalFiled = $(Selector); 
```

这不起作用，但我不知道为什么。我可以在原始输入字段中添加一个 id 并使用它来选择它们，但我更愿意了解问题所在并使用正确的选择器。

在此先感谢，亲切的问候

编辑：对不起，我意识到我没有指定哪个部分不起作用。这是最后一行，当我尝试使用 Selector 进行选择时，所以最后一行似乎是错误的

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T17:44:36.580

> 根据您的更新更新

```
var OriginalFiled = $('#TT_CartForm__form input[name="' + FieldName + '"]'); 
```

尝试更改您的报价以确保可以读取字符串。还有一点要记住，IE7 和 IE8 仅在指定了 !DOCTYPE 时才支持属性选择器。在 IE6 中，它们根本不工作

还要仔细检查您的元素 ID 名称，我注意到它有两个下划线区域，一个区域有 2 个下划线。确保保存您输入的 div 具有完全相同的 id 值

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T17:51:20.480

稍快的选择器：

```
$('#second_update_form_data').find('input').each(function(index) {

    //find all input fields in the second div
    var fieldName     = $(this).attr('name'),
        fieldValue    = $(this).val(),

    //try to get the corresponding field from the original form to change it
        selector      = 'TT_CartForm__form input[name=' + fieldName + ']',
        originalFiled = $(selector); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:44:10.877

改变：

```
$("#second_update_form_data :input") 
```

到

```
$("#second_update_form_data input") 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:51:07.960

您的问题是动态生成的 div。您需要使用 .on()

[jQuery.on()](http://api.jquery.com/on/)

# java - 使用 Java char 数组处理 C char 数组

> ID：13256373
> 
> 赞同：4
> 
> 时间：2012-11-06T17:39:35.570
> 
> 标签：java, c, sockets

通过套接字，我将信息从用 C 编写的程序发送到用 Java 编写的程序。

通过 C 中的程序，我通过 char 数组（使用 Internet 套接字）发送两个字节，并且在 Java 中接收到的信息也存储在 char 数组中。

我的主要问题是Java数组中接收到的信息与从C程序传输的信息不正确对应。

我读过 Java 中的字符长 16 位，而 C 中的字符长 8 位。这可能是问题所在，但我不知道如何处理/解决这个问题。

发送信息的 C 代码如下：

```
char buffer[256];
bzero(buffer,256);
n = read(fd, buffer, 255);  // getting info from an uart port, which works properly
n = write(sockfd,buffer,3); // send the information through the socket 
```

部分 Java 代码（用于 Android 应用程序）如下：

```
char[] buffer = new char[256];
BufferedReader in = new BufferedReader(new InputStreamReader(socket.getInputStream()));
int readX = in.read(buffer, 0, 3);
if (readX > 0) { // I am using a handler to manipulate the info
    Message msg = new Message();
    msg.obj = buffer;
    mHandler.sendMessage(msg);
} 
....
// Part of the handler is the following:
mHandler = new Handler() {
    @Override
    public void handleMessage(Message msg) {
            char[] buffer;
            buffer = (char[])msg.obj; // the information here is different from the one sent from the C program
            ....
    }
} 
```

任何解决这个问题的建议我都会非常感激。

在此先感谢，格斯。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T18:02:24.177

在 C 和 C++ 中，`char`数据类型是 8 位字符，大致对应于 Java`byte`类型。在 Java 中，基本`char`类型是 16 位 Unicode 字符。当您在 Java 中从字节转换为字符（或反之亦然）时，必须进行映射，具体取决于字节流的字符编码（UTF-8、ISO-8859-1 等），因此您必须知道C字节流是如何编码的。在你的情况下，我猜它是 ISO-8859-1。如果它真的是二进制数据，那么你应该使用 Java`byte`类型。

编辑：

您必须知道从 C 发送的数据是字符还是二进制，如果是字符，C 程序如何对数据进行编码（ISO-8859-1、UTF-8 等）。

如果数据是二进制的，那么您必须使用`BufferedInputStream`来读取字节，而不是`BufferedReader`，它将字节解码为字符，这是您不想要的，因为数据是二进制的。

如果数据是字符，那么您可以使用 2-argument 构造函数

```
InputStreamReader(InputStream in, String charSetName) 
```

或其他 2-arg 构造函数之一，可让您指定如何将字节解码为字符。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:44:04.067

使用 Java`byte`类型，它是一个 8 位有符号整数。还要确保您`char`在 C 中的类型实际上是 8 位。[Boost StaticAssert](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_staticassert.html)工具可用于确保这一点。

# vb6 - 如何从资源文件中检索所有语言 VB6 的字符串

> ID：13256375
> 
> 赞同：2
> 
> 时间：2012-11-06T17:39:41.060
> 
> 标签：vb6

有没有办法检索资源文​​件中所有可用语言的字符串？我只是要求同时显示 2 种语言的标签。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T15:01:08.073

如果您想使用标准的 VB6 资源文件，您有两种方法。

第一种是通过资源文件中的范围来定义字符串的每个语言版本。所以说你有一个类来包装这样的字符串：

```
'In Class clsLocalizedStrings

Public Enum StringIds
   UserNameCaption = 1
   PasswordCaption
   OkayCaption
   CancelCaption
End Enum

Public Enum LocaleIds
   English = 1000
   French = 2000
   Spanish = 3000
End Enum

Private mLangId As LocaleIds

Public Property Get CurrentLanguge() As LocaleIds
   CurrentLanguge = mLangId 
End Property
Public Property Let CurrentLanguge(ByVal newVal As LocaleIds)
   mLangId = newVal 
End Property

Public Function GetLocalString(ByVal id As StringIds)
   Dim lResStrId As Long
   lResStrId = mLangId + id
   GetLocalString = LoadResString(lResStrId)
End Function 
```

然后，您可以随意设置 CurrentLanguge 并获取字符串值。

* * *

每种语言都有自己的资源文件的另一种方法是为每种语言创建一个 ActiveX dll 项目。这些项目中的每一个都将只公开一个与上述类似的类。理想情况下，您有一个默认语言用作基础，而另一个引用它来实现该类：

```
'In Class LocalizedStrings in Project DefaultResources (with its own English resource file)

Public Enum StringIds
   UserNameCaption = 1
   PasswordCaption
   OkayCaption
   CancelCaption
End Enum

Public Function GetLocalString(ByVal id As StringIds)
   GetLocalString = LoadResString(id)
End Function

'In Class FrenchStrings in Project FrenchResources (with its own French resource file)

Implements DefaultResources

Public Function DefaultResources_GetLocalString(ByVal id As DefaultResources.StringIds)
   DefaultResources_GetLocalString= LoadResString(id)
End Function 
```

然后在您的主应用程序中引用这些 dll 并使它们在类或模块中可用：

```
'In Class clsLocalization in main app project

Public Enum LocaleIds
   English = 1
   French = 2
   Spanish = 3
End Enum

Private mLangId As LocaleIds
Private mResources() as DefaultResources

Private Sub Class_Initialize()
   Redim mResources (1 to 3)
   Set mResources(1) = DefaultResources.LocalizedStrings 'assumes english is default, easy to change though
   Set mResources(2) = FrenchResources.FrechStrings
   Set mResources(3) = SpanishResources.SpanishStrings
End Sub

Public Property Get CurrentLanguge() As LocaleIds
   CurrentLanguge = mLangId 
End Property
Public Property Let CurrentLanguge(ByVal newVal As LocaleIds)
   mLangId = newVal 
End Property

Public Function GetLocalString(ByVal id As StringIds)
   GetLocalString = mResources(mLangId).GetLocalString(id)
End Function

Public Propert Get Langauge(ByVal langId As LocaleIds)
   Return mResources(langId)
End Property 
```

这在一个模块中：

```
Global Localization As clsLocalization 
```

然后你像这样使用它：

```
'show caption for current languge
MsgBox Localization.GetLocalString(StringIds.UserCaption)

'show caption for explicit languge
MsgBox Localization.Langauge(French).GetLocalString(StringIds.UserCaption)
MsgBox Localization.Langauge(Spanish).GetLocalString(StringIds.UserCaption) 
```

希望有帮助！

# sql - SQL查询：如何通过另一列区分列组的计数

> ID：13256383
> 
> 赞同：0
> 
> 时间：2012-11-06T17:40:05.723
> 
> 标签：sql, optimization, count

在我的表中，我需要知道每个`ID`人是否只有一个`ID_name`。我怎样才能写这样的查询？

我试过：

```
select ID, count(distinct ID_name) as count_name 
from table 
group by ID 
having count_name > 1 
```

但它需要永远运行。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:44:01.730

```
select  ID
from    YourTable
group by
        ID
having  count(distinct ID_name) > 1 
```

或者

```
select  *
from    YourTable yt1
where   exists
        (
        select  *
        from    YourTable yt2
        where   yt1.ID = yt2.ID
                and yt1.ID_Name <> yt2.ID_Name
        ) 
```

现在，大多数`ID`列都被定义为`primary key`并且是唯一的。因此，在常规数据库中，您希望两个查询都返回一个空集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:05:37.450

select tt.ID,max(tt.myRank) from (select ip.ID,ip.ID_name, ROW_Number() over (partition by ip.ID,ip.ID_nameorder by ip.ID) as myRank from YourTable ip) tt group by tt.ID

这为您提供了每个 ID 的 ID_Name 总数

如果您只想要那些关联多个名称的 ID，只需添加一个 where 子句，例如

select tt.ID,max(tt.myRank) from (select ip.ID,ip.ID_name, ROW_NUMBER() over (partition by ip.ID,ip.ID_nameorder by ip.ID) as myRank from YourTable ip) tt **where tt .myRank > 1** 组（按 tt.ID）

# ruby-on-rails - 使用 Capybara，如何判断当前使用的驱动程序是否支持 JavaScript？

> ID：13256391
> 
> 赞同：15
> 
> 时间：2012-11-06T17:40:37.243
> 
> 标签：ruby-on-rails, cucumber, capybara

在我的 Rails 应用程序中，我有一组黄瓜验收测试，用于测试我的应用程序的各个页面。使用 cucumber 标记特定测试（场景）`@javascript`会导致该场景使用 JavaScript 驱动程序而不是不支持 JavaScript 的更简单驱动程序运行。

有没有一种简单的方法可以让我的测试确定它们当前是使用支持 JavaScript 的驱动程序还是不支持 JavaScript 的驱动程序运行的？我想要这个，以便我可以使我的测试在启用 JavaScript 的情况下运行时的行为略有不同。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2012-11-09T17:50:13.810

如果有人感兴趣，我查看了[Capybara 的文档](http://rubydoc.info/gems/capybara/frames)并找到了另一种可能的解决方案：

```
if Capybara.current_driver == Capybara.javascript_driver
  # Supports JavaScript
else
  # Doesn't support JavaScript
end 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-03-04T23:41:00.667

这有点令人讨厌，但这就是我的目标。想我是从某个地方的要点那里得到的，很抱歉我失去了它的链接，但至少它很简单：

```
def javascript_test?
  [:selenium, :webkit, :chrome, :poltergeist].include?(Capybara.current_driver)
end 
```

如果您定义（或在 Gemfile 中要求）其他启用 js 的驱动程序，则必须将它们添加到此列表中。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-08T02:07:54.263

[从这个答案](https://stackoverflow.com/questions/8492800/is-it-possible-to-perform-different-actions-in-a-cucumber-step-based-on-the-tag)看来，最简单的方法是在`Before`挂钩中设置一个实例变量：

```
Before('@javascript') do
  @javascript = true
end 
```

然后，您可以通过检查该实例变量的值来测试场景是否在步骤定义中被标记：

```
When /^I go to the homepage$/ do
  if @javascript
    ...
  else
    ...
  end
end 
```

我已经对此进行了测试，它似乎有效。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2018-07-03T08:48:09.710

您也可以简单地探测该功能并挽救任何异常。这可能是最精确和兼容的方法：

```
def support_js?
  return @support_js unless @support.nil?
  @support_js = begin
    page.evaluate_script("1 + 1")
    true
  rescue Capybara::NotSupportedByDriverError => _err
    false
  end
end 
```

# linux - 对于单个 CDH (Hadoop) 集群安装，我应该使用哪个主机？

> ID：13256394
> 
> 赞同：5
> 
> 时间：2012-11-06T17:41:08.390
> 
> 标签：linux, hadoop, cloudera

我从一台 Windows 7 计算机开始，并设置了一个 Ubuntu Linux 虚拟机`which I run using VirtualBox`。`The Cloudera Manager Free Edition version 4`已被执行，我一直按照`localhost:7180`.

当提示要求我“为您的 CDH 集群安装指定主机”时，我现在卡住了。我可以单独在 linux 虚拟机中安装和运行所有 Hadoop 组件吗？

请帮助我指出我应该指定的主机的正确方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-10-28T09:45:30.713

是的，您可以单独在 linux 虚拟机中运行 cdh。您可以使用“独立”或“伪分布式”模式来完成。恕我直言，最有效的方法是使用“伪分布式”模式。

在这种情况下，有多个 java-virtual-machines (JVM) 正在运行，因此它们模拟为具有多个节点的集群（每个线程模拟为一个集群节点）。

Cloudera 记录了如何部署为“伪分布式”：

[https://www.cloudera.com/documentation/enterprise/5-6-x/topics/cdh_qs_cdh5_pseudo.html](https://www.cloudera.com/documentation/enterprise/5-6-x/topics/cdh_qs_cdh5_pseudo.html)

注意：部署 cdh 的 3 种方式：

1.  独立：单独使用一台机器，具有唯一的jvm
2.  伪分布式：单独使用一台机器，但是几个jvm，所以模拟成一个集群
3.  分布式：使用集群，因此有多个具有不同用途的节点（workers、namenode 等）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-15T04:34:36.393

您可以指定机器的主机名。它只会在您的机器上安装所有内容。

# vb.net - winsock.index 是什么？

> ID：13256400
> 
> 赞同：0
> 
> 时间：2012-11-06T17:41:55.763
> 
> 标签：vb.net, vb6, winsock, vb6-migration

我已经获得了一个 VB6 程序来转换为 .NET，虽然我可以通过谷歌搜索了解大部分 VB6 细节，但有一个我只是不知道。使用了 Winsock，但转换实用程序将其替换为 AxMSWinsockLib.AxWinsock。旧代码引用了一个索引属性，AxMSWinsockLib.AxWinsock 显然没有，但我不知道它在这里试图做什么。有任何想法吗？

```
Public Function PortsOpen(ByRef colWinsock As Collection, ByRef objWinsock As Winsock, ByVal LocalIPAddress As String) As Boolean

Dim Counter As Long
Dim sWS() As String

'Initial to open com. port

Counter = 0

If colWinsock.Count >= objWinsock.Index + 1 Then
    sWS = colWinsock.Item(objWinsock.Index + 1) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T12:20:11.100

在 VB6 中，您可以拥有一组控件，然后稍后使用索引引用它们。这种行为在 .Net 中不再存在

我相信在您的情况下，旧的 VB6 使用 winsock 数组来促进与其他对等方的通信。

例如，如果 VB6 中的原始窗体是通过添加一个 WinSock 控件来设计的，然后将其名称更改为 mySock，然后手动将其 Index 属性值设置为 0，则它变为 mySock(0)

在程序的后面，您需要做的就是制作另一个控件副本

```
Dim currentNumberOfWinSocks as Integer
currentNumberOfWinSocks = mySock.UpperBound
Load mySock(currentNumberOfWinSocks + 1) 
```

因此，要将此逻辑更改为 .Net，您必须通过完全从代码端声明 Winsock 变量数组来解决此问题，而无需中继设计控制。

# r - 对齐和交替字符串

> ID：13256405
> 
> 赞同：0
> 
> 时间：2012-11-06T17:42:12.880
> 
> 标签：r, text

我一直致力于提供数据的文本分析。通常分析包括在纸上对成绩单进行编码，然后将信息作为数字代码导入 R。我想输出单词的成绩单，上面的单词编号被切割成一定的线宽（让我们使用任意 80 个字符）。

**一个最小的可视化示例：**

```
#what we start with:

   person   text word.num
1    greg    The        1
2    greg    dog        2
3    greg   went        3
4    greg     to        4
5    greg    the        5
6    greg   zoo,        6
7    greg    but        7
8    greg    ate        8
9    greg first.        9
10  sally     He       10
11  sally  likes       11
12  sally  water       12
13  sally      a       13
14  sally    bit       14
15  sally   too.       15 
```

#我想要什么：

```
1   2   3    4  5   6
The dog went to the zoo, 

7   8   9      10 11     
but ate first. He likes   

12    13  14  15
water a   bit too. 
```

当数字变大时会出现一个额外的问题，即较大的字数可能会超过一个短字，并且该字需要在其前面放置一个额外的空间。我认为通过确定最大数字的最大字符（数字）并在小于此数量的单词之后添加那么多空格，这在粘贴过程中很容易做到。

到目前为止，我解决这个问题的想法是：

1.  为每行具有一定最大长度的字符向量创建一个 1 列矩阵（`strwrap`此处可能有用）
2.  如上所述在短词后添加额外的空格（在`nchar`这里`gsub`可能有用）
3.  通过使用字数统计函数确定伴随矩阵的数值，然后`cumsum`创建`seq`一个数值（实际上是字符）的伴随矩阵，该矩阵也是 1 列。这将逐行匹配字符（单词）矩阵。
4.  现在这两个矩阵需要逐行交替（不知道该怎么做）
5.  对齐单词上方的数字（不确定如何执行此操作，但`nchar`在这里可能有用）

我想将其保留在基本工具中，尽管我确信 Hadely`stringR`会很有用，但我想避免这种依赖。

**`dput`以上数据：**

```
 dat <- structure(list(person = structure(c(1L, 1L, 1L, 1L, 1L, 1L, 1L,                           
     1L, 1L, 2L, 2L, 2L, 2L, 2L, 2L), .Label = c("greg", "sally"), class = "factor"),             
         text = structure(c(10L, 5L, 14L, 11L, 9L, 15L, 4L, 2L, 6L,                               
         7L, 8L, 13L, 1L, 3L, 12L), .Label = c("a", "ate", "bit",                                 
         "but", "dog", "first.", "He", "likes", "the", "The", "to",                               
         "too.", "water", "went", "zoo,"), class = "factor"), word.num = 1:15), row.names = c(NA, 
     -15L), .Names = c("person", "text", "word.num"), class = "data.frame") 
```

*我无法设计一个标题，我觉得在未来的 SO 用户可以搜索的同时抓住了这个想法。请建议修改...*

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T19:19:27.017

```
> datmat <- matrix(c(1:length(dat$text), as.character(dat$text) ), nrow=2, byrow=TRUE)
> datmat
     [,1]  [,2]  [,3]   [,4] [,5]  [,6]   [,7]  [,8]  [,9]     [,10] [,11]   [,12]   [,13] [,14] [,15] 
[1,] "1"   "2"   "3"    "4"  "5"   "6"    "7"   "8"   "9"      "10"  "11"    "12"    "13"  "14"  "15"  
[2,] "The" "dog" "went" "to" "the" "zoo," "but" "ate" "first." "He"  "likes" "water" "a"   "bit" "too."
> options(width=30)
> datmat
     [,1]  [,2]  [,3]   [,4]
[1,] "1"   "2"   "3"    "4" 
[2,] "The" "dog" "went" "to"
     [,5]  [,6]   [,7]  [,8] 
[1,] "5"   "6"    "7"   "8"  
[2,] "the" "zoo," "but" "ate"
     [,9]     [,10] [,11]  
[1,] "9"      "10"  "11"   
[2,] "first." "He"  "likes"
     [,12]   [,13] [,14]
[1,] "12"    "13"  "14" 
[2,] "water" "a"   "bit"
     [,15] 
[1,] "15"  
[2,] "too." 
```

可以通过强制转换为表类对象并使用 print.table 来删除引号：

```
> class(datmat) <- "table"
> datmat
     [,1] [,2] [,3] [,4] [,5]
[1,] 1    2    3    4    5   
[2,] The  dog  went to   the 
     [,6] [,7] [,8] [,9]  
[1,] 6    7    8    9     
[2,] zoo, but  ate  first.
     [,10] [,11] [,12] [,13]
[1,] 10    11    12    13   
[2,] He    likes water a    
     [,14] [,15]
[1,] 14    15   
[2,] bit   too. 
```

你也可以用这个做点什么。它修复了 Gavin 提到的左对齐问题：

```
> gsub("\\[.*\\,.*\\]", "", capture.output( print(datmat, quote=FALSE) ) )
 [1] "     "                    
 [2] " 1    2    3    4    5   "
 [3] " The  dog  went to   the "
 [4] "       "                  
 [5] " 6    7    8    9     "   
 [6] " zoo, but  ate  first."   
 [7] "     "                    
 [8] " 10    11    12    13   " 
 [9] " He    likes water a    " 
[10] "     "                    
[11] " 14    15   "             
[12] " bit   too. " 
```

还有进一步的改进：

```
datlines <- gsub("\\[.*\\,.*\\]", "", capture.output( print(datmat, quote=FALSE) ) )
for( i in seq_along(datlines)){ cat(datlines[i], "\n") }
 #----------------------------------#
 1    2    3    4    5    
 The  dog  went to   the  

 6    7    8    9      
 zoo, but  ate  first. 

 10    11    12    13    
 He    likes water a     

 14    15    
 bit   too. 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T19:27:14.347

关于什么：

```
> tmp <- setNames(as.character(dat$text), dat$word.num)
> print(tmp, quote=FALSE)
     1      2      3      4    
 likes  water      a    bit   too.
> options(width = 80)
> print(tmp, quote=FALSE)
     1      2      3      4      5      6      7      8      9     10     11 
   The    dog   went     to    the   zoo,    but    ate first.     He  likes 
    12     13     14     15 
 water      a    bit   too. 
```

您可以将自己的类粘贴在对象上并添加打印方法：

```
class(tmp) <- "foo"
print.foo <- function(x, quote = FALSE, ...) {
  print(unclass(x), quote = quote, ...)
}
tmp 
```

给予

```
> tmp
     1      2      3      4      5      6      7      8      9     10     11 
   The    dog   went     to    the   zoo,    but    ate first.     He  likes 
    12     13     14     15 
 water      a    bit   too. 
```

将此表示转储到文件的一种方法是 via `capture.output()`，它有一个 file 参数：

```
capture.output(tmp, file = "foo.txt") 
```

生成的文本文件包含：

```
$ cat foo.txt 
     1      2      3      4      5      6      7      8      9     10     11 
   The    dog   went     to    the   zoo,    but    ate first.     He  likes 
 water      a    bit   too.
    12     13     14     15 
```

它与您所拥有的不太一样 - 单词数字是右对齐的，但它很接近。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T22:21:09.927

为了线程的完整性，我使用 DWin 的解决方案和一点 Gavin 的方法（作为函数）：

```
numbtext <- function(text.var, width=80, txt.file = NULL) {
    zz <- matrix(c(1:length(text.var), as.character(text.var) ), 
        nrow=2, byrow=TRUE)
    OW <- options()$width
    options(width=width)
    dimnames(zz) <- list(c(rep("", nrow(zz))), c(rep("", ncol(zz))))
    print(zz, quote = FALSE)
    if (!is.null(txt.file)){
        sink(file=txt.file, append = TRUE) 
        print(zz, quote = FALSE)
        sink()
    }
    options(width=OW)
}

numbtext(dat$text, 40, "foo.txt") 
```

产生：

```
 1   2   3    4  5   6    7   8  
 The dog went to the zoo, but ate

 9      10 11    12    13 14  15  
 first. He likes water a  bit too. 
```

# java - 在服务层做一个 STATIC 方法有什么害处——Spring 3

> ID：13256406
> 
> 赞同：15
> 
> 时间：2012-11-06T17:42:22.307
> 
> 标签：java, spring, spring-mvc

我知道这不是一个最好的设计，而只是一个春季新手的想法。

现在我们可以很容易地`autowire`在 Spring 框架中方便地相互提供任何服务方法。但是创建服务类的静态工厂方法并到处调用它有什么缺点呢？

这很常见：

```
@Autowired
CustomerService customerService;

....
AccountDetail ad = customerService.getAccountDetail(accountId, type); 
```

但这也应该有效：

```
AccountDetail ad = CustomerService.getAccountDetail(accountId, type); //if we make getAccountDetail(String, String) static 
```

那么为什么会有像 autowire 这样的设计呢？它看起来很花哨而且很酷，但是这背后的工作仍然是在另一个服务对象上创建一个服务 bean 实例。

说真的，当春天遍布市场时，很多帖子和文章都在谈论优点和翻新。但它是否能保证更好的性能（比如使用 autowire 而不是 static）？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-06T17:50:36.370

原因有很多：

*   在测试期间你不能`CustomerService`轻易地用模拟代替（除了像 PowerMock 这样的工具）

*   `static`方法不参与标准的、基于代理的 AOP（无事务、安全、自定义方面）

*   您不能再使用花哨的注入技术，例如将 HTTP 请求（请求范围）注入单例范围的服务（无论如何设计不佳，但是...）

但要完整，也有优点：

*   `static`方法实际上更接近您的意图，Spring bean 很少有状态，因此它们实际上不需要实例来工作

*   `static`调用可能更快（这与 99% 的程序无关）

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T17:45:39.847

如果您需要多个具有不同配置的 CustomerService 组件怎么办？你不能用一个静态方法来做到这一点。

另外，如果 CustomerService 上有任何配置，你如何注入它？拥有一个连接到依赖对象的 bean 可以集中您的配置并使您不必搜索代码。

# ant - ant 可以生成一个统一的脚本，包括所有类似于 maven 的有效 pom 的导入吗？

> ID：13256407
> 
> 赞同：3
> 
> 时间：2012-11-06T17:42:26.510
> 
> 标签：ant

我有一个 ant 脚本，它导入其他脚本，这些脚本导入其他脚本，导致定义可能发生的地方的网络。

ant 可以拉入所有定义并像 maven 一样输出一个文件`help:effective-pom`吗？

我想将此作为输出文件添加到我的构建中，以使调试更容易一些。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-08T18:26:42.470

您可以创建另一个目标来创建这种文件。例如，它可能如下所示：

main build.xml 做了一些工作，也可以生成有效的构建：

```
<project name="testxml" default="build">

    <import file="build1.xml" />
    <import file="build2.xml" />

    <target name="build">
        <echo>build project</echo>
    </target>

    <target name="effective.build">
        <taskdef name="groovy" classname="org.codehaus.groovy.ant.Groovy" classpath="C:\Program Files (x86)\groovy-2.1.4\embeddable\groovy-all-2.1.4.jar" />
        <groovy>
            def regex = ~/import file="(.*)"/
            def buildXmlContent = new File('build.xml').text
            new File('build.xml').eachLine {
                line -> regex.matcher(line).find() {
                    def file = new File(it[1])
                    if (file.exists()) {
                        def replacement = file.getText().replaceAll(/&lt;project.*/, '').replaceAll(/&lt;\/project.*/, '')
                        buildXmlContent = buildXmlContent.replaceFirst(/&lt;import.*/, replacement)
                    }
                }
            }
            new File('build.effective.xml') &lt;&lt; buildXmlContent
        </groovy>
    </target>

</project> 
```

为测试创建了两个 build.xml：

```
<project name="testxml2" default="build">
    <target name="clean">
        <echo>clean project</echo>
    </target>
</project>

<project name="testxml1" default="build">
    <target name="test">
        <echo>test project</echo>
    </target>
</project> 
```

如果您将运行`ant effective.build`，您将获得包含以下内容的新`build.effective.xml`文件：

```
<project name="testxml" default="build">

    <target name="test">
        <echo>test project</echo>
    </target>

    <target name="clean">
        <echo>clean project</echo>
    </target>

    <target name="build">
        <echo>build project</echo>
    </target>

    <target name="effective.build">
        <taskdef name="groovy" classname="org.codehaus.groovy.ant.Groovy" classpath="C:\Program Files (x86)\groovy-2.1.4\embeddable\groovy-all-2.1.4.jar" />
        <groovy>
            import java.util.regex.Pattern

            def regex = ~/import file="(.*)"/
            def buildXmlContent = new File('build.xml').text
            new File('build.xml').eachLine {
                line -> regex.matcher(line).find() {
                    def file = new File(it[1])
                    if (file.exists()) {
                        def replacement = file.getText().replaceAll(/&lt;project.*/, '').replaceAll(/&lt;\/project.*/, '')
                        buildXmlContent = buildXmlContent.replaceFirst(/&lt;import.*/, replacement)
                    }
                }
            }
            new File('build.effective.xml') &lt;&lt; buildXmlContent
        </groovy>
    </target>

</project> 
```

为此，我选择了 groovy（因为我实际学习了它），但您可以用另一种语言创建它。您还可以将此 groovy 代码编译为 ant 任务并将其用作新任务，例如`<effectiveant outfile="build.effective.xml">`. 我的示例并不完美，但它显示了其中一种解决方案。

# graph - 如何让最大的节点组相互连接？

> ID：13256408
> 
> 赞同：0
> 
> 时间：2012-11-06T17:42:40.690
> 
> 标签：graph, graph-theory

我得到了随机连接的巨大节点图。我需要获得最大的节点组，其中每个节点都与组中的其他节点相连。

我可以使用蛮力解决它，但我想知道是否有更好的方法来做到这一点。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T20:39:39.357

我认为您的问题包括在图中找到[最大集团](http://en.wikipedia.org/wiki/Clique_problem)。文献中有几种算法可以帮助您入门

# .htaccess - Htaccess 删除查询字符串并重定向到产品

> ID：13256409
> 
> 赞同：0
> 
> 时间：2012-11-06T17:42:45.740
> 
> 标签：.htaccess, mod-rewrite, redirect

我尝试从此链接中删除/重定向查询字符串：

[http://www.myDomain.com/detail/link-526.html?fb_action_ids=10151931158951677&fb_action_types=og.likes&fb_source=aggregation&fb_aggregation_id=288381481237582](http://www.myDomain.com/detail/link-526.html?fb_action_ids=10151931158951677&fb_action_types=og.likes&fb_source=aggregation&fb_aggregation_id=288381481237582)

要获取此链接：[http ://www.myDomain.com/detail/link-526.html](http://www.myDomain.com/detail/link-526.html)

任何帮助将不胜感激，谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:58:21.203

Try adding this in the htaccess file in your document root:

```
RewriteEngine On
RewriteCond %{QUERY_STRING} (^|&)fb_action_ids=
RewriteRule ^/?detail/link- %{REQUEST_URI}? [L,R=301] 
```

Note that this redirects the browser if there's facebook query string stuff without any of it, but if the content of your page keeps adding it, the redirecting might loop.

# javascript - Google Chrome 扩展程序就像在控制台中一样运行？

> ID：13256410
> 
> 赞同：3
> 
> 时间：2012-11-06T17:42:48.907
> 
> 标签：javascript, google-chrome, google-chrome-extension, deezer

我正在尝试制作一个可以在 DEEZER (www.deezer.com) 中暂停/播放付款人的 Google Chrome 扩展程序。我`playercontrol.doAction('next')`在 Google chrome JavaScript 控制台中手动运行代码“”，我可以操作 deezer 播放器，所以我研究了将代码注入带有扩展名的 Deezer 网页的可能性，但我没有成功地做到这一点. 是否可以在 Deezer 网页中运行 JavaScript 代码，就好像它来自 Google Chrome 中的控制台一样？如果有怎么办？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-12-03T18:09:44.180

您在这里面临的问题如下：

1.  您需要使用 content_scripts 而不是从后台页面运行代码。
2.  从后台页面运行的代码和作为内容脚本运行的代码是“沙盒”。这意味着您的代码无权访问页面创建的全局变量。您的扩展程序无权访问它。好消息是你仍然可以做到。不过，你必须聪明。

在您的扩展程序中，您必须在页面的“头部”中注入一个新的 Script 标签。您必须创建一个新的脚本标签并将其附加到页面的头部。在附加它之前，您需要将脚本标记的“innerHTML”设置为您要运行的 JavaScript。这是您需要做的事情的要点。

```
var myJavaScript = "alert('hey guys');";    //You need to put your JS here. 
var scriptTag = document.createElement("script");
scriptTag.innerHTML = myJavaScript;
document.head.appendChild(scriptTag); 
```

这会将新的脚本标签放入头部，从而绕过 Chrome 扩展程序的安全性。这将使新脚本可以访问页面上的常规全局变量，即：您将可以访问“playercontrol”对象。

# entity-framework - 实体框架 POCO - 导航属性不刷新

> ID：13256412
> 
> 赞同：0
> 
> 时间：2012-11-06T17:42:51.620
> 
> 标签：entity-framework, poco, navigation-properties

我对 EF 4 中的 poco 类有疑问。

我有一个 Order 实体，其中包含一个 Customer 实体的外键。

因此，Order 类具有 Customer 类型的导航属性。

它看起来像这样：

```
public class Order
{
     public virtual int Id { get; set; }
     public virtual CustomerId  { get; set; }
     public virtual Customer customer { get; set;}
     …
} 
```

当我加载订单时，导航属性 customer 是正确的，但如果 CustomerId 属性发生更改，导航属性不会随着新客户刷新。

如果我在 EF 上下文中调用 DetectChanges() 方法，则会刷新导航属性。

我读过所有属性都标记为虚拟，关系同步是自动的，但这里不是这种情况。

我哪里做错了 ？

谢谢你的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T01:02:11.223

这意味着由于某种原因没有为您的实体创建代理。看看这篇博文 - [http://blogs.msdn.com/b/adonet/archive/2009/12/22/poco-proxies-part-1.aspx](http://blogs.msdn.com/b/adonet/archive/2009/12/22/poco-proxies-part-1.aspx)。以下是创建代理的要求：http: [//msdn.microsoft.com/en-us/library/vstudio/dd468057](http://msdn.microsoft.com/en-us/library/vstudio/dd468057(v=vs.100).aspx) (v=vs.100).aspx 。不得禁用代理创建。

# php - 关于基于 PHP 会话的登录的问题

> ID：13256417
> 
> 赞同：1
> 
> 时间：2012-11-06T17:43:19.093
> 
> 标签：php, session, session-state

我有几个关于基于 PHP 会话的登录的问题。我使用以下教程创建了一个登录表单，该表单连接到我拥有的现有用户数据库：

[http://www.sourcecodester.com/tutorials/php/4341/how-create-login-page-phpmysql.html](http://www.sourcecodester.com/tutorials/php/4341/how-create-login-page-phpmysql.html)

大部分我都懂，但我只想查询一些我不明白的事情：

```
//Login Successful
session_regenerate_id();
$member = mysql_fetch_assoc($result);
$_SESSION['SESS_MEMBER_ID'] = $member['mem_id'];
$_SESSION['SESS_FIRST_NAME'] = $member['username'];
$_SESSION['SESS_LAST_NAME'] = $member['password'];
session_write_close();
header("location: home.php");
exit(); 
```

以下代码进入 login_exec.php 页面 - 我认为此代码在成功登录时设置会话 ID - 我正确吗？

我不明白的是“SESS_MEMBER_ID”、“SESS_FIRST_NAME”和“SESS_LAST_NAME”的原因——为什么会在那里，它到底在做什么？

我的第二个问题。在“home.php”中 - 当用户单击“注销”时，他们会被引导回 index.php，并且会话正在以某种方式被破坏。单击“注销”时，会话究竟是如何被破坏的。

第三，是否可以更改“home.php”，以便有一个 if/else 语句，上面写着“if logged_in echo”yay，you are logged in”，其中包含各种登录内容，“else if not_logged_in echo "对不起，您没有登录，无法查看该页面，请到以下页面登录"。如果有可能，我会怎么做？

非常感谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T17:54:27.047

```
//Login Successful
session_regenerate_id();
$member = mysql_fetch_assoc($result);
$_SESSION['SESS_MEMBER_ID'] = $member['mem_id'];
$_SESSION['SESS_FIRST_NAME'] = $member['username'];
$_SESSION['SESS_LAST_NAME'] = $member['password']; 
```

> 以下代码进入 login_exec.php 页面 - 我认为此代码在成功登录时设置会话 ID - 我正确吗？

是的，它设置会话，并在保存之前将一些成员信息保存到会话本身。这样，无需进一步查询数据库即可获得信息。此外，如果信息*不*存在，我们就知道用户没有经过身份验证。

您还可以存储整个`$member`

```
$_SESSION['member'] = $member; 
```

但是这样做也会保存*密码*，并且在所有后续页面的会话中隐藏密码并不是一个好习惯。不过，您可以这样做：

```
unset($member['password']);    // $member is a copy of the database row, untouched.
$_SESSION['member'] = $member; 
```

> 我的第二个问题。在“home.php”中 - 当用户单击“注销”时，他们会被引导回 index.php，并且会话正在以某种方式被破坏。单击“注销”时，会话究竟是如何被破坏的。

通常这是通过重定向和`session_destroy`.

> 第三，是否可以更改“home.php”，以便有一个 if/else 语句，上面写着类似“if logged_in echo”yay, you are logged in”的各种登录内容

是的，使用上面的 $_SESSION：

```
<?php
    if (!empty($_SESSION['SESS_MEMBER_ID']))
    {
?>

    Welcome, <?php print $_SESSION['SESS_FIRST_NAME']; ?>!

<?php
    } else {
?>
    Sorry, you need to <a href="login.php">LOGIN!</a>
<?php
    }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:52:33.900

是：`session_regenerate_id();`正在设置您的会话 ID。

设置了其他会话变量（SESS_MEMBER_ID 等），因此您不必一直查询数据。所以这些变量（ID、名字和姓氏）存储在会话中。所以你可以简单地`<? echo "Welcome ".$_SESSION['SESS_FIRST_NAME']; ?>`为“Welcome Zach”做...另外你可以做进一步的检查以确保会话数据与该成员的数据库记录相匹配，以确保它没有被欺骗。

第三，你可以做

```
if(!empty($_SESSION['SESS_MEMBER_ID'])){ echo "Yay ".$_SESSION['SESS_FIRST_NAME'].", you are logged in"; }else{ echo "XX"; } 
```

# asp.net-mvc - ASP.NET MVC 上的用户信息

> ID：13256419
> 
> 赞同：1
> 
> 时间：2012-11-06T17:43:24.053
> 
> 标签：asp.net-mvc, asp.net-mvc-3

我正在使用 ASP.NET MVC，当我有用户使用表单身份验证登录时，我想保留有关该用户的一些信息。从 IPrincipal 实现的 HttpContext User 对象具有一些属性，但我想添加更多属性，以便我可以在我的操作和视图中获取这些属性。实现这一目标的最佳方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:42:30.503

您可以使用[Membership、Role 或 Profile 提供程序](http://msdn.microsoft.com/en-us/library/yh26yfzy%28v=vs.100%29.aspx)来保存有关您的用户的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T18:21:06.077

谢谢，但我发现这篇博客文章帮助我解决了这个问题：[http ://www.creatingsoftware.net/2007/11/aspnet-20-forms-authentication-keeping.html](http://www.creatingsoftware.net/2007/11/aspnet-20-forms-authentication-keeping.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:37:35.420

我们过去曾使用它在表单身份验证 cookie 中存储有关用户的其他信息：http: [//formsauthext.codeplex.com/](http://formsauthext.codeplex.com/)

似乎工作得相当好，并防止了一些数据库命中，因为一些基本信息可从 cookie 中获得。此外，走这条路线可以防止围绕会话的问题（过期、应用程序回收等）。

# c# - 在 Web 服务中为 InfoPath 客户端显示自定义错误消息

> ID：13256420
> 
> 赞同：0
> 
> 时间：2012-11-06T17:43:44.513
> 
> 标签：c#, web-services, infopath2010, custom-error-handling

我有一个将记录提交到数据库的自定义 Web 服务，

提交给表的 JF_ID 值引用主/源表的 JF_ID 值。因此，如果用户尝试提交不存在的 JF_ID，则会捕获 sql 异常，说“违反参照完整性等......

这是我的网络服务的样子：

```
[WebService(Namespace = "http://microsoft.com/webservices/")]
class POReqEntryForm : WebService 
{
    [WebMethod(Description = "Submits data to [Req_entry].")]
    public void AddRecordPOReqIdEntry(int JF_ID, int ReqId, string PONum, string POLineNum, float POAmount, string Submitter, string DateSubmitted)
    {

        string connectionString =
          ConfigurationManager.ConnectionStrings["REQdb"].ConnectionString;

        using (SqlConnection conn = new SqlConnection(connectionString))
        {
            SqlCommand cmd = new SqlCommand();
            cmd.CommandType = System.Data.CommandType.Text;

            cmd.CommandText = "INSERT INTO [REQdb].[dbo].[Req_entry] "
                + "(JF_ID, Req_id, Po_num, Po_line_num, po_amount, Submitter, Date_Submitted ) "
                + "VALUES (@JF_ID, @ReqId, @PONum, @POLineNum, @POAmount, @Submitter, @DateSubmitted)";

            cmd.Parameters.AddWithValue("JF_ID", JF_ID);
            cmd.Parameters.AddWithValue("ReqId", ReqId);
            cmd.Parameters.AddWithValue("PONum", PONum);
            cmd.Parameters.AddWithValue("POLineNum", POLineNum);
            cmd.Parameters.AddWithValue("POAmount", POAmount);
            cmd.Parameters.AddWithValue("Submitter", Submitter);
            cmd.Parameters.AddWithValue("DateSubmitted", DateSubmitted);

            cmd.Connection = conn;

            try
            {
                conn.Open();
                cmd.ExecuteNonQuery();

            }

            catch
            {
                // Handle the error using your own preferred error-handling method
            }
            finally
            {
                conn.Close();
            }
        }

    } 
```

}

用户可能有许多故障数据条目。例如，用户输入字符串而不是整数值，如果他尝试提交不存在的 JF_ID 的条目，则违反参照完整性。

```
The INSERT statement conflicted with the FOREIGN KEY constraint "FK_Req_Entry_JF_ID". The conflict occurred in database "REQdb", table "dbo.Main_Form", column 'JF_ID'. 
```

如何确保在捕获此类 SQL 异常时，从我的 Web 服务传递用户友好的自定义错误消息（例如输入的 ID 不存在。数据插入失败！）。最后，我想将此友好的错误消息传递给 InfoPath 客户端。

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-23T08:45:05.643

你想要做的就是“引发肥皂异常”。[你可以在这里](http://msdn.microsoft.com/en-us/library/system.web.services.protocols.soapexception%28v=vs.90%29.aspx)阅读更多关于它的信息。使用以下代码：

```
 /// <summary>
    /// Creates a custom SoapException to submit the client detailed information about the thrown errors
    /// </summary>
    /// <param name="uri">the name of the called method</param>
    /// <param name="webServiceNamespace">iShare_Services</param>
    /// <param name="errorMessage">the thrown error message</param>
    /// <param name="errorSource">the method which caused the error</param>
    /// <param name="code">Server or Client error?</param>
    /// throw RaiseException("MyMethod", "Service", ee.Message,
    /// ee.TargetSite.Name, FaultCode.Client);
    /// <returns></returns>
    public SoapException RaiseException(string uri, string webServiceNamespace,
        string errorMessage, string errorSource, FaultCode code)
    {
        XmlQualifiedName faultCodeLocation = null;
        //Identify the location of the FaultCode
        switch (code)
        {
            case FaultCode.Client:
                faultCodeLocation = SoapException.ClientFaultCode;
                break;
            case FaultCode.Server:
                faultCodeLocation = SoapException.ServerFaultCode;
                break;
        }

        XmlDocument xmlDoc = new XmlDocument();
        //Create the Detail node
        XmlNode rootNode = xmlDoc.CreateNode(XmlNodeType.Element, SoapException.DetailElementName.Name, SoapException.DetailElementName.Namespace);
        //Build specific details for the SoapException

        //Add first child of detail XML element.
        XmlNode errorNode = xmlDoc.CreateNode(XmlNodeType.Element, "Error", webServiceNamespace);

        //Create and set the value for the ErrorMessage node
        XmlNode errorMessageNode = xmlDoc.CreateNode(XmlNodeType.Element, "ErrorMessage", webServiceNamespace);

        errorMessageNode.InnerText = errorMessage;

        //Create and set the value for the ErrorSource node
        XmlNode errorSourceNode = xmlDoc.CreateNode(XmlNodeType.Element, "ErrorSource", webServiceNamespace);

        errorSourceNode.InnerText = errorSource;

        //Append the Error child element nodes to the root detail node.
        errorNode.AppendChild(errorMessageNode);
        errorNode.AppendChild(errorSourceNode);

        //Append the Detail node to the root node
        rootNode.AppendChild(errorNode);

        //Construct the exception
        SoapException soapEx = new SoapException(errorMessage, faultCodeLocation, uri, rootNode);

        //Raise the exception  back to the caller
        return soapEx;
    } 
```

并在您的捕获中调用它，如下所示：

```
 catch (Exception e)
        {
            var userFriendlyMessage = "this is a user friendly exception!";
            throw RaiseException("MyMethod", this.GetType().Namespace, userFriendlyMessage, e.Source, FaultCode.Client);
        } 
```

在 InfoPath 中，您只需添加 WebService 引用（检索和不提交）并将消息绑定到所需的字段。

您还可以扩展 RaiseException 代码，它将 ex.Message 和用户友好的消息发送回客户端 (InfoPath)。您可能想要创建一个“管理视图”，以允许您查看实际的异常。

# c - fgets 返回空

> ID：13256421
> 
> 赞同：0
> 
> 时间：2012-11-06T17:43:47.763
> 
> 标签：c, visual-studio-2010, process, pipe, fgets

从父进程，我试图通过标准输入/输出控制子进程。我使用以下 MSDN 示例创建子进程并重定向其标准输入和输出：http: [//msdn.microsoft.com/en-us/library/windows/desktop/ms682499%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/ms682499%28v=vs.100%29.aspx)

在父端，我使用以下代码两次发送相同的“命令”：

```
const char cmd[] = "test\n";
DWORD written, read;
BOOL success;
success = WriteFile(g_hChildStd_IN_Wr, cmd, sizeof(cmd), &written, NULL);
success = WriteFile(g_hChildStd_IN_Wr, cmd, sizeof(cmd), &written, NULL); 
```

在孩子方面，我通过**fgets**调用读取了这些命令。第一个命令按预期读取。但是当发送第二个命令时， fgets 调用返回一个空字符串，并且下一个 fgets 调用不返回。这是子进程代码：

```
char *retStrP;
char str[256];
size_t strLen;

retStrP = fgets(str, 256, stdin);
strLen = strlen(str);
if (retStrP != str)
{
    char errorStr[256];
    int a = feof(stdin);
    int b = ferror(stdin);
    sprintf(errorStr, "Fgets error, %d %d\n", a, b);
    OutputDebugString(errorStr);
}
else if (strLen == 0)
{
    char errorStr[256];
    int a = feof(stdin);
    int b = ferror(stdin);
    sprintf(errorStr, "Strlen is 0, %d %d\n", a, b);
    OutputDebugString(errorStr);
} 
```

从前面的代码中，对 fgets 的第二次调用的行为如下：返回的指针等于 str 缓冲区，但 strlen 为 0。

在阅读 MSDN fgets 文档（[http://msdn.microsoft.com/en-us/library/c37dh6kf%28v=vs.100%29.aspx](http://msdn.microsoft.com/en-us/library/c37dh6kf%28v=vs.100%29.aspx)）时，我看不出有任何方法可以将指针返回到缓冲区作为第一个参数传递，第一个缓冲区的字节设置为 0（只要缓冲区大小大于 1）。如果发生错误或到达文件末尾，fgets 应该返回 NULL 并且 feof 或 ferror 应该返回不为 0 的值。

我怀疑管道处理出了点问题，但我不知道是什么......从父方来看，除了发送相同的缓冲区两次之外，我对标准输入写入管道没有做任何事情。知道什么会导致这种行为吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T17:49:29.867

我发现了问题！

从父进程中，WriteFile 调用将 NULL 终止字符发送到管道。

因此，在第一次 WriteFile 调用之后，fgets 将字符串读取到换行符为止。然后在第二次 WriteFile 调用中，fgets 读取从前一个 NULL 终止字符到第二个换行符的字符串。它导致返回的字符串的第一个字符是 NULL 终止字符。这就是为什么 fgets 返回没有错误但字符串长度为 0 的原因。

解决方案是通过从 cmd 缓冲区大小中减去 1 来不发送 NULL 终止字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:21:41.213

您的问题与您链接到的示例非常模糊。仍然有一些建议。

尝试这个：

```
while(!success)
   success = WriteFile(g_hChildStd_IN_Wr, cmd, sizeof(cmd), &written, NULL);
while(!success)
   success = WriteFile(g_hChildStd_IN_Wr, cmd, sizeof(cmd), &written, NULL); 
```

原因：如果`WriteFile()`函数成功，则返回值非零 (TRUE)。如果函数失败或异步完成，则返回值为零 (FALSE)。要获取错误信息，请使用该`GetLastError()`函数。

在子进程的 for 循环中使用`ReadFile()`而不是`fgets`读取由 , 写入的数据。`WriteFile()`

如果您仍然遇到问题`GetLastError()`，请在您的代码中使用该功能`WriteFile()`并`ReadFile()`发布您的错误代码信息。我们或许能更好地帮助您。

# wordpress - Wordpress：使用 Coda Slider 循环构建基于多个类别的幻灯片

> ID：13256422
> 
> 赞同：0
> 
> 时间：2012-11-06T17:43:49.723
> 
> 标签：wordpress

我正在使用循环来生成 Coda Slider 幻灯片放映所需的幻灯片。幻灯片应该从 5 个不同的类别中提取最新的帖子。我遇到的问题是它从 5 个类别中集体而不是单独地提取 5 个最新帖子。所以它从第一个类别中提取 2 个帖子，然后从其他类别中提取 1 个帖子。

有什么办法可以让它正常工作吗？

这是我正在使用的代码：

```
<?php 
$cat_post_query = new WP_Query($query_string . 'cat=7,8,10,9,11');
while ($cat_post_query->have_posts()) : $cat_post_query->the_post();
$do_not_duplicate = $post->ID;?>

<div>
* slide content *
</div>

<?php endwhile;  ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-16T00:31:41.527

对于那些对这个问题的答案感兴趣的人，我自己找到了答案。

```
<div class="coda-slider"  id="slideshow">    

<?php
// array of category IDs
$categories =  array(1,2,3,4,5);

foreach ($categories as $cat) :
  $post = false;
  $post = get_posts('cat='.$cat.'&posts_per_page=1');
  if($post) :
    $post = $post[0];
    setup_postdata($post); ?>

    <!-- rest of normal loop -->

    <div <?php post_class(); ?>>
      <h2 class="title">title used to dynamically generate thumbs in codaslider</h2>
      <h3><a href="<?php the_permalink() ?>" rel="bookmark" title="Permanent Link to <?php the_title_attribute(); ?>"><?php the_title(); ?></a></h3>
      <?php the_content(); ?>
    </div>

  <?php endif; ?>
<?php endforeach; ?>  

</div> 
```

原始的 foreach 循环代码来自这篇文章：

[http://wordpress.org/support/topic/display-most-recent-post-from-each-of-several-categories-on-home-page](http://wordpress.org/support/topic/display-most-recent-post-from-each-of-several-categories-on-home-page)

# scala - 使用 Scala 反射使用内部对象启动类

> ID：13256424
> 
> 赞同：2
> 
> 时间：2012-11-06T17:43:54.457
> 
> 标签：scala, reflection

我有这样的课程：

```
class NormalClass[T <: NormalClass[T]] {
  object One
  object Two
} 
```

我希望能够在类型化特征中创建上述类的新实例。MetaClass 中的以下内容`def make`创建了 T 的实例，但它缺少与 NormalClass 关联的内部对象。

```
trait MetaClass[T <: NormalClass[T]] {
  def make:T = this.getClass.getSuperclass.newInstance.asInstanceOf[T]
} 
```

我有两个问题，丢失对象的原因是什么，以及使用反射来启动具有来自其类型的内部对象的新类的最佳方法是什么

编辑：更多细节

我面临的问题是，如果我使用 make eg 创建一个实例`var f = make`并尝试访问和对象方法 egfOne.getSomething ，我会收到错误消息`value One is not a member of type parameter T`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:10:40.400

所以我认为你的问题特别是反射：

```
this.getClass.getSuperclass.newInstance.asInstanceOf[T] 
```

这里，`this`是你的实例`MetaClass`，并且没有特别的理由相信超类`this`是你想要实例化的类。例如：

```
class Foo extends NormalClass[Foo]
object Foo extends MetaClass[Foo] 
```

在这种情况下，对象的超类`Foo`根本不是 a `NormalClass`，而是`java.lang.Object`. 结果，它不会有`One`or之类的成员，如果您尝试将其强制转换为`Two`，您将得到 a 。`ClassCastException``T`

如果您希望该`make`方法实例化一个 类型的对象`T`，那么您需要获取 的运行时类`T`，然后使用它来创建新实例。您可以通过隐式获取 a 来完成此操作`ClassTag`：

```
class NormalClass[T <: NormalClass[T]] {
  object One
  object Two
}
trait MetaClass[T <: NormalClass[T]] {
  def make(implicit classTag: scala.reflect.ClassTag[T]): T =
    classTag.runtimeClass.newInstance.asInstanceOf[T]
}

// declare a class and an object for creating instances of that class
class Foo extends NormalClass[Foo]
object Foo extends MetaClass[Foo]

// create a new instance of Foo and access its fields
val foo = Foo.make
foo.One
foo.Two 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:09:33.137

我不确定问题是什么。这对我有用：

```
scala> :paste
// Entering paste mode (ctrl-D to finish)

class NormalClass[T <: NormalClass[T]] {
  object One
  object Two
}

trait MetaClass[T <: NormalClass[T]] {
  def make:T = this.getClass.getSuperclass.newInstance.asInstanceOf[T]
} 

class X extends NormalClass[X]

// Exiting paste mode, now interpreting.

defined class NormalClass
defined trait MetaClass
defined class X

scala> new X with MetaClass[X]
res0: X with MetaClass[X] = $anon$1@404fe94c

scala> res0.One
res1: res0.One.type = NormalClass$One$@53d9f80

scala> res0.Two
res2: res0.Two.type = NormalClass$Two$@4d0948bd 
```

如果这不能回答您的问题，请澄清您遇到的问题。

# c - 对 C 代码中的奇怪行为感到困惑

> ID：13256425
> 
> 赞同：-1
> 
> 时间：2012-11-06T17:43:57.203
> 
> 标签：c

考虑以下 C - 代码：

```
struct ScoredGamestate
{
    GameState88 gameState;
    int whitePlayerScore; 
};

int bestScore;

assert(scoredState->whitePlayerScore > -1000 && 
scoredState->whitePlayerScore < 1000);

if (scoredState->gameState.playerOnMove == PlayerWhite)
{
    bestScore = scoredState->whitePlayerScore;
}
else
{
    bestScore -(scoredState->whitePlayerScore);
}

assert(bestScore > -1000 && bestScore < 1000); 
```

应该是合乎逻辑的，在代码之后， bestScore 总是 +/- "whitePlayerScore"

但是在我的调试器（visual studio 2010 C++ express edition）中发生了什么，“whitePlayerScore”是50，但是bestScore变成了-8908234

（第一个断言永远不会触发，但总是第二个）

这怎么会发生？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T17:46:09.380

嗯，这个

```
bestScore -(scoredState->whitePlayerScore); 
```

好像少了一个`=`字符。我猜你打算做作业

```
bestScore = -scoredState->whitePlayerScore; 
```

但相反，您使用了一些无意义的减法并丢弃了结果。大多数编译器实际上会发出关于没有副作用的表达式语句的警告。不是你的吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T17:46:05.460

你有错字

```
bestScore -(scoredState->whitePlayerScore); 
```

应该

> bestScore = (scoredState->whitePlayerScore);

这就是为什么您有未初始化（或初始化为垃圾值）值的`int bestScore;`原因，在您的情况下，在调试器中将其视为

> -8908234

# perl - Perl 编码：如何提取文本文件中的部分行并将其打印到输出文件

> ID：13256426
> 
> 赞同：1
> 
> 时间：2012-11-06T17:43:59.923
> 
> 标签：perl

我有一个格式如下所示的大文本文件 -

```
ID  SNP
FT  SNP 433
FT      /note="refAllele: T SNPstrains: 7083_1#5=C 7414_8#8=C 7480_8#49=C "
FT      /colour=1
FT  SNP 442
FT      /note="refAllele: T SNPstrains: 7065_8#2=C 7065_8#94=C 7083_1#2=C 7083_1#3=C 7083_1#41=C 7083_1#42=C 7083_1#43=C "
FT      /colour=1
FT  SNP 460
FT      /note="refAllele: T SNPstrains: 7564_8#14=C "
FT      /colour=1
FT  SNP 703
FT      /note="refAllele: G SNPstrains: 7521_5#39=A (non-synonymous) (AA Ala->Thr) "
FT      /colour=2
FT  SNP 937
FT      /note="refAllele: G SNPstrains: 7414_8#30=T (non-synonymous) (AA Val->Leu) "
FT      /colour=2
FT  SNP 1269
FT      /note="refAllele: G SNPstrains: 7480_7#22=A (synonymous) 7480_7#62=A (synonymous) "
FT      /colour=3
FT  SNP 1804
FT      /note="refAllele: T SNPstrains: 7414_7#66=A (non-synonymous) (AA Ser->Thr) 7414_8#44=A (non-synonymous) (AA Ser->Thr) 7521_6#54=A (non-synonymous) (AA Ser->Thr) "
FT      /colour=2 
```

这是我使用的代码 -

```
$file="input file";
open IN, "$file";
open OUT, ">output file";
print OUT "Coordinate   No of Strains   AA Change\n";
while(<IN>){
    if(m/^FT\s+SNP\s+(\d+)/){
            $SNP=$1;        
    }elsif(m/^FT\s+\/note="(.*)"/){
        $line=$1;
        $count = ($line =~ tr/=/=/);
        $line =~ m/\((AA \w+->\w+)\)\s*$/;
        $change = $1 || "";
    }elsif(m/^FT\s+\/colour=(\d+)/){
        print OUT "$SNP $count $change\n" if $cod{$1} eq "non";
    }
} 
```

目的是有一个类似于下面的输出文件（对于文本文件的上述部分）

```
Coordinates No of Strains AA Change
703         1             AA Ala->Thr
937         1             AA Val->Leu
1804        3             AA Ser->Thr 
```

但是，当我将代码应用于文本文件时，我收到一个错误：Use of uninitialised values ($count or $change) in concatenation (.) or string at line 23。有问题的行是

```
print OUT "$SNP $count $change\n" if $cod{$1} eq "non"; 
```

该错误是指包含的行

```
FT      /colour=2 
```

即，显示非同义突变的行，例如示例文本中的第 13 行。

请注意，我是编程新手，大部分代码不是我编写的。任何帮助，将不胜感激！

提前谢谢了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T04:20:14.807

我使用更现代的编码标准重写了您的程序：

*   `use strict;`我用过`use warnings;`
*   我使用空格来帮助澄清代码
*   我对循环和 if/elsif 语句等内容使用了更现代的语法

我发现了一些小故障，但我很快就解决了这些问题。这是你的代码：

```
use strict;
use warnings;
use feature qw(say);

my $file = "input.txt";
my %cod = ( 1 => "red", 2 => "non", 3 => "green" );
open my $in, "<", "$file";
open my $out, ">", "output.txt";
say $out "Coordinate   No of Strains   AA Change";

my $SNP;
my $count;
my $change;
while ( my $line = <$in> ) {
    chomp $line;
    say qq(DEBUG: Line = "$line");
    if ( $line =~ /^FT\s+SNP\s+(\d+)/ ){
        $SNP = $1;        
        say qq(\$SNP = $1;);
    } 
    elsif ( $line =~ /^FT\s+\/note="(.*)"/) {
        my $note = $1;
        say qq(my \$note = $1);
        $count = ($note =~ tr/=/=/);
        $note =~ /\((AA \w+->\w+)\)\s*$/;
        $change = $1 || "";
    }
    elsif ( $line =~ /^FT\s+\/colour=(\d+)/ ) {
        say qq(Code = $1);
        if ( $cod{$1} eq "non" ) {
            printf $out "%-12.12s %-15.15s %s\n",  $SNP, $count, $change;
        }
    }
} 
```

这是输出：

```
Coordinate   No of Strains   AA Change
703          1               AA Ala->Thr
937          1               AA Val->Leu
1804         3               AA Ser->Thr 
```

这是你要找的吗？

# c# - C# 变量数组

> ID：13256433
> 
> 赞同：1
> 
> 时间：2012-11-06T17:44:22.830
> 
> 标签：c#, arrays, variables

是否有可能做这样的事情：

```
string A = "A";
string B = "B";

object[] O = { A, B };
O[0] = "C"; 
```

`A`最终价值在哪里`"C"`？

上面的代码将替换`O[0]`为`"C"`，但`A`保持不变。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-06T17:47:42.720

不 - 至少不是在安全代码中。

创建数组时，它会将*值*复制到数组中。稍后更改数组中的值不会更改变量的值。没有办法创建一种“引用数组”，其中数组元素与变量共享。（如马克的回答所示，有时在不安全的代码中可以这样做，但我真的建议不要这样做。）

但是请注意，如果数组和变量都引用同一个*可变对象*，则通过任一路径更改该对象将产生可通过另一个路径看到的更改：

```
StringBuilder x = new StringBuilder();
StringBuilder[] array = new StringBuilder[] { x };

array[0].Append("Foo");
Console.WriteLine(x); // Prints "Foo" 
```

不过，这与任何其他赋值没有什么不同 - 请注意，在上面的代码中，`Append`调用不会更改`x`数组元素或数组元素的值；它会更改这些值所引用的对象内的数据。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:32:05.567

虽然在字符串的情况下答案是否定的，但您可以使用值类型执行此操作：

```
class Program
{
  static unsafe void Main()
  {
    char A = 'A';
    char B = 'B';

    var O = new char*[] { &A, &B };

    *O[0] = 'C';

    System.Console.WriteLine(A + "," + B); // outputs C,B            
  }
} 
```

不安全的代码在 C# 中通常不受欢迎。所以，虽然这种事情是可能的，但我不建议这样做。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-02T14:39:09.120

您可能想要的是将字符串转换为具有属性的对象。然后，您可以将数组对象投射到您创建的此对象类型的特定键上，然后您可以再次设置其属性。

通过这种方式，您可以将数组中的内容都更改为原始变量，因此，它类似于将其视为具有引用值的数组。

> ```
> public class stringObject
> {
>   private string name;
>   public string Name { get { return name; } set { name = value; } }
> } 
> ```

```
stringObject A = new stringObject();
A.Name = "A";
stringObject B = new stringObject();
B.Name = "B";

object[] O = { A, B };

//change the array at key 0, and also changing our original variable
stringObject C = O[0] as stringObject;
C.Name = "C"; 
```

上面的代码不仅会改变 O[0] 中的内容，还会更新对象 A 中的内容。

可以在这里看到一个测试写入控制台的示例： [https ://dotnetfiddle.net/Yt25hy](https://dotnetfiddle.net/Yt25hy)

# jquery - 如何使用 jQuery 为嵌套对象动态分配 css 行高？

> ID：13256435
> 
> 赞同：1
> 
> 时间：2012-11-06T17:44:26.350
> 
> 标签：jquery, inheritance, nested, css

我正在开发一个水平的家谱。

**当前步骤**- 分配 CSS Line-Height 以根据嵌套内容垂直居中每个项目。

**问题**- 由于继承，嵌套项的 Line-Height 值呈指数增长。
我可以通过单独分配每个值来使其工作，但我正在寻找一个动态的解决方案。

> 在此处查看我的演示代码 - [http://jsfiddle.net/kirtcarter/TLJT9/](http://jsfiddle.net/kirtcarter/TLJT9/)

这是有问题的jQuery：

```
$(document).ready(function(){
    $("#familytree li").each(function(n) {
        var LineHeight = $(this).height()+'px';
        $(this).css({'line-height':LineHeight});
    });
}); 
```

**期望的结果：**
![在此处输入图像描述](../Images/f7f1ffdebbb540d31f9bb8fa5564c6cf.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:56:10.553

您应该按照以下方式做一些事情：

```
$(document).ready(function(){
    $(".item").each(function(n) {
        var newLineHeight = $(this).parent('.wrapper').height() +'px';
        $(this).css({'line-height':newLineHeight});
    });
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:28:43.447

您需要以不同的顺序遍历对象 - 从孩子开始。

此外，您可能希望`line-height`在检查高度之前重置为 1。

试试这个：

```
$($("#familytree li").get().reverse()).each(function(n) {
    var newLineHeight = $(this).height()+'px';
    //uncomment the following line and run to see issue
    $(this).css({'line-height':newLineHeight});
}); 
```

或者以更易读的方式：

```
var $elements = $("#familytree li");
var $elementsReversed = $($elements.get().reverse());
$elementsReversed.each(function(n) {
    var newLineHeight = $(this).height()+'px';
    //uncomment the following line and run to see issue
    $(this).css({'line-height':newLineHeight});
}); 
```

[演示在这里。](http://jsfiddle.net/jfrej/TLJT9/10/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:49:00.397

css

```
#familytree li{   line-height: 100%; } 
```

看起来每一个都有一个明确的高度，所以这应该工作

# objective-c - 在形状周围画一个笔触，核心图形

> ID：13256436
> 
> 赞同：2
> 
> 时间：2012-11-06T17:44:34.367
> 
> 标签：objective-c, ios, core-graphics, drawrect

我正在绘制如下形状：

```
- (void)drawRect:(CGRect)rect
{
    // Draw a cross rectagle
    CGContextRef    context     =   UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);
    CGContextMoveToPoint(context, 190, 0);
    CGContextAddLineToPoint(context, 220, 0);
    CGContextAddLineToPoint(context, 310, 90);
    CGContextAddLineToPoint(context, 310, 120);
    CGContextSetFillColorWithColor(context, [UIColor lightGrayColor].CGColor);
    CGContextFillPath(context);
    CGContextRestoreGState(context);
} 
```

我在下面得到一个浅色十字旗

![在此处输入图像描述](../Images/4790452992a7817b577d31876f75dc2f.png)

现在我想在我刚刚画的十字旗周围画一个笔划

我应该怎么做才能做到这一点。请就这个问题给我建议。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T17:51:15.537

肯定`CGContextDrawPath(context, kCGPathFillStroke);`是你所追求的

您可以使用以下方法调整图案和颜色：

```
CGContextSetStrokePattern
CGContextSetStrokeColor 
```

[https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CGContext/Reference/reference.html](https://developer.apple.com/library/ios/#documentation/graphicsimaging/reference/CGContext/Reference/reference.html)

因此，在您的情况下，假设您想要一个纯黑色笔划，您将拥有：

```
- (void)drawRect:(CGRect)rect
{
    CGContextRef    context     =   UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);

    CGContextSetLineWidth(context, 2.0);
    CGContextSetStrokeColorWithColor(context, [UIColor blackColor].CGColor);
    CGContextSetFillColorWithColor(context, [UIColor lightGrayColor].CGColor);

    CGContextMoveToPoint(context, 190, 0);
    CGContextAddLineToPoint(context, 220, 0);
    CGContextAddLineToPoint(context, 310, 90);
    CGContextAddLineToPoint(context, 310, 120);
    CGContextClosePath(context);

    CGContextDrawPath(context, kCGPathFillStroke);
    CGContextFillPath(context);

    CGContextRestoreGState(context);
} 
```

产生：

![让我想起了Kraftwork！ drawRect的结果：](../Images/e80ac5912f33369d15aa602a708968d0.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T19:43:17.663

```
- (void)drawRect:(CGRect)rect
{
    // Draw a cross rectagle
    CGContextRef    context     =   UIGraphicsGetCurrentContext();
    CGContextSaveGState(context);

    //New
    CGContextSetLineWidth(context, 2.0);

    CGContextMoveToPoint(context, 190, 0);
    CGContextAddLineToPoint(context, 220, 0);
    CGContextAddLineToPoint(context, 310, 90);
    CGContextAddLineToPoint(context, 310, 120);

    //New
    CGContextSetStrokeColorWithColor(context, [UIColor blackColor].CGColor);

    CGContextSetFillColorWithColor(context, [UIColor lightGrayColor].CGColor);
    CGContextFillPath(context);

    //New
    CGContextStrokePath(context);

    CGContextRestoreGState(context);
} 
```

@WDUK：花了几个小时弄清楚后，我知道为什么您的上述答案不起作用。原因是当你`CGContextFillPath`第一次这样做时，路径最终会被清除，然后你就不能再继续这样做`CGContextStrokePath`了。因此，为了做`CGContextFillPath`and `CGContextStrokePath`，我们必须做

> ```
> CGContextDrawPath(context,  kCGPathFillStroke); 
> ```

尝试后，我得到以下

![在此处输入图像描述](../Images/b764f9f46952df08bb678d5e870bc343.png)

# c# - C#中_bstr_t的等价物是什么

> ID：13256440
> 
> 赞同：2
> 
> 时间：2012-11-06T17:44:50.093
> 
> 标签：c#, c++, .net, com-interop

我正在开发一个需要将 C++ 代码转换为 C# 的项目。

我在代码中遇到`_bstr_t`了我想知道 C# 中的等效项。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T18:08:45.090

该类是[type](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221069%28v=vs.85%29.aspx)[`_bstr_t`的](http://msdn.microsoft.com/en-us/library/zthfhkd6.aspx)包装器。这是[OLE 自动化](http://en.wikipedia.org/wiki/OLE_Automation)中跨语言标准化的字符串。[`BSTR`](http://msdn.microsoft.com/en-us/library/windows/desktop/ms221069%28v=vs.85%29.aspx)

也就是说，.NET 中的等效类型是[`System.String`](http://msdn.microsoft.com/en-us/library/system.string.aspx).

关键是在与之交互时（或在 .NET 代码中为 COM 互操作定义接口），您需要使用[枚举](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.unmanagedtype.aspx)中[`MarshalAsAttribute`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshalasattribute.aspx)的值，如下所示：[`UnmanagedType`](http://msdn.microsoft.com/en-us/library/system.runtime.interopservices.unmanagedtype.aspx)`UnmanagedType.BStr`

```
// This is on an interface that is in unmanaged code.
public void DoSomething([MarshalAs(UnmanagedType.BStr] string myString); 
```

请注意，如果您的类实际上是`_bstr_t`在 COM 接口中公开 ; 那么您应该将其更改为公开`BSTR`; `_bstr_t`是一个帮助类，不打算跨接口边界公开。`BSTR`是为此而方法是`_bstr_t`用于处理`BSTR`实例的分配和使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:14:51.853

如果您只是*转换*代码，请使用`string`

如果您通过 PInvoke*与*C++ 代码交互，您*可能*会将参数声明为字符串并放在`[MarshalAs(UnmanagedType.BStr)]`参数声明的前面：

```
[DllImport("OldCLib.Dll")]
public static extern void PassBStr([MarshalAs(UnmanagedType.BStr)] string s); 
```

# asp.net - 母版页和性能

> ID：13256441
> 
> 赞同：0
> 
> 时间：2012-11-06T17:44:51.470
> 
> 标签：asp.net

母版页可以在加载时间的情况下提高应用程序的性能，或者只是为了重用设计并保持一致性。或者在内容页面和母版页的事件执行时有开销（花费时间）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:01:18.097

这是为了设计的重用和一致性。

包含母版页和其他控件以及所有依赖项的完整页面产生的开销非常小，可能只有 1-2 毫秒，因此没有理由谈论它。

我现在检查我最大的页面，有 87 个依赖项*，开始显示需要 70 毫秒，所有这些都是数据库成本，而不是因为依赖项。

[*] 一个母版，一页，其余自定义控件，我在临时文件夹中看到编译后的版本，有一行显示。

# ruby-on-rails - 设计为每个用户类型设置不同的根路径

> ID：13256445
> 
> 赞同：8
> 
> 时间：2012-11-06T17:44:58.133
> 
> 标签：ruby-on-rails, ruby-on-rails-3, devise

我创建了一个设计用户模型。有两种类型的用户：

*   顾客
*   行政

我已经完成了 bij 创建两个“正常”模型：客户和管理员。这两个模型继承自用户模型，如下所示：

```
class Customer < User 
```

有谁知道我如何为每种类型的用户设置根路径。我想要这样的东西：

```
authenticated :customer do
  root :to => "customer/dashboard#index"
end

authenticated :admin do
  root :to => "admin/dashboard#index"
end 
```

更新：

我已经解决了这个问题：

```
root :to => "pages#home", :constraints => lambda { |request|!request.env['warden'].user}
root :to => 'customer/dashboard#index', :constraints => lambda { |request| request.env['warden'].user.type == 'customer' }
root :to => 'admin/dashboard#index', :constraints => lambda { |request| request.env['warden'].user.type == 'admin' } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-06-28T17:37:41.790

虽然是一个老问题，但没有答案，它可能对其他人有用。

在 rails 3.2 中（我从来没有用任何更低的东西测试过它）你可以在你的 routes.rb 文件中做到这一点

```
authenticated :admin_user do
  root :to => "admin_main#index"
end 
```

然后将您的正常根路由进一步向下。

然而，这似乎在 Rails 4 中不起作用`Invalid route name, already in use: 'root' (ArgumentError)`（因为我刚刚发现并在遇到这个问题时正在寻找解决方案），如果我想办法在 Rails 4 中做到这一点，我会更新我的答案

编辑：

好的，所以对于 rails 4 来说，修复非常简单，但一开始就不是那么明显。您需要做的就是通过添加 as: 使第二个根路由成为命名路由，如下所示：

```
authenticated :admin_user do
  root :to => "admin_main#index", as: :admin_root
end 
```

这[在此处](https://github.com/plataformatec/devise/issues/2393#issuecomment-17298414)记录，但请注意，这似乎只是一个临时修复，因此将来可能会再次更改

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T17:55:37.080

你可以做的是有一个单一的根路径，比如说`home#index`，并在相应的控制器操作中根据他们的用户类型执行重定向。

例如：

```
def index
  if signed_in?
    if current_user.is_a_customer?
      #redirect to customer root
    elsif current_user.is_a_admin?
      #redirect to admin root
    end
  end
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-20T14:51:51.437

Using [after_sign_in_path_for](http://rubydoc.info/github/plataformatec/devise/master/Devise/Controllers/Helpers%3aafter_sign_in_path_for) should be appropriate. So add this to your `application_controller.rb`:

```
def after_sign_in_path_for(resource)
  if resource.type == 'customer'
    your_desired_customer_path
  else
    your_desired_admin_path
  end
end 
```

# c++ - 通过 c++ WinAPI 计算 MD5 哈希值

> ID：13256446
> 
> 赞同：7
> 
> 时间：2012-11-06T17:45:05.240
> 
> 标签：c++, windows, winapi, hash, md5

我的 C++ 应用程序需要计算 MD5 哈希值。目前，它是由 OpenSSL 完成的，我想使用 WinAPI - 以避免对外部库的依赖。

我写了这段代码：

```
HCRYPTPROV hCryptProv = NULL;
HCRYPTHASH hHash = NULL;
HCRYPTHASH hHexHash = NULL;
HASH HA1;
HASHHEX HA1HEX;
DWORD data = HASHLEN;

// Get a handle to a cryptography provider context.
if(!CryptAcquireContext(&hCryptProv, NULL, NULL, PROV_RSA_FULL, 0))
{
    goto err;
}

// Acquire a hash object handle.
if(!CryptCreateHash(hCryptProv, CALG_MD5, 0, 0, &hHash))
{
    goto err;
}

CryptHashData(hHash, (const BYTE *)str, strlen(str), 0); 
```

现在，奇怪的是，有时它运行良好，但在其他时候 CryptAcquireContext 返回 NTE_BAD_KEYSET 错误，根据 MSDN ：

> 无法打开密钥容器。此错误的常见原因是密钥容器不存在。要创建密钥容器，请使用 CRYPT_NEWKEYSET 标志调用 CryptAcquireContext。此错误代码还可以指示对现有密钥容器的访问被拒绝。密钥集创建者可以使用 CryptSetProvParam 授予对容器的访问权限。
> 
> 块引用

现在我的问题是：

1.  如果我调用 CryptSetProvParam，它到底做了什么？简单的应用程序更改操作系统设置是否正常？
2.  在 C++ 窗口中计算 MD5 是否有更简单的方法？

如果有人给我很好的建议，我将不胜感激。
谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-06T18:02:49.747

[因此，我在http://msdn.microsoft.com/en-us/library/aa382380%28VS.85%29.aspx](http://msdn.microsoft.com/en-us/library/aa382380%28VS.85%29.aspx)找到了一个可以满足您需求的示例

查看他们的代码，我看到的区别是这一行：

他们的：CryptAcquireContext(&hCryptProv, NULL, NULL, PROV_RSA_FULL, **CRYPT_VERIFYCONTEXT** )

你的：CryptAcquireContext(&hCryptProv, NULL, NULL, PROV_RSA_FULL, 0)

所以，阅读那个标志，我发现了这个信息：

CRYPT_VERIFYCONTEXT：此选项适用于使用临时密钥的应用程序，或不需要访问持久私钥的应用程序，例如仅执行散列、加密和数字签名验证的应用程序。只有创建签名或解密消息的应用程序才需要访问私钥。在大多数情况下，应设置此标志。

[http://msdn.microsoft.com/en-us/library/windows/desktop/aa379886%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379886%28v=vs.85%29.aspx)

因此，您似乎正在尝试访问您不需要的信息，并且请求被拒绝。因此，最好的选择是通过包含该标志来告诉 Windows 您不需要该信息。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T21:28:46.240

我喜欢使用[`PROV_RSA_AES`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa387447%28v=vs.85%29.aspx)and [`CRYPT_VERIFYCONTEXT`](http://msdn.microsoft.com/en-us/library/windows/desktop/aa379886%28v=vs.85%29.aspx)，因为大多数哈希值都受支持。

这是一个工作示例：

```
#include <Wincrypt.h>

enum HashType
{
  HashSha1, HashMd5, HashSha256
};

std::string GetHashText( const void * data, const size_t data_size, HashType hashType )
{
  HCRYPTPROV hProv = NULL;

  if ( ! CryptAcquireContext( &hProv, NULL, NULL, PROV_RSA_AES, CRYPT_VERIFYCONTEXT ) ) {
    return "";
  }

  BOOL hash_ok = FALSE;
  HCRYPTPROV hHash = NULL;
  switch ( hashType ) {
  case HashSha1 : hash_ok = CryptCreateHash( hProv, CALG_SHA1, 0, 0, &hHash ); break;
  case HashMd5 : hash_ok = CryptCreateHash( hProv, CALG_MD5, 0, 0, &hHash ); break;
  case HashSha256 : hash_ok = CryptCreateHash( hProv, CALG_SHA_256, 0, 0, &hHash ); break;
  }

  if ( ! hash_ok ) {
    CryptReleaseContext(hProv, 0);
    return "";
  }

  if ( ! CryptHashData( hHash, static_cast<const BYTE *>(data), data_size, 0 ) ) {
    CryptDestroyHash(hHash);
    CryptReleaseContext(hProv, 0);
    return "";
  }

  DWORD cbHashSize = 0, dwCount = sizeof(DWORD);
  if( ! CryptGetHashParam( hHash, HP_HASHSIZE, (BYTE *)&cbHashSize, &dwCount, 0 ) ) {
    CryptDestroyHash(hHash);
    CryptReleaseContext(hProv, 0);
    return "";
  }

  std::vector<BYTE> buffer( cbHashSize );
  if ( ! CryptGetHashParam( hHash, HP_HASHVAL, reinterpret_cast<BYTE*>( &buffer[0] ), &cbHashSize, 0) ) {
    CryptDestroyHash(hHash);
    CryptReleaseContext(hProv, 0);
    return "";
  }

  std::ostringstream oss;

  for ( std::vector<BYTE>::const_iterator iter = buffer.begin(); iter != buffer.end(); ++iter ) {
    oss.fill('0');
    oss.width(2);
    oss << std::hex << static_cast<const int>(*iter);
  }

  CryptDestroyHash(hHash);
  CryptReleaseContext(hProv, 0);
  return oss.str();
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-08-13T12:02:18.930

我得到了这个[链接](https://stackoverflow.com/questions/8702054/md5-crypto-api-returns-incorrect-hash-for-certain-plaintexts)

但我做了一些更改以在我这边运行此功能，希望它可能会有所帮助

```
char* HashMD5(char* data, DWORD *result)
{
    DWORD dwStatus = 0;
    DWORD cbHash = 16;
    int i = 0;
    HCRYPTPROV cryptProv;
    HCRYPTHASH cryptHash;
    BYTE hash[16];
    char *hex = "0123456789abcdef";
    char *strHash;
    strHash = (char*)malloc(500);
    memset(strHash, '\0', 500);
    if (!CryptAcquireContext(&cryptProv, NULL, MS_DEF_PROV, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))
    {
        dwStatus = GetLastError();
        printf("CryptAcquireContext failed: %d\n", dwStatus);
        *result = dwStatus;
        return NULL;
    }
    if (!CryptCreateHash(cryptProv, CALG_MD5, 0, 0, &cryptHash))
    {
        dwStatus = GetLastError();
        printf("CryptCreateHash failed: %d\n", dwStatus);
        CryptReleaseContext(cryptProv, 0);
        *result = dwStatus;
        return NULL;
    }
    if (!CryptHashData(cryptHash, (BYTE*)data, strlen(data), 0))
    {
        dwStatus = GetLastError();
        printf("CryptHashData failed: %d\n", dwStatus);
        CryptReleaseContext(cryptProv, 0);
        CryptDestroyHash(cryptHash);
        *result = dwStatus;
        return NULL;
    }
    if (!CryptGetHashParam(cryptHash, HP_HASHVAL, hash, &cbHash, 0))
    {
        dwStatus = GetLastError();
        printf("CryptGetHashParam failed: %d\n", dwStatus);
        CryptReleaseContext(cryptProv, 0);
        CryptDestroyHash(cryptHash);
        *result = dwStatus;
        return NULL;
    }
    for (i = 0; i < cbHash; i++)
    {
        strHash[i * 2] = hex[hash[i] >> 4];
        strHash[(i * 2) + 1] = hex[hash[i] & 0xF];
    }
    CryptDestroyHash(cryptHash);
    CryptReleaseContext(cryptProv, 0);
    return strHash;
} 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2018-09-04T13:58:53.537

可以创建以下“MD5.h”文件并使用简单的代码。

**主文件**

```
#include "md5.h"
int main()
{
MD5 md5;
puts( md5.digestString( "HELLO THERE I AM MD5!" ) ) ;
// print the digest for a binary file on disk.
puts( md5.digestFile( "C:\\WINDOWS\\notepad.exe" ) ) ;
return 0;
} 
```

**MD5.h**

```
#ifndef MD5_H
#define MD5_H
#include <stdio.h>
#include <string.h>

#pragma region MD5 defines
// Constants for MD5Transform routine.
#define S11 7
#define S12 12
#define S13 17
#define S14 22
#define S21 5
#define S22 9
#define S23 14
#define S24 20
#define S31 4
#define S32 11
#define S33 16
#define S34 23
#define S41 6
#define S42 10
#define S43 15
#define S44 21

static unsigned char PADDING[64] = {
    0x80, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
};

// F, G, H and I are basic MD5 functions.
#define F(x, y, z) (((x) & (y)) | ((~x) & (z)))
#define G(x, y, z) (((x) & (z)) | ((y) & (~z)))
#define H(x, y, z) ((x) ^ (y) ^ (z))
#define I(x, y, z) ((y) ^ ((x) | (~z)))

// ROTATE_LEFT rotates x left n bits.
#define ROTATE_LEFT(x, n) (((x) << (n)) | ((x) >> (32-(n))))

// FF, GG, HH, and II transformations for rounds 1, 2, 3, and 4.
// Rotation is separate from addition to prevent recomputation.
#define FF(a, b, c, d, x, s, ac) { \
  (a) += F ((b), (c), (d)) + (x) + (UINT4)(ac); \
  (a) = ROTATE_LEFT ((a), (s)); \
  (a) += (b); \
  }
#define GG(a, b, c, d, x, s, ac) { \
  (a) += G ((b), (c), (d)) + (x) + (UINT4)(ac); \
  (a) = ROTATE_LEFT ((a), (s)); \
  (a) += (b); \
      }
#define HH(a, b, c, d, x, s, ac) { \
  (a) += H ((b), (c), (d)) + (x) + (UINT4)(ac); \
  (a) = ROTATE_LEFT ((a), (s)); \
  (a) += (b); \
      }
#define II(a, b, c, d, x, s, ac) { \
  (a) += I ((b), (c), (d)) + (x) + (UINT4)(ac); \
  (a) = ROTATE_LEFT ((a), (s)); \
  (a) += (b); \
      }
#pragma endregion

typedef unsigned char BYTE;

// POINTER defines a generic pointer type
typedef unsigned char *POINTER;

// UINT2 defines a two byte word
typedef unsigned short int UINT2;

// UINT4 defines a four byte word
typedef unsigned long int UINT4;

// convenient object that wraps
// the C-functions for use in C++ only
class MD5
{
private:
    struct __context_t {
        UINT4 state[4];                                   /* state (ABCD) */
        UINT4 count[2];        /* number of bits, modulo 2^64 (lsb first) */
        unsigned char buffer[64];                         /* input buffer */
    } context;

#pragma region static helper functions
    // The core of the MD5 algorithm is here.
    // MD5 basic transformation. Transforms state based on block.
    static void MD5Transform(UINT4 state[4], unsigned char block[64])
    {
        UINT4 a = state[0], b = state[1], c = state[2], d = state[3], x[16];

        Decode(x, block, 64);

        /* Round 1 */
        FF(a, b, c, d, x[0], S11, 0xd76aa478); /* 1 */
        FF(d, a, b, c, x[1], S12, 0xe8c7b756); /* 2 */
        FF(c, d, a, b, x[2], S13, 0x242070db); /* 3 */
        FF(b, c, d, a, x[3], S14, 0xc1bdceee); /* 4 */
        FF(a, b, c, d, x[4], S11, 0xf57c0faf); /* 5 */
        FF(d, a, b, c, x[5], S12, 0x4787c62a); /* 6 */
        FF(c, d, a, b, x[6], S13, 0xa8304613); /* 7 */
        FF(b, c, d, a, x[7], S14, 0xfd469501); /* 8 */
        FF(a, b, c, d, x[8], S11, 0x698098d8); /* 9 */
        FF(d, a, b, c, x[9], S12, 0x8b44f7af); /* 10 */
        FF(c, d, a, b, x[10], S13, 0xffff5bb1); /* 11 */
        FF(b, c, d, a, x[11], S14, 0x895cd7be); /* 12 */
        FF(a, b, c, d, x[12], S11, 0x6b901122); /* 13 */
        FF(d, a, b, c, x[13], S12, 0xfd987193); /* 14 */
        FF(c, d, a, b, x[14], S13, 0xa679438e); /* 15 */
        FF(b, c, d, a, x[15], S14, 0x49b40821); /* 16 */

        /* Round 2 */
        GG(a, b, c, d, x[1], S21, 0xf61e2562); /* 17 */
        GG(d, a, b, c, x[6], S22, 0xc040b340); /* 18 */
        GG(c, d, a, b, x[11], S23, 0x265e5a51); /* 19 */
        GG(b, c, d, a, x[0], S24, 0xe9b6c7aa); /* 20 */
        GG(a, b, c, d, x[5], S21, 0xd62f105d); /* 21 */
        GG(d, a, b, c, x[10], S22, 0x2441453); /* 22 */
        GG(c, d, a, b, x[15], S23, 0xd8a1e681); /* 23 */
        GG(b, c, d, a, x[4], S24, 0xe7d3fbc8); /* 24 */
        GG(a, b, c, d, x[9], S21, 0x21e1cde6); /* 25 */
        GG(d, a, b, c, x[14], S22, 0xc33707d6); /* 26 */
        GG(c, d, a, b, x[3], S23, 0xf4d50d87); /* 27 */
        GG(b, c, d, a, x[8], S24, 0x455a14ed); /* 28 */
        GG(a, b, c, d, x[13], S21, 0xa9e3e905); /* 29 */
        GG(d, a, b, c, x[2], S22, 0xfcefa3f8); /* 30 */
        GG(c, d, a, b, x[7], S23, 0x676f02d9); /* 31 */
        GG(b, c, d, a, x[12], S24, 0x8d2a4c8a); /* 32 */

        /* Round 3 */
        HH(a, b, c, d, x[5], S31, 0xfffa3942); /* 33 */
        HH(d, a, b, c, x[8], S32, 0x8771f681); /* 34 */
        HH(c, d, a, b, x[11], S33, 0x6d9d6122); /* 35 */
        HH(b, c, d, a, x[14], S34, 0xfde5380c); /* 36 */
        HH(a, b, c, d, x[1], S31, 0xa4beea44); /* 37 */
        HH(d, a, b, c, x[4], S32, 0x4bdecfa9); /* 38 */
        HH(c, d, a, b, x[7], S33, 0xf6bb4b60); /* 39 */
        HH(b, c, d, a, x[10], S34, 0xbebfbc70); /* 40 */
        HH(a, b, c, d, x[13], S31, 0x289b7ec6); /* 41 */
        HH(d, a, b, c, x[0], S32, 0xeaa127fa); /* 42 */
        HH(c, d, a, b, x[3], S33, 0xd4ef3085); /* 43 */
        HH(b, c, d, a, x[6], S34, 0x4881d05); /* 44 */
        HH(a, b, c, d, x[9], S31, 0xd9d4d039); /* 45 */
        HH(d, a, b, c, x[12], S32, 0xe6db99e5); /* 46 */
        HH(c, d, a, b, x[15], S33, 0x1fa27cf8); /* 47 */
        HH(b, c, d, a, x[2], S34, 0xc4ac5665); /* 48 */

        /* Round 4 */
        II(a, b, c, d, x[0], S41, 0xf4292244); /* 49 */
        II(d, a, b, c, x[7], S42, 0x432aff97); /* 50 */
        II(c, d, a, b, x[14], S43, 0xab9423a7); /* 51 */
        II(b, c, d, a, x[5], S44, 0xfc93a039); /* 52 */
        II(a, b, c, d, x[12], S41, 0x655b59c3); /* 53 */
        II(d, a, b, c, x[3], S42, 0x8f0ccc92); /* 54 */
        II(c, d, a, b, x[10], S43, 0xffeff47d); /* 55 */
        II(b, c, d, a, x[1], S44, 0x85845dd1); /* 56 */
        II(a, b, c, d, x[8], S41, 0x6fa87e4f); /* 57 */
        II(d, a, b, c, x[15], S42, 0xfe2ce6e0); /* 58 */
        II(c, d, a, b, x[6], S43, 0xa3014314); /* 59 */
        II(b, c, d, a, x[13], S44, 0x4e0811a1); /* 60 */
        II(a, b, c, d, x[4], S41, 0xf7537e82); /* 61 */
        II(d, a, b, c, x[11], S42, 0xbd3af235); /* 62 */
        II(c, d, a, b, x[2], S43, 0x2ad7d2bb); /* 63 */
        II(b, c, d, a, x[9], S44, 0xeb86d391); /* 64 */

        state[0] += a;
        state[1] += b;
        state[2] += c;
        state[3] += d;

        // Zeroize sensitive information.
        memset((POINTER)x, 0, sizeof(x));
    }

    // Encodes input (UINT4) into output (unsigned char). Assumes len is
    // a multiple of 4.
    static void Encode(unsigned char *output, UINT4 *input, unsigned int len)
    {
        unsigned int i, j;

        for (i = 0, j = 0; j < len; i++, j += 4) {
            output[j] = (unsigned char)(input[i] & 0xff);
            output[j + 1] = (unsigned char)((input[i] >> 8) & 0xff);
            output[j + 2] = (unsigned char)((input[i] >> 16) & 0xff);
            output[j + 3] = (unsigned char)((input[i] >> 24) & 0xff);
        }
    }

    // Decodes input (unsigned char) into output (UINT4). Assumes len is
    // a multiple of 4.
    static void Decode(UINT4 *output, unsigned char *input, unsigned int len)
    {
        unsigned int i, j;

        for (i = 0, j = 0; j < len; i++, j += 4)
            output[i] = ((UINT4)input[j]) | (((UINT4)input[j + 1]) << 8) |
            (((UINT4)input[j + 2]) << 16) | (((UINT4)input[j + 3]) << 24);
    }
#pragma endregion

public:
    // MAIN FUNCTIONS
    MD5()
    {
        Init();
    }

    // MD5 initialization. Begins an MD5 operation, writing a new context.
    void Init()
    {
        context.count[0] = context.count[1] = 0;

        // Load magic initialization constants.
        context.state[0] = 0x67452301;
        context.state[1] = 0xefcdab89;
        context.state[2] = 0x98badcfe;
        context.state[3] = 0x10325476;
    }

    // MD5 block update operation. Continues an MD5 message-digest
    // operation, processing another message block, and updating the
    // context.
    void Update(
        unsigned char *input,   // input block
        unsigned int inputLen) // length of input block
    {
        unsigned int i, index, partLen;

        // Compute number of bytes mod 64
        index = (unsigned int)((context.count[0] >> 3) & 0x3F);

        // Update number of bits
        if ((context.count[0] += ((UINT4)inputLen << 3))
            < ((UINT4)inputLen << 3))
            context.count[1]++;
        context.count[1] += ((UINT4)inputLen >> 29);

        partLen = 64 - index;

        // Transform as many times as possible.
        if (inputLen >= partLen) {
            memcpy((POINTER)&context.buffer[index], (POINTER)input, partLen);
            MD5Transform(context.state, context.buffer);

            for (i = partLen; i + 63 < inputLen; i += 64)
                MD5Transform(context.state, &input[i]);

            index = 0;
        }
        else
            i = 0;

        /* Buffer remaining input */
        memcpy((POINTER)&context.buffer[index], (POINTER)&input[i], inputLen - i);
    }

    // MD5 finalization. Ends an MD5 message-digest operation, writing the
    // the message digest and zeroizing the context.
    // Writes to digestRaw
    void Final()
    {
        unsigned char bits[8];
        unsigned int index, padLen;

        // Save number of bits
        Encode(bits, context.count, 8);

        // Pad out to 56 mod 64.
        index = (unsigned int)((context.count[0] >> 3) & 0x3f);
        padLen = (index < 56) ? (56 - index) : (120 - index);
        Update(PADDING, padLen);

        // Append length (before padding)
        Update(bits, 8);

        // Store state in digest
        Encode(digestRaw, context.state, 16);

        // Zeroize sensitive information.
        memset((POINTER)&context, 0, sizeof(context));

        writeToString();
    }

    /// Buffer must be 32+1 (nul) = 33 chars long at least 
    void writeToString()
    {
        int pos;

        for (pos = 0; pos < 16; pos++)
            sprintf(digestChars + (pos * 2), "%02x", digestRaw[pos]);
    }

public:
    // an MD5 digest is a 16-byte number (32 hex digits)
    BYTE digestRaw[16];

    // This version of the digest is actually
    // a "printf'd" version of the digest.
    char digestChars[33];

    /// Load a file from disk and digest it
    // Digests a file and returns the result.
    char* digestFile(char *filename)
    {
        Init();

        FILE *file;

        int len;
        unsigned char buffer[1024];

        if ((file = fopen(filename, "rb")) == NULL)
            printf("%s can't be opened\n", filename);
        else
        {
            while (len = fread(buffer, 1, 1024, file))
                Update(buffer, len);
            Final();

            fclose(file);
        }

        return digestChars;
    }

    /// Digests a byte-array already in memory
    char* digestMemory(BYTE *memchunk, int len)
    {
        Init();
        Update(memchunk, len);
        Final();

        return digestChars;
    }

    // Digests a string and prints the result.
    char* digestString(char *string)
    {
        Init();
        Update((unsigned char*)string, strlen(string));
        Final();

        return digestChars;
    }
};

#endif 
```

# struts2 - 什么时候在 Struts 2 配置文件中使用 bean 标签？

> ID：13256452
> 
> 赞同：3
> 
> 时间：2012-11-06T17:45:25.317
> 
> 标签：struts2, struts-config

什么时候在使用 Struts 2的*struts.xml*配置文件中使用bean 标签？*Struts 2 配置文件struts.xml*中的动作类属性和 bean 标签有什么区别？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T02:47:09.107

有些地方有严格的工作分离，或者出于任何原因，您可以编辑视图 (JSP) 但不能编辑操作源。

在这种情况下，bean 标签变得最有用（否则我同意它不是特别有吸引力）。通常最容易在操作中生成视图所需的内容，并处理该数据以使其易于显示。因此，通常也不太需要附加、生成器、合并标签……但再一次，如果您考虑将内容人员与后端人员分开，这些标签将更频繁地使用。

从理论上讲，可以使用 bean 标签来访问诸如单例计数器之类的东西，但是如果视图以这种方式获取资源，那么它是一种组件化的思维方式（与基于动作的思维相反）。这也是为什么动作标签的使用也不是特别受欢迎的原因。如果您需要它，动作类应该是负责获取它（或拦截器，但肯定不是视图）的主要类，至少遵循基于动作的思维。

# c++ - 在 C++ 中将代码分解为几个小函数有什么好处？

> ID：13256453
> 
> 赞同：12
> 
> 时间：2012-11-06T17:45:30.240
> 
> 标签：c++, function, visual-c++, break

这只是一个一般性的帮助问题，我想知道在 C++ 应用程序的代码中拥有一组小函数与拥有一个包含解决问题所需的所有语句的长复杂函数相比有什么优势？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2012-11-06T17:55:49.747

**此助记符的**编辑信用归于 OP 中的评论者。****

 **将大功能分解为几个较小的功能可能会导致**谋杀**！在这种情况下，这可能是一件好事。:)

> **M-***可维护性*。_ 更小、更简单的功能更容易维护。
> 
> **U-***可理解*性。更简单的功能更容易理解。
> 
> **R** -*可重用性*。通过将常用操作移至单独的函数来鼓励代码重用。
> 
> **D-***可调试*性。调试简单函数比调试复杂函数更容易。
> 
> **E-***可扩展*性。代码重用和可维护性导致功能在 6 个月内更容易重构。
> 
> **R-***回归*。_ 重用和模块化导致更有效的回归测试。

* * *

将大功能分解为更小的功能有一些潜在的好处。按照他们从我脑子里掉出来的顺序：

1.  它鼓励代码重用。通常在大型函数中，您必须多次或多或少地做同样的事情。通过将其推广到单个通用函数，您可以在多个地方使用该代码块。

2.  代码重用可以通过将潜在的错误隔离到一个地方而不是几个地方来帮助提高健壮性和可维护性。

3.  当代码行数较少且对命名良好的函数进行大量调用时，更容易理解函数的语义。

4.  如果您反对具有多个返回点的函数，则将大函数分解可以帮助减少它们。

5.  它有助于识别和隔离（潜在）具有微妙数据依赖性的问题，否则这些问题很难被注意到。

然而，重要的是要注意，你把它的好与坏放在一起。分解大函数也有一些潜在的缺点：

1.  如果大功能以前有效，那么尝试对其进行模块化可能会产生缺陷。

2.  在多线程应用程序中，如果您的同步策略很微妙或完全错误，您可能会引入死锁和竞争条件。

3.  您可能会从函数调用中引入性能损失。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T17:47:59.197

更清晰的代码意味着更容易理解和维护。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:58:43.030

一个大的复杂功能就是：复杂。

将您的代码分成单独的函数使您的代码更易于使用。首先，当您查找执行特定任务的代码部分时，如果它在自己的函数中会更容易找到。

其次，对一个简单的函数进行更改要容易得多——您不需要了解大量代码来修改该函数。

此外，您可能会发现在另一个项目中重用该代码更容易，因为它被划分为更小的函数，这些函数可能用于更多目的，而不仅仅是单个大函数。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T18:06:09.210

将程序拆分为多个功能的优点是：

*   大多数程序都有一些在多个地方需要的基本功能。在单独的函数中拥有该功能意味着当使用相同的功能时会更加明显，并且您也只需修复一次它的问题。
*   通过将程序拆分为函数，您可以在代码中引入多层次的抽象。在主函数中，您可以大致了解程序的功能，调用树上的每一级都显示了如何实现某些方面的更多细节。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T18:06:41.453

在医疗设备系统中，将代码分解成更小的部分可以减少回归测试的需要，并将更改的影响缩小到更小的范围。

例如，假设我们在一个文件中有 3 个主题的 15 个函数。

如果我更改文件中的某个函数，则所有内容都需要重新构建和**重新测试**。
如果我将文件拆分为 3 个单独的文件，每个文件有 5 个函数，我只需要重新构建 5 个函数并重新测试 5 个函数。测试 5 个函数比 15 个函数需要更少的测试时间。

此外，当人员团队处理相同的代码库时，划分代码会降低两个或更多人处理同一文件的可能性。多人处理同一个文件会有很多冲突，例如在签入过程中一个人的代码被意外删除。**

# html - 块显示的 CSS 大纲错误

> ID：13256459
> 
> 赞同：1
> 
> 时间：2012-11-06T17:46:03.460
> 
> 标签：html, css

我正在尝试在 html 和 CSS 中创建一个组合框，其中每个项目都位于单独的行上，并且当您将鼠标悬停在其上时，每行都会亮起蓝色，就像在 Google 上一样。这很容易。我有一个`div`with links( `a`) in，每个链接`display:block`在 CSS 中使用来填充整个`div`. 然后我为悬停的那个添加了一个虚线轮廓，这就是事情变得奇怪的地方。

这是[jsFiddle](http://jsfiddle.net/vbR6K/)。

如果您将鼠标悬停在顶部链接上，您可以看到它正在工作，但其他链接似乎没有显示轮廓......向下的第二个链接在底部可见，但其他链接根本不存在。

任何帮助，将不胜感激。

编辑：我在 Windows XP 上使用 IE8

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T17:53:46.940

[http://www.w3schools.com/cssref/pr_outline.asp](http://www.w3schools.com/cssref/pr_outline.asp)

“注意：IE8 仅在指定了 !DOCTYPE 时才支持大纲属性。”

如果您在 IE9 中使用兼容模式进行测试，请确保您的文档模式符合 Internet Explorer 8 标准，而不是 Quirks。如果我将我的切换到 Quirks 模式，轮廓就会消失。

# c - 计算堆栈上的帧数

> ID：13256461
> 
> 赞同：4
> 
> 时间：2012-11-06T17:46:11.430
> 
> 标签：c, assembly, callstack

首先，我需要编写一个程序集（Intel IA-32）函数来返回调用者的帧指针的内容。我不认为我做对了，但我想出的是

```
pushl %ebp
movl %esp, %ebp
movl %eax, 4(ebp)
leave
ret 
```

但是，我应该在 ac 函数中使用它来计算堆栈上的帧数，我真的完全不确定它应该如何工作。我应该跳转到旧 ebp 中的值，然后再次调用该函数吗？任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:11:41.197

不，您不需要跳转到任何地方，但是一旦将帧指针复制到局部变量，您就可以将其视为链表。

```
 int mymagicfunction(int a, int b){

     int *c = asm_copy_ebp();
     int *d = c;
     while ( it_makes_sense ) {
           c=*c;
           dump_memory_between(c,d);
           d=c;
     } 
```

也许只有当 c 和 d 之间的距离很小时才有意义。

# java - 每15分钟运行一次java程序

> ID：13256462
> 
> 赞同：3
> 
> 时间：2012-11-06T17:46:27.107
> 
> 标签：java, multithreading

以下是我的程序中的示例代码，它查询数据库并将结果复制到目录中的不同文件中。我想要实现的是以下代码应该以 15 分钟的间隔运行，以便使用新数据更新文件。

```
public class CountryLogtoCSV {

static Connection con = null;
static ResultSet rs = null;

public static void main(String... argv)
{
FileWriter  filewriter=null;

File countryHits=new File("countryhits.csv");
filewriter=new FileWriter(countryHits);
query = "SELECT countryID, count(*) as total FROM mobileCountryLog"
        + " WHERE aHitType='ALL' AND aDate>'2012-11-06' GROUP BY countryID";

rs = Database.getResult(connection,query)
while (rs.next()) {

    //Writing result to File, FileWriter is used 
    filewriter.append(rs.getString("countryID"));
    filewriter.append(rs.getString("total"));
    filewriter.flush();
}   

File countryUnique=new File("countryunique.csv");
filewriter=new FileWriter(countryUnique);
query = "SELECT countryID, count(*) as total FROM mobileCountryLog"
        + " WHERE (aHitType='UNIQUE'AND aDate>'2012-11-06' GROUP BY countryID;

rs = Database.getResult(connection,query)
while (rs.next()) {

    //Writing Result to File, FileWriter is used
    filewriter.append(rs.getString("countryID"));
    filewriter.append(rs.getString("total"));
    filewriter.flush();
}   
rs.close(); 

}

} 
```

如何每 15 分钟运行一次这个 java 类？

谢谢，

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T17:49:43.683

如果您在 Unix 类型的操作系统上运行，那么您可以使用[cron](http://www.pantz.org/software/cron/croninfo.html)执行此操作：

将此添加到 crontab：

```
*/15 * * * * /yourpath-to-jdk/bin/java -cp yourclasspath CountryLogtoCSV 
```

您也可以使用 Executor 包在 Java 中执行此操作，但这意味着您必须始终运行该代码，否则它将无法执行。使用 cron，您的代码只需要每 15 分钟运行一次（或任何您设置的时间）。这意味着如果您的服务器重新启动或您的代码一次崩溃，它将在下一个周期再次尝试。更稳定，更易于管理。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T17:49:00.443

您可以为此使用[ScheduledExecutorService](http://docs.oracle.com/javase/6/docs/api/java/util/concurrent/ScheduledExecutorService.html)

这是一个例子：-

```
 import static java.util.concurrent.TimeUnit.*;
  class BeeperControl {
private final ScheduledExecutorService scheduler =
   Executors.newScheduledThreadPool(1);

public void beepForAnHour() {
    final Runnable beeper = new Runnable() {
            public void run() { System.out.println("beep"); }
        };
    final ScheduledFuture<?> beeperHandle =
        scheduler.scheduleAtFixedRate(beeper, 10, 10, SECONDS);
    scheduler.schedule(new Runnable() {
            public void run() { beeperHandle.cancel(true); }
        }, 60 * 60, SECONDS);
}
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T18:01:01.213

在你的情况下，你需要像这样捆绑你的代码。

```
import static java.util.concurrent.TimeUnit.*;
public class CountryLogtoCSV{
    private final ScheduledExecutorService scheduler =
       Executors.newScheduledThreadPool(1);

    public void logtoCSV() {
        final Runnable logger= new Runnable() {
                //You application logic as shown in the question
            };
        final ScheduledFuture<?> loggerHandle =
            scheduler.scheduleAtFixedRate(logger, 15, 15, MINUTES );

    //Incase you want to kill this after some time like 24 hours
        scheduler.schedule(new Runnable() {
                public void run() { loggerHandle.cancel(true); }
            }, 24, HOURS );
    }
 } 
```

希望这可以帮助

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T18:04:34.043

更好的是，您可以使用石英调度程序定期执行您的代码。尝试以下参考

[http://www.mkyong.com/java/quartz-scheduler-example/](http://www.mkyong.com/java/quartz-scheduler-example/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T19:07:55.270

如果您不想使用调度程序并且不想更改时间限制，最基本的解决方案是使用简单的线程，并休眠（15 * 90 * 1000）毫秒......如果你不这样做很有帮助和有效想使用第 3 方软件。

# wpf - WPF MVVM 应用程序中 UserControl 的多个实例

> ID：13256463
> 
> 赞同：0
> 
> 时间：2012-11-06T17:46:31.510
> 
> 标签：wpf, mvvm, user-controls

我有一个要求，即一个视图在运行时应该有多个实例，用于从 Xml 文件加载不同员工的数据，例如用于创建新员工详细信息和从 xml 文件加载的员工表单。我在谷歌上做了一些搜索，发现了一个非常有用的链接 [http://msdn.microsoft.com/en-us/magazine/dd419663.aspx](http://msdn.microsoft.com/en-us/magazine/dd419663.aspx)

对于 WPF MVVM 应用程序，当创建 ViewModel 的多个实例时，视图交互是完美的。我看到的唯一问题是当我使用 ie 放置文本框控件时，`TabControl` `TabItem`当我在选项卡控件中选择特定选项卡项时，视图的其他实例以相同的方式进行交互。如何防止应用程序这样做？是否有`TabItem`可以绑定的属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T09:49:56.567

如果任何人有类似的问题，解决方案是绑定`SelectedTabGridIndex`到`RadTabItem`.

```
private int _selectedTabGridIndex;
public int SelectedTabGridIndex
{
    get { return _selectedTabGridIndex; }
    set
    {
        if (value == _selectedTabGridIndex)
            return;

        _selectedTabGridIndex = value;
        base.OnPropertyChanged("SelectedTabGridIndex");
    }
} 
```

# ruby - Ruby 中的应用程序错误 Errno::ECONNREFUSED

> ID：13256468
> 
> 赞同：0
> 
> 时间：2012-11-06T17:47:14.253
> 
> 标签：ruby, sinatra, httprequest

`application error Errno::ECONNREFUSED`尝试发送 HTTP 请求时出现错误。我正在使用`Sinatra`，并在我的工作站上进行本地设置。这是错误：

```
Errno::ECONNREFUSED - Connection refused - Connection refused:
    org/jruby/ext/socket/RubyTCPSocket.java:124:in `initialize'
    org/jruby/RubyIO.java:876:in `new'
    org/jruby/ext/socket/RubyTCPSocket.java:154:in `open'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:560:in `connect'
    org/jruby/ext/Timeout.java:79:in `timeout'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:560:in `connect'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:553:in `do_start'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:542:in `start'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/net/http.rb:1035:in `request'
    ./ServiceRequest.rb:39:in `sendGetRequest'
    ./fileParser.rb:148:in `parseUrls'
    org/jruby/RubyHash.java:1181:in `each'
    ./fileParser.rb:138:in `parseUrls'
    org/jruby/RubyHash.java:1181:in `each'
    ./fileParser.rb:73:in `parseUrls'
    ./testmdxservices.rb:108:in `sendServiceRequest'
    ./testmdxservices.rb:80:in `getFile'
    TestServices.rb:71:in `TestServices'
    org/jruby/RubyProc.java:270:in `call'
    org/jruby/RubyMethod.java:117:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1264:in `compile!'
    org/jruby/RubyProc.java:270:in `call'
    org/jruby/RubyProc.java:220:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `route!'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:851:in `route_eval'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:835:in `route!'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:872:in `process_route'
    org/jruby/RubyKernel.java:1212:in `catch'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:870:in `process_route'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:834:in `route!'
    org/jruby/RubyArray.java:1620:in `each'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:833:in `route!'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:936:in `dispatch!'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `call!'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `invoke'
    org/jruby/RubyKernel.java:1212:in `catch'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:921:in `invoke'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:769:in `call!'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:755:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/path_traversal.rb:16:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/json_csrf.rb:17:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/base.rb:47:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-protection-1.2.0/lib/rack/protection/xss_header.rb:22:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/logger.rb:15:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/commonlogger.rb:20:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:136:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:129:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/head.rb:9:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/methodoverride.rb:21:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/showexceptions.rb:21:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:99:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1389:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1471:in `synchronize'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/sinatra-1.3.3/lib/sinatra/base.rb:1389:in `call'
    /Users/Banderson/.rvm/gems/jruby-1.6.8/gems/rack-1.4.1/lib/rack/handler/webrick.rb:59:in `service'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/webrick/httpserver.rb:104:in `service'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/webrick/httpserver.rb:65:in `run'
    /Users/Banderson/.rvm/rubies/jruby-1.6.8/lib/ruby/1.8/webrick/server.rb:173:in `start_thread'
    org/jruby/RubyProc.java:270:in `call'
    org/jruby/RubyProc.java:224:in `call' 
```

这是我的`sendGetRequest`：

```
def sendGetRequest(url, mMethod, key, rHash, headers, publicToken)

        mKey = String.new(key)
        nMethod =String.new(mMethod)

        nKey = mKey.concat(nMethod)

        uri = URI.parse(URI.encode(url))
        http = Net::HTTP.new(uri.host, uri.port)

        request = Net::HTTP::Get.new(uri.request_uri)
            headers.each do |hKey, hVal|
                request[hKey] = hVal
            end

        request["Authorization"] = publicToken

        if uri.scheme == "https"
            http.use_ssl = true 
            http.verify_mode = OpenSSL::SSL::VERIFY_NONE
            response = http.request(request)

        else

            response = http.request(request)
            response.body
            #response = Net::HTTP.get_response(uri)
        end

        if response.code == '200'

            code = response.code
            puts "#{mMethod}: - Test passed! Response code: #{response.code}" 
            rHash[nKey] = code

            #puts "#{rHash}"
        else
            code = response.code
            puts "#{mMethod}: - Test failed! Response code: #{response.code}"
            rHash[nKey] = code
            #puts "#{rHash}"

        end
        return rHash
    end 
```

我不确定我做错了什么来得到这个错误。如果有人可以提供帮助，那就太好了。如果您需要更多代码，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T19:44:19.493

事实证明，地址应该是：`https://www.myurl.more.com/service/something?expand=something(.(this))&that=something`而不是：`http://www.myurl.more.com/service/something?expand=something(.(this))&that=something`

# jquery - 延迟 jQuery 函数

> ID：13256476
> 
> 赞同：1
> 
> 时间：2012-11-06T17:47:35.467
> 
> 标签：jquery

我在一个页面上有三个图像滑块实例，它们应该连续淡出，一个接一个。我正在使用 innerfade.js

我想让它们在不同的时间开始，例如第一个在 2 秒后开始，第二个在 4 秒后开始，第三个在 6 秒后开始。因此，第一次转换需要在 2 秒后发生，但随后需要 6 秒，直到下一次渐变。

* * *

编辑：它们应该在页面加载时同时出现，然后一个接一个地淡出。

* * *

我不确定我是否能做到这一点。我试过使用 setTimeout 和 .delay，但我无法让它工作。原因可能是我不擅长 Javascript。但我会很感激这里的一些帮助。

这就是我来自的地方：

```
$(document).ready(
    function(){
        $('#header-img-1').innerfade2({
            animationtype: 'fade',
            speed: 750,
            timeout: 6000,
            type: 'random_start',
            containerheight: '1em'
        });

        $('#header-img-2').innerfade2({
            animationtype: 'fade',
            speed: 750,
            timeout: 6000,
            type: 'random_start',
            containerheight: '1em'
        });

        $('#header-img-3').innerfade2({
            animationtype: 'fade',
            speed: 750,
            timeout: 6000,
            type: 'random_start',
            containerheight: '1em'
        });
    }
); 
```

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T17:56:28.857

Here is a simple example of how to use setTimeout to achieve the kind of interaction you are looking for:

[http://jsfiddle.net/zFMjf/](http://jsfiddle.net/zFMjf/)

HTML

```
<div id="example1" class="con orange" style="display:none;">Example 1</div>
<div id="example2" class="con lime" style="display:none;">Example 2</div>
<div id="example3" class="con yellow" style="display:none;">Example 3</div>​ 
```

CSS

```
.con { width:200px; line-height:60px; margin:0 0 20px 0; }
.orange { background:orange; }
.lime { background:lime ; }
.yellow { background:yellow ; } 
```

jQUERY

```
setTimeout(function(){
   $('#example1').slideToggle();
},2000);

setTimeout(function(){  
    $('#example2').slideToggle();
},4000);

setTimeout(function(){  
    $('#example3').slideToggle();
},6000);​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T17:54:44.617

```
$(document).ready(function() {
    var numb = [1,2,3];

    $.each(numb, function(i,elm) {
        setTimeout(function() {
            $('#header-img-'+numb[i]).innerfade2({
                animationtype: 'fade',
                speed: 750,
                timeout: 6000,
                type: 'random_start',
                containerheight: '1em'
            });
        },numb[i]*2000);
    });
}); 
```

[**小提琴**](http://jsfiddle.net/xXSb5/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T17:55:06.723

试试下面的方法，我根据一些假设对它进行了一些优化。但这会给你一个想法。让我知道它是否不同。

```
$(document).ready(function() {

        var innerFadeOpt = {
            animationtype: 'fade',
            speed: 750,
            timeout: 6000,
            type: 'random_start',
            containerheight: '1em'
        };

        var ptr = 0, headerImgs = ['#header-img-1', '#header-img-2', '#header-img-3'];

        var timer = setInterval (function () {
           if (ptr == headerImgs.length - 1) {
              clearInterval(timer);
              return;
           }

           $(headerImgs[ptr++]).innerfade2(innerFadeOpt);
        }, 2000);
    }
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:51:18.173

`setTimeout`你是对的，你可以使用和`delay`函数延迟脚本执行。

这是一个`setTimeout`使用示例：

```
setTimeout(function(){
        $('#header-img-2').innerfade2({
            animationtype: 'fade',
            speed: 750,
            timeout: 6000,
            type: 'random_start',
            containerheight: '1em'
        });
    },2000 /*2seconds*/); 
```

关于`.delay()`你应该这样编码：

```
$('#header-img-2').delay(2000).innerfade2({
    animationtype: 'fade',
    speed: 750,
    timeout: 6000,
    type: 'random_start',
    containerheight: '1em'
}); 
```

# batch-file - DOS 批量重命名文件

> ID：13256477
> 
> 赞同：1
> 
> 时间：2012-11-06T17:47:38.280
> 
> 标签：batch-file, dos, file-rename, zero-pad

我有一个名称为结构化的大型文件集`string_int_int_int_string.extension`，并希望在第二个 int 上使用左零填充将它们批量重命名为 7 位。

示例：重命名`stringA_1_2_3_stringB.jpg`为`stringA_1_0000002_3_stringB.jpg`.

我在[这里](https://superuser.com/questions/403183/how-to-rename-multiple-files-in-multiple-folders-with-1-command/403185#403185)、[这里](https://stackoverflow.com/questions/1025470/batch-rename-file-extensions-including-subdirectories)和[这里](https://stackoverflow.com/questions/5417979/batch-rename-sequential-files-by-padding-with-zeroes)看到了一些有用的帖子，但还没有完全做到。

这是我到目前为止所拥有的（当然不工作）：

```
dir /b *.* >temp.txt

for /f "tokens=%%1,%%2,%%3,%%4,%%5 delims=_" %x in (temp.txt) do (
    setlocal enabledelayedexpansion
    set PAD=000000%%k
    set PAD=!PAD:~7!
    ren "%%i_%%j_%%k_%%l_%%m" %%i_%%j_%PAD%_%%l_%%m
) 
```

我特别想使用批处理文件而不是其他语言或工具来执行此操作。（我知道那里有各种重命名工具。）

任何帮助都是最受欢迎的！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:20:14.200

```
setlocal EnableDelayedExpansion
dir /b *.* >temp.txt
for /F "tokens=1-5 delims=_" %%a in (temp.txt) do (
   set PAD=000000%%c
   set PAD=!PAD:~-7!
   ren "%%a_%%b_%%c_%%d_%%e"  "%%a_%%b_!PAD!_%%d_%%e"
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:53:36.363

我使用 FINDSTR 过滤掉与指定模式不匹配的文件名。总共需要 4 个标记 - 前 3 个，然后是文件名的其余部分。

```
@echo off
setlocal disableDelayedExpansion
for /f "tokens=1,2,3* delims=_" %%A in (
  'dir /b /a-d * ^|findstr /r "^[^_]*_[0-9]*_[0-9]*_[0-9]*_[^_]"'
) do (
  set "mid=%%C"
  set "pad=0000000%%C"
  set "start=%%A_%%B"
  set "end=%%D"
  setlocal enableDelayedExpansion
  echo ren "!start!_!mid!_!end!" "!start!_!pad:~-7!_!end!"
  endlocal
) 
```

# wpf - VB.net WPF DataGrid ObservableCollection Binding 属性更新

> ID：13256478
> 
> 赞同：0
> 
> 时间：2012-11-06T17:47:39.040
> 
> 标签：wpf, vb.net, datagrid, observablecollection

我在 Visual Studio 2010 Express 中使用 VB.NET 和 WPF。

目前，我有：

*   一个名为*downloadListDG*的 DataGrid 。这有一个列，它是一个包含图像的模板。
*   自定义*DownloadListItem*类的*ObservableCollection 。*
**   此*DownloadListItem*有一个公共属性，它是另一个自定义类。*   这个类有一个私有的 dim 是一个 StateType（一个自定义枚举）和一个公共的只读属性，它根据 StateType 是什么返回一个字符串（如果你好奇的话，实际上是一个图像 URI）。*   *DownloadListItem*还有一个公共属性，它只返回 StateType（这仅用于绑定目的）*

 *我的问题是，每当 StateType 更改时，DataGrid 中的图像列都不会更改。我一直在尝试使用*IPropertyChangedNofity*，但没有任何改变，所以要么我使用不正确，要么我需要使用另一种方法。

```
Implements INotifyPropertyChanged

Public Event PropertyChanged As PropertyChangedEventHandler Implements INotifyPropertyChanged.PropertyChanged

AddHandler ControllerRef.StateChanged, AddressOf StateChangeHandler

Private Sub StateChangeHandler(NewState As State)
    MsgBox(NewState)
    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs("CurrentState"))
End Sub 
```

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T21:05:35.203

确保 PropertyChanged 事件通知 UI 您绑定的属性名称，而不是触发更改的属性。例子：

```
Imports System.ComponentModel 
```

公共类 DownloadListItem ：实现 INotifyPropertyChanged

```
Friend Enum StateEnum
    State1 = 0
    State2 = 1
End Enum

Private _CurrentState As StateEnum

Private Sub ChangeEnumValue(NewValue As StateEnum)
    _CurrentState = NewValue
    OnPropertyChanged("ImageURI")
End Sub

Public ReadOnly Property ImageURI As String
    Get
        ' TODO: Implement conditional logic to return proper value based on CurrentState Enum
    End Get
End Property

Public Event PropertyChanged(sender As Object, e As PropertyChangedEventArgs) Implements INotifyPropertyChanged.PropertyChanged

Protected Sub OnPropertyChanged(PropertyName As String)
    RaiseEvent PropertyChanged(Me, New PropertyChangedEventArgs(PropertyName))
End Sub 
```

结束类*

# numpy - numpy 数组中的 if 语句总是需要向量化

> ID：13256482
> 
> 赞同：-2
> 
> 时间：2012-11-06T17:47:50.060
> 
> 标签：numpy, vectorization

这个函数中的 if 语句，在没有向量化的情况下工作吗？

```
def K(T0,z,v):

    for i in range(len(T0)-1):
        GDens[i+1]=(Dens[i+1]-Dens[i])/(z[i+1]-z[i])

    for i in range(len(T0)):
        B[i]=(((ws/Dens0)*k0)**2)*np.exp(-2*alfa*z[i])-((g/Dens0)*GDens[i])

    for i in range(len(T0)):
        if B[i]>0:
            kz[i]=((0.05*h1)**2)*np.sqrt(B[i])+kmin
        else:
            kz[i]=kmin
    kfinal=kz
    return kfinal 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:23:33.157

我不确定你在问什么，但这就是你如何向量化这段代码：

```
 GDens = np.zeros_like(z)
 GDens[:-1] = (Dens[1:] - Dens[:-1]) / (z[1:] - z[:-1])
 B = (((ws/Dens0)*k0)**2)*np.exp(-2*alfa*z)-((g/Dens0)*GDens)
 kz = np.where(B > 0, ((0.05*h1)**2)*np.sqrt(B)+kmin, kmin) 
```

# ruby-on-rails-3 - 子域约束（Rails 3）使本地服务器（瘦）如此缓慢

> ID：13256485
> 
> 赞同：7
> 
> 时间：2012-11-06T17:48:01.773
> 
> 标签：ruby-on-rails-3, routing, subdomain, localhost, thin

我最近在我的 Rails 路由文件中添加了一个子域约束

```
constraints(:subdomain => 'new') do
  devise_for :customers do 
    get "/customers/sign_up" => "registrations#new"
    post "/customers" => "registrations#create"
    put "/customers/:id" => "registrations#update"
  end
  match '/' => 'roxy#index'
  namespace :roxy, :path => '/' do
    resources :customers
    resources :surveys
  end
end 
```

为了在本地测试子域路由约束，我将这一行添加到我的 hosts 文件中。

```
127.0.0.1       new.localhost.local 
```

现在，我在浏览器中通过 URL new.localhost.local:3000 测试我的应用程序。加载每个页面大约需要 10 - 15 秒，这非常慢。如果我删除子域约束并转到 127.0.0.1:3000，那么一切都会变得又快又快。

我究竟做错了什么？我是 Rails 新手，所以请告诉我是否有更好的方法在 Rails 中进行子域路由，或者是否有需要配置的设置。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T19:56:11.470

弄清楚了。这与 Rails 或子域或瘦无关。事实证明，与其他 unixy-things 不同，OS X 为 mDNS 功能保留了 .local TLD。对于每个页面，在加载我的应用程序之前，DNS 解析都会超时。所以我只是将我的 /etc/hosts 文件更改为

```
127.0.0.1    new.localhost.dev 
```

现在一切都很好。

阅读更多：[http ://www.justincarmony.com/blog/2011/07/27/mac-os-x-lion-etc-hosts-bugs-and-dns-resolution/](http://www.justincarmony.com/blog/2011/07/27/mac-os-x-lion-etc-hosts-bugs-and-dns-resolution/)

# javascript - 在javascript中合并

> ID：13256489
> 
> 赞同：0
> 
> 时间：2012-11-06T17:48:08.623
> 
> 标签：javascript, jquery, backbone.js, underscore.js

我正在使用[jQuery](https://jquery.com/)、[Backbone](http://backbonejs.org/)（和[下划线](http://underscorejs.org/)）和[RequireJS](http://requirejs.org/)。

我有这个代码：

```
var products = _.map(items, function(item) {
    return new ProductModel({
        title: item.product.title,
        description: item.product.description,
        link: item.product.link,
        'image-src': item.product.images[0].link,
        'image-height': item.product.images[0].height,
        'image-width': item.product.images[0].width
    });
}); 
```

不幸的是，一切都可能是`null`。我的意思是`item, item.product, item.product.images, item.product.images[0]`，等等可能是`null`s。

我正在寻找类似“合并”的东西：

1.  将知道如何处理`null`s 并且不会为`item.product`if `item`is抛出异常`null`。
2.  如果存在`null`.

有这样的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T17:50:35.093

您可以使用 boolean`&&`并依靠[short-circuiting](http://en.wikipedia.org/wiki/Short-circuit_evaluation)：

```
...
'image_src': item && item.product && item.product.images && item.product.images[0] && item.product.images[0].link,
'image_height': item && item.product && item.product.images && item.product.images[0] && item.product.images[0].height,
... 
```

更有可能的是，您不想在这么多行上执行相同的测试。我会存储您的返回值，并将其各种属性设置为一些合理的默认值，然后有条件地添加实际值（如果您的值`item.product.images[0]`不为空）：

```
var returnObject = { /* default values here */ }, product, image;

if (product = item && item.product) {
    returnObject.title = product.title,
    returnObject.description = product.description,
    returnObject.link = product.link
};

if (image = product && product.images && product.images[0]) {
    returnObject['image-src'] = image.link;
    returnObject['image-height'] = image.height;
    returnObject['image-width'] = image.width;
}

return returnObject; 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T18:02:52.617

我会先`.filter`出空产品：

```
var goodItems = _.filter(items, function(item) {
     return 'product' in item;
}); 
```

`product`如果 中的对象不存在，则通过提供一个空对象来简化图像测试：

```
var products = _.map(goodItems, function(item) {
    var product = item.product;
    var img = (product.images && product.images[0]) || {};
    return new ProductModel({
        title: product.title,
        description: product.description,
        link: product.link,
        'image-src': img.link,
        'image-height': img.height,
        'image-width': img.width
    });
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:08:49.687

如果你想要 s 的默认值`null`，那么你可以创建一个这样的辅助函数：

```
var coalesce = function(obj, path, defaultValue) {
  while(obj != null && path.length) {
    obj = obj[path.shift()];
  }
  return (obj == null ? defaultValue : obj);
}; 
```

您可以按如下方式使用它：

```
coalesce(item, ["product", "title"], "Default title");
coalesce(item, ["product", "images", 0, "link"], "Default image link"); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T18:13:48.820

不确定是否有类似的东西，但我认为您可以创建和使用如下自定义函数：

```
 return new ProductModel({
             title: getPorductAttribute(item,'title'),
             description: getPorductAttribute(item,'description'),
             link: getPorductAttribute(item, 'link'),
             'image-src': getImageAttirbute(item,0,'link'),
             'image-height': getImageAttirbute(item,0,'height'),
             'image-width': getImageAttirbute(item,0,'width')
            });

  function getPorductAttribute(item, attributeName){
       if(!(item && item.product)) 
           return defaultValue;
       return item.product.getAttribute(attributeName);
   }

  function getImageAttirbute(item, index, attributeName){
       if(!(item && item.product && item.product.images)) 
           return defaultValue;
       return item.product.images[index].getAttribute(attributeName);
   } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-08-27T12:33:12.843

您可以使用逻辑或运算符“||” 合并，如此处所述...

[http://pietschsoft.com/post/2008/10/14/JavaScript-Gem-Null-Coalescing-using-the-OR-Operator](http://pietschsoft.com/post/2008/10/14/JavaScript-Gem-Null-Coalescing-using-the-OR-Operator)

> var something = 也许没有 || 0;

适用于 null 或 undefined。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-12-15T10:48:20.487

如果您不确定对象实际上是什么。你可以做旧的尝试捕捉......

```
var testObject = {
  alpha: {
    beta: null
  },
  gama: {
    delta: null
  }  
};

try {
    console.log(testObject.alpha.beta.gama.delta);
} catch(err) {    
    alert(err.message);
}
```

这不会破坏您的应用程序，因为错误未`throw`编辑。你可以在 catch 语句中做的是用缺少的默认值填充你的对象。

# c# - C# 字符串值中的比较能否返回布尔值。例如。"5 < 10" 返回真

> ID：13256493
> 
> 赞同：-2
> 
> 时间：2012-11-06T17:48:27.730
> 
> 标签：c#, string, comparison, boolean

有没有办法在字符串值中进行比较可以返回一个`Boolean`值。例子。If (5 > 5000) 显然会返回一个错误值。但我想做的是让“5 > 5000”返回一个错误值。

例子。

```
string com = "5 > 10"; 
```

那么有没有办法让这个`com`变量返回一个`false`值，就好像它是整数之间的比较一样。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T18:10:34.783

没有内置方法，但[NCalc](http://ncalc.codeplex.com/)可以在这里提供帮助

```
NCalc.Expression expr = new NCalc.Expression("5>10");
bool b = (bool)expr.Evaluate(); 
```

你甚至可以使用参数

```
NCalc.Expression expr = new NCalc.Expression("a<b");

expr.EvaluateParameter += (name, args) =>
  {
      if (name == "a") args.Result = 5;
      if (name == "b") args.Result = 10;
  };
bool b = (bool)expr.Evaluate(); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T17:53:39.347

没有内置的方法可以做到这一点。

虽然有几种方法可以解决这个问题，但一种是自己简单地解析文本。我在文章[AC# Expression Evaluator](http://www.blackbeltcoder.com/Articles/algorithms/a-c-expression-evaluator)中提供的代码中执行了此操作。您可能想查看该代码。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-06T18:08:38.540

不，这不能直接完成。您应该编写自己的类或扩展 String 类。要处理诸如“5 < 10”之类的字符串，您需要自己的方法。

您应该在字符串中搜索指示比较的符号，例如“<”、“==”等，然后将其拆分并执行比较。

基本上：自己做是唯一的方法，但你可以尝试以一种优雅的方式来做。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-11-06T17:54:10.640

不是直接的，本身（没有不安全的 Javascript eval-execute-my-data hack），但您可以尝试自己解析它，具体取决于您想要接受的表达式的复杂程度。例如，这应该适用于您拥有的字符串：

```
var arr = com.Split('>').Select(x=>int.Parse(x.Trim())).ToArray();
return arr[0] > arr[1]; 
```

您还可以使用正则表达式来变得更复杂（未经测试，但它应该可以工作）：

```
var r = new Regex(@"(\d+)\b*(<|>|=|<=|>=)\b*(\d+)")
var match = r.Match(com);
if(match.Success)
{
    var a = int.Parse(match.Captures[0]);
    var b = int.Parse(match.Captures[2]);

    switch(match.Captures[1])
    {
         case "<":
             return a < b;
         case "=":
             return a = b;
         case ">":
             return a > b;
         case "<=":
             return a <= b;
         case "<=":
             return a >= b;
    }
}

//uh-oh
throw new ArgumentException("com"); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-11-06T17:50:43.343

简短的回答：没有。

长答案：随意解析字符串，寻找 > < 和 =。按空格分割，解析整数然后评估。如果您希望它也可以与括号一起使用，它可能会变得更加困难......

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-06T18:25:57.270

考虑使用[FLEE](http://flee.codeplex.com/)：

Flee 是 .NET 框架的表达式解析器和求值器。它允许您在运行时计算字符串表达式的值，例如 sqrt(a^2 + b^2)。它使用自定义编译器、强类型表达式语言和轻量级代码生成器将表达式直接编译为 IL。这意味着表达式评估非常快速和高效。试试这个演示，它可以让你根据表情生成图像，然后自己看看。

使用[FLEE](http://flee.codeplex.com/)，您可以使用以下方法轻松完成此操作：

```
 var con = new ExpressionContext();
        const string com = @"5 > 5000";
        var comparison = con.CompileDynamic(com);
        var result = comparison.Evaluate();
        MessageBox.Show(result.ToString()); 
```

HTH...

# scrapy - 来自管道的 Scrapy 关闭爬虫

> ID：13256494
> 
> 赞同：0
> 
> 时间：2012-11-06T17:48:30.417
> 
> 标签：scrapy

有没有办法从管道中关闭爬虫？我的管道处理 url 并将它们添加到列表中。当列表达到指定数量时，我想关闭爬虫。我知道，`raise CloseSpider()`但它似乎只在从蜘蛛调用时才有效。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T23:49:18.847

是的，有可能。您可以调用 Crawler.engine.close_spider(spider_name, reason)。

[CloseSpider 扩展中](https://github.com/scrapy/scrapy/blob/aa0e02dc54765342d970304cefa3207f8e67d736/scrapy/contrib/closespider.py#L63)有一个例子

# yaml-cpp - 无需在 YAML-cpp 中迭代即可获取密钥

> ID：13256496
> 
> 赞同：2
> 
> 时间：2012-11-06T17:48:32.567
> 
> 标签：yaml-cpp

有没有一种简单的方法可以在不迭代的情况下使用 YAML-cpp 获取地图中的密钥？我在说明中看到我可以使用`first()`YAML-cpp 迭代器类的方法，但我不需要实际迭代。我有一个可以通过缩进级别识别的键，但是如果该键不是已知列表之一，我现在需要做的是抛出异常。我的代码目前如下所示：

```
std::string key;
if (doc.FindValue("goodKey")
{
    // do stuff
    key = "goodKey";
} else if (doc.FindValue("alsoGoodKey") {
    // do stuff
    key = "alsoGoodKey";
} else throw (std::runtime_error("unrecognized key"); 

// made it this far, now let's continue parsing
doc[key]["otherThing"] >> otherThingVar;
// etc. 
```

看，我需要密钥字符串才能继续解析，因为 otherThing 在 YAML 文件中的 goodKey 下。这很好用，但我想告诉用户无法识别的密钥是什么。不过，我不知道如何访问它。我在头文件中看不到任何赋予我该值的函数。我如何得到它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:54:00.073

不一定有一个“无法识别的密钥”。例如，您的 YAML 文件可能如下所示：

```
someKey: [blah]
someOtherKey: [blah] 
```

或者它甚至可能是空的，例如`{}`. 在前一种情况下，你想要哪一个？在后一种情况下，没有键。

您正在询问如何“获取地图中的密钥”，但地图可以有零个或多个密钥。

作为旁注，您可以使用 的实际结果来简化其中的一些操作`FindValue`，假设您实际上并不需要您抓取的密钥的名称。例如：

```
const YAML::Node *pNode = doc.FindValue("goodKey");
if(!pNode)
   pNode = doc.FindValue("alsoGoodKey");
if(!pNode)
   throw std::runtime_error("unrecognized key");

(*pNode)["otherThing"] >> otherThingVar;
// etc 
```

# iphone - 使用核心运动无法在后台获取正确的加速度计数据

> ID：13256500
> 
> 赞同：1
> 
> 时间：2012-11-06T17:48:59.587
> 
> 标签：iphone, objective-c, ios, accelerometer, core-motion

我正在使用 coremotion 在后台实现加速度计数据。我在后台获取数据，但 x、y、z 坐标的值不正确。这是我的代码。

```
- (void)applicationWillResignActive:(UIApplication *)application
{

    [locationManager stopMonitoringSignificantLocationChanges];
    [locationManager startUpdatingLocation];

}

-(void) locationManager:(CLLocationManager *)manager didUpdateToLocation:(CLLocation *)newLocation fromLocation:(CLLocation *)oldLocation
{
        BOOL isInBackground = NO;
        if ([UIApplication sharedApplication].applicationState == UIApplicationStateBackground)
        {
            isInBackground = YES;
        }

        if (isInBackground)
        {
            [self sendBackgroundLocationToServer:newLocation];
        }

}

-(void) sendBackgroundLocationToServer:(CLLocation *)location
{

        UIApplication *application = [UIApplication sharedApplication];//Get the shared application instance

        __block UIBackgroundTaskIdentifier background_task; //Create a task object
        background_task = [application beginBackgroundTaskWithExpirationHandler: ^ {

            NSAssert(background_task == UIBackgroundTaskInvalid, nil);

            [application endBackgroundTask: background_task]; //Tell the system that we are done with the tasks

        }];

        NSOperationQueue *theQueue = [[NSOperationQueue alloc] init];

        CMAccelerometerData *_returnedData = [[CMAccelerometerData alloc] init];
        CMMotionManager  *_motionManager = [[CMMotionManager alloc] init];

        [_motionManager startAccelerometerUpdatesToQueue:theQueue withHandler:^(CMAccelerometerData *accelerometerData, NSError *error) {

            int x = _motionManager.accelerometerData.acceleration.x;
            int y = _motionManager.accelerometerData.acceleration.y;
            int z = _motionManager.accelerometerData.acceleration.z;

            NSLog(@"X: %i, Y: %i, z: %i", x, y,z);

            //[self changeFilter:[HighpassFilter class]];
            //[filter addAcceleration:acceleration];
            const float violence = 1.20;
            float magnitudeOfAcceleration = sqrt (x*x + y*y + z*z);

            //float magnitudeOfAcceleration = sqrt (filter.x*filter.x + filter.y * filter.y + filter.z * filter.z);
            BOOL shake = magnitudeOfAcceleration > violence;
            if (shake)
            {
                step++;
                NSLog(@"---------------");
            }
            NSUserDefaults *defalut = [NSUserDefaults standardUserDefaults];
            NSLog(@"steps in background: %i",step );

            if([defalut objectForKey:@"Stepscounting"]){
                int f = [[defalut objectForKey:@"Stepscounting"] intValue];
                step+=f;
            }
            [defalut setObject:[NSString stringWithFormat:@"%i",step] forKey:@"Stepscounting"];

        }];

      // AFTER ALL THE UPDATES, close the task

      if (background_task != UIBackgroundTaskInvalid)
      {
          [[UIApplication sharedApplication] endBackgroundTask:background_task];
           background_task = UIBackgroundTaskInvalid;
      }
} 
```

使用这个我得到坐标，但值不正确。谁能告诉我这背后的原因是什么。我不明白为什么会这样。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-01T10:01:23.927

也许你应该为你的 x,y,z 使用 float 而不是 int。

# javascript - selectedIndex 在 IE 中未定义

> ID：13256505
> 
> 赞同：2
> 
> 时间：2012-11-06T17:49:22.127
> 
> 标签：javascript, internet-explorer, selectedindex

我看到了一些与我的问题类似的帖子并尝试了提供的解决方案，但我仍然遇到 IE8 和 IE9 以及“selectedIndex”的问题。此代码将我的变量**answerSubmitted**返回为“未定义”：

```
var answerSubmitted = document.getElementById("DropDown-Answers").selectedIndex; 
```

以上在所有其他浏览器中都能完美运行。基于此处的另一篇文章，我也尝试了这个：

```
var answerSubmitted = document.getElementById("DropDown-Answers").value; 
```

仍然是相同的结果 - 在其他地方有效，但在 IE8 或 IE9 中无效。我已经验证 IE 通过其 ID 识别该特定元素。

这里有什么指导吗？

**更多信息：** 我通过循环并在选项和/选项标签之间添加变量文本来动态创建下拉菜单，如下所示（请注意，'tempRandom' 是每次通过循环更新的随机数）：

```
tempMenuText = tempMenuText + "<option>" + Answers[tempRandom] + "</option>"; 
```

结果被表单和选择标签包围，然后我更新了我的元素的 innerHTML。这工作并生成一个工作下拉菜单。但是......也许这是一个线索：当我将菜单元素的 innerHTML 测试到另一个元素中以查看它时，它显示为空。就好像 IE 没有看到元素中有 HTML，认为它是 null，因此“selectedIndex”失败为 null。

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-11-09T00:12:33.723

这解决了。事实证明这是我在引用所选项目的 ID 时的错误。一位同事解释说 .selectedIndex 仅在“选择”标签中的 ID 正确时才有效（至少在 IE 中）。如果不是，则返回 null，这就是最初发生的情况。现在一切都很好。感谢您的建议。

# c# - 在 div 中设置默认按钮 - 但我不知道 ID/类

> ID：13256517
> 
> 赞同：2
> 
> 时间：2012-11-06T17:49:53.717
> 
> 标签：c#, jquery, asp.net, html, defaultbutton

我有一个页面，其中用户控件被动态加载到 div/面板中。我对这些用户控件的内容一无所知，除了它们有一个按钮。

当用户在这个 div/panel 中时（使用用户控件），我希望 div/panel 中的按钮成为默认按钮。现在，无论如何，我的横向搜索按钮都是默认按钮。

我无法在用户控件中添加“defaultButton=mybutton”，也无法向按钮添加类。

我该如何解决这个问题？

谢谢 ：）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:49:43.453

我最终做了以下事情：

```
 $("#CalculatorDiv").keypress(function (e) {
                if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
                    var div = $("#CalculatorDiv");
                    var firstInput = div.find("input[type=submit]");
                    firstInput.click();
                    return false;
                } else {
                    return true;
                }
            }); 
```

:-) 所以查找和按键事件的组合。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:01:07.690

你必须更具体。更好的是，发布代码。

默认情况下，您的意思是按“返回”会使按钮提交吗？在这种情况下，您可以将其包含在一个表单中。

要访问该按钮，您可以通过 javascript 的 document.getElementById 来实现

[https://developer.mozilla.org/en-US/docs/DOM/document.getElementById](https://developer.mozilla.org/en-US/docs/DOM/document.getElementById)

您还可以使用 jQuery 按类、类型或最接近 div 标签的按钮元素访问元素。也许在 jQuery 中使用“查找”方法：

[http://api.jquery.com/find/](http://api.jquery.com/find/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:01:38.090

根据您的描述，我不确定您是如何完成此操作的，但您可以做的是设置`Control.ID`，然后您可以使用它`FindControl`来定位 UserControl。

```
UserControl uc = (UserControl)PANELID.FindControl(Control.ID); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T18:03:49.963

我不确定，但你不能搜索`<input type="button" .../>`并添加默认代码部分吗？

* * *

编辑：读错了你的问题，假设它是一个网页'因为'div'。
通常在 C# 中，您可以选择面板内的控件，然后搜索类型以找到按钮

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2012-11-06T17:58:03.810

```
$("your div").children().blur(function(){
$(#button).focus();
}); 
```

# html - Facebook Like Button 对话框显示页面

> ID：13256519
> 
> 赞同：5
> 
> 时间：2012-11-06T17:50:01.953
> 
> 标签：html, css, facebook, iframe

我已经将一个“社交滑块”放在一起，允许访问者“喜欢”和“+”一个页面......这个滑块的容器显示在浏览器的绝对右下角。一切都很好，除了当您单击“赞”按钮时，弹出的允许评论的对话框不在页面之外。

有没有一种我看不到的方法可以让您配置该对话框的显示位置/方式？

```
<div id="social-container">
<div class="fb-like" data-send="false" data-layout="box_count" data-width="55" data-show-faces="false"></div>
</div> 
```

和CSS：

```
#social-container {
        clear: both;
        z-index: 999;
        position: fixed;
        bottom: 120px;
        right: 20px;
    } 
```

![在此处输入图像描述](../Images/06fdbadd22cabe7ca8063dafdd3aba23.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-13T17:10:25.340

您无法选择弹出框出现的位置，因为它是 iframe，并且您无法控制跨域 iframe 的 css（并且没有此参数）。

您唯一能做的就是限制like按钮iframe的大小，以便对话框保持隐藏：

```
#fb-like iframe {
    width: 62px !important; height: 24px !important;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-16T16:21:58.957

这可能是溢出属性的问题。尝试在 #social-container 或 body 中添加：

```
overflow: auto; 
```

或者

```
overflow: visible; 
```

或者

```
overflow: scroll; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-15T15:31:03.703

So, it's unlikely this will solve your problem, since you seem competent enough to know how to do this, posted no real code to actually asses the problem, and I can't figure out exactly which facebook API you're using, BUT-

Can't you just capture the click event and the width of the iframe or whatever it is and just compare the offsets? Something like -

```
$("#social-container").click(function(e){
  var facebookSelector = $( iframe selector here );
  var iframeHeight = facebookSelector.height();
  var iframeWidth = facebookSelector.width();
  var winHeight = $(window).height();
  var winWidth = $(window).width();

  if ( e.clientY && e.clientX ){
    //Set the top based on where mouse click occured
    if ( e.clientY > (winHeight-iframeHeight) ){
      facebookSelector[0].style.top = winHeight-iframeHeight + "px";
    }
    else {
      facebookSelector.style.top = e.clientY + "px";
    }
    //Set the left based on where mouse click occured
    if ( e.clientX > (winWidth-iframeWidth) ){
      facebookSelector[0].style.left = winWidth-iframeWidth + "px";
    }
    else {
      facebookSelector[0].style.left = e.clientX + "px";
    }
  }
} 
```

The above example less verbose-

```
$("#social-container").click(function(e){
  var facebookSelector = $( iframe selector here );
  var h = $(window).height() - facebookSelector.height();
  var w = $(window).width() - facebookSelector.width();

  if ( e.clientY && e.clientX ){
    //Set the top based on where mouse click occured
    facebookSelector[0].style.top = ( e.clientY > h ) ? h + "px" : e.clientY + "px";
    //Set the left based on where mouse click occured
    facebookSelector[0].style.left = ( e.clientX > w ) ? winWidth-iframeWidth + "px" : e.clientX + "px";
  }
} 
```

You could also use the position of the facebook like button instead of the click location (or whatever you want, really).

Caveats and Addendums:
1\. This won't work so easily if the id of your iframe (or whatever) is being dynamically generated by facebook and you have no control over it
2\. This won't work so easily if the Like button is in the iframe and prevents event bubbling up to your container.
3\. This example currently requires jQuery.
4\. Your iframe (or whatever) must be `position: absolute` or `position: fixed`

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-13T21:20:13.380

这似乎很明显，使用您喜欢的任何浏览器工具检查元素，找到弹出容器的名称，添加并相应调整。

前任：

```
#social-container.popup {
  position: absolute;
  right: 150px; 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-12T16:45:51.923

如果您的布局迫切需要从右侧触发“您喜欢此页面”框，您是否可以考虑扩大框并将内容范围扩大到左侧？

这应该为这个弹出内容的出现创造更多的空间。

您还应该确保有足够的空间使用 CSS 添加到页面底部，以允许其扩展。它的定位很可能不会在出现时添加自己的空间。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-09T17:27:50.860

前段时间，您可以使用 css 更改社交插件的某些内容（通过将 css 文件的 url 传递给社交插件代码），但是现在已经不可能了，您几乎必须照原样接受它们。所以，不，这是不可能的，那些社交插件是一个封闭的系统。你唯一能做的就是设计所有的东西，让like按钮在左边的某个地方。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-07-26T08:51:49.160

以上解决方案都不适合我。我找到了一个[关于 facebook 的快速修复，比如显示在页面外的按钮](http://www.aspneto.com/facebook-like-box-overlapping-and-positioning-issue.html)，它起作用了。

希望它可以节省其他人的时间，干杯！

# jakarta-ee - 在 MQ 应用程序中接收异常：com.ibm.mq.jms.MQQueue 与 javax.jms.ConnectionFactory 不兼容

> ID：13256520
> 
> 赞同：1
> 
> 时间：2012-11-06T17:50:12.030
> 
> 标签：jakarta-ee, jms, ibm-mq

我正在编写一个对 WebSphere MQ 队列执行一些操作的应用程序。此方法特别将消息从一个队列移动到另一个队列。我遇到以下代码没有问题：

```
Context ctx = new InitialContext();
ConnectionFactory retrieveConnectionFactory = (ConnectionFactory) ctx.lookup(jndiPrefix + "/" + qcfName);
retrieveConnection = retrieveConnectionFactory.createConnection();
Queue source = (Queue) ctx.lookup(jndiPrefix + "/" + sourceQueue);
retrieveConnection.start();
retrieveSession = retrieveConnection.createSession(true, Session.AUTO_ACKNOWLEDGE);
String queueSearchSpec = buildSearchSpec(searchSpec);
consumer = retrieveSession.createConsumer(source, queueSearchSpec);

do {
    qMessage = consumer.receiveNoWait();
    if (qMessage != null) {
        messages.add(qMessage);
        numberOfMessages++;
    }
} while (qMessage != null); 
```

但是，后来，我正在做一些非常相似的事情，除了我收到一个强制转换异常：

```
ConnectionFactory putConnectionFactory = (ConnectionFactory) ctx.lookup(jndiPrefix + "/" + destinationQueue);           
// this is where the exception is occurring-- Error: com.ibm.mq.jms.MQQueue incompatible with javax.jms.ConnectionFactory
putConnection = putConnectionFactory.createConnection();
Queue destination = (Queue) ctx.lookup(jndiPrefix + "/" + destinationQueue);
putConnection.start();
putSession = putConnection.createSession(true, Session.AUTO_ACKNOWLEDGE);
MessageProducer producer = putSession.createProducer(destination);
for(int i = 0; i < messages.size(); i++)
{
    producer.send(messages.get(i));
} 
```

请注意上述摘录第二行中的注释：这是我收到异常消息“ **com.ibm.mq.jms.MQQueue incompatible with javax.jms.ConnectionFactory.** ”的地方。我不知道为什么会得到它在这里，但不在上面。我什至尝试用' **javax.jms 显式声明所有对象。**' 前缀，但我仍然收到相同的错误。

我在 WebSphere Application Server v7.0 上运行我的应用程序。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T21:51:46.690

我犯了愚蠢的错误。在这一行：

```
ConnectionFactory putConnectionFactory = (ConnectionFactory) ctx.lookup(jndiPrefix + "/" + destinationQueue); 
```

ctx.lookup 中的第二个变量应该是队列连接工厂**qcfName**，就像上面的代码一样。我已经包含了**destinationQueue**，它指的是消息将被移动到的队列。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-08-02T17:45:41.513

要将消息发送到 websphere MQ，您需要按顺序执行两次上下文查找。

1-用于获取队列连接工厂。

```
ConnectionFactory factory = (ConnectionFactory) context.lookup("java:comp/env/jms/myQCF"); 
```

2-用于获取队列本身。

```
Queue queue =(Queue)context.lookup("java:comp/env/jms/myQ"); 
```

# graph - 如何在矩形周围获得最短长度的电路？

> ID：13256524
> 
> 赞同：0
> 
> 时间：2012-11-06T17:50:32.887
> 
> 标签：graph

在上次比赛中，我得到了一组建筑物，我需要在这些建筑物周围创建长度最短的围栏。栅栏可以接触建筑物的角落、墙壁，但不能越过建筑物，所有建筑物都必须在一个区域内。

我知道我需要构建位于围栏多边形边缘的角落。但是我不知道如何为计算机编写它

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:02:25.607

一个普通的凸包将是你最短的栅栏。只需取一组描述建筑物角落的点（假设您的建筑物是多边形）并围绕这些点构建一个凸包。

[一组点的凸包](http://en.wikipedia.org/wiki/Convex_hull)是一个经典的、基本的和经过充分研究的计算几何问题。

[http://en.wikipedia.org/wiki/Convex_hull_algorithms](http://en.wikipedia.org/wiki/Convex_hull_algorithms)

[礼品包装](http://en.wikipedia.org/wiki/Gift_wrapping_algorithm)算法非常容易理解和实现。

# asp.net-mvc - 使用 ASP.NET MVC4 和 Knockout 进行字段级更改跟踪

> ID：13256528
> 
> 赞同：1
> 
> 时间：2012-11-06T17:50:40.157
> 
> 标签：asp.net-mvc, knockout.js, knockout-mvc, kolite

想知道是否有人有跟踪现场级更改跟踪的经验？我们正试图找出最简单/最好的方法来跟踪最终用户的任何和所有模型修改。我正在使用 ASP.NET MVC4、Knockout 和 Knockout Editables。

更新：由于跟踪功能的要求，仅检测对象是否脏是不够的，因为我需要确定发生了什么变化和值。我选择使用 for 循环来迭代模型属性，使用 KO Editables.hasChanges() 函数检测更改，并使用当前值和 .oldValue() (KO Editable) 构建自定义日志对象。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-06T18:42:49.503

由于您提到想要使用 KnockoutJS 实现更改跟踪的最简单和最好的方法，我建议查看 John Papa 最近在 Pluralsight 的单页应用程序课程中实施的内容。您可以阅读他关于更改跟踪的博客文章（底部链接）以获取更多信息。

它的要点是：他与 Hans Fjällemark 一起，在 Steve Sanderson（KnockoutJS 创建者）和 Ryan Niemeyer（KnockoutJS 核心贡献者）的提示下，创建了一个自定义更改跟踪工具 DirtyFlag。DirtyFlag 作为 KoLite 库的一部分提供，可以从[github](https://github.com/CodeSeven/KoLite)或 NuGet 下载：Install-Package KoLite。

博客文章包含启动和运行所需的所有步骤：

[http://www.johnpapa.net/spapost10/](http://www.johnpapa.net/spapost10/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T17:53:23.007

这是 Ryan Niemeyer 实现此类功能的文章：[http ://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html](http://www.knockmeout.net/2011/05/creating-smart-dirty-flag-in-knockoutjs.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-15T07:17:12.350

还有另一种解决方法，我将实施如下

```
var self = this;

// Following property is binded with you to indicate has changes
self.hasChanges = ko.observable(false); 

// Following is the customer object and we want its field tracking
self.customer = ko.observable();

self.initializeCustomer = function (customer) {

    // Following loop read all the properties from customer object
    var properties = [];
    for (var prop in customer)
    {
        if(customer.hasOwnProperty(prop) && typeof customer[prop] !== 'function')
        {
            properties.push(prop);
        }
    }
    //following loop create new observable properties on trackingCustomer object and 
    // subscribe their event
    var trackingCustomer = {};
    for (var prop in properties)
    {
        trackingCustomer[properties[prop]] = ko.observable(properties[prop]);
        trackingCustomer[properties[prop]].subscribe(function (newvalue)
        {
            self.hasChanges(true);
        }
        );
    }

    self.customer(trackingCustomer);
}; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T20:55:21.627

由于跟踪功能的要求，仅仅检测物体是否脏是不够的。我选择使用 for 循环来迭代模型属性，使用 KO Editables .hasChanges() 函数检测更改，并使用当前值和 .oldValue() (KO Editable) 构建自定义日志对象。

# python - Python：二叉搜索树和递归返回嵌套列表

> ID：13256529
> 
> 赞同：1
> 
> 时间：2012-11-06T17:50:41.007
> 
> 标签：python, recursion, tree, binary-search-tree, inorder

给定一个二叉搜索树，例如：

```
 9
            8
    7
5
    3
        2 
```

我想获得一个有序的节点列表，其值在 a 和 b 之间（包括）。

我已经实现了一个递归辅助函数：

```
def _range(root, a, b):
node_list = []
if root.left:
    node_list.append(_range(root.left, a, b))
if root.value >= a and root.value <= b:
    node_list.append(root)
if root.right:
    node_list.append(_range(root.right, a, b))
return node_list 
```

这给了我：

```
[[[BTNode: 2], BTNode: 3], BTNode: 5, [BTNode: 7, [[BTNode: 8], BTNode: 9]]] 
```

但是我需要：

```
[BTNode: 2, BTNode: 3, BTNode: 5, BTNode: 7, BTNode: 8, BTNode: 9] 
```

反正有没有扁平化列表？我意识到我正在做的是将一个列表附加到另一个列表，但我不确定如何在不破坏代码的情况下解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:16:38.300

`append`将您作为参数传递的对象添加到列表中，因此您显然会得到嵌套列表。你想连接结果，所以你想使用`list.extend`（或`+=`运算符）：

```
>>> from collections import namedtuple
>>> class Node(namedtuple('Node', 'value left right')):
...     # I reimplement __str__ just to avoid too much output later
...     def __repr__(self):
...             return 'Node(%r)' % self.value
...     __str__ = __repr__
... 
>>> def make_node(value, left=None, right=None):
...     return Node(value, left, right)
... 
>>> def _range(root, a, b):
...     node_list = []
...     if root.left:
...             node_list.extend(_range(root.left, a, b))
...     if a <= root.value <= b:
...             node_list.append(root)
...     if root.right:
...             node_list.extend(_range(root.right, a, b))
...     return node_list
... 
>>> tree = make_node(5, make_node(3, make_node(2)), make_node(7, None, make_node(8, None, make_node(9))))
>>> _range(tree, 1, 3)
[Node(2), Node(3)]
>>> _range(tree, 1, 10)
[Node(2), Node(3), Node(5), Node(7), Node(8), Node(9)] 
```

另一种方法是将列表作为参数传递：

```
>>> def _range(root, a, b, node_list=None):
...     if node_list is None:
...             # Note: do *not* use "[]" as a default!
...             node_list = []
...     if root.left:
...             _range(root.left, a, b, node_list)
...     if a <= root.value <= b:
...             node_list.append(root)
...     if root.right:
...             _range(root.right, a, b, node_list)
...     return node_list
... 
>>> _range(tree, 1, 3)
[Node(2), Node(3)]
>>> _range(tree, 1, 10)
[Node(2), Node(3), Node(5), Node(7), Node(8), Node(9)] 
```

# objective-c - 解析来自网站的 XML 响应

> ID：13256533
> 
> 赞同：0
> 
> 时间：2012-11-06T17:50:50.350
> 
> 标签：objective-c, afnetworking, kissxml

目前我正在为我的 iOS 应用程序编写一个在线登录，我对应该使用什么库来处理 HTTP-Request 和 XML-Parsing 进行了一些研究。我最终选择了 AFNetworking 和 KissXML。我还将 KissXML 添加用于 AFNetworking。对网站的请求成功，但我有点卡在解析收到的 XML 上。

响应如下所示：

```
<login>
    <response status="success" result="correct"/>
    <data>
        <username>testusername</username>
        <country>Germany</country>
    </data>
</login> 
```

在我的代码中，我对网站执行 HTTPRequest 以接收 XML，然后尝试检查用户数据是否有效。如果它们有效，我想收到用户名和国家/地区等元素。但如果发生错误，我想把它还给我。到目前为止我的代码：

```
{
__block BOOL success = NO;
__block NSError *localerror = nil;
__block NSString *domain = @"de.FranzBusch.Searchlight.ErrorDomain";

//HTTP Request
NSURL *url = [NSURL URLWithString:@"http://www.example.de/login.php"];
AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:url];

NSDictionary *params = [NSDictionary dictionaryWithObjectsAndKeys:
                        email, @"email",
                        password, @"password", nil];

NSMutableURLRequest *request = [client requestWithMethod:@"POST" path:@"" parameters:params];

//Parse XML-Response
AFKissXMLRequestOperation *operation = [AFKissXMLRequestOperation XMLDocumentRequestOperationWithRequest:request success:^(NSURLRequest *request, NSHTTPURLResponse *response, DDXMLDocument *XMLDocument)
{
    NSArray *resultNodes = nil;
    NSError *responseError = nil;
    resultNodes = [XMLDocument nodesForXPath:@"//response" error:&responseError];

    if (responseError || ([resultNodes count] != 1))
    {
        localerror = [NSError errorWithDomain:domain code:-101 userInfo:[self generateErrorDictionary:@"XMLError"]];
        success = NO;
    }
    else
    {
        for (DDXMLElement *element in resultNodes)
        {
            DDXMLNode *node = [element attributeForName:@"status"];
            NSString *status = [node stringValue];

            if ([status isEqualToString:@"fail"])
            {
                success = NO;
                localerror = [NSError errorWithDomain:domain code:-101 userInfo:[self generateErrorDictionary:[[element attributeForName:@"result"] stringValue]]];
            }
            else
            {
                NSError *usernameError = nil;
                NSArray *dataNodes = [XMLDocument nodesForXPath:@"//data//username" error:&usernameError];

                if (usernameError || ([dataNodes count] != 1))
                {
                    localerror = [NSError errorWithDomain:domain code:-101 userInfo:[self generateErrorDictionary:@"XMLError"]];
                    success = NO;
                }
                else
                {
                    for (DDXMLELement *dataElement in dataNodes)
                    {

                    }
                }
            }
        }
    }

    }failure:^(NSURLRequest *request, NSHTTPURLResponse *response, NSError *error, DDXMLDocument *XMLDocument)
    {
        NSLog(@"failure");
    }];
[operation start];
return success;
} 
```

谁能给我一个关于如何改进代码以及如何正确执行的提示。因为如果我想将 localerror 分配给错误，我总是会得到一个错误:(

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T20:17:52.673

如果我对您的理解正确，那么您在解析 XML 响应时遇到了问题。我通常只使用 Apple 的流 XML 解析器 NSXMLParser。它简单、快速且易于使用。

我为您做了一个小示例项目（使用 ARC），使用 NSXMLParser 解析您描述的 XML 响应：[https ://github.com/erikt/ETXMLParseSOExample](https://github.com/erikt/ETXMLParseSOExample)

您可以使用它并运行项目，但重要的部分是 NSXMLParser 委托：

```
@interface ETLoginInfoXMLParser ()
@property (strong,nonatomic) NSMutableString *currentElementValue;
@property (strong,nonatomic) ETLoginInfo *loginInfo;
@end

@implementation ETLoginInfoXMLParser

#pragma mark - NSXMLParserDelegate
- (void)parser:(NSXMLParser *)parser didStartElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName attributes:(NSDictionary *)attributeDict
{
    if ([elementName isEqualToString:@"login"]) {
        if (!self.loginInfo) {
            self.loginInfo = [[ETLoginInfo alloc] init];
        }
        return;
    }

    if ([elementName isEqualToString:@"response"]) {
        self.loginInfo.responseStatus = [attributeDict objectForKey:@"status"];
        self.loginInfo.responseResult = [attributeDict objectForKey:@"result"];
    }
}

- (void) parser:(NSXMLParser *)parser foundCharacters:(NSString *)string {
    if (!self.currentElementValue) {
        self.currentElementValue = [[NSMutableString alloc] initWithString:string];
    } else {
        [self.currentElementValue appendString:string];
    }
}

- (void)parser:(NSXMLParser *)parser didEndElement:(NSString *)elementName namespaceURI:(NSString *)namespaceURI qualifiedName:(NSString *)qName
{
    if ([elementName isEqualToString:@"username"]) {
        NSString *trimmedValue = [self.currentElementValue stringByTrimmingCharactersInSet:
                                  [NSCharacterSet whitespaceAndNewlineCharacterSet]];
        self.loginInfo.username = trimmedValue;
    }

    if ([elementName isEqualToString:@"country"]) {
        NSString *trimmedValue = [self.currentElementValue stringByTrimmingCharactersInSet:
                                  [NSCharacterSet whitespaceAndNewlineCharacterSet]];
        self.loginInfo.country = trimmedValue;
    }

    self.currentElementValue = nil;
}

/** Parse XML login response */ 
+(ETLoginInfo *)parseXMLLoginResponse:(NSString *)xml {
    ETLoginInfoXMLParser *loginInfoParser = [[ETLoginInfoXMLParser alloc] init];
    NSXMLParser *xmlParser = [[NSXMLParser alloc] initWithData:[xml dataUsingEncoding:NSUTF8StringEncoding]];
    [xmlParser setDelegate:loginInfoParser];
    BOOL success = [xmlParser parse];

    if (success) {
        return loginInfoParser.loginInfo;
    } else {
        NSLog(@"Error parsing login information");
        return nil;
    }
}

@end 
```

我将它连接到一个愚蠢的 iOS 应用程序以显示此 XML 响应的解析：

```
<login>
  <response status="success" result="correct"/>
  <data>
    <username>Willy Wonka</username>
    <country>Germany</country>
  </data>
</login> 
```

![在此处输入图像描述](../Images/fe57d2a9c2083806cfc21567330d35e4.png) ![在此处输入图像描述](../Images/8a22744e68e408b4b7c892e4487cdcb3.png)

你会想要一个更有趣的模型层次结构——为了简单起见——只是把所有东西放在同一个实体中

# c++ - 使用指针隐藏实现（Pimpl idiom）

> ID：13256534
> 
> 赞同：11
> 
> 时间：2012-11-06T17:51:03.713
> 
> 标签：c++, dependencies, pimpl-idiom

是否有可能完成以下任务：

**x.hpp** - 此文件包含在许多其他类中

```
class x_impl; //forward declare
class x {
    public:
        //methods...
    private:
        x_impl* impl_;
}; 
```

**x.cpp** - 实现

```
#include <conrete_x>
typedef concrete_x x_impl;    //obviously this doesn't work
//implementation of methods... 
```

所以基本上，我希望用户包含文件**x.hpp**，但不知道**conrete_x.hpp**标头。

由于我`concrete_x`只能通过指针使用并且它仅作为私有数据成员出现，因此前向声明应该足以让编译器知道为它准备多少空间。它看起来很像著名的“pimpl idiom”。

**你能帮我解决这个问题吗？**

PS。我不想使用 a`void*`并对其进行投射..

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T18:53:33.360

实际上，甚至可以对用户完全隐藏：

```
// Foo.hpp
class Foo {
public:

    //...

private:
    struct Impl;
    Impl* _impl;
};

// Foo.cpp
struct Foo::Impl {
    // stuff
}; 
```

我只想提醒你：

*   您将需要编写一个适当的析构函数
*   因此您还需要一个适当的复制构造函数、复制赋值运算符、移动构造函数和移动赋值运算符

有一些方法可以使 PIMPL 自动化，代价是一些黑魔法（类似于什么`std::shared_ptr`）。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-06T18:20:12.350

作为@Angew 的答案的替代方案，如果*`concrete_x`*不应让 x 类的用户知道该名称，您可以这样做：

在**x.hpp**

```
class x_impl;
class x {
  public:
    x();
    ~x();
    //methods...
  private:
    x_impl* impl_;
}; 
```

在**x.cpp中**

```
#include <concrete_x>
class x_impl : public concrete_x { };

x:x() : impl_(new x_impl) {}
x:~x() { delete impl_; } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T17:55:14.737

这仅在前向声明声明类的实际名称时才有效。所以要么将**x.hpp**更改为：

```
class concrete_x;
class x {
    public:
        //methods...
    private:
        concrete_x* impl_;
}; 
```

或使用`x_impl`标题中定义的类的名称`<concrete_x>`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T17:57:25.607

That's what interfaces are for. Define an interface (pure virtual class) in your shared header file and give it to users. Inherit your concrete class from the interface and put it in the non-shared header file. Implement the concrete class in the cpp file (you can even define the concrete class inside the cpp).

# mysql - Can't DROP "MUL" key/index in MySQL - SHOW 中列出的列

> ID：13256545
> 
> 赞同：4
> 
> 时间：2012-11-06T17:51:31.357
> 
> 标签：mysql, database, mysql-error-1091

我在 CentOs 5 上使用 mysql-server-5.0.45-7.el5。

在我的数据库中，有一个表，我不知道何时创建了一个 MUL 键（数据库是共享的，在一个组的控制下），现在当我尝试插入一些值时，我得到一个如图所示的错误以上：

```
Duplicate entry '2-1-2004-09-11 13:13:41.526' for key 2:INSERT INTO ephemeris SET
EPH_TYPE_ID = 1, FILENAME = 'CBERS_2_CCD1_DRD_2004_09_11.13_13_23', ID = 0, 
IS_NEW = 1, SATELLITE_ID = 2, TIME = '2004-09-11 13:13:41.526' 
```

我曾经遇到过这个错误，我`ALTER TABLE ephemeris DROP INDEX SATELLITE_ID;` 第一次尝试它工作，但现在出现了相同的约束，它根本没有工作。

表结构（续）：

```
mysql> show columns from ephemeris;

+--------------+--------------+------+-----+---------+----------------+
| Field        | Type         | Null | Key | Default | Extra          |
+--------------+--------------+------+-----+---------+----------------+
| ID           | int(11)      | NO   | PRI | NULL    | auto_increment |
| SATELLITE_ID | int(11)      | NO   | MUL | 0       |                |
| EPH_TYPE_ID  | int(11)      | NO   |     | 0       |                | 
```

当我键入`ALTER TABLE`命令时，mysql 返回：

```
mysql> ALTER TABLE ephemeris DROP INDEX ephemeris.SATELLITE_ID ;
ERROR 1091 (42000): Can't DROP 'SATELLITE_ID'; check that column/key exists 
```

有人已经收到此错误吗？有什么帮助吗？

Rgds。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-12-20T05:18:44.143

您需要先删除外键约束，然后删除索引。

```
mysql> show create table a;

| CREATE TABLE `a` (
`id` varchar(20) DEFAULT NULL,
`sal` int(20) DEFAULT NULL,
`b_id` varchar(20) DEFAULT NULL,
KEY `b_id` (`b_id`),
CONSTRAINT `a_ibfk_1` FOREIGN KEY (`b_id`) REFERENCES `b` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1 

mysql> alter table a drop foreign key `a_ibfk_1`;
Query OK, 0 rows affected (0.10 sec)
Records: 0  Duplicates: 0  Warnings: 0

mysql> alter table a drop index `b_id`;
Query OK, 0 rows affected (0.23 sec)
Records: 0  Duplicates: 0  Warnings: 0 
```

# linux - insserv 问题 - 脚本不会在启动时启动

> ID：13256546
> 
> 赞同：0
> 
> 时间：2012-11-06T17:51:53.683
> 
> 标签：linux, oracle10g

我正在尝试在我的 linux 发行版（opensuse 12.2）启动时启动 oracle。该脚本在手动运行时工作正常。但是在重新启动时没有任何反应。当我运行 inserv 时，我在下面收到这些消息，知道为什么吗？

`dbora' overwrites defaults (2 3 4 5). insserv: warning: current stop runlevel(s) (empty) of script`insserv：警告：脚本dbora 的当前启动运行级别 (3 5)覆盖默认值 (2 3 4 5)。

这是脚本：

```
#!/bin/bash

### BEGIN INIT INFO
# Provides:          my_oracle_database
# Required-Start:    $local_fs $syslog
# Required-Stop:     $local_fs $syslog
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: my_oracle_database
# Description:       my_oracle_database
### END INIT INFO
export PATH=/oracle10/product/10.2.0/bin:$PATH
case "$1" in 
     start | startup | go | on)
        su - oracle -c "/oracle10/product/10.2.0/bin/lsnrctl start"
        su - oracle -c /oracle10/product/10.2.0/bin/dbstart /oracle10/product/10.2.0/  
        ;; 
     stop | shutdown | halt | off)
        su - oracle -c "/oracle10/product/10.2.0/bin/lsnrctl stop"
        su - oracle -c /oracle10/product/10.2.0/bin/dbshut /oracle10/product/10.2.0/  
        ;; 
     *)
        ;; 
esac 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:24:38.040

您的问题可能是以下几行：

```
su - oracle -c /oracle10/product/10.2.0/bin/dbstart /oracle10/product/10.2.0/
...
su - oracle -c /oracle10/product/10.2.0/bin/dbshut /oracle10/product/10.2.0/ 
```

`su`默认情况下执行使用`-c`选项 through给出的命令`/bin/sh`，同时将除 usernaem 之外的所有其他位置参数传递给 shell（如`$0`、`$1`、 ...）：

```
# su nobody -c 'echo prog:$0 args:$@' a b c d
prog:a args:b c d 
```

在您的脚本中，您缺少命令周围的引号，因此您正在执行`dbstart`/`dbshut`不带参数，同时将路径作为`$0`.

# struts - 如何解决 TilesException？

> ID：13256549
> 
> 赞同：0
> 
> 时间：2012-11-06T17:52:11.573
> 
> 标签：struts, tiles

如何解决“org.apache.tiles.TilesException: Attribute 'footer' not found exception.”。请帮助解决这个错误。我正在使用 struts2 和瓷砖。我在瓷砖概念中是新的。我找不到它的位置是否出现问题？

```
ERROR [org.apache.tiles.jsp.taglib.RoleSecurityTagSupport] (http-localhost-127.0.0.1-8080-5) Error executing tag: Attribute 'footer' not found.: org.apache.tiles.TilesException: Attribute 'footer' not found.
    at org.apache.tiles.jsp.taglib.InsertAttributeTag.render(InsertAttributeTag.java:112) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.tiles.jsp.taglib.RenderTagSupport.execute(RenderTagSupport.java:171) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.tiles.jsp.taglib.RoleSecurityTagSupport.doEndTag(RoleSecurityTagSupport.java:75) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.tiles.jsp.taglib.ContainerTagSupport.doEndTag(ContainerTagSupport.java:80) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.jsp.jsp.errors._404_jsp._jspx_meth_tiles_005finsertAttribute_005f0(_404_jsp.java:509)
    at org.apache.jsp.jsp.errors._404_jsp._jspService(_404_jsp.java:191)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) [jbossweb-7.0.13.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369) [jbossweb-7.0.13.Final.jar:]
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:326) [jbossweb-7.0.13.Final.jar:]
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:253) [jbossweb-7.0.13.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:840) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:624) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:560) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:488) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:533) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:459) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Unknown Source) [rt.jar:1.6.0_34]

23:12:03,488 ERROR [org.apache.tiles.jsp.taglib.RenderTagSupport] (http-localhost-127.0.0.1-8080-5) Error during rendering: javax.servlet.jsp.JspException: Error executing tag: Attribute 'footer' not found.
    at org.apache.tiles.jsp.taglib.RoleSecurityTagSupport.doEndTag(RoleSecurityTagSupport.java:80) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.tiles.jsp.taglib.ContainerTagSupport.doEndTag(ContainerTagSupport.java:80) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.jsp.jsp.errors._404_jsp._jspx_meth_tiles_005finsertAttribute_005f0(_404_jsp.java:509)
    at org.apache.jsp.jsp.errors._404_jsp._jspService(_404_jsp.java:191)
    at org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70) [jbossweb-7.0.13.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:369) [jbossweb-7.0.13.Final.jar:]
    at org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:326) [jbossweb-7.0.13.Final.jar:]
    at org.apache.jasper.servlet.JspServlet.service(JspServlet.java:253) [jbossweb-7.0.13.Final.jar:]
    at javax.servlet.http.HttpServlet.service(HttpServlet.java:847) [jboss-servlet-api_3.0_spec-1.0.0.Final.jar:1.0.0.Final]
    at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:329) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:248) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.invoke(ApplicationDispatcher.java:840) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.processRequest(ApplicationDispatcher.java:624) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.doForward(ApplicationDispatcher.java:560) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.ApplicationDispatcher.forward(ApplicationDispatcher.java:488) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardHostValve.custom(StandardHostValve.java:533) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardHostValve.status(StandardHostValve.java:459) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:171) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:102) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:109) [jbossweb-7.0.13.Final.jar:]
    at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:368) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:877) [jbossweb-7.0.13.Final.jar:]
    at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:671) [jbossweb-7.0.13.Final.jar:]
    at org.apache.tomcat.util.net.JIoEndpoint$Worker.run(JIoEndpoint.java:930) [jbossweb-7.0.13.Final.jar:]
    at java.lang.Thread.run(Unknown Source) [rt.jar:1.6.0_34]
Caused by: org.apache.tiles.TilesException: Attribute 'footer' not found.
    at org.apache.tiles.jsp.taglib.InsertAttributeTag.render(InsertAttributeTag.java:112) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.tiles.jsp.taglib.RenderTagSupport.execute(RenderTagSupport.java:171) [tiles-jsp-2.0.5.jar:2.0.5]
    at org.apache.tiles.jsp.taglib.RoleSecurityTagSupport.doEndTag(RoleSecurityTagSupport.java:75) [tiles-jsp-2.0.5.jar:2.0.5]
    ... 25 more 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T10:01:33.203

看看这个：[http ://tiles.apache.org/tutorial/configuration.html](http://tiles.apache.org/tutorial/configuration.html)

并确保你有类似的东西

```
<context-param>
    <param-name>
      org.apache.tiles.impl.BasicTilesContainer.DEFINITIONS_CONFIG
    </param-name>
    <param-value>
      /WEB-INF/tiles.xml
    </param-value>
</context-param> 
```

您必须将tiles.xml 替换为您的XML 定义文件的真实路径/名称。

# php - 在会话中存储用户数据 - 从数据库

> ID：13256560
> 
> 赞同：5
> 
> 时间：2012-11-06T17:52:52.160
> 
> 标签：php, mysql, database, session

如果我有一个登录系统或类似的东西，我会在会话中存储一个 session_id 和一个 user_id，但与某个用户有关的任何其他数据都存储在数据库中。我见过人们在会话中存储其他数据（*用户名、电子邮件等）的其他脚本。*

我只是想知道，哪个会“更好”？将数据保存在数据库中的会话中，还是减少会话并从数据库中获取数据？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:07:55.950

答案是*视*情况而定，在你的情况下，它甚至可能无关紧要。

### 会话方法

*   更少的查询 = 更快

### 数据库方法

*   会话中较少的数据可防止破坏
*   对数据库的更新会立即反映，而不必担心同时更新会话

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T18:09:51.930

您可以将任何您喜欢的信息存储在`$_SESSION`. 我相信它可以达到 128Mb -`memory_limit`默认情况下限制是 128Mb。你可以改变这个。

但是，根据经验，我会存储比查询数据库更相关和/或更便宜的信息 - 换句话说**，尽可能少**。

毫无疑问，它会因用途而有很大差异，但通常，会话包含以下内容：

*   用户名
*   完整的显示名称
*   电子邮件地址
*   ID（用户或其他）
*   权限
*   用户组
*   哈希
*   表单输入错误（暂时突出显示表单错误）

出于速度/规模的原因，不建议存储大块数据/信息。

如果您的站点/平台需要在以后扩展，在正确的时间点，您最好查看[直写缓存](http://en.wikipedia.org/wiki/Cache_%28computing%29)或类似的常用/必需数据（例如[Memcached](http://memcached.org/)）并将绝大多数数据存储在你的数据库 - 应该在哪里。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T18:35:50.053

实践表明，最好将数据保存在数据库中（对于 >= 中型项目（服务器场/会话中的真正大量数据）或增强任何类型项目的安全性（例如共享主机））。甚至用户 id 也不应该保存在`$_SESSION`. 散列、闪存消息、快速设置 - 这就是`$_SESSION`.

但是如果你仍然有一个问题“我需要在数据库中保存会话”那么你很可能不应该将它保存在数据库中。

# oracle - SQL查询，oracle pl/sql

> ID：13256561
> 
> 赞同：0
> 
> 时间：2012-11-06T17:52:53.653
> 
> 标签：oracle, plsql

我需要在 oracle DB 中创建一个索引在插入时增加 1 的表。
我有执行此操作的代码，首先创建表，然后创建序列，最后创建触发器。
当我将它们一一输入到 Oracle SQL Developer 中时，粘贴创建表行并提交，然后将其余的一一输入，它可以工作，但是如果我将它们全部输入，然后单击运行脚本，它不会创建序列+触发器。只有桌子。

我将命令与/
任何其他想法分开？或参考工作脚本？

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:02:42.633

我想你不需要`/`在脚本中。只需使用`;`分隔语句。

```
create table ... ;

create sequence ... ;

create trigger ... ; 
```

我认为这应该足以在 SQL Developer 和 sqlplus 中运行。

# java - 如何在 Eclipse 的 Android 项目中使用 Java 项目？

> ID：13256562
> 
> 赞同：3
> 
> 时间：2012-11-06T17:52:54.803
> 
> 标签：java, android, eclipse

我正在编写一个 Android 应用程序，其中有一些 Java 代码有些复杂，因此很难在 Android 环境中验证其正确性。我想在桌面环境中运行此代码，在该环境中我有更多工具可以检查此代码的输出，同时仍在我的 Android 应用程序中使用它。

我尝试的解决方案是在 Eclipse 中拥有三个不同的项目。我的 Android 项目和两个普通（非 Android）Java 项目。一个 Java 项目包含我想在 Android 中使用的复杂代码，另一个是验证前一个项目正确性的测试程序。后一个项目在调试前一个项目中已经很有用了。

但是，到目前为止，我尝试在我的 Android 项目中使用 Java 项目似乎在 IDE 中工作，但是当我实际运行 Android 应用程序时，每当我尝试访问任何类时都会引发 NoClassDefFoundError 异常。显然，该代码没有被重新编译到 .dex 文件中，但为什么不呢？

我可以详细介绍我到目前为止所做的事情，但我不禁认为我正在做的是一件非常标准和简单的事情，并且有一种简单的方法，即使我找不到任何人都在做我正在尝试的事情。有人可以向我描述这是如何完成的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-19T04:59:58.393

幸运的是，我找到了自己问题的答案，我想我会在这里分享它以帮助处于相同情况的其他人。结果很简单……

我已经在做的事情通常会奏效，这对我来说应该是一个很大的线索，因为我之前实际上已经成功地做到了这一点。您所要做的就是在 Android 项目的**Properties > Java Build Path > Projects**下，将纯 Java 项目添加到“*构建路径上的必需项目*”中，然后在**Properties > Java Build Path > Order and Export**下，选中复选框在“*构建类路径顺序和导出条目*”列表中的同一个项目，一切都应该正常工作。

在 Eclipse 中，您无需执行任何其他操作即可使此设置正常工作。只有当您从命令行编译时，您才需要构建 Java Jars 并将它们作为库导入，但我还没有这样做（目前）。

最后，这对我不起作用，因为我恰好在 JDK 1.7 合规性下编译我的普通 Java 项目，而我的 Android 项目是在 JDK 1.6 下编译的。这通过控制台窗格上的输出得到验证，报告“ *Dx bad class file magic (cafebabe) or version* ”。当两个项目在相同的合规级别下编译时，此错误消息就会消失，而且并非巧合的是，Android 程序运行正常。

感谢所有试图提供帮助的人，我希望这个答案对那里的人有所帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T00:25:03.633

如果你把你的其他纯 java 项目做成一个 Android 项目并用它来监控设备上的输出，它会不起作用吗？

# android-ndk - 如何使用 Android 私有 API 构建可移植二进制文件

> ID：13256563
> 
> 赞同：0
> 
> 时间：2012-11-06T17:53:01.277
> 
> 标签：android-ndk, android-source, cyanogenmod

我正在开发使用一些 Android 私有 API 的应用程序。我将它构建为为我的手机配置的完整 Android (CM10) 源的一部分。生成的二进制文件在该设备上运行良好，但在具有相同 Android 版本的其他设备上会引发分段错误。这不是缺少 API 的问题，因为即使是以这种方式编译的简单的 hello world 也会引发 Segfault。这是一个示例代码：

你好-cmd.cpp

```
#include<stdio.h>

int main(int argc, char* argv[]) {
    printf("Hello Command Line!");
    return 0;
} 
```

安卓.mk

```
LOCAL_PATH := $(call my-dir)
include $(CLEAR_VARS)
LOCAL_MODULE    := hello-cmd
LOCAL_SRC_FILES := hello-cmd.cpp
include $(BUILD_EXECUTABLE) 
```

当我使用 Android NDK 构建以下代码时，它是可移植的。当我在 android 源代码中构建它时，它不是。

我想问题是链接器配置，但我不知道如何调试或修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-12T10:33:22.113

我终于弄清楚了问题所在。这两款设备使用了不同的 Android 版本，具有不兼容的 C++ 编译器标志。将两个设备更新到完全相同的版本后，问题就消失了。

虽然无法使用私有 Android API 编译单个可移植二进制文件，但可以为每个主要 Android 版本编译单独的二进制文件并将它们与应用程序一起发布。[我在我的博客上](http://www.iwobanas.com/2015/06/accessing-android-internal-apis-from-apps/)更详细地描述了这个解决方案。

# java - Hibernate 问题：@OneToMany 注释返回重复项

> ID：13256569
> 
> 赞同：7
> 
> 时间：2012-11-06T17:53:14.603
> 
> 标签：java, mysql, spring, hibernate

我遇到了 Hibernate (4.3.0) 的问题，因为单向 @OneToMany 返回重复项。

我的数据库结构（带有 InnoDB 的 MySQL），其中 'entry' 表与 'entry_address' 表具有 1:N 关系。“entry”表是主表，“entry_address”是“entry”表的子表。

```
CREATE TABLE IF NOT EXISTS `entry` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(500) NOT NULL,
  `active` int(1) NOT NULL DEFAULT '0',
  `modifiedTS` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00' ON UPDATE CURRENT_TIMESTAMP,
  `createdTS` timestamp NOT NULL DEFAULT '0000-00-00 00:00:00',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB  DEFAULT CHARSET=utf8 AUTO_INCREMENT=4 ;

INSERT INTO `entry` (`id`, `name`, `active`, `modifiedTS`, `createdTS`) VALUES
(1, 'Test1', 0, '2012-11-05 13:41:03', '2012-11-01 10:11:22'),
(2, 'Test2', 1, '2012-11-05 11:19:37', '2012-11-01 10:11:33'),
(3, 'Test3', 1, '2012-11-05 11:19:37', '2012-11-01 10:11:44');

CREATE TABLE IF NOT EXISTS `entry_address` (
  `id` int(10) unsigned NOT NULL,
  `precedence` int(1) NOT NULL DEFAULT '0',
  `line` varchar(255) DEFAULT NULL,
  `line2` varchar(255) DEFAULT NULL,
  `street` varchar(255) DEFAULT NULL,
  `street2` varchar(255) DEFAULT NULL,
  `zip` int(5) DEFAULT NULL,
  `city` varchar(255) DEFAULT NULL,
  `country` varchar(255) DEFAULT NULL,
  UNIQUE KEY `entry_address_uq` (`id`,`precedence`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `entry_address` (`id`, `precedence`, `line`, `line2`, `street`, `street2`, `zip`, `city`, `country`) VALUES
(1, 0, 'Line4.1', 'Line4.2', 'Street4.1', 'Street4.2', 9488, 'Schellenberg', 'Liechtenstein'),
(2, 10, 'Line1.1', 'Line1.2', 'Street1.1', 'Street1.2', 9492, 'Eschen', 'Liechtenstein'),
(2, 20, 'Line2.1', 'Line2.2', 'Street2.1', 'Street2.2', 9490, 'Vaduz', 'Liechtenstein'),
(2, 30, 'Line3.1', 'Line3.2', 'Street3.1', 'Street3.2', 9494, 'Schaan', 'Liechtenstein'),
(3, 10, 'Line5.1', 'Line5.2', 'Street5.1', 'Street5.2', 9492, 'Eschen', 'Liechtenstein'),
(3, 20, 'Line6.1', 'Line6.2', 'Street6.1', 'Street6.2', 9492, 'Eschen', 'Liechtenstein');

ALTER TABLE `entry_address`
  ADD CONSTRAINT `entry_address_fk` FOREIGN KEY (`id`) REFERENCES `entry` (`id`); 
```

这是“入口”实体的最小代码。

```
import java.util.Collection;
import javax.persistence.*;

@Entity
@Table(name = "entry")
public class Entry {
    @Id
    @GeneratedValue
    @Column(name = "id")
    private Integer id;

    @Column(name = "name")
    private String name;

    @OneToMany(fetch=FetchType.EAGER)
    @JoinColumn(name = "id")
    private Collection<EntryAddress> addresses;

    @Override
    public String toString() {
        return String.format("Entry [id=%s, name=%s, addresses=%s]", id, name, addresses);
    }
} 
```

这是“entry_address”实体的最小代码：

```
import javax.persistence.*;

@Entity
@Table(name = "entry_address")
public class EntryAddress {
    @Id
    @Column(name = "id")
    private Integer id;

    @Column(name = "line")
    private String line;

    @Override
    public String toString() {
        return String.format("EntryAddress [line=%s]", line);
    }
} 
```

这是 Hibernate 完成的查询（看起来不错！）： Hibernate：选择 this_.id 作为 id0_1_，this_.name 作为 name0_1_，addresses2_.id 作为 id0_3_，addresses2_.id 作为 id1_3_，addresses2_.id 作为 id1_0_，addresses2_.line 作为line1_0_ from entry this_ left external join entry_addressaddresses2_ on this_.id=addresses2_.id

![MySQL 输出](../Images/e50ca65f1892a3537c6bd60a0d4cc7cf.png)

但是，如果我使用以下命令运行 JUnit：

```
import java.util.Collection;

import junit.framework.Assert;
import li.pitschmann.transaction.dao.EntryDao;
import li.pitschmann.transaction.entity.Entry;

import org.junit.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.ContextConfiguration;
import org.springframework.test.context.junit4.AbstractTransactionalJUnit4SpringContextTests;

@ContextConfiguration(locations={"file:**/web-spring.xml"})
public class EntryDaoTest extends AbstractTransactionalJUnit4SpringContextTests {
    @Autowired
    private EntryDao entryDao;

    @Test
    public void findAllEntries() {
        Collection<Entry> entries = entryDao.findEntries();

        Assert.assertNotNull(entries);

        for (Entry e : entries) {
            System.out.println("++: " + e);
        }
        // Assert.assertEquals(3, entries.size());

    }
} 
```

```
import java.util.Collection;

import org.hibernate.SessionFactory;
import org.springframework.transaction.annotation.Transactional;

import li.pitschmann.transaction.dao.EntryDao;
import li.pitschmann.transaction.entity.Entry;

public class EntryDaoImpl implements EntryDao {
    private SessionFactory sessionFactory;

    /**
     * {@inheritDoc}
     */
    @SuppressWarnings("unchecked")
    @Transactional
    public Collection<Entry> findEntries() {
        return sessionFactory.getCurrentSession().createCriteria(Entry.class).list();
    }

    public void setSessionFactory(SessionFactory sessionFactory) {
        this.sessionFactory = sessionFactory;
    }
} 
```

Spring XML（最重要的部分，Spring 3.1.2.RELEASE）：

```
<tx:annotation-driven transaction-manager="transactionManager" />
<context:annotation-config />
<!-- MySQL DataSource -->
<bean id="dataSource" class="com.mchange.v2.c3p0.ComboPooledDataSource">
    <property name="driverClass" value="com.mysql.jdbc.Driver" />
    <property name="jdbcUrl" value="jdbc:mysql://localhost:3306/entry_db" />
    <property name="user" value="root" />
    <property name="password" value="" />
</bean>
<!-- Session Factory -->
<bean id="sessionFactory" class="org.springframework.orm.hibernate4.LocalSessionFactoryBean">
    <property name="dataSource" ref="dataSource" />
    <property name="packagesToScan">
        <list>
            <value>li.pitschmann.transaction.entity</value>
        </list>
    </property>
    <property name="hibernateProperties">
        <props>
            <prop key="hibernate.dialect">org.hibernate.dialect.MySQL5InnoDBDialect</prop>
            <prop key="hibernate.show_sql">true</prop>
        </props>
    </property>
</bean>
<!-- Transaction Manager -->
<bean id="transactionManager" class="org.springframework.orm.hibernate4.HibernateTransactionManager">
    <property name="sessionFactory" ref="sessionFactory" />
</bean> 
```

控制台日志是：

```
++: Entry [id=1, name=Test1, addresses=[EntryAddress [line=Line4.1]]]
++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]
++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]
++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]
++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line5.1]]]
++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line5.1]]] 
```

我还尝试使用 @OneToMany(fetch=FetchType.LAZY) 而不是 FetchType.EAGER - 与重复地址相同的问题。

```
++: Entry [id=1, name=Test1, addresses=[EntryAddress [line=Line4.1]]]
++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line1.1], EntryAddress [line=Line1.1]]]
++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line5.1]]] 
```

**期待**

这是我的期望（3 个具有不同地址的条目对象）：

```
++: Entry [id=1, name=Test1, addresses=[EntryAddress [line=Line4.1]]]
++: Entry [id=2, name=Test2, addresses=[EntryAddress [line=Line1.1], EntryAddress [line=Line2.1], EntryAddress [line=Line3.1]]]
++: Entry [id=3, name=Test3, addresses=[EntryAddress [line=Line5.1], EntryAddress [line=Line6.1]]] 
```

Hibernate 中是否存在错误或我做错了什么？希望有人可以帮助我找到根本原因？！谢谢 ：-）

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-06T17:59:50.517

您可能需要像这样修改您的方法：

```
@SuppressWarnings("unchecked")
@Transactional
public Collection<Entry> findEntries() {
    return sessionFactory.getCurrentSession()
      .createCriteria(Entry.class)
      .setResultTransformer(Criteria.DISTINCT_ROOT_ENTITY)
      .list();
} 
```

另外，更改`addresses`为`Set`：

```
@OneToMany(fetch=FetchType.EAGER)
@JoinColumn(name = "id")
private Set<EntryAddress> addresses; 
```

编辑：

哦...在`EntryAddress`您`id`定义为 the`@Id`但它不是唯一的。您应该制作`id`主键并让它像您在`Entry`. 然后在其中创建另一个字段，`EntryAddress`该字段是外键，`Entry`称为`entry_id`.

# jquery - ipad应用程序中的fancybox

> ID：13256574
> 
> 赞同：2
> 
> 时间：2012-11-06T17:53:33.030
> 
> 标签：jquery, fancybox

我正在为 Ipad 开发一个 HTML5 应用程序。

我添加了元标记：

```
<meta name="apple-mobile-web-app-capable" content="yes" /> 
```

但是 Fancybox 不起作用，因为它是在一个自我窗口（黑色窗口）中打开的。

花式框代码是：

```
jQuery.noConflict();
var $js = jQuery;

$js(document).ready(function() {

    $js(".modalwin").fancybox({
        width: 980,
        height: 600,
        maxWidth: 980,
        maxHeight: 600,
        fitToView: false,
        autoSize: false,
        closeClick: false,
        openEffect: 'fade',
        closeEffect: 'fade',
        type: 'iframe',
        margin: 0,
        padding: 5,
        openSpeed: 'fast',
        closeSpeed: 'fast',
        scrolling: 'no',
        helpers: {
            title: {
                type: 'outside'
            },
            overlay: {
                css: {
                    'background': 'rgba(0,0,0,0.9)'
                }
            }
        },
        beforeShow: function() {
            $js(".fancybox-skin").css("backgroundColor", "#D84B04");
        }
    })
}); 
```

为了防止在应用程序外部的空白页面中打开链接，我使用了：

```
jQuery.noConflict();
var $jx = jQuery;

$jx(document).on("click", "a", function(event) {
    event.preventDefault();
    location.href = $jx(event.target).attr("href");
});​ 
```

请帮我修复它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:21:03.823

我建立了答案：

```
 jQuery.noConflict ();
    var $jx = jQuery;

    $jx(document).delegate("a:not(.modalwin)", "click", function(event){
    window.location=this.getAttribute("href");
    return false;
    }); 
```

# jquery - 基于 MVC 和 Jquery 中的下拉选择隐藏或显示特定表单

> ID：13256587
> 
> 赞同：1
> 
> 时间：2012-11-06T17:54:11.513
> 
> 标签：jquery, asp.net-mvc-3

当我在下拉菜单上选择调整时，我可以获得值，但是当呈现正确的表单时，表单中的下拉 UI 没有正确的值。它几乎可以工作，但我觉得我没有正确执行 jquery。在视图中我有 2 个不同的表单，我使用 Jquery 根据下拉选择来选择要显示的表单。

这里是 JQUERY

```
 $(document).ready(function() {
        $("#adjustments").hide();
        $(".TypeClass").change(function() {
            var selected = $(".TypeClass option:selected").text();
            alert(selected);
            if (selected == "Received") {
                $("#received").show();
                $("#adjustments").hide();
            }
            if (selected == "Adjustment") {
                $("#adjustments").show();
                $("#received").hide();
            }
        });

        $(".TypeClass2").change(function() {
            var selected = $(".TypeClass2 option:selected").text();
            alert(selected);
            if (selected == "Received") {
                $("#received").show();
                $("#adjustments").hide();
                               }
            if (selected == "Adjustment") {
                $("#adjustments").show();
                $("#received").hide();
                              }

        });
    }); 
```

这里的观点

```
<div id="received">
   <fieldset>
   <legend>New Inventory Transaction</legend>
    <table>
       <tr><td>@Html.LabelFor(model => model.ItemName)</td><td>@Html.DisplayFor(model => model.ItemName)</td></tr>
       <tr><td>@Html.LabelFor(model => model.ItemNumber)</td><td>@Html.DisplayFor(model => model.ItemNumber)</td></tr>
       <tr><td>@Html.LabelFor(model => model.XactTypeId)</td><td>@Html.DropDownListFor(model => model.XactTypeId, (SelectList)ViewData["InvType"], "Choose Type", new { @class = "TypeClass" })</td></tr>   
       <tr><td>@Html.LabelFor(model => model.XactTotalCost)</td><td>@Html.EditorFor(model => model.XactTotalCost)</td></tr>
       <tr><td></td><td><p> <input type="submit" value="Create" /></p></td></tr>     
       </table>   
       </fieldset>
       </div>    
        <div id="adjustments">
       <fieldset>
       <legend>New Inventory Transaction</legend>   
       <table>
       <tr><td>@Html.LabelFor(model => model.ItemName)</td><td>@Html.DisplayFor(model => model.ItemName)</td></tr>
       <tr><td>@Html.LabelFor(model => model.ItemNumber)</td><td>@Html.DisplayFor(model => model.ItemNumber)</td></tr>
        <tr><td>@Html.LabelFor(model => model.WharehouseName)</td><td>@Html.EditorFor(model => model.WharehouseName)</td></tr>     
       <tr><td></td><td><p> <input type="submit" value="Create" /></p></td></tr>   

       </table>

       </fieldset>
       </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:59:42.050

设置下拉列表值只需使用
$("ddl").val("your val");
并获取选定的值 usev
var selectedval = $("ddl").val();

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-09T05:17:58.047

落下

```
 @Html.DropDownListFor(m => m.AttendenceBonus.BonusIn, new SelectList(Model.BonusInList, "Value", "Text", Model.AttendenceBonus.BonusIn), new { @class = "selectBoxRegular", onchange = "return GetBonusType(this);"}) 
```

脚本

```
<script>
    function GetBonusType(ctrl) {

       var x = $("#AttendenceBonus_BonusIn").val();

       // hide any control by id

            if (x == "Fixed") {
                $('#persent').text("");
                $('#Applylevel').show();
                $('#AttendenceBonus_BonusApplyOn').show();
            }

         // Show any control by id
           else {
               $('#persent').text("%");
               $('#Applylevel').hide();
               $('#AttendenceBonus_BonusApplyOn').hide();
            }
     }

</script> 
```

[您还可以查看 GIF](http://atikpassion.blogspot.com/2014/01/mvc-razor-show-hide-any-id-based-on.html)

# css - 移动/定位 Facebook Like 按钮评论弹出窗口

> ID：13256589
> 
> 赞同：20
> 
> 时间：2012-11-06T17:54:15.657
> 
> 标签：css, facebook, facebook-like

我需要移动与 facebook like 按钮关联的弹出评论框。我知道这个问题已经被问过并解决了无数次。

以前问过：[Facebook Like Widget on Fan page，评论区超出可见区域](https://stackoverflow.com/questions/5808240/facebook-like-widget-on-fan-page-comment-area-out-of-visible-area)

与我相同问题的屏幕截图：http: [//twitpic.com/4q7ggi](http://twitpic.com/4q7ggi)

这里的不同之处在于，我相信 Facebook 在过去几个月内已经改变了实现，因此“赞”按钮和评论弹出窗口都包含在一个 iframe 中。我预计他们可能会这样做，因为这将是防止恶意网站通过自动喜欢内容来利用用户的唯一可靠方法。但是，这意味着我不能应用 CSS 来重新定位评论框。

我正在使用类似 HTML5 的按钮实现，这与官方 facebook 参考中使用的类似按钮[http://developers.facebook.com/docs/reference/plugins/like/](http://developers.facebook.com/docs/reference/plugins/like/)相同。要查看示例，请再次单击 facebook 参考页面上的点赞按钮，然后检查评论弹出元素。您会看到点赞按钮和评论弹出窗口都包含在同一个 iframe 中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T17:03:50.110

这在过去对我有用。

```
.fb-like.fb_edge_widget_with_comment.fb_iframe_widget span iframe {
    /* Now you can apply css here */
    bottom:0!important;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-27T00:40:30.467

您不能更改iframe 内**评论**框的 CSS，因为它违反了[同源策略](http://en.wikipedia.org/wiki/Same_origin_policy)：

> 该策略允许在源自同一站点的页面上运行的脚本无特定限制地访问彼此的方法和属性，但禁止跨不同站点的页面访问大多数方法和属性。

[可以使用 CSS 更改](https://stackoverflow.com/a/6151908/1012875)**发送到**框的消息，因为它不驻留在 iframe 中。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T11:57:34.547

这对我有用，这是一个[小提琴](http://jsfiddle.net/eU2He/)示例。我所做的只是用 css 进行简单的修改：

```
.fb_edge_widget_with_comment span.fb_send_button_form_widget {
  top:100px!important;  /*for example*/
  left:100px!important;        /*for example*/
} 
```

​希望这会有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-23T20:07:13.830

我查看了 Facebook 示例，看到了这个评论框：[http ://screencast.com/t/fRQyUzqek](http://screencast.com/t/fRQyUzqek)

我检查并将样式应用于此类：

```
.-cx-PRIVATE-pluginCommentFlyout__full {
    top: 100px!important;
    left: 100px!important;
} 
```

这移动了评论框。但是，我直接在检查器中执行此操作，因此当您在 CSS 中使用它时，您可能还需要包含父选择器才能真正具体。

希望这可以帮助！

# java - Java / Apache Commons Compress中zip64文件的ZipFile构造函数慢

> ID：13256590
> 
> 赞同：2
> 
> 时间：2012-11-06T17:54:20.807
> 
> 标签：java, zip, zipfile

我必须从包含超过 100000 个文件的 zip 文件中读取文件，并且我使用的是 Java 1.6，所以我暂时使用 Apache commons 压缩库。但是，ZipFile() 的构造函数需要大约 30 秒才能返回。（我承认我使用的机器已经过时了，一台具有 8GB RAM 的 C2D E6550，但如果 zip 文件的文件少于 65535 个，构造函数几乎会立即返回）

现在我需要加快速度，因为我们的程序非常频繁地打开 zip 文件，而 ZipFile 构造函数所花费的时间实在是太长了。我有两个选择：1）将 zip 文件拆分为具有 <65535 个文件的卷或 2）缓存 ZipFile 对象并重用它

但是，两者都需要大量的重构/重写，所以在我继续使用任何一种解决方案之前，有没有办法使用不同的库加速读取 zipfile，或者我在 Apache commons compress 上做错了什么？这就是我创建 zipfile 对象的方式：

```
final File f =  new File(zipFileName);
if(f.exists() == false)
    throw new FileNotFoundException(zipFileName);
ZipFile zip = new ZipFile(f); 
```

关于如何解决这个问题的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:04:09.613

通过查看[源代码](http://commons.apache.org/compress/apidocs/src-html/org/apache/commons/compress/archivers/zip/ZipFile.html)，它正在打开 zip 文件并立即读取所有条目。它将这些信息存储在内部哈希映射中，这些哈希映射最初的大小不适合您的用例。所有的重新散列都可能是问题所在。但很难确定。您应该使用探查器执行它以查看时间花费在哪里。

您还可以获取 apache commons 的源代码并制作您自己的版本，这样您就可以控制初始大小以查看是否有帮助。

如果没有，你总是可以在一个单独的线程中构造这个对象，并在构造它时做一些其他有用的事情。

# ruby-on-rails - 如何在 Rails 中查看多部分/替代电子邮件？

> ID：13256593
> 
> 赞同：0
> 
> 时间：2012-11-06T17:54:23.363
> 
> 标签：ruby-on-rails, ruby-on-rails-3, email, actionmailer, multipart

发送多部分/替代电子邮件时，正文为空：

```
m = send_mail
=> <Mail::Message:70121014358060, Multipart: true, Headers: <Date: Tue, 06 Nov 2012 09:18:06
-0800>, <From: foo@example.com>, <To: bar@example.com>, 
<Message-ID: <5099464e821ef_71113fc654c35xe065537@Air.local.mail>>, <Subject: 
Test>, <Mime-Version: 1.0>, <Content-Type: 
multipart/alternative; boundary="--==_mimepart_5099422e825b0_71113fc654c34ce068277";
charset=UTF-8>, <Content-Transfer-Encoding: 7bit>>

m.body
=> 
```

如何检查身体或不同部位？

导轨 3.2.2

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:10:31.110

来自[https://github.com/mikel/mail](https://github.com/mikel/mail)：

```
mail = Mail.read('multipart_email')

mail.multipart?          #=> true
mail.parts.length        #=> 2
mail.preamble            #=> "Text before the first part"
mail.epilogue            #=> "Text after the last part"
mail.parts.map { |p| p.content_type }  #=> ['text/plain', 'application/pdf']
mail.parts.map { |p| p.class }         #=> [Mail::Message, Mail::Message]
mail.parts[0].content_type_parameters  #=> {'charset' => 'ISO-8859-1'}
mail.parts[1].content_type_parameters  #=> {'name' => 'my.pdf'} 
```

# git - 使用 git 将包含多个应用程序的文件夹上传到 github

> ID：13256596
> 
> 赞同：2
> 
> 时间：2012-11-06T17:54:38.403
> 
> 标签：git, github

我有 3 个由 git 监控的目录和 1 个不受监控的目录。我想从所有这些中复制一份并将它们粘贴到一个更大的单独目录中，然后将它们推送到 github。不幸的是，它没有用。仅上传了不受监控的文件夹，对于其他文件夹，我只看到名称和绿色图标。有人可以帮我做正确的事吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-31T13:26:35.810

当您`git add`将目录添加到 git 存储库本身是 git 存储库（包括`.git`文件夹）时，git 会将其添加为[git submodule](http://git-scm.com/book/en/Git-Tools-Submodules)。这将仅包括子模块的修订，而不包括该目录中的文件。

另请参阅此 SO：[how-do-i-remove-a-git-submodule](https://stackoverflow.com/questions/1260748/how-do-i-remove-a-git-submodule)。如果您删除了子模块和`.git`文件夹（在导出中！），您可以再次添加该文件夹。这次它应该是完整的文件夹。

* * *

您还应该考虑子模块是否已经可以解决您的问题。

# sql-server - 触发每个项目 ID 只允许一个空值

> ID：13256597
> 
> 赞同：1
> 
> 时间：2012-11-06T17:54:39.260
> 
> 标签：sql-server, sql-server-2008, triggers

我正在开发一个用于设备管理的数据库，用户可以在其中登录和注销设备。我有一个名为 TBL_Usage 的表来跟踪这一点。退出项目时，会在此表中创建一个带有退出日期的新记录，重新登录时，会在同一记录中输入登录日期。

出于此问题的目的，该表如下所示： TBL_Usage(Date_Out, Date_In, Equipment_ID)

现在一个项目不能同时签出两次，因此对于每个 Equipment_ID，最多只能有一个 Date_In 为空的记录。我想创建一个触发器/约束来处理这个问题，但不太确定如何设置它。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:07:18.207

您可以使用过滤的唯一索引来做到这一点。

```
create unique index IX_TBL_Usage_Equipment_ID 
  on TBL_Usage(Equipment_ID) 
  where Date_In is null 
```

# mysql - MySql添加新列导致连接过多

> ID：13256604
> 
> 赞同：0
> 
> 时间：2012-11-06T17:55:09.670
> 
> 标签：mysql, sql

我的问题是当我向实时数据库添加新列时，MySQL 遇到“连接太多”错误。

该数据库有 100 万条记录，因此添加它需要一段时间。

*   表锁定的原因是什么？
*   怎么做才能让桌子保持运转？

我在有 100 万条记录的表上执行的查询（InnoDB）

```
ALTER TABLE table_name 
ADD COLUMN new_table_column INT(11) NULL 
DEFAULT NULL ; 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:34:54.973

众所周知，mysql 在添加列方面速度很慢。

据我所知，所有数据库在添加列时都会锁定表，因为它们正在更改磁盘上的布局并且需要大量 I/O。

通常，它很慢（尤其是使用 mysql），它在生产中完成的方式是使用额外的列创建一个新表，复制数据，重命名表并开始使用新表。您当然会在执行此操作时停止写访问，但完成工作要快得多。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:26:57.440

尝试运行`show processlist;`以查看连接是什么。 [http://dev.mysql.com/doc/refman/5.1/en/show-processlist.html](http://dev.mysql.com/doc/refman/5.1/en/show-processlist.html)

我也会看看你的 mysql 配置，特别是检查 max_connections 设置。更改该设置将需要重新启动 mysql 服务器。 [http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html](http://dev.mysql.com/doc/refman/5.0/en/server-system-variables.html)

InnoDB 需要一个表锁，对此您无能为力。

看看这些关于如何做到这一点的一些想法：

[针对 InnoDB 的 ALTER TABLE 优化 MySQL](https://stackoverflow.com/questions/654594/optimizing-mysql-for-alter-table-of-innodb)

和

[ALTER TABLE 不锁定表？](https://stackoverflow.com/questions/463677/alter-table-without-locking-the-table)

# cakephp - Nginx 子文件夹的站点配置

> ID：13256606
> 
> 赞同：1
> 
> 时间：2012-11-06T17:55:14.693
> 
> 标签：cakephp, nginx, cakephp-1.3

我有一个项目，我想要在主域 (sitename.org/projectname) 的子文件夹中。这是一个带有 nginx 1.2.0 的 cakephp 1.3 项目。两天的大部分时间里，我一直在网上搜索/尝试解决方案。我最终将添加更多项目作为子文件夹，每个项目都有自己的根。

首先，如果站点位于根域中，则为工作配置。

```
server {
listen   80;
server_name sitename.org

    location / {
            root /export/home/sitename.org/projectname/app/webroot;
            index index.php index.html index.htm;
            try_files $uri $uri/ /index.php?$uri&$args;

             location ~ .*\.php$ {
                    include /etc/nginx/fastcgi_params;
                     fastcgi_pass 127.0.0.1:9000;
                     fastcgi_index index.php;
                     fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;
            }

    }

} 
```

我想要工作的是位置是子文件夹（sitename.org/projectname）。我用 try_files 和 fastcgi 尝试了各种配置，但我通常以“未指定输入文件”结束。也就是我的配置错误。

任何提示将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-09T18:00:47.923

通过将根更改为更高的目录和重写路径的组合找到了我的答案。希望这可以帮助遇到类似情况的其他人。

```
location /projectname {
            root /export/home/sitename.org/;
            index index.php index.html index.htm;
            rewrite ^/projectname/(.*)$ /projectname/app/webroot/$1 break;
            try_files $uri $uri/ /projectname/app/webroot/index.php?q=$uri&$args;

            location ~ .*\.php$ {
                    include /etc/nginx/fastcgi_params;
                     fastcgi_pass 127.0.0.1:9000;
                     fastcgi_index index.php;
                    fastcgi_param  SCRIPT_FILENAME  $document_root$fastcgi_script_name;

            } 
```

# ruby-on-rails - 我的协会出了什么问题？

> ID：13256607
> 
> 赞同：0
> 
> 时间：2012-11-06T17:55:14.720
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, associations, model-associations

我希望建立一种关系，用户可以在其中创建帖子并标记该帖子。该帖子和那些标签属于该用户。

在过去的三天里，我一直在尝试调试它。我不知道为什么当我保存我的帖子时，user_id 没有填充到 Tag 模型中。我将 user_id 添加到 Tag 模型中。

我提前为过多的代码道歉。

用户 - has_many 帖子；has_many 标签

发布 - 属于用户；has_many 标签；has_many 标签通过标签

Tag - 有很多标签；has_many 通过标签发布帖子；属于用户

标记 - belongs_to 帖子；属于_to 标签

```
ActiveRecord::Schema.define(:version => 20121031012555) do

  create_table "posts", :force => true do |t|
    t.integer  "user_id"
    t.string   "summary"
    t.datetime "created_at",  :null => false
    t.datetime "updated_at",  :null => false
  end

  create_table "taggings", :force => true do |t|
    t.integer  "post_id"
    t.integer  "tag_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  add_index "taggings", ["post_id"], :name => "index_taggings_on_post_id"
  add_index "taggings", ["tag_id"], :name => "index_taggings_on_tag_id"

  create_table "tags", :force => true do |t|
    t.string   "name"
    t.integer  "user_id"
    t.datetime "created_at", :null => false
    t.datetime "updated_at", :null => false
  end

  create_table "users", :force => true do |t|
    t.string   "username"
    t.string   "email"
    t.string   "crypted_password"
    t.string   "password_salt"
    t.string   "persistence_token"
    t.datetime "created_at",        :null => false
    t.datetime "updated_at",        :null => false
    t.string   "role"
  end

end 
```

在帖子模型中：

```
def tag_ids=(tags_string)
    self.taggings.destroy_all

    tag_names = tags_string.split(",").collect{|s| s.strip.downcase}.uniq
    tag_names.each do |tag_name|
      tag = Tag.find_or_create_by_name(tag_name)
      tagging = self.taggings.new
      tagging.tag_id = tag.id
    end
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:00:02.340

如果我遗漏了一些东西，我深表歉意，但看起来你在创建标签时没有将用户 ID 传递给它。使用 rails 3，您可以为多个属性执行 find_or_create_by，如下所示：

```
tag = Tag.find_or_create_by_name_and_user_id(tag_name, user_id) 
```

另外，如果您只想构建 Tag 对象，而不是立即将其保存到 DB，您可以使用“find_or_initialize_by...”方法，如下所示：

```
tag = Tag.find_or_initialize_by_name_and_user(tag_name, user) 
```

只要确保您的 Tag 模型有`attr_accessible :user_id`，如果它还没有。

**更新：**对不起，我刚刚重新阅读了您的问题，并且您说您确实将 user_id 传递给了标签模型。但是我在您提供的代码中看不到这一点；这发生在哪里？

**更新 #2** 根据评论线程，您的参数映射不包含 user_id；当然，这是因为参数映射是根据表单输入构建的，而表单输入显然不包含用户输入。

我假设创建帖子时，它应该与当前登录的用户相关联。我还将假设您在某个地方有对当前登录用户的引用，我将其称为@current_user。

由于看起来您想在一个原子操作中创建帖子和相关标签，您可以做一件事将当前用户添加到参数映射的副本中，如下所示：

```
post_params = params.clone.store(:user=>@current_user)
@post = Post.new(post_params) 
```

可能有更好的方法可以做到这一点，但这应该可行。请注意，您可能不需要复制参数映射；我管理员我不确定在这种情况下什么是最佳实践。

无论如何，希望这会有所帮助。

**更新 3** 由于 Ruby 散列是按照插入键的顺序迭代的，所以 svn 的 tag_ids 是在他的 user_id 进入 Post 模型之前设置的。为了解决这个问题，svn 颠倒了我之前建议的顺序，并确保 :user 键被插入在任何其他值之前。这是一种可能的解决方案（根据 svn 的要点修改（https://gist.github.com/4027807））：

```
post_params = {:user => current_user}.merge!(params[:post].clone)
@post = Post.new(post_params) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T19:22:21.397

在控制器中的行之前，

```
@post = Post.new(params[:post]) 
```

添加以下行

```
@post = Post.new(:user_id => <assign your required user_id>) 
```

这将使新的 post 对象在其实例方法中使用 user_id。
然后你就可以使用了，下线成功

```
tag = Tag.find_or_create_by_name_and_user_id(tag_name, user_id) 
```

希望能帮助到你 ：）

# module - 开发 play framework 2.0 模块的最佳（快速）方法是什么

> ID：13256608
> 
> 赞同：3
> 
> 时间：2012-11-06T17:55:19.780
> 
> 标签：module, playframework

在开发 playframework 2.0 模块时，您应该遵循一些步骤（我错在哪里？）：

1.  创建一个模块
2.  创建一个使用此模块的应用程序

然后，每次您想更改模块中的某些内容时，都应该通过应用程序（使用此模块）检查其工作，因此：

1.  cd 模块文件夹
2.  干净利落
3.  播放本地发布（需要一些时间...）
4.  CD播放应用程序；玩运行（或玩依赖？）

那么，在 playframework 2.0 中开发和测试 som 模块的最佳（*快速）方法是什么，我们是否可以在模块本身内部创建一些示例项目，以免**每次都发布而现在浪费时间*等待？为此，最好遵循什么结构？

--

是否可以将某些模块定义为子项目并在开发时像处理子项目一样使用它？则无需执行清理、发布等额外步骤。但是，我想模块是一个子项目不等于天..？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T21:50:03.637

您列出的步骤是必要的，不能走捷径

[您可以尝试通过触发执行](http://www.scala-sbt.org/release/docs/Detailed-Topics/Triggered-Execution.html)来加快速度，例如：

```
 ~ ;clean ;publish-local 
```

因此，当您更改文件时，您会自动执行这些步骤。

然后让一个终端发布模块并在另一个终端运行应用程序。这可以为您节省几秒钟的时间。

# entity-framework - 我可以在 for 循环中调用 DbContext.SaveChanges

> ID：13256611
> 
> 赞同：0
> 
> 时间：2012-11-06T17:55:36.613
> 
> 标签：entity-framework, entity-framework-4, entity-framework-4.1, entity-framework-5

我正在使用 EF5，当我在 for 循环中调用 context.SaveChanges 时出现错误。

如果我要更新任何实体，我是否需要调用 SaveChanges 以在同一上下文中获取实体的更新值。

例如，一个行项目的数量为 n。在我的第一次迭代中，我将订单项的数量减少了 1。所以现在实际数量是 n-1。我还没有在上下文中调用 SaveChanges。在同一行项目的下一次迭代中，数量是 n 还是 n-1？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T22:29:13.623

我不太确定您要做什么，但是您绝对不应该在循环中调用 SaveChanges。在循环中进行所有需要的更改（添加、删除或上下文中的任何内容），完成后调用 SaveChanges。

# android - RemoteView appwidget 问题

> ID：13256618
> 
> 赞同：0
> 
> 时间：2012-11-06T17:56:22.307
> 
> 标签：android, android-appwidget

我正在尝试制作一个包含在小部件中的远程视图。总的来说，这个想法似乎很合理，但是我在代码中遇到了一些困难，这就是我遇到的问题：

```
RemoteViews RemV = new RemoteViews(getResultData(), R.layout.config);
RemV.addView(appWidgetId, R.id.adView); 
```

到目前为止，addview 不允许我注册 R.id.adView

我该如何解决这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:13:45.517

不可能 - 您不能将 adView 放入小部件中。查看允许控件的小部件参考。

# vb6 - 如何解决 VB6 中的运行时错误 8015？

> ID：13256631
> 
> 赞同：1
> 
> 时间：2012-11-06T17:57:03.397
> 
> 标签：vb6

再会

我正在尝试将数据发送到一个comport“COM1”。通用打印机驱动程序设置在 comport "COM1" 上。向此端口发送数据时，我收到运行时错误“8015：无法设置通信状态，可能存在一个或多个无效通信参数”。单击确定该错误消息后，我收到另一个错误，运行时错误'8018：仅当端口打开时操作才有效'。我相信这个问题可以解决，因为在命令提示符中我可以使用命令“copy C:\textfile.txt COM1”将文本文件复制到端口，并且它可以正常工作。这就是我的情况。

我尝试过的方法如下：

*   使用 MSComm 控件（产生上述错误）
*   使用 Windows API 调用（给出不同的错误“无效函数”）API 链接：[http ://www.thescarms.com/vbasic/CommIO.aspx](http://www.thescarms.com/vbasic/CommIO.aspx)
*   使用 shell 函数通过“复制”命令对 cmd.exe 进行 shell（此方法在需要时有效）
*   使用复制到端口时不起作用的 VB6e FileCopy() 函数

我相信能回答这个问题的人是对COM端口通信有深入了解，对windows copy命令有深入了解的人。

我在某个论坛（我经历过太多）上读到，如果您卸下插头并将其插回，它可以解决此问题。我还没有尝试过，但是我尝试过关闭设备并将其放回原处，我认为这是同一回事。

如果有人可以帮助解决这个问题，将不胜感激

这是一个可能很有趣的链接：

*   [http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx](http://msdn.microsoft.com/en-us/library/windows/desktop/aa363858%28v=vs.85%29.aspx)

谢谢，

约根

根据 Beaner 的要求：

这是我正在使用的代码片段。

```
Private Sub Initialize_COMPort()

On Error GoTo COMPort_Error

    If MSComm1.PortOpen Then
        MsgBox "Port is opened"
        MSComm1.PortOpen = False
    End If

    MSComm1.Settings = "9600,n,8,1"
    MSComm1.CommPort = Val(CbCOMPorts.ListIndex) + 1
    MSComm1.PortOpen = True
    MSComm1.RThreshold = 1
    MSComm1.Handshaking = comXOnXoff

    Exit Sub

COMPort_Error:
    MsgBox Err.Number & " - " & Err.Description, vbCritical + vbOKOnly, "Port Tester", Err.HelpFile, Err.HelpContext
End Sub 
```

错误发生在以下情况：

```
MSComm1.PortOpen = True 
```

被执行。

@Hrqls 我很欣赏代码，但是您给我的代码与我的想法相似，并且在执行时错误仍然存​​在。错误发生在同一个语句

```
.PortOpen = True 
```

@Hrqls 我之前没有尝试过使用打印机控件，但是该设备实际上不是文本打印机，它是卡片压花机。它是“Matica Z3i AF”压花机，我目前正在开发的程序将用于对卡片进行压花。

当前采用的方法是使用压花机是一个批处理文件，它基本上运行带有卡片信息的文本文件的“复制”命令，以压花机可以理解的格式打印。

在此之前，我将尝试使用打印机控件，感谢您的回复，如果问题得到解决，我会及时通知大家。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T07:58:53.787

我假设错误来自打印机已经在使用 COM1 的事实，在这种情况下，您的 MSCOMM 控件也不能使用 COM1

你想打印什么？

最简单、最直接的打印内容是使用 Printer 对象

例如打印当前时间：

```
Private Sub Command1_Click()
  Printer.Print CStr(Now)
  Printer.EndDoc
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-07T23:46:07.577

您正在使用的计算机是否安装了 Matica Z3i AF 并且打印机是否已经在使用 COM1？如果是这样，则端口正在使用中，MSComm 控件无法访问它。确保没有其他硬件或软件已打开该端口。

如果没有其他使用端口，批处理文件是否专门设置速度、奇偶校验或停止位？( **MODE COM1:9600,N,8,1,P** ) 如果是这样，您可以尝试使用批处理文件中的设置。

如果这些都没有帮助，我找不到您的压花机的建议设置，因此您可以尝试基本的端口设置。您可以使用**MODE COM1 /STATUS**查询端口。该命令不区分大小写，将返回如下内容：

```
设备 COM1 的状态：
----------------------
    波特率：1200
    奇偶校验：无
    数据位：7
    停止位：1
    超时：关闭
    XON/XOFF：关
    CTS 握手：关闭
    DSR 握手：关闭
    DSR 灵敏度：关
    DTR电路：开
    RTS电路：开

```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-21T07:29:19.357

不要在端口 COM1 上设置打印机。COM1 端口将被 COM1 端口中的打印机占用。使用 Visual Basic MSCOMM 组件时，不需要任何打印机驱动程序。如果您确实在 COM1 端口中设置了打印机。您可以使用以下代码。此代码不受打印机设置的影响。

Visual Basic：为输出 AS #1 打开“COM1”

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-07T08:14:40.600

要检查端口是否已在使用中，您可以打开它并跟踪错误代码

一个在列表框中列出可用端口的小项目：

```
'1 form with :
'    1 CommandButton : Name = Command1
'    1 Listbox       : Name = List1
'    1 MSComm        : Name = MSComm1
Option Explicit

Private Enum PortAttr
  PortFree = 0
  PortInUse = 1
  PortUnknown = 2
End Enum

Private Function CheckPort(intPort As Integer) As PortAttr
  On Error GoTo ErrorFound
  With MSComm1
    If .PortOpen Then .PortOpen = False
    .CommPort = intPort
    .PortOpen = True
    CheckPort = PortFree
    If .PortOpen = False Then .PortOpen = True
  End With 'MSComm1
Exit Function
ErrorFound:
  Select Case Err.Number
    Case 8002 'port doesnt exist
      CheckPort = PortUnknown
    Case 8005 'port already in use
      CheckPort = PortInUse
    Case Else
      MsgBox Err.Description, vbCritical, "Error " & CStr(Err.Number) & " on Port " & CStr(intPort)
  End Select
  On Error GoTo 0
End Function

Private Sub ListPorts()
  Dim intIndex As Integer
  Dim intPort As Integer
  Dim intFree As Integer
  On Error GoTo ErrorFound
  With MSComm1
    If .PortOpen Then .PortOpen = False
    intPort = .CommPort
    List1.Clear
    List1.AddItem "--- Not Used ---"
    List1.ItemData(0) = -2 'not possible
    List1.AddItem "---- In Use ----"
    List1.ItemData(1) = -2 'not possible
    intFree = 0
    For intIndex = 1 To 16
      Select Case CheckPort(intIndex)
        Case PortFree
          intFree = intFree + 1
          List1.AddItem "Com" & CStr(intIndex), intFree
          List1.ItemData(intFree) = intIndex
        Case PortInUse
          List1.AddItem "Com" & CStr(intIndex)
      End Select
    Next intIndex
    If .PortOpen Then .PortOpen = False
    .CommPort = intPort
    If CheckPort(intPort) = PortFree Then
      If .PortOpen = False Then .PortOpen = True
    End If
  End With 'MSComm1
  Show
Exit Sub
ErrorFound:
  MsgBox Err.Description, vbCritical, "Error " & CStr(Err.Number)
  On Error GoTo 0
End Sub

Private Sub Command1_Click()
  ListPorts
End Sub 
```

# mysql - SUM计算MySQL连接中的重复记录

> ID：13256636
> 
> 赞同：0
> 
> 时间：2012-11-06T17:57:14.660
> 
> 标签：mysql, select, join, distinct, inner-join

我在加入 MySQL 时遇到问题。我有 2 张桌子，customerorder 和 customerorderpos。pos 表包含订购的项目 - 因此 customerorder 表中的每个订单始终只有一个条目，但 customerorderpos 中可能有多个具有相同 customerorderid 的条目。

除非我尝试对 customerorder 进行总和计算，否则一切都在查询中有效。例如总和（cart_total_complete）。这将返回重复值（它对具有多个 customerorderpos 记录的订单进行多次计数）。

我确定这是基本的东西，无论是连接类型还是我使用 distinct 的方式，但我已经尝试了几个小时，但无法让它工作......

任何想法我做错了什么？谢谢你的帮助！！

```
select concat(left(dayname(from_unixtime(customerorder.datetime)),3), ' ',
day(from_unixtime(customerorder.datetime))) as day, 
count(distinct customerorder.customerorderid) as count_totalorders, 
count(distinct customerorderpos.itemid) as count_differentitems, 
sum(customerorderpos.quantity_ordered - customerorderpos.quantity_cancelled) as quantity_ordered, 
sum(customerorderpos.itemsubtotal) as item_subtotal, 
sum(customerorderpos.pricechangetotal) as item_pricechangetotal, 
sum(customerorderpos.itemtotal) as item_total, 
sum(customerorderpos.purchase_price * (customerorderpos.quantity_ordered - customerorderpos.quantity_cancelled)) as item_purchasepricetotal, 
sum(cart_discounttotal) as total_discount, 
sum(customerorderpos.itemtotal) - sum(customerorderpos.purchase_price * (customerorderpos.quantity_ordered - customerorderpos.quantity_cancelled)) - sum(cart_discounttotal) as item_earningstotal, 
sum(cart_total_shipping) as total_shipping, 
sum(cart_total_tax) as total_tax, 
sum(cart_total_complete) as total_complete 
from customerorder inner join customerorderpos on customerorderpos.customerorderid = customerorder.customerorderid 
where customerorder.status_cancelled = 0 
group by day(from_unixtime(customerorder.datetime)) order by customerorder.datetime 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:21:35.013

如果您首先按以下方式汇总`customerorderpos`表`customerorderid`：

```
SELECT   customerorderid,
         SUM(quantity_ordered - quantity_cancelled) AS quantity_ordered,
         SUM(itemsubtotal) AS item_subtotal,
         SUM(pricechangetotal) AS item_pricechangetotal,
         SUM(itemtotal) AS item_total,
         SUM(purchase_price * (
           quantity_ordered - quantity_cancelled
         )) AS item_purchasepricetotal,
FROM     customerorderpos
GROUP BY customerorderid 
```

然后，您可以将结果加入您的`customerorder`表：

```
SELECT   FROM_UNIXTIME(customerorder.datetime, '%a %e') AS day, 
         COUNT(*)                       AS count_totalorders,
         SUM(i.quantity_ordered)        AS quantity_ordered, 
         SUM(i.item_subtotal)           AS item_subtotal,
         SUM(i.item_pricechangetotal)   AS item_pricechangetotal, 
         SUM(i.item_total)              AS item_total, 
         SUM(i.item_purchasepricetotal) AS item_purchasepricetotal, 
         SUM(o.cart_discounttotal)      AS total_discount, 
         SUM(
           i.item_total
         - i.purchasepricetotal
         - o.cart_discounttotal
         )                              AS item_earningstotal, 
         SUM(o.cart_total_shipping)     AS total_shipping, 
         SUM(o.cart_total_tax)          AS total_tax, 
         SUM(o.cart_total_complete)     AS total_complete 
FROM     customerorder o JOIN (
  SELECT   customerorderid,
           COUNT(DISTINCT itemid) AS count_differentitems,
           SUM(quantity_ordered - quantity_cancelled) AS quantity_ordered,
           SUM(itemsubtotal) AS item_subtotal,
           SUM(pricechangetotal) AS item_pricechangetotal,
           SUM(itemtotal) AS item_total,
           SUM(purchase_price * (
             quantity_ordered - quantity_cancelled
           )) AS item_purchasepricetotal,
  FROM     customerorderpos
  GROUP BY customerorderid
) i USING (customerorderid)
WHERE    o.status_cancelled = 0 
GROUP BY FROM_UNIXTIME(o.datetime, '%e')
ORDER BY o.datetime 
```

请注意，我已删除`count_differentitems`，因为不清楚您是否要汇总*每个订单中不同项目的数量*（这将是扩展上述内容的简单案例），或者您是否希望*所有汇总订单中不同项目的数量*（其中将需要额外的表连接）。

另请注意，我已使用日期格式参数`FROM_UNIXTIME()`代替您手动尝试创建格式化的日期字符串。

# php - How to avoid wrapping response with "content" when returning ViewModel in controller action?

> ID：13256639
> 
> 赞同：0
> 
> 时间：2012-11-06T17:57:19.397
> 
> 标签：php, json, viewmodel, zend-framework2

Using Zend Framework 2 and an AbstractRestfulController where the getList action is implemented like this:

```
public function getList() {
    return new ViewModel(array(
        'entities' = array(1 => array(/*..*/), 2 => array(/*..*/))
    ));
} 
```

I've added the JsonStrategy to the view manager so when my UA sends `Accept: text/html` ZF2 uses the correct view to format the data. When my UA sends `Accept: application/json` ZF2 (correctly) responds with `application/json` and JSON encodes the data.

But now the all the entities are wrapped inside a 'content' node (the `ViewModel::$captureTo` property).

If the action controller returns a JsonModel I can avoid this. But then the JsonStrategy always responds with application/json, without checking Accept.

Is there any way to avoid it while still using the ViewModel, and not the JsonModel?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-08T12:31:17.117

为了获得解决方案，我做了这样的事情：

1 - 创建一个新的 MasterControllerClass，我的新控制器“扩展 MasterControllerClass”

```
abstract class MasterControllerClass extends AbstractActionController 
private $_jsonFlag = false;

public function onDispatch(MvcEvent $e)
{
    $this->preDispatch($e);
    $action = parent::onDispatch($this->getEvent());
    $this->postDispatch($e);
    return $action;
}

public function postDispatch(MvcEvent $e)
{
    $this->_jsonFlag ?: $this->viewConfig($e);
}

public function json($value, $sucess = true)
{
    $this->_jsonFlag = true;
    return new \Zend\View\Model\JsonModel(array(
        'data' => $value,
        'success' => $sucess,
    ));
} 
```

2 - 在我的控制器中我将调用 $this->json('values to pass to javascript', true or false, true == success, false == fail)

它解决了我的问题，现在我可以将 json 传递给我的 javascripts。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T12:03:44.570

[Zend Framework 2.0.4](http://framework.zend.com/blog/zend-framework-2-0-4-released.html)中已经解决了这个问题，但不是很完美。他们添加了一个名为的新控制器插件`acceptableViewModelSelector`，可以像这样使用它：

```
class SomeController extends AbstractActionController
{
    protected $acceptCriteria = array(
        'Zend\View\Model\JsonModel' => array(
            'application/json',
        ),
        'Zend\View\Model\FeedModel' => array(
            'application/rss+xml',
        ),
    );

    public function apiAction()
    {
        $viewModel = $this->acceptableViewModelSelector($this->acceptCriteria);

        // Potentially vary execution based on model returned
        if ($viewModel instanceof JsonModel) {
            // ...
        }
    }
} 
```

当它选择创建 JsonModel 时，响应将在没有“内容”包装器的情况下正确呈现。希望有一个更优雅的解决方案，这样人们就可以避免控制器中的视图逻辑，但该修复程序并不是为了直接解决问题而创建的。

# css - Reliably resize images in ems?

> ID：13256642
> 
> 赞同：1
> 
> 时间：2012-11-06T17:57:42.363
> 
> 标签：css, html, safari

I have 2 instances of images with text that need to resize to the same amount as related text, which have been set in ems. One is a logotype in a navigational menu, as a foreground image and one is a unique headline that have been font-replaced in the old-fashioned way of a background image and negative text-indent.

In Firefox and Chrome at least, setting the proper em size for the height gives the correct behavior. I'm not setting the width to avoid perspective issues.

In Safari, as late as 5.1.7, however, the image is shown too big. Any suggestions or thoughts for steps towards a solution here? I haven't tested IE yet, but I am supplying specific styles for 7, 8 and 9.

**I'd prefer resizing working also when user is zooming text only. The end objective is to have the image resize in the exact same amount as the text does, as the image text sixe matches the real text.**

**HTML5:**

```
ul id="one" class="nav">
    <!--Logotype-->
    <li class="logo"> <a href="/">
      <h1><img src="http://bitly.com/YV6G0S"></h1>
      </a></li>
    <!-- endLogotype -->
    <li><a href="#">Text Link 2</a></li>
    <li><a href="#">Text Link 3</a></li>
  </ul> 
```

**CSS:**

```
body {
    font: 81.25% Arial;
}
.nav {
    list-style: none;
    height: 100%;
}
.nav li {
    float: left;
    font-size: 2em;
}
.nav li a {
    display: inline-block;
    width: 100%;
    text-align: center;
    padding: 0.5em 0.4em;
}
.nav li a h1 {
    display: inline-block;
    font-size: 1em;
    font-weight: normal;
}
.logo img {
    height: 1em;
} 
```

[JsFiddle](http://jsfiddle.net/MeBi/8Bmqt/32/)

I've updated the example with reworked code with a shortened version of the [jsfiddle-example](http://jsfiddle.net/MeBi/8Bmqt/32/). (Make some horizontal room to view the result) to better illustrate the objective how I want the graphic to behave. In the fiddle the graphic is just a screen dump of the text cut to 26 pixels height and set to the height of 2em. The root em is then typically 13px.

In the example you can see that the graphic actually is resizing in Firefox, which is hopeful. However an image isn't text so some adjustments have to be made to make the graphic sit at the same spot and behave like the sibling text links.

In the real world the graphic isn't the same size and look and would need some offsets to sit right with the text. But when resizing the page the graphic would **resize like the text**.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:27:43.430

您可以使用以下代码调整图像大小：

```
img {
    max-width: 100%;
    height: auto;
    width: auto;
} 
```

...或者如果您想为图像设置最大尺寸，请将其放入容器中，如下所示（保留上面的 img 声明）：

```
.container {
    max-width: 300px;
}
<div class="container">
    <img src="logo_115x39.png">
</div> 
```

这可以*很容易*地修改，以便您的容器的最大宽度等于以 em 为单位的所需高度。

**更新：**
如果我正确理解了您的问题，您可以通过计算图像的纵横比来设置图片的最大宽度，而不是高度。下面的计算是使用您在问题中提到的 5.46em 进行的。请参阅 JSFiddle 演示并将窗口缩小以查看图片缩小。

```
.logo div {
    /* 
    115px / 39px = 2.948717948717949
    2.948717948717949 x 5.46em = 16.1em
    */
    max-width: 16.1em;
}
.logo img {
    max-width: 100%;
    height: auto;
    width: auto\9; /* ie8 hack */
} 
```

**JSFiddle**
[http://jsfiddle.net/mKt3c/](http://jsfiddle.net/mKt3c/)

# postgresql - Postgres全文搜索：多列、交叉表

> ID：13256645
> 
> 赞同：10
> 
> 时间：2012-11-06T17:57:59.630
> 
> 标签：postgresql, full-text-search, tsvector

我是 Postgres 的新手，遇到了全文搜索功能。我想实现以下目标：

*   指定一些要搜索的表和字段。
*   当用户搜索一些文本时，应该在上面指定的表格字段上进行搜索。

例如

```
CREATE TABLE customer (name text)
CREATE TABLE address (city text) 
```

搜索“Ram”应找到名称“Ram*”和城市“Ram*”（可能最多 10 条记录）。

开放点：排名。

我知道这可能不是直截了当的，但是如果您可以提供示例语句来实现类似的效果？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T23:46:04.263

[这在全文搜索](http://www.postgresql.org/docs/current/interactive/textsearch.html)的 PostgreSQL 文档中得到了很好的介绍，该文档显示了搜索多个列并对其加权的示例。

尤其参见[控制全文搜索](http://www.postgresql.org/docs/current/interactive/textsearch-controls.html)和[操作文档](http://www.postgresql.org/docs/current/interactive/textsearch-features.html#TEXTSEARCH-MANIPULATE-TSVECTOR)。排名也在那里，在[排名搜索结果](http://www.postgresql.org/docs/current/interactive/textsearch-controls.html#TEXTSEARCH-RANKING)中。

你还没有真正提供足够的信息来说更多。对于跨多个表进行搜索，您通常希望对`JOIN`这些表进行查询，或者为了获得最佳性能，创建一个触发器维护的物化视图，您可以对其进行索引然后对其进行查询。

如果这些表是独立且不相关的，那么在单个查询中查询它们是没有意义的；您通常会为此使用多个 tsearch2 查询。我想您可以`UNION ALL`查询结果然后对其进行排名，但不能保证两个表之间的排名是一致的。

# jboss7.x - jboss 7 final中standalone\tmp\vfs下的内容是什么

> ID：13256646
> 
> 赞同：2
> 
> 时间：2012-11-06T17:58:00.223
> 
> 标签：jboss7.x

我正在使用 JBoss 7.0.0.Final。我发现standalone\tmp\vfs 目录下有很多文件夹，而且占用了很多空间。似乎它们是我项目使用的 jar 中的解压缩内容。有什么方法可以禁用此类内容，因为它在我的 dist 中占用了大量空间？为什么它在 vfs 中创建了 jar 文件？对部署的应用程序有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T21:53:07.213

如果可能，请尝试更新版本的应用程序服务器。看起来你可能遇到了这个错误[https://issues.jboss.org/browse/AS7-341](https://issues.jboss.org/browse/AS7-341)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-07T07:58:20.813

正如詹姆斯所说，它是一个 BUG [AS7-341](https://issues.jboss.org/browse/AS7-341)

为了充分利用 Jboss AS7，我建议使用夜间构建，您可以在此处获取它们

[JBoss Nightly Builds](https://ci.jboss.org/jenkins/job/JBoss-AS-7.x-latest/)，只需点击那里的*Last Success Artifact*链接。

# jquery - turbolinks with masonry is not working

> ID：13256649
> 
> 赞同：3
> 
> 时间：2012-11-06T17:58:11.930
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, jquery-masonry, turbolinks

I have installed turbolink gem [https://github.com/rails/turbolinks](https://github.com/rails/turbolinks) in my rails app 3.2.8.

I use this gem, masonry for show elements [https://github.com/desandro/masonry](https://github.com/desandro/masonry).

The problem is that masonry elements when I open a new page with turbolinks are not loaded correctly.

How can I fix this problem?

Thank you very much!

# javascript - 从画布合成创建图像

> ID：13256650
> 
> 赞同：3
> 
> 时间：2012-11-06T17:58:11.520
> 
> 标签：javascript, html, canvas, html5-canvas

我有一个由 10 个不同图像组成的画布组合。这些图像从一个 xml 文件中获取数据，该文件具有一个坐标列表，当它们被放置到画布上时，它为每个图像创建一个掩码。

然后我尝试将画布保存为图像

```
var image = new Image();
image.src = canvas.toDataURL("image/png"); 
```

但是，图像完全空白，并且没有错误。检查出现的图像后，src 为：

```
 data:image/png;base64,iVBORw0KGgoAAAANS...ICxjqAABQ+0HCBAgQIBAWMQ4CcQAAAAAElFTkSuQmCC (shortened) 
```

当从不同域中提取文件时，我阅读了所有有关安全问题、受污染的画布等的信息，但我没有收到任何错误，而且我使用的所有内容都在本地托管 (http://localhost)

关于如何调试的任何想法？

编辑：我更感兴趣的是在浏览器中将其显示为图像，然后担心以后保存它。但是，如果将其“保存”到本地存储然后显示它可以工作，那么我对此感到失望。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:52:19.790

你确定你在画布被绘制后调用 toDataUrl 吗？您确定无论您将新图像附加到 DOM 的何处，它都会以适当的宽度/高度/不透明度可见吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:05:49.930

你有处理图像上传的功能吗？

[https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications#Example.3a.c2.a0Showing_thumbnails_of_user-selected_images](https://developer.mozilla.org/en-US/docs/Using_files_from_web_applications#Example.3a.c2.a0Showing_thumbnails_of_user-selected_images)

 `````
function FileUpload(img, file) {
  var reader = new FileReader();  
  this.ctrl = createThrobber(img);
  var xhr = new XMLHttpRequest();
  this.xhr = xhr;

  var self = this;
  this.xhr.upload.addEventListener("progress", function(e) {
        if (e.lengthComputable) {
          var percentage = Math.round((e.loaded * 100) / e.total);
          self.ctrl.update(percentage);
        }
      }, false);

  xhr.upload.addEventListener("load", function(e){
          self.ctrl.update(100);
          var canvas = self.ctrl.ctx.canvas;
          canvas.parentNode.removeChild(canvas);
      }, false);
  xhr.open("POST", "http://demos.hacks.mozilla.org/paul/demos/resources/webservices/devnull.php");
  xhr.overrideMimeType('text/plain; charset=x-user-defined-binary');
  reader.onload = function(evt) {
    xhr.sendAsBinary(evt.target.result);
  };
  reader.readAsBinaryString(file);
} 
`````

# php - 自动插入日期

> ID：13256652
> 
> 赞同：0
> 
> 时间：2012-11-06T17:58:34.933
> 
> 标签：php, mysql

有人可以告诉我如何在提交到此页面时自动添加日期吗？DB id 是“table1”，字段 id 是“date”。

我的代码：

```
<?php

if (isset($_POST["submit"]) && $_POST["submit"] == "Submit")
{
    for ($count = 1; $count <= 9; $count++)
    {
        $fields[$count] = "";
        if (isset($_POST["field" . $count . ""]))
        {
            $fields[$count] = trim($_POST["field" . $count . ""]);
            //echo $fields[$count] . "<br />";
        }
    }

    $con = mysql_connect("local", "user", "pass");
    mysql_select_db("DB", $con);

    $carriername = mysql_real_escape_string($_POST['carriername']);
    $fromzip = mysql_real_escape_string($_POST['fromzip']);
    $tozip = mysql_real_escape_string($_POST['tozip']);
    $typeofequipment = mysql_real_escape_string($_POST['typeofequipment']);
    $weight = mysql_real_escape_string($_POST['weight']);
    $length = mysql_real_escape_string($_POST['length']);
    $paymentamount = mysql_real_escape_string($_POST['paymentamount']);
    $contactperson = mysql_real_escape_string($_POST['contactperson']);
    $loadtype = mysql_real_escape_string($_POST['loadtype']);

    $insert = "INSERT INTO table1 (`carriername` ,`fromzip` ,`tozip` ,`typeofequipment` ,`weight` ,`length` ,`paymentamount` ,`contactperson` ,`loadtype`) VALUES('$carriername' ,'$fromzip' ,'$tozip' ,'$typeofequipment' ,'$weight' ,'$length' ,'$paymentamount' ,'$contactperson' ,'$loadtype');";
    mysql_query($insert) or die(mysql_error());

    $select = "SELECT `carriername` ,`fromzip` ,`tozip` ,`typeofequipment` ,`weight` ,`length` ,`paymentamount` ,`contactperson` ,`loadtype` FROM `table1` ORDER BY `paymentamount` DESC;";
    $result = mysql_query($select) or die(mysql_error());
}
?>
</script>
<style ="text-align: center; margin-left: auto; margin-right: auto;"></style>
</head>
<body>
<div
 style="border: 2px solid rgb(0, 0, 0); margin: 16px 20px 20px; width: 400px; background-color: rgb(236, 233, 216); text-align: center; float: left;">
<form action="" method="post";">
  <div
  style="margin: 8px auto auto; width: 300px; font-family: arial; text-align: left;"><br>
  <table style="font-weight: normal; width: 100%; font-size: 12px;"
 border="1" bordercolor="#929087" cellpadding="6" cellspacing="0">
   <table
 style="font-weight: normal; width: 100%; text-align: right; font-size: 12px;"
 border="1" bordercolor="#929087" cellpadding="6" cellspacing="0">
    <tbody>
    <tr>
    <td style="width: 10%;">Carrier:</td><td>
 <?php  

$con = mysql_connect("local", "user", "pass");
    mysql_select_db("DB", $con);

$query=("SELECT * FROM table2"); 

$result=mysql_query($query) or die ("Unable to Make the Query:" . mysql_error() ); 
echo "<select name=carriername>";   

while($row=mysql_fetch_array($result)){  

echo "<OPTION VALUE=".$row['carriername'].">".$row['carriername']."</OPTION>"; 
} 

echo "</select>";  

?>
              </td>
        </tr>
        <tr>
              <td style="width: 35%;">Pick Zip:</td><td> <input id="fromzip" name="fromzip" maxlength="50"
 style="width: 100%;" type="text">
        </tr>
        <tr>
              <td style="width: 35%;">Drop Zip:</td><td> <input id="tozip" name="tozip" maxlength="50"
 style="width: 100%;" type="text">
        </tr>
        <tr>
              <td style="width: 35%;">Load Type:</td><td> <input id="loadtype" name="loadtype" maxlength="50"
 style="width: 100%;" type="text">
        </tr>
        <tr>
              <td style="width: 35%;">Rate:</td><td> <input id="paymentamount" name="paymentamount" maxlength="50"
 style="width: 100%;" type="text">
        </tr>
          </tbody>
  </table>
  <p style="text-align: center;"><input name="submit" value="Submit"
 class="submit" type="submit"></p>
  </div>
</form>
</div>
<p style="margin-bottom: -20px;">&nbsp;</p>
</body> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:06:00.613

您可以在查询中使用[CURRENT_TIMESTAMP](http://dev.mysql.com/doc/refman/5.1/en/date-and-time-functions.html#function_current-timestamp "CURRENT_TIMESTAMP")函数，如下所示：

```
INSERT INTO table1 (carriername, ..., CURRENT_TIMESTAMP) 
```

如果您的字段是类型`TIMESTAMP`

如果它是 type `DATE`，你可以使用`NOW()`.

您也可以将表配置为该字段的默认值（`CURRENT_TIMESTAMP`插入时将其留空：

```
CREATE TABLE  `database`.`test` (
`id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY ,
`created` TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
); 
```

如果您想在 PHP 中执行此操作，请插入/格式化您的日期： `date("m/d/y g:i A");`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:03:20.260

我没有看到`date`您插入到 table1 中的列的引用。如果要插入当前日期，请将插入值设置为 NOW()。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:07:16.633

如果您无论如何都要更新您的表格，您可以执行一些简单的操作，例如使用`NOW()`. 这方面的一个例子是：

```
UPDATE table1 SET date=NOW() 
```

如果您走这条路线，请确保您的字段`date`是类型。`DATETIME`您还可以`TIMESTAMP`在编辑条目时使用它来更新字段。要创建它，只需创建一个列并将数据类型设置为 TIMESTAMP：

```
CREATE TABLE test (
    last_edited TIMESTAMP 0 ON UPDATE CURRENT_TIMESTAMP
); 
```

这将创建一个表 (test) 和一个列 (last_edited) 并将默认值设置为`0`. 每当以任何方式编辑此记录时，last_edited 列都会更新为时间和日期。

查看此链接以获取更多信息：[http ://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html](http://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T18:07:47.833

在phpMyAdmin中将您的日期列设置为DATETIME并将其默认值设置为'CURRENT TIMESTAMP'，通过这样做，每当插入一行时，日期就会获取当前时间值并自动与该行一起保存，无需为日期设置值以这种方式在每个插入列上...

# eclipse - Why Maven changes Eclipse project preferences?

> ID：13256654
> 
> 赞同：19
> 
> 时间：2012-11-06T17:58:47.757
> 
> 标签：eclipse, maven, configuration, m2eclipse

First of all, I'm using Ubuntu 12.04, Eclipse Juno with embebbed maven 3.0.4 (m2eclipse) and I have to work in a legacy project which I got from a SVN repositroy.

I'm stuck in a sort of configuration problem with Maven and Eclipse.

At the first time I did a Maven > Update project and I got an "Unknown Error" of "Maven Java EE Configuration Problem" type. I checked my project's properties and I've realized that java compliance level is set to 1.5 but I have 1.6 JRE activated. Well, I've changed to 1.6 version (in Java Facet too), but when I do a Maven > Update project, my project's properties are restored to default (a.k.a. 1.5 version), and the Unknown error persists.

My pom.xml file seems to be ok, and I also try to update project with an empty pom.xml (just with modelVersion, groupId, artifactId, version, name and url tags) and I always get the same error.

I'm really stuck. Someone has a clue?

* * *

## 回答 #1

> 赞同：36
> 
> 时间：2012-11-06T18:16:36.430

尝试在 pom.xml 中指定 JDK 版本：

```
 <build>
    <plugins>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.6</source>
          <target>1.6</target>
        </configuration>
      </plugin>
    </plugins>
  </build> 
```

然后执行“更新项目配置”

# python - Finding repetitions in a string

> ID：13256655
> 
> 赞同：2
> 
> 时间：2012-11-06T17:59:02.013
> 
> 标签：python, string

For two days I have been researching for this and have not found anything so I decided to write my own string repetition detector. Basically the function

```
def findRepetitions (string): 
```

would receive a string and search for any repetitions; returns a list of strings reduced to their simplest form.

For a sample, it'd be:

```
findRepetitions ("trololololo") --> ["olo"]
findRepetitions ("bookkeeper") ---> ["o", "k", "e"]
findRepetitions ("Hello, Molly") -> ["l", "l"]
findRepetitions ("abcdefgh") -----> []
findRepetitions ("102102102") ----> ["102"] 
```

In the third example, the function returns ["l", "l"] instead of ["ll"], because I want to search for repetitions only in the neighboring characters.

I know that this may be hard, but I've been literally thinking over this for a long time and cannot find any smart solution to this.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:12:57.980

这是一个众所周知的问题：

[http://en.wikipedia.org/wiki/Longest_repeated_substring_problem](http://en.wikipedia.org/wiki/Longest_repeated_substring_problem)

您可以有效地解决此问题，但要构建一个 trie：

[http://en.wikipedia.org/wiki/Radix_tree](http://en.wikipedia.org/wiki/Radix_tree)

wiki 页面显示了用于查找和添加节点的伪代码和示例，这是您唯一需要的功能。在 trie 中从每个字符开始插入字符串，例如对于字符串 abcd 插入 abcd、bcd、cd、d。trie 的这个特定实例称为“后缀树”：

[http://en.wikipedia.org/wiki/Suffix_tree](http://en.wikipedia.org/wiki/Suffix_tree)

每次您遍历已经建立的路径时，实际上您都会在字符串中发现重复。现在，您可以在单独的数据结构中列出所有重复并提取最长的重复（如有必要）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:02:13.600

你的例子不一致。例如，`olo`不重复，如 l in `Hello, Molly`, in ``trololololo`; `l`实例之间有一个。中的连续重复`trololololo`是`lolo`、`lo`、`olol`和`ol`。您是否要求“贪婪”算法？那么，给定`trololololo`，它会返回`olol`吗？

无论如何，这里有一些代码。

```
from collections import Counter

def find_repetition(p):
    """ Returns a lookup dictionary for repetitions. """ 
    lookup = Counter()
    while len(p) != 0:
        for i in xrange(len(p)):
            lookup[p[0:i]] += 1
        p = p[1:]
    return lookup

def repeats(p):
    a = find_repetition(p)
    rs = [i for i in a if a[i] > 1][1:]
    return [r for r in rs if r*2 in p] 
```

如果您希望它像我描述的那样“贪婪”，则必须添加另一个函数，该函数从重复中获取结果，并在找到匹配项时将其剔除。

目前，结果如下所示：

```
test = "trololololo", "bookkeeper", "Hello, Molly", "abcdefgh", "102102102"

>>> for i in test:
>>>     repeats(i)

['lolo', 'lo', 'olol', 'ol']
['e', 'o', 'k']
['l']
[]
['210', '021', '102'] 
```

*警告*

`find_repetition`不是很快，因为它基本上会生成字符串的所有长度组合并将它们扔到 Counter 对象中。

# python - when using matplotlib with ipython notebook plt.show() function doesn't work

> ID：13256656
> 
> 赞同：3
> 
> 时间：2012-11-06T17:59:03.613
> 
> 标签：python, matplotlib

I launched the ipython notebook using:

```
$ ipython notebook --pylab=inline 
```

in the command prompt.

when running this:

```
from matplotlib import pyplot as plt
fig = plt.figure()
ax1 = fig.add_subplot(111)
ax1.plot([1,2,3]) 
```

it automatically plots the graph without having to use the plt.show() function, however I find that the plt.show function doesn't work for me, or some other functions like plt.legend().

Does anybody know why this is happening, or how I can fix it?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:09:30.933

plt.show() 没有做任何事情，因为当您激活 --pylab 模式时，matplotlib 会在交互模式下执行，即使不使用 show() 也会显示。

关于传说，你的意思是它不起作用？如果您收到“未找到标记的对象”之类的错误，那是因为在您显示的行代码中，您没有将标签参数设置为绘图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:17:40.360

如前所述，您不需要导入 pyplot。尝试：

```
fig = figure()
ax1 = fig.add_subplot(111)
ax1.plot([1,2,3]) 
```

然后：

```
ax1.legend(('hello',))
fig.show() 
```

将绘制带有图例的图形。
使用 Ipython 很容易查看提示文档以及可用的属性和方法。

# python - pulled down , too basic and had direct solution

> ID：13256657
> 
> 赞同：-2
> 
> 时间：2012-11-06T17:59:05.173
> 
> 标签：python, django

.. ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:01:34.460

错误消息对我来说看起来很清楚。**解决方案 0**：

1.  创建目录`/home/billy/myapps/my_server/sessions`

2.  找出运行 Django 的用户，即。用`ps aux`命令，

3.  授予该用户对该目录的[rwx 权限。](http://blog.yourlabs.org/post/19240900759/survive-linux-nix-permissions)

**解决方案 1**：使用[数据库支持的会话](https://docs.djangoproject.com/en/dev/topics/http/sessions/#using-database-backed-sessions)- 在这种情况下删除`settings.SESSION_ENGINE`以恢复默认值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:01:56.363

路径“/home/billy/myapps//my_server/sessions”必须存在。并且您的应用服务器的进程必须具有相应的权限才能使用它。

# ruby-on-rails - ROR3：为什么这不保存？

> ID：13256662
> 
> 赞同：-1
> 
> 时间：2012-11-06T17:59:32.513
> 
> 标签：ruby-on-rails, ruby-on-rails-3, forms, nested-forms, save

这个功能曾经可以工作，但突然停止了，我不知道为什么。我在运行测试之前进行了更改，但是，在追溯我的步骤后，我不知道发生了什么变化。一双新鲜的眼睛能告诉我为什么这是保存帖子而不是位置吗？

*模型帖子.rb*

```
class Post < ActiveRecord::Base
 attr_accessible :title, :body, :tag_list, :locations_attributes
 has_and_belongs_to_many :locations
 accepts_nested_attributes_for :locations, :reject_if => :all_blank
end 
```

*控制器 Posts_controller.rb *

```
class PostsController < ::Blogit::ApplicationController

...     

def new
  @post = current_blogger.blog_posts.new(params[:post])
  @location = @post.locations.build
end

def update
  @post = current_blogger.blog_posts.find(params[:id])
  if @post.update_attributes(params[:post])
    redirect_to @post, notice: 'Blog post was successfully updated.'
  else
    render action: "edit"
  end
end

def create
  @post = current_blogger.blog_posts.new(params[:post])
  if @post.save
    redirect_to @post, notice: 'Blog post was successfully created.'
  else
    render action: "new"
  end
end

end 
```

*查看_form.html.erb*

```
<%= nested_form_for(@post, :html=> {:multipart => true, :class=> "new_blog_post", :id=> "new_blog_post"}) do |f| %>

 ...

<%= field do %>
  <%= f.text_field :title, placeholder: "Give your post a title", :class=>"span12" %>
<% end %>
<%= field do %>
  <%= f.text_area :body, placeholder: "Write something here...", :id=>"blog-text", :class=>"span12" %>
 <% end %>

<%= field id: "new_blog_post_tag_field" do %>
  <%= f.label :tag_list, "Tags" %>
  <%= f.text_field :tag_list, placeholder: "tag one, tag two, etc..." %>
<% end %>

<%= f.label :search_locations, "Add locations to your post" %>
   <%= render :partial => 'search_locations', :locals => { :f => f }  %>

 <p><%= f.link_to_add "Add a location", :locations %></p>

<%= actions do %>
<%= f.submit "Submit", :class=>"btn", :disable_with => 'Uploading Image...' %> or 
<%= link_to("cancel", @post.new_record? ? root_path : post_path(@post)) %>

<% end %>

<% end %> 
```

*形成部分 _search_locations.html.erb*

```
 <%= f.fields_for :locations do |m| %>

 <%= m.text_field :name,:class=>"localename", :id=>"appendedInput", :placeholder=> "Name of the location", :autocomplete => "off" %>

 <span class="add-on"><%= m.link_to_remove do %><i class='icon-trash'></i></span><%end%>

 <% end %> 
```

日志中的实际提交是这样的：

```
Started PUT "/blog/posts/51-hong-kong" for 127.0.0.1 at 2012-11-06 17:41:00 +0000
Processing by Blogit::PostsController#update as HTML
Parameters: {"utf8"=>"✓", 
"authenticity_token"=>"s+2117Qi/HzO/D/ORINhqHChMJR3S5XK7y/s3rq3dnc=", "post"=>{"title"=>"Hong 
Kong ", "body"=>"Lorem ipsum dolor sit amet, consectetur adipiscing elit. In orci elit,  
rhoncus quis interdum vel, interdum non nulla. Phasellus nec massa lorem. Duis malesuada   
pellentesque orci, accumsan mollis augue aliquam mollis. Pellentesque luctus orci in enim 
hendrerit adipiscing. Mauris tempor tortor in leo posuere tristique.", "tag_list"=>"", 
"locations_attributes"=>{"0"=>{"_destroy"=>"false",    
"name"=>"London","longitude"=>"-0.1276831", "latitude"=>"51.5073346"}}},
"_wysihtml5_mode"=>"1", "name"=>"London", "legname"=>"London", "longitude"=>"-0.1276831",
"latitude"=>"51.5073346", "commit"=>"Submit", "id"=>"51-hong-kong"} 
```

为什么这是保存帖子而不是位置信息？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T05:05:14.923

你没有`fields_for`，尝试替换：

```
<%= render :partial => 'search_locations', :locals => { :f => f }  %>

<p><%= f.link_to_add "Add a location", :locations %></p>

<%= actions do %>
<%= f.submit "Submit", :class=>"btn", :disable_with => 'Uploading Image...' %> or 
<%= link_to("cancel", @post.new_record? ? root_path : post_path(@post)) %> 
```

和：

```
<% f.fields_for :locations do |location| %>
  <%= render :partial => 'search_locations', :locals => { :f => location }  %>
<% end %>

<%= f.submit "Submit", :class=>"btn", :disable_with => 'Uploading Image...' %> or 
<%= link_to("cancel", @post.new_record? ? root_path : post_path(@post)) %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-08T18:38:10.107

解决了，这是模型中的一小段代码。

感谢你的帮助！

# java - 远程运行 Hadoop map-reduce 作业会导致 EOFException？

> ID：13256666
> 
> 赞同：0
> 
> 时间：2012-11-06T17:59:51.443
> 
> 标签：java, hadoop, mapreduce, remote-access, cloudera

我已经编写了一个 Hadoop map-reduce 程序，现在我想在[Cloadera Hadoop 发行版上测试它，该发行版在](https://ccp.cloudera.com/display/SUPPORT/CDH+Downloads)[virtual box](https://www.virtualbox.org/)的同一台计算机上运行。

以下是我如何提交该 map-reduce 作业：

```
public class AvgCounter extends Configured implements Tool{

    public int run(String[] args) throws Exception {
        Job mrJob = Job.getInstance(new Cluster(getConf()), getConf()); 
        mrJob.setJobName("Average count");

        mrJob.setJarByClass(AvgCounter.class);
        mrJob.setOutputKeyClass(IntWritable.class);
        mrJob.setOutputValueClass(Text.class);
        mrJob.setMapperClass(AvgCounterMap.class);
        mrJob.setCombinerClass(AvgCounterReduce.class);
        mrJob.setReducerClass(AvgCounterReduce.class);
        mrJob.setInputFormatClass(TextInputFormat.class);
        mrJob.setOutputFormatClass(TextOutputFormat.class);

        FileInputFormat.setInputPaths(mrJob, new Path("/user/test/testdata.csv"));
        FileOutputFormat.setOutputPath(mrJob, new Path("/user/test/result.txt"));
        mrJob.setWorkingDirectory(new Path("/tmp"));
        return mrJob.waitForCompletion(true)? 1: 0;
    }

    public static void main(String[] args) throws Exception {
        Configuration conf = new Configuration();
        conf.set("fs.defaultFS", "hdfs://192.168.5.50:9000");
        conf.set("mapreduce.jobtracker.address", "192.168.5.50:9001");
        System.exit(ToolRunner.run(conf, new AvgCounter(), args));
    }
} 
```

`AvgCounterMap`有`map`什么都不做的`AvgCounterReduce`空方法和什么都不做的空`reduce`方法。当我尝试运行 main 方法时，出现以下异常：

```
Exception in thread "main" java.io.IOException: Call to /192.168.5.50:9001 failed on local exception: java.io.EOFException
    at org.apache.hadoop.ipc.Client.wrapException(Client.java:1063)
    at org.apache.hadoop.ipc.Client.call(Client.java:1031)
    at org.apache.hadoop.ipc.WritableRpcEngine$Invoker.invoke(WritableRpcEngine.java:198)
    at $Proxy0.getProtocolVersion(Unknown Source)
    at org.apache.hadoop.ipc.WritableRpcEngine.getProxy(WritableRpcEngine.java:235)
    at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:275)
    at org.apache.hadoop.ipc.RPC.getProxy(RPC.java:249)
    at org.apache.hadoop.mapreduce.Cluster.createRPCProxy(Cluster.java:86)
    at org.apache.hadoop.mapreduce.Cluster.createClient(Cluster.java:98)
    at org.apache.hadoop.mapreduce.Cluster.<init>(Cluster.java:74)
    at eu.xxx.mapred.AvgCounter.run(AvgCounter.java:22)
    at org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:69)
    at eu.xxx.mapred.AvgCounter.main(AvgCounter.java:53)
Caused by: java.io.EOFException
    at java.io.DataInputStream.readInt(DataInputStream.java:375)
    at org.apache.hadoop.ipc.Client$Connection.receiveResponse(Client.java:760)
    at org.apache.hadoop.ipc.Client$Connection.run(Client.java:698) 
```

运行 Hadoop 的虚拟 Cloudera 机器在文件中有以下内容`/etc/hadoop/conf/core.site.xml`

```
<property>
    <name>fs.default.name</name>
    <value>hdfs://192.168.5.50:9000</value>
</property> 
```

在文件`/etc/hadoop/conf/mapred.site.xml`中有

```
<property>
     <name>mapred.job.tracker</name>
     <value>192.168.5.50:9001</value>
</property> 
```

`92.168.5.50:50030`我还通过写入我的 Web 浏览器检查了与虚拟机的连接，并按预期进行了 Hadoop Map/Reduce 管理。那么导致该异常的原因是什么，我该如何摆脱它呢？

谢谢你的任何想法

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T00:51:01.620

问题是客户端使用不同版本的 Hadoop API (0.23.0) 然后 Hadoop 安装。

# java - 您如何将以下三元运算符转换为常规 if 语句？

> ID：13256669
> 
> 赞同：1
> 
> 时间：2012-11-06T18:00:10.547
> 
> 标签：java

我正在阅读一些代码，我遇到了以下三元表达式。您如何将以下三元运算符转换为常规 if 语句？

```
 ( (vowel) ? ((consonant) ? "ay" : "yay") : "") 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T18:01:22.893

像这样的东西：

```
if(vowel) {
    if(consonant) {
        return "ay"
    } else {
        return "yay"
    }
} else {
    return ""
} 
```

请注意，我之所以使用`return`三元运算符，是因为三元运算符是一个表达式，而`if`在 Java 中是一个语句，因此它没有值。您必须将其包装在返回的方法中`String`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:02:35.950

从内到外工作。

```
if (vowel) {
    if (consonant) {
        return "ay";
    } else {
        return "yay";
    }
} else {
    return "";
} 
```

我猜原始代码在某种程度上是错误的。`vowel`和`consonant`是布尔表达式，并且（如果我猜测代码正确执行的操作）在语义上一个字母不能既是元音又是辅音。也就是说，`"ay"`不会调用此案。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T18:02:57.280

它转化为：

```
 String result = "";
    if (vowel) {
        if (consonant) {
            result = "ay";
        } else {
            result = "yay";
        }
    } else {
        result = "";
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T18:04:41.297

我认为这比嵌套 ifs 更能传达意图：

```
String str = "";
if(vowel && consonant) {
    str = "ay";
} else if(vowel) {
    str = "yay"
} 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-06T18:06:52.630

会是这样

```
String ans = null;
if(vowel)
        {
            if(consonant)
            {
                ans="ay";
            }
            else
            {
                ans="yay";
            }
        }
        else
        {
            ans="";
        } 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-11-06T18:08:37.010

除了条件周围的（），（元音）和（辅音），替换

```
"(" by "if"
"?" by "{"
":" by "} else {"
")" by "}" 
```

你会得到：

```
if (vowel) { if (consonant) { "ay" } else { "yay" } } else { "" } 
```

如果您通过美化器运行它或只是添加您自己的典型缩进，则变为：

```
if (vowel) {
   if (consonant) {
      "ay"
   } else {
      "yay"
   }
} else {
   ""
} 
```

# android - 在操作栏中需要帮助

> ID：13256672
> 
> 赞同：0
> 
> 时间：2012-11-06T18:00:31.560
> 
> 标签：android, android-actionbar, back

我不知道如何描述这个。我有两个充满链接的活动（到其他活动），比如菜单或列表。基本上我可以将链接拆分为“物理”和“数学”（是的，我需要这个用于教育）。我在操作栏中创建了两个链接，如下所示：

```
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item 
        android:id="@+id/menu_settings"
        android:orderInCategory="100"
        android:showAsAction="never" />
    <item 
        android:id="@+id/maths"
        android:title="@string/maths"
        android:orderInCategory="1"
        android:showAsAction="always|withText" 
        android:titleCondensed="@string/maths" 
        android:icon="@drawable/ic_action_calculator" /> 
    <item 
        android:id="@+id/physics"
        android:icon="@drawable/ic_action_line_chart"
        android:title="@string/physics"
        android:orderInCategory="2"
        android:showAsAction="always|withText"/>
</menu> 
```

一切都很好，我的应用程序底部有“标签”。以下代码也有效：

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_home, menu);
    return true;
}

@Override
public boolean onOptionsItemSelected(MenuItem item) {
    switch (item.getItemId()) {
        case R.id.maths:
            return true;
        case R.id.physics:
            Intent myIntent2 = new Intent(Home.this, ActivityPhysics.class);
            startActivity(myIntent2);
        default:
            return super.onOptionsItemSelected(item);
    }
} 
```

如您所见，当单击“数学”时，它什么也不做，因为我已经在数学中了。

当点击“物理”时，它会打开 ActivityPhysics。

我的问题是，当我点击物理并转到物理，然后单击数学并转到数学时，我必须多次按后退按钮，它会返回数学并返回物理...（明白我的意思吗？对不起，我是德国人：D）

是的，那个“背背背背”很烂:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:00:31.560

好的，所以我直接发布这个问题并附上答案，因为在写作时我有一个亲切的想法：D 我已经看到了“向上”按钮的代码（如在 Gmail 等中）。只需将“go to home.java”替换为“go one up, that's home.java”即可。

所以系统认为，它是 up 而不是指向另一个活动的链接，它就像一个“后退”按钮 :)

所以你必须替换这个：

```
Intent myIntent2 = new Intent(ActivityPhysics.this, Home.class);
startActivity(myIntent2); 
```

有了这个：

```
Intent intent = new Intent(this, Home.class);
intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
startActivity(intent); 
```

这对我有用，使用 minSdkVersion 14 :)

# c - 需要查找一个数字是否已经存在于任何给定范围内

> ID：13256675
> 
> 赞同：2
> 
> 时间：2012-11-06T18:00:45.060
> 
> 标签：c, data-structures

我配置了多个可以动态增加/减少的范围，我需要找到最快的方法来查找给定数字是否存在是任何范围，如果是则返回范围？有人可以建议我用 C 中最快的算法或数据结构来做这样的操作吗？

代码片段如下：

```
addr = GET_U32BIT(buf);

    /* Search for the corresponding address */
    while(i < addr_table_size)
    {
        if((addr >= ntohl(table->addr_id[i].start_addr)) && \
                (addr <= ntohl(table->addr_id[i].end_addr)))
        {
            addr_present = 1;
            range_id = i;
            break;          
        }
        i++;
    } 
```

在上面的代码中，addr 是一个 4 字节的数字，它是从运行时接收的缓冲区中派生的，在存储 start 和 end addr 的表中进行线性搜索时，性能非常低，因为 table 可以有大约 50,000 到 100,000条目。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T09:06:07.873

您可以使用区间树来做到这一点。对于每个范围，在区间树中插入一个条目。

现在，如果您想搜索数字“k”所在的范围。在区间树中搜索。此外，每当范围更改时，从 Interval 中删除该范围，然后重新插入新值。

# c# - asp.net c# gridview 按 AJAX 评级控件排序

> ID：13256676
> 
> 赞同：1
> 
> 时间：2012-11-06T18:00:53.103
> 
> 标签：c#, asp.net, ajax, gridview

我在我的 Gridview 中添加了一个 Ajax 评级控件，如下所示：

```
 <asp:BoundField DataField="Wrms_QueryId" HeaderText="Warms_QueryId" ReadOnly="True" SortExpression="Wrms_QueryId" />
            <asp:TemplateField HeaderText="Favourites">
                <ItemTemplate>
                    <asp:Rating ID="Rating1" runat="server" AutoPostBack="true"  CurrentRating='<%# Bind("num") %>' MaxRating="3" RatingAlign="Horizontal"
                        RatingDirection="LeftToRightTopToBottom" StarCssClass="ratingStar" WaitingStarCssClass="savedRatingStar"
                        FilledStarCssClass="filledRatingStar" EmptyStarCssClass="emptyRatingStar" Tag='<%# Bind("Wrms_QueryId")%>' OnChanged="Rating1_Changed">
                    </asp:Rating>
                </ItemTemplate>
            </asp:TemplateField> 
```

在 .cs 中

```
 protected void Rating1_Changed(object sender, EventArgs e)
{
    Rating ra= (Rating)sender; 
    GridViewRow gr=(GridViewRow) ra.Parent.Parent;          

    // table update required?

    Rating r = sender as Rating;
     int id = Convert.ToInt32(r.Tag);
     int lf = Convert.ToInt32(r.CurrentRating);
     string strSQL2 = "UPDATE [dbo].[wrms_config_m] set QueryId = " + lf + " where  Wrms_QueryId = " + id;
     ExecuteSQLUpdate(strSQL2);

} 
```

但我不知道如何将排序添加到评分列。通常我只会添加 SortExpression="####" 但这似乎不支持评级列。

我浏览了很多论坛，但找不到答案。任何帮助将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-29T14:50:58.900

好的，我自己解决了这个问题。我将排序添加到错误的行。需要开启

```
<asp:TemplateField HeaderText="Favourites" SortExpression="num"> 
```

# google-apps-script - 客户端服务服务器响应格式

> ID：13256684
> 
> 赞同：2
> 
> 时间：2012-11-06T18:01:13.507
> 
> 标签：google-apps-script

我是谷歌脚本的新手，我正在尝试让几个谷歌网站小工具相互交流。

我相信以下代码（基于谷歌的 ClientService 示例）应该可以工作。

小工具 1 客户端：

```
function doGet(e) {
    var app = UiApp.createApplication().setTitle("ClientService Client test");
    app.setStyleAttribute("background", "azure");

    var options =
    {
          "method" : "get",
          "v1" : "value for field one"
    };

    var response = UrlFetchApp.fetch("https://script.google.com/macros/s/AKfycbyIa07kBC-gqG0nJq3Up5GzUntbTaYcM1KmaYF7vQvFIWN_qxA/exec", options);

    var lbl = app.createHTML(response.getContentText());
//  var lbl = app.createTextArea().setText(response.getContentText());

    app.add(lbl);
    return app;
} 
```

小工具 2 服务器：

```
function doGet(e) {
    var v1 = e.parameters.v1;

  return ContentService.createTextOutput("Hi from ClientServer : " + v1);
} 
```

我已将客户端嵌入谷歌网站。服务器已部署，因此任何人/匿名者都可以访问它。

加载客户端小工具后，我在客户端 HTML 小部件中看不到任何内容。在 TextArea 中转储响应似乎会显示一些原始 html，即使显示“ReferenceError：“请求”未定义”

我相信我现在错过了 4 个多小时的琐碎事情......任何快速的陷阱？

# sql - 根据其他列的值优化具有不同列计数的查询

> ID：13256685
> 
> 赞同：2
> 
> 时间：2012-11-06T18:01:15.753
> 
> 标签：sql, sql-server

必须有更好的方法来写这个，但我只是不确定那是什么。基本上，我试图从一列中计算不同的值，其中在单独的列中满足条件。我找到了这个[链接](https://stackoverflow.com/questions/11853065/trying-to-count-distinct-values-of-a-field-based-on-value-of-a-different-field)，但不知道如何在这里应用它。

这是查询，我使用的是 SQL Server 2008R2

```
SELECT lot,
    (SELECT COUNT(DISTINCT d.pid) FROM invdet d WHERE upk = 0 and d.lot = [invdet].lot) as noUpk,
    (SELECT COUNT(DISTINCT d.pid) FROM invdet d WHERE upk = 1 and d.lot = [invdet].lot) as isUpk
FROM invdet
WHERE ([status] in ('PQ','P2','FA','F2','BH','RL','SC','LD','PS'))
GROUP BY lot
HAVING COUNT(CASE WHEN invdet.upk = 1 THEN 1 ELSE null END) > 0 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:06:06.037

`COUNT DISTINCT`您可以利用不计入 NULL的事实对您有利。为了检查所有行，创建一个`WHERE EXISTS`子句而不是将结果集限制为这些状态：

```
SELECT lot,
    COUNT(DISTINCT (CASE WHEN upk = 0 THEN pid ELSE NULL END)) as noUpk
    COUNT(DISTINCT (CASE WHEN upk = 1 THEN pid ELSE NULL END)) as isUpk
FROM invdet q
WHERE EXISTS
(
    SELECT 1 
    FROM invdet i 
    WHERE i.[status] in ('PQ','P2','FA','F2','BH','RL','SC','LD','PS')
    AND i.lot = q.lot
)
GROUP BY lot
HAVING COUNT(CASE WHEN upk = 1 THEN 1 ELSE null END) > 0 
```

* * *

您还可以有效地将`HAVING`子句移动到`WHERE EXISTS`子句中，这可能会更快，从而导致：

```
SELECT lot,
    COUNT(DISTINCT (CASE WHEN upk = 0 THEN pid ELSE NULL END)) as noUpk
    COUNT(DISTINCT (CASE WHEN upk = 1 THEN pid ELSE NULL END)) as isUpk
FROM invdet q
WHERE EXISTS
(
    SELECT 1 
    FROM invdet i 
    WHERE i.[status] in ('PQ','P2','FA','F2','BH','RL','SC','LD','PS')
    AND i.lot = q.lot
)
WHERE EXISTS
(
    SELECT 1 
    FROM invdet i 
    WHERE i.upk = 1 
    AND i.lot = q.lot
)
GROUP BY lot 
```

# android - 从 Imagebutton 打开特定的图像和文件夹，但仍然滑动到目录中的其他人？

> ID：13256686
> 
> 赞同：0
> 
> 时间：2012-11-06T18:01:15.613
> 
> 标签：android, android-intent

所以我（慢慢地！！）掌握了 android 的窍门，但以下内容让我感到困惑；

当用户单击图像按钮时，我想打开特定的图像文件，我正在使用以下代码：

```
 Intent showchart = new Intent(); 
 showchart.setAction(Intent.ACTION_VIEW);
 showchart.setDataAndType(Uri.parse("file:///sdcard/1m.jpg"), "image/*");
 startActivity(showchart); 
```

它工作正常。我希望能够根据图库应用程序滑动到下一张图像，而无需返回我的应用程序，但它无法正常工作，即使目录中有很多图像。

帮助好评！

===================编辑============================== ======================

我从谷歌发现这段代码似乎更接近我需要的，但我应该如何修改它以只打开我想要的一个文件？

```
TextView textTargetUri;

/** Called when the activity is first created. */
@Override
public void onCreate(Bundle savedInstanceState) {
  super.onCreate(savedInstanceState);
  setContentView(R.layout.main);
  Button buttonLoadImage = (Button)findViewById(R.id.loadimage);
  textTargetUri = (TextView)findViewById(R.id.targeturi);

  buttonLoadImage.setOnClickListener(new Button.OnClickListener(){

@Override
public void onClick(View arg0) {
 // TODO Auto-generated method stub
 Intent intent = new Intent(Intent.ACTION_PICK,
 android.provider.MediaStore.Images.Media.EXTERNAL_CONTENT_URI);
 startActivityForResult(intent, 0);
 }});
}

@Override
protected void onActivityResult(int requestCode, int resultCode, Intent data) {
// TODO Auto-generated method stub
super.onActivityResult(requestCode, resultCode, data);

if (resultCode == RESULT_OK){
Uri targetUri = data.getData();
textTargetUri.setText(targetUri.toString());
}
  }
   } 
```

我之前没有遇到过结果 ok / onactivity 结果的东西，我猜我应该能够将该 textview 编辑为我想要的路径并更新字符串以反映用户单击我的一个图像按钮时加载的值？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:41:51.697

可以理解的是，您正在尝试从您的应用程序中打开一个厨房并选择一个图像。查看此链接，它可能会有所帮助。

[以编程方式从 Android 的内置图库应用程序中获取/选择图像](https://stackoverflow.com/questions/2169649/open-an-image-in-androids-built-in-gallery-app-programmatically)

# c# - wpf 绑定到另一个控件属性

> ID：13256687
> 
> 赞同：-1
> 
> 时间：2012-11-06T18:01:17.143
> 
> 标签：c#, wpf, binding

所以我有这个用户控件：

```
<UserControl x:Class="Client.SpectrumSpace"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:my="clr-namespace:Client" 
             mc:Ignorable="d" d:DesignHeight="150" d:DesignWidth="350">
    <Canvas>
        <Rectangle Width="350" Height="150" Fill="Transparent" Stroke="White" StrokeThickness="1">
            <Rectangle.ContextMenu>
                <ContextMenu Name="contextMenu">
                    <MenuItem Name="ctxItem1" Header="AntennaName" 
                              IsEnabled="{Binding MainWindow.availeableAntennas[0]}"/>
                </ContextMenu>
            </Rectangle.ContextMenu>
        </Rectangle>
    </Canvas>
</UserControl> 
```

如您所见，我试图将 MainWindow.availableAntennas[0] 属性绑定到 MenuItem.IsEnabled 属性

这就是我在 MainWindow 类上声明数组的方式：

```
public  bool[]      availableAntennas   = new bool[9]; 
```

我的问题是 IsEnabled 属性始终为真，是的，我仔细检查了可用天线 [0] 是否为假，那么我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:03:54.490

您应该使用`"RelativeSource"`绑定表达式。

干杯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:23:28.747

对我来说，它看起来可能是一些事情或全部：

*   您不能绑定到必须是属性的字段 - *public bool[] availableAntennas = new bool[9]*，
*   一个错字 -*可用天线与可用天线*，
*   必须设置数据上下文（从您的帖子中看不出来），
*   您绑定的类必须实现 INotifyPropertyChanged。

# r - 多层ggplot2的格式图例

> ID：13256694
> 
> 赞同：2
> 
> 时间：2012-11-06T18:01:40.540
> 
> 标签：r, ggplot2

我正在尝试修改图表中的图例。到目前为止，它自己的图表还可以，但缺少 2 个点。stat_density() 层的图例 - 即总体密度 - 和 geom_vline() 层的图例 - 是变量的平均值。我尝试使用guides = TRUE，但结果不是我想要的。

如何添加论文？我该如何修改这些？哦，如果我在 geom_density() 中设置颜色，我怎样才能摆脱对角线？

谢谢你的帮助！

这是我的图表代码：

```
ggplot(DEMDes) +
  geom_density(alpha=.3, colour=NA, aes(x=AGE, fill=factor(SEX))) +
  stat_density(geom = "line", aes(x=AGE), colour = "black", linetype="dashed") +
  geom_vline(data=cdf[1,], aes(xintercept=rating.mean), colour="#122bc7",
             linetype="dashed", size=1) +
  geom_vline(data=cdf[2,], aes(xintercept=rating.mean) , colour="#dc143c",
             linetype="dashed", size=1) +
  scale_fill_manual(name = "Geschlecht", values = c("#122bc7", "#dc143c"), labels = c("1" = "Männlich", "2" = "Weiblich")) 
```

![在此处输入图像描述](../Images/067584a963da6465073391f2222e9575.png)

* * *

**更新**

这里是数据框的前 500 行：

```
structure(list(SEX = c(2, 1, 1, 2, 2, 2, 1, 1, 1, 2, 2, 2, 2, 
2, 2, 2, 1, 2, 2, 2, 2, 1, 2, 2, 2, 1, 1, 1, 1, 1, 2, 2, 2, 1, 
1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 2, 1, 2, 1, 1, 
2, 2, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 
2, 2, 2, 1, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 1, 1, 2, 1, 1, 2, 
1, 2, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, 
2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 2, 2, 1, 1, 1, 1, 2, 1, 2, 2, 
1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 1, 
2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 
1, 2, 1, 1, 2, 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 1, 1, 1, 2, 1, 2, 
2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 1, 
2, 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 1, 2, 1, 2, 2, 2, 2, 1, 1, 
1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 2, 
1, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 1, 1, 2, 2, 2, 1, 1, 2, 1, 
1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, 
2, 1, 1, 1, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 1, 
2, 2, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 1, 2, 2, 1, 1, 
2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 1, 2, 2, 2, 1, 2, 
1, 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 
2, 1, 2, 2, 2, 1, 1, 2, 2, 2, 1, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 
2, 2, 2, 1, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 
2, 1, 2, 1, 2, 1, 2, 2, 2, 2, 2, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 
2, 1, 2, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2, 1, 2, 1, 1, 1, 2, 1, 2, 
1, 1, 1, 2, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 1, 2, 1, 2, 1, 2, 1, 
2, 2, 1, 2), AGE = c(53, 46, 56, 48, 19, 56, 58, 26, 79, 71, 
85, 79, 75, 67, 65, 97, 74, 66, 62, 46, 20, 22, 50, 41, 44, 41, 
18, 54, 60, 66, 68, 80, 45, 59, 62, 62, 54, 67, 75, 75, 44, 78, 
68, 67, 55, 54, 56, 62, 69, 70, 68, 52, 48, 23, 74, 82, 57, 40, 
41, 58, 53, 62, 64, 85, 85, 52, 34, 36, 77, 83, 36, 49, 46, 79, 
76, 63, 43, 44, 18, 18, 36, 41, 75, 66, 78, 65, 61, 61, 59, 21, 
61, 67, 57, 55, 57, 47, 41, 49, 65, 84, 54, 69, 60, 81, 62, 60, 
76, 77, 66, 79, 74, 67, 64, 66, 76, 50, 49, 55, 54, 59, 54, 63, 
48, 81, 54, 64, 43, 21, 64, 85, 79, 67, 55, 60, 59, 55, 83, 80, 
79, 47, 37, 62, 59, 81, 80, 65, 65, 76, 75, 73, 73, 83, 45, 47, 
65, 63, 66, 63, 58, 84, 72, 72, 42, 47, 65, 47, 42, 80, 54, 53, 
87, 63, 64, 54, 50, 61, 66, 57, 63, 62, 41, 73, 70, 68, 73, 69, 
55, 79, 52, 63, 66, 66, 47, 63, 62, 73, 46, 89, 83, 80, 64, 58, 
89, 40, 51, 46, 64, 64, 55, 76, 52, 64, 66, 60, 59, 73, 67, 66, 
64, 47, 39, 51, 46, 42, 18, 73, 46, 40, 24, 42, 53, 18, 49, 45, 
22, 79, 65, 69, 69, 74, 69, 72, 53, 26, 78, 75, 50, 52, 69, 69, 
65, 59, 75, 77, 78, 81, 83, 62, 67, 37, 68, 81, 84, 61, 56, 25, 
61, 55, 54, 28, 54, 47, 64, 63, 49, 53, 50, 61, 68, 67, 72, 51, 
21, 55, 51, 22, 62, 61, 55, 31, 54, 63, 59, 34, 74, 64, 73, 79, 
76, 21, 60, 59, 60, 82, 76, 71, 66, 61, 19, 55, 54, 54, 27, 57, 
67, 49, 83, 76, 72, 72, 45, 42, 64, 62, 53, 49, 21, 18, 65, 82, 
31, 62, 62, 28, 25, 60, 57, 72, 70, 66, 64, 48, 22, 41, 67, 64, 
66, 60, 70, 68, 65, 67, 64, 65, 60, 58, 38, 73, 68, 79, 67, 68, 
85, 68, 64, 69, 40, 19, 37, 54, 89, 84, 95, 70, 76, 74, 92, 54, 
54, 73, 74, 46, 48, 92, 87, 49, 49, 20, 66, 79, 67, 69, 80, 78, 
57, 56, 63, 49, 45, 92, 44, 46, 47, 46, 58, 54, 18, 44, 41, 60, 
54, 69, 45, 81, 80, 60, 75, 71, 73, 71, 71, 70, 48, 42, 81, 83, 
48, 43, 20, 63, 62, 73, 47, 63, 44, 34, 19, 18, 87, 82, 48, 75, 
63, 80, 51, 76, 50, 51, 79, 40, 75, 83, 82, 66, 64, 58, 56, 22, 
19, 71, 43, 39, 45, 18, 60, 21, 19, 70, 68, 33, 58, 49, 48, 65, 
66, 44, 55, 55, 55, 33, 46, 63, 72, 48, 46, 55, 53, 22, 20, 60, 
57, 64, 60, 29, 56, 57, 78, 43, 56, 52)), .Names = c("SEX", "AGE"
), row.names = c(NA, 500L), class = "data.frame") 
```

当然，结果可能看起来有点不同。cdf 只是 SEX 的平均值......

```
cdf <- ddply(DEMDes, .(SEX), summarise, rating.mean=mean(AGE)) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-19T14:31:05.613

一个可能但可能并不优雅的解决方案是：

```
ggplot(DEMDes) +
  geom_density(alpha=.3, colour=NA, aes(x=AGE, fill=factor(SEX))) +
  stat_density(geom = "path", aes(x=AGE, colour = "black"), linetype="dashed", position = "identity") +
  geom_vline(data=cdf[1,], aes(xintercept=rating.mean, colour="#122bc7"),
             linetype="dashed", size=1) +
  geom_vline(data=cdf[2,], aes(xintercept=rating.mean, colour="#dc143c"),
             linetype="dashed", size=1) +
  scale_fill_manual(name = "Geschlecht", values = c("#122bc7", "#dc143c"), labels = c("1" = "Männlich", "2" = "Weiblich")) +
  scale_color_manual(name="", values =c("#122bc7", "#dc143c", "black"), labels = c("#122bc7" = expression(paste("Männlich ", bar(x) == "49.46")), "#dc143c" = expression(paste("Weiblich ", bar(x) == "49.38")), "black"= "Beide Geschlechter")) 
```

![在此处输入图像描述](../Images/82b4cc4edf5ccda0b8c898e2a80154ec.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:24:21.627

我不是 ggplot 的专家，但这行得通吗？

```
+ scale_colour_manual("", 
                  breaks = c("Mean", "Density"),
                  values = c("red", "black"),
                  linetype=c("dashed","dashed") 
```

我不能回答对角线的问题，实际上你可能想澄清一点，因为不清楚你在问什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T20:15:51.017

如果没有可重现的数据集，我只能提供部分答案。[这个伟大的资源](http://wiki.stdout.org/rcookbook/Graphs/Legends%20%28ggplot2%29/)建议通过修改图例颜色摆脱对角线斜线的小技巧。例如：

```
# A hack to hide the slashes: first graph the bars with no outline and add the legend,
# then graph the bars again with outline, but with a blank legend.
ggplot(data=PlantGrowth, aes(x=group, fill=group)) + geom_bar() + geom_bar(colour="black", show_guide=FALSE) 
```

# teechart - Borland 决策立方体组件不会加载

> ID：13256703
> 
> 赞同：1
> 
> 时间：2012-11-06T18:02:26.657
> 
> 标签：teechart

我正在使用 BDS 2006。多年来，我一直在使用它，并安装了 Borland Decision Cube Component 和 Teechart。最近遇到一个问题，显示错误信息“Can't load package c:\Users\ameqamc\Documents\Borland Studio Projects\Bpl\dcldss100.bpl. the specific module could not be found.” 该模块实际上存在于该目录中。所有重新加载它的尝试都失败了。调试信息可在[http://www.starmanpage.com/bugreport.txt](http://www.starmanpage.com/bugreport.txt)获得。有谁知道解决方案？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T14:45:01.957

您可能需要使用当前 TeeChart 版本重新编译决策立方体包。您可以尝试运行 DCubeRecomp.exe 来执行此操作，或者如果失败，请按照 *C:\Program Files\Steema Software\TeeChart 2012 for Delphi 2006\Delphi10\Decision Cube* 中文本文件中的说明手动执行此操作。您可以在与手动编译说明相同的位置找到 DCubeRecomp.exe。

# java - ArrayList replaceAll（）不起作用

> ID：13256705
> 
> 赞同：1
> 
> 时间：2012-11-06T18:02:42.260
> 
> 标签：java, arraylist, replaceall

我不知道我的代码有什么问题。无论我尝试替换什么，都不会出错。我有一个`private static ArrayList<String> lista`.

我填这个。然后稍后在另一种方法中，无论我尝试什么，我都无法替换任何东西，如下所示：

```
public static void replacing() {
    Collections.replaceAll(lista, "a", "!!!!!!!!!!!!!!!!!!!!!");
} 
```

然后我在方法中打印这个，lista 是一样的，没有任何改变。之后我应该检查什么？

```
public class MyProgram {
    private static ArrayList < String > lista;
    public static void fileReading() {
        lista = new ArrayList < String > ();
        try {
            inp = new LineNumberReader(new BufferedReader(new InputStreamReader(new FileInputStream(inFileNev), "ISO8859-1")));
            String sor;
            while ((sor = inp.readLine()) != null) {
                lista.add(sor);
                lista.add(System.getProperty("line.separator"));
            }
            inp.close();
        } catch...
    }
    public static void searching() {
        Collections.replaceAll(lista, "a", "b");
        System.out.println(lista.toString());
    }
} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-11-06T18:07:43.790

```
List<String> list = Arrays.asList(new String[] {"a","b"});      
System.out.println(list);
Collections.replaceAll(list, "a", "!!!!!");
System.out.println(list); 
```

给

```
[a, b]
[!!!!!, b] 
```

上面的代码示例表明`Collections.replaceAll`确实有效。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T18:10:43.893

```
List<String> list = Arrays.asList(new String[] {"a","ba",new String("a")});      
Collections.replaceAll(list, "a", "!!!!!");
System.out.println(list); 
```

输出将是

`!!!!! ba !!!!!`

它不会替换“ba”中的“a”

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-06T18:07:44.190

这是一个解释 Collections.replaceAll 的示例

```
import java.util.ArrayList;
import java.util.Collections;
import java.util.List;

public class Test {
    public static void main(String[] args) {
        List<String> sLst = new ArrayList<String>();
        sLst.add("A");
        sLst.add("B");
        sLst.add("C");
        sLst.add("A");
        // This will replace all "A" with "Z"
        Collections.replaceAll(sLst, "A", "Z");
        System.out.println(sLst);// [Z, B, C, Z]

    }
} 
```

# ajax - Rails 远程表单完成处理程序触发但成功/失败不会

> ID：13256716
> 
> 赞同：0
> 
> 时间：2012-11-06T18:03:26.120
> 
> 标签：ajax, ruby-on-rails-3, remote-forms

我正在通过 rails 提交表单，并且响应带有 200 个 OK 标头。我的完整事件会触发，但成功或失败都不会触发。有任何想法吗？

JS：

```
$('form#booking-email').bind('ajax:complete',function(){
    alert('complete');

});

$('form#booking-email').bind('ajax:success',function(){
    alert('success');
});

$('form#booking-email').bind('ajax:failure',function(){
    alert('failure');

}); 
```

我的控制器

```
 respond_to do |format|
    format.json { head :ok }
  end 
```

响应：

```
Status: 200 OK

Cache-Control: max-age=0, private, must-revalidate

Connection: Keep-Alive

Content-Length: 1

Content-Type: application/json; charset=utf-8

Date: Sat, 03 Nov 2012 01:00:11 GMT

Etag: "7215ee9c7d9dc229d2921a40e899ec5f"

Server: WEBrick/1.3.1 (Ruby/1.9.2/2012-02-14)

Set-Cookie: _myeasybnb_session=BAh7CEkiD3Nlc3Npb25faWQGOgZFRkkiJWQ3NTE2ODMzZjMyY2RhZTU1NjAwMzk3MWIyYjdhZDMzBjsAVEkiEF9jc3JmX3Rva2VuBjsARkkiMTFNN1hvWGhUdytSSjVRcCtrdWFLVTk5NnBEQWF5QXVxRlR2L1pwV1JjUmM9BjsARkkiGXdhcmRlbi51c2VyLnVzZXIua2V5BjsAVFsISSIJVXNlcgY7AEZbBmkGSSIiJDJhJDEwJEJ3Uy5lTzI3Ly4xY05xWlhGZzJ3cy4GOwBU--bd4de54c468e9cedc322949bba91adb5a60bb92f; path=/; HttpOnly

X-Request-Id: 0bb75d4727fbe149b868214f39763030

X-Runtime: 2.183082

X-UA-Compatible: IE=Edge 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T15:03:59.960

我最终只使用了完整的功能并根据状态执行 if/else。笨拙而愚蠢，但是，嘿，它有效。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:20:29.420

尝试使用不同的网络浏览器。我在使用 jQuery 和一个浏览器时遇到了一些类似的问题。或者尝试使用状态值，而不是使用`:success`.

```
$.ajax({
  statusCode: {
    200: function() {
      alert('success');
    }
  }
}); 
```

# c# - 禁用在 TextBox 中选择文本

> ID：13256720
> 
> 赞同：8
> 
> 时间：2012-11-06T18:03:37.787
> 
> 标签：c#, .net, winforms, textbox

我有一个具有以下（重要）属性的文本框：

```
this.license.Multiline = true;
this.license.ReadOnly = true;
this.license.ScrollBars = System.Windows.Forms.ScrollBars.Vertical;
this.license.ShortcutsEnabled = false; 
```

它看起来像这样：

![带有突出显示的文本的文本框](../Images/56c8c99f939d5cceb97b980bec014050.png)

如何禁用用户突出显示此文本框中的文本（我不想完全禁用文本框）？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-06T18:13:17.573

附加到`SelectionChanged`事件，并在事件集内`e.Handled = true;`，`SelectionLength = 0;`并且将阻止选择发生。这类似于防止按键发生所需的操作。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2017-02-22T12:22:13.947

要禁用 中的选择突出显示`TextBox`，您可以覆盖`WndProc`和处理[`WM_SETFOCUS`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms646283(v=vs.85).aspx)消息并将其替换为[`WM_KILLFOCUS`](https://msdn.microsoft.com/en-us/library/windows/desktop/ms646282(v=vs.85).aspx). 请注意，它不会将`TextBox`控件设为只读，如果您需要将其设为只读，还应将`ReadOnly`属性设置为`true`. 如果您设置`ReadOnly`为 true，您可以将其设置`BackColor`为`White`或您想要的任何其他合适的颜色。

在下面的代码中，我添加了一个`SelectionHighlightEnabled`属性来`MyTextBox`使启用或禁用选择突出显示变得容易：

*   `SelectionHighlightEnabled`：获取或设置一个值，指示是否启用选择突出显示。默认情况下，该值的`true`行为类似于正常的`TextBox`. 如果将其设置为，`false`则不会呈现选择突出显示。

```
using System.ComponentModel;
using System.Windows.Forms;
public class MyTextBox : TextBox
{
    public MyTextBox()
    {
        SelectionHighlightEnabled = true;
    }
    const int WM_SETFOCUS = 0x0007;
    const int WM_KILLFOCUS = 0x0008;
    [DefaultValue(true)]
    public bool SelectionHighlightEnabled { get; set; }
    protected override void WndProc(ref Message m)
    {
        if (m.Msg == WM_SETFOCUS && !SelectionHighlightEnabled)
            m.Msg = WM_KILLFOCUS;

        base.WndProc(ref m);
    }
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-06T18:13:18.277

如果您将文本放入标签中，然后将标签放入`System.Widnows.Forms.Panel`已`AutoScroll`打开的控件中，则可以显示文本而不选择它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-05-02T10:47:46.870

我遇到了这个线程，因为我遇到了同样的问题。我以某种方式解决了它，如下所示，

```
if (sender != null)
                {
                    e.Handled = true;
                    if((sender as TextBox).SelectionLength != 0)
                        (sender as TextBox).SelectionLength = 0;
                } 
```

验证长度是否更改为 0 以外的值，然后仅将其设置为 0，即可解决递归循环。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-12-04T07:16:23.313

由于标准 TextBox 没有 SelectionChanged 事件，这就是我想出的。

```
private void TextBox1_MouseMove(object sender, MouseEventArgs e)
{
    TextBox1.SelectionLength = 0;
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-02-20T11:09:36.570

非常简单的解决方案

找到一个标签并进入文本框去 mousedown 事件并将焦点设置到标签

这是在VB中，可以很容易地转换成C#

```
Private Sub RichTextBox1_MouseDown(sender As Object, e As MouseEventArgs) Handles RichTextBox1.MouseDown
        Label1.Focus()
    End Sub 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-07-06T18:15:08.357

如果您使用的是 XAML / WPF，则应使用**TextBlock**而不是**TextBox**。

**仅当您使用文本框作为显示而不是用于输入** 时 - 因为 TextBlock 使文本看起来好像是“雕刻”到表单本身，而不是在文本框中。要获得 TextBlock 周围的边框（如果您愿意），您可以这样做：

在*XAML*中，例如：

```
<Border BorderThickness="1" BorderBrush="Gray">
    <TextBlock Background="White" Text="Your Own TextBlock"/>
</Border> 
```

或者在*C# 代码*中动态地：

```
//Create a Border object
Border border = new Border();
border.BorderThickness = new Thickness(1);
border.BorderBrush = Brushes.Black;

//Create the TextBlock object           
TextBlock tb = new TextBlock();
tb.Background = Brushes.White;
tb.Text = "Your Own TextBlock";

//Make the text block a child to the border
border.Child = tb; 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2016-08-26T15:41:12.690

您可以使用禁用`RichTextBox`并在之后将颜色重置为黑色。

```
RichTextBox rtb = new RichTextBox();
rtb.IsEnabled = false;
rtb.Text = "something";
rtb.SelectAll();
rtb.SelectionColor = Color.Black;
rtb.SelectedText = String.Empty; 
```

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2013-11-07T16:48:06.857

在 WinForms 中，正确的方法是分配事件 MouseMove 并将 SelectionLength 设置为 0。

我在这里尝试过并且效果很好。

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2015-11-23T09:41:31.227

```
private void textBox5_Click(object sender, EventArgs e)
{
    this.textBox5.SelectionStart = this.textBox5.Text.Length;
} 
```

# ruby-on-rails - 如何使用 Prawn 将 base64 字符串转换为 PNG，而不保存在 Rails 中的服务器上

> ID：13256723
> 
> 赞同：5
> 
> 时间：2012-11-06T18:03:49.327
> 
> 标签：ruby-on-rails, ruby, prawn

所以我正在尝试使用 Prawn gem 将画布的 PNG 图像嵌入到 PDF 中。Base64 字符串是使用 canvas 的 toDataURL() 函数生成的。由于图像仅在 PDF 中需要，我试图避免将其保存在服务器上。Params[:base64string] 已正确传递给服务器。

但是，我正在尝试使用

```
image = Prawn::Images::PNG.new(base64string) 
```

创建图像，但我得到 NoMethodError: undefined method `unpack' for nil:NilClass。

任何想法我做错了什么或应该如何正确完成？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:06:57.587

在[这里](https://groups.google.com/forum/?fromgroups=#!topic/prawn-ruby/zDh_dytNgfg)找到：

*大虾想要一个文件路径而不是编码的图像数据。您可以使用临时文件：*

```
require 'prawn'
require 'tempfile'
require 'active_support' # for base64

Prawn::Document.generate('/tmp/test.pdf') do
  file = Tempfile.new('image')
  file.write ActiveSupport::Base64.decode64(image)
  file.close

  image file.path
end 
```

希望这可以帮助！

# mysql - MySQL 在 if 语句中使用 create index 报告语法错误

> ID：13256725
> 
> 赞同：0
> 
> 时间：2012-11-06T18:03:55.440
> 
> 标签：mysql

我在数据库更新脚本中有以下代码：

```
set @index1 = ifnull((select count(1) from information_schema.statistics
    where table_name = 'Entries' and index_name = 'IX_Entries_EmailAddress'),0);

set @index2 = ifnull((select count(1) from information_schema.statistics 
    where table_name = 'Entries' and index_name = 'IX_Entries_FirstLastName'),0);

if (@index1 = 0) then create index IX_Entries_EmailAddress on Entries (EmailAddress);
if (@index2 = 0) then create index IX_Entries_FirstLastName on Entries (FirstName, LastName); 
```

MySQL 报告：

SQL 错误 (1064)：您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在 'if (@index1 = 0) 附近使用正确的语法，然后在第 1 行的 Entries (EmailAddr' 上创建索引 IX_Entries_EmailAddress

根据 MYSQL 文档，所有语法看起来都是正确的，我错过了什么？

编辑：明白了，感谢瑞恩的回答。

```
set @sqlcmd := if(@index1 = 0, 'create index IX_Entries_EmailAddress on Entries (EmailAddress);', '');
prepare stmt from @sqlcmd;
execute stmt;

set @sqlcmd := if(@index2 = 0, 'create index IX_Entries_FirstLastName on Entries (FirstName, LastName);', '');
prepare stmt from @sqlcmd;
execute stmt; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:22:08.103

并且`IF`这样的语句不能在常规脚本中使用 - 它是 MySQL[复合语句](http://dev.mysql.com/doc/refman/5.0/en/sql-syntax-compound-statements.html)。它们只能用于触发器、存储过程等。

在常规脚本中，您需要更新逻辑以不使用`IF`构造，而是使用一些内置函数，例如`IFNULL()`.

# python - 用于读取 LANDSAT XML 元文件的 Python 脚本

> ID：13256732
> 
> 赞同：1
> 
> 时间：2012-11-06T18:04:50.330
> 
> 标签：python, landsat

我需要获取多个 Landsat 图像的场景 ID。图像的元数据包含在一个 xml 文件中：

```
<?xml version="1.0"?>
<searchResponse xsi:schemaLocation="http://upe.ldcm.usgs.gov/schema/metadata
http://earthexplorer.usgs.gov/EE/metadata.xsd" 
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"    
xmlns="http://upe.ldcm.usgs.gov/schema/metadata">
    <metaData>
        <browseAvailable>Y</browseAvailable
        <browseURL>http://earthexplorer.usgs.gov/browse/tm/146/41/1998/LT51460411998300XXX01.jpg</browseURL> 
        <sceneID>LT51460411998300XXX01</sceneID> 
        <sensor>LANDSAT_TM</sensor> 
        <acquisitionDate>1998-10-27</acquisitionDate> 
        <dateUpdated>2012-07-31</dateUpdated> 
        <path>146</path> 
        <row>41</row> 
        <...>
     </metaData>
     <metaData>
        <sceneID>LT51460411998300XXX01</sceneID> 
        <sensor>LANDSAT_TM</sensor> 
        <acquisitionDate>1998-10-27</acquisitionDate> 
        <dateUpdated>2012-07-31</dateUpdated> 
        <path>146</path> 
        <row>41</row> 
        <...>
    <etc etc> 
```

以下代码将列出元数据中的所有节点（browseAvailable、browseURL、sceneID），但我真正想做的只是获取一个sceneID 列表。

```
#!/usr/bin/python

#import os
#import sys
from xml.dom.minidom import parse

import xml.etree.ElementTree as ET
#import grass.script as grass

tree = ET.parse('C:/Users/Simon/Documents/tif/Metadata/metadata_test1.xml')
root = tree.getroot()

for metadata in root:  
    for data in metadata:          
    sceneID = data.text
        grass.message('data -> %s' % (sceneID)) 
```

我尝试使用 Python xml.etree.ElementTree 上描述的工具，但没有成功。谁能帮我修改上面的代码只返回sceneID？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:31:38.183

试试这个：

```
#!/usr/bin/python

from xml.dom.minidom import parse

dom = parse('C:/Users/Simon/Documents/tif/Metadata/metadata_test1.xml')

ids  = dom.getElementsByTagName('sceneID')
for id in ids:
    print "%s" % id.childNodes[0].nodeValue 
```

# excel - 将 Excel 文档中的行与相同的电子邮件合并并保留合并的行数据

> ID：13256733
> 
> 赞同：0
> 
> 时间：2012-11-06T18:05:01.617
> 
> 标签：excel, vba

我有大约 50,000 条这样的记录的 Excel 表：

```
email   product  info   moreinfo
a@a.com   866   data   data1
b@b.com   960   data   data1
c@c.com   976   data   data1
c@c.com   884   data   data1
d@d.com   1010   data   data1
e@e.com   834   data   data1
f@f.com   981   data   data1
g@g.com   935   data   data1
g@g.com   832   data   data1
g@g.com   934   data   data1 
```

我需要把它转换成这样的东西：

```
email   product   info   moreinfo
a@a.com   866   data   data1
b@b.com   960   data   data1
c@c.com   976,884   data   data1
d@d.com   1010   data   data1
e@e.com   834   data   data1
f@f.com   981   data   data1
g@g.com   935,832,934   data   data1 
```

我需要将包含重复电子邮件的行合并为一个，并将 B 列中的信息合并到该电子邮件地址的一条记录中。我尝试了一些宏，但无济于事。你能帮助我吗？我在这里有点困惑。谢谢！

编辑：我在 Mac 上使用 Excel 2011。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:21:49.183

试试这个宏：

```
Sub ConsolidateRows()
'takes rows and consolidate one or many cells, based on one or many cells matching with above or below rows.

Dim lastRow As Long, i As Long, j As Long
Dim colMatch As Variant, colConcat As Variant

'**********PARAMETERS TO UPDATE****************
Const strMatch As String = "A"    'columns that need to match for consolidation, separated by commas
Const strConcat As String = "B"     'columns that need consolidating, separated by commas
Const strSep As String = ", "     'string that will separate the consolidated values
'*************END PARAMETERS*******************

application.ScreenUpdating = False 'disable ScreenUpdating to avoid screen flashes

colMatch = Split(strMatch, ",")
colConcat = Split(strConcat, ",")

lastRow = range("A" & Rows.Count).End(xlUp).Row 'get last row

For i = lastRow To 2 Step -1 'loop from last Row to one

    For j = 0 To UBound(colMatch)
        If Cells(i, colMatch(j)) <> Cells(i - 1, colMatch(j)) Then GoTo nxti
    Next

    For j = 0 To UBound(colConcat)
        if len(Cells(i - 1, colConcat(j)))>0 then _
            Cells(i - 1, colConcat(j)) = Cells(i - 1, colConcat(j)) & strSep & Cells(i, colConcat(j))
    Next

    Rows(i).Delete

nxti:
Next

application.ScreenUpdating = True 'reenable ScreenUpdating
End Sub 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:48:41.653

以下 VBA 代码应该适用于您正在尝试做的事情。它假定您的电子邮件地址在 A2:A50000 范围内，因此您可以根据需要进行更改。如果你对 VBA 不太熟悉，在 Excel 2011 Mac 的 Developer Tab 下，应该有一个名为 Visual Basic Editor 的图标。打开 VB 和 CMD+单击窗口窗格并插入一个新模块。然后粘贴以下代码：

```
Sub combineData()
Dim xCell As Range, emailRange As Range
Dim tempRow(0 To 3) As Variant, allData() As Variant
Dim recordCnt As Integer

Set emailRange = Range("A2:A11")
recordCnt = -1

'LOOP THROUGH EACH CELL AND ADD THE DATE TO AN ARRAY
For Each xCell In emailRange
    'IF THE CELL IS EQUAL TO THE ONE ABOVE IT,
    'ADD THE PRODUCT NUMBER SEPARATED WITH A COMMA
    If xCell = xCell.Offset(-1, 0) Then
        tempRow(1) = tempRow(1) & ", " & xCell.Offset(0, 1).Value
        allData(recordCnt) = tempRow
    Else
        recordCnt = recordCnt + 1
        If recordCnt = 0 Then
            ReDim allData(0 To recordCnt)
        Else
            ReDim Preserve allData(0 To recordCnt)
        End If
        tempRow(0) = xCell.Value
        tempRow(1) = xCell.Offset(0, 1).Value
        tempRow(2) = xCell.Offset(0, 2).Value
        tempRow(3) = xCell.Offset(0, 3).Value
        allData(recordCnt) = tempRow
    End If
Next xCell

'CREATE A NEW WORKSHEET AND DUMP IN THE CONDENSED DATA
Dim newWs As Worksheet, i As Integer, n As Integer

Set newWs = ThisWorkbook.Worksheets.Add

For i = 0 To recordCnt
    For n = 0 To 3
        newWs.Range("A2").Offset(i, n) = allData(i)(n)
    Next n
Next i

End Sub 
```

然后关闭 VB，然后单击“开发人员”选项卡下的“宏”按钮。然后运行 ​​combineData。这应该会给你你正在寻找的结果。如果您有任何问题，请告诉我！

# python - 适合快速单写者/慢读者（cpython）的互斥锁？

> ID：13256735
> 
> 赞同：3
> 
> 时间：2012-11-06T18:05:11.483
> 
> 标签：python, multithreading, mutex, shared-memory

在我的应用程序中，我有一个线程在日志行上执行非常快速的处理以产生一个浮点值。通常只有一个其他线程每隔一段时间对值执行慢速读取。每隔一段时间，其他线程就会来来去去，并对这些值执行一次性读取。

我的问题是关于互斥体（在 cpython 中）的必要性，对于这种数据只是可用的最新数据的特定情况。它不是必须与其他任何东西（甚至是同时写入的其他字段）同步的临界值。只是简单地......它的价值是什么。

话虽如此，我知道我可以轻松地添加一个锁（或读取器/写入锁）来保护值的更新，但我想知道整个日志过程中获取/释放的开销是否快速连续（假设平均 5000 行）只是“适当地”做共享资源是不值得的。

基于文档上[什么样的全局值突变是线程安全的？](http://docs.python.org/2/faq/library#what-kinds-of-global-value-mutation-are-thread-safe)，这些赋值应该是原子操作。

这是逻辑的基本示例：

```
import time
from random import random, choice, randint
from threading import Thread 

class DataStructure(object):
    def __init__(self):
        self.f_val = 0.0
        self.s_val = ""

def slow_reader(data):
    """ 
    Loop much more slowly and read values 
    anywhere between 1 - 5 second intervals
    """
    for _ in xrange(10):

        f_val = data.f_val 
        # don't care about sync here
        s_val = data.s_val

        print f_val, s_val

        # in real code could be even 30 or 60 seconds
        time.sleep(randint(1,3))

def fast_writer(data):
    """ Update data extremely often """
    for _ in xrange(20000):
        f_val, s_val = do_work()

        data.f_val = f_val
        # don't care about sync here
        data.s_val = s_val 

FLOAT_SRC = [random()*100 for _ in xrange(100)]
STR_SRC = ['foo', 'bar', 'biz', 'baz']

def do_work():
    time.sleep(0.001)
    return choice(FLOAT_SRC), choice(STR_SRC)

if __name__ == "__main__":

    data = DataStructure()

    threads = [
        Thread(target=slow_reader, args=(data,)),
        Thread(target=fast_writer, args=(data,)),
    ]

    for t in threads:
        t.daemon=True
        t.start()

    for t in threads:
        t.join() 
```

这表示快速日志解析器（实际上是通过 PIPE 读取）在每一行上工作，而缓慢的周期性读取器抓取当时的当前值。在任何时候，另一个一次性读取线程可能会来来去去从数据结构中获取相同的值。

这是完全不需要 cpython 中的互斥锁的情况吗？

**Edit**

To clarify a bit more... I don't even need the float and string fields to be in sync from the last write. It is ok if the scheduler decides to switch contexts between the float and string reads. I'm just wondering if I even need the overhead of a lock to simply read whatever value is assigned at any moment in time.

My concern is regarding the fact that the writer is going to be looping, on an extremely fast operating, locking and unlocking a lock that is often un-contended.

Effectively assume this is all I care about in the `reader`:

```
def slow_reader(data):
    for _ in xrange(10):
        f_val = data.f_val 
        print f_val
        time.sleep(randint(1,3)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:30:54.833

You need a mutex when doing concurrent accesses:

*   on composite values, and one of these accesses must modify the value in multiple spots atomically;
*   on simple values, and at least two of these accesses are writing.

In your example, the value is composite (2 fields), and the modification operates on multiple spots (these 2 fields), so you should put a mutex to ensure that the reader doesn't get scheduled in between the two modifications.

EDIT: If the reader doesn't care about the fields being in sync, then you don't need a mutex.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T19:48:32.023

You should lock the container in reader when acquiring a single existing item, but if the item itself is not modified by anything any more and will not get moved, you ca release the mutex as soon as reader has the item.

If item may be modified, you can either get a quick copy and release mutex, or have separate mutex for the individual item, so rest of the container can bw worked on by others. Your case sounds like you do not need to worry about this though.

If you have many readers which should pick oldest unprocessed item, then you need a queue (which might be as simple as index of latest taken item) and a separate mutex for it. This might even be an atomic integer, so you could avoid needing a mutex altogether for the "queue".

Actually, with suitable atomic integer arrangement and polling, you could avoid mutexes completely. An atomic integer index for latest complete item, increased by writer and only read by polling readers. Second atomic integer index for latest taken item, increased by readers, which then start waiting for that index to be ready (if it is not ready yet).

(Readers polling can be avoided by some notify mechanism, but these require a mutex lock or socket, both pretty expensive).

# java - 错误：“应用程序意外停止。请重试。”

> ID：13256736
> 
> 赞同：0
> 
> 时间：2012-11-06T18:05:19.507
> 
> 标签：java, android

我的应用程序前几次运行良好，现在决定“意外”停止。我尝试了以下方法，看看是否可以解决它，但无济于事：

1.  从 Eclipse 中重新启动 adb（使用 Window>show view>devices）。
2.  关闭 Eclipse，手动杀死 adb 然后重新启动它。
3.  删除已安装的应用程序，然后重新安装。

我注意到一半的时间，Eclipse 似乎总是因为一些断开连接问题（为什么它一直这样做变得越来越严重）而在尝试启动 HOME 时挂断，所以我总是再次点击 Run 并启动另一个模拟器（见下面的控制台对话框）。

```
 [2012-11-06 11:58:03 - CostALoad] ------------------------------
 [2012-11-06 11:58:03 - CostALoad] Android Launch!
 [2012-11-06 11:58:03 - CostALoad] adb is running normally.
 [2012-11-06 11:58:03 - CostALoad] Performing com.example.costaload.MainActivity activity launch
 [2012-11-06 11:58:04 - CostALoad] Automatic Target Mode: launching new emulator with compatible AVD 'myavd'
 [2012-11-06 11:58:04 - CostALoad] Launching a new emulator with Virtual Device 'myavd'
 [2012-11-06 11:58:06 - CostALoad] New emulator found: emulator-5554
 [2012-11-06 11:58:06 - CostALoad] Waiting for HOME ('android.process.acore') to be launched...
 [2012-11-06 11:58:40 - CostALoad] HOME is up on device 'emulator-5554'
 [2012-11-06 11:58:40 - CostALoad] Uploading CostALoad.apk onto device 'emulator-5554'
 [2012-11-06 11:58:42 - CostALoad] Installing CostALoad.apk...
 [2012-11-06 11:59:01 - CostALoad] Success!
 [2012-11-06 11:59:02 - CostALoad] Starting activity com.example.costaload.MainActivity on device 
   emulator-  5554
 [2012-11-06 11:59:04 - CostALoad] ActivityManager: Starting: Intent { act=android.intent.action.MAIN
  cat=[android.intent.category.LAUNCHER] cmp=com.example.costaload/.MainActivity }
 [2012-11-06 12:17:00 - CostALoad] ------------------------------
 [2012-11-06 12:17:00 - CostALoad] Android Launch!
 [2012-11-06 12:17:00 - CostALoad] adb is running normally.
 [2012-11-06 12:17:00 - CostALoad] Performing com.example.costaload.MainActivity activity launch
 [2012-11-06 12:17:01 - CostALoad] Automatic Target Mode: launching new emulator with compatible AVD 'myavd'
 [2012-11-06 12:17:01 - CostALoad] Launching a new emulator with Virtual Device 'myavd'
 [2012-11-06 12:17:25 - CostALoad] New emulator found: emulator-5554
 [2012-11-06 12:17:25 - CostALoad] Waiting for HOME ('android.process.acore') to be launched...
 [2012-11-06 12:18:43 - CostALoad] emulator-5554 disconnected! Cancelling 'com.example.costaload.MainActivity 
    activity launch'!
 [2012-11-06 12:20:07 - CostALoad] ------------------------------
 [2012-11-06 12:20:07 - CostALoad] Android Launch!
 [2012-11-06 12:20:07 - CostALoad] adb is running normally.
 [2012-11-06 12:20:07 - CostALoad] Performing com.example.costaload.MainActivity activity launch
 [2012-11-06 12:20:07 - CostALoad] Automatic Target Mode: launching new emulator with compatible AVD 'myavd'
 [2012-11-06 12:20:07 - CostALoad] Launching a new emulator with Virtual Device 'myavd'
 [2012-11-06 12:20:22 - Emulator] WARNING: Data partition already in use. Changes will not persist!
 [2012-11-06 12:20:22 - Emulator] WARNING: Cache partition already in use. Changes will not persist!
 [2012-11-06 12:20:23 - CostALoad] New emulator found: emulator-5556
 [2012-11-06 12:20:23 - CostALoad] Waiting for HOME ('android.process.acore') to be launched...
 [2012-11-06 12:22:07 - CostALoad] HOME is up on device 'emulator-5556'
 [2012-11-06 12:22:07 - CostALoad] Uploading CostALoad.apk onto device 'emulator-5556'
 [2012-11-06 12:22:08 - CostALoad] Installing CostALoad.apk...
 [2012-11-06 12:22:26 - CostALoad] Success!
 [2012-11-06 12:22:27 - CostALoad] Starting activity com.example.costaload.MainActivity on device 
    emulator-5556
 [2012-11-06 12:22:31 - CostALoad] ActivityManager: Starting: Intent { act=android.intent.action.MAIN 
    cat=[android.intent.category.LAUNCHER] cmp=com.example.costaload/.MainActivity } 
```

因此，您可以看到我在哪里点击 RUN，然后 5556 开始、上传然后停止。这一直持续整个上午，我上面描述的所有步骤似乎都没有解决这个问题。

当我查看 LOGCAT 时，我承认我并不擅长尝试弄清楚，因为那里有一些我无法识别的东西，因为我是初学者（例如：“zygote”??、looper 等）。换句话说，我无法理解代码在前几次如何正常工作，现在正在抛出下面日志中显示的内容。我唯一认识的是 android 按钮小部件，它是某种类型的转换异常。奇怪，因为它只是一个按钮侦听器和案例结构来侦听哪个按钮被按下。除此之外，我不知道，行号用于我什至不知道的文件。

```
 11-06 12:22:33.080: D/ddm-heap(223): Got feature list request
 11-06 12:22:34.350: D/AndroidRuntime(223): Shutting down VM
 11-06 12:22:34.350: W/dalvikvm(223): threadid=3: thread exiting with uncaught exception (group=0x4001b188)
 11-06 12:22:34.359: E/AndroidRuntime(223): Uncaught handler: thread main exiting due to uncaught exception
 11-06 12:22:34.369: E/AndroidRuntime(223): java.lang.RuntimeException: Unable to start activity
   ComponentInfo{com.example.costaload/com.example.costaload.MainActivity}: java.lang.ClassCastException:   
   android.widget.Button
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.ActivityThread.performLaunchActivity
   (ActivityThread.java:2496)
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.ActivityThread.handleLaunchActivity
   (ActivityThread.java:2512)
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.ActivityThread.access$2200
   (ActivityThread.java:119)
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.ActivityThread$H.handleMessage
   (ActivityThread.java:1863)
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.os.Handler.dispatchMessage(Handler.java:99)
 11-06 12:22:34.369: E/AndroidRuntime(223):     at android.os.Looper.loop(Looper.java:123) 
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.ActivityThread.main(ActivityThread.java:4363)
 11-06 12:22:34.369: E/AndroidRuntime(223):     at java.lang.reflect.Method.invokeNative(Native Method)
 11-06 12:22:34.369: E/AndroidRuntime(223):     at java.lang.reflect.Method.invoke(Method.java:521)
 11-06 12:22:34.369: E/AndroidRuntime(223): at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run
   (ZygoteInit.java:860)
 11-06 12:22:34.369: E/AndroidRuntime(223): at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:618)
 11-06 12:22:34.369: E/AndroidRuntime(223): at dalvik.system.NativeStart.main(Native Method)
 11-06 12:22:34.369: E/AndroidRuntime(223): Caused by: java.lang.ClassCastException: android.widget.Button
 11-06 12:22:34.369: E/AndroidRuntime(223): at com.example.costaload.MainActivity.onCreate
   (MainActivity.java:28)
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.Instrumentation.callActivityOnCreate
   (Instrumentation.java:1047)
 11-06 12:22:34.369: E/AndroidRuntime(223): at android.app.ActivityThread.performLaunchActivity
   (ActivityThread.java:2459)
 11-06 12:22:34.369: E/AndroidRuntime(223):     ... 11 more
 11-06 12:22:34.419: I/dalvikvm(223): threadid=7: reacting to signal 3
 11-06 12:22:34.419: E/dalvikvm(223): Unable to open stack trace file '/data/anr/traces.txt': 
   Permission denied
 11-06 12:27:34.529: I/Process(223): Sending signal. PID: 223 SIG: 9 
```

试着解释错误，我最好的猜测是它与按钮小部件有关，其余的看起来像是 Java 本身因为某些事情而急转直下。LOGCAT 正在引用我不知道它是什么或从未接触过的东西。我还能做些什么来阻止这一切的发生？我在下面包含了我的代码，就像我说的那样，它之前已经运行过，现在我看不出问题出在哪里，或者我的项目文件中是否有某些东西导致了它：

```
 package com.example.costaload;

 import java.text.DecimalFormat;
 import java.text.NumberFormat;

 import android.os.Bundle;
 import android.app.Activity;
 import android.content.Intent;
 import android.widget.CheckBox;
 import android.widget.EditText;
 import android.widget.Button;
 import android.widget.TextView;
 import android.view.View;

public class MainActivity extends Activity {
EditText mile,diesel;
Button button1, button2;
TextView tv, tv2, tv3;
private double x, y, z, costper, gallon, litres, ophours, stopdrive;
CheckBox checkBox1, checkBox2, checkBox3, checkBox4;
NumberFormat format  = NumberFormat.getCurrencyInstance();
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    mile= (EditText) findViewById(R.id.mile);
    checkBox1 = (CheckBox) findViewById(R.id.checkBox1);
    checkBox2 = (CheckBox) findViewById(R.id.checkBox2);
    checkBox3 = (CheckBox) findViewById(R.id.checkBox3);
    checkBox4 = (CheckBox) findViewById(R.id.checkBox4);         
    button1 = (Button) findViewById(R.id.button1);
    button2 = (Button) findViewById(R.id.button2);
    button1.setOnClickListener(onClickListener);
    button2.setOnClickListener(onClickListener);
    tv = (TextView) findViewById(R.id.cost);
    tv2 = (TextView) findViewById(R.id.cpm);
    tv3 = (TextView) findViewById(R.id.gallons);
    diesel= (EditText) findViewById(R.id.diesel);
         }

 private OnClickListener onClickListener = new OnClickListener() {
   @Override
   public void onClick(final View v) {
       switch(v.getId()){
         case R.id.button1:
            x=Double.parseDouble(mile.getText().toString());
            y=Double.parseDouble(diesel.getText().toString());
            if (checkBox2.isChecked()) {
                 x=x*2;
             }
            if (checkBox1.isChecked()) {
                x=x*0.62137;
            }
            ophours = 0;
            ophours = (x/55)+2;
            if (ophours>=11){
                stopdrive = (ophours/10)-1;
                if (stopdrive>1){
                    ophours = ophours + (stopdrive*10);
            }
            gallon = x/5.5;
            if (checkBox4.isChecked()) {
                gallon = gallon + (ophours*1.1);
            }
            if (checkBox3.isChecked()) {
                litres = gallon*3.785;
                tv3.setText(new DecimalFormat("####.##").format(litres)+"L");
            }
            z=(gallon*y)+(x*0.655);
            costper=z/x;
            tv.setText(format.format(z));
            tv2.setText(format.format(costper)+"/mile"); 
            tv3.setText(new DecimalFormat("####.##").format(gallon)+"gal.");
         break;}
         case R.id.button2:
            Intent browserIntent = 
            new Intent(Intent.ACTION_VIEW, Url.parse("http://www.ratenroll.com"));
                                 startActivity(browserIntent);   
         break;
   }
   };
   };
 } 
```

这是主要活动的 XML，我很困惑，因为所有按钮都是按钮等等：

```
 <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
 xmlns:tools="http://schemas.android.com/tools"
 android:layout_width="match_parent"
 android:layout_height="match_parent" >

 <TextView
    android:id="@+id/textView1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_alignParentTop="true"
    android:text="# of miles"
    android:textAppearance="?android:attr/textAppearanceMedium" />

 <TextView
    android:id="@+id/textView2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/textView1"
    android:layout_marginTop="40dp"
    android:text="Price of diesel"
    android:textAppearance="?android:attr/textAppearanceMedium" />

 <EditText
    android:id="@+id/diesel"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView2"
    android:layout_alignBottom="@+id/textView2"
    android:layout_alignLeft="@+id/mile"
    android:layout_alignParentRight="true"
    android:ems="10"
    android:inputType="numberDecimal" />

 <EditText
    android:id="@+id/mile"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentRight="true"
    android:layout_alignParentTop="true"
    android:layout_toRightOf="@+id/checkBox3"
    android:ems="10"
    android:inputType="numberDecimal" >

    <requestFocus />
  </EditText>

 <Button
    android:id="@+id/button2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_centerHorizontal="true"
    android:text="Visit www.ratenroll.com" />

 <CheckBox
    android:id="@+id/checkBox1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/diesel"
    android:layout_marginTop="14dp"
    android:text="Kilometres (not miles)" />

 <CheckBox
    android:id="@+id/checkBox2"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/checkBox1"
    android:layout_alignBottom="@+id/checkBox1"
    android:layout_alignParentRight="true"
    android:text="Round trip" />

 <CheckBox
    android:id="@+id/checkBox3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/checkBox1"
    android:text="Litres (not gallons)" />

 <CheckBox
    android:id="@+id/checkBox4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/checkBox3"
    android:layout_alignBottom="@+id/checkBox3"
    android:layout_alignParentRight="true"
    android:text="Reefer load" />

 <Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_below="@+id/checkBox3"
    android:layout_marginTop="50dp"
    android:layout_toRightOf="@+id/textView2"
    android:text="Compute" />

 <TextView
    android:id="@+id/textView3"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/button1"
    android:layout_marginTop="26dp"
    android:text="Total Cost"
    android:textAppearance="?android:attr/textAppearanceLarge" />

 <TextView
    android:id="@+id/textView4"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignParentLeft="true"
    android:layout_below="@+id/textView3"
    android:text="Cost per mile"
    android:textAppearance="?android:attr/textAppearanceLarge" />

 <TextView
    android:id="@+id/cost"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_above="@+id/textView4"
    android:layout_alignParentRight="true"
    android:text=" "
    android:textAppearance="?android:attr/textAppearanceLarge" />

 <TextView
    android:id="@+id/cpm"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView4"
    android:layout_alignBottom="@+id/textView4"
    android:layout_alignParentRight="true"
    android:text="   "
    android:textAppearance="?android:attr/textAppearanceLarge" />

 <TextView
    android:id="@+id/textView5"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignRight="@+id/textView4"
    android:layout_below="@+id/textView4"
    android:text="Fuel required"
    android:textAppearance="?android:attr/textAppearanceLarge" />

  <TextView
    android:id="@+id/gallons"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_alignBaseline="@+id/textView5"
    android:layout_alignBottom="@+id/textView5"
    android:layout_alignParentRight="true"
    android:text="   "
    android:textAppearance="?android:attr/textAppearanceLarge" />

 </RelativeLayout> 
```

谢谢你看。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:13:46.163

您可以通过查看直接跟随以开头的行的 LogCat 行来找到导致错误的行`Caused by:`

基本上格式是这样的：

```
Caused by: (error type)
at:problematic method:line number 
```

所以对你来说，答案就在这里：

```
11-06 12:22:34.369: E/AndroidRuntime(223): Caused by: java.lang.ClassCastException: android.widget.Button
11-06 12:22:34.369: E/AndroidRuntime(223): at com.example.costaload.MainActivity.onCreate (MainActivity.java:28) 
```

MainActivity 类中 onCreate 方法的第 28 行是问题所在。

```
checkBox1 = (CheckBox) findViewById(R.id.checkBox1); 
```

类转换异常？您确定的该视图不是 CheckBox。

您的 MainActivity 似乎没有导入 R 类（您正在使用）。我不确定您拥有哪个版本的 Eclipse，或者它是否以某种奇怪的方式处理此问题，但它可能会默认为您不想要的某个值。

将其与其他导入一起放在代码的顶部

```
import com.example.costaload.R; 
```

另一件事：我不确定这是否是您的意图，但您语句中`break;`第一个命令位于 if 块内。如果小于 11，您的 switch 语句将进入下一个案例。`case``switch``ophours`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:16:53.247

本质上，（可能）您拥有的“按钮”之一实际上不是按钮，请确保 button1 和 button2 实际上是您的 layout.xml 文件中的按钮。您不能（例如）将 TextView 转换为 Button。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:22:28.437

您是否检查过在 activity_main 布局中是否有 Button 类型的 button1 和 button2 元素？如果是这样，请尝试清理项目以使 ADT 重写 R 文件。

当你开始学习Android编程时，这种问题经常发生（例如忘记更改清单等）。

# c# - 如何检查 Windows 8 设备当前是否正在通过 wifi/移动数据连接发送/接收数据？

> ID：13256737
> 
> 赞同：1
> 
> 时间：2012-11-06T18:05:30.707
> 
> 标签：c#, windows-8, windows-runtime, network-connection

我想看看是否有移动数据活动。如何使用 WinRT api (c#) 执行此操作？我可以检查设备是否有活动的移动数据、以太网或 wifi 连接，但似乎无法检查这些连接中的任何一个当前是否正在发送/接收数据。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-11T18:09:02.397

您可以使用[http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.connectivity.datausage.aspx](http://msdn.microsoft.com/en-us/library/windows/apps/windows.networking.connectivity.datausage.aspx)并检查 bytesReceived 属性。如果它改变了，数据只是被传输了。有关如何使用它的更多信息，请参阅链接的快速入门。

除此之外，我认为没有专门的 API。

# jquery - 多选小部件

> ID：13256738
> 
> 赞同：1
> 
> 时间：2012-11-06T18:05:34.307
> 
> 标签：jquery, multi-select

我正在实现以下 jQuery 插件 jQuery UI MultiSelect Widget 一切正常。

但是，当我加载已经选择了某些部分的表单/页面时，它不会在小部件的视觉效果中显示/表示它，当我删除小部件时，它会在加载时显示实际选择的项目。

有没有人遇到过这个并有解决方案。

在加载时，我有以下选择集 EG：

```
 <select name="example-presets" multiple="multiple" size="5">
    <option value="option1" selected="selected">Option 1</option>
    <option value="option2" selected="selected">Option 2</option>
    <option value="option3">Option 3</option>
    <option value="option4" selected="selected">Option 4</option>
  </select> 
```

不，当我在没有插件的情况下加载页面时，选择将显示'selected =“selected”'选项但是当我隐含插件然后重新加载页面时，然后单击打开链接所有'selected =“selected” ' 项目未显示为被选中，所有复选框均未选中。

我正在尝试执行以下操作，但似乎不想玩： [http ://www.erichynds.com/examples/jquery-ui-multiselect-widget/demos/preselected.htm](http://www.erichynds.com/examples/jquery-ui-multiselect-widget/demos/preselected.htm)

所选选项是使用 php 生成的，并且不像这个 EG thou 那样是静态的。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:39:32.747

好吧，经过一番调查，我使用的当前代码似乎是 UI Widget 1.14pre，所以查看他们的示例我注意到他们的版本是 UI Widget 1.13，所以我改用了这个版本，并且一切正常。

非常感谢

# python - 字符串到 int 的转换错误？

> ID：13256746
> 
> 赞同：2
> 
> 时间：2012-11-06T18:05:59.897
> 
> 标签：python

> **可能重复：**
> [Python“is”运算符对整数的行为异常](https://stackoverflow.com/questions/306313/python-is-operator-behaves-unexpectedly-with-integers)

在 python 2.6.6 中，当我使用 int() 将字符串转换为数字时，如果字符串为 257 或更大，则以下代码的行为不正确。

```
curr = int("256")  
myint = int("256")  
if curr is myint:  
    print("true")  
else:  
    print("false") 
```

这返回 true 这是正确的

```
curr = int("257")  
myint = int("257")  
if curr is myint:  
    print("true")  
else:  
    print("false") 
```

这返回错误？？？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-06T18:07:54.013

您不应该使用`is`来比较整数。改为使用`==`。

`is`应该只用于测试两个变量是否指向同一个对象。在 Python 中，较小的数字会被隐藏，并且您*通常*会为相同的 int 文字获得相同的对象，但并非总是如此，对于较大的数字也不会。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-06T18:10:23.630

那是因为从`-5`to 到的所有整数`256`都被缓存了，所以你会得到`is`它们`True`。

阅读[Python 整数对象实现](http://www.laurentluce.com/posts/python-integer-objects-implementation/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:10:09.207

您应该使用`==`运算符来比较整数，并`is`在比较 None 或相同对象时使用。

```
>>> a = 257
>>> b = 257
>>> a is b
False
>>> a == b
True 
```

# image - matlab图像平滑与conv2

> ID：13256751
> 
> 赞同：1
> 
> 时间：2012-11-06T18:06:21.417
> 
> 标签：image, matlab, average, convolution, smoothing

我是图像处理的新手，在实现图像平滑时发现了一些困难。

基本上，我有一个图像 A，我想用它的局部平均值替换所有像素。所以我定义掩码 M1 = one(10) 并使用

```
 newImage = conv2(A, M1,'same') 
```

它工作正常。但是在图像 A 中，完全由于噪声而存在毫无意义的像素，我不想将它们包括在平均中。我该怎么做，比如说有意义的像素是通过另一个蒙版 M2 定义的？

我在图像上做了一个简单的循环。它可以工作，但比 conv2() 慢得多。

```
for i = 1:self.row
    for j = 1:self.col
        if self.M2(i,j) % only treat meaningful pixels
            A(i,j) = self.createAvgPhasor(i,j);
        end
    end
end

    function [s_avg]=createAvgPhasor(self,m,n)
        % bound box along x 
        if m > self.rB
            xl = m - self.rB;
        else
            xl = 1;
        end
        if m < self.row_rB
            xu = m + self.rB;
        else
            xu = self.row;
        end
        % bound box along y 
        if n > self.rB
            yl = n - self.rB;
        else
            yl = 1;
        end
        if n < self.col_rB
            yu = n + self.rB;
        else
            yu = self.col;
        end
        M1 = false(self.row,self.col);
        M1(xl:xu,yl:yu) = true;
        msk = M1 & self.M2;
        s_avg = mean(self.Phi(msk));
    end 
```

非常感谢您的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:10:03.663

一种快速解决方法是用总平​​均值替换掩码像素中的所有值。

一种更精细的方法是将一个大的（非常大的）平滑滤波器（就像您已经使用但更大的那个）与图像进行卷积，并且只使用结果来填充原始图像中的蒙版像素，因为您有合理的值对于原始图像中的蒙版像素，您可以像现在一样使用卷积。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T20:25:42.633

从卷积中排除坏点很容易。如果`M2`包含`1`您想要包含的像素，以及`0`您不包含的像素，那么您只需执行以下操作：

```
newImage = conv2(A.*M2, M1,'same'); 
```

这可能足以满足您的目的，但您必须准确确定“平均”的含义。例如，给定您的 kernal `ones(10)`，最后您可能想要执行以下操作：

```
npts = conv2(ones(size(A)).*M2, M1, 'same')
newImage = newImage./npts 
```

即，将每个像素除以实际包含在该像素卷积中的像素数。

实际上，即使您以不同的方式加权不同的点，上述方法也可能会做正确的事情。但这实际上取决于您想要做什么。

# c++ - 使用 Lib3ds 获取顶点数组

> ID：13256753
> 
> 赞同：1
> 
> 时间：2012-11-06T18:06:28.423
> 
> 标签：c++

我正在尝试从 lib3ds 解析的文件中获取顶点，但遇到了很多问题。即我没有得到我出去的顶点。我尝试这样做的代码是：

```
//loop through meshes
for(int i = 0; i < model->meshes_size; i++)
{
    Lib3dsMesh* mesh = model->meshes[i];
    //loop through the faces in that mesh
    for(int j = 0; j < model->meshes[i]->nfaces; j++)
    {
        int testv = mesh->nvertices;
        Lib3dsFace face = mesh->faces[i];
        //loop through the vertices in each face
        for(int k = 0; k < 3; k++)
        {
            myVertices[index] = model->meshes[i]->faces[j].index[0];
            myVertices[index + 1] = model->meshes[i]->faces[j].index[1];
            myVertices[index + 2] = model->meshes[i]->faces[j].index[2];

            index += 3;
        }
    }
} 
```

不幸的是，lib3ds 的文档不存在，所以我无法弄清楚。你如何使用这个库获取顶点数组？另外我知道 3ds 很旧，但库的格式和设置方式适合我的目的，所以请不要建议切换到另一种格式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T20:15:47.820

如果有人遇到这个问题，这里是从 lib3ds 获取顶点然后将它们加载到单个顶点数组中的代码。该数组仅包含 x、y、z、x2、y2、z2 等形式的数据。

```
void Renderer3ds::loadVertices(string fileName)
{
    Lib3dsFile* model = lib3ds_file_open(fileName.c_str());

    if(!model)
    {
        throw strcat("Unable to load ", fileName.c_str());
    }

    int faces = getNumFaces(model);
    myNumVertices = faces * 3;
    myVertices = new double[myNumVertices * 3];

    int index = 0;

    //loop through meshes
    for(int i = 0; i < model->meshes_size; i++)
    {
        Lib3dsMesh* mesh = model->meshes[i];
        //loop through the faces in that mesh
        for(int j = 0; j < mesh->nfaces; j++)
        {
            Lib3dsFace face = mesh->faces[j];
            //loop through the vertices in each face
            for(int k = 0; k < 3; k++)
            {
                myVertices[index] = mesh->vertices[face.index[k]][0];
                myVertices[index + 1] = mesh->vertices[face.index[k]][1];
                myVertices[index + 2] = mesh->vertices[face.index[k]][2];

                index += 3;
            }
        }
    }
} 
```

# memory - 计算虚拟内存表的大小？

> ID：13256754
> 
> 赞同：1
> 
> 时间：2012-11-06T18:06:39.007
> 
> 标签：memory, memory-management, virtual-memory

这不是家庭作业问题，这是我们在课堂上解决的问题，但我的教授在最后一部分失去了我。这里是：

对于页大小为 1KB 的 16GB 虚拟内存，虚拟内存表有多大？

首先我们确定物理内存页数 = 64MB/1024 = (2^6 * 2^20)/2^10= 2^16 = 65,536 *这意味着我们有 65,536 个可能的地址，地址块需要位于至少 16
位长（加上 1 位用于有效标志和 1 用于脏标志）

其次，我们确定了虚拟内存页数 = (2^34)/(2^10)= 2^24

下一部分，我们实际计算 VMT 大小的地方是他失去了我！

(2^24 * 16 位) + (2^24 * 1 位) + (2^242 * 1 位) //我明白这一点

(2^24 * 2) + (2^21) + (2^21) =//不知道他是怎么得到这些数字的

2^25+ 2^21 + 2^21 = 32MB + 2MB + 2MB= 36MB //也不知道他是怎么得到这个的

所以 VMT 的大小显然是 36MB

所以基本上我理解了所有内容，直到最后一部分的最后两个步骤。我知道我们这样做“（2^24 * 16 位）+（2^24 * 1 位）+（2^242 * 1 位）”，因为我们有 2^24 个 VM 页面，每个页面都有 18 位，我我只是迷失了他如何进一步简化这个！

我不知道是我写错了数字（他的字迹确实很邋遢）还是什么！

所以任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T14:56:50.117

从你的问题：

> (2^24 * 16 位) + (2^24 * 1 位) + (2^24 * 1 位) //我明白这一点
> 
> = (2^24 * 2) + (2^21) + (2^21) =//不知道他是怎么得到这些数字的

他在这一步将位转换为字节。所以 16 位变成“2”，而 1 位变成 1/8 字节，即 (1/(2^3)) 字节乘以 2^24 得到 2^21。

这是中间步骤：

```
= (2^24 * 2 bytes) + (2^24 * 1/8 bytes)     + (2^24 * 1/8 bytes)
= (2^24 * 2 bytes) + (2^24 * 1/(2^3) bytes) + (2^24 * 1/(2^3) bytes)
= 2^25             + 2^21                   + 2^21 
```

然后将字节转换为 MB 得到 32MB + 2MB + 2MB。

这是此设置中 VMT 大小的一个非常理论上的界限。将 18 位条目打包到页面中对于查找来说效率不是很高（事实上，18 位条目并不能均匀地放入 1k 页面中，455 个条目占用了 1k 中除了 2 位之外的所有内容）。标志位可以与打包的 16 位页码分开存储，以保持对齐和密度（或者可以忽略该问题，您只需进行数学运算以查找 18 位条目）。鉴于物理内存的虚拟内存要大得多，根据定义，地址空间将是稀疏的（除非您将同一页面映射到多个位置），因此这种打包的线性表示将浪费更多的空间。在现实世界中，VMT 是分层的，条目紧密排列，条目与自然边界对齐。想必你稍后会在课堂上讲到。

# spring - Spring和hibernate的事务管理，使用isolation_serializable

> ID：13256760
> 
> 赞同：3
> 
> 时间：2012-11-06T18:07:09.987
> 
> 标签：spring, transactions, hibernate-mapping, transaction-isolation

我正在使用 Spring 事务管理来控制具有休眠状态的应用程序，它使用两个线程实例来访问并发数据库并修改一个表。它确保值是守恒的。之前的表格是：

```
 quantidade_livro_id | quantidade | livro_id | tt 
  ---------------------+------------+----------+----
                     7 |        100 |        3 | as 
                     5 |        100 |        1 | as
                     6 |        100 |        2 | as 
```

之后的表格：

```
 quantidade_livro_id | quantidade | livro_id | tt 
  ---------------------+------------+----------+----
               7 |        100 |        3 | as
               5 |         50 |        1 | as
               6 |        150 |        2 | as 
```

主代码启动两个线程：

```
 Servico t1 = new Servico();
        Servico t2 = new Servico();
        //transaction 1
        t1.setId1(5);
        t1.setValorTransacao(50);
        t1.setId2(6);
        //transaction 2     
        t2.setId1(5);   
        t2.setValorTransacao(100);
        t2.setId2(7);   

        //start transaction 1
        t1.start();
        //start transaction 2
        t2.start(); 
```

Servico 类是：

```
public void run() {
        executa();
    }

public void executa(){
    ApplicationContext appContext = 
            new ClassPathXmlApplicationContext("spring/config/BeanLocations.xml");

    livroQuantidadeBo = (LivroQuantBo)appContext.getBean("livroQuantBoProxy");
    try {
        livroQuantidadeBo.transacao(getId1(),getValorTransacao(),getId2());
    } catch (RuntimeException e) {
        // TODO Auto-generated catch block
        System.out.println(e);
    } 
```

LivroQuantBoImpl 类具有以下方法：

```
public void transacao(int id1,int valorTransferencia, int id2) throws RuntimeException{
    LivroQuantidade livroQ = livroQuantDao.find(id1);
    LivroQuantidade livroQ2 = livroQuantDao.find(id2);
    if(livroQ.getQuantidade() - valorTransferencia >= 0){
        livroQ.setQuantidade(livroQ.getQuantidade() - valorTransferencia);
        livroQ2.setQuantidade(valorTransferencia + livroQ2.getQuantidade());
        livroQuantDao.update(livroQ);
        livroQuantDao.update(livroQ2);
    }
} 
```

我的 Spring .conf 是：

```
 <!--  DATASOURCE -->  
    <bean 
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">
        <property name="location">
            <value>properties/database.properties</value>
        </property>
    </bean>

    <bean id="dataSource" 
             class="org.springframework.jdbc.datasource.DriverManagerDataSource">
        <property name="driverClassName" value="${jdbc.driverClassName}" />
        <property name="url" value="${jdbc.url}" />
        <property name="username" value="${jdbc.username}" />
        <property name="password" value="${jdbc.password}" />
    </bean>

    <!-- HIBERNATE -->

    <!-- Hibernate session factory -->
    <bean id="sessionFactory" 
         class="org.springframework.orm.hibernate3.LocalSessionFactoryBean">

        <property name="dataSource">
          <ref bean="dataSource"/>
        </property>

        <property name="hibernateProperties">
           <props>
             <prop key="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</prop>
             <prop key="hibernate.show_sql">true</prop>
           </props>
         </property>

         <property name="mappingResources">
        <list>
               <value>hibernate/Livro.hbm.xml</value>
               <value>hibernate/LivroQuantidade.hbm.xml</value>
        </list>
          </property>   

        </bean>

    <!-- TRANSAÇÃO  -->

    <bean id="transactionInterceptor" class="org.springframework.transaction.interceptor.TransactionInterceptor">
        <property name="transactionManager" ref="transactionManager" />
        <property name="transactionAttributes">
        <props>
        <prop key="save">PROPAGATION_REQUIRED</prop>
        <prop key="transacao">PROPAGATION_REQUIRED</prop>
        <prop key="transacao">ISOLATION_SERIALIZABLE</prop>
        </props>
        </property>
    </bean>

    <bean id="transactionManager" class="org.springframework.orm.hibernate3.HibernateTransactionManager">
        <property name="dataSource" ref="dataSource" />
        <property name="sessionFactory" ref="sessionFactory" />
    </bean>

    <!-- BEANS -->
        <!-- Livro business object -->
       <bean id="livroBo" class="br.com.spring.bo.LivroBoImpl" >
            <property name="livroDao" ref="livroDao" />
            <property name="livroQuantBo" ref="livroQuantBo" />
       </bean>

       <!-- Livro Data Access Object -->
       <bean id="livroDao" class="br.com.spring.dao.LivroDaoImpl" >
            <property name="sessionFactory" ref="sessionFactory"></property>
       </bean>

        <!-- ProductQoh business object -->
       <bean id="livroQuantBo" class="br.com.spring.bo.LivroQuantBoImpl" >
            <property name="livroQuantDao" ref="livroQuantDao" />
       </bean>

       <!-- ProductQoh Data Access Object -->
       <bean id="livroQuantDao" class="br.com.spring.dao.LivroQuantDaoImpl" >
            <property name="sessionFactory" ref="sessionFactory"></property>
       </bean>

     <!-- PROXY -->

       <bean id="livroBoProxy"
            class="org.springframework.aop.framework.ProxyFactoryBean">
            <property name="target" ref="livroBo" />
            <property name="interceptorNames">
                <list>
                    <value>transactionInterceptor</value>
                </list>
            </property>
       </bean>

        <bean id="livroQuantBoProxy"
            class="org.springframework.aop.framework.ProxyFactoryBean">
            <property name="target" ref="livroQuantBo" />
            <property name="interceptorNames">
                <list>
                    <value>transactionInterceptor</value>
                </list>
            </property>
       </bean> 
```

它正在执行此运行时异常：

```
 Hibernate: select livroquant0_.quantidade_livro_id as quantidade1_2_, livroquant0_.quantidade as quantidade2_, livroquant0_.livro_id as livro3_2_ from springhibernate2.quantidadeLivro livroquant0_ where livroquant0_.quantidade_livro_id=?
 Hibernate: select livroquant0_.quantidade_livro_id as quantidade1_3_, livroquant0_.quantidade as quantidade3_, livroquant0_.livro_id as livro3_3_ from springhibernate2.quantidadeLivro livroquant0_ where livroquant0_.quantidade_livro_id=?
 Hibernate: select livroquant0_.quantidade_livro_id as quantidade1_3_, livroquant0_.quantidade as quantidade3_, livroquant0_.livro_id as livro3_3_ from springhibernate2.quantidadeLivro livroquant0_ where livroquant0_.quantidade_livro_id=?
 Hibernate: select livroquant0_.quantidade_livro_id as quantidade1_2_, livroquant0_.quantidade as quantidade2_, livroquant0_.livro_id as livro3_2_ from springhibernate2.quantidadeLivro livroquant0_ where livroquant0_.quantidade_livro_id=?
 Hibernate: update springhibernate2.quantidadeLivro set quantidade=?, livro_id=? where quantidade_livro_id=?
 Hibernate: update springhibernate2.quantidadeLivro set quantidade=?, livro_id=? where quantidade_livro_id=?
 Hibernate: update springhibernate2.quantidadeLivro set quantidade=?, livro_id=? where quantidade_livro_id=?
 Hibernate: update springhibernate2.quantidadeLivro set quantidade=?, livro_id=? where quantidade_livro_id=?
 Nov 6, 2012 3:02:49 PM org.hibernate.util.JDBCExceptionReporter logExceptions
 WARNING: SQL Error: 0, SQLState: 40001
 Nov 6, 2012 3:02:49 PM org.hibernate.util.JDBCExceptionReporter logExceptions
 SEVERE: Batch entry 0 update springhibernate2.quantidadeLivro set quantidade='0', livro_id='1' where quantidade_livro_id='5' was aborted.  Call getNextException to see the cause.
 Nov 6, 2012 3:02:49 PM org.hibernate.util.JDBCExceptionReporter logExceptions
 WARNING: SQL Error: 0, SQLState: 40001
 Nov 6, 2012 3:02:49 PM org.hibernate.util.JDBCExceptionReporter logExceptions
 SEVERE: ERROR: could not serialize access due to concurrent update
 Nov 6, 2012 3:02:49 PM org.hibernate.event.def.AbstractFlushingEventListener performExecutions
 SEVERE: Could not synchronize database state with session
 org.hibernate.exception.LockAcquisitionException: Could not execute JDBC batch update
     at org.hibernate.exception.SQLStateConverter.convert(SQLStateConverter.java:82)
     at org.hibernate.exception.JDBCExceptionHelper.convert(JDBCExceptionHelper.java:43)
     at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:254)
     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:237)
     at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:142)
     at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:298)
     at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
     at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:1000)
     at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:338)
     at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
     at org.springframework.orm.hibernate3.HibernateTransactionManager.doCommit(HibernateTransactionManager.java:656)
     at org.springframework.transaction.support.AbstractPlatformTransactionManager.processCommit(AbstractPlatformTransactionManager.java:754)
     at org.springframework.transaction.support.AbstractPlatformTransactionManager.commit(AbstractPlatformTransactionManager.java:723)
     at org.springframework.transaction.interceptor.TransactionAspectSupport.commitTransactionAfterReturning(TransactionAspectSupport.java:393)
     at org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:120)
     at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:172)
     at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:202)
     at $Proxy0.transacao(Unknown Source)
     at br.com.spring.service.Servico.executa(Servico.java:29)
     at br.com.spring.service.Servico.run(Servico.java:19)
  Caused by: java.sql.BatchUpdateException: Batch entry 0 update springhibernate2.quantidadeLivro set quantidade='0', livro_id='1' where quantidade_livro_id='5' was aborted.  Call getNextException to see the cause.
at org.postgresql.jdbc2.AbstractJdbc2Statement$BatchResultHandler.handleError(AbstractJdbc2Statement.java:2621)
at org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1837)
at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:407)
at org.postgresql.jdbc2.AbstractJdbc2Statement.executeBatch(AbstractJdbc2Statement.java:2754)
at org.hibernate.jdbc.BatchingBatcher.doExecuteBatch(BatchingBatcher.java:48)
at org.hibernate.jdbc.AbstractBatcher.executeBatch(AbstractBatcher.java:247)
... 17 more
   org.springframework.dao.CannotAcquireLockException: Could not execute JDBC batch update; SQL [update springhibernate2.quantidadeLivro set quantidade=?, livro_id=? where quantidade_livro_id=?]; nested exception is org.hibernate.exception.LockAcquisitionException: Could not execute JDBC batch update 
```

怎么了？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-12T11:31:51.127

您可以在下面的链接中查看主题**12.2.2。可序列化隔离级别**

[http://www.postgresql.org/docs/8.1/static/transaction-iso.html](http://www.postgresql.org/docs/8.1/static/transaction-iso.html)

# javascript - 如何以编程方式在 tablecontainer 中设置 label dojo 小部件

> ID：13256766
> 
> 赞同：1
> 
> 时间：2012-11-06T18:07:32.457
> 
> 标签：javascript, dojo

嗨有一个道场 TableContainer

```
var consultaTC = new dojox.layout.TableContainer({
       id:'consultaTC',
       cols: 4,
       customClass: "labelsAndValues","labelWidth": "280x"
   }, dojo.byId("consultaTC")); 
```

和 FilteringSelect 小部件

```
 var fsOrigen= new dijit.form. FilteringSelect{
       id: 'fsOrigen',
       label: 'Old Label',........

    }); 
```

此小部件使用 addChild 方法加载到 dojo TableContainer 中。

```
consultaTC.addChild(fsOrigen); 
```

我试图以编程方式更改小部件的标签`dijit.byId('fsOrigen').set('label','New label');`

但不工作...

问题是 TableContainer 中标签的 html 输出是

```
<label for='fsOrigen'>Old Label</label> 
```

因此，TableContainer 会覆盖小部件的标签属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-07-03T04:16:19.550

在调用 set label 之后，您应该添加：

```
consultaTC.layout() 
```

# api - 雅虎 PHP SDK getContacts 不起作用

> ID：13256774
> 
> 赞同：0
> 
> 时间：2012-11-06T18:08:03.307
> 
> 标签：api, rest, sdk, yahoo, yahoo-api

我正在尝试从 Yahoo 获取用户的联系人，我正在使用 PHP SDK。

但我一直得到一个空的结果：

```
{ ["query"]=> object(stdClass)#14 (4) { ["count"]=> int(0) ["created"]=> string(20) "2012-11-06T18:05:30Z" ["lang"]=> string(5) "en-US" ["results"]=> NULL } } 
```

据我所知，身份验证工作正常，但我在这里没有得到任何结果......

这是我用来获得上述结果的代码：

```
$session = YahooSession::requireSession($yahooConsumerKey,$yahooConsumerSecret,$yahooAppID);

$query = sprintf("select * from social.contacts where guid=me;");  
$response = $session->query($query); 

var_dump($response);

/**** printing the contact emails starts ****/
if(isset($response)){

   foreach($response->query->results->contact as $id){

       foreach($id->fields as $subid){

               if( $subid->type == 'email' )
               echo $subid->value."<br />";
       }
   }
} 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T12:41:01.627

我发现问题出在哪里，如果您从 Facebook 将联系人导入 Yahoo，这些将不会出现在您的 YQL 响应中，因此解决方案是简单地手动添加一些联系人，以便您可以在响应中看到它们，而不是问题代码，但在 Yahoo 上的导入存在错误。

# c# - 如何比较 Qt 中到达的 TCP/IP 数据

> ID：13256775
> 
> 赞同：0
> 
> 时间：2012-11-06T18:08:02.947
> 
> 标签：c#, qt, networking, tcp

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-07T08:03:27.297

我解决了。问题是在 Windows 中新行不是 '\n' 而是 '\r\n'。因此，如果我将我`QString "OK!\n"`的 Windows 与到达的 TCP 数据“ **OK！\r\n** ”进行比较，那么我总是得到“假”。一种解决方案是将 my`QString "OK!\r\n"`与到达的 TCP 数据“ **OK！\r\n** ”进行比较，或者第二种解决方案是仅拆分第一个**“OK！”** 部分数据用Qt命令`QString kurzstr = str.section("\r\n", 0, 0);`代码如下：

```
QString okStr = "OK!";
QString str = socket->readLine();
QString kurzstr = str.section("\r\n", 0, 0);
    if(okStr == kurzstr)
        ui->textEdit->append("OK! is true");
    else
        ui->textEdit->append("OK! is false"); 
```

# database - 多语言网站：存储翻译的最佳方式是什么？

> ID：13256776
> 
> 赞同：-1
> 
> 时间：2012-11-06T18:08:15.873
> 
> 标签：database, arrays, multilingual

将翻译后的文本存储在数据库中还是使用数组存储在文件中更有效？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T13:12:55.903

真的取决于你要开发什么，有些框架有本地化功能，你应该先检查是否。之后，如果没有提供，数据库有点复杂，想象一下每个单词的查询。如果没有提供本地化功能，我会使用某种 INI 文件，或者您可以随时检查一些本地化库。但是由于我不知道您使用哪种语言进行开发，因此我无能为力。如果您需要任何帮助来查找图书馆，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T13:07:33.603

真的取决于你的应用程序。对于大型 CMS，我会将其存储在数据库中。对于小型 iOS 应用程序，我将使用您读入数组的文件。

# python - 可能在 python 2 中引发包含非英语字符的异常？

> ID：13256777
> 
> 赞同：6
> 
> 时间：2012-11-06T18:08:17.713
> 
> 标签：python, exception, unicode, non-english

我试图在 python 2.7.x 中引发异常，其中包含消息中的 unicode。我似乎无法让它工作。

是否不支持或不建议在错误消息中包含 unicode？还是我需要查看 sys.stderr？

```
 # -*- coding: utf-8 -*-
 class MyException(Exception):
  def __init__(self, value):
    self.value = value
  def __str__(self):
    return self.value
  def __repr__(self):
    return self.value
  def __unicode__(self):
    return self.value

desc = u'something bad with field \u4443'

try:
  raise MyException(desc)
except MyException as e:
  print(u'Inside try block : ' + unicode(e))

# here is what i wish to make work 
raise MyException(desc) 
```

运行脚本会产生以下输出。在我的 try/except 中，我可以毫无问题地打印字符串。

我的问题不在尝试/除外。

```
Inside try block : something bad with field 䑃
Traceback (most recent call last):
  File "C:\Python27\lib\bdb.py", line 387, in run
    exec cmd in globals, locals
  File "C:\Users\ghis3080\r.py", line 25, in <module>
    raise MyException(desc)
MyException: something bad with field \u4443 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:27:22.607

这就是 Python 的工作原理。我相信您所看到的来自`traceback._some_string()`Python 核心库。在该模块中，完成堆栈跟踪后，该方法中的代码首先尝试使用 转换消息`str()`，然后如果引发异常，则使用 转换消息`unicode()`，然后使用 将其转换为 ascii `encode("ascii", "backslashreplace")`。您得到了有效的输出，并且一切正常，我的猜测是 Python 正在尽力对错误消息进行伪向下转换，以便无论平台执行它，它都会毫无问题地显示。这只是您角色的 unicode 代码点。它不会在您的`try/except`块中发生，因为这种转换是特定于产生堆栈跟踪的机制的（例如在未捕获的异常事件中）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T20:51:52.483

行为取决于 Python 版本和环境。在 Python 3 上，字符编码错误处理程序`sys.stderr`总是`'backslashreplace'`：

```
from __future__ import unicode_literals, print_function
import sys

s = 'unicode "\u2323" smile'
print(s)
print(s, file=sys.stderr)
try:
    raise RuntimeError(s)
except Exception as e:
    print(e.args[0])
    print(e.args[0], file=sys.stderr)
    raise 
```

蟒蛇3：

```
$ PYTHONIOENCODING=ascii:ignore python3 raise_unicode.py
unicode "" smile
unicode "\u2323" smile
unicode "" smile
unicode "\u2323" smile
Traceback (most recent call last):
  File "raise_unicode.py", line 8, in <module>
    raise RuntimeError(s)
RuntimeError: unicode "\u2323" smile 
```

[蟒蛇2](http://ideone.com/FP6AAt)：

```
$ PYTHONIOENCODING=ascii:ignore python2 raise_unicode.py
unicode "" smile
unicode "" smile
unicode "" smile
unicode "" smile
Traceback (most recent call last):
  File "raise_unicode.py", line 8, in <module>
    raise RuntimeError(s)
RuntimeError 
```

那是在我的系统上，错误消息在 python2 上被吃掉了。

注意：在 Windows 上，您可以尝试：

```
T:\> set PYTHONIOENCODING=ascii:ignore
T:\> python raise_unicode.py 
```

为了比较：

```
$ python3 raise_unicode.py
unicode "⌣" smile
unicode "⌣" smile
unicode "⌣" smile
unicode "⌣" smile
Traceback (most recent call last):
  File "raise_unicode.py", line 8, in <module>
    raise RuntimeError(s)
RuntimeError: unicode "⌣" smile 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-11-27T11:48:39.457

在我的情况下，您的示例可以正常工作，打印出漂亮的 unicode。

但有时您在打印没有（或使用转义/反斜杠）unicode 字符的异常堆栈时会遇到很多问题。可以克服障碍并打印正常消息。

输出问题示例（Python 2.7，linux）：

```
# -*- coding: utf-8 -*-
desc = u'something bad with field ¾'
raise SyntaxError(desc.encode('utf-8', 'replace')) 
```

它将仅打印截断或拧紧的消息：

```
~/.../sources/C_patch$ python SO.py 
Traceback (most recent call last):
  File "SO.py", line 25, in <module>
    raise SyntaxError(desc)
SyntaxError 
```

要实际查看未更改的 unicode，您可以将其编码为原始字节并输入异常对象：

```
# -*- coding: utf-8 -*-
desc = u'something bad with field ¾'
raise SyntaxError(desc.encode('utf-8', 'replace')) 
```

这次您将看到完整的消息：

```
~/.../sources/C_patch$ python SO.py 
Traceback (most recent call last):
  File "SO.py", line 3, in <module>
    raise SyntaxError(desc.encode('utf-8', 'replace'))
SyntaxError: something bad with field ¾ 
```

如果您愿意，您可以`value.encode('utf-8', 'replace')`在构造函数中执行此操作，但如果出现系统异常，您必须在`raise`语句中执行此操作，就像在示例中一样。

提示取自这里：[克服挫折：在 python2 中正确使用 unicode](https://pythonhosted.org/kitchen/unicode-frustrations.html#frustration-5-exceptions)（有很多帮助程序的大库，所有这些都可以剥离到上面的示例）。

# android - MediaStore 获取光标到最后录制的视频

> ID：13256778
> 
> 赞同：0
> 
> 时间：2012-11-06T18:08:18.650
> 
> 标签：android, mediastore

如何将光标移至已录制的最后一个视频？目的是获取缩略图。以下代码可以正常工作，但有时无法获取最新视频：

```
Uri uri = Uri.parse("content://media/external/video/media");
Cursor c = cr.query(uri, proj, null, null, null);
c.moveToLast(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:53:06.257

您可以`DATE_TAKEN`在查询中使用该列，这将是最后一个视频的最大值。无论如何，正如@zapl 在评论中提到的，这不一定是录制的视频。希望这可以帮助。

# spring - 如何在 Spring Security 中获取 AccessDeniedException 的“原因”/原因？

> ID：13256780
> 
> 赞同：12
> 
> 时间：2012-11-06T18:08:36.543
> 
> 标签：spring, exception, exception-handling, spring-security

我们正在使用具有方法级安全性的 Spring Security 3.1.3-RELEASE。它完美地工作。

我想记录，也许向用户展示他**为什么**被拒绝访问。

使用`org.springframework.security.web.access.AccessDeniedHandlerImpl`子类，我可以获得对`org.springframework.security.access.AccessDeniedException`抛出的引用，但我无法找到一种方法来确定导致它的原因（例如，'缺少角色 ROLE_ADMIN' 或类似的东西）。

我错过了什么，还是根本不存在？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T19:05:10.220

不幸的是，Spring Security 中可用的默认实现是不可能的。

我研究了源代码并...

`MethodSecurityInterceptor`负责保护方法调用。它将访问决策委托给`AccessDecisionManager`. 我检查`AccessDecisionManager`了开箱即用的每个可用实现。

*   基于肯定的
*   基于共识
*   一致为基础

他们每个人都`AccessDeniedException`以类似的方式抛出异常。

```
case AccessDecisionVoter.ACCESS_DENIED:
                throw new AccessDeniedException(
                      messages.getMessage("AbstractAccessDecisionManager.accessDenied",
                      "Access is denied")
                 ); 
```

`AbstractAccessDecisionManager.accessDenied`是消息的名称，可以本地化。

对于英语，它是：

```
AbstractAccessDecisionManager.accessDenied=Access is denied 
```

有几种开箱即用的语言，您可以自己制作翻译，但是...

就是这样，没有更多关于异常原因的信息。

有关异常消息本地化的更多信息：

[http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#localization](http://static.springsource.org/spring-security/site/docs/3.1.x/reference/springsecurity-single.html#localization)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-09-10T12:27:13.273

我还为此创建了一个 jira 问题：[https ://jira.spring.io/browse/SEC-3104](https://jira.spring.io/browse/SEC-3104)

`@PreAuthorize, @PostAuthorize, @Secured`注释可以有一个参数来指向自定义消息属性，以便设置详细且更加用户友好的异常消息。

这也可以通过提供参数来完成。定义一个延伸`AccessDeniedException`到你的类名，让用户处理其余的事情。

这样，在处理复杂规则时，例如

`@PreAuthorize("record.createuser != authentication.getName()")`

我们可以得到一个定义的错误，比如

`"You cannot process a record that you created.""`等等，而不是`"Access is denied"`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-11-15T15:18:25.867

我已经实现了一个解决方案，它（仅）适用于 API 层中使用的授权注释（例如使用@RequestMapping）。在这里查看我的答案：[https ://stackoverflow.com/a/64846057/4413638](https://stackoverflow.com/a/64846057/4413638)

# php - 我怎样才能将带有列表和插入值的下拉框作为 PHP 中 UPDATE 的默认值？

> ID：13256782
> 
> 赞同：0
> 
> 时间：2012-11-06T18:08:37.910
> 
> 标签：php, mysql

首先，我想更新记录。我创建了下拉框，其中包含来自 mySQL FROM SELECT statemet 的值，它与以前选择的一个数据库条目一起工作正常。但是我想对我在另一个表中的修改有另一个值。

**从订单表值中删除以进行更新。**

```
 echo '<div class = "MediaType" >'; //Start class Media Type
    echo '<strong><label for="rate">Media Type</label></strong>';
    echo '<br/><br/>' ;

        $sql = "SELECT `media_type` FROM `order` where `po_number` = '".$ponumber."'";
        $result = mysql_query($sql);

        while ($row = mysql_fetch_array($result)) 
            {
                echo "<select class='dropdownsize' name='media_type[]' tabindex='$k'>";

                echo "<option value='" . $row['media_type'] . "'>" . $row['media_type'] . "</option>";
                echo '</select>';
                echo '<br/>';
            }

echo '</div>'; //End Class Media Type 
```

它在我在插入过程中选择并插入的下拉列表中为我提供了值“在线”。

**DROP DOWN FOR INSERT 来自 media_type 表的页面**

```
echo '<div class = "MediaType" >'; //Start class Media Type
    echo '<strong><label for="rate">Media Type</label></strong>';
    echo '<br/><br/>' ;

        //for loop for dropdown from user index//
        for($k=1;$k<=$textboxindex;$k++)
        {
        $sql = "SELECT media_type FROM media_type";
        $result = mysql_query($sql);
            echo "<select class='dropdownsize' name='media_type[]' tabindex='$k'>";
            while ($row = mysql_fetch_array($result)) 
            {
                echo "<option value='" . $row['media_type'] . "'>" . $row['media_type'] . "</option>";
            }
            echo '</select>';
            echo '<br/>';
        }
echo '</div>'; //End Class Media Type 
```

表名 = "media_type" values = "TV","ONLINE","Roller",Banner","Roll Over"

我希望我的更新下拉框中的这个“media_type”值与插入下拉框相同，以便最终用户可以修改带有 media_type 值作为插入的条目。但是当它第一次显示时，dropbox 的默认值应该与之前输入的数据相同。

抱歉，我的问题令人困惑。最好的方法是什么。？任何帮助将不胜感激。谢谢你

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T21:49:09.223

首先请通过[为什么我不应该在 PHP 中使用 mysql_* 函数？](https://stackoverflow.com/questions/12859942/why-shouldnt-i-use-mysql-function-in-php)

根据您现有的代码，您可以*从订单表值修改您的 DROP DOWN FOR THE UPDATE。*使用下面的代码..在这里我们运行第二个 while 循环以获得所需的结果..

另请注意，当在性能方面有数千个选项要附加时，这可能不是正确的方法。

```
echo '<div class = "MediaType" >'; //Start class Media Type
    echo '<strong><label for="rate">Media Type</label></strong>';
    echo '<br/><br/>' ;

        $sql = "SELECT `media_type` FROM `order` where `po_number` = '".$ponumber."'";
        $result = mysql_query($sql);

        while ($row = mysql_fetch_array($result)) 
            {
                echo "<select class='dropdownsize' name='media_type[]' tabindex='$k'>";

                echo "<option value='" . $row['media_type'] . "'>" . $row['media_type'] . "</option>";

        $sql2 = "SELECT media_type FROM media_type";
        $result2 = mysql_query($sql2);
        while ($row2 = mysql_fetch_array($result2)) 
            {
            echo "<option value='" . $row2['media_type'] . "'>" . $row2['media_type'] . "</option>";
            }

                echo '</select>';
                echo '<br/>';
            }

echo '</div>'; //End Class Media Type 
```

# java - simpledateformat 毁了我的 currenttimemillis

> ID：13256783
> 
> 赞同：0
> 
> 时间：2012-11-06T18:08:44.857
> 
> 标签：java

我的秒表给了我一个奇怪的时间。它显示为 16:00:00:000，它还将秒数放入毫秒槽中。我认为问题出在日期格式化程序上。如果没有 dateformater 和仅使用 decimalformater，它就会正确显示。我只需要它显示小时、分钟和秒。

```
public class StopWatchTest extends JLabel implements ActionListener {

    private static final String Start = "Start";
    private static final String Stop = "Stop";
    private SimpleDateFormat df = new SimpleDateFormat("HH:mm:ss.SSS");

    private Timer timer = new javax.swing.Timer(100, this);
    private long now = System.currentTimeMillis();

    public StopWatchTest() {
        this.setHorizontalAlignment(JLabel.CENTER);
        this.setText(when());
    }

    public void actionPerformed(ActionEvent ae) {
        setText(when());
    }

    public void start() {
        timer.start();
    }

    public void stop() {
        timer.stop();
    }

    private String when() {
        return df.format((System.currentTimeMillis() - now) / 1000d);
    }

    private static void create() {
        JFrame f = new JFrame();
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        final StopWatchTest jtl = new StopWatchTest();
        jtl.setFont(new Font("Dialog", Font.BOLD, 32));
        f.add(jtl, BorderLayout.CENTER);

        final JButton button = new JButton(Stop);
        button.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent e) {
                String cmd = e.getActionCommand();
                if (Stop.equals(cmd)) {
                    jtl.stop();
                    button.setText(Start);
                } else {
                    jtl.start();
                    button.setText(Stop);
                }

            }
        });
        f.add(button, BorderLayout.SOUTH);
        f.pack();
        f.setVisible(true);
        jtl.start();
    }

    public static void main(String[] args) {
        EventQueue.invokeLater(new Runnable() {
            public void run() {
                create();
            }
        });
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:11:20.590

`DateFormat`格式化毫秒值指定的**时间瞬间，**您正试图使用​​它来格式化**间隔**。JDK 中没有任何内容涵盖您的用例，但 JodaTime 可以。无论如何，您应该使用 JodaTime。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:22:57.920

除了 Marko 指出的内容之外，您还尝试格式化未明确定义的双精度。Java 将从 java.text.Format 调用 format(Object) 函数。您至少应该使用 Date 对象作为参数，例如：

```
return df.format(new Date(System.currentTimeMillis() - now)); 
```

除了 Marko，我认为这将以一个实用的解决方案结束，但不要忘记：SimpleDateFormat 不是线程安全的（感谢 Alan）

# python - 如何在 python 字符串中找到相反的字符？

> ID：13256785
> 
> 赞同：3
> 
> 时间：2012-11-06T18:08:46.567
> 
> 标签：python, string, search, find

比如有一个字符串s：

```
s = "((abc)((123))())blabla" 
```

我们知道 s 的开头是“(”，我们想找到它的反义词，“blabla”之前的“)”，如何在 python 中做到这一点？

是否可以在不使用状态机的情况下以简单直观的方式做到这一点？或者有没有图书馆可以做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:06:35.070

您可以尝试正则表达式、pyparsing，但是具有线性时间复杂度的天真的选项是以下天真的方式

```
>>> s = "((abc)((123))())blabla"
>>> count = 0
>>> for i,e in enumerate(s):
    if e == '(':
        count += 1
    elif e == ')':
        count -= 1
    if not count:
        break

>>> s[:i + 1]
'((abc)((123))())'
>>> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:03:09.880

通过代码，您可以通过以下方式实现：

```
from collections import defaultdict

opens = defaultdict(int)

open_close_pair = []

s = '((abc)((123))())blabla'
openc, closec = '(', ')'

for c in range(0, len(s)):
    if s[c] == openc:
        # +1 in every entry
        for key, val in opens.items():
            opens[key] += 1
        opens[c] += 1

    elif s[c] == closec:
        # -1 in every entery
        for key, val in opens.items():
            opens[key] -= 1
    else:   
        pass

    for key, val in opens.items():
        if val == 0:
            # open the entry to the open close pairs
            open_close_pair.append( (key, c))
            # the bracket is close so can be removed from the counter
            del opens[key]

for x in open_close_pair:
    print " %s %s " % (s[x[0]], s[x[1]])
print open_close_pair 
print opens 
```

输出是：

```
 ( ) 
 ( ) 
 ( ) 
 ( ) 
 ( ) 
[(1, 5), (7, 11), (6, 12), (13, 14), (0, 15)]
defaultdict(<type 'int'>, {}) 
```

算法是：

*   保留一个包含开括号位置的**opens dict。**
*   当您找到一个左括号时，您在所有先前的条目上添加 +1，然后为当前位置添加一个新条目
*   当你找到一个右括号时，你在前面的所有输入上都减少了 -1
*   只需运行**开盘价**，如果任何条目为 0，则意味着我们有一对。

# c# - 使用单个对象和另一个对象列表初始化列表

> ID：13256787
> 
> 赞同：32
> 
> 时间：2012-11-06T18:08:51.450
> 
> 标签：c#, collections, collection-initializer

我想用一个对象和一个按特定顺序的对象列表来初始化一个列表。目前，我正在做：

```
List<MyObject> list = new List<MyObject>();
list.Add(object1); // object1 is type MyObject
list.AddRange(listOfObjects); // listOfObjects is type List<MyObject> 
```

我希望将其合并到一个初始化语句中（当然语法是错误的）：

```
List<MyObject> newList = new List<MyObject>() { object1, listOfObjects }; 
```

有没有办法简洁地做到这一点？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2012-11-06T18:14:30.957

如果元素的顺序不重要，可以使用：

```
List<MyObject> newList = new List<MyObject>(listOfObjects) { object1 }; 
```

这通过使用`List<T>`接受 a 的构造函数`IEnumerable<T>`，然后使用集合初始值设定项来添加其他项目来工作。例如，以下内容：

```
static void Main()
{
    int test = 2;
    List<int> test2 = new List<int>() { 3, 4, 5 };
    List<int> test3 = new List<int>(test2) { test };

    foreach (var t in test3) Console.WriteLine(t);

    Console.ReadKey();
} 
```

将打印：

```
3
4
5
2 
```

但是请注意，订单与您的原始订单不同，因为单个项目是*最后*添加的。

但是，如果顺序很重要，我个人只会构建列表，将您的第一个对象放入初始化程序中，然后调用`AddRange`：

```
List<MyObject> newList = new List<MyObject> { object1 };
newList.AddRange(listOfObjects); 
```

这使得意图非常明确，并且避免了临时项目的构建（使用 LINQ 的 Concat 等需要）。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-11-06T18:12:19.557

我认为你能做的最好的是：

```
List<MyObject> newList = new[] { object1 }.Concat(listOfObjects).ToList(); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2020-08-12T10:27:17.293

这可以借助扩展方法来实现，例如

```
public static class CollectionExtensions
{
    public static void Add<T>(this ICollection<T> collection, IEnumerable<T> itemsToAdd)
    {
        foreach (var item in itemsToAdd)
        {
            collection.Add(item);
        }
    }
} 
```

用法与问题中的建议完全相同：

```
var newList = new List<MyObject>
   {
      object1,
      listOfObjects
   }; 
```

可以在 C# Programming Guide about [Object and Collection Initializers](https://docs.microsoft.com/en-us/dotnet/csharp/programming-guide/classes-and-structs/object-and-collection-initializers#collection-initializers)中找到一些解释（我找不到更好的词）：

> 集合初始化器允许您在初始化实现 IEnumerable 并具有 Add 的集合类型时指定一个或多个元素初始化器作为实例方法或扩展方法。

# boost - 使用 MinGW 构建 Boost 1.52

> ID：13256788
> 
> 赞同：28
> 
> 时间：2012-11-06T18:08:53.437
> 
> 标签：boost, mingw

我正在尝试找到有关如何使用*MinGW构建**Boost 1.52*的权威答案。我在 Internet 上找到了一些可以归结为这样构建它的指针：

 *```
cd tools\build\v2\engine
build.bat mingw

copy bin.ntx86\bjam.exe ..\..\..\..
cd ..\..\..\..
bjam --toolset=gcc 
```

由于这些说明可以追溯到*Boost 1.45*，并且由于我无法使用 Boost 自己的说明验证这一点，因此我想验证上述步骤是否是使用 MinGW 构建 Boost 的正确步骤。

我自己尝试了这些步骤，它*似乎*构建了 Boost，但是我还没有进行广泛的测试（我也没有这样做的概念）。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2012-11-06T19:24:05.740

对，那是正确的。但是，会有一种更简单但相同的方法；您在 bjam 呼叫之前的步骤由以下方式自动完成`bootstrap.bat`：

```
C:\boost_1_52_0> bootstrap.bat mingw
Building Boost.Build engine
...
C:\boost_1_52_0> b2 toolset=gcc 
```

如果没有明确指定，库将被放置到`stage\lib`目录中，包含路径是安装根目录。要测试安装，您可以使用[Link Your Program to a Boost Library](http://www.boost.org/doc/libs/1_52_0/more/getting_started/windows.html#link-your-program-to-a-boost-library)中的示例。

参考：[安装](http://www.boost.org/doc/libs/1_52_0/doc/html/bbv2/installation.html)、[准备使用 Boost 库二进制文件](http://www.boost.org/doc/libs/1_52_0/more/getting_started/windows.html#prepare-to-use-a-boost-library-binary)*

# r - 使用模拟.Arima() 进行外部回归的未来模拟

> ID：13256789
> 
> 赞同：1
> 
> 时间：2012-11-06T18:08:55.103
> 
> 标签：r, forecasting

我的问题涉及`simulate.Arima()`预测中的功能。我有一个具有季节性、非零差分度和外部回归量（假期的虚拟变量）的 ARIMA 函数。这是一个可重现的示例：

```
y <- ts(c(3,5,10,13,4,15,13,17,20,24,26,27))
dummy <- data.frame(dummy=c(0,0,0,0,1,0,0,0,0,0,0,0))
arima.1 <- arima(y, order=c(1,1,0), xreg=dummy)

future.dummy <- data.frame(dummy=c(0,0,1,0,0,0,0,0,0,0,0,0))
n <- nrow(future.dummy)

sim.1 <- simulate(arima.1, nsim=n, xreg=future.dummy) 
```

当我执行此操作时，我收到一条错误消息。我注意到当我设置参数`future=FALSE`时它工作得很好。

我的问题：simulate.Arima 是否不允许您使用新的外部回归器运行未来的模拟？换句话说，您是否必须在

1.  在没有外部回归变量的情况下预测未来或
2.  用不同的外部回归器模拟非未来数据？

如果是这种情况，开发`simulate()`在`predict.Arima`对象上运行 a 的解决方法是否可行？我有一个非零度的差异，所以我能够展望未来是很重要的。感谢您提供的任何见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-07T20:18:51.827

我想我找到了问题所在，所以我想我会继续回答我自己的问题。（来自预测包）的确切输出`arima`和输出的内容略有不同。`auto.arima`对每种类型的对象进行简单`names`调用即可揭示差异。

```
names(arima.1)
[1] "coef"      "sigma2"    "var.coef"  "mask"      "loglik"    "aic"      
[7] "arma"      "residuals" "call"      "series"    "code"      "n.cond"   
[13] "model"

names(auto.arima.1)
[1] "coef"      "sigma2"    "var.coef"  "mask"      "loglik"    "aic"      
[7] "arma"      "residuals" "call"      "series"    "code"      "n.cond"   
[13] "model"     "bic"       "aicc"      "xreg"      "x" 
```

请注意，`auto.arima`它有一些额外的名称，最值得注意的是原始数据 ( `$x`) 和外部回归量 ( `$xreg`)。因此，当您将内置的 Arima 对象提供`arima`给`simulate.Arima`. 后面的代码`simulate.Arima`似乎可以正确处理`$x`差异，但它以`$xreg`. 因此，当您输入由 构建的 Arima 对象时`arima`，函数代码会尝试引用`object$xreg`，但该对象没有附加这样的名称，因此它只是返回`NULL`。因此，当函数尝试对 执行某些操作时`object$xreg`，它处理的是 NULL，而不是由外部回归量组成的数据框。该功能在以下行分解：

```
object$xreg <- cbind(intercept = rep(1, n), object$xreg) 
```

我还注意到，在 的帮助页面上`auto.arima`，在 Value 部分下，它简单地说“与 arima 相同”。虽然确实`auto.arima`输出了一个 Arima 对象，但附加到该对象的名称略有不同。

所以简而言之，一个带有外部回归器的 Arima 对象`auto.arima`可以很好地工作，`simulate`因为它有`$xreg`组件。它只对由`arima`.

有谁知道从没有附加名称`xreg`的对象中获取参数信息的方法？`arima``xreg`

# git - 如果我的远程分支在我的下一个更改集中间被其他人更新，推荐的工作流程是什么？

> ID：13256791
> 
> 赞同：2
> 
> 时间：2012-11-06T18:09:04.680
> 
> 标签：git, version-control, commit, branching-and-merging, remote-branch

假设我使用提交 C1 和 C2 将分支 B 推送到服务器，并继续处理提交 C3。然后其他程序员向 B 推送两个提交，C4 和 C5，我得到通知。我的问题是，在我正在进行的 C3 提交中轻松集成这两个新提交的推荐操作或命令是什么？我的意思是，我的工作目录中充满了未完成和“无法提交”的工作，但希望我未来的工作基于其他程序员推送到远程 B 的提交 C3，在本例中是提交 C4 和 C5。顺便说一句，我正在使用 Git ;)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:22:47.403

要问的第一个问题是你是否真的*需要*提交 C4 和 C5 来继续你在 C3 上的工作。如果您不立即需要它们，请不要担心，继续您的工作，稍后合并它们。

如果您需要 C4 和 C5，并且您还有不想为 C3 提交的工作，那么您可以执行以下操作：

*   `git stash`你正在进行的工作
*   `git fetch B`从 B 获取分支的本地副本
*   `git merge B/C5`获取提交 C4 和 C5（如有必要，解决任何冲突）
*   `git stash pop`恢复您正在进行的工作（再次解决任何冲突）

# java - java小程序画图方法麻烦

> ID：13256792
> 
> 赞同：3
> 
> 时间：2012-11-06T18:09:10.203
> 
> 标签：java, applet, paint, repaint

在代码中，我`repaint()`从`init()`方法调用方法，但输出不符合我的预期。我调用了`repaint()`10 次方法，但它只调用`paint()`了一次（参见 O/P 的屏幕截图）。我有什么错误吗。请帮我。谢谢

**代码**

```
import java.awt.*;
import java.applet.Applet;
/*
    <applet code="test" height=300 width=300>
    </applet>
*/
public class test extends Applet
{
    int x,y;
    public void init() 
    {
        x=5;
        y=10;
        for(int i=1;i<10;i++)
        {
            System.out.println("From init "+i);
            x+=(i*2);                                   
            y+=(i*3);   
            repaint();      
        }                   
    }   
    public void paint(Graphics g)
    {
        System.out.println("Paint");
        g.drawLine(50,50,x,y);
    }   
} 
```

![输出](../Images/42d662f489fcb8c7f132a7eca4686034.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:13:08.073

请理解，您无法完全控制是否或何时调用paint(...)，并且`repaint()`调用只是对 JVM 绘制的建议。如果有太多的 repaint() 请求进入并且它们像你的那样堆积起来，那么它们将被合并。有关这方面的更多详细信息，请查看这篇文章，[在 AWT 和 Swing 中绘画](http://www.oracle.com/technetwork/java/painting-140037.html)。

无论如何，即使您的代码有效，它仍然不会对您的代码的用户造成任何可见的更改，因为所有 x 和 y 的更改和绘制几乎都会立即完成。也许您真的想使用 Swing Timer？也许您想在 Swing 而不是 AWT 中重新编码。

# python - 能够使用 SQLAlchemy 逆转删除的策略

> ID：13256801
> 
> 赞同：5
> 
> 时间：2012-11-06T18:09:39.793
> 
> 标签：python, sqlalchemy

我有一系列由 Python/SQLAlchemy 维护的相关表。如果我删除特定表中的一行，我希望能够在将来的某个时候撤销该删除，以防出现错误。我可以使用 is_deleted 列执行此操作并对其进行过滤，但是当我在其他表中查询相关数据时，这会变得很痛苦。我可以向所有其他表添加一个 is_deleted 列，当主表中的一行被删除时，将它们全部切换。但是对于所有表上的每个查询，我都必须在 is_deleted 上进行过滤。可以做到，但我希望有更好的策略。

一种想法是将所有已删除的数据移动到另一组表中，该表仅存储已删除的数据。但我不清楚 SQLAlchemy 是否允许我切换与特定对象关联的表。我认为这将是首选的解决方案，但我不知道是否可以做到。

另一个想法是我可以运行第二个数据库，并将删除的数据复制过来。但这增加了一层我想避免的管理复杂性。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T21:41:50.543

很多人都做“is_deleted”的事情，我同意我也不喜欢这样做，尽管我们在[PreFilteredQuery](http://www.sqlalchemy.org/trac/wiki/UsageRecipes/PreFilteredQuery)确实有一个秘诀。

正如其他人所建议的那样，您正在寻找的是“版本控制”配方。我们有一个在 SQLAlchemy 文档的版本化[对象](http://docs.sqlalchemy.org/en/latest/orm/examples.html#versioned-objects)中介绍的单独版本化表中存储数据副本的综合示例。

在这里，我调整了该示例中使用的一些技术，以生成一个更直接的配方，该配方专门仅跟踪“已删除”对象，并包括一个“恢复”功能，它将给定行“恢复”回主表。所以它不像“SQLAlchemy 允许我切换与特定对象关联的表”，它更像是创建了另一个映射类，它类似于主类，它也可以用来“反转”你请求的删除. 线下的所有内容`__main__`都是概念验证。

```
from sqlalchemy.orm import Session, object_session
from sqlalchemy import event

def preserve_deleted(class_):
    def copy_col(col):
        newcol = col.copy()
        newcol.constraints = set()
        return newcol
    keys = class_.__table__.c.keys()
    cols = dict(
        (col.key, copy_col(col)) for col in class_.__table__.c
    )
    cols['__tablename__'] = "%s_deleted" % class_.__table__.name

    class History(object):
        def restore(self):
            sess = object_session(self)
            sess.delete(self)
            sess.add(copy_inst(self, class_))

    hist_class = type(
                    '%sDeleted' % class_.__name__,
                    (History, Base),
                    cols)

    def copy_inst(fromobj, tocls):
        return tocls(**dict(
                        (key, getattr(fromobj, key))
                        for key in keys
                    ))
    @event.listens_for(Session, 'before_flush')
    def check_deleted(session, flush_context, instances):
        for del_ in session.deleted:
            if isinstance(del_, class_):
                h = copy_inst(del_, hist_class)
                session.add(h)
    class_.deleted = hist_class
    return class_

if __name__ == '__main__':

    from sqlalchemy.ext.declarative import declarative_base
    from sqlalchemy import Column, ForeignKey, Integer, String
    from sqlalchemy.orm import relationship, Session
    from sqlalchemy import create_engine

    Base = declarative_base()

    @preserve_deleted
    class A(Base):
        __tablename__ = "a"

        id = Column(Integer, primary_key=True)
        data1 = Column(String)
        data2 = Column(String)

    @preserve_deleted
    class B(Base):
        __tablename__ = 'b'
        id = Column(Integer, primary_key=True)
        data1 = Column(String)
        a_id = Column(Integer, ForeignKey('a.id'))
        a = relationship("A")

    e = create_engine('sqlite://', echo=True)

    Base.metadata.create_all(e)

    s = Session(e)

    a1, a2, a3, a4 = \
        A(data1='a1d1', data2='a1d2'),\
        A(data1='a2d1', data2='a2d2'),\
        A(data1='a3d1', data2='a3d2'),\
        A(data1='a4d1', data2='a4d2')

    b1, b2, b3, b4 = \
        B(data1='b1', a=a1),\
        B(data1='b2', a=a1),\
        B(data1='b3', a=a3),\
        B(data1='b4', a=a4)

    s.add_all([
        a1, a2, a3, a4,
        b1, b2, b3, b4
    ])
    s.commit()

    assert s.query(A.id).order_by(A.id).all() == [(1, ), (2, ), (3, ), (4, )]
    assert s.query(B.id).order_by(B.id).all() == [(1, ), (2, ), (3, ), (4, )]

    s.delete(a2)
    s.delete(b2)
    s.delete(b3)
    s.delete(a3)
    s.commit()

    assert s.query(A.id).order_by(A.id).all() == [(1, ), (4, )]
    assert s.query(B.id).order_by(B.id).all() == [(1, ), (4, )]

    a2_deleted = s.query(A.deleted).filter(A.deleted.id == 2).one()
    a2_deleted.restore()

    b3_deleted = s.query(B.deleted).filter(B.deleted.id == 3).one()
    a3_deleted = s.query(A.deleted).filter(A.deleted.id == 3).one()
    b3_deleted.restore()
    a3_deleted.restore()

    s.commit()

    assert s.query(A.id).order_by(A.id).all() == [(1, ), (2, ), (3, ), (4, )]
    assert s.query(B.id).order_by(B.id).all() == [(1, ), (3, ), (4, )] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T21:07:56.667

# iphone - 为 Cydia 开发应用程序

> ID：13256805
> 
> 赞同：0
> 
> 时间：2012-11-06T18:09:49.330
> 
> 标签：iphone, ios, xcode, jailbreak, cydia

我对如何为越狱设备或 Cydia 开发应用程序和程序感兴趣，我必须在 Xcode 中涉及哪些 API？有人可以帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:28:57.780

Cydia 中分发的应用程序使用与 AppStore 中相同的过程开发，只是它们不受其限制。您可以通过 Xcode 导出 IPA，而无需对其进行代码签名。

如果您正在谈论进行调整以修改现有 iOS 应用程序（例如 Safari 或 Springboard）的行为，您需要获取有关[移动基板](http://iphonedevwiki.net/index.php/MobileSubstrate)和[theos的更多信息](http://iphonedevwiki.net/index.php/Theos/Getting_Started)

如果您需要更多信息，请不要犹豫

# matlab - 将数据存储在 8 位图像的最低 3 位有效位上

> ID：13256807
> 
> 赞同：-2
> 
> 时间：2012-11-06T18:09:59.363
> 
> 标签：matlab, image-processing

谁能帮我存储姓名、城市和电话号码。在 8 位图像的最低 3 个有效位上。我想显示图像，然后提取存储数据并打印它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:45:04.237

您在这里要做的所有事情都非常简单。我建议您学习如何使用 matlab，而不是为您编写代码。如果您时间紧迫，请找人帮助您。

我也强烈建议您阅读这篇文章：http: [//blogs.mathworks.com/steve/2006/10/17/the-story-behind-the-matlab-default-image/](http://blogs.mathworks.com/steve/2006/10/17/the-story-behind-the-matlab-default-image/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T20:00:43.240

I thought about it some more, and I really don't think what you're asking for is metadata. Setting the metadata is just easier than what you seem to be actually asking for.

Anyway, if all you really want to do is set the metadata, this can be done by rewritting the image using imwrite, with the 'Comment' parameter set. Look up MATLAB's imwrite for more information on this.

If instead what you want is steganography, then you need to use dec2bin to translate the string into binary data. Then go through this bitstring bit by bit, and OR it with the least significant bits of the image (apply dec2bin to it as well). You'll need to covnert the bitstring back to uint8 since the bitstrings are chars. Also, you can't save it in a lossy format, so no jpegs.

This solution is fairly complicated and requires careful coding. More than I feel like writing here. Especially when you're trying to read it all back (remember that the size of the image and the length of the string you want to hide will vary from image to image, and your de-encrypter will need to be able to handle this).

# objective-c - NSURL 书签查找失败

> ID：13256809
> 
> 赞同：1
> 
> 时间：2012-11-06T18:10:08.060
> 
> 标签：objective-c, macos, cocoa, nsurl, nsfilemanager

我正在尝试存储对`NSURL`s 集合的书签引用，但`bookmarkDataWithContentsOfURL`似乎每次都失败，即使对于我有权访问的文件也是如此。我的应用程序（尚未）被沙盒化，所以这不是问题。

我正在以其他方式（通过基于 C 和 Cocoa API）读取这些文件，没有任何问题。

我正在遍历一个目录并尝试像这样读取书签数据：

```
NSArray * contents = [[NSFileManager defaultManager] 
    contentsOfDirectoryAtURL:directoryURL 
    includingPropertiesForKeys:keys options:0 error:&error];

for (NSURL * url in contents)
{
    NSData * bookmarkData = [NSURL bookmarkDataWithContentsOfURL:url error:&error];

    if (error)
    {
        NSLog(@"Error finding bookmark for %@: %@", url, error);
    }
} 
```

对于所有常规文件，我收到以下错误：

```
Error finding bookmark for file://localhost/Users/mspong/foo/bar.pdf: 
Error Domain=NSCocoaErrorDomain Code=256 "The file couldn’t be opened." 
```

对于所有目录，我得到：

```
Error finding bookmark for file://localhost/Users/mspong/foo/: 
Error Domain=NSPOSIXErrorDomain Code=21 "The operation couldn’t be completed. Is a directory" 
```

为什么我确实有权打开的文件出现此错误？第二个错误是否意味着书签不适用于目录？是否有任何替代方法可以为在重命名/移动后幸存的目录保存持久标识符？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T20:11:23.107

该函数`bookmarkDataWithContentsOfURL:error:`从*别名文件*中检索书签数据。

要为 URL 创建书签数据，请使用

```
bookmarkDataWithOptions:includingResourceValuesForKeys:relativeToURL:error: 
```

请参阅“文件系统编程指南”中的[使用书签定位文件。](http://developer.apple.com/library/ios/#documentation/FileManagement/Conceptual/FileSystemProgrammingGUide/AccessingFilesandDirectories/AccessingFilesandDirectories.html#//apple_ref/doc/uid/TP40010672-CH3-SW10)

# sql - 选择总和（）从（选择（选择（））

> ID：13256813
> 
> 赞同：14
> 
> 时间：2012-11-06T18:10:25.813
> 
> 标签：sql, sql-server, tsql

我有一个正确的工作 T-SQL 脚本，这种形式

```
SELECT  columnA
        AS
        'numbers'
FROM    tableA
WHERE   clause 
```

这个脚本给了我一列，称为数字，整数。我想总结这些。

调用上述行“脚本”我尝试了以下设置

```
SELECT  SUM(numbers)
FROM    (
            script
        ) 
```

从 select 中读取[select count(*)](https://stackoverflow.com/questions/10439122/select-count-from-select)我认为这是可行的，但是它没有。我不断收到“附近有不正确的语法”。

我不知道它是否重要，但这里命名的 columnA 本身是由 SELECT 语句创建的。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-11-06T18:12:03.207

您需要子查询的别名：

```
SELECT  SUM(numbers)
FROM    
(
    script  -- your subquery will go here
) src   -- place an alias here 
```

因此，您的完整查询将是：

```
select sum(numbers)
from
(
   SELECT  columnA  AS numbers
   FROM    tableA
   WHERE   clause
) src 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-06T18:13:32.877

实现你想要的绝对没有任何问题。我们看不到您的 entier 查询，但最常见的问题是人们忘记为其嵌套`select`语句添加别名。看看这个完美运行的示例：

```
select sum(col1) as sum1 
from ( select col1 
        from ( select 1 col1 union all select 2 union all select 3 ) tmp 
     ) tmp2 
```

根据 OP，这是您的最终查询：

```
SELECT  SUM(numbers)
FROM    (
            SELECT  columnA
                    AS
                   'numbers'
              FROM    tableA
             WHERE   clause
        ) tmp 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-06-10T13:51:53.443

```
SELECT SUM(x.ColumnA) as ColumnName FROM
(SELECT ColumnA FROM TableName) x 
```

请记住，您不能在括号内的查询中使用 ORDER 子句。

使用 order 子句会给你这个错误：

*消息 1033，级别 15，状态 1，第 30 行 ORDER BY 子句在视图、内联函数、派生表、子查询和公用表表达式中无效，除非还指定了 TOP 或 FOR XML。*

# django - Django - 如何在 ajax 函数下显示消息

> ID：13256817
> 
> 赞同：17
> 
> 时间：2012-11-06T18:10:34.287
> 
> 标签：django, jquery, django-templates

我正在使用 AjaxForm 插件来提交我的表单而不刷新。喜欢：

```
$('#my_form_id').ajaxForm(function(){

        //something on success or fail
    }); 
```

这工作正常。当我单击提交按钮时，它会保存表单数据而不刷新。但在此之前；我的模板文件上有 django 消息，例如：

```
{% for message in messages %}
    <div id="notice" align="center">
        {{ message }}
    </div>
{% endfor %} 
```

如果帖子保存正确或失败，则此代码的作用是显示通知。

现在; 我不能那样做。我不明白如何将这些消息标签与 ajax 函数一起使用。

它只是保存帖子。没有通知。

谢谢你。

编辑 ：

add_post 网址：`url(r'^admin/post/add/$', view='add_post',name='add_post'),`

相关观点：

```
@login_required(login_url='/login/')
def add_post(request):
    template_name = 'add.html'
    owner = request.user
    if request.method == "POST":
        form = addForm(request.POST)
        if form.is_valid():
            titleform = form.cleaned_data['title']
            bodyform = form.cleaned_data['body']
            checkform = form.cleaned_data['isdraft']

            n = Post(title=titleform, body=bodyform, isdraft=checkform, owner=owner)
            n.save()
            messages.add_message(request, messages.SUCCESS,
                'New post created successfully!')
        else:
            messages.add_message(request, messages.WARNING,
                'Please fill in all fields!')
    else:
        form = addForm()
    return render_to_response(template_name, {'form': form, 'owner': owner,},
        context_instance=RequestContext(request)) 
```

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-11-06T18:52:11.490

这些是帮助我解决问题的工具/方法。首先，我有一个名为的辅助实用程序方法`render_to_json`：

```
# `data` is a python dictionary
def render_to_json(request, data):
    return HttpResponse(
        json.dumps(data, ensure_ascii=False),
        mimetype=request.is_ajax() and "application/json" or "text/html"
    ) 
```

我有一个`messages.html`模板来为弹出消息呈现必要的 html：

```
{% for message in messages %}
<li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
{% endfor %} 
```

在创建响应 AJAX 请求的消息时，我使用 Django`render_to_string`将消息打包成一个字符串，该字符串存储在`data`字典中，然后使用 my`render_to_json`返回适当的响应：

```
def my_custom_view(request)
    # ...  your view code
    data = {
        'msg': render_to_string('messages.html', {}, RequestContext(request)),
    }
    return render_to_json(request, data) 
```

然后，在我的 jQuery`$.post(...)`回调函数中，我检查`response`对象是否具有`msg`属性，然后将 的内容插入`response.msg`到我想要的 DOM 中，如果需要，可以使用 jQuery 转换。我的`base.html`模板包含`<ul>`消息的容器：

```
<ul id="popup-messages-content">
    {% include 'messages.html' %}
</ul> 
```

请注意，以上内容包括`messages.html`您想要在实际页面加载（非 AJAX 请求）上显示消息的情况 - 如果没有消息，则它是空白的，但`<ul>`仍然可以将 AJAX 接收到的消息推送到其中。

最后一部分是我在任何`$.post(...)`回调中使用的 Javascript 函数（需要 jQuery）来显示消息：

```
function showPopupMessage(content) {
    var elMessages = $('#popup-messages-content');
    if (elMessages.length && content) {
        elMessages.html(content);
    }
} 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2014-05-22T13:55:41.847

您只需像往常一样创建消息，然后在发送响应之前将它们放入字典列表中：

```
django_messages = []

for message in messages.get_messages(request):
    django_messages.append({
        "level": message.level,
        "message": message.message,
        "extra_tags": message.tags,
}) 
```

然后你添加任何数据和你的消息并序列化它，例如：

```
data = {}
data['success'] = success
data['messages'] = django_messages

return HttpResponse(simplejson.dumps(data), content_type="application/json") 
```

最后在你的ajax：

```
success: function(data){
                                success = data.success;
                                update_messages(data.messages);
                                if (success){
                                    ...                                                                             
                                }
                            }, 
```

和 update_messages 函数：

```
function update_messages(messages){
$("#div_messages").html("");
$.each(messages, function (i, m) {
                $("#div_messages").append("<div class='alert alert-"+m.level+"''>"+m.message+"</div>");
            }); 
```

}

它工作得很好，我发现它很容易实现

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-06T18:37:41.667

这是一个简单的想法。

在 layout.html 中为您的消息添加占位符，这允许在 javascript 中附加新消息：

```
<div id="messages">
{% for message in messages %}
    <div id="notice" align="center">
        {{ message }}
    </div>
{% endfor %}
</div> 
```

代替：

```
{% for message in messages %}
    <div id="notice" align="center">
        {{ message }}
    </div>
{% endfor %} 
```

在 add.html 中，添加**另一个**，例如：

```
{% if messages %}
<ul class="hidden-messages" style="display:none">
    {% for message in messages %}
        <div id="notice" align="center">
            {{ message }}
        </div>
    {% endfor %}
</ul>
{% endif %} 
```

ajaxForm 看起来像：

```
$('#your_form_id').ajaxForm({
    success: function(responseText) {
        var newMessages = $(responseText).find('.hidden-messages').html();
        $('#messages').append(newMessages);
    },
}); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2020-11-08T19:20:09.553

在模板中

```
<div id="ajax_message">
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}  fade show">
                {{ message|safe }}
            </div>
        {% endfor %}
    {% endif %}
</div> 
```

ajax_send 启动函数后

```
$("#ajax_message").load("this_url #ajax_message"); 
```

或者

```
function alert_message() {
    var pathname = window.location.pathname;
    $("#ajax_message").load(pathname+" #ajax_message");
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-10-10T09:14:10.373

# 使用 django-bootstrap5 lib 时如何做到这一点：

### 向只返回自定义 messages.html 模板的消息视图发出 AJAX 获取请求。

好的，我回顾了迄今为止在这个问题上所做的一些工作，并且我想出了一个简洁的解决方案，可能是上述的副本，但是，我的帖子与那些我专门为编码人员解决这个问题的帖子不同使用**django-bootstrap5**。因此，如果那是您，请进一步阅读，这可能会解决您的问题。

这`<DefaultApp>`是一些 IDE 为 Django 项目创建的默认应用程序。我当前的项目被调用`AbstractSpacecraft`，它有一个`AbstractSpacecraft`也称为子文件夹，其中包含`settings.py`并且我称之为默认应用程序。

`<DjangoProject>/<DefaultApp>/javascript_tools.js`：

```
window.messages_tag_id = "#django-messages-div";
window.messages_url = null;

function load_html_from_url(url, elem) {
    $.get(url, function(data, status) {
        elem.html(data);
    });   
}

function display_django_messages() {
    messagesDiv = $(window.messages_tag_id);
    messagesDiv.empty();
    load_html_from_url(window.messages_url, messagesDiv);
}

function post_string_to_url(data, url)
{
    $.ajax({
        type: 'POST',
        url: url,
        data: data,
        success: function(data, status, xhr) {         // Function( Anything data, String textStatus, jqXHR jqXHR )
            if ('msg' in data) {
                const msg = data['msg'];
                console.log(msg);
                display_django_messages();
            }
        },
        error : function(xhr, errmsg, err) {
            // Provide a bit more info about the error to the console:
            if (errmsg) {
                console.log('ERROR: ' + errmsg);
                display_django_messages();
            }
            console.log(xhr.status + ": " + xhr.responseText);             
        }
    });
}

function csrf_safe_method(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}

function setup_ajax_csrf_token(csrf_token) { 
    // BUGFIX.  This took hours to get to work!  
    // And remember the csrf_token line at the top of template
    window.csrf_token = csrf_token;

    $.ajaxSetup({
        beforeSend: function(xhr, settings) {
            if (!csrf_safe_method(settings.type) && !this.crossDomain) {
                xhr.setRequestHeader("X-CSRFToken", csrf_token);
            }
        }
    });
} 
```

`

`<DjangoProject>/templates/<AppName>/your_template.html`（仅相关部分）：

```
<script>
    $(document).ready(function()
    {
        // Remember to call this!
        setup_ajax_csrf_token("{{ csrf_token }}");   

        let ui = window.ui;

        $("#diagram-name-form").submit((event) => {
            event.preventDefault();
            const data = {
                "diagram name" : $("#diagram-name-input").val(),
                "diagram id" : "{{ diagram_id }}",
            };
            const set_name_url = "{% url 'set_model_string' Model='Diagram' field='name'%}";

            post_string_to_url(data, set_name_url, "{% url 'messages' %}");
        });
    });        

</script>

 .....

<div class="form-outline">
    <form class="row row-cols-lg-auto g-3 align-items-center" method="post"
        id="diagram-name-form">
        {% csrf_token %}

        <input type="text" id="diagram-name-input" class="form-control" placeholder="Diagram name?" />
    </form>
</div> 
```

`<DjangoProject>/templates/<DefaultApp>/messages.html`：

```
{% load django_bootstrap5 %}

{% autoescape off %}{% bootstrap_messages %}{% endautoescape %} 
```

`<DjangoProject/<DefaultApp>/views.py`：

```
from django.shortcuts import render
from django.views.generic.base import TemplateView, View

class MessagesView(View):
    template_name = 'AbstractSpacecraft/messages.html'

    def get(self, request, *args, **kwargs):
        return render(request, self.template_name) 
```

`<DjangoProject>/<DefaultApp>/base.html`：

```
{% block bootstrap5_content %}
  {% block as_navbar %}  <!-- as = AbstractSpacecraft -->
   ....
  {% endblock %}

  <div class="container-fluid">
      <div class="row">
          <div class="col">
              <div class="row" id="django-messages-div">
                {% autoescape off %}{% bootstrap_messages %}{% endautoescape %}              
              </div>              
              {% block content %}{% endblock %}                
          </div>
      </div>
  </div>
{% endblock %}
.... 
```

基本上，在我们收到来自 ajax POST 请求的 OK 后，我们执行 ajax GET 请求，现在一切正常，它可能会工作，但我无法开始`messagesDiv.load(url)`工作，通过查看 Chrome DevTools 中的 Network 选项卡和下流量分析器，当一切正常时，您应该会看到一个 POST 请求，然后是一个 GET 请求。

ajax GET 只是获取一个`messages.html`模板，然后我们用新的消息来填充该模板。我们确保清除第`messageDiv`一个，这样消息就不会堆积在 gui 上。

# config - 将应用程序注入resources.groovy

> ID：13256822
> 
> 赞同：2
> 
> 时间：2012-11-06T18:11:09.390
> 
> 标签：config, grails-2.0

我正在使用 grails 2.0.4 并想参考我的`resources.groovy`文件中的配置信息。在早期版本的 grails 中，我曾经`ConfigurationHolder`获取此信息，但现在已弃用。

通过阅读其他帖子，我对如何进行感到困惑。[一个](http://grails.1312388.n4.nabble.com/Using-ConfigObject-in-resources-groovy-under-grails-2-td4204499.html)建议将属性`application`注入到`GrailsApplication`bean 中；[另一个](https://stackoverflow.com/questions/7065957/read-grails-config-parameter)建议使用`grailsApplication`，但在我的`resources.groovy`文件中似乎都不起作用。

[我必须按照此处](https://stackoverflow.com/questions/7133580/how-to-access-grails-configuration-in-grails-2-0#answer-10702781)所述“手动”加载`GrailsApplication`bean吗？还是有更优雅的解决方案？访问配置信息的工作资源文件的示例会很棒。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-11-10T21:20:58.100

对我有用的是：

```
application.config.my.etc 
```

我什至不必定义应用程序或 grailsApplication

（grailsApplication 也不适合我）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-16T07:59:10.963

我认为[这篇文章](https://stackoverflow.com/questions/7133580/how-to-access-grails-configuration-in-grails-2-0)已经回答了你的问题：

```
// resources.groovy
beans = {
    grailsApplication = ref('grailsApplication')
    // So from here you could use grailsApplication to access the config object (e.g. grailsApplication.config.defaultFolder
} 
```

问候，

路易斯米

# java - 添加到日历日期...不准确？

> ID：13256825
> 
> 赞同：1
> 
> 时间：2012-11-06T18:11:22.183
> 
> 标签：java, android

任何人都可以请帮忙。我正在从日历中获取当前日期。然后我想通过添加月数将字符串设置为新日期。当我使用以下代码时，当我添加 12 个月时它可以工作，但是当我尝试添加 1 个月时，下一个日期是 1 月（ +2 个月）当我尝试增加 3 个月时，下一个日期是四月。6 个月，下一个日期是 2013 年 10 月等......当尝试添加 24、36 或 48 个月时，它几乎可以工作，但提前 1 个月。日期的变化似乎没有规律

```
//Get Current date and set as text
    Calendar c = Calendar.getInstance();
    c.add(Calendar.MONTH, Retest);        // Months to Date
    int day = c.get(Calendar.DATE);
    int month = c.get(Calendar.MONTH);  
    int year = c.get(Calendar.YEAR);

    if (month<=9)  { MONTH$ = "0"+month   ;}
    else {MONTH$ = ""+month;               }    //Set month to MM

   NextTest$ = ""+day+"/"+MONTH$+"/"+year;    //Put date ints into string DD/MM/YYYY

   Toast.makeText(this, "Re-Test Due.. "+NextTest$, Toast.LENGTH_SHORT).show(); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:38:25.060

在 Calender API 中，1 月映射为 0，因此 10 月映射为 9。因此，如果您试图根据人工日历找出当前月份，则在 java 日历的月份值上加 1，然后只计算该值。

```
int day = c.get(Calendar.DATE);
    int month = c.get(Calendar.MONTH) + 1; //It should work for you.  
    int year = c.get(Calendar.YEAR); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:28:10.760

根据 Java Docs ，如果将任何值传递给 Calender 的 Add Function ，则大于 Field 的值，它将添加它的模数。参考[GregorianCalender](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/GregorianCalendar.html#add%28int,%20int%29)文档

# c# - .NET/Java 世界中的 IoC/DI

> ID：13256826
> 
> 赞同：-2
> 
> 时间：2012-11-06T18:11:26.057
> 
> 标签：c#, java, .net, dependency-injection, inversion-of-control

我是一名专业的 .NET 开发人员，我知道很多地方，IoC 尤其是 DI 可以改进应用程序架构（模块化、不同的接口抽象、设计时代理、高级单元测试等）。我知道许多用于构建松散耦合应用程序设计的不同框架，例如 Prism、MEF、Castle 等，并且每个框架都实现/支持 IoC(DI) 原则。

但我也对 Java 开发感兴趣，我想知道： *IoC/DI 在 Java 世界中是否流行，如果是，我想找出这个概念最常用的领域以及最流行的框架，它们可以提供最好的使用它的设施？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:17:57.177

您应该看看[Spring Framework](http://www.springsource.org/spring-framework)。它现在大了很多，但它是围绕一个坚固的 IoC 容器的核心萌芽的。

# jquery - 超出范围的jquery错误

> ID：13256829
> 
> 赞同：0
> 
> 时间：2012-11-06T18:11:43.867
> 
> 标签：jquery

我不断收到超出范围的错误。我认为问题在于我在两个地方包含了 jquery 库，但我没有。

好吧，我下载了这个 jquery 滚动条 [http://www.dynamicdrive.com/dynamicindex11/facescroll/index.htm](http://www.dynamicdrive.com/dynamicindex11/facescroll/index.htm)

把它放在我的主文件夹中，然后用一个非常简单的 HTML 文件调用它。* * *

```
 <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
  <script type="text/javascript" src="jquery.ui.touch-punch.min.js"></script>
  <script type="text/javascript" src="facescroll.js">
  </script>

  <script type="text/javascript">
    $(document).ready(function(){ // on page DOM load
      $('#demo1').alternateScroll({'hide-bars':false});
    })
 </script>
</head>
<body>

<div id="demo1"  style="width:470px; height:485px; overflow:scroll;float: left;overflow-x: hidden;">
  <iframe height="" width="455px" key="1" id="fone" scrolling="no" frameborder="0" src="https://www.google.com" ></iframe>
</div> 
```

代码有时执行得很好，facescroll.js 库不是这个： [http ://www.dynamicdrive.com/dynamicindex11/facescroll/index.htm](http://www.dynamicdrive.com/dynamicindex11/facescroll/index.htm)

提前致谢

# asp.net-web-api - 从 ASP.Net Web API 获取相关记录的正确方法？

> ID：13256835
> 
> 赞同：0
> 
> 时间：2012-11-06T18:12:15.953
> 
> 标签：asp.net-web-api

我有两个类之间的多对多关系：供应商和产品。

在我的 Web API 中，每个类都有一个控制器。两个控制器都具有明显的操作，即获取对象列表和通过 Id 获取单个对象。

我需要的是一个为每个对象获取许多对象的操作。例如，如果我提供了 VendorId，那么我想要 Vendor 提供的所有产品。同样，如果我提供 ProductId，那么我想要所有提供产品的供应商。

我有三个问题：

1) 我认为 Product 控制器应该具有接受 VendorId 并返回 Products 的操作（对于 Vendor 控制器反之亦然）。这是“正确”的方法吗？

2）我如何实现上述？我不能只添加另一个采用 Id 的 Get 操作，因为控制器已经具有具有该方法签名的操作（单项方法）。

例如：

```
http://localhost:53962/api/product/1         // grabs product with Id = 1.
http://localhost:53962/api/product/vendor/1  // causes 404 
```

3) 当我想要特定供应商的所有产品时，Url 应该是什么样子？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:33:40.993

> 1) I think the Product controller should have the action that takes a VendorId and returns the Products (and visa-versa for the Vendor controller). Is this the "proper" approach?

Yes, this will work. For example, you can have 2 such actions in your ProductController:

```
 public Product Get(int id) {...}
    public Product GetProductWithVendorId(int vendorId) {...} 
```

> 2) How do I implement the above? I can't just add another Get action that takes an Id because the controllers already have an action with that method signature (the single item method).

That is correct if you want to call the above 2 actions using route parameter. There are different ways to approach this. One way is to modify your route. Another way is to pass the action parameter in the URL.

> 3) What should the Url look like when I want all the Products for a specific vendor?

Here is an example of passing parameter in the URL. This URL will invoke the ProductController's 'Get' action:

```
http://../api/product/123 
```

This URL will invoke the ProductController's 'GetProductWithVendorId' action:

```
http://../api/product?vendorid=456 
```

# c++ - 私有成员数据的模拟

> ID：13256837
> 
> 赞同：4
> 
> 时间：2012-11-06T18:12:21.333
> 
> 标签：c++, unit-testing

我正在寻找 C++ 编码风格的最佳实践，以确保易于单元测试。问题来自尝试为私有数据成员实现模拟类。私有数据成员在类中的几个不同方法中被访问。到目前为止，我能找到的所有示例都展示了如何编写模拟类，但没有展示如何最好地编写同时使用真实对象和模拟对象的代码。

在下面的示例中，我不确定如何将 mCustom 从类型 MyOtherClass 获取到我的模拟 MockMyOtherClass。我怀疑我的方法是错误的，因此是问题所在。

```
class MyClass {
    MyOtherClass mCustom;
}; 
```

[编辑]
我使用了编译器指令并添加了一个新的构造函数。

```
#ifdef UNIT_TESTING
 #include "mock.h"
#else
  #include "myotherclass.h"
#endif

class MyClass {
        MyOtherClass mCustom;
     public:
        MyClass(MyOtherClass pClass) : mCustom(pClass) {}
}; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:51:46.467

您可以使用几种不同的策略（并根据需要混合使用）。

1.  如果 MyOtherClass 提供了相当基本的功能并且本身经过了很好的测试，那么我通常不会费心去模拟它。我只是确保在对整个项目运行单元测试时，MyOtherClass 在 MyClass 之前进行测试。

    ```
    class MyClass {
    private:
        MyOtherClass mCustom;
    public:
        //...
    }; 
    ```

2.  您可以将 MyClass 模板化，在真实代码中提供 MyOtherClass，在测试代码中提供 MyOtherClass 的模拟版本。

    ```
    template <class T>
    class MyClass_impl {
    private:
        T mCustom;
    public:
        //...
    };

    typedef MyClass_impl<MyOtherClass> MyClass; // convenience typedef 
    ```

3.  您可以将 MyOtherClass 拆分为接口类和实现类。MyClass 仅存储指向接口类的指针，并在实例化时获取对实现的引用。

    ```
    class MyClass {
    public:
        MyClass(MyOtherClass* aCustom) : mCustom(aCustom) {}
    private:
        MyOtherClass* mCustom;
    public:
        //...
    }; 
    ```

4.  您可以使用标题的搜索路径来玩技巧。为此，您在单独的目录中创建 MyOtherClass 的模拟版本。然后确保对于单元测试，首先在这个单独的目录中搜索头文件。这使得首先找到 MyOtherClass 的模拟版本并覆盖 MyOtherClass 的真实版本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:16:13.513

当我之前遇到这个问题时，我分为`MyClass`两个类：（1）一个没有引用的泛型类`MyOtherClass`，以及（2）一个用 . 实例化模板参数的实现类`MyOtherClass`。定义的可见性并不相同，但我发现它对于任何实际目的都不重要。

然后为了测试，我写了类似的东西`MyTestOtherClass`并相应地实例化`MyClass`。可以将任意数量的模拟技术应用于`MyTestOtherClass`，并且可能会为不同的测试目的生成多个类。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-02-15T23:35:56.720

一种不需要任何代码重新架构的hacky方法，假设`#ifndef`正在使用标头保护，是通过在包含实际标头之前在测试代码中定义标头保护宏来利用它们。

例子：

MyClass.hpp：

```
#ifndef MY_CLASS_HPP
#define MY_CLASS_HPP

#include "MyOtherClass.hpp"

class MyClass { MyOtherClass custom; };

#endif 
```

MyOtherClass.hpp：

```
#ifndef MY_OTHER_CLASS_HPP
#define MY_OTHER_CLASS_HPP

class MyOtherClass {};

#endif 
```

测试代码.cpp：

```
class MyOtherClass {
    // mocking
};

#define MY_OTHER_CLASS_HPP 
// prevents the #include "MyOtherClass.hpp" in "MyClass.hpp" from doing anything
// while the mock version is used

#include "MyClass.hpp"

// test code 
```

如果您要测试的代码在 .cpp 文件中，您也可以只`#include`在测试中使用 .cpp 文件（并确保不要单独编译以避免重复定义），以便注入标头保护宏定义。

# compiler-construction - 编译器：符号表如何从源机器传递到目标机器？

> ID：13256838
> 
> 赞同：1
> 
> 时间：2012-11-06T18:12:21.037
> 
> 标签：compiler-construction, backend, symbol-table

前端和后端都使用符号表，但是假设目标代码将在不同的机器上运行，符号表如何传递给后端？它会以某种方式“附加”到中间表示，还是会包含在逻辑地址空间的实例中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:30:37.890

用于链接的符号表放置在中间目标代码文件中，扩展名为 .o 或 .obj，具体取决于平台。有关概述和其他链接，请参阅标题为[对象文件的文章。](http://en.wikipedia.org/wiki/Object_file)那里不仅有一个符号表，还有诸如重定位表和动态链接数据之类的东西，基本上是最终将代码加载到系统 RAM 中并执行所需的一切。

# c# - 从对象字典中获取对象

> ID：13256844
> 
> 赞同：4
> 
> 时间：2012-11-06T18:12:47.357
> 
> 标签：c#, object, dictionary, boxing

我正在尝试从对象字典中提取一个对象，并返回所述对象，但是我在类型方面遇到了一些问题。有问题的类看起来像这样，我想知道如何返回实际对象而不是变量（我假设默认情况下是一个字符串）。

```
 public Object GetObject(string foo){

 if(someDict.ContainsKey(foo))
 {
   var pulledObject = someDict[foo];

 }
  return pulledObject;
 } 
```

我原以为需要拳击，比如

```
 object pulledObject = someDict[foo]; 
```

但这似乎不起作用，任何可以为我指明正确方向的建议。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-06T18:15:21.330

你并没有真正说什么是行不通的，但你在正确的轨道上。尝试这样的事情：

```
public Object GetObject(string foo){

  if (someDict.ContainsKey(foo))
    return someDict[foo];
  return null;
} 
```

我怀疑您的问题是您遇到了一个`pulledObject`在子范围内的编译错误。

更新：正如 Jon Skeet 指出的那样，使用 TryGetValue 会更好，这样您就不会执行两次查找（一次是在执行 ContainsKey 时，另一次是在使用索引器 [] 时）。因此，更好的解决方案是：

```
public Object GetObject(string foo){

  object pulledObject = null;
  someDict.TryGetValue(foo, out pulledObject);
  return pulledObject;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T18:15:28.460

假设代码是准确的，您就有范围问题。您在 if 语句的范围内声明您的 pullObject，使其无法在外部访问以使您的 return 语句正常工作。

```
public Object GetObject(string foo)
{
    object pulledObject = null;
    if(someDict.ContainsKey(foo))
    {
        pulledObject = someDict[foo];
    }
    return pulledObject;
} 
```

或（由 Jon Skeet 提供）

```
public Object GetObject(string foo)
{
    object pulledObject = null;
    someDict.TryGetValue(foo, out pulledObject);
    return pulledObject;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T18:16:08.810

您的代码不起作用的原因不是`pulledObject`类型错误，而是因为它超出了范围。你可以这样做：

```
public Object GetObject(string foo){
    if(someDict.ContainsKey(foo)) {
        return someDict[foo];
    }
    return null;
} 
```

用户会这样称呼您`GetObject`：

```
object res = GetObject(foo);
if (res == null) {
    // Object is not there - do something else
} 
```

这种模式的缺点是无法区分对象存在时的情况，而是`null`对象不存在时的情况。一种对 .NET 的字典 API 更“原生”的方法是使用`TryGetValue`而不是`GetObject`，如下所示：

```
object res;
if (someDict.TryGetValue(foo, out res)) {
} else {
    // Object is not there - do something else
} 
```

这种方法只执行一次查找操作，节省了 CPU（尽管坚持使用这种方法来提高所谓的速度将是一种微优化）。

# asp.net-mvc - 使用 RenderSection 从部分视图中注入 cshtml 中的 javascript 不起作用

> ID：13256854
> 
> 赞同：3
> 
> 时间：2012-11-06T18:13:39.400
> 
> 标签：asp.net-mvc, razor

我有一个部分视图，需要在页面底部添加一些 javascript。

主页面：

```
...some html...
<div>
@Html.Partial("_myPartial")
</div>

....more html....

//required JS at BOTTOM -  THIS should also come from above partial
@RenderSection("scripts", required: false) 
```

我的部分观点：

```
<div id="Slider">
    <img src="http://placehold.it/1000x400&text=[img 1]" />
    <img src="http://placehold.it/1000x400&text=[img 2]" />
    <img src="http://placehold.it/1000x400&text=[img 3]" />
    <img src="http://placehold.it/1000x400&text=[img 4]" />
</div>

@section scripts
{
 <script type="text/javascript">
  $(window).load(function () {
    $('#Slider').orbit();
  });
  </script>
} 
```

但这不起作用 - 不包括脚本部分。

我google了一下，不支持这个……嗯……

...您将如何处理这种情况？

建议是用脚本制作另一个部分并包括这个......不漂亮！

那里有更好的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-15T14:21:48.713

查看渲染页面的来源。问题是你的脚本在定义jQuery之前就出来了吗？

您的默认 _Layout.cshtml 可能有...

```
<!DOCTYPE html>
<html lang="en">
...
@RenderBody()
...
@Scripts.Render("~/bundles/scripts")
@RenderSection("scripts", required:false)
...
</html> 
```

您需要告诉 MVC 将您的脚本放在脚本包之后。在您的 DoStuff.cshtml 中，

```
...
@using (Html.BeginForm()){ //this bit is in the body of the page 
    @Html.TextBoxFor(m=>m.NewSalary)
    <input type="submit" data-confirmprompt='are you sure?' />
}
...

@section scripts{ //this bit will end up in the scripts section
<script type="text/javascript">
    //http://blogs.msdn.com/b/stuartleeks/archive/2010/12/16/using-asp-net-mvc-and-jquery-to-create-confirmation-prompts.aspx
    //cunning script so you can say 

    $(document).ready(function () {
        $('*[data-confirmprompt]').click(function (event) {
            var promptText = $(this).attr('data-confirmprompt');
            if (!confirm(promptText)) {
                event.preventDefault();
            }
        });
    });
</script>
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-12-10T16:11:56.790

您可以将它包含在您的部分中，然后它将被执行，省略`$(window).load`：

```
<div id="Slider">
    <img src="http://placehold.it/1000x400&text=[img 1]" />
    <img src="http://placehold.it/1000x400&text=[img 2]" />
    <img src="http://placehold.it/1000x400&text=[img 3]" />
    <img src="http://placehold.it/1000x400&text=[img 4]" />
</div>

 <script type="text/javascript">
    $('#Slider').orbit();
  </script> 
```

# javascript - 如何使用 javascript/jquery 在图像上实现丝印效果（虚线阴影效果）？

> ID：13256856
> 
> 赞同：-1
> 
> 时间：2012-11-06T18:13:44.547
> 
> 标签：javascript, jquery, css, html

当您将鼠标悬停在他们的图像上时，我想创建可以在网站[http://www.murmure.me/上看到的效果。](http://www.murmure.me/)

我知道他们使用两个不同的图像，但我希望能够在**没有 2 个图像的情况下复制这种视觉效果**，只需**使用一张图片**（没有点的图片）**和使用 javascript/jquery**。是否可以 ？

这个问题遵循最初的问题，它试图用 CSS 解决问题，但似乎不可能，或者只在太少的浏览器上：[如何使用 CSS 在图像上创建点阴影效果？](https://stackoverflow.com/questions/13256143/how-to-create-a-dotted-shadowy-effect-on-an-image-with-css/13256741#13256741))

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:24:52.030

这看起来将是一个两部分的问题：1）去饱和度/使图像变灰。2）以有序的方式在其上应用许多小点。

1）这很简单。在图像上放置另一个具有半透明灰色背景的元素。在鼠标悬停时，将元素淡化为完全透明。

2）假设跨浏览器兼容性仍然是一个问题，我只能看到一种方法可以在没有画布的情况下完成此操作。您需要创建一个正确大小的圆形元素（使用边框半径），然后在图像的宽度和高度上一遍又一遍地克隆它。您将需要计算图像“像素”中的区域，然后放入那么多。我会尝试将它们漂浮在透明度容器中，而不是绝对地将它们定位在一个循环中。

从[http://www.tutorialsbucket.com/draw-basic-shapes-css3-tips-and-tricks](http://www.tutorialsbucket.com/draw-basic-shapes-css3-tips-and-tricks)，这里是一个点的 css：

```
.circle {
    height: 2px;
    width: 2px;
    background-color: #72b8c2;
    border: 2px solid #234e5e;

    /* In this case we use half of the
     width and height as radius. */

    border-radius: 100px;
    -moz-border-radius: 100px;
    -webkit-border-radius: 100px;
} 
```

我将圆的宽度设置为 2px，以使其具有更“打印”的效果。克隆一个具有该类的元素，并将一个左浮动元素作为图像叠加层的子元素，按照宽度 * 高度 / 圆直径计算出的次数为：

```
for(var i=0; i<=$('#container').width()*$('#container').height()/$('#originCircle').width(); i++)
{
$(container).append($('#originElement').clone())
} 
```

愿上帝怜悯你的 DOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:50:17.210

我建议使用 CSS3 过滤器去饱和：

```
.desaturate { filter: grayscale(100%);
-webkit-filter: grayscale(100%);
-moz-filter: grayscale(100%);
-ms-filter: grayscale(100%);
-o-filter: grayscale(100%);
} 
```

然后在图像顶部应用另一个 div，背景重复为小圆圈。您可以使用 JS 正确调整此 div 的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T19:08:54.707

我建议您在所有现代浏览器都支持的 html5 中搜索 canvas 元素。

由于画布受媒体（甚至图像）的跨域策略约束，我无法为您设置 jsfiddle 示例。所以我在这里给你一个样本来给你一个想法：[这里](http://bonex.fr/testforstackoverflow/)

这是源代码：

```
<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>HTML5 Canvas</title>

<style type="text/css">
img{position:absolute;}
canvas{display:none;position:absolute;z-index:100;}
</style>

</head>

<body>
 <img src="beach_volley_layout.jpg"></img>   
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>
var canvas;
$('img').mouseover(function(){

    canvas = createCanvasOverlay(this);
    $(canvas).fadeIn(600);
}).mouseout(function(){
    $(canvas).fadeOut(600);
});

function createCanvasOverlay(image) {

    var canvas = document.createElement('canvas'),
        canvasContext = canvas.getContext("2d");

    // Make it the same size as the image
    canvas.width = image.width;
    canvas.height = image.height;

    // Drawing the default version of the image on the canvas:
    canvasContext.drawImage(image, 0, 0);

    // Taking the image data and storing it in the imageData array:
    var imageData = canvasContext.getImageData(0, 0, canvas.width, canvas.height),
        data = imageData.data;

    // Loop through all the pixels in the imageData array, and modify
    // the red, green, and blue color values.
    for (var i = 0, z = data.length; i < z; i++) {

        // The values for red, green and blue are consecutive elements
        // in the imageData array. We modify the three of them at once:
        data[i] = ((data[i] < 128) ? (2 * data[i] * data[i] / 255) : 20);
        data[++i] = ((data[i] < 128) ? (2 * data[i] * data[i] / 255) : (255 - 2 * (255 - data[i]) * (255 - data[i]) / 255));
        data[++i] = ((data[i] < 128) ? (2 * data[i] * data[i] / 255) : 20);

        // After the RGB elements is the alpha value, but we leave it the same.
        ++i;
    }

    // Putting the modified imageData back to the canvas.
    canvasContext.putImageData(imageData, 0, 0);

    // Inserting the canvas in the DOM, before the image:
    image.parentNode.insertBefore(canvas, image);

    return canvas;
}
</script>
</body>
</html> 
```

# java - 如何使用 Java 中的密码保护连接到系统上运行的服务器？

> ID：13256861
> 
> 赞同：0
> 
> 时间：2012-11-06T18:14:16.387
> 
> 标签：java, sockets

我是这个网站的新手。我在 Java 中遇到了套接字编程的问题。我写了一个服务器，它处理客户端。一切都很好，工作正常。

如果我要运行服务器的网络受密码保护，我该怎么办？这意味着我们必须提供我们要登录的系统的用户名和密码？

如果我在这种受保护的网络上运行服务器并尝试通过客户端连接，则不会创建客户端套接字，因为服务器拒绝连接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:46:11.597

> 如果我在这种受保护的网络上运行服务器并尝试通过客户端连接，则不会创建客户端套接字，因为服务器拒绝连接。

服务器拒绝连接的原因有很多。如果您可以在客户端和服务器在同一台机器上运行时连接，但当客户端在不同的机器上时不能连接，则问题可能是服务器正在运行防火墙并且不允许来自“外部”的连接。

如果客户端位于完全不同的网段上，即客户端位于 Internet 上“很远”的某个地方，则两个系统之间可能存在多个防火墙，其中任何一个都可能拒绝连接。

另一种可能性是，当服务器打开它时`ServerSocket`，您将其绑定到`127.0.0.1`而不是`0.0.0.0`. 在这种情况下，服务器只能接受来自 的连接`localhost`，即来自同一台机器的连接。它将完全不知道源自其他任何地方的连接。

如果没有更好地解释客户端和服务器的位置，就不可能给出更好的答案。但是有一点是肯定的：您需要身份验证才能“登录”到系统这一事实与您的情况无关。

# ruby-on-rails - 如何使用一个控制器操作管理多个订阅？

> ID：13256865
> 
> 赞同：0
> 
> 时间：2012-11-06T18:14:32.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3, model-view-controller

我有以下订阅创建系统，现在当我选择可用订阅组（营销、销售）操作时`Save Subscription`创建这两个订阅：

```
@apps = App.all
if request.post?
  if params[:subscription] and params[:subscription][:app_id]                       
    params[:subscription][:app_id].each do |app_id|                
      Subscription.create_unique({user_id: current_user.id, app_id: app_id, approved: true})
    end
    redirect_to root_path
  end
end
@subscriptions = current_user.subscriptions 
```

所以我只能添加新`Subscriptions`的（在这个特定的例子中我只能添加`Engineering`）

![订阅](../Images/d10b8580465acbef3ea59ab8a112276a.png)

如何重构该操作，以便能够通过取消选中订阅组来销毁订阅组（例如，我想从营销组取消订阅）？

所以当我选择**营销**和**工程**时，那就是`params[:subscription][:app_id]`平等的`[marketing.id, engineering.id]`

```
 # app_menu.html.erb
  <%= form_for :subscription do |f| %> # this form goes to app_menu action above
    <ul>
        <% @apps.each do |app| %>
        <li>
            <%= check_box_tag app.id, current_user.access?(app) %><span><%= app.name %></span>
        </li>
        <% end %>
    </ul>
    <%= f.submit %>
    <% end %>
  <% end %> 
```

关系：

```
App
  has_many :subscriptions
  has_many :users, through: :subscriptions
User
  belongs_to :app
  has_many :subscriptions, :dependent => :destroy
Subscription
  belongs_to :user
  belongs_to :app

  def self.create_unique(p)
    s = Subscription.find :first, :conditions => ['user_id = ? AND app_id = ?', p[:user_id], p[:app_id]]
    Subscription.create(p) if !s
  end 
```

架构

```
# == Schema Information
#
# Table name: subscriptions
#
#  admin      :boolean
#  app_id     :integer
#  created_at :datetime
#  id         :integer          not null, primary key
#  updated_at :datetime
#  user_id    :integer
#
# Table name: apps
#
#  created_at :datetime
#  id         :integer          not null, primary key
#  name       :string(255)
#  updated_at :datetime
#  user_id    :integer
#
# Table name: users
#
#  app_id     :integer
#  created_at :datetime
#  id         :integer          not null, primary key
#  updated_at :datetime 
```

所以问题是如何找到哪些应用程序未被选中？

然后删除他们的订阅并使用`Feed.app_destroy_items(app)`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T23:02:45.957

好的，所以在您的情况下，订阅是应用程序和用户之间的连接模型。这意味着您可以像这样看到用户的应用程序：

```
user.apps # returns array of apps 
```

这意味着您也可以以相同的方式设置它们。所以这样的事情应该有效：

```
if params[:subscription] and params[:subscription][:app_ids] #call it app_ids since you're getting an array of them.                   
  apps = App.find(params[:subscription][:app_ids])
  current_user.apps = apps
else
  current_user.apps = []
end
current_user.save 
```

因为订阅是一个连接模型，并且您已经在两端链接了它，所以在大多数情况下，您真的不需要直接加载模型。

* * *

上面更新以显示处理取消选中所有应用程序。

回复评论：

如果您需要了解新旧应用程序之间的区别，您可以执行以下操作：

```
original_apps = current_user.apps

... the code from above ...

deleted_apps = original_apps - current_user.apps
deleted_apps.each do |app|

  ... whatever ...

end 
```

但是，在我看来，您的控制器在这里变得愚蠢。为什么不在模型层处理更多的这些？

例如 for `Feed.app_destroy_items(app)`，为什么在销毁后订阅中没有回调呢？

```
after_destroy :destroy_app_from_feed
def destroy_app_from_feed
  Feed.app_destroy_items(app)
end 
```

至于设置`approved=true`......用户如何获得未批准的订阅？这样想吧。他们没有选择单击未显示的选项，对吗？这是他们必须付费才能获得某些东西的问题吗？

几乎不应该在控制器级别决定用户是否能够订阅某些内容。所以，我会说在订阅中放置一个回调，不允许为未经授权的用户保存它，然后您可以响应用户是否保存，如果没有，则显示用户错误。

# math - 试图计算一个有 5 个数字的棋盘的状态空间

> ID：13256866
> 
> 赞同：3
> 
> 时间：2012-11-06T18:14:44.617
> 
> 标签：math, search, artificial-intelligence, state-space

我有一个 5x5 棋盘，棋盘顶行有 1..5 个数字。

每个数字最终都可以在任何位置结束，只要它不在另一个数字之上。

每个数字都可以在一次移动中向上、向下、向左或向右移动，但是我认为这不会对状态空间产生影响，因为最终每个数字都可以在无限量的移动中出现在任何地方。

因为每个数字最终都可以在任何时候出现在任何地方，除了在另一个数字之上我假设一个数字可以在任何时候处于 1/21 的位置？即棋盘空间 (25) 减去它不能位于 (4) 之上的数字。

我最初的计算是 ((n*n)-(n-1))^n 因为我试图考虑到一个数字不能在另一个数字之上但是我发现了以下计算：

我在 wiki 页面上发现了这个作为计算围棋棋盘状态空间的一种方式。

每个空间可以有 6 个不同的可能值（1..5 和空），棋盘有 25 个方格，所以方程为 (n+1)^(n*n) = 6^25 = 2.843x10^19

它是否正确？一个数字在任何一个时刻只能出现在 25 个空格中的 21 个空格中这一事实不会影响它吗？

如果不正确，请告诉我原因或/并提供可行的解决方案。

非常感谢！:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T19:00:09.680

> 它是否正确？一个数字在任何一个时刻只能出现在 25 个空格中的 21 个空格中这一事实不会影响它吗？

不，这是不正确的。与围棋棋盘的不同之处在于您只有 5 个数字，因此 25 个位置中始终有 20 个是空的，并且每个非空状态只能出现一次。

所以`25 `choose` 5`数字所在的五个地方是有可能的，五个数字可以`5!`在这五个地方按不同的方式排列。

因此，您的总状态空间为

```
25!/20! = 21*22*23*24*25 = 6375600 
```

状态。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:59:14.483

我认为您正在寻找的答案是（25 选择 5）*5！

这相当于选择棋盘上的任意五个空格，然后在其中排列数字的所有组合。不过，这可能没有考虑重叠。

# c# - 页面刷新编码 UI 上的断言

> ID：13256868
> 
> 赞同：0
> 
> 时间：2012-11-06T18:14:51.597
> 
> 标签：c#, coded-ui-tests, page-refresh

我有一个测试需要验证是否设置了自动刷新属性。我的第一个想法是`.WaitForControlExist()`在页面刷新时发生的加载页面，但编码 UI 太慢而无法捕获该控件，因为它在半秒左右后消失。

我的问题是是否有一种方法可以等待页面刷新，该方法具有类似于 WaitForControlExist() 的某种超时

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T22:12:41.850

页面上有一个显示某些数据的网格。我最终做的是设置自动刷新，向网格中添加更多数据，等待指定的时间，并验证附加数据是否存在。

自动化测试需要很多创造力，有时您必须从侧面对其进行攻击。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-07T17:38:32.200

你可能会用我`.WaitForControlExist()`来点击控制。取而代之的是您可以使用`if(uIabc.Exists)`或任何控件。但是一旦控制在那里，它将被追逐，您可能需要在运行时动态创建新的控制对象。

# objective-c - NSView.animator isAnimating 引发错误

> ID：13256870
> 
> 赞同：0
> 
> 时间：2012-11-06T18:14:57.090
> 
> 标签：objective-c, core-animation, nsview

我有一些正在制作动画的*NSView*子类（更改帧和 alpha 值）。有时我需要停止动画，但是我不断收到错误

这是一个代码：

```
[NSAnimationContext beginGrouping];
[[NSAnimationContext currentContext] setDuration:1.5f];
[textView.animator setFrame:frame];
[textView.animator setAlphaValue:0.0];
[NSAnimationContext endGrouping];

if ([textView.animator isAnimating]) { // Here the exception is raised
    NSLog(@"%@ is animating!", textView);
} 
```

我想打电话`[textView.animator isAnimating]`，但这只是给了我

```
Exception detected while handling key input.
*** -[NSProxy doesNotRecognizeSelector:isAnimating] called! 
```

带有代码的示例项目位于[https://bitbucket.org/lukaszb/animationartifacts/src/0dc41660f26dd3b629c28bbbda6eb647](https://bitbucket.org/lukaszb/animationartifacts/src/0dc41660f26dd3b629c28bbbda6eb647)

我可能会`isAnimating`在我的子类中添加一些属性`NSView`并在动画开始和完成处理程序中设置它，但是我想这也可能导致一些竞争条件问题。

谁能帮助我如何检测视图是否正在动画？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T08:55:49.663

动画师和动画师都`NSView`没有 property `animating`，所以你不能只查询那个值。

但是，正如您所建议的，您可以为此目的定义自己的属性。诀窍是在动画完成后将其设置回`NO`，您可以使用`completionHandler`当前动画上下文的属性来执行此操作：

```
[NSAnimationContext beginGrouping];
[NSAnimationContext currentContext].completionHandler = ^{ self.animating = NO; };
// ... set up your animation ...
[NSAnimationContext endGrouping]; 
```

请注意，该块是在主线程上调用的（如文档中所示），因此只要您始终`animating`在主线程上设置属性，它将确保状态一致。由于您正在处理 UI 代码，因此可能就是这种情况。

# android - Android Skype 录音机

> ID：13256873
> 
> 赞同：-5
> 
> 时间：2012-11-06T18:15:03.563
> 
> 标签：android, skype, skype4java

嗨，我正在尝试开发能够记录 Skype 通话的 android 应用程序。问题是缺乏知识，你能给我一个提示如何简单或从哪里开始吗？

**我的想法是：**

*   创建侦听（我的意思是监视器）进程的服务，并在启动 Skype 传入/传出呼叫时，服务启动的记录器 - 立即开始记录，设备的麦克风源和扬声器源也是，名称记录的文件的日期和参与的联系人对话，当通话结束时 - 它会停止录音。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T19:15:33.780

正如社区评级所建议的那样，您应该尝试向我们提供不起作用的代码，并专门要求志愿者可以修复的东西。

除此之外，以下是我从过去使用 Android 和录制的经验中所知道的：

*   为了让您的应用程序记录屏幕上显示的内容，您需要访问 /dev0 图形缓冲区，除非您的设备已植根，否则这是不可能的。
*   大多数安卓设备也不允许您录制语音数据。（不确定当你root时是否可以，我猜你可以，但仍然很麻烦）。有一些方法可以解决这个问题，我会为此查看堆栈溢出的其他部分。

这取决于您对应用程序的需求。如果您只想让这个应用程序在少数人之间工作，那么您可以下载 Skype apk 并使用 Eclipse、Java 反编译器和 dedexer（类似于 dex2jar）对其进行逆向工程。然后root设备以访问视频和声音缓冲区以记录数据流。

我不推荐这种方法，即使尝试这样做也不能保证你能做到（特别是如果 Skype 使用 proguard 来混淆他们的代码）。

# iphone - Xcode Objective-C Segue“正在进行中的演示”

> ID：13256876
> 
> 赞同：8
> 
> 时间：2012-11-06T18:15:12.620
> 
> 标签：iphone, ios, xcode, segue, afnetworking

我正在尝试开发一个允许用户使用 AFNetworking 登录的应用程序。我已经正确设置了数据库，除了用户第一次登录外，一切似乎都运行良好。

我所拥有的非常简单：

```
[[API sharedInstance] commandWithParams:params
                               onCompletion:^(NSDictionary *json) {
                                   //result returned

                                   NSDictionary* res = [[json objectForKey:@"result"] objectAtIndex:0];

                                   if ([json objectForKey:@"error"]==nil && [[res objectForKey:@"UserID"] intValue]>0) {
                                       [[API sharedInstance] setUser: res];
                                       [self performSegueWithIdentifier:@"Login" sender:self];
                                   } else {
                                       //error
                                       [UIAlertView title:@"Error" withMessage:[json objectForKey:@"error"]];
                                   }

                               }]; 
```

基本上，上面的代码返回用户登录详细信息的结果，只有当登录详细信息匹配时才成功。正如您在上面看到的，我在 sharedInstance 中明确设置了用户，在整个应用程序中使用。设置用户后，我尝试执行 segue，因为这就是登录按钮应该做的。

segue 确实发生了，程序可以运行，但是有两个问题我无法解决，我一直在花费数小时试图修复它。首先我在 Xcode 的输出窗口中得到消息：

> 警告：在演示过程中尝试在 LoginVC 上演示 UITabBarController！

其次，为了测试用户设置是否正确，在配置文件屏幕（第一个屏幕连接到）上有一个标签，其文本设置为：

```
NSString stringWithFormat:@"Welcome %@",[[[API sharedInstance] user] objectForKey:@"username"]]; 
```

用户名是否实际出现或说（null）是一个命中或错过，如图所示：

![在此处输入图像描述](../Images/1b4a2683b03faef13c3a2a2fbed94a61.png)

您还可以看到我在那里制作的一个按钮，用于将用户的值打印到输出窗口。即使消息是“欢迎（null）”并且我按下按钮，所有值都正确存在，所以我不确定为什么字符串有时会显示为 null。

这是关于我遇到的问题的故事板设置：

![在此处输入图像描述](../Images/b2eeb9cf5199bd3925761ec28113afed.png)

如果有人可以帮助我解决这个问题，我将不胜感激。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-07T14:07:02.853

正如您正确诊断的那样，问题肯定是对 segues 的一些奇怪和/或重复调用。查看您的项目，问题在于您的“登录”按钮既有`IBAction`方法又有从该登录屏幕到下一个控制器（标签栏控制器）的segue：

![IBAction 和 segue](../Images/297ff3e27894c35410fa17314da9d8aa.png)

这是一个问题，因为当您点击按钮时会触发 segue，但会由您的`- (IBAction)login:(id)sender`代码再次触发。

因为你有一个`IBAction`，segue 不应该*是*从按钮到下一个控制器，而是来自控制器本身。`Login`因此，将现有的segue 从按钮删除到下一个屏幕，然后从控制器本身重新创建它：

![从控制器创建转场到下一个场景](../Images/88b9d5fe5b0fd3d9ae54dba172b6d310.png)

为新的 segue 提供“登录”标识符，现在您的“登录”按钮将不会自动执行 segue，而是让其`IBAction`工作并`performSegueWithIdentifier`酌情手动执行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-11T14:16:43.327

发送/触发事件：`Did End On Exit`

将它连接到您调用的方法`performSegueWithIdentifier`。

这样就不会触发两次。

# sql-server-2008 - 自定义网格以外的模板

> ID：13256877
> 
> 赞同：2
> 
> 时间：2012-11-06T18:15:15.837
> 
> 标签：sql-server-2008, sql-server-2008-r2, sql-server-2012

如何将自定义 sql 命令添加到默认模板（用于右键单击表，然后使用`Script Table as...`然后单击其中一个选项）？

![在此处输入图像描述](../Images/486e9bb9617150e36a5105cbf7476987.png)

代替：

```
UPDATE DB.dbo.table SET col1 = 'test' 
```

我想拥有：

```
BEGIN TRANSACTION
    UPDATE DB.dbo.table SET col1 = 'test'
ROLLBACK TRANSACTION 
```

或者任何自定义代码。

我确实查看了[SQL Server Management Studio 问题中的更改默认模板](https://stackoverflow.com/questions/1681645/change-default-template-in-sql-server-management-studio)，但它不允许自定义 sql。它允许您设置预定义的属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-04T07:23:39.847

您可以从 redgate 添加一个片段，该片段中有一个 sql server intellisense (sqlprompt)，您必须声明当您按“ur”和选项卡时，您将获得：

开始交易更新回滚交易

当您拥有代码片段时，您将能够自定义您想要的任何内容

# java - 添加到 java.util.regex.Pattern 或合并它们

> ID：13256878
> 
> 赞同：0
> 
> 时间：2012-11-06T18:15:18.320
> 
> 标签：java, regex, string, pattern-matching, filenames

我在一个`Pattern`对象中保存文件名格式数据。例如：`_\\d+x\\d+\\.png`。在我的设置中，这将表示不同大小的图标（例如`icon_16x16.png`，`icon_48x48.png`等等）。

我有一种将实际文件名与给定模式进行比较的方法；但是，还必须提供基本名称（在我的示例中，这将是“图标”）：

```
public boolean matches(String filename, String baseName) {
    if (!IOCase.SYSTEM.checkStartsWith(filename, baseName)) {
        return false;
    }

    return format.matcher(filename.replaceFirst(baseName, "")).matches();
} 
```

我在这里做的是首先检查是否`filename`以基本名称开头。如果是这样，则从文件名字符串中删除基本名称，以便可以将其与`Pattern`对象 ( `format`) 进行比较。

我知道我可以做到`return filename.matches(Pattern.quote(baseName) + format.pattern())`，但我想知道是否有更好的、希望更程序化的方式来做到这一点。

**准确地说，我想知道是否可以在** `java.util.regex.Pattern` **不处理它们的底层字符串表示的情况下添加或合并其中两个。**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:23:42.173

不，您不能修改已编译的`Pattern`. `Pattern`您可以通过组合正则表达式字符串并`Pattern.compile()`再次调用来创建一个新的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:42:09.747

在下面找到使用模式/匹配器/组的示例代码，无需任何字符串操作：

如果前缀只是单词字符

```
 Pattern p = Pattern.compile("(\\w+)(_\\d+x\\d+\\.png)");
    Matcher m = p.matcher("icon1_16x16.png");
    String baseName = "icon";
            //If match found, m.group(1) returns the prefix of `_..x..png`
    if(m.find() && baseName.equals(m.group(1))){
         System.out.println("Match Found");
    }else{
       System.out.println("Match Not Found");
    } 
```

如果前缀可以是任何字符，则使用正则表达式作为`(.+)(_\\d+x\\d+\\.png)`

# javascript - 如何获取标签的类属性的第一个值？

> ID：13256881
> 
> 赞同：2
> 
> 时间：2012-11-06T18:15:22.517
> 
> 标签：javascript, jquery

假设 body 标签有几个类属性：

```
<body class="html logged-in frontpage no-sidebar">
...
</body> 
```

目前，我使用 jQuery 来获取 body 标签的所有类属性：

```
$('body').attr('class'); 
```

我想获得最开始/第一类属性（这里是'html'类）。如何？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:16:51.467

```
$('body').attr('class').split(" ")[0]; 
```

您也可以使用普通的旧 javascript（请参阅 Vega 的回答）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T18:16:20.017

尝试如下，

```
//Using document.body
document.body.className.split(' ')[0] 
```

# sql - SQL - 从另一个表列值等于列名列表的表中选择列

> ID：13256882
> 
> 赞同：0
> 
> 时间：2012-11-06T18:15:22.867
> 
> 标签：sql

看到了很多关于基于值解析数据的类似帖子，但没有什么完全是我想要从一个包含另一个表的列名的表中获取结果列的内容。例如：

```
 Select [col1], [col2]
 from Table1
 where (select changes as (col#)
        from table2) 
```

col# 是我想要的 Table1 中的列名列表。Table2 更改列是一个逗号分隔的列表。我想找到一种方法，能够从 table2 的列表中获取 Table1 中的每一列。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:20:37.673

您必须即时创建查询。您可以通过以下方式执行此操作：

1.  首先将列中的数据提取`changes`到调用应用程序中，然后从该数据中组装一个 SQL 查询字符串并执行它，或者
2.  在存储过程中创建动态语句并`EXEC`对其进行 ing（或任何您的 RDBMS 的等效语句）。

请注意，如果数据`changes`来自用户输入，那么您将面临一个痛苦的世界。

如果您可以控制架构，我建议您避免这种存储数据的方式。一般来说，逗号分隔的列表很笨拙，并且从根本上违背了数据库的设计目的。一个变化表结构，每列可以改变一个布尔值，`(id, col1_changed, col2_changed)`或者每个改变的列只有一行，`(id, changed_col_name)`在普通查询中使用起来会容易得多。

# html - 基于最小高度的CSS页脚固定位置

> ID：13256883
> 
> 赞同：3
> 
> 时间：2012-11-06T18:15:26.473
> 
> 标签：html, css

我看过这里和各种教程，但不能达到我需要的效果。

因此，如果页面内容低于 600 像素，我希望将页脚固定在该高度的容器下方。

但是如果内容将容器高度增加到超过 600 像素，那么页脚应该被容器向下推到页面下方。

我试过使用 min-height 来利用，我的 html 看起来像这样

```
<body>
<div id="shell">
<div id="container">
Content
</div>
<div id="footer">Footer</div>
</div>
</body> 
```

我不会费心发布 CSS，因为它只是没有接近。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:59:11.770

你可以通过 CSS Trick 做到这一点，

**/* CSS 代码 */**

```
body, html{
    padding:0;
    margin:0;
    height:100%;
}

.wrapper{
    min-height:100%;
    position:relative;
}

.container{
    width:960px;
    margin:0 auto;
    padding-bottom:100px;
}

.header{
    height:100px;
    background-color:#066;
}

.footer{
    position:absolute;
    bottom:0;
    height:100px;
    background-color:#006;
    width:100%;
} 
```

 **```
<div class="wrapper">
    <div class="container">

        <div class="header">
            Header
        </div>

        <div class="body">

        </div>

    </div>

    <div class="footer">
        Footer
    </div>

</div> 
```

这是我的[小提琴文件](http://jsfiddle.net/8AuAn/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:20:16.720

我知道你试过`min-height`，但为什么这不合适？

```
#container
{
    background:#08e;
    min-height:600px;  
}

#footer
{
    background:#ddd;
} 
```**

# typescript - 如何从源代码构建 TypeScript 编译器 (tsc.js)？

> ID：13256885
> 
> 赞同：5
> 
> 时间：2012-11-06T18:15:43.230
> 
> 标签：typescript, tsc

如何从源代码构建 TypeScript 编译器（位于[typescript.codeplex.com](http://typescript.codeplex.com)）？当我从 git 克隆它时，我看到了一个 Makefile，但是在 cygwin 中的 make 失败了`*** missing separator (did you mean TAB instead of 8 spaces?)`

我找不到任何明确的文档，源代码中的自述文件也无济于事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T21:59:36.877

要将 makefile 与 mingw32 或 cygwin make 一起使用，您需要查看文件并修复缩进。

```
sed -i.bak -e "s/^[[:space:]]\+/    /" Makefile 
```

要让它编译，你可以发出这个命令：

```
make TYPESCRIPT_HOST="cscript //Nologo" compiler 
```

这也适用于`nmake`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T18:15:43.230

TypeScript 源代码中的 Makefile 是 NMAKE 格式，并且依赖于 Windows 命令。NMAKE 随 Visual Studio 一起提供，并且在您运行 Visual Studio 命令提示符时位于路径中。

为了构建，您需要在路径中同时使用 nmake 和[nodejs](http://nodejs.org)。然后运行：

```
nmake TYPESCRIPT_HOST=node world 
```

从包含您的 TypeScript 源的目录中。构建的`.js`文件将被放置在`built\local`

**编辑：**添加了缺少的参数设置 TYPESCRIPT_HOST

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T22:51:31.553

显然，还有一个更简单的答案。只需参考 /src/compiler 中的 tsc.ts 就可以了：

```
tsc tsc.ts --out tsc.js 
```

所有其他文件都是通过 /// 语法自动提取的。

# xcode - 具有异步加载远程图像的 TableView

> ID：13256887
> 
> 赞同：1
> 
> 时间：2012-11-06T18:15:49.767
> 
> 标签：xcode, uitableview, asynchronous

我会解释我的问题，我希望找到解决方案。我正在寻找如何解决这个问题的几周，但找不到如何去做，不想使用外部库或稀有类。

解释：

我有一个TableView 自动从XML 中获取信息，XML 中的所有信息都被我解析并存储在一个MutableArray 中。

该数组解析了我所有的 XML 标记，它工作正常。

要读取标签，我按如下方式执行解析器：

//要使用这个标签标题：

[[self.parseResults objectAtIndex:indexPath.row] objectForKey:@"name_category_ads"];

//要使用这个图像标签：

[[self.parseResults objectAtIndex:indexPath.row] objectForKey:@"image1_category_ads"];

问题：

TableView 文本正确加载了我的数组（标题），但我不能让它从我的数组中加载图像到 tableview：

我使用静态 URL 图像（网站上的图像）和异步加载测试了我的代码，如果它有效，但当我尝试从我的数组中执行它时它不起作用，它具有不同的图像 url。

//图片URL静态示例

```
NSString *imagenURL=@"http://www.principadoasturias.net/2011/pablo/03_php/archivos/iconos/jpg.jpg"; 
```

我的表的代码如下：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath {

static NSString *CellIdentifier = @"Cell";

//My custom cell

Cell_Category_Iphone *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
if (!cell) {
    cell = [[Cell_Category_Iphone alloc] initWithStyle:UITableViewCellStyleDefault  reuseIdentifier:CellIdentifier];
}

//Image Static URL
NSString *imagenURL=@"http://www.principadoasturias.net/2011/pablo/03_php/archivos/iconos/jpg.jpg";

//Assign the title to my cell, using my array already loaded and parsed.

cell.titleCategoryCell.text=[[self.parseResults objectAtIndex:indexPath.row] objectForKey:@"name_category_ads"];

//Asynchronous loading of image

if (!cell.imageCategoryCell.image) {

dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT,0), ^{

NSData *data =[NSData dataWithContentsOfURL:[NSURL URLWithString:imagenURL]];

dispatch_sync(dispatch_get_main_queue(), ^{
        UIImage *thumbnail = [UIImage imageWithData:data];
        cell.imageCategoryCell.image=thumbnail;
        [self.tableView beginUpdates];
        [self.tableView reloadRowsAtIndexPaths:[NSArray arrayWithObjects:indexPath, nil] withRowAnimation:UITableViewRowAnimationNone];
        [self.tableView endUpdates];
    });
});
}

return cell;
} 
```

解决问题，包括：

该代码正确加载了图像，因此 asicronica，但是 URL 中的单个图像，但我不能让它加载我的数组中的图像。

//我的数组图像

```
[[self.parseResults objectAtIndex: indexPath.row] objectForKey: @ "image1_category_ads"]; 
```

你能帮助我吗？然后把代码分享给大家。非常感谢

问候里卡多

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T19:02:22.610

当您使用[AFNetworking 库](https://github.com/AFNetworking/AFNetworking)时，有一个非常好的实现。它是 UIImageView 的扩展，它为您处理异步加载。您只需要设置 URL，这是一个 1-liner。看看[`UIImageView+AFNetworking`GitHub](https://github.com/AFNetworking/AFNetworking/blob/master/UIKit%2BAFNetworking/UIImageView%2BAFNetworking.h)。

如果你不想使用 AFNetworking 库，你可能想[看看这个示例](http://www.cocoanetics.com/2011/05/a-quick-lazy-loading-uiimageview/)。它是非常基本的并且做同样的事情，但只是一个简单的类。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-12T11:24:36.177

这是您需要的：

[https://github.com/toptierlabs/ImageCacheResize](https://github.com/toptierlabs/ImageCacheResize)。

它从 URL 获取、缓存、加载远程图像。还支持转换。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-07T03:14:50.253

设法解决问题。我所做的是验证并消除图像数组、空白和换行符，它工作得很好。问候里卡多

# javascript - 防止垂直自动滚动中的“跳跃”和循环垂直自动滚动

> ID：13256888
> 
> 赞同：0
> 
> 时间：2012-11-06T18:16:02.000
> 
> 标签：javascript, css

我的垂直自动滚动似乎在某些时候不规律地停止，我想要一个平滑的滚动。其次，我希望垂直滚动自动重置（几乎无限循环或暗示它永无止境，而不仅仅是跳跃）。我将如何实现这一目标？到目前为止，这是我的代码：http: [//jsfiddle.net/8KjX8/78/](http://jsfiddle.net/8KjX8/78/)。

**HTML**

```
<div id="wrapper">
<ul>
    <li><div id='activity_date'>06/11/2012</div></li>
    <li><div id='activity_date'>06/11/2012</div></li>
    <li><div id='activity_date'>06/11/2012</div></li>
    <li><div id='activity_date'>06/11/2012</div></li>
    <li><div id='activity_date'>06/11/2012</div></li>
    <li><div id='activity_date'>06/11/2012</div></li>
</ul>
</div> 
```

**CSS**

```
#activity_date {
    background-color: #cc0066;
    color: #FFF;
    width: 80px;
}
#wrapper {
    height: 240px;
    overflow: hidden;
}
#wrapper ul {
    position: relative;
    list-style-type: none;
}
#wrapper li {
    height: 30px;
    line-height: 12px;
    list-style-type: none;
}
​​ 
```

**JS**

```
(function(){
    var i = 0;

    function Scroll() {
        i++;

        if (i < $('li').length) { // scroll down till we are at the last item
            $('ul').animate({top:'-=30'+'px'}, 1000);
        }
    }

    $(document).ready(function() {
        var timeOut;

        $('ul').hover(
            function(e) { // on hover in, stop the animation
                clearTimeout(timeOut);
            }, 
            function(e) { // on hover out, continue
                timeOut = setInterval(Scroll, 1000);
            }
        );

        timeOut = setInterval(Scroll, 1000); // start the animation at document load

    });

})();
​ 
```

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T19:09:16.140

动画的速度会自动变化。这称为“缓动”，动画的两个标准选项是摆动和线性。Swing 是默认设置，会导致外观先快后慢。通过在动画中指定线性，你应该摆脱这个问题：

```
$('ul').animate({top:'-=30'+'px'}, 1000, 'linear'); 
```

无限循环要复杂得多。你要做的就是把你所有的内容放在一系列绝对定位的容器中，然后让它们中的每一个都向上移动，并设置一个检测功能来告诉容器何时完全离开了视野，然后继续将其设置到列表的末尾。

# c# - 返回一个对象

> ID：13256892
> 
> 赞同：0
> 
> 时间：2012-11-06T18:16:09.160
> 
> 标签：c#, c#-4.0

我突然卡住了。我定义了一个对象：

```
public class AddResult
{
   public AddResult(string id, bool success)
   {
      this.ID = id;
      this.Success = success;
   }

   public string ID { get; set; } 
   public bool Success { get; set; } 
   public string ErrorMessage { get; set; } 
} 
```

我想用另一种方法返回这个对象。

```
public AddResult Load(string userName, string password)
{
    // validate
    if(userName = "")
      {
           AddResult.ErrorMessage = "wrong";
           AddResult.ID = "";
      }
    // want to return object AddResult
 } 
```

智能感知不适用于 AddResult.ID 等，我知道有问题但需要您的建议。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:23:35.923

你需要实例化一个类的对象`AddResult`，你的代码应该是这样的：

```
var addResult = new AddResult("", false) { ErrorMessage = "wrong" };
return addResult; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:29:44.707

您可以使用

```
AddResult.ID = ""; 
```

但在这种情况下，*ID*必须是[静态的](http://msdn.microsoft.com/en-us/library/79b3xss3%28v=vs.110%29.aspx)

此外，您可以创建*AddResult*类的对象：

```
AddResult addResult = new AddResult(); 
```

并从*addResult*对象访问*ID ，如下所示：*

 *```
addResult.ID = ""; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:32:51.297

尝试这个，

```
 public AddResult Load(string userName, string password)
    {
        AddResult addResult = null;
        // validate
        if (userName == "")
        {
            addResult = new AddResult("", false) { ErrorMessage = "wrong" };
        }
        // want to return object AddResult

        return addResult;
    } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-06T18:33:04.490

您应该将 ID 定义为 static ：

```
public static string ID { get; set; } 
```

并以这种方式使用它：

```
AddResult.ID = 40; 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-07T11:59:47.200

```
var addResult = new AddResult("", false) { ErrorMessage = "wrong" };
return addResult as AddResult; 
```*

# php - 填充两个不同的表

> ID：13256895
> 
> 赞同：-1
> 
> 时间：2012-11-06T18:16:17.000
> 
> 标签：php, javascript, ajax

我需要在更改两个不同的选择器时填充两个不同的表，每个表都应该指向相应的表。我尝试了不同的东西，但我认为我找错了方向。任何的想法？有什么提示吗？

```
<html>
<head>
<script>

function showUser(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
}
</script>

</head>

<body>

<form>
<select name="users" onchange="showUser(this.value)">
<option value="">Select a person:</option>
<option value="1">Peter Griffin</option>
<option value="2">Lois Griffin</option>
<option value="3">Glenn Quagmire</option>
<option value="4">Joseph Swanson</option>
</select>
</form>
<br />
<div id="txtHint"><b>Person info will be listed here.</b></div>

<form>
<select name="users" onchange="showUser(this.value)">
<option value="">Select a person:</option>
<option value="1">Peter Griffin</option>
<option value="2">Lois Griffin</option>
<option value="3">Glenn Quagmire</option>
<option value="4">Joseph Swanson</option>
</select>
</form>
<br />
<div id="txtHint2"><b>Person info will be listed here.</b></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:25:21.830

您可以向函数添加第二个参数，如下所示：

```
function showUser(str, hintId) { /* ... */} 
```

添加传递当前提示 div 的元素 id，如下所示：

```
<select name="users" onchange="showUser(this.value, 'txtHint')">
...
<select name="users" onchange="showUser(this.value, 'txtHint2')"> 
```

然后，在您使用该参数时，在代码中的任何位置`getElementById`使用该`hintId`参数。

```
document.getElementById(hintId).innerHTML=""; 
```

# unit-testing - Grails：单元测试域类约束给出错误的结果

> ID：13256897
> 
> 赞同：0
> 
> 时间：2012-11-06T18:16:30.673
> 
> 标签：unit-testing, grails, junit, grails-2.0

我正在尝试为我的域类编写单元测试来测试约束，但我得到了意想不到的结果。这是我的域类：

```
class Student {
    String firstName
    String lastName

    static constraints = {
        firstName blank:false,minSize:2,maxSize:20,validator: { val, obj ->
                      def similarUser = Student.findByFirstNameIlikeAndLastNameIlike(obj.firstName, obj.lastName)
                      if(!similarUser || obj.id == similarUser.id){
                      return ['Student.invalid.unique.message']
                      }
                    }
        lastName blank:false, minSize:2,maxSize:20
    }

} 
```

这是我的单元测试：

```
@TestFor(Student)
@Mock(Student)
class StudentTests {
    def st

    @Before
    void setUp(){       
        mockForConstraintsTests(Student)        
        st=new Student(firstName:"FerasO",lastName:"Ahmad")     

    }

    @Test
    void testMinSize() {                
        assertTrue student.validate() // I guess this should return true but It returns false

    }

} 
```

这有什么问题？我该如何解决？

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T18:58:19.163

我做错了这段代码：

```
if(!similarUser || obj.id == similarUser.id) 
```

应该 `if(similarUser && obj.id == similarUser.id)`

# django - Django如何将十进制对象传递给json

> ID：13256909
> 
> 赞同：8
> 
> 时间：2012-11-06T18:17:06.617
> 
> 标签：django, json

我有一个包含十进制对象的查询集。我想按照以下方式将此数据传递给 json 转储：

```
ql = Product.objects.values_list('length', 'width').get(id=product_id)
data = simplejson.dumps(ql)

TypeError: Decimal('62.20') is not JSON serializable 
```

我应该如何将这些值传递给 json. 当然，我可以将值转换为字符串 - 但我猜这不是一个好的解决方案。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-06T19:19:01.573

Django 已经包含了一个可以处理小数和日期时间的编码器：`django.core.serializers.json.DjangoJSONEncoder`. 只需将其作为`cls`参数传递：

```
data = simplejson.dumps(ql, cls=DjangoJSONEncoder) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:42:10.730

这是我在这个问题上找到的答案：[Python JSON serialize a Decimal object](https://stackoverflow.com/questions/1960516/python-json-serialize-a-decimal-object)

> 继承 json.JSONEncoder 怎么样？
> 
> ```
> class DecimalEncoder(simplejson.JSONEncoder):
>     def _iterencode(self, o, markers=None):
>         if isinstance(o, decimal.Decimal):
>             # wanted a simple yield str(o) in the next line,
>             # but that would mean a yield on the line with super(...),
>             # which wouldn't work (see my comment below), so...
>             return (str(o) for o in [o])
>         return super(DecimalEncoder, self)._iterencode(o, markers) 
> ```

* * *

在你的情况下，你会像这样使用它：

```
data = simplejson.dumps(ql, cls=DecimalEncoder) 
```

# algorithm - 并行最小生成树算法

> ID：13256910
> 
> 赞同：9
> 
> 时间：2012-11-06T18:17:10.280
> 
> 标签：algorithm, parallel-processing, graph-algorithm

我知道一些最小生成树算法：Boruvka、Prim 和 Kruskal。其中哪些可以并行实现？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T19:08:34.240

在这 3 种算法中，只有 Boruvka 算法可能很容易并行化。

引自[algoritmy.net 上 Boruvka 算法的描述](http://en.algoritmy.net/article/43803/Boruvkas-algorithm)：

> Borůvka 算法的一个显着优势是可以很容易地并行化，因为为每个组件选择最便宜的输出边缘完全独立于其他组件所做的选择。

# json - MongoDB 文档：空值或完全省略对？

> ID：13256912
> 
> 赞同：3
> 
> 时间：2012-11-06T18:17:12.557
> 
> 标签：json, mongodb

我第一次在项目中使用 MongoDB，我不太确定文档中空白/未设置值的推荐方法是什么。当您拥有未来可能具有值的对时，这两种方法中的哪一种更合适：

**1) 描述字段为空字符串的 JSON（将来会填充）：**

```
{
    "username": "jamies",
    "shortName": "camping",
    "setName": "Camping on Stevens",
    "description": ""
} 
```

**2）或者，省略描述字段的JSON（将来会添加）：**

```
{
    "username": "jamies",
    "shortName": "camping",
    "setName": "Camping on Stevens"
} 
```

显然，第二种方法会节省磁盘空间，但也不会指示哪些值为空。我很想了解 Mongo 开发人员/DBA 推荐/规定的方法，以及在查询或更新期间是否对该方法有任何考虑。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T19:28:53.597

有疑问时

> 从简洁开始。根据测试要求增加其他尺寸。[杰夫阿特伍德](https://stackoverflow.com/users/1/jeff-atwood)

上面的引用是指代码，但它也适用于这里。我可以想到一些您将来会后悔添加空字符串字段的情况。例如。弃用该领域，它不再使用，使人们感到困惑，并且只是占用空间。另外，请参阅[MongoDB 文档：查询和空值](http://www.mongodb.org/display/DOCS/Querying+and+nulls)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:47:41.903

一种方法是忽略不适用于相关文档/聚合的字段。像 MongoDB 这样的文档数据库没有模式，并且本机支持这一点。然后，您可以使用[**$exists**](http://docs.mongodb.org/manual/reference/operator/exists/)查询运算符。但是，如果您的用例对依赖于存在的查询很重，那么它[是非性能的，并且提到了替代设计](https://stackoverflow.com/questions/9009987/improve-querying-fields-exist-in-mongodb)。

另一种方法是使用**null**来表示没有值。我认为建议使用 null 而不是添加元素并提供空字符串作为值。这里讨论的有点类似[XML，这是什么：null 或空元素？](https://stackoverflow.com/questions/7238254/xml-what-is-this-null-or-empty-element)

# facebook - 在 Facebook 页面选项卡中隐藏垂直滚动条（新）

> ID：13256913
> 
> 赞同：1
> 
> 时间：2012-11-06T18:17:13.897
> 
> 标签：facebook

当宽度设置为 810px 时，是否可以删除 facebook 页面选项卡中的垂直滚动条。

请注意，当宽度设置为正常（810 像素）时，我在**Facebook 页面选项卡**中谈论 iframe 。后端没有高度选项。

我搜索了很多，但每个人都在谈论宽度为 520 像素的旧 Facebook 页面标签。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-04T18:19:22.337

我使用这个功能：

```
FB.Canvas.setSize({ width: 810, height: 1050 }); 
```

作为这个完整设置的一部分，它紧跟在开始标签之后：

```
<div id="fb-root"></div>
<script>
    window.fbAsyncInit = function() {
        // init the FB JS SDK
        FB.init({appId:YOUR_APP_ID_HERE,status:true,cookie:true,xfbml:false});
        FB.Canvas.setSize({ width: 810, height: 1050 });
    };
    (function(d, debug){
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all" + (debug ? "/debug" : "") + ".js";
        ref.parentNode.insertBefore(js, ref);
    }(document, /*debug*/ false));
</script> 
```

接下来，确保没有任何 CSS 将 html 元素上的 overflow-y 属性设置为“滚动”。我已经看到设置此属性的 CSS 重置。

# python - Pandas：在 DataFrame 中创建聚合列

> ID：13256917
> 
> 赞同：32
> 
> 时间：2012-11-06T18:17:32.320
> 
> 标签：python, pandas

以下面的 DataFrame 为例，

```
In [83]:
df = pd.DataFrame({'A':[1,1,2,2],'B':[1,2,1,2],'values':np.arange(10,30,5)})
df
Out[83]:
   A  B  values
0  1  1      10
1  1  2      15
2  2  1      20
3  2  2      25 
```

生成一个新列的简单方法是什么，该列包含其中一个列上的一些数据聚合？

例如，如果我总结`values`项目`A`

```
In [84]:
df.groupby('A').sum()['values']
Out[84]:
A
1    25
2    45
Name: values 
```

我怎样才能得到

```
 A  B  values  sum_values_A
0  1  1      10            25
1  1  2      15            25
2  2  1      20            45
3  2  2      25            45 
```

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-11-06T19:07:38.437

```
In [20]: df = pd.DataFrame({'A':[1,1,2,2],'B':[1,2,1,2],'values':np.arange(10,30,5)})

In [21]: df
Out[21]:
   A  B  values
0  1  1      10
1  1  2      15
2  2  1      20
3  2  2      25

In [22]: df['sum_values_A'] = df.groupby('A')['values'].transform(np.sum)

In [23]: df
Out[23]:
   A  B  values  sum_values_A
0  1  1      10            25
1  1  2      15            25
2  2  1      20            45
3  2  2      25            45 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-06T18:36:37.493

我找到了一种使用方法`join`：

```
In [101]:
aggregated = df.groupby('A').sum()['values']
aggregated.name = 'sum_values_A'
df.join(aggregated,on='A')

Out[101]:
   A  B  values  sum_values_A
0  1  1      10            25
1  1  2      15            25
2  2  1      20            45
3  2  2      25            45 
```

有人有更简单的方法吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-06T18:49:45.777

这不是那么直接，但我发现它非常直观（使用 map 从另一列创建新列）并且可以应用于许多其他情况：

```
gb = df.groupby('A').sum()['values']

def getvalue(x):
    return gb[x]

df['sum'] = df['A'].map(getvalue)
df 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-06T21:26:44.970

```
In [15]: def sum_col(df, col, new_col):
   ....:     df[new_col] = df[col].sum()
   ....:     return df

In [16]: df.groupby("A").apply(sum_col, 'values', 'sum_values_A')
Out[16]: 
   A  B  values  sum_values_A
0  1  1      10            25
1  1  2      15            25
2  2  1      20            45
3  2  2      25            45 
```

# java - Java NullPointerException 存储多个字符串时

> ID：13256921
> 
> 赞同：1
> 
> 时间：2012-11-06T18:17:50.493
> 
> 标签：java

我正在编写一个程序，我迫切需要一些帮助。

我有一个类需要同时跟踪多个对象。

我试着这样做：

```
public class tracker {
   private String[] Name;
   private int NameCounter;

   public void getName(String name) {
      Name[NameCounter] = name;
      NameCounter = NameCounter + 1;
   }
   public static void main(String[] args) {
      getName("Name1");
      getName("Name2");

      System.out.println(Name[1] + " " + Name[2])
   }
} 
```

我收到一条错误消息，提示我有 NullPointerException。我该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-06T18:18:39.830

`Name`为空，因为您没有实例化数组。

你可以做

```
private String[] Name = new String[2]; 
```

但由于数组具有固定长度，如果您认为可能需要更多名称，我建议您在此处使用 ArrayList：

```
public class tracker {
   private ArrayList<String> names = new ArrayList<String>(); // please follow naming conventions

   public void addName(String name) { // getName is a baaad name for a method that changes a variable
      names.add(name);
   }
   public static void main(String[] args) { // main, not mian
      addName("Name1");
      addName("Name2");
      System.out.println(names.get(0) + " " + names.get(1)) // the second one is at index 1, not 0
   }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:31:48.943

虽然它与您的问题无关，但我正在发布它。按照 Java 标准，方法 getName 宁可命名为 setName，以便方法名称能够传达正确的目的。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:19:30.490

这应该执行

```
public class tracker {
    private String[] Name = new String[2];
    private int NameCounter;

    public void getName(String name) {
        Name[NameCounter] = name;
        NameCounter = NameCounter + 1;
    }

    public static void main(String[] args) {
        tracker t = new tracker();
        t.getName("Name1");
        t.getName("Name2");

        System.out.println(t.Name[0] + " " + t.Name[1]);
    }
} 
```

# scrum - 不完整的用户故事和燃尽图

> ID：13256928
> 
> 赞同：2
> 
> 时间：2012-11-06T18:18:17.337
> 
> 标签：scrum

我有一个关于 Scrum 和用户故事的快速问题。

我正在为大学做一个小项目，我决定使用 Scrum 和用户故事来解决这个功能，我知道 Scrum 通常是由一组团队成员完成的，但就我而言，我是与项目主管单独完成的。

我了解用户故事的内容以及指向和优先级系统，例如（必须、应该、可以、不会）

现在，当我即将结束迭代时，可以说大约一半的用户故事已经完成。

我的用户故事的一个例子是：

“用户需要能够记录设备”

我为这个用户故事创建了一些子任务，除了 1 个子任务之外，我已经完成了所有子任务，并且我已经完成了迭代。我给这个用户故事打了第 8 点。

*   现在我不确定我是否可以将此用户故事包含在燃尽图中，或者我是否要等到子任务完成后再添加到图表中。

*   我还想问我是否可以根据我在用户故事中完成的任务的多少来建立我的燃尽图，或者始终基于完全完成的用户故事的数量，包括测试等。

    提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-07T01:57:17.793

有两种传统的燃尽图（Scrum 本身都不需要）：Sprint 燃尽图和发布燃尽图。

> 现在我不确定我是否可以将此用户故事包含在燃尽图中，或者我是否要等到子任务完成后再添加到图表中。由你决定。发布燃尽图的目的是了解剩余的内容。该功能无法发布，因此请务必非常清楚。如果这种情况持续发生，请找出原因。

速度，你已经能够完全完成的经验量，它可以帮助你知道你应该为下一个 sprint 预测什么。这个冲刺只完成了部分，所以经验主义告诉你不要再预测那么多的工作。

> 我还想问我是否可以根据我在用户故事中完成的任务的多少来建立我的燃尽图，或者总是基于有多少用户故事完全完成，包括测试等。 团队传统上总结剩余的 Sprint 燃尽图任务或任务时间旨在帮助您了解是否需要重新协商 Sprint 预测（向上或向下）。

我不建议尝试在 sprint 之外烧毁任务。要在发布级别燃尽任务并了解剩余的内容，您必须估计很多细粒度的细节。你解决问题的方式会改变你目前的信念，以及需要多长时间才会改变。毫无疑问，你现在也不会做你认为你会做的所有事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-17T03:20:49.403

一些技巧：

燃尽图表示在任何一天的 sprint 中剩余的估计工作小时数，因此不包括 sprint 之外的任何内容。通常情况下，故事以点数估算，这反映了团队成员（在本例中为您）对该故事所付出的努力和风险。当一个故事被分解为任务时，这些任务通常以小时为单位进行估算——最佳实践是一个任务应该不超过一天或直到你的下一次每日 Scrum 的时间。

我认为您问题中的一个潜在问题可能是“我是否可以计算冲刺结束时完成的故事部分？”。可悲的是，答案是“不”。使用 Scrum 的最佳方式是对完成一个故事采取非黑即白的态度——要么完全“完成”，要么完全“完成”。没有中间立场。完成对团队的意义取决于他们，只要它是预先定义的，而不是一个移动的目标。就我而言，我们使用的规则是，如果它的“可交付质量”以 QA 成员作为裁判，则它已完成。

如果一个故事无法交付，无论它完成了 50% 还是 99%，它都会失败。没有部分功劳。如果发生这种情况，故事会以分数为单位重新估计，放回待办事项列表中，产品负责人就有机会查看她/他是否想为下一个 sprint 重新拾起它。这也是重新评估故事估计的好时机 - 一个 8pt 的故事对于一个正常规模的团队来说很大，对于一个 1 人的团队来说，它太大了 IMO。理想情况下，团队的目标故事大小应该在 2-5 点左右。最后，如果你无法完成 8pt 的故事，这表明你的速度太高了，你需要在下一个 sprint 中做更少的分数。

# java - Thrift 是否有 Java 的异步服务器端方法定义？

> ID：13256935
> 
> 赞同：6
> 
> 时间：2012-11-06T18:18:50.500
> 
> 标签：java, asynchronous, thrift

我可以在 Java 中连接一个 HsHaServer 和 Async 客户端，并让它顺利运行。问题是似乎没有真正异步服务的异步接口。服务接口类似于

公共 TSomeReposonse doStuff(TSomeParams 参数);

这需要我阻止 doStuff 内部，直到我准备好返回 TSomeResponse

有一个 Async.Iface

公共无效doStuff（TSomeParams参数，AsyncMethodCallback[AsyncClient.doStuff_call]）；

但看起来这只适用于客户端。似乎没有办法将值传递给回调。我是对的吗？如果我想要真正的服务器端异步，是否需要使用 netty 之类的东西来实现我自己的客户端/服务器？

谢谢，安德鲁

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-06-26T08:30:58.243

这个问题已经很老了（可能有一个徽章），但以防万一这与某人有关，答案是肯定的。它被称为异步处理 - 见这里： [https ://issues.apache.org/jira/browse/THRIFT-1972](https://issues.apache.org/jira/browse/THRIFT-1972)

它使用与异步客户端相同的接口。

但是，关于这方面的文档几乎是荒谬的。

# javascript - 无法从 https iframe 调用 http 父级中的 javascript

> ID：13256936
> 
> 赞同：0
> 
> 时间：2012-11-06T18:18:51.823
> 
> 标签：javascript, iframe, https

我们有一个加载了 http 的页面，它加载了一个带有 https 的 iframe。这两个页面在同一个域上，除了协议。

（我知道拥有 https iframe 是一种不好的做法。我无能为力。）

当 iframe 中的 Javascript 尝试调用父级中的 javascript 函数时，它会失败并显示以下内容：

```
Unsafe JavaScript attempt to access frame with URL http://www.foo.com/homepage/ from frame with URL https://www.foo.com/homepage/en/loginModal.html. Domains, protocols and ports must match. 
```

有什么办法可以修改它来工作吗？是否有可能使用“Access-Control-Allow-Origin”标头来做到这一点？

如果我们更改主页的 jsp 以设置响应标头，例如：

```
Access-Control-Allow-Origin: https://www.foo.com 
```

那会奏效吗？

# android - 将apk文件上传到markt时出错

> ID：13256941
> 
> 赞同：2
> 
> 时间：2012-11-06T18:19:44.657
> 
> 标签：android, apk

尝试上传我的 android 应用程序的新 apk 版本时出现以下错误？任何想法请：

您的 apk (Psychoanalysis.Quiz) 的包名无效。包名必须以字符开头，并且只能包含字符、数字、下划线和点。它们必须至少有一个点，不能以点结尾，并且不能包含超过一个连续点的任何运行。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T18:21:33.900

按照惯例，包名称反映了您的反向域名，例如：com.mydomain.psychquiz。这是为了让它们在全球范围内独一无二。也就是说，包名应该以小写字母开头。

[这里](http://docs.oracle.com/javase/tutorial/java/package/namingpkgs.html)有更多信息。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-09T13:30:57.663

您必须使用新设计。

该按钮位于右上角。

# sed - sed中的条件分支

> ID：13256944
> 
> 赞同：0
> 
> 时间：2012-11-06T18:20:10.090
> 
> 标签：sed

我有一个定义明确的问题，似乎是 sed 的一个很好的候选者。

我的输入文件包含两个标记之一：

`[FILE]`或者`[LINE]`

结构如下所示：

```
[FILE]: C:\Users\user\git\build.xml
[FILE]: C:\Users\user\git\dataload-pom.xml
[FILE]: C:\Users\user\git\local.properties
    [LINE]:  [job.mail.toAddress=]
    [LINE]:  [log.mail.toAddress=]
    [LINE]:  [log.mail.client.toAddress=]
    [LINE]:  [log.mail.toAddress=]
    [LINE]:  [bill.report.toAddress=]
[FILE]: C:\Users\user\git\pom.xml
[FILE]: C:\Users\user\git\release.properties
    [LINE]:  [job.mail.toAddress=]
    [LINE]:  [log.mail.client.toAddress=] 
```

预期的输出将是：

```
[FILE]: C:\Users\user\git\local.properties
    [LINE]:  [job.mail.toAddress=]
    [LINE]:  [log.mail.toAddress=]
    [LINE]:  [log.mail.client.toAddress=]
    [LINE]:  [log.mail.toAddress=]
    [LINE]:  [bill.report.toAddress=]
[FILE]: C:\Users\user\git\release.properties
    [LINE]:  [job.mail.toAddress=]
    [LINE]:  [log.mail.client.toAddress=] 
```

如果文件名有与之关联的行，我只想查看它们。我是 sed 的新手，希望完全了解您的工作。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T19:20:01.573

这可能对您有用（GNU sed）：

```
sed '$!N;/^\(\[FILE\]\).*\n\1/!P;D' file 
```

删除`[FILE]`保留最后一行的多行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-06T19:53:41.090

这是另一个变体：

```
sed '/LINE/{H;x;:r;n;/LINE/br;x;d};h;d' 
```

它一直保留最后一行，当它看到'LINE时，它显示最后一行，然后显示所有包含'LINE的后续行，并且该过程如此递归地重复。

它适用于任何可能的 sed。

# php - MySQL 子查询返回多个结果

> ID：13256947
> 
> 赞同：0
> 
> 时间：2012-11-06T18:20:12.710
> 
> 标签：php, mysql, calendar, pdo

即使**MySQL 子查询**返回多个结果，是否有人想出一种方法使此代码有效？当用户没有与他相关的事件，或者当用户有一个与他相关的事件，但是当**用户与多个**事件相关时，它工作正常，子查询返回多个结果并且代码什么也得不到跟...共事。

```
$stmt = $db->prepare("SELECT * FROM events WHERE
                  id_events = ( SELECT id_events FROM relationship_events WHERE id_user = ?)");
$stmt->bindParam(1, $idUser);
$stmt->execute();

$rawTimeStamps = $stmt->fetchAll(PDO::FETCH_ASSOC);
$cleanDateArray = array();

foreach ($rawTimeStamps as $t) {
$rawDate = $t['start'];
$rawDate = getdate($rawDate);
$cleanDate = mktime(0,0,0,$rawDate['mon'],$rawDate['mday'],$rawDate['year']);
$cleanDateArray[] = $cleanDate;
}

for($list_day = 1; $list_day <= $days_in_month; $list_day++):

$calendar.= '<td class="calendar-day">';
    $timestamp = mktime(0,0,0,$month,$list_day,$year);
    if (!empty($cleanDateArray) && in_array($timestamp, $cleanDateArray)) {

    $date = getdate($timestamp);
    $time_start = mktime(0,0,0,$date['mon'],$date['mday'],$date['year']);
    $time_end = mktime(23,59,59,$date['mon'],$date['mday'],$date['year']);
    $stmt = $db->prepare('SELECT title FROM events WHERE start BETWEEN ? AND ?');
    $stmt->bindParam(1,$time_start,PDO::PARAM_INT);
    $stmt->bindParam(2,$time_end,PDO::PARAM_INT);
    $stmt->execute();
    $events = $stmt->fetch(PDO::FETCH_ASSOC);

    $calendar.= '<div class="day-number day-number-event"><a href="#">'.$list_day.'</a></div><p>'.$events["title"].'</p>';
    } else {
    $calendar.= '<div class="day-number day-number-noevent">'.$list_day.'</div><div id="calendar-events"></div>';
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:33:08.160

查询应该是`SELECT * FROM events WHERE id_events IN ( SELECT id_events FROM relationship_events WHERE id_user = ?)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:30:26.250

有两种可能的答案，具体取决于您希望它如何工作。

如果您只想要一个事件，无论用户是否有 1 个或多个事件，您都可以`LIMIT 1`在子查询中添加：

```
SELECT * FROM events
WHERE id_events = (
    SELECT id_events FROM relationship_events WHERE id_user = ? LIMIT 1
) 
```

另一方面，如果您希望*将所有*事件分配给用户，您可以使用一个`IN`子句：

```
SELECT * FROM events
WHERE id_events IN (
    SELECT id_events FROM relationship_events WHERE id_user = ?
) 
```

如果用户没有分配到任何事件，这两种方法也应该可以正常工作。

# c - gdb 就像打印指向结构的指针

> ID：13256948
> 
> 赞同：0
> 
> 时间：2012-11-06T18:20:13.487
> 
> 标签：c, linux, systems-programming

我需要一种方法来获得类似 gdb 的输出，以获取指向显示所有字段及其地址和相应值的结构的指针。有没有一种干净的方法来做到这一点，而不是逐个成员地打印它。我不能使用任何其他外部工具，如 pstruct 或 libgdb。我想在我们的 C 程序中完成它。我的系统上确实有 gdb 并且可以使用它。谢谢你的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:30:01.353

您的选择是：

a) 从二进制文件中读取调试符号并以与 GDB 相同的方式解释它们以确定结构成员是什么，并将该信息传递给通用打印例程。

b) 手动或使用自定义构建阶段将有关结构的元数据编译到 C 程序中。

c) 逐个打印成员。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:52:12.380

如果您可以链接到第 3 方库并使用适当的调试符号构建您的应用程序（gdb 在这方面非常灵活，但您可能会受到其他方式的限制），您可以尝试从调试符号中提取您需要的信息。

[libdwarf](http://reality.sgiweb.org/davea/dwarf.html)可能会帮助你。

[dwarf](http://dwarfstd.org/) （和 stabs/stabs+）的规格在网上都有，但从头开始需要做很多工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T18:29:18.013

你可以写一个函数来做到这一点？

```
void printStructPtr( struct name *p)
{
printf("{ ");

//print all members one by one separated by commas
printf("...", p->member1);
printf("...", p->member2);
printf("}");

} 
```

如果你希望它是通用的，那么传递一个接收一个 void 指针并适当地转换它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-07T07:06:31.813

您也许可以自定义 GCC 编译器（例如，使用[MELT](http://gcc-melt.org/)域特定语言来扩展 GCC）以添加一些新的，这些新`__attribute__`的将从类型（可能已注释）生成打印代码。但是这样的方法需要几天的工作，我一般不会推荐它，除非你有一个非常大的程序要处理。

请注意，您的问题比您最初想的要复杂：`struct`可能必须打印和跟踪 a 中的指针（或者如果仅用于管理，则可以省略）。复杂的数据结构具有*共享组件*，因此您需要管理已访问的数据集。另请注意，打印`union`-s 通常是不可能的，除非您有一些鉴别器（以及关于它的约定，它们在*C*声明之外）。

我宁愿使用（或开发）一个工具，它接受您的数据结构的描述（带有附加注释）并为其输出打印例程，以及您的数据的 C 声明。

顺便说一句，您的问题与[序列化有关](http://en.wikipedia.org/wiki/Serialization)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-06T18:25:40.360

如果所有结构成员都*相同*，则可以增加指向第一个成员的指针以访问结构的其他成员，尽管这通常*不是一个好主意*，因为有时会填充结构。例如：

```
struct my_struct{
    int a;
    int b;
    int c;
};

struct my_struct t = {1, 2, 3};
int *p = &t.a;
for (i=0; i<sizeof(t)/sizeof(int); i++, p++) {
    printf("%d\n", *p);
} 
```

# apache - 如何指向 Amazon EC2 实例的本地主机？

> ID：13256952
> 
> 赞同：3
> 
> 时间：2012-11-06T18:20:27.910
> 
> 标签：apache, amazon-ec2, ubuntu-12.04

我有一个 Amazon 的 EC2 实例启动并运行 Ubuntu 12.04，我已经安装了 LAMP。Apache 正在运行，但我如何才能真正从浏览器指向默认的文档根目录。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-06T18:52:09.587

将您的实例的公共 IP 地址放在浏览器上，如果这是您要问的。这将打开托管在您的 ec2 实例上的服务器的默认 Web 根页面。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T18:23:47.773

如果您的意思是使用标准浏览器和 Internet 连接远程访问实例的 localhost 界面，则不能。

# visual-studio - 我可以在多显示器配置上使用 Visual Studio 2012 吗？

> ID：13256953
> 
> 赞同：12
> 
> 时间：2012-11-06T18:20:28.353
> 
> 标签：visual-studio, visual-studio-2012

我正在尝试决定购买哪些显示器。无论如何我都会买 3 台显示器，但我不确定我应该是 23-24 英寸还是 27 英寸。

问题是——我是否可以在 2 台甚至 3 台显示器上使用 VS 2012？有多舒服？我可以使用“中心”显示器进行“编码”，使用左和/或右显示器进行其他所有操作吗？这种设置有多舒适，是否可能？

理想情况下，我希望看到这种设置的“照片”或视频。

到目前为止，我使用的是一台 27 英寸的显示器，我对此非常满意。我正在考虑切换到 3* 24 或 3 * 27，因为没有其他程序的空间。但是只有一台 24 英寸的显示器对我来说太小了，所以我想为 VS “花”至少 2 台 24 英寸的显示器。

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2012-11-06T18:23:30.837

**是的！**Visual Studio 2012 具有*出色*的多监视器支持。每个监视器都可以有自己的“筏”，带有多个选项卡、拆分窗口等。只需从主“岛”中抓取一个窗口并将其拖到另一个监视器上以创建一个新的“筏”。我们团队中的每个人都有 3 x 19" 显示器，并且可以根据需要在每台显示器上混合和匹配代码、文档、浏览器等。

下面是我在实际操作中截取的截图： ![Visual Studio 2012 - 多显示器支持](../Images/193a381cacbc8d260aef0d90d0503be0.png) [全分辨率](https://i.stack.imgur.com/lucI0.png)

**有关详细信息：** [Visual Studio 2012 中的新增功能](http://msdn.microsoft.com/en-us/library/vstudio/bb386063.aspx#BKMK_WindowManagement)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:27:05.657

当然，如果你需要它，它是值得的。你有很多空间。谷歌图片 -> 输入“visual studio dual monitor”，有几张图片。您可以以任何方式排列窗户 :)

# zend-framework - Zend_Acl 和重定向\转发

> ID：13256959
> 
> 赞同：0
> 
> 时间：2012-11-06T18:21:08.183
> 
> 标签：zend-framework, zend-acl

是否有任何原因导致此代码在动作助手 preDispatch() 函数或插件 preDispatch() 函数中超时或不起作用？

```
$request =$this->getActionController->getRequest();
$request->setModuleName('default');
$request->setControllerName('auth');
$request->setActionName('login');
$request->setDispatched(false); 
```

我正在尝试实现 Zend_Acl 重定向\转发，以便将访客用户发送到登录提示。一切正常，直到我们到达这个特定的代码片段，然后它超时。我在他的“Zend Frameworks in Action”一书中关注@RobAllens 中关于实现 Zend_Auth 和 Zend_Acl 的示例。问题出在这个代码片段上。我已经在动作助手类和插件类上都尝试过它，但存在相同的超时错误。它在动作方法（）上运行良好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T22:30:37.783

因为您正在设置`setDispatched(false)`，（我认为）将为您的登录方法重新初始化操作助手，因此您的 ACL 检查将再次运行。由于条件将再次失败，ZF 将再次对登录方法进行内部重定向，并且该过程重复（因此无限循环）。最简单的解决方法是添加一个附加条件，这样就不会为登录方法本身运行检查：

```
if (!$this->_acl->isAllowed($role, $resource, $priv) && $request->getActionName() != 'login') {
    [...]
} 
```

如果这不起作用，请查看注释掉 setDispatched 检查是否有任何区别。

# c++ - 在同一个类的另一个成员函数的定义中调用一个类成员函数

> ID：13256962
> 
> 赞同：1
> 
> 时间：2012-11-06T18:21:26.127
> 
> 标签：c++

在同一个类的另一个成员函数的定义中调用一个类的成员函数的方法是什么？

例如：文件：header.h

```
class A
{
public:
void fn1();
void fn2();
}; 
```

现在在 cpp 文件中：function.cpp

方法1：

```
#include"header.h"
void A::fn1()
{
//function body for fn1()

//What is the way to make a call for fn2()?
//assume I have definition of fn2() above similar to fn1()

fn2();
} 
```

方法2：

```
#include"header.h"
A obj_A;
void A::fn1()
{
//function body for fn1()

//What is the way to make a call for fn2()?
//assume I have definition of fn2() above similar to fn1()

obj_A.fn2();
} 
```

请澄清哪种方法是正确的？

谢谢， C++ 初学者。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:24:59.227

两个版本都是正确的，但行为不同。第一个版本将在调用 f1 的同一个实例上调用该函数，而第二个版本将始终在 obj_A 实例上调用 f2。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T18:23:48.573

方法1是正确的。

方法 2 似乎在与您进行调用的实例不同的实例上调用该方法，这是一种不同的行为。在某些情况下，这是您想要的，但您没有表明这是这种情况。

您对第一种方法有疑问吗？

# python - 防止 JSON 序列化在 Python 中抛出异常

> ID：13256963
> 
> 赞同：3
> 
> 时间：2012-11-06T18:21:28.227
> 
> 标签：python, json

**什么是防止python`json`库在遇到不知道如何序列化的对象时抛出异常的好方法？**

我们`json`用于序列化dict对象，有时`json`库无法识别对象的属性，导致它抛出异常。如果它只是跳过 dict 的该属性而不是抛出异常，那就太好了。它可以将属性值设置为“无”甚至是一条消息：“无法序列化”。

现在，我知道如何做到这一点的唯一方法是明确识别并跳过`json`可能遇到的每种数据类型，这将使​​其引发异常。如您所见，我将`datetime`对象转换为字符串，但也跳过了`shapely`库中的一些地理点对象：

```
import json
import datetime
from shapely.geometry.polygon import Polygon
from shapely.geometry.point import Point
from shapely.geometry.linestring import LineString

# This sublcass of json.JSONEncoder takes objects from the
# business layer of the application and encodes them properly
# in JSON.
class Custom_JSONEncoder(json.JSONEncoder):

    # Override the default method of the JSONEncoder class to:
    # - format datetimes using strftime('%Y-%m-%d %I:%M%p')
    # - de-Pickle any Pickled objects
    # - or just forward this call to the superclass if it is not
    #   a special case object
    def default(self, object, **kwargs):
        if isinstance(object, datetime.datetime):
            # Use the appropriate format for datetime
            return object.strftime('%Y-%m-%d %I:%M%p')
        elif isinstance(object, Polygon):
            return {}
        elif isinstance(object, Point):
            return {}
        elif isinstance(object, Point):
            return {}
        elif isinstance(object, LineString):
            return {}

        return super(Custom_JSONEncoder, self).default(object) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:32:25.967

这应该做你想要的。您可以在 catch-all 返回之前添加特殊情况，或自定义回退值。

```
import json
import datetime

class Custom_JSONEncoder(json.JSONEncoder):
    def default(self, obj, **kwargs):
        if isinstance(obj, datetime.datetime):
            # Use the appropriate format for datetime
            return obj.strftime('%Y-%m-%d %I:%M%p')
        return None 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:33:24.047

如果您不想引发 TypeError，则可以省略对 json.JSONEncoder.default() 的调用。 仅对不知道如何序列化`default()`的对象调用。`json`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-07T13:15:48.137

我认为这会很好：

```
class Rectangle(object):
    def to_json(self):
        return {}

class Custom_JSONEncoder(json.JSONEncoder):
    def default(self,  obj, **kwargs):
        if hasattr(obj, 'to_json'):
            return obj.to_json()
        ... 
```

您将需要向其他类添加方法，但对我来说这很好。

# sonarqube - 在声纳中可能只查看对新代码进行的分析吗？

> ID：13256968
> 
> 赞同：1
> 
> 时间：2012-11-06T18:21:39.480
> 
> 标签：sonarqube

我们有一个遗留系统，我们已将其纳入我们的项目并在此基础上进行构建。我不仅对在 Sonar 中分析整个项目感兴趣，而且对仅分析在特定日期之后添加的代码感兴趣。那么声纳是否可以仅在特定日期之后添加的代码上检索静态分析“视图”（覆盖范围、违规、代码行等）？这将非常有帮助！谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-06T20:01:08.693

您可以使用截止插件 ( [http://docs.codehaus.org/display/SONAR/Cutoff+Plugin](http://docs.codehaus.org/display/SONAR/Cutoff+Plugin) )，它允许您根据截止日期阈值（或截止期限）从分析中排除文件。在配置的截止日期之前最后修改的任何源文件都被排除在外。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-06T19:50:53.830

您可以在项目的期间配置中定义具体日期，[这篇文章可以帮助您](http://www.sonarsource.org/differential-services-in-sonar-for-a-complete-support-of-continuous-inspection/)。声纳周期是“**用于比较措施和跟踪新违规行为**的周期”。

# validation - Liferay 中的动态数据列表

> ID：13256970
> 
> 赞同：0
> 
> 时间：2012-11-06T18:21:44.860
> 
> 标签：validation, liferay, liferay-6, dynamic-data-list

我的**动态数据列表**中有文本字段，但应该只有电子邮件 ID。如何为文本字段编写**验证**？？？动态数据列表中只有一个必填字段

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T11:00:00.190

最好的方法是使用 javascript 验证

# jquery - 如何在 body 标签/div 上添加和更改类

> ID：13256980
> 
> 赞同：0
> 
> 时间：2012-11-06T18:22:33.650
> 
> 标签：jquery, html, css

`body`当我单击锚标记时，我想在标签/div 和锚标记上添加一个类。

[这是我的 jsFiddle 文件。](http://jsfiddle.net/4nFUd/)

```
<div id="body">
 <!-- background image here -->

</div>

<ul>
    <li><a href="#">First Option</a></li>
    <li><a href="#">Second Option</a></li>
    <li><a href="#">Third Option</a></li>
</ul>​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:28:12.993

[http://jsfiddle.net/4nFUd/5/](http://jsfiddle.net/4nFUd/5/)

为单击添加事件侦听器并根据需要进行修改...

```
<script>
$('ul').on('click','a',function(){
    $('#body').css('background',$(this).attr('rel'));
    $(this).addClass($(this).attr('rel'));
});
</script>
<div id="body">
 <!-- background image here -->

</div>

<ul>
    <li><a href="#" rel="blue">First Option</a></li>
    <li><a href="#" rel="green">Second Option</a></li>
    <li><a href="#" rel="yellow">Third Option</a></li>
</ul> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:31:16.730

就是这样，广告类到正文并锚定自身 [http://jsfiddle.net/testtracker/4nFUd/2/](http://jsfiddle.net/testtracker/4nFUd/2/)

```
$('ul li a').click(function(){
$('#body').addClass('classname-tobody');
$(this).addClass('classname-toanchor');
});​ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:27:54.697

这应该够了吧。

```
$("li a").click(function(){
  $(this).addClass("class1");
  $("#body").addClass("class2");
}); 
```

# c - SSE 比较内在 - 如何从比较中获得 1 或 0？

> ID：13256983
> 
> 赞同：3
> 
> 时间：2012-11-06T18:22:38.057
> 
> 标签：c, if-statement, comparison, sse, intrinsics

我正在尝试使用 SSE 内在函数编写等效的 if 语句。

我正在使用`__m128 _mm_cmplt_ps(__m128 a, __m128 b)`a < b 进行比较，这将返回`0xffffffff`或者`0x0`比较分别为真或假。我想将这些值转换为 1 和 0。为了做到这一点，实现逻辑 "and" 是否正确，转换的结果在`__m128 _mm_and_ps(__m128 c , __m128 d)`哪里，例如，？`c``d``0xffffffff`

感谢您的关注。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-11-06T18:42:20.147

您正在比较得到 a`1`或 a `0`，然后乘以另一个数字。本质上是这样的：

```
c = (a < b) * d; 
```

这与此相同：

```
c = 0;
if (a < b)
    c = d; 
```

这也称为有条件的移动。

如果这就是你想要的，那么你不需要`0`或`1`。只需将比较的结果直接与您将乘以的数字进行比较。

```
__m128 c = _mm_cmplt_ps(a,b);
c = _mm_and_ps(c,d); 
```

这是有效的，因为比较返回 all`0`或 all `1`。因此，将它们与结果进行与运算会将其归零或完全保留。

它是故意这样设计的。不需要乘法。

# function - C shell如何将多个命令放在一个别名中？

> ID：13256986
> 
> 赞同：2
> 
> 时间：2012-11-06T18:22:45.643
> 
> 标签：function, shell

所以C shell没有我听到的功能，我需要使用别名......假设我有：

```
command1
command2
...
commandN 
```

在我看来，这 N 个命令构成了一个“函数”。有没有办法将它们放入 1 个别名中？

另外，如果我需要将任何参数传递给我的“函数”，我是不是搞砸了？

强制不要责备我的公司使用 c shell。

干杯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-06T18:24:18.917

```
alias whatever "cmd1; cmd2; cmd3" 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-07T18:42:29.803

要让别名做两件事，只需添加一个分号，并确保它被引用。

```
alias func "echo do the thing ; echo do the other thing" 
```

要将参数与别名一起使用，请使用以下表示法。

```
alias funcargs "echo do the first thing \!:1 ; echo do the second thing \!:2" 
```

请注意，这些是零索引的，其中 \!:0 是别名的名称。注意，如果你不提供参数，你会得到一个神秘的错误信息。

这是我需要的小东西：

```
alias venv "python -m venv \!:1 ; source \!:1/bin/activate.csh" 
```

# python - mechanize._response.httperror_seek_wrapper：HTTP 错误 404：未找到

> ID：13256991
> 
> 赞同：6
> 
> 时间：2012-11-06T18:23:00.950
> 
> 标签：python

我正在尝试使用程序 fbruteforcer.py。我编译了它，它似乎可以工作，但根本不行。

以下作品：

```
./wpbruteforcer.py -t www.pillolhacking.net -u admin -w wordlist 
```

但是当我尝试更改目标站点和用户名时，我得到以下回溯：

```
Traceback (most recent call last):
  File "./fbruteforcer.py", line 253, in <module>
    main()
  File "./fbruteforcer.py", line 247, in main
    releaser()
  File "./fbruteforcer.py", line 183, in releaser
    bruteforce(word.replace("\n",""))
  File "./fbruteforcer.py", line 152, in bruteforce
    opensite = br.open(targetsite)
  File "/usr/local/lib/python2.7/dist-packages/mechanize/_mechanize.py", line 203, in open
    return self._mech_open(url, data, timeout=timeout)
  File "/usr/local/lib/python2.7/dist-packages/mechanize/_mechanize.py", line 255, in 
_mech_open
    raise response
mechanize._response.httperror_seek_wrapper: HTTP Error 404: Not Found 
```

我试图寻找解决方案，但我能找到的只有[这篇文章](http://osdir.com/ml/python.wwwsearch.general/2007-06/msg00021.html)。

请有人帮我知道该怎么做。也许我必须下载另一个机械化包？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-27T01:05:11.477

看起来它做的第一件事就是尝试连接到：

```
"http://www."+target+"/wp-login.php" 
```

目标是您输入的内容。

```
http://www.google.com/wp-login.php does not exist, hence the 404 
```

# c# - 如何制作 IsNull() 方法

> ID：13256992
> 
> 赞同：2
> 
> 时间：2012-11-06T18:23:02.567
> 
> 标签：c#, isnull

我正在尝试创建一个类似于 .ToString() 的方法来检查对象是否为空。我刚刚知道如何在不调用类的情况下使其可访问

```
public class ObjectExtensions
{
    public static bool IsNull(object obj)
    {
        bool val = false;
        if (obj == null)
        { val = true; }
        return val;
    }
} 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-06T18:25:16.713

您缺少`this`修饰符以使其成为真正的扩展方法以及使对象成为静态对象。

```
public static class ObjectExtensions
{
    public static bool IsNull(this object obj)
    {
        return obj == null;
    }
} 
```

然后你可以这样称呼它：

```
var fooIsNull = foo.IsNull();
// which is syntactic sugar for
fooIsNull = ObjectExtensions.IsNull(foo); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-06T18:25:03.033

您的类需要是静态的，并且在扩展变量类型之前需要“this”关键字：

```
public static class ObjectExtensions
{
    public static bool IsNull(this object obj)
    {
        bool val = false;
        if (obj == null)
        { val = true; }
        return val;
    }
} 
```

此外，当您进行一次布尔检查时，您可以直接返回它的结果：

```
public static class ObjectExtensions
{
    public static bool IsNull(this object obj)
    {
        return obj == null;
    }
} 
```

[这里是扩展方法](http://msdn.microsoft.com/en-us/library/vstudio/bb383977.aspx)的 MSDN 条目的链接

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-06T18:25:22.440

你认为你需要一个静态方法是正确的。这是避免空值出现空指针异常的唯一方法。您可以使用扩展方法伪造它：

```
public static class ObjectExtensions
{
    public static bool IsNull(this object obj)
    {
        return obj == null;
    }
} 
```

另请注意，您的实现虽然有效，但过于复杂。您只需要一行就可以实现这一点。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-06T18:25:36.557

```
public static class ObjectExtensions
{
    public static bool IsNull(this object obj)
    {
        return obj == null;
    }
} 
```

# android - 在火车时刻表应用程序中合并 2 个 android sqlite 查询

> ID：13256993
> 
> 赞同：2
> 
> 时间：2012-11-06T18:23:08.193
> 
> 标签：android, sqlite

我正在用 sqlite 构建一个用于火车时刻表的 android 应用程序。我的应用程序请求来自用户 2 个火车站，往返时间和日期（我现在忽略日期）。对于那些我一直在尝试进行单个查询以返回给定日期这些站点之间的所有可用时间表。

我的表结构是：

```
stations (_id INTEGER PRIMARY KEY AUTOINCREMENT, 
          name TEXT, 
          central BOOLEAN)

schedule_stations (_id INTEGER PRIMARY KEY AUTOINCREMENT, 
                   arrival TEXT, 
                   departure TEXT, 
                   availability INTEGER, 
                   stationID INTEGER, 
                   FOREIGN KEY(stationID) REFERENCES stations(_id))

schedule (_id INTEGER PRIMARY KEY AUTOINCREMENT, 
          trainID INTEGER, 
          day TEXT, 
          scheduleStationId INTEGER, 
          FOREIGN KEY(scheduleStationId) REFERENCES schedule_stations(_id)) 
```

到目前为止，我已经能够使用给定的 From 站设计 2 个查询：

```
 c1=db.rawQuery(
                "SELECT s2._id, name, departure, trainID " +
                        "FROM schedule_stations s1 INNER JOIN stations s2 " +
                        "ON s1.stationID = s2._id INNER JOIN schedule s3 " +
                        "ON s3.scheduleStationId = s1._id " +
                        "WHERE stationID=? ", 
                        new String[] {station1+""}); 
```

这给了我所有从提供的发件人站 (station1) 出发的信息。

并使用我拥有的 To 站：

```
 c2=db.rawQuery(
                "SELECT s2._id, name, arrival, trainID " +
                        "FROM schedule_stations s1 INNER JOIN stations s2 " +
                        "ON s1.stationID = s2._id INNER JOIN schedule s3 " +
                        "ON s3.scheduleStationId = s1._id " +
                        "WHERE stationID=? AND trainID IN ("+queryPlaceholders(strlist.size()-1)+")", 
                        strlist.toArray(new String[0])); 
```

这为我提供了所有到达所提供的 To 车站的到达站，这些车站的 trainID 出现在第一个查询中（以保证连接）。

如果我单独输出它们看起来正确的游标（注意最后 3 个元素是：站名 | 时间 | trainID）：

```
C1: Row: 0, Values: 1; Station A; 08:00; 1
C1: Row: 1, Values: 1; Station A; 12:00; 2
C2: Row: 0, Values: 2; Station B; 09:00; 1
C2: Row: 1, Values: 2; Station B; 13:00; 2 
```

我想要的是以某种方式将这些合并到一个查询中，所以我最终只有一个光标可以用来填充我的 listadapter 和我的视图。MergeCursor 没有帮助，因为它只是添加了列，没有通过 trainID 链接它们。我尝试在查询之间使用 INNER JOIN 和 UNION，但遇到了语法错误。

假设上面的输出，我对单个查询的期望是一个提供 2 行的游标，每行有 2 个名称站和 2 个日期（到达/离开），因为这是我想在 android 视图的每一行中显示的信息。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-06T19:05:32.497

```
SELECT FromSch.trainID,
       FromSt.name,
       FromSchSt.departure,
       ToSt.name,
       ToSchSt.arrival
FROM    stations          FromSt
   JOIN schedule_stations FromSchSt ON FromSt._id = FromSchSt.stationID
   JOIN schedule          FromSch   ON FromSchSt._id = FromSch.scheduleStationId
   JOIN schedule          ToSch     ON FromSch.trainID = ToSch.trainID
                                   AND FromSch.day = ToSch.day
   JOIN schedule_stations ToSchSt   ON ToSch.scheduleStationId = ToSchSt._id
   JOIN stations          ToSt      ON ToSchSt.stationID = ToSt._id
WHERE  FromSt._id = ?
   AND ToSt._id = ?
-- AND FromSch.day = ? 
```

# php - Netsuite 错误 INVALID_KEY_OR_REF

> ID：13256994
> 
> 赞同：0
> 
> 时间：2012-11-06T18:23:23.627
> 
> 标签：php, netsuite

收到此错误无效的 custrecord_lt_partner 参考密钥 225399。尝试插入时

前两个字段是列表/记录，第三个字段是自由格式文本。

具有管理员权限的 Netsuite

这是代码

```
global $nsClient;

$recordTypeRef = array("internalId" => 91);

$partnerName = "225399";
$companyName = "20562";
$labAcctNum  = "7182794";

$partnerNameFields = new nsComplexObject('SelectCustomFieldRef');

$partnerNameFields->setFields(
    array(
        'value'         => new nsListOrRecordRef(array('internalId' => $partnerName)),
        'internalId'    => 'custrecord_lt_partner' 
    )
);

$companyNameFields = new nsComplexObject('SelectCustomFieldRef');

$companyNameFields->setFields(
    array(
        'value'         => new nsListOrRecordRef(array('internalId' => $companyName)),
        'internalId'    => 'custrecord_lt_company' 
    )
);

$labAcctNumFields = new nsComplexObject('StringCustomFieldRef');

$labAcctNumFields->setFields(
    array(
        'internalId' => 'custrecord_lt_user_lab_acct_number',
        'value'      => $labAcctNum, 
    )
);

$customRecordFields = array(
    "recType"           => $recordTypeRef,
    "customFieldList"   => array($partnerNameFields, $companyNameFields, $labAcctNumFields),
);

$customRecord = new nsComplexObject('CustomRecord');

$customRecord->setFields($customRecordFields);

//echo "<pre>"; print_r($customRecord); echo "</pre>"; exit;

$addResponse = $nsClient->add($customRecord);

if($addResponse->isSuccess) {
    echo "<pre>"; print_r("Success"); echo "</pre>"; exit;
}
else {
    echo "<pre>"; print_r($addResponse->statusDetail[0]->message); echo "</pre>"; exit;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-14T00:13:34.883

当指定的 internalID 不存在时，我收到此错误。所以我假设 $partnerId 的值为“225399”。您是否在 Netsuite 中仔细检查了是否存在具有该 ID 的条目？（URL 或系统选项卡通常会告诉您更多信息。除了 SelectFields 之外，通常还有一个 Javascript 数组，您可以在其中找到 ID）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-08T01:45:37.480

$partnerName 是合作伙伴记录中的 entityId 字段，还是 internalId 字段？

您需要提供 internalId 或 externalId。您在变量中使用“名称”一词让我认为您没有使用内部或外部 ID。

# jquery - 无法拖动工作？

> ID：13256996
> 
> 赞同：0
> 
> 时间：2012-11-06T18:23:26.593
> 
> 标签：jquery, jquery-ui

关于如何让它发挥作用的任何想法？[JSFIDDLE](http://jsfiddle.net/mZczk/)

这是jQuery：

```
$("#image").draggable({
    stop:function(event,ui) {
        var wrapper = $("#wrapper").offset();
        var borderLeft = parseInt($("#wrapper").css("border-left-width"),10);
        var borderTop = parseInt($("#wrapper").css("border-top-width"),10);
        var pos = ui.helper.offset();
        $("#source_x").val(pos.left - wrapper.left - borderLeft);
        $("#source_y").val(pos.top - wrapper.top - borderTop);
        alert($("#source_x").val() + "," + $("#source_y").val());
    }
});​ 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-06T18:33:18.753

您的小提琴中的选择器缺少 #

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-06T18:43:16.563

修复警报显示`undefind`：

```
$("#dragmotto").draggable({
    stop:function(event,ui) {
        var wrappermotto = $("#wrappermotto").offset();
        var borderLeft = parseInt($("#wrappermotto").css("border-left-width"),10);
        var borderTop = parseInt($("#wrappermotto").css("border-top-width"),10);
        var pos = ui.helper.offset();

        var x = $("#dragmotto").val(pos.left - wrappermotto.left - borderLeft);
        alert(x.val());
    }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-06T18:35:46.633

我已经分叉了你的小提琴：http: [//jsfiddle.net/4WTZU/](http://jsfiddle.net/4WTZU/)

在你的小提琴中你错过`#`了`$("dragmotto")`

它应该是`$("#dragmotto").draggable();`