# StackOverflow 问答 15519000-15519999

# php - PHP - 在特定日期和时间运行 Cron 作业

> ID：15519003
> 
> 赞同：7
> 
> 时间：2013-03-20T08:55:25.573
> 
> 标签：php, cron, crontab

如何仅借助 cron 表达式识别该 cron 作业将在特定日期和时间运行

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-20T08:59:09.553

```
*     *     *   *    *        command to be executed
-     -     -   -    -
|     |     |   |    |
|     |     |   |    +----- day of week (0 - 6) (Sunday=0)
|     |     |   +------- month (1 - 12)
|     |     +--------- day of        month (1 - 31)
|     +----------- hour (0 - 23)
+------------- min (0 - 59) 
```

将 替换为`*`您需要的值。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-20T09:17:41.220

cron 作业参数的结构

```
Minutes [0-59]
    |   Hours [0-23]
    |   |   Days [1-31]
    |   |   |   Months [1-12]
    |   |   |   |   Days of the Week [Numeric, 0-6]
    |   |   |   |   |
    *   *   *   *   * home/path/to/command/the_command.sh 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:02:06.480

如果你使用 apache 控制面板，请参考它。通常它有一个`cron job`很好的帮助和例子的部分

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-01T06:55:11.547

如果您想从 crontab 时间/日期值开始，然后查看未来运行时列表，请尝试使用[dataphyx 的 cron 沙箱。](http://www.dataphyx.com)

# matlab - 如何在 Matlab 中连接两个 3D 矩阵？

> ID：15519010
> 
> 赞同：2
> 
> 时间：2013-03-20T08:55:38.193
> 
> 标签：matlab, matrix

假设我有两个 3d 矩阵 A 和 B。`A = 49x49x18 B = 49x49x24`连接后，我希望将`C = 49x49x42`视为 A 和 B 在第三维的连接。

我将如何在 matlab 中做到这一点？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-20T09:02:57.023

使用指定维度 3的[cat函数](http://www.mathworks.com/help/matlab/ref/cat.html)

```
C = cat(3, A, B) 
```

# jquery - 'input' 类型的 jQuery 选择器，不包括一些匹配的元素

> ID：15519011
> 
> 赞同：1
> 
> 时间：2013-03-20T08:55:42.703
> 
> 标签：jquery, jquery-selectors

我已经关注了`HTML`，

```
 <input type=text id='input_field_1` class='row'/>
 <input type=text id='input_field_2` class='row'/>
 <input type=text id='optional_field_3` class='row'/> 
```

在上面，`DOM`如果我想选择`id`开始的元素，`input_field_`那么我可以通过`$("input[id^='input_field_']")`

现在更多`input`的元素被添加到现有的`DOM`结构中，那些是

```
 <input type=text id='input_field_min_4` class='row'/>
 <input type=text id='input_field_max_5` class='row'/>
 <input type=text id='optional_field_6` class='row'/> 
```

如果我使用`$("input[id^='input_field_']")`，那么所有以 开头的元素`input_field_`，包括`input_field_min_4`并且`input_field_max_5`也在选择。

我不想要这个，我想排除`input_field_min_4`和`input_field_max_5`，因为如果做一些类似的事情，`$("input[id^='input_field_'],input:not[id^='input_field_m']")`那么结果不会达到我的预期。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:05:51.393

您拥有的选择器无效，将导致 JavaScript 错误。它缺少 . 周围的括号`:not`。

```
console.log($("input[id^='input_field_'],input:not([id^='input_field_m'])"));
                                                  ^                     ^ 
```

但是，即使添加了它们，`,`选择器之间的存在也会导致选择`id="^input_field_"` **或**不选择`id="^input_field_m"`，这实际上匹配所有输入。

您需要将属性选择器（[Combine CSS Attribute Selectors](https://stackoverflow.com/questions/2942286/combine-css-attribute-selectors)）和否定伪类[`:not`](http://www.w3.org/TR/selectors/#negation)组合在一起，因此下面将选择前两个`<input>`元素。

```
console.log($('input[id^="input_field_"]:not([id^="input_field_m"])')); 
```

有问题的 HTML 代码也使用了一些不一致的引号。反引号可能会导致一些问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T08:59:11.553

您可以使用`not`方法：

```
$("input[id^='input_field_']").not('[id*=min], [id*=max]'); 
```

[http://jsfiddle.net/A5Gn8/](http://jsfiddle.net/A5Gn8/)

请注意，这些选择器效率不高。*如果可能的话*，您应该考虑使用不同的逻辑来选择元素。

更快的选择：

```
$("input").filter(function(){
   return this.id.match(/^input_field_\d/);
}); 
```

[http://jsfiddle.net/Ueeht/](http://jsfiddle.net/Ueeht/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T08:58:08.737

这应该可以解决问题：

```
$("input[id^='input_field_']").not("[id^='input_field_m']"); 
```

尽管如此，您仍然认为您最好使用其他属性（`role`例如，或`data`一个）来做出这种区分并简化您的选择器。例如，如果这些附加输入标有 , 之类的东西`data-limit="min"`，那么`data-limit="max"`您的选择器将像...

```
$("input[id^='input_field_']").not("[data-limit]"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T08:58:40.707

用逗号分隔选择器会产生`or`条件，您需要`and`在这里，您必须组合条件并使用排除 id`:not`

**[现场演示](http://jsfiddle.net/VH9aD/)**

```
$("input[id^=input_field_]:not([id^=input_field_m])"); 
```

# linux - 学习网络驱动程序接口的好链接

> ID：15519014
> 
> 赞同：-1
> 
> 时间：2013-03-20T08:55:46.337
> 
> 标签：linux, linux-kernel, kernel, linux-device-driver

我想了解（研究）与 linux 内核或 TCP/IP 堆栈接口的网络驱动程序。为此，我想使用我自己的系统驱动程序作为案例研究。你能告诉我任何可以学习上述概念的好的参考资料吗？我会非常感谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:02:14.083

我建议：

(1) Benvenuti 的《Understanding the Linux Network Internals》一书；这本书可以在亚马逊上订购：http: [//www.amazon.com/Understanding-Network-Internals-Christian-Benvenuti/dp/0596002556](https://rads.stackoverflow.com/amzn/click/com/0596002556)

(2)Linux Kernel源码树内的一个demo代码：./drivers/net/pci-skeleton.c，或者Linux Kernel内其他真实的网卡驱动代码，网卡驱动代码海量；

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:24:32.370

我认为 Linux 设备驱动程序书中解释了接口的某些部分。您可以在此处获得合法且免费的副本：http: [//lwn.net/Kernel/LDD3/](http://lwn.net/Kernel/LDD3/)

查看网络设备驱动程序的代码示例，它应该向您展示设备驱动程序和内核网络子系统之间的接口是如何工作的。

# android - 带宽计算公式

> ID：15519015
> 
> 赞同：2
> 
> 时间：2013-03-20T08:55:47.343
> 
> 标签：android, bandwidth

真的与带宽计算公式混淆了。
参考带宽检测问题[检查Android中的带宽速率](https://stackoverflow.com/questions/8225791/check-the-bandwidth-rate-in-android)我正在尝试按如下方式计算带宽。

```
long startTime = System.currentTimeMillis();
HttpResponse response = httpclient.execute(httppost);
HttpEntity httpEntity = response.getEntity();
long contentLength = httpEntity.getContentLength();
long endTime = System.currentTimeMillis();
float bandwidth = contentLength / ((endTime-startTime) / 1000); // In the refereed question it is "((endTime-startTime) * 1000)" don't know why multiplication. 
```

我需要的是当前带宽（不是字节或千字节）。我不知道使用上面的公式是否以字节或位为单位计算带宽。

此外，如果下载时间为 0 秒，那么带宽应该是下载内容的长度。有人可以建议正确的公式来计算以比特为单位的带宽。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T09:23:47.370

首先，为了精确起见，您应该使用`1000.0`to 转换为秒，因为您将带宽分配给`float`变量：

```
float bandwidth = (contentLength / (endTime-startTime)) / 1000.0; 
```

现在，由于您的 contentLength 以字节为单位，您需要转换为位（Kb、Mb 等）。每个字节有 8 位，因此`contentLength*8`将字节转换为位。

Kilo->Mega->Giga ->... 位单位的比例转换是按顺序转换的，`1000`这意味着将位转换为兆位需要除以`1000*1000`. 所有这些放在一起应该会产生：

```
int bits = contentLength * 8;
int megabits = contentLength / (1000*1000); //Megabits
float seconds = endTime-startTime / 1000.0;
float bandwidth = (megabits / seconds);  //Megabits-per-second (Mbps) 
```

**编辑#1：**如果带宽以字节/时间（例如 KB/s）计价，则比例转换大约为`1024`

```
int bytes = contentLength;
int kilobytes = contentLength / 1024; //Kilobytes 
```

**编辑#2：**我意识到，在谈到带宽时，“Mega”和“Kilo”等的定义可能有点模棱两可。通常`1024`(2 ^(10) ) 和`1000`(10 ³ ) 可以互换使用（很可能是事故）。在许多情况下`1024`，在计算带宽时可能倾向于将其作为数量级，因为计算机上的内存存储空间是以 2 为基数测量的。但是，网络带宽通常由调节比特传输的 CPU 的时钟速度控制，这个速率是以赫兹（准确地说是 MHz）为单位测量，其数量级为`1000`，**而不是** `1024`。然而，在大多数情况下，这两个数字足够接近，不会产生重大错误。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T09:03:31.490

根据您给出的[链接](https://stackoverflow.com/questions/8225791/check-the-bandwidth-rate-in-android)，您对其评论说，`// Bandwidth : size(KB)/time(s)`只需将其乘以`1024`获取`bytes`或`1024*8`获取它`bits`，如果下载时间为 0，则从技术上讲，没有下载任何内容，因为速度是`amout/time`

1.对于以位计算，只需使用

```
float bandwidth = contentLength / ((endTime-startTime) *(1000*1024*8)); 
```

2.如果下载时间为0则表示没有下载任何内容，因此我们无法建议带宽

**编辑 2**

**计算**

那只是简单的数学

如果你每秒有 kb`1 kb/ per 1 second`

所以速度是`1 kbps`=>`1*(1024 bytes)/ 1* (1000000000 nano seconds)`

所以它`0.000001024`每纳秒的字节数

现在位将是`1*(1024 * 8 bits)/ 1* (1000000000 nano seconds)`

所以它`0.000008192`每纳秒的位数

现在，如果你想要它在 seoncds 中，那么只需将它乘以`1000000000`

所以是`0.000008192 * 1000000000 = 8192 bits per second`

和`(0.000008192/8) * 1000000000 = 1024 bytes per second`或`1 kbps`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-04-09T11:46:24.250

```
public static String internetSpeed(long msecs, long bytes)
{
    long  secs  = msecs / 1000;                                     
    long  bits  = bytes * 8;
    float speed = bits / secs;

    long  Kbit  = 1024;
    long  Mbit  = Kbit * 1024;
    long  Gbit  = Mbit * 1024;

    if (speed < Kbit )                  return String.valueOf(speed)        + " bit-sec" ;
    if (speed > Kbit && speed < Mbit)   return String.valueOf(speed / Kbit) + " Kbit-sec";
    if (speed > Mbit && speed < Gbit)   return String.valueOf(speed / Mbit) + " Mbit-sec";
    if (speed > Gbit)                   return String.valueOf(speed / Gbit) + " Gbit-sec";
    return "???";
} 
```

你可以像这样调用这个方法

```
....
System.out.println(internetSpeed((endTime-startTime), contentLength));
.... 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T09:00:37.523

> 您可以从服务器下载已知大小的文件。

```
long startTime = System.currentTimeMillis();
HttpGet httpRequest = new HttpGet(new URL(urlString).toURI());
HttpClient httpClient = new DefaultHttpClient();
HttpResponse response = (HttpResponse) httpClient.execute(httpRequest);
long endTime = System.currentTimeMillis();

HttpEntity entity = response.getEntity();
BufferedHttpEntity bufHttpEntity;
bufHttpEntity = new BufferedHttpEntity(entity);

//You can re-check the size of your file
final long contentLength = bufHttpEntity.getContentLength();

// Log
Log.d(TAG, "[BENCHMARK] Dowload time :"+(endTime-startTime)+" ms");

// Bandwidth : size(KB)/time(s)
float bandwidth = contentLength / ((endTime-startTime) *1000); 
```

> 并通过此代码直接获取 wifi 速度

```
WifiManager wifiManager = Context.getSystemService(Context.WIFI_SERVICE);
WifiInfo wifiInfo = wifiManager.getConnectionInfo();
if (wifiInfo != null) {
    Integer linkSpeed = wifiInfo.getLinkSpeed(); //measured using WifiInfo.LINK_SPEED_UNITS
} 
```

# java - 如何使用 BufferReader 或其他方法读取固定长度的字符？

> ID：15519016
> 
> 赞同：1
> 
> 时间：2013-03-20T08:55:47.483
> 
> 标签：java, string, unicode, byte

如果我使用 BufferReader 读取一行，我可以得到一行的字符串。代码是这样的：

```
FileInputStream fs = new FileInputStream("E:\\tmp\\aaa.txt");
BufferedReader br = new BufferedReader(new InputStreamReader(fs));

String line = null;  
while ((line = br.readLine()) != null) { 
    System.out.println(line.length() + " " +line.substring(0, 2);
} 
```

aaa.txt 的内容是：

```
一二三四1234 
```

所以。运行代码的结果是：

```
8 一二 
```

从结果中，我知道 String 中一个汉字的长度是一，而不是二。

**所以如果我使用 line.substring(0,2)，我会得到两个汉字“一二”。但我希望 line.substring(0,2) 的结果是“一”。**

我的意思是，在我看来，“一二三四1234”的长度是 12，而不是 8。我可以使用 substring(0,2) 来提取固定长度的字符。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:03:59.893

> 从结果中，我知道 String 中一个汉字的长度是一，而不是二。

没错，每个符号都是一个字符，所以这些“一二三四1234”字符串的长度是8

那为什么是12？

> 我的意思是，在我看来，“一二三四1234”的长度是 12，而不是 8。我可以使用 substring(0,2) 来提取固定长度的字符。

如果你知道你想要的字符的索引，你可以使用下面的代码：

```
String s = "一二三四1234";
char c = s.charAt(0); 
```

因为 subString 方法从索引 0 到 2 创建了一个新的 String

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:03:09.980

> 如果我使用 line.substring(0,2)，我会得到两个汉字“一二”。

所以你有两个字符。这就是你要求的。索引 0 和 1 处的两个字符。

> 但我希望 line.substring(0,2) 的结果是“一”。

如果您只想要一个字符，请要求一个字符。索引 0 处的字符`line.substring(0,1)`。例如。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:10:04.683

Java 使用 unicode 作为内部字符集，因此任何 char 类型都是 unicode。而 java.lang.String 由字符组成。

当您从阅读器获取字符串时，文件的字节内容已经根据文件的编码转换为字符。

line.substring(0, 2) 产生一个新字符串，其中包含要返回的*行*的第一个两个字符，这就是你已经得到的！

我猜“在我眼中的长度”是指你在 UltraEdit 这样的文本编辑器中看到的，也许编辑器只显示文件中字节的位置

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-12-12T03:51:27.753

1.  首先，您需要使用中文编码对文件进行解码，例如 GBK、GB2312 等。

2.  将该行读入字节数组，然后使用中文编码将该字节数组转换为字符串。

    ```
    FileInputStream fileStream=new FileInputStream(New  
    File("sometext.txt"));
    byte[] buf=new byte[12];
    byte[] line=reader.read(buf);
    byte[] byteRange=Arrays.copyOfRange(allBytes,0,2));
    String chineseString=new String(byteRange,Charset.forName("GBK")); 
    ```

这样你只会得到1个汉字。从 GBK 到 UTF-8 的转换只有 1 步。

哦耶！对前一种方法的改进。

# scala - Scala 替代 python `with`

> ID：15519017
> 
> 赞同：3
> 
> 时间：2013-03-20T08:55:48.027
> 
> 标签：scala

在 python 中，你可以避免 try {} catch {} finally {} 样板 with `with`（参见[What is the python keyword "with" used for?](https://stackoverflow.com/questions/1369526/what-is-the-python-keyword-with-used-for)）。我记得在 Scala 中看到了替代方案，但我再也找不到了。

它遵循以下原则：

```
def using[O](r: {def close()})(doit: () => O): O = try {
  doit()
} finally {
  r.close
}

using(myWriter){() => myWriter.println("something or another")} 
```

它是内置在 2.10 中的，还是我需要一个单独的库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T09:05:26.710

自己制作几乎涵盖所有用例（这里使用 2.10）几乎是微不足道的：

```
implicit class TidyUpAnything[A](val a: A) extends AnyVal {
  def tidily[Z](g: A=>Any)(f: A=>Z) = try { f(a) } finally { g(a) }
} 
```

如果您希望通过异常，请按原样使用：

```
scala> Option(null: String).tidily(println){_.get}   // Should print None
None
java.util.NoSuchElementException: None.get
    at scala.None$.get(Option.scala:313)
    ... 
```

如果要处理异常，请将其与[scala.util.Try](http://www.scala-lang.org/api/rc/index.html#scala.util.Try)结合使用：

```
scala> import scala.util._
scala> Try( Option(null: String).tidily(println){ _.get } )
None
res1: scala.util.Try[String] = Failure(java.util.NoSuchElementException: None.get) 
```

通常你会做类似的`g`东西`_.close`，但你可以用它做任意资源清理。例如，在这里，每当我们完成时，我们都会后退一个计数器：

```
var i = 0
val a = Array(1,2)
a.tidily(_ => i -= 1){ _.foreach(_ => i += 1) }
scala> i
res2: Int = 1 
```

# java - 如何配置 openfire 以支持 TLS 1.2

> ID：15519018
> 
> 赞同：1
> 
> 时间：2013-03-20T08:55:51.933
> 
> 标签：java, xmpp, openfire

我在 Windows 上使用 Openfire 3.8.1 作为 XMPP 服务器，但 open fire 仅支持 TLS 1.0，我需要支持 TLS 1.2

如何配置 Openfire 以支持 TLS 1.2？

我还读到 openfire 是用 jdk 1.5 或 1.6 编译的，而这些版本的 jdk 不支持 TLS 1.2。如果我用支持 TLS 1.2 的 jdk 1.7 编译 openfire 源代码就足够了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-10T04:03:32.130

将使用的 JRE Openfire 从 1.6 更改为 1.7。如果您在 Windows 中运行 Openfire，请根据 shell 脚本 openfirectl 创建一个使用 Java 7 的批处理文件。无需重新编译代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-06-18T15:50:43.130

您必须从 1.6（例如 openjdk-6）升级到 1.7（例如 openjdk-7）才能获得 TLS 1.2。

请注意，即使使用 openjdk-7，TLS 1.2 仍然对客户端连接禁用：

[http://docs.oracle.com/javase/7/docs/technotes/guides/security/SunProviders.html#tlsprotonote](http://docs.oracle.com/javase/7/docs/technotes/guides/security/SunProviders.html#tlsprotonote)

> 尽管 Java SE 7 版本中的 SunJSSE 支持 TLS 1.1 和 TLS 1.2，但默认情况下，这两个版本均未启用客户端连接。一些服务器没有正确实现前向兼容性并拒绝与 TLS 1.1 或 TLS 1.2 客户端通信。对于互操作性，SunJSSE 默认情况下不为客户端连接启用 TLS 1.1 或 TLS 1.2。

这意味着对于服务器到服务器的连接，openfire 充当客户端，即使使用 openjdk-7，它仍然不会使用 TLS 1.2（只有在 openjdk-8 中才会最终默认启用 TLS 1.2）。

我查看了 openfire 和 Java API 的源代码，并得出结论，您应该能够通过以下方式解决问题（尽管我没有机会确认它具有预期的效果）：

```
INSERT INTO OFPROPERTY VALUES('xmpp.socket.ssl.algorithm','TLSv1.2') 
```

例如，您最好的选择是使用 Java 7 或 8，然后如果使用 7，也请尝试上述设置。

# java - 在尝试连接之前在 Socket 上设置超时

> ID：15519024
> 
> 赞同：0
> 
> 时间：2013-03-20T08:56:35.460
> 
> 标签：java, android, sockets

Socket 类文档在[这里](http://developer.android.com/reference/java/net/Socket.html)。

在我的代码 atm 中，我使用如下构造函数：

`Socket m_Socket = new Socket(m_Address, m_Port);`

`m_Address`是一个 InetAddress 并且`m_Port`是一个 int。

当此行运行时，无法创建套接字，应用程序会等待 3 秒左右，然后抛出 IOException。

我可以看到没有构造函数同时接受**,**`InetAddress`和`int`另一个超时。我需要等待 250 毫秒，而不是像现在这样约 3 秒。这意味着我需要在套接字上设置超时，但我找不到任何方法来做到这一点。我知道我们有方法，但需要在类的实例上调用它。我可以通过这样做来实例化一个新的 Socket: ，但是我需要设置 InetAddress 和端口，而 Socket 类似乎没有任何方法可以做到这一点（构造函数除外）。**`int``setSoTimeout(timeout)``Socket``m_Socket = new Socket();`**

 **如何在实际尝试设置套接字之前设置超时？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:07:12.910

您可以使用默认构造函数创建一个未连接的 Socket，然后使用超时调用 connect()。

```
Socket m_Socket = new Socket();
m_Socket.connect(addr,1000); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T09:12:01.927

尝试

```
 Socket sock  = new Socket();
    sock.connect(new InetSocketAddress(m_Address, m_Port), 250); 
```**

# php - 页面地址中的错误请求和百分比

> ID：15519030
> 
> 赞同：0
> 
> 时间：2013-03-20T08:56:47.180
> 
> 标签：php, unix

当我添加页面地址 % 得到这个错误（www.mypage.com/news-360%-rotation）：

> 错误的请求
> 
> 您的浏览器发送了此服务器无法理解的请求。
> 
> Apache/2.2.15 (CentOS)

这可能是我的 php 代码错误或服务器设置有问题？以及如何修复它？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T08:58:42.077

该`%`字符需要进行 URL 编码。请参阅[http://en.wikipedia.org/wiki/Percent-encoding](http://en.wikipedia.org/wiki/Percent-encoding)。

请改用*www.mypage.com/news-360%25-rotation*。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:00:19.423

使用[urlencode](http://www.php.net/manual/en/function.urlencode.php)

```
'www.mypage.com/' . urlencode('news-360%-rotation'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:00:52.000

您需要对链接进行 URI 编码，因为百分比符号是“特殊的”并用于编码其他值 - 我希望 URL 看起来更像：

`www.mypage.com/news-360%25-rotation`

# apache2 - ProxyPass 未设置端口

> ID：15519036
> 
> 赞同：0
> 
> 时间：2013-03-20T08:56:54.990
> 
> 标签：apache2, jetty

我正在尝试在代理后面运行码头/检票口应用程序。这是为了避免用户输入码头的端口号。

```
 ProxyPass        /test http://xx.xx.xx.xxx:8012/myapp
 ProxyPassReverse /test http://xx.xx.xx.xxx:8012/myapp
 ProxyPassReverseCookiePath / /test 
```

当我尝试连接到 xx.xx.xx.xxx/test 时，它会重定向到

```
http://xx.xx.xx.xxx/myapp 
```

这给了我一条错误消息，因为它正在尝试连接端口 80？我应该如何编写这个代理？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T11:28:22.417

简单的解决方案是匹配完全相同的路径。像这样的东西：

```
ProxyPass                    /myapp    http://localhost:8012/myapp
ProxyPassReverse             /myapp    http://localhost:8012/myapp  
ProxyPassReverseCookieDomain localhost www.publicdomain.net 
```

# javascript - 根据屏幕大小折叠 div 元素

> ID：15519047
> 
> 赞同：7
> 
> 时间：2013-03-20T08:57:26.087
> 
> 标签：javascript, html, css, twitter-bootstrap

我只是想知道如何根据屏幕大小使用 bootstraps[手风琴](http://twitter.github.com/bootstrap/javascript.html#collapse)，例如，假设我有一个 div 我想定期显示在所有内容上，但是在移动视图中我希望它折叠。

有什么建议么？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-11-05T02:37:43.467

这是使用 Shail 建议的方法的示例，但没有重复布局。预期的行为是在 Bootstrap 3 的响应断点之一 ( `screen-md`) 处折叠元素。

```
@media (min-width: @screen-md)
{
    #filters
    {
        display: block;
    }
}

<button type="button" 
        data-toggle="collapse" 
        data-target="#filters" 
        class="visible-xs visible-sm collapsed">Filter</button>

<div id="filters" class="collapse">...</div> 
```

`#filters`除非应用 css 媒体查询并覆盖类的行为，否则标记是折叠的`collapse`。

`#filters`仅当媒体查询不再适用时，展开按钮才可见。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-05-17T04:38:16.910

**更新：在单击另一个 div 之后，div 不会关闭之前，就像手风琴的工作方式一样。您必须将 panel-group 和 panel 添加到 HTML 中才能正常工作。HTML 已与 CSS 一起更新**

有点晚了，但我希望这就是你要找的。我试图做同样的事情，这就是我想出的解决方案。首先，我试图思考导航栏是如何崩溃的。我做了一个名为“div-collapse”的课程。这就像导航栏折叠并使 div 关闭和隐藏，具体取决于您将其放在 css 中的位置。（此示例 div 在小型设备上折叠）

CSS：

```
#accordion .panel {
  border:none;
  -webkit-box-shadow:none; 
  box-shadow:none;
}

.div-collapse {
  border-top: 0;
  -webkit-box-shadow: none;
  box-shadow: none;
}

.div-collapse {
  overflow-x: visible;
  -webkit-overflow-scrolling: touch;
  border-top: 1px solid transparent;
  -webkit-box-shadow: inset 0 1px 0 rgba(255,255,255,.1);
  box-shadow: inset 0 1px 0 rgba(255,255,255,.1);
}

/* Small devices (tablets, 768px and up) */
@media (min-width: 768px) {
 .div-collapse.collapse {
   display: block !important;
   height: auto !important;
   overflow: visible !important;
 }

} 
```

的HTML：

```
<div class="container marketing">
        <hr class="featurette-divider">
        <h2>Heading for some content that you have</h2>
        <div class="row">
            <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">
            <div class="panel">
            <div class="col-md-12 visible-xs">
                <p>
                    <button data-parent="#accordion" class="btn btn-primary btn-lg btn-block" type="button" data-toggle="collapse" data-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
  #1 Example One
                    </button>
                </p>
            </div>
            <div id="collapse1" class="div-collapse collapse col-md-4">
                <h3>Header 1</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Soluta dignissimos unde nemo sed necessitatibus vitae ipsum, maxime quaerat dolorum doloremque quibusdam vel mollitia inventore sequi, quam deleniti quidem sunt? Similique.</p>
            </div>
            </div>
            <div class="panel">
            <div class="col-md-12 visible-xs">
                <p>
                    <button data-parent="#accordion" class="btn btn-primary btn-lg btn-block" type="button" data-toggle="collapse" data-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
  #2 Example Two
                    </button>
                </p>
            </div>
            <div id="collapse2"  class="div-collapse collapse col-md-4">
                <h3>Header 2</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Soluta dignissimos unde nemo sed necessitatibus vitae ipsum, maxime quaerat dolorum doloremque quibusdam vel mollitia inventore sequi, quam deleniti quidem sunt? Similique.</p>
            </div>
            </div>
            <div class="panel">
            <div class="col-md-12 visible-xs">
                <p>
                    <button data-parent="#accordion" class="btn btn-primary btn-lg btn-block" type="button" data-toggle="collapse" data-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
  #3 Example Three!
                    </button>
                </p>
            </div>
            <div id="collapse3" class="div-collapse collapse col-md-4">
                <h3>Header 3</h3>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Soluta dignissimos unde nemo sed necessitatibus vitae ipsum, maxime quaerat dolorum doloremque quibusdam vel mollitia inventore sequi, quam deleniti quidem sunt? Similique.</p>
            </div>
            </div>
            </div>
        </div> 
```

这将为小型设备创建三个按钮，并隐藏 div，直到它们被单击。一旦屏幕比小设备大，按钮将通过引导响应类隐藏。然后 div 将恢复正常的行为。这样，您不必为移动设备和桌面创建两种不同的布局和内容。

JS Fiddle 演示： [JS Fiddle 链接](https://jsfiddle.net/Bootstrap714/k8yaxbwc/3/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-20T10:13:22.423

Bootstrap 中有[内置的类](http://twitter.github.com/bootstrap/scaffolding.html#responsive)来帮助你。尝试在您的 div 中使用`.visible-phone`,`.visible-tablet`等。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2016-09-30T08:23:55.383

我知道这已被标记为已回答，但也许我的回答将来会对某人有所帮助。

我在我的场景中所做的是在桌面屏幕中使用[event.stopPropagation()覆盖引导程序，并通过](https://api.jquery.com/event.stoppropagation/)[媒体查询](https://developer.mozilla.org/es/docs/CSS/Media_queries)使可折叠框可见。

一个愚蠢的例子（[Jsfiddle 例子](https://jsfiddle.net/6qu57fht/2/)）：

html:

```
<div class="data-div" data-toggle="collapse" data-target="#collapseData">
   <div class="row">
      <div class="col-xs-12">
         <b>Always visible data</b>
      </div>
   </div>
   <div class="row collapse" id="collapseData">
      <div class="col-xs-12">
         Mobile hidden data
      </div>
   </div>
</div> 
```

CSS：

```
@media (min-width: 480px)
{
    #collapseData
    {
        display: block;
    }
} 
```

Javascript：

```
var MOBILE_WIDTH = 480;
$( document ).ready(function() {
    if ($(window).width() >= MOBILE_WIDTH) {
        $('.data-div').click(function (event) {
            event.stopPropagation();
        });
    }
}) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T09:13:58.000

媒体查询是您的朋友。

在您的 CSS 中添加类似的内容（这是针对 iPhone 3-4 + 视网膜）：

```
@media only screen and (min-device-width: 320px) and (max-device-width: 480px) and (max-device-height: 480px) and (orientation:portrait) {
    /*your css here*/
}

@media only screen and (max-device-width: 480px) and (min-device-width: 320px) and (max-device-height: 480px) and (orientation:landscape) {
    /*your css here*/
} 
```

然后在查询中添加 css 来折叠手风琴。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T10:14:55.690

您可以在引导程序中使用响应式实用程序类，查看此页面以获取更多详细信息[http://twitter.github.com/bootstrap/scaffolding.html#responsive](http://twitter.github.com/bootstrap/scaffolding.html#responsive)

就像是

```
 <div class="visible-phone">accordion</div> 
  <div class="visible-desktop">all data you want to display</div> 
```

Jsfiddle [演示](http://jsfiddle.net/shail/HMEgd/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-05-16T12:18:22.180

现有的答案有点过时了。代替`visible-[devicename]`，您可以使用基于断点的响应类。所以，假设你想要一个盒子，#someid，在`sm`上面和上面完整显示，并且只能用一个切换按钮折叠`xs`：

## **引导程序 3**

[文档链接](http://getbootstrap.com/css/#responsive-utilities)：

*   `hidden-*`你用哪里`*`是断点（`xs`, `sm`, `md`, `lg`）隐藏东西
*   你用`visible-*-**`哪里`*`是断点和`**`CSS 显示值 ( `inline`, `block`, `inline-block`) 来显示东西。
*   您可以将事物设置为默认仅在某些断点处折叠`collapse-*`

例如：

```
<button class="hidden visible-xs-block" data-toggle="collapse" data-target="#someid">Button label</button>
<div id="someid" class="collapse-xs">Some content here</div> 
```

## **引导程序 4**

[文档链接](http://v4-alpha.getbootstrap.com/layout/responsive-utilities/)：

*   `hidden-*-up`隐藏 at`*`及以上的元素，例如，`hidden-md-up`隐藏`md`(medium desktop) 和`lg`(large) 断点处的元素。
*   `hidden-*-down`对于和更小是相同的`*`-`hidden-md-down`会隐藏*除* `lg`大小之外的所有内容。
*   没有`visible-*`等价物，您只需确保不要以这些尺寸隐藏它。

例如（注意 V4 仍处于 alpha 阶段，崩溃时似乎有一些变化，所以这可能会改变）：

```
<button class="hidden-xs-down" data-toggle="collapse" data-target="#someid">Button label</button>
<div id="someid" class="hidden-sm-up">Some content here</div> 
```

按钮仅按`xs`大小显示，可折叠框仅默认隐藏在`xs`大小以上。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-05-31T23:32:54.863

在 Bootstrap-4 中，事情要容易得多：

```
<div className="container-fluid text-center d-none d-lg-block">
      <div className="row">
        <div className="mx-auto col-lg-2">
          <p className="text-uppercase">products</p>
        </div>
      </div>
    </div> 
```

我们只会在大屏幕上看到“产品”，它会居中（文本中心）并且只占 2 列宽

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-10-19T17:24:37.320

我在使用 Angular 6 手风琴时遇到了类似的问题，手风琴内的数据表不可见。解决方案是将手风琴包装在一个宽度为 fit-content 样式的 div 中，如下所示

```
<div style="width:fit-content">
<ngb-accordion [activeIds]="activeAccordians">
  <ngb-panel id="id" title="SUMMARY">
    <ng-template ngbPanelContent>

      <table datatable [dtOptions]="dtOptions" class="row-border hover">
.....
</table
    </ng-template>
  </ngb-panel>
</ngb-accordion>
</div> 
```

# jquery - XML jquery解析：仅显示具有特定值的结果

> ID：15519053
> 
> 赞同：0
> 
> 时间：2013-03-20T08:57:46.337
> 
> 标签：jquery, xml, xml-parsing

例如我有这个 XML：

```
<data>
    <area>
        <state>SABAH</state>
        <parlim>P1</parlim>
        <name>Alice Smith</name>
    </area>
    <area>
        <state>SABAH</state>
        <parlim>P2</parlim>
        <name>John Smith</name>
    </area>
    <area>
        <state>SABAH</state>
        <parlim>P3</parlim>
        <name>Peter Smith</name>
    </area>
    <area>
        <state>SARAWAK</state>
        <parlim>P4</parlim>
        <name>Paul Smith</name>
    </area>
</data> 
```

我正在使用 jquery 将其解析为 html 表：

```
 $.ajax({
  type: "GET",
  url: "parse.xml", 
  dataType: "xml",
  success: function(xml) {
   $(xml).find('area').each(function(){
    var Col0 = $(this).find('state').text();
    var Col1 = $(this).find('parlim').text();
    var Col2 = $(this).find('name').text();
    $('<tr></tr>').html('<td>'+Col0+'</td><td>'+Col1+'</td><td>'+Col2+'</td>').appendTo('#chart');
   });
  }
 });
}); 
```

我如何使它只显示状态为 SABAH 的结果（这是前 3 个结果）？提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:00:11.183

改变

```
$(xml).find('area').each(function(){
    var Col0 = $(this).find('state').text();
    var Col1 = $(this).find('parlim').text();
    var Col2 = $(this).find('name').text();
    $('<tr></tr>').html('<td>'+Col0+'</td><td>'+Col1+'</td><td>'+Col2+'</td>').appendTo('#chart');
}); 
```

到

```
$(xml).find('area').each(function(){
    var Col0 = $(this).find('state').text();
    // check if Col0 = SABAH
    if (Col0 === 'SABAH') { 
       var Col1 = $(this).find('parlim').text();
       var Col2 = $(this).find('name').text();
       $('<tr></tr>').html('<td>'+Col0+'</td><td>'+Col1+'</td><td>'+Col2+'</td>').appendTo('#chart');
    }
}); 
```

这使用一个`if`语句来检查`state`标签中的文本来决定是否继续

# iphone - 大量大文件在创建 zip 文件时造成泄漏

> ID：15519054
> 
> 赞同：2
> 
> 时间：2013-03-20T08:57:49.067
> 
> 标签：iphone, ios, objective-c, zip

```
NSData * buffer = [fileHandle readDataOfLength:chunkSize];
                while ([buffer length] > 0)
                {
                    [streamBIG writeData:buffer];
                    offset += [buffer length];

                    [fileHandle seekToFileOffset:offset];
                    buffer = [fileHandle readDataOfLength:chunkSize];
                } 
```

我使用这些特定的过程来压缩超过 1 个 25 - 30 MB 的文件，但是这些会增加内存，即实时字节不断增加，直到所有文件都没有被写入，因此我的应用程序崩溃

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:08:43.513

使用自动释放池尝试这样

```
 NSData * buffer = [fileHandle readDataOfLength:chunkSize];
                while ([buffer length] > 0)
                {
                    @autoreleasepool
                    {
                    [streamBIG writeData:buffer];
                    offset += [buffer length];

                    [fileHandle seekToFileOffset:offset];
                    buffer = [fileHandle readDataOfLength:chunkSize];
                    }
                } 
```

它会工作......

# sorting - 双音排序的 OpenCL 主机代码

> ID：15519056
> 
> 赞同：1
> 
> 时间：2013-03-20T08:57:51.983
> 
> 标签：sorting, opencl

谁能告诉我在哪里可以找到 Matthew Scarpino 的 OpenCL in Action 一书中给出的 OpenCL 双音排序算法的主机代码......？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-24T16:05:10.280

本书的代码示例可以在出版商网站以下页面的下载部分找到：[Manning: OpenCL In Action](http://www.manning.com/scarpino2/)

# opencv - Opencv 训练

> ID：15519066
> 
> 赞同：2
> 
> 时间：2013-03-20T08:58:19.830
> 
> 标签：opencv

列车级联参数中真正的 adaboost Logit boost 离散 adaboost 和温和 adaboost 有什么区别。

```
-bt <{DAB, RAB, LB, GAB(default)}> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-15T16:09:33.593

从[文档](http://docs.opencv.org/2.4.2/modules/ml/doc/boosting.html#fht98)

> ```
> boost_type – 提升算法的类型。
> 可能的值为：
> CvBoost::DISCRETE 离散 AdaBoost。
> CvBoost::REAL 真正的 AdaBoost。这是一种利用置信度预测的技术，可以很好地处理分类数据。
> CvBoost::LOGIT LogitBoost。它可以产生良好的回归拟合。
> CvBoost::GENTLE 温和的 AdaBoost。它对异常数据点的权重较小，因此通常适用于回归数据。
> Gentle AdaBoost 和 Real AdaBoost 通常是更可取的选择。
> ```

# django - Django 中的静态 URL 和 CSS

> ID：15519067
> 
> 赞同：-2
> 
> 时间：2013-03-20T08:58:26.457
> 
> 标签：django, django-settings, django-staticfiles, django-static

我正在尝试在 Django 中设置一个静态 url，并让我的模板使用它来链接到 css。这是我的代码。为什么它不起作用？另外，设置它的最佳做法是什么？谢谢。

```
# settings

import os

PROJECT_PATH = os.path.dirname(os.path.abspath(__file__)) 
STATIC_ROOT = os.path.join(PROJECT_PATH, 'static')
STATIC_URL = '/static/'

STATICFILES_DIRS = (

)

INSTALLED_APPS = (
    ...
    'django.contrib.staticfiles',
    )

# urls

from django.contrib.staticfiles.urls import staticfiles_urlpatterns

# ... the rest of my URLconfs here ...

urlpatterns += staticfiles_urlpatterns()

# html template

<link rel="stylesheet" href="{{ STATIC_URL }}css/style.css" type="text/css">

# file structure
-project
--project
---settings
---static
----css
-----style.css 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:32:19.673

您`STATICFILES_DIRS`需要包含用于开发的静态目录的路径列表。该`STATIC_ROOT`设置用于将静态文件收集到生产中的单个目录中，以供 HTTP 服务器（例如 Nginx 或 Apache）提供服务。

看到你已经定义了 a`PROJECT_ROOT`你可以这样做：

```
# Assuming your settings.py is at the same level as your static directory
STATICFILES_DIRS = [
    os.path.join(PROJECT_ROOT, 'static'), ] 
```

# jquery - jQuery 菜单不滑动

> ID：15519070
> 
> 赞同：0
> 
> 时间：2013-03-20T08:58:33.950
> 
> 标签：jquery, html, css

为什么我的手风琴菜单不起作用？

菜单不会向下滑动。

jQuery：

```
$('.rights li').click(function(){
$('ol.content').slideDown(500); 
    $(this).next().slideUp('normal');
});

$('ol.content').hide(); 
```

jsFiddle：http: [//jsfiddle.net/QEn6x/](http://jsfiddle.net/QEn6x/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:05:42.470

看到这个：`[Sample](http://jsfiddle.net/QEn6x/3/)`

```
$('.rights li').click(function(e) {
    $(this).find('ol.content').slideDown(500);  
    $(this).siblings().find('ol.content').slideUp('normal');
    e.preventDefault();
});

$('ol.content').hide(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:02:13.250

问题是 de a 标签的 URL。

添加 e.preventDefault() 并解决了问题。

```
$('.rights li').click(function(e) {
    e.preventDefault();
    $('ol.content').slideDown(500); 
    $(this).next().slideUp('normal');
});
$('ol.content').hide(); 
```

# c++ - 使用 std::cin 可以将多长的字符串读入字符串对象？

> ID：15519082
> 
> 赞同：1
> 
> 时间：2013-03-20T08:59:19.567
> 
> 标签：c++, string

使用 std::cin 可以将多长的字符串读入字符串对象？10000个字符是可能的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:04:15.603

`cin`是一个流，因此实际上您可以读取的字符数没有限制。如果你将它们全部缓冲在内存中，你可能会用完内存，当然，限制是由内存大小给出的，但是 10,000 个字符非常少（如果 Unicode，约为 20 KB），那么对于任何限制（即使在 16 台机器上也是如此）来说太远了...）。

什么时候`cin`是操作系统控制台，那么用户可以输入的字符数*可能会*受到限制，但这取决于操作系统（无论如何您不太可能获得该限制）。

# gcc - MinGW 是否影响编译——一个 GTK 程序

> ID：15519088
> 
> 赞同：1
> 
> 时间：2013-03-20T08:59:32.860
> 
> 标签：gcc, gtk, mingw

我在 MinGW 环境中编译了一个 GTK 程序。它工作完美。最近更新了MinGW，重新编译了GTK程序，然后程序总是因为Segmentation fault而停止。我曾尝试使用 gdb 来查找错误，但我做不到。GTK 的配置在新旧 MinGW 中完全相同。因此，我对影响编译的MinGW环境持怀疑态度。我发现 gcc 的版本在两个环境中是不同的：

```
 old MinGW    new MinGW
gcc    3.4.5     4.7.2 
```

任何的想法？有人遇到这种情况吗？

另一个线索是关于 GTK 本身。我发现程序停在这里：

```
g_signal_emit_by_name(G_OBJECT(g_object_get_data(G_OBJECT(window), "plat_GA_canvas")), "expose-event", G_TYPE_NONE); 
```

它是根据不同情况绘制图像的画布。在这里它只是发送一个信号来暴露画布。奇怪的是它在旧的 MinGW 中工作。所以我不怀疑这是问题的关键。可能只是一个线索。顺便说一句，我在家里纯Linux环境下编译了GTK程序。它也很完美。

任何的想法？请帮忙。

@duskast，下面是代码的一部分。它有点长。

++++++++++++++++++++++++++++++++++++++++++++++++++++++ +
问题可能发生了—— `g_signal_emit_by_name`：

```
void ACC_platform_unit_num_changed (GtkWidget *box, GtkWidget *window)
{
  int kind;

  kind = gtk_option_menu_get_history((GtkOptionMenu *)box) + 1;
  if(plat.unit_num != kind)
  {
    plat_GA_canvas_refresh (window);
    g_signal_emit_by_name(G_OBJECT(g_object_get_data(G_OBJECT(window), "plat_GA_canvas")), "expose-event", G_TYPE_NONE);

    plat.unit_num = kind;
    if(plat.unit_num == 1)
    {
      gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_if_gap"), FALSE);
      gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_if_big_gap"), FALSE);
      gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_gap_w"), FALSE);
      gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_live_load_gap"), FALSE);
    }
    else
    {
      gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_if_gap"), TRUE);
      if(plat.has_gap)
      {
    gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_if_big_gap"), TRUE);
    gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_gap_w"), TRUE);
    gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_live_load_gap"), TRUE);
      }
      else
      {
    gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_if_big_gap"), FALSE);
    gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_gap_w"), FALSE);
    gtk_widget_set_sensitive(g_object_get_data(G_OBJECT(window), "ACC_platform_live_load_gap"), FALSE);
      }
    }
    gap_span_show (g_object_get_data(G_OBJECT(window), "ACC_platform_gap_span_store"));
  }
} 
```

核心绘图功能：

```
void ACC_GA_draw (cairo_t *cr, int width, int height)
{
/* #define X_MARGIN 30
#define Y_MARGIN 30 */
#define COLUMN_RADIUS_ASSUME 1.6
#define COLUMN_SQUARE_LEN_ASSUME 2.0
  double x, y, x1, y1, x2, y2, scale, x_base, y_base, X_MARGIN, Y_MARGIN;
  double x3, y3, downward_height = 0, downward_width = 0;
  double x_one_unit, y_one_unit, x_total, y_total, gap_value;
  double alpha = 60.0, arrow_side_length = 20.0, arrow_tail_length = 10.0;
  ACC_AXIS *x_axis, *y_axis;
  int i, j, unit_num, downward;
  char *AX, *AY, *Wx_left, *Wx_right, *Wy_top, *Wy_bottom, *gap, *axis;
  cairo_text_extents_t te;

  AX = g_strdup_printf("%.0f", plat.fan_section_AX * 1000);
  AY = g_strdup_printf("%.0f", plat.fan_section_AY * 1000);
  Wx_left = g_strdup_printf("%.0f", plat.walkway_Wx_left * 1000);
  Wx_right = g_strdup_printf("%.0f", plat.walkway_Wx_right * 1000);
  Wy_bottom = g_strdup_printf("%.0f", plat.walkway_Wy_bottom * 1000);
  Wy_top = g_strdup_printf("%.0f", plat.walkway_Wy_top * 1000);

  x_one_unit = plat.fan_section_AX * plat.SDD_num;
  x_total = x_one_unit * plat.unit_num + plat.gap_total + plat.walkway_Wx_left + plat.walkway_Wx_right;
  y_one_unit = plat.fan_section_AY * plat.row_num;
  y_total = y_one_unit + plat.walkway_Wy_bottom + plat.walkway_Wy_top;

  scale = calcu_scale (width, height, x_total, y_total, Wx_left, Wy_top, cr, &X_MARGIN, &Y_MARGIN);

  cairo_set_line_width (cr, NORMAL_LINE_WIDTH * 0.7);
  for(unit_num = 1; unit_num <= plat.unit_num; unit_num++)
  {
    if(unit_num == 1)
      x_base = X_MARGIN;
    else
    {
      double total_gap = 0;

      for(i = 0; i < unit_num - 1; i++)
    total_gap += strtod(g_list_nth(plat.gap_w, i)->data, NULL);

      x_base = X_MARGIN + (x_one_unit * (unit_num - 1) + total_gap) * scale;
    }
    y_base = Y_MARGIN;

    for(i = 0, x_axis = plat.X_axis; x_axis; x_axis = x_axis->next, i++)
    {
      if(i == 0)
    x = x_base;
      else
    x += plat.fan_section_AX * scale;
      y = y_base;
      cairo_move_to(cr, x, y);
      y += y_one_unit * scale;
      cairo_line_to(cr, x, y); /* vertical grid */
      cairo_stroke(cr);

      /* SDD */
      if(i != plat.SDD_num)
      {
    cairo_arrow (cr, x + plat.fan_section_AX / 2 * scale, y + plat.walkway_Wy_bottom * scale, alpha, arrow_side_length, 1, arrow_tail_length);
    cairo_save(cr);
    cairo_set_line_width (cr, BOLD_LINE_WIDTH);
    cairo_set_line_cap(cr, CAIRO_LINE_CAP_SQUARE);
    cairo_move_to(cr, x_base + plat.fan_section_AX / 2 * scale, y + plat.walkway_Wy_bottom * scale + arrow_side_length + arrow_tail_length);
    cairo_rel_line_to(cr, (x_one_unit - plat.fan_section_AX) * scale, 0);
    cairo_stroke(cr);
    cairo_restore(cr);
      }

      /* dim line for A1, A2 ... */
      cairo_move_to(cr, x, y + plat.walkway_Wy_bottom * scale + arrow_side_length + arrow_tail_length + 10);
      cairo_rel_line_to(cr, 0, 20);
      cairo_get_current_point(cr, &x3, &y3);
      if(i != plat.SDD_num)
      {
    cairo_text_align_horizontal_center (cr, AX, 0, 1, plat.fan_section_AX / 2 * scale, -10);
      }
      else
      {
    if(plat.unit_num > 1 && plat.has_gap && unit_num != plat.unit_num)
    {
      gap_value = strtod(g_list_nth(plat.gap_w, unit_num - 1)->data, NULL);
      gap = g_strdup_printf("%.0f", 1000 * gap_value);
      cairo_text_extents(cr, gap, &te);
      if(gap_value * scale < te.x_bearing + te.width)
      {
        downward = 1;
        downward_height = 11;
        downward_width = gap_value * scale;
        cairo_rel_move_to(cr, gap_value / 2 * scale - (te.x_bearing + te.width / 2), 10);
      }
      else
      {
        downward = 0;
        cairo_rel_move_to(cr, gap_value / 2 * scale - (te.x_bearing + te.width / 2), -10);
      }
      cairo_show_text(cr, gap);
      g_free(gap);
    }
    else
      downward = 0;
      }
      if(unit_num == 1 && i == 0)
      {
    cairo_move_to(cr, x - plat.walkway_Wx_left * scale, y + plat.walkway_Wy_bottom * scale + arrow_side_length + arrow_tail_length + 10);
    cairo_rel_line_to(cr, 0, 20);
    cairo_rel_move_to(cr, -25, -10);
    cairo_show_text(cr, Wx_left);
      }
      if(unit_num == plat.unit_num && i == plat.SDD_num)
      {
    cairo_move_to(cr, x + plat.walkway_Wx_right * scale, y + plat.walkway_Wy_bottom * scale + arrow_side_length + arrow_tail_length + 10);
    cairo_rel_line_to(cr, 0, 20);
    cairo_rel_move_to(cr, 3, -10);
    cairo_show_text(cr, Wx_right);
      }

      if(plat.axis_style_SDD == 0) /* 递增 */
    axis = g_strdup_printf("A%d", plat.start_axis_SDD + (unit_num - 1) * (plat.SDD_num + 1) + i);
      else
    axis = g_strdup_printf("A%d", plat.start_axis_SDD + (unit_num - 1) * (plat.SDD_num + 1) - i);
      cairo_text_extents(cr, axis, &te);
      if(!downward || ((i != plat.SDD_num) && (unit_num != 1 && i != 0)))
    cairo_move_to(cr, x3 - te.width / 2, y3 + te.height + 2);
      else
      {
    if(te.width < downward_width)
      cairo_move_to(cr, x3 - te.width / 2, y3 + te.height + downward_height);
    else
    {
      if(i == plat.SDD_num)
        cairo_move_to(cr, x3 - te.width, y3 + te.height + downward_height);
      else
        cairo_move_to(cr, x3, y3 + te.height + downward_height);
    }
      }
      cairo_show_text(cr, axis);
      g_free(axis);
      cairo_stroke(cr);

      for(j = 0, y_axis = plat.Y_axis; y_axis; y_axis = y_axis->next, j++)
      {
    x1 = x_base;
    if(j == 0)
      y1 = y_base + y_one_unit * scale;
    else
      y1 -= plat.fan_section_AY * scale;
    if(i == 0)
    {
      cairo_move_to(cr, x1, y1);
      x1 += x_one_unit * scale;
      cairo_line_to(cr, x1, y1); /* horizontal grid */
      cairo_stroke(cr);
    }

    if(i != plat.SDD_num && j != plat.row_num) /* fan ring */
    {
      cairo_arc(cr, x + plat.fan_section_AX / 2 * scale, y1 - plat.fan_section_AY / 2 * scale, plat.fan_ring_opening_D / 2 * scale, 0, 2 * PI);
      cairo_stroke(cr);
    }

    /* columns */
    if(plat.col_type == 0) /* 砼悬臂住 */
    {
      if(plat.SDD_num % 2 == 0)
      {
        if((i + 1) % 2 == plat.SDD_col_first && (j + 1) % 2 == plat.row_col_first)
        {
          cairo_arc(cr, x, y1, COLUMN_RADIUS_ASSUME * scale, 0, 2 * PI);
          cairo_fill(cr);
          cairo_stroke(cr);
        }
      }
      else
      {
        if(!plat.if_unit_symmetry || unit_num % 2 == 1)
        {
          if((i + 1) % 2 == plat.SDD_col_first && (j + 1) % 2 == plat.row_col_first)
          {
        cairo_arc(cr, x, y1, COLUMN_RADIUS_ASSUME * scale, 0, 2 * PI);
        cairo_fill(cr);
        cairo_stroke(cr);
          }
        }
        else
        {
          if((i) % 2 == plat.SDD_col_first && (j + 1) % 2 == plat.row_col_first)
          {
        cairo_arc(cr, x, y1, COLUMN_RADIUS_ASSUME * scale, 0, 2 * PI);
        cairo_fill(cr);
        cairo_stroke(cr);
          }
        }
      }
    }
    else if(plat.col_type == 1) /* 钢柱 */
    {
      cairo_save(cr);
      cairo_set_line_width (cr, 2 * NORMAL_LINE_WIDTH);
      cairo_move_to(cr, x, y1 - COLUMN_SQUARE_LEN_ASSUME / 2 * scale);
      cairo_rel_line_to(cr, 0, COLUMN_SQUARE_LEN_ASSUME * scale);
      cairo_move_to(cr, x - COLUMN_SQUARE_LEN_ASSUME / 2 * scale, y1 - COLUMN_SQUARE_LEN_ASSUME / 2 * scale);
      cairo_rel_line_to(cr, COLUMN_SQUARE_LEN_ASSUME * scale, 0);
      cairo_move_to(cr, x - COLUMN_SQUARE_LEN_ASSUME / 2 * scale, y1 + COLUMN_SQUARE_LEN_ASSUME / 2 * scale);
      cairo_rel_line_to(cr, COLUMN_SQUARE_LEN_ASSUME * scale, 0);
      cairo_stroke(cr);
      cairo_restore(cr);
    }
    else if(plat.col_type == 2) /* 砼框架柱 */
    {
      cairo_rectangle(cr, x - COLUMN_SQUARE_LEN_ASSUME / 2 * scale, y1 - COLUMN_SQUARE_LEN_ASSUME / 2 * scale, COLUMN_SQUARE_LEN_ASSUME * scale, COLUMN_SQUARE_LEN_ASSUME * scale);
      cairo_fill(cr);
      cairo_stroke(cr);
    }

    /* dim line of AA, AB ... */
    if(unit_num == plat.unit_num && i == 0)
    {
      cairo_move_to(cr, x1 + plat.walkway_Wx_right * scale + 10, y1);
      cairo_rel_line_to(cr, 20, 0);

      if(j != plat.row_num)
      {
        cairo_text_align_horizontal_center (cr, AY, 1, 1, -10, -plat.fan_section_AY / 2 * scale);
      }

      if(j == 0)
      {
        x2 = x1 + plat.walkway_Wx_right * scale + 10 + 20 - 5;
        y2 = y1 + plat.walkway_Wy_bottom * scale;

        cairo_move_to(cr, x1 + plat.walkway_Wx_right * scale + 10, y1);
        cairo_rel_move_to(cr, 0, plat.walkway_Wy_bottom * scale);
        cairo_rel_line_to(cr, 20, 0);

        cairo_rel_move_to(cr, -10, 25);
        cairo_save(cr);
        cairo_rotate(cr, - PI / 2.0);
        cairo_show_text(cr, Wy_bottom);
        cairo_restore(cr);
      }

      if(j == plat.row_num)
      {
        cairo_move_to(cr, x1 + plat.walkway_Wx_right * scale + 10, y1);
        cairo_rel_move_to(cr, 0, -plat.walkway_Wy_top * scale);
        cairo_rel_line_to(cr, 20, 0);

        cairo_rel_move_to(cr, -10, -1);
        cairo_save(cr);
        cairo_rotate(cr, - PI / 2.0);
        cairo_show_text(cr, Wy_top);
        cairo_restore(cr);
      }
      cairo_stroke(cr);
    }
    else if(unit_num == 1 && i == 0)
    {
      if(plat.axis_style_row == 0) /* 递增 */
        axis = g_strdup_printf("A%c", plat.start_axis_row + j);
      else
        axis = g_strdup_printf("A%c", plat.start_axis_row - j);
      cairo_text_extents(cr, axis, &te);
      cairo_move_to(cr, x_base - plat.walkway_Wx_left * scale - 20, y1 + te.height / 2);
      cairo_show_text(cr, axis);
      g_free(axis);
      cairo_stroke(cr);
    }
      }
    }
  }

  /* walkway line */
  x = X_MARGIN - plat.walkway_Wx_left * scale;
  y = Y_MARGIN - plat.walkway_Wy_top * scale;
  cairo_move_to(cr, x, y);
  cairo_rel_line_to(cr, x_total * scale, 0);
  cairo_rel_line_to(cr, 0, y_total * scale);
  cairo_rel_line_to(cr, -x_total * scale, 0);
  cairo_rel_line_to(cr, 0, -y_total * scale);
  cairo_stroke(cr);

  /* dim total line for A1, A2 ... */
  cairo_move_to(cr, X_MARGIN - plat.walkway_Wx_left * scale, Y_MARGIN + (y_one_unit + plat.walkway_Wy_bottom) * scale + arrow_side_length + arrow_tail_length + 10 + 20 - 5);
  cairo_rel_line_to(cr, x_total * scale, 0);
  cairo_stroke(cr);

  /* dim total line for AA, AB ... */
  cairo_move_to(cr, x2, y2);
  cairo_rel_line_to(cr, 0, -y_total * scale);
  cairo_stroke(cr);

  g_free(AX);
  g_free(AY);
  g_free(Wx_left);
  g_free(Wx_right);
  g_free(Wy_bottom);
  g_free(Wy_top);
} 
```

`expose-event`信号：

```
static gboolean ACC_GA_expose (GtkWidget *canvas, GdkEventExpose *event, gpointer user_data)
{
  cairo_t *cr;

  cr = gdk_cairo_create (canvas->window);
  if(plat.if_GA_draw)
  {
    ACC_GA_draw (cr, canvas->allocation.width, canvas->allocation.height);
  }
  else
  {
    char *local = char_to_utf8 ("Press button \"生成GA\" to update!!");

    cairo_select_font_face(cr, "Sans", CAIRO_FONT_SLANT_NORMAL, CAIRO_FONT_WEIGHT_BOLD);
    cairo_set_font_size(cr, 0.35);
    cairo_move_to(cr, 200, 200);
    cairo_show_text(cr, local);
    g_free(local);

  }
  cairo_destroy (cr);

  return FALSE;
} 
```

在 main() 函数中：

```
 .
  .
  .
  canvas = gtk_drawing_area_new();
  g_object_set_data(G_OBJECT(window), "plat_GA_canvas", canvas);
  plat.if_GA_draw = 0;
  gtk_widget_show(canvas);
  gtk_box_pack_start(GTK_BOX(sub_main_box), canvas, TRUE, TRUE, 0);
  g_signal_connect(G_OBJECT(canvas), "expose-event", G_CALLBACK(ACC_GA_expose), window);
  .
  .
  . 
```

++++++++++++++++++++++++++++++++++++++++++++++++++++++ +

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:38:30.093

GCC 3.4.5 和 GCC 4.7.2 不兼容 ABI。您需要重建所有代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T07:18:32.840

我在我的程序中发现了一个错误。错误是`expose-event`画布不止一次暴露，并且第二次崩溃。但我不知道为什么在 gcc3.4.5 或纯 Linux 环境中没有出现该错误。在我修改我的程序后，它适用于 mingw-gcc4.7.2、mingw-gcc3.4.5 和纯 Linux 环境。

另一方面，gcc4.7.2 适用于预编译的 gtk2.10.11，但在我的情况下对于预编译的 gtk2.24.10 失败。这可能是由于 ABI 问题。

我已经发布了另外 2 个帖子：[gtk window move then crash](https://stackoverflow.com/questions/15675751/gtk-window-moved-then-crash) and [compile GTK+ in MinGW, but failed](https://stackoverflow.com/questions/15588225/compile-gtk-in-mingw-but-failed)。它们或多或少与这篇文章有关。

# c# - 避免错误在目录中一次更改太多

> ID：15519089
> 
> 赞同：14
> 
> 时间：2013-03-20T08:59:36.447
> 
> 标签：c#, .net, filesystemwatcher

如何避免C#中FileSystemWatcher的错误？

> 目录中一次更改太多

我必须检测网络共享上的所有更改。InternalBufferSize 增加到 8192 * 128

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2016-02-16T12:01:29.087

你应该做两件事：

1.  设置`InternalBufferSize`为最大支持值 (65536)。您尝试将其设置为“8192 * 128”大于[文档](https://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher.internalbuffersize(v=vs.110).aspx)中列出的最大支持值，因此您可能根本没有增加缓冲区大小。
2.  将来自的事件排队`FileSystemWatcher`到后台线程进行处理。

这是这里的第二点，不是很好理解，确实应该记录在 MSDN 上。在内部，`FileSystemWatcher`将更改事件排队到您在上面设置的大小的内部缓冲区中。**然而，至关重要的是，只有在您的事件处理程序返回后**，才会从该缓冲区中删除项目。这意味着您的事件处理程序引入的每个开销周期都会增加缓冲区填满的可能性。您应该做的是尽快清除有限的队列`FileSystemWatcher`，并将事件移动到您自己的无限队列中，以您可以处理的速度进行处理，或者如果您愿意这样做，则丢弃，但周围有一些智能.

这基本上是我在代码中所做的。首先，我启动自己的调度程序线程：

```
Dispatcher changeDispatcher = null;
ManualResetEvent changeDispatcherStarted = new ManualResetEvent(false);
Action changeThreadHandler = () =>
{
    changeDispatcher = Dispatcher.CurrentDispatcher;
    changeDispatcherStarted.Set();
    Dispatcher.Run();
};
new Thread(() => changeThreadHandler()) { IsBackground = true }.Start();
changeDispatcherStarted.WaitOne(); 
```

然后我创建了观察者。请注意正在设置的缓冲区大小。就我而言，我只观察目标目录的变化，而不是子目录：

```
FileSystemWatcher watcher = new FileSystemWatcher();
watcher.Path = path;
watcher.InternalBufferSize = 64 * 1024;
watcher.IncludeSubdirectories = false; 
```

现在我附加了我的事件处理程序，但在这里我将它们调用到我的调度程序上，而不是在观察者线程中同步运行它们。是的，事件将由调度程序按顺序处理：

```
watcher.Changed += (sender, e) => changeDispatcher.BeginInvoke(new Action(() => OnChanged(sender, e)));
watcher.Created += (sender, e) => changeDispatcher.BeginInvoke(new Action(() => OnCreated(sender, e)));
watcher.Deleted += (sender, e) => changeDispatcher.BeginInvoke(new Action(() => OnDeleted(sender, e)));
watcher.Renamed += (sender, e) => changeDispatcher.BeginInvoke(new Action(() => OnRenamed(sender, e))); 
```

最后，在处理完`FileSystemWatcher`（您正在这样做，对吗？）之后，您需要关闭您的调度程序：

```
watcher.Dispose()
changeDispatcher.BeginInvokeShutdown(DispatcherPriority.Normal); 
```

就是这样。在网络和本地场景中，我自己都遇到了这个问题。使用这种方法后，我无法再次生成此错误，即使在尽可能快地将空文件敲击到监视目录时也是如此。如果您在这种情况下确实设法以某种方式耗尽了缓冲区（我不确定这是否可能，上游的 API 可能较慢），那么这里还有进一步的优化空间。但是，只要您的调度员超过了“临界点”，即发送方发布事件的速度不能比您调度它们的速度快，您就永远不会积压，因此永远不会破坏缓冲区。我相信这种方法会让你进入那个安全区域。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-08-23T17:57:16.687

我想我可能已经找到了一种可以帮助大大提高缓冲区使用率的模式。

此类的问题在于，在事件的委托完成运行之前，它无法释放用于保存该信息的内存。

对于我的一生，我不知道为什么将最大 InternalBufferSize 设置为 64Kb，但是有了这个想法，您将更有效地使用那个小缓冲区。

如果不是在委托中执行操作，而是简单地将它们排队并推迟它们的执行以供后台工作人员执行，那么它使用的内存量将大大减少。

事实上，我不知道为什么这个类本身没有首先实现这样的东西。

下面的代码只是该想法的示例代码，不应该在生产环境中使用，但它大大增加了我可以复制和跟踪的文件数量。

```
using System;
using System.Collections.Concurrent;
using System.ComponentModel;
using System.IO;
using System.Threading;
using NUnit.Framework;

namespace Soundnet.Synchronisation.FileSystemWatcherTests
{

  /// <summary>
  /// 
  /// </summary>
  [TestFixture]
  public class Tests
  {

    static readonly ConcurrentQueue<Change> ChangesQueue = new ConcurrentQueue<Change>();
    const string Destination = @"c:\Destination";
    const string Source = @"c:\Source";

    /// <summary>
    /// Tests this instance.
    /// </summary>
    [Test]
    public void Test()
    {
      var changesBackgroundWorker = new BackgroundWorker();
      changesBackgroundWorker.DoWork += ChangesBackgroundWorkerOnDoWork;
      changesBackgroundWorker.RunWorkerAsync();
      var fileSystemWatcher = new FileSystemWatcher
                                {
                                  Path = Source,
                                  EnableRaisingEvents = true,
                                  IncludeSubdirectories = true,
                                  NotifyFilter = NotifyFilters.LastWrite | NotifyFilters.LastAccess | NotifyFilters.CreationTime | NotifyFilters.FileName | NotifyFilters.DirectoryName,
                                  InternalBufferSize = 65536
                                };
      fileSystemWatcher.Created += FileSystemWatcherOnCreated;
      fileSystemWatcher.Deleted += FileSystemWatcherOnDeleted;
      fileSystemWatcher.Renamed += FileSystemWatcherOnRenamed;
      fileSystemWatcher.Error += FileSystemWatcherOnError;

      while (true)
        Thread.Sleep(1000000);
    }

    /// <summary>
    /// Changeses the background worker configuration document work.
    /// </summary>
    /// <param name="sender">The sender.</param>
    /// <param name="doWorkEventArgs">The <see cref="DoWorkEventArgs"/> instance containing the event data.</param>
    /// <exception cref="System.ArgumentOutOfRangeException"></exception>
    private static void ChangesBackgroundWorkerOnDoWork(object sender, DoWorkEventArgs doWorkEventArgs)
    {
      while (true)
      {
        Change change;
        if (ChangesQueue.TryDequeue(out change))
        {
          var backgroundWorker = new BackgroundWorker();
          switch (change.ChangeType)
          {
            case WatcherChangeTypes.Created:
              backgroundWorker.DoWork += (o, args) =>
                                          {
                                            var fileSystemType = GetFileSystemType(change.FullPath);

                                            var newItem = Path.Combine(Destination, change.Name);
                                            while (true)
                                            {
                                              try
                                              {
                                                switch (fileSystemType)
                                                {
                                                  case FileSystemType.File:
                                                    File.Copy(change.FullPath, newItem, true);
                                                    break;
                                                  case FileSystemType.Directory:
                                                    var directorySecurity =
                                                      Directory.GetAccessControl(change.FullPath);
                                                    Directory.CreateDirectory(newItem, directorySecurity);
                                                    break;
                                                  case FileSystemType.NotExistant:
                                                    break;
                                                }
                                                return;
                                              }
                                              catch (IOException exception)
                                              {
                                                Thread.Sleep(100);
                                                Console.WriteLine(exception.Message);
                                              }
                                            }
                                          };
              break;
            case WatcherChangeTypes.Deleted:
              backgroundWorker.DoWork += (o, args) =>
              {
                var itemToDelete = Path.Combine(Destination, change.Name);
                var fileSystemType = GetFileSystemType(itemToDelete);
                switch (fileSystemType)
                {
                  case FileSystemType.File:
                    File.Delete(itemToDelete);
                    break;
                  case FileSystemType.Directory:
                    Directory.Delete(itemToDelete, true);
                    break;
                }
              };
              break;
            case WatcherChangeTypes.Changed:
              backgroundWorker.DoWork += (o, args) =>
              {
                var fileSystemType = GetFileSystemType(change.FullPath);
                var newItem = Path.Combine(Destination, change.Name);
                switch (fileSystemType)
                {
                  case FileSystemType.File:
                    File.Copy(change.FullPath, newItem, true);
                    break;
                }
              };
              break;
            case WatcherChangeTypes.Renamed:
              backgroundWorker.DoWork += (o, args) =>
              {
                var fileSystemType = GetFileSystemType(change.FullPath);
                var oldItem = Path.Combine(Destination, change.OldName);
                var newItem = Path.Combine(Destination, change.Name);
                switch (fileSystemType)
                {
                  case FileSystemType.File:
                    if (File.Exists(oldItem))
                      File.Move(oldItem, newItem);
                    break;
                  case FileSystemType.Directory:
                    if (Directory.Exists(oldItem))
                      Directory.Move(oldItem, newItem);
                    break;
                }
              };
              break;
            case WatcherChangeTypes.All:
              break;
            default:
              throw new ArgumentOutOfRangeException();
          }
          backgroundWorker.RunWorkerAsync();
        }
      }
    }

    /// <summary>
    /// Files the system watcher configuration created.
    /// </summary>
    /// <param name="sender">The sender.</param>
    /// <param name="fileSystemEventArgs">The <see cref="FileSystemEventArgs"/> instance containing the event data.</param>
    private static void FileSystemWatcherOnCreated(object sender, FileSystemEventArgs fileSystemEventArgs)
    {
      ChangesQueue.Enqueue(new Change
      {
        ChangeType = WatcherChangeTypes.Created,
        FullPath = fileSystemEventArgs.FullPath,
        Name = fileSystemEventArgs.Name
      });
    }

    /// <summary>
    /// Files the system watcher configuration deleted.
    /// </summary>
    /// <param name="sender">The sender.</param>
    /// <param name="fileSystemEventArgs">The <see cref="FileSystemEventArgs"/> instance containing the event data.</param>
    private static void FileSystemWatcherOnDeleted(object sender, FileSystemEventArgs fileSystemEventArgs)
    {
      ChangesQueue.Enqueue(new Change
      {
        ChangeType = WatcherChangeTypes.Deleted,
        FullPath = fileSystemEventArgs.FullPath,
        Name = fileSystemEventArgs.Name
      });
    }

    /// <summary>
    /// Files the system watcher configuration error.
    /// </summary>
    /// <param name="sender">The sender.</param>
    /// <param name="errorEventArgs">The <see cref="ErrorEventArgs"/> instance containing the event data.</param>
    private static void FileSystemWatcherOnError(object sender, ErrorEventArgs errorEventArgs)
    {
      var exception = errorEventArgs.GetException();
      Console.WriteLine(exception.Message);
    }

    /// <summary>
    /// Files the system watcher configuration renamed.
    /// </summary>
    /// <param name="sender">The sender.</param>
    /// <param name="fileSystemEventArgs">The <see cref="RenamedEventArgs"/> instance containing the event data.</param>
    private static void FileSystemWatcherOnRenamed(object sender, RenamedEventArgs fileSystemEventArgs)
    {
      ChangesQueue.Enqueue(new Change
      {
        ChangeType = WatcherChangeTypes.Renamed,
        FullPath = fileSystemEventArgs.FullPath,
        Name = fileSystemEventArgs.Name,
        OldFullPath = fileSystemEventArgs.OldFullPath,
        OldName = fileSystemEventArgs.OldName
      });
    }

    /// <summary>
    /// Gets the type of the file system.
    /// </summary>
    /// <param name="fullPath">The full path.</param>
    /// <returns></returns>
    private static FileSystemType GetFileSystemType(string fullPath)
    {
      if (Directory.Exists(fullPath))
        return FileSystemType.Directory;
      if (File.Exists(fullPath))
        return FileSystemType.File;
      return FileSystemType.NotExistant;
    }
  }

  /// <summary>
  /// Type of file system object
  /// </summary>
  internal enum FileSystemType
  {
    /// <summary>
    /// The file
    /// </summary>
    File,
    /// <summary>
    /// The directory
    /// </summary>
    Directory,
    /// <summary>
    /// The not existant
    /// </summary>
    NotExistant
  }

  /// <summary>
  /// Change information
  /// </summary>
  public class Change
  {
    /// <summary>
    /// Gets or sets the type of the change.
    /// </summary>
    /// <value>
    /// The type of the change.
    /// </value>
    public WatcherChangeTypes ChangeType { get; set; }

    /// <summary>
    /// Gets or sets the full path.
    /// </summary>
    /// <value>
    /// The full path.
    /// </value>
    public string FullPath { get; set; }

    /// <summary>
    /// Gets or sets the name.
    /// </summary>
    /// <value>
    /// The name.
    /// </value>
    public string Name { get; set; }

    /// <summary>
    /// Gets or sets the old full path.
    /// </summary>
    /// <value>
    /// The old full path.
    /// </value>
    public string OldFullPath { get; set; }

    /// <summary>
    /// Gets or sets the old name.
    /// </summary>
    /// <value>
    /// The old name.
    /// </value>
    public string OldName { get; set; }
  }
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-03-20T09:05:13.440

从[`MSDN`](http://msdn.microsoft.com/en-us/library/system.io.filesystemwatcher%28v=vs.85%29.aspx);

> Windows 操作系统会通知您的组件在由`FileSystemWatcher`. 如果短时间内有很多变化，缓冲区可能会溢出。这会导致组件丢失对目录更改的跟踪，并且它只会提供一揽子通知。使用该属性增加缓冲区的大小`InternalBufferSize`是昂贵的，因为它来自无法换出到磁盘的非分页内存，因此请保持缓冲区小而大，以免错过任何文件更改事件。为避免缓冲区溢出，请使用`NotifyFilter`和 `IncludeSubdirectories`属性，以便过滤掉不需要的更改通知。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-20T09:03:16.073

我的经验是 FileSystemWatcher 并不总是最可靠的使用方法。您可以指定过滤器来缩小您正在观看的文件 (NotifyFilter)，或增加缓冲区大小。

但是根据您的要求，您可能还想以另一种方式进行操作，例如每 x 秒轮询一次以获取文件列表。但是，您可能需要告诉我们更多关于您的业务案例的信息。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-06-11T08:37:28.153

如果您增加缓冲区大小，它应该被修复，但这不是一个实际的解决方案。因为要确保它始终记录使缓冲区变大所需的所有内容。这将极大地影响性能。我认为性能问题可以通过实现多线程来解决。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T11:44:50.207

SHChangeNotifyRegister 可用于获取 shell 通知。

# java - 如何使用 java ProcessBuilder 以访客或受限用户身份运行可执行文件

> ID：15519093
> 
> 赞同：0
> 
> 时间：2013-03-20T08:59:45.637
> 
> 标签：java, windows, security, privileges, processbuilder

假设我以管理员身份运行，并且我的 ac 可执行文件为“myProgram.exe”。我想在我的 java 程序中使用 ProcessBuilder 执行它。

例如

```
ProcessBuilder pb = new ProcessBuilder("myProgram.exe");
pb.start(); 
```

如何以特权较低的用户或来宾用户的身份执行“myProgram.exe”？

我为什么要这样做？

假设 exe (myProgram.exe) 尝试删除一些它不应该删除的文件或执行一些其他活动，然后在权限较低的用户下运行它将不允许它执行上述操作。

基本上我想在**监狱**中或以较少的权限运行这个“myProgram.exe”。

如何以编程方式以特权较低的用户身份执行“myProgram.exe”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:27:08.863

好吧，您需要一个`sand box`then.. 它是一个可执行文件，可以在权限不足的设置中执行另一个可执行文件..

见这里：[http ://www.sandboxie.com/index.php?StartCommandLine](http://www.sandboxie.com/index.php?StartCommandLine)

# javascript - 捕获所有路由参数

> ID：15519096
> 
> 赞同：2
> 
> 时间：2013-03-20T08:59:48.567
> 
> 标签：javascript, angularjs, url-routing

我有一个这样的网址：`http://foo.bar/#/some/other/path`

如何将“some/other/path”捕获为路由参数？

我试过这个：

```
var App = angular.module("App", [])
  .config(function($routeProvider){
    $routeProvider
      .when('/:path', { controller: ListCtrl, templateUrl: 'list.html'})
      .otherwise({ redirectTo: '/'})
  }); 
```

但`:path`只是给我`some`而不是`some/other/path`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T22:03:35.547

正如 Stewie 在上面的评论中提到的，Angular 不稳定 1.1.3 现在支持通过使用星号来捕获所有内容。

例如：

```
var App = angular.module("App", [])
  .config(function($routeProvider){
    $routeProvider
      .when('/*path', { controller: ListCtrl, templateUrl: 'list.html'})
      .otherwise({ redirectTo: '/'})
  }); 
```

部分字符串匹配——例如匹配`jpg`url 中的实例——似乎仍然不受支持。

# asp.net - 如何检测页面未使用超过 10 分钟？

> ID：15519100
> 
> 赞同：0
> 
> 时间：2013-03-20T09:00:07.400
> 
> 标签：asp.net, session-timeout

我想通过每 10 分钟刷新一次页面来将会话设置为无限制。

所以我必须知道页面现在正在使用还是不使用？

我的刷新代码工作正常：

```
 string _CurUrl = Request.RawUrl.ToString();
 Response.AppendHeader("Refresh", "600; URL=" + _CurUrl  + ""); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:12:14.050

有各种 jQuery 插件用于检测用户是否空闲。

[jQuery idleTimer 插件](http://paulirish.com/2009/jquery-idletimer-plugin/)- Paul Irish（[GitHub 上的代码](https://github.com/paulirish/jquery-idletimer/)）

[jQuery 空闲超时插件](http://www.erichynds.com/jquery/a-new-and-improved-jquery-idle-timeout-plugin/)- Eric Hynds（[GitHub 上的代码](https://github.com/ehynds/jquery-idle-timeout)）

[自动超时插件](http://philpalmieri.com/2009/09/jquery-session-auto-timeout-with-prompt/)- Philip Almieri（[GitHub 上的代码](https://github.com/philpalmieri/jquery-idleTimeout)）

[谷歌搜索结果](https://www.google.co.uk/search?q=jquery%20page%20timeout&aq=f&oq=jquery%20page%20timeout&aqs=chrome.0.57j0l2j62l3.7912&sourceid=chrome&ie=UTF-8#hl=en&sclient=psy-ab&q=jquery%20idle%20timeout%20plugin&oq=jquery%20idle%20timeout%20plugin&gs_l=serp.12...0.0.1.4057.0.0.0.0.0.0.0.0..0.0...0.0...1c..7.psy-ab.fvsLvIz5EY4&pbx=1&bav=on.2,or.r_cp.r_qf.&bvm=bv.44011176,d.d2k&fp=bd1126af0f726197&biw=1440&bih=815)更多解决方案。

我会使用其中之一，而不是尝试自己编写已经存在的东西。但是，您必须自定义在检测到 TimeOut 以刷新页面时发生的事件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:41:35.240

您应该按照 nunespascal 的建议跟踪 keyPress 和 mouseMove 事件 -

链接在这里。这可能会帮助你

[http://forums.asp.net/t/1312010.aspx](http://forums.asp.net/t/1312010.aspx)

# c# - 等效于 Winforms DatagridView 中的 DataGrid RowDetails 模板

> ID：15519103
> 
> 赞同：0
> 
> 时间：2013-03-20T09:00:16.377
> 
> 标签：c#, wpf, winforms, datagrid, datagridview

我需要在我的 datagridview 中创建一个扩展器，在选中时将有关该行的附加信息添加到 datagridview 中，并在折叠时隐藏相同的信息。

这可以通过在 WPF 中创建 RowDetails 模板来实现，但是我可以在 winforms datagridview 中做类似的事情吗？我想到的一种解决方法是在展开/折叠时动态地将对象添加到 datagridview，但在这种情况下它不起作用，因为详细信息行的列的数量、类型和排列与数据行有很大不同。

RowTemplate 可能有帮助吗？到目前为止，我看到的所有示例都仅使用 rowtemplate 来修复 datagridview 中行的高度、宽度等，仅此而已。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:18:24.567

如果要显示其他数据信息，可以对选定行使用 ToolTip。

# c# - 时间：2019-03-01 标签：c#DataGridView&oledb

> ID：15519107
> 
> 赞同：0
> 
> 时间：2013-03-20T09:00:23.153
> 
> 标签：c#, winforms, datagridview, oledb

我在 MS Access 中有一个数据库。
我正在将数据库中的数据放在表单加载时的 datagridview 中。

```
 string connectionString = "Provider=Microsoft.Jet.OleDb.4.0; Data Source=" + Application.StartupPath + "/Db.mdb";
        OleDbConnection conObj = new OleDbConnection(connectionString);
        conObj.Open();
        DataSet ds = new DataSet();
        DataTable dt = new DataTable();
        ds.Tables.Add(dt);
        OleDbDataAdapter da = new OleDbDataAdapter();
        da = new OleDbDataAdapter("SELECT * FROM StopMaster", conObj);
        da.Fill(dt);
        dataGridView1.DataSource = dt.DefaultView;
        conObj.Close(); 
```

在执行时，它将显示带有数据库中项目的datagridview，
以及一个空行，我们可以在其中添加新数据，如果我们单击现有行的数据项，我们可以更新它甚至删除它

如何为该更新编写代码删除和添加并反映到数据库是否有任何事件或者我
如何使数据网格视图列不可调整大小。

还说，当我单击列标题时，如果我在 datagridview 中有两列“name”和“pin code”，现在说“pin code”，它必须对 datagridview 行进行排序，以便
有任何事件以及如何处理

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:20:32.290

首先要提到的是，您需要将数据表绑定到 Datagridview。这样您在编辑 DataGridView 控件时所做的任何更改都会直接反映到基础 DataTable。

我假设您已经填充了 DataTable 对象。

您首先创建 BindingSource 对象：-

```
BindingSource bs = new BindingSource();

bs.Datasource = dt; 
```

现在我们需要将此绑定对象作为 DataGridView 控件的数据源：-

```
dataGridView1.DataSource = bs; 
```

在方法中，您可以使用以下代码提交更改：-

```
using (OleDbConnection con = new OleDbConnection(connectionString))
                {
                    var adaptor = new OleDbDataAdapter();
                    adaptor.SelectCommand = new OleDbCommand(""SELECT * FROM [StopMaster]", con);

                var cbr = new OleDbCommandBuilder(adaptor);

                cbr.GetDeleteCommand();
                cbr.GetInsertCommand();
                cbr.GetUpdateCommand();

                try
                {
                    con.Open();
                    adaptor.Update(dt);
                }
                catch (OleDbException ex)
                {
                    MessageBox.Show(ex.Message, "OledbException Error");
                }
                catch (Exception x)
                {
                    MessageBox.Show(x.Message, "Exception Error");
                }
            } 
```

# asp-classic - 经典的 asp 替换 pre 标签内

> ID：15519115
> 
> 赞同：-2
> 
> 时间：2013-03-20T09:00:45.873
> 
> 标签：asp-classic, vbscript

我喜欢以下从 html 表单获取的文本。现在我想将它保存到数据库中。在保存之前，我需要解析换行符替换`<BR />`标签。

我只需要替换`<pre>`标签外的文本并将文本保留在`<pre></pre>`标签内。

这是我目前拥有的：

```
 strTxt="aaaaaaaaaaaa
    bbbbbbbbbbb
     <pre>
      sss ssss
      sss ddd
     </pre>
    asdafdsf
    sfsfsdf
     <pre>
      sfdsf
      sdfs
     </pre>
    asfasfsaf" 
```

我希望结果是：

```
strTxt="aaaaaaaaaaaa<br />
    bbbbbbbbbbb<br />
     <pre>
      sss ssss
      sss ddd
     </pre>
    asdafdsf<br />
    sfsfsdf<br />
     <pre>
      sfdsf
      sdfs
     </pre>
    asfasfsaf" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T15:05:50.357

一般来说，在处理像 HTML 这样的结构化文本时不应该使用字符串操作，但这`<pre>`是一种特殊的 - 不是嵌套的 - 情况。所以你可以逃脱：

```
Function BrNonPre(sAll)
  Dim csDelim : csDelim = "pre>" & vbCrLf
  Dim aAll    : aAll    = Split(sAll, csDelim)
  Dim i
  For i = 0 To UBound(aAll) Step 2
      aAll(i) = Replace(aAll(i), vbCrLf, "<br />" & vbCrLf)
  Next
  BrNonPre = Join(aAll, csDelim)
End Function 
```

样本输出：

```
=======================
aaaaaaaaaaaa
bbbbbbbbbbb
<pre>
  sss ssss
  sss ddd
</pre>
asdafdsf
sfsfsdf
<pre>
  sfdsf
  sdfs
</pre>
asfasfsaf
----------
aaaaaaaaaaaa<br />
bbbbbbbbbbb<br />
<pre>
  sss ssss
  sss ddd
</pre>
asdafdsf<br />
sfsfsdf<br />
<pre>
  sfdsf
  sdfs
</pre>
asfasfsaf
======================= 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:41:33.010

你可以像这样硬编码

```
 <%
 dim strTxt
 strTxt="aaaaaaaaaaaa<br />" & vbCrLf
 strTxt=strTxt & "bbbbbbbbbbb" & vbCrLf
 strTxt=strTxt & "<pre>" & vbCrLf
 strTxt=strTxt & "sss ssss" & vbCrLf
 strTxt=strTxt & "sss ddd" & vbCrLf
 strTxt=strTxt & "</pre>" & vbCrLf
 strTxt=strTxt & "asdafdsf<br />" & vbCrLf
 strTxt=strTxt & "sfsfsdf" & vbCrLf
 strTxt=strTxt & "<pre>" & vbCrLf
 strTxt=strTxt & "sfdsf" & vbCrLf
 strTxt=strTxt & "sdfs" & vbCrLf
 strTxt=strTxt & "</pre>" & vbCrLf
 strTxt=strTxt & "asfasfsaf"

 Response.Write(strTxt)
 %> 
```

# select - 在 ember 中选择不加载数据 - 有工作示例吗？

> ID：15519121
> 
> 赞同：2
> 
> 时间：2013-03-20T09:00:59.770
> 
> 标签：select, ember.js

我是 Ember JS 的新手，我正在尝试弄清楚如何创建 Ember.Select 以允许为用户创建新工作。

这是我的 form.handlebars 代码的一部分：

```
{{view Ember.Select viewName="job-user"
            contentBinding="users"
            optionLabelPath="content.name"
            optionValuePath="content.id"

            }} 
```

我在 JobsNewController 里面：

```
JP.JobsNewController = Ember.ObjectController.extend({
    needs: ['users'],
    users: [],
    usersBinding: "controllers.users"

}); 
```

这就是我的 UsersController 的样子：

```
JP.UsersController =  Ember.ArrayController.extend(); 
```

当我从填充了 UserController 的屏幕转到 newJob 屏幕时，它正在工作，但是当我直接转到 jobs/new 时，它无法用数据填充选择。如何强制 Ember 加载此选择的数据？

* * *

编辑：我必须正确设置路线：

```
JP.JobsNewRoute = Ember.Route.extend( JP.JobsFormable, {
    model: function() {
        return JP.Job.createRecord();
    },
    setupController:function(controller,model) {
        this._super(controller,model);
        controller.set('usersForSelect', JP.User.find());
    }
}); 
```

而且我还修改了表格：

```
{{view Ember.Select viewName="job-user"
   contentBinding="usersForSelect"
   optionLabelPath="content.name"
   optionValuePath="content.id"
}} 
```

感谢@mavilein 的提示

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:44:20.293

当您`JobsNewRoute`从 URL 访问时，`UsersController`不会填充 。所以绑定`users`到内容是没有用的，因为`JobsNewController`它是空的并且没有被填充。`UsersController``UsersController`

您可以通过两种方式解决此问题，两者都在`JobsNewRoute`.

第一种方式，更新你`JobsNewRoute`的填写`UsersController`：

```
JP.JobsNewRoute = Ember.Route.extend({
  setupController: function(controller, model) {
    this.controllerFor('users').set('content', JP.User.find());
  }
}); 
```

另一种方法是删除和之间的绑定`JobsNewController.users`，并简单地`UsersController`填写：`JobsNewController.users``JobsNewRoute`

```
JP.JobsNewController = Ember.ObjectController.extend({
  users: []
});

JP.JobsNewRoute = Ember.Route.extend({
  setupController: function(controller, model) {
    controller.set('users', JP.User.find());
  }
}); 
```

# java - 如何为 Spring Security 方法编写 TestNG

> ID：15519122
> 
> 赞同：4
> 
> 时间：2013-03-20T09:01:01.983
> 
> 标签：java, unit-testing, spring-security, testng

这就是我的弹簧安全方法：

```
@Override
    public boolean hasPermission(Authentication authentication, Object targetDomainObject, Object permission)
    {
        logger.trace(String.format("hasPermission() - \nAuthentication - %s\nObject - %s\nPermission Reqd - %s",
                authentication.toString(), targetDomainObject.toString(), permission.toString()));

        UserDetails principal = (UserDetails) authentication.getPrincipal();

        for (GrantedAuthority authority : principal.getAuthorities()) {
            if(authority.getAuthority().equalsIgnoreCase((String)permission)) {
                logger.debug("Allowing user to perform operation");
                logger.debug("Setting userId {} in the RO", principal.getUsername());
                if(targetDomainObject.getClass().isArray()) {
                    AbstractRO[] domainObjectArray = (AbstractRO[]) targetDomainObject;
                    for (AbstractRO abstractRO : domainObjectArray) {
                        abstractRO.setUserId(principal.getUsername());
                    }
                }
                return true;
            }
        }
        logger.debug("Dis-allowing user to perform operation. User does not have '{}' granted authority.", permission);
        return false;
    } 
```

我称这个函数如下：

```
@PreAuthorize("isAuthenticated() and hasPermission(#request, 'CREATE_REQUISITION')")
    @RequestMapping(method = RequestMethod.POST, value = "/trade/createrequisition")
    public
    @ResponseBody
    void createRequisition(@RequestBody CreateRequisitionRO[] request); 
```

这就是我的 testNG 类：

```
package in.hexgen.api.facade;

import javax.annotation.Resource;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.security.core.Authentication;
import org.testng.annotations.Test;

import com.hexgen.api.facade.security.HexGenPermissionEvaluator;

public class HexGenPermissionEvaluatorTest {
     private static final Logger logger = LoggerFactory.getLogger(HexGenPermissionEvaluatorTest.class);

  Object name="akash";
  Object permission="CREATE_REQUISITION";
  Authentication authentication;

  @Resource(name = "permissionEval")
  private HexGenPermissionEvaluator permissionEval;

  @Test
  public void hasPermission() {
      //authentication.setAuthenticated(true);

      logger.debug("HexGenPermissionEvaluator Generate - starting ...");
         permissionEval.hasPermission(authentication,name, permission);
      logger.debug("HexGenPermissionEvaluator Generate - completed ...");
  }

} 
```

但是当我运行测试时我得到了这个异常

```
FAILED: hasPermission
java.lang.NullPointerException
    at in.hexgen.api.facade.HexGenPermissionEvaluatorTest.hasPermission(HexGenPermissionEvaluatorTest.java:30)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.testng.internal.MethodInvocationHelper.invokeMethod(MethodInvocationHelper.java:80)
    at org.testng.internal.Invoker.invokeMethod(Invoker.java:714)
    at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:901)
    at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1231)
    at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:128)
    at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:111)
    at org.testng.TestRunner.privateRun(TestRunner.java:767)
    at org.testng.TestRunner.run(TestRunner.java:617)
    at org.testng.SuiteRunner.runTest(SuiteRunner.java:334)
    at org.testng.SuiteRunner.runSequentially(SuiteRunner.java:329)
    at org.testng.SuiteRunner.privateRun(SuiteRunner.java:291)
    at org.testng.SuiteRunner.run(SuiteRunner.java:240)
    at org.testng.SuiteRunnerWorker.runSuite(SuiteRunnerWorker.java:52)
    at org.testng.SuiteRunnerWorker.run(SuiteRunnerWorker.java:86)
    at org.testng.TestNG.runSuitesSequentially(TestNG.java:1203)
    at org.testng.TestNG.runSuitesLocally(TestNG.java:1128)
    at org.testng.TestNG.run(TestNG.java:1036)
    at org.testng.remote.RemoteTestNG.run(RemoteTestNG.java:111)
    at org.testng.remote.RemoteTestNG.initAndRun(RemoteTestNG.java:204)
    at org.testng.remote.RemoteTestNG.main(RemoteTestNG.java:175) 
```

我犯了什么错误，请帮助我找到并解雇罪魁祸首。

此致

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-22T09:27:47.413

您需要手动设置一个[Authentication](http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/core/Authentication.html)对象并将其设置在全局[SecurityContextHolder](http://static.springsource.org/spring-security/site/docs/3.0.x/apidocs/org/springframework/security/core/context/SecurityContextHolder.html)中。您可以在类的测试方法之前、每个方法之前或作为每个测试方法的一部分移动初始化。

```
@Before
public void setupAuth(){
    //password actually doesn't matter, meanwhile GrantedAuthorities should be necessary,
    //if you are using built-in checking functions such as "hasAnyRole" etc.
    List<GrantedAuthority> grantedAuthorities = Collections.emptyList();
    authentication = new UsernamePasswordAuthenticationToken(name, null, grantedAuthorities);

    //set authentication into static security context for proper handling by annotations
    SecurityContextHolder.getContext().setAuthentication(authentication);   
} 
```

**编辑**：OP 提供了有趣的[资源](http://sinossisoftware.blogspot.in/2011/07/testing-methods-secured-with-spring.html)，上面描述的方法与[IInvokedMethodListener](http://testng.org/javadoc/org/testng/IInvokedMethodListener.html)一起工作，它允许对`Authentication`对象进行基于注释的控制。

# jmeter - 使用 JMeter 的同时 SOAP 请求

> ID：15519124
> 
> 赞同：0
> 
> 时间：2013-03-20T09:01:07.767
> 
> 标签：jmeter

我们有如下测试计划：

```
Test Plan
    Thread Group 
        SOAP/XML-RPC Request 1
        SOAP/XML-RPC Request 2
        SOAP/XML-RPC Request 3 
```

当我们的服务在某一天负载很大时出现问题。我们希望每秒加载测试请求/响应，在 20 分钟到 1 小时内从 500 到 10,000 个请求不等。

例如，将线程值设置为 1200 只会给我们大约每秒 60 个。任何帮助提高这个价值的人都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T13:35:01.990

> 在 20 分钟到 1 小时内处理 500 到 10,000 个请求。

您是指每秒 500 到 10,000 个请求，或者例如 30 分钟内 10,000 个请求，即每秒 5 个请求多一点？

我您正在启动 1200 个线程并且每秒收到的请求不超过 60 个，这可能不是 JMeter 限制吞吐量。如果您确定系统可以管理更高的吞吐量（因此这不是服务硬件问题），那么我会检查负载生成服务器和服务之间的网络容量是否存在瓶颈。

# php - 从多维数组中删除重复对象

> ID：15519128
> 
> 赞同：1
> 
> 时间：2013-03-20T09:01:21.843
> 
> 标签：php, arrays, multidimensional-array, duplicates

嗨，我有如下所示的多维 php 数组，我只是想从这个数组中删除重复的对象。他们无论如何要在 php 中执行此操作吗？我只需要删除重复的 stdClass 对象。

```
 Array
(
    [0] => stdClass Object
        (
            [term_id] => 5
            [name] => 4x4
            [slug] => 4x4
        [term_group] => 0
        [term_taxonomy_id] => 5
        [taxonomy] => ptd_vehicle_sub_cat
        [description] => 
        [parent] => 0
        [count] => 2
    )

[1] => stdClass Object
    (
        [term_id] => 4
        [name] => Ultra High Performance
        [slug] => ultra-high-performance
        [term_group] => 0
        [term_taxonomy_id] => 4
        [taxonomy] => ptd_vehicle_sub_cat
        [description] => 
        [parent] => 0
        [count] => 2
    )

[2] => stdClass Object
    (
        [term_id] => 5
        [name] => 4x4
        [slug] => 4x4
        [term_group] => 0
        [term_taxonomy_id] => 5
        [taxonomy] => ptd_vehicle_sub_cat
        [description] => 
        [parent] => 0
        [count] => 2
    )

[3] => stdClass Object
    (
        [term_id] => 4
        [name] => Ultra High Performance
        [slug] => ultra-high-performance
        [term_group] => 0
        [term_taxonomy_id] => 4
        [taxonomy] => ptd_vehicle_sub_cat
        [description] => 
        [parent] => 0
        [count] => 2
    )

) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:05:27.673

保持简单......所需要的只是：

```
$list = array();
foreach ( $data as $item ) {
    isset($list[$item->term_id]) or $list[$item->term_id] = $item;
}

print_r($list); //duplicate removed 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T09:10:10.303

试试这个 ：

```
$array = array_map("unserialize", array_unique(array_map("serialize", $array))); 
```

这是完整的代码：

```
$array  =  array( array(
                    "term_id" => 5,
                    "name" => "4x4",
                    "slug" => "4x4",
                    "term_group" => 0,
                    "term_taxonomy_id" => 5,
                    "taxonomy" => "ptd_vehicle_sub_cat",
                    "description" => 0,
                    "parent" => 0,
                    "count" => 2,
                 ),
                 array(
                    "term_id" => 4,
                    "name" => "Ultra High Performance",
                    "slug" => "ultra-high-performance",
                    "term_group" => 0,
                    "term_taxonomy_id" => 4,
                    "taxonomy" => "ptd_vehicle_sub_cat",
                    "description" => 0,
                    "parent" => 0,
                    "count" => 2,
                ),
                 array(
                    "term_id" => 5,
                    "name" => "4x4",
                    "slug" => "4x4",
                    "term_group" => 0,
                    "term_taxonomy_id" => 5,
                    "taxonomy" => "ptd_vehicle_sub_cat",
                    "description" => 0,
                    "parent" => 0,
                    "count" => 2
                ),
                 array(
                    "term_id" => 4,
                    "name" => "Ultra High Performance",
                    "slug" => "ultra-high-performance",
                    "term_group" => 0,
                    "term_taxonomy_id" => 4,
                    "taxonomy" => "ptd_vehicle_sub_cat",
                    "description" => 0,
                    "parent" => 0,
                    "count" => 2
                )
);

$array = array_map("unserialize", array_unique(array_map("serialize", $array)));

echo "<pre>";
print_r($array); 
```

输出 ：

```
Array
(
    [0] => Array
        (
            [term_id] => 5
            [name] => 4x4
            [slug] => 4x4
            [term_group] => 0
            [term_taxonomy_id] => 5
            [taxonomy] => ptd_vehicle_sub_cat
            [description] => 0
            [parent] => 0
            [count] => 2
        )

    [1] => Array
        (
            [term_id] => 4
            [name] => Ultra High Performance
            [slug] => ultra-high-performance
            [term_group] => 0
            [term_taxonomy_id] => 4
            [taxonomy] => ptd_vehicle_sub_cat
            [description] => 0
            [parent] => 0
            [count] => 2
        )

) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:04:10.433

查看[`array_filter()`](http://www.php.net/manual/en/function.array-filter.php)功能。它应该为您提供一个良好的起点。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:15:23.103

试试这个：

```
$array = array_intersect_key($array, array_unique(array_map('serialize', $array))); 
```

我的方式比@PrasanthBendra 更好，因为对象不会重新创建。:^) 但我更喜欢@Baba 方式。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T09:18:40.060

你可以试试这个：

```
foreach($array as $key=>$obj) {     
 $skey = implode(",",$obj);
 if(!isset($check[$skey])) {
  $new_array[$key]=$obj;
  $check[$skey]=1;
 }
} 
```

这应该使数组 $new_array 没有重复。

这是一个更好的方法：

```
$array = array_intersect_key($array, array_unique(array_map('serialize', $array))); 
```

# mysql - 缓存 mysql 数据库表

> ID：15519134
> 
> 赞同：0
> 
> 时间：2013-03-20T09:01:40.547
> 
> 标签：mysql, innodb

我有一个很大的 mysql (innodb) 表，它有大约 300 万行......我的 vps 主机有 3gb 的 RAM ......

有什么方法可以将此表发送到 RAM 内存，以便我可以加快从该数据库获取信息的速度？

我已经“调整”了我的 mysql，以便我可以在缓存中获取高达 512mb 的键....但主要问题是只有在获取此行后我才会缓存它....但是我如何缓存所有表，还是“一键”发送到RAM内存？

我读了一些关于mysql的内存类型，但我必须一直有数据，但在服务器重新启动时不要删除....

那么如何将mysql表发送到RAM内存呢？

# file - 在 Linux 和 Mac OS X 上使用多个进程安全地写入和读取同一个文件

> ID：15519139
> 
> 赞同：1
> 
> 时间：2013-03-20T09:02:06.143
> 
> 标签：file, file-io, io, inode

我有三个设计为在 Linux 和 Mac OS X 环境中持续运行的进程。一个进程（下载程序）每 30 秒下载并存储一个大型 XML 文件的本地副本。另外两个进程（Worker）使用存储的 XML 文件进行输入。每个 Worker 随机启动和运行。由于 XML 文件很大，因此下载需要很长时间。工人也需要很长时间来阅读和解析它。

设置进程的最安全方法是什么，以便在工作人员尝试读取文件时，下载程序不会破坏存储的文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:02:06.143

对于使用基于[inode](http://en.wikipedia.org/wiki/Inode)的文件系统的 Linux 和 Mac OS X 机器，在下载数据时使用临时文件来存储数据（并且是不完整的状态）。下载完成后，使用原子操作将临时文件移动到其最终位置。

更详细一点，当一个进程（例如 Downloader）写入一个被其他进程（例如 Workers）主动读取的文件时，有两件主要的事情需要注意：

1.  确保在下载器完成写入文件之前，Worker 不会尝试读取文件。
2.  确保下载器在工作人员读取文件时不会更改文件。

使用临时文件可以满足这两点。

举个更具体的例子，当下载器主动拉取 XML 文件时，让它写入将存储最终文件的同一设备/磁盘*上的临时位置（例如“data-storage.tmp”）。一旦文件被完全下载并写入，让下载器通过一个[原子（又名可线性化）](http://en.wikipedia.org/wiki/Linearizability)重命名命令（如 bash 的`mv`.

**请注意，临时文件需要与最终文件位置位于同一设备上的原因是为了确保 inode 编号保持不变并且可以原子地进行重命名。*

这种方法确保在下载/写入文件时，Worker 不会看到它，因为它位于 .tmp 位置。由于重命名与 inode 一起工作的方式，它还确保打开文件的任何 Worker 继续看到旧内容，即使放置了新版本的数据存储文件。

下载器在重命名时会将“data-storage.xml”指向一个新的 inode 编号，但 Worker 将继续从之前的 inode 编号访问“data-storage.xml”，从而继续在该状态下处理文件. 同时，任何在 Downloader 完成重命名后打开新副本“data-storage.xml”的 Worker 都将看到来自新 inode 编号的内容，因为它现在是文件系统中直接引用的内容。因此，两个 Worker 可以从相同的文件名 (data-storage.xml) 中读取，但每个 Worker 都会看到文件内容的不同（和完整）版本，这取决于文件名首次打开时指向的 inode .

为了看到这一点，我在[github](https://github.com/alanwsmith/examples--multiprocess-file-sharing)上创建了一组简单的示例脚本来演示此功能。它们还可用于测试/验证使用临时文件解决方案是否适用于您的环境。

* * *

*重要的一点是，重要的是特定设备上的文件系统。如果您使用的是 Linux 或 Mac 机器，但使用的是 FAT 文件系统（例如，USB 拇指驱动器），则此方法不起作用。*

# gpu - 在 GPU 上绘制与分辨率无关的三次贝塞尔曲线（Blinn/Loop）

> ID：15519142
> 
> 赞同：6
> 
> 时间：2013-03-20T09:02:11.447
> 
> 标签：gpu, resolution, bezier, cubic

基于以下资源，我一直在尝试在 GPU 上实现与分辨率无关的三次贝塞尔渲染：

[GPU 宝石 3 第 25 章](http://http.developer.nvidia.com/GPUGems3/gpugems3_ch25.html)

[曲线蓝调](http://www.mdk.org.pl/2007/10/27/curvy-blues)

[使用可编程图形硬件的分辨率无关曲线渲染](http://research.microsoft.com/en-us/um/people/cloop/LoopBlinn05.pdf)

但正如 Curvy Blues 网站所述，其他两个网站上的文件存在错误。Curvy Blues 让我查看评论，但我似乎无法找到这些评论。另一个论坛告诉我同样的情况，我不记得那个论坛是什么。但肯定有一些我想念的东西。

无论如何，我试图重新生成正在发生的事情，但我无法理解根据变换坐标组合的行列式计算判别式的部分。

所以我有原始坐标，我把它们放在一个 4x4 矩阵中，用 M3 矩阵变换这个矩阵并得到 C 矩阵。然后我从 C 矩阵中的坐标创建 3x3 矩阵并计算行列式，然后可以将它们组合以创建有助于我找到根的二次方程的 a、b 和 c。

问题是，当我完全这样做时：判别式不正确。我清楚地输入了蛇纹石的坐标（对称的，但正确的蛇纹石），但它说它是一个尖点。当我使用 wxMaxima 自己计算它，推导一阶和二阶，然后计算叉积，简化为二次方程时，当我输入相同的坐标时，该方程的判别式似乎是正确的。当我强制代码使用我自己的判别式来确定它是否是蛇形时，但我使用行列式来计算进一步的 k,l,m 纹理坐标，结果也是不正确的。所以我认为行列式中一定有错误。

谁能帮我解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T13:55:51.590

我想我已经设法解决了。结果接近完美（有时是倒置的，但这可能是一个不同的问题）。

这就是我出错的地方，我希望我能帮助其他人不要浪费我一直在浪费时间寻找这个。

我的代码基于 blinn-phong 文档。我有坐标 b0、b1、b2、b3。我曾经用 aw 将它们视为 2D 坐标，但我改变了这个视图，这解决了问题。通过将它们视为 z = 0 的 3D 坐标，并使它们成为同质的 4D 坐标以进行变换 (w = 1)，解决方案就来了。

通过计算 C 矩阵：C = M3 * B，我得到了这些新坐标。在计算行列式 d0、d1、d2、d3 时，我曾经从 C 矩阵的第 0 列和第 1 列中获取 x、y 坐标，并从第 2 列中获取 w 因子。错误！当您想到它时，坐标实际上是 3D 坐标，因此，对于 w 因子，应该取第 3 列而忽略第 2 列。

这给了我正确的行列式，从而产生了一个能够区分我正在处理的曲线类型的判别式。

但请注意，使我的搜索时间更长的原因是，我假设当它明显是蛇形时，判别式的结果应该总是 > 0（蛇形）。但情况并非总是如此，当你有一个数学上完美的 septine（坐标使得平均值正好在中间）时，行列式会说它是一个尖点（行列式 = 0）。我曾经认为这个结果是错误的，但事实并非如此。所以不要被这个愚弄了。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-30T02:00:28.933

GPU Gem 3 这本书有错误，[nVidia 网站上的页面](http://http.developer.nvidia.com/GPUGems3/gpugems3_ch25.html)也有错误：

> ```
> a3 = b2 * (b1 x b1) 
> ```

它实际上是`a3 = b2 * (b1 x b0)`。

这个算法还有一个问题：在计算过程中浮点的exp部分会溢出，所以你应该小心，在你的代码中添加规范化操作。

# asp.net - 如何在 VB 中为 SQL 查询动态设置正确的日期格式

> ID：15519149
> 
> 赞同：1
> 
> 时间：2013-03-20T09:02:27.753
> 
> 标签：asp.net, sql, vb.net, visual-studio-2008, date-format

您好，我有一个使用日期格式的 sql 查询。此代码将在不同的服务器上运行，但每个服务器都有不同的日期格式。有时是 yyyy-MM-dd，有时是 yyyy-dd-MM。我试图阅读用户语言来选择正确的查询。但它不能正常工作。你知道解决我的问题的任何其他好的解决方案吗？

提前致谢

```
 Dim Systemsprache as String 
 Systemsprache = Request.UserLanguages(0)
 If String.Compare(Systemsprache, "de-DE") = 0 Then
                sqlcmd = "SELECT convert(varchar(8) , [VON],108) as [VON]  ,convert(varchar(8) , [BIS],108) as [BIS] FROM [RESERVIERUNGRAUM]  where RAUM_ID =" + hCurrRaumID.Value + " and VON >='" + Date.Parse(wiDateVON1.Value).ToString("yyyy-MM-dd") + "' and BIS <'" + Date.Parse(wiDateVON1.Value).AddDays(1).ToString("yyyy-MM-dd") + "'"

            Else
                sqlcmd = "SELECT convert(varchar(8) , [VON],108) as [VON]  ,convert(varchar(8) , [BIS],108) as [BIS] FROM [RESERVIERUNGRAUM]  where RAUM_ID =" + hCurrRaumID.Value + " and VON >='" + Date.Parse(wiDateVON1.Value).ToString("yyyy-dd-MM") + "' and BIS <'" + Date.Parse(wiDateVON1.Value).AddDays(1).ToString("yyyy-dd-MM") + "'"
            End If 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:24:21.317

如果我没记错的话，无论服务器默认日期格式如何，您都可以使用通用格式“#yyyy-mm-dd#”。

# salesforce - 我们如何在 Account 对象中反转将帐单地址复制到送货地址的功能？

> ID：15519153
> 
> 赞同：-1
> 
> 时间：2013-03-20T09:02:35.427
> 
> 标签：salesforce, visualforce

实际上，存在将帐单地址复制到 Account 对象中的送货地址的功能。但我想创建一个按钮，以便送货地址必须复制到帐单地址。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:22:51.097

您可以创建页面和控制器并从按钮调用它们

```
public with sharing class CopyBilling {
   string accId;
   public CopyBilling (){
        accId = ApexPages.currentPage().getParameters().get('accId');
    }

    public PageReference copy(){
          Account acc = ...
          return  new PageReference('/'+acc.Id)
    }

}

<apex:page controller="CopyBilling" action="{!copy}"></apex:page> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-02-09T16:45:18.820

我实现了自定义复选框字段和工作流字段更新。稍微简陋一点，但它确实有效。

在帐户对象上创建一个自定义复选框“将运输复制到帐单”。

为您要复制的每个字段创建“字段更新”的即时工作流操作。选择“使用公式设置新值”并为每个字段更新插入相应的送货地址字段。

保存时，用运输字段替换帐单字段的记录。

# asp.net - 为什么我的以下 ajax 不能在异步模式下工作

> ID：15519154
> 
> 赞同：1
> 
> 时间：2013-03-20T09:02:37.600
> 
> 标签：asp.net, ajax, web-services, asynchronous

下面是我在页面加载时调用的代码。
它在我使用时有效

```
xmlhttp.open("GET", "../handlers/fetchshift.ashx?id=" + divs[i].id, false); 
```

但如果我使用

```
xmlhttp.open("GET", "../handlers/fetchshift.ashx?id=" + divs[i].id, true); 
```

xmlhttp.onreadystatechange 仅在最后一个 div 中调用。为什么会这样？我需要它在异步模式下。

```
function myfunction() {
     try {

         if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
             xmlhttp = new XMLHttpRequest();

         }
         else {// code for IE6, IE5
             xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
         }

         var table = document.getElementById('<%=GridView1.ClientID%>');
         if (table == null) return;
         var divs = table.getElementsByTagName('div');
         for (var i = 0; i < divs.length; i++) {

             xmlhttp.onreadystatechange = function () {
                 if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                     var msg = xmlhttp.responseText.split("|");
                     var table = document.getElementById('<%=GridView1.ClientID%>');
                     var divs = table.getElementsByTagName('div');
                     for (var i = 0; i < divs.length; i++) {
                         if (divs[i].id == msg[0]) {
                             divs[i].innerHTML = msg[1];
                             divs[i].parentNode.style.backgroundColor = msg[2];
                         }

                     }
                 }
             }

             xmlhttp.open("GET", "../handlers/fetchshift.ashx?id=" + divs[i].id, false);

             xmlhttp.send();
         }

     } catch (e) {
         alert(e);
     }
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:40:51.933

您需要在循环中创建一个新`xmlhttp`对象。`for`目前，您每次都覆盖所有内容，因此只有最后一个请求真正通过。

它在同步模式下工作，因为`xmlhttp.open()`会阻塞，直到一切都完成，所以在下一次迭代中，一切都被覆盖，但这不再重要了。

```
function myfunction() {
     try {
         var table = document.getElementById('<%=GridView1.ClientID%>');
         if (table == null) return;
         var divs = table.getElementsByTagName('div');
         for (var i = 0; i < divs.length; i++) {

         if (window.XMLHttpRequest) {// code for IE7+, Firefox, Chrome, Opera, Safari
                 xmlhttp = new XMLHttpRequest();
             }
             else {// code for IE6, IE5
                 xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
             }

             xmlhttp.onreadystatechange = function () {
                 if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {

                     var msg = xmlhttp.responseText.split("|");
                     var table = document.getElementById('<%=GridView1.ClientID%>');
                     var divs = table.getElementsByTagName('div');
                     for (var i = 0; i < divs.length; i++) {
                         if (divs[i].id == msg[0]) {
                             divs[i].innerHTML = msg[1];
                             divs[i].parentNode.style.backgroundColor = msg[2];
                         }

                     }
                 }
             }

             xmlhttp.open("GET", "../handlers/fetchshift.ashx?id=" + divs[i].id, false);
             xmlhttp.send();
         }
     } catch (e) {
         alert(e);
     }
} 
```

# magento - 如何在magento中从产品查看页面到列表页面获取预配置价格

> ID：15519156
> 
> 赞同：0
> 
> 时间：2013-03-20T09:02:40.417
> 
> 标签：magento, bundle, mage

最近我遇到的问题是当我在列表页面上显示捆绑产品的价格时，通过汇总捆绑中的所有产品来显示最低价格或最高价格总和。

由于我已将少数产品设置为在组中选择的默认值，因此在产品视图页面上，已计算出来自 perticualar 组的默认产品价格。但是在产品列表页面的价格上计算产品组中的最低金额。

那么，客户从显示最低价格的产品列表中查看产品详细信息会发生什么情况，但在产品查看页面上显示不同的价格，因为现在它计算的是默认产品价格而不是组中的最低价格。

我想显示从查看页面到产品列表页面的预配置产品价格。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:15:01.047

```
// load product
$product = new Mage_Catalog_Model_Product();
$product->load(165);
$priceModel = $product->getPriceModel();

// get options
$block = Mage::getSingleton('core/layout')->createBlock('bundle/catalog_product_view_type_bundle');
$options = $block->setProduct($product)->getOptions();

$price = 0;
foreach ($options as $option) {
  $selection = $option->getDefaultSelection();

  if ($selection === null) {
    continue;
  }

  $price += $priceModel->getSelectionPreFinalPrice($product, $selection, $selection->getSelectionQty());
} 
```

# android - Android 上的 RFC 4122 UUID？

> ID：15519161
> 
> 赞同：2
> 
> 时间：2013-03-20T09:03:03.890
> 
> 标签：android, uuid

有没有办法在 Android 上生成 RFC 4122 版本 1 UUID？UUID 版本 1 表示基于时间戳的 UUID。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2018-02-17T18:44:10.607

你试过[JUG 库](http://www.makeinjava.com/time-based-uuid-generator-java-jug-example/)吗？

在他们的示例中，他们展示了如何生成基于时间的 UUID，如下面的代码：

```
NoArgGenerator timeBasedGenerator = Generators.timeBasedGenerator(); 
UUID firstUUID = timeBasedGenerator.generate(); 
```

或者您可以从设备网络接口生成它（如果您的 Android 版本允许访问硬件信息）：

```
timeBasedGenerator = Generators.timeBasedGenerator(EthernetAddress.fromInterface());
UUID customUUID = timeBasedGenerator.generate(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-29T08:34:07.943

[https://github.com/marccarre/cassandra-utils](https://github.com/marccarre/cassandra-utils)

这个对我有用。你只需要一个类：cassandra-utils/src/main/java/com/carmatech/cassandra/TimeUUID.java 在你的 build.gradle 中有一个依赖项：

```
// https://mvnrepository.com/artifact/com.eaio.uuid/uuid
**compile group: 'com.eaio.uuid', name: 'uuid', version: '3.2'** 
```

**警告**将使用随机而不是 MAC 地址，但您可以更改它。

```
import com.eaio.uuid.UUIDGen;

import org.joda.time.DateTime;

import java.util.Date;
import java.util.UUID;

public final class TimeUUID {
private TimeUUID() {
    // Pure utility class, do NOT instantiate.
}

private static final long NUM_100NS_INTERVALS_SINCE_UUID_EPOCH = 0x01b21dd213814000L;
private static long lastTimestamp = Long.MIN_VALUE;

/**
 * WARNING: Use only for testing purposes, as it may lead to duplicate UUIDs. Re-initialize the value of the last timestamp seen.
 */
public static synchronized void reset() {
    lastTimestamp = Long.MIN_VALUE;
}

/**
 * Generate a new, unique UUID based on current timestamp.
 */
public static UUID createUUID() {
    return createUUID(System.currentTimeMillis());
}

/**
 * Generate a new, unique UUID based on the provided date-time.
 *
 * @param dateTime date-time used for the "time" component of the UUID.
 */
public static UUID createUUID(final DateTime dateTime) {
    return createUUID(dateTime.getMillis());
}

/**
 * Generate a new, unique UUID based on the provided date.
 *
 * @param javaDate date used for the "time" component of the UUID.
 */
public static UUID createUUID(final Date javaDate) {
    return createUUID(javaDate.getTime());
}

/**
 * Generate a new, unique UUID based on the provided timestamp.
 *
 * @param timestamp timestamp used for the "time" component of the UUID.
 */
public static UUID createUUID(final long timestamp) {
    final long timestampIn100Ns = to100Ns(timestamp);
    final long uniqueTimestampIn100Ns = makeUnique(timestampIn100Ns);
    return new UUID(toUUIDTime(uniqueTimestampIn100Ns), UUIDGen.getClockSeqAndNode());
}

private static long to100Ns(final long timestampInMs) {
    return (timestampInMs * 10000) + NUM_100NS_INTERVALS_SINCE_UUID_EPOCH;
}

private static synchronized long makeUnique(final long timestamp) {
    if (timestamp > lastTimestamp) {
        lastTimestamp = timestamp;
        return timestamp;
    } else {
        return ++lastTimestamp;
    }
}

private static long toUUIDTime(final long timestampIn100Ns) {
    // Example:
    // Lowest 16 bits and version 1: 0123 4567 89AB CDEF -> 89AB CDEF 0000 0000 -> 89AB CDEF 0000 1000
    // Middle 32 bits: 0123 4567 89AB CDEF -> 0000 4567 0000 0000 -> 0000 0000 4567 0000 -> 89AB CDEF 4567 1000
    // Highest 16 bits: 0123 4567 89AB CDEF -> 0123 0000 0000 0000 -> 0000 0000 0000 0123 -> 89AB CDEF 4567 1123

    long uuidTime = (timestampIn100Ns << 32) | 0x0000000000001000L;
    uuidTime |= (timestampIn100Ns & 0x0000FFFF00000000L) >>> 16;
    uuidTime |= (timestampIn100Ns & 0xFFFF000000000000L) >>> 48;
    return uuidTime;
}

/**
 * WARNING: returned UUID is not unique. Get the UUID corresponding to the provided date-time and the clock sequence, which depends on the IP and MAC
 * addresses of the current machine, and a random component per process/JVM.
 *
 * @param dateTime date-time used for the "time" component of the UUID.
 */
public static UUID toUUID(final DateTime dateTime) {
    return toUUID(dateTime.getMillis());
}

/**
 * WARNING: returned UUID is not unique. Get the UUID corresponding to the provided date and the clock sequence, which depends on the IP and MAC addresses
 * of the current machine, and a random component per process/JVM.
 *
 * @param javaDate date used for the "time" component of the UUID.
 */
public static UUID toUUID(final Date javaDate) {
    return toUUID(javaDate.getTime());
}

/**
 * WARNING: returned UUID is not unique. Get the UUID corresponding to the provided timestamp and the clock sequence, which depends on the IP and MAC
 * addresses of the current machine, and a random component per process/JVM.
 *
 * @param timestamp timestamp used for the "time" component of the UUID.
 */
public static UUID toUUID(final long timestamp) {
    final long timestampIn100Ns = to100Ns(timestamp);
    return new UUID(toUUIDTime(timestampIn100Ns), UUIDGen.getClockSeqAndNode());
}

/**
 * Extract the "time" component of the provided UUID.
 *
 * @param uuid UUID to extract timestamp from.
 * @return Timestamp in milliseconds.
 */
public static long toMillis(final UUID uuid) {
    return from100Ns(uuid.timestamp());
}

private static long from100Ns(long timestampIn100Ns) {
    return (timestampIn100Ns - NUM_100NS_INTERVALS_SINCE_UUID_EPOCH) / 10000;
} 
```

}

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T09:19:33.133

你检查过[这个吗](http://developer.android.com/reference/java/util/UUID.html)

```
public static String deviceUDID(Context ctx) {
 final TelephonyManager tm = (TelephonyManager) ctx.getSystemService(Context.TELEPHONY_SERVICE);

 final String tmDevice, tmSerial, androidId;
 tmDevice = "" + tm.getDeviceId();
 tmSerial = "" + tm.getSimSerialNumber();
 androidId = "" +android.provider.Settings.Secure.getString(ctx.getContentResolver(), android.provider.Settings.Secure.ANDROID_ID);

 UUID deviceUuid = new UUID(androidId.hashCode(), ((long)tmDevice.hashCode() << 32) | tmSerial.hashCode());
 String deviceId = deviceUuid.toString();
 Log.d("Device Id", deviceId);
 return deviceId;
} 
```

您也可以参考[这个](http://www.androidsnippets.com/generate-random-uuid-and-store-it)和[这个](http://johannburkard.de/software/uuid/)链接。

# nagios - Nagios 插件（用 C 编写）无法打开文件

> ID：15519163
> 
> 赞同：0
> 
> 时间：2013-03-20T09:03:09.307
> 
> 标签：nagios

我有一个用 c 编写的插件，它将解析一个 .log 文件并确定页面命中数：

```
_xLogFileName = "./loging.log";
/* File operation starts here */
 _xFile = fopen ( _xLogFileName, "r" );
if ( _xFile != NULL )
{   
    //read a line upto the end of the file
    while ( fgets ( _xFileLine , sizeof  _xFileLine,  _xFile  ) != NULL ) 
    {
    // @_xTiemInStr --> cur date in YYYY-MM-DD format to identify todays log
        if(strstr(_xFileLine, _xTiemInStr) != NULL) {
            if(strstr(_xFileLine, _xLoginHitString) != NULL) {
                _xLoginPageCounter = _xLoginPageCounter + 1;
            }
        }
    }
    printf("Usage:Total Login Page Hit :%d\n",_xLoginPageCounter );
    fclose ( _xFile );
    return 0;
}
else
{
    printf("error\n");
    perror ( _xLogFileName ); 
    return 3;
}
return 0; 
```

* * *

现在我将 a.out 文件放在 /usr/lib/nagios/plugin 文件夹中，并将“loging.log”文件放在同一个文件夹中 - 完成 chmod 777。我可以从命令行运行插件，但是当我将它与 nagios 集成时，它会给出未知状态并从其他部分打印“错误”——任何人都可以帮忙

* * *

第二部分

另外我添加了以下代码来确定nagios从哪里运行？

```
char cwd[1024]; 
_xLogFileName1 = "loging.log"; 
if (getcwd(cwd, sizeof(cwd)) != NULL)
   _xLogFileName = strcat( cwd,_xLogFileName1); 
   printf("FileName : %s\n", _xLogFileName); 
```

它正在打印/loging.log 状态信息？

## 所以我必须实际放置文件的地方，我的 nagios 从 /etc/nagios3 运行，我也将 logging.log 文件放在那里，但它仍然无法正常工作。

更新：现在它正在工作，因为我通过 c 程序打印 pwd 并发现它正在从我的根 (/) dir 运行，所以我将 logging.log 文件放在那里，现在它工作正常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T21:47:46.413

您应该传递文件的完整路径并将其存储在“_xLogFileName1”中，而不仅仅是文件名。强烈建议您不要将文件复制到根目录。

了解网络日志，您要查找的日期字符串很可能位于行首。所以我建议使用“strnstr”而不是“strstr”。这将大大提高您的搜索速度。

# javascript - 提交后显示值

> ID：15519165
> 
> 赞同：0
> 
> 时间：2013-03-20T09:03:13.103
> 
> 标签：javascript, jquery, html

我有一个带有两个提交按钮的 html 表单，其中一个已启用。如果用户正在填写表单，则提交已启用并且其他按钮已禁用。当用户单击提交按钮时，其他按钮被启用并以只读方式显示所有字段值。当单击第二个按钮时，在数据库中输入值时，可以 使用**jquery**或**javascript**

```
$('input[type="text"]').each(function(){
            $(this).attr('readonly','readonly');
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:11:46.673

如果我正确阅读了您的问题，第一个按钮实际上并没有提交表单？

```
$("#firstbutton").click(function() {
    $("#myForm input").attr("readonly", "readonly"); //this makes the input fields readonly

    $("#secondbutton").attr("disabled","disabled"; //this enable the second button

    $(this).removeAttr('disabled'); //this disables the #firstbutton
} 
```

确保：

*   在页面加载时，第二个按钮已被禁用。
*   如果您的表单中有下拉列表，您还必须将它们设置为只读，因为它们不是`<input>`项目`<select>`。
*   firstbutton 不应该是 of `type="submit"`，它应该是 of`type="button"`或者是一个`<button>`标签。
*   你的第二个按钮可以是一个常规的提交按钮，不需要任何花哨的东西。只要您的表单发布到正确的操作链接，表单就可以正常提交。
*   切勿`disabled`在输入字段上使用属性。如果这样做，表单提交将忽略这些字段并且不会按预期发布它们。您已经通过使用 readonly 做对了。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:08:48.767

```
$(document).ready(function(){
  $('#myForm').submit(function(e){
    e.preventDefault();

    $myForm = $(this);

    $myForm.find('input[type=submit]').attr('disabled','disabled');
    $myForm.find('input#other-button').attr('enabled','enabled');

    //do a $.post request
    $.post('/path/to/my-file.php',
           $myForm.serialize(),
           function(data){
             // make something after the post is complete
             $myForm.find("input[type=text]").attr('readonly','readonly');
           },
           'json');
  });
}); 
```

# c# - 如何将图像存储在网站根目录之外

> ID：15519175
> 
> 赞同：3
> 
> 时间：2013-03-20T09:03:35.870
> 
> 标签：c#, asp.net

**我希望用户上传的所有图像都保存在我的网站目录之外。**

给大家解释一下

* * *

假设我在服务器中部署了一个网站，并且目录路径是：

例如`D:\TestWeb\`

目前，我添加了一些其他目录来存储图像：

```
 D:\TestWeb\imgProfile

 D:\TestWeb\imgLocation

 D:\TestWeb\Scan 
```

**但我不想将这些存储在我的根目录 D:\TestWeb\ 我想将它们存储到其他位置**

```
 E:\img\imgProfile

 E:\img\imgLocation

 E:\img\Scan 
```

在这里，我无法 `E:\img\imgProfile`使用 http 访问它。

**请提出任何逻辑。**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:08:12.283

您可以在 IIS 中创建一个虚拟目录，例如`/Images`指向`D:\TestWeb\imgLocation`. 然后，您只需使用[MapPath](http://msdn.microsoft.com/en-us/library/system.web.httpserverutility.mappath.aspx)通过虚拟路径获取图像文件夹的物理路径`/Images`。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T09:18:54.757

在 web.config 文件中设置路径

```
<appSettings>
     <add key="DocumentationLocation" value="E:\img\imgProfile" />
</appSettings> 
```

在代码中：

```
string savePath = ConfigurationSettings.AppSettings["DocumentationLocation"];

string filename = Path.GetFileName(FileUploadControl.FileName);
FileUploadControl.SaveAs(savePath + filename); 
```

# javascript - 未捕获的 TypeError:Object[object object] 没有“on”方法

> ID：15519177
> 
> 赞同：2
> 
> 时间：2013-03-20T09:03:41.890
> 
> 标签：javascript, jquery, google-chrome, scrollable

我要试试这个： http: [//jquerytools.org/demos/scrollable/index.html](http://jquerytools.org/demos/scrollable/index.html)
但没有**任何事件触发**，我得到以下错误

![在此处输入图像描述](../Images/3bf3aa3d97ad7d4f2887019accb035f0.png)

但是我很困惑，为什么**on方法在均匀的****页面加载**中找不到

 **```
<head>
<link href="css/scrollable-horizontal.css" rel="stylesheet" type="text/css" />
<link href="css/scrollable-buttons.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.6.1.min.js"></script>
<script src="js/jquery.tools.min.js"></script>
</head> 
```

**javascript部分**没有做任何事情

 **```
<script>
$(function() {
  // initialize scrollable
  $(".scrollable").scrollable();
});
</script> 
```

它停止了我的进一步实施。对此有任何想法吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T09:06:39.350

JQuery .on 方法是在 1.7 中添加的。您需要从您当前使用的屏幕截图中更新您的 JQuery 1.6

[http://api.jquery.com/on/](http://api.jquery.com/on/)

从[这里](http://jquery.com/download/)下载后，更改下面标记的位置

```
<head>
<link href="css/scrollable-horizontal.css" rel="stylesheet" type="text/css" />
<link href="css/scrollable-buttons.css" rel="stylesheet" type="text/css" />
<script src="js/jquery-1.6.1.min.js"></script> <!-- Change this line -->
<script src="js/jquery.tools.min.js"></script>
</head> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:06:58.337

您正在使用 jQuery 1.6.1 - [on()](http://api.jquery.com/on/)当时不存在（直到 1.7）。

您的选择：

*   要么使用[bind()](http://api.jquery.com/bind/)代替。

*   或者你更新到最新的 jQuery。

关于第二个选项，替换

```
<script src="js/jquery-1.6.1.min.js"></script> 
```

和

```
<script src="http://code.jquery.com/jquery-latest.min.js"
        type="text/javascript"></script> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:07:53.027

您需要更新 jQuery 版本。

因为 jQuery 1.6 没有将`.on()`它添加到新版本的 jQuery 中。****

# regex - vim 语法检查空格

> ID：15519182
> 
> 赞同：0
> 
> 时间：2013-03-20T09:03:58.610
> 
> 标签：regex, vim, whitespace, syntax-checking

我想配置我的 .vimrc 来做一些自动语法检查。那是我的问题，我想通过另一个自动更改某些语法。我处理计算机编程中的特定字符，例如 = ; , . ( { [ <.

一个比文字更好的例子：

```
void bibi(int param1,char *words)
{
 unsigned int locale=param;
 cout<<words<<endl;
} 
```

变成：

```
void bibi( int param1,char* words)
{
 unsigned int locale = param;
 cout << words << endl;
} 
```

只需使用添加或删除一些空格进行格式化。

我写这个：

```
 """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
    " Formating of text in code
    """""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""

    function! ChangeSpaces()
    "" search and replace "= " or " =" or "= " to " = " 
    silent! %s/\s*[=]\s*/ = /g
    endfunction

    ""autocmd CursorMovedI * call ChangeSpaces()
    ""autocmd BufWrite * call ChangeSpaces()
    autocmd FileAppendPre * call ChangeSpaces() 
```

但我没有结果，在这种情况下，如果我写 " i=e" ，他们什么也不做，但如果我写 'i= '，它的工作，正则表达式不运行，他们在结束后替换 "图案”。

顺便说一句，如果你有更“性感的方式”来做我想做的事，请告诉我。事实上，当我想添加一些其他特定的字符时，代码变成了：

```
 "function! ChangeSpaces()
     "" search and replace "= " or " =" or "= " to " = " 
     "silent! %s/\s*[=]\s*/ = /g

     """ search and replace "( " or " (" or "(" to " ( "
     ""      silent! %s/\s*[(]\s*/ ( /g
     """ search and replace "[ " or " [" or "[" to " [ "
     ""      silent! %s/\s*[[]\s*/ [ /g

     """ search and replace ", " or " ," or "," to " , "
     ""      silent! %s/\s*[,]\s*/ , /g

     """ search and replace "== " or " ==" or "==" to " == "
     ""      silent! %s/\s*[==]\s*/ = /g

     """ search and replace "> " or " >" or ">" to " > "
     ""      silent! %s/\s*[>]\s*/ > /g
     """ search and replace ">= " or " >=" or ">=" to " >= "
     "      silent! %s/\s*[>=]\s*/ >= /g

     """ search and replace "< " or " <" or "<" to " < "
     ""      silent! %s/\s*[<]\s*/ < /g
     """ search and replace "<= " or " <=" or "<=" to " <= "
     ""      silent! %s/\s*[=]\s*/ <= /g

     ""       let repl=substitute(cline,\s*[= ]\s*," = ", "g")
     ""       call setline(".",repl)
     ""       let cline=line(".")
     ""       let ccol=col(".")
     ""       call cursor(cline, ccol)
   "endfunction

   ""autocmd CursorMovedI * call ChangeSpaces()
   ""autocmd BufWrite * call ChangeSpaces()
   "autocmd FileAppendPre * call ChangeSpaces() 
```

此致。

PS：我的错，我想要这种格式，对于我使用的每一种语言，而不仅仅是 C++。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:42:39.533

通过外部 C++ 缩进器过滤文件怎么样？虽然 GNU indent 说它不是为 C++ 设计的，但它工作得相当好。如果没有，你可以试试[astyle](http://astyle.sourceforge.net/)。那么你所要做的就是

```
map <F8> :w<CR>m':%!astyle<CR>`' 
```

这样，即使使用其他编辑器的人也可以使用相同的缩进样式。

# extjs - 如何使sencha组件宽度设备独立

> ID：15519189
> 
> 赞同：0
> 
> 时间：2013-03-20T09:04:12.643
> 
> 标签：extjs, sencha-touch, sencha-touch-2

我在视图初始化期间创建了注册面板并添加了带有按钮的工具栏，在控制器中我正在创建表单面板并将其动态添加到注册面板中。

注册面板中的工具栏正在根据设备屏幕进行调整，但表单面板宽度没有变化。

如果我为表单面板设置宽度，表单面板是浮动的，宽度保持不变。

这就是我这样做的目的。

```
 Ext.define('Form.view.RegisterForm',{
    extend : 'Ext.Panel',
    xtype : 'register',
    id : 'register',

    initialize : function() { 
        console.log("register init");
        var submit = {
            xtype : 'button',
            width : '100px',
            ui : 'action',
            text : 'Submit',
            handler : this.onSubmitTap,
            scope : this
        };

        var topToolbar = {
            xtype : 'toolbar',
            docked : 'top',
            id : 'registerToolbar',
            title : 'Form',
            items : [{
                xtype : 'spacer'
            }, submit]
        };

        this.add(topToolbar);
    },
    config : {
        fullscreen : true,
        layout : {
            type : 'vbox'
        },
        title : 'Register'
    },

    onSubmitTap : function() {
        console.log("onSubmit");
        this.fireEvent('submitCommand', this);
    }

}); 
```

在注册控制器中，我动态添加字段

```
 // RegisterFormController.js

    oncreateForm : function() {
            var form = {
                    xtype: 'formpanel',
                    flex : 1,
                    id: formId,
                    name: formId
                };
            Ext.getCmp('register').add(form);

    }

// calling  onCreateComponent method with xtype, label, value and fromId 

        onCreateComponent : function(fxtype,flabel,fname,fvalue,id) {
            Ext.getCmp(id).add({
                xtype: fxtype,
                label: flabel,
                name: fname,
                value: fvalue,
                labelWrap:true
            });
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-23T05:05:06.720

以防你们中的任何人遇到同样的问题。

我犯的错误是“我在 hbox 面板中添加了 4 个单选按钮，因此该面板的宽度增加了，这就是为什么整个表单面板无法在不同设备中正确显示的原因”。

在我将面板布局更改为 vbox 后，问题解决了。

# php - PHP剥离内容以修复行数

> ID：15519191
> 
> 赞同：-1
> 
> 时间：2013-03-20T09:04:16.697
> 
> 标签：php, css, stripping

PHP中剥离内容以固定行数的最佳方法是什么？

当我们按字符长度剥离内容时，有时是 5 行，有时是 6 行。这是由于单个字符的宽度和单词的大小不同。

我已经尝试了很多事情，但没有得到任何完美的解决方案。

各位有什么感觉？

使用 CSS，我们可以设置 div 的高度，然后添加隐藏溢出，但是当我们想要添加带有文本的阅读更多按钮时，这个技巧也不起作用。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:06:59.617

这更像是一个 javascript 或 css 问题，而不是 php。如果您希望您的内容适合固定高度，请检查此 jquery 插件：[dotdotdot](http://dotdotdot.frebsite.nl/)

显然也有 CSS 方法来实现这一点。就像部分支持的CSS3[文本溢出一样（尽管带有前缀，它似乎很受支持）。](http://caniuse.com/text-overflow)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:06:19.357

使用 PHP`wordwrap`函数。[http://php.net/manual/en/function.wordwrap.php](http://php.net/manual/en/function.wordwrap.php)

在那里，您可以指定一个宽度，然后使用该宽度返回行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T10:15:53.393

您想要的是显示固定区域内的所有内容。我认为在固定高度的 DIV 中添加滚动条就可以了。

您需要添加

> 样式=“溢出-y：滚动；” 到 div 标签。（这将强制垂直滚动条）。

如果您只需要在需要时使用滚动条，只需执行

> 溢出-y：自动；

用文本大小做任何你需要的事情，它会起作用。你不会让你的文本大小为 1000px 吗？你 ？:)

干杯。

# sql - 查询 Sql 百分比(CLOSED)

> ID：15519192
> 
> 赞同：0
> 
> 时间：2013-03-20T09:04:16.987
> 
> 标签：sql

如何显示列 SUM 和列百分比不起作用？

为了简单的解释：

我有 2 个 SQL 语句

```
SELECT TOP 100 PERCENT COUNT(CodeAll) AS Total, CodeAll, Description,
LEFT(CodeAll, 1) AS Code
FROM Data WHERE DATE BETWEEN '2013/03/01 00:00:00' AND '2013/03/01 23:59:00'
AND (CodeAll Is Not Null)
GROUP BY CodeAll, Description ORDER BY Code
ASC 
```

**结果**：

```
Total | CodeAll | Description | Code
-------------------------------------
3       1c         Test          1
3       1b         Test2         1
10      1a         Test3         1
2       2a          Test4        2
5       2b         Test5         2
5       3a         Test6         3
3       3b         Test7         3 
```

查询 #2：

```
SELECT COUNT(CodeAll) AS SumCall, LEFT(CodeAll, 1) AS Code FROM Data 
WHERE DATE BETWEEN '2013/03/01 00:00:00' AND '2013/03/01 23:59:00' 
AND (CodeAll Is Not   Null) GROUP BY LEFT(CodeAll, 1)` 
```

**结果**：

```
SumCall| Code 
16       1
7        2
8        3 
```

我想组合`2 query`成 1 个查询来生成：

```
 Total | CodeAll | Description | Code | SUM  | Percentage 
    3       1c         Test          1       16    18.75 %
    3       1b         Test2         1       16    18.75 %
    10      1a         Test3         1       16    62.5 % 
    2       2a          Test4        2        7    28.57 %
    5       2b         Test5         2        7    71.43 %
    5       3a         Test6         3        8    62.5 %
    3       3b         Test7         3        8    37.5 % 
```

询问？？
请帮忙

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:32:40.280

[SQL小提琴](http://sqlfiddle.com/#!3/e2ac5/27)

**MS SQL Server 2008 架构设置**：

```
CREATE TABLE TEST_TAB
    ([Total] int, [CodeAll] varchar(2), [Description] varchar(5), [Code] int)
;

INSERT INTO TEST_TAB
    ([Total], [CodeAll], [Description], [Code])
VALUES
    (3, '1c', 'Test', 1),
    (3, '1b', 'Test2', 1),
    (10, '1a', 'Test3', 1),
    (2, '2a', 'Test4', 2),
    (5, '2b', 'Test5', 2),
    (5, '3a', 'Test6', 3),
    (3, '3b', 'Test7', 3)
; 
```

**查询 1**：

```
select v.*, 100.0 * v.total/v.group_total percentage
  from (
    select t.*, 
           sum(total) over(partition by code) group_total
      from TEST_TAB t
  ) v 
```

**[结果](http://sqlfiddle.com/#!3/e2ac5/27/0)**：

```
| TOTAL | CODEALL | DESCRIPTION | CODE | GROUP_TOTAL |      PERCENTAGE |
------------------------------------------------------------------------
|     3 |      1c |        Test |    1 |          16 |           18.75 |
|     3 |      1b |       Test2 |    1 |          16 |           18.75 |
|    10 |      1a |       Test3 |    1 |          16 |            62.5 |
|     2 |      2a |       Test4 |    2 |           7 | 28.571428571428 |
|     5 |      2b |       Test5 |    2 |           7 | 71.428571428571 |
|     5 |      3a |       Test6 |    3 |           8 |            62.5 |
|     3 |      3b |       Test7 |    3 |           8 |            37.5 | 
```

# java - 重新运行测试时出现 NullPointerException

> ID：15519196
> 
> 赞同：2
> 
> 时间：2013-03-20T09:04:28.867
> 
> 标签：java, unit-testing, playframework, playframework-1.x

我正在对基于 Play Framework 的应用程序进行单元测试。正如我在文档中所读到的，为了清除状态，在每次测试之前我都会重新加载这样的夹具列表：

```
 @Before
    public void setUp() {
        Fixtures.deleteAll();
        Fixtures.load("data.yml");
        Logger.info("FIXTURES RELOADED");
    } 
```

然后我进入基于 Web 的测试平台`(http://localhost:9000/@tests)`，选择一个处理获取一些数据的测试，`(User u = User.findById(1l);)`然后针对这些数据进行断言。有用。

但是，如果我尝试再次选择测试并重新运行它，它会失败并显示：

```
A java.lang.NullPointerException has been caught, Try to read name on null object models.User 
```

如果我完全停止应用程序并重新启动它，它会再次运行（第一次），但是如果您每分钟执行 10 次，启动和停止需要一些时间并且非常乏味。

我正在使用 Play 1.2.5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:11:37.880

问题是自动递增用户 ID（在每次插入时），同时尝试在每次测试中获取 ID 为 1 的用户。

您可以获取新创建的用户 ID 并在测试中使用它，或者通过您肯定知道的其他字段查找用户。

# salesforce - getContent() 呈现错误的页面 - 为什么？

> ID：15519197
> 
> 赞同：0
> 
> 时间：2013-03-20T09:04:30.457
> 
> 标签：salesforce, visualforce

我在一个名为“selectpages”的 VF 页面上，可以单击“render to pdf”按钮。按钮操作旨在简单地将另一个 VF 页面呈现到附件，如下所示 -

附件 ax = new attachment(name = filenameToUse, parentid = quot.id);

```
 PageReference bl = Page.tc_report;
    bl.getParameters().put('q',qid);
    bl.setRedirect(true);
    Blob b = bl.getContent(); // this is returning blob from current page, not page tc_report...
    ax.Body = b;
    insert ax; 
```

那么为什么生成的附件包含很好地呈现为 pdf 的“selectpages”而不是 tc_report 页面？...

希望这是一个快速的 - 让我感到困惑，希望有人把我夹在耳朵上，因为我错过了一些明显的东西。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:13:43.253

使用 getContentAsPDF 函数

```
 Blob b = bl.getContentAsPDF (); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-03T03:19:06.363

如果有人遇到这种情况，解决方案是创建一个不同的页面控制器类，以便在页面渲染时清除视图状态。

# vb.net - 终止线程执行 24 小时

> ID：15519200
> 
> 赞同：0
> 
> 时间：2013-03-20T09:04:44.240
> 
> 标签：vb.net, multithreading, service, windows-services

我的服务大部分都在正常工作，但它应该每天只工作一次。

为了安排这个，我的老板建议我让工作线程睡到明天早上 7 点：

此`Thread.Sleep`调用直接从他编写的类似服务复制而来，该服务显然有效，但这总是抛出 ArgumentOutOfRangeException - 返回的值是负数。

```
 Private Sub startExport()
#If Not Debug Then
            Thread.Sleep(1000 * 60 * 1)
#End If
        While runReportExport
            Try
                runExport()
            Catch ex As Exception
                el.WriteEntry("Error exporting data: {1}")
            Finally
                'sleep thread until tomorrow 7am
                Thread.Sleep(DateTime.Now.Subtract(Date.Today.AddDays(1).AddHours(7)))
            End Try
        End While
    End Sub 
```

我对这一切如何运作感到相当困惑，所以如果有人能为我解释整个时间跨度的事情，我将不胜感激。

另一方面，我的朋友建议我以不同的方式管理线程执行。

这是他建议我做的事情：

```
Private lastExecute As DateTime = DateTime.Now

Private Overrides Sub OnStart(ByVal args() As String)
    startService()
End Sub

Private Sub startService()
    Dim nextExecute = lastExecute.AddDays(1)
    If nextExecute >= DateTime.Now Then
        lastExecute = DateTime.Now

        tWorker = New Thread(AddressOf startExport)
        tWorker.IsBackground = True
        tWorker.Start()
    End If
End Sub 
```

他说这将在启动时执行一次工作线程，而不是在另一天再次执行。虽然此代码确实可以正常工作，但它不会阻止服务循环一遍又一遍地执行工作线程（目前它在完成第一次运行后立即执行第二次）

就个人而言，我对任何一种方法都持开放态度，但我似乎都无法正常工作。

基本上，我最终需要的只是每天导出一次数据的服务。

我老板的 Thread.Sleep 选项似乎更简单，但我朋友的建议似乎是更好的做法。

谁能帮我解决这个问题（此时我不在乎我使用哪一个，只要它有效）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T11:22:19.873

```
 DateTime.Now.Subtract(Date.Today.AddDays(1).AddHours(7))) 
```

您从当前时间中减去未来时间。这总是产生负值。卡布姆。

您需要将其反转，从未来时间中减去当前时间。为清晰起见并避免在 DateTime.Now 上进行比赛：

```
Dim today = DateTime.Now
Dim tomorrow = today.Date.AddDays(1).AddHours(7)
Dim wait = tomorrow - today
Thread.Sleep(wait) 
```

当服务停止时，您需要做一些有用的事情。最好使用 ManualResetEvent 完成，您将从其 WaitOne(wait) 方法中获得睡眠。顺便说一句，让一个线程休眠那么长时间并且没有做任何有用的事情是非常浪费的。请改用计时器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:10:56.413

每天运行一次特定任务的另一种方法（也是我使用的方法）是在计时器中设置任务。就我而言，我希望任务在每天早上 12:05 运行。因此，当我的程序启动时，我设置了计时器的初始间隔，以便第一个滴答声将在第二天凌晨 12:05 发生。之后，每天一次，在作为滴答声的一部分执行的代码结束时，我再次重置计时器间隔，以便下一个滴答声将在第二天凌晨 12:05 发生。

```
...

Timer1.Interval = MillisecondsToMidnight() + 300000 ' next tick 12:05:00 tomorrow

...

Private Function MillisecondsToMidnight() As Integer

    Dim ReturnValue As Integer
    Dim ts As TimeSpan

    Dim Tomorrow As DateTime = Today.AddDays(1)
    ts = Tomorrow.Subtract(Now)

    ReturnValue = ts.TotalMilliseconds()

    ts = Nothing
    Return ReturnValue

End Function 
```

# php - 使用唯一文件名通过 php 上传图像

> ID：15519202
> 
> 赞同：8
> 
> 时间：2013-03-20T09:04:48.657
> 
> 标签：php, cordova, upload, unique, filenames

我目前正在借助 phonegap 编写移动应用程序。我希望这个应用程序具有的少数功能之一是能够捕获图像并将其上传到远程服务器......

我目前的图像捕获和上传/发送电子邮件部分可以使用已编译的 apk 正常工作......但在我的 php 中，我目前将图像命名为“图像 [插入 10 到 20 的随机数]......这里的问题是数字可以重复，图像可以被覆盖......我已经阅读并考虑过只使用 rand() 并从 0 到 getrandmax() 中选择一个随机数，但我觉得我可能有相同的文件机会覆盖...我需要每次都使用唯一名称将图像上传到服务器，无论如何...所以 php 脚本将检查服务器已有的内容并使用唯一名称写入/上传图像姓名...

除了“rand（）”之外的任何想法？

我也在考虑可能为每张图片命名... img + 日期 + 时间 + 随机 5 个字符，其中包括字母和数字... 所以如果在 2013 年 3 月 20 日凌晨 4:37 使用应用程序拍摄了一张图片，当上传到服务器时，图像将被命名为“img_03-20-13_4-37am_e4r29.jpg”......我认为这可能有效......（除非有更好的方法）但我对php和不明白怎么写这样的东西......

我的php如下...

```
print_r($_FILES);
$new_image_name = "image".rand(10, 20).".jpg";
move_uploaded_file($_FILES["file"]["tmp_name"], "/home/virtual/domain.com/public_html/upload/".$new_image_name); 
```

任何帮助表示赞赏......提前致谢！另外，如果有任何进一步的信息我可能会遗漏，请告诉我......

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-20T09:29:34.117

您可能需要考虑 PHP 的[`uniqid()`](http://www.php.net/manual/en/function.uniqid.php)功能。这样，您建议的代码将如下所示：

```
$new_image_name = 'image_' . date('Y-m-d-H-i-s') . '_' . uniqid() . '.jpg';
// do some checks to make sure the file you have is an image and if you can trust it
move_uploaded_file($_FILES["file"]["tmp_name"], "/home/virtual/domain.com/public_html/upload/".$new_image_name); 
```

另请记住，您的服务器的随机函数并不是真正随机的。如果您确实需要随机的东西，请尝试[random.org 。](http://www.random.org/)随机随机随机。

**UPD**：为了在您的代码中使用 random.org，您必须向他们的服务器发出一些 API 请求。相关文档可在此处获得：[www.random.org/clients/http/](http://www.random.org/clients/http/)。

调用的示例是：[`random.org/integers/?num=1&min=1&max=1000000000&col=1&base=10&format=plain&rnd=new`](http://www.random.org/integers/?num=1&min=1&max=1000000000&col=1&base=10&format=plain&rnd=new). 请注意，您可以更改`min`和`max`其他参数，如[文档](http://www.random.org/clients/http/#integers)中所述。

在 PHP 中，您可以使用函数、库甚至套接字`GET`向远程服务器发出请求。如果您使用的是共享主机，则传出连接应该可用并为您的帐户启用。[`file_get_contents()`](http://www.php.net/manual/en/function.file-get-contents.php)[`cURL`](http://www.php.net/manual/en/function.curl-init.php)

```
$random_int = file_get_contents('http://www.random.org/integers/?num=1&min=1&max=1000000000&col=1&base=10&format=plain&rnd=new');
var_dump($random_int); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-06-17T04:28:45.437

您应该使用[`tempnam()`](http://php.net/tempnam)来生成唯一的文件名：

```
// $baseDirectory   Defines where the uploaded file will go to
// $prefix          The first part of your file name, e.g. "image"
$destinationFileName = tempnam($baseDirectory, $prefix); 
```

您的新文件的扩展名应在移动上传的文件后完成，即：

```
// Assuming $_FILES['file']['error'] == 0 (no errors)
if (move_uploaded_file($_FILES['file']['tmp_name'], $destinationFileName)) {
    // use extension from uploaded file
    $fileExtension = '.' . pathinfo($_FILES['file']['name'], PATHINFO_EXTENSION);
    // or fix the extension yourself
    // $fileExtension = ".jpg";
    rename($destinationFileName, $destinationFileName . $fileExtension);
} else {
    // tempnam() created a new file, but moving the uploaded file failed
    unlink($destinationFileName); // remove temporary file
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:23:52.367

您是否考虑过使用[md5_file](http://php.net/manual/en/function.md5-file.php)？这样，您的所有文件都将具有唯一的名称，您不必担心重复名称。但请注意，如果内容相同，这将返回相同的字符串。

这里还有另一种方法：

```
do {
  $filename = DIR_UPLOAD_PATH . '/' . make_string(10) . '-' . make_string(10) . '-' . make_string(10) . '-' . make_string(10);
} while(is_file($filename));

return $filename;

/**
* Make random string
*
* @param integer $length
* @param string $allowed_chars
* @return string
*/
function make_string($length = 10, $allowed_chars = 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890') {
  $allowed_chars_len = strlen($allowed_chars);

  if($allowed_chars_len == 1) {
    return str_pad('', $length, $allowed_chars);
  } else {
    $result = '';

    while(strlen($result) < $length) {
      $result .= substr($allowed_chars, rand(0, $allowed_chars_len), 1);
    } // while

    return $result;
  } // if
} // make_string 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2014-06-17T04:28:18.853

函数将在上传图像之前创建一个唯一的名称。

```
// Upload file with unique name
if ( ! function_exists('getUniqueFilename'))
{
    function getUniqueFilename($file)
    {
        if(is_array($file) and $file['name'] != '')
        {
            // getting file extension
            $fnarr          = explode(".", $file['name']);
            $file_extension = strtolower($fnarr[count($fnarr)-1]);

            // getting unique file name
            $file_name = substr(md5($file['name'].time()), 5, 15).".".$file_extension;
            return $file_name;

        } // ends for is_array check
        else
        {
            return '';

        } // else ends

    } // ends
} 
```

# list - grails填充g：从查询中选择

> ID：15519207
> 
> 赞同：0
> 
> 时间：2013-03-20T09:05:12.397
> 
> 标签：list, grails, select

尝试成为 grails 转换者我已经开始将现有应用程序转换为 Grails 和 Groovy。它工作得很好，但我卡在选择标签的转换上。

我有一个域类：

```
package todo

  class Person {

    String ssn
    String firstname
    String familyname
    String role
    String emailname
    String emailserver
    ... 
```

在创建新的“待办事项”任务时，可能会从系统中的开发人员那里分配所有者，我得到了这个工作（从 PHP 相当直接的翻译）：

```
<select id="owner" name="owner">
  <option>Noboby ...</option>
  <g:each in="${Person.list()}">
    <g:if test="${it?.role=='developer'}">
      <option value="${it?.id}">${it?.firstname} ${it?.familyname}</option>
    </g:if>
  </g:each>
</select> 
```

但是每一次使它更“Grails-ish”的尝试都失败了。如何将它塑造成 Grails v2.2.1 代码？我花了几个小时阅读，尝试，失败。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:58:09.920

如果你想让它更像 Grails 风格，你应该在`controllers`\`services`而不是视图中执行所有逻辑。

假设您`createTodo`在文件夹`person`和 中有一个视图`PersonController`，然后像这样修改您的`createTodo`操作：

```
class PersonController {
    def createTodo() {
        def developers = Person.findAllWhere(role: 'developer')
        [developers: developers, ... /* your other values */]  
    }
} 
```

所以你不需要在你的视图中处理数据库操作。

下一步是使用[g:select 标签](http://grails.org/doc/2.2.x/ref/Tags/select.html)，如下所示：

```
<g:select name="owner" from="${developers}" optionValue="${{'${it.firstName} ${it.familyName}'}}" noSelection="['null':'Nobody ...']" optionKey="id" value="${personInstance?.id}" /> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:54:50.800

试试这个代码：

```
<g:select optionKey="id" from="${Person.findAllByRole('developer')}" optionValue="${{it.fullName}}" value="${yourDomainInstance?.person?.id}" noSelection="['null':'Nobody']"></g:select> 
```

在你的课堂上：

```
class Person {
....
String getFullName(){
   it?.firstname+' '+ it?.familyname
}

static transients = ['fullName']
....
} 
```

参见[g:select 标签](http://grails.org/doc/2.2.x/ref/Tags/select.html)了解更多详情

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-22T15:45:41.487

最后，我让它按我的意愿工作，它（几乎）根据@“猫先生”的解决方案工作。但是，有一个小细节，“它”在类中不存在，因此 getFullName 方法必须变为：

```
String getFullName(){
   this?.firstname+' '+ this?.familyname
} 
```

启动并工作，感谢您的所有帮助。

# android - 防止 Android 中的 Fragment 恢复

> ID：15519214
> 
> 赞同：38
> 
> 时间：2013-03-20T09:05:30.130
> 
> 标签：android, memory-management, garbage-collection, fragment, recreate

我们正在使用 Fragments，我们不需要在重新创建 Activity 时自动恢复它们。但是 Android 每次调用`Activity::onCreate(Bundle savedInstanceState)`->时`super.onCreate(savedInstanceState)`都会恢复 Fragments，即使我们对这些 Fragments 使用 setRetainInstance(false) 也是如此。

而且，在那些`Fragments` `Fragment.performCreateView()`是直接调用而不经过`Fragment::onAttach()`等等。另外，某些字段在还原内为空`Fragment`...

有人知道如何防止Android恢复片段吗？

PS我们知道，如果为配置更改重新创建活动，可以通过添加到清单中来完成`ndroid:configChanges="orientation|screenSize|screenLayout`。但是在自动内存清理的情况下重新创建活动呢？

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2013-03-28T13:34:10.743

我们通过添加活动来完成：

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(null);
} 
```

它禁止在 Activity 的创建/重新创建周期中保存的任何数据，并避免片段自动重新创建。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-09-27T10:44:10.070

@goRGon 的回答对我来说非常有用，但是当您需要在重新创建后将更多信息转发给您的活动时，这种使用会导致严重的问题。

这是仅删除“片段”但保留所有其他参数的改进版本。

从捆绑中删除的 ID 是作为字段的`android.support.v4.app.FragmentActivity`类的一部分。`FRAGMENTS_TAG`当然，它可能会随着时间而改变，但这不是预期的。

```
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(createBundleNoFragmentRestore(savedInstanceState));
}

/**
 * Improve bundle to prevent restoring of fragments.
 * @param bundle bundle container
 * @return improved bundle with removed "fragments parcelable"
 */
private static Bundle createBundleNoFragmentRestore(Bundle bundle) {
    if (bundle != null) {
        bundle.remove("android:support:fragments");
    }
    return bundle;
} 
```

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2019-01-28T19:11:17.197

我遇到了问题`TransactionTooLargeException`。所以幸运的是，在使用[tolargetool](https://github.com/guardian/toolargetool)之后，我发现片段（android:support:fragments）在内存中，并且事务变得太大。所以最后我做了这个，效果很好。

```
@Override
public void onSaveInstanceState(final Bundle outState) {
    super.onSaveInstanceState(outState);
    outState.putSerializable("android:support:fragments", null);
} 
```

编辑：我将它添加到活动中。就我而言，我有一个 Activity 应用程序和多个 Fragment。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2017-03-10T04:48:18.587

那些使用已接受答案中描述的此方法时使用 ViewPager 获得 NPE 的人，请覆盖

`ViewPager.onRestoreInstanceState(Parcelable state)`

方法和调用

`super.onRestoreInstanceState(null);`

反而。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2016-05-05T04:59:26.100

我删除了 Activity 的 onCreate 中的片段。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-04-28T19:46:08.113

对于带有 的应用程序，我在创建之前`ViewPager`删除了 中的片段。`onCreate()`

基于这个线程：[从容器中删除所有片段](https://stackoverflow.com/questions/33237235/remove-all-fragments-from-container)，我们有：

```
FragmentManager fm = getSupportFragmentManager();
for (Fragment fragment: fm.getFragments()) {
  fm.beginTransaction().remove(fragment).commitNow();
} 
```

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-11-12T09:28:43.053

视图层次结构不会自动恢复。因此，在`Fragment.onCreateView()`or中`Activity.onCreate()`，您必须恢复所有视图（从 xml 或以编程方式）。每个包含片段的 ViewGroup 必须具有与您第一次创建它时相同的 ID。创建视图层次结构后，Android 会恢复所有片段并将其视图放入正确的 ViewGroup 中，这要归功于 ID。假设 Android 会记住片段所在的 ViewGroup 的 ID。`onCreateView()`这发生在和之间`onStart()`。

# javascript - 如何从json中检索数据

> ID：15519216
> 
> 赞同：1
> 
> 时间：2013-03-20T09:05:31.073
> 
> 标签：javascript, jquery, json

我正在尝试从我从 servlet 传递的 JSON 对象中检索数据。但是我的钥匙是有编号的。我需要将这些数字添加到我给键的名称中。

我的回复是这样的。。

```
{"shareInfo1":[{"uname":"xyz","image":"iVBO..","imname":"ryty","senderPicture":"iVBOR"}],"shareInfo2":[{"uname":"sds","image":"iVBO","imname":"ryty","senderPicture":"iVBOR}],....} 
```

我尝试使用以下代码：

```
$.ajax({
    type: "GET",
    url: "RetrieveShares",
    data:'action='+encodeURIComponent(action),
    dataType: "json",
    success: function( data, textStatus, jqXHR)
    {
    if(data.success)
    {

for(var z=1;z<=data.loops;z++)
{
len=data["shareInfo"+z].length;
for(var k = len-1;k>=0;k -= 1){
    var newcommhtml = '<div id="S0'+thecid+'" class="snew">';
    newcommhtml = newcommhtml + '<div class="author-image"><img src="data:image/jpeg;base64,'+data["shareInfo"+z][k].senderPicture+'" alt="'+data["shareInfo"+z][k].uname+'" width="100%" height="100%" class="ava"></div><span>'+data["shareInfo"+z][k].uname+' shared the image '+data["shareInfo"+z][k].imname+'</span>';
    newcommhtml = newcommhtml + '<div class="s-content"><div class="s-message"><span>'+nl2br(data["shareInfo"+z][k].message+'</span></div><div class="shpicture">');
    newcommhtml = newcommhtml + '<img src="data:image/jpeg;base64,'+data["shareInfo"+z][k].image+'" alt="'+data["shareInfo"+z][k].imname+'" width="100%" height="100%" class="SharedImage" class="SharedImage" data-id="'+data["shareInfo"+z][k].id+'" data-alid="'+data["shareInfo"+z][k].alid+'" data-shareid="'+data["shareInfo"+z][k].shareId+'">';
    newcommhtml = newcommhtml + '</div></div>';
    var thelm = "#S0"+thecid;
    $('#spscrl').append(newcommhtml);
    $(thelm).hide().fadeIn('slow');
    newcommhtml ='<div class="SPcommentbox">';
    var i=0;
    if(Object.keys(data["shareInfo"+z][k]).length>8)
    {
        var x;
        for(x=data["shareInfo"+z][k].loopreq-1;x>=0;x-=1)
            {
       newcommhtml = newcommhtml + '<div class="comment"><div class="commenter-image"><img src="data:image/jpeg;base64,'+data["shareInfo"+z][k]["commenterPicture"+i]+'" alt="'+data["shareInfo"+z][k]["whocommented"+i]+'" width="100%" height="100%" class="ava"></div><div class="commentername">'+data["shareInfo"+z][k]["whocommented"+i]+'</div><span>'+data["shareInfo"+z][k]["commented"+i]+'</span></div>';
       i+=1;
            }
    }
    newcommhtml = newcommhtml + '<div class="comment"><div class="commenter-image">';
    newcommhtml = newcommhtml +'</div><div class="addcomment"><input type ="text" placeholder="Write a comment..." class="commentbox"></input></div></div>';
    $('#spscrl').append(newcommhtml);
    thecid++;
    }
    $(".primg > img").first().clone().appendTo(".commenter-image");
    }
    }
 },
    error: function(jqXHR, textStatus, errorThrown)
    {
    alert("error"+errorThrown);
    console.log("Something really bad happened " + textStatus);
    },
    }); 
```

但它会产生错误`TypeError: data[("shareInfo" + z)] is undefined`

请任何人帮我解决这个问题...谢谢...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:32:57.943

我知道这并不能直接回答您的问题，但它可能会提供一种解决方法。

如果您能够修改后端，我建议您更改返回数据的格式以使用数组：

```
{
  "shareInfo":[
     {...},
     {...},
     {...}
  ]
} 
```

然后你可以使用普通的 shareInfo[index] 和 shareInfo.length 等。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T09:12:30.220

您的 Servlet 将您的 json 对象作为字符串而不是对象发送。因此，您首先必须将其转换为 JSON 对象，例如

```
data = eval( '(' + response + ')' );
data["shareInfo"+z].length; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T10:03:49.847

在开始修改 DOM 元素之前，先制作一个更小更容易的结构。

这是一个使用 jQuerys [$.each()](http://api.jquery.com/jQuery.each/)函数的[例子；](http://jsfiddle.net/4wLXD/)

```
var data = {
    loops: {
        "shareInfo1": [
            {
                "uname": "xyz",
                "image": "iVBO..",
                "imname": "ryty",
                "senderPicture": "iVBOR"
            },
            {
                "uname": "abc",
                "image": "iVBO..",
                "imname": "smile",
                "senderPicture": "iVBOR"
            }
        ],
        "shareInfo2": [
            {
                "uname": "sds",
                "image": "iVBO",
                "imname": "happy",
                "senderPicture": "iVBOR"
            }
        ]
    }
};

console.log('data', data); // DEBUG

// Iterating the data
$.each(data.loops, function(key, shareInfo) {
    console.log('shareInfo', key, shareInfo); // DEBUG

    $.each(shareInfo, function(key, user) {
        console.log('user', key, user); // DEBUG

        // Username: user.uname
    });

}); 
```

# css - 如何自定义浏览按钮？

> ID：15519223
> 
> 赞同：8
> 
> 时间：2013-03-20T09:05:43.590
> 
> 标签：css

我想自定义（想更改背景和颜色等）上传文件字段中的浏览按钮。

```
<input type="file" tabindex="6" class="medium" size="20" value="" id="input_5_13" name="input_13"> 
```

![详见附件](../Images/5abb802e5e06c09e6334dc1c629b8574.png)

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-03-20T09:16:53.397

你不能。您必须创建自己的按钮并触发实际输入。

在这里，您可以使用 jQuery 执行此操作。请参阅[工作示例。](http://jsfiddle.net/HcQ27/)

HTML：

```
<input type="file" class="hidden" id="uploadFile"/>
<div class="button" id="uploadTrigger">Upload File</div> 
```

jQuery：

```
$("#uploadTrigger").click(function(){
   $("#uploadFile").click();
}); 
```

CSS：

```
.hidden {
    display:none;
}
.button {
    border: 1px solid #333;
    padding: 10px;
    margin: 5px;
    background: #777;
    color: #fff;
    width:75px;
}

.button:hover {
    background: #333;
    cursor: pointer;
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:19:42.540

样式文件输入按钮的基本前提是在文件上传上覆盖绝对定位的控件。文件上传不透明度设置为 0，导致它不显示。它的 z-index 设置在覆盖控件之上，而控件的 z-index 设置为低于文件上传。因此，当用户认为他们正在单击覆盖控件时，他们实际上是在单击不透明度设置为 0 的文件上传。

这是一个非常粗略的例子：

**HTML**

```
<div id="file-upload-cont">
    <input id="original" type="file"/>
    <div id="my-button">Find</div>
    <input id="overlay"/>
</div> 
```

**CSS**

```
#my-button{
    position: absolute;
    border: 1px solid black;
    background: green;
    padding 3px;
    width: 50px;
    height: 25px;
    text-align: center;
    left: 148px;  /* Positioning over file-upload */
    top: 0px;
    z-index: 1; /* Lower z-index causes controls to sit under file upload */
}

#overlay{
 position: absolute;
 z-index: 1; /* Lower z-index causes controls to sit under file upload */
 left: 0; /* Positioning over file-upload */
}

#original{
    opacity: 0; /* Opacity makes it invisible*/
    position: relative;
    z-index: 100; /* z-index causes original file upload to sit above other controls*/
}

#file-upload-cont{
    position: relative;
} 
```

**工作示例** [http://jsfiddle.net/tP8KY/1/](http://jsfiddle.net/tP8KY/1/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:09:29.220

您不能直接自定义浏览按钮。您的 CSS 将无法使用它。

您可以做的是，您可以在其左侧创建一个带有文本框的按钮。自定义它，点击后触发原始文件上传。

看到这个[链接](https://stackoverflow.com/questions/572768/styling-an-input-type-file-button)和[这个](https://stackoverflow.com/questions/4441341/how-to-style-a-file-upoad)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:10:16.400

检查以下浏览按钮的更改：

1.  [浏览按钮 css](http://htmlcampus.com/style-a-file-browse-button-with-css/)
2.  [浏览按钮设计](http://site-o-matic.net/?viewpost=19)

希望这些链接对您有所帮助。

# javascript - 如何将 REST 与 Node.js 和 AngularJS 一起使用在不同的端口上？

> ID：15519225
> 
> 赞同：0
> 
> 时间：2013-03-20T09:05:49.460
> 
> 标签：javascript, apache, node.js, rest, angularjs

我试图了解 Angular 和 Node.js 在后端的合作。但是，我不知道如何使用 REST 在两者之间进行数据传输。

我有：

1.  Node.js 后端在 port 上运行`8000`，响应各种 GET 和 POST 请求（通过 cURL）。
2.  Angular 前端通过 Apache 加载，在 port 上运行`80`。

自然地，JavaScript 控制台将其标识为`not allowed by Access-Control-Allow-Origin`.

这通常是如何解决的？我做错了吗？我不应该通过 Apache 运行前端吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:08:55.640

解决它的一种方法是使用[跨域资源共享](http://en.wikipedia.org/wiki/Cross-origin_resource_sharing)。浏览器支持也不错。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2021-06-21T06:42:13.000

你也可以使用**cors**

`npm install cors`

```
const cors = require('cors');

app.use(cors({
    origin: 'http://example.com'
})); 
```

[http://example.com](http://example.com)是您在前端的应用程序来源/域。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-11-07T09:29:19.060

将此添加到您的 Node.js API 服务器

```
server.all('*', function(req, res, next) {
    res.header("Access-Control-Allow-Origin", "*");
    res.header('Access-Control-Allow-Methods', 'OPTIONS,GET,POST,PUT,DELETE');
    res.header("Access-Control-Allow-Headers", "Content-Type, Authorization, X-Requested-With");
    if ('OPTIONS' == req.method) {
        return res.send(200);
    }
    next();
}); 
```

# wpf - 如何保持 ComboBox 弹出，直到我在代码中调用 close？

> ID：15519232
> 
> 赞同：2
> 
> 时间：2013-03-20T09:06:10.713
> 
> 标签：wpf, wpf-controls

我想保留 WPF ComboBox 弹出窗口，直到我编写的代码让它关闭，我该如何实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:30:11.947

ComboBox 有一个属性**IsDropDownOpen**将其设置为 True。如果您希望 Combobox 仅在编辑时保持打开状态，则可以将**StaysOpenOnEdit**设置为 true

```
 <Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="Auto"/>
        <RowDefinition Height="*"/>
        <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <ComboBox x:Name="cmb" IsDropDownOpen="True"/>
    <Button Click="Button_Click" Content="OK" Grid.Row="2"/>
</Grid>

    private void Button_Click(object sender, RoutedEventArgs e)
    {
        cmb.IsDropDownOpen = false;
    }

<ComboBox x:Name="cmb" StaysOpenOnEdit="True"/> 
```

我希望这将有所帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T11:05:57.157

通常属性 IsDropDown 会影响弹出窗口，我编辑了组合框模板，因此弹出窗口和控制它的切换按钮 - 将绑定到其他属性 -Tag

```
 <Style x:Key="ComboBoxStyle1" TargetType="{x:Type ComboBox}">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="{x:Type ComboBox}">
                    <Grid x:Name="MainGrid" SnapsToDevicePixels="true">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition MinWidth="{DynamicResource {x:Static SystemParameters.VerticalScrollBarWidthKey}}" Width="0"/>
                        </Grid.ColumnDefinitions>
                        <Popup x:Name="PART_Popup" StaysOpen="True" AllowsTransparency="true" Grid.ColumnSpan="2" IsOpen="{Binding Tag, RelativeSource={RelativeSource TemplatedParent}}" Margin="1" PopupAnimation="{DynamicResource {x:Static SystemParameters.ComboBoxPopupAnimationKey}}" Placement="Bottom">
                            <Microsoft_Windows_Themes:SystemDropShadowChrome x:Name="Shdw" Color="Transparent" MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{Binding ActualWidth, ElementName=MainGrid}">
                                <Border x:Name="DropDownBorder" BorderBrush="{DynamicResource {x:Static SystemColors.WindowFrameBrushKey}}" BorderThickness="1" Background="{DynamicResource {x:Static SystemColors.WindowBrushKey}}">
                                    <ScrollViewer x:Name="DropDownScrollViewer">
                                        <Grid RenderOptions.ClearTypeHint="Enabled">
                                            <Canvas HorizontalAlignment="Left" Height="0" VerticalAlignment="Top" Width="0">
                                                <Rectangle x:Name="OpaqueRect" Fill="{Binding Background, ElementName=DropDownBorder}" Height="{Binding ActualHeight, ElementName=DropDownBorder}" Width="{Binding ActualWidth, ElementName=DropDownBorder}"/>
                                            </Canvas>
                                            <ItemsPresenter x:Name="ItemsPresenter" KeyboardNavigation.DirectionalNavigation="Contained" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"/>
                                        </Grid>
                                    </ScrollViewer>
                                </Border>
                            </Microsoft_Windows_Themes:SystemDropShadowChrome>
                        </Popup>
                        <ToggleButton BorderBrush="{TemplateBinding BorderBrush}" Background="{TemplateBinding Background}" Grid.ColumnSpan="2" IsChecked="{Binding Tag, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}" Style="{StaticResource ComboBoxReadonlyToggleButton}"/>
                        <ContentPresenter ContentTemplate="{TemplateBinding SelectionBoxItemTemplate}" ContentTemplateSelector="{TemplateBinding ItemTemplateSelector}" Content="{TemplateBinding SelectionBoxItem}" ContentStringFormat="{TemplateBinding SelectionBoxItemStringFormat}" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" IsHitTestVisible="false" Margin="{TemplateBinding Padding}" SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Grid>
                    <ControlTemplate.Triggers>
                        <Trigger Property="HasDropShadow" SourceName="PART_Popup" Value="true">
                            <Setter Property="Margin" TargetName="Shdw" Value="0,0,5,5"/>
                            <Setter Property="Color" TargetName="Shdw" Value="#71000000"/>
                        </Trigger>
                        <Trigger Property="HasItems" Value="false">
                            <Setter Property="Height" TargetName="DropDownBorder" Value="95"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="false">
                            <Setter Property="Foreground" Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}"/>
                            <Setter Property="Background" Value="#FFF4F4F4"/>
                        </Trigger>
                        <Trigger Property="IsGrouping" Value="true">
                            <Setter Property="ScrollViewer.CanContentScroll" Value="false"/>
                        </Trigger>
                        <Trigger Property="ScrollViewer.CanContentScroll" SourceName="DropDownScrollViewer" Value="false">
                            <Setter Property="Canvas.Top" TargetName="OpaqueRect" Value="{Binding VerticalOffset, ElementName=DropDownScrollViewer}"/>
                            <Setter Property="Canvas.Left" TargetName="OpaqueRect" Value="{Binding HorizontalOffset, ElementName=DropDownScrollViewer}"/>
                        </Trigger>
                    </ControlTemplate.Triggers>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style> 
```

那么如果你想打开\关闭组合框，你只需要将他的 Tag 属性设置为 True\False ：

```
<ComboBox  Style="{DynamicResource ComboBoxStyle1}" Tag="True"/> 
```

# php - PHP pChart改变饼图切片的颜色

> ID：15519238
> 
> 赞同：2
> 
> 时间：2013-03-20T09:06:26.010
> 
> 标签：php, charts, pchart

我正在用 pChart 开发 php pie 聊天，它看起来不错。现在我想改变每个切片的颜色。可以改变颜色吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T18:46:30.820

您正在寻找的功能是 setSliceColor() - [http://wiki.pchart.net/doc.pie.setslicecolor.html](http://wiki.pchart.net/doc.pie.setslicecolor.html)

假设您已经从一些数据创建了一个新的饼图：

```
$PieChart = new pPie($myPicture,$MyData); 
```

然后你可以像这样使用它：

```
$PieChart->setSliceColor(0, array("R" => 255, "G" => 0, "B" => 0));
$PieChart->setSliceColor(1, array("R" => 0, "G" => 255, "B" => 0));
etc... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-06T14:43:49.373

对于 pChart（几乎所有版本），您只需使用以下命令：

```
...
$PieChart = new pPie($myPicture,$MyData);
$PieChart->setSliceColor(0,array("R"=>255,"G"=>128,"B"=>0));
$PieChart->setSliceColor(1,array("R"=>255,"G"=>255,"B"=>255));
$PieChart->setSliceColor(2,array("R"=>25,"G"=>128,"B"=>0));
$PieChart->setSliceColor(3,array("R"=>55,"G"=>255,"B"=>25));
... 
```

只需添加更多 setSliceColor 即可在图表上获得更多切片

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-19T16:35:09.347

I solved this question just doing this:

```
 /* 
  Example 10 - A 3D exploded pie graph
  Version 1.27d pChart*/ 

  $Test->loadColorPalette('ColorsDirectory/tones-9.txt',',');
  $Test->drawPieGraph(
    $DataSet->GetData(),
    $DataSet->GetDataDescription(),
    350,130,110,PIE_PERCENTAGE_LABEL,FALSE,50,20,5);
... 
```

Call **loadColorPalette** just before calling **drawPieGraph**. It works this way.Good luck!

# ruby-on-rails - 为什么 Rails::Application 有许多在 Rails::Engine 中定义的重复初始化程序？

> ID：15519240
> 
> 赞同：1
> 
> 时间：2013-03-20T09:06:31.107
> 
> 标签：ruby-on-rails, ruby-on-rails-3, initialization, railtie

在完成 rails 3 初始化过程时，我发现 Rails::Engine 中定义的所有初始化程序（有 10 个）都多次添加到 Rails::Application 实例中。这意味着这些初始化程序将运行多次。下面是分析： 1\. Rails::Application#initializers:

```
def initializers #:nodoc:           
  Bootstrap.initializers_for(self) +
  super +                           
  Finisher.initializers_for(self)   
end 
```

它将调用 super(Rails::Engine) 方法，定义如下：

```
def initializers
  initializers = []
  ordered_railties.each do |r|
    if r == self
      initializers += super
    else
      initializers += r.initializers 
    end                              
  end
  initializers
end 
```

从 Rails::Engine#initializers 可以看出，每个引擎（继承自 Rails::Engine 的类）都会为其添加 Rails::Engine 的初始化器，包括 Rails::Application。但是所有其他引擎都包含在 Rails::Application 的 ordered_railties 中，因此它们的初始化程序也被添加到 Rails::Application 的初始化程序中。我们可以得出结论，Rails::Engine 的初始化器被多次添加到 Rails::Application 中。我们可以从控制台信息中看到：

```
1.9.3p194 :002 > Rails.application.initializers.map(&:name).size
 => 119 
1.9.3p194 :001 > Rails.application.initializers.map(&:name).uniq.size
 => 79 
```

所以 Rails::Engine 中的每个初始化器都被添加到 Rails::Application 的 5 倍。我想知道为什么会这样？有什么特别的原因吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T09:40:33.803

除了名称之外，初始化器还有其他几个属性：上下文、块等。因此，每当从 Rails::Engine 继承的引擎时，Rails::Engine 的所有初始化器都会添加到具有不同上下文的子引擎中。也就是说，尽管 Rails::Application 中有相同名称的重复初始化程序，但它们确实是不同的初始化程序，将在不同的上下文中运行：

```
def run(*args)                         
  @context.instance_exec(*args, &block)
end 
```

# audio - 游戏速度 J2ME 中的声音问题

> ID：15519242
> 
> 赞同：0
> 
> 时间：2013-03-20T09:06:36.243
> 
> 标签：audio, java-me

游戏中播放背景音时，游戏速度比没有声音的游戏略慢。如何解决这个问题？用于声音的代码如下..

> menusound = Manager.createPlayer(inputstream, "audio/midi"); menusound.realize(); menusound.setLoopCount(-1); menusound.start();

# java - 使用 groovy 为 Java 应用程序编写集成测试有什么好处？

> ID：15519244
> 
> 赞同：9
> 
> 时间：2013-03-20T09:06:42.893
> 
> 标签：java, groovy, continuous-integration, integration-testing, java-ee-6

我看到一些帖子（例如这里[1](https://stackoverflow.com/questions/13775420/any-better-alternative-to-groovy-for-java-integration-testing?rq=1)）建议使用 groovy 以 groovy 编程语言为 java 应用程序编写集成测试。我正在使用以下技术开发应用程序：Java 7、Java EE 6、POSTGRESQL

我知道 groovy 是

*   易于与java集成
*   快速编写代码

但是有什么特别的理由将它用于 IT 吗？在您的代码库中添加另一种编程语言不会让您的生活陷入困境吗？我想我从图片中遗漏了一些东西，所以我很感激你的回复。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T16:06:13.963

我将很快开始一个与您的堆栈完全相同的项目，但 Groovy 也将用于生产代码，而不仅仅是测试。

将 Groovy 添加到您的代码库中没有问题，因为它是一种简单的语言。如果你包含一些看起来不太像 java 的语言，比如 haskell 或 prolog，那就另当别论了。您已经包含了 Facelets、EL、CSS、HTML 和 Javascript。添加另一种语言的哪个部分不好？:-)

我在 IT 测试中为 Groovy 挑选的要点：

*   易于编写断言和模拟数据；
*   代码简洁；
*   平滑的学习曲线；
*   简洁的代码来操作像[Geb](http://www.gebish.org/)这样的浏览器自动化；

Groovy 中的其他简单到忘记的东西：

*   易于编写 XML/JSON（例如，如果您需要测试 Web 服务）；
*   静态编译，如果需要的话；

我们在我最后两家公司的测试团队没有在生产代码中工作，但很快就开始用 Groovy 编写测试并且喜欢这种语言：不用担心类型和东西，只需工作测试！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T16:04:27.623

我认为应该阅读它，因为与 Java 相比，Groovy 特别适合编写测试。在 Groovy 中没有什么是您在 Java 中做不到的，但这通常需要付出巨大的努力。例如，像 Spock 这样的东西在 Java 中几乎是不可读的。

许多小事使它如此。例如，有一些权力断言，它使 Groovy 中断言语句的断言错误输出非常好。无缝集成允许没有额外的代码来对齐语言世界。DSL 功能允许您轻松编写最少的 DSL 以减少样板代码。所有这些都是为了让您了解您实际测试的内容以及测试方式。因为如果测试失败，您必须准确理解该部分，这会减少您编写测试所需的时间。

我能建议的只是尝试一下。然后它要么说服你，要么不说服你。如果您的案例非常简单，那么 Java 可能对您来说已经足够好了。如果测试变得更复杂，那么必须理解一些 Groovy 代码可能是这里较小的障碍。不要忘记：作为一名 Java 开发人员，您无需对 Groovy 有太多了解即可正确使用它并使用它编写出色的单元测试。

# php - PHP - 微时

> ID：15519248
> 
> 赞同：-2
> 
> 时间：2013-03-20T09:06:50.847
> 
> 标签：php, microtime

php microtime 如何生成，为什么只返回 13 - 15 个数字，如果我像这样手动编写时间：

```
<?php
$time = date('SAMPLE').date('SAMPLE').date('SAMPLE').date('SAMPLE').date('SAMPLE');
$TIME = microtime(true);
?> 
```

并且 microtime 看起来太短了，包含所有日期（年、月、日期、小时、分钟、秒） microtime 真的很独特吗？

请发表你的意见...

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:08:27.230

[microtime()](http://php.net/manual/en/function.microtime.php)以微秒为单位返回当前的 Unix 时间戳。此函数仅在支持 gettimeofday() 系统调用的操作系统上可用。

如果要将时间戳转换为人类可读的日期，请查看[date()](http://php.net/manual/en/function.date.php)函数。

# css - 如何在 CSS 中定义 tbody 的最小高度

> ID：15519249
> 
> 赞同：11
> 
> 时间：2013-03-20T09:06:54.620
> 
> 标签：css, css-tables

我想在 CSS 中为 tbody 设置一个最小高度，即使`<tr><td></td></tr>`在 tbody 中没有，这是我的代码：

```
tbody{
  height: 500px;
  min-height:500px;
} 
```

但它不起作用。那么我应该怎么做才能做到这一点呢？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T09:12:58.537

你为什么要这样做？

min-height 和 height 适用于块级元素，而 table 不是块级元素。将您的表格包裹在一个 div 中（例如 div.table-wrap）并将最小高度应用于该 div。

如果您不希望表格布局对您不重要，那么只需添加`display:block`到 tbody 的 CSS。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T09:28:44.943

希望这个演示对你有用...

CSS：

```
 tbody{
     height: auto;
     min-height:200px;
     display:block
    } 
```

[小提琴](http://jsfiddle.net/ssthil/kW5ek/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-07-13T14:38:20.470

我们需要最小高度，`<tbody>`因为我们无法注入其他 HTML 元素（用户内容）。我找到了解决办法。

高度适用于空表，但如果空表在 Chrome (59) 中有一个空的 tbody 则不适用 - 它适用于 Firefox 和 Egde。其他隐藏的案例`<tr>`也有问题，请参阅[JSFiddle](http://jsfiddle.net/9nbq6duf/)了解所有案例。

CSS：

```
.test {
  border: 1px solid red;
  height: 60px;
} 
```

html:

```
Empty table:
<table class=test>

</table>

Empty tbody:
<table class=test>
  <tbody></tbody>
</table> 
```

铬 59：

[![铬 59](../Images/658a554951e8925eca6d731675abbcc1.png)](https://i.stack.imgur.com/8TWYN.png)

Edge (14)、IE (11)、Firefox (54)：

[![](../Images/45f89832fa156df8d1bc86caf2194b95.png)](https://i.stack.imgur.com/10Pah.png)

解决了这个问题：

```
tbody:before {
  content: ''/* needed for chrome*/
} 
```

查看[更新的 JSFiddle](http://jsfiddle.net/uz0Lzqah/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:26:05.590

我认为这会做，

```
table{height:500px !important;} 
```

现在这`!important`将使它成为自愿的，它将很容易被其他属性覆盖。

tbody 不带有 height 属性。

根据 CSS 的标准化，它只带有 4 个属性 'align'、'char'、'charoff' 和 'valign'。

这也适用于在剩余空间中添加相同大小和单元格间距的单元格。

```
tbody{
  height:500px;
  display:block; 
} 
```

尝试并回复，我希望这样做:)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-09T07:41:06.997

尝试跟随，因为 tbody 不能有最小高度，但仍然适用于数据表的高度

```
tbody{
    height:500px;
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2013-03-20T09:19:20.283

也许您使用的是 IE 5 或 6。为什么不只使用 height 呢？尝试删除 min-height ，因为在同一元素上设置 height 和 min-height 没有意义，因为您将得到的只是固定高度而不是 min-height 。

* * *

## 回答 #7

> 赞同：-1
> 
> 时间：2013-03-20T09:11:05.790

您需要添加显示：块；也。

# windows-phone-7 - 向 Scoreloop 提交多个分数

> ID：15519255
> 
> 赞同：1
> 
> 时间：2013-03-20T09:07:06.227
> 
> 标签：windows-phone-7, scoreloop

我正在使用 XNA 为 Windows Phone (7.5 + 8) 制作游戏，我们决定将 Scoreloop 用于排行榜。目前我们的游戏已经提交了得分结果和次要结果。我们希望有可能让排行榜按他们中的任何一个排序，但这似乎没有以直接的方式得到支持。基本上我想要的就像在 Temple Run：分数排行榜和你跑过的距离排行榜。

我尝试为不同的排行榜制作不同的模式，然后以不同的顺序向它们提交分数，但 Scoreloop 似乎不允许同时提交多个分数。

有什么想法可以实现我想要做的事情吗？我在 Windows Phone 文档中找不到 Scoreloop 的解决方案，也找不到与此在线搜索相关的任何内容。

# jquery - 超大如何使用url链接？

> ID：15519263
> 
> 赞同：0
> 
> 时间：2013-03-20T09:07:36.040
> 
> 标签：jquery, supersized

[我从这里](http://buildinternet.com/project/supersized/)开始使用超大号。

如何使用幻灯片的网址？

我使用了标题并且知道我需要一个 div 幻灯片标题作为 id，但是幻灯片 url 呢：

```
 jQuery(function ($) {
    $.supersized({
        // Functionality
        slideshow: 1,           // Slideshow on/off
        autoplay: 1,            // Slideshow starts playing automatically
        start_slide: 1,         // Start slide (0 is random)
        stop_loop: 0,           // Pauses slideshow on last slide
        random: 0,          // Randomize slide order (Ignores start slide)
        slide_interval: 5000,       // Length between transitions
        transition: 1,          // 0-None, 1-Fade, 2-Slide Top, 3-Slide Right, 4-Slide Bottom, 5-Slide Left, 6-Carousel Right, 7-Carousel Left
        transition_speed: 1000,     // Speed of transition
        new_window: 1,          // Image links open in new window/tab
        pause_hover: 1,         // Pause slideshow on hover
        keyboard_nav: 1,            // Keyboard navigation on/off
        performance: 1,         // 0-Normal, 1-Hybrid speed/quality, 2-Optimizes image quality, 3-Optimizes transition speed // (Only works for Firefox/IE, not Webkit)
        image_protect: 1,           // Disables image dragging and right click with Javascript
        // Size & Position                         
        min_width: 0,           // Min width allowed (in pixels)
        min_height: 0,          // Min height allowed (in pixels)
        vertical_center: 1,         // Vertically center background
        horizontal_center: 1,           // Horizontally center background
        fit_always: 0,          // Image will never exceed browser width or height (Ignores min. dimensions)
        fit_portrait: 1,            // Portrait images will not exceed browser height
        fit_landscape: 0,           // Landscape images will not exceed browser width
        // Components                           
        slide_links: 'blank',   // Individual links for each slide (Options: false, 'num', 'name', 'blank')
        thumb_links: 0,         // Individual thumb links for each slide
        thumbnail_navigation: 0,    // Thumbnail navigation
        slides: [          
        { image: '../gfx/slideOne.jpg', url: 'http://www.official.com/' },
        { image: '../gfx/slideTwo.jpg', url: 'http://www.1.com/gb/home/' },
        { image: '../gfx/slideThree.jpg', url: 'http://www.8.com/' },
        { image: '../gfx/slideFour.jpg', url: 'http://www.8.com/home' },
        { image: '../gfx/slideFive.jpg', url: 'http://www.8.com/' },
        { image: '../gfx/slideSix.jpg', url: 'http://4.tumblr.com/' }
        ],
        // Theme Options              
        progress_bar: 0,
        mouse_scrub: 0
    });
}); 
```

我在前面有一张图片，我希望 url 随着幻灯片的变化而改变

这是我要更改的href：

```
<a class="findLink" target="_blank" href="/">
                        <img src="slideFindOut.png" alt="find out more"/></a> 
```

每次图像更改时，我都希望链接上方的 href 更改

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:27:05.550

试试这个方法

```
$(document).ready(function(){
    var slideurl = api.getField('url');
    alert(slideurl);
}); 
```

从[文档](http://buildinternet.com/project/supersized/docs.html)

> ***api.getField( 字段 )***
> 
> 返回幻灯片的指定字段的值（来自幻灯片数组）

所以在你的情况下应该是这样的

```
 $(document).ready(function(){
        var slideurl = api.getField('url');
        $("a.findLink").attr("href", slideurl);

    }); 
```

# c++ - C++（嵌套）函数调用指令 - 寄存器

> ID：15519268
> 
> 赞同：4
> 
> 时间：2013-03-20T09:07:53.393
> 
> 标签：c++, architecture, call, cpu-registers, function-calls

在[C++ 常见问题解答](http://www.parashift.com/c++-faq/procedural-integration.html)中：

> 假设一个具有寄存器和堆栈的典型 C++ 实现，寄存器和参数在调用 g() 之前被写入堆栈，然后从 g() 内部的堆栈中读取参数并再次读取以恢复寄存器，同时g() 返回 f()。

关于嵌套函数调用

```
void f()
{
  int x = /*...*/;
  int y = /*...*/;
  int z = /*...*/;
  ...code that uses x, y and z...
  g(x, y, z);
  ...more code that uses x, y and z...
} 
```

1/ C++ 的所有实现都带有寄存器和堆栈吗？这是否意味着：实现依赖于编译器/处理器/计算机体系结构？

2 /我打电话时的指令序列是什么（没有汇编语言，只是大图）`f()`？我已经阅读了关于这个主题的不同内容，而且我不记得提到的寄存器，但只有堆栈。

3/ 处理嵌套函数时，有哪些额外的特性/要点需要强调？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:40:30.433

For number `2` this depends on many things including the compiler and the platform. Basically the different ways of passing and returning arguments to functions are called [calling conventions](http://en.wikipedia.org/wiki/Calling_convention). the article [Calling conventions on the x86 platform](http://www.angelcode.com/dev/callconv/callconv.html) goes into some detail on sequence of operations and you can see how ugly and complicated it gets with just this small combination of platforms and compilers which is most likely why you have heard all sorts of different scenarios, [The gen on function calling conventions.](http://homepage.ntlworld.com/jonathan.deboynepollard/FGA/function-calling-conventions.html) covers a wider set of scenarios including `64 bit` platforms but is harder to read. It gets even more complicated because `gcc` may not actually `push` and `pop` the stack but directly manipulate the stack pointer, we can see an example of this, albeit in assembly [here](http://en.wikibooks.org/wiki/X86_Assembly/High-Level_Languages#C_Calling_Conventions). It is hard to generalize about calling conventions, if the number of arguments is small enough many calling conventions can avoid using the `stack` at all and will use `registers` exclusively.

As to number `3`, nested functions does not change anything, it will just repeat the procedure over again for the next function call.

As to number `1` As Sean pointed out `.Net` compiles to byte code with performs all it's operations on the stack. The Wikipedia page on [Common Intermediate Language](http://en.wikipedia.org/wiki/Common_Intermediate_Language#Computational_model) has a good example.

The `x86-64 ABI` [document](http://math-atlas.sourceforge.net/devel/assembly/abi_sysV_amd64.pdf) is another great document if you want to understand how one specific calling convention works in detail. `Figure 3.5 and 3.6` are neat since they give a nice example of a function with many parameters and how each parameter is passed using a combination of `general purpose registers`, `floating point registers` and the `stack`. This sort of nice diagram is a rare find when looking at documents that cover calling conventions.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:39:39.717

`1.` Although register/stack implementations are the most common underlying implementations of a C++ compiler there's nothing to stop you using a different architecture. For example, you could write a compiler to generate Java bytecode or .NET byte code, in which case you'd have a stack based C++ compiler.

`2.` When you call f() the typical approach is:

*   Push the return address on the stack and jump to f()

*   In f():

*   Allocate space for the locals x,y and z. This is normally done on the stack. Take a look at [this article](http://en.wikipedia.org/wiki/Call_stack) on call stacks.

*   When you get to g(x,y,z) the compiler will generate code to push the values onto the stack by accessing their values in the stack frame of f(). Note that C/C++ pushes parameters from right to left.

*   When you get to the end of f() the compiler inserts a `return` instructions. The top of the stack has the address to return to (it was pushed prior to the call to f() )

`3.` There's nothing special about nested functions as everything follows the same basic template:

*   To call a function - push parameters and call the function.
*   Within the function - allocate space for local variables within a stack

Now this is the general approach. Compilers will introduce their own optimizations to improve performace. For example a compiler may choose to store the first 2 parameters in registers (for example).

NOTE: Although parameter passing by the stack is by far the most common approach there are others. Take a look at this article on [register windows](http://en.wikipedia.org/wiki/Register_window) if you're interested in finding out more.

# servicestack - SqlScalar 的问题 和 SqlList 调用带参数的存储过程时

> ID：15519270
> 
> 赞同：3
> 
> 时间：2013-03-20T09:07:56.200
> 
> 标签：servicestack, ormlite-servicestack

Servicestack.OrmLite 的新 API 规定，当调用 fx 存储过程时，您应该使用 SqlScalar 或 SqlList，如下所示：

```
List<Poco> results = db.SqlList<Poco>("EXEC GetAnalyticsForWeek 1");
List<Poco> results = db.SqlList<Poco>("EXEC GetAnalyticsForWeek @weekNo", new { weekNo = 1 });

List<int> results = db.SqlList<int>("EXEC GetTotalsForWeek 1");
List<int> results = db.SqlList<int>("EXEC GetTotalsForWeek @weekNo", new { weekNo = 1 }); 
```

但是，命名参数不起作用。您必须尊重 SP 中参数的顺序。我认为是因为 SP 是使用 CommandType=CommandType.Text 而不是 CommandType.StoredProcedure 执行的，并且参数添加为 dbCmd.Parameters.Add()。似乎因为 CommandType 是 Text，它希望将参数添加到 SQL 查询字符串中，而不是作为 Parameters.Add()，因为它忽略了命名。一个例子：

```
CREATE PROCEDURE [dbo].[sproc_WS_SelectScanFeedScanRecords] 
    @JobNo int = 0
   ,@SyncStatus int = -1
AS
BEGIN
    SET NOCOUNT ON;
    SELECT 
      FSR.ScanId
    , FSR.JobNo
    , FSR.BatchNo
    , FSR.BagNo
    , FSR.ScanType
    , FSR.ScanDate
    , FSR.ScanTime
    , FSR.ScanStatus
    , FSR.SyncStatus
    , FSR.JobId
    FROM dbo.SCAN_FeedScanRecords FSR
    WHERE ((FSR.JobNo = @JobNo) OR (@JobNo = 0) OR (ISNULL(@JobNo,1) = 1))
    AND   ((FSR.SyncStatus = @SyncStatus) OR (@SyncStatus = -1) OR (ISNULL(@SyncStatus,-1) = -1))
END 
```

当这样调用这个 SP 时：

```
db.SqlList<ScanRecord>("EXEC sproc_WS_SelectScanFeedScanRecords @SyncStatus",new {SyncStatus = 1}); 
```

它返回 JobNo = 1 而不是 SyncStatus=1 的所有记录，因为它忽略命名参数并按它们在 SP 中定义的顺序添加。我必须这样称呼它：

```
db.SqlList<ScanRecord>("EXEC sproc_WS_SelectScanFeedScanRecords @SyncStatus=1"); 
```

这是预期的行为吗？如果我不能信任它，我认为它会击败匿名类型参数

TIA

博

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T12:38:42.837

我的解决方案是为存储过程推出我自己的方法。如果人们觉得它们很方便，我可以将它们添加到项目中

```
 public static void StoredProcedure(this IDbConnection dbConn, string storedprocedure, object anonType = null)
    {
        dbConn.Exec(dbCmd =>
        {
            dbCmd.CommandType = CommandType.StoredProcedure;
            dbCmd.CommandText = storedprocedure;
            dbCmd.SetParameters(anonType, true);
            dbCmd.ExecuteNonQuery();
        });
    }
    public static T StoredProcedureScalar<T>(this IDbConnection dbConn, string storedprocedure, object anonType = null)
    {
        return dbConn.Exec(dbCmd =>
        {
            dbCmd.CommandType = CommandType.StoredProcedure;
            dbCmd.CommandText = storedprocedure;
            dbCmd.SetParameters(anonType, true);
            using (IDataReader reader = dbCmd.ExecuteReader())
                return GetScalar<T>(reader);
        });
    }
    public static List<T> StoredProcedureList<T>(this IDbConnection dbConn, string storedprocedure, object anonType = null)
    {
        return dbConn.Exec(dbCmd =>
        {
            dbCmd.CommandType = CommandType.StoredProcedure;
            dbCmd.CommandText = storedprocedure;
            dbCmd.SetParameters(anonType, true);
            using (var dbReader = dbCmd.ExecuteReader())
                return IsScalar<T>()
                    ? dbReader.GetFirstColumn<T>()
                    : dbReader.ConvertToList<T>();
        });
    } 
```

它们只是 SqlScalar 和 SqlList 加上 ExecuteNonQuery 的修改版本

# node.js - 防止 cursor.skip() 在 mongodb 中成为 IO 绑定

> ID：15519274
> 
> 赞同：0
> 
> 时间：2013-03-20T09:08:11.657
> 
> 标签：node.js, mongodb, backbone.js, express

我正在使用跳过和限制的组合对 mongodb 中的集合进行分页。在快速获取路线中，我将参数设置为 page:2 或 page:3 等等。当它在第 2 页时，我跳过 10 条记录，3 20 条记录，依此类推。

但根据 mongodb 文档

```
The cursor.skip() method is often expensive because it requires the server to walk from the beginning of the collection or index to get the offset or skip position before beginning to return result. As offset (e.g. pageNumber above) increases, cursor.skip() will become slower and more CPU intensive. With larger collections, cursor.skip() may become IO bound. 
```

现在这让我很困扰。它建议基于范围的导航，但是在我只获取页码的情况下，我实际上如何做到这一点。它如何防止这个进程成为 IO 绑定的？

任何详细/解释的答案？

# sql - App=EntityFramework 在 Sql 连接字符串中有什么作用？

> ID：15519276
> 
> 赞同：32
> 
> 时间：2013-03-20T09:08:16.310
> 
> 标签：sql, sql-server, database, entity-framework, connection-string

我有 2 个连接字符串 - 1 个本地和 1 个用于我的主要生产服务器。Entity Framework 在我安装它（4.1）时将 App=EntityFramework 添加到我的本地字符串中 - 我现在在 4.3 上。这是做什么的 - 我找不到任何参考？

这是我的本地连接字符串：

```
<add name="LocalConnection"
      providerName="System.Data.EntityClient"
      connectionString="metadata=
      res://*/;
      provider=System.Data.SqlClient;
      provider connection string='
      Data Source=.\SQLEXPRESS;
      AttachDBFilename=C:\mypath\MyDb.mdf;
      Integrated Security=True;
      User Instance=True;
      MultipleActiveResultSets=True;
      App=EntityFramework'" /> 
```

只是好奇！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2014-08-13T04:02:07.100

应用程序和应用程序名称只是调试 SQL Server 的人了解哪个客户端正在连接它的一种方式。如果您的 SQL Server 有多个使用它的应用程序，则可能很难知道哪个应用程序发送了哪些语句。如果每个应用程序使用不同的应用程序名称，那就很清楚了。

[查看此内容以](http://www.connectionstrings.com/use-application-name-sql-server/)获取更多信息。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-20T09:14:12.980

它只是应用程序名称的同义词。

您可以看到此处列出的连接字符串属性：

[http://msdn.microsoft.com/en-gb/library/system.data.sqlclient.sqlconnection.connectionstring.aspx](http://msdn.microsoft.com/en-gb/library/system.data.sqlclient.sqlconnection.connectionstring.aspx)

# iphone - 如何从图像 url 显示 UIImage

> ID：15519277
> 
> 赞同：0
> 
> 时间：2013-03-20T09:08:18.550
> 
> 标签：iphone, ios

如果我静态给出，下面的代码可以正常工作，但是

```
imgDescView.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:
[NSURL URLWithString:[NSString stringWithFormat:@"http://4cing.com/mobile_app/uploads/pageicon/6.jpg"]]]]; 
```

相同的代码 - 我正在动态传递图像 url 名称它不起作用

```
imgDescView.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:
[NSURL URLWithString:[NSString stringWithFormat:@"%@",[imagename objectAtIndex:0]]]]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:24:32.460

您需要验证`NSArray`内容。注销数组的对象：

```
NSLog(@"imagename = %@",[imagename description]); 
```

此外，附带说明 - 可能需要考虑动态加载该图像。我写了一个类，使这非常轻松：

[https://stackoverflow.com/a/9786513/585320](https://stackoverflow.com/a/9786513/585320)

答案是针对使用 in `TableViews`（延迟确实会损害性能），但是您可以（而且我确实）将其用于任何 Web 图像加载。这样可以保持 UI 流畅并且速度非常快。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-09T10:41:11.237

嗨以这种方式创建网址

```
[NSURL URLWithString:[[NSString stringWithFormat:@"%@",[imagename objectAtIndex:0]] stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]] 
```

我认为它会起作用并且会解决你的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T10:16:56.610

```
NSMutableArray *imagename = [[NSMutableArray alloc] initWithObjects:@"http://4cing.com/mobile_app/uploads/pageicon/6.jpg", nil];
UIImageView *imgDescView = [[UIImageView alloc] initWithFrame:CGRectMake(0,0, 200, 200)];

imgDescView.image = [UIImage imageWithData:[NSData dataWithContentsOfURL:
                                            [NSURL URLWithString:[NSString stringWithFormat:@"%@",[imagename objectAtIndex:0]]]]]; 
```

它正在工作......我认为你没有正确创建数组。

# android - 如何删除android数据库中空列的行？

> ID：15519279
> 
> 赞同：0
> 
> 时间：2013-03-20T09:08:24.437
> 
> 标签：android, sql, database

这是一个直截了当的问题。

我已经做了什么：

```
sql.delete(TBL_ITEMS, KEY_TOTAL_AMOUNT + "=" + "", null); 
```

或者

```
sql.delete(TBL_ITEMS, KEY_TOTAL_AMOUNT + "=" + null, null); 
```

还有其他方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:09:47.050

那么你可以试一试：

```
sql.delete(TBL_ITEMS, KEY_TOTAL_AMOUNT + " IS NULL", null); 
```

# jquery - 仅数字文本框不工作 IME 启用

> ID：15519289
> 
> 赞同：0
> 
> 时间：2013-03-20T09:08:53.830
> 
> 标签：jquery, textbox, numeric

我正在使用以下函数仅使文本框数字化

```
 $(document).ready(function() {
        $(".numeric_text_box").keydown(function(event) {

    if(event.keyCode==9)
  return true;
 if(event.shiftKey)
    event.preventDefault();
if (event.keyCode == 46 || event.keyCode == 8) {
  }
else {
      if (event.keyCode < 95) {
       if (event.keyCode < 48 || event.keyCode > 57) {
            event.preventDefault();
      }
    } 
    else {
          if (event.keyCode < 96 || event.keyCode > 105) {
              event.preventDefault();
          }
    }
  }
  });
}); 
```

我的文本框是

```
 <input type="text" style="ime-mode:disabled" maxlength="100" name="txt_1" class="numeric_text_box" value=""> 
```

我的问题是，当系统语言更改为日语时，我无法使用谷歌浏览器在我的文本框中输入整数值。有什么解决方案吗？

# iphone - 调试iOS异常的好方法

> ID：15519290
> 
> 赞同：2
> 
> 时间：2013-03-20T09:08:54.860
> 
> 标签：iphone, ios

我想在我的应用程序中调试我的异常，我已阅读

[调试 -[NSCFDictionary setObject:forKey:]: 尝试插入 nil 值](https://stackoverflow.com/questions/5752070/debugging-nscfdictionary-setobjectforkey-attempt-to-insert-nil-value) 添加等等，但是这些方法是在我运行我的应用程序时发生的，所以我可以使用添加异常断点，单击底部的添加 (+) 按钮在断点列表中，点击 Add Exception Breakpoint ，然后使用 gcc 命令行。但我的问题是如果用户给我一个崩溃报告，这个 bug 不容易发生，如何解决它，例如：

```
 Application received signal SIGSEGV
  (null)
 (
0   CoreFoundation                      0x3120e2bb  + 186
1   libobjc.A.dylib                     0x38f2b97f objc_exception_throw + 30
2   CoreFoundation                      0x3120e1c5  + 0
3   myshine                             0x001f9f51 myshine + 1503057
4   libsystem_c.dylib                   0x393a9e8b _sigtramp + 34
5   myshine                             0x000ac985 myshine + 137605
6   myshine                             0x000ac35d myshine + 136029
7   CoreFoundation                      0x311ab7cf  + 74
8   CoreFoundation                      0x311b1623  + 74
9   CoreFoundation                      0x311ab507  + 326
10  CFNetwork                           0x30f0fa8b  + 98
11  CFNetwork                           0x30f0ec71  + 36
12  CFNetwork                           0x30f11365  + 44
13  CFNetwork                           0x30f110f9  + 88
14  CFNetwork                           0x30f114ff  + 34
15  CFNetwork                           0x30ed0ce1  + 324
16  CFNetwork                           0x30ed1661  + 156
17  CFNetwork                           0x30f0ec71  + 36
18  CFNetwork                           0x30f11365  + 44
19  CoreFoundation                      0x311e3683  + 14
20  CoreFoundation                      0x311e2ee9  + 212
21  CoreFoundation                      0x311e1cb7  + 646
22  CoreFoundation                      0x31154ebd CFRunLoopRunSpecific + 356
23  CoreFoundation                      0x311b39bb CFRunLoopRun + 98
24  myshine                             0x000b20ef myshine + 159983
25  Foundation                          0x31b24e85  + 972
26  libsystem_c.dylib                   0x39382311  + 308
27  libsystem_c.dylib                   0x393821d8 thread_start + 8 
```

)

和

```
*** -[__NSArrayM objectAtIndex:]: index 121 beyond bounds [0 .. 23]

 (
0   CoreFoundation                      0x311963ff  + 186
1   libobjc.A.dylib                     0x38e87963 objc_exception_throw + 30
2   CoreFoundation                      0x310e1ef9  + 164
3   myshine                             0x001720b1 myshine + 1372337
4   UIKit                               0x33090087  + 70
5   UIKit                               0x3309003b  + 30
6   UIKit                               0x33090015  + 44
7   UIKit                               0x3308f8cb  + 502
8   UIKit                               0x3308fdb9  + 488
9   UIKit                               0x32fb85f9  + 524
10  UIKit                               0x32fa58e1  + 380
11  UIKit                               0x32fa51ef  + 6198
12  GraphicsServices                    0x34cbc5f7  + 590
13  GraphicsServices                    0x34cbc227  + 34
14  CoreFoundation                      0x3116b3e7  + 34
15  CoreFoundation                      0x3116b38b  + 138
16  CoreFoundation                      0x3116a20f  + 1382
17  CoreFoundation                      0x310dd23d CFRunLoopRunSpecific + 356
18  CoreFoundation                      0x310dd0c9 CFRunLoopRunInMode + 104
19  GraphicsServices                    0x34cbb33b GSEventRunModal + 74
20  UIKit                               0x32ff92b9 UIApplicationMain + 1120
21  myshine                             0x00026ec7 myshine + 16071
22  myshine                             0x00025660 myshine + 9824
 ) 
```

通过我知道 NSArray 超出了界限，但是我的应用程序有很多 NSArray，而且它们是用户报告，你能给我一些简单的方法来找到位置吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:42:49.470

从您的问题中，我了解到您想要在您的应用程序中产生崩溃的方法。可能这可以帮助您[符号化 iPhone 应用程序崩溃报告](https://stackoverflow.com/questions/1460892/symbolicating-iphone-app-crash-reports)。

# eclipse - Eclipse 一个 JSP 显示黑色但不显示其他

> ID：15519291
> 
> 赞同：0
> 
> 时间：2013-03-20T09:08:55.397
> 
> 标签：eclipse, jsp, syntax-highlighting

一个特定的 JSP 文件现在以黑白方式呈现，而它曾经是语法彩色
的。同一项目中的其他 JSP 文件被正确呈现。
考虑到语法错误，我试图剪切部分代码，但它没有改变任何东西。

什么会导致这种行为？

**编辑**：
由于语法很好并且重新启动 Eclipse 没有帮助，我只是将代码复制/粘贴到一个新文件中，删除了以前的并将新重命名为以前的。俗气，但有效。
我还是想明白...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-06T07:30:59.337

最近我遇到了同样的问题......

添加这个：

```
<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
pageEncoding="ISO-8859-1"%> 
```

到我的 .jsp （并重新打开文件）解决了我的问题。

并且不要忘记在**JSP 编辑器中打开它**

![JSP编辑器](../Images/c540b72b622c4546786561b581d1b42e.png)

也许您上次在**文本编辑器中打开它？**

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:19:05.407

我也有这个问题。你包括标签库吗？

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"% 
```

这样的事情可能是错误（最后没有>）。您是否处于 Java EE 的角度？

如果没有任何帮助，只需创建一个新的 JSP，编写一些有效的代码（确保语法突出显示），然后将“黑白”代码复制粘贴到其中。如果突出显示消失，您可以确定您有一些语法错误。旧的“重启 Eclipse”也可能有所帮助。

# mysql - MySQL 使用旧值和新字符串更新 varchar 值

> ID：15519293
> 
> 赞同：1
> 
> 时间：2013-03-20T09:08:55.933
> 
> 标签：mysql, string, concatenation

我在表格中有一堆图像参考，例如：

```
data/fabrics/signature/signature1.jpg
data/fabrics/signature/signature2.jpg 
```

我需要浏览表格并在图像路径中添加一个额外的文件夹，例如：

```
data/group1/fabrics/signature/signature1.jpg
data/group1/fabrics/signature/signature2.jpg 
```

有没有办法只用 MySQL 查询来做到这一点，还是我需要使用 PHP 来连接字符串然后更新数据库？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:34:10.903

您可以使用一个简单的替换函数，用不同的开头替换字符串的开头。如果更换如此简单，这可能是最简单的解决方案。

```
UPDATE tbl SET col=REPLACE(col, 'data/fabrics', 'data/group1/fabrics') WHERE xxx; 
```

`WHERE`您可能必须使用不同的子句运行其中的几个，具体取决于所需的特定替换。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:43:37.263

```
update table1
set link=substring(link,1,charindex('/',link,1))+
         'group1'+substring(link,charindex('/',link,1),LEN(link))
where (your condition) 
```

**[SQL小提琴](http://sqlfiddle.com/#!3/efd0b/2)**

# android - 从非启动器应用程序中选择和启动快捷方式

> ID：15519294
> 
> 赞同：2
> 
> 时间：2013-03-20T09:09:01.037
> 
> 标签：android, android-intent, android-activity, shortcut

我想做的是以下几点：

1.  用户从系统中所有可用快捷方式的列表中选择一个快捷方式；
2.  存储相关信息；
3.  用户执行操作并执行选定的快捷方式，就像它是主屏幕上的图标一样。

到目前为止，我能够使用 `getPackageManager().queryIntentActivities(new Intent(Intent.ACTION_CREATE_SHORTCUT), 0);`. 选择快捷方式后，我开始`ACTION_CREATE_SHORTCUT`打算自定义快捷方式参数 - 它呈现正确的 UI 并且似乎可以工作。我使用此代码来启动意图：

```
ActivityInfo activity = resolveInfo.activityInfo;
ComponentName name = new ComponentName(activity.applicationInfo.packageName, activity.name);
Intent i = new Intent(Intent.ACTION_CREATE_SHORTCUT);
i.addCategory(Intent.CATEGORY_DEFAULT);
i.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
i.setComponent(name);
startActivityForResult(i, 1); 
```

这是我的 onActivityResult：

```
@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        if (requestCode==1 && resultCode == RESULT_OK) {
            try {
                startActivity((Intent) data.getExtras().get(Intent.EXTRA_SHORTCUT_INTENT));
            } catch (Exception e) {             
                e.printStackTrace();
            }
            Toast.makeText(getApplicationContext(), "Success!!", Toast.LENGTH_LONG).show();
            finish();
        }else{
            Toast.makeText(getApplicationContext(), "Fail: "+resultCode+" "+resultCode, Toast.LENGTH_LONG).show();
        }
        super.onActivityResult(requestCode, resultCode, data);
    } 
```

现在，问题是`onActivityResult`总是在`startActivityForResult`requestCode=0、resultCode=0 且没有数据的情况下立即触发。它不会在`ACTION_CREATE_SHORTCUT`活动实际结束时触发。我真的不明白。我认为在活动结束后，它应该返回我发送给它的 requestCode 和数据意图，其中包含`Intent.EXTRA_SHORTCUT_INTENT`我可以用***某种方式***实际启动快捷方式的数据意图。

问题的第二部分是我如何实际存储用户选择的快捷方式的必要信息，最好是在 中`SharedPreferences`，以便我以后可以使用特定参数执行此快捷方式。我找不到任何这样的例子。

任何帮助将非常感激！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2015-05-14T10:17:25.747

2年后，这是我问题的答案：

`startActivityForResult`/系统的正常运行`onActivityResult`显然取决于调用和被调用的活动都是同一任务的一部分。因此，***任何***会导致两个活动在不同任务中启动的操作都会破坏此功能。`launchMode`此类操作包括为 中的任何活动设置任何独占`AndroidManifest.xml`或使用标志，例如`Intent.FLAG_ACTIVITY_NEW_TASK`在启动两个活动中的任何一个时。

为解决方案投票支持 user2427931 的答案`Intent.parseUri()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-28T09:41:29.260

当我的调用活动有launchMode =“singleInstance”时，我有同样的行为。你也定义了吗？

关于保存意图。您可以将意图转换为 URI 并将其保存为 SharedPreferences 中的字符串。然后，您可以在检索到 Intent.pareseUri() 后使用它。

//Erty

# python - PyObjC 使用 NSTableView 崩溃

> ID：15519296
> 
> 赞同：1
> 
> 时间：2013-03-20T09:09:02.817
> 
> 标签：python, pyobjc

我想用 PyObjC 制作 NSTableView。所以我写了如下代码。这段代码有效，至少我可以看到 TableView。但是当我激活时`tableView:objectValueForTableColumn:row:`（该方法在下面注释掉）python 因分段错误而崩溃。

我想知道我在哪里犯了错误。谢谢。

```
class WindowController(object):

    def numberOfRowsInTableView_(self, table):
        return 2000

    #def tableView_objectValueForTableColumn_row_(self, table, column, row):
    #    return 'hi'

    def initMainWindow(self):
        windowRect = NSMakeRect(0.0, 0.0, 300.0, 500.0)
        self.window = NSWindow.alloc().initWithContentRect_styleMask_backing_defer_(
                windowRect,
                NSTitledWindowMask
                    | NSClosableWindowMask
                    | NSResizableWindowMask
                    | NSMiniaturizableWindowMask
                    | NSTexturedBackgroundWindowMask,
                NSBackingStoreBuffered,
                False)
        self.window.setDelegate_(self.delegate)
        self.view = self.initView()
        self.window.contentView().addSubview_(self.view)
        self.window.display()
        self.window.orderFrontRegardless()

    def initView(self):
        tableContainer = NSScrollView.alloc().initWithFrame_(NSMakeRect(0,0,300, 500))
        tableView = NSTableView.alloc().initWithFrame_(NSMakeRect(0,0,300,500))
        column1 = NSTableColumn.alloc().initWithIdentifier_("Col1")
        tableView.addTableColumn_(column1)
        tableView.setDelegate_(self)
        tableView.setDataSource_(self)
        tableView.reloadData()

        tableContainer.setDocumentView_(tableView)
        tableContainer.setHasVerticalScroller_(True)
        return tableContainer 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T11:36:36.743

我解决了问题。我需要实现如下数据源协议：

```
class MyDataSource(NSObject, objc.protocolNamed('NSTableViewDataDource')):
    def numberOfRowsInTableView_(self, table):
        return 1000
    def tableView_objectValueForTableColumn_row_(self, table, column, row):
        return 'xyzzy' 
```

然后，在 TableViewController 类中，像下面这样设置 DataSource：

```
ds = MyDataSource.alloc().init()
myTableView.setDataSource_(ds) 
```

现在一切正常。

# php - CakePHP 中 Web 服务的错 误返回格式

> ID：15519297
> 
> 赞同：0
> 
> 时间：2013-03-20T09:09:08.393
> 
> 标签：php, web-services, cakephp, csv

我在返回 Web 服务时遇到问题，标头如下所示：

```
header('Content-type: application/vnd.ms-excel');
header('Content-Disposition: attachment; filename="'.$this->filename.".csv".'"'); 
```

我收集数据并像这样返回它：

```
 foreach($this->output_data as $each_table) {
        foreach($each_table as $each_row) {
            foreach($each_row as $each_key => $each_value){ 
                $string .= Sanitize::escape($each_value).$this->delimiter;
            }                              
            $string .= "\n";
        }            
    }
    print($string); 
```

我希望 csv 文件作为流回来。但返回的是“ *Firefox HTML 文档*”。我不明白。

我已经关闭了控制器中的视图渲染。我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-26T12:49:41.730

为什么只从控制器或模型中回显一些格式化的字符串是不正确的。我发现有一个 Response-Class 可以使用。下面的代码：

```
$this->response->header(array( 'Content-Disposition: attachment; filename="<filename.ext>"));
$this->response->type('application/text-csv');                     
$this->response->body(<returnData>); 
```

一定要使用正确的“类型”。

# cuda - CUDA Makefile 包含错误

> ID：15519298
> 
> 赞同：0
> 
> 时间：2013-03-20T09:09:19.080
> 
> 标签：cuda, makefile, include

我正在尝试使用 CUDA 和 C 编写一个基本的矩阵乘法程序。代码本身现在并没有真正做任何事情，但至少应该编译。经过对该问题的一些研究，我确定问题是未能包含 CUDA 头文件，这表明我的 Makefile 存在问题。我对 CUDA（以及 C 语言）非常缺乏经验，因此我们将不胜感激任何帮助。

命令输出：make matrixMult1

```
c99    -I. -I/usr/local/cuda/include -c matrixMult1.c -o matrixMult1.o
matrixMult1.c: In function 'main':
matrixMult1.c:77: warning: implicit declaration of function 'cudaMalloc'
matrixMult1.c:82: warning: implicit declaration of function 'cudaMemcpy'
matrixMult1.c:83: error: 'cudaMemcpyHostToDevice' undeclared (first use in this
function)
matrixMult1.c:83: error: (Each undeclared identifier is reported only once
matrixMult1.c:83: error: for each function it appears in.)
matrixMult1.c:106: warning: implicit declaration of function 'cudaFree'
make: *** [matrixMult1.o] Error 1 
```

生成文件：

```
GCC = c99
CUDA_INSTALL_PATH := /usr/local/cuda
INCLUDES := -I. -I$(CUDA_INSTALL_PATH)/include
CUDA_LIBS := -L$(CUDA_INSTALL_PATH)/lib -lcudart

matrixMult1.o:          matrixMult1.c
                $(GCC)  $(INCLUDES) -c matrixMult1.c -o $@

matrixMult1:            matrixMult1.o
                $(GCC)  -o $@ matrixMult1.o $(CUDA_LIBS) 
```

C程序：

```
//********************************************************************
// matrixMult1.c
//
// A basic matrix multiplication program.
//********************************************************************

#include <stdlib.h>
#include <stdio.h>
#include <math.h>
#include "cuda.h"

#define WA 3
#define HA 3
#define WB 3
#define HB WA
#define WC WB
#define HC HA

void initMatrix(float * matrix, int numIndices);

//*************
// Main Program
//*************
int main(int argc, char** argv) {

    /* Set random seed */
    srand(2013);

    /* Compute memory sizes for matrices A, B, and C */
    unsigned int sizeA = WA * HA;
    unsigned int sizeB = WB * HB;
    unsigned int sizeC = WC * HC;
    unsigned int memoryA = sizeof(float) * sizeA;
    unsigned int memoryB = sizeof(float) * sizeB;
    unsigned int memoryC = sizeof(float) * sizeC;

    /* Allocate memory for matrices A, B, and C */
    float * matrixA = (float *) malloc(memoryA);
    float * matrixB = (float *) malloc(memoryB);
    float * matrixC = (float *) malloc(memoryC);

    /* Initialize matrices A and B */
    initMatrix(matrixA, sizeA);
    initMatrix(matrixB, sizeB);

    /* Print matrix A */
    printf("\nMatrix A:\n");
    for (int i = 0; i < sizeA; i++) {
        printf("%f ", matrixA[i]);

    if (((i + 1) % WA) == 0) {
        printf("\n");
    } else {
        printf(" | ");
    }
    }

    /* Print matrix B */
    printf("\nMatrix B:\n");
    for (int i = 0; i < sizeB; i++) {
    printf("%f ", matrixB[i]);

    if (((i + 1) % WA) == 0) {
        printf("\n");
    } else {
        printf(" | ");
    }
    }

    /* Allocate device memory */
    float* deviceMemA;
    float* deviceMemB;
    float* deviceMemC;
    cudaMalloc((void**) &deviceMemA, memoryA);
    cudaMalloc((void**) &deviceMemB, memoryB);
    cudaMalloc((void**) &deviceMemC, memoryC);

    /* Copy host memory to device */
    cudaMemcpy(deviceMemA, matrixA, memoryA,
           cudaMemcpyHostToDevice);
    cudaMemcpy(deviceMemB, matrixB, memoryB,
               cudaMemcpyHostToDevice);
    cudaMemcpy(deviceMemC, matrixC, memoryC,
           cudaMemcpyHostToDevice);

    /* Print matrix C */
    printf("\nMatrix C:\n");
    for (int i = 0; i < sizeC; i++) {
    printf("%f ", matrixC[i]);

    if (((i + 1) % WC) == 0) {
        printf("\n");
    } else {
        printf(" | ");
    }
    }
    printf("\n");

    /* Free up memory */
    free(matrixA);
    free(matrixB);
    free(matrixC);
    cudaFree(deviceMemA);
    cudaFree(deviceMemB);
    cudaFree(deviceMemC);
}

//--------------------------------------------------------------------
// initMatrix - Assigns a random float value to each indice of the
//              matrix.
//
// PRE:  matrix is a pointer to a block of bytes in memory; numIndices
//       is the number of indicies in the matrix being instantiated.
// POST: Each index of the matrix has been instantiated with a random
//       float value.
//--------------------------------------------------------------------
void initMatrix(float * matrix, int numIndices) {

    /*
    Loop through the block of bytes, assigning a random float
    for each index of the matrix
    */
    for (int i = 0; i < numIndices; ++i) {

    /* Assign a random float between 0 and 1 at this byte */
    matrix[i] = rand() / (float)RAND_MAX;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:38:06.490

这里有两个问题：

1.  您没有在代码中包含适当的标头（您已修复）
2.  实际上，您的 Makefile 已损坏。它应该看起来像：

```
GCC = c99
CUDA_INSTALL_PATH := /usr/local/cuda
INCLUDES := -I. -I$(CUDA_INSTALL_PATH)/include
CUDA_LIBS := -L$(CUDA_INSTALL_PATH)/lib -lcudart

matrixMult1.o:          matrixMult1.c
                $(GCC) $(INCLUDES) -c matrixMult1.c -o $@

matrixMult1:            matrixMult1.o
                $(GCC) -o $@ matrixMult1.o  $(CUDA_LIBS) 
```

[免责声明：未经测试，使用风险自负]

当前的问题是包含路径仅在构建的链接阶段指定。

请注意，这些更改还抢占了您在链接期间因未与 CUDA 运行时库链接而出现的缺失符号错误。请注意，根据您使用的是 32 位还是 64 位主机操作系统，您可能需要将库路径更改`$(CUDA_INSTALL_PATH)/lib64`为 以使链接正常工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T11:01:37.787

CUDA 程序需要通过`nvcc`. 虽然您的程序还没有包含任何 CUDA 内核，但我相信这就是您想要实现的目标。

将您的文件从 重命名`matrixMult1.c`为`matrixMult1.cu`，删除该`#include "cuda.h"`行（使用编译的程序`nvcc`不需要任何特定于 CUDA 的包含）并使用`nvcc`而不是编译`gcc`（例如，通过`GCC = nvcc`在 Makefile 的开头进行设置）。

# sql - 检查列中不同值的优化方法

> ID：15519302
> 
> 赞同：4
> 
> 时间：2013-03-20T09:09:36.267
> 
> 标签：sql, sql-server, query-performance

我正在从一列（大约 50k 条记录的表）中寻找答案，我只需要检查该列中是否至少有两个不同的值。

```
Select Count(Distinct ColumnA)
from tableX 
```

上面的查询给了我输出，但这不是优化的方式，因为我只想要一个布尔值的答案

即计数是否大于 1 或否？

此外，tableX 中的记录数增加会恶化查询性能，我正在寻找与表记录数无关的东西。任何帮助表示赞赏:) 谢谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T10:14:55.537

```
SELECT CASE
         WHEN COUNT(*) = 2 THEN 'Yes'
         ELSE 'No'
       END
FROM   (SELECT DISTINCT TOP 2 ColumnA
        FROM tableX
        WHERE ColumnA IS NOT NULL) T 
```

可能会给您一个在`DISTINCT`找到前两个值后停止处理的计划。

检查执行计划是否使用流聚合或 a `HASH MATCH (FLOW DISTINCT)`，因为它们都是非阻塞的。如果`DISTINCT`实现为`HASH MATCH`without`(FLOW DISTINCT)`那么这是阻塞的，所有行仍将被处理。

例如，这两个计划都停止而不处理所有行。

[![计划](../Images/f991c7c14926f7f692c93a287be8131a.png)](https://i.stack.imgur.com/QphAs.png)

# cmd - CMD 并在寻找 IP 时设置 /p

> ID：15519306
> 
> 赞同：-2
> 
> 时间：2013-03-20T09:09:59.367
> 
> 标签：cmd

我有一个小程序用于测试，将放在我的大程序中。

所以我想在 set /p var= 变量中输入一个 IP 地址，但它只能是数字。不是信。即，如果我要进入 facebook.com，它会抛出一个错误，即 echo Invaild 并暂停

因此，如果我在 IP 构造器 192.168.1.4 中输入 IP，它将回显 Valid。但是，如果我在 IP 结构中输入了一堆数字，例如 544564212.545，它将调用错误标签/标记事物 (:marker) 并回显无效。所以它只能在 IP 结构字符串上工作。

谢谢你们所有的帮助。我的程序将在几天后可用。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:47:54.283

尝试这个：

```
set /p var=Enter IP address: 
set var=%var: =%
echo %var%|findstr /rc:"^[0-9][0-9]*\.[0-9][0-9]*\.[0-9][0-9]*\.[0-9][0-9]*$" >nul
if %errorlevel% equ 0 (
  echo Valid IP address.
) else (
  echo Not a valid IP address.
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T16:30:41.387

我做了一个稍微复杂的脚本。你应该从命令行调用它：`<script.cmd> IP`例如。`<script.cmd> 192.168.1.4`.

```
@echo off &setlocal enabledelayedexpansion
set "var=%~1"
set "flag="

for /f "tokens=1-4delims=." %%i in ("%var%") do set /a var1=%%i, var2=%%j, var3=%%k, var4=%%l
for /l %%i in (1,1,4) do if %%i neq 1 (set "var0=!var0!.!var%%i!") else set "var0=!var%%i!"
for /l %%i in (1,1,4) do if "!var%%i!" equ "" set "flag=1"
if not defined flag for /l %%i in (1,1,4) do if !var%%i! lss 0 set "flag=1"
if not defined flag for /l %%i in (1,1,4) do if !var%%i! gtr 255 set "flag=1"
if defined flag (echo "%var0%" is NOT a valid IP.) else echo "%var0%" is a valid IP.
endlocal 
```

# mysql - BigInt 类型可以进行全文搜索吗？

> ID：15519314
> 
> 赞同：0
> 
> 时间：2013-03-20T09:10:18.790
> 
> 标签：mysql, full-text-search, pattern-matching

我正在使用以下查询来搜索文本，

```
 $query = "SELECT SQL_CALC_FOUND_ROWS *," .
                "MATCH (keywords) AGAINST ('". $searchString ."'IN BOOLEAN MODE ) AS rel1, ".
                "MATCH (title) AGAINST ('". $searchString  ." 'IN BOOLEAN MODE ) AS rel2, ".
                "MATCH (description) AGAINST ('". $searchString  ." 'IN BOOLEAN MODE) AS rel3 ".
                "WHERE MATCH (keywords,title,description) AGAINST ('" .$searchString. "' IN BOOLEAN MODE) " .
                "FROM cron_video " .
                "ORDER BY (rel1*1.5)+(rel2*1.25)+(rel3*1) desc, `cron_status` ASC LIMIT $start, $pagesize"; 
```

但是，下面的搜索查询`id`给出了 BigInt 类型的错误。

```
$query = "SELECT SQL_CALC_FOUND_ROWS *," .
            "MATCH (id) AGAINST ('*". $searchString ."*' IN BOOLEAN MODE ) AS rel1," .          
            "FROM cron_video " . 
            "WHERE MATCH (id) AGAINST ('*" .$searchString. "*' IN BOOLEAN MODE) AS rel2" .
            "ORDER BY (rel1*1.5)+(rel2) desc, `cron_status` ASC LIMIT $start, $pagesize"; 
```

我的疑问：
1\. BigInt 类型是否可以进行全文搜索。

关于第一个查询：

1.  我不确定我可以为相关因子（即）1.5（rel1*1.5）、（rel2*1.25）、rel3 等给出什么值......这个值本身是否足够，或者我如何确定最佳相关因子。
2.  有什么方法可以优化第一个查询。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:12:35.263

[从文档中：](http://dev.mysql.com/doc/refman/5.0/en/fulltext-search.html)

```
Full-text indexes can be used only with MyISAM tables, and can be created only for CHAR, VARCHAR, or TEXT columns. 
```

请记住，`SELECT * FROM ...`选择字段的方式对性能不友好。而是仅选择您需要的字段。例如：`SELECT f1, f2, f3 FROM t1`。会好很多。

**编辑**

对不起，我的错，在布尔模式下，分数是 0 或 1。所以你的代码是正确的。

# three.js - 如何通过顶点操作制作“火车效果”？

> ID：15519319
> 
> 赞同：1
> 
> 时间：2013-03-20T09:10:32.163
> 
> 标签：three.js, translation, vertex

我试图用three.js 做到这一点

我有这个 PlaneGeometry（一个矩形），我希望它沿着 CircleGeometry 的顶点移动，就像轨道上的火车一样。

知道如何真正顺利地实现这一目标吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-27T13:19:05.077

你可以把你的`THREE.Mesh`和`.add(object)`它带到你`new THREE.Object3`的中心`THREE.CircleGeometry`，然后将你的位置移到`THREE.Mesh`圆的边缘`.set(x,y,z)`。请注意，现在您的网格已添加到 object3，您的网格的位置将相对于 object3。这意味着当您旋转 object3 时，平面将围绕它旋转，并最终围绕圆旋转。我描述的方式只适用于圈子。如果您想要更复杂的形状，我会使用`THREE.Spline`.

希望这可以帮助。

# mongodb - 在客户端加载数据库时的流星性能

> ID：15519320
> 
> 赞同：1
> 
> 时间：2013-03-20T09:10:32.300
> 
> 标签：mongodb, meteor

我有一个列出书籍的 Meteor 应用程序。单击一本书会显示其章节列表，单击一个章节会显示其评论列表。现在我试图弄清楚如何优化 Meteor 客户端的性能。

我主要关心的是我应该如何构建我的集合以及是否有任何方法可以让服务器知道首先发送哪些数据。我是 NoSQL 的新手，但似乎正确的 Mongo 方法是让章节成为一本书的子文档，而评论则是章节的子文档。

但是，我不希望客户端必须等到所有章节和评论都加载到客户端数据库中才能显示书籍列表。我想我可以使用关系数据库配置，但我不确定我是否可以强制 Meteor 先发送书籍表，或者使用 Meteor 和关系数据库是否会给我带来任何其他问题。

另外，由于我只是传输文本，也许这不会有太大问题？任何建议表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T20:19:46.900

有两个原则你应该记住

*   您不必每次都发布所有内容
*   订阅的是客户，这决定了订单

为了发布没有章节的书籍列表，您可以使用这样的查询

```
Meteor.publish( "booksList", function () {
   return Books.find( {}, {fields: {bookName: 1}} );
} ); 
```

这应该返回一个只有两个属性的集合：_id 和 bookName

在第二次发布中，您可以发送整个内容，但一次只能发送一本书：

```
Meteor.publish( "fullBook", function ( bookId ) {
   return Books.find( {_id: bookId} );
} ); 
```

在客户端上，您应该确保在使用结果之前等待发布发生。

当然，这一切都是未经测试的。我提前为这些错误道歉。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-09-05T06:07:17.377

你应该只发布必要的文件。否则你的应用程序会减慢参考[这个链接。](http://jsuniversity.blogspot.com/2017/09/best-meteor-performance-techniques.html)

# actionscript-3 - 用户可以绘制区域闪光

> ID：15519325
> 
> 赞同：0
> 
> 时间：2013-03-20T09:10:53.623
> 
> 标签：actionscript-3, flash, user-input

我只是需要一些关于我将如何进行这个项目的灵感，并希望有一个人可以为我指明正确的方向。:-)

我正要开始添加一个 Flash 横幅，它应该允许用户喷涂一个区域，当他们已经绘制了 60% 以上的区域时，当他们释放鼠标时会显示一些东西。我见过很多这样的事情次 - 但我需要一些关于如何完成的建议？

我一直在用谷歌搜索，但似乎找不到任何关于它的东西，所以我希望这里的人能够指导我。:-)

# python - 从空格缩进结构化文件中有效地提取文本块

> ID：15519327
> 
> 赞同：0
> 
> 时间：2013-03-20T09:11:05.027
> 
> 标签：python, parsing, text

我有一个使用空格构造的大型源代码文件。我只对结构化文本文件的一个特定部分感兴趣，如下所示：

```
 SP : STRUCT  
    Spare : STRUCT  //Spare
     Val : INT  := 100; 
     UpLim : INT  := 100;   
     LoLim : INT ;  
     Def : INT  := 100; 
     Prot : INT  := 2;  
    END_STRUCT ;    
   END_STRUCT ; 
```

如您所见，定义了一个“SP”结构（它们将在整个源代码中点缀，但名称相同），其中包含一个或多个相同类型的其他结构。在此示例中，只有一个，称为“备用”。每个结构将始终包含相同的 5 个元素。如果未定义任何值，则为零。

提取结构名称及其元素值的最优雅方法是什么？提取后，它们将存储在字典中，以便快速轻松地访问。

我尝试过使用正则表达式，但我不确定它是否是解决这个特定问题的一个非常有效的解决方案。通常采取什么方法来解决这样的问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:48:20.083

此代码似乎使用了类似 algol 的大括号 ( `struct/end_struct`)。我不认为缩进在语法上很重要。因此解析器应该是基于关键字的，例如：

```
import re

def parse(data):
    stack = [{}]

    for x in data.splitlines():
        x = re.sub(r'\s+', '', x)

        m = re.match(r'(\w+):STRUCT', x)
        if m:
            d = {}
            stack[-1][m.group(1)] = d
            stack.append(d)
            continue

        m = re.match(r'(\w+):INT(?::=(\w+))?', x)
        if m:
            stack[-1][m.group(1)] = int(m.group(2) or 0)
            continue

        m = re.match(r'END_STRUCT', x)
        if m:
            stack.pop()
            continue

    return stack[0] 
```

结果：

```
data = """
   SP : STRUCT  
    Spare : STRUCT  //Spare
     Val : INT  := 100; 
     UpLim : INT  := 100;   
     LoLim : INT ;  
     Def : INT  := 100; 
     Prot : INT  := 2;  
    END_STRUCT ;    
   END_STRUCT ; 
"""

print parse(data)
# {'SP': {'Spare': {'LoLim': 0, 'Prot': 2, 'Def': 100, 'UpLim': 100, 'Val': 100}}} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:24:57.677

如果你只想提取 SP : STRUCT 并且你想手动解析它（当你这样做时要小心），你可以使用这样的东西：

```
data = {}
found = False
with open("code.txt", "r") as code:
    for line in code.readline():
        clean = line.split("//")[0].strip().rstrip(";").split(":")
        fields = map(lambda f: f.strip(), clean)
        if found and fields[0].upper() == "END_STRUCT":
            break
        elif len(fields) == 2:
            if fields[0].upper() == "SP" and fields[1].upper() == "STRUCT":
                found = True
        elif len(fields) == 3 and found:
            if fields[1].upper() != "STRUCT":
                data[fields[0]] = fields[2].lstrip("=").strip() 
```

出于安全原因，我使用了 .upper() 并检查了 len(fields)，而我使用 .strip() 主要是为了忽略缩进（似乎不需要：没有它，代码可能有效）。

您还可以添加这段代码（在最后一行的相同缩进级别）以正确的格式存储信息：

```
if fields[1].upper() == "INT":
    data[fields[0]] = int(data[fields[2]])
#elif field[1].upper == "SOMETHING_ELSE":
#    data[fields[0]] = convert(data[fields[2]]) 
```

建议：解析时尽量避免使用正则表达式。

# java - 如何将 Jar 转换为 exe 或 msi 包以进行远程部署？

> ID：15519331
> 
> 赞同：3
> 
> 时间：2013-03-20T09:11:24.750
> 
> 标签：java, deployment, jar

**项目：**一个使用 Java 7 的简单 Swing 应用程序。

**目标：**作为 .exe 或 MSI 分发，以便我可以发布应用程序的补丁和更新。

我知道有很多实用程序可以将 jar 文件转换为可执行的 .exe 我的问题是：

1.  我在项目中使用了 Java 7，而目标系统没有 java 7 - 所以我必须在我的包中包含 jre 7？希望我使用的 3 方库与 jar 一起编译。
2.  我要将包远程解散到目标系统有可能吗？
3.  我必须通过部署更新包远程更新已安装的应用程序可以这样做吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:34:27.287

首先，将其作为**.EXE**或**.MSI**文件分发不会为您提供发布补丁/更新和远程处理它们的能力。为此，您需要为该特定应用程序实施您自己的更新管理器，并连接到您的远程存储库。SO讨论这个问题有几个问题：

1.  [我应该如何实现自动更新程序](https://stackoverflow.com/questions/232347/how-should-i-implement-an-auto-updater)
2.  [如何在 Java 中实现自动更新程序](https://stackoverflow.com/questions/10443269/how-to-implement-auto-update-in-java)
3.  [更新产品的最佳方式](https://stackoverflow.com/questions/1906552/best-way-to-update-products?rq=1)

如果您对该主题进行更多研究，您迟早会发现，即使需要“自动更新”，您也不需要**.EXE**或**.MSI**文件，只需考虑 Eclipse IDE，它以**.ZIP**文件的形式分发，它有自己的更新管理器。

但是，我认为当您说“分发为 .exe 或 MSI”时，您实际上是指将其分发为自动安装程序（与自动更新程序不同）。为此，您有多种选择：

1.  如果您只想分发到 Windows 平台（这很遗憾，因为 Java 可以在很多平台上运行），然后尝试使用著名的[NSIS](http://nsis.sourceforge.net/Main_Page)或[WiX 工具集](http://wixtoolset.org/)。
2.  如果您希望它是跨平台的（正如我所推荐的那样），那么在[这个问题](https://stackoverflow.com/questions/1276091/installer-generator-written-in-java)中，您会找到一个包含几个工具的列表来获得它。

# php - 如何在mpdf中添加css文件

> ID：15519335
> 
> 赞同：26
> 
> 时间：2013-03-20T09:11:39.917
> 
> 标签：php, html, ajax, mpdf

我正在尝试使用 mpdf 将 html 转换为 pdf。问题是我无法将 css 应用于 pdf 文件..

这是我的php代码：

```
<?php

    $html = $divPrint;
    $mpdf=new mPDF();
    $stylesheet = file_get_contents('pdf.css');
    $mpdf->WriteHTML($stylesheet,1);
    $mpdf->WriteHTML($html,2);
    $mpdf->Output();
    exit;

?> 
```

它所做的是在我的这个 php 页面上通过 ajax 获取 html。但是它给出的输出没有附带我为它编写的css..

请告诉我现在要做什么？

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-03-22T09:39:45.183

```
 <?php

$html = $divPrint;

include('mpdf.php'); // including mpdf.php
$mpdf=new mPDF();
$stylesheet = file_get_contents('pdf.css'); // external css
$mpdf->WriteHTML($stylesheet,1);
$mpdf->WriteHTML($html,2);
$mpdf->Output();
exit;

?> 
```

1st assign your html in `$html` then include **mpdf.php** file.

# highcharts - 自定义对象 (renderer.circle) 上的 highcharts 工具提示

> ID：15519336
> 
> 赞同：1
> 
> 时间：2013-03-20T09:11:39.910
> 
> 标签：highcharts

我试图找出如何在自定义对象上放置工具提示。特别是在一个圆圈（render.circle）上。

[我在这里](http://jsfiddle.net/aMHTM/33/)找到了一个示例，但它似乎不是跨浏览器（不适用于 IE 9+ 和 Firefox）

有任何想法吗？

$(function () { var isTouch = 'ontouchstart' in document.documentElement;

```
var renderer = new Highcharts.Renderer(
    $('#container')[0], 
    400,
    300
);

var tooltipOptions = Highcharts.getOptions().tooltip;

var tooltip = new Highcharts.Tooltip({
        renderer: renderer,
        plotLeft: renderer.box.clientLeft,
        plotTop: renderer.box.clientTop,
        plotWidth: renderer.box.clientWidth,
        plotHeight: renderer.box.clientHeight
    }, $.extend(tooltipOptions, {
        formatter: function() { return this.text; },
        distance: 0,
        style: $.extend(tooltipOptions.style, {
            pointerEvents: 'none'
        })
    })
 );

tooltip.onMouseOver = function () {
    var self = this._SVGElement;
    tooltip.refresh({
        getLabelConfig: function () {
            return {
                text: self.tooltip
            };
        },
        series: {},
        color: self.fill,
        tooltipPos: [
            self.x || self.cx,
            self.y || self.cy
        ]
    });
};

tooltip.onMouseOut = function () {
    tooltip.hide();
};

if (isTouch) {
    $(renderer.box).bind('click', function (e) {
        tooltip.onMouseOut();
    });
}

var circle = renderer.circle(100, 75, 40).attr({
    fill: '#7C75C5',
    stroke: 'black',
    'stroke-width': 1,
    tooltip: 'THIS IS CIRCLE.'
}).add();
circle.element._SVGElement = circle;

$(circle.element).on('mouseenter', tooltip.onMouseOver).on('mouseleave', tooltip.onMouseOut);

var rectangle = renderer.symbol('triangle-down', 50, 150, 100, 80).attr({
    fill: '#1050C5',
    stroke: 'black',
    'stroke-width': 1,
    tooltip: 'THIS IS TRIANGLE.'
}).add();
rectangle.element._SVGElement = rectangle;

$(rectangle.element).on('mouseenter', tooltip.onMouseOver).on('mouseleave', tooltip.onMouseOut); 
```

});

# c# - 组成表达式 > 谓词

> ID：15519337
> 
> 赞同：2
> 
> 时间：2013-03-20T09:11:41.610
> 
> 标签：c#, entity-framework, lambda, extension-methods, iqueryable

我有一个返回的方法

```
Expression<Func<T, bool>> 
```

当我在 EF 的 where 子句中使用它作为谓词时，这可以正常工作，直到我尝试使用 Expression.Or() 向谓词添加更多项目时，我遇到了以下异常：

> 参数“xxx”未绑定在指定的 LINQ to Entities 查询表达式中。

有没有办法解决这个问题？究竟是什么原因造成的？

**解决了**

使用[http://blogs.msdn.com/b/meek/archive/2008/05/02/linq-to-entities-combining-predicates.aspx](http://blogs.msdn.com/b/meek/archive/2008/05/02/linq-to-entities-combining-predicates.aspx)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:15:15.143

在 EF 中，如果您调用

```
IQueryable<T> query = ...
query.Where( predicate 1 ).Where( predicate 2 )... 
```

然后 EF 将`where`用`AND`

EF 中唯一的方法`OR`是将谓词放在一次调用中`IQueryable.Where`

```
IQueryable<T> query = ...
query.Where( predicate 1 || predicate 2 )... 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T09:42:24.287

要撰写或喜欢 AND，您可以使用[PredicateBuilder](http://www.albahari.com/nutshell/predicatebuilder.aspx)

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-26T06:03:46.290

要在 OR 关系中组合谓词，您可以执行以下操作：

```
predicate = Expression.Lambda<Func<T, bool>>(Expression.Or(predicate.Body, newPredicate.Body), newPredicate.Parameters); 
```

# java - JPA 空对象

> ID：15519340
> 
> 赞同：0
> 
> 时间：2013-03-20T09:11:47.350
> 
> 标签：java, jpa

我有这个 Java 对象，我想用它来显示数据库中的数据。

```
public TData td;

    public class TData {

        private long id;
        private String key;
        private String language;
        private String translation;

        public TData() {
        };

        public TData(long id, String key, String language, String translation) {
            // super();
            this.id = id;
            this.key = key;
            this.language = language;
            this.translation = translation;
        }

        public long getId() {
            return id;
        }

        public void setId(long id) {
            this.id = id;
        }

        public String getKey() {
            return key;
        }

        public void setKey(String key) {
            this.key = key;
        }

        public String getLanguage() {
            return language;
        }

        public void setLanguage(String language) {
            this.language = language;
        }

        public String getTranslation() {
            return translation;
        }

        public void setTranslation(String translation) {
            this.translation = translation;
        }

    }

    public TData getDataObj() {
        return td;
    } 
```

这是我想用来获取数据的数据库表：

```
CREATE TABLE translations (
id  SERIAL NOT NULL, 
KEY VARCHAR(255), 
LANGUAGE VARCHAR(255), 
TRANSLATION VARCHAR(255)
) 
```

我有一个用于进行查询的自定义 JPA 对象：

```
@PostConstruct
    public void loadData() {

        td = new TData();

        String query = "SELECT c FROM Translations c WHERE c.Id = '70'";
        //String query = "SELECT p from translations p where id=70";
        td = (TData) dao.jpqlQuerySingle(query);

    } 
```

当我打开 JSF 页面时，Java 对象是空的。Java 方法`jpqlQuerySingle`用于将结果作为对象返回，但由于某种原因，我得到了空对象。你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:27:29.937

您正在将 String 与 Long 进行比较。这会给你零结果。试试这个：

```
SELECT c FROM Translations c WHERE c.Id = 70 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:16:21.470

除了 Tamplar 的回答（将 long 与 String 进行比较）：您可能应该在您周围使用对象包装器`@Id`，即`Long`对象而不是`long`原始数据类型。

原因：简而言之，`long`cannot be `null`，并且检查持久对象是否已保存/分离或新建的最常见和最简单的方法是检查是否`@Id`is `null`。

# php - MySQL 中的 CHECK 约束替代方案

> ID：15519343
> 
> 赞同：0
> 
> 时间：2013-03-20T09:11:49.917
> 
> 标签：php, mysql, sql, check-constraints

嗨，我正在尝试使用`CHECK`约束形式`MySQL`，我从**w3 学校**得到了一个例子。

```
MySQL:

CREATE TABLE Persons
(
P_Id int NOT NULL,
LastName varchar(255) NOT NULL,
FirstName varchar(255),
Address varchar(255),
City varchar(255),
CHECK (P_Id>0)
) 
```

[http://www.w3schools.com/sql/sql_check.asp](http://www.w3schools.com/sql/sql_check.asp)

但它没有按预期工作，验证被忽略，搜索了一段时间后我发现`The CHECK clause is parsed but ignored by all storage engines.`

refrence :- [MySQL 中的 CHECK 约束不起作用](https://stackoverflow.com/questions/2115497/check-constraint-in-mysql-is-not-working)

然后我搜索了一个答案，然后我得到了这个

[Mysql CHECK 约束](https://stackoverflow.com/questions/14247655/mysql-check-constraint)

**它说您可以在插入更新记录时使用触发器，而不是检查约束。**

我有 2 个问题。

1.什么是`CHECK`约束的最佳选择`MySQL`？

2.什么是只解析`CHECK`约束而不使用它的目的。如果没有用，为什么会存在？

# android - Android HTTPS 获取请求挂起 response = client.execute(request);

> ID：15519348
> 
> 赞同：1
> 
> 时间：2013-03-20T09:11:57.087
> 
> 标签：android, https

我正在开发一个 android 应用程序，我必须在其中将日期形式发布到 HTTPS。

首先，我尝试连接到页面并执行获取请求，但应用程序被挂起：

`response = client.execute(request);`.

LogCat 或控制台中没有错误消息。

**这是正确的方法吗，有更好的方法吗？**.

```
HttpURLConnection http = null;
    String urlStr = "https://www.hilan.co.il/";
    URL url;
    HttpResponse response = null;
    try {        
            HttpClient client = new DefaultHttpClient();
            HttpGet request = new HttpGet();
            request.setURI(new URI(urlStr));
            response = client.execute(request);
            HttpEntity resEntity = response.getEntity();
            if (resEntity != null) {    
                WebView responseText=(WebView) findViewById(R.id.webView1);
                responseText.loadData(EntityUtils.toString(resEntity),"text/html", "UTF-8");
            }
        } catch (URISyntaxException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T07:50:26.540

原因是 url 错误应该是[https://www.hilanet.co.il](https://www.hilanet.co.il)。

# android - alertbuilder，标题未显示

> ID：15519349
> 
> 赞同：0
> 
> 时间：2013-03-20T09:11:58.470
> 
> 标签：android, android-alertdialog

我有一个带有标题和图像的警报生成器：

```
AlertDialog.Builder builder = new AlertDialog.Builder(activity);                   
builder.setTitle(R.string.pull);
builder.setIcon(R.drawable.tira_cable);
builder.setPositiveButton(R.string.accept, new DialogInterface.OnClickListener() {
   public void onClick(DialogInterface dialog, int id) {
      //actions
   }
   });
AlertDialog dialog = builder.create();
dialog.show(); 
```

我检查了问题不在标题中，在图像中，因为如果我评论 setIcon 行，它会显示标题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:23:39.697

你必须像这样使用：

```
AlertDialog.Builder builder = new AlertDialog.Builder(this);
            builder.setTitle(getResources().getString(R.string.pull));
            builder.setIcon(R.drawable.ic_action_search);
            builder.setPositiveButton("OK",
                    new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                            // actions
                        }
                    });
            AlertDialog dialog = builder.create();
            dialog.show(); 
```

你的标题 ll 正在显示...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:18:35.593

> 使用此代码段修复它！

```
new AlertDialog.Builder(getApplicationContext())
                            .setIcon(android.R.drawable.ic_dialog_info)
                            .setTitle(getResources().getString(R.string.pull))
                            .setCancelable(false)
                            .setMessage("Quistion???")
                            .setPositiveButton("Yes",
                                    new DialogInterface.OnClickListener() {
                                        public void onClick(
                                                DialogInterface dialog,
                                                int which) {

                                        }

                                    })
                            .setNegativeButton("No",
                                    new DialogInterface.OnClickListener() {
                                        public void onClick(
                                                DialogInterface dialog,
                                                int which) {

                                        }
                                    }).show(); 
```

# mybatis - Mybatis 生成器扩展私有类

> ID：15519352
> 
> 赞同：1
> 
> 时间：2013-03-20T09:12:05.153
> 
> 标签：mybatis

我使用带有eclipse插件的mybatis生成器，并希望从mybatis创建的表扩展我在java中创建的私有类（错误），怎么办？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T01:35:56.420

使用**`private`**类是不可能的，但如果是这样**`public`**，您可以尝试`rootClass`在元素的`<property>`子元素中使用该属性`<javaModelGenerator>`，例如：

```
<javaModelGenerator targetPackage="test.model"
     targetProject="\MyProject\src">
  <property name="enableSubPackages" value="true" />
  <property name="trimStrings" value="true" />
  <property name="rootClass" value="com.mycompany.MyRootClass" />
</javaModelGenerator> 
```

更多详细信息，请参阅[*MyBatis Generator 简介中*](http://mybatis.org/generator/index.html)的指南。

# android - 我怎样才能摆脱“跳过帧。应用程序可能在它的主线程上做太多工作”错误

> ID：15519355
> 
> 赞同：4
> 
> 时间：2013-03-20T09:12:16.310
> 
> 标签：android

我正在尝试运行构建我的应用程序的第一个示例，并且在从主要活动中盯着另一个活动时出现此错误。从 System.out 消息中，我可以看到该`sendMessage()`方法由`onClick`发送按钮调用，但显示消息活动从未被调用。

logcat 有这个消息 -

```
"03-20 08:56:52.278: I/Choreographer(868): Skipped 66 frames! The application may be doing too much work on its main thread." 
```

在我杀死模拟器之前，它会被打印出来。

这是内存问题吗？我正在使用 4G 内存 PC。

```
 MainActivity.java

    package com.example.firstproject;

    import android.os.Bundle;
    import android.app.Activity;
    import android.content.Intent;
    import android.view.Menu;
    import android.view.View;
    import android.widget.EditText;
    import com.example.firstproject.DisplayMessageActivity;

    public class MainActivity extends Activity {
    public final static String EXTRA_MESSAGE = "com.example.firstproject.MESSAGE";
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        // Inflate the menu; this adds items to the action bar if it is present.
        getMenuInflater().inflate(R.menu.main, menu);
        return true;
    }

    /** Called when the user clicks the Send button */
    public void sendMessage(View view) { // Do something in response to button
        System.out.println("Send message is called");
        Intent intent = new Intent(this, DisplayMessageActivity.class);
        EditText editText = (EditText) findViewById(R.id.edit_message);
        String message = editText.getText().toString();
        intent.putExtra(EXTRA_MESSAGE, message);
         System.out.println("message =" + message);
    }

}

DisplayMessageActivity.java
----------------------------

     package com.example.firstproject;

    import android.os.Bundle;
    import android.app.Activity;
    import android.view.Menu;
    import android.view.MenuItem;
    import android.widget.TextView;
    import android.support.v4.app.NavUtils;
    import android.annotation.SuppressLint;
    import android.annotation.TargetApi;
    import android.content.Intent;
    import android.os.Build;

    public class DisplayMessageActivity extends Activity {
    @SuppressLint("NewApi")
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        System.out.println("Hi Display is called");
        super.onCreate(savedInstanceState);
        // Get the message from the intent
        Intent intent = getIntent();
        String message = intent.getStringExtra(MainActivity.EXTRA_MESSAGE);
       // Create the text view 
        TextView textView = new TextView(this);
        textView.setTextSize(40);
        textView.setText(message); 
        // Set the text view as the activity layout 
        setContentView(textView);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        switch (item.getItemId()) {
        case android.R.id.home:

            NavUtils.navigateUpFromSameTask(this);
            return true;
        }
        return super.onOptionsItemSelected(item);
    }

}

AndroidManifest file

<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.firstproject"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name=".MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <activity
            android:name=".DisplayMessageActivity"
            android:label="@string/title_activity_display_message"
            android:parentActivityName=".MainActivity" >
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".MainActivity" />
        </activity>
    </application>

</manifest> 
```

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:42:28.447

似乎您忘记了实际启动`DisplayMessageActivity`; 加入。`startActivity(intent)`_ `MainActivity.sendMesssage()`也看到[这个](http://developer.android.com/training/basics/firstapp/starting-activity.html#StartActivity)。

# php - file_get_contents 编码 - 工作 Chrome 和 Safari，不工作 Firefox、Opera、IE

> ID：15519356
> 
> 赞同：1
> 
> 时间：2013-03-20T09:12:23.560
> 
> 标签：php, jquery, cross-browser, file-get-contents

从几天开始，我正在尝试实现一些代码以将一些示例内容从另一个站点加载到我的站点。我有编码问题 - 波兰语。源站点是 ISO-8859-2，目标是 UTF-8。它适用于 Chrome 和 Safari，不适用于 FF、Opera 和 IE。我究竟做错了什么？

索引.php

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Test_site</title>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.4/jquery.js"></script>
<script type="text/javascript">
    $("document").ready(function() {

        $("#content").load("curl.php #news_ajax");

    });
</script>

</head>
<body>

<h1>Test site</h1>
<div id="content"><img src="ajax-loader.gif" alt="Loading..." /></div>

</body>
</html> 
```

卷曲.php

```
<?php
    $url = 'http://www.dominikanie.pl/';
    $htm = file_get_contents($url);
    $domain = "http://www.dominikanie.pl/";
    $htm = preg_replace("/(href|src)\=\"([^(http)])(\/)?/", "$1=\"$domain$2", $htm);
    $htm = mb_convert_encoding($htm, "ISO-8859-2",
          mb_detect_encoding($htm, "UTF-8, ISO-8859-2", true));
    echo $htm;

?> 
```

我试过 iconv 但没有结果。测试[地点](http://lofol.pl/page/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:14:28.317

*   Web 浏览器与 file_get_contents 无关。

*   使用 CURL 代替 file_get_content。文档[在这里](http://php.net/manual/en/book.curl.php)

*   dominikanie.pl (source) 也是 UTF-8，而不是 ISO。这就是您的编码不起作用的原因。

*   通过 AJAX 查询数据时，您可以尝试将数据作为 XML 或 jSon 对象发送。

*   使用较新的 jQuery

*   [iconv vs mb](https://stackoverflow.com/questions/8233517/what-is-the-difference-between-iconv-and-mb-convert-encoding-in-php) - 我更喜欢 iconv。另外我的经验是编码检测并不总是能正常工作。特别是当没有太多数据要测试或者有一些奇怪的实体比如 MsWord 特殊字符（比如波兰语“”）

*   str_repleace 有时会遇到波兰字符的问题。它很少见，但我过去曾遇到过一些问题。也不要使用 htmlentities()。它真的很喜欢破坏 PL 字符 :]

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:39:00.497

> 源站点为 ISO-8859-2，目标为 UTF-8

所以应该是

```
$htm = mb_convert_encoding($htm, "UTF-8",
      mb_detect_encoding($htm, "UTF-8, ISO-8859-2", true)); 
```

# macos - 我无法在 OS X 上打包 appjs 应用程序

> ID：15519369
> 
> 赞同：1
> 
> 时间：2013-03-20T09:12:54.787
> 
> 标签：macos, node.js, npm, appjs

我不清楚，是否可以在 Mac 上使用 npm 安装 appjs？

appjs 可分发的工作正常，但我想打包应用程序。

以下：

```
node --harmony data/app.js 
```

回报：

```
/Users/richard/Downloads/app/data/node_modules/appjs/lib/bindings.js:9
  throw new Error("AppJS requires Node.js v0.8");
        ^
Error: AppJS requires Node.js v0.8
    at Object.<anonymous> (/Users/richard/Downloads/app/data/node_modules/appjs/lib/bindings.js:9:9)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:364:17)
    at require (module.js:380:17)
    at Object.<anonymous> (/Users/richard/Downloads/app/data/node_modules/appjs/lib/window.js:4:23)
    at Module._compile (module.js:456:26)
    at Object.Module._extensions..js (module.js:474:10) 
```

我以 32 位模式从源代码安装节点：

```
./configure --dest-cpu=ia32
make
sudo make install 
```

我认为上述问题是因为 appjs 可分发版本与我的本地节点版本不同步。所以我尝试使用 npm 安装 appjs，它返回以下内容：

```
npm install appjs

npm http GET https://registry.npmjs.org/appjs
npm http 200 https://registry.npmjs.org/appjs
npm http GET https://registry.npmjs.org/appjs/-/appjs-0.0.20.tgz
npm http 200 https://registry.npmjs.org/appjs/-/appjs-0.0.20.tgz
npm http GET https://registry.npmjs.org/mime
npm http 200 https://registry.npmjs.org/mime
npm http GET https://registry.npmjs.org/mime/-/mime-1.2.9.tgz
npm http 200 https://registry.npmjs.org/mime/-/mime-1.2.9.tgz

> appjs@0.0.20 postinstall /Users/richard/dev/product-builder/node_modules/appjs
> node cli/postinstall.js

Installing appjs-darwin package...
Error installing appjs-darwin
Please use `npm install appjs-darwin and install the package manually
appjs@0.0.20 node_modules/appjs
└── mime@1.2.9

npm install appjs-darwin

npm http GET https://registry.npmjs.org/appjs-darwin
npm http 304 https://registry.npmjs.org/appjs-darwin
npm http GET https://registry.npmjs.org/appjs-darwin/-/appjs-darwin-0.0.19.tgz
npm http 200 https://registry.npmjs.org/appjs-darwin/-/appjs-darwin-0.0.19.tgz
npm ERR! cb() never called!
npm ERR! not ok code 0 
```

目前不支持 OS X 还是我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-25T13:25:23.367

npm install OS X install 当前被标记为损坏（[https://github.com/appjs/appjs](https://github.com/appjs/appjs)）

![在此处输入图像描述](../Images/8af5022cea73173eef177a2feeacdeed.png)

App.js 版本检查中似乎也存在错误 [https://github.com/appjs/appjs/issues/328](https://github.com/appjs/appjs/issues/328)

请同时查看 AppJs 的以下注释

“AppJS 在 OS X 上需要 32 位节点。它可以在 64 位 OS X 上运行，但节点必须是 32 位的。我们正在努力解决这个问题，但这是 Chrome 本身的限制，所以它正在进行中。”

# android - 三星启用禁用“驾驶模式”

> ID：15519370
> 
> 赞同：2
> 
> 时间：2013-03-20T09:12:56.813
> 
> 标签：android, mode, samsung-mobile, settings.settings

我想启用/禁用某些三星设备（Galaxy S2、S3）上可用的**驾驶模式。**我知道我必须在系统设置中添加一些东西，但我不知道是什么。所以请告诉我我应该使用什么值或者我在哪里可以找到这些信息。

`Settings.System.putInt(context.getContentResolver(), "something1", "something2");`

先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-01T18:50:15.180

当然！这段代码对我有用：

```
Settings.System.putInt(getContentResolver(), "driving_mode_on", 1); // To Enable
Settings.System.putInt(getContentResolver(), "driving_mode_on", 0); // To Disable
Settings.System.putInt(getContentResolver(), "driving_mode_on", isEnabled ? 0 : 1); // To Toggle 
```

使用此应用程序了解您设备上的设置名称： [显示系统设置](https://play.google.com/store/apps/details?id=de.SmartDyne.Free.DisplaySystemSettings)

# opencv - OpenCV putText UTF-8 字符

> ID：15519373
> 
> 赞同：7
> 
> 时间：2013-03-20T09:12:59.693
> 
> 标签：opencv, utf-8, ascii

有没有人可以替代`OpenCV`putText（支持 UTF-8 字符）？如前所述，`putText`仅适用于 ASCII 字符，但不适`UTF-8`用于`šŠčČžŽ`?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-03T02:31:16.233

如果 OpenCV 是**使用 Qt 支持**构建的，您可以使用它[`cv::addText()`](http://docs.opencv.org/modules/highgui/doc/qt_new_functions.html?#addtext)来编写该字符串：

```
cv::Mat img = cv::imread("C:\\snowflake.jpg");
if (img.empty())
{
    std::cout << "!!! Failed imread()" << std::endl;
    return;
}

cv::addText(img, "áéőúöüóí", cv::Point(100, 50), cv::fontQt("Times")); 
```

但是，如果 OpenCV 是在**没有 Qt 支持**的情况下构建的，调用`cv::addText()`将使您的应用程序崩溃，并且控制台将打印以下错误：

```
OpenCV Error: The function/feature is not implemented (The library is compiled without QT support) in cv::fontQt, file C:\builds\2_4_PackSlave-win32-vc12-shared\opencv\modules\highgui\src\window.cpp, line 409 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T10:05:30.467

您没有指定您使用的是什么语言。在 Python 中，我会使用 PIL 的文本绘图功能：

```
draw.text((0, 0), unicode("áéőúöüóí","utf-8"), font=font, fill=(255,255,255)) 
```

# algorithm - Actionscript - 扩大圈子 - 性能问题

> ID：15519380
> 
> 赞同：0
> 
> 时间：2013-03-20T09:13:20.360
> 
> 标签：algorithm, actionscript-3, drawing, graphics2d

我试图创建一个不断扩大的圈子有几个原因。对于测试平台，我正在使用 actionscript 为其开发起点。

这是我到目前为止的代码：

编辑

*更新代码 13.39 GMT+1 - 再次更新代码*

*更新代码 14.54 GMT+1 - 更新代码，现在运行非常流畅，感谢 Vesper 的帮助*

主文件

```
package  
{
import flash.display.MovieClip;
import flash.events.Event;
import Wavelet;
import flash.geom.Point;
import flash.events.TimerEvent;
import flash.utils.Timer;
import flash.display.Bitmap;
import flash.display.BitmapData;
import flash.utils.getTimer;

public class Main extends MovieClip
{

    var startColor:Number = 0x00AA00;
    var particleBitmapdata:BitmapData;
    var m_temptimer:int;

    private var myVector:Vector.<Wavelet> = new Vector.<Wavelet>();
    public function Main() 
    {
        // constructor code         
        addEventListener(Event.ADDED_TO_STAGE, init);
        addEventListener(Event.ENTER_FRAME, update);
    }

    public function init(evt:Event)
    {
        particleBitmapdata = new BitmapData(3,3,false, startColor);

        var myTimer:Timer = new Timer(100, 0);
        myTimer.addEventListener(TimerEvent.TIMER, run);
        myTimer.start();
    }

    public function run(tevt:TimerEvent)
    {
        for(var i:int=0; i < 360; i+=1)
        {
            myVector.push(new Wavelet(3, 1, i, startColor,particleBitmapdata));
            myVector[myVector.length-1].x = stage.stageWidth/2;
            myVector[myVector.length-1].y = stage.stageHeight/2;
            addChild(myVector[myVector.length-1]);
        }

    }

    public function update(evt:Event)
    {
        var time:int = getTimer();
        var dt:Number = (time - m_temptimer) * 0.001;
        m_temptimer = time;

        for(var i:int=0; i < myVector.length-1; i++)
        {
            var w:Wavelet = myVector[i];

            if(w.x > stage.stageWidth || w.x < 0  )
            {
                removeChild(myVector[i]);
                myVector[i] = null;
                myVector.splice(i,1);
            }
            if(w.y > stage.stageHeight || w.y < 0 )
            {
                removeChild(myVector[i]);
                myVector[i] = null;
                myVector.splice(i,1);
            }

        }

        for(var j:int=0; j < myVector.length; j++)
        {
            myVector[j].update(dt);
        }
    }
}

} 
```

小波.as

```
package 
{
import flash.display.*;
import flash.events.*;
import flash.geom.Point;
import flash.filters.*;
import flash.geom.*;

public class Wavelet extends Bitmap
{
    private var m_velocity:Number;
    private var m_angle:Number;
    private var m_radius:Number;
    private var m_bmd:BitmapData;
    private var m_color=0x0000FF;
    private var m_angleX,m_angleY;

    public function getAngle():Number
    {
        return m_angle;
    }

    public function getVelocity():Number
    {
        return m_velocity;
    }

    public function setVelocity(input:Number)
    {
        m_velocity = input;
    }

    public function Wavelet(radius:int, velocity:Number, angle:Number, color:Number, bitmapData:BitmapData)
    {
        // constructor code
        m_radius = radius;
        m_angle = angle * Math.PI / 180 ;
        m_velocity = velocity;
        m_angleX = Math.cos(angle);
        m_angleY = Math.sin(angle);
        m_color = color;
        m_bmd = bitmapData;
        this.bitmapData = m_bmd;
    }

    public function update(dt:Number)
    {
        this.x+= m_angleX * m_velocity;
        this.y+= m_angleY * m_velocity;
        m_velocity+=dt;
    }
}

} 
```

无论如何，我从中得到的表现非常缓慢。我不想作为一个整体创建一个扩大的圆圈，我需要像素来计算它们何时与墙壁和物体碰撞，以使它们改变方向。

无论如何，您可以制作一个性能更好的扩展圈吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:54:57.113

由于更新了代码而进行了编辑。

首先，您可以将所有小波移动例程放入`Wavelet`类中，以及将预缓存 `Math.sin(angle)`和`Math.cos(angle)`放入类中`vx`的`vy`变量。这将为您节省 720`Math.sin()`和`Math.cos()`每圈运行的电话。

其次，您正在前向循环上拼接一个粒子 - 在这种情况下，当向量中的下一个粒子将被拼接时，它不会移动。这是一个常见的错误，但大多数情况下，如果 i'th 元素被查询过去，结果会更糟`splice()`，从而得到空异常。

第三，您`myVector[i]`在循环中请求了十几次 - 此请求未缓存在代码中，因此您这样做：`var w:Wavelet=myVector[i];`并通过指针寻址所有内容`w`，它会稍微提高性能，因为 Flash 不需要经常检查对于越界问题或检索列表元素。

# c - 检测 Visual C++ 中存在哪个版本的 vswprintf()

> ID：15519381
> 
> 赞同：1
> 
> 时间：2013-03-20T09:13:21.537
> 
> 标签：c, visual-c++, tchar, printf

我有一个项目，它使用`_vscwprintf()`/ `vswprintf()`（通过`_vsctprintf()`/ `_vstprintf()`）在`malloc()`ed 缓冲区中创建任意长度的格式化字符串。

当我在 Visual C++ 2008 下启动项目时，`_vstprintf()`取了三个参数：

```
int vswprintf(wchar_t * _String, const wchar_t * _Format, va_list _Ap) 
```

但是在离开我的项目一段时间后，当我使用 Visual C++ 2012 回到它时，我发现 MS 已将函数更改为采用四个参数：

```
int vswprintf(wchar_t * _String, size_t _Count, const wchar_t * _Format, va_list _Ap) 
```

我希望我的代码可以在 Visual C++ 2008、2010 和 2012 下构建（它也可以移植到 Linux 和 Solaris）。

是否有一些符号可以检查，`#ifdef`以便我可以使用函数的 3 参数或 4 参数版本正确构建？

我假设有一个符号告诉我我正在编译哪个版本的 Visual C++，但这是正确的方法吗？例如，较新的编译器是否有可能使用较旧的 C 库或运行时构建，反之亦然？

我的代码实际上是使用 C 而不是 C++，如果这有所不同的话。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-11-22T21:10:35.603

正如@Roger Rowland 所说，由于 Visual Studio 2008 [http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/b385ed64-d549-4cf3-af31-85a2e8da4b6a/](http://social.msdn.microsoft.com/Forums/en-US/vcgeneral/thread/b385ed64-d549-4cf3-af31-85a2e8da4b6a/)中的一个错误， 您应该通过 3 Visual Studio 2008 中的参数和较新版本中的 4 个参数

```
#ifdef _MSC_VER <= 1500 //Visual Studio 2008 or ealier
// use 3 parameters version here
#else //later than Visual Studio 2008
// use 4 parameters version herse
#endif 
```

# vba - 如何简化vba复制粘贴单独的单元格值

> ID：15519389
> 
> 赞同：1
> 
> 时间：2013-03-20T09:13:52.327
> 
> 标签：vba

我知道有一种方法可以使这段代码简短而快速，但似乎我太菜鸟了，无法实现它。我有一些合并的单元格（这是一种应该是“标准”的表格，但用户一直在弄乱它，我使用的宏会给出大量错误并且不会收集信息）。到目前为止，我所做的是制作另一段代码，再次打开“标准”表单并填写用户表单中的所有数据。

它就像一个魅力，但现在我厌倦了四处寻找和询问，因为我不知道如何简化它（我知道这对你来说一定很傻，但我不能接受它不能完成的事实 - 也我不能接受“功能强大”的 VBA 必须花费很长时间才能为这么少的东西编写这么多的代码）。

```
Application.ScreenUpdating = False
ActiveWindow.ActivatePrevious
Workbooks.Open Filename:="...\Standard Formular.xls"
Sheets("Formulaire - Form").Select
ActiveWindow.ActivateNext
Range("E9").Copy
ActiveWindow.ActivatePrevious
Range("E9").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E11").Copy
ActiveWindow.ActivatePrevious
Range("E11").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E13").Copy
ActiveWindow.ActivatePrevious
Range("E13").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E15").Copy
ActiveWindow.ActivatePrevious
Range("E15").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E17").Copy
ActiveWindow.ActivatePrevious
Range("E17").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E19").Copy
ActiveWindow.ActivatePrevious
Range("E19").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Range("E21").Select
ActiveCell.FormulaR1C1 = Date
ActiveWindow.ActivateNext
Range("E28").Copy
ActiveWindow.ActivatePrevious
Range("E28").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E30").Copy
ActiveWindow.ActivatePrevious
Range("E30").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E32").Copy
ActiveWindow.ActivatePrevious
Range("E32").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E34").Copy
ActiveWindow.ActivatePrevious
Range("E34").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E36").Copy
ActiveWindow.ActivatePrevious
Range("E36").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E38").Copy
ActiveWindow.ActivatePrevious
Range("E38").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E48").Copy
ActiveWindow.ActivatePrevious
Range("E48").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E50").Copy
ActiveWindow.ActivatePrevious
Range("E50").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E52").Copy
ActiveWindow.ActivatePrevious
Range("E52").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E54").Copy
ActiveWindow.ActivatePrevious
Range("E54").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E63").Copy
ActiveWindow.ActivatePrevious
Range("E63").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("G63").Copy
ActiveWindow.ActivatePrevious
Range("G63").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("C65").Copy
ActiveWindow.ActivatePrevious
Range("C65").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("D65").Copy
ActiveWindow.ActivatePrevious
Range("D65").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E65").Copy
ActiveWindow.ActivatePrevious
Range("E65").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("F65").Copy
ActiveWindow.ActivatePrevious
Range("F65").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("G65").Copy
ActiveWindow.ActivatePrevious
Range("G65").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E67").Copy
ActiveWindow.ActivatePrevious
Range("E67").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("A72").Copy
ActiveWindow.ActivatePrevious
Range("A72").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("G72").Copy
ActiveWindow.ActivatePrevious
Range("G72").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
Range("E97").Copy
ActiveWindow.ActivatePrevious
Range("E97").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveWindow.ActivateNext
ActiveWindow.Close
Application.ScreenUpdating = True 
```

提前感谢您抽出时间来帮助我！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:19:01.850

做一个

```
`sheet("Where i want to paste").range("xxx").value=sheet("Data im copiing").range("yyy").value` 
```

例如，您的第一个副本是：

Sheets("不知道名字").range("E9").value=Sheets("Formulaire - Form").Range("E9").value

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:19:16.140

将要复制到和从中复制的工作表存储在变量中：

```
wsU = Sheets("Sheet name on user form goes here")
Workbooks.Open Filename:="...\Standard Formular.xls"
wsF = Sheets("Formulaire - Form") 
```

现在不要在激活的工作表之间进行翻转，而不是使用复制和粘贴，因为这涉及剪贴板，并且当您在此宏运行时开始尝试在另一个应用程序中复制和粘贴时可能会搞砸试试这个：

```
wsF.Range("E9").value = wsU.Range("E9").value 
```

ETC

顺便说一句，这是一个很好的速记

```
wsF.[E9] = wsU.[E9] 
```

# android - 如何从对话框中获取数据

> ID：15519399
> 
> 赞同：2
> 
> 时间：2013-03-20T09:14:13.487
> 
> 标签：android

我有这样的对话框类

```
class Dialog_Open_DataPicker exten dialog {
Dialog_Open_DataPicker(Context c){}
@Override
    protected void onCreate(Bundle savedInstanceState) {
        // TODO Auto-generated method stub
        super.onCreate(savedInstanceState);
    setContentView(R.layout.dialog_date_picker);
    }
} 
```

我这样称呼那个对话框：

```
Dialog_Open_DataPicker d = new Dialog_Open_DataPicker(Offer.this);
            d.show(); 
```

我想从我的对话中获取我的活动的日期，请问如何？提前致谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:42:59.463

创建并显示用于显示日期的对话框。它在 Activity 类的给定文本框中设置值。

```
public static void showDate(Context context,final TextView view)
{
   final Dialog dialog = new Dialog(context);
   dialog.requestWindowFeature(Window.FEATURE_NO_TITLE);
   dialog.setContentView(R.layout.date_dialog);
   dialog.setCancelable(true);
   dialog.show();

   dialog.findViewById(R.id.set_time).setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub
            DatePicker datePicker=(DatePicker)dialog.findViewById(R.id.datePicker);
            int year = datePicker.getYear();
            int month = datePicker.getMonth()+1;
            int day = datePicker.getDayOfMonth();

            StaticDateVariables.DATE_FROM_DATE_DIALOG=new StringBuilder()
            .append(month).append("-").append(day).append("-")
            .append(year).toString();

            view.setText(StaticDateVariables.DATE_FROM_DATE_DIALOG);

            dialog.dismiss();
        }
    });
} 
```

# qt - 在哪里确定按下了什么键

> ID：15519401
> 
> 赞同：0
> 
> 时间：2013-03-20T09:14:20.047
> 
> 标签：qt, optimization, event-handling, signals, keyevent

例如，我有两种需要以不同方式处理的键。所以，我应该确定按下的键是什么类型。我可以在信号级别分离键，即确定按下了什么键并发出适当的信号：

```
void QueryTextEdit::keyPressEvent(QKeyEvent *event)
{
    switch (event->key()) {
        case Qt::Key_Slash :
        {
            emit slashWasPressed();
            break;
        }
        default :
        {
            emit otherKeyWasPressed(event);
            break;
        }
    }
} 
```

或者我可以在单个插槽中捕获所有信号并在此处处理键类型：

```
keyHandler(QKeyEvent *event) {
    if (event->key() == Qt::Key_Slash) {
        // do something
        return;
    } else { 
        // do something
    }
} 
```

哪种方式更可取？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:49:42.747

看看[http://qt-project.org/doc/qt-4.8/qkeyevent.html#key](http://qt-project.org/doc/qt-4.8/qkeyevent.html#key) 这提供了被按下的键的 int 代码:)

或者您可以查看 QKeyEvent::text() ，它返回键事件的 unicode

编辑：@你的评论

如果您想处理斜杠键并丢弃所有其他键，我会采用方法＃2。

# android - 如果列表有数据，如何启用/禁用按钮

> ID：15519404
> 
> 赞同：1
> 
> 时间：2013-03-20T09:14:28.800
> 
> 标签：android

我正在制作一个生日提醒应用程序，其中我**允许用户为他们的朋友添加生日这些数字存储**在电话簿中

现在我正在尝试做一些小的改变，就像*在这里我想要如果用户已经为电话簿朋友添加了生日那么不需要显示 AddBirthday 按钮，如果用户没有为电话簿朋友添加生日那么需要显示 AddBirthday 按钮*。

就像在我的电话簿中，他的人名 Akshat 我已经添加了生日，但在这里我也得到了 AddBirthday 按钮，但现在我想禁用这个 AddBirthday 按钮

**AccountDatesOfBirthAdapter.java：**

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    if (position == 0) {
        if (convertView == null) {
            convertView = this.inflater.inflate(R.layout.editor_account, null);
        }

        ImageView accountIcon = (ImageView) convertView.findViewById(R.id.editor_icon);
        accountIcon.setImageDrawable(this.accountIcon);

        TextView accountType = (TextView) convertView.findViewById(R.id.editor_type);
        accountType.setText(this.accountType);

        TextView accountName = (TextView) convertView.findViewById(R.id.editor_name);
        accountName.setText(this.accountName);

        // To Do:: Enable and Disable button (Birthday Added or not)
        addDateOfBirth = (ImageButton) convertView.findViewById(R.id.editor_new);
        addDateOfBirth.setOnClickListener(this);

        }
        else 
        {               
        DateOfBirth dateOfBirth = this.datesOfBirth.get(position - 1);

        if (convertView == null) {
            convertView = this.inflater.inflate(R.layout.editor_dateofbirth, null);
        }

        TextView date = (TextView) convertView.findViewById(R.id.editor_date);
        date.setText(dateFormatter.format(dateOfBirth.getDate().getTime()));
    }
    return convertView;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:20:06.297

检查数据库中该人的出生日期，如果有的话

`setClickable(false)`

和

`setEnabled(false)`

学分：[https ://stackoverflow.com/a/6750525/2071742](https://stackoverflow.com/a/6750525/2071742)

编辑：我认为您希望该按钮消失，在这种情况下您应该使用`addDateOfBirth.setVisibility(View.GONE);`删除它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:21:32.067

在您的 AccountDatesOfBirthAdapter.java 中，您可以将条件设​​置为

```
if(dateOfBirth != null){
   addDateOfBirth.setVisibility(View.GONE);
}else{
   addDateOfBirth.setVisibility(View.VISIBLE);
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:40:51.407

是的，我同意@Kameswari，你只需要在你的 AccountsDateOfBirthAdapter.java 中做一点小改动：

```
 if(dateOfBirth != null){
       addDateOfBirth.setVisibility(View.GONE);
        } 
```

您的代码应如下所示：

```
 TextView accountName = (TextView) convertView.findViewById(R.id.editor_name);
        accountName.setText(this.accountName);

        // To Do:: Enable and Disable button (Birthday Added or not)
        addDateOfBirth = (ImageButton) convertView.findViewById(R.id.editor_new);
        addDateOfBirth.setOnClickListener(this);

        }
        else 
        {               
        DateOfBirth dateOfBirth = this.datesOfBirth.get(position - 1);

        if (convertView == null) {
            convertView = this.inflater.inflate(R.layout.editor_dateofbirth, null);
        }

        TextView date = (TextView) convertView.findViewById(R.id.editor_date);
        date.setText(dateFormatter.format(dateOfBirth.getDate().getTime()));

        if(dateOfBirth != null){
               addDateOfBirth.setVisibility(View.GONE);
        }

    }
    return convertView;
} 
```

# javascript - 如何在 jQuery 触发器（“点击”）上运行回调函数？

> ID：15519410
> 
> 赞同：32
> 
> 时间：2013-03-20T09:14:49.637
> 
> 标签：javascript, jquery, events, triggers, callback

我需要在调用的回调中触发一个自定义事件`trigger`，但我无法让它工作。

我试过这个：

```
var $input = $( ".ui-popup-container" ).find( "input" ).eq(2);

function runtests () {
    console.log("clicked the input");
};
$input.trigger('click', runtests()); 
```

还有这个：

```
var $input = $( ".ui-popup-container" ).find( "input" ).eq(2);
$input.trigger('click', function(){
    console.log("clicked the input");
} 
```

两者都不起作用。

**问题：**
当我触发对元素的点击时，如何让回调函数运行？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-20T09:21:03.643

当您调用`trigger`时，绑定的事件处理程序会立即执行，因此您不需要任何回调。只需使用

```
$input.trigger('click');
runtests(); 
```

* * *

## 回答 #2

> 赞同：25
> 
> 时间：2015-12-18T03:27:44.767

是的 - 触发器确实不接受回调，但我们可以将回调作为参数传递。

```
//.trigger( eventType [, extraParameters ] )

$("#element").bind("customCall", function(e, callback){
   callback();
}
var callback = function(){alert("Hello");}
$("#element").trigger("customCall",[callback]); 
```

希望这会有所帮助

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2013-03-20T09:20:28.880

首先需要绑定点击事件，然后才能触发点击事件。

```
$input.bind('click', function() {

     console.log("clicked the input");
});

$input.trigger('click'); 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-03-20T09:18:48.170

触发器没有回调函数。

```
.trigger( eventType [, extraParameters ] ) 
```

**[`Official Document`](http://api.jquery.com/trigger/)**

**你可以做什么**

```
var $input = $( ".ui-popup-container" ).find( "input" ).eq(2);

$input.on('click',function(){
   console.log("clicked the input");
}); 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-03-20T09:20:44.807

您需要使用`bind`或`on`添加回调。在您的情况下，它应该如下所示：

```
var $input = $( ".ui-popup-container" ).find( "input" ).eq(2);

function runtests () {
    console.log("clicked the input");
};

$input.bind('click', runtests); 
```

绑定点击的更短版本是`$input.click(runtests)`

然后它将在单击时调用，或者您可以使用`$input.trigger('click')`或简单地手动触发它`$input.click()`。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T09:20:26.890

触发器没有回调函数 - 您可以更好地重写代码以使用[.on](http://api.jquery.com/on/)方法。

```
$("body").on("click", "#click", function() {
   alert("Clicked!"); 
}); 
```

[JSF](http://jsfiddle.net/hTGZj/)中。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T09:44:56.040

如果您对每个输入都有一个单击处理程序，但想对特定元素执行某些操作：

```
var $container = $(".ui-popup-container"),
    special = 2;

$container.on('click', 'input', function() {
    // do something for every input

    if($(this).index() == special) {
        // your "callback", e.g. the function you want to execute on input:eq2 click
        myfunction();
    }
}).find('input').eq(special).trigger('click'); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2020-04-02T18:58:34.263

`.trigger()`不接受任何回调。大多数情况下您不需要它，因为绑定的事件处理程序会立即执行。但是，如果您在触发事件处理程序中有 AJAX 调用，则接受答案的代码将不起作用：

```
$input.trigger('click');
runtests(); 
```

您将不得不`setTimeout()`像这样使用：

```
$input.trigger('click');
setTimeout(function () {
    runtests();
}, 250); 
```

或者考虑在事件处理程序中使用`success`或`error`回调`.ajax()`调用。`.trigger()`

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2021-09-19T18:20:17.043

Denys Séguret 的逻辑是正确的。但是当触发函数之后需要回调函数时， $.when 是可用的：

```
$.when($input.trigger("click"))
 .done(function () { runtests(); }); 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-10-28T20:55:23.713

请试试这个：

```
$('#inputTxt1').change(function(e, callback1, data) {

    /*  other statement ...   */  

   if(typeof(callback1)==='function'){
       callback1(data);
   } 
});

$('#button2').click(function(e){
    $('#button1').trigger('change', [secondCallback, 'data to callback']);
});

function secondCallback(data){
    var result = data;
} 
```

# ruby - 如何将厨师处理程序中的日志复制到工作站？

> ID：15519413
> 
> 赞同：4
> 
> 时间：2013-03-20T09:14:56.393
> 
> 标签：ruby, chef-infra, chef-recipe

我尝试将日志从节点复制到工作站。

我是厨师和红宝石的新手。

在食谱中：

```
directory "/var/chef/handlers" do
recursive true
action :nothing
end.run_action(:create)

cookbook_file "/var/chef/handlers/chef_handler_hibu.rb" do
action :nothing
end.run_action(:create)

chef_handler "Chef::Handler::Copy" do
source "/var/chef/handlers/chef_handler_hibu" 
end.run_action(:enable) 
```

在文件中

```
class Copy < Chef::Handler
def initialize

end
def report
execute "report" do
command "sshpass -p ******* scp -o StrictHostKeyChecking=no /var/log 
/#{node["ipaddress"]}.log gestchef@192.168.107.214:/var/log/chef_clients_logs
/#{node["ipaddress"]}.log"
end
end
end 
```

但是在厨师处理程序中未定义执行方法。

如何在 Chef Handler 中执行 linux 命令？

或者如何用红宝石做到这一点？

我试试这个

```
require 'rubygems'
require 'net/ssh'
require 'net/scp'

class Copy < Chef::Handler
def initialize

end
Net::SSH.start("192.168.107.214", "*****",:password => "******") do |session|
session.scp.download! "/var/log/#{node["ipaddress"]}.log", "/var/log
/chef_clients_logs   /#{node["ipaddress"]}.log"
end

end 
```

但是错误

```
cannot load such file -- net/scp

gem list --local

net-scp (1.0.2)
net-sftp (2.0.2)
net-ssh (2.0.11)
s3sync (1.2.5)
xml-simple (1.0.12) 
```

和

```
gem which net-scp
Can't find ruby library file or shared library net-scp 
```

发生了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-22T10:19:33.453

经过多次搜索和多次测试，这对我有用。

在食谱中：

```
 directory "/var/chef/handlers" do
      recursive true
      action :nothing
    end.run_action(:create)

    cookbook_file "/var/chef/handlers/chef_handler_hibu.rb" do
      action :nothing
    end.run_action(:create)

    chef_handler "Chef::Handler::Copy" do
      source "/var/chef/handlers/chef_handler_hibu" 
    end.run_action(:enable) 
```

在`files/default/chef_handler_hibu.rb`：

```
 class Copy < Chef::Handler

      def report

        mpadd = Chef::Resource::Execute.new(mpadd,run_context)
        mpadd.command("sshpass -p ***** scp -o StrictHostKeyChecking=no /var/log
    /#{node["ipaddress"]}.log gestchef@192.168.107.214:/var/log/chef_clients_logs
    /#{node["ipaddress"]}.log")
        mpadd.run_action(:run)
      end
    end 
```

有了这个，您可以将节点的日志复制到`chef_handler`阶段中的任何地方。

我希望它对你有帮助。

# javascript - javascript具有相同的方法和不同的实现

> ID：15519422
> 
> 赞同：1
> 
> 时间：2013-03-20T09:15:33.233
> 
> 标签：javascript, jquery

我有以下功能的 js 文件（rework.js）

```
/**
 * Java script functions to set comments for selected rework reason.
 */
function setReworkCheckFields() {
    var note = $("#rework_note").val();
    var reworknoteImage = document.getElementsByName("reworknote_image");
    var reworknoteScript = document.getElementsByName("reworknote_script");
    var reworknoteVoice = document.getElementsByName("reworknote_voice");
    var reworknoteMusic = document.getElementsByName("reworknote_music");
    if ($(reworknoteImage).is(':checked')) {
        $("#reworknote_image_note").val(note);
    }
    if ($(reworknoteScript).is(':checked')) {
        $("#reworknote_script_note").val(note);
    }
    if ($(reworknoteVoice).is(':checked')) {
        $("#reworknote_voice_note").val(note);
    }
    if ($(reworknoteMusic).is(':checked')) {
        $("#reworknote_music_note").val(note);
    }
} 
```

我已经在 html 中导入了这个 js 文件，并且我在 html 中添加了具有不同实现的相同方法，如下所示

```
<script type='text/javascript' src='style/js/rework.js'></script>

<script type='text/javascript'>
function setReworkCheckFields() {
    var note = $("#rework_note").val();
    var reworknoteImage = document.getElementsByName("reworknote_image");
    var reworknoteScript = document.getElementsByName("reworknote_script");
    var reworknoteVoice = document.getElementsByName("reworknote_voice");
    var reworknoteMusic = document.getElementsByName("reworknote_music");
    if ($(reworknoteImage).is(':checked')) {
        $("#reworknote_image_note").val(note);
    } else {
        $("#reworknote_image_note").val(null);
    }
    if ($(reworknoteScript).is(':checked')) {
        $("#reworknote_script_note").val(note);
    } else {
        $("#reworknote_script_note").val(null);
    }
    if ($(reworknoteVoice).is(':checked')) {
        $("#reworknote_voice_note").val(note);
    } else {
        $("#reworknote_voice_note").val(null);
    }
    if ($(reworknoteMusic).is(':checked')) {
        $("#reworknote_music_note").val(note);
    } else {
        $("#reworknote_music_note").val(null);
    }
}
</script> 
```

并调用下面的javascript函数。

```
<table>
     <tr>
         <td>Image: <input type="checkbox" name="reworknote_image" ${reworknote_image.workingchecked} onchange="setReworkCheckFields()"/></td>
         <td>Script: <input type="checkbox" name="reworknote_script" ${reworknote_script.workingchecked} onchange="setReworkCheckFields()"/></td>
         <td>Voice: <input type="checkbox" name="reworknote_voice" ${reworknote_voice.workingchecked} onchange="setReworkCheckFields()"/></td>
         <td>Music: <input type="checkbox" name="reworknote_music" ${reworknote_music.workingchecked} onchange="setReworkCheckFields()"/></td>
     </tr>
</table> 
```

有人可以知道流程将如何运作。这有效吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:22:42.200

第二个函数将重新声明第一个函数，因此当您调用时，`setReworkCheckFields()`您将运行第二个函数。

是的，它是有效的。就像您覆盖变量一样。

请记住，如果您在代码中再次声明此函数，它也会重新声明此定义。在某些情况下这是有用的行为，但你必须小心重新声明 js 函数。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:22:56.033

否 - 流程是在 js 范围内仅定义最后一个函数，因为它会覆盖任何具有相似名称的 js 代码。

在 javascript 中没有像 Java 或其他语言那样的函数重载。不过，您可以将代码包装到不同的命名空间：

```
var MyFirstNameSpace = {
    setReworkCheckFields: function(){
         // code goes here...
    } 
};

var MySecondNameSpace = {
    setReworkCheckFields: function(){
         // code goes here...
    } 
}; 
```

那么您可以调用 MyFirstNameSpace.setReworkCheckFields() 或 MySecondNameSpace.setReworkCheckFields();

一般来说，覆盖 javascript 全局范围不是一个好习惯，因为您不知道您的项目将包含哪些其他 js 代码，这会与您自己的代码混淆。

# c# - 使用 XmlRootAttribute 类时是否需要刷新？

> ID：15519431
> 
> 赞同：0
> 
> 时间：2013-03-20T09:15:58.017
> 
> 标签：c#, serialization, xml-serialization, flush, xmlroot

我知道在使用流时我需要刷新它，以便它会释放与流相关的任何资源，并且刷新流需要任何尚未写入的缓冲数据，并立即将其写出。

我有以下课程：

```
[XmlRoot("EventList")]
public class EventList
{
    private List<BaseEvent> events_ = new List<BaseEvent>();
    /// Default constructor. Required for serialization
    public EventList() {}

    [XmlElement(ElementName = "Event")]
    public List<BaseEvent> Events
    {
        get 
        {
            return events_;
        }
        set 
        {
            events_ = value;
        }
    }
} 
```

现在在我将它作为对 HTTPRequest 的响应发送之前，我需要刷新它吗？如果是这样，我该怎么办？

我之所以问，是因为我遇到了此处描述的问题： [AJAX 响应 - XmlHttp.responseXML 被切断](https://stackoverflow.com/questions/15134804/ajax-response-xmlhttp-responsexml-is-cut-off)

js客户端激活的方法是：

```
[WebMethod]
public EventsRequestResult GetEvents(string agentId, int delayedReturnMS)

// EventsRequestResult - return value of the GetEvents method of the EventsService.
public class EventsRequestResult
{
    private EventList events_ = null;
    /// <summary>
    /// List of the events
    /// </summary>
    [XmlElement(ElementName = "Events")]
    public EventList Events
    {
        get
        {
            return events_;
        }
        set
        {
            events_ = value;
        }
    }
    /// Default constructor.
    public EventsRequestResult(){}
    /// <summary>
    /// Constructor used in case of the failure.
    /// </summary>
    /// <param name="errorCode">Numeric error code</param>
    /// <param name="errorDescription">Human readable error description</param>
    public EventsRequestResult(RequestErrorCode errorCode, string errorDescription) : base(errorCode, errorDescription){}
    /// <summary>
    /// Constructor used in case of successful events request.
    /// </summary>
    /// <param name="events">List of the events</param>
    public EventsRequestResult(EventList events) : base()
    {
        events_ = events;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:30:37.313

马克在上面的评论中是对的，但我认为你正在寻找的是类似的东西

```
 using(var stream = theResponse.OutputStream)
    {
        var ser = new XmlSerializer(typeof(EventList));
        return ser.Deserialize(stream) as EventList;
    } 
```

`return`从 using 块中将关闭（并刷新）流。

# jquery - Jquery使用索引替换li？

> ID：15519439
> 
> 赞同：0
> 
> 时间：2013-03-20T09:16:33.827
> 
> 标签：jquery

例如，我需要替换一个 li（注意：ID 可能并不总是按顺序排列）

```
<ul>
<li id="first"></li>
<li id="second"></li>
<li id="third"></li>
<li id="fourth"></li>
<li id="fifth"></li>
</ul> 
```

所以说我想用一个新的替换 id "third" `<li>`，我知道我可以得到索引

```
$("li").index("#third"); 
```

然后我可以删除它

```
$("#third").remove(); 
```

如何用新的替换它`<li>`？

我知道最简单的解决方案是简单地替换*里面*的数据，`<li>`但不幸的是这不是一个选项

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:18:49.963

```
$('#third').replaceWith('<li>Foo</li>'); 
```

例如。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T09:19:01.107

您是否考虑过使用该[`replaceWith()`](http://api.jquery.com/replaceWith/)方法？

```
$('#third').replaceWith('<li>Hello world</li>'); 
```

或者，您提到使用索引；如果您想删除第三个列表项，您可以使用[`eq()`](http://api.jquery.com/eq/)选择正确的一项，然后替换为，如下所示：

```
$('li').eq(2).replaceWith('<li>Hello world</li>'); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:19:12.943

您真正需要的是[.replaceWith()](http://api.jquery.com/replaceWith/)函数。

不知道你认为你需要什么`index()`。

# javascript - 无法在 Appcellerator Titanium 项目中使用 sjcl

> ID：15519440
> 
> 赞同：1
> 
> 时间：2013-03-20T09:16:34.490
> 
> 标签：javascript, encryption, titanium-mobile, sjcl

我正在尝试在我的 Titanium（目标：iOS 和 Android）项目中使用 sjcl（Stanford Javascript Crypto Library）加密一些文本。我正在使用最简单的方法，没有其他选择：

```
sjcl.encrypt("mypassword", "mytext"); 
```

该应用程序只是挂在这条线上，我没有收到任何错误或任何有用的信息。我错过了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:24:07.353

代码可能运行良好。然而，第一个算法尝试使用 PBKDF2 函数从密码创建密钥。由于密码通常不包含足够的熵以安全地用于加密，因此此功能故意降低密码强度。如果（调试）框架需要大量时间来执行底层哈希函数，那么您的应用程序可能会出现挂起（检查您的 CPU 使用率）。

解决方案是降低 PBKDF2 作为输入的迭代次数，或者使用 Java PBKDF2。两者都可能需要对 SJCL 的较低级别访问。最后，在 Java 平台上选择用于加密的 JavaScript 库会极大地降低性能。为此，您可能需要考虑删除 SJCL。

# csv - 从进度数据创建 CSV 文件

> ID：15519444
> 
> 赞同：0
> 
> 时间：2013-03-20T09:16:51.763
> 
> 标签：csv, progress-4gl

我正在尝试导出一些数据库记录以创建 CSV 文件。以下代码创建 CSV 文件：

方法私有无效生成CSV（）：

```
 OUTPUT TO VALUE ("c:users\mark\test.csv").

    FOR EACH a-table WHERE a-table.id = 1: 

          EXPORT DELIMITER ',' a-table.name a-table.cost a-table.unit.

    END. 

    OS-COMMAND NO-WAIT "c:\users\mark\test.csv". 
```

结束方法。

这确实有效并创建了一个包含所有必需记录的 csv 文件，但是我想知道如何将标题放入 csv 文件中，因此我希望他们每一个都说 [Name] [Cost] [Unit]。当在 excel 中打开 csv 文件时，这些列都有标题。

有谁知道如何做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:16:14.100

```
OUTPUT TO VALUE ("c:users\mark\test.csv").

export delimiter "," "Head1" "Head2" "Head3".

FOR EACH a-table WHERE a-table.id = 1: 
... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-20T16:54:32.110

这是一些代码，用于将三个表提取到 3 个不同的 csv 文件，并根据您是在 windows 还是 unix 中运行来设置它们将写入的路径。文件名也是在运行时创建的。

使用逗号分隔的条目创建标题记录（使用数据库字段插入并排除表名，然后只需在两者之间键入分隔符:-)

如果需要，我还有一个日志文件，可用于写出任何错误等。

# 如果出现错误，文件将在 finally 块中关闭。

```
DEFINE VARIABLE cLogPathFile       AS CHARACTER NO-UNDO.
DEFINE VARIABLE cDataPathFile      AS CHARACTER NO-UNDO.
DEFINE VARIABLE cLogOutputPath     AS CHARACTER NO-UNDO.
DEFINE VARIABLE cDataOutputPath    AS CHARACTER NO-UNDO.

DEFINE BUFFER tbl_1       FOR tbl_1.
DEFINE BUFFER tbl_2       FOR tbl_2.
DEFINE BUFFER tbl_3       FOR tbl_3.

DEFINE NEW SHARED STREAM sm_log_file.
DEFINE NEW SHARED STREAM sm_tbl1.
DEFINE NEW SHARED STREAM sm_tbl2.
DEFINE NEW SHARED STREAM sm_tbl3.

IF OPSYS = "UNIX" THEN 
  DO:
    cDataOutputPath = "/Data/Out/".
    cLogOutputPath  = "/Data/".
  END.
ELSE
  DO:
    cDataOutputPath = "T:~\Data~\Out~\".
    cLogOutputPath  = "T:~\Data~\".
  END.

ASSIGN cLogPathFile = cLogOutputPath  + "myfile_" + STRING(TODAY,"999999") + "_" + STRING(TIME,"999999") + ".log" NO-ERROR.
{ mip/inc/mipreturnerror.i }
ASSIGN cDataPathFile = cDataOutputPath  + "myfile_" + "[Report Name]" + "_" + STRING(TODAY,"999999") + "_" + STRING(TIME,"999999") + ".csv" NO-ERROR.
{ mip/inc/mipreturnerror.i }

OUTPUT STREAM sm_log_file TO VALUE(cLogPathFile). 
OUTPUT STREAM sm_tbl1     TO VALUE(REPLACE(cDataPathFile, "[Report Name]", "tbl_1")). 
OUTPUT STREAM sm_tbl2     TO VALUE(REPLACE(cDataPathFile, "[Report Name]", "tbl_2")). 
OUTPUT STREAM sm_tbl3     TO VALUE(REPLACE(cDataPathFile, "[Report Name]", "tbl_3")). 

 PUT STREAM sm_tbl1 "category_obj,created_datetime,effective_date,lookup_column_heading,owning_entity_mnemonic,owning_obj,user_key,user_mnemonic,user_obj,worksheet_description,worksheet_name,worksheet_obj" SKIP.
 PUT STREAM sm_tbl2 "column_data_type,column_heading,column_number,column_obj,worksheet_obj" SKIP.
 PUT STREAM sm_tbl3 "cell_character_value,cell_date_value,cell_numeric_value,cell_text_value,column_heading,lookup_character_value,lookup_date_value,lookup_numeric_value,row_number,value_obj,worksheet_obj" SKIP.

FOR EACH tbl_1 NO-LOCK:
    EXPORT STREAM sm_tbl1 DELIMITER "," tbl_1.category_obj tbl_1.created_datetime tbl_1.effective_date agm_worksheet.lookup_column_heading tbl_1.owning_entity_mnemonic tbl_1.owning_obj tbl_1.user_tbl_1.user_mnemonic tbl_1.user_obj tbl_1.worksheet_description tbl_1.worksheet_name tbl_1.worksheet_obj.

    FOR each tbl_2 NO-LOCK WHERE tbl_2.worksheet_obj = tbl_1.worksheet_obj.
      EXPORT STREAM sm_tbl2 DELIMITER "," tbl_2.column_data_type tbl_2.column_heading tbl_2.column_number tbl_2.column_obj tbl_2.worksheet_obj.
    END.

    FOR each tbl_3 NO-LOCK WHERE tbl_3.worksheet_obj = tbl_1.worksheet_obj:
        EXPORT STREAM sm_tbl3 DELIMITER "," tbl_3.cell_character_value tbl_3.cell_date_value tbl_3.cell_numeric_value tbl_3.cell_text_value tbl_3.column_heading tbl_3.lookup_character_value tbl_3.lookup_date_value tbl_3.lookup_numeric_value tbl_3.row_number tbl_3.value_obj tbl_3.worksheet_obj.
    END.
END.

FINALLY:
    OUTPUT STREAM sm_log_file CLOSE. 
    OUTPUT STREAM sm_tbl1     CLOSE. 
    OUTPUT STREAM sm_tbl2     CLOSE. 
    OUTPUT STREAM sm_tbl3     CLOSE. 
END FINALLY. 
```

# image - 为什么将图像的文本设置为具有 rle 的paintCompression 的图像的文本会导致空白图像？

> ID：15519448
> 
> 赞同：0
> 
> 时间：2013-03-20T09:17:07.560
> 
> 标签：image, livecode

图像的文本似乎未修改。一个简单的测试，你可以看到我看到的是从图像库中获取 Mac Classic 问题图标，然后选择它并：

```
set the text of the selObj to the text of the selObj 
```

你最终应该得到一个看起来是空白图像的东西，但下面的 put 是真的：

```
put the text of the selObj into tText
set the text of the selObj to tText
-- image is now blank
put tText is the text of the selObj
-- true 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:55:59.810

有问题的图像以“rle”格式编码，这是在添加对 png、gif 和 jpeg 的支持之前存储的原始格式图像。不幸的是，目前此类图像的文本属性无法往返。

要解决此问题，您可以使用 export 命令将图像数据导出为 PNG / GIF 并改用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T12:01:51.890

另一种方法（除了转换为 png 或其他格式）是不使用文本，而是使用图像数据。请注意，您需要将每个处理过的图像的宽度和高度设置为相同的值，因为图像数据取决于屏幕上显示的内容，而不是实际存储的“真实”图像。

例如：

```
set the width of image 2 to the width of image 1
set the height of image 2 to the height of image 1
set the imagedata of image 2 to the imagedata of image 1 
```

以这种方式填充数据的图像在其文本方面不会表现得异常。因此，您可以使用它来转换行为不端的图像：

```
set the width of image 1 to the formattedwidth of image 1
set the height of image 1 to the formattedheight of image 1
set the imagedata of image 1 to the imagedata of image 1 
```

最后一点，这对我来说听起来像是一种不受欢迎的行为，您是否提交了错误？

# ruby - 清除 ActiveRecord 对象集合的最有效方法是什么？

> ID：15519450
> 
> 赞同：0
> 
> 时间：2013-03-20T09:17:12.833
> 
> 标签：ruby, activerecord

我有一个循环中的 AR 对象集合，可能会运行很多次，所以我想在每次迭代结束时清空集合。

最有效的方法是什么？

**编辑 1**

这是我使用时发生的情况的示例`.clear`：

```
1.9.3p392 :039 > t = w.tags
 => [#<Tag id: 32451, name: "c++", num_questions: 180854, created_at: "2013-02-25 07:55:55", updated_at: "2013-02-25 07:55:55">, #<Tag id: 32452, name: "performance", num_questions: 28543, created_at: "2013-02-25 07:55:55", updated_at: "2013-02-25 07:55:55">, #<Tag id: 32453, name: "optimization", num_questions: 10021, created_at: "2013-02-25 07:55:55", updated_at: "2013-02-25 07:55:55">, #<Tag id: 32454, name: "language-agnostic", num_questions: 5942, created_at: "2013-02-25 07:55:55", updated_at: "2013-02-25 07:55:55">, #<Tag id: 32455, name: "branch-prediction", num_questions: 28, created_at: "2013-02-25 07:55:55", updated_at: "2013-02-25 07:55:55">, #<Tag id: 32456, name: "books", num_questions: 2667, created_at: "2013-02-25 07:55:59", updated_at: "2013-02-25 07:55:59">, #<Tag id: 32457, name: "ebook", num_questions: 263, created_at: "2013-02-25 07:55:59", updated_at: "2013-02-25 07:55:59">, #<Tag id: 32458, name: "creative-commons", num_questions: 62, created_at: "2013-02-25 07:55:59", updated_at: "2013-02-25 07:55:59">, #<Tag id: 32459, name: "json", num_questions: 39746, created_at: "2013-02-25 07:56:03", updated_at: "2013-02-25 07:56:03">, #<Tag id: 32460, name: "content-type", num_questions: 874, created_at: "2013-02-25 07:56:03", updated_at: "2013-02-25 07:56:03">] 
1.9.3p392 :040 > t.clear
   (19.0ms)  BEGIN
   (85.2ms)  DELETE FROM "questions_tags" WHERE "questions_tags"."question_id" = 10053 AND "questions_tags"."tag_id" IN (32451, 32452, 32453, 32454, 32455, 32456, 32457, 32458, 32459, 32460)
   (36.5ms)  COMMIT
 => [] 
1.9.3p392 :041 > t
 => [] 
1.9.3p392 :042 > t
 => [] 
1.9.3p392 :043 > w.tags
 => [] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:19:04.723

[内置方法](http://ruby-doc.org/core-2.0/Array.html#method-i-clear)：

```
 your_array.clear 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:05:04.307

请查看[有关关联的 Rails 文档](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)。该`clear`方法不是`Array#clear`，它被 Rails 覆盖。

我只是复制关联中的元素，这将确保关联将被延迟加载，例如：

```
tags = w.tags.collect{|t| t}
tags.clear 
```

# twitter-bootstrap - Bootstrap Wyswihtml5图标大小在模态窗口上不一样

> ID：15519453
> 
> 赞同：0
> 
> 时间：2013-03-20T09:17:31.077
> 
> 标签：twitter-bootstrap, icons, height

我在使用 BootStrap 和 WyswiHTML5（BootStrap 主题）时遇到了视觉问题。工具栏中的按钮大小有不同的大小。从第一个到“下划线”的高度为 30px，但 elase 的高度为 25px。

有趣的是，当我写这篇文章时，我把网站移到了 jsFiddle。和？工作正常，就像在官方网站上一样。但在我的托管上不是。我不知道为什么:(

这是一个 jsFiddle：jsfiddle.net/Ezee3/，这是来自我的托管：[http ://uniti.pl/jsf/](http://uniti.pl/jsf/)

页面是一样的。

工作和不工作工具栏截图：uniti.pl/jsf/working.jpg uniti.pl/jsf/notworking.jpg

如果有人知道如何解决它，请告诉我如何解决。

最好的问候，对不起我的英语。格雷戈里

# javascript - 如何访问 Session 变量并在 javascript 中设置它们？

> ID：15519454
> 
> 赞同：89
> 
> 时间：2013-03-20T09:17:31.120
> 
> 标签：javascript, .net, session

在代码隐藏中，我设置`Session`了一些数据。

```
Session["usedData"] = "sample data"; 
```

问题是如何在 javascript 中获取 Session 值（在我的示例中；“示例数据”）并设置`Session["usedData"]`新值？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-11-27T07:38:44.237

**使用 Javascript 访问和分配会话变量：**

**使用 Javascript 分配 ASP.NET 会话变量：**

```
 <script type="text/javascript">
function SetUserName()
{
    var userName = "Shekhar Shete";
    '<%Session["UserName"] = "' + userName + '"; %>';
     alert('<%=Session["UserName"] %>');
}
</script> 
```

**使用 Javascript 访问 ASP.NET 会话变量：**

```
<script type="text/javascript">
    function GetUserName()
    {

        var username = '<%= Session["UserName"] %>';
        alert(username );
    }
</script> 
```

* * *

## 回答 #2

> 赞同：27
> 
> 时间：2013-03-20T09:18:50.603

您不能`Session`直接在 JavaScript 中访问。

您可以创建一个隐藏字段并将其传递给您的页面，然后使用 JavaScript 通过以下方式检索对象`document.getElementById`

* * *

## 回答 #3

> 赞同：15
> 
> 时间：2014-09-23T14:16:34.113

Javascript 不能直接设置会话值。为了从 javascript 设置会话值，我执行 ajax 调用如下。

[在线查询](http://runnable.com/VCF-6-cvRENwlcfb/setsessionfromjs-for-net)

在 ASPx 文件或 html 中，

```
 <script type="text/javascript">
 $(function(){
   //Getting values from session and saving in javascript variable.
   // But this will be executed only at document.ready.
   var firstName = '<%= Session["FirstName"] ?? "" %>';
   var lastName = '<%= Session["LastName"] ?? "" %>';

   $("#FirstName").val(firstName);
   $("#LastName").val(lastName);

   $('Button').click(function(){
     //Posting values to save in session
     $.post(document.URL+'?mode=ajax', 
     {'FirstName':$("#FirstName").val(),
     'LastName':$("#LastName").val()
     } );
   });

 }); 
```

在服务器端，

```
protected void Page_Load(object sender, EventArgs e)
 {
      if(Request.QueryString["mode"] != null && Request.QueryString["mode"] == "ajax")
      {
        //Saving the variables in session. Variables are posted by ajax.
        Session["FirstName"] = Request.Form["FirstName"] ?? "";
        Session["LastName"] = Request.Form["LastName"] ?? "";
      }
 } 
```

如 Shekhar 和 Rajeev 所说，用于获取会话值

```
var firstName = '<%= Session["FirstName"] ?? "" %>'; 
```

希望这可以帮助。

* * *

## 回答 #4

> 赞同：14
> 
> 时间：2013-03-20T09:18:35.203

试试这个

```
var sessionValue = '<%=Session["usedData"]%>' 
```

* * *

## 回答 #5

> 赞同：11
> 
> 时间：2013-03-20T09:19:19.737

假设你的意思是“客户端 JavaScript”——那么你不能，至少不能直接。

会话数据存储在服务器上，因此客户端代码在不与服务器通信的情况下无法看到它。

要访问它，您必须发出 HTTP 请求并让服务器端程序修改/读取并返回数据。

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2013-03-20T09:19:10.403

为代码隐藏文件中的隐藏字段赋值。在你的 javascript 中访问这个值，就像一个普通的 HTML 控件一样。

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2016-04-11T11:38:11.107

您不能从`Javascript`. 如果要执行此操作，则需要创建一个`AJAX` **POST以在****服务器**上更新此内容，但如果选择汽车是一项重大事件，则发布此内容可能更**容易**。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2016-07-29T08:02:53.060

首先在后面的代码中创建一个方法来设置会话：

```
 [System.Web.Services.WebMethod]
 public static void SetSession(int id)
 {
     Page objp = new Page();
     objp.Session["IdBalanceSheet"] = id;
 } 
```

然后从客户端调用它：

```
function ChangeSession(values) {
     PageMethods.SetSession(values);
     } 
```

您应该将 EnablePageMethods 设置为 true：

```
<asp:ScriptManager EnablePageMethods="true" ID="MainSM" runat="server" ScriptMode="Release" LoadScriptsBeforeUI="true"></asp:ScriptManager> 
```

* * *

## 回答 #9

> 赞同：2
> 
> 时间：2017-11-15T08:26:41.490

如果您想在 javascript 中读取会话值。此代码对您有帮助。

`<script type='text/javascript'> var userID='@Session["userID"]'; </script>`

* * *

## 回答 #10

> 赞同：1
> 
> 时间：2015-11-26T21:50:01.243

我一直在寻找这个问题的解决方案，直到我找到了一个非常简单的访问会话变量的解决方案，假设您在服务器端使用 .php 文件。希望它能回答部分问题：

**访问会话值**

```
<script type="text/javascript">        
    var value = <?php echo $_SESSION['key']; ?>;
    console.log(value);
</script> 
```

编辑：下面更好的示例，您可以在 phpfiddle.org 上的“代码空间”选项卡上尝试

```
<!DOCTYPE html>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <?php
    $_SESSION['key'] = 10;
    $i = $_SESSION['key'];
  ?>
 </head>
 <body>
  <p id="affichage">hello</p>

  <script type="text/javascript">
    var value =  <?php echo $i; ?>;
    $("#affichage").html(value);   
  </script>

 </body>
</html> 
```

**设置会话值**

将它传递给您可能想要的任何变量。例如，

```
$you = 13;
$_SESSION['user_id'] = $you; 
```

这应该可以，但没有测试过。

* * *

## 回答 #11

> 赞同：1
> 
> 时间：2016-02-03T19:45:55.743

您还可以在属性中设置变量并从 js 中调用它：

在服务器端：

```
Protected ReadOnly Property wasFieldEditedStatus() As Boolean
    Get
        Return If((wasFieldEdited), "true", "false")
    End Get
End Property 
```

然后在javascript中：

```
alert("The wasFieldEdited Value: <%= wasFieldEditedStatus %>" ); 
```

* * *

## 回答 #12

> 赞同：1
> 
> 时间：2017-07-03T10:23:10.247

这是作弊，但你可以这样做，将值作为参数发送到服务器端

```
<script>
var myVar = "hello"
window.location.href = window.location.href.replace(/[\?#].*|$/, "?param=" + myVar); //Send the variable to the server side
</script> 
```

并从服务器端检索参数

```
string myVar = Request.QueryString["param"];
Session["SessionName"] = myVar; 
```

希望这可以帮助

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2018-05-12T19:34:56.090

要在创建页面后从服务器修改会话数据，您需要使用 AJAX 甚至 JQuery 来完成工作。它们都可以与服务器建立连接以修改会话数据并从该连接中获取返回的数据。

```
<?php
session_start();
$_SESSION['usedData'] = "Some Value"; //setting for now since it doesn't exist
?>
<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Modifying PHP Session Data</title>
        <script type='text/javascript'>
            var usedData = '<?php echo $_SESSION['usedData']; ?>';
            var oldDataValue = null;

            /* If function used, sends new data from input field to the
               server, then gets response from server if any. */

            function modifySession () {
                var newValue = document.getElementById("newValueData").value;

                /* You could always check the newValue here before making
                   the request so you know if its set or needs filtered. */

                var xhttp = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");

                xhttp.onreadystatechange = function () {
                    if (this.readyState == 4 && this.status == 200) {
                        oldDataValue = usedData;
                        usedData = this.responseText; //response from php script
                        document.getElementById("sessionValue").innerHTML = usedData;
                        document.getElementById("sessionOldValue").innerHTML = oldDataValue;
                    }
                };

            xhttp.open("GET", "modifySession.php?newData="+newValue, true);
            xhttp.send(); 
            }
        </script>
    </head>
    <body>
        <h1><p>Modify Session</p></h1>

        Current Value: <div id='sessionValue' style='display:inline'><?php echo $_SESSION['usedData']; ?></div><br/>
        Old Value: <div id='sessionOldValue' style='display:inline'><?php echo $_SESSION['usedData']; ?></div><br/>

        New Value: <input type='text' id='newValueData' /><br/>
        <button onClick='modifySession()'>Change Value</button>
   </body>
</html> 
```

现在我们需要创建一个名为 modifySession.php 的小 php 脚本来更改会话数据并在必要时将数据发回。

```
<?php
session_start();
$_SESSION['usedData'] = $_GET['newData']; //filter if necessary
echo $_SESSION['usedData']; // Post results back if necessary
?> 
```

这应该通过使用 PHP/AJAX 通过服务器端修改会话来实现您正在寻找的预期结果。

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2019-07-31T15:50:10.677

这对我有用。Javascript有这个。

```
<script type="text/javascript">
var deptname = '';
</script> 
```

后面的 C# 代码有这个 - 它可以放在母版页上，因此它会在页面更改时重置 var。

```
 String csname1 = "LoadScript";
        Type cstype = p.GetType();

        // Get a ClientScriptManager reference from the Page class.
        ClientScriptManager cs = p.ClientScript;

        // Check to see if the startup script is already registered.
        if (!cs.IsStartupScriptRegistered(cstype, csname1))
        {
            String cstext1 = funct;
            cs.RegisterStartupScript(cstype, csname1, "deptname = 'accounting'", true);
        }
        else
        {
            String cstext = funct;
            cs.RegisterClientScriptBlock(cstype, csname1, "deptname ='accounting'",true);
        } 
```

将此代码添加到按钮单击以确认部门名称已更改。

```
alert(deptname); 
```

* * *

## 回答 #15

> 赞同：0
> 
> 时间：2018-03-14T07:22:43.357

我使用我的 .php 文件将 required 放入会话中

> $_SESSION['name'] = $phparray["name"]; $ajaxoutput['name'] =$phparray["name"];

在我使用的 .js 文件中

> sessionStorage.setItem("name", ajaxreturnedarray["name"]);

我用

> var myName= sessionStorage.getItem("name");

在其他 .js 文件或相同的 .js 文件中

如果我保持原样，即使您注销，它也会始终返回相同的结果。所以在注销时我做了

> sessionStorage.setItem("名称", "");

使用这个我清空了局部变量。我在单页网站登录/注销会话中使用了这个过程。我希望这种方式对你有用，因为它对我有用。请让我知道你的经历。

* * *

## 回答 #16

> 赞同：0
> 
> 时间：2019-02-20T15:22:05.177

我能够通过简单的 URL 参数和自动刷新来解决类似的问题。

您可以从 URL 参数中获取值，对它们做任何您想做的事情，然后简单地刷新页面。

HTML：

```
<a href=\"webpage.aspx?parameterName=parameterValue"> LinkText </a> 
```

C＃：

```
string variable = Request.QueryString["parameterName"];
if (parameterName!= null)
{
   Session["sessionVariable"] += parameterName;
   Response.AddHeader("REFRESH", "1;URL=webpage.aspx");
} 
```

* * *

## 回答 #17

> 赞同：-1
> 
> 时间：2020-10-03T04:13:52.093

```
<?php
    session_start();
    $_SESSION['mydata']="some text";
?>

<script>
    var myfirstdata="<?php echo $_SESSION['mydata'];?>";
</script> 
```

* * *

## 回答 #18

> 赞同：-1
> 
> 时间：2020-11-16T00:21:20.963

这种方法可能有一些里程。这似乎将日期返回到会话变量。它返回的字符串显示 javascript 日期，但是当我尝试操作该字符串时，它会显示 javascript 代码。

```
ob_start();
?>
<script type="text/javascript">
    var d = new Date();
    document.write(d);
</script>
<?
$_SESSION["date"]  = ob_get_contents();
ob_end_clean();
echo $_SESSION["date"]; // displays the date
echo substr($_SESSION["date"],28); 
// displays 'script"> var d = new Date(); document.write(d);' 
```

# python - Python，Pyramid，Chameleon：在字符串中解析 Chameleon 模板

> ID：15519455
> 
> 赞同：0
> 
> 时间：2013-03-20T09:17:32.103
> 
> 标签：python, pyramid, chameleon

我有一个以字符串形式存储的变色龙模板。我以这种形式得到它，因为我需要先进行自己的处理。之后，我想解析模板，可能使用“渲染响应”：

```
render_to_response('templates/foo.pt',
        {'foo':1, 'bar':2},
        request=request) 
```

但是，我不知道如何解析存储在字符串中的模板，而不是指向文件中的模板。这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:28:16.490

> 但是，我不知道如何解析存储在字符串中的模板，而不是指向文件中的模板。这可能吗？

似乎是这样，根据[api 文档](http://chameleon.readthedocs.org/en/latest/library.html#template-classes)：

```
from chameleon import PageTemplate

t = PageTemplate('some string template')
rendered_content = t.render(encoding='utf-8') 
```

# ios - 本地通知显示 sprocket 图标而不是应用程序图标

> ID：15519465
> 
> 赞同：0
> 
> 时间：2013-03-20T09:18:27.577
> 
> 标签：ios, uilocalnotification

我正在我的应用程序中安排本地通知。但是，当它们出现时，横幅中会显示错误的图标。我创建了一个带有通知和应用程序图标的干净项目，并且在该项目中它可以工作。在我的大项目文件中它没有。我宁愿不将我的完整项目迁移到新的 xCode 项目。

有人见过这个吗？

[错误通知图标截图](http://i.stack.imgur.com/GWnOZ.png)

# jquery - 滚动时隐藏和再次显示的菜单

> ID：15519466
> 
> 赞同：1
> 
> 时间：2013-03-20T09:18:28.903
> 
> 标签：jquery, menu, scroll

当您单击它时，我试图隐藏菜单。当您单击菜单时，它会滑到侧面的特定部分（单页网站）。我喜欢在向下/向上滚动时隐藏菜单，并在到达页面上的点或停止滚动时再次显示。

```
$('.hoofdnav ul li a').click(function() {
    $('header.HoofdNav').fadeOut('slow', function() {
        setTimeout(showMenu, 1000);
    });
});
function showMenu() {
        $('header.HoofdNav').fadeIn('slow');
}; 
```

我也尝试使用 slideUp 和 slideDown 而不是 fadeOut/In

这是有效的，但不是我的想法。

*   有没有办法同时滑动和淡出？
*   如何在滚动期间隐藏菜单并在停止滚动时显示？（也许是教程或其他东西）

tnx

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:49:13.773

> Is there a way to slide and fade at the same time?

Probably you should use `.animate()`. [Here](http://api.jquery.com/animate/) is the reference. In your case it should look something like this:

```
function hideMenu(){
 $('header.HoofdNav').stop().animate({
  opacity: 0,
  width: 0
 });
}

function showMenu(){
 $('header.HoofdNav').stop().animate({
  opacity: 1,
  width: '100%'
 });
} 
```

> How to hide the menu during scroll and showing when you stop scrolling? (maybe a tutorial or something)

To track scrolling you can use `.scroll()`. Check it [here](http://api.jquery.com/scroll/). It triggers multiple times during scrolling, so I would recommend to make a timeout for e.g. 1 second to show the menu. Here is an example:

```
var timeout = false, afterScrollingWait = 1000; // here 1000 is time in milliseconds, play with it to make it the best for your app
$(document).scroll(function(){
 hideMenu();
 if (timeout) clearTimeout(timeout);
 setTimeout(showMenu, afterScrollingWait); 
}); 
```

# php - Symfony2：检查控制器中的用户对象，最佳实践

> ID：15519467
> 
> 赞同：0
> 
> 时间：2013-03-20T09:18:33.643
> 
> 标签：php, security, symfony

`getUser()`在控制器中检查服务调用的`security.context`对象实际上是我的自定义用户类的对象是个好主意吗？

```
public function editAction()
{
    $user = $this->container->get('security.context')->getToken()->getUser();
    if (!is_object($user) || !$user instanceof \Acme\UserBundle\User) {
        throw new AccessDeniedException('This user doesn't have access');
    }

    // work with $user
    // .... 
```

唯一可以保证的是`getUser()`返回一个已实现的对象`Symfony\Component\Security\Core\User\UserInterface`，没有别的，对吧？

这意味着控制器可能会接收任何类型的对象（可能是匿名令牌）所以如果我将对象直接传递（不控制它）到随后调用的视图中`{{ user.biography }}`，这仅在`Acme\UserBundle\User`类中实现..，我会犯错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:59:54.960

如果您的配置允许这种可能性，这是一个好主意。如果您允许匿名用户或实现了多个类型，则可能会发生这种情况。

在您实现多种用户类型时，让它们共享一个通用接口可能是个好主意。您还可以覆盖每个类的“getRole”方法，以便每种类型返回一个定义其类型的额外角色，然后使用访问控制过滤掉不需要的类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:21:45.063

最好使用这种类型的条件。

```
public function editAction()
{
    if (!$this->get('security.context')->isGranted('ROLE_USER')) {
        return  $this->redirect($this->generateUrl('frontend_cart_login'));
    }
... 
```

您可以选择在您的 security.yml 文件中定义的您自己的“角色”。

# python - 在python中匹配一行

> ID：15519470
> 
> 赞同：-1
> 
> 时间：2013-03-20T09:18:35.250
> 
> 标签：python, string

我需要在现有的 xml 文件中添加一个额外的行。我需要添加一个新行。现有的 xml 文件有这些行

```
 <serviceInstance name="idstore.ldap" provider="idstore.ldap.provider">
  <property name="idstore.config.provider" value="oracle.security.jps.wls.internal.idstore.WlsLdapIdStoreConfigProvider"/> 
```

我需要在这两行之后添加一个额外的行。

所以我写了一个代码，它打开源文件并逐行复制到新的目标文件。在复制的 for 循环中，我放置了一个条件

```
for line in source:
    if line.strip().startswith('<property name=\"idstore.config.provider\"'):
        print 1                
        destination.write(line)
        destination.write('<property name=\"virtualize\" value=\"false\"/>')#
        continue
    else:
        print 2
        destination.write(line)
        continue 
```

但是 if 条件与该行不匹配，并且该条件被遗漏了。谁能指出如何解决这个问题。开头的任何空格导致错误？我是python新手，如果这是一个微不足道的问题，请原谅。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:35:05.307

您的问题是您`r`在字符串前面使用。Python 使用该标志从字面上解释字符串，即

```
r'test\"' 
```

正是

```
'test\\"' 
```

在您的字符串中删除`r`或删除。`\`

# android - Android - 动态添加几个 MapFragment

> ID：15519476
> 
> 赞同：1
> 
> 时间：2013-03-20T09:18:40.140
> 
> 标签：android, dynamic, mapfragment

对于我的应用程序，我必须从启动器附近实现一些东西：我必须提供动态添加、删除、调整大小和拖放一些 UI 元素的能力（我们称它们为“小部件”，但它们不是 Android AppWidgets）。它工作得很好，但是这些“小部件”之一包含一个 MapFragment，我无法添加它两次，也不能删除它并再次添加它。

目前，每个“小部件”都继承自 FrameLayout。MapFragment 是从 xml 加载的。问题是我们不能通过代码设置 Fragment id，如果我在 xml 中这样做，我的所有地图显然都有相同的 id。所以我得到了这个例外：

```
03-20 09:55:35.078: E/AndroidRuntime(19507):
Caused by: java.lang.IllegalArgumentException:
Binary XML file line #24: Duplicate id 0xffffffff, tag map,
or parent id 0xffffffff with another fragment for
com.google.android.gms.maps.MapFragment 
```

这是片段的代码：

```
...
<fragment
    android:tag="map"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    class="com.google.android.gms.maps.MapFragment" />
...

View.inflate(getContext(), layout, R.layout.widget_map); 
```

所以我在这里，完全卡住了^^。我已经在 stackoverflow 和互联网上进行了搜索，但没有找到解决方案。

此外，我使用的是 Android Maps API V2，每次更改屏幕方向时都会在控制台中打印一些 GC（所以当重新绘制地图时），我必须担心它们吗？

```
03-20 10:02:41.820: D/dalvikvm(19650): GC_CONCURRENT freed 1929K, 17% free 11579K/13940K, paused 3ms+4ms, total 44ms
03-20 10:02:42.250: D/dalvikvm(19650): GC_CONCURRENT freed 382K, 14% free 12123K/13940K, paused 3ms+13ms, total 67ms
03-20 10:02:42.250: D/dalvikvm(19650): WAIT_FOR_CONCURRENT_GC blocked 51ms
03-20 10:02:42.328: D/dalvikvm(19650): GC_CONCURRENT freed 2114K, 21% free 11099K/13940K, paused 2ms+2ms, total 45ms
03-20 10:02:42.328: D/dalvikvm(19650): WAIT_FOR_CONCURRENT_GC blocked 32ms 
```

任何的建议都受欢迎 ！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:28:39.343

您是否尝试过为不同`id`的地图赋予不同的 s？

```
 android:id="@+id/map1"

    android:id="@+id/map2" // etc... 
```

否则，您可以使用 [`setId()`](https://developer.android.com/reference/android/view/View.html#setId%28int%29)您的意见。

如果使用`Fragment`s 不起作用，您可以添加

```
<com.google.android.gms.maps.MapView
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/map1"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

在您的 XML 中，并在您的代码中进行设置。请参阅[Google 的 Maps V2 Demo](https://developers.google.com/maps/documentation/android/intro#sample_code) `RawMapViewDemoActivity`的代码。

对于 GC 调用，我不担心，`MapView`s 需要大量内存，并且屏幕旋转会破坏并重新创建您的所有视图，所以这是正常的事情。

# .net - SAP Crystal 将 SAP R3 报告到 .NET

> ID：15519477
> 
> 赞同：0
> 
> 时间：2013-03-20T09:18:43.450
> 
> 标签：.net, crystal-reports, sap-r3

我正在尝试在 Visual Studio 2012 上创建 SAP Crystal 报表。我已经在 VS 上安装了相同的报表，现在可以在 WinForm 应用程序中打开报表。我基本上希望获取 SAP R/3 数据（可能通过 RFC）并将其显示在报告中。

目前，我没有在 Crystal 报表的“数据库专家”下获得 SAP 选项。

谁能告诉我从 SAP R/3 迁移数据并将其显示在水晶报表上的正确方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:49:18.123

据我所知，您不能直接从 SAP ERP 系统（如数据库）访问数据。您需要使用连接器连接到 SAP 系统（例如 SAP .Net 连接器，请[在此处](http://service.sap.com/connectors)下载（您需要访问 SAP 服务门户）。使用 .Net 连接器，您可以使用 BAPI 访问业务对象或使用远程启用功能模块，如 RFC_READ_TABLE 来加载表格内容。之后，您可以将这些信息例如放在数据集中并在水晶报表中使用。

# java - 在JAVA文件中嵌入pig查询进行操作

> ID：15519478
> 
> 赞同：1
> 
> 时间：2013-03-20T09:18:43.473
> 
> 标签：java, hadoop, mapreduce, apache-pig

我正在寻找在 java map-reduce 程序中嵌入 pig 查询。我想知道这是否可能。如果可能的话如何完成它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:27:04.247

我会[先阅读关于“嵌入式猪”的文档](http://pig.apache.org/docs/r0.11.0/cont.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-19T19:46:47.260

是的。有可能的。查看@Arnon 建议的文档。基本上它是使用 PigServer 来注册您的查询/jar。此后，您可以使用控制流构造来链接作业。

# java - 使用 2 个数据库表创建单个实体

> ID：15519479
> 
> 赞同：0
> 
> 时间：2013-03-20T09:18:45.413
> 
> 标签：java

对不起这个问题，但我只是java的初学者。我只是想知道是否可以使用当前存在的数据库中的 2 个表创建一个实体？如果是，如何？

这是表格和相应的列：

表名：书表列：标题、标题、副标题、详细信息、图像、书标

表名：Book_dtl 表列：BookSeqNo、Contents、Content_tag、ContSeqNo。

它们在 BOOK[Header, Title, Subtitle, Details] 中加入到 BOOK_dtl[BookSeqNo]..

提前致谢！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:25:50.733

您可以通过在数据库中创建视图来从两个数据库列创建只读实体。只需在`@Table`注释中指定视图的名称，然后照常进行注释。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:40:59.797

有两种方法 1\. 使用 SQL JOINS 2\. 使用 SQL UNION

您可以通过快速谷歌搜索来帮助自己了解这些语法。

但是，如果您选择 UNION，则需要注意一件事，因为我们可以使用 UNION 集成到 select 语句中，UNION 中的每个 SELECT 语句必须具有相同数量的列，并且列也必须具有相似的数据类型。此外，每个 SELECT 语句中的列的顺序必须相同。

希望它可以帮助你。

# iphone - 在横向模式下显示导航控制器不起作用 ios 6.0

> ID：15519486
> 
> 赞同：1
> 
> 时间：2013-03-20T09:19:00.260
> 
> 标签：iphone, objective-c, ios6

这是我的代码。

```
 SomeController *analyticsViewController = [[SomeController alloc] init];

 MTNavigaionLandscapeViewController *analyticsNavigaionObject =  [[MTNavigaionLandscapeViewController alloc] initWithRootViewController:analyticsViewController];

 [analyticsNavigaionObject setNavigationBarHidden:YES];

 if ([self respondsToSelector:@selector(presentModalViewController:animated:completion:)]) {
      [self presentViewController:analyticsNavigaionObject animated:YES completion:nil];
  } else {
          [self presentModalViewController:analyticsNavigaionObject animated:YES];
  }
  [analyticsViewController release];
  [analyticsNavigaionObject release]; 
```

这是 SomeController.m 中支持的方向

```
- (NSUInteger)supportedInterfaceOrientations
{
 return UIInterfaceOrientationMaskLandscape;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
  return UIInterfaceOrientationLandscapeRight;
} 
```

以及 MTNavigaionLandscapeViewController 中支持的方向（UINavigationController 的子类）

```
- (NSUInteger)supportedInterfaceOrientations
{
 return UIInterfaceOrientationMaskLandscape;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
 return UIInterfaceOrientationLandscapeRight;
} 
```

最后，如果我只提供 SomeController，它可以正常工作。我的问题是，当我提供 Navigationcontroller 时，就会出现问题。请帮我

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T16:08:34.263

**如何强制 iPhone 旋转到某个方向。**

*问题*

iPhone 和 iPad 应用程序可以支持纵向或横向或两者。有时，一个或少数几个视图需要仅以纵向或横向显示，或者以其余应用程序不支持的方向显示。iOS 或 cocoa 框架分别提供方法来为每个视图单独定义，支持哪些方向。但是，除非任何限制适用于所有应用程序并因此分别在项目或目标级别上定义，否则必须执行轮换的始终是用户。应用程序可以决定它是否支持某个方向，但它不能强制系统实际旋转。

本教程展示了如何克服这种不足。

给出的示例是一个 iPhone 应用程序，它以纵向模式呈现除一个视图控制器之外的所有视图控制器。出于良好的设计和可用性原因，其中一个视图控制器仅适用于横向。

到目前为止，这已在 iPhone iOS 6 上得到证明。

*旋转模态呈现的视图控制器*

当视图以模态方式呈现时，此任务很容易。对于模态呈现的视图控制器，呈现的视图控制器应仅支持横向，并且在模态呈现视图之前，视图控制器的方向应设置为横向。

```
[[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationLandscapeLeft animated:YES];
[self presentModalViewController:landscapeVC animated:YES]; 
```

这样做，视图控制器`landscapeVC`将以横向显示。

但是要保留导航栏等。我想将其推送到导航控制器的堆栈中。不幸的是，除非用户实际旋转设备，否则设备不会旋转其方向。

此外，我的应用程序有两个目标。其中一个的导航基于标签栏，另一个目标的导航（功能减少免费版本）是普通的。因此，我的解决方案需要同时适用于带有标签栏的应用程序和不带标签栏的应用程序。

因此，对于只有标签栏或根本没有标签栏的应用程序，此解决方案可能会过大。但它在任何情况下都有效。

*标签栏控制器的方向问题*

当标签栏显示其视图控制器时，控制方向的是标签栏控制器。实际上，这意味着其中呈现的所有视图都应该支持所有相同的方向。为了克服这个问题，我们需要子类`UITabBar`化并引入一些控制标签栏是否支持横向的功能。

*对应用程序委托的更改*

在我的例子中，我向应用程序委托添加了一个布尔变量。这是因为使用标签栏或不使用标签栏运行的双重性。如果您只有一个标签栏，您可能会将该变量作为属性添加到您的标签栏子类中。对于书外的 OOP，单例会很好，但我认为对于单个布尔开关来说有点过大。

AppDelegate.h：

```
@property BOOL  isLandscapePreferred; 
```

它是自动合成的。它的默认值为`NO`. 但是，您可能希望在您的应用程序委托中`NO`明确设置。`application:didFinishLoadingWithOptions:`

对于没有标签栏的目标，我所有的视图控制器都需要响应该设置。基本上，呈现横向视图的必须实现以下内容。但是，在整个应用程序中使用它并没有什么坏处，尤其是当您的应用程序中有多个视图需要以横向显示时。

*对 UIApplication 的更改*

根据我在网上找到的一些建议，我决定继承 UIApplication 并覆盖`supportedInterfaceOrientations`那里。但是，我仍然在 xcode 的目标摘要窗格中将所有方向标记为支持，尽管该设置应该被 UIApplication 覆盖。

MyApp.h 和 MyApp.m：

```
#import <UIKit/UIKit.h>

@interface MyApp : UIApplication

@end

#import "MyApp.h"
#import "AppDelegate.h"

@implementation MyApp

- (NSUInteger)supportedInterfaceOrientationsForWindow:(UIWindow *)window {

    if ([(AppDelegate*) [[UIApplication sharedApplication] delegate] isLandscapePreferred]) {
        return (UIInterfaceOrientationMaskLandscapeLeft | UIInterfaceOrientationMaskLandscapeLeft);
        NSLog(@"PhotocollApp: Landscape");
    } else {
        return (UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown);
        NSLog(@"PhotocollApp: Portrait");
   }

}

@end 
```

*从 main 调用 MyApp*

接下来，我们需要确保我们的子类应用程序对象在应用程序启动时被实例化。这需要更改 main.m。

```
#import <UIKit/UIKit.h>

#import "AppDelegate.h"
#import "PhotocollApp.h"

int main(int argc, char *argv[])
{
    @autoreleasepool {
        return UIApplicationMain(argc, argv, NSStringFromClass([MyApp class]), NSStringFromClass([AppDelegate class]));
    }
} 
```

`UIApplicationMain`传递了两个接收到的参数`argc`，`argv`在前两个参数中，后跟两个`NSString`对象，代表应用程序类的名称和一个应用程序委托类。我没有更改应用程序委托的标准名称，但我们需要在这里标识我们自己的应用程序类。

*在所有视图控制器中覆盖supportedInterfaceOrientations*

`UIViewController`我已经介绍了和的“抽象”子类`UITableViewController`。我所有的视图控制器都继承自它们：

MyRotatingViewController.h 和 .m：

```
#import <UIKit/UIKit.h>

@interface MyRotatingViewController : UIViewController

@end

#import "MyRotatingViewController.h"
#import "AppDelegate.h"

@implementation MyRotatingViewController

// … 

#pragma mark - Rotation Management

- (BOOL) shouldAutorotate {

    return NO;
}

- (NSUInteger)supportedInterfaceOrientations {

    if ([(AppDelegate*) [[UIApplication sharedApplication] delegate] isLandscapePreferred]) {
        return (UIInterfaceOrientationMaskLandscapeLeft | UIInterfaceOrientationMaskLandscapeLeft);
    } else {
        return (UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown);
    }

}

@end 
```

对于`MyRotatingTableViewController`. 唯一的区别在于 .h 文件。自然它继承自`UITableViewController`.

```
#import <UIKit/UIKit.h>

@interface MyRotatingTableViewController : UIViewTableController

@end 
```

确保所有（受影响的）视图控制器都继承自`MyRotatingViewController`或`MyRotatingTableViewController`分别继承。除了实现这个“抽象”类，你当然可以`shouldAutorotate`在`supportedInterfaceOrientations`所有相关的视图控制器中实现。

*自定义标签栏类*

如上所述，在标签栏驱动的应用程序中，是标签栏的方法控制方向设置，而不是标签栏呈现的视图控制器的方法。

```
//  MyTabBarController.h
#import <UIKit/UIKit.h>

@interface MyTabBarController : UITabBarController

@end

//  MyTabBarController.m

#import "MyTabBarController.h"

#import "AppDelegate.h"

@interface MyTabBarController ()

@end

@implementation MyTabBarController

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
}

#pragma mark - Rotation Management

- (BOOL) shouldAutorotate {

    return YES;
}

- (NSUInteger)supportedInterfaceOrientations {

    if ([(AppDelegate*) [[UIApplication sharedApplication] delegate] isLandscapePreferred]) {
        return (UIInterfaceOrientationMaskLandscapeLeft | UIInterfaceOrientationMaskLandscapeLeft);
    } else {
        return (UIInterfaceOrientationMaskPortrait | UIInterfaceOrientationMaskPortraitUpsideDown);
    }

}
@end 
```

当我使用情节提要时，我只需要`MyTabBarController`在 IB 中唯一的选项卡栏对象的属性窗格中进行设置。如果您以编程方式创建它，那么只需实例化`MyTabBarController`而不是`UITabBarController`.

*调用视图控制器强制横向*

根据 80/20 法则，我们只为 20% 的实际工作做好了 80% 的准备。 现在真正的工作来了……

这是视图控制器的方法的中间，横向视图被推送。就我而言，这是在一个`tableView:didSelectRowAtIndexPath:`实现中。它当然可以在`IBAction`方法内或`prepareForSegue:sender:`方法内。如果您这样做，`prepareForSegue`那么您可能会在运行时在错误控制台上出现警告。一方面我没有看到任何故障，但另一方面我不知道当应用程序提交到商店时这是否会通过或导致拒绝。

诀窍是将状态栏的方向设置为横向，然后以模态方式呈现视图控制器。现在设备处于横向模式。到目前为止，用户不应该看到任何东西。即使，裸视图控制器没有视图。根本不会显示零视图。接下来这个最近呈现的视图控制器被解除。之后，真正的视图控制器将被推送到导航堆栈。

这是代码：

```
//set the landscape switch for the tab bar, view controllers and application
[(AppDelegate*) [[UIApplication sharedApplication] delegate] setIsLandscapePreferred:YES];

//set statusbar to the desired rotation position
[[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationLandscapeLeft animated:YES];

// Create any view controller. UIViewController will do. 
// Present it modally and directly after that dismiss it again. 
UIViewController *anyVC = [[UIViewController alloc] init];
[self presentModalViewController: anyVC animated:NO];
[self dismissModalViewControllerAnimated:NO];
// The user should not have noticed anything but how the device is in landscape orientation

//Frankly I am not sure whether the next statement must be included or does not need to be. 
//While working on “my” solution I came across a number of tricks and hints on several places on the web and this was amongst them.
//At least it does not do any harm. 
if ([UIViewController respondsToSelector:@selector(attemptRotationToDeviceOrientation)]) {
    // this ensures that the view will be presented in the orientation of the device
    // This method is only supported on iOS 5.0\.  iOS 4.3 users may get a little dizzy.
    [UIViewController attemptRotationToDeviceOrientation];
}

// Get the storyboard named secondStoryBoard from the main bundle:
UIStoryboard *storyBoard = [UIStoryboard storyboardWithName:@"MainStoryboard_iPhone" bundle:nil];

// I am using storyboard in this project. If you don’t do that then you could just instantiate the view controller the usual way with alloc/init or by loading from nib. 
LandscapeVC *landscapeVC = (landscapeVC *)[storyBoard instantiateViewControllerWithIdentifier:@"LandscapeVC"];

// Then push the new view controller in the usual way:
[self.navigationController pushViewController:paintingVC animated:YES]; 
```

*横向视图控制器*

我们快到了。现在，新的视图控制器`LandscapeVC`在标签栏应用程序上以横向模式呈现。对于没有标签栏的应用程序，我们必须对`LandscapeVC` 视图控制器本身进行一些更改。当然，我们需要确保在关闭横向模式的视图控制器时设备旋转回纵向。

LandscapeVC.m 的片段

```
#pragma mark - actions

// certain tasks need to be performed before the view controller is dismissed. This could be done within the viewWillDisappar. 
// Again, if you do that in viewWillDisappear: then you risk some warnings on the console. I have decided to overlay the “Back” button (leftBarButtonItem) with a custom button that invokes the following action. 
- (IBAction)done :(id)sender{

    //set the landscape switch back to off/NO/portrait
    [(AppDelegate*) [[UIApplication sharedApplication] delegate] setIsLandscapePreferred:NO];

    //set statusbar to the desired rotation position
    [[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationPortrait animated:YES];

    //present/dismiss viewcontroller in order to activate rotating.
    UIViewController *mVC = [[UIViewController alloc] init];
    [self presentModalViewController:mVC animated:NO];
    [self dismissModalViewControllerAnimated:NO];

    [self.navigationController popViewControllerAnimated:YES];
    return;
}

#pragma mark - Rotation
// Rotation

-(BOOL)hidesBottomBarWhenPushed{
// This one is just for my design. I like to use the full screen of the iPhone for my landscape view controller. 
// In the end it is the size of the pane in my case which motivates me to break with UI guidelines and force the user to use this single view controller in landscape only. 
// Besides this design issue this method is not required for the rotation itself. 
// What it does: It overwrites the getter of the UIViewController property hidesBottomBarWhenPushed. 
// By returning YES as constant the bottom bar (= tab bar in my case) will be hidden. 
// However, it remains hidden in the event that any more view controllers are pushed on top of the navigation stack. 
// So if you plan to drill further down in your navigation from here, it may not be a good idea to hide the bottom bar. 
// You will not get it back until the user returns to the calling view controller. 
    return YES;
}

// Well, if all of your view controllers inherit from MyRotatingViewController or MyRotatingTableViewController
// respectively then the following is redundant. 
// While writing this “tutorial” for stack overflow I noticed that this
// very view controller does not. Don’t ask me why. I may fix it later. 
// However, I want to show to you what is proven to work fine. Therefore I owe you these methods. 
-(BOOL)shouldAutorotate{
    return NO;
}

- (NSInteger)supportedInterfaceOrientations{
    return (UIInterfaceOrientationLandscapeRight | UIInterfaceOrientationLandscapeLeft);
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation{
    return (UIInterfaceOrientationLandscapeLeft);
} 
```

就是这样。很直接，不是吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:30:43.027

**在您将要展示的 ViewController 中编写这些方法：**

```
- (BOOL)shouldAutorotate
{
    AppDelegate *mainDelegate = (AppDelegate*)[[UIApplication sharedApplication]delegate];
    mainDelegate.shouldRotate = YES;
    return YES;
}
- (NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationMaskLandscapeRight;
}
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation
{
    return YES;
} 
```

**在你的 AppDelegate.m 中粘贴这个**

```
- (NSUInteger) application:(UIApplication *)application supportedInterfaceOrientationsForWindow:(UIWindow *)window
{
    if(self.shouldRotate)
    {
        self.shouldRotate = NO;
        return UIInterfaceOrientationMaskLandscapeRight;
    }
    return UIInterfaceOrientationMaskPortrait;
} 
```

**在你的 AppDelegate.h 中粘贴这个**

```
@property (assign, nonatomic) BOOL shouldRotate; 
```

**在 ViewWillAppear 中的 presentingViewController 中粘贴：**

```
[[UIApplication sharedApplication] setStatusBarOrientation:UIInterfaceOrientationLandscapeRight animated:NO]; 
```

# c - C 探查器给出错误的结果

> ID：15519489
> 
> 赞同：0
> 
> 时间：2013-03-20T09:19:02.397
> 
> 标签：c, profiler

你能告诉我，这段代码**[http://pastebin.com/A2upK4Lx](http://pastebin.com/A2upK4Lx)**有什么问题吗？因为它给了我运行时间：0.00000，这很奇怪，因为我没有在那里发现错误。有没有可能，代码很好，但是代码执行得如此之快，以至于即使 C 也无法打印出来（但我认为这不太可能）？

谢谢你们的回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:20:45.470

> 有没有可能，代码很好，但是代码执行得如此之快，以至于即使 C 也无法打印出来（但我认为这不太可能）？

不，这确实很有可能。我们不再是 70 年代，计算机**速度很快。**

# c++ - QDomElement 在创建它的函数之外是否无效？

> ID：15519492
> 
> 赞同：1
> 
> 时间：2013-03-20T09:19:09.130
> 
> 标签：c++, qt, variables, dom

我想这样创建`QDomElement`：

```
class DomParser : public QObject
{
public:
    DomParser();
QDomDocument doc;
QDomElement* root;
}

QDomElement* DomParser::domParameterStatus(UniversalMessage* parameterStatus)
{

    root = &(doc.createElement("doc"));
    QDomText latin = doc.createTextNode("Ars longa vita brevis");
    QDomText english = doc.createTextNode("Art is long, life is short");
    doc.appendChild(root);
    root.appendChild(quote);
    root.appendChild(translation);
    ...
    return root;
} 
```

我将 root 设置为 DomParser 类中的成员只是为了保存 dom 树结构，**但 root 的子级在函数之外是否有效？**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:21:46.393

是的，只要 doc 没有被破坏。从[文档](http://qt-project.org/doc/qt-4.8/qdomdocument.html)中：

> 由于元素、文本节点、注释、处理指令等不能存在于文档的上下文之外，因此文档类还包含创建这些对象所需的工厂函数。创建的节点对象有一个 ownerDocument() 函数，该函数将它们与在其上下文中创建它们的文档相关联。最常使用的 DOM 类是 QDomNode、QDomDocument、QDomElement 和 QDomText。
> 
> 解析的 XML 在内部由可以使用各种 QDom 类访问的对象树表示。所有 QDom 类只引用内部树中的对象。一旦最后一个引用它们的 QDom 对象和 QDomDocument 本身被删除，DOM 树中的内部对象将被删除。

此外， appendChild 将子节点重新设置为父节点，因此只要 root 是它们的父节点并且存在，它们就不会去任何地方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:21:56.033

回答您的问题：是的，所有元素一旦添加到父节点，只要它们的父节点存在，就将继续有效。

您这里的代码不正确，无法编译。这一行：`root = &(doc.createElement("doc"));`正在尝试创建指向临时变量的指针。这不仅是一个非常糟糕的主意，几乎肯定会导致崩溃，而且根本没有必要。QDom 被设计为完全基于值的，您根本不需要使用指针。这是您的方法的固定版本：

```
QDomElement DomParser::domParameterStatus(UniversalMessage* parameterStatus)
{
    root = doc.createElement("doc");
    QDomText latin = doc.createTextNode("Ars longa vita brevis");
    QDomText english = doc.createTextNode("Art is long, life is short");
    doc.appendChild(root);
    root.appendChild(quote);
    root.appendChild(translation);
    ...
    return root;
} 
```

# java - 如何将带有 utf-8 名称的 zip 条目添加到 zip

> ID：15519493
> 
> 赞同：7
> 
> 时间：2013-03-20T09:19:09.153
> 
> 标签：java, zip

我有一个将 inputStream 作为条目添加到 zip 的方法：

```
private void addToZip(InputStream is, String filename) throws Exception {
    try {
        ZipEntry zipEntry = new ZipEntry(filename);
        zos.putNextEntry(zipEntry);
        byte[] bytes = new byte[1024];
        int length;
        while ((length = is.read(bytes)) >= 0) {
            zos.write(bytes, 0, length);
        }
        zos.closeEntry();
    } finally {
        IOUtils.closeQuietly(is);
    }
} 
```

当文件名包含像 áé 这样的 UTF-8 字符时会`?????`出现`N├бstroje`问题`Nástroje`...

对于这个例子，我使用了 jdk6，但现在我也尝试了 jdk7：

```
zos = new ZipOutputStream(fos, Charset.forName("UTF-8")); 
```

但没有成功。

我还尝试了 Apache Commons Zip 并设置了编码，但也没有成功。

那么如何将文件名中带有 unicode 符号的文件添加到 zip 中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T12:01:16.497

似乎这条线解决了我的问题：

```
 zos.setCreateUnicodeExtraFields(UnicodeExtraFieldPolicy.ALWAYS); 
```

有人可以解释一下这是在做什么以及为什么有效吗？

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T10:38:22.333

默认情况下，Zip 存档使用 DOS(OEM) 代码页来存储文件名。Linux/unix 实现在解包时使用系统代码页。Mac OS 默认使用 utf-8。因此，在您的情况下，文件名已正确存储，但 Linux 存档器不理解它。

# c# - MVC WebGrid 条件连接 Htlm.ActionLink

> ID：15519507
> 
> 赞同：0
> 
> 时间：2013-03-20T09:19:34.130
> 
> 标签：c#, asp.net-mvc-4, webgrid, html.actionlink

我正在尝试在 WebGrid 的条件列中连接 2 Html.ActionLink。类似的东西：

```
@grid.GetHtml(columns:grid.Columns(
   grid.Column("AccountNumber"),
   grid.Column("ContractNumber"),
   grid.Column("DisplayName"),
   grid.Column("IsFinalized"," ",format:(item) => (item.IsFinalized == true) 
     ?@<text> @Html.ActionLink("Edit", "Edit", new { accountId = item.AccountNumber}) | @Html.ActionLink("Details", "Details", new { accountId = item.AccountNumber }) </text>
     :@<text> @Html.ActionLink("Validate", "Validate", new { accountId = item.AccountNumber} | @Html.ActionLink("Details", "Details", new { accountId = item.AccountNumber }))</text>)
)) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T09:11:07.333

如果使用以下方法找到解决方案：

```
 new HtmlString() 
```

所以这：

```
grid.Column("IsFinalized"," ",format:(item) => (item.IsFinalized == true) 
     ?@<text> @Html.ActionLink("Edit", "Edit", new { accountId = item.AccountNumber}) | @Html.ActionLink("Details", "Details", new { accountId = item.AccountNumber }) </text>
     :@<text> @Html.ActionLink("Validate", "Validate", new { accountId = item.AccountNumber} | @Html.ActionLink("Details", "Details", new { accountId = item.AccountNumber }))</text>) 
```

给出：

```
grid.Column("IsFinalized", " ", format: item => (item.IsFinalized == true)
    ? new HtmlString( Html.ActionLink("Edit", "Edit", new { accountId = item.AccountNumber }).ToString() + "|" + Html.ActionLink("Details", "Details", new { accountId = item.AccountNumber }).ToString())
    : new HtmlString( Html.ActionLink("Validate", "Validate", new { accountId = item.AccountNumber }).ToString() + "|" + Html.ActionLink("Details", "Details", new { accountId = item.AccountNumber }).ToString()) 
```

# ruby - 收集有条件的哈希

> ID：15519509
> 
> 赞同：0
> 
> 时间：2013-03-20T09:19:38.593
> 
> 标签：ruby, ruby-on-rails-3, ruby-on-rails-3.2

模型：project.rb

```
def groups_by_role
    member_principals.find(:all, :include => [:principal, :roles]).inject({}) do |h, m|
      m.roles.each do |r|
        h[r] ||= []
        h[r] << m.principal
      end
      h
    end
  end 
```

控制器：projects_controller.rb

`@groups_by_role = @project.groups_by_role`

浏览量：members_index.html.rb

```
<% if @groups_by_role.any? %>
<div class="members box">
    <h3><%= l(:label_member_plural)%></h3>
    <p>
        <% @groups_by_role.keys.sort.each do |role| %>
        <%= h role %>: <%= @groups_by_role[role].sort.collect{|u| u}.join(", ").html_safe %>
        <br />
        <% end %>
    </p>
</div>
<% end %> 
```

我有一个模型，它有一个方法 group_by_role 可以找到所有角色和主体。这里主体定义了属于特定角色的用户和组。此方法是 project.rb 的一部分。

稍后，我在控制器中为项目定义相同的方法，并将其分配给实例变量以供视图使用，即@groups_by_role。

最后，收集和显示特定用户和组的角色。

特定@project 的控制台输出如下所示：@groups_by_role

```
{#<Role id: 18, name: "Project Manager", permissions: [:add_project, :edit_project, :close_project], issues_visibility: "all">=>[#<User id: 11, login: "test1", firstname: "Test", lastname: "T", type: "User">], 

#<Role id: 26, name: "Readers", permissions: [:view_documents, :view_files], issues_visibility: "default">=>[#<Group id: 835, login: "", firstname: "", lastname: "AA", type: "Group">, #<User id: 107, login: "testab", firstname: "Tommy", lastname: "Ab", type: "User">, #<User id: 111, login: "testxyz", hashed_password: "", firstname: "test", lastname: "xyz", type: "User">]} 
```

@groups_by_role.class = 哈希

**问题：**现在我得到一个角色和相应用户或组的输出。但我想在这里更改显示。如果哈希只包含没有任何组的用户，那么我只显示用户。因此对于这个输出`{#<Role id: 18, name: "Project Manager", permissions: [:add_project, :edit_project, :close_project], issues_visibility: "all">=>[#<User id: 11, login: "test1", firstname: "Test", lastname: "T", type: "User">],` ，因为它只有用户，所以我显示用户。这很好用，因为它只有用户但没有组......

**但是如果哈希中同时存在用户和组，那么我只显示组名而不显示用户**。目前它显示用户和组，如本例所示：`#<Role id: 26, name: "Readers", permissions: [:view_documents, :view_files], issues_visibility: "default">=>[#<Group id: 835, login: "", firstname: "", lastname: "AA", *type: "Group"*>, #<User id: 107, login: "testab", firstname: "Tommy", lastname: "Ab", *type: "User"*>, #<User id: 111, login: "testxyz", hashed_password: "", firstname: "test", lastname: "xyz", type: "User">]}`

有没有办法在视图或控制器中传递条件并检查哈希是否同时返回用户和组，然后只需要显示组。有人可以帮助我吗？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:40:28.673

我希望我能正确理解你。

创建一个辅助方法（用于控制器），它将返回如下字符串：

```
def print_principals(principals)
  if principals.index {|p| p.is_a? Group }
    principals = principals.reject{|u| u.is_a? User }
  end
  # WARNING!!! You should apply html_safe only if you're sure that it 
  # is actually safe, i.e. not input by user. Otherwise consider escaping it.
  principals.sort.collect{|u| u}.join(", ").html_safe 
end 
```

在您看来： `<%= h role %>: <%= print_principals @groups_by_role[role] %>`

# python - Python：将数据发送到 socket.io

> ID：15519514
> 
> 赞同：0
> 
> 时间：2013-03-20T09:19:58.357
> 
> 标签：python, connection, socket.io

现在我创建了一个 node.js 服务器，并将其与 php 页面链接，它工作正常。所以现在 Python 可以向 socket.io 服务器发送 socket.io 信号（当然还有数据），而 Python 是游戏程序，它将传输当前的游戏统计数据，而 Python 不会从 Socket 接收任何数据。 io服务器。

所以将建立的连接有点像这样：Python (game) -> Socket.io <-> Client

消息/信号 Python 将发送到服务器 (JSON): {name: 'stats', user: 'username': .... }

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-26T21:51:36.163

如果你想使用 Python 与 socket.io 服务器通信，你可以使用[socketIO-client](https://pypi.python.org/pypi/socketIO-client)。

```
from socketIO_client import SocketIO

def on_bbb_response(*args):
    print 'on_bbb_response', args

with SocketIO('localhost', 8000) as socketIO:
    socketIO.emit('bbb', {'xxx': 'yyy'}, on_bbb_response)
    socketIO.wait_for_callbacks(seconds=1) 
```

# asp.net-mvc-4 - HttpHandler 并不总是为 MVC 4 Web API 应用程序触发

> ID：15519516
> 
> 赞同：0
> 
> 时间：2013-03-20T09:20:01.533
> 
> 标签：asp.net-mvc-4, asp.net-web-api, httphandler

我正在尝试编写一个自定义 IHttpHandler 来验证调用 ASP.NET Web API 应用程序的用户：

```
public class AuthenticationHandler : IHttpHandler
{
    public bool IsReusable
    {
        get { return false; }
    }

    public void ProcessRequest(HttpContext context)
    {
        var id = context.Request.QueryString["id"];

        if (String.IsNullOrWhiteSpace(id))
        {
            return;
        }

        var key = context.Request.QueryString["key"];
        if (String.IsNullOrWhiteSpace(key))
        {
            return;
        }

        using (var db = new DataContext())))
        { 
            var client = db.Clients.FirstOrDefault(x => x.ApiId == id);
            if (client == null)
            {
                return;
            }
            if (!client.ApiKeys.Any(x => x.Key == key))
            {
                return;
            }

            context.User = new ApiPrincipal
            {
                Identity = new ApiIdentity
                {
                    IsAuthenticated = true,
                    Name = client.Name,
                    ClientId = client.Id
                }
            };

            Thread.CurrentPrincipal = context.User;
        }
    }
} 
```

我的 Web.config 部分如下所示：

```
<system.webServer>
 <validation validateIntegratedModeConfiguration="false" />
 <handlers>
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" />
  <remove name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" />
  <remove name="ExtensionlessUrlHandler-Integrated-4.0" />
  <add name="AuthenticationHandler" path="*" verb="*" type="AuthenticationHandler" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_32bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness32" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-ISAPI-4.0_64bit" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" modules="IsapiModule" scriptProcessor="%windir%\Microsoft.NET\Framework64\v4.0.30319\aspnet_isapi.dll" preCondition="classicMode,runtimeVersionv4.0,bitness64" responseBufferLimit="0" />
  <add name="ExtensionlessUrlHandler-Integrated-4.0" path="*." verb="GET,HEAD,POST,DEBUG,PUT,DELETE,PATCH,OPTIONS" type="System.Web.Handlers.TransferRequestHandler" preCondition="integratedMode,runtimeVersionv4.0" />
</handlers>
</system.webServer> 
```

AuthenticationHandler 是我的自定义处理程序。它确实可以在根页面上工作，即[http://example.com/](http://example.com/)，但不能在其他页面上工作。如果指定了任何路由，即[http://example.com/MyApiController](http://example.com/MyApiController)，则永远不会运行 ProcessRequest。

感谢您的关注！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T12:36:23.893

可能您应该在 Views 文件夹的“内部”Web.config 中注册处理程序。它看起来像这样：

```
<system.web>
    <httpHandlers>
      <add path="*" verb="*" type="System.Web.HttpNotFoundHandler"/>
    </httpHandlers> 
```

# mysql - 通过为非空字段提供空值进行分组

> ID：15519521
> 
> 赞同：0
> 
> 时间：2013-03-20T09:20:20.180
> 
> 标签：mysql, sql, greatest-n-per-group

我有一张如下表

```
id name tid seq aname ds
1  a     xy  10  G     E
1  a     xz  20  G     E
1  a     az  30  G     E
1  b     wq  10  G     E
1  b     as  20  G     E
2  c     qw  10  G     E
2  c     sd  20  G     E  
1  a     fg  34  S     F 
```

现在我想要o/p如下

```
id name tid seq  
1  a    az  30

1  b    as  20       
2  c    sd  20 
```

我的查询如下

```
select id,name,tid,max(seq) 
from table 
group by id,name where aname='G' and ds='E'; 
```

但是我在 tid 字段中得到空值。我哪里出错了？请帮助。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:22:22.457

这样做的一种方法是使用一个子查询，该子查询`seq`为每组`ID`和获取最大值`Name`。然后，子查询的结果将连接回表本身，前提是它在三列上匹配：`ID`、`Name`和`seq`, 为您提供正确的 值`tid`。

```
SELECT  a.*
FROM    tableName a
        INNER JOIN
        (
            SELECT  id, name, max(seq) max_seq
            FROM    tableName
            GROUP   BY ID,name 
        ) b ON a.ID = b.ID AND
                a.seq = b.max_seq AND
                a.name = b.name 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/bc36d/3)

输出

```
╔════╦══════╦═════╦═════╗
║ ID ║ NAME ║ TID ║ SEQ ║
╠════╬══════╬═════╬═════╣
║  1 ║ a    ║ az  ║  30 ║
║  1 ║ b    ║ as  ║  20 ║
║  2 ║ c    ║ sd  ║  20 ║
╚════╩══════╩═════╩═════╝ 
```

# mysql - MYSQL 子查询还是左连接？

> ID：15519522
> 
> 赞同：0
> 
> 时间：2013-03-20T09:20:24.927
> 
> 标签：mysql, subquery, left-join

我正在制作一个小发票申请，但我一直在查询以获取我的发票的总未结金额。

一点解释：

我在数据库中有 2 个表，`invoices`它们`payments`与 column 相关`invoice_id`。一张发票可以进行多次付款。

我想要得到的是所有发票的总未结金额。

这是我尝试过的，但它不起作用。

total_paid 金额不正确，它是最后一张发票的总和，而不是所有发票的总和。

```
SELECT
  COUNT( * ) AS count,
  SUM( invoice_amount_total ) AS total,
  (SELECT
     SUM( amount ) AS total
   FROM `invoice_payments`
   WHERE `invoice_id` = s.id) AS total_paid
FROM sales_invoices AS s
WHERE s.administration_id = 3
    AND (`invoice_amount_total` <> (SELECT
                      SUM( `amount` ) AS sum
                    FROM `invoice_payments`
                    WHERE `invoice_id` = s.id)
      OR (SELECT
        SUM( amount ) AS sum
          FROM `invoice_payments`
          WHERE `invoice_id` = s.id)IS NULL) 
```

有任何想法吗？

# performance - 在 MongoDB 中预填充数组的正确方法是什么？

> ID：15519525
> 
> 赞同：1
> 
> 时间：2013-03-20T09:20:29.363
> 
> 标签：performance, mongodb

MongoDB 文档说增长数组很慢，应该尽可能减少或消除它。我有一组子文档（假设这些是对博客文章的评论）：

```
comments = [ {name : "E.D.", date : "2013.03.20", text : "awesome stuff!"},
             {name : "J.L.", date : "2013.03.21", text : "tl;dr"} ] 
```

并且它会以可预测的方式增长，所以我认为应该从一开始就预先填充它以提高效率。但是我是否需要自己创建子文档：

```
### I Version
comments = [ { },
             { } ] 
```

还是只用零初始化数组就足够了？

```
### II Version
comments = [ 0,
             0 ] 
```

（当然，我应该跟踪访问者实际留下了多少评论。）

“评论”的大小可以达到几 KB，这对文档增长有影响吗？也许我应该创建与最大允许文本大小相同的占位符？

```
### III Version
comments = [ {name : "Name Surname", date : "1970.01.01", text : "this is a placeholder"},
             {name : "Name Surname", date : "1970.01.01", text : "this is a placeholder"} ] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:25:28.827

用空哈希或零预先填充没有意义：当您插入真实数据时，文档将展开。

你的第三个版本看起来更像它。尽管在插入真实评论时清除虚拟数据似乎并非易事。

您也可以将足够大的文本块插入一个特殊字段，然后在插入评论时将其删除。像这样的东西：

```
db.posts.insert({
  comments: [],
  padding: 'lorep ipsum ... x N'
})

db.posts.update(query, 
                {$push: {comments: comment_data},
                 $unset: padding}) 
```

# javascript - 香草 JavaScript 在正文上设置样式

> ID：15519527
> 
> 赞同：47
> 
> 时间：2013-03-20T09:20:33.113
> 
> 标签：javascript

为什么这不起作用？

使用 vanilla JavaScript 设置 body 标签的样式？

```
<html>
   <body style="display:none;">
       test
   </body>
   <script>
       document.getElementsByTagName("body").style.display = "block";
   </script>
</html> 
```

* * *

## 回答 #1

> 赞同：92
> 
> 时间：2013-03-20T09:21:01.573

因为[`getElementsByTagName()`](https://developer.mozilla.org/en-US/docs/DOM/document.getElementsByTagName)返回[NodeList](https://developer.mozilla.org/en-US/docs/DOM/NodeList)，而不是单个元素。将其视为数组：

```
document.getElementsByTagName("body")[0].style.display = "block"; 
```

在以下情况下甚至更简单`body`：

```
document.body.style.display = "block"; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-20T09:27:04.167

如果你想要`body`标签，你可以简单地使用`document.body`. 请参阅演示。

```
console.time("show body");
document.body.style.display = "none";

setTimeout(function () {
    console.timeEnd("show body");
    document.body.style.display = "block";
}, 3000);
```

```
<h1>Hello World!</h1>
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-12-04T17:52:57.903

我使用了以下解决方案：

```
<script>
    function changeDisplay(){
        document.body.style.display = 'block';
    }

    setTimeout(function () { changeDisplay(); }, 0);
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-03-13T03:06:55.827

while`body`是文档本身的一部分，您不必调用 getElementBy...，您只需直接说`document.body.style.display = "block";`

# ruby-on-rails-3 - 基于数据库的排队邮件 rails 3

> ID：15519528
> 
> 赞同：0
> 
> 时间：2013-03-20T09:20:32.927
> 
> 标签：ruby-on-rails-3, email, gem, message-queue

这可能是一个非常简单且不必要的问题，但我正在努力。

从 Rails 3 开始，世界似乎已经完成了 queued_mails 结构。我需要一个编写 rails 3 的 gem，它拦截 MyMailer 的传递方法，将邮件排队到 db 中，并要求我们运行 rake 以使所有邮件出列并发送。

它也很容易制作，但我不想付出努力，因为很难相信 Rails 3+ 没有。

建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-12-31T12:09:05.127

```
instead of using gem messages-queue
create simple mailer 

pls check railscasts.com/episodes/171-delayed-job
script/plugin install git://github.com/collectiveidea/delayed_job.git
script/generate delayed_job
rake db:migrate
rake jobs:work

mailings_controller.rb 
mailing = Mailing.find(mailing_id)
mailing.send_later(:deliver)

# or
 Delayed::Job.enqueue(MailingJob.new(params[:id]), -3, 3.days.from_now)

 lib/mailing_job.rb 

class MailingJob < Struct.new(:mailing_id)
   def perform
   mailing = Mailing.find(mailing_id)
   mailing.deliver
 end 
```

结尾

# excel - 将 sumif 公式从 excel 转换为宏 vba - Prolem 2：转换单元格范围

> ID：15519532
> 
> 赞同：1
> 
> 时间：2013-03-20T09:20:53.917
> 
> 标签：excel, formula

当我在下面运行代码时

```
Sub test2() Dim i, 
Rownumber As Integer 
Rownumber = Sheets("Sheet4").Range("A65536").End(xlUp).Row

    For i = 2 To Rownumber

            Sheets("Sheet4").Cells(i, 3).Formula = "=sumif(Sheet3!$A$2:$A$10, Sheet4!A2, Sheet3!$B$2:$B$10)"

        Next i
         End Sub 
```

宏运行良好，但是当我将其转换为宏 VBA 时：

```
Sub test2()
Dim i, Rownumber As Integer
Rownumber = Sheets("Sheet4").Range("A65536").End(xlUp).Row

For i = 2 To Rownumber

        Sheets("Sheet4").Cells(i, 3).Value = Application.WorksheetFunction.SumIfs(Sheets("Sheet3").Range("A2:A10"), Sheets("Sheet4").Cells(2, 1), Sheets("Sheet3").Range("B2:B10"))

    Next i

End Sub 
```

它给了我错误->**运行类型错误13，类型不匹配**

任何线索为什么会发生这种情况以及如何解决？--***封闭式***

谢谢

***问题二***

下面的代码在执行时运行良好：

```
 For j = 3 To Colnumber

            For i = 2 To Rownumber
            Sheets("Sheet2").Cells(i, j).Value = Application.WorksheetFunction.SumIfs(Sheets("3G").**Range("F2:F6991")**, Sheets("3G").Range("E2:E6991"), Sheets("Sheet2").Cells(i, 1))

            Next i

        Next j 
```

但是为什么当我把它改成：

```
Sheets("Sheet2").Cells(i, j).Value = Application.WorksheetFunction.SumIfs(Sheets("3G").**Range(Cells(2, 6), Cells(6991, 6))**, Sheets("3G").Range("E2:E6991"), Sheets("Sheet2").Cells(i, 1)) 
```

它给了我错误：错误1004，应用程序定义或定义对象错误？？

TIA

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:32:02.953

`SumIf`不是`SumIfs`。参数的顺序不同，因此导致错误。

`SumIfs`从要汇总的范围（多单元格范围）开始，然后是成对的条件范围（多单元格范围）和条件（单个单元格）。

`SumIf`从条件范围开始，然后是条件（单个单元格），然后是要汇总的范围（多单元格范围）。

通过相应地交换参数的顺序或使用其他函数（`SumIf`不是`SumIfs`）来修复它

# ios - 尝试在 iPhone iOS 6.1.2 上测试我的应用程序但“没有配置的 iOS 设备...”错误？

> ID：15519541
> 
> 赞同：1
> 
> 时间：2013-03-20T09:21:25.657
> 
> 标签：ios, xcode, version, device, provisioning

我有一个大问题。我有一部装有 iOS 6.1.2 和最新版本 Xcode - 4.6.1 的 iPhone。当我尝试在该设备上测试我的应用程序时，Xcode 说

> “没有提供兼容 iOS 版本的预置 iOS 设备。将 iOS 设备与最新版本的 iOS 连接以运行您的应用程序或选择 iOS 模拟器作为目标。”

问题出在哪里以及如何解决？我尝试进入管理器，右键单击设备并将设备添加到配置文件，但没有结果。提前致谢！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-20T09:28:42.870

你试试这些方法：-

*   尝试在 Xcode Organizer 中单击您设备上的“用于开发”。
*   愚蠢但试试这个也关闭和重新打开xcode。

我想这些会帮助你..

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:28:18.830

试试这个我不确定：选择你的项目 Target->summery 下选择一些低部署目标，如 5.0 。
看看它是否工作。

# android - Android SDK 管理器在 Windows 8 64 位上失败

> ID：15519542
> 
> 赞同：1
> 
> 时间：2013-03-20T09:21:27.177
> 
> 标签：android, windows-8, eclipse-plugin, 64-bit

在 Eclipse 中安装 Android SDK 期间 - 一切都很好。当试图从菜单打开 Android SDK 管理器时 - 它失败了。试图直接从文件夹启动程序。它再次失败。

```
[2013-03-20 10:47:42 - SDK Manager] [SDK Manager] 'D:\Android' is not recognized as an internal or external command,
[2013-03-20 10:47:42 - SDK Manager] [SDK Manager] operable program or batch file. 
```

我已经阅读了很多关于 Windows 中设置的环境路径的 syggestions，但 Eclipse itefl 工作正常，所以这不是我的情况。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:21:27.177

我们都习惯使用带有空格的文件夹名称。我的情况：

```
"d:\Android stuff" 
```

所有其他产品都可以正常使用此类文件夹名称。WindowsXP 中也有 Eclipse+Android。但在 Windows8 64 位 - Google SDK 拒绝使用这些名称。将文件夹重命名为“

```
"d:\Androidstuff" 
```

一切正常。

可能我们生活在 21 世纪，但 Google 开发人员生活在 19 世纪。

**更新** 事实上，android 开发团队在下一个版本中修复了这个问题。:)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-20T10:21:32.690

是的，我今天也遇到了同样的问题，这些错误是因为 Android SDK 不支持文件夹名称中的空格。JDK 和 Android SDK 必须安装在没有空格的文件夹中。

C:\Java\jdk1.6.0_45 **是**

C:\Program Files(x86)\Java\jdk1.6.0_45 **否**

# sql - 如何更新我的列 Value=Value+1 ？

> ID：15519546
> 
> 赞同：0
> 
> 时间：2013-03-20T09:21:37.917
> 
> 标签：sql, sql-server

我想更新`test1`表中的一些行。`ColumnB`必须是 10 11,12,13,14 .... 但是我的桌子

例如：

ColumnA 是父节点。ColumnA+ColumnB 是主键。例如 ColumnA 是 CustomerNumber。B 列是客户的订单号。

```
create table test1(ColumnA int,  ColumnB int,  ColumnC int);
Insert Into test1 Values(1, 9,123);
Insert Into test1 Values(1, 10,0);
Insert Into test1 Values(1, 10,0);
Insert Into test1 Values(1, 10,0);
Insert Into test1 Values(1, 10,0);
Insert Into test1 Values(2, 12,128);
Insert Into test1 Values(2, 12,0);
Insert Into test1 Values(3, 11,145);
Insert Into test1 Values(3, 11,0); 
```

不应该这样：

![在此处输入图像描述](../Images/369664d6a49be6f149b024063d4720b4.png)

应该是这样的：

![在此处输入图像描述](../Images/0d89983075e7bade63f815740736a9e5.png)

我不工作的代码：

```
 update a set a.ColumnB=a.ColumnB+1
from test1 a 
inner join test1 b
on b.ColumnA=a.ColumnA
and a.ColumnC=0;
select * from test1; 
```

我怎样才能做到这一点？如何将我的第一个表更新为第二个表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:30:32.747

请试试：

```
with T as(
select 
    row_number() over (partition by ColumnA order by ColumnA) Rnum, 
    min(ColumnB) over (partition by ColumnA) MinVal, 
    * 
From test1
) update T set ColumnB=MinVal+(Rnum-1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:38:20.243

试试这个：

```
WITH CTE
AS
(
  SELECT *,
    ROW_NUMBER() OVER(PARTITION BY ColumnA
                      ORDER BY ColumnB) AS RN
  FROM test1
)
UPDATE t 
SET t.ColumnB = CASE 
                  WHEN RN = 1 THEN ColumnB 
                  ELSE ColumnB + RN - 1 
                END  
FROM CTE AS t; 
```

## [SQL 小提琴演示](http://www.sqlfiddle.com/#!3/9e92a/1)

# java - 推土机映射：不止一个来源到目的地

> ID：15519547
> 
> 赞同：4
> 
> 时间：2013-03-20T09:21:39.477
> 
> 标签：java, dozer

我是推土机映射的新手

我们可以将多个源类的属性映射到目标吗？

例如

```
class A {
          int a;
          int b;
}

class B {
    String c;
}

class Destination {
    int a;
    int b;
    String c;
} 
```

可以用一个映射配置文件来做到这一点吗？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-09-25T12:32:29.320

你可以映射两次。首先，使用 Destination.class 作为目标，然后使用从第一个映射产生的 Object 作为目标：

```
 One one = new One();
    one.setA(1);
    one.setB(2);

    Two two = new Two();
    two.setC("3");

    Mapper mapper = DozerBeanMapperSingletonWrapper.getInstance();

    Destination destination = mapper.map(one, Destination.class);

    mapper.map(two, destination);

    System.out.println(destination);
    // Destination [a=1, b=2, c=3] 
```

这甚至适用于空映射配置文件。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T09:35:43.740

不是直接没有。您需要创建一个新类来包装您的两个源类并从中复制：

```
class D {
    private A a;
    private B b;
}

<mapping>
  <class-a>D</class-a>
  <class-b>C</class-b>
  <field>
    <a>a.a</a>
    <b>a</b>
  </field>
  <field>
    <a>a.b</a>
    <b>b</b>
  </field>
  <field>
    <a>b.c</a>
    <b>c</b>
  </field>
</mapping> 
```

或者，您需要复制两次，一次从每个源类复制到目标对象，确保不要空白现有字段。

```
<mapping wildcard="false">
    <class-a>A</class-a>
    <class-b>C/class-b>
    <field>
       <a>a</a>
       <b>a</b>
    </field>   
    <field>
       <a>b</a>
       <b>b</b>
    </field>   
</mapping>

<mapping wildcard="false">
    <class-a>B</class-a>
    <class-b>C/class-b>
    <field>
       <a>c</a>
       <b>c</b>
    </field> 
</mapping> 
```

# vb.net - 根据其他文本框更改文本框的值；

> ID：15519552
> 
> 赞同：0
> 
> 时间：2013-03-20T09:22:00.140
> 
> 标签：vb.net

我有 2 个文本框，我必须处理两者的 textchanged 事件。用户可以输入其中一个文本框，并根据用户输入的位置，另一个需要更改。为了防止它们进入无限循环，我在 c# 中得到了发件人，但我无法在 VB 中做到这一点。

```
 Private Sub TextBox1_TextChanged(sender As System.Object, e As System.EventArgs) Handles TextBox1.TextChanged
    If (sender Is TextBox1) Then
        txtmt.Text = Convert.ToDecimal(TextBox1.Text) * 0.9144
    End If

End Sub

Private Sub txtmt_TextChanged(sender As System.Object, e As System.EventArgs) Handles txtmt.TextChanged
    If (sender Is txtmt) Then
        TextBox1.Text = Convert.ToDecimal(TextBox1.Text) / 0.9144
    End If
End Sub 
```

我们如何在 VB 中做到这一点？并且还要避免空值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T11:27:27.673

> 为了防止它们进入无限循环，我在 c# 中获取了发送者

目前尚不清楚您的意思是什么。在任何情况下，你都可以在 VB 中做同样的事情。

实际上，比较 ​​在`sender`这里对您没有帮助，因为`sender`众所周知：因为`TextBox1_TextChanged`它*总是* `TextBox1`，并且因为`txtmt_TextChanged`它总是`txtmt`，除非您`*_TextChanged`在代码中的其他地方手动调用事件处理程序，并且您不应该这样做。

这里的问题如下：如果您更改`txtmt`in的内容`TextBox1_TextChanged`，该更改将引发`txtmt_TextChanged`，反之亦然。我们可以通过暂时解除事件处理程序、影响更改并重新挂钩来防止这种情况发生。

在 VB 中，这是通过`RemoveHandler`and完成`AddHandler`的（C# 中的等价物是使用`-=`and `+=`）。

代码上的另一个注释：**始终`Option Strict On`在 VB 中使用。**这可以实现更严格的类型检查。有一个广泛的共识是，该选项应该始终打开，并且没有不使用它的好借口（处理遗留 COM 互操作时除外）。您的代码无法使用`Option Strict`.

启用`Option Infer`.

有了这个，我们有以下解决方案：

```
Private Sub TextBox1_TextChanged(sender As Object, e As EventArgs)
    ' FIXME: Use proper error handling via TryParse in real code!
    Dim value = Double.Parse(TextBox1.Text)

    ' Prevent raising the event.
    RemoveHandler txtmt.TextChanged, AddressOf txtmt_TextChanged
    txtmt.Text = (value * 0.9144).ToString()
    AddHandler txtmt.TextChanged, AddressOf txtmt_TextChanged
End Sub

Private Sub txtmt_TextChanged(sender As Object, e As EventArgs)
    ' FIXME: Use proper error handling via TryParse in real code!
    Dim value = Double.Parse(txtmt.Text)

    ' Prevent raising the event.
    RemoveHandler TextBox1.TextChanged, AddressOf TextBox1_TextChanged
    TextBox1.Text = (value / 0.9144).ToString()
    AddHandler TextBox1.TextChanged, AddressOf TextBox1_TextChanged
End Sub 
```

请注意，为了使用`AddHandler`and `RemoveHandler`，我们不得不删除该`Handles`子句。这意味着您必须在`Form_Load`事件处理程序中手动连接这些事件：

```
AddHandler TextBox1.TextChanged, AddressOf TextBox1_TextChanged
AddHandler textmt.TextChanged, AddressOf textmt_TextChanged 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T09:39:44.657

use `If not (sender is nothing) andalso Ctype(sender,textbox).name=textbox1.name Then`

Instead of `If (sender Is TextBox1) Then`

# c# - 可以改变 NHibernate 的格式制定绑定变量吗？

> ID：15519554
> 
> 赞同：2
> 
> 时间：2013-03-20T09:22:03.870
> 
> 标签：c#, nhibernate, format, oledb, sqlbase

我正在研究一个遗留的 SQLBase 数据库，并试图用 NHibernate 建立一个新项目。

一个大问题是 SQLBase 期望 SQL 中的绑定变量的格式。格式必须明确

```
INSERT INTO ... VALUES (:1,:2,:3); 
SELECT ... FROM TABLE WHERE ID=:1 AND NAME=:2; 
```

现在 NHibernate 对绑定变量使用“:p0,:p1,...”格式，这会在 SQLBase 中给出“无效的程序绑定变量”SQL 异常。

问题是数字前的“p”，而且参数从 0 开始 - SQLBase 必须有以 1 开始的参数。

有什么方法可以配置/更改 NHibernate 以删除绑定变量中的“p”，并以 1 而不是 0 开头？我能够在我的类映射中使用 sql-insert、sql-update 和 sql-delete 映射更改 INSERT、UPDATE 和 DELETE 的参数格式，但我发现更改 SELECT 参数的唯一方法是编写大量命名查询到我的映射。

显然这不是首选方式。有没有更好的方法来改变绑定变量的生成方式？我已经制作了自己的驱动程序（继承自 OleDbDriver）和方言（继承自 GenericDialect）并更改了一些东西以使 SQLBase 能够正常工作。

我也试过设置

```
private static string ToParameterName(int index)
{
  return "p" + index;
} 
```

返回 String.Empty，但无济于事。但即使这会从参数中删除“p”前缀，我仍然会遇到它们从 0 而不是 1 开始的问题。

有没有机会改变这种行为或 NHibernate？

编辑：我现在还尝试更改其他一些参数函数：

```
string ISqlParameterFormatter.GetParameterName(int index)
        {
            int ret = index + 1;
            return (NamedPrefix + ret);
        }

        private void SetCommandParameters(IDbCommand cmd, SqlType[] sqlTypes)
        {
            for (int i = 0; i < sqlTypes.Length; i++)
            {
                int ret = i + 1;
                string paramName = ret.ToString();
                IDbDataParameter dbParam = GenerateParameter(cmd, paramName, sqlTypes[i]);
                cmd.Parameters.Add(dbParam);
            }
        }

        protected override void InitializeParameter(IDbDataParameter dbParam, string name, SqlType sqlType)
        {
            if (sqlType == null)
            {
                throw new QueryException(String.Format("No type assigned to parameter '{0}'", name));
            }
            name = name.Remove(0, 1);
            dbParam.ParameterName = (Int32.Parse(name) + 1).ToString();
            dbParam.DbType = sqlType.DbType;
        } 
```

通过这些更改，SQL 参数是“：1，：2”等等，但它也破坏了绑定 - 现在参数根本没有附加到查询中:(

Edit2：这是完整的驱动程序和方言代码：

```
namespace NHSQLBase
{
    public class SQLBaseDriver : OleDbDriver, ISqlParameterFormatter
    {
        public override bool UseNamedPrefixInSql
        {
            get
            {
                return true;
            }
        }

        public override bool UseNamedPrefixInParameter
        {
            get
            {
                return false;
            }
        }

        public override string NamedPrefix
        {
            get
            {
                return ":";
            }
        }

        private static string ToParameterName(int index)
        {
            return (index + 1).ToString();
        }

        string ISqlParameterFormatter.GetParameterName(int index)
        {
            int ret = index + 1;
            return (NamedPrefix + ret);
        }

        private void SetCommandParameters(IDbCommand cmd, SqlType[] sqlTypes)
        {
            for (int i = 0; i < sqlTypes.Length; i++)
            {
                int ret = i + 1;
                string paramName = ret.ToString();
                IDbDataParameter dbParam = GenerateParameter(cmd, paramName, sqlTypes[i]);
                cmd.Parameters.Add(dbParam);
            }
        }

        protected override void InitializeParameter(IDbDataParameter dbParam, string name, SqlType sqlType)
        {
            if (sqlType == null)
            {
                throw new QueryException(String.Format("No type assigned to parameter '{0}'", name));
            }
            name = name.Remove(0, 1);
            dbParam.ParameterName = (Int32.Parse(name) + 1).ToString();
            dbParam.DbType = sqlType.DbType;
        }
    }

    public class SQLBaseDialect : GenericDialect
    {
        public override string ForUpdateString
        {
            get
            {
                return " ";
            }
        }

        public override bool ForUpdateOfColumns
        {
            get
            {
                return true;
            }
        }

        public override string GetForUpdateString(string aliases)
        {
            return " for update of " + aliases;
        }

        public override bool SupportsOuterJoinForUpdate
        {
            get
            {
                return false;
            }
        }

        public override bool SupportsParametersInInsertSelect
        {
            get
            {
                return false;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-23T15:15:22.703

经过一番反复试验，我认为我已经找到了问题的根源。主要问题似乎是由`SQLBaseDriver`继承引起的`OleDbDriver`。一旦将其更改为`ReflectionBasedDriver`并且正确填充了构造函数，我就可以毫无问题地执行插入。

请参阅下面的驱动程序和方言的工作版本。

需要注意的一点是，用于 SQLBase 的 .Net 数据提供程序 dll、Gupta.SQLBase.Data.dll 必须与 NHibernate.dll 在同一文件夹中才能正常工作。

```
public class SQLBaseDriver : NHibernate.Driver.ReflectionBasedDriver
{
    public SQLBaseDriver()
        : base("Gupta.SQLBase.Data",
               "Gupta.SQLBase.Data.SQLBaseConnection",
               "Gupta.SQLBase.Data.SQLBaseCommand")
    {

    }
    public override bool UseNamedPrefixInSql
    {
        get { return true; }
    }

    public override bool UseNamedPrefixInParameter
    {
        get { return false; }
    }

    public override string NamedPrefix
    {
        get { return ":"; }
    }
} 
```

方言代码：

```
public class SQLBaseDialect : GenericDialect
{
    public override string ForUpdateString
    {
        get { return " "; }
    }

    public override bool ForUpdateOfColumns
    {
        get { return true; }
    }

    public override string GetForUpdateString(string aliases)
    {
        return " for update of " + aliases;
    }

    public override bool SupportsOuterJoinForUpdate
    {
        get { return false; }
    }

    public override bool SupportsParametersInInsertSelect
    {
        get { return false; }
    }
} 
```

# java - 运行时的eclipselink动态表

> ID：15519556
> 
> 赞同：0
> 
> 时间：2013-03-20T09:22:09.550
> 
> 标签：java, eclipselink

使用 eclipselink 2.0 如何为每个映射实体生成多个表？也就是说，有一个 POJO 来映射一个 Client，然后为每个新 Client 创建一组称为 X_clientId、Y_clientId、Z_clientId 的表（其中 X、Y、Z 是映射的实体）。并且表 X、Y、Z 对于每个客户端应该具有相同的结构。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T13:59:50.070

不确定我是否理解，也许澄清一下。你考虑过继承吗？您可以拥有 Client 的 X、Y、Z 子类。

您还可以查看 EclipseLink 多租户支持。

# wordpress - 获取所有子类别而不在 wordpress 中指定任何类别

> ID：15519561
> 
> 赞同：1
> 
> 时间：2013-03-20T09:22:32.667
> 
> 标签：wordpress, categories

我在 WordPress 中有 2 个级别（只有一个子类别。没有子子类别）类别。我需要获取所有没有父类别的子类别。我没有指定任何父类别。

例子：

```
p_cat1
   s_cat1
   s_cat2
p_cat4
p_cat3
   s_cat4
   s_cat5
   s_cat7 
```

从这里开始，我需要

```
s_cat1
s_cat2
s_cat4
s_cat5
s_cat7 
```

而且，我需要为此提供 URL。我想给每个子类别。

帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:48:10.080

you can try this one

```
<?php 

foreach(get_categories() as $cat) { 
   // echo '<li><a href="'.get_category_link($cat->term_id).'">'.$cat->name.'</a>';
    $sub_cats = get_categories('parent='.$cat->term_id.'&hide_empty=0');
    if($sub_cats) {

        foreach($sub_cats as $sub_cat) {

        }

    }
}

?> 
```

hope this will work for you

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-04-18T10:08:01.323

> 此代码可能有助于在不指定类别的情况下获取所有子类别

```
<?php global $wpdb;$prefix=$wpdb->prefix;

$subcateogyr_list=$wpdb->get_results("Select * from ".$prefix."term_taxonomy WHERE parent!='0'");

foreach($subcateogyr_list as $subcat){

    $subcat_name=$wpdb->get_var("select name from ".$prefix."wp_terms where term_taxonomy_id='$subcat['term_id']'");

}
?> 
```

# java - PUT操作的Android JSON api问题

> ID：15519564
> 
> 赞同：1
> 
> 时间：2013-03-20T09:22:44.047
> 
> 标签：java, android, json, asp.net-mvc-4

我有一个在 asp.net mvc 4 中制作的 web api，它公开了数据库的 CRUD 操作，并且我正在制作一个 android 应用程序来尝试和操作这些数据。

我面临的问题是在带有更新操作的 json 解析器中，该操作由 http PUT 请求（/api/products/id）公开

这是我正在使用的解析器，我从一个示例中获得，我修改了 POST 部分，以便它改为 PUT：

```
public class JSONParser {

static InputStream is = null;
static JSONObject jObj = null;
static JSONArray jArr = null;
static String json = "";

// constructor
public JSONParser() {

}

// function get json from url
    // by making HTTP POST or GET method
    public JSONObject makeHttpRequest(String url, String method,
            List<NameValuePair> params) {

        // Making HTTP request
        try {

            // check for request method
            if (method == "PUT") {
                DefaultHttpClient httpClient = new DefaultHttpClient();
                HttpPut httpPut = new HttpPut(url);
                httpPut.setEntity(new UrlEncodedFormEntity(params));

                HttpResponse httpResponse = httpClient.execute(httpPut);
                HttpEntity httpEntity = httpResponse.getEntity();
                is = httpEntity.getContent();
            }
            if(method == "POST"){
                // request method is POST
                // defaultHttpClient
                DefaultHttpClient httpClient = new DefaultHttpClient();
                HttpPost httpPost = new HttpPost(url);
                httpPost.setEntity(new UrlEncodedFormEntity(params));

                HttpResponse httpResponse = httpClient.execute(httpPost);
                HttpEntity httpEntity = httpResponse.getEntity();
                is = httpEntity.getContent();

            }else if(method == "GET"){
                // request method is GET
                DefaultHttpClient httpClient = new DefaultHttpClient();
                String paramString = URLEncodedUtils.format(params, "utf-8");
                url += "?" + paramString;
                HttpGet httpGet = new HttpGet(url);

                HttpResponse httpResponse = httpClient.execute(httpGet);
                HttpEntity httpEntity = httpResponse.getEntity();
                is = httpEntity.getContent();
            }           

        } catch (UnsupportedEncodingException e) {
            e.printStackTrace();
        } catch (ClientProtocolException e) {
            e.printStackTrace();
        } catch (IOException e) {
            e.printStackTrace();
        }

        try {
            BufferedReader reader = new BufferedReader(new InputStreamReader(
                    is, "iso-8859-1"), 8);
            StringBuilder sb = new StringBuilder();
            String line = null;
            while ((line = reader.readLine()) != null) {
                sb.append(line + "\n");
            }
            is.close();
            json = sb.toString();
        } catch (Exception e) {
            Log.e("Buffer Error", "Error converting result " + e.toString());
        }

        // try parse the string to a JSON object
        try {
            jObj = new JSONObject(json);
        } catch (JSONException e) {
            Log.e("JSON Parser", "Error parsing data " + e.toString());
        }

        // return JSON String
        return jObj;

    }
} 
```

当我尝试执行 PUT 操作时，记录会更新，但应用程序在尝试执行时因空指针异常而崩溃`is = httpEntity.getContent();`

我在试图弄清楚这到底有什么问题时遇到了问题，因为我找不到关于事情应该如何完成的详细解释，我所拥有的只是我设法找到的随机示例，没有一个超过 GET和 POST 操作。

作为参考，这是调用解析器的异步任务：

```
class SaveProductDetails extends AsyncTask<String, Void, String> {

    @Override
    protected String doInBackground(String... args) {
        String id = mTitleText.getText().toString();
        String desc = mBodyText.getText().toString();
        List<NameValuePair> params = new ArrayList<NameValuePair>();
        params.add(new BasicNameValuePair(KEY_ID, id));
        params.add(new BasicNameValuePair(KEY_DESC, desc));
        JSONParser parser = new JSONParser();
        JSONObject json = parser.makeHttpRequest(URL + id, "PUT", params);

        try {
            Integer success = json.getInt(TAG_SUCCESS);
            if (success == 1) {
                // successfully updated
                Intent i = getIntent();
                // send result code 100 to notify about product update
                setResult(100, i);
                finish();
            } else {
                // failed to update product
            }
        } catch (JSONException e) {
            e.printStackTrace();
        }

        return null;

    }
} 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:43:42.323

三件事（其中两件事更重要）。

首先**（重要）**，您需要在处理响应正文之前确定您的请求是否成功。鉴于您的代码结构，我建议在检索方法的开头声明一个状态代码变量，并在每个之后设置它`execute`：

```
HttpResponse httpResponse = httpClient.execute(httpPut);
status = httpResponse.getStatusLine().getStatusCode(); 
```

其次**（重要）**，您需要在调用任何方法之前检查您的响应实体是否为非空。`EntityUtils`总体而言，使用课程来处理您的回复会更好地为您服务。

```
httpEntity = httpResponse.getEntity(); // Declare httpentity outside your try/catch
is = httpEntity.getContent();          // Remove this line entirely 
```

然后，实体将按以下方式处理：

```
try {
    if(status == HttpStatus.SC_OK) {
        json = httpentity != null ?
            EntityUtils.toString(httpentity, "iso-8859-1") : null;
    } else {
        Log.e("Server responded with error status " + status);
    }
} catch (Exception e) {
    Log.e("Buffer Error", "Error converting result " + e.toString());
} 
```

最后**（非常重要）**，您应该删除解析器类中的所有静态变量，并将它们设为方法的局部变量。

# php - 我的 php 查询有什么问题吗？

> ID：15519565
> 
> 赞同：0
> 
> 时间：2013-03-20T09:22:45.733
> 
> 标签：php, sql

这是我的代码。

```
<?php

$a = bacon;
$b = 20;
$c = 30;

$link = mysql_connect('localhost','root',''); 
mysql_select_db("test", $link);

$sql = "UPDATE share SET price=".
         PrepSQL($b) . ", place=" .
         PrepSQL($c) . ", time=CURRENT_TIMESTAMP where num=1 and RID=(select IID from ingredient where Ingredient='" . PrepSQL($a) . "')";

mysql_query($sql);

function PrepSQL($value)
{
    // Stripslashes
    if(get_magic_quotes_gpc())
    {
        $value = stripslashes($value);
    }

    // Quote
    $value = "'" . mysql_real_escape_string($value) . "'";

    return($value);
}
?> 
```

我发现上面的代码不能更新数据库表。但是，如果我将 where 条件更改为 where num=1 和 RID=(select IID from ingredients where Ingredient= **'bacon'** )" 那么，一切正常。那么，我的代码有什么问题吗？非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:24:43.560

如果它应该是一个字符串，那么它需要引号。

```
$a = 'bacon'; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:25:45.010

你应该使用：

```
<?php

$a = "bacon";
$b = 20;
$c = 30;

$link = mysql_connect('localhost','root',''); 
mysql_select_db("test", $link);

$sql = "UPDATE share SET price=".
         PrepSQL($b) . ", place=" .
         PrepSQL($c) . ", time=CURRENT_TIMESTAMP where num=1 and RID=(select IID from ingredient where Ingredient='" . PrepSQL($a) . "')";

mysql_query($sql);

function PrepSQL($value)
{
    // Stripslashes
    if(get_magic_quotes_gpc())
    {
        $value = stripslashes($value);
    }

    // Quote
    $value = "'" . mysql_real_escape_string($value) . "'";

    return($value);
}
?> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:26:07.353

你的子查询

```
"[...] (select IID from ingredient where Ingredient='" . PrepSQL($a) . "')" 
```

真的应该

```
"[...] (select IID from ingredient where Ingredient=" . PrepSQL($a) . ")" 
```

因为调用`PrepSQL`已经为您添加了单引号。

另外，请避免使用`mysql_*`php 函数，因为它们现在已被弃用！有关更多选项，请参阅：[http ://www.php.net/manual/en/mysqlinfo.api.choosing.php](http://www.php.net/manual/en/mysqlinfo.api.choosing.php)

编辑：

另外，您应该有一个可能未定义的`bacon`常量`"bacon"`。

# google-maps - 如何使用 Google Map API 在两个城市之间获取地点

> ID：15519566
> 
> 赞同：0
> 
> 时间：2013-03-20T09:22:55.317
> 
> 标签：google-maps, google-maps-api-3

我正在做一个项目，我的任务是获取给定两个城市之间的总人数。例如，我输入“city1”和“city2”，我想获取 Oracle 公司的所有公司办公室及其完整地址。

当我使用谷歌地图 api 时，它只显示特定城市而不是两个城市之间。

任何人都对此有任何想法。请帮我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:29:24.863

首先，需要定义“之间”的实际含义。可能从 A 开始到 B 结束的具有一定宽度的走廊将是其结果。建立此定义后，您可以使用支持 GEO 查询的数据库来获取该区域内包含的所有地点条目。

谷歌地图 API 仅用于向用户显示数据并帮助选择城市。

有一个库可以帮助检测一个点在多边形内（你的走廊）的天气 [https://github.com/tparkin/Google-Maps-Point-in-Polygon](https://github.com/tparkin/Google-Maps-Point-in-Polygon) 这将是另一种获取城市之间点的方法在客户端。

# android - ViewPager 中只有第一张地图显示有多个 SupportMapFragment

> ID：15519569
> 
> 赞同：1
> 
> 时间：2013-03-20T09:22:59.310
> 
> 标签：android, android-viewpager, supportmapfragment

**背景**

我有一个带有三个片段的浏览器。所有片段都是使用自定义地图布局或列表视图的同一片段类的新实例，具体取决于应用程序设置。但问题仅在地图模式下。

**问题**

每次我在地图模式下启动 viewpager 活动时，只有当前片段显示地图。其他片段为空。看起来所有片段都使用地图的唯一实例。当前片段首先获取此地图。其他两个片段中的地图为空。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <include
            layout="@layout/loading_component"/>

    <FrameLayout
            android:id="@+id/mapFragmentHole"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:layout_alignParentBottom="true"
            android:layout_alignParentLeft="true"
            android:layout_alignParentRight="true"
            android:layout_alignParentTop="true"
            android:layout_gravity="center_vertical|center_horizontal" />

    <Button
            android:id="@+id/cur_location"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:background="@drawable/map_compas"
            android:layout_alignParentRight="true"/>
    <Button
            android:id="@+id/go_back"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content"
            android:layout_alignParentBottom="true"
            android:textColor="@color/gray_theatre"
            android:textSize="21sp"
            android:textStyle="bold"
            android:background="@drawable/go_to_list_button_bg"
            android:text="@string/return_to_list"
            android:layout_alignParentRight="true"
            android:visibility="gone"/>

</RelativeLayout> 
```

**SectionsPagerAdapter**

```
public class SectionsPagerAdapter extends FragmentPagerAdapter {

        public SectionsPagerAdapter(FragmentManager fm) {
            super(fm);
        }

        @Override
        public int getItemPosition(Object object) {
            return POSITION_NONE;
        }

        @Override
        public Fragment getItem(int i) {
            if (i == 0) {
                return CinemaAllFragment.newInstance(modeFavourite);
                //return new CinemaFavouriteFragment();

            }
            if (i == 1) {
                return CinemaAllFragment.newInstance(modeOnline);
            }
            if (i == 2) {
                return CinemaAllFragment.newInstance(modeDefault);
            }
            return null;
        }

        @Override
        public int getCount() {
            return 3;
        }

        @Override
        public CharSequence getPageTitle(int position) {
            switch (position) {
            case 0:
                return getString(R.string.frame_cinema_title1);
            case 1:
                return getString(R.string.frame_cinema_title2);
            case 2:
                return getString(R.string.frame_cinema_title4);
            }
            return null;
        }
    } 
```

**我的片段**

```
public class CinemaAllFragment extends CinemaFragment implements LocationListener {
private LocationManager locationManager;
private String provider;
private GoogleMap map = null;

private Marker myPosition;
private View balloon;

private Button curLocationBtn;

protected ListView listViewCinemas = null;
protected View view;

private String fragmentMode;
private static String MODE = "mode";
private static String modeFavourite = "modeFavourite";
private static String modeOnline = "modeOnline";
private static String modeDefault = "modeDefault";
private Cinema[] cinemas;
private Long updateTime;
private Long lastUpdate;

private CinemaListArrayAdapter adapter = null;

private static String FRAGMENT = "position";

private ArrayList<Marker> Markers;

private long nowTime;

// Handler to update UI timeFr, progress bar etc,.
private Handler mHandler = new Handler();
private Runnable onEveryFiveMinutes;

private SupportMapFragment supportMapFragment = null;

public static CinemaAllFragment newInstance(String someString)
{
    CinemaAllFragment myFragment = new CinemaAllFragment();
    Bundle args = new Bundle();
    args.putString(MODE, someString);
    myFragment.setArguments(args);

    return myFragment;
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
{
    super.onCreateView(inflater, container, savedInstanceState);

    if(getArguments()!=null)
        fragmentMode = getArguments().getString(MODE, null);

    if (Settings.getCinemaTypeView() == Settings.CinemaTypeView.Map)
    {
        mLog.d("OnCreate: map "+fragmentMode);

        view = inflater.inflate(R.layout.cinema_map, container, false);

        GoogleMapOptions gmo = (new GoogleMapOptions()).zoomControlsEnabled(true).rotateGesturesEnabled(false);

        if(supportMapFragment == null)
            supportMapFragment = SupportMapFragment.newInstance(gmo);

        FragmentTransaction fragmentTransaction = getActivity().getSupportFragmentManager().beginTransaction();
        fragmentTransaction.add(R.id.mapFragmentHole, supportMapFragment);
        fragmentTransaction.commit();

        balloon = inflater.inflate(R.layout.cinema_list_item, null);

        ImageView delimiter = (ImageView) balloon.findViewById(R.id.delimiter);
        delimiter.setVisibility(View.GONE);

    }
    else if (Settings.getCinemaTypeView() == Settings.CinemaTypeView.Listing)
    {
        view = inflater.inflate(R.layout.cinema_list, container, false);
    }

    return view;
}

@Override
public void onResume() {
    super.onResume();

    if (Settings.getCinemaTypeView() == Settings.CinemaTypeView.Map)
    {
        setUpMapIfNeeded();
    }

    onUpdate();
}

@Override
public void onDestroyView() {
    super.onDestroyView();
    if (Settings.getCinemaTypeView() == Settings.CinemaTypeView.Map)
    {
        FragmentTransaction ft = getActivity().getSupportFragmentManager().beginTransaction();
        ft.remove(supportMapFragment);
        ft.commit();
    }
}

@Override
public void onActivityCreated(Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    super.onActivityCreated(savedInstanceState);
}

class CustomInfoAdapter implements GoogleMap.InfoWindowAdapter {

    @Override
    public View getInfoContents(Marker marker) {
        displayView(marker);

        if(!marker.getTitle().equals("Я"))
        {
            return balloon;
        }
        else return null;
    }

    @Override
    public View getInfoWindow(Marker marker) {
        return null;
    }
}

public void displayView(Marker marker) {

    TextView cinema_title = (TextView) balloon.findViewById(R.id.cinema_title);

    Cinema cinema = MoviesDbAdapter.getCinemaById(marker.getTitle());

    if (cinema != null)
    {
        cinema_title.setText(cinema.title);
    }
}

public void checkGPSEnabled()
{
    // Get the location manager
    locationManager = (LocationManager) view.getContext().getApplicationContext().getSystemService(view.getContext().getApplicationContext().LOCATION_SERVICE);
    locationManager.requestLocationUpdates(LocationManager.GPS_PROVIDER/*provider*/, 0, 0, this);

    boolean enabled = locationManager
            .isProviderEnabled(LocationManager.GPS_PROVIDER);

    // Check if enabled and if not send user to the GSP settings
    // Better solution would be to display a dialog and suggesting to
    // go to the settings
    if (!enabled) {
        new AlertDialog.Builder(view.getContext().getApplicationContext())
                .setMessage(view.getContext().getApplicationContext().getResources().getString(R.string.message_gps_off))
                .setPositiveButton(view.getContext().getApplicationContext().getResources().getString(R.string.dialog_gps_enable), new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {
                        // TODO Auto-generated method stub
                        Intent intent = new Intent(android.provider.Settings.ACTION_LOCATION_SOURCE_SETTINGS);
                        startActivityForResult(intent, 5);
                    }
                })
                .setNegativeButton(view.getContext().getApplicationContext().getResources().getString(R.string.dialog_gps_cancel), new DialogInterface.OnClickListener() {

                    public void onClick(DialogInterface dialog, int which) {

                    }
                })
                .show();
    }

}
/* Request updates at startup */

@Override
public void onLocationChanged(Location location) {
    int lat = (int) (location.getLatitude());
    int lng = (int) (location.getLongitude());
}

@Override
public void onStatusChanged(String provider, int status, Bundle extras) {
    // TODO Auto-generated method stub

}

@Override
public void onProviderEnabled(String provider) {
    //getLocation();
}

@Override
public void onProviderDisabled(String provider) {
}

/**
 * Sets up the map if it is possible to do so (i.e., the Google Play services APK is correctly
 * installed) and the map has not already been instantiated.. This will ensure that we only ever
 * call {@link #setUpMap()} once when {@link #map} is not null.
 * <p>
 * If it isn't installed {@link SupportMapFragment} (and
 * {@link com.google.android.gms.maps.MapView
 * MapView}) will show a prompt for the user to install/update the Google Play services APK on
 * their device.
 * <p>
 * A user can return to this Activity after following the prompt and correctly
 * installing/updating/enabling the Google Play services. Since the Activity may not have been
 * completely destroyed during this process (it is likely that it would only be stopped or
 * paused), {@link #onCreate(Bundle)} may not be called again so we should call this method in
 * {@link #onResume()} to guarantee that it will be called.
 */
private void setUpMapIfNeeded() {
    // Do a null check to confirm that we have not already instantiated the map.
    if (map == null) {
        //map = (MapView) getActivity().findViewById(R.id.map);
        // Try to obtain the map from the SupportMapFragment.
        map = supportMapFragment.getMap();
        //map.setInfoWindowAdapter(new CustomInfoAdapter());

        // Check if we were successful in obtaining the map.
        if (map != null) {
            setUpMap();
        }
    }
}

private void getLocation()
{

    mLog.d("Touch: ");
    checkGPSEnabled();

    Location location = locationManager.getLastKnownLocation(LocationManager.GPS_PROVIDER/*provider*/);

    // Initialize the location fields
    if (location != null) {
        System.out.println("Provider " + provider + " has been selected.");
        CameraPosition cp = new CameraPosition.Builder()
                .target(new LatLng(location.getLatitude(),location.getLongitude()))
                .zoom(12)
                .build();
        map.animateCamera(CameraUpdateFactory.newCameraPosition(cp));

        if (myPosition != null)
        {
            myPosition.remove();
        }
        myPosition = map.addMarker(new MarkerOptions()
                .position(new LatLng(location.getLatitude(),location.getLongitude()))
                .title("Я")
                .icon(BitmapDescriptorFactory
                        .fromResource(R.drawable.map_marker_user)));
    }
}

/**
 * This is where we can add markers or lines, add listeners or move the camera. In this case, we
 * just add a marker near Africa.
 * <p>
 * This should only be called once and when we are sure that {@link #map} is not null.
 */
private void setUpMap() {
    map.setMyLocationEnabled(true);
    //map.getUiSettings().setMyLocationButtonEnabled(true);

    //map.addMarker(new MarkerOptions().position(new LatLng(0, 0)).title("Marker"));
}

public void onUpdate() {

    if(fragmentMode != null)
    {
        if(fragmentMode.equals(modeDefault)){
            cinemas = MoviesDbAdapter.getCinemaAll();
        }
        else if (fragmentMode.equals(modeFavourite))
        {
            cinemas = MoviesDbAdapter.getCinemaFavorites();
        }
        else if (fragmentMode.equals(modeOnline))
        {
            cinemas = MoviesDbAdapter.getCinemaOnline();
        }
        mLog.d("OnCreate: "+fragmentMode);
    }
    else
    {
        cinemas = MoviesDbAdapter.getCinemaAll();
    }

    adapter = new CinemaListArrayAdapter(getActivity(), R.layout.movies_list_item, cinemas);

    mLog.d("OnCreate: onUpdate "+fragmentMode);
    if(cinemas.length == 0)
    {
        // Load schedules
        //Utils.updateLoadingStatus(view, getString(R.string.message_loading_cinemas));
    }

    if (Settings.getCinemaTypeView() == Settings.CinemaTypeView.Map)
    {
        try
        {
            checkGPSEnabled();
        } catch (Exception e) {
            e.printStackTrace();  //To change body of catch statement use File | Settings | File Templates.
        }

        //ApiDownloader downloader = new ApiDownloader(getActivity().getApplicationContext());
        //downloader.registerAPI(getActivity().getApplicationContext());

        if (Markers != null)
        {
            for (Marker marker : Markers)
            {
                marker.remove();
            }
            Markers.clear();
        }

        Markers = new ArrayList<Marker>();

        if(map != null)
        {
            //нарисовать маркеры кинотеатров
            for (Cinema cinema : cinemas)
            {
                //mLog.d("Cinema: " + cinema.getLatitude());
                Marker cinemaMarker = map.addMarker(new MarkerOptions()
                        .position(new LatLng(Double.parseDouble(cinema.getLatitude()),Double.parseDouble(cinema.getLongitude())))
                        .title(cinema.getId().toString())
                        .icon(BitmapDescriptorFactory
                                .fromResource(R.drawable.map_marker_mini)));

                Markers.add(cinemaMarker);
            }
        }
    }
    else
    {
        //ApiDownloader downloader = new ApiDownloader(getActivity().getApplicationContext());
        //downloader.registerAPI(getActivity().getApplicationContext());

        listViewCinemas = (ListView) view.findViewById(R.id.cinemas_list_view);

        int index = 0;
        View v=null;
        if(listViewCinemas != null)
        {
            mLog.d("OnCreate: list not null "+fragmentMode+" "+cinemas.length);

            // save index and top position
            index = listViewCinemas.getFirstVisiblePosition();
            v = listViewCinemas.getChildAt(0);
            int top = (v == null) ? 0 : v.getTop();

            listViewCinemas.setAdapter(adapter);
            listViewCinemas.setSelectionFromTop(index, top);

            PauseOnScrollListener listener = new PauseOnScrollListener(imageLoader, pauseOnScroll, pauseOnFling);
            listViewCinemas.setOnScrollListener(listener);

        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-24T10:34:35.273

**解决问题**

只需将片段与地图功能分开，而不是在两个新片段中进行映射。新的地图片段从 SupportMapFragment 扩展而来，并允许他为 himlesf 创建视图：

```
public class CinemaMapFragment extends SupportMapFragment implements LocationListener { 
```

...

```
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)
{
    view = super.onCreateView(inflater, container, savedInstanceState);
    balloon = inflater.inflate(R.layout.cinema_list_item, null);
    return view;
} 
```

然后我以编程方式添加我的自定义功能（只有两个按钮）：

```
@Override
public void onResume() {
    super.onResume();

    LayoutInflater inflater = (LayoutInflater) getActivity().getApplicationContext().getSystemService(Context.LAYOUT_INFLATER_SERVICE);

    View vi = inflater.inflate(R.layout.location_button, null);
    View vi2 = inflater.inflate(R.layout.golist_button, null);

    curLocationBtn = (Button) vi.findViewById(R.id.cur_location);
    goToList = (Button) vi2.findViewById(R.id.go_back);

    LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(
            LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.WRAP_CONTENT);

    ((ViewGroup) view).addView(vi, layoutParams);

    LinearLayout.LayoutParams layoutParams2 = new LinearLayout.LayoutParams(
            LinearLayout.LayoutParams.FILL_PARENT, LinearLayout.LayoutParams.FILL_PARENT);

    ((ViewGroup) view).addView(vi2, layoutParams2); 
```

...

```
private void setUpMapIfNeeded() {
    // Do a null check to confirm that we have not already instantiated the map.
    if (map == null) {
        //map = (MapView) getActivity().findViewById(R.id.map);
        // Try to obtain the map from the SupportMapFragment.
        map = getMap();
        map.setInfoWindowAdapter(new CustomInfoAdapter());

        // Check if we were successful in obtaining the map.
        if (map != null) {
            setUpMap();
        }
    }
} 
```

# javascript - Web 应用程序构建，HTML 与 JavaScript

> ID：15519571
> 
> 赞同：1
> 
> 时间：2013-03-20T09:23:11.357
> 
> 标签：javascript, jquery, html

我目前正在开发一个 Web 应用程序。

现在我想知道在性能或其他方面构建页面有什么更好的。

第一个选项，直接在 HTML 文件中构建所有内容并隐藏 Objects () 以供以后使用，并让 JavaScript 在需要时显示/隐藏它们。

第二个选项，创建一个通过 JQuery 在运行时生成 HTML 的 JavaScript。

**编辑**

更具体一点。

这将是一个具有许多不同视图的 Web 应用程序。例如，首先您有登录视图，然后是概览视图、设置视图等。

所有请求，如登录、GetData 都将使用 AJAX JSON-RPC 请求进行管理。

如果我采用 HTML 方式，我将为每个视图创建一个 div-Block，它从一开始就没有显示。然后 JavaScript 将根据需要显示它们，并通过 AJAX 请求填写数据。

如果我采用 JavaScript 方式，JavaScript 会生成 HTML，而 Views 会被 JavaScript 取代。

我想这样做，因为我不希望用户重新加载每个站点。而且我不喜欢 PHP。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:29:06.830

如果可能的话，我会拥有页面上的所有元素，并根据需要使用 jQuery/CSS 显示/隐藏它们。在我看来，这是一种更直接、更简洁的方法，除非您需要一些非常动态的东西，即基于用户输入以新出现的形式显示特定**数据。**

此外，您应该记住，您已经在页面上拥有的内容作为 HTML 将**已经在页面上**，而需要等待页面加载**然后**触发 Javascript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:35:10.497

看到两者之间有一个权衡。

**可用性：**

如果数据很重要，而且在大多数情况下用户可能会对它感兴趣，那么最好用 HTML 加载它并通过 javascript 隐藏。该页面将更具响应性。如果用户想了解该数据的可能性很小，则执行 AJAX 加载。

**数据大小：**

此外，如果数据量非常大且非常复杂，通常涉及某种形式的媒体，那么请执行 AJAX。如果它是文本的，则通过 JS 将其隐藏。

**例子：**

*通过 JS 隐藏*

由 JS 剪辑的描述文本，当用户单击更多时，会显示完整的文本。可用性：用户永远不会读到一半的描述，他总是对整个故事感兴趣。数据的大小和复杂性较小。它只是一个文本。

*使用 AJAX*

在模态弹出窗口中打开的“在动作视频中观看”的链接。可用性：如果已经在文本和图像中解释了一个过程，那么用户也不太可能想要查看视频。如果他没有得到它，他将简单地离开页面。如果数据很大并且也很复杂，这里的大小。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:33:50.647

JavaScript 常用来玩 HTML 内容。用它来准备 HTML 不是一个好主意。当然我们不能忽略一些*情况*。

但是用 javascript 设计一个页面的整个 HTML 内容真的让我害怕。:)

# get - openssl s_client 在每次请求后失去连接

> ID：15519574
> 
> 赞同：1
> 
> 时间：2013-03-20T09:23:32.920
> 
> 标签：get, openssl, request, client, keep-alive

我正在玩 openssl s_client 和一个网络服务器，我想知道为什么我在发送每个 GET 请求后都会失去与服务器的连接：

握手工作正常：

```
openssl s_client -connect hostname:port
GET / HTTP/1.1
Host: hostname
Connection: keep-alive 
```

然后我收到应用服务器的响应：HTTP/1.1 200 OK

```
...more http here...
<html/>closed 
```

如您所见，连接已关闭，但是当我将连接标头用于保持活动状态时，连接不应该保持建立吗？我想测试 SSL 的重新协商功能，因此我需要能够在多个请求之间保持会话处于活动状态。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:38:00.000

您的服务器也必须回复`Connection: Keep-Alive`标头以建立保持连接。

更改您的服务器端配置以执行此操作。

但请注意keepalive 连接带来的性能问题，以及许多浏览器在特定超时后关闭连接的事实。

# android - 查看单个选项卡时定期更新数据（android）

> ID：15519575
> 
> 赞同：1
> 
> 时间：2013-03-20T09:23:33.160
> 
> 标签：android, handler

我对 Android 编程很陌生，我现在有一个小问题。

我正在构建一个应该定期从西门子 PLC 中的数据库获取数据的应用程序。对于不同的数据类型，我在选项卡视图中有不同的选项卡。现在，我尝试仅在选项卡处于活动状态时更新每个选项卡的特定数据。现在我使用 onTabChanged 方法更新它们，每次更改一次。这工作正常。

现在我尝试了几种定期更新的解决方案（比如[这个](https://stackoverflow.com/questions/14397973/how-to-read-continuous-data-and-display-it?lq=1)或[这个](https://stackoverflow.com/questions/5902600/how-to-execute-a-function-every-two-seconds-in-java-on-android)），但我无法让它工作。“最佳”解决方案是使用 wil(true) 语句，它使数据每 5 秒更新一次，但它没有更新 UI，也没有离开循环，除非我强制关闭应用程序。

就我得到正确答案而言，我的问题是，我想在我的主线程中更新 UI。我有一个从 PLC 读取数据的函数和一个将数据写入选项卡项目的函数。读取函数需要从“登录活动”作为 Intent 传递的类中的数据，因此我可以在调用 Intent 之前调用它，该 Intent 位于包含 tabview 的活动的 oncreate 方法中。

只要选项卡处于活动状态，是否有可能执行代码行，这些代码行现在在 ontabchanged 中运行良好，每 5 秒一次？如前所述，我有一个读取需要从意图移交的类文件的函数，以及一个写入数据的函数。它看起来像这样的自动取款机：

```
Bundle data = getIntent().getExtras();
final Login_Data logindata = data.getParcelable("logindata");
tabHost.setOnTabChangedListener(new OnTabChangeListener() {

    @Override
    public void onTabChanged(String tabId) {

        if (tabId == "Anzeige1") {
            Anzeigedatenlesen(logindata);
            Anzeigeschreiben();                             
        } else if (tabId == "Anzeige2") {
            System.out.println("Anzeige2"); 
        } else if (tabId == "Anzeige3") {
            System.out.println("Anzeige2");
        }
    }
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:31:25.827

您链接到的答案中的代码应该可以满足您的需求，请参见下面的代码：

```
Bundle data = getIntent().getExtras();
final Login_Data logindata = data.getParcelable("logindata");
Handler mHandler = new Handler();
Runnable mRefresh = new Runnable() {

    @Override
    public void run() {
       // I guess this are the update methods?
       Anzeigedatenlesen(logindata);
       Anzeigeschreiben();
       mHandler.postDelayed(mRefresh, 5000);
    }   
};
tabHost.setOnTabChangedListener(new OnTabChangeListener() {

@Override
public void onTabChanged(String tabId) {

    if (tabId.equals("Anzeige1")) {
        // cancel any pending refresh that might be run in the near future 
        // as we got to our target tab and we need to refresh now!!!
        mHandler.removeCallbacks(mRefresh);
        // do a normal refresh
        Anzeigedatenlesen(logindata);
        Anzeigeschreiben();   
        // post a new refresh cycle as the user might stay on this tab                          
        mHandler.postDelayed(mRefresh, 5000);
    } else if (tabId.equals("Anzeige2")) {
        // for the other two tabs cancel the update if you get to them
        System.out.println("Anzeige2"); 
        mHandler.removeCallbacks(mRefresh);
    } else if (tabId.equals"Anzeige3")) {
        System.out.println("Anzeige2");
        mHandler.removeCallbacks(mRefresh);
    }
}
}); 
```

此外，您应该使用`.equals()`来测试字符串。

# java - 如何使用 ANT 创建 SVN 统计信息？

> ID：15519579
> 
> 赞同：0
> 
> 时间：2013-03-20T09:23:41.347
> 
> 标签：java, svn, ant, build-automation

我确信我在 maven 中看到过这一点，但不确定如何在 ant 中做到这一点：

如何获得提交者列表及其（最好是相对的）提交数量

IE

*   山姆 80%
*   乔 10%
*   迈克 5%
*   菲尔 5%

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T18:58:15.130

这就是其中之一，如果你做得很好，它仍然是一堆垃圾。正如@alroc 和@bahrep 指出的那样。

我也以工作为生，我知道尖头发的老板喜欢图表。

我会使用[svn ant 任务](http://subclipse.tigris.org/svnant/svntask.html#log)来获取日志（类似这样，我没有运行它）

```
<svn>
    <log path=${basedir} destFile="svn-log.xml">
</svn> 
```

我会使用使用[java 任务](http://ant.apache.org/manual/Tasks/java.html)来运行 statsvn （类似这样，我没有运行它）

```
<java jar="/path/to/statsvn.jar"
       fork="true"
       failonerror="true"
       >
    <arg line="svn-log.xml ${basedir}"/>
</java> 
```

我觉得用伪代码发布答案有点糟糕......但我最好的建议是：对于这样的老板，我建议对简历进行适量的润色。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-20T12:58:19.970

您可以从`svn`命令使用`<exec/>`或`<cvs/>`任务中获取该信息。

# c# - MVC3 应用程序中的解耦实体框架

> ID：15519582
> 
> 赞同：5
> 
> 时间：2013-03-20T09:23:53.723
> 
> 标签：c#, asp.net-mvc-3, entity-framework, dependency-injection, decoupling

我有几个关于使用实体框架作为数据访问层在 MVC3 Web 应用程序中解耦域层和数据层的问题。

就目前而言，我的控制器完全依赖于 EF 类，并且在花了大部分时间阅读依赖注入之后，我试图将它们解耦。

我的第一个问题是 - 我是否需要将所有 EF 类有效地复制到我的业务层中？我显然不能再使用 EF 类了，所以在我看来，我需要创建每个正在使用的表类的副本才能使其正常工作。这是正确的吗？例如，如果我有 50 个 EF 类代表我的数据库中的 50 个表，我是否需要在我的业务层中创建 50 个新类？-> 然后无限期地维护它们？这听起来像是很多工作。

其次，我是否正确假设依赖关系被翻转，而不是业务层依赖于数据层，数据层最终变得依赖于业务层？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:32:26.093

对于您的实体的重复...这取决于 EF 的版本和您使用的方法。

如果您使用[POCO 实体](http://msdn.microsoft.com/en-us/library/vstudio/dd456853%28v=vs.100%29.aspx)，那么您的模型与 EF 无关，因为您的实体不继承自`EntityObject`. 所以你不必复制你的实体。在运行时，由于代理实体，EF 将生成从您的 POCO 继承的动态类型，并添加所有 EF 管道以用于延迟加载......等等。

在任何情况下，请注意，由于 ASP.Net MVC，您总是会通过将一些模型类复制到所谓的视图模型中来结束，因此您可以强类型化您的视图。

> 其次，我是否正确假设依赖关系被翻转，而不是业务层依赖于数据层，数据层最终变得依赖于业务层？

不，数据层不应该知道业务层。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:44:09.873

您可以将您的模型类放在一个单独的程序集中到您的上下文中。

如果这样做，您的数据层、业务层和网站都可以引用模型组件，但您可以隔离其他依赖项 - 例如，网站组件不会直接引用数据层，这意味着它没有也必须参考EF。

如果您首先使用代码，这很简单。

如果您首先使用数据库，则从上下文程序集中删除对模型 .tt 文件的引用。不要删除或移动它，而是在新模型装配中添加指向它的链接。

要添加链接，请在解决方案资源管理器中右键单击您的项目，然后选择“添加 -> 现有项目”。然后你会得到一个文件选择器对话框。该对话框上的“添加”按钮有一个下拉菜单，您可以在其中选择“添加为链接”。

# php - 如何创建函数和调用函数

> ID：15519583
> 
> 赞同：-3
> 
> 时间：2013-03-20T09:23:58.453
> 
> 标签：php, html

谁能给我一个创建一个简单函数的例子，它返回两个输入字段的总和？

```
<html>
  <body>
    number1:<input type="text" name="number1" />
    number2:<input type="text" name="number2" />
    <input type=submit name="submit" value="submit"/>
  </body>
</html> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:27:36.337

我认为这就是您要搜索的内容：http: [//php.net/manual/en/tutorial.forms.php](http://php.net/manual/en/tutorial.forms.php)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:31:34.803

```
function addition( $num1,$num2)
{

    echo "Result = " . $num1 + $num2;
}

and call the  function  by 

if(isset($_POST["submit"]))
{

  $num1=$_POST['number1'];
  $num2=$_POST['number2'];
addition( $num1,$num2);
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:27:46.743

尝试以下操作：

```
<?php
if(isset($_POST))
{
    echo "Result = " . $_POST['number1'] + $_POST['number2'];
}
?>
<html>
<head>
<title> Example of the radio blur method</title>
</head>
<body>

<form name="form1">
<input type="text" name="number1" value="">
<input type="text" name="number2" value="">
<input type="submit" name="submit" value="Add">
</form>
</body>
</html> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:31:36.113

尝试;

```
<html>
<body>
<form action='<?php echo $_SERVER["PHP_SELF"] ?>' method='post'>
number1:<input type='text' name='number1'/>
number2:<input type='text' name='number2'/>
<input type='submit' name='submit' value='submit'/>
</form>
<br/>
<?php
if($_POST["submit"]){
   echo "$_POST[number1] + $_POST[number2] = ".($_POST["number1"] + $_POST["number2"])."<br/>\n";
}
?>
</body>
</html> 
```

# android - 按下后退按钮时Android广播接收器未接收

> ID：15519587
> 
> 赞同：3
> 
> 时间：2013-03-20T09:24:15.783
> 
> 标签：android, sms, broadcastreceiver

当我的应用程序通过后退按钮最小化时，我想接收短信，当我通过主页按钮最小化时它收到短信，但是当按下按钮时没有收到广播消息。谢谢。

我的应用程序代码是：

```
 @Override
protected void onResume() {
    super.onResume();

    registerReceiver(receiver, filter);
}

 @Override
 protected void onPause() {
 super.onPause();
 unregisterReceiver(receiver);
 } 
```

和

```
 @Override
public void onReceive(Context context, Intent intent) {
    String address = "";
    String message = "";
    Bundle extras = intent.getExtras();
    if (extras != null) {
        Object[] smsExtra = (Object[]) extras.get("pdus");

        for (int i = 0; i < smsExtra.length; i++) {
            SmsMessage sms = SmsMessage.createFromPdu((byte[]) smsExtra[i]);
            message += sms.getMessageBody();
            address = sms.getOriginatingAddress();
        }
        Toast.makeText(context, "SMS Received>>" + message +"From >>" + address,
                Toast.LENGTH_LONG).show();
    } 
```

所以当我通过后退按钮最小化时如何接收短信谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T14:06:56.287

我以一种小技巧的方式做到了，就像这样。

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK) {
        // Display confirmation here, finish() activity.
        Intent startMain = new Intent(Intent.ACTION_MAIN);
        startMain.addCategory(Intent.CATEGORY_HOME);
        startMain.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
        startActivity(startMain);
        return true;
    }
    return super.onKeyDown(keyCode, event);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T09:25:32.647

当用户离开时，您正在注销广播接收器，显然它不起作用。与其在应用级别注册，不如在清单中注册。这样它不依赖于应用程序的状态。

要了解更多信息：http: [//developer.android.com/reference/android/content/BroadcastReceiver.html](http://developer.android.com/reference/android/content/BroadcastReceiver.html)

# ruby-on-rails - 在导轨中消毒

> ID：15519589
> 
> 赞同：2
> 
> 时间：2013-03-20T09:24:16.417
> 
> 标签：ruby-on-rails, sanitize

我要清理我认为我正在使用的所有 ruby​​ 变量。我知道rails中的[消毒](http://api.rubyonrails.org/classes/ActionView/Helpers/SanitizeHelper.html#method-i-sanitize)方法。有什么方法可以避免在所有变量之前编写 sanitize 。换句话说，如果我在一个视图中有 10 个 ruby​​ 变量，我必须在所有的前面写上 sanitize 来实现 sanitisation。有没有一种方法，我只需要调用一次方法，所有变量都会被清理。

# c# - 如何根据某些标准从现有集合中创建新列表

> ID：15519597
> 
> 赞同：2
> 
> 时间：2013-03-20T09:24:34.523
> 
> 标签：c#, .net, algorithm

可以说，我在 List 中有自定义对象的集合。每个对象的持续时间属性设置为几分钟（10 分钟或 15 分钟或 45 分钟等）

我必须将它们分组在 3 小时的列表中。也就是说，ListA 将收集 Duration 总和应等于 3 小时的对象，依此类推。但最终清单需要/不需要坚持 3 小时（可能更少或相等）

我应该使用哪种算法从列表中读取对象并根据 3 小时的总持续时间创建新列表。

这里的困难可能是，假设我有 5 个 30 分钟的对象和 2 个 45 分钟的对象。在 ListA 中，如果我在阅读时添加了 5 个 30 分钟的对象（6*50 = 150），但我无法添加 1 个 45 分钟的对象。因为那不等于 3 小时。我会先添加 45 分钟对象中的 2 个，然后添加 30 分钟对象中的 3 个（2*45 + 3*30 = 3 小时），然后将另外 2 个对象放在另一个列表中。

谢谢阅读。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:50:30.880

如果您尝试先存储大对象并完成较小的对象，这会很容易。

这是我为您制作的快速代码，它工作正常：

```
 static void Main(string[] args)
    {
        // data
        List<Int32> listElement = new List<Int32>() { 10, 20, 10, 30, 45, 10, 20, 30, 40, 50, 60, 40, 30, 50, 60, 70, 80, 90, 20, 30, 10, 50, 60, 40, 60, 80, 90, 60, 80, 70, 80, 90, 90, 50 };
        Int32 MaxStack = 180;

        // result
        List<List<Int32>> listResult = new List<List<Int32>>();

        // process
        foreach (Int32 element in listElement.OrderByDescending(i => i))
        {
            List<Int32> listToStore = listResult.Where(l => l.Sum() + element <= MaxStack).FirstOrDefault();
            if (listToStore == null)
            {
                listToStore = new List<Int32>();
                listResult.Add(listToStore);
            }

            listToStore.Add(element);
        }

        // view
        foreach (List<Int32> list in listResult)
        {
            Console.Write("List " + (listResult.IndexOf(list) + 1) + "[total " + list.Sum() + "]: ");                
            foreach (Int32 element in list)
            {
                Console.Write(element.ToString() + " ");
            }

            Console.WriteLine();
        }

        Console.ReadKey();
    } 
```

例如，它在控制台中，带有 Int32 对象，但对于复杂对象也是如此。

所有的事情就是从大到小读取您的对象列表，并找到可以存储它的第一个商店列表。

结果是：

```
List 1[total 180]: 90 90
List 2[total 180]: 90 90
List 3[total 180]: 80 80 20
List 4[total 180]: 80 80 20
List 5[total 180]: 70 70 40
List 6[total 180]: 60 60 60
List 7[total 180]: 60 60 50 10
List 8[total 180]: 50 50 50 30
List 9[total 175]: 45 40 40 30 20
List 10[total 90]: 30 30 10 10 10 
```

**编辑：**如果您想在 180 处列出尽可能多的列表，这是一个（快速且方便的）代码，您可以在 process 和 view 之间添加：

```
 // switching element for better fill
        List<List<Int32>> unfilledlist = listResult.Where(l => l.Sum() < MaxStack).ToList();
        // truncate original result
        unfilledlist.ForEach(l => listResult.Remove(l));

        while (unfilledlist != null && unfilledlist.Count > 1)
        {
            List<Int32> list = unfilledlist.First();
            unfilledlist.Remove(list);

            foreach (Int32 element in list)
            {
                Int32 needed = MaxStack - list.Sum() + element;
                Boolean isFound = false;

                foreach (List<Int32> smallerlist in unfilledlist)
                {
                    List<Int32> switchingList = new List<int>();

                    // searching how to fill what we needed
                    foreach (Int32 e in smallerlist.OrderByDescending(i => i))
                    {
                        if (e + switchingList.Sum() <= needed)
                            switchingList.Add(e);
                    }

                    // we found a possible switch
                    if (switchingList.Sum() == needed)
                    {
                        // moving first element
                        list.Remove(element);
                        smallerlist.Add(element);

                        // moving element
                        switchingList.ForEach(e => { smallerlist.Remove(e); list.Add(e); });
                        isFound = true;
                        break;
                    }
                }

                if (isFound)
                    break;
            }

            listResult.Add(list.OrderByDescending(i => i).ToList());
        }

        // completing result with lists that are not with sum 180
        unfilledlist.ForEach(l => listResult.Add(l.OrderByDescending(i => i).ToList())); 
```

我对这段代码不满意，但它似乎有效

新结果：

```
List 1[total 180]: 90 90
List 2[total 180]: 90 90
List 3[total 180]: 80 80 20
List 4[total 180]: 80 80 20
List 5[total 180]: 70 70 40
List 6[total 180]: 60 60 60
List 7[total 180]: 60 60 50 10
List 8[total 180]: 50 50 50 30
List 9[total 180]: 40 40 30 30 20 10 10
List 10[total 85]: 45 30 10 
```

# javascript - 将第 1 页的表单提交到第 3 页内的 iframe 第 2 页并加载第 3 页

> ID：15519598
> 
> 赞同：1
> 
> 时间：2013-03-20T09:24:36.807
> 
> 标签：javascript, forms, iframe, submit

我的页面#1 上有一个表单，我需要将其提交到页面#2，它是页面#3 中的 iframe。我可以使用以下代码从第 1 页提交到 iframe，但我需要的是当我在第 1 页提交以加载第 3 页时，它将加载提交的 iframe 表单。

这是来自 page#1 target="/search.html" 的表单，表示 page#3 链接但未加载。相反，它在单独的窗口上加载 iframe。

```
<form id="SearchForm" action="search-results/" target="/search.html" method="post">

<input type="text"  name="keywords[all_words]" />

<input type="text"  name="City[all_words]" />

<a href="#" class="btn_search row_right" onclick="document.getElementById('SearchForm').submit()">Search</a> 
```

# python - python：局部变量在赋值前被引用

> ID：15519599
> 
> 赞同：5
> 
> 时间：2013-03-20T09:24:38.977
> 
> 标签：python

这是我的代码：

```
x = 1
def poi(y):
        # insert line here

def main():
    print poi(1)

if __name__ == "__main__":
    main() 
```

如果放置以下 4 行，一次一个，代替 `# insert line here`

```
 Lines         | Output
---------------+--------------
1\. return x    | 1 
2\. x = 99      |
   return x    | 99
3\. return x+y  | 2 
4\. x = 99      | 99 
```

**在上面的几行中，似乎在案例 1 和 3 中使用了上面声明的全局 x**

但 ，

```
x = x*y      
return x 
```

这给

```
error : local variable 'x' is reference before assignment 
```

这里有什么问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T09:37:42.293

当 Python 看到你正在分配`x`它时，它会强制它成为一个局部变量名。现在无法`x`在该函数中看到全局（除非您使用`global`关键字）

所以

案例 1）由于没有 local `x`，所以你得到了 global

案例 2）您正在分配给本地`x`，因此函数中的*所有*引用`x`都将是本地的

`x`案例3）没问题，它又使用了全局

案例 4) 同案例 2

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T09:28:09.133

当你想访问一个全局变量时，你可以通过它的名字来访问它。但是如果你想改变它的值，你需要使用关键字`global`。

尝试 ：

```
global x
x = x * y      
return x 
```

在情况 2 中，x 被创建为局部变量，从不使用全局 x。

```
>>> x = 12
>>> def poi():
...   x = 99
...   return x
... 
>>> poi()
99
>>> x
12 
```

# actionscript-3 - Starling 给出无法转码图像错误

> ID：15519600
> 
> 赞同：0
> 
> 时间：2013-03-20T09:24:39.460
> 
> 标签：actionscript-3, flash, starling-framework

我正在开发一个原型，在该原型中我将纹理添加到movieClip。这是我的代码：

```
[Embed(source = "/../assets/demo_img.png")]
protected var asset01:Class;

[Embed(source="/../assets/demo_img.xml",mimeType="application/octet-stream")]
protected var data01:Class; 
```

我的电影剪辑代码是：

```
var myTexture:Texture = Texture.fromBitmap(new asset01());
var atlas:TextureAtlas = new TextureAtlas(myTexture, XML(new data01()));
var mc:MovieClip = new MovieClip(atlas.getTextures("demo_img_"), 10); 
```

但它给了我错误：

```
Error: exception during transcoding: Failed to grab pixels for image \..\PP143Starling\assets\demo_img.png 
```

如果有人对此有任何想法，请分享。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-24T14:28:32.970

我遇到了类似的问题，奇怪的是它开始出现而没有对代码进行任何更改。最初我遇到了 Windows 内存问题，然后是 Eclipse 内存问题，然后出现了这个错误：转码期间的异常未能抓取图像嵌入的像素也不再被编译器识别。

修复非常简单。我刚刚在eclipse中清理了我的项目并清除了错误。

# asp.net-mvc - 在 Asp.net MVC 4 中启用和禁用用户角色上的复选框

> ID：15519602
> 
> 赞同：0
> 
> 时间：2013-03-20T09:24:56.570
> 
> 标签：asp.net-mvc, asp.net-mvc-3, razor, asp.net-mvc-4, razor-2

我正在使用**视图**在 Asp.net MVC4（Razor 视图引擎）中添加新用户。当处于管理员角色的用户添加新用户时，我想向用户显示一个复选框，该复选框将显示 IsAdmin（用于将新用户添加到管理员角色）并且当新的匿名用户注册自己时，然后这个检查 -框不应出现。**对于这两种情况，我都想使用相同的视图** ，我正在使用 Asp.netMVC4 Simple-membership。

所以，请告诉我如何实现同样的目标

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:31:25.497

我不知道您的网站是如何设置的，所以很难回答，但是...

我将假设您正在从控制器将模型传递给您的视图。

如果是这样，请为您的模型添加一个 bool 类型的属性（事实上，这是使用 ViewModel 的好时机）。确保您的布尔值反映了用户角色作为管理员的权限（真或假）。

所以，像

```
public bool IsAdmin
{
    get { return _isAdmin;}
    set 
    {
        _isAdmin = IsPartOfAdminRoleQuery();
    }
} 
```

然后，在您看来，只需调用您的模型（您可能需要使用 Lamba 或类似名称，具体取决于模型的设置方式）

```
@if (Model.IsAdmin) 
//logic 
```

# java - Struts2 排除 com.sun:tools:jar:1.5.0 需要吗？

> ID：15519603
> 
> 赞同：0
> 
> 时间：2013-03-20T09:24:56.900
> 
> 标签：java, maven, struts2

我是 Struts2 的新手。

每当我包含 Struts2 依赖项时，为什么我必须这样做？

```
<dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts2-core</artifactId>
        <version>${struts.version}</version>
        <exclusions>
            <exclusion>
                <artifactId>tools</artifactId>
                <groupId>com.sun</groupId>
            </exclusion>
        </exclusions>
    </dependency> 
```

如果我不这样做，**Eclipse Juno**在这一点上会给我错误。

```
xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
 http://maven.apache.org/maven-v4_0_0.xsd 
```

出现此错误：

```
Missing artifact com.sun:tools:jar:1.5.0 
```

这是这样做的方法还是有更好的方法？

我注意到这个问题发生在 2.1.6 及更高版本。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T10:19:43.083

工件`com.sun:tools:jar:1.5.0`是来自 JDK（而不是 JRE）的 jar。此 jar 在任何 maven 存储库中均不可用，但位于`<JDK_HOME>/lib`. 这就是您收到此错误的原因。

当您指定排除项时，maven 不会尝试查找 jar（因此它不会失败）。

[Struts2 在编译时](http://struts.apache.org/release/2.1.x/struts2-osgi-bundles/dependencies.html)（而不是在运行时）需要这个依赖。

所以设置排除是摆脱这个问题的正确方法。由于 maven 需要一个 JDK 来运行：tools.jar 在编译项目时无论如何都是可用的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T12:37:53.493

您不需要这样做。

您这样做表明您的 Eclipse、Eclipse 项目和/或 Eclipse Maven 插件配置存在问题。相比之下，我基本上每个版本都有 S2 项目，并且在任何 pom 中我都不需要排除 Java 工具 jar，而且从来没有。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-07T03:23:29.210

**问题解释**

实际上，发生的事情是 struts2 依赖于系统依赖项，即`tools.jar`. 通过解析此路径找到此依赖项：`${java.home}/../lib/tools.jar`.

如果你用 maven 编译你的项目，maven 会很聪明地`${java.home}`用正确的*JDK*位置替换。

出于某种原因，如果您尝试使用 eclipse（即通常使用 m2e 帮助）编译您的 mavenized 项目，`${java.home}`则针对`-vm`eclipse 命令行参数进行解析。

**解决方案**

如果你想解决这个问题，不要排除`tools.jar`. 而是通过以下任一方式强制您的 Eclipse 与您最喜欢的 JDK 一起运行（*因为我不了解您的操作系统，所以我将以与操作系统无关的形式给出示例*）：

*   **命令行开关**

> /path/to/eclipse -vm /path/to/jdk/bin/javaw

检查此[SO 答案](https://stackoverflow.com/a/1919405/363573)以获取 Windows 上的示例。

*   **日食.ini**

> -vm
> /path/to/jdk/bin/javaw

检查此[SO 答案](https://stackoverflow.com/a/4706421/363573)以获取 Windows 上的示例。

# python - 为什么替换多个连续的空格也会删除 Python 中的换行符？

> ID：15519615
> 
> 赞同：1
> 
> 时间：2013-03-20T09:25:32.120
> 
> 标签：python, regex

这是我的代码：

```
print apps_version
apps_version = re.sub("\s+"," ",apps_version)
print apps_version
apps_version = apps_version.splitlines() 
```

这就是发生的事情：

```
backend    10.2.25
server   12.6.4.6
backend 10.2.25 server 12.6.4.6 
```

它确实用单个空格替换了空格，但它也从行尾删除了换行符。我通过用 | 替换空格来解决它 字符并使用它来拆分行，但是有人可以解释为什么替换空格会删除换行符吗？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:49:12.480

引用[文档](http://docs.python.org/2/library/re.html)：

> `\s`
> 
> 当[`UNICODE`](http://docs.python.org/2/library/re.html#re.UNICODE)未指定标志时，它匹配任何空白字符，这相当于 set `[ \t\n\r\f\v]`。该[`LOCALE`](http://docs.python.org/2/library/re.html#re.LOCALE)标志对空间的匹配没有额外的影响。如果[`UNICODE`](http://docs.python.org/2/library/re.html#re.UNICODE)设置，这将匹配字符`[ \t\n\r\f\v]`加上 Unicode 字符属性数据库中分类为空格的任何内容。

`\s`不仅匹配空格（ASCII 32），它还将匹配水平制表符、**换行符**、**回车符**、换页符和垂直制表符。如果您启用标志，**甚至更多。**`UNICODE`

如果空间是您所关心的，那么`r' +'`这就是您所需要的。

# java - SQLServer 的休眠配置 - 驱动程序类

> ID：15519621
> 
> 赞同：2
> 
> 时间：2013-03-20T09:25:49.267
> 
> 标签：java, sql-server, hibernate, jdbc, driver

我正在尝试使用 SQLServer 数据库配置休眠。

配置：

```
public static SessionFactory getSessionFactory() {
    try {
        if (null==sessionFactory) {
            Properties hb_props = new Properties();
            hb_props.put("hibernate.dialect", "org.hibernate.dialect.SQLServer2005Dialect");
            hb_props.put("hibernate.connection.driver.class", "com.microsoft.sqlserver.jdbc.SQLServerDriver");
            hb_props.put("hibernate.connection.username", "someusername");
            hb_props.put("hibernate.connection.password", "somepassword");
            hb_props.put("hibernate.connection.url", "jdbc:sqlserver://serverurl//dbname");
            Configuration configuration = new Configuration();
            configuration.setProperties(hb_props);
            sessionFactory = configuration.addAnnotatedClass(Test.class).buildSessionFactory();
        }
    } catch (Throwable ex) {
        System.err.println("Initial SessionFactory creation failed." + ex);
        throw new ExceptionInInitializerError(ex);
    }
    return sessionFactory;
} 
```

我收到以下错误：

```
[main] WARN org.hibernate.connection.DriverManagerConnectionProvider - no JDBC Driver class was specified by property hibernate.connection.driver_class
[main] INFO org.hibernate.connection.DriverManagerConnectionProvider - using driver: null at URL: jdbc:sqlserver://serverurl//dbname
[main] INFO org.hibernate.connection.DriverManagerConnectionProvider - connection properties: {user=someusername, password=****, driver.class=com.microsoft.sqlserver.jdbc.SQLServerDriver}
[main] WARN org.hibernate.cfg.SettingsFactory - Could not obtain connection to query metadata
java.sql.SQLException: No suitable driver found for jdbc:sqlserver://serverurl//dbname
    at java.sql.DriverManager.getConnection(DriverManager.java:602)
    at java.sql.DriverManager.getConnection(DriverManager.java:154)
    at org.hibernate.connection.DriverManagerConnectionProvider.getConnection(DriverManagerConnectionProvider.java:133)
    at org.hibernate.cfg.SettingsFactory.buildSettings(SettingsFactory.java:113)
    at org.hibernate.cfg.Configuration.buildSettingsInternal(Configuration.java:2863)
    at org.hibernate.cfg.Configuration.buildSettings(Configuration.java:2859)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1870)
        ..... 
```

我正在使用 sqljdbc-1.2.jar 并且驱动程序类似乎拼写正确，无法弄清楚缺陷在哪里..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:13:55.840

尝试改变这个：

```
hb_props.put("hibernate.connection.driver.class",
    "com.microsoft.sqlserver.jdbc.SQLServerDriver"); 
```

对此：

```
hb_props.put("hibernate.connection.driver_class",
   "com.microsoft.sqlserver.jdbc.SQLServerDriver"); 
```

这个来自 JBoss 的[配置指南](http://docs.jboss.org/hibernate/orm/3.3/reference/en-US/html/session-configuration.html#configuration-hibernatejdbc)`_`使用 an而不是`.`

# mysql - 活动记录，其中 {}

> ID：15519625
> 
> 赞同：1
> 
> 时间：2013-03-20T09:25:54.293
> 
> 标签：mysql, sql, ruby-on-rails, activerecord

我找不到任何参考这是如何工作的：

```
Order.where {(expirate_at >= 10.days.ago) & (expirate_at <= 9.days.ago)} 
```

这给出了sql查询：

```
SELECT `orders`.* FROM `orders` 
  WHERE ((`orders`.`expirate_at` >= '2013-03-10 09:22:23' 
    AND `orders`.`expirate_at` <= '2013-03-11 09:22:23')) 
```

有人可以解释一下吗？

**更新：**

```
Order.where({(expirate_at >= 10.days.ago) & (expirate_at <= 9.days.ago)}) 
```

以。。结束

```
SyntaxError: (irb):1: syntax error, unexpected '}', expecting tASSOC
... & (expirate_at <= 9.days.ago)}) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-08-14T09:26:40.413

该项目中使用了[squeel](https://github.com/activerecord-hackery/squeel) gem。谜团解开了。;)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:06:54.023

这就是红宝石的方式。

```
Order.where {} 
```

只不过是

```
Order.where({}) 
```

# java - 如何获取包中的所有类名？

> ID：15519626
> 
> 赞同：11
> 
> 时间：2013-03-20T09:25:57.890
> 
> 标签：java, design-patterns

所以我有一个包含扩展 JPanel 的类的包，我想动态地将它们添加为选项卡。一开始我使用了一个工厂，并在其中注册了所有类并且它可以工作，但是现在我想在不知道它们的名称的情况下加载包中的所有类。我已经尝试了几件事，包括[Reflections 库](http://code.google.com/p/reflections/)（我发现它非常混乱），但我无法让它们工作。我很感激任何帮助。

这是我的试验之一：

```
public static void registerTab() {
    String pkg = TabA.class.getPackage().getName();
    String relPath = pkg.replace('.', '/');

    URL resource = ClassLoader.getSystemClassLoader().getResource(relPath);
    if (resource == null) {
        throw new RuntimeException("Unexpected problem: No resource for "
                + relPath);
    }

    File f = new File(resource.getPath());

    String[] files = f.list();

    for (int i = 0; i < files.length; i++) {

        String fileName = files[i];
        String className = null;
        String fileNm = null;

        if (fileName.endsWith(".class")) {

            fileNm = fileName.substring(0, fileName.length() - 6);
            className = pkg + '.' + fileNm;
        }

        if (className != null) {

            if (!tabClasses.containsKey(className))
                tabClasses.put(fileNm, className);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-20T09:32:39.563

这是我开发的用于查找包的所有类的自定义解决方案：

```
public class ClassFinder {

    private static final char PKG_SEPARATOR = '.';

    private static final char DIR_SEPARATOR = '/';

    private static final String CLASS_FILE_SUFFIX = ".class";

    private static final String BAD_PACKAGE_ERROR = "Unable to get resources from path '%s'. Are you sure the package '%s' exists?";

    public static List<Class<?>> find(String scannedPackage) {
        String scannedPath = scannedPackage.replace(PKG_SEPARATOR, DIR_SEPARATOR);
        URL scannedUrl = Thread.currentThread().getContextClassLoader().getResource(scannedPath);
        if (scannedUrl == null) {
            throw new IllegalArgumentException(String.format(BAD_PACKAGE_ERROR, scannedPath, scannedPackage));
        }
        File scannedDir = new File(scannedUrl.getFile());
        List<Class<?>> classes = new ArrayList<Class<?>>();
        for (File file : scannedDir.listFiles()) {
            classes.addAll(find(file, scannedPackage));
        }
        return classes;
    }

    private static List<Class<?>> find(File file, String scannedPackage) {
        List<Class<?>> classes = new ArrayList<Class<?>>();
        String resource = scannedPackage + PKG_SEPARATOR + file.getName();
        if (file.isDirectory()) {
            for (File child : file.listFiles()) {
                classes.addAll(find(child, resource));
            }
        } else if (resource.endsWith(CLASS_FILE_SUFFIX)) {
            int endIndex = resource.length() - CLASS_FILE_SUFFIX.length();
            String className = resource.substring(0, endIndex);
            try {
                classes.add(Class.forName(className));
            } catch (ClassNotFoundException ignore) {
            }
        }
        return classes;
    }

} 
```

然后，只需使用：

```
List<Class<?>> classes = ClassFinder.find("com.package"); 
```

# c# - 如何在此文件上传功能中检查文件是否存在？

> ID：15519628
> 
> 赞同：2
> 
> 时间：2013-03-20T09:26:03.783
> 
> 标签：c#, asp.net, security, file-upload

我正在尝试开发具有安全性的上传文件功能，就像我的编程讲师要求我做的那样。我以这样一种方式实现了它，它会检查文件的大小、文件格式和是否存在。除了检查文件的存在之外，逻辑运行良好。例如，当我尝试上传一个已经存在的文件时，我不会收到一条消息告诉我该文件已经存在并且我不知道它为什么不工作。

```
protected void UploadFile(object sender, EventArgs e)
    {
        if(FileUpload1.HasFile)
            try 
            {
                string[] validTypes = { "bmp", "gif"};
                string ext = System.IO.Path.GetExtension(FileUpload1.PostedFile.FileName);

                if (size < limit) 
                {
                    for (int i = 0; i < validTypes.Length; i++)
                    {
                        if (ext == "." + validTypes[i])
                        {
                            string path = @"~\Images\"; 
                            string comPath = Server.MapPath(path + "\\" + FileUpload1.FileName);
                            if (!File.Exists(comPath))
                            {
                                FileUpload1.PostedFile.SaveAs(comPath);
                                Label1.Text = "File uploaded";
                            }
                            else
                            {
                                Label1.Text = "Existed";
                            }
                        }
                        else 
                        {
                            Label1.Text = "Invalid File." + string.Join(",", validTypes);
                        }
                    }                         
                }

                else 
                {
                    Label2.ForeColor = System.Drawing.Color.Red;
                    Label2.Text = "file is heavy";
                }
            }

            catch (Exception ex)
            {
                Label2.Text = "The file could not be uploaded. The following error occured: " + ex.Message;
            }
} 
```

当我调试代码时，我发现它会执行 else 语句，但它不会显示给用户，而是会在外部 else 语句中显示消息“无效文件”。**为什么？**

```
if (ext == "." + validTypes[i])
                            {
                                string path = @"~\Images\"; 
                                string comPath = Server.MapPath(path + "\\" + FileUpload1.FileName);
                                if (!File.Exists(comPath))
                                {
                                    FileUpload1.PostedFile.SaveAs(comPath);
                                    Label1.Text = "File uploaded";
                                }
                                else
                                {
                                    Label1.Text = "Existed";
                                }
                            }
                            else 
                            {
                                Label1.Text = "Invalid File." + string.Join(",", validTypes);
                            } 
```

另外，我的导师告诉我，以下行会导致一个称为路径遍历的漏洞。

```
string path = @"~\Images\"; 
```

**那么如何防范这个安全漏洞呢？？有任何想法吗？**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:32:51.473

您的代码中存在逻辑问题。
在街区

```
for (int i = 0; i < validTypes.Length; i++) 
```

它总是为每个文件运行两次。

你可以做什么你把一个布尔变量设置为假。
进入循环，如果找到文件将布尔值设置为 true 并使用 break 语句。
在循环结束时检查布尔值并相应地编码。

## 编辑-1

而不是循环遍历数组，您可以像这样使用

```
string[] stringArray = { "text1", "text2", "text3", "text4" };
string value = "text3";
int pos = Array.IndexOf(stringArray, value);
if (pos >- 1)
{
    // the array contains the string and the pos variable
    // will have its position in the array
} 
```

## 在你的情况下

```
 string[] validTypes = { "bmp", "gif"};
 string ext = System.IO.Path.GetExtension(FileUpload1.PostedFile.FileName);
 int pos = Array.IndexOf(validTypes , ext );
 if(pos>=0)
 {
     string path = @"~\Images\"; 
     string comPath = Server.MapPath(path + "\\" + FileUpload1.FileName);
     if (!File.Exists(comPath))
     {
         FileUpload1.PostedFile.SaveAs(comPath);
         Label1.Text = "File uploaded";
     }
     else
     {
         Label1.Text = "Existed";
     }
 }
 else
 {
    Label1.Text = "Invalid File." + string.Join(",", validTypes);
 } 
```

# android - Android Xml 按钮布局

> ID：15519632
> 
> 赞同：-1
> 
> 时间：2013-03-20T09:26:10.003
> 
> 标签：android, xml, button, layout

将按钮放在我的 xml 文件中时遇到问题。

![这是我的图形布局](../Images/e22842b9d18bd1c4bf1fc74282cd23e1.png)

现在我想要的是底部的“确定”按钮应该位于倒数第二条的里程编辑文本下方。我在按钮之前使用滚动视图。我也使用单个图像作为背景。

我的应用程序中的所有按钮怎么可能只出现在倒数第二条（灰色）上？布局的其余部分应介于两者之间（即顶部灰色条和底部灰色条之间）。

我尝试在 'dp' 中使用 margin_top 或 margin_bottom ，但它没有正确出现，而且在其他所有手机上按钮的布局都发生了变化。这是我的代码（.xml 文件）：

```
 <?xml version="1.0" encoding="utf-8"?>
    <RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" 
    android:background="@drawable/menu"
    android:padding="10dp">

    <ScrollView
        android:id="@+id/scv"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_marginTop="105dp"
        android:layout_marginBottom="105dp" >

        <RelativeLayout
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentTop="true"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp"
        android:ems="10"
        android:hint="Year"
        android:inputType="date" />

    <Spinner
        android:id="@+id/spinner1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/editText1"
        android:layout_alignRight="@+id/editText1"
        android:layout_below="@+id/editText1"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp" />

    <Spinner
        android:id="@+id/spinner2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/spinner1"
        android:layout_alignRight="@+id/spinner1"
        android:layout_below="@+id/spinner1"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp" />

    <Spinner
        android:id="@+id/spinner3"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/spinner2"
        android:layout_alignRight="@+id/spinner2"
        android:layout_below="@+id/spinner2"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp" />

    <EditText
        android:id="@+id/editText2"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignLeft="@+id/spinner3"
        android:layout_below="@+id/spinner3"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="10dp"
        android:ems="10"
        android:hint="Mileage"
        android:inputType="number" />
  </RelativeLayout>
         </ScrollView>

    <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="10dp"
        android:text="OK" />

    </RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:04:37.053

对于您的按钮 xml，请尝试

```
<Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/scv"
        android:layout_centerHorizontal="true"
        android:text="OK" /> 
```

`android:layout_marginTop="5sp"`如有必要，您可以添加 更改值。这会将您的按钮放在滚动视图下方。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:34:03.167

在 Android 上，您永远不应该在完整的布局中使用单个图像。因为你有这么多不同的屏幕尺寸，所以它运行得不是很好。

我建议您将图形分成几部分并使其拉伸，以便根据屏幕尺寸进行调整。由于您自己的代码复制粘贴不佳以及您希望图形看起来像什么缺乏可视化，因此实际上不可能为您提供更多帮助。

# silverlight - windows phone 中的多语言支持

> ID：15519636
> 
> 赞同：0
> 
> 时间：2013-03-20T09:26:23.110
> 
> 标签：silverlight, windows-phone-8

我正在开发支持英语和西班牙语两种语言的 windows phone 8 应用程序。

在我的应用程序中，我有一个包含`WebBrowser`控件的 XAML 页面。问题是当我将电话语言更改为西班牙语时，除`WebBrowser`控件内容外，所有文本都以西班牙语显示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T00:40:09.493

该`WebBrowser`控件使用用户设置的浏览器本地化设置。它可以不同于应用程序本地化。

此外，一旦更改，请确保您没有任何 cookie 保留语言选择。

# ruby-on-rails - 为什么我在 Heroku 上托管的精简 Ruby 网站上收到 400 Bad Request 标头

> ID：15519637
> 
> 赞同：0
> 
> 时间：2013-03-20T09:26:26.163
> 
> 标签：ruby-on-rails, curl, heroku, thin

我负责 www.lesscss.org。来源在这里[https://github.com/cloudhead/lesscss.org](https://github.com/cloudhead/lesscss.org)。

这是一个瘦 Web 应用程序，在 heroku 上运行。在浏览器中访问该网站很好。

我们有一个错误， curl -I lesscss.org 给出了 400 请求 - [https://github.com/cloudhead/less.js/issues/1232](https://github.com/cloudhead/less.js/issues/1232)

它确实

```
$ curl -I lesscss.org
HTTP/1.1 400 Bad Request
Server: nginx
Date: Tue, 19 Mar 2013 01:15:50 GMT
Connection: close 
```

我做了很多搜索，但没有找到原因或如何纠正上述问题.. 不应该是 302 重定向还是 200 ok？

[编辑]

带有详细选项

```
$ curl -Iv http://www.lesscss.org
* About to connect() to www.lesscss.org port 80 (#0)
*   Trying 107.21.106.77...
* 0x8001f140 is at send pipe head!
* STATE: CONNECT => WAITCONNECT handle 0x80057408; line 1032 (connection #0)
* Connected to www.lesscss.org (107.21.106.77) port 80 (#0)
* STATE: WAITCONNECT => DO handle 0x80057408; line 1151 (connection #0)
> HEAD / HTTP/1.1
> User-Agent: curl/7.29.0
> Host: www.lesscss.org
> Accept: */*
>
* STATE: DO => DO_DONE handle 0x80057408; line 1236 (connection #0)
* STATE: DO_DONE => WAITPERFORM handle 0x80057408; line 1352 (connection #0)
* STATE: WAITPERFORM => PERFORM handle 0x80057408; line 1363 (connection #0)
* HTTP 1.1 or later with persistent connection, pipelining supported
< HTTP/1.1 400 Bad Request
HTTP/1.1 400 Bad Request
< Server: nginx
Server: nginx
< Date: Wed, 20 Mar 2013 09:34:37 GMT
Date: Wed, 20 Mar 2013 09:34:37 GMT
< Connection: keep-alive
Connection: keep-alive

<
* STATE: PERFORM => DONE handle 0x80057408; line 1533 (connection #0)
* Connection #0 to host www.lesscss.org left intact
* Expire cleared 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:44:25.207

您正在使用的 toto 引擎中有[这一行](https://github.com/cloudhead/toto/blob/master/lib/toto.rb#L333)：

```
return [400, {}, []] unless @request.get? 
```

所以任何不是 get 的东西都会导致 400。Toto 可能会允许 head 请求通过（如果需要，可以结合 Rack::Head 将请求主体放在地板上）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:29:27.500

与`-I`您提出`HEAD`请求而不是`GET`. 删除`-I`标志，它将起作用。您可以看到它如何与`-v`标志一起使用：

```
curl -Iv lesscss.org 
```

# java - Android数据库游标是如何详细实现的？

> ID：15519640
> 
> 赞同：6
> 
> 时间：2013-03-20T09:26:32.303
> 
> 标签：java, android, android-cursor

我对`Cursor`Android 中的实现细节很感兴趣。我知道基本上它只是一个提供对数据库查询返回的结果集的随机读写访问的[接口。](http://developer.android.com/reference/android/database/Cursor.html)我想知道特定的`Cursor`实现：

1.  它是一种存储数据库结果集的数据结构吗？
2.  或者它只是一个只处理一行的结构？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T09:43:28.330

> 只是一些数据结构，它存储来自数据库的结果集

是的。

> 或者它是一些只处理一行的结构？

不完全是。游标可以根据源查询处理一行或多行。光标是数据映射，将包含与 source(select) 查询返回的行数一样多的行。因此，如果查询返回一百行，这些行将插入到 Cursor 并且 Cursor 包含这一百行。

您可以将光标想象为具有动态大小的数据映射（类似于列表），其中数据被放置为“行”。每行都有自己的行 id（行号，我们可以说是一些指针），当它们被插入到 Cursor 时逐渐生成，您可以简单地在具有此编号的行之间移动。隐式地，每个 Cursor 都有位于第一行（-1 位置）之前的“实际指针”，因此如果您调用`c.getString(0)`期望，则会抛出任何内容，因为没有什么可检索的。

因此，您始终必须调用`cursor.moveToFirst()`准备光标以进行读取，如果为空，则方法返回 false，因为没有行。

# sql-server-2012 - sqlserver 的自定义 ifilter 仅适用于第一个文件

> ID：15519654
> 
> 赞同：1
> 
> 时间：2013-03-20T09:27:27.213
> 
> 标签：sql-server-2012, full-text-search, ifilter, filetable

我为新扩展 (.abc) 创建了一个自定义 ifilter。
当我将它安装在操作系统中时，搜索效果很好。
当我尝试在 sqlserver 2012 中对文件表的全文索引使用它时，我看到只有一个文件被正确索引。
我试图在 fdhost.exe 上调试附加调试的索引任务。我看到我的类被实例化和销毁的次数与表中的文件 .abc 完全相同，但只是我第一次看到对 IPersistFile::Load、IFilter::Init、IFilter:GetChunk、IFilter::GetText 的调用，下次我的班级只调用构造函数和析构函数。
此外，在下次调用构造函数后，我在 Visual Studio 2012 的输出窗口中看到一个异常：
*fdhost.exe 中 0x000007fefd44a49d 处的第一次机会异常：Microsoft C++ 异常：内存位置 0x01022c30 处的 CNLBaseException。*

我没有找到有关此错误和 fdhost 行为的任何文档，以便了解错误在哪里。

谢谢你的答案。
路易吉

# android - 更改同一活动中的布局文件

> ID：15519658
> 
> 赞同：19
> 
> 时间：2013-03-20T09:27:44.243
> 
> 标签：android, layout, android-view

我正在使用`setContentView(R.layout.main)`在同一活动中切换视图。我正在调用一些异步任务并在主布局文件上填充数据，之后我通过调用`setContentView(R.layout.main)`方法更改视图。

我开始知道我们不应该`setContentView`对同一活动多次使用方法。虽然它对我来说很好用。

**谁能解释为什么我们不应该`setContentView`对同一个活动多次使用方法来改变视图？**

它会创建任何与内存相关的异常吗？有人可以澄清一下吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:38:04.323

我认为切换视图不是一个好主意，因为 android 平台已经有强大的框架来处理视图之间的转换并维护与 Activity 关联的每个视图的状态，最好坚持使用现有框架而不是考虑一些您必须通过复杂的实现来完成所有这些事情。如果您不需要在应用程序中处理任何这些事情，并且仅当您的整个应用程序中只有两个或三个屏幕时，您可以尝试切换视图。如果您有复杂的逻辑和创建这些视图所需的大量数据，即使基于您的视图的结构，这也不是一个好方法。如果您要添加更多视图，那么另一件事就是向您的应用程序说明功能负载需要处理的Activity会走高。在这种情况下，您将声明并初始化该特定 Activity 中的所有视图，因此维护所有这些视图实例很繁重。如果您想了解更多关于活动和任务的信息[参考这个链接](http://developer.android.com/guide/practices/ui_guidelines/activity_task_design.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:46:09.360

根据[开发人员文档](http://developer.android.com/reference/android/app/Activity.html#setContentView%28int%29)setContentView(int layoutResID) 用于

> 从布局资源中设置活动内容。资源将被膨胀，将所有顶级视图添加到活动中。

在最佳实践中，此方法用于`Activity`在启动时膨胀您的布局。这并不意味着如果您继续使用此方法，它将在未来引起问题。引用[这个](https://stackoverflow.com/questions/11429865/android-setcontentview-getviewinflate-inflate)问题的答案

> Activity 上的 setContentView 实际上调用了 Activity 使用的 Window 上的 setContentView，它本身所做的不仅仅是膨胀布局。

我建议您找到一种替代方法来切换布局，例如使用`ViewPager`with`Fragments`或其他一些 Tabbing 方法，但最终这一切都取决于您想要做什么。

[这个](https://stackoverflow.com/questions/6811989/android-switching-screens-with-new-activity-or-just-changing-content-view)问题也可能会给你你正在寻找的东西。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:44:41.747

好吧，每次您调用 setContentView() 时，您都必须再次找到所有布局，除了我认为您“可以”做到这一点。但正如[这里](https://stackoverflow.com/a/2072358/969325)所讨论的，这是**不明智**的，因为它显然违反了 android 指南。Commonsware 在[这里](https://stackoverflow.com/a/4758715/969325)也有一些非常重要的点，其中最重要的一点是，当您忘记清理视图中的内容等时，您很容易发生内存泄漏，而 Android 通常会为您处理这些内容。

简而言之，您应该遵循 Android 指南并使用[Fragments](http://developer.android.com/guide/components/fragments.html)或开始一个新的`Activity`.

# c# - 使用实体框架限制一对多

> ID：15519659
> 
> 赞同：0
> 
> 时间：2013-03-20T09:27:46.330
> 
> 标签：c#, entity-framework, linq-to-entities, ef-code-first

我有课：

```
public class Game
{
    [DatabaseGenerated(DatabaseGeneratedOption.Identity)]
    public Guid ID { get; set; }

    [InverseProperty("Game")]
    public virtual ICollection<GameMember> Members { get; set; }

    //...
}

public class GameMember
{
    [Key]
    [Column(Order = 0)]
    public Guid GameID { get; set; }

    [InverseProperty("Members")]
    [ForeignKey("GameID")]
    public virtual Game Game { get; set; }

    [Key]
    [Column(Order = 1)]
    public Guid UserID { get; set; }

    public virtual User User { get; set; }

    //...
} 
```

如您所见，我正在尝试制作一个简单的在线游戏。用户可以加入游戏（在这种情况下`GameMember`会创建一个新游戏）并进入大厅。当所有人都准备好后，比赛开始。我想知道是否有简单的方法来限制成员的数量。如果我可以应用一些属性，例如`[Max(4)]`to ，那就太好了`ICollection<GameMember> Members`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:31:57.790

不，这是不可能的——SQL 中没有等效的构造。
您将需要创建四个属性，每个允许的成员一个。

# c++ - Visual Studio 2010 中的 C++ Boost 错误 - errorLNK1104 和“不兼容的构建选项”

> ID：15519664
> 
> 赞同：0
> 
> 时间：2013-03-20T09:28:09.637
> 
> 标签：c++, visual-studio, visual-c++, boost

只需尝试构建从 Boost 教程复制和粘贴的代码。（见下文）

我只有头文件，目前还没有构建的库。

问题是我收到两个错误：

`Error 1 error LNK1104: cannot open file 'libboost_system-vc100-mt-gd-1_53.lib' \\selafap01\homedrives\mgibson\My Documents\Visual Studio 2010\Projects\C++ Boost Test\C++ Boost Test\LINK C++ Boost Test`

`2 IntelliSense: #error directive: "Incompatible build options" c:\boost\config\auto_link.hpp 111 4`

不管我做什么，它似乎都想要一个 .lib 文件，我真的不知道该怎么做。

```
#include <boost/asio.hpp>

class SimpleSerial
{
public:
/**
 * Constructor.
 * \param port device name, example "/dev/ttyUSB0" or "COM4"
 * \param baud_rate communication speed, example 9600 or 115200
 * \throws boost::system::system_error if cannot open the
 * serial device
 */
SimpleSerial(std::string port, unsigned int baud_rate)
: io(), serial(io,port)
{
    serial.set_option(boost::asio::serial_port_base::baud_rate(baud_rate));
}

/**
 * Write a string to the serial device.
 * \param s string to write
 * \throws boost::system::system_error on failure
 */
void writeString(std::string s)
{
    boost::asio::write(serial,boost::asio::buffer(s.c_str(),s.size()));
}

/**
 * Blocks until a line is received from the serial device.
 * Eventual '\n' or '\r\n' characters at the end of the string are removed.
 * \return a string containing the received line
 * \throws boost::system::system_error on failure
 */
std::string readLine()
{
    //Reading data char by char, code is optimized for simplicity, not speed
    using namespace boost;
    char c;
    std::string result;
    for(;;)
    {
        asio::read(serial,asio::buffer(&c,1));
        switch(c)
        {
            case '\r':
                break;
            case '\n':
                return result;
            default:
                result+=c;
        }
    }
}

private:
    boost::asio::io_service io;
    boost::asio::serial_port serial;
}; 
```

关于如何获取该 lib 文件的任何指示，因为它似乎并不在任何地方的 Boost 标头唯一目录中，计算机搜索也找不到任何东西.. 将不胜感激。

干杯

编辑1：

能够生成必要的 .lib 文件，但在 Visual Studio 命令提示符中导航 boost 目录并运行 bootstrap.bat，这会生成 b2.exe，我运行它并使用所需的二进制文件生成 stage/lib 目录。

但是，现在我收到另一个错误..“错误 LNK1561：必须定义入口点”

我猜错误的循环还在继续:)

编辑 2：被引用的入口点是 main()。忘记主线了！哦，好吧，添加了一个主要的，一切都很好！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:34:29.643

对于第一个错误：右键单击 VStudio 中的项目 -> 属性 -> 链接器 -> 常规 -> 附加库目录 "boost\stage\lib" 似乎您试图链接错误的文件夹。还要检查文件

```
libboost_system-vc100-mt-gd-1_53.lib 
```

位于 boost\stage\lib 文件夹中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:34:36.773

如果您在构建中进行静态链接，则需要安装 boost 并提供库。安装后，您将能够在 VS 项目配置中找到并指定库的路径。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-07-24T01:40:53.040

在我的情况下，发布模式运行良好，但调试模式显示此错误......

试试这个：右键单击 VStudio 属性中的项目 -> C/C++ -> 代码常规 -> 运行时库：将 /MT 更改为 /MTD。

# iphone - 将联系人添加到组时应用程序崩溃

> ID：15519665
> 
> 赞同：0
> 
> 时间：2013-03-20T09:28:10.643
> 
> 标签：iphone, objective-c, addressbook

我有一组联系人，当我尝试将联系人添加到组中时，它会使我的应用程序崩溃。这是我的代码：

```
for (int i = 0; i < [contactArray count]; i++)
{
    ABRecordRef newPerson =  [contactArray objectAtIndex:i];
    ABRecordSetValue(newPerson, kABPersonFirstNameProperty,name, &error);
    ABRecordSetValue(newPerson, kABPersonPhoneProperty, phone,nil);
    ABAddressBookAddRecord(iPhoneAddressBook, newPerson, &error);
    ABAddressBookSave(iPhoneAddressBook, &error);

    BOOL add = ABGroupAddMember(newGroup, newPerson, &error);
    if (add) {
        NSLog(@"added");
    }
} 
```

我的应用程序崩溃`ABRecordRef newPerson = [contactArray objectAtIndex:i];`

如何从数组中获取一个人的记录以将其添加到组中？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:34:24.637

利用：

```
ABRecordRef newPerson = (id)[contactArray objectAtIndex:i]; 
```

A`ABRecordRef`是一个`typedef`for `CFTypeRef`，而它又解析为`const void *`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:45:19.370

使用下面的代码并尝试：

```
CFArrayRef allPeople = ABAddressBookCopyArrayOfAllPeople(addressBookRef);

    CFIndex nPeople = ABAddressBookGetPersonCount(addressBookRef);
for (int i=0;i < nPeople;i++) {
 ABRecordRef ref = CFArrayGetValueAtIndex(allPeople,i);

        NSString *firstName, *lastName;
        ABMultiValueRef phones;
        firstName =(__bridge NSString *)(ABRecordCopyValue(ref, kABPersonFirstNameProperty));
        lastName  = (__bridge NSString *)(ABRecordCopyValue(ref, kABPersonLastNameProperty));
        phones = (ABMultiValueRef)ABRecordCopyValue(ref, kABPersonPhoneProperty);
 }
    CFRelease(allPeople); 
```

# c# - MongoDB 按 id 选择行并获取字段（在 c# 中）

> ID：15519668
> 
> 赞同：1
> 
> 时间：2013-03-20T09:28:17.000
> 
> 标签：c#, mongodb

你能帮我用c#查询吗？

我在 MongoDB 中有集合“测试”。

在这个集合中，每个 BsonDocument 都有 1 个自定义字段“FCount”。
在 C# 中，我有他采用 _id 的方法。

我在 Mongo 控制台中创建了正确的查询

```
db.Test.find({_id: "1bvg4223"},{FCount: 1, _id: null}).pretty() 
```

但在 C# 中：

```
database.GetCollection("Test").Find(Query.EQ("_id", "1bvg4223")) 
// I don`t know how i can get field "FCount" in this query 
```

所以我的问题是：如何在 C# 方法中获取 FCount？

# cookies - herokuapp.com 上的 Heroku 应用程序中的 cookie 是否安全？

> ID：15519671
> 
> 赞同：4
> 
> 时间：2013-03-20T09:28:20.273
> 
> 标签：cookies, heroku, cross-domain

我正在开发一个应用程序，我将部署在 Heroku 上。该应用程序仅`iframe`在另一个站点上使用，因此我不在乎域名。我计划在 上部署我的应用程序，`example.herokuapp.com`而不是在`example.com`.

我的应用程序使用 cookie，我想确保其他人无法操纵我的 cookie 以保护我的应用程序免受[会话固定](http://en.wikipedia.org/wiki/Session_fixation)和类似攻击。如果`attacker.herokuapp.com`能够为 设置 cookie `herokuapp.com`，浏览器将无法保护我，因为`herokuapp.com`它不是[公共后缀](http://publicsuffix.org/)。有关该问题的详细说明，请参阅[http://w2spconf.com/2011/papers/session-integrity.pdf](http://w2spconf.com/2011/papers/session-integrity.pdf)。

我的问题是：当浏览器无法保护我的用户时，Heroku 会通过阻止 cookie 来做到这一点`herokuapp.com`吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-12-26T23:19:14.827

只是想为像我一样遇到这个问题的任何人发布更新。我正在研究一个类似的问题，除了我想有目的地允许从两个不同的 heroku 应用程序访问同一个 cookie。

“herokuapp.com”和“herokussl.com”现在位于[Public Suffix List](http://publicsuffix.org/list/)中，因此如果为这些域之一设置了cookie ，它们*应该是安全的。*我最终不得不使用自定义域来在两个应用程序之间共享 cookie。

Heroku 还发布了一篇关于该主题的文章：[https ://devcenter.heroku.com/articles/cookies-and-herokuapp-com](https://devcenter.heroku.com/articles/cookies-and-herokuapp-com)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:28:20.273

我只是尝试从我的 Heroku 应用程序中添加一个带有响应头的 cookie，但`Set-Cookie: name=value;Path=/;Domain=.herokuapp.com`令我失望的是，我可以在浏览器中看到完整的头。因此 Heroku 基础设施不会检测和删除这个跨应用超级cookie。

我看到了三种可能的方法来保护 Heroku 应用程序免受跨应用程序超级cookies：

*   根本不要使用cookies。
*   使用自定义域。
*   验证每个 cookie 是否确实由您的应用程序设置，并通过检查[header](https://devcenter.heroku.com/articles/http-routing#heroku-headers)[将`X-Forwarded-For`](https://devcenter.heroku.com/articles/http-routing#heroku-headers)其限制为客户端的 IP 地址。

我对 Heroku 的功能请求是他们应该过滤通过其 HTTP 路由的 HTTP 响应，以便托管在其基础架构上的应用程序无法使用`Domain=herokuapp.com`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T17:53:24.997

在我看来，只要您将 cookie 设置为`example.herokuapp.com`，那么 cookie 就不会被操纵。cookie 只会呈现给正在运行的应用程序`example.herokuapp.com`和`herokuapp.com`（没有运行应用程序的地方）。

# jvm - 使用 SNMP 监控 JVM

> ID：15519673
> 
> 赞同：3
> 
> 时间：2013-03-20T09:28:20.393
> 
> 标签：jvm, snmp, mib, snmp4j

我正在使用 snmp 来监控一些服务器（主要是 win2k3），在我上网的过程中，我发现了一个由 Oracle 完成的 MIB，用于监控 JVM，JVM-MANAGEMENT-MIB。到目前为止我所做的是：

*   使用 snmp.acl 和 management.properties 配置 JVM
*   用 mibcc 编译 JVM-MANAGEMENT-MIB 并替换 mib.bin。

有了这些步骤，我想我可以尝试一下。所以我用 snmp4j 制作了一个 java 程序，当我尝试从 JVM mib 调用 OID 时，我得到了一个错误`Request timed out`。奇怪的是，我只编译 JVM-MANAGEMENT-MIB，所以我应该只能访问那些 OID，对吧？但事实并非如此，我仍然可以访问 cpu 使用情况、进程数......

那么我错过了什么？谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-24T14:50:55.313

将以下三个参数添加到 JVM，它应该是你所需要的。

```
-Dcom.sun.management.snmp.interface=127.0.0.1 \
-Dcom.sun.management.snmp.acl=false \
-Dcom.sun.management.snmp.port=16500 \ 
```

好吧，您不需要编写 java 程序来验证它是否有效。net-snmp 或一些 MIB 浏览器就足够了。

```
snmpwalk -v2c -c public 127.0.0.1:16500 SNMPv2-SMI::enterprises.42.2.145.3.163.1.1.4

SNMPv2-SMI::enterprises.42.2.145.3.163.1.1.4.2.0 = STRING: "Java HotSpot(TM) 64-Bit Server VM"
SNMPv2-SMI::enterprises.42.2.145.3.163.1.1.4.3.0 = STRING: "Sun Microsystems Inc."
SNMPv2-SMI::enterprises.42.2.145.3.163.1.1.4.4.0 = STRING: "20.10-b01"
SNMPv2-SMI::enterprises.42.2.145.3.163.1.1.4.5.0 = STRING: "Java Virtual Machine Specification"
SNMPv2-SMI::enterprises.42.2.145.3.163.1.1.4.6.0 = STRING: "Sun Microsystems Inc." 
```

# ipc - 异步通知管理

> ID：15519674
> 
> 赞同：0
> 
> 时间：2013-03-20T09:28:24.007
> 
> 标签：ipc

我编写了两个通过使用 SIGIO 执行 IPC 的守护进程。但是，有时在完成重要操作时将控制权转移到 signal_handler，这些操作可以被视为原子操作。有没有办法让我指定*在循环的当前迭代完成之前，我们不会将控制权转移到 signal_handler 函数*？

提前致谢

注意：我使用的是 Linux

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T14:51:06.537

我不知道是否有更好的方法可以做到这一点，但我做了以下事情：

我在函数 sigio_handler 中将全局变量 sigio_rec 设置为 true，sigio_handler 是我在 sigaction() 中注册的函数，以便在引发 SIGIO 时调用。在每个循环结束时，程序检查 sigio_rec 是否为真，如果是，则从套接字检索数据并继续。

--ttfn

# jsf - 通过 PrimeFaces p:idleMonitor 超时

> ID：15519675
> 
> 赞同：2
> 
> 时间：2013-03-20T09:28:24.443
> 
> 标签：jsf, primefaces, idle-timer

我正在尝试通过 primefaces 组件 idlemonitor 处理会话[超时](https://www.primefaces.org/showcase/ui/misc/idleMonitor.xhtml)。

我这样做是因为我需要让用户知道由于不活动而会话已过期。我需要通过对话框显示此消息，在他关闭对话框后，他应该被重定向到登录页面。他应该无法单击“返回”并浏览应用程序，就像什么也没发生一样；如果他点击“返回”，他应该被重定向到 sessionexpired.xhtml 页面。

我将**idleMonitor**放在了我的**loggedintemplate.xhtml**中，所以它只有在您登录时才有效，无论在哪个页面上，因为我所有的页面，在您登录后，都来自于**loggedintemplate.xhtml**。

这就是我的**logintemplate.xhtml**中的代码的样子：

```
<p:idleMonitor timeout="6000" onidle="idleDialog.show()" />

<p:dialog header="Timeout" resizable="false" closable="false" 
          widgetVar="idleDialog" modal="true">
    <p:panel styleClass="noborderpanel">
        <p:panelGrid columns="1" styleClass="adressegrid">
            <p:outputLabel value="Session has expired due to inactivity" />
                    <p:commandButton action="#{loginController.timeout()}"
                        value="Ok" />
        </p:panelGrid>
    </p:panel>
</p:dialog> 
```

所以这段代码的功能基本上是检查用户是否在 6 秒内处于非活动状态，如果他处于非活动状态，则会弹出一个不可关闭的对话框并告诉他会话已过期。

方法**loginController.timeout()**应该注销用户，使会话无效等。

我的问题是我不知道如何使会话无效，如何注销用户等。如果我使用`FacesContext.getCurrentInstance().getExternalContext() .invalidateSession();` 它会使会话无效，但我需要更多。例如，如果用户处于非活动状态超过 30 分钟（默认 JavaEE 超时时间），我会收到 nullPointerException。

我想“手动”处理超时，有没有办法禁用默认的 JavaEE 超时？

手动处理超时的最佳方法是什么，而不是这样：

```
<session-config>
    <session-timeout>20</session-timeout>
</session-config>   
<error-page>
    <exception-type>javax.faces.application.ViewExpiredException</exception-type>
    <location>/expired.xhtml</location>
</error-page> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T10:26:04.200

我找到了一个很好的解决方案，我不必处理 NPE。

以下场景：

如果用户空闲超过 6 秒，则会话通过 ajax 无效，无需用户交互。这意味着，即使用户空闲超过 20 分钟，会话已经无效，我不必处理 NPE。

6 秒后会生成一个对话框（通过 javascript 警报），并让用户知道他在一段时间内处于非活动状态并且会话已过期。对话框关闭后，用户被重定向到登录页面。

顺便说一句，我只用了 6 秒来进行测试。我的默认设置是：

*   **空闲监视器：** 30 分钟
*   **web.xml：** 40 分钟（只是为了确保会话始终手动失效，并且用户可以看到带有会话过期信息的对话框）

该解决方案完全符合我的要求。

**空闲监视器的代码：**

```
<!-- language: lang-xml -->

<p:idleMonitor timeout="1800000" >
    <p:ajax event="idle" listener="#{loginController.timeout()}" oncomplete="alert('Session expired etc.')"/>
</p:idleMonitor> 
```

**loginController.timeout() 的代码：**

```
public void timeout() throws IOException {
    FacesContext.getCurrentInstance().getExternalContext()
            .invalidateSession();
    FacesContext.getCurrentInstance().getExternalContext()
            .redirect("...loginpage.xhtml");

} 
```

# highcharts - 将 highcharts xaxis etremes 转换为 yaxis 极值

> ID：15519676
> 
> 赞同：0
> 
> 时间：2013-03-20T09:28:35.727
> 
> 标签：highcharts

我的页面上有两个 highcharts。条形图和柱形图。柱形图 xaxis 有 50 个类别。条形图 y 轴也有 50 个类别。当我放大柱形图时，条形图的 y 轴不会以相同的方式缩放。

我发现它与缩放给出的值有关。那么有没有办法将 xaxis 极值转换为 yaxis 极值，以便我的 zoomin 在两个图表上都相同？

这就是我设置极端的方式：

```
events: {
                selection: function (event) {
                    var xMin;
                    var yMin;
                    var xMax;
                    var yMax;
                    if (event.xAxis) {
                        xMin = event.xAxis[0].min;
                        xMax = event.xAxis[0].max;
                        yMin = xMin;
                        yMax = xMax;
                        if (incomeChart != undefined)
                            incomeChart.xAxis[0].setExtremes(xMin, xMax, true);
                        if (timeLine != undefined)
                            timeLine.yAxis[0].setExtremes(xMin, xMax, true); 
```

# bash - 根据bash中的索引匹配值

> ID：15519682
> 
> 赞同：1
> 
> 时间：2013-03-20T09:28:47.867
> 
> 标签：bash, indexing

我想知道在 bash 中是否有一种优雅的方式来执行以下操作：

我需要检查一个列表的某个值，我们称之为“1”。对于我找到这个值的每个条目，我需要在另一个列表中累积一个匹配的字符串（具有相同的索引），并最终将其打印出来。

例如：让我们假设值列表是`"1 0 1 1 "`

字符串列表是`"What a wonderful day"`

所以输出字符串将是`"What wonderful day"`

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:41:10.423

这是我提出的解决方案：

```
#!/bin/sh
myMatch=1 #This is the value you're looking for
myString="What a wonderful day";
myList=( $myString ) #String to Array conversion
count=0;
for i in $@; do #Iterate over the input parameters
    if [ $i -eq $myMatch ]; then
        echo -n "${myList[$count]} " #use -n to avoid newline and append space as a separator
        count=$(($count+1))
    fi
done 
```

所以调用给出值列表的脚本：

```
$ . myScript.sh 1 0 1 1 
```

你有想要的结果。

# matlab - Matlab：将长度不同的向量添加到矩阵中

> ID：15519685
> 
> 赞同：1
> 
> 时间：2013-03-20T09:28:52.233
> 
> 标签：matlab, vector, matrix, concatenation

是否可以为矩阵自动添加长度不同的向量？

IE：

```
a = [1 2 3 4]
b = [1 2] 
```

我怎样才能使 C 成为：

```
c = [1 2 3 4 ; 1 2 0 0] 
```

或者

```
c = [1 2 3 4 ; 1 2 NaN NaN] 
```

或类似的东西

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:40:14.263

这可能会有所帮助

```
a = [1 2 3 4];
b = [1 2];
c = a;
c(2,1:length(b)) = b;

c =

 1     2     3     4
 1     2     0     0 
```

然后，如果您宁愿拥有而`NaN`不是`0`，您可以按照 Dennis Jaheruddin 在下面的评论中的建议进行操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:35:50.843

做一个这样的功能

```
function out = cat2(a, b)

    diff = length(a) - length(b)
    if diff > 0
        b = [b, nan(1, diff)];
    else
        a = [a, nan(1, -diff)];
    end

    out = [a;b];

end 
```

（但也添加一个检查来处理列向量）

```
cat2([1 2 3 4], [1 2])

ans =

     1     2     3     4
     1     2   NaN   NaN 
```

# java - Neo4j 通过休息执行密码查询

> ID：15519688
> 
> 赞同：0
> 
> 时间：2013-03-20T09:29:11.567
> 
> 标签：java, rest, neo4j, cypher

早上好，我建立了一个本地 Neo4j 数据库，并想对 maven 依赖关系图进行建模。当我通过 webconsole 执行以下语句时，一切正常：

```
start root = node(1)
create unique root -[:ROOT]-> (n{groupId:'fancyStuff',artifactId:'somewhat', version:'1.4'})
return n 
```

（注意：rootnode 用于调试目的，稍后将替换为实际结构）因此，这里一切正常，无论我使用多少空格或将 ' 替换为 "

在我的 java 应用程序中，我具有以下功能：

```
private static URI getOrCreate(Artifact artifact){
        String cypherUri = SERVER_ROOT_URI + "cypher";

        String cypherStatement="{\"query\" : \"start x  = node(1) " +
                "create unique x -[:ROOT]-> (artifact{groupId:\"" + artifact.getGroupID() +
                "\", artifactId:\"" + artifact.getArtifactID() +
                "\", version: \"" + artifact.getVersion() +
                "\"}) return artifact ,\"params\" : {}}";

        WebResource resource = Client.create()
                .resource( cypherUri );
        ClientResponse response = resource.accept( MediaType.APPLICATION_JSON_TYPE )
                .type( MediaType.APPLICATION_JSON_TYPE )
                .entity( cypherStatement )
                .post( ClientResponse.class );

        System.out.println( String.format( "POST to [%s], status code [%d]",
                cypherUri, response.getStatus() ) );

        response.close();
        return response.getLocation();
    } 
```

所以基本上我发布了一个看起来像的 json 文件

```
{"query" : "start root = node(1) create unique root-[:ROOT]->(artifact{groupId:'{"query" : "start root = node(1) create unique root-[:ROOT]->(artifact{groupId:'lol',artifactId:'somewhat',version:'1.4'}) return artifact","params" : {}} 
```

同样，无论我使用什么空格或“/”，我都会收到 http 500 错误，表示关系的第一个 - [:ROOT]-> 无效。

直接通过发布新节点

```
final String nodeEntryPointUri = SERVER_ROOT_URI + "node";
WebResource resource = Client.create().resource( nodeEntryPointUri );
ClientResponse response = resource.accept( MediaType.APPLICATION_JSON_TYPE )
         .type( MediaType.APPLICATION_JSON_TYPE )
         .entity( /*some json*/)
         .post(ClientResponse.class); 
```

（免责声明：我会尽快将参数移动到正确的位置这个版本工作;））

我可以打赌这是一个完全微不足道的错误，但我现在盯着这个超过半个工作日，我的任何变化都不想工作。如果有人知道答案，那就太棒了。

问候，弗洛里安·罗姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T08:04:03.423

好的，我不知道这个语句有什么不同，但这有效（我也尝试了上面代码中的参数拆分）：

```
String cypherUri = SERVER_ROOT_URI + "cypher";        
JSONObject jObject = new JSONObject();
        try {
            Map<String, String> params = new HashMap<String, String>();
            params.put("groupId", artifact.getGroupID());
            params.put("artifactId", artifact.getArtifactID());
            params.put("version", artifact.getVersion());
            String query = "start x  = node(1) create unique x-[:ROOT]->(n{groupId:{groupId},artifactId:{artifactId},version:{version} }) return n";
            jObject.put("query", query);
            jObject.put("params", params);
        } catch (Exception e) {
            e.printStackTrace();
        }

        WebResource resource = Client.create()
                .resource( cypherUri );
        ClientResponse response = resource.accept( MediaType.APPLICATION_JSON_TYPE )
                .type(MediaType.APPLICATION_JSON_TYPE)
                .entity(jObject.toString())
                .post(ClientResponse.class); 
```

但无论如何，第二次尝试更好，我不会抱怨 :D 它只是让我不知道那里发生了什么......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T11:23:08.687

问题是您的 JSON 无效。你重复`query`两次。如果删除星星之间的部分，它会起作用吗？

```
**{"query" : 
    "start root = node(1) 
    create unique root-[:ROOT]->(artifact{groupId:'**
{"query" : "start root = node(1) 
  create unique root-[:ROOT]->(artifact{groupId:'lol',artifactId:'somewhat',version:'1.4'}) 
  return artifact",
 "params" : {}
} 
```

# visual-studio-2010 - 在 Visual Studio 中使用 QT3D 库时出现 C4272 错误

> ID：15519689
> 
> 赞同：0
> 
> 时间：2013-03-20T09:29:18.697
> 
> 标签：visual-studio-2010, qt3d

我正在使用 microsoft visual studio 2010 开发应用程序。此外，我使用 QT3D 库作为外部库。

QT 3D 库已成功安装并与 Visual Studio 集成。我知道这一点，因为我可以编译和运行这些示例。

但是当我尝试编写自己的代码时，Visual Studio 编译器给了我以下错误

```
 c4272 : 'function' : is marked __declspec(dllimport); must specify native calling convention when importing a function. 
```

对于库头文件中的类中存在的每个成员函数，都会收到数百次错误消息。

我怀疑，这个问题与图书馆的链接有关。在附加包含文件中，路径给出如下

```
"$(QTDIR)\include";"$(QTDIR)\include\Qt3D";"$(QTDIR)\include\QtGui";"$(QTDIR)\include\QtCore";".moc\debug_shared";$(QTDIR)\mkspecs\win32-msvc2010;%(AdditionalIncludeDirectories) 
```

当我包含头文件时，自动完成选项可以检测到这些库。

附加库文件路径如下。

```
$(QTDIR)\lib;C:/qt/5.0.1-x64/qtbase/lib;%(AdditionalLibraryDirectories) 
```

有任何想法吗？

最好的问候 tdk。

# ios - iphone 5屏幕编码

> ID：15519690
> 
> 赞同：-2
> 
> 时间：2013-03-20T09:29:21.493
> 
> 标签：ios, objective-c, uitableview, iphone-5

我参加了一个通用项目。我已经为 iPhone 5 屏幕编码，但它没有检测到它。

```
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad) {
    //ui for ipad
}
else if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone) {
    CGRect screenBounds = [[UIScreen mainScreen] bounds];
    if (screenBounds.size.height == 568) {
        tableView.frame = CGRectMake(0, 40, 320 ,508);
    }
    else {
        tableView.frame = CGRectMake(0, 40, 320 ,420);
    }
} 
```

但它不起作用。当我在 iPhone 5 **screenBounds = 320*480**上调试代码时。

我哪里错了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:35:07.143

检测iPhone5屏幕就是这么简单，写就行

`#define IS_IPHONE5 (([[UIScreen mainScreen] bounds].size.height-568)?NO:YES)`

在您的 .pch 文件中......您可以进一步检查 iPhone5 屏幕，如`if(IS_IPHONE5)`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:34:21.323

`UITableView`从 IB 中选择您的并选择`Retina 4`所有屏幕的大小，甚至是主窗口 xib 文件。即使在 iphone 4 上也能正常工作。

![在此处输入图像描述](../Images/f2c6247adb71abe887dc4ee8886f0119.png)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T11:20:22.437

这段代码对我来说很好

```
 #define IS_IPHONE_5 ( fabs( ( double )[ [ UIScreen mainScreen ] bounds ].size.height - ( double )568 ) < DBL_EPSILON )

    if (IS_IPHONE_5)
        {
 //iphone 5
    } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T09:41:42.337

您为 iphone 5.Default-568h@2x.png 文件添加启动画面，然后它的工作正常

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T09:34:04.413

尝试使用它来检测 iPhone 5：

```
if (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)
{
   CGSize theHeight = [[UIScreen mainScreen] bounds].size;
   if(theHeight.height == 568) {
        // iPhone 5
        tableView.frame = CGRectMake(0, 40, 320 ,508);
   }
   else {
        // iPhone 4
        tableView.frame = CGRectMake(0, 40, 320 ,420);
   }
} 
```

或者，您可以定义这个：

```
#define IS_IPHONE5 (([[UIScreen mainScreen] bounds].size.height-568)?NO:YES) 
```

您可以在需要确定它是否是 iPhone 5 时重复使用它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T09:34:41.700

试试这个代码::

```
if ([[UIScreen mainScreen] bounds].size.height == 568)
{
    [tableView setFrame:CGRectMake(0, 40, 320 ,508)];
}
else if ([[UIScreen mainScreen] bounds].size.height == 480)
{
    [tableView setFrame:CGRectMake(0, 40, 320 ,420)];
} 
```

希望，它会帮助你。

谢谢。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T09:32:53.160

我使用此代码检查 iPhone 5 设备。

```
float scrnheight = [[UIScreen mainScreen] bounds].size.height ;

if(scrnheight == 568.0f)
{
    self.isIphone5 = true;
} 
```

# c# - 实体框架、工作单元和生成的插入语句的顺序

> ID：15519694
> 
> 赞同：1
> 
> 时间：2013-03-20T09:29:31.430
> 
> 标签：c#, entity-framework, orm, unit-of-work

我在使用存储库和工作单元模式将对象添加到底层持久性存储（MS SQL Server 2012）时遇到问题。问题是一旦提交，生成的插入语句的顺序就会错误，因此它们会由于外键约束而失败。

想象一下，我们想一次性创建带有订单行的客户、地址、帐户和订单（单次提交）：

```
using (var tx = new TransactionScope())
{
    var address = new Address(...);
    _addressRepository.Add(address);

    var customer = new Customer(...);
    customer.AssignLegalAddress(address.Id);
    _customerRepository.Add(customer);

    var account = new Account(..., customer.Id);
    _accountRepository.Add(account);

    var order = new Order();
    order.AssignBuyerAccount(account.Id);
    order.AddOrderLine(...);
    order.AddOrderLine(...);

    _orderRepository.Add(order);

    _unitOfWork.Commit();
    tx.Complete();
} 
```

所以为了让客户承诺，地址应该先承诺，客户在账户之前，最后是账户在订单之前。所以我在不同的存储库上调用 Add 的顺序。

上面的存储库首先使用下面的 Entity Framework 5.0 代码，每个添加操作归结为将实体添加到底层 DbContext。我们可以把它翻译成：`DbContext.Set<TEntity>().Add(entity)`. 对 Commit 的调用基本上是调用 DbContext.SaveChanges()。

问题是 EF 似乎并不关心它们的添加顺序。在 Commit 上监视发送到底层存储的查询时，我看到首先创建了地址，到目前为止一切都很好，但是随后执行了创建帐户的插入语句。这会失败，因为尚未创建客户。

有没有办法让 EF 在保存更改时考虑我们添加它们的顺序？否则我将不得不手动提交更改，例如：

```
using (var tx = new TransactionScope())
{
    var address = new Address(...);
    _addressRepository.Add(address);

    _unitOfWork.Commit();

    var customer = new Customer(...);
    customer.AssignLegalAddress(address.Id);
    _customerRepository.Add(customer);

    _unitOfWork.Commit();

    var account = new Account(..., customer.Id);
    _accountRepository.Add(account);

    _unitOfWork.Commit();

    var order = new Order();
    order.AssignBuyerAccount(account.Id);
    order.AddOrderLine(...);
    order.AddOrderLine(...);

    _orderRepository.Add(order);

    _unitOfWork.Commit();
    tx.Complete();
} 
```

但这似乎不是一个最佳解决方案。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:36:06.547

如果要插入实体，则 EF 将插入整个图。

```
// Build graph
var customer = new Customer(...);
customer.LegalAddress = new Address(...);
var account = new Account();
account.Customer = customer;
var order = new Order();
order.BuyerAccount = account;
// Here all Navigation properties updated
// and state of all entities set to Added
_orderRepository.Add(order); 
// Here all entities inserted in transaction, PK and FK updated
context.SaveChanges(); 
```

当您只需要插入图形的一部分时，复杂性就开始了。然后你应该手动设置图中实体的状态。

# matlab - matlab - 查找值超过阈值 n 次时的索引

> ID：15519695
> 
> 赞同：0
> 
> 时间：2013-03-20T09:29:33.793
> 
> 标签：matlab, find

我想找到数组超过某个值时的索引，并且这个值是超过持续时间 n 的值。举些例子：

```
n = 5;
dat = [1,2,2,1.5,2,4,2,1,1,3,4,6,8,4,9]; 
```

在这里，我想找到“dat”第一次超过 2 且持续时间大于 n 的时间。因此，这里的解决方案应该会导致答案：

```
ans = 10 
```

另一个例子：

```
n = 7;
dat = [1,1,2,3,4,5,6,7,8,9,9,6,4,3,2,4,6,7,7,5]; 
```

找出 'dat' 第一次超过或等于 5 超过或等于 n 次。

答案 = 6

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:46:16.563

```
n = 5;
m = 2;
dat = [1,2,2,1.5,2,4,2,1,1,3,4,6,8,4,9];

c = conv(double(dat >= m), ones(1, n))
%I think you can also do
%  c = conv((dat >= m)*1, ones(1, n))

min(find(c == n)) - n + 1 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:49:57.040

```
n=5
x=2;
dat = [1,2,2,1.5,2,4,2,1,1,3,4,6,8,4,9];
vec= cumsum(dat>=x);
ind=find(vec>=n);
ind=dat(ind(1)); 
```

`ind`将包含答案 10

# google-drive-api - 处理 Google Drive 中的令牌

> ID：15519697
> 
> 赞同：0
> 
> 时间：2013-03-20T09:29:43.930
> 
> 标签：google-drive-api

我浏览了有关如何将文件上传到 Google Drive（适用于 Android）的快速入门，一切正常。但是，尚不清楚我是否负责存储令牌并在它们过期时处理异常。快速入门中使用的 SDK 代码是否会在幕后为我处理这个问题？：

[https://developers.google.com/drive/quickstart-android](https://developers.google.com/drive/quickstart-android)

如果我经常调用此代码（取自快速入门）：

```
credential = GoogleAccountCredential.usingOAuth2(this, DriveScopes.DRIVE);
credential.setSelectedAccountName(accountName);
service = getDriveService(credential); 
```

然后调用一些驱动方法，它最终会在令牌过期时产生异常还是SDK代码在内部捕获这个并自动尝试检索刷新的令牌？

更具体地说，我是否需要实现此处显示的代码：

[https://developers.google.com/drive/credentials](https://developers.google.com/drive/credentials)

我也不清楚访问令牌和刷新令牌之间的区别。然后是“短期”令牌和“长期”令牌。有点混乱。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-24T00:49:59.727

在 Android 上，当您使用 Google Play 服务时，所有工作都会为您处理，包括获取令牌和刷新它。您已链接的快速入门指南中对此进行了说明，您无需执行任何其他操作。

# paypal - 贝宝市场卖家

> ID：15519698
> 
> 赞同：2
> 
> 时间：2013-03-20T09:29:54.290
> 
> 标签：paypal

我正在努力为小型市场网站选择正确的 Paypal 解决方案。

该网站有许多供应商，客户直接从他们那里购买。没有佣金或复杂性 - 付款是直接的，买家到供应商。

我突然想到，虽然我是商人，但我不是最终的资金接收者——所以我不知道如何才能做到这一点。我想使用 Express，但我不确定是否可以将资金接收方设置为第三方帐户。

我不想使用自适应。我之前尝试过，但它缺少一些功能（主要与验证地址、列出发票项目的能力等有关）。

我还想到，如果买家 A 通过网站向供应商 B 发送信息，那么就没有 IPN，因为商家不是最终收件人。

真的，我正在寻找正确的方法来为此部署可靠的 Paypal 解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:48:53.310

您可以为此使用 Express Checkout。他们的供应商只需向您的 API 用户名授予 API 权限，以便您的用户名有权在他们的帐户上执行 Express Checkout API 调用。这将允许您直接处理其 PayPal 帐户上的交易。您还可以在您希望将 IPN 发送到的 API 调用中传递 IPN URL。此外，通过在 API 调用中传递它，它将覆盖帐户中为您传递它的特定交易而设置的一组。这样，商家/供应商仍然可以将他们可能在其帐户中设置的那个用于其他用途。

# xcode - 如何在 ios 的 uiscrollview 中将图像显示为类似 gridview 的格式？

> ID：15519700
> 
> 赞同：0
> 
> 时间：2013-03-20T09:30:01.623
> 
> 标签：xcode, gridview, ios6, uiscrollview

刚刚进入 ios devlopement 的一周，我面临一些问题，我无法以 gridview 格式在 scrollview 中显示图像...我不知道如何设置帧大小以以正确的 gridview 格式显示图像..

这是我的代码

在滚动视图中添加 5 个图像

```
for(int i=1;i<6;i++)
            {
                UIImageView *image = [[UIImageView alloc] initWithFrame:CGRectMake(x+0, 0, 320, 460)];
                [image setImage:[UIImage imageNamed:[NSString stringWithFormat:@"e1%d.png",i]]];
                [scr addSubview:image];
                x+=320;
                UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(handleSingleTap:)];
                tapGesture.numberOfTapsRequired = 1;
                tapGesture.delegate = self;
                image.userInteractionEnabled = YES;
                [image addGestureRecognizer:tapGesture];
            }

            scr.pagingEnabled=YES;
            scr.contentSize = CGSizeMake(320*5, 300);
            [self.view addSubview:scr]; 
```

但是所有 5 张图像都显示在一条水平线上，但我想在每行 2 幅图像中显示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:40:32.927

here is the solution, i've implemented it in my app. Here is my code sv_port is my scrollView. Download SDWebImageDownloader class files and import it in your project. Add relevant framework in your project. like imageIO.framework, QuartzCore

if your images are not fetching from url, then u dont need to use asyncImage view., so dont need to download SDWebImageDownloader.

Now, in your .m add

```
#import "UIImageView+WebCache.h"
#import "SDImageCache.h"
#import "SDWebImageCompat.h"

//function for adding image in your scrollview
-(void)populateImages
{
   int x=6,y=6;

   for(UIView * view in sv_port.subviews)
   {
      if([view isKindOfClass:[UIImageView class]])
      {
          [view removeFromSuperview]; view = nil;
      }
      if([view isKindOfClass:[UIButton class]])
      {
          [view removeFromSuperview]; view = nil;
      }
   }

   for(int p=0;p<[Manufacturer count];p++)
   {
      UIButton *btnImageButton = [UIButton buttonWithType:UIButtonTypeCustom];
      btnImageButton.frame = CGRectMake(x,y,70,70);
      [btnImageButton setTag:p];
      [btnImageButton addTarget:self action:@selector(nextview:)    forControlEvents:UIControlEventTouchUpInside];

      UIActivityIndicatorView *spinny = [[UIActivityIndicatorView alloc] initWithActivityIndicatorStyle:UIActivityIndicatorViewStyleGray];
   spinny.frame=CGRectMake(btnImageButton.frame.origin.x+25,btnImageButton.frame.origin.y+25, 20, 20);
      spinny.backgroundColor=[UIColor clearColor];
      [spinny startAnimating];

      [sv_port setScrollEnabled:YES];
      [sv_port addSubview:spinny];

      UIImageView *asyncImageView = [[[UIImageView alloc] initWithFrame:btnImageButton.frame] autorelease];
      asyncImageView.backgroundColor=[UIColor clearColor];
      CALayer *layer;
      layer = asyncImageView.layer;
      layer.borderWidth = 0.5;
      layer.cornerRadius = 5;
      layer.masksToBounds = YES;

      [asyncImageView setImageWithURL:[NSURL URLWithString:[NSString stringWithFormat:@"%@", yourUrl] ]   placeholderImage:[UIImage imageNamed:nil] options:0 andResize:CGSizeMake(btnImageButton.frame.size.width,btnImageButton.frame.size.height) withContentMode:UIViewContentModeScaleAspectFit];
      asyncImageView.contentMode = UIViewContentModeScaleAspectFit;

      [sv_port addSubview:btnImageButton];
      [sv_port addSubview:asyncImageView];
      int imgCntPort=0;

      imgCntPort=(sv_port.frame.size.width/(asyncImageView.frame.size.width));

      //NSLog(@"imgport %d",imgCntPort);
      if((p+1)%imgCntPort==0)
      {
         x=5;
         y=y+80;
      }
      else
      {
         x=x+80;
      } 
    }
    sv_port.contentSize = CGSizeMake(0, y);
    glob_x =0; glob_y =y;
} 
```

By this code you will get 4 images in a row., By the change co-Ordiante of x and y you can maintain number of images per row to display.

Hope this helps. Thanks

# python - 检查应用程序是在服务器上还是在本地运行

> ID：15519701
> 
> 赞同：1
> 
> 时间：2013-03-20T09:30:03.723
> 
> 标签：python, environment-variables, development-environment, cherrypy, production-environment

我的应用程序使用`Python`with`cherrypy`来提供 Web 服务。我想设置一个不同的配置文件，这取决于我的应用程序是在我的本地机器上还是在我的远程服务器上启动的。

有什么简单的方法可以检查我的应用程序是从服务器启动还是在本地计算机上启动？如果没有，也许我可以在运行时传递一些参数，`python myApp.py`然后`myApp.py`将其传递给`myApp.py`？当然，自动解决方案会更好。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:44:34.070

创建一个本地配置文件并在其中放置一个名为的变量`environment`。将其分配`dev`给本地环境和`production`生产，以及您想要的任何其他内容。只需设置一次，然后在任何地方重复使用 -

```
from local_settings.py import environment
if environment == 'dev':
    debug = True
    # anything you'd like 
```

如果您使用任何 VCS（如 git）并使用它进行部署，请忽略该`local_settings.py`文件。本地设置文件也可以方便地保存不应在任何 VCS 存储库中公开的敏感数据，例如 API 密钥等。

# java-ee-6 - 为什么添加 CDI 扩展时 @Inject 会失败？

> ID：15519706
> 
> 赞同：0
> 
> 时间：2013-03-20T09:30:31.370
> 
> 标签：java-ee-6, cdi, scopes

我正在尝试编写 CDI 扩展。一旦我添加 META-INF/services/java.enterprise.inject.spi.Extension 文件，所有注入都失败并显示消息`WELD-001408 Unsatisfied dependencies for type...`。奇怪的是，扩展文件也可以是空的，这个错误仍然会发生。当我删除文件时，一切都按预期工作。

我正在使用 Glassfish 1.3.2.2。

有谁知道为什么会这样？我在谷歌上没有找到任何东西。

//编辑：代码示例

我有一个 REST 资源，我将一个类 SomeClass 注入到该资源中（参见示例）

```
@Path("test")
@Produces("text/plain")
public class SomeResource{
    @Inject private SomeClass someclass;
} 
```

`META-INF/services/java.enterprise.inject.spi.Extension`当- 文件不存在时，这完全正常。添加文件后，我立即收到`WELD-001408 Unsatisfied dependencies...`异常。即使文件为空。这是玻璃鱼虫吗？

# c++ - GSSAPI 获取用户名密码和构建凭证不适用于非登录用户

> ID：15519710
> 
> 赞同：3
> 
> 时间：2013-03-20T09:30:41.933
> 
> 标签：c++, kerberos, gssapi

我正在开发一个使用 GSSAPI 登录服务器的 C++ 客户端。对于凭证，我使用 gss 方法来构建凭证对象（在下面的代码中解释）。我这部分的代码是

```
#include <gssapi.h>             
#include <gssapi_krb5.h>
#include <gssapi/gssapi_generic.h>
#include <gssapi/gssapi_ext.h>

gss_cred_id_t method_to_get_cred(){

      char *username = "asanyal@DOMAIN.COM";
      char *password = "correctpassword";
      gss_buffer_desc send_tok;
      OM_uint32 maj_stat, min_stat;
      gss_cred_id_t cred;
      gss_name_t gss_username;
      gss_OID_set_desc mechs, *mechsp = GSS_C_NO_OID_SET;
      gss_buffer_desc pwbuf;

      send_tok.value = username;
      send_tok.length = strlen(username);

      maj_stat = gss_import_name(&min_stat, &send_tok,(
             gss_OID) gss_nt_user_name,&gss_username);
      if (maj_stat != GSS_S_COMPLETE) {
         printf("parsing client name %d %d \n ", maj_stat, min_stat);
         return -1;
        }
        printf("Maj stat after gss_import_name: %d \n", maj_stat);
         printf("Acquired username \n");
     //getting username complete

     //getting password

      pwbuf.value = password;
      pwbuf.length = strlen(password);

      maj_stat = gss_acquire_cred_with_password(&min_stat,
          gss_username,
          &pwbuf, 0,
          mechsp, GSS_C_INITIATE,
          &cred, NULL, NULL);
          printf("Acquired password \n");

      //getting password complete
       printf("Maj stat and min stat after gss_acquire_cred_with_password: %d %d\n",     maj_stat, min_stat);
           return(cred);
} 
```

现在我正在打印主要状态（gssapi 级别状态）和次要状态（机制级别状态）——在这种情况下是 Kerberos。当我给登录用户（即 asanyal）时，状态 printf 消息为两个值都给出 0（一切顺利）

但是，当我使用不同的用户名（这个用户名在 Active Directory 中注册但我没有以他的身份登录）时，我得到了

```
majstat = 851968 and minstat = -1765328243 
```

进一步调查显示，此次要状态消息对应于错误

```
KRB5_CC_NOTFOUND    Matching credential not found 
```

我确定我正在为未登录的用户传递正确的凭据（用户名密码））

Is this something wrong with GSSAPI internally(maybe its unable to get a ticket or something) or am I making some mistake?

Configuration used : Windows Active Directory (Windows Server 2008) and MIT kerberos libraries - version 4.0.1

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T09:26:50.983

Ok i figured it out, the GSS-API does not include any API calls to directly obtain TGT, ST. For that you need the krb api(in case of underlying kerberos mechanism). Typically you would need a function like:-

```
krb5_get_init_creds_password(context,&creds,principal,conn->passwd,NULL,NULL,NULL,NULL,opts))            //these are the arguments i specified in my program 
```

along with certain context, credential cache and principal initialization parts.

# angularjs - 在 AngularJS 中突出显示过滤后的结果

> ID：15519713
> 
> 赞同：57
> 
> 时间：2013-03-20T09:30:45.153
> 
> 标签：angularjs, angularjs-ng-repeat

我在 angularJS 中使用 ng-repeat 和过滤器，如电话教程，但我想突出显示页面中的搜索结果。使用基本的 jQuery，我会简单地在输入键上解析页面，但我正在尝试以有角度的方式来做。有任何想法吗 ？

我的代码：

```
<input id="search" type="text" placeholder="Recherche DCI" ng-model="search_query" autofocus>
<tr ng-repeat="dci in dcis | filter:search_query">
            <td class='marque'>{{dci.marque}} ®</td>
            <td class="dci">{{dci.dci}}</td>
 </tr> 
```

* * *

## 回答 #1

> 赞同：95
> 
> 时间：2014-04-24T14:55:20.753

为 AngularJS v1.2+ 做的

HTML：

```
<span ng-bind-html="highlight(textToSearchThrough, searchText)"></span> 
```

JS：

```
$scope.highlight = function(text, search) {
    if (!search) {
        return $sce.trustAsHtml(text);
    }
    return $sce.trustAsHtml(text.replace(new RegExp(search, 'gi'), '<span class="highlightedText">$&</span>'));
}; 
```

CSS：

```
.highlightedText {
    background: yellow;
} 
```

* * *

## 回答 #2

> 赞同：22
> 
> 时间：2014-08-17T10:13:45.120

angular ui-utils 只支持一个术语。我正在使用以下过滤器而不是范围函数：

```
app.filter('highlight', function($sce) {
  return function(str, termsToHighlight) {
    // Sort terms by length
    termsToHighlight.sort(function(a, b) {
      return b.length - a.length;
    });
    // Regex to simultaneously replace terms
    var regex = new RegExp('(' + termsToHighlight.join('|') + ')', 'g');
    return $sce.trustAsHtml(str.replace(regex, '<span class="match">$&</span>'));
  };
}); 
```

和 HTML：

```
<span ng-bind-html="theText | highlight:theTerms"></span> 
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2013-03-20T09:42:54.450

尝试[Angular 用户界面](http://angular-ui.github.com/)

过滤器-> Highlite（过滤器）。还有 Keypress 指令。

* * *

## 回答 #4

> 赞同：9
> 
> 时间：2015-01-06T12:22:17.917

索引.html

```
<!DOCTYPE html>
<html>
  <head>
    <script src="angular.js"></script>
    <script src="app.js"></script>
    <style>
      .highlighted { background: yellow }
    </style>
  </head>

  <body ng-app="Demo">
    <h1>Highlight text using AngularJS.</h1>

    <div class="container" ng-controller="Demo">
      <input type="text" placeholder="Search" ng-model="search.text">

      <ul>
        <!-- filter code -->
        <div ng-repeat="item in data | filter:search.text"
           ng-bind-html="item.text | highlight:search.text">
        </div>
      </ul>
    </div>
  </body>
</html> 
```

应用程序.js

```
angular.module('Demo', [])
  .controller('Demo', function($scope) {
    $scope.data = [
      { text: "<< ==== Put text to Search ===== >>" }
    ]
  })
  .filter('highlight', function($sce) {
    return function(text, phrase) {
      if (phrase) text = text.replace(new RegExp('('+phrase+')', 'gi'),
        '<span class="highlighted">$1</span>')

      return $sce.trustAsHtml(text)
    }
  }) 
```

参考：[http](http://codeforgeek.com/2014/12/highlight-search-result-angular-filter/) ://codeforgeek.com/2014/12/highlight-search-result-angular-filter/ 演示：[http://demo.codeforgeek.com/highlight-angular/](http://demo.codeforgeek.com/highlight-angular/)

* * *

## 回答 #5

> 赞同：6
> 
> 时间：2016-11-21T12:15:11.723

我希望我的简单示例将使其易于理解：

```
 app.filter('highlight', function() {
    return function(text, phrase) {
      return phrase 
        ? text.replace(new RegExp('('+phrase+')', 'gi'), '<kbd>$1</kbd>') 
        : text;
    };
  }); 
```

* * *

```
 <input type="text" ng-model="search.$">

  <ul>
    <li ng-repeat="item in items | filter:search">
      <div ng-bind-html="item | highlight:search.$"></div>
    </li>
  </ul> 
```

* * *

[![在此处输入图像描述](../Images/5120a507c6fc46558317a93fb6cafdb9.png)](https://i.stack.imgur.com/Z57kX.png)

* * *

## 回答 #6

> 赞同：5
> 
> 时间：2015-10-28T12:52:26.523

[angular-bootstrap](https://angular-ui.github.io/bootstrap/)中有标准的 Highlight 过滤器：`typeaheadHighlight`

用法

```
<span ng-bind-html="text | typeaheadHighlight:query"></span> 
```

使用范围`{text:"Hello world", query:"world"}`渲染

```
<span...>Hello <strong>world</strong></span> 
```

* * *

## 回答 #7

> 赞同：4
> 
> 时间：2015-07-28T12:54:27.463

离开@uri 在这个线程中的答案，我将其修改为使用单个字符串*或*字符串数​​组。

这是**TypeScript**版本

```
module myApp.Filters.Highlight {
    "use strict";

    class HighlightFilter {
        //This will wrap matching search terms with an element to visually highlight strings
        //Usage: {{fullString | highlight:'partial string'}}
        //Usage: {{fullString | highlight:['partial', 'string, 'example']}}

        static $inject = ["$sce"];

        constructor($sce: angular.ISCEService) {

            // The `terms` could be a string, or an array of strings, so we have to use the `any` type here
            /* tslint:disable: no-any */
            return (str: string, terms: any) => {
                /* tslint:enable */

                if (terms) {
                    let allTermsRegexStr: string;

                    if (typeof terms === "string") {
                        allTermsRegexStr = terms;
                    } else { //assume a string array
                        // Sort array by length then  join with regex pipe separator
                        allTermsRegexStr = terms.sort((a: string, b: string) => b.length - a.length).join('|');
                    }

                //Escape characters that have meaning in regular expressions
                //via: http://stackoverflow.com/a/6969486/79677
                allTermsRegexStr = allTermsRegexStr.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");

                    // Regex to simultaneously replace terms - case insensitive!
                    var regex = new RegExp('(' + allTermsRegexStr + ')', 'ig');

                    return $sce.trustAsHtml(str.replace(regex, '<mark class="highlight">$&</mark>'));
                } else {
                    return str;
                }
            };
        }
    }

    angular
        .module("myApp")
        .filter("highlight", HighlightFilter);
}; 
```

在**JavaScript**中转换为：

```
var myApp;
(function (myApp) {
    var Filters;
    (function (Filters) {
        var Highlight;
        (function (Highlight) {
            "use strict";
            var HighlightFilter = (function () {
                function HighlightFilter($sce) {
                    // The `terms` could be a string, or an array of strings, so we have to use the `any` type here
                    /* tslint:disable: no-any */
                    return function (str, terms) {
                        /* tslint:enable */
                        if (terms) {
                            var allTermsRegexStr;
                            if (typeof terms === "string") {
                                allTermsRegexStr = terms;
                            }
                            else {
                                // Sort array by length then  join with regex pipe separator
                                allTermsRegexStr = terms.sort(function (a, b) { return b.length - a.length; }).join('|');
                            }

                            //Escape characters that have meaning in regular expressions
                            //via: http://stackoverflow.com/a/6969486/79677
                            allTermsRegexStr = allTermsRegexStr.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");

                            // Regex to simultaneously replace terms - case insensitive!
                            var regex = new RegExp('(' + allTermsRegexStr + ')', 'ig');
                            return $sce.trustAsHtml(str.replace(regex, '<mark class="highlight">$&</mark>'));
                        }
                        else {
                            return str;
                        }
                    };
                }
                //This will wrap matching search terms with an element to visually highlight strings
                //Usage: {{fullString | highlight:'partial string'}}
                //Usage: {{fullString | highlight:['partial', 'string, 'example']}}
                HighlightFilter.$inject = ["$sce"];
                return HighlightFilter;
            })();
            angular.module("myApp").filter("highlight", HighlightFilter);
        })(Highlight = Filters.Highlight || (Filters.Highlight = {}));
    })(Filters = myApp.Filters || (myApp.Filters = {}));
})(myApp|| (myApp= {}));
; 
```

* * *

或者，如果您只想要一个没有那些生成的命名空间**的简单 JavaScript 实现：**

```
app.filter('highlight', ['$sce', function($sce) {
    return function (str, terms) {
        if (terms) {
            var allTermsRegexStr;
            if (typeof terms === "string") {
                allTermsRegexStr = terms;
            }
            else {
                // Sort array by length then  join with regex pipe separator
                allTermsRegexStr = terms.sort(function (a, b) { return b.length - a.length; }).join('|');
            }

            //Escape characters that have meaning in regular expressions
            //via: http://stackoverflow.com/a/6969486/79677
            allTermsRegexStr = allTermsRegexStr.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&");

            // Regex to simultaneously replace terms - case insensitive!
            var regex = new RegExp('(' + allTermsRegexStr + ')', 'ig');
            return $sce.trustAsHtml(str.replace(regex, '<mark class="highlight">$&</mark>'));
        }
        else {
            return str;
        }
    };
}]); 
```

**已编辑**以包含以前会破坏的修复程序，这是搜索的人`.`或任何其他在正则表达式中有意义的字符。现在这些字符首先被转义。

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2013-03-20T09:41:10.197

使用当搜索词与元素包含的数据相关时应用的 ng-class。

所以在你的 ng-repeated 元素上，你会有`ng-class="{ className: search_query==elementRelatedValue}"`

当满足条件时，它将动态地将类“className”应用于元素。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2018-06-27T12:06:49.433

我的高亮解决方案，将其与 angular-ui-tree 元素一起使用：[https ://codepen.io/shnigi/pen/jKeaYG](https://codepen.io/shnigi/pen/jKeaYG)

```
angular.module('myApp').filter('highlightFilter', $sce =>
 function (element, searchInput) {
   element = element.replace(new RegExp(`(${searchInput})`, 'gi'),
             '<span class="highlighted">$&</span>');
   return $sce.trustAsHtml(element);
 }); 
```

添加CSS：

```
.highlighted {
  color: orange;
} 
```

HTML：

```
<p ng-repeat="person in persons | filter:search.value">
  <span ng-bind-html="person | highlightFilter:search.value"></span>
</p> 
```

并添加搜索输入：

```
<input type="search" ng-model="search.value"> 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-05-24T15:24:59.387

关于特殊字符的问题，我认为只是逃避你可能会失去正则表达式搜索。

那这个呢：

```
function(text, search) {
    if (!search || (search && search.length < 3)) {
        return $sce.trustAsHtml(text);
    }

    regexp  = '';

    try {
        regexp = new RegExp(search, 'gi');
    } catch(e) {
        return $sce.trustAsHtml(text);
    }

    return $sce.trustAsHtml(text.replace(regexp, '<span class="highlight">$&</span>'));
}; 
```

无效的正则表达式可能是用户仅输入文本：

*   有效：米
*   无效：m[
*   无效：m[ô
*   无效：m[ôo
*   有效：m[ôo]
*   有效：m[ôo]n
*   有效：m[ôo]ni
*   有效：m[ôo]nic
*   有效：m[ôo]nica

你觉得@Mik Cox 怎么样？

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2014-10-01T11:56:51.057

另一个提议：

```
app.filter('wrapText', wrapText);

function wrapText($sce) {
    return function (source, needle, wrap) {
        var regex;

        if (typeof needle === 'string') {
            regex = new RegExp(needle, "gi");
        } else {
            regex = needle;
        }

        if (source.match(regex)) {
            source = source.replace(regex, function (match) {
                return $('<i></i>').append($(wrap).text(match)).html();
            });
        }

        return $sce.trustAsHtml(source);
    };
} // wrapText

wrapText.$inject = ['$sce'];

// use like this
$filter('wrapText')('This is a word, really!', 'word', '<span class="highlight"></span>');
// or like this
{{ 'This is a word, really!' | wrapText:'word':'<span class="highlight"></span>' }} 
```

我愿意接受批评！;-)

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2014-12-01T00:52:41.313

感谢您提出这个问题，因为这也是我正在处理的事情。

不过有两件事：

首先，最佳答案很棒，但是关于 highlight() 的特殊字符有问题的评论是准确的。该评论建议使用可以工作的转义链，但他们建议使用正在逐步淘汰的 unescape() 。我最终得到了什么：

```
$sce.trustAsHtml(decodeURI(escape(text).replace(new RegExp(escape(search), 'gi'), '<span class="highlightedText">$&</span>'))); 
```

其次，我试图在 URL 的数据绑定列表中执行此操作。在 highlight() 字符串中，您不需要数据绑定。

例子：

```
<li>{{item.headers.host}}{{item.url}}</li> 
```

成为：

```
<span ng-bind-html="highlight(item.headers.host+item.url, item.match)"></span> 
```

将它们留在 {{ }} 中并遇到各种错误时遇到了问题。

希望这可以帮助遇到同样问题的任何人。

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2017-06-20T17:07:57.620

如果您使用的是角度材料库，则有一个名为的内置指令`md-highlight-text`

从文档中：

```
<input placeholder="Enter a search term..." ng-model="searchTerm" type="text">
<ul>
  <li ng-repeat="result in results" md-highlight-text="searchTerm">
    {{result.text}}
  </li>
</ul> 
```

链接到文档：[https ://material.angularjs.org/latest/api/directive/mdHighlightText](https://material.angularjs.org/latest/api/directive/mdHighlightText)

# mongodb - 使用 MongoDB 的 ElasticSearch 不会索引大对象

> ID：15519715
> 
> 赞同：3
> 
> 时间：2013-03-20T09:30:50.673
> 
> 标签：mongodb, elasticsearch

我使用以下信息创建了 ES（带有 MongoDB River 插件）索引：

```
{
    "type": "mongodb",
    "mongodb": {
        "db": "mydatabase",
        "collection": "Users"
    },
    "index": {
        "name": "users",
        "type": "user"
    }
} 
```

当我插入简单的对象时：

```
{
   "name": "Joe",
   "surname": "Black"
} 
```

一切正常（我可以使用 ES Head Web 界面查看数据）。但是当我插入更大的对象时，它不会索引它：

```
{
    "object": {
        "text": "Let's do it again!",
        "boolTest": false
    },
    "type": "coolType",
    "tags": [
            ""
    ],
    "subObject1": {
        "count": 0,
        "last3": [],
        "array": []
    },
    "subObject2": {
        "count": 0,
        "last3": [],
        "array": []
    },
    "subObject3": {
        "count": 0,
        "last3": [],
        "array": []
    },
    "usrID": "5141a5a4d8f3a79c09000001",
    "created": Date(1363527664000),
    "lastUpdate": Date(1363527664000)
} 
```

请问哪里有问题？

谢谢您的帮助！

编辑：这是来自 ES 控制台的错误：

> org.elasticsearch.index.mapper.MapperParsingException：[stream] 的对象映射试图解析为对象，但得到了 EOF，是否提供了具体值？在 org.elasticsearch.index.mapper.object.ObjectMapper.parse(ObjectMapper.java:457) 在 org.elasticsearch.index.mapper.DocumentMapper.parse(DocumentMapper.java:486) 在 org.elasticsearch.index.mapper.DocumentMapper .parse(DocumentMapper.java:430) 在 org.elasticsearch.index.shard.service.InternalIndexShard.prepareIndex(InternalIndexShard.java:318) 在 org.elasticsearch.action.bulk.TransportShardBulkAction.shardOperationOnPrimary(TransportShardBulkAction.java:157) 在org.elasticsearch.action.support.replication.TransportShardReplicationOperationAction$AsyncShardOperationAction.performOnPrimary(TransportShardReplicationOperationAction.java:

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T11:31:53.577

您使用的是哪个版本的 MongoDB River？请查看问题 #26 [1]。它包含索引大型 json 文档的示例，没有问题。

如果您仍然可以重现问题，请提供更多详细信息：river 设置、mongodb（版本、具体设置）、elasticsearch（版本、具体设置）。

1.  [https://github.com/richardwilly98/elasticsearch-river-mongodb/issues/26](https://github.com/richardwilly98/elasticsearch-river-mongodb/issues/26)

# django - 如何使用 ImageField 模型调整使用 Django 上传的图像文件的大小？

> ID：15519716
> 
> 赞同：22
> 
> 时间：2013-03-20T09:30:52.340
> 
> 标签：django, image, upload, resize, photo

将通过 Django 表单上传的图像文件调整为`ImageField`.

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-20T12:21:35.280

我很生气，因为我找不到一个完整的工作示例，只能在这里和那里找到一些。我设法自己把解决方案放在一起。这是完整的示例，我将它放在表单的 clean() 方法中（您也可以覆盖模型的 save() 方法，以完全相同的方式 - 更改 ImageField 的文件属性）。

```
import StringIO
from PIL import Image

image_field = self.cleaned_data.get('image_field')
image_file = StringIO.StringIO(image_field.read())
image = Image.open(image_file)
w, h = image.size

image = image.resize((w/2, h/2), Image.ANTIALIAS)

image_file = StringIO.StringIO()
image.save(image_file, 'JPEG', quality=90)

image_field.file = image_file 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-20T09:33:25.827

您可以使用 PIL 并在 YourModel.save() 方法中调整图像大小。

例子：

[保存时调整图像大小](https://stackoverflow.com/questions/623698/resize-image-on-save)

[http://djangosaur.tumblr.com/post/422589280/django-resize-thumbnail-image-pil](http://djangosaur.tumblr.com/post/422589280/django-resize-thumbnail-image-pil)

[http://davedash.com/2009/02/21/resizing-image-on-upload-in-django/](http://davedash.com/2009/02/21/resizing-image-on-upload-in-django/)

# java - Java相当于javascript中的unencode函数来解析转义的unicode

> ID：15519723
> 
> 赞同：1
> 
> 时间：2013-03-20T09:31:20.043
> 
> 标签：java, json, escaping

我无法解析表示为转义 unicode 的推文，其中一些发现是外语字符串，例如`\u064a\u0633\u0639\u062f\u0646\u064a`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:40:47.097

使用`org.apache.commons.lang.StringEscapeUtils`.

```
String s="\\u0048\\u0065\\u006C\\u006C\\u006F";
System.out.println(StringEscapeUtils.unescapeJava(s)); 
```

PS 糟糕，我在发布答案之前没有刷新此页面，上面的评论传达了同样的信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:41:01.870

你可以试试`str = org.apache.commons.lang.StringEscapeUtils.unescapeJava(str);`

来自阿帕奇公地

检查[http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/StringEscapeUtils.html](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/StringEscapeUtils.html)

# tor - Vidalia 和 Tor：控制身份何时更改

> ID：15519731
> 
> 赞同：0
> 
> 时间：2013-03-20T09:31:40.417
> 
> 标签：tor

我正在通过 Tor 网络执行一些延迟测量。为了避免中继拥塞，我的每次测试运行大约持续 15 到 20 分钟，平均消耗 2 kbps 的带宽。

由于继电器的工作方式，我的测量会中断，因为身份每隔几分钟就会自动更改一次。我想知道是否有人知道如何做到这些：

1.  指定身份更改之间的时间间隔。或者，禁用自动身份更改并允许我使用 vidalia 的控制面板手动更改身份

2.  指定一个 IP 地址作为出口中继。我编辑了 torrc，将 ExitNodes 设置为一个 ipaddress，并将 StrictNode 设置为 1，但是在初始连接到该特定出口中继和 1 个与外部世界的 http 连接之后，没有后续流量被路由出 tor。

不幸的是，在查看以前的问题时，我似乎无法找到答案。:-/ 我的设置包括 ubuntu 12.04 lts，使用 apt-get 和 firefox 安装 vidalia 和 tor，通过 localhost:9050 使用 socks 连接到 tor

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-16T03:58:00.163

> 1）指定身份更改之间的时间间隔。

嗨，尼娜，感谢您对网络上的负载保持谨慎！默认情况下，Tor 每十分钟循环一次你的电路。您可以使用`MaxCircuitDirtiness`torrc 中的选项自定义它。

> 2) 指定一个 IP 地址作为出口中继。

Tor 并没有让这变得特别容易。可能最好的选择是将现有电路之一扩展到所需的端点。您可以通过 stem 使用[extend_circuit() 方法](https://stem.torproject.org/api/control.html#stem.control.Controller.extend_circuit)来做到这一点。

# linux - 查找列中字段的平均值

> ID：15519733
> 
> 赞同：-1
> 
> 时间：2013-03-20T09:31:43.423
> 
> 标签：linux, sed, awk

我有这样的记录

```
1  11  11  T  A  0  0  A=1;B=2,C=3;D=4; 
```

有 8 列，每列由制表符分隔

我需要输出是这样的

```
1  11  11  T  A  0  0  A=1;B=2,C=3;D=4;AF=2.5; 
```

哪里`AF`是第 8 列中所有字段的平均值。

```
AF=(1+2+3+4)/4=2.5 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:41:15.030

你输入的数据真的很好：空格，逗号，分号......试试这个：

```
awk -F'[;, ]' '{n=0;s=0;for(i=1;i<=NF;i++)
if($i~/=[0-9]+/){split($i,t,"=");n++;s+=t[2]; } 
print $0"AF="s/n";"
}' file 
```

使用您的数据：

```
kent$  echo "1 11 11 T A 0 0 A=1;B=2,C=3;D=4;"|awk -F'[;, ]' '{n=0;s=0;for(i=1;i<=NF;i++) 
if($i~/=[0-9]+/){split($i,t,"=");n++;s+=t[2]; }
print $0"AF="s/n";"
}' 
1 11 11 T A 0 0 A=1;B=2,C=3;D=4;AF=2.5; 
```

# ios - 无法在 Phonegap IOS 项目中使用 Odata 服务？

> ID：15519739
> 
> 赞同：0
> 
> 时间：2013-03-20T09:32:09.833
> 
> 标签：ios, cordova, odata, cordova-2.0.0

我正在尝试使用以下代码使用 datajs-1.0.0.js 使用 Odata 服务。它在浏览器中运行良好。

```
 OData.read("http://services.odata.org/Northwind/Northwind.svc/Customers('ALFKI')/Orders",
                function(data){

                    alert('oData Function');

                    var str;
                    alert('before for');
                    for(var objRec in data.results){
                        var obj = data.results[objRec];

                        str = str + ' '+obj.OrderID;
                    }
                    alert(str);
                    alert('after for');
                }, function (err) {
                    alert(err.message);
                }); 
```

现在我需要在 Phonegap IOS 项目（版本 Cordova 2.4）中运行它，但是什么也没发生。它也不会抛出任何错误。我在 phonegap 的 config.xml 文件中添加了 URL 以允许外部主机。

```
 <access origin="*" /> 
```

当我在 Android Phonegap 项目中运行相同的代码时，它运行良好。

有什么我错过的吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T10:01:46.140

将 OpenAllWhitelistURLsInWebView 设置为 YES 或升级到 datajs 1.1.0 是否可以解决问题？

# qt - 如何获取小部件背景QColor

> ID：15519749
> 
> 赞同：13
> 
> 时间：2013-03-20T09:32:43.930
> 
> 标签：qt, qwidget

我正在尝试找出 a `QWidget`or的背景颜色，`QGLWidget`以便我可以使用它`qglClearColor()`来使 OpenGL 部分在小部件中本地显示（例如没有黑色背景）。

我想我可以获取`backgroundRole()`我的小部件，但我在将其转换为`QColor`. 有`QPalette::color(QColorRole)`但它不是静态的，我不知道如何创建一个实例`QPalette`来进行转换。

* * *

## 回答 #1

> 赞同：29
> 
> 时间：2013-03-20T09:44:19.360

用于`QWidget::palette().color(QWidget::backgroundRole())`接收该小部件的背景颜色角色的颜色。显然，这也应该适用于任何继承 QWidget 的类。

# javascript - 当变量超过某个值时更改背景

> ID：15519756
> 
> 赞同：0
> 
> 时间：2013-03-20T09:33:14.877
> 
> 标签：javascript, jquery, arrays

当我用来确定元素宽度的变量超过某个值时，我想要做的是给一个 div 另一个类。当值超过 70 时，如何将类添加到适当的元素？如您所见，属于变量的元素与 ID 具有相同的名称。

这是我的代码：

```
 //serverload bars 
       var serverload1 = 73;
       var serverload2 = 13;
       var serverload3 = 68;
       var serverload4 = 33;
       var serverload5 = 83;
       var serverload6 = 63;
       var serverload7 = 93;
       var serverload8 = 23;

       $('#serverload1').width(serverload1+"%");
       $('#serverload2').width(serverload2+"%");
       $('#serverload3').width(serverload3+"%");
       $('#serverload4').width(serverload4+"%");
       $('#serverload5').width(serverload5+"%");
       $('#serverload6').width(serverload6+"%");
       $('#serverload7').width(serverload7+"%");
       $('#serverload8').width(serverload8+"%");

       var barcolors = [serverload1, serverload2, serverload3, serverload4, serverload5, serverload6, serverload7, serverload8].forEach(testwidth);

       function testwidth(element, index, array) {
           if (element > 70) {
            console.log(element);
           }
       } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:41:01.827

我建议您按以下方式重组代码：

```
var barcolors = [73, 13, 68, 33, 83, 63, 93, 23];

$("[id^=serverload]").filter(function() {
    var i = this.id.substring(10),
        width = barcolors[i-1];

    if (width !== undefined)
        this.style.width = width + "%";

    return width > 70;
}).addClass("someClass"); 
```

**演示：http:** [//jsfiddle.net/JaqGJ/](http://jsfiddle.net/JaqGJ/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T09:40:06.723

试试这个...

```
 function testwidth(element, index, array) {
       if (element > 70) {
         $('#' + element).addClass('mynewclass');
       }
   } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T11:50:33.917

根据您的综合回答，我能够制定出以下解决方案：

```
 var barcolors = [["serverload1",serverload1], ["serverload2",serverload2], ["serverload3",serverload3], ["serverload4",serverload4], ["serverload5",serverload5], ["serverload6",serverload6], ["serverload7",serverload7], ["serverload8",serverload8]].forEach(testwidth);

       function testwidth(element, index, array) {
           if (element[1] > 70) {
            console.log(element[0]);
            var tegroot = "#"+element[0];
            console.log(tegroot);
            $(tegroot).addClass("redbar");
           }
       } 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T13:17:35.593

基于 VisioN 的解决方案，但更通用：

[http://jsfiddle.net/JaqGJ/1/](http://jsfiddle.net/JaqGJ/1/)

```
var barcolors = [73, 13, 68, 33, 83, 63, 93, 23];

$(".bar").filter(function(i) {
    var width = barcolors[i];

    this.style.width = width ?  width + "%" : 0;

    return width > 70;
}).addClass("someClass"); 
```

注意：最后一个条号 9 只是为了测试代码的安全性。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T09:34:54.543

jQuery

`.addClass()`用于添加类。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-20T09:36:15.753

试试这个，

```
if(serverload1>70){
   $('#serverload1').addClass('NEW CLASS NAME');
} 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-20T09:58:41.150

更多的是评论而不是答案，但是：

您是否考虑过将负载值放入 html 元素的数据属性中？

```
<div id="serverload1" class="serverload" data-load="73"></div>
<div id="serverload2" class="serverload" data-load="13"></div> 
```

js 会更小，更易读：

```
$('div.serverload').filter(function() {
    var $this = $(this),
        load = $this.data('load');
    $this.width(load + '%');
    return load > 70;
}).addClass('customClass'); 
```

[http://jsfiddle.net/5cXwb/9/](http://jsfiddle.net/5cXwb/9/)

# javascript - jquery RegExp 没有按我的预期工作

> ID：15519757
> 
> 赞同：0
> 
> 时间：2013-03-20T09:33:19.457
> 
> 标签：javascript, regex

出了什么问题，正如一个例子所解释的：

```
form = 'some other [1][2] data ... data[Company][c_list][2][name_2] ... some other data';
form.replace(new RegExp('[c_list][2]', 'g'), '[c_list][1]'); 
```

得到：`data[Company][c_list][2][name[c_list][1]]`

需要：`data[Company][c_list][1][name_2]`

我的代码有什么问题？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:40:05.133

字符`[`和`]`用于组成一个集合，所以`[c_list]`在正则表达式中不匹配字符序列`[c_list]`，它匹配一个字符，即`c`, `_`, `l`, `i`, `s`or `t`。

转义字符`[`和`]`表达式。当您将模式编写为字符串时，您需要使用`\\`输入`\`模式：

```
form.replace(new RegExp('\\[c_list\\]\\[2\\]', 'g'), '[c_list][1]'); 
```

您也可以将正则表达式写为文字，然后仅`\`用于转义字符：

```
form.replace(/\[c_list\]\[2\]/g, '[c_list][1]'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:37:44.580

在正则表达式`[...]`中具有定义字符类的特殊含义。我想你正在寻找

```
form.replace(new RegExp('\[c_list\]\[2\]', 'g'), '[c_list][1]'); 
```

括号被转义的地方。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:39:00.220

转义正则表达式的括号。

# android - PayPal.initWithAppID() 因 NullPointerException 而崩溃

> ID：15519761
> 
> 赞同：2
> 
> 时间：2013-03-20T09:33:28.893
> 
> 标签：android, paypal, crash, nullpointerexception, unity3d

```
 FATAL EXCEPTION: Thread-5195
 java.lang.NullPointerException: src == null
    at java.lang.System.arraycopy(Native Method)
    at com.paypal.android.a.g.a(Unknown Source)
    at com.paypal.android.a.h.c(Unknown Source)
    at com.paypal.android.MEP.PayPal.setLanguage(Unknown Source)
    at com.paypal.android.MEP.PayPal.initWithAppID(Unknown Source)
    at com.lonfun.pets.UnityPayMenuActivity.initLibrary(UnityPayMenuActivity.java:256)
    at com.lonfun.pets.UnityPayMenuActivity.access$2(UnityPayMenuActivity.java:249)
    at com.lonfun.pets.UnityPayMenuActivity$2$1.run(UnityPayMenuActivity.java:175) 
```

我只是使用android打开paypal，一切正常，但是如果我从unity调用，就会发生这种情况！这是我的java代码：

包 com.paypal.androidpets；

```
import android.content.Context;
import android.os.Handler;

import com.lonfun.pets.UnityPayMenuActivity;
import com.paypal.android.MEP.PayPal;
import com.paypal.android.MEP.PayPalActivity;

public class PaypalTool {
    Context context;
    PayPal pp;
    private static final int server = PayPal.ENV_SANDBOX;
    // The ID of your application that you received from PayPal
    private static final String appID = "APP-80W284485P519543T";

    public PaypalTool(Context context) {
        this.context=context;
    }

    public void initLibrary(final Handler handler) 
    {
        new Thread() {
            public void run() {
                PayPalActivity._paypal = null;
                pp = PayPal.getInstance();
                // If the library is already initialized, then we don't need to initialize it again.
                if(pp == null) {
//                  pp = PayPal.initWithAppID(context, "", PayPal.ENV_NONE);
                    pp = PayPal.initWithAppID(context, appID, server);

                    pp.setShippingEnabled(false);
                }

                if (PayPal.getInstance().isLibraryInitialized()) {
                    handler.sendEmptyMessage(0);
                }
                else {
                    handler.sendEmptyMessage(1);
                }
            }
        }.start();
    }
} 
```

有没有人解决这个问题，请帮帮我，谢谢！

```
using UnityEngine;
using System.Collections;

public class PayMoneyHandler : MonoBehaviour
{

    #if UNITY_ANDROID
    static AndroidJavaClass payPluginClass;
    static AndroidJavaClass unityPlayer;
    static AndroidJavaObject currActivity;
    #endif

    public static void Pay(string productID)
    {
#if UNITY_ANDROID
        AndroidJavaClass jc = new AndroidJavaClass("com.unity3d.player.UnityPlayer");
        AndroidJavaObject jo = jc.GetStatic<AndroidJavaObject>("currentActivity");
        jo.Call("StartActivity0", 
            "com.peten.tier2", 
            "EGAHCNJDEJBWBIBWEXIKDEGLJECOAD.Mac", 
            "Dog", 
            "AndDogCn", 
            "http://42.121.94.123/TradeWeb/AlipayTrade.aspx",
            "http://58.246.188.238/TradeWeb/PaypalTrade.aspx"
            );
#endif
    }

}
using UnityEngine;
using System.Collections;

public class TestForPaypal : MonoBehaviour {

    // Use this for initialization
    void Start () {

    }

    // Update is called once per frame
    void Update () {

    }

    public void OnClick(){
        Debug.Log("Test For Paypal!");
        PayMoneyHandler.Pay("test1");
    }
}

public void StartActivity0(final String name,final String PlayerName,final String GameID,final String ZoneID,final String payUrl,final String paypalUrl) 
    {       
        this.runOnUiThread(new Runnable() {

            @Override
            public void run() {
                Log.i("Order", "name:"+name+"PlayerName:"+PlayerName+"GameID:"+GameID+"ZoneID:"+ZoneID+"payUrl:"+payUrl+"paypalUrl:"+paypalUrl);
                Intent payintent=new Intent(mContext,UnityPayMenuActivity.class);
                payintent.putExtra("name",name);
                payintent.putExtra("PlayerName",PlayerName);
                payintent.putExtra("GameID",GameID);
                payintent.putExtra("ZoneID",ZoneID);
                payintent.putExtra("payUrl",payUrl);
                payintent.putExtra("paypalUrl",paypalUrl);
                Unity3DMainActiviy.this.startActivity(payintent);
            }
        });
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T11:16:52.903

我认为您没有输入 appID 和服务器详细信息。下面是我已经实现的工作代码，它对我来说很好。我已经实现了在按钮单击时支付，它扩展了可运行对象

```
 Check_out.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            // TODO Auto-generated method stub

             if (_paypalLibraryInit) {
         showPayPalButton();
         //Toast.makeText(Android_PP_Test1Activity.this, captions[position], Toast.LENGTH_SHORT).show();

         }
             else {
             // Display a progress dialog to the user and start checking for when
         // the initialization is completed

             Thread initThread = new Thread(initLibraryRunnable);
             initThread.start();

             _progressDialog = new ProgressDialog(Recharge.this);
         _progressDialog.setProgressStyle(ProgressDialog.STYLE_SPINNER);
         _progressDialog.setMessage("Loading PayPal Payment Library");
         _progressDialog.setCancelable(false);
         _progressDialog.show();
         _progressDialogRunning = true;
         Thread newThread = new Thread(checkforPayPalInitRunnable);

         newThread.start();
         //Toast.makeText(Android_PP_Test1Activity.this, "Picasso Paintings", Toast.LENGTH_SHORT).show();

        }
    }

}); 
```

此按钮调用此可运行方法

```
//This lets us run the initLibrary function
    final Runnable initLibraryRunnable = new Runnable() {
        public void run() {
            initLibrary();
        }
    }; 
```

这个方法负责启动initLibrary。

```
 /** init method **/
public void initLibrary() {
    PayPal pp = PayPal.getInstance();
    if (pp == null) {
        // This is the main initialization call that takes in your Context,
        // the Application ID, and the server you would like to connect to.
        pp=PayPal.initWithAppID(this,"APP80W284485P519543T",PayPal.ENV_SANDBOX);

        // -- These are required settings.
        pp.setLanguage("en_US"); // Sets the language for the library.
        // --

        // -- These are a few of the optional settings.
        // Sets the fees payer. If there are fees for the transaction, this
        // person will pay for them. Possible values are FEEPAYER_SENDER,
        // FEEPAYER_PRIMARYRECEIVER, FEEPAYER_EACHRECEIVER, and
        // FEEPAYER_SECONDARYONLY.
        pp.setFeesPayer(PayPal.FEEPAYER_EACHRECEIVER);
        // Set to true if the transaction will require shipping.
        pp.setShippingEnabled(true);
        // Dynamic Amount Calculation allows you to set tax and shipping
        // amounts based on the user's shipping address. Shipping must be
        // enabled for Dynamic Amount Calculation. This also requires you to
        // create a class that implements PaymentAdjuster and Serializable.
        pp.setDynamicAmountCalculationEnabled(false);
        // -- 

    }
} 
```

希望能帮助到你...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-01T06:36:46.463

问题是统一生成apk文件时。我比较了我自己制作的一个 apk 与 PayPal 集成，仅使用 eclipse 编译和其他使用 Unity 编译。

假设我只用 eclipse 制作的 apk 称为“PayPalOnlyEclipse.apk”，而用统一制作的 apk 称为“PayPalWithUnity.apk”；y 将它们重命名为“PayPalOnlyEclipse.zip”和“PayPalWithUnity.zip”，然后用 WinRar 打开它们进行比较。

我发现 PayPalOnlyEclipse 有一个 PayPalWithUnity 没有的文件夹，该文件夹是“com\paypal\android\utils\data”。所以我解压了那个文件夹，然后把它添加到 PayPalWithUnity。然后删除 META-INF 文件夹（签名），然后关闭“PayPalWithUnity.zip”并像以前一样重命名（“PayPalWithUnity.apk”）。

然后我使用命令对apk文件进行签名：jarsigner -verbose -sigalg MD5withRSA -digestalg SHA1 -keystore my.keystore PayPalWithUnity.apk user

最后我使用了 zipalign 的命令： zipalign -v 4 PayPalWithUnity.apk PayPalWithUnity2.apk

该命令生成 PayPalWithUnity2.apk ，这是您必须安装在手机中的 apk 文件。

希望它有帮助，对不起我的英语。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-03T15:40:31.883

检查您是否已在清单文件中包含 PaypalActivity。像这样：

```
<activity android:name="com.paypal.android.MEP.PayPalActivity"
        android:configChanges="keyboardHidden|orientation" /> 
```

如果你有它但它还不能工作，在构建路径中包含库（属性>>Java 构建路径>>库>>添加 JAR）并将其添加到“订单和导出”选项卡中（属性>>Java 构建路径>>订购和出口）。

# video - 修改 MP4 流中的 H.264 级别

> ID：15519765
> 
> 赞同：3
> 
> 时间：2013-03-20T09:33:38.923
> 
> 标签：video, ffmpeg, h.264, mp4

我有 1000 多个包含错误级别信息的视频，因此无法在某些设备上播放。它们是 H.264 基线，在 mp4 容器中带有 aac 音频。我想纠正它们，但避免重新编码。我是否正确地假设这是可能的并且会更快？如何识别流中的 level_idc 位？所有流都将它们放在同一位置吗？我希望这只会出现在流中的一个地方，这个假设是否正确？更新：我遇到了一个声称可以执行此操作的 Windows 可执行[链接。](http://www.videohelp.com/tools/H264-AVC-Level-Editor)我希望能够在 unix 上执行此命令行，因此我可以编写脚本。

更多更新：根据以下 Roman 的回答。我挖掘了 MP4 语法，发现 Profile 和 Level 信息是`avcC`atom under `stsd`. 我可以看到该级别设置为`1E`，我将其更正为`1F`。之前：`61 76 63 43 01 42 C0 1E FF E1 00 19 67 42 C0 1E D9` 之后：`61 76 63 43 01 42 C0 1F FF E1 00 19 67 42 C0 1E D9`MediaInfo 更改为：

```
Video
ID                                       : 1
Format                                   : AVC
Format/Info                              : Advanced Video Codec
Format profile                           : Baseline@L3.0
Format settings, CABAC                   : No
Format settings, ReFrames                : 3 frames
Muxing mode                              : Container profile=Baseline@3.1
Codec ID                                 : avc1
Codec ID/Info                            : Advanced Video Coding
Duration                                 : 1mn 4s
Bit rate                                 : 3 000 Kbps
Width                                    : 1 280 pixels
Height                                   : 720 pixels
Display aspect ratio                     : 16:9
Frame rate mode                          : Constant
Frame rate                               : 30.000 fps
Color space                              : YUV
Chroma subsampling                       : 4:2:0
Bit depth                                : 8 bits
Scan type                                : Progressive
Bits/(Pixel*Frame)                       : 0.109
Stream size                              : 22.7 MiB (92%)
Writing library                          : x264 core 120 r2151 a3f4407
Encoding settings                        : cabac=0 / ref=3 / deblock=1:0:0 / analyse=0x1:0x111 / me=hex / subme=7 / psy=1 / psy_rd=1.00:0.00 / mixed_ref=1 / me_range=16 / chroma_me=1 / trellis=1 / 8x8dct=0 / cqm=0 / deadzone=21,11 / fast_pskip=1 / chroma_qp_offset=-2 / threads=12 / sliced_threads=0 / nr=0 / decimate=1 / interlaced=0 / bluray_compat=0 / constrained_intra=0 / bframes=0 / weightp=0 / keyint=250 / keyint_min=25 / scenecut=40 / intra_refresh=0 / rc_lookahead=40 / rc=abr / mbtree=1 / bitrate=3000 / ratetol=1.0 / qcomp=0.60 / qpmin=0 / qpmax=69 / qpstep=4 / ip_ratio=1.40 / aq=1:1.00 
```

它引入了一个带有级别的 Muxing 模式参数，`3.1`但可惜这个流也没有在设备上播放。如何在`Format Profile`不重新编码的情况下更正这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:59:25.153

请注意，级别存在于格式描述符上，也可能在有效负载本身上重复。如果您不关心描述符本身和有效负载/编码的实际完整性（我想提高级别很好，但降低它可能不好），可以在不重新编码视频的情况下更改级别。

不仅如此，通过找到包含视频轨道描述符的框并在此处修补级别，您可以通过两种方式做到这一点 - 您不需要 FFmpeg，您宁愿直接访问字节，而 MP4 格式可能足够简单来做到这一点从纯代码。

或者，您需要在途中重新多路复用轨道更改格式。解复用器和多路复用器不会检查此级别值是否可接受，因此将其作为与 FFmpeg 重新多路复用的一部分进行修补是可行的。`extradata`任何在不重新编码的情况下写入 MP4 的示例 FFmpeg 代码都是一个好的开始（您的任务将是在打开之前更新字段指向的字节数组`AVFormatContext`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-22T11:28:29.940

我找到了一个解决方案，感谢@Roman 帮助我解决了这个问题。在比特流中的 avcC atom 之后找到 Profile 和 Level `mp4`，在我的情况下`42 C0 1E`，这是 Baseline@L3.0，我希望级别是`3.1`。为此，`42 C0 1E`在流中查找所有出现的 并替换`1E`为`1F`. 我发现了大约 8-10 次这样的事件。现在你有了 Baseline@L3.1。这可以使用来验证`mediainfo`。我认为这是必要的，因为 h.264 被编码为一堆数据包，并且每个数据包都有带有配置文件和级别信息的 SPS 标头。

# ruby-on-rails - 以非常低效的方式进行词频计数

> ID：15519769
> 
> 赞同：0
> 
> 时间：2013-03-20T09:33:49.303
> 
> 标签：ruby-on-rails, time, word-cloud

这是我计算词频的代码

```
 word_arr= ["I", "received", "this", "in", "email", "and", "found", "it", "a", "good", "read", "to", "share......", "Yes,", "Dr", "M.", "Bakri", "Musa", "seems", "to", "know", "what", "is", "happening", "in", "Malaysia.", "Some", "of", "you", "may", "know.", "He", "is", "a", "Malay",  "extra horny", "horny nor", "nor their", "their babes", "babes are", "are extra", "extra SEXY..", "SEXY.. .", ". .", ". .It's", ".It's because", "because their", "their CONDOMS", "CONDOMS are", "are Made", "Made In", "In China........;)", "China........;) &&"]

arr_stop_kwd=["a","and"] 

 frequencies = Hash.new(0)
   word_arr.each { |word|
      if !arr_stop_kwd.include?(word.downcase) && !word.match('&&')
        frequencies["#{word.downcase}"] += 1
      end
   } 
```

当我有 100k 数据时，需要 9.03 秒，我可以用其他方法计算多少时间

提前谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:56:43.130

看看[Facets 宝石](http://rubygems.org/gems/facets)

[你可以使用频率方法](http://rubyworks.github.com/rubyfaux/?doc=http://rubyworks.github.com/facets/docs/facets-2.9.3/core.json#api-module-Enumerable/api-method-Enumerable-h-frequency)做这样的事情

```
require 'facets'
frequencies = (word_arr-arr_stop_kwd).frequency 
```

请注意，可以从 中减去停用词`word_arr`。请参阅[阵列文档](http://ruby-doc.org/core-2.0/Array.html#method-i-2D)。

# cuda - CUDA：如何在 GPU 上高效地表示二维数组

> ID：15519779
> 
> 赞同：1
> 
> 时间：2013-03-20T09:34:13.117
> 
> 标签：cuda

我需要在 GPU 上处理尺寸为 K x N 的二维数组，其中 K 是一个小数（3、4 或 5），而 N 的值是几百万到几百万。每次将针对一列 K 个元素进行处理，这样每一列都将由内核的单独调用来处理。在 GPU 上表示 K x N 数组的最有效方法是什么：

1）在一维数组中，将一列的K个元素放在连续的位置，这样每个线程都会处理元素K*thread_id, K*thread_id + 1, ..., K*thread_id + K - 1

2）作为K个单独的一维数组，其中每个数组存储1行原始数组；

3) 别的东西

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:01:15.717

选项 2 更适合您的情况。

选项 2 的数据布局可以看作是数组结构 (SoA)，而选项 1 是结构数组 (AoS)。

一般来说，对于 GPU 编程，SoA 优于 AoS。有很多关于这个主题的讨论展示了为什么 SoA 表现更好。

[http://developer.download.nvidia.com/CUDA/training/introductiontothrust.pdf](http://developer.download.nvidia.com/CUDA/training/introductiontothrust.pdf)

[http://my.safaribooksonline.com/book/-/9780123884268/chapter-6dot-efficiently-using-gpu-memory/st0045_b9780123884268000069](http://my.safaribooksonline.com/book/-/9780123884268/chapter-6dot-efficiently-using-gpu-memory/st0045_b9780123884268000069)

由于每个线程一个接一个地访问 K 个元素，因此选项 1 中的 AoS 布局会导致跨步内存访问问题并可能损害性能，如下所述。

[https://developer.nvidia.com/content/how-access-global-memory-efficiently-cuda-cc-kernels](https://developer.nvidia.com/content/how-access-global-memory-efficiently-cuda-cc-kernels)

尽管在您的情况下可以通过足够大的 L2 缓存来缓解此问题，但避免 AoS 是获得更高性能的更可靠的方法。

# java - Java spring junit编写持久化数据的测试

> ID：15519780
> 
> 赞同：2
> 
> 时间：2013-03-20T09:34:15.070
> 
> 标签：java, spring, junit4

我过去曾使用内存数据库编写过测试。

我想知道的是是否可以在spring、junit、java中编写测试，在内存数据库中使用，并且每次测试后数据不会回滚，而是保存在数据库中。

基本上，测试是相互依赖的？

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:41:36.053

回滚数据库更改与否取决于您。

但是单元测试应该相互独立。

[DZone 最近一篇](http://architects.dzone.com/articles/unit-testing-best-practices)关于该主题的文章的小摘录：

> 使每个测试独立于所有其他测试
> 
> 不要制作单元测试用例链。它会阻止您识别测试用例失败的根本原因，您将不得不调试代码。此外，它会产生依赖性，这意味着如果您必须更改一个测试用例，那么您需要对多个测试用例进行不必要的更改。
> 
> 尝试使用 @Before 和 @After 方法为所有测试用例设置必要条件（如果有的话）。如果您需要多个东西来支持@Before 或@After 中的不同测试用例，那么请考虑创建新的Test 类。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:43:07.240

你的测试应该是独立的。

但是，如果您愿意，我想您可以尝试使用 @Rollback 注释。

我没有尝试过，但在进行交易时在文档规范中看到过。

# c++ - 谁能解释一下“ - '0'”

> ID：15519781
> 
> 赞同：4
> 
> 时间：2013-03-20T09:34:17.150
> 
> 标签：c++, arrays, string

```
 #include <iostream> // cin, cout
using namespace std;
int main(void)
{
char c[80];
int i, sum=0;
cin.getline(c,80);
for(i=0; c[i]; i++) // c[i] != '\0'
if('0'<=c[i] && c[i]<='9') sum += c[i]-'0';
cout<< "Sum of digits = " << sum << endl;
getchar();
getchar();
return 0;
} 
```

我明白一切都接受 sum += c[i] - '0'; 我删除了“-'0'”，但它没有给我正确的答案。为什么是这样？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-20T09:36:00.417

这会将字符从其字符代码（例如 ASCII 中的 48）转换为其等效整数。因此，它将字符`'0'`转换为整数值 0。正如 Pete Becker 在 C 和 C++ 语言定义的评论中指出的那样，要求所有数字字符都是连续的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:47:49.350

The ascii value for 0 is 48, for 1 its 49 and so on. Now in your program `c[80]` is an array of characters. So if you input 1 from the keyboard, the compiler treats it as 49 (the ascii value) for the arithmetic operation. That's why we need to subtract the ascii value of 0 (i.e 48) to get the integer equivalent. this can be achieved either by subtracting '0' from the character or by subtracting 48 directly. e.g. if you replace `sum += c[i]-'0';` by `sum += c[i]-48;`, the code will also work. But this is not a good practice. Hope this helps.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:38:34.150

'0' 返回 ASCII 值 0。因此，要使用数字而不是它们的 ASCII 值，您需要偏移 ASCII 值 0。'1' - '0' ::= 49 - 48 ::= 1 ( 49 和 48 分别是 1 和 0 的 ASCII 值）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T09:41:13.240

它将一个字符转换为整数值：

```
character | ASCII code  | expression | equivalent | result
  '0'     |      48     | '0' - '0'  |  48 - 48   |   0
  '1'     |      49     | '1' - '0'  |  49 - 48   |   1
  '2'     |      50     | '2' - '0'  |  50 - 48   |   2
  '3'     |      51     | '3' - '0'  |  51 - 48   |   3
  '4'     |      52     | '4' - '0'  |  52 - 48   |   4
  '5'     |      53     | '5' - '0'  |  53 - 48   |   5
  '6'     |      54     | '6' - '0'  |  54 - 48   |   6
  '7'     |      55     | '7' - '0'  |  55 - 48   |   7
  '8'     |      56     | '8' - '0'  |  56 - 48   |   8
  '9'     |      57     | '9' - '0'  |  57 - 48   |   9 
```

# linux - 我们如何加载 Linux 映像以在内存中分配合适的位置

> ID：15519789
> 
> 赞同：5
> 
> 时间：2013-03-20T09:34:34.463
> 
> 标签：linux, linux-kernel, bootloader, bootstrapping

我们正在尝试将 linux 映像加载到特定位置的 DRAM 中，DRAM 结束地址是 0x80000000，我们从引导日志中了解到“mem 设备结束地址是 0x80000000”。我们正在将映像加载到地址“0x5000000”并且在图像中的 variuos 部分被加载到大于“0x80000000”的某个地址之前，例如从启动日志中再次举例

```
 loading section to address 0xc5000000 from file position 0x1000, size is 0x5ac13e 
```

上一行中“从文件位置 0x1000”的含义是什么。

加载的第一部分是 .text 部分，下面是我们的部分标题的 vmlinux 图像转储

```
[Nr]      Name           Type            Addr     Off    Size   ES Flg Lk Inf Al

[ 0]                     NULL            00000000 000000 000000 00      0   0  0

 [ 1]   .text            PROGBITS        c5000000 001000 5ac13e 00  AX  0   0 4096

 [ 2]      .notes           NOTE            c55ac140 5ad140 000168 00  AX  0   0  4

 [ 3]    __ex_table        PROGBITS        c55ac2b0 5ad2b0 000fe0 00   A  0   0  4

 [ 4]   .rodata           PROGBITS        c55ae000 5af000 20a930 00   A  0   0 64

 [ 5]   __bug_table       PROGBITS        c57b8930 7b9930 0075fc 00   A  0   0  1

 [ 6]   .pci_fixup        PROGBITS        c57bff2c 7c0f2c 001a90 00   A  0   0  4

 [ 7]    .builtin_fw       PROGBITS        c57c19bc 7c29bc 0000cc 00   A  0   0  4 
```

它是一个相当大的列表，所以没有发布完整的。但是我们可以在这里看到一件事。文本部分大于 DRAM 结束地址，所以图像不应该被正确加载，尽管在加载它保留的第一部分后我们没有收到任何错误在加载其他部分但在此消息之后它挂起。

```
 program load complete, entry point: 0x5000000, size: 0x92e7fc 
```

我的问题是如何将这些不同的部分地址与我们的 DRAM 地址对齐，是否可以在这里使用 objcopy 实用程序来更改这些不同部分的地址。

有没有办法在编译之前设置这些段地址？第二件事可能是这个 Hang afer 程序加载完成的原因。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T11:27:43.127

`from file position 0x1000`意思是它所说的。你有它在转储：

```
[Nr]      Name           Type            Addr     Off    Size   ES Flg Lk Inf Al
...
[ 1]   .text            PROGBITS        c5000000 001000 5ac13e 00  AX  0   0 4096 
```

它是该`.text`部分在文件中开始的位置，在 offset 处`0x1000`。

> 但是我们可以在这里看到的一件事 .text 部分大于 DRAM 结束地址

不，它不是*更大（至少不是**更大*的意义上），它的编译期望它将被加载`0xc5000000`到内存中的地址。

> 所以图像不应该被正确加载，尽管我们在加载第一部分后没有收到任何错误，它会继续加载其他部分

图像可以在任何地方加载，它只是用于加载目的的数据。

OTOH，如果`loading section to address 0xc5000000`意思是它所说的那样，由于您的 RAM 以`0x7fffffff`.

> 但在此消息之后它挂起。

这是意料之中的。机器代码很少与位置无关，因此如果您将其加载到与应该加载​​的位置不同的位置，它将无法工作。或者如果它甚至没有被加载，那么你要执行什么？垃圾。

> 有没有办法在编译之前设置这些段地址？

根据系统的不同，您可能拥有以下两个选项之一或两者兼有：

*   以这样一种方式设置页面转换，即虚拟地址从`0xc5000000`和向上映射到`0x5000000`整个程序的物理地址和向上
*   找到您的编译器正在使用的链接器脚本，并将初始部分地址从 更改`0xc5000000`为`0x5000000`，谷歌搜索，请参阅编译器/链接器文档

此外，入口点位于`0x5000000`. 并不是说这一定是错误的，只是这种情况很少发生。我会确保`start`标签（或`_start`其他任何标签）确实收到与本节开头相同的地址`.text`。如果由于某种原因不是这种情况，则链接器脚本或编译器/链接器命令行选项或加载程序有问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-26T14:32:54.943

你用什么装载机？“图像”的形式是什么？U-boot 镜像，raw 一，vmlinux ELF 文件？我猜最后一个是根据节的存在等来判断的。从 ELF 文件中，您应该加载的不是节，而是所谓的程序头。例如，这是 OpenRISC linux 内核程序头文件列表（使用 获得`readelf -l`）：

```
Elf file type is EXEC (Executable file)
Entry point 0xc0000000
There are 2 program headers, starting at offset 52

Program Headers:
  Type           Offset   VirtAddr   PhysAddr   FileSiz MemSiz  Flg Align
  LOAD           0x002000 0xc0000000 0x00000000 0x231728 0x232000 RWE 0x2000
  LOAD           0x234000 0xc0232000 0x00232000 0x17c78c 0x18bfcc RWE 0x2000

 Section to Segment mapping:
  Segment Sections...
   00     .text .rodata __ksymtab __ksymtab_gpl __ksymtab_strings __param __modver 
   01     .data __ex_table .head.text .init.text .init.data .bss 
```

`VirtAddr`查看和之间的区别`PhysAddr`（`c`由于通常的 Linux 内核映射而被删除）。自然地，物理地址应该用于加载。

内核为符号、节等使用虚拟地址的原因是，在引导过程中，您可以快速进入 MMU 初始化的时刻，虚拟地址是唯一有效的地址。

最后，关于更改这些地址。事实上，正如 Alexey 所指出的，链接描述文件是关键。您可以在 中找到这些`arch/(your arch)/kernel/vmlinux.lds.S`。但关键是这是 IMO 不是你的问题，问题可能在于装载机或其选项。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-30T15:24:56.997

检查你的 arch/arm/mach-xxx/Makefile.boot （你使用 arm board 对吗？）

```
 zreladdr-y        += 0x80008000
params_phys-y       := 0x80000100
initrd_phys-y       := 0x80800000 
```

这是来自 Ti omap3 芯片。

我认为您将需要相同的

# android - E/JavaBinder(2275)：未知的活页夹错误代码。0xffffff7

> ID：15519790
> 
> 赞同：3
> 
> 时间：2013-03-20T09:34:34.897
> 
> 标签：android, exception, android-logcat

我在 Android 应用程序上收到此错误。有什么解释吗？

LogCat 只需用红色写下一行：

> 03-20 10:31:08.206：E/JavaBinder(2275)：未知的活页夹错误代码。0xffffff7

**没有别的**。

**编辑：**

**解决了**。当我尝试注销空接收器时出现错误：

```
unregisterReceiver(screenStatusReceiver); 
```

如果`screenStatusReceiver`为空，我会收到此错误。

**我想知道为什么 Android 框架除了一个难以理解的消息之外**什么都不告诉...****

 ****编辑（2）：**

从`unregisterReceiver(screenStatusReceiver);` **AsyncTask.run() 调用**。也许，在这种情况下，Android 框架无法出现完整的错误消息......**

# regex - 使用 MATLAB 列出不是 .m 文件的文件

> ID：15519795
> 
> 赞同：0
> 
> 时间：2013-03-20T09:34:43.810
> 
> 标签：regex, matlab, regex-negation, dir

我可以使用以下代码列出当前目录中的所有 .m 文件`dir(fullfile('.', '*.m'))`：

但是如何更改仅列出**没有**结尾 .m 的文件的正则表达式（也应包括没有“结尾”的文件）？

任何帮助将不胜感激！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:39:13.540

怎么样

```
fls = dir( fullfile('.','*') );
sel = arrayfun( @(x) ~x.isdir && ~strcmp(x.name(end-1:end),'.m'), fls );
fls = fls(sel); 
```

# r - 在 geom_smooth() 中调整大小使不同线型的图例看起来相同

> ID：15519799
> 
> 赞同：1
> 
> 时间：2013-03-20T09:34:57.183
> 
> 标签：r, ggplot2

我想画六种不同的线型，比如这样：

```
d = data.frame(
  x=sample(1:100,30,rep=T),
  y=sample(1:100,30,rep=T),
  exp=rep(c("foo","bar","baz","yak","yaz","bla"),5)
)
ggplot(d, aes(x, y, color=exp, lty=exp)) + 
geom_point(alpha=0.15) + 
geom_smooth(size=2) 
```

这给了我以下传说：

![](../Images/49499debba165bc4d89588aa356bd52c.png)

显然，`size=2`以这样一种方式更改了此处的外观，以至于您现在无法再区分不同的线型了。级别 1、3 和 4 看起来很相似，5 和 6 也是如此。当我将其调整为`size=1`（或完全忽略大小）时，我得到了想要的结果：

![](../Images/dffd02bbfb840a4c5953f572e26bd69b.png)

有什么方法可以让图例中的不同线型得到有意义的表示，即使图中的线本身比默认线厚？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:45:22.613

您可以通过调整`size`or `width`of legend 属性来实现这一点。这些示例直接取自[**hadley 的关于 legend attributes 的 wiki**](https://github.com/hadley/ggplot2/wiki/Legend-Attributes)。

```
# size attribute
theme(legend.key.size = unit(2, "cm")) 
```

（或者）

```
# width attribute
theme(legend.key.width = unit(2, "cm")) 
```

也就是说，试试这个：

```
ggplot(d, aes(x, y, color=exp, lty=exp)) + 
geom_point(alpha=0.15) + 
geom_smooth(size=2) + 
theme(legend.key.size = unit(2, "cm")) 
```

`require(grid)`注意：如果`unit()`出现未找到错误，您可能需要加载。

**编辑：**对于您发布的示例，这是我使用此代码获得的情节：

```
ggplot(d, aes(x, y, color=exp, lty=exp)) + 
    geom_point(alpha=0.15) + 
    geom_smooth(size=2, se=FALSE) + 
    theme(legend.key.size = unit(2, "cm")) 
```

![在此处输入图像描述](../Images/1d02894127a74b070f1ae04fe328a920.png)

# c - ssl服务器程序中的非法指令

> ID：15519806
> 
> 赞同：3
> 
> 时间：2013-03-20T09:35:17.163
> 
> 标签：c, sockets, ubuntu, openssl

在我的 ssl 程序中

```
 #define RSA_SERVER_CERT     "server.crt"
 #define RSA_SERVER_KEY      "server.key"
 #define RSA_SERVER_CA_CERT "server_ca.crt"
 #define RSA_SERVER_CA_PATH   "sys$common:[syshlp.examples.ssl]"

 ............

  /* Load the server certificate into the SSL_CTX structure */
    if (SSL_CTX_use_certificate_file(ctx, RSA_SERVER_CERT, SSL_FILETYPE_PEM) <= 0) {
                ERR_print_errors_fp(stderr);
              exit(1);
   }

   ........ 
```

这是行不通的。它给出了 **非法指令**

我怎样才能找到解决方案...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:18:31.197

检查您要链接的库的“位数”与您的 gcc 所针对的体系结构。还要确保 openssl 是在没有特殊硬件指令扩展的情况下创建的（例如，ARM 设备可能有 neon 指令集扩展，x86_64 有 AVX、SSE3 和其他一些）。

还要确保使用`software`后端测试 openssl。

# html - node.js 上是否有 HTML5 Server-Sent-Events 的服务器端库？

> ID：15519807
> 
> 赞同：2
> 
> 时间：2013-03-20T09:35:24.480
> 
> 标签：html, node.js, server-sent-events

我们可以简单地编写一些代码来触发事件：

```
res.send("data: " + data + "\n\n"); 
```

但 SSE 还有其他功能，例如 Last-Event-ID、keep-alive 等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-01T18:25:54.740

大多数 SSE 功能都非常简单，以至于库将是一系列 1 行：

```
function send_sse_event(res, data) {
   res.write("data: " + data.replace(/\n/g, "data: ") + "\n\n";
}

function get_last_event_id(req) {
   return req.headers['last-event-id'];
}

function set_sse_reconnection_delay(res, ms) {
   res.write("retry: " + ms);
} 
```

您可以在没有库的情况下使用 SSE，而不会因为自己在重新发明轮子而感到内疚。

# xml - 从 XML 创建 XSLT 以转换为文本文件

> ID：15519810
> 
> 赞同：0
> 
> 时间：2013-03-20T09:35:43.887
> 
> 标签：xml, xslt

我是 XSLT 的新手。在我的一项任务中，我必须将 XML 文件转换为具有特定格式的文本文件。我想知道是否有一种简单/快速的方法来完成它。

我的 XML 如下所示

```
<?xml version="1.0" encoding="UTF-8"?>
<QTKTRes xmlns="http://www.xxx.com/app" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" creationDateTime="2013-03-19T15:40:58-05:00" transLanguage="EN" baseLanguage="EN" messageID="1363722058486545315" appVersion="5 1 20110725-1550" rsStart="0" rsCount="1" rsTotal="1">
<TKTSet>
<TKT>
  <COST>0.0</COST>
  <HRS>0.0</HRS>
  <CHANGEDATE>2013-02-19T14:59:51-05:00</CHANGEDATE>
  <TKTID>101</TKTID>
  <TKTSPEC>
    <ATTRID>PMSCR</ATTRID>
    <REID>101</REID>
    <VALUEN>RDPS</VALUE>
  </TKTSPEC>
  <TKTSPEC>
    <ATTRID>PMSCQ</ATTRID>
    <REID>101</REID>
    <VALUET>RDPQ</VALUE>
  </TKTSPEC>
<TKT>
<TKTSet>
</QTKTRes> 
```

`

我需要的输出如下：-

```
COST=0.0&
HRS=0.0&
CHANGEDATE=2013-02-19T14:59:51-05:00&
TKTID=101&
TKTSPEC.1.ATTRID=PMSCR&
TKTSPEC.1.REID=101&
TKTSPEC.1.VALUEN=RDPS&
TKTSPEC.2.ATTRID=PMSCR&
TKTSPEC.2.REID=101&
TKTSPEC.2.VALUET=RDPQ 
```

有没有我可以使用的工具，或者我需要手动编写 XSLT 样式表。我是这个地区的新手。欢迎您的宝贵回答。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:49:17.253

如果您只想列出 的子元素，`TKT`其节点名称后跟`=`，它们的值，以及`&`除最后一行之外的所有行，这应该有效：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
                xmlns:app="http://www.xxx.com/app">
  <xsl:output method="text" />
  <xsl:strip-space elements="*" />

  <xsl:template match="app:TKT//*">
    <xsl:param name="prefix" />
    <xsl:param name="inLast" select="true()" />

    <xsl:value-of select="concat($prefix, local-name(), '=', normalize-space())"/>
    <xsl:if test="not($inLast) or position() != last()">
      <xsl:text>&amp;&#xA;</xsl:text>
    </xsl:if>
  </xsl:template>

  <xsl:template match="app:TKT//*[*]">
    <xsl:param name="inLast" select="true()" />
    <xsl:variable name="num">
      <xsl:number />
    </xsl:variable>

    <xsl:apply-templates>
      <xsl:with-param name="prefix" 
                      select="concat(local-name(), '.', $num, '.')" />
      <xsl:with-param name="inLast" 
                      select="$inLast and position() = last()" />
    </xsl:apply-templates>
  </xsl:template>
</xsl:stylesheet> 
```

在您的示例输入上运行时，这会产生：

```
COST=0.0&
HRS=0.0&
CHANGEDATE=2013-02-19T14:59:51-05:00&
TKTID=101&
TKTSPEC.1.ATTRID=PMSCR&
TKTSPEC.1.REID=101&
TKTSPEC.1.VALUE=RDPS&
TKTSPEC.2.ATTRID=PMSCQ&
TKTSPEC.2.REID=101&
TKTSPEC.2.VALUE=RDPQ 
```

# typo3 - 我再也看不到后端图像的缩略图了。为什么？

> ID：15519811
> 
> 赞同：2
> 
> 时间：2013-03-20T09:35:50.907
> 
> 标签：typo3, realurl

如果我进入`Filelist`Typo3 后端并检查显示缩略图的选项，我只会看到损坏的图像链接。

但我记得缩略图在某些时候显示正常。

在拼写错误的安装工具中对 ImageMagick 的测试显示，ImageMagick 工作正常。

该怎么办？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T11:54:01.267

这不仅是 RealURL 的问题 - 尽管在用户手动操作此文件以添加自定义规则时最常见。无论如何，这个问题也出现在`typo3conf/localconf.php`.

**如何确认：**

右键单击损坏的图像并选择`Open image in new window`它将打开一个带有地址的文件：`http://somedomain.tld/typo3/thumbs.php?&file=..%2Fuploads%2...etc`使用某些浏览器预览源代码，即。在 Chrome 中，在地址前面加上`view-source:`like: `view-source:http://somedomain.tld/typo3/thumbs.php?&file=...etc`。图像代码之前不应有任何空格...

**如何预防？**

正如你所写。检查您的配置文件，如`realurl_conf.php`or`localconf.php`并确保`<?php`. 如果脚本结束....只需**删除**标记，因此脚本将`?>`自动结束而没有空格（即使您将在最后一行代码之后添加 100 个空行），不幸的是有时在配置中找到这个烦人的空间需要几个小时， 所以....

**如何永久修复？**

我很惊讶，这些年来仍然没有解决这个问题，虽然使用[ob_end_clean()](http://www.php.net/manual/en/function.ob-end-clean.php)很容易，编辑 file: `t3lib/thumbs.php`，在开头（即在 php 标签之后）添加行：

```
<?php
ob_start(); 
```

下一个 find`main()`方法，在其开始行添加清理输出缓冲区，这将删除其他文件中包含的所有垃圾：

```
function main() {
    ob_end_clean(); //here
    ... 
```

瞧！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-15T17:02:50.707

在客户端的系统管理员在其中一台服务器上更新 Plesk 后，我们得到一个空文件*/tmp/.tmp.err*，它`auto_prepend_file`在 php 配置中自动添加。

因此，所有 TYPO3 PHP 脚本都以空字符串开头。所有动态缩略图和动态生成的 XML 都被破坏了。一些独特的情况，但可能对某人有所帮助。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-17T07:56:40.300

在我们的例子中，旧版本的扩展“spamshield”会导致同样的错误。我们有 Typo3 4.7.15 和 'spamshield' 1.0.2。请检查服务器错误日志中的条目，例如：

PHP 警告：require_once(PATH_tslibclass.tslib_pibase.php)：无法打开流：第 25 行的 /typo3conf/ext/wt_spamshield/Classes/Extensions/class.tx_wtspamshield_extensions_abstract.php 中没有此类文件或目录，引用者：[http://domain .tld/typo3/sysext/cms/layout/db_layout.php?id=16](http://domain.tld/typo3/sysext/cms/layout/db_layout.php?id=16) [2013 年 9 月 17 日星期二 09:46:13] [错误] [客户端 92.203.10.178] PHP 致命错误：require_once()：需要打开失败' /typo3conf/ext/wt_spamshield/Classes/Extensions/class.tx_wtspamshield_extensions_abstract 中的 PATH_tslibclass.tslib_pibase.php' (include_path='/typo3/contrib/pear/:.:/usr/local/php-5.3/lib/php')。 php 在第 25 行，引用：[http://domain.tld/typo3/sysext/cms/layout/db_layout.php?id=16](http://domain.tld/typo3/sysext/cms/layout/db_layout.php?id=16)

将“spamshield”更新到 1.1.0 修复了它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:35:50.907

您很有可能拥有延期

> 后网址

安装。

请检查 realUrl 配置。

通常这位于

> 错字根/typo3conf/

并且被命名`realurlconf.php`，`realurl_conf.php`或`realurl_autoconf.php`

确保标记之前没有注释或空白行`<?php`，以及最后关闭的 php 标记之后没有。

清除拼写错误缓存，然后它再次工作。

# c# - WinRM - 没有 CredSSP 的第二跳

> ID：15519817
> 
> 赞同：5
> 
> 时间：2013-03-20T09:36:12.593
> 
> 标签：c#, powershell, kerberos, delegation, winrm

我想问一下是否可以仅使用 Kerberos（委托）在 WinRM 服务的“第二跳”处冒充？

CredSSP 对我来说没有解决方案，因为我无法提示用户密码.. 我正在使用 Windows 2008 R2、C#、.NET 4.0 ...

场景：我有客户端/服务器应用程序（客户端使用 ODBC 驱动程序与服务器通信）。客户端获取当前用户 Windows 凭据并传递给服务器。服务器创建线程并模拟调用者。从这个模拟线程中，我尝试使用 Kerberos 身份验证调用远程 WinRM 服务（PowerShell），但它总是失败：

System.Management.Automation.Remoting.PSRemotingTransportException：处理来自远程服务器的数据失败，并显示以下错误消息：访问被拒绝。有关详细信息，请参阅 about_Remote_Troubleshooting 帮助主题。

所以看起来调用者没有权限..

如果我调试差异在于当前主体的 ImpersonationLevel 属性（无与委托）。

*   如果我从控制台应用程序运行相同的代码，它可以工作
*   我的客户端和服务器现在在同一台机器上

感谢您的任何建议

# android - ActionBar 样式中的 indeterminateProgressBar - 填充问题

> ID：15519818
> 
> 赞同：14
> 
> 时间：2013-03-20T09:36:15.083
> 
> 标签：android, android-actionbar, actionbarsherlock

我想在我的 ActionBar 中放置一个不确定的进度条（使用 ActionBarSherlock）。一切正常，但我希望它是小进度条。我使用以下样式：

```
<style name="IndeterminateProgress" parent="@android:style/Widget.ProgressBar.Small">
    <item name="android:progressBarPadding">32dp</item>
    <item name="progressBarPadding">32dp</item>
    <item name="android:itemPadding">32dp</item>
    <item name="itemPadding">32dp</item>
</style>

<style name="Widget.Styled.ActionBar.Tiles" parent="Widget.Sherlock.Light.ActionBar">
    <item name="android:indeterminateProgressStyle">@style/IndeterminateProgress</item>
    <item name="android:progressBarPadding">32dp</item>
    <item name="progressBarPadding">32dp</item>
    <item name="android:itemPadding">32dp</item>
    <item name="itemPadding">32dp</item>
</style> 
```

问题是我无法在进度条上设置填充。正如您在上面看到的，我已经尝试了`itemPadding`and`progressBarPadding`等所有可能的组合。

结果总是一样的： ![在此处输入图像描述](../Images/b0323a0494538c80abbebb857da61081.png)

有任何想法吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-08-21T21:21:33.753

我找到了一个可行的解决方案，如何设置具有**适当大小和填充的****不确定进度条**。我的解决方案没有使用 setActionView() 的解决方法。它是内置进度条功能的解决方案，由本机操作栏 (ActionBarSherlock) 支持。进度条通过*setProgressBarIndeterminateVisibility(boolean)*方法启用/禁用。我在 Android 2、3、4 和 ldpi、mdpi、xhdpi 上对其进行了测试。

 ***![结果](../Images/344251e85511c52401bc6c6686f0bbca.png)

AndroidManifest.xml：

```
<application
    ...
    android:theme="@style/Theme.Example"> 
```

/res/values/styles.xml：

```
<resources xmlns:android="http://schemas.android.com/apk/res/android">
    ...

    <style name="Theme.Example" parent="Theme.Sherlock">
        <item name="actionBarStyle">@style/Example.ActionBar</item>
        <item name="android:actionBarStyle">@style/Example.ActionBar</item>
    </style>

    <style name="Example.ActionBar" parent="Widget.Sherlock.ActionBar">
        <item name="indeterminateProgressStyle">@style/Example.ActionBar.IndeterminateProgressBar</item>
        <item name="android:indeterminateProgressStyle">@style/Example.ActionBar.IndeterminateProgressBar</item>
    </style>

    <style name="Example.ActionBar.IndeterminateProgressBar" parent="@android:style/Widget.ProgressBar.Large.Inverse">
        <item name="android:indeterminateDrawable">@drawable/layer_list_ab_indeterminate_progress_bar</item>
        <item name="android:minWidth">@dimen/ab_indeterminate_progress_bar_size</item>
        <item name="android:maxWidth">@dimen/ab_indeterminate_progress_bar_size</item>
        <item name="android:minHeight">@dimen/ab_indeterminate_progress_bar_size</item>
        <item name="android:maxHeight">@dimen/ab_indeterminate_progress_bar_size</item>
    </style>
</resources> 
```

/res/drawable/layer_list_ab_indeterminate_progress_bar.xml：

```
<layer-list xmlns:android="http://schemas.android.com/apk/res/android">
    <item>
        <!--
        /res/drawable-mdpi/ab_indeterminate_progress_bar asset is taken from
        /sdk/platforms/android-18/data/res/mdpi/spinner_white_48.png
        and its content (optical square) is resized to ~0.6 (must be even number)

        /res/drawable-mdpi-v14/ab_indeterminate_progress_bar asset is taken from
        /sdk/platforms/android-18/data/res/mdpi/spinner_48_outer_holo.png
        and its content (optical square) is resized to 0.75
        -->
        <rotate
            android:drawable="@drawable/ab_indeterminate_progress_bar"
            android:interpolator="@android:anim/linear_interpolator"
            android:pivotX="50%"
            android:pivotY="50%"
            android:fromDegrees="0"
            android:toDegrees="360" />
    </item>
</layer-list> 
```

/res/values/dimens.xml：

```
<dimen name="ab_indeterminate_progress_bar_size">48dp</dimen> 
```

最后我创建了进度条资产。我使用了来自 Android SDK 的这两个资产：

*   /sdk/platforms/android-18/data/res/mdpi/spinner_white_48.png 适用于**Honeycomb 和更早版本**
*   /sdk/platforms/android-18/data/res/mdpi/spinner_48_outer_holo.png 用于**ICS 和更新版本**

为了获得**适当的尺寸和填充**，我们需要调整资产的大小。我将 spinner_white_48.png 调整为**~0.6**。对于 mdpi，它是 28px。它必须是偶数才能中心对称。我只调整了内容的大小，而不是整个图标。所以 mdpi 中的图标仍有 48px，但它的内容（光学正方形）更小（28px）。您可以通过这种方式轻松调整内容的大小：首先将“图像大小”更改为 28px X 28px，然后将“画布大小”更改回 48px X 48px。我将 spinner_48_outer_holo.png 调整为**0.75**。您可以下载以下资产。

为什么我对 Honeycomb- 和 ICS+ 使用不同的资产？因为如果我只使用 Holo 资源，动画在某些带有 Honeycomb- 的设备上会有点抢眼。

提示：您可以向 layer_list_ab_indeterminate_progress_bar.xml 添加另一个带有一些动画的项目。例如，标准的 Holo 进度条使用 2 个具有相反方向和不同度数范围的动画。请参阅 SDK 中的 progress_medium_holo.xml。

/res/drawable-mdpi/ab_indeterminate_progress_bar.png：

![在此处输入图像描述](../Images/91285755494a655b5249612fde635364.png)

/res/drawable-mdpi-v14/ab_indeterminate_progress_bar.png （在此页面上几乎看不到）：

![在此处输入图像描述](../Images/060dee35ae593b61507315996b6fba19.png)

/res/drawable-hdpi/ab_indeterminate_progress_bar.png：

![在此处输入图像描述](../Images/8d7d60e39b6990f5014d48c3ee72ae77.png)

/res/drawable-hdpi-v14/ab_indeterminate_progress_bar.png （在此页面上几乎看不到）：

![在此处输入图像描述](../Images/3c7976b2b045ca888ff696992ce66b1b.png)

/res/drawable-xhdpi/ab_indeterminate_progress_bar.png：

![在此处输入图像描述](../Images/13661c9f4a29e7fefb30f1c5dc3b1c89.png)

/res/drawable-xhdpi-v14/ab_indeterminate_progress_bar.png （在此页面上几乎看不到）：

![在此处输入图像描述](../Images/65ac49101b86345eeb814f95dba61cc0.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T14:08:34.863

我不知道确切的答案，但这些设置对我有用..

这是我的 refresh_spinner.xml

```
 <?xml version="1.0" encoding="utf-8"?>
<FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:gravity="center">
<ProgressBar android:layout_width="32dp"
 android:layout_height="32dp"
 android:layout_gravity="center"
 android:layout_marginRight="12dp"
 android:layout_marginLeft="12dp"
 style="?indeterminateProgressStyle" />
    </FrameLayout> 
```

而这在对应的样式xml中

```
<style name="Widget.MyTheme.ActionBar" parent="Widget.Sherlock.ActionBar">
    <item name="indeterminateProgressStyle">?android:attr/progressBarStyleSmallInverse</item>
</style> 
```

这些设置对我有用。如果您有任何疑问，请告诉我。

问候帕尔瓦兹·巴斯卡

EDIT2：因为我尝试了不同的方法，所以我最终使用 ?android:attr/progressBarStyleSmallInverse 作为我的 style.xml 中的唯一属性，后来我从我的微调器 xml 中将它引用为 style="?indeterminateProgressStyle"

编辑：保留对 menuItem 的引用，每当您想显示刷新进度条时，请使用 setActionView(R.layout.your_layout)，并在需要结束时将其更改为 null。onCreateOptionsMenu 将是在开始时获取 menuItem 的好地方。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-09-25T12:28:17.350

我今天遇到这个并找到适用于**Android 3/4+的解决方案**

```
ProgressBar mProgressBarInActionBar = null;
Resources res = Resources.getSystem();
int id = res.getIdentifier("progress_circular", "id", "android");
View internal = findViewById(id);
if(internal != null && internal instanceof ProgressBar){
    mProgressBarInActionBar = (ProgressBar)internal;
}
mProgressBarInActionBar.setPadding(0, 0, right, 0); 
```

设置合适的**权利**:)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-11-10T12:05:53.380

我有同样的问题，我找到了一个简单的答案：

```
<style name="ActionBarProgressBar.MyStyle" parent="@android:style/Widget.Holo.ProgressBar.Large">
        <item name="android:minWidth">56dp</item>
        <item name="android:maxWidth">56dp</item>
        <item name="android:minHeight">35dp</item>
        <item name="android:maxHeight">35dp</item>
</style> 
```

Width 是标准的 Actionbar 项宽度。如果更改 minHeight 和 maxHeight，则图像将双向缩放。

这是设置 Indeterminate Progress 外观的 Actionbar 样式：

```
<style name="action_bar_theme" parent="@android:style/Widget.Holo.ActionBar">
        <item name="android:indeterminateProgressStyle">@style/ActionBarProgressBar.MyStyle</item>
</style> 
```

以及您正在使用的主题中的定义（不要忘记在清单中使用它）：

```
<style name="AppTheme" parent="Theme.AppCompat.Light.DarkActionBar">
        <item name="android:actionBarStyle">@style/action_bar_theme</item>     
</style> 
```***

# c# - C# 中的 ArrayList 是否可以包含各种类型的对象？

> ID：15519822
> 
> 赞同：-4
> 
> 时间：2013-03-20T09:36:43.030
> 
> 标签：c#, arraylist

是否有可能做这样的事情：

```
ArrayList arl = new ArrayList();
arl.Add(1);
arl.Add("test");

int[,] tab = new int[4, 4];
init(tab);

arl.Add(tab); 
```

是否可以包含各种类型的对象（如 JavaScript 或 Lua）？（C＃）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:38:24.307

是的，有可能。ArrayList 存储类型的集合，这`object`意味着您可以插入任何`.NET`类型。

你真的应该使用`List<T>`. 例如：

```
 List<int> listIntegers = new List<int>();
 listIntegers.Add(1); 
```

您也可以使用`List<object>`，但是您必须将列表中的所有项目拆箱。这可能会导致性能问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:39:15.073

是的，ArrayList 包含 object 类型的元素，因此这意味着您可以将所有内容放入其中。再次检索它时，您可以将其恢复为原始类型。当然，由于这种铸造，它的效率较低。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:39:00.623

是的，因为它不进行任何类型检查，所以它*有时*会比`List<T>`使用引用类型时更快，尽管当你有一个完美的类型安全替代方案时，通常不建议使用它。

任何继承自的类型`object`都可以存储在`ArrayList`. 每当您访问 an 中的项目时，`ArrayList`您必须小心将其转换为正确的类型，否则您将收到编译器错误。

我相信`ArrayList`这是.Net中泛型类型之前的旧遗物

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:44:46.993

至于您的问题，是的`ArrayList`可以包含各种对象类型。
微软一般建议改为使用，以防止在使用相同类型时`List<T>`需要对 Type 进行装箱和拆箱。`object`

如果您有重复的类型模式，那么定义自定义类可能会更有帮助（并且更快）：

```
protected class arl_items
{
   public string item1 {get; set;};
   public int item2 {get; set;};
   public int[4,4] item3 {get; set;};
} 
```

然后去：

```
List<arl_items> arl = new List<arl_items>(); 
```

但是，如果您的值类型*没有模式*，您也可以使用`ArrayList`，因为创建`List<object>`将毫无意义，因为它们是相同的。

顺便说一句。我更喜欢使用`List<object>`ArrayList，但这只是我个人的偏好

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T09:49:12.807

您可以`ArrayList` 尝试以下不同的类型：

```
var ary = new ArrayList();

ary.Add("some string");
ary.Add(23.4);
ary.Add(new StringBuilder());
ary.Add("some other string"); 
```

然后，您可以像这样查询它：

```
string[] strings = ary.OfType<string>();
StringBuilder[] stringBuilders = ary.OfType<StringBuilder>(); 
```

# javascript - Jquery :not() 选择器不起作用

> ID：15519825
> 
> 赞同：1
> 
> 时间：2013-03-20T09:36:51.877
> 
> 标签：javascript, jquery

我有一段代码允许从子节点中删除文本，如下所示：

```
$.fn.removeText = function() {
    for (var i=this.length-1; i>=0; --i) removeText(this[i]);
};
function removeText(node) {
    if (!node) return;
    for (var i=node.childNodes.length-1; i>=0; --i) {
        var childNode = node.childNodes[i];
        if (childNode.nodeType === 3) node.removeChild(childNode);
        else if (childNode.nodeType === 1) removeText(childNode);
    }   
} 
$('body').removeText(); 
```

所以现在我试图排除元素，例如像这样的跨度：

```
$('body:not(span)').removeText(); 
```

它不起作用，一切都被删除了。我尝试了其他几个（Jquery）没有运气的东西。我必须更改`removeText()`功能吗？我真的很想坚持使用 Jquery .. 还有什么我可以尝试的吗？

[示例 JsFiddle](http://jsfiddle.net/hcKsX/2/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:39:22.840

您需要在`body`和`:not()`选择器之间添加一个空格

```
$("body :not(span)") 
```

没有空间，你实际上说的是给我身体，那不是跨度元素——它总是真实的，只返回身体元素。

有了空间，你说，给我所有不是跨度元素的身体元素的孩子。

**更新：**

我相信您看到的问题是 jQuery 不选择文本节点（至少据我所知）。这个[SO answer](https://stackoverflow.com/a/4399718/678801)提出了一种选择后代文本节点的方法。

在您的小提琴中，唯一可选择的主体后代元素是跨度，您可以使用选择器选择退出该元素`:not(span)`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:42:42.570

该选择器`$('body:not(span)')`意味着您想要所有`body`不是跨度的标签。

试试`$(':not(span)')`吧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:53:52.370

试试这个...

`$("body").find("*").not('span').removeText();`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:44:57.693

最简单的方法是在所有内容周围添加一个包装器。

`<div class="wrapper">`

[http://jsfiddle.net/btevfik/gPB6e/](http://jsfiddle.net/btevfik/gPB6e/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-20T14:15:29.303

我发现了一种非常简单的方法，以防万一有人感兴趣。它就在 Jquery 文档中，而且非常简单......

```
 $('body *').contents().filter(function() {
      return this.nodeType == 3;
    })

//Then do your thing
      .remove(); 
```

[JSfiddle 示例](http://jsfiddle.net/gPB6e/3/)

# ios - 使用 LLDB 调试器时，Xcode 4.6 挂起“附加到...”

> ID：15519828
> 
> 赞同：2
> 
> 时间：2013-03-20T09:37:06.303
> 
> 标签：ios, xcode, lldb

正如标题所说，我在使用 LLDB 时遇到了问题。当调试器设置为 LLDB 并按照给出的说明进行操作时，我已经查看了这个线程[Xcode 4 挂起附加到（应用程序名称），](https://stackoverflow.com/questions/10911117/xcode-4-hangs-on-attaching-to-app-name-when-debugger-is-set-to-lldb)因为我遇到了完全相同的问题，并设法通过使用 GDB 进行调试——它完美地工作。无论如何，我在一个团队中工作，我是唯一一个遇到这个问题的人，所以每次我提交更改时从 GDB 切换到 LLDB 有点烦人，所以解决方法不会在远程存储库。

我检查了编译器，它设置为 LLVM 4.2。事实上，该应用程序可以完美编译并安装在模拟器中（我可以在杀死并重新启动 Xcode 后执行它）。我会尝试重新安装 Xcode，但它是一个大包，而且我对我的互联网使用有限制，这会需要很长时间。有谁知道这里发生了什么？是否有可能 LLGB 捆绑在 XCode 之外，即使我未能在系统上找到它？

任何见解将不胜感激。我可以继续使用解决方法，只是考虑到我的个人情况，这有点烦人:-)

编辑：有关我所说的“挂起”的更多详细信息。我从打开 Xcode 开始，然后关闭模拟器（它甚至没有出现在 Dock 上）。我点击“运行”，模拟器启动成功，应用程序显示启动画面。然后 xcode 显示消息：“附加到”。现在它挂了。您可以关闭模​​拟器，并且 xcode 仍在附加。运行和停止按钮都停止工作。您可以尝试通过右键单击 Dock 来退出应用程序，您会收到一条警告消息，此时您甚至无法输入代码：XCode 已完全挂起。这里唯一的选择是使用 Cmd+Alt+Esc 杀死 XCode。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-22T03:05:38.293

这听起来可能是一些人在[为什么 LLDB 调试器经常无法附加？](https://stackoverflow.com/questions/15174282/why-does-the-lldb-debugger-constantly-fail-to-attach)他们在哪里修改了`/etc/hosts`文件，所以当 Xcode 尝试通过“localhost”连接到调试服务器时，连接从未建立。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:55:59.537

当 Xcode 挂起时，尝试通过单击其 Dock 图标切换到 Simulator。不要使用 Cmd+Tab。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-21T23:36:43.577

升级到 XCode 4.6.2 为我解决了这个问题

# c# - 通过命令行更新动态 Web 参考（wsdl 工具）

> ID：15519829
> 
> 赞同：1
> 
> 时间：2013-03-20T09:37:14.463
> 
> 标签：c#, web-services, web-reference, wsdl.exe

我在使用 WSDL.exe 工具更新动态 Web 引用时遇到问题。

当我在 VS 中使用“更新 Web 参考”时，一切都按预期工作。下面是生成的代码（Reference.cs 文件的一部分）：

```
 public MyService() {
        this.Url = global::ServerReference.Properties.Settings.Default.ServerReference_Reference_MyService;
        if ((this.IsLocalFileSystemWebService(this.Url) == true)) {
            this.UseDefaultCredentials = true;
            this.useDefaultCredentialsSetExplicitly = false;
        }
        else {
            this.useDefaultCredentialsSetExplicitly = true;
        }
    } 
```

我从应用程序属性中获取必要的信息，然后将这些信息存储在配置文件中，因此可以在不重建应用程序的情况下进行更改。

但是，当我使用以下命令时：

```
.\tools\wsdl.exe /l:cs /n:ServerReference /o".\ServerReference\Web References\Reference\Reference.cs" http://localhost:52956/MyService/MyService.asmx 
```

它是在 Reference.cs 文件中使用固定 URL 地址创建的。

有人知道我应该如何更改命令以实现与Visual Studio 中相同的*Reference.cs文件吗？*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:28:55.983

我认为您不能使用 wsdl.exe 生成相同的代码。但是，如果您想要实现的主要目标是生成从 app.config 获取服务地址的代码，那么您可以使用带有“/appsettingurlkey”开关的 wsdl.exe。

您将获得的代码将是这样的：

```
public WebService1() {
    string urlSetting = System.Configuration.ConfigurationManager.AppSettings["ConfigKeyForServiceUrl"];
    if ((urlSetting != null)) {
        this.Url = urlSetting;
    }
    else {
        this.Url = "http://localhost:65304/WebService1.asmx";
    }
} 
```

请注意，它通过 Settings 类从“appSettings”而不是“applicationSettings”中读取，因此您必须修改您的 app.config。而且它也不包含“UseDefaultCredentials”的东西。

# java - 在 Play Framework 2 中进行多文件上传的示例

> ID：15519830
> 
> 赞同：2
> 
> 时间：2013-03-20T09:37:14.540
> 
> 标签：java, file-upload, nullpointerexception, playframework-2.0

请帮我寻找在 Play Framework 2 (Java) 中上传多个文件的示例。

我试试这段代码：

```
public static Result saveImages() {
    File dir = new File(Play.application().path() + File.separator + "public" + File.separator + "uploads");
    if (!dir.exists()) {
        dir.mkdirs();
    }
    FileOutputStream moveTo = null;
    String filename = request().headers().get("x-file-name").toString();
    Logger.info("Name of the file " + filename);
    return ok();
} 
```

在我看来 ：

```
 <form action="save_image" method="POST" enctype="multipart/form-data">
        <input type="file" name="image" />
        <input type="submit" value="save">
    </form> 
```

但是这段代码给了我一个错误`NullPointerException`：

```
String filename = request().headers().get("x-file-name").toString(); 
```

堆栈跟踪 ：

```
[error] application - 

! @6dkiaiban - Internal server error, for (POST) [/save_image] ->

 play.api.Application$$anon$1: Execution exception[[NullPointerException: null]]
at play.api.Application$class.handleError(Application.scala:289) ~[play_2.10.jar:2.1.0]
at play.api.DefaultApplication.handleError(Application.scala:383) [play_2.10.jar:2.1.0]
at play.core.server.netty.PlayDefaultUpstreamHandler$$anon$2$$anonfun$handle$1.apply(PlayDefaultUpstreamHandler.scala:132) [play_2.10.jar:2.1.0]
at play.core.server.netty.PlayDefaultUpstreamHandler$$anon$2$$anonfun$handle$1.apply(PlayDefaultUpstreamHandler.scala:128) [play_2.10.jar:2.1.0]
at play.api.libs.concurrent.PlayPromise$$anonfun$extend1$1.apply(Promise.scala:113) [play_2.10.jar:2.1.0]
at play.api.libs.concurrent.PlayPromise$$anonfun$extend1$1.apply(Promise.scala:113) [play_2.10.jar:2.1.0]
 java.lang.NullPointerException: null
at controllers.Realty.saveImages(Realty.java:76) ~[na:na]
at Routes$$anonfun$routes$1$$anonfun$applyOrElse$9$$anonfun$apply$9.apply(routes_routing.scala:253) ~[na:na]
at Routes$$anonfun$routes$1$$anonfun$applyOrElse$9$$anonfun$apply$9.apply(routes_routing.scala:253) ~[na:na]
at play.core.Router$HandlerInvoker$$anon$6$$anon$2.invocation(Router.scala:141) ~[play_2.10.jar:2.1.0]
at play.core.Router$Routes$$anon$1.invocation(Router.scala:322) ~[play_2.10.jar:2.1.0]
at play.core.j.JavaAction$$anon$1.call(JavaAction.scala:31) ~[play_2.10.jar:2.1.0] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T15:03:18.100

如果有人正在寻找一种从 POST 请求中提取文件的方法，以下对我有用：

（输入的属性名称设置为“jsonFile”）

```
Http.MultipartFormData body = request().body().asMultipartFormData();
Http.MultipartFormData.FilePart resourceFile = body.getFile("jsonFile");

if( resourceFile != null )
{
    File uploadedFile = resourceFile.getFile();
} 
```

编辑：编辑以供参考，因为我刚刚注意到这个问题相当古老

# spring - 使用 spring 3.0 进行用户身份验证

> ID：15519831
> 
> 赞同：0
> 
> 时间：2013-03-20T09:37:15.057
> 
> 标签：spring, spring-mvc

我尝试在 Google 中搜索，但我找不到任何使用数据库检查用户名和密码以进行身份​​验证的好的示例。

用更简单的话来说，我如何使用 Spring 和 Hibernate 而不是 SPRING SECURITY 创建一个简单的登录表单，其中使用数据库检查凭据。

请帮助我创建一个只有 Spring 3.0 而没有 Spring Security 3.0 的简单登录表单。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:16:45.783

将登录表单发布到以用户名和密码作为参数的 Spring 控制器的最简单方法。

在控制器中，您可以执行任何您想要验证用户名和密码的操作。最好是委托给一些负责处理它的服务层。

如果成功通过身份验证，那么您想做什么？可能被重定向到主页。

现在主页渲染应该知道用户已经通过身份验证。这就是 Spring Security 提供帮助的地方。

但是您也可以通过编写一个 Servlet 过滤器来实现，在该过滤器中，您可以通过检查 http 会话来检查用户是否已经通过身份验证。当然，成功登录后，您需要将其存储在会话中，然后只有它可用于过滤器。

有许多其他方法可以实现相同的目标，这取决于您的要求以及需要哪种安全控制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:39:37.253

Your solution has two parts, one of which involves Spring and another that is your code:

```
// DAO returns null if no such username appears in the table.
String password = userDao.findPassword(username);
boolean isValidUser = (!password.equals(null));
// Write the code to implement behavior for valid and invalid users. 
```

If you can do a database SELECT for a password, you can do Spring authentication without Spring Security.

You may need to put that logic in an aspect that's woven in before method calls.

You may want to cache that result in session and invalidate it if a timeout is exceeded.

# python - 如何在 kivy 语言中使用布局背景

> ID：15519838
> 
> 赞同：4
> 
> 时间：2013-03-20T09:37:41.437
> 
> 标签：python, kivy

如何使用kivy语言设置StackLayout背景，在stacklayout.py中，我找不到如何使用；

```
<MainScreen>:
    view: view
    FloatLayout:
        StackLayout:
            orientation: 'lr-bt'
            spacing: 50
            id: view
            pos: 0, 20
            background_color:(1,1,1,1)
            ButtonImage:                                                                                                                                                                                                                    
                image: 'bv_a_pic_confirm'
                callback: root.do_confirm
                no_toggle: True 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-20T16:22:18.503

Layout 和 Widget 类没有 background_color 属性。而是使用画布：

```
StackLayout:
    canvas:
        Color:
            rgba: 1, 1, 1, 1
        Rectangle:
            pos: self.pos
            size: self.size 
```

# node.js - 集合没有在 mongodb 中被删除

> ID：15519841
> 
> 赞同：0
> 
> 时间：2013-03-20T09:37:59.577
> 
> 标签：node.js, mongodb, cron, mongoose

嗨，我正在根据时间删除我的数据库。我正在使用 cron 设置时间并删除数据库。下面是代码

```
var cronJob = require('cron').CronJob;
new cronJob('* * * * *', function(){// set the required time
  console.log('inside cron');
  console.log(new Date());
  console.log('You will see this message every minute');
  dbDatadeletion();
}, null, true);

//This function performs the required operations after a particular time
function dbDatadeletion(){
  var mongoose = require('mongoose'); 
  var db1 = mongoose.createConnection('mongodb://localhost/CDB');

  db1.on('error', console.error.bind(console, 'connection error:')); 
  db1.once('open', function callback (){ 
    console.log('Database connectivity established...\n');
    var schema = new mongoose.Schema({ USER_ID:String, APIKEY:String, SERVICE_ORCH_NAME:String, COLLATED_DATA:String });
    var C_DATA_STORE = db1.model('C_DATA_STORE', schema);
    var query = C_DATA_STORE.find();

    console.log('Query Operation is being performed...');
    query.select('COLLATED_DATA SERVICE_ORCH_NAME');
    query.exec(function (err, data) {
      if (err) return handleError(err);
      console.log('Before Deletion');
      console.log(data[0]);
      db1.C_DATA_STORE.remove();
      console.log('After Deletion');
      console.log(data[0]);
    });
  });
} 
```

当我运行上述代码时，我无法删除我的收藏。以下是错误消息

```
TypeError: Cannot call method 'remove' of undefined 
```

任何想法如何解决这个问题都会非常有帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T12:59:40.353

要从集合中删除所有文档：

```
C_DATA_STORE.remove(callback) 
```

要删除集合，请使用驱动程序方法：

```
C_DATA_STORE.collection.drop(callback) 
```

要删除数据库，请使用驱动程序方法：

```
db1.db.dropDatabase(callback) 
```

# ember.js - Ember.js 从另一个控制器访问控制器模型

> ID：15519843
> 
> 赞同：0
> 
> 时间：2013-03-20T09:38:01.200
> 
> 标签：ember.js

已经有几个问题要求类似的事情，但到目前为止，没有一个答案对我有用。我有以下代码，我想从 DashboardController 中的 UsersController 访问模型：

```
JP.DashboardController =  Ember.ArrayController.extend({
  needs: ['users']
});

JP.UsersController =  Ember.ArrayController.extend({
      model: function(){
        return JP.User.find();
    },
    sortProperties: ['id']
}); 
```

我的 dashboard.template 看起来像这样：

```
<div class="row-fluid">
  <div class="span2">
    {{#if controllers.users.isLoaded}}
            {{#each user in controllers.users }}
                {{user.name}}
            {{/each}}
    {{else}}
            Users not loaded
    {{/if}}
  </div>
  <div class="span10">
      {{ outlet }}
  </div>
</div> 
```

为什么永远不会加载用户？我的代码有什么问题？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:58:23.970

您的 UsersController 中的模型函数是问题的原因。**始终将真实对象（或对象数组）分配给控制器的模型/内容属性。您应该在 Route 而不是 Controller 中获取数据。**我猜你也有一个UsersRoute，如果你有一个UsersController？这可以工作：

```
JP.UsersRoute = Ember.Route.extend({
  setupController : function(controller){
   // the controller param is the instance of UsersController
   controller.set("model",JP.User.find());
  }
});
JP.UsersController =  Ember.ArrayController.extend({
    sortProperties: ['id']
}); 
```

如果你没有 UsersRoute 而只有一个 DashboardRoute，试试这个：

```
JP.DashboardRoute = Ember.Route.extend({
  setupController : function(controller){
   // the controller param is the instance of DashboardController, so we have to get the UsersController first
   this.controller("users").set("model",JP.User.find());
  }
}); 
```

# java - 用于为 JAX-WS 客户端下载/导入 WSDL 文件的工具

> ID：15519848
> 
> 赞同：0
> 
> 时间：2013-03-20T09:38:07.897
> 
> 标签：java, jax-ws, cxf

我正在使用一个 Web 服务，其中 WSDL 文件包含对其他 wsdl 和 xsd 模式的导入，例如：

```
<import namespace="http://my.api.com/" location="http://other.server.com:8888/context/services/MyService?wsdl=1"/> 
```

进而可以导入其他文件

```
<xsd:import namespace="http://my.api.com/" schemaLocation="http://other.server.com:8888/context/services/MyService?xsd=1"/> 
```

客户端由 cxf 使用 maven 插件生成。主 WSDL 文件作为类路径资源添加。但是，在运行时，客户端似乎实际上需要访问 other.server.com:8888 才能完全解析 WSDL。所以问题是，是否存在用于导入和解析 WSDL 中的所有 URL 的工具，以便它不依赖 WSDL 中其他导入中的绝对服务器 URL，并且适合包含在客户端项目中？

我们不控制 WSDL，因此我们无法在源代码中更改它。

编辑：寻找适用于 Linux 的工具

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T01:12:57.307

检查 Windows SDK 中的[ServiceModel 元数据实用工具 (Svcutil.exe)](http://msdn.microsoft.com/en-us/library/aa751847.aspx)。

```
svcutil /t:metadata http://service/metadataEndpoint 
```

> 此工具使用 Web 服务描述语言 (WSDL)*定位*或*发现*描述特定 XML Web 服务的一个或多个相关文档。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-24T14:27:18.733

我不知道我是否正确理解了你的问题。我也在与 Jax-ws/SOAP 进行战斗。:)

如果您需要生成调用 web 服务所需的 java 类，您可以使用[Apache CXF](http://cxf.apache.org/)。在它里面你有一个wsdl2java。你可以在linux上使用它。Java SDK 中的另一个选项，在 bin 文件夹中，您也可以使用 wsimport。

编辑：您可以在运行时使用 Apache CXF 创建的服务类更改最终 URL。

```
new SomeRandomJaxWSService(new URL(wsdl),new QName(namespace, serviceName)) 
```

# memory-management - Monotouch UITableviewCells 从未被破坏

> ID：15519850
> 
> 赞同：0
> 
> 时间：2013-03-20T09:38:09.620
> 
> 标签：memory-management, uitableview, memory-leaks, xamarin.ios

我有一个`UITableView`名为 WaitTableView 的控制器。它只有一个单元格，这是`UITableViewCell`该类的代码：

```
 public class TableViewWaitCell : UITableViewCell
    {
        public UIActivityIndicatorView activityIndicator = new UIActivityIndicatorView(UIActivityIndicatorViewStyle.Gray);
        public UILabel lblLoading = new UILabel();

        public TableViewWaitCell(UITableViewCellStyle style, string reuseIdentifier) : base (style, reuseIdentifier)
        {
            this.SelectionStyle = UITableViewCellSelectionStyle.None;
        }

        ~TableViewWaitCell(){
            System.Console.WriteLine("TableViewWaitCell.~TableViewWaitCell");
            lblLoading = null;
            activityIndicator = null;   
            System.GC.Collect();
        }
       protected override void Dispose (bool disposing){
            System.Console.WriteLine("TableViewWaitCell.Dispose");
            lblLoading = null;
            activityIndicator = null;
            base.Dispose (disposing);
            GC.Collect();
        }

        public override void Draw (System.Drawing.RectangleF rect)
        {
            base.Draw (rect);

            var context = UIGraphics.GetCurrentContext();
            var gradient = new CGGradient(
            CGColorSpace.CreateDeviceRGB(),
                new float[] { 1f, 1f, 1f, 1f,
                              0.68f, 0.68f, 0.72f, 1f },
                new float[] { 0f, 1f } );
                context.DrawLinearGradient(gradient,
                    new PointF(rect.X+rect.Width/2, rect.Y),
                    new PointF(rect.X+rect.Width/2, rect.Y+rect.Height),
                    CGGradientDrawingOptions.DrawsAfterEndLocation);

            var activityIndicatorViewFrame = new RectangleF(rect.X + rect.Width/2-10, rect.Y+10, 20, 20);
            this.activityIndicator  .Frame = activityIndicatorViewFrame;
            this.activityIndicator.AutoresizingMask = UIViewAutoresizing.FlexibleDimensions;
            this.activityIndicator.StartAnimating();
            this.AddSubview(this.activityIndicator);

            var labelFrame = new RectangleF(rect.X, rect.Y+10+activityIndicatorViewFrame.Height, rect.Width, 35);
            this.lblLoading.Frame = labelFrame;
            this.lblLoading.AutoresizingMask = UIViewAutoresizing.FlexibleDimensions;
            this.lblLoading.TextColor = UIColor.Black;
            this.lblLoading.BackgroundColor = UIColor.Clear;
            this.lblLoading.TextAlignment = UITextAlignment.Center;
            this.lblLoading.Text = Dictionary.GetValue("Loading");
            this.AddSubview(this.lblLoading);
        }
    } 
```

这是`ViewWillDisappear`主要的方法`UIViewController`：

```
 public override void ViewWillDisappear (bool animated)
    {
        Console.WriteLine("SpotlightView.ViewWillDisappear");
        if(this.PopoverController!=null)
            this.PopoverController.Dismiss(true);
        this.PopoverController = null;
        this.tableView.RemoveFromSuperview();
        this.WaitTableView.RemoveFromSuperview();
        this.searchBar.RemoveFromSuperview();
        this.tableView.Source = null;
        this.tableView.Dispose();
        this.tableView = null;
        this.WaitTableView.Source = null;
        this.WaitTableView.Dispose();
        this.WaitTableView = null;
        this.searchBar.Delegate = null;
        this.searchBar.Dispose();
        this.searchBar = null;

        base.ViewWillDisappear (animated);
    } 
```

我的问题是我的细胞的析构函数和 Dispose 都没有被调用。当我运行 heapshot 时，TableViewWaitCell 类的实例数量增加了我浏览我的应用程序。我不明白 Monotouch 是如何管理细胞生命周期的，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-21T04:47:47.323

在您共享的代码中，我没有看到任何会导致此问题的内容。但是，您没有显示单元是如何构造和存储的。您的对象可能会通过您未在示例代码中显示的根保持活动状态。我在下面创建了一个示例，显示了 Dispose 和正在调用的终结器。

使用模拟器可以快速收集表格视图和单元格。通常在第二次按下“显示表格”按钮后。

在设备上运行会显示不同的行为。表格和单元格不会立即收集。最简单的解释是 GC 被“调整”为仅在需要时运行。因此，如果您的应用程序没有使用太多内存，所有对象都将继续存在。

如示例中所示，您可以执行两件事来强制 GC 运行。

```
showTable.TouchUpInside += delegate {
    navController.PushViewController (new MyViewController (), true);
    // Not a great idea to call Collect but you could to force it.
    // GC.Collect ();
};

allocate.TouchUpInside += delegate {
    // Trigger the GC by creating a bunch of objects
    System.Collections.Generic.List<object> list = new System.Collections.Generic.List <object> ();
    for (int i=0; i<2048; i++)
    {
        list.Add (new object ());
    }
}; 
```

首先你可以调用 GC.Collect。但是我不建议这样做。当你让它运行时，GC 会运行得最好。（在大多数情况下。） [何时可以调用 GC.Collect？](https://stackoverflow.com/questions/478167/when-is-it-acceptable-to-call-gc-collect)

其次，继续编写代码，让 GC 决定什么是最好的。在示例中，我添加了另一个按钮，用于分配一堆对象并将它们添加到列表中。因此，如果您在表格视图和主视图之间切换几次，然后按几次分配按钮，您应该会看到终结器运行。

```
using System;
using MonoTouch.Foundation;
using MonoTouch.UIKit;
using MonoTouch.CoreGraphics;
using System.Drawing;

namespace delete20130320
{
    [Register ("AppDelegate")]
    public partial class AppDelegate : UIApplicationDelegate
    {
        UIWindow window;

        public override bool FinishedLaunching (UIApplication app, NSDictionary options)
        {
            window = new UIWindow (UIScreen.MainScreen.Bounds);

            var mainView = new UIViewController ();
            var showTable = UIButton.FromType (UIButtonType.RoundedRect);
            showTable.Frame = new System.Drawing.RectangleF (10, 10, 150, 35);
            showTable.SetTitle ("Show Table", UIControlState.Normal);

            var allocate = UIButton.FromType (UIButtonType.RoundedRect);
            allocate.Frame = new System.Drawing.RectangleF (10, 55, 150, 35);
            allocate.SetTitle ("Allocate", UIControlState.Normal);

            mainView.View.BackgroundColor = UIColor.White;
            mainView.View.Add (showTable);
            mainView.View.Add (allocate);

            var navController = new UINavigationController (mainView);

            showTable.TouchUpInside += delegate {
                navController.PushViewController (new MyViewController (), true);
                // Not a great idea to call Collect but you could to force it.
                // GC.Collect ();
            };

            allocate.TouchUpInside += delegate {
                // Trigger the GC by creating a bunch of objects
                System.Collections.Generic.List<object> list = new System.Collections.Generic.List <object> ();
                for (int i=0; i<2048; i++)
                {
                    list.Add (new object ());
                }
            };

            window.RootViewController = navController;

            window.MakeKeyAndVisible ();

            return true;
        }
    }

    public class MyViewController : UIViewController
    {
        UITableView _tableView;
        public override void ViewDidLoad ()
        {
            base.ViewDidLoad ();
            _tableView = new UITableView (this.View.Bounds);
            View.Add (_tableView);

            _tableView.DataSource = new MyDataSource ();
        }

        ~MyViewController ()
        {
            // Bad practice to call other managed objects in finalizer
            // But for sample purposes it will be ok
            Console.WriteLine ("~MyViewController");
        }

        protected override void Dispose (bool disposing)
        {
            // Bad practice to call other managed objects in Dispose
            // But for sample purposes it will be ok
            Console.WriteLine ("MyViewController.Dispose");
            base.Dispose (disposing);
        }

        class MyDataSource : UITableViewDataSource
        {
            public override int RowsInSection (UITableView tableView, int section)
            {
                return 1;
            }

            public override UITableViewCell GetCell (UITableView tableView, NSIndexPath indexPath)
            {
                var cell = tableView.DequeueReusableCell ("SomeUniqueString");
                if (cell != null)
                    return cell;

                return new TableViewWaitCell (UITableViewCellStyle.Default, "SomeUniqueString");
            }
        }
    }

    public class TableViewWaitCell : UITableViewCell
    {
        public TableViewWaitCell(UITableViewCellStyle style, string reuseIdentifier) : base (style, reuseIdentifier)
        {
            this.SelectionStyle = UITableViewCellSelectionStyle.None;
            this.TextLabel.Text = "Something";
        }

        ~TableViewWaitCell()
        {
            // Bad practice to call other managed objects in finalizer
            // But for sample purposes it will be ok
            System.Console.WriteLine("TableViewWaitCell.~TableViewWaitCell"); 
            // Avoid forcing the GC
            //System.GC.Collect();
        }
        protected override void Dispose (bool disposing)
        {
            // Bad practice to call other managed objects in Dispose
            // But for sample purposes it will be ok
            System.Console.WriteLine("TableViewWaitCell.Dispose");
            base.Dispose (disposing);
            //GC.Collect();
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-04T13:43:36.680

问题来自一个 EventHandler，它引用了我的视图控制器的一个方法，从而阻止了我的单元格和我的控制器的集合。

# regex - 正则表达式在特定位置查找值

> ID：15519851
> 
> 赞同：1
> 
> 时间：2013-03-20T09:38:10.833
> 
> 标签：regex

目前正则表达式是：

```
[A-Z]+(?=-\d+$) 
```

这将为遵循以下格式的大多数字符串提取正确的值：

```
ANG-RGN-SOR-BCP-0004             i.e. BCP 
```

但是，它会提取`SS`以下文档而不是`PMR`：

```
ANG-B31-OPS-PMR-MACE-SS-0229 
```

所以基本上我想去掉第四个词（在连字符之间），所以它应该选择`BCP`and `PMR`。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:43:55.477

以下正则表达式将获得第 1 组中的第 4 项：

```
(?:[A-Z0-9]+-){3}([A-Z0-9]+) 
```

*   第一位`(?:...)`是“非捕获组”，它的作用类似于一个组，但不会出现在反向引用列表中。
*   下一位表示“这些非捕获组中的 3 个”。
*   最后，一个捕获组来收集你想要的东西。

我在这里假设所有组仅包含大写字母和数字，您应该修改其中的部分`[square brackets]`以表示这些组可能是什么。

* * *

Python中更容易理解的方法：

```
a = "ANG-B31-OPS-PMR-MACE-SS-0229"
part = a.split('-')[3]

print part 
```

这给出了“PMR”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:44:00.657

这应该适合您的需求（[演示](http://regexr.com?346rs)）：

```
(?:.+?-){3}([^-]+) 
```

您将能够访问第一个捕获组中的*第四个术语*。

# jquery - jQuery 新元素创建不适用于 IE8 浏览器

> ID：15519852
> 
> 赞同：1
> 
> 时间：2013-03-20T09:38:17.027
> 
> 标签：jquery, html, object, element

我正在创建一个带有 html 内容的元素**DIV**，如下所示，

```
var newDiv = $("<div />",{
   "class": "container",
   "width":234,
   "height":300,
   "html":"Testing <b>dynamic</b> content"
});
$("body").append(newDiv); 
```

上面的代码适用于浏览器 chrome、safari、mozilla，但不适用于 IE8。我收到错误消息：

> “对象不支持此属性或方法”

我使用 jQuery 1.6 版

是否有任何替代脚本或 ie8 修复可用？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T10:16:39.017

```
var newDiv = $("<div />",{
   class: "container",
   width:234,
   height:300,
   html:"Testing <b>dynamic</b> content"
});
$("body").append(newDiv); 
```

# c++ - Visual Studio 中指向类数据成员的 C++ 指针的地址

> ID：15519855
> 
> 赞同：4
> 
> 时间：2013-03-20T09:38:21.263
> 
> 标签：c++, visual-studio, pointers

我正在阅读《[C++ 对象模型内部》](https://rads.stackoverflow.com/amzn/click/com/0201834545)一书。书中有一个例子：

```
struct Base1
{
    int v1;
};

struct Base2
{
    int v2;
};

class Derived : public Base1, public Base2 {};

printf("&Derived::v1 = %p\n", &Derived::v1);        // Print 0 in VS2008/VS2012
printf("&Derived::v2 = %p\n", &Derived::v2);        // Print 0 in VS2008/VS2012 
```

在前面的代码中，地址 Derived::v1 和 Derived::v2 的打印都将为**0**。但是，如果通过变量打印相同的地址：

```
int Derived::*p;
p = &Derived::v1;
printf("p = %p (&Derived::v1)\n", p);        // Print 0 in VS2008/VS2012 as before
p = &Derived::v2;
printf("p = %p (&Derived::v2)\n", p);        // Print 4 in VS2008/VS2012 
```

通过检查 &Derived::v1 和 p 的大小，我得到 4。

```
// Both are 4
printf("Size of (&Derived::v1) is %d\n", sizeof(&Derived::v1));
printf("Size of p is %d\n", sizeof(p)); 
```

Derived::v1 的地址为**0**，但 Derived::v2 的地址为**4**。我不明白为什么 &Derived::v2在将其分配给变量时变为**4 。**

查看汇编代码，直接查询 Derived::v2 的地址时，翻译为**0**；但是当将其分配给变量时，它会被转换为**4**。

我在 VS2008 和 VS2012 上都测试过，结果是一样的。所以我认为微软选择这样的设计肯定是有原因的。

而且，如果你这样做：

```
d1.*(&Derived::v2) = 1; 
```

显然**&Derived::v2**不是**0**。为什么编译器要区分这两种情况？

谁能告诉背后发生的事情？谢谢！

- 编辑 -

对于那些认为 &Derived::v1 没有得到有效地址的人。你从来没有这样做过吗？

```
Derived d1, d2;
d1.*p = 1;
d2.*p = 1; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-01T23:38:15.640

发帖人问我这个，起初我也怀疑类似的错误原因。这不是 VC++ 特有的。

事实证明，发生的事情是类型`&Derived::v2`不是`int Derived::*`，而是`int Base2::*`，它的偏移量自然是零，因为它是相对于 Base2 的偏移量。当您将其显式转换为 时`int Derived::*`，会更正偏移量。

在 VC++ 或 GCC 或 Clang 上尝试此代码...我坚持使用 stdio/printf，因为海报正在使用。

```
struct Base1 { int a; };
struct Base2 { int b; };
struct Derived : Base1, Base2 { };

#include <cassert>
#include <cstdio>
#include <typeinfo>
using namespace std;

int main () {

   printf( "%s\n", typeid(&Derived::a).name() );  // mentions Base1
   printf( "%s\n", typeid(&Derived::b).name() );  // mentions Base2

   int Derived::* pdi = &Derived::b;  // OK
   int Base2::*   p2i = &Derived::b;  // OK
   //int Base1::* p1i = &Derived::b;  // ERROR

   assert( sizeof(int*) == sizeof(pdi) );
   printf( "%p %p", p2i, pdi );  // prints "(nil) 0x4" using GCC 4.8 at liveworkspace.org

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T09:42:01.117

当你这样做时`&Derived::v2`，你没有得到一个有效的地址，因为你没有一个有效的对象。但是，在第二种情况下，您将获得类中成员的*偏移量*`Derived`，这意味着如果您创建了一个类型的对象，`v2`它将在内存中存储四个字节。`v1``Derived`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:51:25.007

`&Derived::v1`并且`&Derived::v2`是`int`s，因此它们的长度为 4 个字节。当您将这些表达式之一分配给时，您正在打印的`p`是它们从指针到`Derived`类实例的偏移量。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-02T00:10:44.510

我知道的大多数信息都特别提到了指向成员函数的指针，尽管我不知道指向成员数据的指针的实现方式会有什么不同。

指向涉及多重继承的成员函数的指针通常实现为包含函数指针（始终指向派生类位置）和偏移量的结构，以管理派生类的 this 指针与this 指针。偏移量被添加到隐藏的 this 参数以说明派生类。您所看到的是偏移量的变化取决于指向成员的指针的类型，并在 Herb Sutter 的回答中雄辩地描述：当类型为 Base2::* 时，偏移量为 0，但当类型为派生时，偏移量为： :* 是 4。

有关实现细节的更多信息，我建议阅读 Raymond Chen 的一些博客文章（从 2004 年开始，细节可能从那时起发生了变化），其中提出问题并在[此处](http://blogs.msdn.com/b/oldnewthing/archive/2004/02/09/70002.aspx)[回答](http://blogs.msdn.com/b/oldnewthing/archive/2004/02/10/70638.aspx)。这些帖子还将解释为什么 sizeof() 可以为指向成员的指针返回有趣的结果。

# javascript - jQuery 切换/循环 3 种状态

> ID：15519857
> 
> 赞同：4
> 
> 时间：2013-03-20T09:38:25.150
> 
> 标签：javascript, jquery

我有一个按钮，我需要通过 3 个状态运行。例如：静音、开和关

```
<html>
  <head>
     <!-- define mute/on/off styles -->
     <style type="text/css">
      .mute{ background:gray }
      .on  { background:green }
      .off { background:red }
     </style>

     <!-- define the toggle/cycle function -->
     <script language="javascript">
        function toggleState(item){
        if(item.className == "mute") {
              item.className="on";
           } else if(item.className == "on") {
              item.className="off";
           } else {
              item.className="mute";
           }
        }
     </script>
  </head>
  <body>
     <!-- call 'toggleState' whenever clicked -->
     <input type="button" id="btn" value="button" class="mute" onclick="toggleState(this)" />
  </body>
</html> 
```

我如何使用 jQuery 而不是使用纯 JavaScript 循环浏览这个

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T10:01:44.077

尝试这个：

```
var classNames = ['mute','on','off'];
$('div').click(function () {
    $(this).toggleClass(function (i, className, b) {
        var index = (classNames.indexOf(className) + 1) % classNames.length;
        $(this).removeClass(className);
        return classNames[index];
    });
}); 
```

在这段代码中，`className`是旧类。然后通过`classNames`数组获取新的类，然后返回。

在返回之前，应该删除旧类。

使用这种方法，您可以轻松地将 3 扩展到**任何更大的数字**。

这是jsfiddle。[http://jsfiddle.net/f3qR3/2/](http://jsfiddle.net/f3qR3/2/)

* * *

**另一种情况**

如果元素中还有其他类，可以使用下面的代码，但是比较复杂。

```
var classNames = ['mute', 'on', 'off'];
$('div').click(function () {
    var $this = $(this);
    $this.toggleClass(function (i, className, b) {
        var ret_index;
        $.each(classNames, function (index, value) {
            if ($this.hasClass(value)) {
                ret_index = (index + 1) % classNames.length;
            }
        });
        $this.removeClass(classNames.join(' '));
        return classNames[ret_index];
    });
}); 
```

这是jsfiddle。[http://jsfiddle.net/f3qR3/4/](http://jsfiddle.net/f3qR3/4/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:46:51.757

```
$("#btn").click(function(
var this=$(this);
if(this.hasClass('mute')) {
              this.removeClass("mute").addClass("on");
           } else if(this.hasClass('on')) {
              this.removeClass("on").addClass("off");
           } else {
              this.removeClass("off").addClass("mute");
           }
        }
}); 
```

You don't need to add any onclick function, just placed it under jquery ready() function.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T10:40:13.817

试试这个而不使用 if 和 else ..

```
$('input[type=button]').click( function(){    

    var statemp = { mute: 'on', on: 'off', off :'mute' };

    var toggle = $(this).attr('class')
          .split(' ')
          // Requires JavaScript 1.6
          .map( function( cls ) {
              return statemp[ cls ] || cls ;
          })
          .join(' ');     

    $(this).attr('class','').addClass( toggle );   

}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T09:50:20.587

尝试

```
$(function(){
    $('#btn').click(function(){
        var $this = $(this);
        if($this.is('.mute')) {
            $this.toggleClass("mute on");
        } else if($this.is('.on')) {
            $this.toggleClass("on off");
        } else if($this.is('.off')) {
            $this.toggleClass("off mute");
        }
    })
}) 
```

演示：[小提琴](http://jsfiddle.net/arunpjohny/ehZhg/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-05-03T08:45:01.967

```
function filterme(val){
if (val == 1){
   $('#RangeFilter').removeClass('rangeAll').removeClass('rangePassive').addClass('rangeActive');
   $("span").text("Active");
} 
else if (val == 2)
{ 
  $('#RangeFilter').removeClass('rangeActive').removeClass('rangePassive').addClass('rangeAll');
  $("span").text("All");
} 
else if(val==3){       
  $('#RangeFilter').removeClass('rangeAll').removeClass('rangeActive').addClass('rangePassive');
  $("span").text("Passive");
}
}
 <p class="range-field" style=" width:60px">
 <input type="range" id="RangeFilter" name="points" onchange="filterme(this.value);" min="1" class="rangeAll" max="3" value="2">
 </p>
<span>All</span> 
```

# compression - 拉链炸弹的副作用？

> ID：15519864
> 
> 赞同：0
> 
> 时间：2013-03-20T09:38:36.610
> 
> 标签：compression, zip, zipfile

我在 Wikipedia 上阅读了有关 zip 炸弹的信息，请阅读[此](https://stackoverflow.com/questions/1459673/how-does-one-make-a-zip-bomb)问题。我尝试制作一个 zip 炸弹，但是当我解压缩最终文件时，由于解压缩不是递归的，它不会对系统做任何事情。我错过了一些细节吗？

另外，zip 炸弹将如何导致系统崩溃？据了解，程序可能会崩溃，但操作系统会崩溃？

这些文章造成了一些混乱，所以如果有人能解释细节就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-05T01:01:27.320

首先，这不应该在[SuperUser](https://superuser.com/)上吗？这真的不是关于编程...

无论如何，AFAIK Zip-Bombs 主要用于搞砸杀毒软件。由于该程序将尝试解压缩所有内容以确保内部没有恶意软件/病毒。他们将永远花在那个存档上，甚至可能崩溃，从而允许其他病毒进入。

在这里我在推测，但我也认为有一些压缩炸弹可以解压缩所有内容，从而破坏整个计算机而不是一个程序。不过，我只是猜测。

第一个答案的来源：

*   [http://en.wikipedia.org/wiki/Zip_bomb](http://en.wikipedia.org/wiki/Zip_bomb)
*   浏览无数其他网站积累的知识

# mysql - 删除选择查询选择的记录

> ID：15519866
> 
> 赞同：0
> 
> 时间：2013-03-20T09:38:47.183
> 
> 标签：mysql, sql, sql-delete

我有一个这样的选择查询：

```
SELECT ji . * , a.acc_name
FROM zp_journal_info ji
INNER JOIN zp_account a ON a.id = ji.account_id
WHERE ji.date_time LIKE '2013-03-19%'
ORDER BY ji.id ASC 
```

我对数据库的其余部分一无所知，因为我没有开发它，但我只需要删除上述查询生成的行。下面的查询会正确执行此操作吗？

```
DELETE
FROM zp_journal_info ji
INNER JOIN zp_account a ON a.id = ji.account_id
WHERE ji.date_time LIKE '2013-03-19%'
ORDER BY ji.id ASC 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:39:27.033

You just need to add the table name on where the deletion of record takes place.

```
DELETE ji
FROM   zp_journal_info ji
       INNER JOIN zp_account a ON a.id = ji.account_id
WHERE  ji.date_time LIKE '2013-03-19%' 
```

you can also use `DATE`

```
DELETE ji
FROM   zp_journal_info ji
       INNER JOIN zp_account a ON a.id = ji.account_id
WHERE  DATE(ji.date_time) = '2013-03-19' 
```

# python - buildout - mr.developer 更改零件顺序

> ID：15519869
> 
> 赞同：0
> 
> 时间：2013-03-20T09:38:58.357
> 
> 标签：python, buildout

我有一个调用两个配方的构建配置。这两个配方必须按定义的顺序执行。

最后执行的配方由 mr.developer 扩展从 git 存储库中获取。然而，当 mr.developer 拉入配方时，它会将其视为一个鸡蛋并首先执行它。这会打乱正确的顺序，并且构建失败。

我试图设置`egg=false`这样配方不会首先执行，但是这会阻止配方完全执行，因为它不是鸡蛋。

想知道我的 buildout.cfg 是什么样子的：

```
[buildout]
develop = .
extensions = mr.developer
auto-checkout = custom-recipe
parts =
    part-one
    part-two

[sources]
custom-recipe = git http://location.of.repo

[part-one]
recipe = recipe.from.pypi
src = ${buildout:directory}

[part-two]
recipe = custom-recipe
src = ${part-one:src} 
```

`buildout:parts`应尊重零件出现的顺序。如果一个部分引用另一个部分，则可以更改顺序以使依赖关系正确。我试图通过引用`part-one`from来“欺骗”`part-two`构建，这不起作用，因为 mr.developer 已经引用了`part-two`.

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-21T08:52:07.593

经过一番测试，我发现了问题所在。配方包含三个部分：构造函数、安装函数和更新函数。在所有安装发生之前调用构造函数，这引起了混乱。

我在构造函数中有一些依赖于其他部分的东西。因为在所有安装发生之前调用了构造函数，所以代码失败了。将其移至安装功能后，一切顺利。

# javascript - 鼠标离开时保持引导下拉菜单

> ID：15519875
> 
> 赞同：2
> 
> 时间：2013-03-20T09:39:05.007
> 
> 标签：javascript, html, twitter-bootstrap, drop-down-menu

我有一个用引导程序制作的多级下拉菜单，现在当我导航几级深度并且意外指针从当前下拉列表中出来时，所有列表都关闭到第一级。仅当在下拉列表外部单击时，如何才能使所有打开的下拉列表保持打开和关闭？即当鼠标点击外层空间时做同样的事情，而不是刚刚移动到那里。

这是我的演示：http: [//jsfiddle.net/n8XJb/](http://jsfiddle.net/n8XJb/)

```
<ul class="nav nav-pills">
    <li class="dropdown">
      <a href="#" data-toggle="dropdown" class="dropdown-toggle">Dropdown <b class="caret"></b></a>
      <ul class="dropdown-menu" id="menu1">
        <li class="dropdown-submenu">
          <a href="#">Level 1</a>
          <ul class="dropdown-menu">
            <li class="dropdown-submenu">
              <a href="#">Level 2</a>
              <ul class="dropdown-menu">
                <li><a href="#">Level 3</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
</ul> 
```

当您导航到第 3 层，然后鼠标指针从当前列表中出来时，它会立即返回第 1 层。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T11:00:43.643

我已经通过一些自定义事件处理（[http://jsfiddle.net/n8XJb/2/](http://jsfiddle.net/n8XJb/2/)）解决了这个问题：

```
jQuery('.dropdown-menu li a').mouseover(function(e) {
    e.stopPropagation();
    jQuery(this).parent().parent().find('li').each(function() {
        jQuery(this).removeClass('open');
    });
    jQuery(this).parent().addClass('open');
});

jQuery('.dropdown-toggle').click(function(e) {
    jQuery(this).parent().find('li').each(function() {
        jQuery(this).removeClass('open');
    });
}); 
```

Bootstrap 使用类`open`来打开下拉菜单，因此我们可以在需要时手动设置/取消设置它。

# asp.net - Calculation error in SELECT statement

> ID：15519877
> 
> 赞同：1
> 
> 时间：2013-03-20T09:39:07.020
> 
> 标签：asp.net, sql, vb.net, visual-studio-2010

I have an SQL I am trying to create in a `DatasetAdapter` it works to a certain point but I cant figure out to get the last bit working.

I have a Table(MainTable) with the following Fields: ID Name Image Area Mean

I want to calculation `ABS(Area-?) AS Cal1, ABS(Mean-?) AS Cal2 , Cal1+Cal2 As Cal3`

```
SELECT 
ID, Image, Name, Area, Mean, ABS(Area - ?) AS cal1, ABS(Mean - ?) AS cal2, Cal1+Cal2 AS cal3
FROM  MainTable 
```

I Then want to get the maximum value of Cal3

```
SELECT        MAX(cal3) AS maxofcal3
FROM          
  (SELECT        ID, Image, Name, Area, Mean, ABS(Area - ?) AS cal1, ABS(Mean - ?) AS cal2, derivedtbl_1.cal1 + derivedtbl_1.cal2 AS cal3
FROM            MainTable) 
derivedtbl_1 
```

It works so far giving me the maximum value of cal3.

QUESTION: I want to carry out another calculation ( Cal3/maxofcal3). I cant figure it out. I tried code below but came up with an error:

```
SELECT        MAX(Cal3) AS maxofCal3, Cal3 / MaxofCal3 AS Norm
FROM            (SELECT        ID, Image, Name, Area, Mean, ABS(Area - ?) AS cal1, ABS(Mean - ?) AS cal2, derivedtbl_1.cal1 + derivedtbl_1.cal2 AS cal3
                                                    derivedtbl_1.Cal1 + derivedtbl_1.Cal2 AS Cal3
                          FROM            MainTable) derivedtbl_1
GROUP BY Cal3 / MaxofCal3. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:07:17.100

仅按 Cal4 分组，不按 Cal4 / MaxofCal4

检查以下示例以了解如何使您的代码工作：

```
CREATE TABLE #SampleTable (ID int, Image nvarchar(10), Name nvarchar(10), Area int, Mean int )

SELECT MAX(Cal3) AS maxofCal3, Cal4 / MAX(Cal3) AS Norm
FROM (
SELECT ID, Image, Name, Area, Mean, ABS(Area - 1) AS cal1, ABS(Mean - 1) AS cal2, ABS(Area - 1) + ABS(Area - 1) AS cal3, ABS(Area - 1) + ABS(Area - 1) AS Cal4 FROM #SampleTable
) derivedtbl_1 
GROUP BY Cal4

DROP TABLE #SampleTable 
```

# c# - Playing chords as simultaneous sounds

> ID：15519878
> 
> 赞同：2
> 
> 时间：2013-03-20T09:39:08.497
> 
> 标签：c#, audio, simultaneous, music-notation

I want to build a musical Ear Training program. I have samples of piano notes on mp3 or wav files, and i want to play them simultaneously to build musical chords.

What will be the easiest or the most successful way of playing sounds together?

Thanks :-)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:12:42.873

对于这类事情，您可以调用[SDL_mixer](http://www.libsdl.org/projects/SDL_mixer/)库。它不是 C#，但[在这里](http://sourceforge.net/apps/mediawiki/cs-sdl/index.php?title=Audio)您可以在游戏库中看到它由 C# 接口。

您可以有多个通道，每个通道播放不同的声音。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T13:09:58.573

有关流行的 C# 音频库，请参阅[此问题](https://stackoverflow.com/questions/466458/c-sharp-audio-library)，并参阅其有关如何实现同时播放的文档（例如[BASS.NET](http://bass.radio42.com/help/Index.html)、[NAudio](http://naudio.codeplex.com/documentation)等）。

# r - 从 r 中的 summary(aov()) 中分离出显着性列

> ID：15519882
> 
> 赞同：5
> 
> 时间：2013-03-20T09:39:16.393
> 
> 标签：r, summary

`warpbreaks`以预装数据为例，如何隔离summary(aov())中的显着性列...

```
> a<-summary(aov(breaks~wool*tension,data=warpbreaks))
> a
             Df Sum Sq Mean Sq F value   Pr(>F)    
wool          1    451   450.7   3.765 0.058213 .  
tension       2   2034  1017.1   8.498 0.000693 ***
wool:tension  2   1003   501.4   4.189 0.021044 *  
Residuals    48   5745   119.7                     
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 

> somefunction(a)[,6]

1     .  
2     ***
3     *
4 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-20T09:56:33.643

```
# Extract the p-values
pvals <- a[[1]][["Pr(>F)"]]

# Use the symnum function to produce the symbols
sigSymbols <- symnum(pvals, na = FALSE, 
                     cutpoints = c(0, 0.001, 0.01, 0.05, 0.1, 1), 
                     symbols = c("***", "**", "*", ".", " ")) 
```

这将返回一个带有属性的向量：

```
> sigSymbols
[1] .   *** *      
attr(,"legend")
[1] 0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1 
```

如果你不想要这个`legend`属性，你可以`legend = FALSE`在`symnum`函数中使用参数。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-20T09:49:28.830

我找不到/想到直接的方法，所以我只是创建了自己的方法。我提取数据框的最后一列，即`Pr(>F)`

```
p = a[[1]][,5] 
```

敲掉最后一个值，因为那是空白的：

```
p = p[-length(p)] 
```

然后制定了编码：

```
stars = findInterval(p, c(0, 0.001, 0.01, 0.05, 0.1,))
codes = c("***" , "**","*", ".", " ")
codes[stars] 
```

如果你愿意，你当然可以把它放在一个函数中。  

```
 get_stars = function(p) {
         stars = findInterval(p, c(0, 0.001, 0.01, 0.05, 0.1))
         codes = c("***" , "**","*", ".", " ")
         codes[stars]
     } 
```

**例子**

```
R> p = c(0.0005, 0.005, 0.025, 0.075, 0.5)
R> get_stars(p)
[1] "***" "**"  "*"   "."   " " 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-07-18T19:22:48.883

上述提取 p 值的方法对我不起作用，因为我的模型包含错误项。我使用以下方法取得了成功：

```
test.summary <- summary(aov(dv ~ iv1 + Error(grouping.factor / iv1 ), data = df))
p <- test.summary[[2]][[1]][["Pr(>F)"]][1] 
```

添加`[1]`after`[["Pr(>F)"]]`仅提取 p 值而不是其后的*null*值。

另外，@csgillespie，您的代码在向量中的最后一个元素之后包含一个额外的逗号，因此 R 期望在 之后有一个参数`0.1`：

```
stars = findInterval(p, c(0, 0.001, 0.01, 0.05, 0.1,)) 
```

# c# - Get type name of T using reflection

> ID：15519883
> 
> 赞同：8
> 
> 时间：2013-03-20T09:39:22.077
> 
> 标签：c#, reflection

I have:

```
public class MyUserControl : WebUserControlBase <MyDocumentType>{...} 
```

How do I get the TypeName of `MyDocumentType` if I'm in another class?

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T09:43:44.367

你可以使用这样的东西：

```
typeof(MyUserControl).BaseType.GetGenericArguments()[0] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-20T09:49:03.307

There are plenty answers showing how to get the type of `T` if you *know* that the class derives directly from `WebUserControlBase<T>`. Here's how to do it if you want to be able to go up the hierarchy *until* you encounter the `WebUserControlBase<T>`:

```
var t = typeof(MyUserControl);
while (!t.IsGenericType
    || t.GetGenericTypeDefinition() != typeof(WebUserControlBase<>))
{
    t = t.BaseType;
} 
```

And then go on to get `T` by reflecting on the generic type arguments of `t`.

Since this is an example and not production code, I 'm not handling the case where `t` represents a type that does not derive from `WebUserControlBase<T>` at all.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:44:12.953

如果您使用的是 .NET 4.5：

```
typeof(MyUserControl).BaseType.GenericTypeArguments.First(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-20T09:44:37.573

你可以使用[`Type.GetGenericArguments`](http://msdn.microsoft.com/en-us/library/system.type.getgenericarguments.aspx)方法。

> 返回表示泛型类型的类型参数或泛型类型定义的类型参数的 Type 对象数组。

喜欢

```
typeof(MyUserControl).BaseType.GetGenericArguments()[0] 
```

由于此方法的返回类型是 `System.Type[]`，因此数组元素按照它们在泛型类型的类型参数列表中出现的顺序返回。

# java - add AWT listener to SWT component

> ID：15519887
> 
> 赞同：0
> 
> 时间：2013-03-20T09:39:30.577
> 
> 标签：java, swt, listener, swt-awt

Is there a way to add AWT listener to a SWT component?

I previously made an app running mostly in AWT and Swing components. Now, I have hotkeys function which is dependent on a custom-made library that listens to global key events and returns its corresponding AWT key code.

My problem arises when I shifted the whole app and used SWT components instead. As we know some of the keys returns a different key code now, which messes up the whole hotkeys function.

The initial solutions I've thought of are:

A. Use javax.swing.jtextfield as mycomponent listener instead of swt.widget.text

B. Add AWT listener to SWT component (if possible)

C. Create a class which re-maps all AWT keycodes to SWT and vice-versa.

I believe these are feasible solutions. I just want to check out with you guys if you have a brilliant idea on which I could work with. I'm only new to java and I could use some professional insights on this.

***(besides, I think A is cheating. B I could not find a way to do yet. And C is a hassle job to do)***

Cheers.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T12:31:00.870

经过一番谷歌搜索后，我找到了 JBoss Tools 的类，它可能会帮助您将 AWT 键码映射到 SWT 键码。

请参阅[JaCoCo 项目](http://www.eclemma.org/jacoco/)中的[KeyboardHelper 类](http://hudson.jboss.org/hudson/job/jbosstools-4.0_trunk.component--tests/111/artifact/sources/target/coverage-report/html/JaCoCo-Multi/org.jboss.tools.ui.bot.ext.helper/KeyboardHelper.java.html)。

# ruby-on-rails-3 - Got error while copying existing record in new one in rails3?

> ID：15519888
> 
> 赞同：0
> 
> 时间：2013-03-20T09:39:37.390
> 
> 标签：ruby-on-rails-3, copy

Hi i am creating an action to copy an existing record in a new one in rails3 which is correctly populates the values from previous record to new one but at the time i submit the form it gives the error. Here is my code sample

```
 class SalaryStructuresController < ApplicationController
     def new
        @salary_structure = SalaryStructure.new
        @salary_structure.salary_structure_line_items.build 
        respond_to do |format|
          format.html # new.html.erb
          format.xml  { render :xml => @salary_structure }
        end
      end
     def create
        @salary_structure = SalaryStructure.new(params[:salary_structure])
        @salary_structure.company_id = current_company.id
        @salary_structure.created_by = current_user.id
        respond_to do |format|
          if @salary_structure.valid?
            @salary_structure.save_with_variable_payheads
            flash[:success]= "Salary structure successfully created."
            format.html { redirect_to(@salary_structure) }
            format.xml  { render :xml => @salary_structure, :status => :created, :location => @salary_structure }
          else
            format.html { render :action => "new" }
            format.xml  { render :xml => @salary_structure.errors, :status => :unprocessable_entity }
          end
        end
      end

 #action to clone the salary structure
     def copy
       @payheads = current_company.payheads
        @users = current_company.users
        @source_salary_structure = SalaryStructure.find(params[:id])
        @salary_structure = SalaryStructure.new(@source_salary_structure.attributes)
        @source_salary_structure.salary_structure_line_items.each do |line_item|
         salary_item = SalaryStructureLineItem.new(line_item.attributes)
         @salary_structure.salary_structure_line_items << salary_item
       end 

       render :action => "new" 
     end
    end 
```

My model:

```
class SalaryStructure < ActiveRecord::Base
  has_many :salary_structure_line_items
  belongs_to :user
#  has_many :payheads

  accepts_nested_attributes_for :salary_structure_line_items, :reject_if => lambda {|p| p[:payhead_id].blank? && p[:amount].blank? }, :allow_destroy => true

  #validation
  validates_presence_of :effective_from_date, :for_employee
  validates_presence_of :salary_structure_line_items
  validates_associated :salary_structure_line_items

  attr_accessible :id, :effective_from_date, :salary_structure_line_items_attributes, :amount, :total, :pay_head_type, :for_employee, :pay_head, :created_by, :updated_at, :created_at, :company_id,
                      :salary_structure_line_items_attributes
end 
```

When i submit the form (press save) i got the error on salary_structure_id:

```
 ActiveRecord::RecordNotFound in SalaryStructuresController#create

Couldn't find SalaryStructureLineItem with ID=11 for SalaryStructure with ID= 
```

Even in parameters salary_structure_id is present :

```
"commit"=>"Save",
 "salary_structure"=>{"salary_structure_line_items_attributes"=>{"0"=>{"amount"=>"3000.0",
 "_destroy"=>"",
 "salary_structure_id"=>"4",
 "id"=>"11",
 "payhead_id"=>"1"},
 "1"=>{"amount"=>"500.0",
 "_destroy"=>"",
 "salary_structure_id"=>"4",
 "id"=>"12",
 "payhead_id"=>"2"} 
```

i am unable to trace where i am missing something, please help me.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-21T12:28:40.507

我在这里以非常简单的方式创建了克隆文件我在我的控制器中创建了一个新动作

```
def copy_salary_structure
   @users = current_company.users.without_salary_structure
   @payheads = current_company.payheads.where(:optional => false)
   @old_salary_structure = SalaryStructure.find_by_id(params[:id])
   @salary_structure = SalaryStructure.new
   @salary_structure.company_id = @old_salary_structure.company_id
   @salary_structure.created_by = current_user.id

   @old_salary_structure.salary_structure_line_items.each do |line_item|
    salary_structure_line_item = SalaryStructureLineItem.new(
       :payhead_id => line_item.payhead_id,
       :amount => line_item.amount
      ) 
    @salary_structure.salary_structure_line_items << salary_structure_line_item
   end  
  end 
```

我创建了一个同名的视图表单，我可以从中查看记录，然后轻松保存

# javascript - Tempo.js add new items into nested template

> ID：15519890
> 
> 赞同：1
> 
> 时间：2013-03-20T09:39:37.933
> 
> 标签：javascript, tempo

I use tempo.js which is fantastic tool, BUT. I have a rendered template that contains nested templates. For example: posts that has comments (just like as facebook).

Sometime user wants to add a new comment. How can I refresh/rerender JUST the relevant nested templates (comments under one post) inside in one row? Is it possible somehow?

Thank you for your answers.

# neo4j - Neo4j 不受支持的 Java 运行时。使用 JDK 6\. ubuntu 12.04

> ID：15519891
> 
> 赞同：3
> 
> 时间：2013-03-20T09:39:38.113
> 
> 标签：neo4j, ubuntu-12.04, java, 32-bit

我是 Neo4j 使用的新用户，我的操作系统是 32 位 Ubuntu12.04。您需要通过进入 Neo 的目录从终端启动服务器，然后键入

```
bin/neo4j start 
```

直到昨天，一切都已设置且正确，现在有一些问题，我明白了

```
WARNING: Max 1024 open files allowed, minimum of 40 000 recommended.
See the Neo4j manual.WARNING! You are using an unsupported Java runtime. 
Please use JDK 6.Neo4j Server already running with pid 3527 
```

我不知道为什么这个错误突然发生。当我
`localhost:7474`
在浏览器上运行时，它不再识别它。我尝试按照[在 Ubuntu 12.04 上安装 JDK6](http://yltechblog.blogspot.in/2012/10/install-jdk6-on-ubuntu-1204.html)链接更新我的版本，但似乎不起作用。仍然给出相同的错误。
从终端检查版本后

```
 java -version 
```

我收到

```
java version "1.6.0_27"
OpenJDK Runtime Environment (IcedTea6 1.12.3) (6b27-1.12.3-0ubuntu1~12.04.1)
OpenJDK Server VM (build 20.0-b12, mixed mode) 
```

如何使 localhost:7474 在我的机器上工作？
谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T13:01:00.310

对于某些许可问题，Ubuntu 不再直接发布 Oracle/Sun JDK，这要归咎于 Oracle！

[https://github.com/flexiondotorg/oab-java6](https://github.com/flexiondotorg/oab-java6)会自动获取 Oracle/Sun JDK，从中构建本地 deb 包并将它们放在本地 apt 存储库中。

使用`update-java-alternatives`您可以设置系统的默认 jdk。

关于“打开文件”警告，请参阅[http://docs.neo4j.org/chunked/stable/configuration-linux-notes.html#_setting_the_number_of_open_files](http://docs.neo4j.org/chunked/stable/configuration-linux-notes.html#_setting_the_number_of_open_files)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-22T16:36:04.560

我们也在使用 Ubuntu 12.04。我们使用 OpenJDK 1.6.0_24。

我们最初使用 Neo4j 时遇到了类似的问题。以下是通过这些障碍的说明。

您需要能够打开更多文件。

*   编辑 /etc/security/limits.conf 并添加这两行：

    根软文件 40000

    根硬盘文件 40000

*   编辑 /etc/pam.d/su 并取消注释或添加以下行：

    会话需要 pam_limits.so

*   最后检查限制是否已更改。您可能需要重新启动。

    ulimit -n

返回 40000

接下来为了能够在 Ubuntu 上使用 webadmin。您需要更改 neo4j 中的属性文件之一。我知道，它无需在 Mac 上进行此更改即可工作。

*   编辑 neo4j-server.properties 文件：

    > cd [neo4j 安装]/conf/
    > 
    > vim neo4-server.properties

*   更改此行

    org.neo4j.server.webserver.address=0.0.0.0

默认设置为仅侦听来自 localhost 的连接（这就是它在 Mac 上工作的原因）。这样您就可以从任何地方访问网络管理员。不过，这可能是一个安全问题。

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-29T22:17:49.393

这似乎是 neo4j 中关于检测运行实例的错误。根据报告的 pid，有一些关于 gnome 和代理的脚本，在被杀死后（包括父镜头脚本）让我用 OpenJDK 启动 neo4j。我猜他们做得太聪明了。

# jsf - How can I add Liferay's CKEditor to my JSF portlet?

> ID：15519892
> 
> 赞同：1
> 
> 时间：2013-03-20T09:39:39.027
> 
> 标签：jsf, liferay, portlet

I want to add Liferay's CKEditor to my JSF portlet. I tried to find a way to add the CKEditor in JSF, but all the examples/solutions show how to add the CKEditor in a JSP not JSF.

I am using Liferay Portal 6.0 EE.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-10-02T11:04:59.360

[您可以通过在项目中包含Liferay Faces Portal jar](https://www.liferay.com/community/liferay-projects/liferay-faces/portal) *并将 CKEditor 添加到 JSF 页面，并编写类似于以下示例之一的代码：

**Liferay 6.2+ 示例：**

```
<portal:inputRichText value="#{backing.value}" /> 
```

查看[Liferay Faces Showcase](http://liferayfaces.org/web/guest/showcase/-/component/portal/inputrichtext/general)以获取实时示例和更多详细信息。

**已弃用的 Liferay 6.2 和 6.1 示例：**

```
<liferay-ui:input-editor editorImpl="editor.wysiwyg.default" value="#{backing.value}"> 
```

**已弃用的 Liferay 6.0 EE 示例：**

```
<liferay-ui:input-editor editorImpl="ckeditor" value="#{backing.value}"> 
```

^(*由于您使用的是 Liferay 6.0 EE，因此您需要使用 LF Portal 版本[`3.0.5-ga6`](http://central.maven.org/maven2/com/liferay/faces/liferay-faces-portal/3.0.5-ga6/)。有关兼容 Liferay Faces 和 Liferay Portal 版本的更多信息，请参阅[Liferay Faces 版本方案](https://dev.liferay.com/develop/tutorials/-/knowledge_base/6-2/understanding-the-liferay-faces-version-scheme)。)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-30T20:12:09.410

使用下面的代码。参考[Liferay Faces 展示](http://www.liferayfaces.org/web/guest/showcase/-/component/portal/inputrichtext/general)

输入RichText.xhtml

```
<alloy:outputStylesheet library="css" name="input-rich-text.css" />
<alloy:form id="exampleForm">
    <alloy:field id="commentsField" label="#{i18n['comments']}" styleClass="input-rich-text-field">
        <alloy:message id="commentsMessage" for="comments" />
    </alloy:field>
    <!-- Note: In this example, portal:inputRichText is intentionally not a child of alloy:field in order -->
    <!-- to prevent it from being unnecessarily reinitialized when the alloy:field is re-rendered via Ajax. -->
    <portal:inputRichText id="comments" label="#{i18n['comments']}"
        required="#{showcaseModelBean.selectedComponent.required}"
        value="#{inputRichTextBacking.applicant.comments}" />
    <alloy:commandButton actionListener="#{inputRichTextBacking.submit}"
        render=":exampleForm:commentsField :modelValue" value="#{i18n['submit']}" />
</alloy:form>
<alloy:outputText id="modelValue" value="#{inputRichTextBacking.applicant.comments}" /> 
```

InputRichTextBacking.java

```
@ManagedBean
@RequestScoped
public class InputRichTextBacking {

    private static final Logger logger = LoggerFactory.getLogger(InputRichTextBacking.class);

    private Applicant applicant;
    private boolean resizable = true;

    @PostConstruct
    public void init() {

        applicant = new Applicant();

        if (ViewParamUtil.getUsage().equals("default-value")) {
            applicant.setComments(
                "<p>This is some <strong>bold</strong> text\nand this is some <em>italic</em> text.</p>");
        }
    }

    public void submit() {
        logger.info("You entered comments: " + applicant.getComments());
    }

    public void valueChangeListener(ValueChangeEvent valueChangeEvent) {

        FacesContext facesContext = FacesContext.getCurrentInstance();
        PhaseId phaseId = facesContext.getCurrentPhaseId();
        logger.debug("valueChangeListener: phaseId=[{0}]", phaseId.toString());

        String phaseName = phaseId.getName();
        FacesMessage facesMessage = new FacesMessage("The valueChangeListener method was called during the " +
                phaseName + " phase of the JSF lifecycle.");
        facesContext.addMessage(null, facesMessage);
    }

    public Applicant getApplicant() {
        return applicant;
    }

    public boolean isResizable() {
        return resizable;
    }

    public void setResizable(boolean resizable) {
        this.resizable = resizable;
    }
} 
```

申请人.java

```
public class Applicant implements Serializable {

    private static final long serialVersionUID = 4661552363081858711L;

    private String city;
    private String comments;
    private Date dateOfBirth;
    private String emailAddress;
    private String firstName;
    private String lastName;
    private String phoneNumber;
    private String postalCode;
    private Long provinceId;

    public String getCity() {
        return city;
    }

    public void setCity(String city) {
        this.city = city;
    }

    public String getComments() {
        return comments;
    }

    public void setComments(String comments) {
        this.comments = comments;
    }

    public Date getDateOfBirth() {
        return dateOfBirth;
    }

    public void setDateOfBirth(Date dateOfBirth) {
        this.dateOfBirth = dateOfBirth;
    }

    public String getEmailAddress() {
        return emailAddress;
    }

    public void setEmailAddress(String emailAddress) {
        this.emailAddress = emailAddress;
    }

    public String getFirstName() {
        return firstName;
    }

    public void setFirstName(String firstName) {
        this.firstName = firstName;
    }

    public String getLastName() {
        return lastName;
    }

    public void setLastName(String lastName) {
        this.lastName = lastName;
    }

    public String getPhoneNumber() {
        return phoneNumber;
    }

    public void setPhoneNumber(String phoneNumber) {
        this.phoneNumber = phoneNumber;
    }

    public String getPostalCode() {
        return postalCode;
    }

    public void setPostalCode(String postalCode) {
        this.postalCode = postalCode;
    }

    public Long getProvinceId() {
        return provinceId;
    }

    public void setProvinceId(Long provinceId) {
        this.provinceId = provinceId;
    }
} 
```

输入富文本.css

```
/* The Liferay Portal margin-bottom is 30px for div elements with class="control-group" (such as alloy:field). */
/* Set the margin-bottom to zero since the portal:inputRichText is not a child of the alloy:field component tag. */ 
.aui div.input-rich-text-field.control-group {
    margin-bottom: 0px;
}

.aui div.portal-input-rich-text {
    margin-bottom: 30px;
} 
```

输入富文本.properties

```
#
# The default key used by the editorImpl attribute is found in the Liferay portal.properties file:
#
#     editor.wysiwyg.default=ckeditor
#
# For more information, see:
#
#     https://github.com/liferay/liferay-portal/blob/6.2.1-ga2/portal-impl/src/portal.properties#L5282
#
# Alternate keys for BBCode and Creole can be specified in a custom portal-ext.properties file.
#
# For example:
#
com.liferay.faces.demos.showcase.ckeditor=ckeditor
com.liferay.faces.demos.showcase.ckeditor_bbcode=ckeditor_bbcode
com.liferay.faces.demos.showcase.ckeditor_creole=ckeditor_creole 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2015-01-29T08:54:04.097

您可以使用：

```
<aui:fieldset>
    <script type="text/javascript">
             function <portlet:namespace />initEditor() {
        }
    </script>
    <aui:field-wrapper label="content">
        <liferay-ui:input-editor width="100%" />
        <aui:input name="content" type="hidden" />
    </aui:field-wrapper>
</aui:fieldset> 
```

# javascript - advanced if else javascript statement use in code protection

> ID：15519897
> 
> 赞同：1
> 
> 时间：2013-03-20T09:39:57.627
> 
> 标签：javascript, optimization, if-statement

I have a question, not about the JS code obfuscation ( it's not really the subject), but for understand a JS if else notation.

When we use obfuscation tools on JS code, the generated code contains a statement like this :

```
(0xA6, 78.) <= 0x204 ? val : otherVal 
```

I know the if Else statement and the reduce version. in this exemple the obfuscate tool use numbers with other hex base ( ok for this )

But the notation :

```
( value , other value ) 
```

Why this and for make what ?

Thanks for your help to understand this.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T09:43:15.350

它是一个逗号运算符：

[javascript 逗号运算符](http://javascriptweblog.wordpress.com/2011/04/04/the-javascript-comma-operator/)

[Mozilla 逗号运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Comma_Operator)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:44:49.997

好吧，逗号分隔的列表只评估最外面的右值，在这种情况下是 number `78`。它也可能看起来像

```
(0xA6, 42, 11, 78.) 
```

它仍然会评估为`78`（最后的小数点只是可选的）。第二个数字只是数字的八进制版本`516`。所以实际上这条线是

```
78 < 516 ? val : otherVal 
```

这是一个用三元运算符编写的非常简单的条件，它也可以写成

```
if( 78 < 516 ) {
    // assign val somewhere
} else {
    // assign otherVal somewhere
} 
```

# vba - 根据行号 VB2008 比较文本文件的内容

> ID：15519898
> 
> 赞同：1
> 
> 时间：2013-03-20T09:40:02.667
> 
> 标签：vba

假设我有两个文本文件，我将比较（基于文本的行号 -> 见下文），因为这是生成唯一键的地方。

样本1.txt：

```
5th line -> _000_000F_01CE2577.B840E640 
```

样本2.txt

```
5th line -> _000_000F_01CE2577.B840E640 
```

现在这是我的代码：

```
 Dim FILE_NAME As String = "C:\myfiles"

            'This is to determine the number of lines in the text file
            Dim count As Integer
            count = 0

            Dim obj As StreamReader
            obj = New StreamReader(FILE_NAME)

            Do Until obj.ReadLine Is Nothing
                count = count + 1
            Loop

            '------------------------------
            'this is my computation to get the number of line -->disregard this

            Dim temp3 As Integer
            temp3 = count - 3
            '------------------------------

            obj.Close()

            'This is to read all the text in the text file
            Dim fileReader(fs) As String
            fileReader(fs) = My.Computer.FileSystem.ReadAllText(FILE_NAME, _
                        System.Text.Encoding.ASCII) 
```

我已将每个文件存储在一个数组示例中：

```
 file[0]
             file[1] 
```

然后我必须阅读每个文件及其内容，现在我将如何将文本行相互比较。我相信我必须使用正则表达式。

请给我一些有关如何比较文本行的指示...

例如 sample1.txt 的第 5 行 == sample2.txt 的第 5 行

我必须知道它们是否相同。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T12:00:47.350

这应该为您完成这项工作，
它将读取 txt 文件中的每一行，将其保存到一个数组然后比较
***注意：***设置路径执行您的 2 个 txt 文件
，如果文件 2 中的行数少于文件 1，它将超出范围。不过，您可以添加一些代码来处理这种情况。

```
Option Explicit

Sub Read_text_File()

    Dim firstFile() As String, secondFile() As String
    Dim path1 As String, path2 As String
    Dim i As Long

    path1 = "C:\ ... .txt"
    path2 = "C:\ ... .txt"

    Call fill_array(firstFile, path1)
    Call fill_array(secondFile, path2)

    For i = LBound(firstFile) To UBound(firstFile) - 1
        Debug.Print (firstFile(i) & vbTab & vbTab & vbTab & vbTab & secondFile(i))
        If StrComp(firstFile(i), secondFile(i), vbTextCompare) = 0 Then
            MsgBox "Line: " & i + 1 & "  matches "
        End If
    Next i

End Sub

Sub fill_array(ByRef arr() As String, pathToFile As String)

    Dim oFSO As New FileSystemObject
    Dim oFS As TextStream

    Dim cnt As Long
    cnt = 0

    Set oFS = oFSO.OpenTextFile(pathToFile)

    Do Until oFS.AtEndOfStream
        oFS.ReadLine
        cnt = cnt + 1
    Loop
    ReDim arr(cnt)
    Set oFS = oFSO.OpenTextFile(pathToFile)
    cnt = 0
    Do Until oFS.AtEndOfStream
        arr(cnt) = oFS.ReadLine
        cnt = cnt + 1
    Loop

    oFS.Close
    Set oFS = Nothing
End Sub 
```

# php - C++ 代码的 Web 前端

> ID：15519904
> 
> 赞同：0
> 
> 时间：2013-03-20T09:40:14.753
> 
> 标签：php, c++, python, flask

我有可以在 Linux、windows 或 Mac OS 下编译的 c++ 代码。该代码比较两个图像。我想让它的前端在浏览器上运行并提供给 www.

我熟悉托管和 dns，这不是问题。我似乎无法弄清楚的是：

1.  用户上传图片后如何调用脚本？

2.  代码的结果需要显示回浏览器。如何为此设置回调？

有没有一个php解决方案？还是蟒蛇（带烧瓶）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:43:47.597

您可以使用[exec](http://php.net/manual/en/function.exec.php)从 PHP 调用 C++ 应用程序，然后返回浏览器，无论结果如何。这很快而且不是好主意。更好的方法是让 C++ 中的服务/守护进程运行并从队列中获取任务（例如 RabbitMQ）。这是可扩展的解决方案，但需要更多的努力来实施。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:42:53.790

为什么不使用 CppCMS ( [http://cppcms.com/](http://cppcms.com/) )？CppCMS 是一个免费的高性能 C++ Web 开发框架。

您可以使用它来处理 HTTP 请求和文件上传，并轻松集成您的代码...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:44:00.560

您可以使用套接字，并开始在 C++ 程序的某个端口上侦听，然后您可以从 PHP 连接和发送/接收数据到您的程序/从您的程序接收数据。

# c++ - Weird Values in an IplImage

> ID：15519906
> 
> 赞同：0
> 
> 时间：2013-03-20T09:40:26.067
> 
> 标签：c++, visual-studio-2010, opencv

I do have an IplImage I. and it's supposed to have values from 0 to 255 (pixels). I'm having in it unfortunately weird special characters like:

```
ØÕÖÕÓÎËÍÌÈÃÃÁ»¶±«¨¤Ÿ™”‰ 
```

I did the following: uchar* d_I = (uchar*) I->imageData;

How can I convert those characters into values from 0 to 255 ?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T22:50:12.403

你在考虑 image->widthStep 吗？像素不仅仅是指向您传递给 cvCreateImage 的数据类型（或由 cvLoadImage 加载的数据类型）然后递增的指针...行对齐到 4 或 8 个字节，因此每一行不一定在内存中接触（尽管它会在几个字节内接近）。

访问您的像素：
(unsigned char)CV_IMAGE_ELEM(myImage, unsigned char, y, x)

或者如果您从 64F 深度图像开始：
(double)CV_IMAGE_ELEM(myImage, double, row, col)

参见： [如何在 Opencv 中访问单通道 IplImage 的元素](https://stackoverflow.com/questions/9679953/how-to-access-the-elements-of-single-channel-iplimage-in-opencv)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T12:06:12.610

既然您已经标记了 c++，那么您可以使用 cout 将 char 打印为数字。保留您以前的代码。

```
uchar* d_I = (uchar*) I->imageData;
std::cout <<(int) *d_I; 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-03-20T09:52:23.807

您应该转换为 int，而不是转换为 uchar：

```
int* d_l = (int*)l->imageData 
```

# pattern-matching - Linux - cleanup: find large groups of files by similar filenames

> ID：15519908
> 
> 赞同：1
> 
> 时间：2013-03-20T09:40:28.150
> 
> 标签：pattern-matching, filenames

**Question:** on a Linux File System, I am trying to locate large numbers of files with similar name patterns; for cleanup. The issue here is that I have no idea what such patterns would look like; this is what the script should show us.

**Example:** e.g., a typical outcome of the script could be: "we have accumulated around 10k files looking like 'create_some_kind_of_log_*.log' and 19k files matching '/some_kind_of_dir/daily_blah_file*.dat'"

Before we would not be 'aware' that these files are being accumulated in such large numbers; they were under the radar because of their small size.

Any input would be appreciated!

Cheers

**Edit** Maybe a workaround would be to just look for directories where there are a large number of files; this could also help in the analysis. Thanks!!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:45:02.950

我已经修改了答案以防万一。这将生成一个目录列表，按每个文件的数量排列。

```
find . -type d | xargs ls -dl | awk '{print $2, $9}' > f.tmp
sort -nr f.tmp 
```

# wcf - 使用restful wcf上传文件和多个参数

> ID：15519912
> 
> 赞同：0
> 
> 时间：2013-03-20T09:40:31.327
> 
> 标签：wcf, rest, parameters, stream

我正在尝试使用 Visual Studio 2012 和 .net 框架 4.5 创建一个 wcf 休息服务。该服务将尝试上传包含 4 个或更多参数的文件。我只想在一个电话中做到这一点。我想使用http“put”方法。但我一直有这两个错误。

合约“IRestBasketService”中的“AddFile”操作有多个请求主体参数，其中一个是 Stream。当 Stream 为参数时，body 中不能有其他参数。（当我使用 BodyStyle 包裹时）

和

合约 'IRestBasketService' 的操作 'AddFile' 指定要序列化的多个请求主体参数，而无需任何包装器元素。最多一个 body 参数可以在没有包装元素的情况下被序列化。删除额外的正文参数或将 WebGetAttribute/WebInvokeAttribute 上的 BodyStyle 属性设置为 Wrapped。（当我使用裸露的 BodyStyle 时）

我该怎么办 ？

Bellow 是 2 个签名给我的错误

```
 [WebInvoke(Method = "PUT",
            BodyStyle = WebMessageBodyStyle.Bare,
            ResponseFormat = WebMessageFormat.Json,
            UriTemplate = "AddFile?key={key}&email={email}&fileName={fileName}&groupID={groupID}&ID={objectID}")]
  Response AddFile(string key, string email, string fileName, string type, string objectID, string groupID, Stream fileStream );

[WebInvoke(Method = "PUT",
           BodyStyle = WebMessageBodyStyle.Wrapped,
           ResponseFormat = WebMessageFormat.Json,
           RequestFormat = WebMessageFormat.Json,
           UriTemplate = "/AddFile")]
 Response AddFile(AddFileRequest request, Stream FileStream); 
```

我在 web.config 中使用 webHttpBinding 和 webHttp 行为。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-04T00:46:38.957

由于您使用 Stream 作为输入参数之一，因此正文中不能有其他参数。您需要将所有额外数据添加为客户端中的流的一部分，然后在服务中对其进行解析。

[1\. 类似问题](https://stackoverflow.com/questions/19730610/creating-a-webservice-that-accepts-a-file-stream-doesnt-want-other-params) [2\. 类似问题](https://stackoverflow.com/questions/5423031/uploading-file-from-flex-to-wcf-rest-stream-issues-how-to-decode-multipart-form/8943948#8943948)

# java - 什么是 addNotify();？

> ID：15519916
> 
> 赞同：7
> 
> 时间：2013-03-20T09:40:41.910
> 
> 标签：java, methods, overriding

我试图找到一个外行的定义，`addNotify()`但我无法使用谷歌得到任何答案。

据我所知，`addNotify()`在课堂上压倒一切时，我应该先打电话`super.addNotify();` ，然后再做其他事情。

我的问题是，会`addNotify()`自动运行吗？它的目的是什么，当我覆盖它时会发生什么，此外，我为什么要覆盖这个方法？

谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-20T09:58:30.763

> 我的问题是，addNotify() 会自动运行吗？

是的。确切的位置和时间取决于 AWT 实现的内部结构。

> 它的目的是什么

如[javadoc](http://docs.oracle.com/javase/6/docs/api/java/awt/Component.html#addNotify%28%29)中所述。它是非常低级的东西，是连接 AWT 世界和本地窗口世界的“胶水”的一部分。（我故意说得很高级和含糊不清。如果您想了解细节，请下载并阅读 OpenJDK 源代码。）

> 当我覆盖它时会发生什么

你可能会破坏 AWT :-)

> 此外，我为什么要覆盖这个方法？

我想不出这样做的充分理由……除非您试图将 AWT 移植到不同的操作系统或不同的本机窗口系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:45:49.590

方法`addNotify() / removeNotify()` 是 AWT 提供的唯一钩子，我们可以在其中正确地销毁和重新创建 OpenGL 上下文，因为底层的原生小部件正在被销毁。
`addNotify()`低级组件使用它与操作系统上的底层对等点进行交互，以便真正发生某些事情，而不仅仅是屏幕上的漂亮图片。
**最好避免使用这种方法。**

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:44:55.907

[**Component#addNotify()**](http://docs.oracle.com/javase/6/docs/api/java/awt/Component.html#addNotify%28%29)是`java.awt.Component`类中的方法。API 中说明此方法的目的：

> 通过将其连接到本机屏幕资源，使该组件可显示。此方法由工具包内部调用，不应由程序直接调用。

# javascript - Backbone.js 初始化多个 router.js 文件

> ID：15519919
> 
> 赞同：0
> 
> 时间：2013-03-20T09:40:51.217
> 
> 标签：javascript, backbone.js, requirejs, underscore.js, backbone-routing

我正在使用 Backbone.js require.js underscore.js 来构建应用程序。在我的 javascript 中，我有处理菜单选择的 mainrouter.js 文件。

该应用程序分为几个部分，我希望每个部分都有一个 sectionRouter.js 文件。

出于某种原因，当尝试加载一个 sectionRouter.js 时，我收到以下错误

> 类型错误：SectionRouter 未定义

这是我的 mainApplication.js 文件的代码

```
define([ 
     'jquery', 
     'underscore', 
     'backbone', 
     'mainRouter', // Request mainRouter.js 
     'bootstrap',
     'sectionRouter'  // this is the
 ], function($, _, Backbone, Router,SectionRouter){ 
var initialize = function(){ // Pass in our Router module and call it's initialize function
    Router.initialize();
    initializeAnalytics();
    //Initiate a new history and controller class
    Backbone.emulateHTTP = true;
    Backbone.emulateJSON = true;           
    Backbone.history.start();                
}; 

var initializeAnalytics = function(){
    SectionRouter.initialize();
};

var initializeAll = function(){
    initialize();
    initializeAnalytics();
};

return { 
    initialize: initialize
};  
}); 
```

sectionRouter的一部分：

```
 var SectionRouter= Backbone.Router.extend({
            //restfulUrl:"http://localhost:8080/myapp/", //This is the application service 
                            //Routes tell the app what to do
            routes:{
                "analytics/consumptions":"consumptionsActions",
                "analytics/contents":"contentsActions",
                "analytics/users":"usersAction"                    
            }               
        });

 var initialize = function (){              
            var sectionConsoleRouter= new SectionRouter;                
            //map consumptionsAction routing
            sectionConsoleRouter.on('route:consumptionsActions', function(){                    
                SeriesStorage(url to call);                  
             });
   };

  return { 
            initialize: initialize
        }; 
```

你能告诉我是否可以一起加载 mainRouter.js 和其他 sectionRouter.js 文件。

**编辑**

是否可以在 mainRouter 中初始化 sectionRouter？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:46:16.970

You've added bootstrap to your list of define function parameters, but the list doesn't match the modules in your require array. So SectionRouter doesn't have a value (which is why you're getting "undefined").

Try:

```
define([ 
     'jquery', 
     'underscore', 
     'backbone', 
     'mainRouter', // Request mainRouter.js 
     'sectionRouter'  // this is the
     'bootstrap'
 ], function($, _, Backbone, Router,SectionRouter, Bootstrap){ 
```

There are probably other things to improve what you're trying to achieve but this will answer the question you've asked here.

# java - 用于多个计划作业的 Java 框架

> ID：15519921
> 
> 赞同：0
> 
> 时间：2013-03-20T09:40:51.327
> 
> 标签：java, scheduled-tasks, apache-camel

我想问是否有人可以为后端计划的作业建议适当的框架。目前整个后端基于多个计划的作业。所有作业都是用 java 编写并部署在 linux 机器上。这些作业由 cron（使用 crontab）和简单的 bash 脚本作为包装器控制，所以基本上我有几个 jars（它们都是基于 spring 的 uber-jars [带有依赖项]），它们会定期触发。这些 java 模块正在做各种各样的事情，比如处理 csv/xml 文件、从 web 服务获取数据、调用外部 API (HTTP) 以及从 FTP 收集数据。是否有一个框架让我能够将所有模块放在一个地方并简单地管理它们？我在考虑骆驼（我以前用过），但对我来说必须的是：

1.  能够在不中断其余模块的情况下部署/取消部署单个模块。
2.  在运行时重新安排作业（cron 表达式）的能力。

Camel 几乎是完美的，因为它具有用于外部集成（FTP、HTTP、WS）的所有功能，并且还具有简单的石英集成功能。我不知道拥有多个模块并在运行时部署/取消部署它们是否可以实现。

也许还有其他一些框架可以满足我的需求。请建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:20:57.767

如果计划在 Java/Scala 中执行此操作，请尝试使用[Quartz](http://quartz-scheduler.org/) 它（也）提供了类似 CRON 的语法来调度作业。

我们将我们的“模块”作为 webapps 部署在一个简单的 servlet 容器（jetty）上，并使用 Quartz 调度程序在它们上触发操作（也在 webapp 中公开一个简单的 UI）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T22:11:26.173

为了管理模块的加载和卸载，您可能希望查看基于 OSGI 的东西，例如[Apache ServiceMix](http://servicemix.apache.org/)，它在您描述的方式中似乎特别适合模块管理（我承认我不太了解您对加载和卸载模块）。将 Quartz 添加到 ServiceMix 以安排作业。

# asp.net - 如何在 Web 应用程序解决方案中使用 Web 服务

> ID：15519927
> 
> 赞同：1
> 
> 时间：2013-03-20T09:41:07.300
> 
> 标签：asp.net, web-services, iis, c#-3.0

Web 应用程序（ASP.NET Web 项目）需要与 Web 服务（Web 服务项目）进行通信。我应该将 Web 引用 ( [http://xyz.asmx](http://xyz.asmx) ) 添加到 Web 应用程序 ( [http://abc.aspx](http://abc.aspx) ) 以使用 Web 服务的接口。

但，

如果想将 Web 服务项目添加到 Web 应用程序解决方案中，我该如何使用 Web 服务。我需要独立部署 Web 服务还是只部署 Web 应用程序？

请在这方面指导我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T10:54:19.320

您应该在本地 IIS 上部署 Web 服务，然后您可以使用它将 Web 引用添加到您的 Web 应用程序。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T19:42:42.220

是的，您可以在同一个解决方案下运行 Web 服务和 Web 应用程序 - 您只需在`web.config`.

# sql - 如何在 sql server 2012 中比较 2 个不同格式的日期

> ID：15519934
> 
> 赞同：0
> 
> 时间：2013-03-20T09:41:14.680
> 
> 标签：sql, sql-server, sql-server-2012

我有 2 个日期，如下所示。

```
End_Date = DATEADD(DAY, ABS(CHECKSUM(NEWID()) % 365), '01/01/2000')
Cur_Date = SELECT CONVERT(VARCHAR(10),GETDATE(),111 
```

我想检查是否`End_Date`小于，`Cur_Date`以便我可以进行特定更新。

我当前的查询如下

```
update bed
set Status_Avai_Occ = 
    case when (
                ( select  End_Date 
                  from Patient_Record 
                  where b_ID= @b and
                  End_Date <> '-' 
                  and End_Date is not null
                ) <  (
                       SELECT CONVERT(VARCHAR(10),GETDATE(),111)
                     )
               ) then 'Available' 
```

但我收到以下错误：

> *消息 241，级别 16，状态 1，第 5 行
> 从字符串转换日期和/或时间时转换失败。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:21:02.667

我能看到的唯一会给出该错误的行是

```
End_Date <> '-' 
```

这似乎暗示 End_Date 是 DATE 或 DATETIME 列。如果是这样，您可以使用以下方法简单地比较日期：

```
End_Date < GETDATE() 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T10:46:24.693

您可以将 getdate() 舍入到午夜，这样：

```
 SELECT CAST(FLOOR(CAST(GETDATE() AS FLOAT)) AS DATETIME) 
```

# javascript - 使用 yepnope，我如何知道 css 资源是否已成功加载？

> ID：15519937
> 
> 赞同：1
> 
> 时间：2013-03-20T09:41:15.117
> 
> 标签：javascript, css, yepnope

我正在开发一个网络应用程序供公司内部使用，该公司具有严格（且不断发展）的防火墙。

我正在使用 yepnope.js / Modernizr.load 从 CDN 加载带有后备功能的 js 和 css 文件。

但是我怎么知道css是否加载成功？有没有办法测试 css 的成功加载和激活？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T14:50:52.520

感谢@Morpheus 的提示，这里有一个解决方案：

首先，为了不依赖任何东西（jQuery 等），我们需要定义 2 个函数：

*   一种获取元素的 css 属性：

来自[http://robertnyman.com/2006/04/24/get-the-rendered-style-of-an-element/](http://robertnyman.com/2006/04/24/get-the-rendered-style-of-an-element/)

```
function getStyle(oElm, strCssRule) {
    var strValue = "";
    if(document.defaultView && document.defaultView.getComputedStyle){
        strValue = document.defaultView.getComputedStyle(oElm, "").getPropertyValue(strCssRule);
    }
    else if(oElm.currentStyle){
        strCssRule = strCssRule.replace(/\-(\w)/g, function (strMatch, p1){
            return p1.toUpperCase();
        });
        strValue = oElm.currentStyle[strCssRule];
    }
    return strValue;
}, 
```

*   另一个创建隐藏的 DOM 元素并测试其 css 属性：

来自[https://stackoverflow.com/a/8122005/587407](https://stackoverflow.com/a/8122005/587407)

```
function test_css(element_name, element_classes, expected_styles, rsrc_name, callback) {
  // create an element of given type
  var elem = document.createElement(element_name);
  // immediately hide it
  elem.style.display = 'none';
  // give it the class(es)
  for (var i = 0; i < element_classes.length; i++) {
    elem.className = elem.className + " " + element_classes[i];
  }
  // and add it to the DOM
  document.body.appendChild(elem);

  // test the given properties
  // it happens (~1/3 times in local)
  // that the css takes a few ms to apply.
  // so we need a function that we can try directly first
  // and retry again later in case of failure
  var handle = -1;
  var try_count = 0;
  var test_function = function() {
    var match = true; // so far
    try_count++;
    for (var key in expected_styles) {
      console.log("[CSS loader] testing " + rsrc_name + " css : " + key + " = '" + expected_styles[key] + "', actual = '" + get_style_of_element(elem, key) + "'");
      if(get_style_of_element(elem, key) === expected_styles[key]) {
        match = match && true;
      } else {
        console.error("[CSS loader] css " + rsrc_name + " test failed (not ready yet ?) : " + key + " = " + expected_styles[key] + ", actual = " + get_style_of_element(elem, key) );
        match = false;
      }
    }

    if (match === true || try_count >= 3) {
      if (handle >= 0)
        window.clearTimeout(handle);
      // remove our test element from the DOM
      document.body.removeChild(elem);
      if (!match)
        console.error("[CSS loader] giving up on css " + rsrc_name + "..." );
      else
        console.log("[CSS loader] css " + rsrc_name + " load success !" );
      callback(rsrc_name, match);
    }
    return match;
  }

  // use and program the function
  if(! test_function() ) {
    console.info("" + rsrc_name + " css test failed, programming a retry...");
    handle = window.setInterval(test_function, 100);
  }
} 
```

请注意，由于 css 的延迟加载，前面的函数很棘手。

我们现在可以像这样使用 yepnope：

```
{
  load: { 'bootstrap-css': 'http//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css' },
  callback: function (url, result, key) {
  // here for bootstrap, I test presence of .span1 class
  test_css('span', [ 'span1' ], { 'width': '60px' }, function(match) {
    if( match )  {
      // it worked !
    }
    else {
      // ... fallback on another CDN or local rsrc...
    }
  }
} 
```

# symfony - 教义 2 自定义类型

> ID：15519940
> 
> 赞同：1
> 
> 时间：2013-03-20T09:41:18.143
> 
> 标签：symfony, types, doctrine-orm

我正在尝试遵循 [http://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/types.html](http://docs.doctrine-project.org/projects/doctrine-dbal/en/latest/reference/types.html)上的示例 并创建自定义数量类型。当数量类型定义为：

```
class Quantity extends Type
{
 const QUANTITY = 'quantity'; // modify to match your type name

 public function getSqlDeclaration(array $fieldDeclaration, AbstractPlatform $platform)
 {
    return 'decimal(10,2)';
 }

 public function getName()
 {
    return self::QUANTITY;
 } 
```

}

不过介绍的时候

```
public function convertToDatabaseValue($value, AbstractPlatform $platform)
{
    return $value->toDecimal();
} 
```

保存时出现以下错误：

> FatalErrorException：错误：在 ...\Types\Quantity.php 第 26 行中的非对象上调用成员函数 toDecimal()

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T13:05:58.063

`$value`你得到的是要么`string`或`null`。你不能调用`toDecimal`它。尝试：

```
public function convertToDatabaseValue($value, AbstractPlatform $platform) {
    return $value === null ? null : (float) $value;
} 
```

# css - 如何根据body id用LESS设置样式

> ID：15519941
> 
> 赞同：3
> 
> 时间：2013-03-20T09:41:20.017
> 
> 标签：css, less, document-body

是否有任何选项可以根据带有 LESS 的 body id 为某些元素设置样式？

我需要做这样的事情：

```
@body_about = #about_page;

img when (isclass(@body_about)){
   // some style
} 
```

这个 img 定义被深深地埋没了，我不想把它画到……有什么选择吗？谢谢帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T14:40:16.207

这是基于您对“定义深埋”的评论以及您对 MarmiK 的回答的第一条评论而对您需要什么的推测。如果我与您在这里需要的东西相去甚远，请告诉我，我将删除我的答案。

**较少的**

```
.someClass1 {
  .someClass2 {
    .someClass3 {
      img {
        /* normal code */
        #about_page & {
          /* about page code */
        }  
      }     
    }
  }
} 
```

**CSS 输出**

```
.someClass1 .someClass2 .someClass3 img {
  /* normal code */

}
#about_page .someClass1 .someClass2 .someClass3 img {
  /* about page code */

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:54:18.733

只是嵌套样式，我的理解是，您希望 img 在#about_page 下具有样式。

在这种情况下，您可以在 css 中执行此操作

```
#body_about>img{border:0} 
```

这将仅应用于`img`带有 ID 的标签下`#body_about`

```
 <div id="body_about"> /* this can be any tag <body> or <div> or... */
   <img src="" alt="" />
 </div> 
```

我希望这会做:)

# itextsharp - 使用 itextsharp 的文本的 x 和 y 坐标

> ID：15519945
> 
> 赞同：4
> 
> 时间：2013-03-20T09:41:31.247
> 
> 标签：itextsharp

当我使用 itextsharp 提取文本时，我将获得文本的 x 和 y 坐标。如果我根据 xy 位置将文本从 pdf 转换为 html，则通过使用这 2 个坐标，文本位置会发生变化。获取我使用的 x ,y 坐标

*   矢量 curBaseline = renderInfo.GetBaseline().GetStartPoint();

*   浮动 x=curBaseline[Vector.I1];

*   浮动 y= curBaseline[Vector.I2];

    例如：当我使用上述方法提取文本时说 x=42 和 y=659；

    ## " < span style=left:{0}px;bottom:{1}px;position:relative;\">",curBaseline[Vector.I1],curBaseline[Vector.I2]); 位置发生变化。你能帮忙吗我如何将文本默认位置设置为 pdf.???????

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-20T13:42:47.427

发布为答案...

如果我没记错的话，PDF 使用的坐标系从页面底部的左角开始，而不是在顶部。因此，当您直接在 html 中使用它时，每个坐标都是错误的。您将不得不转换这些值。

您的 pdf 文档应该有类似 document.actualheight 的内容，只需从中减去您的值....

# mysql - 除非薪水超过 100,000 美元，否则给所有经理加薪 10%；在这种情况下，只加薪 3%

> ID：15519951
> 
> 赞同：1
> 
> 时间：2013-03-20T09:41:37.727
> 
> 标签：mysql, sql

嗨，我有以下数据库架构。

```
employee (employee-name, street, city)
    works (employee-name, company-name, salary)
    company (company-name, city)
    manages (employee-name, manager-name) 
```

我需要给 First Bank Corporation 的所有经理加薪 10%，除非薪水超过 100,000 美元；在这种情况下，只加薪 3%。

我已经为上述问题写了以下查询。

```
UPDATE works w, manages m
SET w.salary += (salary * 0.10)
WHERE w.employee-name = m.manager-name
AND w.company-name = ‘First Bank Corporation’ 
```

但从查询中可以看出，我没有检查工资大于 100000 美元的情况。谁能告诉我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T09:44:07.280

```
SET w.salary *= case when salary > 1000000 then 1.03 else 1.10 end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:46:10.423

如果我理解正确，如果在加薪后他们没有超过 100K，他们需要加薪 10%，在这种情况下使用这个查询；

```
UPDATE works w, manages m
SET w.salary += salary * case when salary+salary*0.10 > 1000000 then 0.03 else 0.10 end
WHERE w.employee-name = m.manager-name
AND w.company-name = ‘First Bank Corporation’ 
```

如果情况是如果他们目前低于 100K，他们需要加薪 10%，请使用以下方法；

```
UPDATE works w, manages m
SET w.salary += salary * case when salary > 1000000 then 0.03 else 0.10 end
WHERE w.employee-name = m.manager-name
AND w.company-name = ‘First Bank Corporation’ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T09:46:53.167

您应该添加一个案例陈述

```
UPDATE works w, manages m
SET w.salary = (CASE
WHEN (w.salary * 0.10) < 100000 THEN w.salary + (salary * 0.10)
ELSE w.salary + (salary * 0.03)
END CASE)
WHERE w.employee-name = m.manager-name
AND w.company-name = ‘First Bank Corporation’ 
```

# c# - 在c#中获取文件路径

> ID：15519955
> 
> 赞同：-3
> 
> 时间：2013-03-20T09:41:50.873
> 
> 标签：c#, winforms

我想使用图像`smile.jpg`。我已将**jpg**文件保存到位置**../project/Cam/bin/Debug/smile.jpg** （这部分路径是静态的）

但是以前的路径是动态的，谁能给我一个想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:44:18.437

不是很清楚哪条路是哪条路，但试着“玩”一下

[Assembly.GetExecutingAssembly](http://msdn.microsoft.com/it-it/library/system.reflection.assembly.getexecutingassembly.aspx)和[Path.GetDirectoryName](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx)

```
//THIS RETURNS YOU A FOLDER WHERE YOUR APPLICATION RUNS
var exeutingFolder = Path.GetDirectoryName(System.Reflection.Assembly.GetExecutingAssembly().Location); 
```

和

```
//COMBINE EXECUTING FOLDER WITH RELATIVE PATH YOU HAVE
var resultinPath = Path.Combine(executingFolder, YOUR_PATH); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T09:59:36.007

加载应用程序附带的图像的潜在问题有几种解决方案：

**解决方案 1：资源**
如果不需要存在图像文件，您可以简单地将图像添加到程序的资源中并在设计器中分配它。然后不必部署图像文件。

为此，请将图像文件添加到您的项目中，然后将其拖到项目属性的“资源”选项卡中。

**解决方案 2：将文件复制到输出文件夹**
也许您希望将图像放在输出文件夹中，并在运行时从文件中加载它们。那么你*真的应该避免*对文件夹做出任何假设，而是执行以下操作：

1.  将图像文件添加到您的项目并将其构建类型设置为“无”，并始终将它们复制到输出文件夹。如果你构建你的项目，图像文件现在应该在`/bin/debug`or中`/bin/release`。
2.  在您的代码中，使用程序集文件夹构建文件的路径

此代码获取程序集文件夹并将路径名组装到名为“smiley.png”的图像中：

```
string assemblyPath = Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);
string smileyPath = Path.Combine(assemblyPath, "smiley.png"); 
```

如果您将图像添加到项目中的文件夹，该文件夹也将在输出文件夹中创建。`bin/debug`例如：如果您将图像放入文件夹“images”，则在or中会有一个文件夹“images” `bin/release`。在这种情况下，您可以安全地假设以下代码将起作用：

```
string assemblyPath = Path.GetDirectoryName(Assembly.GetEntryAssembly().Location);
string imagePath = Path.Combine(assemblyPath, "images");
string smileyPath = Path.Combine(imagePath, "smiley.png"); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-20T09:44:10.627

你想从相对路径中获取完整路径吗？

如果是这样，您可以使用[System.IO.Path.GetFullPath()](http://msdn.microsoft.com/en-us/library/system.io.path.getfullpath.aspx)

例如

`string fullPath = System.IO.Path.GetFullPath("../project/Cam/bin/Debug/smile.jpg");`

# node.js - 在 ubuntu 或 centos 上安装 node-expat

> ID：15519957
> 
> 赞同：1
> 
> 时间：2013-03-20T09:41:59.887
> 
> 标签：node.js, npm, node-expat

我正在尝试安装`node-expat`. 我已经尝试了我能找到的所有建议。运行时我没有收到任何构建错误`npm install node-expat`。我已经放入了所有依赖项和构建工具包，`npm cache clean`在 CentOS（Amazon Linux）和 Ubuntu 12.10 上都试过了，但错误仍然是一样的：

```
module.js:485
  process.dlopen(filename, module.exports);
          ^
Error: Module version mismatch, refusing to load.
    at Object.Module._extensions..node (module.js:485:11)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12)
    at Module.require (module.js:362:17)
    at require (module.js:378:17)
    at Object.<anonymous> (/home/ubuntu/cc/node_modules/node-expat/lib/node-expat.js:4:13)
    at Module._compile (module.js:449:26)
    at Object.Module._extensions..js (module.js:467:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:312:12) 
```

我怎样才能让它顺利运行？

我想要 node-expat 的原因是 node-xmpp

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-11T14:15:28.327

这可能对您有帮助，也可能对您没有帮助，但是我正在使用的 appjs 应用程序遇到了同样的错误，我刚刚弄清楚是什么导致了我。我在我的机器上安装了 node v0.10.x，但我正在构建模块以将它们包含在 appjs 应用程序中（当前与 node.exe 的 v0.8.x 打包在一起。所以我用 0.10 构建模块，但试图在 0.8 上运行它。

我卸载了我的节点 0.10，安装了 0.8，将有问题的模块重新构建/安装到我的 appjs 应用程序中，错误就消失了。因此，请确保您使用与您尝试运行它的相同版本的节点构建模块！

# c++ - C++中的优先队列INSERTION和DISPLAY函数

> ID：15519959
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:03.113
> 
> 标签：c++, queue

尝试实现优先级队列插入 dev c++ IDE），即在优先级 > 新节点优先级的节点之前。来自用户的插入似乎发生在命令提示符下，但显示功能仅输出第一个节点。为什么没有显示其他队列元素？恐怕它们没有被首先插入，这就是为什么在随后插入 10,20,30 然后删除..它打印空队列..因为队列只有 10..为什么？请建议。

注意：我没有在代码中包含delete和main函数，但它在程序中，显然..没有发生运行时异常..编译工作正常。但没有想要的输出。

```
#include<iostream>
using namespace std;

typedef struct node{ //template would enable generic datatype
        int info,prn;
        node * link;
}node;

node * start = 0;
int item,pri;

    void insert(int item, int pri){
     node * newnode = new node;
     newnode-> info = item;
     newnode-> prn = pri;

     if(start == 0){//explicit check in insert if start is NULL.
              start = newnode;
              newnode->link = 0;
     }
     /*When you first run the program, start = 0 or NULL. You then say prev = start, 
so as a result prev = NULL. So when you try to access prev->link, there's an access violation.*/
     else{ 
          node * prev= start;
          node * temp = prev->link;
          while (temp!= 0){
                if(temp->prn > newnode->prn){
                        newnode -> link = prev -> link;
                        prev -> link = newnode;
                break;
                } 
                else{
                     if( temp->link == 0){
                              temp -> link = newnode;
                              newnode->link = 0;
                     break;
                     }
                } 
           prev = prev->link;                    
          }
     }
}
void display(){
     if(start == 0)
              cout<<"Empty priority queue\n";
     else{
          cout<<("The Contents of the List are: ");
          node *temp = start;   
          while(temp!=NULL){   //if we do while temp->link!=NULL, then last node won't print
                               cout<< temp->info;
                               cout<<" ---> ";
                               temp = temp->link;
          }
     }             
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:44:18.477

第一次调用 insert 时，start 将为 0，但您将其分配给 prev。在下一行，`prev->link`当您调用 NULL 上的方法（调用未定义的行为）时，给您调用的错误导致 c++ 崩溃。如果`start`为 NULL，则应在 insert 中添加显式检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-20T09:45:06.300

首次运行程序时，start = 0 或 NULL。然后你说 prev = start，所以结果 prev = NULL。因此，当您尝试访问 prev->link 时，会出现访问冲突。

# php - 如何在 NetBeans 中显示 PHP 的警告和错误消息？

> ID：15519960
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:03.027
> 
> 标签：php, netbeans

例如

```
<?php
$fail = 1/0; 
?> 
```

浏览器中显示以下警告

```
Warning: Division by zero in C:\myserver\ProjectPhp\index.php on line 2 
```

我想在 NetBeans 中看到这个警告

可能吗？如何？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-03T00:59:36.563

是运行时间错误。没有启动 - 没有这样的错误消息。Netbeans 可以突出显示一些可能的错误，例如“未定义的变量”，但它经常出错（对我来说：））。

如果您将自定义以使用 CLI 启动启动，您可能会在 NetBeans 中看到错误。完成此操作后，您可以在 NetBeans 窗口中运行 php 文件。因此，您会在 NetBeans 中看到错误 :^)

# c# - JQuery 设置 MVC Post 的隐藏输入

> ID：15519963
> 
> 赞同：3
> 
> 时间：2013-03-20T09:42:17.973
> 
> 标签：c#, jquery, asp.net-mvc

我有这个[fiddle](http://jsfiddle.net/Dwb7N/17/)，它显示了一个带有多个选择的列表框，如果您单击读取，它会获取选定的值并将它们放入`<p>`标记中。

两个问题：

1）你如何修改我创建的小提琴，所以当你完成选择列表框中的项目时，它会自动将它们放入`<p>`标签中？我猜你走的是“改变”路线。

2）你如何修改我创建的小提琴，所以它将**所选值的数组放入隐藏的输入**中，然后**提交回**MVC3 控制器？这样做可以实现吗？

**更新：** 接受你们提出的答案，我想我会用你们的答案分享我设法实现和完成的事情，这个[小提琴中显示的例子](http://jsfiddle.net/bkCzt/2/)

*   单选列表框
*   根据第一个列表框的选定项动态更改第二个列表框的内容
*   显示从第二个框中选择了哪些项目，最后从第一个列表框中选择了值，这些都放在隐藏的输入中

谢谢大家花时间帮助我:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:14:52.583

这是小提琴[http://jsfiddle.net/tAaRR/2/](http://jsfiddle.net/tAaRR/2/)

我刚刚将您的 javascript 代码替换为以下内容：

```
 $(document).ready(function () {
     $('#App_RunFromUSB').change(function () {
         if ($('#App_RunFromUSB:checked').length > 0) {
             $('#jj').show('1000');
         } else {
             $('#jj').hide('1000');
         }
     });

     $('#SelectBox').change(function () {
      var Value = '';
             var text = '' 

         $("#SelectBox option:selected").each(function () {
            Value+=$(this).val();
             text +=$(this).text();
             $("#selectedValues").append(Value + ": " + text + "<br />");
         });
      alert(text);
         $('#hidden1').val(text);

     });

 }); 
```

希望这可以帮助。如果有任何问题让我知道。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-21T04:33:06.263

只是出于好奇，通过一些优化更新了您的小提琴并减少了许多不需要的代码。如果你愿意，你可以看看。

[http://jsfiddle.net/tkkSr/](http://jsfiddle.net/tkkSr/)

```
$(function () {       
     var artItems = ["Art 1","Art 2","Art 3","Art 4","Art 5","Art 6"];
     var vidItems = ["Video 1","Video 2","Video 3","Video 4","Video 5","Video 6"];
     $('#SelectBox').change(function () {
         var str = "", inHTML = "",items;
         items = $(this).val() == 'art' ? artItems: vidItems;
         $.each(items,function(i,ob){
             inHTML += '<option value="'+i+'">'+ob+'</option>'
         });
         $("#SelectBox2").empty().append(inHTML);
     });

     $('#SelectBox2').change(function () {
         $("#selectedValues").text($(this).val() + ';' + $("#SelectBox").val());
         $('#hidden1').val($(this).val());
     });

 }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-20T10:02:32.997

这一点 jQuery 应该做......[这里的例子。](http://jsfiddle.net/TxK4N/)

```
$("#SelectBox").change(function(){
$("#selected").empty();

$("#SelectBox option:selected").each(function(){
    $("#selected").append("<p>" + $(this).val() + " : " + $(this).html() + "</p>"); 
    });
}); 
```

现在，如果您想将所选项目包含在隐藏值中并将其发布到您的控制器，您可以使用 AJAX 调用或隐藏表单值。

# java - 空指针异常 jnlp.FileSaveService

> ID：15519964
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:22.910
> 
> 标签：java, tomcat, spring-mvc, nullpointerexception, jnlp

我正在尝试使用 jnlp.FileSaveService 来“saveAs”在 Java Web 应用程序的控制器中生成的 .txt 文件。我在这里找到了一些示例 [http://docs.oracle.com/javase/tutorial/deployment/doingMoreWithRIA/usingJNLPAPI.html](http://docs.oracle.com/javase/tutorial/deployment/doingMoreWithRIA/usingJNLPAPI.html) 我不完全理解它是如何工作的，我在这一行得到空指针异常：

```
fc = fss.saveFileDialog(null, null, new ByteArrayInputStream(txt.getBytes()), null); 
```

我是否将某些错误传递给方法 saveFileDialog 或者是其他什么？我将不胜感激任何帮助。

```
static private FileOpenService fos = null;
static private FileSaveService fss = null;
static private FileContents fc = null;

private static synchronized void initialize() {
    try {
        fos = (FileOpenService)ServiceManager.lookup("javax.jnlp.FileOpenService");
        fss = (FileSaveService)ServiceManager.lookup("javax.jnlp.FileSaveService");
    } catch (UnavailableServiceException e) {
    }
}

public static void save(String txt) {
    initialize();
    try {
        // Show save dialog if no name is already given
        if (fc == null) {
            fc = fss.saveFileDialog(null, null, new ByteArrayInputStream(txt.getBytes()), null);
            // file saved, done
            return;
        }
        // use this only when filename is known
        if (fc != null) {
            writeToFile(txt, fc);
        }
    } catch (IOException ioe) {ioe.printStackTrace(System.out);
    }
}

public static void saveAs(String txt) {
    initialize();
    try {
        if (fc == null) {
            // If not already saved. Save-as is like save
            save(txt);
        } else {
            fc = fss.saveAsFileDialog(null, null, fc);
            save(txt);
        }
    } catch (IOException ioe) {
        ioe.printStackTrace(System.out);
    }
}

private static void writeToFile(String txt, FileContents fc) throws IOException {
    int sizeNeeded = txt.length() * 2;
    if (sizeNeeded > fc.getMaxLength()) {
        fc.setMaxLength(sizeNeeded);
    }
    BufferedWriter os = new BufferedWriter(new OutputStreamWriter(fc.getOutputStream(true)));
    os.write(txt);
    os.close();
}

@RequestMapping(value = "/exportPhonebook.html", method = RequestMethod.POST)
public String exportPhonebook(Model model) {

    List<User> listOfAllUsers = phoneBookSer.fetchAllUsers();
    String phonebook = "";

    for (User user : listOfAllUsers) {
        phonebook = phonebook + user.getSurname() + " " + user.getName() + 
        ", Phone Number: " + user.getPhoneNumber() + ";\r\n" ;
    }

    saveAs(phonebook);
} 
```

这是堆栈跟踪

```
20.03.2013\. 13:19:41 org.apache.catalina.core.StandardWrapperValve invoke
SEVERE: Servlet.service() for servlet [springDipatcher] in context with path [/phonebook] threw exception [Request processing failed; nested exception is     java.lang.NullPointerException] with root cause
java.lang.NullPointerException
at phonebook.controllers.ExportPhonebook.save(ExportPhonebook.java:80)
at phonebook.controllers.ExportPhonebook.saveAs(ExportPhonebook.java:97)
at phonebook.controllers.ExportPhonebook.exportPhonebook(ExportPhonebook.java:129)
at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)
at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)
at java.lang.reflect.Method.invoke(Unknown Source)
at org.springframework.web.bind.annotation.support.HandlerMethodInvoker.invokeHandlerMethod(HandlerMethodInvoker.java:176)
at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.invokeHandlerMethod(AnnotationMethodHandlerAdapter.java:436)
at org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter.handle(AnnotationMethodHandlerAdapter.java:424)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:790)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:719)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:644)
at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:560)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:304)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:328)
at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:116)
at org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:95)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:79)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:119)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:80)
at org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:340)
at org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:175)
at org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:237)
at org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:167)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:88)
at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:76)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:243)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:240)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:164)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:498)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:164)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:100)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:562)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:394)
at org.apache.coyote.http11.Http11Processor.process(Http11Processor.java:243)
at org.apache.coyote.http11.Http11Protocol$Http11ConnectionHandler.process(Http11Protocol.java:188)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:302)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(Unknown Source)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)
at java.lang.Thread.run(Unknown Source) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T11:55:34.517

我采取了不同的方法来解决我的问题。我曾经`content-disposition`保存在 Controller 中生成的**.txt文件。**你可以在下面看到我的代码。

```
private void setResponseHeaderTXT(HttpServletResponse response) {
    response.setContentType("text/plain; charset=UTF-8");
    response.setHeader("content-disposition", "attachment; filename=imenik.txt" );
} 
@RequestMapping(value = "/exportPhonebook.html", method = RequestMethod.POST)
public void exportPhonebook(Model model, HttpServletResponse response) {

    List<User> listOfAllUsers = phoneBookSer.fetchAllUsers();
    String phonebook = "";

    for (User user : listOfAllUsers) {
        phonebook = phonebook + user.getSurname() + " " + user.getName() + ", + 
        ", Phone number: " + user.getPhoneNumber() + ";\r\n" ;
    }

    try {
        setResponseHeaderTXT(response);
        OutputStream outputStream = response.getOutputStream();
        outputStream.write(phonebook.getBytes(Charset.forName("UTF-8")));
        outputStream.flush();
        outputStream.close();
    } catch (IOException e) {
        e.printStackTrace();
    }   
} 
```

我使用**IText将我的电话簿导出为****pdf**格式做了类似的事情。

 **```
private void setResponseHeaderPDF(HttpServletResponse response) {
    response.setContentType("application/pdf");
    response.setHeader("content-disposition", "attachment; filename=imenik.pdf" );
} 

@RequestMapping(value = "/exportPhonebook.html", method = RequestMethod.POST)
public void exportPhonebook(Model model, @RequestParam("buttonSpremiImenik") String buttonSpremiImenik, HttpServletResponse response, HttpServletRequest request) {

    try {
        setResponseHeaderPDF(response);
        Document document = new Document();
        ByteArrayOutputStream baosPDF = new ByteArrayOutputStream();
        PdfWriter pdfWriter = null;
        pdfWriter = PdfWriter.getInstance(document, baosPDF);
        document.open();
        addMetaData(document);
        addTitlePage(document);
        addContent(document);
        document.close();
        pdfWriter.close();
        OutputStream os = response.getOutputStream();
        baosPDF.writeTo(os);
        os.flush();
        os.close();
    } catch (Exception e) {
        e.printStackTrace();
    }
}

private static Font catFont = new Font(Font.FontFamily.TIMES_ROMAN, 18,Font.BOLD);
private static Font smallBold = new Font(Font.FontFamily.TIMES_ROMAN, 12,Font.BOLD);
private static Font tableHeaderFont = new Font(Font.FontFamily.TIMES_ROMAN, 10,Font.BOLD);
public static String[][] FONTS = {{"c:/windows/fonts/arial.ttf", BaseFont.IDENTITY_H}};

private static void addMetaData(Document document) {
    document.addTitle("Phonebook");
    document.addSubject("phonebook");
    document.addKeywords("phonebook");
    document.addAuthor("John Smith");
    document.addCreator("John Smith");
}
private static void addTitlePage(Document document) throws DocumentException {
    Paragraph preface = new Paragraph();
    addEmptyLine(preface, 1);
    preface.add(new Paragraph("Phonebook", catFont));
    addEmptyLine(preface, 1);
    preface.add(new Paragraph("Generated: " + new Date(), smallBold));
    addEmptyLine(preface, 1);
    document.add(preface);
}

private void addContent(Document document) throws DocumentException {

    Paragraph paragraph = new Paragraph();
    addEmptyLine(paragraph, 1);

    // Add a table
    createTable(paragraph);

    // Now add all this to the document
    document.add(paragraph);
}

private static void addEmptyLine(Paragraph paragraph, int number) {
    for (int i = 0; i < number; i++) {
        paragraph.add(new Paragraph(" "));
    }
}
private void createTable(Paragraph paragraf) throws DocumentException {

    PdfPTable table = new PdfPTable(9);
    table.setTotalWidth(new float[]{ 58, 50, 95, 60, 60, 135, 60, 42, 30 });
    table.setLockedWidth(true);

    List<User> listOfAllUsers = phoneBookSer.fetchAllUsers();

    PdfPCell c1 = new PdfPCell(new Phrase("Prezime", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Ime", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Organizacijska jedinica", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Telefon", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Telefaks", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("E-mail", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Lokacija", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Kat", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    c1 = new PdfPCell(new Phrase("Soba", tableHeaderFont));
    c1.setHorizontalAlignment(Element.ALIGN_CENTER);
    table.addCell(c1);

    table.setHeaderRows(1);

    BaseFont bf = null;
    try {
        bf = BaseFont.createFont(FONTS[0][0], FONTS[0][1], BaseFont.EMBEDDED);
    } catch (IOException e) {
        e.printStackTrace();
    }
    Font fontArial = new Font(bf, 9);

    //Automatically detects fonts
    //FontFactory.registerDirectories();
    //Font fontArial9 = FontFactory.getFont("Arial", 9);

    for (User user : listOfAllUsers) {
        PdfPCell cell1 = new PdfPCell(new Phrase(user.getPrezime(), fontArial));
        table.addCell(cell1);
        PdfPCell cell2 = new PdfPCell(new Phrase(user.getIme(), fontArial));
        table.addCell(cell2);
        PdfPCell cell3 = new PdfPCell(new Phrase(user.getOrganizacijskaJedinica(), fontArial));
        table.addCell(cell3);
        PdfPCell cell4 = new PdfPCell(new Phrase(user.getTelefon(), fontArial));
        table.addCell(cell4);
        PdfPCell cell5 = new PdfPCell(new Phrase(user.getTelefaks(), fontArial));
        table.addCell(cell5);
        PdfPCell cell6 = new PdfPCell(new Phrase(user.getEmail(), fontArial));
        table.addCell(cell6);
        PdfPCell cell7 = new PdfPCell(new Phrase(user.getLokacija(), fontArial));
        table.addCell(cell7);
        PdfPCell cell8 = new PdfPCell(new Phrase(user.getKat(), fontArial));
        table.addCell(cell8);
        PdfPCell cell9 = new PdfPCell(new Phrase(user.getBrojSobe(), fontArial));
        table.addCell(cell9);
    }

    paragraf.add(table);
} 
```**

# java - 读取excel的特定行

> ID：15519965
> 
> 赞同：-7
> 
> 时间：2013-03-20T09:42:24.680
> 
> 标签：java, apache-poi

我想从第 2 行到第 13 行读取 excel 表，并且还想获取相应的列值。请提供代码。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-20T09:52:19.273

您应该尝试[阅读 Apache POI 附带的文档](http://poi.apache.org/spreadsheet/quick-guide.html#Iterator)！

直接从那里拍摄：

```
// Decide which rows to process
int rowStart = Math.min(1, sheet.getFirstRowNum()); // 0 based not 1 based rows
int rowEnd = Math.max(12, sheet.getLastRowNum());

for (int rowNum = rowStart; rowNum < rowEnd; rowNum++) {
   Row r = sheet.getRow(rowNum);

   int lastColumn = Math.max(r.getLastCellNum(), MY_MINIMUM_COLUMN_COUNT);

   for (int cn = 0; cn < lastColumn; cn++) {
      Cell c = r.getCell(cn, Row.RETURN_BLANK_AS_NULL);
      if (c == null) {
         // The spreadsheet is empty in this cell
      } else {
         // Do something useful with the cell's contents
      }
   }
} 
```

[这部分文档](http://poi.apache.org/spreadsheet/quick-guide.html#CellContents)介绍了如何获取单元格的值

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T09:56:27.113

```
public class ApachePoiDoc
{
  public static void main( String[] args ) throws IOException, URISyntaxException
  {
    URL url = new URL( "http://poi.apache.org/spreadsheet/quick-guide.html#ReadWriteWorkbook" );
    Desktop.getDesktop().browse( url.toURI() );
  }
} 
```

# python - 通过 PasswordMgr 的 Python 身份验证仍然得到 401

> ID：15519968
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:26.887
> 
> 标签：python, unauthorized

所以我试图深入研究 Python，因为我想为 Plex 媒体服务器编写一个代理。该代理将使用 HTTP 身份验证访问 MyAnimeList.net API（更多信息在[这里](http://myanimelist.net/modules.php?go=api)）我的用户名和密码有效，但我不知道为什么我仍然从服务器收到 401 错误作为响应。

这是一些代码（我使用的是 python 2.5，因为 plex 是这样说的）:)

```
import urllib2

username = "someUser"
password = "somePass"

url = "http://myanimelist.net/api/anime/search.xml?q=bleach"

password_mgr = urllib2.HTTPPasswordMgrWithDefaultRealm()
top_level_url = "http://myanimelist.net/"
password_mgr.add_password(None, top_level_url, username, password)
handler = urllib2.HTTPBasicAuthHandler(password_mgr)
opener = urllib2.build_opener(urllib2.HTTPHandler, handler)
request = urllib2.Request(url)
print request.get_full_url()
f = urllib2.urlopen(request).read()

print(f) 
```

这就是我得到的回应

```
> http://myanimelist.net/api/anime/search.xml?q=bleach Traceback (most
> recent call last):   File
> "C:\Users\Daraku\Desktop\MAL.bundle\Contents\Code\__init__.py", line
> 16, in <module>
>     f = urllib2.urlopen(request).read()   File "C:\Python25\lib\urllib2.py", line 121, in urlopen
>     return _opener.open(url, data)   File "C:\Python25\lib\urllib2.py", line 380, in open
>     response = meth(req, response)   File "C:\Python25\lib\urllib2.py", line 491, in http_response
>     'http', request, response, code, msg, hdrs)   File "C:\Python25\lib\urllib2.py", line 418, in error
>     return self._call_chain(*args)   File "C:\Python25\lib\urllib2.py", line 353, in _call_chain
>     result = func(*args)   File "C:\Python25\lib\urllib2.py", line 499, in http_error_default
>     raise HTTPError(req.get_full_url(), code, msg, hdrs, fp) HTTPError: HTTP Error 401: Unauthorized 
```

请记住，这是我第一次在 Python 中编程，我对网络上的许多示例有点困惑，因为他们对 urllib2 做了一些事情，所以我认为它不再存在于 python 3.0 中

有任何想法吗？或者有什么更好的方法来做到这一点？

# java - 无法在下一个 JSP 页面上获取属性

> ID：15519970
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:29.260
> 
> 标签：java, jsp, servlets, web

无法使用 request.getAttribute("Attr") 获取下一个 JSP 页面上的属性。

为什么会这样？

```
if (methodName.equalsIgnoreCase("lookuptransaction")) {

    InvokerBeanFor_Transaction inTransaction = new InvokerBeanFor_Transaction();
    String result = inTransaction.callLookUpTransaction(endpoint);
    request.setAttribute("result", result);
    String s="GOPAL DAMELE";

    request.setAttribute("Attr",s);

}
request.getRequestDispatcher("result.jsp").forward(request, response); 
```

在 JSP 页面上检索属性时只打印 null

我使用了下面给出的 JSP 代码：

```
<jsp:include page="include.jsp"></jsp:include>
<body>
<form method="" action="">
<br>
<fieldset>
<legend><H3>Service Reply</H3></legend>
You have choosen <%=session.getAttribute("methodname")%> operation.<br/><br/>
<%String rslt= (String)request.getAttribute("result");
 %>
Service response is : <p><%=rslt%></p>
<%=(String)request.getAttribute("Attr") %>

</fieldset>
</form>
</body> 
```

# python - PyQt4 QtCore.so 符号未找到错误

> ID：15519971
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:31.137
> 
> 标签：python, macos, pyqt4

我安装了 sip 和 PyQt，但是当我执行类似的 python 代码时`python tutorial.py`，出现此错误。我用 brew install 和 configure.py 安装了 pyqt。

```
Traceback (most recent call last):
  File "untitled.py", line 4, in <module>
    from PyQt4 import QtCore, QtGui
ImportError: dlopen(/Library/Python/2.7/site-packages/PyQt4/QtCore.so, 2): Symbol not found: __ZN10QArrayData11shared_nullE
  Referenced from: /Library/Python/2.7/site-packages/PyQt4/QtCore.so
  Expected in: flat namespace
 in /Library/Python/2.7/site-packages/PyQt4/QtCore.so 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-22T09:22:18.980

我通过删除 Python 并使用 macPorts 安装 python 和 pyqt 解决了这个问题。

# java - 在 Java 中使用 Joda 查找两个日期之间的差异

> ID：15519972
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:33.197
> 
> 标签：java, netbeans, jodatime

我正在使用 Joda-Time 并试图找出日期之间的差异。

我的代码有问题吗？

这是我的代码：

```
LocalDate startDate = new LocalDate (19990-7-18);
LocalDate endDate = new LocalDate (2013-07-18);
Years Age = Years.yearsBetween(startDate, endDate);
int Age1 = Age.getYears();
String Age2 = new Integer(Age1).toString(); 
```

我正在使用 JOptionPane 来查看结果，它告诉我在 (age1) 上得到了 0。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-20T09:46:32.393

您需要在 LocalDate 定义中添加引号`"`以使用带有`String`参数的构造函数：

```
LocalDate startDate = new LocalDate("1999-07-18");
LocalDate endDate = new LocalDate("2013-07-18"); 
```

您所写的计算结果为`long`s，而构建的两个日期实际上相隔 0 年。

# mysql - 如果连接表上不存在mysql插入

> ID：15519975
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:37.260
> 
> 标签：mysql, insert

我的表如下所示：

表“帖子”

```
posts.id = PK, auto-increment
posts.text = varchar
posts.tag_id 1 = int, FK to tags.id
posts.tag_id 2 = int, FK to tags.id
posts.tag_id 3 = int, FK to tags.id 
```

表“标签”

```
tags.id = PK, auto-increment
tags.tag = varchar 
```

现在我想插入以下数据：

```
text: 'lorem ipsum'
tag1: 'music'
tag2: 'pop'
tag3: 'singer' 
```

所以我需要一个查询来检查 tag1/tag2/tag3 是否已经存在于“标签”中，否则插入它们，然后将它们作为外键 +“文本”插入到“帖子”中的新行中。

我查看了 mysql INSERT IF NOT EXISTS 但我只是卡住了，不知道从哪里开始。我知道我可以通过多个查询来处理它，但必须有另一种更轻松的方法来获得相同的结果。

有没有人有这方面的经验？

**更新**

我的一个朋友提出了这样的建议：

```
CREATE FUNCTION getTagID(tag VARCHAR('100')) RETURNS int

INSERT INTO posts (text,tag1,tag2,tag3) 
VALUES ('lorem ipsum', getTagID('music'), getTagID('pop'), getTagID('singer')); 
```

当然 getTagId 的实现仍然缺失，但这有意义吗？getTagID 应该选择具有给定标签的 id，如果它不存在，则插入它并返回它。任何帮助表示赞赏。

**解决方案**

我在 MySql 中创建了一个自定义函数：

```
DELIMITER ;;

CREATE FUNCTION getTagID(tag VARCHAR(100)) RETURNS BIGINT
BEGIN
  DECLARE tagID BIGINT;
  SET tagID = (SELECT id FROM tags WHERE text = tag);
  IF tagID IS NULL
  THEN
    INSERT INTO tags (text) VALUES (tag);
    SET tagID = (SELECT LAST_INSERT_ID());
  END IF;
  RETURN tagID;
END;;

DELIMITER ; 
```

现在我可以插入这样的帖子：

```
INSERT INTO posts (text,tag1,tag2,tag3) 
VALUES ('lorem ipsum', getTagID('music'), getTagID('pop'), getTagID('singer')); 
```

使用该函数，该函数仅在标签尚不存在时插入“标签”并返回现有或新创建标签的 ID。伊皮：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T14:29:37.237

您必须插入帖子，然后插入标签。SQL 中没有多表插入解决方案。

您甚至不能从标签上的触发器将帖子文本插入帖子，因为插入标签只能携带属于标签的列。

如果您需要避免标签表中的重复，您可以使用 INSERT IGNORE 或 REPLACE 或 INSERT ... ON DUPLICATE KEY UPDATE。[有关更多详细信息，请参阅我对“插入忽略”与“插入...在重复密钥更新”](https://stackoverflow.com/questions/548541/insert-ignore-vs-insert-on-duplicate-key-update/548570#548570)的回答。

* * *

重新发表您的评论。

只有让自增机制生成新的id，才能得到生成的PK。如果您让自动增量发生，则保证不会导致重复 PK。

如果指定 id 并绕过自动增量，则无论如何都无法获取 id。但是，如果您在 INSERT 中指定了该值，则无需查询该值——您应该已经拥有它。

唯一的另一种情况是，如果您有一个不是自动递增的辅助唯一键。

```
CREATE TABLE foo (id int auto_increment primary key, name varchar(10), unique key (name));
INSERT INTO foo (name) VALUES ('bill');
SELECT LAST_INSERT_ID(); -- returns 1
INSERT INTO foo (name) VALUES ('bill');
SELECT LAST_INSERT_ID(); -- returns 1 
```

这有点令人困惑，因为最后一个插入 id 来自最后一个*成功*并生成 id 的 INSERT。

* * *

重新更新您的`INSERT INTO posts (text,tag1,tag2,tag3)`. 这称为[重复组](https://stackoverflow.com/questions/951285/db-design-1st-normal-form-and-repeating-groups)。如果你需要四个标签怎么办？如果帖子只有两个标签怎么办？您如何对具有给定标签的帖子进行索引搜索？

# .net - 更改面板的 CSSclass

> ID：15519977
> 
> 赞同：1
> 
> 时间：2013-03-20T09:42:37.487
> 
> 标签：.net, css, panel, webforms

我正在尝试在后面的代码中动态更改面板的 CSS 类。

我尝试`DIV`使用`runat="server"`and `div.Attributes["class"]="myClass"`。没有成功。

然后我选择了asp面板。 `myPanel.cssClass = "myClass"`...没有成功。

我还在这里尝试了 AnthonyWJones 的解决方案： [Best way to change CSS Classes from code](https://stackoverflow.com/questions/445967/best-way-to-change-css-classes-from-code) With：

```
myPanel.RemoveCssClass("arrow_box");
myPanel.AddCssClass("arrow_boxMS"); 
```

仍然没有成功。

我唯一想改变的是`div`. 我帮自己解决了这个问题（生成 CSS）： [http ://cssarrowplease.com/](http://cssarrowplease.com/)

我的 CSS：

```
.arrow_box, .arrow_boxMS
{
    position: relative; /*background: #88b7d5;*/
    border: 2px solid #c2e1f5;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
    margin-top: 15px;
    z-index: -1;
}
.arrow_box:after, .arrow_box:before
{
    bottom: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute; /*pointer-events: none;*/
}
.arrow_box:after
{
    border-color: rgba(136, 183, 213, 0);
    border-bottom-color: #ffffff; /*#88b7d5;*/
    border-width: 15px; /*SET height of smaller triangle within arrow. IMPORTANT bigger triangle is set in .arrow_box:before class*/
    left: 8%;
    margin-left: -15px;
}
.arrow_box:before
{
    border-color: rgba(194, 225, 245, 0);
    border-bottom-color: #c2e1f5;
    border-width: 18px; /* SET height of bigger triangle - arrow IMPORTANT: difference between triangles must reflect how many pixels is border*/
    left: 8%;
    margin-left: -18px; /*if border thickness is changed adjust this to fit triangles*/
}

.arrow_boxMS:after, .arrow_boxMS:before
{
    bottom: 100%;
    border: solid transparent;
    content: " ";
    height: 0;
    width: 0;
    position: absolute; /*pointer-events: none;*/
}
.arrow_boxMS:after
{
    border-color: rgba(136, 183, 213, 0);
    border-bottom-color: #ffffff; /*#88b7d5;*/
    border-width: 15px; /*SET height of smaller triangle within arrow. IMPORTANT bigger triangle is set in .arrow_box:before class*/
    left: 25%;
    margin-left: -15px;
}
.arrow_boxMS:before
{
    border-color: rgba(194, 225, 245, 0);
    border-bottom-color: #c2e1f5;
    border-width: 18px; /* SET height of bigger triangle - arrow IMPORTANT: difference between trinagles must reflect how many pixels is border*/
    left: 25%;
    margin-left: -18px; /*if border thickness is changed adjust this to fit triangles*/
} 
```

单击按钮时，三角形不会改变。

有任何想法吗？

编辑：

```
<asp:UpdatePanel runat="server">
                <ContentTemplate>
                    <table id="tblSelection">
                        <tr>
                            <td>
                                <asp:Button ID="btn1" Text="1" CssClass="button" ClientIDMode="Static"
                                    runat="server" OnClick="btn1_Click" />
                            </td>
                            <td>
                                <asp:Button ID="btn2" Text="2" CssClass="button" ClientIDMode="Static"
                                    runat="server" OnClick="btn2_Click" />
                            </td>
                            <td>
                                <asp:Button ID="btn3" Text="3" CssClass="button" runat="server" OnClick="btn3_Click" />
                            </td>
                            <td>
                                <asp:Button ID="btn4" Text="4" CssClass="button" runat="server"
                                    OnClick="btn4_Click" />
                            </td>
                            <td>
                                <asp:Button ID="btn5" Text="5" CssClass="button" runat="server"
                                    OnClick="btn5_Click" />
                            </td>
                            <td>
                                <asp:Button ID="btn5" Text="5" CssClass="button" runat="server" OnClick="btn5_Click" />
                            </td>
                        </tr>
                    </table>
                </ContentTemplate>
            </asp:UpdatePanel>

            <asp:Panel id="divDaySelection" runat="server">           
                        <table id="tblDaySelection">
                            <tr>
                                <td>
                                    <asp:CheckBox ID="cbAllDays" Text="All" runat="server" 
                                        oncheckedchanged="cbAllDays_CheckedChanged" AutoPostBack="true" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbMon" Text="Monday" runat="server" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbTue" Text="Tuesday" runat="server" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbWed" Text="Wednesday" runat="server" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbThu" Text="Thursday" runat="server" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbFri" Text="Friday" runat="server" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbSat" Text="Saturday" runat="server" />
                                </td>
                                <td>
                                    <asp:CheckBox ID="cbSun" Text="Sunday" runat="server" />
                                </td>
                            </tr>
                        </table>

            </asp:Panel> 
```

似乎 updatepanel 是个问题，因为我现在得到结果......现在我删除了它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T10:23:10.620

问题是面板不在更新面板中......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-21T08:45:55.437

正如我（在编辑帖子期间）和洛基发现的那样，问题在于面板不在更新面板中。

从技术上讲，我所有更改 CSS 的方法都可以使用。

# jquery - 将根处的行添加到 JQuery 树表

> ID：15519979
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:39.017
> 
> 标签：jquery, treetable

我正在使用 treetable 插件，我想在表的根目录上添加一个新行，我使用`loadBranch`它可以很好地在树内添加行，但找不到在根目录上添加的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-23T07:04:08.363

您可以通过将 null 作为第一个参数发送到 loadBranch 来将行添加到根：

```
$("#tree").treetable("loadBranch", null, rows) 
```

# search - 迭代深化搜索选择坏招

> ID：15519983
> 
> 赞同：1
> 
> 时间：2013-03-20T09:42:44.197
> 
> 标签：search, artificial-intelligence, minimax

我正在编写一个九人莫里斯游戏，到目前为止，我的 Negascout 搜索工作得很好。但是，我想添加迭代深化，所以我想出了这段代码：

```
public Move GetBestMove(IBoard board, int depth)
{        
    //Search limits (ms
    this.maxTime = 9000; 

    //Set initial window
    int alpha = -INFINITY, beta = INFINITY;
    int val = 0;

    //The move that will be returned
    Move bestMove = null;      

    //Get list of moves for the current board 
    List<Move> moves = board.getMoves();

    //Get the time search has started
    long startTime = System.nanoTime();

    //Iterate through the depths
    for (curDepth = 1; ; )
    {
        maxDepth = curDepth;

        //Reset alpha
        alpha = -INFINITY;

        //Reset the best score position
        int bestPos = -1;

        //Loop through all the moves
        for (int i = 0, n = moves.size(); i < n; i++)
        {
            //Make the move
            board.make(moves.get(i), true);

            //Search deeper
            val = negascout(board, curDepth, alpha, beta, startTime);

            //Undo the move
            board.undo(moves.get(i));

            //Keep best move
            if (val > alpha)
            {
                bestMove = moves.get(i);
                bestPos = i;
            }

            //Score missed aspiration window
            if (val <= alpha || val >= beta)
            {
                alpha = -INFINITY;
                beta = INFINITY;

                //Go to next iteration
                continue;
            }

            //Set new aspiration window
            alpha = val - ASPIRATION_SIZE;
            if (alpha < -INFINITY)
                alpha = -INFINITY;

            beta = val + ASPIRATION_SIZE;
            if (beta > INFINITY)
                beta = INFINITY;
        }

        //Move the best move to the top of the list
        if (bestPos != -1)
        {
            moves.remove(bestPos);
            moves.add(0, bestMove);
        }

        //Time check
        double curTime = (System.nanoTime() - startTime) / 1e6;
        if (curTime >= maxTime ||
            val == board.getMaxScoreValue() ||
            val == -board.getMaxScoreValue())
            break;

        //Increment current depth
        curDepth++;
    }

    //Return the move
    return bestMove;
} 
```

我也使用抽吸窗口。然而，搜索返回最糟糕的举动！我认为问题在于重新/设置搜索窗口。搜索窗口是否应该移到外循环？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-30T04:39:28.780

由于您使用的是 negascout，因此您的初始调用应如下所示

```
val = -negascout(board, curDepth - 1, -beta, -alpha, startTime); 
```

与内部节点相比，您的根调用完全相反，因此这就解释了为什么它会返回最糟糕的举动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T22:32:14.573

[迭代深化](http://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search#Algorithm)策略：

```
for (depth = 1;; depth++) {
    val = AlphaBeta(depth, -INFINITY, INFINITY); // or negascout
    if (TimedOut())
        break;
} 
```

看起来与您使用`GetBestMove`. 内部循环（遍历可能的移动）应该是`negascout`. 此外，您似乎只在第一深度级别（1-ply）存储移动顺序，但为了使迭代加深搜索真正快速，它需要到目前为止搜索的每个深度的移动顺序。迭代深化不仅具有将时间考虑在内的优势（在 x 秒后完成），而且还具有生成良好移动顺序的优势。并且字母表或 negascout 算法受益于良好的移动排序（首先尝试这个移动，因为在之前的搜索中它是最好的）。实现移动排序的常用方法是[转置表](http://chessprogramming.wikispaces.com/Transposition+Table)。

来自 Bruce Moreland的文档[The Main Transposition Table](http://web.archive.org/web/20070809015843/www.seanet.com/~brucemo/topics/hashing.htm)和[Iterative](http://web.archive.org/web/20070809015849/http://www.seanet.com/~brucemo/topics/iterative.htm) Deepening 对我很有帮助，我希望这些链接也能帮助你！

# jquery - jquery解码json

> ID：15519986
> 
> 赞同：0
> 
> 时间：2013-03-20T09:42:53.313
> 
> 标签：jquery, json, slickgrid

我在解码 JSON 数据时遇到问题。实际上我希望将 slickgrid 的工作保存在 mysql 中。所以，我读了[问题]：[使用 php 在 SlickGrid 中保存更改，](https://stackoverflow.com/questions/6573277/saving-changes-in-slickgrid-with-php?lq=1)但不知道如何解码数据。

这是我处理 JSON 的 PHP 脚本：

```
 <script src="jquery-1.7.min.js"></script>
    <script type="text/javascript" src="jquery.json.js"></script>
    <?php

    if(isset($_POST['dataz']))
    {
        ?>
<!--this isn't working-->
        <script>
        var obj = $.JSON.decode(input[name='dataz'].val());
        alert('json decode : '+obj);
        </script>
        <?php
//this produce nothing
        echo json_decode($_POST['dataz']);
        var_dump(($_POST['dataz']));
    }
    else
    {
        echo "No data.";
    }
    ?> 
```

这是我试图解码的 JSON

```
...
<form action="proses.php" method="POST">
  <input type="submit" value="Save">
  <input type="hidden" name="dataz" value="">
</form>
<script>
  $(function() {
    $("form").submit(
      function() {
        $("input[name='dataz']").val($.JSON.encode(data));
      }
    );
  });
</script> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T20:43:12.387

好的，这是我从 SlickGrid 插入、更新、删除到 MySQL 的代码

```
 var ajaxFileURL = "fileAjax.php?action=list";   

function populateList(ajaxFileURL) {    
    var msgDelete = 'Do you really want to delete the row?';
    var deleteIcon = "<img src='/images/delete.png' border='0' />";

    // attach the delete event on the ID column
    var columns = [     
        {id:"id", name:"ID", field:"id", width:8, formatter: function (r,c,id,def,datactx){ return "<a href='#' onclick='if (confirm(\""+msgDelete+"\")) removeClick(\""+ajaxFile+"\",\""+id+"\","+r+")'>"+deleteIcon+"</a>";}},
        {id: "title", name: "Title", field: "title", width: 70, minWidth: 50, cssClass: "cell-title", sortable: true, editor: Slick.Editors.Text}
    ];
    var options = {
        enableCellNavigation: true,
        editable: true
    };

    $.getJSON(ajaxFileURL, function (ServerResponse) {
        var groupItemMetadataProvider = new Slick.Data.GroupItemMetadataProvider();
        dataView = new Slick.Data.DataView({
            groupItemMetadataProvider: groupItemMetadataProvider,
            inlineFilters: true
        });
        grid = new Slick.Grid("#myGrid", dataView, columns, options);

        // This section treats the INSERT/UPDATE
        grid.onCellChange.subscribe(function(e,args) {
            //dataView.updateItem(args.item.id,args.item);
            if (typeof(args.item.id)=='undefined')
                $.post(ajaxFileURL+"?action=insert", args.item);
            else{
                $.post(ajaxFileURL+"?action=update", args.item, function(ServerResponseUpt){
                    // if database return an error then display it to the user and undo the cell change
                    if(parseInt(ServerResponseUpt.affected_rows) < 1 || ServerResponseUpt.error_msg != "") {
                        alert("UPDATE ERROR: "+ServerResponseUpt.error_msg);
                        args.item[ previousCellNames[0] ] = previousCellValues[0];
                        grid.updateRow(args.row);
                        grid.updateRowCount();
                        grid.render();
                    }
                    previousCellNames = new Array();
                    previousCellValues = new Array();
                }, "json");

                // refresh the data on grid
                grid.updateRow(args.row);
                grid.updateRowCount();
                grid.render();
            }
        }); 
        // initialize the model after all the events have been hooked up
        dataView.beginUpdate();
        dataView.setItems(ServerResponse.data);
        dataView.endUpdate();
    } // end of $.getJSON()
} // end of populateList()

// outside function to DELETE
function removeClick(ajaxFileURL, dbRowId, gridRow) {
    $.post( ajaxFileURL+'?action=delete', {id:dbRowId} );
    var item = dataView.getItem(gridRow);//RowNum is the number of the row
    var rowID = item.id
    dataView.deleteItem(rowID);//RowID is the actual ID of the grid row and not the DB row 
    grid.invalidate();
    grid.render();
} 
```

我猜你已经知道如何处理 PHP Ajax 文件来加载数据，所以只需修改同一个文件来处理 INSERT/DELETE/UPDATE 和 List... 我所有的操作函数都返回 JSON，包括我的网格数据. 快速浏览一下我的 AJAX PHP 文件将是：

```
 <?php
switch($_GET['action']) {
    case 'delete':  deleteItem($_POST['id']);
                    break;
    case 'list':    populateList();
                    break;
    case 'update':  updateData();
                    break;
    default:        break;
}

/** Delete an item from the list/DB
 * @param int $id: id number of the item
 */
function deleteItem($id) {
    try{
        // Make the MySQL connection and save it into a global variable
        $mysql = new mysqlDB();
        $mysql->connect();

        // Pull the computer name of the Combo Computer (if exist)
        $sqlDel = sprintf("DELETE FROM table WHERE id='%s'", $id);
        $resultDel = $mysql->query($sqlDel);

        // close the MySQL connection
        $mysql->disconnect();

        print '{ "affected_rows" : '.$resultDel.', "error_msg" : "" }';
    }catch(Error $e){
        print '{ "affected_rows" : 0, "error_msg" : "'.$e->getErrorString().'" }';
    }
}

/** Populate the list with data */
function populateList() {
    try{
        // Make the MySQL connection and save it into a global variable
        $mysql = new productionDB();
        $mysql->connect();
        $mysqli = $mysql->getMysqliObj();
        $mysqli->set_charset("utf8");

        $sqlTable = "SELECT id, title FROM table";
        $result = $mysql->query($sqlTable);

        while( $row = $result->fetch_object() ) {
            $tabData[] = array( "id" => $row->id,
                                "title" => $row->title
                            );
            $nbRows = $result->num_rows; // how many rows does the table have in total?
        }

        // close the MySQL connection
        $mysql->disconnect();

        // Fill the JSON String with the BOM Header info
        $jsonStr .= '{"data":'.json_encode($tabData).',"info" : { "rows" : "'.$nbRows.'"}}';

        print $jsonStr;
    }catch(Error $e){
        print '{ "affected_rows" : 0, "error_msg" : "'.$e->getErrorString().'" }';
    }
}

/** Update some data on the DB */
function updateData() {
    try{
        // Make the MySQL connection and save it into a global variable
        $mysql = new productionDB();
        $mysql->connect();
        $mysqli = $mysql->getMysqliObj();
        $mysqli->set_charset("utf8");

        $groups = '';
        $groupSet = $_POST['defect_group'];
        if( isset($groupSet) ) {
            if( is_array($groupSet) ) {
                foreach($groupSet AS $group) {
                    $groups .= $group.",";
                }
                $groups = substr($groups, 0, -1); // remove last unused comma ","
            }
            else {
                $groups = $groupSet;
            }
        }

        // then make the UPDATE on the table
        $sqlUpdate = sprintf('UPDATE title="%s", WHERE id=%d',
                            $mysqli->real_escape_string($_POST['title'])
                            $_POST['id']
                            );
        $result = $mysql->query($sqlUpdate);

        // close the MySQL connection
        $mysql->disconnect();

        print '{ "affected_rows" : '.$result.', "error_msg" : "" }';
    }catch(Error $e){
        print '{ "affected_rows" : 0, "error_msg" : "'.$e->getErrorString().'" }';
    }
} 
```

这应该足以让你上路......享受:)

# jquery - 当属性名称类似于“attr：attr”时，使用 jquery 属性选择器选择元素

> ID：15519989
> 
> 赞同：1
> 
> 时间：2013-03-20T09:42:58.430
> 
> 标签：jquery, svg, inkscape

例如，我有一个 svg 路径 `<path`......`d="m 100.03365,51.648383 28.346,0 0,-28.346 -28.346,0 0,28.346" inkscape:label="figure_01"></path>` 我想要的只是使用属性选择器选择他，就像`$('path[inkscape:label*="figure"]')`它不起作用（据我所知，它不应该因为“：”被保留用于更棒的东西） . 有没有办法绕过这个而不编辑 svg 本身？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T09:44:36.207

尝试转义`:`符号？

```
$('path[inkscape\\:label*="figure"]') 
```

# bluetooth - 快速发现蓝牙设备

> ID：15519992
> 
> 赞同：0
> 
> 时间：2013-03-20T09:43:01.497
> 
> 标签：bluetooth

我想做的是：我有一个带有某些蓝牙设备（BD_ADDR）的数据库。我想知道是否有任何设备在范围内，如果是，告诉它做点什么。一种方法是始终运行发现，创建已发现设备的列表并将其与数据库进行比较。如果找到数据库中存在的设备，我会打开与它的连接并告诉它做某事。问题是这个过程很慢并且要可靠地找到所有设备，查询长度必须很大并且必须一直重复该过程。

我的想法是只发现我的蓝牙一次，将它与我的设备配对，然后从那时起，只要设备进入范围，就可以通过长时间的发现与它建立连接，而是以某种方式使用我已经为该设备拥有的信息.

换句话说，是否可以使用我已经知道的关于设备的信息（之前与它配对过或刚刚与它建立过连接）开始与它通信而无需先发现它？

谢谢你，donescamilloATgmail.com

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T13:57:46.100

您将什么库用于蓝牙以及您打算与哪种套接字进行通信？在大多数情况下，如果您知道设备的 BD_ADDR，您应该能够创建到设备的套接字连接。例如，在 BlueZ 中，您只需编写以下内容即可创建与通道 1 上已知服务器的 RFCOMM 连接：

```
struct sockaddr_rc addr = { 0 };
int s, status;

// destination address
char dest[18] = "00:17:EC:35:96:FF";

// allocate a socket
s = socket(AF_BLUETOOTH, SOCK_STREAM, BTPROTO_RFCOMM);

// set the connection parameters (who to connect to)
addr.rc_family = AF_BLUETOOTH;
addr.rc_channel = 1;
str2ba( dest, &addr.rc_bdaddr );

// connect to server
status = connect(s, (struct sockaddr *)&addr, sizeof(addr)); 
```

希望这可以帮助。

# javascript - Github 的 markdown API 和 Javascript

> ID：15519997
> 
> 赞同：1
> 
> 时间：2013-03-20T09:43:10.560
> 
> 标签：javascript, jquery, github, markdown

我正在尝试向[Github 的 markdown API](http://developer.github.com/v3/markdown/)发送一些文本并取回它的原始 HTML 表示。

目前我有这个代码：

```
 $.ajax({
        type: "POST",
        dataType: "jsonp",
        processData: false,
        url: "http://api.github.com/markdown/raw",
        data: {
            "text": $('#some_textarea').val()
        },
        success: function(data){
            console.log("success!");
            console.log(data);
        }, 
        error: function(jqXHR, textStatus, error){
            console.log(jqXHR, textStatus, error);
        }
    }); 
```

但我得到“错误”（`error`回调中的文本状态）。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-20T10:15:39.917

您需要发布到 HTTPS 而不是 HTTP，如果您使用的是原始 API，那么

*   发布的内容类型需要是 text/plain
*   API 返回 html 内容，而不是 JSON 或 JSONP

例如[jsfiddle](http://jsfiddle.net/rupw/9rKKh/)

```
$.ajax({
    type: "POST",
    dataType: "html",
    processData: false,
    url: "https://api.github.com/markdown/raw",
    data: "Hello world github/linguist#1 **cool**, and #1!",
    contentType: "text/plain",
    success: function(data){
        console.log("success!");
        console.log(data);
    }, 
    error: function(jqXHR, textStatus, error){
        console.log(jqXHR, textStatus, error);
    }
}); 
```