# StackOverflow 问答 12610000-12610999

# c# - 为什么 FSharpList 没有 GetEnumerator 方法？

> ID：12610001
> 
> 赞同：1
> 
> 时间：2012-09-26T20:38:34.757
> 
> 标签：c#, f#

我正在尝试在 C# 中使用 FSharpList 来实现。它说它实现了`IEnumerable`接口，但是当我创建它的实例时，它没有任何`GetEnumerator`功能！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T20:46:35.307

确实如此，但您需要将其转换为 IEnumerable 或在 foreach 中使用它。它是明确定义的，因此不会出现在智能感知中，除非声明的类型是 IEnumerable

**编辑** 从评论中我意识到上面的内容可能与预期不同。

接口方法的显式实现基本上是消歧机制的一部分。如果一个类型使用一个或多个具有相同签名（忽略返回类型）的方法实现两个接口，您需要能够区分它们。

第一部分是明确地实现其中一个或两个。对于这将类似于下面的`IEnumerable`代码`IEnumerable<T>`

```
object IEnumerable.GetEnumerator(){...}
T IEnumerable<T>.GetEnumerator(){...} 
```

消歧的第二部分是在呼叫现场。即使这两种方法都是对象的运行时类型的一部分，您也不能使用常规调用语法来调用它。您需要告诉编译器定义该方法的编译时类型，否则编译器将不知道要调用哪个方法。

因此，要调用上述两种方法，您需要如下代码

```
((IEnumerable)obj).GetEnumerator();
((IEnumerable<T>)obj).GetEnumerator(); 
```

或者您可以将其留给语言构造为您转换（在这种情况下，语言规范会告诉您将调用哪个版本

```
foreach(var item in obj) {
} 
```

因此，即使这些方法实际上是对象类型的一部分，您也需要在编译时帮助编译器并告诉编译器哪个类型定义了您希望调用的特定方法。

当然可以毫无歧义地使用显式实现。

# java - （作业）骰子程序，找不到符号

> ID：12610008
> 
> 赞同：2
> 
> 时间：2012-09-26T20:38:56.913
> 
> 标签：java

我是 java 新手，我的 dice 程序又遇到了另一个错误。

在这个程序中，我有三个方法，roll() 来掷骰子并返回一个介于 1 和用户指定的数字之间的值，getFaceValue()，以 int 形式返回掷骰子的值，以及 toString()，将骰子作为字符串返回。

我之前关于我的程序的问题的答案使我能够使程序正常工作，但它的结构不像教授想要的那样，所以我不得不重新设计它。我现在知道我的方法/变量都不能是静态的，我只能在程序的主要部分接受用户输入。

当我尝试编译时，出现以下错误：

```
Die.java:12: error: cannot find symbol
double y = (x * sides) + 1;

symbol: variable sides
location: class Die 
```

我的代码如下：

```
import java.io.*;
import java.util.*;

public class Die {
    //private int sides;
    private int z;
    private String faceName;

    //sets (and returns) the face value to a uniform random number between 1 and the number of faces.
    public int roll() {
        double x = Math.random();
        double y = (x * sides) + 1;
        z = (int)y;
        return z;
    }

    //returns the current face value of the die.
    public int getFaceValue() {
        int face = z;
        return face;
    }

    //returns the string representation of the face value.
    public String toString() {
        faceName = Integer.toString(z);
        return faceName;
    }

    public static void main(String [] args) {
        int sides;
        System.out.println("How many sides will the die have?");
        Scanner keyboard = new Scanner(System.in);
        sides = keyboard.nextInt();

        System.out.println(" ");
        Die die = new Die();
        System.out.println("Roll: " + die.roll());
        System.out.println("Face: " + die.getFaceValue());
        System.out.println("String: " + die.toString());
    }
} 
```

最初，我将变量边作为私有 int（您可以在我的程序中看到它被注释掉），但这会产生静态引用错误。

感谢您提供的任何帮助。

上一个问题是：[骰子程序中的方法返回0](https://stackoverflow.com/questions/12594572/methods-in-dice-program-return-0)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T20:43:24.417

您可以创建一个实例变量`sides`并通过构造函数将其传递给模具。这将要求您取消注释您的`private int sides`变量。

示例模具构造函数：

```
public Die(int sides) {
    this.sides = sides;
} 
```

使用这样的构造函数，您可以使用读取的面数作为输入来实例化您的 Die。

```
sides = keyboard.nextInt();
Die die = new Die(sides); 
```

现在，您的 die`sides`字段设置为用户输入的任何内容，并且 die 的方法相应地使用该值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:40:21.627

你还没有`sides`在范围内定义`public int roll() {`

在 main 内部创建一个变量会将其范围缩小到仅在 main 内部 - 除非您将其作为变量（将按值传递）传递或使其成为类变量（字段），否则您无法访问外部变量。

作为一个骰子，你想让它成为实际类的一个字段。所以在类的顶部定义边：

```
public class Die {
  int sides; 
```

并在您的构造函数中分配它：

```
public Die(int s) {
  sides = s;
} 
```

然后当你调用时`roll`，你的边变量将可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T20:40:41.860

你的变量边是未定义的，如果像这样按值传递，你可以通过

```
public int roll(int sides) {
    .....
    double y = (x * sides) + 1;
    .....
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T20:40:51.080

将**边**作为参数传递给 roll 方法。

```
import java.io.*;
import java.util.*;

public class Die {
//private int sides;  
private int z;
private String faceName;

//sets (and returns) the face value to a uniform random number between 1 and the number of faces.
public int roll(int sides) {
    double x = Math.random();
    double y = (x * sides) + 1;
    z = (int)y;
    return z;
}

public static void main(String [] args) {
        int sides;
        System.out.println("How many sides will the die have?");
        Scanner keyboard = new Scanner(System.in);
        sides = keyboard.nextInt();

        System.out.println(" ");
        Die die = new Die();
        System.out.println("Roll: " + die.roll(sides)); // pass it as an argument to roll
        System.out.println("Face: " + die.getFaceValue());
        System.out.println("String: " + die.toString());
    }

    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T20:43:45.553

您遇到的问题是`sides`该方法的本地问题`main()`，并且不会以任何方式传递给该`roll()`方法。当编译器正在编译`roll()`时，它看到`double y = (x * sides) + 1;`并且不知道`sides`指的是什么 - 因此是错误。

有两种方法可以完成此操作，但您应该找到一种方法将您从用户那里收集的输入传递`main()`给您的`Die`班级。一种方法是在 Die 类的构造函数中：

```
public static void main(String [] args) {
    int sides = keyboard.nextInt();
    ...
    Die die = new Die(sides); 
```

然后，您将`Die`类更改为具有接受 an并在名为的*成员字段*`int`中跟踪它的构造函数（尽管方法和类中的变量名称实际上不需要相同，这只是为了方便） .*`sides``main()``Die`*

 *```
public class Die {
    private int sides;

    public Die(int sides) {
        this.sides = sides;
    }

    public int roll() {
        ...
        double y = (x * this.sides) + 1; 
```*

# javascript - Backbone.js 非休息（用户）模型

> ID：12610020
> 
> 赞同：0
> 
> 时间：2012-09-26T20:39:32.013
> 
> 标签：javascript, backbone.js

我有以下用户模型：

```
var UserModel = Backbone.Model.extend({
  urlRoot: 'user',
  defaults: {
    fullName: null,
    email: null,
    password: null
  }
}); 
```

现在我们可以 CRUD（注册、更新信息、删除和获取用户），但是：

*   忘记密码
*   激活账户

我将如何扩展我的 UserModel 以使其成为可能？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T21:23:51.543

我自己得到了答案。因此，我再次需要非粗略操作，例如：

*   POST /users/restore-password
*   发布/用户/激活

解决方案：

```
function nonCrudOperation(urlSegment, requestMethod){
  return Backbone.sync.call(this, null, this, _.extend({
    url: this.url() + '/' + urlSegment,
    type: requestMethod
  }, options));
};

var UsersModel = Backbone.Model.extend({
  urlRoot: 'user',
  activate: function(options){
    return nonCrudOperation.call(this, 'activate', 'POST');
  },
  restorePassword: function(options){
    return nonCrudOperation.call(this, 'restore-password', 'POST');
  }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T20:42:38.240

将登录作为其端点的会话模型分离出来并使用它来完成登录事务可能更有意义。这些方面的东西：

```
var UserSessionModel = Backbone.Model.extend({
  urlRoot: 'users/login',
  defaults: {
    email: null,
    password: null
  }
}); 
```

成功登录后，您可以将会话换成实际用户：

```
var session = new UserSessionModel({ username: 'foo', password: 'bar' }),
    user;

session.save({ 
  success: function (attrs) {
    user = new UserModel(attrs);
  }
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:36:40.907

制作自己的方法来补充内置方法`fetch`并`save`进行常规`$.ajax`调用并没有错。引入您自己的方法是非常好的`reset`，`activate`例如，`$.post`对专用服务器 URI 执行常规操作以重置密码并相应地更新用户实例。

# drop-down-menu - Twitter Bootstrap 菜单不响应触摸

> ID：12610022
> 
> 赞同：1
> 
> 时间：2012-09-26T20:39:35.670
> 
> 标签：drop-down-menu, twitter-bootstrap

我有一个使用 Bootstrap 的下拉菜单功能的简单（几乎直接来自文档）下拉菜单。

```
<div class="btn-group">
  <a class="btn dropdown-toggle" data-toggle="dropdown" href="#">Menu<span class="caret"></span></a>
  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
    <li><a href="http://www.google.com">Tickets</a></li>
    <li><a href="http://www.google.com">Gift Shop</a></li>
    <li><a href="http://www.google.com">Event Info</a></li>
  </ul>
</div> 
```

我正在加载脚本：

```
<script src="/assets/js/vendor/modernizr-2.6.2.min.js"></script>
<script type="text/javascript" src="http://code.jquery.com/jquery-latest.min.js"></script>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8/jquery-ui.min.js"></script>
<script type="text/javascript" src="/assets/js/jquery.handlers.js"></script>
<script type="text/javascript" src="/assets/js/jquery.validate.min.js"></script>
<script type="text/javascript" src="/assets/js/bootstrap.js"></script>
<script type="text/javascript" src="/assets/js/home-animations.js"></script> 
```

如果我缩放浏览器（Chrome），菜单会打开并运行。在设备（主要用于测试的 iPhone 4S）上，菜单打开但在触摸时立即关闭。我尝试将菜单放在页面上的不同位置，所以这不是 zindex 问题。我刚刚获得了包含所有插件的最新版本的 Bootstrap，包括 bootstrap.dropdown。

知道为什么会立即关闭吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-08T21:44:04.980

这是一个错误，它将在 2.2.2 中修复。在这里找到了一个临时解决方案：

[http://alittlecode.com/fix-twitter-bootstraps-dropdown-menus-in-touch-screens/](http://alittlecode.com/fix-twitter-bootstraps-dropdown-menus-in-touch-screens/)

# c# - MySqlconnection 不包含 Connection、CommandText、Prepare 或 ExecuteNonquery 的定义

> ID：12610026
> 
> 赞同：0
> 
> 时间：2012-09-26T20:39:49.630
> 
> 标签：c#, mysql

我正在使用[http://zetcode.com/db/mysqlcsharptutorial/](http://zetcode.com/db/mysqlcsharptutorial/)上的教程，我相信我已经完全按照这些步骤进行操作，但是我遇到了这些错误。我已将 MySql.Data、MySql.Data.Entity 添加到引用中，但它仍然不允许我使用它。我已经用谷歌搜索了这个问题，似乎无法得到明确的答案。

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using MySql.Data.MySqlClient;
using System.Data;
using MySql.Data.Entity;
using MySql.Data.Common;
using MySql.Data.Types;
using System.Configuration;
using System.Data.Common;

namespace Practice
{
    public class Example
    {
        public static void Main()
        {
            string cs = @"server=111.111.11.111; userid=11111111;password=111111;database=anydatabase";

            MySqlConnection conn = null;

            try
            {
                conn = new MySqlConnection(cs);
                conn.Open();

                MySqlConnection cmd = new MySqlConnection();
                cmd.Connection = conn;
                cmd.CommandText = "INSERT INT0 players(Anyone) VALUES(@Anyone)";
                cmd.Prepare();

                cmd.Parameters.AddWithValue("@Name", "Anyone New");
                cmd.ExecuteNonQuery();

            }
            catch (MySqlException ex)
            {
                Console.WriteLine("Error: (0)", ex.ToString());
            }
            finally
            {
                if (conn != null)
                {
                    conn.Close();
                }
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T20:42:46.463

你正在寻找`MySqlCommand`.

```
var cmd = new MySqlCommand(); 
```

# compiler-construction - 英特尔 Visual Fortran 编译器名称修改，我的编译器是不是疯了？

> ID：12610035
> 
> 赞同：0
> 
> 时间：2012-09-26T20:40:09.537
> 
> 标签：compiler-construction, fortran, linker-errors, name-mangling

我正在使用 Intel Visual Fortran Composer XE 2011 在 MS Visual Studio 2008 中构建我的 Fortran 项目。我收到链接器错误：LNK2019 未解析的外部符号。

我在我的 obj 文件上做了一个垃圾箱，我所有的符号（在 CVF 调用约定下）都导出为 _symbol1、_symbol2、_symbol3 等等，除了三个随机的带有一些前缀的符号。

例如：_ *imp* _symbol4、_ *imp* _symbol5、_ *imp* _symbol6

起初我怀疑我的调用约定一定是问题，但如果这是我的调用约定，难道不是所有其他符号都以 imp 为前缀导出了吗？它是如此随机，以至于其中三个奇怪地导出，我不太明白发生了什么。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:41:11.387

对应于这些符号的实体可能具有 DLLIMPORT 属性。链接步骤可能缺少相关的导入库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-29T19:36:25.387

我发现问题是因为当我真的不需要这些符号时，我有一些 DLL 导出语句。它使编译器期望 _ *imp* _sybmol 因为我使用以下语句导出它们：

```
 !DEC$ATTRIBUTES STDCALL:: YOURSYMBOL
!DEC$ATTRIBUTES DLLEXPORT:: YOURSYMBOL 
```

我刚刚删除了它们，链接器错误就消失了。

# cordova - phonegap 音频不会停止

> ID：12610038
> 
> 赞同：0
> 
> 时间：2012-09-26T20:40:16.180
> 
> 标签：cordova, audio-streaming

我正在使用 Phonegap 为网络收音机创建播放器。

播放流效果很好，但我无法停止流。当我点击停止按钮时，我在日志中有此消息：

> AudioPlayer 错误：在无效状态期间调用 stopPlaying()：4

在屏幕上我有一个“未定义”的错误。似乎我的变量`my_media`没有定义。

这是我的代码：

```
var src="http://stream.muzeeli.fr/ange";

var my_media = null;

function playAudio(src) {
    if (my_media == null) {                             
        my_media = new Media(src, onSuccess, onError);
    } 
    my_media.play();
}

function stopAudio() {
    if (my_media) {
        my_media.stop();
    }
}

$(document).bind('pageinit',function(){
document.addEventListener("deviceready", onDeviceReady, false);

function onDeviceReady() {  
        $('#play').click(function(event){
            playAudio(src);
        });

        $('#stop').click(function(event){
            stopAudio();
        });
    }
}); 
```

我添加了一个日志文件。似乎媒体的状态没有很好地更新，并且始终处于 MEDIA_NONE 状态。所以 stop 不能被调用。

```
E/MediaPlayer(23457): mOnSeekCompleteListener is null. Failed to send MEDIA_SEEK_COMPLETE message.
V/MediaPlayer(23457): buffering 0
V/MediaPlayer(23457): callback application
V/MediaPlayer(23457): back from callback
V/MediaPlayer(23457): message received msg=200, ext1=703, ext2=193
W/MediaPlayer(23457): info/warning (703, 193)
V/MediaPlayer(23457): callback application
V/MediaPlayer(23457): message received msg=200, ext1=701, ext2=0
W/MediaPlayer(23457): info/warning (701, 0)
V/MediaPlayer(23457): callback application
V/MediaPlayer(23457): back from callback
E/MediaPlayer(23457): mOnBufferingUpdateListener is null. Failed to send    MEDIA_BUFFERING_UPDATE message.
I/MediaPlayer(23457): Info (703,193)
E/MediaPlayer(23457): mOnInfoListener is null. Failed to send MEDIA_INFO message.
I/MediaPlayer(23457): Info (701,0)
E/MediaPlayer(23457): mOnInfoListener is null. Failed to send MEDIA_INFO message.
V/MediaPlayer(23457): message received msg=100, ext1=1, ext2=-110
E/MediaPlayer(23457): error (1, -110)
V/MediaPlayer(23457): callback application
V/MediaPlayer(23457): back from callback
E/MediaPlayer(23457): Error (1,-110)
E/MediaPlayer(23457): mOnErrorListener is null. Failed to send MEDIA_ERROR message.
D/AudioPlayer(23457): on completion is calling stopped
D/CordovaLog(23457): playAudio():Audio Success
D/CordovaLog(23457): file:///android_asset/www/js/muzeeli.js: Line 40 : playAudio():Audio Success
I/Web Console(23457): playAudio():Audio Success at file:///android_asset/www/js/muzeeli.js:40 
```

有人有想法吗？

最好的，

阿兰

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T08:32:31.793

我面临同样的问题

01-16 17:29:51.404：E/MediaPlayer(9903)：mOnBufferingUpdateListener 为空。发送 MEDIA_BUFFERING_UPDATE 消息失败。

我尝试@hyunkeln 的代码，我可以解决它！谢谢你@hyunkeln

重点是 。将代码“释放”放在“停止”之后。

my_media.stop(); my_media.release();

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-26T20:53:16.970

您需要在 stop() 之前调用 release() 并检查 my_media 是否仍然设置和播放；也许你想这样做：

```
if (my_media != null && my_media.isPlaying()){
    my_media.stop();
    my_media.release();
} 
```

# c# - 列表框更新，重点放在列表框中的最后一行

> ID：12610053
> 
> 赞同：1
> 
> 时间：2012-09-26T20:40:56.507
> 
> 标签：c#, winforms

在我的应用程序中，我将所有新项目添加到列表框中，速度非常快，我希望列表框一直显示最后一个项目，我的意思是列表框中的焦点将在最后一个一直在排队，怎么办？

在这个函数中，我更新了我的列表框：

```
private void bgWSniffer_ProgressChanged(object sender, ProgressChangedEventArgs e)
{
    tshark = e.UserState as Tshark;
    listBoxPacketsSnifferTab.Items.Add(tshark._packet);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T20:42:49.643

将项目添加到列表框后，添加以下行：

```
listBoxPacketsSnifferTab.SelectedIndex = listBoxPacketsSnifferTab.Items.Count - 1; 
```

它将使选定的项目成为最后一个。请记住，索引是从零开始的。

在这里阅读更多：

[http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.selectedindex.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.listbox.selectedindex.aspx)

# java - 我正在使用 daikon Chicory 进行不变检测，但遇到 java.lang.VerifyError

> ID：12610056
> 
> 赞同：4
> 
> 时间：2012-09-26T20:41:39.913
> 
> 标签：java, detect, invariants

我正在学习如何使用 daikon.Chicory 做一些不变的检测。但是在 java-examples 部分，我在这个命令之后遇到了这个错误

```
java daikon.Chicory --daikon DataStructures.StackArTester 
```

我在 Windows 7 上使用 cygwin shell。

```
-ea -Xmx128M -javaagent:C:\cygwin\home\Will\daikonparent\daikon\java\ChicoryPremain.jar=--daikon --dtrace-file=StackArTester.dtrace.gz DataStructures.StackArTester
entered daikon.chicory.Runtime.setDtrace(.\StackArTester.dtrace.gz, false)...
java.lang.VerifyError: StackMapTable error: bad offset in method DataStructures.StackArTester.push(I)V
        at java.lang.Class.getDeclaredMethods0(Native Method)
        at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
        at java.lang.Class.getMethod0(Class.java:2685)
        at java.lang.Class.getMethod(Class.java:1620)
        at sun.launcher.LauncherHelper.getMainMethod(LauncherHelper.java:492)
        at sun.launcher.LauncherHelper.checkAndLoadMain(LauncherHelper.java:484)
Chicory warning: no records were printed
Exception in thread "main" Warning: Did not run Daikon because target exited with 1 status 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T21:13:02.220

如评论中所述，它需要生成/编译针对特定版本的 Java 或 JVM，版本 5 的 .class 文件

这就是我为使其工作所做的工作：

```
javac -g -source 5 -target 5 DataStructures/*.java
java daikon.Chicory --daikon DataStructures.StackArTester 
```

祝测试愉快！

# android - Android - 后退按钮和片段后台堆栈不起作用

> ID：12610063
> 
> 赞同：6
> 
> 时间：2012-09-26T20:42:18.147
> 
> 标签：android, android-fragments, fragment-backstack

我正在开发一个带有单个 FragmentActivity 的简单的基于片段的应用程序。应用程序的每个“屏幕”都包含在一个片段中，所有片段都在应用程序启动时添加到容器布局中。

```
// Set up fragments in Main Activity
fragMan = getFragmentManager();
FragmentTransaction ft = fragMan.beginTransaction();
ft.add(R.id.fragment_container, settingsFragment);
ft.add(R.id.fragment_container, mapFragment);
ft.add(R.id.fragment_container, tracksFragment);
ft.add(R.id.fragment_container, waypointsFragment);
ft.commit(); 
```

转换是通过隐藏当前可见的片段，然后显示适当的片段来完成的。

```
ft = fragMan.beginTransaction();
ft.show(mapFragment);
ft.addToBackStack(null);
ft.commit(); 
```

这一切都很好，但是当按下后退按钮时，应用程序退出，无论哪个屏幕可见或之前的哪些事务已添加到后退堆栈。

我已经检查以确保后台堆栈正确累积记录并尝试了许多不同的转换方法变体，例如替换片段而不是隐藏/显示它们，创建片段的新实例而不是将它们存储在变量中等。据我所知，我的代码与我能找到的所有教程和示例相匹配，我什至无法找到任何类似的问题/类似问题的示例，大概是因为标准实现对其他人“有效”。

我怀疑这可能是应用程序级别的问题，例如我的清单中的一个属性（我已经对此进行了非常彻底的调查）或者我的应用程序设置方式固有的问题，它阻止了后退按钮正常工作。我可以重写 onBackPressed 来手动处理转换，但这似乎是一个非常难看的解决方法。关于为什么这可能没有按预期运行的任何想法？顺便说一句，这是在运行 Jelly Bean 的 Nexus 7 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-17T06:58:35.547

检查您是否使用 FragmentActivity（来自支持库）而不是 Activity。这将导致回栈和转换问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-02T13:47:00.633

我不确定这是否会解决您的问题，但我认为您不需要添加所有片段。

我还注意到（至少在兼容性库中）替换方法似乎有很多错误，所以最好先删除现有片段，然后添加新片段。

这是我用来更改片段的代码：

```
/**
 * Changes the detail fragment of this activity. This is how all content is presented in this app.
 * @param fragment
 * @param animated
 * @param addCurrentFragmentToBackStack
 */
private void changeDetailFragment(Fragment fragment,boolean animated,boolean addCurrentFragmentToBackStack)
{
    FragmentTransaction transaction = getSupportFragmentManager().beginTransaction();

        if (animated)
            transaction.setCustomAnimations(android.R.anim.fade_in, android.R.anim.fade_out);

    Fragment currentFrag =  getSupportFragmentManager().findFragmentById(R.id.detailFragment);

    String fragName = "NONE";

    if (currentFrag!=null)
        fragName = currentFrag.getClass().getSimpleName();

    if (currentFrag != null)
    {

        transaction.remove(currentFrag);
    }

    transaction.add(R.id.detailFragment,fragment);

    if (addCurrentFragmentToBackStack)
    {
        Log.i("APP_NAME","Adding: " + fragName + " to the backstack");
        transaction.addToBackStack(null);
    }
    else
    {
        Log.i("APP_NAME","Not adding: " + fragName + " to the backstack");
    }

    transaction.commit();

} 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-08-18T09:19:44.973

对我来说，将 appcompat 的版本更改为 27.1.1（截至 2018 年 8 月 15 日）有效。原来 appcompat 版本 v7:28.0.0-rc01 是罪魁祸首。

# php - 制造商的元标记和描述 (opencart)

> ID：12610065
> 
> 赞同：0
> 
> 时间：2012-09-26T20:42:28.630
> 
> 标签：php, e-commerce, meta-tags, opencart

我正在使用 OpenCcart 1.5.3 我需要一些关于如何为制造商添加描述和元标记（关键字和描述）的指导？

我找不到任何线索如何做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:34:48.047

我个人之前没有使用过 OpenCart，但如果它是开源的，就像它所说的那样，只需要熟悉应用程序代码即可。

同时你可以使用它，它不是免费的:( [http://www.opencart.com/index.php?route=extension/extension/info&extension_id=654&filter_search=%20manufacturer%20meta%20keyword](http://www.opencart.com/index.php?route=extension/extension/info&extension_id=654&filter_search=%20manufacturer%20meta%20keyword)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-28T20:28:19.843

我在[http://forum.opencart.com/viewtopic.php?t=38924](http://forum.opencart.com/viewtopic.php?t=38924)找到了一些解决方案 希望，它可以提供帮助

# mysql - 如何识别同一行内 3 个不同列中的重复数据并删除第二组重复数据？

> ID：12610069
> 
> 赞同：0
> 
> 时间：2012-09-26T20:42:45.067
> 
> 标签：mysql, regex, database

我有一个看起来像这样的数据集：

```
ID | ItemName  | Category1 | Category2 | Category3
1  |  HALv1    | Computer  | Computer  | AI
2  |  HALv2    | Computer  | AI        | AI
3  |  HALv3    | AI        | AI        | AI 
```

理想情况下，我需要它看起来像这样：

```
ID | ItemName  | Category1 | Category2 | Category3
1  |  HALv1    | Computer  | AI        | 
2  |  HALv2    | Computer  | AI        | 
3  |  HALv3    | AI        |           | 
```

更具体地说，我需要一些东西（SQL 或正则表达式）来评估一行数据中的 3 列（如上面示例中的 Category1、2、3）并返回在 3 个指定列中没有重复值的行。

数据当前位于 .csv 文件中，但如果需要，可以轻松放入 mySQL 数据库。

可用的工具是用于执行正则表达式的 TextPad 或带有 PHPMyAdmin 3.3.9 的 MySQL 5.5.8（如果解决方案是基于 SQL 的）。预先感谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:48:33.597

这将清理像 #1 这样的行：

```
UPDATE my_table
SET category2 = category3,
    category3 = NULL
WHERE category1 = category2 
```

第 2 行：

```
UPDATE my_table
SET category3 = NULL
where category2 = category3; 
```

和第 3 行：

```
UPDATE my_table
SET category3 = NULL,
    category2 = NULL
WHERE category1 = category2
AND category2 = category3; 
```

先处理更新category3，再更新category2的所有case。

# r - 子集时保留 R 对象的类属性

> ID：12610072
> 
> 赞同：8
> 
> 时间：2012-09-26T20:42:49.207
> 
> 标签：r

我有一个名为gene_table 的R 对象，它有class `foo`。现在我将这个gene_table子集

`gene_data = gene_table[1:100,1:5]`

但是，当我调用时`class(gene_data)`，它不再属于 class `foo`，而是具有 class `matrix`。这让我很头疼，因为我的方法`summary.foo`无法识别类矩阵的这个对象gene_data。我希望在子集时保留原始类属性，所以有人能告诉我该怎么做吗？谢谢！

更新：`dput(head(gene_table))`给我

```
c(5.21708054951994, 5.01224214039806, 4.92160314073853, 4.83031021496, 4.78552614584879, 4.77821370665578) 
```

并`str(gene_table)`给我

```
 foo [1:22743, 1:2] 5.22 5.01 4.92 4.83 4.79 ...
 - attr(*, "dimnames")=List of 2
  ..$ : chr [1:22743] "ENSG00000127954" "ENSG00000151503" "ENSG00000096060" "ENSG00000091879" ...
  ..$ : chr [1:2] "Var1" "Var2" 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T21:19:34.433

你可以使用这样的东西作为你的定义`[.foo`：

```
`[.foo` <- function(x, ..., drop=TRUE) {
   structure(NextMethod(), class="foo")
} 
```

您可能需要添加其他内容，具体取决于您的`"foo"`课程的复杂性。

# php - 按类别分类的 Wordpress 组帖子

> ID：12610076
> 
> 赞同：0
> 
> 时间：2012-09-26T20:42:52.780
> 
> 标签：php, wordpress

有人可以帮助我使用下面的代码。它工作正常，但我只是不想为每个类别编写一段代码。所以基本上，我想让父类别显示一次，以便在子类别中列出它们下面的所有帖子。

我知道我需要一个 for 循环，但不确定它是如何编写的。

```
<h4>2012</h4>
    <ul class="news-coverage">
     <?php $cat_id = get_cat_ID('2012-media');
    $args=array(
      'cat' => $cat_id,
      'post_type' => 'press',
      'post_status' => 'publish',
      'posts_per_page' => 100,
      'caller_get_posts'=> 1,
      'exclude' => 28,
      'offset' => 9

    );
    $new = new WP_Query($args);
     $loop = new WP_Query( $args );
    while ( $loop->have_posts() ) : $loop->the_post();
    echo '<li><i class="foundicon-page"></i><strong>';
        the_title();echo '</strong><span>';
        the_date(); echo '</span>';
        the_content();
    echo '</li>';
    endwhile; ?>

    </ul>

    <h4>2011</h4>   
                  <hr>
    <ul class="news-coverage">
     <?php $cat_id = get_cat_ID('2011-media');
    $args=array(
      'cat' => $cat_id,
      'post_type' => 'press',
      'post_status' => 'publish',
      'posts_per_page' => -1,
      'caller_get_posts'=> 1,
      'exclude' => 28
    );
    $new = new WP_Query($args);
     $loop = new WP_Query( $args );
    while ( $loop->have_posts() ) : $loop->the_post();
    echo '<li><i class="foundicon-page"></i><strong>';
        the_title();echo '</strong><span>';
        the_date(); echo '</span>';
        the_content();
    echo '</li>';
    endwhile; ?>

    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:55:10.220

你去：（未测试）

```
<?php
/* add category prefixes here */
$years = array( '2011', '2012' );

$output = '';

/* iterate over categories */
foreach( $years as $year )
{
    /* add the heading */
    $output .= sprintf( '<h4>%s</h4>', $year );

    /* setup current query/loop */
    $args = array(
        'cat' => get_cat_ID( $year . '-media' ),
        'post_type' => 'press',
        'post_status' => 'publish',
        'posts_per_page' => 100,
        'caller_get_posts' => 1,
        'exclude' => 28,
        'offset' => 9
    );
    $loop = new WP_Query( $args );

    /* iterate over articles */
    $listItems = '';
    while( $loop->have_posts() )
    {
        $loop->the_post();
        $listItems .= sprintf( '<li><i class="foundicon-page"></i><strong>%s</strong><span>%s</span>%s</li>',
            get_the_title(),
            get_the_date(),
            get_the_content()
        );
    }

    $output .= sprintf( '<ul class="news-coverage">%s</ul>', $listItems );
}

echo $output;
?> 
```

# ios - 适用于 iOS 的 Facebook SDK 3.1 - 在 iOS6 上运行，但在 iOS 5.x 上崩溃

> ID：12610078
> 
> 赞同：24
> 
> 时间：2012-09-26T20:43:00.643
> 
> 标签：ios, facebook, ios5, sdk, ios6

我们刚刚将 iOS 版 Facebook SDK 更新到 3.1。Facebook SDK 3.0.8 没有在 iOS6 上运行，现在我们升级到 3.1，它在 iOS 6 上运行，但在 iOS 5.x 下崩溃。

因为 AdSupport.framework 应用程序在启动后立即在 iOS 5.x 上崩溃，并出现以下错误：

```
dyld: Library not loaded: /System/Library/Frameworks/AdSupport.framework/AdSupport

Referenced from: /Volumes/Macintosh HD/Users/dmitrybaranov/Library/Application Support/iPhone Simulator/5.0/Applications/D6A93996-1E58-48A5-A457-DBC4FCCEE0EB/app.app/app

Reason: image not found
(lldb) 
```

有人遇到过这个问题吗？Facebook方面是否存在问题，并且有人正在努力解决这个问题？

还是我们做错了什么？

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-09-26T22:27:43.080

您是否将框架设置为可选？当您添加 AdSupport.framework、Social.framework 和 Accounts.framework 时，右侧有一个下拉菜单，您可以在“必需”和“可选”之间进行选择。在此处查看图片示例： [链接](https://stackoverflow.com/questions/8385444/weak-linking-multiple-frameworks-for-iphone-apps-weak-framework)

要检查的另一件事是在您的项目的“构建设置”中，“基础 SDK”是 6.0，“iOS 部署目标”是 iOS 4.3。

我可以使用这些设置在我的 iOS 5.1 上构建 FB SDK 3.1。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-11T09:19:55.377

如果您的目标是低于 6.0 的 iOS 版本，则需要将**AdSupport.framework**、**Social.framework**和**Accounts.framework**设为可选链接。

请查看随附的屏幕截图。![在此处输入图像描述](../Images/82da5278de22f55cbfa80866d964b8a1.png)

干杯...！！！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-09-16T03:59:23.563

对于阅读本文并使用适用于 iOS 的 Facebook SDK 3.6+ 的任何人，您不再需要包含这些库或选择性地链接它们。请参阅[从 3.5 升级到 3.6 的 Facebook 文档：](https://developers.facebook.com/docs/ios/upgrading-from-3.5-to-3.6/)

“删除安装 Facebook SDK 时添加到应用程序中的框架依赖项。SDK 仍然依赖于它们，但现在会自动加载它们，从而使设置更简单。删除这些框架/库：

`Accounts.framework`

`AdSupport.framework`

`Security.framework`

`Social.framework`

`libsqlite3.dylib`[或删除 -lsqlite3.0 链接器标志]

[注意：如果您的应用程序直接使用这些框架/库中的任何 API，您的项目仍应明确包含该框架]"

# mule - How do I modify Mule payload variables?

> ID：12610080
> 
> 赞同：2
> 
> 时间：2012-09-26T20:43:09.940
> 
> 标签：mule

Using Mule 3.3, I've got a Payload (which starts out as a JSON and I'm converting it to an Object using java.util.HashMap). I can access the variables just fine from a JDBC query using:

```
#[message.payload.AddJob.variable1] 
```

How do I go about adding a new variable (say variable2), or modifying the value of an existing variable?

I've tried:

```
<message-properties-transformer doc:name="Message Properties">
    <add-message-property key="message.payload.AddJob.variable2" value="&quot;hello&quot;"/>
</message-properties-transformer> 
```

Which had no effect.

I also tried a groovy Script (below) as suggested here: [How to add additional data to a mule payload?](https://stackoverflow.com/questions/9155062/how-to-add-additional-data-to-a-mule-payload), but it overwrites the entire payload with "hello", not just variable2.

```
payload['AddJob.variable2'] = 'hello' 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T02:55:01.803

What with:

```
<expression-transformer
            expression="#[message.payload.AddJob.variable2='hello';message.payload]" /> 
```

?

# gfortran - Fortran 模块链接失败

> ID：12610081
> 
> 赞同：-1
> 
> 时间：2012-09-26T20:43:12.187
> 
> 标签：gfortran, fortran95

我是 Fortran 的新手，所以也许这是一个简单的问题，但是通过查看 SO 上的类似帖子，我还没有找到任何可行的解决方案。

我的问题是，当我尝试在 testrft.f95 中编译我的主程序时，该程序使用 srft.f95 中定义的模块 srftModule 通过执行

1.  `gfortran -c dfft.f`
2.  `gfortran -c srft.f95`
3.  `gfortran -c testsrft.f95`
4.  `gfortran dfft.o srft.o testsrft.o -o testsrft`

（srftModule 中的子程序需要 dfft.f 中的 Fortran77 代码），我得到链接器错误

```
testsrftF.o: In function `MAIN__':
testsrftF.f95:(.text+0x98): undefined reference to `fftofmat_'
collect2: ld returned 1 exit status 
```

模块定义如下

```
module srftModule
   implicit none
   contains
   ... (some subroutines)

   subroutine fftofmat(A)
     implicit none
     real*8, dimension(:, :), intent(inout) :: A
     ...
   end subroutine fftofmat

   ... (some more subroutines)

end module srftModule 
```

在我的主文件中，我有

```
program testsrft
   use srftModule
   implicit none

   ...(code to initialize a 10x10 matrix A)
   call fftofmat(A)

 end program testsrft 
```

为什么链接器抱怨？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T00:30:07.010

一些背景：

*   MAIN__ 是 gfortran 用于主程序的符号。
*   通常，编译器会修改模块过程的符号名称以包含主机模块的名称。在 gfortran 的情况下，符号看起来像 __ *modulename* _MOD_ *procedurename*。

未定义引用错误中引用的符号与模块过程引用的符号模式不匹配。总之，这意味着在主程序中编译器不认为 fftofmat 是一个模块过程——这是你需要解决的问题。这与您显示的代码相反，所以我要寻找的东西......

*   您显示的代码是否真的是您正在使用的代码（相对于您认为您输入/认为相关的代码） - use 语句在那里，模块过程名称拼写正确，模块中没有私有语句，主程序中的引用不在内部过程中，主机关联名称以某种方式隐藏，等等？
*   源文件是否全部编译没有错误？是否有来自先前成功编译的“剩余” mo​​d 文件可以优先于当前编译中的 mod 文件被拾取？

虽然我认为这不是您的问题的原因，但请注意，某些系统在链接步骤中对目标文件和库的顺序（更是如此）很敏感 - 在引用的文件后面的文件中搜索符号命令行上的特定符号。为了更健壮，您应该以相反的方式订购目标文件。

# asp.net-web-api - 我可以在 WebAPI 消息处理程序中使用 Autofac DI 吗？

> ID：12610082
> 
> 赞同：13
> 
> 时间：2012-09-26T20:43:11.910
> 
> 标签：asp.net-web-api, autofac

我在我的 ASP.NET WebAPI 项目中成功连接了 Autofac，现在我想知道如何在我的 MessageHandlers 中解析服务。

由于必须在应用程序启动时添加 MessageHandlers，很明显我无法在请求生命周期范围内解决它们。这里没问题。

但是，我想找到一种在执行 MessageHandler 的 SendAsync 方法期间获取当前请求生命周期范围的方法，以便能够（例如）执行令牌验证、登录存储库等......

我该怎么做？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-27T18:49:21.710

您可以使用`GetDependencyScope()`扩展方法，`HttpRequestMessage`它为您提供了一个`IDependencyScope`您可以在处理程序中解析您想要的任何服务的位置：

```
public class MyHandler : DelegatingHandler
{
    protected override Task<HttpResponseMessage> SendAsync(
        HttpRequestMessage request, 
        CancellationToken cancellationToken)
    {
        IMyService myservice =
         (IMyService)request.GetDependencyScope().GetService(typeof(IMyService));
        // Do my stuff with myservice
        return base.SendAsync(request, cancellationToken);
    }
} 
```

# web - 在 Webmatrix 2.0 应用程序的导航栏中显示角色

> ID：12610084
> 
> 赞同：1
> 
> 时间：2012-09-26T20:43:16.510
> 
> 标签：web, webmatrix-2

我有一个 WebMatrix 2.0 应用程序，我希望用户的角色位于 _SiteLayout.cshtml 页面的导航区域内。

作为我在其他地方删除角色的示例，我有这个：

```
@{
    PageData["Title"] = "Agma App: Users and Roles ";
    .
    .
    .
    // Errors
    var lstErrors = new List<string>();
    lstErrors.Clear();
    var result = "";

    //Code to remove a role(s)
    var deleteRoleNames = Request.Form.GetValues("deleteRoleName");
    if(deleteRoleNames != null){
        foreach(var r in deleteRoleNames)
        {
            try 
            {
                Roles.DeleteRole(r);
            }
            catch (Exception ex)
            {
                @Html.ValidationMessage("deleteRoleName")
                lstErrors.Add("Role is not empty, it has users associated with it.");
                lstErrors.Add(ex.Message);
                result = "Role is not empty, it has users associated with it.";
            }
        }
        if(lstErrors.Count == 0){
        }
        else{
            PageData["errors"] = lstErrors;
        }
    }
}

<h1>@PageData["Title"]</h1>

    @Html.ValidationSummary()

<form action="" method="post">
    <fieldset>
        <legend>Existing  Roles</legend>
        <ul class="roles">
            @foreach(var r in roles){
                <li>
                    <label for="deleteRoleName"><input type="checkbox" name="deleteRoleName"   value="@r "/> @r</label>
                </li>
            }
        </ul>
            <input type="submit" value="Delete Checked Roles" onclick="return confirm('Are you   sure you want delete the checked roles?');"/>
    </fieldset>
</form>

This works fine.

Back to _SiteLayout  -- my <nav> area is currently compensating for my lack of knowledge by hard-    coded references to roles, i.e.:
                <nav>
                    <ul id="menu">
                        <li><a href="~/">Home</a></li>
                        @if (User.IsInRole("Administrator")) {
                            <li><a href="~/Administrator/Home">Administrator</a></li>
                        }
                        @if (User.IsInRole("BoardMember")) {
                            <li><a href="~/">BoardMember</a></li>
                        }
                        .
                        .
                        .
                        <li><a href="~/About">About</a></li>
                        <li><a href="~/Contact">Contact</a></li>
                    </ul>
                </nav> 
```

我的问题是，由于 _SiteLayout 不是以 @{} 构造开头的，所以我对如何完成我想做的事情感到困惑。

# cross-correlation - 销售具有相关价格的产品

> ID：12610085
> 
> 赞同：0
> 
> 时间：2012-09-26T20:43:18.370
> 
> 标签：cross-correlation

我有需要解决的买家/卖家问题：

我，作为买家，想买（比方说）50 件商品。有几个卖家有我需要的所有（或至少一些）产品库存。我可以向他们询问不同产品的价格并选择最便宜的选项。到目前为止，一切都很好。问题如下：如果我组合不同的产品，产品价格是相关的：

卖家 A 可以以 400 美元的价格向我出售产品 A，以 300 美元的价格向我出售产品 B，但两者加起来要 500 美元。

不知道这个相关函数是怎么构建的，只能求个结果。我什至可以要求零件：

我可以向卖家 1 要求产品 A 的 10 件和产品 B 的 5 件，以及卖家 2 的产品 B 的 5 件和 10 件。

我不能要求每一种可能的组合，因为 50 种不同数量的不同商品有 10 个卖家要求每一种可能的组合（蛮力可能性）将持续到普遍结束。

是否有既定的最佳实践，如某种拍卖，在可接受的时间内达到某种帕累托最优？或者有人可以将我推向解决此类问题的方向，以便我可以开始研究自己（科学论文等）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:01:39.563

我假设有一个函数代表 A 的价格和 B 的价格。任何时候你下订单，A 和 B 都会做出相应的反应。如果给你一些假设，这会使问题变得更简单，因为目前它会以一个协方差矩阵结束，你试图通过你的试验来猜测它。（所有矩阵基本上告诉你的正是我所说的......这两种产品在输入方面如何相互关联）

如果您知道在购买 10 件商品时您必须支付每件商品的略微增加的成本……即一次购买 1 件的成本高达 10 件，而不是一次获得 10 件的折扣，它会给您一个更好地了解模型是什么。这可能只是一个你必须解决并研究反应的问题......我不知道这对你来说是一个统计问题还是什么，但它可能只是简单的经济学或复杂的统计数据。

# xslt - XSLT 未按预期工作

> ID：12610088
> 
> 赞同：0
> 
> 时间：2012-09-26T20:43:36.680
> 
> 标签：xslt

我有一个 XML 文件：

```
<?xml version="1.0" encoding="utf-8" ?>
<root>
  <child>
    <gc>gc1Value</gc>
  </child>
  <child>child2Value</child>
  <child>
    <gc>gc2Value</gc>
    <gc>gc3Value</gc>
    <gc>
      <ggc>ggcValue</ggc>
      <ggc>ggcValue</ggc>
    </gc>
  </child>
</root> 
```

和一个 Xslt 文件：

```
<?xml version="1.0" encoding="utf-8"?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" exclude-result-prefixes="msxsl">
    <xsl:output method="xml" indent="yes"/>
    <xsl:template match="/">
      <root>
      <xsl:for-each select="root/child">
        <xsl:if test=".!=''">
          <value>
            <xsl:value-of select="."/>
          </value>
        </xsl:if>
        <xsl:for-each select="root/child/gc">
          <xsl:if test=".!=''">
            <value>
              <xsl:value-of select="."/>
            </value>
          </xsl:if>
          <xsl:for-each select="root/child/gc/ggc">
            <xsl:if test=".!=''">
              <value>
                <xsl:value-of select="."/>
              </value>
            </xsl:if>
          </xsl:for-each>
        </xsl:for-each>
      </xsl:for-each>
      </root>
    </xsl:template>
</xsl:stylesheet> 
```

我期待看到这样的结果：

```
<root>
  <value>gc1Value</value>
  <value>child2Value</value>
  <value>gc2Value</value>
  <value>gc3Value</value>
  <value>ggcValue</value>
  <value>ggcValue</value>
</root> 
```

但我得到了这个结果：

```
<?xml version="1.0" encoding="utf-8"?>
<root>
  <value>
    gc1Value
  </value>
  <value>child2Value</value>
  <value>
    gc2Value
    gc3Value

      ggcValue
      ggcValue

  </value>
</root> 
```

我认为通过使用`.`for select 这只会选择当前节点的值，但它似乎也从子节点获取值。我应该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T20:52:28.113

问题出在这里：

```
 <xsl:if test="gc!=''">
      <value>
        <xsl:value-of select="."/>
      </value>
    </xsl:if> 
```

“。” 将获取当前节点及其所有子节点。

使用 node::text() [ 即。select="text()" ] 如果你只想要文本。我也建议使用'string-length(node) != 0'之类的而不是''，

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:50:10.193

你的问题在于你的输出。

```
 <value>
        <xsl:value-of select="."/>
      </value> 
```

您有换行符 + 空格 + 实际值 + 换行符 + 空格。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T09:27:06.790

如果打算将所有文本节点简单地输出为**值**元素，则可以采用一种更简化的方法，该方法适用于任何 XML 结构，而不管元素名称如何。

例如，试试这个 XSLT。这依赖于元素的内置模板规则，它只处理其子元素

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
   <xsl:output method="xml" indent="yes"/>

   <xsl:template match="/*">
      <xsl:copy>
         <xsl:apply-templates />
      </xsl:copy>
   </xsl:template>

   <xsl:template match="text()">
      <value>
         <xsl:value-of select="." />
      </value>
   </xsl:template>
</xsl:stylesheet> 
```

这也应该给你预期的结果。

# xcode - Xcode 4.5 不在模拟器或设备上运行/加载应用程序

> ID：12610090
> 
> 赞同：5
> 
> 时间：2012-09-26T20:43:50.313
> 
> 标签：xcode, cordova, ios-simulator

我在 2007 年中期 Mac Mini 上的 OS X Lion 10.7.5 上运行 Xcode 4.5。在我构建时模拟器和实际设备不运行应用程序之前，我遇到过这个问题。我正在使用 Phonegap 2.1、HTML、JS、Jquery Mobile 编写几个不同的应用程序。[在按照OSX Daily](http://osxdaily.com/2012/02/20/uninstall-xcode/)和[SO 如何完全删除 Xcode 4](https://stackoverflow.com/questions/5255959/how-to-fully-remove-xcode-4)的说明后，我重新安装了 Xcode 2-3x. 这工作了一段时间，但后来我的 300 GB SSD 驱动器死了，我不得不重新安装 OEM 120 GB 硬盘驱动器并重新安装 Xcode 和 Phonegap（自从驱动器被卸载后，两者都有 revved 版本）。现在我无法让 Xcode 启动模拟器或再次下载到我的 iPhone 4。我昨天再次完全卸载 Xcode 并重新安装。我第一次尝试构建时，下载 5.1 模拟器花了很长时间（* 请参阅下面的编辑），但最终“完成”，但仍然没有运行它们。尝试下载到我的手机，再次没有。

由于这是第三次或第四次发生这种情况，我想知道我做错了什么。显然我错过了一些东西，因为我没有看到这个问题在各种支持论坛上被尖叫，比如这里、谷歌或苹果，只有零碎的东西。

作为测试，我创建了一个简单的 PhoneGap 应用程序，其中除了 PG 创建的任何内容之外什么都没有，它不会运行模拟器或下载到我的手机上。同样的方法过去只用于测试系统，但不再适用。它构建得很好，并使方形“运行”按钮变暗几秒钟，然后按钮再次变亮，就像你停止了应用程序一样，就是这样。没有错误消息，没有构建错误，什么都没有。

英特尔正在更换我的 SSD 驱动器，所以当它到达这里时，我将不得不重新经历这一切，除非我可以在硬盘驱动器上运行一个工作副本，然后用 Carbon Copy Cloner 克隆它，这样我就可以将其复制到新驱动器上。

任何帮助将不胜感激，我真的很想不必持续处理这个问题。

*编辑：我最初删除了这个问题，因为我认为我做了一些愚蠢的事情，我意识到我下载了模拟器的*文档*，但没有下载*实际的模拟器*。我已经下载了 5.1 模拟器，但我仍然遇到同样的问题。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-10-25T23:53:08.610

`HelloWorld`当我尝试为 Phone Gap iOS 运行我的第一个应用程序时，我遇到了类似的情况。

结果对我来说，可执行文件从*`Edit schema dialog`*. 很奇怪，因为它运行了几次，然后它停止工作，直到我找到这个对话框。

您可以在中找到此对话框`Product -> Edit Scheme --> Info --> Executable`（确保它不为空）。

虽然，您找到了您的解决方案，但这是一个可能对其他人有所帮助的快速检查。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-13T12:09:12.033

**在关注之前请阅读下面我编辑的评论**

1.  退出 XCode
2.  退出模拟器
3.  转到图像中的所有路径并删除所有这些文件夹 ![在此处输入图像描述](../Images/992de8662ccc615d0a010f8289285497.png)

4.  打开模拟器并在 iOS 模拟器菜单`Reset content and settings`中。重置它

启动 XCode，您现在不必担心。

**编辑**

**错误发生几天后我再次遇到问题，所以我尝试了上述步骤但没有任何反应:(，我第二次在删除与 xcode 和模拟器相关的所有内容并创建一个新项目后重新安装了 xcode。对于一个干净的项目应用程序运行良好但又一次以相同的方式从旧项目中复制所有文件，再次面临同样的问题。那么我如何解决这个问题？**

您可能仍需要按照上述步骤操作，不确定这些是否有效。但我试图发现问题始于我从旧项目复制文件时。

将文件添加到新项目时，会出现一个对话框，询问现有文件的位置，如果您看到`folders`带有 2 的选项，`radio buttons`则默认`Create group of any added folder (if needed)`选择。一切都很顺利，直到我没有触及这些选项。

**绿色：**默认， **红色：**用户选择

![将现有文件复制到 xcode 项目](../Images/9d240a85320132221ad1b46760ac229a.png)

`Resources`但是当我使用`2nd radio button`那个说的文件夹时，问题又开始出现了， `Create folder references for any added folder`. 当我删除此文件夹引用并清理项目时，应用程序运行良好。使用选项添加相同的文件夹`Create group of any added folder (if needed)`也效果很好。每当我选择第一个单选按钮时，应用程序都会显示相同的问题。

![创建任何添加的文件夹的组（如果需要）](../Images/665d7b36b5db67385e2a0c2c4e7e453a.png)

和

![为任何添加的文件夹创建文件夹引用](../Images/2c4f870c138bba85426fdae11e2547a8.png)

我相信您了解[这两个选项之间的区别，](https://stackoverflow.com/a/8851741/362310)即文件夹颜色到`yellow`和文件夹颜色到`blue`！希望这对所有其他人也有帮助，但这真的很令人沮丧，我要求苹果尽快修复这个错误 :( :(

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-02T00:26:40.890

所以，我不确定这是实际的答案，但我似乎找到了一个可行的程序序列。

首先：我完全删除了 Xcode（再次），从头开始重新安装（再次），并更新了除 4.3 之外的所有模拟器以及命令行工具（Xcode > Preferences > Download > Components > All Simulators except 4.3 & the command line tools ） 再次。

第二：我还重新安装了PhoneGap 2.1，但我不确定这是否必要，这更像是一场焦土战役。Xcode 中的问题似乎源于方案，我不断得到名为“CordovaLib”的方案，而不是我的项目名称。如果您单击方案/模拟器按钮上的“CordovaLib”（左上角是列出可用方案和模拟器的地方，就在构建和停止按钮旁边），并将方案更改为有帮助的项目名称。

第三：您需要确保您的应用的位置设置为“唯一”。在 Xcode > Preferences > Locations > Locations (not Source Trees) > Derived Data > Advanced > Build Location == Unique > Done 执行此操作。

它似乎有助于在 Xcode 中打开项目而不是从 Finder 启动它们，但我不相信这是真的，它*似乎*工作得更好，但我可以想象它。

如果我在以前遇到问题的项目上这样做，我现在可以将它们下载到模拟器和我的手机上。

这没有得到任何回应，但也许其他人会发现它有用。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-05-04T15:38:30.397

我不得不删除架构并重新创建；

1.  产品 >> 架构 >> 编辑架构。
2.  然后管理方案。
3.  然后点击“-”删除架构和
4.  立即自动创建方案。

然后，在模拟器中，我重置设置。然后它起作用了。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-09-27T13:56:55.297

我通过将活动模式更改为 HelloWorld 而不是 CordovaLib 解决了这个问题。

Product->Scheme->HelloWorld - 确保复选标记位于此项而不是 CordovaLib 旁边。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2014-09-05T11:02:10.247

我必须去 Product > Schema > Edit Schema

然后在“运行”对话框中，“可执行文件”下拉菜单为“无”。我将其更改为 .app 文件，它工作正常！

# php - 使用相同变量执行的 PHP PDO 多个语句

> ID：12610094
> 
> 赞同：2
> 
> 时间：2012-09-26T20:44:09.813
> 
> 标签：php, mysql, pdo

我不完全确定 PHPs PDO 查询在幕后做了什么。使用它们还是新手。这是我的问题。这安全吗？

```
$sth = $dbh->prepare("{some sql statement}");
$sth->execute();

$sth = $dbh->prepare("{an entirely different sql statement}");
$sth->execute(); 
```

像这样重用`$sth`变量会导致任何问题吗？我不确定我是否会遇到一些时间问题，或者这是否确实是一种安全的做法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T20:46:57.930

它不是并行运行的，这里应该没有问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T20:47:03.230

没问题，您正在重新声明它，以便前一个被销毁。我看到的唯一问题是，如果您有未提交的数据，您将丢失它。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T20:47:42.043

不，`$sth`是指向内存中语句处理程序的指针。通过为其分配第二个准备好的查询，第一个语句处理程序不再有指向它的指针，并将被*垃圾收集器*清理。

# eclipse - 重新安装 OSX 后，如何在 Flash Builder (/Flex) 中的 Package Explorer 下恢复我的项目列表？

> ID：12610095
> 
> 赞同：2
> 
> 时间：2012-09-26T20:44:10.060
> 
> 标签：eclipse, flash-builder, osx-mountain-lion, reinstall

我今天刚刚完成了 OSX Mountain Lion 的全新安装，并在另一个硬盘驱动器上备份了之前的所有内容（Carbon Copy Cloned）。我刚刚重新安装了 Flash Builder 4.6 并导入了我的首选项（键盘快捷键等）。但是我的项目列表（项目资源管理器视图）是空的。所有的项目都和以前一样。我只是想知道某处是否有一个文件包含这些项目引用的列表，我可以将其导入或粘贴到我的文件系统上，这样我就不必手动选择项目并一个一个地导入它们。

# android - 如何在Android上播放流aacp运行背景

> ID：12610098
> 
> 赞同：0
> 
> 时间：2012-09-26T20:44:30.703
> 
> 标签：android, service, stream, aac

我正在寻找如何在后台运行其内容/类型：**音频/AACP**的流 Shoutcast 。目前，我正在使用库[aacdecoder-android](http://code.google.com/p/aacdecoder-android/)获取运行流，但不明白如何使用服务将流留在后台。有没有人用过这样的东西？

代码：

**主要活动：**

```
public class MainActivity extends Activity {
    public AACPlayer mp;
    private Toast myToast;
    private Handler mHandler;
    private ImageParser mImageParser;

    private WebView publicidadecapa;

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        menu.add("Sair");
        return super.onCreateOptionsMenu(menu);
    }

    @Override
    public boolean onOptionsItemSelected(MenuItem item) {
        if (item.getTitle().toString() == "Sair") {
            finish();
        }
        return super.onOptionsItemSelected(item);
    }

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.maintab);       

        mp = new AACPlayer(new RadioCallBack(this));                
        ProgressBar loading = (ProgressBar) findViewById(R.id.loadingAudio);
        loading.setVisibility(View.INVISIBLE);
        ImageView playButton = (ImageView) findViewById(R.id.playButton);
        playButton.setTag("1");
        playButton.setOnClickListener(new OnClickListener() {
            public void onClick(View arg0) {
                ImageView playButton = (ImageView) arg0;
                ConnectivityManager cm =
                        (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

                if ( cm.getActiveNetworkInfo() == null || !cm.getActiveNetworkInfo().isConnectedOrConnecting() ) {
                    if (myToast == null) {
                        myToast = Toast.makeText(getBaseContext(), "Verifique a conexão com a internet", 5000);
                    }
                    myToast.setDuration(5000);
                    myToast.show();
                    return;
                }

                if (playButton.getTag() == "1" && cm.getActiveNetworkInfo().isConnectedOrConnecting() ) {

                    playButton.setImageResource(R.drawable.btn_menustop);
                    playButton.setTag("0");
                    playButton.setVisibility(View.INVISIBLE);
                    ProgressBar loading = (ProgressBar) findViewById(R.id.loadingAudio);
                    loading.setVisibility(View.VISIBLE);
                    ((TextView)findViewById(R.id.textView1)).setText("Conectando...");

                    mp.playAsync( "http://voxsc1.somafm.com:9002/" );

                } else if ( playButton.getTag() == "0" ) {                  

                    playButton.setVisibility(View.INVISIBLE);
                    ProgressBar loading = (ProgressBar) findViewById(R.id.loadingAudio);
                    loading.setVisibility(View.VISIBLE);
                    playButton.setImageResource(R.drawable.btn_menuplay);
                    playButton.setTag("1");

                    mp.stop();
                }                                               

            }           
        });        

        final AudioManager audioManager = (AudioManager)getSystemService(Context.AUDIO_SERVICE);        

        SeekBar volumeControl = (SeekBar) findViewById(R.id.volumeControl);
        volumeControl.setMax(audioManager.getStreamMaxVolume(AudioManager.STREAM_MUSIC));
        volumeControl.setProgress(audioManager.getStreamVolume(AudioManager.STREAM_MUSIC));
        volumeControl.setOnSeekBarChangeListener(new SeekBar.OnSeekBarChangeListener() {

            public void onStopTrackingTouch(SeekBar arg0) {

            }

            public void onStartTrackingTouch(SeekBar arg0) {

            }

            public void onProgressChanged(SeekBar arg0, int arg1, boolean arg2) {
                audioManager.setStreamVolume(AudioManager.STREAM_MUSIC, arg1,0);
                if(arg1 == 0) {
                    ((ImageView) findViewById(R.id.imageView2)).setImageResource(R.drawable.ic_volume2);
                } else {
                    ((ImageView) findViewById(R.id.imageView2)).setImageResource(R.drawable.ic_volume1);
                }
            }
        });        
    }

    @Override
    public void onStop() {
        super.onStop();

    }
    @Override
    protected void onDestroy() {
        if (this.isFinishing()) {
            //mp.stop();
        }
        super.onDestroy();
    }

    public void onStart()
    {
        super.onStart();

        // your code
    }

    public Object fetch(String address) throws MalformedURLException,IOException {
        URL url = new URL(address);
        Object content = url.getContent();
        return content;
    }

    private Boolean isOnline()  {
        ConnectivityManager cm = 
                (ConnectivityManager)getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo ni = cm.getActiveNetworkInfo();
        if(ni != null && ni.isConnected())
            return true;

        return false;
    }

    /* Abrir em uma nova aba o link da publicidade */
    public class MyWebClient extends WebViewClient{
        @Override
        public boolean shouldOverrideUrlLoading(WebView view, String url) {
            //Uri uri = Uri.parse(url);
            Context context = view.getContext();
            Intent intent = new Intent(context,OpenSiteWebView.class);

            Bundle parametros = new Bundle();
            parametros.putString("url", url);

            intent.putExtras(parametros);

            startActivity(intent);
            return true;
        }
    }
} 
```

**RadioCallBack：**

```
public class RadioCallBack implements PlayerCallback {

    private MainActivity activity;

    public RadioCallBack(MainActivity activity) {
        super();
        this.activity = activity;
    }

    public void playerException(Throwable arg0) {
        activity.runOnUiThread(new Runnable()  {                    
            public void run() {
                Toast.makeText(activity, "O stream pode estar offline! Tente novamente mais tarde", 50000).show();

                ProgressBar loading = (ProgressBar) activity.findViewById(R.id.loadingAudio);
                loading.setVisibility(View.INVISIBLE);
                ImageView playButton = (ImageView) activity.findViewById(R.id.playButton);
                playButton.setVisibility(View.VISIBLE);
                playButton.setImageResource(R.drawable.btn_menuplay);
                playButton.setTag("1");
                ((TextView)activity.findViewById(R.id.textView1)).setText("Pressione PLAY para tocar!");
            }
        });
    }

    public void playerPCMFeedBuffer(boolean arg0, int arg1, int arg2) {
        // TODO Auto-generated method stub

    }

    public void playerStarted() {
        activity.runOnUiThread(new Runnable()  {            
            public void run() {
                ProgressBar loading = (ProgressBar) activity.findViewById(R.id.loadingAudio);
                loading.setVisibility(View.INVISIBLE);
                ImageView playButton = (ImageView) activity.findViewById(R.id.playButton);
                playButton.setVisibility(View.VISIBLE);
                ((TextView)activity.findViewById(R.id.textView1)).setText("Mais música brasileira");
            }           
        });     
    }

    public void playerStopped(int arg0) {
        activity.runOnUiThread(new Runnable()  {            
            public void run() {
                activity.mp = null;
                activity.mp = new AACPlayer(new RadioCallBack(activity));
                ProgressBar loading = (ProgressBar) activity.findViewById(R.id.loadingAudio);
                loading.setVisibility(View.INVISIBLE);
                ImageView playButton = (ImageView) activity.findViewById(R.id.playButton);
                playButton.setVisibility(View.VISIBLE);
                ((TextView)activity.findViewById(R.id.textView1)).setText("Pressione PLAY para tocar!");
            }           
        }); 
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T13:33:53.843

您必须创建后台服务才能让您的音乐播放器在后台运行。

1st你必须启动服务。然后在 Service 的 onCreate() 方法中初始化你的 MultiPlayer 对象。

然后在您的 UI 活动上实现 ServiceConnection（其中有您的多人 UI）。这会将您的 UI 活动与后台服务连接起来。现在您可以控制后台服务和您的多人游戏对象，例如播放、暂停功能。请参阅[此](http://developer.android.com/guide/components/bound-services.html#Binder)用于实现 ServiceConnection。

如果您希望用户通过单击通知栏中的通知导航回 ui，您也可以设置您的[serviceForground 。](http://developer.android.com/guide/components/services.html#Foreground)

希望这可以帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-07T11:42:08.737

“使用服务” - 正确：android 服务授予您的应用程序组件额外的运行权限，即使组件不在任务堆栈顶部或即使您的应用程序退出，它们也可以持续存在。大多数情况下，除了那些关键的资源不足的情况，系统不会干扰和停止服务，所以由你来控制它。

专门针对您的情况，官方网站上有[一篇](http://developer.android.com/guide/topics/media/mediaplayer.html#mpandservices)关于构建具有后台播放功能的播放器的文章。然而，他们谈论 MediaPlayer，我相信同样的原则适用于任何自定义播放器。

祝你好运。

# centos - 试图在 VirtualBox 的上下文中理解 ISO 映像

> ID：12610100
> 
> 赞同：0
> 
> 时间：2012-09-26T20:44:33.543
> 
> 标签：centos, virtual-machine, virtualbox

我在 VirtualBox 上创建了一个 CentOS 虚拟机。我已经使用 ISO 映像来启动它。现在，在 CentOS VM 映像中，有一个安装到硬盘驱动器的选项。我选择了该选项，完成了所有安装步骤。但即使在那之后，在 VM 的设置窗口中，IDE 控制器仍显示为 iso 映像，与 iso 文件的位置相同。这是使用 ISO 映像进行安装的方式吗？

我很困惑，因为当我使用 Live CD 或 DVD 安装 VM 时，我可以移除 DVD 或 CD，而 VM 仍然可以工作。但是在这里，我似乎总是依赖于我的机器中永久存在的 iso 映像。是这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T17:08:02.200

在虚拟机设置窗口的存储页面中，您会看到虚拟机中存在的所有 IDE 和 SATA 控制器。默认情况下，VirtualBox 似乎创建了虚拟 IDE 光驱和虚拟 SATA 硬盘驱动器（您可以更改它，但您可能不需要）。

我怀疑您看到的是 Centos ISO 文件映像仍与虚拟光驱相关联。这只是意味着当你启动 VM Centos 时会认为 CD 仍然插入到驱动器中。您可以通过选择“CD/DVD 设备”和“从虚拟驱动器中删除磁盘”从 VM 的“设备”菜单中“弹出”CD。

不过，您可能想要安装 VirtualBox 来宾添加。当您这样做时，VirtualBox 将用来宾添加虚拟 CD 替换 Centos 虚拟 CD。

# awk - 根据 AWK 中的字段值递增 var

> ID：12610101
> 
> 赞同：1
> 
> 时间：2012-09-26T20:44:38.193
> 
> 标签：awk, variable-assignment

我需要使用 AWK 从文件中打印出特定范围内的连接速率数。

以下是部分数据：

```
Mon Sep 15 11:50:08 1997
        User-Name = "edvargas"
        NAS-Identifier = 207.238.228.11
        NAS-Port = 20116
        .
        .
        .
        Ascend-Connect-Progress = 60
        Ascend-Data-Rate = 31200
        .
        .
        . 
```

有 5 个不同的范围，所以我用最低的两个进行测试。到目前为止，这是我所拥有的：

```
BEGIN{first=0; second=0; third=0; fourth=0; fifth=0}
/Ascend-Data-Rate/ && ($3<14400){
        first++;
}
/Assend-Data-Rate/ && ($3>14400) && ($3<19200){
        second++;
}
END{print "first =",first, "second =",second} 
```

这些都不会增加变量。我知道在我的输出中，**第一个**范围应该找到 6，**第二个**范围应该找到 2。但是，两者都不能正常工作。

以下是我对问题的理解：

```
 Search each record (line) for the field (string) "Ascend-Data-Rate"

    If that is found:  then compare the value of $3 (third field) to the range.

      If that is found: increase the value of the var by one. 
```

我 90% 确定这是让我失望的语法。我错过了什么？

这是一个练习，让我为下周到期的作业做准备。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T20:49:09.853

问题是你如何增加变量：

首先，将变量初始化为零。

```
first = 0 
```

然后你通过它的值增加变量。但是由于该值为零，因此不会增加。

```
first += first; 
```

基本上在这种情况下，这与说：

```
first += 0; 
```

或者

```
first = first + 0; 
```

只是预感，但我想你可能想要

```
first = first + 1; 
```

或（意思相同）

```
first++; 
```

反而...

# ios - 线程 1：Xcode iOS 中的 EXC_BAD_ACCESS 错误

> ID：12610103
> 
> 赞同：0
> 
> 时间：2012-09-26T20:44:40.920
> 
> 标签：ios, xcode4, exc-bad-access

我在这里得到一个错误。有人可以告诉我我做错了什么吗？顺便说一句，这对我来说只是一个学习项目，所以没有什么绝密之类的。只是想制作一个简单的转换器。

如果整个项目可以帮助：[http ://www.mediafire.com/download.php?iccgq9iclapado5](http://www.mediafire.com/download.php?iccgq9iclapado5)

```
#import "MainViewController.h"

@interface MainViewController ()

@end

@implementation MainViewController
@synthesize picker, lngConvertFrom, lngRates;           
@synthesize resultLabel,lngInput;                      
- (void)viewDidLoad
{
    [super viewDidLoad];
    self.lngConvertFrom = [[NSArray alloc] initWithObjects:  <-Thread 1: ExC_bad_Access 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T20:51:27.787

你在那里缺少一个“@”。`"LNG HepatittB"`不是一个对象，而是一个 C 字符串。

# android - 如何阻止 Android ViewFlipper 循环播放？

> ID：12610106
> 
> 赞同：6
> 
> 时间：2012-09-26T20:44:54.040
> 
> 标签：android, android-animation, android-view

我有一个 ViewFlipper 设置为每 5 秒自动翻转一次。省略一些细节，它看起来像这样并且工作正常：

```
ViewFlipper flipper = (ViewFlipper) findViewById(R.id.myflipperid);

flipper.setFlipInterval(5000);                              
flipper.setInAnimation(inFromRightAnimation());
flipper.setOutAnimation(outToLeftAnimation());

flipper.startFlipping(); 
```

但是，我有一个案例，我希望自动翻转在最后一个视图处停止，而不是循环重新开始。ViewFlipper 或其继承的任何类似乎都没有循环控制方法。

如何让 ViewFlipper 在到达最后一个视图时停止循环遍历其子视图？

注意：[此处](https://stackoverflow.com/questions/6354180/how-to-prevent-viewflipper-from-looping)给出的答案不适用于我的情况，因为我需要在其列表末尾捕获 ViewFlipper，即，不依赖于用户输入。谢谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T11:51:46.420

这是我使用的解决方案。正如[这里](https://stackoverflow.com/a/3813179/1594522)所建议的，诀窍是监听动画结束事件，然后检查脚蹼是否在最后一个视图上。

```
flipper.getInAnimation().setAnimationListener(new Animation.AnimationListener() {

    public void onAnimationStart(Animation animation) {}
    public void onAnimationRepeat(Animation animation) {}
    public void onAnimationEnd(Animation animation) {

        int displayedChild = flipper.getDisplayedChild();
        int childCount = flipper.getChildCount();

        if (displayedChild == childCount - 1) {
            flipper.stopFlipping();
        }
    }
}); 
```

感谢您的回答。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-27T08:00:19.610

我自己没有尝试过，但我希望这会有所帮助。

首先，尝试收听 viewflipper 的翻转事件。由于您使用的是动画。您可以使用此处发布的解决方案：[https ://stackoverflow.com/a/3813179/1594522](https://stackoverflow.com/a/3813179/1594522)

然后，onAnimationEnd()，您可以检查 viewflipper 是否在其最后一个子视图上。如果它已经在其最后一个子视图中，则调用 Flipper.stopFlipping()。

希望有帮助！:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T08:05:21.027

只需获取列表的大小，然后在 if 条件下，说

```
flipper.stopFlipping() 
```

希望它以这种方式工作。

# android - Android-NDK编译和链接

> ID：12610107
> 
> 赞同：2
> 
> 时间：2012-09-26T20:44:58.850
> 
> 标签：android, android-ndk

我有一个 java 项目，现在我想添加一些 NDK 功能。

这是我的`Android.mk`：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)

LOCAL_MODULE    := android
LOCAL_CFLAGS    := -Wno-psabi
LOCAL_SRC_FILES := android.c
LOCAL_LDLIBS    := -L$(SYSROOT)/usr/lib -llog

include $(BUILD_SHARED_LIBRARY) 
```

这是我的`android.c`

```
#include <jni.h>  
#include <string.h>  
#include <android/log.h>  

#define DEBUG_TAG "NDK_AndroidNDK1SampleActivity"  

void Java_ru_tonybo_app_NativeRenderer_print(JNIEnv* env, jobject thiz, jstring message) {
    jboolean isCopy;  
    const char * szMessage = (*env)->GetStringUTFChars(env, message, &isCopy);

    __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "NDK:LC: [%s]", szMessage);

    (*env)->ReleaseStringUTFChars(env, message, szMessage);
} 
```

这是我相关的java类

```
package ru.tonybo.app;

public class NativeRenderer {
    public NativeRenderer (String message) {
        print(message);
    }

    public native void print(String message);

    static {
        System.loadLibrary("android");
    }
} 
```

通过cygwin编译NDK就可以了

```
TonyBo@TonyBo-NoteBook /cygdrive/d/javaProjects/App_JNI/jni
$ /cygdrive/d/android-ndk-r8b/ndk-build -B
Cygwin         : Generating dependency file converter script
Compile thumb  : android <= android.c
SharedLibrary  : libandroid.so
Install        : libandroid.so => libs/armeabi/libandroid.so 
```

`libandroid.so`创建并放置在 /libs/armeabi/libandroid.so

但是当我在设备上的 eclipse 中启动应用程序时，我`UnsatisfiedLinkError`在本地调用时遇到了异常`print(message);`

我在这里错过了什么或做错了什么？可能我应该以某种方式告诉 eclipse 寻找共享库，如果是这样怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T09:32:58.293

您选择的**libandroid**名称不是一个好主意。库**libandroid.so**存在于系统文件夹**/system/lib**中。它被加载到您的应用程序中，因此您的`Load()`调用只是返回。如果您更改本机库的名称，一切都会好起来的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T10:38:42.320

您需要从共享库中正确导出您的方法。在方法声明中使用`JNIEXPORT`和`JNICALL`宏：

```
JNIEXPORT void JNICALL Java_ru_tonybo_app_NativeRenderer_print(...) 
```

# python - Python：如何在处理其他异常的同时忽略异常

> ID：12610109
> 
> 赞同：1
> 
> 时间：2012-09-26T20:45:08.893
> 
> 标签：python, django, exception, exception-handling

我弄乱了一些代码，并遇到了一个特殊的问题：

```
def find_available_slug(object, instance, slug)
    try:
        sender_node = object.objects.get(slug=slug)
    except object.DoesNotExist:
        instance.slug = slug
    else:
        slug = '%s_' % slug
        find_available_slug(object, instance, slug)
    return 
```

我遇到的问题是有时会`objects.get(slug=slug)`引发`MultipleObjectsReturned`异常，因为该字段在我的数据库中不是唯一的。我想知道如何`MultipleObjectsReturned`在“else”语句仍会被执行的情况下干净地捕捉到。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T02:46:15.700

或者，根本不要使用该`else`子句：

```
def find_available_slug(object, instance, slug)
    try:
        sender_node = object.objects.get(slug=slug)
    except object.DoesNotExist:
        instance.slug = slug
        return
    except object.MultipleObjectsReturned:
        pass

    slug = '%s_' % slug
    find_available_slug(object, instance, slug) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T20:45:08.893

简单的解决方案：诀窍是在调用方法时捕获`MultipleObjectsReturned`第二`try`条语句。`get`这样，不会引发异常并且继续正常执行。

作品：

```
def find_available_slug(object, instance, slug)
    try:
        try:
            sender_node = object.objects.get(slug=slug)
        except object.MultipleObjectsReturned:
            pass
    except object.DoesNotExist:
        instance.slug = slug
    else:
        slug = '%s_' % slug
        find_available_slug(object, instance, slug)
    return 
```

不工作：

```
def find_available_slug(object, instance, slug)
    try:
        sender_node = object.objects.get(slug=slug)
    except object.MultipleObjectsReturned:
        pass
    except object.DoesNotExist:
        instance.slug = slug
    else:
        slug = '%s_' % slug
        find_available_slug(object, instance, slug)
    return 
```

第二种“幼稚”方法不起作用的原因是，如果捕获到异常，解释器将不会遍历该`else:`子句。反而会默默无闻`return`。

# asp.net-mvc - 具有管道分隔值的路由约束仅在 MVC4 中获取第一个值？

> ID：12610114
> 
> 赞同：1
> 
> 时间：2012-09-26T20:45:44.810
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

我很好奇为什么这条路线不起作用：

```
routes.MapRoute("Tracking",
                                    "{mailingId}/{subject}/{listItemId}/MailReport.{fileExtension}",
                                    new { controller = "Mailing", action = "OpenerImage", subject = UrlParameter.Optional },
                                    new
                                    {
                                        mailingId = new NonEmptyGuidRouteConstraint(),
                                        listItemId = new NonEmptyGuidRouteConstraint(),
                                        fileExtension = @"(aspx|php|asp|html|htm|json|xml)"
                                    }); 
```

参数只获取`fileExtensions`列表中的第一个参数，所以如果我进入带有 ..../MailReport.php 的页面，我会收到 404 错误。

更新：

我认为这更像是一个 IIS 问题而不是路由问题。我认为 IIS 试图在路由引擎之前解释扩展。只是一个想法，因为我也尝试创建自定义路由约束，它只适用于 ASPX 扩展。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-01T23:41:55.103

我最终使用[IIS URL 重写](http://www.iis.net/learn/extensions/url-rewrite-module/using-the-url-rewrite-module)规则来处理这个问题。如果不编写我自己的路由类（可能工作也可能不工作）或处理程序，我认为这是不可能的

**更新：**

经过进一步研究，将其添加到 web.config 允许我绕过 IIS 的路由：

```
 <modules runAllManagedModulesForAllRequests="true" >
      <remove name="UrlRoutingModule"/>
    </modules> 
```

这在该`system.webServer`部分中，我相信您必须在集成模式下运行，否则该部分将被忽略。

# c++ - 从数组构造向量

> ID：12610118
> 
> 赞同：6
> 
> 时间：2012-09-26T20:45:56.773
> 
> 标签：c++, stdvector

[这](http://www.cplusplus.com/reference/stl/vector/vector/)表明我可以从数组构造一个向量，如下所示：

```
// the iterator constructor can be used to construct from arrays:
int myints[] = {16,2,77,29};
vector<int> myvector (myints, myints + sizeof(myints) / sizeof(int) ); 
```

为什么构造函数的第二个参数是`myints + sizeof(myints) / sizeof(int)`？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-09-26T20:47:20.080

表达式 `sizeof(myints) / sizeof(int)`获取`myints`数组中元素的数量。

`myints`获取指向数组第一个元素的指针。

因此，表达式`myints + sizeof(myints) / sizeof(int)`是一个指针，位于`myints`数组末尾之后，这正是[双迭代器构造函数所`std::vector`](http://en.cppreference.com/w/cpp/container/vector/vector)期望的。这将创建一个向量，其中包含原始数组中所有元素的副本。

请记住，指针是迭代器，所以上面等价于

```
vector<int> myvector (std::begin(myints), std::end(myint)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T20:51:56.483

```
sizeof(myints) / sizeof(int) 
```

是数组中元素的数量。

```
myints + sizeof(myints) / sizeof(int) 
```

为您提供超出数组末尾的内存位置。

STL 对第一个元素使用迭代器，并在结束时使用迭代器来指定范围。矢量构造函数正在使用这样的范围。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T20:50:38.880

它在最后一个元素之后获取指向**int的指针。**所以它变成了 begin() 和 end()

# actionscript-3 - 如何使用 actionscript 3 在 gridData 中添加组合框？

> ID：12610123
> 
> 赞同：0
> 
> 时间：2012-09-26T20:46:03.417
> 
> 标签：actionscript-3, flash, flash-cs5

我搜索了在 gridData 中添加 comobBox，我发现教程使用 mxml，但我使用 Flash pro，所以可以在代码中或使用 Flash 界面来完成。

# css - CSS - 菜单上统一的响应式背景图像

> ID：12610127
> 
> 赞同：0
> 
> 时间：2012-09-26T20:46:20.047
> 
> 标签：css, html-lists, responsive-design

我正在创建 Flash 网站的移动友好响应版本。我面临的问题是顶部菜单上的每个背景图像都有不同的宽度，所以我无法正确并排设置它们并同时具有统一的大小，它们正在缩放以适应容器。

这是一个使用背景图像和悬停效果的列表样式菜单。我正在使用背景大小：包含。

这是我的 CSS，对所有项目重复：

```
ul.menu {
   list-style:none;
   position:relative;
   z-index:1;
   right:24px;
   top:-100px;
   margin-bottom:-32px;
   display:inline-block;
   text-align:right;
   height:30px;
   width:100%;
   float:right;
}

ul.menu li {
   display:inline-block;
   list-style-image:none !important;
   text-align:right;
   width:15%;
   height:100%;
   float:right;
}

li.roca a {
   background: url(../images/roca1.jpg) no-repeat 0 0;
   position:relative;
   display:block;
   height:100%;
   -moz-background-size:contain; 
   -webkit-background-size:contain; 
   background-size:contain;
}

li.roca a:hover {
   background: url(../images/roca2.jpg) no-repeat 0 0;
   -moz-background-size:contain; 
   -webkit-background-size:contain; 
   background-size:contain;
} 
```

这是我的 HTML：

```
<ul class="menu">
    <li class="roca"><a href="http:..." target="_blank"></a></li>
    <li class="img2"><a href="http:..." target="_blank"></a></li>
    <li class="img3"><a href="http:..." target="_blank"></a></li>
    <li class="img4"><a href="http:..." target="_blank"></a></li>
    <li class="img5"><a href="http:..." target="_blank"></a></li>
</ul> 
```

有谁知道什么代码可以解决这个问题？

非常感谢提前！！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T20:54:56.303

*   不要将背景图像用于实际内容……在这种情况下，文本本身最好使用网络字体，而背景图像只是纹理。如果出于某种原因需要图像，则应使用带有正确文本的`img`标签。`alt`如果出于某种原因您真的想解决这个问题，您至少应该在标签中包含可访问性的内容。

*   将文本从背景图像中分离出来（**强烈**推荐，并且没有理由不使用 CSS3 字体支持的强大功能）将解决所有布局问题，如果您需要更可控的动态大小背景图像，您应该使用“滑动门”方法。

# iphone - iOS 6 的多个 UIInterfaceOrientations 应用程序

> ID：12610132
> 
> 赞同：3
> 
> 时间：2012-09-26T20:46:34.510
> 
> 标签：iphone, ios, ios6, uiinterfaceorientation

我在尝试从 iOS 6 设置新的 UIInterfaceOrientations 时遇到了麻烦。

恢复我的应用程序：

*   我的应用程序有很多视图；
*   几乎每个视图都应该以纵向显示；
*   我的 2 个视图（播放视频的视图`MPMoviePlayerViewController`）应该向左、向右和纵向旋转。

我最初的想法是将应用程序支持的方向设置为纵向，然后从视频播放器视图中更改（不知道如何）支持的方向。

处理这个问题的最佳方法是什么？

先感谢您！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T18:40:59.620

通过将支持的界面方向设置为我需要的所有方向（纵向、横向和左侧）并添加`Category`.`UINavigationController`

我将类别添加到任何`UINavigationController`我想保持纵向模式的事件中，并像[这篇文章](https://stackoverflow.com/a/12539784/842715)一样对待 iOS 6 旋转：

```
@implementation UINavigationController (Rotation_IOS6)

-(BOOL)shouldAutorotate
{
    return NO;
}

-(NSUInteger)supportedInterfaceOrientations
{
    return UIInterfaceOrientationPortrait;
}

- (UIInterfaceOrientation)preferredInterfaceOrientationForPresentation
{
    return UIInterfaceOrientationPortrait;
}

@end 
```

实现了这个我仍然有一些问题，因为代码是这样的：

```
[self.window.rootViewController presentModalViewController:controller animated:NO]; 
```

而不是这个：

```
[self.navigationController pushViewController:controller animated:NO]; 
```

通过上述更改，我能够将整个应用程序保持在纵向模式，并让视频播放器视图保持旋转，因为它们的方法（shouldRotate 和supportedInterfaceOrientations）没有被覆盖。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T20:56:30.753

查看我的帖子：[https](https://stackoverflow.com/a/12538622/1575017) ://stackoverflow.com/a/12538622/1575017 这是同一件事，但为您翻转了方向。

# java - 定制的小型 TCP 套接字服务器是否需要 VPS，或者是否有免费服务？

> ID：12610134
> 
> 赞同：-1
> 
> 时间：2012-09-26T20:46:36.053
> 
> 标签：java, tcp, vps

我正在尝试在基于 TCP 的服务器上用 Java 构建多人游戏。我已经编写了服务器，但我不知道如何将它部署到网络上。我看过的大多数服务都是 WSGI 或者非常有限，并且不支持我的应用程序。我需要一个 VPS 来托管这个，还是有免费的服务可以解决这个问题？

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T20:48:05.833

[Amazon Web Services 可以免费使用](http://aws.amazon.com/free/?utm_source=AWS&utm_medium=website&utm_campaign=LP_hero)一年，您可能有资格获得。您可以设置一个 EC2 实例并在那里运行您的应用程序。

# php - jQuery Mobile 原生应用程序表单发布到另一个页面

> ID：12610143
> 
> 赞同：0
> 
> 时间：2012-09-26T20:47:06.273
> 
> 标签：php, mysql, css, html, jquery-mobile

我正在尝试使用 jQuery Mobile 构建本机移动应用程序，然后将其包装在 PhoneGap 中。这是我第一次尝试构建移动应用程序，我有点迷失在一个通常很简单的话题上。我的应用程序将允许用户浏览高中橄榄球队的比分、赛程和统计数据。我有一个页面，在下拉列表中显示所有团队（#search-schedules）。用户将选择一个团队，发布团队 ID 值，并且该团队的日程安排显示在另一个页面 (#schedules) 上。我包含一个 custome.js 文件，其中包含整个应用程序所需的所有 jQuery。到目前为止我所拥有的（处理这个问题）如下。非常感谢任何关于实现这一目标的最佳方式的方向。

这是用户选择团队的页面：

```
<div data-role="page" id="search-schedules">
    <div data-role="header"><h1>Find Schedules</h1></div>
    <div data-role="content">
        <p align="center"><strong>Select a school from the list below to view their schedule</strong></p>
        <form id="schedules-form" data-transition="pop" data-direction="reverse" />
            <div align="center" data-role="fieldcontain">
                <select name="school" id="school-select">
                    <option value="">Select A School</option>
                </select>
                <p><input type="submit" id="submit" name="submit" value="Get Schedule" data-theme="b" /></p>
            </div>
        </form>
    </div>
    <ul data-role="listview" data-dividertheme="e">
        <li><a href="#home" data-transition="slide">Home Page</a></li>
    </ul>
    <div data-role="footer"><h1>Footer</h1></div>
</div> 
```

这是将显示计划的页面：

```
<div data-role="page" id="schedules">
    <div data-role="header"><h1>Schedules</h1></div>
    <div data-role="content">
        <h2 align="center"></h2>
        <div id="schedule-div"></div>
    </div>
    <ul data-role="listview" data-dividertheme="e">
        <li><a href="index.php" data-transition="slide">Home Page</a></li>
    </ul>
    <div data-role="footer"><h1>Footer</h1></div>
</div> 
```

这是提交表单的 JS：

```
$('#schedules-form').bind('submit', function (e) {
    e.preventDefault();
    $.post(serviceURL + 'schedules.php', $(this).serialize(), function(response) {
        $.mobile.changePage('#schedules', {
            transition: 'slide'
        });
    });
}); 
```

这是显示日程的 JS：

```
$('#schedules').live('pageshow', function(event) {
    var team = ''; // How do I grab a POST variable?
    $.post(serviceURL + 'schedules.php', team, function(data) {
        var games = data.item;
        $.each(games, function(index, game) {
            $('#schedule-div').append('<p>' + game.game_date + ' - ' + game.visitor_team + ' @ ' + game.home_team + '</p>');
        });
        $('#schedule-div').listview('refresh');
    });
}; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:01:56.020

据我了解，jQuery mobile 实际上并没有改变您当前的页面，它只是将后续页面加载到 DOM 中。让您的团队链接触发页面转换，并通过“data-teamId”属性传递检索团队日程所需的 ID。使用诸如“pageload”之类的 jQuery 移动事件之一（我还没有过多地研究事件被触发的确切时刻）开始通过 ajax 加载您的团队日程安排，并使用您在链接单击时获取的数据属性。完成后，显示时间表。

# python - 如何在 xbmc 附加组件上使用 settings.xml？

> ID：12610144
> 
> 赞同：1
> 
> 时间：2012-09-26T20:47:13.247
> 
> 标签：python, xml, xbmc

我的 xbmc 插件的资源文件夹中有我的 settings.xml 文件，它显示得很好。如何让我的 default.py 文件现在读取这些设置？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:19:14.930

解决了。

您（或者更确切地说，我）必须导入 xbmcaddon 并使用 .getSetting([xml id])

例如

```
import xbmc
import xbmcgui
import xbmcaddon

...

settings = xbmcaddon.Addon(id='script.usb.autoplay')
df = settings.getSetting("defaultfolder")
xbmc.executebuiltin("PlayMedia(%s, isdir)" % df) 
```

编辑：错了，现在是对的

# c# - 在 Trello API 上使用 Trello.Net 更新卡片的清单项状态

> ID：12610150
> 
> 赞同：1
> 
> 时间：2012-09-26T20:47:54.477
> 
> 标签：c#, api, trello, trello.net

有没有办法更新`CheckItemStates`Trello 卡？（使用 Trello.NET）

`trello.Checklists.AddCheckItem`只需要一个清单 ID 和项目的名称。它返回无效。

查看具有现有清单（所有项目仍未选中）的卡片`CheckItemStates`有 0 个项目。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T12:48:40.183

Trello 中的清单有点奇怪。清单属于董事会。同一张清单可以在多张卡片上。但是每张卡片都有单独的清单项目状态（选中/未选中）。我认为不可能将相同的清单添加到 trello.com 上的一张以上的卡片，但这就是它在幕后建模的方式。

从 0.5.5-beta 版开始，Trello.NET 支持这一点。使用`Trello.Cards.ChangeCheckItemState`. 更多信息[在这里](https://github.com/dillenmeister/Trello.NET/issues/8)。

**编辑：**

这个例子展示了如何遍历卡片的检查列表和检查项目。

```
foreach (var checkList in trello.Cards.WithId("a card id").Checklists)
{
    Console.WriteLine(checkList.Name);

    foreach (var checkItem in checkList.CheckItems)             
        Console.WriteLine("\t{0}: {1}", checkItem.Name, checkItem.Checked);
} 
```

# ruby-on-rails - CANCAN => 管理员 + 代理 + 用户

> ID：12610151
> 
> 赞同：-1
> 
> 时间：2012-09-26T20:48:00.283
> 
> 标签：ruby-on-rails, cancan

需要帮忙！:)

* * *

用例：管理员具有“超级管理员”角色时可以创建另一个管理员，管理员也可以创建“代理”

管理员模型的角色：

1.  超级管理员
2.  行政

管理员可以创建两个角色可以创建“代理”

* * *

代理可以创建“用户”，但他不能创建“代理”，并且他不应该看到其他代理创建的用户。他只有一个角色——“代理人”

* * *

现在的问题是：如何在能力中初始化“管理员”、“代理”和“用户”，因为它们是 3 个不同的模型？

```
class Ability
  def initialize(user)
    user ||= User.new # guest user (not logged in)
    can :read, Photo, Photo.unowned do |photo|
      photo.groups.empty?
    end
  end
end 
```

注意：用户在代理下，代理在管理员下。我需要它们是不同的模型

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T13:43:05.897

好吧，我建议您在“用户”之类的基本模型中定义您的角色。然后使用[它](https://stackoverflow.com/questions/6429725/rails-model-inheritance)来创建用户层次结构。您的模型应该初始化角色。假设您创建了一个用户，那么角色应该类似于 :user。任何尝试执行操作的用户（如果您的控制器定义明确）都将通过“初始化”。

初始化方法不是初始化角色，而是初始化该特定角色的规则。

```
class Ability
   def initialize(user)
      user ||= User.new # guest user (not logged in)

      if user.role == :admin
         can :read, Photo, Photo.unowned do |photo|
           photo.groups.empty?
      elsif user.role == :agent 
         # rules for agents
      else
         # rules for others
      end
  end
end 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T23:02:35.390

您需要的是**嵌套属性**，这将允许您拥有一个单独的用户模型，并为每种类型的用户提供单独的模型（如果您的各种角色在他们需要的信息类型上有很大差异，那就是）。例如，代理可能具有教育、领域或地区以及个人网站属性，而普通用户具有公司、最喜欢的报价等。

用户模型将具有所有角色所需的信息（电子邮件、密码、姓名、角色），而每个角色的模型将具有特定于该角色的信息。**这样，您可以按照 CanCan 的文档进行**授权，但仍然具有特定于角色的信息。

在nested_attributes 上有一个很棒的railscast： [http](http://railscasts.com/episodes/196-nested-model-form-part-1) ://railscasts.com/episodes/196-nested-model-form-part-1 （第 1 部分）和 [http://railscasts.com/episodes/197-nested-model-表格第 2 部分](http://railscasts.com/episodes/197-nested-model-form-part-2)

**注意：**这些 railscast 剧集专门用于制作问答功能，但他们教授的**概念**可以直接应用于您的情况。

# python - 行首的可选匹配

> ID：12610154
> 
> 赞同：0
> 
> 时间：2012-09-26T20:48:05.833
> 
> 标签：python, regex, hashtag

我正在尝试在 Python 中创建一个匹配#hashtags 的正则表达式。我对主题标签的定义是：

*   这是一个从一个开始的作品`#`
*   它可以包含所有字符，除了`[ ,\.]`
*   它可以在文本中的任何位置

所以在本文中

```
#This string cont#ains #four, and #only four #hashtags. 
```

这里的哈希是`This`,`four`和。`only``hashtags`

我遇到的问题是对行首的可选检查。

*   `[ \.,]+`不会这样做，因为它与可选的开头不匹配。
*   `[ \.,]?`不会这样做，因为它匹配太多。

带有 + 的示例

```
In []: re.findall('[ \.,]+#([^ \.,]+)', '#This string cont#ains #four, and #only four #hashtags.')
Out[]: ['four', 'only', 'hashtags'] 
```

示例与？

```
In []: re.findall('[ \.,]?#([^ \.,]+)', '#This string cont#ains #four, and #only four #hashtags.')
Out[]: ['This', 'ains', 'four', 'only', 'hashtags'] 
```

optional 如何匹配行首？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T20:54:37.470

这似乎有效：

```
>>> re.findall(r'\B#([^,\W]+)', '#This string cont#ains #four, and #only four #hashtags.')
['This', 'four', 'only', 'hashtags'] 
```

*   **`\B`**：匹配空字符串，但仅当它不在单词的开头或结尾时。这意味着`r'py\B'`匹配`'python'`, `'py3'`, `'py2'`, 但不匹配`'py'`, `'py.'`, 或`'py!'`。`\B`正好相反`\b`，所以也受制于 和 的`LOCALE`设置`UNICODE`。
*   **`\W`**:未指定`LOCALE`and`UNICODE`标志时，匹配任何非字母数字字符；这相当于 set `[^a-zA-Z0-9_]`。使用 LOCALE，它将匹配任何不在 set 中的字符`[0-9_]`，并且未定义为当前语言环境的字母数字。如果`UNICODE`设置，这将匹配`[0-9_]`Unicode 字符属性数据库中分类为非字母数字的加号以外的任何字符。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:57:17.157

在你的正则表达式之前，你可以告诉你不想要什么。

```
(?<!\w)(#[^ \.,]+) 
```

通过消极的向后看，你可以做到这一点

# objective-c - iOS6 中 NSDateFormatter 的潜在错误。有人遇到过这种情况么？

> ID：12610157
> 
> 赞同：1
> 
> 时间：2012-09-26T20:48:25.740
> 
> 标签：objective-c, date, ios6, nsdateformatter

我们会直截了当。这是代码片段：

```
NSString *dateString = @"4001-01-01T00:00:00.000Z";
NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
NSTimeZone *timeZone = [NSTimeZone timeZoneWithName:@"UTC"];
[dateFormatter setTimeZone:timeZone];
[dateFormatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ss.SSS'Z'"];

NSDate *date = [dateFormatter dateFromString:dateString];
NSLog(@"%@ -- %@", dateString, date); 
```

为 iPhone 5.1 Simulator（或 iOS 5.1 设备）构建时的结果：

```
4001-01-01T00:00:00.000Z -- 4001-01-01 00:00:00 +0000 
```

为 iPhone 6.0 模拟器（或 iOS 6 设备）构建时的结果：

```
4001-01-01T00:00:00.000Z -- 2001-01-01 00:00:00 +0000 
```

注意输出年份的差异（在“--”之后）。

我们已经确定，在 iOS 6 中，日期格式化程序会从 3512 年之后的任何日期（从现在起 1500 年）中减去 2000 年。

有没有其他人经历过这个和/或有一个优雅的解决方法？

谢谢。

# javascript - IGN 门户 IE 与 FireFox 浏览器

> ID：12610158
> 
> 赞同：1
> 
> 时间：2012-09-26T20:48:27.010
> 
> 标签：javascript, coordinates

我对来自法国 IGN 门户的地理地图有疑问。初始化地图是没有问题的。它显示在 IE 浏览器和 Firefox 浏览器中。到目前为止，一切都很好。当必须绘制预定义 Lon/Lat 坐标的路径时会出现问题。`LonLat`坐标必须转换：

```
pt.transform(OpenLayers.Projection.CRS84, getIGNmap().getMap().getProjection()); 
```

此后可以绘制 verctor：

```
vector = new OpenLayers.Geometry.LineString(points); 
```

和：

```
lineLayer.addFeatures(line); 
```

现在的事情：我注意到 FireFox 浏览器分别比 IE 浏览器快得多（100000 Lon/Lat 的循环，以 [ms] 为单位的时间）：

```
 FF     IE9

Transform:    542    4540

Traw:         574    2343 
```

有人有一些澄清吗？

# c# - 有没有办法防止 MS/VS 混合制表符和空格？

> ID：12610160
> 
> 赞同：2
> 
> 时间：2012-09-26T20:48:33.043
> 
> 标签：c#, winforms, visual-studio-2010, code-formatting

每当我必须打开 *.Designer.cs 文件时，我会在顶部看到一个栏，上面写着：“你有混合制表符和空格。修复这个？” 使用以下按钮“Tabify”“Untabify”和“不再显示”

我和下一个人一样对混合制表符和空格感到不安，所以我不想混搭“不再显示”。

但是为什么 MS/VS 首先会导致这种不匹配呢？我当然不会碰这个文件——可以说它是由“工具”生成的。

这是我必须“忍受”的东西还是……？？？

# vb.net - 如何删除超过特定字符长度的所有单词（在输入框中的文本中）？

> ID：12610162
> 
> 赞同：0
> 
> 时间：2012-09-26T20:48:43.853
> 
> 标签：vb.net, visual-studio-2010, character, words

如果我在 VB.Net 2010 (VB 10.0) 中输入文本（可能是通过输入框？），是否可以创建一个程序来删除所有包含超过（例如）4 个字符的单词，只留下我一个、两个或三个字母的单词？

如果是这样，我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:00:12.230

我不使用 VB.Net，但在 C#（即 .net）中，我只会在分隔符上“拆分”文本，然后滚动单词数组，只保留小的单词。

像这样：

```
string text = "this is my test text with some reallllllllly long words";

List<string> outputList = new List<string>();

// and maybe some punctuation chars as well here...
string[] words = text.Split(new char[]{' ','\n','\r','\t'});
foreach (string word in words)
{
    if (word.Length < 4)
        outputList.Add(word);
}

// now outputList == list of small words! 
```

我相信 Split() 有一个参数告诉它忽略空字符串 - 你可能也想要那个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:52:14.783

据我所知，您通常要处理的所有输入形式都将在代码中作为字符串可读。

因此，弄清楚如何获取该字符串，然后弄清楚如何“解析”每个单词。在解析时，您需要选择是保留它还是丢弃它。在进行过程中，您还需要将答案存储在某个地方。

# database - GiST 索引如何真正起作用？

> ID：12610168
> 
> 赞同：4
> 
> 时间：2012-09-26T20:49:30.450
> 
> 标签：database, data-structures, gist

我经常使用 GiST 索引，所以我了解它们的性能特征和它们使用的 API 以及您为什么想要一个。我不明白的是，在幕后，它们究竟是如何工作的？我正在寻找其背后的底层数据结构和算法的解释。

如果我想实现自己的 GiST 索引，我会怎么做？理想情况下，我希望看到我在网上任何地方都找不到的超级简单的非优化版本的示例代码，因为这将帮助我更好地理解它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-22T22:33:47.103

> 如果我想实现自己的 GiST 索引，我会怎么做？

1.  转到[GiST 主页](http://gist.cs.berkeley.edu/)
2.  阅读论文
3.  阅读带有通用搜索树参考实现的[libgist源代码](http://gist.cs.berkeley.edu/libgist-2.0/)
4.  检查相关[软件实用程序](http://gist.cs.berkeley.edu/software.html)以调试和可视化 GiST 索引
5.  设计和开发我们自己的更好和改进的实施

# python - Python file.read() 方法

> ID：12610170
> 
> 赞同：2
> 
> 时间：2012-09-26T20:49:37.740
> 
> 标签：python

我正在使用 Python 逐行读取文本文件。每行的长度可变。第一行可以是 10 个字符，下一行可以是 100 个；没有办法说。目前，我为每一行发出一个 file.readline() 方法，对其进行处理，然后将其保存到数据库中。这种方法可以保证我输入一整行。不过，我想更快地做到这一点。有没有办法使用 Python file.read() 方法进行批量读取，这样当缓冲区停止在一行中间时，我可以保证一个行尾读取字符？处理这个问题的最佳方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T20:51:16.150

处理这些的典型方法是：

```
for line in fileobj:
    process(line) 
```

没有办法实际指定`read`在行尾结束。你可以用`fileobj.seek`. 基本上，您将读取 N 个字节，在返回的字符串中找到最后一个换行符（使用`string.rfind`），您可以向后查找那么多字节。

* * *

当然，如果你有足够的内存，你可以一次读入整个文件：

```
list_of_lines = fileobj.readlines() 
```

* * *

但是，我真的不肯定你会在这里看到任何明显的加速。您确定您没有在需要之前进行优化吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T20:52:52.617

您可以使用 ..

```
lines = file_handle.read().split('\n')
# Or 
lines = file_handle.readlines() 
```

使用 .检查他们的文档以了解准确的行为`'\n'`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-28T14:53:54.003

我搞砸的编码器这样做的方式是读取那里的任何内容或特定的块大小，注意最后一个换行符的位置（.rfind（'\n'）），将数据处理到该换行符，然后从换行符存储到列表中的块的末尾。读取下一个块时，您从与之前停止读取的位置相同的位置读取，并将之前的剩余字符串附加到它上面。性能是合理的，而且很稳定，当然这是针对网络套接字的，你不能向后搜索，我不确定哪种方法实际上对文件的性能更好。

# ruby-on-rails - compass-rails、sass-rails 和 susy 的堆栈级别太深

> ID：12610173
> 
> 赞同：4
> 
> 时间：2012-09-26T20:50:00.793
> 
> 标签：ruby-on-rails, sass, compass-sass, sprockets, susy-compass

我对这个我似乎无法弄清楚的错误感到有点沮丧。我曾经有一个使用 css 文件的 html.erb 文件，但现在我切换到 scss 并添加了 sass-rails、compass-rails 和 susy。当我尝试加载同一页面时，它会生成此错误。

错误：

> 显示 [..]/app/views/layouts/shared.html.erb 其中第 # 行提出：
> 
> 堆栈级别太深
> 
> > （在 [..]/app/assets/stylesheets/sharepage_new/screen.css.scss）

从终端：

> ActionView::Template::Error（堆栈级别太深（在 [..]/app/assets/stylesheets/sharepage_new/screen.css.scss））：sprockets (2.1.3) lib/sprockets/context.rb:180
> 
> 渲染 /Users/me/.rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/_trace.erb (1.0ms) 渲染 /Users/me/ .rvm/gems/ruby-1.9.3-p194/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/_request_and_response.erb (0.7ms) 渲染/Users/me/.rvm/gems/ruby -1.9.3-p194/gems/actionpack-3.2.0/lib/action_dispatch/middleware/templates/rescues/template_error.erb 在救援/布局中（3.5ms）

来自 Gemfile：

```
group :assets do
  gem 'sass-rails',   '~> 3.2.3'
  gem 'coffee-rails', '~> 3.2.1'
  gem 'compass-rails', '>= 1.0.3'
  gem 'susy', git: "git://github.com/ericam/susy.git"
  gem 'uglifier', '>= 1.0.3'
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T06:20:18.147

这不是缩进错误吗？不应该是scss th的问题..

# sql - SQLite：如何优化 UNION 查询

> ID：12610177
> 
> 赞同：0
> 
> 时间：2012-09-26T20:50:14.670
> 
> 标签：sql, sqlite, query-optimization

在下面的 UNION 查询中，子查询 #2 和 #4 是相同的，我想避免两次获取相同的数据。据我所知，有些数据库允许你`WITH`在查询的开头写一个子句，但 SQLite 不支持。所以问题是如何优化下面的查询。

```
 SELECT disliked, recommended, weight
 FROM
   (SELECT movie_id * 10 AS disliked
      FROM ratings
     WHERE rating IN (1,2)
       AND user_id = #{id}
   ) AS input,
   (SELECT movie_id AS recommended, rating AS weight
      FROM ratings
     WHERE rating IN (4,5)
       AND user_id = #{id}
   ) AS output
 UNION
 SELECT liked, recommended, weight
 FROM
   (SELECT movie_id, movie_id * 10 + 1 AS liked
      FROM ratings
     WHERE rating IN (4,5)
       AND user_id = #{id}
   ) AS input,
   (SELECT movie_id AS recommended, rating AS weight
      FROM ratings
     WHERE rating IN (4,5)
       AND user_id = #{id}
   ) AS output
 WHERE input.movie_id != recommended 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:10:53.780

我不完全确定我这么快就读对了你，但可能是这样的：

```
 SELECT
     10*r1.movie_id+(r1.rating IN (4,5)) AS likedisliked,
     r2.movie_id AS recommended,
     r2.rating AS weight
 FROM ratings AS r1, ratings AS r2 
 WHERE r1.user_id=#{id} AND r2.user_id=#{id}
       AND r1.rating IN (1,2,4,5) AND r2.rating IN (4,5)
       AND r1.movie_id!=r2.movie_id; 
```

# jquery - 验证表单的各个部分

> ID：12610179
> 
> 赞同：0
> 
> 时间：2012-09-26T20:50:16.863
> 
> 标签：jquery, html, forms, validation, jquery-validate

我在一个页面上有一个很长的表格，我把它分成几部分。我正在使用 jquery 插件，我想在进入下一个之前验证它的不同部分。这是我的代码：[小提琴](http://jsfiddle.net/XmuG8/1/)

因此，在他们输入所有详细信息之后。我希望它验证它，然后如果它是好的移动到下一页。然后在填写下一页时，我发布所有这些数据。因此，我制作了 1 个表单来包含所有内容，但在表单中有两个 2 div 将其分解为不同的部分。

问题：
由于某种原因，即使我单击提交按钮，它也不会验证表单。因此我无法进入下一页。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:01:20.053

您没有正确的 ID

在你使用的脚本中， `$("#scroll_form")`但在 html 中你有`<form name="everything" id="everything" action="#" method="post">`

您在不存在的表单上设置了点击事件

# python - 计算文件中某个三元组的数量（DNA密码子分析）

> ID：12610184
> 
> 赞同：2
> 
> 时间：2012-09-26T20:50:30.923
> 
> 标签：python, shell, bioinformatics

这个问题实际上是针对 DNA 密码子分析的，简单地说，假设我有一个这样的文件：
atgaaaccaaag...
我想计算这个文件中存在的“aaa”三联体的数量。重要的是，三元组从一开始就开始（这意味着 atg,aaa,cca,aag,...）所以在这个例子中结果应该是 1 而不是 2 'aaa'。
是否有任何 Python 或 Shellscript 方法可以做到这一点？谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T20:55:31.080

首先读入文件

```
with open("some.txt") as f:
    file_data = f.read() 
```

然后把它分成3个

```
codons = [file_data[i:i+3] for i in range(0,len(file_data),3)] 
```

然后数他们

```
print codons.count('aaa') 
```

像这样

```
>>> my_codons = 'atgaaaccaaag'
>>> codons = [my_codons[i:i+3] for i in range(0,len(my_codons),3)]
>>> codons
['atg', 'aaa', 'cca', 'aag']
>>> codons.count('aaa')
1 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T20:58:16.373

显而易见的解决方案是将字符串拆分为 3 个字符的片段，然后计算“aaa”的出现次数：

```
s = 'atgaaaccaaag'
>>> [s[i : i + 3] for i in xrange(0, len(s), 3)].count('aaa')
1 
```

如果字符串真的很长，那么这个解决方案会不必要地消耗一些内存来创建子字符串列表。

```
s = 'atgaaaccaaag'
>>> sum(s[i : i + 3] == 'aaa' for i in xrange(0, len(s), 3))
1
>>> s = 'aaatttaaacaaagg'
>>> sum(s[i : i + 3] == 'aaa' for i in xrange(0, len(s), 3))
2 
```

这使用生成器表达式而不是创建临时列表，因此内存效率更高。它利用了这一事实`True == 1`，即`True + True == 2`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T20:58:32.693

您可以首先使用以下方法将字符串分成三组：

```
def split_by_size(input, length):
    return [input[i:i+length] for i in range(0, len(input), length)]

tripleList = split_by_size(input, length) 
```

然后检查“aaa”，总结一下：

```
print sum(filter(lambda x: x == "aaa", tripleList)) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:56:02.117

使用一个简单的外壳，假设你的 fasta 只包含一个序列。

```
grep -v ">"  < input.fa |
tr -d '\n' |
sed 's/\([ATGCatgcNn]\{3,3\}\)/\1#/g' |
tr "#" "\n" |
awk '(length($1)==3)' |
sort |
uniq -c 
```

# ruby - Perl 和 Ruby 之间的 YAML 数据交换问题

> ID：12610187
> 
> 赞同：6
> 
> 时间：2012-09-26T20:50:38.343
> 
> 标签：ruby, perl, yaml

我在通过 YAML 在 Perl 和 Ruby 之间交换数据时遇到问题。我有一些看起来像 number:number 的值，例如`1:16`.

Perl 的 YAML 库（Tiny 和 XS）将其编码为`1:16`不带引号。Ruby 的 YAML 库 (Psych) 不会将其解释为字符串，而是以某种方式变成了 Fixnum 值`4560`。我无法弄清楚如何在任何一方解决此转换问题。

我的用例的 YAML 中的每个值都应该是一个对象或字符串。因此，如果存在这样的选项，我可以告诉 Perl YAML 库引用所有值。或者有什么方法可以告诉 Ruby YAML 库将所有​​值解释为字符串？有任何想法吗？

从逻辑上讲，更改任何一方的语言都不是一种选择。

珀尔：

```
use YAML::XS qw(DumpFile);
my $foo={'abc'=>'1:16'};
DumpFile('test.yaml',$foo); 
```

红宝石：

```
require('yaml')
foo=YAML.load_file('test.yaml')
puts(foo['abc']) 
```

Ruby 代码将打印`4560`. 其中一条评论弄清楚了您是如何`4560`从`1:16`1 小时 16 分钟转换为秒的。嗯，好吧。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T16:38:56.783

根据[Yaml 1.1 规范](http://yaml.org/spec/1.1/#id858600)，`1:16`是十六进制（以 60 为底）格式的整数。

另请参阅[http://yaml.org/type/int.html](http://yaml.org/type/int.html)，其中说：

> 使用“:”可以表示以 60 为基数的整数，这便于时间和角度值。

Ruby 中包含的 Yaml 解析器 Psych[识别这种格式并将值转换为整数](https://github.com/tenderlove/psych/blob/v1.3.2/lib/psych/scalar_scanner.rb#L68-73)（错误地，`1:16`应该是 71 - Psych 代码似乎假定所有这些值都将采用这种形式`a:b:c`，但正则表达式不会强制执行） . Perl 发射器（至少是我测试过的 YAML::XS）无法识别这种格式，因此在写入文件时不会引用字符串。YAML::XS*确实*识别并引用了一些整数，但不是全部。YAML::XS 也无法识别 Psych 可以识别的许多其他格式（例如日期）。

（看来，六十进制格式[已从 Yaml 1.2 规范中删除](http://www.yaml.org/spec/1.2/spec.html#id2761292)。）

Psych 在解析中提供了相当大的灵活性——`YAML.load_file`只是常见用例的简单接口。

您可以使用`parse`Psych 的方法创建 yaml 的树表示，然后使用自定义`ScalarScanner`（将某些格式的字符串转换为适当的 Ruby 类型的对象）将其转换为 Ruby 数据结构：

```
require('yaml')

class MyScalarScanner < Psych::ScalarScanner
  def tokenize string
    #this is the same regexp as Psych uses to detect base 60 ints:
    return string if string =~ /^[-+]?[0-9][0-9_]*(:[0-5]?[0-9])+$/
    super
  end
end

tree = YAML::parse_file 'test.yaml'
foo = Psych::Visitors::ToRuby.new(MyScalarScanner.new).accept tree 
```

这与您使用 时发生的过程基本相同`YAML.load_file`，只是它使用自定义的扫描仪类。

一种类似的替代方法是开放并用定制的方法`ScalarScanner`替换该方法。`tokenize`这将允许您使用更简单的`load_file`界面，但通常需要注意猴子修补类：

```
class Psych::ScalarScanner
  alias :orig_tokenize :tokenize
  def tokenize string
    return string if string =~ /^[-+]?[0-9][0-9_]*(:[0-5]?[0-9])+$/
    orig_tokenize string
  end
end

foo = YAML.load_file 'test.yaml' 
```

请注意，这些示例仅考虑格式为`1:16`. 根据您的 Perl 程序发出的内容，您可能还需要覆盖其他模式。您可能特别想看的一个是六十进制浮点数（例如`1:16.44`）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T00:00:49.003

您正在使用的解析器中存在错误。似乎认为`1:16`是某种时间（因为 4560 是一小时 16 分钟内的秒数），但我找不到任何可以验证这种解释的东西。

最好的解决方案是使用没有错误的解析器。

*   `libyaml`，由 YAML::XS 使用，据说有 Ruby 绑定。
*   `libsyck`，由 YAML::Syck 使用，据说有 Ruby 绑定。

另一种方法是生成 YAML，其中始终引用字符串（或至少在将它们视为时间时）。

[YAML::Syck](http://search.cpan.org/perldoc?YAML%3a%3aSyck)可以选择这样做。

```
$ perl -e'
   use YAML::Syck qw( Dump );
   local $YAML::Syck::SingleQuote = 1;
   print(Dump({abc=>"1:16"}));
'
--- 
"abc": '1:16' 
```

（不知道我之前是怎么错过这个选项的！）

* * *

## 回答 #3

> 赞同：-4
> 
> 时间：2012-09-26T21:26:44.383

Ruby 将所有 YAML 条目解释为字符串，除非它们适合[少数特殊格式](http://www.yaml.org/YAML_for_ruby.html#basic_types)​​。该条目`1:16`看起来与特殊格式匹配了一段时间，因此 Ruby 错误地解释了它。

您需要强制 Ruby 将该字段解释为字符串。有两种方法可以做到这一点。以下任一 YAML 输出都应为您提供所需的结果：

```
abc: !str 1:16
abc: '1:16' 
```

要生成此输出，请尝试以下 Perl 代码：

```
my $foo={'abc'=>'!str 1:16'};
my $foo={'abc'=>"'1:16'"}; 
```

**更新：** 我能够使用以下代码在 Perl 和 Ruby 之间传递数据：

珀尔：

```
use YAML::XS qw(DumpFile);
my $foo={'abc'=>'1:16'};
DumpFile('test.yaml',$foo); 
```

红宝石：

```
require 'yaml'
foo=YAML.parse_file('test.yaml')
foo['abc'].value
=> "1:16"
foo['abc'].value.class
=> String 
```

结果使用起来比`load_file`返回的简单哈希要复杂一些，但看起来它至少可以按预期解析文件。

# php - 根据窗口大小发送正确大小的图像

> ID：12610188
> 
> 赞同：2
> 
> 时间：2012-09-26T20:50:47.643
> 
> 标签：php, javascript, html, pagespeed

我正在开发一个图像托管网站，主要是为了学习绳索，我正在使用 php 和 mysql，以及 html、css 和 javascript。

实际上，在图像页面上，它会加载全尺寸图像，并将其压缩到布局中的一个框中。我知道那不是正确的做法；我应该发送已经是正确尺寸的图像。但问题来了：调整图像大小以适应的框是基于浏览器窗口的大小。因此，如果页面较大，则图像较大，如果页面较小，则图像较小。

我想到的一种解决方案是以几种不同的大小存储图像，然后在页面上使用 javascript 来确定窗口大小，然后是框的大小，然后使用该信息来选择要加载的正确图像。但是所有这些内联 javascript 似乎也会减慢速度。

什么是最好的解决方案？如果我唯一的目标是速度怎么办？如果我的空间有限，无法存储多种尺寸的图像怎么办？如果我的计算能力有限怎么办？

我正在尝试了解这些东西；不只是实施它。分析各种选项的优柔寡断的答案会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:04:32.793

您应该能够在文档加载之前检测到 JavaScript 中的窗口大小，因此在评估窗口大小然后加载正确的图像（无论如何这将是第二个请求）方面确实不会影响性能。您应该只检查窗口大小，创建一个采用所需图像大小的 PHP 脚本，然后在加载文档后通过将参数附加到`img src`属性来使用它来拉入正确的图像。实际上，无论您如何按照这些方式进行操作，性能影响都将是微不足道的，因为图像默认情况下是不同的请求，这将是您的瓶颈。

如果您的空间有限且图像很多，您可以使用 PHP 为每个请求动态创建图像（调整缓存）。如果您的计算能力有限，您可能希望缓存更多，或者如果您有一小部分可能性，您可以预先制作图像。或者，您可以拥有某些“里程碑”类型的图像，因为具有大方差的图像重新采样通常必须在多次通过中完成，因此每个里程碑可以允许更少的通过次数来采样到所需的确切大小。

如果理论上传输速度是一个主要问题，您还可以使用图像切片。由于大多数客户端将允许 2 个以上的连续连接到同一主机，如果图像足够大以保证它（抵消请求发起的成本），您可以拆分图像，然后在页面上显示合并的部分（有点像多路复用） .

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:57:52.263

好的，所以您要攻击的是速度。学习“完美”的方式也是需要努力的。

一个“完美”的解决方案，将使用各种具有不同比例的图像，如你所描述的，或者使用基于矢量的图像，这些图像不会随比例损失质量。

这更多地涉及应用程序架构。

您首先要学习的是一些基本的 javascript 事件处理程序。

学习动态调整 DOM 元素大小的基础知识是你应该研究的。

如果您要动态调整图像的高度和宽度，您应该研究该`.bind('resize')`事件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T20:58:50.660

我会试试这个：

*   加载一个小图像作为占位符
*   使用 javascript 检测窗口大小
*   进行 ajax 调用以加载更大的版本
*   将该屏幕尺寸保存到 cookie 或会话变量中
*   根据该变量调用以下图像
*   检测调整大小事件并更新该变量

在服务器上，上传时准备好几个尺寸。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-26T21:01:00.580

当您说*大小*时，您是指以像素为单位还是以千字节为单位？

如果以像素为单位，请将您的图像放在一个盒子中并使用 css 来操纵图像大小。将img标签的css属性设置为fluid。使用基于百分比的样式。

例子

```
.img_elem{ width: 100%; } 
```

在 html 中

```
<Div class"what-ever-ur-container-is">
     <Img class"img_elem" src"../path/to/file.jpg" />
</div> 
```

# sql - Oracle RDBMS 记录是否有索引或时间戳，如何获取？

> ID：12610190
> 
> 赞同：2
> 
> 时间：2012-09-26T20:50:59.437
> 
> 标签：sql, database, oracle

我目前正在做一些重新设计工作，因为我现在无法获得有关在印度（外包）建造的内部系统逻辑的信息。

在这个过程中，如果我能够以某种方式确定插入特定表的记录（并可能更新）的顺序，那将真的对我有帮助。由于某种原因，没有添加任何明确揭示这一点的时间戳，所以我正在寻找一些隐藏的 Oracle RDBMS 索引/时间戳以及如何获取它。我猜使用全选返回记录的顺序不是随机的，所以我想一定有某种顺序。

我希望能够在选择中引用此索引/时间戳，以便将其作为记录集中的字段返回。这可能吗，我该怎么做？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:03:20.937

默认情况下，Oracle 不会跟踪此类事情。您将需要某种审计表、表中的列、审计日志等来正确检索此类信息。

假设您使用的是相当新的 Oracle 版本（当然是 10.2 或更高版本），`ORA_ROWSCN`伪列可能足够接近。这是该行上次修改的系统更改号 (SCN) 的上限。但是，除非表是在`ROWDEPENDENCIES`启用的情况下构建的，否则`ORA_ROWSCN`只会在块级别跟踪，而不是在行级别跟踪。如果您假设一个块中的所有行都在大致相同的时间点插入，那么这可能已经足够接近了。当然，这不会是完美的——特别是在从块中删除行并且在更晚的时间点进行后续插入填充`DELETE`操作释放的空间的情况下。但是，如果您碰巧真的很幸运，那么该表是使用`ROWDEPENDENCIES`enabled 和`ORA_ROWSCN`将为您提供上次修改（插入或更新）行的 SCN。

该`SCN_TO_TIMESTAMP`函数可用于将 SCN 转换为时间戳，但只能在相对有限的时间段内（通常是几天）和有限的粒度级别（+/- 5 分钟或 3 秒，具体取决于 Oracle 版本） ）。在大多数使用 的示例中都使用了`ORA_ROWSCN`它，但不幸的是，它可能对您没有太大帮助。

# c# - 模板中的 jQuery 条件加载

> ID：12610193
> 
> 赞同：0
> 
> 时间：2012-09-26T20:51:07.770
> 
> 标签：c#, jquery, asp.net

我想在 Jquery 中有条件地加载我的模板。我现在拥有的：

```
<script type="text/html"​​​​​​​​​​​​​​​​ id="template">
    <div id ="myID" style="background-color: #009ACF">
        <span questionLabelGroup="$i">Question :</span>
        <span questionTextGroup="$i">$textboxText<br /></span>
        <span answerLabelGroup="$i">Answer : </span>
        <input  type='text' questionID="$guid"/>
        {{if buildLinkb("id") == null }}
        <input type='button' Class='addAnswerButton' addQuestionButtonGroup='"$i"' value='Add Question' />
        <hr />
    </div>
        {{/if}}
</script> 
```

其中 buildLinkb("id") 是：

```
function buildLinkb(param) {
    var val = document.URL;
    var url = val.substr(val.indexOf(param))  
    var n=parseInt(url.replace(param+"=",""));
    alert(n+1); 
} 
```

所以发生的事情是，在准备好文档时，我正在将此模板从 ajax 调用加载到服务器。在 url 中有条件地发送 id 参数，如果 id 不存在，我想加载模板的一部分。

有什么办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:00:37.583

在 document.ready 事件中

发送初始 ajax 请求。如果找到，那么您可以将元素附加到您的 div.. 否则什么也不做..

您可以在成功回调函数中实现这一点

# mysql - SQLSTATE[42000]：语法错误或访问冲突：1248 每个派生表都必须有自己的别名

> ID：12610195
> 
> 赞同：0
> 
> 时间：2012-09-26T20:51:09.910
> 
> 标签：mysql

我试图修复这个请求几个小时没有成功，所以我希望你们能帮助我找出问题所在：

```
SELECT ((
    SELECT DISTINCT *
    FROM (
        SELECT REPLACE(source_name, "+", "") AS name
        FROM events
        WHERE source_name!=""
        UNION
        SELECT REPLACE(target_name, "+", "") AS name
        FROM events
        WHERE target_name!=""
    )
) AS player_name,
(
    SELECT COUNT(*)
    FROM events
    WHERE source_name=player_name AND event_name="beforePlayerBan"
) as nbr_bans,
(
    SELECT COUNT(*)
    FROM events
    WHERE source_name=player_name AND event_name="beforePlayerKick"
) as nbr_kicks,
(
    SELECT COUNT(*)
    FROM events
    WHERE
        (source_name=player_name OR target_name=player_name)
        AND event_name="afterBattleStarted"
) as nbr_battles,
(
    SELECT COUNT(*)
    FROM events
    WHERE source_name=player_name AND result=0
) as nbr_wins,
(
    SELECT COUNT(*)
    FROM events
    WHERE target_name=player_name AND result=0
) as nbr_defeats,
(
    SELECT COUNT(*)
    FROM events
    WHERE (source_name=player_name OR target_name=player_name) AND result=1
) as nbr_ties,
(
    SELECT COUNT(*)
    FROM events
    WHERE (source_name=player_name OR target_name=player_name) AND result=2
) as nbr_forfeits 
```

错误是 SQLSTATE[42000]：语法错误或访问冲突：1248 每个派生表都必须有自己的别名，这很奇怪，因为我确实给每个表都赋予了自己的别名

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:01:09.707

您的第一个子查询似乎缺少别名：

```
SELECT ((
       SELECT DISTINCT *
       FROM (
              SELECT REPLACE(source_name, "+", "") AS name
              FROM events
              WHERE source_name!=""
              UNION
              SELECT REPLACE(target_name, "+", "") AS name
              FROM events
              WHERE target_name!=""
    )  myMissingAlias -- alias needed here
) AS player_name, 
```

另外，除非您没有发布完整的查询，否则我认为您可能会错过决赛`)`

# jaxb - 使用 JAXB 解组棘手的 CDATA 元素

> ID：12610198
> 
> 赞同：1
> 
> 时间：2012-09-26T20:51:23.383
> 
> 标签：jaxb, xml-serialization, jaxb2, unmarshalling

我想使用 JAXB 将以下内容解组为“标签”对象。这就是客户将结果传递给我的方式 -

```
<Tag type="a">
    <![CDATA[html text here]]>
</Tag> 
```

请注意，CDATA 直接包装在具有“类型”属性的“标签”内。

我的班级如下：

```
@XmlRootElement(name = "Tag")
public class Tag {

private String type;
private String tag;

public String getTag() {
    return tag;
}

@XmlCDATA
public void setTag(String tag) {
    this.tag = tag;
}

public String getType() {
    return type;
}

@XmlAttribute
public void setType(String type) {
    this.type = type;
}

} 
```

我认为这不是正确的方法，并且正如我解组时所预期的那样，标记对象填充了“类型”，但 CDATA 值没有填充到“标记”中。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:46:49.647

您可以将`@XmlValue`注释添加到标记属性。

# javascript - 简单的javascript制作“添加到购物车”按钮并汇总结果

> ID：12610200
> 
> 赞同：0
> 
> 时间：2012-09-26T20:51:38.350
> 
> 标签：javascript, shopping-cart

我正在尝试创建一个包含项目 A、B、C 和 D 的简单页面。当单击每个项目下方的添加到购物车时，应显示当前总数。如果单击 A 和 B，则总计应将它们加在一起。如果按两次 A，它应该添加它。

我的问题是如何最好地完成按钮以及应该附带什么 Javascript。这些应该是带有“添加到购物车”按钮图像的超链接吗？或者它们应该是 < Input type="button" > 项目吗？

感谢您的任何帮助！

这是非常适用于复选框的代码......我只是希望将其修改为使用“添加到购物车”按钮的图像：

```
<script type="text/javascript">
function TotalCheckedValues() {
var total = 0;
if(document.getElementById("F2").a.checked == true) { total +=     parseFloat(document.getElementById("F2").a.value); }
if(document.getElementById("F2").b.checked == true) { total += parseFloat(document.getElementById("F2").b.value); }
if(document.getElementById("F2").c.checked == true) { total += parseFloat(document.getElementById("F2").c.value); }
if(document.getElementById("F2").d.checked == true) { total += parseFloat(document.getElementById("F2").d.value); }
var ts = new String(total);
if(ts.indexOf('.') < 0) { ts += '.00'; }
if(ts.indexOf('.') == (ts.length - 2)) { ts += '0'; }
document.getElementById("F2").T.value = ts;
document.getElementById("F3").innerHTML = ts;
}

</script>
<form id="F2" onsubmit="return false;">
Which do you want?<br />
<input name="a" onclick="TotalCheckedValues()" type="checkbox" value="10" />New (10.00)<br />
<input name="b" onclick="TotalCheckedValues()" type="checkbox" value="0" />Broken (Free)<br />
<input name="c" onclick="TotalCheckedValues()" type="checkbox" value="55" />Antique (55.00)<br />
<input name="d" onclick="TotalCheckedValues()" type="checkbox" value="4.95" />Refurbished (4.95)<br />
Total: <input name="T" readonly="readonly" size="5" type="text" /><br />
<input onclick="TotalCheckedValues()" type="button" value="Click" />&nbsp;</form> 
```

# swt - SWT - 表格行 - 更改字体颜色

> ID：12610205
> 
> 赞同：1
> 
> 时间：2012-09-26T20:52:08.460
> 
> 标签：swt, tableviewer

是否可以根据其中一列中的值更改行的字体颜色？

我的表有一列显示状态。该列的值将是失败或成功。

如果是成功，我希望该行字体为绿色。如果状态等于失败，我希望行字体为红色。

这可能吗，如果可以，我会把逻辑放在哪里。

**编辑**

这是我的表格查看器代码，我不会显示所有列，只显示几个

```
private void createColumns() {

  String[] titles = { "ItemId", "RevId", "PRL", "Dataset Name", "Printer/Profile" , "Success/Fail" };
  int[] bounds = { 100, 75, 75, 150, 200, 100 };

  TableViewerColumn col = createTableViewerColumn(titles[0], bounds[0], 0);
  col.setLabelProvider(new ColumnLabelProvider() {
     public String getText(Object element) {
        if(element instanceof AplotResultsDataModel.ResultsData) {
           return ((AplotResultsDataModel.ResultsData)element).getItemId();
        }          
        return super.getText(element); 
     }
  }); 

  col = createTableViewerColumn(titles[1], bounds[1], 1);
  col.setLabelProvider(new ColumnLabelProvider() {
     public String getText(Object element) {
        if(element instanceof AplotResultsDataModel.ResultsData) {
           return ((AplotResultsDataModel.ResultsData)element).getRevId();
        }          
        return super.getText(element); 
     }
  });    --ETC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T02:42:55.833

检查元素状态并返回您要使用的颜色

```
Viewer implementation        
    ColumnLabelProvider
        public Color getForeground(Object element) 
```

供餐桌使用

```
TableItem
         setForeground(Color color) 
         setForeground(int index, Color color) 
```

当您`ColumnLabelProvider`对每一列使用时，您需要为每一列覆盖 getForeground(Object element)。另一种方式，不要`ColumnLabelProvider`为每一列添加。

设置`LabelProvider`为`TableViewer`水平。

`TableViewer.setLabelProvider(ColumnLabelProvider labelProvider)`. 由于您没有在列级别设置标签提供程序，因此 tableviewer 从`TableViewer`级别设置的标签提供程序中获取每个单元格的显示文本、图像、字体、背景、前景等。

# haskell - 即时加载 Haskell 插件

> ID：12610208
> 
> 赞同：7
> 
> 时间：2012-09-26T20:52:31.290
> 
> 标签：haskell, llvm

我需要编写一个 Haskell 应用程序来动态加载另一个 Haskell 插件。插件是一个任意源代码，一旦加载它就会运行很长时间，因此在使用之前以某种方式编译它是有益的。我也考虑为此使用 LLVM。我认为这肯定是一个已经解决的问题。如何以稳健的方式做到这一点？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T00:47:54.483

查看`plugins`软件包：[http](http://hackage.haskell.org/package/plugins) ://hackage.haskell.org/package/plugins 。这就是我过去用来动态加载 Haskell 代码的方法。还有[http://hackage.haskell.org/package/plugins-auto](http://hackage.haskell.org/package/plugins-auto)它是一个包装器，`plugins`因此也值得一看。

编辑：如果你想更深入，这里有一篇描述插件包的论文[www.cse.unsw.edu.au/~chak/papers/hs-plugins.ps.gz](http://www.cse.unsw.edu.au/~chak/papers/hs-plugins.ps.gz)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:47:24.933

看看 XMonad。它这样做。[http://xmonad.org](http://xmonad.org)

# css - href 标记之间的目标文本 - CSS

> ID：12610210
> 
> 赞同：0
> 
> 时间：2012-09-26T20:52:41.610
> 
> 标签：css, class, href

我有 5 个`<a>`标签，其中一个类在单词周围放置一个带边框的框。我必须使盒子非常大，并且文本水平居中`text-align: center`但不是垂直居中。

我试过`vertical-align`没有成功。如何定位文本以移动到框的中间？

***HTML***

```
<a href="#" id="someid1" class="someclass">Small</a>
<a href="#" id="someid2" class="someclass">Medium</a>
<a href="#" id="someid3" class="someclass">Large</a> 
```

等等等等

***CSS***

```
#container a.someclass { border:1px #ACACAC solid;text-align:center; } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T20:56:26.807

你的盒子在哪里？您需要将每个“标签”包装在块元素中。一旦它位于块元素内，您就可以使用`vertical-align: middle;`它垂直居中。您还可以使用绝对位置或填充将其垂直居中。

```
<div style="vertical-align: middle;">
<a href="#">text</a>
</div> 
```

此外，该`id`参数是唯一的。这意味着您每页只能使用一次。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:05:17.303

将 设置为与容器`line-height`相同的像素值。`height`没有`padding`必要。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:07:16.690

参数 Rocks（如果您的`line-height`菜单项不多行） - [**DEMO**](http://jsfiddle.net/3xSde/)

```
a.someclass {
    border: 1px #ACACAC solid;
    display: inline-block;
    text-align: center;
    height: 60px;
    line-height: 60px; /* the same as the height */
    width: 150px;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T21:14:14.710

使用 ul 和 li 标签和 line-height 并显示：block

[http://jsfiddle.net/DAKfK/](http://jsfiddle.net/DAKfK/)

# asp.net - 当 Web 服务被自己的服务器调用时，有人窃听它的风险是什么？

> ID：12610217
> 
> 赞同：2
> 
> 时间：2012-09-26T20:53:19.020
> 
> 标签：asp.net, web-services, security

我们公司的网站是由几个.NET 项目组成的，它们都在同一个服务器上，除了ColdFusion 中的大主站点。为了减少代码重复，我们编写了这些项目可以调用基本功能的 Web 服务。例如，我们有一个服务，如果你给它一个用户 ID，你会得到一些关于用户的信息（没有密码，但是像地址之类的东西）。我担心的是有人戳他们的电子鼻子并捕捉到一些我们不希望他们拥有的信息。这是一个有效的问题，还是来自 web 服务的信息会保留在内部，因为它和调用它的项目位于同一台服务器上？

所以我们的 web 服务都像 www.companyname.com/webservices/webserviceuser.asmx 和 .NET web 项目都像 www.companyname.com/admin/project1/ 或 www.companyname.com/edituser/ 因为它们都共享同一个域名，信息会传到一般互联网吗？

是否可以向 web 服务添加安全性以确认调用者是内部应用程序（即使它只是测试调用它的页面的 URL）？

先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:00:16.353

如果您不使用机器公共 ip/名称信息，则不应通过互联网获取。

以下是一些示例代码，您可以如何检查本地请求：

```
 //check if remote access is allowed by app configuration (optional)...
        if (!Services.ConfigObjectsManager.ApplicationGeneral.AllowRemoteAdministration)
        {
            string retaiveUrl = HttpContext.Current.Request.Url.AbsolutePath.Remove(0, appUrl.Length - 1);
            //here I check even for specific page location...
            if (retaiveUrl.ToLower().StartsWith("/adminpages"))
            {
                //check if request is from local machine...
                if (!Request.IsLocal)
                {
                    throw new Exception("Remote administration is not allowed for request '" + 
                        HttpContext.Current.Request.Url.AbsolutePath + "'. Request came from " +
                        Request.ServerVariables["REMOTE_ADDR"]);
                }
            }
        } 
```

您可以对每个服务调用执行此检查。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:53:51.503

看起来域名 www.companyname.com 实际上并不属于您的服务器，而是属于某种负载平衡器、防火墙或代理。网络调用将从您的服务器转到拥有该名称的盒子，然后再返回。您可以通过修改主机文件来欺骗您的服务器，使其相信它实际上拥有该域名，但这可能会破坏其他事情。

如果拥有域名的机器和您的服务器在同一个网络上，那么呼叫将不会离开该网络。除非必须，否则它不会“进入一般互联网”。可以在您的服务器上设置一个路由表，在网络包到达 www.companyname 之前通过代理服务器将网络包发送到其他地方，但这不太可能，除非您的网络拓扑非常特殊。

# api - 谷歌日历 API 和 Coldfusion

> ID：12610220
> 
> 赞同：2
> 
> 时间：2012-09-26T20:53:32.837
> 
> 标签：api, coldfusion, google-calendar-api

我开始研究如何将 Google 日历集成到我使用 Coldfusion 编写的一个项目中。我意识到 Google 在他们的库下载中似乎不支持（我认为这不是正确的词）Coldfusion。我做了一个快速的谷歌搜索，确实遇到了一个有人为了让它工作而做的项目，尽管这只是为了阅读日历。我希望能够添加/编辑/查看事件。

有什么关于如何让它工作的建议吗？我想到了尝试在 .cfm 文件中包含 PHP 页面的愚蠢可能性，但这显然行不通。任何建议将不胜感激，因为我目前不确定如何使其工作。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T21:13:46.050

Ray Camden 已经为您完成了所有工作，并在 RIA Forge 上托管了他的项目

[http://googlecal.riaforge.org/](http://googlecal.riaforge.org/)

# performance - 数据库中的功能测试和遗留代码

> ID：12610224
> 
> 赞同：2
> 
> 时间：2012-09-26T20:53:54.363
> 
> 标签：performance, bdd, functional-testing, acceptance-testing

上下文如下，我们有一个 MVC Web 应用程序，**数据库中有很多遗留代码**。（我们不允许将此代码迁移到服务器端）对于我们的持久性存储，我们使用**存储库**模式。

我们的客户想要向应用程序添加新功能，因此我们显然**在服务器端添加了所有新业务逻辑**。

我们现在遇到的问题是关于我们的功能测试套件，它每天**运行的速度越来越慢。**

主要原因是我们使用 selenium 从浏览器运行测试到数据库（**端到端**）。

我想知道人们是否成功地使用了以下其他策略：

**1.摆脱用户界面**

在控制器级别运行测试，而不必通过浏览器和 Web 服务器。为了弥补通过 UI 进行测试的损失，我们将编写 javascript 单元测试或 MVC 视图单元测试。

**2.摆脱数据库**

编写我们存储库的“InMemory”版本，以便应用程序可以完全在内存中运行，这也应该加快测试套件的速度，因为我们不会撞到磁盘和更少的网络。作为补偿，我们将为我们的数据库存储库编写集成测试。

我认为同时执行**1+2 策略**会产生最大的执行速度，我们将测试真正重要的东西（控制器、业务层、域实体和各种帮助程序作为一个整体）（我认为 UI 和数据库是“细节” ”）。

现在，问题在于，事实上，由于数据库有很多遗留代码，我不知道仅仅依赖于这些东西的集成测试并将数据库排除在功能测试套件之外是否足够安全。我应该把它留在套房里吗？还是很好？

任何经验或建议将不胜感激！

* * *

我的一些发现如下：

*   持续交付书建议这些测试应该始终是端到端的，即使它们很慢（尽管他们也说不是每个人都会同意这一点）
*   据我了解，鲍勃叔叔会同意 1+2 策略，但我不确定他是否会认为使用带有遗留代码的数据库。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-05T14:10:42.040

测试的持续时间越来越长是主要问题。最终它会增长到你必须放弃一些测试的地步。那是一个滑坡。

为了防止这种情况发生，我当然会采取 1+2 的策略，但我也会保持一定数量的端到端测试。

随着您添加越来越多的绕过 UI 和 DB 的测试，您可以开始决定哪些端到端测试是多余的，哪些是测试系统连接正确所必需的。

最后，如果端到端测试是纯粹的管道测试，目标是使用 1+2 策略测试所有业务规则和表示行为。

您的存储过程很复杂。只要您不是数据库代码的更多功能，您就可以管理它。事实上，如果你能逐渐用服务器代码替换一些数据库代码，你会做得更好。一些数据库代码可以在系统的其余部分不存在的情况下进行测试。并且可以模拟一些数据库行为。不幸的是，也可能存在只能端到端测试的行为，因此只要存在遗留数据库代码，您就可能不得不保留这些测试。

这里最重要的因素是慢慢来，避免倒退。不要着手一个巨大的项目来“修复测试”。而是逐步进行渐进式改进。练习“童子军规则”，总是让测试比你找到的更好。永远不要让他们变得更糟。一点一点地，将越来越多的测试转移到策略 1+2 中。一点一点地替换那些你觉得替换的存储过程。逐渐消除最冗余的端到端测试。

# java - 如何限制用户只输入一个整数？

> ID：12610227
> 
> 赞同：1
> 
> 时间：2012-09-26T20:54:09.367
> 
> 标签：java

首先，我想说这是一个家庭作业，我只是在寻找建议。不回答！我非常坚定地学习并擅长编程，这不是来自其他人在做你的工作。指出我正确的方向，我们将不胜感激！

请注意，我已经在互联网上搜索了解决方案，但没有找到适合我需要的解决方案。我无法使用任何高级方法。

该程序允许用户输入范围的开始和结束编号。起始编号必须能被 10 整除，结束编号必须能被 10 整除且与起始编号不同。用户只能使用 0 - 1000 之间的数字，并且不允许在键盘上输入任何其他字符。因此，如果他们点击“a”或“1200”，程序应该循环返回，直到输入了一个有效的条目。

目前我坚持只允许输入一个整数。我的代码的特定部分发布在下面：

```
while(errorLoop != true){
        System.out.println("Enter the Starting Number of the Range (ex. 10,70,100)");
        startNum = kb.nextInt();
        System.out.println("Enter the Ending Number of the Range (ex. 10,70,100)");
        endNum = kb.nextInt();
        if(startNum % 10 == 0 && endNum % 10 == 0){
            errorLoop = true;
        }else{
            errorLoop = false;
            System.out.println("Start and End of range must be divisible by 10\n");
            System.out.println("Please try again (ex. 10,70,100)\n");
        }
    } 
```

我只发布了与问题相关的部分代码。如果您必须知道程序的要点，则数字范围将按质数排序并输出为表格格式，其中每行以可被十整除的数字结尾。非质数将打印为“-”。

前任。71 - 73 - - - - - 79 | 80 \n 并且无论范围多大，它都会继续。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T20:56:11.437

我建议您使用`nextLine()`而不是`nextInt()`. 然后，您可以首先确保它可以解析为 Integer（检查[Integer JavaDoc page](http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html)），然后该数字符合您的要求。

**编辑**
要处理输入不是数字的情况，您可以从几个方向进行。我更喜欢在使用正则表达式进行实际解析调用之前检查输入。A`String`只包含数字会匹配`"^\\d+$"`（查看[此链接](http://www.regular-expressions.info/tutorial.html)以获得出色的正则表达式教程），并且[String API](http://docs.oracle.com/javase/7/docs/api/java/lang/String.html)中有一个方便的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:02:26.980

您始终可以使用正则表达式解析您的输入，以确保它们是数字：

```
int number = Integer.parseInt(kb.nextLine().replaceAll(”[^\\d]“, “”)); 
```

输入：

```
1blahblah2moretext3 
```

生产编号：

```
 123 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:10:03.757

编写一个方法来检查输入的数字是否为数字。

```
 boolean method(String num) {
       boolean retValue;
      try {
        // check out the Integer API for the methods related to parse an int
          retvalue=true;
        }
      catch(ParseException ex) {
         retvalue=false;
      } 
     return retvalue;    
   } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-16T12:58:27.333

尝试在您的程序中使用以下异常，确保使用 InputMismatchException 并导入它。

```
 try {
        System.out.println("Enter the value of a"); 

        int a = scanner.nextInt();

        System.out.println("Enter the value of b"); 
        int b = scanner.nextInt();
        int c = a+b;
        System.out.println("The answer is " +c);
        } 

    catch (InputMismatchException exception) 
    //Add import java.util.InputMismatchException; at the top
        {
        System.out.println("Error - Enter a integer");
        } 
```

# c++ - 如何获取 SaveDialogBox 组合框值

> ID：12610230
> 
> 赞同：0
> 
> 时间：2012-09-26T20:54:29.007
> 
> 标签：c++, file, winapi

如果用户没有这样做，我想设置文件的扩展名并将文件名和扩展组合框字符串连接起来。是否有一些简单的方法可以做到这一点，或者我需要一些“钩子”？

```
 OPENFILENAME ofn;       // common dialog box structure
    TCHAR szFile[260];       // buffer for file name                      
    HANDLE hFile;              // file handle

    // Initialize OPENFILENAME
    ZeroMemory(&ofn, sizeof(ofn));
    ofn.lStructSize = sizeof(ofn);
    ofn.hwndOwner = hwnd;
    ofn.lpstrFile = szFile;
    // Set lpstrFile[0] to '\0' so that GetOpenFileName does not 
    // use the contents of szFile to initialize itself.
    ofn.lpstrFile[0] = 0;
    ofn.nMaxFile = sizeof(szFile);
    ofn.lpstrFilter = _T("Текстові файли(*.txt)\0*.txt\0Word(*.doc)\0*.doc\0");
    ofn.nFilterIndex = 1;
    ofn.lpstrFileTitle = NULL;
    ofn.nMaxFileTitle = 0;
    ofn.lpstrInitialDir = NULL;
    ofn.Flags = OFN_EXPLORER;   

    if(GetSaveFileName(&ofn) == TRUE)
    {
        hFile = CreateFile( szFile,
            GENERIC_WRITE,
            0,
            (LPSECURITY_ATTRIBUTES)NULL,
            CREATE_NEW,
            FILE_ATTRIBUTE_NORMAL,
            (HANDLE)NULL);

        int editLen = Edit_GetTextLength(edit);
        TCHAR* buffer = new TCHAR[editLen+1];
        DWORD wroteLen = 0;

        Edit_GetText(edit,buffer,editLen+1);
        //Set extension if need

        ///////////////////////
        if(!WriteFile(hFile,buffer,editLen*sizeof(TCHAR),&wroteLen,NULL))
            MessageBox(hwnd,_T("File wasn`t saved.."),_T("Error"),MB_ICONERROR);

        CloseHandle(hFile);
        delete[]buffer; 
```

感谢您的回复！))

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:01:58.817

您要设置`lpstrDefExt`成员：

来自[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms646839%28v=vs.85%29.aspx)：

> 类型：LPCTSTR
> 
> 默认扩展名。
> 
> 如果用户未能键入扩展名，GetOpenFileName 和 GetSaveFileName 会将此扩展名附加到文件名中。此字符串可以是任意长度，但仅附加前三个字符。该字符串不应包含句点 (.)。如果此成员为 NULL 并且用户未能键入扩展名，则不会附加任何扩展名。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:41:11.673

`ofn.nFilterIndex`设置为文件扩展名组合框选择的从 1 开始的索引。

# php - 在php中使用正则表达式返回所有hastags？

> ID：12610232
> 
> 赞同：0
> 
> 时间：2012-09-26T20:54:38.130
> 
> 标签：php, regex, hashtag

我的目标是获取一个包含主题标签的字符串并返回所有主题标签。

我的功能：

```
function get_hashtags($text)
{
    preg_match("/(^|\s)#(\w*[a-zA-Z_]+\w*)/", $text, $matches);
    return $matches;

} 
```

目前当我尝试

```
$text = "yay this is #my comment and it's #awesome and cool";
$tag = get_hashtags($text);
print_r($tag); 
```

我得到：数组（ [0] => #my [1] => [2] => my ）

我只想返回一个数组，例如

```
array('tag1', 'tag2', 'tag3'); 
```

没有实际的#

我做错了什么，我该如何解决？

谢谢

编辑：有人发布了一个回答，但它消失了，这正是我想要的，但是现在我得到一个错误，代码：

```
function get_hashtags($text)
{
    $matches = array();
    preg_match_all("/(^|\s)#(\w*[a-zA-Z_]+\w*)/", $text, $matches);
    $result = array();
    foreach ($matches as $match) {
        $result[] = $match[2];
    }
    return $result;

} 
```

错误是：未定义的偏移量：2

我该如何解决？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T21:00:49.830

尝试使用[preg_match_all](http://php.net/manual/en/function.preg-match-all.php)

```
$text = "yay this is #my comment and it's #awesome and cool";
preg_match_all("/(^|\s)#(\w*[a-zA-Z_]+\w*)/", $text, $matches); // updated to use original regex

var_dump($matches[1]); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:00:59.283

`preg_match_all`如果您想要返回所有标签，则需要使用。preg 匹配函数的工作方式尽管它们总是会返回完整的匹配项以及您尝试捕获的内容，因此您将无法`$matches`直接返回。

```
function get_hashtags($text)
{
    preg_match_all("/(^|\s)#(\w*[a-zA-Z_]+\w*)/", $text, $matches);

    return $matches[2];

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:15:58.473

```
preg_match_all('/(?<=\#)[^\s]+/', $text, $matches); 
```

对于`$text`您指定的值，`$matches[0]`将仅包含哈希后的单词，通过使用负向查找来匹配哈希，但将其从结果中排除。

您基本上可以用任何东西替换的部分`[^\s]+`，在本例中，它将匹配任何非空白字符，如果您需要它仅匹配单词字符和下划线，您可以使用 Tim 的示例`[a-zA-Z_]+`

# css - 使用户样式表适用于多个网站 + URL

> ID：12610234
> 
> 赞同：0
> 
> 时间：2012-09-26T20:54:43.080
> 
> 标签：css, firefox, google-chrome, safari, include

有没有办法在自定义 css 样式表中指定某个块，以便浏览器应用于不同的网站或 URL？例如，可以修改 Google Chrome 的 Custom.css 或 Firefox 的 userContent.css 以更改网站的外观，但这些更改将适用于您访问的每个共享相同标签、id、类等的网站。比如包含或其他内容?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T04:36:18.380

对于 Firefox，您可以使用[https://developer.mozilla.org/en-US/docs/CSS/@document](https://developer.mozilla.org/en-US/docs/CSS/@document)执行此操作（目前需要`-moz`前缀，因为它是非标准的）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T20:56:36.783

Chrome 和 Firefox 已将自己的 css 定义为呈现某些页面元素的“默认值”。这是浏览器的一部分，这就是为什么他们可以让它成为全球性的。另一方面，你没有这个特权。

# css - 菜单悬停问题

> ID：12610236
> 
> 赞同：0
> 
> 时间：2012-09-26T20:54:52.643
> 
> 标签：css

使用下面的 CSS，我试图获得悬停效果以省略当前页面，但事实并非如此。

```
#access li:hover  a,
#access ul ul :hover a{
    background: #37617a;
}

#access ul li.current-menu-item  a:hover {
    background:none
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:22:43.167

这可能是您想要的，将#access 作为 ul 的 id。 [jsfiddle测试](http://jsfiddle.net/KYFQg/)

```
#access li:hover a{
    background: #37617a; }

#access li.current-menu-item a{
    background:none } 
```

# c++ - 按类别对 googletest 单元测试进行分组

> ID：12610239
> 
> 赞同：10
> 
> 时间：2012-09-26T20:55:03.937
> 
> 标签：c++, unit-testing, googletest

googletest 单元测试可以按类别分组吗？例如“SlowRunning”、“BugRegression”等。我发现最接近的是 --gtest_filter 选项。通过将类别名称附加/附加到测试或夹具名称中，我可以模拟组的存在。这不允许我创建通常不运行的组。

如果 googletest 中不存在类别，是否有好的或最佳实践解决方法？

编辑：另一种方法是使用 --gtest_also_run_disabled_tests。在测试前添加 DISABLED_ 可以为您提供一个条件类别，但我觉得我在执行此操作时误用了 DISABLED。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T06:51:55.737

一种方法是使用 gtest_filter 选项并使用测试的命名约定（如您所描述的那样）。

```
TEST_F(Foo, SlowRunning_test1) {...}
TEST_F(Foo, BugRegression_test1) {...}
TEST_F(Foo, SlowRunningBugRegression_test1) {...} 
```

其他方式对任何类型的测试使用单独的二进制文件/可执行文件。这种方式有一些限制，因为 gtest 使用静态自动注册，所以如果你包含一些源文件 - 在这个源文件中实现的所有测试都将包含在生成的二进制/可执行文件中。

我认为第一种方法更好。此外，我将实施新的测试注册宏以使我的生活更轻松：

```
#define GROUP_TEST_F(GroupName, TestBase, TestName) \
#ifdef NO_GROUP_TESTS \
   TEST_F(TestBase, TestName) \
#else \
   TEST_F(TestBase, GroupName##_##TestName) \
#endif 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:08:35.173

在单个测试可执行文件中运行测试子集的唯一方法是 --gtest_filter。执行集成测试和单元测试有两种解决方法

1.  使用像 Integration.Testname 和 Unit.Testname 这样的命名约定。除此之外，我还将维护 RunIntegration.bat 和 RunUnit.bat 等脚本文件，以便从我的构建自动化脚本中针对不同的场景运行。
2.  维护集成和单元或其他类别的不同测试可执行文件。在视觉工作室中，每个都有单独的项目。

# jsoup - 使用 Jsoup 解析巨大的 HTML 流

> ID：12610242
> 
> 赞同：5
> 
> 时间：2012-09-26T20:55:17.320
> 
> 标签：jsoup

任何人都可以提供关于我将如何处理解析非常大的 HTML 流/文件的指针或建议。例如，我有一个大约 270,000 行的表，我想一次将它带入我的应用程序中大约 20k。jsoup parse 方法允许 HTML 片段，但我不清楚什么可能是读取代表此片段的 XXX 字节的最有效和最干净的方法。

非常感谢任何帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T20:57:12.300

如果它是 XHTML，并且您不需要一次将整个内容保存在内存中，那么更好的选择可能是使用 SAX 解析器并使用开始和结束标记事件提取您需要的数据。

另一个想法可能是 StAX 解析器。

# dylib - 将 dylib 与应用程序捆绑在一起

> ID：12610247
> 
> 赞同：2
> 
> 时间：2012-09-26T20:55:37.573
> 
> 标签：dylib, xcode4.5

我正在运行 Xcode 4.5 和 MacOS 10.7.4 并尝试为本地分发创建 MacOS 应用程序。

我有一个来自第 3 方 USB 硬件供应商的 dylib。我不想将其放入 /usr/lib 中，而是将其与应用程序捆绑在一起。我已经尝试了这里提到的所有我能找到的方法：

创建一个 Cocoa 库目标，并使用复制构建阶段，使用 @rpath 和 @executable_path 和 @loader_path 设置路径...

这是我遇到的：

如果将 dylib 复制到与目标应用程序相同的目录中（通过将目标设置为“产品目录”），我可以构建目标应用程序以编译和运行，但这仅在应用程序在 Xcode 中运行时才有效。如果我从 finder 运行应用程序，它仍然会在 /usr/lib 中查找 dylib。

更改目标设置时的警告：当您再次更改构建时，不会删除复制到先前构建中某个位置的任何文件。这欺骗了我几次，以为我有解决方案，而我没有。

“库搜索路径”在链接时似乎按预期工作，但设置“动态库安装名称”和“运行路径搜索路径”似乎不会阻止代码仅在运行时查看 /usr/lib。它们似乎根本没有任何作用。

那么，为什么设置这些路径变量没有效果，我该如何设置运行时搜索路径？

# encryption - 客户端加密 - 最佳实践

> ID：12610248
> 
> 赞同：2
> 
> 时间：2012-09-26T20:55:39.910
> 
> 标签：encryption, cryptography, password-protection

不久前，我写了一个“Password Locker”C# 应用程序作为加密练习。我想将数据移动到网络上，这样我就可以在任何地方访问它而不会泄露我的密码数据。我只是想通过社区来运行我的想法，以确保我不会犯错误，因为我不是加密专家。

这是我的设想：

1.  在 C# 应用程序中，所有密码数据都使用用户提供的密码加密为单个文本块。我在 CBC 模式下使用 Rijndael（对称加密）。密码使用硬编码值加盐。
2.  加密数据被发送到我的数据库
3.  我转到我服务器上的网页并下载加密文本。使用客户端 javascript 我输入了我的密码。javascript将解密所有内容（仍然是客户端）

以下是我的假设：

*   我假设所有传输都可以被拦截
*   我假设可以拦截 javascript（包含解密算法和硬编码盐）（因为它实际上只是在网络上）
*   密码**不能**被截取（因为它只是输入客户端）
*   结果是窥探的人可以拥有除密码之外的所有内容。

因此，基于这些假设：我的数据安全吗？我意识到我的数据与密码强度一样安全......我可以做些什么来改进它？Rijndael 解密是否足够慢以防止暴力攻击？

我考虑过使用随机盐值，但这仍然需要传输，因此，它似乎不会更安全。我的偏好是不在网络上以任何形式（散列或其他）存储密码。

**编辑：** 我正在考虑使用 SSL，所以我的“拦截”假设在这种情况下可能无效。

**编辑 2：** 根据 Joachim Isaksson 的评论，我将使用 SSL 运行。请继续打破我的假设！

**编辑 3：** 根据 Nemo 的评论，我将根据每个用户使用盐。此外，我正在使用 PBKDF2 根据密码派生密钥，所以这就是我将获得“缓慢”以抵抗暴力攻击的地方。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:00:06.957

甚至不以任何方式进行加密分析，如果您假设您的所有信息都可以被拦截（即您在没有 SSL 的情况下运行），那么您**就不**安全。

由于任何人都可以拦截 Javascript，因此他们还可以*更改*Javascript 以使浏览器在解密后将明文传递到其他地方。

此外，任何入侵网站的人（或网站所有者）都可以恶意更改 Javascript 以执行相同的操作，即使 SSL 已打开。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:11:39.300

通过“密码数据”，我假设您的意思是“受密码保护的数据”？

盐确实需要是随机的。可以明文传输。盐的目的是防止字典攻击。也就是说，如果有人设法获得您的整个加密数据库，他们可以快速尝试针对您的*所有*用户的大型密码字典。使用随机盐，他们需要针对*每个*用户尝试字典。

或者，即使不损害数据库，他们也可以为大量字典单词生成大量预加密数据，并立即能够识别由任何这些密钥加密的任何已知明文。

即使使用盐，字典攻击也可能比您想要的更快，因此从密码中获取关键数据比大多数人意识到的要微妙得多。

底线：与往常一样，永远不要发明自己的密码学，甚至不要发明自己的操作模式。要从密码中获取加密密钥，请使用众所周知的标准，如[PBKDF2](http://en.wikipedia.org/wiki/PBKDF2)（又名 PKCS#5）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:48:57.710

好吧，因为这是一个悬而未决的问题：

* * *

问题 #1

如果提供的密码不正确，或者盐/密文被更改，你会怎么做？你会得到一个不正确的解密结果，但你将如何测试呢？如果仅更改密文的最后一部分会发生什么？还是完全删除？

解决方案：针对此类攻击提供完整性保护。使用不同的密钥添加 HMAC 或使用 GCM 模式等模式。

* * *

问题 #2

如果更改或添加几个字节到密码会发生什么（及时比较加密存储）？

解决方案：每次使用不同的 IV 加密您的密钥库。

* * *

这已经发现了 4 个问题 :) 密码学很难。

# php - 制作缩略图，但在使用 PNG 时遇到问题

> ID：12610249
> 
> 赞同：0
> 
> 时间：2012-09-26T20:55:55.223
> 
> 标签：php, gd

我正在使用 php 创建缩略图，它适用于 GIF 和 JPEG，但不适用于 PNG。当我使用 PNG 运行此脚本时，不会保存缩略图。你能告诉我我做错了什么吗？提前致谢！

```
public function make_thumbs($img_src)
{
    //Desired thumbnail width 
    $width = 100;
    //Thumbnail name 
    $thumb = 'th_' . $img_src;

    //Ensure the image exists
    if(file_exists($img_src)){

        if (exif_imagetype($img_src) == IMAGETYPE_GIF) 
        {
            //Create image stream 
            $image = imagecreatefromgif($img_src);
        }
        elseif(exif_imagetype($img_src) == IMAGETYPE_JPEG)
        {
            //Create image stream 
            $image = imagecreatefromjpeg($img_src);
        }
        elseif(exif_imagetype($img_src) == IMAGETYPE_PNG)
        {
            //Create image stream 
            $image = imagecreatefrompng($img_src);
        }

        //Gather and store the width and height
        list($image_width, $image_height) = getimagesize($img_src);

        //Calculate new height while maintaining aspect ratio 
        $height = (($width / $image_width) * $image_height);

        //Resample/resize the image 
        $tmp_img = imagecreatetruecolor($width, $height);
        imagecopyresampled($tmp_img, $image, 0, 0, 0, 0, $width, $height, $image_width, $image_height);

        //Attempt to save the new thumbnail 
        if(is_writeable(dirname($thumb)))
        {
            if (exif_imagetype($img_src) == IMAGETYPE_GIF) 
            {
                imagegif($tmp_img, $thumb, 100);
            }
            elseif(exif_imagetype($img_src) == IMAGETYPE_JPEG)
            {
                imagejpeg($tmp_img, $thumb, 100);
            }
            elseif(exif_imagetype($img_src) == IMAGETYPE_PNG)
            {
                imagepng($tmp_img, $thumb, 100);
            }
            }

            //clear memory 
            imagedestroy($tmp_img);
            imagedestroy($image);
        }
        } 
```

# cordova - Sencha Touch 2 App 无法在 iOS6 Simulator 中运行，但可以在 Device 上运行

> ID：12610250
> 
> 赞同：2
> 
> 时间：2012-09-26T20:56:05.683
> 
> 标签：cordova, sencha-touch-2, ios6

我不确定这里的问题是什么，也许有人可以阐明可能发生的事情。我正在开发一个封装在 Phonegap 2.1 中的 Sencha Touch 应用程序。自从更新到 Xcode 4.5 和 iOS6 模拟器后，该应用程序不再加载我的 index.html 中定义的脚本。然而，这些脚本通常直接在 IOS6 设备上运行加载。我还安装了 4.3、5.0 和 5.1 模拟器。唯一能正常工作的模拟器是 5.1 模拟器。关于这里可能发生什么的任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-10T08:52:44.147

在 app.js 中写下这一行，它将在模拟器 6 中运行。

Ext.Viewport.setAutoMaximize(true);

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-21T17:15:24.060

您也可以尝试通过选择 iPhone 模拟器 > 重置内容和设置来重置 iOS 模拟器

# r - 使用 ggsave 打印 .tiff 文件时出现问题

> ID：12610252
> 
> 赞同：0
> 
> 时间：2012-09-26T20:56:09.060
> 
> 标签：r, macos, ggplot2, tiff

我正在尝试打印 .tiff 文件并收到错误，这是一个示例：

```
ratings <- qplot(rating, data=movies, geom="histogram")
qplot(length, data=movies, geom="histogram")
ggsave(file="length-hist.tiff") 
```

此代码产生此错误：

```
Saving 7 x 7 in image
Error in grDevices::tiff(..., width = width, height = height, res = dpi,  : 
  argument "antialias" is missing, with no default 
```

我究竟做错了什么？我正在为 Mac OS X Leopard 和 ggplot 0.9.0 使用 R 版本 2.15.0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T06:18:23.097

在 Linux 上使用 ggplot2 0.9.1 和 R 版本 2.14.1，您的代码可以正常工作，我无法重现此问题。也许您应该尝试更新ggplot2？

# java - 将 Java 安全属性设置为 null

> ID：12610255
> 
> 赞同：2
> 
> 时间：2012-09-26T20:56:22.673
> 
> 标签：java, security, properties

我已经看到可以使用`System.clearProperty("propertyName")`. 但是，我无法找到类似的安全机制。

一个人如何执行相当于`Security.clearProperty("propertyName")`？

显然， using`Security.setProperty("propertyName", null)`不起作用的原因与它不起作用的原因相同`System.setProperty("propertyName", null)`。

我想这样做，因为当需要的属性发生变化时，可能不会更新可选的安全属性。我希望在对所需属性进行更改时将可选属性重置为其默认值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:36:33.827

道歉重新调查了这个我相信

```
System.clearProperty 
```

不适用于**安全**属性。我不确定如何以编程方式执行此操作，但是您可以在其中创建一个包含所需设置的新安全策略文件并使用它：

```
Djava.security.manager -Djava.security.policy=/path/to/new/policy_file 
```

# javascript - 什么是直接参考？

> ID：12610265
> 
> 赞同：7
> 
> 时间：2012-09-26T20:56:42.617
> 
> 标签：javascript, reference, theory

严格模式规则之一（[附件 C](http://ecma-international.org/ecma-262/5.1/#sec-C)）规定：

> 当`delete`运算符出现在严格模式代码中时，如果其*UnaryExpression*是对变量、函数参数或函数名称的直接引用，则会引发**SyntaxError 。**

 *所以在这段代码中：

```
delete x 
```

`x`是参考。（我知道这一点是因为[“评估标识符的结果始终是引用类型的值”](http://ecma-international.org/ecma-262/5.1/#sec-11.1.2)）。但它是*直接*参考吗？

而且，还有其他类型的参考吗？间接引用？（如果不是，那么使用“直接”这个词有什么意义？）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:01:28.493

是的，有不同的类型`References`（[EcmaScript §8.7](http://ecma-international.org/ecma-262/5.1/#sec-8.7)）。例如，成员运算符（[EcmaScript §11.2.1](http://ecma-international.org/ecma-262/5.1/#sec-11.2.1)）确实会导致引用其*基值*是 的值`baseReference`，我称之为“非直接”。“直接引用”将是标识符引用（[EcmaScript §10.2.2.1](http://ecma-international.org/ecma-262/5.1/#sec-10.2.2.1)，其中基值是环境记录。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:24:11.997

如果我理解正确，任何未定义为属性的东西。

这些应该在控制台中抛出错误或失败：

```
(function(){ 'use strict'; var x = '2'; delete x; })();
(function(){ 'use strict'; delete arguments[0]; })('2'); 
```*

# android - 使用 REST 发送和接收复杂数据

> ID：12610269
> 
> 赞同：1
> 
> 时间：2012-09-26T20:56:49.643
> 
> 标签：android, json, rest, asp.net-web-api

我的客户端是一个 Android 应用程序，我的服务是一个 asp.net web api。我是唯一一个使用我的服务的人。我试图在 Android-REST 世界中复制我在 Microsoft Windows Phone 7/WCF SOAP 世界中已经在做的事情。我有许多接收复杂对象和返回复杂对象的方法。

WCF-SOAP 世界很简单。您可以传递您想要的任何复杂参数并返回您想要的任何复杂结果。从逻辑上讲，它只是一个远程过程调用。

但是当我发布有关在 REST 中做同样事情的问题时，我被告知我应该将我的服务限制为 GET、PUT、POST 和 DELETE。根据 RFC2616，我应该只做“正确”的事情。有些人几乎以宗教的方式谈论这件事。

忘记宗教，对所有事情都使用 GET 有什么问题？或者对所有事情都使用 POST 有什么问题？我所做的不属于简单的 RFC2616 类别。例如，我正在通过一千条腿的汽车旅行，并且我正在返回该旅行的另一个版本，并消除了不稳定的 GPS 错误。或者，我用英语发送对话，然后用德语恢复对话。

在 android 客户端中，我想通过 HTTP 发送的对象已经使用 Google-GSON 序列化为 json 字符串。所以我的问题是……</p>

如何将这些 json 字符串作为 GET 或 POST 中的参数发送到我的 REST 服务？

对我的 REST 服务的所有调用仅使用所有 GET（或所有 POST）是否可能且可行，我该怎么做？

[我在在 http url](https://stackoverflow.com/questions/12592928/sending-a-json-string-in-a-http-url)中发送 json 字符串时发布了一个更实用的问题，因为我在任何地方都找不到通过 http GET 或 POST 发送 json 字符串的任何示例。

谢谢，加里

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-18T10:48:34.050

使用良好的 HTTP 动词非常有用，可以简单地知道在请求失败时（例如）要做什么，或者只是做一些特定的事情。如果您发送 POST 请求，则隐含地假设您必须解析资源才能获得通过请求正文发送的流。另一方面，当您通过 GET 检索数据时，假设请求将作为流发送回您，您将映射到您的模型、pojo 或其他任何东西。

我可以建议您使用诸如[RESTDroid 之](https://github.com/PCreations/RESTDroid)类的库。您可以发送 POJO 和接收 POJO。它是一个“面向资源”的库，因此您可以随时了解特定本地资源是否被远程同步。本地和远程之间的数据持久性是自动处理的。

RESTDroid 是 alpha 版本。你可以看看[RoboSpice](https://github.com/octo-online/robospice)。它是一个强大的库来管理 REST 调用，但由您来管理本地和远程资源之间的持久性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T11:01:44.540

1) WCF-SOAP 世界很简单。您可以传递您想要的任何复杂参数并返回您想要的任何复杂结果。从逻辑上讲，它只是一个远程过程调用。- 在 REST 中：“您可以传递您想要的任何复杂参数并返回您想要的任何复杂结果。

2a）忘记宗教，对所有事情都使用 GET 有什么问题？在 SOAP 服务 WCF/或经典中，您将所有请求包装到 http POST 中，因此使用单个动词最终会使用 SOAP，或者 - 甚至不要考虑 - 您自己的通信协议：-D

2b）您可以在技术上使用非空正文编写 GET 请求 - 大多数服务器默认情况下会忽略它，但阅读它在技术上会出现问题..

问题的另一部分由上面的[Pcriulan](https://stackoverflow.com/users/1836434/pcriulan)回答

# asp.net-mvc - 用伪隐藏字段模仿 asp.net mvc 中的视图状态

> ID：12610272
> 
> 赞同：0
> 
> 时间：2012-09-26T20:57:03.080
> 
> 标签：asp.net-mvc

我有一个模板应用程序区域，用户可以在其中加载模板。

一个模板可以有多个单元。

单位显示在树形控件中。

虽然用户可以将孩子/兄弟姐妹等单位添加到单位树中，但我需要知道

templateId 当我调用

```
 unitService.AddUnit(string unitName,int templateId); 
```

我的想法是打开模板时我将 templateId 临时保存在 DIV 中

(display:none) 在 template_application_area 中，所以我可以在执行我的操作时获取 templateId

jquery.ajax addUnit(..) 调用。

您如何看待 asp.net mvc 应用程序中的这种“隐藏字段”？

我的方法很好还是有更好的方法？

# objective-c - 如何在 UITextView 中处理点击而不丢失默认点击句柄事件

> ID：12610273
> 
> 赞同：1
> 
> 时间：2012-09-26T20:57:03.780
> 
> 标签：objective-c, uitextview, uitapgesturerecognizer

我正在使用 TapGestureRecognizer 来拦截 UITextView 上的单击。但是，此单击使默认单击事件不会发生。通常，如果没有我插入的个性化手势识别器，默认点击会使键盘出现或菜单（剪切/复制/粘贴/...）出现，具体取决于具体情况。

我已经看到一些应用程序，其中除了默认事件之外，在 UITextView 中点击后还会触发一个事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:02:07.283

只需添加`[textField becomeFirstResponder]`到您的自定义逻辑。这将打开文本字段的键盘，就像正常点击它时一样。

# qt - Qt HTTP GET 冻结屏幕

> ID：12610277
> 
> 赞同：0
> 
> 时间：2012-09-26T20:57:24.940
> 
> 标签：qt, http, networking, request

我正在编写一个 Qt 程序来从站点获取图像并插入 QLabel。当我发送我的请求时，我的屏幕冻结了，没有任何事情发生。请注意，我是 Qt 的新手。

根据我对 Qt 的初步了解，下载完成时发送一个信号就足够了。

```
...

MapReader::MapReader(QWidget *parent, Qt::WFlags flags)
    : QMainWindow(parent, flags)
{
    ui.setupUi(this);
    imageLabelMap = ui.imageMap;
    getImageButton = ui.getImageButton;
    networkManager = new QNetworkAccessManager(this);
    setup();
}

MapReader::~MapReader()
{
}

void MapReader::setup()
{
    QObject::connect(getImageButton, SIGNAL(clicked()), this, SLOT(triggerDownload()));
    QObject::connect(networkManager, SIGNAL(finished(QNetworkReply*)), this, SLOT(finishedDownload(QNetworkReply*)));
}

void MapReader::setImage(QByteArray imageBytes)
{
    QImage map;
    ...
}

void MapReader::triggerDownload()
{   
    QUrl url("http://images.tsn.ca/images/stories/2012/09/26/terrydunfield_2035-430x298.jpg");
    QNetworkReply* reply = networkManager->get(QNetworkRequest(url));
    QObject::connect(reply, SIGNAL(readyRead()), &loop, SLOT(quit()));
}

void MapReader::finishedDownload(QNetworkReply* reply)
{
    reply->deleteLater();
    QVariant statusCodeV = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);
    QVariant redirectionTargetUrl = reply->attribute(QNetworkRequest::RedirectionTargetAttribute);

    if(reply->error() != QNetworkReply::NoError)
    {
        QMessageBox msgBox;
        msgBox.setWindowTitle("Error");
        msgBox.setInformativeText("Error on downloading file: \n"+reply->errorString());
        msgBox.exec();
        return;
    }
    QVariant attribute = reply->attribute(QNetworkRequest::RedirectionTargetAttribute);
    if (attribute.isValid())
    {
        QUrl url = attribute.toUrl();
        qDebug() << "must go to:" << url;
        return;
    }

    setImage(reply->readAll());
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:43:39.310

我认为缺少一些代码可能会给我们提供线索。你有

```
QObject::connect(reply, SIGNAL(readyRead()), &loop, SLOT(quit())); 
```

但我没有看到循环在哪里定义？听起来您正在运行一个额外的事件循环？

无论如何，你不需要那个。这应该很简单：

```
void MapReader::triggerDownload()
{   
    QUrl url("http://images.tsn.ca/images/stories/2012/09/26/terrydunfield_2035-430x298.jpg");
    QNetworkReply* reply = networkManager->get(QNetworkRequest(url));
    QObject::connect(reply, SIGNAL(finished()), this, SLOT(finishedDownload()));
}

void MapReader::finishedDownload()
{
    QNetworkReply *reply = qobject_cast<QNetworkReply *>(sender()); // sender() allows us to see who triggered this slot - in this case the QNetworkReply

    QVariant statusCodeV = reply->attribute(QNetworkRequest::HttpStatusCodeAttribute);
    QVariant redirectionTargetUrl = reply->attribute(QNetworkRequest::RedirectionTargetAttribute);

    if(reply->error() != QNetworkReply::NoError)
    {
        QMessageBox msgBox;
        msgBox.setWindowTitle("Error");
        msgBox.setInformativeText("Error on downloading file: \n"+reply->errorString());
        msgBox.exec();
        return;
    }
    QVariant attribute = reply->attribute(QNetworkRequest::RedirectionTargetAttribute);
    if (attribute.isValid())
    {
        QUrl url = attribute.toUrl();
        qDebug() << "must go to:" << url;
        return;
    }

    setImage(reply->readAll());
    reply->deleteLater();
} 
```

确保您已将 finishedDownload() 定义为头文件中的插槽

# ios - iOS：点击 UITableView 不会调用 didSelectRowAtIndexPath

> ID：12610285
> 
> 赞同：16
> 
> 时间：2012-09-26T20:58:16.117
> 
> 标签：ios, ipad, uitableview, ios6

当点击表格的一行时，我的应用程序使用 a`UITableView`来`UINavigationController`显示更详细的视图 - 基本的向下钻取例程。

当我点击一行时，它会突出显示，但不会调用委托方法`tableView:willSelectRowAtIndexPath:`（`tableView:didSelectRowAtIndexPath:`使用调试器验证）。

现在这是奇怪的部分：

1.  应用程序中还有其他一些表格视图（它们不会向下钻取），它们都没有出现问题。

2.  如果我快速反复点击该行，经过多次尝试（10 - 20 次是正常的），`tableView:willSelectRowAtIndexPath:`并且`tableView:didSelectRowAtIndexPath:` **被**调用并且处理正常继续。

3.  该问题*仅*发生在运行 iOS 6 的（实际上是任何）iPad 上。它适用于运行 iOS 5 的 iPad，或运行任何 iOS 版本 6 的任何 iPhone。它也适用于使用 iOS 5 或 6 的 iPad 模拟器。

因此，在调用委托方法之前，似乎有些东西正在接收点击。但是什么？

我没有使用任何`UITapGestureRecognizer`，所以[这不是问题](https://stackoverflow.com/questions/8952688/didselectrowatindexpath-not-being-called)。我没有使用多个`UITableViewControllers`表，所以[这也不是问题](https://stackoverflow.com/questions/2305781/iphone-didselectrowatindexpath-not-invoked)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-24T17:46:52.440

在 iOS6 中运行时，我遇到了一个应用程序的问题。该`tableView:didSelectRowAtIndexPath:`方法从未被触发，即使它在更新到 iOS6 之前正在工作。

**我终于通过查看 xib 和表的属性检查**器弄清楚了。在表格视图部分中，我将**选择**选项设置为**无选择**，并且未选择**触摸**时显示选择。

**将选择**选项更改为**单个选择**实际上会再次为我工作，并将**显示选择触摸**未选择意味着在选择行时，我没有看到任何闪存或更改颜色。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-10-01T17:38:22.503

我遇到了类似的问题。`iOS 6`似乎对点击表格视图单元格上最轻微的向上移动更加敏感。它似乎将最轻微的移动注册为滚动请求而不是单元格选择。我的表格视图被设置为，`scrollEnabled = NO`因为它是一个带有静态选择值的表格视图。表格视图出现在较大 iPad 视图的一小块区域内。如果我小心地轻敲一个单元格并直接向上提起，则该单元格被选中。

为了解决这个问题，我更改`scrollEnabled`为`YES`并确保我的 tableView 专用区域大于显示 table view 所需的实际区域，从而防止它滚动。不确定这是否是您遇到问题的原因，但希望对您有所帮助。

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-20T16:51:53.267

我有同样的问题。UITableView 在 iOS6 中运行时没有触发该`didSelectRowAtIndexPath`方法，但在 iOS5.1 中运行良好。

我还实施了

```
- (BOOL)tableView:(UITableView *)tableView shouldHighlightRowAtIndexPath:(NSIndexPath *)indexPath{
    return NO;
} 
```

并返回 NO。在 iOS5 中一切正常，但在我切换到 iOS6 的那一刻，它将停止触发`didSelectRowAtIndexPath`. 一旦我删除了该`shouldHighlightRow`方法，一切都在 iOS6 中再次运行。干杯!

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-07-08T14:51:40.393

`didSeletRowAtIndexPath()`没有被调用的通常原因是`UITapGestureRecognizer`在您的视图控制器上有一个`Cancels touches`in 视图设置为`YES`.

正确且唯一明智的解决方法是将`Cancels touches`视图设置为`NO`. 然后您的表格行选择应该可以很好地工作。

显然，这对您的手势处理程序有一些影响 - 您可能需要向您的手势处理程序添加一些代码以阻止对您的视图进行一些触摸，即

```
- (IBAction)onTapGesture:(UITapGestureRecognizer *)sender {

    if (sender.view == someOldViewThatINeedToDealWith) {
        sender.cancelsTouchesInView = true;
    }
} 
```

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2013-09-30T17:56:24.473

我尝试了所有其他发布的答案，虽然它们看起来很有希望，但它们并没有解决问题。

从那以后，我发现了问题的原因：我正在调用`[self.tableView reloadData]`另一个线程（由于处理从后台工作线程发布的 NSNotification 事件）。

我通过更改`[self.tableView reloadData]`为解决了问题

```
[self.tableView performSelectorOnMainThread:@selector(reloadData) withObject:nil waitUntilDone:NO]; 
```

希望这可以帮助。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-21T06:59:53.137

另一个嫌疑人可能是一个 Tap Gesture Recognizer 设置为视图控制器的视图，像黑洞一样吞噬所有的水龙头。移除手势识别器将启用确实选择。我只是遇到了同样的问题，点击手势是原因。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2012-10-31T21:04:20.870

分辨率真的很奇怪：为*所有*通知注册的 UITableViewController。在通知的处理程序中，正在使用重新加载表视图数据

```
[self.tableView reloadData] 
```

根据Apple DTS，当表重新加载数据时，这会导致向观察者发送通知，从而导致竞争条件......

没有解释为什么它有时会工作或为什么它总是在 iPhone 上工作。但是*只*注册一小部分通知（即我真正感兴趣的通知）解决了这个问题！

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2018-02-01T11:59:01.423

环境

```
recognizer.cancelsTouchesInView = NO; 
```

如果您的用例允许通过 [tap] 手势识别器（例如 kdb 关闭）和识别器附加到的视图同时处理触摸，则会处理它。

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2014-07-25T11:05:23.553

在我的情况下，我有一个在 tableviewcell 之前收到所有触摸事件的按钮

# java - java条件快捷方式

> ID：12610286
> 
> 赞同：2
> 
> 时间：2012-09-26T20:58:31.797
> 
> 标签：java, null

> **可能重复：**
> [如何在 Java 中获取第一个非空值？](https://stackoverflow.com/questions/2768054/how-to-get-the-first-non-null-value-in-java)

我有以下操作

```
function1(function2(param1,param2)); 
```

如果 function2 返回`null`，我希望将其替换为零。我可以通过多种方式做到这一点，但有一些快捷方式吗？例如，是否有任何类似的内容

```
function1(function2(param1,param2)==null || "0") 
```

**注意**：函数 2 返回一个字符串。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:24:16.143

在切换到[Guava](http://code.google.com/p/guava-libraries/wiki/GuavaExplained)之前，我发现自己为每个正在进行的项目编写了下面的函数。它可能已经在某个库中实现了。

```
<T> public static T coalesce(T... elements){
    for(T element : elements) {
        if (element != null) return element;
    }
    throw new NoSuchElementException();
}

// Usage:

function1(coalesce(function2(param1,param2), "default value")); 
```

这很好，因为没有重复的代码，并且您不必在引入临时变量或执行两次相同的调用之间做出选择（就像之前建议的条件运算符一样）。这不好，因为它读起来不是很流利。

如果你正在使用 Guava（你应该是），你可以使用[`Optional`](http://docs.guava-libraries.googlecode.com/git-history/release/javadoc/com/google/common/base/Optional.html)to [Avoid`null`](http://code.google.com/p/guava-libraries/wiki/UsingAndAvoidingNullExplained)，它还有一个好处是让你的 API 更清晰，更不容易出现`NullPointerException`s。

```
void function1(String arg) {}
Optional<String> function2(){ /* insert code*/ }

// Usage:
function1(function2().or("default value")); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T20:59:43.630

当然，有一个*三元运算符*几乎可以做到这一点：

```
<expression> ? <value if expression is true> : <value if expression is false> 
```

所以，

```
String result = function2(param1,param2);
function1(result != null ? result : "0"); 
```

会做你想做的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:00:17.567

怎么样

```
function1(function2(param1,param2) != null? function2(param1, param2): 0); 
```

顺便说一句，如果 function2 没有对任何数据进行任何永久性更改，您只能使用它，因为它被调用了两次，如果确实如此，那么您第二次可能会得到不同的答案。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:25:25.867

将表达式条件`?`与赋值一起使用

```
Integer value = function1((value=function2(param1,param2)) != null? value: 0); 
```

# php - 通过 html 表单保存到 MySQL 数据库

> ID：12610288
> 
> 赞同：1
> 
> 时间：2012-09-26T20:58:36.870
> 
> 标签：php, mysql, database, forms, mysqli

我正在制作一个 php 页面，该页面从数据库表中检索数据并将其放入表中供用户通过 MySQLi 命令查看。

我想知道我应该如何处理相反的情况。我希望用户能够在文本框中输入信息，然后单击页面底部的“保存”按钮，该按钮将在保存到数据库之前提示用户“您确定”。如果用户单击“是”，则将新条目插入数据库。

我有以下代码来创建标签和文本框：

```
<FORM>
ID: <input type="text" name="id"><br />
NM: <input type="text" name="nm"><br />
Company: <input type="text" name="company"><br />
Address: <input type="text" name="address"><br />
City: <input type="text" name="city"><br />
Zip: <input type="text" name="zip"><br />
State: <input type="text" name="state"><br />
Phone: <input type="text" name="phone"><br />
Website: <input type="text" name="web_site"><br />
</FORM> 
```

但是，当涉及到“保存”按钮时，我可以很好地实现该按钮，但是我将如何保存输入到数据库中的信息呢？

我最初的想法是找到用户输入的值。一般来说，我是 PHP 和 WEB 开发的新手，但我需要知道如何获取文本框中文本的值。我是否必须通过 PHP Post 方法筛选所有值？

一旦我有了用户想要输入的信息，我想也许 MySQLi 有一个插入功能，我在这里找到了，[http](http://php.net/manual/en/mysqli.insert-id.php) ://php.net/manual/en/mysqli.insert-id.php 。然后它只是一个快速插入，在用户在提示符下给出“是”后它就在数据库中。

我有正确的想法吗？有没有更有效的方法来做到这一点？

任何帮助是极大的赞赏。我四处寻找与我的场景相关的问题和解决方案，但没有。=(

谢谢！

编辑：

这是我在 agentprocess.php 上的代码，操作表单将信息发送到：

```
<?php
$agent_nm = $_POST['nm']; // gather all the variables
$company = $_POST['company'];
$address = $_POST['address'];
$city = $_POST['city'];
$zip = $_POST['zip'];
$state = $_POST['state'];
$phone = $_POST['phone'];
$web_site = $_POST['web_site'];
$batch_id = $_POST['batch_id']; // added batch id
//connect
$conn = new mysqli('local', 'admin', 'pass', 'DB');
    if(mysqli_connect_errno()) {
        exit('Connect failed: '. mysqli_connect_error());
    }
//generate the query (doesn't add id because id is autoincremented)
$query = "INSERT INTO t_agent VALUES (NULL, " . $agent_nm . ", " . $company . ", " . $address . ", " . $city . ", " . $zip . ", " . $state . ", " . $phone . ", " . $web_site . ", " . $batch_id . ")";

//insert and close.
mysqli_query($conn, $query);
mysqli_close($conn); 
```

尽管这里有代码，但我已经查询了表格并且新条目不存在。我在这里错过了什么吗？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T00:39:55.133

您应该为 PHP/MySQL 使用 PDO 函数

id 字段应该是自动递增的

```
<?php
$host= "xxx";
$username="xxx";
$password="xxx";
$database="xxx ";

// Gets data from URL parameters

$name = $_POST['nm'];
//Repeate for all other parameters

// Opens a connection to a MySQL server
try {

// DBH means "DB Handle"

// MySQL with PDO_MYSQL
 $DBH = new PDO("mysql:host=$host;dbname=$database", $username, $password);

}
catch(PDOException $e) {
    echo $e->getMessage();
}
// STH means "Statement Handle"
$STH = $DBH->prepare("INSERT INTO mytable ( id,    nm,company,address,city,zip,state,phone,web_site ) values ( NULL,:nm,:company,:address,:city,:zip,:state,:phone,:web_site)");
$STH->bindParam(':name', $name);
//Repeate for all other parameters
$STH->execute();

//# close the connection
$DBH = null;
?> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:02:02.940

你需要使用`forms`. 是的，使用`name`元素中的属性，您可以筛选`$_POST`（例如`$_POST['company']`）要存储到数据库中的值。这是一个[例子](http://teamtutorials.com/web-development-tutorials/php-tutorials/inserting-data-into-a-mysql-database-using-php#.UGNtBP_A9dI)。使用 MYSQLi 语句而不是 mysql，如在例如。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:53:16.253

对于 Web 开发初学者来说，这是一个简单但又有点复杂的任务。

所以我会给你一个完整的例子，说明你需要做什么......

要进行保存按钮检查，最快的方法是使用 javascript 确认对话框，如果确认也使用 javascript 提交表单。

Mysql 插入部分很简单，您需要检查是否有通过 $_REQUSET 中的表单提交的数据（这比 $_POST 或 $_GET 更好，因为它可以同时捕获它们。）然后连接到 db 并进行插入询问...

这个例子解释了一切：

[http://pastebin.com/thNmsXvn](http://pastebin.com/thNmsXvn)

**但是请使用 Smarty 之类的模板引擎，因为在没有模板的情况下在一个文件中执行 php、javascript 和 html 是很糟糕的，而且长期只会给您带来问题。**

我认为我在使用 pastebin 的示例中非常清楚，但如果您有任何问题，请随时提出......

补充一点，我已经从 HTML 表单中删除了 ID，因为在 MySQL 中管理 ID 的最佳解决方案是自动增量选项，您可以在创建表并将其设置为特定字段时对其进行配置。通常它是 ID，它必须是一个整数。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-09-26T21:17:18.077

非常简单的示例，将标签标签添加到您输入的标签中并将其放入表单中。

```
<form method="post" action="process.php" id="myForm" name="myForm" >
<label for="ID">ID</label>:  <input type="text" name="ID" /><br />
<label for="nm">NM:</label> <input type="text" name="nm"><br />
<label for="company">Company:</label> <input type="text" name="company"><br />
<label for="address">Address:</label> <input type="text" name="address"><br />
<label for="city">City</label>: <input type="text" name="city"><br />
<label for="zip">Zip</label>: <input type="text" name="zip"><br />
<label for="state">State</label>: <input type="text" name="state"><br />
<label for="phone">Phone</label>: <input type="text" name="phone"><br />
<label for="web_site">Website</label>: <input type="text" name="web_site"><br />
<input type="submit" name="submit" />// this is your submit button
</form> 
```

在 process.php 页面上

```
//get your inputs from the form
$ID = $_POST['ID']; 
//do the same for each of the text inputs 
```

然后您可以按照您的描述使用 mysqli 将值插入到数据库中，如果您在问题的 mysqli 部分需要任何帮助，请随时发表评论，因为您在原始问题中发布了链接，所以我没有在此处包含它.

# jquery - Bootstrap Carousel - 改变循环方向

> ID：12610291
> 
> 赞同：4
> 
> 时间：2012-09-26T20:59:13.713
> 
> 标签：jquery, twitter, twitter-bootstrap, carousel

是否可以更改 Twitter 引导轮播的循环方向？

[http://twitter.github.com/bootstrap/javascript.html#carousel](http://twitter.github.com/bootstrap/javascript.html#carousel)

**我希望它像这样自动播放：**

（我有 3 张图片）

第一张图片 | 最后（第三张）图片 | 第二张图片 | （重新启动）第一张图片 | ...

所以它应该将图像移出右侧，而不是移出旋转木马的左侧。

*谢谢！*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:26:01.647

在初始化轮播之前重新排序

```
[].reverse.apply($('.carousel .item')).appendTo(".carousel .carousel-inner");
$('.carousel').carousel(); 
```

编辑：第一行的演示，初始化需要更多的脚本添加到小提琴中。[http://jsfiddle.net/b6Y9v/](http://jsfiddle.net/b6Y9v/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-06T22:55:41.010

查看我用于旋转木马 rtl 循环的解决方案，这是一个简单的覆盖：

[Twitter Bootstrap Carousel 循环项目从右到左 (RTL) 反转](https://stackoverflow.com/questions/16877562/twitter-bootstrap-carousel-cycle-items-right-to-left-rtl-reversed)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-23T18:46:57.207

我需要为按钮添加一个新功能，该功能是：当鼠标悬停在轮播中的左键或右键时，轮播必须开始移动。

左按钮很容易做到，当它向前循环时，但是当我必须反向做同样的事情时，旋转木马只向后移动 1 步，然后只向后移动 1 步，然后它就停止了。

所以我用这个`setInterval`功能帮助自己

```
onmouseover 
 control = setInterval( "$('#" + name_carrousel + "_next_button').cyclenext()", 200 );

onmouseleave
            clearInterval( control );
            $('#' + name_carrousel).carousel('pause'); 
```

我还对控件进行了一些更改：

```
<!-- Controls -->
<a data-slide="prev" href="#carousel-example-generic" class="left carousel-control" id="carousel-example-generic_prev_button">
  <span class="icon-prev"></span>
</a>
<a data-slide="next" href="#carousel-example-generic" class="right carousel-control" id="carousel-example-generic_next_button">
  <span class="icon-next"></span>
</a> 
```

变化是 `id="carousel-example-generic_prev_button"` ， `id="carousel-example-generic_next_button"` 变化帮助我们通过选择器找到。

这是下面代码的基础，它工作。

下面的代码，不好理解，因为是搞一个jquery库的。它必须与几个轮播一起工作，所以控制变量是一个数组。

globalbootstrap.js

```
$(function() {

    $(document).ready(function(){

        carousel_params_custom = { name_carrousel: 'carousel-example-generic' , time_interval: 200 };
        $('#' + carousel_params_custom.name_carrousel ).launch_carrousel( carousel_params_custom );

    });

});

jquery.customcarrousel.js

(function($){

    $.fn.extend({
        controlcarrousel: []
        ,
        cyclenext:function(){
            return this.each(function(){
                $('#' + carousel_params_custom.name_carrousel).carousel({
                    interval:  carousel_params_custom.time_interval
                    ,slide:'next'
                    ,wrap:true
                });
                $('#' + carousel_params_custom.name_carrousel).carousel('cycle');                
            });
        }
        ,
        cycleprev:function(){
            return this.each(function(){
                $('#' + carousel_params_custom.name_carrousel).carousel({
                    interval:  carousel_params_custom.time_interval
                    ,slide:'prev'
                    ,wrap:true
                });
                $('#' + carousel_params_custom.name_carrousel).carousel('cycle');                
            });
        }
        ,
        launch_carrousel:function(carousel_params_custom){

           $('#' + carousel_params_custom.name_carrousel + '_prev_button').mouseover(function(){
                $('#' + carousel_params_custom.name_carrousel).controlcarrousel[ carousel_params_custom.name_carrousel ] = setInterval( "$('#" + carousel_params_custom.name_carrousel + "_prev_button').cycleprev()", carousel_params_custom.time_interval );
            });

           $('#' + carousel_params_custom.name_carrousel + '_prev_button').mouseleave(function(){
                clearInterval( $('#' + carousel_params_custom.name_carrousel).controlcarrousel[ carousel_params_custom.name_carrousel ] );
                $('#' + carousel_params_custom.name_carrousel).carousel('pause');
            });

           $('#' + carousel_params_custom.name_carrousel + '_next_button').mouseover(function(){
                $('#' + carousel_params_custom.name_carrousel).controlcarrousel[ carousel_params_custom.name_carrousel ]  = setInterval( "$('#" + carousel_params_custom.name_carrousel + "_next_button').cyclenext()", carousel_params_custom.time_interval );
            });

           $('#' + carousel_params_custom.name_carrousel + '_next_button').mouseleave(function(){
                clearInterval( $('#' + carousel_params_custom.name_carrousel).controlcarrousel[ carousel_params_custom.name_carrousel ] );
                $('#' + carousel_params_custom.name_carrousel).carousel('pause');
            });            

        }
    });

})(jQuery); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-04T09:28:08.877

您可以通过在 jquery/js 中调用“下一个”和“上一个”来轻松更改引导轮播滑动的方向。在我的情况下，我必须每 5 秒从右到左和从左到右更改一次滑动方向。这是代码。希望这可以帮助。

```
 var $carousel = $('.carousel');

            var dirFlag = false;

            setInterval(function(){
                dirFlag = !dirFlag;
                if(dirFlag == true) {
                    $carousel.carousel('next');
                } else {
                    $carousel.carousel('prev');
                }
            }, 5000); 
```

# objective-c - iOS - 升级到 Xcode 4.5 后的核心绘图链接器错误

> ID：12610294
> 
> 赞同：2
> 
> 时间：2012-09-26T20:59:28.353
> 
> 标签：objective-c, core-plot, ios6, xcode4.5

> **可能重复：**
> [iOS - 升级到 Xcode 4.5 后出现链接器错误，可能与 Core Plot 相关](https://stackoverflow.com/questions/12411077/ios-linker-error-after-upgrading-to-xcode-4-5-possibly-core-plot-related)

我有这篇文章中描述的问题：

[iOS - 升级到 Xcode 4.5 后出现链接器错误，可能与 Core Plot 相关](https://stackoverflow.com/questions/12411077/ios-linker-error-after-upgrading-to-xcode-4-5-possibly-core-plot-related)

然而，对此我很陌生，我仍然不明白如何解决这个问题，重新编译库，并且不得不寻求一些帮助。

我已经清理过等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:15:59.763

这里可能存在两个问题（iOS 部署目标、ARMv7s 要求）。让我们首先确保您的部署目标在目标的摘要选项卡中至少设置为 4.3。

# ios6 - 共享存折通行证 .pkpass

> ID：12610296
> 
> 赞同：2
> 
> 时间：2012-09-26T20:59:30.877
> 
> 标签：ios6, passbook

我在 iOS 6 中创建了一个简单的演示存折通行证。我将它通过电子邮件发送给自己，它工作正常。现在我需要与人们分享它。我将 .pkpass 文件上传到服务器，但 safari 无法识别文件格式或 mime 类型，因此无法下载。

有什么想法可以分享吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:29:18.900

Safari 应该能够识别这些。

我认为您可能需要将 MIME 类型添加到您的 Web 服务器，以便它知道如何将文件呈现给访问者。

编辑：您需要添加到 Web 服务器的 MIME 类型是 application/vnd.apple.pkpass

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-03T20:23:15.470

Passbook 仅适用于 iPhone 5 或升级为 iOS6 的手机用户。它也可用于最新的 OS X Mountain Lion 10.8.2 版本。

如果此人没有这些，当他们在电子邮件中看到它时，它只会按原样显示 .pkpass 文件。如果他们的设备上有 Passbook，它将对其进行一些图形标记，他们可以单击将其添加到 Passbook。

您的电子邮件服务器必须支持 MIME 类型，但由于您收到了通行证，您的服务器似乎支持它，或者不在乎。就我而言，我们遇到了 Amazon Web Services Simple Email Services 的问题，因为他们的 WebAPI 不接受以下类型的文件：

**应用程序/vnd.apple.pkpass**

这已得到补救。

[https://forums.aws.amazon.com/thread.jspa?messageID=384277](https://forums.aws.amazon.com/thread.jspa?messageID=384277)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-07-30T19:05:58.850

要在 Safari（移动和桌面）中下载存折文件，您必须将正确的 mimetype 添加到您的服务器。为此，您只需创建一个[.htaccess](http://httpd.apache.org/docs/2.2/howto/htaccess.html)文件（或编辑现有文件）并附加以下行：

```
AddType application/vnd.apple.pkpass .pkpass 
```

这会变魔术。在此更改之后，如果您`<a href="...">`使用 iPhone 上的 Safari 移动版单击指向 .pkpass 文件的链接，它将自动使用 Passbook 打开它。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-12T06:09:25.240

我认为 pkpass 文件只会被以下人员识别：

*   运行iOS6及以上的设备（即安装存折App）
*   OSX 10.8.2（或更高版本）上的 Safari

编辑：iOS6 上的 Google Chrome 版本 23.0.1271.91 及更高版本现在还支持直接下载 .pkpass 文件

# c# - 如何从附加的依赖属性中监听 Dependency 属性的变化？

> ID：12610297
> 
> 赞同：0
> 
> 时间：2012-09-26T20:59:31.117
> 
> 标签：c#, xaml, windows-8, dependency-properties

在 WPF/SL 中，我可以使用[DependencyPropertyDescriptor](http://msdn.microsoft.com/en-us/library/system.componentmodel.dependencypropertydescriptor.aspx)在值更改时添加侦听器。

在 Win8 中，这个类似乎不存在，所以我正在寻找一种替代方法（希望同样简单）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:45:06.070

[您可以按照此博客文章](http://agsmith.wordpress.com/2008/04/07/propertydescriptor-addvaluechanged-alternative/)中的说明创建一个`PropertyChangeNotifier`类

创建它后，您可以在附加属性上使用它，如下所示：

```
ListBox listbox = new ListBox();
...
PropertyChangeNotifier notifier = new PropertyChangeNotifier(listBox, “(Grid).Row”);
notifier.ValueChanged += new EventHandler(OnValueChanged); 
```

此外，.net 4.5 客户端配置文件中不存在 DependencyPropertyDescriptor。但是，它确实存在于正常配置文件中。因此，如果您必须拥有它，只需更改项目的目标框架。

# excel - 导出为 CSV，带有换行符和跳过标题

> ID：12610302
> 
> 赞同：0
> 
> 时间：2012-09-26T20:59:43.053
> 
> 标签：excel

有没有办法将 Excel 导出到 csv 文件，该文件将每个单元格包含在 " 中并跳过标题？另存为 .csv 不是我正在寻找的答案。

如果可能的话，我正在寻找一种从 excel 中执行此操作的方法。不是编码解决方案。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:48:28.200

假设您在 Sheet1 中有数据，我能想到的最佳非 VBA 解决方案是添加第二张工作表并在 A1 中输入公式，如下所示：

```
=""""&Sheet1!A1&""","""&Sheet1!B1&""","""&Sheet1!C1&"""" 
```

然后将其复制到 Sheet1 中的行数。您还需要将此公式扩展到尽可能多的列。

这将为您提供一个看起来像您想要的 CSV 文件格式的列。然后，您将该页面保存为文本文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:36:48.197

假设您的数据在单元格 A1 的活动表中开始，带有第一个标题行，附加的代码应将其写入您的规范的 csv 文件。

```
Sub WriteToCSV()

Const forReading = 1, forAppending = 3, fsoForWriting = 2
Dim fs, objTextStream, sText As String
Dim lLastRow As Long, lRowLoop As Long, lLastCol As Long, lColLoop As Long

Set fs = CreateObject("Scripting.FileSystemObject")
Set objTextStream = fs.opentextfile("c:\temp\myResult.csv", fsoForWriting, True)

lLastRow = Cells(Rows.Count, 1).End(xlUp).Row
lLastCol = Cells(1, Columns.Count).End(xlToLeft).Column

For lRowLoop = 2 To lLastRow
    sText = ""
    For lColLoop = 1 To lLastCol
        sText = sText & Chr(34) & Cells(lRowLoop, lColLoop) & Chr(34) & ","
    Next lColLoop

    objTextStream.writeline (Left(sText, Len(sText) - 1))
Next

objTextStream.Close
Set objTextStream = Nothing
Set fs = Nothing

End Sub 
```

# sql - SQL Server Management Studio 2008 安装 - 无选项

> ID：12610304
> 
> 赞同：4
> 
> 时间：2012-09-26T20:59:46.087
> 
> 标签：sql, sql-server-2008, installation

好的，我到处寻找答案，但似乎找不到答案。

我已经安装了 VS 2010，并附带了 SQL Server 2008 Express。我目前正在尝试安装 SQL Server Management Studio 2008，但它不会给我安装选项。

起初，我以为它要我先安装 SP1.. 但它说没有什么要修补的！

My SQL 补丁版本：10.1.2531.0

![SQL Server 2008 安装程序](../Images/d4f5abd5f8dafcf1ee00f0f896e4b707.png)

编辑：这是我正在使用的安装程序：http: [//www.microsoft.com/en-us/download/details.aspx?id=7593](http://www.microsoft.com/en-us/download/details.aspx?id=7593)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-05-31T20:57:48.187

我在安装[SQL Server 2008 R2 RTM-Management Studio Express](http://www.microsoft.com/en-us/download/details.aspx?id=22985)时遇到了完全相同的问题。返回“安装类型”步骤（上一步），仔细阅读每个单选按钮下的文本。“全新安装或添加共享功能”下的选项如下：

> 如果您想要安装新的 SQL Server 实例 **或想要安装共享组件，例如 SQL Server Management Studio 或 Integration Services** ，请选择此选项。

您必须选择“新安装”，而不是“添加功能”，这可能看起来违反直觉。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-07T05:21:07.473

备份一个步骤并选择“执行新安装”选项。太棒了，我知道。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:08:16.140

据我所知，Management Studio 并未与 SQL Server 2008 Express 安装程序的每个版本捆绑在一起。也许您可以尝试安装：[Microsoft® SQL Server® 2008 Management Studio Express](http://www.microsoft.com/en-us/download/details.aspx?id=7593)或此[Microsoft SQL Server 2008 R2 RTM - Management Studio Express](http://www.microsoft.com/en-us/download/details.aspx?id=22985)，具体取决于您的服务器版本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-07-11T16:05:17.187

我也遇到了这个故障。共享功能选择列表应显示 [✓] 管理工具 - 基本。该复选框是自动填充的。

我重新启动，然后以管理员身份运行安装程序，它按预期工作。

# django - Git 告诉我我的更改尚未提交，即使它们已经提交？

> ID：12610310
> 
> 赞同：1
> 
> 时间：2012-09-26T21:00:11.887
> 
> 标签：django, git, commit

我试图通过删除不再相关的文件来清理我的目录。从那时起，每当我尝试推送时，我都会收到错误“您对以下文件的本地更改将被合并覆盖：[我尝试删除的一些文件的列表]。请在合并之前提交或存储它们”，这很奇怪因为我所有其他文件删除都已成功提交。

编辑：我重命名了我的本地副本并再次克隆了存储库，发现我所做的更改/正在/正在经历，但由于某种原因，网络应用程序本身并没有反映这些更改。我尝试清除浏览器的缓存并在其他浏览器上查看网站，但除了我克隆的文件之外，这些更改不会出现在任何地方，这让我完全感到困惑。

1.  是否有任何解释为什么网络应用程序不显示最近更新的文件？

2.  我仍然收到此错误，如果它有任何启示：

    > > > “您对以下文件的本地更改将被合并覆盖：static/css/newcss.css 请在合并之前提交您的更改或存储它们。

尽管自从克隆它以来我没有以任何方式更改该文件。

（另请注意，我正在为这个网络应用程序使用 Django）

编辑编辑：所以我想结束这个问题，网站的更新只需要很长时间来处理（比如两周）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:07:44.783

当我使用 GIT 时，我通常会遇到这种奇怪的错误。

你试过这个：[Git告诉我拉，然后提交，然后拉？](https://stackoverflow.com/questions/6769644/git-telling-me-to-pull-then-commit-then-pull)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:49:29.700

你确定你提交了你的更改吗？运行这个：

```
git diff 
```

如果出现问题，则意味着您的工作目录中存在与您上次提交不匹配的更改，例如，这是需要提交的更改。

尝试提交更改的文件：

```
git add myfile.txt
git commit myfile.txt -m "Committing my file" 
```

# php - 为什么我的会话 upload_progress 总是返回 null？

> ID：12610312
> 
> 赞同：2
> 
> 时间：2012-09-26T21:00:15.763
> 
> 标签：php, session, upload, progress-bar

我已经在 php.ini 中安装了所有扩展，并使用 php 5.4 运行 apache

索引.php

```
enter code here
<?php

 session_start();

 ?>

 <html>

<body>

<form action="upload.php" method="POST" enctype="multipart/form-data">
<input type="hidden" name="<?php echo ini_get('session.upload_progress.name'); ?>"       value="123" />
<br/>
<input type="file" name="file" /><br/>
<input type="submit" />
</form>

</body>

</html> 
```

上传.php

```
enter code here

<?php

session_start();

  $key1 = ini_get("session.upload_progress.prefix") ."123";

 echo $key1;

  echo $_SESSION[$key1][1];

  $target_path = "up/" . basename($_FILES['file']['name']);
  move_uploaded_file($_FILES['file']['tmp_name'], $target_path );
  chmod($target_path , 0777);

  echo "<br/><br/><br/>";

  //$key = ini_get("session.upload_progress.prefix") . "123";
  var_dump($_SESSION[$key1]);

  echo "<br/>";
  echo "Session: ". var_dump($_SESSION);

  echo "<br/>";
  echo "Files: ". var_dump($_FILES); 
```

?>

我已经在 php.ini 中安装了所有 session 和 uploadprogress 扩展，我在 Linux 环境（Ubuntu）中使用 php 5.4 运行 apache

# asp.net-mvc - MVC DB first Fix display Name

> ID：12610319
> 
> 赞同：13
> 
> 时间：2012-09-26T21:00:25.943
> 
> 标签：asp.net-mvc, database-first

我正在使用 mvc 4，首先使用数据库。

每次我刷新`model.edmx`文件时，我添加的显示名称属性都会被删除。如何在刷新之间保持显示名称属性？

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-09-26T21:08:55.647

您将要使用`System.ComponentModel.DataAnnotations`. 这是 EF 中“用户”表的简单示例，向您展示如何：

```
namespace YourNamespace.BlaBlaBla
{
    [MetadataType(typeof(UserHelper))]
    public partial class User { }

    public class UserHelper
    {
        [Display(Name = "Your New Title For Name")]
        public string Name { get; set; }
    }
} 
```

你也可以在你的类中包含验证。确保它是一个名称完全相同的部分类 - 也不要忘记它*必须*与您的 .edmx 位于完全相同的命名空间中。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-26T21:08:29.777

您需要使用 MetaDataTypes 模型..

```
[MetadataType(typeof(ModelMD))]
public partial class Model
{
//This is for "extending" the EF generated model, saying what class is used for metadata, in your case DisplayName
}

public partial class ModelMD
{

    [Display(Name = "Model_Title", ResourceType = typeof(DataFieldLabels))]
    public string Titulo { get; set; }

    [Display(Name = "Model_Description", ResourceType = typeof(DataFieldLabels))]
    public string Descripcion { get; set; }
} 
```

在上面的示例中，我使用资源文件来获取字段显示名称......但您可以以更硬编码的方式使用它:)

您应该在另一个文件夹中创建一个新文件，比如说“ModelMD”。这样，一旦重新生成模型，此文件将保持不变。

**重要提示：**该`ModelMD`文件应使用与原始模型相同的命名空间。如果您将文件放在不同的文件夹中，则默认为另一个命名空间。

# java - 为什么我的图像旋转偏离中心？

> ID：12610320
> 
> 赞同：0
> 
> 时间：2012-09-26T21:00:33.253
> 
> 标签：java, image, rotation, mouse, slick2d

我正在使用 Java/Slick 2D 来玩图形并使用鼠标来旋转图像。但是发生了一些奇怪的事情：图像不一定面向鼠标。它与法线呈 45 度角，但距离越远，距离越远。见下图（白色圆圈为鼠标，文字为角度）： ![80 度的图像](../Images/49574a7f562e195d296efefe79d3f23b.png) ![45 度角的图像](../Images/ba12fbb74f452bab0cc50b3b3f812c76.png)

这是我使用的轮换代码：

```
int mX = Mouse.getX();
        int mY = HEIGHT - Mouse.getY();
        int pX = sprite.x;
        int pY = sprite.y;
        int tempY, tempX;
        double mAng, pAng = sprite.angle;
        double angRotate=0;

        if(mX!=pX){
            mAng = Math.toDegrees(Math.atan2(mY - pY, mX - pX));
            if(mAng==0 && mX<=pX)
                mAng=180;
        }
        else{
            if(mY>pY)
                mAng=90;
            else
                mAng=270;
        }

        sprite.angle = mAng;
        sprite.image.setRotation((float) mAng); 
```

有什么想法吗？我假设它与图像坐标来自左上角的事实有关，但我不知道如何反驳它。仅供参考：屏幕 640x460，图像 128x128 并在窗口中居中。

编辑：不幸的是，那里没有真正起作用。这是一张包含更多信息的图片：

![35 度箭头](../Images/94d8d7b0df1833d653c0e87d727e5212.png)

EDIT2：找到了答案！不得不改变： int px/py = sprite.x/y 到

```
 int pX = sprite.x+sprite.image.getWidth()/2;
    int pY = sprite.y+sprite.image.getHeight()/2; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:09:08.077

看起来您从左侧获取鼠标的值并将该距离设置为旋转...这可能会有所帮助：

[http://www.instructables.com/id/Using-Java-to-Rotate-an-Object-to-Face-the-Mouse/?ALLSTEPS](http://www.instructables.com/id/Using-Java-to-Rotate-an-Object-to-Face-the-Mouse/?ALLSTEPS)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:51:02.957

这是我写的类似问题的一些示例代码，可能会有所帮助。

现在它不使用 slick，它使用`Swing`，`Graphics2D`但它可能会帮助您获得一些想法。

```
public class TestRotatePane extends JPanel {

    private BufferedImage img;
    private Point mousePoint;

    public TestRotatePane() {

        try {
            img = ImageIO.read(getClass().getResource("/MT02.png"));
        } catch (IOException ex) {
            ex.printStackTrace();
        }

        addMouseMotionListener(new MouseAdapter() {

            @Override
            public void mouseMoved(MouseEvent e) {

                mousePoint = e.getPoint();

                repaint();

            }

        });

    }

    @Override
    public Dimension getPreferredSize() {

        return new Dimension(img.getWidth(), img.getHeight());

    }

    @Override
    protected void paintComponent(Graphics g) {

        super.paintComponent(g);

        Graphics2D g2d = (Graphics2D) g.create();

        double rotation = 0f;

        int width = getWidth() - 1;
        int height = getHeight() - 1;

        if (mousePoint != null) {

            int x = width / 2;
            int y = height / 2;

            int deltaX = mousePoint.x - x;
            int deltaY = mousePoint.y - y;

            rotation = -Math.atan2(deltaX, deltaY);

            rotation = Math.toDegrees(rotation) + 180;

        }

        int x  = (width - img.getWidth()) / 2;
        int y  = (height - img.getHeight()) / 2;

        g2d.rotate(Math.toRadians(rotation), width / 2, height / 2);
        g2d.drawImage(img, x, y, this);

        x = width / 2;
        y = height / 2;
        g2d.setStroke(new BasicStroke(3));
        g2d.setColor(Color.RED);
        g2d.drawLine(x, y, x, y - height / 4);
        g2d.dispose();

    }

} 
```

![在此处输入图像描述](../Images/76fa7b446b444b250a74bcfd5045e5a0.png)

显然，您需要提供自己的图像；）

# ios - 横向和纵向的不同用户界面

> ID：12610322
> 
> 赞同：0
> 
> 时间：2012-09-26T21:00:37.607
> 
> 标签：ios, cocoa-touch, interface, landscape, portrait

我一直是一个我没有找到好的答案的问题。

是否有可能（必须！;）构建不同的用户界面，例如横向和纵向或具有 3,5" 或 4" 显示屏的 iPhone。

就像在代码中说的那样，这是横向界面，这是纵向界面......

我希望有一个简单的方法。:)

德国慕尼黑致以最诚挚的问候

劳伦兹

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:15:21.503

我就是这样做的。我创建了一个名为的函数，该函数`configureViewForOrientation:`将您要为其设置界面的方向作为参数。

```
-(void)configureViewForOrientation:(UIInterfaceOrientation)orientation
{
    if (UIInterfaceOrientationIsPortrait(orientation))
    {
        //set up portrait interface
    }

    else
    { 
        //set up landscape interface
    }
} 
```

您可以从您的`viewDidLoad`（或您最初设置界面的任何位置）调用此方法，并使用以下方式为其提供当前方向`[UIApplication sharedApplication].statusBarOrientation`：

```
-(void)viewDidLoad
{
    [super viewDidLoad];
    [self configureViewForOrientation:[UIApplication sharedApplication].statusBarOrientation];
} 
```

您也可以在设备旋转时调用它：

```
-(void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)toInterfaceOrientation duration:(NSTimeInterval)duration
{
    [super willAnimateRotationToInterfaceOrientation:toInterfaceOrientation duration:duration];
    [self configureViewForOrientation:toInterfaceOrientation];
} 
```

有几个注意事项（例如您是否在应用启动时立即检查设备方向），但这应该在大多数情况下都有效。

# scala - Scala：为什么 SortedMap 的 mapValues 返回的是 Map 而不是 SortedMap？

> ID：12610325
> 
> 赞同：11
> 
> 时间：2012-09-26T21:00:50.133
> 
> 标签：scala, map, treemap, sortedmap

我是 Scala 的新手。我在我的代码中使用了*[SortedMap](http://www.scala-lang.org/api/current/scala/collection/SortedMap.html)*，我想使用*mapValues*来创建一个对值进行一些转换的新地图。

*mapValues*函数不是返回一个新的*[SortedMap](http://www.scala-lang.org/api/current/scala/collection/SortedMap.html)*，而是返回一个新的*Map*，然后我必须将其转换为一个*[SortedMap](http://www.scala-lang.org/api/current/scala/collection/SortedMap.html)*。

 **例如

```
val my_map = SortedMap(1 -> "one", 0 -> "zero", 2 -> "two")
val new_map = my_map.mapValues(name => name.toUpperCase)
// returns scala.collection.immutable.Map[Int,java.lang.String] = Map(0 -> ZERO, 1 -> ONE, 2 -> TWO)
val sorted_new_map = SortedMap(new_map.toArray:_ *) 
```

这看起来效率低下 - 最后一次转换可能会再次对键进行排序，或者至少验证它们是否已排序。

我可以使用对键和值都进行操作的法线*贴图*函数，并且故意不更改转换函数中的键。这看起来也效率低下，因为*Map*的实现可能假设转换可能会改变键的顺序（就像在这种情况下：）`my_map.map(tup => (-tup._1, tup._2)`- 所以它也可能“重新排序”它们。

有谁熟悉*Map*和*[SortedMap](http://www.scala-lang.org/api/current/scala/collection/SortedMap.html)*的内部实现，并且可以告诉我我的假设是否正确？编译器可以自动识别键没有被重新排序吗？*为什么mapValues*不应该返回*SortedMap*有内部原因吗？有没有更好的方法来转换地图的值而不丢失键的顺序？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-26T21:08:36.703

您偶然发现了 Scala`Map`实现的一个棘手功能。您缺少的问题是它`mapValues`实际上并没有返回 a new `Map`：它返回 a`view`的 a `Map`。换句话说，它以这样一种方式包装您的原始地图，即每当您访问一个值时，它都会`.toUpperCase`在将值返回给您之前进行计算。

这种行为的好处是 Scala 不会为未访问的值计算函数，也不会花时间将所有数据复制到新的`Map`. *缺点是每次*访问该值时都会重新计算该函数。因此，如果您多次访问相同的值，您最终可能会进行*额外的计算。*

那么为什么不`SortedMap`返回 a`SortedMap`呢？因为它实际上返回了一个`Map`-wrapper。底层的`Map`，然后是被包装的，仍然是 a `SortedMap`，所以如果你要遍历它，它仍然是排序的。你我都知道，但类型检查器不知道。看起来他们当然可以以仍然保持`SortedMap`特征的方式编写它，但他们没有。

您可以在代码中看到它没有返回 a `SortedMap`，但迭代行为仍将被排序：

```
// from MapLike
override def mapValues[C](f: B => C): Map[A, C] = new DefaultMap[A, C] {
  def iterator = for ((k, v) <- self.iterator) yield (k, f(v))
  ... 
```

您的问题的解决方案与解决视图问题的解决方案相同：使用`.map{ case (k,v) => (k,f(v)) }`，正如您在问题中提到的那样。

* * *

如果你真的想要那种方便的方法，你可以做我所做的，写你自己的，更好的，版本`mapValues`：

```
class EnrichedWithMapVals[T, U, Repr <: GenTraversable[(T, U)]](self: GenTraversableLike[(T, U), Repr]) {
  /**
   * In a collection of pairs, map a function over the second item of each
   * pair.  Ensures that the map is computed at call-time, and not returned
   * as a view as 'Map.mapValues' would do.
   *
   * @param f   function to map over the second item of each pair
   * @return a collection of pairs
   */
  def mapVals[R, That](f: U => R)(implicit bf: CanBuildFrom[Repr, (T, R), That]) = {
    val b = bf(self.asInstanceOf[Repr])
    b.sizeHint(self.size)
    for ((k, v) <- self) b += k -> f(v)
    b.result
  }
}
implicit def enrichWithMapVals[T, U, Repr <: GenTraversable[(T, U)]](self: GenTraversableLike[(T, U), Repr]): EnrichedWithMapVals[T, U, Repr] =
  new EnrichedWithMapVals(self) 
```

现在，当您调用`mapVals`a时，`SortedMap`您会得到一个 non-view `SortedMap`：

```
scala> val m3 = m1.mapVals(_ + 1)
m3: SortedMap[String,Int] = Map(aardvark -> 2, cow -> 6, dog -> 10) 
```

它实际上适用于任何对集合，而不仅仅是`Map`实现：

```
scala> List(('a,1),('b,2),('c,3)).mapVals(_+1)
res8: List[(Symbol, Int)] = List(('a,2), ('b,3), ('c,4)) 
```**

# environment-variables - 如何在 Upstart 脚本的预启动中设置环境变量？

> ID：12610335
> 
> 赞同：10
> 
> 时间：2012-09-26T21:01:41.420
> 
> 标签：environment-variables, upstart

我们有一个自定义的 C++ 守护程序应用程序，它分叉一次。因此，我们一直在 Ubuntu 12.04 上的 Upstart 脚本中执行此操作，并且运行良好：

```
expect fork
exec /path/to/the/app 
```

但是现在我们需要向我们的应用程序传递一个参数，其中包含运行它的机器上的 CPU 数量：

```
cat /proc/cpuinfo | grep processor | wc -l 
```

我们的第一次尝试是这样的：

```
expect fork
exec /path/to/the/app -t `cat /proc/cpuinfo | grep processor | wc -l` 
```

虽然这会以正确的 -t 值启动我们的应用程序，但 Upstart 会跟踪错误的 pid 值，我假设是因为那些 cat、grep 和 wc 命令在我们的应用程序之前在 exec 中启动所有进程。

我也试过这个，即使它不起作用，我猜是因为设置一个 env var 运行一个进程？Upstart 仍然跟踪错误的 pid：

```
expect fork
script
    NUM_CORES=32
    /path/to/the/app -t $NUM_CORES
end script 
```

我也试过在 env 节中这样做，但显然那些不运行命令：

```
env num_cores=`cat /proc/cpuinfo | grep processor | wc -l` 
```

也尝试在启动前执行此操作，但设置的环境变量在 exec 节中没有任何值：

```
pre-start
    NUM_CORES=32
end script 
```

知道如何正确设置这个 NUM_CORES，并且仍然让 Upstart 跟踪我们的应用程序的正确 pid 一次分叉吗？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-09-29T03:23:28.053

这很尴尬。推荐的方法是在 pre-start 节中编写一个 env 文件，然后在 script 节中获取它。这很荒谬，我知道。

```
expect fork

pre-start script
    exec >"/tmp/$UPSTART_JOB"
    echo "NUM_CORES=$(cat /proc/cpuinfo | grep processor | wc -l)"
end script

script
    . "/tmp/$UPSTART_JOB"
    /path/to/app -t "$NUM_CORES"
end script

post-start script
    rm -f "/tmp/$UPSTART_JOB"
end script 
```

我在预启动中使用 exec 行，因为我通常有多个 env 变量并且我不想重复重定向代码。

这仅适用于 '. ' 命令是内置的破折号，因此不会产生任何进程。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-30T08:53:26.953

根据 zram-config 的 upstart 配置：

```
script
    NUM_CORES=$(grep -c ^processor /proc/cpuinfo | sed 's/^0$/1/')
    /path/to/the/app -t $NUM_CORES
end script 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-19T18:45:29.423

我会补充

```
export NUM_CORES 
```

在“脚本”中为其赋值后。我记得符号链接到非 Bash shell 的 /bin/sh 可能会运行脚本，所以我会避免仅使用 Bash 的结构。

回复：使用“env”节，它按字面意思传递值，而不使用 shell 约定处理它们。

# python - 多对多关系。ORM Django

> ID：12610337
> 
> 赞同：3
> 
> 时间：2012-09-26T21:01:51.990
> 
> 标签：python, django, django-orm

```
class Toy(models.Model):
    name = models.CharField(max_length=20)
    desc = models.TextField()

class Box(models.Model):
    name = models.CharField(max_length=20)
    proprietor = models.ForeignKey(User, related_name='User_Box')
    toys = models.ManyToManyField(Toy, blank=True) 
```

如何创建一个将玩具添加到盒子的视图？

```
def add_this_toy_to_box(request, toy_id): 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-27T01:02:32.147

您可以使用 Django 的[`RelatedManager`](https://docs.djangoproject.com/en/dev/ref/models/relations/)：

> “相关管理器”是在一对多或多对多相关上下文中使用的管理器。这发生在两种情况下：
> 
> ForeignKey 关系的“另一面”。那是：

```
class Reporter(models.Model):
    ...

class Article(models.Model):
    reporter = models.ForeignKey(Reporter) 
```

> 在上面的示例中，以下方法将在 manager 上可用`reporter.article_set`。
> 
> ManyToManyField 关系的双方：

```
class Topping(models.Model):
    ...

class Pizza(models.Model):
    toppings = models.ManyToManyField(Topping) 
```

> 在此示例中，以下方法将在 on`topping.pizza_set`和 on 上都可用`pizza.toppings`。

这些相关的管理器有一些额外的方法：

1.  要创建新对象，请将其保存并放入相关对象集中。返回新创建的对象：create(**kwargs)

    ```
    >>> b = Toy.objects.get(id=1)
    >>> e = b.box_set.create(
    ...     name='Hi',
    ... )

    # No need to call e.save() at this point -- it's already been saved.

    # OR:

    >>> b = Toy.objects.get(id=1)
    >>> e = Box(
    ...     toy=b,
    ...     name='Hi',
    ... )
    >>> e.save(force_insert=True) 
    ```

2.  要将模型对象添加到相关对象集中：

    ```
    add(obj1[, obj2, ...]) 
    ```

    例子：

    ```
    >>> t = Toy.objects.get(id=1)
    >>> b = Box.objects.get(id=234)
    >>> t.box_set.add(b) # Associates Box b with Toy t. 
    ```

3.  要从相关对象集中删除指定的模型对象：

    ```
    remove(obj1[, obj2, ...])

    >>> b = Toy.objects.get(id=1)
    >>> e = Box.objects.get(id=234)
    >>> b.box_set.remove(e) # Disassociates Entry e from Blog b. 
    ```

    > 为了防止数据库不一致，这个方法只存在于null=True的ForeignKey对象上。如果相关字段无法设置为无 (NULL)，则无法从关系中删除对象而不将其添加到另一个对象。在上面的例子中，从 b.entry_set() 中去掉 e 就相当于做 e.blog = None，并且因为博客 ForeignKey 没有 null=True，所以这是无效的。

4.  从相关对象集中删除所有对象：clear()

    ```
    >>> b = Toy.objects.get(id=1)
    >>> b.box_set.clear() 
    ```

    > 请注意，这不会删除相关对象——它只是解除它们的关联。就像 remove() 一样，clear() 仅在 null=True 的 ForeignKeys 上可用。

* * *

参考：[有关处理相关对象的相关 Django 文档](https://docs.djangoproject.com/en/dev/ref/models/relations/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T23:26:25.273

Django 自动在 ManyToManyFields 上创建反向关系，所以你可以这样做：

```
toy = Toy.objects.get(id=toy_id)
toy.box_set.add(box) 
```

# actionscript-3 - 等待装载机

> ID：12610342
> 
> 赞同：0
> 
> 时间：2012-09-26T21:01:59.953
> 
> 标签：actionscript-3

*编辑：看来我今天打错了。谢谢，安托万。*

我需要获取任何给定 swf 的已发布尺寸。到目前为止，我一直依赖 loaderInfo，但是，我最近发现即使在`this`is之后这些属性也没有完全加载`addedToStage`。检查是否`loaderInfo.hasOwnProperty("width")`毫无意义，因为该属性已经存在，但该属性本身是一个返回错误的 getter 函数。因此，为避免出现[错误 #2099](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/runtimeErrors.html#2099)，我正在查询仅在完全加载后才显示的属性，并在 try/catch 语句中执行此操作。问题是……抓不……抓？

```
var loaderLoaded:Boolean = false;
try { loaderLoaded = (this.loaderInfo.width > 0) ? true : false; } catch (e:Event) {}
trace("Loader loaded: " + loaderLoaded); 
```

如前所述，这会导致

`Error #2099: The loading object is not sufficiently loaded to provide this information. at flash.display::LoaderInfo/get width()`

我需要修复 try/catch 语句，或者找到另一种轮询 swf 尺寸的方法。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:05:28.837

如果你只是复制/粘贴这个，你写`catch(e:Event)`的不是`catch(e:Error)`.

您无法捕捉事件。

# hadoop - 原子hadoop fs移动

> ID：12610345
> 
> 赞同：7
> 
> 时间：2012-09-26T21:02:11.823
> 
> 标签：hadoop, atomic, hdfs, infrastructure

在为我当前的一个项目构建基础架构时，我遇到**了替换现有 HDFS 文件的问题**。更准确地说，我想做以下事情：

我们有几台机器（**日志服务器**）不断生成日志。我们有一台专用机器（**日志预处理器**）负责从**日志服务器**接收日志块（每个块的长度约为 30 分钟，大小为 500-800 mb），对它们进行预处理并上传到我们的 Hadoop 集群的 HDFS .

预处理分三步完成：

1.  对于每个日志服务器：过滤（并行）接收到的日志块（输出文件约为 60-80mb **）**
2.  合并（合并排序）步骤 1 中的所有输出文件并进行一些小的过滤（此外，30 分钟的文件被合并为 1 小时的文件）
3.  使用来自外部数据库的**当前映射**，处理步骤#2 中的文件以获取**最终日志文件**并将此文件放入 HDFS。

**最终日志文件**将用作在 HADOOP 集群上运行的几个 periodoc HADOOP 应用程序的输入。在 HDFS 中，日志文件存储如下：

```
hdfs:/spool/.../logs/YYYY-MM-DD.HH.MM.log 
```

## **问题描述：**

第 3 步中使用的**映射**会随着时间而变化，我们需要通过重新计算第 3 步并用新的 HDFS 文件替换旧的 HDFS 文件来反映这些变化。至少在过去 12 小时内以某种周期性（例如每 10-15 分钟）执行此更新。请注意，如果**映射**发生了变化，在同一个输入文件上应用 step3 的结果可能会有很大不同（它不仅仅是先前结果的超集/子集）。所以我们需要**覆盖**HDFS 中的现有文件。

但是，我们不能只执行*hadoop fs -rm*然后*hadoop fs -copyToLocal*因为如果某些 HADOOP 应用程序正在使用临时删除的文件，则应用程序可能会失败。我使用的解决方案 - 在旧文件**附近**放置一个新文件，这些文件具有相同的名称但不同的后缀表示文件的版本。现在布局如下：

```
hdfs:/spool/.../logs/2012-09-26.09.00.log.v1
hdfs:/spool/.../logs/2012-09-26.09.00.log.v2
hdfs:/spool/.../logs/2012-09-26.09.00.log.v3
hdfs:/spool/.../logs/2012-09-26.10.00.log.v1
hdfs:/spool/.../logs/2012-09-26.10.00.log.v2 
```

任何 Hadoop 应用程序在启动（设置）期间都会选择具有最新版本的文件并使用它们。因此，即使正在进行一些更新，应用程序也不会遇到任何问题，因为没有删除输入文件。

## 问题：

1.  你知道一些不使用这种复杂/丑陋的文件版本控制的更简单的方法吗？

2.  一些应用程序可能开始使用当前正在上传但尚未上传的 HDFS 文件（应用程序在 HDFS 中看到此文件但不知道它是否一致）。如果是 gzip 文件，这可能会导致映射器失败。你能建议我如何处理这个问题吗？我知道对于本地文件系统，我可以执行以下操作：

    cp infile /finaldir/outfile.tmp && mv /finaldir/output.tmp /finaldir/output

这是有效的，因为*mv*是一个原子操作，但是我不确定 HDFS 是否属于这种情况。如果 HDFS在传统的本地文件系统中具有像 mv 这样的*原子*操作，您能否提出建议？

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-30T20:54:30.547

IMO，文件重命名方法绝对可以使用。

HDFS，最高 1.x，缺少原子重命名（它们是*脏*更新 IIRC） - 但该操作通常被认为是“类似原子的”，并且从未给您在这里想到的特定场景带来问题。您可以依赖它而不必担心部分状态，因为源文件已经创建并关闭。

HDFS 2.x 及更高版本支持*正确的*原子重命名（通过新的 API 调用），它已经取代了早期版本的脏重命名。[如果您使用FileContext](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/fs/FileContext.html) API ，这也是重命名的默认行为。

# debian - Unbound module Findlib error during installation of Ocaml Batteries

> ID：12610350
> 
> 赞同：0
> 
> 时间：2012-09-26T21:02:41.020
> 
> 标签：debian, ocaml, ocaml-batteries

I have created my `~/.ocamlinit` as follows

```
let interactive = !Sys.interactive;;
Sys.interactive := false;; (*Pretend to be in non-interactive mode*)
#use "topfind";;
Sys.interactive := interactive;; (*Return to regular interactive mode*)

Toploop.use_silently Format.err_formatter (Filename.concat (Findlib.package_directory "batteries") "battop.ml");; 
```

When I type `ocaml` at command line, I get the following error:

```
$ ocaml
        Objective Caml version 3.12.1

Cannot find file topfind.
File ".ocamlinit", line 6, characters 60-85:
Error: Unbound module Findlib
# 
```

What is causing this issue and how should I go about for fixing this issue?

(I am on Debian Wheezy)

Edit: I have set an alias for ocaml:

```
alias ocaml='rlwrap -H /home/nanda/.ocaml_history -D 2 -i -s 10000 ocaml' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T05:22:18.043

With due thanks to `dkim`, I would post the solution that worked for me. Hope this helps someone else.

### Ocaml Batteries Installation Process

To be able to work with the ocaml-batteries-included, I followed this process:

```
sudo apt-get install ocaml ocaml-batteries-included ocaml-doc ledit rlwrap 
```

`rlwrap` or `ledit` is needed to add readline support for OCaml toploop.

Added an alias in `.bashrc`, to save the commands entered in the ocaml toploop.

```
 alias ocaml='rlwrap -H /home/nanda/.ocaml_history -D 2 -i -s 10000 ocaml' 
```

-H specifies history file name
-D ignores duplicates
-i case insensitive
-s limits the number of commands stored in this file

As mentioned in the comments, I was receiving this error when trying to invoke the ocaml interpreter.

```
$ ocaml
        Objective Caml version 3.12.1

Cannot find file topfind.
File ".ocamlinit", line 6, characters 60-85:
Error: Unbound module Findlib
# 
```

I received this error because ocaml-findlib package was not properly installed. I have mamaged to solve this by installing the `libfindlib-ocaml-dev` package:

```
sudo apt-get install libfindlib-ocaml-dev 
```

For some people, the issue is solved when findlib package is installed from sources as mentioned [here](https://github.com/ocaml-batteries-team/batteries-included/issues/140)

Some more helpful links:

1.  [http://mirror.ocamlcore.org/wiki.cocan.org/tips_for_using_the_ocaml_toplevel.html](http://mirror.ocamlcore.org/wiki.cocan.org/tips_for_using_the_ocaml_toplevel.html)
2.  [http://projects.camlcity.org/projects/dl/findlib-1.2.1/doc/guide-html/quickstart.html](http://projects.camlcity.org/projects/dl/findlib-1.2.1/doc/guide-html/quickstart.html)
3.  [http://www.donadeo.net/post/2010/installing-batteries](http://www.donadeo.net/post/2010/installing-batteries)

# wpf - WPF ClickOnce 完全信任问题（与单独的 AppDomain 相关？）

> ID：12610355
> 
> 赞同：0
> 
> 时间：2012-09-26T21:03:17.590
> 
> 标签：wpf, clickonce, appdomain, full-trust

我正在为我的应用程序创建 clickonce 安装。

如果项目属性，我在“安全”选项卡中启用了 ClickOnce 安全设置并完全信任。我发布到网络驱动器并运行安装。安装成功，但是当我运行应用程序时出现此错误：

![在此处输入图像描述](../Images/d7b742c58bcbd3e6710155b61a26fe9e.png)

我有[Pos for .Net](http://www.microsoft.com/en-us/download/details.aspx?id=5355)代码在单独的 AppDomain 中运行（由于 .net 4 的默认安全策略存在问题）。它在我的本地系统上运行良好，无需单击。我的应用程序使用 Prism，因此我必须修改清单以包含动态加载的模块。它在某种程度上与我创建的 AppDomain 没有完全信任有关。

这就是我创建 AppDomain 的方式

```
AppDomainSetup currentAppDomainSetup = AppDomain.CurrentDomain.SetupInformation;
AppDomainSetup newAppDomainSetup = new AppDomainSetup()
{
    ApplicationBase = currentAppDomainSetup.ApplicationBase,
    LoaderOptimization = currentAppDomainSetup.LoaderOptimization,
    ConfigurationFile = currentAppDomainSetup.ConfigurationFile,
    PrivateBinPath = @"Modules"  // need to set this so that the new AppDomain can see the prism modules
};
newAppDomainSetup.SetCompatibilitySwitches(new[] { "NetFx40_LegacySecurityPolicy" }); // required for POS for .Net to function properly
_posAppDomain = AppDomain.CreateDomain("POS Hardware AppDomain", null, newAppDomainSetup);
// Error happens on the following line. Note that type T is always in same assembly that AppDomain was created in.
    T hardware = (T)PosAppDomain.CreateInstanceFromAndUnwrap(Assembly.GetAssembly(typeof(T)).Location, typeof(T).FullName); 
```

是否有我缺少的安全设置？

我想我越来越近了。我创建的 AppDomain 在没有 clickonce 的情况下运行时完全信任运行，但是当我使用 clickonce 运行它时，它不会完全信任运行......所以现在我试图弄清楚如何让它完全信任。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T15:23:35.143

弄清楚了

我不得不添加`Evidence`和`PermissionSet`...

```
Evidence evidence = new Evidence();
evidence.AddHostEvidence(new Zone(SecurityZone.MyComputer));
PermissionSet ps = SecurityManager.GetStandardSandbox(evidence);
AppDomainSetup currentAppDomainSetup = AppDomain.CurrentDomain.SetupInformation;
AppDomainSetup newAppDomainSetup = new AppDomainSetup()
{
    ApplicationBase = currentAppDomainSetup.ApplicationBase,
    LoaderOptimization = currentAppDomainSetup.LoaderOptimization,
    ConfigurationFile = currentAppDomainSetup.ConfigurationFile,
    PrivateBinPath = @"Modules"  // need to set this so that the new AppDomain can see the prism modules
};
newAppDomainSetup.SetCompatibilitySwitches(new[] { "NetFx40_LegacySecurityPolicy" }); // required for POS for .Net to function properly 
```

# java - SSL 和验证用户

> ID：12610356
> 
> 赞同：1
> 
> 时间：2012-09-26T21:03:18.790
> 
> 标签：java, security, rest, ssl

我有一个客户端通过 SSL 连接的 REST API（自签名证书 2048 位）

我正在考虑实施以下安全性

1.  客户端向服务器请求一个 RSA 公钥
2.  加密用户名/密码
3.  将这些添加到每个 REST 调用的标题中，允许服务器无状态

该应用程序涉及用户添加信用卡（数字本身是加密的）和购买产品，因此安全性至关重要

从 iphone 客户端的角度来看，我们的时间也非常有限，所以我希望以上内容是否合适？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:17:12.823

通常，在安全方面，人们不想重新发明轮子。使用最先进的技术要好得多，因此您将从其他人（可能比您更熟练）的工作中受益。

如果您在 SSL 上有一个 RESTful API，我认为您没有编写自己的自定义 TCP 协议。您可能会使用 HTTP，因此由于它在 SSL 上，因此您在 HTTPS 上。

使用 HTTPS 时，您的浏览器会确保对请求进行签名和加密，以便只有另一端（服务）可以验证客户端并解密消息。因此无需加密数据和使用自定义标头。一个简单的基于 cookie 的会话就足够了，因此您不必在每个请求中都发送用户的密码。

# windows - 用于使用公钥身份验证连接到远程 SFTP 服务器的 Windows 脚本

> ID：12610360
> 
> 赞同：2
> 
> 时间：2012-09-26T21:03:27.473
> 
> 标签：windows, sftp, putty, public-key-encryption

我正在尝试为我们的客户连接到 SFTP 服务器，并使用 MS windows 在自动化过程中发送文件。我从客户那里收到的详细信息不包括密码。相反，我有使用 PuTTY 的公私钥对。

使用的典型连接字符串如下：

打开 sftp://username:password.SFTPURL:port -hostkey="ssh-dss 1024 XXXXXXX"

但是，我不明白如何在此连接中指定私钥而不是密码。如何告诉脚本私钥所在的位置以及使用公钥连接时是否有特定的关键字可以使用？

我是新手，所以请多多包涵。

谢谢！

# ios - 异步数据下载程序中断

> ID：12610362
> 
> 赞同：1
> 
> 时间：2012-09-26T21:03:33.220
> 
> 标签：ios, objective-c, asynchronous, grand-central-dispatch, afnetworking

跟进帖子：[AFNetworking 可以同步返回数据（在一个块内）吗？](https://stackoverflow.com/questions/7969865/can-afnetworking-return-data-synchronously-inside-a-block)

该帖子中的评论之一是：

> 异步编程的诀窍是打破程序同步的假设，即当您请求数据时，数据就在那里。相反，使用异步，当您请求某些内容时，您会给它一个回调，以便在数据最终准备好时执行。在这种情况下，您将调用 JSON 操作的成功块中的块。它不是返回数据的方法，而是告诉当数据下载完成时要做什么。

尽管我在 iOS 上使用 GCD 和异步下载，但我并不真正了解在使用异步编程时如何实现这种“程序中断”。

例如，假设我需要下载一些 JSON 数据，其中包含大量数据，包括图像 URL。之后我将不得不下载实际图像。

表中的每个单元格都从下载的 JSON/图像中获取数据。在这种情况下，我将如何实施这个程序中断？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:06:39.263

当您的数据尚未到达时，您的表视图 dataSource 会告诉其表视图它有零行，并显示一个微调器。当回调被触发时，你将数据存储在某个地方，移除微调器，然后调用`[tableView reloadData]`. 基本上，这就是它的全部内容。

# ruby-on-rails - Heroku Mailer 延迟作业因 ArgumentError 失败：参数数量错误（0 代表 1）- 0 次尝试失败

> ID：12610367
> 
> 赞同：1
> 
> 时间：2012-09-26T21:04:03.300
> 
> 标签：ruby-on-rails, heroku, delayed-job

我创建了两个邮件程序，其中一个不在 Heroku 的生产环境中工作。另一个邮件程序已经过测试并且可以正常工作，所以我知道使用 sendgrid 的电子邮件配置正在工作。

我有一个邀请模型：

```
class Invitation < ActiveRecord::Base
  attr_accessible :recipient_email, :sender_id, :sent_at, :token
  belongs_to :sender, :class_name => 'User'
  has_one :recipient, :class_name => 'User'
  validates_presence_of :recipient_email
  validate :recipient_is_not_registered
  validate :sender_has_invitations, :if => :sender

  before_create :generate_token
  before_create :decrement_sender_count, :if => :sender 
  after_create do |invitation|
  Mailer.delay.deliver_invitation(invitation)
  end

  private

  def recipient_is_not_registered
    errors.add :recipient_email, 'is already registered' if User.find_by_email(recipient_email)
  end

  def sender_has_invitations
    unless sender.invitation_limit > 0
      errors.add_to_base 'You have reached your limit of invitations to send.'
    end
  end

  def generate_token
    self.token = Digest::SHA1.hexdigest([Time.now, rand].join)
  end

  def decrement_sender_count
    sender.decrement! :invitation_limit
  end
end 
```

邮递员：

```
class Mailer < ActionMailer::Base
  helper ActionView::Helpers::UrlHelper
 default from: "noreply@lumeo.com"

 def invitation(invite)
   @invitation = invite

   mail to: invitation.recipient_email, subject: "Invitaiton"
 end
end 
```

一个文本文件：

```
You are invited to join our beta!
<%= link_to 'Sign Up', signup_url(@invite.token) %> 
```

还有一个观点：

```
<div class="breadcrumbs span12 row">
    <p>
        <%= link_to "contests", contests_path %> > send invitation
    </p>
</div>
<div class="span12">
    <div class = "span6 offset2 pull-left">
        <div class="title">
            <h1>Invite Friends</h1>
        </div>
        <%= simple_form_for @invitation do |f| %>
            <fieldset class="edit well">
                <p></p>
                <p><%= f.input :recipient_email, :label => "Friend's email address" %></p>
            </fieldset>
            <div class="form-actions">
                  <%= f.submit 'Send Invite', :class => 'btn btn-primary pull-right btn-large m5' %>
            </div>
        <% end %>
    </div>
    <div class = "well pull-right span2">
        <% if current_user.invitation_limit > 0 %>
        <p>
            Welcome <%= current_user.name %>, 
            you have <%= current_user.invitation_limit %> invitations left</p>
        <% else %>
        <% end %>
    </div>

</div> 
```

这是heroku的日志文件：

```
heroku[router]: GET www.lumeo.com/invitations/new dyno=web.1 queue=0 wait=0ms service=85ms status=200 bytes=4922
app[worker.1]: [Worker(host:881b0507-883f-43b1-b3aa-7cfddc9c17fa pid:2)] Class#invitation failed with ArgumentError: wrong number of arguments (0 for 1) - 0 failed attempts
app[worker.1]: [Worker(host:881b0507-883f-43b1-b3aa-7cfddc9c17fa pid:2)] Class#invitation failed with ArgumentError: wrong number of arguments (0 for 1) - 1 failed attempts
app[worker.1]: [Worker(host:881b0507-883f-43b1-b3aa-7cfddc9c17fa pid:2)] 2 jobs processed at 4.3239 j/s, 2 failed ...
app[worker.1]: [Worker(host:881b0507-883f-43b1-b3aa-7cfddc9c17fa pid:2)] Class#invitation failed with ArgumentError: wrong number of arguments (0 for 1) - 2 failed attempts
app[worker.1]: [Worker(host:881b0507-883f-43b1-b3aa-7cfddc9c17fa pid:2)] Class#invitation failed with ArgumentError: wrong number of arguments (0 for 1) - 3 failed attempts
app[worker.1]: [Worker(host:881b0507-883f-43b1-b3aa-7cfddc9c17fa pid:2)] 2 jobs processed at 11.4575 j/s, 2 failed ... 
```

app[postgres]：[13913-1] [WHITE] LOG：检查点开始：时间 app[postgres]：[13914-1] [WHITE] LOG：检查点完成：写入 0 个缓冲区（0.0%）；添加了 0 个事务日志文件，删除了 0 个，回收了 1 个；写入=0.000 秒，同步=0.000 秒，总计=0.007 秒；同步文件=0，最长=0.000 秒，平均=0.000 秒

如果您有任何建议，请告诉我。提前致谢。布赖恩

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-30T05:53:14.850

该问题的答案可能对其他人有帮助，也可能对其没有帮助。我定义了两个邮件程序类，一个在 mailers/mailer.rb 中，另一个在 models/mailer.rb

Rails 2.0 显然没有使用 mailers 目录，我一直在关注两个不同的来源以获取有关如何设置它的信息。其他人可能会遇到同样的问题，所以就是这样。我删除了 models/mailer.rb 文件

# java - JBoss 7.1.1 Final、Weld 和 Seam 3 上的 Hibernate Search

> ID：12610370
> 
> 赞同：4
> 
> 时间：2012-09-26T21:04:05.827
> 
> 标签：java, jboss7.x, hibernate-search

我正在运行一个使用休眠搜索在系统中查找人员的应用程序。我在 JBoss AS 7.1.1 上运行它，应用程序基于 Seam 3、Weld 和 JSF 2.1。它运行顺利，但经过一些较高的负载后，使用 的页面`FullTextEntityManager`加载速度非常慢。在某些时候，整个应用程序正在减速。

所以我想到也许我错误地使用了 Hibernate 搜索。我正在使用启动单例来索引数据库：

```
@Singleton
@Startup
public class Initializer implements Serializable {

    private static final long serialVersionUID = 1L;

    @PersistenceContext
    private EntityManager entityManager;

    @PostConstruct
    public void startup() throws Exception {
        FullTextEntityManager fullTextEntityManager = Search.getFullTextEntityManager(entityManager);
        fullTextEntityManager.createIndexer().startAndWait();
    }

} 
```

然后我`FullTextEntityManager`在 PrimeFaces 的自动完成组件中使用的方法中使用：

```
@Session Scoped
public class ... {

        private QueryBuilder queryBuilder;

        @Inject
        private EntityManager entityManager;

        @PostConstruct
        public void initFulltext() {
            fullTextEntityManager = org.hibernate.search.jpa.Search.getFullTextEntityManager(entityManager);
            queryBuilder = fullTextEntityManager.getSearchFactory().buildQueryBuilder().forEntity(Person.class).get();

        }

        @Override
        @SuppressWarnings("unchecked")
        public List<Person> autocomplete(Object event) throws Exception {
            if (event.toString() != null && !event.toString().trim().isEmpty()) {
                org.apache.lucene.search.Query query = queryBuilder.keyword()
                        .onFields("username", "firstname", "lastname").matching(event.toString())
                        .createQuery();

                FullTextQuery persistenceQuery = fullTextEntityManager.createFullTextQuery(query, Person.class);
                persistenceQuery.setMaxResults(MAX_RESULTS_ON_PAGE);

                return persistenceQuery.getResultList();
            }
            return null;
        }
} 
```

这是在 Java EE 应用程序中正确使用 Hibernate Search 吗？一段时间后，休眠搜索是否可能会尝试同步实体和Lucene索引的更改？如果是这样，它是否可能对性能造成巨大影响？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-29T20:25:59.183

我想说的是休眠搜索的正确用法。它的字段缓存会降低您的性能。这实际上取决于查询。[在此处](http://docs.jboss.org/hibernate/search/3.4/reference/en-US/html_single/#d0e5769)阅读第 5.5 节，应该会有所帮助。

# recursion - 递归列表创建函数。类型错误

> ID：12610373
> 
> 赞同：4
> 
> 时间：2012-09-26T21:04:17.497
> 
> 标签：recursion, ocaml

我有一个给我错误的 Ocaml 函数。

我正在尝试做的事情：

递归地创建大小为“限制”的随机数 (0-2) 列表。

这是我所拥有的：

```
let rec carDoorNumbers = fun limit -> 
match limit with
| [1] -> Random.int 3
| [] -> Random.int 3 :: carDoorNumbers (limit-1);; 
```

我收到此错误：

```
Error: This expression has type 'a list
   but an expression was expected of type int 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:11:09.190

想想你的函数必须做什么：给定一个限制，你必须创建一个数字*列表*。所以你的类型类似于`carDoorNumbers : int -> int list`.

看起来，你似乎有两个错误。首先，您将`limit`（应该是`int`）与列表模式匹配。`[1] -> ...`匹配仅包含元素的列表`1`并`[]`匹配空列表；你真的想匹配号码`1`和任何其他号码`n`。

第二个错误是您在`match`语句中返回了两种不同的类型。请记住，您应该返回一个列表。在第一种情况下，您正在返回`Random.int 3`，这是一个`int`而不是一个`int list`。你真正想在这里返回的是`[Random.int 3]`.

你得到的错误有点令人困惑。由于您返回的第一件事是一个`int`，它希望您的第二件事*也是*一个`int`。但是，您的第二种情况实际上是正确的：您*确实*返回了`int list`! 但是，编译器不知道你的意思，所以它的错误是向后的；而不是将 更改`int list`为`int`，您需要将 更改`int`为`int list`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:11:06.710

您的`match`表达式将限制视为列表。`[1]`和都是`[]`列表。这就是编译器告诉你的。但似乎限制应该是一个整数。

要匹配整数，只需使用整数常量。没有方括号。

（作为旁注，您可能希望确保函数在传递 0 时运行良好。）

# arm - GCC 使用 ARM VFP 指令操作的正确内联汇编约束是什么？

> ID：12610375
> 
> 赞同：4
> 
> 时间：2012-09-26T21:04:26.543
> 
> 标签：arm, constraints, inline-assembly, binutils, double-precision

我想使用 Google NDKv8b 附带的工具链 (gcc-4.6) 将双精度寄存器 (d8) 的值加载到 ARM 平台上的 C 变量中。我的 ARM 机器是三星 Galaxy S2（它有 VFPv3 和 NEON）。GCC 文档说，为了在内联汇编中使用 VFP 双精度寄存器，必须使用“w”约束。所以我尝试了这样的事情（好吧，不要过多地研究整个程序的逻辑）：

```
#include <stdio.h>

int main()
{
    double dVar = 1.2345678;
    double dTmp;
    int i;
    for(i = 0; i < 100; i++ )
    {
        asm volatile(
            "vmov.f64 %[dTmp], d8\n"
            : [dTmp] "=w" (dTmp)
            :
            :
        );
        dVar *= 10.0;
        printf("d8 = %f\n", dTmp );
    }

    return 0;
} 
```

好吧，它甚至没有编译：

```
/tmp/cc9wQA1z.s: Assembler messages:
/tmp/cc9wQA1z.s:62: Internal error, aborting at /usr/local/google/home/andrewhsieh/ndk-andrewhsieh/src/build/../binutils/binutils-2.21/gas/config/tc-arm.c line 14709 in do_neon_mov 
```

我怎样才能做到这一点？

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-28T13:35:40.120

我已将代码部分更改如下，

```
"vmov.f64 %P[dTmp2], d8\n" 
```

在此之后我可以编译。我没有验证生成的代码。

有关`P`限制，请查看[Hardwarebug/ARM inline asm secrets](http://hardwarebug.org/2010/07/06/arm-inline-asm-secrets/)和此[电子邮件线程](http://communities.mentor.com/community/cs/archives/arm-gnu/msg03656.html)。

# c# - c# GDI+内存不足异常

> ID：12610376
> 
> 赞同：3
> 
> 时间：2012-09-26T21:04:27.893
> 
> 标签：c#, gdi+, out-of-memory, lineargradientbrush

**简介：**让我们在平面上设置点 (x, y) 并返回 double 的 func F(x, y)。在用户定义的矩形中随机生成点（这意味着对变量的约束）。让我们将生成点的数量设置为 N。这个设置比三角剖分（Delaunay triangulation）。想象一下，这个三角剖分设置了 func F(x, y) 的曲面的近似值。边缘上的值线性变化（所以它只是点之间的范围（x，y，z = F（x，y））。顶点是插值的顶点。所以我们将三角形本身作为插值平面。
我在标准上绘制三角剖分`PictureBox`. 边缘是使用绘制的`LinearGradientBrush`- 颜色反映值 F(x, y) 的水平（棕色 - 最大值，浅绿色 - 最小值，绿色 - 中间）。这一切都有效，直到我设置 N >= M，其中 M 不时从 ~30k 到 50k 变化。在这些情况下，我会遇到内存不足异常。虽然我没有在任务管理器中看到缺乏可操作内存，但我认为它指的是视频内存，不是吗？
我可以在不使用颜色渐变的情况下绘制 N = 100k 的三角剖分（只是简单的纯单色边缘），所以我认为问题在于`LinearGradientBrush`使用或创建 GDI 对象`Pen`以及`LinearGradientBrush`每次迭代。
**一些代码：**

```
private void pboxTriangulation_Paint(object sender, PaintEventArgs e)
{
    e.Graphics.SmoothingMode = SmoothingMode.AntiAlias;
    if (null != dt)
        PaintWithGradient(e.Graphics);
}

private void PaintWithGradient(Graphics g)
{
    //here I erased code block
    //where I find min, max and middle values of F(x, y) on a set        

    foreach (Triangle t in dt.triangles)
    {
        System.Drawing.PointF[] ps = new System.Drawing.PointF[3];
        Color[] colors = new Color[3];
        for (int i = 0; i < 3; i++)
        {
            //here for every i-th point I find its display coordinates - ps[i]
            //and color of vertex - colors[i]
        }

        for (int i = 0; i < 3; i++)
        {
            using (LinearGradientBrush b = new LinearGradientBrush(ps[i], ps[(i + 1) % 3], colors[i], colors[(i + 1) % 3]))
            {
                using (Pen pen = new Pen(b))
                {
                    g.DrawLine(pen, ps[i], ps[(i + 1) % 3]);
                }
            }
        }
    }
} 
```

**示例：** [n = 10k](http://i.imgur.com/yLpKr.png) , [n = 100k (built as x86)](http://i.imgur.com/cnQA1.png) , [n = 200k (built as x86)](http://i.imgur.com/cW7zR.png)
**问题：**问题是什么，我该如何解决？
请不要建议使用其他绘图工具作为解决方案（例如 OpenGL 和其他强大的工具），但如果您只想将其写为问题的评论 - 我会记住它，也许它将来会有用。这个问题不是关于如何在广义上用渐变边缘绘制三角剖分，而是关于我的情况的异常根源是什么。

**UPD**：程序是在 x64 中构建的。在 x86 中，它绘制 200k（未尝试更高的 N）并且看起来还可以。一段时间后下降了 300k，分配了 ~1.8gb。

# c++ - 仅用于代码重用c ++的继承

> ID：12610378
> 
> 赞同：6
> 
> 时间：2012-09-26T21:04:33.640
> 
> 标签：c++, oop, inheritance, multiple-inheritance

我有 A 和 B 类。现在我需要编写一个新的 C 类，它将使用 A 和 B 中的一些字段和方法，但不是全部。（我将使用 A 和 B 中大约 50% 的东西）。

现在我正在考虑从 A 和 B 继承。但这会使 C 包含很多没有意义的字段和方法。

基本上我只是为了代码重用的目的而使用继承，否则我将不得不从 A 和 B 复制和粘贴多行代码。

这种做法真的很糟糕吗？有不同的方法吗？

谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:25:57.640

继承没有“是一半”的概念，所以绝对不是这里要走的路。听起来这是作曲的主要案例。

这听起来像`A`并且`B`具有多个“功能”，因为它们中的一半足以组成一个`C`.

我不确定这是否适用于您的情况，但请考虑将 A 分成两部分，`A1`并具有in`A2`所需的功能。然后对into和执行相同的操作。`C``A1``B``B1``B2`

`A`然后将是`A1`and的组合`A2`，`B`将是 and 的组合，并且`B1`将是 and 的`B2`组合。它们都没有任何不必要的功能或数据。`C``A1``B1`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T21:32:58.290

正如 Herb Sutter 和 Andrei Alexandrescu 在他们的《*[C++ 编码标准》（第 34 项）](http://www.gotw.ca/publications/c++cs.htm)*一书中所解释的，继承是 C++ 允许您在两个类之间使用的最紧密的关系之一——它仅次于`friend`类之间的关系。

根据[OO 的 SOLID 原则](http://butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod)，成功的设计应该以类之间的*松散耦合*为目标——这意味着将依赖关系保持在最低限度；这反过来意味着继承是一个应该小心使用的工具。

当然，依赖项通常需要存在*于某个地方*`interface`，因此一个合理的折衷方案可以是从根本没有实现的类继承（类似于C# 和 Java 等语言中的所谓s）。例如

```
class IDriveable
{
public:
    virtual void GoForward() = 0;
    virtual void GoBackward() = 0;
};

class Car : public IDriveable { /* etc. */ };
class Bus : public IDriveable { /* etc. */ };
class Train : public IDriveable { /* etc. */ }; 
```

使用这种方法，如果您有在多个*Drivable*类之间重用的代码元素，您通常会使用组合或其他一些较弱的关系来消除重复的代码。
例如，也许您想将代码重`TurnLeft`用于 a`Bus`和 a`Car`但不是 a `Train`where 左转是不合逻辑的，因此`TurnLeft`最终可能会出现在一个单独的类中，它是`Bus`and的成员`Car`。

*   此外，任何可能需要了解所有模糊相关类的功能都将在类层次结构之外，只知道接口/基础而不是具体的实现细节。

最终结果可能是少量的额外代码用于组合，但通常是不太复杂的设计，通常是更易于管理的设计。设计这样的代码没有任何硬性规则，因为它完全取决于您要解决的独特问题。

还有其他方法可以在不紧密耦合的情况下重用代码 - 模板允许您隐式定义接口，而无需包含纯`virtual`函数的空类（模板提供额外的类型安全 - 这是一件非常**好的**事情，但它们在语法上有点复杂）；

并且您可以使用一些方法`std::function`和 lambdas 以便以更具功能性的风格重用代码 - 同样，在传递函数对象时通常不涉及紧密的依赖关系。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-09-26T21:12:36.483

继承应该使用“is a”范式。
这意味着如果 C 是 A 和 B 的一种，则 C 应该从 A，B 继承。
如果您已经在使用多重继承，您可能希望将 A 和 B 分解为多个类，每个类处理一小段代码，然后只从你需要的东西继承 C - 这样 C 只会占用它需要的空间（假设 A 和 B 有很多成员）。
请记住，您的类的大小不受成员方法的影响，只有成员数据。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-09-26T21:09:30.940

这是坏的。只有在逻辑上有意义时才使用继承。

改用组合（`private`继承是组合的一种形式，但最好是老派）：

```
class C
{
    A a;
    B b;
} 
```

如果`C`不是由`A`and组成`B`，您也可以改为保留指针，因此 的大小`C`不会增加。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-09-26T22:37:44.220

听起来您可以从重构代码中受益：

而不是这个：

```
class A
{
  virtual void foo();
  virtual void bar();
};

class B
{
  virtual void biz();
  virtual void baz();
};

class C : public A, public B
{
  virtual void foo() { /* my stuff */ }
  virtual void biz() { /* my other stuff */ +

  // but I don't need bar or baz!
}; 
```

考虑在 C 中拆分您想要的 A 和 B 的概念上不同的部分：

```
class core_A
{
  virtual void foo();
};

class A : public core_A
{
  virtual void bar();
};

class core_B
{
  virtual void biz();
};

class B : public core_B
{
  virtual void baz();
};

class C : public core_A, public core_B
{
  virtual void foo() { /* my stuff */ }
  virtual void biz() { /* my other stuff */ +

  // Great, I don't have bar or baz!
}; 
```

# file - 创建内容在批处理代码中的文件

> ID：12610379
> 
> 赞同：1
> 
> 时间：2012-09-26T21:04:35.747
> 
> 标签：file, for-loop, batch-file, while-loop, creation

我想从我正在运行的批处理文件中创建另一个文件输出，这意味着原始内容在其中。在这个批处理文件中，它会执行一段时间或 for 循环，直到找到“结束”或我在内容末尾添加的任何唯一单词。

我不想简单地复制文件（包含重要内容），因为这会暴露信息。然后通过批处理调用文件来运行它。

```
code:
-start of batch
-check if the file a.txt exist del a.txt
-starts to create the a.txt file

>start of content:
>"the quick brown fox jump over the lazy dog"
>lynx: unique word
>end of content

-writes the content to a.txt using for loop or while until it finds the unique word
-runs the a.txt file
-deletes the a.txt file
-exit 
```

希望有人可以提供帮助。谢谢！或者，如果有人可以提出更好的方法来做到这一点。我会很感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T03:39:20.037

for 命令本身的行将需要引号。

For 循环工作正常，直到它们碰到包含引号的行，然后一切都变成奶油冻......

你不能从这里到达那里。

也许改用vbscript？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T07:30:51.090

```
@echo off
setlocal enabledelayedexpansion
if exist a.txt del a.txt

copy nul a.txt > nul                      & :: Not needed, but in your specs

set line[1]=This is what you asked for.
set line[2]=Not really the best method.
set line[3]=But it will work.
set line[4]=
set line[5]=linux
set line[6]=[end]

for /l %%i in (1,1,1000) do (
  if     "!line[%%i]!"=="linux" goto :end
  if     "!line[%%i]!"=="[end]" goto :end
  if     "!line[%%i]!"=="" echo.>>a.txt
  if NOT "!line[%%i]!"=="" echo !line[%%i]!>>a.txt
)

:end
:: Broken Out Of Loop

ren a.txt a.bat
call a.bat
del a.bat 
```

使用该`line[n]`方法相当浪费内存，我建议将数据从一个文件移动到另一个文件。

# database-deadlocks - 死锁管理

> ID：12610387
> 
> 赞同：1
> 
> 时间：2012-09-26T21:05:33.603
> 
> 标签：database-deadlocks

我正在做一项研究，但很难找到任何相关信息。我偶然发现了这个问题：

为以下事务场景生成等待图并确定是否存在死锁。

交易：

```
T1
T2
T3
T4
T5
T6
T7
T8
T9
T10 
```

事务锁定的数据项：

```
X1,X2,X3
X4,X5,X6
X7,X8
X9,X10
X11,X12
X13,X14
X15
X1111 
X115
X199 
```

数据项事务正在等待：

```
X4,X5,X6,X7
X7,X8,X9
X1,X10,X111
X7,X11,X12
X5
X6,X1,X2,X3,X11,X12
X5
X1,X115
X1
X11,X12 
```

现在，就我在事务管理方面所见，这让我非常震惊。有人可以提供参考解释如何解决此类问题，或者无论如何提供帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:22:42.037

很常见的是，解决一些问题的关键是选择一个好的表示。如果您以表格形式表示您的问题：

```
T1 =>  { locked => [ qw( X1 X2 X3 ) ], waiting => [ qw( X4 X5 X6 X7         ) ] },
T2 =>  { locked => [ qw( X4 X5 X6 ) ], waiting => [ qw( X7 X8 X9            ) ] },
T3 =>  { locked => [ qw( X7 X8    ) ], waiting => [ qw( X1 X10 X111         ) ] },
T4 =>  { locked => [ qw( X9 X10   ) ], waiting => [ qw( X7 X11 X12          ) ] },
T5 =>  { locked => [ qw( X11 X12  ) ], waiting => [ qw( X5                  ) ] },
T6 =>  { locked => [ qw( X13 X14  ) ], waiting => [ qw( X6 X1 X2 X3 X11 X12 ) ] },
T7 =>  { locked => [ qw( X15      ) ], waiting => [ qw( X5                  ) ] },
T8 =>  { locked => [ qw( X1111    ) ], waiting => [ qw( X1 X115             ) ] },
T9 =>  { locked => [ qw( X115     ) ], waiting => [ qw( X1                  ) ] },
T10 => { locked => [ qw( X199     ) ], waiting => [ qw( X11 X12             ) ] }, 
```

然后你可以更有效地推理手头的问题。很容易看到某个事务正在等待什么资源，从那里你可以看到哪些事务持有这些资源。递归地应用该推理。如果你最终进入一个循环，你刚刚发现了一个死锁。

'当然，表示甚至可以更好：

```
use strict;
use warnings;

use Data::Dumper;

my %transactions = (
    T1 =>  { locked => [ qw( X1 X2 X3 ) ], waiting => [ qw( X4 X5 X6 X7         ) ] },
    T2 =>  { locked => [ qw( X4 X5 X6 ) ], waiting => [ qw( X7 X8 X9            ) ] },
    T3 =>  { locked => [ qw( X7 X8    ) ], waiting => [ qw( X1 X10 X111         ) ] },
    T4 =>  { locked => [ qw( X9 X10   ) ], waiting => [ qw( X7 X11 X12          ) ] },
    T5 =>  { locked => [ qw( X11 X12  ) ], waiting => [ qw( X5                  ) ] },
    T6 =>  { locked => [ qw( X13 X14  ) ], waiting => [ qw( X6 X1 X2 X3 X11 X12 ) ] },
    T7 =>  { locked => [ qw( X15      ) ], waiting => [ qw( X5                  ) ] },
    T8 =>  { locked => [ qw( X1111    ) ], waiting => [ qw( X1 X115             ) ] },
    T9 =>  { locked => [ qw( X115     ) ], waiting => [ qw( X1                  ) ] },
    T10 => { locked => [ qw( X199     ) ], waiting => [ qw( X11 X12             ) ] },
);

# get a data-item -> transaction mapping
my %items;
for my $transaction (keys %transactions) {
    for my $item (@{$transactions{$transaction}->{locked}}) {
            $items{$item} = $transaction;
    }
}

my @nodes;
my @edges;
for my $transaction (keys %transactions) {
    push @nodes, $transaction;
    for my $item (@{$transactions{$transaction}->{waiting}}) {
            push @edges, { source => $transaction, dest => $items{$item}, item => $item } if $items{$item};
    }
}

print "digraph tx_dependencies {\n";
print "    $_ label=$_;\n" for @nodes;
print "    @{[ $_->{source} ]} -> @{[ $_->{dest} ]} [label=@{[ $_->{item} ]}];\n" for @edges;
print "}\n"; 
```

该程序会生成一个 graphviz 文件，当对其进行适当的按摩时，`dot`最终结果为：

![有向图 tx_dependencies {T1 标签=T1；T9 标签=T9；T8 标签=T8；T3 标签=T3；T4 标签=T4；T6 标签=T6；T7 标签=T7；T5 标签=T5；T10 标签=T10；T2 标签=T2;T1 -> T2 [标签=X4];T1 -> T2 [标签=X5];T1 -> T2 [标签=X6];T1 -> T3 [标签=X7];T9 -> T1 [标签= X1];T8 -> T1 [标签=X1];T8 -> T9 [标签=X115];T3 -> T1 [标签=X1];T3 -> T4 [标签=X10];T4 -> T3 [标签= X7];T4 -> T5 [标签=X11];T4 -> T5 [标签=X12];T6 -> T2 [标签=X6];T6 -> T1 [标签=X1];T6 -> T1 [标签= X2];T6 -> T1 [标签=X3];T6 -> T5 [标签=X11];T6 -> T5 [标签=X12];T7 -> T2 [标签=X5];T5 -> T2 [标签= X5];T10 -> T5 [标签=X11];T10 -> T5 [标签=X12];T2 -> T3 [标签=X7];T2 -> T3 [标签=X8];T2 -> T4 [标签= X9];}](../Images/929dfb46efa9ce7e493521873e256f1e.png)

# mysql - LIMIT 专精

> ID：12610388
> 
> 赞同：1
> 
> 时间：2012-09-26T21:05:35.913
> 
> 标签：mysql, limit

```
SELECT *, IFNULL(parent, id) AS p, IFNULL(reply_comment_id, id) AS r
FROM article_comments ORDER BY p ASC, r ASC, date DESC 
```

![在此处输入图像描述](../Images/1076bba47961ae078a6c270c842db42c.png)

我想使用限制。如果我有更多行，我想将查询限制为“p”。在图像中：("p": 1, 1, 1, 1, 1) – 这是一个，("p": 2, 2, 2, 2, 2, 2, 2) – 这是两个...

例如，我想要：如果我使用 LIMIT 1，则只显示 ("p": 1, 1, 1, 1, 1)。![在此处输入图像描述](../Images/e504a10665b9fae03dacb283aceffb9f.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:27:56.593

这是我将使用的查询：

```
SELECT * FROM
FROM article_comments
WHERE id = 1 OR parent = 1
ORDER BY parent ASC, reply_comment_id ASC, `date` DESC 
```

请注意，我认为这里不需要您的计算列。当按 parent 和 reply_comment_id 以升序方式排序时，NULL 值将排在第一位。

确保您在 parent、reply_comment_id 和 date 字段上有索引（除了 id，我假设它是主键）

此外，您可能需要考虑为日期列使用日期时间字段，而不是 unix 时间戳。在查看数据库中的数据以及尝试查询日期范围时，它对用户非常友好/因此可以这样编写过滤器：

```
WHERE `date` BETWEEN '2012-01-01 00:00:00' AND '2012-12-31 23:59:59' 
```

而不必由于时间戳转换。

# javascript - JavaScript 类

> ID：12610394
> 
> 赞同：47
> 
> 时间：2012-09-26T21:05:56.430
> 
> 标签：javascript, oop, design-patterns

我了解基本的 JavaScript 伪类：

```
function Foo(bar) {
    this._bar = bar;
}

Foo.prototype.getBar = function() {
    return this._bar;
};

var foo = new Foo('bar');
alert(foo.getBar()); // 'bar'
alert(foo._bar); // 'bar' 
```

我也了解模块模式，它可以模拟封装：

```
var Foo = (function() {
    var _bar;

    return {
        getBar: function() {
            return _bar;
        },
        setBar: function(bar) {
            _bar = bar;
        }
    };
})();

Foo.setBar('bar');
alert(Foo.getBar()); // 'bar'
alert(Foo._bar); // undefined 
```

但是这两种模式都有类似 OOP 的属性。前者不提供封装。后者不提供实例化。两种模式都可以修改以支持伪继承。

我想知道的是是否有任何模式允许：

*   遗产
*   封装（支持“私有”属性/方法）
*   实例化（可以有多个“类”实例，每个实例都有自己的状态）

* * *

## 回答 #1

> 赞同：73
> 
> 时间：2012-09-26T21:16:38.327

那这个呢 ：

```
var Foo = (function() {
    // "private" variables 
    var _bar;

    // constructor
    function Foo() {};

    // add the methods to the prototype so that all of the 
    // Foo instances can access the private static
    Foo.prototype.getBar = function() {
        return _bar;
    };
    Foo.prototype.setBar = function(bar) {
        _bar = bar;
    };

    return Foo;
})(); 
```

现在我们有了实例化、封装和继承。
但是，还是有问题。该`private`变量是`static`因为它在所有`Foo`. 快速演示：

```
var a = new Foo();
var b = new Foo();
a.setBar('a');
b.setBar('b');
alert(a.getBar()); // alerts 'b' :( 
```

更好的方法可能是使用私有变量的约定：任何私有变量都应该以下划线开头。这个约定是众所周知的并且被广泛使用，因此当另一个程序员使用或更改您的代码并看到以下划线开头的变量时，他会知道它是私有的，仅供内部使用并且他不会修改它。
这是使用此约定的重写：

```
var Foo = (function() {
    // constructor
    function Foo() {
        this._bar = "some value";
    };

    // add the methods to the prototype so that all of the 
    // Foo instances can access the private static
    Foo.prototype.getBar = function() {
        return this._bar;
    };
    Foo.prototype.setBar = function(bar) {
        this._bar = bar;
    };

    return Foo;
})(); 
```

现在我们有了实例化、继承，但是我们失去了封装，转而支持约定：

```
var a = new Foo();
var b = new Foo();
a.setBar('a');
b.setBar('b');
alert(a.getBar()); // alerts 'a' :) 
alert(b.getBar()); // alerts 'b' :) 
```

但是可以访问私有变量：

```
delete a._bar;
b._bar = null;
alert(a.getBar()); // alerts undefined :(
alert(b.getBar()); // alerts null :( 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-09-26T21:13:26.130

我认为您正在寻找的是“显示原型模式”。

Dan Wahlin 有一篇很棒的博文：[http://weblogs.asp.net/dwahlin/archive/2011/08/03/techniques-strategies-and-patterns-for-structuring-javascript-code-revealing-prototype-pattern。 aspx](http://weblogs.asp.net/dwahlin/archive/2011/08/03/techniques-strategies-and-patterns-for-structuring-javascript-code-revealing-prototype-pattern.aspx)

甚至更好的关于这个和其他相关 JavaScript 结构的 Pluralsight 课程： [http ://pluralsight.com/training/courses/TableOfContents?courseName=structuring-javascript&highlight=dan-wahlin_structuring-javascript-module1!dan-wahlin_structuring-javascript-module2!dan -wahlin_structuring-javascript-module5!dan-wahlin_structuring-javascript-module4!dan-wahlin_structuring-javascript-module3#structuring-javascript-module1](http://pluralsight.com/training/courses/TableOfContents?courseName=structuring-javascript&highlight=dan-wahlin_structuring-javascript-module1!dan-wahlin_structuring-javascript-module2!dan-wahlin_structuring-javascript-module5!dan-wahlin_structuring-javascript-module4!dan-wahlin_structuring-javascript-module3#structuring-javascript-module1)

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-22T09:58:39.003

闭包是你的朋友！

只需将以下小函数添加到您的顶级命名空间，您就可以开始 OOP，完成

*   封装，具有静态和实例、私有和公共变量和方法
*   遗产
*   类级注入（例如，用于单例服务）
*   没有限制，没有框架，只是简单的旧 Javascript

* * *

```
function clazz(_class, _super) {
    var _prototype = Object.create((_super || function() {}).prototype);
    var _deps = Array.isArray(_class) ? _class : [_class]; _class = _deps.pop();
    _deps.push(_super);
    _prototype.constructor = _class.apply(_prototype, _deps) || _prototype.constructor;
    _prototype.constructor.prototype = _prototype;
    return _prototype.constructor;
} 
```

上面的函数简单地将给定类的原型和最终的父构造函数连接起来，并返回生成的构造函数，为实例化做好准备。

现在，您可以最自然地在几行代码中声明您的基类（即扩展 {}），包括静态、实例、公共和私有属性和方法：

```
MyBaseClass = clazz(function(_super) { // class closure, 'this' is the prototype
    // local variables and functions declared here are private static variables and methods
    // properties of 'this' declared here are public static variables and methods
    return function MyBaseClass(arg1, ...) { // or: this.constructor = function(arg1, ...) {
        // local variables and functions declared here are private instance variables and methods
        // properties of 'this' declared here are public instance variables and methods
    };
}); 
```

延长课程？也更自然：

```
MySubClass = clazz(function(_super) { // class closure, 'this' is the prototype
    // local variables and functions are private static variables and methods
    // properties of this are public static variables and methods
    return function MySubClass(arg1, ...) // or: this.constructor = function(arg1, ...) {
        // local variables and functions are private instance variables and methods
        _super.apply(this, arguments); // or _super.call(this, arg1, ...)
        // properties of 'this' are public instance variables and methods
    };
}, MyBaseClass); // extend MyBaseClass 
```

换句话说，将父类的构造函数传递给 clazz 函数，并添加`_super.call(this, arg1, ...)`到子类的构造函数中，该构造函数使用所需的参数调用父类的构造函数。与任何标准继承方案一样，父构造函数调用必须首先出现在子构造函数中。

请注意，您可以自由地使用 显式命名构造函数`this.constructor = function(arg1, ...) {...}`，或者`this.constructor = function MyBaseClass(arg1, ...) {...}`如果您需要从构造函数内部的代码简单访问构造函数，或者甚至`return function MyBaseClass(arg1, ...) {...}`像上面的代码一样简单地返回构造函数。哪个你觉得最舒服。

只需像通常从构造函数中一样从此类类中实例化对象：`myObj = new MyBaseClass();`

请注意闭包如何很好地封装类的所有功能，包括其原型和构造函数，为静态和实例、私有和公共属性和方法提供自然命名空间。类闭包中的代码完全没有约束。没有框架，没有约束，只是简单的旧 Javascript。闭包规则！

哦，如果您想将单例依赖项（例如服务）注入到您的类（即原型）中，`clazz`请使用 AngularJS 为您执行此操作：

```
DependentClass = clazz([aService, function(_service, _super) { // class closure, 'this' is the prototype
    // the injected _service dependency is available anywhere in this class
    return function MySubClass(arg1, ...) // or: this.constructor = function(arg1, ...) {
        _super.apply(this, arguments); // or _super.call(this, arg1, ...)
        // the injected _service dependency is also available in the constructor
    };
}], MyBaseClass); // extend MyBaseClass 
```

正如上面的代码试图说明的那样，要将单例注入到一个类中，只需将类闭包作为最后一个条目放入包含所有依赖项的数组中。还要将对应的参数添加到参数前面的类闭包中，`_super`并且与数组中的顺序相同。`clazz`将数组中的依赖项作为参数注入到类闭包中。然后依赖关系在类闭包中的任何地方都可用，包括构造函数。

事实上，由于依赖项被注入到原型中，它们甚至在从类实例化任何对象之前就可用于静态方法。这对于连接您的应用程序或单元和端到端测试非常强大。它还消除了将单例注入构造函数的需要，否则会不必要地破坏构造函数的代码。

检查这个小提琴：http: [//jsfiddle.net/5uzmyvdq/1/](http://jsfiddle.net/5uzmyvdq/1/)

欢迎反馈和建议！

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-26T21:12:36.927

Javascript当然是OOP。您总是有多态性，但是您必须牺牲封装或实例化，这是您遇到的问题。

试试这个来复习你的选择。 [http://www.webmonkey.com/2010/02/make_oop_classes_in_javascript/](http://www.webmonkey.com/2010/02/make_oop_classes_in_javascript/) 还有一个我收藏的老问题： [JavaScript 是面向对象的吗？](https://stackoverflow.com/questions/107464/is-javascript-object-oriented)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-01-29T14:46:46.930

> JavaScript 类是在 ECMAScript 6 中引入的，是 JavaScript 现有的基于原型的继承的语法糖。类语法并未向 JavaScript 引入新的面向对象的继承模型。JavaScript 类提供了一种更简单、更清晰的语法来创建对象和处理继承。

您可以在此链接中查看更多信息[Mozilla 社区](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes)

[Github](https://googlechrome.github.io/samples/classes-es6/index.html)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-02-19T13:21:02.737

我最近在思考这个特定的主题以及各种方法的局限性。我能想出的最佳解决方案如下。

它似乎解决了继承、实例化和封装的问题（至少来自 Google Chrome v.24 上的测试），尽管可能以内存使用为代价。

```
function ParentClass(instanceProperty) {
  // private
  var _super = Object.create(null),
      privateProperty = "private " + instanceProperty;
  // public
  var api = Object.create(_super);
  api.constructor = this.constructor;
  api.publicMethod = function() {
     console.log( "publicMethod on ParentClass" );
     console.log( privateProperty );
  };
  api.publicMethod2 = function() {
     console.log( "publicMethod2 on ParentClass" );
     console.log( privateProperty );
  };
  return api;
}

function SubClass(instanceProperty) {
    // private
    var _super = ParentClass.call( this, instanceProperty ),
        privateProperty = "private sub " + instanceProperty;
    // public
    var api = Object.create(_super);
    api.constructor = this.constructor;
    api.publicMethod = function() {
       _super.publicMethod.call(this); // call method on ParentClass
        console.log( "publicMethod on SubClass" );
        console.log( privateProperty );
    }
    return api;
}

var par1 = new ParentClass(0),
    par2 = new ParentClass(1),
    sub1 = new SubClass(2),
    sub2 = new SubClass(3);

par1.publicMethod();
par2.publicMethod();
sub1.publicMethod();
sub2.publicMethod();
par1.publicMethod2();
par2.publicMethod2();
sub1.publicMethod2();
sub2.publicMethod2(); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2014-09-04T22:41:39.807

许多 JS 类的一个问题是它们不保护它们的字段和方法，这意味着任何使用它的人都可能不小心替换了一个方法。例如代码：

```
function Class(){
    var name="Luis";
    var lName="Potter";
}

Class.prototype.changeName=function(){
    this.name="BOSS";
    console.log(this.name);
};

var test= new Class();
console.log(test.name);
test.name="ugly";
console.log(test.name);
test.changeName();
test.changeName=function(){
    console.log("replaced");
};
test.changeName();
test.changeName(); 
```

将输出：

```
ugly
BOSS
replaced 
replaced 
```

如您所见，changeName 函数被覆盖。以下代码将保护类方法和字段，并使用 getter 和 setter 来访问它们，使其更像是其他语言中的“常规”类。

```
function Class(){
    var name="Luis";
    var lName="Potter";

    function getName(){
         console.log("called getter"); 
         return name;
    };

    function setName(val){
         console.log("called setter"); 
         name = val
    };

    function getLName(){
         return lName
    };

    function setLName(val){
        lName = val;
    };

    Object.defineProperties(this,{
        name:{
            get:getName, 
            set:setName, 
            enumerable:true, 
            configurable:false
        },
        lastName:{
            get:getLName, 
            set:setLName, 
            enumerable:true, 
            configurable:false
        }
    });
}

Class.prototype.changeName=function(){
    this.name="BOSS";
};   

Object.defineProperty(Class.prototype, "changeName", {
    writable:false, 
    configurable:false
});

var test= new Class();
console.log(test.name);
test.name="ugly";
console.log(test.name);
test.changeName();
test.changeName=function(){
    console.log("replaced")
};
test.changeName();
test.changeName(); 
```

这输出：

```
called getter
Luis
called setter 
called getter 
ugly 
called setter 
called setter 
called setter 
```

现在，您的类方法不能被随机值或函数替换，并且 getter 和 setter 中的代码在尝试读取或写入字段时始终运行。

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2014-01-03T03:08:38.983

此闭包允许实例化和封装，但不允许继承。

```
function Foo(){
    var _bar = "foo";

    return {
        getBar: function() {
            return _bar;
        },
        setBar: function(bar) {
            _bar = bar;
        }
    };
};

a = Foo();
b = Foo();

a.setBar("bar");
alert(a.getBar()); // "bar"
alert(b.getBar()); // "foo" 
```

# javascript - 使用带有循环的 AJAX 更新表

> ID：12610397
> 
> 赞同：2
> 
> 时间：2012-09-26T21:06:07.463
> 
> 标签：javascript, php, ajax, html-table

我对 Javascript 还很陌生，尤其是 Ajax，所以请多多包涵……

我想在插入新行后更新一个表，但不是让 Ajax 一起输出一个 html 表，我更喜欢从 PHP mysql 收集所有数据并将其插入到预先存在的表中一个循环。

这就是我通常使用 PHP 和`while()`函数的方式，这样我就可以使用数组插入数据的各个部分。例如`"$mem['Name']"`

```
 $mems = mysql_query($sql,$con);
    while($mem=mysql_fetch_array($mems)){
                $lmc++;

                            echo '<tr class="data">';
                                echo '<td class="index">'.$lmc.'</td>';          
                                echo '<td class="name">'.$mem['Name'].'</td>';
                                echo '<td class="arcid">'.$mem['ArcID'].'</td>';
                                echo '<td class="type">'.$mem['Type'].'</td>';
                                echo '<td class="role">';
                                echo '<input style="width:100%;" type="text" name="art_realname" id="art_realname" class="field" value="'.$mem['Role'].'"   tabindex="1" />';
                                echo '</td>';
                            echo '</tr>';
                        }; 
```

有没有使用 AJAX 的方法，这样我可以首先收集 PHP 文件中的所有数据并将其放入数组中，然后将其发送回 AJAX，最后在实际页面上使用 Javascript 执行循环部分和将它插入到那里的表格中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:14:08.877

此解决方案需要[jQuery](http://jquery.com)，但您可以自由使用任何 JS 框架/lib。

此外，您应该知道使用这些`mysql_*`函数是一个坏主意，因为它们很快就会被弃用。

现在，假设您`ajax.php`的服务器上有一个名为的脚本。您应该以与往常相同的方式查询您的数据库，但不是`echo`ing 它 - 放入一个变量。

```
<?php
/* your script here */
$data = ... /* data your query returned */

header ("Content-Type: application/json" );
echo json_encode ($data);
?> 
```

然后在客户端：

```
$.getJSON ( "ajax.php", function (data) {
   /* data is the $data from your PHP script */
}); 
```

你不是白痴:)

# ios - 动态改变后退按钮图像

> ID：12610398
> 
> 赞同：1
> 
> 时间：2012-09-26T21:06:13.500
> 
> 标签：ios, xcode, cocoa-touch, uiviewcontroller, uibarbuttonitem

我有下面的代码来设置导航栏上的后退按钮图像。导航控制器位于标签栏控制器上。问题是，当我第一次推送视图时，它会显示正确的按钮图像。如果我进入我的设置（在另一个选项卡上）并更改应显示的按钮，然后返回选项卡 1 并再次按下相同的视图，即使在 if 语句中调用了正确的代码，旧的后退按钮仍会显示！现在，如果我弹出视图并再次将其推回，则会显示正确的按钮。

我不明白为什么即使调用代码来更改按钮也不会更改按钮，但是在第一次之后它就可以正常更改！ViewController 的 viewDidLoad 方法每次都会被调用，所以它不像任何东西都应该持续存在。

```
if ([[DataSingleton sharedSingleton] isBlue]) {
    NSLog(@"isBlue");
    // Set toolBar and button colours
    UIImage *navBarImage = [UIImage imageNamed:@"PortraitNavBarBlue"];
    [self.navigationController.navigationBar setBackgroundImage:navBarImage forBarMetrics:UIBarMetricsDefault];
    UIImage *barButton = [[UIImage imageNamed:@"backBlue"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 14, 0, 7)];
    [[UIBarButtonItem appearance] setBackButtonBackgroundImage:barButton forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
} else {
    NSLog(@"notBlue");
    // Set toolBar and button colours
    UIImage *navBarImage = [UIImage imageNamed:@"PortraitNavBar"];
    [self.navigationController.navigationBar setBackgroundImage:navBarImage forBarMetrics:UIBarMetricsDefault];
    UIImage *barButton = [[UIImage imageNamed:@"back"] resizableImageWithCapInsets:UIEdgeInsetsMake(0, 14, 0, 7)];
    [[UIBarButtonItem appearance] setBackButtonBackgroundImage:barButton forState:UIControlStateNormal barMetrics:UIBarMetricsDefault];
} 
```

我认为条形图的颜色可能会很好地改变，因为我调用 self.navigationController.navigationBar 而对于后退按钮，我调用的是全局设置 [UIBarButtonItem 外观]。有没有办法直接引用后退按钮？

# php - 如何验证密码

> ID：12610399
> 
> 赞同：-2
> 
> 时间：2012-09-26T21:06:17.260
> 
> 标签：php, regex, validation, passwords

> **可能重复：**
> [使用正则表达式验证密码](https://stackoverflow.com/questions/5848877/use-regular-expressions-to-validate-passwords)

我正在尝试编写一个 php 部分，我必须确保密码是：

1.  至少 6 个字符长
2.  至少有一个大写字母
3.  至少一个小写字母
4.  至少一个数字字符
5.  至少一个非字母数字字符

我必须确保密码与“重新输入密码”部分匹配。我有密码和密码重新输入的验证，这是最好的表达方式吗？

```
if ($pass != $repass)
{
  $repassErrorMsg = "Your password does not match the password entered above";
} 
```

我不确定如何验证上述情况的密码。我知道如何使用 RegEx 来验证实体格式，但如果格式灵活，我不确定如何验证以下情况。如何表达我的密码 RegEx 以验证用户选择的密码的任何案例场景（例如至少一个数字）。他可以在密码文本框中的任何位置输入任何案例场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:14:29.997

要检查密码的强度和安全性，您必须混合使用 Regex 和 PHP。

检查[这篇](http://www.cafewebmaster.com/check-password-strength-safety-php-and-regex)文章。提供的代码描述了您的所有条件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:10:38.247

我使用[PHP-Password](http://www.hashbangcode.com/blog/password-validation-class-php-428.html)类 - 它可以满足您的所有要求。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:16:34.210

我发现这可能会有所帮助...

测试你的大写和小写：

[检查密码的大小写和符号](https://stackoverflow.com/questions/5576160/checking-a-password-for-upper-lower-numbers-and-symbols)

测试你的长度：

[在 PHP 中检查字符串长度](https://stackoverflow.com/questions/5563152/check-string-length-in-php)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:54:48.157

使用正则表达式非常简单>>

```
preg_match('/^(?=.{6})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[\W_])/', $password)) 
```

### [在此处](http://ideone.com/5HZTh)测试此代码。

# ravendb - 如何查询 RavenDb 索引并对结果执行更改

> ID：12610400
> 
> 赞同：0
> 
> 时间：2012-09-26T21:06:30.957
> 
> 标签：ravendb

我正在尝试使用 RavenDb。

我有分组索引（Map/Reduce 和 Live Projection）。

我想从这些索引中获取结果并更新从中投影结果的文档。

这是 Raven 作为队列的执行管道的一部分。分组很关键。当其中一个分组文档已被处理时，我想将其标记为已处理。

我该怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T06:55:13.660

您可能想要使用索引属性包：

[https://groups.google.com/group/ravendb/browse_thread/thread/d51f2f625635a624/dd6ef0498cc24175](https://groups.google.com/group/ravendb/browse_thread/thread/d51f2f625635a624/dd6ef0498cc24175)

# c# - Facebook 的 OAuthWebSecurity 未按预期使用电子邮件权限

> ID：12610402
> 
> 赞同：6
> 
> 时间：2012-09-26T21:06:38.627
> 
> 标签：c#, asp.net-mvc, facebook, oauth

使用新的 OAuthWebSecurity 进行 Facebook 身份验证，我在我的 Facebook 应用程序中添加了电子邮件权限。现在，正如我所读到的，我需要定义一个范围，以便能够实际获取结果中的电子邮件。到目前为止，如果没有范围，我没有收到用户的电子邮件，也不确定为什么，因为我看不到在哪里定义“范围”。

它只是[ASP.NET MVC](http://en.wikipedia.org/wiki/ASP.NET_MVC_Framework) 4 默认 authenticationcontrollers 外部登录的一部分。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-10-29T16:31:11.487

首先，extraData 参数没有传递给 facebook。它仅供内部使用。请参阅以下链接，了解如何在您的网站上使用这些数据：

[http://blogs.msdn.com/b/pranav_rastogi/archive/2012/08/24/customizing-the-login-ui-when-using-oauth-openid.aspx](http://blogs.msdn.com/b/pranav_rastogi/archive/2012/08/24/customizing-the-login-ui-when-using-oauth-openid.aspx)

现在，到肉：

除了方法`RegisterFacebookClient`等`RegisterYahooClient`之外`OAuthWebSecurity`，还有一个泛型方法`RegisterClient`。这是我们将用于此解决方案的方法。

这个想法源于以下提供的代码：http: [//mvc4beginner.com/Sample-Code/Facebook-Twitter/MVC-4-oAuth-Facebook-Login-EMail-Problem-Solved.html](http://mvc4beginner.com/Sample-Code/Facebook-Twitter/MVC-4-oAuth-Facebook-Login-EMail-Problem-Solved.html)

但是，我们不会使用解决方案提供的 hacky 方法。相反，我们将创建一个名为的新类`FacebookScopedClient`，它将实现`IAuthenticationClient`. 然后我们将简单地使用以下方法注册该类：

```
OAuthWebSecurity.RegisterClient(new FacebookScopedClient("your_app_id", "your_app_secret"), "Facebook", null); 
```

在 AuthConfig.cs

该类的代码是：

```
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;
using System.Text.RegularExpressions;
using System.Web;

    public class FacebookScopedClient : IAuthenticationClient
        {
            private string appId;
            private string appSecret;

            private const string baseUrl = "https://www.facebook.com/dialog/oauth?client_id=";
            public const string graphApiToken = "https://graph.facebook.com/oauth/access_token?";
            public const string graphApiMe = "https://graph.facebook.com/me?";

            private static string GetHTML(string URL)
            {
                string connectionString = URL;

                try
                {
                    System.Net.HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(connectionString);
                    myRequest.Credentials = CredentialCache.DefaultCredentials;
                    //// Get the response
                    WebResponse webResponse = myRequest.GetResponse();
                    Stream respStream = webResponse.GetResponseStream();
                    ////
                    StreamReader ioStream = new StreamReader(respStream);
                    string pageContent = ioStream.ReadToEnd();
                    //// Close streams
                    ioStream.Close();
                    respStream.Close();
                    return pageContent;
                }
                catch (Exception)
                {
                }
                return null;
            }

            private  IDictionary<string, string> GetUserData(string accessCode, string redirectURI)
            {

                string token = GetHTML(graphApiToken + "client_id=" + appId + "&redirect_uri=" + HttpUtility.UrlEncode(redirectURI) + "&client_secret=" + appSecret + "&code=" + accessCode);
                if (token == null || token == "")
                {
                    return null;
                }
                string data = GetHTML(graphApiMe + "fields=id,name,email,gender,link&access_token=" + token.Substring("access_token=", "&"));

                // this dictionary must contains
                Dictionary<string, string> userData = JsonConvert.DeserializeObject<Dictionary<string, string>>(data);
                return userData;
            }

            public FacebookScopedClient(string appId, string appSecret)
            {
                this.appId = appId;
                this.appSecret = appSecret;
            }

            public string ProviderName
            {
                get { return "Facebook"; }
            }

            public void RequestAuthentication(System.Web.HttpContextBase context, Uri returnUrl)
            {
                string url = baseUrl + appId + "&redirect_uri=" + HttpUtility.UrlEncode(returnUrl.ToString()) + "&scope=email";
                context.Response.Redirect(url);
            }

            public AuthenticationResult VerifyAuthentication(System.Web.HttpContextBase context)
            {
                string code = context.Request.QueryString["code"];

                string rawUrl = context.Request.Url.OriginalString;
                //From this we need to remove code portion
                rawUrl = Regex.Replace(rawUrl, "&code=[^&]*", "");

                IDictionary<string, string> userData = GetUserData(code, rawUrl);

                if (userData == null)
                    return new AuthenticationResult(false, ProviderName, null, null, null);

                string id = userData["id"];
                string username = userData["email"];
                userData.Remove("id");
                userData.Remove("email");

                AuthenticationResult result = new AuthenticationResult(true, ProviderName, id, username, userData);
                return result;
            }
        } 
```

现在在

```
public ActionResult ExternalLoginCallback(string returnUrl) 
```

方法中`AccountController`，`result.ExtraData`应该有email。

**编辑：我错过了这篇文章中的一些代码。我在下面添加它：**

```
public static class String
    {
        public static string Substring(this string str, string StartString, string EndString)
        {
            if (str.Contains(StartString))
            {
                int iStart = str.IndexOf(StartString) + StartString.Length;
                int iEnd = str.IndexOf(EndString, iStart);
                return str.Substring(iStart, (iEnd - iStart));
            }
            return null;
        }
    } 
```

干杯!

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2012-12-09T18:21:18.520

更新 MVC4 Internet 项目中的 NuGet 包。

DotNetOpenAuthCore。它将自动更新所有依赖项。

现在 result.UserName 将包含电子邮件地址而不是您的姓名。

```
 [AllowAnonymous]
    public ActionResult ExternalLoginCallback(string returnUrl)
    {
        AuthenticationResult result = OAuthWebSecurity.VerifyAuthentication(Url.Action("ExternalLoginCallback", new { ReturnUrl = returnUrl }));
        if (!result.IsSuccessful)
        {
            return RedirectToAction("ExternalLoginFailure");
        }

        if (OAuthWebSecurity.Login(result.Provider, result.ProviderUserId, createPersistentCookie: false))
        {
            return RedirectToLocal(returnUrl);
        }

        if (User.Identity.IsAuthenticated)
        {
            // If the current user is logged in add the new account
            OAuthWebSecurity.CreateOrUpdateAccount(result.Provider, result.ProviderUserId, User.Identity.Name);
            return RedirectToLocal(returnUrl);
        }
        else
        {
            // User is new, ask for their desired membership name
            string loginData = OAuthWebSecurity.SerializeProviderUserId(result.Provider, result.ProviderUserId);
            ViewBag.ProviderDisplayName = OAuthWebSecurity.GetOAuthClientData(result.Provider).DisplayName;
            ViewBag.ReturnUrl = returnUrl;
            return View("ExternalLoginConfirmation", new RegisterExternalLoginModel { UserName = result.UserName, ExternalLoginData = loginData });
        }
    } 
```

这是什么原因？

[https://github.com/AArnott/dotnetopenid/blob/a9d2443ee1a35f13c528cce35b5096abae7128f4/src/DotNetOpenAuth.AspNet/Clients/OAuth2/FacebookClient.cs](https://github.com/AArnott/dotnetopenid/blob/a9d2443ee1a35f13c528cce35b5096abae7128f4/src/DotNetOpenAuth.AspNet/Clients/OAuth2/FacebookClient.cs)已在最新的 NuGet 包中更新。

带有修复的提交： [https ://github.com/AArnott/dotnetopenid/commit/a9d2443ee1a35f13c528cce35b5096abae7128f4](https://github.com/AArnott/dotnetopenid/commit/a9d2443ee1a35f13c528cce35b5096abae7128f4)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-28T16:53:18.660

我使用了[Varun 的答案](https://stackoverflow.com/a/13125765/389899)，但我必须进行一些小修改才能使其适用于托管在[AppHarbor](http://appharbor.com)上的应用程序。

AppHarbor 必须使用 url 中的端口号做一些时髦的事情来处理负载平衡。[你可以在这里](http://support.appharbor.com/kb/getting-started/workaround-for-generating-absolute-urls-without-port-number)阅读更多关于它的信息。简而言之，在 AppHarbor 上托管时获取当前请求的 AbsoluteUri 可能会返回端口号不是 80 的 uri。这会导致 Facebook 身份验证出现问题，因为他们希望您的返回 url 是您在创建应用程序时指定的。

问题出现在`string rawUrl = context.Request.Url.OriginalString;`in `VerifyAuthentication()`。如果您使用此代码，`rawUrl`可能包含 80 以外的某些端口号，导致 Facebook 身份验证失败。相反，将该行替换为

```
string rawUrl = GetRawUrl(context.Request.Url); 
```

并将`GetRawUrl()`函数添加到类中：

```
public static string GetRawUrl(Uri url)
{
    var port = url.Port;
    if (SettingsHelper.GetHostingService() == HostingServices.AppHarbor)
        port = 80;

    return new UriBuilder(url)
    {
        Port = port
    }.Uri.AbsoluteUri;
} 
```

您需要替换`if (SettingsHelper.GetHostingService() == HostingServices.AppHarbor)`为您自己的逻辑来确定您的应用程序是否在 AppHarbor 上运行。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-26T11:20:17.567

我为这个问题写了自己的解决方案。我扩展了 OAuth2Client 以利用它的工作，并使用 facebook 范围和其他功能来检索额外的用户数据。[我在这里](https://stackoverflow.com/a/16234946/1771201)发布了自己的解决方案，希望对某人有所帮助！

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2018-10-06T19:22:47.427

由于 FB 强制要求“对重定向 URI 使用严格模式”，因此需要 RewriteRequest（对于 Google Oauth）。在 OAuthWebSecurity.VerifyAuthentication 之前的回调处理中添加下面的调用。

```
FacebookScopedClient.RewriteRequest(); 
```

FacebookScopedClient 类

```
using System;
using System.Collections.Generic;
using System.Text;
using DotNetOpenAuth.AspNet;
using System.Web;
using System.Net;
using System.IO;
using System.Text.RegularExpressions;
using Newtonsoft.Json;

namespace UserAccounts.WebApi.ExternalLogin
{
    // Thnks to Har Kaur https://www.c-sharpcorner.com/blogs/facebook-integration-by-using-oauth and https://github.com/mj1856/DotNetOpenAuth.GoogleOAuth2/blob/master/DotNetOpenAuth.GoogleOAuth2/GoogleOAuth2Client.cs
    public class FacebookScopedClient : IAuthenticationClient
    {
        private string appId;
        private string appSecret;
        private static string providerName = "Facebook";

        private const string baseUrl = "https://www.facebook.com/dialog/oauth?client_id=";
        public const string graphApiToken = "https://graph.facebook.com/oauth/access_token?";
        public const string graphApiMe = "https://graph.facebook.com/me?";

        private static string GetHTML(string URL)
        {
            string connectionString = URL;

            try
            {
                System.Net.HttpWebRequest myRequest = (HttpWebRequest)WebRequest.Create(connectionString);
                myRequest.Credentials = CredentialCache.DefaultCredentials;
                //// Get the response  
                WebResponse webResponse = myRequest.GetResponse();
                Stream respStream = webResponse.GetResponseStream();
                ////  
                StreamReader ioStream = new StreamReader(respStream);
                string pageContent = ioStream.ReadToEnd();
                //// Close streams  
                ioStream.Close();
                respStream.Close();
                return pageContent;
            }
            catch (WebException ex)
            {
                StreamReader reader = new StreamReader(ex.Response.GetResponseStream());
                string line;
                StringBuilder result = new StringBuilder();
                while ((line = reader.ReadLine()) != null)
                {
                    result.Append(line);
                }

            }
            catch (Exception)
            {
            }
            return null;
        }

        private IDictionary<string, string> GetUserData(string accessCode, string redirectURI)
        {
            string value = "";
            string token = GetHTML(graphApiToken + "client_id=" + appId + "&redirect_uri=" +
                                    HttpUtility.UrlEncode(redirectURI) + "&client_secret=" +
                                       appSecret + "&code=" + accessCode);
            if (token == null || token == "")
            {
                return null;
            }
            if (token != null || token != "")
            {
                if (token.IndexOf("access_token") > -1)
                {
                    string[] arrtoken = token.Replace("\''", "").Split(':');
                    string[] arrval = arrtoken[1].ToString().Split(',');
                    value = arrval[0].ToString().Replace("\"", "");
                }
            }
            string data = GetHTML(graphApiMe + "fields=id,name,email,gender,link&access_token=" + value);

            // this dictionary must contains  
            Dictionary<string, string> userData = JsonConvert.DeserializeObject<Dictionary<string, string>>(data);
            return userData;
        }

        public FacebookScopedClient(string appId, string appSecret)
        {
            this.appId = appId;
            this.appSecret = appSecret;
        }

        public string ProviderName
        {
            get { return providerName; }
        }

        public void RequestAuthentication(System.Web.HttpContextBase context, Uri returnUrl)
        {
            var uriBuilder = new UriBuilder(returnUrl);
            uriBuilder.Query = "";
            var newUri = uriBuilder.Uri;

            string returnUrlQuery = HttpUtility.UrlEncode(returnUrl.Query);
            string url = baseUrl + appId + "&scope=email" + "&state=" + returnUrlQuery + "&redirect_uri=" + HttpUtility.UrlEncode(newUri.ToString());
            context.Response.Redirect(url);
        }

        public AuthenticationResult VerifyAuthentication(System.Web.HttpContextBase context)
        {
            string code = context.Request.QueryString["code"];

            string rawUrl = context.Request.Url.OriginalString;
            //From this we need to remove code portion  
            rawUrl = Regex.Replace(rawUrl, "&code=[^&]*", "");
            var uriBuilder = new UriBuilder(rawUrl);
            uriBuilder.Query = "";
            var newUri = uriBuilder.Uri;

            IDictionary<string, string> userData = GetUserData(code, newUri.ToString());

            if (userData == null)
                return new AuthenticationResult(false, ProviderName, null, null, null);

            string id = userData["id"];
            string username = userData["email"];
            userData.Remove("id");
            userData.Remove("email");

            AuthenticationResult result = new AuthenticationResult(true, ProviderName, id, username, userData);
            return result;
        }

        /// <summary>
        /// Facebook requires that all return data be packed into a "state" parameter.
        /// This should be called before verifying the request, so that the url is rewritten to support this.
        /// Thnks to Matt Johnson mj1856 https://github.com/mj1856/DotNetOpenAuth.GoogleOAuth2/blob/master/DotNetOpenAuth.GoogleOAuth2/GoogleOAuth2Client.cs
        /// </summary>
        /// 
        public static void RewriteRequest()
        {
            var ctx = HttpContext.Current;

            var stateString = HttpUtility.UrlDecode(ctx.Request.QueryString["state"]);
            if (stateString == null || !stateString.Contains("__provider__=" + providerName)) return;

            var q = HttpUtility.ParseQueryString(stateString);
            q.Add(ctx.Request.QueryString);
            q.Remove("state");

            ctx.RewritePath(ctx.Request.Path + "?" + q);
        }
    }
} 
```

* * *

## 回答 #6

> 赞同：-1
> 
> 时间：2012-09-27T16:20:29.153

我在这里遇到了同样的问题。我发现将“范围”参数传递给 facebook 的唯一方法是编写我自己的 OAuth 客户端。

为此，您必须扩展和实现 DotNetOpenAuth.AspNet.Clients.OAuth2Client 的抽象方法。

在 GetServiceLoginUrl 方法中，您可以将范围参数添加到 url。因此，当您调用 OAuthWebSecurity.VerifyAuthentication() 方法时，AuthenticationResult.UserName 会提供用户的电子邮件。

一个例子可以在[这里](https://github.com/AArnott/dotnetopenid/blob/master/src/DotNetOpenAuth.AspNet/Clients/OAuth2/FacebookClient.cs)找到。

祝你好运。

* * *

## 回答 #7

> 赞同：-2
> 
> 时间：2013-04-18T20:37:32.157

可以这样做......像这样：

```
var fb = new Dictionary<string, object>();
fb.Add("scope", "email,publish_actions");
OAuthWebSecurity.RegisterFacebookClient(
appId: ConfigurationManager.AppSettings["FacebookAppId"],
appSecret: ConfigurationManager.AppSettings["FacebookAppSecret"],
displayName: "FaceBook",
extraData: fb); 
```

# css - 带有三角形的工具提示

> ID：12610409
> 
> 赞同：45
> 
> 时间：2012-09-26T21:07:11.947
> 
> 标签：css, css-shapes

我为这个问题创建了一个[jsFiddle](http://jsfiddle.net/dAutM/4/)。

```
a.tip {
    position: relative;
}

a.tip span {
    display: none;
    position: absolute;
    top: -5px;
    left: 60px;
    width: 125px;
    padding: 5px;
    z-index: 100;
    background: #000;
    color: #fff;
    -moz-border-radius: 5px; /* this works only in camino/firefox */
    -webkit-border-radius: 5px; /* this is just for Safari */
}

a:hover.tip {
    font-size: 99%; /* this is just for IE */
}

a:hover.tip span {
    display: block;
} 
```

```
<center><a href="http://google.com/" class="tip">Link!<span>Hi its me!</span></a></center>
```

基本上我的网站上有一个工具提示，它出现在我的链接的右侧。但是在黑盒子的左侧，我想在盒子上附加一个指向链接的三角形，是否可以仅使用 CSS 来做到这一点？就像这样，但在左边

![带箭头的工具提示](../Images/c08680c8d94a6a7556a26fd74424edac.png)

* * *

## 回答 #1

> 赞同：59
> 
> 时间：2012-09-26T21:16:42.010

你可以用 CSS 来做，通过使用[css 三角形技巧](http://css-tricks.com/snippets/css/css-triangle/)

```
a.tip span:before{
    content:'';
    display:block;
    width:0;
    height:0;
    position:absolute;

    border-top: 8px solid transparent;
    border-bottom: 8px solid transparent;
    border-right:8px solid black;
    left:-8px;

    top:7px;
} 
```

**演示在** [http://jsfiddle.net/dAutM/7/](http://jsfiddle.net/dAutM/7/)

* * *

实时片段

```
a.tip {
  position: relative;
}

a.tip span {
  display: none;
  position: absolute;
  top: -5px;
  left: 60px;
  width: 125px;
  padding: 5px;
  z-index: 100;
  background: #000;
  color: #fff;
  -moz-border-radius: 5px;
  /* this works only in camino/firefox */
  -webkit-border-radius: 5px;
  /* this is just for Safari */
}

a.tip span:before {
  content: '';
  display: block;
  width: 0;
  height: 0;
  position: absolute;
  border-top: 8px solid transparent;
  border-bottom: 8px solid transparent;
  border-right: 8px solid black;
  left: -8px;
  top: 7px;
}

a:hover.tip {
  font-size: 99%;
  /* this is just for IE */
}

a:hover.tip span {
  display: block;
}
```

```
<center><a href="http://google.com/" class="tip">Link!<span>Hi its me!</span></a></center>
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2012-09-26T21:14:31.947

我开发了[CSStooltip.com](http://csstooltip.com)以仅在 CSS 中制作带有三角形的工具提示。

例子 ：

![在此处输入图像描述](../Images/2ebea0978f18bddfa771ab38b2e80369.png)

```
span.tooltip:after {
      content: "";
      position: absolute;
      width: 0;
      height: 0;
      border-width: 10px;
      border-style: solid;
      border-color: transparent #FFFFFF transparent transparent;
      top: 11px;
      left: -24px;
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-26T21:22:30.130

试试这个：[http ://ecoconsulting.co.uk/examples/css-tooltip/](http://ecoconsulting.co.uk/examples/css-tooltip/)

它解释了问题并修复了问题，并允许使用带有边框的箭头和工具提示。

**链接的内容**

## `:after`使用和的纯 CSS 工具提示`:before`

这些工具提示翻转使用自定义 HTML5 标记数据属性 (data-tooltip) 来填充显示属性中包含的文本的工具提示。箭头三角形由两个生成的重叠元素组成，只有顶部边框可见（rl 是透明的，底部是 0px）。所有工具提示文本都是链接的扩展，因此是可点击的。

查看源代码以获取代码 - 它尽可能干净，并且每个工具提示都有一个单独的 css 样式块 - 使用箭头工具提示（最终）CSS 来完成样式。不喜欢这个颜色？你知道该做什么。原始灵感：[Nicolas Gallagher 的纯 CSS 语音气泡](http://nicolasgallagher.com/pure-css-speech-bubbles/)，以及在纯 CSS 中模仿 Addy Osmani 的 JQuery 工具提示的愿望。

1.  仅使用 CSS 的工具提示`:before`（无箭头）

    > 这个带有 CSS 样式的翻转工具提示的链接使用`data-`工具提示内容的属性。您也可以使用它`:after`来生成工具提示。盒子阴影使它看起来漂浮在内容之上。

2.  仅 CSS 的工具提示箭头，带有`:before`和`:after`（`a`跨度内的标签）

    > 由于链接的 :before 属性已经用于工具提示文本，我们需要一个额外的元素来提供进一步生成的内容。这个 CSS 样式的翻转工具提示链接在包裹链接的跨度上添加了一个由重叠的 :before 和 :after 属性组成的箭头。三角形没有宽度或高度，仅由边框构成，这意味着我们不能使用具有正值的 box-shadow，因为它出现在 lr 边框的透明矩形之外，而不是在“箭头”周围。

故障：悬停在箭头的“边界”上时，三角形挥之不去。故障：Mozilla (Firefox)：箭头边框在链接下方，需要更高的 z-index。

3.  最终的纯 CSS 工具提示箭头，带有`:before`和`:after`（`span`内部`a`标记）

    > 这个半透明的 CSS 样式的翻转工具提示在 a 标签内使用 span。阴影已恢复，但顶部/左侧值为负数以避免箭头。最后，将 alpha 透明度 (rgba) 应用于工具提示元素，通过反复试验调整将箭头的颜色混合到较低的渐变中，并降低外部三角形的（较暗）边框颜色在内部下方的可见性.

您可以通过应用工具提示类并将链接文本包装在跨度中来将其添加到任何链接。默认情况下，工具提示会继承 span 的`font-weight`值。

可悲的是，生成元素的 CSS3（在这种情况下很好地淡入）过渡还没有得到足够广泛的支持（仅限 FF，但即使在那里，我也无法让它工作）。

# javascript - 比较两个 JavaScript 代码片段

> ID：12610416
> 
> 赞同：1
> 
> 时间：2012-09-26T21:07:28.213
> 
> 标签：javascript, coffeescript

这 2 个 JavaScript 代码片段是否等效？

```
jQuery(document).ready(function() {
    (function(){
        return 'something';
    })();
}); 
```

还有这个

```
jQuery(document).ready(function() {
  return (function() {
    return "something";
  })();
}); 
```

我在尝试咖啡。将上面的第一个代码转换为 coffescript 并将其转换回 JS 给出了第二个片段。所以，我想知道它们是否完全相同。不是从与闭包相关的函数中返回函数吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:09:54.660

他们会是一样的，是的。除了第二个将使用 1 个更多的堆栈内存单元。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:27:07.317

这取决于`.ready`方法是否使用其回调的返回值。如果是这样，那么例子就不同了。如果返回值被忽略，那么它是相同的。

如果您停下来想一想，您可以“简化”立即调用的函数表达式。这样做会将第一个示例变为

```
jQuery(document).ready(function() {
    'something';
}); 
```

第二个进入

```
jQuery(document).ready(function() {
    return 'something';
}); 
```

# c# - WebClient 是下载 http 数据的最佳方式吗？

> ID：12610417
> 
> 赞同：5
> 
> 时间：2012-09-26T21:07:34.103
> 
> 标签：c#

问题：我需要从不同的主机下载数百张图片。每个主机都有 20 百张图像。

解决方法：使用一个`new WebClient`每次需要通过WebClient的方法下载图片的`DownloadData`方法。

还是保留一个开放的套接字连接池并使用较低级别的调用发出http请求会更好？

打开/关闭 tcp 连接是否很昂贵（我假设这是 WebClient 所做的），所以使用池听起来更有效？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:10:06.553

我相信使用的底层基础设施`WebClient`已经汇集了 HTTP 连接，所以没有必要这样做。当然，您可能希望使用[Wireshark](http://www.wireshark.org/)之类的工具以及一些示例 URL 进行检查。

从根本上说，我会采用与其他编程任务相同的方法 - 以最简单的方式编写代码，然后检查它的性能是否足以满足您的需求。如果是这样，你就完成了。如果没有，请使用适当的工具（网络分析器等）来找出它性能不够好的*原因，并且只有在解决问题时才使用更复杂的代码。*

我的经验是，`WebClient`如果它不是您所需要的，那很好 - 但它并没有像`WebRequest`. 如果您*不需要*该控件，请使用`WebClient`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:12:39.307

我使用`HttpWebRequest`并`HttpWebResponse`刮掉我想要的任何东西。当然，除非有满足需求的服务，但即使有时存在限制（业务限制），我经常更喜欢从纯 http 请求中挖掘 html。有时只是让感觉更像开发人员，你知道...

# php - Doctrine：更新 SINGLE_TABLE 继承的鉴别器

> ID：12610421
> 
> 赞同：18
> 
> 时间：2012-09-26T21:07:47.263
> 
> 标签：php, symfony, doctrine-orm

使用这些类，您将如何将“Person”的记录更改为“Employee”。

```
/**
 * @Entity
 * @InheritanceType("SINGLE_TABLE")
 * @DiscriminatorColumn(name="discr", type="string")
 * @DiscriminatorMap({"person" = "Person", "employee" = "Employee"})
 */
class Person
{
    // ...
}

/**
 * @Entity
 */
class Employee extends Person
{
    // ...
} 
```

我尝试更改鉴别器列的值，但我无法访问它。我还尝试创建一个“员工”实例并手动复制数据，但这不适用于自动递增 id。它只是作为新记录添加而不是更新现有记录。

我是否需要编写自定义 sql 查询，或者我是否在做其他根本错误的事情？

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2012-09-27T02:55:03.580

当对象实例的类型需要随时间改变时，这不是一个好兆头。我不是在谈论向下转换/向上转换，而是在谈论改变对象的真实类型的需要。

首先，让我告诉你为什么这是一个坏主意：

1.  一个子类可能会定义更多的属性并在它的构造函数中做一些额外的工作。我们应该再次运行新的构造函数吗？如果它覆盖了我们旧对象的一些属性怎么办？
2.  如果您在代码的某些部分中处理该 Person 的实例，然后它突然转换为 Employee （可能有一些您不期望的重新定义的行为）怎么办？！

这就是为什么大多数语言不允许您在执行期间更改对象的真实类类型（当然还有内存，但我不想详细说明）的部分原因。有些让你这样做（有时以扭曲的方式，例如JVM），但这真的不是一个好习惯！

通常，这样做的必要性在于糟糕的面向对象设计决策。

**由于这些原因，Doctrine 不允许您更改实体对象的类型。当然，您可以编写简单的 SQL（在本文末尾 - 但请通读！）无论如何都要进行更改，但这里有两个我建议的“干净”选项：**

*我意识到你已经说过第一个选项不是一个选项，但我花了一段时间写下这篇文章，所以我觉得我应该尽可能完整以供将来参考。*

1.  每当您需要将类型从 更改`Person`为 时`Employee`，创建一个新的 Employee 实例并将您想要复制的数据从旧的 Person 对象复制到 Employee 对象。不要忘记删除旧实体并保留新实体。
2.  使用组合而不是继承（有关详细信息和其他文章的链接，请参阅此[wiki](http://en.wikipedia.org/wiki/Composition_over_inheritance)文章）。**编辑：**为了它，[这是与 Erich Gamma](http://www.artima.com/lejava/articles/designprinciples4.html)关于“继承的组合”的精彩对话的一部分！

[请参阅此处](https://groups.google.com/forum/?fromgroups=#!topic/doctrine-user/Uk3hp7Fdhqg)和[此处](https://stackoverflow.com/questions/1364137/changing-the-type-of-an-entity-framework-entity-that-is-part-of-an-inheritance)的相关讨论。

* * *

**现在，这是我之前谈到的普通 SQL 方法——我希望你不需要使用它！**

确保您的查询已被清理（因为查询将在没有任何验证的情况下执行）。

```
$query = "UPDATE TABLE_NAME_HERE SET discr = 'employee' WHERE id = ".$entity->getId();
$entity_manager->getConnection()->exec( $query ); 
```

这是`DBAL\Connection`类中 exec 方法的文档和代码（供您参考）：

```
/**
 * Execute an SQL statement and return the number of affected rows.
 *
 * @param string $statement
 * @return integer The number of affected rows.
 */
public function exec($statement)
{
    $this->connect();
    return $this->_conn->exec($statement);
} 
```

# jquery - 在带有 ViewModel 的 ASP MVC3 中使用 [RequiredIf]

> ID：12610424
> 
> 赞同：2
> 
> 时间：2012-09-26T21:07:59.720
> 
> 标签：jquery, asp.net-mvc-3, validation, conditional

我在我的 MVC 应用程序中 使用了[Simon Ince 创建的自定义RequiredIf 属性。](https://blogs.msdn.microsoft.com/simonince/2011/02/04/conditional-validation-in-asp-net-mvc-3/)

我有一个视图模型，它像这样传递给视图：

```
public class HistoryViewModel
{
    public Contact ContactModel { get; set; }
    public Account AccountModel { get; set; }
    public Person PersonModel { get; set; }
 } 
```

我有一堆模型，其中包含所有道具（即contact.cs、account.cs、person.cs）

```
public class Person
{
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public bool IsAdult { get; set; }        
    [RequiredIf("IsAdult", "Yes", Errormessage="Please leave a comment")]
    public string Comments { get; set; }
 } 
```

通过视图模型时，`RequiredIf`验证似乎不起作用。如果我将属性直接移动到视图模型中，它工作正常`. All other`[必需]`属性通过视图模型从模型中工作。

*那么我是否需要将所有需要RequiredIf 的属性移到视图模型中？或者还有其他方法可以解决这个问题吗？*

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-27T23:54:16.197

您是否尝试过[MVC FoolProof 验证](http://foolproof.codeplex.com/)？它通过客户端支持支持RequiredIf（以及其他一些）。有时它可能有点错误，但最新版本还不错。

以与上述相同的方式工作（我在切换到 FoolProof 之前尝试过）

```
 public bool Married { get; set; }

    [RequiredIfTrue("Married")]
    public string MaidenName { get; set; } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-09-27T13:09:00.840

### 问题

如果您查看 razor 视图发出的 html，您会发现这里有什么问题。

**如果没有 viewmodel**，我们应该生成以下代码（稍微清理一下）：

```
<input type="checkbox" name="IsAdult" id="***IsAdult***" />
<input type="text" name="Comments" id="Comments"
       data-val-requiredif-dependprop="***IsAdult***" 
       data-val-requiredif-value="Yes"
       data-val-requiredif="Please leave a comment" /> 
```

**使用 viewmodel**，我们得到：

```
<input type="checkbox" name="PersonModel.IsAdult" id="***PersonModel_IsAdult***" />
<input type="text" name="PersonModel.Comments" id="PersonModel_Comments"
       data-val-requiredif-dependprop="***IsAdult***" 
       data-val-requiredif-value="Yes"
       data-val-requiredif="Please leave a comment" /> 
```

每当一个属性嵌套在另一个属性中时，MVC 都会构建一个前缀堆栈来生成唯一的 ID 和名称。您可以在第一种情况下看到，`IsAdult`足以识别字段，但是一旦嵌套，id 就发生了变化。在不显眼的验证（存储在属性中的规则）中，我们可能需要知道的关于如何验证元素的所有内容都需要在 中发送`data-attributes`，包括如何定位其他属性。

### 解决方案

类上的 data 属性永远不应该知道或关心它在什么上下文下被调用，所以它会继续盲目地指出它所依赖的相对属性：

```
public bool IsAdult { get; set; }
[RequiredIf("IsAdult", "Yes", Errormessage="Please leave a comment")]
public string Comments { get; set; } 
```

所以我们必须在服务器或客户端上建立上下文。

**在服务器上**- 不！

作为您的一部分`public class RequiredIfAttribute : ValidationAttribute, IClientValidatable`，您将拥有一个发出客户端验证规则的方法，如下所示：

```
public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
{
    ModelClientValidationRule requiredIfRule = new ModelClientValidationRule();
    requiredIfRule.ErrorMessage = ErrorMessageString;
    requiredIfRule.ValidationType = "requiredif";
    requiredIfRule.ValidationParameters.Add("dependprop", this._propertyName);
    requiredIfRule.ValidationParameters.Add("value", Json.Encode(this._value));     

    yield return requiredIfRule;
} 
```

这里的诱惑是导航`viewContext.ViewData.TemplateInfo`返回[`GetFullHtmlFieldId`](https://msdn.microsoft.com/en-us/library/system.web.mvc.templateinfo.getfullhtmlfieldid.aspx)，但据我所知，此[信息尚不可用](https://stackoverflow.com/a/24825324/1366033)。

**客户**- 不稳定但工作：

在客户端，我们将使用[如下所示](https://thewayofcode.wordpress.com/tag/custom-unobtrusive-validation/)的方法连接适配器：

```
$.validator.unobtrusive.adapters.add('requiredif', ['dependprop', 'value'], function (options) {
    options.rules["requiredif"] = { 
        id: '#' + options.params['dependprop'],
        value: JSON.parse(options.params.value) 
    };
    options.messages['requiredif'] = options.message;
}); 
```

请注意，这仍然只采用普通的旧属性名称，并假定它可以用作 ID 来定位对象。

通过做出一些合理的假设，我们可以构建完整的依赖属性 id。应该总是这样， requiredif 调用元素与我们识别的属性在同一范围内（这就是我们能够通过反射在服务器上找到它的方式）。

因此，我们将从发送者那里获取该上下文，删除该属性的名称，并将我们自己的名称添加到以下内容中`$.validator.unobtrusive.adapters.add`：

```
var curId = options.element.id;               // get full id      i.e. ViewModel_Comments
var context = curId.replace(/[^_]+$/, "");    // remove last prop i.e. ViewModel_
var targetProp = options.params['dependprop'] // target name      i.e. IsAdult
var targetId = '#' + context + targetProp;    // build target ID  i.e. #ViewModel_IsAdult

options.rules["requiredif"] = {
    id: targetId,
    value: JSON.parse(options.params.value)
}; 
```

这应该有助于找到正确的客户端属性 - 然后写下您需要满足的任何其他条件。

# .net - .NET 代码优先 ORM

> ID：12610426
> 
> 赞同：0
> 
> 时间：2012-09-26T21:08:07.173
> 
> 标签：.net, performance, orm, code-first

我正在寻找支持代码优先数据建模（如 Microsoft Entity Framework）的 .NET ORM。我之前使用过 Entity Framework，但遇到了一些性能问题。所以我也使用 BLToolkit 作为数据访问层和由 T-SQL 直接创建的数据库（一个中等规模的项目）。这个解决方案有很好的性能，但是在更新数据库表之后更新代码模型非常烦人。

因此，如果有人分享使用 ORM 和代码优先数据建模方法的经验，那就太好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:03:17.233

如果您在使用 Entity Framework 时遇到性能问题，您应该尝试找出原因，而不仅仅是假设 EF 很糟糕，并且不再使用它。您可能一直在做一些简单的事情，只需进行一些更改即可解决。

此外，EF5 还显着提高了性能。但是你需要 VS 2012 来利用这些（.net 4 上的 EF5 没有得到性能改进）。

nHibernate 当然是一个可行的选择（尤其是 Fluent nHibernate），但我发现它比 EF 做更多的工作，因为 EF 的支持工具要好得多。即使先使用代码，也可以轻而易举地使用 EF Power Tools 对现有数据模型进行逆向工程以先编码。

切换到另一个框架也不能保证性能改进，因为使用 ORM 需要从根本上转变思维。如果您不注意，很容易让 ORM 生成非常糟糕的代码。

# android - Android在拨号应用程序中编辑来电者姓名

> ID：12610428
> 
> 赞同：0
> 
> 时间：2012-09-26T21:08:16.857
> 
> 标签：android, broadcastreceiver

当有人拨打我的电话时，我希望能够在数据库中查找号码并在来电活动中显示名称而不是号码。这有可能吗？谢谢。

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2012-09-26T21:47:52.110

我找到了一个如何显示你想要的链接。[http://www.tutorialforandroid.com/2009/01/get-phone-state-when-someone-is-calling_22.html](http://www.tutorialforandroid.com/2009/01/get-phone-state-when-someone-is-calling_22.html)我希望他能帮助你。

# sql - PostgreSQL：自引用，扁平连接到包含对象树的表

> ID：12610429
> 
> 赞同：2
> 
> 时间：2012-09-26T21:08:26.083
> 
> 标签：sql, postgresql, join, tree, self-reference

我有一个相对较大的（如 >10^6 个条目）表，称为“事物”，它代表可定位的对象，例如国家、地区、城市、街道等。它们用作具有固定深度的对象树，所以表结构如下所示：

```
id
name
type
continent_id
country_id
city_id
area_id
street_id
etc. 
```

“事物”内部的关联是 1:n，即一条街道或区域始终属于一个定义的城市和国家（不是两个或没有）；例如，city_id 列包含该城市内所有对象的“城市”事物的 id。“类型”列以字符串形式包含事物的类型（街道、城市等）。

该表在另一个表“actions”中被引用为“thing_id”。我正在尝试生成一个动作位置统计表，显示给定位置具有的活动和非活动动作的数量。一个简单的 JOIN 像

```
SELECT count(nullif(actions.active, 1)) 作为 icount,
       count(nullif(actions.active, 0)) 作为一个计数，
       things.name AS name, things.id AS thing_id, things.city_id AS city_id
  从“行动”
  LEFT JOIN things ON actions.thing_id = things.id
 WHERE UPPER(substring(things.name, 1, 1)) = UPPER('A')
   AND actions.datetime_at BETWEEN '2012-09-26 19:52:14' AND '2012-10-26 22:00:00'
 GROUP BY things.name, things.id ORDER BY things.name

```

会给我一个“事物”列表（以“A”开头），这些事物具有与它们相关的操作以及它们的活动和非活动计数，如下所示：

```
icount | acount | name                      | thing_id | city_id
------------------------------------------------------------------
     0        5   Brooklyn, New York City   | 25       | 23
     1        0   Manhattan, New York City  | 24       | 23
     3        2   New York City             | 23       | 23 
```

现在我想

*   只考虑“城市”事物（这很简单：按“事物”中的类型过滤），并且
*   在活动/非活动计数中，使用该城市发生的所有操作的总和 - 无论该操作是与城市本身还是与城市*内部*的事物相关联（= 具有相同的 city_id）。使用与上述相同的数据集，新查询应导致

```
icount | 帐户 | 姓名 | thing_id | city_id
-------------------------------------------------- ----------------
     4 7 纽约市 | 23 | 23

```

我不需要*这个*表中的thing_id（因为它不会是唯一的），但是因为我确实需要城市的名称（用于显示），所以输出ID可能同样容易，那么我没有在我的代码中进行尽可能多的更改。

我将如何修改上述查询来实现这一点？如果可能的话，我想避免额外访问数据库和高级 SQL 功能，例如过程、触发器、视图和临时表。

我在 Rails 3.0.14（在 Mac OS X 10.7.4 上）上使用 Postgres 8.3 和 Ruby 1.9.3。

谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:00:18.187

您需要在一个独立的子查询中计算城市中*所有事物的操作，**然后*加入一组有限的事物：

```
SELECT c.icount
      ,c.acount      
      ,t.name
      ,t.id AS thing_id
      ,t.city_id
FROM  (
   SELECT t.city_id
         ,count(nullif(a.active, 1)) AS icount
         ,sum(a.active) AS acount
   FROM   things t 
   LEFT   JOIN actions a ON a.thing_id = t.id 
   WHERE  t.city_id = 23           -- to restrict results to one city
   GROUP  BY t.city_id
   ) c                             -- counts per city
JOIN   things t USING (city_id)
WHERE  t.name ILIKE 'A%'
AND    t.datetime_at BETWEEN '2012-09-26 19:52:14'
                         AND '2012-10-26 22:00:00'
ORDER  BY t.name, t.id; 
```

我还简化了查询中的许多其他内容，并使用表别名使其更易于阅读。

# c# - 如何在 C# 中创建 xml 元素的路径

> ID：12610434
> 
> 赞同：0
> 
> 时间：2012-09-26T21:08:38.507
> 
> 标签：c#, xml

我想为 xml 元素创建一个路由（路径）并将其分配给一个变量，以便将来可以快速访问它。该元素是其他元素的子元素，可以更改其在文档中的位置，因此我不能使用依赖位置的第一个子元素或索引等方法。元素的路径将始终保持不变，没有其他类似的路径。如果我们看一个简短的示例，那么我想要一个指向 level4 值（header4）的路径，以便我可以修改它。

```
 <level1>
    <level2>
        <level3>header3</level3>
            <level4>header4</level4>
        <level3>header31</level31>
    </level2>
    <level2>
        <level3>nnn</level3>
        <level3>nnnnn</level31>
    </level2>
</level1> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:14:11.153

在这种情况下，您必须使用 XPath。

```
XmlDocument xmlDoc = new XmlDocument();
xmlDoc.Load("Path of the xml");
XmlNode titleNode = xmlDoc.SelectSingleNode("//level1/level2/level3"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:13:56.490

您可以为此使用 XPath。

```
XmlDocument doc; // assuming the xml is already in doc
XmlNode node = doc.SelectSingleNode("/level1/level2/level3/level4");
if(node != null) 
{
    node.InnerText = "New value";
} 
```

如果可能有不止一个 level4，那么你可以这样做：

```
XmlDocument doc; // assuming the xml is already in doc
XmlNodeList nodes = doc.SelectNodes("/level1/level2/level3/level4");
if(nodes != null) 
{
    foreach(XmlNode node in nodes)
    {
        node.InnerText = "New value";
    }
} 
```

# php - Kohana 3.x 是否有 mysqli 驱动程序

> ID：12610437
> 
> 赞同：1
> 
> 时间：2012-09-26T21:08:51.163
> 
> 标签：php, mysql, json, mysqli, kohana

除了访问存储过程和处理多个结果集等更高级的选项外，我还想在我的 Kohana 项目中开始使用 mysqli，这样我就可以设置 MYSQLI_OPT_INT_AND_FLOAT_NATIVE 选项。

我试图保持话题，但只是为了让您知道我尝试使用此选项的确切上下文 - 我希望 SQL 结果自动告诉 PHP 哪些列是 INT，所以我的 JSON 对象属性如果它们不是字符串，则不要在它们周围加上引号。

在此先感谢 - 第一篇文章！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:11:01.143

不，没有。不过，基于 mysql 驱动程序制作一个应该很容易。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T03:35:21.227

虽然没有用于 mysqli 的官方 Kohana 数据库驱动程序，但您可以在 GitHub 上找到一些。其中之一是：[https](https://github.com/cdomigan/kohana-database-mysqli) ://github.com/cdomigan/kohana-database-mysqli 。分叉存储库并添加应用程序所需的任何必要选项应该不会太难。

# windows-7 - 使用 Visual Basic 5 编译的应用程序可以在 Vista 或 Windows 7 上运行吗？

> ID：12610442
> 
> 赞同：0
> 
> 时间：2012-09-26T21:09:19.157
> 
> 标签：windows-7, windows-vista, vb5

题目说明了一切……

然而，我并不是在询问 VB5 IDE 是否会在 Vista/Windows 7 上安装和运行——只是项目输出。

谢谢

[更新]

我发现了更多信息，这些信息似乎表明 VB5 应用程序不仅可以在 Windows 7 (x64) 下运行，而且 IDE 也可以。 [http://www.vbforums.com/archive/index.php/t-619859.html](http://www.vbforums.com/archive/index.php/t-619859.html)

[更新]

谢谢杰，这些程序不能在 x64（任何操作系统）上运行是有道理的——我不知道 vbforums 成员是如何让它在 Win7 x64 上运行的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T23:27:57.190

是的，它确实。我有几个用 VB5 编译的应用程序（.exe 文件），无需任何额外设置即可在我的 64 位 W7 机器上运行。

# c# - 带有输出参数的 SQL Server CLR UDF - 可能吗？

> ID：12610446
> 
> 赞同：7
> 
> 时间：2012-09-26T21:09:50.267
> 
> 标签：c#, sql-server, clr, user-defined-functions, sqlclr

有没有办法为 SQL Server 创建一个 CLR 用户定义函数，它返回多个值**而不使用表值函数**语法？例如，假设我要执行坐标转换，例如：

```
[SqlFunction()]
public void ConvertCoordinates(SqlDouble x, SqlDouble y, SqlDouble z, out SqlDouble r, out SqlDouble t, out SqlDouble p)
{
   r = new SqlDouble(Math.Sqrt((x.Value*x.Value)+(y.Value*y.Value)+(z.Value*z.Value)));
   t = new SqlDouble(Math.Acos(r.Value / z.Value));
   p = new SqlDouble(Math.Atan(y.Value / x.Value));
} 
```

这甚至可能吗？在这种情况下，表值函数似乎不合适，因为计算永远不会产生超过一个输出行。使用标量值函数语法，我必须编写三个不同的函数来执行计算并分别调用每个函数。鉴于我的实际用例，这是非常不切实际的。

我意识到上面的逻辑可以用纯T-SQL来完成；我的实际用例更复杂，但仍只会导致单行具有多个相互依赖的输出值。

那么，归根结底，可行吗？我不认为它是，但人们可以希望。如果碰巧它是可行的，那么调用这样一个函数的 T-SQL 会是什么样子？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T02:46:38.397

由于您已经尝试过 CLR，因此您可以创建自己的 CLR 类型，用它可以做各种疯狂的事情。作为一个实际的例子，原生空间类型以这种方式实现，就像 HierarchyID 一样。一旦你定义了你自己的类型，你就可以让你的函数返回它。如果获取单个组件（如果我可以假设您的情况是半径、theta 和 phi），请在返回此类的类型上创建方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-16T17:09:52.127

这是一个较老的问题，我在寻找一个非常相似的问题的答案时发现了它。

SQL 函数允许返回值，但不允许使用输出参数。

SQL 过程确实允许输出参数（但不允许返回值）

我从这里的 MSDN 示例中找到了这个：

[http://technet.microsoft.com/en-us/library/ms131092.aspx](http://technet.microsoft.com/en-us/library/ms131092.aspx)

```
 [Microsoft.SqlServer.Server.SqlProcedure]
 public static void PriceSum(out SqlInt32 value)
 { … } 
```

和

```
CREATE PROCEDURE PriceSum (@sum int OUTPUT)
AS EXTERNAL NAME TestStoredProc.StoredProcedures.PriceSum 
```

当我从尝试注册函数切换到过程时，一切都解决了。需要指出的是，函数可以有返回值，而存储过程不能。在我的情况下，我返回了一个字符串值，并为一些可选的详细信息（如状态代码等）提供了输出参数。我所做的只是将我的方法更改为 void 并将字符串值作为输出参数传回。

无论如何，您的方法都是 void 并且没有返回值，因此是使用存储过程而不是函数的完美候选者。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-09-26T21:23:38.173

我承认我没有尝试过，但我想 T-SQL 会喜欢，

```
DECLARE @X FLOAT(53),
        @Y FLOAT(53),
        @Z FLOAT(53),
        @R FLOAT(53),
        @T FLOAT(53),
        @P FLOAT(53)

EXEC    ConvertCoordinates
        @X = 0,
        @Y = 0,
        @Z = 0,
        @R = @R OUTPUT,
        @T = @T OUTPUT
        @P = @P OUTPUT 
```

# java - 如何安装 Java Access Bridge？

> ID：12610451
> 
> 赞同：2
> 
> 时间：2012-09-26T21:10:35.453
> 
> 标签：java, c++, windows, java-access-bridge

我现在尝试安装 Java Accesss Bridge 几个小时。但没有成功。ORACLE 的安装程序不起作用（最后回滚，没有错误消息）。

对于使用 JAB 的应用程序，我需要什么。我真的需要某种安装，还是可以简单地将一些头文件和库放在一起？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-04T21:50:23.447

一周后，我发现 Java Access Bridge 2.0.2 就像 2.0.1 的更新一样工作，而 JAB 2.0.1 和 2.0.2 只适用于 Java SE 6。从 Java SE 7 开始，Access Bridge 包含在标准 JRE7。：-/

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-03-25T18:15:52.820

Java Access Bridge 包含在 Java SE 运行时环境 (JRE) 第 7 版更新 6 (7u6) 及更高版本中。Java Access Bridge 2.0.3 包含在 JRE 7u6 中。默认情况下，**Java Access Bridge 未启用。**

此链接概述了如何启用 Java Access Bridge。

[http://docs.oracle.com/javase/7/docs/technotes/guides/access/enable_and_test.html](http://docs.oracle.com/javase/7/docs/technotes/guides/access/enable_and_test.html)

# python - 获取文件系统列表 Python

> ID：12610456
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:10:52.153
> 
> 标签：python, data-structures

> **可能重复：**
> [在 Python 中创建树形目录列表](https://stackoverflow.com/questions/7478477/create-a-tree-style-directory-listing-in-python)

我想分析文件系统并将结果打印为格式化文件。我的第一个实现可以只是纯文本，但稍后我想合并 HTML。

我正在使用一种基本方法来收集每个文件夹中包含的文件，我可以将其返回并发送到文本处理器：

```
def gather_tree(source):
        tree = {}
        for path, dirs, files in os.walk(source):
            tree[path] = []
            for file in files:
                tree[path].append(file)
        return tree 
```

显然，这里的问题是我正在生成一个没有深度概念的结构，我想我需要能够正确格式化具有足够空间和嵌套的列表。

我目前非常基本的打印模式如下所示：

```
def print_file_tree(tree):
    # Prepare tree
    dir_list = tree.keys()
    dir_list.sort()

    for directory in dir_list:
        print directory
        for f in tree[directory]:
            print f 
```

我对数据结构很陌生，希望能提供一些意见！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:48:04.517

如果您计划从您的数据创建 XML，您实际上必须创建一个树状结构。这可以是您构建、注释并可能再次迭代或遍历的中间树，然后转换为`ElementTree`用于创建 XML 的中间树。或者您可以直接构造一个`ElementTree`使用[lxml](http://lxml.de/tutorial.html)的 ElementTree API。

无论哪种方式，使用`os.walk()`都不是要走的路。这听起来可能违反直觉，但重点是：`os.walk()`为您序列化（展平）文件系统树，因此您可以轻松地对其进行迭代，而不必编写递归函数来执行此操作。但是，在您的情况下，您**希望**保留树结构，因此如果您自己编写该递归函数会容易得多。

这是一个如何构建`ElementTree`using的示例`lxml`。

*（此代码大致基于[@MikeDeSimone](https://stackoverflow.com/a/2105761/1599111)对类似问题的回答）*

```
import os
from lxml import etree

def dir_as_tree(path):
    """Recursive function that walks a directory and returns a tree
    of nested etree nodes.
    """
    basename = os.path.basename(path)
    node = etree.Element("node")
    node.attrib['name'] = basename
    # Gather some more information on this path here
    # and write it to attributes
    # ...
    if os.path.isdir(path):
        # Recurse
        node.tag = 'dir'
        for item in sorted(os.listdir(path)):
            item_path = os.path.join(path, item)
            child_node = dir_as_tree(item_path)
            node.append(child_node)
        return node
    else:
        node.tag = 'file'
        return node

# Create a tree of the current working directory
cwd = os.getcwd()
root = dir_as_tree(cwd)

# Create an element tree from the root node
# (in order to serialize it to a complete XML document)
tree = etree.ElementTree(root)

xml_document = etree.tostring(tree,
                              pretty_print=True,
                              xml_declaration=True,
                              encoding='utf-8')
print xml_document 
```

示例输出：

```
<?xml version='1.0' encoding='utf-8'?>
<dir name="dirwalker">
  <dir name="top1">
    <file name="foobar.txt"/>
    <dir name="sub1"/>
  </dir>
  <dir name="top2">
    <dir name="sub2"/>
  </dir>
  <dir name="top3">
    <dir name="sub3">
      <dir name="sub_a"/>
      <dir name="sub_b"/>
    </dir>
  </dir>
  <file name="topfile1.txt"/>
  <file name="walker.py"/>
</dir> 
```

# mvvm - Datagrid 未更新，datagridtextcolumn 上的 Visibility 属性

> ID：12610460
> 
> 赞同：1
> 
> 时间：2012-09-26T21:11:03.177
> 
> 标签：mvvm, wpfdatagrid

所以你可以看到 ID 列应该被隐藏但它不是。并且调试器将 xaml 文件中 IDVisible 的值显示为“隐藏”，但它从未进入窗口。我也在调用属性更改方法。我做错了什么，ID 列应该消失，或者至少这就是我想要做的。

![主窗口.xaml](../Images/a44d018b3ea4294685f7e267d8691baa.png)

这是 MainWindowViewModel.cs 的代码

```
namespace MagicDB
{
class MainWindowViewModel : ObservableObject
{
    private CardDB _cards;
    private Command _InitCardDB;
    private Visibility _IDVisible;

    public CardDB Cards
    {
        get { return _cards; }
        set { _cards = value; OnPropertyChanged("Cards"); }
    }

    public Visibility IDVisible
    {
        get { return _IDVisible; }
        set { _IDVisible = value; VerifyPropertyName("IDVisible"); OnPropertyChanged("IDVisible"); }
    }

   public MainWindowViewModel()
    {
        IDVisible = Visibility.Hidden;
        _InitCardDB = new Command(InitDB, true);
        Cards = new CardDB();
    } 
```

和 xaml 文件....

```
<Window x:Class="WpfDataGrid.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="MainWindow" Width="500" Height="500">
<Grid>
    <Grid.RowDefinitions>
        <RowDefinition Height="50" />
        <RowDefinition Height="450*" />
    </Grid.RowDefinitions>
    <DataGrid AutoGenerateColumns="False" 
        HorizontalAlignment="Left" 
        Name="dataGrid1" 
        VerticalAlignment="Top" 
        ItemsSource="{Binding Cards.cardDB}"
        CanUserReorderColumns="True"
              CanUserResizeColumns="True"
              CanUserResizeRows="False"
              CanUserSortColumns="True"
              AlternatingRowBackground="LightBlue"
              Width="480" Height="auto" Grid.Row="1" IsSynchronizedWithCurrentItem="True"  
              >
        <DataGrid.Columns>
            <DataGridTextColumn Header="ID" Binding="{Binding CardID}" Width="25" Visibility="{Binding IDVisible,Mode=TwoWay}"></DataGridTextColumn> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T12:26:34.677

我会检查您的可见绑定，因为它很可能会失败。本页[介绍](http://wpftutorial.net/DebugDataBinding.html)了一些您可以使用的方法。我个人更喜欢调整跟踪级别。

我认为绑定失败的原因是您的 DataContext（我假设您已将其设置在某处）本身没有进入 DataGrid 的列。此[页面](http://blogs.msdn.com/b/jaimer/archive/2008/11/22/forwarding-the-datagrid-s-datacontext-to-its-columns.aspx)解释了我过去用来解决此问题的修复程序。[我想我最初是从这个页面](http://blogs.msdn.com/b/vinsibal/archive/2009/04/07/5-random-gotchas-with-the-wpf-datagrid.aspx)上找到的那篇文章，其中还有其他几个值得了解的 WPF 'Gotchas'。

# python - 扩展 configparser 类并在新类中使用配置解析器

> ID：12610463
> 
> 赞同：0
> 
> 时间：2012-09-26T21:11:07.723
> 
> 标签：python, class, python-3.x, configparser

所以我正在尝试创建一个已经在文件中读取并具有 configparser 的所有功能以及更多功能的类。代码如下所示：

```
import configparser
class dkconfig(configparser):
    def __init__(self):
        self.clusterini = os.path.abspath("..\\cluster.ini")
        super(dkconfig,self).__init__(allow_no_value=True)
        if os.path.exists(self.clusterini):
            self.read(self.clusterini)

    def getHostnames(self):
        hostnames = {}
        for sec in self.config.sections():
            if sec.startswith("node"):
                hostnames[sec] = self.config.get(sec, "hostname")
        return hostnames 
```

它从另一个脚本中调用，如下所示：

```
config = dkconfig()
names = config.getHostnames()
opts = config.options("node1") 
```

错误说：`TypeError: module.__init__() takes at most 2 arguments (3 given)`我错过了什么，我怎样才能让“dkconfig”对象的所有实例在构造过程中都已经读入了“cluster.ini”文件？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:26:01.733

好吧，错误的直接原因是您试图从`configparser` *module*继承。您需要从*类*继承，而不是模块。

```
class dkconfig(configparser.ConfigParser):
    # .... 
```

# c# - 如何使用#line 指令指定列？

> ID：12610465
> 
> 赞同：0
> 
> 时间：2012-09-26T21:11:09.080
> 
> 标签：c#, code-generation, dsl

在 C# 中，您可以`#line`在生成的代码中使用指令来更改错误报告方式和调试方式。

例如，这个剃须刀代码：

```
@model Foo
@{
    var foo = ViewBag.Foo;
} 
```

可能会生成一个 #line 指令，如下所示：

```
#line 2 "project\foo.cshtml"
    var foo = ViewBag.Foo;
#line hidden 
```

但是，当两个 C# 表达式位于同一行时，这种情况就会出现问题，如下所示：

```
<img width="@width" height="@height" /> 
```

产生`#line`这样的指令：

```
#line 40
width
#line hidden
...
#line 40
height
#line hidden 
```

如何指定列以及行指令？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:11:09.080

这是我想出的技巧：

用空格填充代码，使列对齐，所以

```
<img width="@width" height="@height" /> 
```

变成

```
#line 40
             width
#line hidden
...
#line 40
                             height
#line hidden 
```

此技巧适用于编译器错误和 Visual Studio 中的调试。

# ruby - 在多线程环境中跨不同请求共享（机械化）会话？

> ID：12610467
> 
> 赞同：1
> 
> 时间：2012-09-26T21:11:20.447
> 
> 标签：ruby, session, cookies, mechanize, mechanize-ruby

我正在开发一个使用 Ruby 的 Mechanize 登录到受密码保护的站点并使用某些数据馈送的应用程序。反过来，我的应用程序允许我的用户查询和操作数据。每次有新用户访问我的应用程序时，它都会登录到远程数据源以获取数据。

问题是：远程站点允许会话持续长达 24 小时。**切断远程站点上的多个登录的最佳解决方案是什么？**

有多种方法可以做到这一点：将 Mechanize 对象序列化并保存到数据库，将 Mechanize 的 cookie/jar/session 信息保存到请求之间的共享文件中，等等。我正在寻找最佳实践，最重要的是一个解决方案将在 Heroku 的多线程环境中工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:15:45.947

这是我要做的：

*   执行 rake 任务以使用 mechanize 登录站点并将 cookie 保存在文件或数据库中。按 24 小时计划运行它。
*   从您的控制器中，除非您真的需要它，否则请使用比 mechanize (net/http?) 更轻量级的东西来发送 cookie 并发出请求。

# php - 如何使用 PHP 的 PDO 和 MySQL 选择具有与值匹配的列并介于日期范围之间的行？

> ID：12610469
> 
> 赞同：0
> 
> 时间：2012-09-26T21:11:35.713
> 
> 标签：php, mysql, pdo

有人可以帮我解决下面的问题吗？我需要选择订阅“Food Specials”时事通讯的所有用户（必须通过表单变量传递，因为有不同的时事通讯名称）并且值为“1”并且介于注册日期之间以下列形式选择：

```
$sql = 'SELECT * FROM users WHERE :newsletter = 1 AND signed_up < ":start" AND signed_up < ":end"';
$result->bindValue(":newsletter", "food_specials", PDO::PARAM_STR);
$result->bindValue(":start", "2012-09-01 12:00:00", PDO::PARAM_STR);
$result->bindValue(":end", "2012-09-25 12:00:00", PDO::PARAM_STR); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:12:40.727

首先“food_specials”永远不会等于1。您可能应该在此处绑定一个包含值1的变量或其他东西。不知道它是干什么用的。对于这个答案的其余部分，我将假设`food_special`您尝试使用 pdo 设置的列名。这是无法做到的。您需要做的只是将其显式放入 sql.xml 中。请参见下面的示例。

你也需要改变

```
signed_up < ":start" 
```

至

```
signed_up > :start 
```

即你需要的是

```
$sql = "SELECT * 
          FROM users 
         WHERE food_special = 1 
           AND signed_up > :start 
           AND signed_up < :end"; 
```

如果`signed_up > :start AND signed_up < :end`您的意思是，`signed_up >= :start AND signed_up <= :end`那么您应该查看@glavić 的答案以寻找替代解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:14:53.283

使用[BETWEEN](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#operator_between)：

```
SELECT * 
FROM users 
WHERE 
    :newsletter = 1 AND 
    signed_up BETWEEN :start AND :end 
```

# file - 同时删除两个文件的内容 - UNIX

> ID：12610471
> 
> 赞同：2
> 
> 时间：2012-09-26T21:11:48.513
> 
> 标签：file, design-patterns

我有两个名为“fileA.txt”和“fileB.txt”的文件。

fileA.txt 有以下内容：

```
1   Arizona   ABDJAQ   224
2   Ohio      AKOGFR   458
3   Wisconsin EFGTAP   871
4   Colorado  NAHBAX   991 
```

上面四列分别是“ID”、“State”、“Pattern”、“Number”

fileB.txt 有以下内容：

```
1   Arizona   NKIGAB   763
2   Ohio      BAVYAD   918
3   Wisconsin AUOBAQ   547
4   Colorado  INABEA   622 
```

同样，四列是“ID”、“State”、“Pattern”、“Number”

现在这就是我想要做的：

我想先扫描“fileA.txt”并删除“模式”列只有一个“A”的所有记录。保留所有有 2 个“A”的记录。所以我会删除俄亥俄州和威斯康星州。（ID“2”和ID“3”）。同时，我也想同时从“fileB.txt”中删除这些ID！（尽管在 fileB 中，俄亥俄州和威斯康星州的模式中有 2 个“A”）。

完成此步骤后，我的“fileA.txt”应如下所示：

```
1   Arizona   ABDJAQ   224
4   Colorado  NAHBAX   991 
```

我的“fileB.txt”应该是这样的：

```
1   Arizona   NKIGAB   763
4   Colorado  INABEA   622 
```

接下来，我想扫描“fileB.txt”以删除所有模式为“A”的记录，并从“fileA.txt”中删除相应的记录。（在本例中为 Arizona，因为它在 fileB 中只有“A”，因此我们从 fileB 和 fileA 中删除了 Arizona。）

在这一步之后，我将在每个文件中只留下一条记录：

“fileA.txt”将有：

```
4   Colorado  NAHBAX   991 
```

和“fileB.txt”将有

```
4   Colorado  INABEA   622 
```

所以，简而言之，我想扫描这两个文件并只保留那些在两个文件中的模式中有 2 个“A”的记录。

是否有单行 Unix 命令或相对简单的方法来执行此操作？

感谢帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-25T22:40:12.743

*为此，我用 Python（ 280 个字符的代码*）编写了单行代码。

```
python -c"import re,sys;o=lambda f,m:open(f,m);x=lambda h:[i for i in o(h,'r').readlines()];y=lambda s:len(re.findall(r'(\w+)',s)[2].split('A'))>2;z=lambda f,s:o(f,'a'if len(s)else'w').write(s);a,b=sys.argv[1:3];w=zip(x(a),x(b));z(a,'');z(b,'');[(z(a,c),z(b,d))for(c,d)in w if y(c)and y(d)]" a.txt b.txt 
```

注意：此代码不会关闭文件描述符。我认为操作系统会这样做。

# linq - LINQ - 加入 OR 条件

> ID：12610472
> 
> 赞同：5
> 
> 时间：2012-09-26T21:11:53.193
> 
> 标签：linq, entity-framework

我有两个实体，用户和友谊，它们看起来像：

```
 public class User
    {
        public int UserId { get; set; }
        (...)
    }

    public class Friendship
    {
         public int SenderId { get; set; }
         public int ReceiverId { get; set; }
         (...)
    } 
```

我想创建简单的查询，在 SQL 中看起来像：

```
 SELECT * FROM Users as U
    INNER JOIN Friendships as F ON U.UserId = F.ReceiverId OR U.UserId = F.SenderId
    Where U.Nick != VARIABLE 
```

换句话说，我想选择用户的所有朋友。

而我无法做到这一点。我找到了一个解决方案，其中一个使用联合创建两个单独的连接查询并且它可以工作 - 但是为数据库创建这样的查询效率不高。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:13:51.700

LINQ 中的连接总是等值连接。基本上你需要多个`from`子句和一个`where`子句：

```
var query = from u in db.Users
            where u.Nick != variable
            from f in db.Friendships
            where u.UserId == f.ReceiveId || u.UserId == f.SenderId
            select ...; 
```

现在在 LINQ to Objects 中可能有更有效的方法来执行此操作 - 但我希望基于 SQL 的 LINQ 提供程序能够生成具有*足够好的*执行计划的查询。它实际上可能不会在 SQL 中创建 JOIN，但我希望它与您显示的连接具有相同的执行计划。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:15:36.080

简单地写：

```
from U in db.Users
from F in Friendships.Where(x => U.UserId == F.ReceiverId || U.UserId == F.SenderId)
where U.Nick != VARIABLE
select new {u, f}; 
```

# html - 如何在 html 表中居中显示错误消息？

> ID：12610475
> 
> 赞同：0
> 
> 时间：2012-09-26T21:12:02.303
> 
> 标签：html, css

我有 html 代码，可以打印 html 表中的所有帖子。

但是，如果没有帖子，那么我需要打印一个错误`No posts found`。

现在关注错误消息

我正在尝试在表格中央打印错误消息。

```
<style>
table{border-collapse:collapse}
td{background-color:white;padding:10px}
.first_tr td{background-color:#f1f7f7 !important;border-bottom:1px red solid}
</style>
<table border="0" width="400px">
<tr class="first_tr"><td width="20%">POST ID</td><td width="79%">POST TITLE</td></tr>
<tr><td>No posts found</td></tr>
</table> 
```

这是一个例子：http: [//jsfiddle.net/9UhTd/](http://jsfiddle.net/9UhTd/)

错误消息显示在表格的开头，但我试图将其居中！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:14:33.377

首先，您在第二行唯一的单元格上缺少 colspan 属性

```
<table border="0" width="400px">
<tr class="first_tr"><td width="20%">POST ID</td><td width="79%">POST TITLE</td></tr>
<tr><td colspan="2">No user found</td></tr>
</table>​​​​​ 
```

没有它，该单元格将仅占用其上方单元格的空间。解决了这个问题，您可以继续以您喜欢的方式将其居中

```
<table border="0" width="400px">
<tr class="first_tr"><td width="20%">POST ID</td><td width="79%">POST TITLE</td></tr>
<tr><td colspan="2" style="text-align:center">No user found</td></tr>
</table>​​​​​ 
```

或者

```
<style type="text/css">.center { text-align: center; }</style>
<table border="0" width="400px">
<tr class="first_tr"><td width="20%">POST ID</td><td width="79%">POST TITLE</td></tr>
<tr><td colspan="2" class="center">No user found</td></tr>
</table>​​​​​ 
```

[你的jsfiddle实现了这个](http://jsfiddle.net/9UhTd/2/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:14:39.227

你错过了colspan

下面的代码应该做

```
<style>
table{border-collapse:collapse}
td{background-color:white;padding:10px}
.first_tr td{background-color:#f1f7f7 !important;border-bottom:1px red solid}
</style>
<table border="0" width="400px">
<tr class="first_tr"><td width="20%">POST ID</td><td width="79%">POST TITLE</td></tr>
    <tr><td colspan="2">No user found</td></tr>
</table>​ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:17:36.510

很少有评论：1）如果你这样做，你的元素跨越 2 列，因为你的表有 2 列使用： colspan="2"

2）您可以向元素添加一个类，例如 class="error" 并将这种样式添加到您的css：

```
.error{
    text-align:center;
} 
```

# javascript - Google Analytics：使用单个 Jquery 链接推送跨域汇总到单个实体

> ID：12610478
> 
> 赞同：0
> 
> 时间：2012-09-26T21:12:14.673
> 
> 标签：javascript, jquery, google-analytics, cross-domain

目标是将被视为一个网站一部分的外部域汇总到一个属性和实体中，以便转化不会显示推荐媒介或退回。我想在所有站点共享的单个实体和单个 JS 文件下设置跨域跟踪。

三个不同的域真正属于一个站点：www.example.com、exampleblog.com、examplestore.com。

我已阅读 Google 建议在外部站点上使用不同代码块的解决方案，但我想为所有站点创建一个文件并链接到主域上的文件。我创建了一个我希望使用的 JS 文件，这样代码更容易维护，而且我不必弄乱外部域。我想使用 Jquery 为不是 www.example.com 的外部域推送 _link。因此，如果它不是主域，那么它将域设置为 none 并将 _link 推送到 cookie 中。

但是，外部域仍然在媒体中显示为“引荐”并显示该引荐的来源。相反，我们希望来源是直接的，而媒介是没有的。

以下是分析中显示的内容：

*   www.example.com/page1.html
*   来源：（直接）
*   中：（无）

*   exampleblog.com/page2.html

*   来源：example.com
*   媒介：推荐

*   examplestore.com/page3.html

*   来源：exampleblog.com
*   媒介：推荐

*   www.example.com/page4.html

*   来源：（直接）
*   中：（无）

问题在于 examplestore 和 exampleblog 的页面条目。当他们应该被强制显示为直接时，它们显示为推荐。

注意：我有一个过滤器可以在页面名称中显示域。我们有完整的个人资料和不同的属性设置来显示推荐，因此这仅用于转化和目标渠道的特定目的。

```
// Cross Domain Tracking Under a Single Entity
alert("Loading Google...");

 var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-XXXXXX-3']);

    var locText = document.location + '';
    console.log(window.location.host);

    // one if statement just needs to know if it's at our primary domain
    var exampleDomain = /example\.com/i;

    if(exampleDomain.test(locText)){
        //Roll Up (domain and subdomains)
        _gaq.push(['_setDomainName', '.example.com']);

    } else {
        //Tag
        _gaq.push(['_setDomainName', 'none']);
            _gaq.push(['_addIgnoredRef', window.location.host]);

    }

    _gaq.push(['_setAllowLinker', true]);
    _gaq.push(['_trackPageview']);

    (function() {

    // load the ga.js file.  This happens last now.
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();

jQuery(document).ready(function(){
alert("Ready");
    jQuery('a').each(function() {
           var a = new RegExp('/' + window.location.host + '/');
            alert(a + " " + this.href);        
           //check if it is external
           if(!a.test(this.href)) {
               alert("external link");

               jQuery(this).click(function(event) {
                   event.preventDefault();
                   event.stopPropagation();
                   alert("GOOGLED");
                   // Google it
                   _gaq.push(['_link',this.href]); 
                   return false;
               });
           }
        });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T00:37:59.030

您应该同时使用跨域跟踪和[_addIgnoredRef()](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiSearchEngines#_gat.GA_Tracker_._addIgnoredRef)来防止 GA 将域显示为引荐来源。

绝对测试您的跨域 jQuery 方法，以确保在您进行跳转后正确设置 GA __utma cookie。当用户跳转时，听起来好像正在开始一个新会话。

# android - 在两个活动之间共享一个视频视图

> ID：12610485
> 
> 赞同：2
> 
> 时间：2012-09-26T21:12:28.747
> 
> 标签：android, layout, android-activity, fullscreen, android-videoview

我的应用程序有两个活动。第一个活动显示一个视频视图，它以非全屏模式播放视频（还有关于占据屏幕其余部分的视频的其他信息）。在同一屏幕上还有一个按钮，按下该按钮会导致视频以全屏模式播放。

我实现全屏的方式是使用视频视图开始一个新活动，并将播放视频的 url 发送到这个新活动。然后我可以从头开始加载网址等等....

有没有办法可以在我的第二个活动中重复使用第一个活动的相同视频视图？

# javascript - 使用 navigator.geolocation.getCurrentPosition(); 同步的

> ID：12610501
> 
> 赞同：2
> 
> 时间：2012-09-26T21:13:16.210
> 
> 标签：javascript, html, geolocation

我有这个函数试图在调用时将纬度和经度作为字符串返回。但是，当我用警报调用它时，它返回未定义。但是当我提醒 data.coords.latitude/longitude 它给了我正确的值。任何帮助是极大的赞赏。

```
function GetLocation() {
    var jsonLocation;
    navigator.geolocation.getCurrentPosition(function (data) {
        jsonLocation = data.coords.latitude+','+data.coords.longitude;
    });
    return String(jsonLocation);
}
alert(GetLocation()); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:58:57.767

[`getCurrentPosition()`](https://developer.mozilla.org/en-US/docs/Web/API/Geolocation/getCurrentPosition)期望回调：

```
function getLocation(callback) {
    navigator.geolocation.getCurrentPosition(function (data) {
        var jsonLocation = data.coords.latitude+','+data.coords.longitude;
        callback(jsonLocation);
    });
}

getLocation(alert); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:56:30.513

我更改了代码，因此回调会在 getCurrentPosition 返回时提醒信息

```
function RequestLocation() {
            navigator.geolocation.getCurrentPosition(function (data) {
                SendLocation(String(data.coords.latitude + ',' + data.coords.longitude));
            });
        }
        function SendLocation(cords)
        {
            alert(cords);
        }

        RequestLocation(); 
```

# excel - Excel 集群条形（或柱形）图表

> ID：12610504
> 
> 赞同：0
> 
> 时间：2012-09-26T21:13:28.613
> 
> 标签：excel, events, charts

我的数据看起来像这样：

```
Name    Event    Result
Bob     1       0
Mary    1       1
Sue     2       0
Tom     1       0
Dick    2       1
Harry   1       1
Mary    2       0
Sue     2       1
Dick    1       1 
```

ETC...

名称重复，Event 是 Event 类型，Result 是事件是否成功 (0, 1)。我想要结束的是一个集群条形图，每个名称有四个条形图：

```
Event 1 # of Success
Event 1 # of Fail
Event 2 # of Success
Event 2 # of Fail 
```

我想我将来可能想把它放在一个聚集的堆叠条中，但如果我能让这个简单的集群运行起来，我就能弄清楚。一个关于基于事件的图表的好教程的链接将不胜感激。我会继续搜索并发回我找到的内容。提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T07:08:01.270

不确定这是否完全满足您的需求，但它可能是可视化数据的最快方法：

选择您发布的数据，转到插入选项卡，选择数据透视图（隐藏在数据透视表后面）并将其作为新工作表插入。

然后将 Event 和 Result 列放到 row-field 中，再将 Event 列放到 value-field 中，并将其设置为使用 count 而不是 sum。然后你得到下面的结果。

![在此处输入图像描述](../Images/e425b03f226d947f1b6a1b5e42435af3.png)

# wpf - 如何通过按住标签条中的空白来调整 TabContols 的大小

> ID：12610506
> 
> 赞同：0
> 
> 时间：2012-09-26T21:13:43.303
> 
> 标签：wpf, c#-4.0

我有两个选项卡控件堆叠（使用停靠面板），它们的 Tabstrips 的空白重叠重叠。我必须让用户调整这两个 tabcontrols 的高度，尤其是底部的，如果他们需要的话。有什么办法可以让 TabHeaders 旁边的空白区域保持并拖动它来调整大小？

```
<DockPanel>
    <TabControl DockPanel.Dock="Bottom" Height="200" Margin="0,-20,0,0">
        <TabItem Header="tab 1"></TabItem>
        <TabItem Header="tab2"></TabItem>
    </TabControl>

    <TabControl TabStripPlacement="Bottom" FlowDirection="RightToLeft">
        <TabItem Header="Tab 3" FlowDirection="LeftToRight"></TabItem>
        <TabItem Header="Tab 4" FlowDirection="LeftToRight"></TabItem>
    </TabControl>
</DockPanel> 
```

任何指针将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:36:19.557

找到了答案。

```
 <osc:DockPanelSplitter DockPanel.Dock="Bottom" Margin="0,-20,0,0" Height="20" Panel.ZIndex="-1"/>

    <TabControl TabStripPlacement="Bottom" FlowDirection="RightToLeft">
        <TabItem Header="Tab 3" FlowDirection="LeftToRight"></TabItem>
        <TabItem Header="Tab 4" FlowDirection="LeftToRight"></TabItem>
    </TabControl>
</DockPanel> 
```

关键是[DockPanelSplitter上的 Panel.Zindex](http://www.codeproject.com/Articles/34377/DockPanel-Splitter-Control-for-WPF)

# ejb - 注入 CDI bean 到有状态 EJB 的可序列化性

> ID：12610511
> 
> 赞同：0
> 
> 时间：2012-09-26T21:13:52.027
> 
> 标签：ejb, cdi, serializable, stateful-session-bean

我有有状态的 EJB 并注入到它的应用程序范围 CDI bean。Findbugs 发出警告，因为我的 CDI bean 不可序列化。在这种情况下，CDI bean 是否应该是可序列化的？为了避免钝化，我认为不应该。使这个领域“瞬态”足够吗，这是一个合适的解决方案吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:41:41.083

老实说，我不会担心。您可能在现实中获得了 PassivationCapable 代理，而 FindBugs 肯定不知道这一点。

# javascript - 为什么在使用 jQuery 时在 Facebook iframe 中插入这些奇怪的字符？â€‹

> ID：12610513
> 
> 赞同：1
> 
> 时间：2012-09-26T21:13:57.060
> 
> 标签：javascript, jquery, css, facebook, facebook-iframe

jQuery 在我的 Facebook 上的 iframe 应用程序中解析了一些 html，当它解析时，我得到了大量的这些字符：

â€‹ â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹â€‹</p>

请查看屏幕截图以获取更多信息。有谁知道为什么会这样！以及如何解决？

[显示问题的屏幕截图 - 注意它是如何随机插入到内联 css 中的](http://i.stack.imgur.com/NIJFp.jpg)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:24:13.100

可能是编码问题。您可能想要定义`charset`. 像这样：

```
<meta charset="UTF-8"> 
```

# vim - Vim 的关键字补全是否仅限于相同的文件类型？

> ID：12610516
> 
> 赞同：1
> 
> 时间：2012-09-26T21:14:08.707
> 
> 标签：vim

当我只打开相同文件类型的文件时，我发现 Vim 的关键字补全非常有用。但是一旦我开始编辑一种以上的文件类型，它就变得不那么有用了。如果我正在编辑一个 Python 项目，然后在另一个选项卡中打开我的 vimrc，则 Python 文件中的关键字完成现在将包含来自我的 vimrc 的关键字。在不禁用完成选项以查看其他缓冲区的情况下，是否可以让关键字完成仅适用于相同文件类型的缓冲区？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:44:20.067

您正在使用`<C-n>`/ `<C-p>`，对吗？

的值`set complete`决定了完成源。默认值包括完成列表中其他缓冲区和窗口的内容。

请参阅`:help 'complete'`选项列表。这可能会解决您的问题：

```
:set complete=.,t,i 
```

或者，您可以使用其他完成快捷方式，如`<C-x><C-n>`、`<C-x><C-p>`或`<C-x><C-o>`，具体取决于您要完成的内容。见`:help ins-completion`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T14:18:43.527

好主意。我是 Vim 插入模式完成的忠实粉丝，并编写了一个库，可以轻松实现自定义完成：[CompleteHelper](http://www.vim.org/scripts/script.php?script_id=3914)。

通过对该库（我刚刚在 1.30 版中实现）进行一些增强，它允许将完成候选者限制为某些缓冲区。有了这个，我已经将您的建议实现为[SameFiletypeComplete 插件](http://www.vim.org/scripts/script.php?script_id=4242)。试试看; 我希望它对你有用。

# windows - TShark 输出重定向

> ID：12610519
> 
> 赞同：3
> 
> 时间：2012-09-26T21:14:15.463
> 
> 标签：windows, command-line, wireshark

我正在使用 TShark 命令行来开始新的捕获。如果我使用这个命令**tshark.exe -w C:\test.pcap -i (我的接口号)**我将捕获保存在我的硬盘上，这就是需要的，但是这个命令的输出显示接收到的数据包的数量，一直在更新的数字，我无法得到这个输出。

使用这个命令：**tshark.exe -i（我的接口号）**我可以看到数据包的详细信息，我可以得到进程输出以便在我的表单（win表单）上显示它，直到现在我找不到任何命令这将向我显示数据包详细信息并将捕获文件保存在我的硬盘驱动器上。如果我使用这个命令：**tshark.exe -i (my interface number) -w C:\test.pcap**我可以保存捕获但输出与第一个示例中的一样，没有数据包详细信息。也许有人可以帮我解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:26:38.783

tshark 似乎是“Windows 的 tcpdump”

你有 2 个选择

1：根据您的目的修改 tshark（您可能需要知道如何用 C 编程）

2：将原始输出写入管道并将其写入文件和您的应用程序。（或者让您的应用程序读取管道并写入文件）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:25:13.213

使用`-V`旗帜。

这将启用详细模式。

我会`-x`根据所需的日志记录强度和级别推荐这个。

# android - 当列表项获得焦点时，如何更改 TalkBack 语音？

> ID：12610522
> 
> 赞同：0
> 
> 时间：2012-09-26T21:14:27.443
> 
> 标签：android, accessibility

我使用 Google UserRowView 类作为模板，说明如何覆盖 dispatchAccessibilityEvent() 以便让 TalkBack 说出自定义消息：

```
public class UserRowView extends LinearLayout {
                .
                .
  public void setText(String text) 
      _message = text;
  }

  @Override
  public boolean dispatchPopulateAccessibilityEvent(AccessibilityEvent accessEvent) {
      Context ctx = this.getContext();
      accessEvent.setClassName(getClass().getName());
      accessEvent.setPackageName(ctx.getPackageName());
      accessEvent.getText().clear();
      accessEvent.getText().add(_message);
      return true;
  } 
```

列表项布局为：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="fill_parent"
android:layout_height="wrap_content"
android:minHeight="?android:attr/listPreferredItemHeight"
android:background="@color/all_white">
<ImageView
    android:id="@+id/catalog_entry_image"
    android:layout_width="wrap_content"
    android:layout_height="fill_parent"
    android:src="@drawable/member_active" />
<com.topiatechnology.skoot.android.util.UserRowView
    android:id="@+id/catalog_entry_user_row_view"
    android:orientation="vertical"
    android:layout_width="0dip"
    android:layout_weight="1"
    android:layout_height="wrap_content"
    android:layout_gravity="center_vertical"
    >
    <TextView
        android:id="@+id/catalog_entry_name_text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
    />
    <TextView
        android:id="@+id/catalog_entry_size_text"
        android:layout_width="match_parent"
        android:layout_height="wrap_content" 
    />
    <TextView
        android:id="@+id/catalog_entry_date_text"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
    />
    <ProgressBar
        style="?android:attr/progressBarStyleHorizontal" 
        android:layout_width="200dip" 
        android:layout_height="wrap_content"
        android:id="@+id/catalog_entry_progress_bar"
        android:visibility="gone"
    />
</com.topiatechnology.skoot.android.util.UserRowView>
</LinearLayout> 
```

我在 ListView 适配器的 getView() 方法中设置了文本。

问题是当关注列表项时，TalkBack 不会更改它所说的文本。

对于上面的布局，三个 TextView 的文本被朗读，而我希望我设置的文本被朗读。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-30T05:56:49.623

使用[View.setContentDescription()](http://developer.android.com/reference/android/view/View.html#setContentDescription%28java.lang.CharSequence%29)在包含您不想大声朗读的视图的布局上设置内容描述。TalkBack 将阅读内容描述并忽略子视图的文本。

```
. . .

public void setText(String text) 
    _message = text;
    setContentDescription(_message);
} 
```

一般来说，不再推荐将 AccessibilityEvent 文本设置为控制来自焦点和选择的反馈。

# entity-framework - 实体框架复数表名

> ID：12610524
> 
> 赞同：2
> 
> 时间：2012-09-26T21:14:30.873
> 
> 标签：entity-framework, entity-framework-5

我正在尝试让 EF 5 生成单数表名。我的 DbContext 中有以下代码...

```
public partial class LiveoModelContainer : DbContext
{
    protected override void OnModelCreating(System.Data.Entity.DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();

        base.OnModelCreating(modelBuilder);
    }
} 
```

我们使用 Model First，并拥有自己生成的代码来遵循我们的内部开发模式。所以我们没有使用 EF 附带的开箱即用的代码生成。我在数据库工具/O/R 设计器中的 edmx 属性中将复数设置为 false，并删除了上面 OnModelCreating 中的约定。但是，表名仍然是复数。

我该如何解决？

# php - MySQLi 在非对象错误上调用成员函数 bind_param()

> ID：12610531
> 
> 赞同：1
> 
> 时间：2012-09-26T21:14:47.467
> 
> 标签：php, mysql, mysqli

这很奇怪。我只向 prepare() 和 bind_result() 添加了一个变量，它会导致错误。这是有效的代码：

```
$id = $_GET['id'];
$result = $mysqli->prepare("SELECT YiD, Title FROM Videos WHERE iD = ?");
$result->bind_param("s",$id);
$result->bind_result($youtubeid, $youtubetitle);
$result->execute();
$result->store_result();
$result->fetch(); 
```

现在这是不起作用的代码：

```
$id = $_GET['id'];
$result = $mysqli->prepare("SELECT YiD, Title, Desc FROM Videos WHERE iD = ?");
$result->bind_param("s",$id);
$result->bind_result($youtubeid, $youtubetitle, $youtubedesc);
$result->execute();
$result->store_result();
$result->fetch(); 
```

它给了我这个错误 - 致命错误：在第 23 行的 /home/content/77/9901377/html/video.php 中的非对象上调用成员函数 bind_param()

第 23 行是 bind_param("s",$id)

我已经正确调用了数据库，并且在第一个代码中一切正常，但是当我向代码中添加更多变量时，它就不起作用了。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:21:46.240

Desc 是[MySQL 的保留字](http://dev.mysql.com/doc/refman/5.5/en/reserved-words.html)。如果要将其用作列名或表名，则必须将其括在反引号 (`) 中

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:22:28.390

问题是它`$result`不是一个对象。

这是一个错误代码或`False`，因为您`Desc`在这里使用了（这是一个保留关键字）：

```
 $result = $mysqli->prepare("SELECT YiD, Title, Desc FROM Videos WHERE iD = ?"); 
```

因此`$mysqli->prepare`返回错误而不是适合参数绑定的 SQLi 对象。

尝试引用列名。

# xcode - XCode 项目损坏

> ID：12610533
> 
> 赞同：1
> 
> 时间：2012-09-26T21:14:55.367
> 
> 标签：xcode

我在 XCode 中从事 iOS 项目已经有一段时间了（XCode 4.4.1）。今天早上，我启动了 XCode（第一次更新了一段时间），它开始下载更新。完成后，我注意到我的大部分项目都消失了。我所有的原始文件都已从项目中删除。我检查了文件系统，它们仍然在那里。

我从 Timemachine 恢复了项目文件夹，但该项目真的很困惑，因为它是一个 MacOS 项目。所以我创建了一个新项目并将我的文件复制到其中。

这有点工作，但现在当我的应用程序运行时，它总是以纵向模式运行，即使我已将项目选项设置为仅在横向模式下运行。在横向模式下，文本（和按钮等）都是 90 度偏离的。当我旋转模拟器时，应用程序没有响应。

我已经将故事板设置为在推断和横向方向上都运行，但都没有工作。

我是否缺少让我的应用程序再次运行的项目设置？

有没有其他人遭受过这样的项目腐败？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:30:12.363

我在迁移到 iOS 6 时看到了类似的情况。我只是硬着头皮手动将 MainWindow/RootViewController 设置更改为 MainStoryboard。结果很好。确保你也禁用了[恶魔自动布局](http://www.goodbyehelicopter.com/2012/02/arggh-xcode-4-3-auto-layout-is-on-by-default-how-to-turn-off-auto-layout/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T19:55:02.087

问题解决了：我很笨。

该项目已得到纠正，因此我对其进行了重建。由于愚蠢，我更改了几个文件（视图控制器）的名称，但忘记更新情节提要。这就是早上 5 点发生故障时发生的情况。

# c# - 正确处理和删除对 UserControls 的引用，以避免内存泄漏

> ID：12610535
> 
> 赞同：15
> 
> 时间：2012-09-26T21:14:58.830
> 
> 标签：c#, winforms, visual-studio-2010, .net-4.0, visual-c#-express-2010

我正在使用 Visual c# express 2010 在 c# 中开发 Windows 窗体应用程序 (.NET 4.0)。我无法释放分配给我不再使用的 UserControls 的内存。

## 问题：

我有一个 FlowLayoutPanel，其中显示了自定义用户控件。FlowLayoutPanel显示搜索结果等，所以显示的UserControls集合必须反复更新。

在创建和显示每组新的 UserControl 之前，对当前包含在我的 FlowLayoutPanel 的 ControlCollection（Controls 属性）中的所有控件调用 Dispose()，然后在同一个 ControlCollection 上调用 Clear()。

这似乎不足以处理 UserControls 使用的资源，因为每组新的 UserControls 创建并添加到我的 ControlCollection 中，**垃圾回收似乎也没有声明我的 UserControls。**应用程序的内存使用量在短时间内急剧上升，然后达到一个平台，直到我显示另一个列表。我还使用[.NET Memory Profiler](http://www.memprofiler.com)分析了我的应用程序，它报告了许多可能的内存泄漏（参见下半部分。）

## 我认为出了什么问题：

我错了。**问题是由于使用 foreach 构造遍历 ControlCollection 并在其控件上调用 Dispose() 导致的错误，Hans Passant 在他的回答中对此进行了描述。**

* * *

该问题似乎是由我的 UserControls 中使用的 ToolTip 引起的。当我删除这些时，我的 UserControls 似乎被垃圾收集所占用。.NET 内存分析器证实了这一点。我之前的测试中的问题 1 和 6（见下部分）不再出现​​，它报告了一个新问题：

> 未处理的实例（释放资源并删除外部引用） 7 种类型的实例已被垃圾回收而未正确处理。调查以下类型以获取更多信息。
> 
> ChoiceEditPanel（继承）、NodeEditPanel（继承）、Button、FlowLayoutPanel、Label、>Panel、TextBox

即使工具提示的参考消失了，这不是一个长期的解决方案，当我不再需要它们时，仍然存在确定性地处置我的用户控件的问题。但是，它不如删除对工具提示的引用重要。

## 代码和更多细节

我使用一个名为 NodesDisplayPanel 的 UserControl，它充当 FlowLayoutPanel 的包装器。这是我的 NodesDisplayPanel 类中的方法，用于从我的 FlowLayoutPanel 中清除所有控件：

```
public void Clear() {
    foreach (Control control in flowPanel.Controls) {
        if (control != NodeEditPanel.RootNodePanel) {
            control.Dispose();
        }
    }
    flowPanel.Controls.Clear();
    // widthGuide is used to control the widths of the Controls below it,
    // which have Dock set to Dockstyle.Top
    widthGuide = new Panel();
    widthGuide.Location = new Point(0, 0);
    widthGuide.Margin = new Padding(0);
    widthGuide.Name = "widthGuide";
    widthGuide.Size = new Size(809, 1);
    widthGuide.TabIndex = 0;
    flowPanel.Controls.Add(widthGuide);
} 
```

这些方法用于添加控件：

```
public void AddControl(Control control) {
    flowPanel.Controls.Add(control);
}
public void AddControls(Control[] controls) {
    flowPanel.Controls.AddRange(controls);
} 
```

这是实例化新 NodeEditPanel 并通过我的 NodesDisplayPanel 将它们添加到我的 FlowLayoutPanel 的方法。此方法来自 ListNodesPanel（如下面的屏幕截图所示），它是实例化和添加 NodeEditPanel 的几个 UserControl 之一：

```
public void UpdateNodesList() {
    Node[] nodes = Data.Instance.Nodes;
    Array.Sort(nodes,(IComparer<Node>) comparers[orderByDropDownList.SelectedIndex]);
    if ((listDropDownList.SelectedIndex == 1)
        && (nodes.Length > numberOfNodesNumUpDown.Value)) {
        Array.Resize(ref nodes,(int) numberOfNodesNumUpDown.Value);
    }
    NodeEditPanel[] nodePanels = new NodeEditPanel[nodes.Length];
    for (int index = 0; index < nodes.Length; index ++) {
        nodePanels[index] = new NodeEditPanel(nodes[index]);
    }
    nodesDisplayPanel.Clear();
    nodesDisplayPanel.AddControls(nodePanels);
} 
```

这是我的 ListNodesPanel UserControl 的自定义初始化方法。希望它能让 UpdateNodesList() 方法更清晰一些：

```
private void NonDesignerInnitialisation() {
    this.Dock = DockStyle.Fill;
    listDropDownList.SelectedIndex = 0;
    orderByDropDownList.SelectedIndex = 0;
    numberOfNodesNumUpDown.Enabled = false;
    comparers = new IComparer<Node>[3];
    comparers[0] = new CompareNodesByID();
    comparers[1] = new CompareNodesByNPCText();
    comparers[2] = new CompareNodesByChoiceCount();
} 
```

如果特定 Windows.Forms 组件存在任何已知问题，以下是我的每个用户控件中使用的所有组件类型的列表：

**选择编辑面板：**

*   控制板
*   标签
*   按钮
*   文本框
*   工具提示

**节点编辑面板**

*   选择编辑面板
*   流布局面板
*   控制板
*   标签
*   按钮
*   文本框
*   工具提示

我还在为一些 TextBoxes使用[i00SpellCheck库](http://www.codeproject.com/Articles/265823/i00-Spell-Check-No-Third-Party-Components-Required)

## .NET Memory Profiler 最初报告的可能问题：

我让我的应用程序两次显示 50 个左右的 NodeEditPanel，第二个列表与第一个列表具有相同的值，但它们是不同的实例。.Net Memory Profiler 比较了应用程序在第一次和第二次操作后的状态，并生成了以下可能问题列表：

1.  直接 EventHandler 根
    一种类型具有直接由 EventHandler 根的实例。这可能表明 EventHandler 没有被正确删除。调查以下类型以获取更多信息。

    工具提示

2.  已处置实例
    2 种类型具有已处置但未 GC 的实例。调查以下类型以获取更多信息。

    System.Drawing.Graphics，WindowsFont

3.  未处理的实例（释放资源）
    6 种类型的实例已被垃圾回收而没有正确处理。调查以下类型以获取更多信息。

    System.Drawing.Bitmap、System.Drawing.Font、System.Drawing.Region、Control.FontHandleWrapper、光标、WindowsFont

4.  直接委托根
    2 种类型具有由委托直接根植的实例。这可能表明委托没有被正确删除。调查以下类型以获取更多信息。

    系统.__过滤器，__过滤器

5.  固定实例
    2 类型具有固定在内存中的实例。调查以下类型以获取更多信息。

    系统对象，系统对象 []

6.  间接事件处理程序根
    53 种类型具有由事件处理程序间接根的实例。这可能表明 EventHandler 没有被正确删除。调查以下类型以获取更多信息。

    , ChoiceEditPanel, NodeEditPanel, ArrayList, Hashtable, Hashtable.bucket[], Hashtable.KeyCollection, Container, Container.Site, EventHandlerList, (...)

7.  未处理的实例（内存/资源利用率）
    3 种类型的实例已被垃圾回收而没有正确处理。调查以下类型以获取更多信息。

    System.IO.BinaryReader、System.IO.MemoryStream、UnmanagedMemoryStream

8.  重复实例
    71 种类型有重复实例（492 组，741,229 个重复字节）。重复的实例会导致不必要的内存消耗。调查以下类型以获取更多信息。

    GPStream（8 组，318,540 个重复字节），PropertyStore.IntegerEntry[]（24 组，93,092 个重复字节），PropertyStore（10 组，53,312 个重复字节），PropertyStore.SizeWrapper（16 组，41,232 个重复字节），PropertyStore.PaddingWrapper（ 8 组，38,724 个重复字节），PropertyStore.RectangleWrapper（28 组，32,352 个重复字节），PropertyStore.ColorWrapper（13 组，30,216 个重复字节），System.Byte[]（3 组，25,622 个重复字节），ToolTip.TipInfo（ 10 组，21,056 个重复字节），Hashtable（2 组，20,148 个重复字节），（...）

9.  空弱引用
    Wea​​kReference 类型的实例不再存在。调查 WeakReference 类型以获取更多信息。

    System.WeakReference

10.  未处理的实例（清除引用）
    一种类型的实例已被垃圾回收而没有正确处理。调查以下类型以获取更多信息。

    事件处理程序列表

11.  大型实例
    2 类型具有位于大型对象堆中的实例。调查以下类型以获取更多信息。

    Dictionary.DictionaryItem[], System.Object[]

12.  持有的重复实例
    25 种类型具有由其他重复实例持有的重复实例（136 组，371,766 个重复字节）。调查以下类型以获取更多信息。

    System.IO.MemoryStream（8组，305340个重复字节），System.Byte[]（7组，248190个重复字节），PropertyStore.ObjectEntry[]（10组，40616个重复字节），Hashtable.bucket[]（2组, 9,696 重复字节), System.String (56 组, 8,482 重复字节), EventHandlerList.ListEntry (6 组, 4,072 重复字节), List (6 组, 4,072 重复字节), EventHandlerList (3 组, 3,992 重复字节), System.EventHandler（6 套，3,992 个重复字节），DialogueEditor.Choice[]（6 套，3,928 个重复字节），（...）

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-09-27T21:19:36.380

```
foreach (Control control in flowPanel.Controls) {
    if (control != NodeEditPanel.RootNodePanel) {
        control.Dispose();
    }
}
flowPanel.Controls.Clear(); 
```

这是一个非常经典的 Winforms bug，很多程序员都被它咬过。释放控件还会将其从父控件集合中移除。大多数 .NET 集合类在迭代它们更改集合时会触发 InvalidOperationException，但 ControlCollection 类没有这样做。效果是您的 foreach 循环跳过元素，它只处理偶数控件。

您已经发现了问题，但通过调用 Controls.Clear() 使问题变得更糟。特别讨厌，因为垃圾收集器不会最终确定以这种方式删除的控件。创建控件的本机窗口句柄后，它将保持由将窗口句柄映射到控件的内部表引用。只有销毁本机窗口才会从该表中删除引用。这种情况在这样的代码中永远不会发生，调用 Dispose() 是一个非常困难的要求。在 .NET 中非常不寻常。

解决方案是向后迭代 Controls 集合，以便处理控件不会影响您迭代的内容。像这样：

```
for (int ix = flowPanel.Controls.Count-1; ix >= 0; --ix) {
    var ctl = flowPanel.Controls[ix];
    if (ctl != NodeEditPanel.RootNodePanel) ctl.Dispose();
} 
```

# maven - WAR打包前使用Maven复制文件到WEB-INF

> ID：12610537
> 
> 赞同：0
> 
> 时间：2012-09-26T21:14:59.607
> 
> 标签：maven, weblogic, war, maven-antrun-plugin

我的 webapp 中有两个 servlet 配置文件，一个用于我们的正常环境（Heroku），另一个用于 WebLogic。我有一个用于我们的 WebLogic 构建的 Maven 配置文件，它应该将“servlet-context.xml.weblogic”复制到“servlet-context.xml”。一切似乎都在工作，除了在构建 war 文件之后进行复制，因此正确的 servlet 上下文不会包含在包中。在 maven-antrun-plugin 中使用正确的构建阶段以正确完成复制？

这是我的 POM.xml 文件的相关部分：

```
<plugin>
  <artifactId>maven-antrun-plugin</artifactId>
  <executions>
    <execution>
    <phase>test</phase>
    <goals>
      <goal>run</goal>
    </goals>
    <configuration>
      <tasks>
        <move
          file="${project.build.directory}/${project.build.finalName}/WEB-INF/spring/appServlet/radio-context.xml.weblogic"
          tofile="${project.build.directory}/${project.build.finalName}/WEB-INF/spring/appServlet/radio-context.xml"/>
      </tasks>
    </configuration>
    </execution>
  </executions>
</plugin> 
```

这失败并出现以下错误：

```
Failed to execute goal org.apache.maven.plugins:maven-antrun-plugin:1.3:run (default) on project radio: An Ant BuildException has occured: Warning: Could not find file C:\workspace\radio\target\radio-1.0.0-BUILD-SNAPSHOT\WEB-INF\spring\appServlet\radio-context.xml.weblogic to copy. -> [Help 1] 
```

但是，如果我将 更改`<phase>`为`package`，则副本有效，但在战争建立之后。

任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T06:25:52.387

作为参考，[此页面](http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html)列出了 Maven 生命周期阶段。

您在构建中需要考虑的关键阶段是：

*   `process-resources`- 大多数文件都放在哪里`${project.build.directory}`
*   `package`- 这是构建 WAR 的阶段

但...

查看[WAR 插件](http://maven.apache.org/plugins/maven-war-plugin/war-mojo.html)的文档，将 WAR 资源复制到目标`${project.build.directory}/${project.build.finalName}`中，该目标也在阶段`war:war`中执行。`package`

所以让我们退后一步。您想要实现的是`radio-context.xml`根据您的个人资料使用不同的文件。也许更好的方法是在您的 weblogic 配置文件中以不同方式配置 WAR 插件。

为您的 weblogic 提供一个单独的 webapp 资源目录，将您的自定义 radio-context.xml 文件放在那里，并且只将该目录包含在 weblogic 配置文件中。例如

```
<project>
  ...

  <profiles>
    <profile>
            <id>weblogic</id>
            ...
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.apache.maven.plugins</groupId>
                        <artifactId>maven-war-plugin</artifactId>
                        <version>2.2</version>
                        <configuration>
                            <webResources>
                                <resource>
                                    <directory>src/main/webapp-weblogic</directory>
                                </resource>
                            </webResources>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
</project> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T03:24:26.697

尝试使用**process-resources**，这会在战争建立之前复制您的文件。

# html - drupal 自定义块模块：如何显示从 hook_block_view(...) 动态生成的 html？

> ID：12610539
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:15:13.613
> 
> 标签：html, drupal, dynamic, view, generated

我想输出动态生成的 html 内容而不是可翻译的消息，但我不能让它工作：

```
function custom_logo_module_block_view($delta = '') {

    // don't worry about switch($delta) logic

    // perform some operations and then display some generated html

    // (maybe use the template(...) function)

    // works fine but i'd like to print html
    $block['content'] = t('No content available.');

    return $block;
} 
```

如何将生成的 html 打印到块中？

我找不到任何解决方案或代码示例。我想我可能指向错误的方向，所以欢迎提出最佳实践建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:41:04.317

```
function custom_logo_module_block_view($delta = '') {
  $block = array();
  if ($delta == 'example') {
    $block = array(
      'subject' => t('Active users list'),
      'content' => example_block_content()
    );
  }
  return $block;
}

function example_block_content() {
  // Query for active users from database
  $users = db_select('users', 'u')
    ->fields('u', array('uid', 'name'))
    ->condition('u.status', 1)
    ->execute()
    ->fetchAll();

  // Prepare items for item list
  $items = array();
  foreach ($users as $user) {
    $items[] = l($user->name, "user/{$user->uid}");
  }

  $output = t('No active users available.');

  if (!empty($items)) {
    $output = theme('item_list', array('items' => $items));
  }

  return $output;
} 
```

**关于您的评论的更新...**

据我了解，`some result`您的意思是从数据库生成的数据。在这种情况下，您可以尝试这样的事情：

```
function example_block_content() {
  // Query for active users from database
  $users = db_select('users', 'u')
    ->fields('u', array('uid', 'name'))
    ->condition('u.status', 1)
    ->execute()
    ->fetchAll();

  $output = '';
  foreach ($users as $user) {
    $output.= '<div>'. $user->name .'</div>';
  }

  $output = "<div>Hello World". $output ."</div>";

  return $output;
} 
```

这将为您提供以下输出：

```
<div>Hello World
  <div>admin</div>
  <div>ndrizza</div>
  <div>Vlad Stratulat</div>
  ...
</div> 
```

或者您可以尝试：

```
function custom_logo_module_block_view($delta = '') {
  $block = array();
  if ($delta == 'example') {
    $block = array(
      'subject' => t('Active users list'),
      // this will return "Hello World + some result" text inside <div>
      'content' => "<div>Hello World + some result</div>"
    );
  }
  return $block; 
} 
```

这两种方法都有效，但它们不是正确的方法。生成内容的正确方法是我的第一个答案。阅读有关 Drupal 主题的更多信息。

# html - 为什么这个元素不是从其父元素的顶部开始？

> ID：12610546
> 
> 赞同：0
> 
> 时间：2012-09-26T21:15:53.340
> 
> 标签：html, css, drupal

在[此页面上](http://brainfx.evermight.net/?q=node/7)，为什么 .section 没有位于 #content 的顶部？

我问了几个朋友，他们也不知道。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:20:07.003

因为你已经设置`#content`在`display: inline; float: left;`第 56 行`layout.css`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:35:25.093

一位朋友发现有 2 个嵌套在 .content 中的元素被 Drupal 放在那里，这导致了 #content 顶部的额外空间。奇怪的是，它们必须一起被移除，才能让空间消失。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:50:48.670

真是灾难

（`.tabs { display:none; }`或 .tabs `{ float: left; }`）和 `#node-7 .field-item.even p { float:right; }`

# vb.net - VB.net 可以控制 VBA 表单吗？

> ID：12610548
> 
> 赞同：2
> 
> 时间：2012-09-26T21:15:56.973
> 
> 标签：vb.net, vba, excel

我有一个包含表单的 Excel VBA 宏。我希望 VB.net 隐藏表单或控制它并单击“X”按钮或自定义“退出”按钮。

有人有这方面的经验吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T04:11:35.037

Sendkeys 非常不可靠。

如果您可以从 VB.Net 自动化 Excel，我建议您这样做。如果您对从 VB.Net 自动化 Excel 感兴趣，请参阅[此](http://www.siddharthrout.com/vb-dot-net-and-excel/)。

如果您不想自动化但想直接处理它，那么我建议使用`FindWindow`and `Sendmessage`API 来控制表单。请参阅此示例。

假设 Excel 中有一个用户表单，看起来像这样

![在此处输入图像描述](../Images/3ce29baaa0e08a41863c3ec15365308d.png)

使用此代码形式 VB.Net

**代码**：

```
Imports System.Runtime.InteropServices
Imports System.Text

Public Class Form1
    <DllImport("user32.dll", SetLastError:=True, CharSet:=CharSet.Auto)> _
    Private Shared Function FindWindow( _
         ByVal lpClassName As String, _
         ByVal lpWindowName As String) As IntPtr
    End Function

    <DllImport("user32.dll", SetLastError:=True, CharSet:=CharSet.Auto)> _
    Private Shared Function SendMessage(ByVal hWnd As IntPtr, _
        ByVal Msg As UInteger, _
        ByVal wParam As IntPtr, ByVal lParam As IntPtr) As Boolean
    End Function

    Private Const WM_CLOSE = &H10

    Private Sub Button1_Click(sender As System.Object, e As System.EventArgs) Handles Button1.Click
        Dim Ret As Integer

        '~~> Get the handle of the Excel Userform named "Example"
        Ret = FindWindow(vbNullString, "Example")

        '~~> If Found
        If Ret <> 0 Then
            '~~> Close the Window
            SendMessage(Ret, WM_CLOSE, CLng(0), CLng(0))
        End If
    End Sub
End Class 
```

# xml - 使用 xstl 展平 XML

> ID：12610553
> 
> 赞同：1
> 
> 时间：2012-09-26T21:16:31.340
> 
> 标签：xml, xslt

我有：

```
<nodes>
  <node>
    <name>node1</name>
    <other>stuff1</other>
    <node>
      <name>node11</name>
      <other>stuff11</other>
    </node>
    <node>
      <name>node12</name>
      <other>stuff12</other>
    </node>
  </node>
  <node>
    <name>node2</name>
    <other>stuff2</other>
  </node>
  <node>
    <name>node3</name>
    <other>stuff3</other>
  </node>
</nodes> 
```

我想最终得到一个平面结构，如：

```
<nodes>
  <node>
    <name>node1</name>
    <other>stuff1</other>
  </node>
  <node>
    <name>node11</name>
    <other>stuff11</other>
  </node>
  <node>
    <name>node12</name>
    <other>stuff21</other>
  </node>
  <node>
    <name>node2</name>
    <other>stuff2</other>
  </node>
  <node>
    <name>node3</name>
    <other>stuff3</other>
  </node>
</nodes> 
```

这是一个简单的示例，但我想复制每个节点中的所有元素，而不是嵌套的“节点”元素。我尝试复制以保留标签，但也保留了嵌套。我也尝试过复制，但忽略了所有孩子。

有任何想法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:36:59.703

这应该做你所追求的。对于顶级元素，它按文档顺序`nodes`为所有后代元素应用模板。`node`对于每个`node`它复制所有非子`node`元素。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

  <xsl:output method="xml" indent="yes" />

  <xsl:template match="node">
    <xsl:copy><xsl:copy-of select="*[local-name() != 'node']"/></xsl:copy>
  </xsl:template>

  <xsl:template match="/nodes">
    <xsl:copy><xsl:apply-templates select="descendant::node" /></xsl:copy>
  </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:29:45.680

我会使用 XQuery。它好多了：

```
<nodes>
  { //node/<node> { (name, other) } </node> }
</nodes> 
```

# python - 在金字塔框架中实现 Sqlalchemy 烧杯缓存

> ID：12610560
> 
> 赞同：2
> 
> 时间：2012-09-26T21:17:00.783
> 
> 标签：python, caching, sqlalchemy, pyramid, beaker

根据 sqlalchemy 文档提供的缓存 sqlalchemy 查询的示例，我们应该这样做

```
from caching_query import FromCache

# load Person objects.  cache the result under the namespace "all_people".
print "loading people...."
people = Session.query(Person).options(FromCache("default", "all_people")).all() 
```

我在 development.ini 中有以下烧杯配置

```
cache.regions = day, hour, minute, second
cache.type = file
cache.data_dir = %(here)s/cache/sess/data
cache.lock_dir = %(here)s/cache/sess/lock
cache.second.expire = 1
cache.minute.expire = 60
cache.hour.expire = 3600
cache.day.expire = 86400 
```

当我在我的应用程序中使用上面的示例代码时，数据没有缓存在缓存文件夹中，所以我假设基于内存的缓存是默认设置，是否可以将 sqlalchemy 缓存类型切换为基于文件的缓存？还是我弄错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:37:18.113

您的问题缺少一些细节，但让我试试：

*   传递给的第一个参数`FromCache()`是 Beaker 缓存区域的名称，它应该匹配一个配置的区域，这里不是这种情况。或者也许您在代码中配置区域（如果区域未知，`default`我希望被抛出）？`BeakerException`

*   您需要`pyramid_beaker`安装模块并将其包含在 Pyramid 的项目配置中。我建议您遵循`pyramid_beaker` [手册的*设置*部分](http://docs.pylonsproject.org/projects/pyramid_beaker/en/latest/#setup)。

*   您需要在应用程序中添加一些额外的代码`__init__.py`才能将`.ini`文件设置传播到 Beaker。这在手册的[*烧杯缓存区域支持*](http://docs.pylonsproject.org/projects/pyramid_beaker/en/latest/#beaker-cache-region-support)部分中进行了描述。

这是我当前项目的一个工作示例，配置了基于 Beaker 的会话和缓存（删除了所有不相关的部分）：

```
from pyramid.config import Configurator
from pyramid_beaker import set_cache_regions_from_settings
from pyramid_beaker import session_factory_from_settings

def main(global_config, **settings):
    # Configure Beaker caching/sessions    
    set_cache_regions_from_settings(settings)
    session_factory = session_factory_from_settings(settings)

    config = Configurator(settings=settings)
    config.set_session_factory(session_factory)
    config.include('pyramid_beaker')

    config.add_static_view('static', 'static', cache_max_age=3600)
    config.add_route('home', '/')

    config.scan()
    return config.make_wsgi_app() 
```

# java - 使用二维数组java存储点（x，y）

> ID：12610567
> 
> 赞同：-3
> 
> 时间：2012-09-26T21:17:33.697
> 
> 标签：java, arrays

我正在尝试编写一个类似 bouncingBall 的程序。但我在屏幕上生成了 N 个障碍物。每次球碰到障碍物时，障碍物就会消失并出现在另一个随机位置。我正在尝试使用二维数组来存储随机生成的障碍点（x，y）。

现在，如果我输入 N>50，它会让我出站。但我想要的是存储从（0,0）到（50,50）的点......我应该用二维数组做什么来实现这一点？

谢谢！

导入 java.util.ArrayList；

```
public class BouncingBall { 

    public static void main(String[] args) {

        if (args.length < 1) {
            System.out.println("Usage: java BouncingBall N");
            System.exit(0);
        }

        int N = Integer.parseInt(args[0]); 
        if (N > 2500) {
            System.out.println("Usage: java BouncingBall N<=2500");
            System.exit(0);
        }
        double[][] myArray = new double[50][50];

        // set the scale of the coordinate system
        StdDraw.setXscale(-1.0, 1.0);
        StdDraw.setYscale(-1.0, 1.0);

        // initial values
        double rx = 0.480, ry = 0.860;     // position
        double vx = 0.015, vy = 0.023;     // velocity
        double radius = 0.02;              // radius       
        double x;
        double y;
        double a[] = new double[2];

        StdDraw.setPenColor(StdDraw.WHITE);
        StdDraw.filledSquare(0, 0, 1.0);
        StdDraw.setPenColor(StdDraw.BLACK); 
        for(int i=0; i <= N; i++){
            x = 2.0*(double)Math.random()-1.0;
            y = 2.0*(double)Math.random()-1.0;
            for   (int  t=0;t <50;t++){ 
                for   (int   j=0;j <50;j++){ 
                      myArray[t][j]= x; 
                      myArray[j][t]= y; 
                } 
            } 
            StdDraw.filledSquare(x, y, 0.02);
            }

        // main animation loop
        while (true)  { 

            // bounce off wall according to law of elastic collision
            if (Math.abs(rx + vx) > 1.0 - radius) vx = -vx;
            if (Math.abs(ry + vy) > 1.0 - radius) vy = -vy;
            // clear the background   
            StdDraw.setPenColor(StdDraw.WHITE);
            StdDraw.filledSquare(0, 0, 1.0); 
            StdDraw.clear(); 

       StdDraw.setPenColor(StdDraw.BLACK);  

       for(int t=0; t <= N; t++){
           for   (int   j=0;j <50;j++){ 
                 x = myArray[t][j]; 
                 y = myArray[j][t]; 
           } 
        if ((Math.abs(rx + vx) > x - radius)||(Math.abs(ry + vy) > y - radius))
        {  //if the ball touch the square
            vx = -vx;
            vy = -vy;
            if (args.length == 2 && args[1].equals("-d")){
            x = 2.0*(double)Math.random()-1.0;  //new random x
            y = 2.0*(double)Math.random()-1.0;  //new random y
            }else{
                ;
            }
            StdDraw.filledSquare(x, y, 0.02);
            }
        else{
            StdDraw.filledSquare(x, y, 0.02); //if not touched, keep it.
            }
        }

       rx = rx + vx; 
       ry = ry + vy;

       StdDraw.filledCircle(rx, ry, radius); 
            // display and pause for 20 ms
        StdDraw.show(20); 
        }
    }  
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:20:50.110

想象一下，用户为 N 输入 -1，然后 x 和 y 不会得到值，因为循环体不会运行。

简单的解决方法：为 x 和 y 分配一个默认值（例如 0）

```
double x = 0;
double y = 0; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:20:59.890

您需要同时初始化`x`和`y`：

```
double x = 0;
double y = 0; 
```

您`ArrayIndexOutOfBoundsException`正在发生，因为您仅将数组定义为 50x50

双[][] myArray = 新双[50][50];

然而访问一个大于使用的索引`t`：

```
x = myArray[t][j]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:23:43.600

你必须初始化你的局部变量，局部变量没有默认值

```
 int double x=0.0;
   int double y=0.0; 
```

将解决编译器错误。

```
if N>50
  for   (int  t=0;t <50;t++){ 
                for   (int   j=0;j <50;j++){ 
                      myArray[t][j]= x; // ArrayIndexOutOfBound Exection occurs here 
                      myArray[j][t]= y; 
                } 
            } 
```

# android - android在屏幕关闭时保持cpu全速运行

> ID：12610568
> 
> 赞同：3
> 
> 时间：2012-09-26T21:17:34.503
> 
> 标签：android, multithreading, service, cpu, power-management

我创建了一个应用程序，通过在多部手机上运行相同的任务来比较 android 手机的 cpu 速度。我注意到在 HTC ONE X 上，如果我关闭屏幕，它会变得慢得多，而在另一部手机上做同样的事情时它不会改变。在程序中，我将任务放在服务中并在单独的线程中运行，优先级设置为最高值 10。

我尝试使用部分唤醒锁在屏幕关闭时保持 CPU 运行。但就速度而言，它没有任何区别。

我了解不同的操作系统/用户界面（例如 HTC 感觉）有自己的电源管理策略。但是我想知道是否有任何方法可以在不root手机的情况下克服它，意味着保持cpu以100％的时钟频率运行？

更新：最近的实验表明，当屏幕关闭时，One X（带 ICS）会降低其 cpu 频率并禁用多核功能，Galaxy Nexus（带 ICS）将降低约 25% 的性能，Nexus 7 将降低约 25 % 性能大部分时间（有时它可以在屏幕关闭时以最高速度运行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-09-18T12:31:07.523

1.  为什么唤醒锁不起作用？

对于 Qualcomm 设备，CPU 的热插拔是由一个名为`mpdecision`. 该`mpdecision`文件作为供应商可执行文件在我们的系统中运行，它的作用是控制 CPU 的调控器。`mpdecision`定义您的 cpu1 的性能，每次屏幕关闭时都会执行该文件，因此 cpu1 脚本是无用的，因为该`mpdecision`文件将 cpu1 调控器设置覆盖为`userspace` `ondemand`，`userspace`是 cpu1 在线和`ondemand`离线时的调控器。[参考](http://www.scottsroms.com/showthread.php?447-CPU1-governor-change-with-MPDECISION-file-script)

2.  我能做些什么来保持 CPU 不降低其频率吗？

你需要停止`mpdecision`，然后你可以保持CPU频率。但是，停止`mpdecision`需要 root 权限。所以我认为没有root权限就无法保持CPU频率。

您可以写入值来`/sys/devices/system/cpu/cpu0/online`打开或关闭 CPU 的核心，写入值来`/sys/devices/system/cpu/cpu0/cpufreq/scaling_setspeed`设置每个核心的频率。我在 Nexus 4 中尝试了这种方法，效果很好。

有关更多详细信息，您可以查看[此](https://stackoverflow.com/a/25911984/3103844)。

# javascript - 单击时更改 div 的背景图像

> ID：12610569
> 
> 赞同：1
> 
> 时间：2012-09-26T21:17:35.690
> 
> 标签：javascript

好吧，我觉得我的头很密集。但我似乎无法让它发挥作用。我正在为摄影师做一个网站，他希望能够让用户从 3 中选择他们想要的框架。我认为最简单的方法是创建一个 div，然后拥有它根据按钮单击更改类。所以它会改变背景图像。但是我不能让它这样做。任何想法都会受到好评，因为我猜可能有一个 javascript 版本可以更快更容易地完成它。

```
<html>
<head>
<title>Untitled</title>
<style>
#pictureframe {
width:200px;
height:200px;
}

.wooden {
background-image:url(frame.png);
}

.plain {
background-image:url(clear.png);
}

.black {
background-image:url(black.png);
}

</style>
</head>
<body>

<div id="pictureframe">
</div>

<div style="height:20px;border:1px solid #617779;width:90px;text-align:center;background-color:white;" onclick = "pictureframe.style.className = 'wooden'">Make it wood</div>
<br>
<div style="height:20px;border:1px solid #617779;width:90px;text-align:center;background-color:white;" onclick = "pictureframe.style.className = 'clear'">Make it Frameless</div>
<br>
<div style="height:20px;border:1px solid #617779;width:90px;text-align:center;background-color:white;" onclick = "pictureframe.style.className = 'wooden'">Make it Black Bezel</div>
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:20:57.347

`className`不是`style`DOM 元素中对象的一部分，而是直接属性：

```
document.getElementById("pictureframe").className = 'wooden'; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:21:58.033

它不是

```
pictureframe.style.className = ... 
```

但

```
pictureframe.className = ... 
```

[**演示**](http://jsfiddle.net/HH8Sy/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:22:46.753

试试这个：

```
onclick ="pictureframe.className = 'wooden'" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:32:13.103

如果您想使用其他一些样式类，则可能需要使用以下内容：

```
function replaceClass(className) {
    $('#pictureframe').removeClass('plain black wooden');
    return $('#pictureframe').addClass(className);
}​ 
```

这样你就可以保持课堂风格[http://jsfiddle.net/NjTea/5/](http://jsfiddle.net/NjTea/5/)

# matlab - Matlab：随机化和拆分

> ID：12610571
> 
> 赞同：0
> 
> 时间：2012-09-26T21:17:40.167
> 
> 标签：matlab, matrix, split

我在 Matlab 中有以下数据矩阵，我试图通过将变量传递给 matlab 函数来将其实际拆分为多个段。但在拆分之前，我想对矩阵进行洗牌。我的矩阵的大小是`150X4`

```
s.data
5.1000    3.5000    1.4000    0.2000
4.9000    3.0000    1.4000    0.2000
4.7000    3.2000    1.3000    0.2000
4.6000    3.1000    1.5000    0.2000
5.0000    3.6000    1.4000    0.2000
..

s = 

  data: [150x4 double]
labels: [150x1 double] 
```

来自 R 环境，我发现 MatLab 很奇怪。最初我认为矩阵中的列与 R 数据框中的关系有相似之处，但我的假设是错误的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T21:35:23.170

或者你可以这样做：

```
 perm=randperm(numel(data)); % generate a random permutation
 data = reshape(data(perm),size(data)); % apply it to data 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:30:38.493

```
new_data=data(randsample(1:length(data),length(data)),:) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:26:31.467

补充 shuffle 答案，为了将您的数据拆分为`15x2`每个矩阵，您可以使用`mat2cell`：

```
data = rand(150,4);        %# generates a random 150x4 matrix
rowdiv = repmat(15,1,10);  %# size of each chunk in rows. Must sum to 150
coldiv = repmat(2,1,2);    %# size of each chunk in cols. Must sum to 4
datacell = mat2cell(data, rowdiv, coldiv) 
```

它将返回一个包含 20 个矩阵的单元格，可通过以下方式访问`datacell{x,y}`：

```
数据单元 =

    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]
    [15x2 双] [15x2 双]

```

`B = repmat(A,M,N)`创建一个`B`由 的 M×N 副本组成的大型矩阵`A`。我们在这里使用它来生成行和列的精确划分，分别重复元素`15`十次和`2`两次。但是，您不需要进行精确的划分。您可以设置不同大小的块。不同大小的行：

```
rowdiv =

    15    15    15    15    15    15    15    15    16    14 
```

将返回：

```
数据单元 =

    [15x4 双]
    [15x4 双]
    [15x4 双]
    [15x4 双]
    [15x4 双]
    [15x4 双]
    [15x4 双]
    [15x4 双]
    [16x4 双]
    [14x4 双]

```

# list - 带有日志记录的简单脚本

> ID：12610572
> 
> 赞同：0
> 
> 时间：2012-09-26T21:17:51.107
> 
> 标签：list, logging, vbscript, copy

我正在尝试编写一个脚本，将文件从文件夹 A 复制到文件夹 B，它只会复制来自列表文件的文件。

然后我需要它来记录任何无法复制的文件。这是我到目前为止所拥有的，我只是无法让日志记录工作。

```
 Option Explicit

Dim Sour, Dest
Dim oFSO, sFile, oFile, sText
Dim objFSO, objFileCopy
Dim strFilePath, strDestination, strSource
Const ForReading = 1, ForWriting = 2, ForAppending = 8

strLoggingFiles = "C:\failedtransfer.txt"

strSource = InputBox("Enter source path information") 'Enter your source path here
strDestination = InputBox("Enter destination path information") 'Enter your destination path here

'Set the read of the input file and prompt for location
Set oFSO = CreateObject("Scripting.FileSystemObject")
sFile = InputBox("Enter path to text document with files to be copied:")

'Open the read, get the file name of the file to be copied, and copy it to new location
If oFSO.FileExists(sFile) Then
   Set oFile = oFSO.OpenTextFile(sFile, ForReading)
   Do While Not oFile.AtEndOfStream
      sText = oFile.ReadLine
      If (Trim(sText) <> "") And _
         oFSO.FileExists(strSource & "\" & sText) Then

         oFSO.CopyFile strSource & "\" & sText, strDestination
      Else
         WScript.Echo "Couldn't find " & strSource & "\" & sText
      End If
   Loop
   oFile.Close
Else
   WScript.Echo "The file was not there."
End If 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:44:25.520

这是代码。如果复制时丢失或失败，它将记录源文件名（完整路径）。请注意，在 Vista/Win7+ 中，如果要将文件放在根目录中，则需要管理员权限。

```
Option Explicit

Dim Sour, Dest
Dim oFSO, oLog, sFile, oFile, sText
Dim objFSO, objFileCopy
Dim strFilePath, strDestination, strSource
Const ForReading = 1, ForWriting = 2, ForAppending = 8

strLoggingFiles = "C:\failedtransfer.txt"

strSource = InputBox("Enter source path information") 'Enter your source path here
strDestination = InputBox("Enter destination path information") 'Enter your destination path here

'Set the read of the input file and prompt for location
Set oFSO = CreateObject("Scripting.FileSystemObject")
sFile = InputBox("Enter path to text document with files to be copied:")

'Open the read, get the file name of the file to be copied, and copy it to new location
If oFSO.FileExists(sFile) Then
   'Open/create log file
   set oLog = oFSO.OpenTextFile(strLoggingFiles, ForAppending, True)

   Set oFile = oFSO.OpenTextFile(sFile, ForReading)
   Do While Not oFile.AtEndOfStream
      sText = oFile.ReadLine
      If (Trim(sText) <> "") And _
         oFSO.FileExists(strSource & "\" & sText) Then

         On Error Resume Next 'disable quit on error
         oFSO.CopyFile strSource & "\" & sText, strDestination
         If Err.Number <> 0 Then
             oLog.WriteLine strSource & "\" & sText 'log failed copy
         End If
         On Error Goto 0 'enable quit on error
      Else
         WScript.Echo "Couldn't find " & strSource & "\" & sText
         oLog.WriteLine strSource & "\" & sText 'log failed copy 'log missing source
      End If
   Loop
   oFile.Close
   oLog.Close 'close log file
Else
   WScript.Echo "The file was not there."
End If 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T10:23:51.817

在某些时候，我厌倦了一遍又一遍地编写日志记录例程，所以我写了一个类（[CLogger](http://www.planetcobalt.net/sdb/index.shtml#clogger)）作为一个抽象层，用于记录到不同的设施（控制台、事件日志、文件）：

```
Set clog = New CLogger
clog.LogFile = "C:\failedtransfer.txt"
clog.LogToConsole  = False
clog.LogToEventlog = False

'...

On Error Resume Next
oFSO.CopyFile strSource & "\" & sText, strDestination
If Err Then
  clog.LogError strSource & "\" & sText & ": " & FormatErrorMessage(Err)
End If
On Error Goto 0

'... 
```

# android - Android - 如何清除 textView？

> ID：12610574
> 
> 赞同：8
> 
> 时间：2012-09-26T21:18:01.713
> 
> 标签：android, textview

我使用 eclipse 在 java 中创建了一个 android 应用程序，它创建了一个 Sqlite 数据库并让用户向其中添加数据。用户还可以搜索现有数据。我使用了 android 光标对象。查询完成后如何清除文本框？例如，我键入“值”以检索与该值关联的所有记录。现在我想执行另一个搜索。当我单击文本框时，我希望为下一次搜索清除文本框。

这是我插入和检索数据的代码的一部分：

```
db.execSQL("CREATE TABLE IF NOT EXISTS " + MY_DATABASE_TABLE + " (id INTEGER PRIMARY KEY AUTOINCREMENT, " + " name TEXT," + " number TEXT);");

Cursor cur = db.rawQuery("INSERT INTO " + MY_DATABASE_TABLE + " (name, number)" + " VALUES ( \"" + newname + "\", \"" + newnumber + "\");", null);
cur.moveToFirst();
while (cur.isAfterLast() == false) 
{
    result.append("\n" + "Id: " + cur.getString(0) + " | " + "Name: " + cur.getString(1) + " | " + "Phone Number: " + cur.getString(2) + "\n");

    cur.moveToNext();
}
cur.close(); 

Cursor c = db.rawQuery("SELECT * FROM " + MY_DATABASE_TABLE, new String [] {}  );

c.moveToFirst();

while (c.isAfterLast() == false) {
    result.append("\n" + "Id: " + c.getString(0) + " | " + "Name: " + c.getString(1) + " | " + "Phone Number: " + c.getString(2) + "\n");

    c.moveToNext();
}
c.close(); 
```

谢谢。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-09-26T21:29:25.207

首先，您可能不想清除数据库以仅清除 textView。因此，相关代码将在您的活动中。

因此，如果您使用的是 textView，您将在代码中执行类似的操作

// 全局变量

```
 TextView yourTexView; 
```

// 在你的 Create 活动中

```
 yourTexView  = (TextView) findViewById(R.id.yourTexView );
    yourTexView .setOnClickListener(yourClickListener) 
```

// 活动类中的某处

```
/**
 * Tour Click Handler - This will clear the textview whenever someone clicks it. 
 */
private OnClickListener yourClickListener= new OnClickListener() {
    public void onClick(View v) {
        yourTexView.setText("");
    }
}; 
```

// 在您的 xml 文件中 - 根据需要进行更改

```
 <TextView
        android:id="@+id/yourTexView"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:text="" /> 
```

希望这会有所帮助，干杯

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2016-09-14T22:35:59.427

要么——`setText("")`要么`setText(null)`——其中任何一个都可以。我`setText(null)`出于可读性原因使用。

# sql - 是否可以仅使用源数据库中的更改来更新克隆数据库？

> ID：12610575
> 
> 赞同：0
> 
> 时间：2012-09-26T21:18:04.663
> 
> 标签：sql, database, oracle, ms-access, plsql

出于我不打算解释的原因，我们保留了一个 Access 数据库，它是一个更大的 oracle 数据库的子集的副本。由于速度问题（不要问），直接在Oracle数据库中引用数据是不可行的。

每次打开特定应用程序时，本地 Access 数据库都会从找到的最新数据更新到打开应用程序的时间。首先，这并没有捕捉到现有记录的变化。其次，它不考虑在打开应用程序后对源数据库所做的更改。

因此，在应用程序中执行某些操作时可能需要进行多项检查。那么，是否有可能仅通过 Oracle 数据库中的更改以比我想象的硬方式更智能和更快的方式更新本地 Access 数据库（我不是 PL/SQL/SQL 专家）？可能仅在某个日期之后查找更改（存储在检索的记录集的字段之一中）可能就足够了。

有什么建议么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T14:47:09.517

您可能想研究 Oracle en MSAccess 数据库之间的数据复制。例如通过 ODBS 驱动器或 sqlserver 数据库。只需谷歌“ms access oracle replication”，看看这是否能解决您的问题。

# mysql - 使用 ActiveRecord 使用 MySQL 子句“使用索引（'index_name'）”的最佳方式

> ID：12610577
> 
> 赞同：5
> 
> 时间：2012-09-26T21:18:10.560
> 
> 标签：mysql, ruby-on-rails, activerecord

我想在 ActiveRecord 查询中使用 SQL 子句“使用索引（'index_name'）”，有没有人知道使用 Activerecord 执行此操作的好方法我想避免将字符串直接添加到查询中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-10-23T20:55:27.777

我在我的模型中使用它：

```
def self.use_index(index)
  from("#{self.table_name} USE INDEX(#{index})")
end 
```

# .net - Windows 8 上缺少 XmlWriterTraceListener

> ID：12610581
> 
> 赞同：0
> 
> 时间：2012-09-26T21:18:28.830
> 
> 标签：.net, .net-4.0, windows-8

在 Windows 8 x64 服务器上测试我们的应用程序时，我们遇到了一个问题，即在将 XmlWriterTraceListner 添加到应用程序配置文件时，服务会抛出未找到类的异常。

> 无法启动服务。System.Configuration.ConfigurationErrorsException：找不到类 System.Diagnostics.XmlWriterTraceListener、System、Version=4.0.0.0、Culture=neutral、PublicKeyToken=b77a5c561934e089 的类型。

我的理解是 Windows 8 应该已经安装了 .net 4.0？为什么缺少这门课？这个问题的任何官方解决方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-28T20:17:45.953

通过删除显式程序集版本信息解决了该问题

# c# - 在 C# GET 请求中将 JSON 数据转换为查询字符串

> ID：12610585
> 
> 赞同：5
> 
> 时间：2012-09-26T21:19:27.663
> 
> 标签：c#, asp.net, json, get, query-string

将 JSON 对象转换为查询字符串以附加到 GET Url 的最佳方法是什么？POST 很简单，可以被我的 Web API 后端读取。

{姓名：“迈克”} = ?姓名=迈克

```
 private static string MakeRequest(HttpWebRequest req, string data)
            {
                try
                {
                    if (req.Method == Verbs.POST.ToString() || req.Method == Verbs.PUT.ToString() || req.Method == Verbs.DELETE.ToString())
                    {
                        var encodedData = Encoding.UTF8.GetBytes(data);

                        req.ContentLength = encodedData.Length;
                        req.ContentType = "application/json";
                        req.GetRequestStream().Write(encodedData, 0, encodedData.Length);
                    }

                    using (var response = req.GetResponse() as HttpWebResponse)
                    using (var reader = new StreamReader(response.GetResponseStream()))
                    {
                        return reader.ReadToEnd();
                    }
                }
                catch (WebException we)
                {
                    if(we.Response == null)
                    {
                        return JsonConvert.SerializeObject(new { Errors = new List<ApiError> { new ApiError(11, "API is currently unavailable") }});
                    }

                    using (var response = we.Response as HttpWebResponse)
                    using (var reader = new StreamReader(response.GetResponseStream()))
                    {
                        return reader.ReadToEnd();
                    }
                }

  } 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-09-26T21:38:53.297

如果 json 对象像您的示例中那样平坦，则

```
string json = @"{
    ""name"": ""charlie"",
    ""num"": 123
}";

var jObj = (JObject)JsonConvert.DeserializeObject(json);

var query = String.Join("&",
                jObj.Children().Cast<JProperty>()
                .Select(jp=>jp.Name + "=" + HttpUtility.UrlEncode(jp.Value.ToString()))); 
```

查询将是`name=charlie&num=123`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-04-18T12:20:27.140

我让这段代码在.Net Core中运行：

```
public static string JsonToQuery(this string jsonQuery)
    {
        string str = "?";
        str += jsonQuery.Replace(":", "=").Replace("{","").
                    Replace("}", "").Replace(",","&").
                        Replace("\"", "");
        return str;
    } 
```

例子：

```
var _baseURI = "http://www.example.com/";
var endPoint = "myendpoint";
ExampleObjectModel requestModel = new ExampleObjectModel();
var requestModelJson = JsonConvert.SerializeObject(requestModel);
var url = string.Format("{0}{1}{2}", _baseURI, endPoint, requestModelJson.JsonToQuery()); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-10-06T06:58:46.880

试试这个，深入研究所有对象

```
 public static class ExtensionMethods
{
    public static string GetQueryString(this object obj, string prefix = "")
    {
        var query = "";
        try
        {
            var vQueryString = (JsonConvert.SerializeObject(obj));

            var jObj = (JObject)JsonConvert.DeserializeObject(vQueryString);
            query = String.Join("&",
               jObj.Children().Cast<JProperty>()
               .Select(jp =>
               {
                   if (jp.Value.Type == JTokenType.Array)
                   {
                       var count = 0;
                       var arrValue = String.Join("&", jp.Value.ToList().Select<JToken, string>(p =>
                       {
                           var tmp = JsonConvert.DeserializeObject(p.ToString()).GetQueryString(jp.Name + HttpUtility.UrlEncode("[") + count++ + HttpUtility.UrlEncode("]"));
                           return tmp;
                       }));
                       return arrValue;
                   }
                   else
                       return (prefix.Length > 0 ? prefix + HttpUtility.UrlEncode("[") + jp.Name + HttpUtility.UrlEncode("]") : jp.Name) + "=" + HttpUtility.UrlEncode(jp.Value.ToString());
               }
               )) ?? "";
        }
        catch (Exception ex)
        {

        }
        return query;
    }
} 
```

使用：SomeObject.GetQueryString();

# ios - UICollectionViewCell 阴影颜色

> ID：12610591
> 
> 赞同：10
> 
> 时间：2012-09-26T21:20:06.867
> 
> 标签：ios, uicollectionview

在新的 UICollectionView 中，我看不到如何向 UICollectionViewCell 添加阴影。我该怎么办。我会添加另一个视图吗？

```
 [self.collectionView cellForItemAtIndexPath:[self.collectionView indexPathForItemAtPoint:[recognizer locationInView:[self view]]]].layer.shadowPath = [UIBezierPath bezierPathWithRect:rect].CGPath;
    [self.collectionView cellForItemAtIndexPath:[self.collectionView indexPathForItemAtPoint:[recognizer locationInView:[self view]]]].layer.shadowColor = [UIColor yellowColor].CGColor;
    [self.collectionView cellForItemAtIndexPath:[self.collectionView indexPathForItemAtPoint:[recognizer locationInView:[self view]]]].layer.shadowRadius = .5;
    [self.collectionView cellForItemAtIndexPath:[self.collectionView indexPathForItemAtPoint:[recognizer locationInView:[self view]]]].layer.shadowOpacity = .1; 
```

![在此处输入图像描述](../Images/f055bfa9ec1fb194b229f0d456ae7dda.png)

* * *

## 回答 #1

> 赞同：42
> 
> 时间：2013-02-02T10:08:28.413

你忘了设置`masksToBounds`到. 这应该有效：`UIView``NO`

```
- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    PhotoCell *cell = [collectionView dequeueReusableCellWithReuseIdentifier:@"PhotoCell" forIndexPath:indexPath];

    cell.layer.masksToBounds = NO;
    cell.layer.borderColor = [UIColor whiteColor].CGColor;
    cell.layer.borderWidth = 7.0f;
    cell.layer.contentsScale = [UIScreen mainScreen].scale;
    cell.layer.shadowOpacity = 0.75f;
    cell.layer.shadowRadius = 5.0f;
    cell.layer.shadowOffset = CGSizeZero;
    cell.layer.shadowPath = [UIBezierPath bezierPathWithRect:cell.bounds].CGPath;
    cell.layer.shouldRasterize = YES;

    return cell;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-24T17:18:47.443

```
[self.collectionView cellForItemAtIndexPath:[self.collectionView indexPathForItemAtPoint:[recognizer locationInView:[self view]]]].layer.masksToBounds = NO; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-05T01:58:24.957

most likely your problem is best solved with the existing answer to [How do I draw a shadow under a UIView?](https://stackoverflow.com/a/5428108/774691)

to be specific to your circumstance, you would probably have code that would do what the following code does (depending upon where you get your collectionView and someIndexPath in order to point to the cell you're interested in):

```
 UICollectionViewCell* collectionViewCell
      = [collectionView dequeueReusableCellWithReuseIdentifier:DEFINED_IDENTIFIER forIndexPath:someIndexPath];
    collectionViewCell.layer.shadowPath = [UIBezierPath bezierPathWithRect:collectionViewCell.bounds].CGPath; 
```

there are obviously other ways to get the cell. the important thing is the 2nd line, to set the shadowPath.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-11T16:30:04.617

您没有在图层上设置 shadowOffset 属性。

```
myCell.layer.shadowOffset = CGSizeMake(10,10); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-12-25T06:00:47.587

转到 CustomCollectionviewCell.m 并尝试添加：

```
- (id)initWithFrame:(CGRect)frame
{
    self = [super initWithFrame:frame];
    if (self) {
        //////// make shadow  of total view
        self.clipsToBounds = NO;
        self.layer.masksToBounds = NO;
        self.layer.shadowRadius = 5;
        self.layer.shadowOpacity = 0.5;
        self.layer.shadowColor = [UIColor blackColor].CGColor;
        self.layer.shadowOffset = CGSizeMake(0, 1);
        self.layer.shadowPath = [UIBezierPath bezierPathWithRect:self.bounds].CGPath;

        // make radius of the cell
        self.layer.cornerRadius = 5;

    }
    return self;
} 
```

# asp.net - 合并来自多个表的值

> ID：12610600
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:20:58.390
> 
> 标签：asp.net, sql, linq, join

我有一个应用程序，它的数据分布在 2 个表中。

有一个主表 Main，其中包含列 - Id、Name、Type。现在有一个包含列的子主表 - MainId(FK)、StartDate、Enddate、city，这是一个一对多的关系（每个主表在 submain 中可以有多个条目）。

现在我想显示列 Main.Id、City（作为逗号与子主项中该主项的各行分隔）、开始日期的最小值（该主项的子项）和结束日期的最大值（子主项）。

我想有一个功能，但这会减慢速度，因为会有 10 万条记录。有没有其他方法可以做到这一点。顺便说一句，该应用程序位于 asp.net 中。我们可以有一个 sql 查询或一些 linq 之类的东西吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:14:42.327

这不是我的想法，但首先我建议您在 sql 中创建一个用户定义的函数来创建接受 @mainid 的城市逗号分隔列表字符串，然后执行以下操作：

```
DECLARE @listStr VARCHAR(MAX)
SELECT @listStr = COALESCE(@listStr+',' , '') + city
FROM submain
WHERE mainid = @mainid 
```

...然后返回@listStr，它现在将是一个逗号分隔的城市列表。假设您调用函数 MainIDCityStringGet()

然后对于您的最终结果，您可以简单地执行以下操作

```
select cts.mainid,
       cts.cities,
       sts.minstartdate,
       sts.maxenddate
  from ( select distinct mainid,
                         dbo.MainIDCityStringGet(mainid) as 'cities'
           from submain) as cts
         join
       ( select mainid,
                min(startdate) as 'minstartdate',
                max(enddate)   as 'maxenddate'
           from submain
          group by mainid ) as sts on sts.mainid = cts.mainid
 where startdate <is what you want it to be>
   and enddate   <is what you want it to be> 
```

根据您希望按 startdate 和 enddate 过滤的准确程度，您可能需要将 where 过滤器放在每个子查询中，然后在连接的第二个子查询中，您可能需要使用 HAVING 分组过滤器。您没有明确说明过滤器的性质。

我希望这会有所帮助。

这当然是在存储过程中。可能需要一些调试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T02:41:41.600

创建存储过程的另一种方法是在客户端执行复杂的操作。（未经测试）：

```
var result = (from main in context.Main
              join sub in context.SubMain on main.Id equals sub.MainId into subs
              let StartDate = subs.Min(s => s.StartDate)
              let EndDate = subs.Max(s => s.EndDate)
              let Cities = subs.Select(s => s.City).Distinct()
              select new { main.Id, main.Name, main.Type, StartDate, EndDate, Cities })
             .ToList()
             .Select(x => new
                          {
                              x.Id,
                              x.Name,
                              x.Type,
                              x.StartDate,
                              x.EndDate,
                              Cities = string.Join(", ", x.Cities.ToArray())
                          })
             .ToList(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T08:09:09.783

我不确定这在 SQL 的其他实现中得到了多大的支持，但如果你有 SQL Server，这对于这种类型的场景来说很有魅力。

作为免责声明，我想补充一点，我不是这项技术的创始人。但是当我遇到这个问题时，我立即想到了这个问题。

例子：

对于一张桌子

```
Item ID       Item Value       Item Text
-----------  ----------------- ---------------
1             2                 A 
1             2                 B
1             6                 C
2             2                 D
2             4                 A
3             7                 B
3             1                 D 
```

如果您想要以下输出，将字符串连接起来并求和。

```
Item ID      Item Value        Item Text
-----------  ----------------- ---------------
1            10                 A, B, C 
2            6                  D, A
3            8                  B, D 
```

以下避免了多语句循环解决方案：

```
if object_id('Items') is not null
  drop table Items
go

create table Items
     ( ItemId    int identity(1,1),
       ItemNo    int not null,
       ItemValue int not null,
       ItemDesc  nvarchar(500) )

insert Items
     ( ItemNo,
       ItemValue,
       ItemDesc )
values ( 1, 2, 'A'),
       ( 1, 2, 'B'),
       ( 1, 6, 'C'),
       ( 2, 2, 'D'),
       ( 2, 4, 'A'),
       ( 3, 7, 'B'),
       ( 3, 1, 'D')

select it1.ItemNo,
       sum(it1.ItemValue) as ItemValues,
       stuff((select ', ' + it2.ItemDesc  --// Stuff is just used to remove the first 2 characters, instead of a substring.
                from Items it2 with (nolock)
               where it1.ItemNo = it2.ItemNo
                 for xml path(''), type).value('.','varchar(max)'), 1, 2, '') as ItemDescs --// Does the actual concatenation..  
  from Items it1 with (nolock)
 group by it1.ItemNo 
```

因此，您看到您所需要的只是您的选择中的一个子查询，该查询检索一组您需要连接的所有值，然后以一种巧妙的方式在该子查询中使用 FOR XML PATH 命令。您需要连接的值来自哪里并不重要，您只需要使用子查询检索它们即可。

# php - 有没有办法判断 --debug 或 --verbose 是否在测试中传递给 PHPUnit？

> ID：12610605
> 
> 赞同：10
> 
> 时间：2012-09-26T21:21:06.003
> 
> 标签：php, phpunit

我正在对使用 CaptureEntirePageScreenshotToString 函数的 PHPUnit 的 Selenium 扩展进行一些重载，并且我只想在 --verbose 或 --debug 传入时打印屏幕截图的路径。

例如， `phpunit --debug ./tests`

然后在我的代码中的某个地方（这是伪代码）

```
if (--debug)
  echo "Screenshot: /path/to/screenshot.png 
```

建议？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-27T01:17:47.373

没有 PHPUnit 内部 API 可以做到这一点。无法通过测试用例直接访问配置对象。

您不能`PHPUnit_Util_Configuration::getInstance()`仅将其用作 xml 配置的包装器。

我的建议是只使用：

```
if(in_array('--debug', $_SERVER['argv'], true)) {
     //Insert your debug code here.
} 
```

相关类：

*   [**`Command Parser`**](https://github.com/sebastianbergmann/phpunit/blob/master/src/TextUI/Command.php)
*   [**`Test Runner`**](https://github.com/sebastianbergmann/phpunit/blob/master/src/TextUI/TestRunner.php)

# php - 是否可以防止标准 HTML 注释出现在源代码中？

> ID：12610606
> 
> 赞同：12
> 
> 时间：2012-09-26T21:21:09.063
> 
> 标签：php, html, comments

我将假设这里的答案是“不”，但由于我实际上还没有找到答案，所以我在问。

基本上，我想做的就是在我的文件中留下一些 HTML 注释，以供“仅作者的眼睛”使用，只是为了让以后编辑文件成为一种更愉快的体验。

`<!-- Doing it like this -->`留下漂亮干净的评论，但在输出后查看页面源时它们会出现。

我正在使用 PHP，所以从技术上讲，我可以`<?PHP /* wrap comments in PHP tags */ ?>`完全阻止它们被输出，但如果可能的话，我想避免在整个文件中进行评论所需的所有额外的任意 PHP 标记。毕竟，评论的目的是让文档感觉不那么杂乱，更有条理。

还有什么我可以尝试的，或者这些是我最好的选择吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:23:20.667

不，html 中的任何内容都会显示出来。

您可以拥有一个解析代码并删除注释的脚本，然后再将其放到服务器上，然后您将拥有原始的和未注释的源。

完成此任务的工具： [http ://code.google.com/p/htmlcompressor/](http://code.google.com/p/htmlcompressor/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:26:47.967

我想这些是您最好的选择，是的，除非您在发送到客户端之前通过某种清理模块运行整个 HTML 输出。

如果在输出时没有修改（例如，通过模板引擎），任何未包含在服务器端语法中的内容都将输出到客户端。这适用于大多数（可能是所有）服务器端语言）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:29:43.650

您绝对可以编写一个使用正则表达式去除 HTML 注释的解析器，但除非您已经在处理自己的 CMS，否则这方面的工作很可能远远超过不使用 PHP 注释的好处，如您所建议的.

# java - 在 Java 中使用内存映射文件的 IO 错误

> ID：12610608
> 
> 赞同：1
> 
> 时间：2012-09-26T21:21:21.327
> 
> 标签：java, exception, memory-mapped-files

我在一些 Java 代码中使用内存映射文件来快速写入 2G 文件。我将整个文件映射到内存中。我的解决方案遇到的问题是，如果我正在写入的文件神秘地消失了，或者磁盘出现了某种类型的错误，那么这些错误不会冒泡到 Java 代码中。

事实上，从 Java 代码来看，我的编写似乎成功完成了。这是我为模拟此类故障而创建的单元测试：

```
File twoGigFile = new File("big.bin");
RandomAccessFile raf = new RandomAccessFile(twoGigFile, "rw");
raf.setLength(Integer.MAX_VALUE);
raf.seek(30000); // Totally arbitrary
raf.writeInt(42);
raf.writeInt(42);

MappedByteBuffer buf = raf.getChannel().map(MapMode.READ_WRITE, 0, Integer.MAX_VALUE);
buf.force();
buf.position(1000000); // Totally arbitrary
buf.putInt(0);

assertTrue(twoGigFile.delete());

buf.putInt(0);
raf.close(); 
```

此代码运行时完全没有任何错误。这对我来说是一个相当大的问题。我似乎找不到任何关于此类问题的内容。有谁知道如何让内存映射文件正确抛出异常？或者是否有另一种方法可以确保数据实际写入文件？

我试图避免使用 RandomAccessFile，因为它们比内存映射文件慢得多。但是，可能没有任何其他选择。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:26:59.667

你不能。引用 JavaDoc：

> 映射字节缓冲区的全部或部分可能随时变得不可访问 [...] 尝试访问映射字节缓冲区的不可访问区域不会更改缓冲区的内容，并且会导致在当时引发未指定的异常访问权限或稍后的某个时间。

原因如下：当您使用映射缓冲区时，您正在更改*内存*，而不是文件。在操作系统尝试将缓冲块写入磁盘之前，内存恰好由文件支持这一事实是无关紧要的，这完全由操作系统管理（即，您的应用程序不会知道它正在发生）。

如果您希望文件在您下方消失，那么您将不得不使用替代机制来查看是否会发生这种情况。一种可能性是偶尔使用 a 触摸文件`RandomAccessFile`，并捕获它将抛出的错误。根据您的操作系统，即使这样也可能还不够：例如，在 Linux 上，对于那些具有打开句柄的程序存在一个文件，即使该文件已从外部删除。

# iphone - 多个XIB的同一个视图

> ID：12610611
> 
> 赞同：0
> 
> 时间：2012-09-26T21:21:33.267
> 
> 标签：iphone, objective-c, ios, xcode

我想知道是否可以同时在 iPhone 屏幕上显示多个 XIB。所以用户可以像那样从一个视图切换到另一个视图。

主要是我希望能够做的事情，比如当前的 Facebook 和 YouTube 应用程序。

因为目前我的应用程序中有很多视图（一个多合一计算器），但我希望它们能够更流畅地交互。（也许从屏幕边缘滑动手指以转到以前使用的计算器。或者从顶部向下滑动以查看列表中的所有计算器。希望向下滑动的内容是另一个视图。

希望你明白我想做什么，如果有人能指出我正确的方向，那就太好了。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:43:36.383

您所要做的就是将您的第二个 xib 实例化为您的第一个视图控制器中的视图控制器。从那里您可以简单地将第二个的视图属性添加为第一个的子视图。这有点拗口：

```
UIViewController *mySecondXibsViewController = [[UIViewController alloc] initWithNibName:@"secondXib" bundle:[NSBundle mainBundle]];
[mySecondXibsViewController.view setFrame:someCGRect];
[self.view addSubview:mySecondXibsViewController.view]; 
```

或者，如果您要使用情节提要，它看起来像这样：

```
UIViewController *mySecondXibsViewController = [self.storyboard instantiateViewControllerWithIdentifier:@"someID"]; 
```

# c# - c# - 如何拆分字符串

> ID：12610618
> 
> 赞同：1
> 
> 时间：2012-09-26T21:21:46.270
> 
> 标签：c#, asp.net, vb.net, visual-studio

> **可能重复：**
> [如何拆分保留整个单词的字符串？](https://stackoverflow.com/questions/4398270/how-to-split-string-preserving-whole-words)

我有以下字符串：

```
string s = "The Electors shall meet in their respective states to vote by ballot for President and Vice-President."; 
```

我想取前 60 个字符并将它们分成两个单独的字符串，每个字符串不超过 30 个字符。每个字符串必须以整个单词开头（没有部分单词，也没有空格）。所以这是期望的结果：

```
string s1 = "The Electors shall meet in"; // 26 characters
string s2 = "their respective states to vot"; // 30 characters 
```

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:26:47.347

也许尝试计算中点，然后在两个方向上工作，直到找到一个空间。那将是你的分裂点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:31:26.450

```
string s = "The Electors shall meet in their respective states to vote by ballot for President and Vice-President.";

string sSub = s.Substring(0,60);  //first 60 letters

string sSubSub = sSub.Substring(0,30);  //at most 30 per string

int index = sSubSub.LastIndexOf(' '); //finds the last space

string firstString = sSub.Substring(0,index); //first string is up until that space of t he 60-letter string

string secondSTring = sSub.Substring(index + 1, 30); //second string is the first 30 letters of the rest of the 60-letter string 
```

# python - 将 for 循环转换为 while 循环

> ID：12610623
> 
> 赞同：1
> 
> 时间：2012-09-26T21:22:08.097
> 
> 标签：python, python-3.x

我是 Python 新手，我需要将`for`循环转换为`while`循环，但我不知道该怎么做。这就是我正在使用的：

```
def scrollList(myList):
      negativeIndices = []
      for i in range(0,len(myList)):
            if myList[i] < 0:
                 negativeIndices.append(i)
      return negativeIndices 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T22:02:18.233

这里的问题不是你需要一个while循环，而是你应该正确使用python for循环。for 循环会导致集合的迭代，就您的代码而言，是整数序列。

```
for n, val in enumerate(mylist):
    if val < 0: negativeindices.append(n) 
```

`enumerate`是一个内建函数，它生成一系列的形式对`(index, value)`。

您甚至可以通过以下方式以功能样式执行此操作：

```
[n for n, val in enumerate(mylist) if val < 0] 
```

对于此类任务，这是更常见的 python 习惯用法。它的优点是您甚至不需要创建显式函数，因此该逻辑可以保持内联。

如果您坚持使用 while 循环来执行此操作，那么这里有一个利用 python 的迭代工具（您会注意到它本质上是上述的手动版本，但是嘿，情况总是如此，因为这就是for 循环是 for)。：

```
data = enumerate(list)
try:
    while True:
        n, val = next(data)
        if val < 0: negativeindices.append(n)
except StopIteration:
    return negativeindices 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T21:55:21.017

[第一个答案](https://stackoverflow.com/a/12610706/771837)是直截了当的方法，如果您对增加索引变量过敏，还有另一种方法：

```
def scrollList(myList):
  negativeIndices = []
  indices = range(0,len(myList)):
  while indices:
        i = indices.pop();
        if myList[i] < 0:
             negativeIndices.append(i)
  return negativeIndices 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:27:49.277

像这样：

```
def scrollList(myList):
      negativeIndices = []
      i = 0
      while i < len(myList):
            if myList[i] < 0:
                 negativeIndices.append(i)
            i += 1
      return negativeIndices 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-09-26T21:28:39.313

```
def scrollList(myList):
      negativeIndices = []
      while myList:
          num = myList.pop()
          if num < 0:
             negativeIndices.append(num)
      return negativeIndices 
```

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2012-09-26T21:28:42.847

只需为循环设置一个变量并增加它。

```
int i = 0;
while(i<len(myList)):
    if myList[i] < 0:
        negativeIndices.append(i)
    i++;

return negativeIndices 
```

# jquery - 选中复选框1时jQuery选中复选框2

> ID：12610628
> 
> 赞同：0
> 
> 时间：2012-09-26T21:22:38.563
> 
> 标签：jquery, ruby-on-rails

我有一个活动复选框和一个突出显示复选框。

![在此处输入图像描述](../Images/59b54ce1178ba12dd2acdddfc5d781cc.png)

我希望活动复选框在选中活动时自动选中突出显示复选框。我对是否探索[prop()](http://api.jquery.com/prop/)或做一个添加属性的丑陋绑定持反对态度。

我最终正在寻找最干燥的推荐，当然任何代码片段都非常受欢迎！！！

有点烦**人**，因为每个复选框（尽管在表格中彼此相邻的是它们自己的表单，它是在更改时使用 ajax 提交的。

```
 <td>
  <% form_for(:catalog_item, catalog_item.item, :url => set_admin_catalog_item_path(catalog_item), :html => {:class => 'ajax'}) do |f| %>
    <%= f.check_box :active %>
  <% end %>
</td>
<td>
  <% form_for(:catalog_item, catalog_item, :url => set_admin_catalog_item_path(catalog_item), :html => {:class => 'ajax'}) do |f| %>
  <%= f.check_box :highlight %>
  <% end %>
</td> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:28:32.880

检查这个[小提琴](http://jsfiddle.net/sushanth009/XBfVb/1/)

```
$(function() {
    $('.active').on('click', function(){
        $(this).next().attr('checked' , $(this).is(':checked'));
    });

});​ 
```

也可以使用

```
$(this).next().prop('checked' , $(this).is(':checked')); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:41:43.233

[jsFiddle](http://jsfiddle.net/SpYk3/6WwLF/)

给定 HTML 如下：

> **HTML**

```
<div id="ActHigh">
    <table>
        <thead>
            <tr>
                <th>
                    <p>
                        Active
                    </p>
                </th>
                <th>
                    <p>
                        Highlight
                    </p>
                </th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>
                    <input type="checkbox" name="act01" class="chk-active" />
                </td>
                <td>
                    <input type="checkbox" name="hig01" class="chk-highlight" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="checkbox" name="act02" class="chk-active" />
                </td>
                <td>
                    <input type="checkbox" name="hig02" class="chk-highlight" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="checkbox" name="act03" class="chk-active" />
                </td>
                <td>
                    <input type="checkbox" name="hig03" class="chk-highlight" />
                </td>
            </tr>
        </tbody>
    </table>
</div> 
```

你可以像这样使用 jQuery：

> **脚本**

```
<script type="text/javascript">
    $(function() {
        //  This will file through all "active" type checkboxes
        $("#ActHigh .chk-active").each(function(i){ //  Keep in mind, this refernce relys on active and highlight chkboxes being one right after the other in html
            $(this).change(function(e) {//  this tells us to do something on the current checkbox when it is checked, via mouse or keyboard
                //  this looks for the "highlight" checkbox with the same INDEX as the currently changed "active" checkbox
                $("#ActHigh .chk-highlight").filter(function(ii){ return ii == i; }).prop("checked", $(this).prop("checked"));  
            });
        });
    })
</script> 
```

# php - 如何创建一个下拉框以显示最小数量。是 1 并且最大值由变量设置？(PHP)

> ID：12610630
> 
> 赞同：0
> 
> 时间：2012-09-26T21:22:42.417
> 
> 标签：php, e-commerce

想知道是否有人知道这是否可能。

对于电子商务网站，允许的最大数量有一个变量，我们只说它的 $maxqty。

在结帐页面上，我们有一个数量输入框。我们想将其更改为下拉框，但每个项目都有不同的限制 ($maxqty)。

有没有办法创建一个最小值为 1、最大值为 $maxqty 的下拉框。

具体示例：商品 #1，最大数量 = 5 商品 #1 在结帐框，数量下拉菜单将显示 1、2、3、4、5 的选项

谢谢阅读！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:26:14.100

[html 中的select](http://www.w3schools.com/tags/tag_select.asp)标签用于创建下拉列表，在结帐/提交表单时，它将为您提供 php.ini 中的选定值。

例子：

```
 <select>
    <?php
   for($i=1;$i<=5;$i++)  {
    echo "<option value='$i'>$i</option>";
   } ?>
  </select> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:29:53.773

假设您从查询字符串中获得最大值。也可以通过其他方式分配

```
<?php

  $maxQty = (int) $_GET['max_qty'];

?>

<select name="quantity">

<?php

 for($i=1; $i<=$maxQty; $i++)
   echo "<option value='$i'>$i</option>";

?>

</select> 
```

输出

```
<select name="quantity">
   <option value='1'>1</option>
   <option value='2'>2</option>
   <option value='3'>3</option>
   <option value='4'>4</option>
</select> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:30:47.327

这在很大程度上取决于您的设置，这就是您的表单元素的生成方式。您可以通过 for 循环生成选择选项

```
<select name="quantity>
    <?php for($i=1;$i<=$maxqty;$i++) {?>
    <option value="<?php echo $i;?>"><?php echo $i;?></option>
    <? } ?>
</select> 
```

请注意，在您的 html 代码中混用 php 通常是不明智的，最好将其分开

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:28:24.020

应该很容易，您可以将最大数量放在一个变量中，然后从 1 循环到该最大数量，每次都创建一个选项，例如

```
<? php
   for($i=1;$i<=$item_max;$i++)
   {
?>
    <option value="<?php echo $i;?>"><?php echo $i;?></option>
<?php
    }
?> 
```

# .htaccess - 如何使用查询字符串进行 htaccess 301 重定向？

> ID：12610634
> 
> 赞同：1
> 
> 时间：2012-09-26T21:23:18.497
> 
> 标签：.htaccess, mod-rewrite, redirect, query-string, http-status-code-301

我有一些需要重定向的链接，例如：

```
/pass-help.php?action=1&email=test@test.com to /about/help
or
/contests/contest-a?testa=1&testb=1 /user/index/contest 
```

我需要一种方法来在上面的链接中找到 the`action`或 the `email`，因为它们可以是任何东西。

也许像 /pass-help.php?action= `(\?.+)`&email=`(\?.+)`到 /about/help

但我不确定如何编写查询字符串。

有任何想法吗？

如果是这样，请解释一下，以便我了解发生了什么。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:48:03.033

如果查询字符串无关紧要，您可以忽略它们：

通过 mod_alias：

```
Redirect 301 /pass-help.php /about/help?
Redirect 301 /contests/contest-a /user/index/contest? 
```

通过 mod_rewrite：

```
RewriteRule ^/?pass-help\.php$ /about/help? [L,R=301]
RewriteRule ^/?contests/contest-a /user/index/contest? [L,R=301] 
```

请注意，在 mod_alias 的情况下，最后会有一个 stary `?`。为了摆脱查询字符串，这是必需的。

如果查询字符串需要一些参数名称，但您不关心这些值：

通过 mod_rewrite：

```
RewriteCond %{QUERY_STRING} (^|&)action=
RewriteCond %{QUERY)STRING{ (^|&)email=
RewriteRule ^/?pass-help\.php$ /about/help? [L,R=301]

RewriteCond %{QUERY_STRING} (^|&)testa=
RewriteCond %{QUERY_STRING} (^|&)testb=
RewriteRule ^/?contests/contest-a /user/index/contest? [L,R=301] 
```

如果查询字符串需要一些参数名称，并带有一些值：

```
RewriteCond %{QUERY_STRING} (^|&)action=1
RewriteCond %{QUERY)STRING{ (^|&)email=test@test.com
RewriteRule ^/?pass-help\.php$ /about/help? [L,R=301]

RewriteCond %{QUERY_STRING} (^|&)testa=1
RewriteCond %{QUERY_STRING} (^|&)testb=1
RewriteRule ^/?contests/contest-a /user/index/contest? [L,R=301] 
```

# python - nltk 标记一个 175 mb 的文件

> ID：12610637
> 
> 赞同：0
> 
> 时间：2012-09-26T21:23:23.663
> 
> 标签：python, nlp, nltk

nltk 是否有一些用于写出标记化文本的序列化格式？我有一个 175mb 的文本文件，将它放入`nltk.Text`对象需要 4 分钟（在 macbook 视网膜上 - 即最先进的处理器、8 gigs 的内存和 SSD）。从磁盘加载原始文件几乎是瞬间的。

完成这项工作的功能如下：

```
def _load_all_text(self):
    if not self._text_loaded:
        file = open("all_posts","r")
        self._text = file.read()
        self._text_loaded = True

def nltk_text(self):
    self._load_all_text()
    return nltk.Text(nltk.word_tokenize(self._text)) 
```

我不敢相信它需要 4 分钟才能完成，我猜这是因为 nltk 建立在 Python 垃圾收集器和列表对象之上。我对酸洗了解不多，酸洗列表会起作用吗（即，有问题的列表是 的结果`word_tokenise`）？

# c# - 根据 XML 中给定的子 id 获取根节点 id

> ID：12610639
> 
> 赞同：1
> 
> 时间：2012-09-26T21:23:37.237
> 
> 标签：c#, asp.net, xml

这是我的 XML 结构：

```
<DirectoryNode Id="297fe1ac-ff9b-4c40-ada4-86dc713a9537" Title="Root">
   <DirectoryNode Id="80e01248-1170-4393-a327-b97409d51159" Title="A">
      <DirectoryNode Id="e6db6d3f-be30-4cdf-b79e-864cc9b52c5f" Title="A1">
         <DirectoryNode Id="4368d898-6fb0-4e2f-ba56-edbaf4bd0077" Title="A11" />
      </DirectoryNode>
      <DirectoryNode Id="11c5336b-462e-45dc-b4d3-92032ebc3ae3" Title="A2" />
   </DirectoryNode>
   <DirectoryNode Id="b983fd39-fc2e-43e0-80e6-3808fb47f995" Title="B">
      <DirectoryNode Id="433851d6-9935-4adb-9acb-7055c26e85cb" Title="B1">
         <DirectoryNode Id="f2602aed-6d97-4e46-9e8a-fb181b28f0c8" Title="B11" />
      </DirectoryNode>
   </DirectoryNode>
   <DirectoryNode Id="9144d8cf-93c0-4de6-9109-448d396a9e17" Title="C" />
   <DirectoryNode Id="182491af-452e-40bc-b51e-59f078db3ad3" Title="D" />
</DirectoryNode> 
```

我要做的是在给定目录节点 ID 的情况下获取根节点（不是主根节点）ID。这里有一些例子：

1.  给定 A11 的 ID，我想要 A 的 ID
2.  给定 A2 的 ID，我想要 A 的 ID
3.  给定 A 的 ID，我想要 A 的 ID
4.  给定 B1 的 ID，我想要 B 的 ID

在解析 xml 和提取值时，我很糟糕——有人知道快速的方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:26:53.243

听起来你可以使用类似的东西：

```
XDocument doc = XDocument.Parse("nodes.xml");
XElement node = doc.Descendants("DirectoryNode")
                   .Where(n => (string) n.Attribute("Id") == id)
                   .Single();

// Now go up until we find the highest node beneatht the document root node
while (node.Parent != doc.Root)
{
    node = node.Parent;
} 
```

请注意，如果可能有多个节点具有相同的 ID，或者该 ID 可能根本不存在，则您必须更改您的查询。例如，如果您只关心第一个匹配项，但可能没有匹配项，您可以更改`Single`为`FirstOrDefault()`然后使用（在`while`循环之前）：

```
if (node == null)
{
    // No matches. Take appropriate action here.
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T00:00:58.640

这是一种递归的方法。

```
using System;
using System.Linq;
using System.Xml.Linq;

namespace Test
{
    class Program
    {
        static void Main(string[] args)
        {
            string sampleXml =  @"<DirectoryNode Id=""297fe1ac-ff9b-4c40-ada4-86dc713a9537"" Title=""Root"">" + Environment.NewLine +
                                @"   <DirectoryNode Id=""80e01248-1170-4393-a327-b97409d51159"" Title=""A"">" + Environment.NewLine +
                                @"      <DirectoryNode Id=""e6db6d3f-be30-4cdf-b79e-864cc9b52c5f"" Title=""A1"">" + Environment.NewLine +
                                @"         <DirectoryNode Id=""4368d898-6fb0-4e2f-ba56-edbaf4bd0077"" Title=""A11"" />" + Environment.NewLine +
                                @"      </DirectoryNode>" + Environment.NewLine +
                                @"      <DirectoryNode Id=""11c5336b-462e-45dc-b4d3-92032ebc3ae3"" Title=""A2"" />" + Environment.NewLine +
                                @"   </DirectoryNode>" + Environment.NewLine +
                                @"   <DirectoryNode Id=""b983fd39-fc2e-43e0-80e6-3808fb47f995"" Title=""B"">" + Environment.NewLine +
                                @"      <DirectoryNode Id=""433851d6-9935-4adb-9acb-7055c26e85cb"" Title=""B1"">" + Environment.NewLine +
                                @"         <DirectoryNode Id=""f2602aed-6d97-4e46-9e8a-fb181b28f0c8"" Title=""B11"" />" + Environment.NewLine +
                                @"      </DirectoryNode>" + Environment.NewLine +
                                @"   </DirectoryNode>" + Environment.NewLine +
                                @"   <DirectoryNode Id=""9144d8cf-93c0-4de6-9109-448d396a9e17"" Title=""C"" />" + Environment.NewLine +
                                @"   <DirectoryNode Id=""182491af-452e-40bc-b51e-59f078db3ad3"" Title=""D"" />" + Environment.NewLine +
                                @"</DirectoryNode>" + Environment.NewLine +
                                @"";

            XDocument document = XDocument.Parse(sampleXml);

            //    Given A11's Id, I want A's Id
            XElement parentDirectory = GetParentDirectory(document.Descendants("DirectoryNode").Single(element => (string) element.Attribute("Title") == "A11"));
            Console.WriteLine(parentDirectory.Attribute("Title").Value);

            //    Given A2's Id, I want A's Id
            parentDirectory = GetParentDirectory(document.Descendants("DirectoryNode").Single(element => (string)element.Attribute("Title") == "A2"));
            Console.WriteLine(parentDirectory.Attribute("Title").Value);

            //    Given A's Id, I want A's Id
            parentDirectory = GetParentDirectory(document.Descendants("DirectoryNode").Single(element => (string)element.Attribute("Title") == "A"));
            Console.WriteLine(parentDirectory.Attribute("Title").Value);

            //    Given B1's Id, I want B's Id
            parentDirectory = GetParentDirectory(document.Descendants("DirectoryNode").Single(element => (string)element.Attribute("Title") == "B1"));
            Console.WriteLine(parentDirectory.Attribute("Title").Value);

            Console.ReadLine();
        }

        public static XElement GetParentDirectory(XElement element)
        {
            if (element.Parent == element.Document.Root)
                return element;

            return GetParentDirectory(element.Parent);
        }
    }
} 
```

# javascript - 从 Delphi WebBrowser 扩展 obout.com ASP.NET TreeView

> ID：12610641
> 
> 赞同：1
> 
> 时间：2012-09-26T21:23:37.763
> 
> 标签：javascript, asp.net, delphi, browser

我有一个使用这个树视图组件的网站：

[http://www.obout.com/t2/ex_expand_levels.aspx](http://www.obout.com/t2/ex_expand_levels.aspx)

我需要展开树视图的所有节点。我没有按钮（也没有功能），只有树视图本身。（请在下面找到代码示例）

我已加载页面并能够将 JavaScript 发送到网站，但无法模拟单击“+”符号以展开节点。我有几个。

如果可能的话，我真的很想在 Delphi 中看到一个简单的示例代码。

我用来执行 Javascript 的 Delphi 代码如下：

我的表单有一个 WebBrowser、一个编辑和一个按钮：

```
uses MSHTML;

procedure TForm1.ButtonJSButtonClick(Sender: TObject);
  { Make browser exec JS }
var
  Doc: IHTMLDocument2;      // current HTML document
  HTMLWindow: IHTMLWindow2; // parent window of current HTML document
  JSFn: string;             // stores JavaScipt function call
begin

  // Get reference to current document
  Doc := WebBrowser1.Document as IHTMLDocument2;
  if not Assigned(Doc) then
    Exit;
  // Get parent window of current document
  HTMLWindow := Doc.parentWindow;
  if not Assigned(HTMLWindow) then
    Exit;
  // Run JavaScript
  try
    JSFn := Edit1.Text;
    HTMLWindow.execScript(JSFn, 'JavaScript');
  except
    // handle exception in case JavaScript fails to run
    ShowMessage('Error running JavaScript |'+Edit1.Text+'|');
  end;
end; 
```

提前致谢，

佐尔特

JavaScript：

```
<!--   ASP TreeView component   http://www.obout.com   -->

<LINK REL=stylesheet HREF="/_tree/treeStyle_Explorer/obout_treeview.css" > 
<SCRIPT LANGUAGE="JavaScript">
<!--
var op2, ob_tb, ob_url, selected_node_id;
function ob_wk(os, url) {
    var ot = os.parentNode.nextSibling.firstChild.nextSibling;
    var lensrc = (os.src.length - 8);
    var s = os.src.substr(lensrc, 8);
    if (s == "inus.gif") {
        ot.style.display = "none";
        os.src = "/_tree/treeStyle_Explorer/plusik.gif";
    }
    if (s == "usik.gif") {
        ot.style.display = "block";
        os.src = "/_tree/treeStyle_Explorer/minus.gif";
    if (url != "") {
        var s = os.parentNode.nextSibling.firstChild.nextSibling.innerText;
        if (s != "Loading ...") {
            return;
        }
        ob_url = url;
        ob_tb = os;
        window.setTimeout("ob_tm()", 100);
    }
    }
}

function ob_tm() {
    var xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
    xmlhttp.open("GET", ob_url, false);
    xmlhttp.send("");
    ob_tb.parentNode.nextSibling.firstChild.nextSibling.outerHTML = xmlhttp.responseText;
}

function ob_ft(e) {
    if (e.tagName == "TABLE" && e.className == "ob_zz") {
        if (typeof op2 != "undefined") {
            op2.style.backgroundColor = "transparent";
            op2.style.border = "0px solid #999999";
            op2.style.margin = "1px";
        }
        e.style.backgroundColor = "#E6E6E6";
        e.style.border = "0px solid #aaceeb";
        e.style.margin = "0px";
        op2 = e;
        selected_node_id = e.children(0).children(0).children(1).id;
    }
    else {
        ob_ft(e.parentNode);
    }
}

function ob_os(e){
    var os = e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children(0).children(0);
    if (os != null) {
    if ((typeof os != "undefined") && (os.tagName == "IMG")) {
        var lensrc = (os.src.length - 8);
        var s = os.src.substr(lensrc, 8);
        if ((s == "inus.gif") || (s == "usik.gif")) {
            e.parentNode.parentNode.parentNode.parentNode.parentNode.parentNode.children(0).children(0).click();
        }
    }
    else {
        ob_os(e.parentNode);
    }
}}

//-->
</SCRIPT>

<!--   ASP TreeView component   http://www.obout.com   -->

<div id="divTree" name="divTree" style="background:;background-image: url('');overflow-X:auto; overflow-Y:auto; width:; height:;"><table cellspacing=0 cellpadding=0 border=0 style="display:block;"><tr><td width=1 class=ob_ic><img class=ob_ic src='/_tree/treeStyle_Explorer/minus.gif' onclick="ob_wk(this, '')"></td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpGlobe.gif'></td><td id=a0 onclick='ob_ft(this)' class=ob_td>Root</td></tr></table><table cellspacing=0 cellpadding=0 border=0 style="display:block;"><tr><td width=1 class=ob_ic><img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick="ob_wk(this, '')"></td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/folder.gif'></td><td id=b1 onclick='ob_ft(this)' class=ob_td><SPAN onclick='ob_os(this)'>TREE</SPAN></td></tr></table><table cellspacing=0 cellpadding=0 border=0 style="display:none;"><tr><td width=1 class=ob_ic><img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick="ob_wk(this, '')"></td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpHome.gif'></td><td id=c1 onclick='ob_ft(this)' class=ob_td><SPAN onclick='ob_os(this)'>Site1</SPAN></td></tr></table><table cellspacing=0 cellpadding=0 border=0 style="display:none;"><tr><td width=1 class=ob_ic>&nbsp;</td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpPanel.gif'></td><td id=d1 onclick='ob_ft(this)' class=ob_td><input type=checkbox name=sIteID value=1_DD32B129-527A-42FA-A0D0-FE3C0ED65BC5><STRONG>Site1>Unit1</STRONG><input type=hidden name=sup_ value={DD32B129-527A-42FA-A0D0-FE3C0ED65BC5}></td><td align=right></td></tr></table></td></tr></table></td></tr><tr><td width=1 class=ob_ic><img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick="ob_wk(this, '')"></td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpHome.gif'></td><td id=c2 onclick='ob_ft(this)' class=ob_td><SPAN onclick='ob_os(this)'>Site2</SPAN></td></tr></table><table cellspacing=0 cellpadding=0 border=0 style="display:none;"><tr><td width=1 class=ob_ic>&nbsp;</td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpPanel.gif'></td><td id=d2 onclick='ob_ft(this)' class=ob_td><input type=checkbox name=sIteID value=2_E6DC2021-F8E9-4FBE-93F5-79C953FA7BA8><STRONG>Site2>Unit2</STRONG><input type=hidden name=sup_ value={E6DC2021-F8E9-4FBE-93F5-79C953FA7BA8}></td><td align=right></td></tr></table></td></tr></table></td></tr><tr><td width=1 class=ob_ic><img class=ob_ic src='/_tree/treeStyle_Explorer/plusik.gif' onclick="ob_wk(this, '')"></td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpHome.gif'></td><td id=c3 onclick='ob_ft(this)' class=ob_td><SPAN onclick='ob_os(this)'>Site3</SPAN></td></tr></table><table cellspacing=0 cellpadding=0 border=0 style="display:none;"><tr><td width=1 class=ob_ic>&nbsp;</td><td><table cellspacing=0 cellpadding=0 border=0 class=ob_zz><tr><td width=1 class=ob_ic><img width=16 class=ob_ic src='/_tree/xpPanel.gif'></td><td id=d3 onclick='ob_ft(this)' class=ob_td><input type=checkbox name=sIteID value=3_01B94E4C-A21A-4C76-920E-C2B9773CE2B8><STRONG>Site3>Unit3</STRONG><input type=hidden name=sup_ value={01B94E4C-A21A-4C76-920E-C2B9773CE2B8}></td><td align=right></td></tr></table></td></tr></table></td></tr></table></td></tr></table></td></tr></table></div>
<SCRIPT LANGUAGE="JavaScript"><!--
ob_ft(b1);
 //--></script>

<!--   ASP TreeView component   http://www.obout.com   --> 
```

# objective-c - 以编程方式检测对象层次结构中的保留周期的策略可能是什么？

> ID：12610644
> 
> 赞同：4
> 
> 时间：2012-09-26T21:23:47.550
> 
> 标签：objective-c, memory-leaks, automatic-ref-counting, retaincount, retain-cycle

我正在编写一个支持 ARC 的框架，它创建对象层次结构，与 Cocoa 的视图层次结构不同。每个控制器对象可以有多个子控制器。控制器可能相互引用，这会带来创建保留周期的潜在风险。

**我知道如何避免保留周期。我想知道是否有办法以编程方式检测存在保留周期并防止对象释放？**

在某个时候，现有的根控制器将被新的根控制器取代。由于我使用的是 ARC，因此无法使用 retainCount 检查现有控制器的保留计数。从我读过的内容来看，无论如何都不值得信任。

我有一个测试设置，其中根控制器有两个子控制器，每个子控制器都对另一个有很强的引用。在这种情况下，根控制器不会运行 dealloc，当根控制器被新控制器替换时，其他两个控制器也不会运行。正如预期的那样。我在想，在这种情况下，我应该有某种方法来确定该根控制器是否确实解除分配。

**可能的解决方案：**在替换控制器之前不久，我确实将要替换的根控制器分配给全局对象上的归零弱属性。然后我设置了一个计时器，以便在几分之一秒后检查该属性是否为零。如果它为零，则控制器确实解除了分配。如果它不是 nil，它可能表示内存泄漏可能是由层次结构中某处的保留周期引起的。在这种情况下，只要替换的控制器不为零，我就会打印一条日志语句以引起开发人员的注意。

这行得通，但是有没有其他（更好的）解决方案？或者这个解决方案可能需要注意什么？

具体来说，在对象解除分配之前可以经过多长时间 - 这是否保证是瞬时的，或者可以延迟解除分配，如果可以，持续多长时间？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T09:24:01.487

> 我正在编写一个支持 ARC 的框架，它创建对象的层次结构，与 Cocoa 的视图层次结构不同……</p>

停在那儿。只需将这种关系引入您的层次结构。视图有父视图、子视图等——考虑它们如何交互并使彼此保持适当的长度。教你的对象他们需要的关系，并教他们如何清理自己。简化：

```
- (void)tearDownState
{
  if (self.isTearingDown)
    return;

  [self setTearingDown];
  for (Node * at in self.subnodes) {
    [at tearDownState];
  }
  self.subnodes = 0;
  ... 
```

然后，如果您还需要交换节点（例如您的根），请教他们交换节点。

# javascript - 页面更新时如何播放声音

> ID：12610646
> 
> 赞同：0
> 
> 时间：2012-09-26T21:23:52.213
> 
> 标签：javascript, audio

当网页大小发生变化时甚至可以播放声音。我将每天在此页面上添加新文本。如果用户刷新页面，我只想在页面字节发生变化时播放声音。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:27:10.543

有点。如果您在页面上设置 cookie 以跟踪用户最后一次请求页面的日期时间（或当时的文件大小）并向页面添加更新日期时间，您可以比较自用户上次访问以来页面是否已更新并触发一个事件。

这里的关键是页面本身不知道它曾经有多大，但是如果您可以将该信息存储在 cookie 中，您就可以检测到更改。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:26:14.427

也许你正在做的事情太多了，但它是我所知道的最好的音频库：[http ://createjs.com/#!/SoundJS](http://createjs.com/#!/SoundJS)

# c# - 如何从 C# 在 ruby 中解密这个 RijandelManaged？

> ID：12610647
> 
> 赞同：2
> 
> 时间：2012-09-26T21:24:01.277
> 
> 标签：c#, ruby, rijndaelmanaged

```
 static byte[] keyBytes = new byte[] { 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
                                              1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
                                              1, 1, 1, 1, 1, 1, 1, 1
                                            };
    static byte[] iv = new byte[] { 1, 1, 1, 1 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1 };

    static SymmetricAlgorithm getKey()
    {
        RijndaelManaged key = new RijndaelManaged();
        key.Key = keyBytes;
        key.IV = iv;
        return key;
    }

    static string Encrypt(string PlainText)
    {
        SymmetricAlgorithm key = getKey();
        MemoryStream ms = new MemoryStream();
        CryptoStream encStream = new CryptoStream(ms, key.CreateEncryptor(), CryptoStreamMode.Write);
        StreamWriter sw = new StreamWriter(encStream);
        sw.WriteLine(PlainText);
        sw.Close();
        encStream.Close();
        byte[] buffer = ms.ToArray();
        ms.Close();
        return Convert.ToBase64String(buffer);
    }

    static string Decrypt(string encrypted)
    {
        SymmetricAlgorithm key = getKey();
        byte[] CypherText = Convert.FromBase64String(encrypted);
        MemoryStream ms = new MemoryStream(CypherText);
        CryptoStream encStream = new CryptoStream(ms, key.CreateDecryptor(), CryptoStreamMode.Read);
        StreamReader sr = new StreamReader(encStream);
        string val = sr.ReadLine();
        sr.Close();
        encStream.Close();
        ms.Close();
        return val;
    } 
```

显然 key 和 iv 已被更改为全“一”以保护有罪者。

我在这里尝试了其他几篇 SO 文章，但无济于事。

我想我会继续展示我正在尝试使用的 ruby​​ openssl 代码：

```
def Crypt.decrypt(encrypted_data, key, iv, cipher_type)
    aes = OpenSSL::Cipher::Cipher.new(cipher_type)
    aes.decrypt
    #aes.padding = 1
    aes.key = key
    aes.iv = iv if iv != nil
    aes.update(encrypted_data) + aes.final  
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:16:28.317

Ruby 的 OpenSSL 模块似乎默认使用 PKCS5 类型填充（[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/Cipher.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/Cipher.html)）。但是 Microsoft Rj-Managed 默认使用 PKCS7。Ruby 模块支持 PKCS7，因此您可能只想坚持使用它（[http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/PKCS7.html](http://www.ruby-doc.org/stdlib-1.9.3/libdoc/openssl/rdoc/OpenSSL/PKCS7.html)）。就个人而言，由于加密如此挑剔，我喜欢手动设置每个选项而不是默认设置，即使我使用默认设置只是为了确保它们在两端都相同。我以前用 C#/PHP 做过这个，看看我的帖子是否有帮助（[C# Encryption to PHP Decryption](https://stackoverflow.com/questions/11873878/c-sharp-encryption-to-php-decryption)）我完成的解决方案被发布为第二个答案。

# php - 在mysql中的2个范围之间选择使用LIKE

> ID：12610651
> 
> 赞同：0
> 
> 时间：2012-09-26T21:24:21.980
> 
> 标签：php, mysql, between, sql-like

我正在尝试从 2 个不同日期之间的数据库表中获取所有值。问题是我的日期列包含格式为“MM/DD/YYYY HH:MM”的字符串形式的日期（即 9/13/2012 13:15、10/14/2012 22:32、11/8/2012 12 ：10等）。我可以使用 SELECT 和 LIKE 查询自行获取包含传入的任何日期字符串的所有行，但我需要选择一定范围内的所有行（如 2012 年 9 月 13 日和 9 日之间） 15/2012）。我是否需要转换为日期格式才能完成这项工作？

这是通过输入一个日期工作的代码：

```
$result=mysql_query("SELECT * FROM data WHERE data_time RLIKE '^$date_range1'"); 
```

但我需要在 2 个日期之间进行选择。我试过这个但它不起作用：

```
$result=mysql_query("SELECT * FROM data WHERE data_time RLIKE BETWEEN '^$date_range1%' and '^$date_range2%"); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:26:07.487

是的，您需要将日期转换为`date`or`datetime`类型。

否则排序将不起作用：作为文本，“11/02/2012”在“12/03/1901”之前，因为“11”小于“12”。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-26T21:41:07.893

### 1\. 将您的字段 date_time 转换为 DATETIME 类型！

`data_time_copy`在表中创建新字段`data`，然后运行下一个查询：

```
# field d is alias for your date_time
UPDATE data
SET date_time_copy = CONCAT(
                         SUBSTRING(d,7,4), '-', SUBSTRING(d,1,2), '-', SUBSTRING(d,4,2), 
                         ' ', SUBSTRING(d,12,5), ':00'
                     ) 
```

然后删除您的字段`date_time`，并重命名`date_time_copy`为`date_time`. 并修复您的代码。

### 2.如果不能将字段类型更改为 DATETIME，请使用这种蹩脚的解决方案（矫枉过正）

```
# field d is alias for your date_time
SELECT *
FROM data
WHERE 
    CONCAT(SUBSTRING(d,7,4), '-', SUBSTRING(d,1,2), '-', SUBSTRING(d,4,2)) 
    BETWEEN '2012-09-13' AND '2013-09-15' 
```

# c# - Windows 8 应用商店应用中异步方法的进度报告

> ID：12610652
> 
> 赞同：1
> 
> 时间：2012-09-26T21:24:23.620
> 
> 标签：c#, windows-8, progress-bar, winrt-xaml, async-await

在 Windows 8 Style 应用程序中，我有以下代码检索自定义 FileService 中的文件列表。这是在 ViewModel 的构造函数中触发的。

```
private async void Construct()
{
   Files = new ObservableCollection<FileViewModel>();
   IList _files = await _fileRepository.GetFiles();
   foreach (File file in _files)
   {
      Files.Add(new FileViewModel(file));
   }
} 
```

它工作得很好，但我正在努力弄清楚我将如何对此执行进度报告以通知用户在加载文件时正在发生某些事情。

看着它，我想要一个 bool IsBusy 属性，我可以将它绑定到 View 上的 ProgressRing 之类的东西上。我知道我可以在进程开始时将此设置为 true，但是如何从操作中获取 Completed 回调，然后我可以将此属性设置为 False？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:12:07.883

首先，我认为您不应该使用`async void`方法（当然，除非它们是事件处理程序）。“异步构造函数”最好实现为静态`async`工厂方法或[异步延迟初始化](http://nitoprograms.blogspot.com/2012/08/asynchronous-lazy-initialization.html)（在我的博客中解释）。这两种方法都比`async void`.

现在，关于进度报告。基于[任务的异步编程](http://www.microsoft.com/download/en/details.aspx?id=19957)文档描述了报告进度的推荐方式，我的[AsyncEx](http://nitoasyncex.codeplex.com/)库包含一个`IProgress<T>`专门`PropertyProgress`用于将进度更新视为 ViewModel 可观察属性的实现。

但是，听起来您只需要一个“忙碌指示器”，而不是完整的“进度报告”。这有点简单：

```
private async Task Construct()
{
  Files = new ObservableCollection<FileViewModel>();
  IsBusy = true;
  IList _files = await _fileRepository.GetFiles();
  IsBusy = false;
  foreach (File file in _files)
  {
    Files.Add(new FileViewModel(file));
  }
} 
```

在这个例子中，我假设`IsBusy`setter 会`INotifyPropertyChanged.PropertyChanged`适当地加注。

# java - GDB/MI 检测目标等待输入

> ID：12610655
> 
> 赞同：0
> 
> 时间：2012-09-26T21:24:37.517
> 
> 标签：java, c, gdb

我正在为我的 Java 项目编写 GDB 包装器。有没有办法确定 GDB 中的目标应用程序何时等待用户输入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-30T20:08:24.637

Basically you'll need to redirect standard I/O to pseudo terminals under POSIX systems. I'll outline how do to that below.

Write a separate standalone "launcher" program that:

*   [Receives a file descriptor through a unix domain socket](http://man7.org/tlpi/code/online/dist/sockets/scm_rights_recv.c.html).
*   Redirects stdin, stdout and stderr to the the file descriptor received above [through the standard fork(), dup2(), execl() sequence](http://man7.org/tlpi/code/online/diff/pty/pty_fork.c.html).

In your Java control program:

1.  [Open one pair of pseudo terminals](http://man7.org/tlpi/code/online/diff/pty/pty_master_open.c.html) (see also the pty_fork.c example linked to above)
2.  Start the launcher program. Saving its process ID in LAUNCHER_PID. The launcher would eventually block in recvmsg(), waiting to receive the new file descriptor.
3.  Execute **"set follow-fork-mode child"** in GDB
4.  Direct GDB to attach to LAUNDHER_PID
5.  [Send the slave end of the pty to the launcher program](http://man7.org/tlpi/code/online/dist/sockets/scm_rights_send.c.html). The launcher would then return from recvmsg() and go on to the fock(), dup2(), execl() sequence.

You can then detect that the program being debugged is waiting for user input by e.g. converting the master end of the pty file descriptor into a NIO Channel, set it to non blocking mode and [monitor the master pty for writing with a Selector](http://tutorials.jenkov.com/java-nio/selectors.html).

You'll need a separate code path to support Microsoft Windows.

# objective-c - 图像视图。缩放并居中到任意矩形。无法确定屏幕上的正确中心

> ID：12610660
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:25:07.313
> 
> 标签：objective-c, ios, uiview

有简单的 iPad 应用程序。视图层次结构是： Window - UIView - UIImageView UIImageView 加载的图像大于屏幕尺寸（即 1280 x 2000 对 768 x 1004）。我需要放大图像的任意矩形部分（将其放在屏幕上），然后在屏幕上居中。目前我正在放大以下方式：

```
-(IBAction)posIt:(id)sender
{
    // rectangle size and origin in image's coordinates. Its received from out of application
    CGFloat x = 550.f;
    CGFloat y = 1006.f;
    CGFloat w = 719.f;
    CGFloat h = 850.f;

    CGSize frameSize = CGSizeMake(_imgView.image.size.width, _imgView.image.size.height);
    _imgView.frame = CGRectMakeWithParts(CGPointMake(0, 0), frameSize);

    // Calculate center manually because orientation changing
    CGPoint superCenter = CGPointMake(self.view.bounds.size.width/2, self.view.bounds.size.height/2);

    // delta is the factor between size of image size and device screen
    CGFloat delta = 768.f/w;

    // resizing UIImageView to fit rectangle on the screen
    frameSize = CGSizeMake(_imgView.image.size.width * delta, _imgView.image.size.height * delta);
    _imgView.frame = CGRectMakeWithParts(CGPointMake(0, 0), frameSize);

    // Here is I'm trying to calculate center of rectangle
    _imgView.center = CGPointMake(superCenter.x + (superCenter.x - (w/2)*delta - x * delta), superCenter.y + (superCenter.y - (h/2)*delta - y * delta));
} 
```

UIImageView 的 ContentMode 参数是 AspectFit。我相信要将一个点（UIImageView 的中心）移动到另一个点（为了将矩形移动到 superView 的中心），我将使用以下公式：

*newX = oldX + oldX - rectCenterX;*

*newY = oldY + oldY - rectCenterY;*

由于 UIImageView 使用*delta*因子进行缩放，*因此 rectCenterX*和*rectCenterY*应该乘以相同的*delta*。但我错了。矩形中心从 superView 中心跳出。

是否有某种方法可以正确进行这些计算？我想念什么？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-02T22:35:21.923

我已经管理了正确和稳定的图像居中。我不是计算图像的中心，而是计算 UIImageView 的框架的原点坐标，如下所示：

```
CGPoint newOrigin = CGPointMake((-zoomRect.origin.x * delta) + superCenter.x - (zoomRect.size.width / 2) * delta, 
                                (-zoomRect.origin.y * delta) + superCenter.y - (zoomRect.size.height / 2) * delta); 
```

事实证明，计算中心和原点之间存在一些差异。反正问题就解决了。谢谢大家。

# .htaccess - 在 localhost 激活 Joomla 2.5 URL 重写后找不到 404

> ID：12610663
> 
> 赞同：1
> 
> 时间：2012-09-26T21:25:17.483
> 
> 标签：.htaccess, http-status-code-404, joomla2.5, joomla-sef-urls

我在 localhost 有我的网站的副本：

```
/var/www/vhosts/mysite.com/httpdocs 
```

这是我的 /etc/apache2/sites-available/mysite

```
<VirtualHost *:80>
        ServerAdmin webmaster@localhost

        DocumentRoot /var/www/vhosts/mysite.com/httpdocs
        <Directory />
                Options FollowSymLinks
                AllowOverride All
        </Directory>
        <Directory /var/www/>
                Options Indexes FollowSymLinks MultiViews
                AllowOverride All
                Order allow,deny
                allow from all
        </Directory>

        ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
        <Directory "/usr/lib/cgi-bin">
                AllowOverride None
                Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
                Order allow,deny
                Allow from all
        </Directory>

        ErrorLog ${APACHE_LOG_DIR}/error.log

        # Possible values include: debug, info, notice, warn, error, crit,
        # alert, emerg.
        LogLevel warn

        CustomLog ${APACHE_LOG_DIR}/access.log combined

    Alias /doc/ "/usr/share/doc/"
    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

</VirtualHost> 
```

我已将 htaccess.txt 复制到 .htaccess。当我激活友好 URL 和 URL 重写时，我收到 404 错误。

我在 .htaccess 中取消了对这一行的注释，但仍然不起作用：

```
Options +FollowSymLinks
RewriteEngine On
RewriteBase / 
```

我也尝试将 rewritebase 更改为

```
RewriteBase /mysite 
```

没有运气。

我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T08:17:17.023

不确定这是否是您遇到的问题，但我经历过重写在“localhost”上效果不佳。尝试更改您的主机文件以说

```
127.0.0.1     mysite.local 
```

然后在该网址上访问它。

不确定这是否可行，但值得一试。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T18:39:57.193

解决了！我与 /etc/apache2/sites-available 中的不同条目发生冲突。当我在 localhost 创建一个新站点时，我复制`default`到`mysite`并修改`mysite`文件以指向它的 DocumentRoot。我不知道确切原因，但如果我禁用默认站点：

```
sudo a2dissite default 
```

有用。

也许这并不能解决问题，但我更喜欢针对这个问题提出另一个更具体的问题，因为我已经测试过，它与启用的不同站点以及一个或多个启用了 RewriteEngine 的站点有关。

# objective-c - UITextView 在 iOS5 上可编辑，但在 iOS6 上不可编辑

> ID：12610664
> 
> 赞同：4
> 
> 时间：2012-09-26T21:25:23.510
> 
> 标签：objective-c, ios

我的应用程序中有一些 UITextViews。由于我从 XCode 4.5 开始构建 UITextView 在 iOS6 中有点不可编辑，但在 iOS5 设备上构建它们是完全可编辑的。

自从我开始使用 iOS6 以来，代码没有改变。XIB 自 iOS4 以来一直存在

症状是...

iOS6

*   可以通过点击和删除字符来提升键盘，但不能输入任何其他内容
*   不能用键盘隐藏键降低键盘。

iOS5

*   可以通过点击抬起键盘并完全编辑。
*   不能用键盘隐藏键降低键盘。

我很困惑。被`textViewDidBeginEditing:`击中了，所以我知道它的接线正确。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-27T10:37:59.043

测试项目方法不起作用，因为我无法重现该问题。

最后，修复是这个不存在的。

`[window makeKeyAndVisible];`

如...

```
- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions {    

self.viewController = [[[MyViewController alloc] initWithNibName:nil bundle:nil] autorelease];

self.navigationController = [[[UINavigationController alloc] initWithRootViewController:self.viewController] autorelease];

[window setRootViewController:navigationController];

[window makeKeyAndVisible];

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-09T01:23:50.317

就我而言，这是因为`UIAltertView`被调用了两次。

您可能不认为您从未键入过任何键，但 BackSpace 键确实符合条件。

然后我删除了第二个`UIAlertView`和`TextField`工作。

我认为您需要检查`UIAlertView`代码。

# sql - 这个简单的 SQL 语句有什么问题？

> ID：12610668
> 
> 赞同：0
> 
> 时间：2012-09-26T21:25:36.677
> 
> 标签：sql

我正在研究**SQL**，我一直试图看看这有什么问题，但似乎无法弄清楚。

```
SELECT * 
FROM l_suppliers
WHERE suppliers_name = 'frank reed's vegetables'; 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:27:00.280

你的报价`'`中间有一个引号。尝试这个：

```
SELECT * FROM l_suppliers WHERE suppliers_name = 'frank reed''s vegetables'; 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-09-26T21:27:08.327

您需要`'`使用`''`or转义字符串分隔符`\'`

```
SELECT * FROM l_suppliers 
WHERE suppliers_name = 'frank reed''s vegetables'; 
```

否则，SQL 引擎会认为字符串在后面结束，`reed`并且不知道如何处理查询的其余部分。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-09-26T21:27:53.460

问题在于`'`，您必须使用转义字符，例如`\`or `'`。

例如oracle、tsql（sybase、ms sql server）：

```
SELECT * FROM l_suppliers WHERE suppliers_name = 'frank reed''s vegetables'; 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-09-26T21:27:35.283

看起来您的语句中有一个不完整的字符串。

您必须转义`'`with`''`才能成功执行它。

```
SELECT * FROM l_suppliers WHERE suppliers_name = 'frank reed''s vegetables'; 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-09-26T21:28:39.187

您的供应商名称中有一个嵌入的单引号。这打破了声明。嵌入的单引号应该像这样加倍：

```
SELECT * FROM l_suppliers WHERE suppliers_name = 'frank reed''s vegetables'; 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-09-26T23:51:24.870

你可以试试这个它可能会给出不同的结果

```
 SELECT 
 * 
 FROM l_suppliers
 WHERE suppliers_name = 'frank reed''s vegetables'; 
```

或者

```
 SELECT 
 * 
 FROM l_suppliers
 WHERE suppliers_name LIKE 'frank reed''s vegetables%'; 
```

或者

```
 SELECT 
 * 
 FROM l_suppliers
 WHERE suppliers_name LIKE '%frank reed''s vegetables%'; 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2012-09-26T21:33:15.153

在 sql 中，它使用单引号来分隔字母数字字段，因此如果您的字符串中有单引号，则 sql 认为它到此结束。您必须对其进行转义或将其替换为 ''。

# c++ - Qt 内存错误 - 需要 valgrind 跟踪分析帮助

> ID：12610669
> 
> 赞同：1
> 
> 时间：2012-09-26T21:25:40.077
> 
> 标签：c++, qt, valgrind, qtgui, memcheck

您有任何理论如何调试这种可能有问题的内存访问模式吗？我有预感它可能与我正在经历的某个海森错误有关，但我似乎无法确定它。

这是在 valgrind 下运行的调试构建的片段，带有`--track-origins=yes`,`--leak-check=full`

我怎么会滥用 Qt 的 Gui lib，以便它以下列方式表现出来？

```
==15169== Conditional jump or move depends on uninitialised value(s)
==15169==    at 0x99CD8AA: XSetCommand (in /usr/lib64/libX11.so.6.3.0)
==15169==    by 0x99D1FFE: XSetWMProperties (in /usr/lib64/libX11.so.6.3.0)
==15169==    by 0x7280853: QWidgetPrivate::create_sys(unsigned long, bool, bool) (in /usr/lib64/qt4/libQtGui.so.4.8.3)
==15169==    by 0x723550F: QWidget::create(unsigned long, bool, bool) (in /usr/lib64/qt4/libQtGui.so.4.8.3)
==15169==    by 0x723F3E1: QWidget::setVisible(bool) (in /usr/lib64/qt4/libQtGui.so.4.8.3)
==15169==    by 0x40DFE5: QWidget::show() (qwidget.h:494)
==15169==    by 0x40DA5D: SYSApplication::on_start() (sysapplication.cpp:55)
==15169==    by 0x40D5BC: main (main.cpp:8)
==15169==  Uninitialised value was created by a stack allocation
==15169==    at 0x723F0E0: QWidget::setVisible(bool) (in /usr/lib64/qt4/libQtGui.so.4.8.3)
==15169== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:24:30.400

检查您在 main.cpp:8 和 sysapplication.cpp:55 中引用的变量。如果你有错，那么这里使用的变量之一就有错。

另外，检查**未初始化的值是由 QWidget::setVisible 的堆栈分配创建的**- 你曾经调用过 setVisible 吗？如果是这样，参数的值是多少？

重要提示：Valgrind 将跟踪被复制的内存。如果你有：

```
int i;       // 1
int j = i;   // 2
int k = j;   // 3
if (k) {}    // 4 
```

那么 Valgrind 会在第 4 行抛出这个错误，即使第 1 行是错误的来源。

Qt 也有可能无法初始化某些东西。在 Valgrind 下运行时，许多库会引发很多令人担忧的错误。

# javascript - 检测iPhone是否在旋转时旋转？

> ID：12610677
> 
> 赞同：1
> 
> 时间：2012-09-26T21:26:07.423
> 
> 标签：javascript, jquery

我有以下代码，当您以某种方式旋转它时，它将更新我的页面的背景图像：

```
window.onorientationchange = function() {
    var orientation = window.orientation;
    switch (orientation) {
    case 0:
        $(".bg-img").css("background-image", "url(" + portrait + ")");
        break;
    case 90:
        $(".bg-img").css("background-image", "url(" + landscape + ")");
        break;
    case -90:
        $(".bg-img").css("background-image", "url(" + landscape + ")");
        break;
    };
};​ 
```

这可行，但是当页面旋转时，加载新图像需要几秒钟，并导致页面看起来很奇怪。

反正有没有检测到方向正在改变，而不是改变？像`willAnimateFirstHalfOfRotationToInterfaceOrientation`什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:30:29.440

该[`deviceorientation`](https://developer.mozilla.org/en-US/docs/Detecting_device_orientation)事件会随着设备当前位置的更新而触发。 [这是一个演示。](http://www.jeremyselier.com/s/demo/device_orientation.html)

请注意，这只适用于 iPhone ≥ 4 和 iPad ≥ 2。较旧的 Apple 硬件没有陀螺仪。

该活动还适用于我在 Chrome 和股票浏览器中的 Galaxy Nexus Android 4 设备。

您还可以[预加载](https://stackoverflow.com/search?tab=votes&q=image%20preload)背景图像，以便立即进行切换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:41:27.523

您应该能够挂钩`deviceorientation`事件，该事件会触发每个动作，而不仅仅是完全更改。请参阅这些文章：

*   [W3 DeviceOrientation 事件规范草案](http://dev.w3.org/geo/api/spec-source-orientation)
*   [html5rocks：使用设备方向](http://www.html5rocks.com/en/tutorials/device/orientation/)
*   [MDN：检测设备方向](https://developer.mozilla.org/en-US/docs/Detecting_device_orientation)

# objective-c - 将 fetchedResultsController 对象传递给 child 稍后返回 nil

> ID：12610680
> 
> 赞同：0
> 
> 时间：2012-09-26T21:26:15.083
> 
> 标签：objective-c, ios, uitableview, nsfetchedresultscontroller

我有一个`UITableView`适用于我的 iPad 的应用程序，当您点击一行时，将显示一个 popOver，其中包含另一个表格，其中包含一个部分。popOver 表部分标题取决于`fetchedResultsController`主 UITableView 控制器上的值。当弹出框第一次加载时，信息是正确的。但是，在用户点击弹出框中的单元格后，它会转到弹出框内的另一个视图，该视图将允许您编辑数据。保存后，我会调用一个委托方法来刷新 main `UITableView`，同时弹出框保持显示。然后用户编辑数据的视图被关闭，因此它返回到 popover `UITableView`。此时`fetchedResultsController`传入的`slot`值现在为零。我无法弄清楚它为什么这样做。

为什么`slot`现在是零，`SlotViewController`我该如何防止它？

**@界面**

```
NSFetchedResultsController *fetchedResultsController; 
```

**主 UITableView**

```
@synthesize fetchResultsController = _fetchedResultsController;

- (NSFetchedResultsController *)fetchedResultsController {
    /*
     Set up the fetched results controller.
     */
    if (_fetchedResultsController != nil) {
        NSLog(@"RETURNING FETCHEDRESULTS");
        return _fetchedResultsController;
    }
    NSLog(@"Should only be called once");
    // Create the fetch request for the entity.
    NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
    // Edit the entity name as appropriate.
    NSEntityDescription *entity = nil;
    if ([[dataObj.client objectForKey:@"appt_method"] integerValue] == 2) {
        entity = [NSEntityDescription entityForName:@"Slots" inManagedObjectContext:[[CoreDataHelper sharedInstance] managedObjectContext]];
    } else {
        entity = [NSEntityDescription entityForName:@"Appointments" inManagedObjectContext:[[CoreDataHelper sharedInstance] managedObjectContext]];
    }
    [fetchRequest setEntity:entity];
    [fetchRequest setPredicate:nil];
    //[fetchRequest setIncludesPendingChanges:YES];

    // Set the batch size to a suitable number.
    //[fetchRequest setFetchBatchSize:20];

    // Sort using the date / then time property.
    NSSortDescriptor *sortDescriptorDate = [[NSSortDescriptor alloc] initWithKey:@"date" ascending:YES];
    NSSortDescriptor *sortDescriptorTime = [[NSSortDescriptor alloc] initWithKey:@"start_time" ascending:YES selector:@selector(localizedStandardCompare:)];
    NSArray *sortDescriptors = [[NSArray alloc] initWithObjects:sortDescriptorDate, sortDescriptorTime, nil];

    [fetchRequest setSortDescriptors:sortDescriptors];

    // Use the sectionIdentifier property to group into sections.
    NSFetchedResultsController *aFetchedResultsController = [[NSFetchedResultsController alloc] initWithFetchRequest:fetchRequest managedObjectContext:[[CoreDataHelper sharedInstance] managedObjectContext] sectionNameKeyPath:@"date" cacheName:nil];
//    aFetchedResultsController.delegate = self;
    self.fetchedResultsController = aFetchedResultsController;
    _fetchedResultsController.delegate = self;

    return _fetchedResultsController;
}

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    Slots *selectedSlot = [_fetchedResultsController objectAtIndexPath:indexPath];
    SlotViewController *slotView = [parentNav.storyboard instantiateViewControllerWithIdentifier:@"SlotViewController"];
            [slotView setSlot:selectedSlot];
    CGRect rect = [self rectForRowAtIndexPath:indexPath];
                rect.size.width = rect.size.width / 3;
                UINavigationController *navBar = [[UINavigationController alloc] initWithRootViewController:slotView];
                popOver = [[UIPopoverController alloc] initWithContentViewController:navBar];
                popOver.delegate = self;
                //[popOver setPopoverContentSize:CGSizeMake(320, 460) animated:YES];
                [popOver presentPopoverFromRect:rect inView:self permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES];
} 
```

**SlotViewController / popover UITableView**

```
- (NSString *)tableView:(UITableView *)tableView titleForHeaderInSection:(NSInteger)section
{
    NSLog(@"slot: %@", _slot.date);
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc] init];
    [dateFormatter setDateFormat:@"yyyyMMdd"];
    NSDate *currDate = [dateFormatter dateFromString:_slot.date];

    [dateFormatter setDateFormat:@"h:mma"];
    [dateFormatter setTimeZone:[NSTimeZone timeZoneWithAbbreviation:@"GMT"]];
    NSDate *midnight = [NSDate dateWithTimeIntervalSince1970:0];
    NSDate *startTimeDate = [midnight dateByAddingTimeInterval:[_slot.start_time integerValue] * 60];
    NSDate *endTimeDate = [midnight dateByAddingTimeInterval:[_slot.end_time integerValue] * 60];

    NSString *startTime = [dateFormatter stringFromDate:startTimeDate];
    NSString *endTime = [dateFormatter stringFromDate:endTimeDate];

    dateFormatter.locale = [[NSLocale alloc] initWithLocaleIdentifier:@"en_US_POSIX"];
    [dateFormatter setDateFormat:@"E, MMM dd, yyyy"];
    return [NSString stringWithFormat:@"%@ %@-%@",[dateFormatter stringFromDate:currDate], startTime, endTime];
} 
```

我可以通过更改`didSelectRowAtIndexPath`代码来使其正常工作

```
Slots *selectedSlot = [_fetchedResultsController objectAtIndexPath:indexPath]; 
```

至

```
Slots *selectedSlot = [Slots disconnectedEntity];
Slots *tmpSlot = [_fetchedResultsController objectAtIndexPath:indexPath];
for (id key in tmpSlot.entity.attributesByName) {
    [selectedSlot setValue:[tmpSlot valueForKey:key] forKey:key];
} 
```

**disconnectedEntity** 是一个核心数据托管上下文，它不绑定到一个对象。

```
+ (id)disconnectedEntity {
    NSManagedObjectContext *context = [[CoreDataHelper sharedInstance] managedObjectContext];
    NSEntityDescription *entityDescription = [NSEntityDescription entityForName:@"Slots" inManagedObjectContext:context];
    return [[self alloc] initWithEntity:entityDescription insertIntoManagedObjectContext:nil];
} 
```

但是我想知道为什么原始代码不起作用。我假设这是因为`fetchedResultsController`正在传递引用，`selectedSlots`所以当`fetchedResultsController`更新时，引用不再存在？

# c++ - 结构数组的未定义C++变量

> ID：12610681
> 
> 赞同：2
> 
> 时间：2012-09-26T21:26:22.567
> 
> 标签：c++, variables

我在名为 index.cpp 的文件中有以下方法。当我编译时，它告诉我“indexStructure”没有在这个范围内定义。

```
#include "index.h"
#include <cctype> // provides isalpha() and tolower()
#include <iostream>
#include <sstream>

using namespace std;

void index::shiftRight (int i)
{
if ( indexSize == (sizeof(indexStructure) / sizeof(indexStructre[0])))
    doubleIndex();

for (int j = indexSize; j > i; j--)
    indexStructure [j] = indexStructure [j-1];
} 
```

在 index.h 中，我有

```
class index
{

struct node {
    string item;
    int counter;
    int* pageNumber;
};

...

private:
    node* indexStructure;
    int lineCounter;
    int indexSize;

}; 
```

我打算制作一个节点类型的数组，并用它来搜索书中的单词。为什么它是未定义的？

提前致谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:28:16.937

你拼错`sizeof(indexStructre[0])`了 `index::shiftRight()`。将其更正并重`indexStructure`试。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:28:45.723

`indexStructre`这里的字母在字母`u`之后丢失`t`。但是，当您说编译器在抱怨时，您拼写正确:)

# c# - 所有标题的 500 错误

> ID：12610685
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:26:39.307
> 
> 标签：c#, ssis, webclient

我只是想 ping 谷歌或某个网站，看看我是否能让这段代码工作。我是 C# 新手，所以我不知道为什么这是错误的。有什么我想念的吗？

```
 System.Net.WebClient myWebClient = new System.Net.WebClient();

 myWebClient.Proxy = new System.Net.WebProxy("--mywebproxy--");

 myWebClient.Headers["User-Agent"] = "Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.6) Gecko/20100625 Firefox/3.6.6 (.NET CLR 3.5.30729)"; 
 myWebClient.Headers["Accept"] = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"; 
 myWebClient.Headers["Accept-Language"] = "en-us,en;q=0.5"; 
 myWebClient.Headers["Accept-Encoding"] = "    gzip,deflate"; 
 myWebClient.Headers["Accept-Charset"] = "ISO-8859-1,utf-8;q=0.7,*;q=0.7"; 

 myWebClient.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;

 myWebClient.DownloadData("http://www.google.com"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:37:28.500

我希望您使用的是实际的 URI

像，

```
System.Net.WebClient myWebClient = new System.Net.WebClient { Proxy = new System.Net.WebProxy("http://127.0.0.1") }; 
```

如果它仍然不起作用，请安装 IIS 并重试。

你的整个代码将是

```
 var myWebClient = new System.Net.WebClient { Proxy = new System.Net.WebProxy("http://127.0.0.1") };

        myWebClient.Headers["User-Agent"] = "Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.2.6) Gecko/20100625 Firefox/3.6.6 (.NET CLR 3.5.30729)";
        myWebClient.Headers["Accept"] = "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8";
        myWebClient.Headers["Accept-Language"] = "en-us,en;q=0.5";
        myWebClient.Headers["Accept-Encoding"] = "    gzip,deflate";
        myWebClient.Headers["Accept-Charset"] = "ISO-8859-1,utf-8;q=0.7,*;q=0.7";

        myWebClient.Credentials = System.Net.CredentialCache.DefaultNetworkCredentials;

        var x = myWebClient.DownloadData("http://www.google.com"); 
```

# jquery - Jquery 类 - 向其添加增量

> ID：12610686
> 
> 赞同：1
> 
> 时间：2012-09-26T21:26:41.327
> 
> 标签：jquery, slider

我正在尝试在 Jquery 的“myclass”末尾添加一个动态生成的数字。所以我希望它在最后增加一个数字，如下所示：

我的班级1

我的班级2

我的班级3

我的班级4

我已经尝试了几次，但不知道我在做什么。任何帮助都会很棒！

```
 var f=1;for(var g=0;g<d.count;g++)for(var f=1; f<3; f++){e.append("<li class='myclass"+f+"'><a>"+f+"</a></li>");f++} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:28:34.597

我不确定您要做什么，但这是我的看法。当然，您可以更具体地介绍 jQuery 选择器。

```
var i = 1;
$('li').each(function(){
    $(this).addClass('myclass'+i);
    i++;
}); 
```

**编辑**

根据提供的代码：

```
for(var f = 1; f < 5; f++){
    e.append("<li class='myclass"+f+"'><a>"+f+"</a></li>");
    f++;
} 
```

# android - 更改 Android ListActivity onListItemClick 中项目的背景颜色

> ID：12610695
> 
> 赞同：10
> 
> 时间：2012-09-26T21:27:03.430
> 
> 标签：android, listview, listactivity

我知道这听起来很简单，并且对此存在疑问。但没有一个能解决我的问题。所以我们开始：

我想`ListActivity`在用户单击时更改列表项的背景颜色，并在用户再次单击时将其更改回原始颜色（即选择/取消选择项目的外观）

我尝试使用 getChildAt，如果我在一个屏幕上显示所有项目而无需滚动，它就可以完美运行。

*代码：*

```
getListView().getChildAt(position).setBackgroundColor(Color.CYAN); 
```

当我在列表中有更多项目并且用户必须滚动浏览它们时，问题就开始了。更改项目的背景后，当我滚动时，背景颜色会显示在新可见的项目上。此外，再次单击该项目时`getChildAt(position)`返回`null`（以及因此 a ）。`NullPointerException`

谁能帮我一个简单的代码来帮助我更改列表项的背景颜色？

提前致谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T21:36:43.790

肯定的事。我会在`getView()`自定义的方法中做到这一点`ListAdapter`。

```
MyAdapter extends SimpleAdapter {
    private ArrayList<Integer> coloredItems = new ArrayList<Integer>();

    public MyAdapter(...) {
        super(...);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View v = super.getView(position, convertView, parent);

        if (coloredItems.contains(position)) {
            v.setBackgroundColor(Color.CYAN);
        } else {
            v.setBackgroundColor(Color.BLACK); //or whatever was original
        }

        return v;
    }
} 
```

`coloredItems`单击列表项时更新。

```
@Override
public void onListItemClick(ListView l, View v, int position, long id) {
    if (coloredItems.contains(position)) {
        //remove position from coloredItems
        v.setBackgroundColor(Color.BLACK); //or whatever was original
    } else {
        //add position to coloredItems
        v.setBackgroundColor(Color.CYAN);
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-29T05:28:55.310

如果您正在处理，`ListFragment`那么此代码将很有帮助，

```
 @Override
    public void onViewCreated(View view, Bundle savedInstanceState) {
        super.onViewCreated(view, savedInstanceState);
        if (view != null) {
            getListView().setChoiceMode(ListView.CHOICE_MODE_SINGLE);
            getListView().setDescendantFocusability(ListView.FOCUS_AFTER_DESCENDANTS);
            catagoryValueListView=getListView();
            catagoryValueListView.setOnItemClickListener(new OnItemClickListener() {

             @Override
             public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                 if (ColoredView != null)
                     ColoredView.setBackgroundColor(Color.WHITE); //original color

                 view.setBackgroundColor(Color.BLUE); //selected color
                 ColoredView = view;
                                  }
        });
    }

} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:39:24.310

我所做的是创建一个名为 ie list_background 的 xml 文件并将其放入可绘制文件夹中。

xml 看起来像这样：

```
<selector xmlns:android="http://schemas.android.com/apk/res/android">
   <item android:drawable="@color/list_selected" android:state_pressed="true" />
   <item android:drawable="@android:color/white" />
</selector> 
```

在 ListView 项目的 xml 代码中，我将此 xml 作为项目背景，即

项目.xml：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
          style="@style/Fill"
          android:background="@drawable/list_background">

     <!-- Your layout here -->
</RelativeLayout> 
```

style=@style/Fill 只是我为 android:layout_height="match_parent" 和 android:layout_width="match_parent

然后在 onListItemCLick 中：

```
public void onListItemClick(ListView l, View v, int position, long id) {
    v.setPressed( !v.isPressed ) //Toggle between colors of the view
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-18T10:17:45.420

`onListItemClick`只需您可以在方法中这样做

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
    super.onListItemClick(l, v, position, id);

    for (int a = 0; a < l.getChildCount(); a++) {
        l.getChildAt(a).setBackgroundColor(Color.TRANSPARENT);
    }

    ColorDrawable colorDrawable1 = new ColorDrawable(
            Color.parseColor("#A0A3A0"));
    v.setBackgroundDrawable(colorDrawable1);   

    if (position == 0) {
        Intent i = new Intent(MainActivity.this, NewActivity.class);

        startActivity(i);
    }

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-02T05:30:13.283

我就是这样做的：

创建一个全局变量`View ColoredView`；然后当你`setOnItemClickListener`为你的时`ListView`，这样做：

```
MenuList.setOnItemClickListener(new OnItemClickListener() {

            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                if (ColoredView != null)
                    ColoredView.setBackgroundColor(Color.WHITE); //original color

                view.setBackgroundColor(Color.BLUE); //selected color
                ColoredView = view;
            }
        }); 
```

这是我认为最简单的方法。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-12-20T10:04:59.543

谢谢嘿宇宙。你的解决方案解决了我的问题。

***不知道为什么我们应该在两个地方设置背景。***

**1.Adapter的getView()**

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
     ....
     ....
     ....
        if(arrayBools[position]) {
            view.setBackgroundColor(Common.colorBkgroundSelected);
        }
        else{
            view.setBackgroundColor(Common.colorBkgroundNormal);            
        } 
     ....
     ....
     ....
} 
```

**2.ListActivity的onListItemClick()。**

```
@Override
protected void onListItemClick(ListView l, View v, int position, long id) {
      super.onListItemClick(l, v, position, id);       
      arrayBools[position] = ( arrayBools[position] ? false : true );

     if(arrayBools[position]) {
         v.setBackgroundColor(colorBkgroundSelected);
     }
     else{
        v.setBackgroundColor(colorBkgroundNormal);          
     }    
} 
```

# sqlite - 我可以得到回调/我知道 SQLite 何时创建了预写日志文件吗？我想chmod他们

> ID：12610702
> 
> 赞同：0
> 
> 时间：2012-09-26T21:27:29.900
> 
> 标签：sqlite, posix, file-permissions, chmod, umask

我有一个提升的进程，我想确保它创建的 SQLite 文件可以被其他进程读取。由于某种原因`umask`似乎没有做我想要的（设置进程创建的sqlite文件的权限）。

我正在使用预写日志记录，因此`-wal`除了`-shm`数据库文件之外还创建了文件。我希望所有 3 都正确 chmodded。

我想知道在创建 SQLite 文件之后是否有可能进入`chmod`。

可能的方法：

1.  `touch`SQLite 尝试创建它们之前的所有 3 个文件，然后 chmod 并希望掩码保持不变
2.  在创建文件时拦截`chmod`它们。
3.  弄清楚如何开始`umask`工作。
4.  神秘选项四。

最好的方法是什么？

方法问题：

1.  SQLite 可以吗？
2.  我们知道何时创建所有 3 个文件吗？是否有某种回调我可以给函数指针？我们知道相同`wal`和`shm`文件是否永远存在吗？还是它们被删除并重新创建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T06:40:02.640

您可以在打开数据库文件之前触摸它。（当您使用`sqlite3`命令行工具打开一个新文件，但除了`begin;`and之外什么都不做`commit;`，SQLite 本身将创建一个零大小的文件。）

如果要拦截文件操作，可以注册自己的[VFS](http://www.sqlite.org/vfs.html)。

`-wal`和文件是动态创建的`-shm`，但 SQLite 会给它们与主数据库文件相同的权限位。`robust_open()`的评论`os_unix.c`说：

> 如果文件创建模式“m”为 0，则将其设置为 SQLite 的默认值。默认值为由系统 umask 修改的 SQLITE_DEFAULT_FILE_PERMISSIONS（通常为 0644）。如果 m 不为 0，则使文件创建模式完全为 m，忽略 umask。
> 
> 仅当创建 -wal、-journal 和 -shm 文件时，m 参数才非零。我们希望这些文件具有与其原始数据库*完全相同*的权限，不受 umask 的影响。这样，如果数据库文件是`-rw-rw-rw`or `-rw-rw-r-`，并且事务崩溃并留下热日志，那么任何能够写入数据库的进程也将能够恢复热日志。

# javascript - 使用 jquery 更新文本框中的值

> ID：12610709
> 
> 赞同：-2
> 
> 时间：2012-09-26T21:27:57.097
> 
> 标签：javascript, jquery, html

我有三个文本框，当我修改文本框 A 或文本框 B 时，文本框 C 应更改为 A*B，例如如果 A 为 3，B 为 4，C 为 12...如果我将 B 更改为 5，C 应自动更改为 15。 js 小提琴在这里：http: [//jsfiddle.net/Lazyboy4ever/mfyh2/](http://jsfiddle.net/Lazyboy4ever/mfyh2/)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:34:57.397

****我会说，请搜索它，但我怕你会问“在哪里？”。所以，请在询问之前谷歌它。****

**将此解决方案更改为乘法：** [如何使用 jquery 计算输入框的总值](https://stackoverflow.com/questions/3699042/how-to-calculate-the-total-value-of-input-boxes-using-jquery)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:40:49.193

`.change()`将事件处理程序绑定到`input`s`A`和`B`，`value`使用 将它们转换为数字`parseFloat()`，将它们相乘，然后将结果分配给`C`：

```
$("[name='qty'],[name='b']").change(function () {
   var $tr = $(this).closest("tr"),
       qty = $tr.find("[name='qty']").val(),
       b = $tr.find("[name='b']").val();

   var c = parseFloat(qty) * parseFloat(b); 
   $tr.find("[name='c']").val(c);
});​ 
```

**[演示](http://jsfiddle.net/TRvV8/)**。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:38:44.323

这是另一个可能适用于您的案例的示例：

HTML：

```
<input id="txt1" type="text" /><br />
<input id="txt2" type="text" /><br />
<input id="txt3" type="text" /><br /> 
```

Javascript：

```
$(function(){
    $(document).on('blur', '#txt1', function(){
        var one = $('#txt1').val();
        var two = $('#txt2').val();
        var three = $('#txt3').val();
        $('#txt3').val(one * two);        
    });     

        $(document).on('blur', '#txt2', function(){
        var one = $('#txt1').val();
        var two = $('#txt2').val();
        var three = $('#txt3').val();
        $('#txt3').val(one * two);        
    });       

}); 
```

[jsFiddle 中的示例](http://jsfiddle.net/XMhSm/)

# android - 如何在 Android 的后台运行 PhoneGap/Cordova 的 MainActivity？

> ID：12610711
> 
> 赞同：1
> 
> 时间：2012-09-26T21:28:09.230
> 
> 标签：android, cordova, android-activity, cordova-2.0.0

背景：

我正在使用 Cordova 创建一个应在 iOS 和 Android 上运行的应用程序。我将 SenchaTouch 用于 UI，以便 UI 的代码库对于 iOS 和 android 都是相同的。我正在使用适用于 iOS 和 android 的 Cordova 的条形码扫描仪插件。扫描仪活动由 JavaScript 代码触发。在调用barcodeScanner的扫描功能后的JS代码中，我设置了15秒的超时，之后如果没有扫描到条形码，我会提醒用户。

这在 iOS 中运行良好。

问题：

我的问题是，一旦 ScannerActivity 启动 MainActivity（在 Cordova 中包含运行 JS 的 webview）就会进入后台并被 android 系统自动停止。这意味着我的 JS 代码不再运行。**在暂停 ScannerActivity 但不停止 ScannerActivity 之后**，我需要/想要**通过 JS**触发警报。为此，我需要一种方法来保持 MainActivity 在后台运行。

 **解决方案：

我整天都在网上搜索，到目前为止似乎没有办法做到这一点。但不知何故，我认为应该有办法做到这一点。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T02:49:11.423

您可以创建某种可以在每次需要时触发的后台运行的线程或服务。或者您将 ScannerActivity 集成到 MainActivity 中。

否则，未显示的活动被停止/暂停是标准行为，除非它是没有 ui 的服务/线程/活动。**

# php - 在 PHP 中解压缩 *.Z 文件

> ID：12610714
> 
> 赞同：-5
> 
> 时间：2012-09-26T21:28:21.373
> 
> 标签：php, lzw

> **可能重复：**
> [有没有办法使用 php 解压缩 .Z 文件？](https://stackoverflow.com/questions/10174917/is-there-a-way-to-uncompress-z-files-using-php)

寻找任何关于 PHP 中将在 Windows 环境中解压缩 Unix .Z 文件的函数的线索或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:31:17.130

[php-lzw](http://code.google.com/p/php-lzw/)项目看起来应该满足您的需求：

> LZW 是一种简单的算法，主要用于文本压缩。该库为 LZW 压缩和解压缩提供了简单的函数。

# c# - 使用 C# 在 Active Directory 中禁用计算机

> ID：12610719
> 
> 赞同：4
> 
> 时间：2012-09-26T21:28:35.673
> 
> 标签：c#, .net-4.0

我一直在尝试编写一个快速而肮脏的 C# .exe，我可以将它分发给我们 IT 办公室的一些学生工作者。.exe 应该能够检测到运行它的机器的名称，在 Active Directory 中搜索该名称，然后禁用计算机条目。到目前为止，我在名称检测或搜索方面没有遇到任何问题，但是当我可以直接进入 Active Directory 以查看计算机条目未被禁用时，删除代码位给了我一个误报。

```
 private void confirmRemoveButton_Click(object sender, EventArgs e)
    {
        string computerName = Environment.MachineName;
        using (PrincipalContext domainContext = new PrincipalContext(ContextType.Domain, null, "useraccount", "password"))
        {
            ComputerPrincipal computer = ComputerPrincipal.FindByIdentity(domainContext, computerName);

            if (computer != null)
            {
                try
                {
                    computer.Enabled = false;
                    label3.Visible = true;
                    label3.Text = "Computer was disabled in Active Directory.";
                    button1.Visible = true;
                }

                catch (Exception x)
                {
                    label3.Visible = true;
                    label3.Text = "Unable to disable computer with exception " + x;
                    button1.Visible = true;
                }
            }

            else if (computer == null)
            {
                label3.Visible = true;
                label3.Text = "Computer was not found in Active Directory.";
                button1.Visible = true;
            }

            else
            {
                label3.Visible = true;
                label3.Text = "Unexpected error in computer search.";
                button1.Visible = true;
            }
        }
    } 
```

这是我现在拥有的代码；前面的代码是关于让用户根据检测到的计算机名称检查计算机名称并确认他们确实想要禁用计算机帐户。一旦他们点击确认（目前被误导为确认*删除*按钮），它应该运行此代码以报告成功或失败。但是，在测试中，它报告成功，尽管我可以看到计算机对象没有被禁用。

此链接（http://stackoverflow.com/questions/591681/using-c-how-do-you-check-if-a-computer-account-is-disabled-in-active-directory）是一个与在标题中禁用计算机帐户，但评论和代码似乎都表明这适用于禁用用户帐户。

任何见解将不胜感激:)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:30:35.453

您需要调用`Save`对象`ComputerPrincipal`：

[http://msdn.microsoft.com/en-us/library/bb354074.aspx](http://msdn.microsoft.com/en-us/library/bb354074.aspx)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T22:07:13.303

您必须保存 PrincipalComputer 对象。否则你的代码很好。这是一个简单的控制台应用程序版本，如果计算机不存在，它将不返回任何内容。

```
 static void Main(string[] args)
    {
        Console.WriteLine("Enter the name of the computer you wish to disable");
        string ComputerName = Console.ReadLine();
        if (ComputerName != "" && ComputerName != null)
        {
            using (PrincipalContext TargetDomain = new PrincipalContext(ContextType.Domain, null, "admin", "password"))
            {
                ComputerPrincipal TargetComputer = ComputerPrincipal.FindByIdentity(TargetDomain, ComputerName);

                if (TargetComputer != null)
                {
                    if ((bool)TargetComputer.Enabled)
                    {
                        Console.WriteLine("Computer is currently enabled, it will now be disabled");
                        TargetComputer.Enabled = false;
                        Console.WriteLine("Is computer now enabled? " + TargetComputer.Enabled);
                        TargetComputer.Save();
                    }
                    else
                    {
                        Console.WriteLine("Computer is currently disabled, it will now be enabled");
                        TargetComputer.Enabled = true;
                        Console.WriteLine("Is computer now enabled? " + TargetComputer.Enabled);
                        TargetComputer.Save();
                    }
                    Console.Read();
                }
            }
        }
    } 
```

该死，基伦打败了我！

请注意，有时 AD 可能需要一段时间才能识别出所发生的事情。

# c# - 只要我们有正确的引用和配置，Visual Studio 中的项目类型是否重要？

> ID：12610723
> 
> 赞同：1
> 
> 时间：2012-09-26T21:28:42.053
> 
> 标签：c#, visual-studio-2010, visual-studio

我收到了 Visual Studio 的 Web 应用程序的源代码，它的解决方案包含 15 个不同的项目，我应该创建类似的东西。

主要项目是一个 MVC3 Web 应用程序，其余的都是非 Web 应用程序，仅用于处理数据和其他资源。

当我尝试将新项目添加到我的新解决方案中时，我不知道这些项目的类型。我可以只添加一个空项目，例如一个 asp.net Web 应用程序空项目或任何其他 C# 应用程序空项目，甚至是一个 Windows 项目，并且仍然通过添加正确的引用、配置和其他文件来做出正确的解决方案吗？项目类型真的很重要吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:31:36.393

项目类型对 Visual Studio 很重要，因为它控制编译开关。有不同的开关来创建 .dll（类库项目）等等。Visual Studio 还使用项目类型来确定如何运行特定项目。（在用于网站和 Web 项目的 Cassini Web 服务器中，或者只是作为控制台和 WinForms 应用程序的可执行文件等）

如果您有 .csproj 文件，则可以查看文件以确定项目类型。

例如，一个类库将有

```
<OutputType>Library</OutputType> 
```

WinForms、控制台或 Windows 服务应用程序具有

```
<OutputType>WinExe</OutputType> 
```

网站没有 .csproj 文件，但您可以根据 .aspx、.asmx 和其他文件的存在来识别它。

如果您没有 .csproj 文件，您只能自行猜测。一般来说，如果它看起来像一堆没有 Main() 函数的类，并且这些类在另一个库中被引用，那么它很可能是一个类库项目。

如果您看到 Main() 例程，它可能是任何种类的 Windows 可执行文件，因此您需要寻找诸如 Console.WriteLine() 调用（通常与控制台应用程序相关联）或 Windows UI 组件的存在的线索例如 TextBoxes 等，以及对 System.Windows.Forms 命名空间的引用。对 System.ServiceModel 的引用通常表示 Windows 服务等。

# ruby - 如何将文本文件或字符串传递给 Ruby 脚本并在命令行中输出结果？

> ID：12610726
> 
> 赞同：3
> 
> 时间：2012-09-26T21:28:53.477
> 
> 标签：ruby

作为学习 Ruby 的练习，我想创建一个将从终端运行的脚本。它应该接受字符串或文本文件作为输入，并且应该输出我将自己编写的各种字符串解析机制的结果。

为了让我开始，你能把这个伪代码翻译成适合我的 Ruby 吗？

1.  在终端中：（`ruby myscript.rb`字符串或文本文件）。
2.  在 myscript.rb 中：检索输入。设置`my_input`为输入。
3.  设置`my_output`为`various_string_parsing_voodoo`(done to my_input) 的结果。
4.  `puts my_output`

我打算自己编写代码，但如果有人可以为我提供一个骨架 .rb 文件以发送“ `Hello World`”并获取“ `[World] is pleased by your [hello]`”或同样愚蠢的东西，那将是一个很大的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:37:36.490

以下是一些关键部分：

*   `ARGV`是一个数组，包含从命令行运行脚本时传递的参数。
*   该类`File`包含几个实用程序。例如，`File.exists?(path)`如果路径存在`File.file?(path)`则返回 true，如果路径存在并且是文件（不是目录）则返回 true。

我想这可能对你有很大帮助。

# cookies - 单选按钮和 cookie 设置

> ID：12610730
> 
> 赞同：0
> 
> 时间：2012-09-26T21:29:21.290
> 
> 标签：cookies, radio-button

我对 cookie 或如何设置它们一无所知，我需要一些建议。我有两个单选按钮。例如，如果一个选项从一个更改为另一个，即使在存在此单选按钮的其他页面上刷新或更改页面，该选项仍将保留，并且我需要为此代码进行 cookie 设置。有人可以给我一些关于我应该在我的 php 中添加什么代码的建议吗？

这是js代码：

```
$(document).ready(function() {
  $('radio[name=radio]').each(function() {
   $(this).click(function() {
    my_function();
    });
   });
});

my_function()
{
   var value_checked = $("input[name='radio']:checked").val();
   $.ajax({
   type: 'POST',
   url: 'page.php',
   data: {'value_checked':value_checked},
   });
} 
```

html代码

```
<form>
    <div id="radio">
        <input type="radio" id="radio1" name="radio" checked="checked" /><label for="radio1">Choice 1</label>
        <input type="radio" id="radio2" name="radio" /><label for="radio2">Choice 2</label>
    </div>
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:36:25.057

请参阅[setcookie](http://php.net/manual/en/function.setcookie.php)示例如何在 PHP 中设置 cookie。但是您也可以使用 javascript [js_cookies](http://www.w3schools.com/js/js_cookies.asp)来做到这一点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:41:14.460

重要的是要记住，cookie 只能*在**任何***输出发送到网页上的客户端之前设置，因为 cookie 设置为标头，并且标头只能在网页输出的任何部分之前发送。因此，您需要刷新页面以将 cookie 设置为单选按钮的值。

在 php 的最顶部，在 <!DOCTYPE> html 或 <html> 标记之前，您需要添加如下内容：

```
<?php
if(isset($_POST['radio1'])) {
  setcookie('radio1', true, 600, '/');
  setcookie('radio2', false, 600, '/');
} else if(isset($_POST['radio2'])) {
  setcookie('radio2', true, 600, '/');
  setcookie('radio1', false, 600, '/');
}
?> 
```

上面的代码将确保只有一个 cookie 设置为 true，而另一个设置为 false。cookie 将在十分钟后过期。

这是在您正确设置 html 表单之后，以便您可以检测到您的用户选择了一个按钮：

```
<form method="POST" action="index.php">
  <div id="radio">
    <input type="radio" id="radio1" name="radio" checked="checked" />
    <label for="radio1">Choice 1</label>
    <input type="radio" id="radio2" name="radio" />
    <label for="radio2">Choice 2</label>
  </div>
</form> 
```

PHP 手册页有更多信息： http: [//php.net/manual/en/function.setcookie.php](http://php.net/manual/en/function.setcookie.php)

EDIT: Semantic code changes and fixed the html tags described.

# c# - C# Select 子句返回系统异常而不是相关对象

> ID：12610731
> 
> 赞同：0
> 
> 时间：2012-09-26T21:29:23.183
> 
> 标签：c#, sql, database, select, iqueryable

我正在尝试使用 select 子句从数据库查询中挑选出与指定名称字段匹配的对象，如下所示：

```
objectQuery = from obj in objectList
              where obj.Equals(objectName)
              select obj; 
```

在我的查询的结果视图中，我得到：

`base {System.SystemException} = {"Boolean Equals(System.Object)"}`

我应该期待像`Car`, `Make`, 或`Model`

**有人可以解释一下我在这里做错了什么吗？**

* * *

有问题的方法可以在这里看到：

```
// this function searches the database's table for a single object that matches the 'Name' property with 'objectName'
public static T Read<T>(string objectName) where T : IEquatable<T>
{
    using (ISession session = NHibernateHelper.OpenSession())
    {
        IQueryable<T> objectList = session.Query<T>(); // pull (query) all the objects from the table in the database
        int count = objectList.Count(); // return the number of objects in the table
        // alternative: int count = makeList.Count<T>();

        IQueryable<T> objectQuery = null; // create a reference for our queryable list of objects
        T foundObject = default(T); // create an object reference for our found object

        if (count > 0)
        {
            // give me all objects that have a name that matches 'objectName' and store them in 'objectQuery'
            objectQuery = from obj in objectList
                          where obj.Equals(objectName)
                          select obj;

            // make sure that 'objectQuery' has only one object in it
            try
            {
                foundObject = (T)objectQuery.Single();
            }
            catch
            {
                return default(T);
            }

            // output some information to the console (output screen)
            Console.WriteLine("Read Make: " + foundObject.ToString());
        }
        // pass the reference of the found object on to whoever asked for it
        return foundObject;
    }
} 
```

请注意，我`IQuatable<T>`在方法描述符中使用了接口“”。

我试图从数据库中提取的类的一个例子是：

```
public class Make: IEquatable<Make>
{
    public virtual int Id { get; set; }
    public virtual string Name { get; set; }
    public virtual IList<Model> Models { get; set; }

    public Make()
    {
        // this public no-argument constructor is required for NHibernate
    }

    public Make(string makeName)
    {
        this.Name = makeName;
    }

    public override string ToString()
    {
        return Name;
    }

    // Implementation of IEquatable<T> interface 
    public virtual bool Equals(Make make)
    {
        if (this.Id == make.Id)
        {
            return true;
        }
        else
        {
            return false;
        }
    }

    // Implementation of IEquatable<T> interface 
    public virtual bool Equals(String name)
    {
        if (this.Name.Equals(name))
        {
            return true;
        }
        else
        {
            return false;
        }
    }
} 
```

接口简单描述为：

```
public interface IEquatable<T>
{
    bool Equals(T obj);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:36:32.623

`IQueryable<T>`针对支持数据存储（在本例中为 SQL RDBMS）执行您的查询。您的 SQL RDBMS 不知道`IEquatable<T>`^*，并且不能使用它的实现：查询函数必须可翻译为 SQL，并且`obj.Equals(objectName)`不可翻译。

您可以转换`IQueryable<T>`为`IEnumerable<T>`并在内存中执行查询，但这太低效了。您应该更改签名以获取`Expression<Func<TSource, bool>>`谓词，并将名称检查器传递给它：

```
public static T Read<T>(Expression<Func<T,bool>> pred) {
    using (ISession session = NHibernateHelper.OpenSession()) {
        return session.Query<T>().SingleOrdefault(pred);
    }
} 
```

您现在可以按如下方式使用此方法：

```
Make snake = Read<Make>(x => x.Name == "snake"); 
```

* * *

^*此外，您`IEquatable<T>`未在您展示的方法中使用：该`Equals(string)`方法将有资格作为 的实现`IEquatable<string>`，但在您的`Make`类实现的接口列表中未提及。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:35:50.770

您对 Equal 覆盖的调用之一可能会引发异常。

出于调试目的，尝试迭代而不是使用 Linq，您应该找出哪一个：

```
foreach(object obj in objectList)
{
    bool check = obj.Equals(objectName) // set a breakpoint here
} 
```

至于导致异常的原因，请确保您的每个对象 Name 和 Id 属性都有值。

# jquery - 转换为 jQuery 集合的 HTML 无法使用选择器搜索？

> ID：12610733
> 
> 赞同：1
> 
> 时间：2012-09-26T21:29:30.477
> 
> 标签：jquery, jquery-selectors

我正在尝试使用 动态加载页面`$.get()`，使用 解析返回`var $content = $(data)`，并最终使用选择器仅查找文档的某些部分。只有我无法弄清楚为什么返回的 jQuery 集合`$(data)`没有找到一些非常基本的选择器。

我设置了一个[jsFiddle 以](http://jsfiddle.net/jimp/mqaT7/)使用非常小的 HTML 字符串来说明问题。

```
<html>
<head>
<title>See Our Events</title>
</head>
<body><div id="content">testing</div></body>
</html> 
```

我想找到`<title>`节点。

```
var content = "<html>\n"+
"<head>\n"+
"  <title>See Our Events</title>\n"+
"</head>\n"+
"<body><div id=\"content\">testing</div></body>\n"+
"</html>";
var $content = $(content);
console.log($content.find('title').length); // Logs 0\. Why?
console.log($content.html());               // Logs null. Why? 
```

如果我将 a 包裹`<div>`在 HTML 周围，则选择器可以工作。（但是如果您查看 jsFiddle，选择器的其他变体仍然不起作用！）

```
var content = "<div><html>\n"+
"<head>\n"+
"  <title>See Our Events</title>\n"+
"</head>\n"+
"<body><div id=\"content\">testing</div></body>\n"+
"</html></div>";
var $content = $(content);
console.log($content.find('title').length); // Logs 1.
console.log($content.html());               // Logs subset of the source. Why? 
```

请也看一下 jsFiddle。它包含比我的代码更多的示例，以使帖子更易于阅读。

为什么我原本非常基本的选择器不返回`title`节点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:12:47.147

当您查看[jQuery 文档](http://api.jquery.com/jQuery/)时，您会看到一些关于使用`$()`函数创建新元素的解释。有一段特别说明了这里的问题：

> 在传递复杂的 HTML 时，某些浏览器可能无法生成完全复制所提供的 HTML 源的 DOM。如前所述，我们使用浏览器的 .innerHTML 属性来解析传递的 HTML 并将其插入到当前文档中。在此过程中，某些浏览器会过滤掉某些元素，例如`<html>`、`<title>`、 或`<head>`元素。因此，插入的元素可能不代表传递的原始字符串。

看起来您可能无法正确创建一些基本元素。在引用的段落上方，您可以阅读有关如何解析和创建字符串的信息。

我能够通过以下方式在 Chrome 22 上创建节点：

```
var node = document.createElement('html');
node.innerHTML = "<head><title>Test me</title></head><body><div><p>Test 2</p></div></body>" 
```

这创建了整个 DOM 节点并将其放入 jQuery 构造函数中允许我构建有效的 jQuery 对象，所以：

```
var nodeElem = $(node);
nodeElem.find('title'); //get 1 result 
```

这是在 Chrome 22 上完成的，但结果可能因浏览器而异。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:35:27.227

像这样的人是罪魁祸首

```
var $content = $(html); 
```

您将字符串存储在#content

而你需要做

```
var $content = $('html'); 
```

# javascript - 通过下拉菜单使用 Jquery 过滤“项目”

> ID：12610734
> 
> 赞同：0
> 
> 时间：2012-09-26T21:29:33.870
> 
> 标签：javascript, jquery, html, css

我目前在页面顶部有下拉列表，下面有一个长列表（83 行，每行 4 行）。

这是场景：

我从下拉列表中的状态列表中选择一个状态，列表中与状态不匹配的项目淡出，允许匹配的项目“弹出”到顶部。一旦你回到默认值，所有其他的都会淡出。

如果没有与某个州匹配的项目，我会显示一条消息“找不到选项”

我很确定我已经在某处的投资组合中看到过这样做，但我真的不知道如何实现这一点。有没有人知道如何实现这一点，或者可以指出我正确的方向？

```
<select id="filter" name="filter">
    <option value="-1">Filter items</option>
    <option value="sc">South Carolina</option>
    <option value="nc">North Carolina</option>
</select>

<div id="container">

<div class="box state-nc"></div>
<div class="box state-sc"></div>
<div class="box state-nc"></div>
<div class="box state-sc"></div>
<div class="box state-nc"></div>
<div class="box state-sc"></div>
<div class="box state-nc"></div>
<div class="box state-sc"></div>    
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:40:48.313

首先，为 83 个项目使用固定的宽度/高度并将它们全部浮动到左侧，因此它们自然地形成 4 个项目的行，并且当一些项目被隐藏时会重新流动（“弹出”）。

给每个项目一个类，如“state-ca”或“state-or”（或者如果您更喜欢 data-state="ca" 或 data-state="or"）。然后是这样的：

```
var $all_items = $('.item');
var state = $dropdown.val();
var $items = $('.item[class!="state-' + state + '"]');
// or this:
// var $items = $('.item[data-state!="' + state + '"]');
if ($items.size() == $all_items) {
  $all_items.fadeOut();
  // show "no options found" instead
} else {
  $all_items.show();
  $items.fadeOut();
} 
```

（未经测试，所以我相信您需要进行一些调整。）

# batch-file - 批处理文件如何读取文本文档并移动列出的目录？

> ID：12610742
> 
> 赞同：0
> 
> 时间：2012-09-26T21:30:02.880
> 
> 标签：batch-file

我有一个存储在名为*test_text.txt*的文件中的目录列表。我需要能够运行一个批处理文件，该文件将从文件中读取文本并将文本文档中列出的目录移动到新目录。任何帮助将不胜感激。

我的代码：

```
echo

FOR  /D %%I in (test_text.txt) do move C:\users\%username%\desktop\dumb

PAUSE 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:12:13.537

您正在寻找的是这个（假设 test_text.txt 中包含有效目录）：

```
SET LOGFILE=C:\logs\movelog.txt
REM Use /f to read the contents of a file, and %%i to reference the line you just read:
for /f %%i in (test_text.txt) do (
    move %%i C:\users\%username%\desktop\dumb >nul 2>&1
    if errorlevel 1 (
        echo %%i : Move failed >> %LOGFILE%%
    ) else (
        echo %%i : Move successful >> %LOGFILE%
    )
) 
```

**编辑**：添加错误处理/报告。请注意， >nul 2>&1 位用于抑制`move`.

**编辑 2**：向日志文件添加了显式重定向。

# f# - 我的匹配看起来很笨拙，有没有更好的编码方法？

> ID：12610745
> 
> 赞同：3
> 
> 时间：2012-09-26T21:30:13.820
> 
> 标签：f#, pattern-matching, option

这似乎有效，但似乎很笨重。有没有更好的编码方法？

```
// Hunting for the best index to use for a data compare
let getIndex connDB strTable =
    match getIndexByPrimaryKey connDB strTable with
    | Some(name) -> Some(name)  
    | None ->
    match getIndexByCluster connDB strTable with
    | Some(name) -> Some(name)
    | None -> 
    match getIndexByFirstColumns connDB strTable with
    | Some(name) -> Some(name)
    | None -> 
    match getIndexByOnlyUnique connDB strTable with
    | Some(name) -> Some(name)
    | None -> 
    match getAnyUniqueIndex connDB strTable with
    | Some(name) -> Some(name)
    | None -> None 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T21:37:53.123

可能最简洁的版本是使用[List.tryPick](http://msdn.microsoft.com/en-us/library/ee353814.aspx)：

```
let getIndex connDB strTable =
  [ getIndexByPrimaryKey;
    getIndexByCluster;
    getIndexByFirstColumns;
    getIndexByOnlyUnique;
    getAnyUniqueIndex; ]
  |> List.tryPick (fun fn -> fn connDB strTable) 
```

**更新：**

该技术可以很容易地扩展到使用闭包，因此它适用于具有不同参数的函数（`fun`也有很多 s :-)）：

```
let getIndex connDB strTable =
  [ fun () -> getIndexByPrimaryKey connDB strTable;
    fun () -> getIndexByCluster connDB strTable;
    fun () -> getIndexByFirstColumns connDB strTable;
    fun () -> getIndexByOnlyUnique connDB strTable;
    fun () -> getAnyUniqueIndex connDB strTable; ]
  |> List.tryPick (fun fn -> fn()) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T22:24:05.303

我认为最简洁的选择是将`getIndexByXYZ`操作定义为活动模式而不是函数。然后您可以编写以下模式匹配：

```
let getIndex connDB strTable = 
    match connDB, strTable with
    | IndexByPrimaryKey name 
    | IndexByCluster name 
    | IndexByFirstColumns name 
    | IndexByOnlyUnique name 
    | AnyUniqueIndex name -> Some(name) 
```

如果您仍然想在您没有对其进行模式匹配的上下文中使用程序其他部分中的函数，那么您可以将活动模式定义为简单的包装器：

```
let (|IndexByPrimaryKey|_|) (connDB, strTable) =
  getIndexByPrimaryKey connDB strTable 
```

遗憾的是，没有办法“自动”将函数转换为活动模式，但我认为如果您需要表达一些业务逻辑并希望它具有可读性，那么付出额外的努力是值得的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:50:31.593

我会写一个`orElse`函数。然后你可以这样做：

```
let orElse f = function
  | None -> f()
  | Some _ as x -> x

let getIndex connDB strTable =
  getIndexByPrimaryKey connDB strTable
  |> orElse (fun () -> getIndexByCluster connDB strTable)
  |> orElse (fun () -> getIndexByFirstColumns connDB strTable)
  |> orElse (fun () -> getIndexByOnlyUnique connDB strTable)
  |> orElse (fun () -> getAnyUniqueIndex connDB strTable) 
```

或者，如果您更喜欢“工作流”语法（并且经常需要这个），那么：

```
module OrElse =

  let bind f = function
    | None -> f()
    | Some x -> Some x

  let combine m1 m2 =
    m1 |> bind (fun () -> m2)

  type OrElseBuilder() =
    member x.Zero() = None
    member x.Return(v) = Some v
    member x.Bind(m, f) = bind f m
    member x.ReturnFrom(m) = m
    member x.Combine(m1, m2) = combine m1 m2
    member x.Delay(f) = f()

  let orElse = OrElseBuilder() 
```

会让你更简洁地陈述它：

```
open OrElse

orElse {
  return! getIndexByPrimaryKey connDB strTable
  return! getIndexByCluster connDB strTable
  return! getIndexByFirstColumns connDB strTable
  return! getIndexByOnlyUnique connDB strTable
  return! getAnyUniqueIndex connDB strTable
} 
```

由于您将相同的参数传递给每个函数，因此 pad 的解决方案可能尽可能简洁。这些解决方案解决了替换嵌套的一般问题`match x with Some _ as v -> v | None -> ...`。

### 编辑

扩展 Tomas 的想法，您可以将通用的活动模式用于“模式化”功能：

```
let (|FN|_|) f x = f x 
```

然后做：

```
match connDB, strTable with
| FN getIndexByPrimaryKey name -> Some name
| FN getIndexByCluster name -> Some name
| FN getIndexByFirstColumns name -> Some name
| FN getIndexByOnlyUnique name -> Some name
| args -> getAnyUniqueIndex args 
```

这需要对您的函数稍作改动：args 必须是元组形式。

# android - 线性布局没有分隔我添加的视图

> ID：12610746
> 
> 赞同：0
> 
> 时间：2012-09-26T21:30:20.570
> 
> 标签：android, android-layout

我有一个线性布局，我正在以编程方式向它添加新的孩子。但是，当我预计它们会在 y 轴上堆叠时，它们都在 z 轴上堆叠在一起。我错过了什么？

布局是：

features.xml（具有以下子项的容器）

*   特色标签.xml
*   特色标签.xml
*   特色标签.xml
*   特色标签.xml
*   特色标签.xml

# 精选.xml

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent" >

</LinearLayout> 
```

# 特色标签.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <Button
        android:id="@+id/featuredContentBtn"
        android:layout_width="fill_parent"
        android:layout_height="30dp"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:layout_alignParentRight="true"
        android:background="#ffffff" />

    <ImageView
        android:id="@+id/featuredContentImg"
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:layout_alignBottom="@+id/featuredContentBtn"
        android:layout_alignParentBottom="true"
        android:layout_alignParentLeft="true"
        android:visibility="invisible"
        android:contentDescription="Featured Content Image" />

    <ImageView
        android:id="@+id/tabGradient"
        android:layout_width="fill_parent"
        android:layout_height="10dp"
        android:layout_alignBottom="@+id/featuredContentBtn"
        android:layout_alignParentLeft="true"
        android:src="@drawable/featured_tab_gradient"
        android:contentDescription="Tab Gradient" />

</RelativeLayout> 
```

# 代码

*将特色标签添加到特色*

```
private void loadTabs() {
        Document doc = XMLParser.getDOM(Featured._xml);
        NodeList featuredNodes = doc.getElementsByTagName(Featured.TAG_FEATURE);

        this.removeAllViews();

        // loop through all featured nodes <Feature>
        for (int i = 0; i < featuredNodes.getLength(); i++) {
            FeaturedTab tab = (FeaturedTab)MainActivity.instance.getLayoutInflater().inflate(R.layout.featured_tab, null);
            Element element = (Element)featuredNodes.item(i);
            tab.setTitle(XMLParser.getValue(element, Featured.TAG_TITLE));
            tab.setImageURL(XMLParser.getValue(element, Featured.TAG_IMAGE_URL));
            tab.setLinkURL(XMLParser.getValue(element, Featured.TAG_LINK_URL));
            this.addView(tab);
        }       
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:14:02.153

`featured.xml`将您的实际更改为 a`LinearLayout`并给它一个 ID：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/featured_linear_layout"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

</LinearLayout> 
```

在您的代码中，获取该 LinearLayout 并以编程方式将其他布局添加到 id

```
LinearLayout featured = (LinearLayout)findViewById(R.id.featured_linear_layout);

for (int i = 0; i < featuredNodes.getLength(); i++) {
            FeaturedTab tab = (FeaturedTab)MainActivity.instance.getLayoutInflater().inflate(R.layout.featured_tab, null);
            Element element = (Element)featuredNodes.item(i);
            tab.setTitle(XMLParser.getValue(element, Featured.TAG_TITLE));
            tab.setImageURL(XMLParser.getValue(element, Featured.TAG_IMAGE_URL));
            tab.setLinkURL(XMLParser.getValue(element, Featured.TAG_LINK_URL));
            featured.addView(tab);
        } 
```

# c++ - 映射到二维向量

> ID：12610747
> 
> 赞同：3
> 
> 时间：2012-09-26T21:30:21.480
> 
> 标签：c++

我想创建一个 C++ 映射，其中键是，例如，`int`值是 2-D 向量`double`：

```
std::map<int, std::vector<vector<double>>> myMap; 
```

假设我填充了它，现在我想更新每个键映射的第二个向量（例如将每个元素除以 2）。我将如何迭代地访问该向量？下面语句中的“itr->second[0]”语法显然是错误的。该操作的正确语法是什么？

```
for(std::map<in, vector<vector<double> > > itr = myMap.begin(); itr != myMap.end();++itr)
{
    for(int i = 0;i < itr->second[0].size();++i)
    {
         itr->second[0][i] /= 2;
    }
} 
```

谢谢，鲁比

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:34:01.997

`itr->second`是 的一种`vector<vector<double>>`，因此在将单元格除以数字之前，您需要迭代“两级”索引。

```
for ....
{
    vector<vector<double>>& vv = itr->second;
    for(int i=0; i<vv.size(); ++i)
        for(int j=0; j<vv[i].size(); ++j)
            vv[i][j] /= 2
} 
```

我是否正确理解了您的问题？

编辑：编辑帖子后，代码几乎是正确的。您有一些拼写错误并且您的迭代器类型无效，请参阅（下面的代码至少在 mingw 中编译）

```
std::map<int,std::vector<std::vector<double> > > myMap;

for(std::map<int, std::vector<std::vector<double> > >::iterator itr = myMap.begin();
    itr != myMap.end();
    ++itr)
{
    for(int i = 0;i < itr->second[0].size();++i)
    {
         itr->second[0][i] /= 2;
    }
} 
```

请注意`::iterator`添加。一定不能`::const_iterator`因为地图要修改

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-04-21T08:03:35.093

我有一个解决方案，但有点不同

*   使用二维向量插入值
*   将该向量复制到地图中
*   使用另一个 2d 矢量从地图中复制内容并完成工作
*   将修改后的向量复制回地图

```
map<int,vector<vector<double>>> myMap;
vector<vector<double>>v;
v.push_back({7,8});
v.push_back({6,9,8});
myMap[0]=v;
for(auto i=myMap.begin();i!=myMap.end();i++)
{
   vector<vector<double>>v1=i->second;
   for(int j=0;j<v1.size();j++)
   {
      for(int k=0;k<v1[j].size();k++)v1[j][k]/=2;
   }
   i->second=v1;
} 
```

ps 我晚了 8 年

# c# - Ref 参数错误

> ID：12610755
> 
> 赞同：1
> 
> 时间：2012-09-26T21:30:47.050
> 
> 标签：c#, parameters, ref

```
 public Resultado Procesar_Respuesta_Estructurada(ref object ObjetoIN, ref string Login, string NombreMetodo)
    {
        int i = 0;
        Resultado ObjetoOUT = default(Resultado);
        bool Errors_Warning = false;
        Utilitarios OUtil = default(Utilitarios);
        try
        {

            OUtil = new Utilitarios();
            ObjetoOUT = new Resultado();

            ObjetoOUT.Success =  ObjetoIN.Success;
            ObjetoOUT.ExistWarnings = ObjetoIN.ExistWarnings;
            ObjetoOUT.Items = ObjetoIN.Items;

            if ((ObjetoIN.Errors != null) && ObjetoIN.Errors.Length > 0)
            {
                Errors_Warning = true; 
```

错误在 ObjetoIN.Success 中

错误 3“对象”不包含“成功”的定义，并且找不到接受“对象”类型的第一个参数的扩展方法“成功”（您是否缺少 using 指令或程序集引用？）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:32:46.527

这与`ref`. 的类型`ObjetoIN`指定为`object`。但是， object 没有名为的属性或字段`Success`，这就是错误消息告诉您的内容。您需要提供有效的类型`ObjetoIN`才能访问`Success`.

# perl - Perl 字符串到 Base36

> ID：12610758
> 
> 赞同：0
> 
> 时间：2012-09-26T21:31:14.703
> 
> 标签：perl

如何在 perl 中将字符串转换为 base36 (0-9,az)？

我想使用一对一的映射将 IP 地址转换为 base36，这样我就可以在 URL 中使用它们。

`127.0.0.1` === 字符串 ==> `127000000001`=== base36 ==>

`72.98.234.11` === 字符串 ==> `072098234011`=== base36 ==>

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:41:33.420

base 10还不够好吗？这给出了 [0-4294967295] 中的数字（1 到 10 位数字）。这仅比我们从您的方式（1 到 8 位数）中获得的内容稍长。

```
$ perl -E'say unpack "N", pack "C4", split /\./, $ARGV[0]' 127.0.0.1
2130706433

$ perl -E'say unpack "N", pack "C4", split /\./, $ARGV[0]' 72.98.234.11
1214441995 
```

完全可逆：

```
$ perl -E'say join ".", unpack "C4", pack "N", $ARGV[0]' 2130706433
127.0.0.1

$ perl -E'say join ".", unpack "C4", pack "N", $ARGV[0]' 1214441995
72.98.234.11 
```

您可以使用 CPAN 上的任意数量的模块将该数字转换为 10 以外的另一个基数。

```
base 10: 1-10 digits
base 16: 1-8 digits    # Can be done very efficiently
base 32: 1-7 digits    # Can be done very efficiently
base 36: 1-7 digits
base 62: 1-6 digits
base 64: 1-6 digits    # Can be done very efficiently 
```

基数 16：

```
sub pack_ip { sprintf "%X", unpack "N", pack "C4", split /\./, $_[0] }

sub unpack_ip { join ".", unpack "C4", pack "N", hex $_[0] } 
```

Base 64：（这应该很快。即使移植到 C 也更快。）

```
my @syms = ('0'..'9', 'A'..'Z', 'a'..'z', '_', '-');
my %syms = map { $sym[$_] => $_ } 0..$#syms;

sub pack_ip {
   my $num = unpack "N", pack "C4", split /\./, $_[0];
   my $base64 = join '', @syms[
      ($num >> 30) & 0x3F,
      ($num >> 24) & 0x3F,
      ($num >> 18) & 0x3F,
      ($num >> 12) & 0x3F,
      ($num >>  6) & 0x3F,
      ($num >>  0) & 0x3F,
   ];
   $base64 =~ s/^A+(?!\z)//;
   return $base64;
}

sub unpack_ip {
   my $num;
   $num = ($num << 6) | $sym{$_}
      for split //, $_[0];
   return join ".", unpack "C4", pack "N", $num;
} 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-09-26T22:24:39.687

为什么不使用基数 16，因为这基本上就是 IP 地址？

```
sub ip_to_hex {
  join('', map { sprintf('%02x', $_) } split(/\./, shift));
}

sub hex_to_ip {
  join('.', map { hex($_) } shift =~ m/([0-9a-f]{2})/g);
}

say ip_to_hex('127.0.0.1');    # 7f000001
say ip_to_hex('72.98.234.11'); # 4862ea0b
say hex_to_ip('4862ea0b');     # 72.98.234.11 
```

# sql-server - Microsoft Reporting Services 和 CSV 文件

> ID：12610762
> 
> 赞同：5
> 
> 时间：2012-09-26T21:31:31.553
> 
> 标签：sql-server, reporting-services

我管理一个数据仓库类型的应用程序，它连接的一个数据库即将由外部组织管理。外部组织正在设置 Microsoft Reporting Services，以允许我们为用户生成报告，以便他们能够查看数据。

该数据库托管在外部服务器上。我在测试环境中的 Microsoft Reporting Services 中设置了一个测试表单。

我对这项技术没有任何其他经验。我的问题是：这项技术是否使您能够生成 CSV 文件，还是必须在 Web 浏览器中查看信息？如果没有 Web 服务，我无法看到如何做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T22:02:36.513

是 SSRS（报告服务）具有将报告导出到这些类型文件的内置功能

*   XML
*   单词
*   CSV
*   MHTNK
*   Excel
*   PDF格式
*   蒂夫

![在此处输入图像描述](../Images/1c9a3ac78bb86f39bdbb360e38c3ebcf.png)

我还在管理一个可供客户访问的数据仓库。我们还提供报告服务托管服务

但是对于您的问题，如果您安装了报告服务，您可以连接到您希望的任何数据库（当然，如果您有权限）

要创建报告，您需要：

1.  数据源 - 告诉报告它将连接到某个服务器和某个数据库
2.  数据集 - 大多数时候保存来自对数据库的查询的信息
3.  设计报告

因此，当您创建数据源时，您可以提供 ant 服务器名称/IP 和任何数据库名称。（当然你必须有权限）

这是一张向您展示如何创建数据源的图片 ![在此处输入图像描述](../Images/ec1564ff9027717b22220ca1d9dac8a1.png)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:52:11.317

您似乎在问两个相关但不同的事情：

**Q1**：您能否以 X 格式生成（在您的问题中：X = CSV）。
**答**：是的，您可以导出为 CSV、XML、XLS、PDF、Word、Html 和 Tiff ( [MSDN](http://msdn.microsoft.com/en-us/library/dd239307.aspx#ExportFormats) )。请注意，报告必须针对您首选的导出方法进行定制，例如，如果您想获取 CSV，最好坚持只包含一个表格的简单报告，或者使用 XML，当所有控件变成元素时命名是相当重要的名字。

* * *

**Q2**：您如何查看/获取报告？是否必须在浏览器中查看？
**答**：有几种方法可以向最终用户和其他系统提供报告，包括：

*   [订阅](http://msdn.microsoft.com/en-us/library/ms159762.aspx)，通过电子邮件或 FTP 发送
*   通过[ReportViewer](http://msdn.microsoft.com/en-us/library/ms251671%28v=vs.80%29.aspx)（在 Web 应用程序或本机应用程序中）
*   “网络应用程序”的一个具体案例，通过[Sharepoint](http://msdn.microsoft.com/en-us/library/bb326358%28v=sql.105%29.aspx)设置
*   通过SSRS 提供的[Web 服务](http://msdn.microsoft.com/en-us/library/ms154052%28v=sql.105%29.aspx)
*   [直接使用报告管理器](http://msdn.microsoft.com/en-us/library/ms157147.aspx)中的（预）视图

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:51:26.137

如果您在谈论 SSRS，答案是**Yes**。

外部组织可以选择以两种方式之一实施 SSRS：独立或嵌入式。**独立**意味着报表将独立于它们可能拥有的任何 Web 应用程序或桌面应用程序运行。通过这种方式，他们设置了支持报告服务的 SQL Server。**嵌入式**意味着报表将从 Web 应用程序或桌面应用程序运行。

无论哪种方式，SSRS 都允许将报告导出为不同的格式：PDF、Excel、CSV。

[http://msdn.microsoft.com/en-us/library/dd239307.aspx](http://msdn.microsoft.com/en-us/library/dd239307.aspx)

# c - 将 char 数组的内容复制到另一个

> ID：12610767
> 
> 赞同：0
> 
> 时间：2012-09-26T21:31:51.693
> 
> 标签：c, arrays

如何将内容从一个字符缓冲区获取到另一个字符缓冲区？例如我有

```
char buffer[SMALLVALUE];
char new_buffer[BIGGERVALUE]; 
```

我想将内容复制`buffer`到`new_buffer`. 做到这一点的最短方法是什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T21:32:47.903

```
#include <string.h>

memcpy(new_buffer, buffer, sizeof buffer); 
```

# asp.net-mvc-4 - .NET Web API Post Action 返回空 JSON

> ID：12610771
> 
> 赞同：4
> 
> 时间：2012-09-26T21:32:10.333
> 
> 标签：asp.net-mvc-4, asp.net-web-api

我有一个像这样从 ControllerApi 继承的控制器（MVC 4）

```
public HttpResponseMessage<lightUserInfo> Post(LogOnModel model)
{
    if (ModelState.IsValid)
    {
            if (Membership.ValidateUser(model.UserName, model.Password))
            {
                MembershipUser user = Membership.GetUser(model.UserName);
                var userinfo = new lightUserInfo(user);
                return new HttpResponseMessage<lightUserInfo>(userinfo);
            }
    }
 } 
```

我可以看到对象 userinfo 填充得很好，这会向浏览器返回 200 OK ...但内容只是空 json {}

这是 CoffeeScript 中的客户端 ajax

```
$.ajax
  url: Meshable.rooturl + "/api/authentication"
  data:   JSON.stringify authenticationDetails    
  dataType: "json"
  type: "POST"
  contentType: 'application/json; charset=utf-8'
  error: (e) ->                     
  success: (data) ->
    #data comes in as empty {} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-28T20:17:02.567

不要假设 POCO 是最简单的情况，并且肯定会毫无问题地进行序列化。您必须正确标记它。包括

```
using System.Runtime.Serialization; 
```

然后像这样标记课程

```
[DataContract]
public class UserInfo
{
    [DataMember]
    public string mystr {get; set;}

} 
```

# symfony - Doctrine2 在获取的记录之前附加记录

> ID：12610773
> 
> 赞同：0
> 
> 时间：2012-09-26T21:32:13.317
> 
> 标签：symfony, doctrine-orm

我从表'disability_types'中获取所有类型（id、name）。在此之后，我需要在结果数组前面加上 id=-1 的新记录'all'。然后这些记录用于填充多项选择。我愿意：

```
$disabilityType = $this->getDoctrine()->getRepository("AldenBonBundle:DisabilityType")->findAll(); 
```

我试过了：

```
$item = new \Alden\BonBundle\Entity\DisabilityType();
$item->setAsAll();//set name and id
array_unshift($disabilityType, $item); 
```

但这给了我错误`Entities passed to the choice field must be managed`。经过一番研究，我尝试了

```
$disabilityType = $this->getDoctrine()->getEntityManager()->merge($item); 
```

但这会产生错误`Entity was not found`。

我应该如何将新的 $item 合并到 disableType ？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-04T00:05:32.330

您需要使用阵列水合，从而对阵列进行操作。

```
$query = $entityManager
             ->createQuery('SELECT d FROM AldenBonBundle\DisabilityType d');
$disabilityTypes = $query->getResult(Query::HYDRATE_ARRAY); 
```

现在`$disabilityTypes`变量是一个数组，你可以`array_unshift`等等。

# algorithm - 使用距 3 个不同点的距离找到我的位置的算法

> ID：12610774
> 
> 赞同：0
> 
> 时间：2012-09-26T21:32:13.890
> 
> 标签：algorithm, position

我正在尝试为机器人开发一种算法，该算法取机器人可见的三个不同点的距离，假设每个点都是圆心，距离是那个圆的半径，然后将机器人位置映射为这 3 个圆圈的交点。

我很难开发算法，即使是数学公式也会有所帮助。另外，我也有机器人和每个点之间的角度，但不知道在哪里使用它。

希望有人可以提供帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:45:23.857

假设这三个点没有对齐，你可以用它来验证

```
(y1 - y2)*(x1 - x3) != (y1 - y3)*(x1 - x2) 
```

如果 x1、x2 和 x3 都不同；如果其中两个相等而第三个不相等，则三个点当然*无法*对齐，您无需检查。

我们现在可以简化为一个已知的解决方案：

[https://math.stackexchange.com/questions/110309/three-circle-intersection-for-circles-of-unbounded-integer-radius](https://math.stackexchange.com/questions/110309/three-circle-intersection-for-circles-of-unbounded-integer-radius)

您的机器人将位于三个圆圈的交叉点。（额外字符允许我的 1 个字符编辑被接受）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:45:35.087

三边测量。[http://en.wikipedia.org/wiki/Trilateration](http://en.wikipedia.org/wiki/Trilateration)

# iframe - 用户单击选择文件时的事件？

> ID：12610777
> 
> 赞同：0
> 
> 时间：2012-09-26T21:32:25.857
> 
> 标签：iframe, onclick, filepicker.io

我正在使用基本的“打开小部件”

```
<input type="filepicker-dragdrop" id="jpeg_url" .... 
```

哪个有效。但是，当用户单击“选择文件”按钮时，是否有某种通知？

背景：Pick File 按钮位于自己的 iframe 中。通常只有 200px 高。所以 Filepicker.io 框是相当不可用的。iframe 能够控制自己的大小，因此当用户单击按钮时 - 想要使 iframe 更大。

我想可以将我自己的处理程序附加到文件选择器创建的文件上，

甚至注意 . 的存在，但这些看起来像黑客。

（或者甚至可以使用 Pick Files 和 Drag-Drop Pane API 重新创建整个界面，但小部件更简单）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T00:16:50.820

可能最简单的方法是通过属性将自定义类应用于小部件`data-fp-button-class`，然后使用 javascript 库来监听给定类的点击事件

# ios - Xcode 的 Profiler 不显示符号名称

> ID：12610779
> 
> 赞同：22
> 
> 时间：2012-09-26T21:32:40.710
> 
> 标签：ios, xcode, profile

更新到 xCode 4.5 并且在分析我的应用程序符号名称时不再显示类或对象，但显示内存地址见下文。

```
0x2fd42e13
0x38014448 
```

我曾经看到以下

```
main
NSManagedObjectContext 
```

当我可以看到类名时，我可以在扩展细节中追踪问题。现在扩展细节显示与 0x2fd42e13 相同的内容。

* * *

## 回答 #1

> 赞同：40
> 
> 时间：2017-05-14T17:46:30.770

为了解决我的问题，我不得不告诉 Instruments 我的二进制文件在哪里，因为它由于某种原因丢失了它的踪迹。

## 1.**像往常一样运行 Instruments 以获取屏蔽数据。**

[![在此处输入图像描述](../Images/b295c3e92bdd265e8ecd646fc3a11b7b.png)](https://i.stack.imgur.com/IzWw1.png)

## 2.**在 Project Navigator 中，展开 Products 文件夹并单击您的应用程序（提供程序 (.appex) 或应用程序 (.app)。如果您的文件检查器不可见，请右键单击该应用程序并单击“显示文件检查器”**

[![在此处输入图像描述](../Images/d9558b79fec8b38132338297707cc6af.png)](https://i.stack.imgur.com/0KBIV.png)

## 3.**在屏幕右侧，您现在应该可以看到二进制文件的文件检查器。对面单击“完整路径”属性，然后单击“复制”。**

[![在此处输入图像描述](../Images/94173f29f50347482d61bfb2be5e5192.png)](https://i.stack.imgur.com/mWTh8.png)

## 4.**回到仪器并转到`File->Symbols`**

[![在此处输入图像描述](../Images/c21f1cd4d2bf0006181bcd35c8d37a2e.png)](https://i.stack.imgur.com/IkMkg.png)

## 5.**在左侧下拉您的应用程序或提供程序，然后单击旁边带有点的项目（它应该与您的应用程序具有相同的名称）**

[![在此处输入图像描述](../Images/d0ca369fefe5cf0ecff72a0d5d4e0652.png)](https://i.stack.imgur.com/dEdCM.png)

## 6.**你会注意到二进制路径是红色的。这意味着 Instruments 丢失了您的二进制文件。单击右下角的小文件夹图标以弹出选择文件对话框。按`Command+Shift+G`输入目录路径，然后粘贴我们之前从 xcode 复制的路径。**

[![在此处输入图像描述](../Images/6f6d0a41ffa57895907c0f8e019813e0.png)](https://i.stack.imgur.com/ezmue.png)

## 7.**您现在应该选择了二进制文件，点击`Open`打开它。单击对话框上的完成以关闭窗口。Instruments 现在应该在分析代码时显示正确的详细信息和符号名称。**

[![在此处输入图像描述](../Images/43236b1cfb9ee92bb7b40ae0be3e1d9e.png)](https://i.stack.imgur.com/zDRYg.png)

8.  **如果再次出现这种情况，并且您的二进制文件位于类似 的路径`/Users/<User>/Library/Developer/Xcode/DerivedData/...`中，则需要将其添加到 Instruments 中的默认搜索路径中。`/Library`不被 Spotlight 索引，因此不被 Instruments 搜索。转到 Instruments > Preferences > Symbols，然后添加`/Users/<User>/Library/Developer/Xcode/DerivedData/`.**

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2012-09-27T01:10:17.033

自己解决了：

编辑您的方案，其中显示“WhateverProjectNameIs>iPad 6.0 模拟器”

然后点击左侧的“ **Profile** ” 在 Info 选项卡上，将 Build Configuration 更改为 Debug（可能设置为 Release）应该可以了。请注意，无论出于何种原因，构建目标都没有设置为与配置文件目标相同的构建配置，这让我绊倒了一两次以上。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-23T12:33:12.593

分析调试配置不会为您提供正确的配置文件值。调试配置不是为了速度而编译的，你所有的 NSLog 语句都还在。

我创建了一个“配置文件”构建配置来处理这个问题。请参阅[我](https://stackoverflow.com/a/13528694/908621)对类似 Stackoverflow 问题的回答。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-18T11:08:57.320

我也有同样的问题，我尝试了其他人建议的所有步骤。但他们都没有为我解决这个问题。所以，我所做的是，我只是打开按钮`Instruments`旁边的和`Record`，单击下拉菜单并选择使用`Choose target`选项的目标。然后点击`Record`按钮，现在我可以在仪表板中看到所有方法:)

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2016-02-05T13:12:48.113

我知道这是一个老问题，但上面提到的解决方案都不适合我。我需要切换到最新的 iOS 模拟器（当前使用 iOS 9 而不是 iOS 8）才能正确显示符号名称。我认为 Xcode Instruments 只能与运行最新 iOS SDK 的模拟器一起使用。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2016-04-15T09:16:59.873

重新启动仪器和 Xcode 解决了我的问题:(

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2016-02-01T20:02:08.643

我遇到了同样的问题，并尝试了其他解决方案无济于事。Scheme问题通常是问题所在，所以我从那里开始。但就我而言，它已经正确配置。这是最终对我有用的方法：

*   在 Instruments 中，如果进程正在运行，请停止该进程。
*   转到文件 -> 符号，然后在 dSYM 路径下，找到未被符号化的库。
*   就我而言，它指向垃圾箱中的项目。所以我清空了垃圾箱，删除了 Derived Data 文件夹中的模块缓存和项目，当我重建项目时，它又开始工作了。在您的情况下，它可能指向其他一些不存在或仪器无法访问的文件。

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2017-03-26T07:19:38.180

将构建路径重置为默认值。我之前已将其更改为 tmp/ 文件夹，并且符号无法显示代码。重置此路径后，分析器可以显示正确的代码。构建路径（相对于派生数据）设置如下： [![构建路径](../Images/ca98a31f45b44b7cda3c87f54c2040b7.png)](https://i.stack.imgur.com/Auc7R.png)

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-04-22T12:11:23.557

我在 Xcode 11.4 中遇到同样的问题 1\. 在构建成功时在 Xcode 中显示您的 YOUR_PROJECT.app 文件夹，找到 Release-iphoneos 或 Debug-iphoneos 文件夹，根据您的配置文件的构建设置选择哪个。通常我们选择Release-iphoneos。2\. 在【Preferences】->【Symbols】中将该路径添加到 Instruments 中，搜索 YOUR_PROJECT.app.dSYM 文件。

[![在此处输入图像描述](../Images/22bef06b3d520b17efff87fc264c94f4.png)](https://i.stack.imgur.com/B1Bgp.png)

# objective-c - 使用 UITableViewCell 子类执行“-layoutSubviews”后仍需要自动布局

> ID：12610783
> 
> 赞同：115
> 
> 时间：2012-09-26T21:32:52.060
> 
> 标签：objective-c, ios, xcode4.5, autolayout

使用 XCode 4.5 和 iOS 6，我正在开发一个带有自定义单元格的简单表格视图的应用程序。我在 iOS 5 及更低版本中已经这样做了一百次，但由于某种原因，新的 autoLayout 系统给我带来了很多麻烦。

我在 IB 中设置了我的表格视图和原型单元，添加了子视图并将它们连接为 IBOutlets，然后设置了我的委托和数据源。但是，现在每当从 获取第一个单元格时`cellForRowAtIndexPath`，我都会收到以下错误：

> *** -[ShopCell layoutSublayersOfLayer:] 中的断言失败，/SourceCache/UIKit_Sim/UIKit-2372/UIView.m:5776
> 
> *** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“执行 -layoutSubviews 后仍需要自动布局。ShopCell 的 -layoutSubviews 实现需要调用 super。

我没有在我的子类单元（ShopCell）中实现 -layoutSubviews 方法，即使我尝试这样做并添加超级调用，因为它表明我仍然得到相同的错误。如果我从 IB 中的单元格中删除子视图，并将其更改为标准 UITableViewCell，一切都会按预期工作，当然我的单元格中没有数据。

我几乎可以肯定我缺少一些简单的东西，但是找不到任何文档或指南来表明我做错了什么。任何帮助，将不胜感激。

**编辑：**刚刚尝试将其更改为 IB 中的 UITableViewCell 并保留所有子视图，仍然是相同的错误。

* * *

## 回答 #1

> 赞同：57
> 
> 时间：2012-09-27T22:42:33.093

我在代码中手动添加约束时遇到了同样的问题。在代码中，我正在执行以下操作：

```
{
    [self setTranslatesAutoresizingMaskIntoConstraints:YES];
    [self addSubview:someView];
    [self addSubview:someOtherView];
    [self addConstraint:...];
} 
```

**假设**

据我所知，问题是当你禁用时`translatesAutoresizingMaskIntoConstraints`， UITableViewCell 开始使用 Auto Layout 并且自然会失败，因为底层实现`layoutSublayersForLayer`不调用 super. 使用 Hopper 或其他工具的人可以确认这一点。由于您使用的是 IB，您可能想知道为什么这是一个问题……那是因为使用 IB 会自动禁用`translatesAutoresizingMaskIntoConstraints`它添加约束的视图（它会自动在它们的位置添加宽度和高度约束）。

**解决方案**

我的解决方案是将所有内容移至`contentView`.

```
{
   [self.contentView addSubview:someView];
   [self.contentView addSubview:someOtherView];
   [self.contentView addConstraint:...];
} 
```

我不能 100% 确定这是否会在 Interface Builder 中工作，但如果你将所有东西都从你的单元格中推出（假设你直接在上面有东西），那么它应该可以工作。希望这对你有帮助！

* * *

## 回答 #2

> 赞同：53
> 
> 时间：2012-10-17T18:51:59.630

显然，UITableViewCell 的 layoutSubviews 实现没有调用 super，这是自动布局的问题。我很想看看将以下类别放入项目中是否可以解决问题。它有助于测试项目。

```
#import <objc/runtime.h>
#import <objc/message.h>

@implementation UITableViewCell (FixUITableViewCellAutolayoutIHope)

+ (void)load
{
    Method existing = class_getInstanceMethod(self, @selector(layoutSubviews));
    Method new = class_getInstanceMethod(self, @selector(_autolayout_replacementLayoutSubviews));

    method_exchangeImplementations(existing, new);
}

- (void)_autolayout_replacementLayoutSubviews
{
    [super layoutSubviews];
    [self _autolayout_replacementLayoutSubviews]; // not recursive due to method swizzling
    [super layoutSubviews];
}

@end 
```

我可能会添加在表格单元格上使用 backgroundView 时出现的问题，因为它会作为子视图添加到单元格中（而大多数子视图应该添加到表格单元格的 contentView 中，这通常应该会更好）。

**注意：**这个错误似乎在 iOS7 中已修复；我能够删除此代码，或者至少添加一个运行时检查，以便仅在 iOS6 上运行时完成。

* * *

## 回答 #3

> 赞同：33
> 
> 时间：2013-02-28T15:45:05.303

我有几个月的同样的错误。但我发现了问题所在。

当我创建一个 IB 文件时，`UIView`已经添加了一个。如果您使用此视图，当禁用自动布局时应用程序不会崩溃（但还有其他问题）。当您使用自动布局时，您必须在对象库中选择**正确**`UITableViewCell`的视图： 。

实际上，您应该**始终**使用此项目，因为所有子视图都添加`contentView`到`UITableViewCell`.

就这样。一切都会好起来的。

* * *

## 回答 #4

> 赞同：17
> 
> 时间：2014-12-05T09:56:09.240

我在使用自定义`UITableViewHeaderFooterView`+ xib 时遇到了同样的问题。

我在这里看到了一些答案，但我发现`-layoutSubviews`我的自定义页脚视图类中的实现解决了问题：

```
-(void)layoutSubviews
{
    [super layoutSubviews];
    [self layoutIfNeeded]; // this line is key
} 
```

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2013-05-30T06:09:23.780

我看到这是在我的 layoutSubviews 实现中修改约束的结果。将调用 super 从方法的开头移动到结尾解决了这个问题。

* * *

## 回答 #6

> 赞同：15
> 
> 时间：2014-10-17T17:55:51.690

在 iOS 7 中遇到了同样的问题（iOS 8 似乎已修复）。`[self.view layoutIfNeeded]`我的解决方案是在我的方法结束时调用`viewDidLayoutSubviews`。

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2013-04-05T22:06:13.600

我遇到过同样的问题。问题在于我创建单元格 Xib 的方式。我像往常一样创建了一个 Xib，只是将默认“UIView”的类型更改为我的自定义 UITableViewCell 类。正确的做法是先删除默认视图，然后将表格视图单元格对象拖到xib上。更多细节在这里：[http ://allplayers.github.io/blog/2012/11/18/Custom-UITableViewCell-With-NIB/](http://allplayers.github.io/blog/2012/11/18/Custom-UITableViewCell-With-NIB/)

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2014-11-11T12:59:43.330

我有一个类似的问题，`UITableViewCell`而不是它`UITableView`本身。因为这是谷歌的第一个结果，所以我会在这里发布。原来这`viewForHeaderInSection`就是问题所在。我创建了一个`UITableViewHeaderFooterView`并设置`translatesAutoresizingMaskIntoConstraints`为`NO`. 现在有趣的部分来了：

**IOS 7：**

```
// don't do this on iOS 7
sectionHeader.translatesAutoresizingMaskIntoConstraints = NO; 
```

如果我这样做，应用程序会崩溃

> 执行 -layoutSubviews 后仍需要自动布局。UITableView 的-layoutSubviews 实现需要调用super。

好的，我认为您不能在表格视图标题上使用自动布局，而只能在子视图上使用。但这并不是你稍后看到的全部真相。**总结一下：不要在 iOS 7 上禁用标题的自动调整大小掩码。**否则它工作正常。

**iOS 8：**

```
// you have to do this, otherwise you get an auto layout error
sectionHeader.translatesAutoresizingMaskIntoConstraints = NO; 
```

如果我不使用它，我会得到以下输出：

> 无法同时满足约束。

**对于 iOS 8，您必须禁用标题的自动调整大小掩码。**

不知道为什么它会以这种方式运行，但似乎 Apple 确实在 iOS 8 中修复了一些问题，并且自动布局在 iOS 7 和 iOS 8 上的工作方式不同。

* * *

## 回答 #9

> 赞同：7
> 
> 时间：2013-02-14T11:11:04.370

我通过关闭自定义表格视图单元格的所有子视图的“自动布局”解决了这个问题。

在自定义单元格的 xib 中，选择一个子视图并取消选中 File Inspector > Interface Builder Document > Use Autolayout

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2014-01-30T20:39:16.250

正如上面有人已经说过的，当您创建用于 UITableView 的视图时，您必须删除默认创建的视图并将 UITableViewCell 或 UITableViewHeaderFooterView 作为根视图。**但是，如果您错过了该部分，有一种方法可以修复 XIB。**您必须在文本编辑器中打开 XIB 文件，并在根标签及其直接子标签中将属性添加/更改`translatesAutoresizingMaskIntoConstraints`为`YES`，例如

`<view contentMode="scaleToFill" horizontalHuggingPriority="1000" id="1" translatesAutoresizingMaskIntoConstraints="YES" customClass="MXWCollapsibleTableHeaderView">`

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2013-02-28T17:00:41.907

我遇到了这个问题，它似乎与作为原型单元格的 UITableViewCell 子类有关，其中专门添加了其他自定义 UIView 子类。我在这里强调“自定义”，因为我已经成功地使用了只有 UIKit 子级的单元格，但是在尝试为我创建的定制视图构建约束时它失败了，抛出了作者问题中所述的错误。

我不得不将我的单元格分成不使用 AutoLayout 的独立笔尖。

让我们希望 Apple 收拾这个烂摊子。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2013-05-28T15:12:28.113

将您的子视图添加到单元格的 contentView 而不是单元格本身。所以而不是：

`[self addSubview:someView];`

你必须使用

`[self.contentView addSubview:someView];`

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2014-07-28T14:26:09.093

我没有为这个问题找到任何适当的解决方案，但您可以通过使用框架来修复它，而不是将 translatesAutoresizingMaskIntoConstraints 属性设置为 No（默认情况下是，所以不要设置它）

```
CGRect headerViewFrame = CGRectMake(0,0,320,60); //Frame for your header/footer view
UIView *tableHeaderView = [[UIView alloc] initWithFrame:headerViewFrame];
tableHeaderView.translatesAutoresizingMaskIntoConstraints = Yes; //Or don't set it at all
[self.tableView setTableHeaderView:tableHeaderView]; 
```

* * *

## 回答 #14

> 赞同：1
> 
> 时间：2013-03-22T03:57:38.823

`backgroundView`我通过将连接器与我的背景`UIImageView`和`accessoryView`连接器从我的自定义项中解耦来消除此错误`UIButton`。我怀疑这些并不是我使用它们的方式。

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2013-04-16T23:06:41.407

我今天第一次遇到这个问题。到目前为止，我在使用原型 UITableViewCell 子类方面有一些不同的经验，但从未遇到过这个问题。我正在使用的单元格的不同之处在于我有一个连接到 -backgroundView 的 IBOutlet，我用它来为单元格着色。我发现如果我创建了一个新属性并仍然添加了一个新的 UIView 来拉伸整个单元格的跨度，那么这个断言就消失了。为了验证这是原因，我回到将这个视图附加到 backgroundView 出口并且断言再次出现。到目前为止，自从我进行了此更改以来，在子类原型 UITableViewCell 中使用 AutoLayout 没有其他问题。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2013-02-25T15:59:17.190

我遇到这个是因为我最初将 UIView 而不是 UITableViewCell 添加到 xib 文件中。

* * *

## 回答 #17

> 赞同：0
> 
> 时间：2014-07-28T20:20:04.473

这个问题可能是由于忘记调用`[super viewDidAppear:]`within引起的`viewDidAppear`，但我确信这不是唯一的原因。

* * *

## 回答 #18

> 赞同：0
> 
> 时间：2013-09-18T23:11:30.680

在某些情况下，这很容易解决布局问题（取决于您的布局）。在你的 UITableView 子类中，在 awakeFromNib 或 init 中，设置自动调整掩码：

```
self.contentView.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleHeight; 
```

默认设置为 UIViewAutoresizingNone

* * *

## 回答 #19

> 赞同：0
> 
> 时间：2015-02-09T06:35:54.047

我去了也有同样的问题。我去了我的 DetailViewController 并将标识符重命名为 UIView。它以前在 UITableView 上。它解决了这个问题。这个问题不必在您的 DetailViewController 中。它可以在任何其他的。尝试将其重命名为受尊重的标识符。

* * *

## 回答 #20

> 赞同：0
> 
> 时间：2014-07-05T11:34:25.947

我找到了解决方案。

在我的例子中，我在情节提要中创建了单元格的视图（启用了自动布局），并在我的 ViewController.m 中定义了自定义 UITableViewCell 接口，我必须将接口移动到 ViewController.h。

* * *

## 回答 #21

> 赞同：0
> 
> 时间：2014-09-19T02:01:48.690

我有完全相同的问题。这是我的项目的问题：
当我在 Interface Builder 上创建自定义 UITableViewCell 时，我从 Xcode 的对象集合窗格中拖动了一个*View*而不是*Table View Cell*
作为自定义表格单元格。
如果您遇到同样的情况，解决方案如下：
删除界面构建器中的视图，确保从对象集合窗格中拖动一个表格视图单元格并重做自定义表格单元格视图。您可以复制旧视图中的对象并将它们粘贴到新表格视图单元格的画布上。

* * *

## 回答 #22

> 赞同：0
> 
> 时间：2015-03-05T13:40:13.400

我对 IB 中的静态表格视图单元格有类似的问题。其中一个单元格有一个子视图，该子视图的类被错误地更改为 UITextfield 的子类。编译器没有给出任何警告/错误。但是在运行时，系统无法加载视图控制器，导致上述崩溃。

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2015-03-16T12:52:27.297

问题是对子视图的布局调用的顺序：

[查看](https://stackoverflow.com/a/29077172/4299011)

在**iOS < 8中显示**

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-07-16T06:29:07.527

我在使用情节提要创建自定义 UITableViewCell 时遇到了同样的问题。幸运的是我发现了问题，因为我将附件视图（[UITableViewCell setAccessoryView:]）输出到我添加到单元格的 UIButton 。

> 所以它发生在我在iOS6上运行的项目中。

**解决方案**

> 我释放了附件视图和包含自定义单元格的按钮之间的插座。

**提议**

> 您不应该使用 UITableViewCell 的原生元素并对其进行更改。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2014-10-16T09:54:04.703

我在 Xcode 6、iOS 7+ 中设置的表格页脚视图有一个非常相似的问题。解决方案采用 nib 文件的格式。显然它被困在 Xcode 4 格式或什么的。将文件设置更改为“打开方式：Xcode 6.0”（或默认），立即修复它。偶然找到了解决方案：这让我发疯，所以我删除了整个文件并再次创建，显然是使用默认设置。我不知道为什么在最新的 Xcode 中简单地编辑文件并没有像通常发生的那样将其转换为 Xcode 5+ 格式。

![F](../Images/2ab49dd74c3ad7ded05c5da278a23a35.png)

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2015-03-19T09:52:50.170

解决方案：在调用super layoutSubviews之前改变约束

```
- (void)layoutSubviews
{

    [self _updateConstraints];

    [super layoutSubviews];
} 
```

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2012-10-03T18:13:58.913

我一直在经历同样的事情。事实证明，如果您以编程方式从 ShopCell .xib/storyboard 添加一个使用自动布局的子视图，作为另一个视图的子视图，则可能会引发该异常，具体取决于您的约束配置方式。我的猜测是，在 IB 中创建的约束是在以编程方式将视图添加为子视图时造成麻烦的原因，因为它会维护来自 viewA --> viewB 的约束，同时您可以将 viewB 添加为 viewC 的子视图。你明白了吗（那句话甚至让我自己困惑）？

在我的情况下——因为它是导致问题的非常简单的视图——我以编程方式而不是在 IB 中创建了视图。那解决了它。您可以将这些视图提取到其他 xib 文件并禁用这些视图的自动布局。我想那会奏效。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2013-09-23T09:07:47.620

就我而言，

UITableView 的自动布局引用的 UIImageView 被分配给 UITableView 的 backgroundView。

```
self.tableView.backgroundView = self.tableBackgroundImageView; 
```

因此，我从 UIView（根视图）中删除了用于 backgroundView 的 UIImageView 并重置（删除）对该 UIImageView 的所有自动布局引用。我将 UIImageView 作为背景放置在 UIView（根视图）的外部。然后在代码中赋值给UITableView的backgroundView。

然后固定。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2015-08-21T22:41:18.113

I modified [Carl Lindberg's answer](https://stackoverflow.com/a/12941256/426794) to override `UITableView` instead and it started working for me:

**UITableView+AutoLayoutFix.h**

```
@interface UITableView (AutoLayoutFix)
@end 
```

**UITableView+AutoLayoutFix.m**

```
#import <objc/runtime.h>

@implementation UITableView (AutoLayoutFix)

+ (void)load
{
    Method existingMethod = class_getInstanceMethod(self, @selector(layoutSubviews));
    Method newMethod = class_getInstanceMethod(self, @selector(_autolayout_replacementLayoutSubviews));

    method_exchangeImplementations(existingMethod, newMethod);
}

- (void)_autolayout_replacementLayoutSubviews
{
    [super layoutSubviews];
    [self _autolayout_replacementLayoutSubviews]; // not recursive due to method swizzling
    [super layoutSubviews];
}

@end 
```

Then in `MyViewController.m` I just imported the category:

```
#import "UITableView+AutoLayoutFix.h" 
```

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2016-08-25T03:00:27.310

我遇到了同样的问题，最后发现**原因**是我给 UITableViewCell 添加了一个约束，应该是 UITableViewCell 的**contentView**。当我更改约束时，一切都很好！

* * *

## 回答 #31

> 赞同：-1
> 
> 时间：2013-12-26T19:22:27.130

我有同样的问题，从 UIView 更改为 UITableViewCell 解决了这个问题。

# python - 没有“Python.app”的 Python GUI 应用程序？

> ID：12610785
> 
> 赞同：1
> 
> 时间：2012-09-26T21:33:00.553
> 
> 标签：python, wxpython, tkinter

我最近开始使用 Tkinter，现在我想尝试 wxPython，但我有一个主要问题：在 Mac 上，Python 应用程序启动并运行 gui。我正在使用鸭嘴兽，所以 window 已经有一个应用程序可以“附加”到自己。为什么它也需要 Python.app？有没有办法解决这个问题？这种方法感觉就像在 Mac 上的 X11 内的 Wine 中运行 Windows 应用程序一样“组合在一起”。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:57:11.980

您为这项工作使用了错误的工具。Platypus 的全部意义在于它可以将非 GUI 脚本转换为 GUI 应用程序。“应用程序”和“窗口”对脚本是不可见的，它认为它只是通过 sys.argv 接收内容并写入标准输出。

[Platypus 文档](http://sveinbjorn.org/files/manpages/PlatypusDocumentation.html)明确指出，Platypus “并非旨在用于创建具有复杂用户交互的大量 Mac OS X 应用程序”。

wxPython 文档到处都说您应该使用 py2app（例如，[http:](http://wiki.wxpython.org/Optimizing%20for%20Mac%20OS%20X) //wiki.wxpython.org/Optimizing%20for%20Mac%20OS%20X ）在 Mac 上构建 wx 应用程序。（您可能会发现一些过时的文档提到了 BundleBuilder，但请忽略它。）

如果您真的知道自己在做什么，也许您可​​以忽略两个不同软件包的文档，并强制它们一起做您想做的事情，但除此之外，为什么还要尝试呢？

如果你想打包一个知道它的 GUI 的 GUI 应用程序——无论它是 TkInter、wx 还是其他东西——这样做的方法是使用[py2app](http://svn.pythonmac.org/py2app/py2app/trunk/doc/index.html)。无需学习本教程之外的任何内容，您就可以将 wxPython（或 PyQt 或 TkInter 或其他）脚本转换为可双击的 Mac 应用程序。而且您几乎可以根据需要对其进行自定义（导出 UTI、将图标分配给文件类型……）。wxPython 的文档已经告诉你怎么做。

顺便说一句，我怀疑这里的部分问题是您不知道 OS X 应用程序和 Unix 可执行文件之间的区别。但如果你坚持使用跨平台工具包（如 wx）和 py2app，你可能会侥幸逃脱。

# sql - INSERT INTO sql server 错误：对象名无效

> ID：12610787
> 
> 赞同：3
> 
> 时间：2012-09-26T21:33:07.260
> 
> 标签：sql, sql-server

我有这个 INSERT 语句：

```
INSERT INTO TBL_VIDEOS (
  TBL_VIDEOS.ID,
  TBL_VIDEOS.TITLE,
  TBL_VIDEOS.V_DESCRIPTION,
  TBL_VIDEOS.UPLOAD_DATE,
  TBL_VIDEOS.V_VIEWS,
  TBL_VIDEOS.USERNAME,
  TBL_VIDEOS.RATING,
  TBL_VIDEOS.V_SOURCE,
  TBL_VIDEOS.FLAG
) 
VALUES 
('Z8MTRH3LmTVm',
'Why Creativity is the New Economy',
'Dr Richard Florida, one of the world&#39;s leading ...
    this stuff does not matter, it is just wasted space',
CURRENT_TIMESTAMP,
0,
1,
0,
'http://www.youtube.com/watch?v=VPX7gowr2vE&feature=g-all-u'
,0) 
```

但我收到此错误消息：

> 无效的对象名称“TBL_VIDEOS”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:37:15.613

`TBL_VIDEOS`从此部分中删除

```
INSERT INTO TBL_VIDEOS (
  TBL_VIDEOS.ID,
  TBL_VIDEOS.TITLE,
  TBL_VIDEOS.V_DESCRIPTION,
  TBL_VIDEOS.UPLOAD_DATE,
  TBL_VIDEOS.V_VIEWS,
  TBL_VIDEOS.USERNAME,
  TBL_VIDEOS.RATING,
  TBL_VIDEOS.V_SOURCE,
  TBL_VIDEOS.FLAG
) 
```

应该

```
INSERT INTO TBL_VIDEOS (
  ID,
  TITLE,
  V_DESCRIPTION,
  UPLOAD_DATE,
  V_VIEWS,
  USERNAME,
  RATING,
  V_SOURCE,
  FLAG
  ) 
```

你可以调查一下，任何你有类似内容的地方都`world's leading experts`应该改成`world''s leading experts`. 通过两次单引号，您正在转义单引号

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:43:09.457

您需要转义描述中的单引号：“世界领先的专家之一”

我不认为在这种情况下表的名称是一个问题，但它们是多余的。

以下将起作用：

```
create table TBL_VIDEOS (
ID nvarchar(100), TITLE nvarchar(100), V_DESCRIPTION nvarchar(2000), UPLOAD_DATE nvarchar(100), V_VIEWS nvarchar(100), USERNAME nvarchar(100), RATING nvarchar(100), V_SOURCE nvarchar(100), FLAG nvarchar(100)
)

INSERT INTO TBL_VIDEOS ( 

 TBL_VIDEOS.ID, TBL_VIDEOS.TITLE, TBL_VIDEOS.V_DESCRIPTION, TBL_VIDEOS.UPLOAD_DATE, TBL_VIDEOS.V_VIEWS, TBL_VIDEOS.USERNAME, TBL_VIDEOS.RATING, TBL_VIDEOS.V_SOURCE, TBL_VIDEOS.FLAG) 

VALUES 

('Z8MTRH3LmTVm', 'Why Creativity is the New Economy', 'Dr Richard Florida, one of the world' + CHAR(39) + 's leading experts on economic competitiveness, demographic trends and cultural and technological innovation shows how developing the full human and creative capabilities of each individual, combined with institutional supports such as commercial innovation and new industry, will put us back on the path to economic and social prosperity.

Listen to the podcast of the full event including audience Q&A: http://www.thersa.org/events/audio-and-past-events/2012/why-creativity-is-the-new-economy

Our events are made possible with the support of our Fellowship. Support us by donating or applying to become a Fellow.

Donate: http://www.thersa.org/support-the-rsa Become a Fellow: http://www.thersa.org/fellowship/apply', CURRENT_TIMESTAMP, 0, 1, 0, 'http://www.youtube.com/watch?v=VPX7gowr2vE&feature=g-all-u' ,0) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-03-26T04:57:32.763

确保您添加了：USE Name_Of_Your_Database

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-08-11T00:52:10.557

在我的情况下，SQL Server 不喜欢对 COLUMNS 部分使用单引号，也不喜欢对 VALUES 部分使用双引号。

**错误的**

```
INSERT INTO [sample].[dbo].[users]
('username', 'password')
VALUES('hello', 'hello')

INSERT INTO [sample].[dbo].[users]
("username", "password")
VALUES("hello", "world") 
```

**正确的**

```
INSERT INTO [sample].[dbo].[users]
("username", "password")
VALUES('hello', 'world') 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-07-26T17:55:03.230

尝试硬刷新 Ctrl+Shift+R

您可能不得不允许 SSMS 在刚刚创建表后识别它。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2022-02-11T08:59:52.037

在我的情况下，SQL 在尝试使用以下语句插入值时给出了“无效的对象名称”错误消息：

```
IF NOT EXISTS (SELECT 1 FROM [DatabaseName].[SchemaName].[TableName] 
WITH (NOLOCK) WHERE col1 = val1)
BEGIN
  INSERT INTO [SchemaName].[TableName] (col1, col2,col3) 
  Values(val1, val2, val3)
END 
```

为避免此错误，我使用以下语句将记录插入表中：

```
IF NOT EXISTS (SELECT 1 FROM [DatabaseName].[SchemaName].[TableName] 
WITH (NOLOCK) WHERE col1 = val1)
BEGIN
   INSERT INTO SchemaName.TableName (col1, col2,col3) 
   Values(val1, val2, val3)
END 
```

# java - 在标准 Java 中迭代 XML DOM 文档

> ID：12610789
> 
> 赞同：1
> 
> 时间：2012-09-26T21:33:18.417
> 
> 标签：java, xml, dom, xerces

`Java`标准( `J2SE`) 6（没有`JDOM`或其他第三方库）中是否有[Apache Xerces](http://xerces.apache.org/) `XML DOM`文档解析和迭代类的直接替代品？使用`Sun` `J2SE` `XML`实现，即

```
com.sun.org.apache.xerces.internal.dom.DocumentImpl
com.sun.org.apache.xerces.internal.dom.NodeIteratorImpl
com.sun.org.apache.xerces.internal.parsers.DOMParser 
```

导致编译器警告每次使用这些类“都是 Sun 专有的 API，可能会在未来的版本中被删除”。

我目前用于实例化通用`NodeIterator`对象的代码是

```
org.w3c.dom.Document document = ...; // Get an XML DOM Document object

org.w3c.dom.NodeIterator iterator = new NodeIteratorImpl(new DocumentImpl(
    document.getDoctype()), document.getDocumentElement(),
    NodeFilter.SHOW_ALL, null, true); 
```

以深度优先搜索顺序`NodeIterator`访问文档的节点`XML DOM`，这对我的应用程序至关重要，因此需要将上面的代码替换为功能等效的代码。

此外，创建新`org.w3c.dom.Document`对象的最佳（=标准和最快）方式是否类似于

```
Document = DocumentBuilderFactory.newInstance().newDocumentBuilder.parse(source) 
```

`source`正确实例化的`org.xml.sax.InputSource`对象在哪里？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:01:27.127

这`NodeIterator`是 DOM 遍历规范的一部分。[您可以通过测试它是否为instanceof](http://docs.oracle.com/javase/1.5.0/docs/guide/plugin/dom/org/w3c/dom/traversal/DocumentTraversal.html)来检查特定是否`Document`支持遍历（JRE中的标准实现应该是）。如果是这样，你可以施放它并做[`org.w3c.dom.traversal.DocumentTraversal`](http://docs.oracle.com/javase/1.5.0/docs/guide/plugin/dom/org/w3c/dom/traversal/DocumentTraversal.html)

```
NodeIterator ni = ((DocumentTraversal)document).createNodeIterator(
      document.getDocumentElement(), NodeFilter.SHOW_ALL, null, true); 
```

# c++ - 如何使 g++ 运算符重载错误更简洁？

> ID：12610791
> 
> 赞同：1
> 
> 时间：2012-09-26T21:33:25.933
> 
> 标签：c++, compiler-errors, g++, operator-overloading

我时不时地犯一个运算符重载错误，导致 g++ 生成令人沮丧的大量难以理解的编译器错误消息，请考虑以下示例：

```
int someValue ;
vector <vector <int> > 2d ;
while(2d [i] > someValue) someFunction(); 
```

显然，我缺少“2d”向量的第二个索引。不幸的是，g++ 没有简明扼要地报告它未能找到“大于”运算符的匹配项，而是详细列出了每个与比较操作部分匹配的重载候选者，包括一些深埋在标准库中的非常讨厌的重载候选者。

任何人都可以提供一些关于为什么这是处理重载失败的首选方法的见解吗？是否有任何选项可以限制或减少此编译器输出？，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:10:49.730

尝试[STLFilt](http://www.bdsoft.com/tools/stlfilt.html)。但是，它有一段时间没有更新。

一个好的 IDE 应该对这些烦人的额外错误进行一些过滤——在我使用 Eclipse 的时候，它有很好的过滤——但是我现在不知道它是如何做到的。

我个人的做法是跳过我不理解的所有内容，专注于我理解的错误；）

# java - 游戏中的隐马尔可夫模型

> ID：12610796
> 
> 赞同：1
> 
> 时间：2012-09-26T21:34:19.430
> 
> 标签：java, hidden-markov-models

好的，我对这里的 HMM 概念相对较新。

我目前所知道的是，对于一个具有指定状态数（N）、指定数量观察符号（M）和给定观察序列（O）的未知模型，我们可以找到一个最大化 O 概率的模型。

有了这个，我创建了一个 HMM，它利用本文档[http://www.cs.sjsu.edu/~stamp/RUA/HMM.pdf](http://www.cs.sjsu.edu/~stamp/RUA/HMM.pdf) -> 第 7 节伪代码中的代码

AB 和 pi 的初始值约为 1/N 和 1/M。我使用 matlab 生成数字，因此数字不准确但相似。

现在假设 O 的长度为 1000，我根据伪代码将其输入 HMM。最终状态是我得到了一个 A 、 B 和 pi 的模型，它可以自我调整以适应 O。到目前为止我是否正确进行？

如果是这样，接下来我想做的就是找到未来可能的观察 1001 (o1001)。

以我对 HMM 的片面理解，我需要做的是从我最后所拥有的，采取目前最可能的状态（在学习 1000 次观察后从 A 中获取）并从中找到最可能的观察（通过查看来自 A 的状态的 B 矩阵的行）

关于如何预测第 1001 次观测的最后一部分，我不太确定。有人可以告诉我到目前为止我是否在正确的轨道上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T16:44:26.000

好吧，在玩了一下之后，终于稍微了解了我的发现。

我之前提到的是错误的。为了找到下一个可能的观测值，即 1001，我需要执行以下操作来找到 p(O[1001] = k | O(1..1000))，这基本上意味着在给定之前 1000 个观测值的情况下找到观测值的概率是 Bi(O(1000) = K) * Aji*alpha1000(j) 的总和。

# java - Java 套接字服务器被杀死

> ID：12610799
> 
> 赞同：1
> 
> 时间：2012-09-26T21:34:34.000
> 
> 标签：java, serversocket

我已经构建了一个 Java Socket 服务器，它在我的 freebsd 服务器上收听帖子。

Server 类监听一个端口，并接受连接。每个新连接都被发送到 ServerManager，后者将其保存在列表中，并遍历它以检查新数据。迭代是通过无穷大完成的`while loop`。

我注意到在运行几天后服务器已被杀死。我不知道是什么杀死了它。系统是否有可能杀死它，就像Android在内存和资源不足时对进程所做的那样？有没有办法避免这种情况？也许创建某种“看门狗”来重新启动它，以防它被杀死？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T00:34:41.223

> 如果 getInputStream().available() > 0 它运行一个新线程来处理它

这是不正确的。（a）没有必要，（b）如果它为零会发生什么？只需为接受的套接字生成线程，让它处理输入流，使用阻塞读取，并在它完成时关闭所有内容（即当 read() 返回 -1 或抛出异常时）。

接受循环根本不应该对接受的套接字做任何事情，除非将它传递给新线程。

# c# - 为什么我的 SQL 查询在转换后比较日期时选择所有行？

> ID：12610801
> 
> 赞同：1
> 
> 时间：2012-09-26T21:34:47.697
> 
> 标签：c#, sql, webmatrix

我正在使用带有 SQL Server Compact 的 WebMatrix，并且有一个简单的问题。我有一行代码：

```
if(cndDateLastModified=="gteq"){stringCompiler+="'CAST(DateLastModified AS datetime)' >= 'CAST(" + DateLastModified + " AS datetime)' ";}//// 
```

通过在屏幕上绘制输出，查询具体如下所示：

```
SELECT * FROM POITable WHERE 'CAST(DateLastModified AS datetime)' >= 'CAST(09/25/2012 AS datetime)' 
```

出于某种原因，它返回指定日期之前、之后和之后的所有行。在查询方面，我仍然有点犹豫，但是根据所有研究过的帐户，这应该可行。显然，它正在做一些我不太期待的事情，考虑到这一点，这是可以理解的。

关于如何让它以我想要的方式工作的任何想法？它还在尝试比较字符串或其他格式吗？

注意：我确实尝试使用 CONVERT(datetime, DateLastModified) 和 CONVERT(datetime, DateLastModified, 1) 进行这两种转换。

另一个注意事项：它以字符串的形式存储在数据库中。

另一个注意事项：如果我切换条件（从 >= 到 <=），它会做相反的事情并且不返回任何行，考虑到第一个意外结果集，我有点期待，但仍然不知道为什么。

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:45:54.200

因为使用单引号，您正在比较两个字符串。'CAST(....)' 与'CAST(...)'。你也可以写 WHERE 'Ginger' >= 'Fred' 你会得到相同的结果。:D

您应该需要的是： FROM POITable WHERE CAST(DateLastModified AS datetime) >= CAST('09/25/2012' AS datetime)

在文字日期周围使用单引号。'09/25/2012'

但是，如果您使用的是 SQL 服务器，则可以只使用 WHERE CAST(DateLastModified AS datetime) >= '2012-09-25'

此外，如果表的 DateLastModified 列已经是日期时间，请删除强制转换。Cast 用于将字符串转换为数据类型。我的预感就是你需要的是：

```
WHERE DateLastModified >= '2012-09-25' /* ISO date strings are understood and accepted by SQL Server. */
or
WHERE DateLastModified >= GETDATE() /*Everything in the future, time inclusive.*/
or
WHERE DateLastModified >= DATEADD(dd, DATEDIFF(dd, 0, getdate()), 0) /* Everything starting today. */ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:47:05.240

应该是这样的

```
stringCompiler+="CAST(DateLastModified AS datetime) >= CAST('" + DateLastModified + "' AS datetime) " 
```

注意单引号的位置发生了变化

那给你

```
CAST(DateLastModified AS datetime) >= CAST('09/25/2012' AS datetime) 
```

# eclipse - 如何使用 Subclipse 在 Eclipse 中撤消 SVN 更新？

> ID：12610803
> 
> 赞同：0
> 
> 时间：2012-09-26T21:34:55.997
> 
> 标签：eclipse, svn, subclipse

我刚刚对团队项目进行了更新，但没有提交一些必要的文件，现在我无法进行构建。如何撤消上次更新以便重新构建？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:39:21.037

您可以执行“更新到版本”并更新到源的最后一个工作版本。

# macos - .bash_login 文件未加载到新的终端窗口中或在我关闭终端并重新打开它之后

> ID：12610806
> 
> 赞同：0
> 
> 时间：2012-09-26T21:35:01.653
> 
> 标签：macos, terminal

当我创建新的终端窗口或关闭终端并重新打开它时，我的 .bash_login 文件没有加载。我必须运行：

源 ~/.bash_login

每次都是为了让我在 .bash_login 中的别名起作用。知道为什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T00:03:01.100

Do you have a ~/.bash_profile file? If so, it'll use that in preference to ~/.bash_login. From the bash man page:

```
When  bash  is invoked as an interactive login shell, or as a non-
interactive shell with the --login option, it first reads and exe-
cutes  commands  from  the file /etc/profile, if that file exists.
After  reading  that   file,   it   looks   for   ~/.bash_profile,
~/.bash_login,  and  ~/.profile, in that order, and reads and exe-
cutes commands from the first one that  exists  and  is  readable.
The  --noprofile  option  may be used when the shell is started to
inhibit this behavior. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:40:34.633

`./bash_login`每当您登录时读取（重新启动计算机，重新启动桌面或连接到远程计算机等）并且创建新终端未登录。如果您想在每次打开新终端时加载别名，则需要将它们取而代之`/.bashrc`。

# javascript - 从视频元素中检测对 drawImage 的支持

> ID：12610807
> 
> 赞同：0
> 
> 时间：2012-09-26T21:35:02.500
> 
> 标签：javascript, html5-video, html5-canvas, drawimage

我正在尝试编写一个视频查看器，它使用 将视频元素的一部分绘制到 HTML 画布上`drawImage`，但某些设备（例如 iOS）不支持此功能。与其嗅探浏览器/操作系统，我更愿意进行功能检测并退回到仅在这些设备上播放普通视频。是否有可靠的方法来测试此功能？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-10-11T17:08:54.627

检查这个：

```
function isCanvasSupported()
{
  var canvas = document.createElement('canvas');
  return !!(canvas.getContext && canvas.getContext('2d'));
}; 
```

如果支持画布，这将返回 true，否则返回 false。

# java - 在 EC2 上远程部署到 Tomcat 的最佳方式

> ID：12610809
> 
> 赞同：0
> 
> 时间：2012-09-26T21:35:10.220
> 
> 标签：java, tomcat, amazon-ec2

我一直在使用 Jenkins，这真的很麻烦。Jenkins 作为构建服务器非常棒，但对于部署来说，它通常不起作用，更糟糕的是，最终挂了很多。

Heroku 之类的东西真的很吸引人，因为我只想做一个 git push。

也许有办法通过詹金斯插件支持远程部署？

我的构建机器是mac mini。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T23:25:53.527

您总是可以利用 webistrano 之类的发布工具来进行部署。我们经常使用 webistrano 或 Capistrano 进行部署，然后 Jenkins 对其进行健全性测试

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:54:24.570

我认为自己是 Jenkins 的新手，
但是假设您可以编写自己的脚本（我知道您可以），并且假设 EC2 具有部署 API，您为什么不能编写一个简单的脚本来为您执行此操作，一旦构建是成功的？
使用[OpenShift](https://openshift.redhat.com/community/blogs/free-apache-tomcat-hosting-in-the-cloud-for-java-applications-its-called-openshift)怎么样？我认为他们有一个带有 tomcat 的 PaaS 配置——这能以任何方式帮助您执行所需的任务吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:09:16.450

我个人的偏好只是为此目的编写一个 Ant 脚本。有几个任务使它相当容易。scp、sshexec 任务是最好的。但是，请记住 sshexec 不会启动 shell！它只是执行一个命令，因此您没有 shell 为您提供的当前工作目录、环境变量、没有变量替换等。您可以使用此技巧将变量从客户端传递到服务器，执行如下操作：

[如何使用 SSH 在远程机器上运行 shell 脚本？](https://stackoverflow.com/questions/305035/how-to-use-ssh-to-run-shell-script-on-a-remote-machine/7363641#7363641)

这有助于使您的脚本在一定程度上保持环境/机器中立。所以使用 scp 将你的包推送到服务器上，然后使用 sshcommand 使用 unix 脚本部署它以将其复制出来，重新启动 tomcat 等。

# haskell - 目录树的广度优先遍历不是懒惰的

> ID：12610810
> 
> 赞同：8
> 
> 时间：2012-09-26T21:35:20.313
> 
> 标签：haskell

我尝试遍历目录树。天真的深度优先遍历似乎不会以惰性方式生成数据并且会耗尽内存。接下来我尝试了一种广度优先的方法，它显示了同样的问题——它使用了所有可用的内存，然后崩溃了。

我的代码是：

```
getFilePathBreadtFirst :: FilePath -> IO [FilePath]
getFilePathBreadtFirst fp = do
  fileinfo <- getInfo fp 
  res :: [FilePath]  <- if isReadableDirectory fileinfo
          then do
                children  <- getChildren fp 
                lower    <-  mapM getFilePathBreadtFirst children  
                return (children ++  concat lower)
           else return [fp]        -- should only return the files? 
  return res 

getChildren :: FilePath -> IO [FilePath]
getChildren path = do 
          names <- getUsefulContents path
          let namesfull = map (path </>) names
          return namesfull

testBF fn = do  -- crashes for /home/frank, does not go to swap 
  fps <- getFilePathBreadtFirst fn
  putStrLn $ unlines fps 
```

我认为所有代码都是线性或尾递归的，我希望文件名列表立即开始，但实际上并非如此。我的代码和我的想法中的错误在哪里？我在哪里失去了懒惰的评价？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-09-26T22:16:40.327

我将使用三个不同的技巧来解决您的问题。

*   **技巧 1**：使用`pipes`库在遍历树的同时流式传输文件名。
*   **技巧2**：使用`StateT (Seq FilePath)`transformer实现广度优先遍历。
*   **技巧3**：`MaybeT`在编写循环和退出时使用转换器避免手动递归。

以下代码将这三个技巧组合在一个 monad 转换器堆栈中。

```
import Control.Monad
import Control.Monad.Trans
import Control.Monad.Trans.Maybe
import Control.Monad.State.Lazy
import Control.Pipe
import Data.Sequence
import System.FilePath.Posix
import System.Directory

loop :: (Monad m) => MaybeT m a -> m ()
loop = liftM (maybe () id) . runMaybeT . forever

quit :: (Monad m) => MaybeT m a
quit = mzero

getUsefulContents :: FilePath -> IO [FilePath]
getUsefulContents path
  = fmap (filter (`notElem` [".", ".."])) $ getDirectoryContents path

permissible :: FilePath -> IO Bool
permissible file
  = fmap (\p -> readable p && searchable p) $ getPermissions file

traverseTree :: FilePath -> Producer FilePath IO ()
traverseTree path = (`evalStateT` empty) $ loop $ do
    -- All code past this point uses the following monad transformer stack:
    -- MaybeT (StateT (Seq FilePath) (Producer FilePath IO)) ()
    let liftState = lift
        liftPipe  = lift . lift
        liftIO    = lift . lift . lift
    liftState $ modify (|> path)
    forever $ do
        x <- liftState $ gets viewl
        case x of
            EmptyL    -> quit
            file :< s -> do
                liftState $ put s
                liftPipe $ yield file
                p <- liftIO $ doesDirectoryExist file
                when p $ do
                    names <- liftIO $ getUsefulContents file
                    -- allowedNames <- filterM permissible names
                    let namesfull = map (path </>) names
                    liftState $ forM_ namesfull $ \name -> modify (|> name) 
```

这将创建一个广度优先文件名生成器，可以与树遍历同时使用。您使用以下方式使用这些值：

```
printer :: (Show a) => Consumer a IO r
printer = forever $ do
    a <- await
    lift $ print a

>>> runPipe $ printer <+< traverseTree path
<Prints file names as it traverses the tree> 
```

您甚至可以选择不要求所有值：

```
-- Demand only 'n' elements
take' :: (Monad m) => Int -> Pipe a a m ()
take' n = replicateM_ n $ do
    a <- await
    yield a

>> runPipe $ printer <+< take' 3 <+< traverseTree path
<Prints only three files> 
```

更重要的是，最后一个示例只会尽可能多地遍历树以生成三个文件，然后它将停止。当您想要的只是 3 个结果时，这可以防止浪费地遍历整个树！

要了解有关`pipes`库技巧的更多信息，请参阅管道[教程](http://hackage.haskell.org/packages/archive/pipes/2.3.0/doc/html/Control-Pipe-Tutorial.html)。`Control.Pipes.Tutorial`

要了解有关循环技巧的更多信息，请阅读此[博客文章](http://www.haskellforall.com/2012/07/breaking-from-loop.html)。

我找不到用于广度优先遍历的队列技巧的良好链接，但我知道它就在某个地方。如果其他人知道一个很好的链接，只需编辑我的答案以添加它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-28T13:26:19.483

我已经将管道的管理和树的遍历分开了。这里首先是管道的代码（基本上是冈萨雷斯的代码 - 谢谢！）：

```
traverseTree :: FilePath -> Producer FilePath IO ()
-- ^ traverse a tree in breadth first fashion using an external doBF function 
traverseTree path = (`evalStateT` empty) $ loop $ do
-- All code past this point uses the following monad transformer stack:
-- MaybeT (StateT (Seq FilePath) (Producer FilePath IO)) ()
let liftState = lift
    liftPipe  = lift . lift
    liftIO    = lift . lift . lift
liftState $ modify (|> path)
forever $ do
    x <- liftState $ gets viewl
    case x of
        EmptyL    -> quit
        file :< s -> do
            (yieldval, nextInputs) <- liftIO $ doBF file 
            liftState $ put s
            liftPipe $ yield yieldval
            liftState $ forM_ nextInputs $ \name -> modify (|> name) 
```

接下来是树遍历的代码：

```
doBF :: FilePath -> IO (FilePath, [FilePath])
doBF file = do 
    finfo <- getInfo file
    let p =  isReadableDirectoryNotLink finfo
    namesRes <- if p then do
        names :: [String] <- liftIO $ getUsefulContents file
        let namesSorted = sort names
        let namesfull = map (file </>) namesSorted
        return namesfull
        else return []          
    return (file, namesRes) 
```

我希望把doBF换成类似的函数，先遍历深度。我假设我可以使 traverseTree 更通用，不仅适用于 FilePath ~ String，而且我看不到序列上的空函数在哪个类中。一般可能有用。

# audio - 如何从 crontab 中发出响亮的铃声

> ID：12610816
> 
> 赞同：2
> 
> 时间：2012-09-26T21:35:47.257
> 
> 标签：audio, crontab

命令行：

```
/bin/echo -e "\007" 
```

在 bash 中会响铃。随着线：

```
* * * * *   /bin/echo -e "\007" 
```

在我的 crontab 中，我希望铃声每分钟都会响起，但它是无声的。我知道 crontab 正在工作，因为这条线：

```
* * * * *   /bin/touch $HOME/jkjkjk 
```

`jkjkjk`每分钟更新一次文件。几年前我发现一篇帖子建议标准输出应该被定向到`/dev/tty1`crontab 中。但是这条线：

```
* * * * *   /bin/echo "\007" >/dev/tty1 
```

仍然失败。接下来要尝试什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:40:33.407

有一个名为“[哔](http://linux.die.net/man/1/beep)”的程序可能会有所帮助。

> beep - 以多种方式向 PC 扬声器发出哔哔声

# c# - MVC3 将视图加载到邮件字符串中

> ID：12610818
> 
> 赞同：0
> 
> 时间：2012-09-26T21:35:55.707
> 
> 标签：c#, asp.net, asp.net-mvc-3

> **可能重复：**
> [将视图呈现为字符串](https://stackoverflow.com/questions/483091/render-a-view-as-a-string)

我想将视图加载到变量中，以便可以通过邮件发送它。

我希望它像这样工作：

```
var mail = new SmtpClient();
var mailView = View("registration.cshtml", userModel);
mail.Send(FromAddress, userModel.Email, mailView.ViewBag.Title, mailView.ToString()); 
```

除了 ToString() 之外的一切都有效。如何强制 MVC 编译视图？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:37:27.803

这里有一个小方法供你放入你的控制器。

```
 protected string RenderViewToString(string viewName, object model)
    {
        ViewData.Model = model;
        using (var sw = new StringWriter())
        {
            var viewResult = ViewEngines.Engines.FindPartialView(ControllerContext, viewName);
            var viewContext = new ViewContext(ControllerContext, viewResult.View, ViewData, TempData, sw);
            viewResult.View.Render(viewContext, sw);
            viewResult.ViewEngine.ReleaseView(ControllerContext, viewResult.View);
            return sw.GetStringBuilder().ToString();
        }
    } 
```

然后你可以像这样使用它：

```
string viewString = RenderViewToString("viewName", yourModel); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:55:31.647

我同意，从控制器发送数据是个坏主意。例如使用 MSMQ。另请查看此链接：

*   [Razor 视图作为电子邮件模板](https://stackoverflow.com/questions/4368815/razor-views-as-email-templates)
*   [将 Razor 用于 ASP.NET MVC 之外的电子邮件模板](http://kazimanzurrashid.com/posts/use-razor-for-email-template-outside-asp-dot-net-mvc)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:40:08.657

您实际上不太可能将视图发送给用户（即，您将呈现给浏览器的网页）。您可能想要的是一种将 Razor 模板呈现到电子邮件的方法。为此，您可以使用多种工具。例如，我使用 FluentEmail，它可以很好地呈现模板。

从软件工程的角度来看，无论如何让您的控制器呈现电子邮件并不是一个好习惯。这应该封装到业务流程中。让您的控制器呈现电子邮件违反了单一责任原则。

# java - 如何使用 Hibernate、Spring MVC 将数据从单个表单发送到多个数据库表

> ID：12610819
> 
> 赞同：-4
> 
> 时间：2012-09-26T21:35:58.180
> 
> 标签：java, mysql, spring, hibernate, spring-mvc

我能够使用休眠将 html 表单数据发送到数据库。我正在使用 mySQL 5.5、Hibernate、Java 1.6、Spring 3.0。但我想将相同的数据发送到数据库中的多个表。我的问题是我只想使用单个 html 表单而不是多个 html 表单。

我有这些表：姓名、地址、电子邮件、登录名、电话号码。从这个 html 表单中，我希望数据转到不同的表。我想使用 Hibernate 来完成它，这样我就不会手动获取表单数据并将其插入数据库中。

我的理解是 Hibernate 是一个 ORM，这意味着表单数据被映射到给定的表。表单数据是否可以映射到多个表？尽管我在原始帖子中说过，但我并不真正担心我只使用一种形式。我想做的是让来自单一表格的数据进入多个表格。

我的解决方法是为每个数据库表创建表单。这样数据库表就被映射到一个单一的表单。另一种选择是从表单收集输入并使用表对象的 Setter 来插入值并将该对象保存到数据库表中。

请让我知道这是否可能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:40:56.177

为每个类创建一个映射对象（一个新的`Entity`）。

为每个实体创建一个新对象，并将从表单中检索到的数据复制到这些对象中。

# css - 在计算机上的任何地方执行较少的编译器

> ID：12610820
> 
> 赞同：0
> 
> 时间：2012-09-26T21:36:04.500
> 
> 标签：css, batch-file, cmd, less

我遵循的原始来源：[http ://blog.dotsmart.net/2010/11/26/running-the-less-js-command-line-compiler-on-windows/](http://blog.dotsmart.net/2010/11/26/running-the-less-js-command-line-compiler-on-windows/)

我在执行 *.cmd 文件时遇到了一点问题，因此我可以使用 cmd 在计算机上的任何位置执行它们。我真正想要的是执行less.cmd 文件，它支持可选参数并使用lessc.wsf（Windows Script Host 的Less.js 编译器）将less css 转换为纯css。

lessc.cmd 包含：

```
::For convenience
@cscript //nologo "%~dp0lessc.wsf" %* 
```

lessc.wsf 包含以下内容：http: [//pastebin.com/D4pUSGZ6](http://pastebin.com/D4pUSGZ6)

到目前为止我所做的：

将 lessc.cmd 的绝对路径添加到 PATH 系统变量，并将 PATHTEXT 系统变量中的 .cmd 移动到开头。

也这样做了：

```
From a command prompt; 
assoc .cmd
should return with 
..cmd=cmdfile
If not 
assoc .cmd=cmdfile 
to restore the default file type association. 

ftype cmdfile
should return with 
cmdfile="%1" %* 
If not 
ftype cmdfile="%1" %* 
to restore the default "Open" action for the file type. 
```

除非我在cmd中使用绝对路径接近cmd文件，否则这仍然不起作用，如果我在其他任何地方输入lessc，那么我会得到

```
C:\Intel Intel is not recognized as an internal or external command, operable program or batch file. 
```

, 我已多次重新启动计算机以确保更改生效。

我希望有人能给出答案。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T04:12:33.137

您的 PATH 上可能有另一个可运行的“less.*”文件，它隐藏了您的“less.cmd”文件。如果你跑

```
where less.* 
```

从包含less.cmd的目录以外的目录中，它是否列出了您的文件？

另外，尝试添加

```
echo Running less.cmd (as %0) with parameters %* 
```

作为您的 less.cmd 文件中的第一行，然后再次运行您的命令。您是否总是看到该消息，或者仅在通过完整路径运行它时？您正在运行的命令的全文和此输出是什么？您的完整路径是什么（即“set PATH”的输出）？

还有一件事：检查您的“lessc.wsf”文件是否实际上与“less.cmd”文件位于同一文件夹中。如果不是这种情况，我不确定您的脚本将如何运行，但仍然值得仔细检查。

# sql - SQL 查询从多个列中获取多个最大值

> ID：12610823
> 
> 赞同：2
> 
> 时间：2012-09-26T21:36:25.340
> 
> 标签：sql, sql-server, tsql

我试图弄清楚如何从多个列中提取多个最大值。以下是一些示例数据：

```
DATE | A | B | C

4/4/2011 | 64.4 | 62.1 | 33.3

4/5/2011 | 34.6 | 33.5 | 32.3

4/6/2011 | 33.1 | 49.4 | 32.1

4/7/2011 | 55.2 | 32.8 | 33.5

4/8/2011 | 31.2 | 50.1 | 30.4

4/9/2011 | 31.7 | 31.1 | 30.4 
```

我想要前5名：

```
4/4/2011 | 64.4

4/4/2011 | 62.1

4/7/2011 | 55.2

4/8/2011 | 50.1

4/6/2011 | 49.4 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:40:36.043

怎么样：

```
SELECT TOP 5 Date, Val 
FROM (SELECT Date, A as Val FROM T
      UNION ALL
      SELECT Date, B FROM T
      UNION ALL
      SELECT DATE, C FROM T
) AS x
ORDER BY x.Val DESC 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T21:40:48.197

您可以使用 UNPIVOT 然后按列值排序，然后只取前 5 个。

像这样......

```
 CREATE TABLE #Data 
(
    [Date] DATE,
    A  FLOAT,
    B  FLOAT,
    C  FLOAT
)

INSERT INTO 
    #Data
SELECT '4/4/2011' AS Date, '64.4' AS A, '62.1' AS B, '33.3' AS C
UNION SELECT '4/5/2011' AS Date, '34.6' AS A, '33.5' AS B, '32.3' AS C
UNION SELECT '4/6/2011' AS Date, '33.1' AS A, '49.4' AS B, '32.1' AS C
UNION SELECT '4/7/2011' AS Date, '55.2' AS A, '32.8' AS B, '33.5' AS C
UNION SELECT '4/8/2011' AS Date, '31.2' AS A, '50.1' AS B, '30.4' AS C
UNION SELECT '4/9/2011' AS Date, '31.7' AS A, '31.1' AS B, '30.4' AS C

SELECT * FROM #Data

SELECT TOP 5
    [Date],
    [Type],
    [Value]
FROM
(
    SELECT  
        [Date],
        [A],
        [B],
        [C]
    FROM
        #Data 
)pvt
UNPIVOT
(
    [Value] FOR [Type] IN
    ( [A],[B],[C])
)AS unpvt
ORDER BY
    [Value] DESC

DROP TABLE #Data 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:54:16.310

您没有告诉我们的一件事是您是否想要独特的结果或允许重复。

GilM 的回答将允许重复，因为他使用 UNION ALL。

UNION 将返回唯一的结果。

# jquery - Jquery ui幻灯片内容以及滚动条

> ID：12610824
> 
> 赞同：0
> 
> 时间：2012-09-26T21:36:28.553
> 
> 标签：jquery, jquery-ui

好吧，我完全迷路了，我正在使用 jquery ui`slider`小部件来制作这个非常简单的菜单，但我只是想不出一个基本公式来使菜单项与滚动条一起滑动。

这是jsfiddle：http: [//jsfiddle.net/n2H6Q/4/](http://jsfiddle.net/n2H6Q/4/)

**请**记住，`content`高度可以更改为任何值，这就是我使用**随机**高度的原因，**而** `container`高度也可以更改为任何值，这就是为什么我很难弄清楚如何处理所有这些数字......

任何形式的帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:54:08.923

如果我理解正确，您应该将高度设置`container`为随机，而不是`content`. [这是您的jsFiddle](http://jsfiddle.net/n2H6Q/6/)的编辑版本。

编辑：如果内容高度小于容器高度，则不应出现滚动条。我没有考虑到这一点。

# python - 使用python在一个大文件中寻找正则表达式

> ID：12610830
> 
> 赞同：5
> 
> 时间：2012-09-26T21:36:41.917
> 
> 标签：python, regex, perl, seek

我正在尝试在文件中寻找令牌'：path，'，然后将以下所有（任意数字计数）数字读取为数字（因此对于'：path，123'，我在文件中寻找，然后读取整数 123)。然后读取当前搜索位置和 pos+123 之间的字符（将它们存储在列表或其他任何内容中）。然后寻找 ':path' 的下一个匹配项，然后重复该过程。

我想要一个有点像的功能：

```
def fregseek（文件，current_seek，/regex/）：

.
.
  value_found = ? # 在 :path,[0-9]+ 之后读取下一个 N 字符的结果
.
.
  返回 next_start_seek, value_found

```

一行中可能有任意数量的 ':path,' 匹配，并且该字符串可能出现在 ',' 之后指定的字符数内。我写了一堆乱七八糟的垃圾，每行都读到，然后每行 chomps 匹配所指示的前 N ​​个字符，然后继续处理字符串，直到它被全部吃完。然后读取下一个字符串，依此类推。

这太可怕了，当我真正需要做的就是寻找时，我不想不得不从一个潜在的巨大文件中删除所有行（特别是因为换行符是无关紧要的，所以有一个额外的处理步骤只是因为行很容易从文件中提取是荒谬的）。

所以，这就是我想要解决的问题。我需要寻找一个匹配，读取一个值，从该值的末尾继续寻找下一个匹配，依此类推，直到文件用完。

如果有人可以帮助我，我会很高兴收到他们的来信：）

如果可能，我想避免使用非标准库，我也想要最短的代码，但这是我最不关心的问题（速度和内存消耗是重要因素，但我不希望额外 50 loc 只是为了引导一些里面有一个小功能的图书馆，只要我知道它是什么，我就可以把它撕掉）。

我更喜欢 python 代码，但是，如果 perl 在这方面胜过 python，我将使用 perl，我也愿意接受聪明的 sed/awk/bash 脚本等，只要它们不是非常慢。

首先十分感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:55:58.727

你可以在 python 中用近一行来完成：

```
with open('filename.txt') as f:
    text = f.read()

results = [text[i[0]:i[0] + i[1]] for i in 
           ((m.end(), int(m.group(1))) for m in
            re.finditer(':path,([0-9]+)', text))] 
```

注：未经测试...

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T23:08:58.277

如果您不需要正则表达式，则只需查找和切片即可。

无论哪种方式，简单的解决方案是将整个文件读入内存，然后找到并切片结果`str`/`bytes`对象。

但是，如果您不能（或不想）将整个文件读入内存，这将不起作用。

幸运的是，如果您可以指望您的文件 << 2GB 或者您只需要在 64 位 Python 中工作，并且您在一个合理的平台（POSIX、现代 Windows 等）上，您可以`mmap`将文件而是进入记忆。该`mmap`对象具有与字符串相同的方法的一个子集，因此您可以假装您有一个字符串，就像您将整个文件读入内存一样，但是您可以依靠 Python 实现和操作系统来使它只是以合理的效率工作。

根据您的 Python 版本，`re`可能无法像扫描字符串一样扫描 mmap，它可能工作但速度很慢，或者工作得很好。所以，你不妨先尝试一下，如果它没有抛出异常或比你预期的慢得多，你就完成了：

```
def findpaths(fname):
    with open(fname, 'rb') as f:
        m = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)
        for match in re.finditer(':path,([0-9]+)', m):
            yield m[match.end():match.end()+int(match.group(1))] 
```

（这与 BrtH 的答案相同，只是使用 mmap 而不是字符串，并重组为生成器而不是列表——尽管你当然可以通过用括号替换他的方括号来完成后一部分。）

`re`如果您使用的是不能（有效） a的较旧（或非 CPython？）版本的 Python `mmap`，它会更复杂一些：

```
def nextdigits(s, start):
  return ''.join(itertools.takewhile(str.isdigit,
                                     itertools.islice(s, start, None)))

def findpaths(fname):
  with open(fname, 'rb') as f:
    m = mmap.mmap(f.fileno(), 0, access=mmap.ACCESS_READ)
    i = 0
    while True:
      n = m.find(':path', i)
      if n == -1: return
      countstr = nextdigits(m, n+6)
      count = int(countstr)
      n += 6 + len(countstr)
      yield m[n:n+count]
      i = n + 6 + count 
```

这可能不是编写`nextdigits`函数的最快方法。我不确定这是否真的很重要（计时并查看），但如果确实如此，其他可能性是切出`m[n+6:n+A_BIG_ENOUGH_NUMBER]`并正则表达式，或编写自定义循环，或者......另一方面，如果这是你的瓶颈，你通过切换到具有 JIT（PyPy、Jython 或 IronPython）的解释器可能会获得更多好处……</p>

对于我的测试，我将事情分开：`findpaths`接受一个类似字符串的对象，调用者执行`with open`and`mmap`位，然后`m`传入`findpaths`; 我在这里不是为了简洁起见。

无论如何，我已经针对以下数据测试了这两个版本：

```
BLAH:path,3abcBLAH:path,10abcdefghijklmnBLAH:path,3abc:path,0:path,3abc 
```

输出是：

```
abc
abcdefghij
abc

abc 
```

我认为这是正确的？

如果我的早期版本导致它以 100% CPU 旋转，我的猜测是我没有`i`在循环中正确递增；这是您在紧密的解析循环中获得该行为的最常见原因。无论如何，如果您可以使用当前版本重现该内容，请发布数据。

# java - Android：表单中的“下一步”单击以错误的视图结束

> ID：12610833
> 
> 赞同：1
> 
> 时间：2012-09-26T21:36:53.140
> 
> 标签：java, android, focus

我正在使用以下布局：

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:layout_gravity="center_horizontal"
    android:gravity="center_horizontal"
    android:orientation="vertical" >
<DatePicker
        android:id="@+id/datePicker"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_centerHorizontal="true"
        android:layout_gravity="center_horizontal"
        android:layout_marginBottom="2dp"
        android:layout_marginTop="2dp"
        android:nextFocusRight="@+id/timePicker"
        android:nextFocusDown="@+id/timePicker" />
 <TimePicker
        android:id="@+id/timePicker"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/datePicker"
        android:layout_centerHorizontal="true"
        android:layout_centerVertical="true"
        android:layout_gravity="center_horizontal"
        android:layout_marginBottom="2dp"
        android:layout_marginTop="2dp"
        android:nextFocusLeft="@+id/datePicker"
        android:nextFocusUp="@+id/datePicker" />
 <Button
        android:id="@+id/button1"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/timePicker"
        android:layout_centerHorizontal="true"
        android:layout_gravity="center_horizontal"
        android:layout_marginBottom="0dp"
        android:layout_marginTop="2dp"
        android:text="@string/button1" />
</RelativeLayout> 
```

我正在尝试使用下一个视图

```
android:nextFocusRight="@+id/timePicker"
android:nextFocusDown="@+id/timePicker" 
```

但这不起作用。当我在 DatePicker 中开始并单击下一步时，我得到一个错误的视图，键盘布局正常。

有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:39:22.250

根据我对 Android 的有限经验，获取错误视图意味着编译的 .class 文件中使用的资源值与生成的 R 文件不同步。尝试清理您的项目并从头开始重建。

如果这没有帮助，请同时在您的应用中发布相关活动的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T21:56:10.903

我相信您需要做的就是将以下内容添加到您想要关注的所有视图中：

```
android:focusable="true" 
```

* * *

根据[文档](http://developer.android.com/reference/android/view/View.html)：

> **焦点处理**
> 
> 该框架将处理常规焦点移动以响应用户输入。这包括在视图被移除或隐藏或新视图可用时更改焦点。*视图表明他们愿意通过[isFocusable()](http://developer.android.com/reference/android/view/View.html#isFocusable%28%29)方法*获得焦点。

* * *

> **可聚焦（）**
> 
> 返回此 View 是否能够获得焦点。
> 
> **相关 XML 属性**
> [android:focusable](http://developer.android.com/reference/android/view/View.html#attr_android%3afocusable)
> 
> **如果此视图可以获取焦点，则返回**
> True，否则返回 false。

# django - forms.modelform 排序？

> ID：12610836
> 
> 赞同：0
> 
> 时间：2012-09-26T21:37:18.597
> 
> 标签：django, forms

```
class OperationCategoryOnlyForm(forms.ModelForm):
    class Meta:
      model = Operation
      fields = ('operation_type', 'category', 'related_account', )
      ordering = ['date']

OperationFormSet = modelformset_factory(Operation, form=OperationCategoryOnlyForm) 
```

这是一个非常简单的问题 - 为什么它不起作用，以及如何使其排序不同于默认值（按 id）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:50:58.800

`ordering`不是模型表单`Meta`类的有效选项，因此指定它不会做任何事情。

如果您总是想按特定字段对模型进行排序，您可以简单地[`ordering`](https://docs.djangoproject.com/en/dev/ref/models/options/#ordering)在模型的`Meta`类中进行设置。这将影响其他地方的排序，例如在 django 管理员中。

```
class Operation(models.Model):
    # field definitions
    class Meta:
        ordering = ('date',) 
```

如果您只想更改此表单集的顺序，请在初始化时[提供自定义查询集。](https://docs.djangoproject.com/en/dev/ref/models/options/#ordering)

```
OperationFormSet = modelformset_factory(Operation, form=OperationCategoryOnlyForm, queryset=Operation.objects.order_by('date')) 
```

# c++ - 如何在构造函数中编辑 2D 向量

> ID：12610844
> 
> 赞同：1
> 
> 时间：2012-09-26T21:37:40.580
> 
> 标签：c++, vector, matrix, initialization

感谢所有帮助，我已将初始化移至构造函数，但是，我在定义 2D 向量时遇到了困难：

这是我所做的：

```
private:
        vector < vector <int> > Matrix;
        vector < vector <int> > temp_m;
        vector <int> elements
        string input;
        int value;
function()
{
//Initialize Both Matrices (one which holds the puzzle and the
//other which holds the values between 1 and 9
//Create a vector of vectors:
for(int i = 0; i < 9; i++)
    elements.push_back(i+1);
for(int i = 0; i < 9; i++)
    Matrix[i].push_back(elements);  //ERROR HERE
} 
```

我在定义 2D 矩阵的行中遇到错误。我想将矩阵推回其索引，因为它是矩阵的矩阵。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:39:59.537

“行”的声明和它的构造不在同一个地方。构造属于初始化列表：

```
class MyClass
{
public:
    MyClass::MyClass()
      : row(9,0), elements(9)
    {
    }

private:
        vector < vector <int> > Matrix;
        vector < vector <int> > temp_m;
        vector <int> row;
        vector <int> elements;
        string input;
        int value;
} 
```

如果您有任何其他特殊的成员变量大小或初始化，则需要构造参数（例如上面的 Matrix 和 temp_e）它们也属于初始化列表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T21:41:26.353

尝试`(9 , 0)`从声明中删除。在 C++ 中，不能从类变量声明中调用构造函数。您将需要使用初始化列表从类构造函数中执行此操作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-26T21:40:24.327

这是不合法的（无论如何肯定是在 C++11 之前，C++11 发生了变化，但我不确定确切的规则）。您可以在构造函数初始化程序列表中指定它：

```
A::A() : row(9, 0), elements(9) {} 
```

并更改为：

```
private:
    vector<int> row;
    vector<int> elements; 
```

# c# - iSeries/AS400 级别检查错误挂起 ODBC 调用

> ID：12610847
> 
> 赞同：3
> 
> 时间：2012-09-26T21:37:52.807
> 
> 标签：c#, .net, odbc, ibm-midrange

我正在使用 C# .NET ODBC 连接从 iSeries (AS/400) 数据库中检索数据。如果在 iSeries 端没有正确提升文件和过程，则 ODBC 调用将导致*级别检查*错误。不幸的是，ODBC 驱动程序和 iSeries 之间的握手似乎有缺陷，并且 ODBC 调用只是挂起。

在 .NET 端更改连接和命令超时值不会影响调用，这似乎永远挂起。

有没有办法在这种情况下强制超时？

或者有没有办法强制终止 ODBC 调用（即，从另一个等待固定时间的线程）并抛出异常？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T07:39:50.423

我不确定您的问题是什么，听起来可能是 ODBC 驱动程序中的错误。但是，ODBC 确实通过语句属性 SQL_ATTR_ASYNC_ENABLE 定义了异步行为，并且有一个 API SQLCancel 可以取消操作。

# coldfusion - CFLocation 在新窗口中打开而不是 CFDIV（仅在 Firefox 中）

> ID：12610848
> 
> 赞同：0
> 
> 时间：2012-09-26T21:38:02.810
> 
> 标签：coldfusion, coldfusion-9, cfform

我有一个`cfform`人们`cfdiv`可以注册我的网站的地方。当表单提交时，它会处理所有内容，如果有任何理由将用户发送回注册表单，`cflocation`则会触发 a。

它应该重定向回`cfdiv`，而不是新页面。这就是`cfdiv`标签有用的原因之一。它在 Internet Explorer 中运行良好。但在 Firefox 中，它会`cflocation`在父窗口中打开页面，而不是在`cfdiv`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:59:58.687

我认为您不能为此使用 cflocation 。

您应该 cfoutput`<script>`调用此 JS 函数的块：`ColdFusion.navigate`

请参阅：[http ://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WS0ef8c004658c1089-6262c847120f1a3b244-7fd0.html](http://help.adobe.com/en_US/ColdFusion/9.0/CFMLRef/WS0ef8c004658c1089-6262c847120f1a3b244-7fd0.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T13:46:08.430

在处理页面上有一个cfabort。把它拿出来，现在它按预期工作。是的，cflocation 可以在 cfdiv 中使用，而无需刷新父窗口。

# android - Android INSTALL_REFERRER 意图是否会在应用更新时发送？

> ID：12610852
> 
> 赞同：2
> 
> 时间：2012-09-26T21:38:31.130
> 
> 标签：android, google-play, referrer

还是仅用于安装？Play 是否对他们一视同仁？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T23:41:04.740

根据 Localytics 的说法，意图在应用程序首次启动之前[被触发一次：](http://www.localytics.com/docs/android-market-campaign-analytics/)

> 在应用程序安装过程中，Android 将触发一个名为：com.android.vending.INSTALL_REFERRER 的意图。这发生在应用程序第一次启动之前。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-04-09T15:20:53.320

INSTALL_REFERRER 意图仅适用于第一次从应用商店启动的应用，您可以像下面的示例一样使用

```
public class ReferrerReceiver extends BroadcastReceiver {
    String referrer;
  public void onReceive(Context context, Intent intent) {
        final String action = intent.getAction();

        if (action != null && TextUtils.equals(action, "com.android.vending.INSTALL_REFERRER")) {
            try {
                referrer = intent.getStringExtra("referrer");
                Log.d("REFERRER","ReferrerReceiver. "+referrer);
                Toast.makeText(context, "ReferrerReceiver. "+referrer, Toast.LENGTH_LONG).show(); 
            } catch (Exception e) {
                e.printStackTrace();
            }
            }
    }
} 
```

# azure-storage - 是否可以查询具有特定搜索参数但没有 PartitionKey 的大型 Azure 表？

> ID：12610853
> 
> 赞同：2
> 
> 时间：2012-09-26T21:38:37.787
> 
> 标签：azure-storage, azure-table-storage

假设我有一个表实体：

Partitionkey Rowkey 表 userid datecreated

让我们进行一个效果很好的查询，用它我可以检索所有具有特定 ID 的条目（用作 PartitionKey）

```
Dim azt_query As CloudTableQuery(Of adlog)
azt_query = azt_context.CreateQuery(Of adlog)("adlog").Where(Function(e) (e.PartitionKey = "myid" And e.table = "mytable" And e.userid = "myuserid" And e.datecreated >= dateStart And e.datecreated <= dateEnd)).AsTableServiceQuery() 
```

现在我想在不知道 PartitionKey 但基于 USERID 的情况下查询表

会是这样：

```
Dim azt_query As CloudTableQuery(Of adlog)
azt_query = azt_context.CreateQuery(Of adlog)("adlog").Where(Function(e) (e.table = "mytable" And e.userid = "myuserid" And e.datecreated >= dateStart And e.datecreated <= dateEnd)).AsTableServiceQuery() 
```

但是现在删除 e.PartitionKey = "myid" 需要永远。我认为查询想要检索表的所有行并使用参数在其中搜索。

但是有数百万行。使用 partitionkey 进行查询实际上非常快。

有没有办法查询这个？我可以检索特定 USERID 的所有行还是我坚持分区键级别？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T22:37:48.043

您可以通过这种方式查询表，但您注意到这不是一个好主意。如果没有 PartitionKey，存储服务器正在做您所怀疑的事情：它正在读取表中的每个实体。在 Azure Tables 中，这被称为“表扫描”，它非常慢。

解决这个问题的唯一方法是在查询中包含 PartitionKey。如果你需要做很多这样的查询，你可以考虑使用 PartitonKey/RowKey 方案保留一个单独的表，这将使查询快速，或者使用具有适当索引的 SQL 数据库。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:09:03.537

Partition 和 Row Keys 都是必填字段，虽然您可以在不指定它们的情况下进行查询，但它会导致表扫描，这实际上*可能会*导致所有结果从 azure 表加载到您的应用程序，在那里将逐行检查它们的有效性。

分区键和行键都被索引。分区键实际上将用于在分区之间拆分表，以更快地访问某些分区（更常用），在一个分区内，行都在一起。

我们在这里使用分区键来分解我们的多租户应用程序的租户，然后使用行来按特定 ID 检索。我们发现这种方法非常快，但不幸的是，就像您观察到的那样，它对搜索不是很友好，除非您使用这两个索引 ID 中的至少一个。

希望这可以帮助，

# perl - 使用 GPG 的内存加密中的 Perl PGP

> ID：12610857
> 
> 赞同：3
> 
> 时间：2012-09-26T21:39:13.153
> 
> 标签：perl, gnupg, pgp

[我尝试使用 Crypt::OpenPGP 但在解密 GPG 加密消息时遇到了一些问题。](https://stackoverflow.com/q/12540226/206466)所以现在我正在寻找替代品。我希望模块能够完全在内存中进行加密/解密，因为我们希望确保数据在任何时候都不会以未加密状态暴露在磁盘上。服务器将具有`gpg`2.x 版本，似乎并非所有模块都支持。有一个好的模块供我使用吗？我发现筛选这些模块有点困难，因为似乎没有一个“最好”的模块，而且它们的年龄各不相同。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T04:11:32.283

正如 Rob 所说，最好的解决方案是使用 XS。

请看这本书：[Extended and Embedding Perl](https://rads.stackoverflow.com/amzn/click/com/1930110820)。

这本书非常适合那些了解一些 C 和 C++ 并希望深入研究 XS 的人。Perl 知识也是必要的。

基本上，XS 只是 Perl 公开的 API，以便您访问所有数据结构：

*   标量
*   球体
*   哈希
*   参考
*   数组
*   ETC

XS 模块有 2 个部分：

*   一个使用 C 或 C++ 代码（取决于你如何告诉 h2xs）
*   一个代码也是 C/C++，但在语法上有一些小的差异，这些差异由[xspp转换为 C/C++](https://metacpan.org/release/ExtUtils-XSpp)

您必须为您的代码编写测试，以确保它按您希望的方式工作。

在编写 XS 时，我强烈建议您使用：

*   带有Perl 的[gdb ，](http://www.gnu.org/software/gdb/)[使用调试符号编译](https://stackoverflow.com/questions/9320203/using-perlbrew-to-build-a-perl-with-debugging-symbols)
*   [valgrind](http://valgrind.org/)以确保您没有内存泄漏

如果您可能有性能问题[，我建议您使用 callgrind](http://valgrind.org/docs/manual/cl-manual.html)，因为它是目前最好的分析器工具之一。您可以使用 [kcachegrind](http://kcachegrind.sourceforge.net/)查看 callgrind 的输出。

您的起点是[h2xs](http://perldoc.perl.org/h2xs.html)。它是一个实用程序，可以生成您不想处理的所有无聊样板。为了掌握[h2xs 的一些知识，请阅读本教程](http://www.lemoda.net/xs/xs-intro/geometry.html)。

请记住，h2xs 将为您生成一个 Makefile.PL，在您运行`perl Makefile.PL`后将生成一个标准的`Makefile`. 从那时起，您可以使用`make`您的模块。确保你告诉`Makefile.PL`链接**libpgp**。还要确保您可以`-g`使用调试符号进行编译。您将遇到必须使用 gdb 进行调试并且需要调试符号的情况。

此外，[这里有一个名为 Baby XS 的 XS 演示文稿](http://www.youtube.com/watch?v=EPZHXVZwsY4)。这将是对 XS 的一个很好的介绍。

我也建议你去买那本书，太棒了。我在编写 XS 代码时使用过它，它对我非常有帮助（现在仍然如此）。

[PS 如果不想处理所有的 XS，可以使用更轻量级的[Inline::C](https://metacpan.org/module/SISYPHUS/Inline-0.51/C/C.pod)或[Inline::CPP](https://metacpan.org/module/DAVIDO/Inline-CPP-0.42/lib/Inline/CPP.pod)。但是你必须通过上面提到的书（或[官方 Perl XS 教程](http://perldoc.perl.org/perlxstut.html)）来了解 XS API 的基础知识。]

[我认为你觉得开始有点困难，但是一旦你学习了一些 XS 基础知识，一切都会容易得多。学习 XS 的好处是，您不再依赖于为 XS 模块提供支持的人，您将能够编写自己的代码，或使用其他 XS 模块的零碎部分。如果你说 Crypt::OpenPGP 没有你需要的功能，你可以自己写。]

# android - 如何使用 zxing 从 qr 扫描仪捕获数据

> ID：12610862
> 
> 赞同：0
> 
> 时间：2012-09-26T21:39:24.240
> 
> 标签：android

我正在开发一个应用程序，其中一部分涉及 QR 扫描。经过大量研究，我成功开发了一个独立的扫描应用程序。当用户打开扫描仪并扫描特定的二维码时，他会得到一些值，例如 URL。现在我想将扫描获取的数据存储到我的 android 代码中。任何人都可以帮助我如何去做吗？

据我所知，我需要使用 Zxing 的捕获活动类。但是，我不确定到底需要做什么。我在网上阅读的所有博客都指示我使用一个`Intent`调用条形码扫描。但是，我的应用程序的目的不仅仅是扫描产品。我需要存储扫描产品的信息，然后将其用于其他目的。

请帮助我。

谢谢， 艾米

这是 Zxing 的代码。这是处理所有扫描的主要活动。根据我通过在线阅读学到的知识，我需要捕获扫描条形码时返回的数据..

```
public void onActivityResult(int requestCode, int resultCode, Intent intent) { 
    if (resultCode == RESULT_OK) { 
        if (requestCode == HISTORY_REQUEST_CODE) { 

            int itemNumber = intent.getIntExtra(Intents.History.ITEM_NUMBER, -1); 

            if (itemNumber >= 0) { 
                HistoryItem historyItem = historyManager.buildHistoryItem(itemNumber);             
                decodeOrStoreSavedBitmap(null, historyItem.getResult()); 
            } 
        }
    } 
} 

if (Intents.Scan.ACTION.equals(action)) { // Scan the formats the intent requested, and   return the result to the calling activity 
    source = IntentSource.NATIVE_APP_INTENT; 

    decodeFormats = DecodeFormatManager.parseDecodeFormats(intent); 
    if (intent.hasExtra(Intents.Scan.WIDTH) && intent.hasExtra(Intents.Scan.HEIGHT)) {

        int width = intent.getIntExtra(Intents.Scan.WIDTH, 0); 
        int height = intent.getIntExtra(Intents.Scan.HEIGHT, 0); 

        if (width > 0 && height > 0) { 
            cameraManager.setManualFramingRect(width, height); 
        } 
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:37:36.480

通过意图使用它是最简单的方法，并且可以存储扫描结果，您只需要自己做。它的工作原理都在 Zxing 的文档中，网址为[http://code.google.com/p/zxing/wiki/ScanningViaIntent](http://code.google.com/p/zxing/wiki/ScanningViaIntent)

从上面的链接

首先添加代码来调用 Intent：

```
IntentIntegrator integrator = new IntentIntegrator(yourActivity);
integrator.initiateScan(); 
```

其次，将此添加到您的 Activity 以处理结果：

```
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
    IntentResult scanResult = IntentIntegrator.parseActivityResult(requestCode, resultCode, intent);
        if (scanResult != null) {
            // handle scan result
            //here is where you would get the data from the scanResult
            //and store locally by writing to a file or however you 
            //intend to store it
        }
        // else continue with any other code you need in the method
} 
```

Zxing这个版本我没用过，我用的至少是2年前的但是流程是一样的

1 - 通过 Intent 启动 Zxing 2 - 扫描 QR 码 3 - 在 onActivityResult 中从扫描中检索信息。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-27T23:37:58.713

嗨，我终于找到了这个问题的答案。这并没有我想的那么难（因为 Zxings 的代码是由 Zxing 团队编写的，而不是由我编写的......无论如何......）

因此，如果您想将 qr 扫描仪（由 Zxing 提供）捕获的数据存储在您的 android 代码中（无论出于何种目的......在我的情况下，我想将此数据发送到 Web 服务器......无论如何......）那么你只需要修改以下功能..这是您获得扫描活动结果的地方..

```
public void handleDecode(Result rawResult, Bitmap barcode) {
inactivityTimer.onActivity();
lastResult = rawResult;
Log.d("last result", "checking if raw result is what i expect");
System.out.println(lastResult);
ResultHandler resultHandler = ResultHandlerFactory.makeResultHandler(this, rawResult);
historyManager.addHistoryItem(rawResult, resultHandler);
} 
```

我添加了日志和打印语句来检查我是否得到正确的结果。是的，它确实给了我一个正确的答案。你可以在 CaptureActivity 类中找到它。

@triggs：感谢您的帮助！你确实让我走上了正轨:-)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-19T12:10:42.910

我偶然发现您的线程也在寻找有关这组代码的帮助。在我的情况下，我必须将信息发送回主应用程序（ZXing 是我项目中的一个库 - 我知道，我已经与我的客户讨论过这个问题，但由于业务需求我们无法使用 Intents）。

如果您需要将信息从另一个项目传回另一个活动，这是我的解决方案。

项目 A 是主要应用程序，而 ZXing 项目将被称为主应用程序。

编辑 ZXing 的 CaptureActivity.java 中的 handleDecode()：

```
public void handleDecode(Result rawResult, Bitmap barcode) {
    inactivityTimer.onActivity();
    lastResult = rawResult;
    ResultHandler resultHandler = ResultHandlerFactory.makeResultHandler(this, rawResult); 
if (source == IntentSource.NATIVE_APP_INTENT) {
        Intent resultIntent = new Intent();
        resultIntent.putExtra("result", rawResult.toString());
        setResult(Activity.RESULT_OK, resultIntent);
        finish();
    } 

}//end handleDecode() 
```

在调用 CaptureActivity 的项目 A 的活动中，

```
@Override
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
    NullQRCodeDialogFragment dialog = new NullQRCodeDialogFragment();
    String result = "";
        if (resultCode == RESULT_OK) {
            result = intent.getStringExtra("result");
             if (result.equals(null)){
                  //TODO
             } else {
                  //TODO
             }
}//end onActivityResult 
```

希望这可以帮助！这是我在这里的第一篇文章，我很高兴能做出贡献 =)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-20T09:18:01.790

这是我正在使用的解决方案。它对我来说很好。

```
Intent intent = new Intent(SelectOptionActivity.this, CaptureActivity.class);
                intent.putExtra("SCAN_MODE", "ONE_D_MODE");
                intent.putExtra("SCAN_FORMATS", "CODE_39,CODE_93,CODE_128,DATA_MATRIX,ITF,CODABAR,EAN_13,EAN_8,UPC_A,QR_CODE");
                intent.setAction(Intents.Scan.ACTION);
                startActivityForResult(intent, 1);

public void onActivityResult(int requestCode, int resultCode, Intent intent) {
        if (requestCode == 1 && resultCode == RESULT_OK) {
            final String contents = intent.getStringExtra(Intents.Scan.RESULT);
            final String formatName = intent.getStringExtra(Intents.Scan.RESULT_FORMAT);

        }
    } 
```

# jquery - 使用 Jquery 切换显示和隐藏，但浮动变得奇怪

> ID：12610865
> 
> 赞同：1
> 
> 时间：2012-09-26T21:39:42.203
> 
> 标签：jquery, css-float

我不知道如何解决这个问题或什至看什么，我将浮动用于一堆类并且效果很好。最重要的是我做了，所以你可以点击显示和隐藏内容（在类内显示内容）。我的问题是，当课程扩展时，浮动只是表现得很奇怪。因为当你点击它们时。我即将启动我新创建的页面，但后来我看到了这个！看看它的实际效果：

[单击此处查看我的页面](http://epicesports.com/buildorders.php#protoss "点击这里") 单击右侧的“框”，其中显示：“Forge Nexus Opening”，然后看到我的底部“框”（文字显示：“Nexus Forge Opening”）被放下并跟随另一个盒子并留下一个间隙。我该如何解决这个问题？我不想要盒子之间的空白。

Jquery 用于此。

```
$(".desccontent").show();
$(".desccontent").hide();  

    $('.buildorderbox').click(function(){
    $(this).children(".desccontent").slideToggle();
    }); 
```

每个类元素都有浮动：左和自动高度。有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:21:51.430

您需要两个不同的 div，为左侧内容创建一个，为右侧内容创建另一个

```
<div id="protoss">
  <div class="columnLeft" style="width: 350px; float:left">
    <div class="buildorderbox"></div>
    <div class="buildorderbox"></div>
  </div>
  <div class="columnRight" style="width: 350px; float:left">
    <div class="buildorderbox"></div>
    <div class="buildorderbox"></div>
  </div>
</div> 
```

# php - zf2 \Zend\Db\Sql\Sql 在 where 条件下使用谓词

> ID：12610866
> 
> 赞同：5
> 
> 时间：2012-09-26T21:39:57.430
> 
> 标签：php, zend-db, zend-framework2

我真的不明白如何在 zend 框架 2 中使用谓词。

这就是我得到的：

```
$sql->select()
        ->columns(array('GroupedColum'
            ,'minValue' => new Expression('min(ValueColumn)')))
        ->from('ValueTable')
        ->group('GroupedColum')
        ->order('minValue')
        ->order('GroupedColum')
        ->limit(10); 
```

这工作正常

现在我想应用这样的东西：

```
$predicate = new Zend\Db\Sql\Predicate\Predicate();
$sql->where($predicate->greaterThan('filterColumn','20); 
```

这是我尝试过的，它没有抛出错误，但它不起作用:-(

这就是我对 SQL 的期望：

```
select GroupedColum
    , min(ValueColumn) as minValue
from ValueTable
where filterColumn > 20
group by GroupedColum
order by minValue
    GroupedColum
limit 10; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-09-27T06:43:08.317

我通过查看源代码解决了这个问题`zf2`

如果你知道怎么做，那真的很容易，上面的代码几乎是对的！

代替

```
$predicate = new Zend\Db\Sql\Predicate\Predicate(); 
```

你必须使用

```
$predicate = new  \Zend\Db\Sql\Where(); 
```

它是一个空的派生类，在 Zend\Db\Sql\Sql 中使用

**这是完整的工作示例：**

```
$sql->select()
    ->columns(array('GroupedColum'
        ,'minValue' => new Expression('min(ValueColumn)')))
    ->from('ValueTable')
    ->group('GroupedColum')
    ->order('minValue')
    ->order('GroupedColum')
    ->limit(10);
$predicate = new  \Zend\Db\Sql\Where();
$sql->where($predicate->greaterThan('filterColumn','20')); 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-14T13:23:52.667

有点晚了，但你也可以这样做

```
$sql->select()
->columns(array('GroupedColum'
    ,'minValue' => new Expression('min(ValueColumn)')))
->from('ValueTable')
->group('GroupedColum')
->order('minValue')
->order('GroupedColum')
->limit(10)
->where
    ->greaterThan('filterColumn', '20'); 
```

\Zend\Db\Sql\Select 的 __get 魔术方法有一个 where which 返回当前 where() 谓词的情况，它允许您做更复杂的事情，例如

```
$sql->where
    ->greaterThan('filterColumn', '20')
    ->or
    ->greaterThan('filterColumn', '30'); 
```

对比

```
$predicate = new  \Zend\Db\Sql\Where();
$sql->where($predicate->greaterThan('filterColumn', '20'));
$sql->where($predicate->greaterThan('filterColumn', '30'), 'OR'); 
```

有关 Where 谓词中 ZF 2 (2.1.0) 中可用的所有谓词的列表，请参见：

*   [https://github.com/zendframework/zendframework/blob/release-2.1.0/library/Zend/Db/Sql/Predicate/Predicate.php](https://github.com/zendframework/zendframework/blob/release-2.1.0/library/Zend/Db/Sql/Predicate/Predicate.php)
*   [http://framework.zend.com/apidoc/2.1/classes/Zend.Db.Sql.Predicate.Predicate.html](http://framework.zend.com/apidoc/2.1/classes/Zend.Db.Sql.Predicate.Predicate.html)

# c# - How do I collect return values from Parallel.ForEach?

> ID：12610868
> 
> 赞同：68
> 
> 时间：2012-09-26T21:39:58.490
> 
> 标签：c#, c#-4.0, parallel.foreach

I'm calling a slow webservice in parallel. Things were great until I realized I need to get some information back from the service. But I don't see where to get the values back. I can't write to the database, HttpContext.Current appears to be null inside of a method called using Parallel.ForEach

Below is a sample program (in your mind, please imagine a slow web service instead of a string concatenation)

```
using System;
using System.Threading.Tasks;

class Program
{
    static void Main(string[] args)
    {
        WordMaker m = new WordMaker();
        m.MakeIt();
    }
    public class WordMaker
    {
        public void MakeIt()
        {
            string[] words = { "ack", "ook" };
            ParallelLoopResult result = Parallel.ForEach(words, word => AddB(word));
            Console.WriteLine("Where did my results go?");
            Console.ReadKey();
        }
        public string AddB(string word)
        {
            return "b" + word;
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：75
> 
> 时间：2012-09-26T21:42:58.187

You've discarded it in here.

```
ParallelLoopResult result = Parallel.ForEach(words, word => AddB(word)); 
```

You probably want something like,

```
ParallelLoopResult result = Parallel.ForEach(words, word =>
{
    string result = AddB(word);
    // do something with result
}); 
```

If you want some sort of collection at the end of this, consider using one of the collections under `System.Collections.Concurrent`, like [`ConcurrentBag`](http://msdn.microsoft.com/en-us/library/dd381779.aspx)

```
ConcurrentBag<string> resultCollection = new ConcurrentBag<string>();
ParallelLoopResult result = Parallel.ForEach(words, word =>
{
    resultCollection.Add(AddB(word));
});

// Do something with the result 
```

* * *

## 回答 #2

> 赞同：37
> 
> 时间：2016-09-28T08:11:01.120

Your may consider using `AsParallel` extension method of `IEnumerable`, it will take care of the concurrency for you and collect the results.

`words.AsParallel().Select(AddB).ToArray()`

Synchronisation (e.g. locks or concurrent collections that use locks) are usually bottleneck of concurrent algorithms. The best is to avoid synchronisation as much as possible. I am guessing that `AsParallel` uses something smarter like putting all the items produced on single thread into a local non-concurrent collection and then combining these at the end.

* * *

## 回答 #3

> 赞同：14
> 
> 时间：2014-11-25T13:21:33.760

Do not use `ConcurrentBag` to collect results as it is slower. Use local lock instead.

```
var resultCollection = new List<string>();
object localLockObject = new object();

Parallel.ForEach<string, List<string>>(
      words,
      () => { return new List<string>(); },
      (word, state, localList) =>
      {
         localList.Add(AddB(word));
         return localList;
      },
      (finalResult) => { lock (localLockObject) resultCollection.AddRange(finalResult); }
); 

// Do something with resultCollection here 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2017-01-20T15:20:54.267

This seems safe, fast, and simple:

```
 public string[] MakeIt() {
        string[] words = { "ack", "ook" };
        string[] results = new string[words.Length];
        ParallelLoopResult result =
            Parallel.For(0, words.Length, i => results[i] = AddB(words[i]));
        return results;
    } 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2015-04-02T23:36:41.973

How about something like this:

```
public class WordContainer
{
    public WordContainer(string word)
    {
        Word = word;
    }

    public string Word { get; private set; }
    public string Result { get; set; }
}

public class WordMaker
{
    public void MakeIt()
    {
        string[] words = { "ack", "ook" };
        List<WordContainer> containers = words.Select(w => new WordContainer(w)).ToList();

        Parallel.ForEach(containers, AddB);

        //containers.ForEach(c => Console.WriteLine(c.Result));
        foreach (var container in containers)
        {
            Console.WriteLine(container.Result);
        }

        Console.ReadKey();
    }

    public void AddB(WordContainer container)
    {
        container.Result = "b" + container.Word;
    }
} 
```

I believe the locking or concurrent objects isn't necessary unless you need the results to interact with one another (like you were computing a sum or combining all the words). In this case ForEach neatly breaks your original list up and hands each thread its own object that it can manipulate all it wants without worrying about interfering with the other threads.

* * *

## 回答 #6

> 赞同：3
> 
> 时间：2022-01-26T07:06:03.507

In the particular cases where the size of the collection is know upfront - which is often the case in practice - an array can be use instead of an expensive concurrent collection. There is no risk of collision since each loop accesses its own slot in the `ouputs` array. As a bonus outputs are stored with the same order as inputs:

```
const int NB_WORDS = 1000;
var inputs = new string[NB_WORDS];
for(var i= 0; i < NB_WORDS; i++) { inputs[i] = i.ToString(); }

var outputs = new string[NB_WORDS];

Parallel.For(0, NB_WORDS, index => {
   string word = inputs[index];
   string result = word + word; // Operation on word
   outputs[index] = result; // No need of a concurrent collection to store the result!
});

Debug.Assert(outputs.All(result => !string.IsNullOrEmpty(result))); 
```

# c++ - 是否有一个只返回其参数的 std 函数？

> ID：12610870
> 
> 赞同：5
> 
> 时间：2012-09-26T21:40:04.777
> 
> 标签：c++, stl

这应该很容易实现，比如

```
template<typename T>
T & as_is(T & t) { return t; } 
```

不过，我不想写它（：

[我在www.cplusplus.com](http://www.cplusplus.com)上没有找到这样的东西。

对于那些会问“你想做什么”的人来说，事情就是这样。我有一个构建 ascii 表的类，具有很好的填充和一切。我会省略细节。重要的是它存储字符串（因此它能够计算要填充多少）。我想实现一个排序函数并能够告诉类将该列用作某种类型。如果我想按一列整数（同样是内部字符串）排序，我会通过`atoi`. 如果对字符串进行排序，我想通过`as_is`，或 stl 等效项（如果有）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:43:43.733

为什么不重载函数而不传递任何东西？

顺便说一句，如果您使用的是 MSVC，他们有`identity`类模板，它有一个`operator()`返回输入的重载。所以理论上，你可以通过`std::identity<std::string>()`，但我想说，只是构建你自己的`identity`函数。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-09-26T22:30:13.217

您不能像传递函数一样传递模板，因此 std::forward 和假设的 nonstd::identity 函数都不会按原样（按原样）工作。您需要明确设置转换的目标类型：

```
table.SortColumnUsing(3, nonstd::identity<std::string>); 
```

这对我来说似乎有点难看，因为模板专业化中的类型是 table 的内部实现的一个特性，而不是与我期望 table 序列化以进行排序的类型有任何关系。或者，也许您并没有真正将列存储为 std::string。

atoi 如何作为类型描述符工作？atoi 需要一个 char*，而不是 std::string，而且我认为您不能隐式转换`int(const char*)`为`int(const std::string&)`. 即使你能做到这一点，你使用什么类型可以同时存储 an`int(const std::string&)`和 a `Banana(const std string&)`。也许我不完全理解您的问题的上下文，或者您有一些我很想学习的 C++ 技巧。

我的倾向是传递比较函数而不是转换函数。这将导致单个常量函数类型，也许是`bool(const std::string&, const std::string&)`. 这也可能使其更易于实现，例如。特定列的不区分大小写或特定于区域设置的字符串比较，或其他 UI 方便的排序技巧（例如将文件夹放在列表顶部：首先检查是否只有一个字符串有尾随 /，否则使用标准比较。）但是，这并不能真正解决专业化问题。对于这种`std::string`情况，您仍然会得到`std::less<std::string>`（至少存在。）

我知道，这不是一个很好的答案……但是评论太长了。

# perl - 如何使此命令安全，并适用于带引号的字符串

> ID：12610873
> 
> 赞同：3
> 
> 时间：2012-09-26T21:40:17.740
> 
> 标签：perl, bash, ubuntu, command

我发现（并稍加修改）一个使用正则表达式（和 perl）编辑文件列表的命令。我将它放入一个名为 的脚本文件`cred`中，因此我可以将当​​前目录中所有文件中`cred . england England`所有出现的 替换为`england`。`England`

```
find $1 -type f -exec perl -e 's/'$2'/'$3'/g' -p -i {} \; 
```

它非常强大，而且已经很有用——但是很危险，而且有缺陷。我希望它...

1.  首先预览更改（或至少文件操作），要求确认
2.  使用比单个单词更长的字符串。我试过`cred . england 'the United Kingdom'`但失败了

我也会对其他（简短且令人难忘，在 osx 和 ubuntu 上普遍安装/可安装）命令感兴趣以实现相同的目标。

编辑：

这就是我到目前为止所拥有的 - 对改进持开放态度......

```
# highlight the spots that will be modified (not specifying the file)
find $1 -type f -exec grep -E "$2" --color {} \;
# get confirmation
read -p "Are you sure? " -n 1 -r
if [[ $REPLY =~ ^[Yy]$ ]]
then
  # make changes, and highlight the spots that were changed
  find $1 -type f -exec perl -e "s/$2/$3/g" -p -i {} \;
  echo ""
  find $1 -type f -exec grep -E "$3" --color {} \;
else
  echo ""
  echo "Aborted!!"
fi 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:48:01.890

要处理带空格的字符串，请编写如下命令：

```
perl -e "s/$2/$3/g" 
```

如果使用双引号，变量将在引号内展开。

要执行诸如预览更改和请求确认之类的操作，您将需要一个更复杂的脚本。一件非常简单的事情是`find $1 -type f`首先运行以获取所有文件的列表，然后使用`read`命令获取一些输入并决定是否应该继续。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-27T02:53:31.690

这是一个使用 File::Find 的纯 Perl 版本。它更长一些，但更容易调试和做更复杂的事情。它适用于每个文件，从而可以更轻松地进行验证。

```
use strict;
use warnings;

use autodie;
use File::Find;
use File::Temp;

my($Search, $Replace, $Dir) = @ARGV;

# Useful for testing
run($Dir);

sub run {
    my $dir = shift;
    find \&replace_with_verify, $dir;
}

sub replace_with_verify {
    my $file = $_;
    return unless -f $file;

    print "File: $file\n";

    if( verify($file, $Search) ) {
        replace($file, $Search, $Replace);
        print "\nReplaced: $file\n";
        highlight($file, $Replace);
    }
    else {
        print "Ignoring $file\n";
    }

    print "\n";
}

sub verify {
    my($file, $search) = @_;

    highlight($file, $search);

    print "Are you sure? [Yn] ";
    my $answer = <STDIN>;

    # default to yes
    return 0 if $answer =~ /^n/i;
    return 1;
}

sub replace {
    my($file, $search, $replace) = @_;

    open my $in, "<", $file;
    my $out = File::Temp->new;

    while(my $line = <$in>) {
        $line =~ s{$search}{$replace}g;
        print $out $line;
    }

    close $in;
    close $out;

    return rename $out->filename, $file;
}

sub highlight {
    my($file, $pattern) = @_;

    # Use PCRE grep.  Should probably just do it in Perl to ensure accuracy.
    system "grep", "-P", "--color", $pattern, $file;    # Should probably use a pager
} 
```

# java - 如何调整 tomcat 应用程序使用的文件（日志、sqlite 数据库）的路径/权限？

> ID：12610874
> 
> 赞同：0
> 
> 时间：2012-09-26T21:40:18.860
> 
> 标签：java, tomcat6

**编辑：**我重写了问题以包含最新发现并删除已解决的问题。

我正在开发`myapp`以前由我的同事创建的 servlet 应用程序。我在 Debian 下开发和运行它，我使用的 Tomcat 服务器是 6 版。

在此应用程序中，使用了三个文件：

```
myapp-database.db - sqlite file, if is is not present application creates it
myapp-log.xml - log file, it is opened/created by the application
myapp-config.xml - configuration files, included in /usr/main/resources 
```

如果我在安装在我的主目录中的 Eclipse-inner-Tomcat 上运行它，文件：`myapp-database.db`和`myapp-log.xml`直接在我的主目录中创建。

如果我将应用程序部署到使用 aptitude 安装的系统 Tomcat 时，此文件会出现问题。它显示在`catalina.out`：

```
Error while initialising logger: mylog.xml
java.io.IOException: Couldn't get lock for mylog.xml

...

SEVERE: couldn't initialize database:
    opening db: 'mydb.db': Permission denied

java.sql.SQLException: opening db: 'mydb.db': Permission denied

... 
```

我像这样部署应用程序：

```
sudo cp myapp.war /var/lib/tomcat6/webapps/ 
```

然后我无法打开系统Tomcat。如果我从中删除应用程序`webapps`就可以了。

我在磁盘上的某个地方制作了目录并将所有者更改为 tomcat。我将代码中的文件名更改为绝对路径，以便在目录中创建它们。Tomcat 打开并且没有崩溃，文件是在那里创建的。

这是处理这个问题的正常方式吗？完全在tomcat之外创建应用程序文件？我认为这使应用程序的可移植性降低/更难安装。

也许我应该把文件放在`/usr/main/resources`哪个`myapp-config.xml`工作正常？但我不太确定如何让路径指向它们？我也不喜欢这个解决方案，因为如果文件不存在，应用程序应该创建文件。

# php - PHPUnit 模拟对象不起作用

> ID：12610877
> 
> 赞同：0
> 
> 时间：2012-09-26T21:40:27.267
> 
> 标签：php, mocking, phpunit, symfony-components

我是在 PHPUnit 中模拟对象的新手，无法让它工作。我正在构建当前的扩展`SensioGeneratorBundle`（用于 Symfony2）。我使用**通过**`PEAR`. 它在**PHP 5.3.5**上运行（因为 PEAR 安装在该版本中）。

我的剥离课程是：

*控制器生成器.php*

```
class ControllerGenerator extends Generator
{
    // ...

    public function generate(BundleInterface $bundle, $controller, array $actions = array())
    {
        // ...
    }
} 
```

*生成控制器命令.php*

```
class GenerateControllerCommand extends ContainerAwareCommand
{
    private $generator;

    /**
     * @see Command
     */
    public function configure()
    {
        // ...
    }

    public function execute(InputInterface $input, OutputInterface $output)
    {
        // ...

        $generator = $this->generator;
        $generator->generate($bundle, $controller);

        // ...
    }

    protected function getGenerator()
    {
        if (null === $this->generator) {
            $this->generator = new ControllerGenerator($this->getContainer()->get('filesystem'), __DIR__.'/../Resources/skeleton/bundle');
        }

        return $this->generator;
    }

    public function setGenerator(ControllerGenerator $generator)
    {
        $this->generator = $generator;
    }
} 
```

*生成控制器命令测试.php*

```
class GenerateControllerCommandTest extends GenerateCommandTest
{
    public function testNonInteractiveCommand()
    {
        $bundle = 'FooBarBundle';
        $controller = 'PostController';

        $input = array(
            'command' => 'generate:controller',
            '--bundle' => $bundle,
            '--controller' => $controller,
        );

        $application = $this->getApplication();
        $commandTester = $this->getCommandTester($input);
        $generator = $this->getGenerator();

        $generator
            ->expects($this->once())
            ->method('generate')
            ->with($this->getContainer()->get('kernel')->getBundle($bundle), $controller)
        ;

        $commandTester->execute($input, array('interactive' => false));
    }

    protected function getCommandTester($input = '')
    {
        return new CommandTester($this->getCommand($input));
    }

    protected function getCommand($input = '')
    {
        return $this->getApplication($input)->find('generate:controller');
    }

    protected function getApplication($input = '')
    {
        $application = new Application();

        $command = new GenerateControllerCommand();
        $command->setContainer($this->getContainer());
        $command->setHelperSet($this->getHelperSet($input));
        $command->setGenerator($this->getGenerator());

        $application->add($command);

        return $application;
    }

    protected function getGenerator()
    {
        // get a noop generator
        return $this
            ->getMockBuilder('Sensio\Bundle\GeneratorBundle\Generator\ControllerGenerator')
            ->disableOriginalConstructor()
            ->setMethods(array('generate'))
            ->getMock()
        ;
    }
} 
```

当我运行 PHPUnit 时，我不断收到此错误：

```
 $ phpunit Tests\Command\GenerateControllerCommandTest

     PHPUnit 3.7.0 by Sebastian Bergmann.

     Configuration read from E:\Wouter\web\wamp\www\wjsnip\vendor\sensio\generator-bundle\Sensio\Bundle\GeneratorBundle\phpunit.xml.dist

     F

     Time: 2 seconds, Memory: 7.25Mb

     There was 1 failure:

     1) Sensio\Bundle\GeneratorBundle\Tests\Command\GenerateControllerCommandTest::testNonInteractiveCommand
     Expectation failed for method name is equal to <string:generate> when invoked 1 time(s).
     Method was expected to be called 1 times, actually called 0 times.

     E:\Wouter\web\wamp\bin\php\php5.3.5\PEAR\phpunit:46

     FAILURES!
     Tests: 1, Assertions: 7, Failures: 1. 
```

为什么我会收到此错误？我想我`generate`在方法中调用了命令`GenerateControllerCommand::execute`？我做错了什么，可能是真的吗？或者这是 PHPunit 中的错误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-27T01:29:45.137

## 简而言之

您生成两个不同的`$generator`对象。通话发生在一个人身上，而另一个人接听了`expect`它。

* * *

## 更长

您更改了行为`protected function getGenerator()`，但原始函数期望调用该函数会填充`$this->generator`.

您的测试无法正常工作，并且该函数期望始终获得相同的生成器，并且随着您的覆盖，该函数将返回两个不同的对象。

您将预期的调用设置为一个，并且调用发生在对象上。

只是看着：

```
 $generator = $this->getGenerator();

    $generator
        ->expects($this->once())
        ->method('generate')
        ->with($this->getContainer()->get('kernel')->getBundle($bundle), $controller)
    ;

    $commandTester->execute($input, array('interactive' => false));
} 
```

该`$generator`变量不会放在任何地方的任何对象范围内，因此不会发生任何调用，因为每次调用都会`$this->getGenerator()`产生一个未存储在任何地方的新对象。

所以在

```
protected function getApplication() {
    //...
    $command->setGenerator($this->getGenerator());
    //...
} 
```

您的对象与测试用例中的对象不同。

# entity-framework - 实体框架一-多关系保存

> ID：12610883
> 
> 赞同：0
> 
> 时间：2012-09-26T21:40:44.573
> 
> 标签：entity-framework

我有以下内容：

```
 if (chemexist == false) // conditionally creating WtrChem record
    {
      WtrChem wc = new WtrChem();
      wc.Contact = "John Smith";
      ..
      wc.Phone = ("800-888-9988");
      Db.WtrChem.Add(wc);
      Db.SaveChanges();
    }

    WtrChemDetail psw = new WtrChemDetail (); // creating details record for WtrChem
    psw.Comments = comment;
    ..
    .. 
    Db.WtrChemDetail.Add(psw);
    Db.SaveChanges(); 
```

代码将首先创建主记录，然后创建详细记录。我有什么作品。我想知道在最佳实践方面是否有更有效的方法来完成我上面的工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:44:44.480

您可能希望对此进行建模，其中细节是主节点上的一个属性。

可能是这样的：

```
// Get the item. Include makes sure that you get the referenced detail as well.
WtrChem wc = Db.WtrChem.Include(x => x.Detail).SingleOrDefault();

if (wc == null) // creating WtrChem record
{
   // If it wasn't found, create and add
   wc = new WtrChem();
   Db.WtrChem.Add(wc);
}

wc.Contact = "John Smith";
..
wc.Phone = ("800-888-9988");

// Deal with the 
WtrChemDetail psw = new WtrChemDetail (); // creating details record for WtrChem
psw.Comments = comment;      
wc.Detail = psw;

Db.SaveChanges(); 
```

如果使用这种方法，主从之间的引用将自动排序。

您需要添加 using 语句才能使`.Include(..)`lambda 工作：

```
using System.Data.Entity; 
```

# ios - 如何将我的应用缩放到新的 Retina 4.5 1136x640 分辨率？

> ID：12610887
> 
> 赞同：1
> 
> 时间：2012-09-26T21:40:51.420
> 
> 标签：ios, retina-display

如何将我的应用缩放到新的 Retina 4.5 分辨率 (1136x640)？

我有现有的 xib 和基于故事板（非 xib）的应用程序，但找不到任何有关如何自动缩放到新分辨率的信息。

请给我 developer.apple.com 上的任何链接或 stackoverflow 上的主题或任何其他帮助。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T21:43:42.500

Apple 提供了 Auto Layout 机制，允许当前和未来版本的应用程序缩放到任何大小（适用于 iOS 和 OSX）。我建议您查看[Cocoa Auto Layout Guide](https://developer.apple.com/library/ios/#documentation/UserExperience/Conceptual/AutolayoutPG/Articles/Introduction.html)作为您的第一个停靠点。

Apple 还分享了一些来自 WWDC 2012 的开发者谈话视频，这些视频以教程截屏的方式解释了自动布局机制（需要有效的开发者帐户）

*   [WWDC 2012：iOS 和 OS X 自动布局简介](https://developer.apple.com/videos/wwdc/2012/?id=202)
*   [WWDC 2012：示例自动布局](https://developer.apple.com/videos/wwdc/2012/?id=232)
*   [WWDC 2012：掌握自动布局的最佳实践](https://developer.apple.com/videos/wwdc/2012/?id=228)

# iphone - iOS 6 中的 Game Center 出现问题

> ID：12610890
> 
> 赞同：1
> 
> 时间：2012-09-26T21:40:59.140
> 
> 标签：iphone, cocoa-touch, ios6, game-center

我曾经使用此代码在游戏中心登录用户帐户：

```
[[GKLocalPlayer localPlayer] authenticateWithCompletionHandler:^(NSError *error)
     {
         if (error != nil)
         {
             NSLog(@"LOGIN");
         } else {
             NSLog(@"CANT LOGIN");
         }
     }]; 
```

此代码在 iOS 5.x 中运行良好，但在 iOS 6 中崩溃，如果您能帮助修复它，我将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-19T19:19:21.257

您需要检查iOS5或6。iOS6更改了身份验证功能

iOS6

```
 localPlayer.authenticateHandler = ^(UIViewController *viewController, NSError *error)
    {
        //Something
    } 
```

iOS5

```
 [localPlayer authenticateWithCompletionHandler:^(NSError *error)
    {
        //Something
    }]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-06T00:18:15.170

这适用于 iOS 6：

```
 GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];
    localPlayer.authenticateHandler = ^(UIViewController *viewController, NSError *error) {
        if (viewController != nil) {
            [self presentViewController:viewController animated:YES completion:nil];
        } else if (localPlayer.isAuthenticated) {
            // do post-authentication work
        } else {
            // do unauthenticated work, such as error message, etc
        }
    }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-27T15:48:00.540

在这里你有[游戏中心编程指南](http://developer.apple.com/library/ios/#DOCUMENTATION/NetworkingInternet/Conceptual/GameKit_Guide/Users/Users.html)

这是您必须在 iOS6 中验证用户的方式：

```
- (void) authenticateLocalPlayer
{
    GKLocalPlayer *localPlayer = [GKLocalPlayer localPlayer];
    localPlayer.authenticateHandler = ^(UIViewController *viewController, NSError *error){
         if (viewController != nil)
         {
             [self showAuthenticationDialogWhenReasonable: viewController
         }
         else if (localPlayer.isAuthenticated)
         {
             [self authenticatedPlayer: localPlayer];
         }
         else
         {
             [self disableGameCenter];
         }
     }];
} 
```

您还应该检查[这个问题](https://stackoverflow.com/questions/12427979/gamecenter-authentication-in-landscape-only-app-throws-uiapplicationinvalidinter)，因为您的应用程序可能由于自动旋转问题和游戏中心而崩溃，而不是身份验证机制本身

# glassfish - 通过 cli 部署到远程 Glassfish 实例

> ID：12610891
> 
> 赞同：5
> 
> 时间：2012-09-26T21:41:01.043
> 
> 标签：glassfish, asadmin

我正在尝试通过命令行自动将我们的 Java EE 应用程序从我们的构建服务器 (Jenkins) 部署到远程 Glassfish 服务器。目前我正在为此使用 asadmin 并且它工作正常，但是这个选项要求我在构建服务器上也安装 Glassfish - 我想避免这种情况，因为我不需要它。构建服务器实际上只运行构建和部署，所以我想让服务器尽可能“干净”。

我找不到任何只安装 asadmin 工具的下载，而且我尝试手动复制只需要的文件失败了，因为某些 *.jars 有一些我不知道的依赖项，所以它总是失败，除非我将整个 glassfish 安装文件夹复制到构建服务器。

所以我的问题是：有人知道如何只安装 asadmin 工具而不安装整个 Glassfish 服务器吗？或者，我也很乐意使用任何其他命令行工具，只要它们允许我使用安全通信部署到远程 Glassfish 实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-28T00:41:53.610

在进行了更多研究之后，我放弃了尝试在没有完整 Glassfish 安装的情况下安装 asadmin 的想法，而是使用 Glassfish 的 REST 管理界面。

我现在在一个简单的批处理文件中使用 CURL 使它工作：

```
curl.exe ^
    --user glassfish_username:glassfish_password ^
    --insecure ^
    -H "Accept: application/json" ^
    -H "X-Requested-By: dummy" ^
    -X POST ^
    -F id=@yourfile.war ^
    -F contextroot=yourcontextroot ^
    -F force=true ^
    https://yourservername:4848/management/domain/applications/application/ 
```

一旦你知道你需要做什么，REST API 就相当简单了，但以防万一其他人需要它，这里有几个要点：

*   --insecure 是必需的（通过 CURL）以允许自签名和不受信任的 SSL 证书
*   必须设置“Accept”和“X-Requested-By”的标头属性，否则 Glassfish 不会处理请求，只会返回一个空白文档作为应答。不知道为什么，但设置这些参数使它工作。
*   war 文件的内容在 POST 上作为“id”参数传递
*   URL 需要与上面截断的完全一样，即不要将“domain”替换为您的域名或将“application”替换为您的应用程序名称。这是实际的 REST 接口端点。无需在任何地方指定域/应用程序名称。

# matlab - Matlab地板错误？

> ID：12610903
> 
> 赞同：2
> 
> 时间：2012-09-26T21:41:38.117
> 
> 标签：matlab, floating-point, rounding, precision

我想我在 Matlab 中发现了一个错误。我唯一的解释是，matlab 在内部使用其他值而不是显示的值进行计算：

```
K>> calc(1,11)

ans =

   4.000000000000000

K>> floor(ans)

ans =

     3 
```

显示的代码是 Matlab 控制台的输出。calc(x,y) 只是一个双精度值数组。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-09-26T23:05:20.220

MATLAB 使用标准 IEEE 浮点形式来存储双精度数。

看到如果我们从 4 中减去一小部分，MATLAB 仍然显示 4 作为结果。

```
>> format long g
>> 4 - eps(2)
ans =
                         4 
```

事实上，MATLAB 以二进制形式存储数字。我们可以看到该数字的十进制版本为：

```
>> sprintf('%.55f',4-eps(2))
ans =
3.9999999999999995559107901499373838305473327636718750000 
```

显然 MATLAB 不应该显示所有数字，但是通过将结果四舍五入为 15 位，我们得到 4 用于显示。

显然，calc(1,11) 中的值就是这样一个数字，在内部表示为小于 4，只是一根头发太少了，以至于它在显示时四舍五入到 4，但它不完全是 4。

永远不要相信浮点运算结果中显示的最低有效数字。

编辑：

您似乎认为 MATLAB 中的 3.999999999999999 应该小于 4。从逻辑上讲，这是有道理的。但是，当您提供该号码时会发生什么？啊，是的，浮点双精度的粒度比这大。MATLAB 不能将其表示为小于 4 的数字。它在内部将该数字向上四舍五入为 4。

```
>> sprintf('%.55f',3.9999999999999999)
ans =
4.0000000000000000000000000000000000000000000000000000000 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-26T22:49:23.220

你得到的是一个非常接近但低于 4 的值，即使使用`format long`Matlab 也必须四舍五入到第 15 位才能显示数字。尝试这个：

```
format long
asd = 3.9999999999999997 %first not-9 @16th digit 
```

将打印`4.000000000000000`。任何不知道`asd`基于可视化的实际值的人都会猜测它至少是 4，但是运行

```
asd >= 4 
```

给出`0`，所以`floor(asd)`返回`3`。

Matlab如何对显示的输出进行四舍五入也是一个问题，存储在变量中的真实值小于4。

**更新：**

如果您进一步使用数字，例如 18x9：

```
>> asd = 3.999999999999999999
asd = 
     4
>> asd == 4
ans =
     1 
```

`asd`就变成了`4`！（注意它不再显示`4.000000000000000`）但这是另一个故事，不再是关于将数字四舍五入以获得更漂亮的输出，而是关于浮点运算的工作原理......实数可以表示为一定的相对精度：在这种情况下，您给出的数字非常接近 4，以至于它本身变成了 4。查看@gokcehan 或[此处](http://en.wikipedia.org/wiki/Machine_epsilon)的评论中发布的 Python 链接。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-03-26T01:42:58.800

我不会讨论这个问题，而是提供一个解决方案：使用`single`函数：

> B = single(A) 将矩阵 A 转换为单精度，在 B 中返回该值。A 可以是任何数字对象（例如双精度）。如果 A 已经是单精度，则 single 无效。单精度数量比双精度数量需要更少的存储空间，但精度更低，范围更小。

这只是为了解决这个特定问题，所以你会这样做：

```
K>> calc(1,11)

ans =

   4.000000000000000

K>> floor(single(ans))

ans =

 4 
```

# vim - 将 vim 的状态行的“文件已修改”标志更改为更明显

> ID：12610906
> 
> 赞同：7
> 
> 时间：2012-09-26T21:41:55.760
> 
> 标签：vim, statusline

我一直这样做：

编辑一个文件，回到终端并执行我正在编写的脚本......只是意识到我还没有将它写入磁盘。

我该如何做到这一点，以便每当文件未写入时，vim 基本上都会对着我的眼睛大喊大叫？那个微小的 [+] 还不够好。理想情况下，我想要么增加显示的红色加号的数量，要么增加一些更激烈的东西。

例如，我正在使用电力线（纯粹是为了获得更明显的“文件已被修改”通知程序）。我认为，如果在未保存文件时更改栏底部的主要颜色，那将是非常棒的。

有任何想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T21:51:29.610

如果需要，您可以设置 vim 以显示文件修改标志 5 次。

```
set statusline+=%m 
```

这增加了一次。将“%m”的数量增加到您想要的任何数量。进一步的解释和技巧在这里： http: [//got-ravings.blogspot.co.at/2008/08/vim-pr0n-making-statuslines-that-own.html](http://got-ravings.blogspot.co.at/2008/08/vim-pr0n-making-statuslines-that-own.html)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T21:55:06.737

我为此编写了[StatusLineHighlight 插件](http://www.vim.org/scripts/script.php?script_id=3383)。对于修改过的缓冲区，它将状态行的颜色更改为红色（可自定义）。

但是，它不能与 Powerline 或其他花哨的状态线修改一起使用。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-09-27T15:19:29.250

这不是你问的问题的答案，但你为什么不这样做

```
set autowrite 
```

使您提到的问题（“回到终端并执行我正在编写的脚本......只是意识到我还没有将它写入磁盘”）消失：此选项使 vim 保存您在执行时所做的更改暂停它（注意：不是在你`:shell`用来生成新的 shell 时）。

对于电力线，您唯一可以轻松做的事情就是编辑颜色方案以使突出显示更明显：复制`autoload/Powerline/Colorschemes/default.vim`到`~/.vim/autoload/Powerline/Colorschemes/my.vim`，查找`Pl#Hi#Segments(['fileinfo.flags'`并在每行中添加第二种颜色（背景颜色）：转换`['brightestred', ['bold']]`为`['white', 'brightestred', ['bold']]`等等。然后加

```
let g:Powerline_colorscheme='my' 
```

到 vimrc 并运行`:PowerlineClearCache`.

# java - CardLayout 性能？

> ID：12610911
> 
> 赞同：2
> 
> 时间：2012-09-26T21:42:23.133
> 
> 标签：java, swing, vector, jpanel, cardlayout

我认为 CardLayout 使用 HashMap 来存储它的对（面板和相关的字符串标识符），但是通过 CardLayout 类我注意到它实际上使用了一个 Vector。这就是我的理解：当`show`调用该方法时，它会循环检查向量的内容，`equals`以确定这是否是适当卡片的名称，如果是，则循环遍历容器的所有面板要找出当前可见的卡片，它会将其隐藏，然后显示相应的卡片。

如果我正在制作一个有*很多*不同面板的 gui 应用程序，那么翻转到所需面板不是一种缓慢的技术吗？我应该更好地使用我自己的方式来显示我的面板，比如将它们存储到一个数组中并手动使用`add`/`remove`或`setVisible`代替使用 CardLayout 吗？这实际上是我在最终使用 CardLayout 之前开始使用的方式。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-27T00:35:52.230

这**永远不会成为问题**：您通常不会经常在组件之间切换，当您这样做时，扫描一个包含少量组件（通常是 3-100 个？）的列表将花费的时间可以忽略不计其他必须发生的操作（例如绘制新组件）。从性能的角度来看，数据结构的选择基本上是无关紧要的——你可以使用链表而没有人会注意到。

另请注意，**HashMap 不适合**CardLayout，因为它需要保留卡片的*顺序*，以便您可以使用`first`/ `next`/`previous`等。

所以基本上，不用担心，也不要浪费时间滚动你自己的 CardLayout 克隆 - CardLayout 工作得很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:54:10.623

我在 CardLayout 中没有发现任何性能问题。即使你有 1000 个子组件，它仍然感觉非常快。通过使用上一个/下一个或使用显示，它运行得非常快。

尝试发布重现您的问题的[SSCCE](http://sscce.org)，然后我们可以帮助您。下面是一些开始：

```
import java.awt.BorderLayout;
import java.awt.CardLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;

import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.SwingUtilities;

public class TestCardLayout {

    protected void initUI() {
        JFrame frame = new JFrame("test");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        final CardLayout layout = new CardLayout();
        final JPanel panel = new JPanel(layout);
        for (int i = 0; i < 1000; i++) {
            panel.add(new JLabel("Label " + i), getLabelConstraint(i));
        }
        JButton next = new JButton("Next");
        next.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                layout.next(panel);
            }
        });
        JButton previous = new JButton("Previous");
        previous.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                layout.previous(panel);
            }
        });
        final JButton choose = new JButton("Choose");
        choose.addActionListener(new ActionListener() {

            @Override
            public void actionPerformed(ActionEvent e) {
                String value = JOptionPane.showInputDialog(choose, "Enter a number between 0 and 999");
                try {
                    int i = Integer.valueOf(value);
                    if (i > -1 && i < 1000) {
                        layout.show(panel, getLabelConstraint(i));
                    }
                } catch (NumberFormatException e1) {
                    e1.printStackTrace();
                }
            }
        });
        JPanel buttonPanel = new JPanel();
        buttonPanel.add(previous);
        buttonPanel.add(next);
        buttonPanel.add(choose);

        frame.add(buttonPanel, BorderLayout.SOUTH);
        frame.add(panel);
        frame.pack();
        frame.setLocationRelativeTo(null);
        frame.setVisible(true);
    }

    private String getLabelConstraint(int i) {
        return "ComponentConstraint" + i;
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {

            @Override
            public void run() {
                new TestCardLayout().initUI();
            }
        });
    }
} 
```

# ruby-on-rails-3 - 在哪里可以找到此错误消息的原因？（rails 3.2.8 嵌套形式）

> ID：12610912
> 
> 赞同：0
> 
> 时间：2012-09-26T21:42:41.637
> 
> 标签：ruby-on-rails-3, nested-attributes

我的新合同表格用于工作......它仍然需要一些改进......但当前版本用于工作，但现在我收到此消息：

```
 3 errors prohibited this codeline from being saved:

 There were problems with the following fields:

   Contract can't be blank
   Client can't be blank
   Code can't be blank 
```

我没有任何名为 Contract、Client 或 Code 的字段……这些是我的模型。

这是我在 codelines_controller 中提出的参数：

```
{"contract_attributes"=>{"authnum"=>"900700", "st_date"=>"2012-09-03",
 "end_date"=>"2012-12-31"}, "client_attributes"=>{"f_name"=>"Esme", "mi"=>"J",
 "l_name"=>"Inneed", "birth_date"=>"1986-03-18", "address1"=>"62 Southy View",
 "address2"=>"", "city"=>"Fromm", "zip_code"=>"55803", "state"=>"WI",
 "medicare_num"=>"3008769788", "medicaid_num"=>"765894567", "member_num"=>"6709875-3",
 "soc_sec_care_mgr"=>"Caring Manager", "sscm_ph"=>"1-444-444-4444",
 "nurse_care_mgr"=>"Caring Nurse", "ncm_ph"=>"1-555-555-5555", "emer_contact"=>"Always
  Here", "ec_ph"=>"1-666-666-6666", "pri_care_phy"=>"The One", 
 "pcp_ph"=>"1-777-777-7777"}, "code_attributes"=>{"code_name"=>"S-5463",
 "status"=>"Active", "description"=>"Transition from schl to work"},
 "units_alloc"=>"100.00"} 
```

如您所见，所有需要数据的字段都有数据并且不是“空白”

我确实签订了合同，看看是否可以让专业人士帮我设计一个按钮来为表单添加额外的属性，但我不得不取消合同，因为他们没有沟通。所以这个过程的一部分要求我让他们成为 github 和 heroku 的合作者。也许他们必须改变一些东西才能在这个项目上工作？

有人可以就如何解决这个问题给我一些指导吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:46:45.927

查看 app/models/theModelThatIsUsed.rb ，如果你发现类似：

```
validates :contract, :presence => true
validates :client, :presence => true
validates :code, :presence => true 
```

删除那几行

# spring - 是否可以在 c:set 中使用 Spring SpEL 表达式来实例化新类？

> ID：12610913
> 
> 赞同：1
> 
> 时间：2012-09-26T21:42:47.237
> 
> 标签：spring, jstl, spring-el

我想做类似的事情：

```
<c:set var="customer" value="${new com.test.Customer()}" /> 
```

但这不起作用。有这样的可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T12:43:52.840

您可以使用新的 spring:eval JSP 标签，它允许您从 JSP 页面评估 SpEL 表达式，而不是 c:set。

# java - Session.flush() 没有按预期工作

> ID：12610914
> 
> 赞同：5
> 
> 时间：2012-09-26T21:42:54.007
> 
> 标签：java, spring, hibernate

在服务类中，我有一个从方法调用的`@Transactional`方法。我已经验证在调用此代码时我有一个事务处于活动状态。我意识到我应该没有 DA 层，但我正在使用一个遗留应用程序，这使得做事“正确”的方式比此时的价值更麻烦。

映射如下所示：

```
public class Foo {

  private String id;
  private Bar bar;

  @Id
  @Column(name = "FOO_ID", unique = true, nullable = false, length = 16)
  @GeneratedValue(generator = "blahIdSeq")
  @GenericGenerator(name = "blahIdSeq",
                    strategy = "org.blah.CustomIdGenerator")
  public String getId() {return id;}

  @JoinColumn(name = "FOO_ID")
  @OneToOne(fetch = FetchType.LAZY, optional = false)
  public Bar getBar() { return bar; }

  // SETTERS INCLUDED

}

public class Bar {
  private String id;
  private Foo foo;

  @Id
  @Column(name = "FOO_ID")
  @GeneratedValue(generator = "someSeq")
  @GenericGenerator(name = "someSeq",
                    strategy = "foreign",
                    parameters = {
                      @Parameter(name = "property", value = "foo")
                    })
  public String getId() { return id; }

  @OneToOne(fetch = FetchType.LAZY)
  @PrimaryKeyJoinColumn(name = "FOO_ID")
  public Foo getFoo() { return foo; }

  // SETTERS INCLUDED

} 
```

该方法看起来像这样：

```
public String createFoo(Foo foo) {
  Session ses = getSessionFactory().getCurrentSession();
  Bar bar = new Bar();
  bar.setFoo(foo);
  foo.setBar(bar);
  ses.save(foo);
  ses.save(bar);

  System.out.println(foo.getId()); // yields the ID value set by generator
  System.out.println(bar.getId()); // yields same ID value as above

  ses.flush();
  ses.refresh(foo);
} 
```

现在，将`org.hibernate.SQL`日志记录设置为`DEBUG`，我可以看到 Foo 和 Bar 的插入语句都已创建，但调用刷新后的刷新会引发`org.hibernate.UnresolvableObjectException: No row with the given identifier exists`异常。

什么可能导致这种情况？使用的数据库是 Oracle 11gR2。

## 更新

我已将问题缩小到会话。似乎调用`currentSession.flush()`并没有按预期将数据写入数据库以进行刷新。如果我注释掉该方法的其余部分，它将在最后提交，并且所有内容都将在数据库中。

但是，执行刷新/刷新不会返回水合对象，因此我不能在以后的事务中使用数据库填充的值（由列默认设置）。我也不能将事务拆分为多个，因为我需要能够在方法中的任何点回滚。

关于为什么刷新没有为我提供数据库中可访问的数据的任何想法？

## 另一个更新

我已经移动了很多代码只是为了尝试隔离问题，但我仍然遇到问题。我还摆脱了两个实体之间的关系，尝试手动处理所有事情，看看这是否能解决问题。考虑到史蒂夫的所有评论，这就是我现在所拥有的：

```
public class Foo {

  private String id;
  private Bar bar;

  @Id
  @Column(name = "FOO_ID", unique = true, nullable = false, length = 16)
  @GeneratedValue(generator = "blahIdSeq")
  @GenericGenerator(name = "blahIdSeq",
                    strategy = "org.blah.CustomIdGenerator")
  public String getId() {return id;}

  // SETTERS INCLUDED

} 
```

* * *

```
public class Bar {
  private String id;
  private Foo foo;

  @Id
  @Column(name = "FOO_ID")
  public String getId() { return id; }

  // SETTERS INCLUDED

} 
```

* * *

```
@Service('fooService')
@Transactional(readOnly = true)
class FooService {
  @Autowired
  SessionFactory sessionFactory // populated using Spring config:
                                // org.springframework.orm.hibernate3.annotation.AnnotationSessionFactoryBean

  @Transactional(readOnly = false)
  public void doSomeStuff(Foo fooToSave) {
    sessionFactory.getCurrentSession().saveOrUpdate(fooToSave);
    Bar bar = new Bar(fooToSave); // this populates the Bar.Id field
    sessionFactory.getCurrentSession().saveOrUpdate(bar);
    sessionFactory.getCurrentSession().flush();
    sessionFactory.getCurrentSession().refresh(fooToSave); // exception thrown here
  }
} 
```

## 另一个更新

在 Oracle 领域进行了相当多的尝试以确保 SQL 在同一个会话等上运行之后，我发现了这个问题。即使 Hibernate 记录了正在设置 SQL 绑定变量，但实际上并没有。使用 Oracle 11gR2 `V$SQL_BIND_CAPTURE`，我可以看到使用最后执行的 SQL ID（验证为插入语句）有 24 个绑定变量，并且没有一个绑定了值。仍然不确定是什么导致这些值变为空白，但我离找到答案更近了一点。这一定是我的映射有问题，我不能完整地放在这里。

作为绑定变量，我猜 Oracle 不会因为无法插入而感到不适。JDBC 通常只返回为验证语句插入的行数`INSERT`，但我不确定 Hibernate 抽象是如何处理这些东西的。我目前正在使用 Hibernate 3.6.10——从 3.6.5 升级，看看它是否可以解决问题。它没有。:P

## 我被误导了

忽略上面的“还有一个更新”部分。`V$SQL_BIND_CAPTURE`绑定变量似乎在事务提交之前不会出现在视图中。回到绘图板。

## 另一个修订 - 我发誓我会被禁止

我决定回到基础。自从它处于工作状态以来，我发生了什么变化？主要是映射。一些服务层项目也发生了变化，但主要是将我们的 Hibernate 映射从 XML 移动到注释。因此，我采用了我一直在使用的相同服务方法，注释掉了所有其他内容，并尝试做与我尝试`Foo`使用另一种持久对象类型所做的完全相同的事情。你猜怎么着？这样可行。在这一点上，唯一可能导致我心痛的链接是我拥有的映射`Foo`。我怀疑我的雇主是否希望我在 SO 上提供全部资源，所以我可能不得不自己解决这个问题。当我最终弄清楚时，我会以某种身份发布答案。

## 成功！但我不确定为什么...

这是给我带来麻烦的代码。请记住，这`BAZ`是一个链接表，其复合 ID 由一个`@Embeddable`（在本示例中称为“键”）组成，包括`FOO_ID`引用表中的一行`FOO`和`STATE_ID`引用另一个表。

```
public class Foo {

  // OTHER FIELDS INCLUDING IDs AND SUCH

  private Baz bazOfDoom;
  private Baz bazOfLight;
  private Set<Baz> allTheBaz;

  @OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.REFRESH)
  @JoinColumns({
    @JoinColumn(name = "FOO_ID", referencedColumnName = "FOO_ID", insertable = false, updatable = false, nullable = false)
    @JoinColumn(name = "DOOM_ID", referencedColumnName = "STATE_ID", insertable = false, updatable = false, nullable = false)
  })
  public Baz getBazOfDoom() { return bazOfDoom; }

  @OneToOne(fetch = FetchType.LAZY, cascade = CascadeType.REFRESH)
  @JoinColumns({
    @JoinColumn(name = "FOO_ID", referencedColumnName = "FOO_ID", insertable = false, updatable = false, nullable = false)
    @JoinColumn(name = "LIGHT_ID", referencedColumnName = "STATE_ID", insertable = false, updatable = false, nullable = false)
  })
  public Baz getBazOfLight() { return bazOfLight; }

  @OneToMany(mappedBy = "key.foo", fetch = FetchType.LAZY, cascade = CascadeType.REFRESH)
  public Set<Baz> getAllTheBaz() { return allTheBaz; }
} 
```

我移除了级联并且它起作用了。我不知道为什么。谁能解释这将得到我的“正确答案”标记。:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T23:16:56.920

在将对象保存到数据库后，您的对象似乎不拥有对象的标识符，从而导致调用 refresh() 时出现异常。

实际上，假设您的数据库表拥有定义为的主键。因此`auto-increment`，当您保存第一个 Foo 对象时，主键列的值为：`1`。

然而，Hibernate 必须在调用 save() 方法后知道这个新生成的标识符！

最好的方法是期望 Hibernate 在对象保存到数据库后立即重新影响良好的标识符。

因此，您可能会在实体类中错过这一行，以便在将对象保存在数据库中时自动提供标识符：

```
@GeneratedValue(strategy = GenerationType.AUTO) 
```

当然，您不必自动生成它们，而是可以手动精确它。

# c++ - 检测扫描文档的类型并将其标准化为给定尺寸

> ID：12610919
> 
> 赞同：1
> 
> 时间：2012-09-26T21:43:12.037
> 
> 标签：c++, opencv, ocr, detection, scanning

我正在尝试实现一个程序，该程序将扫描（可能旋转）的文档（如身份证），根据两个或多个图像模板检测其类型并将其标准化（取消旋转并调整大小以使其与模板匹配）。一切都会被扫描，所以幸运的是透视不是问题。

我已经尝试了很多方法都没有成功：

*   我尝试使用 openCV 的 features2d 来检测模板并使用 findHomograpy 对其进行规范化，但它经常失败。如果我拿一个模板，稍微改变一下（身份证上的其他数据/照片），旋转约 40 度然后它通常会失败，无论我使用什么配置的描述符检测器和匹配器。

*   还尝试了这个[http://manpages.ubuntu.com/manpages/gutsy/man1/unpaper.1.html](http://manpages.ubuntu.com/manpages/gutsy/man1/unpaper.1.html)这是一个反旋转工具，然后尝试进行正常匹配，但 unpaper 在旋转角度大于20度

如果有现成的解决方案，那就太好了，商业库（最好是 c/c++ 或命令行工具）也是一种选择。我不想承认这一点，但是当我试图理解计算机视觉论文时，我惨遭失败，所以不幸的是，链接对我没有帮助。

非常感谢您的帮助！

# serial-port - 未连接到 Windows CE 设备上的调试器时似乎会发生串行超频

> ID：12610930
> 
> 赞同：1
> 
> 时间：2012-09-26T21:43:56.277
> 
> 标签：serial-port, windows-ce

我在使用 Windows CE 6 和带有处理器 Freescale IMX51 的 DIGI 设备时遇到问题。我使用 DIGI 的 BSP 用 C# 编写了一个应用程序，以使用 ARM eSPI（增强型串行外设接口）。

然后使用DIGI发布的功能，在调试中，我可以使用SPI激活OLED，但是当我在设备上启动应用程序时，OLED不再工作。

我用示波器看到，当我在调试模式下加载应用程序时，位数是正确的，即时钟有 8 个上升沿，但是当从设备启动应用程序时，时钟会有所增加，也就是说，我见 9 位。当我使用调试目录中的 .exe 时也会发生这种情况。

我不明白为什么会这样。谁能帮我解决这个问题？

# java - 部分读取远程文件而不完全下载

> ID：12610932
> 
> 赞同：0
> 
> 时间：2012-09-26T21:44:06.737
> 
> 标签：java, file-io, remote-access

是否可以编写一个程序来读取位于远程计算机（可通过网络访问）上的大文件的最后 N 行，而无需将所有文件下载到本地计算机？只能在本地计算机上执行，不能在远程进行更改。

如果有可能，我们如何在 Java 中做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:30:49.597

您应该使用无缓冲的 io 函数来打开和访问文件（`open`/ `read`/`lseek`或`CreateFile`/ `ReadFile`/ `SetFilePointer`）。然后你`open`的文件，并寻找接近文件末尾的位置：`lseek(fd,SEEK_END,-1024)`. 然后从文件中读取 1024 个字节，并扫描读取的数据以查找行终止序列。如果行数小于 N+1，那么您再次寻找但偏移量为 -2048 并读取额外的 1024 个字节。您迭代该过程，直到您在缓冲的数据中看到 N+1 行终止序列。

而已。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-08T19:37:03.047

请参阅以下内容：[快速读取文本文件的最后一行？](https://stackoverflow.com/questions/686231/java-quickly-read-the-last-line-of-a-text-file)

它们还提供了如何读取文件最后 N 行的示例。通过使用 seek 命令，您可以跳过不想读取的字节。

# sql - SQL 中按周期划分的结果百分比

> ID：12610933
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:44:07.547
> 
> 标签：sql, percentage, period

我想从每个时期的这些数据中计算 SQL 中的结果百分比。

```
Period  Result
1        Green
1        Blue
1        Blue
1        Red
1        Blue
1        Blue
1        Blue
2        Green 
2        Green 
2        Green
2        Blue
2        Red
2        Red 
```

预期结果 ..

```
Period  Result  Percentage
1        Blue     72%
1        Green    9%
1        Red      9%
2        Blue     17%
2        Green    50%
2        Red      33% 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T21:52:32.090

`COUNT`首先`Period`，将结果与原始表再次连接，按`Period`和分组`Result`，然后进行除法以获得百分比：

```
SELECT t.Period, t.Result, ((COUNT(t.Result) / Cnt) * 100) Percentage
FROM table t 
     INNER JOIN (SELECT Period, COUNT(*) Cnt
                 FROM table
                 GROUP BY Period) period_cnt 
     ON t.Period = period_cnt.Period
GROUP BY t.Period, t.Result 
```

您可能需要调整舍入，并使用`CONCAT`将字符添加`%`到输出中，但这应该相当容易。

此外，您第一期的*平均值*是错误的，它应该加起来`100`。绿色和红色应该有值`14`。

**[演示](http://sqlfiddle.com/#!2/c224d0/9)**。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:01:12.680

像这样的东西（ANSI SQL）：

```
select period,
       result,
       (count(result) / total_period) * 100 as result_percent
from (
  select period, 
         result,
         count(*) over (partition by period) as total_period
  from periods  
) as t
group by period, total_period, result
order by period, result; 
```

根据您的 DBMS，您可能需要将整数值转换为小数才能查看小数值。

演示：[http ://sqlfiddle.com/#!1/2ec4f/1](http://sqlfiddle.com/#!1/2ec4f/1)

# gwt - GWT 2.4 自定义 ListBox 不会触发 Change 事件

> ID：12610939
> 
> 赞同：1
> 
> 时间：2012-09-26T21:44:20.893
> 
> 标签：gwt, listbox

我通过像这样扩展它，为标准 GWT ListBox 添加了一些额外的功能：

```
public class FeatureListBox extends ListBox
{
    public FeatureListBox()
    {
    }
    public FeatureListBox(boolean isMultipleSelect)
    {
        super(isMultipleSelect);
    }
    public FeatureListBox(Element element)
    {
        super(element);
    }
} 
```

这里没有什么花哨的。但是，Change 事件现在没有触发，或者至少处理程序（附在下面）没有被调用。

```
FeatureListBox listBox = new FeatureListBox();
listBox.addChangeHandler(new ChangeHandler()
{
    public void onChange(ChangeEvent event)
    {
        // Do something here...
    }
}); 
```

任何想法为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:12:05.807

要么从中删除无参数构造函数，`FeatureListBox`要么在其中调用`super()`，否则超类中的初始化将不会发生，这可能会导致您所看到的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-27T14:36:28.023

问题在于我使用自定义列表框的方式。在我的应用程序中，我使用其小部件类的静态**wrap()方法将 GWT 小部件包装在页面上现有的 DOM 元素周围，其中小部件被标记为已连接，从而使它们触发事件。**我最初并没有对我的自定义列表框类这样做，所以我最终实现了一个类似于常规 ListBox 小部件的静态**wrap()方法并在我的代码中使用它。**现在一切都像魅力一样。

# c - 套接字：获取未知字符而不是 HTML 内容

> ID：12610940
> 
> 赞同：1
> 
> 时间：2012-09-26T21:44:28.100
> 
> 标签：c, linux, sockets, gcc

我有这个简单的 C 代码，它尝试使用 80 端口连接到 www 主机。我收到的是正常的 http 标头响应，但我收到的不是 HTML 内容，而是未知字符（我在打印垃圾吗？）

（facebook.com 只是一个例子，它发生在任何服务器上）查看我的代码：

```
 #define BUF_SIZE 4096
  struct sockaddr_in sockaddr;
  struct hostent *host;

  char buffer[BUF_SIZE] = { 0 };
  int sock;

  static const char const headers[] =
    "GET / HTTP/1.1\r\n"
    "Host:www.facebook.com\r\n"
    "User-Agent:Mozilla/5.0 (X11; Linux i686; rv:7.0.1) Gecko/20100101 Firefox/7.0.1\r\n"
    "Accept-Charset:ISO-8859-1,utf-8;q=0.7,*;q=0.7\r\n"
    "Accept:text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
    "Accept-Encoding:gzip,deflate\r\n"
    "Connection:close\r\n"
    "\r\n\r\n";

  if((sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP)) == -1) {
    perror("Cannot create TCP socket");
    exit(1);
  }

  if((host = gethostbyname("www.facebook.com")) == NULL) {
    perror("Cannot get host");
    exit(1);
  }

  memset(&sockaddr, 0, sizeof(sockaddr));
  sockaddr.sin_family = AF_INET;
  memcpy(&sockaddr.sin_addr,
     host -> h_addr_list[0],
     (size_t) host -> h_length);
  sockaddr.sin_family = AF_INET;
  sockaddr.sin_port = htons(80);

  if(connect(sock, (struct sockaddr *)&sockaddr, sizeof(struct sockaddr)) == -1) {
    perror("cannot connect");
    exit(1);
  }

  if(send(sock, headers, strlen(headers), 0) == -1) {
    perror("Cannot send packet");
    exit(1);
  }

  ssize_t readed;
  while((readed = recv(sock, buffer, BUF_SIZE, 0)) > 0) {
    write(fileno(stdout), buffer, readed);
    memset(buffer, 0, readed);
  }

  close(sock); 
```

响应示例：

```
HTTP/1.1 200 OK
Cache-Control: private, no-cache, no-store, must-revalidate
Expires: Sat, 01 Jan 2000 00:00:00 GMT
P3P: CP="Facebook does not have a P3P policy. Learn why here: http://fb.me/p3p"
Pragma: no-cache
X-Content-Type-Options: nosniff
X-Frame-Options: DENY
X-XSS-Protection: 1; mode=block
Set-Cookie: datr=7HVjUC3-OlTdOMH3HivA_8Ge; expires=Fri, 26-Sep-2014 21:38:52 GMT; path=/; domain=.facebook.com; httponly
Set-Cookie: reg_ext_ref=deleted; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/; domain=.facebook.com
Set-Cookie: reg_fb_gate=http%3A%2F%2Fwww.facebook.com%2F; path=/; domain=.facebook.com
Set-Cookie: reg_fb_ref=http%3A%2F%2Fwww.facebook.com%2F; path=/; domain=.facebook.com
Content-Encoding: gzip
Content-Type: text/html; charset=utf-8
X-FB-Debug: 36+IohXvxWRp+3LHt+aLebawuS3W/MaBkmgR9TJGMrk=
Date: Wed, 26 Sep 2012 21:38:52 GMT
Transfer-Encoding: chunked
Connection: close

2f03
�}Yo�X��{�
�S-U)���P!����V��2�
                  F�A�AFr       -9
                                        �
��0�p�{�1cx��1`▒������0m�                �
                         �\��XH)3U�v��yy���{��g�O��:�l_�lKoh�����L��7��'K�֐{jW����,uM�ue+��L�uU[:�=U�T�ս��{�LM���Oݮc����ou=ö$�▒;XR��G;K]�e;KcՑ4ɰ$u��Z{�P�c���[�6,;^u�w���������K��m��v����A���v!�pm�m�W���'�A�ծٹk��q���������Z�g�Ǘ�#�+���\��tU�������*s�V�ڶ7��W��[�����������xO��uM��jZ���ptR����Z5qv�QO��Ʀww���5K7�����Mg�c^쩻C+h��M<;V՛ڕ��e���P�1��գw���?���~w~�����ܖ�ky�U����X�����UTk\�Xw�'�b�V\����<Єҳ���ؖbڪ��z*�'%���⍬[od��]�H��W��?F��q� ��M�&lt;�n�Owl)�&gt;�fK�R~E�
                                                                                ��
[...] 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-09-26T21:46:19.787

删除行：

```
"Accept-Encoding:gzip,deflate\r\n" 
```

因为它告诉远程主机 yoz 接受压缩数据，而你不接受！

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T21:46:53.363

这很简单。您形成了一个请求，通知服务器您支持 gzip 传输编码。从您的请求中删除`"Accept-Encoding:gzip,deflate\r\n"` ，您将看到纯文本作为响应

# php - 无法使用 ' 正确搜索数据库

> ID：12610946
> 
> 赞同：0
> 
> 时间：2012-09-26T21:44:48.283
> 
> 标签：php, mysql, web-applications, utf-8, character-encoding

我在搜索 MySQL 数据库时遇到问题。数据库排序规则为`utf8_general_ci`，表排序规则为`latin1_swedish_ci`。我的问题是这样的：

用户条目存储为 (fake name for privacy) `T&#39;quila Smith`，真实名称为`T'quila Smith`。

我的 Web 应用程序需要能够按名称正确搜索该用户，但名称被搜索为`T'quila`，而不是`T&#39;quila`. 我尝试过使用`$student_name = str_replace("'", "&#39;", $student_name);`，它（在使用 echo 测试时）会按应有的方式打印出来`T&#39;quila`。但是，数据库无法通过该搜索在数据库中找到该用户。

任何人都可以提供一些帮助吗？我一直不知道该怎么做。我研究了字符集（我认为这可能是问题），但我似乎无法让它工作。非常感谢能帮助我的人！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-27T04:57:25.380

OP在这里（不同的帐户......不在工作）。我可以通过 PHPMyAdmin 访问数据库，所以我可以看到表中的所有行。由于我现在不在工作，我无法尝试您的建议，但我稍后会尝试。不过感谢您的建议！

# objective-c - RestKit - 尝试将对象发布到服务器

> ID：12610947
> 
> 赞同：0
> 
> 时间：2012-09-26T21:44:50.350
> 
> 标签：objective-c, restkit

这可能已被问过一百万次，但我没有从我找到的所有示例中得到任何结果。

我有以下课程：

```
@interface LoginRequest : NSObject
{
    NSString* _deviceId;
}

@property (nonatomic, retain) NSString* deviceId;

@end 
```

我正在尝试将其发布到服务器，在 HTTP 正文中编码为表单键/值。

我正在使用以下内容来设置映射：

```
objectManager.serializationMIMEType = RKMIMETypeFormURLEncoded;

        RKObjectMapping* pmsg = [RKObjectMapping mappingForClass:[NSMutableDictionary class]];
        [pmsg mapKeyPath: @"deviceId" toAttribute:@"DeviceId"];

        RKObjectMapping* pmsgSerializeMapping = [pmsg inverseMapping];

        [objectManager.mappingProvider setSerializationMapping:pmsgSerializeMapping forClass:[LoginRequest class]];

        [objectManager.router routeClass:[LoginRequest class] toResourcePath:@"/login" forMethod:RKRequestMethodPOST]; 
```

这取自此处的示例：[https ://github.com/RestKit/RestKit/wiki/Posting-Data-Objects](https://github.com/RestKit/RestKit/wiki/Posting-Data-Objects)

我收到以下错误：

```
*** Terminating app due to uncaught exception 'NSUnknownKeyException', reason: '[<LoginRequest 0x8c9c980> valueForUndefinedKey:]: this class is not key value coding-compliant for the key DeviceId.' 
```

这是我尝试发送对象的方式：

```
RKObjectManager *objectManager = [RKObjectManager sharedManager];

LoginRequest* request = [LoginRequest alloc];
request.deviceId = @"Test";

[objectManager postObject:request delegate: self]; 
```

任何人都可以帮忙吗？

更新：我可以确认，当我不使用自定义键码映射的东西时，它可以工作。以下是我的工作：

```
RKObjectMapping* pmsg = [RKObjectMapping mappingForClass:[NSMutableDictionary class]];
        [pmsg mapAttributes:@"DeviceId", nil];

        [objectManager.mappingProvider setSerializationMapping:pmsg forClass:[LoginRequest class]];

        [objectManager.router routeClass:[LoginRequest class] toResourcePath:@"/login" forMethod:RKRequestMethodPOST]; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-27T14:39:24.547

好吧，您的属性名为“deviceId”，它是小写的。但是您说的是属性是以大写“D”开头的“DeviceId”。

# objective-c - 在 Objective C 中创建堆栈

> ID：12610948
> 
> 赞同：3
> 
> 时间：2012-09-26T21:44:57.313
> 
> 标签：objective-c, ios5, stack

我正在使用 iOS 5 为 iPhone 开发一个 RPN 计算器来进行编程作业，但我不确定如何在 Objective-C 中创建一个堆栈以将数字推入。我可以在这部分使用一些帮助，因为应用程序的其余部分运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:28:25.727

```
-(NSMutableArray *)operandStack // override the getter for lazy instantiation
{
    if (!_operandStack)
    {
        [self setOperandStack:[[NSMutableArray alloc] init]];
    }

    return _operandStack;
}

-(void)pushOperand:(double)operand
{
    NSNumber *operandObject = [NSNumber numberWithDouble:operand];
    [[self operandStack] addObject:operandObject];
}

-(double)popOperand
{
    NSNumber *operandObject = [[self operandStack] lastObject];

    if (operandObject)
    {
        [[self operandStack] removeLastObject];
        return [operandObject doubleValue];
    }
    else
    {
        return 0;
    }
} 
```

# xml - Magento 模块布局 xml 加载顺序

> ID：12610949
> 
> 赞同：5
> 
> 时间：2012-09-26T21:45:02.073
> 
> 标签：xml, magento, layout, module, magento-layout-xml

我有一个自定义扩展，它通过布局 XML 包含 jQuery，如下所示：

```
<reference name="head">
    <action method="addJs"><script>jquery/jquery-1.8.1.min.js</script></action>
</reference> 
```

其他使用 jQuery 的扩展需要在我的模块之后加载，因此 jQuery 保持在顶部。

默认情况下，Magento 按字母顺序加载所有内容。有没有办法为扩展指定排序顺序？

一种方法是`page.xml`在我的主题中覆盖并手动将 jQuery 包含到头部，或者我可以将每个自定义模块设置为依赖于我想要的模块，例如：

```
<depends>
    <Package_JQueryLib />
</depends> 
```

还有其他建议吗？

**编辑**

我在想我也可以覆盖**`Mage_Page_Block_Html_Head`**和修改该**`addItem()`**方法以包括对文件进行排序或将文件添加到头部。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-09-27T02:31:08.023

该`<depends />`节点是一种有效的方法 - 它旨在提供对冲突模块 xpath 值的控制，但它也可用于影响子节点出现的顺序。

另一种选择是重写`page/html_head`课程，这是一段时间以来需要的东西，我想，实际上是由其他人完成的。

另一个尝试的选择是`<update>`在自定义模块布局 XML 中使用指令，因为 an`<update />`中的指令在其他指令之前处理。这意味着 jQuery 将在所有其他文件之前加载。

```
<?xml version="1.0" encoding="UTF-8"?>
<layout>
    <default>
        <update handle="add_jquery_first" />
    </default>

    <add_jquery_first>
        <action method="addJs" block="head">
            <file>jquery/jquery-1.8.1.min.js</file>
        </action>
        <!-- or
        <reference name="head">
            <action method="addJs">
                <file>jquery/jquery-1.8.1.min.js</file>
            </action>
        </reference>
        -->
    </add_jquery_first>
</layout> 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T05:19:47.747

这就是我想出的： http: [//pastebin.com/tMUnWBWR](http://pastebin.com/tMUnWBWR)

现在通过布局 xml 或 addJs 方法，我可以使用 sort_order 参数来定义我想要包含我的 js 的位置。

示例布局 xml 如下所示：

```
<action method="addJs">
<script>js/script.js</script>
<params/>
<sort_order>0</sort_order>
</action> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T01:02:26.453

Magento 在受保护方法 _getDeclaredModuleFiles() 中的文件 app/code/core/Mage/Core/Model/Config.php 中按字母顺序从 app/etc/modules 加载配置文件

它告诉首先加载 Mage_All.xml，然后是所有 Magento 配置文件（以 Mage_ 开头），最后按字母顺序加载自定义模块。

所以这是一个小而“肮脏”的技巧——将你的命名空间命名为 AaaPackagename。名称以数字开头也可以解决问题：1Packagename 或 000Packagename

# javascript - 在 IE javascript 调试器中为 window.onload 获取“未实现”

> ID：12610951
> 
> 赞同：2
> 
> 时间：2012-09-26T21:45:06.763
> 
> 标签：javascript, internet-explorer, debugging

出于某种原因，IE 不允许我从我的 HTML 页面调用函数。它在函数 addEvent 的调试器中显示“未实现”。我很茫然，非常感谢一些帮助。

这是我网页中的代码（在带有语言选择选项的“选择”标签下方）

```
<script type="text/javascript">
window.onload = addEvent((document.getElementById('eng')), 'click', redirectEng);
window.onload = addEvent((document.getElementById('chs')), 'click', redirectChs);
window.onload = addEvent((document.getElementById('ger')), 'click', redirectGer);
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T22:13:10.160

我想你真正想要的是：

```
window.onload = function() {
  addEvent((document.getElementById('eng')), 'click', redirectEng);
  addEvent((document.getElementById('chs')), 'click', redirectChs);
  addEvent((document.getElementById('ger')), 'click', redirectGer);
}; 
```

您的代码可能在 FF 下工作，但它仍然是一个非常非常糟糕的代码。你误解了概念。多个分配给`.onload`? 无意义。也`.onload`必须是一个函数。也许 FF 不会抛出错误（与 IE 不同），但我仍然确信您的代码完全可以在 FF 下运行`window.onload`。

在那种特殊情况下，我不得不说（因为它不经常发生）：这不是 IE 的错。:-)

**编辑**

显然 IE 有一些问题`window.onload`。阅读此线程：

[window.onload() 在第一次使用 IE 8 时未触发](https://stackoverflow.com/questions/886668/window-onload-is-not-firing-with-ie-8-in-first-shot)

更多细节。为了跨浏览器的兼容性，我建议你看看一些著名的 JavaScript 库，比如[jQuery](http://jquery.com/)。使用 jQuery，任务将非常简单：

```
$(function(){
    $( '#eng' ).click( redirectEng );
    $( '#chs' ).click( redirectChs );
    $( '#ger' ).click( redirectGet );
}); 
```

# ruby-on-rails - 给定User.deleted_at，如何过滤掉其他模型w(user_id,friend_id)中的已删除用户？

> ID：12610957
> 
> 赞同：0
> 
> 时间：2012-09-26T21:45:47.343
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

我的用户模型具有不显示已删除用户的默认范围。这允许我的应用软删除用户。问题是这会导致相关模型出现错误。

```
User.rb (id,name)
    default_scope :conditions => 'users.deleted_at IS NULL'

NavItem.rb (id,user_id, friend_id)

items = NavItem.find_all_by_user_id(current_user.id)
items.each do |item|
    user = User.find(item.friend_id)
end 
```

我在这里遇到的问题是，当一个用户被删除时，这意味着@user.deleted_at 不是空的，上面的用户错误查询是因为没有找到用户。

如何更新 NavItem.rb 使其加入 User 模型并神奇地过滤掉 users.deleted_at？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T22:42:58.480

以下内容可能对您有所帮助。

我搭建了这个：

```
class User < ActiveRecord::Base
  attr_accessible :deleted_at, :name

  default_scope :conditions => 'users.deleted_at IS NULL'

  has_many :nav_items
end

class NavItem < ActiveRecord::Base
  attr_accessible :friend_id, :user_id

  belongs_to :user

  scope :without_deleted_users, where(:user_id => User.scoped)
end 
```

和 NavItem.without_deleted_users：

```
NavItem.without_deleted_users
  NavItem Load (0.2ms)  SELECT "nav_items".* FROM "nav_items" WHERE "nav_items"."user_id" IN (SELECT "users"."id" FROM "users" WHERE (users.deleted_at IS NULL)) 
```

# session - Coldfusion 会话共享，代理服务器

> ID：12610959
> 
> 赞同：0
> 
> 时间：2012-09-26T21:46:03.900
> 
> 标签：session, coldfusion, proxy

我有一个在 Coldfusion 中运行的网站，据报道有用户访问了该网站并登录了其他人的会话。这怎么可能，代理服务器可能是这个原因吗？

我正在使用：CF 8,0,1,195765 并且在 IIS 中启用了一些缓存

应用程序.cfc：

```
<cfset This.LoginStorage = "session" />
<cfset This.ClientManagement = "Yes" />
<cfset This.SessionManagement = "Yes" />
<cfset This.SessionTimeout = CreateTimeSpan(0, 0, 20, 0) />
<cfset This.SetClientCookies = "Yes" /> 
<cfset This.SetDomainCookies = "No" /> 
```

# vim - Vim：当下一个字符不在同一行时，删除到下一个字符

> ID：12610960
> 
> 赞同：17
> 
> 时间：2012-09-26T21:46:05.530
> 
> 标签：vim

我敢肯定，我会因为提出重复的问题而受到嘲笑。之前一定有人问过这个问题！但是在一个小时的搜索中我还没有找到它。我一定是在寻找错误的东西。

在 Vi（或 Vim）中，我可以`}`通过键序列删除直到字符的所有字符`dt}`（或者`df}`如果我也想删除括号）。

但是，这仅在`}`字符位于当前行时才有效。我想要做的是删除直到下一个的所有内容，`}`即使它第一次出现在下一行。

我在想类似的东西`d/}`（在任何其他情况下，斜线`/}<enter>`都会带我到下一次出现`}`）。由于显而易见的原因，这不起作用，但我希望意图很明确。

== 编辑 ==

好吧好吧好吧……对不起。没关系，它确实有效（在我的全新安装机器上）。可能是配置文件中的一些混乱映射，但它不适用于我的另一个。

*羞愧地低着头*

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-09-26T21:50:15.903

`d/}<cr>`作品。这是删除直到下一个`}`不在同一行的规范方法。顺便说一句，`d?{<cr>`做同样的事情，但方向相反。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T00:57:17.130

这个[插件](https://github.com/dahu/vim-fanfingtastic)应该可以为您节省一些击键。它扩展了 fFtT 的功能；所以他们跨界工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T21:59:05.110

如果字符位于`}`或`{`放置在行首，则一种方法可能是使用*Text object motions*，因此类似的命令`d]]`也可能很有用。

# ios - Xcode 4 中断异常或使用良好的调用堆栈断言并打印异常

> ID：12610962
> 
> 赞同：0
> 
> 时间：2012-09-26T21:46:16.777
> 
> 标签：ios, xcode, exception, gdb, lldb

使用 Xcode 4.3.2。我查看了许多不同的类似问题，包括这个

[xcode-4 中的无异常调用堆栈](https://stackoverflow.com/questions/9546174/no-call-stack-on-exception-in-xcode-4)

但无法让调试器（gdb 或 lldb）给我一个很好的堆栈跟踪，显示异常的位置并且还打印异常是什么

设置符号异常`objc_exception_throw`或“所有异常”异常断点，lldb 不会给我一个好的堆栈跟踪，但会显示以下内容：

> *   线程 #1: tid = 0x1c03, 0x34455238 libobjc.A.dylib `objc_exception_throw, stop reason = breakpoint 1.1 frame #0: 0x34455238 libobjc.A.dylib`objc_exception_throw 帧 #1: 0x323ff788 CoreFoundation`+[NSException raise:format:arguments:] + 100

这就是整个事情，无论是`bt`在图形断点/调试器视图中还是完全放大。

如果此时我点击继续几次，它最终会告诉我异常/断言，例如

> *** 由于未捕获的异常“NSInternalInconsistencyException”而终止应用程序，原因：“_endUndoGroupRemovingIfEmpty::NSUndoManager 0x2b7610 处于无效状态，调用 endUndoGrouping 时没有匹配的开始

但我不知道它在哪里。

gdb，使用相同的断点，将停止并告诉我它在哪里，但不打印异常文本。如果我点击 continue 几次它会，但我已经失去了回溯的上下文。

我想知道如何打印异常文本，所以我知道它为什么停止，而不必做一些继续并失去我的位置。我还想让它像在 gdb 中那样在异常点停止在 lldb 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-29T06:12:13.053

请尝试更新到 Xcode 4.5。您会看到一个 armv7 展开器问题，其中 lldb 不知道如何完全展开您的堆栈。Objective-C 运行时有一些难以摆脱的功能（手写程序集），但我只是在带有 Xcode 4.5 的 iOS 设备上进行了快速测试，当我让 Xcode 在抛出时设置异常断点时 lldb 行为正确。

# android - 如何获得光标的实际位置？

> ID：12610965
> 
> 赞同：1
> 
> 时间：2012-09-26T21:46:32.070
> 
> 标签：android, sqlite, cursor

我正在尝试在我的应用中整理收藏夹。我有一个包含三列的数据库：

```
_id | name  | description |  star

1    London   some desc.
2    Berlin   some desc.    
3    Paris    some desc.     yes 
```

我想在列表视图中显示收藏夹。refreshCursor() 返回“star”列值为“yes”的名称列表：

```
private static final String COLUMN_STAR = "star";

private void refreshCursor() {
        stopManagingCursor(cursor);
        Intent intent = getIntent();
        String TABLE_NAME = intent.getStringExtra("tableName");

        cursor = database.query(TABLE_NAME, null, COLUMN_STAR + " = ?",
                new String[] { "yes" }, null, null, null);

        startManagingCursor(cursor);
    } 
```

没关系。

然后在我点击后，`Paris`我发送带有点击位置的额外字符串：

```
lvData.setOnItemClickListener(new OnItemClickListener() {
            public void onItemClick(AdapterView<?> parent, View view,
                    int position, long id) {
                String entryID = new Integer(position).toString();

                Intent intent = new Intent();
                intent.setClass(FavouritesActivity.this, ViewFavsActivity.class);

                Bundle b = new Bundle();
                b.putString("elementId", entryID);
                intent.putExtras(b);
                startActivity(intent);
            }
        }); 
```

但是我得到了（的`endtryID`）位置`0`并`ViewFavsActivity`显示了`London`.

如何获取实际位置`Cursor`并将其发送到`ViewFavsActivity`？请帮忙。

* * *

`FavouritesActivity`(onCreate): //方法refreshCursor在上面

```
refreshCursor();
String[] from = new String[] { COLUMN_NAME };
        int[] to = new int[] { R.id.tvText };

    scAdapter = new SimpleCursorAdapter(this, R.layout.list_item, cursor,
            from, to);
    lvData = (ListView) findViewById(R.id.list);
    lvData.setAdapter(scAdapter);

    lvData.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            String entryID = String.valueOf(id);

            Intent intent = new Intent();
            intent.setClass(FavouritesActivity.this, ViewFavsActivity.class);

            Bundle b = new Bundle();
            b.putString("elementId", entryID);
            intent.putExtras(b);
            startActivity(intent); 
```

部分`ViewFavsActivity`：

```
public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        // opening DB

        refreshCursor();
    bundle = getIntent().getExtras();

    TextView titleText = (TextView) findViewById(R.id.titleText);
    setTitle = database.query(TABLE_NAME, new String[] { COLUMN_DESC },
            null, null, null, null, null);

    int entryID = Integer.parseInt(bundle.getString("elementId"));

    setTitle.moveToPosition(entryID);
    titleText.setText(setTitle.getString(setTitle
            .getColumnIndex(COLUMN_DESC)));

    }

    private void refreshCursor() {
        stopManagingCursor(cursor);
        Intent intent = getIntent();

        cursor = database.query(TABLE_NAME, new String[] { COLUMN_ID, COLUMN_STAR, COLUMN_DESC },
                "_id = ? AND star = ?",
                new String[] { intent.getStringExtra("elementId"), "yes" },
                null, null, null);
    } 
```

* * *

**添加：**

[pastebin](http://pastebin.com/kSiX5W5G)上的收藏夹活动

pastebin上的[ViewFavsActivity](http://pastebin.com/7MkQWiRK)

[项目](http://www.2shared.com/file/OcgoUda7/SSCCE.html)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-09-26T23:05:05.247

真正的问题是您使用了两个不同的光标。你`position == 0`从：

```
cursor = database.query(TABLE_NAME, null, COLUMN_STAR + " = ?",
            new String[] { "yes" }, null, null, null); 
```

但随后要求职位`0`：

```
setTitle = database.query(TABLE_NAME, new String[] { COLUMN_DESC },
            null, null, null, null, null); 
```

所以很有可能你会得到不同的结果。
*Bundle也*可以保存任何原始数据类型和一些更复杂的数据类型。因此，您无需将数字转换为字符串，然后再转换回其原始数据类型...

更**安全**的方法是使用行的 id，所以在你的`OnItemClickListener`:

```
b.putLong("elementId", id); 
```

并在`ViewFavsActivity`：

```
long entryID = bundle.getLong("elementId");
setTitle = database.query(TABLE_NAME, new String[] { COLUMN_DESC },
            "_id = " + entryID, null, null, null, null); 
```

（注意：如有疑问，请*始终*使用`?`and`query()`的`selectionArgs`参数来防止 SQL 注入攻击，但是您正在使用`long`作为索引检索的 a，因此在这种情况下您是安全的。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:05:38.137

这里的问题是您的光标只产生一个对象。我相信是 londe，它是正确的吗？如果是。总是将列表视图中的位置结果添加一个元素。前任：

如果列表视图只有一个对象：

```
lvData.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            //Here will be showed the 0 position, not 3 like you whant.
            String entryID = new Integer(position).toString();
        }
    }); 
```

解决方案：

您需要将方法中的视图投射到放置在适配器中的对象。前任：

```
lvData.setOnItemClickListener(new OnItemClickListener() {
        public void onItemClick(AdapterView<?> parent, View view,
                int position, long id) {
            //Here will be showed the 0 position, not 3 like you whant.
            MyObject object = (MyObject)view; //This object is placed in the Adapter.
            object.getId(); //This method is inserted in my object or you can Override the method    toString() to return the id of your query.

            //Now you can send your ID to another Activity.

            //Put your code here.

        }
    }); 
```

就是这个 我希望我能帮助你解决我的问题。有任何问题请在这里提出您的问题。

--

蒂亚戈·L·席尔瓦

# php - 无法让变量工作

> ID：12610972
> 
> 赞同：-1
> 
> 时间：2012-09-26T21:46:58.397
> 
> 标签：php, variables

我在这里有这段代码：

```
<?php   
$search=htmlspecialchars($_GET['load']); 
$method = isset( $_GET['btnAction'] ) ? $_GET['btnAction'] : '';

switch( $method ) {
    case 'Search':
      header('Location: search.php?load=$search');
        break;
    case 'Im Feeling Lucky':
        //do chapter two stuff
      header('Location: search_lucky.php?load=$search');
        break;
    default:
        echo 'Not a valid operation';
}

?> 
```

除了 $search 变量外，一切正常，我不明白出了什么问题。

有人能告诉我为什么当我点击这个网址时 $search 变量不起作用：`handler.php?load=keyword&btnAction=Search`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:51:29.907

问题出在您的 header() 函数中。

`header('Location: search_lucky.php?load=$search');`

应该

`header("Location: search_lucky.php?load=$search");`

因为 php 将 (') 之间的所有内容视为文字。所以它实际上是在传递 load=$search

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:05:34.230

您是否尝试过使用 if() 语句来执行此操作.. 见下文..

```
<?php   
    $search=htmlspecialchars($_GET['load']); 
    if(isset($_GET['btnAction']) {
    $method = $_GET['btnAction'];
    }

    switch( $method ) {
        case 'Search':
          header('Location: search.php?load=$search');
            break;
        case 'Im Feeling Lucky':
            //do chapter two stuff
          header('Location: search_lucky.php?load=$search');
            break;
        default:
            echo 'Not a valid operation';
    }

    ?> 
```

编辑：刚刚注意到带有首都 S 的“搜索”。更改为小写可能会更好。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T22:02:20.400

在 PHP 中，变量只用双引号解释。

```
header("Location: search.php?load=$search"); 
```

要使用单引号，您需要连接值

```
header('Location: search.php?load='.$search); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:57:59.343

这段代码有点破，所以在修改后看一下：

```
<?php   
$search=htmlspecialchars($_GET['load']); 
$method = isset( $_GET['btnAction'] ) ? $_GET['btnAction'] : '';
switch( $method ) {
  case "search":
    header("Location: search.php?load=$search");
    break;
  case "Im Feeling Lucky":
    //do chapter two stuff
    header("Location: search_lucky.php?load=$search");
    break;
  default:
    echo 'Not a valid operation';
}
?> 
```

原因是因为您正在测试 $method（其值为“search”）以查看它是否匹配“Search”（带有大写字母 S）。这两种情况不匹配，这就是您看到“无效操作”输出的原因。

# jasper-reports - “没有这样的文件或目录错误”当使用 jasper 和 openerp

> ID：12610980
> 
> 赞同：0
> 
> 时间：2012-09-26T21:47:48.940
> 
> 标签：jasper-reports, openerp

我们使用 jasper 开发了报告，开发时一切正常。

在我的笔记本电脑上，我可以很好地打印报告，这是我运行服务器并对其进行测试的地方。

但是，当我将它上传到我的 ubuntu 服务器并且用户尝试访问相同的报告时，我们会收到错误消息。

```
"2
No such file or directory

(<type 'exceptions.OSError'>, OSError(2, 'No such file or directory'), <traceback object
at 0x7f63b8485ab8>) " 
```

已经两天了，我们被困住了。请指教什么是错的。

我不确定这里有什么问题。

谢谢维沙尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-29T07:11:55.500

所以我解决它的方法是安装open jdk。由于 jasper 是一个 java 文件，它需要编译器，而服务器没有这个。

# php - 哈希片段与服务器端代码冲突

> ID：12610987
> 
> 赞同：2
> 
> 时间：2012-09-26T21:48:18.460
> 
> 标签：php, javascript, fragment-identifier

我有一个网站，用户可以在其中选择一系列字母和数字，然后将它们带到基于此的新页面。

所以可能需要他们`/cds/C_1_3_A_2`

目录中没有实际`C_1_3_A_2`的页面`cds`，我有一个重写规则：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^cds/(.*) /cds/index.html [L] 
```

因此，如果请求的文件不存在，它将被重写为`index.html`，其中 php 脚本获取 URL 的最后一个组件 ( `C_1_3_A_2`) 并加载相关内容，如果 URL 的最后一个组件是`/cds`则 PHP 脚本重定向到`/cds/C_1_1_A_1`

但是我想添加 AJAX 以使其更流畅，这意味着我需要添加对哈希片段的支持，因为旧版浏览器不支持 history.pushState。

所以如果用户自己去`/cds/#C_1_3_A_2`，应该和`/cds/C_1_3_A_2`

但是由于片段没有被发送到服务器，用户最终成为 `/cds/C_1_1_A_1#C_1_3_A_2`，并获得了与 相关的内容`C_1_1_A_1`，而不是`C_1_3_A_2`他们想要的。

由于 PHP 是服务器端，它在 Javascript 可以处理片段之前执行，我不希望用户被 ​​PHP 脚本重定向，然后由 javascript 返回。

那么如何添加对哈希片段的支持呢？其他网站如何处理这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-09-26T22:18:46.733

您需要将更多内容移至前端。通常，如果链接仅包含一个哈希片段，它们不会触发新请求（但可能会导致跳转到屏幕顶部之类的事情，如果需要可以处理）。听起来您的问题可能是添加“/”。如果您希望链接中包含“/”，则该页面应该已经具有“/”，并且链接应该仅包含哈希。

处理此问题的最佳方法是绑定到`window.hashchange`新浏览器支持的事件。将有适用于旧版浏览器的 polyfill。当 hashchange 事件被触发时，您可以检索新 URL 的哈希位置，然后使用它向后端执行 Ajax 请求。

理想情况下，可以修改后端，以便您可以添加`?partial=true`某种形式的参数，因此它只返回可以添加到页面的内容（没有任何形式的周围布局）。这应该是唯一需要的后端更改。否则，要开始使用，您可以使用 JavaScript 从检索到的数据中提取内容并将其集成到页面中（但这应该只是暂时的，因为完整的内容仍将被传输）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-09-26T22:15:41.827

如果您查看带有散列的页面请求的标头，散列部分甚至不会发送到 Web 服务器。因此，php 或 apache 都不会知道哈希是否存在。如果没有“最后一个组件”，您可能最好只加载索引页面而不重定向，然后通过 javascript 将默认值设置为哈希。

# scala - 更新 2d 计数表

> ID：12610990
> 
> 赞同：3
> 
> 时间：2012-09-26T21:48:37.917
> 
> 标签：scala

假设我想要一个 Scala 数据结构，它实现了一个可以随时间变化的二维计数表（即，表中的单个单元格可以递增或递减）。我应该用什么来做到这一点？

我可以使用二维数组：

```
val x = Array.fill[Int](1, 2) = 0
x(1)(2) += 1 
```

但是数组是可变的，我想我应该稍微喜欢不可变的数据结构。

所以我想到了使用二维向量：

```
val x = Vector.fill[Int](1, 2) = 0
// how do I update this? I want to write something like val newX : Vector[Vector[Int]] = x.add((1, 2), 1)
// but I'm not sure how 
```

但我不确定如何获得一个只改变一个元素的新向量。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-09-26T22:27:18.877

最好的取决于你的标准是什么。最简单的不可变变体是使用从 (Int,Int) 到您的计数的映射：

```
var c = (for (i <- 0 to 99; j <- 0 to 99) yield (i,j) -> 0).toMap 
```

然后您使用;访问您的值`c(i,j)`并设置它们 有点烦人，但还不错。`c += ((i,j) -> n)``c += ((i,j) -> (c(i,j)+1))`

更快的是使用嵌套的 s——`Vector`大约是 2 到 3 倍，这取决于你是否倾向于一遍又一遍地重新设置相同的元素——但它有一个丑陋的更新方法：

```
var v = Vector.fill(100,100)(0)
v(82)(49)     // Easy enough
v = v.updated(82, v(82).updated(49, v(82)(49)+1)    // Ouch! 
```

更快（大约 2 倍）是只有一个您索引的向量：

```
var u = Vector.fill(100*100)(0)
u(82*100 + 49)    // Um, you think I can always remember to do this right?
u = u.updated(82*100 + 49, u(82*100 + 49)+1)       // Well, that's actually better 
```

如果您不需要不变性并且您的表大小不会改变，只需使用您展示的数组即可。如果您所做的只是增加和减少一个整数，它比最快的矢量解决方案快约 200 倍。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-09-27T00:04:02.997

如果您想以非常通用且实用（但不一定是高性能）的方式执行此操作，则可以使用镜头。这是一个如何使用[Scalaz 7](http://code.google.com/p/scalaz/)实现的示例，例如：

```
import scalaz._

def at[A](i: Int): Lens[Seq[A], A] = Lens.lensg(a => a.updated(i, _), (_(i)))
def at2d[A](i: Int, j: Int) = at[Seq[A]](i) andThen at(j) 
```

还有一点设置：

```
val table = Vector.tabulate(3, 4)(_ + _)

def show[A](t: Seq[Seq[A]]) = t.map(_ mkString " ") mkString "\n" 
```

这给了我们：

```
scala> show(table)
res0: String = 
0 1 2 3
1 2 3 4
2 3 4 5 
```

我们可以像这样使用我们的镜头：

```
scala> show(at2d(1, 2).set(table, 9))
res1: String = 
0 1 2 3
1 2 9 4
2 3 4 5 
```

或者我们可以只获取给定单元格的值：

```
scala> val v: Int = at2d(2, 3).get(table)
v: Int = 5 
```

或者做很多更复杂的事情，比如将函数应用于特定的单元格：

```
scala> show(at2d(2, 2).mod(((_: Int) * 2), table))
res8: String = 
0 1 2 3
1 2 3 4
2 3 8 5 
```

等等。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-27T01:43:16.330

对此没有内置方法，可能是因为它需要 Vector 知道它包含 Vectors 或 Vectors 或 Vectors 等，而大多数方法都是通用的，并且对于每个维数都需要一个单独的方法，因为您需要为每个维度指定一个坐标 arg。

但是，您可以自己添加这些；以下将带您进入 4D，但如果您只需要添加 2D 位，则可以：

```
object UpdatableVector {
  implicit def vectorToUpdatableVector2[T](v: Vector[Vector[T]]) = new UpdatableVector2(v)
  implicit def vectorToUpdatableVector3[T](v: Vector[Vector[Vector[T]]]) = new UpdatableVector3(v)
  implicit def vectorToUpdatableVector4[T](v: Vector[Vector[Vector[Vector[T]]]]) = new UpdatableVector4(v)

  class UpdatableVector2[T](v: Vector[Vector[T]]) {
    def updated2(c1: Int, c2: Int)(newVal: T) =
      v.updated(c1, v(c1).updated(c2, newVal))
  }

  class UpdatableVector3[T](v: Vector[Vector[Vector[T]]]) {
    def updated3(c1: Int, c2: Int, c3: Int)(newVal: T) =
      v.updated(c1, v(c1).updated2(c2, c3)(newVal))
  }

  class UpdatableVector4[T](v: Vector[Vector[Vector[Vector[T]]]]) {
    def updated4(c1: Int, c2: Int, c3: Int, c4: Int)(newVal: T) =
      v.updated(c1, v(c1).updated3(c2, c3, c4)(newVal))
  }
} 
```

在 Scala 2.10 中，您不需要隐式定义，只需将`implicit`关键字添加到类定义中即可。

测试：

```
 import UpdatableVector._

  val v2 = Vector.fill(2,2)(0)
  val r2 = v2.updated2(1,1)(42)
  println(r2) // Vector(Vector(0, 0), Vector(0, 42))

  val v3 = Vector.fill(2,2,2)(0)
  val r3 = v3.updated3(1,1,1)(42)
  println(r3) // etc 
```

希望这很有用。

# c# - 从网页解析超链接

> ID：12610992
> 
> 赞同：1
> 
> 时间：2012-09-26T21:48:48.550
> 
> 标签：c#, asp.net

我编写了以下代码来解析给定页面的超链接。

```
 WebClient web = new WebClient();
    string html = web.DownloadString("http://www.msdn.com");
    string[] separators = new string[] { "<a ", ">" };
    List<string> hyperlinks= html.Split(separators, StringSplitOptions.None).Select(s =>
    {
        if (s.Contains("href"))
            return s;
        else
            return null;
    }).ToList(); 
```

尽管仍然需要调整字符串拆分以完美返回 url。我的问题是有一些数据结构，类似于 XmlReader 的东西，它可以有效地读取 HTML 字符串。

任何改进上述代码的建议也会有所帮助。

谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-09-26T21:50:56.507

您应该使用解析器。使用最广泛的一个是[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)。使用它，您可以将 HTML 作为 DOM 进行交互。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T22:15:18.663

> 假设您正在处理格式良好的 XHTML，您可以简单地将文本视为 XML 文档。该框架加载了完全符合您要求的功能。
> 
> [http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx](http://msdn.microsoft.com/en-us/library/system.xml.xmldocument.aspx)

[.NET 框架是否提供解析 HTML 字符串的方法？](https://stackoverflow.com/questions/9473514/does-net-framework-offer-methods-to-parse-an-html-string/9473607#9473607)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-09-26T22:15:43.310

试试[HtmlAgilityPack](http://htmlagilitypack.codeplex.com/)

```
 HtmlWeb hw = new HtmlWeb();
        HtmlDocument doc = hw.Load("http://www.msdn.com");
        foreach (HtmlNode link in doc.DocumentNode.SelectNodes("//a[@href]"))
        {
            Console.WriteLine(link.GetAttributeValue("href", null));         
        } 
```

这将打印出您 URL 上的每个链接。

如果要将链接存储在列表中：

```
 var linkList = doc.DocumentNode.SelectNodes("//a[@href]")
               .Select(i => i.GetAttributeValue("href", null)).ToList(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-09-26T21:52:22.260

重构，

```
 var html = new WebClient().DownloadString("http://www.msdn.com");
        var separators = new[] { "<a ", ">" };
        html.Split(separators, StringSplitOptions.None).Select(s => s.Contains("href") ? s : null).ToList(); 
```

# android - getActivity() 是什么意思？

> ID：12610995
> 
> 赞同：32
> 
> 时间：2012-09-26T21:49:03.033
> 
> 标签：android

是什么`getActivity()`意思？我在某处看到，他们写`MainActivity.this.startActionMode(mActionModeCallback)`而不是`getActivity()`。有人能解释一下这两行是什么意思吗？

```
 someView.setOnLongClickListener(new View.OnLongClickListener() {
        // Called when the user long-clicks on someView
        public boolean onLongClick(View view) {
            if (mActionMode != null) {
                return false;
            }

            // Start the CAB using the ActionMode.Callback defined above
            mActionMode = getActivity().startActionMode(mActionModeCallback);
            view.setSelected(true);
            return true;
        }
    }); 
```

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-09-26T22:02:09.300

两个可能的定义：

*   `getActivity()`在 a`Fragment`返回当前关联的`Activity`the 。`Fragment`（见[http://developer.android.com/reference/android/app/Fragment.html#getActivity()](http://developer.android.com/reference/android/app/Fragment.html#getActivity%28%29)）。
*   `getActivity()`是用户定义的。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2015-10-06T11:18:18.607

`getActivity()`用于`fragment`. 因为`activity`，在任何可以使用的地方，都可以将类似情况下的in`this`替换为.`this``fragment``getActivity()`

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-03-25T08:36:27.630

getActivity() - 返回此片段当前关联的 Activity。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-04-27T12:38:32.297

我有一个类似的疑问，我知道的是`getActivity()`返回 `Activity`片段所关联的。

该`getActivity()`方法通常用于静态片段，因为关联的活动不会是静态的，并且非静态成员不能在静态成员中使用。

![我在这里使用 <code>getActivity()</code> 来获取与占位符片段关联的非静态活动。](../Images/874738b8c808540e47ae463ea6d0a302.png)

# sql - 如何在 SQL 中修改此语句？

> ID：12610997
> 
> 赞同：0
> 
> 时间：2012-09-26T21:49:13.543
> 
> 标签：sql, oracle

如何修改以下语句以从代码中删除硬编码值 $1.00 和 $2.00 并将它们放在常量表中？

桌子`sec0306_price_constants`已经摆好了。`min_price`字段包含 1.00，字段`max_price`包含 2.00。

```
 SELECT description
    FROM l_foods
   WHERE price BETWEEN 1.00 AND 2.00
ORDER BY description 
```

你能向我解释一下这样做的方法吗？

这是给甲骨文的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-09-26T21:54:32.160

也许是这样的：

```
SELECT description
FROM l_foods
WHERE (price >= (select min_price from sec0306_price_constants )
AND price <= (select max_price from sec0306_price_constants ))
ORDER BY description 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-09-26T21:58:36.657

```
declare @constants table (typ varchar(10), minprice float, maxprice float)

insert into @constants values 
('dirtcheap', 0.00, 0.99),
('justright', 1.00, 2.00),
('expensive', 2.01, 10.00)

select description
from   l_foods f, @constants c
where  f.price >= c.minprice and f.price <= c.maxprice
  and  c.typ = 'justright' 
```

您可以通过不同类型的价格范围来限定，而无需更改查询中的低值和高值——只需更改常量类型。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:55:15.490

抱歉，阅读了额外的信息，如果您有表格设置，我会按照以下方式组织内容：

```
--BEGIN PROC

DECLARE @MINPRICE DECIMAL;
DECLARE @MAXPRICE DECIMAL;

SELECT
    @MINPRICE = min_price,
    @MAXPRICE = max_price
FROM
    sec0306_price_constants;

SELECT description
    FROM l_foods
WHERE 
    price BETWEEN @MINPRICE AND @MAXPRICE
ORDER BY description 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-09-12T17:30:21.690

```
SELECT Description, price, min_price, max_price

FROM l_foods,sec0306_price_constants

WHERE (price >= (sec0306_price_constants.min_price ) AND price <= (sec0306_price_constants.max_price ))

ORDER BY description; 
```

# php - 如何在 PHP 中显示不同时间范围的不同内容？

> ID：12610999
> 
> 赞同：-2
> 
> 时间：2012-09-26T21:49:16.800
> 
> 标签：php

尝试编写页面的一部分，当我们在广播 5a-10a MF 时显示流媒体播放器，并在我们不广播时显示其他内容。

这是我现在所拥有的，但它不起作用。我对 PHP 很陌生。谢谢！

```
<html>
<head>
<title>streaming</title>
</head>
<body>
<?php

//Get the current hour
$current_time = date(G);
//Get the current day
$current_day = date(l);

//Off air
if ($current_day == "Saturday" or $current_day == "Sunday" or ($current_time <= 5 && $current_time >= 10)) {
echo "We’re live Monday – Friday mornings. Check back then.";
}

// Display player
else {
echo "<a href="linktoplayer.html"><img src=http://www.psdgraphics.com/wp-content/uploads/2009/09/play.jpg></a>";
}

?>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-09-26T21:54:08.053

## #1。

此语句将始终为 FALSE：

```
($current_time <= 5 && $current_time >= 10) 
```

正确的：

```
($current_time < 5 || $current_time >= 10) 
```

## #2。

这`$current_time = date(G);`将`$current_day = date(l);`输出通知：

```
Notice:  Use of undefined constant G - assumed 'G' in ...
Notice:  Use of undefined constant l - assumed 'l' in ... 
```

正确的：

```
$current_time = date('G');
$current_day = date('l'); 
```

## #3。

此代码`echo "<a href="linktoplayer.html"><img src=http://www.psdgraphics.com/wp-content/uploads/2009/09/play.jpg></a>";`还将输出 PARSE ERROR：

```
Parse error: syntax error, unexpected 'linktoplayer' (T_STRING), expecting ',' or ';' in ... 
```

如果你想输出它，你必须在字符串中`"`转义：`\`

```
echo "<a href=\"linktoplayer.html\"><img src=\"http://www.psdgraphics.com/wp-content/uploads/2009/09/play.jpg\"></a>"; 
```

或`'`改用：

```
echo '<a href="linktoplayer.html"><img src="http://www.psdgraphics.com/wp-content/uploads/2009/09/play.jpg"></a>'; 
```

图像的ps`src`属性必须用`""`.

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-09-26T21:55:25.397

两件事情：

1.  正如已经指出的那样，您的时间逻辑是关闭的。它应该是`$current_time < 5 or $current_time >= 10)`

2.  当你给日期函数提供一些东西时，它必须是一个字符串。`date(l)`会抛出一个错误，因为它应该是`date('l')`.

**编辑：**

如果你真的想对你的代码进行基准测试，你应该使用它，`idate`因为它返回一个整数。您的比较将如下所示：

```
$current_time = idate('H');
$current_day = idate('w');

if ($current_day === 0 || $current_day === 6 || 
    $current_time < 5 || $current_time >= 10) {
    echo "We’re live Monday – Friday mornings. Check back then.";
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-09-26T21:59:59.043

我认为您应该更改`If`语句结构，使其看起来像这样

```
IF (on-air) 
THEN DisplayPlayer() 
ELSE echo "message saying Off Air" 
```

通过这样做，当您在线时有人试图访问该站点时，您可以更快地击中玩家。

这是一项优化，可以在您**播出**时加快加载时间。如果您**停播**，它将经过两个步骤。它只是取决于你想要更快的加载时间

除了@glavić 在他的回答中写的内容之外，还应该使用它。