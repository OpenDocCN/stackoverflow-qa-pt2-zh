# StackOverflow 问答 15373000-15373999

# html - 如何在html中添加子级别

> ID：15373007
> 
> 赞同：-2
> 
> 时间：2013-03-12T21:56:59.303
> 
> 标签：html

我正在尝试在选项卡文档中添加子级别，但是当我尝试时无法添加代码是

```
 <li><a href="support.html"><span>DOCUMNETS</span></a>
     <ul class="sub-level">
                <li><a href="#">Upload Dcoument</a></li>
                <li><a href="#">Approved Document</a></li>
            </ul> 
```

当我尝试这个时，它无法完成

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:02:19.390

[http://www.w3schools.com/html/tryit.asp?filename=tryhtml_nestedlists2](http://www.w3schools.com/html/tryit.asp?filename=tryhtml_nestedlists2)

```
<!DOCTYPE html>
<html>
<body>

<h4>A nested List:</h4>
<ul>
  <li>Coffee</li>
  <li>Tea
    <ul>
    <li>Black tea</li>
    <li>Green tea
      <ul>
      <li>China</li>
      <li>Africa</li>
      </ul>
    </li>
    </ul>
  </li>
  <li>Milk</li>
</ul>

</body>
</html> 
```

您可能忘记关闭一些标签。使用一些可以帮助您处理 HTML 中的标签的编辑器。Notepad++，免费的 Visual Studio 版本，......有很多......

**更新：** 缩进你的代码，下次你自己会更容易看到。

```
<!DOCTYPE html>
<html>
<head></head>
<body>
  <li>
    <a href="support.html"><span>DOCUMNETS</span></a>
    <ul class="sub-level">
      <li><a href="#">Upload Dcoument</a></li>
      <li><a href="#">Approved Document</a></li>
    </ul>
  </li>
</body>
</html> 
```

# concurrency - 通知所有 goroutine

> ID：15373011
> 
> 赞同：4
> 
> 时间：2013-03-12T21:57:10.940
> 
> 标签：concurrency, tcp, parallel-processing, go

我正在使用 Go 开发 TCP 服务器。现在我想通知所有与客户端对话的 goroutines 放弃他们的连接，转储他们拥有的东西并停止。

关闭通道是通知所有通道的一种方式。

问题是：那是惯用的 Go 吗？如果我错了；那我应该怎么做（通知所有的goroutines - 比如.NET中的ManualResetEvent）？

注意：我是 Go 新手，刚刚学习并开始使用 TCP Server，因为我之前用 C# 编写过。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T22:04:41.020

是的，关闭通道是 Goroutine 之间通信的惯用 Go 方式。

您需要在每个 goroutine 启动时将通道传递给它，并在每个网络事件之后使用 select 调用检查通道。

您还需要在网络事件上设置超时，这样您就不会永远挂起连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-02T12:23:07.173

从 Go 1.7 开始，您可以使用[context](https://blog.golang.org/context)包。

# hardware - a <= a + 1 是 VHDL 中的一个好习惯吗？

> ID：15373012
> 
> 赞同：2
> 
> 时间：2013-03-12T21:57:11.563
> 
> 标签：hardware, vhdl, xilinx, hdl, modelsim

如果我在 VHDL 过程中编写将 a 分配为 a+1 的语句，这是一个好习惯吗？

我对此感到困惑，因为模拟器工作正常，但是当我尝试在 FPGA 中实现它时，综合工具会抱怨创建锁存器。

这是什么意思？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-13T06:40:17.220

你应该只在时钟进程中做这样的声明。如果您想对其进行综合，建议进行额外的初始化（重置）。可能如下所示：

```
process(clk, reset)
begin
   if reset='1' then
      a <= 0;
   elsif rising_edge(clk) then
      a <= a + 1;
   end if;
end process; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-12T22:38:30.753

在时钟过程中，这很好。其他地方，可能不会。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-13T13:24:35.853

Do it in a clocked process, that's fine. What it means is "the next value of `a` should be the current value of `a` +1"

* * *

If you do it as a continuous assignment (outside of any process), what you are saying is "a is always getting a+1 assigned to it" which is a self-referential loop!

If you include `a` in the sensitivity list of an enabled process, you get the same effect

```
process (en, a)
begin
   if en = '1' then 
      a <= a + 1;
   end if;
end process; 
```

(You can use this form to create transparent latches:

```
process (en, insig)
begin
   if en = '1' then 
      a <= insig;
   end if;
end process; 
```

)

* * *

If you do it in a non-clocked process, which is *not* sensitive to `a`:

```
process (en)
begin
   if en = '1' then 
      a <= a + 1;
   end if;
end process; 
```

You will create a positive-edge-triggered latch, as `a` needs to keep its value between changes of `en`. Effectively, `en` becomes a clock to a d-type flipflop.

# actionscript-3 - 针对不同版本 Flash Player 的应用变体的工作流程

> ID：15373013
> 
> 赞同：0
> 
> 时间：2013-03-12T21:57:16.837
> 
> 标签：actionscript-3, flash, apache-flex, flash-builder

我在我的应用程序中以 Flash Player 10+ 为目标。对于 Flash Player 10.3+，我想使用`EnhancedMicrophone`10.3 中引入的功能。因此，应用程序变体之间的差异将是几行代码。

我应该在 Flash Builder 中创建和维护两个单独的项目（并将任何更改从一个复制到另一个），还是有更聪明的方法？某种“预处理器指令”可能会根据目标播放器打开/关闭代码块？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:01:28.443

以下将给出播放器的版本：

```
var versionNumber:String = Capabilities.version;
trace(versionNumber); 
```

对我来说，在 Windows 上它可以追溯到：

```
WIN 11,5,502,146 
```

您可以解析它并获取主要/次要版本的 11,5 部分并基于此执行代码。

# java - 做了一个JFrame，做了一个applet，不知道如何将两者结合起来？

> ID：15373015
> 
> 赞同：0
> 
> 时间：2013-03-12T21:57:21.587
> 
> 标签：java, swing, applet, jframe

我是一个完整的 Java 新手，需要一些帮助。基本上，我想为我已经制作的游戏制作一个具有背景的 JFrame。我刚刚使用了 Netbeans`JFrame`设计选项卡，并希望我可以将代码组合到代码的专用部分中`JFrame`，而我一直无法做到这一点。

或者，如果有人可以向我展示如何为我的游戏中创建的 JFrame 添加背景，那将同样好，代码如下：

```
 package javagame;

import java.awt.Graphics;
import java.awt.Image;
import java.awt.event.KeyAdapter;
import java.awt.event.KeyEvent;
import javax.swing.ImageIcon;
import javax.swing.JFrame;

public class JavaGame extends JFrame {

    int x, y;
        Image piggy1;
    private Image dbImage;
    private Graphics dbg;

    public class ActionListener extends KeyAdapter {
        public void keyPressed(KeyEvent e) {
            int keyCode = e.getKeyCode();

            if(keyCode == e.VK_LEFT) {
                if(x <= 0)
                    x = 0;
            else
                x += -5;
            }

            if(keyCode == e.VK_RIGHT) {
                if (x>= 450)
                    x = 450;
                else
                    x += +5;
                        }

            if(keyCode == e.VK_UP) {
                if(y<= 20)
                    y = 20;
            else
                y += -5;
            }
            if(keyCode == e.VK_DOWN) {
                if (y>= 450)
                    y = 450;
            else
                y += +5;
            }

        }
        public void keyReleased(KeyEvent e) {

        }
    }

    public JavaGame() {

                //Images
                ImageIcon i = new ImageIcon("C:/Users/MrBlueMKII/Documents/NetBeansProjects/JavaGame/src/javagame/PIGGY.gif");
                piggy1 = i.getImage();

                addKeyListener(new ActionListener());
        setTitle("Java Game");
        setSize(500, 500);
                setResizable(false);
                setVisible(true);
        setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

        x = 150;
        y = 150;

                ImageIcon j = new ImageIcon("C:/Users/MrBlueMKII/Downloads/field.jpg");

    }

    public void paint(Graphics g){
        dbImage = createImage(getWidth(), getHeight());
        dbg = dbImage.getGraphics();
        paintComponent(dbg);
        g.drawImage(dbImage, 0, 0, this);
    }

    public void paintComponent(Graphics g) {
        g.drawImage(piggy1, x, y, this);

        repaint();

    }

    public static void main(String[] args)  {

        new JavaGame();

    } 
} 
```

JFrame 的代码是：

```
package javagame;

public class JFrame extends javax.swing.JFrame {

public JFrame() {
    initComponents();
}

@SuppressWarnings("unchecked")
// <editor-fold defaultstate="collapsed" desc="Generated Code">
private void initComponents() {

    jPanel1 = new javax.swing.JPanel();
    jTextField1 = new javax.swing.JTextField();
    jLabel1 = new javax.swing.JLabel();

    setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);

    jPanel1.setLayout(null);

    jTextField1.setBackground(new java.awt.Color(223, 248, 248));
    jTextField1.setFont(new java.awt.Font("Tahoma", 1, 14)); // NOI18N
    jTextField1.setForeground(new java.awt.Color(255, 255, 255));
    jTextField1.setText("Eat the flies to evolve wings!");
    jTextField1.addActionListener(new java.awt.event.ActionListener() {
        public void actionPerformed(java.awt.event.ActionEvent evt) {
            jTextField1ActionPerformed(evt);
        }
    });
    jPanel1.add(jTextField1);
    jTextField1.setBounds(280, 0, 200, 80);

    jLabel1.setIcon(new javax.swing.ImageIcon("C:\\Users\\MrBlueMKII\\Downloads\\field.jpg")); // NOI18N
    jLabel1.setText("jLabel1");
    jPanel1.add(jLabel1);
    jLabel1.setBounds(0, 0, 500, 500);

    javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
    getContentPane().setLayout(layout);
    layout.setHorizontalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 500, Short.MAX_VALUE)
    );
    layout.setVerticalGroup(
        layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 500, Short.MAX_VALUE)
    );

    pack();
}// </editor-fold>

private void jTextField1ActionPerformed(java.awt.event.ActionEvent evt) {

}

public static void main(String args[]) {

    //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
    /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
     * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
     */
    try {
        for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
            if ("Nimbus".equals(info.getName())) {
                javax.swing.UIManager.setLookAndFeel(info.getClassName());
                break;
            }
        }
    } catch (ClassNotFoundException ex) {
        java.util.logging.Logger.getLogger(JFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (InstantiationException ex) {
        java.util.logging.Logger.getLogger(JFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (IllegalAccessException ex) {
        java.util.logging.Logger.getLogger(JFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    } catch (javax.swing.UnsupportedLookAndFeelException ex) {
        java.util.logging.Logger.getLogger(JFrame.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
    }
    //</editor-fold>

    java.awt.EventQueue.invokeLater(new Runnable() {
        public void run() {
            new JFrame().setVisible(true);
        }
    });
}
// Variables declaration - do not modify
private javax.swing.JLabel jLabel1;
private javax.swing.JPanel jPanel1;
private javax.swing.JTextField jTextField1;
// End of variables declaration
} 
```

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:12:30.190

最好的方法是将您需要的所有常见元素删除到单独的组件中（使用类似的东西`JPanel`而不是`JFrame`and `JApplet`）

这将允许您根据需要添加到框架或小程序中。

这是非常普遍的设计理念，不要通过在共同祖先中实现共同逻辑来将自己困在特定的顶级容器中

# ruby-on-rails - Rails 社区命名连接模型的命名约定有哪些优势？

> ID：15373017
> 
> 赞同：2
> 
> 时间：2013-03-12T21:57:22.517
> 
> 标签：ruby-on-rails, ruby, activerecord, naming-conventions, jointable

在[这个 Railscast](http://railscasts.com/episodes/47-two-many-to-many)中，Ryan Bates 提到在命名连接模型时使用以 -tion、-ment 或 -ship 结尾的词是一个很好的约定。这个约定有什么好处？

例如，如果我有一个名为“Albums”和“Songs”的两个模型，其中一首歌可以出现在许多专辑中，而一张专辑有很多歌曲，该怎么办？为此所需的连接表的好名称是什么？跟踪列表？曲目列表？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:17:20.227

惯例是将其命名为有意义的名称。

这些关系通常以这些结局而告终。*关键是*要遵循约定并保持一致，不一定所有内容都可以整齐地融入相同的三个结局。

对我来说，它听起来像`Tracks`,`AlbumTracks`等等。如果你想按照他的想法来编一个词，也许`Trackation`或者`Trackination`（将曲目放入专辑的过程），`Albumship`（如“会员资格”，但带有专辑歌曲）等。

另请注意，希望您没有名为`Albums`and的模型`Songs`，而是`Album`and `Song`。IMO 最清晰的关系是简单`AlbumSongs`的，因为这正是它的本质。

您也可以完全走一条不同的路线并打电话给他们`Mixes`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:23:14.097

使用一致的命名约定的另一个好处是你很有可能不会是唯一一个处理代码的人。通过使用一致的命名约定，处理您的代码的其他人将更轻松地处理代码。您可能还会发现它更易于维护，因为您可能 6 个月不接触代码，然后有一天会再次使用它。通过具有一致的命名约定，您将能够理解您在做什么，而无需通读所有代码。

# javascript - 将jquery滑块更改为向下滑动然后向上滑动旧部分

> ID：15373030
> 
> 赞同：0
> 
> 时间：2013-03-12T21:58:07.880
> 
> 标签：javascript, jquery, dynamic, tabs, slider

好吧，长话短说，我想做的是改变jquery，让新的部分填充在旧div的顶部向下滑动，然后向上滑动旧div，只显示新的内容框。截至目前，代码完美地向上滑动旧部分，然后向下滑动新内容。

Javascript 的代码示例

```
$(document).ready(function(){
    function doTab() {
        $(".active").removeClass("active");
        $(this).addClass("active");
        $(".content").slideUp();
        var content_show = $(this).attr("title");
        $("#"+content_show).slideDown();
    }

    // When a link is clicked
    $("a.tab").click(doTab);

    if (window.location.hash) {
        $('a[title="' + window.location.hash.substring(2) + '"]').click();
    }
}); 
```

选项卡和部分的代码

```
<ul id="tabs">
    <li><a href="#" title="type1" class="tab active">type1</a></li>
    <li><a href="#" title="type2" class="tab">type2</a></li>
</ul>

<!--<div class="dpoint-holder"><div class="dpoint"></div></div>-->
<section id="type1" class="content">
    <p>contents1contents1contents1contents1contents1</p>
</section>
<section id="type2" class="content content_2">
    <p>contents2contents2contents2contents2</p>
</section> 
```

# arrays - Actionscript 3：尝试创建一个随机数组

> ID：15373031
> 
> 赞同：0
> 
> 时间：2013-03-12T21:58:12.177
> 
> 标签：arrays, actionscript-3, actionscript, random

我试图创建一个随机数组，每次启动应用程序时都会改变我的图片的位置（在 tilelist 中）。希望你明白我在找什么，我真的不明白如何在这里正确链接代码：/

我认为它更容易简单地复制到闪存中并从那里查看

谢谢 ：）

这是我的代码：

```
flash.events.MouseEvent;

btn_back.addEventListener(MouseEvent.CLICK, ftilbake);

function ftilbake(evt:MouseEvent)
{
    gotoAndStop(1);
}

var heroArray:Array = new Array();
var randomizeArray:Array = new Array();

createArrays()

function createArrays()
{
heroArray[0] = new Array("Rumble","Garen","Lulu","Corki","Warwick");

heroArray[1] = new Array("Bilder/Champions/Rumble.jpg","Bilder/Champions/Garen.jpg","Bilder/Champions/Lulu.jpg","Bilder/Champions/Corki.jpg","Bilder/Champions/Warwick.jpg");

heroArray[2] = new Array("Bilder/Champions/Rumble1.jpg","Bilder/Champions/Garen1.jpg","Bilder/Champions/Lulu1.jpg","Bilder/Champions/Corki1.jpg","Bilder/Champions/Warwick1.jpg");

heroArray[3] = new Array("the Mechanized Menace","the Might of Demacia","the Fae Sorceress","the Daring Bombardier","the Blood Hunter");
heroArray[4] = new Array(0,0,0,0,0);
heroArray[5] = new Array("Rumble.wav","Garen.wav","Lulu.wav","Corki.wav","Warwick.wav");
randomizeArray[0] = new Array();
randomizeArray[1] = new Array();
randomizeArray[2] = new Array();
randomizeArray[3] = new Array();
randomizeArray[4] = new Array();

//randomizing the positions in the array(?)
var randomPos:int = 0;
for (var i:int = 0; i < heroArray.length; i++)
{
    randomPos = int(Math.random() * heroArray[0].length);
    while (randomizeArray[randomPos][0] != null)
    {
        randomPos = int(Math.random() * heroArray.length);  
    }
}
}

var totalKlikk:int = 0;

for (var teller1:int = 0; teller1 <heroArray[0].length; teller1++)
{
    leagueChamps.addItem({label:heroArray[0][teller1], source:heroArray[1][teller1]});
}

leagueChamps.columnWidth = 80;

leagueChamps.rowHeight = 80;

leagueChamps.columnCount = 5;

leagueChamps.rowCount = 1;

leagueChamps.direction = "horizontal";

leagueChamps.addEventListener(MouseEvent.CLICK, bildeKlikk);

function bildeKlikk(evt:MouseEvent)
{
    var element:Object = leagueChamps.selectedItem;
    var fil:String = element.source;
    txtChHero.visible = false;
    totalKlikk++;
    if (totalKlikk <11)
    {
        for (teller1 = 0; teller1 <heroArray[0].length; teller1++)
        {
            if (heroArray[1][teller1] == fil)
            {
            heroArray[4][teller1]++;
            if (heroArray[4][teller1] == 1)
            {
                txtBox1.visible = true;
                txtBox2.visible = true;
                leagueShow.source = heroArray[2][teller1];
                txtBox1.text = heroArray[0][teller1];
                txtBox2.text = heroArray[3][teller1];
            }
            if (heroArray[4][teller1] == 2)
            {
                txtBox1.visible = true;
                txtBox2.visible = true;
                leagueShow.source = heroArray[2][teller1];
                txtBox1.text = heroArray[0][teller1];
                txtBox2.text = heroArray[3][teller1];
                heroArray[5][teller1].play();
            }
            if (heroArray[4][teller1] == 3)
            {
                bildeKlikk3();
            }
        }
    }
}
else
{
    txtChHero.visible = true;
    txtChHero.text = "Du har klikket følgende mange ganger på de forskjellige bildene:";
    txtH1.text = heroArray[4][0]
    txtH2.text = heroArray[4][1]
    txtH3.text = heroArray[4][2]
    txtH4.text = heroArray[4][3]
    txtH5.text = heroArray[4][4]
    txtBox1.visible = false;
    txtBox2.visible = false;
    leagueShow.visible = false;
}
}

function bildeKlikk3()
{
    txtBox1.visible = true;
    txtBox2.visible = true;
    leagueShow.source = heroArray[2][teller1];
    txtBox2.text = "Ikke mer informasjon";
}

txtBox2.visible = false;

txtBox1.visible = false; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T00:39:53.627

试试这个

```
while (heroArray.length > 0) {
  randomizeArray.push(heroArray.splice(Math.round(Math.random() * (heroArray.length - 1)), 1)[0]);
} 
```

不过，只需实例化 randomizeArray，不要像您的源代码中那样用空数组填充它！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T03:21:45.263

我建议创建一个对象来保存相关数据，并使用该对象类型的单个数组/向量。

要回答您的问题，使用 array.sort() 和随机选择函数对数组进行随机化相当容易。此方法还可用于随机化任何数组。您也不需要拼接数组或迭代。

```
function sortOnRandom(a:Object, b:Object):Number{
  if(Math.random() > 0.5){
    return 1;
  }else{
    return -1;
  }
}

myArray.sort(sortOnRandom); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-14T09:53:16.320

数组随机化在我的所有项目中都非常频繁地出现，所以我最终在我的 Array 实用程序类中为它创建了一个静态方法。

它使用[Fisher-Yates shuffle](http://en.wikipedia.org/wiki/Fisher%E2%80%93Yates_shuffle)，它被认为是最无偏（和最有效？）的算法，用于对数组的内容进行混洗。可能有更快的方法来做到这一点（比如使用 array.sortOn() 方法，但我不确定他们得到的结果与这个相比有多公正。）

洗牌方法：

```
/**
     * shuffle the given array
     * @param   array
     * @return
     */
    public static function shuffle(array:Array):Array 
    {

        var index   :int;
        var item    :*;
        var limit   :int    = array.length as int;

        for (var i:int = limit-1; i >= 0 ; --i) 
        {
            index           = Math.floor(Math.random() * (i + 1));
            item            = array[index];
            array[index]    = array[i];
            array[i]        = item;
        }

        return array;

    } 
```

例子：

```
var myArray:Array = new Array("Red","Orange","Yellow","Green","Blue");

myArray           = ArrayUtils.shuffle(myArray); 
```

其中 ArrayUtils 是我使用的 Array Utility 类的名称。如果您不想使用实用程序类，您可以直接使用该函数。

# java - 是否可以使用 DB 将查询结果传递给 Java 中的函数或类

> ID：15373035
> 
> 赞同：0
> 
> 时间：2013-03-12T21:58:14.763
> 
> 标签：java, ms-access

我有一个授权窗口，您必须在其中输入登录名和密码，登录名和密码存储在 MS Access 数据库中，如下所示：

```
 ID      login      password      ID_in_another_table
----    -------    ----------    ---------------------
  1      admin      admin
  2      user1      user1                           1
  3      user2      user2                           2 
```

我正在使用授权

```
SELECT * FROM Table_name 
```

对于管理员，我有自己的菜单，但对于用户，我必须打开与**ID_in_another_table**具有相同 ID 的数据，我可以以某种方式将该**ID_in_another_table**传递给函数或类以使用它吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:02:46.263

如果您使用：

```
SELECT ID_in_another_table
FROM Table_name
WHERE login = :login
AND password = :password 
```

如果名称和密码匹配，您只会得到一个结果，对于管理员用户，您会得到一个返回的单行但具有空值。没有结果将意味着用户名或密码错误。

# jquery - Twitter bootstrap typeahead with input masked 在完整字符串完成之前无法正常工作

> ID：15373036
> 
> 赞同：0
> 
> 时间：2013-03-12T21:58:26.390
> 
> 标签：jquery, input, mask, bootstrap-typeahead

我试图让引导输入与[Josh Bush](http://digitalbush.com/projects/masked-input-plugin/)输入 jquery 掩码插件一起工作。我尝试了其他插件，它也不起作用。

当我禁用输入的屏蔽时，我的自动完成效果很好。

这是我的代码：

```
$('.phonenumber').mask('(999) 999-9999');   

$('#new-message-phonenumber').typeahead({

        minLength: 2,
        property : 'name',
        source: function( typeahead, query ) {

            $.ajax({
                type: 'POST',
                url: '<? echo site_url('autocomplete/getClientInfoFromPhoneNumber'); ?>',
                dataType: 'json',
                data: {
                    term: query
                },
                success: function(data) {

                    var return_list = [], i = data.length;

                    while (i--) {
                        return_list[i] = {value: data[i].value, name: data[i].screen_name, friendly_name: data[i].name, friendly_phone: data[i].friendly_phone };
                    }

                    typeahead.process(return_list);

                }

            });

        },
        onselect: function (obj) {
            $('#new-message-phonenumber').val(obj.friendly_phone);
            $('#new-message-name').val(obj.friendly_name);
        }
    }); 
```

这是我的html：

```
<div class="span5">
            <label for="new-message-phonenumber">Phone Number</label>
            <input class="input-block-level phonenumber required" id="new-message-phonenumber" name="new-message-phonenumber" type="text" data-provide="typeahead" autocomplete="off">
        </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-09T19:42:11.337

您是否使用了浏览器调试器？由于上面有新的 jQuery 版本，我之前已经遇到了一些问题，因为该插件已过时并且不支持某些当前已弃用的 jQuery 函数。

# c - 设置第 32 位时的编译器警告

> ID：15373042
> 
> 赞同：3
> 
> 时间：2013-03-12T21:58:48.837
> 
> 标签：c, 32-bit, keil

设置第 32 位时，我在代码中有编译器警告。代码有效，但这个警告让我很恼火。

编译器是 Keil C，处理器是 32 位 ARM。代码如下

```
PINSEL0 |= PINSEL_AD15; 
```

其中`PINSEL0`是 32 位寄存器，定义为

```
#define PINSEL0         (*((volatile unsigned long *) 0xE002C000)) 
```

并且`PINSEL_AD15`定义如下：

```
#define PINSEL_AD15  ((1<<30)|(1<<31)) 
```

我收到的警告信息是：*整数运算结果超出范围*

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T22:00:24.050

文字`1`是一个有*符号*整数，所以当你移动 31 时，你就会超出范围。尝试使用无符号整数：

```
(1U << 31) 
```

# javascript - 如何动态计算 HTML 页面上表格中每一列的总和？

> ID：15373043
> 
> 赞同：2
> 
> 时间：2013-03-12T21:58:54.840
> 
> 标签：javascript, html, html-table, cell, calculated-columns

我基本上会有一个包含一周中几天的表格（跨标题行）。**第 1 列-星期日**、**第 2 列-星期一**等。每个单元格都将输入工作时间，即`8`。最后一行我希望每个单元格在将数据输入每个单元格后，动态计算其列中其上方单元格的总数。理想情况下，这应该在将光标移动到不同的单元格后计算。

看来我应该为此使用一些 JavaScript。但是我不能从头开始编写 JavaScript；我只能在编写完成后将其调整为我需要的内容。

出于我们的目的，这里有一个基本表。我将把例子放在**第 1 列**。

```
<table id="workweek" class="wwtable">
<tr><th>sunday</th><th>monday</th><th>tuesday</th><th>wednesday</th><th>thursday</th><th>friday</th><th>saturday</th></tr>
<tr><td>8 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
<tr><td>8 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
<tr><td>8 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
<tr><td>8 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
<tr><td>8 </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
<tr><td>(Calculate 40 here) </td><td> </td><td> </td><td> </td><td> </td><td> </td><td> </td></tr>
</table> 
```

忘了提。每个单元格都会让用户输入每天的小时数，因此每个单元格中都会有输入字段。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:38:35.923

如果 jQuery 对您来说是一个可行的选择，您可以像这样遍历`td`给定列中的所有内容：

```
$('#workweek>tbody>tr>td:nth-child(1)').each( function(){
    sum += parseInt($(this).text()) || 0;
}); 
```

[我在 jsFiddle 上](http://jsfiddle.net/5S4Nd/2/)为您整理了一个工作示例：

```
for (var i=1; i<8; i++)
{
    var sum = 0;

    // iteration through all td's in the column
    $('#workweek>tbody>tr>td:nth-child(' + i + ')').each( function(){
        sum += parseInt($(this).text()) || 0;
    });

    // set total in last cell of the column
    $('#workweek>tbody>tr>td:nth-child(' + i + ')').last().html(sum);
} 
```

请注意，如果该列的最后一个单元格不为空，此示例将删除该列最后一个单元格的内容。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:32:09.033

您可以遍历表格的 DOM，并获取每个单元格的`textContent`or`innerText`作为小时值。

这是一种流行的方法：

```
function strip(html) {
    var tmp = document.createElement("DIV");
    tmp.innerHTML = html;
    return tmp.textContent||tmp.innerText;
} 
```

然后（类似这样）：工作示例：http: [//jsfiddle.net/7srJf/3/](http://jsfiddle.net/7srJf/3/)

```
var tbl = document.getElementById('my-table');
var rows = tbl.rows;
var DAYS_OF_WEEK = 2, totals = [0, 0];
for (var i = 0; i < DAYS_OF_WEEK; i++) { 
    for (var j = 1; j < rows.length; j++) {
      var cell = rows[j].cells[i];
      var numHours = parseInt(strip(cell.innerHTML), 10);
      totals[i] += numHours;
    }
} 
```

# html - Chromakey'd HTML 网络摄像头无法保存透明度

> ID：15373044
> 
> 赞同：0
> 
> 时间：2013-03-12T21:58:59.980
> 
> 标签：html, canvas, html5-video

我设置了一个带有网络摄像头、HTML5 视频和画布的绿屏。我从 MDN 获得了一个关于创建色度键（绿屏）的想法。但是使用实时网络摄像头而不是预先录制的视频。一切都按预期工作，除了当我去保存图像时，色度键区域是白色而不是透明的。有一个海洋的背景。当网络摄像头打开并且一个人站在它前面时，看起来这个人就在大海中。同样，保存该图像只会给我一个白色的盒子，中间有我自己。网络摄像头尺寸为 640 x 480，画布尺寸为 1600 x 800。

**编辑：** 我将色度键容差更改为深灰色及以上。现在，如果您在相机前放一些白色的东西，理论上它应该显示整个背景图像。但它的左边有一个 640x480 的盒子，颜色与`<body>`.

[这是一个演示](http://cultofpoopsy.net/cam/booth.html)除非您在背景中有一些绿色，否则它不会真正起作用。仅限 Webkit。

网络摄像头色度键：

```
var processor = {
timerCallback: function() {
    if (this.webcam.paused || this.webcam.ended) {          
        return;
    }
    this.computeFrame();
    var self = this;
    setTimeout(function () {
        self.timerCallback();
    }, 0);
},
doLoad: function() {
    this.webcam = document.getElementById("webcam");
    this.c1 = document.getElementById("c1");
    this.ctx1 = this.c1.getContext("2d");
    this.c2 = document.getElementById("c2");
    this.ctx2 = this.c2.getContext("2d");       
    var self = this;
    this.webcam.addEventListener("play", function() {
        self.width = 640;
        self.height = 480;
        self.timerCallback();
    }, false);
},
computeFrame: function() {
    this.ctx1.drawImage(this.webcam, 0, 0, 640, 480); //draw webcam to canvas
    var frame = this.ctx1.getImageData(0, 0, 640, 480); //capture a frame
    var l = frame.data.length / 4;
    for (var i = 0; i < l; i++) { //loop through pixels
        var r = frame.data[i * 4 + 0];
        var g = frame.data[i * 4 + 1];
        var b = frame.data[i * 4 + 2];
        if (g > 100 && r < 95 && b > 60 && b < 160 ){
            frame.data[i * 4 + 3] = 0;
        }
    }               
    this.ctx2.putImageData(frame, 480, 300); //place chroma video over bg img
    return;
}
}; 
```

脚本.js

```
processor.doLoad();

//more stuff runs

takePicture();

function takepicture() {    
    var canv = document.getElementById('c2');               
    var photo = document.querySelector('#inptPhoto');
    var data = canv.toDataURL('image/png');
    photo.setAttribute('src', data);
} 
```

我遇到了另一个 SO 帖子，该帖子表明我的图像实际上可能不是透明的，而是背景中的白色，这与我的结果一致。还有另一种方法可以做到这一点吗？

# python - 逻辑或运算符未按预期运行

> ID：15373050
> 
> 赞同：0
> 
> 时间：2013-03-12T21:59:26.407
> 
> 标签：python, if-statement, logical-or

```
def Forest(Health,Hunger):
    print'You wake up in the middle of the forest'
    Inventory = 'Inventory: '
    Squirrel =  'Squirrel'
    while True:
        Choice1 = raw_input('You...\n')
        if Choice1 == 'Life' or 'life':
            print('Health: '+str(Health))
            print('Hunger: '+str(Hunger))
        elif Choice1 == 'Look' or 'look':
            print 'You see many trees, and what looks like an edible dead Squirrel, \na waterfall to the north and a village to the south.'
        elif Choice1 == 'Pickup' or 'pickup':
            p1 = raw_input('Pickup what?\n')
            if p1 == Squirrel:
                if Inventory == 'Inventory: ':
                    print'You picked up a Squirrel!'
                    Inventory = Inventory + Squirrel + ', '
                elif Inventory == 'Inventory: Squirrel, ':
                        print'You already picked that up!'
            else:
                print"You can't find a "+str(p1)+"."
        elif Choice1 == 'Inventory' or 'inventory':
            print Inventory 
```

我正在努力做到这一点，当它说你...时，你可以输入 Life、Pickup、Look 或 Inventory。我在这个程序上有更多的代码我只是向你展示了一部分。但每次我运行它时，即使你输入“Pickup”或“Look”或“Inventory”，它总是显示“Life”部分。请帮忙！谢谢，约翰

编辑：我认为这只是一个间距问题，但我不确定它之前是否运行良好......

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T22:01:00.470

你误解了`or`表达方式。改用这个：

```
if Choice1.lower() == 'life': 
```

或者，如果您必须针对多个选项进行测试，请使用`in`：

```
if Choice1 in ('Life', 'life'): 
```

或者，如果您*必须*使用，请`or`像这样使用它：

```
if Choice1 == 'Life' or Choice1 == 'life': 
```

并将其扩展到您的其他`Choice1`测试。

`Choice1 == 'Life' or 'life'`被解释为`(Choice1 == 'Life') or ('life')`，后半部分*始终*为真。即使它*被*解释为`Choice1 == ('Life' or 'life')`then 后一部分将评估为`'Life'`only （就布尔测试而言它是 True ），因此您将`Choice1 == 'Life'`改为测试 if ，并且设置`Choice`为`'life'`永远不会使测试通过。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T22:02:53.313

你有：

```
 if Choice1 == 'Life' or 'life': 
```

这实际上相当于：

```
 if (Choice1 == 'Life') or 'life': 
```

非空/非零字符串（'life'）将始终被视为 true，因此您最终会出现在此处。

你要么想要：

```
 if Choice1 == 'Life' or Choice1 == 'life': 
```

或者：

```
 if Choice1.lower() == 'life': 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:01:56.207

使用`in`：

```
elif Choice1 in ('Pickup', 'pickup'): 
```

或者，您可以使用正则表达式：

```
import re

elif re.match("[Pp]ickup", Choice1): 
```

另外，我将使用 a`set`作为您的库存：

```
Inventory = set()
Squirrel =  'Squirrel'
while True:
...
        if p1 == Squirrel:
            if not Inventory:
                print'You picked up a Squirrel!'
                Inventory.add(Squirrel)
            elif Squirrel in Inventory:
                print'You already picked that up!' 
```

# magento - Magento 运输方式问题

> ID：15373058
> 
> 赞同：1
> 
> 时间：2013-03-12T21:59:51.170
> 
> 标签：magento, magento-1.6

我的问题是我将邮政编码设为可选，但现在，如果我在框中输入任何数字，运输方式就会消失。我可以在一页结帐中写下所有内容，但是当我到达邮政编码（现在是可选的）时，我写了一些东西，运输方式消失了，我尝试完成订单，我得到了

> 您的订单目前无法完成，因为没有可用的运输方式。请对您的收货地址进行必要的更改。

如果有人知道如何解决这个问题，谢谢

# java - JTree如何知道节点已展开但未选中

> ID：15373059
> 
> 赞同：1
> 
> 时间：2013-03-12T21:59:57.277
> 
> 标签：java, swing, selection, jtree, expansion

JTree 提供了 SelectionListener 和 ExpansionListener。但据我所知，当您只展开一个节点（单击 +/- 图标）时，也会触发一个选择事件。1）如果我点击扩展图标，我会得到 1 个扩展事件 + 1 个选择事件 2）如果我点击一个节点本身，我只会得到 1 个选择事件

有什么方法可以在用户展开节点时不触发选择事件？

或者......我怎么能只检测到扩展（没有选择）？我只想在真正选择节点并且仅在扩展时不执行任何操作时才执行耗时的操作（除了在 GUI 中扩展了节点）任何想法？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T04:09:03.013

您可以实现该`TreeWillExpandListener`接口来拦截`TreeExpansionEvent`，如[*如何编写 Tree-Will-Expand Listener*](http://docs.oracle.com/javase/tutorial/uiswing/events/treewillexpandlistener.html)所示。[`TreeExpandEventDemo2`](http://docs.oracle.com/javase/tutorial/uiswing/events/treewillexpandlistener.html#eg)是一个例子。

# jquery - 如何改变颜色

> ID：15373060
> 
> 赞同：1
> 
> 时间：2013-03-12T22:00:07.147
> 
> 标签：jquery, jquery-ui

在[**jQuery UI 手风琴**](http://jqueryui.com/accordion/#collapsible)中，当所有手风琴都折叠时，鼠标悬停在折叠的手风琴上以不同的颜色显示。

当前颜色非常微妙，我的一些用户很难注意到鼠标悬停在上面。

怎么改变那个颜色？
要更改哪个 CSS 属性以及在哪里更改？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:08:57.337

您正在寻找更改`ui-state-hover`css 属性。您可以在您的 css 文件中手动更改它，或者只需转到 jquery 站点上的[主题滚轮](http://jqueryui.com/themeroller/)并调整`Clickable: hover state`- 或选择不同的配色方案或完全自己制作一个。（然后您只需将现有的 css 文件替换为您将创建的文件。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:09:21.173

使用 Google Chrome 开发人员工具，您可以看到，当悬停元素时，它会在同一文件中的`ui-state-default`jQuery-ui.css 第 821 行和第 838 行之间切换类。`ui-state-hover`

CSS是：

```
.ui-widget-header .ui-state-default {
    border: 1px solid #d3d3d3/*{borderColorDefault}*/;
    background: #e6e6e6/*{bgColorDefault}*/ url(images/ui-bg_glass_75_e6e6e6_1x400.png)/*{bgImgUrlDefault}*/ 50%/*{bgDefaultXPos}*/ 50%/*{bgDefaultYPos}*/ repeat-x/*{bgDefaultRepeat}*/;
    font-weight: normal/*{fwDefault}*/;
    color: #555555/*{fcDefault}*/;
} 
```

和

```
.ui-widget-header .ui-state-focus {
    border: 1px solid #999999/*{borderColorHover}*/;
    background: #dadada/*{bgColorHover}*/ url(images/ui-bg_glass_75_dadada_1x400.png)/*{bgImgUrlHover}*/ 50%/*{bgHoverXPos}*/ 50%/*{bgHoverYPos}*/ repeat-x/*{bgHoverRepeat}*/;
    font-weight: normal/*{fwDefault}*/;
    color: #212121/*{fcHover}*/;
} 
```

我假设如果您有对该 css 文件的引用，您可以直接在您自己的副本中更新它，或者添加您自己的 css 并使用相同的类名添加`!important`到您的样式中。

我会尝试第一个，但我不确定后者，使用`!important`是一种很好的做法，尽管我可能是错的。

# android - 如何将列表视图与页面顶部对齐

> ID：15373062
> 
> 赞同：0
> 
> 时间：2013-03-12T22:00:10.540
> 
> 标签：android, eclipse

我的列表项出现在页面的底部，我的意思是，最后一项位于屏幕底部，而其他项则建立在它之上。我希望屏幕顶部的第一个项目和其他项目被放置在第一个之后，一个接一个。我怎样才能做到这一点？这是我的代码：

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    // Listimizde kaç tane eleman olduğunu bulmak için bunu kullanıyoruz
    ListView listView = (ListView) findViewById(R.id.linkList);

    String[] links = new String[] { "Facebook", "Ek$iSozluk", "Youtube",
            "Twitter", "Hurriyet", "Gmail" };

    // ArrayAdapter, bu listviewin nasıl görüneceğini belirtir. ilk argument
    // this, yani bu list
    // 2\. argument list viewin şekli, yani simple dropdown şeklinde olsun,
    // 3\. argument de links
    ArrayAdapter<String> adapter = new ArrayAdapter<String>(this,
            android.R.layout.simple_list_item_1, links);

    listView.setAdapter(adapter); // start the adapter for the list view
    listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
        @Override
        public void onItemClick(AdapterView<?> adapter, View view, int pos,
                long id) {
            // SO listener
            Intent myWebLink = new Intent(
                    android.content.Intent.ACTION_VIEW);
            myWebLink.setData(Uri.parse("http://www.facebook.com"));
            switch (pos) {

            case 0:
                myWebLink.setData(Uri.parse("http://www.facebook.com"));
                startActivity(myWebLink);
                // go to google
                break;
            case 1:
                myWebLink.setData(Uri.parse("http://www.eksisozluk.com"));
                startActivity(myWebLink);
                // go to facebook
                break;
            case 2:
                myWebLink.setData(Uri.parse("http://www.youtube.com"));
                startActivity(myWebLink);
                break;
            case 3:
                myWebLink.setData(Uri.parse("http://www.twitter.com"));
                startActivity(myWebLink);
                break;
            case 4:
                myWebLink.setData(Uri.parse("http://www.hurriyet.com.tr"));
                startActivity(myWebLink);
                break;
            case 5:
                myWebLink.setData(Uri.parse("http://www.gmail.com"));
                startActivity(myWebLink);
                break;
            default:

                // where ever you want
                break;
            }

        }
    });

    // OR listener

} 
```

这是我的布局：

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:paddingBottom="@dimen/activity_vertical_margin"
android:paddingLeft="@dimen/activity_horizontal_margin"
android:paddingRight="@dimen/activity_horizontal_margin"
android:paddingTop="@dimen/activity_vertical_margin"
tools:context=".MainActivity" >

<ListView
    android:id="@+id/linkList"
    android:layout_width="match_parent"
    android:layout_height="wrap_content"
    android:layout_alignParentBottom="true"
    android:layout_alignParentTop="@+id/linkList" >

</ListView> 
```

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T22:04:26.220

不要将您的 ListView 与底部对齐。更具体地说，删除两条对齐线：

```
<ListView
    android:id="@+id/linkList"
    android:layout_width="match_parent"
    android:layout_height="match_parent" /> 
```

`alignParentTop`接受布尔值，而不是引用。此外，这是标准的，所以你在这里不需要它。 `alignParentBottom`是导致您的问题的原因，您正在与父级的底部对齐。

此外，`wrap_content`在`ListView`高度上通常是一个坏主意。

# javascript - 不允许将重复项推入数组

> ID：15373068
> 
> 赞同：5
> 
> 时间：2013-03-12T22:00:38.620
> 
> 标签：javascript, jquery, arrays, push

基本上我将容器推入一个数组，一旦一个被推入，我不想让同一个被再次推入。

这是我的 JSfiddle：http: [//jsfiddle.net/9Dmcg/3/](http://jsfiddle.net/9Dmcg/3/)

Javascript：

```
$(document).ready(function(){

var favorites = [];
var counter = 0;

    $('.containers').on('click', function(){

        favorites.push($(this).clone())

        $('.favorite').append(favorites);
    });

}); 
```

我需要找到一种方法来解决这个问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:03:37.003

除非该单击事件有更多内容，否则您可以使用该`.one()`方法代替`.on`来获取此功能。

```
$(document).ready(function(){

    var favorites = [];
    var counter = 0;

    $('.containers').one('click', function(){

        favorites.push($(this).clone())

        $('.favorite').append(favorites);
    });    

}); 
```

[http://jsfiddle.net/9Dmcg/4/](http://jsfiddle.net/9Dmcg/4/)

即使还有更多内容，您仍然可以使用`.one()`：

```
$(document).ready(function(){

    var favorites = [];
    var counter = 0;

    $('.containers').one('click', function(){

        favorites.push($(this).clone())

        $('.favorite').append(favorites);

        $(this).on("click",function(){
             alert("Favorite Added!");
        }).triggerHandler("click");

    });    

}); 
```

[http://jsfiddle.net/9Dmcg/5/](http://jsfiddle.net/9Dmcg/5/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:13:31.643

尝试检查我会说的元素 ID。像这样的东西：

```
$(document).ready(function(){

var favorites = [];
var counter = 0;

    $('.containers').bind('click', function(){
        var isAdded = false;
        for (var f = 0; f < favorites.length; f++) {
            console.log(favorites[f].id + "|" + this.id);
             if (favorites[f].id === this.id)
                 isAdded = true;
        }

        if (!isAdded)
            favorites.push($(this).clone()[0])

         console.log(favorites);
        $('.favorite').append(favorites);
    });

}); 
```

这是工作示例-> [http://jsfiddle.net/9Dmcg/7/](http://jsfiddle.net/9Dmcg/7/)

mz

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-11-20T10:00:11.847

这可以使用 JS 代理（[https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy)）来完成

以下是创建不接受重复条目的数组的代码

```
var arr = new Proxy([], {
  get: function(target, key) {
    return target[key];
  },
  set: function(target, key, value){
    if(target.indexOf(value)>=0) return false;
    target[key] = value;
    return true
  }
});
arr.push(100);
arr.push(100); // this will throw error 
```

在上面的代码中，我们正在修改数组的默认行为，因为对数组进行的任何修改都会调用 set 方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:07:34.730

您可以检查该元素是否已存在：

```
$(document).ready(function(){

    var favorites = [];

    $('.containers').on('click', function(){
        var found = false;
        for(var i = 0; i < favorites.length; i++)
        {
            if (favorites[i] == $(this)) found = true;
        }
        if (!found) favorites.push($(this).clone())

        $('.favorite').append(favorites);
    });

}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T22:13:15.320

为已推送的项目添加一个类，然后进行基本检查：而不是：

```
favorites.push($(this).clone()) 
```

你可以做：

```
if( !$(this).hasClass("pushed") ) {
    favorites.push( $(this).addClass("pushed").clone() );
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-12T22:14:42.160

只需推送元素本身而不是克隆它：

```
favorites.push($(this)) 
```

额外的好处是它为用户提供了该项目已被添加的线索。

现场演示：http: [//jsfiddle.net/9Dmcg/6/](http://jsfiddle.net/9Dmcg/6/)

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-03-12T22:14:56.453

好像您在寻找[Array.indexOf](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array/indexOf)。它返回数组中值的索引。如果未找到，则返回 -1。

这是一个新的数组方法，所以你需要一个 polyfill 才能在旧浏览器上工作。

```
$(document).ready(function(){

    var favorites = [];
    var counter = 0;

    $('.containers').on('click', function(){
        var clone = $(this).clone(); // caching element

        if (favorites.indexOf(clone) !== -1) {
            favorites.push(clone);
        }

        $('.favorite').append(favorites);
    });
}); 
```

# c# - Asp .NET MVC - 实体框架多对多关系，插入数据

> ID：15373071
> 
> 赞同：1
> 
> 时间：2013-03-12T22:00:44.400
> 
> 标签：c#, many-to-many, entity-framework-5

我有模型：

```
public class Movie
{
    [Key]
    public int MovieId { get; set; }

    public string Title{ get; set; }

    public ICollection<Actor> Actors { get; set; }
 }

public class Actor
{
    [Key]
    public int AtorId { get; set; }
    public string Nome { get; set; }

    public ICollection<Movie> Movies { get; set; }
} 
```

和上下文：

```
public class MoviesContext : DbContext
{
    public DbSet<Movie> Movies { get; set; }
    public DbSet<Actor> Actors { get; set; }

    public MoviesContext()
    {
        Database.SetInitializer(new DropCreateDatabaseIfModelChanges<MoviesContext>());
    }

    protected override void OnModelCreating(DbModelBuilder modelBuilder)
    {
        modelBuilder.Conventions.Remove<PluralizingTableNameConvention>();
        modelBuilder.Entity<Movie>().
            HasMany(m => m.Actors).
            WithMany(a => a.Movies).
            Map(
                m =>
                {
                    m.MapLeftKey("MovieId");
                    m.MapRightKey("ActorId");
                    m.ToTable("ActorsMovies");
                });
    }
} 
```

表“ActorsMovies”已在 sql server 上创建。如何使用实体框架将数据插入此表中？例如，要在电影表上插入数据，我使用了代码 db.Movies.Add(movie) 和 db.SaveChanges() }

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:08:06.630

```
movie.Actors.Add(actor);
db.SaveChanges(); 
```

这应该允许您更新多对多表。

# php - 类 Closure 的对象无法在文件名中转换为字符串。

> ID：15373072
> 
> 赞同：12
> 
> 时间：2013-03-12T22:00:45.030
> 
> 标签：php

```
function convert($currencyType)
{
    $that = $this;
    return $result = function () use ($that) 
    {
        if (!in_array($currencyType, $this->ratio))
                return false;

        return ($this->ratio[$currencyType] * $this->money); //a float number
    };
}

$currency = new Currency();
echo $currency->convert('EURO'); 
```

怎么了？

我收到错误消息：

```
Catchable fatal error: Object of class Closure could not be converted to string 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T22:09:38.067

几个问题：

1.  因为您要返回一个闭包，所以您必须先将闭包分配给一个变量，然后调用该函数
2.  您的`$this`引用在闭包内不起作用（这就是您要使用的`use`原因`$that`）
3.  您还需要使用`$currencyType`在闭包的范围内访问它

* * *

```
function convert($currencyType)
{
    $that =& $this; // Assign by reference here!
    return $result = function () use ($that, $currencyType) // Don't forget to actually use $that
    {
        if (!in_array($currencyType, $that->ratio))
                return false;

        return ($that->ratio[$currencyType] * $that->money); //a float number
    };
}

$currency = new Currency();
$convert = $currency->convert('EURO');
echo $convert(); // You're not actually calling the closure until here! 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-04-29T11:14:20.570

您必须在括号之间创建函数并在关闭函数时添加括号。

```
function convert($currencyType)
{
    $that = $this;
    return $result = (function () use ($that) 
    {
        if (!in_array($currencyType, $this->ratio))
                return false;

        return ($this->ratio[$currencyType] * $this->money); //a float number
    })();
}

$currency = new Currency();
echo $currency->convert('EURO'); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-12T22:05:20.317

只需删除`return`那里并执行以下操作：

```
$result = function () use ($that) 
{
    if (!in_array($currencyType, $this->ratio))
            return false;

    return ($this->ratio[$currencyType] * $this->money); //a float number
};
return $result(); 
```

另外，您是否意识到您没有`$that`在函数内部使用？

顺便说一句，为什么你需要一个匿名函数呢？做就是了：

```
function convert($currencyType)
{
    if (!in_array($currencyType, $this->ratio))
        return false;

    return ($this->ratio[$currencyType] * $this->money); //a float number
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:05:37.483

```
class Currency {
    function convert($currencyType)
    {
        if (!in_array($currencyType, $this->ratio))
             return false;
        return ($this->ratio[$currencyType] * $this->money); //a float number
    }
}

$currency = new Currency();
echo $currency->convert('EURO'); 
```

您正在定义一个 lambda 函数。你不需要它。此外，如果要具有任何准确性，您应该使用[bcmul() ；](http://php.net/manual/en/function.bcmul.php)PHP 中的浮点数将为您提供时髦的结果。

# symfony - 我该如何处理教义错误？

> ID：15373073
> 
> 赞同：5
> 
> 时间：2013-03-12T22:00:51.437
> 
> 标签：symfony

我`dbal`在我的 Symfony2 应用程序中使用 Doctrine 的服务。

我查询一个不存在的表，这会引发错误：

> SQLSTATE [42S02]：未找到基表或视图：1146 表“log.requests_20130311”不存在。

Symfony2 在我之前就捕捉到了这一点，即使是在一个`try-catch`块中。我不希望这会杀死我的应用程序。我该如何处理？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T14:35:58.377

根据@Coussinsky 的评论，您需要`\`在您的异常前添加一个：

```
try {
    $result_set = $this->connection->query($sql);
} catch (\Exception $e) {
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T11:15:21.043

Doctrines DBAL 层是 PDO 的包装器，因此您应该能够：

```
try {
    // Query your non-existent table
} catch (\PDOException $e) {
    // Deal with it without killing your app
} 
```

[http://symfony.com/doc/current/cookbook/doctrine/dbal.html](http://symfony.com/doc/current/cookbook/doctrine/dbal.html)

# scala - 为什么 Option 扩展 Product？

> ID：15373079
> 
> 赞同：3
> 
> 时间：2013-03-12T22:01:04.267
> 
> 标签：scala, scala-option

我一定遗漏了一些东西，但我没有看到类中的特性`productElement`和特性的实现。`productArity`[`Product`](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/Product.scala#L1)[`Option`](https://github.com/scala/scala/blob/v2.10.0/src/library/scala/Option.scala#L1)

所以两个问题：

1.  为什么会`Option`延长`Product`？
2.  怎么可能`Option`（或它的两个子类中的任何一个）没有实现这两种方法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T22:12:40.303

当您`Option`在 scala 中生成一个时，您实际上是在生成一个`Some`或一个`None`，它们都是案例类/对象。scala 编译器对案例类发挥了神奇的作用，并`Product`为它们生成方法。

来自 Scala 2.10 Product.scala：

```
/** Base trait for all products, which in the standard library include at
 *  least [[scala.Product1]] through [[scala.Product22]] and therefore also
 *  their subclasses [[scala.Tuple1]] through [[scala.Tuple22]].  In addition,
 *  all case classes implement `Product` with synthetically generated methods.
 *
 *  @author  Burak Emir
 *  @version 1.0
 *  @since   2.3
 */ 
```

我希望这能回答你的两个问题，编译器的魔力！

# c# - 确保调用结束方法链

> ID：15373082
> 
> 赞同：11
> 
> 时间：2013-03-12T22:01:11.667
> 
> 标签：c#, .net, fluent-interface

注意/免责声明：经过几次搜索后，我看到的最接近这篇文章的是关于 SO（[方法链接和完成问题](https://stackoverflow.com/questions/2146623/method-chaining-and-the-finishing-problem)）的帖子，这与我的问题相似，但并没有真正回答 - 但无论如何，我希望这不是一个重复的问题。

**我在做什么：**

我已经为一堆方法调用创建了一个流利的接口作为现有日志框架的外观 - 所以我的语法看起来有点像这样：

```
Logger.Debug().Message("Debug message!").WriteToLog();
Logger.Error().Message("An exception occured").Exception(ex).WriteToLog(); 
```

我将一个内部对象从一个方法调用传递给下一个对象，以便在进行最终调用时（WriteToLog 方法）；消息被写入某处的日志文件。

**我觉得有点臭**

为了验证（仅当应用程序以调试模式构建时），我在上下文类（只是一个属性包对象）上有一个属性，该属性从方法调用传递到返回的对象，直到链终止；它是一个布尔值，默认为 false。

此属性在上下文类析构函数中使用 Debug.Assert 进行评估，以确定是否调用结束链的最终方法，以便在开发过程中获取任何日志记录错误。（属性、设置属性的代码和析构函数本身都是在#if DEBUG 预处理器指令的上下文中创建的，所以如果它是内置的或者如果符号不存在，代码将不会编译。）

我*知道*在 c#2.0 及更高版本中使用析构函数是不好的，而且我可能无法访问属性，因为我相信无法保证最终确定顺序。这就是为什么它只在调试模式下发生，以及为什么我想摆脱它。

我试图建立一个断言的原因是因为它很容易忘记并最终编写像

```
Logger.Debug().Message("Debug message!"); 
```

这意味着什么都不会被记录，尽管粗略一看，它看起来应该是这样。

**我的问题**

我想知道的是——谁能想到另一种方法来验证最终方法是否总是被调用？这些消息只是在开发期间需要向开发人员强调方法链尚未完成 - 我不希望最终用户找到与登录最终产品相关的错误消息。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-12T22:09:48.367

首先，我会质疑在这种情况下是否需要流畅的界面，似乎您可以使用更简单的界面轻松完成：

```
Logger.Debug.Message("Test"); 
```

甚至只是：

```
Logger.Debug("Test"); 
```

但是，如果您真的需要/想要一个流畅的接口，另一种方法是让流畅的接口在方法的参数上工作，而不是在返回值上工作。

所以不要这样做：

```
Method1().Method2().Method3(); 
```

然后忘记了最后的电话：

```
Method1().Method2().Method3().Execute(); 
```

您将改为组织代码，可能像这样：

```
Method1(o => o.Method2().Method3()); 
```

为此，您将定义一个对象，您将在该对象上调用所有流畅的方法：

```
public class LoggerOptions
{
    public LoggerOptions Debug() { LoggerType = LoggerType.Debug; return this; }
    public LoggerOptions Error() { LoggerType = LoggerType.Error; return this; }
    public LoggerOptions Message(string message) { ...; return this; }

    public LoggerType Type { get; set; }
    ...
} 
```

这里的每个方法调用都会修改 LoggerOptions 对象，然后返回相同的实例，以继续流畅的接口。

进而：

```
public static class Logger
{
    public static void Log(Func<LoggerOptions, LoggerOptions> options)
    {
        LoggerOptions opts = options(new LoggerOptions());
        // do the logging, using properties/values from opts to guide you
    }
} 
```

然后你会这样称呼它：

```
Logger.Log(opts => opts.Debug().Message("Debug message")); 
```

如果您在完成设置选项对象之前绝对需要调用一些终端方法，则可以创建不同的对象：

```
public class LoggerOptions
{
    public LoggerOptions Debug() { LoggerType = LoggerType.Debug; return this; }
    public LoggerOptions Error() { LoggerType = LoggerType.Error; return this; }
    public LoggerOptions Message(string message) { ...; return this; }

    public LoggerType Type { get; set; }
    ...

    public LoggerFinalOptions ToEventLog() { ...; return new LoggerFinalOptions(this); }
    public LoggerFinalOptions ToFile(string fileName) { ...; return new LoggerFinalOptions(this); }
} 
```

进而：

```
public static class Logger
{
    public static void Log(Func<LoggerOptions, LoggerFinalOptions> options)
    {
        LoggerFinalOptions opts = options(new LoggerOptions());
        // do the logging, using properties/values from opts to guide you
    }
} 
```

这将保证如果不通过调用返回显式最终选项对象的方法来结束方法链，则无法编译代码：

```
// will not compile
Logger.Log(opts => opts.Debug().Message("Test"));

// will compile
Logger.Log(opts => opts.Debug().Message("Test").ToFile("log.log")); 
```

# php - php到mysql更新帖子不起作用

> ID：15373103
> 
> 赞同：0
> 
> 时间：2013-03-12T22:02:43.270
> 
> 标签：php, html, mysql

由于某种原因，这不会更新数据库，数据库登录的值是正确的，对所有页面使用相同的 inc 文件。没有错误，只是数据库中没有更新。似乎无法为我的一生弄清楚。

```
<?
include("../../inc/config.inc.php");
session_start();
$loggeduser = $_SESSION['myusername'];
if(!session_is_registered(myusername)){
header("location:login/login.php");
}
?>
<?
$userpost = $_POST["username"];
if(is_null($userpost)) {
mysql_connect("$host", "$user", "$pwd") or die(mysql_error());
mysql_select_db("$database") or die(mysql_error());
$server_query_sql = ("SELECT * FROM $admin_tbl WHERE username = '$loggeduser'");
$getdata = mysql_query($server_query_sql) or die("Couldn't execute the query");
$row = mysql_fetch_array( $getdata );
$adminuser = $row['username'];
$adminpass = $row['password'];
$adminemail = $row['email'];
mysql_close();
}
else {
$postemail = $_POST["email"];
$postpass = $_POST["password"];
$encrypted_password = md5($postpass);
mysql_connect("$host", "$user", "$pwd") or die(mysql_error());
mysql_select_db("$database") or die(mysql_error());
$server_query_sql = ("SELECT * FROM $admin_tbl WHERE username = '$loggeduser'");
$getdata = mysql_query($server_query_sql) or die("Couldn't execute the query");
$row = mysql_fetch_array( $getdata );
$adminuser = $row['username'];
$adminpass = $row['password'];
$adminemail = $row['email'];

if ($encrypted_password = $adminpass){
$query = "UPDATE $admin_tbl SET email='$postemail' WHERE username='$loggeduser'";
mysql_query($query);
}
else {
$query = "UPDATE $admin_tbl SET email='$postemail', password='$encrypted_password'     WHERE username='$loggeduser'";
    mysql_query($query);
mysql_close(); 
}
}
?>
<html>
<head>
<link rel="stylesheet" type="text/css" href="../../inc/login.css" />
    <style>
        @import url(http://fonts.googleapis.com/css?family=Ubuntu:400,700);
        body {

            -webkit-background-size: cover;
            -moz-background-size: cover;
            background-size: cover;
        }
        .container > header h1,
        .container > header h2 {
            color: #fff;
            text-shadow: 0 1px 1px rgba(0,0,0,0.7);
        }
    </style>
</head>
<body><br><br>
  <div align="center">Hi <strong><? echo $loggeduser; ?></strong>!</div>
   <div class="container">
        <section class="main">
            <form class="form-3" method="post" action='<? $_SERVER['PHP_SELF']; ?>'>
                <p class="clearfix">
                    <label for="login">Email</label>
                    <input type="text" name="email" id="email" placeholder="Username" value='<? echo $adminemail; ?>'>
                </p>
                <p class="clearfix">
                    <label for="password">Password</label>
                    <input type="password" name="password" id="password" placeholder="Password" value='<? echo $adminpass; ?>'> 
                </p>
                <p class="clearfix">
                    <input type="submit" name="submit" value="Edit">
                </p>       
            </form>​
        </section>
    </div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:05:01.977

我看到的第一个问题是`$encrypted_password = $adminpass`. 用于`==`比较。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:06:32.590

而不是这个

```
 if ($encrypted_password = $adminpass){ 
```

采用

```
 if ($encrypted_password == $adminpass){ 
```

您可以通过使用解决此问题以查看它们是否真的等于密码

```
 echo $encrypted_password . ' ----- ' .$adminpass ;  // and see if they are same. 
```

# ruby - 不自动保存所属关联

> ID：15373107
> 
> 赞同：0
> 
> 时间：2013-03-12T22:02:51.290
> 
> 标签：ruby, ruby-on-rails-3

我有一个模型订阅与参与者的所属关联。

订阅表单使用 fields_for 构建关联的参与者字段。

表单中还有一个名为“other_person”的单选按钮。

我想要的是在 other_person 字段设置为 false 时不保存关联的参与者表（因此也不验证）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:13:19.693

我将假设是以下示例`other_person`中模型的一个字段：`Subscription`

```
class Subscription < ActiveRecord::Base
  before_save :remove_empty_participant
  belongs_to :participant

  private

  def remove_empty_participant
    self.participant = nil unless self.other_person
  end
end 
```

如果它不是`Subscription`模型的字段，则必须删除控制器操作中的属性：

```
class SubscriptionsController < ActionController

  def create
    params[:subscription].delete(:participant) unless params[:other_person]
    # Save the subscription with your current params...
  end

end 
```

希望能帮助到你。

# ios - NSRegularExpression 行为怪异（并且正则表达式是正确的）

> ID：15373110
> 
> 赞同：4
> 
> 时间：2013-03-12T22:02:56.950
> 
> 标签：ios, objective-c, regex, nsregularexpression

我有这个正则表达式

```
([0-9]+)\(([0-9]+),([0-9]+)\) 
```

我用来构造一个没有选项 (0) 的 NSRegularExpression。该表达式应该匹配字符串，如

```
1(135,252) 
```

并产生三个匹配项：1、135、252。现在，我已经通过 debuggex.com 确认该表达式是正确的并且可以满足我的要求。但是，iOS 拒绝承认我的努力和以下代码

```
NSString *nodeString = @"1(135,252)";
NSArray *r = [nodeRegex matchesInString:nodeString options:0 range:NSMakeRange(0, nodeString.length)];
NSLog(@"--- %@", nodeString);
for(NSTextCheckingResult *t in r) {
    for(int i = 0; i < t.numberOfRanges; i++) {
        NSLog(@"%@", [nodeString substringWithRange:[t rangeAtIndex:i]]);
    }
} 
```

坚持说

```
--- 1(135,252)
135,252
13
5,252
5
252 
```

这显然是错误的。

想法？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T22:36:31.947

你的正则表达式应该是这样的

```
[NSRegularExpression regularExpressionWithPattern:@"([0-9]+)\\(([0-9]+),([0-9]+)\\)" 
                                          options:0 
                                            error:NULL]; 
```

注意模式中的*双*反斜杠。它们是必需的，因为反斜杠用于转义 C 中的特殊字符（例如引号），而 Objective-C 是 C 的超集。

* * *

如果您正在寻找使用正则表达式的便捷工具，我可以推荐[Patterns](http://krillapps.com/patterns/)。它非常便宜，可以直接出口`NSRegularExpressions`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:20:01.927

Debuggex 当前仅支持原始正则表达式。这意味着如果您在字符串中使用正则表达式，则需要转义反斜杠，如下所示：

`([0-9]+)\\(([0-9]+),([0-9]+)\\)`

另请注意，Debuggex（尚）不支持Objective C。这对于简单的正则表达式可能无关紧要，但对于更复杂的正则表达式，不同的引擎会做不同的事情。这可能会导致一些意外行为。

# jquery - javascript 不能在 wordpress 上运行

> ID：15373111
> 
> 赞同：0
> 
> 时间：2013-03-12T22:03:03.237
> 
> 标签：jquery, wordpress

我尝试使用没有冲突的方式修复代码，但它仍然无法在 wordpress 上运行。

更奇怪的是，同样的代码在 jsbin 上运行良好。

[http://jsbin.com/egezeg/1/edit](http://jsbin.com/egezeg/1/edit)

原代码： [http ://cloud.github.com/downloads/wduffy/jScroll/jquery.jscroll.js](http://cloud.github.com/downloads/wduffy/jScroll/jquery.jscroll.js)

我也测试过

```
$j("body").html("1234"); 
```

它工作正常。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:47:44.277

尝试将这样的内容添加到您的functions.php：

```
//ad our custom Jquery
function my_init() {
if (!is_admin()) {
    wp_deregister_script('jquery');
    wp_register_script('jquery', 'http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js', false, '1.8.2', true);

    wp_enqueue_script('jquery');
    // load a JS file from your theme: js/theme.js
    wp_enqueue_script('myscript', get_template_directory_uri() . '/js/myscript.js', array('jquery'), '1.0', true);

}
}

add_action('init', 'my_init'); 
```

# macros - 如何从预处理器宏创建字符串

> ID：15373113
> 
> 赞同：14
> 
> 时间：2013-03-12T22:03:08.750
> 
> 标签：macros, verilog, system-verilog

我有一个预处理器宏，它代表我设计的分层路径。

例子：

```
`define HPATH top.chip.block 
```

我需要构造一个包含 值的字符串``HPATH`，因此在我的示例中，字符串应该等于`top.chip.block`。

有没有办法构造这样一个字符串？

以下尝试均无效：

```
string hpath;
hpath = "`HPATH";     // Results in hpath = "`HPATH"
hpath = \"``HPATH\";  // Doesn't compile
hpath = `HPATH;       // Doesn't compile 
```

我想`hpath`相当于做这个分配`hpath = "top.chip.block"`，但通过使用``HPATH`而不是再次指定路径。

我无法使用`%m`，因为我需要顶级 UVM 环境中的字符串，而不是模块中的字符串。

更多背景知识：我想这样做的原因是因为我在 UVM 类库中使用了后门寄存器访问。后门 API 需要将 hdl_path 设置为设计中的块，作为字符串。我已经为分层路径定义了“定义”，并且在指定 hdl_paths 时尝试重用这些路径，因此我没有两次定义相同的路径。我的测试台将同时使用分层路径和字符串路径。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-13T03:38:18.877

不能在字符串文字中使用 `define 宏。根据 SystemVerilog LRM：

> 宏替换和参数替换不应发生在字符串文字中。

但是，可以通过使用带有参数的宏来构造字符串文字，并使用 ``"` 在宏中包含引号。

同样，来自 LRM：

> `" 覆盖了 " 的通常词法含义，并指示扩展应包括引号、实际参数的替换和嵌入宏的扩展。这允许从宏参数构造字符串文字。

所以这有效：

```
`define STRINGIFY(x) `"x`"
`define HPATH top.chip.block
string hpath = `STRINGIFY(`HPATH);
$display(hpath);                       // Output: "top.chip.block" 
```

示例代码可以在这里运行：[http ://www.edaplayground.com/s/4/879](http://www.edaplayground.com/s/4/879)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2018-06-25T20:56:45.337

我知道这是一个旧线程，但我想我会分享我们的解决方案。$sformatf 的使用允许在需要时添加其他信息。

```
`define STRINGIFY(DEFINE) $sformatf("%0s", `"DEFINE`") 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T01:51:12.143

我想这就是你要找的。

```
`define HPATH `"top.chip.block`"
string hpath = `HPATH; 
```

正如 toolic 指出的那样，转义序列 %m 在 $display 语句中使用时将为您提供当前层次结构，因此这可能是一个更好的选择。

# php - 将会话数据解析到我的 INSERT 函数

> ID：15373118
> 
> 赞同：0
> 
> 时间：2013-03-12T22:03:30.823
> 
> 标签：php, mysql

我正在尝试将 member_data 会话解析到我的函数中，但是不确定如何执行此操作。我的功能是

```
function createTransaction(){
    // Insert into the transactions table
    $query1 = mysql_query("INSERT INTO transactions (mem_id, OrderDate, Ship_Phone, Ship_Address, Ship_City, Ship_County, Ship_PostCode, Ship_Country) VALUES()");
    if($query1) {
        // Get the highest ID in the transactions table. This should be the ID of the row we just inserted.
        $tempInfo = mysql_query("SELECT `order_id` FROM `transactions` ORDER BY `order_id` DESC LIMIT 1");
        $tempInfo = mysql_fetch_assoc($tempInfo);
        $orderId = $tempInfo['order_id'];

        // Insert into the transaction details table.
        $query2 = mysql_query("INSERT INTO `transactionDetails` (Order_ID, Product_ID, Price, Quantity) VALUES({$orderId}, {$item_id}, {$price}, {$each_item})");

        if($query2) {
            // Success.
        } else {
            // Error occurred.
            echo 'Query2 Error: ' . mysql_error();
        }
    } else {
        // Error occurred.
        echo 'Query1 Error: ' . mysql_error();
    }
} 
```

值在哪里（第 3 行），我想从我的会话中插入数据

```
$session_mem_id = $_SESSION['mem_id'];
$member_data  = member_data($session_mem_id, 'mem_id', 'mem_email', 'mem_password', 'mem_address', 'mem_city', 'mem_postcode', 'mem_county', 'mem_country', 'mem_first_name', 'mem_last_name', 'password_recover', 'allow_email', 'admin', 'mem_tel'); 
```

我该怎么做呢？

# php - 每隔 30 分钟计算一次数据库中的重复记录

> ID：15373124
> 
> 赞同：3
> 
> 时间：2013-03-12T22:03:52.290
> 
> 标签：php, mysql, sql, procedures, routines

我需要以下帮助

我有表**“数据”**获取存储在其上的数据，如下所示

```
+------------+----------+-----------
| regdate    | regtime  | items              
+------------+----------+-----------
| 2013-03-02 | 09:12:03 | item1   
| 2013-03-02 | 10:12:05 | item1          
| 2013-03-02 | 15:12:07 | item2    
| 2013-03-02 | 20:12:09 | item3       
| 2013-03-02 | 21:12:11 | item4    
| 2013-03-02 | 22:12:14 | item3 
```

以此类推，**10 个项目**可以在一天中的不同时间从**09:00 到 23:00上桌**

我有另一个表**“ItemsPerInterval”**，如下所示

```
+------------+-------------+-------------+-------------+-------------+
| regdate    | reginterval | item1       | item2       | item3       |
+------------+-------------+-------------+-------------+-------------+
| 2013-03-01 | 09:00:00    | 0           | 0           | 0           |
+------------+-------------+-------------+-------------+-------------+ 
```

依此类推，间隔以**30 分钟**为基础增加，例如 09:00 , 09:30 , 10:00, 10:30 ... 直到 23:00

* * *

我想要做的是在表**ItemsPerInterval上插入数据，以包括表****“数据”**（*item1、item2、item3、.... item10* ） 上的项目的重复计数并按间隔存储它们（*09:00 :00, 09:30:00, 10:00:00, 10:30:00, .... 23:00:00* ) 以便每个间隔 - 例如 - **09:00:00**将具有重复计数从**09:00:00 到 09:29:59**已在**数据**表中注册的所有项目，其余时间间隔为 23:00:00

 **编辑**1

因此最终必须在 ItemsPerInterval 表上注册所有以下间隔，并保存已在间隔时间窗口中报告的 10 个项目中的每个项目的计数

```
09:00:00
09:30:00
10:00:00
10:30:00
11:00:00
11:30:00
12:00:00
12:30:00
13:00:00
13:30:00
and so on .....
.
.
.
22:00:00
22:30:00
23:00:00 
```

/编辑**1

我做了一些关于例程/程序的阅读，但我不知道区别，也不知道如何使用它来实现上述内容。

我正在使用软件：MySQL 软件版本：带有 PHP 的 5.5.24。

感谢您的支持

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:16:13.157

您可以使用此查询：

```
SELECT
  regdate,
  SEC_TO_TIME(TRUNCATE(TIME_TO_SEC(regtime)/(60*30),0)*(60*30)) reginterval,
  COUNT(CASE WHEN items='item1' THEN 1 END) item1,
  COUNT(CASE WHEN items='item2' THEN 1 END) item2,
  COUNT(CASE WHEN items='item3' THEN 1 END) item3,
  COUNT(CASE WHEN items='item4' THEN 1 END) item4
FROM Data
GROUP BY
  regdate,
  reginterval 
```

如果您需要将结果行插入到新表中，只需在开头添加以下行：

```
INSERT INTO ItemsPerInterval (regdate, reginterval, item1, item2, item3, item4)
SELECT ... 
```

**编辑**

如果您还想显示所有间隔，即使它们没有值，我认为您能做的最好的事情就是拥有一个`Intervals`包含您需要的所有间隔的表：

```
CREATE TABLE Intervals (
  reginterval time
);

INSERT INTO Intervals VALUES
('09:00:00'),
('09:30:00'),
('10:00:00'),
... 
```

此查询返回所有间隔，并结合表中存在的所有日期：

```
SELECT Dates.regdate, Intervals.reginterval
FROM
  (SELECT DISTINCT regdate FROM Data) Dates,
  Intervals 
```

此查询返回您需要的行：

```
SELECT
  di.regdate,
  di.reginterval,
  COUNT(CASE WHEN Data.items='item1' THEN 1 END) item1,
  COUNT(CASE WHEN Data.items='item2' THEN 1 END) item2,
  COUNT(CASE WHEN Data.items='item3' THEN 1 END) item3,
  COUNT(CASE WHEN Data.items='item4' THEN 1 END) item4
FROM (
  SELECT Dates.regdate, Intervals.reginterval
  FROM (SELECT DISTINCT regdate FROM Data) Dates,
       Intervals
  ) di
  LEFT JOIN Data
   ON di.regdate=Data.regdate
      AND di.reginterval=SEC_TO_TIME(TRUNCATE(TIME_TO_SEC(Data.regtime)/(60*30),0)*(60*30))
GROUP BY
  regdate,
  reginterval; 
```

请[在此处](http://sqlfiddle.com/#!2/fcb1b/1)查看小提琴。

**这是如何运作的**

这里的想法是使用[TIME_TO_SEC](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_time-to-sec)`regtime`函数将包含时间的字段转换为自一天开始以来的秒数：

```
TIME_TO_SEC(regtime) 
```

然后我们将此数字除以 60*30，即 30 分钟内的秒数，只保留整数部分：

```
TRUNCATE(number_of_seconds/(60*30), 0) 
```

然后我们将整数部分乘回到 60*30 得到秒数，四舍五入为 60*30 秒（30 分钟）。

使用[SEC_TO_TIME](https://dev.mysql.com/doc/refman/5.5/en/date-and-time-functions.html#function_sec-to-time)我们将秒数转换回时间字段。**

# c - 熔断器：将 stat 结构从 readdir() 传递到 getattr()

> ID：15373128
> 
> 赞同：1
> 
> 时间：2013-03-12T22:04:12.050
> 
> 标签：c, fuse

我正在尝试为 readdir() 中的每条记录填充一个 stat 结构，并通过 fill() 将相应的 stat 传递给 getattr。 [我在某处读到](http://www.cs.hmc.edu/~geoff/classes/hmc.cs135.201001/homework/fuse/fuse_doc.html)FUSE 在 readdir 填充时仅识别 stat 结构的某些字段（切题：总是这样吗？）。显然，这些接受的字段之一是 st_ino。但是，当我在 readdir() 处为给定记录填充统计结构的 st_ino 时，我在 getattr() 处看不到该记录的相应更改。

也许值得注意的是，我试图用上述问题解决的问题是我想按记录将（非 POSIX）信息从 readdir 传递给 getattr。最初，我的 hack 是将一个唯一标识符附加到作为主键的每个记录名称到包含此（非 POSIX）信息的数据库中。该解决方案的问题是用户在发出“ls”时会看到时髦的命名方案。如果我可以将此主键存储在 st_ino 字段中，那么我可以唯一标识记录，而无需用户看到命名方案。所以我想这个问题的另一个解决方案是找到一种方法来改变 readdir 填充记录缓冲区的名称，以及 ls 打印到屏幕上的名称。但是，我不确定在不修改 FUSE 源的情况下是否可行。

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T06:42:24.237

我很久以前写了一些 FUSE 文件系统，这对我来说有点模糊。但是当我查看我的旧代码时，我发现 FUSE 允许一个 private_data 字段。您可以根据需要管理 private_data 中的信息。这应该提供一种将信息从 readdir 传输到 getattr 的机制，而不会污染文件名空间或为特定用途保留的任何其他数据成员。

# quickbooks - 为什么我在 Quickbooks SDK 中找不到使用其 RefNumber 的期刊？

> ID：15373131
> 
> 赞同：0
> 
> 时间：2013-03-12T22:04:15.133
> 
> 标签：quickbooks

我将其归结为一个使用 QB Enterprise 总是失败的简单示例。（奇怪的是，我可以发誓这段代码曾经可以工作。）

1.  通过 SDK 使用特定参考号“PTD1234”创建日记帐分录
2.  在同一代码块中搜索该特定日记帐分录
3.  观察，没有发现结果？

但是，如果我更改流程以在 QB 中手动创建相同的日记帐分录，则下面的搜索代码可以正常工作并找到日记帐分录。

```
 Quickbooks qb = new Quickbooks();
        qb.Connect(this);

        IMsgSetRequest msr = qb.sm.CreateMsgSetRequest("US", 7, 0);
        msr.Attributes.OnError = ENRqOnError.roeStop;

        IJournalEntryAdd jea = msr.AppendJournalEntryAddRq();

        jea.TxnDate.SetValue(new DateTime(2013, 3, 1));
        jea.RefNumber.SetValue("PTD1234");

        IJournalCreditLine jcl = jea.ORJournalLineList.Append().JournalCreditLine;
        jcl.Amount.SetValue(1);
        jcl.AccountRef.FullName.SetValue("Credit Card Batches:Paymentech");
        jcl.EntityRef.FullName.SetValue("CHASE PAYMENTECH");

        IJournalDebitLine jdl = jea.ORJournalLineList.Append().JournalDebitLine;
        jdl.Amount.SetValue(1);
        jdl.AccountRef.FullName.SetValue("Chase Deposits EUR");
        jdl.EntityRef.FullName.SetValue("CHASE PAYMENTECH");

        IMsgSetResponse msp = qb.sm.DoRequests(msr);
        IResponse resp = msp.ResponseList.GetAt(0);
        if (resp.StatusCode != 0)
        {
            Log("-------------\r\nError during test");
            Log(resp.StatusMessage);
        }

        IJournalEntryRet jet = null;

        msr = qb.sm.CreateMsgSetRequest("US", 7, 0);
        msr.Attributes.OnError = ENRqOnError.roeStop;

        IJournalEntryQuery q = msr.AppendJournalEntryQueryRq();
        q.metaData.SetValue(ENmetaData.mdNoMetaData);
        q.ORTxnQuery.TxnFilter.ORRefNumberFilter.RefNumberFilter.RefNumber.SetValue("PTD1234");
        q.ORTxnQuery.TxnFilter.ORRefNumberFilter.RefNumberFilter.MatchCriterion.SetValue(ENMatchCriterion.mcContains);
        q.ORTxnQuery.TxnFilter.AccountFilter.ORAccountFilter.FullNameList.Add("Chase Deposits EUR");
        q.IncludeLineItems.SetValue(false);

        msp = qb.sm.DoRequests(msr);
        if (msp.ResponseList.Count > 0)
        {
            IResponseList rl = msp.ResponseList;
            if (rl.Count >= 1)
            {
                IResponse r = rl.GetAt(0);
                if (r.Detail == null)
                    Log("Fail: Detail was null");

                if (r.StatusCode != 0)
                    Log("Fail: Status code was not zero");

                if (r.Type.GetValue() == (short)ENResponseType.rtJournalEntryQueryRs)
                {
                    IJournalEntryRetList crl = (IJournalEntryRetList)r.Detail;
                    if (crl != null && crl.Count == 1)
                        jet = crl.GetAt(0);
                }
            }
        }

        if (jet != null)
            Log("Success!");

        qb.Cleanup(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T02:37:05.913

由于未知原因，使用 JournalEntryQuery 和 TxnFilter.ORRefNumberFilter.RefNumberFilter 不会显示某些日记条目。但是，一种解决方法是使用 ORTxnQuery.RefNumberList，然后循环浏览日记帐行并确保帐户匹配。

```
 public bool GetExactJournalTransaction(string sRefNum, string sAccount, out IJournalEntryRet jet)
    {
        jet = null;

        IMsgSetRequest msr = sm.CreateMsgSetRequest("US", 4, 0);
        msr.Attributes.OnError = ENRqOnError.roeStop;

        IJournalEntryQuery q = msr.AppendJournalEntryQueryRq();
        q.metaData.SetValue(ENmetaData.mdNoMetaData);
        q.ORTxnQuery.RefNumberList.Add(sRefNum);
        q.IncludeLineItems.SetValue(true);

        IMsgSetResponse resp = sm.DoRequests(msr);
        if (resp.ResponseList.Count == 0)
            return false;

        IResponseList rl = resp.ResponseList;
        if (rl.Count == 1)
        {
            IResponse r = rl.GetAt(0);
            if (r.Detail == null)
                return false;

            if (r.StatusCode != 0)
                return false;

            if (r.Type.GetValue() == (short)ENResponseType.rtJournalEntryQueryRs)
            {
                IJournalEntryRetList crl = (IJournalEntryRetList)r.Detail;
                if (crl != null)
                {
                    for (int i = 0; i < crl.Count; i++)
                    {
                        jet = crl.GetAt(i);
                        for (int j = 0; j < jet.ORJournalLineList.Count; j++)
                        {
                            IORJournalLine l = jet.ORJournalLineList.GetAt(j);
                            if (l.JournalCreditLine != null && l.JournalCreditLine.AccountRef.FullName.GetValue() == sAccount)
                                return true;
                            else if (l.JournalDebitLine != null && l.JournalDebitLine.AccountRef.FullName.GetValue() == sAccount)
                                return true;
                        }
                    }
                }
            }
        }
        return false;
    } 
```

# django - Django 查询集错误

> ID：15373134
> 
> 赞同：0
> 
> 时间：2013-03-12T22:04:26.217
> 
> 标签：django, django-queryset

我在下面有一个简单的模块，并且在 Person 模块中有一个名为 following 的字段。

```
class Person(models.Model):
    user = models.ForeignKey(User)
    name = models.CharField(max_length=100)
    image = models.FileField(upload_to="images/",blank=True,null=True)
    following = models.ManyToManyField('self', related_name='followers', symmetrical=False, blank=True, null=True)
    def __unicode__(self):
         return self.name 
```

我创建了 3 个帐户，分别为 sarah、jim 和 ben。我设法让莎拉跟随吉姆和本，但是当我显示莎拉跟随谁时，它返回一个查询集而不是他们自己的对象。我怎样才能反向工作以将它们自己放入对象中，以便我可以将它们与我的 Person 模块相关联并显示 sarah 关注的人的姓名。

这是我不明白的部分

```
>>> from pet.models import *
>>> from django.contrib.auth.models import User
>>> sarah = User.objects.get(username='Sarah')
>>> jim = User.objects.get(username='Jim')
>>> ben = User.objects.get(username='Ben')
>>> Sarah = Person.objects.get(user=sarah)
>>> Jim = Person.objects.get(user=jim)
>>> Ben = Person.objects.get(user=ben)
>>> Sarah.following.add(Jim,Ben) //setup the many to many relationship
>>> Sarah.save()
>>> Sarah.following.all() // return a queryset of Person objects which john is following.
[<Person: Jim>, <Person: Ben>] 
```

我想返回用户在我的模板中关注的所有用户对象。

@SI 埃里克

```
>>> Sarah.following.all().values_list('name',flat=True)
[u'Jim', u'Ben']
>>> p =  Sarah.following.all().values_list('name',flat=True)
>>> person = Person.objects.filter(user=p)
>>> print person

class Board(models.Model):
    user = models.ForeignKey(User)
    name = models.CharField(max_length=100)
    def __unicode__(self):
        return self.name 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:13:57.707

```
Sarah.following.all().values_list('name', flat=True) 
```

会输出

```
['Jim', 'Ben'] 
```

正如 bernie 建议的那样，您可以设置**unicode**函数，返回的默认查询集也会这样做。在这种特殊类型的实例中，我更喜欢更明确地说明我从对象中得到的东西，但这只是我。

**问题更新后编辑：**

我不确定我是否遵循您要执行的操作。您有一个跟踪莎拉的人的对象的查询集。如果您只想要名称，上面的值列表将起作用。如果您想遍历每个单独的对象，那么您将执行以下操作：

```
for person in Sarah.following.all():
    # person is an instance of Person
    # you can access all the properties of the object by accessing person
    print person.name 
```

或者，通过将整个查询集添加到视图中的上下文，将整个查询集传递给模板：

```
context['following'] = Sarah.following.all() 
```

然后在模板中你可以这样做（例如）：

```
<ul>
    {% for person in following %}
        <li>{{ person.name }}</li>
    {% endfor %}
</ul> 
```

**编辑：** 从模板和视图代码中，您都可以通过直接引用它们来访问每个“Person”对象的任何属性。因此，例如，如果您想访问与人有外键关系的“用户”对象的属性，您只需直接访问它的属性，如下所示：

```
person.user.username
person.user.email
etc... 
```

**最后一个编辑：** 要基于一个人的“以下”查询集获取“用户”对象的查询集，您可以这样做：

```
users = User.objects.filter(pk__in=Sarah.following.all().values_list('user__pk', flat=True) 
```

从那里您应该可以使用该过滤板和其他引用 User 模型的对象：

```
boards = Board.objects.filter(user__in=users) 
```

# security - HTTPS 是否可以防止有效用户篡改负载？

> ID：15373136
> 
> 赞同：1
> 
> 时间：2013-03-12T22:04:33.063
> 
> 标签：security

我们有 2 个 Web 应用程序，均使用 HTTPS（仅限服务器端证书）和单点登录身份验证系统进行保护。在 App1 中，用户将单击一个链接，然后需要“向下钻取”到 App2 中的页面。它们共享相同的域和 SSL 证书，但在物理上不是同一个应用程序。当 App1 将请求转发或重定向到 App2 时，它会在请求中包含一个身份验证令牌，以便 App2 可以验证用户的身份。

App1知道用户有权查看哪些信息，称之为账户列表；App2 无权访问此信息（至少目前没有）。已经建议 App1 也可以在请求中将授权帐户列表传递给 App2。

我的问题是 HTTPS 是否保护有效负载并保证它仅由 App1/App2 服务器生成？更具体地说，我担心的是具有有效身份验证令牌的有效用户是否能够使用其他帐户构建自己的表单并将其作为有效的 HTTPS POST 请求提交给 App2 服务器，从而访问未经授权的帐户？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T00:45:09.417

不，仅 HTTPS 并不能为您提供所需的安全性。有关其他人如何解决您面临的问题的指示，请查看此链接：

[使用 SAML 的 SSO](http://help.sap.com/saphelp_nw73/helpdata/en/47/feefe5ed7045458d2886a68bbb46f1/frameset.htm)

它是关于使用 SAML 协议完成 SSO。一般来说，如果安全是您的一个严重问题，您将希望使用经过同行评审的解决方案（如 SAML）而不是 DIY 方法来进行单点登录。您不需要使用 SAML，但您应该尝试使用适用于您的环境的现有 SSO 解决方案。

为了“保证它是由 App1/App2 服务器生成的”——您*可以*对有效负载进行数字签名。这将防止篡改，但可能无法防止[重放攻击](http://en.wikipedia.org/wiki/Replay_attack)——SSL 会对此有所帮助，因为传输将被加密，但重放攻击仍然可能（通过[中间人攻击](https://www.owasp.org/index.php/Man-in-the-middle_attack)）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-18T12:40:47.227

HTTPS 提供了一个安全的通信通道。但是您可以与魔鬼本人进行安全通信:-)

# jquery - 未捕获的类型错误：无法调用未定义 jquery.validate.min.js:29 的方法“调用”

> ID：15373142
> 
> 赞同：2
> 
> 时间：2013-03-12T22:05:04.833
> 
> 标签：jquery, jquery-mobile, jquery-plugins

当我使用以下代码时，我收到“Uncaught TypeError: Cannot call method 'call' of undefined jquery.validate.min.js:29”，相同的代码在“jquery-1.8.2.js”中工作，但它在“jquery-190.js”中不起作用，如果我从验证中删除“require_from_group：[1，”.customer-identifier”]，它的工作。

```
$(document).on( 'pageinit', '#contact-us-page', function(event){

    var $currentPage = $(event.target);
    var $form = $currentPage.find("form#customer-identifier");
    var validator_contactuspage = $form.validate({  
    rules: {            
            account_number: {require_from_group: [1,".customer-identifier"], digits: true, maxlength: 10, minlength: 10},
            phone_number: {require_from_group: [1,".customer-identifier"], phoneUS: true}
        },
        messages: {
            account_number: {
                maxlength: "Please enter exactly 10 digits.",
                minlength: "Please enter exactly 10 digits."
            }
        },
    highlight: function(element, errorClass) {
            $(element).removeClass("valid");
            $(element).addClass("error");
        },
        success: function(element, validClass) {
            $(element).removeClass("error");
            $(element).addClass("valid");

        },
        submitHandler: function(form){          
            getAddress();
            return false;
        }
    });

    $form.find("input[name=account_number]").bind("keyup change blur", function(event){
        if(checkNull($(this).val()).length > 0){
            $form.find("input[name=phone_number]").attr("disabled", "disabled");
        }
        else{
            $form.find("input[name=phone_number]").removeAttr("disabled");
        }
    });

    $form.find("input[name=phone_number]").bind("keyup change blur", function(event){
        if(checkNull(stripAlpha($(this).val())).length > 0){
            $form.find("input[name=account_number]").attr("disabled", "disabled");
        }
        else{
            $form.find("input[name=account_number]").removeAttr("disabled");
        }
    });
}); 
```

编辑：我在 JSFiddle 上添加了我的代码，如果有人想试一试的话。 [http://jsfiddle.net/D65WY/36/](http://jsfiddle.net/D65WY/36/)

有什么想法吗？

# asp.net-mvc-3 - 等待操作超时，sqlexception Timeout过期

> ID：15373143
> 
> 赞同：2
> 
> 时间：2013-03-12T22:05:09.963
> 
> 标签：asp.net-mvc-3, azure-sql-database

我在实时服务器上的 sql azure 数据库有奇怪的问题。MVC 控制器返回错误为“等待操作超时”和 Sqlexpection (0x80131904)：超时过期”。

这尤其发生在单个 sql 存储过程上。该程序是，如果使用 SMSS 2012 对数据库运行具有相同参数的存储过程，它将运行良好并在 2 秒内返回返回值。

这让我知道我的存储过程没有任何问题。

我正在调用存储过程，如下所示。

```
List<FileFolderItem> folders = new List<FileFolderItem>();

using (DFModel db = new DFModel())
{
    folders.AddRange(
        db.GetFolderStructure(companyId, (clientid ?? companyId), folderId, currentUser.df_userId).Select(x => new FileFolderItem
        {
            Name = x.name,
            Id = x.id,
            Flags = "USER_FOLDER",
            TotalFiles = x.Files.Value,
            TotalSize = x.Size.Value
        }).ToList<FileFolderItem>()
    );

    return folders;
} 
```

我已经通过备份数据库并在与单独的新数据库相同的 sql azure 实例上恢复并将我的应用程序连接指向备份数据库和应用程序工作进行了进一步测试。

我不明白我应该如何解决这个问题，没有办法重新启动 sql azure 实例。

任何帮助将不胜感激。

谢谢

![在此处输入图像描述](../Images/0e7f8e041a424d0c7134f42898d164b3.png)

于 2013 年 3 月 13 日编辑

经过进一步调查 - 问题似乎与从子过程 GetFolderTotalSize 调用的表值函数（getfilesbyclaims）有关。是不是这个功能不完全支持。奇怪的是，该应用程序确实在大约 4 周前上线，而这个问题突然在昨天下午 4 点开始出现。

```
CREATE PROCEDURE [dbo].[GetFolderStructure]
    @companyid int, 
    @clientid int, 
    @folderid int, 
    @personid int
AS
SELECT 
        fd.id, 
        fd.name,        
        dbo.getfoldertotalfiles(@companyid, @clientid, fd.id, @personid) AS Files,
        --0 as Files,
        dbo.getfoldertotalsize(@companyid, @clientid, fd.id, @personid) as Size
        --0 as Size
FROM folders fd
WHERE fd.companyid = @companyid
AND fd.root_id = @folderid
AND (fd.hidden IS NULL OR fd.hidden = 0) 
```

子程序 - GetFolderTotalFiles

```
ALTER FUNCTION [dbo].[GetFolderTotalSize]
(
    @companyid int, 
    @clientid int, 
    @folderid int,
    @personid int
)
RETURNS INT
AS
BEGIN
    DECLARE @size int;

    DECLARE @tblFiles TABLE (
        Id uniqueidentifier not null,
        CompanyId int,
        folderid int,
        contentLength bigint    
    );

    INSERT INTO @tblFiles(id, companyid, folderid, contentlength)
    SELECT * FROM dbo.getfilesbyclaims(@clientid, @personid);

    WITH Folder_CTE as (
    select fs.* FROM folders AS fs
    where companyid = @companyid
    AND id = @folderid
    UNION ALL
    SELECT f.* FROM folders f
    INNER JOIN Folder_CTE fcte ON fcte.id = f.root_id)

    SELECT @size = ISNULL(SUM(f.contentlength), 0) FROM folder_cte fd
    INNER JOIN @tblFiles f ON f.folderid = fd.id
    where f.companyid = @clientid

    return @size;
END

GO 
```

# html - 使显示表格单元格使用百分比宽度

> ID：15373147
> 
> 赞同：40
> 
> 时间：2013-03-12T22:05:29.200
> 
> 标签：html, css

[小提琴](http://jsfiddle.net/qy7ad/)

使用无序列表，我感觉这张桌子正在运行。但我不知道如何让表格单元格有 50% 的宽度（我希望每一行都是 100% 的宽度）。我使用`display: table-row;`and的原因`display: table-cell;`是，如果参数文本超过一行，我可以垂直对齐数据。我不想使用实际的像素或 em 值作为宽度，因为，如果可能的话，我只希望它以百分比表示。我宁愿放弃垂直对齐。请不要使用javascript。谢谢！

HTML：

```
<div class="group group2">
    <h2>Health Indicies</h2>
    <ul>
        <li><p class="parameter">GGP</p><p class="data">265</p></li>
        <li><p class="parameter">Comfort</p><p class="data">blah</p></li>
        <li><p class="parameter">Energy</p><p class="data">gooo</p></li>
    </ul>
</div> 
```

CSS：

```
ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.group {
    width: 50%;
    margin-bottom: 20px;
    outline: 1px solid black;
    background: white;
    box-shadow: 1px 1px 5px 0px gray;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
.group h2 {
    display: block;
    font-size: 14px;
    background: gray;
    text-align: center;
    padding: 5px;
}
.group li {
    clear: both;
}
.group p {
    padding: 3%;
    text-align: center;
    font-size: 14px;
}
.group2 li {
    display: table-row;
}
.group2 p {
    display: table-cell;
    vertical-align: middle;
    width: 46%;
    border-bottom: 2px solid gray;
}
.group li:last-child p {
    border-bottom: 0;
} 
```

* * *

## 回答 #1

> 赞同：49
> 
> 时间：2013-03-12T22:11:10.387

您快到了。您只需将`display: table`和添加`width: 100%`到您的`ul.group2`. 您也可以不提供 a `width`on 您的`.group2 p`元素而侥幸逃脱。

这应该工作：http: [//jsfiddle.net/6Kn88/2/](http://jsfiddle.net/6Kn88/2/)

```
ul {
    margin: 0;
    padding: 0;
    list-style: none;
}
.group {
    width: 50%;
    margin-bottom: 20px;
    outline: 1px solid black;
    background: white;
    box-shadow: 1px 1px 5px 0px gray;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
}
.group h2 {
    display: block;
    font-size: 14px;
    background: gray;
    text-align: center;
    padding: 5px;
}
.group li {
    clear: both;
}
.group p {
    padding: 3%;
    text-align: center;
    font-size: 14px;
}
.group2 ul {
    display: table;
    width: 100%;
}
.group2 li {
    display: table-row;
}
.group2 p {
    display: table-cell;
    vertical-align: middle;
    width: 46%;
    border-bottom: 2px solid gray;
}
.group li:last-child p {
    border-bottom: 0;
}
```

```
<div class="group group2">
    <h2>Health Indicies</h2>
    <ul>
        <li><p class="parameter">GGP</p><p class="data">265</p></li>
        <li><p class="parameter">Comfort</p><p class="data">blah</p></li>
        <li><p class="parameter">Energy</p><p class="data">gooo</p></li>
    </ul>
    <span class="clear"></span>
</div>
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-12T22:11:44.957

根据 CSS 的其余部分设置`ul`为`display: table`，并为其设置 100% 的宽度以填充父 div。现在你的宽度应该占据你的“行”和“单元格”。

编辑：根据上面的 kpeaatt，谁跑得更快！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-01-13T09:51:39.793

我找到了从引导源代码中设置表格单元格 100% 宽度的最佳方法。

设置`width:10000px`，它呈现为 100% 宽度。

> [https://jsfiddle.net/y3qsxb9m/](https://jsfiddle.net/y3qsxb9m/)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-14T11:25:34.833

使用以下内容：

```
 display:table-cell;
  width: 100vw; 
```

* * *

## 回答 #5

> 赞同：-8
> 
> 时间：2016-04-13T21:24:42.490

为了

```
display: table-cell; 
```

环境

```
width:10000px; 
```

充当

```
width:100%; 
```

所以，如果你想要 50% 的宽度，只需使用

```
width: 5000px; 
```

# oop - 指向 Fortran 中指针的 Class() 指针：奇怪的行为

> ID：15373151
> 
> 赞同：0
> 
> 时间：2013-03-12T22:05:42.097
> 
> 标签：oop, pointers, fortran, derived-types

我已经很好地浏览了以前的帖子，我认为这个话题已经被覆盖了，希望有人能提供帮助。我正在用 fortran 2003 编写代码，并使用 ifort。我有以下需要操作的类型，我设计了这些类型以提供所需的灵活性：

```
module parameters    

double precision, target :: cur_x(3)    

    type fundamental
            double precision, pointer   ::  x => null()
    end type fundamental

    type, extends(fundamental) :: ion
            class(fundamental), pointer ::  core => null()
     end type ion

SAVE
end module parameters 
```

这个想法是我通过使用列表中的前一个作为下一个的核心来构建一种粒子链表。请注意，实际上我会对“基本”进行大量扩展，所有这些都可以成为其他粒子的“核心”。我希望计算的数量 x 一起在物理内存中的一个数组中，因为我将以相当复杂的方式寻址它们的子集，为此我想使用另一组指向 cur_x 的指针

代码的初始化是这样的，我在其中添加了一些诊断行：

```
use parameters

    type(fundamental), target :: electron, proton
            type(ion), target :: hydrogen

    write(*,*)associated(electron%x),associated(proton%x), &
                   & associated(hydrogen%core),associated(hydrogen%core%x)

        electron%x => cur_x(1)

        hydrogen%core => proton
        proton%x => cur_x(2)
        hydrogen%x => cur_x(3)

        cur_x = 1.0

    write(*,*)electron%x,proton%x,hydrogen%x,hydrogen%core%x 
```

哪个打印

```
F F F T
1.0 1.0 1.0 <garbage> 
```

我希望质子%x 和氢%core%x 是内存中的相同地址（cur_x(2)）。**所以我有两个问题**

1.  我已将所有指针初始化为空。为什么 associated(hydrogen%core%x) 给出真实的？如果我尝试在代码顶部取消这个指针，我会得到不一致的结果；使用

    ```
    nullify(hydrogen%core%x) 
    ```

    导致分段错误。表演

    ```
    hydrogen%core%x => null() 
    ```

    允许代码运行，但 associated(hydrogen%core%x) 保持为真

2.  我已确保将指针列表从父级关联到子级，正如[本 fortran 中令人惊讶的错误摘要中](http://www.cs.rpi.edu/~szymansk/OOF90/bugs.html)所建议的那样。proton%x 工作但hydro%core%x 产生垃圾的事实是我不明白的。

我可以解决这个问题，但这会牺牲我进行更复杂计算所需的一般性。我也很想了解这里出了什么问题。

谢谢你的帮助！吉姆

编辑：为各种事物添加了“目标”属性；请注意，这总是在代码中，我只是在转移到这篇文章时忘记了它们

**编辑：澄清一下，我对上述代码的主要问题是最终的写入命令为hydro%core%x 提供了未初始化的输出，即使在第一次写入后遵循关联命令也是如此。尽管我在类型定义中将 core 初始化为 null，但它似乎存在问题；如果我尝试在代码顶部取消它，程序就会崩溃。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:51:44.017

基本问题是`hydrogen%core`没有关联。因此， 的影响`associated(hydrogen%core%x)`是不确定的。您不能访问/查询`x`派生类型指针 ( ) 的字段 ( `hydrogen%core`)，如果指针未关联，例如指向`null()`而不是内存中现有的派生类型实例。您的编译器可能会生成一个代码，当您尝试它时不会立即崩溃，但之后所做的任何事情都是不确定的，因为您可能已经覆盖了随机内存地址的一些数据。

实际上，我使用各种编译器编译了您的代码的自包含版本（见下文），并且在第一个 write 语句时立即出现了段错误。使用适当的检查选项，其中一个二进制文件甚至会报告原因是在引用未关联的指针`hydrogen%core`。如果您注释掉有问题的`associated()`查询（如下面的代码），所有二进制文件都可以正常运行。

另外，请注意，变量`electron`和`proton`必须具有目标属性，否则代码根本不应该编译。如果您的编译器编译代码时没有抱怨，您可能应该考虑更改为另一个。

```
 module parameters    
  implicit none
  save

  type :: fundamental
    double precision, pointer ::  x => null()
  end type fundamental

  type, extends(fundamental) :: ion
    class(fundamental), pointer ::  core => null()
  end type ion

end module parameters

program test
  use parameters
  implicit none

  type(fundamental), target :: electron, proton
  type(ion) :: hydrogen
  double precision, target :: cur_x(3)

  ! If you remove the comment in the next statement, the program will be indeterministic
  ! and probably crash.
  write(*,*) associated(electron%x),associated(proton%x), &
      & associated(hydrogen%core)!, associated(hydrogen%core%x)

  electron%x => cur_x(1)
  hydrogen%core => proton
  proton%x => cur_x(2)
  hydrogen%x => cur_x(3)
  cur_x(:) = 1.0
  write(*,*)electron%x,proton%x,hydrogen%x,hydrogen%core%x

end program test 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:52:48.203

1.  如果`hydrogen%core`没有关联，那么`hydrogen%core%x`在第一个 write 语句中引用（或定义）是一个编程错误。出现该编程错误后，任何事情都会从那时开始。

2.  您没有说您使用的是哪个版本的 ifort，但存在与多态指针有关的编译器错误（如果我记得英特尔论坛上最近的帖子，我认为这些错误已经存在）。

除此之外，为了`hydrogen%core`指向局部`proton`变量，质子必须具有 TARGET 属性。我希望编译器能够诊断这一点。

# sql - 是否可以以 TO_CHAR(datetime) 格式插入文字字符？

> ID：15373153
> 
> 赞同：5
> 
> 时间：2013-03-12T22:05:49.817
> 
> 标签：sql, oracle, plsql

我想选择一些格式的日期：

```
yyyydDOY 
```

其中`yyyy`是 4 位数的年份，`DOY`是一年中的第几天 (1-366)，并且`d`是文字“d”。这是我尝试过的：

```
SQL> select to_char(sysdate, 'YYYYdDDD') from dual;

TO_CHAR(
--------
20130713 
```

显然这都是错误的。我想要的结果可以在命令行中找到：

```
$ date +'%Yd%j'
2013d071 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-03-12T22:05:49.817

首先，问题中的代码读作`DDDD`，函数将其解释为`DDD`（一年中的一天：071），然后是`D`（一周中的一天：3）。

解决方案是用双引号 ( `"`) 引用任何文字：

```
SQL> select to_char(sysdate, 'YYYY"d"DDD') from dual;

TO_CHAR(
--------
2013d071 
```

有关详细信息，请参阅[*表 3-15 日期时间格式元素*](http://docs.oracle.com/cd/E14072_01/server.112/e10592/sql_elements004.htm#CDEHIFJA)。

# asp.net-mvc - 具有模型列表的模型的 MVC 客户端验证

> ID：15373158
> 
> 赞同：0
> 
> 时间：2013-03-12T22:06:07.157
> 
> 标签：asp.net-mvc

我有这个模型，其中包含另一个模型的列表。然后在我看来，我的表单填写了我的主要模型的几个字段。但我希望这个表单也能够添加其他类型的 X 模型并全部连接起来，我想知道如何正确地做到这一点。

所以这是我的两个模型：

```
public class MyMainModel
{

    public int MyMainId { get; set; }

    [Required(ErrorMessage = "Groovy name required")]
    [Display(Name = "MyMainModel's groovy name:")]
    public string Name { get; set; }

    public List<MySubModel> MySubModels { get; set; }

}

public class MySubModel
{

    public int MySubId { get; set; }

    [Required(ErrorMessage = "Cool name required")]
    [Display(Name = "MySubModel's cool name:")]
    public string Name { get; set; }

} 
```

当我为我的“创建”视图点击我的控制器时，我会执行以下操作：

```
public ActionResult SomePageAboutCreating()
{
    // [...] Some other stuff
    return View(new MyMainModel());
} 
```

现在这发送到我的强类型视图：

```
@model myFunProject.WebModels.MyMainModel

<div>
    <form id="my-create-form" onsubmit="CreateMyMainModel(this); return false;">
        @Html.AntiForgeryToken()
        @Html.ValidationSummary()

        <div class="result" style="background-color: silver;">This is the operation result box</div>
        <img class="loading" src="/Images/ajax-loader.gif" alt="Loading..." width="16" height="16" style="display: none;" />

        <section>
            @Html.LabelFor(m => m.Name)
            @Html.TextBoxFor(m => m.Name)
            @Html.ValidationMessageFor(m => m.Name)
        </section>

        <!-- Here begins the fields for my list of "MySubModel" -->
        @Html.EditorFor(x => x.MySubModels)

        <!-- Here I'm thinking about a javascript that will add the previous fields X times so that the user can create "MyMainModel" as well as x times "MySubModel"... -->

        <input type="submit" class="btn-send" id="my-create-form-submit" value="Send" />
    </form>
</div> 
```

所以我想我必须在这里使用 EditorTemplates ......所以我在我的 /Views/EditorTemplates/MySubModels.cshtml 中设置（根据我的“MyMainModel”的属性命名），然后当我在那里写我的表格时，我使困惑...

```
@model myFunProject.WebModels.MyMainModel

@*<section>
    @Html.LabelFor(m => m.Name)
    @Html.TextBoxFor(m => m.Name)
    @Html.ValidationMessageFor(m => m.Name)
</section>*@ 
```

所以在这里我不确定在这里放什么......我希望我的 Name 属性是“MySubModel”之一。当用户看到这个表单时，比如说他将经历这个场景：

1.  输入“MyMainModel”的名称。
2.  转到另一个名称框并填写“MySubModel.
3.  然后他会单击一个特殊按钮，该按钮将操纵 dom 以附加另一个 MySubModel.Name 字段。
4.  他会写第二个“MySubModel”名字。
5.  他会点击提交。

我放在那里的ajax调用我可以进行接线，但是我的困惑来自我必须为编辑器模板编写的代码，然后我有点想知道我将如何创建一个新的字段（例如，对于第二个“MySubModel”......）。

任何帮助将不胜感激，我已经阅读了许多有关与此相关的主题的文章，但尚未找到此案例。谢谢！

编辑：

我将添加提交表单时由我的 ajax 调用的操作（一个过于简化的版本呵呵）。

```
public ActionResult CreateMyMainModel(MyMainModel myMainModel) {

    // [...] Do stuff like save to database...
    // var aGroovyNAme = myMainModel.Name;

    foreach(var mySubModel in myMainModel.MySubModels) {
        // Here I would have the sub models available to manipulate...
        // var aCoolName = mySubModel.Name;
    }
    return Content("ok");

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:07:48.243

> 我已经浏览了许多有关与此相关的主题的文章，但尚未找到此案例。

我真的建议您阅读[`editing a variable length list`](http://blog.stevensanderson.com/2010/01/28/editing-a-variable-length-list-aspnet-mvc-2-style/)Steven Sanderson 的文章，该文章说明了处理这种情况的一种非常好的方法。他提出了一个自定义`Html.BeginCollectionItem`助手，可用于为输入字段名称生成非顺序索引（guid），从而允许轻松动态地删除元素，而不会在索引中留下*漏洞。*当用户决定添加另一个项目时，将对控制器操作进行 AJAX 调用，该操作仅返回一个空模板（部分）。

您也可以仅在客户端仅使用 javascript 执行此操作。Steven Sanderson 在[`this similar article`](http://blog.stevensanderson.com/2010/07/12/editing-a-variable-length-list-knockout-style/).

这两篇文章确实是在 ASP.NET MVC 中动态编辑可变长度项目列表的最佳方法。阅读它们确实有助于更好地理解 ASP.NET MVC 中模型绑定中的一些核心概念。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-08-04T20:30:47.400

我最近在另一个线程上几乎回答了这个确切的问题：

[ASP.Net MVC4 将“创建视图”绑定到包含列表的模型](https://stackoverflow.com/questions/12974957/asp-net-mvc4-bind-a-create-view-to-a-model-that-contains-list/24975057#24975057)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T23:46:45.540

我在一个项目中遇到了类似的问题，我想在某些情况下而不是在其他情况下验证某些字段（即在保存时不验证，但在提交时验证所有内容。

我最终在 javascript 中手动完成所有操作并回发一个 json 对象。

经过反思，我宁愿操纵验证 javascript 文件 (MicrosoftMVCValidation.js)。

对于模型绑定问题，我建议查看自定义模型绑定。

我发现使用 EditorTemplates 有点繁琐，尤其是部分视图。

我发现 asp.net mvc 3 在模型绑定方面有点弱。我希望一些问题能在 mvc 4 中得到解决，但从我目前所看到的情况来看，MVC4 主要是用于创建 Windows Phone 应用程序的升级。

这是模型中十进制属性的自定义模型绑定器的示例。

您可以对自己的自定义模型使用相同的逻辑。

我发现有时我想将模型与大页面上的实体集合绑定，而不仅仅是绑定基本的属性集合。

```
public class DecimalModelBinder : DefaultModelBinder
{
    public override object BindModel(ControllerContext controllerContext, ModelBindingContext bindingContext)
    {
        var valueProviderResult = bindingContext.ValueProvider.GetValue(bindingContext.ModelName);

        //return valueProviderResult == null ? base.BindModel(controllerContext, bindingContext) : Convert.ToDecimal(valueProviderResult.AttemptedValue);

       if (valueProviderResult == null)
           return base.BindModel(controllerContext, bindingContext);
       else if (valueProviderResult.AttemptedValue == "")
           return base.BindModel(controllerContext, bindingContext);
       else
           return Convert.ToDecimal(valueProviderResult.AttemptedValue);

    }
} 
```

# php - php：表单定价错误

> ID：15373161
> 
> 赞同：-2
> 
> 时间：2013-03-12T22:06:22.707
> 
> 标签：php, html, forms, scripting

如您所见，我正在尝试创建一个在 php 部分中输出价格的简单表单。但我得到这些错误

**注意：** `Undefined variable: result in /var/www/vhosts/numyspace.co.uk/web_users/home/~unn_w12024193/public_html/test/example2.php on line 3`

**注意：** `Undefined index: booking in /var/www/vhosts/numyspace.co.uk/web_users/home/~unn_w12024193/public_html/test/example2.php on line 4`

**警告：** `Division by zero in /var/www/vhosts/numyspace.co.uk/web_users/home/~unn_w12024193/public_html/test/example2.php on line 4`

总成本为： **注意：** `Undefined variable: result in /var/www/vhosts/numyspace.co.uk/web_users/home/~unn_w12024193/public_html/test/example2.php on line 18` 不含增值税。总成本包括增值税。

HTML

```
<form method="post" action="example2.php">
<select name="booking">
<option value="Double Room">Double Room £50</option>
<option value="Twin Room">Twin Room £70</option>
<option value="Family Room">Family Room £100</option>
</select>

<select name="service">
 <option value="10">Yes £10</option>
 <option value="0">No</option>
</select>

<input type="submit" value="submit" action="example2.php" name="submit"><br />
</form> 
```

PHP

```
$vresult = $result * 20%
$booking = $_GET["booking"];

if ($booking == "Double Room"){
$result = 50 + $_GET["service"];
}
else if($booking == "Twin Room"){
$result = 50 + $_GET["service"];
}
else if($booking == "Family Room"){
$result = 100 + $_GET["service"];
}
?>
 Total cost is <?php echo $result;?> exculding VAT.

 Total cost is <?php echo $vresult; ?> including VAT. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:10:19.827

这是错误的：

```
$vresult = $result * 20% 
```

该`%`字符是[模运算符](http://www.php.net/manual/en/language.operators.arithmetic.php)，因为您没有使用第二个参数，也没有使用`;`导致各种错误的终止，因为 php 将您的行视为：

```
$vresult = $result * 20 % $booking = $_GET["booking"];
                                     ^^^^^^^^^^^^^^^^ undefined (see below)
                          ^^^^^^^^ NULL leads to division by zero 
```

你可能想要：

```
$vresult = $result * 0.2; 
```

而且您的表单方法是`POST`您发布的变量将位于`$_POST`数组中。

**编辑：**包含 20% 的价格当然是`1.2 * $result`，您在计算价格**后**计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:11:06.410

**首先：** vresult 应该在你定义 $result 之后，并用 * 1.2 而不是 * 20% 计算额外的 20%； **第二：**你需要使用$_POST而不是$_GET
**第三：** $_ POST['service']可以改变，输出前检查一下

```
$booking = @$_POST["booking"];
$service = @$_POST["service"] == 10? 10 : 0;

if ($booking == "Double Room"){
   $result = 50 + $service;
}
else if($booking == "Twin Room"){
   $result = 50 + $service;
}
else if($booking == "Family Room"){
   $result = 100 + $service;
}
$vresult = $result * 1.2;
?>
 Total cost is <?php echo $result;?> exculding VAT.

 Total cost is <?php echo $vresult; ?> including VAT. 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:12:04.380

在我看来，您需要移动计算增值税的行

```
$vresult = $result * 20% 
```

在您实际计算之后`$result`- 所以就在您关闭 PHP 脚本之前。你需要把它写成

```
$vresult = $result * 0.2; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:09:38.977

`$result`没有定义。我引用 php: 的第一行`$vresult = $result * 20%`。如果您尝试`$result`根据预订类型进行设置，则需要将注释行移到设置代码下方`$result`

您的表单方法也是`POST`如此，您需要使用`$_POST['booking']`

`;`您在 php 的第一行之后还缺少一个

* * *

## 回答 #5

> 赞同：-2
> 
> 时间：2013-03-12T22:11:08.130

当您第一次打开文件时，没有提交任何表单，也没有定义这些变量。在定义它们之前，您需要使用 isset() 函数。

# python - Python/Beautiful Soup – 在 div 的标题中查找字符串

> ID：15373163
> 
> 赞同：1
> 
> 时间：2013-03-12T22:06:23.973
> 
> 标签：python, beautifulsoup

作为 Python 新手，我花了大约一个小时试图从 div 内的标题中找到一个带有 Python 2.7.x 和 Beautiful Soup 的字符串：

```
import urllib2
from bs4 import BeautifulSoup

request = urllib2.Request("http://somerandomurl.org")
response = urllib2.urlopen(request)
soup = BeautifulSoup(response) 
```

HTML 文件如下所示：

```
<div class="ABC">
    <h1>My string</h1>
</div> 
```

我无法描述我在这里尝试的[Beautiful Soup Documentation](http://www.crummy.com/software/BeautifulSoup/bs4/doc/)`print soup.div('ABC').h1`的所有方式（包括……），但我认为我在阅读时遇到了严重的错误。谢谢你的帮助。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:09:25.733

你自找的：

```
soup.find('div', class_='ABC').h1 
```

它将找到该类的*第一个* `div`标签`ABC`，然后遍历其中的第一个 H1 标签：

```
>>> from bs4 import BeautifulSoup
>>> soup = BeautifulSoup('''
... <div class="ABC">
...     <h1>My string</h1>
... </div>
... ''')
>>> soup.find('div', class_='ABC').h1
<h1>My string</h1> 
```

# excel - 将嵌套元胞数组写入 Excel 文件

> ID：15373171
> 
> 赞同：0
> 
> 时间：2013-03-12T22:07:24.127
> 
> 标签：excel, matlab, cell-array

我有一个带有嵌套单元格的变量：

```
hello =   
    '8'     {1x3 cell}    {1x3 cell}
    '22'    {1x3 cell}    {1x3 cell}
    '97'    {1x3 cell}    {1x3 cell} 
```

如何使用 MATLAB 将其写入单个 Excel 文件，*例如* `xlswrite('file',hello)`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T11:33:42.523

只是看了一会儿。这是我对示例问题的解决方案。

清除所有；cl ;

d = {{'Number'},{'Class A'},{'class B'};{'007'},{'Test One'},{'Test Two'}};

对于 i = 1：大小（d，1）

```
for j = 1:size(d,2)

    if iscell(d(i,j))

        d(i,j) = d{i,j};

    end
end 
```

结尾

xlswrite('文件地址',d);

# ruby-on-rails - 如何找到应该设置模型中的哪些字段？

> ID：15373174
> 
> 赞同：0
> 
> 时间：2013-03-12T22:07:34.437
> 
> 标签：ruby-on-rails, scaffolding

我有一个 RoR 应用程序，脚手架生成为我的模型提供了新的和编辑操作。在视图中，有一个 _form.html.erb。此表单具有两个字段的输入，这两个字段也恰好是 attr_accessible，但没有输入字段如`created_at`,`updated_at`和`id`。

我想为我的所有模型生成一些自定义的其他表单和视图。我想知道如何以编程方式找到应该手动设置的字段，以及 Rails 设置的字段。如果我有一个模型 Widget，那么 Widget.columns 会给出所有字段。

Rails 脚手架生成如何知道将哪些字段放入表单中。此外，是否有代码确定如何设置“created_at”和“updated_at”？或者这是由数据库完成的？

**更新**：为了澄清，我想具体做一些事情：

1.  我正在生成用于上传大量行/实体的表单。所以我需要知道表单中要包含哪些字段。是否总是`Widget.accessible_atributes`要手动设置字段？

2.  我需要知道要自动包含哪些字段。如果我使用模型的新方法，`created_at`，`updated_at`， 和`id`会自动设置。我想在表中加载 1000 行我会执行类似 SQL 加载文件命令的操作，我想我需要设置 created_at 和 updated_at 但不是 id。我怎么知道要设置哪些字段。我正在寻找一些假设的方法，例如

    ```
    >> Widget.auto_columns
    # returns {:created_at => '04/12/2013 9:29pm', :updated_at => '04/12/2013'} 
    ```

**更新 2**：试图看看脚手架是如何完成的，我看到在[gems/railties/lib/rails/generators/erb/scaffold/templates/_form.html.erb](https://github.com/rails/rails/blob/22ed6cb798b476f63e5d5b84cb28e054c4f1870e/railties/lib/rails/generators/erb/scaffold/templates/_form.html.erb#L14)中，代码使用了类似于属性数组的东西，它只包含显示在表格中。

```
<% attributes.each do |attribute| -%>
  <div class="field">
    <%%= f.label :<%= attribute.name %> %><br />
    <%%= f.<%= attribute.field_type %> :<%= attribute.name %> %>
  </div>
<% end -%>
  <div class="actions">
    <%%= f.submit %>
  </div>
<%% end %> 
```

我认为属性数组是在[支架](https://github.com/rails/rails/blob/67ee6c38b9b112eabe37d5869c23210b9ebf453c/railties/lib/rails/generators/erb/scaffold/scaffold_generator.rb#L9)_generator.rb 中使用 thor 的参数方法生成的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:14:21.207

> Rails 脚手架生成如何知道将哪些字段放入表单中。

生成脚手架时，您可以像这样生成它::

```
rails generate scaffold TableName attribute:type_of_attribute attribute2:type_of_attribute 
```

您可以根据需要连接任意数量的属性。

> 此外，是否有代码确定如何设置“created_at”和“updated_at”？或者这是由数据库完成的？

时间戳 ( `created_at`, `updated_at`) 和`id`由 Rails 自动设置。

它们将始终添加到您的数据库中（除非您想手动删除迁移文件中的时间戳，但`id`将始终保留）。

您还可以在模型（表）中设置一些将自动生成的字段，但您必须为此编写代码。

关于可访问属性，虽然我不知道它的用途：

```
Photo.accessible_attributes.each { | attribute | puts attribute if attribute.length > 0 } 
```

出于某种原因，它给了我第一个值“”，所以我就这样逃脱了它。还有更多关于属性和可访问性和计数列：

[检索 Rails 模型列名称](https://stackoverflow.com/questions/5301111/retrieving-rails-model-column-names)

[如何从模型实例中发现可访问的属性名称？](https://stackoverflow.com/questions/14568694/how-can-you-discover-accessible-attribute-names-from-a-model-instance?lq=1)

# iphone - iOS App 视图和导航设计自定义类

> ID：15373181
> 
> 赞同：0
> 
> 时间：2013-03-12T22:08:12.330
> 
> 标签：iphone, ios, uinavigationbar, navbar

在我的 iOS 应用程序中，我在每节课中一遍又一遍地剪断了以下代码。

我试图将该方法转换为 NSObject 类，但我收到使用“navigationItem”的错误。

```
-(void)customDesign {
//background pattern
self.view.backgroundColor = [[UIColor alloc] initWithPatternImage:[UIImage imageNamed:@"BG-pattern.png"]];

// nav bar
[self.navigationController.navigationBar setBackgroundImage:[UIImage imageNamed:@"top_bar.png"] forBarMetrics:UIBarMetricsDefault];

//back button color  #2974c3
[self.navigationController.navigationBar setTintColor:[UIColor colorWithRed:41.0/255.0f green:116.0/255.0f blue:195.0/255.0f alpha:1.0]];

//settings button
UIImage* settingsImage = [UIImage imageNamed:@"ButtonMenu.png"];
CGRect frameimg = CGRectMake(0, 0, settingsImage.size.width, settingsImage.size.height);
UIButton *uiSettingsButton = [[UIButton alloc] initWithFrame:frameimg];
[uiSettingsButton setBackgroundImage:settingsImage forState:UIControlStateNormal];
[uiSettingsButton addTarget:self action:@selector(menuButton) forControlEvents:UIControlEventTouchUpInside];
[uiSettingsButton setShowsTouchWhenHighlighted:YES];
//add buton to navbar
UIBarButtonItem *settingsButton = [[UIBarButtonItem alloc] initWithCustomView:uiSettingsButton];
self.navigationItem.leftBarButtonItem = settingsButton; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:37:11.860

您应该创建自己的 UIViewController 或 UITableViewController 子类（无论您使用哪个），并将此代码放在该子类的 viewDidLoad 方法中。然后，所有需要此代码的控制器都可以扩展您的自定义类。这将为您省去必须在任何地方编写此代码的麻烦。

您的自定义子类：

```
@interface CustomViewController : UIViewController

@end 
```

您在子类中的 viewDidLoad 方法：

```
@implementation CustomViewController
    - (void)viewDidLoad {
        [super viewDidLoad];

        // all your custom code here...
    }
@end 
```

为您想要在其中完成常见工作的控制器扩展您的自定义类：

```
@interface VisuallyChangedViewController : CustomViewController

@end

@implementation VisuallyChangedViewController
    - (void)viewDidLoad {
        [super viewDidLoad];
    }
@end 
```

# android - 位图未设置为 ImageView

> ID：15373183
> 
> 赞同：0
> 
> 时间：2013-03-12T22:08:29.997
> 
> 标签：android, android-intent, android-camera

我有这个意图：

```
 Intent intent = new Intent();
        intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(file));
        startActivityForResult(intent, CAMERA_REQUEST); 
```

然后这个：

```
getActivity();
    if (requestCode == CAMERA_REQUEST && resultCode == Activity.RESULT_OK
            && null != data) {

         photo = (Bitmap) data.getExtras().get("data");
         iPP.setImageBitmap(photo);

    } 
```

现在，中间线意图似乎阻止`imageView`了`data`. 如果我把它注释掉，我刚刚用相机拍的照片就很好。

我认为我需要这条线，所以我也可以将图片写入存储。那么我该如何解决这个问题呢？

# c# - 如果我加载 winform 应用程序，Assembly.Load 会引发错误的格式异常

> ID：15373185
> 
> 赞同：1
> 
> 时间：2013-03-12T22:08:35.233
> 
> 标签：c#, reflection, methods, invoke, assembly.load

这是我得到的错误代码

```
System.BadImageFormatException: impossible to load the file or assembly '6632 bytes loaded from quick test 2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' or one of its dependencies. Attempt to load a program in a bad format.
Nome file: '6632 bytes loaded from quick test 2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null' ---> System.BadImageFormatException: Format IL not correct.
   in System.Reflection.Assembly.nLoadImage(Byte[] rawAssembly, Byte[] rawSymbolStore, Evidence evidence, StackCrawlMark& stackMark, Boolean fIntrospection)
   in System.Reflection.Assembly.Load(Byte[] rawAssembly)
   in quick_test_2.Form1.button2_Click(Object sender, EventArgs e) in C:\Users\HHH\Documents\Visual Studio 2010\Projects\quick test 2\quick test 2\Form1.cs:riga 175
   in System.Windows.Forms.Control.OnClick(EventArgs e)
   in System.Windows.Forms.Button.OnClick(EventArgs e)
   in System.Windows.Forms.Button.OnMouseUp(MouseEventArgs mevent)
   in System.Windows.Forms.Control.WmMouseUp(Message& m, MouseButtons button, Int32 clicks)
   in System.Windows.Forms.Control.WndProc(Message& m)
   in System.Windows.Forms.ButtonBase.WndProc(Message& m)
   in System.Windows.Forms.Button.WndProc(Message& m)
   in System.Windows.Forms.Control.ControlNativeWindow.OnMessage(Message& m)
   in System.Windows.Forms.Control.ControlNativeWindow.WndProc(Message& m)
   in System.Windows.Forms.NativeWindow.Callback(IntPtr hWnd, Int32 msg, IntPtr wparam, IntPtr lparam) 
```

当我尝试加载一个简单的 Windows 窗体应用程序（.net c#）

我使用的代码是这个

```
try 
{
    Assembly myAsm = Assembly.Load(File.ReadAllBytes("myFile.exe"));
    MethodInfo myMethod = assm.EntryPoint;
    object myObj = assm.CreateInstance(myMethod.Name);
    myMethod.Invoke(o, null);
}
catch 
{
    //error
} 
```

到目前为止，我只设法使它适用于我删除表单并从 Program.cs 中的 [STAThread] 运行代码的表单应用程序，它甚至不适用于简单的控制台应用程序。

对此有任何见解吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:23:13.380

您加载的程序集是否为与主机 exe 相同的 CPU 架构构建（x86 与 x64）？如果主机程序集设置为“任何 CPU”并且加载的程序集设置为 x86，这将在 64 位计算机上导致问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:33:19.683

我确实认为问题在于调用应用程序本身就是一个 winform 应用程序。我从一个简单的 [Stathread] 手动启动该程序并且它工作正常。我不知道这算不算解决

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-11T10:16:44.550

当您更改 .csproj 的目标框架并将其恢复为您开始使用的框架时，通常会发生这种情况。在您疯狂尝试搜索正确的解决方案之前，请确保：

1.  检查 app.config 中启动标记下是否supportedRuntime version="a different runtime from cs project target"。

2.  这也意味着检查可能是属性文件夹中的其他自动生成或其他文件，以查看这些文件与 .csproj 文件中定义的文件之间是否没有更多的运行时不匹配。

在您开始尝试使用项目属性进行不同的操作以克服错误之前，这些可能会为您节省大量时间。

# c - C99 指向结构的指针，其中包含指向结构的指针

> ID：15373188
> 
> 赞同：3
> 
> 时间：2013-03-12T22:08:44.953
> 
> 标签：c, pointers, struct

K&R“The C Programming Language”第 2 版在第 131 页给出了一组变量，因此：

```
struct rect r, *rp = &r; 
```

在哪里 ：

```
struct rect {
    struct point pt1;
    struct point pt2;
}; 
```

和

```
struct point {
    int x;
    int y;
} 
```

那么这四个表达式是等价的：

```
r.p1.x
rp->pt1.x
(r.pt1).x
(rp->pt1).x 
```

在同一页面的早些时候，我们看到了这个：

```
p->member_of_structure 
```

这被描述为“指特定成员”。

我将连字符改为下划线，以确保我们不会与减号混淆。

太好了，我可以看到我们有我所说的嵌套结构，因为结构 rect 在其中包含一个结构点。

那么 rect 的定义是什么使得 pt1 和 pt2 都是指向结构点的指针？

这是我用以下代码位遇到麻烦的地方：

```
typedef struct some_node {
    struct timespec *tv;
    struct some_node *next;
} some_node_t; 
```

显然，我将在这里制作一个链接列表，这没问题。

真正的大问题是：

```
struct timespec some_tv;
clock_gettime( CLOCK_REALTIME, &some_tv )
/* set up the head node */
struct some_node *node_head =
                ( struct some_node * ) malloc( sizeof( some_node_t ) );
node_head->tv = calloc ( (size_t) 1, sizeof ( struct timespec ) ); 
```

这一切都很好，我的 node_head 很好。我什至得到我的嵌套结构 timespec node_head->tv 就好了。

真正的问题是试图弄清楚如何将内部 tv.sec 设置为 some_tv.sec 中的值，如下所示：

```
((struct timespec *)(*node_head.tv)).tv_sec = some_tv.tv_sec; 
```

我收到一个错误：

```
line 22: error: left operand of "." must be struct/union object 
```

所以我正在查看 K&R，我发现书中的示例没有指向结构 rect 中的结构的指针。

我已经通过反复试验来获得我想要的东西，但这令人抓狂。我可以创建一个“struct timespec temp”类型的临时变量，然后设置 temp = &node_head.tv ...但不 ...这不起作用。我想那会更糟。

## 我在这里想念什么？

答案很简单，当然，只需使用 foo->bar->here 语法。

修改代码以删除 malloc 上的强制转换并使用正确的语法：

```
/* set up the node list */
struct some_node *node_head =
                calloc( (size_t) 1, sizeof( some_node_t ) );

node_head->tv = calloc ( (size_t) 1, sizeof ( struct timespec ) );
node_head->tv->tv_sec = some_tv.tv_sec;
node_head->tv->tv_nsec = some_tv.tv_nsec;
node_head->next = NULL; 
```

调试器确认了这一点：

```
(dbx) print *node_head
*node_head = {
    tv      = 0x1001453e0
    next    = (nil)
}

(dbx) print *node_head.tv
*node_head->tv = {
    tv_sec  = 1363127096
    tv_nsec = 996499096
} 
```

效果很好。显然，我需要咖啡。:-)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:11:55.910

这还不够吗？

```
node_head->tv->tv_sec 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:18:07.403

其他答案有，但如果不清楚，`->`与对`*`自己进行“取消引用”相同。

所以

```
 rp->pt1
 (*rp).pt1 
```

是等价的。

这意味着您有“`->`在处理指针时使用”的经验法则。

所以在你有的情况下，

```
node_head->tv->tv_sec 
```

会做你想做的，相当于

```
(*node_head).tv->tv_sec
(*(*node_head).tv).tv_sec 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:12:15.740

您应该更改`(*node_head.tv)`为`(*node_head).tv`（或`node_head->tv`如 Oli 所写），因为`.`优先级高于`*`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:14:49.320

从您的开场示例中，如果您有：

```
struct rect {
    struct point *pt1;
    struct point *pt2;
};

struct point {
    int x;
    int y;
}; 
```

你有

```
struct rect *rp; 
```

然后访问`x`您只需使用：

```
rp->pt1->x 
```

编译器可以弄清楚发生了什么。如果你有 void 指针等，你只需要强制转换。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T22:25:51.653

初步评论：您的`(struct timespec *)`演员阵容`tv`是不必要的，因为这已经`tv`是声明的方式。

正如其他人所指出的那样，您实际上只需要在`ptr->field`此处使用符号：`node_head->tv->tv_sec`. 该`->`符号是一种语法糖，以避免所有`(*rp).(*pt1).x`可能需要的笨拙。

您询问，

> 那么 rect 的定义是什么使得 pt1 和 pt2 都是指向结构点的指针？

在这种情况下，@teppic 的解决方案就是您想要的，但要记住的一个微妙之处是数据结构的实际内存分配在哪里：在您的示例中，实际内存分配在 中`rect`，在@teppic 中，它是`point`. 这一点对于 C 的新手来说有时很棘手，这很重要，尤其是当您在长时间运行的程序中多次分配和释放内存时（避免内存泄漏所必需的）。

# android - MediaPlayer 错误 (1, -1004) aka MEDIA_ERROR_IO 试图播放 YouTube 视频

> ID：15373193
> 
> 赞同：1
> 
> 时间：2013-03-12T22:09:11.393
> 
> 标签：android, youtube-api, android-mediaplayer

我在尝试显示 YouTube 视频时遇到问题。删除所有不必要的代码后，项目如下所示。

AndroidManifest.xml：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.pell.foo"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.ACCESS_WIFI_STATE" />
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <uses-sdk
        android:minSdkVersion="16"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.pell.foo.FooActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
    </application>

</manifest> 
```

activity_foo.xml

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:id="@+id/layout_foo"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:gravity="left|top"
    android:orientation="vertical" >

    <EditText
        android:id="@+id/editText1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:ems="10"
        android:singleLine="true"
        android:text="@string/editText1_text"
        android:hint="@string/editText1_hint" >

        <requestFocus />
    </EditText>

    <Button
        android:id="@+id/button1"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="@string/button1_text" />

    <LinearLayout
        android:orientation="vertical"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content">

        <VideoView
            android:id="@+id/videoView1"
            android:layout_width="fill_parent"
            android:layout_height="wrap_content" />

    </LinearLayout>    

</LinearLayout> 
```

字符串.xml

```
<?xml version="1.0" encoding="utf-8"?>
<resources>

    <string name="app_name">Foo</string>
    <string name="action_settings">Settings</string>
    <string name="editText1_text">psy gangnam style</string>
    <string name="editText1_hint">YouTube search request</string>
    <string name="button1_text">Search &amp; Play YouTube video</string>

</resources> 
```

FooActivity.java

```
package com.pell.foo;

import android.os.Bundle;
import android.os.AsyncTask;
import android.app.Activity;
import android.net.Uri;
import android.util.Log;
import android.view.View;
import android.widget.Button;
import android.widget.EditText;
import android.widget.VideoView;
import android.widget.MediaController;

import java.io.IOException;
import java.net.URL;
import java.net.MalformedURLException;

import com.google.gdata.client.youtube.*;
import com.google.gdata.data.youtube.*;
import com.google.gdata.util.*;

public class FooActivity extends Activity {
    static final String TAG = "FooActivity";
    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_foo);
        Button button = (Button)findViewById(R.id.button1);
        button.setOnClickListener(new View.OnClickListener() {          
            @Override
            public void onClick(View v) {
                class SearchAndPlayYouTubeVideoTask extends AsyncTask<Void, Void, String> {
                    protected String doInBackground(Void... v) {
                        try {
                            YouTubeService service = new YouTubeService("FooActivity");
                            YouTubeQuery query = new YouTubeQuery(new URL("http://gdata.youtube.com/feeds/api/videos"));
                            query.setOrderBy(YouTubeQuery.OrderBy.RELEVANCE);
                            EditText editText = (EditText)findViewById(R.id.editText1);
                            String queryString = editText.getText().toString();
                            query.setFullTextQuery(queryString);
                            query.setSafeSearch(YouTubeQuery.SafeSearch.NONE);
                            VideoFeed videoFeed = service.query(query, VideoFeed.class);
                            for(VideoEntry videoEntry : videoFeed.getEntries() ) {
                                Log.i(TAG, videoEntry.getTitle().getPlainText());
                            }                           
                            VideoEntry videoEntry = videoFeed.getEntries().get(0);                          
                            YouTubeMediaGroup mediaGroup = videoEntry.getMediaGroup();
                            YouTubeMediaContent mediaContent = mediaGroup.getYouTubeContents().get(0);                          
                            String url = mediaContent.getUrl();                         
                            return url;
                        }
                        catch(ServiceException e) {
                            e.printStackTrace();
                            return null;
                        }
                        catch(MalformedURLException e) {
                            e.printStackTrace();
                            return null;
                        }
                        catch(IOException e) {
                            e.printStackTrace();
                            return null;
                        }
                    }
                    protected void onPostExecute(String s) {
                        try {
                            VideoView videoView = (VideoView)findViewById(R.id.videoView1);
                            videoView.setVideoURI(Uri.parse(s));
                            videoView.setMediaController(new MediaController(getApplicationContext()));
                            videoView.requestFocus();
                            videoView.start();
                        }
                        catch(IllegalArgumentException e) {
                            e.printStackTrace();
                        }
                        catch(IllegalStateException e) {
                            e.printStackTrace();
                        }
                    }
                }
                new SearchAndPlayYouTubeVideoTask().execute();
            }
        });
    }
} 
```

在 Android 设备（4G 手机和 WiFi 平板电脑）上运行此程序，我收到 MEDIA_ERROR_IO aka MediaPlayer 错误（1，-1004）。出了什么问题以及如何解决？

更新。以下代码是解决该问题的快速而肮脏的方法：

```
VideoEntry videoEntry = videoFeed.getEntries().get(YouTubeMediaGroup mediaGroup = videoEntry.getMediaGroup();
String url = null;
for(YouTubeMediaContent mediaContent : mediaGroup.getYouTubeContents()) {
    String mediaLocation = mediaContent.getUrl();
    if(mediaLocation.matches("^rtsp.*")) {
        if(null == url ) {
            url = mediaLocation;
        }    
    }    
} 
```

看来，VideoView 只能通过 rtsp 视频播放流式传输。

更好的解决方案是在 WebView 中嵌入视频播放。

# php - TinyMCE 图像保存在数据库中的路径错误。仅在编辑器本身中显示

> ID：15373196
> 
> 赞同：1
> 
> 时间：2013-03-12T22:09:33.703
> 
> 标签：php, url, tinymce

这保存在数据库中。当在管理员的编辑器中查看时，它会显示图像，但在前端却没有，可能是因为 ../../uploads 仅来自管理员正确。

```
<p>it amet, consectetur adipiscing elit. Mauris aliquet elementum mi, ac adipiscing metus suscipit in. Quisque venenatis ante non nulla faucibus viverra. In ultrices nisl sit amet quam commodo ut feugiat magna aliquet. Aenean sit amet odio magna. Maecenas pretium ante a urna dictum vel dignissim erat porta. Aenean rhoncus elementum nisi, nec euismod est tempus commodo. Phasellus sapien nisl, lacinia vel ultrices consectetur, rhoncus vitae dolor. Sed lobortis diam at felis volutpat aliquet. Pellentesque massa neque, tempus ut dignissim at, ultricies a ante. Nam a imperdiet dolor. Ut placerat nisi nec mauris ornare eu ultrices urna tincidunt.</p>
<p>
<img width="710" height="376" alt="" src="../../uploads/pages/image/dog.jpg">
</p> 
```

如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:19:18.787

好的，我自己解决了；）。我需要在 TinyMCE init 中添加这个：

```
 document_base_url : "http://domain.name",    
  relative_urls : false, 
  remove_script_host : false, 
```

# google-apps-script - 如何在 Google 脚本中使用 ImportXML？

> ID：15373201
> 
> 赞同：4
> 
> 时间：2013-03-12T22:09:52.340
> 
> 标签：google-apps-script, google-sheets

设想：

我正在尝试使用 Google 电子表格来执行以下操作：

我有一组要获取标题的博客 URL（超过 50 个）

目前我正在使用公式：**ImportXML(A2,"//h1[@class='entry-title']" )**

![在此处输入图像描述](../Images/af7927fae8e9da02f398f64dabbdff3f.png)

这种方法的问题是 ImportXML 调用限制为每个电子表格 50 个，而我有超过 50 个。

我浏览/搜索 - 发现我们可以在谷歌应用程序脚本中使用 ImportXML 调用，但没有找到任何示例。

我发现了这个：[https](https://developers.google.com/apps-script/articles/XML_tutorial) ://developers.google.com/apps-script/articles/XML_tutorial但我希望使用 ImportXML 函数。

任何人都可以描述或指向他们在谷歌应用程序脚本中使用 ImportXML 的资源吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T07:43:33.803

我会使用一些电子表格，然后将结果汇总到一个主电子表格中，或者你正在做 >1000 左右。如果您有很多东西，那么您拥有的 XML_tutorial 链接就是开始的地方。但是上次我检查时，google-apps-script 不支持 google 电子表格功能，如果我记得的话，支持 GAS 中所有电子表格功能的功能请求被拒绝了。

# ios5 - 不使用 GKTurnBasedParticipant IOS 5 iphone 发送转弯

> ID：15373204
> 
> 赞同：4
> 
> 时间：2013-03-12T22:10:02.320
> 
> 标签：ios5, game-center, gkturnbasedmatch

我正在为 iPad 和 iPhone 开发一个具有 Game Center 功能的应用程序。游戏从 iPad 2 IOS 6 正确发送一个参与者转弯，但是当我尝试从 iPhone 4 IOS 5 将转弯发送给另一个参与者时，出现以下错误：

```
<GKTurnBasedParticipant 3d8e50 - id:(null) status:Matching outcome:None lastTurn:(null)>
2013-03-14 23:56:22.030 [453:707] ERROR::::::Error Domain=GKErrorDomain Code=3 "The requested operation could not be completed due to an error communicating with the server." UserInfo=0x7a81170 {NSUnderlyingError=0x3f4220 "The operation couldn’t be completed. status = 5008, missing required key: turns", NSLocalizedDescription=The requested operation could not be completed due to an error communicating with the server.}
2013-03-14 23:56:22.031 [453:707] Oops, there was a problem.  Try that again. 
```

我正在使用以下在 IOS 6 上完美运行的方法：

```
[currentMatch endTurnWithNextParticipant:nextParticipant
                                       matchData:data completionHandler:^(NSError *error) {
                                           if (error) {
                                               NSLog(@"%@", error);
                                               NSLog(
                                               @"Oops, there was a problem.  Try that again.");
                                           } else {
                                               NSLog(@"Your turn is over.");

                                           }
                                       }]; 
```

错误号 3 是 GKErrorCommunicationsFailure，但我不明白这是怎么回事！

当应用程序从游戏中心启动时我正确登录

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-15T08:01:36.750

当您在模拟器而不是设备上工作时总是会出现此错误，但有时它会在设备上弹出，因为推送通知失败，请检查您的设备是否正在接收推送通知。

**更新**

我最近发现 Game Center 不会向没有插入 SIM 卡的设备发送推送通知

# php - 在 PHP 中编辑和保存数据时出错

> ID：15373205
> 
> 赞同：0
> 
> 时间：2013-03-12T22:10:03.500
> 
> 标签：php, edit

当我删除这些值时，它运行良好。当我搜索时，它运行良好。仅当我在编辑后尝试保存数据时才会收到错误消息。

我也尝试使用

```
if(!isset($_GET['edit']))
{
    echo '<form action="" method="post">';  
    echo '<input type="text" name=criteria>';
    echo '<input type="submit" value="search" name="submit">';
    echo '</form>';
} 
```

但它没有用。

我收到的错误是（！） SCREAM：错误抑制忽略（！）注意：未定义的索引：第 13 行 C:\wamp\www\test\search.php 中的条件。

整个代码是

```
<html>
    <head>
    </head>
<body>  
<?php
    $page='search.php';
    mysql_connect("localhost","root","") or die (mysql_error());
    mysql_select_db("list") or die (mysql_error());

    if(empty($_POST) === false)
    {

        $data=$_POST['criteria'];
        if (empty($data) === true)
        {
            echo 'Please enter some text!!<br/>';
        } 
        else
        {
            $get=mysql_query("SELECT SRNO, fname, lname, phone, email, address, comments from names where fname='" . mysql_real_escape_string($data) . "'");
            if (mysql_num_rows($get)==0) 
                {
                    echo 'There are no search results!!';
                }
                    else
                {
                    echo '<table border=0 cellspacing=25 cellpadding=1>';
                    echo'<tr><th>Sr. No</th><th>First Name</th><th>Last Name</th><th>Phone No</th><th>E-mail</th><th>Address</th><th>Comments!!</th><th>Modify</th><th>Delete!</th></tr>';      
                    while($get_row=mysql_fetch_assoc($get))
                        {
                            echo '<tr><td>'.$get_row['SRNO'].'</td><td>'.$get_row['fname'].'</td><td>'.$get_row['lname'].'</td><td>'.$get_row['phone'].'</td><td>'.$get_row['email'].'</td><td>'.$get_row['address'].'</td><td>'.$get_row['comments'].'</td><td><a href="search.php?edit='.$get_row['SRNO'].'">Edit</a></td><td><a href="search.php?delete='.$get_row['SRNO'].'">Delete</a></td></tr>';

                        }
                    echo '</table>';
                }
        }
        /*
        if(mysql_num_rows($getf) == 0)
        {
            $getel=mysql_query('SELECT SRNO, fname, lname, phone, email, address, comments from names where lname='.$_GET['$data']));

        }*/
    }

        if(isset($_GET['delete']))
        {
            mysql_query('DELETE from names where SRNO='.mysql_real_escape_string((int)$_GET['delete']));
        }

        if(isset($_GET['edit']))
        {
            $getedit=mysql_query('SELECT SRNO, fname, lname, phone, email, address, comments from names where SRNO='.mysql_real_escape_string((int)$_GET['edit']));

            echo '<table border=0>';
            while ($get_row=mysql_fetch_assoc($getedit))
                {
                    echo '<form method="POST" action="">';

                    echo '<tr><td>Sr.No:</td><td><input type="text" value='.$get_row['SRNO'].' name="SRNO" readonly="readonly"></td></tr>';
                    echo '<tr><td>First Name:</td><td><input type="text" value='.$get_row['fname'].' name="fname"></td></tr>';
                    echo '<tr><td>Last Name:</td><td><input type="text" value='.$get_row['lname'].' name="lname"></td></tr>';
                    echo '<tr><td>Phone No:</td><td><input type="text" value='.$get_row['phone'].' name="phone"></td></tr>';
                    echo '<tr><td>E-mail address:</td><td><input type="text" value='.$get_row['email'].' name="email"</td></tr>';
                    echo '<tr><td>Address:</td><td><textarea name="address" rows=4>'.$get_row['address'].'</textarea></td></tr>';
                    echo '<tr><td>Comments:</td><td><textarea name="comments" rows=4>'.$get_row['comments'].'</textarea></td></tr>';
                    echo '<tr><td><input type="submit" name="submit" value="save"></td><td><a href="search.php">Cancel</a></td></tr>';
                    echo '</form>';                                 
                }
            echo '</table>';

        }
        if(!isset($_GET['edit']))
        {
            echo '<form action="" method="post">';  
            echo '<input type="text" name=criteria>';
            echo '<input type="submit" value="search" name="submit">';
            echo '</form>';
        }

?>
</body>
</html> 
```

有两种形式，只有一种

```
if(empty($_POST) === false) 
```

如何在 if 语句中添加条件来过滤每个条件？请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:13:46.190

尝试在输入的名称周围加上双引号：

```
<input type="text" name="criteria"> 
```

# chef-infra - 厨师/刀引导流浪虚拟机的问题？

> ID：15373209
> 
> 赞同：0
> 
> 时间：2013-03-12T22:10:17.640
> 
> 标签：chef-infra, vagrant, bootstrapping, knife

我正在尝试引导一个 vagrant vm 并使用以下命令安装 chef

```
knife bootstrap localhost -p 2222 -x vagrant -P vagrant --sudo 
```

但什么都没有发生 - 在这个粘贴箱中没有看到错误消息 - [http://pastebin.com/06pyGAHZ](http://pastebin.com/06pyGAHZ)请建议？我错过了什么...

我的流浪文件供参考 - [http://pastebin.com/djncyWNn](http://pastebin.com/djncyWNn)

更新：我可以尝试 vagrant provision 它可能会起作用。但令我困惑的是

1）尽管它是一个流浪虚拟机，但它没有什么不同，它有一个 IP 地址，我可以使用 ssh vagrant@localhost -p 2222 从本地机器 ssh

2）刀语句没有给出任何错误信息，它默默地什么也不做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-14T19:39:33.380

## 要使此工作正常工作，请使用 VM 的桥接网络设置更新您的 Vagrantfile。

db_config.vm.box = "Ubuntu12.04cloud"

## db_config.vm.network：桥接

这会将VM带到您的网络上，并且不会在Virtualbox的nat接口上，我不确定为什么它不能在nat接口上工作，但可能是因为来宾添加不是最新的。一旦完成 ssh 到该框并检查桥接 IP 地址是什么，如果您的 dns 设置正确，您可以更新该框的 FQDN。

要引导 Box，请使用指向桥接 IP 的 FQDN 或仅使用桥接 IP 地址。现在这个灵魂工作。

下面是我在没有 Chef 的情况下下载的 ubuntu 盒子的输出，并使用上述方法引导了 Vagrant VM。

[https://gist.github.com/vinitkhandagle/5164417](https://gist.github.com/vinitkhandagle/5164417)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-24T21:47:36.050

这是使用刀直接引导 Vagrant VM 的另一种方法：为什么不使用内置的 Vagrant Chef 配置器呢？这样做时，您不需要在 Vagrant VM 上安装 Chef，但您仍然可以使用 Chef 配置它们。

在你的 Vagrant.configure("2") 下做 |config| 行，你可以像这样添加它：

config.omnibus.chef_version = :latest

```
# -*- mode: ruby -*-
# vi: set ft=ruby :

Vagrant.configure("2") do |config|

  config.ssh.shell = "bash -c 'BASH_ENV=/etc/profile exec bash'"
  config.omnibus.chef_version = :latest

  config.vm.define :oak do |oak|
    oak.vm.box = "hashicorp/precise64"
    oak.vm.provision "chef_client" do |client|
      client.chef_server_url = "https://my-chef-server:443"
      client.validation_key_path = "/home/me/.chef/chef-validator.pem"
      client.add_role "base"
      client.add_recipe "users"
      client.add_recipe "nginx"
      client.environment = "development"
    end
  end

  config.vm.define :maple do |maple|
    ... 
```

# c# - 尝试从视图获取数据到控制器时模型为空

> ID：15373212
> 
> 赞同：0
> 
> 时间：2013-03-12T22:10:25.817
> 
> 标签：c#, asp.net-mvc, razor

我有一个从控制器发送数据到视图的模块。它有多行，并且可以按我的意愿正确显示。现在，在用户进行了一些更改后，我再次尝试在 actionresult 的帮助下保存数据库中的更改。但是当我尝试获取值时，它说我的模型为空/空，但它不是...我没有得到问题所在...提前谢谢...

这是我的模型：

```
public class ManageAppsModel
{

  public string appname { get; set; }
  public int id { get; set; }
  public bool chkbillboard { get; set; }
} 
```

这是我的看法：

```
@model IEnumerable<Nd.Models.ManageAppsModel>

@using (Html.BeginForm(null, null, FormMethod.Post, new { enctype = "multipart/form-data" }))
{
  <br />
  <h2 style="color:#80afdd;font-size:14px;">
    <strong> List of Existing Apps:</strong>
  </h2>
  <br />
  <div class="section-copy">
    <table>
    @foreach (var item in Model)
    {
      <tr>
      @if (Context.User.Identity.Name == "admin")
      {
        <td style="width:50px;">
        @if (@item.chkbillboard == true)
        {
          <input name ="chk1" class="myCheckbox" type="checkbox" value="@item.chkbillboard" checked="checked" />
        }
        else
        {
          <input name ="chk2" class="myCheckbox" id="chkbox" type="checkbox" value="@item.chkbillboard" onclick="return chkbox();" />
        }                                   
        </td>     
      }
        <td style="width:200px;">
          @item.appname
        </td> 
        <td style="width:50px;">
          @Html.ActionLink("Edit", "UpdateAPIForm", new { @id = item.id, appname = item.appname })
        </td>
      </tr>
      }
    </table>
  </div>
  <br/><br/>
  if (Context.User.Identity.Name == "admin")
  { 
    <div>
      <input type="submit" name="Upload" value="Upload new flash info message" />
    </div>
  }
} 
```

这是我的行动结果：

```
[Authorize]
public ActionResult ManageApps(String username)
{
  var a = HttpContext.User.Identity.Name;
  var context = new ndCorp_SiteEntities();

  if (a == "admin")
  {
    var viewModel1 = from dc in context.DevContactInfoes
                     join dm in context.DevMarketplaceInfoes on dc.AppName equals dm.AppName
                     select new ManageAppsModel { appname = dc.AppName, id = dc.SNo, chkbillboard = dc.billboard.Value }
                     ;
    return View( viewModel1 );
  }
  else
  {
    var viewModel = from du in context.DevUserInfoes
                    join dc in context.DevContactInfoes on du.UserName equals dc.UserName
                    join dm in context.DevMarketplaceInfoes on dc.AppName equals dm.AppName
                    where du.UserName == a
                    select new ManageAppsModel { appname = dc.AppName, id = dc.SNo };
    return View(viewModel);
  }

}

[Authorize]
[HttpPost]
public ActionResult ManageApps(IEnumerable<ManageAppsModel> apps)
{
  var user = HttpContext.User.Identity.Name;
  var context = new ndCorp_SiteEntities();

  foreach (var ManageAppsModel in apps)
  {
    if (ManageAppsModel.chkbillboard == true)
    {
      Response.Write("hello");
    }
  }
  return RedirectToAction("ManageApps", new { username = user });
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:28:23.260

您的复选框名为 chk1 和 chk2，但您的字段名为 chkBillboard。当您发布您的值时，它会使用输入字段的名称来匹配模型中的字段名称。

我建议使用帮助程序，以确保您具有正确的格式。

```
@Html.CheckBoxFor(x => item.chkBillboard, new { @class="myCheckbox" }) 
```

# sql - sql server: MERGE 有意外结果

> ID：15373214
> 
> 赞同：3
> 
> 时间：2013-03-12T22:10:32.390
> 
> 标签：sql, sql-server

这些行通常第一次进入目标表的方式是使用少数列填充大部分文本数据，其余列设置为 NULL。在随后的传递中，新数据填充现有的已知（非空）和未知（空）数据。我已经确定新数据（#pld）确实包含不同的数据。数据似乎没有变化。这是我所拥有的：

```
 BEGIN TRANSACTION

  BEGIN TRY

  MERGE INTO [metro].listings AS metroList
    USING #pld as listnew
      ON metroList.id = listnew.id
      AND metroList.sid = listnew.sid
      WHEN MATCHED AND (
        metroList.User != listnew.User
         or metroList.Email != listnew.Email
         or metroList.LocName != listnew.LocName
   ) THEN
   UPDATE SET
    metroList.User = listnew.User,
    metroList.Email = listnew.Email,
    metroList.LocName = listnew.LocName,
   WHEN NOT MATCHED THEN
  INSERT
   ( User,
     Email,
     LocName
   )
   VALUES
   (
     listnew.User,
     listnew.Email,
      listnew.LocName
    );

  COMMIT TRANSACTION

 END TRY

 IF @@TRANCOUNT > 0
    ROLLBACK TRANSACTION;

 END CATCH 
```

我尝试将 != 替换为语句的更新部分下的 <> 。结果相同。这必须与一个可能的（可能的）空值与字符串的比较有关——甚至可能是另一个空值？无论如何，我呼吁所有的 sql-geeks 来解决这个问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:35:59.760

您也可以将选项与[NULLIF()](http://msdn.microsoft.com/en-us/library/ms177562.aspx)函数一起使用。

***如果两个表达式不相等，则 NULLIF 返回第一个表达式。如果表达式相等，则 NULLIF 返回第一个表达式类型的空值。***

```
WHEN MATCHED AND (
                  NULLIF(ISNULL(metroList.[User],''), listnew.[User]) IS NOT NULL
                    OR NULLIF(ISNULL(metroList.Email, ''), listnew.Email) IS NOT NULL
                    OR NULLIF(ISNULL(metroList.LocName, ''), listnew.LocName) IS NOT NULL
                  )
THEN 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:18:32.253

与`NULL`空字符串比较将不起作用。

如果任何一方都可以`NULL`，您可以执行以下操作：

```
WHEN MATCHED AND (
        COALESCE(metroList.User, '')    <> COALESCE(listnew.User, '')
     or COALESCE(metroList.Email, '')   <> COALESCE(listnew.Email, '')
     or COALESCE(metroList.LocName, '') <> COALESCE(listnew.LocName, '')
   ) THEN 
```

当然，这假设您可以接受与`NULL`空字符串相同的含义（这可能不合适）。

看看[这篇](http://msdn.microsoft.com/en-us/library/aa196339%28v=sql.80%29.aspx)关于`NULL`比较的 BOL 文章。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-13T07:22:28.337

据我了解，您正在寻找一个模仿`IS DISTINCT FROM`.

那么您接受的答案不正确

```
WITH metroList([User])
     AS (SELECT CAST(NULL AS VARCHAR(10))),
     listnew([User])
     AS (SELECT 'Foo')
SELECT *
FROM   metroList
       JOIN listnew
         ON NULLIF(metroList.[User], listnew.[User]) IS NOT NULL 
```

返回零行。尽管比较的值是`NULL`和`Foo`。

我将使用本文中的技术：[未记录的查询计划：平等比较](http://web.archive.org/web/20180422151947/http://sqlblog.com:80/blogs/paul_white/archive/2011/06/22/undocumented-query-plans-equality-comparisons.aspx)

```
WHEN MATCHED AND EXISTS (
                         SELECT  metroList.[User], metroList.Email,metroList.LocName
                         EXCEPT
                         SELECT  listnew.[User], listnew.Email,listnew.LocName
                         ) 
```

# c# - 将多个值放入一个数组

> ID：15373218
> 
> 赞同：0
> 
> 时间：2013-03-12T22:10:51.983
> 
> 标签：c#, arrays, for-loop, initialization

我有一个我无法解决的问题。

这是代码

```
 sik input = new sik();
        for (int i = 0; i < 5; i ++)
        {
            input.skId = securitiesArray[i].skId;
            input.country = securitiesArray[i].country;

        }
   sik[] inputs = new sik[]
            {
                input
            }; 
```

现在我知道这只会在 sik[] 列表中放入 1 个值。

我怎样才能把所有 5 个值都放在这个列表中。

谢谢

注意：我不能先初始化ski[]。这必须按此顺序完成。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:13:15.467

任何理由它必须是一个数组？

```
List<sik> input = new List<sik>();

for (int i = 0; i < 5; i ++)
{
    var newInput = new sik();        
    newInput.skId = securitiesArray[i].skId;
    newInput.country = securitiesArray[i].country;
    input.Add(newInput);
} 
```

List 有用的原因是它可以随着你动态增长，所以你不必担心你可能需要添加多少实例。

列表的 MSDN 文档和所有它的光荣方法 [http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:12:37.987

```
 sik[] inputs = new sik[5];
    for (int i = 0; i < 5; i ++)
    {
        sik input = new sik();
        input.skId = securitiesArray[i].skId;
        input.country = securitiesArray[i].country;
        inputs[i] = input;
    } 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:13:01.903

您可以使用 Linq 来执行此操作。

```
sik[] inputs = securitiesArray.Select(item => 
    new sik() 
    { 
        skId = item.skId, 
        country = item.country 
    }).ToArray(); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T22:14:35.333

您不能拥有可变大小的数组，而是可以使用 List。

```
 List<sik> siks = new List<sik>();
    sik input = new sik();
    for (int i = 0; i < 5; i ++)
    {
        input.skId = securitiesArray[i].skId;
        input.country = securitiesArray[i].country;

        siks.Add(input);
    } 
```

如果您还想要数组，请使用`sik[] inputs = skis.ToArray();`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-12T22:15:33.787

对于它的价值，这里是 Linq 方法：

```
sik[] inputs = Enumerable.Range(0, 5)
    .Select(i => new sik{ kId = securitiesArray[i].skId, country = securitiesArray[i].country})
    .ToArray(); 
```

如果`securitiesArray`是类型`sik`（属性建议），您可以直接从中选择：

```
sik[] inputs = securitiesArray.Take(5).ToArray(); 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-12T22:18:22.590

你也可以这样做，

```
List<sik> input=new List<sik>();
for(int i=0;i<securitiesArray.Length;i++)
{
   input.Add(new{skId=securitiesArray[i].skid,country=securitiesArray[i].country});
} 
```

# html - 为什么 CDATA 部分中的 IFRAME 会破坏解析器？

> ID：15373226
> 
> 赞同：2
> 
> 时间：2013-03-12T22:11:24.423
> 
> 标签：html, xml, iframe, xhtml, cdata

我有一个包含嵌入式 iframe 声明的 CDATA 部分，如下所示：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<body>
    <div>before iframe</div>
    <iframe id="xml_test">
        <?xml version="1.0" encoding="UTF-8"?>
        <xml_data>
            <node>
                <![CDATA[
                    "<iframe src=\"http://imgur.com\"></iframe>"
                ]]>
            </node>
        </xml_data>
    </iframe>
    <div>after iframe</div>
</body>
</html> 
```

在几个浏览器中查看生成的 DOM，似乎`iframe`CDATA 部分中的声明没有被忽略：

![在此处输入图像描述](../Images/e6fab672d1586c743ffe78b02e7f6689.png)

HTML 也很混乱：

![在此处输入图像描述](../Images/1ebd9c194fab25707ff1ca1ad4c7f70d.png)

从 CDATA 部分中删除结束`iframe`标记可以修复它：

![在此处输入图像描述](../Images/8155b19a9a9b10bbd4de111de7d3cfb8.png)

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:21:10.880

`<iframe>`元素不能像这样内联定义它们的内容。标记的内容都被忽略，直到第一个;`</iframe>`关闭元素 `id=xml_test`从这个角度来看，其余的解析应该是有意义的。

# azure - CNAME 是否应该返回一个带有指向目标主机名的框架的页面？

> ID：15373229
> 
> 赞同：0
> 
> 时间：2013-03-12T22:11:37.310
> 
> 标签：azure, dns, cname

我在 MS Azure 上创建了一个 Web 应用程序，并要求我们的管理员添加一个 CNAME，以便我们的公共主机名 (www.example.com) 指向 MS Azure 上的主机名 (ourapp.couldapp.net) 现在问题是当用户访问 www.example.com 响应是一个带有指向 ourapp.cloudapp.net 框架的页面，这会导致很多问题（例如 IE9、IE10 不允许存储 cookie）现在我的问题是：

*   该 dns 服务器返回这样的页面是正常行为（我的意思是 CNAME 是否像这样工作）或者管理员做错了什么？
*   有没有其他方法可以达到同样的效果？

非常感谢您的回答。我现在在谷歌上搜索了几天！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:28:31.573

听起来像您的管理员设置域掩码，而不是 CNAME 记录。“www” CNAME 记录需要指向 yourapp.couldapp.net，然后您将根域转发到 www.yourdomain.com。

# java - 使用java通过html文本框发送字符串

> ID：15373230
> 
> 赞同：-1
> 
> 时间：2013-03-12T22:11:38.150
> 
> 标签：java, browser, automation

我想在 java 中制作一个控制台程序，它将从用户那里获得的输入发送到 HTML POST 表单。一种自动填充程序。我只需要一个简单的方向。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:15:02.253

看看[硒](http://docs.seleniumhq.org/)

> Selenium 使浏览器自动化。就是这样。你用这种力量做什么完全取决于你。主要是为了测试目的而自动化 Web 应用程序，但当然不仅限于此。无聊的基于 Web 的管理任务也可以（而且应该！）自动化。
> 
> Selenium 得到了一些最大的浏览器供应商的支持，这些供应商已经（或正在）采取措施使 Selenium 成为其浏览器的本机部分。它也是无数其他浏览器自动化工具、API 和框架的核心技术。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:19:30.193

您可以将 curl [http://curl.haxx.se/docs/manpage.html](http://curl.haxx.se/docs/manpage.html)与 System.exec 调用一起使用，或者您需要编写如下内容：

```
String urlParameters = "param1=a&param2=b&param3=c";
URL url = new URL("http://example.com/index.php");
URLConnection conn = url.openConnection();

conn.setDoOutput(true);

OutputStreamWriter writer = new OutputStreamWriter(conn.getOutputStream());

writer.write(urlParameters);
writer.flush();

String line;
BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream()));

while ((line = reader.readLine()) != null) {
    System.out.println(line);
}
writer.close();
reader.close(); 
```

此示例取自[Java - 通过 POST 方法轻松发送 HTTP 参数](https://stackoverflow.com/questions/4205980/java-sending-http-parameters-via-post-method-easily)

# c# - 无法通过类使用列表框选定项目更改标签

> ID：15373231
> 
> 赞同：1
> 
> 时间：2013-03-12T22:11:42.530
> 
> 标签：c#, xml, winforms, listbox

我有一个列表框，其中包含来自和 xml 文件的标签名称，还有其他标签也包含在一个类中，但是当我尝试单击列表框中的值以将标签文本设置为里面的值时我收到以下错误：“InvalidCastException 未处理。无法将'System.String'类型的对象转换为'Coursework1.modules'类型。” 这是代码，这是在索引更改时的列表框事件内。

```
for (int i = 0; i < selectionBox.Items.Count; i++)
        {
            if (selectionBox.GetSelected(i) == true)
            {
                infoLabel.Text = ((modules)selectionBox.Items[i]).mInfo;
                lectureSlotLabel.Text = ((modules)selectionBox.Items[i]).mLSlot;
                tutorialLabel.Text = ((modules)selectionBox.Items[i]).mTSlot;
                prerequisiteLabel.Text = ((modules)selectionBox.Items[i]).mPreReq;
                codeLabel.Text = ((modules)selectionBox.Items[i]).mCode;
                nameLabel.Text =((modules)selectionBox.Items[i]).mName;
            }
        } 
```

//选择框创建

```
 String workingDir = Directory.GetCurrentDirectory();

        XmlTextReader textReader = new XmlTextReader(workingDir + @"\XML.xml");
        textReader.Read();
        XmlNodeType type;

        while (textReader.Read())
        {
            textReader.MoveToElement();
            type = textReader.NodeType;
            if (type == XmlNodeType.Element)
            {
                //if (textReader.Name == "Code")
                //{
                //    module.Add(new modules(textReader.ReadElementContentAsString(),
                //        textReader.ReadElementContentAsString(),
                //        textReader.ReadElementContentAsString(),
                //        textReader.ReadElementContentAsString(),
                //        textReader.ReadElementContentAsString(),
                //        textReader.ReadElementContentAsString(),
                //        textReader.ReadElementContentAsString()));
                //}

                if (textReader.Name == "Code")
                {
                    textReader.Read();
                    code = textReader.Value;
                    Console.WriteLine(code);

                }
                if (textReader.Name == "Name")
                {
                    textReader.Read();
                    name = textReader.Value;
                    //selectionBox.Items.Add(name);
                    Console.WriteLine(name);

                }
                if (textReader.Name == "Semester")
                {
                    textReader.Read();
                    semester = textReader.Value;
                    Console.WriteLine(semester);

                }
                if (textReader.Name == "Prerequisite")
                {
                    textReader.Read();
                    preReq = textReader.Value;
                    Console.WriteLine(code);
                }
                if (textReader.Name == "LectureSlot")
                {
                    textReader.Read();
                    lSlot = textReader.Value;
                    Console.WriteLine(lSlot);
                }
                if (textReader.Name == "TutorialSlot")
                {
                    textReader.Read();
                    tSlot = textReader.Value;
                    Console.WriteLine(tSlot);
                }
                if (textReader.Name == "Info")
                {
                    textReader.Read();
                    info = textReader.Value;
                    Console.WriteLine(info);
                    module.Add(new Modules(code, name, semester, tSlot, lSlot, info, preReq));
                }

            }

            //Console.WriteLine(module);

        }
        foreach (object o in module)
        {
            Modules m = (Modules)o;
            //String hold = m.mName;
            selectionBox.Items.Add(m.mName);
        }
        textReader.Close(); 
```

//正在使用的标签文本

```
var xmlFile = XDocument.Load(xmlDirectory + @"\XML.xml");
        //Finds the XML file again and looks for the Name tag
        var mName = from directory in xmlFile.Descendants("Name")
                    where directory.Value == (String)selectionBox.SelectedItem
                    select directory.Parent.Element("Name").Value;
        //in the mName we search the directory for the Name tag and after we search
        //for the selected item of the list in the directory after that we look for 
        //the "Name" element in the directory and that gets the name value and saves it to
        //mName
        foreach (var item in mName)
        {
            //use the loop to make it dynamic as when the selected item changes so does,
            //the moduleName label
            nameLabel.Text = item.ToString();
        } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:57:11.873

这一行：

```
selectionBox.Items.Add(m.mName); 
```

只是`module`添加 to的名称`selectionBox`，这可以解释为什么您在尝试将 a`string`转换为 a时遇到问题`module`。您需要研究的是使用数据绑定。添加此代码代替`foreach (object o in module)`循环：

```
selectionBox.DataSource = module;
selectionBox.DisplayMember = "mName"; 
```

在 index changed 事件中，您可以像这样检索所选项目：

```
modules m = (modules)selectionBox.SelectedItem; 
```

此外，如果您确实以这种方式检索所选项目，则可以取消`for`当前在索引更改事件处理程序中的循环。

**编辑：**

当前，您正在将每个名称添加`module`到`selectionBox`. 但是，当您去检索所选项目时，您会在尝试将对象名称转换为实际对象时收到错误消息。

所以使用我的解决方案：

```
selectionBox.DataSource = module; 
```

将您创建的对象列表指定为 的`DataSource`（即，它从中获取数据的位置）`selectionBox`，并且

```
selectionBox.DisplayMember = "mName"; 
```

指示应将对象的哪个属性用作显示文本。在这种情况下，我有`mName`，因为这是您之前添加到的属性`selectionBox`。

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2013-03-12T22:50:59.113

这不是问题本身的答案，而是对 OP 在评论中发布的问题的答案：

> @HighCore 你能告诉我你说的第一个演员是什么意思吗？

你不应该这样做

`((modules))selectionBox.Items[i]`

很多次。相反，将其替换为

```
if (selectionBox.GetSelected(i) == true)
{
    var module = selectionBox.Items[i] as modules; 

    if (module != null)
    {
        infoLabel.Text = module.mInfo;
        //etc...
    }
} 
```

这更简单，也更安全（因为我实际上是在检查这件事是否`modules`开始。这可以防止投射异常。

# excel - 将公式应用于整个范围

> ID：15373237
> 
> 赞同：0
> 
> 时间：2013-03-12T22:11:57.490
> 
> 标签：excel, range, formula, user-defined, vba

对于实验过的 VBA 开发人员/用户来说，这可能是一段非常简单的代码，但是我是新的编程人员，我已经在这个任务上停留了几天:(。我所需要的只是将一个公式应用于用户定义的范围，或者一个整体（如果可能的话）或用“for-each next”或“for next”循环遍历它，我每次尝试都会出错。有人可以帮我解决这个问题吗....thxs非常提前

假设该公式很简单，例如 F =m*a，即“m”我选择的范围

这里是选择范围的代码：

```
Option Base 1

    Sub KVmodel()

    'Select the data points from the excel spreadsheet

    Dim A, B As Range
    Set A= Application.InputBox("Select A Range", "Select a range", Type:=8)
    Set B= Application.InputBox("Select B Range", "Select a range", Type:=8)

    'Verify the lenght of the selected data
    If A.Count = B.Count Then
    MsgBox "Do you want to run the KV Model Adjustment?", vbYesNo

    'Calculates F according to the values of the model

    -
    -
    -

    Else
    MsgBox "The range sizes are different, please re-select the input data"

    End If

    End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T04:38:04.967

Try below code :

```
Option Base 1

Sub KVmodel()

    On Error Resume Next

    'Select the data points from the excel spreadsheet

    Dim A As Range, B As Range
    Set A = Application.InputBox("Select A Range", "Select a range", Type:=8)
    Set B = Application.InputBox("Select B Range", "Select a range", Type:=8)

    Dim userDefinedRng As Range ' assumption
    Set userDefinedRng = Range("A1:A10")

    On Error GoTo 0

    If Not A Is Nothing And Not B Is Nothing Then

        'Verify the lenght of the selected data
        If A.Count = B.Count Then
            retVal = MsgBox("Do you want to run the KV Model Adjustment?", vbYesNo)

            If retVal = vbYes Then
                'Calculates F according to the values of the model
                userDefinedRng.FormulaR1C1 = "= 1 * 2" ' here it applies forumla to whole userdefined range
                MsgBox "yes"
            Else
                MsgBox "no"
            End If

        Else
            MsgBox "The range sizes are different, please re-select the input data"

        End If
    End If

    Exit Sub

End Sub 
```

# iis - IIS7.5 64bit 一次可以处理多少个逻辑 CPU 线程？

> ID：15373241
> 
> 赞同：4
> 
> 时间：2013-03-12T22:12:06.057
> 
> 标签：iis, iis-7, iis-7.5

IIS7.5 64bit 可以同时处理每个逻辑 cpu 多少个线程？我听说每个逻辑 cpu 有 12 个 IIS 处理线程，但我也听说每个逻辑 cpu 有 100 个 IIS 处理线程。

**更新：**

抱歉没有具体说明，但我指的是 IIS 线程池线程。那就是当一个 http get 请求进入我的 webapi 服务器时，我的服务器一次可以处理多少个并发 http get 请求（每个逻辑 cpu）？我正在尝试根据我的服务器可以处理的请求数来计算一些阈值容量数，该请求数基于我得到的平均响应时间，大约为 500 毫秒。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:20:04.687

[http://msdn.microsoft.com/en-us/library/system.threading.threadpool](http://msdn.microsoft.com/en-us/library/system.threading.threadpool)

> 每个进程有一个线程池。从 .NET Framework 4 开始，进程的线程池的默认大小取决于几个因素，例如虚拟地址空间的大小。进程可以调用 GetMaxThreads 方法来确定线程数。可以使用 SetMaxThreads 方法更改线程池中的线程数。每个线程使用默认堆栈大小并以默认优先级运行。

[http://blogs.msdn.com/b/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx](http://blogs.msdn.com/b/tmarq/archive/2007/07/21/asp-net-thread-usage-on-iis-7-0-and-6-0.aspx)

> 因此对于 IIS 7.0 集成模式，HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\ASP.NET\2.0.50727.0 中名为 **MaxConcurrentRequestsPerCPU**的 DWORD确定并发**请求的数量**每个 CPU。默认情况下，它不存在，并且每个 CPU 的请求数限制为 12。如果您想知道在没有线程切换的情况下 ASP.NET 请求的执行速度有多快，您可以将该值设置为 0。这将导致在 IIS I/O 线程上执行的请求，而不切换到 CLR 线程池线程。我不建议这样做主要是因为动态请求相对于静态请求执行时间较长，而且我相信线程切换后系统的整体性能会更好。但是，这很重要，如果您的应用程序主要或完全由异步请求组成，则默认的 MaxConcurrentReqeustsPerCPU 限制 12 对您来说过于严格，尤其是在请求运行时间很长的情况下。在这种情况下，我建议设置**MaxConcurrentRequestsPerCPU**到一个非常高的数字。事实上，在 v4.0 中，我们将 **MaxConcurrentRequestsPerCPU**的默认值更改为 5000。5000并没有什么特别之处，只是它是一个非常大的数字，因此可以同时执行大量异步请求。

# c# - 整个函数处理完后出现Modalpopup窗口

> ID：15373244
> 
> 赞同：0
> 
> 时间：2013-03-12T22:12:17.407
> 
> 标签：c#, asp.net, scriptmanager, modal-popup

我有一个模式弹出窗口，我想在函数开始时显示它。相反，它会在处理完函数后出现。

```
 protected void RadListView1_SelectedIndexChanged(object sender, EventArgs e)
    {
        string script = "function f(){$find(\"" + DisclaimerAlertWindow.ClientID + "\").show(); Sys.Application.remove_load(f);}Sys.Application.add_load(f);";
        ScriptManager.RegisterStartupScript(Page, Page.GetType(), "key", script, true);  

// other business logic
} 
```

如何在调用函数时显示 modalpopup？

# ruby-on-rails - 无论如何要访问 Rails 控制台中的连接表？

> ID：15373254
> 
> 赞同：8
> 
> 时间：2013-03-12T22:12:48.773
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我有两个模型 - `Question`, `Tag`.

我想对我的连接表`count`中的记录数做一个。`questions_tags`

如何从 Rails 控制台执行此操作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:19:24.383

假设您没有连接模型（只是一个连接表），您可以通过现有模型之一执行一些任意 SQL 以获取计数：

```
Question.connection.execute "select count(*) from questions_tags" 
```

这将为您提供一个依赖于 db 的结果对象。对于 PostgreSQL，要从中获取实际整数：

```
Question.connection.execute("select count(*) from questions_tags").first["count"].to_i 
```

# google-bigquery - Google Bigquery 命令行查询 - 意外错误

> ID：15373255
> 
> 赞同：0
> 
> 时间：2013-03-12T22:12:50.430
> 
> 标签：google-bigquery

我在通过命令行运行相当复杂的查询时遇到了麻烦，尽管通过 Web 界面运行它没有问题。命令行查询通过 Ruby 脚本中的系统调用运行。错误输出如下：

查询操作中的大查询错误：错误处理作业'123856490061：job_3794ad86856342dd9669aeb09a3da86c'：意外。请再试一次。

每天的数据都有自己的表格。我们最近通过添加 5 个新属性（不删除任何属性）来更改模式，并且此查询确实在具有旧模式和新模式的多个表中运行。

到目前为止，我们一直在使用完全相同格式的查询，没有问题，但是模式应该是兼容的，所以这不应该是问题。此外，查询确实通过 Web 界面工作，所以我们不知道为什么它不能通过命令行工作。

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T16:24:08.513

我遇到了同样的问题，并意识到我使用的是双引号 (")，它在浏览器中有效，但在 CLI 中无效。请改用单引号 (')。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-14T06:11:39.440

很遗憾，您在 BigQuery 中遇到了内部错误 - 我们会尽快修复此问题！

您的问题的解决方法是在查询作业上设置 preserveNulls 标志。有关此标志的更多详细信息，请参见此处：

[https://groups.google.com/forum/#!topic/bigquery-announce/yceNSKytd9o/discussion](https://groups.google.com/forum/#!topic/bigquery-announce/yceNSKytd9o/discussion)

Web 界面会自动设置此标志，新版本的 bq 也是如此，这就是升级到最新 CLI 版本可以解决问题的原因。

# python - 用python计算excel中的值

> ID：15373256
> 
> 赞同：1
> 
> 时间：2013-03-12T22:12:57.403
> 
> 标签：python, excel, printing, xlrd

我是 Python 的新手，我在这个问题上遇到了很多麻烦，这是我必须为工作做的事情。

关于 excel 文件的一些背景知识：有 3 列，大约 100 行。第一列 (col1) 包含 A 或 B。第二列 (col2) 包含从 1 到 10 的任何数字。第三列 (col3) 包含任何十进制数的值。

我希望程序做的是解析数据。col1 和 col2 将有许多重复项放在一起。例如，(A, 1) 可以位于第 1、5、20、98 行等。但 col3 将是不同的数字。因此，对于第三列中的那些不同数字，我希望它找到所有这些数字的平均值。

输出应如下所示：

```
A, 1 = avg 4.32
A, 2 = avg 7.23
A, 3 = avg -9.12
etc etc (until number 10)
B, 1 = avg 3.76
B, 2 = avg -8.12
B, 3 = avg 1.56
etc etc (until number 10) 
```

它不必按照完整的字母和数字顺序，它可以打印出它找到的第一个组合。但是到目前为止我已经在我的代码中完成了这个，并且由于某种原因它没有打印出所有组合，只有3个。

```
import xlrd #import package

#opening workbook and reading first sheet
book = xlrd.open_workbook('trend.xls')
sheet = book.sheet_by_index(0)

#function to hold unique combos
unique_combinations = {}

#looping through data
for row_index in range(sheet.nrows):
    #declaring what group equals to what row
    col1 = sheet.cell(row_index, 0)
    col2 = sheet.cell(row_index, 1)
    col3 = sheet.cell(row_index, 2)

    unique_combo = (col1.value, col2.value)

    if unique_combinations.has_key(unique_combo):
        unique_combinations[unique_combo].append(col3.value)
    else:
        unique_combinations[unique_combo] = [col3.value]

for k in unique_combinations.keys():
    l = unique_combinations[k]
    average = sum(l) / len(l)
    print '%s: %s Mean = %s' % (k[0], k[1], average) 
```

本质上，它基本上是 2 组，在 2 组中还有另外 10 组，在这 10 组中是属于那里的数字的平均值。

请帮忙！非常感谢你。

EXCEL 文件示例：

```
col1 | col2 | col3
A    |   1  | 3.12
B    |   9  | 4.12
B    |   2  | 2.43
A    |   1  | 9.54
B    |   8  | 2.43
A    |   2  | 1.08 
```

所以程序要做的就是看到它遇到的第一个组合是 A, 1 并且它将 3.12 存储在一个列表中，然后查看下一个并继续存储，直到它遇到与第四个重复的组合排。它也会存储该值。最后，输出将显示 A, 1 = avg (3.12 + 9.54 / 2)。此示例仅针对 A, 1 组合显示。但实际上，只有 2 个组（如示例），但 col2 的范围可以从 1 到 10。会有很多重复。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:10:24.347

试试[熊猫](http://pandas.pydata.org/)：

```
In [1]: import pandas as pd

In [2]: xls = pd.ExcelFile('test.xls')
   ...: df = xls.parse('Sheet1', header=None)
   ...: 

In [3]: df
Out[3]: 
   0  1     2
0  A  1  3.12
1  B  9  4.12
2  B  2  2.43
3  A  1  9.54
4  B  8  2.43
5  A  2  1.08

In [4]: groups = df.groupby([0,1])

In [5]: for k, g in groups:
   ...:     print k, g[2].mean()
   ...:     
(u'A', 1.0) 6.33  # your example (3.12 + 9.54) / 2
(u'A', 2.0) 1.08
(u'B', 2.0) 2.43
(u'B', 8.0) 2.43
(u'B', 9.0) 4.12 
```

如果您希望将所有手段作为一个列表，则完整的脚本将是：

```
import pandas as pd
df = pd.ExcelFile('test.xls').parse('Sheet1', header=None)
print [g[2].mean() for _, g in df.groupby([0,1])]
# out: [6.3300000000000001, 1.0800000000000001, 2.4300000000000002, 2.4300000000000002, 4.1200000000000001] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:17:05.030

这个建议更多的是“如何弄清楚发生了什么”，并且在答案中比在评论中更容易阅读。

我认为值得添加调试打印和异常处理。

我使用 OpenOffice 和 Python 2.7 尝试了该示例。如果在最后一个循环期间发生异常，并且如果我在测试运行中吞下了 stderr，我可以重现您的症状。例如：`python test.py 2>nul`

所以我建议你试试这个：

```
 import xlrd
    book = xlrd.open_workbook('trend.xls')
    sheet = book.sheet_by_index(0)
    unique_combinations = {}
    for row_index in range(sheet.nrows):
        col1 = sheet.cell(row_index, 0)
        col2 = sheet.cell(row_index, 1)
        col3 = sheet.cell(row_index, 2)

        unique_combo = (col1.value, col2.value)
        if unique_combinations.has_key(unique_combo):
            print 'Update: %r = %r' % (unique_combo, col3.value)
            unique_combinations[unique_combo].append(col3.value)
        else:
            print 'Add: %r = %r' % (unique_combo, col3.value)
            unique_combinations[unique_combo] = [col3.value]

    for k in unique_combinations.keys():
        l = unique_combinations[k]
        try:
          average = sum(l) / len(l)
          print '%s: %s Mean = %s' % (k[0], k[1], average)
        except Exception, e:
          print 'Ignoring entry[%r]==%r due to exception %r' % (k, l, e) 
```

这应该可以帮助您了解我们的“奇怪行为”。

# haskell - 如何在 Heist 的多个拼接中使用单个请求计算？

> ID：15373260
> 
> 赞同：1
> 
> 时间：2013-03-12T22:13:09.873
> 
> 标签：haskell, haskell-snap-framework, heist

假设我有一个带有两个自定义标签`<x/>`和`<y/>`. 每个标签都绑定到一个`Heist.Compiled.Splice`. `GET`现在，模板在针对特定路由的每个请求时呈现。我怎么`<x/>`能被一对的第一个值`<y/>`替换，被同一对的第二个值替换，但是返回该对的 IO 计算每个请求只运行一次（并且只在该路由上运行，而不是在每个路线，因为有些人根本不会使用模板）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T14:47:20.583

[您的问题与已编译拼接教程](http://snapframework.com/docs/tutorials/compiled-splices)中的 Person 示例非常相似。您需要创建一个将执行共享计算的父拼接。调用它`computeXY`。您的模板将如下所示：

```
<computeXY>
  <p>The first value is <x/>.</p>
  <p>The second value is <y/>.</p>
</computeXY> 
```

拼接将`computeXY`执行计算并使用[runChildrenWith](http://hackage.haskell.org/packages/archive/heist/0.11.1/doc/html/Heist-Interpreted.html#v%3arunChildrenWith)模式将计算的结果作为`<x/>`和`<y/>`标签提供给它的孩子。然而，runChildrenWith 模式与编译拼接的工作方式略有不同。以下是使用自编写教程以来添加的新 API 函数的实现方式：

```
import Blaze.ByteString.Builder.Char8 (fromText)
import Heist.Compiled

runtimeTupleComputation = return ("foo", "bar")

splices = [ ("x", fromText . fst)
          , ("y", fromText . snd)
          ]

computeXYSplice = withPureSplices runChildren splices runtimeTupleComputation 
```

# emacs - 水平拆分 emacs 窗口并将每个窗口保持在 [80] 个字符

> ID：15373263
> 
> 赞同：1
> 
> 时间：2013-03-12T22:13:20.077
> 
> 标签：emacs

当我运行时`C-x 3`，我想让每个生成的 emacs 窗口宽 80 个字符（我的默认值），使总 emacs 框架宽 80 个字符。默认行为是将窗口拆分为两个较小的窗口。

我正在使用 emacs 术语，其中“框架”是您通常在 GUI 中称为“窗口”的内容。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:38:04.580

你可能想做类似的事情

```
 (defun layout-for-cobol ()
   "Lay out the frame as two 80-column windows across"
   (interactive)
   (when window-system
     (require 'frame-cmds)
     (set-frame-width (selected-frame) 160)
     (with-selected-window (get-mru-window)
       (delete-other-windows)
       (split-window-right 80)))) 
```

`frame-cmds.el`可以在[http://www.emacswiki.org/cgi-bin/wiki/frame-cmds.el找到](http://www.emacswiki.org/cgi-bin/wiki/frame-cmds.el)

您可以使用`M-x layout-for-cobol`（或选择更好的名称☺）来调用它，也可以`(when window-system (global-set-key (kbd "C-x 3") 'layout-for-cobol))`在`.emacs`文件中绑定它。

（`(when window-system …)`当您尝试调整终端模式 Emacs 的大小时，这些表单会抑制错误消息。）

# python - 在谷歌应用引擎 SDK 中使用更新版本的 api python 客户端

> ID：15373267
> 
> 赞同：0
> 
> 时间：2013-03-12T22:13:33.193
> 
> 标签：python, google-app-engine, google-api-python-client

我正在使用 Google App Engine python SDK，现在我遇到了一个问题：

My App Engine SDK 版本为 1.7.5，其中包含 1.0beta 版 google api python 客户端。但是 myproject 需要参考 1.1 版的 google api python 客户端。我几乎尝试了所有方法，但找不到解决方案。有谁知道我该如何解决这个问题？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:43:39.673

与 SDK 一起打包的版本不是您的项目将使用的版本。该版本仅用于 SDK，甚至不适用于生产 App Engine 应用程序。

正如`google-api-python-client` [文档](https://developers.google.com/api-client-library/python/start/installation#appengine)所说：

> 由于[Google App Engine](https://developers.google.com/appengine/)要求库的所有源文件都必须存在于您的 App Engine 项目中，因此 App Engine 有一个特殊的安装过程。要在 App Engine 项目中安装库及其所有依赖项，请下载`google-api-python-client-gae-N.M.zip`从[下载列表](http://code.google.com/p/google-api-python-client/downloads/list)命名的文件，其中`N.M`是最新版本的版本号。将该文件解压缩到您的项目中。例如：
> 
> `$ cd myproject`
> `$ unzip google-api-python-client-gae-1.0.zip`

# ruby-on-rails - 尝试安装 mysql2 gem，捆绑安装期间出现 CertificateFailureError

> ID：15373272
> 
> 赞同：0
> 
> 时间：2013-03-12T22:13:50.997
> 
> 标签：ruby-on-rails, bundler

```
Jason-Kim-MacBook-Pro:composer jkim$ bundle install
Fetching gem metadata from https://rubygems.org/.........
Fetching gem metadata from https://rubygems.org/.
Fetching source index from https://rubygems.org/
Resolving dependencies...

Bundler::Fetcher::CertificateFailureError: Could not verify the SSL certificate for https://rubygems.org/.
There is a chance you are experiencing a man-in-the-middle attack, but most likely your system doesn't have the CA certificates needed for verification. For information about OpenSSL certificates, see bit.ly/ssl-certs. To connect without using SSL, edit your Gemfile sources and change 'https' to 'http'.
An error occurred while installing rake (10.0.3), and Bundler cannot continue.
Make sure that `gem install rake -v '10.0.3'` succeeds before bundling. 
```

我的 gemfile 包括`gem "mysql2"`.

我是 OS X Lion，使用 Ruby 1.8.7。Rails 是 3.2.12。

我安装了 rake 顺便说一句。

```
Jason-Kim-MacBook-Pro:composer jkim$ gem install rake -v '10.0.3'
Successfully installed rake-10.0.3
1 gem installed
Installing ri documentation for rake-10.0.3...
Installing RDoc documentation for rake-10.0.3... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:59:08.253

仍然不知道到底是什么问题，但我通过不使用 https 来修复它。

在您的 gemfile 中，将源更改为`source 'http://rubygems.org'`

# azure - Azure 存储表 - 无法添加用户定义的属性/字段

> ID：15373275
> 
> 赞同：2
> 
> 时间：2013-03-12T22:14:03.533
> 
> 标签：azure, azure-table-storage

我已经开始使用 Microsoft Windows Azure 存储表。一切似乎都正常——我可以创建表并插入行，但有一个问题——我似乎无法插入除预定义行键字段之外的任何内容的行，即“PartitionKey”、“RowKey”、和“时间戳”。

在下面的示例代码中，这只是 MVC 应用程序中最简单的“Hello World”（我唯一添加的是控制器），输出显示预期值在分区键和行键中，但是我试图插入的“测试字段”仍然是空的。

在调试器中单步执行代码时，我可以看到我尝试设置的测试字段的名称和值在第一个 table.Execute() 发生时就位。但由于某种原因，它实际上并没有进入表格。

非常感谢任何帮助。

```
using System;
using System.Configuration;
using Microsoft.WindowsAzure.Storage;
using Microsoft.WindowsAzure.Storage.Table;
using System.Web.Mvc;

namespace HelloWorldApp.Controllers
{
    public class TestEntity : TableEntity
    {
        public string TestField;

        public TestEntity() { }

        public TestEntity(string partitionKey, string rowKey, string testField)
        {
            PartitionKey = partitionKey;
            RowKey = rowKey;

            TestField = testField;
        }
    }

    public class HomeController : Controller
    {
        public string Index()
        {
            CloudStorageAccount storageAccount = CloudStorageAccount.Parse(ConfigurationManager.ConnectionStrings["StorageConnectionString"].ConnectionString);

            if (storageAccount == null)
                return "Storage Account is Null";

            CloudTableClient tableClient = storageAccount.CreateCloudTableClient();
            if (tableClient == null)
                return "Table Client is Null";

            CloudTable table = tableClient.GetTableReference("TestTable");
            if (table == null)
                return "Table is Null";

            table.CreateIfNotExists();

            var entity = new TestEntity("MyTestPartitionKey", "MyTestRowKey", "MyTestMessage");

            var doInsert = TableOperation.Insert(entity);

            if (doInsert == null)
                return "Insert Operation is Null";

            // In debugger, I have confirmed that doInsert does include the field TestField="MyTestMessage", yet it doesn't seem to find its way into the table.
            table.Execute(doInsert);

            var doRetrieve = TableOperation.Retrieve<TestEntity>("MyTestPartitionKey", "MyTestRowKey");

            TableResult retrievedResult = table.Execute(doRetrieve);

            if (retrievedResult == null)
                return "Retrieved no rows";

            string retPartitionKey = ((TestEntity) retrievedResult.Result).PartitionKey;
            string retRowKey = ((TestEntity) retrievedResult.Result).RowKey;
            string retTestMessage = ((TestEntity) retrievedResult.Result).TestField;

            return String.Format("Partition: {0}, Row: {1}, TestMessage {2}, remember to delete table.", retPartitionKey, retRowKey, retTestMessage);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T00:35:46.440

您是否尝试使用 get;set; 将 TestField 转换为属性？

为您的 TestEntity 尝试此代码：

```
public class TestEntity : TableEntity
    {
        public string TestField { get; set; }

        public TestEntity() { }

        public TestEntity(string partitionKey, string rowKey, string testField)
        {
            PartitionKey = partitionKey;
            RowKey = rowKey;

            TestField = testField;
        }
    } 
```

# php - Wordwrap 将发出链接 src 和 img src

> ID：15373276
> 
> 赞同：0
> 
> 时间：2013-03-12T22:14:05.347
> 
> 标签：php

```
<?=$postcontent = wordwrap($qry_post['content'], 67, "<br />", true);?> 
```

如果内容中有一个长链接或一个大代码，它会在某个部分停止它，并且由于src 代码
中的新行 / 将导致一个 html 实体。

有任何解决这个问题的方法吗？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:18:58.897

在[手册`wordwrap()`](http://www.php.net/manual/en/function.wordwrap.php#59257)的评论中，有人发布了一个代码片段来解决这个问题：

```
<?php 
    function textWrap($text) { 
        $new_text = ''; 
        $text_1 = explode('>',$text); 
        $sizeof = sizeof($text_1); 
        for ($i=0; $i<$sizeof; ++$i) { 
            $text_2 = explode('<',$text_1[$i]); 
            if (!empty($text_2[0])) { 
                $new_text .= preg_replace('#([^\n\r .]{25})#i', '\\1  ', $text_2[0]); 
            } 
            if (!empty($text_2[1])) { 
                $new_text .= '<' . $text_2[1] . '>';    
            } 
        } 
        return $new_text; 
    } 
?> 
```

# perl - DBIx::Class 边界搜索

> ID：15373280
> 
> 赞同：2
> 
> 时间：2013-03-12T22:14:23.163
> 
> 标签：perl, dbix-class

我正在尝试使用 DBIx::Class 进行周边搜索，但到目前为止还没有成功。

我想生成的 SQL 如下所示：

```
SELECT 
    zip,
    6371 * ACos( Cos(RADIANS(Lat)) * Cos(RADIANS(USERLAT)) * Cos(RADIANS(USERLNG) - RADIANS(Lng)) + Sin(RADIANS(Lat)) * Sin(RADIANS(USERLAT)) ) AS Distance
FROM 
    geopc
WHERE 
    6371 * ACos( Cos(RADIANS(Lat)) * Cos(RADIANS(USERLAT)) * Cos(RADIANS(USERLNG) - RADIANS(Lng)) + Sin(RADIANS(Lat)) * Sin(RADIANS(USERLAT)) ) <= DISTANCE
ORDER BY 
    Distance 
```

其中 USERLAT、USERLNG 和 DISTANCE 应该是变量，它们将通过 Webrequest 进入。

我的 DBIx::Class 结果：

```
use utf8;
package MyApp::Models::Schema::Result::Geopc;

use strict;
use warnings;

use base 'DBIx::Class::Core';

__PACKAGE__->table("geopc");

__PACKAGE__->add_columns(
  "id",
  { data_type => "bigint", is_nullable => 0, is_auto_increment => 1 },
  "country",
  { data_type => "varchar", is_nullable => 0, size => 2 },
  "language",
  { data_type => "varchar", is_nullable => 0, size => 2 },
  "iso2",
  { data_type => "varchar", is_nullable => 0, size => 6 },
  "region1",
  { data_type => "varchar", is_nullable => 0, size => 60 },
  "region2",
  { data_type => "varchar", is_nullable => 0, size => 60 },
  "region3",
  { data_type => "varchar", is_nullable => 0, size => 60 },
  "region4",
  { data_type => "varchar", is_nullable => 0, size => 60 },
  "zip",
  { data_type => "varchar", is_nullable => 0, size => 10 },
  "city",
  { data_type => "varchar", is_nullable => 0, size => 60 },
  "area1",
  { data_type => "varchar", is_nullable => 0, size => 80 },
  "area2",
  { data_type => "varchar", is_nullable => 0, size => 80 },
  "lat",
  { data_type => "double precision", is_nullable => 0 },
  "lng",
  { data_type => "double precision", is_nullable => 0 },
  "tz",
  { data_type => "varchar", is_nullable => 0, size => 30 },
  "utc",
  { data_type => "varchar", is_nullable => 0, size => 10 },
  "dst",
  { data_type => "varchar", is_nullable => 0, size => 1 },
);
__PACKAGE__->set_primary_key('id'); 
```

我用谷歌搜索，但没有找到处理这个问题的好方法。任何帮助将不胜感激。

我正在使用 MySQL ...

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T07:39:52.367

我有同样的问题：我有`companies`which `belongs_to` `address`，所以一个地址`has_many` `companies`- 我需要找到邻居公司，所以，使用`Adress`模型：

```
__PACKAGE__->add_columns(
  "id",
  { data_type => "integer", is_auto_increment => 1, is_nullable => 0 },
  "country",
  { data_type => "varchar", is_nullable => 0, size => 64 },
  "county",
  { data_type => "varchar", is_nullable => 1, size => 45 },
  "city",
  { data_type => "varchar", is_nullable => 0, size => 64 },
  "street",
  { data_type => "varchar", is_nullable => 0, size => 128 },
  "street_no",
  { data_type => "varchar", is_nullable => 1, size => 24 },
  "apartment_no",
  { data_type => "varchar", is_nullable => 1, size => 24 },
  "extra",
  { data_type => "varchar", is_nullable => 1, size => 128 },
  "lat",
  { data_type => "decimal", is_nullable => 1, size => [10, 7] },
  "long",
  { data_type => "decimal", is_nullable => 1, size => [10, 7] },
); 
```

我已经`get_neighbour_companies`在该模型中实现了该方法：

```
sub get_neighbour_companies{
  my ( $self, $args ) = @_;

  my $distance = $args->{distance} // 15;

  my $geo_clause = sprintf('( 6371 * acos( cos( radians(%s) ) * cos( radians( me.lat ) ) * cos( radians( me.`long` ) - radians(%s) ) + sin( radians(%s) ) * sin( radians( me.lat ) ) ) ) AS distance', $self->lat, $self->long, $self->lat );

  my $rs = $self->result_source->schema->resultset('Address')
    ->search_rs(
      {
        'companies.company_type_id' => ( $args->{company_type_id} // 1 ), #defaults to 'orderer' type
      },
      {
        prefetch => { 'companies' => 'address' },
        select => [ 'id', \$geo_clause ],
        as     => [qw/ id distance /],
        having => { distance => { '<=' => $distance } },
        order_by => 'distance',
      }
    );

  my @companies;
  while ( my $address = $rs->next ){
    my @comps = $address->companies()->all;
    next unless @comps;

    foreach my $company ( @comps ) {
        push @companies, {
            company => $company,            
            distance => $address->get_column('distance'),
          };
    }    
  };
  return [ @companies ]; 
} 
```

我这样使用它：

```
my $customers = $comp->address->get_neighbour_companies({
          distance        => 12,
          company_type_id => 1,
        }); 
```

where将是12 公里范围内`$customers`的列表的数组引用，这也是`companies``$comp``company`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:28:58.600

此类复杂查询的一种解决方案是将它们定义为[视图](https://metacpan.org/module/ABRAXXA/DBIx-Class-0.08209/lib/DBIx/Class/Manual/Cookbook.pod#Arbitrary-SQL-through-a-custom-ResultSource)。如果您定义了与它的关系，那么它的优点是可以连接和预取。

另一个将[列](https://metacpan.org/module/DBIx%3a%3aClass%3a%3aResultSet#columns)用于计算的“距离”列。'columns' 只是 'select' 和 'as' 参数的组合，它已被证明是一个更强大的 api，可以减少用户错误。请注意，搜索语法来自[SQL::Abstract](https://metacpan.org/module/SQL%3a%3aAbstract)，它提供了一些使用[文字 sql](https://metacpan.org/module/SQL%3a%3aAbstract#Literal-SQL-and-value-type-operators)的方法。

没有子查询的最佳解决方案是：

```
my $param = \[
        '6371 * ACos( Cos(RADIANS(Lat)) * Cos(RADIANS(?)) * Cos(RADIANS(?)' .
        ' - RADIANS(Lng)) + Sin(RADIANS(Lat)) * Sin(RADIANS(?)) )'
        [ USERLAT  => $USERLAT ],
        [ USERLNG  => $USERLNG ],
        [ USERLAT  => $USERLAT ],
    ];

my $geopc = $schema->resultset('Result::Geopc')->search({
        $param => { '<=', $distance },
    }, {
        columns => [
           'zip',
           { distance => $param }
        ],
        order_by => $param,
    }); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-13T12:37:49.703

您可以重写查询以使用如下子查询：

```
SELECT zip, Distance
FROM (SELECT zip,
        6371 * ACos( Cos(RADIANS(Lat)) * Cos(RADIANS(USERLAT)) * Cos(RADIANS(USERLNG) - RADIANS(Lng)) + Sin(RADIANS(Lat)) * Sin(RADIANS(USERLAT)) )
        AS Distance
     FROM geopc) AS tmp
WHERE Distance <= DISTANCE
ORDER BY Distance 
```

然后像下面这样的东西应该工作：

```
my $geopc = $schema->resultset('Result::Geopc');

my $subquery = $geopc->search({}, {
    select => [
        'zip',
        \[
            '6371 * ACos( Cos(RADIANS(Lat)) * Cos(RADIANS(?)) * Cos(RADIANS(?)' .
            ' - RADIANS(Lng)) + Sin(RADIANS(Lat)) * Sin(RADIANS(?)) )' .
            ' AS Distance',
            [ USERLAT  => $USERLAT ],
            [ USERLNG  => $USERLNG ],
            [ USERLAT  => $USERLAT ],
        ],
    ],
})->as_query;

my $rs = $geopc->search({
    Distance => { '<=' => $DISTANCE },
}, {
    alias => 'geopc2',
    from => [
        { geopc2 => $subquery },
    ],
    select => [ qw(zip Distance) ],
    order_by => 'Distance',
}); 
```

这种方法使用带有占位符和未记录的 ResultSet 属性的[文字 SQL](https://metacpan.org/module/SQL%3a%3aAbstract#Literal-SQL-with-placeholders-and-bind-values-subqueries)`from`。`from`可以在[DBIx::Class 测试套件](https://github.com/dbsrgits/dbix-class/blob/master/t/search/subquery.t)中找到该属性的一些使用示例。请注意，由于此属性未记录在案，因此未来版本可能不支持它。

# android - Android 中的虚拟联系人

> ID：15373285
> 
> 赞同：0
> 
> 时间：2013-03-12T22:14:33.587
> 
> 标签：android, contacts

### 关于 Android 中虚拟联系人的简短问题。

是否有可能有一个 Android 服务应用程序（后台进程）能够即时向联系人应用程序提供联系人。

此外，能够在搜索结果中提供这些虚拟联系人。

我的想法是通过在联系人搜索期间提供来自网络的动态联系人来扩展联系人应用程序。

这可能吗。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:28:16.593

“纯 Google”版本的 Android（例如 Nexus 4）上的人脉应用程序不支持此功能。联系人必须位于联系人提供程序中的*某个*位置。当然，您可以拥有自己的帐户类型并将网络上某处的联系人同步到联系人提供程序，然后联系人将被视为与从 Google 联系人网络应用程序添加的联系人相同。

您提议的应用程序可能没有您想象的那么有用。当设备没有连接时会发生什么？如果您将联系人同步到设备，则它们始终可用。当然，“云”很棒；您只需要问自己，纯云是否有用。

# python - Python 使用 IPv6 地址解析主机名

> ID：15373288
> 
> 赞同：7
> 
> 时间：2013-03-12T22:14:39.547
> 
> 标签：python, dns, ipv6

我想知道是否有一种方法可以使用 python 来解析仅在 ipv6 中解析的主机名和/或在 ipv4 和 ipv6 中都解析的主机名？

`socket.gethostbyname()`并且`socket.gethostbyname_ex()`不适用于 ipv6 分辨率。

一种虚拟的方法是运行实际的 linux 主机命令并解析结果。有没有更好的方法来做到这一点？

谢谢，

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-03-12T22:17:33.523

[socket.getaddrinfo](http://docs.python.org/2/library/socket.html#socket.getaddrinfo)支持 IPv6。您只需设置`family`为`AF_INET6`.

```
socket.getaddrinfo("example.com", None, socket.AF_INET6) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-11-04T18:37:25.500

**我想更详细地扩展@john-colanduoni 的答案。**

# 仅获取 IPv6 地址

要真正获得相应的 IPv6 地址，您应该尝试*使用*[socket.getaddrinfo](https://docs.python.org/3.8/library/socket.html#socket.getaddrinfo)。

```
>>> print(socket.getaddrinfo('www.microsoft.com', None, socket.AF_INET6)[0][4][0])
2a02:26f0:6a:288::356e 
```

但请注意，例如，如果主机名没有 IPv6 AAAA-Record，例如：

```
>>> print(socket.getaddrinfo('microsoft.com', None, socket.AF_INET6)[0][4][0])
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/usr/lib/python3.7/socket.py", line 748, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
socket.gaierror: [Errno -2] Name or service not known 
```

你会得到`socket.gaierror: [Errno -2] Name or service not known`哪个是[OSError](https://docs.python.org/3.8/library/socket.html#socket.gaierror)的子类。

顺便提一句。尝试使用`localhost`,`hostname`您的计算机（如果启用 IPv6）或`example.com`作为主机名参数。

# 从 IPv6 地址获取主机名

PTR-Record 的查询如下所示：

```
>>> print(socket.gethostbyaddr('2a00:1450:4001:81d::200e')[0])
fra15s18-in-x0e.1e100.net 
```

因为[socket.gethostbyaddr](https://docs.python.org/3.8/library/socket.html#socket.gethostbyaddr)同时启用了 IPv4 和 IPv6。

# php - SQL 错误 1064。语句在 mysqladmin 中有效，但在 PHP 脚本中无效

> ID：15373291
> 
> 赞同：0
> 
> 时间：2013-03-12T22:14:43.040
> 
> 标签：php, mysql, sql-like

我在我们网站的管理员端安装了一个 PHP 脚本，它应该允许我们运行 SQL 查询。但是，在我们的主机公司的 OPS 页面上通过 mysqladmin 运行它时，我没有得到相同的结果。

**当我提交时：**

```
SELECT orders_id FROM `orders_status_history` WHERE `comments` LIKE '%12345%' 
```

我在 mysqladmin 中得到一个结果（我的测试记录）。所以它是成功的。

**但是，当我通过 PHP 程序提交它时，我得到：**

```
MySQL error 1064: You have an error in your SQL syntax;
check the manual that corresponds to your MySQL server version for the right syntax to use near '\'%12345%\'' at line 1

While executing:

SELECT orders_id FROM `orders_status_history` WHERE `comments` LIKE \'%12345%\' 
```

我假设通过 PHP 提交时语法是不同的，但我一辈子都无法弄清楚它应该是什么。我尝试在单引号前加上斜线。我试过双引号。我花了几个小时在网上冲浪。我已经尝试了很多东西，我什至不能再把它们弄直了。我假设这很简单。谁能指出我正确的方向？

这是来自 php 程序的代码。用户将 SQL 查询粘贴到文本区域并点击 SEND 按钮。同样，*完全相同的*查询在 mysqladmin 中有效，但在使用此 PHP 程序时无效：

```
<?php
/*
  $Id: sql_interface.php,v 1.00 2004/08/13 00:28:44 draven Exp $
*/

  require('includes/application_top.php');
  $text_heading = INITIAL_TITLE;

    function sqlquery($query) {
    $result = mysql_query($query);
    global $query_result;
      if (mysql_errno()) {
        $query_result = "MySQL error ".mysql_errno().": ".mysql_error()."\n\nWhile executing:\n\n$query\n------------------------------------------------------------------------------------------\n\n";
      } else {
        $query_result = "Your query was successful!\nRows Affected: " . mysql_affected_rows();
      }
    return $result;
  }

  $action = (isset($HTTP_GET_VARS['action']) ? $HTTP_GET_VARS['action'] : '');

  if (isset($HTTP_POST_VARS['action']) && ($HTTP_POST_VARS['action'] == 'process')) {
    sqlquery($HTTP_POST_VARS['query_entry']);
    $text_heading = POST_QUERY_TITLE;
    $tryagain = TRY_AGAIN_TEXT;
  }
?>
<!doctype html public "-//W3C//DTD HTML 4.01 Transitional//EN">
<html <?php echo HTML_PARAMS; ?>>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=<?php echo CHARSET; ?>">
<title><?php echo HEADING_TITLE; ?></title>
<link rel="stylesheet" type="text/css" href="includes/stylesheet.css">
<script language="javascript" src="includes/general.js"></script>
</head>
<body marginwidth="0" marginheight="0" topmargin="0" bottommargin="0" leftmargin="0" rightmargin="0" bgcolor="#FFFFFF">
<!-- header //-->
<?php require(DIR_WS_INCLUDES . 'header.php'); ?>
<!-- header_eof //-->

<!-- body //-->
<table border="0" width="100%" cellspacing="2" cellpadding="2">
  <tr>
    <td width="<?php echo BOX_WIDTH; ?>" valign="top"><table border="0" width="<?php echo BOX_WIDTH; ?>" cellspacing="1" cellpadding="1" class="columnLeft">
<!-- left_navigation //-->
<?php require(DIR_WS_INCLUDES . 'column_left.php'); ?>
<!-- left_navigation_eof //-->
    </table></td>
<!-- body_text //-->
    <td width="100%" valign="top"><table border="0" width="100%" cellspacing="0" cellpadding="2"><?php echo tep_draw_form('sql_interface', 'sql_interface.php', 'post') . tep_draw_hidden_field('action', 'process'); ?>
      <tr>
        <td><table border="0" width="100%" cellspacing="0" cellpadding="0">
          <tr>
            <td class="pageHeading" colspan="3"><?php echo HEADING_TITLE; ?></td>
          </tr>
        </table></td>
      </tr>
      <tr>
        <td><table border="0" width="100%" cellspacing="0" cellpadding="0">
          <tr>
            <td valign="top"><table border="0" width="100%" cellspacing="0" cellpadding="2">
                  <tr>
                    <td class="main" colspan="3"><?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?></td>
                  </tr>
                  <tr>
                    <td class="main" colspan="2"><?php echo '<b>' . $text_heading . ':</b>'; ?></td>
                    <td class="main" align="right" colspan="1"><i><?php echo $tryagain; ?></i></td>
                  </tr>
                  <tr>
                    <td class="main" colspan="3"><?php echo tep_draw_textarea_field('query_entry', '', 137, 30, $query_result, '', false); ?></td>
                  </tr>
                  <tr>
                    <td class="main" colspan="3"><?php echo tep_draw_separator('pixel_trans.gif', '1', '10'); ?></td>
                  </tr>
              <tr>
                <td width="10"><?php echo tep_draw_separator('pixel_trans.gif', '10', '1'); ?></td>
                <td colspan="2"align="right"><?php echo tep_image_submit('button_send.gif', IMAGE_BUTTON_EXECUTE_SQL) . tep_draw_separator('pixel_trans.gif', '10', '1'); ?></form></td>
              </tr>
              <tr>
                <td class="smallText" colspan="3">&nbsp;</td>
              </tr>
            </table></td>
          </tr>
        </table></td>
      </tr>
    </table></td>
<!-- body_text_eof //-->
  </tr>
</table>
<!-- body_eof //-->

<!-- footer //-->
<?php require(DIR_WS_INCLUDES . 'footer.php'); ?>
<!-- footer_eof //-->
<br>
</body>
</html>
<?php require(DIR_WS_INCLUDES . 'application_bottom.php'); ?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:17:06.320

我不确定您是否应该在该特定查询中转义单引号，因为我不确定您使用的确切 php 代码是什么。

```
$query = "SELECT orders_id FROM orders_status_history WHERE comments LIKE '%12345%'"; 
```

那会很好用。如果您正在这样做，您只需要逃避它们：

```
$query = 'SELECT orders_id FROM orders_status_history WHERE comments like \'%12345%\''; 
```

如果这不能解决您的问题，请发布相关的 php 代码。

编辑：尝试在查询中使用 stripslashes()，并查看[mysql_real_escape_string() 在 MySQL 中留下斜杠](https://stackoverflow.com/questions/173212/mysql-real-escape-string-leaving-slashes-in-mysql)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-30T18:20:57.107

如果上述答案对任何人都不起作用，请检查所有默认值是否与数据类型匹配，并且所有值都设置为数据库类型。我的一个没有设置为 InnoDB，所以它不起作用，但它没有返回任何错误！

# javascript - 如何使用 jquery 将 CSS 添加到元素中，并且只有一个类来标识元素，并且仅当 innerHTML 中的时间在现在的 5 分钟内？

> ID：15373292
> 
> 赞同：0
> 
> 时间：2013-03-12T22:14:48.817
> 
> 标签：javascript, jquery, html, mediawiki

我有以下 HTML：

```
<td class="mw-enhanced-rc">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;18:10&nbsp;</td> 
```

我想使用 JavaScript 使时间变粗。

```
$('td[class^="mw-enhanced-rc"]').each(function() {
    this.style = this.style.fontWeight="bold";
} 
```

↑ 不工作，我该如何解决？

那么，如何使我的页面仅在页面呈现时当前时间的一分钟内应用特殊格式？[我在http://en.wikipedia.org/wiki/User:Technical_13/common.js](http://en.wikipedia.org/wiki/User:Technical_13/common.js)上看到的代码：

```
/* Refresh my WatchList page when viewing every minute */
if (document.location.href == "http://en.wikipedia.org/wiki/Special:Watchlist") {
    setTimeout(function(){location = ''},60000);
    var timeNow = new Date();
    var minNow = timeNow.getMinutes();
    var minNow = minNow - 5;
    timeNow.setMinutes(minNow);
    var postTime = $('td.mw-enhanced-rc').html();
    for (i=0;i<6;i++) {var postTime = postTime.replace('&nbsp;', '');}
    var postTime = postTime.replace('<span class="mw-enhancedchanges-arrow-space"></span>', '');
    var postTime = postTime.replace('<abbr class="newpage" title="This edit created a new page">N</abbr>', '');
    var postTime = postTime.replace('<abbr class="minoredit" title="This is a minor edit">m</abbr>', '');
    var postTime = postTime.replace('<abbr class="botedit" title="This edit was performed by a bot">b</abbr>', '');
    var postTime = postTime.replace('<abbr class="unpatrolled" title="This edit has not yet been patrolled">!</abbr>', '');
    var postTime = postTime.split(':', '2');
    var postHour = postTime[0];
    var postMin = postTime[1];
    var timePost = new Date();
    timePost.setHours(postHour);
    timePost.setMinutes(postMin);
    if (timePost >= timeNow) {
        $('td.mw-enhanced-rc').css({
            fontWeight: 'bold',
            fontSize: '12pt'
        });
    }
} 
```

↑ 不工作，我该如何解决？我什至尝试添加：

```
var timePost = timePost.getTime();
var timeNow = timeNow.getTime(); 
```

就在最后的条件 if 语句之前，它没有帮助。变得沮丧...

我还创建了一个[JSfiddle](http://jsfiddle.net/ShoeMaker/z8vhp/3/)来处理它。

编辑：啊哈！看起来我的条件语句正在工作，但它只评估页面上的第一个实例！然后它将 应用于`$('td.mw-enhanced-rc').css({fontWeight: 'bold', fontSize: '12pt'});`所有 div 元素，而不仅仅是具有符合条件的 innerHTML 的元素。谁能帮我改进一下，只更改符合条件的 div 元素的 css（可能通过注入 style= 属性）？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:17:47.233

您可以通过执行以下操作来简化它：

```
$('td.mw-enhanced-rc').css({fontWeight: 'bold'}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:21:41.920

由于您的表达，您的代码不起作用：

`this.style = this.style.fontWeight="bold";`

这个表达式必须是这样的：

`this.style.fontWeight = "bold";`

您已经在使用 jQuery（或 Zepto），因此您可以使用 css() 方法

```
$('td[class^="mw-enhanced-rc"]').each(function() {
    $(this).css('fontWeight', 'bold');
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:18:44.720

尝试类似：

```
$('td.mw-enhanced-rc').each(function()
   {
      this.style.fontWeight = "bold";
   }
); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T15:43:28.610

回答问题的所有部分并努力完成我正在寻找的解决方案代码是：

```
var timeNow = new Date();
var minNow = timeNow.getMinutes();
var minNow = minNow - 5;
timeNow.setMinutes(minNow);
var postTime = $('td.mw-enhanced-rc').html();
for (i=0;i<6;i++) {var postTime = postTime.replace('&nbsp;', '');}
var postTime = postTime.replace('<span class="mw-enhancedchanges-arrow-space"></span>', '');
var postTime = postTime.replace('<abbr class="newpage" title="This edit created a new page">N</abbr>', '');
var postTime = postTime.replace('<abbr class="minoredit" title="This is a minor edit">m</abbr>', '');
var postTime = postTime.replace('<abbr class="botedit" title="This edit was performed by a bot">b</abbr>', '');
var postTime = postTime.replace('<abbr class="unpatrolled" title="This edit has not yet been patrolled">!</abbr>', '');
var postTime = postTime.split(':', '2');
var postHour = postTime[0];
var postMin = postTime[1];
var timePost = new Date();
timePost.setHours(postHour);
timePost.setMinutes(postMin);
var timePost = timePost.getTime();
var timeNow = timeNow.getTime();
if (timePost >= timeNow) {
    var enhRC = $('td.mw-enhanced-rc').html();
    $('td[class^="mw-enhanced-rc"]').each(function() {
        this.innerHTML = this.innerHTML.replace(enhRC, '<span style="font-weight: bold; font-size: 12pt;">' + enhRC + '</span>');
    });
} 
```

# php - Excel - 将一种时间格式转换为另一种时间格式

> ID：15373295
> 
> 赞同：0
> 
> 时间：2013-03-12T22:14:49.720
> 
> 标签：php, sql, excel, filemtime

我正在尝试通过 SQL 导入将数据从一个应用程序迁移到另一个应用程序，而我正处于获取输入日期的最后一步。我遇到的困难是日期格式有些奇怪。

示例如下... 1360938606 1360938612 1360938607 1360938607

在新申请中，日期格式如下：0000-00-00 00:00:00

有没有办法可以将原始格式转换为 Excel 中的这种新格式？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:20:47.573

看起来像马克提到的unix时间戳广告......这实际上是非常标准的。您可以使用`strftime`from php 将其转换为您想要的字符串格式：

`$time = strftime('%F %T', (int) $thevalue)`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T03:22:25.543

你也可以试试这个：

```
$newdateformat = date('Y-m-d H:i:s', $oldtimestamp); 
```

参考[http://php.net/manual/en/function.date.php](http://php.net/manual/en/function.date.php)

# java - 将图片与白色混合

> ID：15373300
> 
> 赞同：2
> 
> 时间：2013-03-12T22:15:02.477
> 
> 标签：java, colors, blending

```
public class BlendablePicture extends Picture {
    public BlendablePicture(String filename) {
        super(filename);
    }

    public void blendRectWithWhite(int xMin, int yMin, int xMax, int yMax,
            double a) {
        int x;
        x = xMin;
        while (x <= xMax) {
            int y;
            y = yMin;
            while (y <= yMax) {
                Pixel refPix = this.getPixel(x, y);
                refPix.setRed((int) Math.round(refPix.getRed() * (1.0 + a)));
                refPix.setGreen((int) Math.round(refPix.getGreen() * (1.0 + a)));
                refPix.setBlue((int) Math.round(refPix.getBlue() * (1.0 + a)));

                y = y + 1;
            }
        }
    }
} 
```

我需要将白色与像素混合，但这段代码只是让一切变得更亮！它需要看起来像这样：

![混合白色 - 插图](../Images/e160f414491e0026123c9458acb5b738.png)

对此代码的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:25:06.960

代替

`refPix.setRed ( (int) Math.round (refPix.getRed () * (1.0+ a) ));`

尝试类似的东西

`refPix.setRed ( (int) Math.round (refPix.getRed()*(1.0-a)+255*a ));`

当 a = 1.0 时，你得到 R*0.0+255*1.0 = 255

当 a = 0.0 时，你得到 R*1.0+255*0.0 = R

当 a = 0.5 时，你得到 R*0.5+255*0.5（一半一半）

这适用于任何颜色，而不仅仅是白色，您只需将红色、绿色和蓝色的 255 替换为您想要与之混合的颜色，您就可以获得 RGB 平均混合。

# python - 在 Haystack 搜索中排除对象而不需要 update_index

> ID：15373305
> 
> 赞同：5
> 
> 时间：2013-03-12T22:15:15.207
> 
> 标签：python, django, django-haystack

我需要 Haystack 搜索来排除一些具有 value 的对象，`published=False`到目前为止我管理它的方式是添加`exclude(published=True)`如下：

```
class MymodelIndex(indexes.RealTimeSearchIndex, indexes.Indexable):
    def get_queryset(self):
        return Mymodel.objects.all().exclude(published=False) 
```

它按预期工作，问题是`./manage.py rebuild_index`每次将新对象添加到数据库时我都需要这样做，这很糟糕。

我怎样才能在不需要运行其他任何东西的情况下做到这一点？

笔记：

Haystack 上的索引适用于许多模型，因此如下所示：

```
search = (
    SearchQuerySet().filter(content=term)
) 
```

返回多种对象，而不仅仅是一个模型。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:24:18.350

我最近不得不做类似的事情，这很痛苦。我找不到任何其他方法来做到这一点。

首先解决 Haystack 在许多模型上工作的问题，因此 filter 返回所有匹配项：

Haystack 使用它索引的名为 django_ct 的属性在后台处理模型过滤，该属性等于应用程序名称和模型名称。在我的特殊情况下，它看起来像`django_ct='books.Title'`.

您可以尝试通过执行过滤

```
SearchQuerySet.filter(content=term, django_ct='app.Model') 
```

但我不知道它是否会那样工作。在我的特殊情况下，无论如何我都必须进行原始搜索，因此我可以直接将过滤添加到其中：

```
sqs = SearchQuerySet()
sqs = sqs.raw_search(u'(title:(%s)^500 OR author:"%s"^400 OR "%s"~2 OR (%s)) AND (django_ct:books.Title)' % term) 
```

不管你如何得到它，在你得到`SearchQuerySet`你想要在不更新索引的情况下进行额外过滤之后，你必须用你自己的代码来做。

```
# each item in a queryset has a pk property to the model instance it references
pks = [item.pk for item in list(sqs)] # have to wrap sqs in a list otherwise it causes problems

# use those pks to create a standard django queryset object
results = Model.objects.filter(pk__in=pks)

# Now you can do any additional filtering like normal
results = results.exclude(published=False) 
```

当然，您可以结合最后两个查询，我只是将它们拆分为明确的。

代码不多，但由于各种原因，我花了很长时间才让它工作。希望它可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-20T17:44:25.707

从 haystack 2.4.0 开始，您可以提高`haystack.exceptions.SkipDocument`跳过使用容易排除的单个记录`index_queryset`

[https://github.com/django-haystack/django-haystack/releases/tag/v2.4.0](https://github.com/django-haystack/django-haystack/releases/tag/v2.4.0)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-11T13:19:33.727

在 Haystack 中有一种按对象过滤的方法。`models`我遇到了与上述类似的问题，并在 Haystack `SearchQuerySet`API 文档中遇到了该方法。

从干草堆（[http://django-haystack.readthedocs.org/en/latest/searchqueryset_api.html#models](http://django-haystack.readthedocs.org/en/latest/searchqueryset_api.html#models)）

`SearchQuerySet.models(self, *models)`

接受任意数量的模型类以包含在搜索中。这会将搜索结果缩小到仅包含来自指定模型的结果。

例子：

`SearchQuerySet().filter(content='foo').models(BlogEntry, Comment)`

因此，您可以从这里根据需要按对象内的内容进行过滤。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T00:45:50.333

感谢@SI Eric，我能够找到答案，它也有点老套，但它有效。

```
search = (
    SearchQuerySet().filter(content=term)
)

search_list = search[:]
unpublished_Mymodels = Mymodel.objects.filter(published=False)

for match in search_list:
    try:
        if match.model_name == 'Mymodel':
            if match._get_object() in unpublished_Mymodels:
                search_list.remove(match)
    except:
        pass

search = search_list 
```

# c++ - 排序比较函数奇怪的行为

> ID：15373306
> 
> 赞同：1
> 
> 时间：2013-03-12T22:15:26.953
> 
> 标签：c++, sorting

下面的函数是我的比较函数。虽然直接比较两个字符成功地对数组进行了分类，但使用 std::string 比较函数却没有。

```
int compare (student a, student b) {
  return a.name.compare(b.name);
  return a.name[0] < b.name[0];
} 
```

通话

```
sort(data.begin(), data.end(), compare); 
```

其中数据定义为`vector <student> data;`

你有什么想法为什么 std::compare 不排序吗？

PS：std::compare 会导致位置颠倒，例如 alan, richard, byron, sarah -> sarah, byron, richard, alan。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T22:18:31.940

[std::string::compare](http://en.cppreference.com/w/cpp/string/basic_string/compare)返回一个`int`你打算比较的，`0`以给出一个实际的排序顺序。例如，要检查是否`a.name`小于`b.name`（根据 给出的顺序`compare`），您可以编写：

```
return a.name.compare(b.name) < 0; 
```

您当前编写它的方式将返回`true`任何不相等的字符串，这不是有效的[严格弱排序](http://en.wikipedia.org/wiki/Strict_weak_ordering)，正如[std::sort](http://en.cppreference.com/w/cpp/algorithm/sort)所要求的那样。

根本没有充分的理由在`compare`这里使用，因为[std::string](http://en.cppreference.com/w/cpp/string/basic_string)有一个[operator<](http://en.cppreference.com/w/cpp/string/basic_string/operator_cmp)，它给出了两个字符串的等效排序：

```
return a.name < b.name; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:22:48.083

阅读[cppreference.com 上的 std::sort 参考](http://en.cppreference.com/w/cpp/algorithm/sort)；它清楚地解释了比较函数应该返回一个`bool`表示第一个参数小于第二个的参数。

在这种情况下，您可以这样称呼它：

```
std::sort(data.begin(), data.end(), [](student const& a, student const& b) {
    return a.name < b.name;
}) 
```

那么，您的代码中发生了什么？如果`name`s 相等，则`compare`返回 0，它被强制转换为`false`。否则，您将得到一个非零整数，该整数将被强制转换为`true`. 由于`std::sort`没有绝对指定排序算法，我们不能说为什么你要精确地得到某个顺序，但本质上，`std::sort`是`std::swap`随机的对象（伪）。

那么，你应该定义一个`compare`函数吗？恕我直言，不。定义一些基本类型很容易，但据我所知，它并没有真正出现在任何算法中。这是一种 C 主义，不幸的是，C++ 保留了它。如果合适，请使用instead定义*严格的弱排序，或者在需要时仅定义比较器。*`operator<`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:19:26.870

sort 期望它的比较器表现得像 operator<，而 std::string::compare 表现得像[这里](http://www.cplusplus.com/reference/string/string/compare/)描述的那样。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-12T22:21:34.063

您正在返回一个`int`“`std::sort`相同”或“不同”的结果。你应该返回这个：

```
return a.name.compare(b.name) < 0; 
```

并将返回类型更改为`bool`

但是，您是否考虑过这一点：

```
class student
{
public:
   ... members ...

   bool operator <(const student& s) const
   {
       return name < s.name;
   }

private:
   std::string name;
}; 
```

并摆脱您试图*完全*制造的自定义比较器。有了这个，您可以使用 just 对一组学生进行排序`std::sort(students.begin(), students.end())`，因为默认比较器 ,`std::less<YourType>`将在排序时进行比较时调用您的运算符。

# php - 使用重复键更新时 PDO lastInsertId() 返回 0？

> ID：15373308
> 
> 赞同：8
> 
> 时间：2013-03-12T22:15:36.923
> 
> 标签：php, mysql, pdo

我有如下查询：

```
$a = $members->prepare("insert into a(name) values(:name) 
                            on duplicate key update name = :name"); 
```

然后当我这样做时：

`$insert_id = $a->lastInsertId()`

如果查询成功插入一行，它将按预期返回插入 id，如果它更新了一行，它也将按预期返回更新的行 id（排序）。但是如果因为一切都一样，它既没有插入也没有更新任何东西，那么它只返回 0。

我想这是非常合乎逻辑的默认行为，但是有没有办法改变它，以便它可以返回它尝试更新的行的 id，就像它实际更改行中的某些内容时一样。

谢谢。

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-12T22:22:01.290

有很多地方可以找到答案，但 PDO 的特殊性可能会阻碍您的搜索结果......

首先，确保添加`id=LAST_INSERT_ID(id)`到子句中，如[DOCS](http://dev.mysql.com/doc/refman/5.0/en/insert-on-duplicate.html)`ON DUPLICATE`底部所述。在这种情况下，是您的主键的列名（因此在您的情况下，它可能/可能不是标题）。`id``id`

此外，您可能必须指定一个序列对象参数才能`->lastInsertId()`使其工作。我以前在某些情况下遇到过这个问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:21:57.913

不，因为它没有“尝试”更新的行。另外，请注意：如果您在同一会话中之前有另一个插入查询，您可以`LAST_INSERT_ID()`从之前的查询中获取值。

# sql - 如何从增强的实体关系模型中实现抽象类？

> ID：15373310
> 
> 赞同：1
> 
> 时间：2013-03-12T22:15:52.927
> 
> 标签：sql, mysqli, entity-relationship

我想在 mySQL 数据库上实现这种关系。 ![一个名为 Person 的实体是 Student 和 Teacher 类的超类的关系](../Images/ecfef572d02d56cfb97a264681a98e12.png)

我正在使用这个架构：

```
CREATE TABLE Person
(
id INTEGER NOT NULL AUTO_INCREMENT,
name VARCHAR(40),
PRIMARY KEY(id)
);

CREATE TABLE Student
(
id INTEGER NOT NULL,
FOREIGN KEY(id)
    REFERENCES Person(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
);

CREATE TABLE Teacher
(
id INTEGER NOT NULL,
room INTEGER NOT NULL,    
FOREIGN KEY(id)
    REFERENCES Person(id)
        ON DELETE CASCADE
        ON UPDATE CASCADE
); 
```

这样我可以保证不存在不是人的老师或学生，但是我不能保证“完全”专业化。可能存在一个不是学生或教师的人。此外，我不能保证排他性。可能存在一个学生和教师的人。

我如何在关系数据库中像 MySQL 一样解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:52:52.993

重新“可能存在一个不是学生或老师的人”：如果您要存储历史记录，这是非常有效的；一旦学生毕业，或教师退休或加入另一个组织，这些记录仍需要在数据库中至少存在一段时间。

关于“可能存在一个不是学生或老师的人”：这也是一个合法的情况。在大学里，许多（大多数？全部？）助教也是研究生。

# ios - UIPopoverController：在popover仍然可见时达到了dealloc

> ID：15373312
> 
> 赞同：0
> 
> 时间：2013-03-12T22:16:05.980
> 
> 标签：ios, ipad, uipopovercontroller, popover

我正在开发一个应用程序，该应用程序允许用户从他自己的相册中选择图像。它适用于 iPhone，但不适用于 iPad。

我做了一个`UIPopoverController`，一切正常，用户可以选择一张照片，但是当用户按下“使用”按钮时。该应用程序兑现说

> UIPopoverController dealloc] 在 popover 仍然可见时达到

这是代码：

```
- (void)choosePhotoFromLibraryipad:(id)sender{

    if(![popoverController isPopoverVisible]){

    imagePicker = [[UIImagePickerController alloc] init];
    imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary;
    imagePicker.delegate = self;
    imagePicker.allowsEditing = YES;

    self.popoverController = [[UIPopoverController alloc] initWithContentViewController:imagePicker];

    [self.popoverController presentPopoverFromRect:CGRectMake(0.0, 0.0, 400.0, 400.0)
    inView:self.view permittedArrowDirections:UIPopoverArrowDirectionAny animated:YES ];

    }
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:19:17.863

检查你的`.h`文件。确保 your `@property`for your `popoverController`is**`strong`而不是`weak`**. 很多小时的时间都浪费在这样简单的事情上了。

# c - 使用 C 程序获取程序标志

> ID：15373315
> 
> 赞同：0
> 
> 时间：2013-03-12T22:16:15.673
> 
> 标签：c, unix, elf

我实际上是在尝试通过 C 程序获取 objdump -s 命令给出的标志。但我不知道去哪里找他们。例如这里：

```
./my_objdump:     file format elf64-x86-64
architecture: i386:x86-64, flags 0x00000112:
EXEC_P, HAS_SYMS, D_PAGED
start address 0x00000000004006f0 
```

我想知道如何获取：标志 0x00000112：C 中的 EXEC_P、HAS_SYMS、D_PAGED。谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-18T02:34:53.633

> 我想知道如何获取：标志 0x00000112：C 中的 EXEC_P、HAS_SYMS、D_PAGED。

从您的问题中不清楚您是否不知道如何获取数字`0x112`，或者如何将该数字翻译成`EXEC_P`等等。 [1]

前者是Elf64_Ehdr中e_flags的值，就在文件的开头。也就是说，您`sizeof(struct Elf64_Ehdr)`从文件中的偏移量中读取字节`0`到缓冲区 [2]，然后：

```
printf("flags: 0x%x\n", ((struct Elf64_Ehdr *)buf)->e_flags); 
```

后者：`EXEC_P`,`HAS_SYMS`等表示内部使用的标志，与实际文件`libbfd`几乎没有关系。`ELF`它们是内部抽象，并且（或应该）对任何人都不感兴趣。

但如果你*真的*在乎，`D_PAGED`如果文件有，则设置标志`e_phnum != 0`，即

```
if (((struct Elf64_Ehdr *)buf)->e_phnum != 0) {
  printf("D_PAGED\n");
} 
```

我确信`HAS_SYMS`如果`.symtab`或`.dynsym`部分存在，则设置，等等。

[1] 注意：与人们的想法相反，`EXEC_P`等标志*不能*从`flags`.

[2] 如果您的文件是 32 位 ELF，则需要进行明显的调整。它还假设您正在查看*本机*ELF 文件。在 little-endian 机器上检查 big-endian ELF 文件（反之亦然）需要额外的工作。

# boost - text_iarchive 和 binary_iarchive 之间的区别

> ID：15373316
> 
> 赞同：1
> 
> 时间：2013-03-12T22:16:23.963
> 
> 标签：boost

与 text_iarchive 相比，使用 binary_iarchive 是否有任何性能优势？我只知道 binary_iarchive 是不可移植的，而 text_iarchive 是可移植的。我正在寻找序列化库，通过它我可以将 stl::map 直接写入文件并稍后读取。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:59:58.093

你为什么不写一个测试用例并分析它？但是我会假设二进制更快，因为例如 32 位`int`作为文本可能占用 10 个字节（80 位），但在二进制中它将是 4 个字节。另一方面，这意味着如果您的大多数值都低于 999（以 10 为底），则使用文本可能会更快。无论如何运行一些典型的数据集和配置文件，看看什么最适合你。

然后例如`boost::serialization`会增加一些开销来跟踪写入的内容以及是否需要处理指针。

但是，文件 I/O 通常非常慢，因此如果您关心性能，那么您可能希望从文件中读取尽可能少的字节。

另一方面，如果您在程序中读取一次文件，即慢速文件 I/O 不会影响我将使用可移植性的整体性能。但请记住，不能保证数字可以安全地从 64 位程序移植到 32 位程序。如果 64 位系统有 64 位`int`，而 32 位系统有 32 位`int`，即使使用文本存档也可能会出现问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T10:45:54.327

文本档案会比二进制档案大一些。如果可移植性是您最关心的问题 - 请考虑使用[portale 二进制存档](http://www.boost.org/doc/libs/1_53_0/libs/serialization/doc/todo.html#portablebinaryarchives)。

# lambda - lambda 中的 case 语句

> ID：15373318
> 
> 赞同：1
> 
> 时间：2013-03-12T22:16:26.957
> 
> 标签：lambda, functional-programming, erlang, currying

是否可以在 lambda 中合并 case 语句？

我正在尝试创建一个在 Erlang 中递归地添加两个数字的函数，但没有运气。

```
Mult = fun(X) -> (fun(Y) -> case Y of  
  0 -> 0;
  Y -> X + fun(Y-1)
  end)
end. 
```

收到错误

```
syntax error before: 'end' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T09:53:25.023

您不能在 lambda 中使用 self 声明（至少在 R16 之前），但您可以将其作为参数发送：

```
Mult = fun(X) ->
    YFun = fun(0, _) -> 0;
              (Y, M) ->
                  X + M(Y - 1, M)
           end,
    fun(Y) ->
        YFun(Y, YFun)
    end
end. 
```

你得到

```
> (Mult(2))(3).
6 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T10:34:18.227

看看这个页面[http://rosettacode.org/wiki/Y_combinator](http://rosettacode.org/wiki/Y_combinator)。

应用于您的案例，它给出：

```
1> Y = fun(M) -> (fun(X) -> X(X) end)(fun (F) -> M(fun(A) -> (F(F))(A) end) end) end.
#Fun<erl_eval.6.82930912>
2> Mul = fun (F) -> fun ({X,0}) -> 0; ({X,N}) -> X + F({X,N-1}) end end.
#Fun<erl_eval.6.82930912>
3> (Y(Mul))({5,4}).                                                     
20
4> 
```

我必须承认这对我来说有点复杂......

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T13:46:38.783

请记住，即使在匿名函数中，Erlang 也会进行模式匹配。您根本不需要案例陈述。

```
-module (math).
-export ([mult/1]).

mult(X) -> 
    fun(0) -> 0;
       (Y) -> X + (mult(X))(Y-1)
    end. 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-13T02:56:27.547

我认为`case`您的代码中的表达式不会导致问题。而是函数定义本身格式错误。

如果我正确解释了您的代码，则您想为乘法定义一个递归函数。并`fun(Y-1)`打算作为递归函数调用？

但是在您的情况下`Mult`，是一个变量，它被分配了一个匿名函数（或者更确切地说是两个嵌套的匿名函数），我认为匿名函数不允许递归。

下面的变化怎么样：

```
-module (mult).
-export ([mult/1]).

mult(X) ->
  fun (Y) ->
    case Y of
      0 -> 0;
      Y -> X + (mult(X))(Y-1)
  end
end. 
```

（放在一个单独的文件中）。

# python - conAdd.txt 文件

> ID：15373319
> 
> 赞同：0
> 
> 时间：2013-03-12T22:16:28.073
> 
> 标签：python, if-statement, python-3.x, python-3.3

我正在用 python 打开一个文本文件。文本有“sub 5 10”。python 打开文本文件并减去它。但是当我添加一个 else 函数时，它只是做 else 它不会减去它。相反，即使我的文本文件显示 sub，它也会添加它。

```
def main():
    infi = open ("condAdd.txt", "r")
    nList = infi.readline().split()
    sub = 0
    add = 0
    if sub=="sub":
        num2 = eval(nList[2])
        num1 = eval(nList[1])
        subt = num1-num2
        print(subt)
    else:
        num4 = eval(nList[2])
        num3 = eval(nList[1])
        adde = num3+num4
        print (adde)
main() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:19:39.070

请不要使用`eval()`when`int()`会做：

```
num2 = int(nList[2])
# etc. 
```

您正在测试错误的变量；`nList[0]`改为测试：

```
if nList[0] == "sub": 
```

# java - 通过java Throwable抛出嵌套异常

> ID：15373320
> 
> 赞同：0
> 
> 时间：2013-03-12T22:16:28.643
> 
> 标签：java, throw, throwable

我试图通过java在另一个异常中抛出内部异常，`Throwable`但IDE告诉我你必须用它包围它`try/cath`，我应该怎么做才能避免这个问题？

```
 try
    {
        //Some code
    }
    catch (IOException e) 
    {
        Throwable cause = new Throwable();
        cause.initCause(e);
        throw cause.getCause();
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:19:49.100

将您的方法签名更改为：

```
public void someMethod() throws IOException
{   
    //some code
} 
```

查看[此站点](http://weblogs.java.net/blog/carcassi/archive/2009/09/25/simple-guide-checked-exceptions)以获取有关受检异常的一些有用信息以及有关受检异常和未受检异常之间的区别的一些信息

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:18:27.553

在您的函数签名中声明`IOException`为已检查异常。

# php - Jquery 确认不出现

> ID：15373325
> 
> 赞同：0
> 
> 时间：2013-03-12T22:16:54.530
> 
> 标签：php, jquery, forms, popup, confirmation

我想首先说我对 Jquery / 客户端脚本非常陌生。当我的老板想要某种方式让客户确认提交的表单时，我有点盲目。

这是我的 jquery / 标题：

```
<head>
    <title>Access Point</title>
    <meta http-equiv="Content-Type" content="text/html"; charset="utf-8" />
    <link rel="stylesheet" href="<?php echo base_url();?>css/mainstyle.css" type="text/css" />
    <link rel="stylesheet" href="<?php echo base_url();?>css/secondarystyles.css" type="text/css"/>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
        $("#signinform").submit( function(e)
        {
            if (!confirm("If you click OK you will be inserted into student queue. Please take a seat and wait."))
            {
                e.preventDefault();
                return;
            }
        });
    </script>
</head> 
```

这是我的表格：

```
<?php echo form_open('staff_controller/agree', 'id="signinform"') ?>
            <input type="checkbox" id="agree" name="options" value="agree"<?php echo form_checkbox('options','agree') ?>I have read and understood the above <br /> <font color="#ff0000" size="3">(Please click on the box)</font></input>
            <br />
            <br />
            <br />
            <?php
                echo form_submit('submit', 'Submit'); 
                echo anchor('staff_controller/studentlogin', 'Cancel'); 
                echo form_close();
            ?> 
```

我的 php 脚本检查是否选中了复选框（以同意我们的要求）并检查是否单击了提交。如果单击它，则将值提交到数据库中。据我了解，我可以继续使用这种风格来处理我的数据，我只希望 jquery 在中间，让用户知道他们正在提交。我在互联网上找到了这段代码，但我不知道如何调试它。我还计划使用 jquery 确认来检查您是否要“取消”表单提交

编辑 1：

查看它“应该”工作的源代码：

> form action="https://www.finaidtest.com/index.php/staff_controller/agree" id="signinform" method="post" accept-charset="utf-8"

然后是我更新的确认：

```
<script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.10.1/jquery-ui.min.js"></script>
<script>
    $(document).on('submit', "#signinform", function(e)
    {
        if (!confirm("If you click OK you will be inserted into student queue. Please take a seat and wait"))
        {
            e.preventDefault();
            return;
        }
    });
</script> 
```

**编辑 2**

感谢 Musa，现在一切正常！谢谢！！

代码 ：

```
<script src="<?php echo base_url();?>javascript/js/jquery.js" type="text/javascript"></script>
    <script>
        $(document).on('submit', "#signinform", function(e)
        {
            if (!confirm("If you click OK you will be inserted into student queue. Please take a seat and wait"))
            {
                e.preventDefault();
                return;
            }
        });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:20:46.450

您必须等待元素被创建，然后才能将事件处理程序绑定到它。使用 $(document).ready 确保在设置处理程序之前创建您的元素。

```
$(document).ready(function(){
    $("#signinform").submit( function(e)
    {
        if (!confirm("If you click OK you will be inserted into student queue. Please take a seat and wait."))
        {
            e.preventDefault();
            return;
        }
    });
}); 
```

您还可以使用委托来附加事件，这样您就不必等待加载 dom

```
 $(document).on('submit', "#signinform", function(e){
        if (!confirm("If you click OK you will be inserted into student queue. Please take a seat and wait."))
        {
            e.preventDefault();
            return;
        }
    }); 
```

# entity-framework - 通过实体框架持久化的值对象

> ID：15373329
> 
> 赞同：0
> 
> 时间：2013-03-12T22:16:59.013
> 
> 标签：entity-framework

[我在这里](http://christianarg.wordpress.com/2010/09/10/c-net-immutable-properties-for-entity-framework-serializable-classes-etc/)看到了这个示例，这是在 DDD 中制作 vaueobject 的建议方法，看看这个

```
public class SubCategory : ValueObjectBase
{
    public string Name { get; private set; }
    public int NumberOfPosts { get; private set; }

    public SubCategory()
    {
    }

    public SubCategory(string name, int numberOfPost)
    {
        Name = name;
        NumberOfPosts = numberOfPost;
    }
} 
```

在我的代码中，我使用不允许我有任何 Id 的 ValueObjectBase ，实体框架映射中的每个表都应该有一个 Id 来在数据库中创建一个表，我如何映射这个 valueObject 和有点不可变的类？

我的映射类是这样的：

```
public class SubCategoryMapping : EntityTypeConfiguration<SubCategory>
{
    public SubCategoryMapping()
    {
        ToTable("SubCategory");
        // Id ????
        Property(sc => sc.Name);
        Property(sc => sc.NumberOfPosts);
    }
} 
```

# ruby-on-rails-3 - rufus/调度器每周日

> ID：15373330
> 
> 赞同：0
> 
> 时间：2013-03-12T22:17:03.730
> 
> 标签：ruby-on-rails-3, rufus-scheduler

我需要在每周日晚上 9 点使用 rufus 安排一个脚本。

我的 task_schedule.rb 中有以下内容

```
require 'rubygems'
require 'rufus/scheduler'

  scheduler = Rufus::Scheduler.start_new

scheduler.every("week") do
   puts("Emailing Unverified Evidence Items Digest #{Time.now}")
   ArtifactsController.email_unverified_artifacts_digest
end 
```

想知道每个“星期日晚上 9 点”安排它的语法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:17:23.153

如自述文件（[https://github.com/jmettraux/rufus-scheduler/](https://github.com/jmettraux/rufus-scheduler/)）中所示，rufus-scheduler 理解 cron 字符串，如：

```
scheduler.cron("0 21 * * sun") do
    # whatever...
end 
```

在您的 OSX / GNU/Linux 系统上，在终端中键入“man 5 crontab”以获得该格式的详细说明。

干杯。

（请注意 rufus-scheduler 的 cron 功能不利用底层系统的 cron 守护进程）

# javascript - 使用 JavaScript getElementById 定位 CSS

> ID：15373332
> 
> 赞同：0
> 
> 时间：2013-03-12T22:17:09.513
> 
> 标签：javascript, css, getelementbyid

真的很简单的问题，我正在使用 getElementById 来定位我的 div`standby`并更改其样式。现在，出于对任何事物的热爱，我无法找到如何将我的 CSS 中写入的内容定位`#standby img`为. 我将如何定位它并使用 JavaScript 更改其样式？`img``standby`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:19:39.920

对于所有浏览器中的纯 javascript，它将是这样的：

```
var imgs = document.getElementById("standby").getElementsByTagName("img"); 
```

在更高级的浏览器中，您可以使用：

```
var imgs = document.querySelectorAll("#standby img"); 
```

其中每一个都返回一个 nodeList（类似于 DOM 元素的数组），然后您可以对其进行迭代。

* * *

然后，您可以像这样迭代其中任何一个的结果：

```
for (var i = 0; i < imgs.length; i++) {
    imgs[i].style.width = "300px";
} 
```

* * *

如果您知道该 div 中只有一个图像，那么您可以这样做而不是迭代多个：

```
document.getElementById("standby").getElementsByTagName("img")[0].style.width = "300px"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:20:13.900

将 document.querySelector 用于纯 JavaScript 解决方案：

```
document.querySelector("#erg img"); 
```

然后，您可以像使用 getElementById 检索的元素一样更改其样式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:19:31.800

您可以使用 jQuery 轻松完成此操作。`$('#standby img')`. 值得研究。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:20:03.757

所以你已经`standby`使用`getElementById()`.

要获取其中的`img`元素，您需要使用`getElementsByTagName()`

```
var standby = document.getElementById('standby');
var standbyImgs = standby.getElementsByTagName('img'); 
```

我猜你已经有了第一行，所以你只需要第二行。或者将它们合二为一。

需要注意的是，它`getElementsByTagName()`返回一个元素数组，而不是像`getElementById()`. 因为很明显，那里可能不止一个`img`，而应该只有一个具有给定 ID 的元素。

# multi-user - 简单的多用户应用程序

> ID：15373333
> 
> 赞同：0
> 
> 时间：2013-03-12T22:17:13.220
> 
> 标签：multi-user

我一直在寻找有关制作简单多用户 Web 应用程序原则的信息和示例。

我要制作的应用程序用于截止日期管理，可以描述为一个简单的日历，用户可以在其中注册事件。

我在 PHP 或 ASP.NET 中为单个用户制作这个没有问题，但是我怎样才能为多个用户制作这个，所以他们可以注册并且只能看到他们自己的数据。

该应用程序本身非常简单，最多不会有很多用户。50-100。

我发现很难找到有关此主题的信息。我自己的想法，这可能不是正确的做法是：

*   当用户创建事件时，将其存储在带有用户 ID 的表中。
*   选择数据时，使用登录用户的 ID 并获取相应的事件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:35:52.720

我强烈建议在一个框架内工作，以避免重新发明轮子。如果您了解 python，请考虑[flask](http://flask.pocoo.org/)、[pylons](http://www.pylonsproject.org/)或[Django](https://www.djangoproject.com/)。如果您希望继续使用 PHP（如果您打算与非 Windows 开发人员一起工作，则应避免使用 ASP.NET）尝试[Drupal](http://drupal.org/)。Ruby on RAILs 也有一些选项，但我从未使用过它。

您尝试实现这一点的方式可能会导致数据库过大、过于复杂，新开发人员很难习惯这种方式。如果您*必须*自己实现，您应该有一个用户/密码表、一个事件表和一个将两者链接在一起的表（例如分配所有权）。

# scala - 是否可以在宏中访问符号表？

> ID：15373336
> 
> 赞同：5
> 
> 时间：2013-03-12T22:17:26.550
> 
> 标签：scala, macros, scala-2.10, scala-macros

例如，要获取可在宏的调用站点访问的所有值及其类型？或者至少只是当前类的值？例如：

```
class A {
  val v1 = 10
  var v2 = "2"

  def m {
    val m3 = true

    // Here I would like to get information that v1: Int, v2: String and
    // v3: Boolean are available
    macroInvocation() 
  }
} 
```

我查看了上下文和宇宙，但找不到好的方法。

到目前为止，我发现的唯一解决方案是获取宏的封闭类/方法（通过上下文），然后搜索树。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:51:12.340

> 到目前为止我发现的唯一解决方案是获取宏的封闭类/方法（通过上下文），并搜索树

我感觉您的意思是您实际上是在检查 AST 本身以提取声明的字段。你不必那样做。如果`c`是你的`Context`价值，你可以这样做：

```
c.enclosingClass.symbol.typeSignature.members 
```

# intellij-idea - Intellij 递归嵌套输出目录

> ID：15373337
> 
> 赞同：6
> 
> 时间：2013-03-12T22:17:26.967
> 
> 标签：intellij-idea

我对 intellij-idea 有一个非常奇怪的问题。在我的 java 程序中运行一些 main 函数时，intellij 会创建一个目录`out`，用于存储类文件以及其他一些东西。

它创建的目录具有以下结构

```
<PROJECT_ROOT>/out/production/<PROJECT_NAME>/ 
```

没什么奇怪的，但是，当我再次在 intellij 中运行程序时，它会在目录中创建一个`out`具有相同结构的 NEW 目录，因此结果如下

```
<PROJECT_ROOT>/out/production/<PROJECT_NAME>/out/production/<PROJECT_NAME>/ 
```

然后如果我再次运行它，它会嵌套另一个！

```
<PROJECT_ROOT>/out/production/<PROJECT_NAME>/out/production/<PROJECT_NAME>/out/production/<PROJECT_NAME>/ 
```

等等...

至少可以说，这是令人难以置信的令人沮丧的行为。我认为这可能是我的环境（Windows），所以我将项目设置在我的 linux 机器上，并观察到相同的行为。我确实从 git repo 克隆了这个项目，但我认为这不是原因。我也注意到我克隆的不同项目中的相同行为。

我的下一步是在每个环境中从头开始创建两个完全不同的项目，看看我是否能以这种方式重现问题。一旦我尝试了该结果以及我尝试的任何其他方法，我将更新这篇文章的结果，但我想我会在继续解决问题的同时在这里发布，以防万一其他人看到这种行为并知道解决方案。

我会随时更新。任何“想法”（看看我在那里做了什么；）或建议表示赞赏！

***更新*** 在 linux 机器上从头开始创建一个 hello world prog 并没有重现该行为。

***更新***在 Windows 机器上从头开始创建一个 hello world prog 并没有重现该行为。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T22:49:51.640

我能够重现这一点。当基本模块也是 src 根时，IntelliJ 会以这种方式运行。如果您取消将基本模块标记为 src 根目录，然后创建一个 src 目录来放置您的源文件，您会注意到在下一次编译时整个目录结构会被吹走，而 IntelliJ 会恢复正常行为。

# python - 比较两个字符串，包括重复的字母？

> ID：15373339
> 
> 赞同：3
> 
> 时间：2013-03-12T22:17:34.957
> 
> 标签：python, string, compare, duplicates

我正在尝试编写一个需要两个用户输入的函数：一个单词和一个最大长度。该函数从一个文本文件（在程序前面打开）中读取，查看所有符合给定最大长度的单词，并从文件中返回一个单词列表，其中包含用户给出的单词中的所有字母. 到目前为止，这是我的代码：

```
def comparison():
    otherWord = input("Enter word: ")
    otherWord = list(otherWord)
    maxLength = input("What is the maximum length of the words you want: ")
    listOfWords = []
    for line in file:
        line = line.rstrip()
        letterCount = 0
        if len(line) <= int(maxLength):
            for letter in otherWord:
                if letter in line:
                    letterCount += 1
            if letterCount == len(otherLine):
                listOfWords.append(line)
    return listOfWords 
```

此代码有效，但我的问题是它没有考虑从文件中读取的单词中的重复字母。例如，如果我输入“GREEN”作为 otherWord，则该函数返回一个包含字母 G、R、E 和 N 的单词列表。我希望它返回一个包含具有 2 个 E 的单词的列表。我想我还必须对 letterCount 部分进行一些调整，因为重复项会影响这一点，但我现在更关心识别重复项。任何帮助将非常感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:24:11.247

您可以对 使用 Counter `otherWord`，如下所示：

```
>>> from collections import Counter
>>> otherWord = 'GREEN'
>>> otherWord = Counter(otherWord)
>>> otherWord
Counter({'E': 2, 'R': 1, 'N': 1, 'G': 1}) 
```

然后您的支票可能如下所示：

```
if len(line) <= int(maxLength):
    match = True
    for l, c in counter.items():
        if line.count(l) < c:
            match = False
            break
    if match:
        listOfWords.append(line) 
```

您也可以`match`使用 Python 的 for..else 构造在不使用变量的情况下编写此代码：

```
if len(line) <= int(maxLength):
    for l, c in counter.items():
        if line.count(l) < c:
            break
    else:
        listOfWords.append(line) 
```

编辑：如果您想在字符数上完全匹配，请检查是否相等，并进一步检查是否有任何额外字符（如果行长不同，就是这种情况）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:22:18.647

您可以使用[collections.Counter](http://docs.python.org/2/library/collections.html#collections.Counter)，它还可以让您执行（多）集操作：

```
In [1]: from collections import Counter

In [2]: c = Counter('GREEN')

In [3]: l = Counter('GGGRREEEENN')

In [4]: c & l  # find intersection
Out[4]: Counter({'E': 2, 'R': 1, 'G': 1, 'N': 1})

In [5]: c & l == c  # are all letters in "GREEN" present "GGGRREEEENN"?
Out[5]: True

In [6]: c == l  # Or if you want, test for equality
Out[6]: False 
```

所以你的功能可能会变成这样：

```
def word_compare(inputword, wordlist, maxlenght):
    c = Counter(inputword)
    return [word for word in wordlist if maxlenght <= len(word) 
                                      and c & Counter(word) == c] 
```

# javascript - jQuery中的“模仿”占位符属性？

> ID：15373341
> 
> 赞同：1
> 
> 时间：2013-03-12T22:17:48.713
> 
> 标签：javascript, jquery

## 背景

我有几个 jQuery 函数，它们将搜索字段设置为包含“搜索”一词，并在单击该字段时将其清除/重置....

```
// Search Box Placeholder
jQuery('#q').focus(function() {
            if(jQuery(this).val() == 'Search') {
                jQuery(this).val('');       
            }
            else if(jQuery(this).val() == '') {
                jQuery(this).val('Search');
            }
        });
jQuery('#q').blur(function() {
            if(jQuery(this).val() == '') {
                jQuery(this).val('Search');             
            }
        });
jQuery('#q').val('Search'); 
```

## 问题 ？

唯一的问题是，如果在没有设置替代搜索词的情况下提交了搜索表单，我不确定如何清除“搜索”一词。如果内容等于“搜索”，有没有办法在表单提交之前检查和清除内容？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:21:16.920

如果值等于“搜索”，您可以阻止提交表单。

```
$('form').on('submit', function(){
   return $('#q').val() !== 'Search';
}); 
```

如果要支持不支持占位符属性的旧浏览器，也可以使用插件。

[https://github.com/parndt/jquery-html5-placeholder-shim](https://github.com/parndt/jquery-html5-placeholder-shim)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:34:11.237

找到这类事情的答案的关键往往更多的是了解术语而不是其他任何事情。

在这种情况下，如果您搜索单词“polyfill”而不是“mimic”，您就会找到解决方案。“Polyfill”是 Web 开发人员为浏览器脚本代言，该脚本实现了较新浏览器的功能，以便在较旧的浏览器中工作。

占位符功能是这方面的经典功能，因为它非常有用且易于完成。

Modernizr 是一个 Javascript 库，旨在简化使用 polyfill 的过程。它检测是否支持某个功能，以便您知道是否为该功能加载 polyfill。

这是一个有用的工具，但我提到 Modernizr 的主要原因是因为他们还维护了[大量的 polyfill 脚本](https://github.com/Modernizr/Modernizr/wiki/HTML5-Cross-browser-Polyfills)。

单击该链接并搜索“占位符”...您会发现有一整套脚本可以为您完成。只需选择最适合您的一种，或者从他们使用的技术中选择一种。

希望有帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:23:53.277

您可能要考虑的替代方法是不添加占位符文本作为控件的值。相反，使用另一个元素，可能是输入标签或跨度，绝对定位在文本输入之上，并在相应的输入具有控制权时隐藏它。此外，当用户单击此标签时，您应该将其隐藏并将焦点设置到控件。这也可以让您更改占位符颜色。

# symfony - 使用 KnpMenu 进行折叠菜单导航

> ID：15373343
> 
> 赞同：1
> 
> 时间：2013-03-12T22:17:57.270
> 
> 标签：symfony, menu, tree, navigation, knpmenu

我想为当前项目使用 KnpMenu 来处理我的导航树逻辑。我已经建立了一个这样的菜单树：

```
use Knp\Menu\Matcher\Matcher;
use Knp\Menu\MenuFactory;
use Knp\Menu\Renderer\ListRenderer;

$factory = new MenuFactory();
$menu = $factory->createItem('my_menu');

$menu->addChild('home', array('uri' => '/', 'label' => 'Home'))
     ->addChild('about', array('uri' => 'about', 'label' => 'About'));

$cat1 = $menu->addChild('category_1', array('uri' => 'category_1', 'label' => 'Category 1'));
$cat1_1 = $cat1->addChild('category_1_1', array('uri' => 'category_1_1', 'label' => 'Category 1.1'));
$cat1_1->addChild('category_1__1', array('uri' => 'category_1_1_1', 'label' => 'Category 1.1.1'));
$cat1_1->addChild('category_1_1_2', array('uri' => 'category_1_1_2', 'label' => 'Category 1.1.2'))->setCurrent(true);
$cat1->addChild('category_1_2', array('uri' => 'category_1_2', 'label' => 'Category 1.2'));

$renderer = new ListRenderer(new Matcher());
echo $renderer->render($menu); 
```

我想知道是否可以呈现一个仅显示当前活动菜单项的折叠菜单树。不应显示其他项目。在文档中，我还没有找到实现此目的的方法。

有没有人有办法解决吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:25:01.977

你的意思是如果父母处于活动状态，你只想让菜单“展开”？
如果是这样，那么是的，我有同样的要求，这里有一个 PR 开放[https://github.com/KnpLabs/KnpMenu/pull/85](https://github.com/KnpLabs/KnpMenu/pull/85)

目前由于它没有合并，我正在使用我的分支替换作曲家中标记的 KnpMenu。

```
//composer.json excerpt
...
"repositories": [
    {
        "type": "vcs",
        "url":  "git@github.com:catchamonkey/KnpMenu"
    }
],
require: {
    ...
    "knplabs/knp-menu": "dev-display_children_if_ancestor_current as 2.0.0",
    ...
}
... 
```

然后，您使用此行为标记顶级项目，因此要使您的 category_1 仅在孩子处于活动状态（或处于活动状态）时展开，您可以这样做

```
$cat1->setDisplayChildrenIfAncestorCurrent(true); 
```

这由此处的树枝渲染更改处理[https://github.com/KnpLabs/KnpMenu/pull/85/files#L2R74](https://github.com/KnpLabs/KnpMenu/pull/85/files#L2R74)

# javascript - 扩展常规对象以支持 ES5 数组功能的问题

> ID：15373344
> 
> 赞同：2
> 
> 时间：2013-03-12T22:17:58.470
> 
> 标签：javascript, object, ecmascript-5, ecmascript-harmony, ecmascript-6

很久以前，我一直愿意完全模糊原生数组和常规对象之间的界限，不仅扩展了与 ES5 中的数组相同的功能，而且在双方都捆绑了我的自定义方法包。

几个聪明人想到了这些范式变化。[就像 Angus Croll 在文章javascript-object-keys-finally](http://javascriptweblog.wordpress.com/2011/02/28/javascript-object-keys-finally/)中提到的那样：

> “此外，随着数组和常规对象之间的界限模糊（在自定义 getter 和 setter 的帮助下），我们很可能会看到通用的“类数组”对象的增长，它们享有两全其美——非数字标识符和访问由 Array.prototype 定义的丰富的 API 集。EcmaScript 5 通过引入由一种类型定义但可供任何类型使用的泛型方法显然抢先了这一趋势。”

一路上，他得到了文章中的编码： [extending-objects-with-javascript-getters](http://javascriptweblog.wordpress.com/2010/11/15/extending-objects-with-javascript-getters/)

```
function extendAsArray(obj) {
    if (obj.length === undefined || obj.__lookupGetter__('length')) {
        var index = 0;
        for (var prop in obj) {
            if(!obj.__lookupGetter__(prop)) {
                (function(thisIndex, thisProp) {
                    obj.__defineGetter__(thisIndex, function() {return obj[thisProp]});
                })(index, prop)
                index++;
            }
        };
        obj.__defineGetter__("length", function() {return index});
    }
    return obj;
}

var myObj = {
    left:50,
    top:20,
    width:10,
    height:10
}

extendAsArray(myObj);

[].map.call(myObj,function(s){return s+' px'}).join(', '); 
//"50px ,20px ,10px, 10px" 
```

这种方法对我来说非常有趣。但是，它似乎也遇到了一些严重的问题！

1.  用几个新属性扩展原始 myObj 模型怎么样？我们是否应该`extendAsArray`在每个属性更改上运行以更新它的相关`length`属性？

2.  当属性发生变化时，相关的不仅仅是`length`属性；数组索引也应该更新，因为类似数组的属性请求肯定是未定义的。所以当

    ```
    console.log(myObj.length) -> 4
    myObj.zAxis=0 
    ```

    然后

    ```
    console.log(myObj[4]) // -> undefined!
    console.log(myObj.length) // -> 4! 
    ```

我已经相应地修改了 Angus 的代码，因此它支持根据`length`请求自动更新属性：

```
function extendAsArray(obj) {
    var index = 0;
    for(var prop in obj){
        if(!obj.__lookupGetter__(prop)){
           (function(thisIndex, thisProp){
              Object.defineProperty(obj, thisIndex, {
                    get: function(){return obj[thisProp]}
                    , enumerable: true
                    , configurable: true
                    , writeable: true
              });
           })(index, prop)
           index++;
        }
    }
    if(!obj.__lookupGetter__('length')){
       Object.defineProperty(obj, 'length', {
          get: function(){
            return extendAsArray(obj);
          }
          , configurable: true
          , writeable: true
       });
       return obj;
    }
    else{
       return index;
    }
} 
```

`length`问题是：当一个属性被改变、添加或删除时，我们如何更新对象的数组索引及其属性？

我应该使用`Object.watch`吗？

还有一个未解决的问题：如何干扰我自己的未填充实用程序库，并以一致的方式使其也适用于对象？

我对两种类型都使用相同的代码库：`z.Object({}).mapEvery`与`z.Object([]).mapEvery`

请避免提及 JQuery 和下划线。我已经为这两种类型提供了一个全面的自定义方法列表，我愿意使用可能与我未填充的标准一起完成的标准，我不愿意重构它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T00:07:44.397

我想这是你的问题：

> 当属性被更改、添加或删除时，我们如何更新对象的数组索引及其长度属性？

您创建方法来执行此操作，因此您基本上模仿了[Object 内部方法](http://www.ecma-international.org/ecma-262/5.1/#sec-8.12)。我不认为你可以用 getter 和 setter 做到这一点，但我可能错了。

其余的更多是评论而不是答案。

> 我很久以前就愿意完全模糊原生数组和常规对象之间的界限

这条线已经完全模糊了。数组是对象，唯一让它们与众不同的是它们特殊的长度属性。

> EcmaScript 5 通过引入泛型方法显然先发制人，

ES5 没有引入泛型方法，它们至少从 ed 3 开始就在该语言中。

> 由一种类型定义但可由任何类型使用

一点也不，事实上 ES5 的限制更大。在 ed 3 中，`call`使用`apply`将*thisArg*强制为一个对象`Object(*thisArg*)`，或者如果没有传递任何内容，则替换全局对象。在未修改通过*thisArg*的 ES5 中并非如此。

将数组用作对象的限制与约定有关，与语言本身无关。大多数开发人员在何时应该使用对象或数组时看到了明显的区别。在少数情况下您确实需要像对象一样使用数组，但毫无疑问它们存在。jQuery 是一个对象利用数组属性的示例，例如，选择器收集的元素作为数字属性添加，并且长度属性是元素的数量。这样，泛型数组方法可以应用于 jQuery 对象（顺便说一句，所有这些都在第 3 版中）。

该`Object.watch`方法在 JavaScrpit™ 中，它不是 ES5 的一部分，因此请谨慎使用。

创建自己的内置对象版本的一个主要问题是，您可能最终将每个内置方法包装在本机方法中（就像 jQuery 包装每个 DOM 方法一样）并开始在每个属性上设置 getter 和 setter ,或以函数调用结束来替换属性访问（例如 jQuery`val`和方法）。如果性能很重要，则相当乏味且缓慢。`attr``prop`

哦，对不起，我提到了 jQuery... :-(

设计一个库或框架以充分利用该语言的特性似乎更明智，而不是试图强迫它做它做得不好或本机不做的事情。

但尝试满分。:-)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T02:45:44.867

那里有一个库 watch.js，它也在关注属性更新或新属性添加。 [试用！](http://jsfiddle.net/NjNJt/)

它与 setInterval 一起使用，因此它对性能不友好。

当 Harmony 出现时，我们可以简单地做一些事情：

```
Object.observe(obj,Observer); 
```

检查规格： [Harmony](http://wiki.ecmascript.org/doku.php?id=harmony%3aobserve)

但是，当以后的对象扩展不是焦点时，我可以在初始化时冻结整个对象，而不是被属性更改或属性添加所困扰。

代码相应更改：

```
extendAsArray = function z_extendAsArray(obj){
    var index = 0;
    for(var prop in obj){
        if(!obj.__lookupGetter__(prop)){
           (function(thisIndex, thisProp){
              Object.defineProperty(obj, thisIndex, {
                    get: function(){return obj[thisProp]}
                    , enumerable: true
                    , configurable: true
                    , writeable: true
              });
           })(index, prop)
           index++;
        }
    }
    if(!obj.__lookupGetter__('length')){
       Object.defineProperty(obj, 'length', {
        value:index
       });
       if(!Object.freeze){
          Object.defineProperty(Object, "freeze", {
                enumerable: false
              , configurable: false
              , writable: false
              , value: function (obj) {
                  var props = Object.getOwnPropertyNames(obj);
                  for(var i=0; i<props.length; i++){
                      var desc = Object.getOwnPropertyDescriptor(obj,props[i]);
                      if("value" in desc ){
                         desc.writable = false;
                      }
                      desc.configurable = false;
                      Object.defineProperty( obj, props[i], desc );
                  }
                  return Object.preventExtensions(obj);
              }
          });
       }
       Object.freeze(obj);
    }
    return obj;
}; 
```

我还发现了上一篇文章中提到的安格斯·克罗尔（Angus Croll）所说的内容。

“是的，我们可以利用像 underscore.js 这样编写良好的库提供的等效功能，但我们仍然被锁定在非标准的倒置签名中，其中方法是静态的，对象只是额外的参数——这是一种笨拙的安排一种仅实例语言。在某些时候，所有支持的浏览器都将兼容 ES5，此时已填充的代码库可以简单地删除它的 shim 库并继续执行，而未填充的代码库必须在主要重构或永久非标准和静态实用程序库。”

# php - Symfony2：使用 GD 时图像中的空格

> ID：15373346
> 
> 赞同：1
> 
> 时间：2013-03-12T22:18:07.717
> 
> 标签：php, symfony, gd

我目前正在从事一个项目，我必须渲染条形码才能打印它们。为此，我使用了我在网上获得的代码，如果我在单独的文件中使用它，它就可以正常工作。唯一的问题是我必须在 symfony 2.1 中使用它。

该脚本使用 GD 绘制条码。问题是当我尝试使用 imagepng 函数显示图像时，出现错误。在尝试将 png 作为附件文件下载后，我注意到 png 文件中的二进制数据之前有 4 个空格。它是这样开始的：

```
 ‰PNG 
```

如果我手动删除空格，则会显示图像，但我需要直接在浏览器中显示 png。

您是否知道为什么将空格添加到图像文件中？

这是用于生成 png 的代码。

```
 public function barcodeAction($text) {
    $response = new Response();
    $response->headers->set('Content-Type', 'image/png');
    $response->headers->set('Content-Disposition', sprintf('attachment; filename="%s.png"', $text));
    $size = "40";
    $code_string = "";

    $chksum = 104;

    $code_array = array(" " => "212222", "!" => "222122", "\"" => "222221", "#" => "121223", "$" => "121322", "%" => "131222", "&" => "122213", "'" => "122312", "(" => "132212", ")" => "221213", "*" => "221312", "+" => "231212", "," => "112232", "-" => "122132", "." => "122231", "/" => "113222", "0" => "123122", "1" => "123221", "2" => "223211", "3" => "221132", "4" => "221231", "5" => "213212", "6" => "223112", "7" => "312131", "8" => "311222", "9" => "321122", ":" => "321221", ";" => "312212", "<" => "322112", "=" => "322211", ">" => "212123", "?" => "212321", "@" => "232121", "A" => "111323", "B" => "131123", "C" => "131321", "D" => "112313", "E" => "132113", "F" => "132311", "G" => "211313", "H" => "231113", "I" => "231311", "J" => "112133", "K" => "112331", "L" => "132131", "M" => "113123", "N" => "113321", "O" => "133121", "P" => "313121", "Q" => "211331", "R" => "231131", "S" => "213113", "T" => "213311", "U" => "213131", "V" => "311123", "W" => "311321", "X" => "331121", "Y" => "312113", "Z" => "312311", "[" => "332111", "\\" => "314111", "]" => "221411", "^" => "431111", "_" => "111224", "\`" => "111422", "a" => "121124", "b" => "121421", "c" => "141122", "d" => "141221", "e" => "112214", "f" => "112412", "g" => "122114", "h" => "122411", "i" => "142112", "j" => "142211", "k" => "241211", "l" => "221114", "m" => "413111", "n" => "241112", "o" => "134111", "p" => "111242", "q" => "121142", "r" => "121241", "s" => "114212", "t" => "124112", "u" => "124211", "v" => "411212", "w" => "421112", "x" => "421211", "y" => "212141", "z" => "214121", "{" => "412121", "|" => "111143", "}" => "111341", "~" => "131141", "DEL" => "114113", "FNC 3" => "114311", "FNC 2" => "411113", "SHIFT" => "411311", "CODE C" => "113141", "FNC 4" => "114131", "CODE A" => "311141", "FNC 1" => "411131", "Start A" => "211412", "Start B" => "211214", "Start C" => "211232", "Stop" => "2331112");
    $code_keys = array_keys($code_array);
    $code_values = array_flip($code_keys);
    for ($X = 1; $X <= strlen($text); $X++) {
        $activeKey = substr($text, ($X - 1), 1);
        $code_string .= $code_array[$activeKey];
        $chksum = ($chksum + ($code_values[$activeKey] * $X));
    }
    $code_string .= $code_array[$code_keys[($chksum - (intval($chksum / 103) * 103))]];

    $code_string = "211214" . $code_string . "2331112";

    // Pad the edges of the barcode
    $code_length = 10;
    for ($i = 1; $i <= strlen($code_string); $i++) {
        $code_length = $code_length + (integer) (substr($code_string, ($i - 1), 1));
    }
    $img_width = $code_length;
    $img_height = $size;

    $image = imagecreate($img_width + 10, $img_height);
    $black = imagecolorallocate($image, 0, 0, 0);
    $white = imagecolorallocate($image, 255, 255, 255);

    imagefill($image, 0, 0, $white);

    $location = 10;
    for ($position = 1; $position <= strlen($code_string); $position++) {
        $cur_size = $location + (substr($code_string, ($position - 1), 1) );
        imagefilledrectangle($image, $location, 0, $cur_size, $img_height, ($position % 2 == 0 ? $white : $black));
        $location = $cur_size;
    }
    imagepng($image);
    imagedestroy($image);
    return $response;
} 
```

提前致谢。

* * *

**编辑：** 问题解决了。为此，我要感谢 Diego Agulló 和 hacfi。

当然，我在发布之前检查了包含该函数的 php 文件中是否有任何前导空格，所以我无法找出问题的根源。hacfi 的最后一条消息让我意识到空格可能来自在当前文件之前发送的文件。我在用于验证我的用户（验证提供程序和侦听器）的文件中发现了换行符。

所以，再一次，谢谢你。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T02:00:30.897

您的代码在我的服务器上运行良好（OS X，nginx 1.2.7 和 php-fpm 5.4.11）。前导空格必须来自控制器之前包含/加载的文件。

正确地将图像作为 Symfony\Component\HttpFoundation\Response 替换

`imagepng($image);`

和

`ob_start();
imagepng($image);
$imagevariable = ob_get_contents();
ob_end_clean();
$response->setContent($imagevariable);`

# php - PHP未定义索引：

> ID：15373348
> 
> 赞同：1
> 
> 时间：2013-03-12T22:18:26.950
> 
> 标签：php, html

我是 PHP 新手......只是在我的 about.php 文件中尝试这段简单的代码（通过超链接链接到 index.php 文件）：

```
<form action ="about.php" method="POST">
<ul>
    <li>
        <label for="name"> Enter your name please:</label>
        <input type="text" name="name"/>

    </li>   
    <li>
        <label for="comments" rows="20"> Enter your comments :</label>
        <textarea id="comments" name="comments" rows="5" cols="38">
            <?php 

                $name = $_POST["name"];

                if (!empty($name)) {
                echo "Your name is ".$name."and you like ny site!";
                } else {
                echo "Please enter your name";
                }

                ?> 
        </textarea> 
    </li>   
    <li>
        <input type="submit" />
    </li>   
</ul> 
```

我收到以下错误：

**注意**：未定义索引：第**71**行**D:\xampp\htdocs\stathis1\about\about.php**中 的名称 请输入您的姓名

 *** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:20:20.037

因为`$_POST["name"]`未设置，所以您会收到该通知。因此，您需要先测试它是否存在，然后将其分配给您的`$name`变量，如果未设置则为空字符串。

你可以改变

`$name = $_POST["name"];`

至

`$name = isset($_POST["name"])?$_POST["name"]:'';`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:21:02.767

使用 isset() 而不是 empty() 因为 isset() 函数在未定义索引时不会触发通知。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:21:57.913

这是因为`$_POST['name']`尚未提交/设置。您需要使用 if 语句或三元运算符：

```
if (isset($_POST['name'])) {
    $name = $_POST['name'];

    if (!empty($name)) {
        echo 'Your name is ' . $name . ' and you like ny site!';
    } else {
        echo 'Please enter your name';
    }
} 
```

或者，更短的方法：

```
$name = isset($_POST['name']) ? $_POST['name'] : ''; 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:22:01.797

在开始你的 php 部分之后，在代码周围添加这个 if 语句，所以它只在“名称”存在时执行。

```
if(isset($_POST["name"])) 
```

像这样：

```
<?php 
    if(isset($_POST["name"])){
        $name = $_POST["name"];

        if (!empty($name)) {
            echo "Your name is ".$name."and you like ny site!";
        } else {
            echo "Please enter your name";
        }
    } else {
        echo "Please enter your name";
    }
?> 
```**

# spring - SimpleJDBCTemplate 和 AbstractDataSource 配置

> ID：15373349
> 
> 赞同：3
> 
> 时间：2013-03-12T22:18:27.200
> 
> 标签：spring, jdbctemplate

我正在开发一个使用 SimpleJDBCTemplate 作为包装器来进行 JDBC 调用的应用程序。

但是，我选择使用 AbstractDataSource 而不是传统的数据源，因此我可以从多个数据源中进行选择。

我正在使用 ThreadLocal 注入密钥以选择适当的数据源。

但是，Spring 似乎急切地创建了我所有的 DAO 和我的 jdbcTemplate，因此我无法弄清楚如何让 jdbcTemplate 按需获取连接。

任何线索。？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T02:58:58.603

你的意思是[`AbstractRoutingDataSource`](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/jdbc/datasource/lookup/AbstractRoutingDataSource.html)？如果没有，你真的应该使用它，因为这正是它的用途。当它被添加到框架中时，Mark Fisher[写了一篇关于它的有用博客。](http://blog.springsource.com/2007/01/23/dynamic-datasource-routing/)

是的，如果它们是单例，Spring 会急切地创建你的 DAO 和 JdbcTemplates，这是默认设置，但这并不意味着它们都立即获得连接。仅当您开始使用该数据源的某种操作时才会获得连接。通常，这将启动交易。换句话说，你说你想要发生的就是已经发生的事情。

# xml - 如何从父节点查询所有子节点？

> ID：15373352
> 
> 赞同：1
> 
> 时间：2013-03-12T22:18:28.973
> 
> 标签：xml, tsql, cross-apply

```
DECLARE @xml AS XML

SET @xml = CAST('<codes><pcc>DFC</pcc><pcc>MAI</pcc><pcc>PFS</pcc></codes>' AS XML)

SELECT  pcc.value('pcc[1]', 'varchar(max)') AS [ColumnTest]
FROM    @xml.nodes('/codes') results ( pcc ) 
```

我有这个非常简单的 xml，并试图将`<pcc>`节点中的所有数据提取到结果集中。我读到我将以某种方式使用 CROSS APPLY，但到目前为止我的努力都失败了。

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T06:12:19.310

```
 DECLARE @xml AS XML
    SET @xml = CAST('<codes><pcc>DFC</pcc><pcc>MAI</pcc><pcc>PFS</pcc></codes>' AS XML)
    SELECT  pcc.value('.', 'varchar(max)') AS [ColumnTest]
    FROM    @xml.nodes('/codes/pcc') results ( pcc ) 
```

# c# - 在 catch 块中调用异步方法

> ID：15373353
> 
> 赞同：2
> 
> 时间：2013-03-12T22:18:29.227
> 
> 标签：c#, .net, silverlight, async-await

我在异步环境（Silverlight）中工作，并拥有我用来在服务器端存储异常的 Logger 服务。

考虑这段代码：

```
 catch (Exception ex)
    {
        this.loggerService.LogAsync(ex, "NotesService");
    } 
```

记录器看起来像这样：

```
public interface ILoggerService
    {
        Task LogAsync(Exception ex, string tag);
    } 
```

如果我像上面那样编写代码（甚至 catch 是在异步方法中），我就不能在那里等待。如果我保持原样，我会收到警告说执行仍在继续，等等，等等。这很好，我不在乎。我只需要记录错误。

我可以取消这个警告还是应该为此想出更好的模式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T00:12:07.497

由于您绝对确定要忽略来自 的完成/错误`LogAsync`，因此可以执行以下简单的解决方法：

```
catch (Exception ex)
{
    var _ = this.loggerService.LogAsync(ex, "NotesService");
} 
```

# javascript - 如何通过诺基亚地图使用国家代码设置国家？

> ID：15373363
> 
> 赞同：0
> 
> 时间：2013-03-12T22:18:59.693
> 
> 标签：javascript, here-api, geocode

我读过你可以使用国家代码搜索一个国家（我用[诺基亚尝试过，这](http://here.com)很棒），我国家的代码是*“SV”*（我来自萨尔瓦多）但我不知道如何实施。我在 API 指南中找到了这些代码：[Interface nokia.maps.search.Address](http://api.maps.nokia.com/2.1.1/apireference/symbols/nokia.maps.search.Address.html)，但他们没有任何示例。

你能给我一个非常简单的例子如何实现吗？因为我找不到任何例子。如果您知道如何在您选择的国家/地区设置自动缩放，我会非常感激。非常感谢您的帮助和宝贵的时间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T13:28:50.633

HERE 地图地理编码服务在文档中进行了描述[-](http://developer.here.com/docs/maps_js/topics_api_pub/nokia.places.search.manager.html#topic-apiref__manager-geoCode)请注意，API 的最新版本是 2.2.4 版本，而不是链接中提到的 2.1.1。

应使用以下脚本加载最新的库

```
<script type="text/javascript" charset="UTF-8" src="http://api.maps.nokia.com/2.2.4/jsl.js?with=all"></script> 
```

可以使用自由文本地址或结构化地址进行地理编码请求。

对于自由文本搜索，您提出如下请求：

```
var searchTerm = "berlin";

nokia.places.search.manager.geoCode({
    searchTerm: searchTerm,
    onComplete: processResults
}); 
```

这将找到世界上最大的城市**柏林** ，即德国的城市。

对于结构化地址搜索，您提出如下请求：

```
var address = new Object();

address.countryCode = "USA";
address.city = "Berlin";

nokia.places.search.manager.geoCode({
    address: address,
    onComplete: processResults
}); 
```

这将找到位于美国新罕布什尔州的柏林市。**地址对象可以包含**[地址](http://developer.here.com/docs/maps_js/topics_api_pub/nokia.places.objects.Place.location.address.html)中描述的任何属性

关于缩放到一个国家 - 这实际上是一种**findPlaces**搜索 - 您正在寻找具有国家名称的行政区域的地方搜索的第一个（即最重要的）结果。以下代码将缩放到萨尔瓦多：

```
var zoomTo = function (data, status) {

    if (status == "OK") {
        var locations = data.results.items;
        for (var i = 0, len = locations.length ;  i < len ; i++) {

            if ( "administrative-region"  == locations[i].category.categoryId){                             
                map.zoomTo(nokia.maps.geo.BoundingBox.coverAll
                        ([locations[i].boundingBox.topLeft,
                         locations[i].boundingBox.bottomRight ]), false);
                break;
            }
        }
    } else {
        alert("The search request failed");
    }
};

var term = "El Salvador";       
nokia.places.search.manager.findPlaces({
    searchTerm: term,
    onComplete: zoomTo ,
    boundingBox: {
        topLeft: {
            latitude: 85,
            longitude: -179.99
        },
        bottomRight: {
            latitude: -85,
            longitude: 179.99
        }
    }
}); 
```

# bash - 用于用户名/密码结构的 BASH 脚本

> ID：15373366
> 
> 赞同：1
> 
> 时间：2013-03-12T22:19:10.867
> 
> 标签：bash, shell, unix, ssh

我想使用 ncat 编写一个简单的 bash 脚本来打开与 ISP 及其端口的连接。

第一个命令是：

```
nc address port 
```

执行此操作后，系统会首先提示我提供用户名。我必须按 ENTER，然后系统会提示我提供密码，然后我必须再次按 ENTER。

在此之后，我想打开一个终端进程窗口。谁能指出我有足够的资源来编写这种类型的脚本？

我已经知道用户名和密码，但我不太确定如何解决必须提供它然后按 Enter 的事实。我也不确定如何打开一个新的终端进程。

提前致谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:23:20.193

查看期望脚本 [期望](http://en.wikipedia.org/wiki/Expect)

例子：

```
# Assume $remote_server, $my_user_id, $my_password, and $my_command were read in earlier
# in the script.
# Open a telnet session to a remote server, and wait for a username prompt.
spawn telnet $remote_server
expect "username:"
# Send the username, and then wait for a password prompt.
send "$my_user_id\r"
expect "password:"
# Send the password, and then wait for a shell prompt.
send "$my_password\r"
expect "%"
# Send the prebuilt command, and then wait for another shell prompt.
send "$my_command\r"
expect "%"
# Capture the results of the command into a variable. This can be displayed, or written to disk.
set results $expect_out(buffer)
# Exit the telnet session, and wait for a special end-of-file character.
send "exit\r"
expect eof 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:20:38.100

秘密在于[HEREDOC](http://tldp.org/LDP/abs/html/here-docs.html)

您可以通过以下方式解决此问题：

```
$ command-that-needs-input <<EOF
authenticate here
issue a command
issue another command
EOF 
```

查看我为此处文档提供的链接——它包括对变量替换的支持和许多其他有用的东西。享受！

# c# - 在另一个集合内和按另一个集合的总和对集合进行排序

> ID：15373391
> 
> 赞同：0
> 
> 时间：2013-03-12T22:20:25.120
> 
> 标签：c#, sorting, collections

2班

```
 public class Student
    {
        public int StudentID { get; set;}
        public string Name { get; set;}
        public List<Fee> Fees {get;set;}
    }

    public class Fee
    {
        public int FeeID { get; set;}
        public decimal FeeAmount { get; set; }
    } 
```

假设有 10 个学生对象 Student[] stud = new Student[10]

如果 stud[0] 有 2 项费用（ Fee[2] ）并且他们是

```
FeeID=1, FeeAmount=54.23
FeeID=2, FeeAmount=234.98 
```

如果 stud[1] 有 1 笔费用（ Fee[2] ）并且他们是

```
FeeID=1, FeeAmount=9.99 
```

如果 stud[2] 有 3 项费用（ Fee[3] ）并且它们是

```
FeeID=1, FeeAmount=123.45
FeeID=2, FeeAmount=67.89
FeeID=3, FeeAmount=987.65 
```

我需要按 TotalAmount(Fee Collection) 对学生收藏进行排序

```
TotalAmount of Fee 
stud[0] = 54.23+234.98=289.21
stud[1] = =9,99
stud[2] = 123.45+67.89+987.65=1178.99 
```

在那里排序后它应该变成

```
stud[0] = 123.45+67.89+987.65=1178.99
stud[1] = 54.23+234.98=289.21
stud[2] = =9,99 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:22:23.173

听起来你只是想要：

```
stud = stud.OrderByDescending(x => x.Fees.Sum(fee => fee.FeeAmount)).ToArray(); 
```

一定要爱 LINQ :)

有几点需要注意：

*   这仍然只会计算每个学生一次的费用总和
*   这目前*不会*处理空元素。你需要吗？（你似乎有一个固定的数组大小......也许`List<Student>`改用？）
*   除非你之后真的*需要*它作为一个数组，否则只需挂断`ToArray`电话。请注意，除非您使用或虽然，否则每次迭代它*都会对其进行排序。*`ToArray``ToList`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:22:54.653

```
var results = stud.OrderByDescending(s => s.Fees.Sum(f => f.FeeAmount)).ToArray(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:23:17.750

一个简单的 Linq 查询应该可以完成这项工作：

```
stud =
    (from s in stud
     orderby s.Fees.Sum(f => f.FeeAmount)
     select s)
    .ToArray(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:24:00.130

```
var students = new List<Student>() { .. add students here ... };
students.OrderBy(x => x.Fees.Sum(y => y.FeeAmount)); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T22:40:24.343

如果您使用旧的 .net 框架（没有 Linq）：

```
public class Student : IComparable
{
    public int StudentID { get; set; }
    public string Name { get; set; }
    public List<Fee> Fees { get; set; }

    private decimal TotalAmount
    {
        get
        {
            decimal total = 0;
            if (Fees != null)
                foreach (var fee in Fees)
                    total += fee.FeeAmount;
            return total;
        }
    }

    public int CompareTo(object obj)
    {
        //Ascending
        //return TotalAmount.CompareTo((obj as Student).TotalAmount);

        //Descending
        return (obj as Student).TotalAmount.CompareTo(TotalAmount);
    }
}

public class Fee
{
    public int FeeID { get; set; }
    public decimal FeeAmount { get; set; }
}

List<Student> students = new List<Student>();
...
students.Sort(); 
```

林克更好...

# c# - 通过字符串获取参数和元素

> ID：15373413
> 
> 赞同：0
> 
> 时间：2013-03-12T22:21:44.003
> 
> 标签：c#, properties, parameters, get

如何在c#中实现这个方法：

```
public static void SetParam(string element, string property, dynamic value){
 // Do something
}

// Usage:
setParam("textBox1","Text","Hello"); 
```

在 JavaScript 中，这看起来：

```
function SetParam(element, property, value) {
 document.getElementById(element)[property]=value;
}

// Usage:
SetParam("textBox","value","Hello"); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:10:40.693

如果我正确理解你的问题，这可以通过**[反射](http://msdn.microsoft.com/en-us/library/ms173183%28v=vs.80%29.aspx)**的一点帮助来完成......

首先添加一个：`using System.Reflection;`到你的cs文件的顶部。

由于我不知道您使用的是 WPF 还是 Winforms - 这里有 2 个示例...
WPF：

您可以使用此版本的 SetParam：

```
private void SetParam(string name, string property, dynamic value)
{
      // Find the object based on it's name
      object target = this.FindName(name);

      if (target != null)
      {
          // Find the correct property
          Type type = target.GetType();
          PropertyInfo prop = type.GetProperty(property);

          // Change the value of the property
          prop.SetValue(target, value);
      }
} 
```

用法：

```
private void Window_Loaded(object sender, RoutedEventArgs e)
{
   SetParam("textbox", "Text", "Hello"); 
```

`textbox`像这样声明的地方：

```
<TextBox x:Name="textbox" /> 
```

对于 Winforms，只需将 SetParam 更改为：

```
private void SetParam(string name, string property, dynamic value)
{
      // Find the object based on it's name
      object target = this.Controls.Cast<Control>().FirstOrDefault(c => c.Name == name);

      if (target != null)
      {
          // Find the correct property
          Type type = target.GetType();
          PropertyInfo prop = type.GetProperty(property);

          // Change the value of the property
          prop.SetValue(target, value);
      }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:11:50.763

也许以下内容对您有用。

```
public void SetParam(string element, string property, dynamic value)
{
    FieldInfo field = typeof(Form1).GetField(element, BindingFlags.NonPublic | BindingFlags.Instance);
    object control = field.GetValue(this);
    control.GetType().GetProperty(property).SetValue(control, value, null);
} 
```

替换`Form1`为包含要修改的控件的表单类。

编辑：在阅读了 Blachshma 的回答后，我意识到你必须把

```
using System.Reflection; 
```

在文件的顶部。

我还假设它是用于 Windows 窗体应用程序的。

最后，获取控件引用的更好方法可能是使用`Form.Controls`Greg 建议的属性。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T23:16:46.553

假设“元素”变量是控件的 Id，然后使用反射：

```
PropertyInfo propertyInfo = form1.Controls.Where(c => c.id == element).FirstOrDefault().GetType().GetProperty(property,
                            BindingFlags.Instance | BindingFlags.Public | BindingFlags.IgnoreCase);
    if (propertyInfo != null)
    {
        if (propertyInfo.PropertyType.Equals(value.GetType()))
            propertyInfo.SetValue(control, value, null);
        else
            throw new Exception("Property DataType mismatch, expecting a " +
                                propertyInfo.PropertyType.ToString() + " and got a " +
                                value.GetType().ToString());
    }
} 
```

# c# - 开源一个小项目的步骤

> ID：15373420
> 
> 赞同：-1
> 
> 时间：2013-03-12T22:22:17.993
> 
> 标签：c#, .net, git, open-source

在一些同事的最终帮助下，我几乎一个人在一个小项目上工作了几年。这个项目正在脱离我的掌控，因为代码的大小正在增长（现在大约 20K 行），而且我对它的最初期望已经超出了我自己的能力和时间。所以现在我想开源它，希望能吸引一些贡献者。我开源的动机是：

*   该项目相当学术（科学计算的算法库），我对它没有任何经济兴趣。
*   这个项目太大了，我一个人无法处理，而我计划的功能数量足以让一个小团队保持积极性（我认为）。
*   它需要大量的测试，不仅仅是单元测试，而是在现实世界中测试，看看 API 是否易于使用，性能是否符合预期等。
*   我敢肯定它有很多错误，但我只能找到一些，因为它是我一个人测试的。
*   它需要适当的文档，因为 API 变得有点复杂。

除此之外，我认为该项目可以从社区中受益，以决定哪些功能是最需要的，并为未来的发展制定一套指导方针。

我正在使用 Git，所以我的第一个想法是在 Github 和/或 Codeplex 上发布它。除此之外，还有哪些步骤可以帮助慢慢发展一个用户社区，也许还有围绕它的开发人员？我需要自己的域，还是应该坚持使用 Github/Codeplex？如何建立一个平台以供可能在地理上分散的开发人员之间进行协作？我应该建立一个邮件列表吗？最重要的是，我如何吸引人们使用它并与之合作？

该项目是一个用于优化和机器学习的 .NET 库，用 C# 编写。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:30:00.353

我在这里只能给出一条建议；使用 Github。它很常见，（几乎）每个人都知道它，它很容易使用，而且你想要吸引的社区已经在上面了。它有很多你可能没有想到的工具，但可能会派上用场。它几乎是您想要做的事情的完美解决方案，所以不要想太多。

至于吸引人们使用和贡献，如果它是有用的和好的东西，人们会找到它。我用一个简单的谷歌找到了很多不起眼的项目。如果有人在谷歌上搜索与您的项目相关的东西（并且它的名称合适等），他们很可能会找到它。但是，您实际上无能为力来强迫需求，只是让它发生。至于贡献者，使用它的人可能会贡献他们的补充。只要确保积极参与管理它（监控拉取请求等）。如果没有人接受请求或管理版本，贡献者可能会开始放弃您的项目。

# php - 赞助年份的 PHP 数组分组

> ID：15373436
> 
> 赞同：0
> 
> 时间：2013-03-12T22:23:17.400
> 
> 标签：php, arrays, multidimensional-array, associative-array

我正在尝试生成一个分组数组。

这是我的代码：

```
function group_assoc($array, $key) {
$return = array();
foreach($array as $v) {
    $return[$v[$key]][] = $v;
}
return $return;
} 
```

这是当前的输出：

```
Array
(
[2007] => Array
    (
        [0] => Array
            (
                [sponsorID] => 4
                [showType] => 2
                [categoryID] => 3
                [sponYear] => 2007
                [sponName] => asdasd
                [sponFileName] => design-desktop-wallpaper-2114754569.jpg
            )

    )

[2013] => Array
    (
        [0] => Array
            (
                [sponsorID] => 2
                [showType] => 1
                [categoryID] => 6
                [sponYear] => 2013
                [sponName] => Test Sponsor
                [sponFileName] => Jellyfish.jpg
            )

        [1] => Array
            (
                [sponsorID] => 3
                [showType] => 2
                [categoryID] => 1
                [sponYear] => 2013
                [sponName] => asdads
                [sponFileName] => Jellyfish.jpg
            )

    )

) 
```

我该怎么做这样的事情：

```
Array
(
[0] => 
[sponYear] => '2013'
Array
    (
        [0] => Array
            (
                [sponsorID] => 4
                [showType] => 2
                [categoryID] => 3
                [sponYear] => 2007
                [sponName] => asdasd
                [sponFileName] => design-desktop-wallpaper-2114754569.jpg
            )

    )

[1] => 
[sponYear] => '2007'
Array
    (
        [0] => Array
            (
                [sponsorID] => 2
                [showType] => 1
                [categoryID] => 6
                [sponYear] => 2013
                [sponName] => Test Sponsor
                [sponFileName] => Jellyfish.jpg
            )

        [1] => Array
            (
                [sponsorID] => 3
                [showType] => 2
                [categoryID] => 1
                [sponYear] => 2013
                [sponName] => asdads
                [sponFileName] => Jellyfish.jpg
            )

    )

) 
```

这样当我运行初始循环进行显示时，我可以显示“sponYear”？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:32:01.473

您可以通过更改消耗它的 foreach 循环来按原样使用当前输出。

```
foreach (group_assoc($input_array, $my_key) as $year => $sponsors) {
    foreach ($sponsors as $sponsor) {
        // Do stuff with $sponsor['sponName'] etc.
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:31:36.493

我猜你每年的阵列都是赞助商。所以你的功能是：

```
function group_assoc($array, $key) {
    $return = array(
        'sponYear' => $key,
        'sponsors' => array()
    );
    foreach($array as $v) {
        $return['sponsors'][] = $v;
    }
    return $return;
} 
```

# linux - 为什么 cmp 2, 2 不等于 0

> ID：15373440
> 
> 赞同：0
> 
> 时间：2013-03-12T22:23:34.680
> 
> 标签：linux, assembly, nasm

```
extern putchar
extern exit
section .data

section .text
global main
main:

push 's'

mov eax, 2

cmp eax, 2

point:
call putchar
jz point

push 0
call exit 
```

在控制台上，我只看到一个 's' 字符。

**编译并运行：**

```
nasm -f elf ./prog.asm
gcc -m32 -o prog ./prog.o
./prog 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T00:02:34.560

`cmp` *是*“等于 0”（也就是说，它*确实*设置了 ZF 标志）。但是，`call putchar`下一行中的 正在丢弃由 设置的标志`cmp`，因此您`jz`不起作用（或多或少是偶然的）。如果您想保存标志以供以后比较，您可以使用`pushf`and `popf`，但是这在您的情况下不会真正起作用，因为`putchar`会期望堆栈中的字符，而不是标志。

现在，回答您没有说明的*实际问题。*我假设你想打印 's' 两次。以下是如何正确执行此操作：

```
 mov eax, 2 ; init counter

print_loop:
  push eax; save the counter since it will be trashed by putchar
  push 's'
  call putchar
  add esp, 4 ; restore the stack pointer since putchar is cdecl
  pop eax ; restore the saved counter
  dec eax ; decrement it
  jnz print_loop ; if it's not yet zero, do another loop 
```

`add esp, 4`可以用另一个`pop eax`稍短的代码替换。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:26:35.090

执行 a 的结果`cmp`是标志被设置`zf`为零，等等。然后，您可以根据是否设置了标志进行分支，或者使用其中一条`set?`指令`al`根据是否设置了标志来设置值，例如寄存器。

# paypal - 如何使用 PayPal 的 Merchant-sdk-java 减少计费周期的经过时间？

> ID：15373445
> 
> 赞同：1
> 
> 时间：2013-03-12T22:24:01.517
> 
> 标签：paypal, paypal-ipn, paypal-sandbox

根据有关[“测试定期付款”的文档](http://www.paypalobjects.com/en_US/ebook/PP_Sandbox_UserGuide/testing_recurringpayments.html)

> 指定 Day 时，在 Sandbox 中每 n 分钟发生一次计费周期，其中 n 表示频率；

所以这就是我所做的：

```
DateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss:'000Z'");
df.setTimeZone(TimeZone.getTimeZone("GMT"));
RecurringPaymentsProfileDetailsType profileDetails = new RecurringPaymentsProfileDetailsType(df.format(new Date()));

BillingPeriodDetailsType trialPeriod = new BillingPeriodDetailsType(BillingPeriodType.DAY, 1, new BasicAmountType(CurrencyCodeType.USD, "40"));
trialPeriod.setTotalBillingCycles(1);

ScheduleDetailsType scheduleDetails = new ScheduleDetailsType();
scheduleDetails.setPaymentPeriod(new BillingPeriodDetailsType(BillingPeriodType.DAY, 1, new BasicAmountType(CurrencyCodeType.USD, "40")));
scheduleDetails.setDescription(agreementDescription);
scheduleDetails.setTrialPeriod(trialPeriod);

CreateRecurringPaymentsProfileRequestDetailsType reqDetails = new CreateRecurringPaymentsProfileRequestDetailsType(profileDetails, scheduleDetails);
reqDetails.setToken(token);

CreateRecurringPaymentsProfileRequestType reqType = new CreateRecurringPaymentsProfileRequestType();
reqType.setCreateRecurringPaymentsProfileRequestDetails(reqDetails);

CreateRecurringPaymentsProfileReq req = new CreateRecurringPaymentsProfileReq();
req.setCreateRecurringPaymentsProfileRequest(reqType);

return service.createRecurringPaymentsProfile(req); 
```

这段代码很好用，除了它不能加快进程的问题（对我来说是个大问题）。没有它，就不可能测试*IPN*的*Recurring Payments*。

根据this [other forum post](https://www.x.com/developers/paypal/forums/ipn/pdt/sandbox-ipn-recurring-payment-speed-parameters-still-need-help)，我可能需要为我的沙盒业务帐户启用“测试模式”，但我无法在新的沙盒站点中找到该选项。

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T01:32:09.443

不幸的是，这是一个推出的功能，并在短时间内被删除。您能够测试的唯一方法是将定期付款设置为每天计费。解决此问题的一种方法是创建一个包含您要发送的所有变量的表单发布，然后让它将数据发布到您的脚本并执行它应该做的事情。你只需要绕过让它验证的逻辑。但是，一旦您完成了所有测试，您就可以返回并运行一些测试以确保您的脚本验证帖子。使用表单将变量发布到您的脚本中，您可以根据需要进行尽可能多的测试，而无需每天等待定期付款结算。

# ios - iOS 标签阴影

> ID：15373446
> 
> 赞同：0
> 
> 时间：2013-03-12T22:24:04.433
> 
> 标签：ios, format, shadow

我这里有这段代码，

```
label.layer.shadowColor = [UIColor orangeColor].CGColor;
label.layer.shadowOffset = CGSizeMake(0,1);
label.layer.shadowRadius = 3.0;
label.layer.shadowOpacity = 0.5;
label.layer.shadowPath = [[UIBezierPath bezierPathWithRoundedRect:label.frame cornerRadius:20]CGPath]; 
```

我使用橙色进行测试。为什么这不显示为阴影？我所看到的就是这个， http: [//img12.imageshack.us/img12/1568/screenshot20130312at415.png](http://img12.imageshack.us/img12/1568/screenshot20130312at415.png)

我试图让内部的灰色标签在边缘有一个阴影......有什么帮助吗？

-亨利

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:50:52.267

您需要使用`label.bounds`，而不是`label.frame`，来创建路径。另外，确保`label.clipsToBounds`是`NO`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:30:14.137

尝试设置`shadowOffset`-1

```
label.layer.shadowOpacity = 1.0;
label.layer.shadowRadius =2.0;
label.layer.shadowColor = [UIColor blackColor].CGColor;
label.layer.shadowOffset = CGSizeMake(0.01,-1.0); 
```

也设置`label.bounds`而不是`label.frame`

```
label.layer.shadowPath = [[UIBezierPath bezierPathWithRoundedRect:label.bounds cornerRadius:20]CGPath]; 
```

# android - 初始化向量异常

> ID：15373448
> 
> 赞同：0
> 
> 时间：2013-03-12T22:24:22.283
> 
> 标签：android, security, exception, encryption

我想按以下顺序使用这些元素构建一个字节数组：

*   对称加密的 AES 密钥（带有用于 AES 128 的随机密钥，用于 AES 128 的随机初始化向量。在 CBC 模式和 PKCS5 填充下使用 AES 128 加密。在加密之前，文本以 UTF-8 编码）
*   AES IV
*   加密消息（使用 ECB 模式下的 RSA 算法和 PKCS1 填充，之前生成的密钥和消息接收者的公钥）

我正在做的是获取每个参数的长度，以便创建新的字节 []。然后在一个 for 循环中，我尝试按顺序添加三个元素。

```
public void encrypt(String original)
{
    SecureRandom sr = new SecureRandom();

    byte [] key = new byte[16];
    byte [] iv = new byte[16];

    sr.nextBytes(key);
    sr.nextBytes(iv);

    Cipher cipher;

    try 
    {
        cipher = Cipher.getInstance("AES/CBC/PKCS5Padding");
        IvParameterSpec IV=new IvParameterSpec(iv);
        cipher.init(Cipher.ENCRYPT_MODE, new SecretKeySpec(key,"AES"), IV);
        byte[] utf8 = original.getBytes("UTF-8");
        byte []encryptedAES = cipher.doFinal(utf8);

        KeyPairGenerator kpg = KeyPairGenerator.getInstance("RSA");
        kpg.initialize(128);//128 bits
        KeyPair kp = kpg.genKeyPair();

        Cipher publicKeyCipher = Cipher.getInstance("RSA/ECB/PKCS1PADDING");
        publicKeyCipher.init(Cipher.ENCRYPT_MODE, kp.getPublic());
        byte [] encryptedRSA = publicKeyCipher.doFinal(encryptedAES); //error here

        int length1=encryptedAES.length;
        int length2=IV.getIV().length;
        int length3=encryptedRSA.length;
        int length=length1+length2+length3;
        byte [] result= new byte[length];

        int l=0,m=0;

        for (int i=0; i<length; i++)
        {
            if(i<length1)
            {
                result[i] = encryptedAES[i];
            }
            else if(i>=length1 && i<length2)
            {
                result[i] = IV.getIV()[l];
                l++;
            }
            else if(i>=length2)
            {
                result[i] = encryptedRSA[m];
                m++;
            }
        }
        Log.i("Encrypted", "done");
        this.encryptedMessage=Base64.encodeToString(result, false);
        Log.i("Encrypted Message:", this.encryptedMessage);

    } catch (NoSuchAlgorithmException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (NoSuchPaddingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InvalidKeyException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (InvalidAlgorithmParameterException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IllegalBlockSizeException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (BadPaddingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (UnsupportedEncodingException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }
} 
```

我得到的例外是：

```
java.lang.ArrayIndexOutOfBoundsException: too much data for RSA block 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:34:20.913

显然你的 IV 必须是 16 字节，而不是 128 字节。（128 位 = 16 字节）

# javascript - 无法将纯 HTML 的 Ajax 响应附加到 IE8 中现有的 dom 元素的原因？

> ID：15373450
> 
> 赞同：0
> 
> 时间：2013-03-12T22:24:24.703
> 
> 标签：javascript, jquery, internet-explorer, internet-explorer-8, append

我在这里不知所措...

我触发了一个 Ajax 请求，它返回一个 HTML 响应，我想将它附加到一个名为`$('.resultsBox')`.

在我测试的所有浏览器上，这都没有问题。只有 IE8 不这样做，我不知道为什么。

我的代码很简单：

```
alert(html_response);     // HTML snippet
alert($('.resultsBox').length);  // 1
$('.resultsBox').append( html_response ); 
```

**问题**：知道为什么这在 IE8 中不起作用吗？

谢谢！

**编辑：**所以响应非常大:-)

**整理：**

[http://jsfiddle.net/userdude/JwZsh/](http://jsfiddle.net/userdude/JwZsh/)

```
 <div class="container shrink searchResults singleResult"> <form action="fh_suche.cfm" method="post"  name="basket"> <input type="hidden" name="form_submitted" value="add_to_basket"> <input type="hidden" name="in_den_warenkorb" value="ja"> <input type="hidden" name="sortierung" value="a.artikelnummer"> <input type="hidden" name="sortierung2" value="DESC"> <input type="hidden" name="s_artikelbezeichnung" value=""> <input type="hidden" name="s_firma" value="KG"> <input type="hidden" name="s_marke" value="^"> <input type="hidden" name="s_artikelnummer" value="1-9_86278"> <input type="hidden" name="s_groesse" value=""> <input type="hidden" name="s_preis_v" value="4.4"> <input type="hidden" name="s_preis_b" value="4.4"> <input type="hidden" name="s_farbe" value=""> <input type="hidden" name="anzahl_eintraege" value="24"> <input type="hidden" name="startzeile" value="1"> <input type="hidden" name="iln_artikel" value="9900000004620"> <input type="hidden" name="order_art" value="nein"> <input type="hidden" name="loaded" value="nein"> <div class="row"> <div class="span3 aC"> <div><img src="http://s3.amazonaws.com/i.stokkers.mobi/9900000004620/m_1717265_0.jpg" alt="1-9_86278, Größen: " title="Soft-BH gen." class="adaptImg ui-corner-all" /></div> </div> <div class="span5"> <div class="ui-btn-up-c ui-corner-all ui-field-contain ui-body ui-br" data-role="fieldcontain"> <ul class="styleInfoBox ui-listview ui-listview-inset ui-corner-all ui-shadow" data-inset="true" data-role="listview"> <li class="ui-li ui-li-static ui-btn-up-c ui-corner-top"> <span class="ui-fake-label">Artikel</span> <span class="ui-fake-input">1-9_86278</span> </li> <li class="ui-li ui-li-static ui-btn-up-c ui-corner-bottom"> <span class="ui-fake-label">Info</span> <span class="ui-fake-input">Soft-BH gen.</span> </li> </ul> </div> </div> <div class="span4 span2xl"> <div class="ui-btn-up-c ui-corner-all ui-field-contain ui-body ui-br" data-role="fieldcontain"> <ul class="styleInfoBox ui-listview ui-listview-inset ui-corner-all ui-shadow" data-inset="true" data-role="listview"> <li class="ui-li ui-li-static ui-btn-up-c ui-corner-top"><span class="ui-fake-label">Preise</span></li> <li class="ui-li ui-li-static ui-btn-up-c"><span class="ui-fake-label">Einkauf</span><span class="ui-fake-input">1.00 EUR</span></li> <li class="ui-li ui-li-static ui-btn-up-c"><span class="ui-fake-label ui-highlight">Aktuell</span><span class="ui-fake-input ui-highlight">4.40 EUR</span></li> <li class="ui-li ui-li-static ui-btn-up-c"><span class="ui-fake-label">Rabatt</span><span class="ui-fake-input">340.00%</span></li> <li class="ui-li ui-li-static ui-btn-up-c ui-corner-bottom ui-li-last"><span class="ui-fake-label">Empf. Vk</span><span class="ui-fake-input">4.40 EUR</span></li> </ul> </div> </div> </div> <div class="row"> <div class="span12 detailBox"> <div class="collDisplay ui-collapsible-set ui-collapsible-set-horizontal ui-grid-a" data-create="false" data-content-theme="c" data-theme="c" data-type="horizontal" data-role="collapsible-set"> <div data-theme="c" data-icon="order" class="ui-nopad ui-collapsible ui-collapsible-inset ui-block-a" data-collapsed="false" data-role="collapsible"> <h3 class="ui-collapsible-heading"> <a class="ui-collapsible-heading-toggle ui-btn ui-btn-icon-left ui-corner-tl ui-btn-up-c" href="#"> <span class="ui-btn-inner ui-corner-tl"> <span class="ui-btn-text">Ordern
<span class="ui-collapsible-heading-status">Anklicken um Inhalte anzuzeigen</span> </span> </span> </a> </h3> <div class="ui-collapsible-content ui-body-c ui-corner-bottom" aria-hidden="false"> <div class="orderBox sizeBlock ui-box-inner overthrow noscroll"> <ul class="sizeChart"> <li class="sizeRow sizeHead"> <span class="sizeHeader">Farben/Größen</span> <span class="sizeButton">80B</span> <span class="sizeButton">85B</span> <span class="sizeButton">90B</span> <span class="sizeButton">95B</span> <span class="sizeButton">100B</span> <span class="sizeButton">80C</span> <span class="sizeButton">85C</span> <span class="sizeButton">90C</span> <span class="sizeButton">95C</span> <span class="sizeButton">100C</span> </li> <li class="sizeRow sizeEntry"> <div class="colorWrapper"><span class="pT elip">Weiss (300)</span></div> <div class="entry "> <label class="ui-hidden-accessible" for="qty1">80B</label> <input type="hidden" value="4005333621058" name="ean1"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty1" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld1" name="menge1"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty2">85B</label> <input type="hidden" value="4005333621065" name="ean2"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty2" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld2" name="menge2"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty3">90B</label> <input type="hidden" value="4005333621072" name="ean3"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty3" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld3" name="menge3"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty4">95B</label> <input type="hidden" value="4005333621089" name="ean4"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty4" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld4" name="menge4"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty5">100B</label> <input type="hidden" value="4005333621096" name="ean5"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25"  data-flag="false" id="qty5" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld5" name="menge5"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty6">80C</label> <input type="hidden" value="4005333621119" name="ean6"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty6" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld6" name="menge6"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty7">85C</label> <input type="hidden" value="4005333621126" name="ean7"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty7" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld7" name="menge7"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty8">90C</label> <input type="hidden" value="4005333621133" name="ean8"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
 class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty8" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld8" name="menge8"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty9">95C</label> <input type="hidden" value="4005333621140" name="ean9"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
  class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty9" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld9" name="menge9"> </div> <div class="entry "> <label class="ui-hidden-accessible" for="qty10">100C</label> <input type="hidden" value="4005333621157" name="ean10"> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="" data-iconpos="" data-theme="c" data-inline="true" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-c" aria-disabled="false"> <span class="ui-btn-inner ui-btn-corner-all "> <span class="ui-btn-text">>25</span> </span> <input type="button"
  class="qtyInput ui-btn-hidden" data-create="false" value=">25" data-inline="true" data-remember=">25" data-flag="false" id="qty10" aria-disabled="false"> </div> <input type="hidden" value="" id="mengenfeld10" name="menge10"> </div> </li> </ul> <input type="hidden" value="10" name="artikel_anzahl"> </div> <div class="buttonBar ui-corner-bottom ui-btn-up-c"> <div data-theme="c" data-create="false" class="cleanUp ui-corner-all ui-controlgroup ui-controlgroup-horizontal" data-type="horizontal" data-role="controlgroup"> <div class="ui-controlgroup-controls"> <div class="ui-radio"> <input data-create="false" checked="checked"             type="radio" value="1" id="radio_add_one" name="radio_add" data-theme="c"> <label for="radio_add_one" data-corners="true" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-theme="c" class="ui-btn ui-btn-up-c ui-radio-on ui-btn-active ui-corner-left"> <span class="ui-btn-inner ui-corner-left"> <span class="ui-btn-text">+1</span> </span> </label> </div> <div class="ui-radio"> <input data-create="false"
 type="radio" value="2" id="radio_add_two" name="radio_add" data-theme="c"> <label for="radio_add_two" data-corners="true" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-theme="c" class="ui-btn ui-btn-up-c ui-radio-off ui-radio-off"> <span class="ui-btn-inner ui-radio-off"> <span class="ui-btn-text">+2</span> </span> </label> </div> <div class="ui-radio"> <input data-create="false"
 type="radio" value="10" id="radio_add_three" name="radio_add" data-theme="c"> <label for="radio_add_three" data-corners="true" data-shadow="false" data-iconshadow="true" data-wrapperels="span" data-theme="c" class="ui-btn ui-btn-up-c ui-radio-off ui-radio-off"> <span class="ui-btn-inner ui-radio-off"> <span class="ui-btn-text">+10</span> </span> </label> </div> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="basket" data-iconpos="left" data-theme="e" data-inline="true" class="ui-btn ui-btn-up-e ui-btn-inline ui-btn-icon-left" aria-disabled="false"> <span class="ui-btn-inner"> <span class="ui-btn-text">in den Warenkorb</span> <span class="ui-icon ui-icon-basket ui-icon-shadow">&nbsp;</span> </span>  <input type="button" data-create="false" data-theme="e" data-iconpos="left" data-icon="basket" class="basketSubmitter itemTrigger ui-btn-hidden" data-inline="true" value="in den Warenkorb" aria-disabled="false"> </div> <div data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="span" data-icon="trash" data-iconpos="notext" data-theme="e" title="Reset" class="ui-btn ui-btn-icon-notext ui-corner-right ui-controlgroup-last ui-btn-up-e" aria-disabled="false"> <span class="ui-btn-inner ui-corner-right ui-controlgroup-last"> <span class="ui-btn-text">Reset</span> <span class="ui-icon ui-icon-trash ui-icon-shadow">&nbsp;</span> </span> <input type="button" data-create="false" value="Reset" name="deleteQty" id="deleteQty" data-iconpos="notext" data-theme="e" data-icon="trash" class="ui-btn-hidden" aria-disabled="false"> </div> </div> </div> </div> </div> </div> <div data-icon="info" data-theme="c" data-collapsed="true" data-role="collapsible" class="ui-collapsible ui-collapsible-inset ui-collapsible-collapsed ui-block-b"> <h3 class="ui-collapsible-heading ui-collapsible-heading-collapsed"> <a class="ui-collapsible-heading-toggle ui-btn ui-btn-icon-left ui-btn-up-c" href="#" > <span class="ui-btn-inner"> <span class="ui-btn-text">Info
 <span class="ui-collapsible-heading-status">Anklicken um Inhalte anzuzeigen</span> </span> </span> </a> </h3> <div class="ui-collapsible-content ui-body-c ui-collapsible-content-collapsed" aria-hidden="true"> <div class="ui-box-inner"> <p>- 1-9_86278, Soft-BH gen.</p> <p>Artikel : 86278, Farbe : Weiss/300, Grösse : 80B</p> <p></p> </div> </div> </div> </ul> </div> </div> </div> </div> </div> </div> </form> </div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:56:05.913

谢谢大家的提示。原来是 HTML 响应中的一个错误，我忘记在我正在做的检查中关闭列表元素。

现在它起作用了。

你的提示都很好，所以让他们回答，这样我就可以投票了！

谢谢！

# c - C - 没有函数指针的动态函数调用

> ID：15373452
> 
> 赞同：5
> 
> 时间：2013-03-12T22:24:26.683
> 
> 标签：c, function, pointers, dynamic, call

我想动态调用 C 函数（例如形成标准库、数学......）。这意味着我的 C 程序只知道指向随机函数的指针（例如`printf`）及其签名（编码为 char 数组：`char *`，...）。

我的目标是一个 reflectCall 函数，它获取一个指向函数 ( `&printf`) 的指针、一个签名（以某种方式编码在 a 中`char[]`），以及作为 a 的参数`long[]`（`long`不是实际的数据类型，一个 long 值也可以表示一个 double 值、指针、 ...）。

因此，我的反射函数的签名如下所示：

```
long reflectCall(void *funcPointer, char[] types, long[] args) 
```

该函数应该执行函数的实际调用`*funcPointer`并最终返回其结果。

结果，我**无法**创建指针指针；例如像这样：

```
int (*functionPtr)(int,int); 
```

谁能给我一个提示如何解决这个问题或建议任何参考实现？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-15T07:54:31.380

可以在纯 C 中完成，但不是那么简单，也不是那么快：

1.  为您要调用的所有函数创建包装函数，例如：

    ```
    int WrapPrintf(const char* types,long* args,long* results)
    {
        // Function specific code, in this case you can call printf for each parameter
        while(*types)
        {
            switch(*types){
            case 'i':
                printf("%d",(int)*args);
                break;
            case 'c':
                printf("%c",(char)*args);
                break;
            // .. and so on
            }

            ++types;
            ++args;
        }
        // Return number of filled results
        return 0;
    }

    int WrapFoo(const char* types,long* args,long* results)
    {
        // ..function specific code..
        return 0;
    } 
    ```

2.  指向包装函数的指针：

    ```
    typedef int (*TWrapper)(const char*,long*,long*); 
    ```

3.  为包装函数创建表结构：

    ```
    struct STableItem{
        const char *strName;
        TWrapper pFunc;
    }; 
    ```

4.  创建表：

    ```
    STableItem table[] = {
        {"printf", &WrapPrintf},
        {"foo", &WrapFoo},
        {NULL, NULL}
    }; 
    ```

5.  创建接口以从表中调用任何函数（按名称搜索函数并调用它）：

    ```
    int DynamicCall(const char *func_name,const char* types,long* args,long* results)
    {
        int k;
        for(k=0;table[k].strName != NULL;++k){
            if(strcmp(func_name,table[k].strName) == 0){
                return table[k].pFunc(types,args,results);
            }
        }

        return -1;
    } 
    ```

6.  最后打个电话：

    ```
    long args[] = {123,'b'};
    long results[8];            // not nice but just for an example

    int res_count = DynamicCall("printf","ic",(long*)args,(long*)results); 
    ```

注意：使用散列函数更快地搜索名称

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T22:26:39.453

C 不提供执行此操作的设施。您必须在特定于平台的 ASM 中编写函数的主体。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-13T01:25:27.963

我建议您查看 libffi，它是否符合您的需求......

[http://sourceware.org/libffi/](http://sourceware.org/libffi/)
[http://en.wikipedia.org/wiki/Libffi](http://en.wikipedia.org/wiki/Libffi)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-12T22:58:36.980

正如其他地方所解释的，没有办法真正动态地做到这一点。但是，如果您希望使用指针构建函数表，并使用某种字符串或索引来描述您想要做什么，那么这肯定是可能的，以一种可移植的方式。作为各种解析和其他“基于命令的运行代码等”的解决方案，这一点也不罕见。

但这确实需要您使用某种函数指针[或`void *`在某个时候将您的指针转换为一个]。没有其他（甚至几乎）可移植的方式在 C 中动态调用函数。

# drupal - Drupal：视图显示为块；放入 html 选项卡

> ID：15373453
> 
> 赞同：0
> 
> 时间：2013-03-12T22:24:32.297
> 
> 标签：drupal, drupal-views

Drupal 6.28：

我正在重新设计网站的特定部分，新设计要求将五个页面显示为一个页面上的五个选项卡，并在单击选项卡本身或在左侧的扩展菜单中显示适当的选项卡。

我在 html 和 jquery 中创建了所有这些，以便我可以对选项卡进行深度链接，即...有人可以单击任何菜单链接并点击打开相应选项卡的页面，而不必转到母版页然后单击相应的选项卡。（使用 location.hash）

这一切都很好，但最后一个选项卡是容纳当前设置为块的视图的内容。

将该视图/块拉入我为该特定内容预留的 html div 的最佳方法是什么？

我以前使用过这个很棒的片段：

```
<?php
 $block = module_invoke('block', 'block', 'view', '15');
       print $block['content']; 
?> 
```

这允许人们将任何块放置在任何地方，但是对于将显示设置为块的视图，我没有任何运气调用该视图。另外，我不得不在节点上使用“php”而不是“full html”，因为它只是一个片段，但由于它当前不工作，可能没关系。

所以，我试图弄清楚如何拥有这样的东西：

```
<!-- all the other tabs content-->
<div id="fifthTab">
all the content from the view which is set to 'display like a block'
</div> 
```

我对 Drupal 还很陌生，甚至不确定我是否创建了一个页面来显示我将如何调用该数据。

所以我的html结构是： MAIN PAGE LINK -sub link/tab 1/default -sub link/tab 2 -sub link/tab3 -sub link/tab4 -sub link/tab5

因此，如果有人单击左侧导航中的子链接/选项卡 5 或单击实际选项卡 5 或输入 url xxx/#tab5，则会显示相应的选项卡，其余选项卡将隐藏。这一切都很好，我只是无法让视图内容显示在那个 tab5 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T17:19:24.597

所以基于 url 的页面模板是最简单的。变量 $content 只是放在最后一个选项卡中，而该特定页面的所有其他 html 内容只是放在模板中。

至少这样，随着文档的添加，它仍然是动态的，并且如果需要，静态信息很容易编辑。

以防万一其他人遇到类似的事情。

# c# - 仅比较文件中的最后一列

> ID：15373454
> 
> 赞同：0
> 
> 时间：2013-03-12T22:24:46.397
> 
> 标签：c#

我有一个文件，例如：

```
outlook temperature Humidity  Windy  PlayTennis

sunny      hot        high     false   N

sunny      hot        high     true    N

overcast   hot        high     false   P

sunny      hot        high     false   P 
```

我基本上想比较第一列和最后一列。想要sunny-n然后发生-no ++和sunny-P发生_yes++

我把代码写成

我采用了读取每一行的while循环，我遇到的问题是，每次，它都进入for循环，`occur_yes+`因为check的值成为最后一列值，但我希望如果最后一列是P那么它应该进去，`occur_yes`否则它应该进去`occur_No`。

希望我清楚。

我是一个新生..请帮帮我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:19:20.897

这段代码应该做你正在寻找的东西：

```
int occur_yes = 0;
int occur_no  = 0;
// open file
using (StreamReader r = new StreamReader("inputFile.txt"))
{
    // read lines one at a time
    string line;
    while ((line = r.ReadLine()) != null)
    {
        // split the line
        string[] cols = line.Split('\t');
        if (cols[0] == "sunny")
        {
            // check last column only if the first one is "sunny"
            if (cols[4] == "N")
                occur_no++;
            else if (cols[4] == "P")
                occur_yes++;
        }
    }
} 
```

# visual-studio-2012 - 将外部链接文件复制到网站的根目录

> ID：15373456
> 
> 赞同：0
> 
> 时间：2013-03-12T22:24:58.790
> 
> 标签：visual-studio-2012, msbuild

在 Visual Studio 2012 中

我有三个网站都使用相同的数据库连接字符串集。

我将数据库连接字符串保存在一个`connectionStrings.config`文件中，该文件位于一个通用解决方案文件夹（所有三个网站的外部）中。

我将此文件作为链接包含（配置为`Content`和`Copy Always`） -当我编译/运行网站时，它将`connectionString.config`文件复制到每个网站的文件夹。`bin`

我想将该文件复制到每个网站的根目录。有没有一种简单的方法可以做到这一点？

一种方法是`xcopy`在项目的构建后步骤中使用。

另一种解决方案是修改`.csproj`文件（或单独的外部`.target`文件）以将链接文件复制到根目录（而不是 to `$(OutputDir)`）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T00:55:50.833

我使用了 Post-Build 事件。它具有您希望文件结束的位置的宏。

只需使用带有几个“..”的 $(Macro) 标签，您就可以将文件“按摩”到您想要的位置。

```
copy $(ProjectDir)..\connectionStrings.config $(TargetDir)connectionStrings.config 
```

# android - 带有意图action.SEND的Android活动获取无法打开的uri？

> ID：15373459
> 
> 赞同：1
> 
> 时间：2013-03-12T22:25:13.760
> 
> 标签：android

活动定义为：

```
 <activity android:name="com.tralev.android.UploadFromCameraAppActivity" android:exported="true">
        <intent-filter>
            <action android:name="android.intent.action.SEND" />
            <category android:name="android.intent.category.DEFAULT" />
            <data android:mimeType="image/*" />
        </intent-filter>
    </activity> 
```

UploadFromCameraAppActivity 正在尝试获取 URI：

```
Uri uri = (Uri) extras.getParcelable(Intent.EXTRA_STREAM);
String filename = uri.getPath(); 
```

但是当试图打开该文件名时，我得到了异常：

03-12 23:10:30.787：W/System.err(9840)：java.io.FileNotFoundException：/external/images/media/2437：打开失败：ENOENT（没有这样的文件或目录）

注意：这发生在我用来测试的 Nexus 7 上。

已解决：此问题已解决

```
public String getRealPathFromURI(Uri contentUri) {
  String[] proj = { MediaStore.Images.Media.DATA };
  Cursor cursor = getContentResolver().query(contentUri, proj, null, null, null);
  int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
  cursor.moveToFirst();
  return cursor.getString(column_index);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-04T21:38:38.000

这个问题是使用解决的

```
 public String getRealPathFromURI(Uri contentUri) {
   String[] proj = { MediaStore.Images.Media.DATA };
   Cursor cursor = getContentResolver().query(contentUri, proj, null, null, null);
   int column_index = cursor.getColumnIndexOrThrow(MediaStore.Images.Media.DATA);
   cursor.moveToFirst();
   return cursor.getString(column_index);
 } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:29:51.867

您是否添加了权限 android.permission.READ_EXTERNAL_STORAGE ？

# ruby-on-rails - 由于关联，Rails 应用程序性能下降？

> ID：15373460
> 
> 赞同：1
> 
> 时间：2013-03-12T22:25:18.113
> 
> 标签：ruby-on-rails, performance, associations

我当前的 Rails 3 应用程序的性能下降，因为我向模式引入了更多关联。

这种性能与页面加载无关，而是与我使用 resque 运行的后台任务有关。该任务解析外部数据源以填充数据库。它通过自定义辅助方法（相当长的方法）来实现这一点。

我不期望任务执行得很快，因为它正在解析大量数据，但是最近在添加了一些额外的关联后，我看到我的测试方法的执行时间从 2 分钟增加到了 5 分钟左右。我在虚拟机上运行，​​所以也许这就是为什么它通常这么慢。

使用 ruby​​-prof，似乎大部分额外计算都用于处理我添加的关联的方法：

```
ActiveRecord::Associations::CollectionAssociation#* (where * is any number of methods) 
```

当我添加关联时，我在关联表中包含了索引。但是，除此之外，我不确定我能做些什么来减轻我在添加这些关联时看到的性能影响。

所以我的问题是：

1) 添加关联是否会导致 Rails 应用程序的性能急剧下降？2) 让 Rails 应用程序具有许多执行良好的关联的最佳实践是什么？

编辑：根据要求提供一些附加信息

*   数据库：Postgres
*   我添加的关联都是 HABTM
*   正是这些协会的填充占用了时间。在填充过程中，我正在创建数百个甚至数千个关联。对于批量插入，我一直在使用 activerecord-import，它显着加快了速度，但我不知道关联的等价物。
*   我正在执行以下操作（为简单起见更改了变量）：

    ```
    // flavors_array is an array of all the Flavor objects I want to associate with my ice_cream
    ice_cream.flavors = flavors_array 
    ```

*   我这样做是因为我确定地知道这个“ice_cream”实例没有预先存在的关联，我将使用“=”删除这些关联

*   但是，这种方法仍然很慢
*   **重要提示：**当我用 SQL 语句替换上述内容以将关联直接批量插入关联表（通过 ID）时，性能会显着提高。操作几乎不需要时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T06:35:53.577

您还需要分析您的查询，没有神奇的公式，而是评估“包含与连接”的用法。通常使用关联，除非需要，否则不会加载数据。

下面的 railscast 提供了很好的想法， [http: //railscasts.com/episodes/181-include-vs-joins](http://railscasts.com/episodes/181-include-vs-joins)

急切加载可能有助于防止往返数据库，并可能提供更好的性能。

# c++ - 在 2D 矢量中的预定位置更改多个值的最简单方法是什么？

> ID：15373461
> 
> 赞同：0
> 
> 时间：2013-03-12T22:25:18.207
> 
> 标签：c++, for-loop, vector, points, 2d-vector

好的，所以我有一个 2d 的字符向量，我称之为网格。让我们说它的 70 x 30。创建网格时，它会自动用“x”填充每个位置

我有一个显示网格的功能。所以我调用了这个函数，控制台上会显示一个 70x30 的 x 网格。

我有另一个函数，我想调用它来实质上用不同的字符替换网格的某些 x,y 坐标处的字符。这些点并不是完全随机/分散的。我基本上是从网格边缘的一个点开始，将锯齿线绘制到另一个边缘。所有点都是预先确定的。有很多点要绘制，所以手动绘制似乎效率低下。

以下是我的想法：

*   创建一个双循环，宽度和高度，称它们为 i 和 j
*   如果 i = (a || b || c || d...) && j = (e || f || g..)

并且基本上为每个可能的场景做那个乏味的过程。当然有一个更容易和更简单的方法哈哈。任何建议将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:31:02.230

如果这些点可以通过地图预先确定（如在关卡编辑器或其他固定模式中），则制作一个 x/y 坐标字典来表示图块的位置。遍历字典并进行每次替换。

如果这些点不是预先确定的，而是遵循一种模式，例如线条或斑点，那么编写一个方法来绘制线条/斑点/任何东西并一遍又一遍地调用它。该方法决定替换哪些瓦片并替换那些瓦片。

顺便说一句，在进行这样的 2D 检查和处理时有一个技巧，称为“delta”，例如 xdelta=-1, ydelta=0 是西，xdelta=1, ydelta=1 是东北。通过使用 delta，您可以使用不同的 delta 运行一个函数两次、四次或八次，并且只需使用 delta 的方向，它就会在不同的方向上移动，而无需自己尝试所有八个方向 - 也可以使用 delta如果需要，可以进行边界检查，因为例如，您不能在没有前进的方向上越界。然后你可以更进一步，枚举所有方向，反转方向的函数，将方向旋转 90/45 度（如果枚举它非常简单，你只需在枚举中添加 2 或 1 并返回新方向） ， ETC，

所以我可能有类似的东西

`function drawLine(int xstart, int ystart, int xdelta, intydelta)`

从 xstart,ystart 开始，用 O 替换 tile，将 xdelta 添加到 x，将 ydelta 添加到 y，用 O 替换 tile，等等，直到它从边缘脱落。

# jdbc - 使用 cassandra-jdbc-1.2.1 jar 创建表时出错

> ID：15373462
> 
> 赞同：2
> 
> 时间：2013-03-12T22:25:19.090
> 
> 标签：jdbc, cassandra, cassandra-jdbc

我在通过 cassandra-jdbc 驱动程序在 cassandra 中创建列族（表）时遇到了一些困难。

cql 命令在 cqlsh 中正常工作，但在使用 cassandra jdbc 时不能正常工作。我怀疑这与我定义连接字符串的方式有关。任何帮助都会非常有帮助。

让我试着解释一下我做了什么。

我通过以下命令使用 cqlsh 创建了一个键空间

```
CREATE KEYSPACE authdb WITH 
       REPLICATION = { 
                     'class' : 'SimpleStrategy', 
                     'replication_factor' : 1 
                     }; 
```

这是根据文档：[http ://www.datastax.com/docs/1.2/cql_cli/cql/CREATE_KEYSPACE#cql-create-keyspace](http://www.datastax.com/docs/1.2/cql_cli/cql/CREATE_KEYSPACE#cql-create-keyspace)

我可以使用在 cqlsh 中创建一个表（列族）

```
 CREATE TABLE authdb.users(
    user_name varchar PRIMARY KEY,
    password varchar,
    gender varchar,
    session_token varchar,
    birth_year bigint
    ); 
```

这可以正常工作。

当我尝试使用 cassandra-jdbc-1.2.1.jar 创建表时，我的问题就开始了

我使用的代码是：

```
public static void createColumnFamily()  {
    try {
        Class.forName("org.apache.cassandra.cql.jdbc.CassandraDriver");
        Connection con = DriverManager.getConnection("jdbc:cassandra://localhost:9160/authdb?version=3.0.0");

        String qry = "CREATE TABLE authdb.users(" +
            "user_name varchar PRIMARY KEY," +
            "password varchar," +
            "gender varchar," +
            "session_token varchar," +
            "birth_year bigint" + 
            ")";

            Statement smt = con.createStatement();
            smt.executeUpdate(qry);
            con.close();
        } catch (Exception e) {
            e.printStackTrace();
    } 
```

使用 cassandra-jdbc-1.2.1.jar 时出现以下错误：

```
 main DEBUG jdbc.CassandraDriver - Final Properties to Connection: {cqlVersion=3.0.0, portNumber=9160, databaseName=authdb, serverName=localhost}
    main DEBUG jdbc.CassandraConnection - Connected to localhost:9160 in Cluster 'authdb' using Keyspace 'Test Cluster' and CQL version '3.0.0'
    Exception in thread "main" java.lang.NoSuchMethodError: org.apache.cassandra.thrift.Cassandra$Client.execute_cql3_query(Ljava/nio/ByteBuffer;Lorg/apache/cassandra/thrift/Compression;Lorg/apache/cassandra/thrift/ConsistencyLevel;)Lorg/apache/cassandra/thrift/CqlResult;
    at org.apache.cassandra.cql.jdbc.CassandraConnection.execute(CassandraConnection.java:447) 
```

注意：簇和键空间不正确

使用 cassandra-jdbc-1.1.2.jar 时出现以下错误：

```
 main DEBUG jdbc.CassandraDriver - Final Properties to Connection: {cqlVersion=3.0.0, portNumber=9160, databaseName=authdb, serverName=localhost}
    main INFO  jdbc.CassandraConnection - Connected to localhost:9160 using Keyspace authdb and CQL version 3.0.0
    java.sql.SQLSyntaxErrorException: Cannot execute/prepare CQL2 statement since the CQL has been set to CQL3(This might mean your client hasn't been upgraded correctly to use the new CQL3 methods introduced in Cassandra 1.2+). 
```

注意：在这种情况下，集群和键空间似乎是正确的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T07:39:02.550

使用 1.2.1 jar 时的错误是因为您有旧版本的 cassandra-thrift jar。您需要使其与 cassandra-jdbc 版本保持同步。cassandra-thrift jar 位于二进制下载的 lib 目录中。

# c# - 如何组织具有开源依赖项的开源 Visual Studio 项目？

> ID：15373465
> 
> 赞同：13
> 
> 时间：2013-03-12T22:25:25.913
> 
> 标签：c#, github, open-source, projects-and-solutions

我已经启动了一个开源 MVC4 项目，它使用其他一些开源项目作为依赖项。我已经分叉了另一个项目，并将根据我的需要对其进行修改。我面临的问题是如何使这些项目相互依赖，但分开维护。然而 git pull 我的项目的人也会得到依赖项目吗？

1.  我可以将其他项目中的所有相关代码猛烈抨击到我的存储库中，但这样我将无法为依赖项目的分支做出贡献。我将成为我的存储库的一部分。不是真的想那样做。
2.  我可以完全单独维护其他项目并将 *.dll 文件复制到我的项目中。并将依赖的 dll 文件提交到 git 中。这很好，但我失去了同时开发两个项目的能力，以及在调试时进入依赖代码（好吧，如果复制 *.pdb 文件可能不会）
3.  与第 2 点类似，我可以从依赖项目构建 nuget 包并将它们添加到我的主项目中——同样，不能真正同时开发两个项目，需要切换上下文。
4.  有了一些魔法，有一个解决方案文件，它结合了我的存储库和依赖存储库中的项目。在每次构建时，将依赖的 dll 文件复制到 /lib 文件夹并提交它们。这样我就不需要在单独的项目之间切换上下文。但缺点是当其他贡献者 git pull 我的项目时，他们没有得到依赖项目，解决方案文件可能会被他们破坏，因为它会引用不在 repo 中的项目。

在这种情况下，您如何组织代码？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-13T11:41:50.093

通常我对所有依赖项都使用 nuget。当我 fork 一个项目时，我会将它部署在 nuget 和[symbol source](http://www.symbolsource.org/Public)上。通过这种方式，您可以毫无问题地进入依赖源。

有关符号源和 nuget 的更多信息，另请参阅： [创建和发布符号包](http://docs.nuget.org/docs/creating-packages/creating-and-publishing-a-symbol-package)。要启用符号源调试，请参见[http://www.symbolsource.org/Public/Home/VisualStudio](http://www.symbolsource.org/Public/Home/VisualStudio)。

您还必须记住启用[Nuget package restore](http://docs.nuget.org/docs/workflows/using-nuget-without-committing-packages)。

使用此解决方案，您无法修改源代码，但至少可以调试它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-15T20:29:36.120

我在概念上使用与 CMake 类似的东西，但完全在 Visual Studio 中。属性文件有一个相对未知的特性，可以包含在解决方案中。这允许您创建一个仅包含依赖项路径的文件，包含您可以包含的库并设置相对路径，然后要求人们为您不能/不想包含的其他依赖项设置适当的路径。

通过一些工作，它变得相当干净，并且非常容易通过 TeamCity 和其他类似工具实现自动化（每个构建代理都可以设置变量以指示它保留依赖项的位置）。

对于小的依赖项和经过调整以与我的项目一起使用的依赖项，我会在存储库中保留一个存档或松散文件，并使用属性文件来引用它们。其他人有关于在哪里找到它们以及如何编辑路径的说明。

如果您对这种方法感兴趣，我可以更详细地介绍。需要做一些工作才能弄清楚，因为属性文件的文档记录不是很好，但工作得非常整齐。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T20:22:57.370

如果您没有创建*循环依赖项*，以下是一个想法：

1.  `Class Library`将具有唯一名称的新项目添加`ClassLibrary1`到解决方案中，例如

2.  在`Build`其项目设置页面中，配置`Output path`到应用程序输出路径

3.  在`Build Events`页面中，将以下行添加到`Post-build event command line`块中：

    ```
    del "$(TargetPath)" 
    ```

4.  重复步骤 1 到 3，`ClassLibrary2`但`Output path`为`ClassLibrary1`

5.  一组`Project Dependancies`，`ClassLibrary1`检查`ClassLibrary2`

6.  添加所有其他项目作为*项目引用*，`ClassLibrary2`保留`Copy Local`默认值`true`

7.  构建`ClassLibrary2`一次，所有 DLL 现在都在`ClassLibrary1`

8.  将它们添加到引用`ClassLibrary1`并保留`Copy Local`默认值`true`

9.  一组`Project Dependancies`应用程序和所有其他不会导致*循环依赖*的项目，请检查`ClassLibrary1`

10.  从放置 DLL 的路径添加其他项目的引用`ClassLibrary1`

11.  将`Copy Local`所有这些添加到其他项目中的 DLL 集合到`false`

因此，该项目`ClassLibrary1`成为解决方案外部库的中央控制。每次您`Rebuild Solution`（或只是构建应用程序）时，`ClassLibrary1`将最新的 DLL 添加到其对应用程序输出文件夹的引用中，并删除它自己生成的名为`ClassLibrary1.DLL`. 编译时或运行时的应用程序和依赖项将使用相同版本的 DLL，您无需进行额外的部署或检查每个部署。

# sql - 使用 SQLDF 或 read.csv.sql 选择每第 N 列

> ID：15373466
> 
> 赞同：1
> 
> 时间：2013-03-12T22:25:28.567
> 
> 标签：sql, r, sqldf

我对使用 SQL 语句相当陌生，并且在使用它们从大表中选择所需的列并将它们拉入 R 时遇到了一些麻烦。

我想获取一个 csv 文件并将选定的列读入 r，特别是每第 9 列和第 10 列。在 R 中，类似：

```
read.csv.sql("myfile.csv", sql(select * from file [EVERY 9th and 10th COLUMN]) 
```

我对互联网的搜索表明，可以使用类似这样的 MOD 的 SQL 语句来选择每第 n 行（如果我错了，请纠正我）：

```
"SELECT *
        FROM   file
        WHERE  (ROWID,0) IN (SELECT ROWID, MOD(ROWNUM,9) OR MOD(ROWNUM,10)" 
```

有没有办法让这个工作列？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:50:30.067

**read.csv** `read.csv`就足够了：

```
# determine number of columns
DF1 <- read.csv(myfile, nrows = 1)
nc <- ncol(DF1)

# create a list nc long where unwanted columns are NULL and wanted are NA
colClasses <- rep(rep(list("NULL", NA), c(8, 2)), length = nc)

# read in
DF <- read.csv(myfile, colClasses = colClasses) 
```

**sqldf**要使用 sqldf，请将最后一行替换为：

```
nms <- names(DF1)
vars <- toString(nms[is.na(colClasses)])
DF <- fn$read.csv.sql(myfile, "select $vars from file") 
```

更新：切换到 read.csv.sql

更新2：更正。

# javascript - 名称中带有空格的字体未在 CKEditor 中正确应用

> ID：15373469
> 
> 赞同：1
> 
> 时间：2013-03-12T22:25:37.023
> 
> 标签：javascript, css, ckeditor, google-webfonts

感谢这篇文章[How can I add(programatically) google fonts to ckeditor](https://stackoverflow.com/questions/13986548/how-can-i-addprogramatically-google-fonts-to-ckeditor)我能够将 Google Fonts 添加到我的 ckeditor。但是我想添加字体“Goudy Bookletter 1911”，但该字体显示不正确。
我检查了元素，它的样式是`font-family: goudy bookletter 1911`当我将其更改为`font-family: 'goudy bookletter 1911'`有效时。
任何人都知道我可以如何编辑ckeditor，以便在应用字体样式时具有引号？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:29:36.150

[http://ckeditor.com/forums/CKEditor-3.x/Ckeditor-external-fonts-problem](http://ckeditor.com/forums/CKEditor-3.x/Ckeditor-external-fonts-problem)

ckeditor网站上的这篇文章可能会解决您的问题...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-25T20:25:05.773

由于我不知道如何在`config.font_names`不导致 js 错误的情况下将引号添加到列表中，而且我只有字体问题`Goudy Bookletter 1911`，我通过在列表中添加 camelCased 名称来解决此问题，因此它看起来像这样：

```
config.font_names = "Arial/Arial, Helvetica, sans-serif;Glass Antiqua;Goudy Bookletter 1911/GoudyBookletter1911;" 
```

我无法将每个带有空格的 Google 字体更改为 camelCase，因为 Google 会在一些字体名称中附加“-Regular”之类的名称，但这暂时解决了我的问题。如果你有更好的想法，请告诉我！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-01-22T08:50:32.330

对于 CkEditor 5：fontFamily/utils 中的 normalizeFontNameForCSS 添加额外的引号。您可以通过创建自定义构建来改变它，但如果只是为了这个目的，它会很耗时

```
function normalizeFontNameForCSS( fontName ) {
    fontName = fontName.trim();

    // Compound font names should be quoted.
    if ( fontName.indexOf( ' ' ) > 0 ) {
        fontName = `'${ fontName }'`; // ==> fontName = `${ fontName }`
    }

    return fontName;
} 
```

# java - 循环遍历序列化文件

> ID：15373470
> 
> 赞同：1
> 
> 时间：2013-03-12T22:25:38.797
> 
> 标签：java, fileinputstream

我正在做一个应该打开序列化文件并输出它的学校作业。我不知道为什么它不打印任何东西。循环似乎根本不起作用。有任何想法吗？

```
public ReadFile()
{
    try
    {
        fis = new FileInputStream("Clients.ser");
        ois = new ObjectInputStream(fis);
    }
    catch(Exception e) {}
    try
    {
        while(true)
        {
            //cast according to class Record
            r = (Record) ois.readObject();
            System.out.print(r.account + r.firstName + r.lastName + r.balance);
        }
    }
    catch(IOException ioe) { ioe.printStackTrace(); }
    catch(ClassNotFoundException cnfe) {}
} 
```

**编辑**

添加了一个堆栈跟踪`IOException`并返回：

> `Record; local class incompatible: stream classdesc serialVersionUID = 5124020354301486787, local class serialVersionUID = -8881068308941519505`

*   [`ReadFile.java`](http://pastebin.com/CXipee6i)
*   [`Record.java`](http://pastebin.com/8Ha4BuyT)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:54:16.580

该消息意味着您尝试反序列化的类与您指定的类不同。

Record 类是由序列化它的人提供的，还是你自己编写的？

# sql - 尝试建立关系时出现 SQL 查询问题

> ID：15373477
> 
> 赞同：-1
> 
> 时间：2013-03-12T22:26:21.430
> 
> 标签：sql, sql-server, isqlquery

我正在我的数据库中创建表，并且在尝试创建表之间的关系时，我的查询出现了一个奇怪的问题。

这是我的查询：

```
CREATE  TABLE ogrnizationarticle (
  OAID Int NOT NULL ,
  _Text VARCHAR(255) NOT NULL ,
  ARank Int NULL DEFAULT NULL ,
  Acomment VARCHAR(255) NULL DEFAULT NULL ,
  Author VARCHAR(45) NULL DEFAULT NULL ,
  PRIMARY KEY (OAID, _Text) ,
  foreign key (OAID) references organization(OID),
  );
-- -----------------------------------------------------
-- Table nasshope.organization_Article_comment
-- -----------------------------------------------------
CREATE  TABLE organizationArticleComment (
  O_Article_ID Int NOT NULL ,
  Comment VARCHAR(255) NOT NULL ,
  Article VARCHAR(255) NOT NULL ,
  Comment_Like Int NULL DEFAULT NULL ,
  _Date DATETIME NULL DEFAULT NULL ,
  PRIMARY KEY (O_Article_ID, Comment, Article) ,
  foreign key (O_Article_ID) references ogrnizationarticle(OAID),
  ); 
```

这是错误

```
Msg 1776, Level 16, State 0, Line 13
There are no primary or candidate keys in the referenced table 'ogrnizationarticle' that match the referencing column list in the foreign key 'FK__organizat__O_Art__42ACE4D4'.
Msg 1750, Level 16, State 0, Line 13
Could not create constraint. See previous errors. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:30:06.213

为此，您需要将`_Text`列添加到`organizationArticleComment`并使用

`foreign key (O_Article_ID,_Text) references organization(OAID,_Text)`

但**我不建议你这样做**

`OAID,_Text`在我看来，这不是一个好的主键`ogrnizationarticle`。我会在那里使用代理 PK( `IDENTITY`)，然后您只需将其包含在`organizationArticleComment`.

否则，您最终将需要跨表复制一个可能非常宽且不稳定的键。由于 PK 也是该表上的聚集索引，您应该知道聚集索引键也包含在表上的任何非聚集索引中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:32:40.397

`OAID`中的字段`ogrnizationarticle`必须是“唯一键”或“主键”。

有关详细信息，请参阅**[候选键](http://en.wikipedia.org/wiki/Candidate_key)**。

# c# - for 循环中的 C# 错误

> ID：15373482
> 
> 赞同：3
> 
> 时间：2013-03-12T22:26:41.290
> 
> 标签：c#, visual-studio-2010, for-loop, console

我不应该得到负数，请参见下面的屏幕截图：

见下图：

![在此处输入图像描述](../Images/adb2882b0f929289ba924d4ab3494a89.png)

这是代码：

```
 for (double i=8.0; i<=12;i=i+0.5)
        {
          double aa=  (i - Convert.ToInt32(i)) ;
          Console.WriteLine(" "+i+" "+aa);
        } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-03-12T22:30:23.047

如果您检查[文档](http://msdn.microsoft.com/en-us/library/ffdk7eyz.aspx)：

> **返回值**
> 类型：System.Int32
> 值，四舍五入到最接近的 32 位有符号整数。如果 value 在两个整数的中间，则返回偶数；即4.5转换为4，5.5转换为6。

这意味着每隔一个数字将向上取整，然后向下取整，然后向上取整，然后向下取整，这意味着您将有一半的时间得到负数。

此方法的目的是消除由于始终沿特定方向舍入而引入的偏差。考虑总结大量的值，首先将它们四舍五入。如果你总是四舍五入，最终的总和总是大于对未四舍五入的值求和然后四舍五入的总和。但是，如果根据上面列出的规则，四舍五入，四舍五入的最终总和更有可能更接近四舍五入的总和。

您还可以在维基百科上阅读更多相关信息[：Round](http://en.wikipedia.org/wiki/Rounding#Round_half_to_even)。它有时被称为*银行家四舍五入*，尽管据我所知银行不使用这种方法。

为确保您根据需要四舍五入：

*   下：[Math.Floor（双人间）](http://msdn.microsoft.com/en-us/library/e0b5f0xb.aspx)
*   上：数学.[天花板（双）](http://msdn.microsoft.com/en-us/library/zx4t0t48.aspx)
*   Even/AwayFromZero: [Math.Round(Double, MidpointRounding)](http://msdn.microsoft.com/en-us/library/ef48waz8.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:30:55.547

我不知道你会期待什么，但在这种情况下 double 是四舍五入的，而不是截断的

> value：四舍五入到最接近的 32 位有符号整数。如果 value 在两个整数的中间，则返回偶数；即4.5转换为4，5.5转换为6。

检查[Convert.ToInt32(double)](http://msdn.microsoft.com/en-us/library/ffdk7eyz.aspx)文档

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:38:44.893

试试这个解决你的问题

```
 for (double i = 8.0; i <= 12; i = i + 0.5)
        {
            double aa = Convert.ToInt32(i);
            Console.WriteLine(aa+" "  +i );
        } 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:29:18.690

```
 double aa=  (i - Convert.ToInt32(i)) ; 
```

看起来它是交替上下四舍五入。

并不特别令人惊讶

# f# - 此函数中出现奇怪的 (?) 类型不匹配错误

> ID：15373485
> 
> 赞同：1
> 
> 时间：2013-03-12T22:26:54.307
> 
> 标签：f#

有人可以解释为什么编译器给我这个错误

> 类型不匹配。期望 'a [] -> 字符串
> ，但给定了 'a [] -> 'a []
> 类型 'string' 与类型 ''a []' 不匹配

在此代码段上：

```
let rotate s: string = 
  [|for c in s -> c|] 
  |> Array.permute (function | 0 -> (s.Length-1) | i -> i-1) 
```

而下面的编译就好了：

```
let s = "string"
[|for c in s -> c|] 
|> Array.permute (function | 0 -> (s.Length-1) | i -> i-1) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:30:24.840

您的第一个代码段定义`rotate`了返回类型为`string`.

尝试将其更改为：

```
let rotate (s: string) = 
  [|for c in s -> c|] 
  |> Array.permute (function | 0 -> (s.Length-1) | i -> i-1) 
```

在这种形式中，您定义了一个带有一个字符串参数的函数（我想这就是您想要的）和推断的返回类型。

# clojure - 在 Light Table 中使用 Datomic 时出现“无阅读器功能”错误

> ID：15373486
> 
> 赞同：8
> 
> 时间：2013-03-12T22:26:54.650
> 
> 标签：clojure, datomic, lighttable

当我在 lighttable 中评估此代码时：

```
(ns app.core
  (:require [datomic.api :refer [q] :as d]
            :reload-all))

(defn add-person
  [conn id]
  (d/transact conn [{:db/id #db/id[:db.part/user -1000001]
                     :person/id id}])) 
```

我得到：

```
clojure.lang.ExceptionInfo: No reader function for tag id
core.clj:4327 clojure.core/ex-info 
```

有谁知道发生了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-26T16:27:29.170

本教程归功于[stuart halloway](https://github.com/stuarthalloway)和[Bobby Calderwood](https://github.com/bobby)：

```
(use :reload 'datomic.samples.repl)
(easy!)
(def conn (scratch-conn))

;; in data, use data literals for tempids
(def tx-data [{:db/id #db/id[:db.part/user]
               :db/doc "Example 1"}])
(transact conn tx-data)

;; in code, call tempid to create tempids
(let [id (tempid :db.part/user)
      doc "Example 2"]
  (transact conn [{:db/id id :db/doc doc}]))

;; same argument applies to functions:
;; use #db/fn literals in data
;; use Peer.function or d/function in code

;; broken, uses db/fn literal in code
(transact conn [{:db/id #db/id [:db.part/user]
                 :db/ident :hello
                 :db/fn #db/fn {:lang "clojure"
                                :params []
                                :code '(println :hello)}}])

;; corrected: used d/function to construct function
(transact conn [{:db/id (d/tempid :db.part/user)
                 :db/ident :hello
                 :db/fn (d/function {:lang "clojure"
                                     :params []
                                     :code '(println :hello)})}])
(d/invoke (db conn) :hello) 
```

**来源**：[https ://github.com/Datomic/day-of-datomic/blob/master/samples/literals_vs_code.clj](https://github.com/Datomic/day-of-datomic/blob/master/samples/literals_vs_code.clj)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-20T15:24:36.643

尝试设置似乎存在问题`:person/id`。在该`#db/id[:db.part/user -1000001]`部分之后，您将获得一个用于添加数据的临时 ID。

您应该能够使用诸如`:person/name name`.

如果您尝试创建“公共 id”类型的东西，这篇[博](http://augustl.com/blog/2013/find_by_id_in_datomic/)文可能会有所帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-06T14:02:58.870

这是 nREPL 中的一个问题。我解决这个问题的方法是在命令行启动 REPL：

```
lein repl 
```

这将启动一个您可以从 LightTable 或 Emacs 连接到的进程。它将打印如下信息：

```
nREPL server started on port 51395 on host 127.0.0.1
                             ^^^^^ 
```

现在在 LightTable 中，添加一个连接 -> Clojure Remote -> 127.0.0.1:XXXXX

XXXXXX 应该等于 lein repl 打印出的端口。

如果你在 Emacs 中，苹果酒也有同样的问题。按照启动 lein repl 的相同步骤，然后使用 Mx cider-connect（它的默认键绑定是 Cc Mc）。

# ruby-on-rails - 覆盖 HAML 中的正文属性

> ID：15373489
> 
> 赞同：3
> 
> 时间：2013-03-12T22:27:23.353
> 
> 标签：ruby-on-rails, ruby, haml

我目前在 Rails 项目中，我想在不属于布局的视图中覆盖 body 标记中定义的属性。

像这样：

应用程序/视图/布局/application.haml

```
...header

%body
  = render 'shared/menu'

  .container
    = yield 
```

换个角度看。我希望 body 标签具有某些属性：

应用程序/视图/东西/index.haml

```
{data: {spy: 'scroll', target: '.d-sidebar', :'twttr-rendered' => 'true'}} << these attributes should apper in the body tag of the layout file. They should only be visible on the sub page 
```

实现这一目标的最简单方法是什么？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-12T22:43:30.253

您可能可以提供它：

在布局中

```
%body{ yield(:body_attributes) } 
```

在视野中

```
- provide(:body_attributes, { class: '', data: {} }) 
```

# jquery - 填充 jquery 选择

> ID：15373491
> 
> 赞同：0
> 
> 时间：2013-03-12T22:27:33.033
> 
> 标签：jquery, json

我一直在用头撞墙，希望有人能提供帮助。我正在使用**ajax**填充一个选择框。我已经能够做到，但我似乎只能显示第一个值，数据来自**json**。当我控制台记录 aData 时，我得到多个值，但我不在选择列表中......有什么想法吗？

```
$('.request-make').change(function () {
    var postVars = new Object();
    postVars.make = $('.request-make').val();

    $.ajax({
        type: 'POST',
        url: '/car_search/get_model',
        dataType: 'json',
        data: postVars,
        cache: false,
        success: function (aData) {
            //alert(aData)  
            //console.log(aData)
            //$('#request-model').val(response.data);
            $('#makebox').get(0).options.length = 0;
            $('#makebox').get(0).options[0] = new Option("--Select--", "0");

            $.each(aData, function (i, item) {
                $('#makebox').get(0).options[$('#makebox').get(0).options.length] = new Option(item[i].data, item[i].data);
            })
        }
    });
}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:32:43.653

这是 $.each 调用的规范：

> jQuery.each（集合，回调（indexInArray，valueOfElement））

话虽如此，我怀疑这里有问题：

```
new Option(item[i].data, item[i].data); 
```

因为， item 每次都已经是不同的 item。

你不是在尝试做类似的事情吗

```
new Option(item.data, item.data); 
```

甚至

```
new Option(aData[i].data, aData[i].data); 
```

# python - Python Tkinter 菜单栏不显示

> ID：15373493
> 
> 赞同：4
> 
> 时间：2013-03-12T22:27:35.433
> 
> 标签：python, tkinter, menubar

我正在尝试使用 Tkinter 制作 GUI，并开始实现菜单栏。我查看了一些教程并为其编写了一些代码，但菜单栏似乎从未出现 - 只是一个带有白色背景的空白框架。不过，这不仅仅发生在我的代码中；在将上述教程之一的代码复制并粘贴到新脚本中时，会出现相同的行为。

如果有人能阐明造成这种情况的原因，我将不胜感激。我的系统是 OS X 10.5、Python 2.7、Tk 8.4。这是教程中似乎不起作用的代码：

```
#!/usr/local/bin/python2.7

from Tkinter import *
from ttk import *

class App(Frame):
    def __init__(self):
            Frame.__init__(self)

            self.master.geometry('400x300')
            self.master.title(__file__)

            self.pack()

            self.menu = Menu(tearoff=False)
            self.master.config(menu = self.menu)

            fm = self.file_menu = None
            fm = Menu(self.menu, tearoff=False)
            self.menu.add_cascade(label='File', menu = fm)

            fm.add_command(label='Say Hello', command = self.say_hello)
            fm.add_separator()
            fm.add_command(label='Quit', command = self.quit)

            self.mainloop()

    def say_hello(self, *e):
            self.label = Label(self.master, text='Hello there!')
            self.label.pack(anchor=CENTER, fill=NONE, expand=YES, side=LEFT)

if __name__ == '__main__':
    App() 
```

我的代码在这里：

```
from Tkinter import *

class App(Frame):

    def __init__(self, parent):
        Frame.__init__(self, parent)

        parent.title("Cluedo Solver 1.0")

        menubar = Menu(root)
        menubar.add_command(label="File")
        menubar.add_command(label="Quit", command=root.quit())

        root.config(menu=menubar)

root=Tk()
root.geometry("300x250+300+300")
app=App(root)
root.mainloop() 
```

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-03-13T13:43:36.400

根据您对其中一个答案的一些评论，您显然是在 Macintosh 上运行它。代码工作正常，但菜单出现在 mac 菜单栏中，而不是像在 Windows 和 Linux 上那样出现在窗口上。因此，就菜单栏而言，您的代码没有任何问题。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-13T00:58:20.653

**带解释的代码**

根据个人经验，我发现在一个小部件方法中管理所有小部件通常更容易。这就是我在这里所做的，它奏效了。另外，我使用了master，而不是父级。我现在将逐步引导您完成代码。

```
from Tkinter import * 
```

我们导入 Tkinter（GUI 的东西）

```
class App(Frame): 
```

我们创建了一个名为 的类`App`，它是`Frame`存放小部件的地方。

```
 def __init__(self, master):
        Frame.__init__(self, master)
        self.grid()
        self.widgets() 
```

我们创建一个名为`__init__`. 这会初始化类，并运行另一个名为`widgets`.

```
 def widgets(self):

        menubar = Menu(root)
        menubar.add_command(label="File")
        menubar.add_command(label="Quit", command=root.quit())

        root.config(menu=menubar) 
```

我们创建`widgets`方法。这是`menubar`添加小部件的地方。如果我们要创建更多小部件，它们也会在这里。

```
root=Tk()
root.title("Menubar")
app=App(root)
root.mainloop() 
```

最后，我们给整个窗口一些属性。我们给它一个标题，`Menubar`然后运行这个`App`类。最后，我们用`root.mainloop`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-11-22T04:14:19.583

我正在尝试上面的代码，但我得到的只是 macOS 菜单栏上的“Python”，它通常是下拉菜单。tkinter 似乎无法在 macOS 10.14.1 上使用菜单

我认为正在发生的事情是，有一些特定于 mac 的修复程序正在更改事件代码，因此某些菜单项最终会出现在 Python 菜单项下，而不是预期的位置，我在自己的实验中看到了其中的一些。当我扩展我的代码并使用一些保留的 FILE 事件代码而不是标准事件代码时，事情变得更好了。

```
#!/Library/Frameworks/Python.framework/Versions/3.7/bin/python3.7
# -*- coding: utf-8 -*-# -*- coding: utf-8 -*-

from tkinter import *

class App(Frame):
    def __init__(self, master):
        Frame.__init__(self, master)
        self.grid()
        self.widgets()

    def widgets(self):
        menubar = Menu(root)
        menubar.add_command(label = 'File')
        menubar.add_command(label = 'quit', command = root.quit())
        root.config(menu = menubar)

root = Tk()
root.title('Menubar')
app = App(root)
root.mainloop() 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-07-22T06:30:26.537

如果您正在执行任何涉及您想要查看或测试的菜单栏的 GUI，请检查您的 mac 菜单栏。它很微妙，您可能认为您的代码无法正常工作。单击应用程序（在本例中为 python 窗口），它将显示一个下拉菜单栏。

# logging - 为什么使用呼叫者信息属性

> ID：15373495
> 
> 赞同：0
> 
> 时间：2013-03-12T22:27:40.937
> 
> 标签：logging, .net-4.5, stack-trace, c#-5.0

在堆栈跟踪对象上使用调用者信息属性会更好吗？有什么区别？

考虑以下使用调用者信息属性进行日志记录的代码。

```
public void Log(
    string message,
    [CallerMemberName] string memberName = null,
    [CallerFilePath] string filePath = null,
    [CallerLineNumber] int lineNumber = 0)
{
    // Do logging.
} 
```

`StackTrace`根据我的测试，使用该类可以实现相同的结果。

```
public void Log(string message)
{
    StackTrace trace = new StackTrace(true);
    StackFrame frame = trace.GetFrame(1);

    string filePath = frame.GetFileName();
    int lineNumber = frame.GetFileLineNumber();
    string memberName = frame.GetMethod().Name;

    // Do logging.
} 
```

我看到的唯一区别是匿名方法，其中`StackTrace`包括调用方法的生成名称，例如`<MyMethod>b_a`.

我不喜欢调用者信息属性的一件事是，尽管它们不必作为参数传入，但必须在要使用它们的每个方法上将它们定义为方法参数，这违反了 DRY 原则。

# java - Java - 如何从最接近特定数字的哈希图中找到一个值？

> ID：15373496
> 
> 赞同：3
> 
> 时间：2013-03-12T22:27:52.573
> 
> 标签：java, arrays, hashmap

嗨，我有一个`HashMap<String, Double>`和一个函数，它返回一个双精度值，称为`answer`. 我想检查 HashMap 中的哪个值最接近答案，然后获取该值的键并打印它。

```
HashMap<String, Double> output = new HashMap<String, Double>();

contents
("A", 0)
("B", 0.25)
("C", 0.5)
("D", 0.75)
("E", 1) 
```

假设我的一个函数的答案是 0.42，我如何检查它最接近哪个值，然后获取该值的键。我无法切换 HashMap 的键和值（因为前面的函数将值平均分配给每个字母），否则最好遍历每个键并获取值。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-12T22:49:26.867

如果您的值是唯一的，则可以使用[TreeMap](http://docs.oracle.com/javase/7/docs/api/java/util/TreeMap.html)，它实现了[NavigableMap](http://docs.oracle.com/javase/7/docs/api/java/util/NavigableMap.html)，它具有 nice`ceilingKey`和`floorKey`方法：

```
 NavigableMap<Double, String> map = new TreeMap<>();
    map.put(0d, "A");
    map.put(0.25, "B");
    map.put(0.5, "C");
    map.put(0.75, "D");
    map.put(1d, "E");

    double value = 0.42;
    double above = map.ceilingKey(value);
    double below = map.floorKey(value);

    System.out.println(value - below > above - value ? above : below); //prints 0.5 
```

注意：如果`value`小于（或大于）最小/最大键，两种方法都可以返回 null。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T22:30:33.057

使用 a `HashMap`，您必须遍历每个条目。

但是，如果性能很重要*并且*您将通过这种方式找到多个条目，您可以创建另一个集合：哈希映射中的条目列表或数组，按值排序。然后，您可以进行二进制搜索以更有效地找到具有最接近值的条目，并返回键。当然，如果您只打算在每张地图上执行一次，那也无济于事......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:40:52.393

HashMap 不是执行此操作的最佳结构。您可以获取 output.keySet() 并检查每个值，例如：

```
for(String key:output.keySet()){
   Double temp=Math.abs(output.get(key)-answer);
   if(temp<min){
     min=temp;
     nearest=key;
   }
} 
```

但这不是最好的方法。你被迫使用哈希图？顺便说一句，如果您总是有五个答案要检查，这不是问题...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:30:52.717

“最接近”的概念对于散列数据结构并没有真正意义。高效散列算法的主要目标是避免碰撞，这与接近性直接相反。要么你有碰撞，要么没有。

如果您要求这是一个有序的关键数据结构（例如`TreeMap`），答案会有所不同。

# regex - 除非它包含某个字符串，否则如何匹配所有字符串？

> ID：15373497
> 
> 赞同：0
> 
> 时间：2013-03-12T22:27:56.700
> 
> 标签：regex, google-analytics

所以我想匹配这个列表中的每个字符串，除了那些包含产品 SKU 的字符串，即 /s7892632 <---- 随机数字字符串。我一直在尝试这样做很长一段时间，但一直没有成功。任何见解将不胜感激。

```
 /account/login?returnurl=/account/forgotpassword
    /account/login?returnurl=/account/orders
    /account/orders
    /account/updateaddress
    /account/updateemail
    /account/updaterewardscard
    /brands/havaianas
    /careers
    /Category List
    /checkout
    /checkout/addresses
    /checkout/addresses/delivery
    /checkout/addresses/deliverymethod
    /checkout/affilinetbasket
    /checkout/anonymous
    /checkout/confirmation
    /checkout/express
    /checkout/login
    /checkout/login?returnurl=/checkout/addresses
    /checkout/null
    /checkout/payment
    /checkout/paypal
    /checkout/quickshop/
    /checkout/verify
    /click-and-collect
    /click-and-collect/click-and-collect-overview
    /corporate/about-matalan
    /corporate/careers
    /corporate/cookies
    /corporate/history
    /customer-services/accessibility
    /customer-services/contact
    /customer-services/customer-services-home
    /customer-services/delivery
    /customer-services/faq
    /customer-services/fitting-room
    /customer-services/here-to-help
    /customer-services/size-guides
    /delivery
    /events/mothers-day
    /events/mothers-day/s2516241/tassle-detail-slouch-bag
    /events/mothers-day/s2518752/waxed-jacket
    /events/mothers-day/s2519237/fabric-buckle-tote-bag
    /events/mothers-day/s2521182/heart-print-nightie
    /events/mothers-day/s2521184/heart-print-dressing-gown
    /events/mothers-day/s2521185/heart-print-pyjama-set
    /events/mothers-day/s2521679/structured-tote-bag
    /events/mothers-day/s2522143/chiffon-print-dress
    /events/mothers-day/s2522347/butterfly-enamel-bowl-32cm-x-8cm
    /events/mothers-day/s2526013/animal-print-jersey-blazer
    /events/mothers-day/s2527624/croc-tote-bag
    /events/mothers-day/s2529731/shift-dress
    /events/mothers-day?page=1&size=120&cols=4&sort=&id=/events/mothers-day&priceRange[min]=2&priceRange[max]=59
    /events/mothers-day?page=2&size=120&cols=4&sort=&id=/events/mothers-day&priceRange[min]=2&priceRange[max]=59
    /events/mothers-day?page=2&size=36&cols=4&sort=&id=/events/mothers-day&priceRange[min]=2&priceRange[max]=59
    /events/mothers-day?page=3&size=36&cols=4&sort=&id=/events/mothers-day&priceRange[min]=2&priceRange[max]=59 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:34:06.020

以下应该有效：

```
^(?!.*/s\d{7}/).* 
```

示例：[http ://regexr.com?343nf](http://regexr.com?343nf)

这假设您将每个字符串作为列表中的单独元素。如果这实际上将一个大字符串与多行匹配，您可以使用相同的正则表达式，但您可能需要根据您使用的工具启用全局和多行选项（并确保禁用 dotall/singleline）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:58:14.113

这匹配没有代码的行....

```
^((?!s\d{7}).)*$ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:45:12.033

尝试这个：

```
boolean noSku = !line.matches(".*/s\\d{5,}.*"); 
```

此用途`{5,}`允许 SKU 中的任意位数大于 4（为您提供匹配的灵活性）。您可以将号码更改为任何适合的号码。

# php - $_POST 变量未正确传递

> ID：15373498
> 
> 赞同：0
> 
> 时间：2013-03-12T22:28:14.843
> 
> 标签：php, html, http-post

所以，我有 3 个不同的网页可以将变量传递给下一个网页。

```
session_start();
$_SESSION['transdate'] = $date_name; 
```

**下一页：**

```
echo $_SESSION['transdate']; 
```

是的，我知道 session 可以用来实现类似的功能。但是，在尝试了上面的代码后，它会显示“未定义的变量：_SESSION”。然而，我确保它有一个正确的名称。

所以现在我正在尝试通过 $_POST，它没有显示未定义的变量。但是，它没有显示任何结果。

## 第一种形式：

```
$datePicker .= "<input class='datepicker' type='text' name='datepicker'>"; 
```

从第一种形式中获取的第二种形式的变量完全可以工作。

## 第二种形式：

**PHP：**

```
$date_name $_POST['datepicker'];
$date = $_POST['datepicker'];
$date = date('Y-m-d: H:i:s', strtotime($date)); 
```

**HTML：**

```
<form action="inquiry.php" method="post">
    <input name="schedule" type="hidden" value="<?php echo $schedule; ?>"
    />
    <label><font color="red">*</font> Number of Kids:</label>
    <input name="kid" style="height:30px;"
    type="text" class="input-small" placeholder="Example: 1234567" pattern="[0-9]{1,11}"
    required />
    <label><font color="red">*</font> Number of Adults:</label>
    <input name="adult"
    style="height:30px;" type="text" class="input-small" placeholder="Example: 1234567"
    pattern="[0-9]{1,11}" required />
    <label><font color="red">*</font> Number of Rooms:</label>
    <input name="transdate"
    type="hidden" value="<?php echo $date_name; ?>" />
    <select name="number_room">
        <?php echo $availableRooms; ?>
    </select>
    <label><font color="red">*</font> Number of Cottages:</label>
    <select name="number_cottages">
        <?php echo $availableCottages; ?>
    </select>
    <br />
    <button type="submit" class="btn btn-success" style="text-align:center; margin-left: 0px; ">Save Changes</button>
</form> 
```

虽然这里没有显示结果。

## 第三形式

```
$date = $_POST['transdate'];
$date = date('Y-m-d: H:i:s', strtotime($date)); 
```

编辑：[链接到截图](http://i.stack.imgur.com/ue1dR.jpg)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:30:51.137

您需要`session_start()`在**每一**页上调用。

第一页：

```
session_start();

$date_name = 'whatever';

$_SESSION['transdate'] = $date_name; 
```

第二页：

```
session_start();

echo $_SESSION['transdate']; 
```

# java - 为什么在尝试将此字符串转换为整数时出现“java.lang.NumberFormatException”？

> ID：15373501
> 
> 赞同：-4
> 
> 时间：2013-03-12T22:28:36.657
> 
> 标签：java, parsing, url, encryption, random

我一直在创建一个 Java 程序来编码从用户收到的消息。只是为了了解它是如何做到这一点的一些背景知识：它应该获取输入，将其拆分为字符，然后从 Random.org（真正的随机数生成器）获取一组等于消息长度的随机数，然后移位输入的字符通过其相应的移位或随机数，然后输出编码的消息和移位。到目前为止，我已经获得了输入，将其转换为字符串数组，检查了配额（Random.org 有配额）并获得了随机数。尝试输出转换后的班次时出现此错误（从网站上获得的字符串到整数），我认为这是因为最后一个数字上有一个 CRLF（我尝试使用正则表达式来解决这个问题，但它没有工作）。这是我的代码：

公共类 Encryption_System { 静态字符串 originalMessege;

```
public static void main(String[] args) throws Exception {
    System.out.println("Welcome to the encryption system!");
    System.out.println("Type your messege below:");
    System.out.println("\nHere is your original messege: " + scan() + "\n");
    Encrypt code = new Encrypt();
    code.Messege(originalMessege);
    code.encryptMessege();

}

private static String scan() {
    Scanner scan = new Scanner(System.in);
    originalMessege = scan.nextLine();
    return originalMessege;
} 
```

}

然后是第二节课，我的问题就出在这里。我的错误来自最后一种方法（我尝试的正则表达式修复被注释掉了）：

```
public class Encrypt {
    private String messege;
    private String[] characters;
    private URL quotaURL;
    private URLConnection conect;
    private InputStream quotaInput;
    private BufferedReader quotaReader;
    private int quota;
    private boolean go;
    private URL shiftsURL;
    private URLConnection conectShifts;
    private InputStream shiftsInput;
    private BufferedReader shiftsReader;
    private int count;
    private char[] shifts;
    private int[] shiftsInt;
    private String shiftsString;
    private String[] shiftsStrings;

    public void Messege(String x) {
        messege = x;
    }

    private String[] getCharacters() {
        characters = messege.split("(?!^)");
        return characters;
    }

    private boolean checkQuota() throws Exception {
        quotaURL = new URL("http://www.random.org/quota/?format=plain");
        conect = quotaURL.openConnection();
        quotaInput = conect.getInputStream();
        quotaReader = new BufferedReader(new InputStreamReader(quotaInput));
        int quota = Integer.parseInt(quotaReader.readLine());
        if (quota >= getCharacters().length)
            go = true;
        else
            go = false;
        return go;
    }

    private char[] Shifts(String[] x1) throws Exception {
        String[] messegeArray = x1;
        count = 0;
        for (int k = 0; k < x1.length; k++) {
            if (x1[k].equals(" ")) {
                continue;
            } else {
                count++;
            }
        }
        shifts = new char[count * 3];
        if (checkQuota() == true) {
            shiftsURL = new URL("http://www.random.org/integers/?num=" + count
                    + "&min=1&max=27&col=" + count
                    + "&base=10&format=plain&rnd=new");
            conectShifts = shiftsURL.openConnection();
            shiftsInput = conectShifts.getInputStream();
            shiftsReader = new BufferedReader(
                    new InputStreamReader(shiftsInput));
            shiftsReader.read(shifts, 0, count * 3);
        }

        return shifts;
    }

    public void encryptMessege() throws Exception {
        char[] currentShifts = Shifts(getCharacters());
        shiftsString = new String(currentShifts);
        //  shiftsString.replace("[\t\r\n]", "");
        shiftsStrings = shiftsString.split("[(  )]");
        shiftsInt = new int[shiftsStrings.length];
        System.out.println("These are your shifts");
        for (int v = 0; v < shiftsInt.length; v++) {
            shiftsInt[v] = Integer.parseInt(shiftsStrings[v]);
            System.out.println(shiftsInt[v] + " ");
        }
    }
} 
```

这是我的输出：

```
Welcome to the encryption system!
Type your messege below:
Hello

Here is your original messege: Hello

These are your shifts
3 
19 
12 
3 
Exception in thread "main" java.lang.NumberFormatException: For input string: "12

Process completed. 
```

我只是一个Java初学者（高中一年级comp sci），所以感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:37:52.730

问题似乎来自这里：

```
shiftsInt[v]= Integer.parseInt(shiftsStrings[v]); 
```

这在`v`达到for 循环值时失败`4`。从 for 循环中删除表达式，看看是否每个字符串实际上都`shiftsStrings` *可以*解析为`int`. 尝试执行这个：

```
for(int v = 0; v < shiftsStrings.length; v++ ) {
    System.out.println(shiftsStrings[v]);
} 
```

如果输出中有意外情况，下一步将是找出（并可能删除）该值如何在数组中找到它的位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:38:12.987

如果您认为这是由于最后一个数字中的非数字字符，那么在将其放入 parseInt 之前，请使用非数字字符替换它（您也可以使用`\r`，`\n`等等）。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replace(char](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#replace(char) , char)

Trim 是另一种有用的方法，它删除所有前导和尾随空格。

[http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#trim()](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#trim())

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:53:02.077

您的代码对我来说失败了，因为：

```
shiftsStrings = shiftsString.split("[(  )]"); 
```

没有正确拆分值。

编辑：

试试这个：

```
public void encryptMessege() throws Exception {
    List<Integer> shifts = new ArrayList<Integer>();
    StringTokenizer st = new StringTokenizer(new String(Shifts(getCharacters())));
    while(st.hasMoreTokens())
    {
        String token =st.nextToken();
        try{
            shifts.add(Integer.parseInt(token));
        }catch(NumberFormatException e)
        {
            System.out.println("did not parse: " + token);
        }
    }

    System.out.println("These are your shifts: " + shifts.toString());
} 
```

请注意，您应该在代码中处理很多事情。

1) 在方法中封装功能。当您将所有变量保留为类级别属性时，它会变得混乱。如果您使用参数在方法之间传递它们，您将更容易阅读代码，并且更容易测试您的代码。

2）您应该以小写字母开头的方法名称。这是常见的 Java 编码实践。

# xml - 无法编译 W3C 提供的 XSD 架构；无法解析“id”？

> ID：15373503
> 
> 赞同：3
> 
> 时间：2013-03-12T22:28:49.207
> 
> 标签：xml, xsd, xml-validation, inkml

我正在使用 XML 模式并尝试生成使用它的简单有效文档。

架构 XSD 由 W3C 提供，所以我无法想象它实际上有什么问题。但是`xmllint`在命令行以及任何数量的免费赠品在线验证器上都会抱怨实际的 XSD（不是我的测试文档）：

```
The QName value '{http://www.w3.org/XML/1998/namespace}id' does not resolve to a(n) attribute declaration. 
```

请注意，它无法解析`id`类型/名称，这是基本的 XML 内容。我不是 XML 大师，所以我可能在这里遗漏了一些关于名称空间/链接的明显内容。这对我的测试文档来说不是问题，因为即使是简单的测试文档在 XSD 编译位中也会失败。

[这是 XSD 文件](http://www.w3.org/TR/2011/REC-InkML-20110920/inkml.xsd)。这是一个简单的测试文档：

```
 <?xml version="1.0" encoding="UTF-8"?>
 <ink xmlns="http://www.w3.org/2003/InkML" 
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
     xsi:schemaLocation="http://www.w3.org/TR/2011/REC-InkML-20110920/inkml.xsd">
 </ink> 
```

但尽我所能，我无法获得`xmllint`或任何在线验证器甚至无法通过 XSD 解析/编译阶段，因为 XML id 类型在某种程度上是不稳定的。

我对 XML 的理解在这里不正确吗？我问的是 SO（相对于另一个站点），因为最终这是关于理解 XML 规范和依赖项以编写和验证文档。我欢迎做正确事情的代码片段，不管是什么正确的事情。

想法？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T04:17:22.847

您指向的模式包含对众所周知的 XML 模式的导入语句。

```
<xsd:import namespace="http://www.w3.org/XML/1998/namespace" id="xml" />
<!-- schemaLocation="http://www.w3.org/2001/xml.xsd" --> 
```

如您所见，与下面的另一个不同...

```
<xsd:import namespace="http://www.w3.org/1998/Math/MathML" schemaLocation="inkml-mathml2-subset.xsd" id="mathml" /> 
```

前者不为您提供 schemaLocation 属性。

如果您将`http://www.w3.org/2001/xml.xsd`URL 粘贴到浏览器中，一段时间后（或不，这取决于这些链接被限制），您应该会看到**xml.xsd** - 在您的情况下缺少的部分；如果您看到的是 HTML 而不是普通的 XML，请切换到源代码视图来查看它，这意味着 ../2008/09/xsd.xsl 样式表已由您的浏览器自动应用。

我敢肯定，如果您现在修改第一个导入以包含**schemaLocation**属性，那么大多数验证器现在应该可以工作了。

这种导入最有可能作为一种安全措施被“悬空”，以确保人们不会因为被认为是众所周知的 XSD 而一遍又一遍地访问 W3C 站点。期望（至少从我过去看到的情况来看）是 XSD 处理器自动将这些众所周知的命名空间引用解析为这些 XSD 的某种本地/嵌入式副本。显然，您尝试过的处理器默认情况下不会这样做。

[QTAssistant](http://www.paschidev.com)（我与它相关联）确实解决了它，因此如果您在本地下载这两个 XSD，然后按原样加载它们，每个都可以验证。

如果您不想修改 XSD - 例如，当您实际上想从远程 URL 加载 XSD 时，那么解决方案是向您的 XSD 处理器提供某种目录信息以帮助它解析**xml.xsd**。对于 xmllint，使用该`--catalogs`选项。我建议使用**xml.xsd**的本地副本。浏览您系统上可能已经拥有的目录（如果设置为 $SGML_CATALOG_FILES，否则为 /etc/xml/catalog），也许您已经可以使用现有的目录。

# datetime - Excel VBA 阻止 VBA 将时间值转换为小数

> ID：15373504
> 
> 赞同：1
> 
> 时间：2013-03-12T22:28:49.960
> 
> 标签：datetime, excel, vba

我试图从我的工作簿中提取数据，因为我把工作簿弄错了，但我想保留数据。所以我必须浏览每个工作表并提取我需要的特定数据位。（重复任务 = vba 代码救援）

我已经完成了，但我有一个讨厌的小问题。

我正在使用 ws.Range("C13") 来提取我需要的每个单元格。这是一个具有 10:00 或 22:13 等时间值的单元格。当我 debug.print 该值时，我得到一个小数。为什么？如何防止它将我的“10:30”转换为“0.4375”

据我所知，小数点甚至与时间值无关。错了，它只是表示 24 小时周期的时间值。所以它是相关的。但还是。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T23:19:08.440

`ws.Range("C13")`等效于`ws.Range("C13").Value`从该单元格返回基础数据。

如果改为使用`ws.Range("C13").Text`，您将从单元格中获取显示的文本。如果您为该单元格设置了特定的日期/时间格式，则调用`ws.Range("C13").Text`应返回该特定格式的文本

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:39:38.027

时间值正确；这是 Excel 在内部存储日期和时间值的方式。

日期存储为浮点值，其中整个部分表示自`12/30/1899 00:00.00`(date `0.0`) 以来的天数，小数部分表示一天的小数部分（例如，`408875.5`表示`11/28/2011 12:00:00 PM`）。

以下是一些您可能会发现有用的转换因子：

```
Decimal value    Time Value    Calculation 
=============    ==========    ===========
0.00094444444    12:01:00 AM   1.0 / 24 / 60 (1 day/24 hours/60 minutes per hour)
0.01041666666    12:15:00 AM   1.0 / 24 / 60 * 15
0.02083333333    12:30:00 AM   1.0 / 24 / 60 * 30
0.04166666666    01:00:00 AM   1.0 / 24 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-01-30T22:57:08.680

```
hours        = MOD(INT(0.tttttttt*24), 24)
minutes      = MOD(INT(0.tttttttt*24*60), 60)
seconds      = MOD(INT(0.tttttttt*24*60*60), 60)
milliseconds = MOD(INT(0.tttttttt*24*60*60*1000), 1000) 
```

# c++ - boost::algorithm::to_upper/to_lower 对 utf8 好吗？boost::locale 不需要？

> ID：15373510
> 
> 赞同：9
> 
> 时间：2013-03-12T22:29:21.607
> 
> 标签：c++, string, boost, internationalization

我在几个地方读到 boost::algorithm::to_upper/to_lower 不适用于 utf8：

*   [http://www.boost.org/doc/libs/1_51_0/libs/locale/doc/html/conversions.html](http://www.boost.org/doc/libs/1_51_0/libs/locale/doc/html/conversions.html)
*   [如何将 std::string 转换为小写？](https://stackoverflow.com/questions/313970/stl-string-to-lower-case)
*   [使用 UTF8](https://stackoverflow.com/questions/10967878/working-with-utf8)

但是在我的系统上，ubuntu 12.4.1 32 bits with boost 1.46, and locale en_GB.UTF-8，一切看起来都很好，只要我通过了语言环境例如：

```
std::locale englishUTF8locale("en_GB.UTF-8")
boost::algorithm::to_upper_copy(L"ü", englishUTF8locale) -> L"Ü"
boost::algorithm::to_lower_copy(L"и", englishUTF8locale) ->L"И" 
```

值得注意的是它在使用 std::wstring 时有效，但在使用 std::string 时无效

那么， boost::locale 真的没有必要吗？我的问题是我只能使用 boost 1.46，并且语言环境是为 1.48 创建的

# python - 使用 scipy 将 matlab 函数保存到磁盘

> ID：15373514
> 
> 赞同：1
> 
> 时间：2013-03-12T22:29:46.347
> 
> 标签：python, matlab, scipy

使用 Python，我想将 Matlab 结构写入磁盘。这使用 scipy.io 模块相当简单：http: [//docs.scipy.org/doc/scipy-0.9.0/reference/tutorial/io.html](http://docs.scipy.org/doc/scipy-0.9.0/reference/tutorial/io.html)

但是，我希望结构的一个字段成为表单的函数，`@sqrt`这样当我在 matlab 中将 .mat 文件加载到磁盘时，我得到了这个功能：

```
>> myStruct = load('MyStruct.mat')
>> myStruct.myFunction(5)
ans =
    2.2361 
```

但我找不到如何做到这一点。简单地将“@sqrt”字符串放入结构字段之一是行不通的。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:14:18.440

我从未使用过 SciPy，但我能想到一个可能的解决方法。存储函数名称字符串而不是其句柄，并在 MATLAB 中使用[`str2func`](http://www.mathworks.com/help/matlab/ref/str2func.html)：

```
myfunc = str2func(myStruct.myFunction);
myfunc(5) 
```

如果你真的需要单线，你可以[`feval`](http://www.mathworks.com/help/matlab/ref/feval.html)改用：

```
feval(myStruct.myFunction, 5) 
```

# java - 从 Ajax 调用中获取响应文本

> ID：15373516
> 
> 赞同：0
> 
> 时间：2013-03-12T22:29:52.650
> 
> 标签：java, html, ajax, jquery

我正在尝试将 Ajax 调用的响应转换为 html 标签。我正在使用tomcat服务器。我可以看到从服务器返回的描述，但是我如何将响应获取到标签文本中。下面是我尝试过的：

**jQuery**

```
 function GetDescription(Id){                   
        $.ajax({
        type:'GET',
        url:'getDescription.htm',
        data:{dId:Id},
        dataType: 'json',
        success: function (data) {

            $('.TypeDesc').text = data.responseText;

        }

    });

}

$(document).ready(function() {      

            $(".photos").each(function(i){              

                if ($(this).val() != '') {
                       var image = new Image();                      
                        image.src =  $(this).val();

                        image.onload = function(){ 
                                       var typeId = document.getElementsByClassName("TypeId")[i].value;
                                       GetDescription(typeId);

                                       var ctx = document.getElementsByClassName("canvas")[i].getContext('2d');
                                       ctx.drawImage(image,0,0, 320, 240); 
                         }               
                }
            });       

        }); 
```

**html**

```
</head>
<body>
<div id ="content">
<c:forEach items="${object}" var="i">
<div id="table">    
    <div>
        <p><canvas class="canvas" height="240" width="320"></canvas>
    </div>
        <a href="registration.htm">Name:- ${i.fName}  ${i.lName}</a>
        <input type="hidden" id="photo" value="${i.photo}" class="photos"/>
        <input type="hidden" id="Number" value="${i.Number}" />
        <input type="text" class="TypeId" value="${i.citizenTypeId}"/>
        <label class="TypeDesc"></label>
</div>
</c:forEach>
</div>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:36:09.400

问题是你告诉 jQuery 你期待 JSON：

```
dataType: 'json', 
```

...因此它（尝试）将响应解析为 JSON 并向您传递一个对象，但随后您尝试像使用原始 XHR 对象一样使用它。

如果您想要*text*，请删除`dataType`或将其更改为`dataType: 'text'`，然后使用`data`which 将是一个字符串。

你的另一个问题是它[`text`](http://api.jquery.com/text)是一个*函数*，而不是一个属性，所以你需要*调用*它。

所以：

```
dataType: 'text',
success: function (data) {

    $('.TypeDesc').text(data);

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:33:58.267

请将此添加到ajax调用的参数中

```
 success: function(data) {
        $('.TypeDesc').each(function(){
            $(this).text(data);
        });
    } 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:32:23.683

您需要为标签提供一个唯一的 ID，例如`id="TypeDesc{i}"`或不同的东西。

所以你可以这样引用它： `$('#TypeDesc{i}').text = data.responseText;`

# asp.net-mvc - MVC 部分渲染

> ID：15373524
> 
> 赞同：-1
> 
> 时间：2013-03-12T22:30:14.883
> 
> 标签：asp.net-mvc

如果 MVC 中的 renderpartial 不像 ASP.net 中的更新面板。而不是它是如何工作的，以及效率如何。听说更新面板使用效率太低了。但是 MVC 是如何处理回发的，在我深入研究 MVC 之前我需要理解这一点

任何建议谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:58:48.863

ASP.MVC 部分视图只是可以由视图模型填充的可重用 HTML 片段。它们没有像更新面板那样的特殊内置功能。

一般来说，使用 ASP.MVC，**您可以**控制回传。事实上，您必须自己用 HTML 和 JavaScript 编写代码。

我建议你[从这里开始](http://www.asp.net/mvc/tutorials)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:59:28.977

假设您要更新部分页面，我使用的方法如下：

*   将 JavaScript 函数链接到要用于更新“面板”的事件
*   对控制器中的操作进行 jQuery AJAX 调用
*   从控制器返回对局部视图的调用
*   这将导致从局部视图生成的 HTML 作为 HTML 返回给您的 AJAX 调用
*   使用 jQuery 将 HTML 添加到现有的空 div

AJAX 调用看起来像

```
$.ajax({
    url: yourControllerAction URL,
    data: { CodeTypeID: codeTypeID }, // optional data
    type: "POST",
    success: function (returnedHtml) {
        $("#myDiv").html(htmreturnedHtmll);
    }
}); 
```

其余的是标准 MVC

希望有帮助

# dynamics-crm-2011 - 在 MS Dynamics 中查找查找项数值

> ID：15373528
> 
> 赞同：1
> 
> 时间：2013-03-12T22:30:26.017
> 
> 标签：dynamics-crm-2011

我有一个由 ExpressionEngine 2.5.x 提供支持的站点，它使用 Freeform，集成以将表单数据发布到 MS Dynamics CRM 2011。该扩展具有很好的可扩展性，我可以更改映射，所有这些都很棒。我的问题是如何在 MS Dynamics 中查找查找字段的映射值。

我正在尝试将站点表单中的表单字段映射到 MS Dynamics。一些字段是 MS Dynamics 中的 Lookups。我们的映射调用了 Lookup 项的数值，而不是它的名称。（这很好，因为 ppl 可以在 MS Dynamics 控制台中更改文本名称而不会破坏映射。）

我的问题是：我知道如何在 MS Dynamics 中找到表单字段的实际后端字段名称。但是如何找到选项列表项和查找字段的数值？假设我有一个查找字段，用于潜在客户来源（称为campaignid）。这些项目是：

*   网络
*   在线的
*   广播广告
*   传单
*   口口相传
*   其他

我知道当我编辑选项集中的选项时，我可以看到它们的数值。我可以在哪里编辑查找字段中的选项？我尝试在*Settings > Customizations > Customize the System*下查看，但没有看到任何名为*lookup*的内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:56:13.477

查找是指向实体的指针。它们没有像常规选项集那样的数值。因此，我猜您将拥有名为 Campaign（或潜在客户）的实体，因此您可以检查 crm 数据库中存在哪些活动，每个实体都可以在数据库中查看。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T23:01:05.017

让我们看看我是否理解你的问题。您没有像选项集这样的查找选项，因为查找是两个实体之间关系 1:N 的结果。因此，要编辑查找，您需要编辑实体的记录。在查找字段中，您没有数值，您有单独表示记录的 guid，因此在记录中，查找作为 guid 存储在数据库中。检查这个[视频](http://www.youtube.com/watch?v=D7qZlINs-2g)。

[在此处](http://crmbusiness.wordpress.com/2011/02/21/crm-2011-quick-way-to-find-a-guid-using-a-crm-form/)查看如何在打开记录的情况下找到此指南。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T06:51:59.363

查找字段粗略地说是指向实体的指针（在 C# 中，它被称为*EntityReference*而不是*Entity*），它主要由*something*的 guid 和逻辑名称组成。

通常，在代码中，当您有一个实体时，为了访问其查找连接实体的字段，您需要为此进行额外的查询。

因此，如果您有一个*Contact*实例并需要查看其父客户的地址，则您必须获取 guid 和逻辑名称（在本例中为*Account*）并分别检索它的数据。

编辑：

假设您已经创建了一个*Contact*实体的实例，并且您想访问它的*lastName*字段。那么你可以简单的参考如下。

```
var value = Xrm.Page.getAttribute(“lastName”).getValue(); 
```

在同一个表单上，还有一个引用*Account*实例的字段（它的名称是*parentCustomerId*。假设现在您想要获取*Account的**fullName*字段。可以预期以下内容会起作用。

 *```
var account = Xrm.Page.getAttribute("parentCusomterId").getValue();
var name = account.getAttribute("fullName").getValue(); 
```

但是，这行不通，因为*parentCutomerId*是一个查找字段。这意味着它仅包含标识其他实体的 guid（指针、引用）。您必须使用它（guid）才能获取查找“提及”的实例。**然后**你就可以检查它的属性了。*

# php - 解析大型 JSON 文件

> ID：15373529
> 
> 赞同：18
> 
> 时间：2013-03-12T22:30:30.383
> 
> 标签：php, mysql, json

我正在编写一个命中 API、接收 JSON 文件（大量对象）并将其存储在本地的 cron 脚本。一旦完成，另一个脚本需要解析下载的 JSON 文件并将每个对象插入 MySQL 数据库。

我目前正在使用`file_get_contents()`with `json_decode()`。这将在尝试处理之前尝试将整个文件读入内存。这很好，除了我的 JSON 文件通常在 250MB-1GB+ 范围内。我知道我可以增加我的 PHP 内存限制，但这似乎不是我心目中最好的答案。我知道我可以运行`fopen()`并`fgets()`逐行读取文件，但我需要按每个 json 对象读取文件。

有没有办法读取每个对象的文件，还是有另一种类似的方法？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T22:54:33.687

试试这个库[https://github.com/shevron/ext-jsonreader](https://github.com/shevron/ext-jsonreader)

> PHP 附带的现有 ext/json 非常方便且易于使用 - 但在处理大量 JSON 数据时效率低下，因为它需要将整个 JSON 数据读入内存（例如使用 file_get_contents()），然后一次将其转换为 PHP 变量 - 对于大型数据集，这会占用大量内存。
> 
> JSONReader 专为提高内存效率而设计 - 它适用于流，可以从任何 PHP 流中读取 JSON 数据，而无需将整个数据加载到内存中。它还允许开发人员从 JSON 流中提取特定值，而无需解码所有数据并将其加载到内存中。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-12T22:36:26.963

这实际上取决于 json 文件包含的内容。

如果无法将文件一次性打开到内存中，那么您唯一的其他选择就是 fopen/fgets。

可以逐行读取，如果这些 json 对象具有一致的结构，您可以轻松检测文件中的 json 对象何时开始，何时结束。

收集到整个对象后，将其插入数据库，然后继续下一个。

没有更多的了。根据您的数据源，检测 json 对象的开头和结尾的算法可能会变得复杂，但我之前使用更复杂的结构 (xml) 做过类似的事情，并且效果很好。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-12T22:43:18.100

最佳解决方案：

使用某种分隔符（分页、时间戳、对象 ID 等），允许您通过多个请求以较小的块读取数据。此解决方案假定您对这些 JSON 文件的生成方式有某种控制。我的假设基于：

> 这很好，除了**我的**JSON 文件通常在 250MB-1GB+ 范围内。

读取和处理 1GB 的 JSON 数据简直是荒谬的。绝对需要更好的方法。

# javascript - Web 图形可视化工具

> ID：15373530
> 
> 赞同：2
> 
> 时间：2013-03-12T22:30:33.100
> 
> 标签：javascript, graph-visualization

我需要一个用于网络的库来可视化图表，它应该是交互式的，就像它不显示整个图表而是显示其中的一部分，但是当您单击特定节点时允许导航，这是我见过的最好的例子远是

[http://asterisq.com/products/constellation/roamer/demo](http://asterisq.com/products/constellation/roamer/demo)

它是如何在闪存中的，我需要一个在 javascript 中

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:45:17.837

一些 JavaScript 库：

[http://arborjs.org/](http://arborjs.org/) -> 看起来你在找什么

[http://getspringy.com/demo.html](http://getspringy.com/demo.html)

[http://sigmajs.org/](http://sigmajs.org/)

[https://github.com/anvaka/VivaGraphJS](https://github.com/anvaka/VivaGraphJS)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:41:09.847

# wpf - WPF 是否成熟到可以在大型软件中使用

> ID：15373532
> 
> 赞同：-2
> 
> 时间：2013-03-12T22:30:35.893
> 
> 标签：wpf

我想将我们的 WinForms 技术替换为 WPF。WPF 是否足够成熟，可以迁移到？

什么是迁移风险？

它是否经过调整和足够强大？没有像 SilverLight 那样弃用 WPF 的计划吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:57:08.947

> 我想将我们的 WinForms 技术替换为 WPF。WPF 是否足够成熟，可以迁移到？

是的。

> 什么是迁移风险？

了解 MVVM 的 SOLID 实现所需的时间和培训。

> 它是否经过调整和足够强大？没有像 SilverLight 那样弃用 WPF 的计划吗？

WPF 在 Windows 8 中被“贬低”了......但所有的功能仍然存在 - 很难解释......

Metro Apps 仍将使用 XAML 和 DataBinding 来描述 UI 和与视图模型的交互。应用程序仍然可以用 C# 编写，并且有一个专用于它的 .net 框架（4.5）。但不是编译为 CLR，而是编译为本机代码。

因此，虽然 WPF 在技术上是贬义的，但我们剩下的（Metro）步行、谈话和其他行为就像 WPF 开发工作一样。

也就是说，WPF 应用程序可以在 Windows 8 计算机的“经典桌面”上运行，而 .net 框架 4.0 仍然是当前技术。

PS 这个话题很可能已经结束了——你也许可以在[https://softwareengineering.stackexchange.com/上得到更好的答案](https://softwareengineering.stackexchange.com/)

# c# - 以第二种形式使用的公共变量

> ID：15373537
> 
> 赞同：0
> 
> 时间：2013-03-12T22:30:51.187
> 
> 标签：c#, visual-studio, variables, public

我有一个“简单”的问题，即从 FORM1 分配变量（在我的代码 Form1 中）并在 FORM2 中使用这些变量（在我的代码 frLeczenie 中）。于是我开始创建一个公共字符串变量：

```
 public string wynikImie;
        public string wynikUmaszczenie;
        public string wynikDataUrodzenia;
        public string wynikPlec;
        public string wynikZnakiSzczegolne;
        public string wynikCzyWykastrowane; 
```

对于这些变量，我将从 SQL 数据库中分配数据：

```
private void dgZwierze_CellContentClick(object sender, DataGridViewCellEventArgs e)
        {
            string zapytanie = "SELECT IMIE_ZWIERZECIA, DATA_URODZENIA, PLEC, ZNAKI_SZCZEGOLNE, UMASZCZENIE, CZY_WYKASTROWANE FROM tbZwierze WHERE tbZwierze.IMIE_ZWIERZECIA = '" + wynikImie + "' AND tbZwierze.UMASZCZENIE = '" + wynikUmaszczenie + "'";
            SqlCommand cmdZapytanie = new SqlCommand(zapytanie, cs);
            cs.Open();
            SqlDataReader reader = cmdZapytanie.ExecuteReader();

                if (reader.Read())
                {
                    wynikImie = reader.GetValue(0).ToString();
                    wynikDataUrodzenia = reader.GetValue(1).ToString();
                    wynikPlec = reader.GetValue(2).ToString();
                    wynikZnakiSzczegolne = reader.GetValue(3).ToString();
                    wynikUmaszczenie = reader.GetValue(4).ToString();
                    wynikCzyWykastrowane = reader.GetValue(5).ToString();
                }
            cs.Close();
        } 
```

到现在一切都很好，但是当我打开 FORM2 时出现问题：

```
private void btnLeczenie_Click(object sender, EventArgs e)
        {
            frLeczenie leczenie = new frLeczenie();
            leczenie.ShowDialog(); 
        } 
```

突然，我分配给公共字符串变量的所有数据都丢失了，我无法在 FORM 2 中使用它们：

```
private void frLeczenie_Load(object sender, EventArgs e)
        {
            Form1 formaglowna = new Form1();
            textBox1.Text = formaglowna.wynikImie;
            textBox2.Text = formaglowna.wynikDataUrodzenia;
            textBox3.Text = formaglowna.wynikPlec;
            textBox4.Text = formaglowna.wynikZnakiSzczegolne;
            textBox5.Text = formaglowna.wynikUmaszczenie;
            textBox6.Text = formaglowna.wynikCzyWykastrowane;
        } 
```

我做错了什么？也许我错过了什么？你能看看这个吗？

问候，彼得。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:34:11.457

`new Form1();`创建第一个表单的新实例，但您想使用已经初始化的表单及其变量。因此，您可以通过构造函数将表单实例传递给您的第二个表单并将其存储在一个属性中：

第一种形式：

```
frLeczenie leczenie = new frLeczenie(this); 
```

第二种形式的构造函数：

```
public frLeczenie(Form1 formaglowna)
{
    InitializeComponent();

    this.Formaglowna = formaglowna;
    // ...
}

public Form1 Formaglowna{ get; set; } 
```

现在您可以通过属性访问它们：

```
textBox1.Text = Formaglowna.wynikImie;
// ... 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:34:38.443

请注意，您在其`dgZwierze_CellContentClick`方法中设置表单实例中的值。但是，在表单 2 中，您正在创建一个从未显示或调用过该方法的新 Form1。所以值是空的。

```
Form1 formaglowna = new Form1();
textBox1.Text = formaglowna.wynikImie; 
```

您需要的是将真实的 form1 传递给 form2 而不是创建新的 form 1

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:37:06.537

当您在代码的最后一部分创建新的 form1 时，它是该类的一个新的空白实例。类或表单的每个实例都有自己的变量值。如果您确实需要这些变量在给定类的所有对象上可用和共享，请将它们设为静态。

# c# - 内容多于容器时的 WPF 容器工件

> ID：15373544
> 
> 赞同：1
> 
> 时间：2013-03-12T22:31:06.727
> 
> 标签：c#, wpf

我正在为控制创建样式并遇到了一个奇怪的问题。

只是比较：

*   普通滑块：![普通滑块](../Images/2828fd839ae550b713ea2110ca06d9e8.png)
*   减少图像容器时得到的结果：![带有伪影的滑块](../Images/de3e2e1574f5628eb4ac9a0552479798.png)

这是什么？那不是我的边界，我没有使用任何边界或类似的东西。它影响的不仅仅是图像。这只是一个例子。如何避免这种行为？

当我减小容器（拇指）大小时的代码：

```
<Track.Thumb>
    <Thumb x:Name="Thumb" Height="15" Width="15">
        <Thumb.Template>
            <ControlTemplate TargetType="Thumb">
                <Image Source="../Images/Player/slider_thumb.png" Height="17" Width="17" />
            </ControlTemplate>
        </Thumb.Template>
    </Thumb>
</Track.Thumb> 
```

# sql - SQL 按 id 分组的行总和

> ID：15373545
> 
> 赞同：2
> 
> 时间：2013-03-12T22:31:15.780
> 
> 标签：sql, sql-server

这个 SQL：

```
select Name,
       (select COUNT(1) from tbl_projects where statusId = tbl_sections.StatusId) as N
from tbl_sections
left join tbl_section_names on tbl_section_names.Id = NameId 
```

生成以下数据：

```
Name    N
Completed   133
Cancelled   100
Unassigned  1
Sales   49
Development 10
Development 4
Development 1 
```

我正在尝试对其进行修改，使其返回数据如下：

```
Name    N
Completed   133
Cancelled   100
Unassigned  1
Sales   49
Development 15 
```

（即总结名称相同的行）

任何人都可以就如何使这项工作提出一些线索吗？我猜我需要一个 SUM 和一个 GROUP BY，但它甚至从不运行查询，因为我得到的只是错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:34:16.127

试试这个查询。它`N`按 分组`Name`。

```
SELECT Name, SUM(N) 
FROM (
    SELECT Name,
    (SELECT COUNT(1) 
        FROM tbl_projects 
        WHERE statusId = tbl_sections.StatusId
    ) AS N
    FROM tbl_sections
    LEFT JOIN tbl_section_names ON tbl_section_names.Id = NameId
) a
GROUP BY a.Name 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:36:12.910

试试这个

```
select Name, count(p.statusid) N
from tbl_sections
left join tbl_section_names on tbl_section_names.Id = NameId
left outer join tbl_projects p on tbl_sections.StatusId = p.statusId 
group by Name 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:33:57.197

```
Select Name, Sum(N) from
    (select Name,
       (select COUNT(1) from tbl_projects where statusId = tbl_sections.StatusId) as N
    from tbl_sections
    left join tbl_section_names on tbl_section_names.Id = NameId)
group by Name 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:37:12.123

此查询为您提供每个状态的计数，这意味着 Development 具有具有三个不同状态的部分，如果您将状态添加为列，查询将反映这一点并且更有意义：

```
select Name, tbl_sections.StatusId,
       (select COUNT(1) from tbl_projects where statusId = tbl_sections.StatusId) as N
from tbl_sections
left join tbl_section_names on tbl_section_names.Id = NameId 
```

我不知道您的数据库的结构，但是如果您想计算每个名称的部分数，我可能是这样的。这基本上会查看连接的结果，然后通过告诉您每个唯一名称出现的次数来总结它：

```
select Name, count(*)
from tbl_sections
left join tbl_section_names on tbl_section_names.Id = NameId
Group By Name 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T22:37:33.657

试试看。

```
select Name,
   SUM(select COUNT(1) from tbl_projects where statusId = tbl_sections.StatusId) as N
from tbl_sections
left join tbl_section_names on tbl_section_names.Id = NameId
group by Name 
```

# biztalk - 未找到 BizTalk 错误架构

> ID：15373558
> 
> 赞同：1
> 
> 时间：2013-03-12T22:32:10.067
> 
> 标签：biztalk, biztalk-2010, btahl7

我收到一个 HL7 2.3 ORU 模式。我已将适当的一方配置为使用“ [http://mycompany.ca/application/HL7/2X/2.3/1](http://mycompany.ca/application/HL7/2X/2.3/1) ”的模式命名空间

我已经构建了我的自定义 HL7 架构，将 targetNamespace 设置为“ [http://mycompany.ca/application/HL7/2X/2.3/1](http://mycompany.ca/application/HL7/2X/2.3/1) ”，并确保它具有“ORU_R01_23_GLO_DEF”的根元素。

我已经通过导入将架构部署到 biztalk，然后运行 ​​msi。
我可以看到我的 BIzTalk 应用程序中有架构，并且我可以看到 MSI 在驱动器上安装了架构。

当我将 HL7 发送到我的接收位置时，我在 evenlog 中收到错误：

解析错误＃1期间发生在正文中的错误

备用错误号：301 备用错误描述：架构[http://mycompany.ca/application/HL7/2X/2.3/1#ORU_R01_23_GLO_DEF](http://mycompany.ca/application/HL7/2X/2.3/1#ORU_R01_23_GLO_DEF)未找到备用编码系统：HL7-BTA

由此，我可以看出派对解析工作正常，但无法弄清楚为什么它找不到架构。

# css - 菜单栏不在页面中心，我已经尝试了一切

> ID：15373559
> 
> 赞同：-2
> 
> 时间：2013-03-12T22:32:17.880
> 
> 标签：css

由于某种原因，即使我输入了许多不同的代码，以下代码也不会在页面上居中。

这是代码：

```
@charset "utf-8";
/* CSS Document */

#nav {
font-family:Consolas, "Andale Mono", "Lucida Console", "Lucida Sans Typewriter",       Monaco, "Courier New", monospace;
margin: 0 0 3em 0;
padding: 10px 50%;
list-style: none;
margin-left:auto;
margin-right:auto;
display: inline-block;
}
#nav li {
float: left;
}
#nav li a {
padding: 8px 15px;
text-decoration: none;
color:white;
display:inline-block;
font-size:18px;
}
#nav li a:hover {
color:#00BFFF;
}
#header {
margin-top: 0;
width:100%;
height:150px;
background-color:#09F;
} 
```

请记住，导航栏位于标题内。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:36:09.473

试试看

```
#nav {
font-family:Consolas, "Andale Mono", "Lucida Console", "Lucida Sans Typewriter",           Monaco, "Courier New", monospace;
margin: 0 auto 3em;
width: XXpx
padding: 10px 50%;
list-style: none;
margin-left:auto;
margin-right:auto;
display: inline-block;
} 
```

并定义宽度

编辑：

```
function onload() {
document.getElementById("nav").style.marginLeft = Math.round(document.getElementById("nav").offsetWidth/2)+"px";} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:44:12.660

[**jsFiddle**](http://jsfiddle.net/GWCnf/6/)

您只需要删除 上的显示属性`<ul>`并为其指定宽度。我还删除了列表中的填充。

# django - Django 在 BooleanField 上注释

> ID：15373569
> 
> 赞同：8
> 
> 时间：2013-03-12T22:33:00.657
> 
> 标签：django, sqlite, postgresql, django-queryset

我有以下型号：

```
class Foo(models.Model):
    pass

class Bar(models.Model):
    foo = models.ForeignKey(Foo)
    is_successful = models.BooleanField() 
```

如果与对象关联的所有对象都具有，我想获取`foo`带有注释的所有对象`bar``foo``is_successful``True`

到目前为止，我的查询集是：

```
foos = Foo.objects.all().annotate(all_successful=Min('bar__is_successful')) 
```

注释的想法`all_successful`是，如果所有行的最小值`is_successful`为 1，那么它们都必须是`True`（假设`0`is`False`和`1`is `True`）。所以知道我可以像这样使用查询集：

```
foo = foos[0]

if foo.all_successful == 1:
    print 'All bars are successful'
else:
    print 'Not all bars are successful' 
```

这在 sqlite 中效果很好，但是在 PostgreSQL 中失败了，因为 PostgreSQL 无法`MIN`在布尔列上执行聚合。我猜这在 sqlite 中有效，因为 sqlite 将布尔值视为整数，因此它可以执行聚合。

我的问题是如何在不将我的`is_successful`字段转换为 PostgreSQL 的情况下使这个查询集在 PostgreSQL 中工作`IntegerField`？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2015-10-04T12:15:04.270

我知道这是一个老问题，但我最近遇到了这个问题。Django v1.8 现在内置了对 case/when 的支持，因此您可以使用 ORM 而不是随意使用自定义 SQL。

[https://docs.djangoproject.com/en/1.8/ref/models/conditional-expressions/#case](https://docs.djangoproject.com/en/1.8/ref/models/conditional-expressions/#case)

```
Foo.objects.annotate(
    all_successful=Case(
        When(bar__is_successful=False, then=False),
        When(bar__is_successful=True, then=True),
        default=False,
        output_field=BooleanField()
    )) 
```

我还没有尝试过，但是在最近的一个项目中，类似的东西对我有用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-13T00:20:06.023

**FOR DJANGO <= 1.7：**`annotation`我认为你可以简单*地*使用[Extra](https://docs.djangoproject.com/en/dev/ref/models/querysets/#extra)

```
foos = Foo.objects.extra(select={'all_successful': 'CASE WHEN COUNT(b.foo) > 0 THEN 0 ELSE 1 END FROM yourapp_bar as b WHERE b.is_successful = false and b.foo = yourapp_foo.id' }) 
```

如果您的系统正在运行**Django 1.8+** ，请遵循 Dav3xor [answer](https://stackoverflow.com/a/32933336/582906)。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T23:18:40.313

受到[https://docs.djangoproject.com/en/dev/topics/db/managers/](https://docs.djangoproject.com/en/dev/topics/db/managers/)的启发，我建议对 Bar 类使用自定义管理器而不是注释

```
class BarManager(models.Manager):
    def get_all_successful_foos_ids(self):
        from django.db import connection
        cursor = connection.cursor()
        cursor.execute("""
            SELECT foo, COUNT(*)
            FROM yourapp_bar
            GROUP BY 1
            WHERE is_successful = true""")  # <-- you have to write the correct table name here
        result_list = []
        for row in cursor.fetchall():
            if row[1] > 0:
                result_list.append(row[0])
        return result_list

class Bar(models.Model):
    foo = models.ForeignKey(Foo)
    is_successful = models.BooleanField()
    objects = BarManager()  # here I'm changing the default manager 
```

然后，在您的代码中：

```
foos = foo.objects.filter(id__in=Bar.objects.get_all_successful_foos_ids()) 
```

# r - 编织#-符号

> ID：15373571
> 
> 赞同：1
> 
> 时间：2013-03-12T22:33:13.717
> 
> 标签：r, latex, sweave

如何使用#-符号编织文本？

在这里，Sweaving 和编译是没有问题的：

```
<<echo=false,results=tex>>
cat("This is my text\n") 
@ 
```

但是在这里，编译会出错：

```
<<echo=false,results=tex>>
cat("This is #my text\n")
@ 
```

无法在 tex 中编译井号。我必须将 Sweave 选项设置为“tex”，因为我想在一个循环中打印不同的文本文件，并且每个文本文件应该由一个新章节分隔。

```
<<results=tex>>
for(i in d){
  tx <- readLines(i)
  cat(tx, sep="\n")
  \chapter{i}
  } 
```

感谢您的每一个提示。

蒂姆

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T22:41:38.507

您必须转义哈希符号，因为它在 LaTeX 中具有特殊含义。

```
\documentclass{article}

\begin{document}
\SweaveOpts{concordance=TRUE}

<<echo=false,results=tex>>=
cat("This is \\#my text\n") 
@

\end{document} 
```

# javascript - 如何修复我的 jquery+flash 插件和 require.js 之间的范围问题

> ID：15373572
> 
> 赞同：0
> 
> 时间：2013-03-12T22:33:14.120
> 
> 标签：javascript, requirejs

我今天在 GitHub 上收到了一个关于一个[小型 jquery 插件的](https://github.com/patricklodder/jquery-zclip)[拉取请求](https://github.com/patricklodder/jquery-zclip/pull/2)，该插件提议在它的主分支中进行一些修改，因为该插件的 Flash 元素不适用于[require.js](http://requirejs.org/)闭包。归结为 Flash 需要一个全局变量，因此通过 require.js 加载后范围会发生变化，并且不再看到该变量。

拉取请求中建议的修复是省略声明，所以基本上：

```
foo = { "bar": 1 }; 
```

代替：

```
var foo = { "bar": 1 }; 
```

但这会禁止 jslint 永远通过，所以我真的不想这样做。

我应该在我的主脚本中解决这个问题吗？

```
var foo = { "bar": 1 };
if ( typeof(window) === 'object' ) { window['foo'] = foo; } 
```

还是我应该鼓励在实现中而不是在我的脚本中解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:38:46.037

如果您需要 Flash 的全局变量，那么我建议**为您的应用程序创建一个适当的命名空间，**以便 Flash 可以通过单个入口点访问它。

```
// create your objects for your app
var foo = {
    bar: 1
};

// add your object to the global namespace  eg. 'myApp'
window.myApp = foo; 
```

这篇文章可能会有所帮助：[http ://www.2ality.com/2011/04/modules-and-namespaces-in-javascript.html](http://www.2ality.com/2011/04/modules-and-namespaces-in-javascript.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:39:30.763

第三方是否需要直接控制变量？您可以`window.foo = foo`在末尾添加该行。

但是，拥有一个返回值的方法会更安全`getFoo()`，这样您就可以控制变量。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:45:21.690

您可以提供一个初始化参数，允许您的库的使用者选择将其粘贴到何处。

```
require(['theflashlibrary'], function(theFlashLibrary){

    theFlashLibrary.init({ globalProperty: 'foo' }); //Otherwise this could default to something else...
}); 
```

我没有这样做的好方法，但是，我觉得至少为用户提供一种方法来选择引用您的库的位置会很好。

# ios - iOS DDMathParser 获取字符串中出现的 (...)

> ID：15373573
> 
> 赞同：1
> 
> 时间：2013-03-12T22:33:19.333
> 
> 标签：ios, string, math, ddmathparser

我`DDMathParser`在我的应用程序中使用，并且最近遇到需要在 () 括号括号内获取任何数字组的出现（非常技术性！）。例如，我需要**`(6+5)`**离开**`6+7/8(6+5)`**. 具体来说，我希望能够做到这一点，以便我可以`(56+9)sqrt`像`sqrt(56+9)`. 有什么帮助吗？

*PS 我知道 DDMathParser 的制造者经常出现在这片树林的脖子上。我暗暗希望他能来救援，或者解决我的问题，这样我就可以自己实现它，或者他让它成为 DDMathParser 的一部分！:)*

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T23:19:38.280

所以，自从你一个月前发布这个问题以来，我已经考虑了很多。据我了解，当用户单击/点击按钮时，您正在构建一个字符串。

我认为这是你的问题。

当用户点击按钮时，您应该构建（或修改）`DDExpression`对象。这是数学表达式的“纯”格式，而字符串是有损且难以操作的。您向用户显示的字符串应该从`DDExpression`您正在构建的树中生成。

这是一个复杂的问题，我仍然不完全确定我将如何实现它，但这是我如何做到这一点的根源。我*不会*仅仅根据用户键入的内容来构造一个字符串。

# google-app-engine - Google App Engine 上的 Jersey 1.17

> ID：15373575
> 
> 赞同：1
> 
> 时间：2013-03-12T22:33:29.560
> 
> 标签：google-app-engine, rest, jersey

我在 Google App Engine 上部署了 REST 服务，每次尝试查询服务时都会收到以下错误：

```
com.sun.jersey.core.spi.component.ProviderFactory __getComponentProvider: The provider class, class com.sun.jersey.core.impl.provider.entity.MimeMultipartProvider, could not be instantiated. Processing will continue but the class will not be utilized
java.lang.SecurityException: Unable to get members for class com.sun.jersey.core.impl.provider.entity.MimeMultipartProvider
    at com.google.appengine.runtime.Request.process-7d6711107bb7eaaa(Request.java)
    at java.lang.Class.getDeclaredMethods(Class.java:253)
    at com.sun.jersey.core.reflection.MethodList.getAllDeclaredMethods(MethodList.java:70)
    at com.sun.jersey.core.reflection.MethodList.<init>(MethodList.java:64)
    at com.sun.jersey.core.spi.component.ComponentConstructor.getPostConstructMethods(ComponentConstructor.java:131)
    at com.sun.jersey.core.spi.component.ComponentConstructor.<init>(ComponentConstructor.java:123)
    at com.sun.jersey.core.spi.component.ProviderFactory.__getComponentProvider(ProviderFactory.java:165)
    at com.sun.jersey.core.spi.component.ProviderFactory.getComponentProvider(ProviderFactory.java:137)
    at com.sun.jersey.core.spi.component.ProviderServices.getComponent(ProviderServices.java:256)
    at com.sun.jersey.core.spi.component.ProviderServices.getServices(ProviderServices.java:160)
    at com.sun.jersey.core.spi.factory.MessageBodyFactory.initReaders(MessageBodyFactory.java:176)
    at com.sun.jersey.core.spi.factory.MessageBodyFactory.init(MessageBodyFactory.java:162)
    at com.sun.jersey.server.impl.application.WebApplicationImpl._initiate(WebApplicationImpl.java:1310)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.access$700(WebApplicationImpl.java:168)
    at com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:774)
    at com.sun.jersey.server.impl.application.WebApplicationImpl$13.f(WebApplicationImpl.java:770)
    at com.sun.jersey.spi.inject.Errors.processWithErrors(Errors.java:193)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:770)
    at com.sun.jersey.server.impl.application.WebApplicationImpl.initiate(WebApplicationImpl.java:765)
    at com.sun.jersey.spi.container.servlet.ServletContainer.initiate(ServletContainer.java:489)
    at com.sun.jersey.spi.container.servlet.ServletContainer$InternalWebComponent.initiate(ServletContainer.java:319)
    at com.sun.jersey.spi.container.servlet.WebComponent.load(WebComponent.java:605)
    at com.sun.jersey.spi.container.servlet.WebComponent.init(WebComponent.java:210)
    at com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:374)
    at com.sun.jersey.spi.container.servlet.ServletContainer.init(ServletContainer.java:557)
    at javax.servlet.GenericServlet.init(GenericServlet.java:212)
    at org.mortbay.jetty.servlet.ServletHolder.initServlet(ServletHolder.java:440)
    at org.mortbay.jetty.servlet.ServletHolder.doStart(ServletHolder.java:263)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:685)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at com.google.tracing.TraceContext$TraceContextRunnable.runInContext(TraceContext.java:454)
    at com.google.tracing.TraceContext$TraceContextRunnable$1.run(TraceContext.java:461)
    at com.google.tracing.TraceContext.runInContext(TraceContext.java:703)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContextNoUnref(TraceContext.java:338)
    at com.google.tracing.TraceContext$AbstractTraceContextCallback.runInInheritedContext(TraceContext.java:330)
    at com.google.tracing.TraceContext$TraceContextRunnable.run(TraceContext.java:458)
    at java.lang.Thread.run(Thread.java:679)
Caused by: java.lang.reflect.InvocationTargetException
    at sun.reflect.GeneratedMethodAccessor9.invoke(Unknown Source)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:616)
    ... 41 more
Caused by: java.lang.NoClassDefFoundError: javax/mail/MessagingException
    at java.lang.Class.getDeclaredMethods0(Native Method)
    at java.lang.Class.privateGetDeclaredMethods(Class.java:2444)
    ... 41 more
Caused by: java.lang.ClassNotFoundException: javax.mail.MessagingException
    at com.google.appengine.runtime.Request.process-7d6711107bb7eaaa(Request.java)
    ... 41 more 
```

此服务不使用或发送任何邮件消息。它只做一件事就是从一些 POJO 写入 JSON 响应。它当然可以在本地工作（在本地 GAE 和本地 Tomcat 上）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T19:06:52.320

这可能是版本的兼容性问题。据此，与 Google App Engine 兼容[**的**](http://code.google.com/p/googleappengine/wiki/WillItPlayInJava)Jersey 版本是 1.5 和 1.1.5。

我有类似的问题，我不喜欢这个版本的兼容性问题，所以我选择了：

*   要从 GAE 提供 REST Web 服务，请使用[**Google Cloud Endpoints**](https://developers.google.com/appengine/docs/java/endpoints/)，这仍然是一项实验性技术，但据我尝试，它运行良好。[**此外，它还与 GAE 和Google Plugin for Eclipse**](https://developers.google.com/eclipse/docs/cloud_endpoints?hl=es)很好地集成在一起。

*   为了使用 GAE 的 REST 服务，我选择仅使用 Java 内置 HTTP 客户端库，如此[**处**](https://developers.google.com/appengine/docs/java/urlfetch/usingjavanet)所述。我不知道这是否是最好的方法，但它非常简单，您可以避免 GAE 和外部 API（如 Jersey）之间可能出现的兼容性问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-05-24T20:09:44.623

我在 GitHub 上创建了一个 GAE REST 框架应用程序。它位于[https://github.com/deege/gae-rest-skeleton](https://github.com/deege/gae-rest-skeleton)

该应用程序只定义了两个 REST 调用，但它会为您提供一个起点。它使用 GAE 1.9.4 和 Jersey 1.17.1。

[您可以从https://github.com/deege/gae-rest-skeleton.git](https://github.com/deege/gae-rest-skeleton.git)分叉代码

# reporting-services - SSRS 2008 中的排序不起作用

> ID：15373576
> 
> 赞同：4
> 
> 时间：2013-03-12T22:33:31.983
> 
> 标签：reporting-services, ssrs-2008

我需要使用带有区域名称的 SSRS 2008 修改现有报告，它可能包含 10 个不同的区域。该区域仅设置一列，其中可能包含 10 个不同的值。我相信这是一个tablix。目前，这些区域在代码中按字母顺序排序，但我必须对它们进行不同的排序，因此我根据所需的顺序在 CASE 语句中为每个区域分配了一个数字。然后，我按列本身 (tablix) 中的所需顺序对区域进行排序，并且区域在报告中按所需顺序排序，但不幸的是，分配的数字在报告中而不是区域名称中。而不是得到

BF CF CO CL 等…… 我在报告的标题中得到 1 2 3 4 等。

```
CASE , 
WHEN teamgroup.Name = 'BF' THEN 1
WHEN teamgroup.Name = 'CF' THEN 2
WHEN teamgroup.Name = 'CO' THEN 3
WHEN teamgroup.Name = 'CL' THEN 4
WHEN teamgroup.Name = 'CN' THEN 5
WHEN teamgroup.Name = 'GA' THEN 6
WHEN teamgroup.Name = 'IN' THEN 7
WHEN teamgroup.Name = 'KY' THEN 8
WHEN teamgroup.Name = 'MD' THEN 9
WHEN teamgroup.Name = 'NF' THEN 10
   END AS Region 
```

我尝试将 teamgroup.name 显示为区域，然后使用 Region_sort 作为 CASE 语句的别名，但它不起作用。在 Tablix 属性中，我使用了排序方式：region_sort，顺序是 A 到 Z，但区域是按字母顺序排序的。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-13T11:35:00.560

您可以按照与显示内容不同的方式对 tablix 进行排序。

1.  您应该按照正常情况设置 tablix，并将区域作为显示值，这是`teamgroup.name`.
2.  根据表格的构成，使用 tablix 上的排序选项通常不起作用。最好和最可靠的方法是在分组属性窗口中右键单击详细信息行并编辑排序方式选项。
3.  在这里您可以编辑排序表达式，我建议您使用一个`switch`函数将名称更改为数字，或者`region_Sort`如果有的话最好使用 SQL 列。
4.  然后将顺序设置为 a 到 z。

如果您的 tablix 中有组，则需要为`teamgroup.name`区域/组而不是详细信息组执行此操作。

# c# - 绕过/忽略 Exchange Server“最大发送大小”？

> ID：15373577
> 
> 赞同：5
> 
> 时间：2013-03-12T22:33:34.700
> 
> 标签：c#, outlook, add-in, exchange-server

**我将尽快开始赏金并奖励 150（这就是我所拥有的）积分来解决问题。**

我正在开发Outlook插件。发送消息时，插件处理消息，删除附件并通过不同的传输通道发送它们，并将附件下载链接放在消息正文中。

当使用带有“最大发送大小”限制的 Exchange 服务器的 Outlook 时，用户甚至无法将大文件附加到邮件中。Outlook 会显示一个警告，该警告会施加交换限制。

更糟糕的是，在触发任何附件事件之前，附件会被拒绝。

我需要一种方法来绕过这种行为。允许用户通过使用 Outlook 回形针按钮或拖放来添加任何大小的附件。或者我可以努力的好方向。

**添加单独的附加按钮不是一种选择。**

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:45:11.687

尝试使用设置`PR_MAX_SUBMIT_MESSAGE_SIZE`MAPI 属性（DASL 名称`http://schemas.microsoft.com/mapi/proptag/0x666D0003`）`Store.PropertyAccessor.SetProperty`。

我可以使用[OutlookSpy](http://www.dimastr.com/outspy/)设置它（单击`IMsgStore`按钮，右键单击，选择`IMAPIProp::GetProps`，键入`PR_MAX_SUBMIT_MESSAGE_SIZE`- 默认情况下不显示该属性），然后双击修改它。我不知道 Outlook 以后是否会在本地缓存存储中覆盖它——我从未尝试设置该属性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:35:59.473

设计使然，您不能这样做。该限制在提交操作发送到的消息存储中强制执行。您可以压缩附件，或将其分成单独的电子邮件，以允许发送非常大的数据。

# assembly - ASM-创建过程

> ID：15373579
> 
> 赞同：-4
> 
> 时间：2013-03-12T22:33:53.397
> 
> 标签：assembly, x86

设置了数组 A 和数组 B。该过程将获得一个值 V 并返回该值是否存在于数组 B 中。如果它确实 - 将索引存储在 P 中，如果没有，则将 -1 存储在 P 中。程序应该从以下数据开始：

```
ARR_B DB 100 DUP()
ARR_A DB 10 DUP ()
V DB ?
P DB ? 
```

这是我们所做的：

```
TEST1 PROC
; Chek if the variable of V  found in ARR_B.
MOV SI,0
MOV DX,0
MOV Flag,0
MOV AL,1H
NEG AL
MOV CX,9H
GO:
    MOV DL,ARR_B[SI]
    CMP  V,DL
    JE X
    INC SI
    LOOP GO
    MOV  P,AL
    JMP END1
X:  MOV DX,SI
    MOV  P,DL
        INC FLAG
END1:   NOP
    RET
TEST1 endp 
```

（以下选项中使用的标志）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:50:09.730

您通常希望使用以下方法进行搜索`rep scasb`：

```
test1 proc
    mov P, 0ffffh ; for now, assume it won't be found
    mov al, V                ; what we're going to look for
    mov di, offset array_b   ; where we're going to look
    mov cx, size array_b     ; how many items to search
    repnz scasb              ; do the search
    jnz done                 ; Z flag clear = not found
    sub di, offset array_b   ; found: compute offset into array_b
    mov P, di                ;        and save it
done:
    ret 
```

# python - 如何实现在更改时自动更新的可变 PickleTypes

> ID：15373583
> 
> 赞同：1
> 
> 时间：2013-03-12T22:34:03.797
> 
> 标签：python, sqlalchemy

SQLAlchemy为任何可变类型（如字典）提供[`PickleType`](http://docs.sqlalchemy.org/en/latest/core/type_basics.html#sqlalchemy.types.PickleType)并提供[突变跟踪。](http://docs.sqlalchemy.org/en/latest/orm/extensions/mutable.html)

SQLAlchemy 文档提到这是实现可变的方法，`PickleType`但它没有准确说明如何继续使用它。

*注意*：我想在`PickleType`.

你如何实现这一点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:34:03.797

虽然文档中提到了一些示例，但在我看来还不够，所以我将在此处添加我的实现，该实现可用于实现一个可变字典，该字典被腌制并存储在数据库中。

使用[`MutableDict`](http://docs.sqlalchemy.org/en/rel_0_8/orm/extensions/mutable.html#establishing-mutability-on-scalar-column-values)文档中的示例：

```
class MutableDict(Mutable, dict):

    @classmethod
    def coerce(cls, key, value):
        if not isinstance(value, MutableDict):
            if isinstance(value, dict):
                return MutableDict(value)
            return Mutable.coerce(key, value)
        else:
            return value

    def __delitem(self, key):
        dict.__delitem__(self, key)
        self.changed()

    def __setitem__(self, key, value):
        dict.__setitem__(self, key, value)
        self.changed()

    def __getstate__(self):
        return dict(self)

    def __setstate__(self, state):
        self.update(self) 
```

现在创建一个要跟踪的列：

```
class MyModel(Base):
    data = Column(MutableDict.as_mutable(PickleType)) 
```

我想看看其他一些可能更高级或可能使用不同数据结构的示例。一个通用的方法`pickle`看起来像什么？有没有（我想没有，或者 SQLAlchemy 会有一个）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-16T09:47:34.670

这是我想出的解决方案。它包装任何类型并检测任何属性集并调用 Mutable.changed()。它还包装函数调用并通过拍摄对象前后的快照并进行比较来检测更改。应该适用于 Pickleable 类型...

```
from sqlalchemy.ext.mutable import Mutable

class MutableTypeWrapper(Mutable):
    top_attributes = ['_underlying_object',
                      '_underlying_type',
                      '_last_state', 
                      '_snapshot_update', 
                      '_snapshot_changed', 
                      '_notify_if_changed',
                      'changed',
                      '__getstate__',
                      '__setstate__',
                      'coerce']

    @classmethod
    def coerce(cls, key, value):
        if not isinstance(value, MutableTypeWrapper):
            try:
                return MutableTypeWrapper(value)
            except:
                return Mutable.coerce(key, value)
        else:
            return value

    def __getstate__(self):
        return self._underlying_object

    def __setstate__(self, state):
        self._underlying_type = type(state)
        self._underlying_object = state

    def __init__(self, underlying_object, underlying_type=None):
        if (underlying_object is None and underlying_type is None):  
            print('Both underlying object and type are none.')
            raise RuntimeError('Unable to create MutableTypeWrapper with no underlying object or type.')

        if (underlying_object is not None):
            self._underlying_object = underlying_object
        else:
            self._underlying_object = underlying_type()

        if (underlying_type is not None):
            self._underlying_type = underlying_type
        else:
            self._underlying_type = type(underlying_object)

    def __getattr__(self, attr):
        if (attr in MutableTypeWrapper.top_attributes):
            return object.__getattribute__(self, attr)

        orig_attr = self._underlying_object.__getattribute__(attr)
        if callable(orig_attr):
            def hooked(*args, **kwargs):
                self._snapshot_update()
                result = orig_attr(*args, **kwargs)
                self._notify_if_changed()
                # prevent underlying from becoming unwrapped
                if result == self._underlying_object:
                    return self
                return result
            return hooked
        else:
            return orig_attr

    def __setattr__(self, attr, value):
        if (attr in MutableTypeWrapper.top_attributes):
            object.__setattr__(self, attr, value)
            return

        self._underlying_object.__setattr__(attr, value)

        self.changed()

    def _snapshot_update(self):
        self._last_state = pickle.dumps(self._underlying_object,
                                        pickle.HIGHEST_PROTOCOL)

    def _snapshot_changed(self):
        return self._last_state != pickle.dumps(self._underlying_object,
                                                pickle.HIGHEST_PROTOCOL)

    def _notify_if_changed(self):
        if (self._snapshot_changed()):
            self.changed() 
```

然后将其与 PickleType 一起使用，如下所示：

```
class TestModel(Base):
    __tablename__ = 'testtable'

    id = Column(Integer, primary_key=True)
    obj = Column(MutableTypeWrapper.as_mutable(PickleType)) 
```

这里的缺点是在每次函数调用之前都会对底层类进行快照，然后在之后比较更改以验证底层对象是否已更改。这将对性能产生重大影响。

确保在修改 PickleType 对象时更新它们的另一种方法是在提交更改之前复制和分配它们。

# android - 为什么 onSensorChanged 不会导致 UI 线程变慢？

> ID：15373584
> 
> 赞同：1
> 
> 时间：2013-03-12T22:34:04.570
> 
> 标签：android

即使`onSensorChanged()`如此频繁地调用，UI 是如何做到如此灵敏的。通常UI线程执行这个方法对吗？执行时不应该阻止其他必要的处理吗？

UI线程`Looper`与此有关吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:08:09.967

> 即使 onSensorChanged() 被如此频繁地调用，UI 是如何做到如此响应的。

因为希望输入的逻辑`onSensorChanged()`非常非常快。如果你在 中做低效的事情`onSensorChanged()`，你的结果就会很差。

> 通常UI线程执行这个方法对吗？

正确的。

> 执行时不应该阻止其他必要的处理吗？

正确的。

> UI线程的Looper跟这个有关系吗？

与其他任何回调方法一样，Android 在主应用程序线程上调用您。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-13T06:40:40.887

抱歉打扰，我在名为“Learn OpenGL ES: For Mobile Game and Graphics Development”的书中看到了不同的答案 -[链接](https://books.google.com.hk/books?id=iaC9AAAAQBAJ&pg=PA58&lpg=PA58&dq=onSensorchanged%20async%20or%20sync&source=bl&ots=QX2WOk1b8I&sig=ACfU3U3N93LSrp6MLbDe9n6otkfo7Ay48A&hl=zh-CN&sa=X&ved=2ahUKEwj_l-T7zMnqAhWu-GEKHf1WCXwQ6AEwAnoECAoQAQ#v=onepage&q&f=false)- 上面写着“在 Android Sensor API 中，回调方法 onSensorChanged 以异步方式请求数据，所以 UI线程在等待一段数据时没有被阻塞”

# asp.net - 代码优先，处理关系，播种

> ID：15373592
> 
> 赞同：1
> 
> 时间：2013-03-12T22:34:29.567
> 
> 标签：asp.net, entity-framework, reference, code-first

我想简单地创建两个已经存在的实体之间的关系..

在我的情况下，我有一个专辑实体，它可能有多个流派（这也是一堆实体）

我的专辑模型如下所示：

```
public class AlbumModel : IModel
{
    public List<GenreModel> Genres { get; set; }
    public ArtistModel Artist { get; set; }
    public Guid Id { get; set; }
    public string Title { get; set; }
    public float Price { get; set; }
    public string ArtUrl { get; set; }
} 
```

然后我想在专辑模型对象和一堆流派模型对象/实体之间创建关系。

在“正常”实体框架中，我只会分配一个新的 EntityKey.. 但我不太确定如何首先使用代码来执行此操作.. 我还注意到有些人为他们想要创建的实体有一个名为 xxxxId 的额外属性之间的引用..然后简单地为 xxxxId 属性分配一个值，该属性有些神奇地创建了实体之间的引用..我猜这对于一对一或一对多的关系很好用..但我猜不适用于多对多关系..或者？

无论如何..这是我的 GenresModel：

```
public class GenreModel : IModel
{
    public Guid Id { get; set; }
    public string Name { get; set; }
    public string Description { get; set; }
    public List<AlbumModel> Albums { get; set; }
} 
```

这就是我之前尝试过的......但这不会创建关系......它只会在我的数据库中创建一个额外的实体/行......

```
var artistRepository = new ArtistRepository();
        var genresRepository = new GenreRepository();

        #region Lordi
        context.Albums.Add
            (
                new AlbumModel
                {
                    Artist = artistRepository.GetByName("Lordi"),
                    ArtUrl = "http://upload.wikimedia.org/wikipedia/en/8/8f/The_Monster_Show.jpg",
                    Genres = new List<GenreModel> { genresRepository.GetByName("Rock"), genresRepository.GetByName("Hard rock") },
                    Id = Guid.NewGuid(),
                    Price = 3,
                    Title = "The Monster Show",
                }
            );
        context.Albums.Add
            (
                new AlbumModel
                {
                    Artist = artistRepository.GetByName("Lordi"),
                    ArtUrl = "http://www.nuclearblast.de/static/articles/157/157892.jpg/1000x1000.jpg",
                    Genres = new List<GenreModel> { genresRepository.GetByName("Rock"), genresRepository.GetByName("Hard rock") },
                    Id = Guid.NewGuid(),
                    Price = 10,
                    Title = "Zombilation - The Greatest Cuts",
                }
            );
        #endregion 
```

...并且为了记录...不，我不听 Lordi :).. 只是虚拟数据.. 由于一些奇怪的怪异原因，Lordi 是第一个想到的乐队..

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:42:42.187

所以基本上你试图在 EF 中建立一个多对多的关系。我假设有一个表可以链接数据库中的专辑和流派？如果是这样，您需要让 EF 了解关系及其存储的表，正如我在[此处](https://stackoverflow.com/questions/15352063/how-can-i-use-sql-many-to-many-table-from-entity-framework/15353298#15353298)解释的那样。通过谷歌搜索“在实体框架中设置多对多”之类的内容，您可以找到很多额外的信息。

在旁注中，您可能还想将您的集合属性更改为 virtual 所以而不是

```
public List<GenreModel> Genres { get; set; } 
```

你将会拥有

```
public virtual ICollection<GenreModel> Genres { get; set; } 
```

这通过允许 EF 对这些属性执行延迟加载来使其更快。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T00:13:32.123

像您所做的那样指定这些集合属性将自动创建一个名为 的多对多链接表`GenreModelAlbumModels`。

但是，我怀疑您的存储库阻止 EF 知道存在关系。如果您没有在同一数据上下文中加载 GenreModel 实体，它可能不知道它们之间存在链接。例如，此代码有效：

```
 using (var context = new DataContext())
    {
        #region Lordi

        context.Albums.Add
            (
                new AlbumModel
                {
                    ArtUrl = "http://upload.wikimedia.org/wikipedia/en/8/8f/The_Monster_Show.jpg",
                    Genres = new List<GenreModel> { context.Genres.First(i => i.Name == "Rock"), context.Genres.First(i => i.Name == "Hard Rock") },
                    Id = Guid.NewGuid(),
                    Price = 3,
                    Title = "The Monster Show",
                }
            );

        context.SaveChanges();

        #endregion
    } 
```

GenreModel 连接到我们将 AlbumModel 添加到的同一上下文，因此 EF 知道实体之间存在关系。

为确保它正常工作，请在数据库中查找该链接表。它将在代码中对您隐藏。

# java - 如何使用 Java 代码中的 Javascript 接口将数据传递给 WebView 中的 Javascript？

> ID：15373595
> 
> 赞同：1
> 
> 时间：2013-03-12T22:35:10.787
> 
> 标签：java, javascript, android, android-webview

我正在尝试使用 Javascript 接口将我的 Android Java 代码中的变量传递给 WebView 中的 Javascript，但警报显示“未定义”。

这是Java的一部分：

```
public class WebAppInterface {
    Context mContext;

    WebAppInterface(Context c) {
        mContext = c;
    }

    @JavascriptInterface
    public int getValue() {
        return 5;
    }
 } 
```

和 Javascript：

```
function getValue() {
    Android.getValue();
}

var value = getValue();
alert(value); 
```

请注意，我的界面称为“Android”。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:43:13.817

尝试将 'return' 关键字添加到您的 getValue 函数中：

```
function getValue() {
  return Android.getValue();
}

alert(getValue()); 
```

# .net - FlipView 永远翻转

> ID：15373597
> 
> 赞同：1
> 
> 时间：2013-03-12T22:35:32.063
> 
> 标签：.net, xaml, windows-8

是否可以`FlipView`在数据源项的末尾继续“翻转”并从索引 0 重新开始？从 -1 到 Items.Count 也一样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T04:06:57.310

我认为它可能不受内置支持 -[`CarouselPanel`](http://msdn.microsoft.com/en-us/library/windows/apps/windows.ui.xaml.controls.primitives.carouselpanel.aspx)如果不是因为文档声明它仅受`ComboBox`.

# node.js - 在 express 中间件中重用 mongoose 对象的模式

> ID：15373599
> 
> 赞同：1
> 
> 时间：2013-03-12T22:35:43.503
> 
> 标签：node.js, express, mongoose

给定一个 nodejs、mongoose、mongodb、expressjs 设置，我们拥有验证特定请求的权限/安全相关路由。例如：

```
permissionUtils.checkStudentWritePermissions = function(req, res, next){
     //load this student from the mongoose db
     //ensure the current user has permission to update this student
}

server.put("/api/student/:studentId/enroll", 
         permissionUtils.checkStudentWritePermissions, function(req, res, next){
     //load student from the database, validate the changes
     //update student in mongodb, send new version back to user 
}); 
```

中间件很有用，因为我们确保当前用户在任何情况下都有权更新学生。（代码重用等）您会注意到，在这两个示例中，我都是从 mongodb 加载学生。是否有一种可接受的模式来避免这种双重加载？某种请求周期缓存或传递模型的巧妙方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:04:37.190

这里有许多不同的解决方案。我会尽快给你一些。

1）首先，将您的代码分开以实际获取（以及您需要的任何预处理）到用户模型中的函数中。其次，如果您没有用户模型，MVC 方法将使您的代码在增长时更容易遵循。从这里，您可以轻松地在第一次调用时缓存响应，并在第二次调用时将其返回，而无需从数据库中重新获取。看看 Memcached 或 Redis 之类的东西。

2）虽然它可能不是惯例，但您可以将对象从中间件传递到您的主函数中。如果您确实选择这样做，请清楚地记录您所做的事情，以便将来的人们了解为什么您的中间件调用 next(req, res, obj)，并且不要通过将其替换为 next() 来“修复”它。

3）第三种方法是将对象保存到 res.locals 中（我相信这就是它现在所说的）。这些是 Express 为当前请求保留的值。将其保存在那里类似于缓存，但是只能在该请求期间访问。在随后的请求中，必须重新获取该对象。

请注意，无论您选择哪种选项，为经常访问的对象实现某种缓存几乎在所有情况下都会加速您的应用程序。

# jquery-ui - Jquery-UI 单选按钮

> ID：15373605
> 
> 赞同：0
> 
> 时间：2013-03-12T22:36:07.180
> 
> 标签：jquery-ui, radio-button, jquery-ui-button

我正在使用两组单选按钮

第一组：

*   状态
*   城市

第 2 组：

*   交流电
*   DH
*   我是
*   NR
*   深圳

当我在州和城市之间切换时，我希望将第 2 组中的 AC 设置为选中，而将其他 AC 设置为未选中。

我让它在这个小提琴中工作在这里[小提琴](http://jsfiddle.net/Fzq8L/)

**HTML：**

```
<div id="sort-radio">
    <input type="radio" id="byState" name="sort-radio" checked="checked"/><label for="byState">By State</label>
    <input type="radio" id="byCity" name="sort-radio"/><label for="byCity">By City</label>
</div>

<div id="alphabet-radio" style="width:300px;">
<input type="radio" id="A-C" name="alphabet-radio" checked="checked"/>
    <label for="A-C">A-C</label>
<input type="radio" id="D-H" name="alphabet-radio"/>
    <label for="D-H">D-H</label>
<input type="radio" id="I-M" name="alphabet-radio"/>
    <label for="I-M">I-M</label>
<input type="radio" id="N-R" name="alphabet-radio"/>
    <label for="N-R">N-R</label>
<input type="radio" id="S-Z" name="alphabet-radio"/>
    <label for="S-Z">S-Z</label>
</div> 
```

**JavaScript：**

```
$(function () {
    $("#sort-radio").buttonset();
});

$(function () {
    $("#alphabet-radio").buttonset().find('label').css('width', '19.4%');
});

document.getElementById("byState").addEventListener("click", function () {
    document.getElementById("A-C").checked = true;
    document.getElementById("D-H").checked = false;
    document.getElementById("I-M").checked = false;
    document.getElementById("N-R").checked = false;
    document.getElementById("S-Z").checked = false;
}, false);

document.getElementById("byCity").addEventListener("click", function () {
    document.getElementById("A-C").checked = true;
    document.getElementById("D-H").checked = false;
    document.getElementById("I-M").checked = false;
    document.getElementById("N-R").checked = false;
    document.getElementById("S-Z").checked = false;
}, false); 
```

但是，当我在我的网站中使用这个确切的代码时，它不起作用（它使之前选择的第 2 组中的按钮处于选中状态）。我正在使用 jquery-ui-1.10.1.custom.css 很好地显示单选按钮，如下所示：[jquery ui button](http://jqueryui.com/button/#radio)。

任何线索为什么这会影响它？当我`<link rel="stylesheet" href="jquery-ui-1.10.1.custom.css" />`从 index.php 中删除该行时，它运行良好。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:05:49.327

几个问题：

1.  该`button`小部件通过响应单选按钮标签上的单击事件来工作。这意味着`click`您在单选按钮本身上收听的事件不会被触发，因为您实际上不是单击单选按钮本身，而是单击它们`label`的 s。`change`您可以通过使用事件来解决此问题。

2.  您需要`.buttonset('refresh')`在手动更新单选按钮的选中状态后调用。

3.  只需在组中的一个单选按钮上设置`checked`属性就足以使其余的自动取消选中。您不需要为`checked`每个设置属性。

4.  您也应该将事件处理程序放在`document.ready`处理程序中。您也可以只使用一个而不是两个。

考虑到所有这些事情，以下是我要做的更改：

```
$(function () {
    $("#sort-radio").buttonset();
    $("#alphabet-radio").buttonset().find('label').css('width', '19.4%');

    document.getElementById("byState").addEventListener("change", function () {
        document.getElementById("A-C").checked = true;
        $("#alphabet-radio").buttonset("refresh");
    }, false);

    document.getElementById("byCity").addEventListener("change", function () {
        document.getElementById("A-C").checked = true;
        $("#alphabet-radio").buttonset("refresh");
    }, false);
}); 
```

**示例：http:** [//jsfiddle.net/Fzq8L/2/](http://jsfiddle.net/Fzq8L/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:37:53.180

由于您使用的是 jQuery，因此您可以通过向单选按钮添加一个类来大大简化这一点——其中只有一个可以“设置”，所以听那些上的更改事件。在开始时删除额外的功能，从第二组中选择要单击的“阵列”按钮之一。（因为只能选择一个）

更简单的版本标记：

```
<div id="sort-radio">
    <input type="radio" class="picker" id="byState" name="sort-radio" checked='true'
    />
    <label for="byState">By State</label>
    <input type="radio" class="picker" id="byCity" name="sort-radio"
    />
    <label for="byCity">By City</label>
</div>
<div id="alphabet-radio" style="width:300px;">
    <input type="radio" class="secondgroup" id="A-C" name="alphabet-radio"
    checked='true' />
    <label for="A-C">A-C</label>
    <input type="radio" class="secondgroup" id="D-H" name="alphabet-radio"
    />
    <label for="D-H">D-H</label>
    <input type="radio" class="secondgroup" id="I-M" name="alphabet-radio"
    />
    <label for="I-M">I-M</label>
    <input type="radio" class="secondgroup" id="N-R" name="alphabet-radio"
    />
    <label for="N-R">N-R</label>
    <input type="radio" class="secondgroup" id="S-Z" name="alphabet-radio"
    />
    <label for="S-Z">S-Z</label>
</div> 
```

代码：

```
$(document).ready(function () {
    $("#sort-radio").buttonset();
    $("#alphabet-radio").buttonset().find('label').css('width', '19.4%');
});
$(".picker").change(function () {
    $('.secondgroup').eq($('.picker').index(this)).prop("checked", true);
    $('#alphabet-radio').buttonset('refresh');
}); 
```

工作示例：http: [//jsfiddle.net/MarkSchultheiss/8x28x/2/](http://jsfiddle.net/MarkSchultheiss/8x28x/2/)

当第一组中的任何一个被更改时，将第二组设置回第一个到项目：

```
$(document).ready(function () {
    $("#sort-radio").buttonset();
    $("#alphabet-radio").buttonset().find('label').css('width', '19.4%');
});
$(".picker").change(function () {
    $('.secondgroup').eq(0).prop("checked", true);
    $("#alphabet-radio").buttonset("refresh");
}); 
```

小提琴：http: [//jsfiddle.net/MarkSchultheiss/8x28x/3/](http://jsfiddle.net/MarkSchultheiss/8x28x/3/)

# wpf - 使用绑定更新 WPF 标签

> ID：15373608
> 
> 赞同：0
> 
> 时间：2013-03-12T22:36:11.827
> 
> 标签：wpf

在我的 wpf 应用程序中，每当我的 ViewModel 中的某个变量发生变化时，我都会尝试更新标签。你知道为什么标签不会更新吗？

这是我目前所拥有的：

xml

```
<Label Name="myLabel" Content="{Binding myState}" /> 
```

我的视图模型.cs

在构造函数中：

```
_MyObject.myEvent += myNewEvent; 
```

然后...

```
private void myNewEvent(object sender, myArgs e)
{
    myState = someStringVariable;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:41:05.140

`DataContext`很可能，您需要将包含此标签的元素的set 设置为我假设`_MyObject`代表的类型的实例。如果您已经这样做了，它应该在您更改属性值时更新。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:42:09.457

我的猜测是您的 ViewModel 没有实现 INotifyPropertyChanged。
如果您希望 UI 反映 ViewModel 中属性的更改，则 Viewmodel 必须在属性的设置器中实现`INotifyPropertyChanged` *并*`PropertyChanged`在值更改时引发事件。

有关详细信息： **[如何：实现 INotifyPropertyChanged 接口](http://msdn.microsoft.com/en-us/library/ms229614.aspx)**

# image - 指南针和 http_images_path

> ID：15373614
> 
> 赞同：0
> 
> 时间：2013-03-12T22:36:35.227
> 
> 标签：image, http, path, compass-geolocation

我在指南针 0.12.2 上...我正在尝试使用 config.rb 中的配置参考 http_images_path 但它看起来不像使用此参考...它仍然将图像解析为我的本地目录...我错过了什么吗？

谢谢你的帮助！！

**配置文件**

```
http_path = "/"
# Get the directory that this configuration file exists in
dir = File.dirname(__FILE__)
# Compass configurations
sass_path = dir
css_path = File.join(dir, "..", "css")
#images_dir = "../resources/images"
http_images_path = "http://myurl/img/"
output_style = :expanded
environment = :development 
```

**css 文件：**

```
@import "compass";

.dir
{
  background: image-url("guide.jpg");
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:45:21.817

如果您正在使用指南针手表...您需要重新启动才能使更新的 config.rb 生效。

# php - 爆炸， 从 sql 内容 我的模板中有一行需要帮助修复。 如果用户将开始标签或结束标签或任何其他与结构相关的 HTML 标签发布到内容中，则会导致页面上的模板混乱。 我htmlentities在标题和其他形式上使用。不幸的是，我不能在这里这样做，因为内容字段有一个丰富的编辑器，我需要保持文本样式标签完整（ 问问题 问问题 2013-03-12T22:36:40.103 143 次 This question shows research effort; it is useful and clear 0 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. 我的模板中有一行需要帮助修复。 如果用户将开始标签或结束标签或任何其他与结构相关的 HTML 标签发布到内容中，则会导致页面上的模板混乱。 我htmlentities在标题和其他形式上使用。不幸的是，我不能在这里这样做，因为内容字段有一个丰富的编辑器，我需要保持文本样式标签完整（**、、颜色*等）。 现在，用户很容易故意弄乱模板，我想防止这种情况发生。 我的建议是：不要，并考虑在 checkstyle 中至少为那些构造函数禁用该规则。每个人都知道他们在做什么，或者可以很容易地查到这一点。努力提供真正有用的文档。 phpmysqlechoexplode 4 2 回答 2 This answer is useful 3 最好的方法是将文本扔 到 DOM 解析器中并让它解决所有的混乱。这样的工具可能比您可以组合的任何东西都更强大，包括解决您不知道自己可能遇到的问题。 于 2013-03-12T22:40:09.747 回答 This answer is useful 1 既然您已经在评论中澄清了实际问题是什么，我也许可以提供帮助。问题基本上是您不希望用户输入的长词破坏页面布局。 您提出的 PHPwordwrap解决方案已经存在许多问题，其中您发现的问题（破坏您的 HTML）是最明显的。 但是，由于这个问题纯粹是不想让长词破坏您的页面布局，因此可以使用其他几种解决方案。 对任何过长的单词做一些特定的事情，而不是对整个文本。您可以为它们添加手动换行符、空格或 HTML<wbr>标记（这是一个可选的换行符，即用于连字符的目的）。或者，您甚至可以一开始就阻止用户输入疯狂的长词。 CSSoverflow-x:hidden 使用它，任何溢出框边的文本都将被隐藏，而不是打印在页面其他部分的顶部。 CSSword-wrap 有几种方法可以做到这一点，但由于浏览器支持的不同，它变得有点棘手。但这里有一个链接可以解释这一切：http ://blog.kenneth.io/blog/2012/03/04/word-wrapping-hypernation-using-css/ 希望有帮助。 于 2013-03-12T23:00:01.247 回答 Related 3 javascript - 在 try-catch 块内的 HTML 文件中导入 JavaScript 文件 3 c# - c# 处理语法 1 php - 用脸书注册和登录 1 mysql - Cakephp 2.0 mysql查询 1 javascript - 直到下一个服务器请求才提供新的会话 cookie 10 css - Font Awesome 字体在 IE8 上显示为框 2 magento - Magento 为产品添加运输自定义选项 1 c++ - std::wostream_iterator 1 c - MPI_Scatter() 错误 2 permissions - 图片上传网站的正确文件权限是什么？ Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641***

 ***> ID：15373615
> 
> 赞同：0
> 
> 时间：
> 
> 标签：php, mysql, echo, explode

我的模板中有一行需要帮助修复。

如果用户将开始`<div>`标签或结束标签`</div>`或任何其他与结构相关的 HTML 标签发布到内容中，则会导致页面上的模板混乱。

我`htmlentities`在标题和其他形式上使用。不幸的是，我不能在这里这样做，因为内容字段有一个丰富的编辑器，我需要保持文本样式标签完整（`<b>`、`<u>`、颜色`<i>`等）。

现在，用户很容易故意弄乱模板，我想防止这种情况发生。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:40:09.747

最好的方法是将文本扔​​到 DOM 解析器中并让它解决所有的混乱。这样的工具可能比您可以组合的任何东西都更强大，包括解决您不知道自己可能遇到的问题。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:00:01.247

既然您已经在评论中澄清了实际问题是什么，我也许可以提供帮助。问题基本上是您不希望用户输入的长词破坏页面布局。

您提出的 PHP`wordwrap`解决方案已经存在许多问题，其中您发现的问题（破坏您的 HTML）是最明显的。

但是，由于这个问题纯粹是不想让长词破坏您的页面布局，因此可以使用其他几种解决方案。

1.  对任何过长的单词做一些特定的事情，而不是对整个文本。您可以为它们添加手动换行符、空格或 HTML`<wbr>`标记（这是一个可选的换行符，即用于连字符的目的）。或者，您甚至可以一开始就阻止用户输入疯狂的长词。

2.  CSS`overflow-x:hidden`
    使用它，任何溢出框边的文本都将被隐藏，而不是打印在页面其他部分的顶部。

3.  CSS`word-wrap`
    有几种方法可以做到这一点，但由于浏览器支持的不同，它变得有点棘手。但这里有一个链接可以解释这一切：[http ://blog.kenneth.io/blog/2012/03/04/word-wrapping-hypernation-using-css/](http://blog.kenneth.io/blog/2012/03/04/word-wrapping-hypernation-using-css/)

希望有帮助。***

# javascript - JavaScript: 函数 myFunction(**这是什么**);

> ID：15373622
> 
> 赞同：1
> 
> 时间：2013-03-12T22:37:12.280
> 
> 标签：javascript, html, function

使用 javascript 时，如果您在函数的括号中添加一些内容，例如：

```
<button onclick="myFunction('Hello')">Click Here!</button> 
```

在 JS 中：

```
function myFunction(i); 
```

`var i = "Hello"`它是在运行时立即定义，还是其他？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:38:35.483

> 它是在运行后立即定义 var i = "Hello" 还是其他？

当调用发生时，该*值* 被传递给函数，该函数使用被调用的*参数*`"Hello"`接收它。所以在函数代码中，引用给你的值。*`i``i``"Hello"`*

 *在您的示例中，当用户单击按钮时会发生调用，因为该单击会触发`onclick`您定义的属性中的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:44:21.100

从文档

> 每个执行上下文都有一个关联的变量环境。在执行上下文中评估的 ECMAScript 代码中声明的变量和函数作为绑定添加到该变量环境的环境记录中。对于功能代码，参数也作为绑定到该环境记录添加。

有关完整文档，请参阅[http://ecma-international.org/ecma-262/5.1/#sec-10.5](http://ecma-international.org/ecma-262/5.1/#sec-10.5)。

所以是的，它等同于绑定`var i = "hello";`，因为它们将对应于执行上下文的 VariableEnviroment 中的相同条目。

您可以通过执行以下操作看到这一点：

```
function hello(i) {
  var i ="no hello"; 
  console.log(arguments[0]);
}

hello("hi")

>>"no hello" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T23:08:39.353

使用您的代码：

```
<button onclick="myFunction('Hello')">Click Here!</button>

function myFunction(i) {
    alert(i); // display the i value on this case «Hello» 
} 
```

«i» 是您的函数的参数/参数

现在，如果您将 hello 更改为 bye，则 i 值将仅在您的函数上为 «bye»

```
<button onclick="myFunction('Bye')">Click Here!</button>

function myFunction(i) {
    alert(i); // display «Bye» 
}
alert(i); // outside the function i is undefined ;) 
```*

# mongodb - 使用 JAVA 更新 mongoDB 中的文档

> ID：15373624
> 
> 赞同：2
> 
> 时间：2013-03-12T22:37:29.770
> 
> 标签：mongodb, mongodb-java

我刚刚开始使用 JAVA 学习 mongoDB。我在 mongo 中有以下文件

```
{
"_id": {
    "$oid": "513fa587c5d0cf174eb9b1f8"
},
"suitename": "test_suite_name",
"testname": "test_name]",
"milestones": [
    {
        "milestone_id": 45
    }
]
} 
```

我在套件名称、测试名称和里程碑 ID 上有一个复合键。我必须处理一个包含这三个字段的文件。我创建了一个简单的 DBObject 查询并检查 count != 0

```
BasicDBObject query = new BasicDBObject();
query.put("suitename", testsuite);
query.put("testname", testcase);
query.put("milestones.milestone_id", SampleProgram.milestone_id); 
```

如果 count == 0 -> 在 mongo 中添加文档 -> 这似乎工作正常

我想弄清楚的是：如果我的文件中有一个新的里程碑 ID 值，我只需要向某个现有文档的里程碑数组添加一个里程碑。现有文档是根据套件名称和测试名称确定的。

所以如果milestone_id = 10，文档应该看起来像

```
{
"_id": {
    "$oid": "513fa587c5d0cf174eb9b1f8"
},
"suitename": "test_suite_name",
"testname": "test_name]",
"milestones": [
    {
        "milestone_id": 45
    },
    {
        "milestone_id": 10
    }

]
} 
```

我怎样才能做到这一点？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T22:47:27.230

这可以通过将值附加到数组的[$push运算符和](http://docs.mongodb.org/manual/reference/operator/push/)[update(...)](http://api.mongodb.org/java/current/com/mongodb/DBCollection.html#update%28com.mongodb.DBObject,%20com.mongodb.DBObject%29)方法来完成。

```
BasicDBObject query = new BasicDBObject();
query.put("suitename", testsuite);
query.put("testname", testcase);

BasicDBObject push = new BasicDBObject();
push.put("$push",
  new BasicDBObject("milestones",
    new BasicDBObject("milestone_id", SampleProgram.milestone_id)));

yourCollection.update(query, push); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-13T04:14:29.830

```
BasicDBObject newDocument = new BasicDBObject();
newDocument.append("$set", new BasicDBObject().append("clients", 110));

BasicDBObject searchQuery = new BasicDBObject().append("hosting", "hostB");

collection.update(searchQuery, newDocument); 
```

# php - Wordpress 坏了，无法访问管理员，试图更改主题

> ID：15373626
> 
> 赞同：0
> 
> 时间：2013-03-12T22:37:39.430
> 
> 标签：php, wordpress

好吧，我这里有个大问题。我正在尝试升级到 wp 3.5.1，但它无法正常工作。所以其中一个建议是切换到默认主题。我做了，但没有奏效。现在我已经切换回我们使用的 genesis 主题，我得到了这个：

```
Warning: require_once(/example/wp-content/themes/child/lib/init.php) [function.require-once]: failed to open stream: No such file or directory in /example/wp-content/themes/child/functions.php on line 16

Fatal error: require_once() [function.require]: Failed opening required '/example/wp-content/themes/child/lib/init.php' (include_path='.:/example/lib/php') in /example/wp-content/themes/child/functions.php on line 16 
```

我尝试恢复到昨天的备份，但仍然损坏。谁能在这里指出我正确的方向？我不太了解这种创世主题/儿童关系，坦率地说，我不知道这里发生了什么。

幸运的是，我备份了所有内容，但在尝试主题切换后，我似乎无法让所有内容再次正常工作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T01:21:49.760

将 wp_options 值“stylesheet”从“child”更改为“genesis”解决了我的问题。因此，当恢复到 Genesis 主题时，该更改一定没有正确执行，或者至少数据库没有按照我们特定安装所需的方式进行更新。

# facebook - 区分 Facebook App 和 Web App 的 Google Analytics 跟踪

> ID：15373627
> 
> 赞同：0
> 
> 时间：2013-03-12T22:37:41.317
> 
> 标签：facebook, google-analytics

我在 www.mydomain.com/webapp 有一个网络应用程序，它使用 Google Analytics 设置。我在apps.facebook.com/webapp 上创建了一个facebook 应用程序，并在上面的url 中创建了iframe。

有没有办法区分 facebook 上用户的活动和 mydomain 上的用户？

感谢您给我的任何帮助和指导。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:48:19.060

您可以使用 JavaScript 来确定您的页面是否显示在 iframe 中——但如果其他网站可能嵌入了您的页面，情况也是如此。

更好的方法是检查`[signed_request][1]`在初始加载到 iframe 时发布到您的应用程序的参数。（如果您对某人“伪造”它感到偏执，您还可以*验证*signed_request。）

一旦你*发现*你的页面实际上是在 Facebook 中加载的，就应该很容易执行适当的 JS 代码来将该信息发送到 Analytics。

# jquery-mobile - 如果屏幕比某个尺寸短，jQuery 移动应用程序总是滚动

> ID：15373631
> 
> 赞同：1
> 
> 时间：2013-03-12T22:37:58.483
> 
> 标签：jquery-mobile

我屏幕上的内容绝对能够适应给定的屏幕尺寸，但如果屏幕短于某个高度，应用程序仍会显示滚动条。

如果将窗格缩小到一定高度，这个[小提琴就会显示问题。](http://jsfiddle.net/KXvHG/1)`result`

**我试过的：**

在正文中添加 `overflow-y:hidden' 可以解决此问题，但我希望能够在需要时沿 y 方向滚动，而不是在不需要时滚动。

不必要时如何停止滚动？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:53:01.327

原因最终是因为 jQueryMobile.css 中的一条规则：

```
.ui-page, bla, bla{
    min-height: 420px;
} 
```

将其更改为与我需要的匹配的较小数字可以解决此问题。

# javascript - 展开/折叠文本

> ID：15373633
> 
> 赞同：0
> 
> 时间：2013-03-12T22:38:04.860
> 
> 标签：javascript, jquery, html

下面的代码适用于 ONE Reveal/Hide Text 过程

```
<div class="reveal">Click Here to READ MORE...</div>
<div style="display:none;">

<div class="collapse" style="display:none;">Collapse Text</div> 
```

但是，如果此代码重复多次，则折叠文本会显示并且不会消失，实际上与展开冲突以显示更多文本而不是应有的折叠。

在此[http://jsfiddle.net/syEM3/4/](http://jsfiddle.net/syEM3/4/) 中单击任何单击此处以阅读更多内容...注意折叠文本如何显示在段落的底部并且不会消失。单击折叠，它会显示更多文本。

我如何防止这种情况并开始工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:48:45.287

在你的代码中

```
 $('.reveal').click(function() {
    $(this).slideUp(100);
    $(this).next().slideToggle();
    $(".collapse").slideDown(100);
 });
 $('.collapse').click(function() {
    $(this).slideUp(100);
    $(this).prev().slideToggle();
     $(".reveal").slideDown(100);
 }); 
```

这两行不符合您的要求，因为它们作用于指定类的所有元素

```
 $(".reveal").slideDown(100);
    $(".collapse").slideDown(100); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:49:27.613

两个 slideDown 函数调用并不特定于您当前正在执行的 .reveal 和/或 .collapse 。IE

```
$(".collapse").slideDown(100); 
```

将在页面上找到所有具有 .collapse 类的元素，并将它们向下滑动。无论您刚刚单击了什么元素。

我会将 slideDown 调用更改为与您刚刚单击的元素相关，即类似这样的元素

```
$('.reveal').click(function() {
    $(this).slideUp(100);
    $(this).next().slideToggle();
    $(this).next().next(".collapse").slideToggle(100);
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T22:59:13.167

当你这样做时`$(".collapse").slideDown(100);`，jQuery 会在所有带有 .collapse 类的东西上运行 slideDown，而不仅仅是与你当前的 this 相关的那个。要解决此问题，请参阅基于其位置的折叠到`$(this)`。

这样做，使用类似的东西`$(this).siblings(".collapse").slideDown(100);`

请注意，仅当您将每个文本块包含在其自己的 div 中时，此特定选择器才会起作用。每个文本元素都在自己的 div 中，就像您现在拥有的那样`.siblings(".collapse")`，选择该类的所有兄弟姐妹的`$(this)`，`collapse`仍然会选择这两个`collapse`元素。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-20T10:16:50.040

好的，我认为您应该对您的问题采取不同的方法。

看，jQuery 基本上有两个目的：

*   从 HTML 页面中选择一个或多个 DOM 元素
*   以某种方式操作选定的元素

这可以重复多次，因为 jQuery 函数是可链接的（这意味着您可以在函数之后调用函数……）。

* * *

如果我正确理解了您的问题，那么您正在尝试构建博客文章列表并仅显示它们的预告片。
用户点击“阅读更多”按钮后，整篇文章被展开。

请记住：jQuery 选择元素的方式与 CSS 非常相似。这使得查询某些元素变得非常容易，但是您需要以良好的方式构建 HTML，就像出于格式化原因所做的那样。

所以我建议你应该为你的每篇文章使用这个基本标记（注意，HTML5 在工作！）：

```
<article class="article">
    <section class="teaser">
        Hey, I am a incredible teaser text! I just introduce you to the article.
    </section>
    <section class="full">
        I am the articles body text. You should not see me initially.
    </section>
</article> 
```

如果您愿意，可以用元素替换`article`and`section`元素。`div`

这是此标记的 CSS：

```
/* In case you want to display multiple articles underneath, separate them a bit */
.article{
    margin-bottom: 50px;
}

/* we want the teaser to stand out a bit, so we format it bold */
.teaser{
    font-weight: bold;
}

/* The article body should be a bit separated from the teaser */
.full{
    padding-top: 10px;
}

/* This class is used to hide elements */
.hidden{
    display: none;
} 
```

我们创建标记和 CSS 的方式允许我们在下面放置多篇文章。

好的，您可能已经注意到：我完全省略了任何“阅读更多”或“折叠”按钮。这是有意为之。

如果有人在禁用 javascript 的情况下访问博客站点（可能是搜索引擎，或者不支持 JS 的旧手机或其他任何东西），逻辑就会被破坏。此外，许多文本片段，如“阅读更多”和“折叠”，如果它们实际上没有做任何事情并且不是文章的一部分，则它们是不相关的。

最初，没有隐藏文章正文，因为我们没有在`hidden`任何地方应用 css 类。如果我们将它嵌入到 HTML 中，而某人真的没有 JavaScript，他将无法阅读任何内容。

## 添加一些 jQuery 魔法

在页面底部，我们嵌入了来自 google CDN 的 jQuery 库。

```
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> 
```

这是一种最佳做法，通常会加快您的页面加载时间。由于许多网站都通过此 URL 嵌入 jQuery，因此很有可能它已经在访问者浏览器缓存中，并且不必再次下载。

请注意，`http:`URL 开头的 被省略了。这会导致浏览器使用页面当前协议，可能是`http`或`https`. 如果您尝试通过`http`协议在`https`网站上嵌入 jQuery 库，某些浏览器会拒绝从不安全的连接下载文件。

在页面中包含 jQuery 之后，我们将把我们的逻辑添加到脚本标签中。通常我们会将逻辑保存到一个单独的文件中（再次缓存，而不是全部），但这次脚本块就可以了。

### 最后是一些 JavaScript

首先，我们想用 css-class 隐藏所有元素`full`，因为只有预告片应该保持显示。使用 jQuery 这很容易：

```
$('.full').hide(); 
```

脚本的开头`$('.full')`告诉 jQuery：我需要所有带有 CSS-class 的元素`full`。然后我们对该结果调用一个函数，命名`hide()`应该明确哪个目的。

好的，在下一步中，我们要在每个预告片旁边添加一些“阅读更多”按钮。这也是一项简单的任务：

```
$('.teaser').after('<button class="more">Read more</button>'); 
```

我们现在选择每个带有 css-class 的元素，`teaser`并为每个元素附加一些 HTML 代码`after()`- 一个带有 css-class 的按钮`more`。

在下一步中，我们告诉 jQuery 观察每个新创建的按钮的点击。当用户单击时，我们希望`full`在单击的按钮之后使用 css-class 展开下一个元素。

```
$('.more').on('click', function(){
    //"this" is a reference to the button element!
    $(this).slideUp().next('.full').slideDown();
}); 
```

呸，我们在这里做了什么？首先，我们告诉 jQuery 我们想要操作`this`，它是对单击按钮的引用。然后我们告诉 jQuery 慢慢隐藏那个按钮（因为它不再需要了）`slideUp()`。

我们立即继续告诉 jQuery 做什么：现在获取`next()`元素（使用 css-class `full`）并通过使用 向下滑动它使其可见`slideDown()`。

这就是 jQuerys 链接的力量！

### 再次隐藏

但是等等，你希望能够再次折叠文章！所以我们还需要一个“折叠”按钮和一些 JavaScript：

```
$('.full').append('<button class="collapse">Collapse text</button>'); 
```

注意：我们没有使用`after()`添加此按钮的`append()`功能，而是使用将按钮放置在具有 css-class 的每个元素中的功能`full`，而不是在它旁边。这是因为我们希望折叠按钮也与全文一起隐藏。

现在，当用户单击其中一个按钮时，我们也需要执行一些操作：

```
$('.collapse').on('click', function(){
    $(this).parent().slideUp().prev('.more').slideDown();
}); 
```

现在，这很简单：我们从 button 元素开始，将焦点移到它的`parent()`（包含全文的元素）并告诉 jQuery 通过向上滑动它来隐藏该元素`slideUp()`。

然后我们使用 css-class 将焦点从全文容器移到它的前一个元素`more`，这是它的展开按钮，在展开文本时已经隐藏。我们通过调用 慢慢地再次显示该按钮`slideDown()`。

就是这样 :)
我已经在[jsBin](http://jsbin.com/ilazut/1)上上传了我的示例。

# c# - 如何避免 .NET MVC 中的通用 DTO 对象，是否有 ExpandoObject 解决方案？

> ID：15373635
> 
> 赞同：1
> 
> 时间：2013-03-12T22:38:07.557
> 
> 标签：c#, asp.net-mvc, oop

我正在使用 GenericDTO 对象在我的方法之间传递信息。通常它包括一个真/假值、一个错误列表（如果有的话），也许还有其他一些杂项。

GenericDTO 对象具有一些通用属性，例如`"string1","string2","boolean1","boolean2"`.

**这并不理想。** *（但我不想要数百万种 DTO 类型，只是为了在方法之间传递）。*

有什么更好的方法来做到这一点？我想传回一个对象。有没有办法使用动态 ASP.NET MVC 对象（如 ViewBag ）将它们用作 DTO 对象？当然，没有编译时检查......但最好避免通用对象场景。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:41:28.997

一个常见的模式是拥有一个带有从字符串到对象的字典的对象。字典充当任何东西的包，将列映射到值。由于字典可以使用 DataContractSerializer 很好地序列化，因此这是 dto 的合理替代方案。

但是，我担心您的“方法之间传递信息”，因为这不是 DTO 的用途。

# sql - SQL group by 子句错误子查询返回超过 1 个值。当子查询跟在 =、!=、

> ID：15373646
> 
> 赞同：1
> 
> 时间：2013-03-12T22:38:36.053
> 
> 标签：sql, sql-server-2008, group-by

我有查询，它按组计算活跃客户，并且必须按组计算皮卡。

```
SELECT  [Category] = ISNULL(c.Category, 'Total'),
        COUNT (hs.ClientID) as '3 Mo Clients',
        (COUNT (hs.ClientID))/3 as MoAVG
      ,(select COUNT(PickupID)from Pickup where PickupDate between '2013-01-01' and '2013-03-30' group by CategCode) as '3 Mo Picups'

FROM    Category c 
        LEFT JOIN history hs
            ON hs.CategCode = c.CategCode 
            where ReccordDate between '2013-01-01' and '2013-03-30'
GROUP BY Category
WITH ROLLUP 
```

此查询引发错误：`Subquery returned more than 1 value. This is not permitted when the subquery follows =, !=, <, <= , >, >= or when the subquery is used as an expression.`

如果我没有在 4 行中使用 group by，它可以工作，但没有按组划分拾音器。这是示例在代码的 4 行中没有 group by 子句的情况下它是如何工作的
![任何想法如何解决它？](../Images/112464b55fe5cc56e350b53ca18a53d7.png)

任何想法如何解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:49:29.280

尝试添加这个条件：CategCode = c.CategCode

```
SELECT [Category] = ISNULL(c.Category, 'Total'),
       COUNT (hs.ClientID) as [3 Mo Clients],
       (COUNT (hs.ClientID))/3 as MoAVG
      ,(SELECT COUNT(PickupID) 
        FROM Pickup 
        WHERE PickupDate between '2013-01-01' and '2013-03-30'
          AND  CategCode = c.CategCode
       ) AS [3 Mo Picups]
FROM Category c LEFT JOIN history hs ON hs.CategCode = c.CategCode 
WHERE ReccordDate between '2013-01-01' and '2013-03-30'
GROUP BY c.CategCode, c.Category 
WITH ROLLUP 
```

或者

```
SELECT [Category] = ISNULL(c.Category, 'Total'),
       COUNT (hs.ClientID) as [3 Mo Clients],
       (COUNT (hs.ClientID))/3 as MoAVG,
       SUM(o.cnt) AS [3 Mo Picups]
FROM Category c LEFT JOIN history hs ON hs.CategCode = c.CategCode
                CROSS APPLY (
                             SELECT COUNT(PickupID) AS cnt
                             FROM Pickup 
                             WHERE PickupDate between '2013-01-01' and '2013-03-30'
                               AND  CategCode = c.CategCode
                             ) o
WHERE ReccordDate between '2013-01-01' and '2013-03-30'
GROUP BY c.Category 
WITH ROLLUP 
```

# php - php html选择框，插入变量day/days

> ID：15373653
> 
> 赞同：1
> 
> 时间：2013-03-12T22:39:11.863
> 
> 标签：php, html, variables, select

我有以下代码从数据库中获取选项，但现在它显示为：1 - eur 17.50。我想在本文中添加单词 day（表示 1 天）或 days（如果值大于 1），以便显示为：1 天 - 17.50 欧元或 6 天 - 80 欧元。如何实现这一点?

```
<form method="post" action="framemaat.php?lang=<?=$_SESSION['lang'];?>&naam=<?=$naam;?>&postcodehuisnummer=<?=$postcodehuisnummer;?>&fietskeuze=<?=$fietskeuze;?>&opties=<?=$opties;?>&optieid=<?=$optieid;?>">
        <h2><?=$lang['pagina3_dagen']?> <select id="dagen" name="dagen" style="width:75;" style="height:250px;">
            <?php
            $query="SELECT * FROM $tabel WHERE fietstype='$fietskeuze'";
            $result=mysql_query($query) or die ("Ophalen prijzen mislukt: ".mysql_error());

            while ($row=mysql_fetch_array($result)) {
            $dagen=$row[dagen];
            $prijs=$row[prijs];
                echo "<option>
                    $dagen - EUR: $prijs    
                </option>";
            }  
            ?> 
        </select>

        <input type="submit" name="Submit" value="Volgende">
</form> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:47:48.650

应该很简单。

```
 <?php
            $query="SELECT * FROM $tabel WHERE fietstype='$fietskeuze'";
            $result=mysql_query($query) or die ("Ophalen prijzen mislukt: ".mysql_error());

            while ($row=mysql_fetch_array($result)) {
            $dagen=$row[dagen];
            if($dagen>1){
               $dayString = " days";
               }else{
               $dayString = " day";
               }
            $prijs=$row[prijs];
                echo "<option>
                    $dagen $dayString - EUR: $prijs    
                </option>";
            }  
            ?> 
```

# ms-access - 如何通过 VBA 设置访问选项卡控件的页面名称

> ID：15373667
> 
> 赞同：2
> 
> 时间：2013-03-12T22:40:09.840
> 
> 标签：ms-access, vba

我在 MS Access 中有一个带有选项卡控件（称为`TabCtrl`）的表单。这个控件有几个页面，每个页面都有一个子窗体。

在 上`Form_Open`，我想查询子表单的记录总数并将该数字放在选项卡的名称中。例如，名为*MyTab*的选项卡应变为*MyTab (2)*：

```
Private Sub SetTabName_MyTab()
    Dim i As Integer
    i = CurrentDb.OpenRecordset("Select count(*) from [MyQry];").Fields(0).Value
    TabCtrl.Pages("MyTab").Name = "MyTab (" & i & ")"
End Sub 
```

但是，当我运行它时，最后一行返回**Run-time error 2136 "To set this property, open the form or report in Design view"**。这是否意味着我不能在代码中执行此操作？我应该使用另一个事件吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-30T00:13:52.313

您正在尝试更改`internal`控件的名称，而不是`caption`选项卡页上的控件。

尝试：

```
ATabcontrol.Pages("MyTab").Caption = "MyTab(" & i & ")" 
```

> 注意：我之前已经这样做过，发现在操作 tabcontrol 之前文本不会改变的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-27T21:50:04.920

尝试：

```
Dim s as string

'To Get current Tab Caption
s = Me.TabCtl.Pages(Me.TabCtl.Value).Caption

'To Set current Tab Caption
s = "TabName"

Me.TabCtl.Pages(Me.TabCtl.Value).Caption = s 
```

# ruby-on-rails - 将昂贵的查询放在后台线程上有助于站点性能吗？

> ID：15373668
> 
> 赞同：1
> 
> 时间：2013-03-12T22:40:16.643
> 
> 标签：ruby-on-rails, postgresql, heroku, memcached

我们是在 Heroku 上运行的 Ruby on rails 应用程序，我们正在为我们的数据库使用 Heroku 的 Postgres 解决方案。

我们有一个非常昂贵的数据库查询。大约需要 45 秒。我们使用 memcache 来缓存这个查询......但是当有人在缓存中 24 小时后第一次访问运行这个查询的页面时，该站点基本上会在这个查询运行时出现故障。

我们正在考虑将查询放在后台线程上。这会与 memcache 很好地配合使用吗？这会有助于网站性能吗？数据库仍在处理大查询这一事实会影响其他页面的加载吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T14:41:02.547

如果问题在测功机上不是资源密集型或锁定数据库，它可能会有所帮助。

如果这两种情况都不成立，您可以简单地将某些内容（以前的版本，可能在缓存过时之前启动进程）返回到启动客户端并旋转一个新线程。

如果强度在测功机上而不是数据库上，您可以尝试启动工作测功机或[计划作业](https://devcenter.heroku.com/articles/scheduler)。

如果您的数据库被锁定，那么您又回到了绘图板上。

哦，如果您的应用程序只使用一个数据库连接，请确保为线程打开另一个数据库连接（测功机会自行处理）。

# vb.net - 如何使用 System.IDisposable.Dispose？

> ID：15373675
> 
> 赞同：1
> 
> 时间：2013-03-12T22:40:46.227
> 
> 标签：vb.net

我在我的对象中收到一个警告，它将值从一种形式转移到另一种形式 警告说 Button1 必须在 Object Form1 上调用 System.IDisposable.Dispose，然后才能对其进行引用

这是我在 button1 上的代码：

```
Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click
    Dim Form1 As New Form1
    Form1.a1 = TextBox1.Text
    Form1.a2 = TextBox2.Text
    Form1.a3 = TextBox3.Text
    Form1.a4 = TextBox4.Text
    Form1.a5 = TextBox5.Text
    Form1.a6 = TextBox6.Text
    Form1.a7 = TextBox7.Text
    Form1.a8 = TextBox8.Text
    Form1.a9 = TextBox9.Text
    Form1.a10 = TextBox10.Text
    Form1.Show()
    Form1.SetPrice()
    Me.Close()
End Sub 
```

如何使用 System.IDisposable.Dispose？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:07:49.083

听起来列出的代码不在 Form1 中。无论它采用何种形式，都在实例化 Form1，但不处理它。只需将 Form1 包装在[Using](http://msdn.microsoft.com/en-us/library/htd05whh.aspx)语句中：

```
Using Form1 As New Form1
    Form1.a1 = TextBox1.Text
    Form1.a2 = TextBox2.Text
    Form1.a3 = TextBox3.Text
    Form1.a4 = TextBox4.Text
    Form1.a5 = TextBox5.Text
    Form1.a6 = TextBox6.Text
    Form1.a7 = TextBox7.Text
    Form1.a8 = TextBox8.Text
    Form1.a9 = TextBox9.Text
    Form1.a10 = TextBox10.Text
    Form1.Show()
    Form1.SetPrice()
End Using
Me.Close() 
```

# sql - SQL 存储过程

> ID：15373677
> 
> 赞同：0
> 
> 时间：2013-03-12T22:40:56.273
> 
> 标签：sql

我在 sql 中有一个表，我在其中插入了另一个表名。有表名列。所以有可能（在 SQL 中以编程方式）从该列中获取表名并在存储过程中将它们用作表名。如何？里面SQL。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:43:14.033

听起来像是您需要使用[动态 SQL](http://www.mssqltips.com/sqlservertip/1160/execute-dynamic-sql-commands-in-sql-server/)来执行的操作。在您急于执行此操作之前，我建议您阅读这篇文章：

[http://www.sommarskog.se/dynamic_sql.html](http://www.sommarskog.se/dynamic_sql.html)

# joomla2.5 - Joomla 备份在本地运行

> ID：15373682
> 
> 赞同：0
> 
> 时间：2013-03-12T22:41:12.657
> 
> 标签：joomla2.5

Joomla 网站的下载备份可以在本地主机上运行吗？如果是，我需要在本地进行哪些更改？

我将解压后的备份文件夹放在`C:\xampp\htdocs\joomla`. 所以现在当我尝试运行 loclhost`//localhost/joomla`时，它给了我以下错误。

`Database Error: Unable to connect to the Database: Could not connect to MySQL.`

请注意，我没有对备份进行任何更改。只需将通过 FTP 下载的解压缩备份放在 htdocs 中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T01:23:06.987

可能是数据库细节不正确。除非您在 localhost 上创建了确切的数据库名称和用户，否则您需要编辑 configuration.php 以解决这个问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T00:07:51.590

您还需要下载网站数据库的副本并将其安装在本地。如果这对您来说是新的，请查看[Akeeba Backup](http://extensions.joomla.org/extensions/access-a-security/site-security/backup/1606)，它会简化您在不同服务器之间移动站点时的生活。它将数据库和站点文件捆绑到一个漂亮、整洁的压缩包中。

# c# - Tablix 未显示使用“自定义”IEnumerable 创建的数据集

> ID：15373685
> 
> 赞同：0
> 
> 时间：2013-03-12T22:41:24.997
> 
> 标签：c#, winforms, reportviewer, rdlc

我想根据 DataGridView 的数据源列表打印报表。

我想为此使用 Rdlc 报告。我创建了报告，在其中放入了一个带有名为“DataSet”的数据集的 tablix。

然后，在报表查看器中，我只是删除了那个 DataSet，并添加了一个同名的 DataSet，其中包含`IEnumerable`我想要的 list()。问题是 Tablix 没有显示任何内容。我在互联网上查看，但找不到与它相关的任何内容。另外，如何使用 ReportViewer 使字段可见或不可见？

这是我的代码（它在 Form´s Load 事件中：

```
Sistema_financiero_Entities db = new Sistema_financiero_Entities();
IEnumerable<Cheque> cheques = db.Cheque.Where(x => x.id_cheque != 6).ToList();

ReportDataSource data = new ReportDataSource("DataSet", cheques);

try
{
    this.rpt_Viewer.LocalReport.DataSources.Add(data);
    this.rpt_Viewer.RefreshReport();
} 
```

一些注意事项： db 是实体框架对象上下文。检查是列表（在本例中，我只是从数据库中获取数据，但我将使用 DataGridView 数据源列表，我这样做只是为了测试它是否有效）。rpt_Viewer 是报告查看器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T14:02:26.633

改变`IEnumerable<Cheque> cheques = db.Cheque.Where(x => x.id_cheque != 6).ToList();`

至

`List<Cheque> cheques = db.Cheque.Where(x => x.id_cheque != 6).ToList();`完美地工作。

# encryption - 引导节点时出现 Chef Cookbook 编译错误

> ID：15373688
> 
> 赞同：2
> 
> 时间：2013-03-12T22:41:29.350
> 
> 标签：encryption, chef-infra, bootstrapping, knife, databags

我正在使用厨师来引导一个节点。我创建了加密数据包并将节点上的密钥复制为 /etc/chef/encrypted_data_bag_secret。

当我尝试引导节点时，出现以下错误：

```
================================================================================
Recipe Compile Error in /var/chef/cache/cookbooks/webapps-configs/recipes/httpd.rb
================================================================================
 Net::HTTPServerException
 ------------------------
 404 "Not Found"
 Cookbook Trace:
 ---------------
   /var/chef/cache/cookbooks/webapps-configs/recipes/httpd.rb:12:in `from_file'
 Relevant File Content:
 ----------------------
 /var/chef/cache/cookbooks/webapps-configs/recipes/httpd.rb:

  10:
  11:  CHEF_ENV = node.chef_environment
  12>> http_ssl_creds = Chef::EncryptedDataBagItem.load("#{CHEF_ENV}", "http-ssl")
  13:  PRIVATE_KEY = http_ssl_creds["private_key"]
  14:  CHAIN_FILE= http_ssl_creds["chain_file"]
  15:  CERT= http_ssl_creds["cert"]
  16:

 ERROR: Running exception handlers
 FATAL: Saving node information to /var/chef/cache/failed-run-data.json
 ERROR: Exception handlers complete
 Chef Client failed. 0 resources updated
 FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out
 FATAL: Net::HTTPServerException: 404 "Not Found" 
```

这是堆栈跟踪：

```
Net::HTTPServerException: 404 "Not Found"
/opt/chef/embedded/lib/ruby/1.9.1/net/http.rb:2632:in `error!'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/rest.rb:199:in `block in raw_http_request'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/rest.rb:280:in `retriable_rest_request'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/rest.rb:164:in `raw_http_request'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/rest.rb:158:in `api_request'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/rest.rb:99:in `get'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/data_bag_item.rb:149:in `load'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/encrypted_data_bag_item.rb:294:in `load'
/var/chef/cache/cookbooks/webapps-configs/recipes/httpd.rb:12:in `from_file'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/mixin/from_file.rb:30:in `instance_eval'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/mixin/from_file.rb:30:in `from_file'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/cookbook_version.rb:346:in `load_recipe'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/run_context.rb:151:in `load_recipe'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/run_context/cookbook_compiler.rb:139:in `block in compile_recipes'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/run_context/cookbook_compiler.rb:137:in `each'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/run_context/cookbook_compiler.rb:137:in `compile_recipes'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/run_context/cookbook_compiler.rb:74:in `compile'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/run_context.rb:86:in `load'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/client.rb:224:in `setup_run_context'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/client.rb:467:in `do_run'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/client.rb:200:in `run'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/application.rb:190:in `run_chef_client'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/application/client.rb:297:in `block in run_application'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/application/client.rb:290:in `loop'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/application/client.rb:290:in `run_application'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/application.rb:73:in `run'
/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/bin/chef-client:26:in `<top (required)>'
/usr/bin/chef-client:23:in `load'
/usr/bin/chef-client:23:in `<main>' 
```

任何帮助或指示？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-21T12:20:08.233

我已经解决了这个问题。似乎环境没有正确创建。所以当我引导节点时，它的环境被设置为“_default”，因此节点无法找到这些项目。

我通过传递 --environment 参数重新创建了环境并引导节点，并且我能够毫无问题地引导。

再次感谢所有贡献者的投入。这个社区太棒了！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-20T23:24:23.743

尝试将以下行添加到您的食谱中：

```
 11\. CHEF_ENV = node.chef_environment
+ 12\. Chef::Config[:encrypted_data_bag_secret]
  13\. http_ssl_creds = Chef::EncryptedDataBagItem.load("#{CHEF_ENV}", "http-ssl")
  14\. PRIVATE_KEY = http_ssl_creds['private_key']
  15\. CHAIN_FILE= http_ssl_creds['chain_file']
  16\. CERT= http_ssl_creds['cert'] 
```

另一个要检查的是节点环境是你的加密数据包的名称。

由于您已将**/etc/chef/encrypted_data_bag_secret**复制到节点，因此应该可以解决问题。

# python - 如何在不使用 ./script.py 的情况下运行 python 脚本？

> ID：15373693
> 
> 赞同：2
> 
> 时间：2013-03-12T22:41:44.177
> 
> 标签：python

我有一个 script.py，当用户在 unix 中键入“脚本”时，我想运行它。我该如何做到这一点，而不是每次都强迫他输入 ./script.py ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:43:20.480

您需要将脚本的目录放在`PATH`环境变量中。

例如

```
/path/to/script.py
export PATH=$PATH:/path/to 
```

要避免键入扩展名，请创建本地符号链接

```
ln -s /path/to/script.py /path/to/script 
```

这可以防止`/usr/local/bin`手动符号链接（这在多用户上可能很重要）系统造成的污染。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T22:45:47.323

您需要在不使用 .py 扩展名的情况下向脚本添加符号链接，并将其放在系统路径的某个位置。例如，您可能会这样做

```
sudo ln -s myscript.py /usr/local/bin/myscript 
```

那么你将既不需要 也不`.py`需要`./`。

# c# - C#中的SQL超出范围值

> ID：15373694
> 
> 赞同：-5
> 
> 时间：2013-03-12T22:41:45.987
> 
> 标签：c#, sql-server

当我在 C# Debug 中运行 SQL 时，我遇到了超出范围值的问题。但是选择日期时间的转换，直接在 SQL 中工作。我能做些什么..？

```
WHERE (Edu_Table_1.chatardeba = CONVERT(DATETIME, '" + datesList[dd] + "', 103)) 

...

List<DateTime> datesList = new List<DateTime>();
DataTable dt1 = DataObjects.FetchFromDatabase(String.Format("SELECT date from dates_table", magalkurseli, examType), this.serverAddress, this.dbCatalog); 
if (dt1 != null && dt1.Rows.Count > 0) 
{ 
    foreach (DataRow dr in dt1.Rows) 
    {
        datesList.Add(Convert.ToDateTime(dr["tarigi"])); 
    } 
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:45:06.647

这里没有太多信息可以继续，但根据我看到其他开发人员遇到的问题，我可以猜测发生了什么......

.NET 中对象的默认值`DateTime`不在`datetime`sql 中数据类型的有效范围内。当您有一个不可为空的`DateTime`属性或参数未初始化为有效值（或设置为`default(DateTime)`）时，通常会发生这种情况。

解决方案通常是`DateTime?`在任何相关的 c# 对象中使用可为空的列，**或者**始终将属性初始化`DateTime`为 sql 预期范围内的值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T22:56:59.353

这是很容易解决的问题，并且发生这种情况是因为您的数据库格式与 .Net datetime fromat 不同（您可以将日期作为月份发送）您所要做的就是：

*   打开 sql management studio 并运行“select GETDATE()”，它将返回数据库日期时间格式，
*   当您接收或发送日期到数据库时，请确保将其格式更改为相同的数据库格式。

    // 例如，数据库中的日期时间是 13-03-2013 // 更改 .Net 日期对象的格式 dt.toString("dd-MM-yyyy");

# php - PHP 命令不同步错误

> ID：15373698
> 
> 赞同：7
> 
> 时间：2013-03-12T22:42:35.840
> 
> 标签：php, mysql

这个简单的代码调用了两个 MySQL 过程，但是在第一个返回值之后，它在第二个查询中返回一个错误。

**注意：**单独运行第一个或第二个将正确返回每个。所以查询工作，只是不在一起。

完整的错误是： `Invalid query: Commands out of sync; you can't run this command now`

请有任何想法。

```
<?php

require_once ('connection.php');
//First Query and Output

$result = mysql_query("CALL C01_Client_Summary_ByAccount(1, '2012-02-27', '2013-03-29');");
if (!$result) { 
die('Invalid query: ' . mysql_error());
}
while($row=mysql_fetch_array($result))
{
echo $row['CommisionPercentage'];
}

mysql_free_result($result); 
//END First Query and Output

//Second Query and Output
$new2 = mysql_query("CALL C01_Client_Summary_ByBetType(1, '2012-02-27', '2013-03-29');");
if (!$new2) { 
die('Invalid query: ' . mysql_error());
}
while($row=mysql_fetch_array($new2))
{
echo $row['Turnover'];
}
//END Second Query and Output

?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T23:15:13.247

PHP 的旧 MySQL 扩展无法与存储过程一起正常工作。不幸的是，似乎没有办法用它执行多个存储过程。问题是第一个过程留下了一些缓冲的结果集，导致第二个过程失败。但是，您可以使用 mysqli 扩展。这是有关如何执行此操作的一个很好的示例：

[http://www.daniweb.com/web-development/php/threads/234868/error-commands-out-of-sync-you-cant-run-this-command-now](http://www.daniweb.com/web-development/php/threads/234868/error-commands-out-of-sync-you-cant-run-this-command-now)

# python-2.7 - 尝试除了不捕获异常

> ID：15373702
> 
> 赞同：1
> 
> 时间：2013-03-12T22:43:08.653
> 
> 标签：python-2.7, scipy

我有一段由于各种原因可能会失败的数字代码，我想用 numpy.NAN 替换输出值，这样事情就会继续发展。我试图将对 brentq 的调用包装在 try:except: 语句中，但它仍然使我的代码因同一个异常而崩溃。

```
def someotherfunction(stuff):
    self.energy2ph = lambda e: self.brentq_fails_to_NAN(ph2offset_energy, 0., max_ph, args=(e,))    
def brentq_fails_to_NAN(self, *args):
    ''' this simply calls scipy.optimize.brentq with the exact same arguments, 
    but in the case of an error it returns numpy.NAN instead of throwing an exception '''
    try:
        return scipy.optimize.brentq(*args)
    except:
        print 'returning numpy.NAN instead of throwing an exception for energy2ph'
        return numpy.NAN 
```

我得到一个回溯，但有一个异常可以追溯到我的 try 语句。我的理解是应该在那种情况下运行 except: 语句下的代码

```
/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mass/calibration/energy_calibration.pyc in name2ph(self, name)
    257 
    258     def brentq_fails_to_NAN(self, *args):
--> 259         try:
    260             return scipy.optimize.brentq(*args)
    261         except:

/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/mass/calibration/energy_calibration.pyc in <lambda>(e)
    252         max_ph = 1.3*self._ph[-1]
    253         ph2offset_energy = lambda ph, eoffset: self.ph2energy(ph)-eoffset
--> 254 #        self.energy2ph = lambda e: scipy.optimize.brentq(ph2offset_energy, 0., max_ph, args=(e,))
    255         self.energy2ph = lambda e: self.brentq_fails_to_NAN(ph2offset_energy, 0., max_ph, args=(e,))
    256 

/opt/local/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/site-packages/scipy/optimize/zeros.pyc in brentq(f, a, b, args, xtol, rtol, maxiter, full_output, disp)
    387     if type(args) != type(()) :
    388         args = (args,)
--> 389     r = _zeros._brentq(f,a,b,xtol,maxiter,args,full_output,disp)
    390     return results_c(full_output, r)
    391 

ValueError: f(a) and f(b) must have different signs 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:10:26.407

在这种情况下可能会吞下一些异常，请试试这个

```
except Exception:
        print 'returning numpy.NAN instead of throwing an exception for energy2ph'
        return numpy.NAN 
```

# r - R gbm 包：训练误差和 Adaboost 指数损失函数

> ID：15373710
> 
> 赞同：0
> 
> 时间：2013-03-12T22:43:34.160
> 
> 标签：r, machine-learning, adaboost

我在 R 中使用 gbm 包进行**二进制分类**。我正在为算法使用 adaboost 指数损失函数。我有两个问题：

1.  如果我想查看训练错误，我应该只看这个吗？（假设我的模型对象叫做 fit，我使用了 3-fold CV。）

    `best.iter <- gbm.perf(fit,method="cv")`

    `fit$train.error[best.iter]`

2.  如果我想对我的训练数据集进行预测，请说“训练”，并通过以下代码行删除响应变量`pred <- predict(object=fit,newdata=train,n.trees=best.iter)`：它只给了我 adaboost 的指数损失值。我怎样才能将其转换回二进制类的概率？我试过`plogis`了`log`。结果只是没有意义。例如，`plogis`所有内容都给我 0.99***，`log`给我区间 [0.52,0.56]。我应该做什么样的转变？

仅供参考，我种了 100 棵树，拟合过程似乎还可以。例如，

```
> fit$oobag.improve
[1] 0.1431295103 0.1093538334 0.0852480128 0.0678520088 0.0549712390 0.0452351232 0.0378058484 0.0319409903
[9] 0.0275396129 0.0237185758 0.0208696658 0.0182786535 0.0163750200 0.0146381260 0.0132728128 0.0119435448
[17] 0.0108959138 0.0099211566 0.0091093166 0.0084316036 0.0078037047 0.0071945142 0.0066821670 0.0061718044
[25] 0.0058103999 0.0054534710 0.0051276913 0.0047975274 0.0044901763 0.0042387273 0.0039702177 0.0037345627
[33] 0.0035337545 0.0033370776 0.0031656407 0.0029688111 0.0028016085 0.0026640768 0.0025268873 0.0023897908
[41] 0.0022594735 0.0021612521 0.0020255227 0.0019376223 0.0018393318 0.0017481065 0.0016463413 0.0015561673
[49] 0.0014813435 0.0014237926 0.0013459092 0.0012719409 0.0012116881 0.0011572038 0.0010948941 0.0010420570
[57] 0.0009843288 0.0009398356 0.0008938670 0.0008542828 0.0008063698 0.0007637763 0.0007325414 0.0006917561
[65] 0.0006582027 0.0006313925 0.0005979843 0.0005645791 0.0005410957 0.0005159002 0.0004869797 0.0004643209
[73] 0.0004464032 0.0004213901 0.0004010297 0.0003815199 0.0003623747 0.0003445184 0.0003269569 0.0003105762
[81] 0.0002960856 0.0002802715 0.0002679399 0.0002541207 0.0002425242 0.0002294759 0.0002200414 0.0002093278
[89] 0.0001974315 0.0001893624 0.0001788743 0.0001709422 0.0001624860 0.0001538988 0.0001479532 0.0001403145
[97] 0.0001338089 0.0001256208 0.0001206701 0.0001142448 
```

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-26T14:35:29.297

1.第一个问题：你是对的，通过 fit$train.error 你可以检查训练错误。fit$train.error[best.iter] 是检查选择的最佳模型的训练误差。注意，fit$train.error[best.iter] 不是最小的训练误差，因为最好的模型是由 cv.test.error 选择的。

2.Adaboost 是 ensamble 模型选择指数损失函数时的一种特殊情况。要将其转换回其他类型的损失函数，您首先需要知道 adaboos 误差是如何计算的。

对于 y{-1,1} 分类问题：指数损失`L=exp(-y*f(x))`

其中 f(x) 是训练有素的 adaboost 模型生成的结果。类别决策应由 f(x) 的符号做出，如果 f(x)>0 则预测 y=1，否则 y=-1。然后你可以看到所有指数损失 < 1 都被正确分类，损失 <1 被错误分类。现在很容易转换为二进制错误分类率。

请注意，如果您看到所有训练数据 <1 的损失函数，请不要担心，这是因为 adaboost 优化了边际而不是降低错误分类率。

希望这可以帮到你！

# php - 检查 MySQL 表中的任何记录是否位于特定日期

> ID：15373711
> 
> 赞同：0
> 
> 时间：2013-03-12T22:43:35.793
> 
> 标签：php, mysql, database, pdo

我在 mysql 中有一个在线预订系统数据库，我正在尝试使用[本教程](http://www.phpjabbers.com/how-to-make-a-php-calendar-php26.html)将其与可视 php 日历链接。

日历上的每一天都由 a 表示`<td>`，我使用以下 PDO 查询来确定每一天的背景颜色（如果可用 = 无颜色，如果没有则为红色）。

我遇到的一个复杂情况是，我需要直观地显示 1 个预订在 X 天结束，并显示另一个预订在同一天 X 开始。

```
$query_params = array( 
    ':campervan_id' => $_GET['campervan'],
    ':day' => $date_form.($i - $startday + 1)
);

$query = " 
    SELECT 
        car,
        booking_id,
        DATE_FORMAT(start_date, '%e/%c') AS s_d,
        DATE_FORMAT(end_date, '%e/%c') AS e_d
    FROM 
        bookings as bb 
    INNER JOIN 
        reservation as br ON bb.booking_id=br.bookings_id
    INNER JOIN 
        cars as bc ON br.car_id=bc.car_id
    WHERE 
        bc.campervan_id=:campervan_id AND
        :day BETWEEN bb.start_date AND bb.end_date
"; 
```

然后与我一起使用以下内容输出表格单元格结果：

```
if($i < $startday) { 
    echo "
        <td>
        </td>
    ";
}

else {

// IF DAY IS AVAILABLE
if(!$rows) {
    $color = "none";
}
// IF DAY IS UNAVAILABLE
else {
    $color = "#F3747F";
}

$dayMonth = ($i-$startday + 1)."/$cMonth";

// If DAY FALLS ON A START PICK UP DATE
if ($dayMonth == $rows['s_d']) {
        $back = "background-image:url(\"images/morning_back.png\");";
        $color = "none";
}
// If DAY FALLS ON A END DROP OFF DATE
else if($dayMonth == $rows['e_d']) { 
        $back = "background-image:url(\"images/afternoon_back.png\");";
        $color = "none";
}

// **************************************************

// IF FALLS ON BOTH A START AND END DATE????????
else if($dayMonth == ($rows['s_d'] && $rows['e_d'])) { 
        $back = "background-image:url(\"images/full_back.png\");";
        $color = "none";
}

// **************************************************

else {
    $back = "";
}

echo "
    <td align='center' valign='middle' height='100px' width='134' style='color:#FFFFFF; background-color:".$color."; ".$back." border:1px solid white;'>
        ".($i-$startday + 1)."
    </td>
";
} 
```

这适用于在每个预订的开始日期、每个预订的结束日期直观地显示对角分割背景图像，但我无法正确显示一个预订的结束和另一个预订的开始的日期。

我认为这是因为我的初始查询只查看一个预订记录 - 我需要它来识别所有这些记录，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:57:37.913

您应该在 bb.enddate=bb2.stsrtdate 和 bb.booking_id!=bb2.booking_id 的地方对预订 bb 进行内部连接

```
LEFT JOIN booking as bb2
ON bb.enddate=bb2.startdate 
AND bb.booking_id!=bb2.booking_id 
```

然后您可以检查 bb2.booking_id 是否为空。如果不是，则有一个匹配的开始日期和结束日期。

但这只有在同一天只能有 1 个事件开始时才有效。否则你可能会得到重复的行。

# verilog - 是否有用于指定合成加法器类型的编译器指令？

> ID：15373712
> 
> 赞同：1
> 
> 时间：2013-03-12T22:43:38.130
> 
> 标签：verilog, fpga, system-verilog, vlsi

我没有在谷歌上找到这个，所以这里是：

有没有人听说过设计编译器指令来指定合成哪种类型的加法器？我正在寻找可以像这样工作的东西：

```
logic [7:0] a, b, c, d, e, f;

/* ... */

// synopsys use_carry_look_ahead
assign c = a + b;

// synopsys use_carry_select
assign f = d + e; 
```

FWIW，我正在使用 SystemVerilog 编写并使用 Synopsys DC 编译器，但如果有人听说过为其他编译器完成此任务的指令，我会全力以赴。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:18:11.940

不确定它是否正是您正在寻找的，但有很多加法器选项`set_dp_smartgen_options`

```
 status set_dp_smartgen_options
          [-all_options auto | true | false | default]
          [-booth_encoding auto | true | false]
          [-booth_radix8 auto | true | false]
          [-booth_mux_based auto | true | false]
          [-booth_cell auto | true | false]
          [-mult_nand_based auto | true | false]
          [-inv_out_adder_cell auto | true | false]
          [-4to2_compressor_cell auto | true | false]
          [-adder_radix auto | 2 | 3 | 4]
          [-ling_adder auto | true | false]
          [-hybrid_adder auto | true | false]
          [-carry_select_adder_cell auto | true | false]
          [-cond_sum_adder auto | true | false]
          [-sklansky_adder auto | true | false]
          [-brent_kung_adder auto | true | false]
          [-bounded_fanout_adder auto | true | false]
          [-mux_based auto | true | false]
          [-inv_adder_cell auto | true | false]
          [-sop2pos_transformation auto | true | false]
          [-tp_opt_tree auto | true | false]
          [-tp_oper_sel auto | true | false]
          [-smart_compare auto | true | false]
          [-optimize_for default | area | speed | area,speed]
          [-power_effort off | auto | medium | high]
          [-hierarchy]
          [design or cell list]
          [-retime design_list]
          [-retime_clk_period period_value] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:18:42.970

我不知道 Synopsys 编译指示来选择特定实现，但 DesignWare 文档声称您可以强制 Design Compiler 使用其中一种可用架构。

# - QAbstract滑块

> ID：15373715
> 
> 赞同：0
> 
> 时间：2013-03-12T22:43:42.287
> 
> 标签：

QAbstractSlider 类是 Qt 框架的一部分，它提供一个范围内的整数值。

# java - 无法使用码头在谷歌应用引擎上部署应用程序：“HTTP ERROR 404 Pblm access /.Reason: not found”

> ID：15373716
> 
> 赞同：0
> 
> 时间：2013-03-12T22:43:44.673
> 
> 标签：java, google-app-engine, jsp, servlets, jetty

[我已经尝试使用我在此处](http://www.vogella.com/articles/GoogleAppEngineJava/article.html)找到的一篇文章来设置一个使用 Java 的示例“待办事项”谷歌应用程序引擎示例。

但是，当我尝试在本地运行应用程序并检查 localhost:8888 地址时，我收到以下错误：

```
HTTP ERROR: 404

Problem accessing /. Reason:

    NOT_FOUND
Powered by Jetty:// 
```

我已经仔细检查了我的 appengine-web.xml 和 web.xml。但似乎无法弄清楚我哪里出错了。

链接：[Appengine-web.xml](https://gist.github.com/KodeSeeker/54d0659c9113ffea916b)。
[web.xml](https://gist.github.com/KodeSeeker/5147762)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T16:04:11.150

您的 appengine-web.xml 和 web.xml 似乎正确，但在您的 web.xml 中有：

```
<servlet-class>com.test.todo.dao..ServletRemoveTodo</servlet-class> 
```

你意识到这两个点了吗？我认为这就是问题所在。服务器找不到 servlet 并抛出 NOT FOUND 错误。

它应该是：

```
<servlet-class>com.test.todo.dao.ServletRemoveTodo</servlet-class> 
```

# ruby-on-rails - 如何清理我的 join_table 并删除重复条目？

> ID：15373723
> 
> 赞同：0
> 
> 时间：2013-03-12T22:44:36.463
> 
> 标签：ruby-on-rails, ruby-on-rails-3, postgresql, optimization, has-and-belongs-to-many

我有 2 个模型 -`Question`并且`Tag`- 它们之间有一个 HABTM，它们共享一个连接表`questions_tags`。

大饱眼福这个坏小子：

```
1.9.3p392 :011 > Question.count
   (852.1ms)  SELECT COUNT(*) FROM "questions" 
 => 417 
1.9.3p392 :012 > Tag.count
   (197.8ms)  SELECT COUNT(*) FROM "tags" 
 => 601 
1.9.3p392 :013 > Question.connection.execute("select count(*) from questions_tags").first["count"].to_i
   (648978.7ms)  select count(*) from questions_tags
 => 39919778 
```

我假设`questions_tags`连接表包含一堆重复的记录——否则，我不知道它为什么会这么大。

如何清理该联接表以使其仅包含`uniq`内容？或者我什至如何检查那里是否有重复的记录？

**编辑 1**

我正在使用 PostgreSQL，这是 join_table 的架构`questions_tags`

```
 create_table "questions_tags", :id => false, :force => true do |t|
    t.integer "question_id"
    t.integer "tag_id"
  end

  add_index "questions_tags", ["question_id"], :name => "index_questions_tags_on_question_id"
  add_index "questions_tags", ["tag_id"], :name => "index_questions_tags_on_tag_id" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T00:51:15.700

我将此添加为新答案，因为它与我的上一个有很大不同。这个不假设您`id`在连接表上有一个列。这将创建一个新表，在其中选择唯一行，然后删除旧表并重命名新表。这将比任何涉及子选择的方法快得多。

```
foo=# select * from questions_tags;
 question_id | tag_id
-------------+--------
           1 |      2
           2 |      1
           2 |      2
           1 |      1
           1 |      1
(5 rows)

foo=# select distinct question_id, tag_id into questions_tags_tmp from questions_tags;
SELECT 4
foo=# select * from questions_tags_tmp;
 question_id | tag_id
-------------+--------
           2 |      2
           1 |      2
           2 |      1
           1 |      1
(4 rows)

foo=# drop table questions_tags;
DROP TABLE
foo=# alter table questions_tags_tmp rename to questions_tags;
ALTER TABLE
foo=# select * from questions_tags;
 question_id | tag_id
-------------+--------
           2 |      2
           1 |      2
           2 |      1
           1 |      1
(4 rows) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:19:28.007

删除带有错误标签引用的标签关联

```
DELETE  FROM questions_tags
WHERE   NOT EXISTS ( SELECT  1 
                 FROM    tags
                 WHERE   tags.id = questions_tags.tag_id); 
```

删除带有错误问题参考的标签关联

```
DELETE  FROM questions_tags
WHERE   NOT EXISTS ( SELECT  1 
                 FROM    questions
                 WHERE   questions.id = questions_tags.question_id); 
```

删除重复的标签关联

```
DELETE  FROM questions_tags
USING   ( SELECT qt3.user_id, qt3.question_id, MIN(qt3.id) id
          FROM   questions_tags qt3
          GROUP BY qt3.user_id, qt3.question_id
        ) qt2
WHERE   questions_tags.user_id=qt2.user_id AND 
        questions_tags.question_id=qt2.question_id AND
        questions_tags.id != qt2.id 
```

**笔记：**

请先在您的开发环境中测试 SQL，然后再在您的生产环境中尝试它们。

# ios - 无法在自定义 UITableView 类中使用自定义 UITableViewDataSource

> ID：15373726
> 
> 赞同：0
> 
> 时间：2013-03-12T22:44:40.880
> 
> 标签：ios, uitableview

我正在尝试创建一个`UITableView`使用它自己的自定义扩展的类`DataSource`。

该类称为`SHCTableView`.

首先，我创建了一个名为`SHCTableViewDataSource.h`extends的原型类`NSObject`。

现在我将属性添加到`SHCTableView.h`：

```
// the object that acts as the data source for this table
@property (nonatomic, assign) id<SHCTableViewDataSource> dataSource; 
```

我收到警告

> `Property type 'id<SHCTableViewDataSource>' is incompatible with type 'id<UITableViewDataSource>' inherited from 'UITableView'`

并且在`SHCTableView.m`

```
const float SHC_ROW_HEIGHT = 50.0f;

-(void)refreshView {
  // set the scrollview height
  _scrollView.contentSize = CGSizeMake(_scrollView.bounds.size.width, [_dataSource numberOfRows] * SHC_ROW_HEIGHT);

  // add the cells
  for (int row=0; row < [_dataSource numberOfRows]; row++) {

    // obtain a cell
    UIView* cell = [_dataSource cellForRow:row];

    // set its location
    float topEdgeForRow = row * SHC_ROW_HEIGHT;
    CGRect frame = CGRectMake(0, topEdgeForRow, _scrollView.frame.size.width, SHC_ROW_HEIGHT);
    cell.frame = frame;

    // add to the view
    [_scrollView addSubview:cell];

  }

}

#pragma mark - property setters
-(void)setDataSource:(id<SHCTableViewDataSource>)dataSource {

  _dataSource = dataSource;
  [self refreshView];

} 
```

所有实例`_dataSource`都给我一个错误：

> `Instance variable '_dataSource' is private`

还有一堆其他错误，但它们似乎都是由于`_dataSource`私有的事实引起的，这可能与上面的警告有关。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:07:30.510

UITableView 已经声明了 dataSource，所以声明为同名并不是一个好主意。只需声明

```
@property (nonatomic, assign) id<SHCTableViewDataSource> customDataSource; 
```

然后

```
-(void)setDataSource:(id<SHCTableViewDataSource>)dataSource {
[super setDataSource:_dataSourceInterceptor]
  _customDataSource = dataSource;

 [self refreshView];

} 
```

如果你必须这样做，那么你可以这样做..

创建中间对象为dataSourceInterceptor，设置超类的原始dataSource，实现dataSource函数。不要将 self 设置为 dataSource 这不是一个好主意。

# java - 从我的 JSP 添加到 bean 中的列表

> ID：15373727
> 
> 赞同：1
> 
> 时间：2013-03-12T22:45:01.957
> 
> 标签：java, jsp

我是 jsp 的新手，所以请多多包涵。

我创建了一个包含列表的 bean。

```
public class ListBean {

List<Question> questions;

public void addquestion(Question question) {
    this.questions.add(vraag);
    }

public List<Question > getQuestions() {
    return questions;
}

public void setQuestions(List<Question> questions) {
    this.questions= questions;
}
} 
```

是否有可能从我的 jsp 中将这个 bean 添加到这个列表中？

```
<jsp:useBean id="listbean"
    class="be.beans.ListBean" scope="page"></jsp:useBean> 
```

我只知道`<jsp:setProperty ...`，但这行不通。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:55:41.680

自从我使用 JSP 以来已经有一段时间了。我不确定是否可以使用 taglibs，但可以使用 scriptlet（jsp 中的 java 代码），是的。

```
<% ListBean listBean = pageContext.getAttribute("listbean");
   listBean.getQuestions().add(question);
%> 
```

`question`上面的代码片段中是`Question`您要添加到列表中的对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T03:46:09.673

我没有从你那里得到确切的信息，因为我知道你需要使用它`list`并将`entire application`其存储在其中`database`，如果是这样，我参考以下代码段

```
<jsp:setProperty name="list" property="listbean">
      <jsp:attribute name="value">
         <%=ListBean.questions%>
      </jsp:attribute>
</jsp:setProperty> 
```

`import ListBean`上课`jsp page`

您可以将此属性`listbean`用于整个应用程序，并可以存储到`database`任何其他页面

# java - GWT：找不到类加载器

> ID：15373728
> 
> 赞同：0
> 
> 时间：2013-03-12T22:45:02.793
> 
> 标签：java, gwt, itext, restlet

是否有任何文件夹相当于`/META-INF/services/`GWT 项目中的动态 Web 项目文件夹？我需要它在我的类加载器中添加一个类路径。

单独使用以下示例时，它可以完美运行：

```
package flyingsaucerpdf;

import java.io.File;
import java.io.FileOutputStream;
import java.io.OutputStream;
import org.xhtmlrenderer.pdf.ITextRenderer;

public class PDFMaker {
    public static void main(String[] args) throws Exception {
        new PDFMaker().go();
    }

    public void go() throws Exception {
        String inputFile = "sample.html";
        String url = new File(inputFile).toURI().toURL().toString();
        String outputFile = "firstdoc.pdf";
        OutputStream os = new FileOutputStream(outputFile);

        ITextRenderer renderer = new ITextRenderer();
        renderer.setDocument(url);
        renderer.layout();
        renderer.createPDF(os);

        os.close();
    }
} 
```

[我认为这与这里](https://stackoverflow.com/questions/5447633/how-to-prevent-xalan-jar-that-has-meta-inf-services-javax-xml-transform-transfor)的问题相同，但我使用的是 GWT 项目而不是动态 Web 项目。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T22:55:24.463

我在这里看不到 GWT 代码。您可以编写一个标准 servlet，并从您的 gwt 代码中调用它。

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-03-13T06:55:33.303

这是又一个 gwt newb 混淆客户端和服务器代码吗？

这可能不是你寻求的直接答案，但它符合格言——教你如何钓鱼，而不是给你一条鱼。

正如我之前建议的那样，我将再次建议。对于任何新手要了解客户端-服务器问题及其分离，您需要首先...

1.  在 JSP 中编写 JEE（又名 J2EE）应用程序。（JSP 在编译之前被翻译成 JavaEE servlet）。
2.  编写没有服务器代码的纯 html/javascript 页面。
3.  让你的 html/javascript 做更复杂的事情，比如画一个正方形，用一张表格列出它的尺寸。
4.  使用 JSP 生成该 html/javascript 页面。
5.  将 JSP 变量嵌入到该 html/javascript 页面中，以动态更改表格的外观、图表和值。
6.  使 JSP 生成该 html/javascript 页面，该页面将在该页面将请求发送回 JSP。例如，用户修改表上的值，指定形状的变化，从正方形变为菱形，因此 JSP 生成一组新的 javascript。
7.  非常熟悉战争文件/目录的结构。然后您将了解 JSP 的哪些部分是客户端代码，哪些部分是服务器端代码。然后，您将了解 Java 和 Javascript 不能混合使用。
8.  然后，您可以开始在 GWT 中编码。然后，您将了解客户端 GWT Java 不是编译到 Java 平台而是编译到浏览器的 javascript 中的含义，因此您不能将 GWT 客户端 Java 与 JEE 服务器 Java 混合使用。
9.  然后，您就会明白，当您在 GWT 项目中看到一些 JavaEE 代码时，它们不是 GWT 客户端代码，您不应该尝试将它们链接到您的 GWT 客户端 Java 代码。
10.  然后，您就会明白客户端 GWT Java 不能做服务器端 GWT Java 可以做的事情，反之亦然。
11.  然后，您将学习如何使双方合作。

在尝试 GWT 之前，您需要熟悉编写结合了 JEE、HTML 和 Javascript 编程的应用程序。

# jquery - 如何在突出显示文本后启用弹出框？

> ID：15373742
> 
> 赞同：0
> 
> 时间：2013-03-12T22:46:26.653
> 
> 标签：jquery, css, twitter-bootstrap, highlight, popover

我试图了解说唱天才如何启用功能，使用户能够突出显示，然后在突出显示完成后显示弹出框。我将如何使用 jquery 做到这一点？

如果有帮助，我还将在我的项目中使用 twitter 引导程序来处理我的项目中的其他项目，包括用户单击按钮后的弹出框。

编辑：第一个示例有效（用户在输入框中选择文本），但第二个示例（用户在“内容”中选择文本）不起作用。

```
 <p class = 'content'>
    Click and drag the mouse to select text in the inputs.
    </p>
    <input type="text" value="Some text" />
    <input type="text" value="to test on" />

    <div></div>

    <script>
      $(":input").select( function () {
      $("div").text("Something was selected").show().fadeOut(500);
      });

      $("content").select( function () {
      $("div").text("Something else outside of input was selected").show().fadeOut(5000);
      });
    </script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:03:04.417

使用**JavaScript**

```
document.getElementById("myDiv").onmousedown = function(){
             //Client has pressed the mouse button without releasing it...
             this.onmouseup = function(){
                    document.getElementById("myPopUp").style.display="block";
             };
}; 
```

[**演示**](http://jsfiddle.net/tdynL/)

使用**jQuery**

```
$("#myDiv").mousedown(function(){

          $("#myDiv").mouseup(function(){

                     $("#myPopUp").show();
          });
}); 
```

[**演示**](http://jsfiddle.net/G7MK7/)

[**jQuery 的 .select()**](http://api.jquery.com/select/)

> **当用户在其中进行文本选择时，选择事件会发送到元素。此事件仅限于`input type="text"`字段和`textarea`框。**

# ios - 使用 BTLE 跟踪移动设备

> ID：15373743
> 
> 赞同：3
> 
> 时间：2013-03-12T22:46:27.693
> 
> 标签：ios, geolocation, core-bluetooth, bluetooth-lowenergy

我正在寻找一种能够在范围内使用我的跟踪另一个支持 BTLE 的 iOS 设备的方法。基本上，一台设备必须记录其地理位置信息，然后使用 BTLE 定期将其发送到另一台设备。

我怎么能做到这一点？一般来说，我无法找到很多关于如何通过 BTLE 发送和接收消息的信息，因此该类别中的任何帮助都会很棒。我已经看到[了这个](https://stackoverflow.com/questions/12323680/transmitting-data-with-corebluetooth)答案，但它对我没有多大帮助，我想知道从那时起是否有任何变化。

如果无法通过 Apple 的内置框架实现，您是否知道任何允许这样做的外部框架？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-13T00:55:28.423

长长的，长的，长的，长话短说，但这里你去：

在一台 iOS 设备上，同时采用 CBCentralManager 和 CBPeripheralManager。CBCentralManager 负责连接到外部外围设备并维护该连接。CBPeripheralManager 将是您用来从使用外围设备的 iOS 设备读取/写入的东西。

在其他 iOS 设备上，仅采用 CBPeripheralManager。您需要将 GATT 配置文件中规定的所有服务和特征添加到 CBPeripheralManager 中。查看 developer.bluetooth.org。为了从一个设备连接到另一个设备，这些服务和特性是必需的。

除了 gatt 特征和服务之外，您还需要添加具有存储位置数据的特征的自定义服务。

查看文档，但特别是对于 CBPeripheralManager，您需要使用

```
-(void) peripheralManager:(BLEPeripheralManager*)mgr requiresResponseToWriteRequests:(NSArray*)requests; 
```

和

```
-(void) peripheralManager:(BLEPeripheralManager*)mgr requiresResponseToReadRequest:(CBATTRequest*)request; 
```

为了在设备之间传递位置数据..抱歉简要概述，但要快速写出来的内容太多了。

# javascript - 为什么我不能使用 DOM 访问 JS 中的 HTML 表格？

> ID：15373744
> 
> 赞同：1
> 
> 时间：2013-03-12T22:46:41.700
> 
> 标签：javascript, html, dom

这是我的代码：

```
<?php
  $nameArray = array(
    array("Andy", "Jackson"),
    array("Barry", "Obama"),
    array("Benny", "Franklin"),
    array("Georgey", "Washington"),
    array("Billy", "Clinton"))
?>

<script type="text/javascript">
function shout(msg) {
  console.log(msg);
}
window.onload=initiate()

function initiate(){
  shout("initiate 0");
  var nameTable = document.getElementById("xyzTable");
  shout ("initiate 1 - nameTable is "+nameTable);
}
</script>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Blablabla</title>
</head>
<body>
<table id='xyzTable'>
    <?php 
      foreach ($nameArray as $pair){
        echo
        "<tr>
          <td>".$pair[0]."</td>
          <td>".$pair[1]."</td>
        </tr>";
      }
    ?>
</table>
</body>
</html> 
```

当我这样做时，JS 变量的内容`nameTable`是`null`，正如我在 Web 控制台中看到的那样。这是为什么？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-12T22:47:48.193

你`initiate`马上执行。我想你的意思是：

```
window.onload=initiate; 
```

反而。

# java - 可能的 Qt 错误。布局的大小似乎不一致。想对此发表意见

> ID：15373746
> 
> 赞同：0
> 
> 时间：2013-03-12T22:46:50.897
> 
> 标签：java, qt, qt-jambi

首先，我正在使用 QtJambi 开发一个应用程序。当我使用 QStackedWidget 时，我遇到了这个问题，找不到合适的解决方案。所以我所做的是尝试隔离问题，我在以下代码中做了：

```
public class Test{
    public static void main(String[] args){
        QApplication.initialize(args);

        QWidget main = new QWidget();
        QVBoxLayout vbox = new QVBoxLayout();
        QPushButton bot = new QPushButton("a");
        vbox.addWidget(bot);

        main.setSizePolicy(Policy.Maximum, Policy.Maximum);
        vbox.setContentsMargins(0, 0, 0, 0);
        vbox.setStretchFactor(bot, 1); //remove this line to have a totally different size

        main.setLayout(vbox);

        main.show();

        QApplication.exec();
    }
} 
```

所以我想我可能遇到了一个错误（当然我可能是错的，我尝试了 qtjambi 4.7.1 和 4.7.0 两个版本，为 ubuntu 12.10 编译）并希望得到确认。

在我指出的代码行上，尝试删除它并且小部件意外更改大小，也许这是故意的？[https://qt-project.org/doc/qt-4.8/qwidget.html#adjustSize](https://qt-project.org/doc/qt-4.8/qwidget.html#adjustSize)说最小高度是100，但似乎不是这样，无论我是否使用扩展策略。

# c++ - 包含另一个类的数组的 C++ 类

> ID：15373747
> 
> 赞同：0
> 
> 时间：2013-03-12T22:46:54.607
> 
> 标签：c++, arrays, class, object

我有一个类，我们称它为 A，我想创建另一个类 B，它将包含 A 的 n 个实例。

B头文件：

```
class A;
class B
{
    B();
    A * arrayofA;
} 
```

B.cpp

```
#include "B.h"
#include "A.h"
B::B() {
 arrayofA = new A[n];
} 
```

Visual Studio 在 = 运算符下划线并告诉我：错误：“B::A *”类型的值不能分配给“A *”类型的实体

怎么了？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T22:53:51.127

基于编译器错误，听起来您不小心将预声明放在了 B 的范围内。

编译器似乎认为您正在这样做：

```
class B
{
   class A; //It's seeing 'A' inside of 'B'.

   A *arrayOfA;
}; 
```

它同时看到**B::A**和**::A**。至于为什么，没有足够的代码知道。检查你的命名空间和你的类，仔细检查 A 是在哪里预先声明的和 A 是在哪里实际定义的。检查它们是否在同一范围内。

您可以使用向量来达到相同的目的。

```
#include "A.h"

class B
{
    std::vector<A> array;
} 
```

或者如果您必须不包含 Ah，那么您可以预先声明 A，并将数组定义为：

```
std::vector< std::unique_ptr<A> > array; 
```

# meteor - 在服务器上运行计时器

> ID：15373751
> 
> 赞同：1
> 
> 时间：2013-03-12T22:47:06.103
> 
> 标签：meteor

我必须编写一个计时器机制。这个想法是让它在所有客户端屏幕上以秒为单位倒计时，并为客户提供增加倒计时时间的选项。计时器很常见，我假设我们需要在服务器上运行它。Meteor Publish 上带有示例代码的一些想法会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:58:20.443

*   检测未来时间广告获取时间戳
*   将该时间戳保存在集合中
*   创建一个简单的计时器；每秒获取当前时间和未来日期之间的差异并显示（正确转换）
*   创建一个将存储的未来时间戳增加 N 毫秒的事件；集合更新应在所有客户端传播

# joomla - Yootheme widgetkit 用户权限

> ID：15373752
> 
> 赞同：0
> 
> 时间：2013-03-12T22:47:10.807
> 
> 标签：joomla, permissions, widget

我的客户在 joomla 的管理面板中受到限制，并且用户组是 menager。我需要向他们展示他们所需要的，仅此而已。但是我可以为该组设置 widgetwit 权限，没有选项可以像其他组件配置弹出屏幕一样进行设置。如何将其展示给管理用户组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-14T00:01:44.940

首先，您需要允许您的组件保存与权限相关的信息，然后访问首选项，最后设置适当的值。

1.  进入组件文件夹：/administrator/components/com_widgetkit/ 使用以下代码创建 config.xml 或编辑它以包含“权限”字段集。

2.  然后在组件或视图中的任何位置添加一个 JToolbar 按钮用于首选项：

    JToolBarHelper::preferences('com_widgetkit');

3.  现在在管理员视图中，您应该看到选项按钮。

# python - numpy.where 中的多个条件

> ID：15373753
> 
> 赞同：4
> 
> 时间：2013-03-12T22:47:26.290
> 
> 标签：python, numpy

使用一些numpy数组a，我想做的是

```
indices = np.where((a < 4) or (a > 12)) 
```

这是无效的。它只是返回“具有多个元素的数组的真值不明确。使用 a.any() 或 a.all()”。但是这个表达*是没有*歧义的，并且`any`不做`all`我想做的事。（`any`并且`all`也不能接受复合表达式。但是`if`可以。困惑......）

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-12T22:52:56.950

你想得到一个逻辑/布尔数组作为你的参数`where`

你可以做`x | y`or `np.logical_or(x,y)`, where `x`and `y`are `a < 4`and`a > 12`

# drupal - 在视图中排列字段

> ID：15373759
> 
> 赞同：0
> 
> 时间：2013-03-12T22:48:06.667
> 
> 标签：drupal, drupal-7, drupal-views

现在，在搜索了一个在 drupal 7.x 版本上工作的模块后的 2 周之后，我采取了另一种方式/模块/指南/教程，是的，最终我以某种方式得到了我想要的东西而不会发生错误。

但现在我想做一些非常简单的事情，但我看不到。

我有模块视图和面板。我想以下面的方式列出 3 个字段：

**所以你需要 10 的图像声誉，我会尝试这样解释：

|=

（其中“|”是缩略图，“-”是标题，另一个“-”是日期。

现在它显示如下：

标题
日期
缩略图

我在互联网上看到很多关于，显示套件，面板，带有重写输出的视图，......

但这一定很简单，这让我抓狂。如果我知道我可以自己用 php/html 编写它，我会做什么。

但我只见树木不见森林

请给我一些可以使用的东西或教程的链接。我需要一个正确的方向。

是的，我的英语很差，我讨厌drupal，但我仍然认为drupal 可以很棒，但它不适合我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T00:43:15.773

您正在谈论“主题化”，即您的字段在屏幕上的显示方式。默认情况下，Views 会发出一些 HTML，将它们包装在元素中，例如 . 确切的 HTML 取决于您使用的显示类型。

实现您描述的布局的最快方法根本不是关于视图，而是使用 CSS。使缩略图浮动：向左并确保其他两个内联显示（没有换行符）。

# python - python列表列表插入换行符

> ID：15373772
> 
> 赞同：2
> 
> 时间：2013-03-12T22:49:17.343
> 
> 标签：python, list, matrix

我正在阅读一个文件，其中包含一个整数矩阵，每个整数用逗号分隔。到目前为止，我有：

```
def open_file(file):
    with open('network.txt') as f:
        Alist = []
        for line in f:
            part = []
            for x in line.split(','):
                part.append(int(x))
            Alist.append(part)
    print Alist

open_file(file) 
```

这成功地显示了值，但以直线显示它们，这不是我需要的。对于整数的每一“行”，我希望有一个新行开始，以便它们累积到一行 6x6。我试图在代码的不同部分打印换行符，但它没有工作，而是在显示数字之前打印等于它在整个文件中检测到的行数的换行符。处理矩阵时最好去掉逗号吗？

同样在创建矩阵后，我打算从 1,1 开始，然后找到任何邻居（1,2 和 2,1）。由于我的搜索没有返回任何可用的结果，我能否指出如何实现这一点的正确方向。不过，我很容易以错误的方式进行搜索。

这是家庭作业。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:57:51.743

这是你想要的？

```
for row in Alist:
    print row 
```

要移动到网格中的相邻单元格，您需要做的就是增加行或列的索引。`Alist[0][0]`然后从右边移动是`Alist[0][1]`，向下移动`Alist[1][0]`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-05-21T11:50:53.217

或者更“pythonic”的方式

```
print "\n".join(str(row) for row in Alist) 
```

# c - 在 C 文件中使用 float4

> ID：15373773
> 
> 赞同：1
> 
> 时间：2013-03-12T22:49:26.093
> 
> 标签：c, cuda

是否可以通过包含“cuda.h”库在 C 代码中使用 CUDA“float4”数据类型？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T22:52:14.560

你刚才`#include "vector_types.h"`

[https://code.google.com/p/hydrazine/source/browse/trunk/hydrazine/cuda/include/vector_types.h?r=23](https://code.google.com/p/hydrazine/source/browse/trunk/hydrazine/cuda/include/vector_types.h?r=23)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T22:54:36.120

如果您只关注`float4`数据类型，请自行定义：

```
typedef struct float4 {
    float x;
    float y;
    float z;
    float w;
} float4; 
```

# ruby-on-rails - 从子域应用程序访问顶级域 cookie

> ID：15373779
> 
> 赞同：0
> 
> 时间：2013-03-12T22:49:35.200
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我的 vbulletin 论坛设置了一些 cookie `domain-name.com`，我想在我的 rails 应用程序中阅读这些 cookie `beta.domain-name.com`。我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-14T09:37:33.990

如果您将cookie的域设置为：（`.domain-name.com`开头的点），您可以从子域访问它的cookie，如果域是`domain-name.com`（开头没有点）您只能从该域访问它的cookie。

# visual-studio - Visual Studio，csproj：如何在 DependentUpon 中指定链接文件？

> ID：15373780
> 
> 赞同：7
> 
> 时间：2013-03-12T22:49:37.950
> 
> 标签：visual-studio, csproj

假设我的项目中有一个 default.aspx.cs，但我想让它依赖于链接的 default.aspx 文件。例如：

```
<Content Include="..\somedir\default.aspx">
  <Link>Default.aspx</Link>
</Content> 
```

这不起作用：

```
<Compile Include="default.aspx.cs">
  <DependentUpon>Default.aspx</DependentUpon>    
  <SubType>ASPXCodeBehind</SubType>
</Compile> 
```

这也不起作用：

```
<Compile Include="default.aspx.cs">
  <DependentUpon>..\somedir\default.aspx</DependentUpon>    
  <SubType>ASPXCodeBehind</SubType>
</Compile> 
```

对于两者，我都会收到此错误：

> 在项目文件中找不到文件“default.aspx.cs”的父文件“Default.aspx”。

是否可以让文件依赖于链接文件？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-15T12:55:36.080

我尝试了同样的事情，似乎不支持。检查：[https](https://bitbucket.org/jfromaniello/nestin/issue/4/error-when-nesting-linked-files) ://bitbucket.org/jfromaniello/nestin/issue/4/error-when-nesting-linked-files “DependentUpon 不适用于链接文件。”

# objective-c - 可选协议方法实现的通用代码放在哪里？

> ID：15373783
> 
> 赞同：1
> 
> 时间：2013-03-12T22:49:51.857
> 
> 标签：objective-c, design-patterns

我有一个协议 P

```
@protocol P<NSObject>
{

-(void)foo;

@optional

-(void)bar;

} 
```

而且我有很多课程（比如说一打）。所有这些类都实现了协议 P。其中大约一半实现了方法**bar**，所有 bar 实现完全相同。

分享实现的最佳方式是什么**吧**？

**明显的想法：**

1）创建一些将实现方法bar并让其他类继承它的基类。

实现起来很简单。但是，我不是这个想法的忠实粉丝。我更喜欢类层次结构来表示实体泛化/规范，而不是代码重用。

2）创建一个助手并从所有需要实现bar方法的类中调用它

行。有用。但是，如果 bar 的实现很小（在我的例子中是几行），那么我们将有比代码本身更多的开销（帮助类和从每个类中调用它）。

还有其他（更好的）方法吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T23:11:52.787

以下是在类之间共享方法实现的几种方法：

1.  遗产。您可以使您的所有类都从实现共享方法的公共基类继承。`UIViewController`但是，例如，如果您需要从类 A 继承和从类 B 继承，则不能这样做`NSManagedObject`。

2.  在所有类共享的基类上创建一个类别。例如，`NSObject`是（实际上）每个其他类的基类。您可以创建一个类别`NSObject`以添加所有类继承的方法。如果你这样做，你应该在你的方法名称前加上前缀，以确保它们不会与其他名称冲突。例如使用`ronin_foo`and`ronin_bar`而不是`foo`and `bar`。

3.  创建一个包含方法实现的文件，**而不是**`@implementation`被块包围。然后`#include`这个文件在`@implementation`每个需要方法的类的块中间。请注意，编译器将为每个类生成机器代码的副本，因此这可能会使您的程序变得更大。

4.  在运行时，使用 Objective-C 运行时 API 将方法从一个类复制到另一个类。您需要阅读[*Objective-C 运行时编程指南*](http://developer.apple.com/library/ios/#documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Introduction/Introduction.html)和[*Objective-C 运行时参考*](http://developer.apple.com/library/ios/#documentation/Cocoa/Reference/ObjCRuntimeRef/Reference/reference.html#//apple_ref/doc/uid/TP40001418)的部分内容。您可能还需要搜索一些示例。

# android - AS3/AIR：蜂窝/ICS 系统栏高度。（需要全屏分辨率）

> ID：15373786
> 
> 赞同：3
> 
> 时间：2013-03-12T22:49:55.557
> 
> 标签：android, actionscript-3, air

在蜂窝平板电脑和 ics 手机上有这个： [http ://www.esato.com/gfx/news/img/android-honeycomb-system-bar_1297213454.jpg](http://www.esato.com/gfx/news/img/android-honeycomb-system-bar_1297213454.jpg)

而且我似乎无法使用其中任何一个获得全屏分辨率

stage.fullScreenHeight Capabilities.screenResolutionY

两者都在我的华硕平板电脑上返回 1232px。我需要能够获得 1280 和 1280 - 1232 才能获得我需要的系统栏高度。有没有办法做到这一点？

**编辑：我的错！Capabilities.screenResolutionY 和 Capabilities.screenResolutionX 工作正常！**

# twitter-bootstrap - 如何在引导的流体布局中使图像的高度与宽度相同

> ID：15373789
> 
> 赞同：0
> 
> 时间：2013-03-12T22:50:02.823
> 
> 标签：twitter-bootstrap

我正在使用 twitter bootstrap 的流体布局编写一个 Web 应用程序。我的代码如下所示。

```
 <div class="row-fluid">
    <div class="offset1 span10">
        <div class="row-fluid">
            <div class="span4 border-line">
                        <div class="row-fluid">
                            <h4 class="text-center"><a href="/category">name_of_item</a></h4>
                             <a target="_blank" href="link_for_item">
                                <img class="item-size" src="photo.url"/>
                            </a>
                            <p> quick_summary|safe </p>
                        </div>
            </div>
            <div class="span4 border-line">
                        <div class="row-fluid">
                            <h4 class="text-center"><a href="/category">name_of_item</a></h4>
                             <a target="_blank" href="link_for_item">
                                <img class="item-size" src="photo.url"/>
                            </a>
                            <p>quick_summary</p>
                        </div>
            </div>
        </div>
    </div>
</div> 
```

在我的 CSS 中，item-size 如下所示

```
 .item-size{
      width: 100%;
      height: 50%;
  } 
```

在上面的示例中，除了图像项的高度之外，一切都运行良好。每当我更改为不同的值（例如：60%）时，图像宽度都会发生变化，但高度值对尺寸没有任何影响。我试过用 .item-size 的 div 类包装元素，即使这样也没有任何效果。谁能帮助我如何设置会影响图像高度的高度值？

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T23:45:19.040

您不能按百分比指定高度，除非您为包裹 img 的标签设置了高度。所以你必须以像素为单位设置高度。前任。：

```
.item-size{
  width: 100%;
  height: 200px;
} 
```

如果你仍然想使用 % 你必须为 a 设置一个高度`wrapper div`。

# vim - Vim如何删除副本上的行号

> ID：15373792
> 
> 赞同：-1
> 
> 时间：2013-03-12T22:50:28.347
> 
> 标签：vim, command-line, copy, line-numbers

当我在我的 ssh 术语中使用 vim 复制行时，我总是有行号：

```
 1 <?php
 2 echo "test";
 3 
```

我尝试了很多事情，例如：

```
set mouse=a
set mousehide
set pastetoggle= 
```

我进入可视模式，它不会突出显示行号，但我无法复制。

我不想每次要复制某些东西时都取消设置数字并再次设置；）

是否存在脚本？像 autocmd 或类似的东西？

我在 Mac Os X 上，但我使用 vim 而不是 ssh (-clipboard)。

注意它不是重复的：复制时[如何清除 Vim 中的行号？](https://stackoverflow.com/questions/5728259/how-to-clear-the-line-number-in-vim-when-copying)

所以它是一个副本：[Scrolling inside Vim in Mac's Terminal](https://stackoverflow.com/questions/1727261/scrolling-inside-vim-in-macs-terminal)

如果版主可以（重新）链接吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-13T00:47:25.590

不要使用鼠标。复制到`+`寄存器而不是

```
:1,3y+ 
```

它将它复制到系统的剪贴板。为此，您的 vim 必须已使用剪贴板选项进行编译（即，选项中`:version`应该有`+clipboard`）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-13T07:45:51.143

大多数 Vim 可以与剪贴板交互；只需将文本拉入寄存器`"+`（或`"*`），请参阅`:help quoteplus`.

如果您绝对必须使用鼠标直接从终端复制，则必须暂时`:set nonumber`.

您可以编写一个映射来加快速度：

```
:nnoremap <Leader>n :set invnumber number?<CR> 
```

# jquery - jQuery 确认，然后使用 ajaxForm 发布

> ID：15373795
> 
> 赞同：1
> 
> 时间：2013-03-12T22:50:45.200
> 
> 标签：jquery, confirm

`ajaxForm`即使我按下`Cancel`按钮，以下 jQuery 代码也会执行该函数。此外，该`success`部分也不更新`content`. 谁能告诉我它有什么问题？谢谢。

```
$(document).ready(function() {
  $(".myForm").click(function (e) {
    if (confirm("Are you sure?")) {
      $(".myForm").ajaxForm ({
        success: function(returnData) {
          $('#content').html(returnData);
        }
      });
    }
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:06:48.757

应该在按钮元素上设置单击事件，并且应该使用`.ajaxSubmit()`，而不是`.ajaxForm()`。

该按钮不应该是提交按钮（即，`<input type="submit">`或`<button type="submit">`），否则您需要调用`e.preventDefault()`.

尝试这样的事情：

HTML：

```
<form id="myForm">
    <input type="text" />
    <button type="submit" id="submitButton">Submit</button>
<form> 
```

JavaScript：

```
$('#submitButton').click(function(e) {
    e.preventDefault();
    if (confirm('Are you sure?')) {
        $("#myForm").ajaxSubmit({
            success: function(returnData) {
                $('#content').html(returnData);
            }
        });
    }
}); 
```

# multithreading - “流程优先级”有多长时间了？（即Windows任务管理器设置进程优先级等）

> ID：15373799
> 
> 赞同：0
> 
> 时间：2013-03-12T22:51:03.930
> 
> 标签：multithreading, process

进程优先级是 Windows 还是旧的 linux 技术。

似乎 Windows 95 在任务管理器中没有进程优先级，但 Windows 2k 有。

我相信进程优先级 = 内核抢占......我一直在沿着这些方向搜索。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:33:23.760

绝对不是 Windows 技术。Linux`nice`从 1992 年开始，它是从 1969 年编写的 Unix 复制而来的，Unix 是一个超级简化的操作系统，基于 MULTICS 项目的想法，该项目肯定有这些想法，并于 1965 年开始。

进程优先级与抢占式多任务处理没有直接关系。事实上，一些早期的抢占式内核实现了固定优先级。自从发明内核的概念之前，内核抢占就以另一个名字而闻名：它被称为中断。（实时操作系统的现代内核抢占称为将用户态中断与传统硬件中断分开）。

使用过程优先级的最引人注目的例子之一发生在阿波罗 11 号任务中，该任务将尼尔·阿姆斯特朗送上月球。在着陆期间，配置错误的硬件开始在飞行控制计算机上运行任务。这使 CPU 过载。幸运的是，附加任务的优先级较低，因此被操作系统延迟或中止。这为关键的机动任务提供了足够的处理时间，以便机组人员对飞行器有足够的控制以安全着陆。阿波罗飞行控制计算机没有使用抢先式多任务处理。他们使用协同多任务处理和实时看门狗监视器（将其视为非常基本的原始内核）。尼尔·阿姆斯特朗于 1969 年登陆，阿波罗计划于 1961 年开始。

我有一种感觉，这个想法比 60 年代更早，并且可能起源于 IBM（计算领域的大多数想法都是，尽管其他人通常是第一个普及它们的人）。

* * *

## 补充回答：

好的，事实证明 MULTICS 是有史以来第一个作为操作系统编写的软件之一。该项目是麻省理工学院早期实验性操作系统 CTTS（兼容分时系统）的结果。当时多任务处理被称为分时。随着时间的推移，这两个词演变为同时运行多个进程的不同方面。

因此，进程优先级的概念与 50 年代末或 60 年代初开始的进程概念几乎同时被发明。当时对该领域的大部分研究都发生在麻省理工学院。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T22:58:40.657

抢先式多任务处理已经存在了很长一段时间。至少比家用电脑上的 Win/95 早十年，在大铁上更久。Amiga OS（80 年代中期）、Sinclair QDOS（大约在同一时间框架内）是使用它的消费者操作系统平台的几个例子。从“永远”开始，它就一直存在于 UNIX、VMS 等中。进程优先级可以追溯到很远，尽管我不知道哪个操作系统首先拥有它们。

# iphone - 在当前光标位置插入空格

> ID：15373802
> 
> 赞同：0
> 
> 时间：2013-03-12T22:51:20.493
> 
> 标签：iphone, ios, objective-c, uitextfield, uitextrange

我搜索了 stackoverflow 和网络，但找不到有用的东西。我有一个当你点击它时会插入一个空格，现在它会在光标位于中间时`UIButton`在末尾添加空格。`UITextField`

如何通过`UIButton`单击在当前光标位置添加空间？

提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:08:23.020

对于 iOS 5+，请尝试

```
[textField replaceRange:[textField selectedTextRange] withText:@" "]; 
```

# c# - 如何使用对象中指定的行/列将“ObservableCollection”绑定到网格？

> ID：15373803
> 
> 赞同：1
> 
> 时间：2013-03-12T22:51:26.833
> 
> 标签：c#, wpf, xaml

我在网格中有这样的东西：

```
 <Ellipse Grid.Row="{Binding Path=Game.Tiles[2].Row}"
             Grid.Column="{Binding Path=Game.Tiles[2].Column}"
             Fill="{Binding Game.Tiles[2].FillColor}"
             Stroke ="{StaticResource TileStroke}"></Ellipse> 
```

如何在不输入 24 次的情况下枚举所有 24 个对象？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T23:35:30.863

为了显示对象的列表/集合，您需要使用各种“ItemsControl”。在这种情况下，以下片段可能会有所帮助：

```
<ItemsControl ItemsSource="{Binding Game.Tiles}">
    <ItemsControl.ItemsPanel>
        <ItemsPanelTemplate>
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/> 
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
            </Grid>
        </ItemsPanelTemplate>
    </ItemsControl.ItemsPanel>
    <ItemsControl.ItemContainerStyle>
        <Style>
            <Setter Property="Grid.Column" Value="{Binding Column}" />
            <Setter Property="Grid.Row" Value="{Binding Row}" />
        </Style>
    </ItemsControl.ItemContainerStyle>
    <ItemsControl.ItemTemplate>
        <DataTemplate DataType="{x:Type local:Position}">
            <Ellipse Fill="{Binding FillColor}"
                     Stroke="{StaticResource TileStroke}"/>
        </DataTemplate>
    </ItemsControl.ItemTemplate>
</ItemsControl> 
```

请记住为 DataTemplate 放入正确的 DataType 和足够的行/列到 Grid 中以保存您的数据。

此外，包含未知数量的行/列也不是那么容易。如果您对此感兴趣，我可能会为您提供解决方案，但原始帖子读起来就像游戏板的想法 - 就像跳棋一样 - 所以我假设列/行的数量是恒定的。

# android - 可靠、轻量级的移动通信协议

> ID：15373809
> 
> 赞同：4
> 
> 时间：2013-03-12T22:51:44.730
> 
> 标签：android, networking, sensors, mqtt

我正在寻找在我的移动应用程序中使用的通信协议。第一个目标是Android，但如果它在iOS、OSX和Windows 8等其他平台上得到支持，实际上会非常好。主要目标是：

**它必须非常节能**，我们发送的消息实际上非常小并且大部分时间没有通信（它是用于感应的，并且更新不是很频繁）

**它应该支持间歇性连接并保证消息传递**对于应用程序来说不错过更新很重要

**应该能够支持部分或全部消息的加密一些**传感器数据包含隐私敏感信息

**不需要持续连接 **这样应用程序可以在不使用时进入睡眠状态。Google Cloud Messaging 在从服务器接收消息时效果很好，但问题是要从客户端发送一些东西而无需保持连接处于活动状态。

以前的版本使用 XMPP 和 JSON 消息，但我认为这是一个坏主意，因为它需要持续连接，而且它并不意味着节能。

我想使用 Protocol Buffers 而不是 JSON 来获得更紧凑的表示和更快的序列化，但我还没有决定传输。搜索时出现了MQTT，可能有道理，但它的加密支持不是很好，而且似乎需要保持连接。我想知道是否还有其他合适的候选人可以考虑。有什么建议或想法吗？

# c# - 从不同的线程调试

> ID：15373811
> 
> 赞同：2
> 
> 时间：2013-03-12T22:51:55.147
> 
> 标签：c#, .net, wpf, debugging

我有一个进度条，它绑定到“CurrProgress”和“Total”字段，如下所示：

```
 <ProgressBar Height="29" HorizontalAlignment="Left" Margin="12,32,0,0" Name="pbSendingData" VerticalAlignment="Top" Width="346"">
        <ProgressBar.Value>
            <Binding ElementName="this" Path="CurrProgress" />
        </ProgressBar.Value>
        <ProgressBar.Maximum>
            <Binding ElementName="this" Path="Total" />
        </ProgressBar.Maximum>
    </ProgressBar> 
```

我还有一个“工作线程”，它在尝试保持 UI 响应时正在做繁重的工作：

```
 private void worker_DoWork(object sender, DoWorkEventArgs e)
    {          
        const int sizeOfPacket = 30;
        Total = allEntries.Count();

        var arrayOfEntries = Split(allEntries, sizeOfPacket); //Split array into small arrays

        //Send parts to server separately:
        foreach (var entries in arrayOfEntries)
        {
            svc.ProcessPMData(Globals.username, Globals.password, entries.ToArray());
            CurrProgress += sizeOfPacket;
            Thread.Sleep(100);
        }

        Thread.Sleep(100);
    } 
```

我确保“Total”和“CurrProgress”依赖属性是线程安全的（尽管我可能没有正确完成）：

```
 //Dependency properties:
    public int CurrProgress
    {
        get
        {
            return (int)this.Dispatcher.Invoke(
                DispatcherPriority.Background,
                (DispatcherOperationCallback)delegate
                {
                    return GetValue(CurrProgressProperty);
                }, CurrProgressProperty);

        }

        set
        {
            this.Dispatcher.BeginInvoke(DispatcherPriority.Background,
                (SendOrPostCallback)delegate { SetValue(CurrProgressProperty, value); },
                value);
        }
    }

    public static readonly DependencyProperty CurrProgressProperty =
        DependencyProperty.Register("CurrProgress", typeof(int), typeof(DataSender), new PropertyMetadata(0));

    public int Total
    {
        get
        {
            return (int)this.Dispatcher.Invoke(
                DispatcherPriority.Background,
                (DispatcherOperationCallback)delegate
                {
                    return GetValue(TotalProperty);
                }, TotalProperty);

        }

        set
        {
            this.Dispatcher.BeginInvoke(DispatcherPriority.Background,
                (SendOrPostCallback)delegate { SetValue(TotalProperty, value); },
                value);
        }
    }

    public static readonly DependencyProperty TotalProperty =
        DependencyProperty.Register("Total", typeof(int), typeof(DataSender), new PropertyMetadata(0)); 
```

在尝试调试时，我首先尝试从即时窗口检查进度条的值：

```
pbSendingData.Value 
```

我收到此错误消息...

![在此处输入图像描述](../Images/9ec6a1cf132ba0e04e20ab74d52862ce.png)

这个错误是有道理的，所以我尝试了另一种方法：

```
this.Dispatcher.Invoke((Action)(() =>      {   MessageBox.Show(pbSendingData.Minimum);     })); 
```

此时我发现即时窗口不支持 lambda 表达式。

监视窗口也无济于事：

![在此处输入图像描述](../Images/cf1dd778443d8146f0f9c1d573d65f9d.png)

在调试时，我想从不同线程的即时/监视窗口中获取 UI 组件的值。这可能吗？作为旁注，如果我的代码中有任何可耻的地方，我愿意接受建议。我对 WPF 有点陌生。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T02:00:23.730

1.  您在进度条属性的绑定中指的是这个“this”元素是什么元素？

2.  我看到的大多数代码都使用来自工作线程的调度程序和委托，而不是在属性 getter/setter 中，因为这可能会导致一些丑陋的竞争条件和死锁或类似的讨厌的东西。

3.  “DoWork”方法似乎属于 BackGroundWorker 类。为什么不使用“报告进度”功能？它包括线程同步...

# android - 安卓启动画面坏了

> ID：15373817
> 
> 赞同：0
> 
> 时间：2013-03-12T22:52:27.047
> 
> 标签：android, splash-screen

我在这里用这个 youtube 视频教程制作了一个启动画面 ~> [http://www.youtube.com/watch?v=IHg_0HJ5iQo](http://www.youtube.com/watch?v=IHg_0HJ5iQo)

我保存了我的文件，并确保它们现在在那里，当我将它发送到我的设备时，启动画面没有出现..我不知道为什么。

这是我的 activity_main.xml 代码

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:background="@drawable/back_background"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:paddingBottom="@dimen/activity_vertical_margin"
    android:paddingLeft="@dimen/activity_horizontal_margin"
    android:paddingRight="@dimen/activity_horizontal_margin"
    android:paddingTop="@dimen/activity_vertical_margin"
    tools:context=".MainActivity" >

</RelativeLayout> 
```

这是我的 splash.xml 代码

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:background="@drawable/splash_background"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

</LinearLayout> 
```

这是我的清单文件

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.idoser"
android:versionCode="1"
android:versionName="1.0" >

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17" />

<application
    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >
    <activity
        android:name="com.example.idoser.MainActivity"
        android:label="@string/app_name" >
        <intent-filter>
            <action android:name="android.intent.action.MAIN" />

            <category android:name="android.intent.category.LAUNCHER" />
        </intent-filter>
    </activity>
</application>

</manifest> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:23:18.287

所以在聊天之后，我发现你的启动屏幕没有出现的原因是因为你没有对`splash.xml`布局文件做任何事情。如果您不放大您的初始布局或将其设置为内容视图，那么您将永远看不到它。

有几种方法可以做到这一点，但这是我将采取的方法：

*   创建一个 SplashActivity
*   将 SplashActivity 设为您的启动器 Activity。
*   使用计时器开始您的主要活动。

SplashActivity.java

```
package com.example.idoser;

import android.app.Activity;
import android.content.Intent;
import android.os.AsyncTask;
import android.os.Bundle;

public class SplashActivity extends Activity {

    AsyncTask<Object, Object, Object> mTimerTask;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.splash);
    }

    @Override
    protected void onResume() {
        super.onResume();

        if(mTimerTask != null) {
            mTimerTask.cancel(false);
            mTimerTask = null;
        }

        mTimerTask = new AsyncTask<Object, Object, Object>() {

            @Override
            protected Object doInBackground(Object... params) {
                try {
                    Thread.sleep(3000); /* 3 second splash screen */
                } catch(Exception e) { }

                return null;
            }

            @Override
            protected void onPostExecute(Object result) {
                super.onPostExecute(result);

                Intent intent = new Intent(SplashActivity.this, MainActivity.class);
                startActivity(intent);
                finish();
            }
        };
    }

    @Override
    protected void onPause() {
        super.onPause();

        if(mTimerTask != null) {
            mTimerTask.cancel(false);
            mTimerTask = null;
        }
    }

} 
```

AndroidManifest.xml

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.example.idoser"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="17" />

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.example.idoser.SplashActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <activity android:name="com.example.idoser.MainActivity"
            android:label="@string/app_name" >
        </activity>
    </application>
</manifest> 
```

请注意，这不是最好的方法，但它至少应该让你的启动画面显示出来，让你知道你需要去的方向。

# iphone - nsobject dealloc 从未调用过

> ID：15373820
> 
> 赞同：0
> 
> 时间：2013-03-12T22:52:39.030
> 
> 标签：iphone, objective-c, xcode, automatic-ref-counting, dealloc

我在循环的每次迭代中创建一个对象`for`。但是从不调用 dealloc 函数。它不应该在每次迭代时发布吗？我正在使用 ARC，并且我已停用 NSZombies。我没有看到任何循环引用。从 xcode 运行内存泄漏工具它不会显示任何泄漏，但是该类的指针内存永远不会被释放并且`dealloc`调用永远不会完成。知道为什么会发生这种情况吗？

谢谢！

```
for(int i=0; i<10; i++)
{
    //calculate the hog features of the image
    HogFeature *hogFeature = [self.image obtainHogFeatures];
    if(i==0) self.imageFeatures = (double *) malloc(hogFeature.totalNumberOfFeatures*sizeof(double));

    //copy the features
    for(int j=0; j<hogFeature.totalNumberOfFeatures; j++)
        self.imageFeatures[i*hogFeature.totalNumberOfFeatures + j] = hogFeature.features[j];
} 
```

类`HogFeature`声明如下所示：

```
@interface HogFeature : NSObject

@property int totalNumberOfFeatures;
@property double *features; //pointer to the features 
@property int *dimensionOfHogFeatures; //pointer with the dimensions of the features

@end 
```

和实施：

```
@implementation HogFeature

@synthesize totalNumberOfFeatures = _totalNumberOfFeatures;
@synthesize features = _features;
@synthesize dimensionOfHogFeatures = _dimensionOfHogFeatures;

- (void) dealloc
{
    free(self.features);
    free(self.dimensionOfHogFeatures);
    NSLog(@"HOG Deallocation!");
}

@end 
```

最后，对类别`obtainHogFeatures`内部的调用如下所示：`UIImage`

```
- (HogFeature *) obtainHogFeatures
{
    HogFeature *hog = [[HogFeature alloc] init];
    [...]
    return hog;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:58:07.503

您可能希望用一个`@autoreleasepool { ... }`告诉编译器何时进行处理的内部循环来封闭内部循环，否则只有在控制返回主循环时才会清空池。

```
for (i = 0; i < 10; i++) {
    @autoreleasepool {
        ...
    }
} 
```

正如CodeFi在评论中指出的那样：这将为循环的每次迭代创建一个新的自动释放池，这将在迭代完成后销毁每个对象，但会使程序做更多的工作。如果你不介意在循环完成之前所有的物体都挂在外面，你可以把`@autoreleasepool`外循环的外面

```
@autoreleasepool {
    for (i = 0; i < 10; i++) {
        ...
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:46:36.023

物体粘在周围的原因是它们没有被释放。我没有看到 self.imageFeatures 的声明 - 这是一个数组吗？如果将特征放入数组中，只要它们保留在数组中或数组本身没有释放，它们就不会被释放。

我对使用 C malloc 和（尝试的）免费调用有点困惑。这里很可能有一个我不知道的动机，但是，鉴于您提供的内容，这就是我将如何编写此代码的方式，如果没有按预期触发 dealloc，我会感到惊讶：

```
 NSMutableArray *features = [[NSMutableArray alloc] init];

    for (int i = 0; i < 10; i++)
    {
        NSArray *hogFeatureArray = [[self image] obtainHogFeatures];
        for (HogFeature *feature in hogFeatureArray)
        {
            [features addObject:hogFeature];
        } 
    }

    [self setImageFeatures:features]; 
```

imageFeatures 属性是：

```
@property (nonatomic, retain) NSMutableArray *imageFeatures; 
```

假设您已将所有 hog 特征实例放入此 imageFeatures 数组，它们将由该 imageFeatures 数组保留。为了观察你的 dealloc 的作用，需要发生以下两件事之一：你需要从数组中删除一个 hog 特性，或者你需要释放数组本身（这可以通过将指针设置为 nil 来完成）：

```
[self setImageFeatures:nil] // Previously assigned array now released
[[self imageFeatures] removeAllObjects]; // Works alternatively 
```

# c++ - 模板默认参数

> ID：15373823
> 
> 赞同：190
> 
> 时间：2013-03-12T22:52:49.763
> 
> 标签：c++, templates

如果允许我执行以下操作：

```
template <typename T = int>
class Foo{
}; 
```

为什么我不允许在 main 中执行以下操作？

```
Foo me; 
```

但我必须指定以下内容：

```
Foo<int> me; 
```

C++11 引入了默认模板参数，现在我完全无法理解它们。

* * *

## 回答 #1

> 赞同：235
> 
> 时间：2013-03-12T22:53:22.867

***笔记：***

`Foo me;`从 C++17 开始，没有模板参数是合法的。请参阅此答案：[https](https://stackoverflow.com/a/50970942/539997) ://stackoverflow.com/a/50970942/539997 。

***适用于 C++17 之前的原始答案：***

你所要做的：

```
Foo<> me; 
```

模板参数必须存在，但您可以将它们留空。

把它想象成一个`foo`只有一个默认参数的函数。该表达式`foo`不会调用它，但`foo()`会调用它。参数语法必须仍然存在。这与那是一致的。

* * *

## 回答 #2

> 赞同：98
> 
> 时间：2018-06-21T14:26:01.327

使用 C++17，您确实可以。

此功能称为[类模板参数推导](http://en.cppreference.com/w/cpp/language/class_template_argument_deduction)，并为您声明*模板类型*变量的方式增加了更多灵活性。

所以，

```
template <typename T = int>
class Foo{};

int main() {
    Foo f;
} 
```

现在是[合法的 C++ 代码](https://wandbox.org/permlink/WEDMxX2C4G19yujd)。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2015-11-18T10:34:28.473

你不能这样做，但你可以这样做

```
typedef Foo<> Fooo; 
```

然后做

```
Fooo me; 
```

* * *

## 回答 #4

> 赞同：21
> 
> 时间：2013-03-12T22:53:29.503

您可以使用以下内容：

```
Foo<> me; 
```

并`int`成为您的模板参数。尖括号是必须的，不能省略。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2022-02-03T05:26:18.193

根据`C++17`标准，必须传递模板参数。

但是，如果您仍然想要解决此问题，请`#define`像这样使用：

```
template <typename T>
class Foo{
};

#define IFoo Foo<int> 
```

***快速提醒***

> 预处理器不利于调试。

# c# - 控制台计算应用程序仅返回 0

> ID：15373834
> 
> 赞同：1
> 
> 时间：2013-03-12T22:53:24.877
> 
> 标签：c#, asp.net-mvc, console-application

所以我对编码相当陌生，我只是把 0 拉回来作为回报。我在运行它时输入了 10000 5 和 10 作为我的 3 个输入，除了所有三个字段的 0 之外，我无法从它返回任何东西。我想也许我的程序想要一个变量的起点，所以我将它们全部声明为 0 开始，但它仍然不起作用。

```
int AIR, MIR, PMT, IP, PP, ABorrowed, Term;
        AIR = 0;
        MIR = 0;
        PMT = 0;
        IP = 0;
        PP = 0;
        ABorrowed = 0;
        Term = 0;

        Console.WriteLine("Please enter the amount borrowed on your loan ");
        ABorrowed = int.Parse(Console.ReadLine());
        Console.WriteLine("Please enter the interest rate for your loan ");
        AIR = int.Parse(Console.ReadLine());
        Console.WriteLine("Please enter term of your loan in months ");
        Term = int.Parse(Console.ReadLine());
        MIR = AIR / 12;
        PMT = ABorrowed * (MIR/((1-(1/(1+MIR))^Term)));
        IP = ABorrowed * MIR;
        PP = PMT - IP;
        Console.WriteLine("Your total payment for this month is " + PMT);
        Console.WriteLine("Of that payment " + IP + " is interest rate");
        Console.WriteLine("and the Payment Portion is " + PP);
        Console.ReadLine(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T22:57:46.790

此代码中有几个与您的描述相关的问题：

1.  您正在使用整数除法
2.  您（很可能）使用`^`不正确

首先，整数除法返回一个整数，意思是：

```
10 / 3 = 3 
```

`decimal`如果你使用而不是`int`你的类型，你更有可能得到正确的结果。

此外，您`^`在那里使用，我认为这是您将某些东西提升到其他东西的力量的方式，但`^`它是`XOR`操作员，它完全做其他事情。

要在 C#/.NET 中将某些东西提升到其他东西的力量，您可以使用[Math.Pow](http://msdn.microsoft.com/en-us/library/system.math.pow.aspx)：

```
PMT = ABorrowed * (MIR/((1-Math.Pow((1/(1+MIR)), Term)))); 
```

（我*想*我设法将 Math.Pow 调用放置在此处的正确部分周围）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T22:55:12.933

这里的核心问题是您正在使用`int`. 这种类型只能表示整数，不利于财务计算。在计算金钱使用`decimal`而不是`int`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T22:58:33.190

使用 decimal 而不是 int 并且`^`它的力量不是排他性的，或者我怀疑这就是你想要的。而是使用`Math.Pow`

实际上，查看代码可以避免一些麻烦，使用`var`而不是在开始时声明所有内容。

```
 Console.WriteLine("Please enter the amount borrowed on your loan ");
    var ABorrowed = decimal.Parse(Console.ReadLine());
    Console.WriteLine("Please enter the interest rate for your loan ");

    var AIR = decimal.Parse(Console.ReadLine());
    Console.WriteLine("Please enter term of your loan in months ");

    var Term = decimal.Parse(Console.ReadLine());
    var MIR = AIR / 12;
    var PMT = ABorrowed * (MIR/((1-Math.Pow((1/(1+MIR)), Term))));
    var IP = ABorrowed * MIR;
    var PP = PMT - IP;

    Console.WriteLine("Your total payment for this month is " + PMT);
    Console.WriteLine("Of that payment " + IP + " is interest rate");
    Console.WriteLine("and the Payment Portion is " + PP);
    Console.ReadLine(); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-12T22:55:52.880

除法运算符“/”截断为最接近零的整数，因此对 MIR 的赋值会破坏所有内容。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-12T22:58:34.750

您已将变量声明为 INT，因此如果您输入 5，`AIR`则将`MIR = AIR / 12`为零，因为 5/12 将转换为零。因此`PMT`，and`IP`将为零，并且`PP`将为零。

您应该使用`decimal`, 而不是`int`您的变量类型。

# php - 如何从 Wordpress 中的 display_name 中提取 userId？

> ID：15373838
> 
> 赞同：-1
> 
> 时间：2013-03-12T22:53:33.020
> 
> 标签：php, mysql, sql, wordpress

我正在构建一个自动完成功能，允许内部网站的用户在帖子中标记其他 wordpress 用户。我已经构建了一个 ajax/jquery/php 机制来执行此操作，它在查找和检索用户显示名称方面效果很好。

但是，查看此图表 - 取自 wordpress [Codex 站点](http://codex.wordpress.org/images/9/9e/WP3.0-ERD.png)，似乎实际`userId`存储在 中`wp_usermeta`，而不是与 display_name 在同一个表中（我在那里只看到一个 ID - 那是用户 ID 吗？）。

如果那不是用户 ID，我如何获得它？我的 sql 不是很好 - 至少对于连接来说不够好，所以，如果需要连接，我会很感激实际的 SQL 代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T22:58:51.140

尝试这个：

```
$user = get_userdatabylogin('username');
echo $user->ID; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:06:45.647

您应该使用以下[`get_user_by()`](http://codex.wordpress.org/Function_Reference/get_user_by)功能：

```
$user = get_user_by('login', $user_login);    // depends on what information you have available exactly
var_dump($user); 
```

# html - 创建大地图时如何保持画布快速？

> ID：15373842
> 
> 赞同：0
> 
> 时间：2013-03-12T22:54:05.237
> 
> 标签：html, performance, canvas, kineticjs

我正在尝试使用 HTML5 和画布创建游戏。目前我正在使用 KineticJS 库。

到目前为止，我所做的事情是放大和缩小，从舞台内的图层拖动，以及从一些对象拖动。这一切都很好而且很快。

但是，游戏还需要一个景观，人们可以在其中建造房屋、麦田等。还需要一些树木和其他细节。这一切都让画布非常饱满。

因此，为了进行测试，我制作了一个 10000 x 10000 像素的画布层，并将其制作成 100 x 100 的 100 x 100 像素的图块。只是这花了很多时间，甚至没有加载。

所以我用更少的瓷砖（25 x 25）尝试了它，它确实加载了，但是当我尝试缩放、拖动舞台或拖动一个对象时，它非常非常慢，而且它都需要包含更多的对象。

所以主要问题是：任何人都可以向我咨询哪种方法最适合上述故事吗？画布是正确的选择，还是有其他（和更好的）选择？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T13:30:45.397

我找到了一个完美的解决方案！

我打算将画布与一些常规的 HTML（如 div）结合起来。我做了这个，它在这个 div 中创建了一个 15000x15000 像素的字段，我创建了 225 个新的 div，其中将包含画布对象。每个画布对象的大小为 100x100 像素。

总加载时间约为 4 秒，我将使用一些 javascript 和 div 构建缩放、拖动。

```
<!DOCTYPE HTML>
<html>
<head>

    <style>
        body,html {
            margin: 0px;
            padding: 0px;
        }
        #container{
            width: 15000px;
            height: 15000px;
        }
        .canvas{
            float: left;
            margin: 0px;
            padding: 0px;
            height: 1000px;
            width: 1000px;
        }
    </style>

    <script src="/js/jquery.js"></script>
    <script src="/js/kinetic.js"></script>

</head>
<body>
<div id="zoomer" style="position: absolute;"></div>
<div id="container">
    <?php for ($x = 1;$x<=15;$x++){?>
        <?php for ($y = 1;$y<=15;$y++){?>
            <div class="canvas" id="blok<?php echo $x;?>-<?php echo $y;?>"></div>
        <?php } ?>
    <?php } ?>
</div>
<script>
    var bk = {};
    $.each($(".canvas"),function(){

        var id = this.id;
        bk[id] = new Kinetic.Stage({
            container: this.id,
            width: 1000,
            height: 1000
        });

        var ly = new Kinetic.Layer();

        for(x = 0;x<10;x++){
            for(y = 0;y<10;y++){
                var r = Math.random();
                var g = Math.random();
                var b = Math.random();

                var tile = new Kinetic.Rect({
                    width: 100,
                    height: 100,
                    x: x * 100,
                    y: y * 100,
                    fill: "rgb("+ parseInt(255*r) +","+ parseInt(255*g) +","+ parseInt(255*b) +")"
                });
                ly.add(tile);
            }

        }
        ly.draw();

        bk[id].add(ly);

    });

</script>
</body>
</html> 
```

无论如何，感谢您的努力！

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T23:20:20.343

10,000 x 10,000 像素的地图太大了。

从概念上讲，这很好。诀窍是不要保留/绘制整个事物！即，即使您的地图那么大，您也只能在角色周围绘制/更新 500 x 500 像素或任何视口的图块/对象`.`

请参阅[这篇文章](https://stackoverflow.com/q/11406161/577306)，以及西蒙的回答来实现这一点。

这是与答案相关的[示例 jsFiddle](http://jsfiddle.net/kmHZt/10/) *（完全归功于 Simon Sarris）*。

# .net - 泛型和松耦合：Can 类 在没有类型假设的情况下解耦？

> ID：15373849
> 
> 赞同：2
> 
> 时间：2013-03-12T22:54:47.560
> 
> 标签：.net, generics, reflection, dependency-injection, loose-coupling

我一直在玩松耦合我的数据访问层。我发现依赖注入过程很有帮助，但在考虑使用泛型时遇到了一些难题。

有没有办法让一个支持泛型类型参数的类真正解耦和类型安全？我担心的是，即使您写入一个公共接口，如果派生类型与您最初编码的实体不同，那么您可能会遇到一些编译器可能无法捕获的令人讨厌的运行时错误。

问题是，当我编写代码以从数据库中获取数据并为我的对象添加水合物时，我在尝试在下一层上实现它时遇到了一个难题。如果我传入下面的 Foo2 之类的类，我可以破坏我的代码，因为没有“隐式”转换。我一直在使用反射来尝试放松，但我不断回到从数据库中获取数据时需要对具体类型进行水合的问题。然后，该类型会在转换和类型保证方面产生问题。此外，如果我想为我的实体库中的所有许多类型抽象所有方法，我可以通过反射来做到这一点，但我仍然遇到泛型只能对显式“where T: ISomeInterface”语句做出类型保证的问题. 最后，如果我们有更多的派生类型或者从接口分支形成新类型的类型，这个模型就会崩溃。认为我需要为曾经做过的每一种类型实现新的数据访问对象会迫使数据访问层发生变化。这打破了我对松散耦合的定义。

所有这一切似乎迫使我回到这个问题——泛型可以以真正松耦合的方式使用吗？如果是这样，您可以提供哪些参考资料？

简化示例：

```
public interface IEntity
{
    // stuff for state and methods ...
}
public interface IRepository<T> where T : IEntity
{
    void Save(out int id, T obj);
    T Load(int id);
}
public interface IFoo : IEntity
{
    int Id { get; set; }
    //All other IEntities goodness
    //Some new goodness specific to Foo
}
//Concrete Entities:
public class Foo : IFoo
{
    // blah blah
}
public class Foo2 : IFoo
{
    // new blah blah
}

public class FooRepository : IRepository<Foo> //OOPS, Looks like we have settled in on a concrete type!
{

    public void Save(out int id, Foo obj)
    {
        // ADO.NET code to access Sql ...
        id = 1;// this would actually be the result of the Sql insert output parameter
        return;
    }

    public Foo Load(int id)
    {
        Foo foo = new Foo();
        // ADO.Net code to access Sql
        return foo;
    }
} 
```

那么，您将如何处理可以处理任何 IFoo 派生对象并且仍然能够返回完全形成的具体类型的代码，而不管程序员在路上做什么？最好放弃通用部分并坚持依赖注入吗？任何参考资料、指导等都会很棒。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:45:44.610

对于您在此处遇到的问题，您始终可以使用`typeof`（或者可能是不同的运算符/方法）来获取对象的动态类型。这样，您始终可以在遇到一些转换错误之前执行检查。

您可以将具体类型限制设置为顶级类型，但这确实违背了泛型的目的。

否则，我真的不知道如何克服你的问题。如果您使用泛型，重点是添加松散耦合和与类型无关的泛型操作。你可以检索它的唯一方法是你 typeof 然后重铸，捕捉边缘情况以防止铸造错误。关于你的问题：

> 可以以真正松耦合的方式使用泛型吗？

我不太明白你的意思？从你的问题的语义上，你当然可以。这实际上是泛型的目的之一。

> 那么，您将如何处理可以处理任何 IFoo 派生对象并且仍然能够返回完全形成的具体类型的代码，而不管程序员在路上做什么？

这也是相当模糊的。我可以写：

```
public SomeType method(IFoo obj)
{
...
} 
```

这仍然可以处理任何 IFoo。你不需要泛型。如果你想具体返回你传入的任何类型，那么：

```
public T method<T>(IFoo obj) where T:IFoo
{
    return (T)obj;
} 
```

希望这可以帮助。LMK 如果我弄错了。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:57:47.500

我不得不承认对您的难题感到有些困惑；我不确定它可能是什么。

生成具体类型的存储库显然必须知道如何创建它们。为什么不为每种类型创建一个存储库，以便每个都实现`IRepository<IFoo>`？这样，您可以将具体实现留给 DI 容器的配置。

例如，在 ninject 我会写一些类似于

```
Bind<IRepository<IFoo>>.To<Foo2Repository>() 
```

设置它。如果您需要更细粒度的控制，我所知道的大多数容器都支持某种范围界定方式，以便绑定仅在某些条件下有效。

我是否误解了什么，或者这是否解决了您的担忧？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T23:59:59.573

你可以定义常见的东西

```
class BaseFooRepository<TFoo> : IRepository<TFoo> where TFoo : IFoo 
```

然后将更具体的代码放入

```
class Foo2Repository : BaseFooRepository<Foo2> 
```

# c# - C# 使用自动增量获取插入 id

> ID：15373851
> 
> 赞同：14
> 
> 时间：2013-03-12T22:54:56.157
> 
> 标签：c#, mysql, .net, sql

我正在使用这种方法在表中插入一行：

```
 MySqlConnection connect = new MySqlConnection(connectionStringMySql);
            MySqlCommand cmd = new MySqlCommand();

            cmd.Connection = connect;
            cmd.Connection.Open();

            string commandLine = @"INSERT INTO Wanted (clientid,userid,startdate,enddate) VALUES" +
                "(@clientid, @userid, @startdate, @enddate);";
            cmd.CommandText = commandLine;

            cmd.Parameters.AddWithValue("@clientid", userId);
            cmd.Parameters.AddWithValue("@userid", "");
            cmd.Parameters.AddWithValue("@startdate", start);
            cmd.Parameters.AddWithValue("@enddate", end);

            cmd.ExecuteNonQuery();
            cmd.Connection.Close(); 
```

我也有 id 列`Auto Increment`。我想知道是否可以获得插入新行时创建的 id。

* * *

## 回答 #1

> 赞同：31
> 
> 时间：2013-03-12T23:03:34.757

您可以访问 MySqlCommand LastInsertedId 属性。

```
cmd.ExecuteNonQuery();
long id = cmd.LastInsertedId; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:06:21.120

```
MySqlConnection connect = new MySqlConnection(connectionStringMySql);
MySqlCommand cmd = new MySqlCommand();

cmd.Connection = connect;
cmd.Connection.Open();

string commandLine = @"INSERT INTO Wanted (clientid,userid,startdate,enddate) "
    + "VALUES(@clientid, @userid, @startdate, @enddate);";
cmd.CommandText = commandLine;

cmd.Parameters.AddWithValue("@clientid", userId);
**cmd.Parameters["@clientid"].Direction = ParameterDirection.Output;**
cmd.Parameters.AddWithValue("@userid", "");
cmd.Parameters.AddWithValue("@startdate", start);
cmd.Parameters.AddWithValue("@enddate", end);

cmd.ExecuteNonQuery();
cmd.Connection.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T23:04:46.240

基本上你应该把它添加到你的命令文本的末尾：

```
SET @newPK = LAST_INSERT_ID(); 
```

并添加另一个 ADO.NET 参数“newPK”。命令执行后，它将包含新的 ID。

# css - 用于移动优化的媒体查询

> ID：15373854
> 
> 赞同：0
> 
> 时间：2013-03-12T22:55:21.647
> 
> 标签：css, mobile, media-queries

我已将以下内容添加到我的网站以定位手机/标签等：

```
<link href="assets/styles/phone.css" rel="stylesheet" type="text/css" media="only screen and (min-width: 0px) and (max-width: 640px)" >
<link href="assets/styles/tablet.css" rel="stylesheet" type="text/css" media="only screen and (min-width: 641px) and (max-width: 768px)" >
<link href="assets/styles/main.css" rel="stylesheet" type="text/css" media="only screen and (min-width: 769px)" > 
```

样式表在浏览器中动态变化时显然可以工作，但是我测试过的移动设备仍然针对主要样式表，而不是移动版本。

有什么建议么？

干杯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T00:49:06.727

Apple 设备使用`min-device-width`并`max-device-width`尝试添加

`<meta name="viewport" content="width=device-width, initial-scale=1 />`

到你的标题。

希望这可以帮助

# ruby-on-rails - 如何托管 Rails Web 应用程序

> ID：15373856
> 
> 赞同：5
> 
> 时间：2013-03-12T22:55:40.697
> 
> 标签：ruby-on-rails, ruby, hosting, web-hosting

我使用 Rails 开发了一个漂亮的 Web 应用程序，并希望托管它。不幸的是，我不确定如何廉价地托管我的应用程序。我知道各种部署工具，例如 capistrano，而且我也使用 Heroku。我认为这些工具有助于托管。

但是，谁能为我提供详细的托管 Web 应用程序的步骤，尤其是使用 rails 以及我可以使用哪些选项？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T23:08:17.927

*编辑*

有人向我指出，我的答案中的链接不再有效。这并不奇怪，因为这是一个 3 岁的答案。因为似乎人们仍然对这个答案感到困惑，所以我想将人们重定向到这个页面：

[https://gorails.com/deploy/ubuntu/16.04](https://gorails.com/deploy/ubuntu/16.04)

它应该包含部署 Rails 应用程序所需的所有信息。

*结束编辑*

我建议你检查一下

[http://rubyonrails.org/deploy](http://rubyonrails.org/deploy)

开始。

还有 [http://www.cloudfoundry.com/](http://www.cloudfoundry.com/) 和 [https://www.engineyard.com/](https://www.engineyard.com/)

对于任何 Rails 应用程序来说，它们都是很棒的主机，而且它们也有一些非常容易遵循的分步教程来说明如何做到这一点。

正如 Leito 在他的回答中提到 Heroku 一样，我想向您指出 [http://www.codeschool.com/code_tv/heroku](http://www.codeschool.com/code_tv/heroku)

如果您选择 Heroku 作为您的主机，您可以观看该视频，因为它向您展示了如何部署一个简单的 Rails 应用程序。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-12T23:01:07.710

Heroku 在我看来是最简单的，我建议你从这里开始[https://devcenter.heroku.com/articles/rails3](https://devcenter.heroku.com/articles/rails3)

Heroku 更像是一个应用程序托管，并使用 git 来部署您的应用程序，因此不需要 capistrano 或类似工具。

# python - 如何编写多频音频文件？

> ID：15373859
> 
> 赞同：2
> 
> 时间：2013-03-12T22:55:41.903
> 
> 标签：python, linux, audio, wav

我正在尝试使用 440hz 到 600hz 的音调编写音频文件。该文件应从 440hz 开始，然后播放每个频率（按递增顺序）1 秒，以 600hz 结束。我想出了python的wave模块，但是在这里做错了，因为我最终得到了一个没有声音的文件。（如果有人有更好的建议，我真的不在乎它是否在 python 中。我正在使用 Linux，任何可以在该平台上运行的东西都可以。我只需要创建一个具有上述规格的音频文件。谢谢！）

```
frequencies = range(440,600)
data_size = len(frequencies)
fname = "WaveTest.wav"
frate = 11025.0  # framerate as a float
amp = 64000.0     # multiplier for amplitude

sine_list_x = []
for f in frequencies:
    for x in range(data_size):
        sine_list_x.append(math.sin(2*math.pi*f*(x/frate)))

wav_file = wave.open(fname, "w")

nchannels = 1
sampwidth = 2
framerate = int(frate)
nframes = data_size
comptype = "NONE"
compname = "not compressed"

wav_file.setparams((nchannels, sampwidth, framerate, nframes,
    comptype, compname))

for s in sine_list_x:
    # write the audio frames to file
    wav_file.writeframes(struct.pack('h', int(s*amp/2)))

wav_file.close() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:19:52.093

像这样的东西应该可以工作：希望它至少是你继续的一个好的起点。

```
import numpy as N
import wave

towrite = ''
for freq in xrange(440,600):
     duration = 1
     samplerate = 44100
     samples = duration*samplerate
     period = samplerate / float(freq) # in sample points
     omega = N.pi * 2 / period

     xaxis = N.arange(samples,dtype = N.float)
     ydata = 16384 * N.sin(xaxis*omega)

     signal = N.resize(ydata, (samples,))

     towrite += ''.join([wave.struct.pack('h',s) for s in signal])

 f = wave.open('freqs.wav', 'wb')
 f.setparams((1,2,44100, 44100*4, 'NONE', 'noncompressed'))
 f.writeframes(towrite)
 f.close() 
```

[参考](http://codingmess.blogspot.com/2008/07/how-to-make-simple-wav-file-with-python.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:32:37.040

它在 Windows 平台上对我来说似乎工作正常：

![440 Hz 信号开始](../Images/679a03ddaa36c538d0a1f2df0d3eb253.png)

![600 Hz 信号结束](../Images/ab03917b0c896bb90434e789aaa10998.png)

采样得到尊重，频率恰到好处（从 440 到 600 Hz）。但是，在您的代码中，频率不会停留一秒钟，而是停留在 len(frequencies)/frate-th of second。如果您希望每个频率都有一整秒，data_size 应该等于 frate。

```
import math
import wave
import struct

frequencies = range(440,600)
duration = 1 #in second
fname = "WaveTest.wav"
frate = 11025.0  # framerate as a float
amp = 64000.0     # multiplier for amplitude

sine_list_x = []
for f in frequencies:
    for x in range(duration*frate)  :
        sine_list_x.append(math.sin(2*math.pi*f*(x/frate)))

wav_file = wave.open(fname, "w")

nchannels = 1
sampwidth = 2
framerate = int(frate)
nframes = data_size
comptype = "NONE"
compname = "not compressed"

wav_file.setparams((nchannels, sampwidth, framerate, nframes,
    comptype, compname))

for s in sine_list_x:
    # write the audio frames to file
    wav_file.writeframes(struct.pack('h', int(s*amp/2)))

wav_file.close() 
```

# codenameone - 如何让 imagedownloadservice 与 codenameone 中的多列表组件一起使用？

> ID：15373866
> 
> 赞同：1
> 
> 时间：2013-03-12T22:56:21.227
> 
> 标签：codenameone

我在 GUI Designer 中创建了一个多列表。我将模型设置如下

```
 @Override
protected boolean initListModelMultiIssueList(List cmp) {
    fetchIssues(cmp);
    if (issueVector != null ) {
    cmp.setModel(new DefaultListModel(issueVector));
    System.out.println(cmp);
    }
    return true;
}
void fetchIssues( List c){
    //fetch issues based on the searchquery hash
    //first thing is to create the query from the hash
    System.out.println("Starting to fetch results");
    try{
        java.util.List<ServiceRequest> serviceRequests = ServiceRequest.getServiceRequests(formQuery(searchQuery),true);
        //we need to now populate the issueVector
        //with the data
        System.out.println(serviceRequests.toString());
        if (issueVector != null ) {
            issueVector.clear();
        } else {
            issueVector = new Vector();
        } 
        int index = 0;
        for (ServiceRequest serviceRequest : serviceRequests) {
                Hashtable hIssue = new Hashtable();
                hIssue.put("id",serviceRequest.getHref());
                //System.out.println(hIssue); 

                ImageDownloadService.createImageToStorage(serviceRequest.getRequestPictureURL().toString(),
                        c, index, "icon", 
                        "service-icon-"+ index ,null);
                //hIssue.put("icon", serviceRequest.getRequestPictureURL().toString());
                //System.out.println(hIssue);
                //reverse geocode the location
                Double x = new Double(0.0);
                x=new Double(serviceRequest.getRequestLocationLatitude());
                Double y = new Double(serviceRequest.getRequestLocationLongitude());
                String location=reverseGeocode(x, y);
                hIssue.put("location", location);
                //System.out.println(hIssue);
                Service service = serviceRequest.loadService();
                hIssue.put("service", serviceRequest.loadService().getName().toString());
                hIssue.put("reportedOn",serviceRequest.getCreatedAt().toString());
                //System.out.println("Final hIssue" + hIssue.toString());
                issueVector.add(hIssue);
                index=index+1;
                System.out.println(issueVector);
        }

    }catch (Exception e){
        System.out.println("Error loading search results");
        System.out.println(e);
    }
} 
```

多列表 GUI 设计中的图标已设置为适当的属性。ImageDownloadService 确实下载了图像文件，但它没有按预期显示在列表中。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-15T13:18:20.393

可能在条目可用之前下载了图像。虽然很难用代码来判断并且没有对症状的明确解释。

您需要首先创建模型并将其设置到列表中（最好使用空白占位符图像，这样列表就不会“跳跃”）。那么就需要遍历列表并调用图片下载服务，否则可能会在数据还没到列表之前就返回而失败！如果图像已经在缓存中，则可能会发生这种情况，因此在这种情况下它很可能会快速失败。

# c# - .NET 的任何高级数据绑定库

> ID：15373873
> 
> 赞同：0
> 
> 时间：2013-03-12T22:57:04.490
> 
> 标签：c#, .net, winforms

是否有任何库可以让我做一些事情，比如将一个对象中的属性绑定到另一个对象中两个属性的最大值？或者将它绑定到列表中每个对象内特定属性的每次出现的总和？

或者将一个列表绑定到另一个列表，这样两个列表都是同步的，并且目标列表中的每个元素始终在源列表中具有相应的元素，而源列表中每个对象的特定属性都绑定到中每个元素的特定属性目标清单？

总而言之，有没有高级的数据绑定库？这将使编码变得更加容易。

我相信 WPF 比 WinForms 具有更高级的数据绑定，但如果你要建议我切换到 WPF，我正在开发一个已经开发的 WinForms 项目，所以我需要一个现有的库或者需要自己编写它。

**更新：**我刚刚启动了[这个 github](http://github.com/jsoldi/Bindings)，以防其他人发现它有用。它仍然需要做很多工作，但已经可以使用了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T00:06:35.600

Microsoft Reactive Extensions 库 ( [http://msdn.microsoft.com/en-us/data/gg577609.aspx](http://msdn.microsoft.com/en-us/data/gg577609.aspx) ) 不是特定于 UI 的，但可以提供一个中间层来帮助您实现您所说的许多目标。

# python - Python中的礼物包装算法永远不会终止

> ID：15373875
> 
> 赞同：0
> 
> 时间：2013-03-12T22:57:17.207
> 
> 标签：python, algorithm, geometry

我一直在尝试在 Python 中实现礼品包装算法，我目前有以下代码：

```
def createIslandPolygon(particleCoords):

    startPoint = min(particleCoords.iteritems(),key = lambda x: x[1][1])[1]

    check = 1

    islandPolygon = []

    particleList = []

    for key in particleCoords:

        particleList.append(particleCoords[key])

    currentPoint = startPoint

    while(currentPoint != startPoint or check == 1):

        islandPolygon.append(currentPoint)

        check = 0

        angleDict = {}
        angleList = []

        for point in particleList:

            if point != currentPoint:

                angleDict[(angleBetweenTwoPoints(currentPoint, point))] = point
                angleList.append(angleBetweenTwoPoints(currentPoint, point))

        smallestAngle = min(angleList)

        currentPoint = angleDict[smallestAngle]

    return islandPolygon 
```

并用于计算极坐标：

```
def angleBetweenTwoPoints(p1, p2):

    p3 = (p1[0], p1[1] + 2)

    a = (p1[0] - p2[0], p1[1] - p2[1])
    b = (p1[0] - p3[0], p1[1] - p3[1])

    theta = ((a[0]*b[0]) + (a[1]*b[1]))
    theta = theta / (sqrt((a[0]*a[0]) + (a[1]*a[1])) * sqrt((b[0]*b[0]) + (b[1]*b[1])))
    theta = math.acos(theta)

    return theta 
```

问题是代码似乎永远不会离开 while 循环，我不知道为什么。有谁有想法吗？

谢谢。

（是的，代码很粗制滥造，我只是快速将它们拼凑在一起）

编辑：打印出坐标似乎表明它们只在两个坐标之间跳跃。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:08:57.033

根据[http://en.wikipedia.org/wiki/Gift_wrapping_algorithm](http://en.wikipedia.org/wiki/Gift_wrapping_algorithm)你需要这样做：

```
 pointOnHull = leftmost point in S
   i = 0
   repeat
      P[i] = pointOnHull
      endpoint = S[0]         // initial endpoint for a candidate edge on the hull
      for j from 1 to |S|-1
         if (endpoint == pointOnHull) or (S[j] is on left of line from P[i] to endpoint)
            endpoint = S[j]   // found greater left turn, update endpoint
      i = i+1
      pointOnHull = endpoint
   until endpoint == P[0]      // wrapped around to first hull point 
```

你有这个正确的：

```
 pointOnHull = leftmost point in S 
```

还有这个：

```
 P[i] = pointOnHull 
```

但这是我不确定的部分：

```
 (S[j] is on left of line from P[i] to endpoint) 
```

相反，您会在它与所有其他点形成的所有角度中找到*最小的角度。*但根据维基百科，你想要的是它与所有其他点形成的所有角度中*最左边的角度。*我有一些处理角度的代码：

```
def normalizeangle(radians):
    return divmod(radians, math.pi*2)[1]

def arclength(radians1, radians2 = 0):
    radians1, radians2 = normalizeangle(radians1), normalizeangle(radians2)
    return min(normalizeangle(radians1 - radians2), normalizeangle(radians2 - radians1))

def arcdir(radians1, radians2 = 0):
    radians1, radians2 = normalizeangle(radians1), normalizeangle(radians2)
    return cmp(normalizeangle(radians1 - radians2), normalizeangle(radians2 - radians1)) 
```

`arcdir`将告诉您一个角度是在另一个角度的左侧还是右侧，因此您可以使用它来查看一个角度是否更左侧，因此应该使用。

如果您沿着点移动总是选择最左边的角度到下一个点，您将绕过多边形的周边并再次到达起点（因为您选择了最左边的点，您知道它必须在周边上并且会再次到达）

# api - 如何使用 mediawiki API 登录？

> ID：15373876
> 
> 赞同：1
> 
> 时间：2013-03-12T22:57:25.173
> 
> 标签：api, curl, mediawiki, wiki, wikipedia

```
$ch=curl_init();
$postfield = "action=login&lgname=d&lgpassword=Password&format=json";
$url = "http://wiki.signa.com/api.php"; //url to wiki's api

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, 0); 
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $postfield);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$output = json_decode(curl_exec($ch));
curl_close($ch);

print_r($output);
$token = $output->login->token;
$session = $output->login->sessionid;

$ch=curl_init();

$postfield = "action=login&lgname=d&lgpassword=Password&lgtoken={$token}";
$url = "http://wiki.signa.com/api.php"; //url to wiki's api

curl_setopt($ch, CURLOPT_URL, $url);
curl_setopt($ch, CURLOPT_HEADER, 0); 
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $postfield);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);

$output = curl_exec($ch);
curl_close($ch);

print_r($output);
die; 
```

通过第一个请求，我得到了这个对象：

```
stdClass Object
(
    [login] => stdClass Object
        (
            [result] => NeedToken
            [token] => ad61fadb829e5cd44b0062463b7cc2d2
            [cookieprefix] => wikisign_mediawiki
            [sessionid] => ebb892881eed27554161234916d00480
        )

) 
```

我正在使用令牌进行第二次请求，但我得到了 result = NeedToken. 应该是成功的，因为我现在正在发送令牌。

我注意到文档说：

> 使用 POST 发送登录请求，正文中包含确认令牌，`enwiki_session`标头中包含从先前请求返回的会话 cookie（例如 ）。

我对此并不完全清楚。我假设我遇到了问题，因为我没有在标题中发送会话 cookie。我需要在第二个请求之前设置一个 cookie 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-04-04T21:33:48.867

是的，您需要处理所有 Set-Cookie 标头才能成功登录。文档对此[非常具体](https://www.mediawiki.org/wiki/API:Login)：

> 此请求还将在 HTTP 标头中返回一个会话 cookie（Set-Cookie: enwikiSession=17ab96bd8ffbe8ca58a78657a918558e; path=/; domain=.wikipedia.org; HttpOnly），如果您的框架不这样做，您必须为第二个请求返回该 cookie自动地
> 
> 一个成功的 action=login 请求将设置需要被视为已登录的 cookie。许多框架会自动处理这些 cookie（例如 cURL 中的 cookiejar）。如果是这样，请务必利用这一点。如果没有，最可靠的方法是从 HTTP 响应的 Set-Cookie 标头中解析它们。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-24T12:12:44.293

这是一个老话题，但我会为感兴趣的人回答:) 事实上，您需要将 cookie 保存在一个文件中，并在第二次尝试登录时再次使用它们。类似的东西：

```
$path_cookie = 'connexion_temporaire.txt';
if (!file_exists($path_cookie)) touch($path_cookie); 

$postfields = array(
        'action' => 'login',
        'format'=> 'json',
        'lgname' => $login,
        'lgpassword' => $pass
);

$curl = curl_init();

curl_setopt($curl, CURLOPT_URL, $lienTestWiki);
curl_setopt($curl, CURLOPT_COOKIESESSION, true);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, $postfields);
curl_setopt($curl, CURLOPT_COOKIEJAR, $path_cookie); // you put your cookie in the file
$connexion=curl_exec($curl);
$json_connexion = json_decode($connexion, true);
$tokenConnexion=$json_connexion['login']['token']; // you take the token and keep it in a var for your second login

// /!\ don't close the curl conection or initialize a new one or your session id will change !

$postfields = array(
        'action' => 'login',
        'format'=> 'json',
        'lgtoken' => $tokenConnexion,
        'lgname' => $login,
        'lgpassword' => $pass

);

curl_setopt($curl, CURLOPT_URL, $lienTestWiki);
curl_setopt($curl, CURLOPT_COOKIESESSION, true);
curl_setopt($curl, CURLOPT_RETURNTRANSFER, true);
curl_setopt($curl, CURLOPT_POST, true);
curl_setopt($curl, CURLOPT_POSTFIELDS, $postfields);
curl_setopt($curl, CURLOPT_COOKIEFILE, $path_cookie); //get the previous cookie
$connexionToken=curl_exec($curl);

var_dump($connexionToken); 
```

运行此程序时，您这次应该会看到成功 :)

# c# - CSS：第一个选择器

> ID：15373886
> 
> 赞同：1
> 
> 时间：2013-03-12T22:58:03.453
> 
> 标签：c#, asp.net, css, asp.net-mvc, css-selectors

我有一个包含and`<DL>`组的元素`<DT>``<DD>`

我目前看起来像这样：

```
AAAAA   111111
        222222
        333333
BBBBB   111111
        222222
        333333 
```

我试图在它们之间放置空间，`<DT>`所以它看起来像这样：

```
AAAAA   111111
        222222
        333333

BBBBB   111111
        222222
        333333 
```

如何让 CSS 在 DT 元素之间应用空间，同时保持整体间距？

这是我目前的CSS：

```
dl { padding: 25px 0px 25px 0px; }

dt {
    clear: left;
    float: left;
    text-align: left;
    width: 90px;
}

dd {
    margin: 0 0 0 90px;
    padding: 0 0 0 0;
} 
```

HTML是：

```
<dl>
<dt>AAAAAAA</dt>
<dd>11111111</dd>
<dd>11111111</dd>
<dd>11111111</dd>
<dd>11111111</dd>
<dd>11111111</dd>    

<dt>BBBBBBBB</dt>
<dd>11111111</dd>
<dd>11111111</dd>
<dd>11111111</dd>
<dd>11111111</dd>
<dd>11111111</dd>    
</dl> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T23:08:05.650

您需要为`dt`元素添加填充或边距，以及`dd`紧跟在`dt`.

使用您现有的代码，只需添加以下内容：

```
dt, dt+dd {
    margin-top:15px;
} 
```

如果您不希望第一个具有填充，则使用`first-of-type`选择器在第一个上覆盖它。再次添加以下内容：

```
dt:first-of-type, dt+dd:first-of-type {
    margin-top:0px;
} 
```

这里的 jsFiddle 示例：http: [//jsfiddle.net/C2FRn/](http://jsfiddle.net/C2FRn/)

（请注意，这`first-of-type`不适用于 IE8 或更早版本；有一些技巧可以解决它，但如果您需要 IE8 支持，您可能会发现只需将一个类添加到 first`dt`或`dl+dt, dt+dt+dd`用作选择器会更容易）

# perl - 如何在 Perl 中结合 printf 和 readline

> ID：15373892
> 
> 赞同：1
> 
> 时间：2013-03-12T22:58:28.403
> 
> 标签：perl, printf, readline, prompt

我正在尝试用 readline 替换 STDIN。**如果我使用 STDIN（如在注释中，请参阅代码），则光标已准备好在同一行**中的 printf 输出之后立即输入。但是使用 readline 的 printf 输出不知何故消失了，只有 readline 提示可见。我可以插入“打印”\n“；” （注释掉）在 printf 的下一行，它将提示移动到下一行，并且 printf 输出可见。但是，我希望有一个格式化的提示，并且光标直接在提示之后（**同一行**）。printf 赋值比下面的例子要复杂一些。printf 是否可行，或者我有什么选择？提前谢谢。

```
#!/usr/bin/perl -w

use Term::ReadLine;
use Term::ReadKey;
my $term = Term::ReadLine->new('name');

printf "%-12s","Input: ";
# my $new_value = <STDIN>;
# print "\n";
my $new_value = $term->readline('--> '); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T00:09:03.367

的输出`printf`延迟的原因是缓冲。为避免这种情况，您可以使用未缓冲的 STDERR，它可能更适合这种输出：

```
printf STDERR '%-12s', 'Input: '; 
```

或者，您可以更频繁地刷新 STDOUT：

```
local $| == 1; 
```

另一种选择是使用`sprintf`代替`printf`并将整个表达式放在提示符下：

```
my $new_value = $term->readline(sprintf '%-12s-->', 'Input: '); 
```

# php - 调用 if(empty($_POST) === false) 时出错

> ID：15373902
> 
> 赞同：0
> 
> 时间：2013-03-12T22:59:00.567
> 
> 标签：php

我有两个根据条件提交的表格。

我用了

```
if(empty($_POST) === false) 
```

编辑后保存数据。但是我第一次遇到这种情况导致错误。

我需要做什么才能在一个页面上容纳两个表单。？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-12T23:05:31.400

在每个表单中放置一个隐藏字段...

```
<input type="hidden" name="do" value="edit" /> 
```

另一种形式：

```
<input type="hidden" name="do" value="new" /> 
```

然后检查`$_POST`这些特定值：

```
if (isset($_POST['do'])) {

    // a form was posted

    if ($_POST['do']=='edit') {

        // do sth with form 'edit'

    elseif ($_POST['do']=='new') {

        // do sth with form 'new'

    } // if $_P
} // if isset 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:15:00.673

我建议你使用[RESTful](http://en.wikipedia.org/wiki/Representational_state_transfer)方法来解决这个问题。您可以检查请求方法是`POST`（新）或`PUT`（编辑）并处理它。

例如，如果您有两个表单，一个用于编辑，一个用于创建项目，您可以将方法设置为其中之一：

```
<form method="PUT" ...>
<form method="POST"...> 
```

并通过以下方式检索该方法：

```
$_SERVER['REQUESTED_METHOD']; 
```

因此将它们分开。

# ios - 删除处于无效状态的 GKTurnBasedMatch

> ID：15373903
> 
> 赞同：17
> 
> 时间：2013-03-12T22:59:00.527
> 
> 标签：ios, game-center, gamekit

我正在做一些实验来尝试了解 GameKit，并制作了一个简单的游戏和一个列出我的玩家比赛的界面。我正在尝试使用比赛中的`removeWithCompletionHandler:`方法添加删除游戏的功能，但是我无法删除`GKTurnBasedMatch`似乎已进入无效状态的 a。

有问题的比赛的 po 打印：

```
$0 = 0x1d590d20 <GKTurnBasedMatch 0x1d590d20 id:858d8257-cc49-4060-b1d8-38c09a929e3c status:Ended message: taken:2013-03-08 18:08:47 +0000 created:2013-03-08 03:24:14 +0000
current:<GKTurnBasedParticipant 0x1d58c020 - id:G:1717956303 (local player) status:Invited outcome:None lastTurn:(null)>
participants:
    <GKTurnBasedParticipant 0x1d58bc90 - id:G:1717239488 status:Done outcome:Quit lastTurn:2013-03-08 18:08:47 +0000>
    <GKTurnBasedParticipant 0x1d58c020 - id:G:1717956303 (local player) status:Invited outcome:None lastTurn:(null)>
> 
```

这似乎表明比赛已经结束。然而，其中一名参与者的结果是：无，我被医生引导相信对于结束的游戏是无效的。试图简单地删除游戏会给出：

> 由于一个或多个参数无效，请求的操作无法完成。

在尝试设定结果并结束游戏时，会给出：

> 由于会话处于无效状态，请求的操作无法完成。

我想也许我无法删除游戏，因为本地玩家是积极参与者，但两者`participantQuitInTurnWithOutcome:...`都`endTurnWithNextParticipants:...`给出了错误：

> 由于会话处于无效状态，请求的操作无法完成。

也是。我做错了什么还是我以某种方式创造了一个不可移动的游戏？

PS 我也无法通过游戏中心提供的界面删除游戏，它们列在“游戏结束”部分下。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-22T13:06:20.363

这就是我设法删除所有无效匹配项的方法。

我检查了当前参与者的状态，如果它被邀请，我调用了dendInviteWithCompletionHandler，否则我调用了participantQuitInTurnWithOutcome。

在这两个完成块中，我随后调用了 removeWithCompletionHandler 来删除匹配项。

这产生了一些错误，但匹配项仍被删除，因此我的列表很干净。

这是一个关于如何避免进入这种状态的解决方法。这还有一个额外的好处，即如果邀请者在完成他/她的第一回合之前退出，被邀请者甚至不会收到通知。

在 playerQuitForMatch 中，首先结束回合，然后在完成处理程序中，立即退出比赛。像这样，

```
[match endTurnWithNextParticipants:[NSArray arrayWithObject:nextParticipant]
                                          turnTimeout:GKTurnTimeoutDefault
                                            matchData:nil completionHandler:^(NSError *error) {
                                                if (error) {
                                                    NSLog(@"%@", error);
                                                }

                                                [match participantQuitOutOfTurnWithOutcome:GKTurnBasedMatchOutcomeQuit
                                                                     withCompletionHandler:^(NSError *error) {
                                                                         if (error) {
                                                                             NSLog(@"%@" ,error);
                                                                         }
                                                                     }];
                                            }]; 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-26T16:11:10.797

I found the solution. For invalid matches just use -participantQuitOutOfTurn method and then -removeWithCompletionHandler method. It will be completely removed.

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-03-16T05:08:18.223

不幸的是，我遇到了完全相同的错误。为了帮助其他人理解问题，希望研究解决方案，您可以通过邀请朋友参加比赛来重新创建此问题，但然后在第一回合中退出比赛，然后再将该回合提交给被邀请的玩家。然后，托管玩家从 Game Center 中删除比赛。在受邀玩家的设备上，他们将拥有一场与上述类似的比赛，无法删除。我尝试了所有类型的解决方法。

我还没有任何运气，但如果我找到一个解决方案，我会更新我的答案。我目前正在尝试发布 Game Center 游戏，因此我必须找到解决此问题的方法。我会在接下来的一两天内得出结论。

更新：我检查了我的不可删除的比赛，它们几乎和你的一样，除了我的邀请状态的球员也有比赛结果赢了。似乎将比赛置于无效状态的关键是让一名球员状态为 Invited 而不是 Done，但比赛状态为 Ended。这是我们两个案例之间的共同点，也是 Apple 的 bizantine Game Center 代码中的一个边缘案例。如果他们只是搞砸了这个边缘案例并期望你“知道”你不应该让玩家处于那种状态，我不会感到惊讶（毫无疑问，如果你足够仔细地阅读他们的文档，你将能够最终将其拼凑在一起）。

我的结论是，Apple 有一个很容易被忽视的边缘案例，因为它只有在你退出新比赛时才会发生，而且只有当你邀请朋友时，这两个案例你可能不会经常测试。此外，如果您没有不正确地设置匹配结果，我猜它永远不会发生，所以他们永远不会抓住它。

由于我还没有发货，我将配置我的应用程序以检测此状态下的匹配项并忽略它们。我将向控制台报告有多少匹配项处于此状态，这样我就可以确保它不会超过这一点。然后，我将分析我的退出代码，并确保在这种边缘情况下，我根本无法再次将匹配项置于此状态。我认为鉴于我们所知道的，我们必须积极主动，并接受一些比赛失败的事实。

希望您还没有发货，因此错误案例匹配将本地化到 Game Center 沙盒环境。实际上，错误匹配只是在沙盒中本地化给您的测试用户，因此您可以丢弃该用户并在纠正问题后从新用户开始。如果您实施我的上述建议，您应该能够在执行此步骤之前确认您的应用程序正常运行。

如果有人真的可以找到一种方法来消除这些错误匹配，请告诉我们，但我希望我的建议和对实际原因的识别足以帮助您继续您的项目。

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2013-03-31T00:25:26.033

我有类似的情况，如果略有不同。我开始比赛，邀请第二个沙盒帐户玩，然后第一个玩家退出并在第二个玩家响应之前删除游戏。当第二个玩家尝试退出游戏时，他们会收到以下错误：

```
Error quitting match in turn: Error Domain=GKErrorDomain Code=22 "The requested operation could not be completed because the specified participant is invalid." 
UserInfo=0x1f5de800 {
    GKServerStatusCode=5097, 
    NSUnderlyingError=0x1f58b610 "The operation couldn’t be completed. 
    status = 5097, 
    Invalid state: turn sent to playerId:1952436619 in slotIndex: 0 for sessionId: 698b074b-fa0b-4505-834f-1b4305b7eecb : expected slot state: Active but found: Inactive", 
    NSLocalizedDescription=The requested operation could not be completed because the specified participant is invalid.
} 
```

据我所知，发生这种情况是因为下一个要移动的参与者已经处于“完成”状态，我猜这是因为他们已经退出了：

```
<GKTurnBasedMatch 0x1f532b20    id:698b074b-fa0b-4505-834f-1b4305b7eecb status:Open message: taken:2013-03-30 19:53:47 +0000 created:2013-03-30 18:29:09 +0000
current:<GKTurnBasedParticipant 0x1f532b80 - id:G:1952433332 (local player) status:Active outcome:None lastTurn:2013-03-30 19:53:47 +0000>
participants:
        <GKTurnBasedParticipant 0x1f532b70 - id:G:1952436619 status:Done outcome:Lost lastTurn:2013-03-30 18:29:10 +0000>
        <GKTurnBasedParticipant 0x1f532b80 - id:G:1952433332 (local player) status:Active outcome:None lastTurn:2013-03-30 19:53:47 +0000>
    > 
```

希望这将有助于其他人诊断，如果没有别的。很想听听其他人对解决方法或解决方案的见解。如果这是苹果公司的一个错误，那么似乎值得关注。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-10T13:20:13.097

Apple 技术开发人员支持确认了该问题。提交错误报告。会及时向大家发布。

# jquery - 如何在鼠标单击时更改视图中 div 的样式属性？

> ID：15373910
> 
> 赞同：0
> 
> 时间：2013-03-12T22:59:17.440
> 
> 标签：jquery, backbone.js, backbone-views, backbone-events

我有一个主干视图，它正在监听这样的鼠标单击事件：

```
...[code before]...
events: {
   mousedown: "catchMouseClick"
},
...[code after]... 
```

在“catchMouseClick”中，我将创建一个像这样的新视图

```
...[code before]...
catchMouseClick: function(e) {
    //Initialize RightClickMenu
    this.rightClickMenu = new RightClickMenu({mouseX:e.pageX,mouseY:e.pageY});
    this.rightClickMenu.remove();                        
},
...[code after]... 
```

如您所见，我使用鼠标单击事件“e”中的 pageX 和 pageY 作为参数来创建 RightClickMenu

最后是我的 RightClickMenu 视图：

```
var RightClickMenu = Backbone.View.extend({
  el:$('#outerDiv'),
  render: function(){
   $(this.el).append(_.template($('#rightClickTemplate').html()));
   $('#rightClickMenuDiv').css('top',this.options.mouseY);
   $('#rightClickMenuDiv').css('left',this.options.mouseX);
 }
}); 
```

我使用“称为”rightClickTemplate 的模板，其 div 的 id 为“rightClickMenuDiv”。

我的问题是，我还能走什么其他路径？因为我不想在这个地方的源代码中有很多 jQuery 选择器。

也许我可以在我的模板中处理这些参数？像这样的东西（未经测试的来源）：

```
<script type="text/template" id="rightClickTemplate">
  <div id="rightClickMenuDiv" style="top:<%= mouseY =>, left:<%= mouseX=>">
  ...
  </div>
</script> 
```

所以我可以在加载模板时传递它们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-13T09:04:14.630

尽量减少使用 jquery 选择器，

```
var RightClickMenu = Backbone.View.extend({

  el:$('#outerDiv'),

  template : _.template($('#rightClickTemplate').html()),

  render: function(){
      this.rightMenuDiv = $(this.template()).appendTo(this.el);
      this.updatePosition(this.options.mouseX, this.options.mouseY);
      return this;
  },

 updatePosition : function(x, y){
      this.rightMenuDiv.css({
           top : y,
           left : x
      });
 } 

}); 
```

试试这个在鼠标点击时更新位置

```
...[code before]...
render : function(){
     this.rightClickMenu = new RightClickMenu({mouseX:0, mouseY:0});
     return this;
},

catchMouseClick: function(e) {
    //Initialize RightClickMenu
    this.rightClickMenu.updatePosition(mouseX:e.pageX,mouseY:e.pageY);                
},
...[code after]. 
```

..

# jquery - 在 jQuery 中使用数组填充页面

> ID：15373913
> 
> 赞同：0
> 
> 时间：2013-03-12T22:59:35.980
> 
> 标签：jquery, arrays, each

这听起来很简单，但不知何故它不起作用。

我有一个模板页面，应该使用长轮询来更新。我有长轮询工作，但我在处理/插入数据时失败。

这是 HTML 部分：

```
<p><b><div id="weather">weather here</div></b></p>
<p><div id="temperature">temperature here</div></p>
<p><i><div id="color">color here</div></i></p> 
```

这是脚本：

```
var obj = {
    "color": "#880000",
        "temperature": "hot",
        "weather": "cloudy"
};

$.each(obj function (key,value) {
    ('#key').html('value');
}); 
```

此外，我想在样式表中使用颜色，但不知道如何替换非*div*元素：

```
#color {
    color: #880000
} 
```

我认为*每个*数组迭代都来自教科书。我错过了什么？（[此处为 jfsiddle 示例](http://jsfiddle.net/SKssF/150/ "jsfiddle 示例在这里")）

* * *

**根据建议的**第二次尝试，现在更大的图景给出了类型错误：****

 **php 文件（array_2.php）：

```
<?php
/*
Values get read from files.
Here, in the example, we simply populate variables.

Original: 
$color = file_get_contents('/path/to/txt/file/with/value');
*/ 
$color = "#880000";
$temperature = "hot";
$weather = "cloudy";
$items = array(array(id => 'weather', text => $weather), array(id => 'color', text => $color), array(id => 'temperature', text => $temperature),);  
echo json_encode($items);
?> 
```

html/javascript：

```
<html>
<head>
    <title>Satus Poller</title>
<script type="text/javascript" src="/jquery.js"></script>
<meta charset="utf-8">
    <script type="text/javascript" charset="utf-8">
       function addstatus(obj){
        $.each(obj, function (key,value) {
            $('#' + value.id).html(value.text);
        });
    };
    function waitForMsg(){
        $.ajax({
            type: "GET",
            url: "array_2.php",
            async: true,
            cache: false,
            timeout:50000,

            success: function(data){
                var arr = $.parseJSON(data);
                var obj = arr + ""; /* This doesn't help */
                addstatus(obj);
                setTimeout(
                    waitForMsg,
                    1000
                );
            },
            error: function(XMLHttpRequest, textStatus, errorThrown){
                addmsg("error", textStatus + " (" + errorThrown + ")");
                setTimeout(
                    waitForMsg,
                    15000);
            }
        });
    };

    $(document).ready(function(){
        waitForMsg();
    });
    </script>
</head>
<body>
    <p><div id="color">color</div></p>
    <p><div id="temperature">temperature</div></p>
    <p><div id="weather">weather</div></p>
</body>
</html> 
```

（我什至没有尝试同时替换文本和 CSS 元素。）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:05:06.847

OP 的方法是正确的，但有几个错别字。

```
var obj = {
  "color": "#880000",
  "temperature": "hot",
  "weather": "cloudy"
};

// missing $, or jQuery
$.each(obj, function (key,value) {
  // missing comma

  $('#'+key).html(value);
  // variable key and value wrapped inside quote
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:05:57.020

[http://jsfiddle.net/SKssF/151/](http://jsfiddle.net/SKssF/151/)

我将其更改为一个数组，以便它可以遍历，用方括号 [] 表示

```
var obj = [
    {id:"color", text:"#880000"},
    {id:"temperature", text:"hot"},
    {id:"weather", text: "cloudy"}
]; 
```

您在 旁边缺少逗号`obj, function`，缺少 jquery 选择器`$`。 `'#key'`只是字符串，javascript 不知道你的意思是变量：

```
$.each(obj, function (key,value) {
    $('#' + value.id).html(value.text);
}); 
```**

# xml - 使用 Jdom2 检查字符串是否是有效的 XML

> ID：15373915
> 
> 赞同：0
> 
> 时间：2013-03-12T22:59:46.900
> 
> 标签：xml, jdom, jdom-2

检查字符串是否是 Jdom2 的有效 XML 的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:26:51.817

将它放在 try/catch 块中并使用 JDOM 2 对其进行解析.....然后如果您需要处理 JDOMException 它是无效的。

滚滚

# php - 数据库中输入了多少数据？

> ID：15373920
> 
> 赞同：-2
> 
> 时间：2013-03-12T23:00:16.103
> 
> 标签：php, mysql

如何获取用户在数据库中输入的信息量？例如，在个人资料页面上，我想向用户显示如下内容：

```
Your profile is 25% complete! Please enter all information in your profile. 
```

我想获取该数据并将其设置为变量，以便可以在 jQuery 进度条中使用它。但只计算必要的字段。例如，如果用户没有输入中间名，但其他所有操作都完成了配置文件，仍将是 100%。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:02:43.433

好吧，为每个字段建立权重。您可以直接将权重添加到数据库中的（新）字段。然后执行一个查询，选择所有包含信息的字段（针对每个用户）并组合所有权重。然后输出总重量。

如果您没有权重，并且所有字段都相等，请执行

（修复您的字段和表格）`SELECT COUNT(*) FROM USER_DATA WHERE USERID=1`- 它应该为您提供为该用户填充了多少字段（假设没有空字段的记录）。然后，您需要知道总共有多少个字段并进行一些数学运算以获得百分比。

尽管如此，这是一个非常模糊的问题，您需要给我们一些数据库架构和示例数据，以便我们给您一个很好的答案。

如果你真的不知道如何做 SQL 和编码，你可以通过 JavaScript 稍微调整一下——在页面末尾添加 JS 字段检查器并通过 JS 输出此数据

```
<script>
var str = document.getElementById("put_your_uniqe_field_id_here").value;
alert(str);
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:04:56.123

你必须自己计算。如果您允许用户输入 10 列个人信息，并且他在其中的 3 列中填写了数据，那么他的个人资料已完成 30%。如果他填满 8 个，则完成 80‰。

```
100 / totalcols * filledcols 
```

也就是说，如果所有字段都具有相同的权重。如果你有 10 列，但其中两列更重要，你可以数然后加倍。那么你有 10 + 2 = 12 个总数

更新

```
//cols: name, surname, addres
$total = 3;
$filled =0;

if (!empty($name))
  $filled++;

if (!empty($surname))
  $filled++;

if (!empty($address))
  $filled++;

 $p = 100/$total*$filled;
echo $p; 
```

# c++ - 错误：“cmpxchg”的指令后缀无效

> ID：15373922
> 
> 赞同：1
> 
> 时间：2013-03-12T23:00:34.293
> 
> 标签：c++, assembly, x86-64

我正在尝试编译另一个项目的代码，并且一直在获取`Error: invalid instruction suffix for 'cmpxchg'`. 错误一直指向的代码行是：

```
inline bool CAS(long *ptr, long oldv, long newv) {
  unsigned char ret;
  /* Note that sete sets a 'byte' not the word */
  __asm__ __volatile__ (
                "  lock\n"
                "  cmpxchgq %2,%1\n"
                "  sete %0\n"
                : "=q" (ret), "=m" (*ptr)
                : "r" (newv), "m" (*ptr), "a" (oldv)
                : "memory");
  return ret;
} 
```

我想知道是否有人知道导致错误的原因以及可能的解决方案是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-13T00:15:26.943

正如评论员所提到的，问题在于 cmpxchg 末尾的“q”。汇编器使用指令后缀字符来指示位宽，否则它会不明确。

此代码可以使用 gcc 编译为 64 位目标。您将获得 cmpxchgq 指令的此输出。

```
f0 48 0f b1 16          lock cmpxchg %rdx,(%rsi) 
```

f0 是 LOCK 前缀， 48 是 REX.W 前缀。真正的操作码是 0f b1。

为 32 位目标编译（gcc 选项 -m32）会导致后缀错误。

如果您需要此代码在 32 位机器上工作，那么您在移植时会感到头疼。sizeof(long) 在 64 位机器上为 8，在 Linux 的 32 位机器上为 4。 *如果*，如果整个程序有足够的弹性来容忍从 8 到 4 个字节的“长”，那么您可以通过将“q”后缀更改为“l”（这是一个小写 L ）。这为您提供了 32 位形式的 '0f b1' 指令：

```
 f0 0f b1 16             lock cmpxchg %edx,(%esi) 
```

如果不是，那么您可以尝试为 32 位目标重写程序集以使用 CMPXCHG8B，这是具有不同寄存器触摸行为的不同指令。CMPXCHG8B 不是直接替代品！

# entity-framework - 在 LINQ to Entities 中将字符串转换为 Int

> ID：15373924
> 
> 赞同：2
> 
> 时间：2013-03-12T23:00:53.547
> 
> 标签：entity-framework, linq-to-entities, entity-framework-5

我正在尝试将以下 SQL 语句复制为 LINQ to Entities 查询（其中“PRODUCTS”是映射到实体的表）...注意 IQueryable ...我所看到的大多数作为解决方案发布的内容都转换了搜索***参数***，或者将结果转储到 IEnumerable 中，然后从那里继续转换。我正在处理 100 条数百万条记录，无法将 2 亿条记录加载到内存中，只能再次过滤它们。如果可能的话，我想在对数据库的单个查询中执行此操作。

```
select *
from PRODUCTS
where
    MODEL_CODE = '65' and
    CAST(SERIAL_NUMBER as int) > 927000 and
    CAST(SERIAL_NUMBER as int) < 928000 
```

我尝试了以下...

```
int startSN, endSN;
startSN = 9500
endSN = 9500

if (!int.TryParse(startSerialNumber, out startSN))
    throw new InvalidCastException("The start serial number was not a valid value");

if (!int.TryParse(endSerialNumber, out endSN))
    throw new InvalidCastException("The end serial number was not a valid value");

    IQueryable<PRODUCT> resultList = base.Context.PRODUCTS.Where(b => 
        (Convert.ToInt32(b.SERIAL_NUMBER) > startSN) &&
        (Convert.ToInt32(b.SERIAL_NUMBER) < endSN)).AsQueryable(); 
```

我已经尝试了与此类似的其他几个版本，但没有运气。我也没有运气看过以下帖子。

[在实体框架 linq 查询中将字符串转换为 int 并处理解析异常](https://stackoverflow.com/questions/12677256/convert-string-to-int-in-an-entity-framework-linq-query-and-handling-the-parsing)- 该解决方案在转换实体属性之前将查询转换为列表。

[在 LINQ to Entities 中将字符串转换为 Int ？](https://stackoverflow.com/questions/7399602/convert-string-to-int-in-linq-to-entities)- 这个问题只是转换了可以在 LINQ to Entities 语句之外轻松完成的参数。我已经为参数这样做了。

[LINQ to Entities StringConvert(double)' 无法转换为将 int 转换为字符串](https://stackoverflow.com/questions/5771299/linq-to-entities-stringconvertdouble-cannot-be-translated-to-convert-int-to-s)- 这个问题实际上与我的相反，试图将 int 转换为字符串。1) SqlFunctions 不提供转换为 int 的函数。2）最终的解决方案是，在转换/转换值之前再次转换为 IEnumerable。

有人有其他想法吗？我对这个有点难过！

谢谢你，G

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-20T22:34:37.897

如果您不使用代码优先，但基于 EDMX 的方法*模型定义的函数*可能是最好的解决方案：[Convert String to Int in EF 4.0](https://stackoverflow.com/questions/5754218/convert-string-to-int-in-ef-4-0)

或者，您可以使用...

```
base.Context.PRODUCTS.SqlQuery(string sql, params object[] parameters) 
```

...然后从您的问题中传入原始 SQL 语句。

`DbSet<T>.SqlQuery(...)`返回 a`DbSqlQuery<T>`作为结果。重要的是要记住，这种类型不*实现*，`IQueryable<T>`而只是`IEnumerable<T>`. 它的签名是：

```
public class DbSqlQuery<TEntity> : IEnumerable<TEntity>, IEnumerable, IListSource
    where TEntity : class 
```

因此，您*可以*使用其他 LINQ 方法扩展此结果，但只有 LINQ to Objects 将在内存中执行，并使用 SQL 查询返回的结果集。您*不能*使用*LINQ*将其扩展为将在数据库中执行的实体。因此，添加`.Where`过滤器对`DbSqlQuery<T>`数据库查询和从数据库加载到内存的数据集没有任何影响。

这实际上并不奇怪，因为否则这意味着必须将部分表达式树（来自`Where`方法）翻译成 SQL，然后合并到手写 SQL 语句中，以便生成正确的新组合 SQL 语句并可以发送到数据库。听起来对我来说是一项相当艰巨的任务。

# git - 在冲突的 git 合并后清理？

> ID：15373928
> 
> 赞同：28
> 
> 时间：2013-03-12T23:01:15.370
> 
> 标签：git, version-control, merge, merge-conflict-resolution, filemerge

`.h`我正在处理的项目中的头文件中有一个小冲突。这个项目在 Git 中被跟踪。

幸运的是，冲突很容易解决。我用了

`git mergetool`

`opendiff`并在我的 Mac 上选择了似乎是 FileMerge的默认 ( )。我进行了适当的更改，保存了文件并关闭了。

然后Git问我合并是否成功，我说是：

`Was the merge successful? [y/n] y`

但现在，我有：

```
> git st
# On branch develop
# Changes to be committed:
#   modified:   MyHeader.h
#
# Untracked files:
#   (use "git add <file>..." to include in what will be committed)
#
#   MyHeader.h.BACKUP.52920.h
#   MyHeader.h.BASE.52920.h
#   MyHeader.h.LOCAL.52920.h
#   MyHeader.h.REMOTE.52920.h
#   MyHeader.h.orig 
```

哪些额外的垃圾冲突文件是由 FileMerge 创建的，哪些是由 Git 创建的？

***更重要的是：*****我如何删除它们？**

* * *

## 回答 #1

> 赞同：53
> 
> 时间：2013-03-12T23:09:03.237

您可以像删除任何其他文件一样简单地删除它们。例如：

```
rm MyHeader.h.orig 
```

或者，如果没有其他未跟踪的文件，那么在你提交之后

```
git commit -a 
```

你可以清理你的存储库

```
git clean -n
git clean -f 
```

`git clean -n`会告诉你`git clean -f`会做什么，所以你可以确定这是你想要的。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-03-12T23:05:53.360

如果它们是唯一未跟踪的文件，您可以使用`git clean`删除它们。使用标志运行一次`-n`以查看将删除的内容，然后如果确定，请使用`-f`. 如果您有要保留的未跟踪文件，请不要使用它！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T23:12:13.450

首先提交您的合并。

一旦您对一切正常感到满意，只需手动删除这些额外的文件（`rm <filename>`例如，使用 ）。

# javascript - 试图在两个不同的值之间进行按钮切换

> ID：15373931
> 
> 赞同：-1
> 
> 时间：2013-03-12T23:01:41.450
> 
> 标签：javascript, toggle, visibility

我不知道这是否是某种循环保护，但我想要一个按钮，单击该按钮可以打开或关闭图像，并且此代码不起作用：

```
<script>                            
document.getElementById('standbybutton').onclick = function() {                         
if (document.querySelector('#standby img').style.visibility = 'hidden'){                                
document.querySelector('#standby img').style.visibility = 'visible'                         
} else {                                
document.querySelector('#standby img').style.visibility = 'hidden'                          
} return false; 
}                   
</script> 
```

我错过了什么？如果图像被隐藏，则使其可见。否则，将其隐藏。不？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-12T23:03:54.677

您使用的是赋值运算符 ( `=`) 而不是比较运算符 ( `==`or `===`)。

编辑：仅供参考，JSLint（或类似的东西）会抓住这一点。

# c++ - 有效地获取 C++ 链表中最大的 3 个整数（未排序）

> ID：15373937
> 
> 赞同：0
> 
> 时间：2013-03-12T23:02:17.313
> 
> 标签：c++, linked-list

我听说有一些 std 函数确实给出了数组中最大的 n 个整数，但是链表呢？

我认为一个解决方案是使用一些 for 循环来迭代链表，但似乎 C++ 库中可能有一个更简单的解决方案。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T23:17:05.980

如果您不能使用其他数据结构，我会这样做：

```
typedef std::list<int> IntList;
InstList list = <your_values>;

int top[3];
for (size_t i = 0; i < 3; i++)
    top[i] = std::numeric_limits<int>::min();

IntList::iterator it, end;
for (it = list.begin(), end = list.end(); it != end; ++it) {
    const int& value = *it;
    if (value > top[2]) {
        top[0] = top[1];
        top[1] = top[2];
        top[2] = value;
    } else if (value > top[1]) {
        top[0] = top[1];
        top[1] = value;
    } else if (value > top[0]) {
        top[0] = value;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:07:38.523

也许考虑使用[`priority_queue`](http://www.cplusplus.com/reference/queue/priority_queue/).

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T23:17:26.007

基本思想是维护一个排序列表、优先级队列或精确`N`数字堆。您将`N`列表的第一个值推入其中，然后遍历其余值。如果您遇到大于队列（或其他）中最小值的项目，则删除该元素并将新元素推入。

如果您只是在寻找`N=3`，那么使用简单的数组可能比优先级队列或其他任何东西更好。您只需进行两次比较即可确定该数组中的哪个元素是最小值。您始终记住最小元素的索引，并且仅在替换它时才更新它。

有趣的是，对于按升序排序的列表，这种方法的性能最差。但是，它本质上仍然是线性时间复杂度。

# image - 克隆错误“值错误：无法找到 update_version_before_edit”

> ID：15373938
> 
> 赞同：0
> 
> 时间：2013-03-12T23:02:17.507
> 
> 标签：image, plone, failed-installation

我正在尝试（非常努力）让**Plone 4.2.4 版**正常工作。我有一个以前的安装，我删除了。然后我尝试稍后重新安装。一切似乎都很好，直到我无法上传任何图片并且它从以前的安装中提取了一些数据（文件夹等）。我现在尝试清除它大约 5 次并重新安装，但它总是要么从以前的安装中提取数据（特别是文件夹），要么因为不允许我上传文件等而以某种方式中断。

有人对如何解决这个问题有任何建议吗？我正准备放弃 Plone。

错误信息：

```
Traceback (innermost last):
  Module ZPublisher.Publish, line 126, in publish
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module Products.CMFPlone.FactoryTool, line 453, in __call__
  Module ZPublisher.mapply, line 77, in mapply
  Module ZPublisher.Publish, line 46, in call_object
  Module Products.CMFFormController.FSControllerPageTemplate, line 91, in __call__
  Module Products.CMFFormController.BaseControllerPageTemplate, line 28, in _call
  Module Products.CMFFormController.ControllerBase, line 231, in getNext
  Module Products.CMFFormController.Actions.TraverseTo, line 35, in __call__
ValueError: Unable to find update_version_before_edit 
```

# python - 如何提取列表中每个元组的“x”并以python方式连接？

> ID：15373945
> 
> 赞同：2
> 
> 时间：2013-03-12T23:03:08.640
> 
> 标签：python

我有一个从 NLTK 树中提取的这样的值。

```
 [[('Happy', 'NNP'), ('Mother', 'NNP')], [('Day', 'NNP')], [('Joey', 'NNP'), ('M.', 'NNP'), ('Bing', 'NNP')], [('kind', 'NN')], [('happy', 'JJ'), ('wife', 'NN')], [('mother', 'NN')], [('friend', 'NN')]] 

```

我希望最终结果是

```
['Happy Mother','Day','Joey M. Bing','kind','happy wife','mother','friend'] 
```

我如何以python方式做到这一点？

这是我到目前为止所做的，我知道这很丑陋。我是蟒蛇处女。

```
 Y = []
for x in X:
    s = ""
    for z in x:
        s += z[0] + " "
    Y.append(s)

print Y 

```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-12T23:06:00.550

`zip`使用和可以很容易地做到这一点`str.join`。

```
result = [' '.join(zip(*row)[0]) for row in data] 
```

`zip(*sequences)[i]`是一个常见的 Python 习惯用法，用于从每个序列（列表、元组等）中获取第 i 个值

它类似于`[seq[i] for seq in sequences]`但即使序列不可下标（例如迭代器）也可以工作。在 Cpython 中，由于使用了内置函数，它可能会稍微快一些（尽管如果它很重要，您应该始终对其进行分析）。此外，它返回一个元组而不是一个列表。

有关详细信息，请参阅[文档](http://docs.python.org/2/library/functions.html#zip)。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T23:06:23.723

```
Y = [' '.join(t[0] for t in l) for l in X] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-12T23:05:42.247

使用[列表推导：](http://docs.python.org/2/tutorial/datastructures.html#list-comprehensions)

```
>>> X = [[('Happy', 'NNP'), ('Mother', 'NNP')], [('Day', 'NNP')], [('Joey', 'NNP'), ('M.', 'NNP'), ('Bing', 'NNP')], [('kind', 'NN')], [('happy', 'JJ'), ('wife', 'NN')], [('mother', 'NN')], [('friend', 'NN')]]
>>> Y = [' '.join(z[0] for z in x) for x in X]
>>> Y
['Happy Mother', 'Day', 'Joey M. Bing', 'kind', 'happy wife', 'mother', 'friend'] 
```

# jquery - 跨多个 jQuery 实例的自定义事件

> ID：15373946
> 
> 赞同：4
> 
> 时间：2013-03-12T23:03:10.500
> 
> 标签：jquery, events, publish-subscribe

让我们假设以下情况：

*   该页面（[http://somedomain.com/somepage.html](http://somedomain.com/somepage.html)）已加载 jQ 1.9。
*   它还加载我们的脚本[http://ourservice.com/script.js](http://ourservice.com/script.js)
*   进而以 noConflict 模式加载 jQ 1.7

现在页面本身可以使用 jQ 1.9 并被该页面上的某些脚本使用，并且在我们的`script.js`.

现在`script.js`我们要在元素上触发一些事件：

```
$el.trigger('our_event.ns'); 
```

据我了解，此事件不会到达 jQ (1.9) 的另一个实例——对吗？至少从我们的测试来看是这样。

有什么方法可以让它在我们的代码中不实现发布/订阅而不是依赖 jQ 的情况下工作？

# c# - 无法弄清楚为什么我无法访问单独类中的公共函数

> ID：15373947
> 
> 赞同：0
> 
> 时间：2013-03-12T23:03:11.610
> 
> 标签：c#, webforms, asp.net-4.5

我试图在我的 Web 应用程序的公共类中调用公共函数，但由于某种原因，即使我可以正常访问该类并且该函数被标记为公共，该函数也无法访问。当我打电话时`FileUploader`，我得到的唯一选项是 equals 和 referenceanceequals。我在看什么愚蠢的东西？请注意，该课程位于我的应用程序中名为 Classes 的辅助项目中。我在访问项目中的差异类时没有问题`FileUploader`。

```
using System;
using Microsoft.WindowsAzure.Storage;
using Microsoft.WindowsAzure.Storage.Auth;
using Microsoft.WindowsAzure.Storage.Blob;
using Microsoft.WindowsAzure;
using System.IO;
using System.Configuration;
using FFInfo.Classes;

namespace FFInfo
{
    public partial class FUTest : System.Web.UI.Page
    {
        protected void Page_Load(object sender, EventArgs e)
        {

        }

        protected void btnSubmit_Click(object sender, EventArgs e)
        {
            if (fuFile.HasFile)
            {

            }
        }
    }
} 
```

文件上传器.cs

```
 using FFInfo.DAL;
using FFInfo.DAL.Tables;
using Microsoft.WindowsAzure.Storage;
using Microsoft.WindowsAzure.Storage.Blob;
using System;
using System.Web;

namespace FFInfo.Classes
{
    public class FileUploader
    {
        public Int64 UploadSiteImage(string ConnectionString, string ContainerName, string FilePath, HttpPostedFile UploadedFile)
        {
            CloudStorageAccount SiteImages = CloudStorageAccount.Parse(ConnectionString);
            CloudBlobClient SiteImagesBlob = SiteImages.CreateCloudBlobClient();
            CloudBlobContainer SiteImageContainer = SiteImagesBlob.GetContainerReference(ContainerName);
            SiteImageContainer.CreateIfNotExists();
            CloudBlockBlob Image = SiteImageContainer.GetBlockBlobReference(FilePath + UploadedFile.FileName);

            using (UploadedFile.InputStream)
            {
                Image.UploadFromStream(UploadedFile.InputStream);
            }

            using (var db = new Compleate())
            {
                File NewFile = new File()
                {
                    ContainerName = ContainerName,
                    FilePath = FilePath,
                    FileName = UploadedFile.FileName,
                    ContentType = UploadedFile.ContentType
                };

                db.Files.Add(NewFile);
                db.SaveChanges();
                return NewFile.FileID;
            }
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:06:42.820

您的意思是说该`UploadSiteImage`方法是静态的吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T23:18:42.320

试试（新的 FileUploader（））。<-- 将在这里获得智能感知。

但是，是的，您可能希望该方法是公共静态的

# sql-server - SQL Server Management Studio - 在视图设计不正确时优化我的脚本

> ID：15373949
> 
> 赞同：1
> 
> 时间：2013-03-12T23:03:19.167
> 
> 标签：sql-server, ssms

我正在尝试创建一个类似于 (A AND B) OR (B AND (C OR (D AND K))) 的视图，但是 SQL Server Management Studio 以完全不同的错误方式重新排列它。

如何禁用此优化器？

研究生，

# arm - 关于 GNU ARM 汇编程序的意外警告

> ID：15373952
> 
> 赞同：1
> 
> 时间：2013-03-12T23:03:32.747
> 
> 标签：arm, raspberry-pi, gnu-arm

我正在为 Raspberry Pi 编写一些裸机代码，并且收到来自 Windows 上的 ARM 交叉汇编程序的意外警告。导致警告的说明是：

```
stmdb sp!,{r0-r14}^ 
```

和

```
ldmia sp!,{r0-r14}^ 
```

警告是：

> 警告：基址寄存器的写回是不可预测的

我可以这样理解，虽然'^'修饰符告诉处理器存储寄存器的用户模式副本，但它不知道执行指令时处理器将处于什么模式并且似乎没有是一种方式来告诉它。我更担心会收到相同的警告：

```
stmdb sp!,{r0-r9,sl,fp,ip,lr}^ 
```

和：

```
ldmia sp!,{r0-r9,sl,fp,ip,lr}^ 
```

尽管我明确没有存储**任何**sp 寄存器。

我担心的是，尽管大约 15 年前我曾经做过很多汇编代码，但 ARM 代码对我来说是新的，我可能会误解一些东西！另外，如果我可以安全地忽略这些警告，有没有办法抑制它们？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:22:35.010

ARM体系结构参考手册说在用户寄存器的LDM/SMT中不允许写回。在异常返回情况下是允许的，`pc`在寄存器列表中的位置。

LDM（异常返回）

```
LDM{<amode>}<c> <Rn>{!},<registers_with_pc>^ 
```

LDM（用户寄存器）

```
LDM{<amode>}<c> <Rn>,<registers_without_pc>^ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-13T00:24:50.320

术语“写回”*不是*`SP`指寄存器列表中是否存在，而是`!`指表示指令应该`SP`用传输区域地址结束的值来更新值的符号。基址寄存器 (SP) 值将用于当前模式，而不是用户模式，因此您仍然可以将用户模式 ​​SP 值加载或存储到堆栈中。从 ARM ARM B9.3.6 LDM（用户寄存器）：

> 在系统模式以外的 PL1 模式中，加载多个（用户寄存器）使用来自基址寄存器的地址从连续的存储器位置加载多个用户模式寄存器。加载的寄存器不能包括 PC。处理器正常读取基址寄存器值，使用当前模式来确定寄存器的正确 Banked 版本。该指令不能写回基址寄存器。

编码图通过将第 21 位（W，写回）指定为“（0）”来反映这一点，这意味着如果该位不为 0，则结​​果是不可预测的。

因此，解决方案就是在必要时不`!`手动指定和递减或递增 SP。

# paypal - 有多个项目的贝宝购物车

> ID：15373956
> 
> 赞同：1
> 
> 时间：2013-03-12T23:03:59.893
> 
> 标签：paypal, paypal-sandbox

我已经开发了一个购物车，现在我被贝宝购物车表格困住了。我正在尝试用一次运费、手续费和税费发送多件商品。我创建了以下表格，但贝宝给了我错误`"Your shopping cart is empty."`

**这是我的代码**

```
<form name="paypal" action="https://www.paypal.com/cgi-bin/webscr" ethod="post">
  <input type="hidden" name="cmd" value="_cart">
  <input type="hidden" name="upload" value="1">
  <input type="hidden" name="rm" value="2" />
  <input type="hidden" name="charset" value="utf-8" />
  <input type="hidden" name="business" value="xxxx@xxxxx.com">
  <input type="hidden" name="currency_code" value="USD" />
  <input type="hidden" name="tax_cart" value="5">
  <input type="hidden" name="handling_cart" value="30">
  <input type="hidden" name="shipping" value="20">
  <input type="hidden" name="currency_code" value="USD" />
  <input type="hidden" name="item_name_1" value="Product 1">
  <input type="hidden" name="item_number_1" value="1">
  <input type="hidden" name="item_amount_1" value="60">
  <input type="hidden" name="quantity_1" value="1">
  <input type="hidden" name="item_name_2" value="Product 2">
  <input type="hidden" name="item_number_2" value="4">
  <input type="hidden" name="item_amount_2" value="10">
  <input type="hidden" name="quantity_2" value="1">
  <input type="submit" name="submit" value="Pay with Paypal"  />
</form> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:13:19.690

为金额提供的名称不正确。代替

```
<input type="hidden" name="item_amount_2" value="10"> 
```

采用

```
<input type="hidden" name="amount_2" value="10"> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T00:39:58.827

变量“handling_cart”应该可以工作。如果您将帐户设置为不允许基于交易的运输覆盖您的配置文件运输，则它将不起作用。在您的 PayPal 帐户中仔细检查您的运输资料，并确保您已将其设置为允许基于交易的运输覆盖您的资料。

# - Q多边形

> ID：15373960
> 
> 赞同：0
> 
> 时间：2013-03-12T23:04:04.363
> 
> 标签：

QPolygon 类是 Qt 框架的一部分，它使用整数精度提供点向量。

# php - PHP PDO bindValue in LIMIT

> ID：15373962
> 
> 赞同：0
> 
> 时间：2013-03-12T23:04:07.397
> 
> 标签：php, mysql, sql, pdo

有人请帮助我，为什么我总是得到这个错误，以及解决方案是什么：

> 失败：SQLSTATE[42000]：语法错误或访问冲突：1064 您的 SQL 语法有错误；检查与您的 MySQL 服务器版本相对应的手册，以在第 1 行的“5”附近使用正确的语法

## 类.database.inc.php

我写了这个类来自动化我的 sql 查询。效果很好，除非我想将值绑定到 SQL LIMIT 操作：

```
class Database extends PDO
{
    private $engine;
    private $host;
    private $database;
    private $user;
    private $pass;

    private $tablename;
    private $valueArray;
    private $optionArray;

    public function __construct($engine,$charset,$host,$database,$user,$pass)
    {
        $this->engine   = $engine;
        $this->charset  = $charset;
        $this->host     = $host;
        $this->database = $database;
        $this->user     = $user;
        $this->pass     = $pass;
        $dns = $this->engine.':dbname='.$this->database.';charset='.$this->charset.';host='.$this->host;
        parent::__construct($dns,$this->user,$this->pass);
        $this->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
    }

    private function runSQL($sql=NULL,$valueArray=NULL)
    {
        $sth = $this->prepare($sql);
        if(isset($valueArray))
        {
            foreach($valueArray as $values)
            {
                foreach($values as $key => $value)
                {
                    $paramDataType = $this->getPdoParamDataType($value);
                    $sth->bindValue($key,$value,$paramDataType);
                }
                $sth->execute($values);
            }
        }
        else
        {
            $sth->execute();
        }
        return $sth;
    }

    private function getPdoParamDataType($variable)
    {
        $variableType = gettype($variable);
        switch ($variableType)
        {
            case 'integer':
                return PDO::PARAM_INT;
                break;
            case 'string':
                return PDO::PARAM_STR;
                break;
            case 'double':
                return PDO::PARAM_STR;
                break;
            case 'boolean':
                return PDO::PARAM_BOOL;
                break;
            case 'NULL':
                return PDO::PARAM_NULL;
                break;
        }
    }

    private function fetchRows($sth=NULL)
    {
        $result = $sth->fetchAll(PDO::FETCH_ASSOC);
        return $result;
    }

    private function getTableStructure($tableName=NULL)
    {
        $this->tableName  = $tableName;
        $sql = 'DESCRIBE '.$this->tableName;
        $tableStructureArray = $this->fetchRows($this->runSQL($sql));
            return $tableStructureArray;
    }

    public function getRecords($tableName=NULL,$options=NULL,$valueArray=NULL)
    {
        $this->tableName  = $tableName;
        $this->valueArray = $valueArray;
        $options=' '.$options;
        $columnFields = $this->getTableStructure($this->tableName);
        $sql = 'SELECT '.implode(', ',$columnFields).' FROM '.$tableName.$options;
        return $this->fetchRows($this->runSQL($sql,$this->valueArray));
    }
} 
```

## 测试.php

这就是我使用它的方式：

```
function __autoload($class_name)  
{  
    include_once 'classes/class.' . $class_name . '.inc.php';  
} 
$pdo = new Database('mysql','utf8','localhost','database','password','');
try
{
    $valueArray = array(
                        array(':limit'=>5)
                        );
    $pdo->beginTransaction();
    $result = $pdo->getRecords('my table name','LIMIT :limit',$valueArray);
    $pdo->commit();
}
catch (Exception $e)
{
  $pdo->rollBack();
  echo "Failed: " . $e->getMessage();
} 
```

如果我改变这一行：

```
$result = $pdo->getRecords('my table name','LIMIT :limit',$valueArray); 
```

对此：

```
$result = $pdo->getRecords('my table name','LIMIT 5'); 
```

它运作良好。

知道有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:22:48.373

这里的整个 foreach 都是 NOOP，因为在执行时传递变量会覆盖它。

```
foreach($values as $key => $value) {
    $paramDataType = $this->getPdoParamDataType($value);
    $sth->bindValue($key,$value,$paramDataType);
}
$sth->execute($values); // this makes the previous loop a NOOP. 
```

我建议你删除它，也不要尝试显式设置数据类型。PDO 将推断出正确的类型。

另外，我敢打赌，如果你在准备之前回显 $sql，语法错误会很明显。

# javascript - 有人可以解释我是如何搞砸的，为什么它会起作用以及我如何纠正它

> ID：15373963
> 
> 赞同：0
> 
> 时间：2013-03-12T23:04:09.140
> 
> 标签：javascript, google-maps, google-maps-api-3

我有一个奇怪的情况。[就在最近，由于上一个问题](https://stackoverflow.com/q/15198102/2110460)，我一直在尝试将一些代码从程序更改为基于对象。

我在代码中有几个地方调用函数中的函数（请原谅，我仍在学习 Javascript 的术语），因此“this”具有不同的范围。

在试图保持与父“this”的连接时，我试图通过将“thisObj = this”添加到函数调用中来将变量传递给函数，如下所示

```
geoLoc: function () {
    "use strict";
    var thisObj;
    if (navigator.geolocation !== undefined) {
        navigator.geolocation.getCurrentPosition(function (position) {
            thisObj.calcRoute('driving', position.coords.latitude + ', ' + position.coords.longitude, true);
        }, thisObj = this);
    }
}, 
```

所以，这适用于 FF，所以我认为它一定没问题。用 jslint 检查，一切都变成绿色（或黄色/蓝色），看不到任何错误。

然而，Chrome 决定存在“不匹配 dom 异常 17”并决定不使用地理位置。

碰巧，我尝试移动该定义，使其读作

```
geoLoc: function () {
    "use strict";
    var thisObj;
    if (navigator.geolocation !== undefined) {
        navigator.geolocation.getCurrentPosition(function (position) {
            thisObj.calcRoute('driving', position.coords.latitude + ', ' + position.coords.longitude, true);
        }), thisObj = this;
    }
}, 
```

令我惊讶的是，它在 FF 和 Chrome 中都有效。不幸的是，它在 jslint 中失败了，而 IE 只是踢了它的脚跟而死了。

现在，我的问题是，我到底做了什么让它与 FF 一起运行并通过 jslint 以及如何在不诉诸于在第二个函数中实际命名对象的情况下纠正这种情况，所以我可以通过对它的引用。

请不要jquery。直接的javascript。比修复它的代码更重要的是，解释一下我实际上做了什么……如果可能的话，请用外行的话，所以我可以进一步调查。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:10:02.190

在 Javascript 中，您不需要到处传递变量，因为函数可以访问在“上方”函数中声明的变量。`this`因此，您可以在名为`that`（仅用于示例）的变量中保存对当前对象的引用，如下所示：

```
geoLoc: function () {
    "use strict";
    var that = this;
    if (navigator.geolocation !== undefined) {
        navigator.geolocation.getCurrentPosition(function (position) {
            that.calcRoute('driving', position.coords.latitude + ', ' + position.coords.longitude, true);
        }/* if you try to "add" something there, it comes as a 2nd argument for getCurrentPosition*/);
    }
}, 
```

您也可以说内部函数“包含”外部函数的范围，这是非常特定于 Javascript 的，并且在其设计和使用它设计应用程序时非常有趣。有关更多信息，请在 JS 中查找“函数范围”和“闭包”。

**编辑：** in 的第二个参数`navigator.geolocation.getCurrentPosition`预计是一个错误回调，即一个函数，并且您试图放在`, thisObj = this`那里，这可能会导致一些浏览器故障或 - 执行`this`时 -`thisObj`在调用成功回调（的第一个参数`getCurrentPosition`）之前实际分配因此在其他浏览器上有点“工作”。无论如何，这是不可靠的，应该避免。

我认为您需要从 JS 的基本语法特性开始，例如使用函数作为其他函数的变量和参数（这就是“回调”），这是其中的一个主要概念。而不是随机尝试移动部分代码（我的观点）。

# ruby - 快速解谜

> ID：15373965
> 
> 赞同：6
> 
> 时间：2013-03-12T23:04:13.587
> 
> 标签：ruby, algorithm, big-o, anagram

给定两个字符串，我想确定它们是否是彼此的字谜。这是我想出的解决方案：

```
# output messages
def anagram
    puts "Anagram!"
    exit 
end

def not_anagram
    puts "Not an anagram!"
    exit
end

# main method
if __FILE__ == $0
   # read two strings from the command line
   first, second = gets.chomp, gets.chomp

   # special case 1
   not_anagram if first.length != second.length

   # special case 2
   anagram if first == second

   # general case
   # Two strings must have the exact same number of characters in the
   # correct case to be anagrams.
   # We can sort both strings and compare the results
   if first.chars.sort.join == second.chars.sort.join
      anagram
   else
      not_anagram
   end
end 
```

但我认为可能有更好的。我分析了这个方案的效率，得出了：

*   `chars`: 将字符串拆分为字符数组`O(n)`
*   `sort`：按字母顺序对字符串进行排序，我不知道如何在 Ruby 中实现排序，但我认为`O(n log n)`这是众所周知的排序效率
*   `join`: 从一个字符数组构建一个字符串`O(n)`
*   `==`：字符串比较本身必须检查字符串的每个字符`2*O(n)`

Given the above, I categorized the efficiency of the entire solution as `O(n log n)` since sorting had the highest efficiency. Is there a better way to do this that is more efficient than `O(n log n)`?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-12T23:11:51.290

Your big O should be `O(n*lg(n))` since the sort is the limiting function. If you try it with very big anagrams you will see a loss of performance higher than expected for an `O(n)` solution.

You can do an `O(n)` solution by comparing counts in two maps of characters => character counts.

There are definitely other solutions that work with approximately the same complexity but I don't think you can come up with anything faster than `O(n)`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-12T23:43:38.207

Example of counting:

```
def anagram?(str_a, str_b)
  if str_a.length != str_b.length
    false
  else
    counts = Hash.new(0)
    str_a.each_char{ |c| counts[c] += 1 }
    str_b.chars.none?{ |c| (counts[c] -= 1) < 0 }
  end
end

anagram? 'care', 'race'
# => true
anagram? 'cat', 'dog'
# => false 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-13T11:40:09.020

You can do it in `O(n+m)` where m is length of alphabet

1.Create an array of size equal to the size of your input alphabet.

2.Initialize all the values in the array to '0'.

3.Scan the first input string, increment the corresponding value in the array for each character (like increment array[0] if first letter in the alphabet it found).

4.Repeat the same for the second string, except in this case the value in the array need to be decremented.

If all the values in the array are '0's then the two strings are anagrams, else they are not.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-13T06:02:50.957

I needed something to check anagrams, and came up with this:

```
def string_to_array(s)
  s.downcase.gsub(/[^a-z]+/, '').split('').sort
end

def is_anagram?(s1, s2)
  string_to_array(s1) == string_to_array(s2)
end

puts is_anagram?("Arrigo Boito",       "Tobia Gorrio")
puts is_anagram?("Edward Gorey",       "Ogdred Weary")
puts is_anagram?("Ogdred Weary",       "Regera Dowdy")
puts is_anagram?("Regera Dowdy",       "E. G. Deadworry")
puts is_anagram?("Vladimir Nabokov",   "Vivian Darkbloom")
puts is_anagram?("Vivian Darkbloom",   "Vivian Bloodmark")
puts is_anagram?("Dave Barry",         "Ray Adverb")
puts is_anagram?("Glen Duncan",        "Declan Gunn")
puts is_anagram?("Damon Albarn",       "Dan Abnormal")
puts is_anagram?("Tom Cruise",         "So I'm cuter")
puts is_anagram?("Tom Marvolo Riddle", "I am Lord Voldemort")
puts is_anagram?("Torchwood",          "Doctor Who")
puts is_anagram?("Hamlet",             "Amleth")
puts is_anagram?("Rocket boys",        "October Sky")
puts is_anagram?("Imogen Heap",        "iMegaphone") 
```

# - 矩形

> ID：15373969
> 
> 赞同：0
> 
> 时间：2013-03-12T23:04:38.230
> 
> 标签：

QRect 类是 Qt 框架的一部分，它使用整数精度在平面中定义一个矩形。

# python - 在 simplekml 中显示本地图像

> ID：15373973
> 
> 赞同：5
> 
> 时间：2013-03-12T23:04:59.233
> 
> 标签：python, maps, kml, google-earth, simplekml

我正在尝试使用[simplekml](https://code.google.com/p/simplekml/)将一堆带有地理标记的照片放入 KML 文件（实际上是一个 KMZ 文件）以在 Google 地球中查看。我已经获得了要显示的位置，但是当我尝试将图像放在“描述”中时，所以当我单击图像出现的位置时，它不起作用。只有一个空白图像。我正在尝试使用[此处](http://simplekml.readthedocs.org/en/latest/kml.html#simplekml.Kml.addfile)显示的 addfile() 命令来完成此操作。我的代码如下所示：

```
import os, simplekml

path = r'C:\Users\as\Desktop\testpics'                     

kml = simplekml.Kml()

for (dirpath, dirnames, filenames) in os.walk(path):
    for filename in filenames:
        fullpath = os.path.join(dirpath, filename)
        try:
            Lat, Long, Alt = GetLatLong(fullpath) #Didn't include this function, but it appears to work
        except:
            Lat, Long, Alt = (None, None, None)
        if Lat: #Only adds to kml if it has Lat value.
            x, y = (FormatLatLong(Lat), FormatLatLong(Long)) #puts into decimal coords
            point = kml.newpoint(name = filename , coords = [(y,x)])
            picpath = kml.addfile(fullpath)
            point.description = '<img src="' + picpath +'" alt="picture" width="400" height="300" align="left" />'

kml.savekmz("kmltest2.kmz", format = False) 
```

如您所见，我已经从上面页面的说明中剪切并粘贴了使用“addfile”的说明。point.description 行似乎是出了问题的地方。

图片被添加到 kmz 档案中，但它们没有出现在位置气泡中。我认为这可能是因为我在 Windows 7 上执行此操作并且斜线是向后的，但我尝试手动将 files\image.jpg 更改为 files/image.jpg 并没有修复它。生成的 KMZ doc.kml 文件如下所示：

```
 <kml xmlns="http://www.opengis.net/kml/2.2"xmlns:gx="http://www.google.com/kml/ext/2.2">
    <Document id="feat_1">
    <Placemark id="feat_2">
    <name>DSC00001.JPG</name>
    <description>&lt;img src="files/DSC00001.JPG" alt="picture" width="400" height="300" align="left" /&gt;</description>
    <Point id="geom_0"><coordinates>18.9431816667,9.44355222222,0.0</coordinates>
    </Point></Document></kml> 
```

（我已经删除了除一点以外的所有点）非常感谢，亚历克斯

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-14T11:08:53.930

可能是因为您编写的 kml 文件中未闭合的地标标签。所以在点标签关闭后关闭地标标签。

```
<kml xmlns="http://www.opengis.net/kml/2.2"xmlns:gx="http://www.google.com/kml/ext/2.2">
    <Document id="feat_1">
    <Placemark id="feat_2">
    <name>DSC00001.JPG</name>
    <description>&lt;img src="files/DSC00001.JPG" alt="picture" width="400" height="300" align="left" /&gt;</description>
    <Point id="geom_0"><coordinates>18.9431816667,9.44355222222,0.0</coordinates>
    </Point></Placemark></Document></kml> 
```

如果放置地点标记标签后上述代码不起作用，请尝试使用气球样式而不是描述标签尝试使用以下代码

```
<kml xmlns="http://www.opengis.net/kml/2.2"
     xmlns:gx="http://www.google.com/kml/ext/2.2" 
     xmlns:kml="http://www.opengis.net/kml/2.2" 
     xmlns:atom="http://www.w3.org/2005/Atom"
>
<Document id="feat_1">
<Placemark id="feat_2">
<name>DSC00001.JPG</name>
<Style>
<BalloonStyle>
<text><![CDATA[
 <table width=100% cellpadding=0 cellspacing=0>
  <tr><td><img width=100% src='files/DSC00001.jpg' /></td></tr></table>]]>
</text>
</BalloonStyle>
</Style> 
<Point id="geom_0">
<coordinates>18.9431816667,9.44355222222</coordinates>
</Point>
</Placemark>
</Document>
</kml> 
```

# version-control - VS 2012 P4SCC 自动签出不起作用

> ID：15373975
> 
> 赞同：1
> 
> 时间：2013-03-12T23:05:08.140
> 
> 标签：version-control, visual-studio-2012, perforce

有没有人在 VS 2012 中使用过旧的 P4SCC 插件，并且偶然发现自动签出不起作用？如果是这样，你解决了吗？

我确保源代码管理已启动并正在运行，并且在工具-选项-源代码管理-环境-保存中选择了“自动签出”。

尽管如此，每次我保存修改后的文件时，它都会显示“另存为”对话框。令人沮丧...

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-07-26T14:44:47.163

我不知道这是否与您的具体问题有关，但我的自动签出也与您描述的方式相同（使用没有 P4SCC 的 TFS）。

就我而言，问题在于解决方案恰好处于脱机状态。右键单击解决方案名称（在解决方案资源管理器中）->“联机”，问题已解决！

# c# - 文本字段字符串在 C# 中被剪切

> ID：15373977
> 
> 赞同：0
> 
> 时间：2013-03-12T23:05:14.600
> 
> 标签：c#, mysql, .net

我知道 c# 中的字符串类型可以保存一个长字符串，所以为什么当我从 asp.net 表单传递文本时，在该字符串变量中，文本实际上被剪切了。

当我跟踪代码时，我可以在文本可视化器中看到整个长字符串都在那里，但是在运行代码之后，我可以看到这个字符串变量数据在 MySQL 数据库中被削减了一半。MySQL 中的列大小为 TEXT，最多可容纳 4 GB。

所以我想知道是否有人知道这个字符串截断是怎么回事。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-12T23:06:38.470

TEXT 最多可包含 65,535 个字符。如果您的内容超过 64K 字节，则您可能超出了字段字符的限制。

要对此进行测试，您可以将字段类型更改为 MEDIUMTEXT 或 LONGTEXT

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:11:23.940

根据 MySQL dosc TEXT 字段最多可容纳 L + 2 个字节，其中 L < 2^16。-> [http://dev.mysql.com/doc/refman/5.6/en/storage-requirements.html](http://dev.mysql.com/doc/refman/5.6/en/storage-requirements.html)

如果一个字符占用 2 个字节，则最大大小为 ~32.7k 字符。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-12T23:15:11.140

[http://www.electrictoolbox.com/maximum-length-mysql-text-field-types/](http://www.electrictoolbox.com/maximum-length-mysql-text-field-types/)

> TEXT 数据类型还能够存储比 VARCHAR 和 CHAR 文本类型更多的数据，因此在数据库中存储网页或类似内容时需要使用 TEXT 类型。
> 
> 每种数据类型可以存储的最大数据量如下：
> 
> TINYTEXT 256 字节
> 
> 文本 65,535 字节 ~64kb
> 
> 中文本 16,777,215 字节 ~16MB
> 
> LONGTEXT 4,294,967,295 字节 ~4GB
> 
> 在大多数情况下，TEXT 类型可能就足够了，但如果您正在编写内容管理系统，最好对较长的页面使用 MEDIUMTEXT 类型，以确保不会出现数据大小限制的问题。

更新： SqlParameter.Size （我假设 MySQL 也是如此）可以在将字符串内容发送到数据库之前对其进行剪切。

[http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.size.aspx](http://msdn.microsoft.com/en-us/library/system.data.sqlclient.sqlparameter.size.aspx)

> 对于具有可变长度类型（例如 nvarchar）的输出参数，参数的大小定义了保存输出参数的缓冲区的大小。可以将输出参数截断为使用 Size 指定的大小。对于字符类型，使用 Size 指定的大小以字符为单位。
> 
> 如果未显式设置，则从指定参数值的实际大小推断大小。

所以删除设置 ADO.NET 参数的 Size 参数的代码或尝试将其设置为 int.Max 值。

# ios - Xcode 线程 1：它总是主 UI 线程吗？

> ID：15373979
> 
> 赞同：8
> 
> 时间：2013-03-12T23:05:23.453
> 
> 标签：ios, xcode, thread-safety

Xcode 在 Debug navigator 中显示线程。

它们编号为：`Thread 1`, `Thread 2`, 等

我注意到我总是在线程 1 中。假设它是主 UI 线程是否正确？我使用 libs/SDK 之类的`Facebook`，`AFNetworking`它们有回调和委托。但是线程安全并不总是被正确记录。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-12T23:18:51.273

我不记得是哪一个了，但是在一个 WWDC 视频中（我想是从 2011 年开始），我听到一位工程师提到 UIKit 内部假设线程 1 是 UI。

所以是的，这不是“简单”的最佳实践，我认为存在具体的技术依赖关系。

至于具体文件，我不容易找到“官方”声明；但我认为这是因为它比这更基础。例如，这种对主线程角色的随意提及到处都是（取自[iOS App Programming Guide](https://developer.apple.com/library/ios/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/PerformanceTuning/PerformanceTuning.html#//apple_ref/doc/uid/TP40007072-CH8-SW11)（例如iOS 101）

> 主线程是您的应用处理触摸事件和其他用户输入的地方。

# lisp - LISP：如何获得列表的运行总和？（没有全局变量）

> ID：15373982
> 
> 赞同：6
> 
> 时间：2013-03-12T23:05:34.610
> 
> 标签：lisp, common-lisp

我是 LISP 新手。

为了得到一个列表的总和，我写的是——

```
(setf sum 0.0)
(mapcar #'(lambda(x)
    (setf sum (+ sum x)) sum) values)) 
```

例如，如果您`'(1 2 3 4)`作为输入给出，上面的代码将`'(1 3 6 10)`作为输出返回，依此类推。

是否可以在不使用全局变量的情况下（以更优雅的方式）做同样的事情`sum`？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-13T01:09:43.300

```
(loop for x in '(1 2 3 4) sum x into y collect y) 
```

`scanl`是单线：

```
(defun scanl (f init xs)
  (loop for x in xs collect (setf init (funcall f init x)))) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-12T23:41:31.123

你可以`loop`像这样使用：

```
(defun running-sum (xs)
  (loop with sum = 0
        for x in xs
        collect (setf sum (+ sum x))))

(running-sum '(1 2 3 4)) 
```

它本质上是一样的，但它使用局部变量而不是全局变量，并且可能更清楚。

或者，您可以定义一个递归函数和一个包装函数：

```
(defun running-sum-recursive (xs)
  (running-sum-recursive2 0 xs))

(defun running-sum-recursive2 (sum xs)
  (if (eq xs nil)
    nil
    (let ((new-sum (+ sum (car xs))))
      (cons new-sum (running-sum-recursive2 new-sum (cdr xs))))))

(running-sum-recursive '(1 2 3 4)) 
```

`loop`然而，当可用时，这对我来说似乎是不必要的复杂。

请注意，在 Haskell 中，您可以像这样进行运行总和：

```
runningSum xs = scanl1 (+) xs

runningSum [1, 2, 3, 4] 
```

这里的关键是[`scanl1`函数](http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#g:15)。Lisp 中可能存在类似的东西（我们现在几乎写了两次），但我有一段时间没有使用 Lisp。

编辑：经过一番搜索，我不认为 Common Lisp 包含任何类似`scanl`or的东西`scanl1`，所以它们是：

```
(defun scanl (f val xs)
  (loop for x in xs
        collect (setf val (funcall f val x))))

(defun scanl1 (f xs)
  (cons (car xs)
        (scanl f (car xs) (cdr xs))))

(scanl1 #'+ '(1 2 3 4)) 
```

编辑：感谢怀远关于如何缩短循环的建议的回答。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-16T16:18:17.260

或者你可以使用高阶函数

```
(define (running-sum ls)
     (cdr (reverse (foldl (lambda (y xs) (cons (+ (car xs) y) xs)) '(0) ls)))) 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-03-13T09:56:25.457

Haskell 确实有丰富的列表递归函数清单，但我们`reduce`至少有。这是一个基本的（即没有`loop`魔法的）功能解决方案：

```
(defun running-sum (lst)
  (reverse (reduce (lambda (acc x)
                     (cons (+ (first acc) x) acc))
                   (rest lst)
                   :initial-value (list (first lst))))) 
```

我使用原始列表的头部作为初始值并遍历列表的其余部分，在头部添加总和（因为在头部添加是很自然的），最后反转由此获得的列表。

`reduce`在大多数情况下，当需要遍历一个累积值的序列时，可以使用它。

这是使用`push`-`nreverse`成语的基本迭代解决方案：

```
(defun running-sum (lst)
  (let ((sums (list (first lst))))
    (dolist (x (rest lst))
      (push (+ x (first sums)) sums))
    (nreverse sums))) 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-13T00:22:07.463

在方案中，我将使用累加器递归地计算列表的总和。像这样：

```
; Computes a list of intermediary results of list summation
(define list-sum
  (lambda (l)
    (letrec ((recsum (lambda (lst acc acclst)
      (if (pair? lst)
        (recsum (cdr lst) (+ acc (car lst)) (cons acc acclst))
        (cons acc acclst)))))
    (recsum (cdr l) (car l) '())))) 
```

输出：

```
> (list-sum '(1 2 3 4))   
(10 6 3 1)
> (list-sum '(2 4 6 8 10))
(30 20 12 6 2)
> 
```

递归列表的诀窍是每次取出第一个元素/汽车并传递其余/cdr。您可以通过使用额外的参数（称为累加器）来保留中间结果并在其中传递总和。我在上面使用了两个累加器：一个用于最后一个总和，一个用于所有先前总和的列表。

我从来没有在 LISP 中做过任何事情，所以我不知道这是否直接转化为你的方言（？），但它在概念上很简单，我相信它在 LISP 中也是可行的。

一定要问是否有什么事情不是很清楚。自从我使用这一系列语言以来已经有一段时间了:)

# asp.net-mvc - 如何将 JSON 绑定到方法中的模型？

> ID：15373983
> 
> 赞同：1
> 
> 时间：2013-03-12T23:05:42.383
> 
> 标签：asp.net-mvc, json, model-binding

我了解 MVC4 可以自动将 json 绑定到类型模型。

例如，采用**HTMLItem**模型。

在方法的一部分中，我使用 HttpRequest 和 StreamReader 从外部站点以 json 格式检索**HTMLItem模型数据。**我将其作为字符串抓取，然后想将其传递给另一个以 HTMLItem 作为参数的方法。

如何确保接收方法将其作为我需要的类型（**HTMLItem**）处理？它目前不承认它是这样的。

我尝试在原始方法中将字符串分配给模型，但 IDE 给了我红色波浪线，用于将字符串分配给另一种类型。

如果可能，我不想遍历 json 字符串并手动分配每个字段。

任何帮助，一如既往，非常感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T00:11:56.050

您可以将 JSON 反序列化为您的模型，例如：

```
using System.Web.Script.Serialization;
...

JavaScriptSerializer serializer = new JavaScriptSerializer();
YourModelType model = serializer.Deserialize<YourModelType>(yourJSON); 
```

# r - R和跨列循环

> ID：15373988
> 
> 赞同：0
> 
> 时间：2013-03-12T23:05:54.803
> 
> 标签：r

我有“Sec1OSp”，它看起来像这样：

```
TIMEBLOCK   ep.HRC_E    ep.HRC_D    ep.HRCcm_E  ep.HRCcm_D
   1           NA          NA          NA          NA
   2           NA          NA          NA          NA
   3           NA          NA          NA          NA
   4           NA          NA          NA          NA
   5           NA          NA          NA          NA
   6           NA          5           5           5
   7           NA          5           10          5
   8           NA          5           20          5
   9           NA          5           20          5 
   10          NA          10          20          10
   11          20          10          20          10
   12          20          10          20          10
   13          20          NA          20          10
   14          20          NA          20          10
   15          10          NA          10          10
   16          10          NA          10          5
   17          NA          NA          NA          NA
   18          NA          NA          NA          NA
   19          NA          NA          NA          NA
   20          NA          NA          NA          NA
   21          NA          NA          NA          NA
   22          NA          NA          NA          NA
   23          NA          NA          NA          NA
   24          NA          NA          NA          NA 
```

我有“data.EP.S1p”，它看起来像这样：

```
TIMEBLOCK   ep.HRC_E    ep.HRC_D    ep.HRCcm_E  ep.HRCcm_D
   1           NA          NA          NA          NA
   2           NA          NA          NA          NA
   3           NA          NA          NA          NA
   4           NA          NA          NA          NA
   5           NA          NA          NA          NA
   6           NA          NA          NA          NA
   7           NA          NA          NA          NA
   8           NA          NA          NA          NA
   9           NA          NA          NA          NA
   10          NA          NA          NA          NA
   11          20          NA          NA          NA
   12          20          NA          NA          NA
   13          20          NA          NA          NA
   14          20          NA          NA          NA
   15          10          NA          NA          NA
   16          10          NA          NA          NA
   17          NA          NA          NA          NA
   18          NA          NA          NA          NA
   19          NA          NA          NA          NA
   20          NA          NA          NA          NA
   21          NA          NA          NA          NA
   22          NA          NA          NA          NA
   23          NA          NA          NA          NA
   24          NA          NA          NA          NA 
```

此代码（如下）当前使用来自 Sec1OSp$ep.HRC_E 的数据来填充 data.EP.S1p$ep.HRC_E。

```
 for(t in 1:24) {
    Sec1OSpt <- subset(Sec1OSp, TIMEBLOCK==t)
    Sec1OSptnonNArows <- Sec1OSpt[!is.na(Sec1OSpt$ep.HRC_E),]
    if(nrow(Sec1OSptnonNArows) > 0) {
      if(sum(Sec1OSptnonNArows$ep.HRC_E, na.rm=TRUE) > 0) {
        data.EP.S1p$ep.HRC_E[t] <- (sum(Sec1OSptnonNArows$ep.HRC_E, na.rm=TRUE)) / nrow(Sec1OSptnonNArows)
      }
      else {
        data.EP.S1p$ep.HRC_E[t] <- NA
      }
    } 
```

我希望能够循环此代码，以便将其应用于所有 4 列，从而使用 Sec1OSp 中的 4 列来填充 data.EP.S1p 中的 4 列有人有我的解决方案吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T01:21:34.643

如果我理解正确，您首先要找到 4 列的每个值的平均值`TIMEBLOCK`。您可以通过使用`aggregate`函数来做到这一点。之后，您可以在`data.EP.S1p`使用中填写这些值`merge`

```
Sec1OSp <- read.table(textConnection("TIMEBLOCK   ep.HRC_E    ep.HRC_D    ep.HRCcm_E  ep.HRCcm_D\n1           NA          NA          NA          NA\n2           NA          NA          NA          NA\n3           NA          NA          NA          NA\n4           NA          NA          NA          NA\n5           NA          NA          NA          NA\n6           NA          5           5           5\n7           NA          5           10          5\n8           NA          5           20          5\n9           NA          5           20          5\n10          NA          10          20          10\n11          20          10          20          10\n12          20          10          20          10\n13          20          NA          20          10\n14          20          NA          20          10\n15          10          NA          10          10\n16          10          NA          10          5\n17          NA          NA          NA          NA\n18          NA          NA          NA          NA\n19          NA          NA          NA          NA\n20          NA          NA          NA          NA\n21          NA          NA          NA          NA\n22          NA          NA          NA          NA\n23          NA          NA          NA          NA\n24          NA          NA          NA          NA"), 
    header = TRUE)

data.EP.S1p <- read.table(textConnection("TIMEBLOCK   ep.HRC_E    ep.HRC_D    ep.HRCcm_E  ep.HRCcm_D\n1           NA          NA          NA          NA\n2           NA          NA          NA          NA\n3           NA          NA          NA          NA\n4           NA          NA          NA          NA\n5           NA          NA          NA          NA\n6           NA          NA          NA          NA\n7           NA          NA          NA          NA\n8           NA          NA          NA          NA\n9           NA          NA          NA          NA\n10          NA          NA          NA          NA\n11          20          NA          NA          NA\n12          20          NA          NA          NA\n13          20          NA          NA          NA\n14          20          NA          NA          NA\n15          10          NA          NA          NA\n16          10          NA          NA          NA\n17          NA          NA          NA          NA\n18          NA          NA          NA          NA\n19          NA          NA          NA          NA\n20          NA          NA          NA          NA\n21          NA          NA          NA          NA\n22          NA          NA          NA          NA\n23          NA          NA          NA          NA\n24          NA          NA          NA          NA"), 
    header = TRUE)

avgdata <- aggregate(Sec1OSp[, 2:5], by = list(Sec1OSp$TIMEBLOCK), FUN = function(x) mean(x, na.rm = TRUE))
names(avgdata)[1] <- "TIMEBLOCK"
avgdata
##    TIMEBLOCK ep.HRC_E ep.HRC_D ep.HRCcm_E ep.HRCcm_D
## 1          1      NaN      NaN        NaN        NaN
## 2          2      NaN      NaN        NaN        NaN
## 3          3      NaN      NaN        NaN        NaN
## 4          4      NaN      NaN        NaN        NaN
## 5          5      NaN      NaN        NaN        NaN
## 6          6      NaN        5          5          5
## 7          7      NaN        5         10          5
## 8          8      NaN        5         20          5
## 9          9      NaN        5         20          5
## 10        10      NaN       10         20         10
## 11        11       20       10         20         10
## 12        12       20       10         20         10
## 13        13       20      NaN         20         10
## 14        14       20      NaN         20         10
## 15        15       10      NaN         10         10
## 16        16       10      NaN         10          5
## 17        17      NaN      NaN        NaN        NaN
## 18        18      NaN      NaN        NaN        NaN
## 19        19      NaN      NaN        NaN        NaN
## 20        20      NaN      NaN        NaN        NaN
## 21        21      NaN      NaN        NaN        NaN
## 22        22      NaN      NaN        NaN        NaN
## 23        23      NaN      NaN        NaN        NaN
## 24        24      NaN      NaN        NaN        NaN

data.EP.S1p <- merge(data.EP.S1p[, "TIMEBLOCK", drop = FALSE], avgdata, all.x = TRUE)
data.EP.S1p
##    TIMEBLOCK ep.HRC_E ep.HRC_D ep.HRCcm_E ep.HRCcm_D
## 1          1      NaN      NaN        NaN        NaN
## 2          2      NaN      NaN        NaN        NaN
## 3          3      NaN      NaN        NaN        NaN
## 4          4      NaN      NaN        NaN        NaN
## 5          5      NaN      NaN        NaN        NaN
## 6          6      NaN        5          5          5
## 7          7      NaN        5         10          5
## 8          8      NaN        5         20          5
## 9          9      NaN        5         20          5
## 10        10      NaN       10         20         10
## 11        11       20       10         20         10
## 12        12       20       10         20         10
## 13        13       20      NaN         20         10
## 14        14       20      NaN         20         10
## 15        15       10      NaN         10         10
## 16        16       10      NaN         10          5
## 17        17      NaN      NaN        NaN        NaN
## 18        18      NaN      NaN        NaN        NaN
## 19        19      NaN      NaN        NaN        NaN
## 20        20      NaN      NaN        NaN        NaN
## 21        21      NaN      NaN        NaN        NaN
## 22        22      NaN      NaN        NaN        NaN
## 23        23      NaN      NaN        NaN        NaN
## 24        24      NaN      NaN        NaN        NaN 
```

# drupal - 更改图像字段的内容

> ID：15373990
> 
> 赞同：0
> 
> 时间：2013-03-12T23:05:58.217
> 
> 标签：drupal, drupal-7, imagefield

我只是想`node_save()`在我的文章中使用更改图像字段的值，并且我正在使用以下代码。

```
$node = node_load(1);
$node->field_image["und"][0]["filename"] = $file_name;
node_save($node); 
```

当我按 F5 时，我文章中的图像没有改变。

我的代码有什么问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-13T09:32:18.910

我发现处理此类问题的最简单方法是使用[Devel](http://drupal.org/project/devel)模块。

在您的代码中，您可以这样做：

```
$node = node_load(1);
dsm($node);
....
node_save($node);
dsm($node); 
```

开发 dsm() 函数将输出节点的属性，您将能够检查您想要编辑的任何值。

在上面的示例中，我可以在编辑之前和之后检查。如果一切看起来都正确，那么这只是清除缓存的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-13T06:59:28.600

一旦我做了这样的事情，它可能不是最好的，但它对我有用：

```
$file = file_load($node->field_image['und'][0]['fid']);
unset($node->field_image['und'][0]);
file_delete($file);

$file_path = drupal_realpath('sites/default/files/image.png');
$file = (object) array(
          'uid' => 1,
          'uri' => $file_path,
          'filemime' => file_get_mimetype($file_path),
          'status' => 1,
 ); 
$file = file_copy($file, 'public://');
$node->field_im['und'][0] = (array) $file; 
```

# java - 在 Java 小程序中加载面板的内容

> ID：15373997
> 
> 赞同：0
> 
> 时间：2013-03-12T23:06:31.103
> 
> 标签：java, swing, applet

我正在尝试将面板加载到 java 小程序中，但面板的内容没有填充。从下面的代码中可以看到，我设置了一个测试，看看面板中的代码在哪里运行失败，我的测试结果表明**getRootPane().add(MyLabel)**是触发的代码行例外。

重新创建此问题所需的所有代码都包含在下面。谁能告诉我如何更改下面的代码，以便将面板的内容加载到小程序中？

下面是 TestApplet.java 的代码：

```
import javax.swing.JApplet;
import javax.swing.SwingUtilities;

public class TestApplet extends JApplet {

    public void init(){//Called when this applet is loaded into the browser.
        //Execute a job on the event-dispatching thread; creating this applet's GUI.
        try {
            SwingUtilities.invokeAndWait(new Runnable() {
                public void run() {
                    createGUI();
                }
            });
        } catch (Exception e) {
            System.err.println("createGUI didn't complete successfully");
        }
    }
    private void createGUI(){
        TestPanel myPanel = new TestPanel();
        myPanel.setOpaque(true);
        setContentPane(myPanel);
    }
} 
```

这是 TestPanel.java 的代码：

```
import javax.swing.JLabel;
import javax.swing.JPanel;

public class TestPanel extends JPanel{

    TestPanel(){
        System.out.println("Running in constructor.  ");
        JLabel myLabel = new JLabel("Hello World");
        getRootPane().add(myLabel);
        System.out.println("Still running in constructor.  ");
    }
} 
```

## **编辑：**

根据迄今为止给出的建议，我按如下方式编辑了我的代码。使用 this.add 确实会导致 JLabel 加载，但是，内部类仍未加载，我已将其添加到下面的代码中。此外，下面更改的代码不再触发异常；它只加载 JLabel 但不加载内部类。关于如何加载内部类的任何建议？

这是新的 TestApplet.java：

```
import javax.swing.JApplet;
import javax.swing.SwingUtilities;

public class TestApplet extends JApplet {

    public void init(){//Called when this applet is loaded into the browser.
        //Execute a job on the event-dispatching thread; creating this applet's GUI.
        try {
            SwingUtilities.invokeAndWait(new Runnable() {
                public void run() {
                    createGUI();
                }
            });
        } catch (Exception e) {
            System.err.println("createGUI didn't complete successfully");
            System.err.println(e);
            e.printStackTrace();
        }
    }
    private void createGUI(){
        TestPanel myPanel = new TestPanel();
        myPanel.setOpaque(true);
        setContentPane(myPanel);
    }
} 
```

这是新的 TestPanel.java：

```
import java.awt.Canvas;  
import java.awt.Color;
import java.awt.Graphics;

import javax.swing.JLabel;
import javax.swing.JPanel;

public class TestPanel extends JPanel{
    DrawingLines myDrawingLines = new DrawingLines();  

    TestPanel(){
        System.out.println("Running in constructor.  ");
        JLabel myLabel = new JLabel("Hello World");
        this.add(myLabel);
    this.add(myDrawingLines);  
    myDrawingLines.repaint();  
        System.out.println("Still running in constructor.  ");
    }

//inner class to override paint method
class DrawingLines extends Canvas{
   int width, height;

   public void paint( Graphics g ) {
      width = getSize().width;
      height = getSize().height;
      g.setColor( Color.green );
      for ( int i = 0; i < 10; ++i ) {
         g.drawLine( width, height, i * width / 10, 0 );
      }  
      System.out.println("Running in paint method.");  
   }
}//end of inner class   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-12T23:15:39.297

rootpane 为空，因为 Jpanel 尚未添加到任何组件。像这样在面板根窗格中添加东西是..很脏。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-12T23:47:35.220

设置方法为：

```
 private void createGUI(){
        TestPanel myPanel = new TestPanel();
        getContentPane().add(myPanel);
    } 
```

和类 TestPanel 作为

```
public class TestPanel extends JPanel{
    TestPanel(){
        super();
        System.out.println("Running in constructor.  ");
        JLabel myLabel = new JLabel("Hello World");
        add(myLabel);
        System.out.println("Still running in constructor.  ");
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-13T02:02:58.693

让我们从头开始...

```
public class TestPanel extends JPanel{
    TestPanel(){
        System.out.println("Running in constructor.  ");
        JLabel myLabel = new JLabel("Hello World");
        getRootPane().add(myLabel);
        System.out.println("Still running in constructor.  ");
    }
} 
```

使用`getRootPane`向其中添加组件是错误的做法。您永远不需要向根窗格添加任何内容。相反，您应该使用内容窗格，但这不是您想要做的（或应该从这个上下文中做）。

相反，你只是在打电话`add`

```
public class TestPanel extends JPanel{
    TestPanel(){
        System.out.println("Running in constructor.  ");
        JLabel myLabel = new JLabel("Hello World");
        add(myLabel);
        System.out.println("Still running in constructor.  ");
    }
} 
```

这会将标签添加到`TestPane`

让我们看看扩展...

```
public class TestPanel extends JPanel{
    DrawingLines myDrawingLines = new DrawingLines();  

    TestPanel(){
        System.out.println("Running in constructor.  ");
        JLabel myLabel = new JLabel("Hello World");
        this.add(myLabel);
        this.add(myDrawingLines);  
        myDrawingLines.repaint();  
        System.out.println("Still running in constructor.  ");
    }

    //inner class to override paint method
    class DrawingLines extends Canvas{
       int width, height;

       public void paint( Graphics g ) {
          width = getSize().width;
          height = getSize().height;
          g.setColor( Color.green );
          for ( int i = 0; i < 10; ++i ) {
             g.drawLine( width, height, i * width / 10, 0 );
          }  
          System.out.println("Running in paint method.");  
       }
    }//end of inner class   
} 
```

首先，您应该避免混合使用重型和轻型组件（将 a`Canvas`放在a 上`JPanel`），这不值得它带来的挫败感。

无需`repaint`在构造函数中调用。在调用构造函数时，无论如何都无法绘制组件。

相反，只需覆盖面板的`paintComponent`方法

```
protected void paintComponent(Graphics g) {
    super.paintComponent(g);
    int width = getWidth;
    int height = getHeight();
    g.setColor( Color.green );
    for ( int i = 0; i < 10; ++i ) {
     g.drawLine( width, height, i * width / 10, 0 );
    }  
} 
```

我强烈建议你看看

*   [定制绘画](http://docs.oracle.com/javase/tutorial/uiswing/painting/)
*   [2D 图形](http://docs.oracle.com/javase/tutorial/2d/index.html)
*   [在 AWT 和 Swing 中绘画](http://www.oracle.com/technetwork/java/painting-140037.html)