# StackOverflow 问答 13574000-13574999

# java - 在 Java for Android 中解析 JSON 数据

> ID：13574004
> 
> 赞同：2
> 
> 时间：2012-11-26T22:08:39.890
> 
> 标签：java, android, json

我希望有人能帮助我。我正在尝试解析以下 json 文件：

```
{"seminar":[
    {"categoryid": "1","cpe": "13","inventory":["Discussion","Value x","Value y"
    ],"teachers": [
    {
        "titel": "Dipl.-Ing.",
        "company": "XY",
        "name": "Test",
        "id": "3",
    }
    ],

},... 
```

我在解析教师数据时迷失了......

```
...
private static final String TAG_teachers = "teachers";
private static final String TAG_TITLE = "title";

for(int i = 0; i < seminar.length(); i++){
    JSONObject c = seminar.getJSONObject(i);
    ...
    teachers = c.getJSONArray(TAG_DOZENTEN);
    for(int z = 0; z < teachers.length(); z++){                 
    JSONObject d = teachers.getJSONObject(z);
    String title  = d.getString(TAG_TITLE);
    Log.d("JSONParsingActivity", title); 
```

> 我收到错误 System.err(1010): org.json.JSONException: org.json.JSONObject$1 类型的教师的 Value null 无法转换为 JSONArray。

我做错了什么？正如我从 JSON 文档中了解到的那样，教师是 JSON 数组而不是对象。有人可以帮助我吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:14:54.023

教师中有一个额外的（尾随）逗号（在“3”之后）。JSON 中不允许。删除它，看看是否有帮助。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:15:41.330

如果您的 JSON 确实是以下形式：

```
{ ... }, { ... }, { ... }, ... 
```

这是无效的 JSON

根外壳必须是单个对象 (in `{}`) 或数组 (in `[]`)。

如果您的意图是发送一个对象数组，那么只需用方括号将整个东西包裹起来，使其成为一个数组并从中创建一个 JSONArray 对象。

所以应该是这样的

```
[ { ... }, { ... }, { ... }, ... ] 
```

您还需要确保没有多余的逗号、未闭合的括号等。使用[JSONLint](http://jsonlint.com/%20JSONLint)或其他类似的 JSON 格式检查器可以节省一些时间来查找语法问题。

# drupal-7 - 无法呈现提交按钮

> ID：13574005
> 
> 赞同：1
> 
> 时间：2012-11-26T22:08:48.453
> 
> 标签：drupal-7, block, user-profile, panels

我已经使用 template.php 和 user-profile-form.php 自定义了编辑配置文件视图所有显示正确，但提交（和删除）按钮..我正在使用自适应主题，我已经修改如下：

模板.php

```
function adaptivetheme_theme(&$existing, $type, $theme, $path) {

   return array(

    'user_profile_form' => array(
      'template' => 'templates/user-profile-form',
      'render element' => 'form',
    ),
   );
 }

function adaptivetheme_preprocess_user_profile_form(&$vars) {

  $vars['form']['account']['name']['#description'] = t('blabla');

  $vars['form']['submit']['#value'] = t('Save profile');
  $vars['form']['delete']['#value'] = t('Delete account');

  $vars['account'] = drupal_render($vars['form']['account']);
  $vars['theme_select'] = drupal_render($vars['form']['theme_select']);
  $vars['picture'] = drupal_render($vars['form']['picture']);
  $vars['signature_settings'] = drupal_render($vars['form']['signature_settings']);
  $vars['contact'] = drupal_render($vars['form']['contact']);
  $vars['timezone'] = drupal_render($vars['form']['timezone']);
  $vars['submit'] = drupal_render($vars['form']['submit']);
  $vars['delete'] = drupal_render($vars['form']['delete']);

} 
```

然后在 user-profile-form.tpl.php ：

```
<div id="user-profile-form">

<?php echo $account; ?>
<?php echo $timezone; ?>
<?php echo $submit; ?>
<?php echo $delete; ?>

</div> 
```

帐户的编辑表单正确显示。我已尝试成功添加/删除变量（即 $timezone），但缺少提交/删除。我不知道出了什么问题。我尝试更改变量“提交”和“删除”的名称，但仍然没有出现按钮。当然，我每次需要（而不是）时都清除了缓存。我也没有隐藏按钮的 JS。我通过 Panel 中的自定义块呈现此表单：

```
<?
module_load_include('inc', 'user', 'user.pages');
global $user;
print drupal_render(drupal_get_form('user_profile_form', $user));
?> 
```

也许面板有问题？？？

任何想法表示赞赏:)

感谢阅读

二湾

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T22:27:49.400

我忘记了“[动作]”..：

```
 $vars['submit'] = drupal_render($vars['form']['actions']['submit']);
  $vars['cancel'] = drupal_render($vars['form']['actions']['cancel']); 
```

并且“删除”按钮一开始并没有出现，因为它被称为“取消”，并且它的#access 参数被发送到 FALSE。谢谢 DPM ;)

现在，问题是当我触发提交按钮时，表单没有发送，它只是重新加载他的页面。如果我也能解决这个问题，我会更新。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-31T21:31:25.917

页面只是重新加载，因为您忘记呈现隐藏的表单元素。要在模板预处理中这样做，您可以使用类似的东西：

```
 function THEME_preprocess_user_profile_form(&$variables) {

         $hidden = array();

     foreach(element_children($variables['form']) as $key)
         {
        $type = $variables['form'][$key]['#type'];

    if($type == "hidden" || $type == "token"){
        $hidden[] = $variables['form'][$key];
    }       
     }

    $variables['hidden'] = $hidden;

    //Dont forget to report your variables like you already did ...
    } 
```

然后当它完成后，在你的模板文件中渲染 $hidden 变量

```
 <?php print render($hidden);?> 
```

你去吧！

# java - 如何返回多个变量和/或使用私有 int 方法？

> ID：13574010
> 
> 赞同：1
> 
> 时间：2012-11-26T22:09:18.160
> 
> 标签：java, variables, int, private-methods

这是我的代码：

```
import static java.lang.System.*;

public class Triples
{
 private int number;

public Triples()
{
    this(0);
}

public Triples(int num)
{
    number = num;
}

public void setNum(int num)
{
    number = num;
}

private int greatestCommonFactor(int a, int b, int c)
{
    for(int n = 0; n <= number; n++)
    {
    int max = number;
    for(a = 1; a <= max; a++)
    {
        a = n;
        for(b = a +1; b <= max; b++)
        {
            b =n;
            for(c = b + 1; c <= max; c++)
            {
                c = n;
                if(Math.pow(a, 2)+ Math.pow(b, 2)== Math.pow(c, 2))
                {
                    if((a%2==1 && b%2==0)|| (a%2==0 && b%2==1))
                    {
                        if(a%2<=1 && b%2<=1 && c%2<=1)
                        {
                            return 1;
                        }
                    }
                }
            }
        }
    }
    }

    return 1;
}

public String toString()
{
    String output="";
    output = greatestCommonFactor(a, b, c);

    return output+"\n";
}
} 
```

我需要让它打印出变量 a、b 和 c，但我不知道如何让它这样做。我目前收到的错误消息是“a 无法解析为变量 b 无法解析为变量 c 无法解析为变量”

[如果有帮助，这里是相关实验室表的链接： https](https://docs.google.com/open?id=0B_ifaCiEZgtcX08tbW1jNThZZmM) ://docs.google.com/open?id= 0B_ifaCiEZgtcX08tbW1jNThZZmM

**更新** 这是我更新的 toString 方法：

```
public String toString()
{
    int a = 0;
    int b = 0;
    int c = 0;
    String output="";
    output += greatestCommonFactor(a, b , c) + "\n";

    return output;
} 
```

在我编辑时，我最伟大的CommonFactor 方法：

```
private int greatestCommonFactor(int a, int b, int c)
{
    for(int n = 0; n <= number; n++)
    {
    int max = number;
    for(a = 1; a <= max; a++)
    {
        a = n;
        for(b = a +1; b <= max; b++)
        {
            b =n;
            for(c = b + 1; c <= max; c++)
            {
                c = n;
                if(Math.pow(a, 2)+ Math.pow(b, 2)== Math.pow(c, 2))
                {
                    if((a%2==1 && b%2==0)|| (a%2==0 && b%2==1))
                    {
                        if(a%2<=1 && b%2<=1 && c%2<=1)
                        {
                            return greatestCommonFactor(a, b, c);
                        }
                    }
                }
            }
        }
    }
    }

    //return 1;
} 
```

**更新#2**

这是（希望）为 bestCommonFactor 和 toString 方法编写代码的更正确方法：

```
private int greatestCommonFactor(int a, int b, int c)
{
    a = 0;
    b = 0;
    c = 0;
    for(int n = 0; n <= number; n++)
    {
    int max = number;
    for(a = 1; a <= max; a++)
    {
        a = n;
        for(b = a +1; b <= max; b++)
        {
            b =n;
            for(c = b + 1; c <= max; c++)
            {
                c = n;
                if(Math.pow(a, 2)+ Math.pow(b, 2)== Math.pow(c, 2))
                {
                    if((a%2==1 && b%2==0)|| (a%2==0 && b%2==1))
                    {
                        if(a%2<=1 && b%2<=1 && c%2<=1)
                        {
                            return a;
                        }
                    }
                }
            }
        }
    }
    }

    return greatestCommonFactor(a, b, c);
}

public String toString()
{

    String output="";
    output += greatestCommonFactor(a, b , c) + "\n";

    return output;
} 
```

**跑步者类添加**

```
import static java.lang.System.*;

import java.util.Scanner;

public class Lab11j
{
 public static void main(String args[])
 {
       Scanner keyboard = new Scanner(System.in);
        String choice="";
            do{
                out.print("Enter the max number to use : ");
                int big = keyboard.nextInt();

                    //instantiate a TriangleThree object
             Triples trip = new Triples( big);
                //call the toString method to print the triangle
                System.out.println( trip );

                System.out.print("Do you want to enter more data? ");
                choice=keyboard.next();
            }while(choice.equals("Y")||choice.equals("y"));
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:16:05.647

您正在使用变量而不声明和初始化它们：

```
output = greatestCommonFactor(a, b, c); // where are a, b and c decleared in this method? 
```

此外，您的`greatestCommonFactor()`方法接受参数，但除了重新初始化它们之外什么都不做，所以它很可能根本不接受任何参数：

```
private int greatestCommonFactor(int a, int b, int c) {
    for (int n = 0; n <= number; n++) {
        int max = number;
        for (a = 1; a <= max; a++)
        // here you're setting a to 1\. So why pass its value as an argument to the method,
        // since you don't care about the passed in value? 
```

编辑：

而不是拥有

```
private int greatestCommonFactor(int a, int b, int c) { // these are arguments
    a = 0;
    b = 0;
    c = 0;
    ...
} 
```

你应该有

```
private int greatestCommonFactor() {
    int a = 0;
    int b = 0;
    int c = 0; // these are local variables
    ...
} 
```

而不是拥有

```
public String toString() {
    String output="";
    output += greatestCommonFactor(a, b , c) + "\n";
    return output;
} 
```

你应该有

```
// yes, this method name is ugly, but it says what the method does
// I would simply make greatestCommonFactor a public method, and remove this method,
// since it doesn't do anything useful.
public String computeGreatestCommonFactorAndReturnItAsAStringWithANewLine() {
    return greatestCommonFactor() + "\n";
} 
```

# here-api - 诺基亚地图瓷砖 REST API

> ID：13574014
> 
> 赞同：1
> 
> 时间：2012-11-26T22:10:08.943
> 
> 标签：here-api

我有一个诺基亚地图 API 的帐户，但我想知道我应该使用哪个 URL 正确地通过 API 请求磁贴？我正在使用 Leaflet maps API，我的 URL 字符串如下所示：

[http://3.maptile.lbs.ovi.com/maptiler/v2/maptile/newest/normal.day/](http://3.maptile.lbs.ovi.com/maptiler/v2/maptile/newest/normal.day/) {z}/{x}/{y}/256/png8?app_id=XXX&token=XXX

它有效，但我不相信我正确使用了 API - 我只是窃取了 URL 的第一部分 (http://3.maptile.lbs.ovi.com/maptiler/v2/maptile/newest/normal.天）当我在浏览器中查看诺基亚地图时，从开发工具的网络选项卡中查看。

在文档中，它告诉我我可以根据 lat、long 和 zoom 请求，但不能基于 X 和 Y。

有人熟悉诺基亚地图 API 吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T14:45:05.123

关于最初的问题，我猜您已经获得了**Map Image API**的凭据：http : [//developer.here.net/docs/map_image/index.html](http://developer.here.net/docs/map_image/index.html)有一系列可用的交互式示例，解释了如何返回使用纬度和经度的静态地图图像，例如此处：http: [//developer.here.net/apiexplorer/examples/api-for-rest/getting-started/basic-map-wh.html](http://developer.here.net/apiexplorer/examples/api-for-rest/getting-started/basic-map-wh.html)地图图像 API 以 [http://m.nok.it开头](http://m.nok.it)

[使用来自http://here.com](http://here.com)网站的地图图块的 URL不是同一种服务，它不是官方 API（因此没有记录它的原因），并且 URL 可能会更改，恕不另行通知。

**更新**

HERE 现在提供**三个**基于 Web 的 Maps API，并且从去年开始，一个 TMS（*Tile Map Service*）又名**Map Tile API**，我认为你所追求的现在是公开的。

正如*Luciano Issoe*所指出的，**Map Tile API**的**正确 URL**现在已公开记录，请参阅：[https ://developer.here.com/rest-apis/documentation/enterprise-map-tile](https://developer.here.com/rest-apis/documentation/enterprise-map-tile)

 **或者，如果您想使用诺基亚地图数据的交互式地图服务，最好的办法是使用此处描述 的**Maps API for Javascript ：http:** [//developer.here.net/docs/maps_js/index.html](http://developer.here.net/docs/maps_js/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-07T14:57:01.790

现在似乎它是一个记录服务：[https ://developer.here.com/rest-apis/documentation/enterprise-map-tile](https://developer.here.com/rest-apis/documentation/enterprise-map-tile)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-08-13T09:27:08.507

要使用 Map Image API 检索覆盖特定区域的地图，请在地图的右上角和左下角添加两个兴趣点，然后使用 nomrk 使 POI 不可见：

```
http://m.nok.it/?w=512&poi=52.6764,13.7636,52.351,13.0185&nomrk 
```**

# jquery - jQuery if img src equals then apply class name each img

> ID：13574016
> 
> 赞同：3
> 
> 时间：2012-11-26T22:10:11.390
> 
> 标签：jquery

基本上我的 img src 看起来像这样并且有类名 .pic：

```
img/folderA/..
img/folderB/..
img/folderC/..
..
img/folderZ/.. 
```

如果imc src等于/folderA/，我想为每个img示例添加类名，然后添加该img类名'thisisA'等，我尝试了类似的方法，但它不会有任何帮助吗？

```
 $('.pic').each(function(i){
        var imgSrc = this.src;
        if(imgSrc.indexOf('/folderA/')){
            $(this).addClass('thisisA');
        }
            else if(imgSrc.indexOf('/folderB/')){
            $(this).addClass('thisisB');
        }
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:22:45.053

```
$('.pic').each(function(i){
        var imgSrc = this.src;
        if(imgSrc.indexOf('/folderA/') >= 0){
            $(this).addClass('thisisA');
        }
            else if(imgSrc.indexOf('/folderB/') >= 0){
            $(this).addClass('thisisB');
        }
}); 
```

`indexOf`没有匹配项时返回 -1，并且 0 以外的任何值都被`if`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:22:32.097

这个怎么样：

[http://jsfiddle.net/nZCre/1/](http://jsfiddle.net/nZCre/1/)

```
 $('.pic').each(function(i){
        var imgSrc = this.src;
        if(imgSrc.indexOf('/folderA/') > -1){
            $(this).addClass('thisisA');
        }
            else if(imgSrc.indexOf('/folderB/')){
            $(this).addClass('thisisB');
        }
});​ 
```

如果 indexOf 返回 0 那么它将是 false，这可能是正在发生的事情： `if(0){dosomething()}`永远不会`dosomething();`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:24:18.717

该[`indexOf`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/String/indexOf)方法返回字符串中您要查找的位置。这可能会导致一些奇怪的问题。例如：`'hello'.indexOf('h');`将返回 0，因为`h`它位于字符串的第一个位置（索引 0）。

这意味着如果你这样测试：

```
var str = 'hello';
if(str.indexOf('h')) //indexOf returns 0 which is evaluated as false
  alert('hello');
else
  alert('goodbye'); 
```

即使您期待打招呼，您也会收到再见的提醒。

为了帮助解决这个问题，如果在字符串中找不到您要查找的内容，则`indexOf`返回。`-1`所以你需要检查一下。所以你的代码就像：

```
$('.pic').each(function(i){
    var imgSrc = this.src;
    if(imgSrc.indexOf('/folderA/') != -1){
        $(this).addClass('thisisA');
    }
    else if(imgSrc.indexOf('/folderB/') != -1){
        $(this).addClass('thisisB');
    }
}); 
```

# javascript - 骨干网中自定义事件的优势是什么？

> ID：13574020
> 
> 赞同：1
> 
> 时间：2012-11-26T22:10:32.333
> 
> 标签：javascript, backbone.js, backbone-events

我了解自定义事件在 Backbone 中的工作原理以及如何触发它们，但我无法理解何时准确使用它们以及它们的用途是什么，而不是直接调用函数。

例如

```
var MyView = Backbone.View.extend({
    tagName: 'div',
    className: 'myview',

    initialize: function() {
        this.model.on("mycustomevent", this.doSomething, this);
    },

    doSomething: function() { 
         console.log('you triggered a custom event');
    }

}); 
```

如果我没记错的话，doSomething方法可以 `this.model.trigger("mycustomevent")`在其他方法中使用，也可以直接使用`this.doSomething()`

在视图之外，它可以类似地调用

```
var myview = new MyView({model:somemodel});

myview.model.trigger("customevent");

myview.doSomething(); 
```

我感到困惑的是为什么不放弃自定义事件而在需要时直接调用该方法？任何示例使用将不胜感激！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T22:19:58.883

您可能希望在代码 f.ex 的不同位置添加多个处理程序：

```
this.model.on("mycustomevent", this.doSomething, this);

// ... and somewhere else you add an anonymous function
this.model.on("mycustomevent", function() {
    console.log('do something');
}); 
```

然后当您触发事件时，它将执行所有处理程序。您还可以[`off`](http://backbonejs.org/#Events-off)用于取消绑定/管理单个或多个处理程序。

如果您询问事件模式的一般解释（也称为[*观察者模式*](https://en.wikipedia.org/wiki/Observer_pattern)、*发布/订阅*等），您可能应该寻找更深入的文章或书籍。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:08:00.113

使用骨干网，完美的例子是改变模型的属性。使用一个函数，你将不得不做这样的事情......

```
$( '#someUI' ).click( function {
   // update the model property
   myModel.someProperty = 'somethingDifferent';
   // update any ui that depends on this properties value
   $( '#uiThatDisplaysModelData' ).find( 'someSelector' ).html( 'somethingDifferent' );
   // save the model change to the server
   $.ajax( {
      url: 'somesaveurl',
      data: { someProperty: 'somethingDifferent' }
      success: callback
   } );
} ); 
```

然后针对每个属性更改在整个代码中重复这些步骤。

通过骨干网和一些设置，可以通过以下方式完成相同的事情：

```
myModel.set( 'property', 'somethingDifferent' ); 
```

这是因为我们已将处理程序附加到此模型的`change`和`change:property`事件。这些是由主干为模型自动创建的自定义事件。因此，每当您的代码的任何部分操作模型时，DOM 更新和保存都可以自动完成。我们还可以将输入验证或我们想要的任何内容绑定到这些自定义事件。

它基本上只是将观察者模式应用于您的应用程序，其中事件属于可观察的对象，处理程序属于其观察者。

[http://en.wikipedia.org/wiki/Observer_pattern](http://en.wikipedia.org/wiki/Observer_pattern)

# ruby - 从 NAnt 调用 rakefile

> ID：13574021
> 
> 赞同：2
> 
> 时间：2012-11-26T22:10:38.340
> 
> 标签：ruby, rake, nant

我正在处理一个相对较大的项目，到目前为止，构建已经在 NAnt 构建脚本中完成。最近一小部分开发是用 ruby​​ 完成的，并且是使用 rake 文件构建的。我想创建一个调用 rakefile 的 NAnt 目标。NAnt 构建中的当前设置：（请注意，rakefile 与 NAnt 脚本位于不同的目录中）

```
<property overwrite="false" name="project.rootdirectory" value="${project::get-base-directory()}" />
<property overwrite="false" name="rake.exe" value="rake.bat" />

<target name="callrake">
    <exec program="${rake.exe}" verbose="true">
        <arg value="build:foo" />
        <arg line="-f ${project.rootdirectory}/../pathtorakefile" />
    </exec>
</target> 
```

我运行时收到的错误`nant callrake`是：

```
[exec] ruby.exe: No such file or directory -- c:/pathtoNAntscript/rake (LoadError)
c:/pathtoNAntscript/NAntscript.build 
External Program Failed: rake.bat (return code was 1) 
```

安装了 Ruby 和 rake，并且 Ruby bin 在路径变量中。不知道为什么 NAnt 似乎不能调用 rake。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T19:41:40.300

这个问题通过调用 cmd.exe 并将 rake 命令作为文本传递给它来解决：

```
<exec program="cmd.exe" verbose="true">
    <arg line="/c ${rake.exe} build:foo" />
    <arg line="-f ${project.rootdirectory}/../pathtorakefile/Rakefile.rb" />
</exec> 
```

# jquery - 如何使用jquery仅对奇数行进行排序（并在相应的奇数行之后保留偶数行）？

> ID：13574029
> 
> 赞同：1
> 
> 时间：2012-11-26T22:10:59.643
> 
> 标签：jquery, tablesorter

我有带有基本信息的奇数行和带有一些内容的偶数行的表格：

```
Title  Category  AnotherColumn

Title1 Category1 AnotherColumn1
Content1
Title2 Category2 AnotherColumn2
Content2
Title3 Category3 AnotherColumn3
Content3
Title4 Category4 AnotherColumn4
Content4 
```

使用 javascript 显示/隐藏内容行，但现在我添加了使用 jQuery 的排序（使用来自[http://tablesorter.com/docs/](http://tablesorter.com/docs/)的教程）：

桌子：

```
<table id="myTable" class="tablesorter">
 <thead>
  <th>Title</th>
  <th> Category</th>
  <th>AnotherColumn</th>
 </thead>
 <tbody>
 {foreach over data, filling table}
  <tr class="odd">
   <td onclick="showContent($id)">$titles</td>
   <td>$categories</td> 
   <td>$anothercolumns</td>
  </tr>
  <tr id="$id" class="even" style="display: none;">
   <td colspan="3">$contents</td>
  </tr>
</tbody> 
```

js：

```
$(document).ready(function()
{
    $("#myTable").tablesorter();
); 
```

但是结果是所有行都被排序了，所以当我显示内容时，比如说 Title2，它看起来像这样：

```
Title1 Category1 AnotherColumn1
Title2 Category2 AnotherColumn2
Title3 Category3 AnotherColumn3
Title4 Category4 AnotherColumn4
Content2 
```

有没有办法解决这个问题？或者您有其他想法如何插入这样的内容？
感谢帮助。

# c++ - 使用 cuda 创建共现矩阵

> ID：13574030
> 
> 赞同：4
> 
> 时间：2012-11-26T22:11:14.407
> 
> 标签：c++, image, image-processing, cuda, gpu

```
//This is my kernel function

__global__ void createSCM(Pixel*pixelMat, //image
                          int imgRows, //image dimensions
                          int imgCols,
                          int*matrizSCM, //Coocurrence matrix
                          int numNiveles, //coocurrence matrix levels = 256
                          int delta_R, //value = {-1,0 or 1}
                          int delta_C) //value = {-1,0 or 1}
{
    int i = blockIdx.y*blockDim.y+threadIdx.y;
    int j = blockIdx.x*blockDim.x+threadIdx.x;

    int cols = numNiveles;

    int posx,posy;

    if ( (j + delta_C) < imgCols && (i + delta_R) < imgRows && 
       ((j + delta_C) >= 0) && ((i + delta_R) >= 0) )
    {
       posx = pixelMat[i*imgCols+j].channel_0;
       posy = pixelMat[(i + delta_R)*imgCols+(j + delta_C)].channel_0;

       matrizSCM[posx*cols+posy]++;
       matrizSCM[posy*cols+posx]++;
    }

}

struct Pixel {

    int channel_0;
}; 
```

我在共现矩阵中有计数错误，因为

`pixelMat[i*imgCols+j]`和`pixelMat[(i + delta_R)*imgCols+(j + delta_C)]`

正在使用同一个线程访问不同的位置。

这是我的内核调用

```
int Grid_Dim_x=imagenTest.rows, Grid_Dim_y=imagenTest.cols;
int Block_Dim_x=1, Block_Dim_y=1;   

dim3 Grid(Grid_Dim_x, Grid_Dim_y);  
dim3 Block(Block_Dim_x,Block_Dim_x);

createSCM<<<Grid,Block>>>(...) 
```

每个块上只有一个线程，每个块代表一个像素

这个问题有很好的解决方案吗？

谢谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T09:16:45.890

从不可变输入的不同存储单元中读取不会产生您必须处理的并行风险。问题在于`matrizSCM`同一内存单元可以同时被多个线程递增。

An`atomicAdd(addr,1)`是一个快速修复 --- 它应该使算法正确，但它可能相当慢。使它正确应该是第一步；然后您可以查看直方图计算和并行缩减算法网络上的可用示例，并检查它是否可以应用于您的问题。

最后，正如罗伯特在评论中指出的那样，在一个块中只启动一个线程是非常低效的。您需要 32 的倍数来利用硬件 SIMD 单元，通常需要大约 256 个线程来隐藏各种内存延迟。

此外，如果您的图像很大并且您仍然需要数千个 256 线程块，您可以考虑启动更少的块（大约 60-120），但让每个块按顺序处理多个像素。如果你这样做，你也许可以`matrixSCM`在共享内存中放置一个副本。这将为每个块制作一个单独的副本`matrixSCM`，从而减少块之间的原子冲突。显然，在内核结束时，您的块仍需要将部分结果“提交”到全局结果中，但这将是单步操作。

# ios - 发布后 IAP 失败，但在开发阶段没有

> ID：13574037
> 
> 赞同：2
> 
> 时间：2012-11-26T22:11:46.593
> 
> 标签：ios, in-app-purchase

这是我的应用程序的历史。在 v1.0 中，我没有 IAP。

在 v2.0 中，我有 IAP 代码，它在我开发时工作。当 v2.0 发布时，我检查并运行了一个非测试设备（我的 itunesconnect 用户名下的 iPhone，但没有安装配置文件，因此我将其视为非相关设备）并收到错误消息，这当然是我自己设置的。该错误是针对应用程序无法连接到 Apple 或找不到应用程序的 IAP 的情况。单击购买 IAP 后，该错误立即出现。这是预期的，因为没有可用的产品 ID。它根本不需要等待支付队列。

然后我检查了itunesconnect，发现IAP可能没有链接到应用程序，所以我更新到v2.1并在itunesconnect中将IAP添加到我的应用程序中（没有真正的代码更改，至少没有更改与IAP相关的代码），并且IAP有效在我测试 iPad 的开发阶段终于可以了。现在v2.1出来了，但是我还是和v2.0一样的问题，那就是IAP遇到错误，很可能没有找到IAP产品ID。在我打字的时候，v2.1已经发布了2个小时，我仍然有快速错误——很可能是产品ID问题。

[编辑] 顺便说一句，v2.0 和 v2.1 之间存在故障。当我注意到 IAP 没有链接到我的应用程序时，我做的太快了以至于我记不清了。基本上 IAP 挂在那里，我可以修改或提交它。在与 Apple 交谈后，我被告知我需要拒绝我的 v2.1 二进制文件并与 IAP 一起重新提交 v2.1。我不知道这是否相关，但无论如何我可以在开发阶段用我的沙盒测试 iPad 购买 IAP。[编辑]

任何想法？谢谢。

顺便说一句，该应用程序默认设置为英文，但具有中文/西班牙文本地化。

[编辑] 还有一件事，不知道是否相关。所有 v1.0、v2.0 和 v2.1 版本都部署到 iOS 6 或更高版本。当我开发 v2.1 时，我试图回到 iOS 5（通过采用如此不推荐使用的方法或常量）。我的应用程序可以在 iOS 5 上运行，但 IAP 无法在 iOS 5 上运行。由于 IAP 不起作用，我没有必要与 iOS 5 兼容，因此我删除了所有不推荐使用的方法和常量并返回到原始 v2 .0 版本并使用链接的 IAP 重新提交成为 v2.1。对于那些关心的人，这是我的应用程序。欢迎您尝试。长按第一页会让您进入选项页面，您可以在其中尝试购买 IAP --- 不用担心，应该有一个确认对话框，您可以在其中取消，即使我的 IAP 有效。 [https://itunes.apple.com/us/app/icalc24!/id566916783?mt=8](https://itunes.apple.com/us/app/icalc24!/id566916783?mt=8) [编辑]

另一个编辑：哦，是的，它现在可以工作了。我不知道以下哪一步使它起作用：1，我删除我的应用程序并再次重新启动我的 iPhone（再次，是的）并重新下载 2，现在是 v2.1 获得批准后的 4 小时。

# eclipse-rap - 使用 Tabris 和 RAP 打开文件

> ID：13574041
> 
> 赞同：0
> 
> 时间：2012-11-26T22:12:07.273
> 
> 标签：eclipse-rap

评估 eclipsesource 开发的 Tabris，我可以创建一个简单的应用程序，从后端浏览一些文件结构。现在我想知道如何打开/显示文件的内容。在服务器端，我为下载创建了一个服务处理程序。但是打开一个包含带有该服务 URL 的浏览器小部件的 shell 只会显示一个空白页面。如果我使用“http://www.google.de”作为 URL，那么浏览器会显示该站点。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:12:22.620

服务处理程序是否呈现 html？您可以从新的浏览器选项卡中打开网址并显示您的内容吗？

用浏览器小部件浏览文件对我来说感觉很奇怪。为什么不使用 JFace TreeViewer 来显示文件结构？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-11T08:53:12.210

在 2012 年 12 月即将发布的版本（版本 0.9.0）中，将实施 AppLauncher aka OpenWith。这将改进使用适当的应用程序显示文件内容 - 因此您不必注意在浏览器小部件中显示所有内容。

见：[https ://github.com/eclipsesource/tabris/issues/89](https://github.com/eclipsesource/tabris/issues/89)

# python - Django 表单如何清理文本输入以防止 SQL 注入、XSS 等？

> ID：13574043
> 
> 赞同：12
> 
> 时间：2012-11-26T22:12:25.693
> 
> 标签：python, django, xss, sql-injection

在处理原始文本的 Django 表单代码中，我没有看到任何表单输入清理。Django 如何确保在进入数据库时​​对用户输入进行清理？它这样做是为了防止 SQL 注入等吗？

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2012-11-26T22:15:58.537

用户输入由数据库驱动程序自动清理。

仅当您尝试组合包含 SQL 命令和您尝试包含的数据的单个字符串时，才需要显式用户输入清理；正确使用 Python DBAPI 将命令和数据完全分离，作为程序员，只要正确使用该功能，您就不必担心 SQL 注入。Django 默认使用该功能，因此您不必担心它。

编辑：XSS 是一个单独的问题；请参阅@renab 的评论以及[https://docs.djangoproject.com/en/dev/topics/security/#cross-site-scripting-xss-protection](https://docs.djangoproject.com/en/dev/topics/security/#cross-site-scripting-xss-protection)

# microsoft-ui-automation - IUIAutomation::RemoveAllEventHandlers 挂起

> ID：13574052
> 
> 赞同：8
> 
> 时间：2012-11-26T22:12:52.843
> 
> 标签：microsoft-ui-automation

我正在用 C++ 开发一个应用程序，它使用 UIAutomation 来接收与用户交互相关的重要事件的通知。我通过调用 AddAutomationEventHandler 尝试了一个事件处理程序来侦听窗口打开的事件，但是我在退出之前停止通知和清理时遇到了问题。如果用户已启动某些应用程序，例如 Firefox，则对 RemoveAutomationEventHandler 的调用会挂起。（在这种情况下，调用 RemoveAllEventHandlers 也会挂起。）请注意，所有添加或删除事件处理程序的调用都是在同一个非 UI 线程的上下文中完成的。

注意：我在 Windows 7 和 Windows 8 上看到了这种行为。

关于为什么会发生这种情况或如何解决它的任何想法？是什么让结构改变事件与所有其他事件不同？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-08-06T19:41:34.503

窗口打开/关闭事件通过内核 WinEvent 处理程序实现；结构更改事件涉及客户端应用程序。您的非 ui 线程是否泵送消息？UI 自动化需要泵送消息以使跨进程通信正常工作。

# c# - “枚举”类中不允许使用代码优先枚举？（英法 5）

> ID：13574053
> 
> 赞同：4
> 
> 时间：2012-11-26T22:12:54.497
> 
> 标签：c#, asp.net, .net, entity-framework, ef-code-first

我正在尝试做一些非常简单的事情。我想`Enum`在我的 Code First 解决方案中使用 as 列类型。我正在使用实体框架 5.0 稳定版。

考虑我`Enum`的包装类和模型：

```
public class Enums
{
    public enum UserType
    {
        Bronze = 0,
        Silver = 1,
        Gold = 2,
        Admin = 4
    }
}

public class User
{
    public int UserId { get; set; }
    public string UserName { get; set; }
    public Enums.UserType UserType { get; set; }
} 
```

如果我生成数据库，`UserType`则不会生成列。当我像这样删除`class`我周围的“包装器”时`Enum`：

```
public enum UserType
{
    Bronze = 0,
    Silver = 1,
    Gold = 2,
    Admin = 4
}
public class User
{
    public int UserId { get; set; }
    public string UserName { get; set; }
    public UserType UserType { get; set; }
} 
```

它**确实**生成了！我的第一个设置是一种不常见的或“请不要”的方法吗？

我想听听一些标准化或最佳实践的建议和/或解释为什么我的第一个设置不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:21:38.240

我以前从未见过有人使用包装类`Enum`。当然，也有可能是我不够周到。:) 我见过`enum`在一个命名空间内包含大量定义的包罗万象的文件，但从来没有一个包装类。我没有看到包装类添加任何东西。

正如@Pawel 所说，EF 不支持嵌套类型。这是有道理的：如果您要实例化内部类型而不是外部类型，那么外部类型的意义何在？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:19:04.567

EF 不支持嵌套类型（无论是枚举、复杂类型还是实体）。

# javascript - 如何获得在 facebook 墙上发布帖子的 publish_stream 权限？

> ID：13574058
> 
> 赞同：-1
> 
> 时间：2012-11-26T22:13:10.393
> 
> 标签：javascript, facebook, post

这是我的连接：

```
window.fbAsyncInit = function () {
    FB.init({
        appId: "348044465251207",
        status: true,
        cookie: true,
        xfbml: true,
        oauth: true
    });
    FB.Event.subscribe('auth.login', function (response) {
    var credentials = { uid: response.authResponse.userID, accessToken: response.authResponse.accessToken };
        SubmitLogin(credentials);
    }, { perms: 'read_stream,publish_stream,offline_access' });

    FB.getLoginStatus(function (response) {
        if (response.status === 'connected') {
            FB.api('/me', function (response) {
                //console.log('Good to see you, ' + response.name + '.');

                mail = response.email;
                currentName = response.name;
                gender = response.gender;
                place = response.location;

                $.ajax({
                    url: "/Login/DetailsToDataBase",
                    type: "POST",
                    data: { gender: gender, mail: mail, place: place },

                    success: function (data) {
                        generalScore = data;
                        div_element = document.getElementById("userScore");
                        div_element.innerHTML = "Your score is: " + generalScore;
                    }

                });

            });
        } //end if
        else if (response.status === 'not_authorized') { alert("user is not authorised"); }
        else { alert("user is not conntected to facebook"); }

    }, { scope: 'read_stream,publish_stream,offline_access' });

    function SubmitLogin(credentials) {
        $.ajax({
            url: "/Login/FacebookLogin",
            type: "POST",
            data: credentials,
            error: function () {
                alert("error logging in to your facebook account.");
            },
            success: function () {
              //  alert("success log in facebook");
                //     window.location.reload();
            }
        });
    }

};

(function (d) {
    var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
    if (d.getElementById(id)) {
        return;
    }
    js = d.createElement('script');
    js.id = id;
    js.async = true;
    js.src = "//connect.facebook.net/en_US/all.js";
    ref.parentNode.insertBefore(js, ref);
} (document)); 
```

这是在用户 facebook 墙上发布的功能：

```
var params = {};
params['method'] = 'stream.publish';
params['message'] = currentName +' earn '+ score+ '$ in battelship!';
params['name'] = 'BattelShip';
params['description'] = 'let\'s see if you sucsses to break my highlight';
params['link'] = 'https://apps.facebook.com/348044465251207/?fb_source=search&ref=ts&fref=ts';
params['picture'] = 'http://www.israup.net/images/98d0808995e356818a0c016bc1a2a7cc.png';
params['caption'] = 'Try it by Yourself!';

FB.api('/me/feed', 'post', params, function(response) {
  if (!response || response.error) {
    console.log('Error occured');
  } else {
    console.log('Published to stream - you might want to delete it now!');
  } 
```

});

它只在我的墙上发布（因为我是应用程序的管理员），但对于其他用户它说：“用户尚未授权应用程序执行此操作”

请帮帮我！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:33:25.497

我认为您需要再次查看[登录](https://developers.facebook.com/docs/concepts/login/)文档，您在登录流程“perms”的一部分中使用了一个参数，该参数在一年前已被弃用以支持“范围”-

检查 SDK 附带的示例并阅读登录文档，尽管如果您修复了该错误，代码可能会正常工作，但我会警惕 API 中的其他内容发生了哪些变化，因为您正在使用的示例是编写的- 您可以通过使用该访问令牌调用 /me/permissions 来检查授予您正在使用的访问令牌的权限

# c# - WPF 列表框选择

> ID：13574065
> 
> 赞同：0
> 
> 时间：2012-11-26T22:14:09.240
> 
> 标签：c#, wpf, listbox

我在`ListBox`. 假设我有`ListBox`10 个项目，我使用`Shift`按钮选择前 5 个项目。该`SelectionChanged`事件由 5 个项目触发。之后，我想从这 5 个项目中选择 3 个项目，再次`Shift`按下按钮，但`SelectionChanged`不会触发事件。当我选择之前选择的 5 个项目中的 3 个时，我如何对第二个项目做出反应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:08:53.863

你能也显示xaml代码吗？我想看看你的绑定是什么样子的

在命令绑定中，您使用了具有相对源绑定的绑定...

考虑在绑定中进行这些更改

1) 使用列表框作为祖先类型

2) 绑定时使用 Path=DataContext.SelectionChangedCommand 否则它将列表框作为数据上下文。

```
<catel:EventToCommand Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBox}}}" DisableAssociatedObjectOnCannotExecute="False" PassEventArgsToCommand="True" /> 
```

这是 ListBoxItem 模板的 XAML 外观示例

```
<Grid>
<StackPanel Orientation="Horizontal">
    <Label Width="180">Field1</Label>
    <ListBox Height="200" 
            IsSynchronizedWithCurrentItem="True" 
            ItemsSource="{Binding List1, Mode=OneWay}" 
            Name="listBox1" 
            SelectionMode="Single" 
            Width="300">
        <ListBox.ItemTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal" Width="290">
                    <TextBlock Width="90" Text="{Binding}"></TextBlock>
                        <ComboBox Width="180" ItemsSource="{Binding DataContext.List2, RelativeSource={RelativeSource AncestorType={x:Type ItemsControl}}}" DisplayMemberPath="Field1">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="SelectionChanged">
                                        <catel:EventToCommand Command="{Binding Path=DataContext.SelectionChangedCommand, RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type ListBox}}}" DisableAssociatedObjectOnCannotExecute="False" PassEventArgsToCommand="True" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </ComboBox>
                    </StackPanel>
            </DataTemplate>
        </ListBox.ItemTemplate>
    </ListBox>
</StackPanel> 
```

# android - 我可以在不使用完整模拟器的情况下模拟 GCM / APNS 客户端设备吗？

> ID：13574069
> 
> 赞同：0
> 
> 时间：2012-11-26T22:14:24.350
> 
> 标签：android, client, apple-push-notifications, simulate

我有一个应用程序需要每天将通知推送到数千台设备上几次。我希望能够对我的服务器代码运行测试，而无需实际向我的用户发送任何内容。

是否有任何语言的库可以让我在不使用完整设备模拟器的情况下作为客户端连接到 APNS 或 GCM？我只想看到网络流量从服务器到达，我不需要大规模测试应用程序本身。

- 编辑 -

我的目标之一是能够测试发送到具有不同配置的设备，而无需让实际用户满足该需求。例如，我想以编程方式在每个时区中创建和注册 X 设备，然后能够在测试场景中向这些临时设备发送通知。由于我没有很多时区的用户，因此与真实设备绑定（或必须启动重型模拟器）进行测试是一个障碍。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:22:26.147

对于 GCM，消息中的“dry_run”字段（请参阅[此页面](http://developer.android.com/guide/google/gcm/gcm.html)）是否适合您的目的？它允许您将消息从客户端发送到 GCM 服务器，而无需发送到实际的电话/设备。

# sql - 有没有更好的方法从表中获取最后一级的组？

> ID：13574070
> 
> 赞同：1
> 
> 时间：2012-11-26T22:14:25.270
> 
> 标签：sql, sql-server-2012

我有一个 Group 表，在该表中，有一个 ParentId 列表示 Group 表中的组父级。目的是从这些组中构建一个动态菜单。我知道我可以循环并抓住最后一个孩子并构造一个结果集，但我很好奇是否有更多的 SQL-y 方式来实现这一点。

该表具有 int、int 和 varchar 的 Id、ParentId 和 Title 字段。

基本上，可以通过这种方式构建层次结构（人是基本组）：

```
People -> Male   -> Boy
                 -> Man
       -> Female 
```

我想抓住每个分支的最后一个孩子。所以，在这种情况下，{男孩，男人，女性}。

正如我所提到的，*获取*这些信息不是问题。我只是在寻找一种更好的方法来获得它，而不必编写一堆联合和循环，我基本上可以在其中更改基本组并动态地向外遍历整个层次结构。我不是真正的 Db 人，所以我不知道是否有一种巧妙的方法可以做到这一点。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:20:56.000

要获取多个层次结构之一的叶级别，您可以使用[递归公用表表达式](http://msdn.microsoft.com/en-us/library/ms186243%28v=SQL.105%29.aspx)(CTE) 来枚举层次结构，然后检查哪些成员不是另一个组的父级以过滤到叶：

```
Declare @RootID int = 1

;with cte as (
  select 
    Id,
    ParentId,
    Title
  From
    Groups
  Where
    Id = @RootID
  Union All
  Select
    g.Id, 
    g.ParentId,
    g.Title
  From
    cte c
      Inner Join
    Groups g
      On c.Id = g.ParentID
)
Select
  *
From
  cte g
Where
  Not Exists (
    Select
      'x'
    From
      Groups g2
    Where
      g2.ParentID = g.Id
  ); 
```

您也可以使用左连接而不是不存在来执行此操作

[http://sqlfiddle.com/#!6/8f1aa/9](http://sqlfiddle.com/#!6/8f1aa/9)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:41:20.033

由于您使用的是 SQL Server 2012，因此您可以利用[`hierarchyid`](http://msdn.microsoft.com/en-us/library/bb677290.aspx); 下面是一个遵循 Laurence 模式的示例：

```
CREATE TABLE Groups
    (
      Id INT NOT NULL
             PRIMARY KEY
    , Title VARCHAR(20)
    , HID HIERARCHYID
    )

INSERT  INTO Groups
VALUES  ( 1, 'People', '/' ),
        ( 2, 'Male', '/1/' ),
        ( 3, 'Female', '/2/' ),
        ( 4, 'Boy', '/1/1/' ),
        ( 5, 'Man', '/1/2/' );

SELECT  Id
      , Title
FROM    Groups
WHERE   HID NOT IN ( SELECT HID.GetAncestor(1)
                     FROM   Groups
                     WHERE  HID.GetAncestor(1) IS NOT NULL ) 
```

[http://sqlfiddle.com/#!6/00330/1/0](http://sqlfiddle.com/#!6/00330/1/0)

结果：

```
ID  TITLE
3   Female
4   Boy
5   Man 
```

# ios - 将 UITableView 的高度调整为仅适合总内容大小所需的高度

> ID：13574071
> 
> 赞同：16
> 
> 时间：2012-11-26T22:14:46.570
> 
> 标签：ios, objective-c, uitableview, ios5, ios6

所以我有一个非常基本的问题。我`UITableView`在 a中有这个`view`，我想让这个表的高度尽可能高，以显示表中的所有行。因此，我不想滚动，我只想显示所有行。（行的数量和 是动态的`height`）。

```
-(CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    CGSize cellSize = [[[_stepsArray objectAtIndex:indexPath.row]content] sizeWithFont:[UIFont boldSystemFontOfSize:18.0f] constrainedToSize:CGSizeMake(528.0f, CGFLOAT_MAX)lineBreakMode:NSLineBreakByWordWrapping];
    return cellSize.height;
} 
```

如果有 20 行，表格会很高，但如果只有 1 行，就会很小，其他内容不会出现在 19 行下面。

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-26T22:24:11.247

如果我理解正确，您应该能够将每行的高度相加并基于此调整 tableview 高度：

```
CGFloat tableHeight = 0.0f;
for (int i = 0; i < [_stepsArray count]; i ++) {
    tableHeight += [self tableView:self.tableView heightForRowAtIndexPath:[NSIndexPath indexPathForRow:i inSection:0]];
}
self.tableView.frame = CGRectMake(self.tableView.frame.origin.x, self.tableView.frame.origin.y, self.tableView.frame.size.width, tableHeight); 
```

您可以在 [tableView reloadData] 之后立即执行此操作

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2014-06-13T10:01:52.790

这是更简单的解决方案：您只需`sizeToFit`在`UITableView`, 填充单元格后设置它。如果您设置`delegate`并`dataSource`通过`xib`，您可以在您的`viewDidLoad`方法中执行此操作，或者`viewDidAppear`，像这样：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    [yourTableView sizeToFit];
} 
```

但是，如果您在代码中的某处添加`delegate`和，则必须在此之后添加：`dataSource``sizeToFit`

```
- (void)someMethod
{
    [yourTableView setDelegate:self];
    [yourTableView setDataSource:self];

    [yourTableView sizeToFit];
} 
```

此外，如果您在某处这样做，则必须在 reloadTable 之后执行此操作。

这会将您的表格精确调整为高度，这是其单元格高度的总和！

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-09-21T12:49:47.903

你可以这样试试

```
-(void) tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath {
    if([indexPath row] == ((NSIndexPath*)[[tableView indexPathsForVisibleRows] lastObject]).row){
        NSLog(@"%f",your_tableView.contentSize.height);
    }
} 
```

在**Swift 3.0中**

```
func tableView(_ tableView: UITableView, willDisplayCell cell: UITableViewCell, forRowAt indexPath: IndexPath) {
    if indexPath.row == tableView.indexPathsForVisibleRows?.last?.row {
        print("\(tableView.contentSize.height)")
    }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-08-21T05:16:11.317

在 table view 上为 contentSize 属性添加一个观察者，并相应地调整框架大小

在 viewDidLoad 添加以下代码行

```
[your_tableview addObserver:self forKeyPath:@"contentSize" options:0 context:NULL]; 
```

然后在回调中：

```
- (void)observeValueForKeyPath:(NSString *)keyPath ofObject:(id)object change:(NSDictionary *)change context:(void *)context
    {
         CGRect frame = your_tableview.frame;
         frame.size = your_tableview.contentSize;
         your_tableview.frame = frame;
    } 
```

希望这会帮助你。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2017-04-06T19:42:23.807

在桌子上设置高度约束，连接到插座，并将以下内容添加到您的视图控制器：

```
override func viewWillLayoutSubviews() {
    super.viewWillLayoutSubviews()
    tableViewHeightContraint.constant = tableView.contentSize.height
} 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-03-07T06:14:01.007

只需使用`tableView.tableFooterView = [[UIView alloc] initWithFrame:CGRectZero];` 这将解决您的问题。

# java - 在 Android 上限制 sqlite 数据库大小

> ID：13574085
> 
> 赞同：3
> 
> 时间：2012-11-26T22:15:39.813
> 
> 标签：java, android, database, sqlite

我正在尝试限制 Android 上的 sqlite 数据库大小。这就是我试图实现它的方式，

*   在 sqlite db 对象上调用 setMaximumSize()
*   将 mDb.replaceOrThrow() 放在 try-catch 块中，以便在大小已满时抛出 SQLiteFullException。
*   捕获 SQLiteFullException 并删除数据库中的所有记录。（因为我使用数据库进行缓存）

这是我观察到的，

*   在几次成功插入后，我收到 SQLiteException，并显示错误消息“无法提交。没有事务处于活动状态”。db 的集合大小越高，失败前成功事务的数量就越多。
*   当我将数据库的最大大小设置得太小而无法创建表时，我确实得到了 SQLiteFullException，因此当我使用创建表查询调用 execSQL() 时，它会抛出 SQLiteFullException。

我的问题是为什么我在插入/替换期间没有收到 SQLiteFullException ？什么是实现我正在尝试的正确方法？

# gcc - GCC 4.8 上的 AddressSanitizer 崩溃

> ID：13574091
> 
> 赞同：2
> 
> 时间：2012-11-26T22:16:00.667
> 
> 标签：gcc, segmentation-fault, instrumentation, memory-corruption

我刚刚试用了 GCC 4.8 令人兴奋的新功能 AddressSanitizer。

该程序

```
#include <iostream>
int main(int argc, const char * argv[], const char * envp[]) {
    int *x = nullptr;
    int y = *x;
    std::cout << y << std::endl;
    return 0;
} 
```

编译 find 使用

```
g++-4.8 -std=gnu++0x -g -fsanitize=address -fno-omit-frame-pointer -Wall ~/h.cpp -o h 
```

但是当我运行程序时，我得到

```
ASAN:SIGSEGV
=================================================================
==7531== ERROR: AddressSanitizer crashed on unknown address 0x000000000000 (pc 0x000000400aac sp 0x7fff11ce0fd0 bp 0x7fff11ce1000 T0)
AddressSanitizer can not provide additional info.
    #0 0x400aab (/home/per/h+0x400aab)
    #1 0x7fc432e1b76c (/lib/x86_64-linux-gnu/libc-2.15.so+0x2176c)
Stats: 0M malloced (0M for red zones) by 0 calls
Stats: 0M realloced by 0 calls
Stats: 0M freed by 0 calls
Stats: 0M really freed by 0 calls
Stats: 0M (0 full pages) mmaped in 0 calls
  mmaps   by size class: 
  mallocs by size class: 
  frees   by size class: 
  rfrees  by size class: 
Stats: malloc large: 0 small slow: 0 
```

这似乎是报告内存错误的不正确方法。我错过了一些编译或链接标志吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-11T16:02:45.077

这是报告 NULL 取消引用的预期方式。您可以通过 asan_symbolize.py（应该存在于您的 GCC 树中）运行程序输出，以获取源文件中的符号名称和行号。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-31T16:02:08.183

我在 gcc 4.8 或 4.9 上找不到任何 asan_symbolize.py。我在[https://code.google.com/p/address-sanitizer/issues/detail?id=223添加了一个解决方法](https://code.google.com/p/address-sanitizer/issues/detail?id=223)

# linux - 使用 zip 命令重命名目标文件

> ID：13574094
> 
> 赞同：6
> 
> 时间：2012-11-26T22:16:39.577
> 
> 标签：linux, unix, zip

我正在使用`zip`命令来压缩文件，例如`zip -r - file1 file2 file3`

但是，我们希望在压缩这些文件之前重命名这些文件。

有谁知道是否有办法通过管道传输或以某种方式重命名正在添加到 zip 的文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-06-04T16:35:03.117

命令`zipnote`：

```
echo -e "@ myOldFileName.txt\n@=myNewFileName.txt" | zipnote -w myzip.zip 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T03:09:53.710

Providing customized name to the outcoming xyz.zip folder is possible. but renaming the input file should be done before it takes input for processing ZIP action.

Following are the possible ways that will create archivefile1.zip file

```
zip -r archivefile1 .
zip -r archivefile1 .* *
zip -r archivefile1 .* 
```

# php - 由 mySQL 查询创建的 JSON 返回未定义但数组相同

> ID：13574097
> 
> 赞同：0
> 
> 时间：2012-11-26T22:16:45.930
> 
> 标签：php, mysql, json

使用 mySql、PHP、jquery Web 应用程序。

我现在的 jQuery 脚本可以很好地处理从 .php 脚本中检索到的数据，但是当我从 mySQL 数据库中获取 .php 脚本中的数据时，我的页面上的值在出现的数据上未定义从分贝。

这里是php。

```
 $get_par ="SELECT  hole, par FROM course_card cc
 LEFT JOIN tour_event_rounds ter ON ter.course_id = cc.course_id
 WHERE tour_id='$tid' AND rnd='$rnd' limit 9";
 $gp_res = mysql_query($get_par) or die(mysql_error());
 $golfer_id=25;
 $score_arr[$golfer_id]["name"]="Bob Golfer";
  while ($array = mysql_fetch_array($gp_res)) {
    $hole = $array['hole']+0;
    $score_arr[$golfer_id]["$hole"] = $array['par']+0;
  }

$golfer_id=45;
$score_arr[$golfer_id]["name"]="Joe Golfer";
$score_arr[$golfer_id][1]=4;
$score_arr[$golfer_id][2]=3;
$score_arr[$golfer_id][3]=5;
$score_arr[$golfer_id][4]=5;
$score_arr[$golfer_id][5]=5;
$score_arr[$golfer_id][6]=5;
$score_arr[$golfer_id][7]=5;
$score_arr[$golfer_id][8]=5;
$score_arr[$golfer_id][9]=5;

echo json_encode($score_arr); 
```

来自上述 php 脚本的编码 JSON 数组输出这个

```
{"25":
     {"name":"Bob Golfer","1":4,"2":3,"3":4,"4":5,"5":4,"6":5,"7":4,"8":4,"9":3},
 "45":
     {"name":"Joe Golfer","1":4,"2":3,"3":5,"4":5,"5":5,"6":5,"7":5,"8":5,"9":5}
 } 
```

如您所见，Bob 的数据洞数据与 JSON 数组中的 Joe 相同。

但是当我运行我的 js jQuery 脚本时。Bob 的数据未定义，但 joe 的数据很好。怎么会这样？？

这是js

```
<?php
$hole=1;
$grp=$_REQUEST['grp'];
$tid=$_REQUEST['tid'];
?>

<script type="text/javascript">

tid= <?php echo "$tid"; ?>+0;
grp= <?php echo "$grp"; ?>+0;
rnd= <?php echo "$rnd"; ?>+0;

hole = <?php echo "$hole"; ?>+0;
gid=25;
var score_arr  ;
var total = new Array() ;
var total_f = new Array() ;
var total_b = new Array() ;

$(document).ready(function(){

// SET the intial values
$("#hole_num").text(hole);

// Get Data from db
 $.getJSON("gse_db_int.php",{"tid":tid,"grp":grp,"rnd":rnd}, function(data){
 console.log(data); //uncomment this for debug

$("#score").text(data[gid][hole]);
$("#golfer_name").text(data[gid]["name"]);
score_arr= data;

}); //End json

// show the right view
  $("table#one_nine").show();
  $("table#ten_plus").hide();
  $("table#score_entry").show();
  $("table#score_summary").hide();

$("#next_hole").click(function(){
  hole=hole+1;
$("#hole_num").text(hole);
$("#score").text(score_arr[gid][hole]);
$("#golfer_name").text(score_arr[gid]["name"]);
});

$("#prev_hole").click(function(){
  hole=hole-1;
$("#hole_num").text(hole);
$("#score").text(score_arr[gid][hole]);
});

$(".score_button").click(function() {
score_arr[gid][hole]= parseInt(this.value);
$("#score").text(score_arr[gid][hole]);
    });

$("#but_ten_plus").click(function() {
      $("table#one_nine").hide();
      $("table#ten_plus").show();
    });
 $("#but_one_nine").click(function() {
      $("table#one_nine").show();
      $("table#ten_plus").hide();
    });

 $("table#tab_head").click(function() {
     score_summary();
      $("table#score_entry").hide();
      $("table#score_summary").show();

 });
 $("tr#sum_head").click(function() {
      $("table#score_entry").show();
      $("table#score_summary").hide();
 });

// build the score summary
function score_summary(){
    $("#plug").text("");
 $.each(score_arr,function(gid,i){
    console.log(gid);
    console.log(score_arr[gid]["name"]);
    total[gid]=0;
    total_f[gid]=0;
    total_b[gid]=0;
    $("#plug").append('<td> '+score_arr[gid]["name"]+' </td> ');
 //FRONT
    for(hol=1; hol <= 9 ; hol++){
        $("#plug").append('<td> '+score_arr[gid][hol]+' </td> ');
        console.log(score_arr[gid][hol]);
      total_f[gid]= total_f[gid]+ score_arr[gid][hol];
    }
    $("#plug").append('<td> '+total_f[gid]+' </td> ');

//BACK
      for(hol=1; hol <= 9 ; hol++){
        $("#plug").append('<td> '+score_arr[gid][hol]+' </td> ');
        console.log(score_arr[gid][hol]);
      total_b[gid]= total_b[gid]+ score_arr[gid][hol];
    }
    $("#plug").append('<td> '+total_b[gid]+' </td> ');

      total[gid]= total_f[gid]+total_f[gid];
      $("#plug").append('<td> '+total[gid]+' </td> ');
    $("#plug").append('</tr> <tr>');
 });
 }

 });

   </script> 
```

戴夫

# apache - 设置apache基本认证服务器端？

> ID：13574100
> 
> 赞同：0
> 
> 时间：2012-11-26T22:17:08.330
> 
> 标签：apache, basic-authentication

是否可以从服务器响应中设置基本身份验证用户名和密码？

我有一个网站 www.example.com，您可以在其中使用任何给定的 cookie 身份验证系统登录。

该站点还有一个应用程序，其 URL 由不同的服务器提供，例如 www.example.com/other。另一个 url 提供的应用程序不是由我维护的，我不想尝试编辑它以添加密码系统。

我想使用基本身份验证来保护该目录，然后让我的主站点在他们访问 www.example.com 时设置基本身份验证，然后再转到另一个 url。

还是有更好的方法来做到这一点？

*编辑更多信息：

www.example.com 由使用 mod_wsgi 的烧瓶应用程序提供服务

www.example.com/other 是一个通过 Apache 服务的 awstats (php) 应用程序，

烧瓶应用程序有一个基于 cookie 的身份验证系统，我想将其扩展到 awstats 应用程序。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:24:49.570

如果您真的想将用户从一个 Web 应用程序服务器转移到另一个 Web 应用程序服务器，这是不可能的，因为在连接到正在使用的服务器时，客户端始终需要提供基本身份验证凭据。

您也许可以使用 cURL 或类似方法代表用户从第二台服务器获取内容，并将其显示在第一台服务器上的 Web 应用程序中。或者您可以将您的服务器配置为代理，但如果您确实希望在客户端和第二台服务器之间直接完成请求，您将需要研究一种不同的身份验证机制 - 可能类似于 OAuth。

# ios - 在地图视图上显示用户选择的位置

> ID：13574101
> 
> 赞同：1
> 
> 时间：2012-11-26T22:17:08.397
> 
> 标签：ios, location, mkmapview, subview, animated

我从 UITextFields 中的用户那里得到坐标。他以度、分和秒为单位输入它们。转换后我从他们那里得到纬度和经度。我设置坐标并“构建”地图。这个构建的地图视图我将它作为子视图添加到 UIViewController。

```
CLLocationCoordinate2D location = CLLocationCoordinate2DMake(finalLatValue,finalLongValue);
MKCoordinateRegion region = MKCoordinateRegionMakeWithDistance(location, LOCATION_DISTANCE, LOCATION_DISTANCE);
MKMapView *mvMap = [[MKMapView alloc] initWithFrame:CGRectMake(20,594,360,347)];

mvMap.mapType = MKMapTypeSatellite;
mvMap.autoresizingMask = UIViewAutoresizingNone;
mvMap.region = region;
[mvMap setRegion:region animated:YES];
//mvMap.showsUserLocation = YES;
[self.view addSubview:mvMap]; 
```

如您所见，我使用 finalLatValue 和 finalLongValue 创建了一个位置。然后我创建了一个地图并将其作为子视图添加到 self.view。它完美地工作。现在我只需要那个位置上的一个蓝点。我做了 setRegion:animated 和 showUserLocation..两者都没有工作。我错过了什么？这个想法是让用户以度、分和秒为单位输入坐标，并在地图上用蓝点显示位置。CGRectMake(20,594,360,347) 只是在视图的左下方创建我的地图视图，就像我一样按钮和标签遍布我的视野。如果需要更多信息，请询问。谢谢..

```
MKPointAnnotation *annotationPoint = [[MKPointAnnotation alloc]init];
annotationPoint.coordinate = location;
annotationPoint.title=@"Company";
annotationPoint.subtitle = @"Company HQ";
[mvMap addAnnotation:annotationPoint]; 
```

所以我添加了这些行，现在我的位置显示一个红色图钉。现在就可以了。现在我有关于放大和缩小地图视图的问题。我该怎么做？任何帮助将不胜感激。我还有更多问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:22:36.423

Apple 提供了一个很好的文档

位置感知编程指南

[http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/MapKit/MapKit.html](http://developer.apple.com/library/ios/#documentation/userexperience/conceptual/LocationAwarenessPG/MapKit/MapKit.html)

您可以在注释章节下找到：

蓝点称为“UserLocAnnotation”（或类似名称）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T00:00:49.653

调用 showUserLocation 将显示用户的位置，但您正在寻求帮助，在用户输入的坐标处显示一个蓝点，这可能不是他们当前的位置。

您想要做的是将 MKAnnotation 添加到您的地图中。正如 AlexWien 所说，Apple 拥有关于该主题的非常完整的文档。此链接将引导您完成制作 MKAnnotation 并设置其位置的过程，然后定义地图将在该位置绘制的图像

[http://developer.apple.com/library/ios/documentation/userexperience/conceptual/LocationAwarenessPG/AnnotatingMaps/AnnotatingMaps.html#//apple_ref/doc/uid/TP40009497-CH6-SW1](http://developer.apple.com/library/ios/documentation/userexperience/conceptual/LocationAwarenessPG/AnnotatingMaps/AnnotatingMaps.html#//apple_ref/doc/uid/TP40009497-CH6-SW1)

# magento - Magento checkout_cart_product_add_before 并获取添加的产品数量

> ID：13574104
> 
> 赞同：4
> 
> 时间：2012-11-26T22:17:22.793
> 
> 标签：magento, observers

我创建了事件 checkout_cart_product_add_before： http: [//markshust.com/2012/08/27/create-checkout_cart_product_add_before-observer-magento](http://markshust.com/2012/08/27/create-checkout_cart_product_add_before-observer-magento)

但是，当我这样做时， getQuoteItem() 似乎不可用，因此我无法获得添加到购物车的产品数量。当我使用 _after 方法时，我可以使用：

```
public function checkStock2($observer) {
  Mage::log("Check stock before");
  $request = $observer->getQuoteItem();
  Mage::log("q in order = " .$request['qty'] ."");
} 
```

但是，当我之前无法到达 getQuoteItem 时，因为它还没有。有没有办法获得用户尝试添加到购物车的产品数量？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T22:54:21.280

如果您实现了链接的观察者，您将丢失所需的信息。您必须在 dispatchEvent 中添加请求，以检查用户选择的内容：

```
public function addProduct($productInfo, $requestInfo=null)
    {
        $product = $this->_getProduct($productInfo);
        $request = $this->_getProductRequest($requestInfo);
        Mage::dispatchEvent('checkout_cart_product_add_before', array(
             'product' => $product,
              'request' => $request
        ));

        return parent::addProduct($productInfo, $requestInfo);
    } 
```

然后，您将能够使用以下命令在观察者中检索用户数量：

```
$observer->getEvent()->getRequest()->getQty(); 
```

该`->getRequest()`方法引用了您的 dispatchEvent 的“请求”参数的魔术 getter。

# cocos2d-iphone - 如何在现有图层上创建下拉菜单效果？Cocos2d

> ID：13574109
> 
> 赞同：0
> 
> 时间：2012-11-26T22:17:37.163
> 
> 标签：cocos2d-iphone, cclayer

我的主图层带有一个选项按钮，当我按下按钮时，我在 CCLayerColor 图层上调用 pushScene，该图层只有屏幕大小的一半，因为我希望它像一个下拉菜单，但是当它出现时随着我设置的过渡，背景层变黑。我希望背景层始终保持可见。我很确定背景层正在被释放。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T07:26:58.007

如果使用`pushScene:`，则不会释放先前的场景。`popScene`发送消息后会恢复。据我了解，您消失的“背景层”是以前的场景。不在场景堆栈顶部的场景将不会收到`visit`消息，因此它根本不会被绘制。这就是它消失的原因。

无论如何，你为什么要使用另一个场景作为下拉菜单？创建单独的图层并在需要时简单地显示/隐藏或添加/删除它。

# c# - 如何在用户点击后向下移动一个圆圈？连接四个 C#

> ID：13574111
> 
> 赞同：1
> 
> 时间：2012-11-26T22:17:49.953
> 
> 标签：c#, graphics, mousemove, ellipse

所以我是 C# 编程的新手，我正在创建一个带有图形的***连接四游戏。***我有一个带圆圈的网格。我需要做的是，当用户点击某个列时，看到芯片向下移动。我需要使用计时器或其他东西吗？还是我做一个循环，也许每次都给一个较小的 yCoordinate 向下移动圆圈？

另外，有没有办法让这个圆圈不会与网格重叠？如，我可以让它看起来好像它正在网格后面移动吗？

这是我到目前为止所做的......

```
 private int columnPosition = 0;
    private int xCoordinate;
    private int yCoordinate;

    public Form1()
    {
        InitializeComponent();
    }

    private void panel1_Paint(object sender, PaintEventArgs e)
    {

        Graphics g = grid.CreateGraphics();
        Pen pen = new Pen(Color.White, 1);
        Pen pen2 = new Pen(Color.Black, 4);

        for (int i = 0; i < 7; i++)
        {
            for (int j = 0; j < 6; j++)
            {
                g.DrawEllipse(pen2, new System.Drawing.Rectangle((i * 70) + 20, (j * 60) + 10, 50, 50));
                g.FillEllipse(pen.Brush, new System.Drawing.Rectangle((i *70) + 20, (j * 60) + 10, 50, 50));

            }
        }
    }

    private void panel2_Paint(object sender, PaintEventArgs e)
    {
        Graphics g = panel2.CreateGraphics();
        Pen pen = new Pen(Color.Red, 5);
        Pen pen2 = new Pen(Color.Black, 3);

        if (columnPosition != -1)
        {
            g.DrawEllipse(pen2, new System.Drawing.Rectangle(columnPosition * 35 - 15, 0, 50, 50));
            g.FillEllipse(pen.Brush, new System.Drawing.Rectangle(columnPosition * 35 - 15, 0, 50, 50));

        }

    }

    private void panel1_MouseMove(object sender, MouseEventArgs e)
    {
        columnPosition = e.X / 35;
        Console.WriteLine(e.X);
        panel2.Refresh();
    }

    private void panel1_MouseLeave(object sender, EventArgs e)
    {
        columnPosition = -1;
        panel2.Refresh();
    }

    private void panel1_MouseClick(object sender, EventArgs e) 
    {
          ///// THIS IS WHERE I AM STUCK
    } 
```

}

抱歉，我想上传网格的图像，但由于我是新用户，我不能 -.- !!

在此先感谢您的帮助:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:30:29.377

您可以使用计时器，但您还需要在整个动画中跟踪每个圆圈。如果用户在动画仍在播放时单击另一列怎么办？你不想重复使用同一个计时器，你会想要另一个。

计时器的一个缺点是圆圈不会顺畅流动，除非你让计时器经常关闭，但是你会遇到在已经过去的时间内移动正确数量的问题（如果计算机在负载很重，不能马上处理定时器？）。此外，WinForms API 并不是为处理高刷新率而设计的（为此目的开发了 DirectX 等其他库）。

大多数具有动画的游戏都使用另一种方法来处理所有这些。本质上，应用程序变成了一个大的 while(true) 循环。它可能不是字面上`while(true)`的，但想法是只要游戏在运行，循环就会继续迭代。在循环的每次迭代中，您绘制游戏。下一次循环迭代时，您计算已经过去了多少时间，然后使用它来确定每个精灵（图形）应该移动多远，然后相应地绘制它们。这非常类似于实际动画的工作方式（例如剧院中的电影）。对人眼来说，它看起来像是一张运动的画面，但实际上它是一系列高速刷新的静止图像（通常每秒 30 - 60 次）。

我不是专业的游戏开发者。我什至不确定我是否会认为自己是“最喜欢的人”。我确信现代游戏编程比我所描述的要发展得多，但基本概念都在那里。我会建议拿起一本书（或在网上找到一个好的教程），旨在向非游戏开发人员教授游戏开发（初学者指南）。

# java - SimpleDateFormat 的无法解释的 ParseException

> ID：13574113
> 
> 赞同：3
> 
> 时间：2012-11-26T22:17:59.193
> 
> 标签：java, simpledateformat

我正在尝试解析格式中出现的日期`"01-26-2012 03:07 AM"`。

我创建了这个`SimpleDateFormat`：

```
private static final DateFormat DATE_FORMAT = new SimpleDateFormat("MM-dd-yyyy hh:mm a"); 
```

然而，每次我解析以下内容时：

```
String date = "01-26-2012 03:07 AM";
Date myDate =  DATE_FORMAT.parse(date.trim()); 
```

我得到一个`ParseException`：

> java.text.ParseException：无法解析的日期：“01-26-2012 03:07 AM”在 java.text.DateFormat.parse(DateFormat.java:337)

我的`SimpleDateFormat`字符串正确吗？还有什么可能阻止它解析吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:20:01.310

这很可能是语言环境问题。例如，如果您尝试使用英语语言环境，它应该可以工作：

```
DateFormat DATE_FORMAT = new SimpleDateFormat("MM-dd-yyyy hh:mm a", Locale.ENGLISH); 
```

由于您没有指定语言环境，因此使用系统的默认语言环境，并且“AM”可能无法正确解析。

下面的代码输出

> myDate = 2012 年 1 月 26 日星期四 03:07:00 GMT

```
public static void main(String[] args) throws Exception {
    String date = "01-26-2012 03:07 AM";
    DateFormat DATE_FORMAT = new SimpleDateFormat("MM-dd-yyyy hh:mm a", Locale.ENGLISH);
    Date myDate = DATE_FORMAT.parse(date.trim());
    System.out.println("myDate = " + myDate);
} 
```

作为旁注，如果您将代码更改`Locale.CHINESE`为例如，您将得到一个解析异常。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:34:45.507

用作静态对象是不正确的，`SimpleDateFormat`因为它不是[线程安全](http://www.codefutures.com/weblog/andygrove/2007/10/simpledateformat-and-thread-safety.html)的。我不能说这是这里的问题，但可能是一个指针。

# jquery - keyup 不能用在 id 上，但可以用在 document 上

> ID：13574114
> 
> 赞同：0
> 
> 时间：2012-11-26T22:18:03.843
> 
> 标签：jquery, jquery-ui

我在检测文本框上的输入键事件时遇到问题。我似乎不能使用这个

```
$("#serial").keyup(function(e) {
    if(e.which == 13) {
...
   }
}); 
```

但是如果我使用它，可以检测到 keyup 事件

```
$(document).keyup(function(e) {
    if(e.which == 13) {
...
   }
}); 
```

这有点尴尬，因为无论光标位置如何，如果按下输入键都会触发事件。希望有人会在这方面有一个指针。谢谢：D

- - 编辑 - -

我认为在网站上包含这些插件对我来说是公平的：

```
<script type="text/javascript" src="js/plugins/wysiwyg/jquery.wysiwyg.js"></script>
<script type="text/javascript" src="js/plugins/wysiwyg/wysiwyg.image.js"></script>
<script type="text/javascript" src="js/plugins/wysiwyg/wysiwyg.link.js"></script>
<script type="text/javascript" src="js/plugins/wysiwyg/wysiwyg.table.js"></script>

<script type="text/javascript" src="js/plugins/flot/jquery.flot.js"></script>
<script type="text/javascript" src="js/plugins/flot/jquery.flot.orderBars.js"></script>
<script type="text/javascript" src="js/plugins/flot/jquery.flot.pie.js"></script>
<script type="text/javascript" src="js/plugins/flot/excanvas.min.js"></script>
<script type="text/javascript" src="js/plugins/flot/jquery.flot.resize.js"></script>

<script type="text/javascript" src="js/plugins/tables/jquery.dataTables.js"></script>
<script type="text/javascript" src="js/plugins/tables/colResizable.min.js"></script>

<script type="text/javascript" src="js/plugins/forms/forms.js"></script>
<script type="text/javascript" src="js/plugins/forms/autogrowtextarea.js"></script>
<script type="text/javascript" src="js/plugins/forms/autotab.js"></script>
<script type="text/javascript" src="js/plugins/forms/jquery.validationEngine-en.js"></script>
<script type="text/javascript" src="js/plugins/forms/jquery.validationEngine.js"></script>
<script type="text/javascript" src="js/plugins/forms/jquery.dualListBox.js"></script>
<script type="text/javascript" src="js/plugins/forms/chosen.jquery.min.js"></script>
<script type="text/javascript" src="js/plugins/forms/jquery.maskedinput.min.js"></script>
<script type="text/javascript" src="js/plugins/forms/jquery.inputlimiter.min.js"></script>
<script type="text/javascript" src="js/plugins/forms/jquery.tagsinput.min.js"></script>

<script type="text/javascript" src="js/plugins/other/calendar.min.js"></script>
<script type="text/javascript" src="js/plugins/other/elfinder.min.js"></script>

<script type="text/javascript" src="js/plugins/uploader/plupload.js"></script>
<script type="text/javascript" src="js/plugins/uploader/plupload.html5.js"></script>
<script type="text/javascript" src="js/plugins/uploader/plupload.html4.js"></script>
<script type="text/javascript" src="js/plugins/uploader/jquery.plupload.queue.js"></script>

<script type="text/javascript" src="js/plugins/ui/jquery.progress.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.jgrowl.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.tipsy.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.alerts.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.colorpicker.js"></script>

<script type="text/javascript" src="js/plugins/wizards/jquery.form.wizard.js"></script>
<script type="text/javascript" src="js/plugins/wizards/jquery.validate.js"></script>

<script type="text/javascript" src="js/plugins/ui/jquery.breadcrumbs.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.collapsible.min.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.ToTop.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.listnav.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.sourcerer.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.timeentry.min.js"></script>
<script type="text/javascript" src="js/plugins/ui/jquery.prettyPhoto.js"></script>
<script type="text/javascript" src="js/plugins/spinner/jquery.mousewheel.js"></script>
<script type="text/javascript" src="js/plugins/spinner/ui.spinner.js"></script>

<script type="text/javascript" src="js/custom.js"></script>

<script type="text/javascript" src="js/charts/chart.js"></script>
<script type="text/javascript" src="js/charts/auto.js"></script>
<script type="text/javascript" src="js/charts/bar.js"></script>
<script type="text/javascript" src="js/charts/hBar.js"></script>
<script type="text/javascript" src="js/charts/pie.js"></script> 
```

事情是..我不知道是否有任何这些可以解除 keyup 事件的绑定

# javascript - css真的不理我了

> ID：13574117
> 
> 赞同：3
> 
> 时间：2012-11-26T22:18:12.557
> 
> 标签：javascript, jquery, css

我正在做这个程序，其中包括 css。

我想帮助你的东西可以在这里找到：http: [//jsfiddle.net/yupsdk/6MxfQ/10/](http://jsfiddle.net/yupsdk/6MxfQ/10/)

```
body { margin: auto; }

#fields {
    position: relative; 
    width: 408px; 
    height: 370px; 
    background: url('http://hhsrv.n.dk/chat/gfx/rum/sms/old/gummicelle.jpg') repeat-x; border: 1px #DDD solid; 
}

.field {
    width: 2px;  
    height: 2px; 
    background: #FF0000; 
    position: absolute;
}

#user { 
    top: 500;   
    border: 1px solid black; 
    background: url('http://www.geekabit.dk/community/profil/figur/1335803573_149116.gif') no-repeat;  
    width: 52px; 
    height: 77px; 
} 
```

加载脚本时，该人需要站在数字上，就像它生成时需要站在 25 上，而不是像我现在那样站在它下面。如果你的浏览器中有控制台，它会告诉你它应该站在哪个领域。

实在想不通。我已经尝试过 z-index 和 top，但是没有用。我希望你能在这里帮助我。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:21:15.390

我相信你想要`position:relative`和`z-index`。

衬衫下的号码：http: [//jsfiddle.net/6MxfQ/17/](http://jsfiddle.net/6MxfQ/17/)

衬衫号码：http: [//jsfiddle.net/6MxfQ/16/](http://jsfiddle.net/6MxfQ/16/)

```
#user { border: 1px solid black;
   background: url('http://www.geekabit.dk/community/profil/figur/1335803573_149116.gif')
   no-repeat; width: 52px; height: 77px;
   position:relative;z-index:1;} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:32:47.183

问题是您只是附加了#user div，因此它位于已选择的数字之后。为了让它看起来像用户站在数字上方，您需要使用负边距：

```
#user { ... margin: -97px 0 0 -20px; } 
```

如果要调整用户的位置，请使用这些顶部和左侧边距值。

[jsFiddle](http://jsfiddle.net/jesus_tesh/5RbZB/)

# angularjs - 跨多个范围的 $watch-ing 变量

> ID：13574123
> 
> 赞同：2
> 
> 时间：2012-11-26T22:18:49.320
> 
> 标签：angularjs

我在一个指令中，我想`$watch`对一个存在于本地的变量`$scope`和一个存在于`$rootScope`. 它看起来像：

```
myapp.directive('cohnbread',
            ['TEMPLATE_URL', '$rootScope',
    function(TEMPLATE_URL,    $rootScope) {
        return {
            templateUrl: TEMPLATE_URL + "cohnbread.html",
            scope: { odp: '@' },
            link: function(scope, elem, attrs) {
                // here I would like to register a callback to fire 
                // whenever scope.bar or $rootScope.foo fires. Something like:
                $watchBoth('scope.bar', '$rootScope.foo', onBarOrFooChange);
            }
        };
    }]); 
```

是否有解决方法来实现这一点？

*编辑以提供更多信息。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:36:52.983

如果您只想在其中一个*或*另一个更改时触发回调，只需`$watch`为每个设置一个。例如：

```
scope.$watch('bar', onBarOrFooChange);
scope.$watch('foo', onBarOrFooChange); 
```

或者如果你的指令有一个独立的范围，你可以像这样设置`$watch`for `foo`：

```
scope.$watch(function() {return $rootScope.foo}, onBarOrFooChange); 
```

# html - HTML5 Soundcloud 小部件中的 Flash？

> ID：13574125
> 
> 赞同：1
> 
> 时间：2012-11-26T22:18:57.957
> 
> 标签：html, flash, soundcloud

我们使用了**Soundcloud HTML5 Widget**（在此引用：http: [//blog.soundcloud.com/2012/01/26/html5-widget/](http://blog.soundcloud.com/2012/01/26/html5-widget/)），似乎对 *soundmanager2_flash9.swf* 的调用已经进入小部件（可能用于显示和管理新作品？）。

为什么会有 Flash 文件加载到 HTML5 播放器中？我们错过了什么吗？请指教。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:36:26.557

我猜它被用作现代浏览器声音 API 实现的后备。此 API 尚未最终确定，并且无法在所有浏览器上保持一致。html5 的某些部分可以被认为是测试版，如果你想要跨浏览器的体验，你需要破解后备。较旧的浏览器从来没有播放声音的本机能力，但 Flash 在 Web 上存在的早期就支持播放声音。

# google-maps-api-3 - 融合表层缓存问题

> ID：13574126
> 
> 赞同：1
> 
> 时间：2012-11-26T22:18:58.127
> 
> 标签：google-maps-api-3, google-fusion-tables

我创建了一系列融合表层，并对其中一个层应用过滤以响应复选框单击事件。地图的基础层包含应用于县边界的梯度。未选中基础层时，过滤层将失去其样式。我为所有查询添加了唯一的时间戳以避免缓存，但是我觉得这些图像切片仍然会在这种情况下被缓存。有什么方法可以强制 google fusion tables api 使缓存的图像无效？

此处的测试站点：http: [//map.inquestmarketing.com/new.html](http://map.inquestmarketing.com/new.html)

取消选中 Other -> Consumer Prospects 复选框会重现该问题。

这是一个纯客户端应用程序，所有源代码都在单个页面中。

**更新**

我能够通过将样式过滤器应用于 FusionTablesLayer 客户端来解决此问题。

我过滤了 3 种不同的情况，但为了全面应用我可以使用的样式：

样式：[{ markerOptions: { iconName: "large_blue" } }]

在 FusionTablesLayer 构造函数和 setOptions 函数中。

希望这对其他人有帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-05T21:20:36.210

根据 Google 的 Kathryn，您可以通过添加时间戳来刷新磁贴。这是一个 jQuery 片段，您可以使用或适应您的需要。

```
setTimeout(function(){
       $("img[src*='googleapis']").each(function(){
               $(this).attr("src",$(this).attr("src")+"&"+(new Date()).getTime());
       });
},3000); 
```

来源：[https ://groups.google.com/forum/#!msg/fusion-tables-users-group/wCLHnyoZRYk/MtLHFZ-o4zAJ](https://groups.google.com/forum/#!msg/fusion-tables-users-group/wCLHnyoZRYk/MtLHFZ-o4zAJ)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:28:03.380

我认为无论如何都没有办法阻止缓存平铺数据。因为 Fusion Table 在 Google 服务器上渲染平铺图像，通常需要一些时间。

此外，大多数浏览器会根据 FusionTableLayer（即 Javascript）生成的 URL 缓存图像。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:01:32.937

The issue is a coding problem on your map; you hide [this layer](https://www.google.com/fusiontables/DataSource?snapid=S786425duiL) based on that (Consumer Prospects) check box. If you want it to be displayed don't hide it and leave it hidden. I don't see offhand why the blue markers go with it.

# java - 在 Java 中随机生成 *interesting* 字符串

> ID：13574130
> 
> 赞同：4
> 
> 时间：2012-11-26T22:19:11.793
> 
> 标签：java, string, random, scalacheck

我一直在使用 ScalaCheck 进行自动单元测试。它的默认字符串生成器（即它的默认`Arbitrary[String]`实例）有点**太**强大了，通常会产生一个不可读的混乱，主要由我不想支持的字符组成，我的系统甚至无法渲染。

我已经着手创建更多`Arbitrary[String]`实例，并试图找出那里有什么。以下是一些有助于测试的 String 类示例：

*   基本多语言平面字符串
*   星光弦
*   拉丁字符串（包括扩展 a/b）
*   法语单词
*   从左到右的语言字符串
*   从右到左的语言字符串
*   中文句子
*   “网络字符串”（从构成网络内容 99.9999% 的字符集中提取的字符串）
*   动用你的想象力 ...

是否有可以随机生成这些或类似字符串的库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:28:38.450

我会采取不同的方法。您的所有示例都映射到 Unicode 中的字符块。请参阅[http://www.fileformat.info/info/unicode/block/index.htm](http://www.fileformat.info/info/unicode/block/index.htm)只需选择您喜欢的块，然后生成限制在这些范围内的随机字符串。

```
int count = 10;
StringBuilder out = new StringBuilder();
Random rand = new Random(0);
for (int i = 0; i < count; i++) {
  char ch = rand.nextInt(numCharsInRange) + firstCharInRange;
  out.append(ch);
}
return out.toString(); 
```

另一种方法是从不同语言中随机抓取预先编写的文本片段。你可以在这里获取一些：[http](http://www.unicode.org/standard/WhatIsUnicode.html) ://www.unicode.org/standard/WhatIsUnicode.html看看翻译。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:34:48.743

尝试

```
RandomStringUtils.random(10, true, false) 
```

参数如下：`int count, boolean letters, boolean numbers`

您将需要导入`org.apache.commons.lang.RandomStringUtils;`

# python - 如何在字符串中移动单词？

> ID：13574132
> 
> 赞同：3
> 
> 时间：2012-11-26T22:19:25.473
> 
> 标签：python, python-2.7

Python 2.7 中是否有一种“本机”方式在较长的字符串中移动单词（以空格分隔的子字符串）？基本上，我正在寻找的是：

```
ret = 'The quick brown fox jumps over the lazy dog'.move_word('quick',2)
# ret = 'The brown fox quick jumps over the lazy dog' 
```

我的想法是通过编写一个函数来拆分为一个列表，遍历列表以查找匹配项，然后在找到单词时重新排序。我的问题实际上是要找出是否有“光滑”/Pythonic 的方法来代替。

谢谢！

编辑：根据下面的评论：上面示例中的数字参数旨在指定单词数量的“增量”。对于上面的示例，2 的意思是“向右移动 '快速' 2 个单词”。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:49:26.247

不确定我是否称其为“光滑”，但它可以完成工作并且非常简单：

```
def reorder(s, word, delta):
  words = s.split()
  oldpos = words.index(word)
  words.insert(oldpos+delta, words.pop(oldpos))
  return ' '.join(words)

print reorder('The quick brown fox jumps over the lazy dog', 'quick', 2) 
```

（我假设您示例中的 2 是移动单词的位置数。）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:40:19.720

嗯，这个

```
r = lambda x, y, z: " ".join(x.split(" ")[0:x.split(" ").index(y)] + x.split(" ")[x.split(" ").index(y)+1:x.split(" ").index(y)+z] + [x.split(" ")[x.split(" ").index(y)]] + x.split(" ")[x.split(" ").index(y)+z:]) 
```

可能**不是**Pythonic，但它很有趣。

（更不用说高度不是最优的了）

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-26T22:52:45.220

这就是我要做的。它将字符串拆分为列表，移动项目，然后将其重新连接在一起：

```
def move_word(s, word, pos):
   split = s.split()
   split.insert(pos, split.pop(split.index(word)))
   return ' '.join(split) 
```

这是一个例子：

```
>>> s = 'The quick brown fox jumps over the lazy dog'
>>> move_word(s, 'quick', 2)
'The brown quick fox jumps over the lazy dog'
>>> move_word(s, 'jumps', 0)
'jumps The quick brown fox over the lazy dog' 
```

# asp.net - 从标签设置 ASP.NET 页面文化？

> ID：13574133
> 
> 赞同：2
> 
> 时间：2012-11-26T22:19:28.550
> 
> 标签：asp.net, html, localization, globalization

我可以让我的 ASP.NET 页面从`<html lang="fr">`标签/属性中设置他们的文化和 UICulture 吗？

我正在寻找一种代码影响最小的解决方案，该解决方案适用于只需要少量代码的网站创作。

请注意，我查看了许多关于 ASP.NET 页面文化的帖子，但没有一篇提到从`<html>`标记中获取设置并将其应用于 ASP.NET 页面类。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:29:38.443

您可以设置 @Page 指令的 Culture 和 UICulture 属性：

```
<%@ Page UICulture="es" Culture="es-MX" %> 
```

正如你[在这里看到的](http://msdn.microsoft.com/en-us/library/bz9tc508%28v=vs.100%29.aspx)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T17:23:59.993

如果可以添加：

```
runat="server" id="HtmlMasterTag" 
```

对于 html 标记，您可以在页面后面的代码中（或在一个常见的基本页面中）执行此类操作：

```
string language = HtmlMasterTag.Attributes["lang"]; 
```

并使用变量*语言*设置 UICulture 和 Culture

# ios - 在多个 OpenGL-ES 上下文之间共享一个 glProgram？

> ID：13574140
> 
> 赞同：5
> 
> 时间：2012-11-26T22:19:54.983
> 
> 标签：ios, opengl-es, opengl-es-2.0, shader

我有一个带有多个使用 OpenGL ES 2.0 和自定义片段着色器的 OpenGL-ES 视图的 iPad 应用程序。目前，着色器已针对每个单独的 OpenGL 视图进行编译和链接。我想编译和链接一次着色器，并为每个视图重新使用它们。从理论上讲，这应该只是一个调用的问题

`gluseProgram(gProgramHandle);`

在我的 render() 方法中，在渲染之前，并加载一次 gProgramHandle，对吧？但这不起作用。当我切换到使用单个 gProgramHandle（在初始化时设置为 -1）时，只有一个 OpenGL 视图有效，其他视图显示为深绿色矩形。我究竟做错了什么？

```
- (void)loadShaders
{
   if (gProgramHandle == -1)
{
    NSLog(@"Compiling shaders...");

    GLuint vertexShader = [self compileShader:@"AIMGsiVertexShader" withType:GL_VERTEX_SHADER];
    GLuint fragmentShader = [self compileShader:@"AIMGsiFragmentShader" withType:GL_FRAGMENT_SHADER];

    gProgramHandle = glCreateProgram();
    glAttachShader(gProgramHandle, vertexShader);
    glAttachShader(gProgramHandle, fragmentShader);
    glLinkProgram(gProgramHandle);

    GLint linkSuccess;
    glGetProgramiv(gProgramHandle, GL_LINK_STATUS, &linkSuccess);
    if (linkSuccess == GL_FALSE)
    {
            // If there was an error when compiling the gsls shaders, report the compile error and quit.
        GLchar messages[256];
        glGetProgramInfoLog(gProgramHandle, sizeof(messages), 0, &messages[0]);
        NSString *messageString = [NSString stringWithUTF8String:messages];
        NSLog(@"%@", messageString);
        exit(1);
    }

    NSLog(@"Done compiling and linking shaders.");
}

    // We can efficiently switch between shaders by calling glUseProgram() to use the program with the shaders we want to use.
glUseProgram(gProgramHandle);

    // Gradient map values are sent in this vector: numValuesInCache, factor, offset
_gradientValsUniform = glGetUniformLocation(gProgramHandle, "GradientVals");
_numColorsInGradient = glGetUniformLocation(gProgramHandle, "NumColorsInCache");
_gradientColorsArray = glGetUniformLocation(gProgramHandle, "ColorsArray");

_positionSlot = glGetAttribLocation(gProgramHandle, "Position");

glEnableVertexAttribArray(_positionSlot);

_projectionUniform = glGetUniformLocation(gProgramHandle, "Projection");
_modelViewUniform = glGetUniformLocation(gProgramHandle, "Modelview");

_texCoordSlot = glGetAttribLocation(gProgramHandle, "TexCoordIn");
glEnableVertexAttribArray(_texCoordSlot);
_textureUniform = glGetUniformLocation(gProgramHandle, "Texture");

} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2014-05-08T12:46:59.790

以下是[EAGLSharegroup 类参考](https://developer.apple.com/library/ios/documentation/opengles/reference/EAGLSharegroup_ClassRef/Reference/EAGLSharegroup.html)中关于共享的引用：

> 目前，共享组管理纹理、缓冲区、帧缓冲区和渲染缓冲区。

如您所见，未提及着色器/程序/管道。

[然而，这里是来自Apple 开发论坛](https://devforums.apple.com/message/964155)的引述：

> 共享 Shaders/Programs/Pipelines 是合法的，但实际上要避免同时使用同一个 Program。
> 
> 问题是 Uniform 值是程序本身的属性，因此如果您从多个线程中使用同一个程序，这将违反禁止从一个线程修改对象同时从另一个线程使用它的规则。
> 
> 如果使用不重叠（例如，一个上下文生成程序，另一个渲染），那应该可以正常工作。

为了测试着色器和管道的共享，我为 iPad 开发了一个简单的项目：[https](https://github.com/Gubarev/shared-shaders-test) ://github.com/Gubarev/shared-shaders-test 。我可以确认共享有效！

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-11-26T23:12:26.947

您不能跨上下文共享程序。GL 上下文是状态信息的集合，程序是该状态的一部分。我会质疑是否每个视图都需要自己的上下文，这很可能不需要。如果您在主线程上进行所有渲染，则在视图之间共享上下文，并在每个视图的每次绘制调用中设置您需要的状态。如果您在多个线程上渲染，`[[EAGLContext alloc] initWithAPI:... sharegroup:...]`请查看使用主上下文创建上下文并传入共享组。

# ruby-on-rails-3 - git aws.push 命令不是由 eb init 创建的

> ID：13574143
> 
> 赞同：7
> 
> 时间：2012-11-26T22:20:16.210
> 
> 标签：ruby-on-rails-3, amazon-web-services, amazon-elastic-beanstalk, deploying

我正在关注[如何在 AWS 上部署 Ruby on Rails 应用程序](http://docs.amazonwebservices.com/elasticbeanstalk/latest/dg/create_deploy_Ruby_rails.html)的教程，并在尝试执行`git aws.push`命令时收到以下错误：

`fatal: cannot exec 'git-aws.push': Not a directory`

根据[本教程](http://ruby.awsblog.com/post/Tx2AK2MFX0QHRIO/Deploying-Ruby-Applications-to-AWS-Elastic-Beanstalk-with-Git)，`eb init`应该为我创建了这个新的 git 命令，但显然它没有......有人偶然发现了这个问题吗？我怎样才能解决这个问题？

我正在使用 Mac OS Lion。

谢谢

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2012-12-28T14:45:55.480

我遇到了同样的问题，目前在非 bash 实现上工作的工具安装程序似乎存在一个小问题。

这是修复（通过亚马逊转发给我）使用命令：

```
 $ bash path/to/AWS-ElasticBeanstalk-CLI-2.3/AWSDevTools/Linux/AWSDevTools-RepositorySetup.sh 
```

***这里的bash***替换***了教程中显示的sh***然后它对我有用

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T11:36:40.207

我已经使用[这个问题](https://stackoverflow.com/questions/4019501/git-alias-problem)的提示来解决我的问题。检查 PATH 中是否没有您没有必要权限的文件夹或文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-21T22:33:30.950

```
export PATH=$PATH:<path to unzipped EB CLI package>/eb/linux/python2.7/ 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-26T21:24:03.787

在 Windows 中，确保您已运行：

```
AWSDevTools-OneTimeSetup.bat 
```

和

```
AWSDevTools-RepositorySetup.bat 
```

这些批处理文件设置 git 与 EB 和 AWS CLI 的交互。

# android - 您如何将字符串用于按钮，但只有前 10 个字符

> ID：13574152
> 
> 赞同：0
> 
> 时间：2012-11-26T22:20:33.443
> 
> 标签：android, android-layout

我有一个按钮，ID 为 button1。当您单击按钮时，它会打开另一个活动，您可以在其中输入文本，当您再次按下后退按钮时，它会保存文本并显示在按钮上。但我只想在按钮上显示前 10 个左右的字符。这可能吗？

这是一些代码：

```
Button item1 = (Button)findViewById(R.id.button1);
        item1.setText(PrefConnector.readString(this, PrefConnector.ONE, null)); 
```

字符串`PrefConnector.readString(this, PrefConnector.ONE, null)`的连接很长，大约一个段落。所以我只希望前 10 个字符出现在按钮上，如果可能的话，最后一个椭圆表示还有更多文本。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:21:41.523

要修改字符串本身，请使用`substring()`：

```
String ellipsed = PrefConnector.readString(this, PrefConnector.ONE, null);
if(ellipsed.length() > 10)
    ellipsed = ellipsed.substring(0, 10) + "...";
item1.setText(ellipsed); 
```

或者，您还应该能够在 Button 的 XML 中定义最大宽度，并允许它在必要时使用省略号：

```
<Button
    android:id="@+id/button1"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:ellipsize="end"
    android:maxWidth="50dp" /> 
```

# javascript - Web Worker 数量限制

> ID：13574158
> 
> 赞同：52
> 
> 时间：2012-11-26T22:21:19.300
> 
> 标签：javascript

**问题**

我发现浏览器可以生成的 Web Worker 的数量是有限制的。

**例子**

主要 HTML / JavaScript

```
<script type="text/javascript">
$(document).ready(function(){
    var workers = new Array();
    var worker_index = 0;
    for (var i=0; i < 25; i++) {
        workers[worker_index] = new Worker('test.worker.js');
        workers[worker_index].onmessage = function(event) {
            $("#debug").append('worker.onmessage i = ' + event.data + "<br>");
        };
        workers[worker_index].postMessage(i); // start the worker.      

        worker_index++;
    }   
});
</head>
<body>
<div id="debug">
</div> 
```

test.worker.js

```
self.onmessage = function(event) {
    var i = event.data; 

    self.postMessage(i);
}; 
```

使用 Firefox（版本 14.0.1，Windows 7）时，这将在容器中仅生成 20 行输出。

**问题**

有没有解决的办法？我能想到的唯一两个想法是：

1）菊花链网络工作者，即让每个网络工作者产生下一个

例子：

```
<script type="text/javascript">
$(document).ready(function(){
    createWorker(0);
});

function createWorker(i) {

    var worker = new Worker('test.worker.js');
    worker.onmessage = function(event) {
        var index = event.data;

        $("#debug").append('worker.onmessage i = ' + index + "<br>");

        if ( index < 25) {
            index++;
            createWorker(index);
        } 
    };
    worker.postMessage(i); // start the worker.
}
</script>
</head>
<body>
<div id="debug"></div> 
```

2）将网络工作者的数量限制为有限的数量，并修改我的代码以使用该限制（即，在有限数量的网络工作者之间分担工作负载） - 像这样：[http ://www.smartjava.org /content/html5-easy-parallelize-jobs-using-web-workers-and-threadpool](http://www.smartjava.org/content/html5-easily-parallelize-jobs-using-web-workers-and-threadpool)

不幸的是，#1 似乎不起作用（只有有限数量的网络工作者会在页面加载时产生）。还有其他我应该考虑的解决方案吗？

* * *

## 回答 #1

> 赞同：107
> 
> 时间：2015-04-02T21:32:32.660

Old question, let's revive it! *readies epinephrine*

I've been looking into using Web Workers to isolate 3rd party plugins since web workers can't access the host page. I'll help you out with your methods which I'm sure you've solved by now, but this is for teh internetz. Then I'll give some relevant information from my research.

***Disclaimer**: In the examples that I used your code, I've modified and cleaned the code to provide a full source code without jQuery so that you and others can run it easily. I've also added a timer which alerts the time in ms to execute the code.*

In all examples, we reference the following `genericWorker.js` file.

*genericWorker.js*

```
self.onmessage = function(event) {
    self.postMessage(event.data);
}; 
```

## Method 1 (Linear Execution)

Your first method is nearly working. The reason why it still fails is that you aren't deleting any workers once you finish with them. This means the same result (crashing) will happen, just slower. All you need to fix it is to add `worker.terminate();` before creating a new worker to remove the old one from memory. Note that this will cause the application to run **much** slower as each worker must be created, run, and be destroyed before the next can run.

*Linear.html*

```
<!DOCTYPE html>
<html>
<head>
    <title>Linear</title>
</head>
<body>
    <pre id="debug"></pre>
    <script type="text/javascript">
        var debug = document.getElementById('debug');
        var totalWorkers = 250;
        var index = 0;
        var start = (new Date).getTime();

        function createWorker() {
            var worker = new Worker('genericWorker.js');
            worker.onmessage = function(event) {
                debug.appendChild(document.createTextNode('worker.onmessage i = ' + event.data + '\n'));
                worker.terminate();
                if (index < totalWorkers) createWorker(index);
                else alert((new Date).getTime() - start);
            };
            worker.postMessage(index++); // start the worker.
        }

        createWorker();
    </script>
</body>
<html> 
```

## Method 2 (Thread Pool)

Using a thread pool should greatly increase running speed. Instead of using some library with complex lingo, lets simplify it. All the thread pool means is having a set number of workers running simultaneously. We can actually just modify a few lines of code from the linear example to get a multi-threaded example. The code below will find how many cores you have (if your browser supports this), or default to 4\. I found that this code ran about 6x faster than the original on my machine with 8 cores.

*ThreadPool.html*

```
<!DOCTYPE html>
<html>
<head>
    <title>Thread Pool</title>
</head>
<body>
    <pre id="debug"></pre>
    <script type="text/javascript">
        var debug = document.getElementById('debug');
        var maxWorkers = navigator.hardwareConcurrency || 4;
        var totalWorkers = 250;
        var index = 0;
        var start = (new Date).getTime();

        function createWorker() {
            var worker = new Worker('genericWorker.js');
            worker.onmessage = function(event) {
                debug.appendChild(document.createTextNode('worker.onmessage i = ' + event.data + '\n'));
                worker.terminate();
                if (index < totalWorkers) createWorker();
                else if(--maxWorkers === 0) alert((new Date).getTime() - start);
            };
            worker.postMessage(index++); // start the worker.
        }

        for(var i = 0; i < maxWorkers; i++) createWorker();
    </script>
</body>
<html> 
```

# Other Methods

## Method 3 (Single worker, repeated task)

In your example, you're using the same worker over and over again. I know you're simplifying a probably more complex use case, but some people viewing will see this and apply this method when they could be using just one worker for all the tasks.

Essentially, we'll instantiate a worker, send data, wait for data, then repeat the send/wait steps until all data has been processed.

On my computer, this runs at about twice the speed of the thread pool. That actually surprised me. I thought the overhead from the thread pool would have caused it to be slower than just 1/2 the speed.

*RepeatedWorker.html*

```
<!DOCTYPE html>
<html>
<head>
    <title>Repeated Worker</title>
</head>
<body>
    <pre id="debug"></pre>
    <script type="text/javascript">
        var debug = document.getElementById('debug');
        var totalWorkers = 250;
        var index = 0;
        var start = (new Date).getTime();
        var worker = new Worker('genericWorker.js');

        function runWorker() {
            worker.onmessage = function(event) {
                debug.appendChild(document.createTextNode('worker.onmessage i = ' + event.data + '\n'));
                if (index < totalWorkers) runWorker();
                else {
                    alert((new Date).getTime() - start);
                    worker.terminate();
                }
            };
            worker.postMessage(index++); // start the worker.
        }

        runWorker();
    </script>
</body>
<html> 
```

## Method 4 (Repeated Worker w/ Thread Pool)

Now, what if we combine the previous method with the thread pool method? Theoretically, it should run quicker than the previous. Interestingly, it runs at just about the same speed as the previous on my machine.

Maybe it's the extra overhead of sending the worker reference on each time it's called. Maybe it's the extra workers being terminated during execution (only one worker won't be terminated before we get the time). Who knows. Finding this out is a job for another time.

*RepeatedThreadPool.html*

```
<!DOCTYPE html>
<html>
<head>
    <title>Repeated Thread Pool</title>
</head>
<body>
    <pre id="debug"></pre>
    <script type="text/javascript">
        var debug = document.getElementById('debug');
        var maxWorkers = navigator.hardwareConcurrency || 4;
        var totalWorkers = 250;
        var index = 0;
        var start = (new Date).getTime();

        function runWorker(worker) {
            worker.onmessage = function(event) {
                debug.appendChild(document.createTextNode('worker.onmessage i = ' + event.data + '\n'));
                if (index < totalWorkers) runWorker(worker);
                else {
                    if(--maxWorkers === 0) alert((new Date).getTime() - start);
                    worker.terminate();
                }
            };
            worker.postMessage(index++); // start the worker.
        }

        for(var i = 0; i < maxWorkers; i++) runWorker(new Worker('genericWorker.js'));
    </script>
</body>
<html> 
```

# Now for some real world shtuff

Remember how I said I was using workers to implement 3rd party plugins into my code? These plugins have a state to keep track of. I could start the plugins and hope they don't load too many for the application to crash, *or* I could keep track of the plugin state within my main thread and send that state back to the plugin if the plugin needs to be reloaded. I like the second one better.

I had written out several more examples of stateful, stateless, and state-restore workers, but I'll spare you the agony and just do some brief explaining and some shorter snippets.

First-off, a simple stateful worker looks like this:

*StatefulWorker.js*

```
var i = 0;

self.onmessage = function(e) {
    switch(e.data) {
        case 'increment':
            self.postMessage(++i);
            break;
        case 'decrement':
            self.postMessage(--i);
            break;
    }
}; 
```

It does some action based on the message it receives and holds data internally. This is great. It allows for mah plugin devs to have full control over their plugins. The main app instantiates their plugin once, then will send messages for them to do some action.

The problem comes in when we want to load several plugins at once. We can't do that, so *what can we do?*

Let's think about a few solutions.

## Solution 1 (Stateless)

Let's make these plugins stateless. Essentially, every time we want to have the plugin do something, our application should instantiate the plugin then send it data based on its old state.

*data sent*

```
{
    action: 'increment',
    value: 7
} 
```

*StatelessWorker.js*

```
self.onmessage = function(e) {
    switch(e.data.action) {
        case 'increment':
            e.data.value++;
            break;
        case 'decrement':
            e.data.value--;
            break;
    }
    self.postMessage({
        value: e.data.value,
        i: e.data.i
    });
}; 
```

This could work, but if we're dealing with a good amount of data this will start to seem like a less-than-perfect solution. Another similar solution could be to have several smaller workers for each plugin and sending only a small amount of data to and from each, but I'm uneasy with that too.

## Solution 2 (State Restore)

What if we try to keep the worker in memory as long as possible, but if we do lose it, we can restore its state? We can use some sort of scheduler to see what plugins the user has been using (and maybe some fancy algorithms to guess what the user will use in the future) and keep those in memory.

The cool part about this is that we aren't looking at one worker per core anymore. Since most of the time the worker is active will be idle, we just need to worry about the memory it takes up. For a good number of workers (10 to 20 or so), this won't be substantial at all. We can keep the primary plugins loaded while the ones not used as often get switched out as needed. *All* the plugins will still need some sort of state restore.

Let's use the following worker and assume we either send 'increment', 'decrement', or an integer containing the state it's supposed to be at.

*StateRestoreWorker.js*

```
var i = 0;

self.onmessage = function(e) {
    switch(e.data) {
        case 'increment':
            self.postMessage(++i);
            break;
        case 'decrement':
            self.postMessage(--i);
            break;
        default:
            i = e.data;
    }
}; 
```

These are all pretty simple examples, but I hope I helped understand methods of using multiple workers efficiently! I'll most likely be writing a scheduler and optimizer for this stuff, but who knows when I'll get to that point.

Good luck, and happy coding!

* * *

## 回答 #2

> 赞同：14
> 
> 时间：2013-07-14T21:11:09.250

My experience is that too many workers (> 100) decrease the performance. In my case FF became very slow and Chrome even crashed. I compared variants with different amounts of workers (1, 2, 4, 8, 16, 32). The worker performed an encryption of a string. It turned out that 8 was the optimal amount of workers, but that may differ, depending on the problem the worker has to solve.

I built up a small framework to abstract from the amount of workers. Calls to the workers are created as tasks. If the maximum allowed number of workers is busy, a new task is queued and executed later.

It turned out that it's very important to recycle the workers in such an approach. You should hold them in a pool when they are idle, but don't call new Worker(...) too often. Even if the workers are terminated by worker.terminate() it seems that there is a big difference in the performance between creating/terminating and recycling of workers.

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2015-09-03T02:45:21.157

老问题，但在搜索时出现，所以...... Firefox 中有一个可配置的限制。如果您查看`about:config`（在 FF 的地址栏中输入地址）并搜索“worker”，您将看到几个设置，包括以下设置：

```
dom.workers.maxPerDomain 
```

默认设置为`20`。双击该行并更改设置。您将需要重新启动浏览器。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-05-19T14:38:25.253

您在解决方案#1 中链接您的 Worker 的方式会弹劾垃圾收集器以终止 Worker 实例，因为您在 onmessage 回调函数的范围内仍然有对它们的引用。

试试这段代码：

```
<script type="text/javascript">
var worker;
$(document).ready(function(){
    createWorker(0);
});
function createWorker(i) {
   worker = new Worker('test.worker.js');
   worker.onmessage = handleMessage;
   worker.postMessage(i); // start the worker.
}
function handleMessage(event) {
       var index = event.data;
       $("#debug").append('worker.onmessage i = ' + index + "<br>");

        if ( index < 25) {
            index++;
            createWorker(index);
        } 
    };
</script>
</head>
<body>
<div id="debug"></div> 
```

# c# - 自定义存储库和工作单元的实现

> ID：13574159
> 
> 赞同：1
> 
> 时间：2012-11-26T22:21:35.080
> 
> 标签：c#, entity-framework, c#-4.0, repository-pattern, unit-of-work

在我的 ASP.NET MVC 4 项目中，我仔细遵循了实现存储库和工作单元的示例中的设计原则。

[http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net- mvc-应用程序](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)

我对文章中的这句话特别感兴趣，是在展示了通用存储库之后写的：

> 这个通用存储库将处理典型的 CRUD 需求。当特定实体类型有特殊要求时，例如更复杂的过滤或排序，您可以创建一个派生类，该类具有该类型的其他方法。

由于我的应用程序符合这种特殊情况，因此我尝试这样做。我做了一个 GenericRepository 就像文章中的一样，还有一个 SharedContext 类（SharedContext 正是文章中的 UnitOfWork 类，但这个名字对我来说更有意义）

通用存储库：

```
using System;
using System.Collections.Generic;
using System.Data;
using System.Data.Entity;
using System.Linq;
using System.Linq.Expressions;
using System.Text;

namespace BusinessLogicLayer.Repositories
{
public class GenericRepository<T> where T: class
{
    internal DbSet<T> _dbSet;
    internal DBConnection _context;

    #region constructors

    public GenericRepository(SharedContext ctx)
    {
        _context = ctx.Context;
    }

    public GenericRepository(DBConnection context)
    {
        _context = context;
        _dbSet = context.Set<T>();
    }
    #endregion

}
} 
```

SharedContext（工作单元）类：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace BusinessLogicLayer.Repositories
{
public class SharedContext : IDisposable
{
    #region repositories
    private GenericRepository<Entities.Customer> _customerRepository;
    /// <summary>
    /// access the Customer entity
    /// </summary>
    public GenericRepository<Entities.Customer> CustomerRepository
    {
        get 
        {
            if (_customerRepository == null)
                _customerRepository = new GenericRepository<Entities.Customer>(_context);

            return _customerRepository;
        }
    }
    #endregion

    #region context management 

    private Entities.DBConnection _context = new Entities.DBConnection();
    internal Entities.DBConnection Context { get { return _context; } }
    //other methods - save, delete
    #endregion
}
} 
```

现在问题来了：注意我是如何暴露上面的 Context 属性的——我怀疑这实际上是有意的，我觉得我这样做是在打破这种模式。我非常喜欢在相同的上下文中通过存储库控制一切的想法，但是我需要一些通用存储库不提供的其他方法 - 所以我创建了一个单独的 CustomerRepository：

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Web.Mvc;

namespace BusinessLogicLayer.Repositories 
{
public class CustomerRepository: GenericRepository<Entities.Customer>
{
    public CustomerRepository(SharedContext ctx)
        : base(ctx)
    {  }

    public decimal GetCustomerBonusByFrequency()
    {
        //

    }
}
} 
```

...在我的控制器类中，我这样使用：

```
private SharedContext ctx = new SharedContext();

public PartialViewResult CustomerBonus()
{
   CustomerRepository cRepo = new CustomerRepository(ctx);
   var bonus = cRepo.GetCustomerBonusByFrequency();
   return PartialView(bonus);
} 
```

所以我的两个问题是：

*   项目清单

    这是文章中提到的添加额外功能的预期方式吗？我指的是 CustomRepository 类，这对我来说感觉像是一种模式的破坏，因为已经有一种方法可以通过 GenericRepository（我不再使用）获取客户，而且我正在公开上下文。

*   如果这很糟糕，那么我应该如何正确地做到这一点？我只需要为我的客户实体提供额外的方法，但要以尊重模式的方式。

谢谢，

编辑：

我需要在 SharedContext 中公开 Context 属性，因为如果我删除 GenericRepository 中的构造函数（它需要一个 SharedContext）和 CustomerRepository 类中的 :base(ctx) ，我会得到：

> BusinessLogicLayer.DBModel.Customer 不包含采用 0 个参数的构造函数

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:22:59.157

创建一个专门的客户存储库是正确的做法。我建议`SharedContext`应该更新您的类，以便该`CustomerRepository`属性返回该类的实例`CustomerRepository`，而不是`GenericRepository<Cutomer>`.

这样，当您从 访问`CustomerRepository`属性时`SharedContext`，您将拥有通用存储库的方法以及您的`CustomerRepository`类的专用方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T11:23:41.833

```
using System;
using System.Linq;
using System.Linq.Expressions;
using System.Data.Entity;
using System.Collections.Generic;
using System.Data;

namespace Demo.DAL
{
    public class Repository<TObject>

        where TObject : class
    {
        protected DB Context;
        protected DB Context = null;
        private bool shareContext = false;

        public Repository()
        {
            Context = new DB();
        }

        public Repository(DB context)
        {
            Context = context;
            shareContext = true;
        }

        protected DbSet<TObject> DbSet
        {
            get
            {
                return Context.Set<TObject>();
            }
        }

        public void Dispose()
        {
            if (shareContext && (Context != null))
                Context.Dispose();
        }

        public virtual IQueryable<TObject> All()
        {
            return DbSet.AsQueryable();
        }

        public virtual IQueryable<TObject> 
        Filter(Expression<Func<TObject, bool>> predicate)
        {
            return DbSet.Where(predicate).AsQueryable<TObject>();
        }

        public virtual IQueryable<TObject> Filter(Expression<Func<TObject, bool>> filter,
         out int total, int index = 0, int size = 50)
        {
            int skipCount = index * size;
            var _resetSet = filter != null ? DbSet.Where(filter).AsQueryable() : 
                DbSet.AsQueryable();
            _resetSet = skipCount == 0 ? _resetSet.Take(size) : 
                _resetSet.Skip(skipCount).Take(size);
            total = _resetSet.Count();
            return _resetSet.AsQueryable();
        }

        public bool Contains(Expression<Func<TObject, bool>> predicate)
        {
            return DbSet.Count(predicate) > 0;
        }

        public virtual TObject Find(params object[] keys)
        {
            return DbSet.Find(keys);
        }

        public virtual TObject Find(Expression<Func<TObject, bool>> predicate)
        {
            return DbSet.FirstOrDefault(predicate);
        }

        public virtual TObject Create(TObject TObject)
        {
            var newEntry = DbSet.Add(TObject);
            if (!shareContext)
                Context.SaveChanges();
            return newEntry;
        }

        public virtual int Count
        {
            get
            {
                return DbSet.Count();
            }
        }

        public virtual int Delete(TObject TObject)
        {
            DbSet.Remove(TObject);
            if (!shareContext)
                return Context.SaveChanges();
            return 0;
        }

        public virtual int Update(TObject TObject)
        {
            var entry = Context.Entry(TObject);
            DbSet.Attach(TObject);
            entry.State = EntityState.Modified;
            if (!shareContext)
                return Context.SaveChanges();
            return 0;
        }

        public virtual int Delete(Expression<Func<TObject, bool>> predicate)
        {
            var objects = Filter(predicate);
            foreach (var obj in objects)
                DbSet.Remove(obj);
            if (!shareContext)
                return Context.SaveChanges();
            return 0;
        }
    }
} 
```

# javascript - 意外的标识符：jQuery

> ID：13574163
> 
> 赞同：0
> 
> 时间：2012-11-26T22:21:46.863
> 
> 标签：javascript, jquery

此 for 循环产生错误：意外的标识符，为什么？

```
$(document).ready(function(){
    $('#done').click(function(e){

       var id = [];
       id = $('.crewMember');
       for(var i=0, i<id.length, i++){
            console.log(id[i]);
       }

    });
}); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T22:23:17.057

您需要在循环语法中使用分号 ( `;`) 而不是逗号 ( )：`,``for`

```
for (var i=0; i<id.length; i++){ 
```

意外的标识符是因为它期望声明/分配多个变量，但是您正在进行逻辑比较和递增。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:24:50.847

您需要用分号而不是逗号分隔[for 循环的初始化、条件和最终表达式：](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)

```
for (var i=0; i<id.length; i++) 
```

逗号用于分隔[多个变量声明](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var)，因此这里的解析器期望`=`标识符后面有一个`i`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:25:30.443

您在 for 循环中使用逗号`,`而不是分号。`;`

# r - 如果通常的“t()”不起作用，如何在 r 中转置矩阵？

> ID：13574165
> 
> 赞同：7
> 
> 时间：2012-11-26T22:21:57.253
> 
> 标签：r, matrix, transpose

我有一个矩阵，我试图在 R 中转置，但 t() 函数没有返回正确的答案。如何转置矩阵？

```
> xx=matrix(c(3,7,4,8),2,byrow=TRUE)
> xx
     [,1]  [,2]
[1,]    3     7
[2,]    4     8
> t(xx)
[1] 0.7071068 0.7071068 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-11-26T22:30:22.217

**这个答案是不正确的，但在某种程度上对我有启发，可能对其他人也有启发，所以我就不说了。**

正如@mnel 所指出的，基本的 R 函数`t()`必须被另一个同名的函数屏蔽。尝试删除该功能`t()`并`t(xx)`再次执行。我保证你会得到正确的结果。

当你运行这个时你会得到什么：

```
rm(t)
t(xx) 
```

如果（尽管我保证！）它仍然不起作用，您可以完全指定`t()`要使用的版本，如下所示：

```
base::t(xx) 
```

* * *

**这就是为什么上面的两个建议是不够​​的**

来自`?UseMethod`：

> 命名空间可以为泛型函数注册方法。为了支持这一点，“UseMethod”和“NextMethod”在两个地方搜索方法： **首先在调用泛型函数的环境中**，然后在定义泛型的环境的注册数据库中（通常是命名空间）。因此，泛型函数的方法需要在调用泛型的环境中可用，或者必须注册。（它们在定义泛型的环境中是否可见并不重要。）

我错误地认为 S3 方法分派会`t.default()` *先*查找方法， `base:::.__S3MethodsTable__.`然后*再*查找调用环境，`asNamespace("base")`*而*反过来则更接近事实。

* * *

**从 GSee 编辑**

这是一个交互式会话来演示可能是什么问题。

```
> t <- function(x, ...) print("generic masked")
> t.default <- function(x, ...) print("t.default masked")
> t.matrix <- function(x, ...) print("t.matrix was used")
> t.numeric <- function(x, ...) print("t.numeric was used")
> xx=matrix(c(3,7,4,8),2,byrow=TRUE)
> t(xx)
[1] "generic masked"
> base::t(xx)
[1] "t.matrix was used"
> rm(t.matrix)
> base::t(xx)
[1] "t.numeric was used"
> rm(t.numeric)
> base::t(xx)
[1] "t.default masked"
> rm(t.default)
> base::t(xx)
     [,1] [,2]
[1,]    3    4
[2,]    7    8 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-11-19T19:02:51.197

也许您可以编写自己的函数：

```
xx <- matrix(c(3,7,4,8), 2, byrow = TRUE)
transp <- function(n){
    TM <- matrix(, nrow = ncol(n), ncol = nrow(n))
        for (i in 1 : nrow(TM)){
            for (j in 1 : ncol(TM)){
                TM[i, j] <- n[j, i]
            }
        }
    print(TM)
} 
transp(xx) 
```

# php - phpmailer 发送 gmail smtp 超时

> ID：13574166
> 
> 赞同：6
> 
> 时间：2012-11-26T22:22:01.053
> 
> 标签：php, smtp, phpmailer

> **可能重复：**
> [PHPMailer 遇到问题](https://stackoverflow.com/questions/13344239/having-trouble-with-phpmailer)

有很多类似的问题，但没有一个对我有帮助。

这是我在 phpmailer exmaples 中提供的脚本：

```
require_once('../class.phpmailer.php');
//include("class.smtp.php"); // optional, gets called from within class.phpmailer.php if not already loaded

$mail = new PHPMailer(true); // the true param means it will throw exceptions on errors, which we need to catch

$mail->IsSMTP(); // telling the class to use SMTP

try {
  $mail->SMTPDebug  = 2;                     // enables SMTP debug information (for testing)
  $mail->SMTPAuth   = true;                  // enable SMTP authentication
  $mail->SMTPSecure = "ssl";                 // sets the prefix to the servier
  $mail->Host       = "smtp.gmail.com";      // sets GMAIL as the SMTP server
  $mail->Port       = 465;                   // set the SMTP port for the GMAIL server
  $mail->Username   = "yourusername@gmail.com";  // GMAIL username
  $mail->Password   = "yourpassword";            // GMAIL password
  $mail->AddReplyTo('name@yourdomain.com', 'First Last');
  $mail->AddAddress('whoto@otherdomain.com', 'John Doe');
  $mail->SetFrom('name@yourdomain.com', 'First Last');
  $mail->AddReplyTo('name@yourdomain.com', 'First Last');
  $mail->Subject = 'PHPMailer Test Subject via mail(), advanced';
  $mail->AltBody = 'To view the message, please use an HTML compatible email viewer!'; // optional - MsgHTML will create an alternate automatically
  $mail->MsgHTML("some message");
  $mail->Send();
  echo "Message Sent OK</p>\n";
} catch (phpmailerException $e) {
  echo $e->errorMessage(); //Pretty error messages from PHPMailer
} catch (Exception $e) {
  echo $e->getMessage(); //Boring error messages from anything else!
} 
```

这是错误：

```
SMTP -> ERROR: Failed to connect to server: Connection timed out (110) 
SMTP Error: Could not connect to SMTP host. 
```

在许多问题中都提到了`php_openssl extenstion`在我的服务器中启用的启用。我正在使用 PHPmailer 5.1 版

我的服务器端口 25 也没有问题，简单的`mail()`功能也可以正常工作

谢谢你的帮助

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-26T22:30:59.490

这是一个工作示例：

```
 require_once ( 'class.phpmailer.php' ); // Add the path as appropriate
  $Mail = new PHPMailer();
  $Mail->IsSMTP(); // Use SMTP
  $Mail->Host        = "smtp.gmail.com"; // Sets SMTP server
  $Mail->SMTPDebug   = 2; // 2 to enable SMTP debug information
  $Mail->SMTPAuth    = TRUE; // enable SMTP authentication
  $Mail->SMTPSecure  = "tls"; //Secure conection
  $Mail->Port        = 587; // set the SMTP port
  $Mail->Username    = 'MyGmail@gmail.com'; // SMTP account username
  $Mail->Password    = 'MyGmailPassword'; // SMTP account password
  $Mail->Priority    = 1; // Highest priority - Email priority (1 = High, 3 = Normal, 5 = low)
  $Mail->CharSet     = 'UTF-8';
  $Mail->Encoding    = '8bit';
  $Mail->Subject     = 'Test Email Using Gmail';
  $Mail->ContentType = 'text/html; charset=utf-8\r\n';
  $Mail->From        = 'MyGmail@gmail.com';
  $Mail->FromName    = 'GMail Test';
  $Mail->WordWrap    = 900; // RFC 2822 Compliant for Max 998 characters per line

  $Mail->AddAddress( $ToEmail ); // To:
  $Mail->isHTML( TRUE );
  $Mail->Body    = $MessageHTML;
  $Mail->AltBody = $MessageTEXT;
  $Mail->Send();
  $Mail->SmtpClose();

  if ( $Mail->IsError() ) { 
    echo "ERROR<br /><br />";
  }
  else {
    echo "OK<br /><br />";
  } 
```

# php - PHP PDO 多次获取相同的结果

> ID：13574167
> 
> 赞同：0
> 
> 时间：2012-11-26T22:22:03.910
> 
> 标签：php, pdo

出于某种原因，当我尝试从我的数据库中获取数据时，它会多次返回我的数据。

```
$base = "mysql:host=" . $config["database"]["host"] . ";port=" . $config["database"]["port"]  . ";dbname=" . $config["database"]["name"];
$conn = new PDO($base, $config["database"]["user"], $config["database"]["pass"]);

$query = $conn->query("SELECT setting, value FROM main");

if(!$query->rowCount()){
    echo "An error occured while trying to load some important information. Please check your database credentials and data and try again.";
}
else{
    $result = $query->fetchAll(PDO::FETCH_COLUMN|PDO::FETCH_GROUP);

    var_dump($result);
} 
```

例如，假设我的表中有以下数据：

```
setting  |  value
------------------
one      |  1
------------------
two      |  2
------------------ 
```

调用函数 var_dump() 将打印出：

```
array(2) {
    ["one"]=> array(1) {
        [0]=> string(56) "1"
  }
  ["two"]=> array(1) {
      [0]=> string(24) "2"
  }
}
array(2) {
    ["one"]=> array(1) {
        [0]=> string(56) "1"
  }
  ["two"]=> array(1) {
      [0]=> string(24) "2"
  }
}
array(2) {
    ["one"]=> array(1) {
        [0]=> string(56) "1"
  }
  ["two"]=> array(1) {
      [0]=> string(24) "2"
  }
}
array(2) {
    ["one"]=> array(1) {
        [0]=> string(56) "1"
  }
  ["two"]=> array(1) {
      [0]=> string(24) "2"
  }
} 
```

有人知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:26:06.667

看起来`var_dump`被执行了多次。

有些东西不止一次地调用它。

我认为这不是执行的代码。

作为

```
strlen('1') !== 56 
```

# android - Android Power 建模像电源导师

> ID：13574168
> 
> 赞同：0
> 
> 时间：2012-11-26T22:22:10.463
> 
> 标签：android

我一直在努力追随那些制作[强力导师](http://powertutor.org/)的人所做的事情。据我了解，所使用的方法是硬件特定的，而不是软件的。他们根据 CPU 利用率、wifi、GPS、音频和 3G 对功耗进行了建模。根据[这篇](http://powertutor.org/camera-ready.pdf)论文。有人熟悉这种方法吗？我想知道我是否可以为任何 android 设备建模，还是依赖于硬件的方法？以及他们在论文中使用的功率建模公式。他们试图为 CPU 利用率、wifi、GPS、音频和 3G 提取哪些软件参数，以使公式或方法有效？看论文不是很清楚。在这方面的任何帮助都将受到高度评价。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-05T15:32:33.817

PowerTutor 方法在很大程度上独立于硬件，但需要针对每个新设备进行专门定制。它主要通过 /proc 和 /sys 目录来依赖硬件系统参数的可用性。例如，通过 /proc/stat 和 /proc/cpuinfo 读取 CPU 利用率，从 /data/misc/gps.status 读取 GPS 数据，从 /sys/devices/virtual/leds/lcd-backlight/brightness 读取 LCD 数据等。将这些系统参数代入模型方程以估算功耗。实际方程可以在[他们的论文](http://robertdick.org/publications/zhang10oct.pdf)的第四页找到，系统参数位置可以在[源代码](https://github.com/msg555/PowerTutor)中看到（特别是在 tree/master/src/edu/umich/PowerTutor/components 下）。

假设相同的系统参数可用，要使 PowerTutor 为新设备工作，您必须确定特定设备的系数并使用新设备及其系数更新应用程序。问题是 PowerTutor 模型使用由相关的 PowerBooter 工具确定的系数，该工具不公开。有一些关于 PowerBooter 如何获取系数的描述，但您必须自己重新实现测试。

# jquery - jQuery wordpress 插件冲突

> ID：13574173
> 
> 赞同：0
> 
> 时间：2012-11-26T22:22:34.960
> 
> 标签：jquery, plugins, conflict

我正在使用一个 wp 主题和一个名为 wpml 的插件。我不是 jQuery 专家，但据我所知，它存在问题。我从stackoverflow中找到了一些帖子并尝试了他们所说的，至少我现在知道问题所在。

```
TypeError: jQuery(".datepicker").datepicker is not a function 
```

[打破这个错误]

jQuery('.datepicker').datepicker();

这是我从 firebugs 的控制台选项卡中得到的错误 :( 当我禁用 wpml 插件时，一切正常，但不幸的是我付了钱。有人能给我一个想法吗？我一直在评论代码，每次尝试时 UI 都会变得更有趣:) 但无法解决真正的问题。

[http://goo.gl/dFplb](http://goo.gl/dFplb)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:47:04.480

在您包含插件链接之前，我会尝试包含[datepicker 。](http://jqueryui.com/datepicker/ "日期选择器")datepicker 很可能是您的插件未提及的要求。

问题是代码不知道任何名为 的函数`datepicker`，它应该在上面的 datepicker 插件中定义。

要进行测试，日期选择器应包含在此处托管的 jQueryUI 包中：http: [//ajax.googleapis.com/ajax/libs/jqueryui/1.8.22/jquery-ui.js](http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.22/jquery-ui.js)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:04:20.233

我看到您的页面上加载了 2 个 jQuery 实例。似乎 wpml 插件没有使用`dependencies`wordpress 中的参数`wp_enqueue_script`。您需要在您的`<script type="text/javascript" src="http://otel.gratastest.com/wp-includes/js/jquery/jquery.js?ver=1.7.2"></script>`wpml 插件代码中移除对此的负载。你需要找到它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-05-23T23:26:36.063

您还可以通过使用控制台在 chrome 中使用**检查**来监视哪个插件正在创建问题。您不必禁用所有插件来一一检查，这将消耗更多时间。

# perl - 使用带有 html 正文部分的 perl 邮件/发件人发送电子邮件

> ID：13574177
> 
> 赞同：1
> 
> 时间：2012-11-26T22:22:52.477
> 
> 标签：perl, mail-sender

我是 Perl 的新手，我正在尝试使用[Mail::Sender](https://metacpan.org/module/Mail%3a%3aSender)模块在正文部分使用 HTML 发送电子邮件。我`debug => 'x.log'`用来分析邮件发送过程。

看起来 Perl 奇怪地在我的 HTML 代码中的每个 '=' 符号后面加上 3D 和 20 （看起来像 HTML 的 URL 代码）。在此之后，客户没有收到任何电子邮件。这里可能有什么问题？（例如`border="5"`变成`border=3D"5"`）

我`$sender->SendEnc($BODY);`用来发送消息和`$sender->Open({to => "$userAtFaultEmail", subject => "$email_subject", ctype => "text/html", encoding => "quoted-printable"'});`打开邮件连接。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:57:56.027

这是完全自然的。在*quoted-printable* -encoding 中，等号`=`是转义字符，所以它必须自己转义。在转义字符之后，给出字符的十六进制数。邮件客户端将正确解码。如果您不喜欢这个，您可以更改编码，例如更改为 UTF-8。但是，这并不常见，并且可能会在旧客户端上产生新问题。

这是关于[quoted-printable](https://en.wikipedia.org/wiki/Quoted-printable)的维基百科条目。这种编码的原因是对 8 位字符进行编码，而电子邮件传统上只传输 7 位 ASCII。

# c++ - 服务器到客户端通信架构

> ID：13574182
> 
> 赞同：4
> 
> 时间：2012-11-26T22:23:12.007
> 
> 标签：c++, architecture, client-server, mql4, metatrader4

我们有一个“交易复制”软件，顾名思义，该软件用于将一个交易者（发送者）的交易镜像到多个其他交易者（接收者）。它具有三个主要组成部分：

**1\. 发件人客户端。**

**2\. 服务器。**

**3.接收客户端。**

**发送者 -> 服务器 -> 接收者**

发送方是使用[MQL](http://docs.mql4.com/)脚本构建的。MQL 是一种使用 C++ 构建的交易者编程语言。由于有一个发送者，发送者代码将交易信息（或信号）推送到服务器。该服务器是基于 PHP 的，带有一个简单的 MySQL 数据库，管理员可以在其中维护向其转发此信号的用户。接收器也是使用 MQL 构建的。但是目前它是使用一种独特的技术构建的，为了清楚起见，我们不确定它，因为我们是第一次接触代码，而原始程序员却无处可寻（正如预期的那样）。回到这个问题，接收客户端有一段代码似乎在“轮询”服务器以获取任何更新。MQL 使用 C++ 库调用*InternetReadFile*函数，该函数使用*InternetOpenUrlA*. 现在，MQL 每 X 毫秒向服务器发送一个请求，以查看是否有新信号，如果找到则拉取它。如果提供 MQL 代码有帮助，我可以做到。

现在回答我的问题。

1.  这是一个好方法吗？如果接收用户增长数百并且每个用户每 X 毫秒“轮询”服务器（或使用 InternetReadFile 执行的任何操作）会发生什么情况。取决于X，它不会在某一时刻杀死服务器CPU吗？我认为这是作为拉取服务实现的，而我认为服务器应该推送此信息，而不是所有接收者客户端不断请求。

2.  如果上述问题的答案是“这是一种不好的方法”，那么最好的方法是什么？通过套接字通信将信号从服务器推送到每个接收器是一个好主意吗？接收器客户端是否会出现“端口转发”和“更改 IP”等问题？还是可以通过编程方式克服它们？

很高兴提供代码，进一步说明。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T17:41:25.273

任何民意调查都会引入延迟并产生额外的流量，这是您无法逃脱的。理想情况下，您希望使用以太直接解决方案：“套接字到套接字”或使用 zeromq 之类的异步推送（也通过套接字 btw，只是抽象的）。

问题是：当您在交易终端内奔跑时，是否值得付出努力。由于您要从终端到服务器再到终端，延迟已经是固有的。此外，您将因接收方的执行以及经纪人的执行速度而延迟。因此，最终，当市场发生变化时，您会看到原始和副本之间存在巨大差异，这违背了解决方案的目的。这个功能确实应该由代理提供并在服务器 api 插件或管理器 api 中实现（至少）。除了大多数经纪商的设置之外：延迟 + 点差 + 加价将吞噬您的客户如果希望通过复制“好”交易而获得的任何优势。

为了解决网络问题，由于您知道您的客户端正在运行 mt4，因此您还知道应该在客户端计算机上打开 443 出站，因为这是 mt4 使用的。您也可以相当确信 http(80) 也是开放的，特别是因为当前的解决方案使用 http 进行通信。因此，如果您将服务器主机设置在 443 或 80 上，并且您的发送方和接收方都作为客户端连接到您的服务器，则客户端 IP 和防火墙设置应该无关紧要。除此之外，您始终可以实现某种基于文件的配置，以便您可以在安装/故障排除期间调整客户端的端口。最后，无论您的轮询或异步网络问题是否相同，都归结为通过套接字的 tcp。

# ruby-on-rails - 从外部访问 WEBrick 服务器

> ID：13574186
> 
> 赞同：3
> 
> 时间：2012-11-26T22:23:36.913
> 
> 标签：ruby-on-rails, webrick

我希望能够从我家以外的机器访问我的开发服务器。
我尝试运行`rvmsudo rails server -p 80`，但是当我尝试使用我的 IP 访问我的计算机时，我进入了路由器的配置页面...

有任何想法吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2016-03-02T10:47:19.813

在这里测试，对我来说是这样的：

**-d** = 守护程序服务

**-b 0.0.0.0** = 启用外部访问

所以，命令是：

```
$ rails s -d -p 80 -b 0.0.0.0 
```

我希望这可以帮助你。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T02:34:21.723

我的猜测是您已经有一个服务（如 apache Web 服务器）在端口 80 上侦听。

您所要做的就是选择一个未占用的端口并将服务绑定到它。

```
rails s -d -p PORT_NUMBER 
```

然后您必须为该端口设置端口转发。

最后但同样重要的是，如果您有一个动态的（随时间变化的）IP 地址（最常见的），您必须始终知道您当前的 IP。(http://whatismyip.com)

然后你可以像这样连接到你的网络应用程序

```
http://CURRENT_IP_ADDRESS:PORT_NUMBER 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:25:36.380

你在路由器上设置端口转发了吗？您的路由器的品牌和型号是什么？

请参阅那里的答案以获得更多帮助：

*   [设置 Webrick 以连接到我的 rails 应用程序](https://stackoverflow.com/questions/10220621/setting-up-the-webrick-to-serve-to-internet-my-rails-app)

*   [不能对我的 webrick 服务器进行端口转发以从网络访问它！](https://stackoverflow.com/questions/2497869/cant-do-port-forwarding-ro-my-webrick-server-to-access-it-from-the-net)

# vb.net - 解析大 XML 文件并将数据插入到 vb 中的 SQL 服务器

> ID：13574187
> 
> 赞同：0
> 
> 时间：2012-11-26T22:23:43.170
> 
> 标签：vb.net

我需要解析一个 XML 文件并将数据存储到 vb.net 中的 sql server 中。我一直在网上阅读，看来我应该使用 xmltextReader 类来读取文件，因为这将消除内存不足的问题。我开始了类似以下的事情。我需要反馈我做得好还是应该使用其他更容易的方法。示例 XML 文件如下所示

```
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<MainElement>
    <MainEle1>
        <InfoA>
            <InfoAId>121480431A</InfoAId>
            <firstName>Anne</firstName>
            <lastName>Stevens</lastName>
            <phone>6023122456</phone>
            <address>
                <address1>8735 Elm Road</address1>
                <address2></address2>
                <city>Nowhere</city>
                <country></country>
                <state>CA</state>
                <suite></suite>
                <zipCode>30141</zipCode>
            </address>
            <dob>09/08/1982</dob>
            <gender></gender>
            <primaryLanguage>Other</primaryLanguage>
            <otherLanguage>french</otherLanguage>
            <planName></planName>
            <contacts>
                <firstName>rajesh</firstName>
                <lastName>raj</lastName>
                <phone>1232343241</phone>
                <address>
                    <address1></address1>
                    <address2></address2>
                    <city></city>
                    <country></country>
                    <state></state>
                    <suite></suite>
                    <zipCode></zipCode>
                </address>
                <contactType>EMERGENCY</contactType>
                <relationship>friend</relationship>
                <typeDesc>Emergency Contact/Next of Kin</typeDesc>
            </contacts>
         </InfoA>
    </MainEle1>
    <MainEle2>
        <subMainEle2>
            <firstName>victor</firstName>
            <lastName>john</lastName>
            <phone>1233455678</phone>
            <address>
                <address1>123 arrow</address1>
                <address2></address2>
                <city>upland</city>
                <country></country>
                <state>ca</state>
                <suite>234</suite>
                <zipCode>76547</zipCode>
            </address>
            <contactType>PRIMARY</contactType>
            <relationship></relationship>
            <typeDesc></typeDesc>
        </subMainEle2>
    </MainEle2>
    <MainEle3>
    ..
    </MailEle3>
    <MainEle4>
    ..
    </MailEle4>
    ..
</MainElement>

Dim reader As XmlTextReader
reader = New XmlTextReader("c:\FileName")

While Not reader.EOF
    Select Case reader.NodeType
    Case XmlNodeType.Element 
        Select Case reader.Name
        Case "MainEle1"
            Call ProcessMainEle1(reader) ' passing reader as ref
        Case "MainEle2"
            call ProcessMainEle2(reader) ' passing reader as ref
        Case "MainEle3"
            call ProcessMainEle3(reader) 'passing reader as ref
                 ' and read many element
        End Select
    End Select
End While 
```

在 Process 方法中，我使用类似的方法并创建插入语句。这是正确的方法还是对于元素中包含许多元素的大文件有一种简单的方法。我会感谢新手程序员的指导

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:27:17.987

对于您的用例 使用不基于 DOM 的 XML 解析器很重要。(SAX解析器)

从内存消耗的角度来看，IT 中没有什么比基于 DOM 的 XML 解析器更糟糕的了。这样的解析器将需要比低级解析多 100 到 1000 倍的内存，这对您来说工作量更大。

# java - 在 Java 中解析 /proc/mounts

> ID：13574188
> 
> 赞同：0
> 
> 时间：2012-11-26T22:23:45.047
> 
> 标签：java, parsing, encoding

我正在尝试解析`cat /proc/mounts`在 Linux 环境中运行的结果。

当安装包含特殊字符（例如空格）时，它们会被转义。这方面的一个例子是

`/home/user/media\040/image.dd /media/dd ...` 其中 \040 实际上是一个空格。

我正在尝试在 java 中解析它，但不想编写手动解析器，因为我必须相信这已经完成并且比我做得更稳健。有没有负责解码的类？我找到了一两个八进制解码器，但它们不适用于混合文本和八进制。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T02:45:18.953

您可以在 C 中使用 getmntent 解析 /proc/mounts。

您可以根据规则在Java中实现它：

空格 (\040)、制表符 (\011)、换行符 (\012) 和反斜杠 (\134)

或 none 表示交换分区。

男人getmntent：

mntent结构定义如下：

```
 struct mntent {
           char *mnt_fsname;   /* name of mounted file system */
           char *mnt_dir;      /* file system path prefix */
           char *mnt_type;     /* mount type (see mntent.h) */
           char *mnt_opts;     /* mount options (see mntent.h) */
           int   mnt_freq;     /* dump frequency in days */
           int   mnt_passno;   /* pass number on parallel fsck */
       };

   Since  fields  in  the mtab and fstab files are separated by whitespace, octal escapes are
   used to represent the four characters space (\040), tab (\011), newline (\012)  and  back-
   slash  (\134) in those files when they occur in one of the four strings in a mntent struc-
   ture.  The routines addmntent() and getmntent() will convert from string representation to
   escaped representation and back. 
```

另一种方式：直接解析“mount”的结果。用“on”、“type”等来分割它们可能更简单。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-17T13:19:43.540

我最终使用了 Apache Commons Lang。

[http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/StringEscapeUtils.html#unescapeJava(java.lang.String)](http://commons.apache.org/proper/commons-lang/javadocs/api-3.1/org/apache/commons/lang3/StringEscapeUtils.html#unescapeJava(java.lang.String))

这似乎使一切都变得正确。

# python - QSTK 中的时间增量

> ID：13574199
> 
> 赞同：1
> 
> 时间：2012-11-26T22:24:23.357
> 
> 标签：python, qstk

我正在浏览 QSTK 并且在他们使用的教程中我很好奇`datetime.timedelta` 在股票相关环境中这样的命令的目的是什么。我找到了一些关于什么`timedelta`是的文章，但显然我没有掌握它，因为我不知道这意味着什么：

```
timeofday= datetime.timedelta(hours=16)
timestamps = du.getNYSEdays(startday,endday,timeofday) 
```

timedelta 作为 QSTK 或一般情况下的参数的目的是什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:34:33.953

timedelta 只是一个时间量。在这种情况下，“16 小时”。

它们很有用，因为它们可用于操作日期和时间。假设您有一个代表“2002 年 5 月 21 日上午 6 点”的日期时间对象。如果您将 timedelta 添加到该日期时间，您将获得“2002 年 5 月 21 日晚上 10 点”。

您还可以使用它们来比较日期时间对象。如果`todays_lunch`定义为“11/26/2012 at 12pm”并且`today's dinner`是“11/26/2012 at 6pm”，那么您可以执行以下操作：

```
>>>todays_dinner - todays_lunch < timeofday
True 
```

如果没有更多代码（或者可能只是比我对纽约证券交易所的了解更好），很难说出这个特殊案例在做什么。但这与以 16 小时间隔操作日期时间对象有关。

# zend-framework - Zend Framework 和 Authorize.net 集成

> ID：13574200
> 
> 赞同：1
> 
> 时间：2012-11-26T22:24:27.703
> 
> 标签：zend-framework, frameworks, integration, authorize.net

有没有人在这个主题上建立过任何东西？Authorize.Net 是使用最广泛的支付网关之一，因此我认为这种集成会有最佳实践和/或可靠资源。我无法从搜索中找到任何可靠的东西。非常感谢任何建议/资源/建议。“分享就是关怀”

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:36:46.873

Paypal 和 Authorize.net 的 API 非常简单。您实际上并不需要使用 Zend 特定的方法在 Zend 应用程序中设置它们。基于 Zend 构建的 Magento 有一个 Authorize.net 连接，你可以看一下。Opencart 是另一个具有 Authorize.net 插件的开源购物车。我看过了，它写得体面，易于理解。

编辑：这是来自 Opencart 的 Authorize.net AIM 课程（他们也有 SIM 版本）。您应该可以很容易地以此为基础制作自己的作品。

```
class ControllerPaymentAuthorizeNetAim extends Controller {
    protected function index() {
        $this->language->load('payment/authorizenet_aim');

        $this->data['text_credit_card'] = $this->language->get('text_credit_card');
        $this->data['text_wait'] = $this->language->get('text_wait');

        $this->data['entry_cc_owner'] = $this->language->get('entry_cc_owner');
        $this->data['entry_cc_number'] = $this->language->get('entry_cc_number');
        $this->data['entry_cc_expire_date'] = $this->language->get('entry_cc_expire_date');
        $this->data['entry_cc_cvv2'] = $this->language->get('entry_cc_cvv2');

        $this->data['button_confirm'] = $this->language->get('button_confirm');

        $this->data['months'] = array();

        for ($i = 1; $i <= 12; $i++) {
            $this->data['months'][] = array(
                'text'  => strftime('%B', mktime(0, 0, 0, $i, 1, 2000)), 
                'value' => sprintf('%02d', $i)
            );
        }

        $today = getdate();

        $this->data['year_expire'] = array();

        for ($i = $today['year']; $i < $today['year'] + 11; $i++) {
            $this->data['year_expire'][] = array(
                'text'  => strftime('%Y', mktime(0, 0, 0, 1, 1, $i)),
                'value' => strftime('%Y', mktime(0, 0, 0, 1, 1, $i)) 
            );
        }

        if (file_exists(DIR_TEMPLATE . $this->config->get('config_template') . '/template/payment/authorizenet_aim.tpl')) {
            $this->template = $this->config->get('config_template') . '/template/payment/authorizenet_aim.tpl';
        } else {
            $this->template = 'default/template/payment/authorizenet_aim.tpl';
        }   

        $this->render();        
    }

    public function send() {
        if ($this->config->get('authorizenet_aim_server') == 'live') {
            $url = 'https://secure.authorize.net/gateway/transact.dll';
        } elseif ($this->config->get('authorizenet_aim_server') == 'test') {
            $url = 'https://test.authorize.net/gateway/transact.dll';       
        }   

        //$url = 'https://secure.networkmerchants.com/gateway/transact.dll';    

        $this->load->model('checkout/order');

        $order_info = $this->model_checkout_order->getOrder($this->session->data['order_id']);

        $data = array();

        $data['x_login'] = $this->config->get('authorizenet_aim_login');
        $data['x_tran_key'] = $this->config->get('authorizenet_aim_key');
        $data['x_version'] = '3.1';
        $data['x_delim_data'] = 'true';
        $data['x_delim_char'] = ',';
        $data['x_encap_char'] = '"';
        $data['x_relay_response'] = 'false';
        $data['x_first_name'] = html_entity_decode($order_info['payment_firstname'], ENT_QUOTES, 'UTF-8');
        $data['x_last_name'] = html_entity_decode($order_info['payment_lastname'], ENT_QUOTES, 'UTF-8');
        $data['x_company'] = html_entity_decode($order_info['payment_company'], ENT_QUOTES, 'UTF-8');
        $data['x_address'] = html_entity_decode($order_info['payment_address_1'], ENT_QUOTES, 'UTF-8');
        $data['x_city'] = html_entity_decode($order_info['payment_city'], ENT_QUOTES, 'UTF-8');
        $data['x_state'] = html_entity_decode($order_info['payment_zone'], ENT_QUOTES, 'UTF-8');
        $data['x_zip'] = html_entity_decode($order_info['payment_postcode'], ENT_QUOTES, 'UTF-8');
        $data['x_country'] = html_entity_decode($order_info['payment_country'], ENT_QUOTES, 'UTF-8');
        $data['x_phone'] = $order_info['telephone'];
        $data['x_customer_ip'] = $this->request->server['REMOTE_ADDR'];
        $data['x_email'] = $order_info['email'];
        $data['x_description'] = html_entity_decode($this->config->get('config_name'), ENT_QUOTES, 'UTF-8');
        $data['x_amount'] = $this->currency->format($order_info['total'], $order_info['currency_code'], 1.00000, false);
        $data['x_currency_code'] = $this->currency->getCode();
        $data['x_method'] = 'CC';
        $data['x_type'] = ($this->config->get('authorizenet_aim_method') == 'capture') ? 'AUTH_CAPTURE' : 'AUTH_ONLY';
        $data['x_card_num'] = str_replace(' ', '', $this->request->post['cc_number']);
        $data['x_exp_date'] = $this->request->post['cc_expire_date_month'] . $this->request->post['cc_expire_date_year'];
        $data['x_card_code'] = $this->request->post['cc_cvv2'];
        $data['x_invoice_num'] = $this->session->data['order_id'];

        /* Customer Shipping Address Fields */
        $data['x_ship_to_first_name'] = html_entity_decode($order_info['shipping_firstname'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_last_name'] = html_entity_decode($order_info['shipping_lastname'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_company'] = html_entity_decode($order_info['shipping_company'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_address'] = html_entity_decode($order_info['shipping_address_1'], ENT_QUOTES, 'UTF-8') . ' ' . html_entity_decode($order_info['shipping_address_2'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_city'] = html_entity_decode($order_info['shipping_city'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_state'] = html_entity_decode($order_info['shipping_zone'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_zip'] = html_entity_decode($order_info['shipping_postcode'], ENT_QUOTES, 'UTF-8');
        $data['x_ship_to_country'] = html_entity_decode($order_info['shipping_country'], ENT_QUOTES, 'UTF-8');

        if ($this->config->get('authorizenet_aim_mode') == 'test') {
            $data['x_test_request'] = 'true';
        }   

        $curl = curl_init($url);

        curl_setopt($curl, CURLOPT_PORT, 443);
        curl_setopt($curl, CURLOPT_HEADER, 0);
        curl_setopt($curl, CURLOPT_SSL_VERIFYPEER, 0);
        curl_setopt($curl, CURLOPT_RETURNTRANSFER, 1);
        curl_setopt($curl, CURLOPT_FORBID_REUSE, 1);
        curl_setopt($curl, CURLOPT_FRESH_CONNECT, 1);
        curl_setopt($curl, CURLOPT_POST, 1);
        curl_setopt($curl, CURLOPT_CONNECTTIMEOUT, 10);
        curl_setopt($curl, CURLOPT_TIMEOUT, 10);
        curl_setopt($curl, CURLOPT_POSTFIELDS, http_build_query($data, '', '&'));

        $response = curl_exec($curl);

        $json = array();

        if (curl_error($curl)) {
            $json['error'] = 'CURL ERROR: ' . curl_errno($curl) . '::' . curl_error($curl);

            $this->log->write('AUTHNET AIM CURL ERROR: ' . curl_errno($curl) . '::' . curl_error($curl));   
        } elseif ($response) {
            $i = 1;

            $response_info = array();

            $results = explode(',', $response);

            foreach ($results as $result) {
                $response_info[$i] = trim($result, '"');

                $i++;
            }

            if ($response_info[1] == '1') {
                if (strtoupper($response_info[38]) == strtoupper(md5($this->config->get('authorizenet_aim_hash') . $response_info[6] . $this->currency->format($order_info['total'], $order_info['currency_code'], 1.00000, false)))) {
                    $this->model_checkout_order->confirm($this->session->data['order_id'], $this->config->get('config_order_status_id'));

                    $message = '';

                    if (isset($response_info['5'])) {
                        $message .= 'Authorization Code: ' . $response_info['5'] . "\n";
                    }

                    if (isset($response_info['6'])) {
                        $message .= 'AVS Response: ' . $response_info['6'] . "\n";
                    }

                    if (isset($response_info['7'])) {
                        $message .= 'Transaction ID: ' . $response_info['7'] . "\n";
                    }

                    if (isset($response_info['39'])) {
                        $message .= 'Card Code Response: ' . $response_info['39'] . "\n";
                    }

                    if (isset($response_info['40'])) {
                        $message .= 'Cardholder Authentication Verification Response: ' . $response_info['40'] . "\n";
                    }               

                    $this->model_checkout_order->update($this->session->data['order_id'], $this->config->get('authorizenet_aim_order_status_id'), $message, false);             
                }

                $json['success'] = $this->url->link('checkout/success', '', 'SSL');
            } else {
                $json['error'] = $response_info[4];
            }
        } else {
            $json['error'] = 'Empty Gateway Response';

            $this->log->write('AUTHNET AIM CURL ERROR: Empty Gateway Response');
        }

        curl_close($curl);

        $this->response->setOutput(json_encode($json));
    }
} 
```

# java - 如果其他代码，为什么在删除非空目录时会得到“无返回语句”？

> ID：13574203
> 
> 赞同：-5
> 
> 时间：2012-11-26T22:24:36.617
> 
> 标签：java, return, unreachable-statement

我正在使用Java！我用两个“Ö”标记的部分出现“无返回语句”错误，而在我用“// <----ÄÄÄ”标记的部分出现“无法访问的语句”错误。这部分代码应该删除一个包含文件的目录/文件夹，并且它本身就可以工作。但我似乎无法让它与我的其余代码一起使用！帮助将不胜感激！

通常，这是一个检查目录大小、删除目录及其内容并创建具有相同名称的新目录的程序。

```
$package delete.file.or.dir;

import java.io.*;
import javax.swing.JDialog;
import javax.swing.JFrame;
import javax.swing.JOptionPane;

public class DeleteFileOrDir{

public static void main (String [] args){

// The directory in question

    File file = new File("C://123");

     long fileSize = file.length();

 System.out.println("File size in bytes is: " + fileSize);
 System.out.println("File size in KB is : " + (double)fileSize/1024);
 System.out.println("File size in MB is :" + (double)fileSize/(1024*1024));

  //Bad yes no statement

 JOptionPane pane = new JOptionPane(
    "Y=Yes\nN=No");
Object[] options = new String[] { "Y", "N" };
pane.setOptions(options);
JDialog dialog = pane.createDialog(new JFrame(), "Dilaog");
dialog.show();
Object obj = pane.getValue(); 
int result = -1;
for (int k = 0; k < options.length; k++)
  if (options[k].equals(obj))
    result = k;
System.out.println("User's choice: " + result);

 //Delete Directory with files

    deleteDirectory(new File("C://123"));
}

    //The first line of text just below is the first problem Ö

static public boolean deleteDirectory(File path) {
if( path.exists() ) {
  File[] files = path.listFiles();
  for(int i=0; i<files.length; i++) {
     if(files[i].isDirectory()) {
       deleteDirectory(files[i]);
     }
     else {
       files[i].delete();
     }
  }
}
return( path.delete() );

    File dir= new File("C://123");           // This gives me "unreachable statament Ä"

    boolean isDirectoryCreated = dir.mkdir();

    if(isDirectoryCreated)
        System.out.println("Reset");
    else
        System.out.println("Error");

}

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T22:25:32.103

because you already have return statement executed before that code

```
return( path.delete() ); 
```

# entity-framework - EntityException：基础提供程序在打开时失败

> ID：13574204
> 
> 赞同：2
> 
> 时间：2012-11-26T22:24:47.397
> 
> 标签：entity-framework, ninject

我在使用 Entity Framework 连接到我的数据库时遇到问题。尝试连接到数据库时，我随机收到以下错误...

```
EntityException: The underlying provider failed on Open.
The connection was not closed. The connection's current state is connecting. 
```

为了让您了解我的设置背景，我使用的是 MVC 4 和 Ninject。我还在使用[本文](http://www.asp.net/mvc/tutorials/getting-started-with-ef-using-mvc/implementing-the-repository-and-unit-of-work-patterns-in-an-asp-net-mvc-application)中描述的存储库和工作单元模式。我在 MVC 4 中使用默认的 NinjectWebCommon 文件，我的 RegisterServices 方法如下...

```
private static void RegisterServices(IKernel kernel)
{
    kernel.Bind<IMyEntities>().To<MyEntities>();
    kernel.Bind<IUnitOfWork>().To<UnitOfWork>().InRequestScope();
    // UnitOfWork has a dependency on MyEntities

    kernel.Bind<IAccountManager>().To<AccountManager>(); 
    kernel.Bind<ITransactionManager>().To<TransactionManager>(); 
    // AccountManager and TransactionManager has a dependency on UnitOfWork
} 
```

我的页面加载正常，但页面上有 2 个导致错误的 ajax 调用。删除 ajax 调用后，永远不会发生错误。当只有 1 个 ajax 调用时，永远不会发生错误。只有当两个调用同时进行时才会发生错误。

这是 2 个不同的 Web api 控制器...

```
public class AccountController : ApiController
{
    private readonly IAccountManager _AccountManager;

    public AccountController(IAccountManager accountManager)
    {
        _AccountManager = accountManager;
    }

    public HttpResponseMessage Get()
    {
        IEnumerable<Account> accounts = _AccountManager.Get();
        return Request.CreateResponse(HttpStatusCode.OK, accounts);
    }
} 
```

和

```
public class TransactionController : ApiController
{
    private readonly ITransactionManager _TransactionManager;

    public TransactionController(ITransactionManager transactionManager)
    {
        _TransactionManager = transactionManager;
    }

    public HttpResponseMessage Get()
    {
        IEnumerable<Transaction> transactions = _TransactionManager.Get();
        return Request.CreateResponse(HttpStatusCode.OK, transactions);
    }
} 
```

我真的不知道在这里做什么。我已经阅读了 StackOverflow 和 Google 上与此相关的所有文章，但我找不到答案。有谁知道我能做些什么来阻止这个问题的发生？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-30T09:55:52.193

我遇到了同样的问题，最终我发现同一个 UnitOfWork 实例正在从不同的线程访问。我对 Ninject 不是很熟悉，但我建议检查您的 Account 和 TransactionManager 以确保它们正在访问不同的 UnitOfWork 实例。

# c# - 如何从浏览器读取条形码

> ID：13574214
> 
> 赞同：0
> 
> 时间：2012-11-26T22:25:38.127
> 
> 标签：c#, barcode

是否可以从移动浏览器读取条形码？我需要制作一个移动网页，将商店中商品的扫描标签作为输入。它还需要稍后支持移动应用程序。我正在.Net 中开发网站。我需要通过手机的摄像头读取条形码。

我正在用 C# 开发网站。不确定这是否会增加任何限制。你知道任何图书馆吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:28:39.420

取决于你想采取什么方法......

最简单的方法是获取条形码阅读器并将其置于“键盘楔形”模式并以这种方式扫描内容，因此它基本上看起来就像有人在输入内容

更复杂的是，那里有将网络摄像头用作条形码阅读器的库，您可以通过 javascript 访问它

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:41:11.687

有趣的问题泰迪。如果我理解正确，您只是在服务器端使用 C# ASP.NET，而不是在客户端。如果您想考虑 Silverlight，您可以查看 Greg Bray 的 ZXing 的 C# Silverlight 端口。但是，根据我从您对 Keith 回复的评论中了解到的情况，这不是您想要做的。（Silverlight 与 Flash 非常相似，您拒绝它，并且在移动设备上的支持较少。）

将 Flash 和 Silverlight 排除在外，您有两个问题需要解决，可能使用不同的技术：

1.  让浏览器连接到设备的摄像头并捕获图像。如果您不想使用 Flash（或 Silverlight），您将不得不依赖在新浏览器（包括移动浏览器）中慢慢找到的功能。Eric Bibelman 的博客是一个很好的起点：[http ://www.html5rocks.com/en/tutorials/getusermedia/intro/](http://www.html5rocks.com/en/tutorials/getusermedia/intro/)

2.  您需要“读取”图像中的条形码。有两个明显的选择：

    A. 使用 JavaScript。（这是有希望的，但我还没有尝试过可用的解决方案，并且我怀疑它们会超出基本的概念验证功能多远。）参见例如 Tobias Schneider 的要点：[https ://gist.github.com/ 421369](https://gist.github.com/421369)

    B. 将图像发布回您的服务器端 C# ASP.NET 代码并在那里处理条形码识别。然后，您将能够使用 C# 库，包括 ZXing 端口。（或者，如果您认为有可能使用更好的条形码识别选项，您可以使用使用不同技术（例如 Java）的专用服务器。）

老实说，我首先会考虑使用本地界面和库来创建移动应用程序，用于图像捕获和条形码识别，并通过在应用程序中嵌入 Web 浏览器控件来重用我的网站工作。在 Android 中使用 ZXing 执行此操作只花了我不到一个小时，我认为如果我想将应用程序移植到这些平台，我不会遇到太多的障碍。

# git - git rebase 私有特性分支

> ID：13574220
> 
> 赞同：4
> 
> 时间：2012-11-26T22:25:57.680
> 
> 标签：git, git-rebase, git-fork

我们有一个每个人都使用的共享 git 存储库，我们有两个分支

*   掌握
*   开发者

我有我自己的这个 repo 的分支。我不时将上游 repo 中的更改拉到 fork 中的相应分支中，然后将我的功能分支重新定位到 dev 上。

IE。

叉

*   掌握
*   开发者
*   特色1

命令：

```
git checkout dev
git pull upstream dev
git checkout feature1
git rebase dev 
```

现在，当我不时将我的 feature1 分支推回我的 fork 时，我被告知我的分支已过时并进行拉取，然后我遇到合并冲突。

我是并且将是唯一一个在这个分支/分支上工作的人，所以我对为什么会遇到这些合并冲突感到困惑。

即使没有其他人正在处理它，重新设置推送分支是否有问题？有什么方法可以解决此问题或遵循更好的工作流程

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:57:18.333

发生这种情况是因为您正在重新调整您的更改。一旦你完成了你的分支不再包含与以前相同的提交，它就会包含反映相同（或类似更改）的新提交。当您尝试推送这些更改时，git 会注意到目标存储库上分支的当前尖端的提交不是您尝试设置为该分支的新尖端的提交的祖先。

`git push -f`即使不是快进，您也需要使用强制推动发生。但是当你这样做时，你需要小心不要从该分支中​​删除其他更改。如果该分支仅在您的单个存储库中进行过修改，那么`-f`在该分支上使用应该没问题，但是您肯定要小心不要使用该标志推送到`master`or分支。`dev`

# google-maps-api-3 - Google Maps API V3：绑定世界以适应区域并禁用地图重复

> ID：13574222
> 
> 赞同：5
> 
> 时间：2012-11-26T22:26:01.667
> 
> 标签：google-maps-api-3

设定`center: new google.maps.LatLng(0,0)`意志，设定世界的中心。并将`zoom: 1`默认缩放到整个世界。

问题是，鉴于地图的大小为 616 像素 x 310 像素，我们如何修改/调整地图的大小，使其很好地适合给定的大小。例如，仅显示世界的一个实例，地图的底部将是非洲的底部。所以随后的世界地图将不再重复。准确地说，使我们的地图绑定如下：

![在此处输入图像描述](../Images/1206c59eff7bbe69fb90538166280fa4.png)

这是我到目前为止所得到的： ![在此处输入图像描述](../Images/832005ae849d84cf257b580b59ca0910.png)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-02T19:53:01.690

整个世界的“图片”在给定的缩放级别下具有恒定的大小。对于缩放级别 1，它是 512 像素，对于缩放级别 2 1024、3 = 2048、4 = 4096 等...

要适应整个世界而不重复它，您需要有一个小于此缩放级别的整个世界图片的地图 div，否则它将不起作用。

对于缩放级别 1，地图需要 512 才能理想地适合，而不是不换行。

[https://output.jsbin.com/vabago](https://output.jsbin.com/vabago) 是一个示例，它显示给定缩放级别的世界宽度并将其记录到控制台。当您放大时，它还会调整地图的大小以适应整个世界（通常这样做很愚蠢，但在这里它只是展示了它的工作原理）。

高温高压

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T09:28:19.303

谷歌地图有一系列缩放级别——每一个都更近一步。您以像素为单位设置地图的高度和宽度，然后 google maps api 将加载适当的地图图块以填充提供的窗口。

实际上，它不允许您拉伸地图，而且我相信在缩放 1 时，世界的谷歌地图将是 256 像素 x 256 像素。

这是一个很好的概述，进一步解释了这一点：http: [//troybrant.net/blog/2010/01/mkmapview-and-zoom-levels-a-visual-guide/](http://troybrant.net/blog/2010/01/mkmapview-and-zoom-levels-a-visual-guide/)

此外，如果您在网页中动态放置图钉，您可以使用 api 直接按纬度和经度添加标记。如果您使用的是离线静态图像，那么首先，您应该考虑使用开源的 openstreetmaps 数据，因为您可能需要获得 Google 的进一步许可。对于openstreetmaps，您可能会考虑使用TileMill 或mapnik 等离线工具来放置标记？无论如何 - 阅读投影 - 这将解释纬度和经度坐标如何对应于图像上的像素位置。

您还可以查看[http://gis.stackexchange.com](http://gis.stackexchange.com)，它专门针对与地图相关的问题。

# asp.net - ASP.NET - 模板字段下拉列表

> ID：13574225
> 
> 赞同：0
> 
> 时间：2012-11-26T22:26:15.103
> 
> 标签：asp.net

请看下面的代码：

```
Protected Sub GVHistoricNames_RowUpdating(ByVal sender As Object, ByVal e As System.Web.UI.WebControls.GridViewUpdateEventArgs) Handles GVHistoricNames.RowUpdating
            Try
                'Dim strUsercode As String = GVHistoricNames.Rows(e.RowIndex).Cells(2).Text
                Dim ddl As DropDownList = CType(GVHistoricNames.Rows(e.RowIndex).FindControl("ddlUsercode"), DropDownList)
                MsgBox(ddl.SelectedIndex)

            Catch ex As Exception
                 'I don't swallow exceptions
            Finally

            End Try
        End Sub 
```

我正在尝试获取下拉列表的选定值。模板字段定义如下：

```
<asp:TemplateField HeaderText="Usercode">
                 <ItemTemplate>
                <asp:DropDownList ID="ddlUsercode" runat="server" SelectedValue ='<%# Bind("Usercode") %>' DataTextField="Usercode" DataValueField="Usercode">
                </asp:DropDownList> 
                </ItemTemplate>
            </asp:TemplateField> 
```

MsgBox(ddl.SelectedIndex) 总是在 GVHistoricNames_RowUpdatinGVHistoricNames_RowUpdating 中打印一个空字符串。我在做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:48:02.300

检查您是否没有在 rowUpdating 事件之前的页面生命周期中的某个位置绑定或填充下拉列表。确保您`not isPostback`酌情使用。检查那里的语法，因为我是 C# 人！

# jquery-mobile - JQuery Mobile，themeroller，渐变背景不是全屏

> ID：13574226
> 
> 赞同：1
> 
> 时间：2012-11-26T22:26:29.937
> 
> 标签：jquery-mobile, mobile, background, gradient, themeroller

我正在尝试使用 JQuery mobile 创建一个页面，我使用 Themeroller 让它看起来像我想要的那样。我使用的背景是渐变的，但它不会全屏显示，除非页面上有足够的内容来填满整个屏幕。见下图：

![在此处输入图像描述](../Images/6fb4d524c575fd02e935976df4cb0634.png)

看看渐变如何没有到达页面底部？这就是我一直坚持的...

我使用 Themeroller 生成的 CSS 文件。我试着编辑它，但它很大，我不知道在哪里改变什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:42:50.560

看起来背景正在应用于`.ui-content`不是其容器高度的 100% 的元素。您可以：

1.  使`.ui-content`元素 100% 高度或...
2.  `.ui-page`您可以在元素而不是元素上设置渐变`.ui-content`。

我会将渐变设置为`.ui-page`背景，如下所示：

```
.ui-mobile .ui-page .ui-content {
    background : none;
}
.ui-mobile .ui-page {
    background : /*gradient here*/;
} 
```

这些规则应该足够具体以覆盖 jQuery Mobile 样式表。这是一个演示：http: [//jsfiddle.net/YeTdT/](http://jsfiddle.net/YeTdT/)

如果您需要帮助创建跨浏览器 css 渐变，请参阅 ColorZilla： http: [//www.colorzilla.com/gradient-editor/](http://www.colorzilla.com/gradient-editor/)

# linux - 如何使用 awk 显示所有行，但在第二个字段中有一个条件？

> ID：13574227
> 
> 赞同：-3
> 
> 时间：2012-11-26T22:26:29.917
> 
> 标签：linux, bash, shell, unix

所以问题是：

使用 awk 显示文件中库存少于 100 件的所有行。数量是第二个字段。

我试过

```
 awk '$2 < 100' inventory 
```

但这仅在第二个字段中显示小于 100 的行，这是要求我显示所有行，我不知道如何显示，有人可以帮我吗？

* * *

草莓酱,300,4

覆盆子果酱,1216,7

蓝莓果酱,96,195

草莓果盘，49,621

覆盆子蜜饯,1937,624

蓝莓果盘,200,625

冷冻草莓，130,1941

草帽162047

^ 库存文件内容

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:29:21.887

这应该这样做：

```
awk 'BEGIN{FS=OFS=","} $2 < 100 {print}' inventory 
```

**说明：**：

*   `awk`: 调用 awk 命令
*   `BEGIN{FS=OFS=","}'`：用作输入和输出的分隔符​​，因为我仍然记得[您的其他问题](https://stackoverflow.com/questions/13573869/why-isnt-this-awk-command-working/)`,`中输入文件的格式
*   `$2 < 100 {print}`：只要条件`$2 < 100`为真，打印整行。
*   `inventory`：输入文件的名称。

**输入：**

```
Strawberry Jam,300,4
Raspberry Jam,1216,7
Blueberry Jam,96,195
Strawberry Compote,49,621
Raspberry Compote,1937,624
Blueberry Compote,200,625
Frozen Strawberries,130,1941
Straw Hats,16,2047 
```

**输出：**

```
Blueberry Jam,96,195
Strawberry Compote,49,621
Straw Hats,16,2047 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:32:38.257

如果您只想打印所有行，`awk`则：

```
awk '{print $0}' 
```

* * *

如果要打印第二个字段少于 100 个字符的行：

```
$ cat inventory

1,2,3
1,12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890,0 
```

像这样：

```
`awk -F, '$2 < 100 {print $0}' inventory`

1,2,3 
```

如果要根据第二个字段的值打印行：

* * *

```
$ awk -F, '$2<100' file

Blueberry Jam,96,195
Strawberry Compote,49,621
Straw Hats,16,2047

$ awk -F, '$2>100' file

Strawberry Jam,300,4
Raspberry Jam,1216,7
Raspberry Compote,1937,624
Blueberry Compote,200,625
Frozen Strawberries,130,1941 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:39:34.550

```
awk -F, '$2<100' file 
```

测试

```
kent$  cat test
Raspberry Jam,1216,7
Blueberry Jam,96,195
Strawberry Compote,49,621
Raspberry Compote,1937,624
Blueberry Compote,200,625
Frozen Strawberries,130,1941

kent$  awk -F, '$2<100' test
Blueberry Jam,96,195
Strawberry Compote,49,621 
```

# c++ - 如何让 C++ 向量更大？

> ID：13574236
> 
> 赞同：0
> 
> 时间：2012-11-26T22:27:25.980
> 
> 标签：c++, vector, size, multidimensional-array

我正在使用以下内容：

```
vector < vector < unsigned int > > paths; 
```

但似乎我只能在那里添加 647 278 行。我每行有 10 个数字。

我在每次迭代中调用它：

```
paths.resize(paths.size() + 1, vector < unsigned int >(10)); 
```

有没有比每次迭代都调用它更好的方法？我是否总是必须给出列数，因为它没有改变？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:36:02.863

正如 pyCthon 指出的那样，this [other question](https://stackoverflow.com/questions/131803/unsigned-int-vs-size-t)解释了这`size_t`是用于此处大小的正确类型，因为它保证足够大以允许您的体系结构达到最大值。

其次，该`.resize()`方法并不需要每次都调用。而是构造新向量并将`.push_back(newvec)`其添加到向量中。内部分配器将分配它认为合适的空间，并且通常是那里的最佳选择 - 它通常需要 O(log n) 重新分配，这在这里很重要；如果向量必须重新分配因为它需要更多空间，您最终可能会不断地将整个数组重新复制到新的内存块中。

更好的是，如果你能在一开始就计算出数组的总大小，那就这样做吧。这样，如果您调用 ，则在开始时只会有 1 个分配`.reserve(size)`，然后`.push_back()`用于每个元素，因为它将在开始时分配整个块。

如果您想知道一个向量可以在您的架构中使用的最大元素数，请调用 vector::max_size()。来自 cplusplus.com 的示例：

```
// comparing size, capacity and max_size
#include <iostream>
#include <vector>
using namespace std;

int main ()
{
  vector<int> myvector;
  cout << "max_size: " << myvector.max_size() << "\n";
  return 0;
} 
```

在 ideone.com 上运行它很快就得到了 1,073,741,823 的最大大小，如果向量是 a `vector< vector< unsigned int > >`，我得到 357,913,941。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:36:16.610

不确定，但在这个[std::vector 描述](http://www.cplusplus.com/reference/vector/vector/) 中指出向量存储在内存中的一个连续位置。这意味着向量存储在您内存中的一大块中。

您是否尝试将其拆分为不同的向量（大数组）？

# c# - DataGridView 行计算

> ID：13574239
> 
> 赞同：1
> 
> 时间：2012-11-26T22:27:47.167
> 
> 标签：c#, asp.net, datagridview, row

我在 Visual Studio 中使用 C# 进行项目。在我的项目中，它下面有一个 gridview 和一个按钮。当我点击按钮时，我想计算我的工人的总工作时间到最后一行。我阅读了所有类似的主题，但我的代码有问题。如果您有更多/任何说明性示例，请帮助我，我真的需要帮助。我的项目期限很短。

这是逻辑；

```
Sunday   Monday   Tuesday    ........     TOTAL

   10           50            5          ........        65              works like this.. 
```

其实我不想在我的gridview下只使用一个按钮。我想为每一行的每个工人使用......

这是 ButtonClick 代码，但我不想这样使用。我需要添加模板列，其中包含每一行的按钮。我知道但是怎么做？它总是失败，我总是遇到一些错误。

```
 protected void Button1_Click(object sender, EventArgs e)
    {
        foreach (GridViewRow row in GridView1.Rows)
        {
            row.Cells[10].Text = (Convert.ToInt32(row.Cells[3].Text) + Convert.ToInt32(row.Cells[4].Text)).ToString() +
                                 (Convert.ToInt32(row.Cells[5].Text) + Convert.ToInt32(row.Cells[6].Text)).ToString() +
                                 (Convert.ToInt32(row.Cells[7].Text) + Convert.ToInt32(row.Cells[8].Text)).ToString() +
                                 (Convert.ToInt32(row.Cells[9].Text));
        }
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T10:24:55.990

要在每一行上都有按钮，您需要使用

```
DatagridviewButtonColumn 
```

信息：[如何动态地将两个按钮添加到单个数据网格列？](https://stackoverflow.com/questions/7005036/how-can-i-add-two-buttons-to-a-single-datagrid-column-dynamically)

[http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewbuttoncolumn.aspx](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridviewbuttoncolumn.aspx)

[以编程方式定义 DataGridView 列类型](https://stackoverflow.com/questions/7781007/define-datagridview-column-type-programmatically)

**编辑：**

你可以这样做：

```
 DataGridViewButtonColumn clbt_delet = new DataGridViewButtonColumn();
   clbt_delete.HeaderText = "DELETE"
   clbt_delete.Text = "Delete";
   clbt_delete.UseColumnTextForButtonValue = true;
   dataGridView1.Columns.Add(clbt_delete); 
```

如果您需要任何其他信息，请随时说

# rest - MVC REST WebAPI 和 OAuth/OpenID 以及高容量请求

> ID：13574242
> 
> 赞同：0
> 
> 时间：2012-11-26T22:27:56.787
> 
> 标签：rest, asp.net-mvc-4, azure, oauth, asp.net-web-api

我正在研究一些关于如何达到特定结果的技术。我不熟悉 OAuth 以及我将/应该使用的任何技术，所以请多多包涵。

我有一个想尝试的想法：我想做一个可以在各种移动设备上运行的跟踪应用程序。它会将您的位置发送到服务器，让您的朋友知道您在长途旅行中的位置（例如跨越一个国家）。我的想法是用户将允许他的一些（少数几个）朋友登录到网站或应用程序并查看他在哪里。另外，如果服务器检测到用户停了很久，或者做了一些奇怪的事情，服务器会通知这些朋友，然后他们可以打电话给他检查。（受到一位同事的启发，他独自驾车 9 小时穿越全国，以惊喜地拜访他的女朋友）。

此外，作为挑战的一部分，我只想使用 Azure、Web API、Service Bus 和 ACS 等 Microsoft 技术。我也只想使用默认的 ASP.NET 成员资格提供程序和东西——我不想编写大量自定义代码。该项目将成为使用他们为我的应用程序提供的扩展点的所有默认 Microsoft 代码。

我的想法还需要与其他提供商互动，例如 Facebook 和 Google。我想到了如何通过允许用户登录应用程序以在他的 Facebook 上创建一个帐户并为旅行设置来实现这一点。然后，他将使用同一个 Facebook 帐户从他的设备登录，然后该应用程序将使用 REST API 与我的服务进行交互。我不想负责跟踪用户名和密码（希望我可以使用默认的 ASP.NET 成员资格和角色）。

但是，我不知道我应该看什么。我假设如果用户每分钟左右发送一次他们的位置，我的 API 将会有大量的请求。我想为此使用队列，API 只会将所有位置转发到将由工作人员处理的队列。该 API 将提供一种发送位置以及创建和修改用户设置的方式。我不确定解决此问题的最佳方法。**对我的 API 的大量请求会导致其他请求的性能下降吗？我是否应该有一个单独的服务器来处理位置，而另一个服务器用于基本的用户管理？**

可以说我非常喜欢这个应用程序，我不希望收到的每个位置都向 Facebook 服务器发送数千个请求。OAuth在这里不起作用吗？**我的应用程序是否可以缓存一个可以与用户通过 Web 界面登录时拥有的密钥一起使用的密钥？**我希望系统能够在到达队列之前拒绝垃圾邮件请求，例如随机令牌或其他东西。OAuth 是这个应用程序的可行方法吗？

我不确定，因为这对我来说很新。**如何创建使用第三方身份验证的大容量基于 REST 的应用程序？**我希望对位置更新使用纯 HTTP（只是因为我确信它应该是可能的 - 也许有人可以评论更大开销的选项？），所以我不希望消息中的密码全部。我应该使用 REST 吗？

我知道这是一个很长很宽泛的问题，但我想学习并且愿意这样做，不惜一切代价。请花时间阅读并指出任何事情，无论好坏。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T01:51:35.370

根据您的应用程序设计，您可能对 SignalR (http://signalr.net/) 感兴趣。它非常适合订阅请求（一群朋友），然后向这些朋友广播任何更改（就像你说的那样奇怪）。

Microsoft 正在制作 ASP.NET 平台的一部分，因此它基于 Microsoft 技术：[http ://channel9.msdn.com/Events/Build/2012/3-034](http://channel9.msdn.com/Events/Build/2012/3-034)

我认为是那个视频，或者他们提到的另一个视频（因为它的异步性质/首先使用 WebSockets）可以在笔记本电脑上扩展到每秒 20,000 条消息。这类东西的认证是次要的，先看你的核心技术。

# c# - 跨进程使用事务

> ID：13574245
> 
> 赞同：2
> 
> 时间：2012-11-26T22:28:07.483
> 
> 标签：c#, .net, transactionscope, msdtc, system.transactions

我正在尝试使用 System.Transactions (TransactionScope) 来协调一组进程，每个进程都执行一些数据库工作。最终，所有进程都需要通过一个父进程自动提交或回滚。不幸的是，到目前为止我没有尝试过任何工作。

我的基本策略是在父进程中TransactionScope，将其保存到一个文件中，然后调用一个子进程，该子进程加载文件，使用它自己的TransactionScope中的事务，并返回给父进程。

但这对我不起作用。当我打电话给第一个孩子回来时，我有时会看到父事务已被标记为已中止。尝试克隆它然后抛出 TransactionAbortedException。

当第二个孩子尝试反序列化事务时，我也看到了异常，我得到了一个代码为 0x8004d00e 的 TransactionException。

我正在尝试[跨 AppDomains 和进程的 TransactionScope](https://stackoverflow.com/questions/5348242/transactionscope-across-appdomains-and-processes)以及[http://blogs.microsoft.co.il/blogs/sasha/archive/2010/04/30/propagating-a-transaction-across-appdomains 中描述的内容。 .aspx](http://blogs.microsoft.co.il/blogs/sasha/archive/2010/04/30/propagating-a-transaction-across-appdomains.aspx) _ 无论如何，没有运气。

以下是我尝试过的一些事情，但没有成功：

1.  从加载的事务中通过 DependentClone() 在子进程中创建 DependentTransaction
2.  在将事务保存到文件之前，在父进程中通过 DependentClone() 创建 DependentTransaction
3.  在将事务保存到文件之前，在父进程中创建 Clone()
4.  使用序列化保存事务
5.  使用 TransactionInterop.GetTransactionFromTransmitterPropagationToken() 保存交易
6.  在父级的 TransactionScope 之前显式打开连接
7.  在父级中显式登记事务
8.  显式地在孩子内部登记交易
9.  完成/未完成父级的范围
10.  完成/未完成孩子的范围
11.  在父级显式创建 CommittableTransaction

这是一条异常消息：

System.Transactions.TransactionException：事务已被隐式或显式提交或中止。---> System.Runtime.InteropServices.COMException：事务已被隐式或显式提交或中止（来自 HRESULT 的异常：0x8004D00E）

另一个（使用 DependentClone() 时）：

System.Transactions.TransactionAbortedException：事务已中止。在 System.Transactions.TransactionStatePromotedAborted.CreateBlockingClone(InternalTransaction tx) 在 System.Transactions.DependentTransaction..ctor(IsolationLevel isoLevel, InternalTransaction internalTransaction, 布尔阻塞) 在 System.Transactions.Transaction.DependentClone(DependentCloneOption cloneO ption)

任何想法我做错了什么？我已经尝试了很多这种排列，但没有任何运气。

下面是一些代码（并没有试图演示上述所有变体）：

```
 // one variant I have tried is to create a CommittableTransaction
        // and pass that in the scope below

        using (TransactionScope scope = new TransactionScope())
        {
            // optionally, do some parent-level EF work

            // invoke child operations in other processes
            DoChildOperation_OutOfProc(1, Transaction.Current);
            DoChildOperation_OutOfProc(2, Transaction.Current);

            scope.Complete();
        }

        // in the variant where I created a CommittableTransaction,
        // I committed it here

    ...

    private static void DoChildOperation_OutOfProc(int id, Transaction transaction)
    {
        string tranFile = string.Format("ChildTran_{0}.txt", id);
        SaveTransactionToFile(transaction, tranFile);

        Process process = new Process();
        process.StartInfo = new ProcessStartInfo(Process.GetCurrentProcess().MainModule.FileName.Replace(".vshost", string.Empty),
            string.Format("-CHILDID={0} -TRANFILE={1}", id, tranFile));
        process.StartInfo.UseShellExecute = false;
        process.Start();
        process.WaitForExit();
    }

    private static void SaveTransactionToFile(Transaction transaction, string tranFile)
    {
        byte[] transactionBytes =
            TransactionInterop.GetTransmitterPropagationToken(transaction);

        string tranFileContents = Convert.ToBase64String(transactionBytes);

        File.WriteAllText(tranFile, tranFileContents);
    }

    private static Transaction LoadTransactionFromFile(string tranFile)
    {
        string tranFileContents = File.ReadAllText(tranFile);
        File.Delete(tranFile);

        byte[] tranBytes = Convert.FromBase64String(tranFileContents);

        Transaction tran = 
            TransactionInterop.GetTransactionFromTransmitterPropagationToken(tranBytes);
        return tran;
    }

    // the child instance of the app runs this after decoding the arguments
    // from DoChildOperation_OutOfProc() and loading the transaction out of the file

    private static void DoChildOperation(int id, Transaction childTransaction)
    {
        // in one variant, I call 
        // childTransaction.DependentClone(DependentCloneOption.BlockCommitUntilComplete)
        // and then use that inside the TransactionScope

        using (TransactionScope scope = new TransactionScope(childTransaction))
        {
            // do EF work and call SaveChanges()

            scope.Complete();
        }

        // if I created a dependent clone, call Complete() here on it 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T22:14:35.760

好的，关键似乎是您可以在父级中使用 TransactionScope，但不能在子级中使用。对于孩子，我打开 EF 连接，使用传递的事务调用 connection.EnlistTransaction()，然后执行 EF SaveChanges() 或 transaction.Rollback() 但不提交（Transaction 类不提供此功能）。这样做，似乎我得到了所需的行为。

我理解的差距实际上是事务是否嵌套（就像您在 SQL Server 中所做的那样）。看来确实不是；这是同一笔交易。注意：即使你在子进程中使用 Transaction.DependentClone() 创建了一个 DependentTransaction，如果你把它放到一个 TransactionScope 中你仍然会失败。

这证明有点不幸，因为这意味着如果你的进程是父进程，你可以使用 TransactionScope，但如果它是子进程，你不能。

# android - ImageButton 在片段中不起作用

> ID：13574246
> 
> 赞同：0
> 
> 时间：2012-11-26T22:28:11.580
> 
> 标签：android, android-fragments, android-edittext

我正在使用 Fragments 开发一个应用程序，并且我的一个 Fragments 上有一个 ImageButton。它应该询问用户是否要保存他们在 EditText 中输入的内容，然后如果他们按下回车键，则将其保存到 SQLiteDatabase。当这个 Fragment 是一个 Activity 时，这一切都很好，除了我不必重写 onKeyDown。现在我已经把它移到了一个片段中，ImageButton 什么也不做。我错过了什么？这是代码：

```
 <EditText
        android:id="@+id/stitchnotes"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:gravity="left"
        android:hint="@string/hint"
        android:textAppearance="?android:attr/textAppearanceSmall"
        android:textColor="@android:color/white"
        android:inputType="text" />

    <ImageButton
        android:id="@+id/savebutton"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:contentDescription="@string/video_content_description"
        android:src="@drawable/actions_file_save_as_icon" /> 
```

我正在使用[此处](http://useranswer.com/answer/fragment-which-callback-invoked-when-press-back-button-customize-it/)的技术来覆盖扩展 Fragment Activity 的 Activity 中的 onKeyDown 方法：

```
public class StitchList extends FragmentActivity {
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)
{
    super.onKeyDown(keyCode, event);
    DetailFrag frag = new DetailFrag();
    frag.onKeyDown(keyCode, event);
    return false;
} 
```

然后在我的片段中定义 onKeyDown：

```
public class DetailFrag extends Fragment {
public static boolean Edited = false;
public AlertDialog.Builder builder;
public AlertDialog alert;
@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {

    View view = inflater.inflate(R.layout.detailfragment, container, false);
    Typeface font = Typeface.createFromAsset(getActivity().getAssets(),
            "danielbk.ttf");

    builder = new AlertDialog.Builder(getActivity());
    builder.setMessage("Do you want to save your Notes?");
    builder.setCancelable(false);

    builder.setPositiveButton("Yes",
            new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {

                    dialog.cancel();
                }
            });

    builder.setNegativeButton("No",
            new DialogInterface.OnClickListener() {

                @Override
                public void onClick(DialogInterface dialog, int which) {

                    getActivity().finish();
                }
            });

    alert = builder.create();

    final EditText notes = (EditText)view.findViewById(R.id.stitchnotes);
    notes.setTypeface(font);
    notes.setTextSize(12);

    ImageButton savebutton = (ImageButton)view.findViewById(R.id.savebutton);
    savebutton.setOnClickListener(new ImageButton.OnClickListener() {

        public void onClick(View v) {
            String Notes = notes.getText().toString();
            Uri updateUri = ContentUris.withAppendedId(STITCHES_URI, rowID);
            ContentValues values = new ContentValues();
            values.put("stitchnotes", Notes);
            getActivity().getContentResolver().update(updateUri,values,null,null);
        }
    });
    notes.addTextChangedListener(new TextWatcher() {

        @Override
        public void afterTextChanged(Editable s) {

        }

        @Override
        public void beforeTextChanged(CharSequence s, int start,
                int count, int after) {

        }

        @Override
        public void onTextChanged(CharSequence s, int start,
                int before, int count) {
            Edited = true;

        }
    });

    return view;
}
public boolean onKeyDown(int keyCode, KeyEvent event) {
    if (keyCode == KeyEvent.KEYCODE_BACK && event.getRepeatCount() == 0
            && Edited) {
        alert.show();
        return true;
    }
    else
        return false;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:24:44.587

现在在你的`onKeyDown`方法中，`FragmentActivity`每次按下一个键时都会创建一个新的片段，但它永远不会将它添加到`FragmentManager`

```
@Override
public boolean onKeyDown(int keyCode, KeyEvent event)
{
    super.onKeyDown(keyCode, event);
    // Creates a new DetailFrag
    DetailFrag frag = new DetailFrag();
    // Call the onKeyDown in the new Fragment
    frag.onKeyDown(keyCode, event);
    return false;
} 
```

您想从 中获取现有`DetailFrag`的`FragmentManager`，例如：

```
DetailFrag f = (DetailFrag) getFragmentManager().findFragmentByTag("MyTag"); 
```

或者

```
DetailFrag f = (DetailFrag) getFragmentManger().findFragmentById(R.id.fragment); 
```

一旦你有了片段，你就可以调用该`onKeyDown`方法。

此外，`DetailFrag`如果您想在单击时弹出警报，`ImageButton`则需要调用`alert.show()`该`onClick`方法。

```
savebutton.setOnClickListener(new ImageButton.OnClickListener() {

    public void onClick(View v) {
        alert.show();
        ....
    }
}); 
```

然后更新数据库的方法将进入 in 的`onClick`方法中`PositiveButton`，`Dialog`现在它只是调用`dialog.cancel()`which just dis

```
builder.setPositiveButton("Yes",
        new DialogInterface.OnClickListener() {

            @Override
            public void onClick(DialogInterface dialog, int which) {

                String Notes = notes.getText().toString();
                Uri updateUri = ContentUris.withAppendedId(STITCHES_URI, rowID);
                ContentValues values = new ContentValues();
                values.put("stitchnotes", Notes);
                getActivity().getContentResolver().update(updateUri,values,null,null);
            }
        }); 
```

# asp.net-mvc-3 - 在 Visual Studio 2010 中调试 ASP MVC 项目时出现 HTTP 错误 401.0

> ID：13574254
> 
> 赞同：1
> 
> 时间：2012-11-26T22:28:39.893
> 
> 标签：asp.net-mvc-3, visual-studio-2010, debugging, iis

我最近在工作中接手了一个 ASP MVC 项目，当我尝试在 Visual Studio 2010 中调试时，我收到一个 HTTP 错误 401.0。我对使用 ASP MVC 完全陌生，因此将不胜感激任何帮助。谢谢！

详细错误信息：

模块

ManagedPipelineHandler

通知

执行请求处理程序

处理程序

System.Web.Mvc.MvcHandler

错误代码

0x00000000

请求的网址

localhost:2574/（编辑：当我尝试发布问题时，由于 StackOverflow 的错误，我从该 URL 的前面删除了“http://”）

物理路径

C:\Projects\sym_SPAIN_INT_NEAROD\sym_SPAIN\SPAIN

登录方式

匿名的

登录用户

匿名的

请求跟踪目录

C:\Users\nearod\Documents\IISExpress\TraceLogFiles\SPAIN

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-13T15:38:59.477

我和尼尔一起工作，并认为我们最好发布答案。此应用程序已在 web.config 中将身份验证模式从 Form 更改为 Windows：

```
<authentication mode="Windows" /> 
```

在 Windows XP 上运行良好。在 Windows 7 上，它返回 401。我们在项目属性中发现了问题（不是右键单击项目时的问题，而是单击项目名称并单击属性窗口图标的问题。）在属性窗口中，有一个用于 Windows 身份验证的项目。这被设置为“禁用”。更改为“启用”解决了这个问题。

# node.js - Socket.io 消息事件未从客户端发送到服务器

> ID：13574256
> 
> 赞同：1
> 
> 时间：2012-11-26T22:28:42.393
> 
> 标签：node.js, events, socket.io

我在这里陷入了困境，希望得到一些帮助。我是 Node.js、Socket.io 和 Express 的新手——我今天才开始学习，但我进步很快。我正在尝试构建一个简单的小型网络聊天应用程序，但遇到了问题。我已经设置了一个带有文本框的表单，当提交时，它被发送到服务器，服务器将值记录在控制台中。唯一的问题是它没有将其记录到控制台。

服务器和客户端连接得很好（客户端连接时我有一个 console.log("Client connected...") 消息），但消息事件发射器似乎不起作用。我使用过时的代码吗？无效的语法？我花了几个小时寻找答案，但还没有找到答案。

我的应用程序分为 app.js、index.html 和 /public/default.css。

应用程序.js：

```
var express = require('express');
var app = express();
var http = require('http');
var server = http.createServer(app);
var io = require('socket.io').listen(server);

io.sockets.on('connection', function(client) {
  console.log("Client connected...");
  client.on('messages', function(data) {
    console.log(data);
  });
});

app.use('/public', express.static(__dirname + '/public'));

app.get('/', function(request, response) {
response.sendfile(__dirname + "/index.html");
});

server.listen(3000);
console.log("Listening on port 3000"); 
```

索引.html：

```
<!DOCTYPE html>
<html>
<head>
    <title>Chatapp</title>
    <link rel="stylesheet" type="text/css" href="public/default.css"></link>
</head>
<body>
    <h1 class="title">Chatapp</h1>

    <div id="wrapper">
        <div id="online">

        </div>

        <div id="body">

        </div>

        <div id="input">
            <form id="chatform">
                <input type="text" id="message"></input>
                <input type="submit" id="send" value="Send!"></input>
            </form>
        </div>
        <div class="clear"></div>
    </div>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <script>
        $(document).ready(function() {
            var server = io.connect('http://localhost:3000');
            $('#chatform').submit(function(e) {
                e.preventDefault();
                var message = $('#message').val();
                socket.emit('messages', message);
            });
        });
    </script>
</body>
</html> 
```

/public/default.css：

```
body {
  margin:  0;
  padding:  0;
  font: 14px "Lucida Grande", Helvetica, Arial, sans-serif;
}

a {
  color: #00B7FF;
}

#wrapper {
  margin: 0 auto;
  width:  940px;
  height: 500px;
  padding: 0;
  border: 1px solid #000;
}

#online {
  float: left;
  width: 188px;
  height: 480px;
  padding: 10px;
  border-right: 1px solid #000;
}

#body {
  float: left;
  width: 711px;
  height: 419px;
  padding: 10px;
  border-bottom: 1px solid #000;
}

#input {
  float: left;
  height: 60px;
  width: 731px;
}

.clear {
  clear: both;
}

h1.title {
  text-align: center;
}

input#message {
  float: left;
  margin: 0;
  width: 640px;
  height: 58px;
  border: none;
  font-size: 28px;
  padding-left: 10px;
  box-shadow: inset 1px 1px 3px rgba(0,0,0,0.3);
}

input#message:focus {
  border: none;
  outline: none;
  box-shadow: inset 1px 1px 3px #55ba57, inset -1px -1px 3px #55ba57;
}

input#send {
  float: left;
  background: #55ba57;
  color: #fff;
  border: none;
  height: 60px;
  margin: 0;
  width: 81px;
  border-left: 1px solid #000;
}

input#send:hover {
  background: #489949;
  cursor: pointer;
}

input#send:active {
  background: #1e7520;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T02:47:59.773

您正在更改名称，我认为这会导致一些混乱。在客户端，您正在设置一个名为 server 的变量，但您正在调用 socket.emit()。您的浏览器控制台中应该有一些错误消息，可以帮助您跟踪这一点。

# android - flurry - 如何查看单个会话中的事件？

> ID：13574257
> 
> 赞同：-2
> 
> 时间：2012-11-26T22:28:43.477
> 
> 标签：android, flurry

我认为这在他们的仪表板上会很简单，或者可能只是我。如何查看在单个会话中发生的事件？Flurry Classic 仪表板上的会话不可单击。有任何想法吗？谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:52:54.090

事件-> 事件日志为我到达那里。

如果您有很多事情要尽力找出手机的制造商和时间，那么如果用户报告了问题，那么找到一个安全的人可能会很痛苦。

# c++ - 编译 Qt 项目以在 Linux 系统上运行

> ID：13574266
> 
> 赞同：0
> 
> 时间：2012-11-26T22:29:45.017
> 
> 标签：c++, linux, windows, qt, cross-platform

我有一个 Qt 项目。它使用跨平台库 SDL、OpenGL 和 FLTK。我希望能够编译该项目，以便它可以在 Linux 计算机上运行。我正在查看到目前为止我看到的一堆文章，有两种方法可以做到这一点。使用交叉编译器，在我看来，设置和编译是一件相当复杂的事情，或者其他选项是在 Linux 计算机上简单地编译项目，只是 Qt creator/SDK 的 Linux 版本。

我的问题是，如果我有一个仅使用跨平台库的 Qt 项目，那么创建 Windows 版本是否像在 Qt/Windows 中编译一样容易，而创建 Linux 版本是否像在 Qt/Linux 中一样容易？

PS。请不要问/抱怨为什么我不只是尝试看看它是否可以自己运行，我现在没有在我的计算机上安装任何 Linux 操作系统，我不想冒险陷入麻烦安装一个全新的操作系统只是为了让它最终不起作用。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:02:19.160

> 我现在没有在我的计算机上安装任何 Linux 操作系统，我不想冒险安装一个全新的操作系统，只是为了让它最终无法工作。

您听说过虚拟化吗？安装[VirtualBox](https://www.virtualbox.org/)和 Linux。如果您的机器不能同时托管 2 个系统，您可以创建可启动的笔式驱动器。这将比交叉编译您的程序更容易和更快。事实上，您必须在某个地方安装 Linux 以测试一切是否正常。

不过如果你真的不能安装Linux，你可以试试。我听说过在 Linux for Windows 上进行编译，但只有一种方式。Linux 的问题是每个发行版都有自己的结构。因此，即使您创建可执行文件，您也无法确定它是否在每个系统上运行（它不是 Java）。但是如果你切换到 QtCreator 编译会很容易——只需点击 build 按钮。如果您决定在 VM 上安装 Linux 并且没有足够的资源来运行图形模式，请使用 ssh 登录并从命令行编译。

# c++ - 调用 delete [] 会导致程序崩溃，但在调试时不会

> ID：13574267
> 
> 赞同：1
> 
> 时间：2012-11-26T22:29:47.457
> 
> 标签：c++, crash

这是一个简单程序的代码，它应该读取每行包含一个单词的文本文件，动态分配存储所有单词所需的内存，将它们打印在屏幕上并释放使用的内存。

```
#include <stdlib.h>
#include <stdio.h>
#include <string.h>

class Dict {
 public:
 int size;
 char ** words;
 Dict (int, int*);
 ~Dict ();
};

Dict::Dict(int s,int* sizes) {
 int i;
 size=s;
 words = new char* [s];
 for (i=0;i<s;i++)
  words[i] = new char [sizes[i]];
}

Dict::~Dict() {
 int i;
 for (i=0;i<size;i++) {
  delete [] words[i];
  printf("i=%d\n",i); // for debugging
  }
 delete [] words;
}

Dict loadDict (char* filename) {
 FILE* file;
 int n=0,i=0;
 int * sizes;
 char buff [64];

 file=fopen(filename,"r");
 while (!feof(file)) {
  n++;
  fscanf(file,"%*[^\n] \n");
 }
 sizes=new int [n];

 rewind(file);
 while (!feof(file)) {
  if (fscanf(file,"%s\n",buff)>0) {
   sizes[i]=strlen(buff);
   i++;
  }
 }

 rewind(file);
 Dict r(n,sizes);
 i=0;
 while (!feof(file)) {
  fscanf(file,"%s\n",r.words[i]);
  i++;
 }

 delete [] sizes;
 return r;
}

int main() {
 int i;
 Dict d=loadDict("dict.txt");
 for (i=0;i<d.size;i++)
 printf("%s|\n",d.words[i]);
 printf("%d DONE.\n",d.size);
 return 0;
} 
```

解除分配是在 Dict 类的析构函数中完成的。但是，在仅包含几个单词的示例文本文件上使用这些单词时，这些单词可以正确打印，但是在`~Dict`执行 3 行表单后调用会导致应用程序崩溃`delete [] words[i];`。如果我使用 Code::Block 的调试器并在该行上设置一个断点并告诉它在每个断点上继续，程序将正常终止。

由于这是一个非常简单的程序，我希望有一些简单的答案或修复！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T22:35:06.170

该类`Dict`具有动态分配的成员，但使用默认的复制构造函数和赋值运算符，这会导致在制作副本时`Dict`指向同一个`words`数组的两个实例，这在使用函数`Dict`时会发生。`loadDict()`当其中一个`Dict`实例被破坏时，它会为另一个实例留下`Dict`一个悬空指针，并将导致`words`数组及其元素的双重删除。

请参阅[什么是三法则？](https://stackoverflow.com/questions/4172722/what-is-the-rule-of-three)

如果这不是学习练习，请使用 a[`std::vector<std::string>`](http://en.cppreference.com/w/cpp/container/vector)和 C++ 流。例如：

```
std::vector<std::string> words;
...

std::ifstream in(filename);
std::string line;
while (in >> line) words.push_back(line); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T22:35:00.383

您没有遵循三原则：

[http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29](http://en.wikipedia.org/wiki/Rule_of_three_%28C%2B%2B_programming%29)

`Dict r`在结束时被破坏，`loadDict`同时将自身的浅拷贝返回到`main`. `main`在指针的末尾`delete`又是 d。

就像在 C++ 中一样，这里不需要指针。存储一个`std::vector<std::string>`，`Dict`不会有任何技巧。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T22:42:12.993

绝对错误的是您的代码没有复制构造函数，并且您正在按值返回一个对象。这可能导致双重破坏，因此双重删除日期。这是否发生取决于是否省略了复制构造。

此外，您为每个字符串分配了足够的字符来保存字符串，而不是空终止符。也就是说，要存储`s`具有长度的字符串，`strlen(s)`您需要分配`strlen(s) + 1`字符。

我建议`std::vector<std::string>`改用：这可以避免大多数问题。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T22:55:29.517

您的代码中存在一些问题：

1.  您没有检查 fopen 是否返回有效指针。（我得到这个是因为我尝试在没有 txt 文件的情况下运行代码）

2.  您正在返回一个 Dict 对象，它将调用复制构造函数并且您没有定义一个。

3.  您为 Dict 使用了赋值运算符，但没有定义一个。

您可以尝试将 loadDict() 更改为仅返回一个大小数组，然后将该数组传递给您的 Dict 构造函数。这样就不必编写复制构造函数和赋值操作符了。

# asp.net - ASP.NET 基于动态角色的操作访问

> ID：13574268
> 
> 赞同：1
> 
> 时间：2012-11-26T22:29:51.290
> 
> 标签：asp.net, asp.net-mvc, roleprovider

我希望在我的站点中实施基于角色的操作限制。例如，我希望限制仅由帖子作者或一组组编辑帖子的能力。

我知道我可以写类似的东西：

```
 if (User.IsInRole("Admin"))
          return true;
     return post.Author.AccountId == currentAccountId; 
```

但我想知道我是否可以在不使用固定名称的角色的情况下动态地做到这一点。我希望创建一个控制面板，使管理员能够添加新角色。在每个角色创建/修改表单中，都有一个复选框，上面写着“可以编辑其他帖子吗？”。基于该值，我将在上述方法中采取行动。我在 PHP 中已经做过很多次了，但是因为它是我的第一个 ASP.NET MVC 站点，所以我想知道是否可以使用默认的 SQL 数据库结构（使用 MVC4 和新的 SimpleMembershipProvider，但我不介意写一个如果必须，自定义提供程序）。

我已经阅读了新的声明功能，但我没有看到在这种情况下可以使用它的方法，对吗？

我在网上看过，但没有找到任何东西......

非常欢迎任何建议！谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:11:05.147

是的，您可以使用表单身份验证进行一些自定义自动化，但您需要进行一些自定义。

首先，您必须自定义`AuthenticateRequest`应用程序的事件以使用角色，因此，`Global.asax`您必须设置代码以将其自定义为当前用户：

```
protected void Application_AuthenticateRequest(object sender, EventArgs e)
{
    if (HttpContext.Current.User != null)
        if (HttpContext.Current.User.Identity.IsAuthenticated)
            if (HttpContext.Current.User.Identity is FormsIdentity)
            {
                var id = (FormsIdentity)HttpContext.Current.User.Identity;
                var ticket = id.Ticket;

                // Get the stored user-data, in this case, our roles
                string userData = ticket.UserData;
                string[] roles = userData.Split(',');
                HttpContext.Current.User = new GenericPrincipal(id, roles);
            }
} 
```

当您对用户进行身份验证时，您必须设置角色，因此在您的控制器上，您必须使用如下代码对身份验证进行发布操作：

```
if (LoginService.Validate(userame, password) 
{
   FormsAuthentication.Initialize();

   var ticket = new FormsAuthenticationTicket(1,
                                 username, //user
                                 DateTime.Now, //begin
                                 DateTime.Now.AddHours(3), //timeout
                                 false, //remember?
                                 permission, // permission.. "admin" or for more than one  "admin,marketing,sales"
                                 FormsAuthentication.FormsCookiePath);

  var cookie = new HttpCookie(FormsAuthentication.FormsCookieName,   FormsAuthentication.Encrypt(ticket));

  if (ticket.IsPersistent) cookie.Expires = ticket.Expiration;

  HttpContext.Current.Response.Cookies.Add(cookie);
} 
```

之后，您将能够使用类似于您的帖子的代码：

```
if (User.IsInRole("Admin"))
{ /** do something / } 
```

或者

```
if (User.IsInRole("Admin") || (User.IsInRole("Marketing") && User.IsInRole("Sales")))
{ /** do something / } 
```

也可以查看`Authorize`asp.net mvc属性上的角色：

```
[Authorize(Roles = "Admin")]
public class CompanyController : Controller
{
   // actions
} 
```

## 编辑

您可以有一个表来将权限“管理员”与某些特权（编辑评论、删除评论等......可以存储在数据库的表中）相关联。尝试这样的事情来实现自定义检查权限：

```
public static class UserExtension
{
    private static bool RoleHasPrivilege(string role, int privilege)
    {
        // performe a database/cache access to check if the role has the privilege
    }
    public static bool IsInRole(this IPrincipal user, string role, int privilege)
    {
        // check if the user authenticate has the "role" permission and the privilege is associate with this role...
        return user.IsInRole(role) && RoleHasPrivilege(role, privilege);
    }
} 
```

你可以使用：

```
if (User.IsInRole("Admin", 1)) 
{
  // "Admins" has access
  // 1 - can edit posts... for sample
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-29T10:04:32.737

费利佩·奥里亚尼（Felipe Oriani）建议的某种解决方案不起作用

当在 global.asax 中实现并使用方法时

> User.IsInRole("管理员")

它总是返回假。所以我想出了另一种在自定义 AuthorizeAttribute 中实现的解决方案。

```
public class AuthenticateRequestAttribute : AuthorizeAttribute
{
    protected override bool AuthorizeCore(HttpContextBase httpContext)
    {
        HttpContextBase context = httpContext;

    if (context.User != null)
        if (context.User.Identity.IsAuthenticated)
            if (context.User.Identity is FormsIdentity)
            {
                FormsIdentity id = (FormsIdentity)context.User.Identity;
                FormsAuthenticationTicket ticket = id.Ticket;

                string userData = ticket.UserData;
                string[] roles = userData.Split(',');
                context.User = new GenericPrincipal(id, roles);
            }
    return base.AuthorizeCore(httpContext);
} 
```

}

您可以使用此自定义属性代替内置的 [Authorize] 属性

```
[AuthenticateRequest]
public class AuthorizedController: Controller
{

} 
```

那么你绝对可以使用

```
if (User.IsInRole("Admin"))
{ /** do something / } 
```

希望这可以帮助

# java - Android 编程新手，对应用程序的格式和样式有一些疑问

> ID：13574269
> 
> 赞同：3
> 
> 时间：2012-11-26T22:29:54.167
> 
> 标签：java, android, layout, mediawiki, mobile-website

我是 Android 编程新手，我的第一个应用程序与 Wikia 页面有关。我现在设置它的当前方式我的应用程序将提取类别列表并将它们放在列表视图中供用户单击。一旦用户点击，它会将他们重定向到他们选择的类别/项目的移动页面。

我想知道应用程序重定向到移动网站的这种好习惯，还是我应该找到一种方法将信息从网站拉到我的应用程序中？任何一种方式都比另一种更好吗？请给我尽可能多的意见，你有好的或坏的，我想知道，所以我可以做到最好。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:39:59.483

Theee 无需将用户重定向到浏览器或 webView，因为您可以使用[WikiMedia API](http://en.wikipedia.org/w/api.php)解析数据 您也可以从 Github 查看[官方的 Wikipedia Android 应用程序](https://github.com/wikimedia/WikipediaMobile)，但它不是原生 Android 应用程序（它是使用 phonegap 构建的）

# java - Active Directory auth Tomcat - 在操作中读取用户名？

> ID：13574270
> 
> 赞同：0
> 
> 时间：2012-11-26T22:30:03.513
> 
> 标签：java, tomcat, struts2, active-directory

我已经在 Tomcat 中为我的 Struts 2 Web 应用程序实现了 Active Directory 身份验证。我希望能够在应用程序中使用登录用户的用户名。如何在动作中阅读它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:45:49.613

在 Struts2 中，有一个`org.apache.struts2.interceptor.PrincipalAware`界面可以设置`org.apache.struts2.interceptor.PrincipalProxy`为您的操作。在您的操作中实现它并使用此对象来获取用户主体。

使用`PrincipalAware`接口是获取用户主体的首选方式。来自 javadoc：

> 仅当 Action 在 servlet 环境中使用时，此接口才相关。通过使用此接口，您将不会被绑定到 servlet 环境。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:34:23.593

它不与 Servlet 上下文集成吗？您应该能够通过以下方式获得它：

```
ServletActionContext.getRequest().getUserPrincipal().getName(); 
```

# linux - linux 替代命令数据库（查找名称）

> ID：13574274
> 
> 赞同：1
> 
> 时间：2012-11-26T22:30:27.000
> 
> 标签：linux, symlink, sysadmin

我正在使用一个安装了各种 java 版本的系统，并使用“alternatives”命令在它们之间切换。我知道我可以使用以下命令更改 Java 版本：

```
alternatives --config java 
```

其中“ **java** ”是该替代列表的名称。我有兴趣查找当前安装的所有替代品的名称列表。例如，我知道“alternatives”还管理到 jdk 目录的链接，但我不知道要赋予 --config 的名称，以便我可以选择一个替代项。

如何获取 linux 系统上的替代名称列表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T16:31:20.963

我刚刚发现：

“关于替代系统的元数据可以在管理目录中找到，默认为`/var/lib/alternatives`.”

我在以下 URL 找到了该信息： [http ://www.quora.com/Alternatives-Linux-command/How-does-the-alternatives-system-work](http://www.quora.com/Alternatives-Linux-command/How-does-the-alternatives-system-work)

该目录中的每个文件都代表一个替代的“**名称**”。事实证明，替代方案可以管理的不仅仅是指向单个二进制文件的链接。它也可以管理相关路径！

# c++ - Why doesn't basic_string::append (iter, iter) call std::copy?

> ID：13574280
> 
> 赞同：5
> 
> 时间：2012-11-26T22:30:47.230
> 
> 标签：c++, string, copy

I just figured out that in Visual Studio C++ 2010, `basic_string::append (iter, iter)` is, obviously, not implemented by making use of `std::copy`.

First question:

Now suppose I implement my own iterator type, together with an optimized overloading of `std::copy` for my iterator type in order to provide more efficient block-wise copying. Is there any way to get `basic_string::append` to make use of this optimization, apart from overloading `append` as well?

Is there any chance that `basic_string::append (iter, iter)` does not do character-wise copying?

Second question (as a starting point for my own implementation):

Is the following guaranteed to be valid?

```
std::string t ("JohnB");
std::string s;
s.reserve (10);
std::copy (t.begin (), t.end (), s.begin ());
s.push_back ('\0'); 
```

or should I better use a `back_inserter`? If I use a `back_inserter` -- how can I avoid character-wise copying?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T23:26:35.353

The string class has its own traits class that defines the operations it can do on the characters it contains.

To copy `char`s, `basic_string<char>` will use `std::char_traits<char>::copy` (instead of the more general `std::copy`). That probably maps to the `memcpy` function in the standard C library.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T23:36:59.823

The definition of `std::basic_string<cT, ...>::append()` keeps delegating a few time before it eventually arrives at the overload (21.4.6.2 [string::append] paragraph 7):

> `basic_string& append(const charT* s, size_type n);`

At this point there is clearly none of the original iterators left. In case you wonder what happens to the input iterator you may have passed to `append()`, the got removed by the overload in paragraph 17 of the same paragraph which states:

> Effects: Equivalent to `append(basic_string(first, last))`.

at some intermediate state. If the standard library is implemented the way as it is literally stated by the standard there is clearly no call to `std::copy()`.

You wouldn't really be able to see your overloaded version of `std::copy()` anyway, though. What the library may do is the moral equivalent of

```
template <typename InIt>
std::basic_string<cT, ...>& std::basic_string<cT, ...>::append(InIt begin, InIt end) {
    if (is_forward_iterator<begin>::value) {
        this->reserve(this->size() + std::distance(begin, end));
    }
    std::copy(begin, end, back_inserter_without_capacity_check<InIt>(*this);
} 
```

Now, the other interesting bit is: Even if this is how it implemented, it doesn't really help you with respect to `std::copy()`! You cannot partially specialize `std::copy()` (well, you can't partially specialize any function template) and the type of target iterator is not defined (in the above implementation it would be a non-capacity checking variant of `std::back_inserter()` if `InIt` is a forward iterator and otherwise it would just be the same as `std::back_inserter()`.

# perl - 如何在用户代码中使用 perldb 的 x 命令？

> ID：13574285
> 
> 赞同：3
> 
> 时间：2012-11-26T22:31:07.130
> 
> 标签：perl, pretty-print

perl 调试器`x`命令的编程等效项是什么？

IOW，`x`该行的功能是什么

```
print x( $myvar ); 
```

在 Perl 脚本中将产生与生成的格式相同的输出

```
DB<2> x $myvar 
```

在 perl 调试器中？

（**注意**：我知道`Data::Dumper`，这*不是*我要找的；IOW，我明确排除了它；`D::D`的格式与调试器生成的格式不同`x`，我更喜欢后者。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:36:28.307

我相信您正在寻找 中的例程`dumpvar.pl`，您会在与`perl5db.pl`文件相同的目录中找到这些例程（参见`perldoc -l perl5db.pl`）。

例子：

```
require "dumpvar.pl";
dumpValue( { foo => 123, bar => "qwerty" } ); 
```

产生：

```
'bar' => 'qwerty'
'foo' => 123 
```

# wpf - 将样式中的标签绑定到样式对象的 DataContext 中的属性

> ID：13574288
> 
> 赞同：1
> 
> 时间：2012-11-26T22:31:12.310
> 
> 标签：wpf, data-binding, styles

精简问题：在 WPF 样式中，如何访问正在设置样式的对象的数据中的属性？

```
style  ----- this access--------
   UI object                   |
      data                     |
        property{get;set;} <-- | Access this
      /data
   /UI object
/style 
```

我有一个 ItemsControl，它显示了一堆多边形。

代码：

```
<ItemsControl x:Name="TopVectorItemControl" Grid.Row="1" ItemsSource="{Binding TopVectorData}"
            SizeChanged="TimelineItemsControl_SizeChanged" MouseRightButtonUp="TimelineItemControl_MouseRightButtonUp">
<ItemsControl.ItemsPanel>
    <ItemsPanelTemplate>
        <Common:ZoomableCanvas x:Name="TopAxis" Background="#FF65656C" Grid.Row="1" AllowDrop="True" IsVirtualizing="False"/>
    </ItemsPanelTemplate>
</ItemsControl.ItemsPanel>
<ItemsControl.ItemTemplate>
    <DataTemplate>
        <ContentControl MouseDoubleClick="Polygon_DoubleClicked">
            <Polygon Points="{Binding Points, Converter={StaticResource PointsConverter}}" Tag="{Binding Tag}" Stroke="Black" 
                        Fill="{Binding DirectionProp, Converter={StaticResource FillConverterTopBottomAxis}}" />
        </ContentControl>
    </DataTemplate>
</ItemsControl.ItemTemplate> 
```

当用户双击多边形时，我会应用一种样式（这些是多边形上每个点的装饰器）以允许用户更改多边形的形状/大小）。

款式代码：

```
<Style x:Key="ThumbStyleLeft" TargetType="{x:Type Thumb}">
<Setter Property="Template">
    <Setter.Value>
        <ControlTemplate TargetType="{x:Type Thumb}">
            <Grid HorizontalAlignment="Left" VerticalAlignment="Top" Width="21">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="12"/>
                    <ColumnDefinition Width="1*"/>
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="10"/>
                </Grid.RowDefinitions>
                <Ellipse Width="8" Height="8" Stroke="Black" StrokeThickness="1"  Grid.Row="1" Grid.Column="1" 
                            Grid.ColumnSpan="2" HorizontalAlignment="Left" VerticalAlignment="Top" Margin="1,1,0,0">
                    <Ellipse.Fill >
                        <SolidColorBrush Color="Blue" Opacity=".5"></SolidColorBrush>
                    </Ellipse.Fill>
                </Ellipse>
                <Label Content="000" Grid.Column="0" FontFamily="Segoe UI Semibold" FontSize="7" Foreground="Black" Padding="0" />
            </Grid>
        </ControlTemplate>
    </Setter.Value>
</Setter> 
```

图片： ![在此处输入图像描述](../Images/14b2d7b658c382b26047d851c04a08a7.png)

而不是“000”，我需要设置标签的内容

```
<Label Content="000" Grid.Column="0" FontFamily="Segoe UI Semibold" FontSize="7" Foreground="Black" Padding="0" /> 
```

在样式中，属性：

```
public String TestingLabel {get;set;} 
```

它与我的多边形绑定到“点”的类和级别相同

```
<Polygon Points="{Binding Points, Converter={StaticResource PointsConverter}}" Tag="{Binding Tag}" Stroke="Black" Fill="{Binding DirectionProp, Converter={StaticResource FillConverterTopBottomAxis}}" /> 
```

我该怎么做呢？

我试过了：

**{模板绑定测试标签}**

**{绑定路径=TestingLabel，RelativeSource={RelativeSource Self}}**

没有成功。

这是我将样式添加到拇指的代码：

```
public class AxisSelectionAdorners : Adorner
{
    private readonly Grid timelineGrid;
    private readonly ArrayList thumbArrray;
    private readonly TimelineItem timelineItem;
    private readonly VisualCollection visualChildren;

    public AxisSelectionAdorners(UIElement adornedElement, TimelineItem elementAt, Grid grid)
        : base(adornedElement)
    {
        thumbArrray = new ArrayList();
        visualChildren = new VisualCollection(this);

        timelineItem = elementAt;
        this.timelineGrid = grid;

        attachAdorners((Polygon)adornedElement);
    }

    protected override Size ArrangeOverride(Size finalSize)
    {
        var adornedElement = this.AdornedElement as FrameworkElement;

        var polygon = (Polygon)adornedElement;
        var p = new Point();
        if (polygon != null)
        {
            Thumb thumb;
            for (int i = 0; i < polygon.Points.Count; i++)
            {
                p = polygon.Points[i];
                thumb = (Thumb)thumbArrray[i];
                if ((i == (int)TagId.Start) || (i == (int)TagId.FadeInEnd) || (i == (int)TagId.FadeInMag))
                {
                    thumb.Arrange(new Rect(p.X - 17, p.Y - 16, 22, 25));
                }
                else if ((i == (int)TagId.End) || (i == (int)TagId.FadeOutMag) || (i == (int)TagId.FadeOutStart))
                {
                    thumb.Arrange(new Rect(p.X - 5, p.Y - 16, 20, 25));
                }
                else
                {
                    thumb.Arrange(new Rect(p.X - 5, p.Y - 5, 10, 10));
                }
            }
            p.X = (polygon.Points[(int)TagId.End].X - polygon.Points[(int)TagId.Start].X) / 2;
            p.X += polygon.Points[(int)TagId.Start].X;
            p.Y = polygon.Points[(int)TagId.FadeInEnd].Y;

            thumb = (Thumb)thumbArrray[polygon.Points.Count];
            thumb.Arrange(new Rect(p.X, p.Y, 14, 17));

            p.X += 15;
            thumb = (Thumb)thumbArrray[polygon.Points.Count+1];
            thumb.Arrange(new Rect(p.X, p.Y, 15, 9));
        }
        return finalSize;
    }

    private void BuildCorner(ref Thumb thumb, Cursor tempCursor, int id)
    {
        thumb.Height = 20;
        thumb.Width = 30;

        thumb.Cursor = tempCursor;
        Style style;
        if (id == (int)TagId.Direction)
        {
            // build style in code so we can bind the mouse click
            thumb.Height = 30;

            var s =new Style();

            var grid = new FrameworkElementFactory(typeof(Grid));

            var label = new FrameworkElementFactory(typeof(Label));

            label.SetValue(Label.ContentProperty, "<>");
            label.SetValue(Label.FontSizeProperty, 9d);
            label.SetValue(Label.PaddingProperty, new Thickness(0));
            label.SetValue(Label.FontFamilyProperty, new FontFamily("Verdana"));
            label.AddHandler(MouseLeftButtonDownEvent,  new MouseButtonEventHandler(DirectionThumbClick));

            grid.AppendChild(label);

            var ct = new ControlTemplate(typeof(Thumb)) { VisualTree = grid };

            s.Setters.Add(new Setter(MainWindow.TemplateProperty, ct));
            style = s;

        }
        else
        {
            if ((id == (int)TagId.Start) || (id == (int)TagId.FadeInEnd) || (id == (int)TagId.FadeInMag))
            {
                style = (Style)Application.Current.Resources["ThumbStyleLeft"];
            }
            else if (id == (int)TagId.Middle)
            {
                thumb.Height = 17;
                thumb.Width = 14;
                style = (Style)Application.Current.Resources["ThumbStyle"];
            }
            else
            {
                style = (Style)Application.Current.Resources["ThumbStyleRight"];
            }
        }
        thumb.Style = style;
        thumb.Opacity = 0.80;

        visualChildren.Add(thumb);
    }

    private void attachAdorners(Polygon polygon)
    {
        for (int i = 0; i <= polygon.Points.Count+1; i++)
        {
            var p = new Point();
            var thumb = new Thumb();
            Cursor tempCursor = null;

            if (i < polygon.Points.Count)
            {
                p = polygon.Points[i];
            }

            switch (i)
            {
                case (int)TagId.Start:
                case (int)TagId.End:
                    tempCursor = Cursors.SizeWE;
                    break;
                case (int)TagId.FadeOutStart:
                case (int)TagId.FadeInEnd:
                    tempCursor = Cursors.SizeNWSE;
                    break;
                case (int)TagId.FadeOutMag:
                case (int)TagId.FadeInMag:
                    tempCursor = Cursors.SizeNS;
                    break;
                case (int)TagId.Middle:
                    tempCursor = Cursors.Hand;
                    break;
                case (int)TagId.Direction:
                    tempCursor = Cursors.Arrow;
                    thumb.MouseRightButtonDown += this.DirectionThumbClick;
                    break;
            }

            BuildCorner(ref thumb, tempCursor, i);

            thumb.Tag = i;
            thumb.DragDelta += this.ThumbDragDelta;
            thumb.MouseEnter += this.ThumbOnMouseEnter;

            thumbArrray.Add(thumb);
        }
    }
 } 
```

这是我将拇指（装饰器）附加到多边形的代码：

```
private void Polygon_DoubleClicked(object sender, MouseButtonEventArgs e)
{
if (e.OriginalSource is Shape)
{
    UIElement uie = (UIElement)e.OriginalSource;
    Polygon p = e.OriginalSource as Polygon;

    if (p != null)
    {
        var tag = p.Tag as TimelineTag;
        //TimelineCollection is an ObservableCollection<>
        TimelineCollection collection = this.GetCollectionBasedOnTagLevel(tag);

        if (tag != null && ((TimelineItem)collection.ElementAt(tag.Id)).IsEditing)
        {
            AdornerLayer adornerlayer = AdornerLayer.GetAdornerLayer(uie);

            p.Stroke = new SolidColorBrush(Color.FromRgb(000, 000, 000));
            Adorner[] toRemoveArray = adornerlayer.GetAdorners(uie);
            if (toRemoveArray != null)
            {
                for (int x = 0; x < toRemoveArray.Length; x++)
                {
                    adornerlayer.Remove(toRemoveArray[x]);
                }
            }
            ((TimelineItem)collection.ElementAt(tag.Id)).IsEditing = false;
            selectedPolygon = null;
        }
        else
        {
            if (tag != null)
            {
                if (((TimelineItem)collection.ElementAt(tag.Id)).Type == TimelineItem.TimelineItemType.Axis)
                {
                    var sel = new AxisSelectionAdorners(
                        uie, (TimelineItem)collection.ElementAt(tag.Id), this.TimelineGrid);
                    p.Stroke = new SolidColorBrush(Color.FromRgb(255, 255, 255));

                    AdornerLayer adornerlayer = AdornerLayer.GetAdornerLayer(uie);
                    adornerlayer.Add(sel);
                }
                else if (((TimelineItem)collection.ElementAt(tag.Id)).Type
                            == TimelineItem.TimelineItemType.Square)
                {
                    var sel = new SquareSelectionAdorners(
                        uie, (TimelineItem)collection.ElementAt(tag.Id), this.TimelineGrid);
                    p.Stroke = new SolidColorBrush(Color.FromRgb(255, 255, 255));

                    AdornerLayer adornerlayer = AdornerLayer.GetAdornerLayer(uie);
                    adornerlayer.Add(sel);
                }
                ((TimelineItem)collection.ElementAt(tag.Id)).IsEditing = true;
                selectedPolygon = p;
            }
        }
    }
}
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T02:25:02.540

好吧，这不是一个完整的答案，但它符合我的需求。

我不需要深入研究多边形的数据，因为这些值不是数据值，它们是计算值。它们不需要在我的“数据层”中，它们可以是我的装饰类中的计算值。

我通过把

```
public String TestingLabel { get { return "test"; } } 
```

在我的`AxisSelectionAdorners`课堂上。然后像这样与 xaml 绑定：

```
{Binding TestingLabel, RelativeSource={RelativeSource AncestorType={x:Type Timeline:AxisSelectionAdorners}}} 
```

这是测试代码，可以根据需要连接转换器等。

# .net - 面向 .NET 4 客户端配置文件时类库中断

> ID：13574292
> 
> 赞同：1
> 
> 时间：2012-11-26T22:31:28.550
> 
> 标签：.net, visual-studio-2012, .net-assembly, class-library

我在 Visual Studio 2012 中有一个 (C#) .NET 4 Client Profile 项目的解决方案。今天我尝试添加另一个项目，也针对 .NET 4 Client Profile。我的新项目需要在我的解决方案中引用许多其他类库，但是对于每个出现此错误的类库都没有这样做：

> 当前目标框架“.NETFramework,Version=v4.0,Profile=Client”不包括引用程序集“log4net”所依赖的“System.Web, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a”。这导致引用的程序集无法解析。要解决此问题，请 (1) 更改此项目的目标框架，或 (2) 从项目中删除引用的程序集。

我引用的`System.Web`所有项目都不依赖于 .NET 4 Client Profile。事实上，上面粘贴的错误[`log4net`](http://logging.apache.org/log4net/)肯定不依赖于`System.Web`.

我已经多次清理并重建了我的整个解决方案，并且重新启动了 Visual Studio，但没有任何效果。关于如何构建我的项目的任何想法？

我将在那里抛出一条可能无用的信息：当我创建我的类库项目时，它自动针对 .NET 4.5，后来我将其更改为 .NET 4 Client Profile。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:35:00.413

log4net**确实**依赖于 System.Web。您可能没有使用该命名空间，但是该库需要它。如果您愿意自己构建项目，还有另一个[问题](https://stackoverflow.com/questions/6281542/why-does-log4net-1-2-10-require-system-web)是关于如何删除它。您还可以更改应用程序目标，如另一个[问题](https://stackoverflow.com/questions/1767253/log4net-with-net-4-0)中所述。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:45:53.567

发现了问题。

我使用 NuGet 安装了 log4net，而我的项目仍然针对 .NET 4.5。这导致我的 packages.config 文件被写入：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="log4net" version="2.0.0" targetFramework="net45" />
</packages> 
```

更改目标框架版本后从 NuGet 卸载并重新安装我的所有包导致 packages.config 被删除，并重写为：

```
<?xml version="1.0" encoding="utf-8"?>
<packages>
  <package id="log4net" version="2.0.0" targetFramework="net40-Client" />
</packages> 
```

现在它可以工作了。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-08T10:57:32.660

对我来说，这是可行的：在解决方案资源管理器中右键单击您的项目-> 卸载项目-> 然后右键单击该项目并编辑 yourprojectname.csproj 删除节点 TargetFrameworkProfile 中的“Client”值，因此它应该如下所示：

```
<TargetFrameworkProfile></TargetFrameworkProfile> 
```

重新加载您的项目然后重建，这应该可以解决问题

# mysql - Joomla 创建和调用多个视图

> ID：13574293
> 
> 赞同：0
> 
> 时间：2012-11-26T22:31:48.507
> 
> 标签：mysql, joomla, joomla-extensions

我是一名尝试构建 Joomla 组件的 wordpress 开发人员。

我的问题是，我试图了解如何在一个组件中合并多个视图。

例如，在一个视图中生成条目列表，然后在选择其中一个条目时转发到生成单个条目的另一个视图。

我对 php 的了解足以知道如何动态完成超链接，但我不知道如何在 Joomla 中声明两个单独的视图。每个视图都需要它自己的模型吗？（我认为不是。）这些有什么意义吗？

就像我说的，Joomla newb，非常感谢任何链接或参考。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T03:39:05.057

首先，每个视图都应该有自己的模型。至于转发到另一个视图，这应该在控制器中完成，但是应该使用 2 个单独的视图来完成。执行任务后，将其设置为重定向，如下所示：

```
function your_function(){
    $msg = JText::_( 'Operation Successful' );
    $this->setRedirect( 'index.php?option=com_hellowworld&view=hellowworldview', $msg );
} 
```

显然，您需要将**“com_hellowworld”**更改为组件的名称，将**“hellowworldview”**更改为要重定向到的视图的名称。

[查看为 Joomla 2.5 开发 MVC 组件](http://docs.joomla.org/Developing_a_Model-View-Controller_%28MVC%29_Component_for_Joomla!2.5)的文档。它将指导您详细了解开发组件的所有基础知识。

希望这可以帮助。

# listbox - 将行值预先附加到范围

> ID：13574296
> 
> 赞同：1
> 
> 时间：2012-11-26T22:31:56.543
> 
> 标签：listbox

我正在用值填充列表框，并且只是希望它们显示编号。我从一张纸上得到我的范围，只想偷偷溜进一个循环计数器，然后加载范围。原始数据表上不存在编号，所以我选择了这条路线。这是原始代码：

```
 Dim myArray As Variant
 numbldsec = Worksheets("bld").Cells(2, 1).Value
 myArray = Worksheets("bld").Range("A3:A" & numbldsec + 2)
 With Worksheets("plots")
  .ListBox1.List = myArray
  .ListBox1.IntegralHeight = False
  .ListBox1.IntegralHeight = True
  .ListBox1.Height = 45
  .ListBox1.Width = 69
  .ListBox1.Top = 0
  .ListBox1.Left = 1255.5
 End With 
```

所以我希望 myArray 每行有 2 个值....

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T01:19:14.907

啊，这有效：

```
Dim myArray As Variant
numbldsec = Worksheets("bld").Cells(2, 1).Value
myArray = Worksheets("bld").Range("A3:A" & numbldsec + 2).Value
For i = 1 To numbldsec ' pre-append radii with section numbers
 myArray(i, 1) = i & " " & myArray(i, 1)
Next i 
```

ETC...

# javascript - 在运行时配置 RequireJS

> ID：13574297
> 
> 赞同：3
> 
> 时间：2012-11-26T22:32:02.223
> 
> 标签：javascript, dependency-injection, requirejs

是否可以在运行时修改 requirejs（或任何 AMD 加载器）配置？

例如，我有两个日志模块：一个简单地包装 console.log，另一个记录到服务器。我希望模块只需要 log ( `require(['log'], function(log) { ... });`) 而不在乎它使用的是哪个记录器。

我可以在require的主配置中将'log'设置为一个包，这很好用。但我宁愿根据几个条件在 main.js 中设置此选项。就像是：

```
if( ... ) {
    require.config({
        packages: [
            { name: 'log', location: 'app/base/utils/consolelog' }
        ]
    });
} 
```

但这似乎不起作用。有没有办法做到这一点，或者我是否将 requirejs 的功能作为依赖注入框架？

干杯

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-14T19:21:34.333

任何依赖注入框架的一般工具是，您有一种简单的方法来配置它将在运行时解析哪种依赖容器，并且它只构建一次并在应用程序的生命周期内保持静态。

这样做是为了避免在应用程序中的某个时刻出现依赖关系可能发生变化的情况。有这样一种想法，即您的一个或所有应用程序源可能需要在它们使用来自容器的一些或任何依赖项之前请求许可，而不是仅仅在容器上运行，这是一个糟糕的想法，它有很多缺点。主要缺点是您知道，其中的任何引用都`accounts.all().each().withdraw(billing.MONTHLY_SERVICE_FEE).return()`可能在任何时候无明显原因地表现不同。如果`Accounts`更改并且`new Accounts().all()`没有返回任何帐户，或者`billing.MONTHLY_SERVICE_FEE`突然更改并且您向某些帐户收取 X 金额而向其他帐户收取 Y，那将是很糟糕的。

所以，简短的回答是否定的，你不能动态配置 RequireJS。RequireJS 将始终只加载一个模块一次，因此回调返回值始终是一个静态对象，或者如果您愿意，当您查看模块源时，您知道它`define()`只会在整个生命周期内被评估一次文档。

以下是几种非常简单的方法，用于在运行时抽象对象的特定实现。您只需创建几个带有回调的模块，这些模块返回具有相同公共接口但行为不同的对象，然后您可以静态或动态地解决要返回的对象。

```
// core/logging/base.js
define(function() {
  var static;
  var base =  {
      _log: undefined,
      create: function(name) {},
      // ..
  }

  return base;
});

// core/logging/client.js
define(function(['core/logging/base'], function(base) {
  var client = extend(base, {_log: console.log});
  return client;
});

// core/logging.js
define(['core/logging/server', 'core/logging/client', 'core/conf/settings'], 
  function(server, client, environment) {
  if(settings.LOGGER === 'server') {
    return server;
  } else {
    return client;
  }
};

// app/foo.js
define(['core/logging'], function(logging) {
  var log = logging.createLog('foo');
  log.info('bar');
  // > INFO foo: bar
  // or...
  // POST http://server/log {type: 2, name: 'foo', message: 'bar'}
} 
```

有几种方法可以设计这种支持，但是这种方法很简单，并且适用于您的特定情况。通常，您可以在模块中静态执行此解析，也可以通过 getter 函数在任何块中动态执行此解析，并且模块回调本身也可以返回构造函数或函数，而不仅仅是对象。

# android - 带有 Spinner 的 Android 导航下拉菜单

> ID：13574301
> 
> 赞同：1
> 
> 时间：2012-11-26T22:32:11.813
> 
> 标签：android, android-layout

我一直在尝试在操作栏中开发 ListNavigation 下拉菜单。操作栏中有 2 个下拉菜单。 ![操作栏导航下拉菜单](../Images/746f19a6042386be4f5da9228ed93949.png)

现在我想为每个微调器选择显示一个唯一的 TextView。就像如果用户`Fragment1`从左下拉菜单中选择并从右下拉菜单中选择“一个”，项目的项目符号列表将进入 TextView。如果用户`Fragment 1`从左侧下拉列表中选择，从右侧下拉列表中选择“两个”，则另一个项目符号列表将显示在 TextView 中。

基本上我使用“左下拉”作为主菜单和“右下拉”作为子菜单来显示主要是项目符号列表的文本。

现在我能够获得 GUI，但我对如何实现这一点有点困惑。

这是主要活动的代码：

```
 package com.temp.basicactionbar;     

    import java.util.ArrayList;  
    import java.util.HashMap;  
    import java.util.List;  
    import java.util.Map;  

    import android.app.ActionBar;  
    import android.app.ActionBar.OnNavigationListener;  

    import android.app.Activity;  
    import android.app.Fragment;  
    import android.app.FragmentTransaction;  
    import android.os.Bundle;  

    import android.view.Menu;  
    import android.view.MenuItem;  
    import android.view.View;  
    import android.widget.ArrayAdapter;  

    import android.widget.EditText;  
    import android.widget.SimpleAdapter;  
    import android.widget.Spinner;

public class MainActivity extends Activity  
{  
    private MenuItem mSpinnerItem = null;  
    private MenuItem mSearchItem = null;  

    private EditText mSearch = null;  

    @Override  
    public void onCreate( Bundle savedInstanceState ) {  
        super.onCreate( savedInstanceState );  

        ActionBar ab = getActionBar();  
        ab.setDisplayShowTitleEnabled( false ); 

        setListNavigation( ab );                
    }  

    @Override  
    protected void onSaveInstanceState( Bundle outState ) {  
        outState.putInt( "mode", getActionBar().getNavigationMode() );  
        super.onSaveInstanceState( outState );  
    }  

    @Override  
    public boolean onCreateOptionsMenu( Menu menu ) {  
        getMenuInflater().inflate( R.menu.main, menu );  
        mSpinnerItem = menu.findItem( R.id.menu_spinner );  
        setupSpinner( mSpinnerItem );  
        mSearchItem = menu.findItem( R.id.menu_search );  
        mSearchItem.setVisible(getActionBar().getNavigationMode() == ActionBar.NAVIGATION_MODE_TABS );  
        mSearch = (EditText) mSearchItem.getActionView().findViewById(R.id.search );  

        return true;  
    }  

    private void setListNavigation( ActionBar actionBar )  
    {  
        actionBar.setNavigationMode( ActionBar.NAVIGATION_MODE_LIST );  

        final List<Map<String, Object>> data = new ArrayList<Map<String, Object>>();  

        Map<String, Object> map = new HashMap<String, Object>();  

        map.put( "title", getString( R.string.frag1 ) );  
        map.put( "fragment",  
                Fragment.instantiate( this, Fragment1.class.getName() ) );  
        data.add( map );  

        map = new HashMap<String, Object>();  
        map.put( "title", getString( R.string.frag2 ) );  
        map.put( "fragment",  
                Fragment.instantiate( this, Fragment2.class.getName() ) );  
        data.add( map );  

        map = new HashMap<String, Object>();  
        map.put( "title", getString( R.string.frag3 ) );  
        map.put( "fragment",  
                Fragment.instantiate( this, Fragment3.class.getName() ) );  
        data.add( map );  

      map = new HashMap<String, Object>();  

        map.put( "title", getString( R.string.frag4 ) );  

        map.put( "fragment", Fragment.instantiate( this, Fragment4.class.getName() ) );  
        data.add( map );  

        SimpleAdapter adapter = new SimpleAdapter( this, data,  
                android.R.layout.simple_spinner_dropdown_item,  
                new String[] { "title" }, new int[] { android.R.id.text1 } );  
        actionBar.setListNavigationCallbacks( adapter,  
                new OnNavigationListener()  
                {  
                    @Override  
                    public boolean onNavigationItemSelected(int itemPosition, long itemId) {  
                        Map<String, Object> map = data.get( itemPosition );  
                        Object o = map.get( "fragment" );  
                        if (o instanceof Fragment)  
                        {  
                            FragmentTransaction tx = getFragmentManager()  
                                    .beginTransaction();  
                            tx.replace( android.R.id.content, (Fragment) o );  
                            tx.commit();  
                        }  
                        return true;  
                    }  
                } );  
        if (mSpinnerItem != null)  
        {  
            setupSpinner( mSpinnerItem );  
        }  
    }  

    private void setupSpinner( MenuItem item )  
    {  
        item.setVisible( getActionBar().getNavigationMode() == ActionBar.NAVIGATION_MODE_LIST );  
        View view = item.getActionView();  
        if (view instanceof Spinner)  
        {  
            Spinner spinner = (Spinner) view;  
            spinner.setAdapter( ArrayAdapter.createFromResource( this,  
                    R.array.spinner_data,  
                    android.R.layout.simple_spinner_dropdown_item ) );  
        }  
    }  

    public void delete( View v )  
    {  
        if (mSearch != null)  
        {  
            mSearch.setText( "" );  
        }  
    }  
} 
```

这是片段的代码

```
package com.stylingandroid.basicactionbar;  

import android.app.Fragment;  
import android.os.Bundle;  
import android.view.LayoutInflater;  
import android.view.View;  
import android.view.ViewGroup;  

public class Fragment2 extends Fragment  
{  
    @Override  
    public View onCreateView( LayoutInflater inflater, ViewGroup container,  
            Bundle savedInstanceState )  
    {  
        return inflater.inflate( R.layout.frag2, container, false );  
    }  
} 
```

这是每个片段的 XML 布局。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"  
                android:layout_width="match_parent"  
                android:layout_height="match_parent" >  

    <TextView  
            android:layout_width="wrap_content"  
            android:layout_height="wrap_content"  
            android:layout_centerHorizontal="true"  
            android:layout_centerVertical="true"  
            android:text="@string/frag3"/>  

</RelativeLayout> 
```

如果您想要完整的项目 zip，请告诉我，我会为您提供。谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T00:59:44.583

我所做的（我相信这是一个很好的方法），是使用`spinner.onItemSelectedListener()`

```
mySpinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {

        public void onItemSelected(AdapterView<?> adapter, View v,
                int i, long lng) {
            if (i == 0) {  // If the first item is selected (usually the default, unless you define another one in code) 
                // Do something here            
            } else if (i == 1) { // Second item selected
                // Do something else...
            } else if (i == 2) {
                // And so on...
            }
        }

        public void onNothingSelected(AdapterView<?> arg0) {
            // Do nothing
        }
    }); 
```

然后创建一个函数来使用新的值数组更新第二个微调器。

或者（简单，但可能不是最好的方法），您可以在 xml 布局中创建所有微调器，并使用第一个来决定显示第二个微调器中的哪一个（使用`setVisibility(View.GONE/View.VISIBLE)`）...

# 更新（后续评论）：

澄清一下 - 我在布局中创建所有微调器的意思是，您为每个备选列表创建一个微调器，但将`android:visibility`属性设置`gone`为除您希望用户最初看到的之外的所有其他列表。

然后你必须在你的布局中添加一些 xml，如下所示：

```
<spinner
    android:id="mySpinner1"
    ...
    // properties and stuff here
    ...
    android:visibility="visible" /> // You don't really need this line, since spinners are visible by default

<spinner
    android:id="mySpinner2"
    ...
    // properties and stuff here
    ...
    android:visibility="gone" /> // This line will make it look like the spinner was never there

<spinner
    android:id="mySpinner3"
    ...
    // properties and stuff here
    ...
    android:visibility="gone" /> 
```

对于您想要的每个微调器，并且当用户在第一个微调器中选择不同的东西时，您只需隐藏前一个并根据他/她的选择显示新的，使用`spinner1.setVisibility(View.VISIBLE);`

然后可以将前面示例中的代码修改为类似这样（如果你有 3 个微调器，如果你有更多或更少，你也必须为它们添加行）：

```
mySpinner.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {

        public void onItemSelected(AdapterView<?> adapter, View v,
                int i, long lng) {
            if (i == 0) {  // If the first item is selected (usually the default, unless you define another one in code) 
                        // Display the spinner you selected
                spinner1.setVisibility(View.VISIBLE);           
                        // Hide the rest
                        spinner2.setVisibility(View.GONE);
                        spinner3.setVisibility(View.GONE);
            } else if (i == 1) { // Second item selected
                        // Display the spinner you selected
                spinner2.setVisibility(View.VISIBLE);
                        // Hide the rest
                        spinner1.setVisibility(View.GONE);
                        spinner3.setVisibility(View.GONE);
            } else if (i == 2) {
                        // Display the spinner you selected
                spinner3.setVisibility(View.VISIBLE);
                        // Hide the rest
                        spinner1.setVisibility(View.GONE);
                        spinner2.setVisibility(View.GONE);
            }
        }

        public void onNothingSelected(AdapterView<?> arg0) {
            // Do nothing
        }
    }); 
```

请注意，这可能不是最好的方法 - 但是，它有效！;)

当然，您必须像所有其他要与之交互的视图一样检索微调器（通过使用`findItemById`），但您可能已经知道 - 祝您的项目好运。

# python - QSlider 和按键事件

> ID：13574302
> 
> 赞同：2
> 
> 时间：2012-11-26T22:32:15.110
> 
> 标签：python, pyqt, signals, qslider

我目前有一个使用鼠标滚动图像数据帧的 QSlider。我希望能够使用箭头键滚动一步（一帧）。

这是我当前的 sliderMoved 代码：

```
def sliderMoved(self,val):
    """
    retrieves the data array for the index value specified by the slider
    """

    if self.fileheader is None:
        print "[DEBUG] change_image_index(): self.fileheader is None"
        return

    idx=val
    self.x=idx
    frame=self.fileheader.frameAtIndex(idx)
    image=scipy.ndimage.filters.maximum_filter(frame.data, size=5)

    self.image.setImage(image, scale=((10.28/512),(2.486/96)))
    print self.image.imageItem.pixelSize()

    def keyPressEvent(self, event):
        if event.key()==Qt.Key_Right:
            frame=self.fileheader.frameAtIndex(idx+1) 
```

要将滑块连接到事件，我只需使用：

```
self.slider.sliderMoved.connect(self.sliderMoved)
self.slider.sliderMoved.connect(self.keyPressEvent) 
```

箭头键移动滑块，但它不会导致图像跳帧......我知道我在这里错过了一些愚蠢的东西......

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T09:50:25.257

尝试连接到滑块`valueChanged`而不是`sliderMoved`.

```
import sys
from PyQt4.QtCore import Qt
from PyQt4.QtGui import QApplication, QWidget, QSlider, QLabel, QVBoxLayout

class Widget(QWidget):
    def __init__(self, parent=None):
        QWidget.__init__(self, parent)

        self.v_layout = QVBoxLayout()

        self.slider = QSlider()
        self.slider.setOrientation(Qt.Horizontal)
        self.label = QLabel('Slider at position 0')

        self.v_layout.addWidget(self.label)
        self.v_layout.addWidget(self.slider)

        self.setLayout(self.v_layout)

        self.slider.valueChanged.connect(self.slider_moved)

    def keyPressEvent(self, event):
        if event.key()==Qt.Key_Right:
            self.slider.setValue(self.slider.value() + 1)
        elif event.key()==Qt.Key_Left:
            self.slider.setValue(self.slider.value() - 1)
        else:
            QWidget.keyPressEvent(self, event)

    def slider_moved(self, position):
        self.label.setText('Slider at position %d' % position)

if __name__ == '__main__':
  app = QApplication(sys.argv)

  widget = Widget()
  widget.show()

  sys.exit(app.exec_()) 
```

从您`keyPressEvent`那里，您可以更改滑块的值，这将导致连接到的任何功能`valueChanged`运行。

# model-view-controller - 路由到播放中的静态文件！框架2.0

> ID：13574303
> 
> 赞同：9
> 
> 时间：2012-11-26T22:32:25.740
> 
> 标签：model-view-controller, routing, playframework, playframework-2.0

出于 SEO 的目的，我试图让一些文件可以从[http://example.ca/robots.txt](http://example.ca/robots.txt)之类的 url 访问，但我遇到了一个奇怪的问题。这些文件可以通过 firefox 访问，但 chromium 和 google bot 无法获取这些文件！

我的路线：

```
# Map static resources from the /public folder to the /assets URL path
GET     /assets/*file               controllers.Assets.at(path="/public", file)

# Robots and Humans files
GET     /$file<(robots|humans).txt>             controllers.Assets.at(path="/public", file)

GET     /$file<MJ12_576CD562EFAFA1742768BA479A39BFF9.txt>                 controllers.Assets.at(path="/public", file) 
```

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2012-11-26T22:54:27.280

我不确定它是否会有所作为，但请尝试：

```
GET     /robots.txt             controllers.Assets.at(path="/public", file="robots.txt")
GET     /humans.txt             controllers.Assets.at(path="/public", file="humans.txt")

GET     /MJ12_576CD562EFAFA1742768BA479A39BFF9.txt                 controllers.Assets.at(path="/public", file="MJ12_576CD562EFAFA1742768BA479A39BFF9.txt") 
```

# git - 为什么 Heroku 认为一切都是最新的，而实际上并非如此？

> ID：13574304
> 
> 赞同：8
> 
> 时间：2012-11-26T22:32:28.417
> 
> 标签：git, heroku

在 Heroku 我有一个生产应用程序，我知道有一个登台应用程序：

```
$ heroku list
=== My Apps
testivate
testivate-staging 
```

我有每个遥控器：

```
$ git remote -v
heroku  git@heroku.com:testivate.git (fetch)
heroku  git@heroku.com:testivate.git (push)
staging git@heroku.com:testivate-staging.git (fetch)
staging git@heroku.com:testivate-staging.git (push) 
```

几天前，一个部署破坏了我的生产应用程序，所以我使用`heroku rollback`，最后创建了我现在使用的暂存应用程序，并将我的代码推送到暂存应用程序，大概是`git push staging master`. （这是几天前的事，但我很确定这就是我所做的。）

这一切现在都在我的登台应用程序上运行，所以我正在尝试将我的代码推送到我的生产应用程序。

然而，Heroku 一直告诉我我的生产应用程序已经是最新的：

```
$ git branch
* master

$ git status
# On branch master
nothing to commit (working directory clean)

$ git add .
$ git add -u
$ git commit -m "trying to commit"
# On branch master
nothing to commit (working directory clean)

$ git push heroku master
Everything up-to-date

$ git remote show staging
* remote staging
  Fetch URL: git@heroku.com:testivate-staging.git
  Push  URL: git@heroku.com:testivate-staging.git
  HEAD branch: master
  Remote branch:
    master tracked
  Local ref configured for 'git push':
    master pushes to master (up to date)

$ git remote show heroku
* remote heroku
  Fetch URL: git@heroku.com:testivate.git
  Push  URL: git@heroku.com:testivate.git
  HEAD branch: master
  Remote branch:
    master tracked
  Local ref configured for 'git push':
    master pushes to master (up to date) 
```

但是我知道 Heroku 是错误的，因为我的视图有一些清晰的变化，你可以在我的本地代码和登台服务器上看到这些变化，但在我的实时生产应用程序上看不到。

例如，比较在我的暂存应用程序中正确的“返回”链接[，](http://testivate-staging.herokuapp.com/login)但[在](http://www.testivate.com/login)我的生产应用程序中没有。

如何让 Heroku 根据需要更新我的生产应用程序？

谢谢，

史蒂文。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2014-03-09T23:18:10.707

你确定你指的是正确的分支吗？这是实际命令的语法：

```
git push heroku <the branch you wish to push>:<the branch on the heroku server you wish to push to> 
```

所以如果你习惯跑步

```
git push heroku master 
```

并且您结帐并提交到 master 以外的分支，运行`git push heroku master`将推送您未更改的**master**分支。相反，运行

```
git push heroku the_branch_i_changed:master 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-05-23T00:50:03.057

以下是我如何在相同的结果下犯了一个不同的错误（特定于 Ruby on Rails）：

我的本地站点显示了我的新徽标图像，heroku 站点显示了旧徽标图像。尽管如此，我仍然看到消息：“没有提交（工作目录干净）”。

我忘记在推送之前重新编译资产：

```
rake assets:precompile 
```

希望能节省别人我浪费的时间！

# c# - AppFabric 客户端虚拟机问题

> ID：13574306
> 
> 赞同：1
> 
> 时间：2012-11-26T22:32:46.103
> 
> 标签：c#, asp.net, vmware, virtual-machine, appfabric

我们有 AppFabric 缓存集群服务器，我可以使用我的开发机器作为客户端来使用它。为了模拟访问缓存集群服务器的不同 Web 服务器，我创建了一个 VMWare 虚拟机并安装了 Visual Studio 2010 和我的 Web 应用程序。从作为客户端的VM，当我尝试获取缓存时，出现以下错误...请帮助..谢谢..

**错误代码：子状态：暂时失败。请稍后重试。（指定的一个或多个缓存服务器不可用，可能是由于网络或服务器繁忙。对于本地缓存集群，还要验证以下条件。确保已为此客户端帐户授予安全权限，并检查 AppFabric所有缓存主机上的缓存服务都允许通过防火墙，而且服务器端的 MaxBufferSize 必须大于或等于客户端发送的序列化对象大小。）**

我注意到内部异常是

**服务器已拒绝客户端凭据。**

所以..经过一些研究..我将以下行添加到我的配置中

```
<securityProperties mode="None" protectionLevel="None" /> 
```

所以现在，我的 dataCacheClient 配置如下所示：

```
 <dataCacheClients>
    <dataCacheClient name="default">
    <localCache
    isEnabled="true"
    sync="NotificationBased"
    objectCount="10000"
    ttlValue="5" />
    <hosts>
      <host name="MyCacheClusterServerMachine" cachePort="22233" />
    </hosts>
    <securityProperties mode="None" protectionLevel="None" />
  </dataCacheClient> 
```

上述配置更改后..我收到以下错误：

**套接字连接被中止。这可能是由于处理您的消息时出错或远程主机超出接收超时，或者是潜在的网络资源问题造成的。本地套接字超时为**

我没有配置的代码如下。它在我的开发机器上作为客户端工作，而不是从虚拟机作为客户端工作。我能够从 VM 客户端 ping 缓存集群服务器。

```
class Program
{
    static void Main(string[] args)
    {

        var config = new DataCacheFactoryConfiguration();
        var servers = new List<DataCacheServerEndpoint>();
        servers.Add(new DataCacheServerEndpoint("MyCacheClusterServerMachine", 22233));
        config.Servers = servers;
        var factory = new DataCacheFactory(config);
        var cache = factory.GetDefaultCache();   <---- error here ********
        var key = "CachedObjectKey";
        var obj = cache[key];
        if (obj == null)
        {
            obj = "here is a string to cache";
            cache.Add(key, obj);
            Console.WriteLine("object was not in cache");
        }

        obj = cache.Get(key);

        Console.WriteLine(obj.ToString());
        Console.ReadLine();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T23:05:55.003

**服务器已拒绝客户端凭据。**

将 VM 添加到与我的开发机器相同的域后，此问题已得到解决。

# iphone - 昨天创建的 FQL 照片

> ID：13574308
> 
> 赞同：0
> 
> 时间：2012-11-26T22:32:46.810
> 
> 标签：iphone, ios, xcode, facebook, facebook-fql

我如何能够使用 FQL 获取一天前在 Facebook 上拍摄的所有照片？

目前，我有：

```
SELECT src_small FROM photo WHERE pid IN (SELECT pid FROM photo_tag WHERE subject=me()) AND created = previousDayTimeStamp 
```

但是，UNIX TIME 来自：

```
previousDay = [iOSCalender components:NSDayCalendarUnit fromDate:self.currentDate];
previousDay.day = -1;

previousDate = [iOSCalender dateByAddingComponents:previousDay toDate:self.currentDate options:0];

NSString *previousDayTimeStamp = [NSString stringWithFormat:@"%f",
                                 [previousDate timeIntervalSince1970]]; 
```

引用精确到秒的日期，FQL 中的“创建”字段也是如此。有没有办法可以缩短时间，以便最详细的信息是当天？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:09:31.303

只需计算到当天的小时数，以及到小时的分钟数，然后将其相反设置为`NSDateComponents`

```
//Note: this line changes as you'll need to get Hour and Minute units as well
previousDay = [iOSCalender components:(NSDayCalendarUnit | NSHourCalendarUnit | NSMinuteCalendarUnit) fromDate:currentDate];
previousDay.day = -1;
previousDay.hour = (previousDay.hour * -1);
previousDay.minute = (previousDay.minute * -1);

previousDate = [iOSCalender dateByAddingComponents:previousDay toDate:currentDate options:0];

NSString *previousDayTimeStamp = [NSString stringWithFormat:@"%f",
                                  [previousDate timeIntervalSince1970]]; 
```

# jquery - 用于 div 的 jQuery next()

> ID：13574311
> 
> 赞同：-1
> 
> 时间：2012-11-26T22:32:49.910
> 
> 标签：jquery

我正在尝试制作一个可滚动的 div，到目前为止我有这个：

```
<div id="topBar"> 
    <span>
        <a id='slink' class='trigger' href='#Sports'>Sport</a>
        <a id='elink' class='trigger'  href='#Entertainment'>Entertainment</a >
        <a id='mlink' class='trigger' href='#Military'>Military</a>

        <a id='mocklink' class='trigger' href='#MockUp'>MockUps</a>
        <button>Next</button>
    </span>
</div> 
```

好的，所以也许这有点简单，我知道我上次不是很清楚：

我将如何使用上面代码中的按钮从链接到链接？例如从运动到娱乐

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:36:23.913

`.next()`只是检索下一个 DOM 元素，它不会滚动到它。试试这个：

```
$div = $('.' + x).next().next();
$('body').animate({scrollTop:$div.position().top}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:38:34.637

也许你需要这个？

```
$("button").click(function(){
  $('a.trigger:visible').first().fadeOut(500);
}); 
```

# html - 剥离 HTML 字符并转换为纯文本

> ID：13574315
> 
> 赞同：0
> 
> 时间：2012-11-26T22:33:03.343
> 
> 标签：html, utf-8

好的，我已经搜索了几个小时！寻求答案。我发现的一切都没有完成我想要做的事情。

我们的客户喜欢将 HTML 网站的部分内容直接复制到 TinyMCE 所见即所得编辑器和纯文本文本区域或输入字段（用于标题）中。问题是所见即所得的字符是 HTML 而不是 RAW html。

这里只是一个例子。请记住，我想适应任何可能引发此错误的字符。

伴侣双重按摩 – 两个座位步入浴缸

中间的那个 DASH 有 html 实体`&ndash;`

直接复制 HTML 并将其粘贴到纯文本输入字段或文本区域中会引发错误

> 编码“UTF8”的无效字节序列：0x96

尝试提交到 UTF8 数据库时。

客户有可能复制商标、版权或保留符号。

我不只是想剥离它们。我想转换它们。

我试过各种转换器。我不想列出我去过的每个网站。

有任何想法吗？

更糟糕的情况是我只取这 4 个字符并将它们转换为任何字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:19:30.353

This is an encoding problem, not a problem with the HTML entities. When you copy data from HTML into a text box, the browser is not pasting in the entity like `&ndash;`, it's pasting in the actual character. It looks like the character you are getting is encoded in Windows-1252 (sometimes mistakenly referred to as ISO-8859-1). Since the database is expecting UTF-8, it can't handle this character.

There are a few possible reasons this might be happening. You didn't list what browser, language, web framework, or database you're using, so I'm going to offer a few suggestions, and hopefully one of them works. In general, it is best to use UTF-8 for your encoding at every stage; but if that't not possible, you either need to use a consistent encoding throughout all of the levels, or you need to convert.

Since your database is using UTF-8, I'll assume that's the encoding that you want to use. One thing to check is whether your pages are being served as UTF-8\. Check the headers on your HTTP response; there should be a `Content-Type: text/html; charset=utf-8` header. If that is wrong, missing, or missing the `charset=utf-8` part, then the browser may choose the wrong charset. One more thing that's good to do is add a `<meta charset=utf-8>` tag in your `<head>`; while this isn't necessary if you have the charset sent as part of the HTTP headers, it can help select the correct charset if the headers aren't present, or the document is loaded from a `file:` URL or the like, which doesn't have headers available.

While the browser should use the character set of the document when submitting the form, you can ensure that it submits using the correct charset by using the `accept-charset` attribute on the form: `<form accept-charset=utf-8>`. This will ensure that even if the page has the no charset set in the headers, forms will submit data as UTF-8.

Finally, even if all of that is correct, IE 5 through 8 will sometimes submit data in a different encoding than what the page is sent in, if the user has changed their encoding settings. To force it to send UTF-8 data, you can use a hidden form attribute that includes a character that cannot be encoded in a legacy encoding like Windows-1252\. Some versions of Ruby on Rails famously used a [snowman](http://intertwingly.net/blog/2010/07/29/Rails-and-Snowmen) (☃) for this purpose, though it was later changed to a checkmark (✓) to be less [puzzling](https://stackoverflow.com/questions/3222013/what-is-the-snowman-param-in-rails-3-forms-for). You can add a similar element to your form to force IE to use UTF-8: `<input name="_utf7" type="hidden" value="&#x2713;">`.

If the above suggestions don't work, please let us know what browser, programming language, web framework, and database you are using, and try to provide a [short, self-contained piece of sample code](http://sscce.org/) that demonstrates the problem.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:43:08.127

尝试这个。将“旧”数据转换为 Utf-8 需要一点努力。“旧”是指来自我们旧数据库的数据，可以是 UTF-8 或拉丁文，也可以是转义字符或非转义字符。结果始终是包含原始字符（而不是实体）的 Utf-8 字符串。

```
/**
 * Decodes HTML entities and converts the string to UTF-8 if it isn't UTF-8 already.
 * @param string $string LATIN-1 or UTF-8 string that may contain html_encoded characters.
 * @returns string
*/
private function tidyUtf8($string)
{
  // Check if the string contains any Latin characters that are not valid UTF-8.
  $utfCheckString = @iconv(
       'UTF-8',
       'UTF-8//IGNORE',
       $string
  );
  $isUtf = ($string === $utfCheckString);

  // If the string is not UTF-8, convert it to UTF-8
  if ($isUtf === false)
  {
       // Decode HTML entities to prevent double encoding later. 
       // Decode only the ones that are valid LATIN-1 characters.
       $string = html_entity_decode($string, ENT_QUOTES, 'ISO-8859-1');
       $string = iconv('ISO-8859-1', 'UTF-8', $string);
  }

  // Decode all HTML entities to prevent double encoding later. 
  // Include UTF-8 characters.
  $string = html_entity_decode($string, ENT_QUOTES, 'UTF-8');

  return $string;
} 
```

此功能旨在接受 UTF-8 和 LATIN-1(ISO-8859-1)。您可能不需要后者，因此您可以剥离此功能的一部分并使用：

```
html_entity_decode($string, ENT_QUOTES, 'UTF-8'); 
```

# excel - Outlook 2010 规则是否对从 Excel VBA 发送的邮件运行？

> ID：13574317
> 
> 赞同：5
> 
> 时间：2012-11-26T22:33:09.700
> 
> 标签：excel, rules, outlook-2010, vba

我在 Excel VBA 中有以下基本电子邮件代码：

```
Dim OutAppUser      As Object  
Dim OutMailUser     As Object  
Set OutAppUser = CreateObject("Outlook.Application")  
Set OutMailUser = OutAppUser.CreateItem(0)  
With OutMailUser  
            .To = Range("Ctl_Req_Email").Value  
            .CC = ""  
            .BCC = ""  
            .Subject = TempFNUser  
            .ReadReceiptRequested = False  
            .Body = userEmailText  
            .Attachments.Add FullTempNameUser  
            .Send    'Use .Send or .Display  
End With 
```

带有此宏的工作簿分布广泛，但电子邮件宏的实际驱动仅由少数人完成，现在其所在的电子邮件地址已更改。我为“发送邮件后”创建了一个 Outlook 规则，该规则为新电子邮件地址添加了一个“抄送”，作为将电子邮件重定向到外部的一种方式。该规则非常适用于手动测试电子邮件，但似乎不适用于从 Excel VBA 代码发送的电子邮件。是否需要在 VBA 代码上编码以发送电子邮件以允许运行规则？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T16:33:30.440

[http://www.slipstick.com/outlook/email/choosing-the-folder-to-save-a-sent-message-in/](http://www.slipstick.com/outlook/email/choosing-the-folder-to-save-a-sent-message-in/)

“VBA 不适用于使用其他应用程序中的文件、发送命令或 Windows 资源管理器中的发送到命令创建的消息。发送到命令使用 Simple MAPI，它**绕过了 Outlook 功能**。”

实际上并没有说规则，但您已经看到绕过规则。

如果您真的想使用规则，请让 Outlook 打开 Excel。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-26T12:00:37.173

为什么不使用新的宏创建一个新的电子表格：

```
Dim OutAppUser      As Object  
Dim OutMailUser     As Object  
Set OutAppUser = CreateObject("Outlook.Application")  
Set OutMailUser = OutAppUser.CreateItem(0)  
With OutMailUser  
            .To = Range("Ctl_Req_Email").Value  
            .CC = "New_email@address"  ' Only change to your code
            .BCC = ""  
            .Subject = TempFNUser  
            .ReadReceiptRequested = False  
            .Body = userEmailText  
            .Attachments.Add FullTempNameUser  
            .Send    'Use .Send or .Display  
End With 
```

人们将使用旧表格填写他们的数据，宏驱动程序将使用此代码来触发电子邮件。

# html - 如果浏览器版本选择器不起作用

> ID：13574318
> 
> 赞同：0
> 
> 时间：2012-11-26T22:33:13.740
> 
> 标签：html, css, browser

我下面的浏览器版本选择器没有调用我的 css 类......并且它在旧浏览器中不起作用......有人知道为什么，或者有类似的代码来帮助我解决这个问题？坦克...

```
<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js ie6 oldie"> <![endif]-->
<!--[if IE 7]>    <html class="no-js ie7 oldie"> <![endif]-->
<!--[if IE 8]>    <html class="no-js ie8 oldie"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class='no-js'>
<!--<![endif]-->

<head>
<meta charset='utf-8' />
<meta content='width=device-width, initial-scale=1.0' name='viewport' />
<meta content='' name='description' />
<meta content='' name='author' />
<title>Datacode</title>
<link href="./stylesheets/globals.css" media="screen" rel="stylesheet" 
type="text/css"    />
<link href="./stylesheets/typography.css" media="screen" rel="stylesheet" 
type="text/css" />
<link href="./stylesheets/grid.css" media="screen" rel="stylesheet" type="text/css" />
<link href="./stylesheets/ui.css" media="screen" rel="stylesheet" type="text/css" />
<link href="./stylesheets/forms.css" media="screen" rel="stylesheet" type="text/css" />
<link href="./stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<script src="./javascripts/jquery-1.7.1.js" type="text/javascript"></script>
<script src="./javascripts/terrific-1.1.1.js" type="text/javascript"></script>

<script src="./javascripts/app.js" type="text/javascript"></script>

<script type='text/javascript'>
  //<![CDATA[
    /* terrificjs bootstrap */
    (function($) {
        $(document).ready(function() {
            var $page = $('body');
            var config = {
              dependencyPath: {
                plugin: 'javascripts/'
              }
            };
            var application = new Tc.Application($page, config);
            application.registerModules();
            application.start();
        });
    })(Tc.$);
  //]]>
</script>

 </head> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:47:34.107

IE 类在哪个样式表中？您可以通过上面的路径在浏览器中查看样式表吗？

# c# - 将文本附加到文本文件的问题？

> ID：13574321
> 
> 赞同：-1
> 
> 时间：2012-11-26T22:33:21.680
> 
> 标签：c#, append, streamwriter

我正在尝试编写一个代码，用户在文本框中输入交付详细信息并将文本添加到 txt 文件（记事本 txt 文件）中。这是我的尝试，我得到了额外的一行“，”，为什么它不将文本框中的文本添加到文本文件中？

```
private void FrmDelivery_Load(object sender, EventArgs e)
{
    if (theDelivery != null)
    {
        txtCustomerName.Text = theDelivery.customerName;
        txtCustomerAddress.Text = theDelivery.customerAddress;
        txtArrivalTime.Text = theDelivery.arrivalTime;      
        using (StreamWriter writer = new StreamWriter("visits.txt", true)) //true shows that text would be appended to file
        {
            writer.WriteLine(theDelivery.customerName + ", " + theDelivery.customerAddress + ", " + theDelivery.arrivalTime);
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:46:30.817

问题是您正在写入`Form_Load`. 我假设您只想在用户更改某些内容时对其进行写入。

所以你可以处理一个保存按钮的点击事件来写入它：

```
private void FrmDelivery_Load(object sender, EventArgs e)
{
    if (theDelivery != null)
    {
        txtCustomerName.Text = theDelivery.customerName;
        txtCustomerAddress.Text = theDelivery.customerAddress;
        txtArrivalTime.Text = theDelivery.arrivalTime;      
    }
} 

private void btnSave_Click(object sender, System.EventArgs e)
{
    string line = string.Format("{0},{1},{2}{3}"
                , txtCustomerName.Text 
                , txtArrivalTime.Text  
                , theDelivery.arrivalTime
                , Environment.NewLine);
    File.AppendAllText("visits.txt", line);   
} 
```

[`File.AppendAllText`](http://msdn.microsoft.com/en-us/library/ms143356.aspx)只是写入文件的另一种（舒适）方式。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:35:18.640

..因为您没有将文本框的内容写入文件..您正在编写变量（似乎没有在任何地方初始化）：

固定的：

```
writer.WriteLine(txtCustomerName.Text + ", " + txtCustomerAddress.Text + ", " + txtArrivalTime.Text); // Fixed. 
```

此外，您在表单加载时执行此操作。此时文本框中是否有数据（或已`theDelivery`初始化）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:53:58.403

Delivery 对象实例的 customerName、customerAddress 和到达时间字符串属性都初始化为空字符串。您应该在写入文件之前设置一些字符串。

# unix - 具有执行权限的 Unix 搜索目录

> ID：13574329
> 
> 赞同：0
> 
> 时间：2012-11-26T22:34:00.193
> 
> 标签：unix, permissions, find

我只对一个目录具有执行权限，我相信这意味着我可以在该目录中搜索特定的文件名。但是，当我在目录中并执行以下操作时：

```
 find . -name "file.txt" 
```

我收到目录的权限被拒绝错误。我应该使用哪个命令？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:38:15.627

`find`试图读取目录，而您说您没有读取目录的权限。目录的搜索权限意味着如果您知道文件的名称，则您有权访问文件（当然，取决于文件本身的权限）。目录没有读取权限意味着您无法找出目录中的文件，除非通过反复试验或外部授予的知识。

你想对文件做什么？

*   `cat file.txt`应该管用。
*   `ls -l file.txt`应该管用。
*   `cp file.txt /some/where/readable`应该管用。

# uitableview - 为什么手动重用的 UITableViewCell 在重新加载行时会消失？

> ID：13574334
> 
> 赞同：5
> 
> 时间：2012-11-26T22:34:30.680
> 
> 标签：uitableview, reuseidentifier

如果我`UITableViewCell`使用reuseidentifier=`nil`作为ivar 保持一个固定值并为特定行返回此实例，然后专门使用重新加载此行`[tableView reloadRowsAtIndexPaths:withRowAnimation:]`，则行内容会消失（或有时会闪烁）。当我滚动并返回时，它再次变得可见。`[tableView reloadData]`另一方面，如果我这样做，它不会消失。

*   为什么当我重新加载行时它会消失？
*   为什么不呢，当我重新加载整个表时？

这是一个示例项目：[https ://github.com/hannesoid/HOTableViewTests](https://github.com/hannesoid/HOTableViewTests)

我在 iOS 6 上对此进行了测试。 *我知道通常不建议以这种方式手动重用 UITableViewCell（没有重用标识符和出队），但在一些相当静态的场景中它会简化事情。*

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-23T19:49:22.407

UITableView 由 Apple 优化，因此它使用相当少量的内存，但在单元格出现在屏幕上时仍然具有良好的性能。当您执行此类非标准操作并规避优化时，您会将整台机器弄得一团糟。这是我的建议。如果您现在将一个特定的行作为实例变量保存，为什么不简单地尝试为它的重用标识符赋予一个唯一的名称呢？让套件解决它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-24T05:40:44.340

使`reuseIdentifier`等于不是一个好习惯`nil`。始终`reuseIdentifier`使用字符串/名称进行初始化。通过`cellForRowAtIndexPath`查看它们的`reuseIdentifiers`. 如果在现有的 中找到缓存的单元格`reuseIdentifier`，它将直接显示这些单元格，而不分配和初始化新的单元格。制造它`nil`会导致问题。所以，制作`reuseidentifier=@"cell"`或你喜欢的东西。这将解决您的问题。

# r - 语料库中的单词数

> ID：13574341
> 
> 赞同：4
> 
> 时间：2012-11-26T22:34:50.053
> 
> 标签：r, text-mining

我正在寻找一种方法来找到文本中最常见的单词，并且我正在使用 R。最常见的意思是它们的低频是语料库中单词的 1% 的单词。所以我需要计算语料库中的单词数。

到目前为止，这是我的代码：

```
#!/usr/bin/Rscript
library('tm')
library('wordcloud')
library('RColorBrewer')
twittercorpus <- system.file("stream","~/txt", package = "tm")
twittercorpus <- Corpus(DirSource("~/txt"),
                        readerControl=list(languageEl = "en"))
twittercorpus <- tm_map(twittercorpus, removeNumbers)
twittercorpus <- tm_map(twittercorpus,tolower)
twittercorpus <- tm_map(twittercorpus,removePunctuation)
my_stopwords <- c(stopwords("SMART"))
twittercorpus <-tm_map(twittercorpus,removeWords,my_stopwords)
mydata.dtm <- TermDocumentMatrix(twittercorpus) 
```

我需要类似的东西：

```
freqmatrix <-findFreqTerms(mydata.dtm, lowfreq=rowSums(mydata.dtm)/100) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-27T00:02:23.997

如果您查看`str(mydata.dtm)`有一个名为`nrow`. 使用它：

```
freqmatrix <- findFreqTerms(mydata.dtm, lowfreq=mydata.dtm$nrow/100) 
```

# jquery - jQuery 在悬停时显示 div - 在鼠标悬停时隐藏 div

> ID：13574342
> 
> 赞同：3
> 
> 时间：2012-11-26T22:34:58.977
> 
> 标签：jquery, css

我有一个锚标记，当它悬停时，我希望显示某个 div（“标记”）。div 不在锚标签内。

HTML如下：

```
 <a href="#" class="mark"></a>
          <div class="icontent">
                <p>
                lorem ipsum dolor sit amet......
                 </p>
           </div> 
```

当鼠标悬停在“.mark”上时，应该会出现“.icontent”。当鼠标离开时，“.icontent”应该再次隐藏。是否也可以为其添加 1 秒过渡？

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:40:05.130

hover() 在这里可以很好地工作：

```
$('.mark').hover(function() {$('.icontent').show(1000)}, function() {$('.icontent').hide(1000)}); 
```

[http://api.jquery.com/hover/](http://api.jquery.com/hover/)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T22:38:20.400

```
$(".mark").on({
    mouseover: function() {
        $(".icontent").stop().show(1000);
    },

    mouseout: function() {
        $(".icontent").stop().hide(1000);
    }
}) 
```

[**演示**](http://jsfiddle.net/pz2Rw/9/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-11-26T22:40:30.733

给你

HTML

```
<a href="#" class="mark">hover anchor</a>
<div class="icontent">
  <p>
    lorem ipsum dolor sit amet......
  </p>
</div> 
```

JS

```
(function(){
  var del = 200;
  $('.icontent').hide().prev('a').hover(function(){
    $(this).next('.icontent').stop('fx', true).slideToggle(del);
  });
})(); 
```

示例 [http://jsbin.com/evehat/1/edit](http://jsbin.com/evehat/1/edit)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T22:40:56.067

```
$(".mark").hover(function () {
   if (!$(".icontent").is(":animated")) {
      $(".icontent").show('slow');
   }
}, function () {
   $(".icontent").stop().hide('slow');
});​ 
```

您也可以单独使用`mouseover`和`mouseout`。添加和添加是为了防止`:animated`聪明`.stop`人反复将鼠标移出锚点。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T22:40:04.990

```
$('.mark').hover(function()      {$('.icontent')).fadeIn(1000)},
function(){$('.icontent').fadeOut(1000)}); 
```

这应该工作:)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-11-26T22:40:56.830

```
$(".mark").mouseover(function() {
    $('.icontent').fadeIn(1000);
}).mouseout(function(){
    $('.icontent').fadeOut(1000);
}); 
```

# c++ - 使用结构中的变量定义数组大小

> ID：13574345
> 
> 赞同：0
> 
> 时间：2012-11-26T22:35:00.093
> 
> 标签：c++, struct, dynamic-memory-allocation

我之前尝试过用 C++ 中的变量定义数组大小，虽然我不完全理解动态内存的概念，但我让它工作了。但是，在这种情况下，我不知道如何对数组“点”做同样的事情。

```
num=50;
struct pos
{
double x;
};

 struct pos point[num]; 
```

有什么明显的我忽略的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:38:37.880

这些类型的数组大小必须是编译时常量，因此编译器知道要保留多少内存。

```
int count = 50;
int arr[count] // error!

static const int count = 50;
int arr[count]; // OK! 
```

另一个选项是动态分配的内存，其中大小在运行时是已知的。

```
int count = 50;
int* arr = new int[count];
delete [] arr; 
```

但是，通常您不想自己处理原始指针和内存分配，而应该更喜欢：

```
#include <vector>

int count = 50;
std::vector<int> arr(count); 
```

这也适用于您提供的任何自定义类型，它们是可复制的（提示：您的示例`pos`结构是可复制的）：

```
#include <vector>

int count = 50;
std::vector<pos> arr(count);

arr[0].x = 1;
// ... etc
arr[49].x = 49; 
```

`std::vector`有丰富的界面，所有的细节[都可以在这里找到](http://www.cplusplus.com/reference/stl/vector/)

# c# - 我无法在 C# 中控制 cmd 的实例

> ID：13574348
> 
> 赞同：1
> 
> 时间：2012-11-26T22:35:11.723
> 
> 标签：c#, cmd, instance, handle

所以我有这个代码：

```
process = new Process();
process.StartInfo.FileName = @"C:\windows\system32\cmd.exe";
process.StartInfo.UseShellExecute = false;
process.StartInfo.CreateNoWindow = false;
process.StartInfo.RedirectStandardInput = true;
process.Start();
streamWriter = process.StandardInput; 
```

当我运行该应用程序时，会出现一个 cmd 控制台，但它显示“句柄无效”。如果我尝试使用 streamWriter 写一些东西，我每次尝试都会收到大约四次无效句柄的消息。

开始时正常的文案微软的东西也不见了。

可能是什么问题呢？

如果我尝试使用 Windows Shell，而不是重定向流只是创建一个 cmd 进程，则会出现一个正常的 cmd 控制台，我可以毫无问题地输入它。

编辑：

```
private void Button_Click_1(object sender, RoutedEventArgs e)
{
process = new Process();
process.StartInfo.FileName = @"C:\windows\system32\cmd.exe";
process.StartInfo.UseShellExecute = false;
process.StartInfo.WindowStyle = ProcessWindowStyle.Normal;
process.StartInfo.CreateNoWindow = false;
process.StartInfo.RedirectStandardInput = true;
process.StartInfo.RedirectStandardOutput = true;
process.Start();
sw = process.StandardInput;
sr = process.StandardOutput;

sw.WriteLine("echo 123");

MessageBox.Show(sr.ReadToEnd());

process.WaitForExit();
} 
```

所以现在弹出一个空白的cmd，我必须手动关闭它，然后我才能从中获取信息，但是我不想丢失这个cmd实例，所以我能做些什么来让它保持“活着”并保持跟它“说话”？

编辑#2 所以“活着”是指我怎样才能做到，所以我不必关闭它来获取我的信息，我必须使用线程吗？因为在我看来 GUI 正在挂起/等待 cmd 关闭：/

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:18:48.367

A WPF application doesn't have a console window. You need to create one if you want to have one.

An existing thread on this is below:

[How to write to a console window from a windows application?](https://stackoverflow.com/questions/9943040/how-to-write-to-a-console-window-from-a-windows-application)

# coffeescript - 为 CoffeeScript 类创建命名空间

> ID：13574352
> 
> 赞同：3
> 
> 时间：2012-11-26T22:35:31.113
> 
> 标签：coffeescript

如何为使用 CoffeeScript 编写的类创建命名空间？

例如，我有树类**Aa**、**Bb**和**Cc**。我希望它们插入到全局可安全命名空间 - **MyClasses**中，允许跨它们通信并在 jasmine-node 中使用它们。

```
class MyClasses.Aa
 @someProp: true

class MyClasses.Bb
 @someProp2: false

class MyClasses.Cc
 @doSomeStuff: -> MyClasses.Aa.someProp = false 
```

我知道，我可以将它们注入一个文件并编译，但我想要一个类=一个文件。

请问我该怎么做？谢谢！

编辑：我试过这种方式，但我认为它不好，但它适用于浏览器和 jasmine-node

```
root = exports ? this
root.MyClasses = root.MyClasses ? {}

root.MyClasses.Aa = 

  class Aa 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T19:46:46.363

**使用 RequireJS。**

在一个名为“my-classes.coffee”的文件中，定义命名空间。

```
define [], ->
  # You need this if you want it to work in multiple environments.
  # Otherwise just use `window` to work in the browser.
  root = exports ? this

  root.MyClasses = {} 
```

您可以在另一个名为“aa.coffee”的文件中定义您的课程。

```
define ['my-classes'], (MyClasses) ->

  class MyClasses.Aa
    @someProp: true 
```

另一个文件：

```
define ['my-classes'], (MyClasses) ->

  class MyClasses.Bb
    @someProp2: false 
```

现在，当您需要时，它应该导出`MyClasses`包括`MyClasses.Aa`.

```
require ['my-classes', 'aa'], (MyClasses, _) ->
  console.log MyClasses.Aa.someProp 
```

这样做的一个问题是，您不能只依赖`require`语句中的“my-classes”。如果你这样做，`MyClasses.Aa`将是未定义的。但是你也不能只依赖“aa”，因为“aa”除了添加到 MyClasses 之外不会导出任何东西。在上面的代码片段中，`MyClasses.Bb`是未定义的，因为我没有明确依赖它。这就是为什么许多人要么使用一个巨大的文件，要么复制重新导出命名空间的样板。

如果有人知道如何解决这个问题，请告诉我。

我个人觉得 RequireJS 使用起来很复杂，并且有很多不同的方法来设置它。我将它与 jasmine 一起使用的一种方法是使用蛋糕任务将我的 CoffeeScript 预编译为 JavaScript，然后拥有这样的规范文件。

```
requirejs = require('requirejs')
# Set the baseURL to your compiled JS dir.
requirejs.config { baseUrl: __dirname + '/../lib' }

requirejs ['my-classes', 'aa'], (MyClasses, _) ->

  describe "someProp", ->
    it "should be true", ->
      expect(MyClasses.Aa.someProp).toEqual true 
```

这可能不是最好的方法，但我能够使用它在浏览器、Node 服务器和 jasmine-node 测试中运行模块。我还看到有些人使用[自定义运行](http://blog.rjzaworski.com/2012/06/jasmine-coffeescript-and-require-js/)器来避免其规范文件中的样板。

如果您不想使用 RequireJS，您可能会发现[这个问题](https://stackoverflow.com/questions/8730859/classes-within-coffeescript-namespace)很有帮助。它通过使用[CoffeeScript 常见问题解答](https://github.com/jashkenas/coffee-script/wiki/FAQ)`namespace`中定义的函数来工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-22T10:54:42.160

Coffescript wiki 中有一个建议的解决方案：

来自[https://github.com/jashkenas/coffee-script/wiki/FAQ](https://github.com/jashkenas/coffee-script/wiki/FAQ)：

```
# Code:
#
namespace = (target, name, block) ->
  [target, name, block] = [(if typeof exports isnt 'undefined' then exports else window), arguments...] if arguments.length < 3
  top    = target
  target = target[item] or= {} for item in name.split '.'
  block target, top

# Usage:
#
namespace 'Hello.World', (exports) ->
  # `exports` is where you attach namespace members
  exports.hi = -> console.log 'Hi World!'

namespace 'Say.Hello', (exports, top) ->
  # `top` is a reference to the main namespace
  exports.fn = -> top.Hello.World.hi()

Say.Hello.fn()  # prints 'Hi World!' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T01:50:13.820

`-b`您可以使用删除安全包装器的标志编译您的 CoffeeScript 文件。或者用你已经拥有的东西将你的类暴露在全局范围内

### 一杯咖啡

```
root = exports ? window
MyClasses = root.MyClasses = root.MyClasses ? {}

class MyClasses.Aa
  @someProp: true 
```

### b.咖啡

```
# same header as a.coffee
class MyClasses.Bb
  @someProp2: false 
```

### 咖啡

```
# same header as a.coffee
class MyClasses.Cc
  @doSomeStuffWith: (someClass)-> 
    # pass a class to the method instead of just 
    # modifying another class within the same scope
    someClass.someProp = false 
```

重复其他课程。在第一行中，我发现`window`比 更明确`this`，第二行还允许您将类附加到`MyClasses`没有长序列的命名空间。

在浏览器中，您的类将位于全局对象内`MyClasses`

在 node.js 中，您可以像这样使用它们（恕我直言，这有点冗长）：

```
var Aa = require("./a").MyClasses.Aa,
    Bb = require("./b").MyClasses.Bb,
    Cc = require("./c").MyClasses.Cc;

console.log(Aa.someProp)  // true
console.log(Bb.someProp2) // false

Cc.doSomeStuffWith(Aa)

console.log(Aa.someProp) // false 
```

pd：我没有用node-jasmine检查过。

# dreamweaver - 您可以在 Dreamweaver CS3 的属性窗格中隐藏 CSS 类吗？

> ID：13574353
> 
> 赞同：3
> 
> 时间：2012-11-26T22:35:50.657
> 
> 标签：dreamweaver

有没有办法隐藏或限制属性窗格中样式下拉框中可用的 CSS 类？

我有几个用于页眉、页脚、导航或其他专业领域的类，不应该让寻找少数通用类的人感到混乱。恐怕几个月后我会再次看到 class="Style22" 。

Dreamweaver CS3 是必需的，商店中的其他人使用设计视图 (WYSIWYG)。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T03:38:02.470

在 Dreamweaver 中没有办法限制这一点。但是，可以通过这种方式限制 Contribute，如果您支持非设计人员/开发人员最终用户，您可能需要对此进行研究。

# java - 如何过滤 Hadoop map/reduce 作业输出文件中的键或值？

> ID：13574356
> 
> 赞同：4
> 
> 时间：2012-11-26T22:36:01.813
> 
> 标签：java, hadoop, mapreduce, outputformat

通常，Hadoop map/reduce 作业会生成写入作业输出文件的键值对列表（使用[`OutputFormat`](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/mapreduce/OutputFormat.html)类）。很少有键和值都有用，通常键或值都包含必需的信息。

是否有一个选项（在客户端）来抑制输出文件中的键或抑制输出文件中的值？如果我只想为一项特定工作执行此操作，我可以创建[`OutputFormat`](http://hadoop.apache.org/docs/current/api/org/apache/hadoop/mapreduce/OutputFormat.html)忽略键或值的新实现。但我需要可重复用于更多工作的通用解决方案。

**编辑：**可能不清楚我所说的“我需要可重复用于更多工作的通用解决方案”是什么意思。让我举例说明一下：

假设我有很多准备好的`Mapper`课程。我想将它们组合到不同的“作业”并在不同的输入文件上运行这些“作业”以生成各种输出文件。在某些情况下（对于某些工作）我需要抑制键，因此它们不会写入输出文件。我不想更改我的映射器、输出格式的缩减器的代码——它们太多了。我需要一些不需要更改给定映射器、reducer 或输出格式的代码的通用解决方案。我怎么做？`Reducer``OutputFormats`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:40:08.717

没有理由不能将您在 hadoop 流程中的最后一步配置为将 a 写入`NullWritable`键或值。您只是不应该期望该文件在任何后续的 map reduce 步骤中都有很大的用处。

# vb.net - 设置系统代理

> ID：13574357
> 
> 赞同：1
> 
> 时间：2012-11-26T22:36:05.763
> 
> 标签：vb.net, proxy

我在哪里可以找到在 Visual Basic .NET 中设置系统代理的方法。

我想对代理服务器进行检查。然后将系统代理设置为该代理服务器。

我似乎找不到任何有关于这样做的信息的地方。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T12:46:21.723

下面的类将设置系统代理。我不是自己写的，而且我一生都记不起我在哪里找到它：

```
Imports System
Imports System.Runtime.InteropServices

Public Class IEProxy

Public Enum Options

    INTERNET_PER_CONN_FLAGS = 1

    INTERNET_PER_CONN_PROXY_SERVER = 2

    INTERNET_PER_CONN_PROXY_BYPASS = 3

    INTERNET_PER_CONN_AUTOCONFIG_URL = 4

    INTERNET_PER_CONN_AUTODISCOVERY_FLAGS = 5

    INTERNET_OPTION_REFRESH = 37

    INTERNET_OPTION_PER_CONNECTION_OPTION = 75

    INTERNET_OPTION_SETTINGS_CHANGED = 39

    PROXY_TYPE_PROXY = &H2

    PROXY_TYPE_DIRECT = &H1

End Enum

<StructLayout(LayoutKind.Sequential)> _
Private Class FILETIME

    Public dwLowDateTime As Integer

    Public dwHighDateTime As Integer

End Class

<StructLayout(LayoutKind.Explicit, Size:=12)> _
Private Structure INTERNET_PER_CONN_OPTION

    <FieldOffset(0)> Dim dwOption As Integer

    <FieldOffset(4)> Dim dwValue As Integer

    <FieldOffset(4)> Dim pszValue As IntPtr

    <FieldOffset(4)> Dim ftValue As IntPtr

    Public Function GetBytes() As Byte()

        Dim b(12) As Byte

        BitConverter.GetBytes(dwOption).CopyTo(b, 0)

        Select Case dwOption

            Case (Options.INTERNET_PER_CONN_FLAGS)

                BitConverter.GetBytes(dwValue).CopyTo(b, 4)

            Case (Options.INTERNET_PER_CONN_PROXY_BYPASS)

                BitConverter.GetBytes(pszValue.ToInt32()).CopyTo(b, 4)

            Case (Options.INTERNET_PER_CONN_PROXY_SERVER)

                BitConverter.GetBytes(pszValue.ToInt32()).CopyTo(b, 4)

        End Select

        Return (b)

    End Function

End Structure

<StructLayout(LayoutKind.Sequential, CharSet:=CharSet.Auto)> _
Private Class INTERNET_PER_CONN_OPTION_LIST

    Public dwSize As Integer

    Public pszConnection As String

    Public dwOptionCount As Integer

    Public dwOptionError As Integer

    Public pOptions As IntPtr

End Class

<StructLayout(LayoutKind.Sequential)> _
Private Class INTERNET_PROXY_INFO

    Public dwAccessType As Integer

    Public lpszProxy As IntPtr

    Public lpszProxyBypass As IntPtr

End Class

Private Const ERROR_INSUFFICIENT_BUFFER = 122

Private Const INTERNET_OPTION_PROXY = 38

Private Const INTERNET_OPEN_TYPE_DIRECT = 1

<DllImport("wininet.dll")> _
Private Shared Function InternetSetOption(ByVal hInternet As IntPtr, _
               ByVal dwOption As Integer, _
               ByVal lpBuffer As INTERNET_PER_CONN_OPTION_LIST, _
               ByVal dwBufferLength As Integer) As Boolean

End Function

<DllImport("kernel32.dll")> _
Private Shared Function GetLastError() As Integer

End Function

Public Function SetProxy(ByVal proxy_full_addr As String) As Boolean

    Dim bReturn As Boolean

    Dim list As New INTERNET_PER_CONN_OPTION_LIST

    Dim dwBufSize As Integer = Marshal.SizeOf(list)

    Dim opts(3) As INTERNET_PER_CONN_OPTION

    Dim opt_size As Integer = Marshal.SizeOf(opts(0))

    list.dwSize = dwBufSize

    list.pszConnection = ControlChars.NullChar

    list.dwOptionCount = 3

    'set flags

    opts(0).dwOption = Options.INTERNET_PER_CONN_FLAGS

    opts(0).dwValue = Options.PROXY_TYPE_DIRECT Or Options.PROXY_TYPE_PROXY

    'set proxyname

    opts(1).dwOption = Options.INTERNET_PER_CONN_PROXY_SERVER

    opts(1).pszValue = Marshal.StringToHGlobalAnsi(proxy_full_addr)

    'set override

    opts(2).dwOption = Options.INTERNET_PER_CONN_PROXY_BYPASS

    opts(2).pszValue = Marshal.StringToHGlobalAnsi("local")

    Dim b(3 * opt_size) As Byte

    opts(0).GetBytes().CopyTo(b, 0)

    opts(1).GetBytes().CopyTo(b, opt_size)

    opts(2).GetBytes().CopyTo(b, 2 * opt_size)

    Dim ptr As IntPtr = Marshal.AllocCoTaskMem(3 * opt_size)

    Marshal.Copy(b, 0, ptr, 3 * opt_size)

    list.pOptions = ptr

    'Set the options on the connection

    bReturn = InternetSetOption(IntPtr.Zero, Options.INTERNET_OPTION_PER_CONNECTION_OPTION, list, dwBufSize)

    If Not bReturn Then

        Debug.WriteLine(GetLastError)

    End If

    'Notify existing Internet Explorer instances that the settings have changed

    bReturn = InternetSetOption(IntPtr.Zero, Options.INTERNET_OPTION_SETTINGS_CHANGED, Nothing, 0)

    If Not bReturn Then

        Debug.WriteLine(GetLastError)

    End If

    'Flush the current IE proxy setting

    bReturn = InternetSetOption(IntPtr.Zero, Options.INTERNET_OPTION_REFRESH, Nothing, 0)

    If Not bReturn Then

        Debug.WriteLine(GetLastError)

    End If

    Marshal.FreeHGlobal(opts(1).pszValue)

    Marshal.FreeHGlobal(opts(2).pszValue)

    Marshal.FreeCoTaskMem(ptr)

    Return (bReturn)

End Function

Public Function DisableProxy() As Boolean

    Dim bReturn As Boolean

    Dim list As New INTERNET_PER_CONN_OPTION_LIST

    Dim dwBufSize As Integer = Marshal.SizeOf(list)

    Dim opts(0) As INTERNET_PER_CONN_OPTION

    Dim opt_size As Integer = Marshal.SizeOf(opts(0))

    list.dwSize = dwBufSize

    list.pszConnection = ControlChars.NullChar

    list.dwOptionCount = 1

    opts(0).dwOption = Options.INTERNET_PER_CONN_FLAGS

    opts(0).dwValue = Options.PROXY_TYPE_DIRECT

    Dim b(opt_size) As Byte

    opts(0).GetBytes().CopyTo(b, 0)

    Dim ptr As IntPtr = Marshal.AllocCoTaskMem(opt_size)

    Marshal.Copy(b, 0, ptr, opt_size)

    list.pOptions = ptr

    'Set the options on the connection

    bReturn = InternetSetOption(IntPtr.Zero, Options.INTERNET_OPTION_PER_CONNECTION_OPTION, list, dwBufSize)

    If Not bReturn Then

        Debug.WriteLine(GetLastError)

    End If

    'Notify existing Internet Explorer instances that the settings have changed

    bReturn = InternetSetOption(IntPtr.Zero, Options.INTERNET_OPTION_SETTINGS_CHANGED, Nothing, 0)

    If Not bReturn Then

        Debug.WriteLine(GetLastError)

    End If

    'Flush the current IE proxy setting

    bReturn = InternetSetOption(IntPtr.Zero, Options.INTERNET_OPTION_REFRESH, Nothing, 0)

    If Not bReturn Then

        Debug.WriteLine(GetLastError)

    End If

    Marshal.FreeCoTaskMem(ptr)

    Return (bReturn)

End Function

End Class 
```

使用：

```
Dim sProxy As New IEProxy
'set
sProxy.SetProxy("123.2.2.123:8080") 'Returns True if successful
'disable
sProxy.DisableProxy 'Returns True if successful 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T01:32:49.077

您是否检查[过在 C# 中以编程方式设置浏览器代理设置](https://stackoverflow.com/questions/197725/programmatically-set-browser-proxy-settings-in-c-sharp)？

它涵盖了更改应用程序的全局代理以及更改系统设置。

# python - 使用numpy在python中有条件地返回列

> ID：13574363
> 
> 赞同：1
> 
> 时间：2012-11-26T22:36:29.897
> 
> 标签：python, csv, numpy

我在名为 test.csv 的文件中有以下数据集：

```
ID,ENROLLMENT_DATE,TRAINER_MANAGING,TRAINER_OPERATOR,FIRST_VISIT_DATE
1536D,12-Feb-12,"06DA1B3-Lebanon NH",,15-Feb-12
F15D,18-May-12,"06405B2-Lebanon NH",,25-Jul-12
8096,8-Aug-12,"0643D38-Hanover NH","0643D38-Hanover NH",25-Jun-12
A036,1-Apr-12,"06CB8CF-Hanover NH","06CB8CF-Hanover NH",9-Aug-12
8944,19-Feb-12,"06D26AD-Hanover NH",,4-Feb-12
1004E,8-Jun-12,"06388B2-Lebanon NH",,24-Dec-11
16D87,3-Jul-12,"0649597-White River VT","0649597-White River VT",30-Mar-12
30D7,11-Nov-12,"06D95A3-Hanover NH","06D95A3-Hanover NH",30-Nov-11
3AE2,21-Feb-12,"06405B2-Lebanon NH",,26-Oct-12
B0FE,17-Feb-12,"06D1B9D-Hartland VT",,16-Feb-12
127A1,11-Dec-11,"064456E-Hanover NH","064456E-Hanover NH",11-Nov-12
161FF,20-Feb-12,"0643D38-Hanover NH","0643D38-Hanover NH",3-Jul-12
F4F9,30-Nov-11,"063B208-Randolph VT","063B208-Randolph VT",
475B,25-Sep-12,"06D26AD-Hanover NH",,5-Nov-12
151A3,7-Mar-12,"06388B2-Lebanon NH",,16-Nov-12
CA62,3-Jan-12,,,
D31B,18-Dec-11,"06405B2-Lebanon NH",,9-Jan-12
20F5,8-Jul-12,"0669C50-Randolph VT",,3-Feb-12
C6DC,19-Dec-11,"0649597-White River VT","0649597-White River VT",9-Apr-12
14E48,1-Aug-12,"06D3206-Hanover NH",,
177F8,20-Aug-12,"063B208-Randolph VT","063B208-Randolph VT",5-May-12
553E,11-Oct-12,"06D95A3-Hanover NH","06D95A3-Hanover NH",8-Mar-12
12D5F,18-Jul-12,"0649597-White River VT","0649597-White River VT",2-Nov-12
C6DC,13-Apr-12,"06388B2-Lebanon NH",,
11795,27-Feb-12,"0643D38-Hanover NH","0643D38-Hanover NH",19-Jun-12
17B43,11-Aug-12,,,22-Oct-12
16C99,11-Aug-12,"06D3206-Hanover NH",,19-Jun-12 
```

我可以使用以下代码来获取访问过综合体的人员列表：

```
import numpy as np
a = np.recfromcsv('test.csv')
print a[a['first_visit_date'] != ''] 
```

这是我遇到的问题。我似乎找不到打印名为`trainer`. 如果不为空，我想弄清楚如何输出`'trainer_operator'`，否则我想输出`'trainer_managing'`. 我想我需要使用`numpy.lib.recfunctions.rec_append_fields`来创建列。我只是不确定如何填充它。

我也应该说我刚刚开始发现 numpy 的强大功能，所以我正在尝试将它用于很多事情。这可能不是使用它的正确情况。如果有更好的方法来处理数据，也请告诉我。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:59:31.797

一种直接的方法是使用[`numpy.where`](http://docs.scipy.org/doc/numpy/reference/generated/numpy.where.html)：

```
>>> fvd_exists = a['first_visit_date'] != ''
>>> np.where(fvd_exists, a['trainer_managing'], a['trainer_operator'])
array(['"06DA1B3-Lebanon NH"', '"06405B2-Lebanon NH"',
       '"0643D38-Hanover NH"', '"06CB8CF-Hanover NH"',
       '"06D26AD-Hanover NH"', '"06388B2-Lebanon NH"',
       ... 
```

如果您有一组更复杂的需求，只需在 上使用布尔运算来表达它们`a`，然后将结果传递给`fvd_exists`.

然后，您可以使用`fromarrays`. 这是一个完整的例子：

```
>>> a = np.recfromcsv('test.csv')
>>> b = a[a['first_visit_date'] != '']
>>> has_op = b['trainer_operator'] != ''
>>> trainer_col = np.where(name, b.trainer_operator, b.trainer_managing)
>>> np.rec.fromarrays([b.id, b.enrollment_date, trainer_col],
...                   names=['id', 'enrollment_date', 'trainer'])
rec.array([('1536D', '12-Feb-12', '"06DA1B3-Lebanon NH"'),
       ('F15D', '18-May-12', '"06405B2-Lebanon NH"'),
       ('8096', '8-Aug-12', '"0643D38-Hanover NH"'),
       ('A036', '1-Apr-12', '"06CB8CF-Hanover NH"'),
       ('8944', '19-Feb-12', '"06D26AD-Hanover NH"'),
       ('1004E', '8-Jun-12', '"06388B2-Lebanon NH"'),
       ('16D87', '3-Jul-12', '"0649597-White River VT"'),
       ('30D7', '11-Nov-12', '"06D95A3-Hanover NH"'),
       ('3AE2', '21-Feb-12', '"06405B2-Lebanon NH"'),
       ('B0FE', '17-Feb-12', '"06D1B9D-Hartland VT"'),
       ('127A1', '11-Dec-11', '"064456E-Hanover NH"'),
       ('161FF', '20-Feb-12', '"0643D38-Hanover NH"'),
       ('475B', '25-Sep-12', '"06D26AD-Hanover NH"'),
       ('151A3', '7-Mar-12', '"06388B2-Lebanon NH"'),
       ('D31B', '18-Dec-11', '"06405B2-Lebanon NH"'),
       ('20F5', '8-Jul-12', '"0669C50-Randolph VT"'),
       ('C6DC', '19-Dec-11', '"0649597-White River VT"'),
       ('177F8', '20-Aug-12', '"063B208-Randolph VT"'),
       ('553E', '11-Oct-12', '"06D95A3-Hanover NH"'),
       ('12D5F', '18-Jul-12', '"0649597-White River VT"'),
       ('11795', '27-Feb-12', '"0643D38-Hanover NH"'),
       ('17B43', '11-Aug-12', ''),
       ('16C99', '11-Aug-12', '"06D3206-Hanover NH"')], 
      dtype=[('id', '|S5'), ('enrollment_date', '|S9'), ('trainer', '|S24')]) 
```

# java - 并发进程中的互斥

> ID：13574368
> 
> 赞同：1
> 
> 时间：2012-11-26T22:37:08.340
> 
> 标签：java, concurrency

例如，我有两个类似这样的程序：
共享变量：

```
boolean f0 = false;
boolean f1 = false; 
```

程序 0：

```
1\. f0 = true;
2\. while(f1==true){}
3\. //Important section
4\. f0 = false; 
```

方案一：

```
a. f1 = true;
b. while(f0==true){}
c. //Important section
d. f1 = false; 
```

我想问的是，有没有这样一种情况，两个进程可以同时进入Important section？你能给我一个具体代码执行的例子吗？
非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:39:21.290

总之，是的，原因有很多（缓存、指令重新排序等）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:42:32.273

即使只有进程 0 写入 f0，进程 1 可能正在读取 f0，而进程 0 正在写入 f0，因此您绝对可以在临界区中获得两个进程。

您需要查找`synronized`关键字以了解如何安全地处理多线程。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-30T19:59:04.240

如果此代码以顺序一致的方式执行，那么答案是**否定**的。没有这样的执行顺序允许这两个线程同时进入临界区。

如果我们考虑 Java 领域，那么是的，这是可能的。尽管它们共享一些数据，但您的线程不使用同步。在这种情况下，JVM 不能保证它们会观察到彼此的写入。

但无论如何，这种“互斥锁”很容易出现死锁。考虑这个执行：

```
f0 = true;
f1 = true;
---------------------
while (f0) {}
while (f1) {} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T22:40:01.497

是的，这可能发生！

您可以保护该部分

```
// this Object must be shared between both Threads.
Object lock = new Object();

synronized(lock) {

//  .. here protected

} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T22:41:00.740

如果这些确实是独立的进程，那么它们的操作是完全相互独立的，因此答案是“是”。每个都有自己的所有变量的副本。

你的意思是问线程吗？无论如何，除非您引入同步机制，否则答案是相同的。

# php - PHP Post 变量具有重复的、经过处理的数据

> ID：13574369
> 
> 赞同：2
> 
> 时间：2012-11-26T22:37:14.680
> 
> 标签：php, jquery, ajax, apache, post

我正在研究一个可以启动 ajax 调用的简单链接。在我们的 Ubuntu 服务器退役之前，这按预期工作；我们有一个新的“相同”服务器。当我检查 POST 中的内容时，问题发生在服务器端。$_POST["scan_date"] 的预期回声是：2012-11-26

实际回显为：2012-11-26scan_date=2012-11-26

这是下面 PHP 代码中的实际回显。客户端警报给出了这个：2012-11-26，这就是我所期望的。因此，服务器端似乎正在发生一些事情。我希望回声是“2012-11-26”而不是“2012-11-26scan_date=2012-11-26”

我无法弄清楚为什么 POST 数据会像这样被弄乱。

PHP：

```
$date = isset($_POST["scan_date"]) ? $_POST["scan_date"] : date("Y-m-d");
echo $date;  //produces 2012-11-26scan_date=2012-11-26 which is bad 
```

查询：

```
var val = $(this).attr('value');
dateSelected = val.replace(/facterOption-/g, "");
dateSelected = $.trim(dateSelected);
alert(dateSelected);  //alerts 2012-11-26 which is good

$.ajax({
type: "POST",
dataType: 'json',
url: 'https://someurl',
data: {
scan_date: dateSelected
}
}) 
```

更新：我们已经尝试了完全在这个 PHP 项目的代码框架之外的命令行 curl 调用，并且注意到了相同的结果。所以也许 Apache 与此有关。

此外，我们发现添加第二个 POST 参数和值可以解决这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:40:02.273

这是一个现有的错误。

[https://bugs.php.net/bug.php?id=22773](https://bugs.php.net/bug.php?id=22773)

解决方案是：

*   将另一个虚拟名称/值对发送到帖子中
*   要求 > IE6
*   如果适用，使用 GET 而不是 POST

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:42:14.633

在您的 PHP 文件中，尝试更改：

```
echo $date; 
```

到

```
echo $_POST["scan_date"]; 
```

只是为了看看 PHP 文件正在接收什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T23:59:44.857

[Chrome 开发者工具网络选项卡](https://developers.google.com/chrome-developer-tools/docs/network)或[Firefox 的 Firebug](http://getfirebug.com/network)将帮助您调试请求。查看正在发送的请求。PHP 中不太可能有一些东西会附加到您的请求中。很可能是在 JavaScript 中。

# ios - 通过 aws ios sdk 使用自定义 cname 进行上传

> ID：13574370
> 
> 赞同：0
> 
> 时间：2012-11-26T22:37:40.030
> 
> 标签：ios, amazon-s3, amazon-web-services

我们正在使用 aws ios sdk 将媒体上传到 s3，但想使用不同的主机名（例如，我想 cname up.ourdomain.com -> s3.amazonaws.com）。有谁知道这是否可能没有太多的黑客攻击？我不希望将来升级 sdk 是不可能的。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T03:17:51.323

我帮助维护适用于 iOS 的 AWS 开发工具包。虽然我不建议您继续执行此计划，但您可以在服务客户端上设置端点，如下所示：

```
 s3 = [[AmazonS3Client alloc] initWithAccessKey:ACCESS_KEY_ID withSecretKey:SECRET_KEY];
 s3.endpoint = @"up.ourdomain.com"; 
```

虽然这应该适用于全局操作（例如列出存储桶），但 SDK 会期望`BUCKETNAME.up.ourdomain.com`您尝试直接创建或访问的任何存储桶都存在这种情况。如果您可以保证会出现这种情况，那么您可能不会遇到任何其他问题。

我能问一下为什么你觉得需要添加一个额外的间接层吗？

# excel - 保存带有额外小数位的单元格

> ID：13574371
> 
> 赞同：0
> 
> 时间：2012-11-26T22:37:48.420
> 
> 标签：excel, excel-formula, excel-2007, precision, worksheet-function

我`16.19`作为一个单元格的值输入，将其保存为 Excel 2007 (.xlsx) 文件，然后再次将其保存为 .xml 文件。当我使用 Sublime 编辑器打开 .xml 文件时，单元格显示为`16.190000000000001`.

有谁知道为什么这不仅仅是另存为`16.19`？

这也发生在`16.49`,`16.69`和`16.99`(not `16.29`, `16.39`, `16.59`, `16.79`or `16.89`) 上。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T00:47:34.803

很多地方都描述了原因，[例如](http://en.wikipedia.org/wiki/Numeric_precision_in_Microsoft_Excel)。要在 Excel 中删除多余部分，请使用 =ROUND({cellref},2) 转换或转换为字符串，如有必要，请使用 =LEFT({cellref},5)。

# c++ - 类之间的两种方式引用 - 如何避免它们相互认识？

> ID：13574372
> 
> 赞同：1
> 
> 时间：2012-11-26T22:37:55.843
> 
> 标签：c++, oop

想象一下从一个基类派生的多个类。所有班级都需要相互了解，这不是一个选择，因为这是我正在从事的一个更大的项目。由于它的简单性，我将使用虚构的`inventory - item`关系作为示例。

```
class Inventory : public Base {
    std::vector<Base*> m_items; // These CAN be Items
};

class Item : public Base {
    Base* m_parent; // This CAN be Inventory
}; 
```

这两个类显然位于不同的文件中，它们需要使用彼此的方法，而它们的基类没有这些方法。注意单词 CAN，而不是 MUST，这意味着 m_parent 和 m_items 可以是从 Base 派生的任何类的对象。所以 Item 的父级可能是`Inventory`or `TreasureChest`。

tl; dr 两个类必须能够相互通信，而无需知道彼此的类型。如何以及什么是实施此类活动的最佳方式？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:45:21.500

一种方法是为基类中的通信类型定义一个抽象函数。然后在你的派生类中实现这个函数。这使您可以处理所需的每种类型的通信。

但是通过两种方式引用，您必须更加谨慎地删除此类对象。这种类型的架构非常容易出错。

对于通信的两种方式引用可能如下所示：base.h：

```
class Base {
  void doCommunication(Base *caller) = 0;
}; 
```

库存.h：

```
class Inventory;      // forward declaration for Item class
#include "Item.h"

class Inventory : public Base {
   void doCommunication(Base *commCaller) { 
      // check type
      Inventory *invCaller = dynamic_class<Inventory*> (commCaller);
      if(invCaller != nullptr) {
         // called from inventory and you are able to use inventory

         return;  // you can stop here cause commCaller can only be Base class instead but not Item
      }

      Item *itemCaller = dynamic_class<Inventory*> (commCaller);
      if(invCaller != nullptr) {
         // called from item and you are able to use item

         return;  // you can stop here cause commCaller can only be Base class instead but not inventory
      }
   }
}; 
```

Item.h 看起来与库存类非常相似，doCommunications 必须为项目特定功能覆盖。

我还不能测试代码，但它应该可以工作。dynamic_cast 的原因，您可以转换为您需要的目标对象并调用所需的函数。如果失败，你会得到一个 nullptr。

希望能帮助到你。

欢呼卢卡斯

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:56:42.647

在您的示例中，没有任何实际问题：两个类之间没有直接依赖关系，并且您没有显示实现的任何部分。如果实现实际上需要从相应的其他类访问特定`Inventory`和`Item`方法，则可以将每组操作分解到相应的基类中，也可能派生自`Base`并提供合适的函数。

例如

```
// base.h
class Base {
public:
    virtual ~Base();
};

// abstractitem.h
class AbstractItem: public Base {
public:
    virtual int weight() const = 0;
};

// abstractinventory.h
class AbstractInventory: public Base {
public:
    virtual int totalWeight() const = 0;
};

// item.h
class Item: public AbstractItem {
public:
    int weight() const;
    // uses of AbstractInventory
};

// inventory.h
class Inventory: public AbstractInventory {
    void addItem(AbstractItem const* item);
    int totalWeight() const;
    // uses of AbstractItem
}; 
```

请注意，库存和项目的抽象和独立操作只是被分解出来。尽管具体对象实际上能够相互调用，但接口或实现之间没有任何依赖关系。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:11:28.430

两个班级可以“互相认识”就好了。只需在其用户的头文件中转发声明引用的类，并且仅在cpp（而不是h）中包含引用的类头...

**啊：**

```
struct B; // fwd decl

struct A
{
    B* b;

    void fa();
}; 
```

**A.cpp：**

```
#include "A.h"
#include "B.h"

void A::fa() { b->fb(); } 
```

**乙：**

```
struct A; // fwd decl

struct B
{
    A* a;

    void fb();
}; 
```

**B.cpp**：

```
#include "B.h"
#include "A.h"

void B::fb() { a->fa(); } 
```

这显然是一个无限的运行时循环，但你明白了。

# python - 装饰类继承和类方法

> ID：13574376
> 
> 赞同：2
> 
> 时间：2012-11-26T22:38:28.507
> 
> 标签：python, decorator, subclassing, class-method

如何以正确的方式装饰一个类以便能够从被装饰的类中继承一个类？是否存在正确的方法？

如果我会做类似的事情：

```
def singleton(cls):                            
    inst = {}                                  
    def get(*args, **kwargs):                  
        cls_id = id(cls)                       
        if cls_id not in inst:                 
            inst[cls_id] = cls(*args, **kwargs)
        return inst[cls_id]                    
    return get 

@singleton
class A(object):
    @classmethod
    def cls_meth(cls):
        return cls 
```

我没有机会从上面继承一个类，因为在我调用它之前这是函数。classmethods 有同样的问题，函数没有 classmethods。

```
class B(A): # No way! `A` is the function!
    pass

A.cls_meth() # AttributeError: 'function' object has no attribute 'cls_meth' 
```

即使我在做类似的事情：

```
class SingletonDecorator(object):                        
    inst = {}                                            
    def __init__(self, cls):                             
        self.cls = cls                                   

    def __call__(self, *args, **kwargs):                 
        cls_id = id(self.cls)                            
        if cls_id not in self.inst:                      
            self.inst[cls_id] = self.cls(*args, **kwargs)
        return self.inst[cls_id]                         

@SingletonDecorator
class A(object):
    pass 
```

当我从类继承一个类时`A`，它将从`SingletonDecorator`类继承而不是`A`.

```
class B(A): # No no no! I do not need a `SingletonDecorator` child class...
    pass 
```

有一种方法可以通过 修改类实例`__metaclass__`，但这绝对是另一回事......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:56:06.317

您的装饰器需要返回原始类（或其子类）才能进一步对其进行子类化。您的装饰器在用作装饰器时会返回其自身的一个实例（因为这是调用类的默认行为）。

例如，像这样：

```
def singleton(cls):
    class C(cls):
        _instance = None
        def __new__(c, *args, **kwargs):
            if type(c._instance) != c:
                c._instance = cls.__new__(c, *args, **kwargs)
            return c._instance
    C.__name__ = cls.__name__
    return C 
```

这将返回原始类的子类，该子类具有`__new__()`执行单例魔术的重写方法。这个类是可子类化的。

然而，几乎没有任何理由要创建单例。通常它只是一种隐藏全局状态的方法，可以更好地消除它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:47:55.420

您的装饰器需要返回一个类以便您对其进行子类化。

```
>>> def decorator(cls):
...     class Stuff(cls):
...         @classmethod
...         def print_result(kls):
...             print 'results= %s' % kls.results
...     return Stuff
... 
>>> class Foo(object):
...     results = 'grade A'
...     @classmethod
...     def print_result(cls):
...         print cls.results
... 
>>> 
>>> @decorator
... class Bar(Foo):
...     pass
... 
>>> class Baz(Bar):
...     def frobnicate(self):
...         pass
... 
>>> 
>>> Baz.print_result
<bound method type.print_result of <class '__main__.Baz'>>
>>> Baz.print_result()
results= grade A
>>> Foo.print_result
<bound method type.print_result of <class '__main__.Foo'>>
>>> Foo.print_result()
grade A
>>> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-29T15:47:36.647

很少考虑这个结果：

```
class SD(object):                                          
    """ The right way to decorate classes """              
    inst = {}                                              
    def __init__(self, cls):                               
        self.__dict__.update(cls.__dict__)                 
        self.__name__ = cls.__name__                       
        self.cls = cls                                     

    def __call__(self, *args, **kwargs):                   
        if self.cls not in self.inst:                      
            self.inst[self.cls] = self.cls(*args, **kwargs)
        return self.inst[self.cls] 
```

受@kindall 的回答和评论的启发，我找到了另一个解决方案。顺便说一句，单例只是一个例子，它与问题没有真正的关系。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-10-01T07:51:24.610

为了能够从装饰类继承，您必须确保装饰器返回装饰类本身而不是包装器。`__new__()`您可以通过重载-operator来操作从此类创建新对象。通过这样做，如果装饰器本身是一个类，您甚至可以调用装饰器方法。当然，您也可以对装饰器使用继承。

有关完整示例，请参见

[从装饰类继承](https://stackoverflow.com/questions/7477311/inheriting-from-decorated-classes)

# multithreading - 异步调用的任务限制？

> ID：13574377
> 
> 赞同：3
> 
> 时间：2012-11-26T22:38:31.260
> 
> 标签：multithreading, wcf, task

我有一个同步工作的 .NET 4.5 WCF 客户端。我正在更新它以使用新的异步/等待功能来同时进行多个服务器调用以同时获取数据块。

在我完成之前，我担心同时运行的所有线程都会使服务器饱和（更不用说在我明年升级到该角色时杀死我的 Azure 工作者角色）。有没有办法集中管理我在类级别使用的任务线程的总量？该代码与其他 WCF 客户端代码共享一个程序集。

感谢所有的想法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:22:02.963

从字面上回答您的问题：您可以通过实现自己的[TaskScheduler](http://msdn.microsoft.com/en-us/library/dd321418.aspx)并将其分配给您创建的每个任务来控制用于处理任务的线程数。微软甚至有一个[完整的例子](http://msdn.microsoft.com/en-us/library/ee789351.aspx)。

但是，要回答根本问题：`Task`并不意味着`Thread`. 事实上，async/await 的主要目标是*减少*应用程序中的线程数。实际上，可以围绕 async/await 和 Tasks 设计一个完整的应用程序，运行数千个并发任务，只使用一个*线程*。

您希望您的代码在尽可能少的线程中运行，理想情况下不超过您拥有的逻辑 CPU 的数量，并且您希望 I/O 与您的代码同时发生。操作系统可以为您管理所有 I/O，而无需创建额外的线程。任务可帮助您完成此任务。

它可以为每个任务创建一个线程的唯一时间是如果您正在模拟异步性，例如。调用 Task.Run 运行阻塞代码。这种代码确实是不明智的：

```
Task t1 = Task.Run(()=>DownloadFile(url1));
Task t2 = Task.Run(()=>DownloadFile(url2));

await Task.WhenAll(t1, t2) 
```

真正的异步代码（可以在单线程中运行）要好得多，例如：

```
Task t1 = DownloadFileAsync(url1);
Task t2 = DownloadFileAsync(url2);

await Task.WhenAll(t1, t2) 
```

或者，对于任意数量的任务：

```
List<Task> tasks = new List<Task>();

foreach(string url in urls)
{
    tasks.Add(DownloadFileAsync(url))
}

await Task.WhenAll(tasks); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:36:46.517

In the context of asynchronous WCF servers, there are no "Task threads".

You have `Task` instances that represent in-progress requests, but they are not thread pool threads. The server will allocate thread pools as needed to requests that have some work to do; a request that is asynchronously waiting (in an `await`) does not have a thread.

# string - 子域的htaccess重写器转换

> ID：13574381
> 
> 赞同：0
> 
> 时间：2012-11-26T22:38:34.460
> 
> 标签：string, .htaccess, redirect, rewrite

我的网站上有一个目录索引器，其路径中有 index.php?dir=。
为了从 URL 中隐藏那一点，我有以下完美工作的 htaccess：

```
Options +FollowSymLinks 

RewriteEngine On
RewriteBase /downloads

RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule .* - [L]

RewriteCond %{QUERY_STRING}  ^dir=(.*)$ [NC]
RewriteRule ^ %1? [L,R=301,NE]

RewriteCond %{REQUEST_FILENAME} !-f

RewriteRule ^(.*)? index.php?dir=$1/ [L,QSA] 
```

从上面的 htaccess 可以看出，这个目录索引器在

```
www.example.com/downloads 
```

htaccess 就在其中。

现在我决定将文件夹“下载”移动到不同主机上不同服务器上的子域，所以

```
www.example.com/downloads 
```

将被重定向到

```
downloads.example.com 
```

这将在另一台主机上。

有人可以修改上面的 htaccess 以便它现在可以工作吗

```
downloads.example.com 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T03:11:30.233

你会想要使用这样的东西并将这个 htaccess 文件放在你的***downloads.example.com****域**的文档根目录中******

 **```
Options +FollowSymLinks 

RewriteEngine On
RewriteBase /

RewriteCond %{ENV:REDIRECT_STATUS} 200
RewriteRule .* - [L]

RewriteCond %{HTTP_HOST} downloads.example.com [NC]
RewriteCond %{QUERY_STRING}  ^dir=(.*)$ [NC]
RewriteRule ^ %1? [L,R=301,NE]

RewriteCond %{HTTP_HOST} downloads.example.com [NC]
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)? index.php?dir=$1/ [L,QSA] 
```**

# objective-c - 为计算器应用程序制作记忆功能按钮

> ID：13574388
> 
> 赞同：0
> 
> 时间：2012-11-26T22:39:03.280
> 
> 标签：objective-c, ios, calculator

我正在制作一个计算器应用程序并想要制作两个记忆功能按钮
（“添加到记忆”或“**记住**”和“显示记住的”或“**告诉**”）

我在主标签上获取当前值的方式是

```
double currentValue = [screenLabel.text doubleValue]; 
```

基本上，我怎么能得到某种内存缓存，让我

*   清除其缓存的特殊内存的第一个按钮，读取标签并根据需要存储它，但不是永久的

*   从缓存中读取存储值并显示它的第二个按钮，如果没有存储值，则显示 0

?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:51:57.310

模型中的堆栈数据对象将能够将值保存在内存中。

查看此类别： [http ://saturnboy.com/2011/02/stack-queue-nsmutablearray/](http://saturnboy.com/2011/02/stack-queue-nsmutablearray/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-27T04:06:50.577

正如其他人所建议的那样，您需要一些模型结构（例如一些类属性）来跟踪您在计算中的位置。但是，如果您需要跟踪计算器的内存寄存器，您可能具有如下属性：

```
@property (nonatomic) double memoryValue; 
```

因此，您只需获取该属性，例如`memoryValue`，然后对其进行添加、减去、清除（将其设置为零）或检索其值，具体取决于用户分别点击`m+`、`m-`、`mc`或`mr`。我个人什至会考虑`NSNumber`房产，但我认为你不需要去那里。

也许我不明白你的问题。

* * *

`currentValue`我不得不承认，我更担心你从哪里得到你的代码行`screenLabel.text`。您真的*不*希望从用户界面控件（如 ）中检索应用程序操作所固有的数据，该控件`UILabel`专为信息呈现而设计。这意味着对如何设计 MVC 或[Model-View-Controller](http://developer.apple.com/library/ios/#documentation/general/conceptual/DevPedia-CocoaCore/MVC.html)应用程序存在根本性的混淆。驱动计算的值（例如当前值、内存值等）是*模型*的一部分（可能存储为某个`model`对象的属性）。`UILabel`表示当前计算值的 是视图*的一部分。*

`UILabel`使用（*视图*的一部分）来驱动计算并不是一个好主意。您的应用程序应该为应用程序的数据/操作维护一个*模型，并且**视图*应该只是该*模型*的表示（而不是相反）。

计算器应用程序是此处实际考虑的一个很好的例子。例如，您的计算器可能具有“科学/指数符号模式”（其中 1,200,000,000 可能显示为“1.2e9”）。或者它可能用逗号显示数值作为千位分隔符（其中一百万显示为“1,000,000.00”）。`text`属性的格式可能由各种不同的因素驱动，在使用值进行计算`UILabel`时，您真的不应该担心字符串格式。`double`

另一个很好的例子是显示的位数是应用程序是横向（我们有很多小数位的空间）还是纵向（更少的空间，因此显示的小数位更少）的函数。该应用程序不应该仅仅因为在纵向屏幕上显示它们的空间较少而记住更少的数字。底层*模型*中的实际计算值不应随着*视图*用户界面的变化而变化。而且，无论如何，该*模型*可能总是会使用更多的“有效数字”，这些数字是您想要在用户界面中呈现的。

*但希望这些示例能够让您了解应用程序模型*和*视图*之间的区别。简而言之，从`UILabels`. *在您的应用模型*中保留真实值（不是双关语） 。

 ** * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T00:56:42.050

使用 NSMutableDictionary，您的第一个按钮将 setObjectForKey，另一个按钮将 removeObjectForKey。

您还可以使用此字典的一个实例设置一个单例类，以使其可用于其他类。取决于你的结构。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-27T00:21:49.197

仍在猜测您的问题到底是什么，这是您似乎所问的答案...

你的计算器大概有一个加法按钮，加法需要两个操作数。您的问题表明其中一个`screenLabel`以文本和`currentValue`数字形式存储。另一个在哪里？将记忆值存储在存储第二个值的同一对象中的变量中。

例如，你会有这样的东西：

```
@implementation MyCalculator
{
   double currentValue;
   double previousValue;
   double memoryValue;
   ...
}

...

@end 
```*

# php - Amazon Glacier SDK php

> ID：13574390
> 
> 赞同：3
> 
> 时间：2012-11-26T22:39:04.900
> 
> 标签：php, amazon-web-services, amazon-glacier

我正在尝试将 php sdk 与 Glacier 一起使用来上传数据库备份，我能够使用以下代码创建和删除保管库。

```
<?php
require 'aws.phar';

use Aws\Glacier\GlacierClient;
use Aws\Common\Enum\Region;

$aws = GlacierClient::factory(array(
    'key'    => 'key',
    'secret' => 'secret',
    'region' => Region::US_WEST_2
));
$aws->createVault(array('vaultName'=>'newvault')); 
```

我看到函数uploadArchive()、initiateMultiPartUpload() 和uploadMultipartPart()。据我了解，我必须初始化上传，然后开始上传文件，但我不确定该函数采用哪些参数。

我知道这些方法，因为这里提到了它们[https://github.com/aws/aws-sdk-php/blob/master/src/Aws/Glacier/GlacierClient.php](https://github.com/aws/aws-sdk-php/blob/master/src/Aws/Glacier/GlacierClient.php)，参数是我不能的参数数组找到每种方法需要什么才能正常工作，并且关于 glacier 和 php sdk 的文档实际上不存在。

有没有人做这个工作？或找到好的文档？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-05T19:18:15.590

SDK 2有已发布的[API 文档](http://docs.amazonwebservices.com/aws-sdk-php-2/latest/index.html)。如果单击右侧[的小井号，GlacierClient的 API 文档会列出每个操作的参数。](http://docs.amazonwebservices.com/aws-sdk-php-2/latest/class-Aws.Glacier.GlacierClient.html)

编辑：[AWS PHP 开发博客上最近的](http://blogs.aws.amazon.com/php/post/Tx7PFHT4OJRJ42/Uploading-Archives-to-Amazon-Glacier-from-PHP)一篇文章展示了如何使用单部分和多部分上传选项将档案上传到 Amazon Glacier。

AWS 还发布了[Amazon Glacier 开发人员指南](http://docs.amazonwebservices.com/amazonglacier/latest/dev/introduction.html)。它不是特定于 PHP 的，但它确实更多地讨论了如何使用该服务以及参数的含义。

尽管 API 文档中没有记录，但 PHP SDK 在后台做一些工作来帮助您上传 Glacier。在大多数情况下该`accountId`参数应设置为`"-"`，因此如果您不设置，SDK 将默认为该参数。此外，如果未提供，SDK 会为您计算 SHA 哈希。

因此，简单的`UploadArchive`示例（以问题中提供的内容为基础）可能是：

```
<?php

require 'vendor/autoload.php'; // Include Composer autoloader

use Aws\Glacier\GlacierClient;
use Aws\Common\Enum\Region;

$glacier = GlacierClient::factory(array(
    'key'    => 'key',
    'secret' => 'secret',
    'region' => Region::US_WEST_2
));

$glacier->createVault(array('vaultName' => 'new-vault'));

$result = $glacier->uploadArchive(array(
    'vaultName'          => 'new-vault',
    'archiveDescription' => 'This is my new archive',
    'body'               => 'the contents of the archive',
));

$archiveId = $result->get('archiveId'); 
```

仍然缺乏可用的示例，但我希望随着时间的推移会有所改善。此外，[AWS SDK for PHP 论坛](https://forums.aws.amazon.com/forum.jspa?forumID=80)是专门发布有关 SDK 的问题的好地方，因为 SDK 团队一直在监控那里的帖子。

# linux - 使用 sed 编辑脚本中的 url 字符串

> ID：13574397
> 
> 赞同：2
> 
> 时间：2012-11-26T22:39:40.657
> 
> 标签：linux, string, bash, sed, edit

我需要在配置文件中编辑这些字符串

```
<port>8189</port>
<service>127.0.0..1:8190</service>
<wan-access>localhost</wan-access> 
```

我试过了

```
. variables.sh

cat config.sh |
  sed -i.bk \
  -e 's/\<^port\>\/'$port'/\<\/\port\>/'  \
  -e 's/\<^service\>\/'$url'/\<\/\service\>/' \
  -e 's/\<^wan-access\>\/'$url2'/\<\/\wan-access\>/' config.sh 
```

在脚本中，变量由 variables.sh 文件提供。出来应该是

```
<port>8787</port>
<service>my.domain.com:8190</service>
<wan-access>my.realdomain.com</wan-access> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:59:06.463

这可以解决问题：

```
port=8787
url="my.domain.com"
url2="my.realdomain.com"

sed -i.bk -Ee "s/(<port>)[0-9]+(<\/port)/\1${port}\2/" \
    -e "s/(<service>)[^:]*(:.*)/\1${url}\2/" \
    -e "s/localhost/${url2}/" config.sh 
```

输出：

```
<port>8787</port>
<service>my.domain.com:8190</service>
<wan-access>my.realdomain.com</wan-access> 
```

正则说明：

```
s/          # The first substitution 
(<port>)    # Match the opening port tag (captured)
[0-9]+      # Match the port number (string of digits, at least one)
(<\/port)   # Match the closing port tag (captured, escaped forwardslash)
/           # Replace with 
\1          # The first capture group
${port}     # The new port number
\2          # The second capture group

s/          # The second substitution 
(<service>) # Match the opening service tag (captured)
[^:]*       # Match anything not a :
(:.*)       # Match everything from : (captured)
/           # Replace with
\1          # The first capture group
${url}      # The new url 
\2          # The second capture group

s/          # The third substitution
localhost   # Match the literal string
/           # Replace with
${url2}     # The other new url 
```

*标签匹配可能不需要那么冗长，但对于初学者来说肯定更容易理解。*

**编辑：**

如果要更改`<service>`端口，请尝试以下操作：

```
-e "s/(<service>).*(<\/service)/\1${url}:${port}\2/" 
```

# list - 如何比较排名列表

> ID：13574406
> 
> 赞同：13
> 
> 时间：2012-11-26T22:40:23.673
> 
> 标签：list, compare, ranking

我有两个排名项目列表。每个项目都有一个排名和相关的分数。分数决定了排名。这两个列表可以包含（并且通常包含）不同的项目，即它们的交集可以是空的。我需要衡量这些排名的方法。是否有众所周知的算法（在文学或现实世界系统中）这样做？距离的度量应考虑项目的分数和等级。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2016-03-24T10:16:21.230

这个问题以前从未被回答过，但我仍然认为这对很多人来说很重要：

您的两个要求，即**列表的非联合性**和**排名的重要性**没有通过常见的相关测试来满足。除此之外，他们中的大多数（例如 Kendall-Tau）不考虑顺序：

```
>>> from scipy.stats import kendalltau
>>> kendalltau([1,2,3,4,5], [2,1,3,4,5])
KendalltauResult(correlation=0.79999999999999982, value=0.050043527347496564)
>>> kendalltau([1,2,3,4,5], [1,2,3,5,4])
KendalltauResult(correlation=0.79999999999999982, value=0.050043527347496564) 
```

第一次比较应该产生比第二次更小的值，因为列表的头部比尾部更重要**（第二个要求）**。

除此之外，可以看到两个列表需要具有相同的大小并且具有相同类型的元素**（第一个要求）**

**可能的解决方案**：

满足您所有需求的度量称为[Rank Biased Overlap](http://codalism.com/research/papers/wmz10_tois.pdf)。这是所谓的基于平均的重叠的概括，在这个[博客](https://ragrawal.wordpress.com/2013/01/18/comparing-ranked-list/)中得到了很好的说明。同一个人还推出了 RBO 的[实现](https://github.com/ragrawal/measures)。

*2018 年 1 月更新：*

*   python 3.5.2的另一种[RBO实现](https://github.com/dlukes/rbo)

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-03-28T14:40:38.270

也许不能完全解决问题，但绝对值得一看[Kendall 的加权 tau](https://www.sciencedirect.com/science/article/pii/S0167715298000066)。

当顺序很重要时，它提供了一种计算排名列表之间相似度的更好方法，因为它允许基于排名顺序进行任意加权。

例如，人们可能更感兴趣的是提高列表中前 20 项的相似性而不是统一。

[在scipy](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.weightedtau.html)中也有一个很好的实现。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-01-28T20:35:10.490

有许多措施可以比较前 k（排名）列表。一些非常简单的计算做出了几个简化假设，另一些则不那么简单，但在评估列表之间的等级相似性时更加严格。我最近看到的一篇论文以统计上有意义的方式处理了这个问题，使用了信息论和数据压缩的概念：http: [//arxiv.org/abs/1310.0110](http://arxiv.org/abs/1310.0110)

# sql - Oracle SQL 顺序组号分配

> ID：13574407
> 
> 赞同：3
> 
> 时间：2012-11-26T22:40:24.080
> 
> 标签：sql, oracle, uniqueidentifier

我有一个结果集，为简单起见，我将其称为三列的表“选项卡”：类别、子类别和日期，按类别排序，然后按日期排序。该数据集是一个网格，我希望在该网格之上执行其他处理。我的问题是在数据集中唯一标识（或按顺序标记）组。下面的 SQL 是我所追求的（GID1 或 GID2 都可以），基于前 3 列的存在。我尝试了 group_id、grouping_id、rank、dense_rank 并且要么错过了其中一个技巧，要么正在尝试一些非常尴尬的事情。GID 的顺序并不重要，重要的是组号分配基于排序的数据（类别然后日期）。

```
 CREATE TABLE Tab
        ("Category" varchar2(1), "SubCategory" varchar2(7), "Date" int, "GID1" int, "GID2" int);

    INSERT ALL 
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'bannana', 20120101, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'grape', 20120102, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'pear', 20120103, 1, 1)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'pear', 20120104, 1, 1)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'bannana', 20120105, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'pear', 20120106, 2, 2)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'pear', 20120107, 2, 2)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'apple', 20120108, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('A', 'pear', 20120109, 3, 3)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'apple', 20120101, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'bannana', 20120102, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'apple', 20120103, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'bannana', 20120104, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'pear', 20120105, 1, 4)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'pear', 20120106, 1, 4)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'pear', 20120107, 1, 4)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'pear', 20120108, 1, 4)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('B', 'pear', 20120109, 1, 4)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'grape', 20120101, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'grape', 20120102, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'apple', 20120103, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'bannana', 20120104, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'grape', 20120105, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'pear', 20120106, 1, 5)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'apple', 20120107, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'apple', 20120108, NULL, NULL)
        INTO Tab ("Category", "SubCategory", "Date", "GID1", "GID2")
             VALUES ('C', 'apple', 20120109, NULL, NULL)
    SELECT * FROM dual
    ; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:13:19.853

好的，如果它只是梨那么：

```
SQL> select "Category", "SubCategory", "Date",
  2         case
  3           when "SubCategory" = 'pear'
  4           then
  5             count(rn) over (partition by "Category" order by "Date") else null
  6         end GID1 ,
  7         case
  8           when "SubCategory" = 'pear'
  9           then
 10             count(rn) over ( order by "Category", "Date") else null
 11         end GID2
 12    from (select "Category", "SubCategory", "Date", lag("SubCategory") over (partition by "Category" order by "Date"),
 13                                    case
 14                                      when lag("SubCategory") over (partition by "Category" order by "Date") != "SubCategory"
 15                                      and "SubCategory" = 'pear'
 16                                       then 1
 17                                      when row_number() over (partition by "Category" order by "Date") = 1 and "SubCategory" = 'pear' then 1
 18                                      else null
 19                                    end rn
 20                               from tab)
 21   order by 1, 3;

Category   SubCate       Date       GID1       GID2
---------- ------- ---------- ---------- ----------
A          bannana   20120101
A          grape     20120102
A          pear      20120103          1          1
A          pear      20120104          1          1
A          bannana   20120105
A          pear      20120106          2          2
A          pear      20120107          2          2
A          apple     20120108
A          pear      20120109          3          3
B          apple     20120101
B          bannana   20120102
B          apple     20120103
B          bannana   20120104
B          pear      20120105          1          4
B          pear      20120106          1          4
B          pear      20120107          1          4
B          pear      20120108          1          4
B          pear      20120109          1          4
C          grape     20120101
C          grape     20120102
C          apple     20120103
C          bannana   20120104
C          grape     20120105
C          pear      20120106          1          5
C          apple     20120107
C          apple     20120108
C          apple     20120109 
```

打破这个。

我们查看按“日期”排序的前一行（对于每个“类别”），看看它是否是不同的“子类别”以及当前类别 = pear。如果是这样，我们用“1”标记该行（与我们使用的内容无关，只是 NON NULL）。

```
lag("SubCategory") over (partition by "Category" order by "Date") != "SubCategory" 
 and "SubCategory" = 'pear' 
```

对于第一行，我们也分配相同的值。这给了我们：

```
Category   SubCate       Date LAG("SU         RN
---------- ------- ---------- ------- ----------
A          bannana   20120101
A          grape     20120102 bannana
A          pear      20120103 grape            1
A          pear      20120104 pear
A          bannana   20120105 pear
A          pear      20120106 bannana          1
A          pear      20120107 pear
A          apple     20120108 pear
A          pear      20120109 apple            1
B          apple     20120101
B          bannana   20120102 apple
B          apple     20120103 bannana
B          bannana   20120104 apple
B          pear      20120105 bannana          1
B          pear      20120106 pear
B          pear      20120107 pear
B          pear      20120108 pear
B          pear      20120109 pear
C          grape     20120101
C          grape     20120102 grape
C          apple     20120103 grape
C          bannana   20120104 apple
C          grape     20120105 bannana
C          pear      20120106 grape            1
C          apple     20120107 pear
C          apple     20120108 apple
C          apple     20120109 apple 
```

现在，只需我们 count() 再次在 Date 上排序的非空“RN”值（GID1 的每个类别，而不是 GID2 [gid2 我们也按它排序！）。这是这些行： `count(rn) over (partition by "Category" order by "Date")`（GID1）

和 `count(rn) over ( order by "Category", "Date")`(GID2)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-30T09:14:16.397

从来没有想过它可以用计数来完成。杰出的。从版本 11r2 开始，这可以通过使用递归分层查询来完成。

```
with r as ( 
  select "Category"
    , "SubCategory"
    , "Date"
    , row_number() over (partition by "SubCategory" order by "Category", "Date") rn
  from tab
)
, fwd ( "Category", "SubCategory", "Date", rn, GID1, GID2) as (
  select "Category"
    , "SubCategory"
    , "Date"
    , rn
    , 1
    , 1
  from r
  where rn = 1
  union all 
  select nxt."Category"
    , nxt."SubCategory"
    , nxt."Date"
    , nxt.rn
    , decode( nxt."Category"
      , prev."Category", decode( nxt."Date"
        , prev."Date" + 1, prev.gid1
        , prev.gid1 + 1 
      )
      , 1
    ) as gid1
    , decode( nxt."Date"
      , prev."Date" + 1, prev.gid2
      , prev.gid2 + 1 
    ) as gid2
  from fwd prev
    , r nxt
  where prev.rn + 1= nxt.rn
    and prev."SubCategory" = nxt."SubCategory"
)
select "Category"
  , "SubCategory"
  , "Date"
  , decode( "SubCategory", 'pear', GID1, null ) as gid1
  , decode( "SubCategory", 'pear', GID2, null ) as gid2
from fwd
order by "Category", "Date"; 
```

它产生相同的结果

```
Category SubCategory       Date       GID1       GID2
-------- ----------- ---------- ---------- ----------
A        bannana       20120101                       
A        grape         20120102                       
A        pear          20120103          1          1 
A        pear          20120104          1          1 
A        bannana       20120105                       
A        pear          20120106          2          2 
A        pear          20120107          2          2 
A        apple         20120108                       
A        pear          20120109          3          3 
B        apple         20120101                       
B        bannana       20120102                       
B        apple         20120103                       
B        bannana       20120104                       
B        pear          20120105          1          4 
B        pear          20120106          1          4 
B        pear          20120107          1          4 
B        pear          20120108          1          4 
B        pear          20120109          1          4 
C        grape         20120101                       
C        grape         20120102                       
C        apple         20120103                       
C        bannana       20120104                       
C        grape         20120105                       
C        pear          20120106          1          5 
C        apple         20120107                       
C        apple         20120108                       
C        apple         20120109 
```

并且可以更自我解释。

`decode`如果您从最终选择中删除，它还​​会为所有其他子类别生成正确的 GID1 和 GID2 编号，而不仅仅是“梨” 。

在此变体和@DazzaL 提供的变体之间进行选择取决于成本比较

# ios - OS X 和 iOS 之间的存储差异

> ID：13574408
> 
> 赞同：3
> 
> 时间：2012-11-26T22:40:26.237
> 
> 标签：ios, macos, storage

我正在 OS X 上编写一些二进制数据文件以在 iOS 设备上读取。我试图读写以下结构：

```
struct poiStruct {
    double latitude, longitude;
    char titleString[41];
}; 
```

我发现使用 sizeof 该结构在 OS X 上占用 64 个字节，在 iOS 上占用 60 个字节。

对此的任何想法/解释都非常感谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T22:44:28.620

差异不在于元素的大小，而在于填充，在 OSX 上，结构与 8 字节边界对齐，因此它是

```
XXXXXXXX double (8 bytes)
YYYYYYYY double (8 bytes)
ZZZZZZZZ char (41 bytes)
ZZZZZZZZ
ZZZZZZZZ
ZZZZZZZZ
ZZZZZZZZ
ZPPPPPPP padding (7 bytes) = 64 bytes 
```

而在 iOS 上它对齐到 4 个字节，所以它是

```
XXXX double (8 bytes)
XXXX 
YYYY double (8 bytes)
YYYY
ZZZZ char (41 bytes)
ZZZZ
ZZZZ
ZZZZ
ZZZZ
ZZZZ
ZZZZ
ZZZZ
ZZZZ
ZZZZ
ZPPP padding (3 bytes) = 60 bytes 
```

对齐是一个不同的要求，因为 OS X 在 64 架构上运行，而 iOS 在 ARM6/7 上运行是 32 字节架构。在 32 位模式下编译您的 OS X 应用程序（这是可能的，但我不鼓励这样做）应该会使这种差异消失。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:43:18.487

您的 Mac 应用程序是 64 位应用程序，而 iOS 版本是 32 位。不同之处在于架构的不同填充要求，特别是 32 位要求变量对齐 4 字节，而 64 位需要 8 字节对齐，因此编译器会在结构的末尾添加不同数量的填充。

# c# - C#中IE的webdriver有效窗口切换？

> ID：13574412
> 
> 赞同：1
> 
> 时间：2012-11-26T22:40:43.320
> 
> 标签：c#, internet-explorer, window, webdriver, window-handles

我正在为网站编写一些测试自动化。我的测试应该做的是：运行一个链接列表，每个链接都提供自己的窗口，检查窗口中的数据，然后关闭子窗口并恢复到父窗口。

虽然我可以访问每个链接，但我无法将焦点切换到子窗口。driver.WindowHandles 只显示一个句柄（前一天没有这样做）。在过去的两天里，我一直被困在这个问题上，感觉就像我在倒退。任何和所有的帮助将不胜感激。

以下是我的代码的一部分

```
if (pop_continue)
{
      //windowsBefore = 1
      wait.Until((_driver) => { return _driver.WindowHandles.Count != windowsBefore; });
      ReadOnlyCollection<string> Handles = driver.WindowHandles;
      foreach (var handle in Handles)
      {
            if (!handle.Equals(baseWindowHndl))
            {
                  driver.SwitchTo().Window(handle);
                  break;
            }
      }
      try
      {
            Console.WriteLine("Child Window (a) " + driver.CurrentWindowHandle);
            //..

            driver.SwitchTo().Window(baseWindowHndl); //baseWindowHndl is initialized to parent handle
            Console.WriteLine("Parent Window (b) " + driver.CurrentWindowHandle);
      }
      catch (Exception e)
      {
             Console.WriteLine("<-Something stupid occurred.->");
             Console.WriteLine(e.Source + " : " + e.Message);
      }
      //////////////
} 
```

# pandas - DataFrame 中的 MultiIndex 和列

> ID：13574420
> 
> 赞同：1
> 
> 时间：2012-11-26T22:41:26.143
> 
> 标签：pandas

创建具有 MultiIndex 列的 DataFrame 时，似乎不可能返回具有 MultiIndex 的单个列。相反，返回一个带有索引的对象：

```
import pandas as pd
import numpy as np

dates = np.asarray(pd.date_range('1/1/2000', periods=8))
_metaInfo = pd.MultiIndex.from_tuples([('AA', '[m]'), ('BB', '[m]'), ('CC', '[s]'), ('DD', '[s]')], names=['parameter','unit'])

df = pd.DataFrame(np.random.randn(8, 4), index=dates, columns=_metaInfo)
print df.get('AA').columns
# Index([[m]], dtype=object) 
```

缺少“参数”信息的地方。这是一个错误，有解决方法吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T08:10:53.960

我也为此苦苦挣扎。相反，给一个单一的增加一个额外的水平（所以它匹配一个 MultiIndex），也让我很忙。

我有时使用它来保持索引完整：

```
print df.T[[('AA', '[m]') == col for col in df.columns]].T

parameter         AA
unit             [m]
2000-01-01  0.972434
2000-01-02 -0.581852
2000-01-03 -0.784172
2000-01-04 -0.843441
2000-01-05 -1.030200
2000-01-06 -0.864225
2000-01-07 -0.530056
2000-01-08 -0.651367 
```

但是当您的索引更复杂时，这不是最灵活的解决方案。在这个例子中它会起作用。

# c - 当我取消引用 malloc 内的 NULL 指针时，为什么我的程序没有出现段错误？

> ID：13574421
> 
> 赞同：11
> 
> 时间：2012-11-26T22:41:26.440
> 
> 标签：c, segmentation-fault

我一直使用这种 malloc 风格

```
int *rc = 0;
rc = malloc(sizeof(*rc)); 
```

但是，即使当我调用时`sizeof(*rc)`我假设它也不会出现段错误`rc==0`，并且我正在取消引用一个`NULL`指针。

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2012-11-26T22:42:34.950

你并没有真正取消引用任何东西。的参数`sizeof`不被评估，除非它是一个 VLA。语言明确允许将您想要的任何“垃圾”作为`sizeof`. 该语言保证它不会评估任何内容，只需对表达式类型执行编译时分析。例如，表达式`sizeof i++`保证不会改变 的值`i`。

该规则的唯一例外是可变长度数组。for VLAs的结果`sizeof`是一个运行时值，这意味着该参数被评估并且必须是有效的。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2012-11-26T22:43:22.377

运算符实际上并不评估其`sizeof`操作数，它只查看其类型。的类型`*rc`是`int`，所以它等价于`sizeof (int)`。这一切都发生在编译时。

（此外，这不是“malloc 内部”。）

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-26T22:42:48.953

您实际上并没有取消引用指针，而是在向编译器询问类型`rc`指向的大小。在这种情况下`sizeof`，在没有指针的情况下在编译时解决。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-11-26T22:42:58.337

这相当于`sizeof(type of *rc)`（换句话说，`sizeof(int)`），而不是`sizeof(data stored at the location pointed to by rc)`。 `sizeof()`适用于*类型*，而不是值。

sizeof 从不考虑实际数据，只考虑类型，因此没有必要（也没有意义）尊重指针。

# .net - 使用 Cisco CallManager 向 voip 电话发送短信有哪些选项？

> ID：13574422
> 
> 赞同：0
> 
> 时间：2012-11-26T22:41:39.627
> 
> 标签：.net, cisco

我们的客户（一家医院）有一组 Cisco voip 手机，每次轮班开始时都要检查这些手机。他们希望我们的软件（临床消息）向他们的其中一部手机发送文本警报。这是一种单向信息消息 - 不需要双向通信。我们的应用程序位于 Microsoft 技术堆栈上。

手机型号为7925。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:07:11.813

这是假设您正在运行 7925G 手机和 CUCM 8.0 或更高版本。这些设备接受[Cisco 的 XML 对象](http://www.cisco.com/en/US/docs/voice_ip_comm/cuipph/all_models/xsi/8_0_1/xmlobjectsref.html)模型，该模型可用于一系列功能，包括在设备上显示文本消息。以下是 Cisco 文档中的一个示例，说明您可以使用什么来在设备上显示消息。（[表 3-1 有设备支持信息](http://www.cisco.com/en/US/docs/voice_ip_comm/cuipph/all_models/xsi/8_0_1/xsidevguide.pdf)）

```
<CiscoIPPhoneText>
  <Title>Title text goes here</Title>
  <Prompt>The prompt text goes here</Prompt>
  <Text>Text to display as the message body goes here</Text>
</CiscoIPPhoneText> 
```

您可以使用 .NETs HttpWebClient 类创建此消息。确保您检查了有关您应该使用哪个 HTTP 版本以及通信正常工作可能需要的其他细节的文档。希望有帮助。

# javascript - 将 $(this) 传递给函数

> ID：13574423
> 
> 赞同：1
> 
> 时间：2012-11-26T22:41:47.627
> 
> 标签：javascript, jquery

我正在努力实现这个 ColorPicker 插件：

[http://www.eyecon.ro/colorpicker/](http://www.eyecon.ro/colorpicker/)

我有一个包含多个字段的表单，我希望在选择任何字段时弹出颜色选择器，并根据所做的选择更改值。

这是我的代码：

```
jQuery(function($) {
    function changeColor(e) {
        e.preventDefault();
        $(this).ColorPicker({
            onChange: function(hsb, hex, rgb) {
                $(this).attr('value', '#' + hex)
            }
        });
    }
    $('form.niceform input').live('mouseup', changeColor);
}) 
```

但是由于某种原因， $(this).attr... 部分没有识别出 $(this) 是当前选定的字段。

有人可以帮我理解我做错了什么吗？

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-11-26T22:44:31.097

此时，$(this) 是颜色选择器，而不是您应用颜色选择器的元素。

尝试这样的事情：

```
jQuery(function($) {
    function changeColor(e) {
        e.preventDefault();
        var elem = $(this);
        elem.ColorPicker({
            onChange: function(hsb, hex, rgb) {
                elem.attr('value', '#' + hex)
            }
        });
    }
    $('form.niceform input').live('mouseup', changeColor);
}) 
```

**编辑：**正如 Pointy 指出的那样，您可以做几件事来使它变得更好：

```
jQuery(function($) {
    function changeColor(e) {
        e.preventDefault();
        var elem = $(this);
        elem.ColorPicker({
            onChange: function(hsb, hex, rgb) {
                elem.val('#' + hex)
            }
        });
    }
    $('form.niceform input').on('mouseup', changeColor);
}) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:44:55.077

```
jQuery(function($) {
    function changeColor(e) {
        e.preventDefault();

        var self = $(this);

        self.ColorPicker({
            onChange: function(hsb, hex, rgb) {
                self.val('#' + hex);
            }
        });
    }
    $('form.niceform input').live('mouseup', changeColor);
}); 
```

您应该将函数`$(this)`外部`ColorPicker`放入变量中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:45:22.833

尝试：

```
jQuery(function($) {
    function changeColor(e) {
        var self = this;
        e.preventDefault();
        $(self).ColorPicker({
            onChange: function(hsb, hex, rgb) {
                $(self).attr('value', '#' + hex)
            }
        });
    }
    $('form.niceform input').live('mouseup', changeColor);
}) 
```

# php - PHP simple_html_dom 查找

> ID：13574425
> 
> 赞同：1
> 
> 时间：2012-11-26T22:42:02.507
> 
> 标签：php, simple-html-dom

我有几个页面可以从中获取 html。$html 是每个页面中带有 html 的对象。我现在从页面中获取图像，有些页面只有一张图片，有些页面没有。如果页面没有图像，我想在数组中放入一个值，例如`empty`. 所以我需要类似的东西，`if($html->find('img')==null)`但我找不到`simple_html_dom`. 有什么想法或其他方法吗？

```
//using simple_html_dom

public function GetImages($dataArray) {
    $url = 'http://page/';

    foreach ($dataArray as $link) {
        $html = file_get_html($url . $link);
        if(is_object($html)){

            foreach ($html->find('img') as $image) {

                $images[] = $image->src;
            }

        }

    }
    return $images;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:48:59.613

但是，我在这里并不完全理解您的问题，如果您拉出一个页面，您可以使用它
`if( isset($html->find("img")) )`来检查属性是否已设置。

```
// If page has any images you will add their src path to images array
if( isset($html->find("img")) )
{
    for($html->find('img') as $image) {
       if(isset($image))
       {
           $images[] = $image->src;
       } else {
           $images[] = 'Empty';
       }
    }
} 
```

`if(isset($image->src))`如果您可以重写您的问题将能够提供更好的帮助，那么使用它会更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-02T08:18:52.393

simple_html_dom 开发在几年前就停止了.. 使用积极开发的 DOMDocument ( [http://php.net/manual/en/class.domdocument.php](http://php.net/manual/en/class.domdocument.php) )，而不是 simple_html_dom ...无论如何

```
if(count($html->find('img'))==0){$noImages=true;}; 
```

（在 DOMDocument 中，您将使用 $domd->getElementsByTagName("img")，就像在 javascript webdev 中一样）

# windows-phone-7 - 如何在 ListBox 中将 TextBlock 完全自动居中并自动调整字体文本

> ID：13574426
> 
> 赞同：0
> 
> 时间：2012-11-26T22:42:03.143
> 
> 标签：windows-phone-7, xaml

您好需要在 Windows Phone 的 xaml 列表框中将 6 个文本块居中。我写了这段代码

```
 <!--ContentPanel - inserire ulteriore contenuto qui-->
    <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0">
        <ListBox x:Name="CountryListBox" HorizontalAlignment="Left"  Margin="6,6,0,151" Width="444">
            <ListBox.ItemTemplate>
                <DataTemplate>
                    <StackPanel Height="Auto" Width="500" HorizontalAlignment="Center">

                        <TextBlock Text="{Binding Word}" SizeChanged="TextBox_SizeChanged" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" HorizontalAlignment="Center" FontWeight="Bold" Foreground="Red" FontSize="64"/>
                        <TextBlock Text="{Binding Parola1}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" Height="70"  HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Parola3}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" Height="70"  HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Parola4}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" Height="70"  HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Parola5}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" Height="70"  HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Parola2}" TextWrapping="Wrap" Style="{StaticResource PhoneTextExtraLargeStyle}" Height="70"  HorizontalAlignment="Center"/>

                    </StackPanel>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        <Button Content="Giusto" Height="72" HorizontalAlignment="Left" Margin="47,462,0,0" Name="button1" VerticalAlignment="Top" Width="160" Click="button1_Click" />
        <Button Content="Sbagliato" Height="72" HorizontalAlignment="Left" Margin="251,462,0,0" Name="button2" VerticalAlignment="Top" Width="160" />
    </Grid> 
```

但我想用自动宽度和高度来做到这一点。有什么建议么？我还有一个小问题..如何在不使用其他对象的情况下自动调整文本块的字体大小？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T07:35:16.553

如果您想要自动高度和宽度，只需设置`Height="Auto"`和`Width="Auto"`。我没有得到你所期望的。最好显示正在发生的事情以及您所期望的屏幕截图。

此外，如果您希望文本块居中对齐，请尝试设置属性`HorizontalContentAlignment="Center"`

根据评论编辑：当您设置 时`TextWrapping="Wrap"`，文本将继续到下一行。不幸的是，Windows phone 中没有字体自动调整大小选项。也许你可以尝试使用转换器，像这样

```
<TextBlock Text="{Binding Word}" FontSize={{Binding Path=Word, Converter={StaticResource TexttoFontSizeConverter}}" /> 
```

在转换器中你可以做这样的事情

```
public class TexttoFontSizeConverter : IValueConverter
{
    #region IValueConverter Members

    public object Convert(object value, Type targetType, object parameter,
        System.Globalization.CultureInfo culture)
    {
        var text = (string)value;
        if (text.Length > 30)
            return 20;
        else
            return 30; //20 ad 30 are the font sizes
    }

    public object ConvertBack(object value, Type targetType, object parameter,
        System.Globalization.CultureInfo culture)
    {
        throw new NotSupportedException();
    }

    #endregion
} 
```

注意：我没有测试过这个

# javascript - 点击标签调用javascript

> ID：13574429
> 
> 赞同：0
> 
> 时间：2012-11-26T22:42:19.847
> 
> 标签：javascript, asp.net

我有一个gridview，在gridview 内部，我有一个标签，当用户单击该标签时，我调用了一个javascript 函数。我将该标签中的几个值传递给 javascript 函数。如果这些值中有别名。它会产生错误并且不会调用 javascript 函数。下面是我的代码。

```
<asp:TemplateField> 
    <ItemTemplate> 
        <label style="text-decoration: underline" onclick="javascript:GetSelectedRow('<%# Eval("ID") %>','<%# Eval("systempath") %>','','',1);"><%#Eval("ID") %></label> 
    </ItemTemplate> 
</asp:TemplateField> 
```

和javascript函数是

```
function GetSelectedRow(id, systempath, x, x, rowIndex) { 

    debugger; 
    var label = document.getElementById('<%=lbl_ID.ClientID %>'); 

    label.innerText = mclid + "|" + systempath; 
    document.getElementById('<%=hdnlblID.ClientID %>').value = id + "|" + systempath; 

    return false; 

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:52:00.243

试试这个

```
<label style="text-decoration: underline" onclick="javascript:GetSelectedRow('<%# Eval("ID") %>','<%# Eval("systempath").ToString().Replace("'", @"\'"); %>','','',1);"><%#Eval("ID") %></label> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:52:57.083

由于您在 ID 周围使用单引号，因此您需要转义和撇号：

```
var label = document.getElementById('<%=lbl_ID.ClientID.Replace("'", "\'") %>'); 
```

# java - java中DatagramPacket.getData().length和DatagramPacket.getLength()有什么区别

> ID：13574436
> 
> 赞同：2
> 
> 时间：2012-11-26T22:42:52.257
> 
> 标签：java, sockets, udp, datagram

在下面的代码段中，

```
DatagramPacket rPacket
rPacket  = new DatagramPacket(new byte[2000], 2000);
.. do some socket.receive .. 
```

java中DatagramPacket.getData().length和DatagramPacket.getLength()有什么区别

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:45:58.973

不同的是，第一个返回用于构造对象的数组的大小，它永远不会改变；第二个返回提供给构造函数的长度和最近接收的最小数据报的实际长度中较小的一个，每次接收都会改变。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:46:36.383

来自 DataGrammPacket 类的 javadoc

获取长度（）：`Returns the length of the data to be sent or the length of the data received.`

获取数据（）：`Returns the data buffer. The data received or the data to be sent starts from the <code>offset</code> in the buffer, and runs for <code>length</code> long.`

此外，您还必须知道 setData()：

```
 Set the data buffer for this packet. This sets the
     * data, length and offset of the packet.
     *
     * @param buf the buffer to set for this packet
     *
     * @param offset the offset into the data
     *
     * @param length the length of the data 
     *       and/or the length of the buffer used to receive data
 setData(byte[] buf, int offset, int length) 
```

构造函数还调用 setData()

# wordpress - 我的 Google Analytics（分析）帐户无法与 Wordpress 一起使用

> ID：13574441
> 
> 赞同：0
> 
> 时间：2012-11-26T22:43:22.143
> 
> 标签：wordpress, google-analytics

我目前正在建立一个 wordpress 网站，并试图在该网站上添加 Google Analytics。

要添加分析，我将代码复制并粘贴到`footer.php`. 该代码现在出现在所有页面上，但是当我查看我的 Google 帐户时，没有访问者被注册。

我立即通过手机访问了该网站并查看了实时更新选项卡，我的访问未注册。几个小时后我也访问了，但没有成功。

谁能告诉我我错过了什么/做错了什么？

我尝试使用您也可以下载的插件，但我再次没有在我的帐户上获得任何信息

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:51:21.853

见这里：[在哪里放置谷歌分析代码](https://stackoverflow.com/questions/5619950/where-to-put-google-analytics-code)

在这里：[http ://wordpress.org/support/topic/installing-google-analytics-5](http://wordpress.org/support/topic/installing-google-analytics-5)

尝试将代码放在结束`</head>`标记之前。

# c# - 尝试将文件发送到 C# 中的另一个类

> ID：13574442
> 
> 赞同：1
> 
> 时间：2012-11-26T22:43:27.477
> 
> 标签：c#, winforms, class

正如标题所暗示的那样，我试图将流阅读器获取的文件发送到另一个类，以便该类可以从中提取信息。我曾尝试在表单中提取它，但这让人感到困惑，而且我确定这是一种糟糕的做法。任何人都可以提出一种方法吗？

这是标识文件的类..

```
namespace DistanceEstimatorFinal
{
    public partial class Form1 : Form

        private void openDataListToolStripMenuItem_Click(object sender, EventArgs e)
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "CSV files (*.csv)|*.csv|Text files ( *.txt)|*.txt |All files (*.*)|*.*";
            if (ofd.ShowDialog(this).Equals(DialogResult.OK))
            {
                Stream fileStream = ofd.OpenFile();

                using (StreamReader reader = new StreamReader(fileStream))
                {

                }
            }
        } 
```

现在我需要某种方式将它发送到这里......我看不出如何：[

```
namespace DistanceEstimatorFinal
{

    public class dataPoints
    {
        List<dataPoint> Points;
        public dataPoints( )
        {
            Points = new List<dataPoint>();
            TextReader tr = new StreamReader();
            string input;
            while ((input = tr.ReadLine()) != null)
            {
                string[] bits = input.Split(',');
                dataPoint a = new dataPoint(bits[0],bits[1],bits[2]);              
                Points.Add(a);  

            }

            tr.Close();
        }

        internal dataPoint getItem(int p)
        {
            if (p < Points.Count)
            {
                return Points[p];
            }
            else
                return null;
        }
    }

} 
```

任何帮助将不胜感激

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:47:27.663

我只需将文件的路径传递给您的班级，然后打开文件进行阅读。

```
if (ofd.ShowDialog(this).Equals(DialogResult.OK))
{
    var path = ofd.FileName;

    //Pass the path to the dataPoints class and open the file in that class.
} 
```

您可以在类的构造函数中传递路径，也可以将路径作为参数传递给方法本身。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:47:06.680

UI 的工作实际上只是找出需要处理的文件。

我会让正在执行实际处理的业务对象也创建 StreamReader。

如果您不遵循该方法，您的 UI 将负责清理它自己不使用的资源（StreamReader）。

此外，通过将处理与 UI 中的事件处理程序完全分开，如果将来有必要，您可以更轻松地在单独的线程上处理文件。

# apache-flex - 使用我的自定义 ANT 任务时出错

> ID：13574443
> 
> 赞同：-1
> 
> 时间：2012-11-26T22:43:31.077
> 
> 标签：apache-flex, flex4, flash-builder

使用 Ant 任务生成自己的 SWF 时出现此错误。我已经将它部署到 bin-debug 和 bin-release 文件夹，这两个文件夹都应该在安全沙箱中。

> SecurityError：错误 #2148：SWF 文件 file:////Users/user/Documents/Projects/GIT/Project/bin-debug/Project.swf 无法访问本地资源 file:////Users/user/Documents/Projects /GIT/Project/bin-debug/framework_4.5.1.214‌​89.swf。只有 local-with-filesystem 和受信任的本地 SWF 文件可以访问本地资源。

如果我从 Flash Builder 运行构建或调试，项目会正确加载而不会出错。

这是我的构建脚本：

```
<mxmlc file="${PROJECT_MXML_APPLICATION}" output="${PROJECT_OUTPUT_SWF}">

    <source-path path-element="${FCLIB_SRC}"/>

</mxmlc> 
```

我也尝试在 mxmlc 调用中添加 use-network="true" 而没有任何变化。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T16:16:22.473

我必须将其上传到服务器“ [http://localhost/](http://localhost/) ”或“ [http://mydomain.com](http://mydomain.com) ”才能使其正常工作。我已将文件夹添加到受信任的沙箱中（通过右键单击并选择全局设置 > 首选项 > 受信任域 > 添加）。这并没有解决它（可能是新的 Flash Player Preferences 程序（Mac OSX）的问题。我可以检查受信任位置的 FlashBuilder.cfg（忘记位置）。

更深入的答案在[这里](https://stackoverflow.com/a/13589571/441016)。

# php - PHP Frontend and Rest API + OAuth，检测第三方应用

> ID：13574447
> 
> 赞同：2
> 
> 时间：2012-11-26T22:44:31.507
> 
> 标签：php, oauth

我正在构建一个 Rest API 和一个用 PHP 编写的前端。

我的问题是，当第三方应用程序尝试访问它时，我打算使用 OAuth 保护它。但是当我的前端使用 API 时，我不想使用 OAuth。当不是我的前端的 APP 尝试访问我的 API 时，我如何检测/识别。

什么是最好的策略？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:49:25.443

生成令牌并检查它是否存在。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:58:32.510

有很多方法可以解决这个问题：

您也许可以给 API 一个仅由前端服务器使用的别名，并为该 API 别名使用不同的身份验证机制（即密钥访问）。

您可以设置仅由前端服务器使用的特定自定义请求标头，并在该标头存在时使用您的备用身份验证机制。

您可以将一些附加数据与将请求标识为来自前端服务器的请求一起传递。

我个人会选择前两个之一，因为我不想不必要地更改数据结构。

# apache - Apache htaccess 规则转换为 Nginx 规则

> ID：13574448
> 
> 赞同：0
> 
> 时间：2012-11-26T22:44:39.117
> 
> 标签：apache, .htaccess, mod-rewrite, nginx

我需要为 nginx 服务器翻译一些 htaccess 规则，

我的 htaccess 是：

```
RewriteEngine On
RewriteBase /mysite
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /mysite/index.php/$1 [L]

SetOutputFilter DEFLATE

<ifModule mod_gzip.c>
  mod_gzip_on Yes
  mod_gzip_dechunk Yes
  mod_gzip_item_include file \.(html?|txt|css|js|php|pl)$
  mod_gzip_item_include handler ^cgi-script$
  mod_gzip_item_include mime ^text/.*
  mod_gzip_item_include mime ^application/x-javascript.*
  mod_gzip_item_exclude mime ^image/.*
  mod_gzip_item_exclude rspheader ^Content-Encoding:.*gzip.*
</ifModule>

<ifModule mod_expires.c>
  ExpiresActive On
  ExpiresDefault "access plus 1 seconds"
  ExpiresByType text/html "access plus 1 seconds"
  ExpiresByType image/gif "access plus 2592000 seconds"
  ExpiresByType image/jpeg "access plus 2592000 seconds"
  ExpiresByType image/png "access plus 2592000 seconds"
  ExpiresByType text/css "access plus 604800 seconds"
  ExpiresByType text/javascript "access plus 216000 seconds"
  ExpiresByType application/x-javascript "access plus 216000 seconds"
</ifModule> 
```

我已经翻译了这部分

```
RewriteEngine On
RewriteBase /mysite
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ /mysite/index.php/$1 [L] 
```

看起来像

```
if (!-f $request_filename){
  set $rule_0 1$rule_0;
}
if (!-d $request_filename){
  set $rule_0 2$rule_0;
}
if ($rule_0 = "21"){
  rewrite ^/(.*)$ /mysite/index.php/$1 last;
} 
```

可以吗？

然后我需要翻译 htaccess 的第二部分（如上所示）。

我怎么翻译呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T19:17:10.633

> ```
> if (!-f $request_filename){
>    set $rule_0 1$rule_0;
> }
> if (!-d $request_filename){
>    set $rule_0 2$rule_0;
> }
> if ($rule_0 = "21"){
>    rewrite ^/(.*)$ /bitfungus/index.php/$1 last;
> } 
> ```
> 
> 没事吧？`

不，它很丑。Nginx 不是 apache，您不应该在实际上不需要它们的地方使用重写（在大约 95% 的情况下，您不需要在 nginx 中进行重写）。

[http://wiki.nginx.org/Pitfalls](http://wiki.nginx.org/Pitfalls)

正确的：

```
try_files $uri $uri/ /bitfungus/index.php$uri; 
```

# jsp - 如何读出（ ) JSP 中的 taglib 属性

> ID：13574449
> 
> 赞同：1
> 
> 时间：2012-11-26T22:44:39.073
> 
> 标签：jsp, attributes, taglib

我只想读出我之前在 JSP 中设置的属性（在 .tld 中）。我只是不知道如何输出它们。在尝试了[如何使用 <c:out value=...> taglib](https://stackoverflow.com/questions/3028922/how-to-use-cout-value-taglib)一文中的建议后，我得到一个空值输出。所以变量（例如“instanzVar1”）似乎超出了范围。

**这是我的.java：**

```
public class BirolName extends SimpleTagSupport implements SimpleTag {
String instanzVar1;
Boolean instanzVar2;
int instanzVar3;    

@Override
public void doTag() throws JspException, IOException {
    //Zum Schreiben in die JSP "JSPWriter"
    JspWriter outputJSP = getJspContext().getOut();
    outputJSP.println("Birol was here :-) (Taglib von Java -nach-> JSP hat funktionniert!)");
    outputJSP.println("Die eingegebenen Paramter über die JSP waren:");
    outputJSP.println("<br /><b>");
    outputJSP.println("Paramter 1:"+instanzVar1);
    outputJSP.println("<br />");
    outputJSP.println("Paramter 2:"+instanzVar2);
    outputJSP.println("<br />");
    outputJSP.println("Paramter 3:"+instanzVar3);
    outputJSP.println("</b><br />");
}

public String getInstanzVar1() {
    return instanzVar1;
}

public void setInstanzVar1(String instanzVar1) {
    this.instanzVar1 = instanzVar1;
}
......
} 
```

**我的 .tld:**

```
 <?xml version="1.0" encoding="UTF-8"?>
<taglib version="2.0" xmlns="http://java.sun.com/xml/ns/j2ee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee web-jsptaglibrary_2_0.xsd">
    <tlib-version>1.0</tlib-version>
    <short-name>st</short-name>
    <tag>
        <name>birolNameTag</name>
        <tag-class>st.BirolName</tag-class>
        <body-content>empty</body-content>
        <attribute>
            <name>instanzVar1</name>
            <required>true</required>
            <rtexprvalue>true</rtexprvalue>
        </attribute>
        <attribute>
            <name>instanzVar2</name>
            <required>true</required>
            <rtexprvalue>true</rtexprvalue>
        </attribute>
        <attribute>
            <name>instanzVar3</name>
            <required>true</required>
            <rtexprvalue>true</rtexprvalue>
        </attribute>
    </tag>
</taglib> 
```

**至少是.jsp：**

```
 <!-- Einbindung des Taglibs -->
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib uri="/WEB-INF/st.tld" prefix="st"%>
<%@taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>
<p>
    Aufruf der Taglib mit "taglibPrefix:NameDesTag"
    <br /> <st:birolNameTag instanzVar1="BirolString" instanzVar2="true" instanzVar3="1"/>
    <br /><br />

    <jsp:useBean id="a" class="st.BirolName"/>
    Ausgabe des Paramters: <c:out value = "${a.instanzVar1}" />
</p> 
```

解决方案很可能非常简单。但我并没有真正得到我想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:18:54.323

WHat you're doing makes no sense. You should see a JSP tag as a Java method, taking arguments. Once the method has been called, you can't get a handle on the method and ask it what the arguments were the last tie it was called.

The container will have a pool of `BirolName` instance, and will use them on several pages, in several threads.

And when you do

```
<jsp:useBean id="a" class="st.BirolName"/>, 
```

it's equivalent to doing

```
st.BirolName a = new st.BirolName(); 
```

So you can't expect finding the arguments to the tag you used before from this new instance of the tag class.

When you pass a value to the instanzVar1 attribute of the tag, you're not setting any JSP attribute. You're just passing an argument to your tag. To set an page scope attribute, you must use the `c:set` tag:

```
<c:set var="someAttribute" value="someValue"/>
${someAttribute} <%-- prints someValue --%> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T11:08:20.093

我找到了一个很好的解决方案。简单地在 .java 标记类中使用这段代码：

```
JspContext pcontext = getJspContext();    
pcontext.setAttribute("myAttribute", this.instanzVar1.concat(this.instanzVar1), Util.getScope("request")); 
```

“ **setAttribute()** ”让我可以将值保存在属性中（此处为“myAttribute”）。描述：在我的例子中，我使用我的 taglib 属性在 JSP 中设置属性。然后我可以将它们设置在我的 .java 中，只需将它们作为 setAttribute 中的第二个参数放入（这里：“ **this.instanzVar1.concat(this.instanzVar1** ”）。现在我有了我想要的，因为这个新属性“在 .java 中设置的 myAttribute" 可以在 JSP 中使用 ${myAttribute} 调用。

# android - Android 片段错误

> ID：13574451
> 
> 赞同：0
> 
> 时间：2012-11-26T22:44:45.360
> 
> 标签：android, android-fragments

我有一个非常基本的应用程序，我试图在 MainActivity 上创建 ListFragment。

我不断收到以下运行时错误：

> java.lang.RuntimeException：无法启动活动 ComponentInfo{com.proto1.listfragment/com.proto1.listfragment.MainActivity}：android.view.InflateException：二进制 XML 文件第 7 行：膨胀类片段时出错

我有两节课。

第一个是MainActivity.java，如下图：

包 com.proto1.listfragment；

```
import android.os.Bundle;
import android.support.v4.app.FragmentActivity;
import android.view.Menu;

public class MainActivity extends FragmentActivity {

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
    }

    @Override
    public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    }
} 
```

第二个是与listfragment SectionsList相关的类，如下图：

```
package com.proto1.listfragment;

import android.os.Bundle;
import android.support.v4.app.ListFragment;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.ArrayAdapter;

    public class SectionsList extends ListFragment {

        //Create an array to hold the sections
        String sections [] = new String []{
            "Starters", "Mains", "Sides", "Desserts", "Drinks"
        };

        @Override
        public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState) {  

            //Create array adapter to store list of menu sections
            ArrayAdapter<String> adapter = new ArrayAdapter<String>(inflater.getContext(), android.R.layout.simple_list_item_1,sections);

            //Set list adapter of fragment
            setListAdapter(adapter);

            return super.onCreateView(inflater, container, savedInstanceState);     
        }

    } 
```

然后我有一个名为 activity_main 的 XML 布局文件，如下所示：

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="fill_parent"
android:orientation = "horizontal"
android:layout_height="fill_parent" >

<fragment 
    android:name = "com.proto1.listfragment.MainActivity"
    android:id="@+id/sectionFrag"
    android:layout_width = "wrap_content"
    android:layout_height = "fill_parent"/>

<TextView
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:text="@string/hello_world"
    tools:context=".MainActivity" /> 
```

我看不出为什么会产生这个错误。有人可以解释一下这个问题吗？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:47:47.703

FragmentActivity 本身不是 Fragment。相反，它是一种轻松与 Fragments 交互的方式。您在 xml 中调用的 Fragment 应该是 SectionList。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:53:13.803

将以下内容编辑到您的 activity_main xml 文件中

```
<fragment 
android:name = "com.proto1.listfragment.SectionList"
android:id="@+id/sectionFrag"
android:layout_width = "wrap_content"
android:layout_height = "fill_parent"/> 
```

# parameter-passing - 带有 json 对象参数的 javascript 函数

> ID：13574458
> 
> 赞同：0
> 
> 时间：2012-11-26T22:45:47.920
> 
> 标签：parameter-passing, javascript

如果我有许多采用 json 对象参数的函数，在函数内部使用它们之前是否将它们分配给变量是否有任何区别：

```
Function doSomething(data){
var abc = data;

abc.filter….etc.

} 
```

比。

```
Function doSomething(data){

Data.filter….etc

} 
```

一种方式比另一种更好吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:51:27.123

这没有什么区别，以您为例，新变量是多余的。最好不要创建额外的变量。如果您的 JSON 嵌套严重，这样做可能会很有用。

```
data = { foo: { bar: { baz: [] } } }

function doSomething(data) {
  var innerData = data.bar.baz;
  for(var i=0; i<innerData.length; i+) {
    // Whatever.
  }     
} 
```

这将使您不必一直参考`data.foo.bar.baz`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:46:53.200

是的，最好不要创建无用的额外变量。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T22:49:52.347

`abc`在第一个示例中创建变量是完全多余的。

考虑如何真正评估它：

```
function doSomething() {
    var data = arguments[0];
    var abc = data; //why?
} 
```

# java - 复制目录和文件时需要有 JProgress bar 来衡量进度

> ID：13574461
> 
> 赞同：4
> 
> 时间：2012-11-26T22:45:54.763
> 
> 标签：java, swing, file-io, swingworker, jprogressbar

我有下面的代码来复制目录和文件，但不确定在哪里测量进度。有人可以帮助
我在哪里可以测量复制了多少并将其显示在 JProgress 栏中

```
public static void copy(File src, File dest)
throws IOException{
if(src.isDirectory()){
        if(!dest.exists()){ //checking whether destination directory exisits
           dest.mkdir();
           System.out.println("Directory copied from " 
                        + src + "  to " + dest);
        }

        String files[] = src.list();

        for (String file : files) {

           File srcFile = new File(src, file);
           File destFile = new File(dest, file);

           copyFolder(srcFile,destFile);
        }
  }else{
        InputStream in = new FileInputStream(src);
          OutputStream out = new FileOutputStream(dest); 

          byte[] buffer = new byte[1024];

          int length;

          while ((length = in.read(buffer)) > 0){
           out.write(buffer, 0, length);
          }

          in.close();
          out.close();
          System.out.println("File copied from " + src + " to " + dest);
  } 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-11-27T01:46:23.780

我刚刚为您编写了这个实用程序 :)（大约需要 3 个小时）：

![在此处输入图像描述](../Images/81bf5bef0ced405064f516e0edc23f19.png)

```
import java.awt.BorderLayout;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import java.awt.event.WindowAdapter;
import java.awt.event.WindowEvent;
import java.beans.PropertyChangeEvent;
import java.beans.PropertyChangeListener;
import java.io.BufferedInputStream;
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileOutputStream;
import java.io.IOException;
import java.util.List;

import javax.swing.BorderFactory;
import javax.swing.JButton;
import javax.swing.JFrame;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.JProgressBar;
import javax.swing.JScrollPane;
import javax.swing.JTextArea;
import javax.swing.JTextField;
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;
import javax.swing.event.DocumentEvent;
import javax.swing.event.DocumentListener;
import javax.swing.text.DefaultCaret;

public class FileCopierUtility extends JFrame implements ActionListener, PropertyChangeListener
{
    private static final long serialVersionUID = 1L;

    private JTextField txtSource;
    private JTextField txtTarget;
    private JProgressBar progressAll;
    private JProgressBar progressCurrent;
    private JTextArea txtDetails;
    private JButton btnCopy;
    private CopyTask task;

    public FileCopierUtility()
    {
        buildGUI();
    }

    private void buildGUI()
    {
        setTitle("File Copier Utility");
        setDefaultCloseOperation(DO_NOTHING_ON_CLOSE);

        addWindowListener(new WindowAdapter()
        {
            @Override
            public void windowClosing(WindowEvent e)
            {
                if(task != null) task.cancel(true);
                dispose();
                System.exit(0);
            }
        });

        JLabel lblSource = new JLabel("Source Path: ");
        JLabel lblTarget = new JLabel("Target Path: ");
        txtSource = new JTextField(50);
        txtTarget = new JTextField(50);
        JLabel lblProgressAll = new JLabel("Overall: ");
        JLabel lblProgressCurrent = new JLabel("Current File: ");
        progressAll = new JProgressBar(0, 100);
        progressAll.setStringPainted(true);
        progressCurrent = new JProgressBar(0, 100);
        progressCurrent.setStringPainted(true);
        txtDetails = new JTextArea(5, 50);
        txtDetails.setEditable(false);
        DefaultCaret caret = (DefaultCaret) txtDetails.getCaret();
        caret.setUpdatePolicy(DefaultCaret.ALWAYS_UPDATE);
        JScrollPane scrollPane = new JScrollPane(txtDetails, JScrollPane.VERTICAL_SCROLLBAR_AS_NEEDED, JScrollPane.HORIZONTAL_SCROLLBAR_AS_NEEDED);
        btnCopy = new JButton("Copy");
        btnCopy.setFocusPainted(false);
        btnCopy.setEnabled(false);
        btnCopy.addActionListener(this);

        DocumentListener listener = new DocumentListener()
        {
            @Override
            public void removeUpdate(DocumentEvent e)
            {
                boolean bEnabled = txtSource.getText().length() > 0 && txtTarget.getText().length() > 0;
                btnCopy.setEnabled(bEnabled);
            }

            @Override
            public void insertUpdate(DocumentEvent e)
            {
                boolean bEnabled = txtSource.getText().length() > 0 && txtTarget.getText().length() > 0;
                btnCopy.setEnabled(bEnabled);
            }

            @Override
            public void changedUpdate(DocumentEvent e){}
        };

        txtSource.getDocument().addDocumentListener(listener);
        txtTarget.getDocument().addDocumentListener(listener);

        JPanel contentPane = (JPanel) getContentPane();
        contentPane.setBorder(BorderFactory.createEmptyBorder(5, 5, 5, 5));

        JPanel panInputLabels = new JPanel(new BorderLayout(0, 5));
        JPanel panInputFields = new JPanel(new BorderLayout(0, 5));
        JPanel panProgressLabels = new JPanel(new BorderLayout(0, 5));
        JPanel panProgressBars = new JPanel(new BorderLayout(0, 5));

        panInputLabels.add(lblSource, BorderLayout.NORTH);
        panInputLabels.add(lblTarget, BorderLayout.CENTER);
        panInputFields.add(txtSource, BorderLayout.NORTH);
        panInputFields.add(txtTarget, BorderLayout.CENTER);
        panProgressLabels.add(lblProgressAll, BorderLayout.NORTH);
        panProgressLabels.add(lblProgressCurrent, BorderLayout.CENTER);
        panProgressBars.add(progressAll, BorderLayout.NORTH);
        panProgressBars.add(progressCurrent, BorderLayout.CENTER);

        JPanel panInput = new JPanel(new BorderLayout(0, 5));
        panInput.setBorder(BorderFactory.createCompoundBorder(BorderFactory.createTitledBorder("Input"), BorderFactory.createEmptyBorder(5, 5, 5, 5)));
        JPanel panProgress = new JPanel(new BorderLayout(0, 5));
        panProgress.setBorder(BorderFactory.createCompoundBorder(BorderFactory.createTitledBorder("Progress"), BorderFactory.createEmptyBorder(5, 5, 5, 5)));
        JPanel panDetails = new JPanel(new BorderLayout());
        panDetails.setBorder(BorderFactory.createCompoundBorder(BorderFactory.createTitledBorder("Details"), BorderFactory.createEmptyBorder(5, 5, 5, 5)));
        JPanel panControls = new JPanel(new BorderLayout());
        panControls.setBorder(BorderFactory.createEmptyBorder(5, 0, 5, 0));

        panInput.add(panInputLabels, BorderLayout.LINE_START);
        panInput.add(panInputFields, BorderLayout.CENTER);
        panProgress.add(panProgressLabels, BorderLayout.LINE_START);
        panProgress.add(panProgressBars, BorderLayout.CENTER);
        panDetails.add(scrollPane, BorderLayout.CENTER);
        panControls.add(btnCopy, BorderLayout.CENTER);

        JPanel panUpper = new JPanel(new BorderLayout());
        panUpper.add(panInput, BorderLayout.NORTH);
        panUpper.add(panProgress, BorderLayout.SOUTH);

        contentPane.add(panUpper, BorderLayout.NORTH);
        contentPane.add(panDetails, BorderLayout.CENTER);
        contentPane.add(panControls, BorderLayout.SOUTH);

        pack();
        setLocationRelativeTo(null);
    }

    @Override
    public void actionPerformed(ActionEvent e)
    {
        if("Copy".equals(btnCopy.getText()))
        {
            File source = new File(txtSource.getText());
            File target = new File(txtTarget.getText());

            if(!source.exists())
            {
                JOptionPane.showMessageDialog(this, "The source file/directory does not exist!", "ERROR", JOptionPane.ERROR_MESSAGE);
                return;
            }

            if(!target.exists() && source.isDirectory()) target.mkdirs();
            else
            {
                int option = JOptionPane.showConfirmDialog(this, "The target file/directory already exists, do you want to overwrite it?", "Overwrite the target", JOptionPane.YES_NO_OPTION);
                if(option != JOptionPane.YES_OPTION) return;
            }

            task = this.new CopyTask(source, target);
            task.addPropertyChangeListener(this);
            task.execute();

            btnCopy.setText("Cancel");
        }
        else if("Cancel".equals(btnCopy.getText()))
        {
            task.cancel(true);
            btnCopy.setText("Copy");
        }
    }

    @Override
    public void propertyChange(PropertyChangeEvent evt)
    {
        if("progress".equals(evt.getPropertyName()))
        {
            int progress = (Integer) evt.getNewValue();
            progressAll.setValue(progress);
        }
    }

    public static void main(String[] args)
    {
        SwingUtilities.invokeLater(new Runnable()
        {   
            @Override
            public void run()
            {
                new FileCopierUtility().setVisible(true);
            }
        });
    }

    class CopyTask extends SwingWorker<Void, Integer>
    {
        private File source;
        private File target;
        private long totalBytes = 0L;
        private long copiedBytes = 0L;

        public CopyTask(File source, File target)
        {
            this.source = source;
            this.target = target;

            progressAll.setValue(0);
            progressCurrent.setValue(0);
        }

        @Override
        public Void doInBackground() throws Exception
        {
            txtDetails.append("Retrieving some info ... ");
            retrieveTotalBytes(source);
            txtDetails.append("Done!\n");

            copyFiles(source, target);
            return null;
        }

        @Override
        public void process(List<Integer> chunks)
        {
            for(int i : chunks)
            {
                progressCurrent.setValue(i);
            }
        }

        @Override
        public void done()
        {
            setProgress(100);
            btnCopy.setText("Copy");
        }

        private void retrieveTotalBytes(File sourceFile)
        {
            File[] files = sourceFile.listFiles();
            for(File file : files)
            {
                if(file.isDirectory()) retrieveTotalBytes(file);
                else totalBytes += file.length();
            }
        }

        private void copyFiles(File sourceFile, File targetFile) throws IOException
        {
            if(sourceFile.isDirectory())
            {
                if(!targetFile.exists()) targetFile.mkdirs();

                String[] filePaths = sourceFile.list();

                for(String filePath : filePaths)
                {
                    File srcFile = new File(sourceFile, filePath);
                    File destFile = new File(targetFile, filePath);

                    copyFiles(srcFile, destFile);
                }
            }
            else
            {
                txtDetails.append("Copying " + sourceFile.getAbsolutePath() + " ... ");

                BufferedInputStream bis = new BufferedInputStream(new FileInputStream(sourceFile));
                BufferedOutputStream bos = new BufferedOutputStream(new FileOutputStream(targetFile));

                long fileBytes = sourceFile.length();
                long soFar = 0L;

                int theByte;

                while((theByte = bis.read()) != -1)
                {
                    bos.write(theByte);

                    setProgress((int) (copiedBytes++ * 100 / totalBytes));
                    publish((int) (soFar++ * 100 / fileBytes));
                }

                bis.close();
                bos.close();

                publish(100);

                txtDetails.append("Done!\n");
            }
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T23:02:30.050

To accomplish this, you have to figure out the number of copy operations in advance. You did not include your copyFolder method, but I assume that you would like to perform a recursive copy. If so, you have to traverse the whole directory tree to figure out how many files you are going to copy. This can get nasty for the user when dealing with large directory structures. (This is why modern operation systems often display an annoying "preparing to copy..." - message before the operation starts and progress is displayed)

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-11-26T23:09:56.900

显示文件的进度相当简单......

```
long expectedBytes = src.length(); // This is the number of bytes we expected to copy..
byte[] buffer = new byte[1024];
int length;
long totalBytesCopied = 0; // This will track the total number of bytes we've copied
while ((length = in.read(buffer)) > 0){
    out.write(buffer, 0, length);
    totalBytesCopied += length;
    int progress = (int)Math.round(((double)totalBytesCopied / (double)expectedBytes) * 100);
    setProgress(progress); // From SwingWorker
} 
```

如果您想提供有关要复制/已开始复制的总字节数的信息，它会变得有点复杂。

你在这里有选择。您可以预先扫描所有文件夹（我会将文件放入某种队列中）并计算要复制的总字节数/文件数。然后开始实际的复制过程。

为此更新进度与之前的示例一样简单，只是您将累积在整个过程中复制的字节总数，而不是单个文件。

或者...

您可以使用生产者/消费者算法。这个想法是启动一个线程/工作者，其唯一职责是扫描文件夹以查找要复制的文件并将它们放入中央/共享队列（这是生产者）。

您将拥有第二个线程/工作者，它将弹出该队列的下一项（阻塞到新文件变得可用）并实际复制该文件。

这里的技巧是让队列维护一个计数器来记录通过它的文件和字节总数，这将允许您调整总作业的正在进行的进度......

# android - AsyncTask 在类中调用另一个函数

> ID：13574462
> 
> 赞同：2
> 
> 时间：2012-11-26T22:45:57.070
> 
> 标签：android, android-asynctask

基本上，我是否必须将我想在 doInBackground 中的另一个线程上运行的代码，或者我可以在 doInBackground 中调用另一个函数/类/whatever-it-is-functions-are-call-in-JAVA 并让它异步运行？IE：（我在网上找到的示例代码）

```
 protected String doInBackground(String... params) {
        for(int i=0;i<5;i++) {
            try {
                Thread.sleep(1000);
            } catch (InterruptedException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
        TextView txt = (TextView) findViewById(R.id.output);
        txt.setText("Executed");
        return null;
  } 
```

是我看到它完成的方式，但我可以这样做：

```
 protected String doInBackground(String... params) {
           postToServer(x,y,z,h);
      } 
```

并让它调用我已经编写的函数，然后让该函数在另一个线程中运行？有时我的 HTTP 服务器响应有点慢（目前它只是一个低级测试服务器），如果我的 postToServer() 调用超过 5 秒，Android 会自动弹出终止进程框，并且还会禁用我的 UI，直到postToServer() 调用完成。这是一个问题，因为我正在开发一个 GPS 跟踪应用程序（内部为我工作的公司）并且关闭跟踪的 UI 选项冻结，直到我的 postToServer() 完成，这有时不会发生。如果这个问题已经得到解答，我深表歉意，我尝试搜索，但没有找到任何可以按照我希望的方式工作的示例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T22:53:55.140

您可以这样做，但您必须将 UI 更新移动到`onPostExecute`它在 UI 线程上运行时。

```
public MyAsyncTask extends AsyncTask<foo, bar, baz> {

    ...

    protected String doInBackground(String... params) {
       postToServer(x,y,z,h);
    }  

    protected void onPostExecute(Long result) {
        TextView txt = (TextView) findViewById(R.id.output);
        txt.setText("Executed");
    }

    ....

} 
```

您可能希望将 TextView 传递给 的构造函数`AsyncTask`并将其存储为 WeakReference。私人最终弱参考文本视图参考；

```
public MyAsyncTask(TextView txt) {
    textViewReference = new WeakReference<TextView>(txt);
} 
```

然后在 onPostExecute 中，您将确保 TextView 引用仍然存在。

```
protected void onPostExecute(Long result) {
    TextView txt = textViewReference.get();
    if (txt != null)
        txt.setText("Executed");
} 
```

如果您想通知用户任务正在执行，我会在调用`AsyncTask`.

```
 myTextView.setText("Update in progress...");
 new MyAsyncTask().execute(); 
```

然后在`onPostExecute`设置`TextView`中说“更新完成”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:59:31.593

是的，您可以，对您的`postToServer`方法的调用（这是 java 中的名称）将在主线程之外运行。`doInBackground`an 方法中的所有内容都`AsyncTask`在池线程上运行，但请确保不要直接调用它！而是调用`execute`您的 asynktask，android 框架将为您完成工作并`doInBackground`在另一个线程上运行。

尝试做这样的事情：

```
new AsyncTask<Void, Void, Void>() {
    @Override
    // this runs on another thread
    protected Void doInBackground(Void... params) {
        // assuming x, y, z, h are visible here
        postToServer(x, y, z, h);
        return null;
    }

    @Override
    // this runs on main thread
    protected void onPostExecute(Void result) {
        TextView txt = (TextView) findViewById(R.id.output);
        txt.setText("Executed");
    }

}.execute(); // call execute, NOT doInBackGround 
```

另外，请注意 的所有其他方法`AsyncTask`，例如`onPostExecute`在主线程上运行，因此请避免重载它们。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T22:54:12.850

你试过第二种方法吗？

从您发布的内容看来，在第二个示例中它应该可以正常工作。

但是（可能与您的问题无关？）在您的第一个示例中，我认为它会失败，因为您试图从后台线程更改 UI。你想把操纵 TextView 的部分放在里面`onPostExecute()`而不是`doInBackground()`

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-09-19T10:45:58.813

基本上底线是 doInBackground() 方法不能与 Ui 线程或主线程交互。这就是为什么当您尝试与 doInBackground () 中的 TextView 交互时，它会导致 UI 线程崩溃，因为这是非法的。所以如果任何时候你想与 UI 线程交互，当你在 doInBackground 上工作时，你需要重写 OnPostExecute() //这个函数在 doInBackground 函数作业完成时被调用。因此，当您在 doInBackground () 或您在 doInBackground () 中完成工作时，您可以通过此更新 UI 线程内容

# android-intent - 您将意图放在 Eclipse 中的什么位置

> ID：13574463
> 
> 赞同：0
> 
> 时间：2012-11-26T22:45:58.607
> 
> 标签：android-intent

我是开发 Android 应用程序的新手，我想知道将 Intents 放在哪里，或者 send message() 方法在哪里。这是我正在谈论的链接[http://developer.android.com/training/basics/firstapp/starting-activity.html#BuildIntent](http://developer.android.com/training/basics/firstapp/starting-activity.html#BuildIntent)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:14:44.653

```
Open the MainActivity class and add the corresponding method:

/** Called when the user clicks the Send button */
public void sendMessage(View view) {
    // Do something in response to button
} 
```

它就在教程中

# java - 使用错误的url文本无法连接时如何处理jsoup？

> ID：13574470
> 
> 赞同：0
> 
> 时间：2012-11-26T22:46:13.593
> 
> 标签：java, android, jsoup

我已经搜索、搜索、阅读和测试......包括：/6557673/jsoup-cant-extract-stock-price-from-the-webpage - 这是我发现的最接近的问题，但我的观点有点不同。我正在从具有动态内容的 url 中抓取文本。只有 URL 的最后一段会有所不同，例如这里的问题编号。我的问题是，如果我输入一个不存在的页码，我会立即崩溃，例如：“应用程序已意外停止”。它记录“字符串索引超出范围 -1”，这是有道理的。

有没有办法在执行该行之前执行正则表达式 inString 检查之类的操作？

我的 url 字符串如下所示：

```
"http://whatever.website.com/ + dypageno + ".html"; 
```

和代码部分：

```
try{
    doc = Jsoup.connect(srchStr).get();
        if (doc == null){
            Toast.makeText(this, "Could not locate", Toast.LENGTH_SHORT);
   }else{
   String grabbedtxt = doc.select("h1").text();
   String grabbed=grabbedtxt.substring(grabbedtxt.indexOf("$"));
   grabbed = "Response Today:\r \n \r \n" + grabbed + "\r \n \r \n";
   et.setText(grabbed);}    
   }
catch (IOException e) {
            // TODO Auto-generated catch block
            e.printStackTrace();
            et.setText("Page not found.");
        }
} 
```

正如我所说，在使用错误的 url 之前，这可以正常工作。我尝试将 try/catch 限制为仅连接语句、不同的异常等，但无济于事。我已经剃了光头，所以我没有头发可以拔！谁能建议我在这里学习一些东西？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:03:55.660

在您的代码中，您应该检查是否`grabbedtxt`为空`String`。这

```
doc.select ("h1").text () 
```

`String`如果`h1`标签不存在，则可能返回空。以下代码说明了这一点：

```
import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;

class Main {
    public static void main(String[] args) throws Exception {
        final Document doc = Jsoup.parse("<html><head/><body/></html");
        String grabbedtxt = doc.select("h1").text();
        if (grabbedtxt.contains("$")) {
            String grabbed = grabbedtxt.substring(grabbedtxt.indexOf("$"));
            System.out.println("Response Today: " + grabbed);
        }
        else {
            System.out.println("No response!");
        }
    }
} 
```

这将打印`No response!`.

# jquery - 使用 .toggle() 向上/向下滑动隐藏 Div 的问题

> ID：13574471
> 
> 赞同：0
> 
> 时间：2012-11-26T22:46:17.140
> 
> 标签：jquery, easing

您能否看一下这个[JSFIDDLE](http://jsfiddle.net/Behseini/CGbCv/1/)示例，我正在尝试在鼠标悬停时从下到上创建隐藏 div 的平滑动画。如您所见，div 从左下角出现，但我想从下到上对其进行动画处理。我尝试使用 animate() 但我不知道如何将隐藏的 div 雕像从隐藏更改？这是我正在使用的代码：

```
$(document).ready(function() {
  $('#handler').hover(function(){$('#hidden').toggle(1000)});
});​ 
```

你能告诉我如何使用 jQuery 缓动插件来做这样的事情吗？谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:49:28.930

尝试`slideToggle`代替`toggle`

[http://jsfiddle.net/CGbCv/2/](http://jsfiddle.net/CGbCv/2/)

该`.slideToggle()`方法对匹配元素的高度进行动画处理。这会导致页面的下部向上或向下滑动，似乎显示或隐藏项目。如果元素最初是显示的，它将是`hidden;`隐藏的，它将被显示。根据需要保存和恢复显示属性。如果一个元素的显示值为 inline ，则被隐藏并显示，它将再次显示`inline`。当隐藏动画后高度达到 0 时，显示样式属性设置为 none，以确保元素不再影响页面的布局。

[http://api.jquery.com/slideToggle/](http://api.jquery.com/slideToggle/)

# css - 居中导航栏 - CSS

> ID：13574475
> 
> 赞同：2
> 
> 时间：2012-11-26T22:46:35.830
> 
> 标签：css, list, navigation, centering

我正在制作自己的博客，但我还没有域名，所以它还没有上线（我一直在从一个文件夹构建网站，其中有不同的目录作为页面）。我一直在写博客，我正在寻找一个简单的导航菜单。我在网上找到了一个。我正在尝试使导航栏居中，并且我尝试了许多适用于其他人网站的解决方案，但它不适用于我的网站。这是代码（我已将其调整为我自己的颜色和导航标题）

```
<ul id="list-nav">
 <li><a href="../index.html">Home</a></li>
 <li><a href="../books/books.html">Books</a></li>
 <li><a href="about.html">About</a></li>
 <li><a href="../contact/contact.html">Contact</a></li>
</ul> 
```

这是CSS：

```
ul.list-nav {
 list-style:none;
 width:525px;
 margin-right: auto;
 margin-left: auto;
}

ul#list-nav li {
 display:inline;
}

ul#list-nav li a {
 text-decoration:none;
 padding:5px 0;
 width:150px;
 background:#383838;
 color:#eee;
 float:left;
 border-left:1px solid #fff;
 }

ul#list-nav li a:hover {
 margin-right: auto;
 margin-left: auto;
 background:#cccccc;
 color:#000;
 } 
```

“帮我欧比旺克诺比你我唯一的希望！”

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:51:30.010

您的第一个 CSS 选择器正在寻找`ul`具有 的**类**而`list-nav`不是*id*的`list-nav`。将您的第一个 CSS 规则更改为：

```
ul#list-nav {
    padding: 0;
    margin: 0;
    list-style: none;
    width: 525px;
    margin: 0 auto;
} 
```

你的导航栏神奇地居中。请参阅此 jsFiddle 进行工作演示 > [http://jsfiddle.net/TLaN5/](http://jsfiddle.net/TLaN5/)。显然，您需要修改父项的宽度`ul`以适应其中元素的正确宽度，但您应该明白这一点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:52:11.723

我将`wrap`整个页面放在里面`<div class="wrap">`。您已`margin`在代码中声明了两次，因此我将删除第一次出现并保留如下：

```
ul#list-nav {
  padding: 0;
  list-style: none;
  width: 725px; //NOTE I have increased the width value.
  margin: 0 auto;
} 
```

另外，找

```
ul { 
     display: inline;
     text-decoration: none;
     color: black;} 
```

[大约第 20 行] 并删除`display: inline;`规则。这应该可以解决您的问题。[在此处](http://jsfiddle.net/bborisovs/ZLYXr/2/)查看实时示例。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:18:49.003

您可以为 ul 定义大小并将其内容居中（确实删除了 display-inline）

```
ul {
width: 960px;
margin: 0 auto;
text-align: center;
} 
```

然后将子 li 元素显示为内联块：

```
ul li {
display: inline-block;
} 
```

**inline-block 属性在 ie7 中不起作用，因此请先检查您的浏览器目标...**

另一种方法是使用好的 ol'

```
ul li {
float: left;
}

ul:after {
display: block;
content: "";
clear: both;
} 
```

但是 li 不会在 ul 中居中，如果您绝对想动态地执行此操作（无需为每个 li 分配固定的 with），则必须使用 javascript。

# java - JPA/Hibernate 能否与 jOOQ 等其他持久性框架结合使用

> ID：13574478
> 
> 赞同：8
> 
> 时间：2012-11-26T22:46:50.643
> 
> 标签：java, hibernate, jpa, orm, jooq

我们有一个域，其中 90% 的类非常简单，可以在数据库中轻松地 1:1 映射。我很高兴 Hibernate 与 spring-data-jpa 相结合如何为这些类消除了大量的琐事。

然而，该域的其余部分具有挑战性，出于多种原因，我不想直接将其映射到数据库表。

我做了实验来引入由 Hibernate 管理的中间 bean，并将这些 bean 映射到我的域，当所有关系都从具有挑战性的部分到容易的部分时，这很有效。当我有由 Hibernate 管理的“简单”类引用在自定义 Java 代码中映射的“具有挑战性”类而不是直接由休眠管理时，这种方法会失败。

这时我意识到我无法自定义 Hibernate 并插入某种允许我即时进行此类转换的 ObjectFactory。

- 编辑 -

我的问题是什么：在使用 JPA 时，让实体中的数据库关注为零的 DDD 样式域层的最简单方法是什么？在 DDD 中，所有数据库问题都由通常与 DAO 协作的存储库处理。

实体中的零 DB 关注意味着域类中没有 JPA 注释或映射配置。一种方法是让 JPA（或其他持久性技术）管理映射到域实体的 TO。但是，如果我采用这条路线，则我必须拥有所有实体，即使是最简单的实体（想想地址）也必须通过映射层。

我想为琐碎的实体使用像 JPA 这样的“懒惰”的东西，并能够将它们与“手动”管理的其他实体混合使用。目前我不知道允许我从 JPA 托管实体链接到非 JPA 托管实体的聪明解决方案。我总是可以检索 JPA 实体，然后通过第二次调用检索非 JPA 实体，但如果可能的话，我想避免这种情况。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-02-15T22:40:05.223

您可以结合 JPA 和 jOOQ。JPA/Hibernate 非常适合写入数据：

*   所有实体列都包含在 INSERT/UPDATE 中，因此您不必在添加新列时更改保存例程
*   广泛支持隐式/显式乐观/悲观锁定
*   支持优化的标识符生成器（pooled-lo 优化器）
*   事务性后写缓存以减少锁争用（即使在 MVCC DB 中）
*   JDBC 获取只是一种配置

SQL 和 jOOQ 非常适合读取数据，尤其是当您想要超越 SQL-92 JPA 方言抽象时。使用本机查询（和类型安全的 jOOQ），您可以利用数据库必须提供的每个功能：

*   窗口函数
*   枢
*   派生表
*   公用表表达式和递归查询
*   合并
*   批量插入/更新

最后，您很可能同时需要 JPA 和本机查询，因此 jOOQ 是一个很好的选择，可以充分利用您当前的数据库，同时为您提供编译时安全保证。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T07:53:15.987

您可以映射数据库中没有 1:1 表示的类，这只是映射中的更多工作。如果您想要纯 POJO 则使用 Hibernates xml 映射。可以映射大多数复杂的数据库模式，并且对于它们来说已经有很多关于 SO 的问题。为每个类和相应的数据库表/视图/函数发布一个问题，我们会找到答案。

# ruby-on-rails - 为什么 Heroku 的捆绑器每次推送时都会更新 gem？

> ID：13574485
> 
> 赞同：1
> 
> 时间：2012-11-26T22:47:25.427
> 
> 标签：ruby-on-rails, heroku, bundler

我在 Heroku 上运行了多个 Rails 应用程序。我使用大多数标准，包括 Gemfile 和 Bundler。Gemfile.lock 是用 Git 提交的。

但是，当我推送到 Heroku，而不是读取 Gemfile.lock 时，它似乎只是`bundle install --without development:test --path vendor/bundle --binstubs bin/`重新运行，这意味着它每次推送时都会更新 gem，导致我的开发环境和生产环境之间存在差异。

我没有收到错误消息，但这不是我期望的行为。我究竟做错了什么？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T22:52:38.450

我认为它这样做的一部分是“从头开始构建所有东西，以防开发人员系统有任何差异”理念。
例如，如果您正在运行“ibuntu”（组成）并且您的环境在 gems 之间有不同的依赖关系，因为ruby 在您的系统上实现的方式。从头开始构建系统中的所有内容并确保满足堆栈中出现的任何依赖项会更安全。

# ruby-on-rails - 设计路由问题

> ID：13574492
> 
> 赞同：0
> 
> 时间：2012-11-26T22:48:11.670
> 
> 标签：ruby-on-rails, ruby, devise

目前，设计的 URL 好像`/users/sign_in`我想将其更改为`/signin`.

在`routes.rb`文件中，我试过这个：

```
devise_for :users do
    get "/signin" => "devise/sessions#new"
    match '/signin', :to => 'devise/sessions#new'
    get "/signout" => "devise/sessions#destroy"
    match '/signout', :to => 'devise/sessions#destroy'   
end 
```

但没有任何效果。我收到一条错误消息：

```
app/controllers/posts_controller.rb:19:in `show' 
```

在该`show`部分，我有

```
def show
  @post = Post.find(params[:id])

  respond_to do |format|
    format.html # show.html.erb
    format.json { render json: @post }
  end
end 
```

控制器与设计有什么`show`关系？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T01:55:44.503

试试这个：

```
 devise_scope :user do
   get   "/signin"  => "devise/sessions#new"
   match '/signin'  => 'devise/sessions#new'
   get   "/signout" => "devise/sessions#destroy"
   match '/signout' => 'devise/sessions#destroy' 
 end 
```

来源：[https ://github.com/plataformatec/devise/wiki/How-To:-Change-the-default-sign_in-and-sign_out-routes](https://github.com/plataformatec/devise/wiki/How-To:-Change-the-default-sign_in-and-sign_out-routes)

# css - 如何使用部分从 HTML 助手中包含 CSS 文件

> ID：13574495
> 
> 赞同：0
> 
> 时间：2012-11-26T22:48:30.577
> 
> 标签：css, asp.net-mvc-3, html-helper

我有一个自定义助手，它返回一些 Html 和 Javascript。我必须包含一个 Css 文件，但我想将它包含到我的自定义助手中。

助手必须包含它需要的 css 文件。

有没有这样的解决方案：

**在一个视图中：**

```
@section mySection { 
    <link href="@Url.Content("...")" rel="stylesheet" type="text/css" /> 
} 
```

**在我的布局中：**

```
@RenderSection("mySection", required: false) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:29:36.070

试着在你的布局中写这个：

```
@RenderSection("ScriptTags", false) 
```

*此外，如果您的视图*是*部分视图*，它也不会起作用

# linux - 操作系统升级后 Trac/Agilo 坏了

> ID：13574496
> 
> 赞同：1
> 
> 时间：2012-11-26T22:48:34.773
> 
> 标签：linux, svn, trac, genshi

我做了一个操作系统升级，`debian etch`然后`squeeze`我的`trac`/`agilo`死了，问题是当向它提交代码时`subversion`会遇到低谷，但同时`trac`/`agilo`给出了这个错误：

```
2012-11-26 16:44:37,766 Trac[loader] ERROR: Skipping "agilo.utils.web_ui = agilo.utils.web_ui": (version conflict "VersionConflict: (Genshi 0.6 (/usr/lib/pymodules/python2.5), Requirement.parse('genshi>=0.5.1,<0.6dev'))") 
```

我看不到我在`trac`/中的变化`agilo`，你在颠覆中。

我设法降级`genshi`到 0.5.1，但随后提交不再起作用。

此外，如果符号链接`/usr/bin/python`（使用 2.5）到`python2.6`然后`trac`/`agilo`完全死亡。

```
trac                                     0.11.7-4
subversion                               1.6.12dfsg-6
python-genshi                            0.6-1
python2.5                                2.5.5-11
python2.6                                2.6.6-8+b1 
```

--bp

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T01:17:47.193

看起来 Agilo 需要 Genshi 0.5，但您的系统安装了 0.6 版本。

我不建议降级 Genshi 来解决这个问题，因为这样做可能会破坏 Trac。Genshi 是 Trac 的一个依赖，而 Genshi v0.6 可能是由于 Trac 升级到需要 v0.6 的版本而安装的。

有两种方法可以解决这个问题。首先，确保您运行的是最新版本的 Agilo 插件。您的操作系统升级可能还包括 Trac 升级。某些版本的 Trac 需要某些版本的 Agilo 插件（有关详细信息，请参阅 Agilo 网站）。在操作系统升级之前，您运行的是哪些版本的 Trac/Genshi？

如果您无法通过更新 Agilo 插件解决此问题，您可以随时重新安装旧版本的 Trac 和 Genshi。使用您的包管理器删除 Trac/Genshi，然后从源代码手动安装它们。通过这样做，您可以确保安装的版本与操作系统升级之前系统使用的版本完全相同。这可能有点麻烦，因为您将无法通过正常的系统更新机制更新 Trac，但它至少应该让您启动并运行。

# sql-server - 70 个数据库的 SQL Server 复制，在小时间窗口内进行转换

> ID：13574497
> 
> 赞同：3
> 
> 时间：2012-11-26T22:48:45.780
> 
> 标签：sql-server, replication, transformation, snapshot

我们有 70 多个 SQL Server 2008 数据库需要从 OLTP 环境复制到单独的报告服务器。复制数据库后，我们将进行一些部分数据转换：反规范化、行级安全等。SSRS 报告将基于这些静态非规范化表和视图编写。

我们有一个小的夜间窗口，用于复制和转换所有 70 个数据库（3 小时）。目前数据库平均约为 10GB。

**选项：**

**1\. 事务复制：** 我们需要在每个报告数据库上创建 100 多个静态非规范化表。对所有 70 个数据库执行此操作几乎达到了我们每晚的时间限制。随着数据库的增长，我们将超过时间限制。我们考虑将非规范化表与视图混合以加快转换速度。但是会有一些动态和一些静态数据，这不是我们可以使用的解决方案。此外，对于使用事务复制的 70 个数据库，我们关注带宽使用情况。

**2.快照复制：** 每晚复制整个数据库。这意味着我们可以混合使用非规范化的表和视图，以便数据转换过程更快。但是快照是一个完整的数据副本，所以随着数据库的增长，我们将超过我们完成复制和转换的时间限制。

**3\. 日志传送：** 在我们的夜间窗口中，我们可以使用日志传送来更新报告数据库，然后截断并重新填充非规范化表并使用一些视图。但是，我知道通过日志传送，无法将额外的表和视图添加到订阅数据库中。

**4\. 镜像：** 镜像已被弃用，但数据库在故障转移之前无法进行报告。

**5\. SQL Server 2012 永远在线。** 我们还没有 SQL Server 2012，可以将其配置为每天更新一次而不是实时更新吗？是否可以在订阅数据库（我们的报告数据库）上创建额外的表和视图？

**6\. 合并复制：** 这是为了将多个数据源合并到一个数据库中。但看起来它允许计划更新（每天一次）并且仅使用最新更改更新订阅者数据库，而不是执行整个快照。它需要为每个表添加一个 rowversion 列，但我们可以处理这个问题。同样使用此解决方案是否可以在订阅者数据库上创建其他表而不会导致更新不同步？

1.  最后一个选项是我们使用 SSIS 从 OLTP 数据库中仅选择我们需要的数据。我认为这个选项会产生更大的风险，因为我们必须处理对非规范化表的插入/更新/删除，而不是每天删除并重新创建非规范化表。

对我们的选项的任何帮助将不胜感激。如果我做了任何不正确的假设，请说。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:06:17.227

如果是我，我会使用连续运行的事务复制，并在订阅者处拥有视图（可能已编入索引）。这样做的好处是不必等待数据过来，因为它*总是*过来。

# encoding - 使用 UTF-8 时，使用十进制或十六进制来引用国际使用的字符是否更好......为什么？

> ID：13574498
> 
> 赞同：0
> 
> 时间：2012-11-26T22:48:45.647
> 
> 标签：encoding, character-encoding, html-entities

使用 UTF-8 时，哪种字符引用更好，或者在各种浏览器上得到更广泛的全球支持……使用十进制引用还是十六进制引用？

**更新**

例如，用于替换引号...

```
&#34;  or  &#x22; 
```

哪个更好用，为什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T06:16:22.100

十进制引用和十六进制引用之间没有功能差异。旧浏览器[不支持](http://www.alanflavell.org.uk/charset/i18n-browser-tests.html)后者，但我们谈论的是*真正*的旧浏览器，例如 Netscape 4 和 IE 4。

十六进制引用通常更方便，因为在字符代码标准和其他参考著作中，字符是通过十六进制的代码编号来引用的。使用它们，您可以避免从十六进制转换为十进制（从而可以避免一些错误）。

没有理由在文本中使用`&#34;`任何一个。`&#x22;`（在属性值中，`&quot;`在极少数情况下需要它们或 。）

这不依赖于文档编码（UTF-8 或其他），除非在使用 UTF-8 时不需要引用（标记有效字符`<`和`&`除外）。UTF-8 允许您输入任何字符，但如果您发现它比找到让您自己输入字符的编辑器更舒服，您可能仍然使用引用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T22:53:58.353

所有 HTML 实体仅使用 ASCII 子集，因此您以 UTF-8 对文档进行编码，而不是任何其他扩展 ASCII 的面向字节的编码，这一事实是不相关的。

反正：

*   使用 UTF-8 时，您只需将相关字符复制并粘贴到文档中即可，*完全无需*引用。例如，StackOverflow 不会将此⫅转换为实体（请参阅此页面的源代码）。

*   如果您更喜欢使用实体，那么我会纯粹使用十六进制引用，因为这是 Unicode 代码点通常写入图表的方式。引用得到如此广泛的支持，我认为您不会遇到十六进制和十进制引用的兼容性问题。

# git - 如何更改从我的存储库分叉的 GitHub 存储库？

> ID：13574499
> 
> 赞同：5
> 
> 时间：2012-11-26T22:48:45.710
> 
> 标签：git, github

我将一个名为 masteruser/reponame 的 GitHub 存储库分叉到 myuser/reponame。当我查看它的页面时，它说：

myuser/reponame，从 masteruser/reponame 分叉

另一个用户将 masteruser/reponame 分叉到另一个用户/reponame，它说：

anotheruser/reponame，从 masteruser/reponame 分叉

到目前为止，一切都很好。然后masteruser错误地删除了masteruser/reponame。GitHub 管理员在收到 masteruser 的几封电子邮件后很友好地恢复了 masteruser/reponame，但现在 myuser/reponame 说：

myuser/reponame，从另一个用户/reponame 分叉

这是有问题的，因为现在 anotheruser/reponame 是拉取请求的默认目的地，每次打开一个都更改它是不舒服的。我想我可以删除我的叉子并创建一个新叉子，但是有没有更清洁的方法呢？我在回购管理屏幕中找不到任何相关内容。

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:19:53.510

我建议以下两种选择之一：

1.  删除您的回购并重新分叉原始回购。
2.  联系 Github 研究员并向他们解释你的情况。他们可能会帮助你。

我在 Github 设置中找不到任何选项。

# php - 将存储在 php 中的数据动态添加到嵌套的 json 中

> ID：13574500
> 
> 赞同：5
> 
> 时间：2012-11-26T22:48:49.890
> 
> 标签：php, javascript, json, nested

我正在尝试为 jQuery 甘特图动态生成 json 数据。我知道 PHP，但对 JavaScript 完全陌生。我已经阅读了许多关于如何将数据动态添加到 json 的解决方案，并尝试了几十种组合，但什么也没有。这是json格式：

```
var data = [{
    name: "Sprint 0",
    desc: "Analysis",
    values: [{
        from: "/Date(1320192000000)/",
        to: "/Date(1322401600000)/",
        label: "Requirement Gathering", 
        customClass: "ganttRed"
        }]
    },{
    name: " ",
    desc: "Scoping",
    values: [{
        from: "/Date(1322611200000)/",
        to: "/Date(1323302400000)/",
        label: "Scoping", 
        customClass: "ganttRed"
        }]
    }, <!-- Somoe more data-->

      }]; 
```

现在我在 php db 结果中有所有数据。它是这样的：

```
$rows=$db->fetchAllRows($result);
$rowsNum=count($rows); 
```

这就是我想从中创建 json 的方式：

```
var data='';
<?php foreach ($rows as $row){ ?>
data['name']="<?php echo $row['name'];?>";
data['desc']="<?php echo $row['desc'];?>";
data['values'] = {"from" : "/Date(<?php echo $row['from'];?>)/", "to" : "/Date(<?php echo $row['to'];?>)/", "label" : "<?php echo $row['label'];?>", "customClass" : "ganttOrange"};
} 
```

但是，这不起作用。我试过不使用循环并用纯文本替换 php 变量只是为了检查，但它也不起作用。显示不添加项目的图表。如果我通过将新项目添加到值列表中来添加新项目，它就可以工作。所以甘特图本身或路径没有问题。基于以上所有，我认为问题在于向 json 添加纯数据。谁能帮我解决它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:01:26.690

First of all you're adding properties to string instead of building object. If you really want to do that this way:

```
 var data = [], row;
 <?php foreach ($rows as $row) : ?>
     row = {};
     row.name ="<?php echo $row['name'];?>";
     row.desc ="<?php echo $row['desc'];?>";
     row.values = {"from" : "/Date(<?php echo $row['from'];?>)/", "to" : "/Date(<?php echo $row['to'];?>)/", "label" : "<?php echo $row['label'];?>", "customClass" : "ganttOrange"};
     data.push(row);
 <?php endforeach; ?> 
```

Anyway it is unsafe (and result is normal JS code, not proper JSON object - but as you're assigning it to variable then I suppose it does not have to be in strict JSON format)

Better approach would be to build data structure in PHP and use `json_encode` function to generate JSON data for JavaScript:

```
 <?php
 $data = array();
 foreach ($rows as $row) {
      $data[] = array(
          'name'   => $row['name'],
          'desc'   => $row['desc'],
          'values' => array(array(
              'from'        => '/Date('.$row['from'].'>)/', 
              'to'          => '/Date('.$row['to'].')/',
              'label'       => $row['label'], 
              'customClass' => 'ganttOrange',
          ))
      );
 }
 ?>
 var data = <?php echo json_encode($data); ?>; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:32:09.460

**快速回答**

如前所述，使用 PHP [json_encode](http://www.php.net/manual/en/function.json-encode.php)函数可以轻松解决此问题。

理解如何轻松做到这一点的诀窍是理解您尝试使用的[复合数据结构。](http://en.wikibooks.org/wiki/PHP_Programming/Data_Structures#The_Basics)

**概述**

您正在处理的是一个通用的编程概念，称为*“复合数据结构”*。理解这一点的诀窍是要意识到您尝试管理的 PHP 和 JavaScript 只是完全相同事物的两种不同表示。

一旦这个概念深入人心，就很容易与用户*Musa*和*dev-null-dweller*已经解释过的内容联系起来。

解决这个问题的直接方法是在 PHP 中简单地构建一个复合数据结构，然后使用 PHP 的 json_encode 和 json_decode 的内置本机方法将其转换为 JSON（也称为 JavaScript）。

您应该将每个 $row 视为复合数据结构并使用 PHP json 函数，而不是执行所有语句。

下面的示例应该让您抢先一步，只需将其与您尝试使用的数据进行比较并相应地进行更改。

**示例 001**

```
 // This is a PHP composite data structure [ a nested array ]
  // represented in PHP. When you run this code you will get the
  // output of Result 001
  $user_profile = Array(
    main => Array(
      first_name  => "_blank_",
      last_name   => "_blank_",
      sex         => "_blank_",
      age         => "_blank_",    
    ),
    guardian => Array(
      first_name => "",
      last_name => "",
    ),
    children => Array(
      0 => Array(
        first_name => "Sally",
        last_name => "Shaw",
      ),
      1 => Array(
        first_name => "Scott",
        last_name => "Shaw",
      ),
    ),
  );

  // This is some sample PHP code you can use to modify
  // the composite data structure (modify the "_blank_" values)
  //
  $user_profile["main"]["first_name"] = "Archibald";
  $user_profile["main"]["last_name"]  = "Shaw";
  $user_profile["main"]["age"]        = "33";
  $user_profile["main"]["sex"]        = "male";

  // This is some sample PHP code you can use to modify
  // the composite data structure (add a new child)
  // 
  $user_profile["children"][2] = Array();
  $user_profile["children"][2]["first_name"]  = "Carrie";
  $user_profile["children"][2]["last_name"]   = "Shaw";

  // This is the PHP code you can use to transform from PHP to JSON 
  $result = json_encode( $user_profile );
  print_r( $result ); 
```

**结果 001（为便于阅读而格式化）**

```
{
   "main":{
      "first_name":"Archibald",
      "last_name":"Shaw",
      "sex":"male",
      "age":"33"
   },
   "guardian":{
      "first_name":"",
      "last_name":""
   },
   "children":[
      {
         "first_name":"Sally",
         "last_name":"Shaw"
      },
      {
         "first_name":"Scott",
         "last_name":"Shaw"
      },
      {
         "first_name":"Carrie",
         "last_name":"Shaw"
      }
   ]
} 
```

**结论**

使用上面的示例，您应该首先对您尝试使用的 PHP 变量执行 print_r 并了解整体结构。一旦你知道了这一点，使用内置的 PHP json_encode 函数将其转换为 JSON 是一个简单的步骤。

**参考**

*   [http://en.wikibooks.org/wiki/PHP_Programming/Data_Structures#The_Basics](http://en.wikibooks.org/wiki/PHP_Programming/Data_Structures#The_Basics)
*   [http://en.wikipedia.org/wiki/Composite_type](http://en.wikipedia.org/wiki/Composite_type)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:00:40.513

```
var data=[];

<?php 
foreach ($rows as $row)
{ 
    $obj = array(
        'name' => $row['name'],
        'desc' => $row['desc'],
        'values' => array(
            array(
                "from" => "/Date({$row['from']})/",
                "to" => "/Date({$row['to']})/",
                "label" => $row['label'],
                "customClass" => "ganttOrange",
            )
        )
    );
    $objJson = json_encode($obj);
    echo "data.push({$objJson});\n";
}
?> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T23:00:47.133

您应该在 php 中创建数据结构并使用[json_encode](http://www.php.net/manual/en/function.json-encode.php)将其回显。

```
<?php 
$data = array();
foreach ($rows as $row){ 
    $item = array();
    $item['name']=$row['name'];
    $item['desc']=$row['desc'];
    $item['values']= array("from" => "/Date{$row['from']})/", 
                           "to" => "/Date({$row['to']})/", 
                           "label" => $row['label'], 
                           "customClass" => "ganttOrange");
    $data[] = $item;
}
echo "\nvar data = ".json_encode($data).";\n"; 
```

# ruby-on-rails - Rails 管理调试代码

> ID：13574507
> 
> 赞同：0
> 
> 时间：2012-11-26T22:49:20.087
> 
> 标签：ruby-on-rails, debugging, logging

我有一个 Rails 项目，其中散布着各种调试代码和自定义的控制台日志记录。

例如，其中很多采用如下形式：

```
CustomLogger.debug("TYPE", "My Message = " + some_variable.inspect) 
```

在后端，我可以写入日志并通过跟踪日志文件来观察控制台，或者甚至将其打包并显示在特殊的 UI 中。但是洒这似乎很乱，我只需要在开发环境中。当说发布到生产环境时，是否有动态剥离这样的代码的最佳实践。我有点像在 C 中寻找预处理器宏的方式。这个通用样板在源代码中的东西。但在某些环境下被删除。

也许有一些有用的元编程技术会有所帮助？

我真的很想全局打开和关闭，但也不必反复评论它。

也许我只是做错了，但穴居人调试对我来说似乎很有意义。缺点是我似乎花了很多时间编写调试代码。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:15:28.187

在您的`config/environment/production.rb`文件中，添加类似

```
config.log_level = :info 
```

`:debug`这将在生产时忽略级别日志条目。

推荐阅读： http: [//guides.rubyonrails.org/debugging_rails_applications.html#log-levels](http://guides.rubyonrails.org/debugging_rails_applications.html#log-levels)

# c# - RadDateTimePicker + 数据输入掩码

> ID：13574512
> 
> 赞同：2
> 
> 时间：2012-11-26T22:49:29.300
> 
> 标签：c#, silverlight, validation, xaml, telerik

**要求：**允许用户以###### 格式输入日期，同时还可以从 DatePicker 中选择它（假设输入的所有年份都是 2000 年后。）例如，用户输入 050513 它变成 5/ 5/2013。或者，如果他们从 DatePicker 中选择它，则提供相同的显示。他们还希望它在控件获得焦点时全选，以便他们可以轻松地覆盖任何预先存在的日期。

**我尝试了什么：**我的 xaml 比我的 c# 强大得多，所以我尝试发挥创造力并且非常接近但没有雪茄，所以希望有人可以填补空白，但这就是我得到的地方。我想我可以利用我对[RadMaskedTextBox](http://www.telerik.com/help/silverlight/working_with_radmaskedtextbox.html)和[RadDateTimePicker](http://www.telerik.com/help/silverlight/raddatetimepicker-overview.html)的了解，所以我将它们的属性交织在一起（我的想法是我可以只使用 Box 进行输入，而选择器仅用于图标）但出于测试目的，它是这样的；

```
<StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center" >
    <telerik:RadMaskedTextBox x:Name="radMTB"
             Value="{Binding SelectedDate, Mode=TwoWay, 
                     ElementName=radDP}" 
             MaskType="DateTime"
             Mask="d" SelectionOnFocus="SelectAll" />                
    <telerik:RadDateTimePicker x:Name="radDP" 
             InputMode="DatePicker" 
             SelectedDate="{Binding SelectedDate, Mode=TwoWay, ElementName=radMTB}"/>
</StackPanel> 
```

这很好用，除了它仍然需要他们用斜杠输入整个日期。所以我用 Mask="##/##/\2\0##" 将 MaskType 更改为 Standard 以插入“20”，这样他们就可以像 121212 一样输入，它变成 12/12/2012 对吗？以为我拥有它，直到我尝试将值传递给 DatePicker。我将 Picker 上的 SelectedDate 绑定到[TextWithLiterals](https://stackoverflow.com/questions/6945986/getting-literal-value-from-a-masked-text-box-input)以获取显示值，没有运气。试过 Display.Text，Display.Value，只是 Text，只是 Value。它不能与它们中的任何一个一起绑定并传递给 DatePicker 工作......

所以我想我的问题是，我仍然可以以某种方式绑定到该文字显示并仅使用 xaml 来完成这项工作吗？还是[RadDateTimePicker](http://www.telerik.com/help/silverlight/raddatetimepicker-how-to-implement-custom-parsing.html)不可避免地需要[ParseDateTimeValue](http://www.telerik.com/help/silverlight/raddatetimepicker-overview.html)代码？如果是这样，有人可以分享一些知识并帮助一个人吗？还是有其他方法可以共同满足追捧的要求？这不可能是第一次出现？

感谢您阅读任何一种方式和欢呼！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T02:03:38.710

尝试使用 Telerik 的 RadMaskedDateTimeInput，而不是使用 RadMaskedTextBox。DateTime 值更加灵活。

```
<telerik:RadMaskedDateTimeInput x:Name="radMTB1"
                                IsClearButtonVisible="False"
                                FormatString="{}{0:M/d/yyyy}"
                                Mask="MMddyy"
                                SelectionOnFocus="SelectAll"
                                Value="{Binding SelectedDate, Mode=TwoWay, ElementName=radDP2}" /> 
```

更多信息：[http ://www.telerik.com/help/silverlight/radmaskedinput-features-controls-datetime.html](http://www.telerik.com/help/silverlight/radmaskedinput-features-controls-datetime.html)

# signal-processing - 从间隙信号中去除偏差/噪声

> ID：13574515
> 
> 赞同：2
> 
> 时间：2012-11-26T22:49:44.093
> 
> 标签：signal-processing

我在几个沙漠场地有一系列土壤含水量传感器。他们的信号包含很多噪音或偏见（取决于我与谁交谈）。我想删除垃圾，同时尽可能多地保留信号。我不是信号处理专家，所以任何类似于“使用 XYZ 滤波器”或特定算法之类的东西都会对我有所帮助。

我发布了一张图表，显示了一次探测的一年数据。信号是“顶部”；所有的垃圾都低于信号： [http ://www.unm.edu/~hilton/swc.png](http://www.unm.edu/~hilton/swc.png)

我玩过很多次低平滑；除了在信号下方有很多偏差的地方（例如下面的示例中的大约 idx 1000 到 2000 和 15000 到 16000），它的效果相当好。

我可以使用 Matlab 的信号处理工具箱，而且我对 R 和 python 非常熟悉；如果其中一个有一个预先打包的过滤器，我可以从中跳出来，那就太好了（但我愿意编写新的东西）。

非常感谢，蒂姆

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T01:37:40.990

可能值得快速尝试对数据集实施一些标准偏差过滤。将您的数据分成 N 段，并为每个段计算 Y 值的标准偏差。一旦你得到了，过滤掉 Y 值超过 3 个标准偏差（或者你想要的多少）的数据点。当然，要确定要使用多少段，需要进行一些手动工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T03:30:57.687

我将从中值滤波器开始。如果我正确阅读了您的情节，您每小时采样两次，并且数据不是太动态。假设这是正确的，47 或 49 的中值过滤器长度将等同于一天的窗口。在这个数据集中，您可能会延长一周或更长时间。在任何情况下，您都应该将未过滤和过滤的数据相互叠加，以确保过滤后的数据通过眼球测试（当您看到它时就会知道）。您可能需要手动进行最后的清理（希望您没有数千个传感器）。

（另外，我会派一名实习生或研究生到现场，找出传感器出了什么问题并修复它们。）

# python - Flask 应用程序的功能测试：奇怪的斜纹回溯

> ID：13574519
> 
> 赞同：1
> 
> 时间：2012-11-26T22:50:22.407
> 
> 标签：python, unit-testing, flask, functional-testing, twill

我正在测试我的 Flask 应用程序。

**总之，这是我的问题：**

1) 我在下面的代码块中的最终 url 断言失败。根据 Twill 的说法，它失败了，因为实际的 url 是'/auth/login'。换句话说，用户没有被重定向到受保护的管理页面。为什么？

2) 如何在我的 url 断言中包含“/?next='admin'”请求参数？换句话说，有没有一种方法——通过斜纹或任何 Pythonic 手段——来测试正确解析的“下一个”参数？

3）在功能测试中，除了断言 301 状态代码之外，还有其他方法可以显示重定向工作吗？

**这是我的脚本中与斜纹相关的部分......**

```
   t.browser.go(t.url("/auth/login/?next=%2Fadmin%2F"))
   url("/auth/login/?next=%2Fadmin%2F")

```

这是结果回溯：

```
   TwillAssertionError: 当前 url 是 'http://127.0.0.1:5000/auth/login/?next=%2Fadmin%2F';
不匹配 '/auth/login/?next=%2Fadmin%2F'

```

注意：奇怪的是，在“go”命令之后断言 200 状态代码不会返回任何类型的错误。我想表明，在登录上述 URL 后，最终 URL 确实是管理页面。像这样...

**我想运行的测试没有失败，但不能......**

```
def test_redirect_via_url(self):        
        使用 Twill(self.app, port=8080) 作为 t：

            #: 登录前进入管理页面...
            t.browser.go(t.url("/admin"))

            #: 断言 admin url 重定向到登录 url
            url('/auth/login')

            #: 上面的断言有效，但是......
            #: 为什么我不能断言这个 URL..'next' 参数...？
            #: "/auth/login/?next=%2Fadmin%2F"
            #：这就是浏览器地址栏中实际出现的内容

            #: 无论如何，在'/auth/login' url，让我们登录
            fv("1", "用户名", "测试")
            fv("1", "密码", "welcome1")
            提交（）

            #: 现在我想展示我的应用实际上重定向到受保护的管理页面...
            #: 应该有一个 localhost/admin 的 URL
            网址（'/管理员'）

            #: 上面的 url 断言失败。提交后的实际 url 仍然是 '/auth/login'

```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T02:47:03.227

原因是它通过*将其转换为正则表达式并与之匹配*`twill.commands.url`来断言它传递的 URL 与浏览器的 URL匹配。这导致被翻译成：*`/auth/login/?next=%2Fadmin%2F`*

 *```
/auth/login       # Match this literal string
/?                # followed by zero or one slash
next=%2Fadmin%2F  # followed by this literal string 
```

这意味着它将匹配`/auth/login/next=%2Fadmin%2F`or`/auth/loginnext=%2Fadmin%2F`但不匹配`/auth/login/?next=%2Fadmin%2F`。一种解决方法是转义问号（`url(r"/auth/login/\?next=%2Fadmin%2F")`应该可以）。*

# ruby-on-rails - 在 Ruby on Rails 中继承活动记录模型

> ID：13574521
> 
> 赞同：0
> 
> 时间：2012-11-26T22:50:52.997
> 
> 标签：ruby-on-rails, activerecord, models

我希望我可以继承一个 activerecord 模型，并像使用父类一样使用子类。情况似乎并非如此，AR 关系似乎不适用于子类。

```
class Manager < User
  belongs_to :shop
end

class Shop < ActiveRecord::Base
  has_many :managers
end

class PremiumShop < Shop
end 
```

和

```
@premium_shop = manager.shop # Finds the shop.
@premium_shop = manager.premium_shop # Does not find the shop, NilClass:Class error 
```

有可能完成这项工作吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T22:57:09.967

由于`shop`您`Manager`通过`belongs_to`. 您的模型上没有`premium_shop`定义方法`Manager`，因此出现`NilClass`错误。

如果要为`PremiumShop`类定义这样的关联，则必须明确指定它。

```
belongs_to :premium_shop, class_name: "PremiumShop", foreign_key: :shop_id 
```

根据您的需要，您还可以考虑研究“rails 单表继承”。

# wordpress - 如何通过wordpress中的菜单名称获取导航菜单列表

> ID：13574524
> 
> 赞同：1
> 
> 时间：2012-11-26T22:51:19.597
> 
> 标签：wordpress

如何通过 Wordpress 中的菜单名称获取导航菜单列表？

我正在使用以下代码，但它显示了所有页面并且没有使用自定义导航菜单名称

```
<?php wp_page_menu('sort_column=ID&amp;sort_order=desc;');?> 
```

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T06:24:02.527

您应该在您的functions.php 文件中注册您的菜单并将其添加到init。

register_nav_menu('header', __('header Menu', 'twentyeleven'));

您可以在此菜单的任何位置显示如下：

wp_nav_menu(array('theme_location' => 'header','container' => false,'menu_id' => 'nav'));

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T00:19:07.310

首先，

你真的应该在你的**functions.php**文件中分配菜单并将它添加到init。这样的事情应该做：

```
function register_my_menus()
{
   register_nav_menus(array( 'main-menu' => __( 'Main Menu' ) ) );
}
add_action( 'init', 'register_my_menus' ); 
```

然后在你的 wordpress 主题中，你可以简单地这样称呼它：

```
wp_nav_menu(array('menu_id' => '',
              'menu_class' => '',
              'container' => '',
              'theme_location' => 'main-menu'
)); 
```

您可以填写您需要的类或菜单 ID，重要的是您创建的**“主菜单”**分句显示菜单。

现在您只需要转到您的 wordpress 管理员 > 外观 > 菜单，从顶部选项卡列表中选择您的菜单，然后将其分配到右侧的主题位置。在它显示“主题位置”的地方，只需从下拉列表中选择“主菜单”，然后点击保存。

希望这可以帮助。

# python - 创建字符串的副本

> ID：13574528
> 
> 赞同：0
> 
> 时间：2012-11-26T22:51:29.587
> 
> 标签：python, string, copy

我有一个类变量`my_set`，它是一个集合，我正在向其中添加字符串：

`MyClass.my_set.add(self.some_string_property)`

我的问题是运行上面的类的实例可能随时被垃圾收集，当这种情况发生时，我认为我会丢失它`some_string_property`的`my_set`类变量。

为了保留每个实例`some_string_property`，`my_set`我需要创建它的副本并将*该副本*存储到`my_set`. 这样做的正确方法是什么？我已经尝试过该 `copy`模块，但它不适用于字符串。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T22:52:24.457

只要您至少保留一个对该字符串的引用，它就不会被垃圾收集（如果您没有留下任何引用，那么您无论如何都无法访问它）。

# jquery - JQuery隐藏优先于显示？

> ID：13574539
> 
> 赞同：0
> 
> 时间：2012-11-26T22:52:07.060
> 
> 标签：jquery

我在使用 JQuery 显示和隐藏时遇到问题。当我将鼠标悬停在一个元素上时，我想显示另一个元素弹出到右侧。我已经使用以下代码进行了管理：

```
var actionHoverInListener = function () {
    $(this).children('.pop-out').show("slide", { direction:"left" }, 100);
};
var actionHoverOutListener = function () {
    $(this).children('.pop-out').hide("slide", { direction:"left" }, 100);
};

// Add a hover listener for actions
$(".magic").hover(
    actionHoverInListener, actionHoverOutListener
); 
```

这工作正常，但问题是速度。如果我将鼠标悬停在“魔术” div 上的速度太快，它永远不会隐藏弹出窗口。就好像隐藏调用被忽略了，因为该节目仍在为幻灯片制作动画。

悬停方法被正确调用：我已经输入了日志代码以确保它被调用。所以，问题是隐藏不会取消显示。有没有办法做到这一点？

谢谢！

更新：

我在 jfiddle 上包含了我的问题示例：http: [//jsfiddle.net/Pekf2/](http://jsfiddle.net/Pekf2/)

沿着红色条纹运行鼠标。您将看到绿色滑出，但如果您太快（即使使用 stop() 调用）也不会滑回。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T22:54:21.210

改成

```
$(this).children('.pop-out').stop().hide(... 
```

这将停止显示动画并立即隐藏。

编辑：不完全确定为什么，但`.stop`不喜欢那样玩`.children`。无论出于何种原因，使用不同的选择器语法似乎都可以使其工作。

此外，由于动画停止，`left`CSS 可能会变为负数，所以我在 上添加了一个回调，以便在`.hide`它完成后将其设置为 0。

[http://jsfiddle.net/Pekf2/4/](http://jsfiddle.net/Pekf2/4/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T22:55:21.863

你可以考虑使用[jQuery hoverintent 插件](http://cherne.net/brian/resources/jquery.hoverIntent.html)——它以前为我解决过这样的问题。

摆弄你的小提琴并实施 hoverIntent 让我想到了这个：http: [//jsfiddle.net/crowjonah/Pekf2/1/](http://jsfiddle.net/crowjonah/Pekf2/1/)

如果我这么说，效果会很好。我刚刚更改了脚本以适应插件，如下所示：

```
var config = {    
 over: actionHoverInListener, // function = onMouseOver callback (REQUIRED)    
 timeout: 1000, // number = milliseconds delay before onMouseOut    
 out: actionHoverOutListener // function = onMouseOut callback (REQUIRED) 
```

};

```
// Add a hover listener for actions
   $('.monkey').hoverIntent(
       config
); 
```

# php - 使用 jQuery-File-Upload、Apache 和 PHP 上传 4GB HTTP 文件

> ID：13574542
> 
> 赞同：14
> 
> 时间：2012-11-26T22:52:27.937
> 
> 标签：php, jquery-plugins, file-upload, apache2

这个问题似乎与臭名昭著的 2GB 限制直接相关，我不确定它是否是 32 位 PHP 问题。我已经看到与 HTTP 相关的评论不是为如此大的文件设计的。但是，在决定对迄今为止已证明有效的方法进行任何根本性改变之前，我宁愿用尽这个方向。正如标题所示，我需要上传 >2GB 的文件，迄今为止最大的 3.8GB。我有一个使用 jQuery-file-upload 构建的表单，在这些大文件开始之前，它发送任何文件（全部小于 <2GB）都没有问题。从 File-Upload 上传 3.8GB 可能需要 5 分钟，进度条完成到 100%。然而，上传后报告的错误是类型 1，表明文件大小限制已被违反。

如果我在上传期间监控服务器上的磁盘使用情况，它将具有以下示例属性：在上传之前，磁盘已使用 30%，随着上传的继续，此使用量增加，31%,32%....45%,46%等等 然而，在 2GB 左右，磁盘使用率下降到 30%，而客户端/浏览器文件上传继续。当服务器磁盘使用量停止增加时，客户端可能只有上传的 60%。然而，客户端仍然继续 100%，但没有被服务器接受，因为磁盘状态永远不会离开 30%。

我正在运行带有 Apache/2.2.22 (Ubuntu) 和 PHP 版本 5.3.10-1ubuntu3.2 的 64 位 Ubuntu（最新）经过多天的断断续续寻找解决方案后，我仍然无法在更改后上传 3.8GB 文件这么多设置。我将在下面列出这些更改，但在这个阶段，我认为这可能是一个 32 位 PHP 问题，所以如果有人能建议一个值得关注的链接或值得尝试的解决方案，我将不胜感激。

在 Apache2 中，我设置了以下内容：

```
- apache2.conf I've set Timeout to 900
- httpd.conf I've set LimitRequestBody to 0
- .htaccess in the file upload directory I've set:
    - LimitRequestBody to 4939212390
    - php_value upload_max_filesize 4831838208
    - php_value post_max_size 4939212390 
```

在 php.ini 中，我设置了以下内容：

```
- UPLOAD_MAX_FILESIZE 4831838208
- POST_MAX_SIZE 4939212390
- max_execution_time 120
- max_input_time 60
- memory_limit 128M 
```

如果我在服务器上运行以下命令，PHP 似乎没有 32 位问题，但现阶段我不确定。

```
php -r "echo PHP_INT_MAX;"
9223372036854775807 
```

正如我所提到的，任何想法将不胜感激。

更新：

已经解决了这个问题，感谢@BogdanBurim 建议回归基础的方法：

我设法通过 HTTP 上传了一个 3.8 GB 的文件，设置如下：

在 Apache2 中，我设置了以下内容：

```
- apache2.conf I've set Timeout to 900
- httpd.conf I've set LimitRequestBody to 0
- .htaccess in the file upload directory I've set:
    - LimitRequestBody to 0
    - php_value upload_max_filesize 0
    - php_value post_max_size 4939212390
- .htaccess in the php temp directory (in my case its /tmp/) I've set:
    - LimitRequestBody to 0
    - php_value upload_max_filesize 0
    - php_value post_max_size 4939212390 
```

在 php.ini 中，我设置了以下内容：

```
- UPLOAD_MAX_FILESIZE 0
- POST_MAX_SIZE 4939212390
- max_execution_time 120
- max_input_time 60
- memory_limit 128M 
```

此解决方案的唯一其他重要部分是必须从上传表单中删除 MAX_FILE_SIZE、HTML：

```
<input type="hidden" name="MAX_FILE_SIZE" value="4939212390" /> 
```

设置此设置不断导致 PHP 类型 2 错误，因此 php 无法处理设置的大于 32 位的整数。删除它会导致 PHP 类型 1 错误，直到我在任何地方将 UPLOAD_MAX_FILESIZE 更改为 0，嘿，现在它可以工作了！！！！

[http://php.net/manual/en/features.file-upload.errors.php](http://php.net/manual/en/features.file-upload.errors.php)

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-29T16:39:20.387

已经解决了这个问题，感谢@BogdanBurim 建议回归基础的方法：

我设法通过 HTTP 上传了一个 3.8 GB 的文件，设置如下：

在 Apache2 中，我设置了以下内容：

```
- apache2.conf I've set Timeout to 900
- httpd.conf I've set LimitRequestBody to 0
- .htaccess in the file upload directory I've set:
    - LimitRequestBody to 0
    - php_value upload_max_filesize 0
    - php_value post_max_size 4939212390
- .htaccess in the php temp directory (in my case its /tmp/) I've set:
    - LimitRequestBody to 0
    - php_value upload_max_filesize 0
    - php_value post_max_size 4939212390 
```

在 php.ini 中，我设置了以下内容：

```
- UPLOAD_MAX_FILESIZE 0
- POST_MAX_SIZE 4939212390
- max_execution_time 120
- max_input_time 60
- memory_limit 128M 
```

此解决方案的唯一其他重要部分是必须从上传表单中删除 MAX_FILE_SIZE、HTML：

```
<input type="hidden" name="MAX_FILE_SIZE" value="4939212390" /> 
```

设置此设置不断导致 PHP 类型 2 错误，因此 php 无法处理设置的大于 32 位的整数。删除它会导致 PHP 类型 1 错误，直到我在任何地方将 UPLOAD_MAX_FILESIZE 更改为 0，嘿，现在它可以工作了！！！！

[http://php.net/manual/en/features.file-upload.errors.php](http://php.net/manual/en/features.file-upload.errors.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-05T09:52:32.290

如果您有权访问 apache 虚拟主机配置，您还可以更改特定上传 URL 的这些设置（您也可以将其添加到您的 .htaccess 文件中）：

使用此代码：

```
<LocationMatch "/index.php/url-of-your-upload.php">
    php_value max_execution_time 0
    php_value upload_max_filesize 0
    php_value post_max_size 4939212390
    php_value memory_limit 4G
    LimitRequestBody 0
</LocationMatch> 
```

LocationMatch 指令允许您选择 url（您可以使用 reg exp）

* * *

## 回答 #3

> 赞同：-7
> 
> 时间：2012-11-26T23:04:37.687

问题是您为什么要使用浏览器上传 > 1GB。考虑顶级文件共享服务，通过浏览器将文件上传大小限制为 1GB。如果用户下载失败会发生什么，您将不得不重新启动整个过程。

如果您有如此大的文件上传、种子、ftp 或个人上传客户端（如 rapidshare、fileupload、megaupload 等），您是否考虑过替代方案。有。

由于文件大小限制设置为 POST，您受到限制。如果您决定使用 HTTP 上传我不鼓励的更大文件，最佳解决方案是拆分文件并上传较小的拆分部分，然后重新组装文件。

# c++ - 如何在多个函数之间传递向量？

> ID：13574543
> 
> 赞同：3
> 
> 时间：2012-11-26T22:52:31.087
> 
> 标签：c++

```
#include <iostream>
#include <vector>
using namespace std;

class PerformSort
{
    public:
    const vector<int> * p;
    vector<int>& getElements(int);
    vector<int>& sortArray(vector<int>&);
    void printer(vector<int>&);

}firstSort;

vector<int>& PerformSort::getElements (int num)
{
    vector<int> elements(num);
    for (int i = 0; i < num; i++)
    {
        cout << "Enter elements into the array: ";
        cin >> elements[i];
    }

    p = &elements;
    return p;
}

vector<int>& PerformSort::sortArray (vector<int>& vector)
{
    int holder, min;

    for (int i = 0; i < (sizeof(vector) - 1); i++)
    {
      min = i;
      for (int j = (i + 1); j < sizeof(vector); j++)
      {
        if (vector[j] < vector[min])
        {
          min = j;
        }
      }
      if (min != i)
      {
        holder = vector[i];
        vector[i] = vector[min];
        vector[min] = holder;
      }
    }

    return vector;
}

void PerformSort::printer(vector<int>& vector2)
{

    for (int i = 0; i < sizeof(vector2); i++)
    {
        cout << vector2[i] << " ";
    }
}

int main ()
{
    int numberOfTimes;
    cin >> numberOfTimes;
    firstSort.printer(firstSort.sortArray(firstSort.getElements(numberOfTimes)));
    return 0;
} 
```

这将返回错误：“类型表达式中类型引用的无效初始化”。我创建 SelectionSort 算法的第一种方法是尝试按值传递向量（愚蠢地）。在此之后，经过一些研究，我开始使用指针。但是，这导致了上述错误。将所有内容声明为常量似乎并不能解决潜在的错误，尽管如果我理解正确，错误在于在需要常量引用的地方传递临时引用。关于如何实现向量的传递和返回有什么想法吗？（我来自 Java 背景，刚刚开始 C++，如果我在指针方面犯了任何明显的错误，请原谅我）。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:56:33.307

按值返回：

```
vector<int> PerformSort::getElements (int num)
{
    vector<int> elements(num);
    for (int i = 0; i < num; i++)
    {
        cout << "Enter elements into the array: ";
        cin >> elements[i];
    }
    return elements;
} 
```

这也可以让你摆脱`p`，它本身就是一个巨大的蠕虫罐头。

最后，我注意到你`sizeof(vector)`在很多地方使用。这不会为您提供向量中的元素数量；改为使用`vector.size()`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T22:55:48.477

将变量重命名为`vector`其他名称：

```
vector<int>& PerformSort::sortArray (vector<int>& wayBetterName) 
```

&

```
return wayBetterName; 
```

是什么促使您将变量命名为与类型相同的名称？

代码还有**很多**其他问题。

你不需要指针，你不需要引用，而且你最好只使用`std::sort`.

# garbage-collection - 没有垃圾收集器的 D 编程

> ID：13574552
> 
> 赞同：41
> 
> 时间：2012-11-26T22:53:07.660
> 
> 标签：garbage-collection, d

我今天一直在看D，从表面上看，它看起来很神奇。我喜欢它直接在语言中包含许多更高级别的构造，因此不必使用愚蠢的技巧或简洁的方法。如果 GC，我真正担心的一件事。我知道这是一个大问题，并且已经阅读了很多关于它的讨论。

我自己从一个问题中得出的简单测试表明 GC 非常慢。做同样事情的速度比直接的 C++ 慢 10 倍以上。（显然，测试并没有直接转换成现实世界，但性能影响是极​​端的，并且会减慢行为相似的现实世界发生（快速分配许多小对象）

我正在考虑编写一个实时低延迟音频应用程序，GC 可能会破坏应用程序的性能，使其几乎无用。从某种意义上说，如果它有任何问题，它将破坏实时音频方面，这更为重要，因为与图形不同，音频以更高的帧速率运行（44000+ vs 30-60）。（由于它的低延迟，它比可以缓冲大量数据的标准音频播放器更重要）

禁用 GC 将结果改进到 C++ 代码的 20% 以内。这很重要。我会在最后给出代码以供分析。

我的问题是：

1.  用标准的智能指针实现替换 D 的 GC 以使依赖 GC 的库仍然可以使用是多么困难。如果我完全删除 GC，我将失去很多繁重的工作，因为与 C++ 相比，D 已经有限制库。
2.  GC.Disable 是否只是暂时停止垃圾收集（防止 GC 线程运行），而 GC.Enable 会从它停止的地方重新开始。因此，我可能会禁用 GC 在 CPU 使用率较高的情况下运行，以防止出现延迟问题。
3.  有什么方法可以强制不始终使用 GC 的模式。（这是因为我没有在 D 中编程，当我开始编写不使用 GC 的眼镜时，我想确保我不会忘记实现自己的清理。
4.  是否可以轻松更换D中的GC？（不是我想要，但有一天玩不同的 GC 方法可能会很有趣......这类似于我想的 1）

我想做的是用内存换取速度。我不需要每隔几秒钟运行一次 GC。事实上，如果我可以为我的数据结构正确实现自己的内存管理，那么它可能根本不需要经常运行。只有当内存变得稀缺时，我才可能需要运行它。不过，从我读过的内容来看，您等待调用它的时间越长，它就会越慢。由于通常在我的应用程序中有时我可以毫无问题地调用它，这将有助于减轻一些压力（但话又说回来，可能有几个小时我将无法调用它）。

我不太担心内存限制。我宁愿“浪费”内存而不是速度（当然，在一定程度上）。首先是延迟问题。

根据我的阅读，我至少可以走 C/C++ 的路线，只要我不使用任何依赖 GC 的库或语言结构。问题是，我不知道那些做的。我已经看到提到的字符串、新字符串等，但这是否意味着如果我不启用 GC，我就不能使用内置字符串？

我在一些错误报告中读到 GC 可能真的有错误，这可以解释它的性能问题吗？

另外，D 使用了更多的内存，实际上，D 在 C++ 程序之前就耗尽了内存。我想在这种情况下大约多出 15% 左右。我想那是给GC的。

我意识到以下代码不能代表您的普通程序，但它说的是当程序实例化很多对象时（例如，在启动时）它们会慢得多（10 倍是一个很大的因素）。GC 可能在启动时“暂停”，那么它不一定是一个问题。

如果我没有专门解除分配本地对象，如果我能以某种方式让编译器自动 GC 一个本地对象，那将是非常好的。这几乎是两全其美。

例如，

```
{
    Foo f = new Foo();
    ....
    dispose f; // Causes f to be disposed of immediately and treats f outside the GC
               // If left out then f is passed to the GC.
               // I suppose this might actually end up creating two kinds of Foo 
               // behind the scenes. 

    Foo g = new manualGC!Foo();   // Maybe something like this will keep GC's hands off 
                                  // g and allow it to be manually disposed of.
} 
```

事实上，实际上能够将不同类型的 GC 与不同类型的数据相关联，并且每个 GC 都是完全自包含的，这可能会很好。这样我就可以根据我的类型定制 GC 的性能。

代码：

```
module main;
import std.stdio, std.conv, core.memory;
import core.stdc.time;

class Foo{
    int x;
    this(int _x){x=_x;}
}

void main(string args[]) 
{

    clock_t start, end;
    double cpu_time_used;

    //GC.disable();
    start = clock();

    //int n = to!int(args[1]);
    int n = 10000000;
    Foo[] m = new Foo[n];

    foreach(i; 0..n)
    //for(int i = 0; i<n; i++)
    {
        m[i] = new Foo(i);
    }

    end = clock();
    cpu_time_used = (end - start);
    cpu_time_used = cpu_time_used / 1000.0;
    writeln(cpu_time_used);
    getchar();
} 
```

C++ 代码

```
#include <cstdlib>
#include <iostream>
#include <time.h>
#include <math.h>
#include <stdio.h>

using namespace std;
class Foo{
public:
    int x;
    Foo(int _x);

};

Foo::Foo(int _x){
    x = _x;
}

int main(int argc, char** argv) {

    int n = 120000000;
    clock_t start, end;
    double cpu_time_used;

    start = clock();

    Foo** gx = new Foo*[n];
    for(int i=0;i<n;i++){
        gx[i] = new Foo(i);
    }

    end = clock();
    cpu_time_used = (end - start);
    cpu_time_used = cpu_time_used / 1000.0;
    cout << cpu_time_used;

    std::cin.get();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-11-27T00:41:31.777

1.  D 可以使用几乎任何 C 库，只需定义所需的函数。D 也可以使用 C++ 库，但 D 不理解某些 C++ 结构。所以... D*可以*使用几乎与 C++ 一样多的库。它们只是不是本地 D 库。

2.  来自 D 的图书馆参考。
    核心内存：

    > ```
    > static nothrow void disable(); 
    > ```
    > 
    > 禁用执行的自动垃圾收集以最小化进程占用空间。在实现认为正确的程序行为所必需的情况下，例如在内存不足的情况下，收集可能会继续发生。此函数是可重入的，但每次调用禁用时必须调用一次启用。
    > 
    > ```
    > static pure nothrow void free(void* p); 
    > ```
    > 
    > 释放 p 引用的内存。如果 p 为空，则不执行任何操作。如果 p 引用了最初不是由这个垃圾收集器分配的内存，或者它指向内存块的内部，则不会采取任何行动。无论是否设置了 FINALIZE 属性，该块都不会最终确定。如果需要最终确定，请改用 delete。
    > 
    > ```
    > static pure nothrow void* malloc(size_t sz, uint ba = 0); 
    > ```
    > 
    > 从垃圾收集器请求一个对齐的托管内存块。此内存可以通过调用 free 随意删除，也可以在收集运行期间自动丢弃和清理。如果分配失败，此函数将调用 onOutOfMemory，预计会抛出 OutOfMemoryError。

    所以是的。在这里阅读更多：http: [//dlang.org/garbage.html](http://dlang.org/garbage.html)

    在这里：[http ://dlang.org/memory.html](http://dlang.org/memory.html)

    如果你真的需要类，看看这个：[http](http://dlang.org/memory.html#newdelete) ://dlang.org/memory.html#newdelete delete has been deprecated，但我相信你仍然可以 free() 它。

3.  不要使用类，使用结构。结构是堆栈分配的，类是堆的。除非您需要多态性或其他类支持的东西，否则它们是您正在做的事情的开销。如果你愿意，你可以使用 malloc 和 free。

4.  或多或少...在这里填写函数定义：[https](https://github.com/D-Programming-Language/druntime/blob/master/src/gcstub/gc.d) ://github.com/D-Programming-Language/druntime/blob/master/src/gcstub/gc.d 。设置了一个 GC 代理系统，允许您自定义 GC。所以这并不是设计师不希望你做的事情。

这里很少有 GC 知识：垃圾收集器不能保证为所有未引用的对象运行析构函数。此外，没有指定垃圾收集器为未引用对象调用析构函数的顺序。这意味着，当垃圾收集器为具有引用垃圾收集对象的成员的类的对象调用析构函数时，这些引用可能不再有效。这意味着析构函数不能引用子对象。此规则不适用于自动对象或使用 DeleteExpression 删除的对象，因为垃圾收集器未运行析构函数，这意味着所有引用都是有效的。

导入std.c.stdlib；那应该有malloc和free。

导入core.memory；this has GC.malloc, GC.free, GC.addroots, //add external memory to GC...

字符串需要 GC，因为它们是不可变字符的动态数组。( immutable(char)[] ) 动态数组需要 GC，静态不需要。

如果您想要手动管理，请继续。

```
import std.c.stdlib;
import core.memory;

char* one = cast(char*) GC.malloc(char.sizeof * 8);.
GC.free(one);//pardon me, I'm not used to manual memory management. 
//I am *asking* you to edit this to fix it, if it needs it. 
```

为什么要为 int 创建一个包装类？您只不过是在放慢速度并浪费内存。

```
class Foo { int n; this(int _n){ n = _n; } }
writeln(Foo.sizeof);  //it's 8 bytes, btw
writeln(int.sizeof);  //Its *half* the size of Foo; 4 bytes.

Foo[] m;// = new Foo[n]; //8 sec
m.length=n; //7 sec minor optimization. at least on my machine.
foreach(i; 0..n)
    m[i] = new Foo(i);

int[] m;
m.length=n; //nice formatting. and default initialized to 0
//Ooops! forgot this...
foreach(i; 0..n)
    m[i] = i;//.145 sec 
```

如果你真的需要，那么在 C 中编写 Time-sensitive 函数，并从 D 中调用它。哎呀，如果时间真的很重要，请使用 D 的内联汇编来优化*一切。*

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2012-11-27T00:38:53.967

我建议你阅读这篇文章：http: [//3d.benjamin-thaut.de/](http://3d.benjamin-thaut.de/?p=20) ?p= 20 在那里你会发现一个标准库版本，它自己管理内存并完全避免垃圾收集。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-11-27T11:23:41.190

D 的 GC 根本不像 Java 那样复杂。它是开源的，所以任何人都可以尝试改进它。

有一个名为 CDGC 的实验性并发 GC，并且有一个当前的 GSoC 项目来移除全局锁定：[http ://www.google-melange.com/gsoc/project/google/gsoc2012/avtuunainen/17001](http://www.google-melange.com/gsoc/project/google/gsoc2012/avtuunainen/17001)

确保使用 LDC 或 GDC 进行编译以获得更好的优化代码。

XomB 项目也使用自定义运行时，但我认为它是 D 版本 1。 [http://wiki.xomb.org/index.php?title=Main_Page](http://wiki.xomb.org/index.php?title=Main_Page)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2012-12-10T11:06:03.590

您也可以只分配您需要的所有内存块，然后使用内存池在没有 GC 的情况下获取块。

顺便说一句，它没有你提到的那么慢。并且 GC.disable() 并没有真正禁用它。

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2012-12-05T21:44:09.093

我们可能会从不同的角度来看待这个问题。您作为问题的基本原理提到的分配许多小对象的次优性能与 GC 无关。相反，这是通用（但次优）和高性能（但任务专用）内存管理工具之间的平衡问题。这个想法是：GC 的存在不会阻止您编写实时应用程序，您只需要针对特殊情况使用更具体的工具（例如，[对象池](http://en.wikipedia.org/wiki/Object_pool_pattern)）。

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-03-07T16:19:34.487

由于这还没有关闭，最近版本的 D 具有 std.container 库，其中包含一个 Array 数据结构，该结构在内存方面比内置数组更有效。我无法确认库中的其他数据结构也很有效，但如果您需要更多地关注内存而不必求助于手动创建不需要垃圾收集的数据结构，则可能值得研究。

# javascript - Popcorn js 在 Safari 5 中获得 ogg

> ID：13574554
> 
> 赞同：0
> 
> 时间：2012-11-26T22:53:11.993
> 
> 标签：javascript, safari, popcornjs

Popcorn 没有在 safari 5 中播放，原因似乎是爆米花要求的是 ogg 而不是 mp4。这很奇怪，因为 safari 6 正在接收 mp4。

有没有办法覆盖爆米花要求 ogg 并让它获得 mp4？

编辑

这是一个代码示例...

```
<video height="240" width="320" id="video-one">
    <source src="http://localhost:8000/static/scratch-flv/rmR7FDgeEeKM0GD7QvFn-g.mp4" class="video-source-240">
    <source src="http://localhost:8000/static/scratch-flv/rmR7FDgeEeKM0GD7QvFn-g.ogg" class="video-source-240">
</video> 
```

# sql - 使用 COUNT 返回 Null 值

> ID：13574557
> 
> 赞同：0
> 
> 时间：2012-11-26T22:53:32.613
> 
> 标签：sql, sql-server-2008

使用此查询，我得到一个比表少两个的结果，因为它们不包括在计数中，我想在结果中获得 NULL 值。为此，我很确定我需要使用某种子查询，但我不确定如何使用，因为所讨论的属性是一个聚合。

```
SELECT Equipment.SerialNo , Name, COUNT(Assignment.SerialNo) 
FROM Equipment
INNER JOIN Assignment
     ON Assignment.SerialNo = Equipment.SerialNo

GROUP BY Equipment.SerialNo, Name 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T22:55:44.210

您需要将您的更改`inner join`为 a`left outer join`并计算其他内容，而不是`Assignment.SerialNo`要计算所有行 - 使用`count(*)`或其他不为空的属性，因为`count(column)`该列不包括空值。如果您不希望`Assignment.SerialNo`计数中包含空值，请继续在该列上进行聚合。

根据定义，内连接将跳过值 where `Assignment.SerialNo`is `NULL`- 外连接将包括它们。

# emacs - 即使在更改 .emacs 之后，Emacs 也会自动添加换行符

> ID：13574564
> 
> 赞同：15
> 
> 时间：2012-11-26T22:54:00.943
> 
> 标签：emacs, text-editor

我目前在 Mac 上，并试图将 Emacs 设置为默认情况下不在文件末尾添加换行符，但我搜索的几乎所有内容都说只需将 (setq require-final-newline nil) 添加到 .主目录中的 emacs 文件...这不起作用。接下来我应该看什么来改变？

这就是 .emacs 文件现在的样子

```
(custom-set-variables
  ;; custom-set-variables was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 '(gud-gdb-command-name "gdb --annotate=1")
 '(large-file-warning-threshold nil)
 '(require-final-newline nil))
(custom-set-faces
  ;; custom-set-faces was added by Custom.
  ;; If you edit it by hand, you could mess it up, so be careful.
  ;; Your init file should contain only one such instance.
  ;; If there is more than one, they won't work right.
 ) 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-11-26T23:43:26.723

你有没有尝试过：

```
(setq mode-require-final-newline nil) 
```

文件的主要模式可能是使用此变量的值...

如何找出哪些模式使用 this 而不是您尝试的变量并不是很明显，但大概该模式的作者更清楚......

因此，您可能想要更改该文件的主要模式，这可以通过回答这个 SQ 问题来完成：[如何告诉 emacs 在 C++ 模式下打开 .h 文件？](https://stackoverflow.com/questions/3312114/how-to-tell-emacs-to-open-h-file-in-c-mode)（显然根据您的需要定制答案）。

# objective-c - 为什么在另一个类中使用时 nsstring 消失了？

> ID：13574567
> 
> 赞同：0
> 
> 时间：2012-11-26T22:54:17.453
> 
> 标签：objective-c

在A类我有：

```
classB *classBI=[[classB alloc]init];
bits=[classBI data]; //bits has a property here in classA,it gets data from B/
UILabel *label = [[UILabel alloc] initWithFrame:CGRectMake(38.f, 20.f, 244.f, 43.f)];
label.text = bits; 
```

在B类我有：

```
 @property (nonatomic,retain) NSString *data; //in .h file
    data=@"no data"; //at the init method of classB .

    //then after a while when something is happen in classB , data is changed to :
    data=[NSString stringWithFormat:@"data:%f,%f,%f,%f,%f,%f",
         dataBits[0],dataBits[1],dataBits[2],dataBits[3],dataBits[4],dataBits[5]  ]; 
```

classA 是主场景（cocos2d 不过没关系）。一开始我真的可以在标签中看到classA中的“无数据”一词，但是当classB中的数据发生变化时，我看不到屏幕上标签的变化。它坚持这个词：“没有数据”为什么会这样？为什么我丢失了数据？如果我在 classB 中的 NSLOG 数据，就在它在那里改变之后，我可以看到它不为空，并且它具有新值。获取此字符串的 A 中 B 的实例有问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:10:20.327

当您将标签的文本设置为 指向的字符串时`bits`，它会存储**对该字符串**的引用。稍后当您更改时`data`，它正在创建一个`data`指向的新字符串，但是`bits`标签仍然具有正在查看原始字符串的原始指针。您希望在`data`更改时更新它们：

在这种情况下有几种方法可以采用，但最简单的方法之一是观察 for changes 的`data`属性`classBI`，并在标签发生更改时更新两者`bits`和标签：

```
[classBI addObserver:self 
          forKeyPath:@"data" 
             options:NSKeyValueObservingOptionNew 
             context:NULL]; 
```

然后，每当数据发生变化时，都会调用这个方法：

```
// Note that you will need to get a reference to 'label' in order for this to work:
- (void) observeValueForKeyPath:(NSString*)keyPath ofObject:(id)object change:(NSDictionary*)change context:(void*)context {
    if ([keyPath isEqual:@"data"]) {
        bits = [change objectForKey:NSKeyValueChangeNewKey];
        label.text = bits;
    }
} 
```

# recursion - Clojure 递归是否向后工作？

> ID：13574570
> 
> 赞同：4
> 
> 时间：2012-11-26T22:54:25.763
> 
> 标签：recursion, clojure

我目前正在处理 4clojure[问题 23](http://www.4clojure.com/problem/23)

我当前的解决方案使用递归遍历列表并将每个元素附加到同一函数结果的末尾：

```
(fn self [x] (if (= x []) 
                   x 
             (conj (self (rest x)) (first x))
)) 
```

但是当我对 [1 2 3] 运行它时，它给了我 (1 2 3)
我认为它应该通过递归做的是：

```
(conj (conj (conj (conj (conj [] 5) 4) 3) 2) 1) 
```

确实返回

```
[5 4 3 2 1] 
```

但这恰恰相反，所以我一定错过了一些东西。另外，我不明白为什么一个返回一个向量而另一个返回一个列表。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T23:09:59.723

当你这样做时，`(rest v)`你会得到一个列表（不是向量），然后 conj 每次都附加到前面（而不是后面）：

```
user=> (defn self [v] (if (empty? v) v (conj (self (rest v)) (first v))))
#'user/self
user=> (self [1 2 3])
(1 2 3)
user=> (defn self [v] (if (empty? v) [] (conj (self (rest v)) (first v))))
#'user/self
user=> (self [1 2 3])
[3 2 1]
user=>
user=> (rest [1])
()
user=> (conj '() 2)
(2)
user=> (conj '(2) 1)
(1 2)
user=> 
```

# windows-phone-8 - 如何向面向 Windows Phone 8 的可移植类库项目添加服务引用？

> ID：13574572
> 
> 赞同：3
> 
> 时间：2012-11-26T22:54:27.343
> 
> 标签：windows-phone-8, portable-class-library

我看到一种奇怪的行为，想知道我是不是做错了什么，或者就是这样。使用 PCL 时，我的目标是 Windows Phone 7。此时，我可以添加服务引用。将目标更改为 Windows Phone 8。此时，我无法再添加服务引用。

有没有办法将服务引用添加到针对 WP8 的 PCL 项目？

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-03T15:14:06.027

请允许我在这里回答我自己的问题。不，没有办法。为了解决这个问题，我转向基于接口的设计模式，我可以将服务传递给库。

# php - Google Kix 编辑器 - 如何使用 POST 发送数据？

> ID：13574574
> 
> 赞同：2
> 
> 时间：2012-11-26T22:54:41.273
> 
> 标签：php, google-closure, google-closure-library

[我可以在我的项目中包含这个用于Google Docs](http://docs.google.com)的文本编辑器吗？

[https://github.com/benjamn/kix-standalone](https://github.com/benjamn/kix-standalone)

或者这是非法的？

我怀疑这个人只是窃取了代码。如果这合法，我如何使用 POST 将数据发送到 PHP？HTML 代码没有发送它的文本区域，我找不到发送数据的方法。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T00:05:50.183

我认为这是非法的，因为此代码不是由 Google 提供的。一个原因是它严重基于服务器端组件，请参阅this

[https://groups.google.com/forum/?fromgroups=#!topic/closure-library-discuss/SeZdenR-2vA](https://groups.google.com/forum/?fromgroups=#!topic/closure-library-discuss/SeZdenR-2vA)

并且您提供的链接包含混淆代码，如果您使用它，您将无法获得支持。

希望这有帮助

# pyside - Ubuntu 12.04 上的 PySide 导入错误

> ID：13574575
> 
> 赞同：3
> 
> 时间：2012-11-26T22:54:56.873
> 
> 标签：pyside

$蟒蛇

Python 2.6.5（r265:79063，2012 年 10 月 1 日，22:04:36）

[GCC 4.4.3] 在 linux2 上

> > > 导入 PySide
> > > 
> > > PySide。**版本**

'1.1.2'

> > > 导入 PySide.QtCore

回溯（最近一次通话最后）：

文件“”，第 1 行，在

ImportError：libpyside-python2.6.so.1.1：无法打开共享对象文件：没有这样的文件或目录

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T20:07:50.670

将以下内容添加到 .bashrc 有帮助。

```
export LD_LIBRARY_PATH=/usr/local/lib/python2.6/dist-packages/PySide-1.1.2-py2.6.egg/PySide 
```

它在 Eclipse 中仍然不起作用；为此，我添加`LD_LIBRARY_PATH`了一个环境变量。

# ruby - 对 Ruby 中的 NoMethodError 感到困惑

> ID：13574577
> 
> 赞同：2
> 
> 时间：2012-11-26T22:55:00.980
> 
> 标签：ruby

在一个简单的 Ruby 示例中，我收到了一个 irb 中没有发生的错误。

```
name = "Joe"
def say_hi
  "\"Hi there!\" said #{self}"
end
response = name.say_hi
puts response 
```

此代码应返回“您好！” 乔说。

它在 irb 中工作得非常好。但是，当我尝试将相同的代码放入文件并运行该文件时，我收到此错误：

```
say_hi.rb:8:in `<main>': private method `say_hi' called for "Joe":String (NoMethodError) 
```

关于为什么会发生这种情况的任何建议？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:00:04.787

你快到了：

```
name = "Joe"
def name.say_hi
  "\"Hi there!\" said #{self}"
end

response = name.say_hi
puts response
#=> "Hi there!" said Joe 
```

`def name.say_hi`将在您上定义一个单例方法`name`，因此您可以按预期调用它：`name.say_hi`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:00:22.713

`say_hi`您为`main`not for定义了方法`name`。如果你想为 name 定义它，你应该这样做：

```
class << name
  def say_hi
    %["Hi there!" said #{self}]
  end
end 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T23:00:47.020

这是因为当您在 IRB 中定义方法时，它们成为系统中**所有**对象的实例方法。包括那个字符串“Joe”。但是当您正常运行代码时，它不会发生。您必须自己将该方法添加到 String 类。像这样，例如：

```
class String
  def say_hi
    "\"Hi there!\" said #{self}"
  end
end

"Joe".say_hi # => "\"Hi there!\" said Joe" 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-11-26T23:01:54.600

You defined a variable 'name` and a method. But there is no connection between them.

You could extend String:

```
name = "Joe"
class String
  def say_hi
    "\"Hi there!\" said #{self}"
  end
end
response = name.say_hi
puts response 
```

Or you define the method for the object `name`itself (see [slivus answer](https://stackoverflow.com/a/13574636/676874))

Or you may define your method in a module and extend your variable.

The advantage: You may also use the module for other object.

Example:

```
module Hi
  def say_hi
    "\"Hi there!\" said #{self}"
  end
end

name = "Joe"
name.extend(Hi)
puts name.say_hi

name2 = "Jane"
name2.extend(Hi)
puts name2.say_hi 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-11-26T23:12:45.447

在 irb 内部（和顶级范围内），self 设置为 main 类型，即 Object 类型。此处对此进行了描述：[Ruby中的“主要”是什么？](https://stackoverflow.com/questions/917811/what-is-main-in-ruby). 所以 :say_hi 是在 Object 上定义的实例方法，因此所有接收者都会响应它，包括 String 的实例，例如“Joe”。

尝试添加：

```
puts "Private methods: " + Object.private_methods.grep(/say/).inspect
puts "Public methods: " + Object.public_methods.grep(/say/).inspect 
```

您会看到 IRB 向 Object 添加公共方法，而脚本作为私有方法添加，因此不能使用显式接收器调用。

# python - 修改现有代码以写入列

> ID：13574578
> 
> 赞同：0
> 
> 时间：2012-11-26T22:55:02.413
> 
> 标签：python, csv

我正在寻找更改下面的代码，而不是逐行编写`values`代码的内容，而只会写在一行上，并`values`用逗号分隔 的所有内容，从而使所有值都在 . csv 而不是行（就像现在一样）。

```
for row in values:
     writer.writerow({'Variable name': row, 'Variable value': values[row]})
     if row == 'C_SerialNumber':
          logging.info("Writing data to csv file for SN: %s"%values[row]) 
```

最简单的方法是什么？我基本上想要以下内容：

```
Variable name, Variable value
Name1, Value1
Name2, Value2
...
NameX, ValueX 
```

变成：（我已经创建了 .csv 标题，并且只希望`value`附加该部分。

```
Name1, Name2, ... , NameX
Value1, Value2, ... , ValueX 
```

然后`values`数据将被循环并附加到现有的 .csv 文件中。

这可能吗？如果可以，那么容易做到吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:43:50.893

```
writer.writerow(values.keys())
writer.writerow(values.values()) 
```

# jquery - 单击文本区域中的文本

> ID：13574588
> 
> 赞同：1
> 
> 时间：2012-11-26T22:56:01.020
> 
> 标签：jquery, html, textarea

我试图使文本区域中的每一行都可点击，光标可以是默认的，或者指针无关紧要。[jsfiddle](http://jsfiddle.net/AZqZr/)

```
<textarea rows="10" cols="45">
hello
world
</textarea>​ 
```

我想在每行中单击文本时进行 ajax 调用。我可以编写所有的 ajax 功能，我想弄清楚的只是单击文本中的每一行。是否可以使用文本区域或者是否有其他替代方法。

**编辑**

更准确地说，我`<c:forEach items="${}" var=""> <c:out value="${} /></c:forEach>`在文本区域内使用。它不完全是带有段落标签的文本。文本是动态的，基于在此页面之前选择的输入

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:01:13.980

您可能想使用 selectionStart 来执行此操作。

这是一个例子。随意定制以供您使用。但这应该让你开始。

```
<textarea rows="10" cols="45" onkeyup="getLineNumber(this, document.getElementById('lineNo'));" onmouseup="this.onkeyup();"></textarea>
<div id="lineNo"></div>

<script>

    function getLineNumber(textarea, indicator) {

        indicator.innerHTML = textarea.value.substr(0, textarea.selectionStart).split("\n").length;
    }

</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T23:19:12.687

If I understood you correctly, you want to get the text of the line you clicked on. If that is so, then the following works with your example:

```
$("#mytextArea").on("mouseup", function(eventData) {
    var lineHeight = $(this).css("line-height");
    lineHeight = parseInt(lineHeight.substring(0, lineHeight.length - 2));

    var line = Math.floor(eventData.offsetY / lineHeight);
    alert($(this).val().split("\n")[line]);
}); 
```

### [DEMO](http://jsfiddle.net/g94FM/) - Get Text from clicked line in textarea

The code will take the position the mouse was clicked in within the textarea `offsetY` and divide it by the applied `line-height`. Using `Math.floor()` it will get the line which was clicked and use it as the index element in the array when splitting the lines by `"\n"`.

In addition to make this work I enforced the line-height to be a set `px` value to allow me to calculate the line clicked.

```
textarea{
    font-size: 15px;
    line-height: 15px;
}​ 
```

### Edit - Scrollbars on textarea

Assuming the textarea has a scrollbar, the scrollbar will "distort" the `offsetY` value and you need to add the current scroll position to it like this:

```
$("#mytextArea").on("mouseup", function(eventData) {
    var scrollPosition = $(this).scrollTop()
    var lineHeight = $(this).css("line-height");
    lineHeight = parseInt(lineHeight.substring(0, lineHeight.length - 2));

    var line = Math.floor((eventData.offsetY + scrollPosition) / lineHeight);
    alert($(this).val().split("\n")[line]);
});​ 
```

### [DEMO](http://jsfiddle.net/g94FM/1/) - Get Text from clicked line in textarea with scrollbar

I updated the CSS to a fixed height to get a scrollbar like this:

```
textarea{
    font-size: 15px;
    line-height: 15px;
    height: 100px;    
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:00:54.183

您可以在 中获取光标位置`textarea`，找出其中的文本，然后执行 ajax。话虽如此，将元素（`pre`, `a`, `input`）分开并让它们的每个点击功能触发您想要的 ajax 调用会更容易。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T23:03:58.790

您可以将每一行放在 ap 标签内并使用 onclick ：

```
<p onclick="myFunction()">Hello</p>
<p onclick="myOtherFunction()">World</p> 
```

# c - C将文件的一部分读入缓存

> ID：13574590
> 
> 赞同：0
> 
> 时间：2012-11-26T22:56:09.470
> 
> 标签：c, file, file-io, cache-control

我必须做一个程序（对于 Linux），其中有一个非常大的索引文件，我必须搜索和解释文件中的数据。现在要注意的是，我只能在任何时候缓存文件的 x 字节（由参数确定），因此如果不是我要查找的数据，我必须从缓存中删除某些数据。

如果我的理解是正确的， fopen (r) 不会将任何内容放入缓存中，只有当我调用 getc 或 fread(指定大小) 时它才会被缓存。

所以我的问题是，假设我使用 fread 并读取 100 个字节，但在检查后，100 个字节中只有 20 个包含我需要的数据；我将如何从缓存中删除无用的 80 字节（或覆盖它）以便从文件中读取更多内容。

**编辑**通过缓存我的意思是存储在内存中的数据，这使得问题更容易

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:06:41.940

为什么要对缓存进行微观管理？其次，是什么让你认为你可以？在程序的命令行上指定的任何参数都不能控制缓存管理器在内部执行的操作——它可能决定将整个文件读入 RAM，它可能决定不读取任何文件，或者它可能决定举办派对。您对其进行的任何控制都将使用低级 API/系统调用，并且不会非常精细。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T23:01:40.153

`fread`'s first argument is a pointer to a block of memory. So the way to go about this is to set that pointer to the stuff you want to over write. For example lets say you want to keep bytes 20-40 and overwrite everything else. You could either a) invoke `fread` on start with a length of 20 then invoke it again on `buffer[40]` with a size of 60\. or b) You could start by defragmenting (ie copy the bytes you want to keep to the start) then invoke `fread` with a pointer to the next section.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T23:12:14.843

我认为您可能对这些要求感到困惑，或者可能对给您要求的人感到困惑。您似乎指的是由操作系统管理的缓存，应用程序无需担心。操作系统将确保它不会自动变得太大。

“缓存”的另一个含义是您自己创建的缓存、`char*`缓冲区或您创建的任何东西，以便在处理数据时将数据临时保存在内存中。这个应该很容易管理自己，只需不为该缓冲区分配太多内存。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2012-11-26T23:04:44.253

要丢弃使用 fopen() 打开的文件的读取缓冲区，可以使用 fflush()。另请注意，您可以使用 setvbuf() 控制缓冲区大小。

但是，如果您必须对缓冲进行精确控制，则应该考虑使用 open/read（而不是 fopen/fread）。

# javascript - jquery 动画 - 他们什么时候完成？

> ID：13574594
> 
> 赞同：1
> 
> 时间：2012-11-26T22:56:53.537
> 
> 标签：javascript, jquery, jquery-ui

我有两个一个一个的 jquery 动画：

```
 books.animate({ left: left1 }, {
            duration: this.slideDuration,
            easing: this.easing,
            complete: complete
        });

        laptops.animate({ left: left2 }, {
            duration: this.slideDuration,
            easing: this.easing,
            complete: complete
        }); 
```

我希望动画同时运行，所以我使用`{queue: false}`：

```
books.animate({ left: left1 }, {
            duration: this.slideDuration,
            easing: this.easing,
                            queue: false,
            complete: complete
        });

        laptops.animate({ left: left2 }, {
            duration: this.slideDuration,
            easing: this.easing,
                            queue: false,
            complete: complete
        }); 
```

但是现在完成的回调调用了两次！我怎样才能知道这两个动画是什么时候完成的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:00:12.230

为什么不`complete`从其中一个动画中删除处理程序？

从您发布的代码摘录来看，您似乎在两个动画上使用了相同的持续时间和缓动方法。因此，它们将同时完成本质上是正确的，只要它们同时被调用......

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:02:14.053

this may sounds like something complicated, but why not `Deferred Objects` ?

[http://api.jquery.com/category/deferred-object/](http://api.jquery.com/category/deferred-object/)

you may investigate more here [jQuery animation with deferred pipes?](https://stackoverflow.com/questions/7639213/jquery-animation-with-deferred-pipes)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-26T23:13:32.630

使用 jQuery 延迟方法尝试

```
$.when( 
    books.animate({ left: left1 }, {
        duration: this.slideDuration,
        easing: this.easing
    }),
    laptops.animate({ left: left2 }, {
        duration: this.slideDuration,
        easing: this.easing
  })
).done( function( ) {

    alert("done!");

}); 
```

[**在这里**](http://jsfiddle.net/VXpp3/33/)提琴[](http://jsfiddle.net/VXpp3/33/)

 *** * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T23:20:28.797

根据[http://darcyclarke.me/development/using-jquery-deferreds-with-animations/](http://darcyclarke.me/development/using-jquery-deferreds-with-animations/)：

```
books.animate({ left: left1 }, {
    duration: this.slideDuration,
    easing: this.easing,
    queue: false
});

laptops.animate({ left: left2 }, {
    duration: this.slideDuration,
    easing: this.easing,
    queue: false
});

$.when(books, laptops).done(complete); 
```**

# python - 如何使用 Python 和 BeautyfulSoup 对 HTML 表格进行排序

> ID：13574599
> 
> 赞同：0
> 
> 时间：2012-11-26T22:57:15.817
> 
> 标签：python

我需要对这个 html 页面[http://gnats.netbsd.org/summary/year/2012-perf.html](http://gnats.netbsd.org/summary/year/2012-perf.html)进行分类，我需要从大表中列出最重要的问题。这是我在 Python.I 中的代码如果您能给我一些建议，将非常感激。

```
 import urllib.request
from bs4 import BeautifulSoup

# overall input
inputpage = urllib.request.urlopen("http://gnats.netbsd.org/summary/year/2012-perf.html")
page = inputpage.read()
soup = BeautifulSoup(page)

# checking tables
table = soup.findAll('table')
rows = soup.findAll('tr')
colomns = soup.findAll('td')

# inputing the lists
name = []
first = []
second = []
sum = []

# the main part
for tr in rows:
    if (tr==1):
        element = tr.split("<td>")
        name.append(element)
    elif (tr==2):
        element = tr.split("<td>")
        first.append(element)
    elif (tr==3):
        element = tr.split("<td>")
        second.append(element)

# combining the open and closed issue lists
length = len(first)
for i in range(length):
    sum = first[i] + second [i]

# printing the lists
length = len(sum)
for i in range(length):
    print (name[i] + '|' + sum[i]) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:13:15.810

`BeautifulSoup`有一些很好的方法来访问子节点等等。例如，您可以使用`tables = soup.findAll('table')`. 假设您想在您发布的链接（表 [1]）中合并第二个表的数据，您可以执行以下操作

```
names = []
cdict = {0:[], 1:[]} # dictionary of "td positions to contents"

tables = soup.findAll('table')
for tt in tables[1].find_all('tr')[1:]: # skip first <tr> since it is the header
    names.append(tt.find_all('th')[0]) # 1st column is a th with the name
    for k, v in cdict.items():
        # append the <td>text</td> of column k to the corresponding list
        v.append(tt.find_all('td')[k].text) 
```

所以，你最终会得到一个列字典 - > 列表，这样每个列表都包含 td 文本元素（使用字典的主要原因是因为你可能想要从列 1,2 和4，在这种情况下，您只需要更改 cdict 中的内容）。

要计算总和，您可以执行以下操作：

```
for i in xrange(len(names)):
    print names[i], int(cdict[0][i]) + int(cdict[1][i]) 
```

如果您查看每个元素的方法，您会看到一些非常好的功能，您可以使用这些功能来简化您的任务。

# backbone.js - 了解 Backbone 模型设置、验证和更改回调

> ID：13574602
> 
> 赞同：5
> 
> 时间：2012-11-26T22:57:26.603
> 
> 标签：backbone.js

骨干文档说：

> 如果验证失败，Model.set 将失败 - 它不会设置值，因此不会触发任何回调。我们可以将 { silent: true } 传递给 Model.set - 然后它会设置值但也不会触发任何回调。

所以，

为什么 Backbone 模型需要一个有效的状态来简单地设置一个属性值？如果我们想在用户与 UI 交互时设置属性，但模型尚未生效怎么办？这意味着除非我们通过 { silent: true } 然后手动触发更改，否则更改回调不可用？！

请说您知道更好的处理方法:)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T16:15:58.123

在 Backbone 中，每当您在模型上调用 set 时，它都会跟踪模型的哪些属性已更改以及新添加了哪些属性。调用 validate 可以更有效地执行此操作。传递 {silent:true} 作为 set 函数中的选项会导致验证并更改为不执行，因此如果不触发任何更改事件。

`If you want to set attributes as the user interacts with the UI, but the model is not valid yet`

在这种情况下，您可以在普通对象中设置更改，确保对象键与模型的属性相同，然后在某些时候只在模型中设置。

```
var uiChanges = {name:'x'}; //just fill it with your changes 
ur_model.set(uiModel); //then set it ,this way it fires change events only once 
```

要检查普通对象和模型之间的差异，您可以使用 `ur_model.changedAttributes(uiChanges);`

`changedAttributes`- 返回一个包含所有已更改属性的对象，如果没有更改的属性，则返回 false。

您可以进一步使用它仅保存那些已更改的属性，而不是再次保存整个模型。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-27T00:08:48.420

我不确定如何回答“***为什么”***问题，但您可以说有理由说明为什么 set 运行验证是好的。例如，它使实时进行客户端验证变得非常简单。

如果您的问题可以通过仅验证用户当前正在更改的值来解决，您可以通过将您的`validate`方法与`hasChanged`方法相结合来做到这一点。

例如这样的：

```
Backbone.Model.extend({
  defaults : { name : "" },

  validate : function (attrs) {
    var errors = {};
    if(this.hasChanged("name") && attr.name.length == 0) {
      errors.name = "Need a name yo!";
    }
    //...

    if(_.keys(errors).length > 0) {
      return errors;
    }
  }
}) 
```

# android - Android：在存储库中找不到 cacerts.bks

> ID：13574605
> 
> 赞同：0
> 
> 时间：2012-11-26T22:57:37.023
> 
> 标签：android

在 Android 设备的 system/etc/security/cacerts.bks 中找不到定义的 cacerts.bks 路径 - 我想验证我的设备是否拥有它，如何检查？

问候 SS

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:18:52.440

也许您可以尝试列出安全目录内容..

```
adb shell ls /system/etc/security/ 
```

# python - 如何根据字符串列表的元组字典的第一个索引添加值？蟒蛇 3x

> ID：13574606
> 
> 赞同：0
> 
> 时间：2012-11-26T22:57:37.937
> 
> 标签：python, key, tuples, dictionary

我被困在如何正确地制定这个问题上，以下是：

如果我们有以下值怎么办：

```
{('A','B','C','D'):3, 
('A','C','B','D'):2,
('B','D','C','A'):4,
('D','C','B','A'):3,
('C','B','A','D'):1,
('C','D','A','B'):1} 
```

当我们总结第一名的值时：[5,4,2,3]（5人先选A，4人先选B，依此类推，如A = 5，B = 4，C = 2，D = 3)

任何字母的最大值都是 5，这不是多数（5/14 小于一半），其中 14 是总值的总和。

所以我们删除了第一名最少的字母表。在这种情况下是C。

我想在`{'A':5, 'B':4, 'C':2, 'D':3}` **不导入**任何内容的情况下返回字典。

这是我的工作：

```
def popular(letter):
    '''(dict of {tuple of (str, str, str, str): int}) -> dict of {str:int}
    '''
    my_dictionary = {}
    counter = 0

    for (alphabet, picks) in letter.items():
        if (alphabet[0]):
            my_dictionary[alphabet[0]] = picks
        else:
            my_dictionary[alphabet[0]] = counter

    return my_dictionary 
```

这会返回我无法摆脱的键的副本。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:07:05.147

以下应该有效：

```
def popular(letter):
    '''(dict of {tuple of (str, str, str, str): int}) -> dict of {str:int}
    '''
    my_dictionary = {}
    for alphabet, picks in letter.items():
        if alphabet[0] in my_dictionary:
            my_dictionary[alphabet[0]] += picks
        else:
            my_dictionary[alphabet[0]] = picks
    return my_dictionary 
```

例子：

```
>>> letter = {('A','B','C','D'):3, 
... ('A','C','B','D'):2,
... ('B','D','C','A'):4,
... ('D','C','B','A'):3,
... ('C','B','A','D'):1,
... ('C','D','A','B'):1}
>>> popular(letter)
{'A': 5, 'C': 2, 'B': 4, 'D': 3} 
```

这可以使用[collections.defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)更简洁地完成：

```
from collections import defaultdict
def popular(letter):
    my_dictionary = defaultdict(int)
    for alphabet, picks in letter.items():
        my_dictionary[alphabet[0]] += picks
    return dict(my_dictionary) 
```

# android - 如何在 Android 4.2 的多用户环境下查看外部存储上的 Android/data/your.package.name 文件？

> ID：13574607
> 
> 赞同：6
> 
> 时间：2012-11-26T22:57:39.830
> 
> 标签：android, android-sdcard, android-4.2-jelly-bean

Android 4.2 增加了对平板电脑的多用户支持。现在，当您通过类似的方法请求将文件保存在外部存储上的路径时，`Environment.getExternalStorageDirectory()`或者`Context.getExternalFilesDir(null)`您获得以下值：`/storage/emulated/#/Android/data/your.package.name/`# 是一个数字，具体取决于您当前登录的用户。

这工作正常，但我注意到 DDMS 的文件资源管理器和[Android 文件传输](http://www.android.com/filetransfer/)都无法看到这些文件。

DDMS 的文件资源管理器只能看到`storage/emulated/`一个空`legacy`文件夹。文件传输可以看到 /Android/data/ 文件夹，但对于以调试方式运行的应用程序，其文件不可见（但它们确实存在）。

有没有办法让 DDMS 或文件传输与这些设备一起工作？（希望不必root设备...）

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-11-27T00:02:30.957

啊哈！

尝试`/mnt/shell/emulated/N`，对于`N`like的各种值`0`。这似乎在我的 Nexus 10 和 DDMS 中的 Galaxy Nexus 上正确映射。不过，我无法评论文件传输工具。

顺便说一句，用户的数字不是连续的。所以在我的N10上，原来的用户是`0`，第二个用户是`10`。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-23T14:06:42.690

由于 Jelly Bean 4.2 支持多用户配置文件，因此对 sd 卡浏览进行了一些更改。

您必须具有**ADT v 21**或更高版本才能浏览模拟 sd 卡。 **/mnt/shell/emulated/0**用于默认用户。有关更多详细信息，请参见随附的图像。![在此处输入图像描述](../Images/54554fb37ff6bc52f95a9e24aabf6288.png)

[放大图片](https://i.stack.imgur.com/xDdcW.png)

# java - Android - 使用 XPath 解析 XML

> ID：13574609
> 
> 赞同：2
> 
> 时间：2012-11-26T22:57:52.873
> 
> 标签：java, android, xml, parsing, xpath

首先，感谢所有将花一点时间在这个问题上的人。

其次，对不起我的英语（不是我的第一语言！：D）。

好吧，这是我的问题。

我正在学习 Android，我正在制作一个使用 XML 文件来存储一些信息的应用程序。我创建文件没有问题，但尝试使用 XPath 读取 de XML 标记（DOM、XMLPullParser 等只会给我带来问题）我至少能够读取第一个。

让我们看看代码。

这是应用程序生成的 XML 文件：

```
<dispositivo>
    <id>111</id>
    <nombre>Name</nombre>
    <intervalo>300</intervalo>
</dispositivo> 
```

这是读取 XML 文件的函数：

```
private void leerXML() {
    try {
        XPathFactory  factory=XPathFactory.newInstance();
        XPath xPath=factory.newXPath();

        // Introducimos XML en memoria
        File xmlDocument = new File("/data/data/com.example.gps/files/devloc_cfg.xml");
        InputSource inputSource = new InputSource(new FileInputStream(xmlDocument));

        // Definimos expresiones para encontrar valor.
        XPathExpression  tag_id = xPath.compile("/dispositivo/id");
        String valor_id = tag_id.evaluate(inputSource);

        id=valor_id;

        XPathExpression  tag_nombre = xPath.compile("/dispositivo/nombre");
        String valor_nombre = tag_nombre.evaluate(inputSource);

        nombre=valor_nombre;
    } catch (Exception e) {
        e.printStackTrace();
    }
} 
```

应用程序正确获取 id 值并将其显示在屏幕上（“id”和“nombre”变量分别分配给 TextView），但“nombre”不起作用。

我应该改变什么？:)

感谢您的所有时间和帮助。这个网站很有帮助！

PD：我一直在整个网站上寻找回复，但没有找到任何回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:10:39.157

您两次使用相同的输入流，但第二次使用它时它已经在文件末尾。您必须再次打开流或将其缓冲在 a 中`ByteArrayInputStream`并重用它。

在你的情况下这样做：

```
inputSource = new InputSource(new FileInputStream(xmlDocument)); 
```

在这条线之前

```
XPathExpression  tag_nombre = xPath.compile("/dispositivo/nombre"); 
```

应该有帮助。

请注意，您应该正确关闭您的流。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:12:03.870

问题是您不能多次重复使用流输入源 - 第一次调用`tag_id.evaluate(inputSource)`已经读取了输入到最后。

一种解决方案是提前解析 Document：

```
DocumentBuilderFactory documentBuilderFactory = DocumentBuilderFactory.newInstance();
Document document = documentBuilderFactory.newDocumentBuilder().parse(inputSource);

Source source = new DOMSource(document);

// evalute xpath-expressions on the dom source 
```

# python - 使用范围函数

> ID：13574611
> 
> 赞同：0
> 
> 时间：2012-11-26T22:58:02.063
> 
> 标签：python, range

我的目标是制作一个程序，它接受输入 (Battery_Capacity) 并最终吐出 (New_Battery_Capacity) 列表和最终达到最大容量 80 所需的 (Cycle) 数。

```
Cycle = range (160)
Charger_Rate = 0.5 * Cycle
Battery_Capacity = float(raw_input("Enter Current Capacity:"))
New_Battery_Capacity = Battery_Capacity + Charger_Rate

if Battery_Capacity < 0:
    print 'Battery Reading Malfunction (Negative Reading)'

elif Battery_Capacity > 80:
    print 'Battery Reading Malfunction (Overcharged)'

elif float(Battery_Capacity) % 0.5 !=0:
    print 'Battery Malfunction (Charges Only 0.5 Interval)'

while Battery_Capacity >= 0 and Battery_Capacity < 80:
    print New_Battery_Capacity 
```

我想知道为什么我的 Cycle = range(160) 在我的程序中不起作用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:02:48.490

Your first problem is that you have the first two lines in the wrong order. You need a "Cycle" variable to exist before you can use it.

You'll still get an error when you swap them, though. You can't multiply a list by a float. A list comprehension is more what you want:

```
Charger_Rate = [i * .5 for i in Cycle] 
```

As far as I can tell, the `range(160)` part is fine.

# android - 不同屏幕尺寸的 VideoView

> ID：13574612
> 
> 赞同：3
> 
> 时间：2012-11-26T22:58:08.380
> 
> 标签：android, android-videoview

我正在尝试为不同尺寸的屏幕插入视频。我想要的是一个很好的分辨率并且没有失真。我有 2 个用于大屏幕和小屏幕的视频。但我不知道如何插入它们。

我认为这就像从可绘制文件（hdpi、ldpi 等）中插入图像一样，您可以在所需的分辨率文件夹中添加图像。但我不知道视频是否会发生同样的情况。

请帮我将两个视频插入不同的分辨率！

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:59:08.143

就 Android 而言，[Drawable](http://developer.android.com/reference/android/graphics/drawable/package-summary.html)是任何类型的图形/图像/图标......但视频不属于该类别。就此而言，您必须将其放在“./assets/”文件夹中。因此，视频不会根据屏幕尺寸自动选择。

但是，即使视频位于不同的文件夹中，您也可以在 onCreate() 方法中以编程方式加载它们，如下所示：

```
Display mDisplay = getWindowManager().getDefaultDisplay(); 
int w = mDisplay.getWidth();
int h = mDisplay.getHeight();

if (w < 480 || h < 800) {
    mVideoView.setVideoPath(...your video in assets, of low resolution...);;
} else {
    mVideoView.setVideoPath(...your video in assets, of high resolution...);
}
... 
```

使用此方法或类似方法，您可以根据用户分辨率加载不同的视频，比 ldpi/mdpi/etc 方法更精确。

# mysql - 用 Django 保存 mysql 数据

> ID：13574618
> 
> 赞同：0
> 
> 时间：2012-11-26T22:58:56.007
> 
> 标签：mysql, django

我正在使用带有 MYSQL 后端的 Django，我注意到在我更新数据库中的数据和新数据可用之间存在延迟。这是我的代码中发生的事情：

```
def change_user_email_api(request):
logger.debug("API: resend verification email")
new_email = request.GET.get('email', '')
username = request.user.username
the_user = User.objects.get(username=username)
the_user.email = new_email
the_user.save()
send_verification_email(request.user)
return generate_success(callback) 
```

send_verification_email 向用户发送一封电子邮件以验证他们的电子邮件帐户。我认为错误是由于我将 request.user 而不是 the_user 传递给 send_verification_email。

有什么方法可以确保我始终拥有数据库中的最新数据，如果是这样，我是否应该这样做？还是我应该接受数据需要一些时间来更新和设计？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:33:12.743

request.user 不会从数据库中获取用户对象。它是在请求范围内设置对象的中间件。因此，当您使用 request.user 时，您不能指望为您提供用户的更新实例。如果要发送电子邮件，则必须使用“the_user”对象

```
def change_user_email_api(request):
   logger.debug("API: resend verification email")
   new_email = request.GET.get('email', '')
   the_user = request.user
   the_user.email = new_email
   the_user.save()
   send_verification_email(the_user)
   return generate_success(callback) 
```

# c# - 将重复应用于代码隐藏的约会（DevExpress Scheduler Control）

> ID：13574622
> 
> 赞同：2
> 
> 时间：2012-11-26T22:59:18.207
> 
> 标签：c#, wpf, devexpress

我正在使用[devExpress 调度程序控件](http://documentation.devexpress.com/#wpf/CustomDocument8679)。请注意，我在以下代码中要实现的目标是在代码后面的约会中添加重复。在此示例中，我在创建新约会时这样做。

**我的窗口由一个调度程序控件组成：**

```
<Window x:Class="WpfApplication1.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="MainWindow" Height="350" Width="525"
        xmlns:dxsch="http://schemas.devexpress.com/winfx/2008/xaml/scheduler">

    <dxsch:SchedulerControl Name="schedulerControl1" />

</Window> 
```

**后面的代码包括：**

```
using System.Windows;
using DevExpress.XtraScheduler;

namespace WpfApplication1
{
    public partial class MainWindow : Window
    {
        public MainWindow() // Constructor
        {
            InitializeComponent();
            this.Loaded += new RoutedEventHandler(MainWindow_Loaded);
        }

        void MainWindow_Loaded(object sender, RoutedEventArgs e) // Fires when window loads
        {
            schedulerControl1.Storage.AppointmentsInserted += new PersistentObjectsEventHandler(Storage_AppointmentsInserted);
        }

        void Storage_AppointmentsInserted(object sender, PersistentObjectsEventArgs e) // fires when a new appointment is added
        {
            Appointment addedAppointment = null;
            foreach (Appointment item in e.Objects)
                addedAppointment = item;

            /*
                I want to set the reinsurance info in here!
                I cant because RecuranceInfo = null!                  
            */
            addedAppointment.RecurrenceInfo.Type = RecurrenceType.Hourly; // <- App Crashes
        }               
    }
} 
```

我不想绑定控件的重复属性。

**换句话说**，如果我可以创建一个从今天下午 2 点开始并每天重复且没有结束日期的约会，那就太好了。我怎么能在后面的代码上创建那个约会？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T14:43:37.110

答案在此链接中： [http ://documentation.devexpress.com/#WindowsForms/CustomDocument6201](http://documentation.devexpress.com/#WindowsForms/CustomDocument6201)

基本上我必须这样做：

```
 Appointment apt = schedulerControl1.Storage.CreateAppointment(AppointmentType.Pattern);
        apt.Start = DateTime.Now;
        apt.End = apt.Start.AddHours(2);
        apt.Subject = "My Subject";
        apt.Location = "My Location";
        apt.Description = "My Description";

        apt.RecurrenceInfo.Type = RecurrenceType.Daily;

        schedulerControl1.Storage.AppointmentStorage.Add(apt); 
```

# javascript - iOS webview中的javascript在应用程序代码中不起作用，但在远程调试器中起作用

> ID：13574623
> 
> 赞同：0
> 
> 时间：2012-11-26T22:59:19.237
> 
> 标签：javascript, ios, remote-debugging

我在 webview 上通过 stringByEvaluatingJavaScriptFromString 运行一些 javascript 代码。当我尝试在代码中记录 js 的结果时没有输出，除非我运行像“document.title”这样简单的东西，它可以工作。

但是使用 Safari 中的远程调试器，我可以使用控制台运行完全相同的代码并获得正确的结果。

关于这里可能发生什么会阻止 javascript 在应用程序中工作的任何想法？显然代码很好，因为它可以在调试器中运行。在应用程序的 web 视图中运行 javascript 是否有限制？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-01T18:01:17.387

我在让 Javascript/Native 接口工作时也遇到了一些问题，所以我的一些学习：

*   一旦 Javascript 解释器遇到错误（无论如何，缺少分号或其他），它就会默默地停止工作并且不会继续。
*   听起来很愚蠢，但放入`@"alert(1);"`你的`stringByEvaluatingJavaScriptFromString:`，看看它是否确实有效。
*   保持通过 stringByEvaluatingJavaScriptFromString 发送的命令简短；创建 javascript 方法并从本机代码调用它们，例如，
    `[self.webView stringByEvaluatingJavaScriptFromString:@"doalliwant();"];`
    而不是通过该接口传输 100 kb 文件。
*   使用类似[https://code.google.com/p/jsbridge-to-cocoa/](https://code.google.com/p/jsbridge-to-cocoa/)的东西将数据从 Javascript 发送到 Obj-C 代码。这样，您可以在 Javascript 中实现最少的登录。（通过将其发送到 Obj-C 并在那里记录）
*   为您的 UIWebview 使用远程调试，WWDC 会话“600 - 在 iOS 上调试 UIWebViews 和网站”对此进行了描述。您可以通过 iOS 开发者计划网站获得它。要启用基础功能，请转到 Settings->Safari->Advanced 并启用 Web Inspector。将您的设备连接到 Mac，在调试器中启动 XCode 和您的应用程序。在 Mac 上启动 Safari。打开 Safari 的设置，在最后一个选项卡中启用开发者菜单。重新启动 Safari。在新的开发者菜单中，您现在应该会看到您的 iOS 设备的名称，您可以在其中选择您的应用并开始调试。

希望这能让你开始......

# php - 删除两个 " 之间的断线 (\n)

> ID：13574625
> 
> 赞同：1
> 
> 时间：2012-11-26T22:59:21.183
> 
> 标签：php, regex

我再次在这里问:)

假设我在 PHP 中有一个字符串，如下所示：

```
Lorem ipsum dolor sit amet, consectetur
adipiscing elit. "Sed et est eget lorem congue
eleifend. Fusce luctus" 
```

对，所以你在这两个引号中看到字符串 ---> "，对，如果在 db 中有一个文本，在这两个引号之间，它不应该有这样的换行符，有没有办法，在正则表达式中PHP中的preg_replace函数来定位这两个符号之间的断线并删除它们？

谢谢你们的时间，马特

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:12:07.740

关于匹配或嵌套元素（在这种情况下匹配引号）的问题对于正则表达式通常有点尴尬。

首先，让我在这里做一个假设：您的输入中不允许使用引号内的转义引号（即您从未有过`Lorem "ipsem \" dolor"`或类似的东西）。

有了这个假设，你的问题归结为：找到一个`\n`后跟奇数的`"`（计数到字符串末尾）。为了确保这种情况，我们可以使用前瞻。为了避免前导或尾随空格的问题，我们可以匹配任何围绕 an 的空格`\n`并将其替换为单个空格。

```
$result = preg_replace('/\s*\n\s*(?=[^"]*"(?:[^"]*"[^"]*")*[^"]*$)/', ' ', $input); 
```

您可能希望将其替换`\n`为`[\r\n]`互操作性。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:10:11.907

您应该能够使用内置的转义功能，例如[http://www.php.net/manual/en/mysqli.real-escape-string.php](http://www.php.net/manual/en/mysqli.real-escape-string.php)。这样他们就会被转义，这意味着你会保留信息，但它会是数据库友好的。

# php - 间歇性断开链接不起作用

> ID：13574626
> 
> 赞同：0
> 
> 时间：2012-11-26T22:59:22.360
> 
> 标签：php, zend-framework, delete-file, unlink

下面的代码允许我有时删除文件。我已经检查了文件和文件夹的权限，它们存在并获得了适当的访问权限。有时当我按下删除按钮时；它会删除文件，有时它只是刷新页面而没有任何反应。我可以做些什么来使 unlink 正常工作吗？我在下面的代码中遗漏了什么吗？这是在 ZEND 中。

```
public function delimageAction()
{
    $request = $this->getRequest();

    if ($request->isPost()) {
        // Get the image name
        $imageName = $request->getParam('file');

        $old = getcwd();
        chdir(APPLICATION_PATH . "/../public/images/blog/"); // Change directory to the files
        fclose(APPLICATION_PATH . "/../public/images/blog/" . $imageName);

        // Delete it
        unlink(APPLICATION_PATH . "/../public/images/blog/" . $imageName)

        chdir($old); // Return to old directory
    }
    $this->_helper->redirector('blog', 'index');
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T10:31:09.287

删除这两个`chdir`调用，因为它们没有任何作用，`fclose`这将导致错误。除此之外，您需要检查错误日志以查看导致删除失败的原因，这可能与权限有关。您还可以检查 的返回值`unlink`，因为如果它不起作用，它应该返回 false。

正如评论中所暗示的，您的脚本中存在相当大的安全漏洞，因为它允许恶意用户删除您应用程序中的任何文件。您需要清理“文件”参数以确保提供的路径在`public/images/blog/`文件夹内。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-08-24T18:00:48.407

```
public function delimageAction()
{
    $request = $this->getRequest();

    if ($request->isPost()) 
    {
        // Get the image name
        $imageName = $request->getParam('file');

        // Delete it
        unlink(APPLICATION_PATH . "/../public/images/blog/" . $imageName)

    }

    $this->_helper->redirector('blog', 'index');
} 
```

# ruby-on-rails - Rails 应用程序从 SQLServer db 发送 word 文档、outlook 电子邮件时出现文档转换错误

> ID：13574630
> 
> 赞同：0
> 
> 时间：2012-11-26T22:59:36.940
> 
> 标签：ruby-on-rails, sql-server, ruby-on-rails-3, ms-access

我有一个 Rails 应用程序，除其他外，它是内部客户查看保存的业务文档的另一种方式。word docs 电子邮件和 PDF 通过 Access 10 应用程序输入到我在 SQL Server 10 上运行的数据库中，并通过文件下载嵌入到 Access 中的绑定对象框架控件中。

二进制数据与相关记录一起保存到 sql 数据库后端。使用访问前端可以轻松存储和读取文档，但是我无法将文件从数据库中取出并通过 Rails 应用程序发送到客户端。

存储文档的字段是 SQL Server varbinary(max) 字段。

我尝试通过以下方式阅读将其发送到浏览器。

```
doc = @attachment.document
send_data doc, :filename => 'foo.docx' 
```

浏览器生成文件下载/打开对话框并将其识别为 MS Word 文档，但交付的文件是不可读的（即使它提供了大约正确的字节数。）

例如，当我尝试使用 word 文档时：

```
send_data doc, :type => "application/msword", :filename => 'foo.docx' 
```

我从控制器收到以下错误：

```
"\x8F" to UTF-8 in conversion from Windows-1252 to UTF-8 
```

建议，建议赞赏。

# prolog - Prolog：从列表的元素中创建函子项

> ID：13574633
> 
> 赞同：3
> 
> 时间：2012-11-26T22:59:50.330
> 
> 标签：prolog

我需要为谓词提供一个列表，并从中获取一个包含该列表元素的术语。

所以我会有类似的东西：

```
turn_into_struct(+List, -Term). 
```

我确实考虑过的一件事是`nb_setarg/3`对列表的每个元素递归使用，但是这样我需要用特定的数量来实例化这个术语，但我找不到如何做到这一点。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:24:33.883

您可以先找到列表的长度，用虚拟值构造新术语，然后递归或通过回溯（`findall`例如，使用 ）填充每个参数。如果您需要，我会填写其他详细信息（只要我不破坏您自己的努力）。

```
length(List, Len),
functor(Struct, struct, Len),
% Fill in each argument of Struct here... 
```

不过，有一种更简单的单行技术使用 SWI-Prolog 的`=..`谓词。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T15:35:36.660

从列表中创建术语的典型方法是使用[=..](http://www.swi-prolog.org/pldoc/doc_for?object=%28=..%29/2)（又名“Univ”）。例如，

```
turn_into_struct(List, Struct) :-
    Struct =.. [structure|List]. 
```

原始问题中“结构”的正确术语是“术语”。

（在其他答案的评论中提到了大学，但我将其重新发布为后代和更高知名度的答案）

# jquery-ui - 在“显示”选项中具有功能的 jQueryUI 选项卡始终显示默认效果

> ID：13574635
> 
> 赞同：2
> 
> 时间：2012-11-26T22:59:58.670
> 
> 标签：jquery-ui

当我在 jQueryUI 1.9.1 选项卡小部件的“显示”选项中包含一个函数时，默认效果 (fadeIn) 总是激活。有没有办法让一个函数在显示时调用，但没有效果？

```
$("#divTabContainer").tabs({
    "show": function(){
        var table = $.fn.dataTable.fnTables(false);
        if ( table.length > 0 ) {
            console.log(table);
            $(table).dataTable().fnAdjustColumnSizing();
        }
    }
}); 
```

我试图从函数中返回 false 或 null，但它没有任何影响，效果仍然存在。在 jQUI 1.8.1 中没有发生这种情况，即调用函数时没有效果。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:16:53.280

jQueryUI[`tabs/#option-show`](http://api.jqueryui.com/tabs/#option-show)是一种控制选项卡显示方式的方法。如果要在激活选项卡时或在激活选项卡之前添加功能，则应使用内置回调方法`activate`或。[`beforeActivate`](http://api.jqueryui.com/tabs/#event-beforeActivate)

例如：

```
$('#divTabContainer').tabs({
  show: false, /* turn off the effect */
  beforeActivate: function(event, ui) {
    // your function to adjust the dataTables column sizing
  }
}); 
```

# coldfusion - Coldfusion 安全 cfftp 超时

> ID：13574641
> 
> 赞同：2
> 
> 时间：2012-11-26T23:00:21.030
> 
> 标签：coldfusion, ssh, ftp, sftp

我正在使用 Coldfusion 9。我已验证 sFTP 主机有效，并且可以使用“Cyber​​Duck”进行连接。端口不是标准的 21 (ftp) 或 22 (ssh)

```
<cfftp 
    username=   "myysername"
    password=   "mypassword"
    port=       "6589"
    server=     "ftphost.com"
    secure=     "yes"
    name=       "ftpconnection"
    action=     "open" />

<cfdump var="#ftpconnection#"> 
```

大约 1 分钟后的结果是：

```
com.jcraft.jsch.JSchException: Session.connect: java.net.SocketTimeoutException: Read timed out
    at com.jcraft.jsch.Session.connect(Unknown Source)
    at com.jcraft.jsch.Session.connect(Unknown Source)
    at coldfusion.tagext.net.SftpHandler.getConnection(SftpHandler.java:265)
    at coldfusion.tagext.net.SftpHandler.createConnection(SftpHandler.java:76)
    at coldfusion.tagext.net.FtpTag.doStartTag(FtpTag.java:675)
    at coldfusion.runtime.CfJspPage._emptyTcfTag(CfJspPage.java:2722) 
```

我还尝试通过手动调用 JSCH 类（[http://www.jcraft.com/jsch/examples/Sftp.java.html](http://www.jcraft.com/jsch/examples/Sftp.java.html)）来建立这种连接，但无济于事。

问题是，为什么在代码中会出现这种超时，但在使用 Cyber​​Duck 这样的程序时却不会？

**编辑以添加 CF-Java 代码**

```
jsch = CreateObject("java", "com.jcraft.jsch.JSch");
jsession = CreateObject("java", "com.jcraft.jsch.Session");
jChannel = CreateObject("java", "com.jcraft.jsch.Channel");
jChannelSFTP = CreateObject("java", "com.jcraft.jsch.ChannelSftp");
jUserInfo = CreateObject("java", "com.jcraft.jsch.UserInfo");
jProperties = CreateObject("java", "java.util.Properties");
jLogger = CreateObject("java", "com.jcraft.jsch.Logger");

host = "ftphost.com";
username = "myusername";
portNumber = "6589";

javaCast("String", "host");
javaCast("String", "username");

/* *********************** */
jProperties.put("StrictHostKeyChecking", "no");
jsession = jsch.getSession(username, host, portNumber);
jsession.setPassword("mypassword");
jsession.setPort(6589);
jsession.setUserInfo(jUserInfo);
jsession.setConfig(jProperties);

writeOutput("Connect ...");
getPageContext().getOut().flush();
jsession.connect();
writeOutput("done <br>"); 
```

这段代码本身没有错误，但 connect() 方法永远不会“返回”：

```
connection is closed by foreign host

    The error occurred in /Library/WebServer/Coldfusion/SFTP/index.cfm: line 53
    51 : writeOutput("Connect ...");
    52 : getPageContext().getOut().flush();
    53 : jsession.connect();
    54 : writeOutput("done <br>");
    55 : 
```

**编辑显示 CYBERDUCK 连接日志**

```
220 Service ready for new user.
AUTH TLS
234 Command AUTH okay; starting TLS connection.
USER myusername
331 User name okay, need password for myusername.
PASS ********
230 User logged in, proceed.
PBSZ 0
200 Command PBSZ okay.
PROT P
200 Command PROT okay.
FEAT
[ ... ]

OPTS UTF8 ON
200 Command OPTS okay.
NOOP
200 Command NOOP okay.
SYST
215 UNIX Type: Apache FtpServer
STAT /root
200--rw-------   1 SMG TGMS       263375 Nov 25 01:35 afile.txt 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2015-04-24T11:55:02.240

我遇到了类似的问题，根本原因是 ColdFusion 服务没有以本地用户身份运行。如果您在控制台模式下运行 CF，您将看到 FTP 站点正在等待用户接受身份验证。在 CF 方面，它只是超时。

为了解决这个问题，我在 cfftp 标记之前添加了这两行。

```
<cfset _jsch = CreateObject('java','com.jcraft.jsch.JSch')>
<cfset _jsch.setConfig("PreferredAuthentications", "publickey,keyboard-interactive,password")> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-01T13:53:17.800

您是否尝试过更改 cfhttp 的超时值。您可以使用`<cfhttp timeout="240">`和 指定以秒为单位更改默认超时。

# php - Grails 不能在同一台服务器上向 PHP 脚本发出 HTTP 请求？

> ID：13574643
> 
> 赞同：0
> 
> 时间：2012-11-26T23:00:27.597
> 
> 标签：php, grails

我需要位于[http://myserver.com/app/](http://myserver.com/app/)的 Grails 应用程序来访问同一服务器上的 PHP 脚本。我正在使用 groovyx.net.http.HTTPBuilder 发出请求，如果脚本在另一台服务器上，它会起作用。但是如果我将脚本移动到[http://myserver.com/php/script.php](http://myserver.com/php/script.php)，我会得到

```
java.net.ConnectException
Message
Connection refused 
```

[该脚本在http://myserver.com/php/script.php](http://myserver.com/php/script.php)的 Web 浏览器中正常运行

如何让 Grails 提出请求？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T15:42:32.280

服务器使用公共 URL 拒绝了来自 & 自身的 HTTP 请求。如果使用服务器名称“localhost”发出请求，则该请求将按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:08:38.390

您知道 Grails 在 Java EE（通常是 Tomcat）Web 服务器上运行，而您要移动的 PHP 文件可能在 Apache/Apache2 Web 服务器上运行？（Tomcat也是Apache做的，所以这个名字是不幸的。）

您不能只是将 PHP 文件从一台服务器移动到另一台服务器并期望它能够正常工作。您必须在运行 Grails 的服务器上设置直接的 C Apache，可能将其配置为在不同的端口上运行（因为如果 Tomcat 和 Apache 都在监听 80，它们会发生冲突），安装 PHP 模块，然后设置您的 PHP 应用程序。

# ruby-on-rails - 未找到 Rails 路线，但在 rake 路线中显示

> ID：13574644
> 
> 赞同：2
> 
> 时间：2012-11-26T23:00:39.423
> 
> 标签：ruby-on-rails, routes, rake

我得到以下信息：

```
Started DELETE "/comments/13115742" for 127.0.0.1 at 2012-11-26 14:37:32 -0800

ActionController::RoutingError (No route matches [DELETE] "/comments/13115742"): 
```

但是'rake routes'清楚地显示了这条路线：

```
$ rake routes
comments POST   /comments(.:format)                comments#create {:id=>/0-9+/, :format=>/json|html/}
 comment GET    /comments/:id(.:format)            comments#show {:id=>/0-9+/, :format=>/json|html/}
         PUT    /comments/:id(.:format)            comments#update {:id=>/0-9+/, :format=>/json|html/}
         DELETE /comments/:id(.:format)            comments#destroy {:id=>/0-9+/, :format=>/json|html/} 
```

而且 routes.rb 明确定义了路由：

```
resources :comments, :constraints => {:id => /0-9+/, :format => /json|html/}, :except => [:new, :index, :edit] 
```

请注意，我有一个评论控制器，并且从控制台路由也不起作用：

```
Loading development environment (Rails 3.2.8)
irb(main):001:0> r = Rails.application.routes
=> #<ActionDispatch::Routing::RouteSet:0x007f9ae17b66e0>
irb(main):002:0> r.recognize_path "/comments/3"
ActionController::RoutingError: No route matches "/comments/3"
    from /Users/nick/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/actionpack-3.2.8/lib/action_dispatch/routing/route_set.rb:633:in `recognize_path'
    from (irb):2
    from /Users/nick/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands/console.rb:47:in `start'
    from /Users/nick/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands/console.rb:8:in `start'
    from /Users/nick/.rbenv/versions/1.9.3-p327/lib/ruby/gems/1.9.1/gems/railties-3.2.8/lib/rails/commands.rb:41:in `<top (required)>'
    from script/rails:6:in `require'
    from script/rails:6:in `<main>'
irb(main):003:0> CommentsController.new()
=> #<CommentsController:0x007f9ae3f9d9b0 @_routes=nil, @_action_has_layout=true, @_headers={"Content-Type"=>"text/html"}, @_status=200, @_request=nil, @_response=nil> 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:05:27.243

您的`:id`约束当前不会与您打算匹配的数字字符串匹配。

而不是`/0-9+/`，请尝试`/[0-9]+/`或`/\d+/`

你所拥有的将匹配类似`/conversations/0-9`或`/conversations/0-9999999`

# php - 没有重复的输出行

> ID：13574650
> 
> 赞同：0
> 
> 时间：2012-11-26T23:01:06.670
> 
> 标签：php, mysql, select, distinct

我正在尝试输出最新的行但不显示任何重复项。我的表有一个唯一的 id (note_id) 和 issue_id，可以分配给多个 (note_ids)；这样，每个条目都是唯一的，但可以与一个常见问题相关联。

这是我的代码：

```
$issueSelect = "SELECT DISTINCT issue_id FROM notes WHERE assigned = '$loginID' ORDER BY note_id ASC";
    $issueQuery = mysql_query($issueSelect); 
```

然后我在while循环中有一个输出语句：

```
while ($issueResult = mysql_fetch_assoc($issueQuery)){
$issueID = $issueResult['issue_id'];
$issue = $issueResult['issue'];
      if ($issue == "open" or $issue == "assigned"){
                echo"<td align='right'><a href=\"note_details.php?note_click=$issueID\">$issueID</td>"; 
```

}

但是由于某种原因，我什么也没得到……当我把`SELECT *`它显示的东西时，它包括重复项（我不想要）。

我缺少的任何东西可能是为什么这不起作用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:07:37.457

那么，您正在使用`note_id`and的复合键`issue_id`？您应该尝试使用该[`GROUP BY`](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html)功能：

```
SELECT `issue_id`, `issue` FROM `notes` WHERE `assigned` = '$loginID' GROUP BY `note_id`, `issue_id` ORDER BY `note_id` ASC; 
```

此外，`mysql_*`现在已弃用，您不应该真正使用它。查找 PDO 和`mysqli`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:05:40.160

你什么都得不到，因为`$issue`is `null`。您可以使用`group by issue_id`代替`distinct`，但它是非标准的，可能会或可能不会根据您的安装工作。

如果它不起作用，您可能需要使用`select *`然后过滤 PHP 中的重复项。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:04:23.380

必须实际选择问题字段（在我想要显示的其他字段中......这就是我所做的：

```
$issueSelect = "SELECT DISTINCT issue_id, issue, reason, customer_id, order_id, return_id, author_id FROM notes WHERE assigned = '$loginID' ORDER BY note_id ASC";
    $issueQuery = mysql_query($issueSelect);
    while ($issueResult = mysql_fetch_assoc($issueQuery)){
$issueID = $issueResult['issue_id'];
        $issue = $issueResult['issue'];
        $assigned = $issueResult['assigned'];
        $openDate = $issueResult['date'];
        $closeDate = $issueResult['close_date'];
        $orderID = $issueResult['order_id'];
        $returnID = $issueResult['return_id'];
        $customerID = $issueResult['customer_id'];
        $authorID = $issueResult['author_id'];
        $reason = $issueResult['reason'];
} 
```

感谢您的所有帮助...我会研究 POD 和 MySQLi

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T00:20:01.843

您原来的查询是：

```
SELECT DISTINCT issue_id FROM notes WHERE assigned = '$loginID' ORDER BY note_id ASC 
```

我认为由于 ORDER BY 子句，这产生了多行。您正在隐式扩展选择列表`note_id`，然后排序，然后投影`note_id`，但是单个问题有多个注释，因此尽管有 DISTINCT，但您已经为单个问题返回了多行（因为 DISTINCT 已完成在订购之前）。

# javascript - 菜单为空时如何设置 Ext.button.Split 不显示箭头？

> ID：13574651
> 
> 赞同：1
> 
> 时间：2012-11-26T23:01:06.600
> 
> 标签：javascript, extjs, extjs4

我有 Ext.button.Split，例如：

```
Ext.create('Ext.button.Split', {
    renderTo: Ext.getBody(),
    text: 'Example',
    handler: function() {
        alert("Click!");
    }
}); 
```

现在它没有任何菜单项。如果没有项目，我想将按钮设置为不显示箭头。如何 ？我使用 EXTJS 4.1 版本。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T07:10:17.590

您可以设置`split: false`隐藏箭头。您也可以使用`Ext.button.Button`代替`Ext.button.Split`- 分配菜单时，箭头显示。

示例：http: [//jsfiddle.net/AUE6J/](http://jsfiddle.net/AUE6J/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-19T16:23:15.783

ExtJS 6.0.1 也有类似的问题。

一旦拆分按钮被渲染（至少在某些面板中，如网格列中的操作小部件），只需设置属性：

```
button.arrowVisible = false; 
```

...不管用。你必须这样做：

```
button.setConfig('arrowVisible', false); 
```

# apache - .htaccess | 虚 URL 导致手动设置 $_GET 变量不生效

> ID：13574653
> 
> 赞同：1
> 
> 时间：2012-11-26T23:01:09.593
> 
> 标签：apache, .htaccess

我有 htaccess 重写 mods 来使用虚 url。我试图手动将 $_GET 变量传递给登录页面，告诉人们登录失败，但由于虚 URL，手动传递的 $_GET 变量被忽略。我该如何解决？

这是我想要通过的，

```
http://mysite.com/login?failed=1 
```

但它工作的唯一方法是执行以下操作，

```
http://mysite.com/?p=login&failed=1 
```

这会产生明显更丑陋的效果。

我的 htaccess 文件，

```
RewriteEngine On
RewriteBase /ncms/admin
RewriteRule ^([a-zA-Z0-9-]+)$ index.php?p=$1 [L]
RewriteRule ^([a-zA-Z0-9-]+)/$ index.php?p=$1 [L] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T03:11:48.123

将您的 .htaccess 代码更改为：

```
RewriteEngine On
RewriteBase /ncms/admin
RewriteRule ^([a-zA-Z0-9-]+)/?$ index.php?p=$1 [L,QSA] 
```

*   技巧是使用 QSA（查询字符串附加）标志附加`p=login`到现有的查询字符串
*   如您所见，您的两条规则可以按照我的建议合并为一条

# breeze - hasChanges() == true 在 Appstart

> ID：13574655
> 
> 赞同：1
> 
> 时间：2012-11-26T23:01:14.193
> 
> 标签：breeze

编辑：JSON不完整，不得不削减一些

第一次从服务器查询时，某个实体以某种方式具有“已添加”的 EntityState。我在 DBContextInitializer 中创建了 3 个用户。每次我启动我的应用程序时都会发生这种情况。如果我打电话，它将处于“未更改”状态`Manager.rejectChanges()`，但我必须手动执行此操作。

如果我不这样做，并保存另一个实体（可能是团队/订单/订单详细信息），则特定用户将被保存为其原始实体的副本，具有唯一键但具有相同值（如名称等）。如果我可能忘记了什么，我检查了我的代码十几次，但我不会在任何地方调用此用户实体的任何状态更改。

这是`Manager.getChanges`（“用户”的实体类型）的打印：

```
[
[
    {
        "entityAspect": {
            "entityGroup": {
                "entityManager": {
                    "serviceName": "api/Breeze/",
                    "metadataStore": {
                        "namingConvention": {
                            "name": "noChange"
                        },
                        "localQueryComparisonOptions": {
                            "name": "caseInsensitiveSQL",
                            "isCaseSensitive": false,
                            "usesSql92CompliantStringComparison": true
                        },
                        "dataServices": [
                            {
                                "serviceName": "api/Breeze/",
                                "adapterName": null,
                                "hasServerMetadata": true
                            }
                        ],
                        "_resourceEntityTypeMap": {
                            "Mvls": "Mvl:#MAHN.Model",
                            "MvlOps": "MvlOP:#MAHN.Model",
                            "StatusOps": "StatusOP:#MAHN.Model",
                            "Teams": "Team:#MAHN.Model",
                            "TeamLeaders": "TeamLeaders:#MAHN.Model",
                            "Users": "User:#MAHN.Model",
                            "TeamUsers": "TeamUsers:#MAHN.Model",
                            "UserRoles": "UserRoles:#MAHN.Model",
                            "Roles": "Role:#MAHN.Model",
                            "TeamRoles": "TeamRoles:#MAHN.Model"
                        },
                        "_entityTypeResourceMap": {
                            "Mvl:#MAHN.Model": "Mvls",
                            "MvlOP:#MAHN.Model": "MvlOps",
                            "StatusOP:#MAHN.Model": "StatusOps",
                            "Team:#MAHN.Model": "Teams",
                            "TeamLeaders:#MAHN.Model": "TeamLeaders",
                            "User:#MAHN.Model": "Users",
                            "TeamUsers:#MAHN.Model": "TeamUsers",
                            "UserRoles:#MAHN.Model": "UserRoles",
                            "Role:#MAHN.Model": "Roles",
                            "TeamRoles:#MAHN.Model": "TeamRoles"
                        },
                        "_entityTypeMap": {
                          "User:#MAHN.Model": {
                                "name": "User:#MAHN.Model",
                                "shortName": "User",
                                "namespace": "MAHN.Model",
                                "defaultResourceName": "Users",
                                "dataProperties": [
                                    {
                                        "name": "UserId",
                                        "nameOnServer": "UserId",
                                        "dataType": "Int32",
                                        "isNullable": false,
                                        "defaultValue": 0,
                                        "validators": [
                                            {
                                                "validatorName": "required"
                                            },
                                            {
                                                "validatorName": "int32"
                                            }
                                        ],
                                        "isPartOfKey": true
                                    },
                                    {
                                        "name": "UserName",
                                        "nameOnServer": "UserName",
                                        "dataType": "String",
                                        "isNullable": true,
                                        "fixedLength": false,
                                        "validators": [
                                            {
                                                "validatorName": "string"
                                            }
                                        ],
                                        "isPartOfKey": false
                                    },
                                    {
                                        "name": "Nachname",
                                        "nameOnServer": "Nachname",
                                        "dataType": "String",
                                        "isNullable": true,
                                        "fixedLength": false,
                                        "validators": [
                                            {
                                                "validatorName": "string"
                                            }
                                        ],
                                        "isPartOfKey": false
                                    },
                                    {
                                        "name": "Vorname",
                                        "nameOnServer": "Vorname",
                                        "dataType": "String",
                                        "isNullable": true,
                                        "fixedLength": false,
                                        "validators": [
                                            {
                                                "validatorName": "string"
                                            }
                                        ],
                                        "isPartOfKey": false
                                    },
                                    {
                                        "name": "OasisLogin",
                                        "nameOnServer": "OasisLogin",
                                        "dataType": "String",
                                        "isNullable": true,
                                        "fixedLength": false,
                                        "validators": [
                                            {
                                                "validatorName": "string"
                                            }
                                        ],
                                        "isPartOfKey": false
                                    }
                                ],
                                "navigationProperties": [
                                    {
                                        "name": "TeamUsers",
                                        "nameOnServer": "TeamUsers",
                                        "entityTypeName": "TeamUsers:#MAHN.Model",
                                        "isScalar": false,
                                        "associationName": "TeamUsers_User",
                                        "foreignKeyNames": [],
                                        "foreignKeyNamesOnServer": [],
                                        "validators": []
                                    },
                                    {
                                        "name": "UserRoles",
                                        "nameOnServer": "UserRoles",
                                        "entityTypeName": "UserRoles:#MAHN.Model",
                                        "isScalar": false,
                                        "associationName": "UserRoles_User",
                                        "foreignKeyNames": [],
                                        "foreignKeyNamesOnServer": [],
                                        "validators": []
                                    }
                                ],
                                "autoGeneratedKeyType": "Identity",
                                "validators": []
                            },

                        "Team:#MAHN.Model": {
                            "entityType": {
                                "name": "Team:#MAHN.Model",
                                "shortName": "Team",
                                "namespace": "MAHN.Model",
                                "defaultResourceName": "Teams",
                                "autoGeneratedKeyType": "Identity"
                            },
                            "_indexMap": {
                                "1": 1,
                                "2": 0,
                                "3": 2,
                                "4": 3
                            },
                            "_entities": [
                                {
                                    "entityAspect": {
                                        "entityState": {
                                            "_$typeName": "EntityState",
                                            "name": "Unchanged"
                                        },
                                        "isBeingSaved": false,
                                        "originalValues": {},
                                        "_validationErrors": {},
                                        "validationErrorsChanged": {
                                            "name": "validationErrorsChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "propertyChanged": {
                                            "name": "propertyChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "_entityKey": {
                                            "entityType": "Team:#MAHN.Model",
                                            "values": [
                                                2
                                            ]
                                        },
                                        "wasLoaded": true
                                    }
                                },
                                {
                                    "entityAspect": {
                                        "entityState": {
                                            "_$typeName": "EntityState",
                                            "name": "Unchanged"
                                        },
                                        "isBeingSaved": false,
                                        "originalValues": {},
                                        "_validationErrors": {},
                                        "validationErrorsChanged": {
                                            "name": "validationErrorsChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "propertyChanged": {
                                            "name": "propertyChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "_entityKey": {
                                            "entityType": "Team:#MAHN.Model",
                                            "values": [
                                                1
                                            ]
                                        },
                                        "wasLoaded": true
                                    }
                                },
                                {
                                    "entityAspect": {
                                        "entityState": {
                                            "_$typeName": "EntityState",
                                            "name": "Unchanged"
                                        },
                                        "isBeingSaved": false,
                                        "originalValues": {},
                                        "_validationErrors": {},
                                        "validationErrorsChanged": {
                                            "name": "validationErrorsChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "propertyChanged": {
                                            "name": "propertyChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "_entityKey": {
                                            "entityType": "Team:#MAHN.Model",
                                            "values": [
                                                3
                                            ]
                                        },
                                        "wasLoaded": true
                                    }
                                },
                                {
                                    "entityAspect": {
                                        "entityState": {
                                            "_$typeName": "EntityState",
                                            "name": "Unchanged"
                                        },
                                        "isBeingSaved": false,
                                        "originalValues": {},
                                        "_validationErrors": {},
                                        "validationErrorsChanged": {
                                            "name": "validationErrorsChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "propertyChanged": {
                                            "name": "propertyChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "_entityKey": {
                                            "entityType": "Team:#MAHN.Model",
                                            "values": [
                                                4
                                            ]
                                        },
                                        "wasLoaded": true
                                    }
                                }
                            ],
                            "_emptyIndexes": []
                        },
                        "TeamLeaders:#MAHN.Model": {
                            "entityType": {
                                "name": "TeamLeaders:#MAHN.Model",
                                "shortName": "TeamLeaders",
                                "namespace": "MAHN.Model",
                                "defaultResourceName": "TeamLeaders",
                                "autoGeneratedKeyType": "Identity"
                            },
                            "_indexMap": {
                                "1": 0
                            },
                            "_entities": [
                                {
                                    "entityAspect": {
                                        "entityState": {
                                            "_$typeName": "EntityState",
                                            "name": "Unchanged"
                                        },
                                        "isBeingSaved": false,
                                        "originalValues": {},
                                        "_validationErrors": {},
                                        "validationErrorsChanged": {
                                            "name": "validationErrorsChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "propertyChanged": {
                                            "name": "propertyChanged_entityAspect",
                                            "_nextUnsubKey": 1
                                        },
                                        "_entityKey": {
                                            "entityType": "TeamLeaders:#MAHN.Model",
                                            "values": [
                                                1
                                            ]
                                        },
                                        "wasLoaded": true
                                    }
                                }
                            ],
                            "_emptyIndexes": []
                        }
                    },
                    "_unattachedChildrenMap": {
                        "map": {}
                    },
                    "keyGenerator": {
                        "_tempIdMap": {},
                        "nextNumber": -1,
                        "nextNumberIncrement": -1,
                        "stringPrefix": "K_"
                    },
                    "_hasChanges": true
                },
                "entityType": {
                    "name": "User:#MAHN.Model",
                    "shortName": "User",
                    "namespace": "MAHN.Model",
                    "defaultResourceName": "Users",
                    "autoGeneratedKeyType": "Identity"
                },
                "_indexMap": {
                    "1": 2,
                    "2": 0,
                    "3": 1
                },
                "_entities": [
                    {
                        "entityAspect": {
                            "entityState": {
                                "_$typeName": "EntityState",
                                "name": "Unchanged"
                            },
                            "isBeingSaved": false,
                            "originalValues": {},
                            "_validationErrors": {},
                            "validationErrorsChanged": {
                                "name": "validationErrorsChanged_entityAspect",
                                "_nextUnsubKey": 1
                            },
                            "propertyChanged": {
                                "name": "propertyChanged_entityAspect",
                                "_nextUnsubKey": 1
                            },
                            "_entityKey": {
                                "entityType": "User:#MAHN.Model",
                                "values": [
                                    2
                                ]
                            },
                            "wasLoaded": true
                        }
                    },
                    {
                        "entityAspect": {
                            "entityState": {
                                "_$typeName": "EntityState",
                                "name": "Unchanged"
                            },
                            "isBeingSaved": false,
                            "originalValues": {},
                            "_validationErrors": {},
                            "validationErrorsChanged": {
                                "name": "validationErrorsChanged_entityAspect",
                                "_nextUnsubKey": 1
                            },
                            "propertyChanged": {
                                "name": "propertyChanged_entityAspect",
                                "_nextUnsubKey": 1
                            },
                            "_entityKey": {
                                "entityType": "User:#MAHN.Model",
                                "values": [
                                    3
                                ]
                            },
                            "wasLoaded": true
                        }
                    },
                    null
                ],
                "_emptyIndexes": []
            },
            "entityState": {
                "_$typeName": "EntityState",
                "name": "Added"
            },
            "isBeingSaved": false,
            "originalValues": {},
            "_validationErrors": {},
            "validationErrorsChanged": {
                "name": "validationErrorsChanged_entityAspect",
                "_nextUnsubKey": 1
            },
            "propertyChanged": {
                "name": "propertyChanged_entityAspect",
                "_nextUnsubKey": 1
            },
            "_entityKey": {
                "entityType": "User:#MAHN.Model",
                "values": [
                    1
                ]
            },
            "wasLoaded": true
        }
    }
 ]
] 
```

我无法从中提取很多信息，但我认为这个特殊部分很奇怪。为什么该数组中的第三个对象`null`但在该数组之后不久显示为“已添加”状态：

```
"_entities": [
                {
                    "entityAspect": {
                        "entityState": {
                            "_$typeName": "EntityState",
                            "name": "Unchanged"
                        },
                        "isBeingSaved": false,
                        "originalValues": {},
                        "_validationErrors": {},
                        "validationErrorsChanged": {
                            "name": "validationErrorsChanged_entityAspect",
                            "_nextUnsubKey": 1
                        },
                        "propertyChanged": {
                            "name": "propertyChanged_entityAspect",
                            "_nextUnsubKey": 1
                        },
                        "_entityKey": {
                            "entityType": "User:#MAHN.Model",
                            "values": [
                                2
                            ]
                        },
                        "wasLoaded": true
                    }
                },
                {
                    "entityAspect": {
                        "entityState": {
                            "_$typeName": "EntityState",
                            "name": "Unchanged"
                        },
                        "isBeingSaved": false,
                        "originalValues": {},
                        "_validationErrors": {},
                        "validationErrorsChanged": {
                            "name": "validationErrorsChanged_entityAspect",
                            "_nextUnsubKey": 1
                        },
                        "propertyChanged": {
                            "name": "propertyChanged_entityAspect",
                            "_nextUnsubKey": 1
                        },
                        "_entityKey": {
                            "entityType": "User:#MAHN.Model",
                            "values": [
                                3
                            ]
                        },
                        "wasLoaded": true
                    }
                },
                null
            ], 
```

如果有帮助，我可以提供更多信息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T12:35:27.473

我有同样的问题。我发现在我的情况下导致这种情况的是结果中包含的导航属性（很多）。我仍在对此进行调查，但当将接收到的关联对象与“主要”对象连接起来时，Breeze 中的 updateRelatedEntityInCollection() 似乎设置了“已添加”。

```
function updateRelatedEntityInCollection(relatedEntity, relatedEntities, targetEntity, inverseProperty) {
        if (!relatedEntity) return;
        // check if the related entity is already hooked up
        var thisEntity = relatedEntity.getProperty(inverseProperty.name);
        if (thisEntity !== targetEntity) {
            // if not - hook it up.
            relatedEntities.push(relatedEntity); // <-- THIS WILL SET "ADDED" ON targetEntity
            relatedEntity.setProperty(inverseProperty.name, targetEntity);
        }
    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-30T02:24:42.667

好的，这里有一个错误，服务器上的某些实体图在序列化到客户端时会导致虚假的 entityState 更改。这应该在微风网站上或通过 nuget 提供的 v0.74.2 中修复。请让我们知道这是否可以解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:12:34.580

想帮忙，我很感激你被困住了。不幸的是，您提供的内容我无法取得太大进展。让我们用更简单的问题陈述和示例再试一次。

一个好的开始是查看来自对服务的简单 HTTP 调用的数据。尝试在浏览器地址栏中输入如下内容：
`http://localhost:12345/api/your-service/users`

您应该会看到您创建的三个用户的 JSON 数据。

现在尝试在客户端获取它们：

```
var em = new 微风.EntityManager('api/your-service');
var q = 微风.EntityQuery.from('用户')
        .using(em).execute()
        .then（查询成功）
        . 失败（查询失败）；

函数查询成功（数据）{
    var users = data.results;
    var changes = em.getChanges();
    var msg = "用户数 = " + users.length +
              "; 待定更改 = " + changes.length;
    警报（味精）；

函数查询失败（错误）{
   alert('查询失败：'+error.message);
}

```

如果警报框确认您有 3 个用户和非零未决更改……您有一些我们可以深入研究的东西。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-28T20:59:41.287

我一直在 v 0.73.6 上对此进行测试，并确保内部调用了“updateRelatedEntityInCollection”方法。

到目前为止，我还无法重现 entityManager.hasChanges() 返回 true 或 EntityManager.getChanges() 作为任何查询结果返回任何实体的问题。

我尝试使用查询“expands”、“loadNavigationProperty”，并更改 QueryOptions.MergeStrategy 都无法重现此；所以任何额外的提示都会非常有帮助。

# drupal - 如何使 Drupal 的 Omega 主题响应 IE8 及以下版本？

> ID：13574656
> 
> 赞同：1
> 
> 时间：2012-11-26T23:01:14.860
> 
> 标签：drupal, drupal-7, drupal-theming

我使用 Omega 主题 (http://drupal.org/project/omega)，它不支持 Omega 使用的 IE8 及以下的响应式设计。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:01:14.860

弄清楚了！我安装了 respondjs 模块 ( [http://drupal.org/project/respondjs](http://drupal.org/project/respondjs) ) 并且必须对 template.php 进行修改。查看[http://drupal.org/node/1388898](http://drupal.org/node/1388898)。看起来 IE 特定的 CSS 文件阻止了 respond.js 文件无法工作。我删除了 IE 特定样式表并将 ['browsers']['IE'] 从 gte IE 9 更改为 TRUE。这似乎对我有用。我将以下代码添加到我的 omega subthemes template.php 文件中。

```
<?php
function omega_subtheme_css_alter(&$css) {
    foreach ($css as $key => $value) {
        if (preg_match('/^ie::(\S*)/', $key)) {
            unset($css[$key]); 
        } else {
            $css[$key]['browsers']['IE'] = TRUE;
        }
    } 
} 
?> 
```

# multithreading - Updating UISearchDisplayController with Core Data results using GCD

> ID：13574660
> 
> 赞同：0
> 
> 时间：2012-11-26T23:01:36.307
> 
> 标签：multithreading, core-data, objective-c-blocks, grand-central-dispatch, uisearchdisplaycontroller

I'm having trouble displaying the results from Core Data in my UISearchDisplayController when I implement GCD. Without it, it works, but obviously blocks the UI.

In my SearchTableViewController I have the following two methods:

```
- (BOOL)searchDisplayController:(UISearchDisplayController *)controller shouldReloadTableForSearchString:(NSString *)searchString
{
    // Tell the table data source to reload when text changes
    [self filterContentForSearchText:searchString];

    // Return YES to cause the search result table view to be reloaded.
    return YES;
}

// Update the filtered array based on the search text
-(void)filterContentForSearchText:(NSString*)searchText
{
    // Remove all objects from the filtered search array
    [self.filteredLocationsArray removeAllObjects];

    NSPredicate *predicate = [CoreDataMaster predicateForLocationUsingSearchText:@"Limerick"];

    CoreDataMaster *coreDataMaster = [[CoreDataMaster alloc] init];

    // Filter the array using NSPredicate
    self.filteredLocationsArray = [NSMutableArray arrayWithArray:
                                   [coreDataMaster fetchResultsFromCoreDataEntity:@"City" UsingPredicate:predicate]];

} 
```

You can probably guess that my problem is with returning the array from [coreDataMaster fetchResultsFromCoreDataEntity]. Below is the method:

```
- (NSArray *)fetchResultsFromCoreDataEntity:(NSString *)entity UsingPredicate:(NSPredicate *)predicate
{    
    NSMutableArray *fetchedResults = [[NSMutableArray alloc] init];

    dispatch_queue_t coreDataQueue = dispatch_queue_create("com.coredata.queue", DISPATCH_QUEUE_SERIAL);

    dispatch_async(coreDataQueue, ^{

        NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
        NSEntityDescription *entityDescription = [NSEntityDescription
                                                  entityForName:entity inManagedObjectContext:self.managedObjectContext];

        NSSortDescriptor *nameSort = [[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES];
        NSArray *sortDescriptors = [NSArray arrayWithObjects:nameSort, nil];

        [fetchRequest setEntity:entityDescription];
        [fetchRequest setSortDescriptors:sortDescriptors];

        // Check if predicate is set
        if (predicate)
        {
            [fetchRequest setPredicate:predicate];
        }

        NSError *error = nil;

        NSArray *fetchedManagedObjects = [self.managedObjectContext executeFetchRequest:fetchRequest error:&error];

        for (City *city in fetchedManagedObjects)
        {
            [fetchedResults addObject:city];
        }

        NSDictionary *userInfo = [NSDictionary dictionaryWithObject:[NSArray arrayWithArray:fetchedResults] forKey:@"results"];

        [[NSNotificationCenter defaultCenter]
         postNotificationName:@"fetchResultsComplete"
         object:nil userInfo:userInfo];

    });

    return [NSArray arrayWithArray:fetchedResults];
} 
```

So the thread hasn't finished executing by the time it returns the results to self.filteredLocationsArray. I've tried added a NSNotification which passes the NSDictionary to this method:

```
- (void)updateSearchResults:(NSNotification *)notification
{
    NSDictionary *userInfo = notification.userInfo;
    NSArray *array = [userInfo objectForKey:@"results"];

    self.filteredLocationsArray = [NSMutableArray arrayWithArray:array];

    [self.tableView reloadData];
} 
```

I've also tried refreshing the searchViewController like

> [self.searchDisplayController.searchResultsTableView reloadData];

but to no avail. I'd really appreciate it if someone could point me in the right direction and show me where I might be going wrong.

Thanks

**Edit**

I just want to clarify something in Christopher's solution for future reference.

When I call this method, I put the GCD call to the main queue in the competition block. Also note the change to reload the tableView.

*Example*

```
[coreDataMaster fetchResultsFromCoreDataEntity:(NSString *)entity usingPredicate:(NSPredicate *)predicate completionHandler:^(NSArray *cities){

    dispatch_async(dispatch_get_main_queue(), ^{
        self.filteredLocationsArray = cities;
        [self.searchDisplayController.searchResultsTableView reloadData];
    });

}]; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T10:49:12.020

我想您不能使用搜索显示控制器的常用委托方法来更新 UI。异步搜索完成后，您需要自行更新 UI。

首先，避免冗余。丢弃整个搜索结果并重新搜索是没有意义的。相反，您可以使用谓词过滤内存中已有的结果。

其次，在`shouldReloadTableForSearchString`你应该 return `NO`。相反，通过触发数据数组的更新来响应搜索字符串的变化`filteredLocationsArray`。（您可以直接执行此操作，而无需像现在那样创建 3 个不同的副本。）然后*从异步进程内部*更新主线程上的表。这是架构：

```
dispatch_async(coreDataQueue, ^{
   // fetch the data
   dispatch_async(dispatch_get_main_queue(), ^{
       [_tableView reloadData];
   });
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T19:11:18.810

你有几个问题。

首先，您`fetchedResults`在异步回调中填充数组。`fetchResultsFromCoreDataEntity:usingPredicate:`在获取发生之前立即返回。处理这个问题的常用方法是添加一个完成处理程序块：

```
-(void)fetchResultsFromCoreDataEntity:(NSString *)entity usingPredicate:(NSPredicate *)predicate completionHandler:(void (^)(NSArray *))completionHandler {    
    // create this queue in your init and re-use it
    // dispatch_queue_t coreDataQueue = dispatch_queue_create("com.coredata.queue", DISPATCH_QUEUE_SERIAL);
    dispatch_async(coreDataQueue, ^{
        NSMutableArray *fetchedResults = [NSMutableArray array];
        NSFetchRequest *fetchRequest = [[NSFetchRequest alloc] init];
        NSEntityDescription *entityDescription = [NSEntityDescription
                                                  entityForName:entity inManagedObjectContext:self.managedObjectContext];

        NSSortDescriptor *nameSort = [[NSSortDescriptor alloc] initWithKey:@"name" ascending:YES];
        NSArray *sortDescriptors = [NSArray arrayWithObjects:nameSort, nil];

        [fetchRequest setEntity:entityDescription];
        [fetchRequest setSortDescriptors:sortDescriptors];

        // Check if predicate is set
        if (predicate != nil) {
            [fetchRequest setPredicate:predicate];
        }

        NSError *error = nil;
        NSArray *fetchedManagedObjects = [self.managedObjectContext executeFetchRequest:fetchRequest error:&error];

        for (City *city in fetchedManagedObjects) {
            [fetchedResults addObject:city];
        }

        if(completionHandler != nil) completionHandler(fetchedResults);
    });
} 
```

其次，您将核心数据对象从一个线程传递到另一个线程。Core Data 不是线程安全的，这样做几乎肯定会导致看似随机且很难重现的崩溃——我已经看到了。在后台线程的某个地方，无论是在块内部`fetchResultsFromCoreDataEntity:usingPredicate:completionHandler:`还是在`completionHandler`块中，您都应该将您需要的字段从核心数据对象映射到普通值对象，然后将它们传递给主线程。像这样的东西：

```
NSMutableArray *cities = [NSMutableArray array];
for (City *city in fetchedResults) {
    CityFields *cityFields = [[CityFields alloc] init];
    cityFields.name = city.name;
    cityFields.population = city.population;
    [cities addObject:cityFields];
}

dispatch_async(dispatch_get_main_queue(), ^{
    self.filteredLocationsArray = cities;
    [self.tableView reloadData];
}); 
```

# c++ - Problems with large QImage

> ID：13574670
> 
> 赞同：5
> 
> 时间：2012-11-26T23:02:31.940
> 
> 标签：c++, qt, qgraphicsscene, qimage, qpixmap

I'm pretty new to C++/Qt and I'm trying to create an application with Visual Studio C++ and Qt (4.8.3). The application displays images using a QGraphicsView, I need to change the images at pixel level.

The basic code is (simplified):

```
QImage* img = new QImage(img_width,img_height,QImage::Format_RGB32);
while(do_some_stuff) {
  img->setPixel(x,y,color);
}
QGraphicsPixmapItem* pm = new QGraphicsPixmapItem(QPixmap::fromImage(*img));
QGraphicsScene* sc = new QGraphicsScene;
sc->setSceneRect(0,0,img->width(),img->height());
sc->addItem(pm);
ui.graphicsView->setScene(sc); 
```

This works well for images up to around 12000x6000 pixel. The weird thing happens beyond this size. When I set `img_width=16000` and `img_height=8000`, for example, the line `img = new QImage(...)` returns a null image. The image data should be around 512,000,000 bytes, so it shouldn't be too large, even on a 32 bit system. Also, my machine (Win 7 64bit, 8 GB RAM) should be capable of holding the data.

I've also tried this version:

```
uchar* imgbuf = (uchar*) malloc(img_width*img_height*4);
QImage* img = new QImage(imgbuf,img_width,img_height,QImage::Format_RGB32); 
```

At first, this works. The img pointer is valid and calling `img->width()` for example returns the correct image width (instead of 0, in case the image pointer is null). But as soon as I call `img->setPixel()`, the pointer becomes null and `img->width()` returns 0.

So what am I doing wrong? Or is there a better way of modifying large images on pixel level?

Regards, David

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:38:05.827

QImage supports a maximum of 32768x32768 px images (signed short). This follows from the condition: width * height * colordepth < INT_MAX (4 billion) -> 32768 * 32768 * 4 = 4 billion. The second condition is of course that malloc is able to allocate the requested memory.

If you really need bigger images you will have to use another wrapper or split into multiple QImage's.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-28T22:38:19.667

我追查了问题。我只是忘记将`/LARGEADDRESSAWARE`标志添加到链接器选项中。

我也非常感谢 Stephen Chu 对 scanLine() 提示的回答。首先它节省了一些内存，其次它真的快了很多。

现在我可以安全地创建高达 32000x16000 像素的图像，这是我想要的目标。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T19:59:21.453

您的第二种方法是正确的方法。您遇到的问题是当您调用 时`setPixel()`，`QImage`会复制您提供的外部缓冲区并用完它的内存。

尝试直接在提供的缓冲区中更改像素值。您可以使用[`scanLine()`](http://qt-project.org/doc/qt-4.8/qimage.html#scanLine)来获取指向行缓冲区的指针。反正我不会使用`setPixel()`，因为它真的很慢。

# sql - Sum of distinc rows after a 1-many table join

> ID：13574674
> 
> 赞同：0
> 
> 时间：2012-11-26T23:02:49.460
> 
> 标签：sql, oracle, join, sum

I have 2 tables that I am joining.

Table 1 has 1-many relationship with table 2\. That is, table 2 can return multiple rows for a single row of table 1\. Because of this, the records of table 1 is duplicated for as many rows as are on table 2.. which is expected.

Now, I have a sum on one of the columns from table 1, but because of the multiple rows that get returned on the join, the sum is obviously multiplying.

Is there a way to get this number back to its original number? I tried dividing by the count of rows from table 2 but this didnt quite give me the expected result. Are there any analytical functions that could do this? I almost want something like "if this row has not yet been counted in the sum, add it to the sum"

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:28:49.603

可能有一种更优化的方式来做到这一点，即使我对我现在为您提供的解决方案不满意，但暂时这对您有用。让其他大师开放:)

```
create table table1(id number,val number);
create table table2(id number,name varchar2(200));

insert into table1 values(1,1);
insert into table1 values(2,2);
insert into table1 values(3,3);

insert into table2 values(1,'gaurav');
insert into table2 values(1,'saurav');
insert into table2 values(1,'paurav');

insert into table2 values(2,'Rohan');
insert into table2 values(2,'Bhasker');
insert into table2 values(2,'Garima');

WITH tab as
(
SELECT id,sum(val) over() sum
FROM(
select DISTINCT t1.id,t1.val
from table1 t1,table2 t2 where t1.id=t2.id
))
SELECT tab.id,t2.id,t2.name,tab.sum
FROM table2 t2,tab
WHERE t2.id=tab.id 
```

**SQLFIDDLE：**[链接](http://sqlfiddle.com/#!4/a8077/40)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:08:44.817

如果没有示例结构/数据所需的结果等，很难确切知道，但这可能是您所追求的：

```
Select
  s.t1Sum,
  t1.*,
  t2.*
From (
    Select
      sum(col1) as t1Sum
    From
      Table1
    ) s
    Cross Join
  Table1 t1
    Inner Join
  Table2 t2
    On t1.Id = t2.FkId 
```

# haiku - 在结构中查找未命名的联合

> ID：13574675
> 
> 赞同：0
> 
> 时间：2012-11-26T23:02:57.283
> 
> 标签：haiku

我必须在 Haiku 开源项目的 pthread.h 中的 struct _pthread_rwlock 中找到一个未命名的联合。我以一些 C++ 知识（过去的继承、多态性和类）开始这项作业，但我发现我学到的东西对我的情况毫无帮助。我打开了头文件和一个名为 pthread_rwlock.cpp 的源文件，并试图寻找未命名的联合，但两个文件中似乎都没有联合。找到问题的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-26T02:00:34.797

在`pthreads.h`中，您要查找的结构名为`pthread_rwlock_t`。如果您向后跟踪包含文件，您将在 中看到以下内容`sys/types.h`：

```
typedef struct  _pthread_rwlock    pthread_rwlock_t;
...
struct _pthread_rwlock {
    __haiku_std_uint32     flags;
    __haiku_std_int32      owner;
    union {
        struct {
            __haiku_std_int32    sem;
        } shared;
        struct {
            __haiku_std_int32    lock_sem;
            __haiku_std_int32    lock_count;
            __haiku_std_int32    reader_count;
            __haiku_std_int32    writer_count;
            void*                waiters[2];
        } local;
    } u;
}; 
```

我假设这里的工会是您要寻找的工会。从我正在查看的版本（d06f5808）开始，工会不再是匿名的。

# python - 如何从 strptime 中仅获取 mm/dd/year

> ID：13574678
> 
> 赞同：3
> 
> 时间：2012-11-26T23:03:36.793
> 
> 标签：python

我正在使用以下代码获取时间，如果我打印此值，我将得到月份、日期、年份以及 H、M、S。我只需要`MM/DD,YEAR`，我如何得到它？

```
 lastTime = datetime.datetime.strptime(timeStr, "%m/%d/%Y %H:%M:%S")
  print lastTime 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T23:07:38.013

以以下格式打印日期时间`MM/DD,YEAR`：

```
print(lastTime.strftime('%m/%d,%Y')) 
```

如果您想要格式中的日期`MM-DD-YEAR`，请使用：

```
print(lastTime.strftime('%m-%d-%Y')) 
```

* * *

还要注意`lastTime`的是 datetime.datetime 对象。可以通过属性访问月、日和年：

```
lastTime.month, lastTime.day, lastTime.year 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:29:58.620

除了@unutbu 提到的内容外，您还可以利用`str.format`它结合了混合“n”匹配`strftime`和日期时间对象的属性访问的能力。

随机示例：

```
>>> '{0:%m%d%Y}-{0.month}'.format(dt)
'11262012-11' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:07:54.253

时间设置为零的日期时间将仅表示日期。

```
lastTime = lastTime.replace(hour=0, minute=0, second=0, microsecond=0) 
```

# sql - 按日期为各种日期选择顶部和底部 3 条记录

> ID：13574680
> 
> 赞同：0
> 
> 时间：2012-11-26T23:03:49.053
> 
> 标签：sql, sql-server, sql-server-2008

我有一个货币汇率表，其格式类似于以下内容：

```
asofdate    currency    spot    fwd1m   fwdyield    rank_
1999-03-26 00:00:00.000 EUR 0.93161900  0.93340000  1.001911725716199433459 1
1999-03-26 00:00:00.000 NOK 7.80300000  7.81630000  1.001704472638728694092 2
1999-03-26 00:00:00.000 CAD 1.51350000  1.51355000  1.000033036009250082590 3
1999-03-26 00:00:00.000 AUD 1.57728700  1.57713800  0.999905533996032427833 4
1999-03-26 00:00:00.000 NZD 1.86828600  1.86748300  0.999570194285029165770 5
1999-03-26 00:00:00.000 GBP 0.61728400  0.61665000  0.998972920082166393426 6
1999-03-26 00:00:00.000 SEK 8.33400000  8.32080000  0.998416126709863210943 7
1999-03-26 00:00:00.000 CHF 1.48480000  1.48007000  0.996814385775862068965 8
1999-03-26 00:00:00.000 JPY 120.09000000    119.60550000    0.995965525855608293779 9
1999-05-26 00:00:00.000 EUR 0.95438100  0.95662000  1.002346023233907632276 1
1999-05-26 00:00:00.000 NOK 7.85100000  7.86505000  1.001789580945102534708 2
1999-05-26 00:00:00.000 AUD 1.54154500  1.54147300  0.999953293611279592875 3
1999-05-26 00:00:00.000 CAD 1.47330000  1.47307000  0.999843887870766306930 4 
```

从这个表中，我想保留每个日期的排名（基于 fwdyield 字段）的 TOP 和 BOTTOM 3 记录。

输出看起来像这样，但会包括初始表中存在的每个日期：

```
asofdate    currency    spot    fwd1m   fwdyield    pos
1999-03-26 00:00:00.000 JPY 120.09000000    119.60550000    0.995965525855608293779 -1
1999-03-26 00:00:00.000 CHF 1.48480000  1.48007000  0.996814385775862068965 -1
1999-03-26 00:00:00.000 SEK 8.33400000  8.32080000  0.998416126709863210943 -1
1999-03-26 00:00:00.000 CAD 1.51350000  1.51355000  1.000033036009250082590 1
1999-03-26 00:00:00.000 NOK 7.80300000  7.81630000  1.001704472638728694092 1
1999-03-26 00:00:00.000 EUR 0.93161900  0.93340000  1.001911725716199433459 1 
```

挑战在于为每个日期执行此操作，以避免需要使用循环/光标。想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:33:10.120

这可以通过使用一些 OLAP 函数来完成：

```
SELECT * -- only for the example, because I don't know what you need
FROM (SELECT a.*, ROW_NUMBER() OVER(PARTITION BY CAST(asOfDate as DATE) 
                                    ORDER BY fwdyield ASC) as ascRank,
                  ROW_NUMBER() OVER(PARTITION BY CAST(asOfDate as DATE) 
                                    ORDER BY fwdyield DESC) as descRank
      FROM Exchange a) b
WHERE ascRank < 4
      OR descRank < 4 
```

从您的样本数据中产生以下结果：

```
ASOFDATE    CURRENCY    SPOT    FWD1M   FWDYIELD    RANK    ASCRANK DESCRANK
March, 26 1999 00:00:00+0000    EUR 0.931618988514  0.9333999753    1.001911759377  1   9   1
March, 26 1999 00:00:00+0000    NOK 7.802999973297  7.816299915314  1.001704454422  2   8   2
March, 26 1999 00:00:00+0000    CAD 1.513499975204  1.513550043106  1.000033020973  3   7   3
March, 26 1999 00:00:00+0000    SEK 8.333999633789  8.320799827576  0.998416125774  7   3   7
March, 26 1999 00:00:00+0000    CHF 1.484799981117  1.480069994926  0.996814370155  8   2   8
March, 26 1999 00:00:00+0000    JPY 120.089996337891    119.605499267578    0.995965540409  9   1   9
May, 26 1999 00:00:00+0000  EUR 0.954380989075  0.956619977951  1.002346038818  1   4   1
May, 26 1999 00:00:00+0000  NOK 7.850999832153  7.86504983902   1.001789569855  2   3   2
May, 26 1999 00:00:00+0000  AUD 1.541545033455  1.541473031044  0.999953269958  3   2   3
May, 26 1999 00:00:00+0000  CAD 1.473299980164  1.473070025444  0.999843895435  4   1   4 
```

（工作[SQL Fiddle 示例](http://www.sqlfiddle.com/#!3/174bd/4)）

但是，这里有几个问题：

*   因为`asOfDate`是时间戳（SQL Server`DATETIME`或`DATETIME2`），所以需要进行转换/转换。这意味着它（可能）将无法使用索引。我假设这应该是“工作日”（或类似的），因此将其转换为`DATE`类型应该没问题（出于“域”的原因，也许无论如何都应该这样做）。
*   您的列名有点神秘......`fwd...`代表什么？

（作为旁注，我注意到原始`rank`列匹配`descRank`- 如果这已经存储，您显然可以删除该特定计算列。）

# c++ - C++：控制台窗口有奇怪的边框..？

> ID：13574686
> 
> 赞同：4
> 
> 时间：2012-11-26T23:04:13.280
> 
> 标签：c++, c, windows, debugging, winapi

我创建了一个程序，其中包括更改控制台窗口大小并从中删除窗口边框（主要是通过将窗口样式设置为 WS_POPUP）。
现在在*我的*计算机上，应用程序执行没有任何问题，但是当我在另一台计算机（或 VirtualBox）中运行代码时，我遇到了一些时髦的故障。

这是一张图片，显示了我所说的这些故障： ![具有令人敬畏的景深的故障](../Images/81e83ae6e19f873f6d45cf60561e9dd1.png)

如果用户在控制台窗口顶部移动/打开一个窗口，然后将控制台窗口再次带到顶部，这些故障就会出现。
所以很自然地，我认为摆脱这个问题的最简单方法是让控制台窗口*始终位于顶部*，但这并没有帮助，因为现在这些故障只是从新出现的任何东西中获取它们*的“背景”*窗口在控制台窗口的顶部*（或更确切地说，在下面）移动/打开。*
似乎故障区域以某种方式缓存/存储在某处，并且没有注意到窗口已调整大小。

```
GetClientRect(hWnd, &rClnt);
rClnt.top += 1;
rClnt.bottom -= 2;
rClnt.right -= 1;
SetWindowRgn(hWnd, CreateRectRgnIndirect(&rClnt), 1);
SetWindowLongPtr(hWnd, GWL_STYLE, WS_POPUP);
exStyle = GetWindowLongPtr(hWnd, GWL_EXSTYLE);
exStyle &= ~WS_EX_CLIENTEDGE;
SetWindowLongPtr(hWnd, GWL_EXSTYLE, exStyle);
BringWindowToTop(hWnd);
SetWindowPos(hWnd, HWND_TOPMOST, ((rScr.right / 2) - rWnd.right / 2) - 1, (rScr.bottom / 2) - rWnd.bottom / 2, 0, 0, SWP_FRAMECHANGED | SWP_DRAWFRAME | SWP_NOSIZE);// After this I just use ShowWindow(). 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:03:28.713

我设法修复了这些故障。

我所做的`SetWindowRgn()`只是将函数移到了`ShowWindow()`（位于代码片段的最后）的上方。
这消除了故障区域，现在我的窗口可以正确显示。

之后出现窗口不居中的错误，但我通过更改修复了它

```
if(!SetWindowPos(hWnd, HWND_TOPMOST, ((rScr.right / 2) - rWnd.right / 2) - 1, (rScr.bottom / 2) - rWnd.bottom / 2, 0, 0, SWP_FRAMECHANGED | SWP_DRAWFRAME | SWP_NOSIZE)) 
```

到

```
if(!SetWindowPos(hWnd, HWND_TOPMOST, ((rScr.right / 2) - rClnt.right / 2) - 1, (rScr.bottom / 2) - rClnt.bottom / 2, 0, 0, SWP_FRAMECHANGED | SWP_DRAWFRAME | SWP_NOSIZE)) 
```

# java - ec2 API 如何决定哪个可用区？

> ID：13574689
> 
> 赞同：3
> 
> 时间：2012-11-26T23:04:23.810
> 
> 标签：java, amazon-ec2, amazon-web-services

我正在编写一个以编程方式按需启动 EC2 实例的服务。我想给它一个能够随时启动实例的最佳机会，最大限度地减少由于容量不足而导致的失败。实例在一个区域内运行在哪个可用区无关紧要，我最有可能启动一个。

我想知道，如果我在使用api的runInstances方法时不指定放置对象，会不会：

A) 在具有可用容量的任何可用区中运行我的新实例

B）随机选择一个可用区，如果那里没有任何备用容量，则失败

C) 别的东西

我的研究表明人们认为它是 A) 或 B)，但我无法从 aws 中找到明确的答案。

如果是 A) 我想我可以打一个电话并将其留给 aws 以确定我是否可以拥有该实例。如果是 B) 我想我应该通过可用区并继续尝试所有这些，直到找到一个有空闲容量的。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T14:20:57.707

看起来[在特定可用区中启动实例](http://docs.amazonwebservices.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html#using-regions-availability-zones-launching)提供了一个答案：

> 启动实例时，您可以选择指定可用区。如果您未指定可用区，Amazon EC2 会在您使用的区域中为您选择一个。在启动您的初始实例时，我们建议接受默认可用区，这使我们能够根据系统运行状况和可用容量为您选择最佳可用区。[...]

尽管语言不是 100% 准确，但我认为我的选项 A) 是正确的并且没有指定可用区意味着 Amazon EC2 将尽力找到具有可用容量的区域，尽管可能首先应用一些其他标准。

# jquery - jQuery Validate Plugin：如何验证下拉列表

> ID：13574690
> 
> 赞同：4
> 
> 时间：2012-11-26T23:04:26.907
> 
> 标签：jquery, html, jquery-validate

我正在尝试使用 jQuery Validate 插件来验证下拉列表。它正确验证了我的表单的其余部分。但它不适用于下拉菜单。

这是我的 jQuery：

```
$('#campaignForm').validate({
    rules: {
         campaign_name: {
             required: true
         },
         html_url: {
             required: {
                 depends: function(element) {
                     return $('#html_url').val() == 'none';
                 }
              }
         }
    },
    messages: {
        campaign_name: 'Please enter a campaign name',
        html_url: 'Please select a template'
    }
}); 
```

这是我的 HTML：

```
<select name="html_url" id="html_url">
<option value="none">Select One...</option>
...
</select> 
```

我究竟做错了什么？我的变量名是否以某种方式发生冲突。广告系列名称的规则工作正常。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T00:30:31.180

如果您只想制作一个`select`元素`required`，则不会使用`depends:`，因为它不“依赖”*另一个元素*。在您的使用中，该`depends`属性只是切换`required`规则。这里的问题不是`required`规则......它不需要切换。问题是当所有选项都已经包含 a 时，该`required`规则将不起作用`value`，因为`required`将始终满足。

只需使用`value=""`默认选项，然后像任何其他元素一样设置规则。

```
<option value="">Select One...</option> 
```

[**jsFiddle 演示**](http://jsfiddle.net/bgwmN/1/)

**HTML：**

```
<form id="campaignForm">   
    <select name="html_url" id="html_url">  
        <option value="">Select One...</option>
        <option value="one">ONE</option>
        <option value="two">TWO</option>
    </select>
    <input type="submit" />
</form>​ 
```

**jQuery：**

```
$(document).ready(function() {
    $('#campaignForm').validate({
        rules: {
            html_url: {
                required: true
            }
        },
        messages: {
            html_url: {
                required: 'Please select a template'
            }
        }
    });
});​ 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2014-11-08T08:21:05.740

如果由于某种原因您不能像 Spark 所说的那样将值设置为空白，您可以添加自己的 JQuery 验证函数而不是默认的必需预设。

```
$.validator.addMethod("aFunction",
    function(value, element) {
        if (value == "none")
            return false;
        else
            return true;
    },
    "Please select a value");

$('#campaignForm').validate({
    rules: {
         campaign_name: {
             required: true
         },
         html_url: {
             aFunction: true
         }
    },
    messages: {
        campaign_name: 'Please enter a campaign name',
        html_url: 'Please select a template'
    }
}); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-08-27T12:05:58.200

```
$('#campaignForm').validate({
    rules: {
        html_url: {
            min: 1,
        }
    },
    messages: {
        html_url: 'Please select a template',
    }
}); 
```

# c# - 将文本文件中的数据添加到列表框

> ID：13574692
> 
> 赞同：-1
> 
> 时间：2012-11-26T23:04:37.180
> 
> 标签：c#, file, streamreader

我在从文本文件（记事本 txt 文件）加载数据并将其显示在列表框中时遇到问题。以下是我的代码，不知道为什么它不加载数据

```
private void loadData() {
        try {
            using (StreamReader reader = new StreamReader("visits.txt"))     //Reads in file
            {
                string line;
                while ((line = reader.ReadLine()) != null) {
                    string[] data = line.Split(',');               //Splits the lines up when there is a ,
                    lstDeliveries.Items.Add(data[0] + ", " + data[1] + ", " + data[2]);
                    lstPickups.Items.Add(data[3] + ", " + data[4]);                                              
                }
            }
        }
        catch (FileNotFoundException) {
            MessageBox.Show("The file was not found!!");      //Provides error if file not found
            Environment.Exit(0);                        //Closes application 
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:12:33.970

你没有提供你有什么样的问题。我假设您文件中的某些行具有意外的格式。添加条件以验证数据数组至少有 5 项：

```
string[] data = line.Split(',');
if (data.Length >= 5)
{             
   lstDeliveries.Items.Add(String.Format("{0}, {1}, {2}", data[0], data[1], data[2]);
   lstPickups.Items.Add(String.Format("{0}, {1}", data[3], data[4]); 
} 
```

也是`String.Format`格式化字符串的更好选择。

# delphi - 锁定列表上的 TThreadList 访问冲突

> ID：13574694
> 
> 赞同：0
> 
> 时间：2012-11-26T23:04:49.017
> 
> 标签：delphi, delphi-xe3

```
var   all: TThreadList = nil;

procedure TForm1.IdTCPServer1Connect(AContext: TIdContext);
var  list:tlist;
begin
  try
  list := all.LockList;
  try
    list.Add(0);
  finally
    all.UnlockList;
  end;
  except

  end;
end; 
```

远程登录 127.0.0.1 1234

为什么会出现访问冲突？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T23:08:36.230

我希望您只是忘记创建`TThreadList`. 你需要

```
all := TThreadList.Create; 
```

某处。例如，在该`initialization`单元的部分。

# c++ - C 到 C++：将结构转换为类

> ID：13574696
> 
> 赞同：-1
> 
> 时间：2012-11-26T23:05:24.207
> 
> 标签：c++, c, class, struct

所以，这可能有点大，而且可能是混乱和不正确的（它真的是初学者）。我只是在学习 C，而我需要做的部分工作涉及将这个程序转换为 C++ 程序。我需要做的主要事情是用类替换所有结构，并让代码中使用的所有函数都是类函数（成员？如果我记得......）

我对很多基础知识都有很好的掌握，但这个概念只是“修改”代码。我看不到如何通过切换到课程来“修改”我以前的工作。照原样，我觉得该程序几乎需要重新编写才能使用类。也许我错过了这里的简单性。我不希望有人为我做这项工作，我只想知道是否有一种简单的方法可以将我的结构格式化为类。

```
#include <stdio.h>
#include <conio.h>
#include <stdlib.h>
#include <string.h> 

//Struct for friend array pointers.
typedef struct friendstruct{
        char *firstname;
        char *lastname;
        char *homephone;
        char *cellphone;
} frnd;
//Buffer for use in storing in the main program.
typedef struct bufferstruct{
        char firstname[20];
        char lastname[20];
        char homephone[20];
        char cellphone[20];
} frndbuff;
//Add friend function.
void addfriend(frnd friendarray[], frndbuff newfrnd, int count, int opened){
     friendarray[count].firstname = malloc(sizeof(newfrnd.firstname));  //Assign memory before copying string.
     friendarray[count].lastname = malloc(sizeof(newfrnd.lastname));
     friendarray[count].homephone = malloc(sizeof(newfrnd.homephone));
     friendarray[count].cellphone = malloc(sizeof(newfrnd.cellphone));
     strcpy(friendarray[count].firstname, newfrnd.firstname);
     //printf("%s", friendarray[count].firstname);
     //printf("%s", newfrnd.firstname);
     strcpy(friendarray[count].lastname, newfrnd.lastname);
     strcpy(friendarray[count].homephone, newfrnd.homephone);
     strcpy(friendarray[count].cellphone, newfrnd.cellphone);
     //friendarray[count].lastname = newfrnd.lastname;
     //friendarray[count].homephone = newfrnd.homephone;
     //friendarray[count].cellphone = newfrnd.cellphone;

     if(opened==0){
     printf("\nA new friend has been added to the phonebook.");
     }
}
//Deleteing friends.
int deletefriend(frnd friendarray[], frndbuff newfrnd, int count){
     int n = 0;
     int success = 0;
     while(n<count){
           if(strcmp(newfrnd.lastname,friendarray[n].lastname)==0){ //Comparing strings.
                 while(n<count-1){
                                 strcpy(friendarray[n].firstname, friendarray[n+1].firstname);
                                 strcpy(friendarray[n].lastname, friendarray[n+1].lastname);
                                 strcpy(friendarray[n].homephone, friendarray[n+1].homephone);//Removes previously used position.
                                 strcpy(friendarray[n].cellphone, friendarray[n+1].cellphone);
                                 //friendarray[n].lastname = friendarray[n+1].lastname;
                                 //friendarray[n].homephone = friendarray[n+1].homephone;
                                 //friendarray[n].cellphone = friendarray[n+1].cellphone;
                                 n++;
                 }
           success = 1;
           count = count - 1;
           break;
           }
           n++;
     }      
           if(success==1){
           printf("\nThe entry for %s has been removed from the phonebook.", newfrnd.lastname);
           }else{
           printf("\nThat entry was not found");
           }
           //printf("%i", count);
return count;
}
//Show friend by last namme. Identical to delete friend, without removal.
void showfriend(frnd friendarray[], frndbuff newfrnd, int count){
     int n = 0;
     int success = 0;
     while(n<count){
           if(strcmp(newfrnd.lastname, friendarray[n].lastname)==0){
           printf("\n\n%s %s %s (home) %s (cell)\n", friendarray[n].firstname, friendarray[n].lastname, friendarray[n].homephone, friendarray[n].cellphone);                      
           success = 1;
           break;
           }
     n++;
     }

           if(success==0){
           printf("\nThat entry was not found");
           }
}
//DIsplays entire phonebook.
void phonebook(frnd friendarray[], int count){
     int n = 0;
     //printf("%i", count); Used in debugging.
     while(n<count){
     printf("\n%s %s %s (home) %s (cell)\n", friendarray[n].firstname, friendarray[n].lastname, friendarray[n].homephone, friendarray[n].cellphone);
     n++;
     }
}
//Find friend based on last name.
void searchfriend(frnd friendarray[], frndbuff newfrnd, int count){
     int n = 0;
     int success = 0;
     while(n<count){
           if(strcmp(newfrnd.lastname, friendarray[n].lastname)==0){
           printf("\n\n%s %s %s (home) %s (cell)\n", friendarray[n].firstname, friendarray[n].lastname, friendarray[n].homephone, friendarray[n].cellphone); 
           success = 1;                     
           }
     n++;
     }

           if(success==0){
           printf("\nThat entry was not found");
           }
}                        

int main(){
    int option, option2;
    frndbuff currentfriend;
    frnd friendarray[50];
    int count = 0;
    int filecount = 0;
    int opened = 0;
    //Phonebook load previous to main loop.
    printf("\nDo you have a previously saved phonebook you'd like to load?\n1) Yes\n2) No\n");
    printf("\nChoose an option : ");
    scanf("%i", &option2);
        if(option2==1){

                  FILE *fileopen;
                  fileopen = fopen("phonebook.dat", "r"); //File open for reading.
                  if (fileopen != NULL){
                               filecount = 0;
                               opened = 1;
                               printf("\nYour previous phonebook has been loaded : ");
                               while(fscanf(fileopen, "%s %s %s (home) %s (work)\n",&currentfriend.firstname, &currentfriend.lastname, &currentfriend.homephone, &currentfriend.cellphone)==4){
                                                      printf("\n%s %s %s (home) %s (work)\n",currentfriend.firstname, currentfriend.lastname, currentfriend.homephone, currentfriend.cellphone);
                                                      addfriend(friendarray, currentfriend, filecount, opened);
                                                      filecount++;
                               }
                               count = filecount;
                  }else if(fileopen == NULL){
                               printf("\nA previous phonebook could not be found.");
                  }
    }

while(1==1){

    opened = 0;                
    printf("\n\nPhone Book Application\n1) Add Friend\n2) Delete Friend\n3) Show a Friend\n4) Show phone book\n5) Search by last name\n6) Quit\n");    
    printf("\n\nWhat option would you like to choose : ");
    scanf("%i", &option);  
    //Option ensuring.
    if(option<1 || option>6){
                printf("\nYou did not enter a valid option, please try again.");
                option = 6;
    }

    if(option==1){
                  printf("\nFirst Name : ");
                  scanf("%s", &currentfriend.firstname);
                  printf("\nLast Name : ");
                  scanf("%s", &currentfriend.lastname);
                  printf("\nHome Phone : ");
                  scanf("%s", &currentfriend.homephone);
                  printf("\nCell Phone : ");
                  scanf("%s", &currentfriend.cellphone);
                  //printf("%s", currentfriend.firstname); Debugging.
                  addfriend(friendarray, currentfriend, count, opened);

                  count++;
                  //printf("%i", count); Debugging.
                  //All options call the previously made functions and pass the buffer.
    }else if(option==2){
                  printf("\nEnter the last name of the friend you'd like to delete : ");
                  scanf("%s", &currentfriend.lastname);
                  count = deletefriend(friendarray, currentfriend, count);
    }else if(option==3){
                  printf("\nEnter the last name of the friend you'd like to view : ");
                  scanf("%s", &currentfriend.lastname);
                  showfriend(friendarray, currentfriend, count);
    }else if(option==4){
                  phonebook(friendarray, count);
    }else if(option==5){
                  printf("\nEnter the last name you'd like to search : ");
                  scanf("%s", &currentfriend.lastname);
                  searchfriend(friendarray, currentfriend, count);
    }else if(option==6){
                  option2 = 0;
                  printf("\nWould you like to save your phonebook to a file?\n1) Yes\n2) No");
                  printf("\n Choose an option : ");
                  scanf("%i", &option2);
                  if(option2==1){
                                 filecount = 0;
                                 FILE *filesave;
                                 filesave = fopen("phonebook.dat", "w"); //File open for writing.
                                 while(filecount<count){
                                 //File written in the same method it is read.
                                 fprintf(filesave, "%s %s %s (home) %s (work)\n",friendarray[filecount].firstname, friendarray[filecount].lastname, friendarray[filecount].homephone, friendarray[filecount].cellphone);
                                 filecount++;
                                 }
                  }
                  printf("\nThank you for using this Phone Book Application!");
                  break;
    }
}
//Files closed.
fclose(fileopen);
fclose(filesave);
getch();
return 0;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:12:55.313

与 C++ 的主要区别是使用**`std::string`**而不是原始字符数组。然后你不使用`malloc`and `free`。您只需`std::string`负责内存管理即可。

同样，您将使用 a**`std::vector`**来存储朋友。

您还可以将 i/o 替换为 C++ iostreams i/o，这样更简单、更安全。

Bjarne Stroustrup 写了一篇介绍性的小文章，展示**[了如何将一个小 C 程序转换为 C++](http://www.stroustrup.com/new_learning.pdf)**（“学习标准 C++ 作为一种新语言”，C/C++ 用户杂志第 43-54 页，1999 年 5 月）。

你只需要“忘记”一些 C 的做事方式，并采用更多的 C++ 方式。:-)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T23:17:35.393

首先，在 C++ 中，结构和类之间几乎没有区别。

类是一种结构，其中字段/方法默认为私有。

```
struct Foo {
    //Content here
}; 
```

是相同的

```
class Foo {
public:
    //Content here
}; 
```

但是，当然，这并不是使用 C++ 类的所有“好东西”。

1.  替换`typedef struct X { ... } Y;`为`struct X { ... }`或`struct Y { ... };`。在 C++ 中使用 typedef 没有多大意义。

2.  如果您的意思不是“将代码转换为类”而是“使用标准 C++ 类而不是 C 功能” ，则替换`char name[N]`为'不知道什么是引用传递——学习它，这是一个重要的概念）。`std::string name;``Type[]``std::vector<Type>`

3.  如果你使用 C++ 标准字符串，那么//`malloc`就不再需要了。而不是仅仅使用`free``strcpy``strcpy(a, b);``a = b;`

如果您正确地遵循这些提示，我相信您的代码将大大简化。然后，您会发现您的某些功能变得不必要了。例如，`addfriend`可能会被`vector.push_back`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:03:37.333

*   在现有答案中强烈推荐 切换到`std::string`and 。`std::vector<>`
    *   `std::string`具有值语义，这意味着您可以简单地用于`==`比较字符串并`=`分配给字符串。
*   您将不需要friend-buff 类或结构......只需在任何地方使用friend 类。
*   您可能希望向其添加一个构造函数，以便您可以使用简单地创建一个实例`Friend(firstname, lastname, homephone, cellphone)`，而无需每次都显式分配给这些成员中的每一个（提示 - 使用“初始化列表”）。
    *   因为`std::string`具有值语义（与类似指针不同），所以您不需要创建复制构造函数或析构函数来复制或清理字符串使用的内存......一切都会正常工作。
*   您可以使用标准算法来执行诸如从`vector`...中删除元素之类的操作，所有这些都可以轻松通过 Google 搜索或在 stackoverflow 上找到。
*   iostreams 意味着您可以在不指定变量类型的情况下编写代码来输出变量（就像您必须使用 printf() 一样） - 编译器会自动找到适当的代码。你需要`#include <iostream>`然后`std::cout << variable << "string literals\n";`等等。
    *   即使您不等待输入，您也不需要使用`std::endl`或除非您希望立即出现输出 -尽管许多 C++ 书籍/教程等显示，但这通常是正确的选择。`std::flush``\n``endl`

# javascript - AJAX 将元素放在列表顶部

> ID：13574700
> 
> 赞同：0
> 
> 时间：2012-11-26T23:05:43.043
> 
> 标签：javascript, html, jquery

我有一个使用 ajax 生成的列表，我希望每次元素出现时它们都位于列表的顶部：

我的代码是：

```
 $(document).ready(function() {
      var socket = io.connect('http://0.0.0.0:3000');
      var out = "";
      socket.on('populate', function(data) {
        $.each(data, function(i, obj) {
    if(obj['Ping'] == "FALSE"){
          out += "<li class='red'><font color='red'>"+obj.Vardas+" is down..."+obj.Data+"</font></li>";
      }
    else{
          out += "<li class='green'><font color='green'>"+obj.Vardas+" is up......."+obj.Data+"</font></li>";   
      }
        });
    $("#database > li:first-child").before(out);//.load(blinkColorRed());
      });
    });
    </script>
  </head>
  <body>
  <div style="float:right; overflow-y:scroll; height: 400px; width: 30%">
    <ul id ='database'></ul>
  </div>
  </body>
</html> 
```

数据来了，scoolbox 生成了，但没有列表元素。如果我删除 "> li:first-child" 列表有效，但最新的元素会像简单的 html('out') before(out) 一样位于底部。我犯了错误的任何想法？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:15:43.693

它不起作用的原因`> li:first-child`是它`ul`最初是空的，所以没有元素可以匹配`#database > li:first-child`选择器，所以你试图把元素放在前面。你可以使用[`.prepend()`](http://api.jquery.com/prepend/)

```
$("#database").prepend(out); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:08:44.543

```
$('#database').prepend(out);  // Prepend to <ul id="database"> 
```

[这是一个简单的例子](http://jsfiddle.net/CGgLV/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T01:26:41.240

我确实找到了答案。问题是我正在修改一个字符串，所以每次数据到达时，它都会被添加到现有字符串并推送到 HTML 列表。

现在我创建只有一个列表值的短字符串，它会尽快弹出。之后，将字符串值设置为零。代码如下所示：

```
 $(document).ready(function() {
      var socket = io.connect('http://0.0.0.0:3000');
      var out = "";
      socket.on('populate', function(data) {
        $.each(data, function(i, obj) {
    if(obj['Ping'] == "FALSE"){
          out = "<li class='red'><font color='red'>"+obj.Vardas+" is down..."+obj.Data+"</font></li>";
      $(out).prependTo('#database');
      out ="";
      }
    else{
          out = "<li class='green'><font color='green'>"+obj.Vardas+" is up......."+obj.Data+"</font></li>";
      $(out).prependTo('#database');
      out ="";  
      }
        });
    //$(out).prependTo('#database');//.load(blinkColorRed());
      });
    });
    </script>
  </head>
  <body>
  <div style="float:right; overflow-y:scroll; height: 400px; width: 30%">
    <ul id ='database'></ul>
  </div>
  </body>
</html> 
```

# entity-framework - 使用 linq 表达式而不是字符串作为键名的一对一数据库表映射

> ID：13574705
> 
> 赞同：2
> 
> 时间：2012-11-26T23:06:10.703
> 
> 标签：entity-framework, ef-code-first

首先在实体框架代码中，当我想为普通的一对多外键创建映射时，我使用

```
HasRequired(a=>a.County)
  .WithMay(b=>b.Cities)
  .HasForeignKey(a=>a.CountCode); 
```

现在，当我尝试创建一个一对一的映射时，它会变成这样：

```
HasRequired(a=>a.County)
  .WithOptional(b=>b.ConnectedCounty)
  .Map(a=>a.MapKey("CountyCode")); 
```

为什么我必须在这个表达式中使用像*CountyCode这样的字符串？*有没有办法创建没有字符串的映射，只有 linq 表达式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T10:39:37.500

原因是在定义一对一关系时不应该使用它，因为通过使用它，您将回到在数据库中定义一对多关系。只有当依赖实体中的 FK 也是它的 PK 时，EF 才使用真正的一对一关系。这是您可以确定主体实体永远不会被多个依赖实体引用的唯一情况（因为 EF 不支持数据库唯一键）。

如果您使用您的代码，您将定义单独的 FK，它会“工作”，但不会在数据库中的列上自动创建唯一键。

# sql - 如何在 LinkedServer 中查询 #TempTable

> ID：13574710
> 
> 赞同：2
> 
> 时间：2012-11-26T23:06:25.683
> 
> 标签：sql

我在远程服务器中创建了一个#TempTable。我使用 sp_addlinkedserver 将远程服务器添加到我的服务器

当我尝试查询#TempTable 时

Select * from RemoteServer..tempdb.dbo.#TempTable 我收到一个错误

数据库名称“tempdb”忽略了 tempdb 中的引用对象

有人可以帮助如何在 LinkedServer 中查询 #TempTable

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:10:01.887

临时表仅对创建它们的会话可用。您不能在会话之间使用#Temp 表。创建一个“真实”表并进行查询。

# c - 使用 scanf 获取小数

> ID：13574711
> 
> 赞同：1
> 
> 时间：2012-11-26T23:06:27.603
> 
> 标签：c, io, c99

在下面，如果我`scanf`用`%d /%d"`（带空格）写，那么我可以输入一个由空格分隔的分数。

**例如：**输入可以是`5/7`或`5 /7`或 `5 / 7`（任何地方都有空格）。

下面代码中的 scanf 如何以这种方式读取数字之间的空格，但它之间只有一个空格`%d /%d"`？

```
#include <stdio.h>

int main()
{
   int i, j;
   scanf("%d /%d", &i, &j);
   return 0;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:20:33.947

几乎所有输入格式说明`scanf`符都会在读取实际数据之前自动跳过所有空格。例如，`%d`格式说明符`scanf`实际上意味着`<skip spaces> <read int>`.

这意味着如果我们使用`%d/%d`格式来读取分数，它将代表

```
<skip spaces> <read int> <require /> <skip spaces> <read int> 
```

在这个序列中，我们拥有一切必要的东西，除了我们不允许/跳过`/`. 为了解决这个问题，我们必须在 之前添加一个跳过空格的显式请求`/`，它在`scanf`格式字符串中由空格字符表示。`/`在生成格式字符串之前添加一个空格字符`%d /%d`，它代表

```
<skip spaces> <read int> <skip spaces> <require /> <skip spaces> <read int> 
```

这正是我们所需要的，这正是您在代码中所拥有的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T23:12:35.843

这里有两件事。

第一个是说明`%d`符将“修剪”导致十进制数的空格，这就是为什么`(space)4`解析与简单`4`（没有前导空格）相同的原因。

第二个是如果您在格式字符串中放置空格，它将“吃掉”任意数量的空格字符（包括零）。

> 空白字符：该函数将读取并忽略在下一个非空白字符之前遇到的任何空白字符（空白字符包括空格、换行符和制表符——参见 isspace）。格式字符串中的单个空格验证从流中提取的任意数量的空格字符（包括无）。

[参考](http://www.cplusplus.com/reference/cstdio/scanf/)

因此，您在格式字符串中的空格`/`将允许您匹配带有分隔空格（例如`4 /x`）和不带空格（例如）的字符串`4/x`。

# jquery - 在没有 document.ready() 的情况下运行 jQuery - 并且崩溃 ie 8

> ID：13574712
> 
> 赞同：0
> 
> 时间：2012-11-26T23:06:39.540
> 
> 标签：jquery, crash

这是发生的事情的一个非常简化的示例

```
jQuery(".resultAction").each(makeItso);

function makeItso() {
    //code executes (it was a conditional to test for a file extension and display apply a class)
    //the short version:
    jQuery(this).find("#indicator").addClass("is" + fileExtension.slice(1));

    //no file extension hide the icon div "indicator"
    if ((fileExtension.indexOf('.') == -1)) {
        jQuery(this).find("#indicator").addClass("not");
    }

} 
```

现在，这运行得很好，并且比 .ready() 运行得更快——因为我每页大约有 100 个结果。

但是有一个错误：在最后一个元素上它没有执行 - 所以，我这样做是为了在页面加载后重新运行最后一个项目上的函数：

```
jQuery(document).ready(function(){
    jQuery(".resultAction:last").each(makeItso);
}); 
```

因此，长话短说，这在 Firefox、IE 7、8、9 中运行良好——尽管这里是有趣的部分：我使用 Mac 和 VMware Fusion 进行了测试，所以我“认为”我没问题，测试人员使用他们的 PC 和 IE 8 --Epic 失败。

我倾向于一些东西：在虚拟机上进行的#1 测试与真正的交易不同。另外我的问题是为什么这会在 IE 8 中崩溃，而在 9 和 Fox 中运行良好？我编码不好？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:14:37.217

看起来你有一个`id="indicator"`里面的元素 every `.resultAction`。每个 ID 在页面上应该是唯一的。一些浏览器可能不关心这个限制。其他人可能。

改变现状，它`id="indicator"`可能`class="indicator"`会有所帮助。

至于你的另一个问题，它没有在最后一行执行，你不需要等待 document.ready 只要你确保脚本在 HTML 中比它正在操作的元素更晚。即把`<script>`标签放在正文之前的最后一件事。如果您这样做但它不起作用，我们肯定需要查看完整的 html。

# opengl - 加载 glNormalPointers 并使用着色器

> ID：13574714
> 
> 赞同：0
> 
> 时间：2012-11-26T23:06:42.127
> 
> 标签：opengl, glsl, shader, vbo

我正在尝试使用我的着色器与 VAO 一起绘制来进行照明。但是，每当我加载 glNormalPointer 时，我的着色器都不会在对象上绘制，并且我在调试时遇到了麻烦。

这是我的代码的一部分：

```
 glEnableClientState(GL_VERTEX_ARRAY);
        glEnableClientState(GL_NORMAL_ARRAY);
        glVertexPointer(3, GL_FLOAT, 0, vertices);
        glNormalPointer(GL_FLOAT, 0, normals);
        glDrawElements(GL_QUADS, 400, GL_UNSIGNED_INT, indices);
        glDisableClientState(GL_VERTEX_ARRAY);
        glDisableClientState(GL_NORMAL_ARRAY); 
```

它绘制正确，但没有正确进行照明。如果我注释掉用于正常工作的三行，那么程序将正确运行，这对我来说没有意义。法线只是表面的法线。它们应该是正确的，因为当我使用 glNormal3f() 和 glVertex3f() 加载它们时，对象呈现如下。着色器文件来自 lighthouse3d 网站，它们已正确渲染。

这是禁用 glNormalPointer() 的情况。

![在此处输入图像描述](../Images/4a8fa12a00e2705626d6292d7fc21c21.png)

这是启用了 glNormalPointer 的情况，因为没有注释掉。

![在此处输入图像描述](../Images/7caebaf5105f37d1120434e96f4fa5e6.png)

有什么我错过的吗？

这是着色器代码：这是我从 lighthouse3d 获得的顶点着色器

```
varying vec4 diffuse,ambientGlobal,ambient;
varying vec3 normal,lightDir,halfVector;
varying float dist;

void main()
{   
vec4 ecPos;
vec3 aux;

/* first transform the normal into eye space and normalize the result */
normal = normalize(gl_NormalMatrix * gl_Normal);

/* now normalize the light's direction. Note that according to the
OpenGL specification, the light is stored in eye space. Also since 
we're talking about a directional light, the position field is actually 
direction */
ecPos = gl_ModelViewMatrix * gl_Vertex;
aux = vec3(gl_LightSource[2].position-ecPos);
lightDir = normalize(aux);

/* compute the distance to the light source to a varying variable*/
dist = length(aux);

/* Normalize the halfVector to pass it to the fragment shader */
halfVector = normalize(gl_LightSource[2].halfVector.xyz);

/* Compute the diffuse, ambient and globalAmbient terms */
diffuse = gl_FrontMaterial.diffuse * gl_LightSource[2].diffuse;
ambient = gl_FrontMaterial.ambient * gl_LightSource[2].ambient;
ambientGlobal = gl_LightModel.ambient * gl_FrontMaterial.ambient;

gl_Position = ftransform();
 } 
```

这是我从 lighthouse3d 获得的片段着色器：

```
varying vec4 diffuse,ambientGlobal, ambient;
varying vec3 normal,lightDir,halfVector;
varying float dist;

void main()
{
vec3 n,halfV,viewV,ldir;
float NdotL,NdotHV;
vec4 color = ambientGlobal;
float att;

/* a fragment shader can't write a verying variable, hence we need
a new variable to store the normalized interpolated normal */
n = normalize(normal);

/* compute the dot product between normal and ldir */
NdotL = max(dot(n,normalize(lightDir)),0.0);

if (NdotL > 0.0) {

    att = 1.0 / (gl_LightSource[2].constantAttenuation +
            gl_LightSource[2].linearAttenuation * dist +
            gl_LightSource[2].quadraticAttenuation * dist * dist);
    color += att * (diffuse * NdotL + ambient);

    halfV = normalize(halfVector);
    NdotHV = max(dot(n,halfV),0.0);
    color += att * gl_FrontMaterial.specular * gl_LightSource[2].specular * pow(NdotHV,gl_FrontMaterial.shininess);
}

gl_FragColor = color; 
```

}

我没有写任何这些，只是想让它们与我的代码一起工作。

# c++ - 有人可以解释这里发生了什么（类和构造函数/析构函数）吗？

> ID：13574716
> 
> 赞同：2
> 
> 时间：2012-11-26T23:07:02.450
> 
> 标签：c++

```
#include <iostream>
#include <string>

using namespace std;

class Person
{
    string name;

    public:
        Person():name("")
        {
            cout << "Person default ctor\n";
        }
        Person(const string& name_in):name(name_in)
        {
            cout << "Person string ctor: " << name << "\n";
        }
        ~Person()
        {
            cout << "Person dtor: " << name << "\n";
        }
        string get_name()
        {
            return name;
        }
};

class Professor:public Person
{
    int office;

    public:
        Professor(const string& name_in, int office_in):Person(name_in), office(office_in)
        {
            cout << "Professor string ctor: " << get_name() << endl;
        }
        ~Professor()
        {
            cout << "Professor dtro: " << get_name() << endl;
        }
};

int main()
{
    Person alice("Alice");
    Professor bob("Bob", 10);

    return 0;
} 
```

我假设输出应该是：

```
Person string ctor: Alice

Person dtor: Alice

Professor string ctor: Bob

Professor dtor: Bob 
```

因为这似乎应该从程序的结构逻辑上遵循。然而，真正的输出是：

```
Person string ctor: Alice

Person string ctor: Bob

Professor string ctor: Bob

Professor dtor: Bob

Person dtor: Bob

Person dtor: Alice 
```

有人可以解释这是为什么吗？我对类/构造函数/析构函数有什么不了解，这让我想出了错误的输出？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T23:10:07.620

首先，`Professor`来源于`Person`。这意味着每个实例都`Professor`隐含地包含一个实例`Person`（观察你是如何`Person(name_in)`在`Professor`的构造函数中调用的）。`Professor`当对象被销毁时，这个隐式实例将自动被销毁。

这解释了为什么您会看到：

```
Person string ctor: Bob
Person dtor: Bob 
```

至于析构函数调用的顺序，变量的销毁顺序与构造的*相反。*这就解释了为什么 Bob 在 Alice 之前就被销毁了：

```
Person string ctor: Alice
Professor string ctor: Bob
Professor dtor: Bob
Person dtor: Alice 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:16:07.413

教授“是”人，所以当你调用教授构造函数时，它的基类的构造函数——即Person——将首先被调用。

类似于破坏者，但顺序相反。子类的析构函数将首先被调用，然后是基类。

此外，仅在对象被销毁时才调用析构函数，在您的情况下，仅在当前范围结束时才会发生。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:11:16.400

因为Professor是继承的，所以在创建时会调用基类构造函数。这就是为什么`person Bob`要打印。

至于反向销毁，这是因为对象的销毁顺序与创建它们的顺序相反。

# iphone - 背景图像颜色未正确显示

> ID：13574718
> 
> 赞同：0
> 
> 时间：2012-11-26T23:07:17.133
> 
> 标签：iphone, ios, cocoa-touch, graphics

我有一个由我的设计师在 Photoshop 中创建的背景图像。我将它转换为 png-24，并有两个文件，一个用于 640 x 920 的视网膜显示，一个用于 320 x 460 的正常显示（我用@2x 正确命名）。当我在 iPhone 4 上实现它时，它不能正确渲染（颜色更深），但是当我把它放在 iPhone5 上时它工作正常。文件大小为 608 KB。

我尝试将文件类型更改为 png8 或 JPEG（质量最低），但仍然没有运气。我已经尝试按照此链接删除颜色配置文件：[Removing Color Profiles in PhotoShop](http://bjango.com/articles/photoshop/)但仍然没有运气。

这是图像的样子：

![在此处输入图像描述](../Images/9efce376300b28b6444fcc19c47cb6e4.png) 任何人都知道可能出了什么问题以及我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:12:50.053

我在博客上看到一个人说 iPhone 5 的色彩饱和度增加了 44%。不知道这是否是您遇到此问题的原因，但从我所读到的内容来看，这会使 iPhone 4 上的图像看起来比预期的要暗淡得多。

资料来源： http: [//prometheus.med.utah.edu/~bwjones/2012/09/iphone-5-display-vs-iphone-4-display/](http://prometheus.med.utah.edu/~bwjones/2012/09/iphone-5-display-vs-iphone-4-display/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T01:19:55.440

作为测试，找到另一个可能颜色的图像并在两个 iphone 示例中对其进行测试： [此图像 + 此处](http://www.ebibleteacher.com/sites/default/files/powerpoint-backgrounds/1/praisepix-grain1.jpg?1310970418)

也许这只是iphone4上亮度或色彩平衡调整的问题。如果是这样，那么在 PhotoShop 中，已经在图像/调整选项卡上选择了图像的图层，您会找到一些可以帮助您的工具，例如添加曝光或亮度。

# c# - lightswitch 存储更新、插入或删除语句影响了意外的行数 (0)

> ID：13574720
> 
> 赞同：0
> 
> 时间：2012-11-26T23:07:24.280
> 
> 标签：c#, silverlight, visual-studio-lightswitch

我有一个灯开关应用程序，其中包含下表结构

项目 (A) ----店铺 (B) --------店铺联系方式 (C)

每个商店都有很多商店联系方式。

当我添加新的商店联系人 (C) 行并尝试将其保存在本地（在我的 PC 上）时，它会被保存，但是当我发布应用程序并尝试添加新的商店联系人 (C) 并保存时，它将给出以下错误：

![在此处输入图像描述](../Images/ccf0345cc5419839c38f9898334e26ea.png)

但是，如果我尝试编辑现有的商店联系人 (C) 并保存更改，它将被保存（本地和服务器上）。

任何解决方案。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:34:06.720

解决了。

其中`Store Contact (C)`包含一个类型（电话、电子邮件等），其中包含一些非英文字母。

我不知道为什么这个问题发生在服务器上而不是我的电脑上。

# python - 从 Python 调用 SHGetStockIconInfo

> ID：13574721
> 
> 赞同：2
> 
> 时间：2012-11-26T23:07:31.517
> 
> 标签：python, winapi, icons

背景：我正在尝试将一些 UAC 盾牌图标添加到基于 wxPython 的 Python 应用程序中的一些菜单选项中。按钮我没有问题，因为我可以将 BCM_SETSHIELD 消息发送到按钮，Windows 会处理其余的。

在此处的链接[MSDN 文章中](http://msdn.microsoft.com/en-us/library/windows/desktop/bb756990.aspx#BKMK_ShieldUI)，它描述了调用 SHGetStockIconInfo 以获取盾牌图标的句柄或位置。我正在尝试使用以下代码通过 Python 调用它：

```
from ctypes import *

class SHSTOCKICONINFO(Structure):
    _fields_ = [('cbSize',c_ulong),
                ('hIcon',c_void_p),
                ('iSysImageIndex',c_int),
                ('iIcon',c_int),
                ('szPath',c_wchar_p)]

_SHGetStockIconInfo = windll.shell32.SHGetStockIconInfo
_SHGetStockIconInfo.argtypes = [c_uint,c_uint,POINTER(SHSTOCKICONINFO)]
_SHGetStockIconInfo.restype = c_int

# Values copied from shellapi.h
SIID_SHIELD = 77

SHGSI_ICONLOCATION = 0
SHGSI_ICON = 0x100
SHGSI_SMALLICON = 0x1
SHGSI_LARGEICON = 0

def GetIconLocation(id,flags=SHGSI_LARGEICON):
    # Clear _ICON bit and set _ICONLOCATION bit
    flags = ~(~flags|SHGSI_ICON)|SHGSI_ICONLOCATION
    info = SHSTOCKICONINFO()
    info.cbSize = sizeof(SHSTOCKICONINFO)
    result = _SHGetStockIconInfo(id,flags,byref(info)):
    if result != 0:
        raise Exception(result)
    return (info.szPath,info.iIcon) 
```

现在，每当我调用它时，我都会从 SHGetStockIconInfo 获得 0x80070057 的返回结果（E_INVALIDARG - 一个或多个参数无效）。

谁能帮忙弄清楚这里出了什么问题？或者也许给我一个更简单的方法来获取这个图标资源？

编辑：问题出在我的 SHSTOCKICONINFO 定义中，见下文。我上面的例子现在可以在下面的更正下正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:20:30.373

结构的最终字段声明不正确。您的代码声明`szPath`为指向空终止数组的指针。但实际上应该是：

```
('szPath', c_wchar*MAX_PATH) 
```

查看该字段的[C++ 声明](http://msdn.microsoft.com/en-gb/library/windows/desktop/bb759805.aspx)：

```
WCHAR szPath[MAX_PATH]; 
```

那是`MAX_PATH`宽字符的内联数组。你可以`MAX_PATH`这样掌握：

```
from ctypes.wintypes import MAX_PATH 
```

# c# - LINQ2SQL 实体框架中不存在支持的 SQL 转换？

> ID：13574725
> 
> 赞同：1
> 
> 时间：2012-11-26T23:07:52.217
> 
> 标签：c#, .net, entity-framework, linq-to-sql

我们在 mvc 项目上使用 LINQ2SQL 已经有一段时间了，而且它的使用时间有点长。

当我们尝试使用类似的东西进行查询时，我们经常面临的问题之一是“不存在支持的 SQL 转换”。

LINQ2SQL 部分类

```
public class User
{
   public bool IsActive
        {
            get
            {
                return (StartDate < DateTime.Now || StartDate == null) && (EndDate > DateTime.Now || EndDate == null);
            }
        }

   public DateTime? StartDate{get;set;}
   public DateTime? EndDate{get;set;}
} 
```

查询类似于

```
Datacontext.Users.Where(u => u.IsActive) 
```

你得到

> **成员 'User.IsActive' 没有支持的 SQL 转换。**

我们正在考虑首先转移到 EF 代码，我很好奇是否存在同样的问题，如果不存在，EF 如何以不同的方式解决它？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:46:18.660

如果您有一个用户 DTO 类（不属于 Linq2sql 实体），那么投影到该类应该没有问题。

```
public class UserDTO
{
   public bool IsActive{get;set;}
   public DateTime? StartDate{get;set;}
   public DateTime? EndDate{get;set;}
} 

public IList<UserDTO> GetActiveUsers()
{
  using(var db = new DbContext())
  {
      var users = GetUsers(db);
      return users.Where(u => u.IsActive).ToList();
  }
}

private IQuerable<UserDTO> GetUsers(DbContext db)
{ 
    return (from u in db.Users
            select new UserDTO()
            {
               StartDate = u.StartDate,
               EndDate   = u.EndDate,
               IsActive  = (u.StartDate < DateTime.Now || u.StartDate == null) && (u.EndDate > DateTime.Now || u.EndDate == null)
            });
} 
```

# asp.net - 左侧的菜单 div

> ID：13574728
> 
> 赞同：-3
> 
> 时间：2012-11-26T23:08:03.833
> 
> 标签：asp.net, html, css

如何添加一个瘦 div 并对其进行自定义以适合左侧以适合菜单？我什至不知道是否需要容器，但这就是我环顾网络所理解的。

我试过这个，但没有运气。

CSS：

```
 #side_container{background:#e0e0e0;}
   #side {float:left; width:180px; padding:10px;} 
```

ASP.NET

```
 <div id="side_container">
    <div id="side"></div>
    </div> 
```

[检查我的小提琴](http://jsfiddle.net/bashar_f/WFKgH/2/ "我的小提琴")

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:12:00.803

您的代码工作正常。你没有看到任何东西的原因是你没有漂浮容器。

尝试也浮动容器并为其分配宽度，如下所示：

```
#side_container { 
    background:#e0e0e0;
    float: left;
    width: 100%;
} 
```

我已将此添加到 jsFiddle 以演示 > [http://jsfiddle.net/KXmAM/](http://jsfiddle.net/KXmAM/)

# mysql - MySQL：如果不存在，最好的插入方式是什么？

> ID：13574732
> 
> 赞同：0
> 
> 时间：2012-11-26T23:08:15.930
> 
> 标签：mysql, insert, conditional, where

我知道有很多关于 INSERT/UPDATE 的线程，但我没有找到解决我的问题的方法。

我有两个表来管理选项：

```
# table 1: option_fields
id | label | type | default

# table 2: option_values
id | field_id | user_id | value 
```

注意： field_id 和 user_id 应该是外键，但它们不是。

如果条目不存在，我想插入 option_values 伪代码：

```
IF (field_id != 1 AND user_id != 2):
    INSERT 
      INTO option_values (field_id, user_id, value) 
    VALUES (1, 2, "text")
ELSE:
    UPDATE option_values
       SET value = "text"
     WHERE field_id = 1 AND user_id = 2
ENDIF; 
```

我知道的方式：

**#1：ON DUPLICATE KEY** 不起作用，因为唯一的主键是“id”

**#2: REPLACE** 我不想使用 REPLACE，因为我认为它是一种肮脏的方式（每次有人更改他的选项时，主键都会被计算在内）。

**#3: MySQL IF, THEN** 使用过多的性能并且看起来也很脏。

你会选择什么样的解决方案，为什么？我猜＃1是最好的，但我无法使用它。

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:13:11.943

虽然`id`是主键（也是唯一的），但您肯定会使用 和 的组合`field_id`作为`user_id`唯一键角色。

这表明，最干净的解决方案是创建一个唯一的密钥`(field_id, user_id)`并继续`ON DUPLICATE KEY UPDATE`

# node.js - 如何在 Express 中解析这个 HTTP POST 请求？

> ID：13574736
> 
> 赞同：3
> 
> 时间：2012-11-26T23:08:36.190
> 
> 标签：node.js, express

我正在使用 expressjs 构建我的第一个 node.js 站点。

其中一部分是处理从[Fitbit](http://fitbit.com)到我网站上的端点的 通知`/api/1/fitbit_update`，例如：

```
POST /api/1/fitbit_update HTTP/1.1
Host: myhost.dk
Content-Type: multipart/form-data; boundary=JGUOAeGT3Fjgjcdk6s35F2mPVVyTdzgR
Content-Length: 374
Connection: keep-alive

--JGUOAeGT3Fjgjcdk6s35F2mPVVyTdzgR
Content-Disposition: form-data; name="updates"; filename="update1353963418000.json"
Content-Type: application/json; charset=UTF-8
Content-Transfer-Encoding: binary

[{"collectionType":"activities","date":"2012-11-26","ownerId":"qw12er23","ownerType":"user","subscriptionId":"112233-activities"}]
--JGUOAeGT3Fjgjcdk6s35F2mPVVyTdzgR-- 
```

我需要解析 HTTP 请求正文中的 json 对象，但 Express 无法帮助我。

任何想法如何获取 JSON 对象？

我看过一些中间件示例，但我不确定如何使用 req.on('someevent') 方法实际获取内容。

`req.body`返回一个空对象 {}

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T19:01:27.047

所以这个请求是一个多部分的文件上传，你感兴趣的文件是一个 JSON 文档。查看[express multipart 示例](https://github.com/visionmedia/express/blob/master/examples/multipart/index.js)。您将需要执行以下操作：

*   阅读连接为您保存的文件`req.files.updates.path`
*   使用将 JSON 数据解析为对象`JSON.parse`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T01:50:34.710

使用 post 方法从表单发送的值：电子邮件和密码

```
app.post('/login', function(req, res){

    /* Get Errors of Validates */
    var errors = [];
    req.onValidationError(function(msg) {
        errors.push(msg);
        //console.log('msg: ' + msg);
        return this;
    });

    /* Validates */
    req.sanitize('email').xss();
    req.sanitize('password').xss();

    req.assert('email', 'Range email').len(6, 40);
    req.assert('password', 'Range password').len(6, 20);

    //*****************************************************
    // Value Send Post "password" --> req.body.password 
    //*****************************************************
    var pass_shasum = crypto.createHash('sha256').update(req.body.password).digest('hex');  

.... 
```

问候。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T01:29:14.573

添加 express.bodyParser()

对于旧版本：

```
app.express.createServer(
  express.cookieParser(), 
  express.bodyParser(), 
  ..... 
); 
```

对于较新版本：

```
server.use(express.bodyParser()); 
```

然后您可以使用 req.body 访问正文

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T23:40:04.053

`req.body`在您的 POST 路由处理程序中尝试。

# spring-security - Spring Security 和 Java EE 6 集成

> ID：13574742
> 
> 赞同：0
> 
> 时间：2012-11-26T23:08:56.790
> 
> 标签：spring-security, java-ee-6

Java EE 6 安全性目前还有很多不足之处（对我来说这只是说），但是我偶然发现 Apache Shiro 和 Spring Security 作为 Java 企业更流行的安全框架。

由于 Apache Shiro 替代品的标签库不存在，我更倾向于选择 Spring Security 方向。

然而令人惊讶的是，我找不到任何详细说明如何将 Spring Security 与 Java EE 6 堆栈集成的教程。你有什么建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-28T09:44:47.663

作为一个变体：[这个过滤器](https://github.com/SpringSource/spring-security/blob/master/web/src/main/java/org/springframework/security/web/servletapi/SecurityContextHolderAwareRequestFilter.java#L30)包装了实现 servlet API 安全方法的请求。因此，应用级框架可以使用标准 API 处理请求安全性。

Weblogic AS 对这种集成有自己的[指导方针](http://docs.oracle.com/cd/E16764_01/web.1111/e14453/security.htm)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-04T18:06:53.537

我决定中途去 Apache Shiro。标签库存在于 www.github.com。并且文档似乎足够合适

# svn - svn 1.7 工作副本格式是否存储了回购的整个历史？

> ID：13574743
> 
> 赞同：2
> 
> 时间：2012-11-26T23:08:57.913
> 
> 标签：svn

我很好奇 Subversion 1.7 中新的工作副本格式（根目录下的单个 .svn 目录）的功能。

它会像 git 一样存储整个回购历史吗？还是原始文件只是服务器当前（未编辑）修订的副本？svn 是否支持完全断开连接的工作 - 在推送到服务器之前在本地多次提交？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T23:12:05.383

Subversion 只维护您当前在本地签出的版本。（关于其他版本的一些元数据可能会根据您的客户端进行缓存，但不会存储其他版本的实际文件内容。）

除了提交到实际的存储库之外，没有其他方法可以提交。只是 git 与 subversion（集中式与分布式）的设计差异。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-26T23:12:59.320

不，.svn 目录保留了您从存储库中签出的原始版本。（即 BASE 修订版）它不会保留所有历史记录。

SVN 不工作断开。您需要与服务器建立连接，除非您当然已经从 URL 中检出您的工作副本`file:///c:/my_dir`——也就是说您正在使用本地存储库。

# objective-c - UIView Modal Popup with Embedded UITableView with UIToolbar, Toolbar 随着表格移动

> ID：13574744
> 
> 赞同：0
> 
> 时间：2012-11-26T23:09:06.867
> 
> 标签：objective-c, ios, xcode, interface-builder, storyboard

这快把我逼疯了！（iOS 5+，ARC）

这里非常简单的概念：我有`UIView`一个嵌入的`UITableView`，当点击一个特定的单元格时，我有一个`modalview`带有 segue 的 iOS 启动。This `modalview`, 是一个`UIView`嵌入`UITableView`的，其中填充了来自数据源的名称。您可以在此视图中选择多个项目（使用`cellaccessory: checkmark)`

**目标** 显示某种“完成”按钮

好的，所以在跑了很多次之后，我明白模态窗口实际上不允许`navigationController`项目。不`toolbars`，`Navigationbars`默认情况下不。好的，所以我会创建我自己的。

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    NSInteger tbHeight = 50;
    UIToolbar *tb = [[UIToolbar alloc] initWithFrame:CGRectMake(0, (self.view.frame.size.height - tbHeight), self.view.frame.size.width, tbHeight)];
    tb.translucent = YES;

    UIBarButtonItem *flexibleSpace = [[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemFlexibleSpace target:nil action:nil];
    UIBarButtonItem *doneButton = [[UIBarButtonItem alloc] initWithTitle:@"Done" style:UIBarButtonItemStyleBordered target:self action:@selector(doneAction:)];

    NSArray *barButton  =   [[NSArray alloc] initWithObjects:flexibleSpace,doneButton,nil];
    [tb setItems:barButton];

    [self.view addSubview:tb];

    barButton = nil;

    //....

} 
```

够简单吧？

嗯，`toolbar`确实出现了，当然。但是，它不会像它应该的那样粘在底部。事实上，当你上下滚动嵌入`tableview`时，`UIToolbar`它会随之而来，就像它卡在`tablevie`不知何故上一样。

我一直在寻找解决方案的时间，我什么都没遇到。想知道这里是否有人有任何想法？

如果您需要更多信息，请务必询问:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T09:38:45.533

奇怪的是，如果它是`UIViewController`子类，您的工具栏会随表格一起滚动，除非您已将 UITableView 分配给 self.view 或其他东西......但既然是这样，这就是我在将固定项目添加到表格视图时所做的事情：

```
-(void) scrollViewDidScroll:(UIScrollView *)scrollView {

    tb.frame = CGRectMake(0, self.view.bounds.size.height-tb.bounds.size.height+scrollView.contentOffset.y, self.view.bounds.size.width, tb.bounds.size.height);

} 
```

# jaxb - 尝试编组缺少 @XmlRootElement 的 JAXB 根 对象时出错

> ID：13574745
> 
> 赞同：9
> 
> 时间：2012-11-26T23:09:07.000
> 
> 标签：jaxb, marshalling

我有一个复杂的 xml 架构，它是国际标准的一部分，因此我无法更改架构文件，并且我使用 Maven 从它们生成 JAXB 对象。当我尝试将数据设置到我的 JAXB 对象中然后编组根元素时，我在几个复杂类型上得到了缺少的 @XmlRootElement 错误。我的问题是如何解决这个问题？环境：

*   JAXB 2.2.2
*   Maven 3.0.3
*   日蚀朱诺
*   Java 1.6
*   视窗 7 64 位

我已经广泛研究了网络和这个网站，但没有找到我的问题的答案，包括这篇文章： [http://weblogs.java.net/blog/kohsuke/archive/2006/03/why_does_jaxb_p.html](http://weblogs.java.net/blog/kohsuke/archive/2006/03/why_does_jaxb_p.html)

还有这个关于堆栈溢出的问题： [JAX-WS MarshalException with custom JAX-B bindings: Unable to marshal type "java.lang.String" as an element because it is missing an @XmlRootElement annotation](https://stackoverflow.com/questions/2626771/jax-ws-marshalexception-with-custom-jax-b-bindings-unable-to-marshal-type-java)

我尝试在自定义绑定文件中向有问题的类添加注释，但是它将注释添加到类以及 getContent() 方法，并且该类无法编译。我认为无论如何我都不应该添加这个注释，因为这是一个复杂的类型，它是根的一个组件，实际上它在树中嵌套得相当深。我已经读到您可以将`<xjc:simple/>`标签添加到全局绑定元素，但是我已经向全局绑定元素添加了许多属性，并且当我这样做时它不会编译。

有人可以在这里帮助我指出正确的方向吗，这可能是我构建 JAXB 对象的方式中的错误吗？我已经在调试器中完成了它，似乎当 com.sun.xml.bind.v2.runtime.property 包中的 ArrayReferenceNodeProperty 类尝试序列化列表主体并且当它获取这些类的 JaxBeanInfo 时，没有t 一个 dom 处理程序集并且 jaxbType 不是一个对象，因此它认为它需要是一个根。

我没有在基于 Web 的服务中使用它，除了绑定文件中用于解决命名冲突的调整之外，还没有创建任何自定义类或绑定。

这是顶级架构文件：

```
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" elementFormDefault="qualified" attributeFormDefault="qualified">
<xs:annotation>
    <xs:documentation>
        *****************************************************************************
        *                                                                           *
        *                        S1000D Issue 3                                     *
        *                          XML Schema                                       *
        *                                                                           *
        *                     Release Version 3.0                                   *
        *                       Date: 2007-07-31                                    *
        *                                                                           *
        *                                                                           *
        * The following attribute definition on the root element may be used to     *
        * call this set of declarations:-                                           *
        *                                                                           *
        * xsi:noNamespaceSchemaLocation=                                            *
        * "http://www.s1000d.org/S1000D_3-0/xml_schema_master/dm/procedSchema.xsd"  *
        *****************************************************************************
    </xs:documentation>
</xs:annotation>
<xs:redefine schemaLocation="elementGroups.xsd">
    <xs:group name="APPLIC">
        <xs:choice>
            <xs:sequence>
                <xs:element ref="displaytext"/> 
                <xs:choice minOccurs="0">
                    <xs:element ref="assert"/>
                    <xs:element ref="evaluate"/>
                </xs:choice>
            </xs:sequence>
            <xs:choice>
                <xs:element ref="assert"/>
                <xs:element ref="evaluate"/>
            </xs:choice>
        </xs:choice>
    </xs:group>
    <xs:group name="NPAR">
        <xs:sequence>
            <xs:group ref="WC"/>
            <xs:group ref="NPFFT" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="NPFFT">
        <xs:choice>
            <xs:group ref="NP"/>
            <xs:group ref="FFT"/>
        </xs:choice>
    </xs:group>
    <xs:group name="paracon">
        <xs:choice>
            <xs:group ref="text"/>
            <xs:group ref="list"/>
        </xs:choice>
    </xs:group>
    <xs:group name="text">
        <xs:choice>
            <xs:element ref="ein"/>
            <xs:element ref="cb"/>
            <xs:element ref="parasigdata"/>
            <xs:element ref="quantity"/>
            <xs:element ref="xref"/>
            <xs:element ref="indxflag"/>
            <xs:element ref="change"/>
            <xs:element ref="emphasis"/>
            <xs:element ref="symbol"/>
            <xs:element ref="subscrpt"/>
            <xs:element ref="supscrpt"/>
            <xs:element ref="refdm"/>
            <xs:element ref="reftp"/>
            <xs:element ref="ftnote"/>
            <xs:element ref="ftnref"/>
            <xs:element ref="acronym"/>
            <xs:element ref="acroterm"/>
            <xs:element ref="capgrp"/>
        </xs:choice>
    </xs:group>
    <xs:group name="TEXT-NOREFS">
        <xs:choice>
            <xs:element ref="xref"/>
            <xs:element ref="indxflag"/>
            <xs:element ref="symbol"/>
            <xs:element ref="subscrpt"/>
            <xs:element ref="supscrpt"/>
            <xs:element ref="ftnref"/>
            <xs:element ref="acronym"/>
            <xs:element ref="acroterm"/>
        </xs:choice>
    </xs:group>
    <xs:group name="STEP1">
        <xs:sequence>
            <xs:element ref="step1"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP2">
        <xs:sequence>
            <xs:element ref="step2"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP3">
        <xs:sequence>
            <xs:element ref="step3"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP4">
        <xs:sequence>
            <xs:element ref="step4"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP5">
        <xs:sequence>
            <xs:element ref="step5"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP6">
        <xs:sequence>
            <xs:element ref="step6"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP7">
        <xs:sequence>
            <xs:element ref="step7"/>
        </xs:sequence>
    </xs:group>
    <xs:group name="STEP8">
        <xs:sequence>
            <xs:element ref="step8"/>
        </xs:sequence>
    </xs:group>
</xs:redefine>
<xs:redefine schemaLocation="complexTypes.xsd">
    <xs:complexType name="contentType">
        <xs:complexContent>
            <xs:restriction base="contentType">
                <xs:sequence>
                    <xs:element ref="refs" minOccurs="0"/>
                    <xs:element ref="proced"/>
                </xs:sequence>
                <xs:attribute ref="id"/>
            </xs:restriction>
        </xs:complexContent>
    </xs:complexType>
</xs:redefine>
<xs:element name="dmodule" type="dmoduleType"/> 
```

对于外部参照类型，我只设置了两个属性，而对于 refdmType，我只设置了另一种属于 ALLDMC 组的复杂类型。错误的两种复杂类型的代码是：

```
 <xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" elementFormDefault="qualified" attributeFormDefault="qualified">
    <xs:import namespace="http://www.w3.org/1999/02/22-rdf-syntax-ns#" schemaLocation="rdf.xsd"/>
    <xs:import namespace="http://www.w3.org/1999/xlink" schemaLocation="xlink.xsd"/>
    <xs:include schemaLocation="attributeGroups.xsd"/>
    <xs:include schemaLocation="simpleElements.xsd"/>
    <xs:include schemaLocation="complexElements.xsd"/>
    <xs:include schemaLocation="elementGroups.xsd"/>
    <xs:complexType name="refdmType">
        <xs:choice>
            <xs:sequence>
                <xs:element ref="applic" minOccurs="0"/>
                <xs:element ref="dmcextension" minOccurs="0"/>
                <xs:group ref="ALLDMC"/>
                <xs:element ref="issno" minOccurs="0"/>
                <xs:element ref="dmtitle" minOccurs="0"/>
                <xs:element ref="language" minOccurs="0"/>
            </xs:sequence>
            <xs:group ref="xlink:XLINKEXT" minOccurs="0" maxOccurs="unbounded"/>
        </xs:choice>
        <xs:attribute ref="target"/>
        <xs:attribute ref="refapplic"/>
        <xs:attributeGroup ref="bodyatt"/>
        <xs:attributeGroup ref="cntlcontent"/>
        <xs:attributeGroup ref="xlink:XLINKATT"/>
    </xs:complexType>
    <xs:complexType name="xrefType" mixed="true">
        <xs:sequence>
            <xs:element ref="applic" minOccurs="0"/>
            <xs:group ref="SPARCON" minOccurs="0" maxOccurs="unbounded"/>
        </xs:sequence>
        <xs:attribute ref="xrefid"/>
        <xs:attribute ref="xidtype"/>
        <xs:attribute ref="target"/>
        <xs:attribute ref="destitle"/>
        <xs:attribute ref="pretext"/>
        <xs:attribute ref="posttext"/>
        <xs:attribute ref="refapplic"/>
        <xs:attributeGroup ref="cntlcontent"/>
        <xs:attributeGroup ref="xlink:XLINKATT3"/>
    </xs:complexType>
    </xs:schema> 
```

这里是 JAXB 生成类的主要部分。我删除了大部分 getter 和 setter 以节省空间： RefdmType：

```
/**
 * <p>Java class for refdmType complex type.
 * 
 * <p>The following schema fragment specifies the expected content contained within this class.
 * 
 * <pre>
 * &lt;complexType name="refdmType">
 *   &lt;complexContent>
 *     &lt;restriction base="{http://www.w3.org/2001/XMLSchema}anyType">
 *       &lt;choice>
 *         &lt;sequence>
 *           &lt;element ref="{}applic" minOccurs="0"/>
 *           &lt;element ref="{}dmcextension" minOccurs="0"/>
 *           &lt;group ref="{}ALLDMC"/>
 *           &lt;element ref="{}issno" minOccurs="0"/>
 *           &lt;element ref="{}dmtitle" minOccurs="0"/>
 *           &lt;element ref="{}language" minOccurs="0"/>
 *         &lt;/sequence>
 *         &lt;group ref="{http://www.w3.org/1999/xlink}XLINKEXT" maxOccurs="unbounded" minOccurs="0"/>
 *       &lt;/choice>
 *       &lt;attGroup ref="{http://www.w3.org/1999/xlink}XLINKATT"/>
 *       &lt;attGroup ref="{}cntlcontent"/>
 *       &lt;attGroup ref="{}bodyatt"/>
 *       &lt;attribute ref="{}target"/>
 *       &lt;attribute ref="{}refapplic"/>
 *     &lt;/restriction>
 *   &lt;/complexContent>
 * &lt;/complexType>
 * </pre>
 * 
 * 
 */
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "refdmType", propOrder = {
    "applicAndDmcextensionAndAge"
})
public class RefdmType implements Serializable
{

    private final static long serialVersionUID = 1L;
    @XmlElements({
        @XmlElement(name = "applic", type = ApplicType.class),
        @XmlElement(name = "dmcextension", type = DmcextensionType.class),
        @XmlElement(name = "age", type = AgeType.class),
        @XmlElement(name = "avee", type = AveeType.class),
        @XmlElement(name = "issno", type = IssnoType.class),
        @XmlElement(name = "dmtitle", type = DmtitleType.class),
        @XmlElement(name = "language", type = LanguageType.class),
        @XmlElement(name = "resource", namespace = "http://www.w3.org/1999/xlink", type = Resource.class),
        @XmlElement(name = "locator", namespace = "http://www.w3.org/1999/xlink", type = Locator.class),
        @XmlElement(name = "arc", namespace = "http://www.w3.org/1999/xlink", type = Arc.class)
    })
    protected List<Serializable> applicAndDmcextensionAndAge;
    @XmlAttribute(name = "target")
    protected String target;
    @XmlAttribute(name = "refapplic")
    @XmlIDREF
    @XmlSchemaType(name = "IDREF")
    protected Object refapplic;
    @XmlAttribute(name = "type", namespace = "http://www.w3.org/1999/xlink")
    @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
    protected String type;
    @XmlAttribute(name = "href", namespace = "http://www.w3.org/1999/xlink")
    protected String href;
    @XmlAttribute(name = "title", namespace = "http://www.w3.org/1999/xlink")
    protected String title;
    @XmlAttribute(name = "show", namespace = "http://www.w3.org/1999/xlink")
    @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
    protected String show;
    @XmlAttribute(name = "actuate", namespace = "http://www.w3.org/1999/xlink")
    @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
    protected String actuate;
    @XmlAttribute(name = "authname")
    protected String authname;
    @XmlAttribute(name = "authdoc")
    protected String authdoc;
    @XmlAttribute(name = "id")
    @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
    @XmlID
    @XmlSchemaType(name = "ID")
    protected String id;
    @XmlAttribute(name = "level")
    @XmlSchemaType(name = "nonNegativeInteger")
    protected BigInteger level;
    @XmlAttribute(name = "mark")
    @XmlSchemaType(name = "nonNegativeInteger")
    protected BigInteger mark;
    @XmlAttribute(name = "change")
    protected ChangeType change;
    @XmlAttribute(name = "rfc")
    protected String rfc;

    /**
     * Gets the value of the applicAndDmcextensionAndAge property.
     * 
     * <p>
     * This accessor method returns a reference to the live list,
     * not a snapshot. Therefore any modification you make to the
     * returned list will be present inside the JAXB object.
     * This is why there is not a <CODE>set</CODE> method for the applicAndDmcextensionAndAge property.
     * 
     * <p>
     * For example, to add a new item, do as follows:
     * <pre>
     *    getApplicAndDmcextensionAndAge().add(newItem);
     * </pre>
     * 
     * 
     * <p>
     * Objects of the following type(s) are allowed in the list
     * {@link ApplicType }
     * {@link DmcextensionType }
     * {@link AgeType }
     * {@link AveeType }
     * {@link IssnoType }
     * {@link DmtitleType }
     * {@link LanguageType }
     * {@link Resource }
     * {@link Locator }
     * {@link Arc }
     * 
     * 
     */
    public List<Serializable> getApplicAndDmcextensionAndAge() {
        if (applicAndDmcextensionAndAge == null) {
            applicAndDmcextensionAndAge = new ArrayList<Serializable>();
        }
        return this.applicAndDmcextensionAndAge;
    }
    } 
```

外部参照类型：

```
 /**
 * <p>Java class for xrefType complex type.
 * 
 * <p>The following schema fragment specifies the expected content contained within    this class.
 * 
 * <pre>
 * &lt;complexType name="xrefType">
 *   &lt;complexContent>
 *     &lt;restriction base="{http://www.w3.org/2001/XMLSchema}anyType">
 *       &lt;sequence>
 *         &lt;element ref="{}applic" minOccurs="0"/>
 *         &lt;group ref="{}SPARCON" maxOccurs="unbounded" minOccurs="0"/>
 *       &lt;/sequence>
 *       &lt;attGroup ref="{}cntlcontent"/>
 *       &lt;attGroup ref="{http://www.w3.org/1999/xlink}XLINKATT3"/>
 *       &lt;attribute ref="{}xrefid"/>
 *       &lt;attribute ref="{}xidtype"/>
 *       &lt;attribute ref="{}target"/>
 *       &lt;attribute ref="{}destitle"/>
 *       &lt;attribute ref="{}pretext"/>
 *       &lt;attribute ref="{}posttext"/>
 *       &lt;attribute ref="{}refapplic"/>
 *     &lt;/restriction>
 *   &lt;/complexContent>
 * &lt;/complexType>
 * </pre>
 * 
 * 
 */
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "xrefType", propOrder = {
"content"
})
public class XrefType implements Serializable
{

    private final static long serialVersionUID = 1L;
    @XmlElementRefs({
      @XmlElementRef(name = "supscrpt", type = JAXBElement.class),
      @XmlElementRef(name = "subscrpt", type = JAXBElement.class),
      @XmlElementRef(name = "applic", type = JAXBElement.class)
    })
   @XmlMixed
   protected List<Serializable> content;
   @XmlAttribute(name = "xrefid")
   @XmlJavaTypeAdapter(Adapter5 .class)
   @XmlSchemaType(name = "IDREF")
   protected String xrefid;
   @XmlAttribute(name = "xidtype")
   protected XidtypeType xidtype;
   @XmlAttribute(name = "target")
   protected String target;
   @XmlAttribute(name = "destitle")
   protected String destitle;
   @XmlAttribute(name = "pretext")
   protected String pretext;
   @XmlAttribute(name = "posttext")
   protected String posttext;
   @XmlAttribute(name = "refapplic")
   @XmlIDREF
   @XmlSchemaType(name = "IDREF")
   protected Object refapplic;
   @XmlAttribute(name = "authname")
   protected String authname;
   @XmlAttribute(name = "authdoc")
   protected String authdoc;
   @XmlAttribute(name = "type", namespace = "http://www.w3.org/1999/xlink")
   @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
   protected String type;
   @XmlAttribute(name = "href", namespace = "http://www.w3.org/1999/xlink")
   protected String href;
   @XmlAttribute(name = "title", namespace = "http://www.w3.org/1999/xlink")
   protected String title;
   @XmlAttribute(name = "show", namespace = "http://www.w3.org/1999/xlink")
   @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
   protected String show;
   @XmlAttribute(name = "actuate", namespace = "http://www.w3.org/1999/xlink")
   @XmlJavaTypeAdapter(CollapsedStringAdapter.class)
   protected String actuate;

   /**
    * Gets the value of the content property.
    * <p>
    * This accessor method returns a reference to the live list,
    * not a snapshot. Therefore any modification you make to the
    * returned list will be present inside the JAXB object.
    * This is why there is not a <CODE>set</CODE> method for the content property.
    * 
    * <p>
    * For example, to add a new item, do as follows:
    * <pre>
    *    getContent().add(newItem);
    * </pre>
    * 
    * 
    * <p>
    * Objects of the following type(s) are allowed in the list
    * {@link String }
    * {@link JAXBElement }{@code <}{@link String }{@code >}
    * {@link JAXBElement }{@code <}{@link ApplicType }{@code >}
    * {@link JAXBElement }{@code <}{@link String }{@code >}
    * 
    * 
    */
    public List<Serializable> getContent() {
       if (content == null) {
        content = new ArrayList<Serializable>();
       }
       return this.content;
    }
} 
```

最后是我的自定义绑定文件：

```
 <jxb:bindings version="1.0" xmlns:jxb="http://java.sun.com/xml/ns/jaxb"
    xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xjc="http://java.sun.com/xml/ns/jaxb/xjc"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:annox="http://annox.dev.java.net"
    xsi:schemaLocation="http://java.sun.com/xml/ns/jaxb http://java.sun.com/xml/ns/jaxb/bindingschema_2_0.xsd">

    <jxb:globalBindings typesafeEnumMemberName="generateName"
        typesafeEnumMaxMembers="1500" collectionType="java.util.ArrayList"
        generateValueClass="true" choiceContentProperty="true">
        <xjc:serializable uid="1" />
    </jxb:globalBindings>

    <jxb:bindings schemaLocation="simpleTypes.xsd" node="/xs:schema">
        <jxb:bindings node="//xs:simpleType[@name='YEAR']">
            <jxb:javaType name="java.lang.Integer" />
        </jxb:bindings>
        <jxb:bindings node="//xs:simpleType[@name='DAY']">
            <jxb:javaType name="java.lang.String" />
        </jxb:bindings>
        <jxb:bindings node="//xs:simpleType[@name='MONTH']">
            <jxb:javaType name="java.lang.String" />
        </jxb:bindings>
        <jxb:bindings node="//xs:simpleType[@name='issnovalueType']">
            <jxb:javaType name="java.lang.String" />
        </jxb:bindings>
    </jxb:bindings>

    <jxb:bindings schemaLocation="attributes.xsd" node="/xs:schema">
        <jxb:bindings node="xs:attribute[@name='inwork']">
            <jxb:property>
                <jxb:baseType>
                    <jxb:javaType name="java.lang.String" />
                </jxb:baseType>
            </jxb:property>
        </jxb:bindings>
        <jxb:bindings node="//xs:attribute[@name='xrefid']">
            <jxb:property>
                <jxb:baseType>
                    <jxb:javaType name="java.lang.String" />
                </jxb:baseType>
            </jxb:property>
        </jxb:bindings>
    </jxb:bindings>

    <jxb:bindings schemaLocation="complexTypes.xsd" node="/xs:schema">
        <jxb:bindings node="xs:complexType[@name='dmoduleType']">
            <annox:annotate>
                <annox:annotate annox:class="javax.xml.bind.annotation.XmlRootElement"
                    name="dmodule" />
            </annox:annotate>
        </jxb:bindings>
        <jxb:bindings node="//xs:complexType[@name='skillType']">
            <jxb:class name="SkillTypeComplex" />
        </jxb:bindings>
        <!--<jxb:bindings node="//xs:complexType[@name='xrefType']">
              <annox:annotate>
                <annox:annotate annox:class="javax.xml.bind.annotation.XmlRootElement"
                    name="xref" />
            </annox:annotate>
            <jxb:bindings node=".//xs:sequence//xs:element[@ref='applic']">
                <jxb:property name="xrefApplic"/>
            </jxb:bindings>
        </jxb:bindings>-->
    </jxb:bindings>

    <jxb:bindings schemaLocation="elementGroups.xsd" node="//xs:group[@name='APPLIC']">
        <jxb:bindings node=".//xs:choice//xs:sequence">
            <jxb:bindings node=".//xs:choice">
                <jxb:property name="assertEvalChoice" />
            </jxb:bindings>
        </jxb:bindings>
    </jxb:bindings>

    <jxb:bindings schemaLocation="dc.xsd" node="/xs:schema">
        <jxb:bindings node="//xs:element[@name='language']">
            <jxb:class name="DcLanguage" />
        </jxb:bindings>
        <jxb:bindings node="//xs:element[@name='subject']">
            <jxb:class name="DcSubject" />
        </jxb:bindings>
        <jxb:bindings node="//xs:element[@name='title']">
            <jxb:class name="DcTitle" />
        </jxb:bindings>
    </jxb:bindings>
</jxb:bindings> 
```

对于为什么会发生这种情况以及如何解决它的建议的高级视图将不胜感激。我只使用 JAXB 几个月，并不是专家。谢谢你。

这是我看到的错误：

> javax.xml.bind.MarshalException - 带有链接异常：[com.sun.istack.SAXException2: 由于缺少@XmlRootElement 注释] 在 com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:323) 在 com.sun.xml.bind.v2.runtime.MarshallerImpl.marshal(MarshallerImpl.java:249)在 javax.xml.bind.helpers.AbstractMarshallerImpl.marshal(AbstractMarshallerImpl.java:96) 在 com.synesis7.s7exporter.client.s1000d.procedural.S7ProceduralRunnable.writeToXml(S7ProceduralRunnable.java:142) 在 com.synesis7.s7exporter.client .s1000d.procedural.S7ProceduralRunnable.createProceduralDm(S7ProceduralRunnable.java:118) 在 com.synesis7.s7exporter.client.s1000d.procedural.S7ProceduralRunnable。在 com.synesis7.s7exporter.S7ExporterController.exportSchema(S7ExporterController.java:118) 在 com.synesis7.s7exporter.S7exporter 上运行（S7ProceduralRunnable.java:93） .initializeExporter(S7exporter.java:58) at com.synesis7.s7exporter.S7exporter.main(S7exporter.java:38) 原因：com.sun.istack.SAXException2：无法编组类型“com.synesis7.s7exporter.domain。 s1000d.dm.common.XrefType”作为元素，因为它在 com.sun.xml.bind 的 com.sun.xml.bind.v2.runtime.XMLSerializer.reportError(XMLSerializer.java:252) 处缺少 @XmlRootElement 注释.v2.runtime.ClassBeanInfoImpl.serializeRoot(ClassBeanInfoImpl.java:324) 在 com.sun.xml.bind.v2.runtime.property.ArrayReferenceNodeProperty。com.sun.xml.bind.v2.runtime.property.ArrayERProperty.serializeBody(ArrayERProperty.java:159) 上的 serializeListBody(ArrayReferenceNodeProperty.java:118) com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody( ClassBeanInfoImpl.java:344) 在 com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:700) 在 com.sun.xml.bind.v2.runtime.property.ArrayElementNodeProperty.serializeItem(ArrayElementNodeProperty. java:69) 在 com.sun.xml.bind.v2.runtime.property.ArrayElementProperty.serializeListBody(ArrayElementProperty.java:172) 在 com.sun.xml.bind.v2.runtime.property.ArrayERProperty.serializeBody(ArrayERProperty. java:159) 在 com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:344) 在 com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:700) 在 com.sun.xml.bind.v2.runtime.property.ArrayElementNodeProperty.serializeItem(ArrayElementNodeProperty.java:69) 在 com.sun.xml.bind.v2.runtime.property.ArrayElementProperty.serializeListBody(ArrayElementProperty. java:172) 在 com.sun.xml.bind.v2.runtime.property.ArrayERProperty.serializeBody(ArrayERProperty.java:159) 在 com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java: 344) 在 com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:700) 在 com.sun.xml.bind.v2.runtime.property.ArrayElementNodeProperty.serializeItem(ArrayElementNodeProperty.java:69)在 com.sun.xml.bind.v2.runtime.property.ArrayERProperty 的 com.sun.xml.bind.v2.runtime.property.ArrayElementProperty.serializeListBody(ArrayElementProperty.java:172)。com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:344) 上的 serializeBody(ArrayERProperty.java:159) com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer. java:700) 在 com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:156) 在 com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java: 344) 在 com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:156) 的 com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:700)在 com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:344) 在 com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:338) 在 com.sun.xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:156) 的 com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:700)在 com.sun.xml.bind.v2.runtime.XMLSerializer.childAsXsiType(XMLSerializer.java:700) 在 com.sun.com.sun.xml.bind.v2.runtime.ClassBeanInfoImpl.serializeBody(ClassBeanInfoImpl.java:344) .xml.bind.v2.runtime.property.SingleElementNodeProperty.serializeBody(SingleElementNodeProperty.java:156) 在 com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl$1.serializeBody(ElementBeanInfoImpl.java:161) 在 com.sun。 xml.bind.v2.runtime.ElementBeanInfoImpl$1.serializeBody(ElementBeanInfoImpl.java:193) 在 com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeBody(ElementBeanInfoImpl.java:321) 在 com.sun.xml.bind .v2.runtime.ElementBeanInfoImpl.serializeRoot(ElementBeanInfoImpl.java:328) 在 com.sun.xml.bind.v2.runtime.ElementBeanInfoImpl.serializeRoot(ElementBeanInfoImpl.java:76) 在 com.sun.xml.bind.v2.runtime。 com.sun.xml.bind.v2.runtime.MarshallerImpl.write(MarshallerImpl.java:320) 上的 XMLSerializer.childAsRoot(XMLSerializer.java:498) ... 还有 9 个

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-11-26T23:34:40.937

您可以将对象包装在 的实例中`JAXBElement`以提供根元素信息。`ObjectFactory`如果您从 XML 模式生成模型，则在生成的类上有方便的方法。

**了解更多信息**

*   [http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html](http://blog.bdoughan.com/2012/07/jaxb-and-root-elements.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-03-03T12:23:13.097

您可以使用**ObjectFactory**类来解决没有**@XmlRootElement**的类。ObjectFactory 具有将其包装在 JAXBElement 周围的重载方法。 **Method:1**执行对象的简单创建，**Method:2**将使用**@JAXBElement**包装对象。始终使用**Method:2**来避免 javax.xml.bind.MarshalException - 链接异常缺少 @XmlRootElement 注释

**方法：1**

```
public GetCountry createGetCountry() {
        return new GetCountry();
    } 
```

**方法：2**

```
 @XmlElementDecl(namespace = "my/name/space", name = "getCountry")
 public JAXBElement<GetCountry> createGetCountry(GetCountry value) {
        return new JAXBElement<GetCountry>(_GetCountry_QNAME, GetCountry.class, null, value);
    } 
```

希望这会有所帮助...

# php - 显示来自 mysql 数据库的图像

> ID：13574748
> 
> 赞同：1
> 
> 时间：2012-11-26T23:09:32.987
> 
> 标签：php, mysql, image

我对php比较陌生。从 mysql 数据库检索 blob 数据后，我在浏览器（谷歌浏览器）中显示图像时遇到问题。

基本上，当在底部的回声前面添加斜杠时，以下代码可以工作。但是，我遵循了其他在线教程，并且导师能够在不使用斜线的情况下显示他们的图像，而我无法获得图像。我只是想知道标准规则是什么？要添加的另一件事 - 当我无法在浏览器中获取图像时，我会得到一个 ting 缩略图。如果有人能告诉我如何可靠地显示图像，我将不胜感激。我希望创建的网站只是关于图像。所以它是一种基本的。非常感谢您抽出宝贵时间。

```
<?php
$conn = mysql_connect ("localhost","root","arctic123");
$db = mysql_select_db ("user_images", $conn);

if(!$db) {
    echo mysql_error();
}

$q = "SELECT * FROM images";
$r = mysql_query ("$q",$conn);
if($r) {
    while($row = mysql_fetch_array($r)) {
        //echo $row ['username'];
        //echo "<br>";
        header ("Content-type: image/jpeg");
        echo $row ['logo'];
        //echo "<br>";
    }
}else{
    echo mysql_error();
}
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:20:56.833

您的代码中不能有`header`任何输出：http: [//php.net/manual/en/function.header.php](http://php.net/manual/en/function.header.php)

最佳做法是将图像上传到目录并将图像的路径/文件名存储在数据库中。还可以更轻松地操作图像，例如使用 PHP 创建不同大小和缩略图。而且它占用的磁盘空间少了大约四倍......

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:22:08.757

希望您不要将图像存储在 MySQL 上，如果您这样做了，请停止这种有害行为，因为它会使您的数据库变得不必要地沉重......

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:34:19.353

我建议不要将图像存储在数据库中。虽然这在技术上是可行的，但它存在严重的性能问题。最佳做法是为图像指定一个文件夹，然后直接访问它们。如果您想要 MySQL 的过滤和排序功能，请将当前存储图像数据的 BLOB 列替换为包含文件名的 VARCHAR。

```
<?php
$conn = mysql_connect ("localhost","root","arctic123");
$db = mysql_select_db ("user_images", $conn);
$imgdir = "/path/to/image/directory/";

if(!$db) {
    echo mysql_error();
}

$q = "SELECT * FROM images";
$r = mysql_query ("$q",$conn);
if($r) {
    while($row = mysql_fetch_array($r)) {
        echo $row['username'];
        echo "<br>";
        echo "<img src='" . $imgdir . $row['logo'] . "' />";
        echo "<br>";
    }
}else{
    echo mysql_error();
}
?> 
```

# excel - Excel 2010，如何在移动到另一列之前制作条件

> ID：13574749
> 
> 赞同：2
> 
> 时间：2012-11-26T23:09:34.670
> 
> 标签：excel, excel-2010

我正在做一个数据库项目。因此，我希望 excel 在正确填充列之前警告我或阻止我转到另一行。

例如：

```
Person | Standard therapy | Alt Therapy 1 | Alt Therapy 2
1      | yes              | -             | -
2      | no               | -             | - 
```

因此，如果我在标准疗法中输入“否”，我希望 excel 在我填写替代疗法 1 和 2 的列（这些列有下拉列表）之前阻止我去另一个人（或下一行）或至少警告我这些栏需要填写。

我怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-28T09:31:02.603

使用条件格式突出显示在离开记录之前必须填写的单元格可能足以满足您的需要。这个想法是设置一种条件格式，该格式将指定记录中何时缺少必要的值，并以明显的视觉提示警告您，直到您输入适当的值才会消失。

例如，假设您的示例从单元格 A1 开始，您可以首先使用公式“=and(len(a2)>0,len(b2)=0)”将亮黄色填充的条件格式应用于单元格 B2。然后，您可以使用公式“and(b2="no",len(c2)=0" 对单元格 C2 应用条件格式，再次为 C2 指定亮黄色填充。等等。（我使用的条件是仅用于说明；您会知道对数据的确切要求。）

您需要为第一行数据设置所有条件格式，然后将这些格式复制并粘贴到工作表数据区域中的所有行。

# python - 在Python中的图像顶部叠加多边形

> ID：13574751
> 
> 赞同：7
> 
> 时间：2012-11-26T23:09:38.723
> 
> 标签：python, image-processing, overlay

假设我在 PIL 中有一张图片

```
from PIL import Image
Image.open(path_to_my_image) 
```

和两个`x`点和`y`点列表

```
x = ['10', '30', '70']
y = ['15', '45', '90'] 
```

有没有办法在这张图片上**用透明度覆盖我的多边形？**

另外，PIL 是一个很好的图书馆吗？还是我应该使用不同的？（例如`scikits.image`，或使用 pylab 渲染图像）。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-11-26T23:14:48.027

PIL 是一个很好的工具：

```
import Image
import ImageDraw
img = Image.open(...).convert('RGBA')

x = ['10', '30', '70']
y = ['15', '45', '90']

# convert values to ints
x = map(int, x)
y = map(int, y)

img2 = img.copy()
draw = ImageDraw.Draw(img2)
draw.polygon(zip(x,y), fill = "wheat")

img3 = Image.blend(img, img2, 0.5)
img3.save('/tmp/out.png') 
```

* * *

调用签名为`draw.polygon`：

```
def polygon(self, xy, fill=None, outline=None): 
```

所以唯一的选择是`fill`and `outline`。我查看了源代码以找到此信息。

IPython 告诉我：

```
In [38]: draw.polygon?
...
File:       /usr/lib/python2.7/dist-packages/PIL/ImageDraw.py 
```

这向我展示了在哪里看。

* * *

要在 顶部绘制半透明多边形`img`，请复制图像。一份副本，以不带 alpha 的全彩绘制多边形。然后使用[Image.blend](http://www.pythonware.com/library/pil/handbook/image.htm)将原始图像与副本组合在一起，设置级别为`alpha`. 对于每个像素：

```
out = image1 * (1.0 - alpha) + image2 * alpha 
```

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2020-05-28T13:57:29.067

为此，您可以像这样使用[Shapely](https://pypi.org/project/Shapely/)和[OpenCV](https://pypi.org/project/opencv-python/)：

```
import cv2
import numpy as np
from shapely.geometry import Polygon

x = [10, 30, 70]
y = [15, 45, 90]
alpha = 0.5 # that's your transparency factor
path = 'path_to_image.jpg'

polygon = Polygon([(x[0], y[0]), (x[1], y[1]), (x[2], y[2]), (x[0], y[2])])
int_coords = lambda x: np.array(x).round().astype(np.int32)
exterior = [int_coords(polygon.exterior.coords)]

image = cv2.imread(path)
overlay = image.copy()
cv2.fillPoly(overlay, exterior, color=(255, 255, 0))
cv2.addWeighted(overlay, alpha, image, 1 - alpha, 0, image)
cv2.imshow("Polygon", image)
cv2.waitKey(0)
cv2.destroyAllWindows() 
```

# c# - 匹配 *A* 字符和可选“”的正则表达式

> ID：13574759
> 
> 赞同：-1
> 
> 时间：2012-11-26T23:10:01.520
> 
> 标签：c#, regex

我需要下面的字符串在正则表达式中有效。

```
string pattern = @"({[0-9]+}) (=|>|<|\*A*) ([a-z0-9]+)";
string input = "{123} = \"10\" || {12334} < 1000 || {8} > abcs || {34} *A* 33 || {22} *A* \"ábcd\"";

Regex rgx = new Regex(pattern, RegexOptions.Compiled);
MatchCollection matches = rgx.Matches(input);

if (matches.Count > 0)
{
    Console.WriteLine("{0} ({1} matches):", input, matches.Count);
    foreach (Match match in matches)
        Console.WriteLine("   " + match.Value);
}
else
    Console.WriteLine("Nothing" ); 
```

如何使我的正则表达式适用于所有情况下的字符串（输入）？上面的代码应该返回 5 个匹配项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:19:07.507

Try this one:

```
(\{[0-9]+\})\s+(\=|\>|\<|\*A\*)\s+\"?([\p{L}\d]+)\"? 
```

You needed to escape the second `*` too. Also your input string contains unicode letters which do not fall into `[a-z]` therefore I used `\p{L}` instead which matches all letters. Also you didn't account for optional quotes around letters, so I added two `\"?` around the right-hand-side of the expression. To store the above in an @-quoted string you need to do repeat double quotes twice, as in:

```
string pattern = @"(\{[0-9]+\})\s+(\=|\>|\<|\*A\*)\s+\""?([\p{L}\d]+)\""?"; 
```

I have a tendency to escape all the symbols while it might not be necessary.

# aptana3 - 安装了aptana 3.0，现在本地主机上的php不再工作

> ID：13574761
> 
> 赞同：1
> 
> 时间：2012-11-26T23:10:07.290
> 
> 标签：aptana3

装有 Apache Server 和 PHP 的 Windows XP 已安装并运行。安装了 Aptana 3.0，现在本地主机中的 PHP 不再工作。它只显示代码（或部分代码）。

我已经在本地主机上使用 php 文件数周了，没有任何问题。由于我几天前安装了 Aptana 3.0，这些本地（和简单的）php 文件不会呈现为 php。

更新：当我从 Windows 资源管理器拖放时，php 无法呈现。这在安装 Aptana 之前有效。如果我直接在地址栏中输入地址，它可以正常工作。

当我拖放时，地址栏中有以下内容：

file:///C:/apache/htdocs/btb_sandbox/array_functions.php

# opengl-es - glsl中的lowp vs. mediump vs. highp？

> ID：13574765
> 
> 赞同：5
> 
> 时间：2012-11-26T23:10:20.223
> 
> 标签：opengl-es, opengl-es-2.0, glsl, shader

过去一周我一直在研究自定义着色器。我遇到了各种奇怪的问题，直到我将几乎所有浮点变量都切换到`highp`.

`highp`然而，今天我发现，如果我使用输入纹理坐标（介于 0 和 1.0 之间），双三次插值算法实际上会有色带。如果我使用`mediump`它工作正常。

我想知道是否有人可以解释这是为什么。根据这份文件：

[http://www.khronos.org/files/opengles_shading_language.pdf](http://www.khronos.org/files/opengles_shading_language.pdf)

`highp`浮点幅度范围为 2^-62 到 2^62，浮点精度（相对）为 2^-16。

而`mediump`浮点幅度范围为 2^-14 到 2^14，浮点精度（相对）为 2^-10。

如果我正确理解这一点，这*应该*意味着它`mediump`总是不如`highp`. 为什么不是这样？

# php - 预加载的 php 类文件位置

> ID：13574766
> 
> 赞同：1
> 
> 时间：2012-11-26T23:10:19.127
> 
> 标签：php, class

> **可能重复：**
> [查找定义类的 PHP 文件（在运行时）](https://stackoverflow.com/questions/2420066/finding-the-php-file-at-run-time-where-a-class-was-defined)

我正在使用其他人（当前不可用）设置的服务器。我正在尝试找到 apache（或其他）正在预加载的类的源代码，以便我可以将源代码更新为该类的正确版本。运行这个：

```
<?php echo class_exists('className')? "yes": "no"; ?> 
```

（作为整个 php 文件）打印出是。如何找出该类来自哪个文件？我已经对服务器进行了grep，并且有一长串可能的文件，但宁愿只知道我需要更改哪个文件，而无需进行大量猜测和检查。是否有函数可以告诉我带有该类名的源代码的文件？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:39:02.507

```
$r = new ReflectionClass('YourClassName');
echo $r->getFileName(); 
```

[请参阅http://php.net/manual/en/reflectionclass.getfilename.php](http://php.net/manual/en/reflectionclass.getfilename.php)中反射类的文档页面

根据文档，PHP 核心（或扩展）定义的类会导致`getFileName()`方法返回`FALSE`。

```
if ($r->getFileName() === FALSE) {echo 'Defined by PHP';} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:13:22.800

检查包含路径以查看哪些目录是相关的。

获取包含路径

[http://php.net/manual/de/function.get-include-path.php](http://php.net/manual/de/function.get-include-path.php)

使用反射类获取实际文件 [http://de1.php.net/manual/de/reflectionclass.getfilename.php](http://de1.php.net/manual/de/reflectionclass.getfilename.php)

# java - Java中命名实体识别的最大熵马尔可夫模型

> ID：13574767
> 
> 赞同：0
> 
> 时间：2012-11-26T23:10:29.443
> 
> 标签：java, nlp

我有一个解析问题，MEMM 可以很好地解决。但是我花了很多时间试图找到算法的良好实现（最好是在 java 中）。有没有人这样做过？或者，如果有人有一些可读的文档，我可以自己实现它。

谢谢！

（我已经尝试过 Mallet 并且罐子里的训练器没有实现）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T08:58:54.380

您认为 MEMM 特别适合您的问题的原因是什么？通常很难找到为什么某些东西会比其他东西更好的理论依据，并且这个问题是凭经验解决的。

如果您已经拥有 Mallet，请尝试使用 Conditional Random Field 实现。最近的研究，从 Lafferty、McCallum 和 Pereira 开始，`Conditional Random Fields: Probabilistic Models for Segmenting and Labeling Sequence Data`表明 CRF 在序列标记方面通常优于 MEMM。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T00:00:21.533

您是否查看过斯坦福 NLP 集团的[***CMMClassifier***](http://nlp.stanford.edu/nlp/javadoc/javanlp/edu/stanford/nlp/ie/ner/CMMClassifier.html)，它位于[**斯坦福 CoreNLP NLP 工具套件中**](http://nlp.stanford.edu/software/corenlp.shtml)？

恐怕我无法谈论底层[***MEMM***](http://en.wikipedia.org/wiki/Maximum-entropy_Markov_model)实现的质量，但它是用 Java 编写的，而且我使用了斯坦福 NLP 的其他几个部分并取得了相对成功。

我发现有时 CoreNLP 的缺点是其广泛的对象模型和大多数模块所具有的非常多的依赖关系。当一个人希望专注于单个工具/类时，与这些依赖相关的分心和学习曲线可能会很烦人。另一方面，该对象模型有效地对应于许多 NLP 任务共有的实际中低级过程，因此非常有用。

# java - Spring端点映射

> ID：13574769
> 
> 赞同：0
> 
> 时间：2012-11-26T23:10:46.443
> 
> 标签：java, spring, mapping, endpoint

我的`spring-ws-servlet.xml`文件中有一个问题，无法以这种方式定义端点：

```
<bean id="MM7Endpoint" class="pl.famoc.test.ws.FamocCaEndpoint" /> 
```

但我得到了代码错误：

```
Class 'pl.famoc.test.ws.FamocCaEndpoint' not found 
```

而且我确信包含我的定义的 FamocCaEndpoint.java`@Endpoint`在包中有`pl.famoc.test.ws`任何提示吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:21:22.840

尝试在您的主要方法或 servlet 中实例化您的“手动”。如果您`ClassNotFoundException`的运行时类路径可能有问题。请注意，在某些情况下，如果调用静态构造函数时未找到依赖类（=该类第一次实例化失败），也会引发此异常。所有后续实例化该类的尝试只会给您 CNF 异常。因此，可能值得关注在此之前可能引发的异常。

# javascript - 使用 Web 套接字在浏览器中创建图形

> ID：13574771
> 
> 赞同：3
> 
> 时间：2012-11-26T23:11:06.233
> 
> 标签：javascript, html, graph, websocket

我正在尝试查找可以在 Web 浏览器中创建条形图的示例或工具。我将通过 Web 套接字从服务器发送数据，当接收到数据时，我希望每个条的“高度”发生变化，以反映接收到的数据。

因此，用户可以看到图表随着数据的接收而变化。

我看过很多例子，但我看不到一个能做到以上的例子。像 D3 这样的东西看起来非常好，但似乎有一个陡峭的学习曲线，而且似乎有很多，它变得相当混乱。

我正在寻找一些简单快捷的事情。

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-27T12:00:14.850

您真正需要做的是找到一个简单的图表库，它支持某种形式的**重绘**或绑定数据模型并检测对该模型的更改的方法。常见的步骤是：

1.  使用初始数据集创建图表对象
2.  绘制初始图表
3.  通过 WebSocket 连接获取更新
4.  更新数据集
5.  重绘图表

由于一般过程非常简单，因此库往往会带来复杂性。

**一些例子**

可以通过 .net 杂志教程上[的使用 HTML5 WebSockets 编写实时调查](http://www.netmagazine.com/tutorials/code-real-time-survey-html5-websockets)来找到一个实时图表示例，它只是实时显示投票和更新。它使用我为之工作的[Pusher](http://pusher.com)。

这里还有一个使用 DJ、Python、Pusher 和 Twitter 流 API 的示例：http: [//bieber.nixonmcinnes.co.uk/](http://bieber.nixonmcinnes.co.uk/)

代码可以在这里找到： [https ://github.com/nixmc/pusher-d3-demo](https://github.com/nixmc/pusher-d3-demo)

博客文章在这里： [http ://www.nixonmcinnes.co.uk/2012/04/20/what-c​​an-we-learn-from-the-real-time-web-and-justin-bieber/](http://www.nixonmcinnes.co.uk/2012/04/20/what-can-we-learn-from-the-real-time-web-and-justin-bieber/)

**最简单的例子**

这里还有一个使用 Pusher 和[SmoothieCharts](http://smoothiecharts.org/)的视频： [http ://www.youtube.com/watch?v=VLTsT30TZYw](http://www.youtube.com/watch?v=VLTsT30TZYw)

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-11-30T01:24:19.533

You might want to look at d3.js for the client-side drawing of the "live" chart. It works really well, and doing things like live bar (or other type) charts is really easy, with syntax similar to JQuery. As for getting the data over the WebSocket, the various websocket packages (full disclosure--I work for Kaazing, that pioneered WebSockets) can pretty much all do this.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-11-27T06:59:08.797

看看 XSockets.NET，有一个 Nuget-Package 可用于设置 WebSockets/Realtime 服务，JavaScript API 很容易上手。您还可以使用托管版本，在其中“仅”运行 JavaScript，有关 XSockets.NET 的更多信息将在[http://xsockets.net上找到](http://xsockets.net)

[http://live.xsockets.net](http://live.xsockets.net)上“javascript”版本的托管服务，在[http://xfiddle.net/上为 JavaScript 开发人员提供的游乐场](http://xfiddle.net/)

关于 Graph，在 jsfiddle 上有一个示例，它包含一个 Wijmo 图表（条形图），可以实时响应用户输入。xfiddle.net 中有指向该示例的链接

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2015-05-31T08:52:44.457

对于这个老问题的新访问者，以下是当前使用 websocket 实时更改绘图的**最简单**和最直接的**示例之一（使用与 python 或 perl 配对的谷歌图表实现）：**

[https://github.com/albertobeta/UberSimpleWebsockets](https://github.com/albertobeta/UberSimpleWebsockets)

# mysql - 我需要为按日期分段的 2 组值提供排名

> ID：13574772
> 
> 赞同：0
> 
> 时间：2012-11-26T23:11:10.457
> 
> 标签：mysql

我有一个查询，它返回一个表，其中包含多个给定日期的值。我希望能够知道每个日期的任何给定结果集，它们的排名是多少。我不能使用简单的排名函数，因为我需要为多个列、多个日期执行此操作。关于我需要什么功能以及如何编写它的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:16:26.060

```
select *, @rank := @rank + 1
from your_table, (select @rank := 0) r 
```

# jquery - 无法在焦点上触发功能

> ID：13574774
> 
> 赞同：-1
> 
> 时间：2012-11-26T23:11:21.800
> 
> 标签：jquery

我有一个包含几个表单字段的页面。当我在一个字段内单击时，我需要触发一项功能。所以我尝试了：

```
$('#myInput').focus(function() {
    alert('fired');
}); 
```

然而它没有用。我认为这是由于在初始页面加载后动态添加到页面的方式。我已经尝试将此功能附加到其他字段，并且它们工作得很好。

所以，我试过了

```
$(document).delegate('#myInput', 'click', function() { 
```

和

```
$('#myInput').live('focus', function() { 
```

仍然没有运气。有什么建议么？谢谢。

更新 - - - - - - - - - -

仍然不知道为什么，但将其更改为

```
$('input[name="myInput"]').focus(function() { 
```

工作。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:42:58.330

问题是只有在第一次运行 javascript`$('#myInput').focus(...);`时才添加它。`'#myInput'`

如果您`'#myInput'`在 javascript 加载后动态添加，那么您需要 javascript 动态添加侦听器。

以下将执行此操作：

**Javascript**

```
$('body').on('focus', '#myInput', function() {
    alert('fired');
}); 
```

**[演示](http://jsfiddle.net/aYtmS/)**

**[文档](http://api.jquery.com/on/)**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:13:40.883

尝试使用focusin。也许会奏效。

# caching - 如何使用 ESI 构建 Symfony2 应用程序？

> ID：13574775
> 
> 赞同：20
> 
> 时间：2012-11-26T23:11:27.887
> 
> 标签：caching, symfony, varnish, esi

在一个流量很大的新项目中，我们正在考虑如何构建我们的 Symfony2 应用程序以利用缓存，并准备好在未来变得更加积极。我很想知道你的意见。

假设用户向页面请求地点列表。这个页面有：

```
- list
   - common data (title, author, description)
   - user data (the user likes the list + other data)
- first 20 places
   - common data (title, photo of each place)
   - user data (the rates of the user for those places) 
```

HTML 可能类似于：

```
<html>...
<body>
  <header>
  ...
  <!-- Embed the top user menu -->
  <esi:include src="http://example.com/profile/menu" />
  ...
  </header>

  <content>
  ...
  common data of the list
  ...
  <!-- Embed the common data of the first 20 places, the same for everyone -->
  <esi:include src="http://example.com/lists/17/places" />
  ...
  <!-- Embed the user data of the list (used in JS) -->
  <esi:include src="http://example.com/lists/17/user" />
  ...
  <!-- Embed the user data of the list of places (used in JS) -->
  <esi:include src="http://example.com/lists/17/places/user" />
  ...
  </content>
</body>       
</html> 
```

HTML 将缓存在网关上（Symfony 或 Varnish）。地点列表也将大部分时间缓存在网关上。用户数据请求将是那些被调用但不被缓存的（至少最初不是）。

**问题**：

1.  你觉得这个结构怎么样？
2.  如果用户是匿名的，我可以避免为用户数据制作 esi-includes 吗？另外，如果我有匿名用户的 cookie？如何？
3.  用户菜单的 esi-include 是否有意义？
4.  还是我们应该忘记 ESI 并始终通过控制器（例如缓存公共数据的渲染视图）？
5.  我们是否应该将要求用户数据的 2 个 ESI 请求移动为 AJAX 调用，而不是在服务器上等待？
6.  如果我们需要快速扩展，这是一种很好的扩展方法吗？什么是最好的？

多谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-11T22:39:08.597

我们在一个站点上使用 Varnish 进行整页缓存，并且我已经使用 Symfony2 几年了，但请记住，我没有在任何生产环境中使用 Varnish + Symfony2 + ESI。

1.  我认为基本的想法是可以的。如果许多页面中的菜单相同，并且许多页面上的位置列表也相同，则您将获得由 Varnish 或 Symfony 反向缓存缓存的常见内容。由于 Varnish 通常将缓存保存在内存中，因此您可以更快地获取内容，并且不必在每次请求时调用渲染和数据库查询代码。

    如果用户登录，困难的部分是缓存这些 ESI 请求。据我所知，在默认的 Varnish 配置中，其中包含 Cookie 的请求永远不会被缓存。如果您倾向于将 cookie 传递给 ESI 请求，则这些 ESI 响应将不会在用户之间共享。

    您可以尝试从 URL 制定一些规则，但如果您使用默认的 Symfony 树枝助手，生成的 URL 是 /_internal/...，因此可能很难区分公共和私有的。

    如果通过，您也可以配置为始终忽略任何 cookie `Cache-Control: public`。这在 Symfony 中默认完成：

    ```
    if ($this->isPrivateRequest($request) && !$response->headers->hasCacheControlDirective('public')) {
        $response->setPrivate(true);
    } 
    ```

    正如您从代码中看到的，如果您有`public`指令，响应将永远不会是私有的。

    我还没有发现 Varnish 是如何处理这个指令的——据我所知，它不会缓存任何默认具有 cookie 的请求。所以我认为你必须调整配置才能做到这一点。

2.  如果主页也将被缓存，我看不出您如何跳过包含。

    我假设您的注册用户（不是搜索机器人）需要 JS，所以我建议使用 Javascript 来区分用户数据的加载。

    Javascript 代码可以查看用户是否有 cookie`session-id`等，并仅在这种情况下请求获取数据。设置一些其他 cookie 也可能是个好主意，例如`_loggedin`避免 Javascript 代码获取会话 ID。

    未登录的用户也可以在 cookie 中保存一些数据，例如`_likedPost:1,2,132`. Javascript 可以获取此 cookie 并进行一些 HTML 更正，甚至无需发出额外的请求。

    正如我们对这些 cookie 所做的那样：我们将 JS-only cookie 与应用程序 cookie 分开。我们通过某种模式来做到这一点，比如`_\w`JS cookie。然后我们调整了 Varnish 配置以拆分 Cookie 标头并删除这些仅限 JS 的 cookie。然后，如果没有其他 cookie，则与所有人共享响应。应用程序（Symfony）没有得到这些 cookie，因为它们被剥离了。

3.  我认为如果每一页都相同的话。

4.  我认为 ESI 很好，因为 Varnish 可以将缓存保存在内存中。因此，它甚至可能不会对您的硬盘进行任何内容查询。由于您的控制器缓存可能也在内存中，我认为 Varnish 会比 Symfony 框架更快地查找缓存，其中包含所有路由、PHP 代码、服务初始化等。

5.  这取决于，但我认为这可能是更好的方法。请记住，缓存过着不同的生活。例如，如果您的地点列表缓存了 2 小时，则在此时间结束时地点可能已更改 - 一些新项目是列表中的新项目，而其中一些已丢失。您给用户的列表仍然是旧列表（缓存），但您提供了有关新列表的用户数据 - 有些数据不需要，有些数据丢失。

    It might be better approach to get loaded places by javascript, for example searching for some HTML attribute like `data-list-item-id` and then make ajax request querying data about these items. In this case your user data will be synchronized with current cached list and you can make 1 ajax request for both lists instead of 2.

6.  If cache invalidation (PURGE requests) are not used, all HTTP cache sheme is indeed good to scale. You can scale the application to several servers and configure Varnish to call them randomly, by some rule or just to use one of them as a failsafe. If the bandwidth is still too big, you can always modify the cache timeouts and other configuration.

# jdbc - hibernate 是否提供数据源 jdni url？

> ID：13574776
> 
> 赞同：1
> 
> 时间：2012-11-26T23:11:31.060
> 
> 标签：jdbc, datasource, jndi

我知道应用程序服务器通常可以通过 JNDI 提供到您的数据库的连接。在 Java SE 中运行的休眠是否可以像 Tomcat/Glassfish/Jetty 这样的应用程序容器一样提供 JNDI url/数据源？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:23:16.140

从[文档](http://docs.jboss.org/hibernate/orm/4.1/devguide/en-US/html/ch01.html#d5e199)看来它应该是可能的。您只需要提供一些参数：

> JNDI 数据源的重要 Hibernate 属性
> 
> hibernate.connection.datasource（必需）
> 
> hibernate.jndi.url
> 
> hibernate.jndi.class
> 
> hibernate.connection.username
> 
> hibernate.connection.password

# android - 我可以在哪里找到 Android 中内置壁纸应用程序/活动的源代码。

> ID：13574788
> 
> 赞同：1
> 
> 时间：2012-11-26T23:12:30.190
> 
> 标签：android, wallpaper

如果您长按 Android 午餐器，然后按墙纸，则会打开一个应用程序/活动，您可以选择墙纸（底部有一个画廊视图）。我可以在 Android 源代码中找到此应用程序/活动的源代码（您能否将我指向文件位置或应用程序/活动特定路径的 github url）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T08:30:10.297

图片的壁纸选择器应该是启动器的以下部分

[`/packages/apps/Launcher2/../WallpaperChooserDialogFragment.java`](https://android.googlesource.com/platform/packages/apps/Launcher2/+/master/src/com/android/launcher2/WallpaperChooserDialogFragment.java)

还有与动态壁纸相关的软件包，例如这可能是动态壁纸的选择器。

[`/packages/wallpapers/LivePicker`](https://android.googlesource.com/platform/packages/wallpapers/LivePicker/+/master/)

# javascript - 在屏蔽域中强制更改 Windows 位置

> ID：13574797
> 
> 赞同：2
> 
> 时间：2012-11-26T23:13:02.853
> 
> 标签：javascript, iframe, hyperlink, forwarding

我们的客户有 2 个具有相同内容的网站，所以我们去掉了一个，并在其中一个域上使用了掩码转发，所以感觉两个网站都在那里。

然后，我们使用 JavaScript 进行了一次甜蜜的 try catch 来检查站点是否正在通过蒙版框架访问，以在 jQuery 中进行细微的美学更改。

```
try
{
if ( top.document.domain != self.document.domain );
}
catch(e)
{
// jQuery to change a few colors and positions.
} 
```

所有这一切都非常有效，除了**如果您想使用标题链接从站点的掩码版本转到实际域，它会失败，并迫使您留在掩码版本上**，无论我们使用哪种方法进行更改Windows 位置。

我知道我们可以通过不使用掩码转发来避免这种情况，并自定义 iframe 以使标头链接位于 iframe 之外。但我们宁愿不这样做，因为我们必须参与 IT 部门，他们不愿意做出改变。如果没有解决方案，我们显然会这样做。这是希望有一个！

链接到真实的工作站点：

蒙面域： http: [//mdpa.com/](http://mdpa.com/)

实际域名：[http ://worthe.com/](http://worthe.com/)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-06T21:14:53.113

您可以通过更改标题链接的目标来实现它。

```
target="_top" 
```

如果没有目标属性，则默认为 iframe。由于您使用的是 onclick 属性（这似乎没有必要），因此您也需要更改它。

```
window.top.location='something' 
```

从此更改实际域中的标头链接代码：

```
<a href="http://worthe.com" onclick="window.location='http://worthe.com'; return false;" class="logo" id="logo-worthe">Worthe Real Estate Group</a>
<a href="http://mdpa.com" onclick="window.location='http://mdpa.com'; return false;" class="logo" id="logo-mdpa">M. David Paul and Associates</a>
<a href="http://worthe.com" onclick="window.location='http://worthe.com'; return false;" class="logo" id="logo-krismar">Krismar Construction</a> 
```

对此：

```
<a href="http://worthe.com" onclick="window.top.location='http://worthe.com'; return false;" class="logo" id="logo-worthe" target="_top">Worthe Real Estate Group</a>
<a href="http://mdpa.com" onclick="window.top.location='http://mdpa.com'; return false;" class="logo" id="logo-mdpa" target="_top">M. David Paul and Associates</a>
<a href="http://worthe.com" onclick="window.top.location='http://worthe.com'; return false;" class="logo" id="logo-krismar" target="_top">Krismar Construction</a> 
```

# c++ - Boost asio——读写同时进行

> ID：13574798
> 
> 赞同：4
> 
> 时间：2012-11-26T23:13:05.917
> 
> 标签：c++, multithreading, thread-safety, boost-asio

我正在尝试使用 boost:asio 实现双向通信。我正在编写将与多个客户端通信的服务器。

我希望在没有任何同步和顺序的情况下对客户端进行写入和读取 - 客户端可以随时向服务器发送命令，并且它仍然会循环接收一些数据。当然，必须保护对共享资源的访问。

实现这一目标的最佳方法是什么？有两个线程 - 一个用于阅读，一个用于编写一个不错的选择吗？接受连接并管理许多客户端怎么样？

//编辑

通过“无同步和顺序”，我的意思是服务器应该始终将其数据流式传输给客户端，并且它可以随时响应（更改其行为）客户端请求，而不管现在发送给他们的是什么。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-27T00:09:46.067

asio 背后的一个关键思想就是您不需要多个线程来处理多个客户端会话。您的描述有点笼统，我不确定我是否理解您所说的“我希望在没有任何同步和顺序的情况下进行客户端的读写操作”是什么意思。

[asio聊天服务器](http://www.boost.org/doc/libs/1_52_0/doc/html/boost_asio/examples.html)示例是一个很好的起点。请注意，在此示例中，如何`chat_session`为每个连接的客户端创建该类的实例。只要连接处于活动状态，该类的对象就会继续发布异步读取，同时它们可以将数据写入连接的客户端。同时，类的对象`chat_server`不断接受新的传入客户端连接。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-03-09T20:42:36.213

在工作中，我们在做一些概念上非常相似的事情，在那里我注意到重型处理程序对性能的巨大影响。code/write handler的写端工作量太大，占用工作线程的时间过长，从而危及程序流程。尤其是 RST 数据包（关闭的连接）没有被读取处理程序足够快地检测到，因为写入操作占用了它们的甜蜜时间并占用了工作线程中的大部分处理时间。目前我通过创建两个工作线程来解决这个问题，这样一行代码就不会因为处理时间而变得匮乏。诚然，这远非理想，它在我冗长的待办优化列表中。

长话短说，如果您的处理程序是轻量级的，而第二个线程处理程序的其余部分，您可以使用单个线程进行读取和写入。一旦您注意到奇怪的同步问题，就该减轻您的网络处理程序或向工作池添加一个额外的线程了。

# eclipse - Groovy：无法解析类 org.apache.commons.lang.time.DateFormatUtils

> ID：13574799
> 
> 赞同：0
> 
> 时间：2012-11-26T23:13:07.620
> 
> 标签：eclipse, groovy

我在 Eclipse 中有一个 Groovy 脚本，并且在导入语句中得到以下信息：

```
Groovy:unable to resolve class org.apache.commons.lang.time.DateFormatUtils 
```

当我将外部 commons-lang-2.4.jar 添加到构建路径中的库时，错误消息消失了。但是，如果我删除它并添加包含此 jar 和其他 jar 的外部类文件夹，那么我会收到错误消息。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T04:46:41.653

尝试通过导航到`Preferences->Java Build Path->Libraries`并使用`add External JARs`. 我不相信 Eclipse 会在一个文件夹中提取各种 jar 文件进行编译 - 您可能需要明确每个 JAR，而且我认为它不支持`javac`这些天的命令行通配符。（有关对此的一些处理，以及一个可能有趣的插件，请参阅[此](https://stackoverflow.com/questions/8098911/eclipse-folder-with-jars-in-project)答案的各个方面）。

# java - 在黑杰克中检查双重下降

> ID：13574804
> 
> 赞同：0
> 
> 时间：2012-11-26T23:13:21.143
> 
> 标签：java

在二十一点游戏中，我提示用户选择是否要加倍下注：

```
while(true){
    if(players[i].doubledown == true){
        break;
    }
    System.out.println("Want to double down?\n1)Yes\n2)No\n");
    dd  = IO.readInt();
    if (dd != 1 && dd!= 2){
        IO.reportBadInput();
    }else{
        break;
    }
} 
int x = 0;
if (dd!=1 && players[i].doubledown == false){
    System.out.print("Choose your next move, " + players[i].name + ": \n" + "Points: " + players[i].points + "\n" + "Hint: ");
    getHints(players[i]);
    System.out.print( "\n1)Hit\n2)Stand\n");
    System.out.println();
    x = IO.readInt();
}else if(dd == 1 && players[i].doubledown == true){
    x = 2;
}else if( dd== 1 && players[i].doubledown == false){
    x = 1;
    players[i].doubledown = true;
}

if(x ==2 || x ==1){
    //
    //Stand or Bust
    //

} 
```

出于某种原因，它一直要求我加倍下注，然后轮到玩家 2。为什么？任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:34:41.807

`players[i].doubledown`如果是，此代码将始终要求玩家加倍下注`false`。您没有向我们展示您设置该标志的代码，所以我认为如果它一直询问您，它总是错误的。

如果您然后回答`1`，它将进入您的 if 语句的第 3 种情况，它不会打印任何内容，所以我认为这会轮到玩家 2。如果您回答`2`，它应该要求您击打或站立……会发生这种情况吗？

# html - IE9 不渲染元素的边框

> ID：13574811
> 
> 赞同：0
> 
> 时间：2012-11-26T23:14:02.707
> 
> 标签：html, css, internet-explorer-9

我对一些 CSS 和 IE9 有一个奇怪的问题。我不确定，但我敢打赌你是第一次看到它。

![示例图像](../Images/599c0264590ea92648747bb83fbe319c.png)

这三个图像都在`div`一个类中。这是该类的 CSS：

```
.imagen_pro{
    border: 1px solid #CCC;
    width: 180px; height:160px;
    text-align:center;
    background-color:#FFFFFF;
}

.imagen_pro img{
    max-width: 160px;
    max-height: 160px;
} 
```

在某些情况下会发生这种情况，我的意思是，并非在每个 IE9 中都会发生这种情况。我不知道发生了什么事。如果有人可以帮助我，我将不胜感激。

谢谢。

大家好，感谢您的回答。我发现发生了什么事。碰巧这个图像中的每一个都在一个锚标记内，并且随着那个 css 的 img 溢出，所以我不得不对 div 容器应用一些 css 并使 div 容器更高一点。还是非常感谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:09:23.587

我打赌图片的位置/尺寸不正确。它们大于你元素的最大尺寸（最大高度：160px；）。使用萤火虫，选择图片并调整它们的高度和位置。

我也看到你的代码有错误。你有两个：

> 宽度：180px；

和

> 最大宽度：160px；

这些是相互矛盾的陈述。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T13:52:56.870

我无法在我的 IE9 版本中重现您的问题。但是，我敢打赌，问题在于您的图像从容器的顶部或底部弹出，并被绘制在边框上。

尝试添加`overflow:hidden`到`.imagen_pro`班级。

或者

如果这不起作用，要么扩大高度`.imagen_pro`，比如 162px。

或者

将图像的最大高度更改为小 1 或 2 个像素。例如：

```
.imagen_pro img{
    max-width: 160px;
    max-height: 158px;
} 
```

# matlab - matlab统一重采样

> ID：13574813
> 
> 赞同：-2
> 
> 时间：2012-11-26T23:14:16.810
> 
> 标签：matlab, resampling

我有一个严重不平衡的数据集。我想使用原始数据集大小的 200% 执行统一重采样。

重采样功能似乎无法按我的预期执行。任何人都知道任何工具箱或功能可以执行此操作吗？谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T23:17:02.137

如果您想从大小为 N 的数据集中随机重新采样并替换，您可以使用`randi(N,1,N*2)`返回一个大小为 N*2 的向量，该向量由 1 到 N 之间的随机整数组成。然后使用该向量索引到您的原始矩阵。例如，

```
N = 100;
data = rand(1,N); % This simulates your original data set
idx  = randi(N, 1, N*2);
newData = data(idx); 
```

# java - 实体重新加载后仍然抛出 Hibernate 的 StaleObjectStateException

> ID：13574814
> 
> 赞同：1
> 
> 时间：2012-11-26T23:14:34.563
> 
> 标签：java, hibernate, session, optimistic-locking

我正在使用具有扩展会话/自动版本控制的标准乐观并发控制方案。我有一个实体，我在第一个事务中加载，呈现给用户进行修改并保存在第二个事务中，两个事务共享同一个会话。`session.flush()`在第二个事务结束时以某种方式修改实体之后`StaleObjectStateException`，如果检测到版本不一致，则可能会抛出一个错误，这意味着并发事务已在其间保存了实体的下一个版本。

我想以最简单的方式处理这样的错误——只是重新加载丢失当前更改的实体并继续编辑和保存。首先我尝试了这个：

```
session.refresh(entity); 
```

但是在我修改并尝试保存这个刷新的实体之后，我仍然得到相同的`StaleObjectStateException`结果，即使它确实被刷新并且版本号看起来是一致的；是的，我知道[不鼓励](http://docs.jboss.org/hibernate/core/4.1/javadocs/org/hibernate/Session.html#refresh%28java.lang.Object%29)`refresh()`在扩展会话中使用，但不明白为什么。这种行为是否与不鼓励它的原因有关？

接下来我尝试了以下方法来避免使用`session.refresh()`：

```
session.evict(entity);
entity = session.load(MyEntity.class, id); 
```

但它仍然会导致在`StaleObjectStateException`拯救确实不是陈旧的实体时被提升。

我设法应对异常的唯一方法是：

```
session.clear();
entity = session.load(MyEntity.class, id); 
```

但与我的具体实体不`session.clear()`一样吗？`session.evict()`

要恢复，我的问题是：

*   除非完成，否则为什么`StaleObjectStateException`仍然会在重新加载的实体上抛出`session.clear()`？
*   重新加载已在同一会话中加载的实体的正确方法是什么，为什么`refresh()`不好？这种实现对话的方法有问题吗？

我使用的是 Hibernate 4.1.7.Final，没有二级缓存。

如果我的问题重复，我很抱歉，但我找不到深刻的解释......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T07:37:08.133

当您在会话中遇到异常时，该会话实例就会被破坏。您不能再使用该实例，您必须将其丢弃并创建一个新实例。异常不会重置（如您所见，您再次得到相同的异常，逻辑上认为这不应该发生）。这是使用休眠会话的一般规则。这样做的原因是，hibernate 并不总是能看到为什么会出现异常，并且会话实例的状态可能不一致。

我不知道为什么它在 clear() 之后起作用。这可能是偶然的。使用新实例更为谨慎。

如果使用 StatelessSession，则没有此限制，但无状态会话还有其他缺点，例如没有缓存。

# objective-c - 模态中的 ABPersonViewController

> ID：13574818
> 
> 赞同：1
> 
> 时间：2012-11-26T23:14:49.293
> 
> 标签：objective-c, cocoa, abpersonviewcontroller

我想显示`ABPersonViewController`为模式而不是将其推送到导航堆栈上。我已经完成了这项工作，但是为了保持一个完成按钮存在，我不得不使用 NSTimer 每 0.25 秒添加一次按钮，因为完成按钮可能会在视图出现时被删除，并且在应用程序进入前台时总是被删除。这是一个非常蹩脚的黑客，所以我想知道是否有人有更好的主意:)

我创建了一个`ABPersonViewController`添加完成按钮的子类，并在视图加载时启动计时器，并在视图被释放时使其无效。

这是我的代码显示模态的样子：

```
- (IBAction)showContactModal:(id)sender{
    CNABPersonViewController *personViewController = [[CNABPersonViewController alloc] init];
    personViewController.displayedPerson = self.contact.record;
    personViewController.addressBook = [[CNAddressBookManager sharedManager] addressBook];
    personViewController.viewDelegate = self;
    personViewController.shouldShowLinkedPeople = YES;
    UINavigationController *navigationController =
    [[UINavigationController alloc] initWithRootViewController:personViewController];
    navigationController.modalPresentationStyle = UIModalPresentationFormSheet;     
    [self presentViewController:navigationController animated:YES completion:nil];
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-02T22:21:44.530

我成功地做到了这一点。插入此行以向导航栏添加一个按钮：

```
 personViewController.navigationItem.rightBarButtonItem = [[UIBarButtonItem alloc]initWithTitle:@"Test" style:UIBarButtonItemStylePlain target:self action:@selector(_yourAddressBookAction)]; 
```

如果这不能解决您的问题，请向我们展示您遇到问题的代码。

# regex - 删除 CR、LF、制表符——除了在 和

> ID：13574819
> 
> 赞同：0
> 
> 时间：2012-11-26T23:14:54.857
> 
> 标签：regex, preg-replace

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T01:23:45.917

我尝试使用正则表达式断言一段时间，但我认为这不可能，因为 PHP 似乎不允许我在前瞻/后瞻匹配中使用通配符。

**编辑** 前面的示例不能使用 pre & 代码中的嵌套元素。这将让您捕获要保留的间距，删除所有间距，然后将所需的间距放回：

```
//$html is your initial html string with line returns and spaces

//pattern to match open tag, inner content and closing tag
$pattern = '/<(pre|code)((?!<\/?\1).)*?<\/\1>/s';

//before: capture the string pattern of the multiline elements
preg_match_all($pattern, $html, $before);

//remove all LF, CR and indentation tabs
$html = preg_replace('/(\t|\r|\n)/s', '', $html);

//after: capture the string pattern of the condensed elements
preg_match_all($pattern, $html, $after);

//loop through the matches to replace the after with the before
foreach($after[0] as $k => $v){
    $html =  str_replace($v, $before[0][$k], $html);
} 
```

如果标签未正确关闭，它们将不适合匹配模式，因此将被跳过并去除间距。

# android - Is closing a database opened with window.openDatabase necessary?

> ID：13574820
> 
> 赞同：4
> 
> 时间：2012-11-26T23:14:59.227
> 
> 标签：android, sqlite, cordova

The code at the moment reads something in the order of...

```
DoAnything() {
  OpenTheDatabase()
  // ... Do all the things! ...
} 
```

However, the database object is never closed. This is worrisome.

The database is opened as follows:

```
var db = window.openDatabase( ... paramters ... ); 
```

No `.closeDatabase` function exists, or the documentation is incomplete. I thought the following might suffice:

```
db=null; 
```

I see that `sqlite3_close(sqlite3*)` and `int sqlite3_close_v2(sqlite3*)` exist, but I'm unsure how to apply them in this case.

How do I close the database, and is it necessary?

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-11-27T00:29:17.687

通常，您只有一个在应用启动时打开的数据库连接，并且无需在应用打开时关闭它。它是一个单线程、单用户应用程序，因此很多关于数据库连接的常规规则都不适用。

当应用程序关闭时，您可以依靠浏览器关闭所有内容 - 鉴于网络上的平均代码质量，浏览器必须非常擅长清理。

将 db 设置为 null 并让垃圾收集器完成它的工作可能也会起作用，但最好不要一开始就创建额外的对象。

# hadoop - How to write multiple outputs of different formats in a hadoop reducer?

> ID：13574821
> 
> 赞同：2
> 
> 时间：2012-11-26T23:15:05.843
> 
> 标签：hadoop, mapreduce, cassandra, reduce

How do you use the MultipleOutputs class in a reducer to write multiple outputs, each of which can have its own unique configuration? There is some documentation in the MultipleOutputs javadoc, but it seems limited to Text outputs. It turns out that MultipleOutputs can handle the output path, key class and value class of each output, but attempts to use output formats that require the use of other configuration properties fail.

(This question has come up several times but my attempts to answer it have been thwarted because the asker actually had a different problem. Since this question has taken more than a few days of investigation for me to answer, I'm answering my own question here as suggested by [this Meta Stack Overflow question](https://meta.stackexchange.com/questions/2706/posting-and-answering-questions-you-have-already-found-the-answer-to).)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:15:05.843

I've crawled through the MultipleOutputs implementation and have found that it doesn't support any OutputFormatType that has properties other than outputDir, key class and value class. I tried to write my own MultipleOutputs class, but that failed because it needs to call a private method somewhere in the Hadoop classes.

I'm left with only one workaround that seems to work in all cases and all combinations of output formats and configurations: Write subclasses of the OutputFormat classes that I want to use (these turn out to be reusable). These classes understand that other OutputFormats are in use concurrently and know how to store away their properties. The design exploits the fact that an OutputFormat can be configured with the context just before being asked for its RecordWriter.

I've got this to work with Cassandra's ColumnFamilyOutputFormat:

```
package com.myorg.hadoop.platform;

import org.apache.cassandra.hadoop.ColumnFamilyOutputFormat;
import org.apache.hadoop.conf.Configurable;
import org.apache.hadoop.conf.Configuration;

public abstract class ConcurrentColumnFamilyOutputFormat 
                        extends ColumnFamilyOutputFormat 
                        implements Configurable {

private static String[] propertyName = {
        "cassandra.output.keyspace" ,
        "cassandra.output.keyspace.username" ,
        "cassandra.output.keyspace.passwd" ,
        "cassandra.output.columnfamily" ,
        "cassandra.output.predicate",
        "cassandra.output.thrift.port" ,
        "cassandra.output.thrift.address" ,
        "cassandra.output.partitioner.class"
        };

private Configuration configuration;

public ConcurrentColumnFamilyOutputFormat() {
    super();
}

public Configuration getConf() {
    return configuration;
}

public void setConf(Configuration conf) {

    configuration = conf;

    String prefix = "multiple.outputs." + getMultiOutputName() + ".";

    for (int i = 0; i < propertyName.length; i++) {
        String property = prefix + propertyName[i];
        String value = conf.get(property);
        if (value != null) {
            conf.set(propertyName[i], value);
        }
    }

}

public void configure(Configuration conf) {

    String prefix = "multiple.outputs." + getMultiOutputName() + ".";

    for (int i = 0; i < propertyName.length; i++) {
        String property = prefix + propertyName[i];
        String value = conf.get(propertyName[i]);
        if (value != null) {
            conf.set(property, value);
        }
    }

}

public abstract String getMultiOutputName(); 
```

}

For each Cassandra (in this case) output you want for your reducer, you'd have a class:

```
package com.myorg.multioutput.ReadCrawled;

import com.myorg.hadoop.platform.ConcurrentColumnFamilyOutputFormat;

public class StrongOutputFormat extends ConcurrentColumnFamilyOutputFormat {

    public StrongOutputFormat() {
        super();
    }

    @Override
    public String getMultiOutputName() {
        return "Strong";
    }

} 
```

and you'd configure it in your mapper/reducer configuration class:

```
 // This is how you'd normally configure the ColumnFamilyOutputFormat

ConfigHelper.setOutputColumnFamily(job.getConfiguration(), "Partner", "Strong");
ConfigHelper.setOutputRpcPort(job.getConfiguration(), "9160");
ConfigHelper.setOutputInitialAddress(job.getConfiguration(), "localhost");
ConfigHelper.setOutputPartitioner(job.getConfiguration(), "org.apache.cassandra.dht.RandomPartitioner");

    // This is how you tell the MultipleOutput-aware OutputFormat that
    // it's time to save off the configuration so no other OutputFormat
    // steps all over it.

new StrongOutputFormat().configure(job.getConfiguration());

    // This is where we add the MultipleOutput-aware ColumnFamilyOutputFormat
    // to out set of outputs

MultipleOutputs.addNamedOutput(job, "Strong", StrongOutputFormat.class, ByteBuffer.class, List.class); 
```

Just to give another example, the MultipleOutput subclass for FileOutputFormat uses these properties:

```
 private static String[] propertyName = {
        "mapred.output.compression.type" ,
        "mapred.output.compression.codec" ,
        "mapred.output.compress" ,
        "mapred.output.dir"
        }; 
```

and would be implement just like `ConcurrentColumnFamilyOutputFormat` above except that it would use the above properties.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-28T14:49:39.200

我已经为 Cassandra 实现了 MultipleOutputs 支持（请参阅[此 JIRA 票证](https://issues.apache.org/jira/browse/CASSANDRA-4208)，它目前计划在 1.2 中发布。如果您现在需要它，您可以在票证中应用补丁。还可以查看有关该主题的[演示文稿](http://www.slideshare.net/rastrick/presentation-12982302)，其中提供了关于它的用法。

# google-chrome-extension - chrome 扩展创建窗口：alwaysOnTop

> ID：13574825
> 
> 赞同：2
> 
> 时间：2012-11-26T23:15:24.330
> 
> 标签：google-chrome-extension, window

根据该 API 定义： [https](https://developer.chrome.com/extensions/windows.html#type-Window) ://developer.chrome.com/extensions/windows.html#type-Window 窗口有一个名为“alwaysOnTop”的（新）属性（据我了解，这意味着即使用户点击某处在屏幕上的其他地方，这个窗口贴在前面，就像“谷歌聊天”一样）。

我不知道如何创建一个具有此属性的窗口（chrome.window.create() 在它获得的参数中不包含它）。我尝试了几种方法，比如使用创建获取和其他选项的函数，但没有一个奏效。控制台消息并没有帮助我弄清楚正确的方法是什么。

有人可以发布一个简短的例子来演示创建这样一个窗口吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T23:54:49.680

`alwaysOnTop`不是 的有效参数`chrome.windows.create`。

事实上，它在文档中被提及，但在[`Window`type](http://developer.chrome.com/extensions/windows.html#type-Window)下被监听，它描述了一个传递给许多`chrome.windows`API 方法回调的对象。

比较[`chrome.windows.create#createData`](http://developer.chrome.com/extensions/windows.html#property-create-createData)和[`Window`类型的属性](http://developer.chrome.com/extensions/windows.html#Window-properties)。

# sql - 在sql中使用列数据作为列标题

> ID：13574826
> 
> 赞同：2
> 
> 时间：2012-11-26T23:15:25.203
> 
> 标签：sql, database, sqlite

我有一个带有这样列标题的表：

```
p_id|s_id|value 
```

所以表格是这样的：

```
1|1|39
1|2|97
1|3|42 
```

第一列是`p_id`，第二列是`s_id`，第三列是`value`。

有大约 673 个不同的值`p_id`，大约有 6 个可能的值`s_id`，并且`value`是一个整数。每个 ( `p_id`, `s_id`) 对映射到 a `value`，每个有六个这样的值`p_id`（因为只有六个可能`s_id`的 's）。这里有些例子：

```
(p_id, s_id, value)
(1, 1, 238), (1, 2, 489), ... (1, 6, 391),
(2, 1, 380), (2, 2, 112), ... (2, 6, 402),
. . .
(673, 1, 371), (673, 2, 239), ... (673, 6, 230) 
```

所以这就是我想要作为输出的列标题：

```
p_id 1 2 3 4 5 6 
```

然后表格将填充“值”。

如何使用 SQL 语句执行此操作？我需要做一张新桌子吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:33:47.440

一个简单的 Case 语句将起作用。尝试这个：

```
SELECT    
    p_id, 
    MIN(CASE WHEN s_id = 1 THEN value END) AS [1], 
    MIN(CASE WHEN s_id = 2 THEN value END) AS [2], 
    MIN(CASE WHEN s_id = 3 THEN value END) AS [3], 
    MIN(CASE WHEN s_id = 4 THEN value END) AS [4],
    MIN(CASE WHEN s_id = 5 THEN value END) AS [5], 
    MIN(CASE WHEN s_id = 6 THEN value END) AS [6]
FROM        
    [TableName]
GROUP BY 
    p_id 
```

# javascript - JW Player 6 控制栏

> ID：13574828
> 
> 赞同：2
> 
> 时间：2012-11-26T23:15:41.410
> 
> 标签：javascript, jquery, jwplayer

JW player 6 控制栏有问题。问题是它总是在一段时间后隐藏起来，我需要它一直保持可见。jwplayer.js 中是否有控制栏或内置方法或属性的任何设置选项？自己找不到。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-05T13:00:42.513

JW Player 6 确实不支持始终显示控件。是否有特定的用例？鉴于所有 HTML5 浏览器都做同样的事情，这个 se

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-25T17:49:34.237

有点骇人听闻，可能会被核心更新所震撼，但我发现有点笨拙的 CSS 为我完成了这项工作。请注意，您必须为您的特定部署调整定位值。当控件出现时，您可以只观察 jwplayer 添加到元素的特定样式。

```
#yourid_controlbar {
    display:inline-block !important;
    opacity:1 !important;
}

#yourid_controlbar .jwgroup.jwcenter {
    left:105px !important;
    right:100px !important;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T00:15:33.510

尝试使用`controlbar.position(bottom)`- 控制栏的位置。可设置为bottom、top、over和none；或`controlbar.idlehide ( false )`强制它在播放模式下不隐藏。这应该适用于嵌入式视频，请在[此处](http://www.longtailvideo.com/support/jw-player/jw-player-for-flash-v5/12536/configuration-options#layout)查看完整的 api 列表。

**编辑**简要示例：

```
"player": {
  "modes": {
     "linear": {
        "controls": { "manage": false }
     }
  }
}, 
```

您可能还想查看这些[示例](http://www.longtailvideo.com/support/open-video-ads/22834/configuring-the-control-bar/)。

# excel - 在 VBA 中循环工作表时选择范围

> ID：13574830
> 
> 赞同：1
> 
> 时间：2012-11-26T23:15:55.203
> 
> 标签：excel, vba

出于问题的目的，我已经稍微缩短了我的代码，但我得到的错误是一样的。

当尝试在每个工作表上选择具有 A 列中数据的单元格并对其进行处理时，在第一个工作表之后出现错误：

```
Sub quickSub()

Dim sh As Worksheet

For Each sh In Worksheets
    sh.Range("A6", Range("A6").End(xlDown)).Select

''Random bits of code here where I manipulate selection on each worksheet

Next

End Sub 
```

我得到的错误是：

```
"Run-time error '1004': Method 'Range' of object'_Worksheet' failed. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-26T23:19:47.027

尝试这个：

```
sh.Activate
sh.Range("A6", "A" & sh.Range("A6").End(xlDown).row).Select 
```

我确保范围引用在右表上结束并且我让结束返回最后的行号并与可能不需要的列字母连接，但可能会让您更容易调试。

**更新：**

添加了激活线。选择可能需要工作表处于活动状态。

**更新2：**

这是不使用选择执行此操作的“正确”方法使用此方法直接引用工作表数据而不是需要逐个工作表移动工作表。此最佳实践将提高您的代码性能

```
Sub quickSub()

Dim sh As Worksheet

For Each sh In Worksheets
    With sh.Range("A6", "A" & sh.Range("A6").End(xlDown).row)
        '- lines that manipulate the 'selection' in the above with
        .Value = "NewValue"
        .font.bold = true

    End With

''Random bits of code here where I manipulate selection on each worksheet

Next

End Sub 
```

# php - cakephp 为确切日期创建查询

> ID：13574832
> 
> 赞同：0
> 
> 时间：2012-11-26T23:15:56.263
> 
> 标签：php, database, cakephp, model

试图弄清楚如何从数据库中查找在特定日期创建的所有记录，但我很难提出必要的条件。这是我到目前为止所拥有的：

```
$date = new DateTime('2012-11-25');
$users = $this->User->find('all', array('conditions' => array('User.created > ' => $date))); 
```

但这给我的不仅仅是指定的日子。如何调整条件以返回*仅*在 11 月 25 日创建的所有用户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:44:39.600

玩了一圈之后，我终于能够让它工作了。希望这可以帮助遇到相同情况的其他人：

```
$date = new DateTime('2012-11-25');
$users = $this->User->find('all', array('conditions' => CakeTime::dayAsSql($date, $date, 'User.created'))); 
```

关键是确保提供 $date 两次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:21:33.697

您的代码中有一个大于符号。

```
$users = $this->User->find('all', array('conditions' => array('User.created > ' => $date))); 
```

尝试不：

```
$users = $this->User->find('all', array('conditions' => array('User.created' => $date))); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:24:27.883

您应该为此使用 CakeTime 方法或手动断言您只检查这一特定日期的日期部分。

[http://book.cakephp.org/2.0/en/core-utility-libraries/time.html#CakeTime::dayAsSql](http://book.cakephp.org/2.0/en/core-utility-libraries/time.html#CakeTime::dayAsSql)

```
'conditions' => CakeTime::dayAsSql($date, 'created') 
```

# php - PHP 重载

> ID：13574834
> 
> 赞同：-2
> 
> 时间：2012-11-26T23:16:08.007
> 
> 标签：php, overloading

我已经创建了自己的框架来开发我的个人投资组合网站。我将它（非常）松散地基于我相当熟悉的 Zend Framework。除了在控制器中设置变量之外，我已经设法让事情正常工作，然后可以在 .phtml 文件中使用这些变量。这就是我目前所拥有的（例如，这里的 url 是 www.mydomain.com/services/hosting）：

前台.php

```
class front {
    private $sControllerName = 'home';
    private $sActionName = 'index';

    function __construct() {
        $this->view = new viewProperties();
        $aUriParts = $this->getUriParts();
        if (!empty($aUriParts[0])) {
            $this->sControllerName = $aUriParts[0];   
        }
        if (!empty($aUriParts[1])) {
            $this->sActionName = $aUriParts[1];   
        }
        $this->constructController();
        include('path/to/views/view.phtml');
    }

    private function constructController() {
        $sContFile = 'controllers/'.$this->sControllerName.'.php';
        if (@include($sContFile)) {
            $c = new $this->sControllerName();
            // Action method, if exists
            $this->doAction($c);
        }
    }

    public function getElement($name) {
        include('public_html/elements/'.$name);
    }

    public function renderContent() {
        $sViewFile = 'path/to/views/'.$this->sControllerName;
        if ($this->sActionName) {
            $sViewFile .= '/'.$this->sActionName.'.phtml';
        } else {
            $sViewFile .= '.php';
        }
        if (!@include($sViewFile)) {
            $this->render404();
        }
    }

    private function doAction($c) {
        $sActionFunc = str_replace('-', '_', $this->sActionName.'Action');
        if (method_exists($c,$sActionFunc)) {
            $c->$sActionFunc();
        }
    }

    private function render404() {
        include('path/to/views/404.phtml');
    }

    private function getUriParts() {
        $sUri = $_SERVER['REQUEST_URI'];
        $sUri = trim($sUri, "/");
        $sUri = str_replace("-", "_", $sUri);
        $aUriParts = explode("/", $sUri);
        return $aUriParts;
    }
} 
```

视图属性.php

```
class viewProperties {
    static $_instance = null;
    private $data = array();

    public static function getInstance() {
        if (null === self::$_instance) {
            self::$_instance = new self();
        }

        return self::$_instance;
    }

    public function __set($name, $value) {
        echo "Setting '$name' to '$value'\n";
        $this->data[$name] = $value;
    }

    public function __get($name) {
        echo "Getting '$name'\n";
        if (array_key_exists($name, $this->data)) {
            return $this->data[$name];
        }
    }

    public function __isset($name) {
        echo "Is '$name' set?\n";
        return isset($this->data[$name]);
    }

    public function __unset($name) {
        echo "Unsetting '$name'\n";
        unset($this->data[$name]);
    }
} 
```

服务.php

```
class services extends controller {
    public function indexAction() {
        $this->view->banner->src = '/path/to/images/banners/home_02.jpg';
        $this->view->banner->alt = 'banner title';
    }

    public function hostingAction() {
        $this->view->banner->src = '/path/to/images/banners/home_02.jpg';
        $this->view->banner->alt = 'banner title';
    }
} 
```

在hosting.phtml我有：

```
<img src="<?php echo $this->view->banner->src ?>" alt="<?php echo $this->view->banner->title ?>" /> 
```

如何在控制器中设置属性（不仅仅是横幅），然后在视图中检索它们？帮助/指导将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T00:01:53.297

由于您没有具体说明您遇到了什么问题，我将不得不从代码中猜测。

我猜您目前无法设置/检索横幅属性？

如果是这样，试试这个：

```
class services extends controller {
    public function indexAction() {
        $this->view->banner = array
        (
            'src' => '/path/to/images/banners/home_02.jpg',
            'alt' => 'banner title'
         );
    }

    public function hostingAction() {
        $this->view->banner = array
        (
            'src' => '/path/to/images/banners/home_02.jpg',
            'alt' => 'banner title'
        );
    }
}

<img src="<?php echo $this->view->banner['src'] ?>" alt="<?php echo $this->view->banner['title'] ?>" /> 
```

这是实现工作模型的简单修复，但不完全是您的目标。

要创建一个允许您通过“->”访问多个级别的动态变量，您可能需要创建一个`ViewElement`类型来包装结果赋值并提供 _* 方法。

在您的示例中，在通过检索它之前`banner`尚未实际创建（即`_set()`从未调用）`_get()`- 因此您的代码需要`_get()`在对不存在的值调用时自动创建一个值。

我还建议您的 ViewProperties 扩展 ViewElement 以减少重复代码。

这是我整理的东西（魔法在`__get()`）：

```
class viewProperties extends ViewElement {
    static $_instance = null;
    private $data = array ();
    public static function getInstance() {
        if (null === self::$_instance) {
            self::$_instance = new self ();
        }

        return self::$_instance;
    }
}
class ViewElement {
    private $data = array ();
    public function __set($name, $value) {
        echo "Setting '$name' to '$value'\n";
        $this->data [$name] = $value;
    }
    public function __get($name) {
        echo "Getting '$name'\n";
        if (! array_key_exists ( $name, $this->data )) {
            $this->data [$name] = new ViewElement();
        }
        return $this->data [$name];
    }
    public function __isset($name) {
        echo "Is '$name' set?\n";
        return isset ( $this->data [$name] );
    }
    public function __unset($name) {
        echo "Unsetting '$name'\n";
        unset ( $this->data [$name] );
    }
}

$view = viewProperties::getInstance();
$view->boo = "hoo";
$view->foo->bar = "baz";
print ("boo = '{$view->boo}', foo->bar='{$view->foo->bar}'"); 
```

[编辑] 胖手指并在完成之前提交。

[编辑] 用可能的解决方案扩展答案。

# c# - 确保域名只有英文字符的正则表达式

> ID：13574839
> 
> 赞同：0
> 
> 时间：2012-11-26T23:16:29.820
> 
> 标签：c#, asp.net, .net, regex, string

什么是一个好的、清晰的正则表达式来匹配一个必须包含的域名：

*   只有英文字母字符，加上数字
*   包括在域名中有效且可靠处理的空格或其他分隔符

澄清一下，这是为了验证域名。虽然互联网社区有支持域名国际化的举措，但我对此进行了相当多的研究并保持我的解释相当简单，只有包含现代英国英语字符集的字符的域名（包括数字）由域名系统 (DNS) 可靠地处理。我并不是要禁止国际化——我在职业生涯中做了很多相反的工作！

* * *

为了回答这个问题，我一直在寻找类似这样的东西（经过测试并且有效）。抱歉，最初的问题对我试图做的事情不够明确，但是我赞成帮助我向社区提供这个答案的建议：

^[\w- .]*$

*   '\w' = [a-zA-Z0-9_] 的简写
*   '- ' = 允许 '-', ' ', '.'
*   星号 = 前面的任何字符零次或多次

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:31:22.460

你可以使用这个：

```
(?i)[a-z0-9\p{Z}] 
```

`\p{Z}`“所有分隔符”类和`i`忽略大小写选项在哪里。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-11-26T23:49:55.220

您可以`[a-zA-Z\d\s\p{P}]+`用作最简单的解决方案。或者使用非 unicode 解决方案 >>

POSIX 定义了字符类`[:...:]`，但不是每个正则表达式引擎都支持它们。
但是可以使用替代集......

```
[:alnum:]   [A-Za-z0-9]                            Alphanumeric characters
[:space:]   [ \t\r\n\v\f]                          Whitespace   characters
[:punct:]   [\]\[!"#$%&'()*+,./:;<=>?@\^_`{|}~-]   Punctuation  characters 
```

所以把它们放在一起你会得到

```
^[A-Za-z0-9 \t\r\n\v\f\]\[!"#$%&'()*+,./:;<=>?@\^_`{|}~-]+$ 
```

通过这种方式，您可以看到要匹配的内容和不匹配的内容。请注意，某些字符被转义`\`为不转义，它们将具有不同的含义。

# html - 是否有命名 z-index 图层的标准约定？

> ID：13574841
> 
> 赞同：8
> 
> 时间：2012-11-26T23:16:47.157
> 
> 标签：html, sass

我想创建一些 sass 变量来表示不同的 z-index 值，如果存在的话，我想使用预先存在的命名约定。我正在寻找类似 Swing 如何定义`root`、`layered`、`content`和`glass`窗格 之类的东西，或者是指向一些我可以用作命名基础的理论的指针。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-08-14T15:00:34.887

在考虑了这一点之后，这是我们想出的（包装在 Sass 地图中）：

```
$z-index: (
  'satellite'           :       5000,
  'skyscraper'          :       1000,
  'tower-block'         :       500,
  'house'               :       200,
  'bungalow-chimney'    :       110,
  'bungalow'            :       100,
  'shed'                :       50,
  'postbox'             :       10,
  'curb'                :       1,
  'pavement'            :       0,
  'pothole'             :      -10,
  'ditch'               :      -20,
  'sewer'               :      -100,
  'mine'                :      -300,
  'seabed'              :      -1000
); 
```

然后像这样引用它：

```
.foo {
  z-index: map-get($z-index, 'pothole');
} 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-03T13:15:13.720

[http://en.wikipedia.org/wiki/Structure_of_the_Earth](http://en.wikipedia.org/wiki/Structure_of_the_Earth)？

外逸层 热层 中层 平流层 对流层 地壳 上地幔 地幔 外核 内核

对你来说够怪异了吗？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-07-14T10:41:43.670

我们需要维护项目封面、过滤栏、位置搜索模态、模态上方的自定义下拉菜单和网站导航的堆叠顺序，从下到上。我们可以设置一个 Sass 列表，如下所示：

```
$elements: project-covers, sorting-bar, modals, navigation; 
```

此列表表示我们希望元素出现的顺序，从最低到最高，数组中的每个索引或位置表示该元素的 z-index。我们可以使用 Sass 索引函数为每个元素分配一个 z-index 值。例如：

```
.project-cover {
   z-index: index($elements, project-covers);
} 
```

这将打印出：

```
.project-cover {
   z-index: 1;
} 
```

这是因为 project-cover 是列表中的第一个元素，位于索引 1 处，并且是我们的 z-index 堆叠顺序中的最低元素。让我们为列表中的其余项目编写 Sass：

```
.sorting-bar {
   z-index: index($elements, sorting-bar);
}
.modal {
   z-index: index($elements, modals);
}
.navigation {
   z-index: index($elements, navigation);
} 
```

现在，我们编译的 CSS 看起来像这样：

```
.project-cover {
   z-index: 1;
}
.sorting-bar {
   z-index: 2;
}
.modal {
   z-index: 3;
}
.navigation {
   z-index: 4;
} 
```

# module - 导入位于低于当前路径的路径中的 TypeScript 模块会引发范围错误

> ID：13574843
> 
> 赞同：5
> 
> 时间：2012-11-26T23:16:51.720
> 
> 标签：module, scope, typescript, amd

在尝试组合一个 AMD 友好的 TypeScript 应用程序框架时，我遇到了一个障碍：我似乎无法从当前路径下拉以在另一个目录中导入模块。我可以导入上面的模块，但下面会引发错误：

`TypeScript Error: The name ''../core/View'' does not exist in the current scope`

这是我的（非常基本的）应用程序的结构：

```
app/
 - core/
    - View.ts
 - views/
    - HomeView.ts
 - Application.ts 
```

在我的`Application.ts`文件中，我可以成功导入一个模块，如下所示：

```
import HomeView = module( 'views/HomeView' );

export class Application {
    constructor() {
        console.log( 'initializing Application' );
    }
} 
```

哪个，当使用 --module AMD 标志时，正确输出

```
define(["require", "exports", 'views/HomeView'], function(require, exports, __HomeView__) {
    var HomeView = __HomeView__;

    var Application = (function () {
        function Application() {
            console.log('initializing Application', HomeView);
        }
        return Application;
    })();
    exports.Application = Application;    
}) 
```

现在，问题是当我跳入`views/HomeView.js`并尝试导入我的`core/View`BaseClass 以从以下位置扩展时：

```
import View = module('../core/View');

export class HomeView {
    constructor() {
        console.log('Hello HomeView!');
    }
} 
```

这引发了这个完整的错误：

```
TypeScript Error: The name ''../core/View'' does not exist in the current scope
File: test/src/app/views/HomeView.ts
Start: 21, Length: 14

Line: import View = module('../core/View');
---------------------------^^^^^^^^^^^^^^-- 
```

这是编译器中的错误，还是我对模块导入的理解有误？为什么我可以导入`views/HomeView`，但不能`../core/View`？

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T09:39:40.050

我设法使用根路径让它工作 - 虽然我不能告诉你为什么你的相对路径不起作用。

```
import view = module("./app/core/View"); 
```

# windows-phone-7 - 序列化 PhoneApplicationPage Windows Phone

> ID：13574846
> 
> 赞同：1
> 
> 时间：2012-11-26T23:16:54.217
> 
> 标签：windows-phone-7, xml-serialization

我有一个名为“Conexion”的类，我将我的应用程序的所有信息保存在那里，当用户按下 Windows 键时，我希望它将类的对象保存到文件中，但是应用程序崩溃，因为它说 obect “delegado”在反映他的类型时存在问题。这个对象的类型是 "PhoneApplicationPage" ，好像不能序列化。该对象跟踪发出请求的页面。

所以我请求你帮助看看是否有解决方案，这不会让我重做应用程序，因为我没有时间。

这是我用来保存和加载数据的方法的代码。

```
public void save() {

            IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForApplication();
            IsolatedStorageFileStream stream = storage.CreateFile(fileName);
            DateTime currTime = DateTime.Now;
            this.timeOff = currTime.ToString();
            XmlSerializer xml = new XmlSerializer(this.GetType());
            xml.Serialize(stream, this);
            stream.Close();
            stream.Dispose();
    }

 public Conexion load() {

        IsolatedStorageFile storage = IsolatedStorageFile.GetUserStoreForApplication();
        Conexion conn;

        if (storage.FileExists(fileName))
        {
            IsolatedStorageFileStream stream = storage.OpenFile(fileName, System.IO.FileMode.Open);
            XmlSerializer xml = new XmlSerializer(typeof(Conexion));
            conn = xml.Deserialize(stream) as Conexion;
            stream.Close();
            DateTime currTime = DateTime.Now;
            DateTime checkTime = DateTime.Parse(timeOff).AddMinutes(lapso);
            if (DateTime.Compare(checkTime, currTime) >= 0)
            {
                Console.WriteLine("sesion valida");
            }
            else {
                conn.reseteaSingletonConexion();
            }
            stream.Dispose();
        }
        else
        {
            conn= new Conexion();
        }
        return conn;
    } 
```

提前致谢

编辑：

好吧，忽略对象“delegado”阻止了应用程序崩溃，但是现在，当我加载信息时，该对象无法反序列化，似乎它在同一个错误中标记了 2 个细节：

```
There is an error in XML document (2, 2).
Conexion cannot be serialized because it does not have a parameterless constructor. 
```

但该类确实有一个无参数的构造函数。

任何的想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:26:05.947

您可以`[XmlIgnore]`针对不会序列化的对象使用该属性（您可能不想序列化整个 XAML 页面。

将此属性放在`Conexion`类中的属性之上。例如，

```
public class Conexion
{
    public string MyPropertyToSerialize { get;set; }

    [XmlIgnore]
    public string MyPropertyToIgnore { get;set; }
} 
```

希望有帮助。

# jquery - 如何在 jQuery UI 对话框中加载页面

> ID：13574847
> 
> 赞同：2
> 
> 时间：2012-11-26T23:17:10.263
> 
> 标签：jquery, razor

我正在尝试在 jQuery 对话框中加载另一个页面。我已经看过很多文章（包括下面的文章）。似乎公认的技术是：

```
$(function () {
        $(document).ready(function () {
                var d1= $('#dialog-import').dialog({
                resizeable: false,
                height: 600,
                modal: true,
                autoOpen: false,
                buttons: {
                    'My button1': function () {
                        $(this).dialog('close');
                    },
                    Cancel: function () {
                        $(this).dialog('close');
                    }
                }
            });

            d1.load('/DataSets/ImportSpreadsheet/91D55CAC-6C2C-46EE-8730-0DBFE26D1D92').dialog('open'); 

        });
    }); 
```

这将打开对话框，包括完整的内容和我的两个对话框按钮，但是，这两个对话框按钮不起作用（我无法单击它们）。

代码的其他替代方案，例如：

```
 $('#dialog-import').load('/DataSets/ImportSpreadsheet/' + a, function () {
                $('#dialog-import').dialog('open');
            }); 
```

在 Google Developer Console 中导致此错误：

```
Uncaught TypeError: Object [object Object] has no method 'dialog' 
```

我一定错过了一些愚蠢的东西。但是，我真的一直在寻找它，没有任何运气。

谢谢。

这就是我想要做的，尝试了他们的建议但没有运气：

[jQuery 模态对话框 onclick](https://stackoverflow.com/questions/11989174/jquery-modal-dialog-onclick)

[jQuery中的对话框](https://stackoverflow.com/questions/1428896/dialog-in-jquery)

[如何使用 jquery ui 对话框加载页面](https://stackoverflow.com/questions/1608249/how-to-load-a-page-with-jquery-ui-dialog)

[在对话框中加载另一个页面](https://stackoverflow.com/questions/761467/load-another-page-in-the-dialog)

[Jquery 对话框打开另一个页面](https://stackoverflow.com/questions/2756283/jquery-dialog-to-open-another-page)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-28T02:02:11.197

事实证明，问题在于我试图加载一个包含标题、正文、html 元素的完整页面。jQuery 不喜欢这样。

我找到了两种可能的解决方案：

1.  使用 C# MVC 局部视图。确保局部视图不包含 header、html 等元素。使用原始问题中的代码可以正常工作。

2.  使用 iFrame 元素，并加载您要更改 src 属性的页面，如下面的代码所示。

    $('#selector').click(function () {
    $('#dialog-import').attr('src','/DataSets/ImportSpreadsheet/...'); $('#dialog-import' ).dialog('open');
    });

尽管如此，我还是对这么多人说他们不必担心标题/正文标签感到困惑，就像这个帖子隐含地说：[ASP.NET Mvc jquery ui dialog as view or partialview？](https://stackoverflow.com/questions/11363749/asp-net-mvc-jquery-ui-dialog-as-view-or-partialview)

我将继续研究，但遇到我同样问题的人可能会发现这很有用。

# jquery - jQuery Autocomplete - 显示焦点值列表

> ID：13574849
> 
> 赞同：2
> 
> 时间：2012-11-26T23:17:23.450
> 
> 标签：jquery, autocomplete, jquery-autocomplete, jquery-ui-autocomplete

我将[自动完成](http://api.jqueryui.com/autocomplete/)用于一小组值。我希望当用户关注输入框（使用键盘或鼠标）时立即显示“自动完成”源值，而不是等待他们输入。

如何让源值在焦点后立即显示？

谢谢你，

```
 $("#cityInput").autocomplete({
            minLength: 0, // With not that many cities, require at no characters before showing autocomplete
            source: getJson(),
            // plug-in to the select event in order to keep KnockOut informed about the 
        }); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T11:22:32.810

您可以通过在其“焦点”事件上调用自动完成的“搜索”方法来做到这一点，检查这个[JQFAQ.com](http://jqfaq.com/how-to-display-autocomplete-menu-on-focus-with-all-items/)主题，它说明了如何做到这一点。很少有其他有趣的与自动完成相关的常见问题解答，可能对您有所帮助。

# hosting - GoDaddy 多个网站托管在专用服务器问题上

> ID：13574850
> 
> 赞同：0
> 
> 时间：2012-11-26T23:17:25.800
> 
> 标签：hosting

我正在使用我朋友的专用服务器托管他的 2 个网站来托管我自己的网站，但我不熟悉注册域，并且我无法让我的域指向我使用的特定端口，以便我的网站不与他的冲突。他有2个网站，根据IIS使用相同的端口，我安装了XAMPP所以我不得不使用8080端口，他如何为托管在同一端口下的同一ip上的网站注册两个不同的域？以及如何将我的域指向我的 8080 端口？（使用阿帕奇）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:18:59.373

You need to use host headers to prevent conflicts if you're sharing the same IP, else you need your own IP. With the appropriate dns settings, and host headers setup in iis, you'll never conflict with his sites (that should also be using host headers).

# jquery - switchClass，删除所有类

> ID：13574856
> 
> 赞同：1
> 
> 时间：2012-11-26T23:18:22.093
> 
> 标签：jquery, jquery-ui

我正在尝试使用 jquery ui switchClass 方法。现在它是这样工作的：

```
$("#top_section").switchClass( "top_section", "pt_figures", 300); 
```

我想将其更改为，而不是仅删除`top_section`，我想删除所有类，然后添加`pt_figures`.

它在这里工作：

```
$("#close_icon").click(function() {
$("#top_section").removeClass();
$("#top_section").addClass( "top_section", 300);

setTimeout(function() {
  $('#images').empty();
}, 350);

}); 
```

但不是在这里：

```
$("#pt_figures").click(function() {

$('#images').empty();

$('#images').css({
  paddingLeft: 150,
  paddingRight: 0
});
$('#controls').css({
  width:700,
  marginLeft:150
});
$('#info').css({
  width:660,
  marginLeft:150
});

var id = $(this).attr('id');

$("#info_header").load(id +"_header.txt");
$("#content_1").load(id +"_1.txt");
$("#content_2").load(id +"_2.txt");
$("#content_3").load(id +"_3.txt");

$("<img>", { src: "http://www.klossal.com/figures_doc.jpg" }).appendTo("#images"); 
$("<img>", { src: "http://www.klossal.com/figure_front.png" }).appendTo("#images"); 
$("<img>", { src: "http://www.klossal.com/figure_back.jpg" }).appendTo("#images");

$('html, body').animate({
  scrollTop: 0
}, 300);

$("#top_section").removeClass();
$("#top_section").addClass( "pt_figures", 300);

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:28:10.723

尝试删除所有课程，添加您要切换出的课程，然后将其切换为您想要的课程：

```
 $(#top_section).removeClass();
    $(#top_section).addClass('top_section');
    $(#top_section).switchClass('top_section', 'pt_figures', 300); 
```

[演示](http://jsfiddle.net/eybxf/)

# android - Android Widget：预览图像大小

> ID：13574860
> 
> 赞同：15
> 
> 时间：2012-11-26T23:18:37.830
> 
> 标签：android, widget

我在 Android 中有一个小部件，我正在为其设置预览图像。不幸的是，我在确定小部件的合适尺寸时遇到了问题：如果它太大，它会在框架底部被裁剪。

我一直在尝试找到推荐的尺寸，甚至更好的是显示预览图像的帧的像素尺寸，但我在文档中找不到它。

请问有人知道在哪里可以找到这些信息吗？

谢谢你。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-26T23:47:54.063

模拟器有一个应用程序，用于创建大小合适的预览：

[http://developer.android.com/guide/topics/appwidgets/index.html#preview](http://developer.android.com/guide/topics/appwidgets/index.html#preview)

我的建议是使用该应用程序获取小部件的 previewImage，然后查看大小。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-14T18:12:38.700

根据我的测试，小部件预览已连接到小部件 XML 文件。

**小部件 1x1 的小部件预览：**

图片尺寸：宽=138像素，高=138像素

xml文件定义：android:minHeight="50dp", android:minWidth="50dp"

**小部件 2x1 的小部件预览：**

图片尺寸：宽=236像素，高=138像素

xml文件定义：android:minHeight="50dp", android:minWidth="120dp"

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2013-10-08T12:46:03.897

我建议您的预览大小应直接反映小部件的“默认”大小。

根据 Android 网站：http: [//developer.android.com/guide/practices/ui_guidelines/widget_design.html](http://developer.android.com/guide/practices/ui_guidelines/widget_design.html)

它给出了多个小部件“单元格”大小的指南：（`70dp × n − 30dp`其中 n 是单元格计数）

因此，例如，2x1 单元小部件将是：`110x40`和`165x60`MDPI `220x80`、HDPI 和 XHDPI。

不过从经验来看，我还没有设法 100% 确认这一点，在 XXHDPI 设备（Nexus 10 等）上，随着单元格尺寸变大，这条规则不再相关。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-09-15T18:09:34.437

由于网络上几乎没有关于此主题的内容，并且这里没有明确的答案，因此以下是我的一些观察：

*   应用程序肯定会从 mdpi、hdpi 和 xhdpi 文件夹中绘制图像，因此为这些文件夹设置不同的分辨率可能是有意义的
*   我认为将像素分辨率附加到单元格大小是没有意义的 - 所有小部件都有相同的空间
*   根据之前的观察，Google 使用 201 垂直尺寸作为其部件预览，如此处所述，将其用于垂直分辨率并将其与单元格比率相乘以获得水平分辨率是有意义的。可能有一些水平值高于你应该做相反的事情（从水平计算垂直分辨率），但现在最好猜测它......
*   直接使用模拟器中的 Widget 预览中的图像并不总是一个好主意（尽管这个函数在我的模拟器上会产生错误）。如果预览占据大部分图像通常会更好，因此图像上不应有填充。我认为谷歌使用它来使其数字时钟预览变得更大。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-11-20T13:28:24.227

Gmail 应用程序在 drawable-nodpi-v4 中有一个 png，大小为 638x504。

# linux - 文件命令 108k 文件：参数太多

> ID：13574868
> 
> 赞同：0
> 
> 时间：2012-11-26T23:19:23.180
> 
> 标签：linux, file, find, ksh

我有一个目录，里面有 108k 个文件。我在 RHEL5 上使用 KSH shell

```
ls *
-dash_bin_ksh: ls: /bin/ls: cannot execute [Argument list too long] 
```

唯一似乎有效的命令是 find 命令。

```
find .
file 1
file 2 
file n 
```

我尝试使用 find 和 then exec 选项来运行文件命令，但我没有得到任何结果。

```
find . -exec file {}
find: missing argument to `-exec' 
```

我错过了什么？我只想在此目录中的每个文件上运行 file 命令并输出到 file_output.txt

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-11-26T23:32:32.253

对于 find 的 exec，你必须用 with 结束参数`\;`

你也可以试试：

```
find . -print0 | xargs -0 file 
```

xargs 的工作原理是将其 STDIN 并将每个元素（行或分隔字符串）作为参数添加到给定的可执行文件中，以尽可能少地执行。参数列表由 --max-chars（取决于平台，最大 128Kib）分成组以供执行。

`-print0`添加空字符而不是新行，这使得带有空格的文件名安全。`-0`on`xargs`用于识别空字符。

`-print0`并且`-0`是 GNU 扩展，可以在非 GNU 环境中放弃，但以牺牲多功能性为代价。

xargs 还有一个`-I`选项，使它更像`find -exec`是为每个元素运行可执行文件的位置。

感谢@glennjackman 对这个主题的深入了解。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:33:07.737

`\;`在命令末尾添加 a ，例如`find . -exec file {} \;`

# jquery - Ajax 刷新删除新添加的类

> ID：13574872
> 
> 赞同：0
> 
> 时间：2012-11-26T23:19:38.497
> 
> 标签：jquery, ajax

我有一个每 x 秒自动刷新一次的喊话框：

```
var refreshIntervalId = null;
var ref = $.cookie('refresh');

    // refresh the shoutbox every x seconds (x is defined by the cookie)
    refreshIntervalId = setInterval(function () {
        shoutbox.load('ajax.php');
    }, ref); 
```

我添加了一个选项，通过添加另一个类来删除交替的行颜色：

```
$('.row:nth-child(odd)').addClass('alt'); 
```

问题是每当刷新发生时，添加的新类就会被删除。

有没有办法阻止班级被删除？

**编辑**：忘记添加，如果存在 cookie，则添加类，如果不存在，则删除该类。

**已解决：我必须将以下内容添加到ajax.php**：

```
if ($.cookie('alt') === 'No') {
    $('.row:nth-child(odd)').addClass('alt');
}

if ($.cookie('alt') === 'Yes') {
    $('.row:nth-child(odd)').removeClass('alt');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:38:13.770

Figured it out. I had to add the script to ajax.php.

# jquery - Jquery检测无线电组然后验证

> ID：13574874
> 
> 赞同：0
> 
> 时间：2012-11-26T23:19:47.813
> 
> 标签：jquery, validation, foreach, radio

我搜索了论坛、谷歌和堆栈 - 无济于事。

基本上，客户端在我们的页面上生成单选按钮，我们需要验证它们。每个 Radio 组使用相同的名称（即 TM_Offer_0056），每个名称都有一个 YES 和 NO 选项。

我如何对每个 NAME 进行分组，并确保选中其中一个。

我能够检测到所有单选按钮，但无法对它们进行分组和验证。

```
 $(":radio").each(function() {   
  var radioName = this.name;

  if ($('input[name='+ radioName +']:checked').length) {
      //button was checked
  }
  else {
       // no radio button was checked
        strErrorMsg +="Please Select an Option for "+this.name+"\n";
  }//end check

  });

if (strErrorMsg==""){
//validation passed, do something
}else{
alert(strErrorMsg);
return false;
} 
```

该代码在最后提醒每个按钮都没有被选中。我只需要每个组名检查一个收音机。每组都有不同的名称，所以我只需要检测复选框的所有名称，将它们分组为 2，并确保选中其中的 1。

多谢你们，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:16:22.933

为什么不首先获取所有唯一的复选框名称并将它们存储在数组或 json 中，然后为每个名称尝试查看单选按钮是否被选中？

# c - 在linux中使用计时器记录指标

> ID：13574881
> 
> 赞同：1
> 
> 时间：2012-11-26T23:20:15.803
> 
> 标签：c, linux

我需要捕获一些指标，例如发送 tcp 消息的时间和 linux 上 c 中每秒发送的消息数。我想知道这是否可以通过计时器来完成，这样每当计时器到期时，我只需打印指标。主要问题是在增加指标时可能会发生计时器，在这种情况下，我的信号处理程序将打印损坏的数据。有没有办法解决这个问题？

所以我脑海中的伪代码是声明一个全局结构，其中包含每次发送和计数的发送时间。

```
struct db
{
 struct sendTimes sendTimesPerSecond[10000]; // some large number which i cannot send in a second
 int count;
} 
```

在哪里

```
struct sendTimes
{
  timeval start_time;
  timeval end_time;
} 
```

然后提供一些可以在 struct db 上工作的函数，例如

```
void record_send_time(pointer_to_db, sendTimes); // simply store the times
void incrementMessagesSent(pointer_to_db); //basically count++ 
```

然后我可以做类似的事情： -

```
signal(SIGALRM, alarm_handler);
alarm(1)
struct db database;

for(;;) {
struct sendTimes sTime;
sTime.start_time = now(); // current time
send()
sTime.end_time = now();
record_send_time(&database, sTime);
incrementMessagesSent(&database); 
}

void alarm_handler(int signo)
{
  printf database;
  alarm(1);
 } 
```

更新：关于管道的 Wildplasser 评论似乎是处理上述问题的最安全方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T01:05:12.903

使用我们的程序在用户（您的代码）和内核模式（发送等）中使用了`getrusage(2)`两个捕获时间。`struct timeval`

```
#include <sys/time.h>
#include <sys/resource.h> 
```

.

```
struct rusage start, end;
getrusage(RUSAGE_SELF, &start);
// do what you have to do
getrusage(RUSAGE_SELF, &end);

struct timeval utime, stime;
timersub(&end.ru_utime, &start.ru_utime, &utime);
timersub(&end.ru_stime, &start.ru_stime, &stime);
printf("Work took %lu microseconds of user time and %lu microseconds of system time\n",
     (utime.tv_sec * 1000 * 1000) + utime.tv_usec,
     (stime.tv_sec * 1000 * 1000) + stime.tv_usec
     ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:54:35.543

您可以使用 alarm_handler 设置标志，而不是从信号处理程序中打印。

```
int print_database_flag = 0; // global flag

  // ...
  record_send_time(&database, sTime);
  if (print_database_flag) {
     printf database;
     print_database_flag = 0;
  }

void alarm_handler(int signo)
{
  print_database_flag = 1;
  alarm(1);
} 
```

# javascript - 每 x 秒多个 XmlHttpRequests

> ID：13574882
> 
> 赞同：0
> 
> 时间：2012-11-26T23:20:15.840
> 
> 标签：javascript, xmlhttprequest, settimeout, setinterval

我需要一些关于我正在编写的代码的帮助。我的代码会触发三个异步请求并更新我页面上的一些内容。我希望这些请求每 X 秒触发一次。我见过几个这样的问题，[如何安排每 N 秒一次的 ajax 调用？](https://stackoverflow.com/questions/1350446/how-to-schedule-ajax-calls-every-n-seconds)关于 setTimeout 或 setInterval，但问题是我需要每 x 秒触发一次每个请求..而我唯一能想到的 setInterval / settimeout 不会计算每个调用的单独时间，而是一次..实例

> 如果我在 00.00.01 有 xhr1，在 00.00.02 有 xhr2，在 00.00.03 有 xhr3

下一个呼叫最好在每个 20 秒后进行？

> xhr1 00.00.21 xhr2 00.00.22 xhr3 00.00.23
> 
> xhr1 00.00.41 xhr2 00.00.32 xhr3 00.00.33

我当前的代码也是这样编写的，即在使用回调函数接收到先前的响应后触发每个 xhr

```
function request(url, callback){
....
asychronous request
....
callback(responseText);
}

request(url1, function(){
some code
}
request(url2, function(){
some code
}
request(url3, function(){
some code
} 
```

如果对这三个电话也提出了另一种方法，我想知道..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T00:35:12.467

由于这是一个复杂的场景，我建议您查看[promises](http://blogs.msdn.com/b/ie/archive/2011/09/11/asynchronous-programming-in-javascript-with-promises.aspx)。这不是一个简单的概念，但它可以让您在链接需求和回调之间保持清晰的关注点分离。

如果没有承诺，您需要在回调中包含下一个 xhr 调用。

Promise 包含在 jQuery 或 Dojo 等 JavaScript 库中。

一个更简单的场景是忘记链接请求：

```
function allRequests(){
request(url1, function(){some code});
// url2 one second later
setTimeout(function(){request(url2, function(){some code});},1000);
// url3 one more second later
setTimeout(function(){request(url3, function(){some code});},2000);
}
// run the 3 requests every 20 seconds
setInterval(allRequests(),20000); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-27T01:15:24.337

一些选项是：

同时执行所有三个请求。有没有理由不能同时完成所有三个请求？

```
setInterval( allRequests, 20000 );

function allRequests() {
   requestOne();
   requestTwo();
   requestThree();
} 
```

或者使用前一个请求的成功函数链接您的请求。

```
setTimeout( requestOne, 5000 );

function requestOne() {
   // do request blah blah
   setTimeout( requestTwo, 5000 );
}

function requestTwo() {
   // do request blah blah
   setTimeout( requestOne, 5000 ); // loops back to first request
} 
```

或者在开始时用超时错开您的请求。

```
setInterval( requestOne, 20000 ); // set first interval to start now
setTimeout( function() {
   setInterval( requestTwo, 20000 ); // set second interval to start one second from now
}, 1000 );
setTimeout( function() {
   setInterval( requestThree, 20000 ); // set third interval to start two seconds from now
}, 2000 ); 
```

# java - Java 计算器版本 4

> ID：13574883
> 
> 赞同：1
> 
> 时间：2012-11-26T23:20:15.787
> 
> 标签：java, calculator, rpn, shunting-yard

计算器现在几乎可以工作了。它现在给我读取的每个方程式都给出了相同的答案？

输出结束为：49 + 62 * 61-36 15.666666666666668 4/64 15.666666666666668（53 + 26）15.666666666666668 0 * 72 15.666666666666668 21-85 + 75-85 15.666666666666668 90 * 76-50 + 67 15.666666666666668 46 * 89-15 15.666666666666668 34/83-38 15.666666666666668 20/76/14+92-15 15.666666666666668 5*10/3-1 15.666666666666668

而不是那里有每个方程的答案？

我在我的方法中遗漏了什么吗？

谢谢

所有代码如下所示。任何帮助都感激不尽。

堆栈类：

```
 import java.util.Iterator;
 import java.util.NoSuchElementException;

public class myStack<Item> implements Iterable<Item> {
private int N; // size of the stack
private Node first; // top of stack

private class Node {
    private Item item;
    private Node next;
}

/**
 * Create an empty stack.
 */
public myStack() {
    first = null;
    N = 0;
    assert check();
}

public boolean isEmpty() {
    return first == null;
}

public int size() {
    return N;
}

public void push(Item item) {
    Node oldfirst = first;
    first = new Node();
    first.item = item;
    first.next = oldfirst;
    N++;
    assert check();
}

public Item pop() {
    if (isEmpty())
        throw new NoSuchElementException("Stack underflow");
    Item item = first.item; // save item to return
    first = first.next; // delete first node
    N--;
    assert check();
    return item; // return the saved item
}

public Item peek() {
    if (isEmpty())
        throw new NoSuchElementException("Stack underflow");
    return first.item;
}

public String toString() {
    StringBuilder s = new StringBuilder();
    for (Item item : this)
        s.append(item + " ");
    return s.toString();
}

// check internal invariants
private boolean check() {
    if (N == 0) {
        if (first != null)
            return false;
    } else if (N == 1) {
        if (first == null)
            return false;
        if (first.next != null)
            return false;
    } else {
        if (first.next == null)
            return false;
    }

    // check internal consistency of instance variable N
    int numberOfNodes = 0;
    for (Node x = first; x != null; x = x.next) {
        numberOfNodes++;
    }
    if (numberOfNodes != N)
        return false;

    return true;
}

public Object[] toArray(String[] elementData) {
    return (Object[]) elementData.clone();
}

public Iterator<Item> iterator() {
    return new ListIterator();
}

// did not implement remove as it was not needed
private class ListIterator implements Iterator<Item> {
    private Node current = first;

    public boolean hasNext() {
        return current != null;
    }

    public void remove() {
        throw new UnsupportedOperationException();
    }

    public Item next() {
        if (!hasNext())
            throw new NoSuchElementException();
        Item item = current.item;
        current = current.next;
        return item;
    }
}
} 
```

数组列表类

```
import java.util.Arrays;

public class myArrayList<Item>{

private Object[] myStore;
private int actSize = 0;

public myArrayList() {
    myStore = new Object[100];
}

public Object get(int index) {
    if (index < actSize) {
        return myStore[index];
    } else {
        throw new ArrayIndexOutOfBoundsException();
    }
}
public void add(Object obj) {
    if (myStore.length - actSize <= 0) {
        increaseListSize();
    }
    myStore[actSize++] = obj;
}

public Object remove(int index) {
    if (index < actSize) {
        Object obj = myStore[index];
        myStore[index] = null;
        int tmp = index;
        while (tmp < actSize) {
            myStore[tmp] = myStore[tmp + 1];
            myStore[tmp + 1] = null;
            tmp++;
        }
        actSize--;
        return obj;
    } else {
        throw new ArrayIndexOutOfBoundsException();
    }

}

public int size() {
    return actSize;
}

private void increaseListSize() {
    myStore = Arrays.copyOf(myStore, myStore.length * 2);
}

@SuppressWarnings("unchecked")
public <T> T[] toArray(T[] a) {
    if (a.length < size())
        // Make a new array of a's runtime type, but my contents:
        return (T[]) Arrays.copyOf(myStore, size(), a.getClass());
    System.arraycopy(myStore, 0, a, 0, size());
    if (a.length > size())
        a[size()] = null;
    return a;
}

} 
```

方程处理的 TestClass

```
import java.io.BufferedReader;
import java.io.File;
import java.io.FileReader;
import java.io.IOException;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Map;
 import java.util.StringTokenizer;

public class TestClass {

private static final int LEFT_ASSOC = 0;
private static final int RIGHT_ASSOC = 1;
static String OPERATORS1 = "+-*/()";

// Operators
private static final Map<String, int[]> OPERATORS = new HashMap<String, int[]>();
static {
    // Map<"token", []{precedence, associativity}>
    OPERATORS.put("+", new int[] { 0, LEFT_ASSOC });
    OPERATORS.put("-", new int[] { 0, LEFT_ASSOC });
    OPERATORS.put("*", new int[] { 5, LEFT_ASSOC });
    OPERATORS.put("/", new int[] { 5, LEFT_ASSOC });
    OPERATORS.put("(", new int[] {1, LEFT_ASSOC});
    OPERATORS.put(")", new int[] {1, LEFT_ASSOC});
}

private static boolean isOperator(String token) {
    return OPERATORS.containsKey(token);
}

// Test associativity of operator token
private static boolean isAssociative(String token, int type) {
    if (!isOperator(token)) {
        throw new IllegalArgumentException("Invalid token: " + token);
    }

    if (OPERATORS.get(token)[1] == type) {
        return true;
    }
    return false;
}

// Compare precedence of operators.
private static final int cmpPrecedence(String token1, String token2) {
    if (!isOperator(token1) || !isOperator(token2)) {
        throw new IllegalArgumentException("Invalid tokens: " + token1
                + " " + token2);
    }
    return OPERATORS.get(token1)[0] - OPERATORS.get(token2)[0];
}

public static String[] infixToRPN(String[] inputTokens) {
    myArrayList<String> out = new myArrayList<String>();
    myStack<String> stack = new myStack<String>();
    // For each token
    for (String token : inputTokens) {
        StringTokenizer tokens = new StringTokenizer(token,OPERATORS1,true);
        while (tokens.hasMoreTokens()) {
            token = tokens.nextToken();

            // If token is an operator
            if (isOperator(token)) {
                // While stack not empty AND stack top element
                // is an operator
                while (!stack.isEmpty() && isOperator(stack.peek())) {
                    if ((isAssociative(token, LEFT_ASSOC) && cmpPrecedence(
                            token, stack.peek()) <= 0)
                            || (isAssociative(token, RIGHT_ASSOC) && cmpPrecedence(
                                    token, stack.peek()) < 0)) {
                        out.add(stack.pop());
                        continue;
                    }
                    break;
                }
                // Push the new operator on the stack
                stack.push(token);
            }
            // If token is a left bracket '('
            else if (token.equals("(")) {
                stack.push(token); 
            }
            // If token is a right bracket ')'
            else if (token.equals(")")) {
                while (!stack.isEmpty() && !stack.peek().equals("(")) {
                    out.add(stack.pop());
                }
                stack.pop();
            }
            // If token is a number
            else {
                out.add(token);
            }
        }
        while (!stack.isEmpty()) {
            out.add(stack.pop());
        }
    }
    String[] output = new String[out.size()];
    return out.toArray(output);
}

public static double RPNtoDouble(String[] tokens) {
    myStack<String> stack = new myStack<String>();

    // For each token

    for (String token : tokens) {
        //System.out.println( "Working this token: " + token );
        // If the token is a value push it onto the stack
        if (!isOperator(token)) {
            stack.push(token);
        } else {
            // Token is an operator: pop top two entries
            Double d2 = Double.valueOf(stack.pop());
            Double d1 = Double.valueOf(stack.pop());

            // Get the result
            Double result = token.compareTo("+") == 0 ? d1 + d2 : token
                    .compareTo("-") == 0 ? d1 - d2
                            : token.compareTo("*") == 0 ? d1 * d2 : d1 / d2;

            // Push result onto stack
            stack.push(String.valueOf(result));
        }
    }

    return Double.valueOf(stack.pop());
}

static public void main(String[] args) throws IOException {
    File file = new File("testEquations.txt");
    String[] lines = new String[1];

    try {
        FileReader reader = new FileReader(file);
        @SuppressWarnings("resource")
        BufferedReader buffReader = new BufferedReader(reader);
        int x = 0;
        String s;
        while ((s = buffReader.readLine()) != null) {
            lines[x] = s;
            x++;
        }
    } catch (IOException e) {
        System.exit(0);
    }
    // test printing string array
    for (String s : lines) {
        System.out.println("" + s);
        String[] output =infixToRPN(lines);
        System.out.println(RPNtoDouble(output));

    }

}

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:26:55.670

你的问题在这里：

```
String[] lines = new String[1];

    try {
        FileReader reader = new FileReader(file);
        @SuppressWarnings("resource")
        BufferedReader buffReader = new BufferedReader(reader);
        int x = 0;
        String s;
        while ((s = buffReader.readLine()) != null) {
            lines[x] = s;
            x++;
        }
        ... 
```

您定义了 size = 1 的字符串数组，但是如果 x 超出了该数组的边界，则不检查循环内部。

做一些这样的想法：

```
int Size = // define the size..;
String[] lines = new String[Size];
...
while (x < Size && (s = buffReader.readLine()) != null)) {
            lines[x] = s;
            x++;
        } 
```

当您的 x 变得大于 Size 时，`x < Size`将评估为 false，从而退出循环。

关于您收到**ArrayIndexOutOfBoundsException**的错误之一：

> 抛出以指示已使用非法索引访问数组。索引为负数或大于或等于数组的大小。（[来源](http://docs.oracle.com/javase/1.4.2/docs/api/java/lang/ArrayIndexOutOfBoundsException.html)）

另一个错误**NoSuchElementException**：

> [由 Enumeration 的 nextElement 方法引发，以指示枚举 ( source](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/NoSuchElementException.html) )中没有更多元素。

另一个问题在这里：

```
// test printing string array
    for (String s : lines)
    {
        System.out.println("" + s);
        String[] output =infixToRPN(lines);
        System.out.println(RPNtoDouble(output));

    } 
```

你必须通过`s`，而不是`lines`进入方法`infixToRPN`，这就是为什么你得到相同的输出，因为你给出了相同的输入。

请记住，`infixToRPN`接收`String []`不是像“s”这样的字符串，但是我留给您寻找解决方法。

# xcode - 是否可以在 XCode 3 上使用 MacRuby

> ID：13574887
> 
> 赞同：0
> 
> 时间：2012-11-26T23:20:32.463
> 
> 标签：xcode, osx-snow-leopard, macruby

是否可以使用 XCode 3 运行 MacRuby？

我无法升级到 XCode 4.2，因为我正在运行 Snow Leopard，并且有一台不会升级到 Mountain Lion 的机器，而 Apple 已经从 App Store 中撤下了 Lion。我知道您可以使用 Apple 开发帐户（每年 100 美元）下载 XCode 4.2，但我正在寻找免费的解决方案。

也许 MacRuby 上有可以与 XCode 3 一起安装的旧版本？如果您知道哪个版本，如果安装说明与 XCode 4.2 的不同，我会很感兴趣

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T14:21:51.313

尝试在[此处](https://macruby.macosforge.org/files/)查找以前版本的 MacRuby。

我想说 0.10 版本与 Snow Leopard 兼容，但我不确定。

# xslt - XSLT - Umbraco 中的 JSON 编码输出

> ID：13574890
> 
> 赞同：2
> 
> 时间：2012-11-26T23:20:42.633
> 
> 标签：xslt, umbraco, json

好你好！

我正在使用 Umbraco 4 并尝试生成有效的 JSON。但是，my`<xls:value-of />`不会对我的数据进行编码。我想要那个，因为 '、<、> 或 \ 字符只会破坏我的 JSON。

这甚至可以开箱即用吗？

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-27T09:22:49.170

使用`disable-output-escaping="yes"`时使用`<xsl:value-of/>`。

# django - Django默认登录测试失败

> ID：13574895
> 
> 赞同：0
> 
> 时间：2012-11-26T23:21:21.653
> 
> 标签：django, django-testing

当我运行项目的默认测试时，一项测试失败：

失败：test_current_site_in_context_after_login (django.contrib.auth.tests.views.LoginTest)

回溯（最近一次通话最后一次）：文件“/Users/me/Dropbox/dotfiles/.virtualenvs/mysite/lib/python2.7/site-packages/django/contrib/auth/tests/views.py”，第 294 行，在 test_current_site_in_context_after_login self.assertEqual(response.context['site_name'], site.name) AssertionError: 'MySite' != u'example.com'

我的 settings.py 文件包含：

```
SITE_NAME = 'MySite' 
```

我在设置文件末尾的上下文中加载 SITE_NAME：

```
TEMPLATE_CONTEXT_PROCESSORS = GLOBAL_SETTINGS.TEMPLATE_CONTEXT_PROCESSORS + (
    'utils.context_processors.mysite',
) 
```

utils/context_processors.py 包含：

```
from mysite import settings
def mysite(request):
    return {
        'site_name': settings.SITE_NAME,
        'request': request
    } 
```

我查看了源代码，但我不明白为什么测试将我的网站名称与“example.com”进行比较。我还查看了 django.contrib.sites.models.Site 类，想知道是否需要清除 Site 对象缓存。但是，我没有缓存设置。.pyc 文件中是否存在冲突，以至于我需要删除 virtualenv 中的所有 pyc 文件？

顺便说一句，我正在运行 Django 1.4.2 和 2.7.1。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-08-25T12:09:31.463

我最近遇到了这个问题，我通过将以下内容添加到我的 settings.py 文件来修复它：

```
SITE_ID = 1 
```

来自[Django Settings Docs](https://docs.djangoproject.com/en/dev/ref/settings/?from=olddocs#site-id)的 Django 文档：

> SITE_ID
> 
> 默认值：未定义
> 
> django_site 数据库表中当前站点的 ID，整数形式。这用于使应用程序数据可以连接到特定站点，并且单个数据库可以管理多个站点的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:57:07.123

问题是您在设置中对 SITE_NAME 进行了硬编码。您应该`Site.objects.get_current()`在中间件/视图中使用：[https ://docs.djangoproject.com/en/1.4/ref/contrib/sites/#hooking-into-the-current-site-from-views](https://docs.djangoproject.com/en/1.4/ref/contrib/sites/#hooking-into-the-current-site-from-views)

# .net - .NET listview 以编程方式更改高度

> ID：13574897
> 
> 赞同：0
> 
> 时间：2012-11-26T23:21:22.697
> 
> 标签：.net, listview

是否可以在添加项目时以编程方式更改 a 的高度`ListView`？

基本上我想要`ListView`高度`AutoSize`。

我试过了：

```
lv.Height = myValue; 
```

和：

```
lv.UpdateBounds(x, y, newWidth, newHeight); 
```

不过，这些似乎都没有更新控件在表单上的样子。

**编辑：**

这个列表视图实际上是一个用户控件，我继承了一个`ListView`. 我正在尝试更改构造函数中的高度，以使我使用反射拉入的项目全部出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T09:31:17.410

假设您在单击按钮时将项目添加到列表视图，然后为每个添加的新项目将列表视图的大小增加 5px ？或您希望它也增长的任何大小..

```
 private void button1_Click(object sender, EventArgs e)
    {
        listView1.Items.Add("Hello How are you");
        listView1.Height = listView1.Height + 5;
    } 
```

# reactiveui - ReactiveUI 4.0.2 中的 CollectionExtensions.ObserveCollectionChanged() 在哪里？

> ID：13574902
> 
> 赞同：0
> 
> 时间：2012-11-26T23:21:46.377
> 
> 标签：reactiveui

ReactiveUI 3.2.0.0 曾经有实现 ObserveCollectionChanged() 方法的 CollectionExtensions 类。现在 ReactiveUI 4.0.2 下的方法在哪里？

```
 private readonly ReactiveCollection<string> _sourceItems = new ReactiveCollection<string>();
    private readonly ReactiveCollection<SelectableDataItem<string>> _selectableItemsView = null;
    private readonly ReactiveCollection<SelectableDataItem<string>> _selectedItemsView = null;
    private readonly ReactiveCollection<string> _selectedDataView = null;

    ....

        this._sourceItems.ChangeTrackingEnabled = true;

        this._selectableItemsView =
            this.SourceItems.CreateDerivedCollection<string, SelectableDataItem<string>>(i => new SelectableDataItem<string>(i) { IsSelected = true, });
        this._selectableItemsView.ChangeTrackingEnabled = true;
        this._selectedItemsView =
            this._selectableItemsView.CreateDerivedCollection<SelectableDataItem<string>, SelectableDataItem<string>>(
            i => i,
            f => f.IsSelected,
            (i1, i2) => 0
            );
        this._selectedItemsView.ChangeTrackingEnabled = true;
        this._selectedDataView =
            this._selectableItemsView.CreateDerivedCollection<SelectableDataItem<string>, string>(i => i.Data, f => f.IsSelected, (i1, i2) => 0);
        this._selectedDataView.ChangeTrackingEnabled = true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-04T20:54:09.903

升级到 ReactiveUI 4.1 并使用`someCollection.CreateDerivedCollection`- 所有的工作都已经为你完成了 :)

# list - Win Prolog List 部分有效

> ID：13574907
> 
> 赞同：1
> 
> 时间：2012-11-26T23:22:29.323
> 
> 标签：list, prolog, win-prolog

我试图将储物柜与密码联系起来。这就是我到目前为止所拥有的。

```
 lockerof(C, [], V).
    lockerof(C,[C|_], V).
    lockerof(C, [[C, V]|_], V). 
```

当我输入：

```
 lockerof(a, [[a,1],[b,2]], V). 
```

它给了我 a 的价值，所以我得到：

```
 V = 1 
```

但是当我输入：

```
 lockerof(b, [[a,1],[b,2]], V). 
```

我得到一个“不”，但我希望输出是：

```
 V =2 
```

我做错了什么，我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:00:28.350

您还需要扫描列表的尾部。使用递归：

```
lockerof(C, [_|T], V) :- lockerof(C, T, V). 
```

那就是“如果 [C,V] 在列表的尾部，那么它也在列表本身中”。

另外，我认为您的前两条规则是不必要的。

最后，您可以使用 member/2 谓词在一行中实现它：

```
lockerof(C, L, V) :- member([C,V], L). 
```

# gwt - 以像素为单位设置div的确切宽度？

> ID：13574909
> 
> 赞同：0
> 
> 时间：2012-11-26T23:22:38.733
> 
> 标签：gwt

在以像素为单位指定 div 的大小时，我在 iphone 4s 设备上看到了奇怪的行为。

我的 iphone 在纵向方向是 980 像素宽。

作为第一个测试，我刚刚创建了一个普通的 html 实现。这完全符合预期 - div 占据了我屏幕的整个宽度，但并不宽：

```
<body>
  <div style="width:980px; height: 30px; background-color: red;"></div>
</body> 
```

现在在 GWT 中，我尝试了同样的事情（至少我认为它是等价的）：

```
FlowPanel fp = new FlowPanel();
fp.setWidth("980px");
fp.setHeight("30px");
fp.getElement().getStyle().setBackgroundColor("red");
RootPanel.get().add(fp); 
```

但是在我的 iphone 上加载时，div 似乎是屏幕宽度的两倍。GWT 是否会自动进行某种缩放？我知道 iphone 4S 是视网膜显示器，因此它的像素比是 2 倍。是不是和那件事有关？

我无法检查 iphone 上的输出 html，但是当我在 Firefox 中查看 GWT 版本时，我可以看到 GWT 确实在输出我指定的 980px 大小：

```
// What GWT outputs - looks the same as my hand-written version:
<div style="width: 980px; height: 30px; background-color: red;"></div> 
```

那么为什么 GWT 版本会将 div 渲染为 2x 宽呢？

- - - 更新 - - - - -

正如 Woojah 建议的那样，我尝试通过样式定义：

```
.sanityTest {
width: 980px;
height: 30px;
background-color: green;
}

FlowPanel fp = new FlowPanel();
fp.setStyleName("sanityTest"); 
```

但仍然是相同的行为 - 在 iphone 4s 屏幕上，div 是显示屏宽度的两倍。dom 看起来和我的手写版本完全一样。尺寸在非视网膜设备上表现正确。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T00:16:29.433

我建议您尝试以下方法：

1.  做：

    `getElement().getStyle.setWidth(x, Style.Unit.PX); getElement().getStyle.setHeight(y, Style.Unit.PX);`

这相当于你的 `style="width:980px; height: 30px; background-color: red;`

1.  另一种选择是在你的css stylesheed中定义一个类 `.yourCss { width:980px; height: 30px; background-color: red; }`

然后在你的代码中做`flowPanel.setStyleName("yourCss");`

# c# - How to test to see if mySql Database is working?

> ID：13574910
> 
> 赞同：0
> 
> 时间：2012-11-26T23:22:48.370
> 
> 标签：c#, mysql, database, visual-studio-2010

I am new to MySQL database, I am using Visual Studio C# to connect to my database. I have got a following select method. How can I run it to check if it is working?

**EDITED The open and close connection methods**

```
//Open connection to database
    private bool OpenConnection()
    {
        try
        {
           // connection.open();
            return true;
        }
        catch (MySqlException ex)
        {
            //When handling errors, your application's response based 
            //on the error number.
            //The two most common error numbers when connecting are as follows:
            //0: Cannot connect to server.
            //1045: Invalid user name and/or password.
            switch (ex.Number)
            {
                case 0:
                   MessageBox.Show("Cannot connect to server.");
                    break;

                case 1045:
                    MessageBox.Show("Invalid username/password, please try again");
                    break;
            }
            return false;
        }
    }

    //Close connection
    private bool CloseConnection()
    {
        try
        {
            connection.Close();
            return true;
        }
        catch (MySqlException ex)
        {
            MessageBox.Show(ex.Message);
            return false;
        }
    } 
```

Select method which is in the same class as the close and open connection as shown above

```
 public List<string>[] Select()
    {
        string query = "SELECT * FROM Questions";

        //Create a list to store the result
        List<string>[] list = new List<string>[3];
        list[0] = new List<string>();
        list[1] = new List<string>();
        list[2] = new List<string>();
        list[3] = new List<string>();
        list[4] = new List<string>();
        list[5] = new List<string>();
        list[6] = new List<string>();
        list[7] = new List<string>();

        //Open connection
        if (this.OpenConnection() == true)
        {
            //Create Command
            MySqlCommand cmd = new MySqlCommand(query, connection);
            //Create a data reader and Execute the command
            MySqlDataReader dataReader = cmd.ExecuteReader();

            //Read the data and store them in the list
            while (dataReader.Read())
            {
                list[0].Add(dataReader["id"] + "");
                list[1].Add(dataReader["difficulty"] + "");
                list[2].Add(dataReader["qustions"] + "");
                list[3].Add(dataReader["c_answer"] + "");
                list[4].Add(dataReader["choiceA"] + "");
                list[5].Add(dataReader["choiceB"] + "");
                list[6].Add(dataReader["choiceC"] + "");
                list[7].Add(dataReader["choiceD"] + "");
            }

            //close Data Reader
            dataReader.Close();

            //close Connection
            this.CloseConnection();

            //return list to be displayed
            return list;
        }
        else
        {
            return list;
        }
    } 
```

This method is in a separate class which has got all the database connection settings. Now that I want to call this method from my main class to test it to see if it's working, how can I do this?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:41:43.230

You should create an object instance of that DB class and then call the Select() method.
So, supposing that this DB class is named `QuestionsDB` you should write something like this:

```
QuestionDB questionDAL = new QuestionDB();
List<string>[] questions = questionDAL.Select(); 
```

However, before this, please correct this line

```
List<string>[] list = new List<string>[8];  // you need 8 lists for your db query 
```

You could check if you have any record testing if the first list in your array list has more than zero elements.

```
if(questions[0].Count > 0)
  ... // you have read records. 
```

However, said that, I will change your code adding a specific class for questions and using a list(of Question) instead of an array of list So, for example, create a class like this

```
public class Question
{
    public string ID;
    public string Difficulty;
    public string Question;
    public string RightAnswer;
    public string AnswerA;
    public string AnswerB;
    public string AnswerC;
    public string AnswerD;
} 
```

and change your select to return a List(of Question)

```
 List<Question> list = new List<Question>;
 ......
 while (dataReader.Read())
 {
      Question qst = new Question();
      qst.ID = dataReader["id"] + "";
      qst.Difficulty = dataReader["difficulty"] + "";
      qst.Question = dataReader["qustions"] + "";
      qst.RightAnswer = dataReader["c_answer"] + "";
      qst.AnswerA = dataReader["choiceA"] + "";
      qst.AnswerB = dataReader["choiceB"] + "";
      qst.AnswerC = dataReader["choiceC"] + "";
      qst.AnswerD = dataReader["choiceD"] + "";
      list.Add(qst);
 }
 return list; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:47:09.267

You can test whether the method works by writing a unit test for it. A good unit testing frame work is [Nunit](http://www.nunit.org/). Before you call this you must create and open a connection to the DB:

```
 //Open connection
    if (this.OpenConnection() == true)
    { 
```

as the other person said, you will want to fix the lists up.

# php - jQuery 只有小时和秒倒计时

> ID：13574917
> 
> 赞同：0
> 
> 时间：2012-11-26T23:23:31.797
> 
> 标签：php, jquery, timestamp, countdown, strtotime

我的代码不是很专业，但它可以满足我的要求:)。该代码基本上是在商店打开时计算多长时间如果关闭计算离开表单打开多长时间。现在我想用 jQuery Countdown 来设置它的样式，但我找不到任何只计算小时、分钟、甚至秒的方法。我正在尝试 UNIX 倒计时，但不知道我做错了什么。我想请你们 Stackoverflow 的同胞帮助我解决这个问题。

这是我的代码（只是不要讨厌:)）

```
date_default_timezone_set('Greenwich'); //Fixes my server location

$openingtime = strtotime('06:00'); //Opening time
$closingtime = strtotime('23:10'); //Closing time
$timenow = strtotime('now'); //Current Server Time
$twentyfourhours = "24:00"; //Hours in a day

//echo date('G:i', $openingtime); //Just texting
//echo date('G:i', $closingtime);
//echo date('H:i', $timenow);
//echo $twentyfourhours;// Testing ends here

$openingin = $twentyfourhours - $timenow + $openingtime; //24:00 - 23:20 + 6:00 = How long left for opening
$closingdown = $closingtime - $timenow; //23:10 - 23:20 How long left to close

//If current time value is bigger then closing time then display when the shop will re-open again
if (date('H:i', $timenow) > date('H:i', $closingtime)) 
{
  echo "The shop will be open in ".date('H:i', $openingin)." hours";
}
//If current time value is lower then closing time then display how long the shop will stay open
elseif (date('H:i', $timenow) < date('H:i', $closingtime))
{
  echo "The shop will be open for ".date('H:i', $closingdown)." hours";
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T22:13:19.153

Ok i have managed to found one but now if you will go to [My Testing Ground](http://szkolahtml.pl/day.php) You will notice that the seconds instead of starting countdown from 60 they start from 00,99,98,97,97 and all the way down :( dunno why its happening i`m attaching JS code` var flipCounter = function(d, options){

```
// Default values
var defaults = {
    value: 0,
    inc: 1,
    pace: 1000,
    auto: true,
    tFH: 39,
    bFH: 64,
    fW: 53,
    bOffset: 390
};

var o = options || {},
doc = window.document,
divId = typeof d !== 'undefined' && d !== '' ? d : 'flip-counter',
div = doc.getElementById(divId);

for (var opt in defaults) o[opt] = (opt in o) ? o[opt] : defaults[opt];

var digitsOld = [], digitsNew = [], subStart, subEnd, x, y, nextCount = null, newDigit, newComma,
best = {
    q: null,
    pace: 0,
    inc: 0
};

/**
 * Sets the value of the counter and animates the digits to new value.
 * 
 * Example: myCounter.setValue(500); would set the value of the counter to 500,
 * no matter what value it was previously.
 *
 * @param {int} n
 *   New counter value
 */
this.setValue = function(n){
    if (isNumber(n)){
        x = o.value;
        y = n;
        o.value = n;
        digitCheck(x,y);
    }
    return this;
};

/**
 * Sets the increment for the counter. Does NOT animate digits.
 */
this.setIncrement = function(n){
    o.inc = isNumber(n) ? n : defaults.inc;
    return this;
};

/**
 * Sets the pace of the counter. Only affects counter when auto == true.
 *
 * @param {int} n
 *   New pace for counter in milliseconds
 */
this.setPace = function(n){
    o.pace = isNumber(n) ? n : defaults.pace;
    return this;
};

/**
 * Sets counter to auto-incrememnt (true) or not (false).
 *
 * @param {bool} a
 *   Should counter auto-increment, true or false
 */
this.setAuto = function(a){
    if (a && ! o.atuo){
        o.auto = true;
        doCount();
    }
    if (! a && o.auto){
        if (nextCount) clearNext();
        o.auto = false;
    }
    return this;
};

/**
 * Increments counter by one animation based on set 'inc' value.
 */
this.step = function(){
    if (! o.auto) doCount();
    return this;
};

/**
 * Adds a number to the counter value, not affecting the 'inc' or 'pace' of the counter.
 *
 * @param {int} n
 *   Number to add to counter value
 */
this.add = function(n){
    if (isNumber(n)){
        x = o.value;
        o.value += n;
        y = o.value;
        digitCheck(x,y);
    }
    return this;
};

/**
 * Subtracts a number from the counter value, not affecting the 'inc' or 'pace' of the counter.
 *
 * @param {int} n
 *   Number to subtract from counter value
 */
this.subtract = function(n){
    if (isNumber(n)){
        x = o.value;
        o.value -= n;
        if (o.value >= 0){
            y = o.value;
        }
        else{
            y = "0";
            o.value = 0;
        }
        digitCheck(x,y);
    }
    return this;
};

/**
 * Increments counter to given value, animating by current pace and increment.
 *
 * @param {int} n
 *   Number to increment to
 * @param {int} t (optional)
 *   Time duration in seconds - makes increment a 'smart' increment
 * @param {int} p (optional)
 *   Desired pace for counter if 'smart' increment
 */
this.incrementTo = function(n, t, p){
    if (nextCount) clearNext();

    // Smart increment
    if (typeof t != 'undefined'){
        var time = isNumber(t) ? t * 1000 : 10000,
        pace = typeof p != 'undefined' && isNumber(p) ? p : o.pace,
        diff = typeof n != 'undefined' && isNumber(n) ? n - o.value : 0,
        cycles, inc, check, i = 0;
        best.q = null;

        // Initial best guess
        pace = (time / diff > pace) ? Math.round((time / diff) / 10) * 10 : pace;
        cycles = Math.floor(time / pace);
        inc = Math.floor(diff / cycles);

        check = checkSmartValues(diff, cycles, inc, pace, time);

        if (diff > 0){
            while (check.result === false && i < 100){              
                pace += 10;
                cycles = Math.floor(time / pace);
                inc = Math.floor(diff / cycles);

                check = checkSmartValues(diff, cycles, inc, pace, time);                    
                i++;
            }

            if (i == 100){
                // Could not find optimal settings, use best found so far
                o.inc = best.inc;
                o.pace = best.pace;
            }
            else{
                // Optimal settings found, use those
                o.inc = inc;
                o.pace = pace;
            }

            doIncrement(n, true, cycles);
        }

    }
    // Regular increment
    else{
        doIncrement(n);
    }

}

/**
 * Gets current value of counter.
 */
this.getValue = function(){
    return o.value;
}

/**
 * Stops all running increments.
 */
this.stop = function(){
    if (nextCount) clearNext();
    return this;
}

//---------------------------------------------------------------------------//

function doCount(){
    x = o.value;
    o.value += o.inc;
    y = o.value;
    digitCheck(x,y);
    if (o.auto === true) nextCount = setTimeout(doCount, o.pace);
}

function doIncrement(n, s, c){
    var val = o.value,
    smart = (typeof s == 'undefined') ? false : s,
    cycles = (typeof c == 'undefined') ? 1 : c;

    if (smart === true) cycles--;

    if (val != n){
        x = o.value,
        o.auto = true;

        if (val + o.inc <= n && cycles != 0) val += o.inc
        else val = n;

        o.value = val;
        y = o.value;

        digitCheck(x,y);
        nextCount = setTimeout(function(){doIncrement(n, smart, cycles)}, o.pace);
    }
    else o.auto = false;
}

function digitCheck(x,y){
    digitsOld = splitToArray(x);
    digitsNew = splitToArray(y);
    var diff,
    xlen = digitsOld.length,
    ylen = digitsNew.length;
    if (ylen > xlen){
        diff = ylen - xlen;
        while (diff > 0){
            addDigit(ylen - diff + 1, digitsNew[ylen - diff]);
            diff--;
        }
    }
    if (ylen < xlen){
        diff = xlen - ylen;
        while (diff > 0){
            removeDigit(xlen - diff);
            diff--;
        }
    }
    for (var i = 0; i < xlen; i++){
        if (digitsNew[i] != digitsOld[i]){
            animateDigit(i, digitsOld[i], digitsNew[i]);
        }
    }
}

function animateDigit(n, oldDigit, newDigit){
    var speed, step = 0, w, a,
    bp = [
        '-' + o.fW + 'px -' + (oldDigit * o.tFH) + 'px',
        (o.fW * -2) + 'px -' + (oldDigit * o.tFH) + 'px',
        '0 -' + (newDigit * o.tFH) + 'px',
        '-' + o.fW + 'px -' + (oldDigit * o.bFH + o.bOffset) + 'px',
        (o.fW * -2) + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px',
        (o.fW * -3) + 'px -' + (newDigit * o.bFH + o.bOffset) + 'px',
        '0 -' + (newDigit * o.bFH + o.bOffset) + 'px'
    ];

    if (o.auto === true && o.pace <= 300){
        switch (n){
            case 0:
                speed = o.pace/6;
                break;
            case 1:
                speed = o.pace/5;
                break;
            case 2:
                speed = o.pace/4;
                break;
            case 3:
                speed = o.pace/3;
                break;
            default:
                speed = o.pace/1.5;
                break;
        }
    }
    else{
        speed = 80;
    }
    // Cap on slowest animation can go
    speed = (speed > 80) ? 80 : speed;

    function animate(){
        if (step < 7){
            w = step < 3 ? 't' : 'b';
            a = doc.getElementById(divId + "_" + w + "_d" + n);
            if (a) a.style.backgroundPosition = bp[step];
            step++;
            if (step != 3) setTimeout(animate, speed);
            else animate();
        }
    }

    animate();
}

// Creates array of digits for easier manipulation
function splitToArray(input){
    return input.toString().split("").reverse();
}

// Adds new digit
function addDigit(len, digit){
    var li = Number(len) - 1;
    newDigit = doc.createElement("ul");
    newDigit.className = 'cd';
    newDigit.id = divId + '_d' + li;
    newDigit.innerHTML = '<li class="t" id="' + divId + '_t_d' + li + '"></li><li class="b" id="' + divId + '_b_d' + li + '"></li>';

    if (li % 2 == 0){
        newComma = doc.createElement("ul");
        newComma.className = 'cd';
        newComma.innerHTML = '<li class="s"></li>';
        div.insertBefore(newComma, div.firstChild);
    }

    div.insertBefore(newDigit, div.firstChild);
    doc.getElementById(divId + "_t_d" + li).style.backgroundPosition = '0 -' + (digit * o.tFH) + 'px';
    doc.getElementById(divId + "_b_d" + li).style.backgroundPosition = '0 -' + (digit * o.bFH + o.bOffset) + 'px';
}

// Removes digit
function removeDigit(id){
    var remove = doc.getElementById(divId + "_d" + id);
    div.removeChild(remove);

    // Check for leading comma
    var first = div.firstChild.firstChild;
    if ((" " + first.className + " ").indexOf(" s ") > -1 ){
        remove = first.parentNode;
        div.removeChild(remove);
    }
}

// Sets the correct digits on load
function initialDigitCheck(init){
    // Creates the right number of digits
    var initial = init.toString(),
    count = initial.length,
    bit = 1, i;
    for (i = 0; i < count; i++){
        newDigit = doc.createElement("ul");
        newDigit.className = 'cd';
        newDigit.id = divId + '_d' + i;
        newDigit.innerHTML = newDigit.innerHTML = '<li class="t" id="' + divId + '_t_d' + i + '"></li><li class="b" id="' + divId + '_b_d' + i + '"></li>';
        div.insertBefore(newDigit, div.firstChild);
        if (bit != (count) && bit % 2 == 0){
            newComma = doc.createElement("ul");
            newComma.className = 'cd';
            newComma.innerHTML = '<li class="s"></li>';
            div.insertBefore(newComma, div.firstChild);
        }
        bit++;
    }
    // Sets them to the right number
    var digits = splitToArray(initial);
    for (i = 0; i < count; i++){
        doc.getElementById(divId + "_t_d" + i).style.backgroundPosition = '0 -' + (digits[i] * o.tFH) + 'px';
        doc.getElementById(divId + "_b_d" + i).style.backgroundPosition = '0 -' + (digits[i] * o.bFH + o.bOffset) + 'px';
    }
    // Do first animation
    if (o.auto === true) nextCount = setTimeout(doCount, o.pace);
}

// Checks values for smart increment and creates debug text
function checkSmartValues(diff, cycles, inc, pace, time){
    var r = {result: true}, q;
    // Test conditions, all must pass to continue:
    // 1: Unrounded inc value needs to be at least 1
    r.cond1 = (diff / cycles >= 1) ? true : false;
    // 2: Don't want to overshoot the target number
    r.cond2 = (cycles * inc <= diff) ? true : false;
    // 3: Want to be within 10 of the target number
    r.cond3 = (Math.abs(cycles * inc - diff) <= 10) ? true : false;
    // 4: Total time should be within 100ms of target time.
    r.cond4 = (Math.abs(cycles * pace - time) <= 100) ? true : false;
    // 5: Calculated time should not be over target time
    r.cond5 = (cycles * pace <= time) ? true : false;

    // Keep track of 'good enough' values in case can't find best one within 100 loops
    if (r.cond1 && r.cond2 && r.cond4 && r.cond5){
        q = Math.abs(diff - (cycles * inc)) + Math.abs(cycles * pace - time);
        if (best.q === null) best.q = q;
        if (q <= best.q){
            best.pace = pace;
            best.inc = inc;
        }
    }

    for (var i = 1; i <= 5; i++){
        if (r['cond' + i] === false){
            r.result = false;
        }           
    }
    return r;
}

// http://stackoverflow.com/questions/18082/validate-numbers-in-javascript-isnumeric/1830844
function isNumber(n) {
    return !isNaN(parseFloat(n)) && isFinite(n);
}

function clearNext(){
    clearTimeout(nextCount);
    nextCount = null;
}

// Start it up
initialDigitCheck(o.value); 
```

};`

# xslt - 使用 XSLT/MarkLogic 解析 HTML 标签

> ID：13574918
> 
> 赞同：1
> 
> 时间：2012-11-26T23:23:34.057
> 
> 标签：xslt, marklogic

我正在尝试将`XML`文件转换为`HTML`. 该`XML`文件有一堆`HTML`形式的标签：

```
<item>&lt;text&gt;Line 1&lt;br/&gt;Line 2&lt;br/&gt;Line 3&lt;/text&gt;</item> 
```

最终，出现在 Internet Explorer 中的输出是：

```
<text>Line 1<br/>Line 2<br/>Line 3</text> 
```

当我想：

> 1
> 号线 2
> 号线 3号线

一旦我发现`disable-output-escaping`，文本在 IE 中正确呈现。不幸的是，MarkLogic 不支持此属性。

我能够使用 完全消除标签`replace()`，但我无法用实际的换行符替换换行符标签。

有没有人对如何：

1) 在 MarkLogic 中正确呈现 HTML，或

2) 正确解析 XSLT 中的 HTML 标签。

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:54:21.270

也许你想要这个

```
let $foo := <item>&lt;text&gt;Line 1&lt;br/&gt;Line 2&lt;br/&gt;Line 3&lt;/text&gt;</item>
return xdmp:unquote($foo/text()) 
```

# ios - 构建一个 UIPickerView Util 类

> ID：13574920
> 
> 赞同：0
> 
> 时间：2012-11-26T23:23:48.740
> 
> 标签：ios, uipickerview, exc-bad-access

我正在尝试从完全 Android 的背景中学习 iOS。很抱歉这个超级菜鸟问题，但我想构建一个 UIPickerView Util 类，它可以在我的应用程序中作为一个单独的类一遍又一遍地重用，我收到**EXC_BAD_ACCESS**消息，我不知道为什么。所以我有两个问题：

1.  我没有看到任何关于将它作为不同的类分开的东西，这是因为这是处理这个问题的不正确方法吗？

2.  这个基本（主要是生成的）代码会给我 EXC_BAD ACCESS 消息有什么问题？我读过这与内存问题有关。我正在使用 ARC，为什么这是一个问题？

这是我正在尝试构建的课程的开始。

***头文件***

```
#import <UIKit/UIKit.h>

@interface PickerTools : UIViewController<UIPickerViewDelegate>

@property (strong, nonatomic)UIPickerView* myPickerView;

-(UIPickerView*)showPicker;

@end 
```

***实施文件***

```
#import "PickerTools.h"

@implementation PickerTools

@synthesize myPickerView;

- (UIPickerView*)showPicker {
    myPickerView = [[UIPickerView alloc] initWithFrame:CGRectMake(0, 200, 320, 200)];
    myPickerView.delegate = self;
    myPickerView.showsSelectionIndicator = YES;
    return myPickerView;
}

- (void)pickerView:(UIPickerView *)pickerView didSelectRow: (NSInteger)row inComponent:        (NSInteger)component {
    // Handle the selection
}

// tell the picker how many rows are available for a given component
- (NSInteger)pickerView:(UIPickerView *)pickerView numberOfRowsInComponent:(NSInteger)component {
    NSUInteger numRows = 5;

    return numRows;
}

// tell the picker how many components it will have
- (NSInteger)numberOfComponentsInPickerView:(UIPickerView *)pickerView {
    return 1;
}

// tell the picker the title for a given component
- (NSString *)pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component {
    NSString *title;
    title = [@"" stringByAppendingFormat:@"%d",row];

    return title;
}

// tell the picker the width of each row for a given component
- (CGFloat)pickerView:(UIPickerView *)pickerView widthForComponent:(NSInteger)component {
    int sectionWidth = 300;

    return sectionWidth;
}

@end 
```

这是我从 UITableViewController 类中的方法调用它的方式：

```
PickerTools *picker = [[PickerTools alloc]init];
[[self view]addSubview:[picker showPicker]]; 
```

再次感谢您的帮助！只是想学习！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:36:52.850

你在用 showPicker 做什么？showPicker 具有误导性，因为它实际上并未显示。它只返回一个带有框架的pickerView。在某些时候，您需要使用 addSubview 或使用 UIPopoverController 将其添加到视图中。

如果您只是在方法范围内创建视图控制器类，那么一旦该方法完成运行，它就会被释放。然后所有的赌注都取消了。选择器正在尝试访问委托（即视图控制器），但视图控制器无处可寻，因为它已被释放。

您必须发布一些使用代码。就其本身而言，此代码应该可以工作，但这就是您使用它的方式。

此外，您不必使用 UIViewController 来“控制”一个简单的视图。考虑制作一个自定义类并仅子类化 NSObject。

编辑：查看您发布的代码后，我的怀疑是正确的。您需要“保留”您的 PickerTools 实例。这意味着，您需要将“picker”变量（再次误导）保存为调用视图控制器的强属性。在您将选择器视图添加为子视图后，它会立即发布。pickerView 是活动的，因为它被它的 superview 保留，但是持有它的对象（委托“picker”）已经死了。有道理？

# html - 为 html 元素提供仅用于测试目的的 id 属性是一种好习惯吗？

> ID：13574929
> 
> 赞同：6
> 
> 时间：2012-11-26T23:24:45.760
> 
> 标签：html, css, unit-testing, testing, selenium

假设我有这样的表格：

```
<form action="/foo" method="POST">
    <input type="text" name="username">
    <input type="text" name="password">
    <input type="submit" value="Login">
</form> 
```

就我而言，我不需要为任何输入标签提供“id”属性。它不是通过 CSS 设置样式的，没有引用它的 javascript 等等......但是，如果它有一个硬编码的“id”（例如“登录按钮”），那么他们的 QA 部门会喜欢它，以便他们的自动化测试会保持稳定。

**缺点**作为开发人员，我对添加无功能用途的 id 属性持高度怀疑态度。

*   我认为它使代码混乱。
*   让未来的开发人员感到困惑。
*   将我们绑定到当时正在使用的任何测试工具。
*   将我们绑定到产品代码库之外的代码。
*   从代码的滑坡开始，知道如何测试它，反之亦然。

**优点**：从 QA 的角度来看，我当然可以同情这会：

*   让他们的工作更轻松。
*   提供稳定性（短期内）

我可以在扩展我在这里开始的优点/缺点列表上获得一些帮助吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-11-27T08:30:45.773

在表单输入中包含属性的一个重要**功能**原因`id`是，您可以将相应的`label`元素与输入显式关联：

```
<form action="/foo" method="POST">
    <label for="username">User Name</label>
    <input type="text" id="username" name="username">
</form> 
```

这对于可访问性和可用性很重要。屏幕阅读器用户依赖这种关联，以便他们知道他们正在输入什么输入。当标签正确关联时，也存在**巨大**的可用性差异（用户可以单击标签将焦点设置到关联的输入）。`checkbox`这在和`radio`输入中非常明显。

[在复选框上摆弄两者的例子](http://jsfiddle.net/m3Nn7/)。*（请注意单击标签而不是输入本身要容易得多）*

至于您的反对意见...我不确定您所说的`id`任何“缺点”是如何添加属性的。杂乱无章？不，有效的可用代码。令人困惑？不，如果我看到该代码，我会首先添加 id 和正确关联的标签。将您绑定到测试工具和外部代码？究竟如何？它将使您的测试人员的生活更轻松的事实只是锦上添花。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-11-26T23:40:21.143

您的前 2 个缺点是有效的，但我不同意后 3 个。

您可以采取的立场是，您将为测试人员提供逻辑元素 ID，但他们负责将它们与他们使用的任何测试工具等一起使用。这意味着您与测试/工具无关，您只需提供用于测试的 ID，而不必确切知道它们将如何使用。

像这样添加 ID 是当今许多 Web 应用程序的标准做法。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-11-26T23:35:45.633

If possible, their testing tool should fill in the fields based on their name attributes and the form's action attribute if there are multiple forms on the page. These are guaranteed to be as stable as the part of the server answering the POST request.

Ids, field ordering, and other attributes might change due to front-end reasons.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T12:38:33.650

For me it depends. It depends on if the elements can be easily and reliably found without the ID.

In your example, yes, so adding the ID isn't a waste but just isn't necessary. However that's all that is, an example.

In a lot of web pages, as they become more complex and complicated, ID's become your friend, because without it you will need to look at other ways of finding elements.

Especially in the Selenium world, when you come across this problem, you generally turn to CSS and/or XPath selectors.

Other selectors are not bad things, but they can quite slow in older browsers, if you support them.

# javascript - 如何在 JavaScript 中加载文本文件？

> ID：13574930
> 
> 赞同：4
> 
> 时间：2012-11-26T23:24:47.737
> 
> 标签：javascript, model, load, webgl

我正在创建一个简单的 WebGL 项目，需要一种加载模型的方法。我决定使用 OBJ 格式，所以我需要一种加载它的方法。该文件（将要）存储在服务器上，我的问题是：如何在 JS 中加载文本文件并逐行扫描，一个令牌一个令牌（就像 C++ 中的流一样）？我是 JS 的新手，因此我的问题。方法越简单越好。

更新：我使用了你的解决方案，broofa，但我不确定我是否做对了。我从您编写的 forEach 循环中的文件加载数据，但在它之外（即在您的所有代码之后），我一直在填充数据的对象是“未定义的”。我究竟做错了什么？这是代码：

```
var materialFilename;

function loadOBJModel(filename)
{
    // ...

    var req = new XMLHttpRequest();
    req.open('GET', filename);
    req.responseType = 'text';
    req.onreadystatechange = function()
    {
        if (req.readyState == 4)
        {
            var lines = req.responseText.split(/\n/g);
            lines.forEach(function(line)
            {
                readLine(line);
            });
        }
    }
    req.send();

    alert(materialFilename);

    // ...
}

function readLine(line)
{
    // ...

    else if (tokens[0] == "mtllib")
    {
        materialFilename = tokens[1];
    }

    // ...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:35:30.283

您可以使用[XMLHttpRequest](https://www.google.com/search?q=mdn%20xmlhttprequest)来获取文件，假设它来自与您的主网页相同的域。如果没有，并且您可以控制托管文件的服务器，则可以启用[CORS](https://developer.mozilla.org/en-US/docs/HTTP_access_control)而不会有太多麻烦。例如

要逐行扫描，可以使用 split()。例如像这样的东西......

```
var req = new XMLHttpRequest();
req.open('GET', '/your/url/goes/here');
req.onreadystatechange = function() {
  if (req.readyState == 4) {
    if (req.status == 200) {
      var lines = req.responseText.split(/\n/g);
      lines.forEach(function(line, i) {
        // 'line' is a line of your file, 'i' is the line number (starting at 0)
      });
    } else {
      // (something went wrong with the request)
    }
  }
}

req.send(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:29:14.000

如果您不能简单地使用 XHR 或 CORS 加载数据，则始终可以使用 JSON-P 方法，方法是使用 JavaScript 函数包装它并将脚本标记动态附加到您的页面。

您将拥有一个接受`callback`参数并返回类似`callback1234(/* file data here */);`.

获得数据后，解析应该是微不足道的，但您必须编写自己的解析函数。开箱即用的东西不存在。

# iphone - iOS 崩溃报告：atos 未按预期工作

> ID：13574933
> 
> 赞同：64
> 
> 时间：2012-11-26T23:25:19.563
> 
> 标签：iphone, ios, crash-reports, symbolicatecrash, symbolicate

我正在查看 Apple 提供的崩溃报告

```
Hardware Model:      iPhone4,1
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-11-18 16:03:44.951 -0600
OS Version:      iOS 6.0.1 (10A523)
Report Version:  104

Exception Type:  EXC_BAD_ACCESS (SIGSEGV)
Exception Codes: KERN_INVALID_ADDRESS at 0x51fe5264
Crashed Thread:  0

Thread 0 name:  Dispatch queue: com.apple.main-thread
Thread 0 Crashed:
0   libobjc.A.dylib                 0x352925b0 objc_msgSend + 16
1   MYAPP                           0x0006573a -[MyViewController(Images) didReceiveImage:context:etag:expires:] + 42
2   MYAPP                           0x0004fb26 -[MyImageTask didReceiveImage:] + 98
3   Foundation                      0x361ac8e8 __NSThreadPerformPerform
4   CoreFoundation                  0x3b37d680 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__
5   CoreFoundation                  0x3b37cee4 __CFRunLoopDoSources0
6   CoreFoundation                  0x3b37bcb2 __CFRunLoopRun
7   CoreFoundation                  0x3b2eeeb8 CFRunLoopRunSpecific
8   CoreFoundation                  0x3b2eed44 CFRunLoopRunInMode
9   GraphicsServices                0x396bc2e6 GSEventRunModal
10  UIKit                           0x3452e2f4 UIApplicationMain
11  MYAPP                           0x0004934a main + 70
12  MYAPP                           0x000492fc start + 36 
```

**有趣的是，当我使用 atos 查找与地址位置0x0006573a**和**0x0004fb26**对应的代码行时，我得到了完全不同的匹配。atos 输出甚至不是来自崩溃日志中提到的同一类（MyViewController、MyImageTask）。相反，atos 将我指向一个完全不相关的类中完全良性的代码行。我再次验证我正在使用我提交给 Apple 的确切 dSYM 和 IPA。

我的atos命令

```
/Applications/Xcode.app/Contents/Developer/usr/bin/atos -arch armv7 -o MYAPP.app/MYAPP 0x0004fb26 
```

/usr/bin/atos 和 armv7s 的结果相同。

有没有其他人遇到过这个问题？你能给些建议么？谢谢。

* * *

## 回答 #1

> 赞同：109
> 
> 时间：2013-10-09T23:18:28.163

一个更简单的替代方案：您可以使用该`atos -l`标志让它为您计算。

假设您在崩溃日志中有以下要符号化的行：

```
5   MyApp                   0x0044e89a 0x29000 + 4348058 
```

第一个十六进制数是堆栈地址，第二个十六进制数是加载地址。您可以忽略最后一个数字。您也不必担心幻灯片地址。

要进行符号化，请执行以下操作：

```
atos -o MyApp.app/MyApp -arch armv7 -l 0x29000 0x0044e89a 
```

如果您找不到您的 MyApp.app/MyApp 文件，请将您的“.ipa”文件重命名为“.zip”，解压缩它，它将位于 Payload 文件夹中。

如果您不确定要使用哪种架构（例如 armv7 或 armv7s），请滚动到崩溃文件的“二进制图像”部分，您可以在其中找到它。

干杯

* * *

## 回答 #2

> 赞同：96
> 
> 时间：2012-11-27T01:22:50.137

您必须计算与 atos 一起使用的地址，您不能只使用堆栈跟踪中的地址。

```
symbol address = slide + stack address - load address 
```

1.  该`slide`值是`vmaddr`in的值`LC_SEGMENT cmd`（主要是`0x1000`）。运行以下命令来获取它：

    ```
    otool -arch ARCHITECTURE -l "APP_BUNDLE/APP_EXECUTABLE" | grep -B 3 -A 8 -m 2 "__TEXT" 
    ```

    替换`ARCHITECTURE`为崩溃报告显示的实际架构，例如`armv7`. 替换`APP_BUNDLE/APP_EXECUTABLE`为实际可执行文件的路径。

2.  `stack address`是崩溃报告中的十六进制值。

3.  `load address`可以是在`Binary Images`包含可执行文件的行的最前面部分中显示的第一个地址。（通常是第一个条目）。

因为在过去的值`slide`等于`load address`this 的值总是有效的。但由于 Apple 从 iOS 4.3 开始引入[地址空间布局随机化](http://en.wikipedia.org/wiki/Address_space_layout_randomization)（在不同的变体中），出于安全原因，应用程序加载地址是随机的。

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2013-10-12T00:50:21.707

只需使用 dwarfdump：

```
dwarfdump --arch armv7 myApp.dSYM --lookup 0xaabbccdd | grep 'Line table' 
```

根本不需要做任何计算。

（来自[按地址获取符号（符号化二进制，iOS 构建）](https://stackoverflow.com/questions/11862810/get-symbol-by-address-symbolicating-binary-ios-build)）。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-14T16:31:19.563

对于某些时间没有像这样的加载地址值的人：

```
Jan 14 11:02:39 Dennins-iPhone AppName[584] <Critical>: Stack Trace: (
    0   CoreFoundation                      0x2c3084b7 <redacted> + 150
    1   libobjc.A.dylib                     0x39abec8b objc_exception_throw + 38
    2   CoreFoundation                      0x2c21cc35 CFRunLoopRemoveTimer + 0
    3   AppName                             0x0005a7db AppName + 272347 
```

我创建了一个简单的 bash 来帮助我调试：

```
#! /bin/bash
read -p "[Path] [App Name] [Stack Address] [DecimalSum] " path appName stackAddress decimalSum
loadAddress=`echo "obase=16;ibase=10;$((stackAddress-decimalSum))" | bc`
atos -o $path/Payload/$appName.app/$appName -l $loadAddress $stackAddress -arch armv7 
```

它只是读取应用程序的路径、应用程序名称、堆栈地址和“+”信号后的值（十进制值），然后找到加载地址的值来运行 atos 命令。

# asp.net-mvc - 我不能只从控制器的视图中的下拉列表中获取选定的值

> ID：13574935
> 
> 赞同：0
> 
> 时间：2012-11-26T23:25:42.667
> 
> 标签：asp.net-mvc

我有一个视图，其中有一个链接列表，每个链接都是公司设有办事处的区域。

每次我选择一个区域时，我都会得到一个进程列表。对于每个流程，我都会获得一个下拉列表，从中选择流程的所有者以及要选择的测试复选框列表。

在我的控制器中，我将 string[] OwnerId 作为下拉列表中选择的值。问题是，我从所有下拉列表中获取所有值，而不仅仅是那些被选中的值。我怎样才能得到我选择的那些？

这是我的看法

```
@using CTTModel
@using TestingTool.ViewModels
@model TestRunModel
@{
    ViewBag.Title = "Create";
}
<h2>
    Create</h2>
<script src="@Url.Content("~/Scripts/jquery.validate.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.validate.unobtrusive.min.js")" type="text/javascript"></script>
@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)
    <fieldset>
        <legend>Regions</legend>
        @foreach (Region region in Model.Regions)
        {
            @Html.ActionLink(@region.Name, "Create", new { id = region.Id })<br />
        }

        <div class="editor-field">
            @foreach (ProcessModel process in Model.Processes)
            {
                <h1>@process.Name</h1>

                **List<User> users = ViewBag.Users;

                <select id="OwnerId" name="OwnerId" >

                    @foreach (User user in users)
                    {
                        <option value="@user.Id">@user.Name</option>
                    }

                </select>**  

                <table>
                    <tr>
                          @{
                    int cnt = 0;

                    foreach (TestModel testModel in process.Tests)
                    {
                        if (cnt++ % 3 == 0)
                        {
                                      @:  </tr> <tr> 
                                  }
                                  @: <td> 
                                  <input type="checkbox" 
                                         name="selectedTests" 
                                         value="@testModel.Id/@testModel.ProcessId/@testModel.RegionId" 
                                       @(Html.Raw(testModel.Active ? "checked=\"checked\"" : "")) />
                                  @testModel.Name @::  @testModel.Description
                                  @:</td>
                              }
                              @: </tr>
                          }
                </table>
            }
        </div>

        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>

    <fieldset>
        <legend>Test Screen</legend>
    </fieldset>   
}
<div>
    @Html.ActionLink("Back to List", "Index")
</div> 
```

这是我的控制器。Create Post 什么也没做，我试图首先获得正确的值。

```
//
        // GET: /TestPreparation/Create

        public ActionResult Create(int id = 1)
        {
            TestRunModel testRunModel = new TestRunModel();

            foreach (Region region in _db.Regions)
            {
                testRunModel.Regions.Add(region);
            }

            TestRun testRun = _db.TestRuns.OrderByDescending(x => x.Id).First();

            foreach (TestRunProcessRegion region in testRun.GetProcessesForRegion(_db.Regions.Single(i => i.Id == id)))
            {
                ProcessModel process = new ProcessModel
                    {
                        Code        = region.ProcessRegion.Process.Code,
                        Description = region.ProcessRegion.Process.Description,
                        Name        = region.ProcessRegion.Process.Name,
                        Process     = region.ProcessRegion.Process.Id
                    };

                foreach (SubProcess subProcess in region.ProcessRegion.Process.SubProcesses)
                {
                    foreach (Risk risk in subProcess.Risks)
                    {
                        foreach (Test test in risk.Tests)
                        {
                            TestModel testModel = new TestModel
                                {
                                    Id = test.Id,
                                    Name = test.Name,
                                    Description = test.Description,
                                    ProcessId = region.ProcessRegion.Process.Id,
                                    RegionId = region.ProcessRegion.Id
                                };

                            process.Tests.Add(testModel);
                        }
                    }
                }

                testRunModel.Processes.Add(process);
            }

            var users = new List<User>();
            foreach (User user in _db.Users)
            {
                users.Add(new User
                {
                    Id = user.Id,
                    Name = user.Name,
                });
            }

            ViewBag.Users = users;

            return View(testRunModel);
        } 

        //
        // POST: /TestPreparation/Create

        [HttpPost]
        public ActionResult Create(string[] OwnerId, string[] selectedTests, string[] processes)
        {
            if (ModelState.IsValid)
            {
                //_db.TestRunStatus.Add(testrunstatus);
                //_db.SaveChanges();
                return RedirectToAction("Index");  
            }

            return View();
        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-27T13:01:49.470

你没有得到任何数据的原因是你的 Post Action 的方法签名需要是

```
public ActionResult Create(string OwnerId ...) //preferably int depending on what OwnerId is 
```

这是因为您只从下拉框中选择了一项。因此，如果您使用此签名而不是 string[]，Model binder 会将所选值传递回您的操作。

说了这么多，还是更好的实践和“MVC方式”来使用，

`Html.DropDownFor(x => x.UserID)`它真的让事情变得更容易:)

这适用于所有 html 输入控件：

[http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/examineing-the-edit-methods-and-edit-view](http://www.asp.net/mvc/tutorials/getting-started-with-aspnet-mvc3/cs/examining-the-edit-methods-and-edit-view)

***更新***

我认为最好的办法是在`ProccessModel`类中添加一个 OwnerID。因为`ProccessModel`看起来`IEnumberable<ProccessModel> Processes`包含在 ViewModel 中，您可以使用默认的 MVC 模型绑定器通过以下方式获取要绑定的模型。

Phil Haack 曾在博客上写过关于绑定到列表的文章：

[http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx](http://haacked.com/archive/2008/10/23/model-binding-to-a-list.aspx)

改编自 Phil 的帖子，我认为您将不得不这样做：

```
<% for (int i = 0; i < Model.Processes.Count; i++) { %>

  <%: Html.SelectListFor(model => model.Processes[i].OwnerID, (IEnumerable<SelectListItem>)ViewBag.Users) %> 
<% } %> 
```

将 ViewBag.User 更改为：

```
 var users = _db.Users.Select(x => new SelectListItem(){
                                   text = x.Name, 
                                   value = x.Value
                              }); 
```

修改发布操作：

```
[HttpPost]
public ActionResult Create(TestRunModel model)
{
    foreach(var process in model.Porcesses)
   {
      process.OwnerID // This should be a user selected value
   }
   // code removed for brevity 
} 
```

如果您愿意，我可以帮助获取 TestModel 值，但我现在需要做一些工作；）

# c# - 如何使用 Ruby 将时间从 .net 纪元转换为 Unix 纪元中的时间？

> ID：13574937
> 
> 赞同：1
> 
> 时间：2012-11-26T23:25:51.103
> 
> 标签：c#, .net, ruby, unix-timestamp

`C#`我有一个来自（`.NET`epoch:）的输入时间戳`00:00:00 (midnight), January 1, 0001`，我想在`Ruby`世界（`Unix`epoch:）中输出它`00:00:00 UTC on 1 January 1970`。

输入时间戳在 中给出`UTC`，并从 .NET 的[DateTime(Int64)](http://msdn.microsoft.com/en-us/library/z2xf7zzk.aspx)派生，它是“*日期和时间，以自 0001 年 1 月 1 日 00:00:00.000 公历中经过的 100 纳秒间隔数表示日历。* ”

输入时间戳：`634891434586852680`

输出应该是太平洋标准时间下午 5 点之后的 2012 年 11 月 21 日。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:27:34.840

```
input =                         634891434586852680
UNIX_EPOCH_IN_100NS_INTERVALS = 621355968000000000

Time.at((input-UNIX_EPOCH_IN_100NS_INTERVALS)*1e-7).utc.getlocal
 => 2012-11-21 17:10:58 -0800 
```

在 Ruby 中，[时间](http://www.ruby-doc.org/core-1.9.3/Time.html) *在内部存储为自 1970 年 1 月 1 日 00:00 UTC 纪元以来的秒数。*因此，我们必须从 转换`100-nanosecond intervals`为`seconds`。

的转换因子`1e-7`是`1e2/1e9`可以`100/1000000000`解释为：

```
X intervals * 100ns/interval * 1s/1000000000ns 
```

`intervals`取消自己，就像 一样，`nanoseconds`我们只剩下`seconds`; 和`100/1000000000 seconds`是`1e2/1e9 seconds`哪个是`1e-7 seconds`。

# c++ - Eclipse 中 C++ 的“main()”错误没有可用的源代码

> ID：13574938
> 
> 赞同：3
> 
> 时间：2012-11-26T23:25:52.050
> 
> 标签：c++, eclipse, debugging

我知道以前很多人都问过这个问题，但我一直无法解决。我想在eclipse中调试一个makefile项目，但我不能。我刚学c++，不知道makefile怎么写，但是老师给了我一个用，我贴在下面了。我该如何解决这个错误？

另外，如果对你们有任何帮助，我只想调试 DijkstraTest.cpp 主函数，而不是任何其他的。

```
# first name a variable objects for all object files
# FOR strauss
#CXX = CC

objectsqueue = LinkedList.o

objectstestqueue = QueueTests.o

objectsheap = BinaryHeap.o

objectstestheap = BinaryHeapTest.o

objectsdijkstra = CSV.o Network.o Dijkstra.o

objectstestdijkstra = DijkstraTest.o

# name a variable sources for all source files

sourcesqueue = LinkedList.cpp

sourcestestqueue = QueueTests.cpp

sourcesheap = BinaryHeap.cpp

sourcestestheap = BinaryHeapTest.cpp

sourcesdijkstra = CSV.cpp Network.cpp Dijkstra.cpp

sourcestestdijkstra = DijkstraTest.cpp

# now make default target all exe files
all: testqueue testheap testdijkstra

# list the dependencies for object files - those header files which help build objects
LinkedList.cpp: Collection.h Stack.h Queue.h
QueueTests.o: QueueTests.cpp LinkedList.cpp
BinaryHeap.o: BinaryHeap.h 
BinaryHeapTest.o: BinaryHeap.h 
Dijkstra.o: CSV.h Dijkstra.h Network.h BinaryHeap.h 

# how to build all object files from all dependent source files

$(objectsqueue): $(sourcesqueue)
$(CXX) -c $(sourcesqueue) $(INCLUDES)

$(objectstestqueue): $(sourcestestqueue)
$(CXX) -c $(sourcestestqueue) $(INCLUDES)

$(objectsheap): $(sourcesheap)
$(CXX) -c $(sourcesheap) $(INCLUDES)

$(objectstestheap): $(sourcestestheap)
$(CXX) -c $(sourcestestheap) $(INCLUDES)

$(objectsdijkstra): $(sourcesdijkstra)
$(CXX) -c $(sourcesdijkstra) $(INCLUDES)

$(objectstestdijkstra): $(sourcestestdijkstra)
$(CXX) -c $(sourcestestdijkstra) $(INCLUDES)

clean:
rm -f *.o
rm -f *.exe

testqueue:  $(objectsqueue) $(objectstestqueue)
$(CXX) -o QueueTests.exe $(objectsqueue) $(objectstestqueue)

testheap: $(objectsheap) $(objectstestheap) 
$(CXX) -o BinaryHeapTest.exe $(objectsheap) $(objectstestheap)

testdijkstra: $(objectsheap) $(objectsdijkstra) $(objectstestdijkstra) 
$(CXX) -o DijkstraTest.exe $(objectsheap) $(objectsdijkstra) $(objectstestdijkstra) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:47:34.977

为了能够调试应用程序，您需要使用`-g`(debug) 标志对其进行编译：

```
CXXFLAGS=-g

$(objectsqueue): $(sourcesqueue)
$(CXX) $(CXXFLAGS) -c $(sourcesqueue) $(INCLUDES)

...

testqueue:  $(objectsqueue) $(objectstestqueue)
$(CXX) $(CXXFLAGS) -o QueueTests.exe $(objectsqueue) $(objectstestqueue)

.... 
```

您需要将此标志用于所有编译规则。

# java - Android (Java) 实时音频输入（麦克风和 USB）和输出

> ID：13574942
> 
> 赞同：12
> 
> 时间：2012-11-26T23:26:09.327
> 
> 标签：java, android, audio, real-time, microphone

我想构建一个 Android 应用程序来从两个麦克风获取音频数据，将声音与内存中的一些混合，然后通过耳机播放声音。这需要实时完成。您能否请我参考一些教程或任何参考资料，以使用 Java eclipse 进行实时音频输入、混合和输出？

到目前为止，我能够录制声音，保存它，然后播放它，但是我找不到任何以这种方式与声音硬件进行实时接口的教程。

注意：一个麦克风通​​过分线器连接到安卓的 3.5 毫米耳机插孔，另一个通过 USB 端口连接。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-13T10:34:52.573

我在这里看到两个问题：

1) 通过 USB 输入音频。
音频输入可以使用 android 3.2+ 和 libusb 完成，但这并不容易（您需要从 libusb 获取 USB 描述符，自己解析它们并将正确的控制传输发送到设备等）。对于某些手机，您可以通过 USB 获得大约 5-10 毫秒的输入延迟。

2) 实时音频输出。这是 Android 中一个长期存在的问题，如果您想接近实时（使用原生音频输出），目前您几乎只能使用 Galaxy Nexus。但是，如果您掌握 USB，您也可以以更少的延迟进行输出。

我想如果你不厌其烦地让 USB 工作，你可以得到一个带立体声输入的 USB 音频设备。如果你在每个输入通道上连接了一个单声道麦克风，那么通过 USB 输出你会非常接近你的既定目标。您可能想尝试“USB Audio Tester”或“usbEffects”应用程序，看看目前有什么可能。

在编码混合和输出等方面，您可能希望一个线程读取每个单独的输入源并以小块写入队列（一次 100-1000 个样本）。然后有一个单独的线程读取队列并混合，将输出放置到另一个队列中，最后一个线程（如果不通过 USB 进行输出，可能在本机代码中）读取混合队列并进行输出。

以下链接[http://code.google.com/p/loopmixer/](http://code.google.com/p/loopmixer/)具有处理音频本身的风格。

# swing - Java - 单击按钮后如何延迟

> ID：13574943
> 
> 赞同：1
> 
> 时间：2012-11-26T23:26:12.220
> 
> 标签：swing, jbutton, sleep

我有一个家庭作业要做一个专注的游戏。我唯一想不通的是在第二张卡片被点击后延迟翻转卡片（只是延迟部分）。我有它，以便在单击时显示卡片，如果它不匹配，它应该延迟，然后隐藏卡片。如果我在它应该显示卡片之后使用 Thread.sleep，它只是在那之前休眠并且从不实际显示它。

有没有办法用 Thread.sleep 做到这一点，还是我必须使用计时器？我还没有努力，但我无法让计时器正常工作，因为它应该停止允许输入，直到延迟结束并且卡片被翻转回来。

编辑：没关系，我只是使用计时器并在做任何事情之前检查它是否已经运行。

# automata - 如何处理数组最小化转换图

> ID：13574944
> 
> 赞同：0
> 
> 时间：2012-11-24T01:14:07.270
> 
> 标签：automata, finite-automata

我正在尝试编写一个最小化转换图的程序（它基本上结合了具有相似数字的状态）。基本上，该算法是首先找到具有相同 'a' 和 'b' 输入的状态，将它们组合起来，将它们从 'leftovers' 列表中删除，然后找到具有 'a' 或 'b' 的状态并将它们组合起来。

这是一个例子：

```
Initial TG:
final state is state 1
State  Input a  Input b
[0]    [3]      [1]
[1]    [1]      [4]
[2]    [3]      [1]
[3]    [6]      [3]
[4]    [2]      [7]
[5]    [1]      [3]
[6]    [2]      [5]
[7]    [1]      [3]

final state     leftover
[ 1 ]           [ 0 2 3 4 5 6 7 ]

final state    same a,b   leftover
[ 1 ]          [ 0 2 ]    [ 3 4 5 6 7 ]

final state    same a,b   same a,b    leftover
[ 1 ]          [ 0 2 ]    [5 7 ]      [ 3 4 6 ]

final state    same a,b   same a,b    same a     leftover
[ 1 ]          [ 0 2 ]    [ 5 7 ]     [ 4 6 ]    [ 3 ]

The Final Minimized TG is now:
State  Input a  Input b
[0,2]  [3]      [1]
[1]    [1]      [4,6]
[3]    [4,6]    [3]
[4,6]  [0,2]    [5,7]
[5,7]  [1]      [3] 
```

我面临的问题是知道如何/如何处理数组，因为可能存在任意数量的组合，具体取决于给定转换图中的状态数量。关于如何编码的任何想法或关于如何处理一切的任何建议？

干杯

# php - 代币和重新提交

> ID：13574950
> 
> 赞同：-1
> 
> 时间：2012-11-26T23:27:23.827
> 
> 标签：php

我在这里查看了几个问题，似乎找不到我要找的东西。

我有一个程序，它创建一个隐藏的令牌字段来检查用户是否真的从那个页面发送它，这很好，但现在我发现它创建一个令牌的每个页面都使最后一页有效。我没有选择为每个会话创建一个令牌，并且我有一个没有替换的标头 303，例如：

```
header("Location: " . $_SERVER['PHP_SELF'], false, 303); 
```

当此代码运行时，我看到标题可以刷新我没有得到“重新提交数据？” 并且我在标头之后回显了数据，并且似乎没有回显它。

我喜欢每页与回发数据很好地配合使用，但仅适用于请求的最后一页和带 303 的每个会话，重新发布/令牌有效，但它不会在标题后回显数据。还是有其他方法可以允许令牌并禁用重新提交数据并能够回显我需要用户查看的数据？

如果您需要一些示例代码，我很乐意编辑这篇文章。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:32:28.360

我假设，您将令牌存储在会话中 - 因此解决此问题的最简单方法不是存储**单个**令牌，而是存储令牌**列表**，每个令牌都有一个到期日期。

因此，每当您使用令牌创建页面时，都会将其附加到列表中。每当你验证一个令牌时，你循环列表，删除过期的令牌，验证所有有效的令牌。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:48:18.653

目前尚不清楚为什么*会*在浏览器中看到数据。（它实际上可能正在打印，只是没有使用。通过 telnet、数据包捕获或其他一些捕获标头内容的方法进行调试，如果这很重要的话。）

...我认为您的问题来自期望 POST 内容被重新发送或以其他方式查看。它不会是：303 重定向（按规范）通过 GET 跟随。一旦浏览器看到 303 重定向和 Location 标头，它将跟随新的 URL 并忽略响应的内容。

# sql - @DBStatus INT OUTPUT 和相应的 SELECT @DBStatus = @@ERROR; 的目的是什么？

> ID：13574961
> 
> 赞同：0
> 
> 时间：2012-11-26T23:28:27.523
> 
> 标签：sql, reporting-services, ssms

在我使用的公司的存储过程中，在 USE 和 SET 的设置命令之后，以及在 CREATE 命令之后我看到

```
CREATE PROCEDURE [dbo].[prc_InsertRespondentSessionSurveyQuotaLifeCycle]
@DBStatus INT OUTPUT, 

...etc etc

 SELECT @DBStatus = @@ERROR 
```

这些额外行的目的是什么？我所知道的是，当我创建新的 SSRS .rdl 报告时，我必须删除它们。

谢谢 ！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:31:01.470

`@@ERROR`是一个系统变量，始终包含来自数据库引擎的最新错误。

`@DBStatus`是一个变量，它存储该值并将其作为存储过程的输出参数返回。这样您就可以检查在执行存储过程期间发生的错误。

# titanium - 钛窗。打开很慢

> ID：13574963
> 
> 赞同：0
> 
> 时间：2012-11-26T23:28:42.467
> 
> 标签：titanium

所以我在一个窗口中调用了`window.open()`另一个窗口。当然，这发生在单击按钮时。

两个窗口都是`modal = true`

但是，我想要的是，当按下任一窗口上的后退按钮时，我会跳回我的根 tabGroup。

我还想在关闭任一窗口时跳回根选项卡组。

当然，这不是第一个窗口的问题，但是我生成的第二个窗口是......所以我所做的是

```
second.open();
first.close(); 
```

可悲的是，在我的设备上，这留下了一个“暂停”，“未聚焦”的 rootTabgroup 显示了半秒左右......似乎在第二个窗口打开之前，Titanium 关闭了第一个窗口......这导致了视图回到他不专注的tabGroup。

这是愚蠢和丑陋的。我可以（并且已经）绕过这个问题，只是删除我正在使用的视图并添加一个新视图......但出于兴趣，有没有一种方法可以完全加载一个窗口，然后关闭当前的窗口，而无需业余时间歇斯底里?

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T23:34:16.043

等到新窗口打开后再关闭旧窗口。

```
win2.addEventListener('open', function() { win1.close(); });
win2.open(); 
```

或者：

```
win2.open();
setTimeout(function() { win1.close(); }, 1000); 
```

# visual-c++ - shell用c++执行

> ID：13574964
> 
> 赞同：0
> 
> 时间：2012-11-26T23:28:43.363
> 
> 标签：visual-c++

我正在开发一个应用程序，该应用程序将在打开的任何程序中触发 UAC 提示`ShellExecute`。

我不知道如何硬编码`ShellExecute`运行路径。截至目前，该程序使用`arg[0]`. 我怎样才能建立一个字符串来代替`arg[0]`就行`sinfo.lpFile = arg[0];`？

我很新，所以如果你不明白为什么在该行中添加一个字符串可以解决我的问题，那么你很可能是对的。

```
#include "stdafx.h"

#include <string.h>
#include <stdlib.h>
#include <stdio.h>
#include <errno.h>
#include <shellapi.h>
#include <process.h>

#include "uac-example.h"

int WINAPI WinMain(HINSTANCE inst, HINSTANCE prevInst,LPSTR cmdLine, int nCmdShow){
    LPWSTR *arg;
    int argc = 0;
    HRESULT ret = SUCCESS;
    WCHAR imagePath[MAXPATHLEN];
    WCHAR workingDir[MAXPATHLEN];
    WCHAR uacDir[MAXPATHLEN];
    WCHAR uacRunningLockFilePath[MAXPATHLEN];
    HANDLE uacRunningLockFileHandle = INVALID_HANDLE_VALUE;
    WCHAR elevatedLockFilePath[MAXPATHLEN];
    HANDLE elevatedLockFileHandle = INVALID_HANDLE_VALUE;
    arg = CommandLineToArgvW(GetCommandLineW(),&argc);
    //if(arg == NULL || argc < 2) {
    //  ERRORBOX("Missing required program arguments.\n\nUsage:\nuac-example.exe <working directory>");
    //  return FAILURE;
    //}
    GetModuleFileName(NULL, imagePath, MAXPATHLEN);
    arg[0] = imagePath;
    wcscpy_s((wchar_t *)uacDir, MAXPATHLEN, arg[1]);
    _snwprintf_s(uacRunningLockFilePath, MAXPATHLEN, MAXPATHLEN,
                    _T("%s/") _T(RUNNING_LOCK_FILE), uacDir);
    wcscpy_s(workingDir, MAXPATHLEN, imagePath);
    WCHAR *slash = wcsrchr(workingDir, '\\');
    wcscpy_s(slash, MAXPATHLEN, _T(""));
    _snwprintf_s(elevatedLockFilePath, MAXPATHLEN, MAXPATHLEN,_T("%s/") _T(ELEVATE_LOCK_FILE), workingDir);
    uacRunningLockFileHandle = CreateFileW(uacRunningLockFilePath,(GENERIC_READ | GENERIC_WRITE),0,NULL,OPEN_ALWAYS,FILE_FLAG_DELETE  _ON_CLOSE,NULL);
    if (uacRunningLockFileHandle == INVALID_HANDLE_VALUE) {
        if (_waccess(elevatedLockFilePath, F_OK) == 0 &&
                _wremove(elevatedLockFilePath) != 0) {
            return FAILURE;
        }
        elevatedLockFileHandle = CreateFileW(elevatedLockFilePath,(GENERIC_READ | GENERIC_WRITE),0,NULL,OPEN_ALWAYS,FILE_FLAG_DELETE  _ON_CLOSE,NULL);
        if(elevatedLockFileHandle == INVALID_HANDLE_VALUE){
            ERRORBOX("Unable to acquire the necessary permissions to run demo app.");
            return FAILURE;
        }
        LPWSTR spawnCmdLine = BuildCommandLine(argc - 1, arg + 1);
        if(!spawnCmdLine){
            CloseHandle(elevatedLockFileHandle);
            ERRORBOX("An error occured while respawning self.");
            return FAILURE;
        }
        SHELLEXECUTEINFO sinfo;
        memset(&sinfo, 0, sizeof(SHELLEXECUTEINFO));
        sinfo.cbSize = sizeof(SHELLEXECUTEINFO);
        sinfo.fMask = SEE_MASK_FLAG_DDEWAIT | SEE_MASK_NOCLOSEPROCESS;
        sinfo.hwnd = NULL;
        sinfo.lpFile = arg[0];
        sinfo.lpParameters = spawnCmdLine;
        sinfo.lpVerb = L"runas"; // <<-- this is what makes a UAC prompt show up
        sinfo.nShow = SW_SHOWMAXIMIZED;
        BOOL result = ShellExecuteEx(&sinfo);
        LocalFree(spawnCmdLine);
        if(result){
            WaitForSingleObject(sinfo.hProcess, INFINITE);
            CloseHandle(sinfo.hProcess);
            return SUCCESS;
        }else{
            return FAILURE;
        }
    }
    EXIT_IF_ELEVATED(elevatedLockFilePath,uacRunningLo  ckFileHandle,SUCCESS);
    LocalFree(arg);
    return SUCCESS;
}

// ----------------------------------------------------------------------
// The following code was taken directly from the Mozilla Firefox Updater
// source tree, and slightly modified to support "Wide" strings in
// Visual C++.
// ----------------------------------------------------------------------

LPWSTR
BuildCommandLine(int argc, LPWSTR *argv){
    int i;
    int len = 0;
    // The + 1 of the last argument handles the
    // allocation for null termination
    for (i = 0; i < argc; ++i) {
        len += ArgStrLen(argv[i]) + 1;
    }
    // Protect against callers that pass 0 arguments
    if (len == 0) {
        len = 1;
    }
    LPWSTR s = (LPWSTR)malloc(len * sizeof(LPWSTR));
    if (!s) {
        return NULL;
    }
    LPWSTR c = s;
    for (i = 0; i < argc; ++i) {
        c = ArgToString(c, argv[i]);
        if (i + 1 != argc) {
            *c = ' ';
            ++c;
        }
    }
    *c = '\0';
    return s;
}
int
ArgStrLen(LPWSTR s) {
  int backslashes = 0;
  int i = wcslen(s);
  BOOL hasDoubleQuote = wcschr(s, L'"') != NULL;
  // Only add doublequotes if the string contains a space or a tab
  BOOL addDoubleQuotes = wcspbrk(s, L" \t") != NULL;
  if (addDoubleQuotes) {
    i += 2; // initial and final duoblequote
  }
  if (hasDoubleQuote) {
    while (*s) {
      if (*s == '\\') {
        ++backslashes;
      } else {
        if (*s == '"') {
          // Escape the doublequote and all backslashes preceding the doublequote
          i += backslashes + 1;
        }
        backslashes = 0;
      }

      ++s;
    }
  }

  return i;
}
LPWSTR
ArgToString(LPWSTR d, LPWSTR s) {
  int backslashes = 0;
  BOOL hasDoubleQuote = wcschr(s, L'"') != NULL;
  // Only add doublequotes if the string contains a space or a tab
  BOOL addDoubleQuotes = wcspbrk(s, L" \t") != NULL;
  if (addDoubleQuotes) {
    *d = '"'; // initial doublequote
    ++d;
  }
  if (hasDoubleQuote) {
    int i;
    while (*s) {
      if (*s == '\\') {
        ++backslashes;
      } else {
        if (*s == '"') {
        // Escape the doublequote and all backslashes\
        // preceding the doublequote
          for (i = 0; i <= backslashes; ++i) {
            *d = '\\';
            ++d;
          }
        }
        backslashes = 0;
      }
      *d = *s;
      ++d; ++s;
    }
  } else {
    wcscpy(d, s);
    d += wcslen(s);
  }
  if (addDoubleQuotes) {
    *d = '"'; // final doublequote
    ++d;
  }
  return d;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T00:02:29.553

简单来说：

```
char path[] = "C:\\program.exe";
sinfo.lpFile = path; 
```

# java - 测试 ehcache 手动配置的集群是否正常工作

> ID：13574965
> 
> 赞同：0
> 
> 时间：2012-11-26T23:28:52.583
> 
> 标签：java, cluster-computing, ehcache

**问题背景：**

我们正在对使用 ehcache 进行缓存的第 3 方应用程序进行升级。我们计划在生产中集群化四台服务器。

供应商提供了默认的 ehcache 配置以通过 rmi 进行集群，使用多播来发现对等点。

问题是我们的网络在短期内不支持多播，所以我们不得不覆盖默认配置来手动指定对等点。由于预算限制，使用兵马俑是不可能的。

由于这是一个升级项目，在上线之前我将无法真正测试手动配置的结果。手动配置字符多，手动编写，有出错的风险。

**我的问题**

有没有开源的jsp或者类似的东西可以用来将缓存集群信息显示到屏幕上。我们可以将其合并到第 3 方应用程序中，并使用它来快速验证是否正确发现了对等方。

**我所调查的**

我用谷歌搜索 ehache，但我的过滤技能未能将结果缩小到任何有用的范围内。

我已经研究过使用日志来跟踪缓存发生的时间，但我对这种方法并不是 100% 满意。

无法找到预先构建的解决方案将需要我自己编写。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T13:12:37.443

关于兵马俑和预算限制 - 还有一个免费的开源版本：参见[http://terracotta.org/downloads/open-source/catalog](http://terracotta.org/downloads/open-source/catalog)

只要您想使用堆外内存、分布式搜索或水平扩展，就需要商业许可证，但由于您的用例似乎只涉及节点之间的基本同步，因此开源版本就足够了。

让 terracotta 服务器同步您的缓存意味着更少的网络开销和改进的一致性保证（这不是使用对等复制提供的）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-20T09:46:38.763

[可以使用Ehcache 监控工具](http://blogs.terracotta.org/downloads/monitor)来提供缓存统计信息。一些[参考资料](http://cachemonitoring.blogspot.in/)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:34:06.477

有一个 MBean 可用于在运行时监控 ehcache：

见[http://ehcache.org/documentation/user-guide/jmx](http://ehcache.org/documentation/user-guide/jmx)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-27T03:54:59.340

我不得不自己写这个。如果其他人需要，这是代码。

```
@Controller
@RequestMapping(value = "/tools/ehcache")
public class EhcacheManagerController {

private static final String VIEW_URL = "/WEB-INF/views/tools/ehcache/ehcache.jsp";

private static final String ALL = "all";

List<CacheManager> allCacheManagers = CacheManager.ALL_CACHE_MANAGERS;

private static final Log logger = LogFactory.getLog(EhcacheManagerController.class);

@RequestMapping(method = RequestMethod.GET)
protected String loadPage(ModelMap modelMap) throws Exception {

    // Manager (keyed by name) --> Cache (keyed by name) --> Peer Information (keyed by peer Name)

    Map<String,Map<String,Map<String,String>>> managerMap = new HashMap<String,Map<String,Map<String,String>>>();
    for (CacheManager cacheManager : allCacheManagers) {
        Map<String,Map<String,String>> cacheMap = new HashMap<String,Map<String,String>>();
        managerMap.put(cacheManager.getName(), cacheMap);           

        String[] cacheNames = cacheManager.getCacheNames();
        for (String name : cacheNames) {
            Map<String,String> peerInfoMap = new HashMap<String,String>();
            cacheMap.put(name,peerInfoMap);

            CacheManagerPeerProvider provider = cacheManager.getCacheManagerPeerProvider("RMI");
            if (provider == null) {
                peerInfoMap.put("nopeer","no status");
                break;
            }

            Cache ehcache = cacheManager.getCache(name);
            List<CachePeer> cachePeers = provider.listRemoteCachePeers(ehcache);
            for (CachePeer cachePeer : cachePeers) {
                StringBuilder cacheStatus = new StringBuilder();
                String peerName = cachePeer.getName();
                cacheStatus.append("url='").append(cachePeer.getUrl()).append("' ");
                cacheStatus.append("keyssize='").append(cachePeer.getKeys().size()).append("' ");

                peerInfoMap.put(peerName,cacheStatus.toString());
            }

        }

    }

    modelMap.put("managerMap", managerMap);

    return VIEW_URL;
}
} 
```

jsp

```
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"     "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>EHCache</title>
</head>
<body>
<h1>EHCache</h1>

<p><a href="/tools/ehcache/clear?name=all">Clear All</a></p>
<c:forEach items="${managerMap}" var="manager">
<h2>Manager: '${manager.key}'</h2>

    <c:forEach var="cacheMap" items="${manager.value}">
        <h3>Cache: '${cacheMap.key}'</h3>
        <p><a href="/tools/ehcache/clear?cacheManagerName=${manager.key}&cacheName=${cacheMap.key}">clear</a></p>

        <c:forEach var="peerInfoMap" items="${cacheMap.value}">
            <li>peer name = ${peerInfoMap.key} peer status = ${peerInfoMap.value}</li>
        </c:forEach>    
    </c:forEach>

</c:forEach>

</body>
</html> 
```

# coldfusion - 如何停止已启动的 ColdFusion MX-7 计划任务

> ID：13574967
> 
> 赞同：0
> 
> 时间：2012-11-26T23:29:11.203
> 
> 标签：coldfusion, coldfusion-7

我继承了一个 Coldfusion MX7 应用程序，该应用程序运行时间很长，用户不小心踢了它。

根据我的计算，按照目前的速度，这项工作将运行 3 天。

似乎没有办法通过管理员界面来停止正在运行的作业。

正在填充的表格可以很容易地重新填充，所以我认为停止冷融合服务不会影响除了表格之外的任何东西，这不是问题。

我对吗？那安全吗？还有其他方法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-27T00:44:59.693

一次性重启服务应该没问题。将来，您可能需要添加必需的 url 参数或其他此类安全机制，以防止这个漫长的过程意外中断。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-28T18:49:24.220

检查任务是否已经有明确的超时设置

*   [显式超时](http://www.communitymx.com/content/source/46A29/)

否则使用默认页面超时

*   [服务器设置](http://help.adobe.com/en_US/ColdFusion/9.0/Admin/WSc3ff6d0ea77859461172e0811cbf3638e6-7ffc.html#WSc3ff6d0ea77859461172e0811cbf3638e6-7ffb)

对于较新版本的 ColdFusion 8 及更高版本，您可以在标有“中止无响应或麻烦的请求/线程”的部分中使用服务器监视器终止正在运行的页面

*   [使用服务器监视器](http://www.adobe.com/devnet/coldfusion/articles/monitoring_pt2.html)。

也可以通过终止 SQL Server 任务来停止处理：

*   [是否有适用于 SQL Server 2008 及更高版本的任务管理器？](https://stackoverflow.com/questions/3073248/is-there-a-task-manager-of-sorts-for-sql-server-2008-and-on)

# android - 更改应用程序名称和包

> ID：13574970
> 
> 赞同：1
> 
> 时间：2012-11-26T23:29:33.657
> 
> 标签：android, eclipse

我决定更改我的应用程序的名称。我更新了对应用程序的所有引用，包括清单中的引用、项目、包名称等。

如果我 grep 应用程序的目录，所有对旧名称的引用都消失了。

但是，当我编译我的应用程序并将其发送到模拟器时，Eclipse 的右下角显示“Launching OldAppName”。

我该如何解决？显然，有一个参考在某处徘徊。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:38:53.583

You need to edit Run/Debug entry name in project settings

# r - 子集和组合/匹配数据

> ID：13574972
> 
> 赞同：1
> 
> 时间：2012-11-26T23:29:38.430
> 
> 标签：r

我有一个包含 4 列的数据框...日期、小时、位置、值。

我想对数据做的是为每个唯一的日期/小时/位置提供汇总统计信息。这似乎很容易，因为我可以做到

```
x <- subset(my.df[,4], 
            my.df[,2]==(some parameter) & my.df[,3]==(another parameter)
           ) 
```

然后从 x 获取我想要的任何汇总统计信息。然而，棘手的部分是我还想从上述值的每个差异中获取汇总统计信息。因此，例如，我想`loc=1`从`value`何时开始计算价值的差异`loc=2`，`hour=1`但在任何一个位置中可能会或可能不会丢失天数。我有一个可能会起作用的想法是重塑`my.df`更宽两次。首先使它变宽，`timevar=loc`然后用它重塑它，`timevar=hour`这样我就可以得到带有 Date、value.1.1、value.1.2 等列的 wide.df，其中第一个整数是 loc，第二个整数是小时，每一行都是唯一的日期。

有没有更直接的做法，不涉及 20 分钟的整形（最初的 df 大约是 9493401 行，有 4 个变量，然后我将它扩展到 720 行，有 14857 列？
@Brandon：这是 str 输出。不过，我还没有尝试过你的建议。

```
 'data.frame':   9493401 obs. of  4 variables:
    $ Loc  : int  1 1 1 1 1 1 1 1 1 1 ...
    $ Date: POSIXct, format: "2010-10-29" "2010-10-29" ...
    $ Hour     : int  1 2 3 4 5 6 7 8 9 10 ...
    $ Value   : num  7.63 4.07 4.9 1.61 0.34 -5.23 2.11 2.39 7.2 4.41 ... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-27T00:00:37.523

在这`dcast`方面`reshape2`似乎很活泼：

```
library(reshape2)
dat <- data.frame(date=sample(1:100,9493401,replace=TRUE),
                  hour=rep(1:24,1000000)[1:9493401],
                  loc=rep(letters[1:9],1054823)[1:9493401],
                  value=rnorm(9493401))     

dcast(dat,date + hour ~ loc) 
```

您还可以执行诸如 loc/hour 计数之类的操作

```
dcast(dat, date + hour ~ loc*hour) 
```

如果您想要特定于您的案例的答案，则需要提供更多信息。

# java - 从子类获取数据：Java

> ID：13574973
> 
> 赞同：0
> 
> 时间：2012-11-26T23:29:43.637
> 
> 标签：java, inheritance, polymorphism

我是新来的，所以如果我不遵守标准礼仪，我会提前道歉。

我想知道如何使用 ArrayLists 从子类中获取数据。

```
import java.io.*;
import java.util.*;

public class MyProgrammingLab {

    public static void main(String[] args){
        ArrayList<Test> testArray = new ArrayList<>();

        testArray.add(new Test("First"));
        testArray.add(new SubTest("Last"));

        System.out.println(testArray.get(0).getFirstName());
        System.out.println(testArray.get(1).getLastName());
    }
}

public class Test {
    private String firstName;

    public Test(){
    }

    public Test(String firstName){
        this.firstName = firstName;
    }

    public String getFirstName() {
        return firstName;
    }
}

public class SubTest extends Test{
    private String lastName;

    public SubTest(){
        super();
    }

    public SubTest(String lastName){
        this.lastName = lastName;
    }

    public String getLastName(){
        return lastName;
    }
} 
```

我的主要“System.out.println(test.Array.get(1).getLastName());”中的行 向我抛出错误，我不知道为什么？

在我的主程序中，我将使用大小大于 1 的 ArrayList。

先感谢您！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-26T23:34:11.853

我建议在使用我即将提出的解决方案时*非常谨慎，但是：*

```
System.out.println(((SubTest) testArray.get(1)).getLastName()); 
```

但是，只有在您*确定*位置 1 的元素是 SubTest 时才执行此操作，否则您将得到一个`ClassCastException`.

如果你不确定，你应该检查一下。

```
Test whatIGot = testArray.get(1);
if(whatIGot instanceof SubTest) {
   SubTest whatIActuallyGot = (SubTest)whatIGot;
   System.out.println(whatIActuallyGot.getLastName());
} 
```

一般来说，当你有一个超类类型的变量时，你应该避免依赖子类的属性。这样做是一种代码味道，可能是由糟糕的设计引起的。

正确的解决方案是问自己以下两个问题：

*   您绝对确定`getLastName`属于`SubTest`而不属于`Test`吗？如果`getLastName()`在`Test`，那将完全解决问题。
*   你真的需要`getLastName`从一个`testArray`元素访问吗？

如果`getLastName()` *确实*属于`Test`（所有实例`Test`都有*一些*姓氏），但您没有很好的默认值，那么请考虑`Test`使用抽象方法创建一个抽象类`getLastName`。请注意，这会使`new Test()`停止工作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:47:00.377

您的列表被声明为`Arraylist<Test>`. 这意味着它是灵活的：您可以将任何实例`Test`（包括子类的实例）放入其中。

这种灵活性带来了一个限制：稍后，当您再次取出一个元素时，您只能知道该元素是一个实例`Test`- 正如您所发现的，如果没有特定的类型检查，您无法判断该条目是否是一个`Test`或一个`SubTest`。（考虑一下如果列表必须返回条目的确切类型，你甚至会如何编写`get`方法`ArrayList`——方法的返回类型会根据传入的索引而改变！）

如果您需要这种灵活性（并且您的示例代码建议您这样做，因为您还存储了的实例`Test`）`SubTest`，您最简单的选择是检查类型和强制转换：

```
Test secondEntry = testArray.get(1);
if (secondEntry instanceof SubTest) {
    System.out.println(((SubTest) secondEntry).getLastName());
} 
```

尽管正如其他人所指出的那样，这在某种程度上违背了使用泛型的意义。

其他替代方案包括：

*   将您的`getLastName`方法向上移动到父类，然后在子类中覆盖它（如果父类具有此方法有意义）；
*   使用基于类型的调度来实现[策略模式。](http://en.wikipedia.org/wiki/Strategy_pattern)

这看起来像：

```
import java.io.*;
import java.util.*;

public class MyProgrammingLab {

    public static void main(String[] args) {
        ArrayList<Test> testArray = new ArrayList<Test>();

        testArray.add(new Test("First"));
        testArray.add(new SubTest("Last"));

        for (Test aTest : testArray) {
            emit(aTest);
        }

    }

    public static void emit(Test aTest) {
        if (aTest instanceof SubTest) {
            System.out.println(((SubTest) aTest).getLastName());
        } else {
            System.out.println(aTest.getFirstName());
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:41:53.917

[查看Java 继承教程](http://docs.oracle.com/javase/tutorial/java/IandI/subclasses.html)可能会有所帮助。

当您声明一个 ArrayList 时，您明确表示您期望一个*完全是* `Test`. 您可以使用泛型来包含 Test 和任何扩展它的东西，这就是`ArrayList<? extends Test>`它的作用。

虽然这可以解决您的确切问题，但您应该知道[扩展具体类](http://billharlan.com/pub/papers/Avoid_extending_classes.html)是糟糕的设计，您应该使用中间实例变量（例如`Test test1 = testArray.get(0)`）以避免违反[Demeter 定律](http://c2.com/cgi/wiki?LawOfDemeter)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-26T23:37:14.210

`testArray.get(1)` is returning type `Test`, not `SubTest`. If you're absolutely sure it's a `SubTest` (you can do `instanceof` to check), then you can use

```
System.out.println(((SubTest) testArray.get(1)).getLastName()); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-11-26T23:38:01.867

Because you declared it like this:

```
ArrayList<Test> testArray; 
```

Java only knows that the `ArrayList` contains `Test` objects. Therefore, it **does not know** about any methods in the child class, **even if the object has that method**.

If you add this:

```
public String getLastName(){
    return ""; // do nothing
} 
```

To your `Test` class, it will compile and work as you expect, because **now** `Test` objects have the `getLastName()` method.

Other solutions suggest casting, but I **strongly recommend against casting** here because that defeats the purpose of using generics. You don't want to be in situations where you cast and then handle `ClassCastException`s. The point of generics is to elegantly handle situations exactly like yours.

# ios - 当应用确实在iOS上进入后台时继续操作

> ID：13574974
> 
> 赞同：11
> 
> 时间：2012-11-26T23:29:49.477
> 
> 标签：ios, background-process, nsoperation

在我的应用程序中，我有一些 NSOperation 从在线数据库更新一些核心数据元素，有时更新需要一些时间，当 iPhone 屏幕锁定时，应用程序进入后台模式，并且此更新停止，所以我有重新打开应用程序以继续更新，所以我在堆栈溢出上搜索了很多，我找到了一些关于：

```
beginBackgroundTaskWithExpirationHandler 
```

这是来自苹果的一种方法，当应用程序处于后台模式时也可以继续执行某些任务，我已经这样做了：

```
- (void)applicationDidEnterBackground:(UIApplication *)application
{

UIApplication  *app = [UIApplication sharedApplication];
UIBackgroundTaskIdentifier bgTask;

bgTask = [app beginBackgroundTaskWithExpirationHandler:^{
    [app endBackgroundTask:bgTask];
}];
} 
```

现在应用程序在后台继续执行任务，似乎一切正常，所以我的问题是，我使用的这种方法安全吗？还是有更好的模式？

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-11-26T23:46:11.157

这不是你这样做的方式。您想在后台运行的任何代码都必须正确包装。像这样的东西：

```
- (void)someMethodToKeepRunningInBackground {
    UIBackgroundTaskIdentifier taskId = [[UIApplication sharedApplication] beginBackgroundTaskWithExpirationHandler:^(void) {
        // Uh-oh - we took too long. Stop task.
    }];

    // Perform task here        

    if (taskId != UIBackgroundTaskInvalid) {
        [[UIApplication sharedApplication] endBackgroundTask:taskId];
    }
} 
```

`UIApplicationDelegate applicationDidEnterBackground:`您在方法中不做任何事情。

当应用程序进入后台时，任何包含在“后台任务”调用中的任务都将被允许继续运行。

这是真正重要的部分 - 该任务最多只能获得 10 分钟。如果 10 分钟后它仍在运行，您的应用程序将被终止。在应用程序被不干净地终止之前，过期处理程序会给您几秒钟的时间来干净地结束任务。

# mysql - 检测当前是否正在使用 MySQL 数据库

> ID：13574976
> 
> 赞同：1
> 
> 时间：2012-11-26T23:30:08.883
> 
> 标签：mysql

在尝试建立新的连接之前，是否可以确定（通过查询或其他方式）是否有人已经在使用特定的 MySQL 数据库？我有一个数据库，我想一次将用户数量限制为一个。（甚至每个用户的一个实例，不一定同时有两个不同的用户）

我这样做的原因是为了防止与该数据库一起使用的程序的多个实例之间发生任何读/写冲突。由于程序的工作方式，如果在实例 A 中进行更改，它们不会立即显示在实例 B 中，直到数据被刷新。现在还没有办法实时同步这些。在实例 A 完成之前阻止实例 B 启动会更容易）在我的情况下，客户端应用程序和数据库都在本地主机上运行，​​但数据库可能是远程的。

这可以做到吗？如果是这样，有没有一种简单的方法可以通过 Qt 做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-26T23:32:04.850

听起来你想要单用户模式：

[http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-single-user-mode.html](http://dev.mysql.com/doc/refman/4.1/en/mysql-cluster-single-user-mode.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-11-26T23:41:46.063

从 MySQL 5.0.3 开始，您可以[通过 account 限制与服务器的同时连接数](http://dev.mysql.com/doc/refman/5.0/en/user-resources.html)。然后，您可以检测该帐户是否正在使用，因为服务器将拒绝其他连接尝试（错误 1203[`ER_TOO_MANY_USER_CONNECTIONS`](http://dev.mysql.com/doc/refman/5.0/en/error-messages-server.html#error_er_too_many_user_connections)或错误 1226 [`ER_USER_LIMIT_REACHED`](http://dev.mysql.com/doc/refman/5.0/en/error-messages-server.html#error_er_user_limit_reached)）。

```
GRANT USAGE ON *.* TO 'usera'@'localhost' WITH MAX_USER_CONNECTIONS 1 
```

有关资源限制的更多信息：

*   要为帐户设置资源限制，请使用[`GRANT`](http://dev.mysql.com/doc/refman/5.0/en/grant.html)语句。提供一个`WITH`将每个资源命名为受限的子句。`MAX_USER_CONNECTIONS`是一个整数，表示帐户的最大同时连接数。

*   要修改或删除帐户的限制，请使用`GRANT USAGE`全局级别的语句 ( `GRANT USAGE ON *.* TO 'usera'@'localhost' WITH ...`)。这只会修改指定的限制值，否则帐户将保持不变。

*   一个“帐户”对应于表中的一行`mysql.user`。`'usera'@'localhost'`并且`'usera'@'%.example.com'`是不同的帐户。

# jquery - jQuery - 替换字符串中字符的所有实例

> ID：13574980
> 
> 赞同：207
> 
> 时间：2012-11-26T23:30:33.740
> 
> 标签：jquery, string, replace

这不起作用，我非常需要它

```
$('some+multi+word+string').replace('+', ' ' ); 
```

总是得到

```
some multi+word+string 
```

它总是只替换第一个实例，但我需要它适用于所有 + 符号。

* * *

## 回答 #1

> 赞同：422
> 
> 时间：2012-11-26T23:31:36.760

您需要使用正则表达式，以便您可以指定全局 (g) 标志：

```
var s = 'some+multi+word+string'.replace(/\+/g, ' '); 
```

（我删除了`$()`字符串周围的，因为`replace`它不是 jQuery 方法，所以根本不起作用。）

* * *

## 回答 #2

> 赞同：47
> 
> 时间：2012-11-26T23:31:43.523

```
'some+multi+word+string'.replace(/\+/g, ' ');
                                   ^^^^^^ 
```

'g' = “全球”

干杯

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2013-09-19T19:42:45.940

在大多数情况下，RegEx 是要走的路。

在某些情况下，指定更多元素或特定元素来执行替换可能会更快：

```
$(document).ready(function () {
    $('.myclass').each(function () {
        $('img').each(function () {
            $(this).attr('src', $(this).attr('src').replace('_s.jpg', '_n.jpg'));
        })
    })
}); 
```

这会在每个字符串上替换一次，但它使用更具体的选择器来完成。

# android - 插入 5000 多个 Android 联系人的最有效方式

> ID：13574983
> 
> 赞同：8
> 
> 时间：2012-11-26T23:31:03.713
> 
> 标签：android, contacts

[我意识到这](https://stackoverflow.com/questions/5596354/insertion-of-thousands-of-contact-entries-using-applybatch-is-slow)在包括 Stack Overflow 在内的各个地方都有所涉及，但我正在寻找人们可能使用过的任何其他解决方案。所以考虑到这一点...

我正在开发一个应用程序，用户最初可以在其中将他的所有联系人与桌面应用程序 OTA 同步。这是通过 Web 服务调用完成的，该调用从服务器获取一组 100 个联系人，下载并解析信息，将联系人插入 Android 联系人数据库，确认收到这些联系人，然后对下一组重复前面的步骤100 个联系人，直到同步完成。当用户在订单上有联系人或 1000-2000 时，此过程运行良好，但此应用程序的典型用户可以轻松拥有 5000-6000 联系人（高级用户超过 10000+）在这种情况下，事情需要的时间比我要长得多会的。例如，大约 5300 个联系人的样本集可能需要大约 13.5 分钟才能完成。不错，但我

我已经记录了每个步骤所需的时间，不出所料，瓶颈似乎在于将数据插入 Android 合同数据库。在网上搜索后，我发现在插入数千个联系人方面几乎没有帮助，但我发现的似乎分为以下三组：

1) ContentProviderOperation——谷歌推荐的方法，它给了我 13.5 分钟的基线，用于 5300 个联系人。

2) Bulk Inserts -- 我读到builkInsert 往往比applyBatch 更有效，但是当我尝试自己实现它时，对于相同的5300 个联系人实际上需要25 分钟。我感觉这在很大程度上是因为我需要插入 RawContact 信息，然后保存生成的 URI 以用于为 bulkInsert 创建 ContactsContract.Data，这通过 ContentProviderOperation 中的 backValueReference 更自然。此外，我查看了 android 源代码，并没有感觉到 bulkInsert 非常高效。

3) 使用 DatabaseUtils.InsertHelper 和事务创建优化的批量插入 -- 不幸的是，这似乎适合那些创建自己的内容提供程序的人，因为您需要访问底层数据库作为实例变量，我还没有看到如何这可以通过本机联系人数据库完成。

有没有人有插入 5000 多个联系人的经验或我可以考虑的任何其他可能的想法来帮助减少我的时间？还是应该将 ContentProviderOperation 视为已优化？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-26T23:39:42.953

不幸的是，我相信 1 是最好的选择。我怀疑与 iPhone 相比，您的大部分开销都在内容提供程序设计所固有的跨进程 IPC 中。

您对 3 的分析是正确的。

有根设备上有很多选项可以绕过内容提供商，但我怀疑这就是你要找的。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2018-04-05T12:37:04.350

嗨，我在几分钟内插入了大量联系人，我的代码是：

```
public void insertContact(contactList:List<Contact>){

  val queueSize = 300 //400
            val contactQueue = contactList.size/queueSize

            if(contactQueue > 0) {

                var startIndex = 0
                var endIndex = 0

                var tempList: List<Request.ContactBean>? = null

                totalQueue = contactQueue + 1+smsQueue

                for (i in 0..contactQueue) {

                    startIndex = i * queueSize
                    endIndex = startIndex + queueSize

                    endIndex = if (endIndex < contactList.size) endIndex else contactList.size

                    tempList = contactList.subList(startIndex, endIndex);

                    Log.d(Constant.TAG_RESTORE, "In loop totalQueue: " + contactQueue + " i: " + i
                            + " startIndex: " + startIndex + "endIndex: " + endIndex + " Queuesize: " + tempList.size)

                    restoreContact(tempList);
                }
            }else{
                totalQueue = 1+smsQueue;
                restoreContact(contactList);

            }
}

    private fun restoreContact( contactList: List<Request.ContactBean>) {

        Observable.fromCallable { insertContact(contactList); }
                .subscribeOn(Schedulers.io())
                .observeOn(AndroidSchedulers.mainThread())
                .subscribe({
                    totalCompleteOperation++

                    if(totalCompleteOperation === totalQueue){

                        Log.d(Constant.TAG_RESTORE, " in subscribe restoreContact " +
                                "totalCompleteOperation: "+ totalCompleteOperation +" totalQueue "+totalQueue)

                        hideDialog();
                        completeRestore(true)
                    }
                }

                )
    }

    public void insertContact(List<Request.ContactBean> contacts) throws RemoteException, OperationApplicationException {

        final int MAX_OPERATIONS_FOR_INSERTION = 100; //100
        int size = contacts.size();

            ArrayList<ContentProviderOperation> ops = new ArrayList<>();
            for (int i = 0; i < size; i++) {

                createOperations(ops, contacts.get(i));
                if (ops.size() >= MAX_OPERATIONS_FOR_INSERTION) {
                    mContext.getContentResolver().applyBatch(ContactsContract.AUTHORITY, ops);
                    ops.clear();
                }
            }
            if (ops.size() > 0)
                mContext.getContentResolver().applyBatch(ContactsContract.AUTHORITY, ops); 

    }

    private void createOperations(ArrayList<ContentProviderOperation> ops,
                                                  Request.ContactBean contact){
        int backReference = ops.size();
        ops.add(ContentProviderOperation.newInsert(ContactsContract.RawContacts.CONTENT_URI)
                .withValue(ContactsContract.RawContacts.ACCOUNT_NAME, null)
                .withValue(ContactsContract.RawContacts.ACCOUNT_TYPE, null)
                .withValue(ContactsContract.RawContacts.AGGREGATION_MODE, ContactsContract.RawContacts.AGGREGATION_MODE_DISABLED)
                .build()
        );
            ops.add(ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
                   // .withYieldAllowed(true)
                    .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, backReference)
                    .withValue(ContactsContract.Data.MIMETYPE, ContactsContract.CommonDataKinds.StructuredName.CONTENT_ITEM_TYPE)
                    .withValue(ContactsContract.CommonDataKinds.StructuredName.GIVEN_NAME, contact.getName())
                    .build());

            if (contact.getNumbers() != null && contact.getNumbers().size() > 0) {
                // Adding insert operation to operations list
                // to insert Mobile Number in the table ContactsContract.Data
                ops.add(ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
                        //.withYieldAllowed(true)
                        .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, backReference)
                        .withValue(ContactsContract.Data.MIMETYPE, Phone.CONTENT_ITEM_TYPE)
                        .withValue(Phone.NUMBER, contact.getNumbers().get(0).getNumber())
                        .withValue(Phone.TYPE, Phone.TYPE_MOBILE)
                        .build());
                if (contact.getNumbers().size() > 1) {
                    // Adding insert operation to operations list
                    // to  insert Home Phone Number in the table ContactsContract.Data
                    ops.add(ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
                            //.withYieldAllowed(true)
                            .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, backReference)
                            .withValue(ContactsContract.Data.MIMETYPE, Phone.CONTENT_ITEM_TYPE)
                            .withValue(Phone.NUMBER, contact.getNumbers().get(1).getNumber())
                            .withValue(Phone.TYPE, Phone.TYPE_HOME)
                            .build());
                }

            }
            if (contact.getEmails() != null && contact.getEmails().size() > 0) {
                // Adding insert operation to operations list
                // to insert Work Email in the table ContactsContract.Data
                ops.add(ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
                       // .withYieldAllowed(true)
                        .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, backReference)
                        .withValue(ContactsContract.Data.MIMETYPE, Email.CONTENT_ITEM_TYPE)
                        .withValue(Email.ADDRESS, contact.getEmails().get(0).getAddress())
                        .withValue(Email.TYPE, Email.TYPE_WORK)
                        .build());
            }
            if (contact.getEmails().size() > 1) {
                // Adding insert operation to operations list
                // to insert Home Email in the table ContactsContract.Data
                ops.add(ContentProviderOperation.newInsert(ContactsContract.Data.CONTENT_URI)
                       // .withYieldAllowed(true)
                        .withValueBackReference(ContactsContract.Data.RAW_CONTACT_ID, backReference)
                        .withValue(ContactsContract.Data.MIMETYPE, Email.CONTENT_ITEM_TYPE)
                        .withValue(Email.ADDRESS, contact.getEmails().get(1).getAddress())
                        .withValue(Email.TYPE, Email.TYPE_HOME)
                        .build());
            }

    }

This code will insert huge contact list in very less time. 
```

# php - 按日期对数组进行排序并维护索引关联

> ID：13574985
> 
> 赞同：0
> 
> 时间：2012-11-26T23:31:10.393
> 
> 标签：php, arrays, sorting

php中有没有一种方法可以按日期对数组进行排序并显示它们？类似于 asort 或 usort？

问题是日期字段也可以包含“未知”之类的值。我想按日期降序打印所有记录，最后打印 UNKNOWNS。到目前为止，这是我的代码。

```
foreach ($MailPieceArr as $key => $val) {

    $count++;
    if (($count % 2) == 1) {
        print "<tr bgcolor='#CCCCCC'>";
    } else {
        print "<tr bgcolor=white>";
    }

    print "<td align=center>".$MailPieceArr[$key]["type"]."</td>";
    print "<td align=center>".$MailPieceArr[$key]["id"]."</td>";
    print "<td align=center>".$MailPieceArr[$key]["ddate"]."</td>";
    print "<td align=center>".$MailPieceArr[$key]["acode"]."</td>";

    print "</tr>";
} 
```

这是我的数组的样子：

```
print_r($MailPieceArr); 
```

输出：

```
Array
(
    [0] => Array
        (
            [type] => First-Class
            [id] => 77770056
            [ddate] => 11/26/2012
            [acode] => 2643
        )

    [1] => Array
        (
            [type] => First-Class
            [id] => 77770057
            [ddate] => 11/26/2012
            [acode] => 2643
        )

    [2] => Array
        (
            [type] => First-Class
            [id] => 77770058
            [ddate] => 11/21/2012
            [acode] => 2641
        )

    [3] => Array
        (
            [type] => First-Class
            [id] => 77770059
            [ddate] => 11/21/2012
            [acode] => 2641
        )

    [4] => Array
        (
            [type] => First-Class
            [id] => 77770042
            [ddate] => 10/29/2012
            [acode] => 2623
        )

    [5] => Array
        (
            [type] => First-Class
            [id] => 77770041
            [ddate] => 10/29/2012
            [acode] => 2623
        )

    [6] => Array
        (
            [type] => RR
            [id] => 88880001
            [ddate] => 10/29/2012
            [acode] => 2621
        )

    [7] => Array
        (
            [type] => First-Class
            [id] => 77770043
            [ddate] => 10/17/2012
            [acode] => 2625
        )

    [8] => Array
        (
            [type] => First-Class
            [id] => 77770044
            [ddate] => 10/17/2012
            [acode] => 2625
        )

    [9] => Array
        (
            [type] => RR
            [id] => 88880005
            [ddate] => 10/17/2012
            [acode] => 2619
        )

    [10] => Array
        (
            [type] => IMB
            [id] => 0001101111111111110011111111111
            [ddate] => UNKNOWN   
            [acode] => 2643
        )

) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-26T23:43:20.280

在您的排序功能中使用`strtotime`，不仅更容易比较时间戳，而且在无效日期格式上也返回 false。

```
function date_sort($a, $b)
{
    $t1 = strtotime($a['ddate']);
    $t2 = strtotime($b['ddate']);

    if($t1 == false || $t2 == false)
        return 1;

    return $t2 - $t1;
}    
usort($array, 'date_sort'); 
```

这可以帮助您生成类似[此示例](http://codepad.viper-7.com/kslzxQ)的内容。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-26T23:43:52.167

Using[`usort()`](http://php.net/manual/en/function.usort.php)将允许您使用完全自定义的比较函数对数组进行排序：

```
<?php
date_default_timezone_set('UTC');

$array  = array(
    array(
        'type'  => 'First-Class',
        'id'    => 7770057,
        'ddate' => '2012/11/26',
        'acode' => 2643
    ),
    array(
        'type'  => 'First-Class',
        'id'    => 7770058,
        'ddate' => '2012/11/21',
        'acode' => 2643
    ),
    array(
        'type'  => 'First-Class',
        'id'    => 7770059,
        'ddate' => 'UNKNOWN',
        'acode' => 2643
    ),
    array(
        'type'  => 'First-Class',
        'id'    => 7770060,
        'ddate' => 'UNKNOWN',
        'acode' => 2643
    ),
    array(
        'type'  => 'First-Class',
        'id'    => 7770061,
        'ddate' => '2012/11/30',
        'acode' => 2643
    ),
);

echo 'Before:'.PHP_EOL;
foreach($array as $item){
    echo $item['id'].': '.$item['ddate'].PHP_EOL;
}

usort($array, function($a, $b){
    if($a['ddate'] == 'UNKNOWN'){
            // Place UNKNOWN at end
        return 1;
    }

    if($a['ddate'] == $b['ddate']){
            // Dates are the same
        return 0;
    }
    return (strtotime($a['ddate']) > strtotime($b['ddate'])) ? -1 : 1;
});

echo 'After:'.PHP_EOL;
foreach($array as $item){
    echo $item['id'].': '.$item['ddate'].PHP_EOL;
} 
```

但是，您应该考虑使用 PHP 的[DateTime 类](http://www.php.net/manual/en/class.datetime.php)来存储您的日期对象。使用字符串可能会产生歧义——例如，2012 年 11 月 12 日是 12 月 11 日还是 11 月 12 日？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-26T23:33:28.293

您可以将日期转换为 unix 时间戳，它们将更容易比较。

# c# - 如何将变量从一个类发送到另一个类

> ID：13574992
> 
> 赞同：-1
> 
> 时间：2012-11-26T23:31:39.543
> 
> 标签：c#, .net, forms, class

这是现在的代码，我将包含程序的所有代码，因为我之前遗漏了一些代码。由于您的帮助，我已更改的位我用星号和/// 强调了第一个类是直接编辑表单时从 Windows 窗体创建的标准类。

```
namespace DistanceEstimatorFinal
{
    public partial class Form1 : Form
    {
        private bool saved;

        public Form1()
        {

            dataPoints mydataPoints = new dataPoints();
            InitializeComponent();
            dataPoint a = mydataPoints.getItem(0);
            latTextBox.Text = a.CurLatitude;
            longTextbox.Text = a.CurLongtitude;
            eleTextBox.Text = a.CurElevation;
            saved = true;

        }             

        private void latTextBox_TextChanged(object sender, EventArgs e)
        {

        }

        private void openDataListToolStripMenuItem_Click(object sender, EventArgs e)
        {
            OpenFileDialog ofd = new OpenFileDialog();
            ofd.Filter = "CSV files (*.csv)|*.csv|Text files ( *.txt)|*.txt |All files (*.*)|*.*";
            if (ofd.ShowDialog(this).Equals(DialogResult.OK))
            {
                *var dp = new dataPoints (ofd.FileName);* /////

            }
        }       

        private void Form1_FormClosing(object sender, FormClosingEventArgs e)
        {
            if (saved)
            {
                if (MessageBox.Show("Save?", "Data Not Saved", MessageBoxButtons.YesNo).Equals(DialogResult.Yes))
                {
                    SaveFileDialog sfd = new SaveFileDialog();
                    sfd.ShowDialog();

                }

            }
        }

        private void saveAsToolStripMenuItem_Click(object sender, EventArgs e)
        {
            SaveFileDialog sfd1 = new SaveFileDialog();
            sfd1.Filter = "CSV files (*.csv)|*.csv|Text files ( *.txt)|*.txt |All files (*.*)|*.*";
            sfd1.ShowDialog();
        }

    }
} 
```

此类旨在从文件中读取数据，我目前正在调整它以从 open 函数中读取文件。

```
namespace DistanceEstimatorFinal
{    
    public class dataPoints
    {              
        List<dataPoint> Points;
        string p;

        public dataPoints(string path)
        {
            p = path;
            Points = new List<dataPoint>();

            StreamReader tr = new StreamReader(p);

            string input;
            while ((input = tr.ReadLine()) != null)
            {
                string[] bits = input.Split(',');
                dataPoint a = new dataPoint(bits[0],bits[1],bits[2]);              
                Points.Add(a);  

            }

            tr.Close();
        }

        internal dataPoint getItem(int p)
        {
            if (p < Points.Count)
            {
                return Points[p];
            }
            else
                return null;
        }
    }

} 
```

该文件包含三个变量距离、纬度和经度。

```
namespace DistanceEstimatorFinal
{
    class dataPoint
    {
        private string latitude;
        private string longtitude;
        private string elevation;

        public dataPoint()                               //Overloaded incase no value available
        {
            latitude = "No Latitude Specified";
            longtitude = "No Longtitude Specified";
            elevation = "No Elevation Specified";

        }

        public dataPoint(string Latitude, string Longtitude, string Elevation)
        {

            // TODO: Complete member initialization
            this.latitude = Latitude;
            this.longtitude = Longtitude;
            this.elevation = Elevation;

        }

        public string CurLongtitude { get { return this.longtitude; } }
        public string CurLatitude { get { return this.latitude; } }
        public string CurElevation { get { return this.elevation; } }

    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-26T23:35:32.913

Your`pathFile`是一个方法局部变量，因此除了该方法的主体（此处`openDataListToolStripMenuItem_Click`）之外，它在任何地方都是不可访问的。

您可以向`dataPoints`构造函数添加一个参数以将该值传递给类：

```
public class dataPoints
{
    List<dataPoint> Points;
    public dataPoints(string path)
    {
        Points = new List<dataPoint>();
        //here `path` from constructor arguments
        TextReader tr = new StreamReader(path); 
        //...rest part of your code
    } 
```

此外，您必须将值传递给此构造函数。您没有显示代码，您必须创建`dataPoints`实例。

```
var dp = new dataPoints(pathFile); 
```

但请记住，`pathFile`只能在`openDataListToolStripMenuItem_Click`. 因此，您应该在`dataPoints`那里创建权限，或者使您`pathFile`的表单字段可以通过该表单的任何方法访问。然后，您将有机会以`pathFile`这种形式的任何方法访问。

* * *

根据[您之前的帖子](https://stackoverflow.com/questions/13574442/trying-to-send-a-file-to-another-class-in-c-sharp)，这应该如下所示：

```
private void openDataListToolStripMenuItem_Click(object sender, EventArgs e)
{
    OpenFileDialog ofd = new OpenFileDialog();
    ofd.Filter = "CSV files (*.csv)|*.csv|Text files ( *.txt)|*.txt |All files (*.*)|*.*";
    if (ofd.ShowDialog(this).Equals(DialogResult.OK))
    {            
        //actually you don't even need to have a separate `pathFile` variable
        //just pass the value from the dialog straight to your `dataPoints` object
        var dp = new dataPoints(ofd.FileName);
        //...rest of your code
    }
} 
```

PS：题外话，但是，请考虑阅读[MSDN Guidelines for Names](http://msdn.microsoft.com/en-us/library/vstudio/ms229002%28v=vs.100%29.aspx)

# c - Z3 与 Craig 插值 (iz3)

> ID：13574994
> 
> 赞同：5
> 
> 时间：2012-11-26T23:31:52.813
> 
> 标签：c, z3, smt, theorem-proving

我正在尝试使用 C API 生成 Craig 插值，但得到的结果不正确。但是，当我通过 Z3_write_interpolation_problem 将相同的问题转储到文件并调用 iZ3 时，我得到了预期的插值。

我附上代码以便能够重现相同的结果。我正在使用 z3 4.1

* * *

```
#include<stdio.h>
#include<stdlib.h
#include<assert.h>
#include<stdarg.h>
#include<memory.h>
#include<setjmp.h>
#include<iz3.h>

Z3_ast mk_var(Z3_context ctx, const char * name, Z3_sort ty) 
{
   Z3_symbol   s  = Z3_mk_string_symbol(ctx, name);
   return Z3_mk_const(ctx, s, ty);
}

Z3_ast mk_int_var(Z3_context ctx, const char * name) 
{
   Z3_sort ty = Z3_mk_int_sort(ctx);
   return mk_var(ctx, name, ty); 
}

void interpolation_1(){
// Create context
Z3_config  cfg = Z3_mk_config();
Z3_context ctx = Z3_mk_interpolation_context(cfg);        

// Build formulae
Z3_ast x0,x1,x2;
x0 = mk_int_var(ctx, "x0");
x1 = mk_int_var(ctx, "x1");
x2 = mk_int_var(ctx, "x2");
Z3_ast zero = Z3_mk_numeral(ctx, "0", Z3_mk_int_sort(ctx));
Z3_ast two  = Z3_mk_numeral(ctx, "2", Z3_mk_int_sort(ctx));
Z3_ast ten  = Z3_mk_numeral(ctx, "10", Z3_mk_int_sort(ctx));

Z3_ast c2_operands[2] = { x0, two };
Z3_ast c1 = Z3_mk_eq(ctx, x0, zero);
Z3_ast c2 = Z3_mk_eq(ctx, x1, Z3_mk_add(ctx, 2, c2_operands));
Z3_ast c3_operands[2] = { x1, two };
Z3_ast c3 = Z3_mk_eq(ctx, x2, Z3_mk_add(ctx, 2, c3_operands));
Z3_ast c4 = Z3_mk_gt(ctx, x2, ten);

Z3_ast A_operands[3] = { c1, c2, c3};
Z3_ast AB[2] = { Z3_mk_and(ctx,3, A_operands), c4 };

// Generate interpolant
Z3_push(ctx);
Z3_ast interps[1];
Z3_lbool status = Z3_interpolate(ctx, 2, AB, NULL, NULL, interps); 
assert(status ==  Z3_L_FALSE && "A and B should be unsat");
printf("Interpolant: %s\n",Z3_ast_to_string(ctx, interps[0]));

// To dump the interpolation into a SMT file
// execute "iz3 tmp.smt" to compare 
Z3_write_interpolation_problem(ctx, 2, AB, NULL, "tmp.smt");

Z3_pop(ctx,1);  
}

int main() {
  interpolation_1(); 
} 
```

我使用以下命令生成可执行文件：

> g++ -fopenmp -o 插值插值.c -I/home/jorge/Systems/z3/include -I/home/jorge/Systems/z3/iz3/include -L/home/jorge/Systems/z3/lib -L/主页/jorge/Systems/z3/iz3/lib -L/home/jorge/Systems/libfoci-1.1 -lz3 -liz3 -lfoci

请注意，约束基本上是：

> A = (x=0 and x1 = x0+2 and x2 = x1 + 2),
> 
> 和 B = (x2 > 10)

这显然是不满意的。此外，很容易看出唯一的公共变量是 x2。因此，任何有效的插值只能包括 x2。

如果我运行可执行文件 ./interpolation 我会得到无意义的插值：

```
(and (>= (+ x0 (* -1 x1)) -2) (>= (+ x1 (* -1 x3)) -2) (<= x0 0)) 
```

但是，如果我运行“iz3 tmp.smt”（其中 tmp.smt 是使用 Z3_write_interpolation_problem 生成的文件），我将获得一个有效的插值：

> 未饱和插值：(<= x2 10)

这是一个错误吗？还是我在调用 Z3_interpolate 时遗漏了一些重要的先决条件？

PS 我找不到任何使用 iZ3 和 C API 的示例。

干杯，豪尔赫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-30T06:16:27.240

iZ3 不是针对版本 4+ 构建的，并且不同版本的标头中的枚举类型和其他功能已更改。您还不能针对最新版本的 Z3 使用 iZ3。我们希望尽快解决这个问题，很可能通过将 iZ3 堆栈与其他 Z3 源一起放置，但同时使用构建 iZ3 的先前版本。

# php - Paypal IPN 获得空白确认（应为“已验证”或“无效”）

> ID：13574996
> 
> 赞同：3
> 
> 时间：2012-11-26T23:32:07.793
> 
> 标签：php, curl, paypal, paypal-ipn

我只是在这里测试 Paypal IPN。我已经用沙盒设置了它。我正在向它发送虚假的 IPN 请求，它正在接收 IPN。然后，我让它返回信息以进行验证，并将响应写入文本文件，以便我自己检查。IPN 很好，响应被写入文本文件。

只有一个问题...响应是空白的。

响应应该被接收为“已验证”或“无效”，这是仅有的 2 个可能的响应......所以发生了什么事 =S。任何帮助是极大的赞赏。

整个代码贴在下面：

```
$ipn_post_data = $_POST;

$response = "";

    // Choose url
    $url = 'https://www.sandbox.paypal.com/cgi-bin/webscr';

    // Set up request to PayPal
    $request = curl_init();
    curl_setopt_array($request, array
    (
        CURLOPT_URL => $url,
        CURLOPT_POST => TRUE,
        CURLOPT_POSTFIELDS => http_build_query(array('cmd' => '_notify-validate') + $ipn_post_data),
        CURLOPT_RETURNTRANSFER => TRUE,
        CURLOPT_HEADER => FALSE,
        CURLOPT_SSL_VERIFYPEER => TRUE,
        CURLOPT_CAINFO => 'cacert.pem',
    ));

    // Execute request and get response and status code
    $response = curl_exec($request);
    $status   = curl_getinfo($request, CURLINFO_HTTP_CODE);

    // Close connection
    curl_close($request);

$fh = fopen( "ipntest.txt", 'a+' );
$date = date( "Y-M-j H:i" );
fwrite( $fh, $date . " Response: " . $response . "\n" );
fclose( $fh );

if($status == 200 && $response == 'VERIFIED')
{
    // All good! Proceed...
}
else
{
    // Not good. Ignore, or log for investigation...
} 
```

文本文件输出：

```
2012-Nov-26 23:24 Response: 
2012-Nov-26 23:25 Response: 
```

我以前一直在使用这个代码，我一直在努力让它工作一个星期，所以这不仅仅是暂时的失败或什么......

干杯，伙计们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-11-28T14:01:15.713

所以仅供将来参考，对于有同样问题的人：

**这里的问题是没有 CA 文件。**

我不确定 CA 文件究竟做了什么，但我知道它与 Paypal 的 SSL 证书和建立 SSL 连接有关。当我开始查看 cURL 的错误时，我看到了以下内容：

```
[27-Nov-2012 21:46:11 UTC] cURL error: [77] error setting certificate verify locations:
  CAfile: /etc/ssl/certs/api_cert_chain.crt
  CApath: /etc/ssl/certs 
```

我找到的快速解决方案是下载[IpnListener.php](http://github.com/Quixotix/PHP-PayPal-IPN)类。（这是由[eldblz](https://stackoverflow.com/users/758766/eldblz)推荐的。它使处理 IPN 变得更容易，并且它为我没有 CAFile 提供了一个解决方案。如果你下载整个 IpnListener.php 包，它包含一个名为**cert**的文件夹，其中包含你的 api_cert_chain.crt需要，并且已经配置好使用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-27T07:01:47.070

我一直使用以下方法，并且效果很好...

```
// Validate with curl
$curl_result=$curl_err='';
$ch = curl_init();
curl_setopt($ch, CURLOPT_URL,'https://'.$ppHost.'/cgi-bin/webscr');
curl_setopt($ch, CURLOPT_RETURNTRANSFER,1);
curl_setopt($ch, CURLOPT_POST, 1);
curl_setopt($ch, CURLOPT_POSTFIELDS, $req);
curl_setopt($ch, CURLOPT_HTTPHEADER, array("Content-Type: application/x-www-form-urlencoded", "Content-Length: " . strlen($req)));
curl_setopt($ch, CURLOPT_HEADER , 1);   
curl_setopt($ch, CURLOPT_VERBOSE, 1);
curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, $ssl);
curl_setopt($ch, CURLOPT_TIMEOUT, 30);

$curl_result = curl_exec($ch);
$curl_err = curl_error($ch);
curl_close($ch);

//are we verified? If so, let's process the IPN
if (strpos($curl_result, "VERIFIED")!==false) 
    $valid = true;
else
    $valid = false; 
```

您只需要确保此示例中的 $ppHost 是正确的，具体取决于事务是来自沙箱还是来自实时服务器，然后当然要相应地填写 $req 和 $ssl。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-11-27T07:08:12.783

```
class Paypal_IPN
{
    /** @var string $_url The paypal url to go to through cURL
    private $_url;

    /**
    * @param string $mode 'live' or 'sandbox' 
    */
    public function __construct($mode = 'live')
    {
        if ($mode == 'live')
        $this->_url = 'https://www.paypal.com/cgi-bin/webscr';

        else
        $this->_url = 'https://www.sandbox.paypal.com/cgi-bin/webscr';
    }

    public function run()
    {
        $postFields = 'cmd=_notify-validate';

        foreach($_POST as $key => $value)
        {
            $postFields .= "&$key=".urlencode($value);
        }

        $ch = curl_init();

        curl_setopt_array($ch, array(
            CURLOPT_URL => $this->_url,
            CURLOPT_RETURNTRANSFER => true,
            CURLOPT_SSL_VERIFYPEER => false,
            CURLOPT_POST => true,
            CURLOPT_POSTFIELDS => $postFields
        ));

        $result = curl_exec($ch);
        curl_close($ch);

        $fh = fopen('result.txt', 'w');
        fwrite($fh, $result . ' -- ' . $postFields);
        fclose($fh);

        echo $result;
    }
} 
```

在另一个 php 文件中调用它：

```
<?php
require 'Paypal_IPN.php';
$paypal= new Paypal_IPN('sandbox');
$paypal->run();

?> 
```