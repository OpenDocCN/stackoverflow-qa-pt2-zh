# StackOverflow 问答 15980000-15980999

# php - iContact API：无法让“updateContact”PHP 函数工作

> ID：15980000
> 
> 赞同：2
> 
> 时间：2013-04-12T20:07:10.013
> 
> 标签：php, api

我需要使用 iContact 的 API 来更新单个联系人记录中的街道地址。

API 在这里：[https ://github.com/icontact/icontact-api-php](https://github.com/icontact/icontact-api-php)

具体来说，我想更新`street2`.

在 API 中，有一个“updateContact”函数，它接受 15 个参数。这是一个例子：

`updateContact($currentContactId, null, null, null, null, null, null,'My second address', null, null, null, null, null, null, null);`

API 会构建 URI，这样就可以了。它还将其设置为 POST（也可以；这就是 API 更新联系人所需的内容）。

以下是 API 构建的 URI 示例：

[https://app.sandbox.icontact.com/icp/a/913463/c/133578/contacts/67295434](https://app.sandbox.icontact.com/icp/a/913463/c/133578/contacts/67295434)

最后一位数字`67295434`是联系人的唯一 ID。

BODY 请求看起来也不错：

`[{"street2":"My second address"}]`

但是`curl_exec`我得到之后的 JSON 响应是这样的：

```
 {"contact":
    {
    "contactId":"67295434",
    "prefix":"Mr.",
    "firstName":"Joe",
    "lastName":"Williams",
    "suffix":"Jr.",
    "street":"2365 Meridian Parkway",
    "street2":"",
    "city":"Durham",
    "state":"NC",
    "postalCode":"27713",
    "phone":"8668039462",
    "fax":"",
    "business":"iContact",
    "email":"joewilliams@icontact.com",
    "createDate":"2013-03-30 21:22:28",
    "bounceCount":"","status":"normal",
    "interestedinseo":"1",
    "wheredoyoulive":"New York"
    },

    "warnings":["Invalid field: 0"]
  } 
```

我怀疑 API 中存在错误，但无法发现。还是我错过了一些愚蠢的东西？有什么想法吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-14T11:57:20.613

[iContact API](http://developer.icontact.com/documentation/contacts/)需要采用以下格式的更新 JSON 字符串：

```
{"street2":"My second address"} 
```

但是，API 包装器以这种格式发送更新数据：

```
[{"street2":"My second address"}] 
```

因此，您需要在函数 updateContact() 中更改这一行：

```
$oContact = $this->makeCall("/a/{$this->setAccountId()}/c/{$this->setClientFolderId()}/contacts/{$iContactId}", 'POST', array($aContact), 'contact'); 
```

...对此：

```
$oContact = $this->makeCall("/a/{$this->setAccountId()}/c/{$this->setClientFolderId()}/contacts/{$iContactId}", 'POST', $aContact, 'contact'); 
```

# c++ - Detect.exe 中 0x00cd2e34 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000000

> ID：15980002
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:07:13.643
> 
> 标签：c++, opencv, access-violation, face-recognition

我正在尝试训练 7 个文本文件，它们将生成 7 个 xml 文件作为输出。因此我尝试了一个“for循环”，它将运行7次。

我已经参考以下链接进行人脸识别 [在线人脸识别使用 OpenCV](https://stackoverflow.com/questions/9504216/online-face-recognition-using-opencv)

运行代码时出现错误：Detect.exe 中 0x00cd2e34 处的未处理异常：0xC0000005：访问冲突读取位置 0x00000000。

感谢您在这方面的支持。谢谢！

与错误和for循环相关的代码：

```
void learn() {
    int offset;
    for(int i=0; i<=7; i++){
        if (i==1){
            //first text file
            // load training data from Diamond.txt
            nTrainFaces = loadFaceImgArray("Diamond.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }

        if (i==2){
            //the next text file
            // load training data from Heart.txt
            nTrainFaces = loadFaceImgArray("Heart.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }

        if (i==3){
            //the next text file
            // load training data from Square.txt
            nTrainFaces = loadFaceImgArray("Square.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }   

        if (i==4){
            //the next text file
            // load training data from Oblong.txt
            nTrainFaces = loadFaceImgArray("Oblong.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }

        if (i==5){
            //the next text file
            // load training data from Oval.txt
            nTrainFaces = loadFaceImgArray("Oval.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }

        if (i==6){
            //the next text file
            // load training data from Round.txt
            nTrainFaces = loadFaceImgArray("Round.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }

        if (i==7){
            //the next text file
            // load training data from Triangle.txt
            nTrainFaces = loadFaceImgArray("Triangle.txt");
            if( nTrainFaces <2 )
            {

                fprintf(stderr,
                "Need 2 or more training faces\n"
                "Input file contains only %d\n", nTrainFaces);

                return;
            }
        }

        // do PCA on the training faces
        doPCA();

        // project the training images onto the PCA subspace                        
        projectedTrainFaceMat = cvCreateMat( nTrainFaces, nEigens, CV_32FC1 );
        offset = projectedTrainFaceMat->step / sizeof(float);
        for(int i=0; i<nTrainFaces; i++)
        {
            //int offset = i * nEigens;
            cvEigenDecomposite(
            faceImgArr[i],
            nEigens,
            eigenVectArr,
            0, 0,
            pAvgTrainImg,
            //projectedTrainFaceMat->data.fl + i*nEigens);
            projectedTrainFaceMat->data.fl + i*offset);
        }
        // store the recognition data as an xml file
        storeTrainingData();
    }
}

void doPCA() {
    int i;
    faceImgArr        = 0;
    CvTermCriteria calcLimit;
    CvSize faceImgSize;

    // set the number of eigenvalues to use
    nEigens = nTrainFaces-1;

    // allocate the eigenvector images
    faceImgSize.width  = faceImgArr[0]->width; // I GET THE ERROR HERE 
    faceImgSize.height = faceImgArr[0]->height;
    eigenVectArr = (IplImage**)cvAlloc(sizeof(IplImage*) * nEigens);
    for(i=0; i<nEigens; i++)
    eigenVectArr[i] = cvCreateImage(faceImgSize, IPL_DEPTH_32F, 1);

    // allocate the eigenvalue array
    eigenValMat = cvCreateMat( 1, nEigens, CV_32FC1 );

    // allocate the averaged image
    pAvgTrainImg = cvCreateImage(faceImgSize, IPL_DEPTH_32F, 1);

    // set the PCA termination criterion
    calcLimit = cvTermCriteria( CV_TERMCRIT_ITER, nEigens, 1);

    // compute average image, eigenvalues, and eigenvectors
    cvCalcEigenObjects(
    nTrainFaces,
    (void*)faceImgArr,
    (void*)eigenVectArr,
    CV_EIGOBJ_NO_CALLBACK,
    0,
    0,
    &calcLimit,
    pAvgTrainImg,
    eigenValMat->data.fl);

    cvNormalize(eigenValMat, eigenValMat, 1, 0, CV_L1, 0);
}

void storeTrainingData() {
    for(int i=0;i<=7;i++){
        CvFileStorage * fileStorage;
        if (i==1){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Diamond.xml", 0, CV_STORAGE_WRITE );

        }

        if (i==2){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Heart.xml", 0, CV_STORAGE_WRITE );

        }

        if (i==3){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Square.xml", 0, CV_STORAGE_WRITE );

        }

        if (i==4){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Oblong.xml", 0, CV_STORAGE_WRITE );

        }

        if (i==5){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Oval.xml", 0, CV_STORAGE_WRITE );

        }

        if (i==6){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Round.xml", 0, CV_STORAGE_WRITE );

        }
        if (i==7){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Triangle.xml", 0, CV_STORAGE_WRITE );

        }

        // store all the data
        cvWriteInt( fileStorage, "nEigens", nEigens );
        cvWriteInt( fileStorage, "nTrainFaces", nTrainFaces );
        cvWrite(fileStorage, "trainPersonNumMat", personNumTruthMat, cvAttrList(0,0));
        cvWrite(fileStorage, "eigenValMat", eigenValMat, cvAttrList(0,0));
        cvWrite(fileStorage, "projectedTrainFaceMat", projectedTrainFaceMat, cvAttrList(0,0));
        cvWrite(fileStorage, "avgTrainImg", pAvgTrainImg, cvAttrList(0,0));
        for(int i=0; i<nEigens; i++)
        {
            char varname[200];
            sprintf( varname, "eigenVect_%d", i );
            cvWrite(fileStorage, varname, eigenVectArr[i], cvAttrList(0,0));
        }

        // release the file-storage interface
        cvReleaseFileStorage( &fileStorage );

    }
}

int loadTrainingData(CvMat ** pTrainPersonNumMat) {
    CvFileStorage * fileStorage;

    for(int i=0;i<=7;i++){
        if (i==1){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Diamond.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }
        }

        if (i==2){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Heart.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }
        }

        if (i==3){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Square.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }
        }

        if (i==4){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Oblong.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }
        }

        if (i==5){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Oval.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }
        }

        if (i==6){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Square.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }

        }

        if (i==7){
            // create a file-storage interface
            fileStorage = cvOpenFileStorage( "Triangle.xml", 0, CV_STORAGE_READ );
            if( !fileStorage )
            {
                fprintf(stderr, "Can't open Diamond.xml\n");
                return 0;
            }
        }

        nEigens = cvReadIntByName(fileStorage, 0, "nEigens", 0);
        nTrainFaces = cvReadIntByName(fileStorage, 0, "nTrainFaces", 0);
        *pTrainPersonNumMat = (CvMat *)cvReadByName(fileStorage, 0, "trainPersonNumMat", 0);
        eigenValMat  = (CvMat *)cvReadByName(fileStorage, 0, "eigenValMat", 0);
        projectedTrainFaceMat = (CvMat *)cvReadByName(fileStorage, 0, "projectedTrainFaceMat", 0);
        pAvgTrainImg = (IplImage *)cvReadByName(fileStorage, 0, "avgTrainImg", 0);
        eigenVectArr = (IplImage **)cvAlloc(nTrainFaces*sizeof(IplImage *));
        for(int i=0; i<nEigens; i++)
        {
            char varname[200];
            sprintf( varname, "eigenVect_%d", i );
            eigenVectArr[i] = (IplImage *)cvReadByName(fileStorage, 0, varname, 0);
        }

        // release the file-storage interface
        cvReleaseFileStorage( &fileStorage );

        return 1;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:09:54.687

storeTrainingData 中的 for 循环将导致崩溃，因为当 i==0 时，不会打开任何文件，但您在空句柄上调用 cvWriteInt。

这应该解决它：

```
for(int i=1; i<=7; i++) 
```

虽然这么想，还是有点低效。

我认为您需要学习从零开始而不是从 1 开始，索引事物等。

这里有太多的代码重复。

# c - 用 C 设置的二维数组

> ID：15980004
> 
> 赞同：0
> 
> 时间：2013-04-12T20:07:34.260
> 
> 标签：c, multidimensional-array

我正在尝试从给出的示例中编写一些代码。导致问题的行是：

```
unsigned char search[][256] = '\04' "TEST", '\04' "DEMO"; 
```

我对 C 的经验很少，我认为这是一个 2D 数组是否正确，如果是这样，分配给它的是什么？

我得到的错误是“预期的'，'或';' 在字符串常量之前”。我试过把这两个都放在琴弦之前，但这似乎没有帮助。

有人可以解释这条线的含义，也许它有什么问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:20:17.673

如果您尝试初始化搜索，使其第一个元素是 256 的数组，`char`其中包含编号为 4 的字符，然后是字符`T`、、、和`E`，然后是空字符，第二个元素是包含编号为 4 的字符的数组，然后，, , and , 然后是空字符，那么语法是：`S``T``D``E``M``O`

```
unsigned char search[][256] = {"\04TEST", "\04DEMO"}; 
```

如果那不是你想要的，你需要解释。如果 \04 旨在成为剩余字符的长度，则上述内容是有意义的。如果要将长度与其他字符分开以便清楚，可以使用：

```
unsigned char search[][256] = {"\04" "TEST", "\04" "DEMO"}; 
```

或者：

```
unsigned char search[][256] =
{
    "\04" "TEST",
    "\04" "DEMO",
}; 
```

# vba - 如何在收到单封电子邮件时将其正文保存到 .csv 文件？

> ID：15980005
> 
> 赞同：1
> 
> 时间：2013-04-12T20:07:35.180
> 
> 标签：vba, outlook

我对 VBA 完全陌生，如果已经问过这个问题并且我太菜鸟了，无法使用正确的搜索词找到答案，我深表歉意。我需要的是能够将 Outlook 2010 中的一条规则指向一个 VBA 脚本，该脚本将触发该规则的电子邮件正文导出到一个 .csv 文件，该文件将由遵循规则或可能遵循的 PowerShell 脚本使用由 VBA 脚本/宏调用。PowerShell 脚本非常简单，但我需要能够在我离开办公桌且无法远程连接到我的计算机时向它提供信息。电子邮件的正文将被标准化以保持简单，如下所示： Valuename, valuename Value, Value 这是电子邮件将包含的所有内容，并将作为纯文本发送。我浏览了一些 VBA 帮助文件，但由于缺乏 VB 技能，我没有看到任何可以组合在一起的内容。任何为我指明正确方向以开始这方面的帮助将不胜感激。谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-09T10:29:36.977

```
Sub SaveEmail(msg As Outlook.MailItem)
    ' save as text
    Dim fn As String
    fn = " *folder to save to* "  & Format(Now, "YYYYMMDD_HHMMSS_") & " *filename* .csv"
    Dim fso As Object
    Set fso = CreateObject("Scripting.FileSystemObject")
    Dim oFile As Object
    Set oFile = fso.CreateTextFile(fn)
    oFile.WriteLine msg.Body
    oFile.Close

## this allows a python script to run or you could call a power script 
## command from here but the key is that the fn is passed to this object
    Shell ("python *python filename*.py " & fn)

End Sub 
```

然后将其保存到一个模块中，并使用基于唯一消息标准或所有消息的 Outlook 规则调用它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:31:43.587

到目前为止，您可以将宏保存为 .txt 文件，然后将其导入 excel 工作表并将工作表另存为 cvs。这有点复杂，但这就是我最初研究时想到的。检查此链接，并获取您可能会发现有用的片段：[将电子邮件另存为 .txt](http://www.vboffice.net/sample.html?mnu=2&lang=en&smp=7&cmd=showitem)，[将 .txt 导入 excel](https://stackoverflow.com/questions/11267459/vba-importing-text-file-into-excel-sheet)，[将 excel 保存为 .cvs](http://www.mrexcel.com/forum/excel-questions/82525-using-visual-basic-applications-how-do-i-export-excel-file-csv.html)。并确保您使用正确的 Outlook 和 Excel 引用。

# linux - 在 Y86 中用完寄存器并遇到问题

> ID：15980017
> 
> 赞同：0
> 
> 时间：2013-04-12T20:08:17.277
> 
> 标签：linux, assembly, x86, att, y86

我目前正在使用一种名为 Y86、AT&T 语法的教育汇编语言编写函数，并试图完成/解决一些不支持的问题。我想向存储在内存中的值添加一个数字，出于某种愚蠢的原因，您只能使用 addl 添加到寄存器中。我不知道这是为什么。

在函数内部，我想做这样的事情，但不知道如何：

```
addl $1, -4(ebp) 
```

另外，我似乎遇到了寄存器用完的问题。也许是因为我不知道如何为存储局部变量腾出空间。我听说有一个概念，即调用者和被调用者保存寄存器。我将非常感谢任何与上述内容相同但在 Y86 中的命令。此外，保存寄存器的任何提示都会很棒！谢谢你！我知道查看这些东西真的很痛苦。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:41:03.653

在 x86 和 Y86 中，寄存器也可以通过 using 推入堆栈，并通过 using`push`从堆栈中弹出`pop`。像这样：

```
push %ax ; push ax into stack

; some code here that may overwrite ax.

pop %ax  ; pop ax from stack 
```

x86 的寄存器数量有限，因此很多时候需要为某些变量使用内存。

要在堆栈中为局部变量创建空间，您需要创建一个堆栈帧。请参阅[汇编中的堆栈框架是什么？](https://stackoverflow.com/questions/3699283/what-is-stack-frame-in-assembly).

# android - 如何将按钮添加到 Canvas DrawVIew - Android

> ID：15980024
> 
> 赞同：-4
> 
> 时间：2013-04-12T20:08:42.457
> 
> 标签：android, button, android-canvas

我正在关注这个允许我用手指绘制的tuto：http://marakana.com/tutorials/android/2d-graphics-example.html [...](http://marakana.com/tutorials/android/2d-graphics-example.html)我对绘图和其他事情进行了一些更改...但是现在我必须添加一个按钮，该按钮应该将这些画布保存到图像 jpg 中...如何在画布上添加按钮，然后保存它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:20:32.723

您不能将按钮添加到画布。创建一个布局 XML 文件，在那里添加您的自定义视图并在那里添加按钮。

# mysql - 在 MySQL 中使用 BLOB 或 VARBINARY 加密数据？

> ID：15980025
> 
> 赞同：5
> 
> 时间：2013-04-12T20:08:54.763
> 
> 标签：mysql, database-design, schema, relational-database

我正在开发一个通过文本区域接受用户输入的 PHP 应用程序。它将加密存储在数据库中（使用 AES_ENCRYPT）。

我应该使用 BLOB 还是 VARBINARY 字段？任何一种类型的字段都对性能有影响吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-12T23:43:26.027

BLOB 和 VARBINARY 都是“字符串”数据类型，它们存储*二进制*字符串（实际上是字节数组），而不是通常的字符串类型，它存储*字符串*，具有字符集编码等。

在大多数方面，您可以将 BLOB 列视为 VARBINARY 列，可以任意大。

BLOB 在以下方面与 VARBINARY 不同：

*   存储或检索值时，不会删除 BLOB 列的尾随空格。
*   对于 BLOB 列上的索引，您必须指定索引前缀长度。
*   BLOB 列不能有 DEFAULT 值。

**使用 BLOB**，因为如果您的加密值恰好以空格字节（十六进制 20）结尾，它将被 VARBINARY 截断，从而有效地破坏您的值。此外，您不会在加密值上放置索引，因此索引问题无关紧要，您也不会有默认值。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-08-15T18:26:12.217

我不认为波西米亚的回答是准确的。类似于 BLOB 的 VARBINARY 是存储二进制数据，因此它能够存储包括空格在内的*任何数据。*

```
 mysql> create table t1 (id integer auto_increment, data varbinary(100), primary key (id));
Query OK, 0 rows affected (0.09 sec)

// inserting '0', ' ', '0', ' ' - 4 characters including trailing space
mysql> insert into t1 (data) values (unhex('30203020')); 
Query OK, 1 row affected (0.02 sec)

+----+------+
| id | data |
+----+------+
|  1 | 0 0  |
+----+------+
1 row in set (0.00 sec)

mysql> select t1.*, length(data) from t1;
+----+------+--------------+
| id | data | length(data) |
+----+------+--------------+
|  1 | 0 0  |            4 |
+----+------+--------------+
1 row in set (0.00 sec) 
```

# elasticsearch - ElasticSearch 索引，合并大小太大

> ID：15980027
> 
> 赞同：1
> 
> 时间：2013-04-12T20:08:58.337
> 
> 标签：elasticsearch

我发布了关于 ES 数据自动删除的帖子，但没有找到合适的解决方案，但现在我担心的是合并大小。我在一个生产网站上运行 ElasticSearch，大约有 100,000 个文档，查询不多，但我所做的是，_update doc，每当用户点击它时增加它的 custom_score（PHP Stuff）。

我的总 ES 大小约为 123MB，这是状态

```
{
  index: {
    primary_size: 122.5mb
    primary_size_in_bytes: 128518629
    size: 232.6mb
    size_in_bytes: 243931154
  }
  translog: {
    operations: 368
  }
  docs: {
    num_docs: 112263
    max_doc: 113319
    deleted_docs: 1056
  }
  merges: {
    current: 0
    current_docs: 0
    current_size: 0b
    current_size_in_bytes: 0
    total: 1507
    total_time: 6m
    total_time_in_millis: 364562
    total_docs: 12950730
    total_size: 6.3gb
    total_size_in_bytes: 6817241817
  }
  refresh: {
    total: 26154
    total_time: 1m
    total_time_in_millis: 61128
  }
  flush: {
    total: 234
    total_time: 1.5m
    total_time_in_millis: 91111
  }
  shards: {
    0: [
      {
        routing: {
          state: STARTED
          primary: true
          node: 4klrp2F7TXqbqV2i2uJlrg
          relocating_node: null
          shard: 0
          index: tune
        }
        state: STARTED
        index: {
          size: 32.4mb
          size_in_bytes: 34065166
        }
        translog: {
          id: 1365750099675
          operations: 52
        }
        docs: {
          num_docs: 28104
          max_doc: 28242
          deleted_docs: 138
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 191
          total_time: 1m
          total_time_in_millis: 60823
          total_docs: 2192291
          total_size: 1gb
          total_size_in_bytes: 1169679226
        }
        refresh: {
          total: 3450
          total_time: 8.7s
          total_time_in_millis: 8747
        }
        flush: {
          total: 29
          total_time: 11.5s
          total_time_in_millis: 11582
        }
      }
      {
        routing: {
          state: STARTED
          primary: false
          node: hUbZmGtMR-qFPr4h4ET_Xg
          relocating_node: null
          shard: 0
          index: tune
        }
        state: STARTED
        index: {
          size: 25.4mb
          size_in_bytes: 26658796
        }
        translog: {
          id: 1365750099676
          operations: 50
        }
        docs: {
          num_docs: 28104
          max_doc: 28773
          deleted_docs: 669
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 191
          total_time: 8.9s
          total_time_in_millis: 8967
          total_docs: 151360
          total_size: 121.7mb
          total_size_in_bytes: 127708203
        }
        refresh: {
          total: 3445
          total_time: 8.5s
          total_time_in_millis: 8512
        }
        flush: {
          total: 30
          total_time: 9.5s
          total_time_in_millis: 9576
        }
      }
    ]
    1: [
      {
        routing: {
          state: STARTED
          primary: false
          node: 4klrp2F7TXqbqV2i2uJlrg
          relocating_node: null
          shard: 1
          index: tune
        }
        state: STARTED
        index: {
          size: 30.5mb
          size_in_bytes: 32065179
        }
        translog: {
          id: 1365750099763
          operations: 49
        }
        docs: {
          num_docs: 28006
          max_doc: 28156
          deleted_docs: 150
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 193
          total_time: 53.8s
          total_time_in_millis: 53841
          total_docs: 2031945
          total_size: 877.1mb
          total_size_in_bytes: 919752655
        }
        refresh: {
          total: 3244
          total_time: 6.9s
          total_time_in_millis: 6922
        }
        flush: {
          total: 29
          total_time: 12.2s
          total_time_in_millis: 12245
        }
      }
      {
        routing: {
          state: STARTED
          primary: true
          node: hUbZmGtMR-qFPr4h4ET_Xg
          relocating_node: null
          shard: 1
          index: tune
        }
        state: STARTED
        index: {
          size: 31.6mb
          size_in_bytes: 33186132
        }
        translog: {
          id: 1365750099763
          operations: 50
        }
        docs: {
          num_docs: 28006
          max_doc: 28128
          deleted_docs: 122
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 192
          total_time: 1m
          total_time_in_millis: 60375
          total_docs: 2246221
          total_size: 1gb
          total_size_in_bytes: 1136003705
        }
        refresh: {
          total: 3252
          total_time: 8.5s
          total_time_in_millis: 8591
        }
        flush: {
          total: 29
          total_time: 11.9s
          total_time_in_millis: 11967
        }
      }
    ]
    2: [
      {
        routing: {
          state: STARTED
          primary: false
          node: 4klrp2F7TXqbqV2i2uJlrg
          relocating_node: null
          shard: 2
          index: tune
        }
        state: STARTED
        index: {
          size: 29.8mb
          size_in_bytes: 31311783
        }
        translog: {
          id: 1365750099805
          operations: 53
        }
        docs: {
          num_docs: 28109
          max_doc: 28315
          deleted_docs: 206
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 189
          total_time: 42.2s
          total_time_in_millis: 42284
          total_docs: 1850347
          total_size: 732.1mb
          total_size_in_bytes: 767707262
        }
        refresh: {
          total: 3186
          total_time: 6.8s
          total_time_in_millis: 6845
        }
        flush: {
          total: 30
          total_time: 10.5s
          total_time_in_millis: 10573
        }
      }
      {
        routing: {
          state: STARTED
          primary: true
          node: hUbZmGtMR-qFPr4h4ET_Xg
          relocating_node: null
          shard: 2
          index: tune
        }
        state: STARTED
        index: {
          size: 25.3mb
          size_in_bytes: 26615897
        }
        translog: {
          id: 1365750099804
          operations: 56
        }
        docs: {
          num_docs: 28109
          max_doc: 28799
          deleted_docs: 690
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 188
          total_time: 8.8s
          total_time_in_millis: 8896
          total_docs: 145382
          total_size: 119.6mb
          total_size_in_bytes: 125410595
        }
        refresh: {
          total: 3189
          total_time: 7s
          total_time_in_millis: 7093
        }
        flush: {
          total: 29
          total_time: 11.2s
          total_time_in_millis: 11277
        }
      }
    ]
    3: [
      {
        routing: {
          state: STARTED
          primary: true
          node: 4klrp2F7TXqbqV2i2uJlrg
          relocating_node: null
          shard: 3
          index: tune
        }
        state: STARTED
        index: {
          size: 33mb
          size_in_bytes: 34651434
        }
        translog: {
          id: 1365750099726
          operations: 29
        }
        docs: {
          num_docs: 28044
          max_doc: 28150
          deleted_docs: 106
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 182
          total_time: 1m
          total_time_in_millis: 65510
          total_docs: 2142019
          total_size: 1.1gb
          total_size_in_bytes: 1212362289
        }
        refresh: {
          total: 3198
          total_time: 6.4s
          total_time_in_millis: 6495
        }
        flush: {
          total: 29
          total_time: 11.5s
          total_time_in_millis: 11517
        }
      }
      {
        routing: {
          state: STARTED
          primary: false
          node: hUbZmGtMR-qFPr4h4ET_Xg
          relocating_node: null
          shard: 3
          index: tune
        }
        state: STARTED
        index: {
          size: 24.2mb
          size_in_bytes: 25376767
        }
        translog: {
          id: 1365750099726
          operations: 29
        }
        docs: {
          num_docs: 28044
          max_doc: 28079
          deleted_docs: 35
        }
        merges: {
          current: 0
          current_docs: 0
          current_size: 0b
          current_size_in_bytes: 0
          total: 181
          total_time: 1m
          total_time_in_millis: 63866
          total_docs: 2191165
          total_size: 1.2gb
          total_size_in_bytes: 1358617882
        }
        refresh: {
          total: 3190
          total_time: 7.9s
          total_time_in_millis: 7923
        }
        flush: {
          total: 29
          total_time: 12.3s
          total_time_in_millis: 12374
        }
      }
    ]
  }
} 
```

* * *

```
merges: {
  current: 0       <-------
  current_docs: 0  <-------
  current_size: 0b <-------
  current_size_in_bytes: 0 <-------
  total: 191
  total_time: 1m
  total_time_in_millis: 60823
  total_docs: 2192291
  total_size: 1gb <-------
  total_size_in_bytes: 1169679226
} 
```

它是什么？

# html - 悬停在重叠的 CSS3 形状上

> ID：15980029
> 
> 赞同：3
> 
> 时间：2013-04-12T20:09:03.590
> 
> 标签：html, css, webkit

好吧，关于与通过 CSS3 创建的形状进行交互，我有一个潜在的棘手问题。请参阅以下小提琴：http: [//jsfiddle.net/MH4LN/1/](http://jsfiddle.net/MH4LN/1/)

代码示例：

```
<div class="container">
    <div class="l1"></div>
    <div class="l2"></div>
    <div class="l3"></div>
</div> 
```

使用以下 CSS：

```
.container {
    width: 570px; height: 570px;
    position: relative;
}
.l1 {
    width: 352px;
    height: 352px;
    background: red;

    position: absolute;
    top: 109px;
    left: 109px;
    z-index: 999;

    -webkit-border-radius: 176px;
    border-radius: 176px;
}
.l2 {
    width: 464px;
    height: 464px;
    background: blue;

    position: absolute;
    top: 53px;
    left: 53px;
    z-index: 998;

    -webkit-border-radius: 232px;
    border-radius: 232px;
}
.l3 {
    width: 570px;
    height: 570px;
    background: green;

    position: absolute;
    z-index: 997;

    -webkit-border-radius: 285px;
    border-radius: 285px;
}

.l1:hover, .l2:hover, .l3:hover {
    background: #fff;   
} 
```

我的问题是：我想在悬停时将 CSS 应用于每个形状。通过将边框半径设置为 div 宽度/高度的一半（创建一个圆）来创建形状。但是，当您将鼠标悬停在被半径隐藏的空白区域时，您仍然会在该元素上触发悬停状态。这是一张图片来说明我的意思：

![悲伤的悬停让我难过。](https://i.stack.imgur.com/LypqG.png)

有没有办法避免这种情况？我需要为此使用canvas元素而不是简单的圆形div吗？

编辑：看起来这是特定于 WebKit 浏览器的，因为它在 Firefox 中运行良好。

编辑2：我接受尼尔斯的解决方案，因为他是正确的，盒子模型规定元素是矩形，所以我这样做的方式是错误的。但是，我能够使用 SVG 完成我需要的工作。如果有人感兴趣，这是一个 Fiddle 示例：http: [//jsfiddle.net/uhrHX/1/](http://jsfiddle.net/uhrHX/1/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:23:03.660

CSS 标准没有在第 2 级和第 3 级定义这种行为。他们定义的只是：

> :hover 伪类在用户使用指针设备指定元素时应用，但不一定激活它。例如，当光标（鼠标指针）悬停在元素生成的框上时，可视用户代理可以应用此伪类。

CSS 盒子模型隐含地声明所有块元素都形成矩形盒子。正如文本不会以圆形方式围绕您的 div 浮动一样，出于所有意图和目的，您的圆圈在布局上仍然是矩形的，在行为上对于 Webkit 来说仍然是矩形的。Gecko 开发人员显然已经付出了额外的努力来尊重悬停的边界半径，但这实际上是不一致的，因为他们不会为背景中的“间隙”等而这样做，这本质上也只是视觉变化，就像边界半径一样.

简而言之，不要期望浏览器的行为会因此而改变，因为 CSS 标准没有定义行为。跨所有浏览器正确实现它的唯一方法是使用 Javascript 和一些智能毕达哥拉斯计算鼠标位置。

# javascript - AngularJS - 发送和接收数据但不更新视图

> ID：15980030
> 
> 赞同：2
> 
> 时间：2013-04-12T20:09:08.333
> 
> 标签：javascript, angularjs

我正在开发一个单页应用程序，我想调用服务器以查询特定价格的项目（例如 www.myapp.com/products?price=1200）。我能够执行请求并从端点取回 JSON，但视图不会更新和显示数据。关于为什么我的观点没有更新的任何想法？

我的第一个想法是问题出在 $routeProvider 中，但我不知道我需要如何更改它。

谢谢！

我的角度模块

```
angular.module('myApp', [])
  .config(['$routeProvider', function($routeProvider) {

  $routeProvider.
    when('/products', 
      { templateUrl: 'partials/productSearchTemplate.html',   
        controller: ProductControl
      });
}]); 
```

我的控制器

```
function ProductControl($scope, $http) {
  $scope.sendRequest = function () {
    $http({
        url: '/products', 
        method: "GET",
        query: {price: $scope.price}
    }).success(function(data) {
      $scope.products = data;    
    });
  }
} 
```

我的观点

```
<div class="products">
    <div ng-repeat="product in products" class='product-panel'>
        <div class='front'>                
            <span class='product-title'>{{product.title}}</span><br/>
            <span class='product-manufacturer'>
                {{product.manufacturer}}
            </span>
        </div>
        <div class='back'>
            <span class='product-price'>
                {{product.price}}
            </span><br/>
            <a href="{{product.url}}">Details</a>
        </div>
    </div>
</div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T18:03:22.190

我怀疑您的“产品”端点不返回数组，而是返回对象。您期望来自服务器的以下 json：

```
[
   {"title":"title","price":1,"manufacturer":"Someone"}
] 
```

但最有可能的服务器返回对象而不是数组：

```
 {
    "products":[{"title":"title","price":1,"manufacturer":"Someone"}],
    "totalCount": 1 
 } 
```

因此，只需通过 Firebug 或 Chrome 开发工具检查从服务器返回的内容，并在控制器中执行必要的转换。

# java - 当框架太小而无法显示所有 JList 时，如何让滚动条出现在 JList 上？

> ID：15980035
> 
> 赞同：3
> 
> 时间：2013-04-12T20:09:37.133
> 
> 标签：java, swing, jscrollpane, jlist

每当框架的大小调整到对于 List 本身来说太小时，我都想让滚动条出现在 JList 上。到目前为止，这是我拥有的代码。运行它，调整框架的大小，并注意 JList 上从未出现过滚动条。

```
import java.awt.Dimension;

import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

public class JListScroll extends JPanel{

JScrollPane listScrollPane;

public JListScroll() {
    String[] stringArray = {"Testing","This","Stuff"};
    JList<String> rowList = new JList<String>(stringArray);
    listScrollPane = new JScrollPane();
    listScrollPane.getViewport().setView(rowList);
    this.setSize(new Dimension(75,200));
    this.add(listScrollPane);
    this.doLayout();
}

public static void main(String[] args){
    JFrame frame = new JFrame();
    JListScroll scrollPanel = new JListScroll();
    frame.add(scrollPanel);
    frame.setVisible(true);
    frame.setSize(new Dimension(75,300));
}

} 
```

请注意如何添加了 JScrollPane，但当窗口变得非常小时，列表上不会出现滚动条。这就是我想要解决的问题。

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:17:08.920

*   JPanel 已实现 FlowLayout

*   FlowLayout 仅接受 PreferredSize（在您的情况下由 setSize 硬编码）

*   FlowLayout 未指定，未与容器一起实现任何调整大小的 JComponents（由 FlowLayout 放置），JComponent 不可调整大小，保持原样

*   不想评论您在此处发布的代码的内容，请查看差异，相当不错的低级

![在此处输入图像描述](https://i.stack.imgur.com/faabs.jpg)

```
import java.awt.BorderLayout;
import java.awt.Dimension;    
import javax.swing.JFrame;
import javax.swing.JList;
import javax.swing.JPanel;
import javax.swing.JScrollPane;

public class JListScroll {

    private JFrame frame = new JFrame();
    private JPanel panel = new JPanel();
    private JScrollPane listScrollPane = new JScrollPane();
    private String[] stringArray = {"Testing", "This", "Stuff"};
    private JList rowList = new JList(stringArray);

    public JListScroll() {
        rowList.setVisibleRowCount(2);
        listScrollPane.setViewportView(rowList);
        panel.setLayout(new BorderLayout());
        panel.add(listScrollPane);
        frame.add(panel);
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); // EDIT 
        frame.pack();
        frame.setVisible(true);
    }

    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            @Override
            public void run() {
                JListScroll jListScroll = new JListScroll();
            }
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T20:21:10.740

您可以使用该方法强制（垂直）滚动条的可见性[`listScrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS)`](http://docs.oracle.com/javase/6/docs/api/javax/swing/JScrollPane.html#setVerticalScrollBarPolicy%28int%29)

# ms-access - 根据 Access 中的数字生成范围

> ID：15980040
> 
> 赞同：1
> 
> 时间：2013-04-12T20:09:54.103
> 
> 标签：ms-access, vba

我试图让一个字段显示 1 和另一个字段中的数字之间的数字范围，并带有前面的标识符。例如，当标记为“TotalQuestions”的字段值为“5”时，我希望另一个字段“TableInfo”由“Question1、Question2、Question3、Question4、Question5”填充。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:19:49.343

VBA 函数

```
Public Function GenerateRepeatedText(maxNumber As Long) As String
Const PrefixText = "Question"
Const SeparatorText = ", "
Dim i As Long, rtn As String
rtn = ""
For i = 1 To maxNumber
    rtn = rtn & PrefixText & i & SeparatorText
Next
If Len(rtn) > 0 Then
    '' trim trailing separator
    rtn = Left(rtn, Len(rtn) - Len(SeparatorText))
End If
GenerateRepeatedText = rtn
End Function 
```

可以在这样的查询中使用：

```
SELECT TotalQuestions, GenerateRepeatedText([TotalQuestions]) AS TableInfo FROM ... 
```

# sql - 如何在Oracle中使用插入语句插入两个表？

> ID：15980042
> 
> 赞同：0
> 
> 时间：2013-04-12T20:09:59.277
> 
> 标签：sql, oracle, oracle10g, oracle11g, sql-insert

我有两个插入语句，如下所示 A 和 B。我需要将这两个插入语句合并为一个，如语句 C。我不喜欢重复的代码，例如语句 A 和 B 中的选择部分。语句的正确格式是什么C？请忽略动态查询语句，因为真正的语句选择部分非常复杂。

声明 A：

```
insert into a
  (firstname, lastname)
  select t2.firstname, t3.lastname
    from t1, t2, t3
   where t1.t1_id = t2.t1_id
     and t2.t2_id = t3.t2_id; 
```

声明 B：

```
insert into b
  (personid)
  select t1.personid
    from t1, t2, t3
   where t1.t1_id = t2.t1_id
     and t2.t2_id = t3.t2_id; 
```

声明 C：

```
insert into a
  (firstname, lastname)
insert into b
  (personid)
  select t2.firstname, t3.lastname, t1.personid
    from t1, t2, t3
   where t1.t1_id = t2.t1_id
     and t2.t2_id = t3.t2_id; 
```

现实世界的原始陈述如下：

```
procedure allo_recipient(p_all_id       number,
                         p_allo_type    varchar2,
                         p_step_no      number,
                         p_region       varchar2,
                         p_don_reg_code varchar2,
                         p_med_urgent   varchar2,
                         p_don_id       number,
                         p_abo_ic       varchar2,
                         p_multi_organ  varchar2) is
begin
  insert into all_pat_list
    (apl_id,
     all_id,
     prod_id,
     prior_seq_no,
     org_code,
     all_step_no,
     pat_id,
     pat_name,
     sex,
     dob,
     ped_ind,
     blood_typ,
     home_prov_code,
     home_town,
     org_code_registered,
     org_descrip_registered,
     hosp_id,
     mrn,
     oldr_code,
     current_wait_list_stat_code,
     init_wait_list_stat_date,
     dis_code_prim_diag,
     dis_code_sec_diag,
     cadaver_liv_ind,
     weight,
     height,
     abdom_girth,
     chest_circum,
     chest_vert_right,
     chest_vert_left,
     chest_transverse,
     cmv,
     ebv,
     hepatitis_b_surface_ant,
     hepatitis_c,
     prev_trnsplt_no,
     all_step_descrip,
     eff_date,
     hcv_rna,
     dsa_cur_unaccp1,
     dsa_acc_unaccp1,
     dsa_cur_indet1,
     dsa_acc_indet1,
     dsa_cur_unaccp2,
     dsa_acc_unaccp2,
     dsa_cur_indet2,
     dsa_acc_indet2,
     x_match_serum_date, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     x_match_b_cell_res_ind, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     x_match_t_cell_res_ind, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     current_pra, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     current_pra_date, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     peak_pra, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     peak_pra_date, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     kp_allocation_points,
     cpra) --to do: c_pra need be replaced with new one in furture.
  --3rd select: get all needed elements for all_pat_list
    select apl_seq.nextval apl_id,
           p_all_id all_id,
           prod_id,
           all_kp_prior_seq.nextval prior_seq_no,
           org_code,
           all_step_no,
           pat_id,
           pat_name,
           sex,
           dob,
           ped_ind,
           blood_typ,
           home_prov_code,
           home_town,
           org_code_registered,
           tttt_gen_pkg.get_org_type_desc(org_code_registered) org_descrip_registered,
           hosp_id,
           mrn,
           tttt_gen_pkg.get_hosp_oldr_code(hosp_id) oldr_code,
           current_wait_list_stat_code,
           list_date init_wait_list_stat_date,
           dis_code_prim_diag,
           dis_code_sec_diag,
           cadaver_liv_ind,
           tttt_gen_pkg.get_latest_pat_weight(pat_id) weight,
           tttt_gen_pkg.get_latest_pat_height(pat_id) height,
           tttt_gen_pkg.get_latest_pat_abdom_girth(pat_id) abdom_girth,
           tttt_gen_pkg.get_latest_pat_chest_circum(pat_id) chest_circum,
           tttt_gen_pkg.get_latest_pat_chest_vr(pat_id) chest_vert_right,
           tttt_gen_pkg.get_latest_pat_chest_vl(pat_id) chest_vert_left,
           tttt_gen_pkg.get_latest_pat_chest_trans(pat_id) chest_transverse,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'CMV') cmv,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'EBV') ebv,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'HBSAG') hepatitis_b_surface_ant,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'HCV') hepatitis_c,
           tttt_gen_pkg.get_prev_tx_count(pat_id, org_code) prev_trnsplt_no, --tttt_gen_pkg.get_prev_tx_count(pat_id, 1) prev_trnsplt_no,
           tttt_gen_pkg.get_all_step_descrip(p_step_no, org_code) all_step_descrip, --tttt_gen_pkg.get_all_step_descrip(p_step_no, 1) all_step_descrip,
           sysdate,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'HCV_RNA') hcv_rna,
           null dsa_cur_unaccp1,
           null dsa_acc_unaccp1,
           null dsa_cur_indet1,
           null dsa_acc_indet1,
           null dsa_cur_unaccp2,
           null dsa_acc_unaccp2,
           null dsa_cur_indet2,
           null dsa_acc_indet2,
           null x_match_serum_date,
           null x_match_b_cell_res_ind,
           null x_match_t_cell_res_ind,
           null current_pra,
           null current_pra_date,
           null peak_pra,
           null peak_pra_date,
           kp_allocation_points,
           cpra
      from (
            -- 1st select: get basic elements of pat list for each step
            select distinct prod.org_code,
                             p_step_no all_step_no,
                             p.pat_id,
                             p.last_name || ', ' || p.first_name || ' ' ||
                             p.middle_name pat_name,
                             p.sex,
                             p.dob,
                             decode(sign(months_between(sysdate, p.dob) / 12 - 18), -1, 'P', 'A') ped_ind,
                             p.blood_typ,
                             pr.prov_code_home home_prov_code,
                             pr.home_town,
                             pr.org_code org_code_registered,
                             pr.hosp_id,
                             pr.mrn,
                             tttt_gen_pkg.get_current_wls_code(prod_id) current_wait_list_stat_code,
                             tttt_gen_pkg.get_initial_wls_date(prod.prod_id) list_date, --init_wait_list_stat_date
                             dis_code_prim_diag,
                             dis_code_sec_diag,
                             cadaver_liv_ind,
                             pr.patr_id,
                             prod.prod_id,
                             tttt_kp_allocation.allocation_points(pr.patr_id, prod.org_code) kp_allocation_points,
                             null cpra
              from pat p, temp_kp_pat_pool pr, pat_register_org_det prod
             where p.pat_id = pr.pat_id
               and pr.patr_id = prod.patr_id
               and (p_allo_type, prod.org_code) in
                   (('K', '3'), ('K', '6'), ('P', '6')) -- ('K' => K; K/P; P) ('P' => K/P; P )

               and (pr.patr_id not in
                   (select patr_id from temp_kp_used_patrid_pool)) -- filter out patr_id(s) which has been handled in previous steps

               and pr.cadaver_liv_ind in ('B', 'D') --waiting for deceased and both.

               and (((p_region = 'L') and
                   (tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) = 'ON') and
                   (tttt_gen_pkg.get_hosp_oldr_code(pr.hosp_id) =
                   p_don_reg_code)) or

                   ((p_region = 'O') and
                   (tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) = 'ON') and
                   (tttt_gen_pkg.get_hosp_oldr_code(pr.hosp_id) !=
                   p_don_reg_code)) or

                   ((p_region = 'P') and
                   (tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) = 'ON')) or

                   --((p_region = 'H') and
                   --(tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) != 'ON') and
                   --(tttt_gen_pkg.is_hsp_pat = 'Y')) or -- to do: need pat HSP flag to identify pat belongs to HSP

                   ((p_region = 'NA') and (1 = 1)))

               and (((p_med_urgent = 'Y') and
                   (tttt_gen_pkg.get_current_wls_code(prod.prod_id) = 'H')) or

                   ((p_med_urgent = 'NA') and (1 = 1)))

               and (((p_abo_ic = 'PI') and
                   (tttt_kp_allocation.kp_abo_c_i(p_don_id, pr.pat_id) = 'PI')) or

                   ((p_abo_ic = 'I') and
                   (tttt_kp_allocation.kp_abo_c_i(p_don_id, pr.pat_id) = 'I')) or

                   ((p_abo_ic = 'C') and
                   (tttt_kp_allocation.kp_abo_c_i(p_don_id, pr.pat_id) = 'C')) or

                   ((p_abo_ic = 'NA') and (1 = 1)))

               and (((p_multi_organ = 'Y') and
                   (pr.org_code in (10, 14, 15))) or

                   ((p_multi_organ = 'NA') and (1 = 1)))

             order by kp_allocation_points desc, cpra desc, list_date -- end of 1st select
            ); --end of 2rd select 
```

使用“Ed Gibbs”解决方案的真实世界修改语句如下所示，但不幸的是我得到了编译错误：

“PACKAGE BODY tttt.tttt_KP_ALLOCATION 的编译错误

错误：PL/SQL：ORA-02287：此处不允许序列号行：636 文本：all_kp_prior_seq.nextval prior_seq_no，

错误：PL/SQL：忽略 SQL 语句行：574 文本：将全部插入到 all_pat_list 值中

错误：提示：参数 'p_loc_pro' 已声明但从未在 'run_kp_allo' 中使用 行：847 文本：p_loc_pro varchar2，“

```
procedure allo_recipient(p_all_id       number,
                         p_allo_type    varchar2,
                         p_step_no      number,
                         p_region       varchar2,
                         p_don_reg_code varchar2,
                         p_med_urgent   varchar2,
                         p_don_id       number,
                         p_abo_ic       varchar2,
                         p_multi_organ  varchar2) is
begin
  insert all into all_pat_list values
    (apl_id,
     all_id,
     prod_id,
     prior_seq_no,
     org_code,
     all_step_no,
     pat_id,
     pat_name,
     sex,
     dob,
     ped_ind,
     blood_typ,
     home_prov_code,
     home_town,
     org_code_registered,
     org_descrip_registered,
     hosp_id,
     mrn,
     oldr_code,
     current_wait_list_stat_code,
     init_wait_list_stat_date,
     dis_code_prim_diag,
     dis_code_sec_diag,
     cadaver_liv_ind,
     weight,
     height,
     abdom_girth,
     chest_circum,
     chest_vert_right,
     chest_vert_left,
     chest_transverse,
     cmv,
     ebv,
     hepatitis_b_surface_ant,
     hepatitis_c,
     prev_trnsplt_no,
     all_step_descrip,
     eff_date,
     hcv_rna,
     dsa_cur_unaccp1,
     dsa_acc_unaccp1,
     dsa_cur_indet1,
     dsa_acc_indet1,
     dsa_cur_unaccp2,
     dsa_acc_unaccp2,
     dsa_cur_indet2,
     dsa_acc_indet2,
     x_match_serum_date, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     x_match_b_cell_res_ind, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     x_match_t_cell_res_ind, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     current_pra, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     current_pra_date, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     peak_pra, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     peak_pra_date, -- to do: this field is use by old allocation report, it need determine keep or discard in the new report
     kp_allocation_points,
     cpra) --to do: c_pra need be replaced with new one in furture.
     into temp_kp_used_patrid_pool values (patr_id)
  --3rd select: get all needed elements for all_pat_list
    select apl_seq.nextval apl_id,
           p_all_id all_id,
           prod_id,
           all_kp_prior_seq.nextval prior_seq_no,
           org_code,
           all_step_no,
           pat_id,
           pat_name,
           sex,
           dob,
           ped_ind,
           blood_typ,
           home_prov_code,
           home_town,
           org_code_registered,
           tttt_gen_pkg.get_org_type_desc(org_code_registered) org_descrip_registered,
           hosp_id,
           mrn,
           tttt_gen_pkg.get_hosp_oldr_code(hosp_id) oldr_code,
           current_wait_list_stat_code,
           list_date init_wait_list_stat_date,
           dis_code_prim_diag,
           dis_code_sec_diag,
           cadaver_liv_ind,
           tttt_gen_pkg.get_latest_pat_weight(pat_id) weight,
           tttt_gen_pkg.get_latest_pat_height(pat_id) height,
           tttt_gen_pkg.get_latest_pat_abdom_girth(pat_id) abdom_girth,
           tttt_gen_pkg.get_latest_pat_chest_circum(pat_id) chest_circum,
           tttt_gen_pkg.get_latest_pat_chest_vr(pat_id) chest_vert_right,
           tttt_gen_pkg.get_latest_pat_chest_vl(pat_id) chest_vert_left,
           tttt_gen_pkg.get_latest_pat_chest_trans(pat_id) chest_transverse,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'CMV') cmv,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'EBV') ebv,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'HBSAG') hepatitis_b_surface_ant,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'HCV') hepatitis_c,
           tttt_gen_pkg.get_prev_tx_count(pat_id, org_code) prev_trnsplt_no, --tttt_gen_pkg.get_prev_tx_count(pat_id, 1) prev_trnsplt_no,
           tttt_gen_pkg.get_all_step_descrip(p_step_no, org_code) all_step_descrip, --tttt_gen_pkg.get_all_step_descrip(p_step_no, 1) all_step_descrip,
           sysdate,
           tttt_gen_pkg.get_latest_test_res(pat_id, 'HCV_RNA') hcv_rna,
           null dsa_cur_unaccp1,
           null dsa_acc_unaccp1,
           null dsa_cur_indet1,
           null dsa_acc_indet1,
           null dsa_cur_unaccp2,
           null dsa_acc_unaccp2,
           null dsa_cur_indet2,
           null dsa_acc_indet2,
           null x_match_serum_date,
           null x_match_b_cell_res_ind,
           null x_match_t_cell_res_ind,
           null current_pra,
           null current_pra_date,
           null peak_pra,
           null peak_pra_date,
           kp_allocation_points,
           cpra,
           patr_id
      from (
            -- 1st select: get basic elements of pat list for each step
            select distinct prod.org_code,
                             p_step_no all_step_no,
                             p.pat_id,
                             p.last_name || ', ' || p.first_name || ' ' ||
                             p.middle_name pat_name,
                             p.sex,
                             p.dob,
                             decode(sign(months_between(sysdate, p.dob) / 12 - 18), -1, 'P', 'A') ped_ind,
                             p.blood_typ,
                             pr.prov_code_home home_prov_code,
                             pr.home_town,
                             pr.org_code org_code_registered,
                             pr.hosp_id,
                             pr.mrn,
                             tttt_gen_pkg.get_current_wls_code(prod_id) current_wait_list_stat_code,
                             tttt_gen_pkg.get_initial_wls_date(prod.prod_id) list_date, --init_wait_list_stat_date
                             dis_code_prim_diag,
                             dis_code_sec_diag,
                             cadaver_liv_ind,
                             pr.patr_id,
                             prod.prod_id,
                             tttt_kp_allocation.allocation_points(pr.patr_id, prod.org_code) kp_allocation_points,
                             null cpra
              from pat p, temp_kp_pat_pool pr, pat_register_org_det prod
             where p.pat_id = pr.pat_id
               and pr.patr_id = prod.patr_id
               and (p_allo_type, prod.org_code) in
                   (('K', '3'), ('K', '6'), ('P', '6')) -- ('K' => K; K/P; P) ('P' => K/P; P )

               and (pr.patr_id not in
                   (select patr_id from temp_kp_used_patrid_pool)) -- filter out patr_id(s) which has been handled in previous steps

               and pr.cadaver_liv_ind in ('B', 'D') --waiting for deceased and both.

               and (((p_region = 'L') and
                   (tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) = 'ON') and
                   (tttt_gen_pkg.get_hosp_oldr_code(pr.hosp_id) =
                   p_don_reg_code)) or

                   ((p_region = 'O') and
                   (tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) = 'ON') and
                   (tttt_gen_pkg.get_hosp_oldr_code(pr.hosp_id) !=
                   p_don_reg_code)) or

                   ((p_region = 'P') and
                   (tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) = 'ON')) or

                   --((p_region = 'H') and
                   --(tttt_gen_pkg.get_hosp_prov_code(pr.hosp_id) != 'ON') and
                   --(tttt_gen_pkg.is_hsp_pat = 'Y')) or -- to do: need pat HSP flag to identify pat belongs to HSP

                   ((p_region = 'NA') and (1 = 1)))

               and (((p_med_urgent = 'Y') and
                   (tttt_gen_pkg.get_current_wls_code(prod.prod_id) = 'H')) or

                   ((p_med_urgent = 'NA') and (1 = 1)))

               and (((p_abo_ic = 'PI') and
                   (tttt_kp_allocation.kp_abo_c_i(p_don_id, pr.pat_id) = 'PI')) or

                   ((p_abo_ic = 'I') and
                   (tttt_kp_allocation.kp_abo_c_i(p_don_id, pr.pat_id) = 'I')) or

                   ((p_abo_ic = 'C') and
                   (tttt_kp_allocation.kp_abo_c_i(p_don_id, pr.pat_id) = 'C')) or

                   ((p_abo_ic = 'NA') and (1 = 1)))

               and (((p_multi_organ = 'Y') and
                   (pr.org_code in (10, 14, 15))) or

                   ((p_multi_organ = 'NA') and (1 = 1)))

             order by kp_allocation_points desc, cpra desc, list_date -- end of 1st select
            ); --end of 2rd select 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:32:30.863

正如塞巴斯上面所说，`INSERT ALL`就是答案。您合并的“语句 A”和“语句 B”`INSERT ALL`将如下所示：

```
INSERT ALL
  INTO a VALUES (firstname, lastname)
  INTO b VALUES (personid)
select t2.firstname, t3.lastname, t1.personid
  from t1, t2, t3
 where t1.t1_id = t2.t1_id
   and t2.t2_id = t3.t2_id 
```

此外，正如 HLGEM 指出的那样，隐式连接现在通常不受欢迎。以下是使用 ANSI 样式连接的方法：

```
INSERT ALL
  INTO a VALUES (firstname, lastname)
  INTO b VALUES (personid)
SELECT t2.firstname, t3.lastname, t1.personid
FROM t1
INNER JOIN t2 ON t1.t1_id = t2.t1_id
INNER JOIN t3 ON t2.t2_id = t3.t2_id 
```

# jquery - jQuery拖放-重新排序

> ID：15980047
> 
> 赞同：0
> 
> 时间：2013-04-12T20:10:12.797
> 
> 标签：jquery, draggable, jquery-ui-draggable, jquery-ui-droppable

我有一些拖放，当一个人将一个项目拖到一个放置区域时，我会发生的是让剩余的可拖动项移动到开放区域。例如：

{A} {1}

{B} {2}

{C} {3}

如果您将 {3} 向上拖动到 {B}，它将锁定到 {B}，然后 {2} 应该向下移动到 {C} 所在的位置...

任何想法如何做到这一点？ALSO* ***可拖动对象必须捕捉/锁定到可放置区域。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T18:32:11.230

好的，所以我终于能够找到一个可行的解决方案。如果有人对此感兴趣，这就是我所做的：

首先，我创建了一堆拖放。每个可拖动对象都有一个可放置区域。然后，对于可拖动对象的定位，我创建了一个变量来存储不同的位置（基于 obj 高度和边距等。可拖动对象具有绝对位置，这是基于父 DIV 完成的。所以当我稍后获得位置时，我可以使用它们重新定位对象。

然后，我为 droppables 创建了一个 drop 函数，这样一旦一个对象被丢弃，它就会记录对象被丢弃的位置，并将其放入已经被占用的位置数组中。因此，如果我在 [步骤 2] 上放置了一些东西，并且它从顶部向下 220 像素，那么我将其记录在数组中。然后，紧接着，我检查所有的对象，看看哪些对象被丢弃了。这样我就知道我可以移动哪些物体。

现在我有了可以移动的对象和可用的位置。然后，我简单地浏览未移动的开放点和对象列表，并将它们简单地替换为开放位置。而不是试图仅在元素上重新定位。我基本上是重新定位一切，不管一开始是否很好。

我希望这可以帮助别人。

# java - ProcessBuilder 无法运行带有参数的 python 脚本

> ID：15980057
> 
> 赞同：1
> 
> 时间：2013-04-12T20:10:43.653
> 
> 标签：java, processbuilder

好的，所以我有一个通过 ProcessBuilder 运行的 python 脚本。一切正常。我遇到的问题是，每当我将参数传递给 python 脚本时，python 脚本都会以`unrecognized argumets`. 但是，如果我采用确切的命令并将其复制并粘贴到命令提示符中，它运行得非常好。有什么帮助吗？这是我现在所拥有的总体思路：

```
ProcessBuilder builder = new ProcessBuilder("C:\Python33\" + "python.exe","-u", "C:\...\script.py", "--arg1 " + "argumentValue");
p = builder.start(); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:12:43.970

将两个单独的参数传递给`ProcessBuilder`而不是连接`--arg1`and `argumentValue`：

```
ProcessBuilder builder = new ProcessBuilder("C:\\Python33\\python.exe",
                                            "-u",
                                            "C:\\...\\script.py,
                                            "--arg1",
                                            "argumentValue"); 
```

否则，要执行的程序将看到`--arg1 argumentValue`它无法识别的单个参数。

# meteor - 无需每次输入密码即可部署到受密码保护的流星应用程序？

> ID：15980060
> 
> 赞同：3
> 
> 时间：2013-04-12T20:10:53.553
> 
> 标签：meteor

我已经对我的流星应用程序进行了密码保护，但我希望避免每次部署时都输入密码。有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T20:17:06.103

我使用部署 bash 脚本通过从包含密码的文件中提取`password.txt`（并被 git 忽略！）来部署我的站点。例如：

```
echo "Deploying..."
echo
meteor deploy mysite.com < password.txt
echo "Done." 
```

我使用的完整脚本可以在 Github 上找到： [https ://github.com/Q42/q42.nl/blob/develop/deploy.sh](https://github.com/Q42/q42.nl/blob/develop/deploy.sh)

# php - 使用 javascript 和 php 从 mysql 级联下拉列表

> ID：15980072
> 
> 赞同：0
> 
> 时间：2013-04-12T20:11:30.613
> 
> 标签：php, javascript, mysql, forms, drop-down-menu

编辑：第一个条目底部的解决方案。

我现在已经搜索了一两天了，并且没有任何运气来让我的动态下拉菜单正常工作。

我有一个表格。第一个下拉列表是客户字段。我想要的是在下拉列表中选择客户时，在第二个下拉列表中选择与该客户关联的条款。无论选择什么客户，第二个下拉菜单始终具有相同的选项，这取决于为该特定客户“选择”了哪些选项。

这是它的样子。

```
Dropdown1 (customer)
---------
Acme Corp
Contoso Inc
Smithville

Dropdown2 (terms)
---------
NET15
NET30
NET45 
```

我希望 dropdown2 更改为 mysql 数据库中与该客户关联的条款。

我不知道是否应该将下拉选项保留在表单本身中并使用 javascript 调用 php 文件以找出为该客户选择的选项 - 或者 - 我是否应该简单地从表单中删除整个选项选择和有 javascript 调用，就像我在下面的工作中展示的那样。

这是我的两个下拉列表的形式，第二个来自带有 div 的 javascript。

```
<td><select name="company" onchange="getTerms('terms');">
<option value="" selected></option>
<?php while($row = mysql_fetch_array($result)) {
  echo "<option value=\"".$row['company']."\">".$row['company']." (".$row['first']." ".$row['last'].")</option>"; } ?></select></td>

<td><div id="terms"></div></td> 
```

这是我应该从 javascript 调用的 php 文件。这样做是为客户获取选项并选择已选择的选项。如果我使用 ?id=acme corp 直接在浏览器中运行它，它工作正常，所以我知道 php 正在工作。

```
<?php
include $_SERVER['DOCUMENT_ROOT']."/connect.php";

$result3 = mysql_query("SELECT * from netterms ORDER BY days ASC") or die(mysql_error());

$result = mysql_query("SELECT terms FROM customer WHERE company = '$_GET[id]'") or die(mysql_error());
$row = mysql_fetch_array($result);

echo "<option value=\"\" selected></option>";
while($row3 = mysql_fetch_array($result3)) {
  echo "<option value=\"".$row3['days']."\""; echo($row['terms'] == $row3['days']?' selected="selected"':null)?>><?php echo $row3['name']."</option>";

}
?> 
```

最后，这是我对 javascript/jquery 的尝试。

```
<script type="text/javascript">
 function getTerms(div){
    xmlhttp=new XMLHttpRequest();
    xmlhttp.onreadystatechange = function() {
     if (xmlhttp.readyState == 4 && xmlhttp.status == 200){
      var newdiv = document.createElement('div');
      newdiv.innerHTML = "<select name='terms'>" + xmlhttp.responseText + "</select>";
     }
      document.getElementById(div).appendChild(newdiv);
   }

 xmlhttp.open("GET", "customertermsdropdownquery.php?id=", false);
 xmlhttp.send();
 }
 </script> 
```

我看到的是，每次更改 dropdown1 时，屏幕上都会出现一个新的（附加）dropdown2。我不希望在整个页面上出现多个下拉菜单，只想刷新下拉菜单中的选项。另外，我不知道如何将 ?id= 从 xmlhttp.open 传递给我的 php 文件，如果你能帮助我，那就太好了！谢谢。

解决了：

经过几天的尝试，我在另一个网站上偶然发现了一个解决方案。这是代码。这里重要的是谨慎使用 div 标签和 table 标签。它是这样的，这在此作者的代码中未在下面显示。

对我来说，td 标签必须在此处而不是在 php.ini 中。但是，我的选择标签在 php.ini 中。我真的希望这对搜索的人有价值。

```
<html>
<head>
<script>
function showUser(str)
{
if (str=="")
  {
  document.getElementById("txtHint").innerHTML="";
  return;
  }
if (window.XMLHttpRequest)
  {// code for IE7+, Firefox, Chrome, Opera, Safari
  xmlhttp=new XMLHttpRequest();
  }
else
  {// code for IE6, IE5
  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");
  }
xmlhttp.onreadystatechange=function()
  {
  if (xmlhttp.readyState==4 && xmlhttp.status==200)
    {
    document.getElementById("txtHint").innerHTML=xmlhttp.responseText;
    }
  }
xmlhttp.open("GET","getuser.php?q="+str,true);
xmlhttp.send();
}
</script>
</head>
<body>

<form>
<select name="users" onchange="showUser(this.value)">
<option value="">Select a person:</option>
<option value="1">Peter Griffin</option>
<option value="2">Lois Griffin</option>
<option value="3">Glenn Quagmire</option>
<option value="4">Joseph Swanson</option>
</select>
</form>
<br>
<div id="txtHint"><b>Person info will be listed here.</b></div>

</body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:14:56.283

每次第一次选择更改时，您可能应该使用 Ajax 加载 php 脚本。

改编自[每次更改选择框时使用 ajax 发送 http 请求](https://stackoverflow.com/questions/13171361/sending-http-request-with-ajax-each-time-select-box-is-changed)：

我尝试调整您的问题的答案，但我无法真正测试它：

```
$("#company").live('change',function() 
{
    var selectVal = $('#company :selected').val();

    var $terms = $('#terms').html('');

    $.ajax({                                      
      url: 'customertermsdropdownquery.php',                         
      data: "id="+selectVal,                                                     
      dataType: 'GET',                
      success: function(data)         
      {

              $terms.append(data);

      } 
    });

}); 
```

# asp.net - ASP.net：“对象引用未设置为对象的实例。” 对于现有对象

> ID：15980074
> 
> 赞同：1
> 
> 时间：2013-04-12T20:11:35.503
> 
> 标签：asp.net

我在**asp.net 4.0** Web 应用程序中使用**MSCaptcha**控件。我已将提供的**.dll**和**.xml**文件放在**Bin**文件夹中并添加到页面顶部。这就是我在页面中使用它的方式：********`<%@ Register Assembly="MSCaptcha" Namespace="MSCaptcha" TagPrefix="cc1" %>`********

 ******```
<cc1:CaptchaControl ID="Captcha1" runat="server"
                 CaptchaBackgroundNoise="Low" CaptchaLength="4"
                 CaptchaHeight="60" CaptchaWidth="300"
                 CaptchaLineNoise="None" CaptchaMinTimeout="1"
                 CaptchaMaxTimeout="240" FontColor = "#529E00" /> 
```

在后面的代码中，我像这样使用它：

```
If Page.FindControl("Captcha1").ToString = "MSCaptcha.CaptchaControl" Then
    Captcha1.ValidateCaptcha(webCaptcha.Text.Trim())

    If Captcha1.UserValidated Then
        addComment()
    Else
        webWrongCaptcha.Text = "Captcha is wrong!"
    End If
Else
    Response.Redirect("contact.aspx?c=e")
End If 
```

但是如果用户在之后单击按钮，我会遇到此错误`CaptchaMaxTimeout`：

```
Line 7:              Captcha1.ValidateCaptcha(webCaptcha.Text.Trim()) 
```

我该如何解决？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:16:29.947

在调用它的属性之前，将您的逻辑包装在一个确定验证码是否为空的语句中。如果是，则通过向客户端发送消息来处理错误，让他们知道他们超过了超时并且他们需要重试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-22T17:48:06.680

将 EnableViewState="False" 添加到代码中：******

# php - ModRewrite Yii 框架

> ID：15980082
> 
> 赞同：0
> 
> 时间：2013-04-12T20:12:09.340
> 
> 标签：php, mod-rewrite, yii

我正在尝试在子目录中设置 Yii 框架。

我正在尝试设置此处找到的 htaccess 规则。 [http://www.yiiframework.com/doc/guide/1.1/en/topics.url](http://www.yiiframework.com/doc/guide/1.1/en/topics.url) 或见下文。

```
RewriteEngine on

# if a directory or a file exists, use it directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# otherwise forward it to index.php
RewriteRule . index.php 
```

我正在将 Yii 添加到一个普通的旧 php 应用程序中。所以我将 yii 添加为子目录。

所以 URI 通常是 /yii。

但是，它还需要能够转到另一个子目录，因为客户端可能决定将应用程序本身安装为子目录。所以重写规则也必须适用于 /app/yii

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T08:32:54.170

您提供的 htaccess 适用于所有目录。只需打开网址`/yii`或`/app/yii`它应该可以工作。

# php - Disqus 插件未显示在所有帖子上

> ID：15980084
> 
> 赞同：2
> 
> 时间：2013-04-12T20:12:20.993
> 
> 标签：php, wordpress, plugins, disqus

我已经尝试了几天来解决这个问题，但无济于事。实际上，在我的 Wordpress 博客中，我使用该`disqus`插件进行评论，但它只显示大约 15 个帖子中的 1 或 2 个帖子。我不明白为什么它没有出现在所有帖子上。

我还尝试禁用除 disqus 之外的所有剩余插件，但这也不起作用。

此外，当我将 disqus 插件正常出现的页面的页面源与其他未显示 disqus 插件的页面源进行比较时，没有区别，因为我可以看到两个页面中都出现了 disqus 插件脚本并且是相同的。

# php - PHP登录无法正常工作

> ID：15980090
> 
> 赞同：0
> 
> 时间：2013-04-12T20:12:41.557
> 
> 标签：php, post, methods, login, isset

我对 PHP 相当陌生，我似乎无法更正以下代码。

我的 acc_submit 位于：Pastebin [Link](http://pastebin.com/VhxuSt0v)

**编辑**

我想通了哈哈，我在检查密码是否是 MD5 但它没有在数据库中加密。只是另一个问题，如果我的用户名错误等，我可以在 index.php 中显示任何错误吗？感谢所有回复的人！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:15:42.253

在您的 PHP 代码中，您有`isset($_POST['submit'])`.，但在您的 HTML 代码中，您没有任何名为`submit`.

要解决此问题，您将不得不更改`<input type="submit" class="submit" value="Sign in" />`

至`<input type="submit" class="submit" name="submit" value="Sign in" />`

在查看了您的 PHP 代码之后，我注意到您正在使用这些`mysql_*`函数。您真的应该考虑切换到 PHP 的[mysqli](http://php.net/manual/en/book.mysqli.php)或 PHP 的[PDO](http://php.net/manual/en/book.pdo.php)扩展，以帮助保护自己免受 SQL 注入攻击。

**更新**

要回答海报的编辑，是的，您可能会在`index.php`. 为此，只需`index.php`使用某种标记重定向回。例如，您可以执行`header('location: index.php?id=1');`. 我不推荐使用`id`，但这只是一个例子。

然后，在您的`index.php`页面上，您将寻找`id`.

```
$message = '';
if(isset($_GET['id'])) { //Redirected with some message
    if($_GET['id'] == '1') {
        $message = 'Message for condition 1';
    }
    else if($_GET['id'] === 'login') {
        $message = 'Message for condition login';
    }
} 
```

然后稍后在您的页面中，您将只`echo $message;`显示您的自定义重定向消息。

# ruby-on-rails - 使用 has_many 关系为俄罗斯娃娃缓存构建 Rails 应用程序

> ID：15980094
> 
> 赞同：23
> 
> 时间：2013-04-12T20:13:02.723
> 
> 标签：ruby-on-rails, ruby, caching, fragment-caching, russian-doll-caching

在研究了 DHH 和其他关于基于键的缓存过期和俄罗斯娃娃缓存的博客文章之后，我仍然不确定如何处理一种关系类型。具体来说，是一种`has_many`关系。

我将在示例应用程序上分享我的研究结果。这是一个小故事，所以请稍等。假设我们有以下 ActiveRecord 模型。我们只关心模型的适当更改`cache_key`，对吗？

```
class Article < ActiveRecord::Base
  attr_accessible :author_id, :body, :title
  has_many :comments
  belongs_to :author
end

class Comment < ActiveRecord::Base
  attr_accessible :article_id, :author_id, :body
  belongs_to :author
  belongs_to :article, touch: true
end

class Author < ActiveRecord::Base
 attr_accessible :name
  has_many :articles
  has_many :comments
end 
```

我们已经有一篇文章，有一条评论。两者都出自不同的作者。目标是`cache_key`在以下情况下对文章进行更改：

1.  文章的正文或标题更改
2.  其评论的正文发生了变化
3.  文章作者姓名变更
4.  文章评论作者姓名变更

所以默认情况下，我们适用于案例 1 和 2。

```
1.9.3-p194 :034 > article.cache_key
 => "articles/1-20130412185804"
1.9.3-p194 :035 > article.comments.first.update_attribute('body', 'First Post!')
1.9.3-p194 :038 > article.cache_key
 => "articles/1-20130412185913" 
```

但不适用于案例 3。

```
1.9.3-p194 :040 > article.author.update_attribute('name', 'Adam A.')
1.9.3-p194 :041 > article.cache_key
 => "articles/1-20130412185913" 
```

让我们`cache_key`为`Article`.

```
class Article < ActiveRecord::Base
  attr_accessible :author_id, :body, :title
  has_many :comments
  belongs_to :author

  def cache_key
    [super, author.cache_key].join('/')
  end
end

1.9.3-p194 :007 > article.cache_key
 => "articles/1-20130412185913/authors/1-20130412190438"
1.9.3-p194 :008 > article.author.update_attribute('name', 'Adam B.')
1.9.3-p194 :009 > article.cache_key
 => "articles/1-20130412185913/authors/1-20130412190849" 
```

赢！但这当然不适用于案例 4。

```
1.9.3-p194 :012 > article.comments.first.author.update_attribute('name', 'Bernard A.')
1.9.3-p194 :013 > article.cache_key
 => "articles/1-20130412185913/authors/1-20130412190849" 
```

那么还有哪些选择呢？我们可以对 上的`has_many`关联做一些事情`Author`，但`has_many`没有`{touch: true}`选择，可能是有原因的。我想它可以按照以下方式实现。

```
class Author < ActiveRecord::Base
  attr_accessible :name
  has_many :articles
  has_many :comments

  before_save do
    articles.each { |record| record.touch }
    comments.each { |record| record.touch }
  end
end

article.comments.first.author.update_attribute('name', 'Bernard B.')
article.cache_key
  => "articles/1-20130412192036" 
```

虽然这确实有效。它通过加载、实例化和更新每篇文章和另一篇文章的评论，对性能产生巨大*影响*。我不相信这是一个正确的解决方案，但什么是？

当然 37signals 用例/示例可能会有所不同：`project -> todolist -> todo`. 但我想象一个单一的待办事项也属于用户。

如何解决这个缓存问题？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-06-06T04:31:48.097

我偶然发现的一种方法是通过缓存键来处理这个问题。为文章的评论者添加`has_many_through`关系：

```
class Article < ActiveRecord::Base
  attr_accessible :author_id, :body, :title
  has_many :comments
  has_many :commenters, through: :comments, source: :author
  belongs_to :author
end 
```

然后在文章/节目中，我们将像这样构造缓存键：

```
<% cache [@article, @article.commenters, @article.author] do %>
  <h2><%= @article.title %></h2>
  <p>Posted By: <%= @article.author.name %></p>
  <p><%= @article.body %></p>
  <ul><%= render @article.comments %></ul>
<% end %> 
```

诀窍在于，`commenters`无论何时添加、删除或更新评论，关联生成的缓存键都会发生变化。虽然这确实需要额外的 SQL 查询来生成缓存键，但它可以很好地与 Rails 的[低级缓存](http://railscasts.com/episodes/115-model-caching-revised)配合使用，并且添加诸如[identity_cache gem](https://github.com/Shopify/identity_cache)之类的东西可以很容易地帮助解决这个问题。

我想看看其他人是否有更清洁的解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-02-28T17:59:30.433

正如这里建议的[https://rails.lighthouseapp.com/projects/8994/tickets/4392-add-touch-option-to-has_many-associations](https://rails.lighthouseapp.com/projects/8994/tickets/4392-add-touch-option-to-has_many-associations)，在我的例子中，我刚刚创建了一个 after_save 回调来更新相关对象的时间戳。

```
 def touch_line_items_and_tactics
    self.line_item_advertisements.all.map(&:touch)
  end 
```

顺便说一句，我们在一个遗留数据库上构建了我们的 rails 应用程序，该数据库具有`last_modified_time`列名，它的语义是“**用户**上次修改它的时间”。因此，由于语义不同，我们无法使用`:touch`开箱即用的选项。[我不得不像https://gist.github.com/tispratik/9276110](https://gist.github.com/tispratik/9276110)这样对 cache_key 和 touch 方法进行猴子补丁，以便将更新的时间戳存储在 memcached 而不是数据库的 updated_at 列中。

另请注意，我不能使用`cache_timestamp_format`Rails 的默认设置，因为它提供的时间戳最多只有几秒钟。我觉得需要一个更细粒度的时间戳，所以我选择了：nsec（纳秒）。

带有 cache_timestamp_format 的时间戳：20140227181414
带有 nsec 的时间戳：20140227181414671756000

# flash - TideSDK App 的 Flash 支持

> ID：15980096
> 
> 赞同：0
> 
> 时间：2013-04-12T20:13:08.760
> 
> 标签：flash, tidesdk

我有一个应用程序可以打开一个关于用户操作的网页，并且该网页中有 Flash，我知道我的 99% 的用户已经在他们的系统中安装了 Flash，所以我需要知道是否有办法播放 Flash 视频在我的应用程序中。或者让我的应用程序访问用户系统上已安装的 Flash 播放器的一种方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T14:42:56.313

系统安装的 flash 播放器将在 TideSDK 中可用。使用它应该没有问题。

# osx-mountain-lion - 构建/安装成功，但在运行时：找不到 dyld 映像 - 为什么？

> ID：15980100
> 
> 赞同：1
> 
> 时间：2013-04-12T20:13:26.540
> 
> 标签：osx-mountain-lion, icu, dyld

我在我的应用程序中遇到了 ICU 的[这个问题](https://stackoverflow.com/questions/13611740/qt-mac-osx-10-8-dyld-library-not-loaded-image-not-found)，试图在我的 Mountain Lion MacBook Pro 上运行 Qt Creator。

现在我发现我在运行时遇到了类似的问题，我在同一台 MacBook Pro 上构建了一个 dmg。构建成功完成，运行 dmg 并安装成功，但是当我尝试运行时，我得到：

```
Dyld Error Message:
  Library not loaded: @executable_path/../Frameworks/libicuuc.46.dylib
  Referenced from: /Applications/MapCreator.app/Contents/SharedLibraries/libicui18n.46.1.dylib
  Reason: image not found 
```

我从源代码管理中获取了我们应用程序（和构建脚本）的先前标记版本，当它构建在这台 MacBook 上时，我遇到了同样的问题。

下面列出了我在运行构建脚本时看到的唯一错误。我相信这些错误一直存在于我们在所有机器上的构建中，并且从来都不是问题，但我在这里列出它们以防万一它有帮助：

```
ERROR: "strip: can't map file: /Users/david/dev/svn/map_creator1.0.2/build/mac/pkg-root/Applications/MapCreator.app/Contents (Invalid argument)
" 
ERROR: "" 
ERROR: "install_name_tool: can't map file: /Users/david/dev/svn/map_creator1.0.2/build/mac/pkg-root/Applications/MapCreator.app/Contents/Frameworks//.. (Invalid argument)
" 
ERROR: "" 
ERROR: "otool: can't map file: /Users/david/dev/svn/map_creator1.0.2/build/mac/pkg-root/Applications/MapCreator.app/Contents/Frameworks//.. (Invalid argument)
" 
ERROR: no file at "/usr/lib/libicui18n.46.dylib" 
ERROR: no file at "/usr/lib/libicuuc.46.dylib" 
ERROR: no file at "/usr/lib/libicudata.46.dylib" 
```

我不确定在哪里可以找到它。谁能指出我正确的方向？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T16:13:06.067

显然，我的 MacBook 上的 ICU 安装有些不同。该问题通过`install_name_tool -change`在我们的脚本中添加更多行来解决，以更改它在哪里寻找相关 ICU 文件的依赖项。

格式为：

```
install_name_tool -change old new file 
```

如果“旧”路径不匹配，它会忽略该命令。因此，只需添加新行就涵盖了各种可能的 ICU 安装的基础。

# git - git pull 选项以防止合并冲突

> ID：15980102
> 
> 赞同：10
> 
> 时间：2013-04-12T20:13:51.183
> 
> 标签：git, git-merge

这样做时是否有一个选项`git pull`不会允许任何合并冲突的可能性？我查看了[合并策略](https://www.kernel.org/pub/software/scm/git/docs/v1.6.4.1/git-merge.html#_merge_strategies)，但似乎没有一个符合这个描述。我正在寻找一个像`git pull --quit_if_possible_merge`

基本上，想要一个用于拉到生产站点的命令，而不会有任何合并冲突的风险，这会在我们解决它时暂时关闭站点。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-13T09:07:40.683

关于什么：

```
git pull --ff-only 
```

如果其他答案中所说的是真的，那么这应该具有完全预期的效果。不？

该`--ff-only`标志代表“快进”，这是 Git 如何指代其中一个合并分支包含另一个（严格超集）的所有提交的情况。这很特殊，因为这意味着不可能发生合并冲突。前面分支上的提交等简单地添加到其他分支，每个人都很高兴。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T21:16:26.957

我认为没有这样的标志。如果发生冲突，它就会发生冲突并需要处理。但是有一个合并策略可以保证没有合并冲突：**不要在生产站点上修改或提交任何东西**。

如果在生产站点上没有提交任何内容，那么就没有任何冲突。在本地机器上的生产分支上进行所有合并，并在从生产站点拉取之前解决那里的所有合并冲突。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-12T21:29:23.280

正如其他人已经说过的：如果您在本地存储库中提交了任何内容，您只会遇到合并冲突。如果不这样做，您将不会遇到任何合并冲突。

如果您没有提交任何内容，但是您在本地 git 存储库中工作，即您更改了文件或创建了新文件，`git pull`那么当它需要更新您修改的文件时，它仍然会给您带来麻烦。- 因此，不要直接在本地存储库中工作，你很好。

接下来，如果您坚持在本地存储库中工作并考虑`git pull`更新文件。您必须决定修改后的文件会发生什么。如果您只是想放弃所有本地更改并只获取远程存储库中的文件，您可以执行`git fetch;git reset --hard @{u}`.

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-07-12T13:07:07.223

在 Git 中合并时，您可以执行以下类型的合并：

```
git merge -ff-only branch_to_merge_into_this_one 
```

只有当 Git 发现您的合并可以使用快进方法完成时，这才会完成您的合并。否则 Git 将中止合并，并让您知道合并不可能快进。

那么什么是快进合并，它可以保证不会发生合并冲突。快进合并检查有问题的两个分支的提交历史记录（比如 A 和 B，你在 A 上合并到 B），然后检查 B 是否包含 A 的完整提交历史记录。此外，A 不包含任何不属于 B 的提交。这意味着在 B 中合并时可以保存，然后通过将 B 的所有新提交堆叠在 A 的 HEAD 之上然后将 A 的 HEAD 移动到 B 的 HEAD 所在的位置进行合并。以这种方式，更改集是线性应用的，并且不会发生冲突的编辑，因为 Git 将在其提交历史中拥有足够的信息来负责任地决定您需要和不想要哪些更改。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2014-03-12T14:28:39.917

Git 2.0（2014 年第二季度）在[提交 b814da8](https://github.com/git/git/commit/b814da891e8261b909fc5d9fb07b4e8b13989c2d)中添加了一个新设置`push.ff`：

在你的情况下：

```
git config push.ff only

pull.ff:: 
```

> 默认情况下，Git 在合并作为当前提交的后代的提交时不会创建额外的合并提交。相反，当前分支的尖端是快进的。
> 
> *   当设置为 时`false`，这个变量告诉 Git 在这种情况下创建一个额外的合并提交（相当于`--no-ff`从命令行提供选项）。
> *   **当设置为 时`only`，只允许这样的快进合并（相当于`--ff-only`从命令行给出选项）。**

# magento - 如何在magento中将某些cms页面从测试服务器传输到生产服务器

> ID：15980104
> 
> 赞同：1
> 
> 时间：2013-04-12T20:14:07.517
> 
> 标签：magento

有没有办法将某些 cms 页面从 magento 测试服务器传输到 magento 生产服务器？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:08:33.490

我在部署时使用了一个脚本，它将复制所有 CMS 页面并阻止从登台到生产。

```
mysqldump -u USER -pPASSWORD DATABASE cms_page cms_page_store cms_block cms_block_store | grep INSERT | sed 's/INSERT INTO/REPLACE INTO/' > cms_dump.sql 
```

然后我插入使用

```
mysql -u -p DATABASE < cms_dump.sql 
```

这对我有用，因为我使数据库保持同步。但是我认为您正在尝试做的是插入表 cms_page 之间的差异。

您可能可以执行以下操作：

```
SELECT * FROM database1.cms_page WHERE page_id NOT IN ( SELECT page_id FROM database2.cms_page); 
```

这应该为您提供所有不同的 ID，然后运行一个脚本，将这些行插入到生产数据库中。

希望这是有道理的。

# linux - Bash 将大文件拆分成小文件

> ID：15980111
> 
> 赞同：0
> 
> 时间：2013-04-12T20:14:40.100
> 
> 标签：linux, bash, file, shell

所以我想根据第 8 列将一个相当大的文件分成几个小文件。所以我写了这个脚本：

```
#!/bin/bash
run_command(){
eval ${1}
wait
}
chInput=("1" "2" "3" "4" "5" "6" "7" "8" "9" "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "Z" "T" "G" "F" "A" "D" "P")
sampInput=("heyA")

for ((x=0;x<${#chInput[@]};x++));do
com="awk -F'\t' '$8=="${chInput[x]}"' /home/location/"$sampInput"_This_P.txt > "$sampInput"Ch"${chInput[x]}".txt"
run_command "${com}"
done 
```

但它不起作用，因为

> '$8=="

```
awk: ==1
awk: ^ syntax error
awk: ==2
awk: ^ syntax error
awk: ==3
awk: ^ syntax error
awk: ==4
awk: ^ syntax error 
```

但只是做

```
awk -F'\t' '$8==1' /home/location/heyA_This_P.txt > Ch1.txt 
```

从命令行确实有效

我能做些什么来解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:19:08.383

严重的问题是双引号；`$8`在您分配变量时，将被某些东西（可能根本没有）替换。您可以尝试使用带有适当转义的单引号，但真正的解决方案可能是深呼吸并重新开始，而无需`eval`在变量中包含任何一个或 Awk 脚本。

无论如何，这种椒盐脆饼逻辑的目的是什么？您可能应该阅读并[牢记 http://mywiki.wooledge.org/BashFAQ/050中的建议](http://mywiki.wooledge.org/BashFAQ/050)

这是解决您的问题的快速尝试：

```
#!/bin/bash

chInput=("1" "2" "3" "4" "5" "6" "7" "8" "9" "10" "11" "12" "13" "14" "15" "16" "17" "18" "19" "Z" "T" "G" "F" "A" "D" "P")
sampInput=("heyA")

for ((x=0;x<${#chInput[@]};x++));do
    awk -F'\t' '$8=="'"${chInput[x]}"'"' /home/location/"$sampInput"_This_P.txt > "$sampInput"Ch"${chInput[x]}".txt
done 
```

特别注意用于插入`"${chInput[X]}"`脚本的构造（实际上，除了删除变量和其他内容之外，这实际上是我唯一更改的`eval`内容）。那是单引号中的字符串，与双引号中的字符串相邻，与单引号中的字符串相邻，在 Bash 中计算为单个字符串。所以`'foo'"bar"'baz'`评估为`foobarbaz`并且类似地`'"foo"'`相邻`"'bar'"`评估为`"foo"'bar'`。在这里，`'$8=="'`与相邻的`"${chInput[x]}"`相邻`'"'`计算`$8=="..."`在分配时替换双引号中的内容的位置。

（你也不需要数组；你可以这样做

```
for c in "1" "2" "3" "4" "5" "6" "7" "8" "9" "10" "11" "12" \
         "13" "14" "15" "16" "17" "18" "19" "Z" "T" "G" "F" \
         "A" "D" "P"
do
    awk -F'\t' '$8=="'"$c"'"' /home/location/"$sampInput"_This_P.txt > "${sampInput}Ch$c.txt"
done 
```

并与 Classic Bourne shell 兼容。）

# sql - SQL 更新 - 合并数据

> ID：15980114
> 
> 赞同：1
> 
> 时间：2013-04-12T20:14:54.210
> 
> 标签：sql, sql-server

数据库中的 USER_DIM 表出现问题，该表通过 USER_ID 引用了该数据库中的其他表，例如 USER_ACTIVITY_FACT。

当表的原始设计没有使用实际上来自不同数据库的 EXTERNAL_ID 的正确唯一标识符时，就会出现问题。

我可以弄清楚如何选择额外的行或删除它们，但我想更新其他表中的行以指向原始 USER_ID，然后删除 USER_DIM 表中的额外行

```
SELECT ACTIVITY_FACT.USER_ID
FROM USER_ACTIVITY_FACT 
WHERE USER_ACTIVITY_FACT.USER_ID IN (
select USER_ID    
  FROM USER_DIM
  WHERE EXTERNAL_ID IN (SELECT ud2.EXTERNAL_ID 
  FROM  USER_DIM as ud2
  where USER_ID > ud2.USER_ID)); 
```

将这些更新为最小的 USER_ID

然后对USER_DIM执行delete语句；

```
DELETE      
  FROM USER_DIM   
  WHERE EXTERNAL_ID IN (SELECT ud2.EXTERNAL_ID 
  FROM  USER_DIM as ud2
  where USER_ID > ud2.USER_ID); 
```

之后 ALTER 表在 EXTERNAL_ID 列上具有唯一索引。

此查询可能会按行更新，而不是更喜欢一次更新多行违规的额外 USER_ID。

在此先感谢您的帮助！

**更新** 为了澄清目标：

```
USER_ACTIVITY_FACT 
-------------
USER_ID
2 
3
4
5
6

USER_DIM
--------------
USER_ID  EXTERNAL_ID
2        23
3        23
4        24
5        24
6        26 
```

..结果应该看起来像

```
USER_ACTIVITY_FACT 
-------------
USER_ID
2 
2
4
4
6

USER_DIM
--------------
USER_ID  EXTERNAL_ID
2        23
4        24
6        26 
```

希望这可以帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:13:27.800

不确定我是否正确收到了请求，但这是我想出的。您可以使用 group by 找到每个 EXTERNAL_ID 的最小 USER_ID 并将其作为映射信息 (OLD_ID => NEW_ID) 放入临时表中。之后，您加入需要在临时表上更新的表并从旧 id 更新到新 id（加入 OLD_ID，更新到 NEW_ID）。最后，您可以像以前一样删除，或再次加入映射表。

您可以查看**[SQLFiddleDemo](http://www.sqlfiddle.com/#!6/f3e02/2)**

```
--prepare data and insert into #mapping temp table from dim
WITH CTE1 AS 
(
    SELECT EXTERNAL_ID, MIN(USER_ID) AS NEW_USER_ID
    FROM dbo.USER_DIM
    GROUP BY EXTERNAL_ID
)
SELECT  CTE1.EXTERNAL_ID ,
        USER_ID AS OLD_USER_ID ,
        NEW_USER_ID
INTO #mapping
FROM dbo.USER_DIM
INNER JOIN CTE1 ON dbo.USER_DIM.EXTERNAL_ID = CTE1.EXTERNAL_ID;

--check your mappings
SELECT * FROM #mapping;

--update fact table based on join on mappings
UPDATE fact 
SET fact.USER_ID = src.NEW_USER_ID
FROM #mapping src
INNER JOIN dbo.USER_ACTIVITY_FACT fact ON src.OLD_USER_ID = fact.USER_ID;

--check your fact table
SELECT * FROM USER_ACTIVITY_FACT;

--delete from dim based on mappings missmatch
DELETE d
FROM dbo.USER_DIM d
INNER JOIN #mapping m ON d.USER_ID = m.OLD_USER_ID
WHERE m.NEW_USER_ID <> m.OLD_USER_ID;

--check your dim table
SELECT * FROM dbo.USER_DIM; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:32:21.423

[使用带有OUTPUT](http://msdn.microsoft.com/en-us/library/ms177564.aspx)子句的派生表中的 UPDATE

```
DECLARE @delUserID TABLE(delUserID int) 

UPDATE x
SET x.USER_ID = x.NewUserID
OUTPUT DELETED.USER_ID INTO @delUserID
FROM (  
      SELECT f.USER_ID, 
             MIN(f.USER_ID) OVER(PARTITION BY u.EXTERNAL_ID) AS NewUserID             
      FROM dbo.USER_ATIVITY_FACT f JOIN dbo.USER_DIM u ON f.USER_ID = u.USER_ID
      ) x
WHERE x.USER_ID != x.NewUserID      

DELETE USER_DIM
WHERE USER_ID IN (SELECT delUserID FROM @delUserID) 
```

[**SQLFiddle**](http://sqlfiddle.com/#!3/49a37/3)上的演示[](http://sqlfiddle.com/#!3/49a37/3)

 *** * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-15T13:44:13.600

这是我想出的。@Nenad 解决方案有效，但我必须通过 liquibase 脚本来推动它，并且不确定 SQL Server 功能是否有效。我也针对**[SQLFiddle](http://www.sqlfiddle.com/#!6/fdde7/4)**进行了检查。

```
--prepare data and insert into #mapping temp table from dim
UPDATE USER_ACTIVITY_FACT 
SET 
    USER_ID = (SELECT 
            MIN(ud1.USER_ID)
        FROM
            USER_DIM as ud1
        WHERE
            ud1.EXTERNAL_ID = (SELECT 
                    MIN(ud2.EXTERNAL_ID)
                FROM
                    USER_DIM as ud2,
                    USER_DIM as ud3
                WHERE
                    ud2.EXTERNAL_ID = ud3.EXTERNAL_ID
                        AND ud3.USER_ID = USER_ACTIVITY_FACT.USER_ID)
); 

--delete from dim based on mappings missmatch
DELETE      
  FROM USER_DIM  
WHERE EXISTS
    (SELECT * FROM USER_DIM t1 
     WHERE t1.EXTERNAL_ID = USER_DIM.EXTERNAL_ID
 AND USER_DIM.USER_ID > t1.USER_ID); 
```**

# javascript - 直接链接到引导选项卡而不滚动到锚点？

> ID：15980115
> 
> 赞同：0
> 
> 时间：2013-04-12T20:14:55.440
> 
> 标签：javascript, jquery, html, hyperlink

我有一个这样的引导选项卡 - [http://twitter.github.com/bootstrap/components.html#navs](http://twitter.github.com/bootstrap/components.html#navs)

一切正常，但我想链接每个选项卡，以便我可以直接访问它

如果我使用锚点（#mytab）链接，页面滚动到该锚点（用户会错过有关选项卡的所有内容）

有没有办法在不滚动的情况下创建指向某个选项卡的直接链接（通过锚点或其他方法）？

# error-handling - 在 Windows7 上安装 rpy2 时出错

> ID：15980119
> 
> 赞同：0
> 
> 时间：2013-04-12T20:15:14.973
> 
> 标签：error-handling, rpy2

**错误：试图猜测 R 的 HOME 但 PATH 中没有 R 命令。**

我正是这样做的：

## 3.定义环境变量

控制面板 | 高级选项卡 | 环境变量

定义以下内容：RHOME、R_HOME、R_USER

例子

```
`RHOME: C:\Program Files\R\R-2.13.1
+R_HOME: C:\Program Files\R\R-2.13.1
+R_USER: C:\Users\username\Documents` 
```

## 4\. 将 R（和 Rtools）可执行文件的路径附加到 PATH

控制面板 | 高级选项卡 | 环境变量

示例路径：C:\Program Files\R\R-2.13.1\bin\i386；C:\Rtools\bin

但是，我并不完全理解第三点。您能解释一下 RHOME、R_HOME、R_USER 背后的含义吗？谢谢，真的很紧急！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-30T22:03:12.243

您可能会发现从加州大学尔湾分校的存储库中获取[二进制](http://www.lfd.uci.edu/~gohlke/pythonlibs/)安装程序要容易得多。

用这个测试：

```
import rpy2.robjects as robjects
print robjects.r('pi') 
```

其他要看的东西：

*   在 Windows 中，当您通过控制面板设置环境变量时，您必须重新启动命令 shell 才能被接受。
*   R_HOME 指向 R 分布。R_USER 是您存储本地文件的位置。理想情况下，如果您将这些设置为用户变量，那么您的路径可以引用 %R_HOME% 而不是硬编码路径。这里有更多关于 Windows 处理这两种环境变量的[信息](https://superuser.com/questions/27826/why-cant-windows-handle-an-environment-variable-in-path)。

# byte-order-mark - 从网站上删除 bom？

> ID：15980120
> 
> 赞同：0
> 
> 时间：2013-04-12T20:15:21.193
> 
> 标签：byte-order-mark

嗨，我对我的网站做了一些事情，现在我的网站上出现了一个令人讨厌的 bom 字符，我最近在我的标题中添加了我的标题元标记，现在我让这些愚蠢的字符出现在我的网站上，称为字节顺序标记，我尝试了一切以删除它们，但它们不会消失，请帮助。

```
ï»¿ 
```

我最近将此添加到我的 header.php 文件中，我认为是因为它将它保存在 utf-8 中，还是它这样做了？没有把握。

```
<meta name="robots" content="index,follow" />
<meta name="msnbot" content="NOODP" /><meta name="googlebot" content="NOODP" /><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<meta http-equiv="content-language" content="en-GB" /> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:35:45.090

Web 服务器不知道如何忽略它们。您必须找到最近编辑的文件并将其删除。

该文件是使用自动插入字符的编辑器进行编辑的。您必须使用不同的编辑器打开并重新保存文件。（或者弄清楚如何重新配置​​你的编辑器）。一些编辑器可以选择使用或不使用 bom 来保存文件。

如果您在 *Nix 上，请使用此命令查找并删除目录下的所有标记

```
find . -type f -exec sed '1s/^\xEF\xBB\xBF//' -i.bak {} \; -exec rm {}.bak \; 
```

如果您只想找到它们：

```
 grep -rl $'\xEF\xBB\xBF' . 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:27:02.660

根据这个（[http://www.w3.org/International/questions/qa-byte-order-mark.en.php），PHP](http://www.w3.org/International/questions/qa-byte-order-mark.en.php)包含文件中的BOM会导致问题（他们说这会导致空行）。他们建议 PHP 包含的文件不包含 BOM。如何从 header.php 文件中删除它取决于您的文本编辑器。例如，Windows 上的 Notepad++ 有一个 Encoding 菜单，您可以从中选择“Convert to UTF-8 without BOM”。

# c# - 具有中间类的 EntityFramework InverseProperty

> ID：15980121
> 
> 赞同：0
> 
> 时间：2013-04-12T20:15:24.280
> 
> 标签：c#, entity-framework-5

我有 3 节课：

```
public class User
{
    ...
    public List<SerialHistory> SerialHistory { get; set;}
    ...
}

public class SerialHistory
{
    ...
    public DateTime DateAdded { get; set; }
    public SerialNumber SerialNumber { get; set; }
    ...
}

public class SerialNumber
{
    ...
    public User User { get; set; }
    ...
} 
```

我真的很喜欢这样，当我这样做时：

```
user.SerialHistory.Add(new SerialHistory { 
                                            SerialNumber = serialNumber, 
                                            DateAdded = DateTime.Now 
                                         }); 
```

会自动分配给它`serialNumber.User`。`user`

这是可能的还是超出了 EntityFramework 的能力？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:29:33.927

No, there is no special option in Entity Framework to ensure this. `User.SerialHistory` and `SerialNumber.User` are navigation properties of two different relationships. What you have is a special business logic that cannot be enforced by a foreign key relationship in the database, hence it cannot be enforced by any mapping (that basically just represents foreign key relationships) with Entity Framework.

Your best option is maybe a special method of `User`:

```
public void AddSerialNumber(SerialNumber serialNumber)
{
    serialNumber.User = this;
    SerialHistory.Add(new SerialHistory { 
                                            SerialNumber = serialNumber, 
                                            DateAdded = DateTime.Now 
                                        });
} 
```

# jquery - 如何从输入中获取 td 值：使用 jquery 检查？

> ID：15980122
> 
> 赞同：0
> 
> 时间：2013-04-12T20:15:34.287
> 
> 标签：jquery

对于我的生活，我无法弄清楚如何使用`$(this)`. 这是我的尝试

```
<tbody id="testTable">
    <tr><td class="tdData"><input type="checkbox"></input></td></tr>
</tbody>

$("#testTable tr td > input:checked").each(function()
{
    alert($(this).parent().text()); // alert shows empty
    alert($(this).find(".tdData").text()); // alert shows empty
    alert(this.nodeName); // alert shows INPUT
    alert($(".tdData").text()); // alert shows data
}); 
```

使用`$(this)`似乎不起作用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:17:36.950

```
$("#testTable tr td > input:checked").each(function()
{
     alert($(this).val()); 
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:28:37.543

`$(this)`in an `each()`loop 指的是在初始语句中发布的元素，`$("#testTable tr td > input:checked")`即复选框。

因此，如果您想获取每个单元格的 td 值，只需使用

```
$("#testTable tr td").each(... 
```

然后`$(this)`引用表格单元格。如您所见，获取输入或空 td 的文本值不会返回任何内容。

# lua - 调度异步事件？

> ID：15980123
> 
> 赞同：0
> 
> 时间：2013-04-12T20:15:33.927
> 
> 标签：lua, wxwidgets

* * *

**已解决：**事实证明我做的几乎所有事情都是正确的，并且 wxLua 库运行良好。问题在于将 Debug 中编译的库与 Release 中的其他库混合在一起。

[邮件列表存档](http://sourceforge.net/mailarchive/forum.php?thread_name=CAAK6oFcS6dKUA-G0JziyavTGVk9-VkDUJKiHcbpJKU6HY3EU5A@mail.gmail.com&forum_name=wxlua-users)

* * *

我正在使用 wxLua 制作界面，但我面临着几个崩溃的问题，在寻找它们的来源后，我可以找到它。我正在加载标准 lua 解释器，而不是将我的 C++ 代码与 wxLua 链接，我创建了一个标准 lua 解释器，然后我在其中执行了一个 require("wx")，它加载了 wx.dll。我有一个可能的原因的想法，所以我会问，以防这是一种已知的行为。前几个问题？

1.  首先在 wxWidgets 中，事件（单击、单元格更改、树项激活等）是同步还是异步调度的？

2.  如果是异步的，是否有可能事件是同时针对相同 lua 状态的调度程序？

我拥有的是一个带有多个项目和一个网格的树控件，因此当树中的一个项目被激活时，网格被填满。我目前连接到树项目激活、树项目右键单击、网格单元更改的事件。

假设在主循环上运行的 wxWidget 线程是 A（3。我相信这是加载 lua 脚本的线程，不是吗？），当我激活一个树节点时，一个事件（evt1）将在事件队列（4。不是吗？），主循环将检查挂起的事件，它会找到事件（evt1）并调度它（5。但是线程会调用来自事件处理程序的lua函数运行主循环（A）还是会创建第二个线程（B）？）。

如果问题 5 是为执行处理程序创建一个新线程，树中的另一个事件 (evt2) 是否可以在事件队列中排队，然后主循环线程 (A) 调度它创建一个新线程 (C)在前一个事件线程（B）尚未返回时访问和修改 lua 状态**？**

到目前为止，我的孔测试一直在重新绘制网格，同时在树项上单击几个计时器，因此事件处理程序不会立即返回。

我认为可以总结所有以前的问题，但是，wxLua 是否保护从 wxLua 内部访问 lua 状态？

提前致谢。

此致。

哈维。

注意：我将在邮件列表上发布相同的问题，只是让您知道。我会将解决方案从一个复制到另一个。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:24:29.800

我不知道**lua**是什么，但是 wxWidgets GUI 事件都在主线程中处理。不创建新线程。

# iphone - ui_orientation，来自 Apple 的又一颗无证明珠

> ID：15980127
> 
> 赞同：4
> 
> 时间：2013-04-12T20:15:56.107
> 
> 标签：iphone, ios, ipad

我在 WWDC 视频上看到了这个 ui_orientation 糖果，在这个上下文中使用

```
UIImage *finalImage = [[UIImage alloc] initWithCGImage:cgimg
                      scale:2.0f orientation:ui_orientation([displayImage properties])]; 
```

显然它读取 CCImage 的方向以正确创建 UIImage，但是在我的代码上使用它会产生此错误：**函数 'ui_orientation' 的隐式声明在 C99 中无效**

你们知道我应该在我的源代码中包含什么标题才能使这个功能工作吗？

谢谢。

注意：WWDC 2012 - 第 510 课 25'16" ... 创建 UIImage 时

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T21:48:35.297

这是来自 Session 422，他们在其中给出了代码

> 将方向属性转换为 UIImageOrientation：

```
UIImageOrientation ui_orientation (NSDictionary* props)
{
    int o = [[props valueForKey:(id)kCGImagePropertyOrientation] intValue];
    UIImageOrientation map[] = {
        UIImageOrientationUp,
        UIImageOrientationUp, UIImageOrientationUpMirrored,
        UIImageOrientationDown, UIImageOrientationDownMirrored,
        UIImageOrientationLeftMirrored, UIImageOrientationRight,
        UIImageOrientationRightMirrored, UIImageOrientationLeft,
    };
    return map[o];
} 
```

**这里还有一个方便的提示：**从所有 WWDC 会议中下载所有 PDF，并将它们保存在您的硬盘上。它们不占用太多空间。这样，当您想查找会话讨论的内容`CATransaction`或（如此处）组成的功能时，您可以使用 Spotlight 查找以会话编号作为标题的 PDF。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:13:26.667

按照 H2CO3 的建议，我跑了

```
otool -tv UIKit | grep ui_orientation 
```

`UIKit`的路径在哪里

```
/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS6.1.sdk/System/Library/Frameworks/UIKit.framework 
```

该命令没有返回任何结果，因此我可以确认该函数没有公共定义`ui_orientation`，就像 iOS SDK 6.1 一样。

这可能是为该特定示例而定义的宏，因此对于 Apple 没有明确说明感到羞耻。

# php - PHP SMTPClient 添加 CC 和 BCC

> ID：15980134
> 
> 赞同：0
> 
> 时间：2013-04-12T20:16:25.367
> 
> 标签：php, smtp, smtpclient, bcc, carbon-copy

我找到了一个简单的 SMTPClient 类，用于通过 SMTP 发送电子邮件。问题是我需要向客户端添加抄送和密送收件人。有人可以协助实施吗？

继承人类（向下滚动一点）：[SMTPClient](http://www.9lessons.info/2009/10/send-mail-using-smtp-and-php.html)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T23:15:09.487

您是否真的阅读过您下载它的同一页面，其中一条评论解释了如何将 CC 和 BCC 添加到此，我显然没有自己尝试过，但已将其复制并粘贴在这里供您参考，更改了一些帮助的格式：

1.首先您需要更改名为 index.php 的文件：

您必须在表单中添加一个名为 cc 的新字段。然后将其从 POST Array 恢复到 $cc（在其他变量中，如 $from、$to ...）。最后，您必须在 SMTPClient 函数调用中的 $to 和 $subject 之间添加 $cc。

2\. 接下来您必须更改名为 SMTPClass.php 的文件：

您必须像在函数调用中那样将 $cc 添加到 SMTPClient 函数定义中。然后添加一个名为 $this->cc 的新变量，在其中放置实际的 $cc。

使用新变量 $this->cc 复制 RCPT TO 命令并在 $talk[...] 数组中获取响应：

```
 fputs ($SMTPIN, "RCPT TO: <".$this->cc.">\r\n");
 $talk["Cc"] = fgets ($SMTPIN, 1024); 
```

最后，通过在 DATA 命令下的“To：”行之后添加以下行，将您的变量放在邮件标题中：

```
Cc: <".$this->cc.">\r\n 
```

最后的 DATA 命令是：

```
 fputs($SMTPIN, "DATA\r\n");
 $talk["data"]=fgets( $SMTPIN,1024 );
 fputs($SMTPIN, "To: <".$this->to.">\r\nCc: <".$this->cc.">\r\nFrom: <".$this->from.">\r\nSubject:".$this->subject."\r\n\r\n\r\n".$this->body."\r\n.\r\n");
 $talk["send"]=fgets($SMTPIN,256); 
```

您也可以使用 BCc 以相同的方式执行此操作...

# mongodb - _id: ObjectID 和 String 有什么区别？

> ID：15980136
> 
> 赞同：7
> 
> 时间：2013-04-12T20:16:27.140
> 
> 标签：mongodb

有什么区别：

```
{
   _id: ObjectId("507f191e810c19729de860ea")
} 
```

和

```
{
   _id: "507f191e810c19729de860ea"
} 
```

我似乎在这件事上找不到任何东西。

这让我感到困惑，因为当您使用 JavaScript 插入时，它会使用该`ObjectId("507f191e810c19729de860ea")`格式。但如果您使用 C# 驱动程序，它将使用该`"507f191e810c19729de860ea"`格式。

字符串格式似乎是更好的选择，因为它使用的空间更少。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T20:19:24.443

ObjectID 是一个 12 字节的 BSON 对象 ID（它需要 24 才能显示为十六进制，因为您需要两个十六进制字符来编码一个字节值）。该字符串是一个完整的 24 个字节。有关详细信息，请参阅[ObjectID](http://docs.mongodb.org/manual/reference/object-id/)规范。

也就是说，您可以为您的`_id`字段使用任何您想要的东西，但建议您坚持一致的方案 - 使用所有字符串（以及在您从外键引用其他文档的情况下使用字符串）或使用所有 ObjectID。使用 ObjectID 是传统的做法，但只要您有一个完全一致的方案，您就不应该遇到重大问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:23:03.800

最大的区别当然是目标存储以及您在 API 中如何与之交互。（我在 StackOverflow 上写过与 DBRefs 相关的类似内容）[。](https://stackoverflow.com/questions/15923788/mongodb-construct-dbref-with-string-or-objectid/15927508#15927508)

使用 C# 驱动程序（和普通旧 C# 对象）时，如果要强制将 Id 存储为`ObjectId`，则可能需要使用`BsonRepresentationAttribute`：

```
public class StackOverflow
{
    [BsonId]
    [BsonRepresentation(BsonType.ObjectId)]
    public string Id { get; set; }

    public string Name { get; set; }
} 
```

或者，如果你想让你的类没有 MongoDB 属性：

```
BsonClassMap.RegisterClassMap<StackOverflow>(cm => {
    cm.AutoMap();
    cm.IdMemberMap.SetRepresentation(BsonType.ObjectId);
}); 
```

我已经多次成功地使用了这种[技术。](http://docs.mongodb.org/ecosystem/tutorial/serialize-documents-with-the-csharp-driver/#representationserializationoptions)当我没有明确地将其设置`_id`为自定义 ID（某种自定义键）时，我总是使用该`ObjectId`格式，因为它相对较小且唯一（并且小于 UUID 并且还嵌入了创建时间，这有时非常好） .

# html - 类内第一个元素的 CSS 选择器

> ID：15980139
> 
> 赞同：1
> 
> 时间：2013-04-12T20:16:47.027
> 
> 标签：html, css, css-selectors

我有这个东西

```
<div class="foo">
  <input type="text" name="bar" value="" />
  <a href="javascript:void(0)">foobar 1</a>
</div>
<div class="foo">
  <input type="text" name="bar" value="" />
  <a href="javascript:void(0)">foobar 2</a>
</div>
<div class="foo">
  <input type="text" name="bar" value="" />
  <a href="javascript:void(0)">foobar 3</a>
</div>

<!-- I'm trying with this CSS, but with no luck -->
<style> 
.foo a:first-child {
   display:none;
}
</style> 
```

我怎样才能只显示`foobar 2`和`foobar 3`链接？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:20:39.303

选择器应该选择第一个`.foo`元素，而不是`a`foo 中的第一个元素。

```
.foo:first-child a{
   display:none;
} 
```

有关伪选择器以及此[工作示例](http://jsfiddle.net/MH4LN/4/)的更多信息，请参阅[这篇文章](https://stackoverflow.com/questions/15543079/css-pseudo-class-last-child-issue/15543914#15543914)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:19:47.540

你应该移动`:first-child`伪类：

```
.foo:first-child a {
   display:none;
} 
```

但它要求`div`它是其父元素的第一个子元素。

**[演示](http://jsfiddle.net/PFUAh/1/)**

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2016-09-26T17:34:49.553

很简单

```
$('.foo:nth-child(3)') 
```

# python - 引用列表的一部分，就好像它是列表本身一样

> ID：15980142
> 
> 赞同：2
> 
> 时间：2013-04-12T20:17:05.263
> 
> 标签：python, python-3.x

有没有办法获取列表的一个子部分，作为列表，并且更改会反映回源列表？例如：

```
x = list(range(10))
y = [some subsection of x]    # What goes here?
y.reverse()
print(x) 
```

所需的输出，注意元素 3 到 7 的反转：

```
[0, 1, 2, 7, 6, 5, 4, 3, 8, 9] 
```

如果这不可能，是否有其他工具可以提供类似的功能？

这也许是我想做的事情的一个更好的例子，据我所知，切片分配不能处理它。至少，不是很优雅。递归快速排序：

```
def QuickSort(x):
    left,right = Partition(x)
    QuickSort(left)
    QuickSort(right) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:24:16.397

您正在寻找的可能是*numpy数组。*切片*numpy*数组返回一个视图，而不是一个副本。请参阅[http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing](http://docs.scipy.org/doc/numpy/reference/arrays.indexing.html#basic-slicing)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T20:27:50.263

用列表不可能做到这一点，[numpy](http://www.numpy.org/)经常会这样做。也就是说，列表切片是副本，但 numpy 数组切片是视图。

```
import numpy as np

x = np.arange(10)
y = x[3:6]
y[:] = 1
print y    # [1 1 1]
print x    # [0 1 2 1 1 1 6 7 8 9] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:21:15.007

无法进行`y`直接影响的修改`x`，但您可以使用切片分配来`x`使用来自 的值进行更新`y`。例如：

```
>>> x = list(range(10))
>>> y = x[3:8]
>>> y.reverse()
>>> x[3:8] = y
>>> x
[0, 1, 2, 7, 6, 5, 4, 3, 8, 9] 
```

当然，您可以在一行中完成所有这些操作，`x[3:8] = reversed(x[3:8])`.

# php - PHP PDO MySQL LIKE 和准备好的语句

> ID：15980148
> 
> 赞同：1
> 
> 时间：2013-04-12T20:17:23.107
> 
> 标签：php, mysql, pdo

假设`$search`是来自用户输入的字符串，并且`$db`是有效的 PDO 引用。

据我了解，以下块是首选并且应该可以工作：

```
$imageStatement = $db->prepare("SELECT
images.whatever
FROM images
WHERE images.title LIKE :titleSearch OR images.description LIKE :descriptionSearch");
$imageStatement->bindValue(':titleSearch', "%{$search}%");
$imageStatement->bindValue(':descriptionSearch', "%{$search}%");
$images = $imageStatement->fetchAll(); 
```

它返回 0 个结果，而以下返回预期回报：

```
$search = $db->quote("%{$search}%");
$images = $db->query("SELECT
images.whatever
FROM images
WHERE images.title LIKE {$search} OR images.description LIKE {$search}")->fetchAll(); 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T20:23:49.337

您从未执行过您的 PDO 语句。绑定参数后，`execute`在检索结果之前调用。

```
$imageStatement->bindValue(':titleSearch', "%{$search}%");
$imageStatement->bindValue(':descriptionSearch', "%{$search}%");
$imageStatement->execute(); //ADD THIS STATEMENT
$images = $imageStatement->fetchAll(); 
```

PDO 的`query`函数不需要你调用`execute`，因为它不是参数化查询。

# java - 从字符串中解析 JSON 数组的问题

> ID：15980149
> 
> 赞同：1
> 
> 时间：2013-04-12T20:17:24.823
> 
> 标签：java, android, json

因此，我正在开发一个 Android 应用程序，该应用程序将从远程服务器（运行 PHP）读取 JSON 响应。在我尝试从较大的 JSON 字符串中读取数组数据项之前，一切正常。下面是 Eclipse 在尝试将对象解析到数组时抛出的错误。有人有想法么？JSONLint 验证这个数组是有效的 JSON，所以我不确定这里有什么问题。
注意 - 它确实让我将此元素解析为 JSONObject，但我不清楚如何将它从它获取到我需要的关联数组。我确实看到 JSONObject 有一个 ToJSONArray 方法，但它需要一个数组键列表，但这些是可变的，在我解析该死的数组之前我不会知道它们是什么！任何帮助表示赞赏。

```
 public JSONArray parseJson(String jsonString) {

    JSONArray data = new JSONArray();
    try {
        JSONObject json = new JSONObject(jsonString);
        success = json.getBoolean("success");
        object = json.getString("object");
        message = json.getString("message");

        data = json.getJSONArray("data")

    } catch (JSONException e) {
        Log.e("ServerResponse::parseJson", e.getMessage());
         e.printStackTrace();
        success = false;
        message = "Error parsing return JSON data. " + e.getCause();
    }
    return data;
} 
```

这是我要解析的 JSON 数组：

```
{
"1": {
    "country_of_origin": "US",
    "genre": "Action",
    "date_finished": "2005-06-17",
    "dtimemod": "2009-12-03 14:29:59",
    "netflix_rating": "82",
    "table": "movies",
    "rotten_rating": "82",
    "format": "Live Action",
    "date_begun": "2005-06-17",
    "id": "3055",
    "dtimecre": "2009-12-03 14:29:59",
    "name": "Batman Begins",
    "user_id": "mcenci",
    "year": "2005",
    "actors": "Christian Bale, Michael Caine, Liam Neeson, Morgan Freeman, Gary Oldman, Ken Watanabe, Katie Holmes, Cillian Murphy, Tom Wilkinson, Rutger Hauer, Sara Stewart, Richard Brake, Gus Lewis",
    "rating": "100",
    "extra_info": "Runtime: 140 min\n",
    "public": "0",
    "notes": "",
    "key": "103",
    "genre2": "Sci-Fi"
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:23:07.000

您的 JSON 不是数组。

它是一个包含一个名为“1”的对象的对象，该对象包含许多属性。在 JSON 中，数组以以下方式开始`[`和结束，`]` 例如：

```
{ "myStringArray" : [ "adsf", "qwer" ] } 
```

或者

```
{ "myObjectArray" : [ 
  { "prop1" : "asdf", "prop2" : "qwer" },
  { "prop1" : "zxcv", "prop2" : "qwer" }
]} 
```

更进一步，我建议不要使用 JSONObject/JSONArray 的东西并使用功能强大的库。我更喜欢 Jackson，但是当我评估它时，我发现它太大了，我觉得将它放在一个 android 项目中感觉很好，所以我选择了 GSON。

使用更好的库，您可以将对象映射到 a `Map<String, Object>`，或者如果您提供的样本表明您的数据将始终如一，您可以将其映射到`Map<String, String>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:29:53.680

您的 JSONObject 实际上是一个数组，其中第一个 Object 键为 1。尝试：

```
JSONObject json = new JSONArray(jsonString).getJSONObject(0); 
// or JSONObject json = new JSONObject(jsonString).getJSONObject("1");
success = json.getBoolean("success");
object = json.getString("object");
message = json.getString("message");

data = json.getJSONArray("data") 
```

那样有用吗 ？

# css - 透明div内的实心div？

> ID：15980153
> 
> 赞同：5
> 
> 时间：2013-04-12T20:17:43.970
> 
> 标签：css, opacity

我在不透明度为 0.4 的 div 中有一个导航列表（无序列表）。UL 内的锚点设置为不透明度 1，但这没有效果。

```
<div style="background-color: #000; opacity: 0.4">
    <ul>
        <li><a href=".." style="background-color: #000; opacity: 1">home</a></li>
    </ul>
</div> 
```

有什么建议么？谢谢

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-04-12T20:19:25.260

像这样试试

```
<div style="background-color: rgba(0, 0, 0, .4);">
    <ul>
        <li><a href=".." style="background-color: rgba(0, 0, 0, 1);">home</a></li>
    </ul>
</div> 
```

避免内联样式是个好主意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T20:20:43.093

不透明度被继承，所以当你应用不透明度时：1；对于子元素，它是根据不透明度计算的：0.4；它的父母。

为了克服这个问题 - 如果你不能使用 rgba - 创建一个包装元素，在其中创建你的 0.4 opacity 元素，然后创建另一个并绝对定位另一个元素。

# javascript - jquery 对使用 jquery.load() 从 PHP 脚本检索的选择框没有响应

> ID：15980154
> 
> 赞同：0
> 
> 时间：2013-04-12T20:17:53.437
> 
> 标签：javascript, jquery

我在管理页面上有一个隐藏的 div。当单击站点上的图像链接时，div 会显示自己。div 的内容是通过对 PHP 脚本的 jquery.load() 调用加载的，该脚本作为回报发回对应链接的 HTML 表单。通过这种方式，我为管理员构建了一个控制面板。当管理员单击一个图标时，页面顶部会出现一个框，内容是一个 HTML 表单，管理员可以在其中对站点进行设置。我已经制作了两个完美运行的链接。

但是，现在，我需要制作第三个表单，其中包含两个选择框。第二个选择框的内容必须取决于第一个选择框的选择。第一个选择框的类是“目标”。因此，我需要使用 jquery 代码：

```
$('.target').change(function() 
```

但是这不起作用，因为选择框是使用 jquery.load() 检索的。就像 jquery 根本无法“看到”选择框一样。

我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:20:00.240

了解[on()的威力](http://api.jquery.com/on/)

```
$(document).on("change", ".target", function() { }); 
```

# javascript - javascript 中的多个函数调用，即 combine(foo)(bar)

> ID：15980155
> 
> 赞同：1
> 
> 时间：2013-04-12T20:17:59.233
> 
> 标签：javascript, function, invocation

我在过去看到你可以做这样的事情：

```
function combine(arg1){
   return function(arg2){
      return (arg1 + arg2);
   };
}
combine("foo")("bar"); 
```

结果将是“foobar”。

您当然可以执行以下操作：

```
(function(x){
    return function(y){
       return x+y;
    };
})(2)(3); 
```

结果是5。

我只是想知道这叫什么。我想我看到了一个我似乎找不到的 Crockford 的小视频，我确信它是在 Good Parts 上，简要地谈到了这一点。我也有书，里面看不到。

这似乎只是调用函数和控制变量范围的另一种方式。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:30:10.060

我相信你正在寻找[Currying这个词](http://en.wikipedia.org/wiki/Currying)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-09-12T04:46:43.293

Rchristiani，Crockford 引用了从两个调用中添加的函数的视频可以在 YouTube 上找到。它是 FrontEndMasters.com 研讨会系列的一部分。

与 Douglas Crockford 一起测试您对函数范围的了解：http: [//youtu.be/hRJrp17WnOE](http://youtu.be/hRJrp17WnOE)

Crockford 的网站包含一份出色的、令人兴奋的 Currying 细分副本。（我不确定原作者是谁。）它显示了多次调用的示例。

[http://www.crockford.com/javascript/www_svendtofte_com/code/curried_javascript/index.html](http://www.crockford.com/javascript/www_svendtofte_com/code/curried_javascript/index.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:33:22.647

您正在寻找的是[Currying](http://en.wikipedia.org/wiki/Currying)或[Partial](http://en.wikipedia.org/wiki/Currying#Contrast_with_partial_function_application)（这取决于函数是否需要两个以上的参数）。

实际上，您也可以使用ES5 规范中的[bind来做到这一点。](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Function/bind)例如：

```
function sum(a, b) {
    return a + b;
}

var sum5 = sum.bind(null, 5);

console.log(sum5(10)); // 15 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T20:27:12.920

如果您指的是内部函数从外部函数访问变量的能力，这称为闭包。

你可以在这里阅读闭包：
[JavaScript 闭包是如何工作的？](https://stackoverflow.com/questions/111102/how-do-javascript-closures-work)

# java - 优化 String += 还是 Concat？

> ID：15980157
> 
> 赞同：0
> 
> 时间：2013-04-12T20:18:15.563
> 
> 标签：java, android

我正在编写一个可能包含 1000 个数据点的文件。我有所有这些课程，目前正在最后写入所有数据（数据点以 1s 的间隔获取）。我目前正在做的事情写在下面，而且很慢。更改将字符串/字节写入文件的方式会更好吗？还是在应用程序运行时将此信息写入某个文件指针会更好？

顺便说一句，所有诸如此类的东西`getAccuracy()`都是浮点数/整数（因此它也必须转换它们）。

```
fileStr = "";
        fileStr += "timestamp,Accuracy,Altitude,Latitude,Longitude,GPSSatelliteEntries\r\n";
        for (Iterator<Entry> i = entries.iterator(); i.hasNext(); ) {
            Entry item = i.next();
            long ts = item.getTs();
            DataEntry d = item.getD();
            List<GPSSatelliteEntry> satellites = item.getG();

            // write stuff
            fileStr += ts + ",";
            fileStr += d.getAccuracy() + "," + d.getAltitude() + "," + d.getLatittude() + "," + d.getLongitude() + ",";
            fileStr += "[";
            boolean entered = false;
            for (Iterator<GPSSatelliteEntry> j = satellites.iterator(); j.hasNext(); ) {
                GPSSatelliteEntry item2 = j.next();
                entered = true;
                fileStr += "(" + item2.getAzimuth() + "," + item2.getElevation() + "," + item2.getPrn() + "," + item2.getSnr() + "),";
            }
            // chop off extra ,
            if (entered)
                fileStr = fileStr.substring(0, fileStr.length() - 1);
            fileStr += "]";
            fileStr += "\r\n";
        } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:20:36.790

每次您在使用 Strings 时，使用[`StringBuilder`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)或[`StringBuffer`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuffer.html)以获得更好的性能。

不要忘记它`String`是[**不可变**](http://javarevisited.blogspot.sk/2010/10/why-string-is-immutable-in-java.html)的，每次修改`String`都会创建新实例，并且会降低性能。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:19:47.110

最可能 [`string buffer`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuffer.html)

> 一个线程安全的、可变的字符序列。字符串缓冲区类似于字符串，但可以修改。

或者去[`string builder`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/StringBuilder.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:22:57.977

```
StringBuilder stuff = new StringBuilder();
stuff.append("PUT YOUR STRINGS HERE");
stuff.append("PUT YOUR STRINGS HERE"); 
```

然后你可以使用'stuff'来打印字符串。把它放在一个循环中，用一个计时器迭代一个大数字，看看它的优势，这很有趣。

# android - 布局权重参数在 setImageBitmap 后移除

> ID：15980159
> 
> 赞同：1
> 
> 时间：2013-04-12T20:18:18.047
> 
> 标签：android, imageview, android-linearlayout

我有一个奇怪的情况。我有一个相对简单的布局，有一些行和一个图像。

我的布局看起来像这样（高级绘图）：

![在此处输入图像描述](https://i.stack.imgur.com/eNhC4.png)

红色方块是 ImageView，其他是 LinearLayouts 和 TextViews。我的问题是，如果我使用 Java 代码 (setImageBitmap) 来更新红色 ImageView 的位图图像，那么 Text 3 的 LinearLayout 的权重似乎消失了，它的高度将等于 Text 3 的 TextView 的高度。

就像在这个模型上一样（绿色方块是新图像）：

![在此处输入图像描述](https://i.stack.imgur.com/ukNLs.png)

Text 3 的 LinearLayout 的 Weight 设置为 1，因此它的高度将强制 Text 4 的 LinearLayout 被推到屏幕底部。所以 Text 4 不会再在底部了，它会在 Text 3 的 LinearLayout 的底部之后立即跳转。

这是我的布局xml：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/MainLayout"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TextView
        android:id="@+id/textView6"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:text="Text 1" />

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:orientation="horizontal" >

        <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="wrap_content" >

            <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:layout_weight="1"
                android:orientation="vertical" >

                <TextView
                    android:id="@+id/text2text"
                    android:layout_width="wrap_content"
                    android:layout_height="wrap_content"
                    android:text="Text 2" />
            </LinearLayout>

            <ImageView
                android:id="@+id/Pic2"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:src="@drawable/timage" />

        </LinearLayout>

    </LinearLayout>

    <LinearLayout
        android:id="@+id/Text3Container"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:orientation="vertical" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:orientation="vertical" >

            <TextView
                android:id="@+id/TextView02"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Text 3" />
        </LinearLayout>

    </LinearLayout>

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="wrap_content" >

        <LinearLayout
            android:layout_width="wrap_content"
            android:layout_height="match_parent"
            android:layout_weight="1" >

            <TextView
                android:id="@+id/TextView03"
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:text="Text 4" />

        </LinearLayout>

    </LinearLayout>

</LinearLayout> 
```

看起来我使用了一些我不应该使用的线性布局，但它在实际布局中包含更多元素，我只是将它剥离了一点，以便在这里更简单地分析。但通常这是我的 xml。

你们有什么建议为什么会发生这种情况？我还尝试将图像放入 FrameLayout 中，同样...

谢谢！

# jquery - 单击链接时如何在模式中显示 webgrid

> ID：15980161
> 
> 赞同：1
> 
> 时间：2013-04-12T20:18:23.813
> 
> 标签：jquery, webmatrix, webgrid

我一直在利用 mikedotnetting 教程和示例。从这个 [链接](http://www.mikesdotnetting.com/Article/176/WebMatrix-and-jQuery-Forms-Part-2-Editing-Data)我正在构建一个 CRUD 应用程序。首先，用户搜索或过滤 webgrid。显示的结果有两个按钮，它们是模态窗口或对话框的链接。以下是 webgrid 的部分代码：

```
 grid.Column("", format: @<button class="edit-recipient" id="@item.ID">Edit</button>),
  ....
 grid.Column("", format: @<button class="view-recipient" id="@item.ID">View</button>) 
```

一旦用户单击编辑按钮，就会出现一个弹出窗口，并使用 getJSON 从 jquery 中填充值。

我的意图是让 View 按钮在 webgrid 中显示一个带有值的弹出窗口，因为这是与相关模式窗口中的外键 ID 的一对多关系。我无法使用 getJSON 中的对象来成功绑定 webgrid，因为 webgrid 需要模型。我必须将 ID 值传递给查询数据库并绑定到 webgrid 的方法。

我从[链接](http://www.mikesdotnetting.com/Article/176/WebMatrix-and-jQuery-Forms-Part-2-Editing-Data)中添加的内容是 View 按钮，它只能显示 webgrid 和搜索功能。

我可以发布整个代码，但我提供的链接包含大部分代码。

# c# - 使用 QuickBooks API 时出现 400 错误

> ID：15980164
> 
> 赞同：1
> 
> 时间：2013-04-12T20:18:36.033
> 
> 标签：c#, quickbooks

我将从这篇文章中接受的答案：[将 ASP.NET 应用程序连接到 QuickBooks 在线版](https://stackoverflow.com/questions/1093030/connecting-an-asp-net-application-to-quickbooks-online-edition)

通过 C# 建立连接时出现 400 错误。我读过这可能是因为 XML 错误。这是我的 XML：

```
<?xml version="1.0"?>
<?qbxml version="6.0"?>
<QBXML>
    <SignonMsgsRq>
        <SignonDesktopRq>
            <ClientDateTime>2013-04-12T15:54:18</ClientDateTime>
            <ApplicationLogin>MY APP LOGIN</ApplicationLogin>
            <ConnectionTicket>MY CONNECTION TICKET</ConnectionTicket>
            <Language>English</Language>
            <AppID>MY APP ID</AppID>
            <AppVer>1</AppVer>
        </SignonDesktopRq>
    </SignonMsgsRq>
</QBXML> 
```

我没有看到 XML 有任何问题。是的，我正在替换我的实际 applicationLogin、ConnectionTicket 和 AppID。我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T22:12:27.323

我发现了问题，我没有在 QB 门户中正确设置应用程序。我用正确的设置重新创建了它，这解决了我的问题。

# javascript-framework - 使用 Backbone.js 缓存网页

> ID：15980169
> 
> 赞同：0
> 
> 时间：2013-04-12T20:18:48.330
> 
> 标签：javascript-framework

骨干网可以使用本地存储缓存网页（类似于 appcache）吗？我知道主干可以缓存集合，但我想存储整个页面。我还希望能够在线更新内容。我查看了各种帖子，但它们仅指缓存集合，而不是整个网页。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:38:23.887

您可以使用 localstorage 存储任何字符串，但最大大小可能因浏览器而异。

像这样的东西可以工作： localStorage.setItem('page_name', $('body').html());

# asp.net - 在 ASP.net 中开始下载后如何重新启用 UI

> ID：15980174
> 
> 赞同：1
> 
> 时间：2013-04-12T20:19:08.893
> 
> 标签：asp.net, excel, user-interface, download

我正在通过 ASP.net 实现导出到 excel 的功能。我在页面上有一个按钮控件。当我单击按钮时，控件转到按钮的单击事件。在那里我调用存储过程来获取excel数据。在单击事件（代码隐藏）中，我有以下代码来下载 Excel 文件中的数据。

```
Response.Clear()
Response.AddHeader("content-disposition", String.Format("attachment;filename={0}.csv", "Report"))
Response.Charset = ""
Response.ContentType = "application/vnd.xls"
Response.Write("a,b,c") - sample output from SP.
Response.Flush(); 
```

所有这些工作正常。问题是 - 有时该过程需要很长时间才能执行，所以为了避免用户在下载开始之前弄乱 UI，我有一个 JavaScript 代码来在单击下载按钮时禁用 UI。这也工作正常。但我无法调用任何 javascript 代码来重新启用 UI，一旦下载开始或就在下载开始之前。当我尝试在 response.clear（在上面的代码中）之前呈现脚本并给出 response.flush 时，它给了我一个错误，即一旦将响应头发送到客户端，我就无法更改它。我怎样才能实现这个功能？

**问题摘要？** 我想从用户单击下载按钮到实际下载开始时禁用 UI。下载开始后，我想重新启用 UI。我怎样才能做到这一点。

谢谢。

# php - 查询我的数据库以仅显示来自 Joomla mod_XpertScroller 的特定类别列表

> ID：15980176
> 
> 赞同：0
> 
> 时间：2013-04-12T20:19:15.553
> 
> 标签：php, database, joomla

我在 Brandroot(.)com 上有一个 Joomla 网站。在主页上，您可以在中间看到两个不同的滑块，一个是**特色品牌名称**，另一个是**最近添加的品牌名称**。

如果您转到**品牌**页面，您将在正确的站点上看到一个类别特定页面的列表，其中显示了在后端添加到该类别的域名。

我需要的是创建一个滑块，就像主页上的滑块一样，它只显示类别中的域，**4 Letter**。

我已经完成了允许您为滑块选择 4 个字母选项的基本代码：

![在此处输入图像描述](https://i.stack.imgur.com/MxIWd.png)

这是`switch`控制滑块选项的代码：

```
switch($filtering){
    case 1://Recently Added
        $query->where('a.sold = 0');
        break;
    case 2://Recently Sold
        $query->where('a.sold = 1');
        break;
    case 3://Featured Top
        $query->where('a.featured = 1');
        $query->where('a.sold = 0');
        break;
    case 4://4 Letter Domains
        /*
        $query->where('a.featured = 1');
        $query->where('a.sold = 0');
        */
        break;
    default:
        break;
} 
```

我需要帮助来弄清楚需要在`case 4:`.

这是我认为正在处理选项过滤的数据库查询代码：

```
function &getList(&$params){
    $db = & JFactory::getDBO();
    $filtering = $params->get('filtering');

    $query = $db->getQuery(true);
    $query->select('a.*');
    $query->from('#__brands as a');
    $query->where('a.state = 1'); 
```

这是正在访问的表的快照。

![在此处输入图像描述](https://i.stack.imgur.com/QDdt9.png)

我不知道要写什么来过滤`4 letter`类别。请耐心帮助我，因为我自己正在尝试这样做以省钱。请让我知道是否需要其他任何东西来帮助您解决此问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T23:31:09.417

如果域存储在 中`title`，这将执行此操作：

```
case 4: //4 Letter Domains
    $query->where('CHAR_LENGTH(a.title) = 4');
    break; 
```

# xna - 如何让用户在给定空间（50x50）中绘制（如 MS Paint）图片并将该图片保存为纹理 2D？XNA

> ID：15980179
> 
> 赞同：0
> 
> 时间：2013-04-12T20:19:43.917
> 
> 标签：xna, drawing, texture2d

我正在考虑在其某处（位图？）制作一个具有 50x50 空间的 Windows 窗体，并让用户在正方形内绘制（如 MS Paint）。用户完成后，可以通过单击“保存”按钮保存图片，并将在 Game1 中更新（用于我的游戏的碰撞目的）。我在这里看到了一些关于如何在屏幕上绘制的教程，如 MS Paint，但我似乎无法弄清楚如何将该图片保存为 Texture2D/Rectangle。以及如何将位图放到 Windows 窗体上？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:36:54.110

要将位图保存为 png：

```
private void SaveBmpAsPNG(Bitmap bm)
{
    bm.Save(@"c:\button.png", ImageFormat.Png);
} 
```

要将 texture2d 写入文件：

```
using (Stream stream = File.OpenWrite("picture.png"))
{
    texture.SaveAsPng(stream, texture.Width, texture.Height);
} 
```

要将 .png 读入 texture2d：

```
using(Stream stream = File.OpenRead("picture.png"))
{
   texture = Texture2D.FromStream(GraphicsDevice, stream);
} 
```

# c# - 递归寻路问题

> ID：15980187
> 
> 赞同：0
> 
> 时间：2013-04-12T20:19:57.150
> 
> 标签：c#, exception, recursion, path-finding

我正在编写一个寻路算法，我需要一些帮助来弄清楚如何通过在创建异常情况时避免递归继续来加快它的速度。

我有 1 个矩阵（空格 = 墙壁；散列 = 块；2 = 实际位置）“2”需要收集所有“#”，每次他走到“#”时它都会消失。

我自愿产生了一个不可能的解释我的问题。

```
{  ,  ,  ,  ,  ,  ,  ,   };
{  , #, #, #, #, #, #,   };
{  , #,  ,  ,  ,  , #,   };
{  , #,  , #, #,  , #,   };
{  , #,  , #, #,  , #,   };
{  , #,  , #, #,  , #,   };
{  , #,  , #, #,  , #,   };
{  , #,  ,  ,  ,  , #,   };
{  , #, #, #, 2, #, #,   };
{  ,  ,  ,  ,  ,  ,  ,   }; 
```

如您所见，地图中间有一个无法到达的岛屿。

如果你们知道如何检测这种情况，我想知道。我想不出任何办法。

这是我的实际代码：

检查一些异常情况并返回 true 或 false ：

```
static bool BreakCaseFound() {
    int EndCases = 0;   // 3 blocs with 3 empty slots around
    bool BreakCases = false;    // 1 bloc with 4 empty slots around
    int temp = 0;
    for(int i = 1; i<17; i++) {
        for(int j = 1; j<17; j++) {
            if(matrice[j, i] == bloc) {
                if (matrice[j+1, i] == empty) {
                    temp++;
                }
                if (matrice[j-1, i] == empty) {
                    temp++;
                }
                if (matrice[j, i+1] == empty) {
                    temp++;
                }
                if (matrice[j, i-1] == empty) {
                    temp++;
                }
            }
            switch(temp) {
                case 3:
                    EndCases++;
                    temp = 0;
                    break;
                case 4:
                    temp = 0;
                    BreakCases = true;
                    break;
                default:
                    temp = 0;
                    break;
            }

            if(BreakCases || EndCases >= 3) {
                return true;
            }
        }
    }
    return false;
} 
```

我的显示功能（MS-DOS 窗口）

```
static void show() {
    Console.Clear();
    for(int i =0; i<18; i++) {
        for(int j = 0; j<18; j++) {
            if(matrice[j,i] == empty) {
                Console.Write(" ");
            }
            else {
                if (matrice[j, i] == 2) { matrice[j, i] = bloc ; }
                if (matrice[j, i] == 3) { matrice[j, i] = 5 ; }
                Console.Write(matrice[j, i]);
            }
        }
        Console.Write("\n");
    }
} 
```

我的算法：

```
static dynamic move(int actualPosCol, int actualPosLigne, List<int[]> path, List<int[]> RealPath)
{
    matrice[path[path.Count()-1][0], path[path.Count()-1][1]] = 5;
    show();
    if(nbBlocs > 0) {
        show();

        //Left move
        if( (matrice[path[path.Count() - 1][0]-1, path[path.Count() - 1][1]] == bloc)
        && (!BreakCaseFound()) ) { 
            nbBlocs--;
            matrice[actualPosCol, actualPosLigne] = empty;
            int[] posNext = new int[2] {actualPosCol-1, actualPosLigne};
            path.Add(posNext);
            move(actualPosCol-1, actualPosLigne, path, RealPath);
        }
        //Right move
        if( (matrice[path[path.Count() - 1][0]+1, path[path.Count() - 1][1]] == bloc)
        && (!BreakCaseFound()) ) { 
            nbBlocs--;
            matrice[actualPosCol, actualPosLigne] = empty;
            int[] posNext = new int[2] {actualPosCol+1, actualPosLigne};
            path.Add(posNext);
            move(actualPosCol+1, actualPosLigne, path, RealPath);

        }

        //Down move
        if ( (matrice[path[path.Count() - 1][0], path[path.Count() - 1][1]+1] == bloc)
        && (!BreakCaseFound()) ) { 
            nbBlocs--;
            matrice[actualPosCol, actualPosLigne] = empty;
            int[] posNext = new int[2] {actualPosCol, actualPosLigne+1};
            path.Add(posNext);
            move(actualPosCol, actualPosLigne+1, path, RealPath);
        }
        //Up move
        if ( (matrice[path[path.Count() - 1][0], path[path.Count() - 1][1]-1] == bloc)
        && (!BreakCaseFound()) ) { 
            nbBlocs--;
            matrice[actualPosCol, actualPosLigne] = empty;
            int[] posNext = new int[2] {actualPosCol, actualPosLigne-1};
            path.Add(posNext);
            move(actualPosCol, actualPosLigne-1, path, RealPath);
        }

        if(nbBlocs > 0) {
            //Can't move right, left, up or down
            matrice[path[path.Count() - 1][0], path[path.Count() - 1][1]] = 3;
            show();
            path.Remove(path.Last());   //remove last move from the List
            nbBlocs++;
        }

        return path;
    }
    else {  //No more blocs, path found.
        foreach(int[] way in path) {
            if(!RealPath.Contains(way)) {
                RealPath.Add(way);
            }
        }
        return path;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T02:35:12.320

也许我疯了，但每次我看到涉及断开连接的连续区域的问题时，我都会认为是[不相交的集合](http://community.topcoder.com/tc?module=Static&d1=tutorials&d2=disjointDataStructure)。不相交集是为非常有效的合并而设计的集，如果您试图找出# 的许多区域是否连接，则合并是您经常要做的事情。

将地图上的每个位置放入其自己的不相交集合中。任何包含位置的集合最终都将包含您可以从中移动到的所有位置。如何？我们在地图上四处走动，任何时候我们可以从一个地方移动到另一个地方，我们都会合并集合。

您应该按什么顺序执行这些步骤？从某个地方填满你的整个地图——做一个填满，从每个位置到你不只是来自的任何邻居。如果 X 与 Y 在同一个集合中，则从 X 点到 Y 点的洪水填充应该什么都不做，否则，如果可以在它们之间移动，则应该合并 X 和 Y 的集合。如果 Y 之前从未访问过，则从 Y 递归。

对于地图中的 n 个位置，该解决方案将运行大约 O(n inverse-ackermann(n))。

# windows - Sox --multi-thread 选项：将立体声 wav 文件拆分为 2 个单声道文件 Windows Line 命令

> ID：15980193
> 
> 赞同：2
> 
> 时间：2013-04-12T20:20:16.190
> 
> 标签：windows, command-line, sox

我在 Windows 命令行中编写了一个批处理程序来获取立体声 wav 文件并使用 sox v.14.4.0 音频程序将左右声道拆分为单独的 FLAC 文件。像这样。。

```
for /r %%n in (*.wav) do (
 C:\sox\sox.exe %%n -c 1 %%n.left.flac remix 1
 C:\sox\sox.exe %%n -c 2 %%n.right.flac remix 2) 
```

但是，这比我想要的要长一点。我对此进行了更多研究，看来我可以使用 SOX_OPTS 和 --multi-thread 选项以及 --buffer 以同时执行两个 sox 操作。

Sox 文档说明了这一点：

SOX_OPTS 环境变量可用于为 SoX 的全局选项提供替代默认值。例如：

```
SOX_OPTS="−−buffer 20000 −−play−rate−arg −hs −−temp /mnt/temp" 
```

请注意，设置环境变量的方式因系统而异。以下是一些示例： MS-DOS/MS-Windows：

```
set SOX_OPTS=−V −−no-clobber −−buffer BYTES, −−input−buffer BYTES 
```

设置用于处理音频的缓冲区的大小（默认为 8192）。
−−buffer适用于输入、效果和输出处理；
−−input−buffer 仅适用于输入处理（如果两者都给定，它将覆盖−−buffer）。
请注意，−−buffer 的较大值将导致 SoX 响应终止或跳过当前输入文件的请求变得缓慢。

两个问题。

1.  是否可以使用 --multi-thread 如上所述或其他方式同时将 1 个输入文件拆分为 2 个输出文件？
2.  如果是这样，怎么做？（注意：我无法找出正确的语法来从上面的文档中获取 SOX_OPTS 以自行处理，不要介意在批处理文件中）

另外：我发现了一些与此类似的其他 stackoverflow 问题，但总是使用 java、php、linux 等。不幸的是，我对这些程序一无所知。请同情我的编程无知。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:56:38.890

没有比我更喜欢你的 SoX 更熟悉的想法......

但是，我会试试这个：

作为测试，使用单个 .wav 文件

```
for /r %%n in (justone.wav) do (
 START "Left" C:\sox\sox.exe %%n -c 1 %%n.left.flac remix 1
 START "Right" C:\sox\sox.exe %%n -c 2 %%n.right.flac remix 2) 
```

也许它会在多处理器机器上同时运行两个实例。（窗口标题为“左”或“右”）

现在-如果可行，请尝试

```
@ECHO OFF
SETLOCAL
for /r %%n in (*.wav) do CALL :runsox "%%n"
GOTO :eof

:runsox
CALL :wait
START "%~1.left" C:\sox\sox.exe %~1 -c 1 %~1.left.flac remix 1
CALL :wait
START "%~1.right" C:\sox\sox.exe %~1 -c 2 %~1.right.flac remix 2
GOTO :eof

:wait
FOR /f %%c IN ('tasklist^|find /i /c "sox.exe"') DO SET running=%%c
IF %running% GEQ 6 timeout /t 5 >nul&GOTO wait
GOTO :eof 
```

这将执行`:runsox`每个`.wav`遇到的过程，传递 .wav 名称。

该`runsox`过程将调用该`wait`过程 - 我会谈到。完成`WAIT`后，它将放在左边的 sox 上，然后再次等待并放在右边，然后返回下一个文件名，直到一切都完成。名称中的`%~1`表示“给这个例程的第一个参数，减去任何封闭的引号”——这就是 CALL 提供的文件名 (%%n)。

该`wait`过程通过`SOX.EXE`从过滤器传递任务列表来找出正在运行的实例数量，以查找字符串意味着不考虑大小写，并意味着输出计数。`tasklist``find``sox.exe` `/i``/c`

`Running`因此获取`SOX`正在进行的实例的计数。如果大于或等于 6（任意数字 - 选择适合自己的值。最好留一或两个处理器用于其他任务，因此 6 id 适合 8 处理器机器）然后执行 5 秒的超时5 秒后再次检查任务列表。当实例少于 6 个时，`wait`程序退出并开始下一个任务。

所以 - 该`WAIT`过程一直等到少于 6 个 SOX 实例。

更改 6 以适合您的机器和 5 您的审美。

编辑：删除旧的右括号

# linux - 计划的磁盘扫描

> ID：15980195
> 
> 赞同：0
> 
> 时间：2013-04-12T20:20:19.553
> 
> 标签：linux, unix, cron

我有一个写入文件然后将该文件转储到数据库的脚本。我需要这个任务尽可能频繁地运行，但不要同时运行多个实例（或者它会将多余的东西写入同一个文件）。

我目前的做法是在我正在检查文件是否存在的 shell 脚本中，如果存在，我退出脚本。在每个脚本结束时，它会删除该文件。

这在 95% 的时间里都有效。但是，如果服务器重新启动（这种情况经常发生），正在写入的文件将保留，并且每次调用该脚本时它都会退出，因为该文件已经存在。

解决这个问题的好方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:29:02.110

您可以检查是否有任何进程正在使用带有“fuser”的文件。它将返回使用该文件的任何程序的 PID。如果没有 PIDS，您可以安全地擦除它并重新开始。

# python - 更紧凑的 ElementTree 或 lxml 命名空间

> ID：15980196
> 
> 赞同：5
> 
> 时间：2013-04-12T20:20:19.980
> 
> 标签：python, xml, lxml, elementtree

当子元素与父元素位于不同的命名空间时，我试图在 ElementTree 或 lxml 中获得命名空间的紧凑表示。这是基本示例：

```
from lxml import etree

country = etree.Element("country")

name = etree.SubElement(country, "{urn:test}name")
name.text = "Canada"
population = etree.SubElement(country, "{urn:test}population")
population.text = "34M"
etree.register_namespace('tst', 'urn:test')

print( etree.tostring(country, pretty_print=True) ) 
```

我也尝试过这种方法：

```
ns = {"test" : "urn:test"}

country = etree.Element("country", nsmap=ns)

name = etree.SubElement(country, "{test}name")
name.text = "Canada"
population = etree.SubElement(country, "{test}population")
population.text = "34M"

print( etree.tostring(country, pretty_print=True) ) 
```

在这两种情况下，我都会得到这样的结果：

```
<country>
    <ns0:name xmlns:ns0="urn:test">Canada</ns0:name>
    <ns1:population xmlns:ns1="urn:test">34M</ns1:population>
</country> 
```

虽然这是正确的，但我希望它不那么冗长 - 这可能成为大型数据集的一个真正问题（特别是因为我使用的 NS 比“urn:test”大得多）。

如果我对“国家”在“urn:test”命名空间内感到满意并像这样声明它（在上面的第一个示例中）：

```
country = etree.Element("{test}country") 
```

然后我得到以下输出：

```
<ns0:country xmlns:ns0="urn:test">
    <ns0:name>Canada</ns0:name>
    <ns0:population>34M</ns0:population>
</ns0:country> 
```

但我真正想要的是：

```
<country xmlns:ns0="urn:test">
    <ns0:name>Canada</ns0:name>
    <ns0:population>34M</ns0:population>
<country> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T13:21:41.577

1.  元素的全名包含 of `{namespace-url}elementName`，而不是`{prefix}elementName`

    ```
    >>> from lxml import etree as ET
    >>> r = ET.Element('root', nsmap={'tst': 'urn:test'})
    >>> ET.SubElement(r, "{urn:test}child")
    <Element {urn:test}child at 0x2592a80>
    >>> ET.tostring(r)
    '<root xmlns:tst="urn:test"><tst:child/></root>' 
    ```

2.  在您的情况下，如果您更新默认命名空间，则可能会更紧凑。不幸的是，`lxml`似乎不允许空的 XML 命名空间，但是您说，您可以将父标签与子元素放在同一命名空间中，因此您可以将默认命名空间设置为子元素的命名空间：

    ```
    >>> r = ET.Element('{urn:test}root', nsmap={None: 'urn:test'})
    >>> ET.SubElement(r, "{urn:test}child")
    <Element {urn:test}child at 0x2592b20>
    >>> ET.SubElement(r, "{urn:test}child")
    <Element {urn:test}child at 0x25928f0>
    >>> ET.tostring(r)
    '<root xmlns="urn:test"><child/><child/></root>' 
    ```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-21T13:37:01.130

```
from xml.etree import cElementTree as ET
##ET.register_namespace('tst', 'urn:test')
country = ET.Element("country")
name = ET.SubElement(country, "{urn:test}name")
name.text = "Canada"
population = ET.SubElement(country, "{urn:test}population")
population.text = "34M"
print prettify(country) 
```

上面将给出（不注册任何命名空间）：

```
<?xml version="1.0" ?>
<country xmlns:ns0="urn:test">
  <ns0:name>Canada</ns0:name>
  <ns0:population>34M</ns0:population>
</country> 
```

而且，当我删除评论部分时，它将给出::

```
<?xml version="1.0" ?>
<country xmlns:tst="urn:test">
  <tst:name>Canada</tst:name>
  <tst:population>34M</tst:population>
</country> 
```

注意：`prettify`函数在[这里](http://pymotw.com/2/xml/etree/ElementTree/create.html#pretty-printing-xml)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-18T23:37:02.120

这段代码：

```
from lxml import etree

ns = {"ns0" : "urn:test"}
country = etree.Element("country", nsmap=ns)

name = etree.SubElement(country, "{urn:test}name")
name.text = "Canada"

population = etree.SubElement(country, "{urn:test}population")
population.text = "34M"

print(etree.tostring(country, pretty_print=True)) 
```

似乎提供了所需的输出：

```
<country xmlns:ns0="urn:test">
  <ns0:name>Canada</ns0:name>
  <ns0:population>34M</ns0:population>
</country> 
```

但你仍然需要维护`nsmap`自己。

# wpf - 更改其外部属性内部的用户控件

> ID：15980197
> 
> 赞同：0
> 
> 时间：2013-04-12T20:20:20.757
> 
> 标签：wpf, xaml, user-controls

我有一个带有 Ellipse 和 TextBlock 的简单用户控件

我想像这样从外部更改用户控件内的 TextBlock.Text 属性

我没有找到任何简单的解释或方法来做到这一点

如果有什么我想知道的

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:24:13.933

将其作为属性公开：

```
public partial class MyUserControl : UserControl
{
    public string Text
    {
        get { return MyTextBox.Text; }
        set { MyTextBox.Text = value; }
    }
} 
```

如果你想通过绑定来设置它，那么你需要创建一个依赖属性，但如果你只是使用文字和/或代码隐藏，那么上面的就可以了。

# c - 格式化输出 - 相同的数据到 C 中的多个文本文件

> ID：15980199
> 
> 赞同：1
> 
> 时间：2013-04-12T20:20:30.747
> 
> 标签：c, text, file-io, formatted-text

我正在工作的程序生成数据，我使用 fprintf_s() 函数将其输出到文本文件。

由于某些原因，我需要将“相同”数据打印到不同的文本文件（具有不同的名称），所以我想知道是否可以通过仅调用一次 fprintf_s() 或者可能是其他一些方法或函数来完成它们。

为了澄清我的问题，我提供了一个愚蠢的例子：

```
number = 100; FILE fp1, fp2,

fopen_s(&fp1,"file01.txt","w"); fopen_s(&fp2,"file02.txt","w");

//Instead of doing this

fprintf_s(fp1,"I want to print this number = %d\n", number); 

fprintf_s(fp2,"I want to print this number = %d\n", number);

// Can I do something like this... 

fprintf_s(fp1,fp2,"I want to print this number = %d\n", number);

// I know the above line doesn't work. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:26:29.390

所以你想重构，嘿？

```
int multi_printf_s(FILE **fs, size_t n, const char *fmt, ...)
{
    va_list argz;
    int ret;

    for (size_t i = 0; i < n; i++) {
        va_start(argz, fmt);
        ret = vfprintf_s(fs[i], fmt, argz);
        va_end(argz);
    }

    return ret;
} 
```

来电：

```
FILE *f1 = fopen(...); // whatever
FILE *f2 = fopen(...);
FILE *f3 = fopen(...);
FILE *f4 = fopen(...);

FILE *fs[] = { f1, f2, f3, f4 };
multi_printf_s(fs, sizeof(fs) / sizeof(fs[0]), "Print this: %d\n", 42);

// don't forget to fclose()! 
```

# c++ - 使用 sfml 1.6 在 c++ 中使用 AABB 碰撞的平台游戏

> ID：15980208
> 
> 赞同：1
> 
> 时间：2013-04-12T20:20:52.373
> 
> 标签：c++, sfml

我正在使用平铺映射，并让我的地图类通过使用精灵数组来绘制地图。我用它来设置精灵的位置，然后在它周围创建一个边界框数组，然后绘制精灵。

然后我有一个碰撞类，它获取玩家边界框并将其与精灵的每个边界框进行比较。我有一个名为 platformboundingBox 的数组。这将每个精灵的每个边界框存储在数组中。但是，当我比较这些值时，似乎平台边界框在任何位置都没有值，但我已经检查了每个精灵的值是否进入边界框数组。

这是我的地图课。看看drawmap和collision函数看看。如果有人可以提供帮助，我将不胜感激。

```
#include "Map.h"
#include "Block.h"
#include <sstream>
using namespace std;
Map::Map()
{
    //map ctor;
}

Map::~Map()
{
    // map dtor
}

void Map::Initialise(const char *filename)
{

    if(!BlockImage.LoadFromFile("Images/block.png"))
        cout<<endl<<"failed to load block image"<<endl;
    if(!GemImage.LoadFromFile("Images/Gem.png"))
        cout<<endl<<"failed to load Gem Image"<<endl;
    if(!leftBlockImage.LoadFromFile("Images/blockLeft.png"))
        cout<<endl<<"failed to load left block Image"<<endl;
    if(!rightBlockImage.LoadFromFile("Images/blockRight.png"))
        cout<<endl<<"failed to load right block Image"<<endl;
    std::ifstream openfile(filename);
    std::vector <int>  tempvector;
    std::string line;

    while(std::getline(openfile, line))

    {

        for(int i =0; i < line.length(); i++)
        {
            if(line[i] != ' ') // if the value is not a space
            {
                char value = line[i];
                tempvector.push_back(value - '0');
            }

        }
            mapVector.push_back(tempvector); // push back the value of the temp vector into the map vector
            tempvector.clear(); // clear the temp vector readt for the next value
    }

}

    void Map::DrawMap(sf::RenderWindow &Window)
            {
                Player playermap;

                    for(i = 0; i < mapVector.size(); i++)
                {
                    for(j = 0; j < mapVector[i].size(); j++)
                    {
                          if(mapVector[i][j] == 1)
                         {
                            sprite[j].SetImage(BlockImage);
                            sprite[j].SetPosition(j * BLOCKSIZE, i * BLOCKSIZE);
                            platformBoundingBox[j].Bottom = sprite[j].GetPosition().y;
                            platformBoundingBox[j].Left = sprite[j].GetPosition().x - 5;
                            platformBoundingBox[j].Right = sprite[j].GetPosition().x;
                            Window.Draw(sprite[j]);

                         }
                          else if(mapVector[i][j] == 2)
                          {
                              sprite[j].SetImage(GemImage);
                              sprite[j].SetPosition(j * BLOCKSIZE, i * BLOCKSIZE);
                              platformBoundingBox[j].Top = sprite[j].GetPosition().y - 5;
                              platformBoundingBox[j].Bottom = sprite[j].GetPosition().y;
                              platformBoundingBox[j].Left = sprite[j].GetPosition().x - 5;
                              platformBoundingBox[j].Right = sprite[j].GetPosition().x;
                              Window.Draw(sprite[j]);
                          }
                          else if(mapVector[i][j] == 3)
                          {
                              sprite[j].SetImage(leftBlockImage);
                              sprite[j].SetPosition(j * BLOCKSIZE, i * BLOCKSIZE);
                              platformBoundingBox[j].Top = sprite[i].GetPosition().y - 5;
                              platformBoundingBox[j].Bottom = sprite[i].GetPosition().y;
                              platformBoundingBox[j].Left = sprite[i].GetPosition().x - 5;
                              platformBoundingBox[j].Right = sprite[i].GetPosition().x;
                              Window.Draw(sprite[j]);
                          }
                          else if(mapVector[i][j] == 4)
                          {
                              sprite[j].SetImage(rightBlockImage);
                              sprite[j].SetPosition(j * BLOCKSIZE, i * BLOCKSIZE);
                              platformBoundingBox[j].Top = sprite[i].GetPosition().y - 5;
                              platformBoundingBox[j].Bottom = sprite[i].GetPosition().y;
                              platformBoundingBox[j].Left = sprite[i].GetPosition().x - 5;
                              platformBoundingBox[j].Right = sprite[i].GetPosition().x;
                              Window.Draw(sprite[j]);
                          }
                    }
                }
            }

    void Map::collisions(float x, float y)
    {
        Player playermap;
        this->x = x;
        this->y = y;                
        playerboundingbox.Top = y - 5;
        playerboundingbox.Bottom = y ;
        playerboundingbox.Left = x - 5;
        playerboundingbox.Right = x;
        for(i = 0; i < 100; i++)
        {
            if(playerboundingbox.Intersects(platformBoundingBox[i]))
                cout << " praise the lord";     
        }

    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T14:04:15.243

请切换到 SFML 2，因为 1.6 有很多错误。

假设您创建了一个名为**handler**的类，您将在其中放置：

```
handler::handler()
    // window initialization
    Map Map; // here initialize the Map class
    /* why don't use Map::Map( ctor) for initialization? */
    // player initialization
    // run the program as long as the window is open
    while (window.isOpen())
    {
        // check all the window's events that were triggered since the last iteration of the loop
        sf::Event event;
        while (window.pollEvent(event))
        {
            // "close requested" event: we close the window
            if (event.type == sf::Event::Closed)
            window.close();
        }
        window.clear();
        //draw player
        Map.DrawMap(); // also need to improve the drawing for less lag
        window.display();

        update(Map &Map, Player &Player);
        // every time to use & because without the compiler will create another object
    }
}   

update(Map &Map, Player &Player)
{
    // verify if exists some interacts
    if (intersects(Map &Map, Player &Player))
    {
        //verify from where and put to the correct position
        /* e.g: if we have a collide with a down tile map will say something like this:
        Player.setPosition(Player.getPosition().x, (Player.getGlobalBounds().top+Player.getGlobalBounds().height)-(Map.getGlobalBounds().top-(Player.getGlobalBounds().top+Player.getGlobalBounds().height)); */
    }
}

intersects(Map &Map, Player &Player)
{
    sf::FloatRect fPlayer = Player.getGlobalBounds();
    for (int i=0; i<Map.NrOfYourTiles; ++i)
    {
        sf::FloatRect fMap = YourTile.getGlobalBounds();
        if (fPlayer.intersects(fMap))
            return 1;
    }
    return 0;
} 
```

希望这会对您有所帮助（代码在 SFML 2.0 中）。您可以在创建者 sfml-dev.org 的论坛上找到更多帮助。

# entity-framework - 实体框架 MigrateDatabaseToLatestVersion 给出错误

> ID：15980209
> 
> 赞同：4
> 
> 时间：2013-04-12T20:20:54.670
> 
> 标签：entity-framework, entity-framework-5

我正在尝试在我的网站上使用基于实体框架代码的迁移。我目前有一个包含多个项目的解决方案。有一个我想初始化数据库的 Web API 项目和另一个名为 DataLayer 项目的项目。我已经在 DataLayer 项目中启用了迁移并创建了一个初始迁移，如果它不存在，我希望将其用于创建数据库。

这是我启用迁移时得到的配置

```
public sealed class Configuration : DbMigrationsConfiguration<Harris.ResidentPortal.DataLayer.ResidentPortalContext>
{
    public Configuration()
    {
        AutomaticMigrationsEnabled = false;
    }

    protected override void Seed(Harris.ResidentPortal.DataLayer.ResidentPortalContext context)
    {
        //  This method will be called after migrating to the latest version.

        //  You can use the DbSet<T>.AddOrUpdate() helper extension method 
        //  to avoid creating duplicate seed data. E.g.
        //
        //    context.People.AddOrUpdate(
        //      p => p.FullName,
        //      new Person { FullName = "Andrew Peters" },
        //      new Person { FullName = "Brice Lambson" },
        //      new Person { FullName = "Rowan Miller" }
        //    );
        //
    }
} 
```

在创建它之后我对其所做的唯一更改是将其从内部更改为公共，以便 WebAPI 可以看到它并在它的数据库初始化程序中使用它。下面是我用来尝试初始化数据库的 Application_Start 中的代码中的代码

```
Database.SetInitializer(new MigrateDatabaseToLatestVersion<ResidentPortalContext, Configuration>());
new ResidentPortalUnitOfWork().Context.Users.ToList(); 
```

如果我不管数据库是否存在都运行它，我会收到以下错误

> 文件“C:\Users\Dave\Documents\Visual Studio 2012\Projects\ResidentPortal\Harris.ResidentPortal.WebApi\App_Data\Harris.ResidentPortal.DataLayer.ResidentPortalContext.mdf”的目录查找失败，出现操作系统错误 2（系统找不到指定的文件。）。
> 
> 创建数据库失败。无法创建列出的某些文件名。检查相关错误。

似乎它正在为数据库寻找完全错误的位置。这似乎与我初始化数据库的这种特殊方式有关，因为如果我将代码更改为以下内容。

```
Database.SetInitializer(new DropCreateDatabaseAlways<ResidentPortalContext>());
new ResidentPortalUnitOfWork().Context.Users.ToList(); 
```

数据库将在需要的地方正确创建。

我不知道是什么原因造成的。可能是我需要在配置类中添加其他内容，还是与我的所有迁移信息都在 DataLayer 项目中但我从 WebAPI 项目中调用它的事实有关？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-16T20:19:51.790

我已经想出了如何为这个过程创建一个动态连接字符串。您需要先将此行添加到 Web 或 App.Config 上的 EntityFramework 条目中，而不是默认放置在那里的行。

```
<defaultConnectionFactory type="<Namespace>.<ConnectionStringFacotry>, <Assembly>"/> 
```

这告诉程序您有自己的工厂，该工厂将返回 DbConnection。下面是我用来制作自己的工厂的代码。部分原因是由于一群程序员在同一组代码上工作，但我们中的一些人使用 SQL Express，而另一些人使用成熟的 SQL Server。但这会给你一个例子来满足你的需要。

```
public sealed class ResidentPortalConnectionStringFactory: IDbConnectionFactory 
{
    public DbConnection CreateConnection(string nameOrConnectionString)
    {
        SqlConnectionStringBuilder builder = new SqlConnectionStringBuilder(ConfigurationManager.ConnectionStrings["PortalDatabase"].ConnectionString);

        //save off the original catalog
        string originalCatalog = builder.InitialCatalog;

        //we're going to connect to the master db in case the database doesn't exist yet
        builder.InitialCatalog = "master";
        string masterConnectionString = builder.ToString();

        //attempt to connect to the master db on the source specified in the config file
        using (SqlConnection conn = new SqlConnection(masterConnectionString))
        {
            try
            {
                conn.Open();
            }
            catch
            {
                //if we can't connect, then append on \SQLEXPRESS to the data source
                builder.DataSource = builder.DataSource + "\\SQLEXPRESS";
            }
            finally
            {
                conn.Close();
            }
        }

        //set the connection string back to the original database instead of the master db
        builder.InitialCatalog = originalCatalog;

        DbConnection temp = SqlClientFactory.Instance.CreateConnection();
        temp.ConnectionString = builder.ToString();

        return temp;
    }
} 
```

一旦我这样做了，我就可以在我的 Global.asax 中毫无问题地运行此代码

```
Database.SetInitializer(new MigrateDatabaseToLatestVersion<ResidentPortalContext, Configuration>());
using (ResidentPortalUnitOfWork temp = new ResidentPortalUnitOfWork())
{
    temp.Context.Database.Initialize(true);
} 
```

# jquery - 不在循环中时提示循环

> ID：15980212
> 
> 赞同：0
> 
> 时间：2013-04-12T20:21:17.987
> 
> 标签：jquery

我最近开始学习 jQuery，只是搞砸了我决定做一个 RTE 然而，我注意到当我去输入一个超链接时，它在超链接已经插入后会提示几次，并且似乎每次你都会增加单击超链接按钮。

```
 $('#hyperlink').mouseover(function(){
        $('#hyperlink').css('color','#000000')
        $('#hyperlink').mouseout(function(){
            $('#hyperlink').css('color','#999999')
        });
        $('#hyperlink').click(function(){
            var url;
            url = prompt('Enter the URL you wish to link:','http://');
            $('#contentArea').focus()
            if(url != '' && url != null){
                $('#contentArea').append('<a href=\"' + url + '\">' + url + '</a>')
            }
        });
}); 
```

小提琴 - [http://jsfiddle.net/vMFb9/](http://jsfiddle.net/vMFb9/)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:22:50.307

您正在鼠标悬停处理程序中*添加点击处理程序。*

每次鼠标移入元素（或其后代）时，您都在添加另一个单击处理程序。
当您单击它时，所有这些处理程序都会按顺序运行。

这不是一个好主意。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T20:23:13.650

从鼠标悬停中拉出您的点击事件，例如：

```
 $('#hyperlink').mouseover(function () {
        $('#hyperlink').css('color', '#000000')
        $('#hyperlink').mouseout(function () {
            $('#hyperlink').css('color', '#999999')
        });
    });
    $('#hyperlink').click(function () {
        var url;
        url = prompt('Enter the URL you wish to link:', 'http://');
        $('#contentArea').focus()
        if (url != '' && url != null) {
            $('#contentArea').append('<a href=\"' + url + '\">' + url + '</a>')
        }
    }); 
```

**[jsFiddle 示例](http://jsfiddle.net/j08691/vMFb9/1/)**

由于您在代码中放置点击事件的位置，它被多次触发。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T20:25:22.367

1.  您不应该嵌套 mouseout 或`click`mouseover 内部
2.  你应该使用`mouseenter`和`mouseleave`
3.  您可以使用`.on()`它们将它们合二为一！

    ```
    $('#hyperlink').on({
        mouseenter:function(){
            $(this).css('color','#000000');
        },
        mouseleave:function(){
            $(this).css('color','#999999');
        },
        click:function(){
            var url = prompt('Enter the URL you wish to link:','http://'),
                $contentArea = $('#contentArea');

            $contentArea.focus();
            if(!isEmpty(url)){
                $contentArea.append('<a href=\"' + url + '\">' + url + '</a>');
            }
        }
    });

    function isEmpty(str) {
        return (!str || 0 === str.length);
    } 
    ```

应该这样做！将它们组合成一个`.on()`绑定的原因是因为不需要每次都抓取 DOM 来进行操作。现在该项目只需要找到一次，并且可以将所有事件绑定到它。这是执行预期操作的最快方式。

**编辑**：更新了一个很酷的函数来检查字符串是否为空。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T20:24:19.207

你得让他们分开！事件处理程序就是这样。`mouseover`每次将鼠标悬停在超链接上时，事件处理程序都会将新的处理程序附加到超链接。

```
$('#hyperlink').mouseover(function(){
    $('#hyperlink').css('color','#000000')
});

$('#hyperlink').mouseout(function(){
        $('#hyperlink').css('color','#999999')
});

$('#hyperlink').click(function(){
    var url;
    url = prompt('Enter the URL you wish to link:','http://');
    $('#contentArea').focus()

    if(url != '' && url != null){
        $('#contentArea').append('<a href=\"' + url + '\">' + url + '</a>')
    }
 }); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T20:26:48.240

也可以，但不应该使用，至少让你知道它为什么不工作：

[看演示](http://jsfiddle.net/vMFb9/2/)

```
$('#hyperlink').mouseover(function(){
                $('#hyperlink').css('color','#000000')
                $('#hyperlink').off('mouseout').mouseout(function(){
                    $('#hyperlink').css('color','#999999')
                });
                $('#hyperlink').off('click').click(function(){
                    var url;
                    url = prompt('Enter the URL you wish to link:','http://');
                    $('#contentArea').focus()
                    if(url != '' && url != null){
                        $('#contentArea').append('<a href=\"' + url + '\">' + url + '</a>')
                    }
                });
        }); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-12T20:30:14.033

你应该分开

```
$('#hyperlink').click(function(){}); 
```

从鼠标悬停功能

# ruby - 将 Procs 变成块混乱

> ID：15980214
> 
> 赞同：2
> 
> 时间：2013-04-12T20:21:35.143
> 
> 标签：ruby

我知道我们在方法的参数前面使用 & 号是为了避免使用 yield，如果它在它的方式中没有找到一个块，它会输出一个错误。

但是，我看到有时我们在调用方法时在参数前面使用 & ，以便将 proc 转换回块。最终会发生 2 个 & 符号，一个用于将块转换​​为 proc，第二个用于相反。

怎么样？！我们什么时候需要将 & 号用于从 proc 中取回一个块，为什么？

我希望我已经清楚了，因为不是英语母语可能会对我提出困难的问题变得苛刻。

例子

我从 CodeSchool 的幻灯片中获取了这个示例，该幻灯片可在[http://courseware.codeschool.com/ruby_bits_2/ruby_bits_2_level_1.pdf](http://courseware.codeschool.com/ruby_bits_2/ruby_bits_2_level_1.pdf)上找到。

```
class Timeline
attr_accessor :tweets
  def each(&block)
     tweets.each(&block)
  end
end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:07:22.740

> 我知道我们在方法的参数前面使用 & 号是为了避免使用 yield，如果它在它的方式中没有找到一个块，它会输出一个错误。

你的理解是错误的。

您使用`&block`作为最后一个参数将块捕获到 a`Proc`中，特别是存储它并在以后使用它。调用方法时，`&block`执行相反的操作，即指定块对应于给定的`block`. `def foo(*args)`这与和的想法相同`foo(*args)`。

你给出的例子基本上相当于：

```
def each
   tweets.each{|t| yield y}
end 
```

正如 Yehuda Katz 在[本次演讲](http://blip.tv/rupy-strongly-dynamic-conference/yehuda-katz-tradeoffs-and-choices-why-ruby-isn-t-python-5726460)结尾所解释的那样，您应该将“块”视为`Proc`具有特殊参数位置和指定它的专用语法的 a。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:54:31.097

通常将它们一起使用。之所以如此，是因为块不能用作参数，而 procs 可以。所以如果你需要在方法体中使用块作为参数，你必须把它变成一个proc。

在该方法中，您可能希望将 proc 传递给仅接受块的另一个方法，因此您必须再次进行转换。

例如：

```
def each(&block) # block to proc
  posts.each(&block) # proc to block
end 
```

# java - 如何将从gps收到的lat long附加到url？

> ID：15980217
> 
> 赞同：0
> 
> 时间：2013-04-12T20:21:52.533
> 
> 标签：java, android, string

我在我的 android 应用程序中获得纬度和经度信息。我把它们加倍。我可以通过吐司来展示它。

现在我希望将那个 lat-long 附加到我的 URL 中，以便我可以发出 http get 请求。

这就是我必须附加经纬度信息的方式

http://localhost:8080/search/ByLatLngRadius?lat=38.87705&lng=-77.31462&radius=20

需要帮忙！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:37:58.790

使用字符串生成器并附加值如下

```
StringBuilder urlString = new StringBuilder();       
urlString.append("http:/localhost:8080/search/ByLatLngRadius?lat=");

urlString.append( latitude); 
// use this if latitude is double
//   urlString.append( Double.toString(latitude));
urlString.append("&lng=");
//  Double.toString(longitude)
urlString.append( longitude);
urlString.append("&radius=");
urlString.append(radius); 
```

# sql-server - sql server 2005 将时间转换为分钟

> ID：15980219
> 
> 赞同：1
> 
> 时间：2013-04-12T20:21:57.540
> 
> 标签：sql-server, stored-procedures, stored-functions

我的数据库中有一些日期时间函数，但我需要添加一个获取日期时间字段的时间部分，然后将时间转换为分钟的函数

我有一个函数可以获取两次之间的分钟数，而不仅仅是一次的分钟数。

```
 ALTER FUNCTION [dbo].[fn_MinutesBetween]
 ( @fStart datetime, @fEnd datetime )
 RETURNS int
 AS
 BEGIN
 RETURN DateDiff(minute, @fStart, @fEnd) 
```

另一个只得到时间部分

```
 ALTER function [dbo].[fn_ReturnTimeOnly]
 (@DateTime smallDateTime)
 returns nvarchar(50)
as
begin
  Return substring(cast(@DateTime as varchar),12,len(@DateTime))

end 
```

我怎样才能得到时间的分钟。比如上午 1:00 是 60，上午 2:00 是 120，下午 12:00 是 720，等等。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:44:28.200

我在评论中获得了[datetime to totalminute](https://stackoverflow.com/questions/4536330/datetime-to-totalminute-in-sql)的链接， 并用它来提出解决方案。

```
ALTER FUNCTION [dbo].[fn_ReturnMinutesOnly]
  ( @dt smalldatetime )

RETURNS int
AS
BEGIN
  RETURN DATEDIFF(MINUTE, DATEADD(DAY, DATEDIFF(DAY, 0, @dt), 0), @dt)
END 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:35:10.683

获取小时数，转换为 int，乘以 60，获取分钟数，转换为 int，将这两个相加。

```
ALTER function [dbo].[fn_ReturnMinutesOnly]
 (@DateTime smallDateTime)
 returns INT
as
begin
        Return
            cast(substring(cast(@DateTime as varchar),13,2) as INT) * 60 +
            cast(substring(cast(@DateTime as varchar),16,2) as INT)
end 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:41:58.883

转换为字符串很昂贵（[我在这里谈论相反的情况，但概念是相同的](http://www.sqlperformance.com/2012/09/t-sql-queries/what-is-the-most-efficient-way-to-trim-time-from-datetime)）。试试这个：

```
DECLARE @DateTime DATETIME;
SET @DateTime = GETDATE();

SELECT DATEDIFF(MINUTE, DATEDIFF(DAY, 0, @DateTime), @DateTime); 
```

在您的功能中，这将是：

```
ALTER function [dbo].[fn_ReturnTimeOnly]
(@DateTime smallDateTime)
returns INT
as
begin
  Return (SELECT DATEDIFF(MINUTE, DATEDIFF(DAY, 0, @DateTime), @DateTime));
end 
```

# extjs - Sencha 和 Java Servlet sync()

> ID：15980224
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:22:22.220
> 
> 标签：extjs, sencha-touch

我正在调整教程以从 localstorage 更改为使用 java servlet，但我遇到了一些问题。我正在尝试通过调用 sync() 来更新用户所做的更改，但我收到了这些错误。

```
[WARN][Ext.data.Operation#process] Unable to match the record that came back from the server. 
```

我尝试查看是否将更新的值发送到 servlet

```
String name = request.getParameter("name"); 
```

一片空白。如何将更新的值发送回服务器并读取它们？我尝试寻找 sencha touch + servlets 教程，但找不到任何东西

这是我的同步码

```
var showsStore = Ext.getStore("Shows");

    if (null == showsStore.findRecord('name', currentShow.data.name)) {
        showsStore.add(currentShow);
    }

    showsStore.sync(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:41:19.647

存储同步的预期返回是 JSON 记录数组，或者什么都没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T23:12:38.833

将此添加到您的数据存储中

```
 writer: {
         type: 'json',
         rootProperty: 'data',
         encode: true,
         writeAllFields: true
         }, 
```

# android - ListNavigation ActionBar 不起作用

> ID：15980225
> 
> 赞同：0
> 
> 时间：2013-04-12T20:22:27.043
> 
> 标签：android, actionbarsherlock

我有一个带有微调器的应用程序，并决定将“微调器”放入 ActionBar，因此我使用了 ActionBarSherlock 中的 ListNavigation，当我单击它时，列表显示，但是当我单击一个项目时，什么也没有发生。

我应该将 ListNavigation 链接到 ArrayAdapter 吗？

谢谢你。

```
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    display = ((WindowManager) this
            .getSystemService(Context.WINDOW_SERVICE)).getDefaultDisplay();

    setContentView(R.layout.map);

    findViewById(R.id.minus).setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            mapController.zoomOut();
        }
    });

    findViewById(R.id.help).setOnClickListener(new OnClickListener() {
        @Override
        public void onClick(View v) {
            openOptionsMenu();
        }
    });
    prefs = PreferenceManager.getDefaultSharedPreferences(this);
    editor = prefs.edit();

    Log.d(tag, "onCreate");
    timer = new Timer(true);

    // spinner = (Spinner) findViewById(R.id.spinner);
    adapter = NoScrollArrayAdater.createFromResource(this,
            R.array.cityNames, R.layout.sherlock_spinner_item);
    adapter.setDropDownViewResource(R.layout.sherlock_spinner_dropdown_item);
    // spinner.setAdapter(adapter);

    mSelected = getResources().getStringArray(R.array.cityValues);
    mLocations = getResources().getStringArray(R.array.cityNames);

    getSupportActionBar().setNavigationMode(ActionBar.NAVIGATION_MODE_LIST);
    getSupportActionBar().setListNavigationCallbacks(adapter, this);
@Override
public boolean onNavigationItemSelected(int itemPosition, long itemId) {
    mSelected("Selected: " + mLocations[itemPosition]);
    return true; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:36:31.023

您应该阅读 Android 开发者文档中的[ActionBar：添加下拉导航](http://developer.android.com/guide/topics/ui/actionbar.html#Dropdown)文档。

您需要使用设置导航回调，`actionBar.setListNavigationCallbacks()` 并且需要实现[ActionBar.OnNavigationListener](http://developer.android.com/reference/android/app/ActionBar.OnNavigationListener.html)。

ActionBarSherlock 的支持库ActionBar 方法相同。

**编辑：**

我不确定你发生了什么`NoScrollArrayAdater`或你为什么打电话`setDropDownViewResource()`，但是当我测试你的代码并将其替换为：

```
SpinnerAdapter adapter = ArrayAdapter.createFromResource(this, R.array.locations,
                  android.R.layout.simple_spinner_dropdown_item); 
```

# python - 类和子类辨别

> ID：15980230
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:22:35.743
> 
> 标签：python, list, class, subclass

我如何检查某物是子类还是类。比如说：

```
class Cat(object):
    def __init__(self,run,fast):
        """run is a list of speeds or something. But it can be from dogs or cats. Fast is a single number"""
        self.run=run
        self.fast=fast

class Dog(Class):
    def __init_(self,run, fast):
        Cat.__init__(self,run,fast)
        self.jumper=[]

    def update(self)
        for number in self.fast:
            if number is CATTYPE:
                self.jumper.append(number)
            if number is DOGTYPE:
                self.jumper.append(number) 
```

基本上我正在尝试，在所有大写的地方，找到一种方法来使声明快速找到它是否是猫类型，然后附加到跳线。我知道这是一个愚蠢的例子，但我想知道当一个是另一个的子类时如何处理这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:26:09.233

```
>>> issubclass
<built-in function issubclass>
>>> class Foo: pass

>>> class Bar(Foo): pass

>>> issubclass(Foo, Bar)
False
>>> issubclass(Bar, Foo)
True
>>> isinstance(Bar(), Foo)
True 
```

用于`issubclass(B, C)`检查 B 是否是 C 的子类。

用于`isinstance(c, C)`检查 c 是 C 的实例还是 C 的子类的实例。

对于您的问题：

```
if isinstance(animal_instance, Dog): 
    #instance of Dog

if isinstance(animal_instance, Cat):
    #instance of Cat 
```

但是，从您模棱两可的来源看来，就像您正在尝试建立某种赛狗程序来跟踪“跳跃记录”并选择“快速跳跃者”。这让我们想知道您想如何检查实例类。

# image - Opencv cvSaveImage

> ID：15980232
> 
> 赞同：1
> 
> 时间：2013-04-12T20:22:57.313
> 
> 标签：image, opencv

我正在尝试使用 opencv cvSaveImage 函数保存图像。问题是我正在对图像执行 DCT，然后更改执行 DCT 后获得的系数，之后我正在执行逆 DCT 以取回像素值。但是这次我得到了十进制的像素值（例如 254.34576）。因此，当我使用 cvSaveImage 函数保存它时，它会丢弃小数点后的所有值（例如，将 254.34576 保存为 254）并保存图像。因此，我的结果受到影响。请帮忙

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T06:18:25.923

“函数 cvSaveImage 将图像保存到指定的文件。图像格式根据文件扩展名选择，请参见 cvLoadImage。只能使用 8 位单通道或 3 通道（具有 'BGR' 通道顺序）图像保存这个函数。如果格式、深度或通道顺序不同，保存前使用cvCvtScale和cvCvtColor转换，或使用通用cvSave将图像保存为XML或YAML格式。

我建议调查 cvSave 功能。

但是，更简单的方法是编写自己的保存/加载函数，这将非常简单：

```
f = fopen("image.dat","wb");
fprintf(f,"%d%d",width,height);
for (y=0 to height)
  for (x=0 to width)
   fprintf(f,"%f",pixelAt(x,y)); 
```

并有相应的镜像功能供阅读。

PS 清晨，如果 fprintf 使用二进制文件，我一生都记不起了。但你明白了。您可以改用 fwrite() 。

# c++ - 如何在 C++ 中使用 libav 设置 x264 基线配置文件

> ID：15980235
> 
> 赞同：3
> 
> 时间：2013-04-12T20:23:05.490
> 
> 标签：c++, libavcodec, x264, libav, libx264

我正在编写一个小工具，它将视频转换为原始 h264 文件。这些文件稍后将由 SIP 电话播放。我有以下代码：

```
 eccx->pix_fmt = PIX_FMT_YUV420P;
  eccx->width = VIDEO_FRAME_WIDTH;
  eccx->height = VIDEO_FRAME_HEIGHT;
  eccx->time_base.num = 1;
  eccx->time_base.den = VIDEO_FRAMES_PER_SEC;
  eccx->max_b_frames = 0;

  eccx->rtp_payload_size = VIDEO_RTP_PAYLOAD_SIZE;

  eccx->bit_rate = VIDEO_BIT_RATE;
  eccx->rc_max_rate = VIDEO_BIT_RATE;
  eccx->rc_buffer_size = VIDEO_BIT_RATE * 2;

  eccx->flags |= CODEC_FLAG_QP_RD;
  eccx->flags |= CODEC_FLAG_LOW_DELAY;
  eccx->flags |= CODEC_FLAG_QSCALE;
  eccx->flags |= CODEC_FLAG_EMU_EDGE;

  eccx->mb_decision = FF_MB_DECISION_SIMPLE;

  switch(video){
  case H263:
    break;
  case H263P:
    eccx->flags |= CODEC_FLAG_H263P_SLICE_STRUCT;
    break;
  case H264:
    av_dict_set(&options, "vprofile", "baseline", 0);
    eccx->flags2 = CODEC_FLAG2_FASTPSKIP;
    eccx->profile = FF_PROFILE_H264_BASELINE;
    eccx->level = 13;
    break;
  } 
```

当我执行这个程序时，我从 libx264 得到以下输出：

```
[libx264 @ 0x10fad60] using cpu capabilities: MMX2 SSE2Fast SSSE3 FastShuffle SSE4.1 Cache64
[libx264 @ 0x10fad60] profile Main, level 1.3 
```

为什么这仍然是主要配置文件，尽管我已将其明确设置为基线？

此外，如果有人可以添加一些注释，哪种 h264 设置对 SIP 电话有用，我会非常酷。非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2015-04-14T13:46:20.047

您应该在编解码器上下文的私有部分设置选项：

```
av_opt_set(eccx->priv_data, "profile", "baseline", 0); 
```

当然假设这`eccx`是一个`AVCodecContext`例子。然后打开编解码器

```
avcodec_open2(eccx, codec, NULL); 
```

`codec`你的实例在哪里`AVCodec`，你应该已经得到了类似的东西：

```
AVCodec *codec = avcodec_find_encoder(AV_CODEC_ID_H264); 
```

您可以通过提供无效的配置文件名称来检查这是否有效，然后库将在标准错误时告诉您有效的配置文件名称。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-14T09:44:45.543

`vprofile`是一个 avconv 选项（以及一个未记录/不推荐使用/不推荐使用，`-profile:v`而是使用）。avconv 解析它，实际发送到的选项名称`libavcodec`只是`profile`. 所以这就是你应该使用的。

# javascript - JavaScript：初始化对象后初始化内部变量

> ID：15980239
> 
> 赞同：0
> 
> 时间：2013-04-12T20:23:22.180
> 
> 标签：javascript, object, scope, closures, delayed-execution

*更新：重写问题，因为原始问题有错误的假设（我在已经初始化我认为未定义的变量的控制台中运行代码）。*

这是有道理的：

```
var obj = { 'whichScope': a };
obj.whichScope; //"ReferenceError: a is not defined" 
```

但是，为什么下一个示例不会引发错误？如果第二行在第一行之前运行，为什么 obj.whichScope 不解析为“After”？

```
var obj = { 'whichScope': a };
var a = "After";
obj.whichScope; //"undefined" 
```

如果上一个示例中的“var a”在 obj 初始化之前运行，那么 'a = “After”;' 的任何部分是否 在 obj 初始化之前也运行？

```
var a = "Before";
var obj = { 'whichScope': a };
a = "After";
obj.whichScope; //"Before" 
```

如果 whichScope 引用了一个返回 'a' 的函数，那么它在最后一个示例中会解析为“After”。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:25:05.877

这就是所谓的变量提升。

参考：

*   [https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var#var_hoisting](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/var#var_hoisting)
*   [http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting](http://www.adequatelygood.com/2010/2/JavaScript-Scoping-and-Hoisting)
*   [http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-javascript-hoisting-explained/](http://net.tutsplus.com/tutorials/javascript-ajax/quick-tip-javascript-hoisting-explained/)

变量（用 声明`var`）和函数被提升到其作用域的顶部。

所以从技术上讲，你的脚本是这样的：

```
var a;  // = undefined
var obj = { 'whichScope': a };
a = "After"; 
```

虽然你的第一个例子没有按照你说的做。正如预期的那样，`obj.whichScope`值为。`undefined`

**演示：http:** [//jsfiddle.net/pRQwK/](http://jsfiddle.net/pRQwK/)

至于你的最后一条语句，`If whichScope refers to a function that returns 'a' then it does resolve to "After" in the second example.`- 那是因为`a`没有捕获的值（通过闭包）。设置属性时，会立即捕获其值（与闭包无关）。

# c# - 如何根据同一视图中的某些文本框在视图中填充网格？

> ID：15980245
> 
> 赞同：0
> 
> 时间：2013-04-12T20:23:51.447
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, razor, telerik

在我的 asp.net MVC 站点中，我有一个带有空网格和一些文本框的视图，当用户填充这些文本框时，我需要获取这些值并为网格创建一个新行。

我怎样才能做到这一点？

谢谢

ps（使用剃刀）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T10:53:39.457

看看在线[GridView 过滤](http://demos.telerik.com/aspnet-mvc/razor/grid/filtering)演示。

如果当前“过滤字符串”为空（参见“控制器 -> 过滤”操作方法；“startsWith”参数），则不要初始化模型。

如果不为空，则初始化所需的模型。

# linux - 如何检查服务器是否正在运行

> ID：15980247
> 
> 赞同：6
> 
> 时间：2013-04-12T20:23:54.487
> 
> 标签：linux, bash, shell, unix, ping

我想使用 ping 检查服务器是否已启动。我将如何执行以下操作：

```
ping $URL
if [$? -eq 0]; then
    echo "server live"
else
    echo "server down"
fi 
```

我将如何完成上述工作？另外，我将如何使它在第一个 ping 响应时返回 0，或者如果前十个 ping 失败则返回错误？或者，是否有更好的方法来完成我在上面尝试做的事情？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-01-11T08:48:35.493

我建议不要只使用`ping`. 它通常可以检查服务器是否在线，但您无法检查该服务器上的特定服务。

更好地使用这些替代方案：

### 卷曲

[男人卷曲](https://linux.die.net/man/1/curl)

您可以使用`curl`并检查`http_response`这样的网络服务

```
check=$(curl -s -w "%{http_code}\n" -L "${HOST}${PORT}/" -o /dev/null)
if [[ $check == 200 || $check == 403 ]]
then
    # Service is online
    echo "Service is online"
    exit 0
else
    # Service is offline or not working correctly
    echo "Service is offline or not working correctly"
    exit 1
fi 
```

在哪里

*   `HOST`= [您主机的 ip 或 dns 名称]

*   (可选) `PORT`= [可选端口；不要忘记从`:`]开始

*   `200`是正常成功http_response

*   `403`是一个重定向，例如可能是一个登录页面，所以也可以接受，并且很可能意味着服务运行正确

*   `-s`静音或静音模式。

*   `-L`定义位置

*   `-w`您希望以哪种格式显示响应
    ->`%{http_code}\n`我们只需要 http_code

*   `-o`输出文件
    ->`/dev/null`将任何输出重定向到 /dev/null 所以它不会被写入标准输出或`check`变量。通常您会在 http_response 之前获得完整的 html 源代码，因此您也必须将其静音。

* * *

### 数控

[男人数控](https://linux.die.net/man/1/nc)

虽然`curl`对我来说似乎是 Webservices 的最佳选择，因为它确实在检查服务的网页是否正常工作，

`nc`仅可用于快速检查目标上的特定端口是否可访问（并假设这也适用于服务）。

这里的优点是可设置的超时，例如 1 秒，而 curl 可能需要更长的时间才能失败，当然您也可以检查不是网页的服务，如 port `22`for `SSH`。

```
nc -4 -d -z -w 1 &{HOST} ${PORT} &> /dev/null
if [[ $? == 0 ]]
then
    # Port is reached
    echo "Service is online!"
    exit 0
else
    # Port is unreachable
    echo "Service is offline!"
    exit 1
fi 
```

在哪里

*   `HOST`= [您主机的 ip 或 dns 名称]

*   `PORT`= [**不是可选**的端口]

*   `-4`强制 IPv4（或`-6`用于 IPv6）

*   `-d`不要尝试从标准输入读取

*   `-z`只收听，不发送数据

*   `-w`timeout
    如果连接和标准输入的空闲时间超过 timeout 秒，则连接会静默关闭。（在这种情况下`nc`将退出 1 -> 失败。）

*   （可选）`-n`如果您只使用 IP：不要对任何指定的地址、主机名或端口进行任何 DNS 或服务查找。

*   `&> /dev/null`不要打印出命令的任何输出

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-12T20:31:44.623

你可以使用这样的东西 -

```
serverResponse=`wget --server-response --max-redirect=0 ${URL} 2>&1`

if [[ $serverResponse == *"Connection refused"* ]]
then
    echo "Unable to reach given URL"
    exit 1
fi 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-12T20:35:49.047

将 -c 选项与 ping 一起使用，它只会 ping URL 给定的次数或直到超时

```
if ping -c 10 $URL; then
    echo "server live"
else
    echo "server down"
fi 
```

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-04-26T00:34:40.610

简写：

```
ping -c5 $SERVER || echo 'Server down' 
```

您需要它用于其他脚本吗？或者试图破解一些简单的监控工具？在这种情况下，您可能需要查看 Pingdom：[https](https://www.pingdom.com/) ://www.pingdom.com/ 。

* * *

## 回答 #5

> 赞同：4
> 
> 时间：2015-05-04T10:04:11.407

我使用以下脚本函数来检查服务器是否在线。当您要检查多个服务器时，它很有用。该功能隐藏 ping 输出，您可以单独处理服务器实时或服务器停机情况。

```
#!/bin/bash

#retry count of ping request
RETRYCOUNT=1;

#pingServer: implement ping server functionality. 
#Param1: server hostname to ping
function pingServer {
  #echo Checking server: $1
  ping -c $RETRYCOUNT $1 > /dev/null 2>&1
  if [ $? -ne 0 ]
  then
    echo $1 down
  else
    echo $1 live
  fi
}

#usage example, pinging some host
pingServer google.com
pingServer server1 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2015-05-04T10:09:21.140

一个好的解决方案是将 MRTG（*NIX 的一个简单的绘图工具）与 ping-probe 脚本一起使用。在谷歌上查找。

读[这个](http://blog.webernetz.net/2014/01/09/mrtgrouters2-measuring-ping-times/)开始。

示例图：

![示例图](https://i.stack.imgur.com/M04P7.png)

# angularjs - AngularJS：E2E 测试中的访问范围

> ID：15980251
> 
> 赞同：0
> 
> 时间：2013-04-12T20:24:11.693
> 
> 标签：angularjs, karma-runner

我试图在 E2E 测试中访问 $scope，但没有成功...

作为测试，我尝试了这个：（我的网站不使用 JQuery ..）

跑步者将我的网站放在一个嵌套的 iframe 中，所以我直接访问它，然后获取所有 ng-scopes 并在它们上尝试 .scope() ，如[本文](https://stackoverflow.com/questions/10514147/in-angularjs-how-do-you-find-all-the-scopes-on-a-page)和下面的代码中所示......

```
var frameDocument = document.getElementById('test-frames').children[0].contentDocument;
var scopeElements = frameDocument.getElementsByClassName('ng-scope');
var scopes = [].map.call(scopeElements, function (e) {
return angular.element(e).scope();
}); 
```

上面的代码找到了正确的元素，但是对它们调用 scope() 会为每个返回 undefined ....

有人可以确认或否认我们可以访问 E2E 中的范围吗？我想有办法吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-30T09:45:32.780

这是我基于先前答案的技巧。

您可以将其扩展到动态范围。主要部分是从 addFutureAction 获取对 appWindow 的引用。

```
//HTML CODE

<body id="main-controller" ng-controller="mainCtrl" ng-init="__init__()">

//Scenario helper.

/*
Run `callback` with scope from `selector`.
*/
angular.scenario.dsl('scope', function() {
    return function(selector, callback) {
        return this.addFutureAction(
            'Executing scope at ' + selector,
            function(appWindow, $document, done) {
                var body = appWindow.document.getElementById(selector)
                var scope = appWindow.angular.element(body).scope()
                callback(scope)
                scope.$apply()
                done(null, 'OK');
            })
    }
})

//Actual test.

it(
'When alerts are defined, they are displayed.',
function() {
    scope('main-controller', function(scope) {
        scope.alerts.push({'type': 'error', 'msg': 'Some error.'})
    })

    expect(element('#alerts').css('display')).toEqual('block')
}) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-14T15:29:41.127

在 E2E 测试中，以这种方式访问​​范围并不是一个好的选择。相反，您可以使用辅助功能，例如`element()`选择页面中的元素，并用于`expect()`检查模型数据。

您可能需要的是单元测试。您可以`$scope`轻松地在单元测试中访问。

这里有一个很好的指南：[http ://www.yearofmoo.com/2013/01/full-spectrum-testing-with-angularjs-and-testacular.html](http://www.yearofmoo.com/2013/01/full-spectrum-testing-with-angularjs-and-testacular.html)

也可能是时间问题，我可以像这样到达睾丸跑步者的范围。它在 iframe 中运行测试。要使其工作，您需要添加`sleep(3)`到您的测试中。但这是非常脆弱的。

```
 setTimeout(function () {
        console.log('try to reach frames');
        var frame = window.frames[0].window.frames['senario_frame'];
        if (!frame) {
            console.log('too late');
        } else {

            var scopeElements = frame.document.getElementsByClassName('ng-scope');
            var scopes = [].map.call(scopeElements, function (e) {
                return frame.angular.element(e).scope();
            });
            console.log(scopes);
        }
    }, 2000); 
```

# c++ - 字段类型不完整

> ID：15980264
> 
> 赞同：1
> 
> 时间：2013-04-12T20:25:09.223
> 
> 标签：c++, templates

```
template <class Type>
class Punct {

protected:

    Type _x; // (1)
    Type _y; // (1)

public:

    Punct(Type = 0, Type = 0); // (2)
    ~Punct();
    inline Type getX() const { return _x; }
    inline Type getY() const { return _y; }

    inline void setX(Type x) { _x = x; }
    inline void setY(Type y) { _y = y; }
    inline void moveBy(int x, int y) { _x = x; _y = y; }

friend std::istream &operator>>(std::istream&ins, Punct<Type>& A);
friend std::ostream &operator<<(std::ostream&outs, const Punct<Type>& A);

}; 
```

这些是我得到的错误：

> (1) - 字段的类型不完整
> 
> (2) - 从 int 到 type 的转换不可行（有些添加 3\. 在此处将参数传递给参数）

你能告诉我我做错了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:42:49.927

这段代码对我有用。`g++ 4.7.2`上`Kubuntu 12.04`。

顺便说一句，您是否将`Punct`类的所有实现都放在一个文件中，即头文件，还是将它们分成`.h`and `.cpp`？

```
#include <iostream>
using namespace std;

template <class Type>
class Punct {

protected:

    Type _x; // (1)
    Type _y; // (1)

public:

    Punct(Type = 0, Type = 0) {}; // (2) <- empty function body added
    ~Punct() {}; // <- empty function body added
    inline Type getX() const { return _x; }
    inline Type getY() const { return _y; }

    inline void setX(Type x) { _x = x; }
    inline void setY(Type y) { _y = y; }
    inline void moveBy(int x, int y) { _x = x; _y = y; }

    template<class T> // <- added
    friend std::istream &operator>>(std::istream&ins, Punct<T>& A);
    template<class T> // <- added
    friend std::ostream &operator<<(std::ostream&outs, const Punct<Type>& A);

};

// bogus function added
template<class T>
istream &operator>> (istream &i, Punct<T> &a)
{
    return i;
}

// bogus function added
template<typename T>
ostream &operator<< (ostream &i, const Punct<T>& a)
{
    return i;
}

int main()
{
    Punct<int> a;
} 
```

# python - tkinter：透明形状的点击不会注册

> ID：15980265
> 
> 赞同：1
> 
> 时间：2013-04-12T20:25:09.610
> 
> 标签：python, tkinter

很简单的一个，这个。例如：

```
a = canvas.create_circle(0,0,50,50,outline='red',width=3,fill='')
b = canvas.create_circle(0,0,50,50,outline='red',width=3,fill='red') 
```

`b`将响应圆圈中任意位置的点击事件，而`a`只会响应对轮廓的点击。

有没有比简单地使用几乎透明的颜色填充更好的方法来解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:46:01.170

答案在某种程度上取决于您如何定义“更好”。如果对象没有填充颜色，则确实不会注册点击。一种选择是将点击事件放在画布本身上，然后使用画布`find_closest`或`find_overlapping`方法找到离光标最近的对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T22:28:33.527

您可以使用多边形而不是椭圆：

```
a = canvas.create_polygon(100,100,50,150,100,200,150,150, outline='red', fill='', smooth=1) 
```

编辑：

一个多边形对鼠标点击很敏感，即使它没有填充颜色（或轮廓）。

请参阅画布文档：[http ://www.tcl.tk/man/tcl/TkCmd/canvas.htm](http://www.tcl.tk/man/tcl/TkCmd/canvas.htm)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-12-03T21:35:05.357

有点晚了，但这是解决问题的方法。在您的情况下，您会注意到，如果您单击无填充对象本身的轮廓，则会触发单击事件。（不知道为什么，但它的行为方式是这样的）

现在，如果您同时删除轮廓并填充，即

```
a = canvas.create_circle(0,0,50,50,outline='',fill='') 
```

不可见（无填充，无轮廓）将触发点击事件，就像另一个圆圈“b”一样。

所以你可以做的是创建一个不可见的圆圈（没有填充，没有轮廓），将它绑定到触发事件。然后使用所需的轮廓参数在其顶部创建另一个圆圈（相同的坐标）。

这将产生一个没有填充的单一轮廓圆圈的错觉，并且仍然会触发点击事件。

# mysql - SQL查询从另一个表中获取百分比

> ID：15980268
> 
> 赞同：1
> 
> 时间：2013-04-12T20:25:20.513
> 
> 标签：mysql

所以，我有两张表，一张是“当前”表，另一张是“历史”表。我现有的查询看起来有点像这样

```
$QueryStr="SELECT *, IF(HOUR(TIMEDIFF(NOW(), TIME)) >= 1, 1, 0) AS OlderThanAnHour from ddCurrent"; 
```

我要添加的是从 ddHistorical 中选择的，它计算记录的总数，然后显示不等于“OK”的数字

架构结构：

```
ddCurrent:
-ID
-LOCATION
-STATUS
-TIME

ddHistorical
-ID
-CID (same as ID from ddCurrent)
-LOCATION
-STATUS
-TIME 
```

所以本质上，我想要的是一个连接，当它在状态中说“OK”时，当它为每个 ID 说其他任何东西时，做一定的百分比。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:30:29.963

```
$QueryStr="SELECT count(*) / 
(SELECT count(*) from ddHistorical) 
from ddHistorical where not status = 'OK'; 
```

上面的查询计算子查询中的历史记录总数。然后状态为 not OK 的查询总数除以子查询的结果。

# java - 将 com.sun.mail.imap.IMAPMessage 转换为字符串

> ID：15980271
> 
> 赞同：1
> 
> 时间：2013-04-12T20:25:25.447
> 
> 标签：java, gmail, imap, jakarta-mail

我正在从 IMAP 服务器 (Gmail) 检索一条消息，并尝试将其连同一些有关它的信息打印出来，最终存储在一个字符串中以供稍后解析。我正在打印以下内容

```
System.out.println(message.getSubject());
System.out.println(message.getFrom()[0]);
System.out.println(message.getReceivedDate());
System.out.println(message.getContent().toString()); 
```

这就是它打印出来的

```
Your Order with Amazon.com
"auto-confirm@amazon.com" <auto-confirm@amazon.com>
Tue Dec 30 23:14:01 EST 2008
javax.mail.internet.MimeMultipart@6baa6838 
```

前 3 个打印出来的正是我所期望的，但最后一个应该是整个消息，不是吗？如果没有，我需要做什么才能将整个消息作为字符串获取？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:41:05.767

IMAPMessage 扩展了 MIMEMessage，并且根据[docs](http://javamail.kenai.com/nonav/javadocs/javax/mail/internet/MimeMessage.html#getContent%28%29)，该`getContent()`方法返回一个对象。不保证对象的类型是字符串。在您的情况下，返回的 Object 是`MIMEMultipart`. 查看此[常见问题](http://www.oracle.com/technetwork/java/javamail/faq/index.html#readattach)解答及其示例 (msgshow.java)，了解如何处理`MIMEMultipart`对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:56:11.097

这是因为 MimeMultipart 类没有实现 toString 方法。我没有测试过这个，但你总是可以试试这个。

```
((MimeMultipart)message.getContent()).writeTo(System.out); 
```

就像在另一篇文章中指出的那样，要小心，因为不能保证总是返回 MimeMultipart。

# python - 以嵌入式方式使用动态链接时设置 Python 位置

> ID：15980272
> 
> 赞同：0
> 
> 时间：2013-04-12T20:25:26.087
> 
> 标签：python

我目前正在使用静态链接来使我的嵌入式 Python 2.7 应用程序正常工作。但是这种方法有一些问题，我想通过使用调用方法来纠正。（动态链接）。

所以这是我的计划：

*   让用户选择他要使用的python27.dll，如下所述：http: [//fmepedia.safe.com/articles/How_To/Choosing-a-different-Python-Interpreter-installation](http://fmepedia.safe.com/articles/How_To/Choosing-a-different-Python-Interpreter-installation)
*   使用 AfxLoadLibrary() 加载此 dll
*   调用 Py_Initialize() 和其他 Python 函数

我的问题是：我是否必须使用 Py_SetPythonHome() 函数设置 Python Home 路径？它是强制性的吗？如果是，我还需要用户指定其 Python 安装的位置，这是我想避免的。

# c# - ASP.NET 是否具有获取用户历史记录的内置功能？

> ID：15980274
> 
> 赞同：2
> 
> 时间：2013-04-12T20:25:30.703
> 
> 标签：c#, asp.net, vb.net

我正在寻找一种内置解决方案来获取用户通过我的 ASP.NET 应用程序访问的页面。

这是一个简单的例子：

```
Default.aspx
Page1.aspx
Page2.aspx
Page1.aspx <-- User is here 
```

我想在当前页面之前获取最新页面，在本示例中为`Page2.aspx`.
也许`Master Page`或`ViewState`可以帮助？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:31:06.023

没有“内置解决方案”。

如果您必须这样做 - 如果历史记录很小，您可以将其存储在会话中。如果更大，请坚持到数据库。

您还可以考虑与谷歌分析集成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:27:47.740

您可以使用[Request.UrlReferrer](http://msdn.microsoft.com/en-us/library/system.web.httprequest.urlreferrer.aspx)找出将用户带到当前页面的页面（或站点）。

或[Page.PreviousPage](http://msdn.microsoft.com/en-us/library/system.web.ui.page.previouspage.aspx)告诉您相同的信息，但有一些警告：

> 当您使用 Transfer 方法或使用跨页面发布将处理从一个 ASP.NET 页面转移到另一个页面时，原始页面包含目标页面可能需要的请求信息。您可以使用 PreviousPage 属性来访问该信息。如果当前页面是由于直接请求（不是来自另一个页面的传输或交叉发布）而呈现的，则 PreviousPage 属性包含 null。

但是，您只能获得上一页。如果您想要完整的历史记录，则必须在您的应用程序中启用/实现某种跟踪。

# c# - 读取 html 文件并在 CKEditor 中显示

> ID：15980275
> 
> 赞同：1
> 
> 时间：2013-04-12T20:25:31.487
> 
> 标签：c#, asp.net, html-parsing, ckeditor

我目前正在为我的项目使用 CKEditor 来读取和显示 html 文件的内容。

但是，我得到的不是文件的内容，而是一个字符串： <html> 在编辑器中显示。

但是如果我使用 response.write 将内容直接写入页面，那么文件的所有内容都会正确显示。

这是我用来读取文件的代码片段：

```
 strPathToConvert = Server.MapPath("~/convert/");
    object filetosave = strPathToConvert + "paper.htm";
    StreamReader reader = new StreamReader(filetosave.ToString());
    string content = "";
    while ((content = reader.ReadLine()) != null)
    {
        if ((content == "") || (content == " "))
        { continue; }
        CKEditor1.Text = content;
        //Response.Write(content);
    } 
```

有人可以帮我解决这个问题吗？非常感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:56:25.667

您处于一个`while`循环中，并且每次都覆盖 CKEditor 的内容，因为您使用`=`而不是`+=`. 你的循环应该是：

```
StreamReader reader = new StreamReader(filetosave.ToString());
string content = "";
while ((content = reader.ReadLine()) != null)
{
    if ((content == "") || (content == " "))
    { continue; }
    CKEditor1.Text += content;
    //Response.Write(content);
} 
```

更好的方法可能是使用

```
string content;
string line;
using (StreamReader reader = new StreamReader(filetosave.ToString())
{
    while ((line= reader.ReadLine()) != null) 
    {
        content += line;
    }
}
CKEditor1.Text = content; 
```

# cocoa-touch - 如何防止此 NSPropertyListSerialization 崩溃？

> ID：15980277
> 
> 赞同：3
> 
> 时间：2013-04-12T20:25:38.553
> 
> 标签：cocoa-touch, cocoa

我有一个适用于 Mac 和 iOS 的应用程序，它使用 .plist 文件在使用 iCloud 的设备之间同步数据。每隔一段时间，我就会收到一封来自某个在特定设备上反复崩溃的电子邮件。（其他设备都很好。）在每种情况下，应用程序在尝试从 iCloud 读取文件时都会崩溃，使用 NSPropertyListSerialization 将数据转换为字典。在每种情况下，问题都是通过让用户删除应用程序的 iCloud 数据来解决的。相同的文件重新同步，一切正常。

我将在这里使用的具体示例来自 Mac 版本，但我在 iOS 上遇到了几乎相同的崩溃。来自崩溃报告：

```
Exception Type:  EXC_BAD_ACCESS (SIGBUS)
Exception Codes: 0x000000000000000a, 0x0000000101ee2000

VM Regions Near 0x101ee2000:
    VM_ALLOCATE            0000000101ee1000-0000000101ee2000 [    4K] rw-/rwx SM=PRV  
--> mapped file            0000000101ee2000-0000000101ee3000 [    4K] r--/rwx SM=COW  /Users/USER/Library/Mobile Documents/PB4R74AA4J~com~junecloud~Notefile/*/*.notefile
    shared memory          0000000101ee3000-0000000101ee4000 [    4K] rw-/rw- SM=SHM 
```

接着：

```
Thread 7 Crashed:
0   libsystem_c.dylib               0x0000000105157013 bcmp + 19
1   com.apple.CoreFoundation        0x0000000101bbf4b0 __CFBinaryPlistGetTopLevelInfo + 80
2   com.apple.CoreFoundation        0x0000000101bbf36d __CFTryParseBinaryPlist + 93
3   com.apple.CoreFoundation        0x0000000101bbede2 _CFPropertyListCreateWithData + 146
4   com.apple.CoreFoundation        0x0000000101bcbdb0 CFPropertyListCreateWithData + 112
5   com.apple.Foundation            0x0000000101568b89 +[NSPropertyListSerialization propertyListWithData:options:format:error:] + 94
6   com.junecloud.Notefile-Helper   0x000000010107ad06 -[JUNNoteDocument readFromData:ofType:error:] + 64
7   com.apple.AppKit                0x000000010268d507 -[NSDocument readFromURL:ofType:error:] + 546
8   com.apple.AppKit                0x000000010228e3c8 -[NSDocument _initWithContentsOfURL:ofType:error:] + 135
9   com.apple.AppKit                0x000000010228e074 -[NSDocument initWithContentsOfURL:ofType:error:] + 262
10  com.junecloud.Notefile-Helper   0x000000010107cad8 -[JUNSyncDocument initWithFileURL:] + 213
11  com.junecloud.Notefile-Helper   0x0000000101079ec7 -[NotefileAppDelegate documentForURL:] + 68
12  com.junecloud.Notefile-Helper   0x00000001010825cb -[JUNSyncManager documentForURL:] + 76
13  com.junecloud.Notefile-Helper   0x000000010107d43c -[JUNSyncInOperation main] + 1340
14  com.apple.Foundation            0x0000000101563cd2 __NSThread__main__ + 1345
15  libsystem_c.dylib               0x00000001051697a2 _pthread_start + 327
16  libsystem_c.dylib               0x00000001051561e1 thread_start + 13

Thread 7 crashed with X86 Thread State (64-bit):
  rax: 0x0000000000000062  rbx: 0x000000000000007b  rcx: 0x000000010c2be868  rdx: 0x0000000000000007
  rdi: 0x0000000101d1e151  rsi: 0x0000000101ee2000  rbp: 0x000000010c2be810  rsp: 0x000000010c2be7b8
   r8: 0x000000010c2be870   r9: 0x0000000000000000  r10: 0x00007ff841c28900  r11: 0x00007ff841c186d8
  r12: 0x000000010c2be870  r13: 0x0000000101ee2000  r14: 0x000000010c2beb00  r15: 0x000000010c2be980
  rip: 0x0000000105157013  rfl: 0x0000000000010202  cr2: 0x0000000101ee2000
Logical CPU: 2 
```

这是崩溃的相关代码：

```
- (BOOL)readFromData:(NSData *)data ofType:(NSString *)typeName error:(NSError **)outError {
    BOOL success = NO;
    NSDictionary *dictionary = nil;

    NSError *error = nil;
    id plist = [NSPropertyListSerialization propertyListWithData:data
        options:NSPropertyListImmutable format:NULL error:&error];
    if (plist && [plist isKindOfClass:[NSDictionary class]]) {
        dictionary = plist;
    } else {
        NSLog(@"Error opening document: %@ %@",error,[error userInfo]);
        if (outError != NULL) *outError = error;
    }

    // Then it does some things with the dictionary if it's not nil

    return success;
} 
```

我认为 NSPropertyListSerialization 只是因为一些损坏的数据而窒息是正确的，还是我自己的代码中更有可能出现问题？如果问题出在 NSPropertyListSerialization 上，我能做些什么来防止应用程序崩溃，并更恰当地处理问题吗？

如果问题可能出在我自己的代码中，我该怎么做才能找到原因？如果我可以自己复制问题，这会容易得多，但我从未在自己的设备上看到过这种崩溃，显然我不能指望用户让我访问他们的 iCloud 帐户。

**更新**根据要求，这里有一些`JUNSyncDocument`. 在 iOS 上这是一个 UIDocument 子类，在 Mac 上它是一个 NSDocument 子类。

```
- (id)initWithFileURL:(NSURL *)url {
    #if TARGET_OS_IPHONE

    self = [super initWithFileURL:url];
    return self;

    #else

    NSError *error = nil;
    if ([[NSFileManager defaultManager] fileExistsAtPath:[url path]]) {
        if ((self = [super initWithContentsOfURL:url ofType:[self documentType] error:&error])) {
            self.fileURL = url;
            self.hasUndoManager = NO;
        } else NSLog(@"Error initializing existing document: %@ %@",url,error); 
    } else {
        if ((self = [super initWithType:[self documentType] error:&error])) {
            self.fileURL = url;
            self.hasUndoManager = NO;
        } else NSLog(@"Error initializing new document: %@",error);
    }
    return self;

    #endif
} 
```

这看起来很混乱，如果我在这里做一些愚蠢的事情，我不会感到惊讶。不过，它在大多数情况下都可以正常工作。从以下位置调用`NotefileAppDelegate`：

```
- (JUNSyncDocument *)documentForURL:(NSURL *)url {
    JUNNoteDocument *document = [[JUNNoteDocument alloc] initWithFileURL:url];
    return document;
} 
```

这又被调用`JUNSyncManager`：

```
- (JUNSyncDocument *)documentForURL:(NSURL *)url {
    return [self.delegate documentForURL:url];
} 
```

由以下人员调用`JUNSyncInOperation`：

```
JUNSyncDocument *document = [self.delegate documentForURL:self.url]; 
```

我刚刚意识到我可以通过使用来摆脱那个荒谬的委托链`NSClassFromString`，但我不知道这是否会影响问题。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T22:21:18.810

查看[源代码](http://opensource.apple.com/source/CF/CF-550/CFBinaryPList.c) `of __CFTryParseBinaryPlist` `and __CFBinaryPlistGetTopLevelInfo`，它们是开源的。

看起来崩溃的 memcmp (bcmp) 在一开始就检查二进制 plist 标头的数据的前几个字节。如果`CFDataGetLength`是`<= 8`字节，它就不会那么远，所以它不是缓冲区下溢。有可能`CFDataGetBytePtr`返回 nil，但我看不出如果长度 > 8 会发生这种情况。最有可能的是，数据指针已经无效。

我可以告诉您更多您从崩溃报告中发布的注册内容。另外，发布它如何创建数据的代码（`-[JUNSyncDocument initWithFileURL:]`和`-[NotefileAppDelegate documentForURL:]`。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-05-22T20:52:46.990

我有完全相同的问题，（`UIDocument`&`NSDocument`子类，在访问 plist 数据时崩溃），虽然我正在使用`NSFileWrapper`。

映射的文件路径在您的报告中看起来很可疑（除非它已被操作系统匿名），它似乎不是实际文件，而是查询字符串。不是`NSMetadataQuery`返回不正确的结果吗？

目前还没有解决办法，还在找。

## 更新

我可以与客户一起调试这个问题，生成带有日志信息的自定义构建。以下是我的观察：

*   崩溃发生在不同的 API 上，比如`NSPropertyListSerialization`, `CGImageSourceCreateWithURL`，可能还有很多其他的。
*   访问的文件存储在 iCloud 容器中

它具有以下状态：

```
fileExists = YES;
isUbiquitous = YES;
hasNonZeroSize = YES;
isDownloaded = NO; 
```

因此，对于大多数 API，它显示为常规文件，但它不可用。访问时，它会使应用程序崩溃。- 访问的文件可以在具有 的文件包中`isDownloaded = YES`，尽管访问的文件本身（在文件包中）具有`isDownloaded = NO`.

解决方法：`isDownloaded`在访问文件内容之前检查文件的属性。使用以下命令检查此属性：

```
-[NSURL getResourceValue:&val forKey:NSURLUbiquitousItemIsDownloadedKey error:&error] 
```

如果您像我一样使用`NSFileWrapper`阅读`UIDocument`内容，那么您需要进行以下检查：

```
-[UIDocument readFromURL:(NSURL *)url error:(NSError *__autoreleasing *)outError] 
```

因为`NSFileWrapper`不会让您访问`NSURL`所需的文件包。

我怀疑创建文档时 iCloud 的原子性存在问题。看起来文件包及其内容的下载状态不同步，就像先创建文档目录，然后将其内容作为 2 个不同的操作复制到其中一样。

# c# - 添加按钮以在 MessageBox 中复制文本

> ID：15980278
> 
> 赞同：4
> 
> 时间：2013-04-12T20:25:40.997
> 
> 标签：c#, winforms, messagebox

我有一个包含名称列表的程序，以及一个在 MessageBox 中显示随机名称的按钮。有什么办法可以在消息框的“确定”旁边添加一个“复制”按钮，单击该按钮会复制名称然后关闭？

如果上述方法不可行，有没有办法在 MessageBox 中复制文本？

谢谢你。

编辑：我的用户不会理解 Ctrl+C、突出显示和右键单击 > 复制是我正在寻找的（如果复制按钮不可用）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:27:40.630

> 如果用户`Ctrl-C`在 MessageBox 具有焦点时按下，则消息、MessageBox 标题和 MessageBoxButtons 标签将复制到剪贴板。

我用谷歌搜索了你的标题并找到[了这个](https://stackoverflow.com/questions/7840231/c-sharp-select-text-from-messagebox-show-popup)..

或者，如果您真的需要一个显示复制的按钮，您可以使用新的 Windows 窗体创建自己的按钮，`MessageBox`然后使用按钮执行您想要的操作。像这样打开它以保持`MessageBox`感觉：

```
var myMessageBox = new CustomMessageBox();
myMessageBox.ShowDialog(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:30:48.360

听起来您可能正在寻找[剪贴板](http://msdn.microsoft.com/en-us/library/system.windows.forms.clipboard.aspx)类。

```
Clipboard.SetText(variableWithValue); 
```

[这里](https://stackoverflow.com/questions/1545835/replacement-for-yes-no-cancel-messagebox-c)还有另一个关于操作消息框内容的答案。

在不实际使用 MessageBox 类的情况下，简单地制作一个模拟 MessageBox 的模态对话框也可能更容易。

# r - 在R中的数据框元素中存储列表

> ID：15980281
> 
> 赞同：14
> 
> 时间：2013-04-12T20:26:13.537
> 
> 标签：r, data-structures

我想以以下形式创建数据结构

```
Start, End, Elements
  3  , 6  ,  {4,5}
  4 ,  10 ,  {7,8,9}
   .... 
```

换句话说，我正在沿着一条线移动一个球。“开始”代表球的最左边位置，“结束”代表最右边。“元素”意味着我以某种方式发现这些职位很特别。当元素的数量可以变得非常大时，最好使用什么数据结构？我唯一能想到的是一个数据框，其中第三列是一个适当格式化的字符串。如果我想查看集合中的每个数字，我将不得不解析字符串。R 是否有更好的数据格式？

谢谢！

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-12T21:27:04.727

我的评论中提到的选项，即简单地使用其中一列的列表：

```
dat <- data.frame(Start = 3:4, End = c(6,10))
> dat
  Start End
1     3   6
2     4  10
> dat$Elements <- list(4:5,7:9)
> dat
  Start End Elements
1     3   6     4, 5
2     4  10  7, 8, 9 
```

当然，您也可以完全放弃数据帧，而只需使用一个普通的旧列表（无论如何，这在很多情况下可能更有意义）：

```
list(list(Start = 3,End = 6, Elements = 4:5),list(Start = 4,End = 10,Elements = 7:9))
[[1]]
[[1]]$Start
[1] 3

[[1]]$End
[1] 6

[[1]]$Elements
[1] 4 5

[[2]]
[[2]]$Start
[1] 4

[[2]]$End
[1] 10

[[2]]$Elements
[1] 7 8 9 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-12T20:36:36.390

您可以将其存储为一个高数据框而不是一个宽数据框，并且可能使用`data.table`它来有效地处理它。也就是说，每个元素一行而不是每个起始对一行

```
library(data.table)
dt = data.table(Start=c(3, 3, 4, 4, 4), End=c(6, 6, 10, 10, 10), Elements=c(4, 5, 7, 8, 9))
#   Start End Elements
#1:     3   6        4
#2:     3   6        5
#3:     4  10        7
#4:     4  10        8
#5:     4  10        9 
```

这将使您可以很容易地对数据进行多种处理，例如确定每个范围中有多少元素：

```
dt[, list(Num.Elements=length(Elements)), by=c("Start", "End")]

#    Start End Num.Elements
# 1:     3   6            2
# 2:     4  10            3 
```

这也将使数据易于使用该`ggplot`包进行绘图，该包通常期望数据采用高格式。

您可能会注意到这种数据结构很浪费，因为它为每个元素重复了 Start 和 End。但是，数据表的存储效率非常高——即使您的元素列表实际上是数百万长，它也可以很容易地适应并以这种方式进行处理。试试这样的一行：

```
dt = data.table(Start=1:1e6, End=1:1e6, Elements=1:1e6) 
```

进行演示。处理起来*肯定*比将每个元素列表保存为字符串并每次拆分它要快。

# php - ID 大于等于 10 时显示内容

> ID：15980282
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:26:15.937
> 
> 标签：php, mysqli

我正在尝试显示“显示过去的博客”链接，但仅当博客达到 11 及以上博客 ID 插入时。因此，最多 10 个它必须从用户视图中隐藏，因为它不需要显示它，并且 10 个之后的任何内容都可以显示给用户以查找创建的较旧博客。

我已经尝试了以下方法，但没有占上风。

```
$blogids = mysqli_query($mysqli, "SELECT blogitem_id FROM blogdata") or die("SELECT Error: ".mysqli_error($mysqli));
$blogs = mysqli_num_rows($blogids);

if($blogs==10) {
echo'<div class = "blog_show_posts" onclick = "blog_stream_count+=10;blog_stream_load();"> Show Past Blogs </div></div>';
}else{ echo""; }?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:34:37.683

`$blogs==10` 只会在 count 正好为 10 时显示。尝试 `$blogs > 10`

# sed - sed 替换文本

> ID：15980283
> 
> 赞同：0
> 
> 时间：2013-04-12T20:26:19.797
> 
> 标签：sed

我需要用单引号替换文本，`sed`但我无法让它工作。这是我的代码；你能帮助我吗？

我有一个这种格式的文本文件：

```
#sometext
$configuration_TEstbk2_bk2_environment12 = 'lalala'
$configuration_TEstbk2_bk2_envoronment12 = 'lalala1'
$configuration_TEstbk2_bk2_staging12 = 'BACKUP 2'
$configuration_waq4faw4f_q4fq4qg4f = 'r234rq43rq4rqr'
$configuration_alice_StagingTEstBk_bk = 'testebk'
$configuration_deployment_overlays_alice_TEStStngDir = 'some'
$configuration_arefgqrqgrq_341q34tq34t = '134t135' 
```

我需要做类似的事情：

```
sed s/$configuration_arefgqrqgrq_341q34tq34t   ='134t135'/$configuration_arefgqrqgrq_341q34tq34t = 'NEWVALUE'/g 
```

我尝试了很多组合，`sed`但我找不到一个有效的组合。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:30:28.103

这对你有用吗？

```
sed "/\$config_deployment_overlays_alice_arefgqrqgrq_341q34tq34t_staging/s/'134t135'/'NEWVALUE'/" file 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T07:39:22.857

这可能对您有用（GNU sed）：

```
sed -r 's/^(\$\S+\s=\s'\'').*('\'')/\1NEWVALUE\2/' file 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:06:03.070

您还可以通过捕获它们来完全避免匹配的引号：

```
sed '/$configuration_arefgqrqgrq_341q34tq34t/{
         s/\(= *.\).*\(.\) *$/\1NEWVALUE\2/
}' input 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T20:41:21.873

我可能会使用：

```
sed '/$configuration_arefgqrqgrq_341q34tq34t *=/'"s/'134t135'/'NEWVALUE'/" 
```

这在 shell 级别混合使用单引号和双引号来获取正确的信息到`sed`. 单引号将搜索条件括起来，其中包含`$configuration_arefgqrqgrq_341q34tq34t`后跟一些空格和等号的行。这避免了 shell 扩展可能是 shell 变量名的内容（但可能不是，因此将替换空字符串）。然后，我在 shell 级别切换到双引号，以便`sed`看到单引号：它将单引号中的值替换为替换值，但仅在那些包含给定配置参数名称的行上。

我希望用户永远不必键入那些配置参数名称。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T20:42:23.647

我想你的问题是引用。您可以使用复杂的引用来确保所有内容都在单引号中，除了需要在双引号中的单引号：

```
sed 's/$configuration_arefgqrqgrq_341q34tq34t *= *'"'134t135'"'/$configuration_arefgqrqgrq_341q34tq34t = '"'NEWVALUE'/g" 
```

...或者您可以使用一些临时变量来使整个内容更具可读性，并且适合包含在一对双引号中：

```
directive='$configuration_arefgqrqgrq_341q34tq34t'
oldvalue="'134t135'"
newvalue="'NEWVALUE'"
sed "s/$directive *= *$oldvalue/$directive = $newvalue/g" 
```

（如果您只期望一场比赛，那么`/g`标志是多余的。）

# google-bigquery - 使用可为空字段的 BigQuery 表查询性能

> ID：15980284
> 
> 赞同：0
> 
> 时间：2013-04-12T20:26:28.293
> 
> 标签：google-bigquery

我们需要将日志中的数据上传到 Google BigQuery，并且我们有两个日志数据子集，它们在查询时不会重叠。

1.  第一个子集有一个字段“vendor_id”，它将在 WHERE 子句中大量使用。
2.  第二个子集是没有“vendor_id”的日志条目

我们可以只创建一个带有可为空的“vendor_id”字段的表，或者为每个子集创建两个不同的表。这些方法的性能有什么不同吗？

问候

狮子座

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T22:37:08.037

您提到的两个选项之间的查询性能几乎没有（如果有的话）差异。也就是说，查询的成本与读取的数据量成正比，因此如果您有两个单独的表，它可能会更便宜，因为每个查询将读取较少量的数据。

# sql-server - SQL Server 存储的过程可以比其调用者更高的权限执行吗？

> ID：15980286
> 
> 赞同：3
> 
> 时间：2013-04-12T20:26:30.693
> 
> 标签：sql-server, sql-server-2008-r2, database-permissions

我们的 SQL Server 数据库具有报告功能，允许调用者读取但不能写入任何表，因为用户（或者更准确地说，代表用户操作的 Web 应用程序打开的连接）只有 datareader 权限数据库。

我们希望能够编写一个存储过程，它是一个特殊的“清理报告”，它将在运行另一个报告之前清理旧缓存数据的数据库。我们希望上面的同一个只读用户能够运行这个存储过程。存储过程中的查询将执行 DELETE 操作，但我们不希望用户能够通过调用此过程来删除任何内容。

我知道[模块签名](http://msdn.microsoft.com/en-us/library/ms345102.aspx)，但希望避免处理证书的复杂性。

还有其他解决方案吗？如果这很重要，我们将使用 SQL 标准身份验证。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:30:17.117

```
CREATE PROCEDURE dbo.my_procedure
WITH EXECUTE AS OWNER
AS
BEGIN
  -- do your stuff here
END
GO
GRANT EXEC ON dbo.my_procedure TO [your_datareader_member];
GO 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:30:52.260

授予执行该过程的权限将允许删除发生。

事实上，这是一个非常相关的场景，以限制执行某些操作（例如删除）的能力。用户可能无法从随机表中删除随机行，但他们可以执行特定的目标删除过程。

# c - 为什么在以下代码中删除“int”关键字不会产生任何错误

> ID：15980287
> 
> 赞同：0
> 
> 时间：2013-04-12T20:26:34.447
> 
> 标签：c

示例程序 1.`int`在`typedef`第一行注释：

```
typedef int (*p)(); //Statement 1
int foo()
{
 return 0;
}
int main()
{    int c;
    p q=foo;
    c=(*q)();
    printf("%d",c);
    return 0;
}
Output:0 
```

示例程序 2\. 都一样，但`int`第一行没有：

```
typedef (*p)(); //Statement 1
int foo()
{
 return 0;
}
int main()
{    int c;
    p q=foo;
    c=(*q)();
    printf("%d",c);
    return 0;
}
Output:0 
```

两种情况下的输出相同。它不会产生任何错误。为什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:29:01.980

您应该始终发布您在此类问题中使用的编译器（和版本）。

我的猜测是您使用的是允许隐式 int 的 C89 编译器。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T20:30:11.023

如果你在 C99 模式下编译，你会得到一个诊断，但在 C89 和准标准 C 中，关键字`int`是可选的。

因此：

```
extern a;

main(argc, argv)
char **argv;
{
    auto i;
    ...
    return 0;
} 
```

和其他被现代标准视为可憎的编码风格是允许的。（变量`a`是一个`int`；参数`argc`是一个`int`；变量`i`是一个`int`；返回类型`main()`是一个`int`。）请注意，在 C99 之前，你不应该离开`return 0;`from `main()`; 如果你这样做了，返回到调用环境的值是未定义的。

# java - 在同一个包中加载类依赖项（不显示在导入语句中）

> ID：15980291
> 
> 赞同：0
> 
> 时间：2013-04-12T20:27:04.413
> 
> 标签：java, reflection, static-analysis

我制作了类实现，将所需的类打包并将其发送到服务器上执行。

我使用 org.reflections 做了一个方法，它允许我将所有需要的类加载到这项工作中。我用这些类生成了一个 jar 文件，它将由 Web 服务在服务器上执行。这已经完成了。

但是，我遇到了一个问题，直到现在我都无法解决。

前任：

```
package com.marciob.applications.report.generator;

import com.marciob.applications.onleague.model.Team;

class MyJob implements Job {

    public void execute(Team team) {
        ...
    }

}

package com.marciob.applications.onleague.model;

class Team {

    private List<Player> players;

    // getters and setters

} 
```

当我生成 jar 文件时，有一个 MyJob 和 Team 类，但是由于在 Team 类的 import 语句中没有找到 Team 类所需的 Player 类作为依赖项。

有人知道这样做的方法吗？查找所有需要的类，包括由于在同一个包中而未在 import 语句中指明的类？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:20:27.370

如前所述`sdoca`，如何打包类是一个谜。由于该类与`Player`该类位于同一个包中`Team`，因此不将它们打包在一起的唯一方法可能是它们位于不同的源文件夹中，即 like`${project}/src/main/java`和`${project}/src/test/java`。

我能想到的（此时）发现目标类所依赖的类的唯一方法是分析字节码，就像[类依赖分析器](http://www.dependency-analyzer.org/)工具一样。

# php - 为什么需要括号

> ID：15980292
> 
> 赞同：1
> 
> 时间：2013-04-12T20:27:05.537
> 
> 标签：php

```
$detect = new Mobile_Detect();
$mobile = $detect->isMobile() and !$detect->isTablet(); 
```

对比

```
$detect = new Mobile_Detect();
$mobile = ($detect->isMobile() and !$detect->isTablet()); 
```

如果我是平板电脑（也被认为是移动设备），那么我在移动设备上的第一个例子就是如此。（没想到）。对于第二个示例，我得到了错误（如预期的那样）。

为什么我需要括号，因为它只是一个和运算符。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:28:38.313

与 = 相比，要获得[更充分的优先级](http://www.php.net/manual/en/language.operators.precedence.php)，请使用`&&`：

```
$mobile = $detect->isMobile() && !$detect->isTablet(); 
```

从[有关逻辑运算符的文档中](http://www.php.net/manual/en/language.operators.logical.php)：

> “and”和“or”运算符的两种不同变体的原因是它们以不同的优先级运行。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T20:28:46.963

您需要它们，因为`=`符号的优先级高于`and`. 使用`&&`，您可能会失去它们。

# jquery - jquery hover改变点击效果

> ID：15980296
> 
> 赞同：1
> 
> 时间：2013-04-12T20:27:40.583
> 
> 标签：jquery, list, click, hover

我有一个无序列表作为菜单，使用 jquery 的悬停效果（不是 css，因为我计划在悬停时对其他元素进行其他更改）。我对单击应用了效果并禁用了悬停以防止它在鼠标移出时发生变化，但我似乎无法完成这个简单的任务。点击效果不会改变背景，我不能再点击，因为它已被解除绑定。

1.  应用悬停效果
2.  对点击的项目应用效果
3.  选择其他项目时删除以前的效果

这里是js

```
$(document).ready(function(){
//hover
$('li').hover(function(){
   $(this).css('background-color', 'blue'); 
}, function(){
    $(this).css('background-color', 'red'); 
});

//click
$('li').click(function(){
    $(this).unbind('mouseenter mouseout');
   $(this).css('backgrond-color', 'blue');
}); 
```

});

这是[jsfiddle](http://jsfiddle.net/6GM7T/7/)链接。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:31:45.713

这有效：

[看演示](http://jsfiddle.net/6GM7T/15/)

```
 $(this).unbind('mouseenter mouseleave'); 
```

hover 是 mouseenter/mouseleave 而不是 mouseout 的别名。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:33:03.487

```
$('li').click(function () {
    $('li').not($(this)).bind('mouseenter', function () {
        $(this).css('background-color', 'blue');
    }).bind('mouseleave', function () {
        $(this).css('background-color', 'red');
    })
    $(this).unbind('mouseenter mouseleave');
    $(this).css('background-color', 'blue');
}); 
```

[**在这里演示**](http://jsfiddle.net/6GM7T/17/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T20:40:03.833

我会在你的样式表中使用 CSS :hover 选择器

```
ul {
    list-style: none;
    padding: 0;
}
ul li {
    height: 20px;
    width: 100px;
    background-color: red;
    padding: 2px;
    margin: 2px;
    text-align: center;
}

ul li:hover {
    background-color: blue;
} 
```

然后点击你可以这样做：

```
$(document).ready(function(){

    //click
    $('li').click(function(){
       $('ul li').css('background-color', '');
       $(this).css('background-color', 'blue');
    });
}); 
```

这是一个更新的 jsFiddle [http://jsfiddle.net/SpvUJ/](http://jsfiddle.net/SpvUJ/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T20:49:13.417

[**工作小提琴**](http://jsfiddle.net/mohammadAdil/6GM7T/18/)- 这可以优化，但现在，它按预期工作

```
$('li').on('click', function (e) {
    $('li').each(function () {
        $(this).css('background-color', 'red');
        $('li').hover(function () {
            $(this).css('background-color', 'blue');
        }, function () {
            $(this).css('background-color', 'red');
        });
    });
    $(this).unbind('mouseenter mouseleave');
    $(this).css('background-color', 'blue');
}); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T20:30:57.403

使用 css 类，它变得更简单：

```
$("li").hover(function() { $(this).addClass("hover"); }, function () { $(this).removeClass("hover"); });
$("li").click(function () { $("li.selected").removeClass("selected"); $(this).addClass("selected"); }); 
```

你的CSS：

```
li { background-color: red; }
li.selected, li.hover { background-color: blue; } 
```

# python - Django：将视图中的日期时间设置为 utc+1

> ID：15980302
> 
> 赞同：9
> 
> 时间：2013-04-12T20:28:14.137
> 
> 标签：python, django, datetime, timezone

我在这里和谷歌都检查了一下，没有找到我正在寻找的确切答案。

我目前正在从事一个 Django 项目，我似乎生活在一个时区概念不被高度重视的地区。这里的时区是 CEST，替代：UTC+1，但两者都不能在我的设置文件中设置。我已经四处寻找如何改变这一点，一种选择是下载并包含一个库，它应该可以做到这一点，经过一些调整。但我想知道是否有更顺畅、更快捷的方法来做到这一点。

`date = datetime.datetime.now()`给我两个小时前的时间。我可以同时使用 UTC 和 GMT，但都不够接近。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-12T20:38:38.300

将评论标记为答案

在您的设置文件中，`USE_TZ=True`应该`TIME_ZONE='CET'`可以解决问题

文档在[这里](https://docs.djangoproject.com/en/dev/ref/settings/#std:setting-TIME_ZONE)

以下是有效[时区列表](http://en.wikipedia.org/wiki/List_of_tz_database_time_zones)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2019-12-15T20:54:42.720

根据您的时区更改 TIME_ZONE 值：

```
UTC-2 = 'Etc/GMT+2'
UTC-2 = 'Etc/GMT+1'
UTC = 'Etc/GMT+0'
UTC+1 = 'Etc/GMT-1'
UTC+2 = 'Etc/GMT-2' 
```

是的，格林威治标准时间后符号倒置。对于其他时区（例如额外半小时），请参阅[TZ 名称](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)。

# .net - 退出时进程在 CRT_INIT 中挂起

> ID：15980308
> 
> 赞同：0
> 
> 时间：2013-04-12T20:28:39.837
> 
> 标签：.net, msvcrt

我有一个控制台应用程序，有时在退出时会挂起。也许千分之一，它会挂起。当它挂起时，只剩下一个线程，它会消耗 100% 的 CPU。

如果我在 ProcessExplorer 中查看进程，当我转到 ProcessExplorer 的“线程”选项卡时，我的进程正常退出。

查看 WinDbg 中的挂起进程，调用堆栈如下所示：

```
.  0  Id: 830.d00 Suspend: 1 Teb: 000007ff`fffde000 Unfrozen
  Start: MyHost!COM+_Entry_Point <PERF> (MyHost+0x71ee) (00000000`002571ee) 
  Priority: 0  Priority class: 16384  Affinity: ff
Child-SP          RetAddr           Call Site
00000000`003ddc50 000007fe`ec3f7646 System_EnterpriseServices_Wrapper_7feec3f0000!CRT_INIT+0x65
00000000`003ddc90 000007fe`f91a4485 System_EnterpriseServices_Wrapper_7feec3f0000!DllMainCRTStartup+0x126
00000000`003ddcd0 000007fe`f93f3281 mscoreei!CorDllMain+0x1f5
00000000`003ddd50 000007fe`f93f32cf MSCOREE!ShellShim__CorDllMain+0xe1
00000000`003ddd80 00000000`77a54371 MSCOREE!CorDllMain_Exported+0x37
00000000`003dddb0 00000000`77a54180 ntdll!LdrShutdownProcess+0x1db
00000000`003dded0 000007fe`f91926d2 ntdll!RtlExitUserProcess+0x90
00000000`003ddf00 000007fe`f9192848 mscoreei!RuntimeDesc::ShutdownAllActiveRuntimes+0x294
00000000`003de1f0 000007fe`f89cc919 mscoreei!CLRRuntimeHostInternalImpl::ShutdownAllRuntimesThenExit+0x14
00000000`003de220 000007fe`f897ef51 clr!EEPolicy::ExitProcessViaShim+0x69
00000000`003de270 000007fe`f8976776 clr!SafeExitProcess+0x9d
00000000`003de4e0 000007fe`f8d56971 clr!EEPolicy::GetFinalAction+0x9a
00000000`003de510 000007fe`f7b5f93b clr!SystemNative::Exit+0x52
00000000`003de560 000007fe`99142057 mscorlib_ni+0xcaf93b
00000000`003de630 000007fe`f87f07f3 0x7fe`99142057
00000000`003de900 000007fe`f87f02fe clr!CallDescrWorkerInternal+0x83
00000000`003de940 000007fe`f87f03c7 clr!CallDescrWorkerWithHandler+0x4a
00000000`003de980 000007fe`f892cdf0 clr!MethodDescCallSite::CallTargetWorker+0x2e6
00000000`003deb30 000007fe`f892d54e clr!RunMain+0x1e7
00000000`003ded00 000007fe`f892d448 clr!Assembly::ExecuteMainMethod+0xb6
00000000`003deff0 000007fe`f892cfc2 clr!SystemDomain::ExecuteMainMethod+0x45e
00000000`003df5b0 000007fe`f892cf0e clr!ExecuteEXE+0x3f
00000000`003df620 000007fe`f8929914 clr!CorExeMainInternal+0xae
00000000`003df6b0 000007fe`f91874e5 clr!CorExeMain+0x14
00000000`003df6f0 000007fe`f93e5b21 mscoreei!CorExeMain+0xe0
00000000`003df740 00000000`7782652d MSCOREE!CorExeMain_Exported+0x57
00000000`003df770 00000000`77a5c521 KERNEL32!BaseThreadInitThunk+0xd
00000000`003df7a0 00000000`00000000 ntdll!RtlUserThreadStart+0x1d 
```

我怎样才能弄清楚这是在做什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-10-11T19:45:11.833

此挂起是由于在 WorkflowApplication 完成之前退出应用程序引起的。我们在收到“Completed”事件后退出，但我们需要等待 Completed 和 Unloaded。

很难追踪，因为挂起不在我们的代码中，也不在 Workflow Foundation 代码中。这是一个循环，等待计数器减到零，但是没有任何东西会减少计数器。我们让微软查看进程转储，他们可以看到它为什么挂起，但找不到导致挂起的事件顺序，因为它只会挂起 1000 次中的 1 次，并且当我们插入检测时，它不会挂起。

我们最终通过在返回之前放置延迟找到了原因，并且我们意识到我们正在收到我们没有看到没有延迟的 Unload 事件。

# .net - 如何从字符串中间执行文化敏感的“开始于”操作？

> ID：15980310
> 
> 赞同：107
> 
> 时间：2013-04-12T20:28:42.477
> 
> 标签：.net, string, unicode

我有一个相对模糊的要求，但感觉*应该*可以使用 BCL。

对于上下文，我正在解析[Noda Time](http://noda-time.googlecode.com)中的日期/时间字符串。我在输入字符串中为我的位置维护一个逻辑光标。因此，虽然完整的字符串可能是“2013 年 1 月 3 日”，但逻辑光标可能位于“J”。

现在，我需要解析月份名称，将其与文化的所有已知月份名称进行比较：

*   文化敏感
*   不区分大小写
*   只是从光标点开始（不是以后；我想看看光标是否在“查看”候选月份名称）
*   迅速地
*   ...然后我需要知道使用了多少个字符

[当前执行此操作的代码](https://code.google.com/p/noda-time/source/browse/src/NodaTime/Text/ValueCursor.cs?r=40f44c857d94f450372d768a8cef835c3ed1ed4f#60)通常使用[`CompareInfo.Compare`](http://msdn.microsoft.com/en-gb/library/f04h1e5y.aspx). 它实际上是这样的（仅用于匹配部分 - 真实的代码更多，但与匹配无关）：

```
internal bool MatchCaseInsensitive(string candidate, CompareInfo compareInfo)
{
    return compareInfo.Compare(text, position, candidate.Length,
                               candidate, 0, candidate.Length, 
                               CompareOptions.IgnoreCase) == 0;
} 
```

但是，这取决于候选对象和我们比较的区域长度相同。大多数时候*都*很好，但在某些特殊情况下就不行了。假设我们有类似的东西：

```
// U+00E9 is a single code point for e-acute
var text = "x b\u00e9d y";
int position = 2;
// e followed by U+0301 still means e-acute, but from two code points
var candidate = "be\u0301d"; 
```

现在我的比较将失败。我可以使用[`IsPrefix`](http://msdn.microsoft.com/en-gb/library/8hksxky5.aspx)：

```
if (compareInfo.IsPrefix(text.Substring(position), candidate,
                         CompareOptions.IgnoreCase)) 
```

但：

*   这需要我创建一个子字符串，我真的宁愿避免。（我将 Noda Time 视为有效的系统库；解析性能对某些客户可能很重要。）
*   它没有告诉我之后将光标前进多远

实际上，我强烈怀疑这不会经常出现......但我真的*很想*在这里做正确的事情。我也非常希望能够在不成为 Unicode 专家或自己实现它的情况下做到这一点:)

（在 Noda Time 中作为[bug 210](https://code.google.com/p/noda-time/issues/detail?id=210)提出，以防有人想遵循任何最终结论。）

我喜欢标准化的想法。我需要详细检查 a) 正确性和 b) 性能。假设我*可以*让它正常工作，我仍然不确定它是否值得全面改变 - 这种事情可能*永远不会*在现实生活中真正出现，但可能会损害我所有用户的表现： (

我还检查了 BCL - 它似乎也没有正确处理这个问题。示例代码：

```
using System;
using System.Globalization;

class Test
{
    static void Main()
    {
        var culture = (CultureInfo) CultureInfo.InvariantCulture.Clone();
        var months = culture.DateTimeFormat.AbbreviatedMonthNames;
        months[10] = "be\u0301d";
        culture.DateTimeFormat.AbbreviatedMonthNames = months;

        var text = "25 b\u00e9d 2013";
        var pattern = "dd MMM yyyy";
        DateTime result;
        if (DateTime.TryParseExact(text, pattern, culture,
                                   DateTimeStyles.None, out result))
        {
            Console.WriteLine("Parsed! Result={0}", result);
        }
        else
        {
            Console.WriteLine("Didn't parse");
        }
    }
} 
```

将自定义月份名称更改为仅具有“bEd”文本值的“床”可以很好地解析。

好的，还有几个数据点：

*   使用`Substring`and的成本很高，`IsPrefix`但并不可怕。在我的开发笔记本电脑上的“2013 年 4 月 12 日星期五 20:28:42”示例中，它将我在一秒钟内可以执行的解析操作的数量从大约 460K 更改为大约 400K。如果可能的话，我宁愿避免这种减速，但这还*不错*。

*   规范化没有我想象的那么可行——因为它在可移植类库中不可用。我可能*只*将它用于非 PCL 构建，从而允许 PCL 构建不太正确。标准化测试的`string.IsNormalized`性能损失 ( 我仍然不确定它是否能满足我的所有需求——例如，在许多文化中，包含“ß”的月份名称应该与“ss”匹配，我相信……而规范化并不能做到这一点。

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2013-04-14T16:22:54.177

我将首先考虑许多<->一个/多个案例映射的问题，并将其与处理不同的规范化形式分开。

例如：

```
x heiße y
  ^--- cursor 
```

匹配`heisse`但随后过多地移动光标 1。和：

```
x heisse y
  ^--- cursor 
```

匹配`heiße`但随后将光标 1 移动得太少。

这将适用于没有简单的一对一映射的任何角色。

您需要知道实际匹配的子字符串的长度。但是`Compare`，`IndexOf`..etc 会丢弃这些信息。使用正则表达式可能是可能的，但实现不会完全大小写折叠，因此 即使在不区分大小写模式下`ß`也不匹配。无论如何，为每个候选人创建新的正则表达式可能会很昂贵。`ss/SS``.Compare``.IndexOf`

最简单的解决方案是仅在内部以大小写折叠形式存储字符串，并与大小写候选进行二进制比较。然后您可以正确移动光标，`.Length`因为光标用于内部表示。您还可以从不必使用`CompareOptions.IgnoreCase`.

不幸的是，没有内置的 case fold 函数，而穷人的 case fold 也不起作用，因为没有完整的 case 映射 - 该`ToUpper`方法不会`ß`变成`SS`.

例如，这适用于 Java（甚至是 Javascript），给定的字符串是 Normal Form C：

```
//Poor man's case folding.
//There are some edge cases where this doesn't work
public static String toCaseFold( String input, Locale cultureInfo ) {
    return input.toUpperCase(cultureInfo).toLowerCase(cultureInfo);
} 
```

有趣的是，Java 的忽略大小写比较不像 C# 那样进行完全大小写折叠`CompareOptions.IgnoreCase`。所以他们在这方面是相反的：Java 做了完整的大小写映射，但是简单的大小写折叠——C# 做了简单的大小写映射，但是完整的大小写折叠。

因此，您可能需要一个 3rd 方库在使用它们之前对您的字符串进行大小写折叠。

* * *

在做任何事情之前，您必须确保您的字符串是正常的 C 格式。您可以使用针对拉丁脚本优化的初步快速检查：

```
public static bool MaybeRequiresNormalizationToFormC(string input)
{
    if( input == null ) throw new ArgumentNullException("input");

    int len = input.Length;
    for (int i = 0; i < len; ++i)
    {
        if (input[i] > 0x2FF)
        {
            return true;
        }
    }

    return false;
} 
```

这会产生误报，但不会产生误报，我不希望在使用拉丁脚本字符时它会减慢 460k 解析/秒，即使它需要在每个字符串上执行。对于误报，您将使用`IsNormalized`获得真正的负/正，并且仅在必要时进行标准化。

* * *

所以综上所述，处理是先保证normal form C，然后case fold。对已处理的字符串进行二进制比较，并在当前移动光标时移动光标。

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2013-04-17T14:18:11.193

看看这是否符合要求..：

```
public static partial class GlobalizationExtensions {
    public static int IsPrefix(
        this CompareInfo compareInfo,
        String source, String prefix, int startIndex, CompareOptions options
        ) {
        if(compareInfo.IndexOf(source, prefix, startIndex, options)!=startIndex)
            return ~0;
        else
            // source is started with prefix
            // therefore the loop must exit
            for(int length2=0, length1=prefix.Length; ; )
                if(0==compareInfo.Compare(
                        prefix, 0, length1, 
                        source, startIndex, ++length2, options))
                    return length2;
    }
} 
```

`compareInfo.Compare`只执行`source`一次`prefix`；如果没有，则`IsPrefix`返回`-1`；否则， 中使用的字符长度`source`。

但是，除了以下情况下的增量`length2`之外，我不知道：`1`

```
var candidate="ßssß\u00E9\u0302";
var text="abcd ssßss\u0065\u0301\u0302sss";

var count=
    culture.CompareInfo.IsPrefix(text, candidate, 5, CompareOptions.IgnoreCase); 
```

* * *

**更新**：

我试图提高一点性能，但无法证明以下代码中是否存在错误：

```
public static partial class GlobalizationExtensions {
    public static int Compare(
        this CompareInfo compareInfo,
        String source, String prefix, int startIndex, ref int length2, 
        CompareOptions options) {
        int length1=prefix.Length, v2, v1;

        if(0==(v1=compareInfo.Compare(
            prefix, 0, length1, source, startIndex, length2, options))
            ) {
            return 0;
        }
        else {
            if(0==(v2=compareInfo.Compare(
                prefix, 0, length1, source, startIndex, 1+length2, options))
                ) {
                ++length2;
                return 0;
            }
            else {
                if(v1<0||v2<0) {
                    length2-=2;
                    return -1;
                }
                else {
                    length2+=2;
                    return 1;
                }
            }
        }
    }

    public static int IsPrefix(
        this CompareInfo compareInfo,
        String source, String prefix, int startIndex, CompareOptions options
        ) {
        if(compareInfo.IndexOf(source, prefix, startIndex, options)
                !=startIndex)
            return ~0;
        else
            for(int length2=
                    Math.Min(prefix.Length, source.Length-(1+startIndex)); ; )
                if(0==compareInfo.Compare(
                        source, prefix, startIndex, ref length2, options))
                    return length2;
    }
} 
```

我用特殊情况进行了测试，比较到大约 3。

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2014-03-19T17:00:20.317

这实际上是可能的，无需规范化且无需使用`IsPrefix`.

我们需要比较相同数量的**文本元素**而不是相同数量的字符，但仍然返回匹配字符的数量。

我[在 Noda Time 中从 ValueCursor.cs](https://code.google.com/p/noda-time/source/browse/src/NodaTime/Text/ValueCursor.cs?r=40f44c857d94f450372d768a8cef835c3ed1ed4f#60)`MatchCaseInsensitive`创建了该方法的副本，并对其稍作修改，以便可以在静态上下文中使用它：

```
// Noda time code from MatchCaseInsensitive in ValueCursor.cs
static int IsMatch_Original(string source, int index, string match, CompareInfo compareInfo)
{
    unchecked
    {
        if (match.Length > source.Length - index)
        {
            return 0;
        }

        // TODO(V1.2): This will fail if the length in the input string is different to the length in the
        // match string for culture-specific reasons. It's not clear how to handle that...
        if (compareInfo.Compare(source, index, match.Length, match, 0, match.Length, CompareOptions.IgnoreCase) == 0)
        {
            return match.Length;
        }

        return 0;
    }
} 
```

（仅供参考，这是您所知道的无法正确比较的代码）

该方法的以下变体使用框架提供的[StringInfo.GetNextTextElement 。](http://msdn.microsoft.com/en-us/library/system.globalization.stringinfo.getnexttextelement%28v=vs.110%29.aspx)这个想法是逐个文本元素比较文本元素以找到匹配项，如果找到，则返回源字符串中匹配字符的实际数量：

```
// Using StringInfo.GetNextTextElement to match by text elements instead of characters
static int IsMatch_New(string source, int index, string match, CompareInfo compareInfo)
{
    int sourceIndex = index;
    int matchIndex = 0;

    // Loop until we reach the end of source or match
    while (sourceIndex < source.Length && matchIndex < match.Length)
    {
        // Get text elements at the current positions of source and match
        // Normally that will be just one character but may be more in case of Unicode combining characters
        string sourceElem = StringInfo.GetNextTextElement(source, sourceIndex);
        string matchElem = StringInfo.GetNextTextElement(match, matchIndex);

        // Compare the current elements.
        if (compareInfo.Compare(sourceElem, matchElem, CompareOptions.IgnoreCase) != 0)
        {
            return 0; // No match
        }

        // Advance in source and match (by number of characters)
        sourceIndex += sourceElem.Length;
        matchIndex += matchElem.Length;
    }

    // Check if we reached end of source and not end of match
    if (matchIndex != match.Length)
    {
        return 0; // No match
    }

    // Found match. Return number of matching characters from source.
    return sourceIndex - index;
} 
```

至少根据我的测试用例（基本上只是测试您提供的字符串的几个变体：`"b\u00e9d"`和`"be\u0301d"`），该方法工作得很好。

但是，[GetNextTextElement](http://msdn.microsoft.com/en-us/library/system.globalization.stringinfo.getnexttextelement%28v=vs.110%29.aspx)方法会为每个文本元素创建一个子字符串，因此此实现需要大量子字符串比较——这将对性能产生影响。

因此，我创建了另一个不使用[GetNextTextElement](http://msdn.microsoft.com/en-us/library/system.globalization.stringinfo.getnexttextelement%28v=vs.110%29.aspx)而是跳过 Unicode 组合字符以查找字符中的实际*匹配长度*的变体：

```
// This should be faster
static int IsMatch_Faster(string source, int index, string match, CompareInfo compareInfo)
{
    int sourceLength = source.Length;
    int matchLength = match.Length;
    int sourceIndex = index;
    int matchIndex = 0;

    // Loop until we reach the end of source or match
    while (sourceIndex < sourceLength && matchIndex < matchLength)
    {
        sourceIndex += GetTextElemLen(source, sourceIndex, sourceLength);
        matchIndex += GetTextElemLen(match, matchIndex, matchLength);
    }

    // Check if we reached end of source and not end of match
    if (matchIndex != matchLength)
    {
        return 0; // No match
    }

    // Check if we've found a match
    if (compareInfo.Compare(source, index, sourceIndex - index, match, 0, matchIndex, CompareOptions.IgnoreCase) != 0)
    {
        return 0; // No match
    }

    // Found match. Return number of matching characters from source.
    return sourceIndex - index;
} 
```

该方法使用以下两个助手：

```
static int GetTextElemLen(string str, int index, int strLen)
{
    bool stop = false;
    int elemLen;

    for (elemLen = 0; index < strLen && !stop; ++elemLen, ++index)
    {
        stop = !IsCombiningCharacter(str, index);
    }

    return elemLen;
}

static bool IsCombiningCharacter(string str, int index)
{
    switch (CharUnicodeInfo.GetUnicodeCategory(str, index))
    {
        case UnicodeCategory.NonSpacingMark:
        case UnicodeCategory.SpacingCombiningMark:
        case UnicodeCategory.EnclosingMark:
            return true;

        default:
            return false;
    }
} 
```

我没有做过任何基准测试，所以我真的不知道更快的方法是否真的更快。我也没有进行任何扩展测试。

但这应该回答您关于如何对可能包含 Unicode 组合字符的字符串执行文化敏感子字符串匹配的问题。

这些是我使用过的测试用例：

```
static Tuple<string, int, string, int>[] tests = new []
{
    Tuple.Create("x b\u00e9d y", 2, "be\u0301d", 3),
    Tuple.Create("x be\u0301d y", 2, "b\u00e9d", 4),

    Tuple.Create("x b\u00e9d", 2, "be\u0301d", 3),
    Tuple.Create("x be\u0301d", 2, "b\u00e9d", 4),

    Tuple.Create("b\u00e9d y", 0, "be\u0301d", 3),
    Tuple.Create("be\u0301d y", 0, "b\u00e9d", 4),

    Tuple.Create("b\u00e9d", 0, "be\u0301d", 3),
    Tuple.Create("be\u0301d", 0, "b\u00e9d", 4),

    Tuple.Create("b\u00e9", 0, "be\u0301d", 0),
    Tuple.Create("be\u0301", 0, "b\u00e9d", 0),
}; 
```

元组值是：

1.  源字符串（干草堆）
2.  源中的起始位置。
3.  匹配字符串（针）。
4.  预期的匹配长度。

在这三种方法上运行这些测试会产生以下结果：

```
Test #0: Orignal=BAD; New=OK; Faster=OK
Test #1: Orignal=BAD; New=OK; Faster=OK
Test #2: Orignal=BAD; New=OK; Faster=OK
Test #3: Orignal=BAD; New=OK; Faster=OK
Test #4: Orignal=BAD; New=OK; Faster=OK
Test #5: Orignal=BAD; New=OK; Faster=OK
Test #6: Orignal=BAD; New=OK; Faster=OK
Test #7: Orignal=BAD; New=OK; Faster=OK
Test #8: Orignal=OK; New=OK; Faster=OK
Test #9: Orignal=OK; New=OK; Faster=OK 
```

最后两个测试是测试源字符串比匹配字符串短的情况。在这种情况下，原始（野田时间）方法也将成功。

# html - 将页脚锁定到我的内容包装器的底部

> ID：15980313
> 
> 赞同：0
> 
> 时间：2013-04-12T20:28:48.150
> 
> 标签：html, css, footer

因此，正如标题所述，尝试将此页脚锁定在内容包装器的底部。我读过的所有内容都说使用底部 0，但这会将其锁定到窗口的底部，而不是我页面周围的 div。任何建议表示赞赏，非常感谢。HTML

```
<div id='contentwrapper'>
  (theres stuff in here but it's negligible for now)
  <div id='footer'>
  <div id='footertext'>
  Blahblahblahblahblah
  </div>
  <div id='footerlogo'>
  <img src='companylogo.png' height='80px'>
  </div>
  </div>
</div> 
```

CSS

```
#footertext{
 position:absolute;
 bottom:0;
 right:0
 }
 #footerlogo{
 position:absolute;
 bottom:0;
 left:0;
 }
 #footer{
 position:absolute;
 bottom:0;
 z-index:300;
 text-align:right;
 width:800px;
 //padding-top:5px;
 padding-bottom:5px;
 min-height:40px;
 color:black;
 background: rgb(173, 194, 255); /* Fall-back for browsers that don't support rgba */
 background: rgba(173, 194, 255, .3);
 } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:30:51.913

确保你的内容包装器有一个 postion: relative 设置，否则绝对定位的元素没有什么可关闭的。

# java - Google App Engine + Jersey + JSP 结果为 NOT_FOUND

> ID：15980315
> 
> 赞同：0
> 
> 时间：2013-04-12T20:29:01.760
> 
> 标签：java, google-app-engine, jsp, jersey, jax-rs

目前我正在开发我的第一个 Google App Engine 应用程序。我将 Jersey (JAX-RS) 和 JSP 2.0 与自定义标签结合使用，以将布局与应用程序逻辑分开。

我创建的应用程序在本地沙箱中运行得非常好（使用 Maven appengine:devserver 开始），但是当我在 Google 上运行完全相同的代码时，我得到了相同调用的“错误：NOT_FOUND”错误。GAE 的日志说：

```
2013-04-12 12:37:38.520 /rest/home 404 ...
2013-04-12 12:37:34.034
  com.sun.jersey.api.core.PackagesResourceConfig init: Scanning for root resource and provider classes in the packages:
    xxx.rest
2013-04-12 12:37:34.308
  com.sun.jersey.api.core.ScanningResourceConfig logClasses: Root resource classes found:
    class xxx.rest.HomeResource
2013-04-12 12:37:34.308
  com.sun.jersey.api.core.ScanningResourceConfig init: No provider classes found.
2013-04-12 12:37:34.619
  com.sun.jersey.server.impl.application.WebApplicationImpl _initiate: Initiating Jersey application, version 'Jersey: 1.17.1 02/28/2013 12:47 PM'
2013-04-12 12:37:38.422
  xxx.rest.HomeResource <init>: HomeResource constructor
2013-04-12 12:37:38.427
  xxx.rest.HomeResource displayHomepage: Display home 
```

最后两行显示 HomeResource 在那里并且被调用。它看起来像这样：

```
@Path("/home")
public class HomeResource {

    private Log log = LogFactory.getLog(HomeResource.class);

    public HomeResource() {
        log.info("HomeResource constructor");
    }

    @GET
    @Produces(MediaType.TEXT_HTML)
    public Response displayHomepage() {
        log.info("Display home");
        return Response.ok(new Viewable("/home")).build();
        //return new Viewable("/home");
    }

} 
```

JSP 文件位于 中`WEB-INF/views`，自定义标记位于 中`WEB-INF/tags`，如下所示`web.xml`：

```
<servlet>
    <servlet-name>Test</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>xxx.rest</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.config.property.JSPTemplatesBasePath</param-name>
        <param-value>/WEB-INF/views/</param-value>
    </init-param>
    <init-param>
        <param-name>com.sun.jersey.config.property.WebPageContentRegex</param-name>
        <param-value>/(img|js|css|(WEB-INF/tags)|(WEB-INF/views))/.*</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>Test</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

标记的位置在 JSP 中指定为：

```
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="t" tagdir="/WEB-INF/tags" %> 
```

这应该是正确的，因为 JSP 编译时没有问题。

你能指出任何可以帮助我解决这个问题的方向吗？提前非常感谢！

**编辑：** 它似乎与 JSP 模板的位置有关。当我用`Viewable`静态替换时，`String`一切都按预期工作。JSP 是如何被`WEB-INF/views`引用的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T19:52:04.417

我终于破解了它......它确实与`Viewable`. 我将其更改为：

```
@Path("/hello")
public class HelloResource {

    @GET
    @Produces(MediaType.TEXT_HTML)
    public Response displayHello() {
        return Response.ok(new Viewable("/views/hello")).build();
    }

} 
```

此外，我将`views`包含 JSP 的文件夹移至父级，`WEB-INF`并从中删除了一些行`web.xml`：

```
<servlet>
    <servlet-name>Test</servlet-name>
    <servlet-class>com.sun.jersey.spi.container.servlet.ServletContainer</servlet-class>
    <init-param>
        <param-name>com.sun.jersey.config.property.packages</param-name>
        <param-value>xxx.rest</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
</servlet>

<servlet-mapping>
    <servlet-name>Test</servlet-name>
    <url-pattern>/rest/*</url-pattern>
</servlet-mapping> 
```

现在它就像一个魅力！

# sql - 触发错误：当前事务无法提交，无法支持写入日志文件的操作

> ID：15980318
> 
> 赞同：13
> 
> 时间：2013-04-12T20:29:02.853
> 
> 标签：sql, sql-server, sql-server-2008, sql-server-2008-r2

因此，当 sp_SomeProc 尝试执行无效的 sql 语句时，我从 SQL Server 收到以下错误消息。我得到错误：

```
The current transaction cannot be committed and cannot support operations that write to the log file. 
```

**关于我做错了什么的任何想法？（这只是我为模仿问题而创建的一个示例，所以请不要“你为什么这样做？”、“这有安全隐患”等。）**

* * *

所以我的桌子看起来像：

```
CREATE TABLE tSOMETABLE
(  
    RecID INT NOT NULL IDENTITY(1,1)
    Val VARCHAR(20),
CONSTRAINT [PK_tSOMETABLE] PRIMARY KEY CLUSTERED 
(
    RecID ASC
)
) 
```

所以在我的触发器中，我有：

```
CREATE TRIGGER [dbo].[TR_tSOMETABLE_INSERT]     
    ON [dbo].[tSOMETABLE]   
    FOR INSERT  
AS      
SET NOCOUNT ON  
BEGIN   
         BEGIN
            SELECT * INTO #temp FROM INSERTED

            WHILE EXISTS (SELECT 1 FROM #temp)
            BEGIN
                DECLARE @RecID INT      
                SELECT @RecID = RecID
                FROM #temp t
                EXEC dbo.sp_SomeProc @EventType = 'ON INSERT', @RecID = @RecID
                DELETE #temp WHERE @RecID = RecID
            END         
        END   
END 
```

现在 sp_SomeProc 的代码如下所示：

```
CREATE PROC sp_SomeProc 
(
    @EventType VARCHAR(50),
    @RecID INT,
    @Debug BIT = 0
)
AS
BEGIN
    SET NOCOUNT ON

    DECLARE @ProcTable TABLE 
    (
        RecID INT NOT NULL IDENTITY(1,1),
        Cmd VARCHAR(MAX)
    )

    INSERT INTO @ProcTable(Cmd)
      SELECT 'EXEC sp_who'
      UNION
      SELECT 'EXEC sp_SomeStoredProcThatDoesntExist'

    DECLARE  @RecID INT  
    SELECT @RecID = MIN(RecID) FROM @ProcTable
    WHILE @RecID IS NOT NULL
    BEGIN  
        DECLARE @sql VARCHAR(MAX)
        SELECT @sql = cmd FROM @ProcTable WHERE RecID = @RecID
        IF @Debug = 1
            PRINT @sql
        ELSE
            BEGIN
                BEGIN TRY      
                    EXEC(@sql)
                END TRY
                BEGIN CATCH
                    DECLARE @Msg VARCHAR(MAX), @ErrorNumber INT, @ErrorSeverity INT, @ErrorState int, @ErrorProcedure nvarchar(256), @ErrorLine int, @ErrorMessage nvarchar(MAX)
                    SELECT @Msg = 'Failed While Executing: ' + @sql  
                    SELECT @ErrorNumber = ERROR_NUMBER(), @ErrorSeverity = ERROR_SEVERITY(), @ErrorState = ERROR_STATE(), @ErrorProcedure = ERROR_PROCEDURE(), @ErrorLine = ERROR_LINE(), @ErrorMessage = ERROR_MESSAGE()
                    -- DO SOME MORE STUFF HERE AND THEN ...
                    RAISERROR(@ErrorMessage, @ErrorSeverity, @ErrorState)
                END CATCH 
            END
        SELECT @RecID = MIN(RecID) FROM @ProcTable WHERE RecID > @RecID
    END  
END 
```

所以为了测试我尝试：

```
INSERT INTO tSOMETABLE(Val)
SELECT 'Hello' 
```

* * *

## 回答 #1

> 赞同：47
> 
> 时间：2013-04-13T06:13:32.153

当您在事务中使用 try/catch 块时会发生此错误。让我们考虑一个简单的例子：

```
SET XACT_ABORT ON

IF object_id('tempdb..#t') IS NOT NULL
    DROP TABLE #t
CREATE TABLE #t (i INT NOT NULL PRIMARY KEY)

BEGIN TRAN
    INSERT INTO #t (i) VALUES (1)
    INSERT INTO #t (i) VALUES (2)
    INSERT INTO #t (i) VALUES (3)
    INSERT INTO #t (i) VALUES (1) -- dup key error, XACT_ABORT kills the batch
    INSERT INTO #t (i) VALUES (4) 

COMMIT  TRAN
SELECT * FROM #t 
```

当第四次插入导致错误时，批处理终止并且事务回滚。到目前为止没有任何惊喜。

现在让我们尝试使用 TRY/CATCH 块来处理该错误：

```
SET XACT_ABORT ON
IF object_id('tempdb..#t') IS NOT NULL
    DROP TABLE #t
CREATE TABLE #t (i INT NOT NULL PRIMARY KEY)

BEGIN TRAN
    INSERT INTO #t (i) VALUES (1)
    INSERT INTO #t (i) VALUES (2)
    BEGIN TRY
        INSERT INTO #t (i) VALUES (3)
        INSERT INTO #t (i) VALUES (1) -- dup key error
    END TRY
    BEGIN CATCH
        SELECT ERROR_MESSAGE()
    END CATCH  
    INSERT INTO #t (i) VALUES (4)
    /* Error the Current Transaction cannot be committed and 
    cannot support operations that write to the log file. Roll back the transaction. */

COMMIT TRAN
SELECT * FROM #t 
```

我们发现了重复键错误，但除此之外，我们的情况并没有好转。我们的批处理仍然被终止，我们的事务仍然被回滚。原因其实很简单：

**TRY/CATCH 块不影响事务。**

由于 XACT_ABORT 为 ON，一旦发生重复键错误，事务就注定失败。它已经完成了。它受了致命伤。它被击穿了心脏……错误是罪魁祸首。TRY/CATCH 给 SQL Server 带来了一个坏名声。（对不起，无法抗拒）

换句话说，它**永远不会**提交并且**总是**会被回滚。TRY/CATCH 块所能做的就是打破尸体的坠落。我们可以使用**XACT_STATE()**函数来查看我们的事务是否可提交。如果不是，唯一的选择是回滚事务。

```
SET XACT_ABORT ON -- Try with it OFF as well.
IF object_id('tempdb..#t') IS NOT NULL
    DROP TABLE #t
CREATE TABLE #t (i INT NOT NULL PRIMARY KEY)

BEGIN TRAN
    INSERT INTO #t (i) VALUES (1)
    INSERT INTO #t (i) VALUES (2)

    SAVE TRANSACTION Save1
    BEGIN TRY
        INSERT INTO #t (i) VALUES (3)
        INSERT INTO #t (i) VALUES (1) -- dup key error
    END TRY
    BEGIN CATCH
        SELECT ERROR_MESSAGE()
        IF XACT_STATE() = -1 -- Transaction is doomed, Rollback everything.
            ROLLBACK TRAN
        IF XACT_STATE() = 1 --Transaction is commitable, we can rollback to a save point
            ROLLBACK TRAN Save1
    END CATCH  
    INSERT INTO #t (i) VALUES (4)

IF @@TRANCOUNT > 0
    COMMIT TRAN
SELECT * FROM #t 
```

触发器总是在事务的上下文中执行，因此如果您可以避免在其中使用 TRY/CATCH，事情就会简单得多。

为了解决您的问题，CLR 存储过程可以在单独的连接中连接回 SQL Server 以执行动态 SQL。您获得了在新事务中执行代码的能力，并且错误处理逻辑在 C# 中既易于编写又易于理解。

# iphone - 行的选择器视图没有调用一段时间

> ID：15980323
> 
> 赞同：0
> 
> 时间：2013-04-12T20:29:29.617
> 
> 标签：iphone, ios, objective-c, uipickerview

我以编程方式将我的选择器视图添加到我的主视图中。如果我触摸选择器视图，它会触摸测试滚动而不是选择器视图，因此我无法从选择器视图中选择一行。

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    viewForValueForPicker = [[UIView alloc]initWithFrame:CGRectMake(125, txtvisitReason.frame.origin.y+txtvisitReason.frame.size.height, 180, 160)];
    UIToolbar *toolBar = [[UIToolbar alloc]initWithFrame:CGRectMake(125, 0, 180, 30)];
    toolBar.barStyle = UIBarStyleBlackOpaque;
    UIBarButtonItem *btn = [[[UIBarButtonItem alloc] initWithBarButtonSystemItem:UIBarButtonSystemItemDone target:self action:@selector(doneBtnPressToGetValue)]autorelease];
    [toolBar setItems:[NSArray arrayWithObject:btn]];
    [viewForValueForPicker addSubview:toolBar];

    pickerView = [[UIPickerView alloc] initWithFrame:CGRectMake(125, 30, 180, 140)];
    pickerView.delegate=self;
    pickerView.dataSource=self;
    pickerView.showsSelectionIndicator=YES;
    [viewForValueForPicker addSubview:pickerView];
    [testscroll addSubview:viewForValueForPicker];// test scroll is my scroll view object i added scroll view to main view 
    [txtvisitReason resignFirstResponder]; 
```

}

```
- (BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch{
   if(touch.view==testscroll){
        viewForValueForPicker.hidden=YES;
        return YES; //If its the main view accept the touch
   }    else
   return NO; //Otherwise(say tableview) don't consume the touch. 
```

}

我在这里实现了 Tapgesture 委托方法，即使我触摸选择器视图，它也会显示主视图。如果触摸选择器视图 touch.view 显示测试滚动并且我的选择器消失。

# php - 通过正则表达式搜索字符串？有更好的方法吗？

> ID：15980325
> 
> 赞同：-4
> 
> 时间：2013-04-12T20:29:36.373
> 
> 标签：php, regex

我想在 php 中搜索一个文本文件以获取特殊条件：当第一次匹配字符串时，开始收集文本，当第二次匹配相同字符串时，停止收集文本。

例如。如果字符串是“世界”并在下面的行中搜索：“我们的世界有 196 个国家，但其中只有 192 个是联合国成员。我们的世界是非凡的。

然后我想要这个文本：'有196个国家，但其中只有192个是联合国的成员。我们的'在匹配的变量中。

我在 preg_match() 中尝试了很多正则表达式，但没有结果，有没有更好的方法呢？

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:32:14.347

使用后视和前瞻：

```
/(?<=world ).*?(?= world)/ 
```

在此处查看实际操作：[http ://regex101.com/r/tW2bT8](http://regex101.com/r/tW2bT8)

* * *

...这是一个使用 PHP 的演示： http: [//codepad.viper-7.com/DucTKE](http://codepad.viper-7.com/DucTKE)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T22:01:27.230

```
$lines = file($filename);
$keep = false;
$keepTrailing = true; //Flag that decides wether to keep trailing capture segments or not.
$extractions = array();
$current = '';
foreach($lines as $line){
    $parts = preg_split('/\bworld\b/i', $line);
    $current .= $parts[0];
    for ($i = 1; $i<count($parts); $i++){
        if ($keep) $extractions[] = $current;
        $keep = !$keep;
        $current = $parts[$i];
    }
}
if ($keep && $keepTrailing)
    $extractions[] = $current;
var_dump($extractions); 
```

[这是在行动。](http://ideone.com/0kqGRg)

基本上，通过遍历文件一次，您可以简单地拆分关键字（“世界”）上的每一行 - 我使用`\b`锚来确保它不会拆分为“世俗”或其他垃圾。我已经包含一个标志来决定是否保留尾随捕获段。你不一定需要那个，但它可能会有所帮助。该解决方案唯一不直观的部分是将当前捕获保存在一个`$current`变量中，这基本上允许您跨多个换行符继续扫描。

你知道，这很容易变成一个函数。

```
function capturingSearchWithKeyword($filename, $keyword, $keepTrailing = true, $trim = false){
    $lines = file($filename);
    $keep = false;
    $extractions = array();
    $current = '';
    foreach($lines as $line){
        $parts = preg_split("/\\b$keyword\\b/i", $line);
        $current .= $parts[0];
        for ($i = 1; $i<count($parts); $i++){
            if ($keep){
                if ($trim) $current = trim($current);
                $extractions[] = $current;
            }
            $keep = !$keep;
            $current = $parts[$i];
        }
    }
    if ($keep && $keepTrailing)
        $extractions[] = $current;
    return $extractions
} 
```

[一探究竟...](http://ideone.com/WfYX4w)

# java - 读取 Apache POI 文件并通过 JPA 持久化，但实体的持久性直到方法结束才会发生

> ID：15980327
> 
> 赞同：2
> 
> 时间：2013-04-12T20:29:45.243
> 
> 标签：java, apache, jpa, ejb-3.0, apache-poi

嗨，我试图跟踪我的 Apache POI 读取 excel 文件并导入数据库。我将导入进度（% 进度、时间等）保存到数据库中的单独表中，以便我可以查询数据导入进度。

我的问题是实体管理器只保留一次“进度”状态，那是在将数据加载到数据库中的方法的末尾。

**爪哇**

```
 @Inject
        private EntityManager em;

    public void importTheData(String path){

        try 
        {

            FileInputStream file = new FileInputStream(path);
            wb = WorkbookFactory.create(file);
        } catch (Exception ex) {}   

        Sheet sheet = wb.getSheetAt(0);

        for (int i = 1; i <= sheet.getLastRowNum(); i++) {

            try {
                row = sheet.getRow(i);

                Table theTable = new Table();
                theTable.setDate(row.getCell(0).getDateCellValue());
    theTable.setDate1(row.getCell(1).getDateCellValue());
    theTable.setDate2(row.getCell(2).getDateCellValue());

    bdt.add(theTable);

}

public void importtheTable() {

    for(int i=0; i<bdt.size();i++)
    {

        em.persist(bdt.get(i));

        if(i%2000 == 0){
            em.flush();
            em.clear();
        }
    }

    } 
```

方法 setProgress(path,(100* i/theTable.getLastRowNum())) 尝试将进度状态保存到单独的表中，但这只会发生一次（最后）

有人可以帮帮我吗？

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:36:54.623

这取决于事务的范围，您是否使用注释来定义它？如果是，这就解释了为什么最后一切都完成了。

如果您需要，您将需要在此方法中开始/结束事务。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-15T14:22:19.420

这取决于您创建的 entityManger。

如果你有像 entityManager.gettransaction.commit() 这样的循环编写代码，那么你可以在数据库中获取更新。

但是如果你在循环之后完成了它，那么它将一次全部提交。

您在方法上指定的交易类型也很重要。

# c# - 如何让我的 getter 从属性/元数据返回数据？

> ID：15980329
> 
> 赞同：-2
> 
> 时间：2013-04-12T20:29:51.163
> 
> 标签：c#, .net, asp.net-mvc-4, attributes

因此，如果我有一个具有如下属性的对象：

```
[MyCustomAttribute("somevalue")]
public string PropertyName { get; set; } 
```

是否可以让我的 getter 从属性内的属性返回字符串？在这种特殊情况下，`MyCustomAttribute`源自`DisplayNameProperty`并且我正在尝试返回`DisplayName`

我该怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:42:50.197

假设您的意思是，出于某种原因，您要么希望从 getter 返回 DisplayNameAttribute，要么将其用于 setter 中的某些内容。

那么这应该做

```
MemberInfo property = typeof(YourClass).GetProperty("PropertyName");   
var attribute = property.GetCustomAttributes(typeof(MyCustomAttribute), true)
      .Cast<MyCustomAttribute>.Single();
string displayName = attribute.DisplayName; 
```

您的问题措辞不够清楚，无法给出更好的答案。正如人们在上面所说的那样-二传手不返回任何东西。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:41:17.130

我只是想把我的实际实现放在这里，希望对某人有所帮助。让我知道您是否发现不足或需要改进的地方。

```
// Custom attribute might be something like this
[AttributeUsage(AttributeTargets.Property, AllowMultiple = false)]
public class BrandedAttribute : Attribute
{
    private readonly ResourceManager _rm;
    private readonly string _key;

    public BrandedAttribute(string resourceKey)
    {
        _rm = new ResourceManager("brand", typeof(BrandedAttribute).Assembly);
        _key = resourceKey;
    }

    public override string BrandText
    {
        get
        {
            // do what you need to do in order to generate the right text
            return brandA_resource.ResourceManager.GetString(_key);     
        }
    }

    public override string ToString()
    {
        return DisplayName;
    }
}

// extension
public static string AttributeToString<T>(this object obj, string propertyName)
    where T: Attribute
{
    MemberInfo property = obj.GetType().GetProperty(propertyName);

    var attribute = default(T);
    if (property != null)
    {
        attribute = property.GetCustomAttributes(typeof(T), true)
                            .Cast<T>().Single();
    }
    // I chose to do this via ToString() just for simplicity sake
    return attribute == null ? string.Empty : attribute.ToString();
}

// usage
public MyClass
{
    [MyCustom]
    public string MyProperty
    {
        get
        {
            return this.AttributeToString<MyCustomAttribute>("MyProperty");
        }
    }
} 
```

# jquery - 使用 facebook url 问题登录

> ID：15980343
> 
> 赞同：0
> 
> 时间：2013-04-12T20:30:44.403
> 
> 标签：jquery, facebook, oauth-2.0

我环顾四周并搜索，但似乎无法找到答案。我在我的网站上使用 facebook 按钮登录，并且根据我阅读的内容在 developer.facebook.com 上设置了该应用程序。但不知道为什么我一直想出这个，错误：

```
Given URL is not allowed by the Application configuration.: One or more of the given URLs is not allowed by the App's settings. It must match the Website URL or Canvas URL, or the domain must be a subdomain of one of the App's domains. 
```

Facebook应用程序中的设置：

```
Basic Settings:
   App domains: www.olympusmons.com

Select how your app integrates with Facebook
   Website with Facebook Login
       Site URL:  http://www.olympusmons.com 
```

现在我尝试登录的网址是[http://www.olympusmons.com/xxx/](http://www.olympusmons.com/xxx/) 我按照本[教程](http://thinkdiff.net/facebook/new-javascript-sdk-oauth-2-0-based-fbconnect-tutorial/)更改了 appid，不知道我还有什么做错了..

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T00:45:06.140

好的，以防其他人需要这个：

指定应用程序域时，您必须使用所有可能的方法：

```
Basic Settings:
   App domains: www.xxxx.com, xxxx.com 
```

# java - 更改片段视图无效

> ID：15980348
> 
> 赞同：0
> 
> 时间：2013-04-12T20:30:53.230
> 
> 标签：java, android

我使用以下代码更改片段的视图

```
public void updateView() {
    View newView = LayoutInflater.from(mActivity).inflate(R.layout.fragment_lobby, (ViewGroup)mActivity.findViewById(mContainerId),
            false);

    ViewGroup container = (ViewGroup)mActivity.findViewById(mContainerId);
    container.removeAllViews();

    container.addView(newView);
} 
```

直到 addView 一切正常，但是没有添加新视图，片段保持为空。

如果我将代码更改为首先显示 R.layout.fragment_lobby 并在 updateView 中将其更改为当前的第一个内容，那么我会看到 R.layout.fragment_lobby 正确，并且它在 updateView 中再次使容器无效。

在我发现的所有其他帖子中，关于更新或修改片段的视图对象是建议的代码，但它对我不起作用。如果您需要一些 xml，请告诉我，它们都是 LinearLayout 的，并且内容（用于测试）几乎相同，只是控件不同，没什么花哨的。

# if-statement - MASM 中的 if 语句期间出现无效指令操作数错误

> ID：15980349
> 
> 赞同：0
> 
> 时间：2013-04-12T20:30:53.540
> 
> 标签：if-statement, assembly, x86, masm, irvine32

我对 MASM 非常陌生，并且在使用 if 语句时遇到了麻烦。我得到的编译错误是：RNG.asm(61) : error A2070: invalid instruction operands。（第 61 行从下往上 5 个）

这是我的代码：

```
;=====================================================================
; RNG.asm
;
; Reads in: a low int, a high int, and the number of times to generate
; a random number inbetween the low and high value.
;
;Author: Ian Johnson
;Date Created: 4/12/13
;=====================================================================
.386
.model flat,stdcall
.stack

include \masm32\include\irvine32.inc
include \masm32\include\kernel32.inc
includelib \masm32\lib\irvine32.lib
includelib \masm32\lib\kernel32.lib

.data
  min   BYTE "Please enter the min value:"           , 10,0
  max   BYTE "Please enter the max value:"           , 10,0
  times BYTE "please enter the number of iterations:", 10,0

  minInt   DWORD ?          ;minimum value
  maxInt   DWORD ?          ;max value
  timesInt DWORD ?          ;number of iterations
  prevInt  DWORD ?          ;previous random number or initial value
  count    DWORD ?

.code
  main proc   ;start of main procedure
    mov EDX, offset min     ;move min to EDX
    call WriteString        ;print min string
    call ReadInt            ;readin int to EAX
    mov minInt, EAX         ;store EAX value in minInt

    mov EDX, offset max     ;move max to EDX
    call WriteString        ;print max string
    call ReadInt            ;readin int to EAX
    mov maxInt, EAX         ;store EAX value in maxInt

    mov EDX, offset times   ;move times to EDX
    call WriteString        ;print times string
    call ReadInt            ;readin int to EAX
    mov timesInt, EAX       ;store EAX value in timesInt 

    call GetMseconds        ;stores Mseconds in EAX
    mov prevInt, EAX        ;store getMseconds in prevInt
    mov count,0
L1:    
    mov EAX, minInt         ;move minInt to EAX
    mov ECX, prevInt        ;move prevInt to ECX
    mul ECX                 ;EAX = minInt * prevInt
    mov EBX, maxInt         ;move maxInt to EBX
    div EBX                 ;EAX = (min*prev) / max
    mov prevInt, EDX        ;EDX holds remainder from divison
    mov EAX, EDX            ;move random number to EAX
    call WriteInt           ;write random number
    INC count               ;increment count
    .IF count < timesInt    ;if count < timesInt continue
         LOOP L1            ;jump to L1
    .ENDIF                  ;end IF

    invoke ExitProcess,0    ;exit process
  main endp
  end main 
```

感谢您的时间，

伊恩

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T22:06:31.580

根据 [运算符参考](http://msdn.microsoft.com/en-us/library/94b6khh4%28v=vs.80%29.aspx)的关系运算符是

EQ 等于
GE 大于等于
GT 大于
LE 小于等于
LT 小于
NE 等于 不等于

我建议更改`<`to `LT`，这应该可以解决您的问题。

# c# - 如何使用 C# 检查与文件扩展名关联的程序是否有效？

> ID：15980353
> 
> 赞同：1
> 
> 时间：2013-04-12T20:31:01.377
> 
> 标签：c#, windows, file, registry, associations

我正在使用以下方法打开文件：

```
Process.Start(); 
```

如果具有某些扩展名的特定文件与 Windows 中不再存在的程序相关联，则会引发 Win32Exception。现在我可以简单地做

```
 try{
      Process.start();
 } catch( Exception ex){
      // Error handling code
 } 
```

但是应我的雇主的要求，我被要求不要这样做。相反，我想通过检查相关的程序/path_to_program 是否存在来解决这个问题，如果不存在，则弹出一个窗口，告诉用户选择一个程序来运行文件。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:40:58.577

创建两个表单并使用如下代码：

主窗体内部：

```
public void SelectProgram(string ext)
{
    IEnumerable<string> programList = RecommendedPrograms(ext);
    if (programList.Count() > 0)
    {
        // open a new form to show the program in the list (to user select one of them)
        frmSelectProgram frmSP = new frmSelectProgram(programList);
        frmSP.ShowDialog();
    }
    else
    {
        // show an Open Dialog to the user to select a program
    }
} 
```

并使用如下方法查找与女巫程序关联的文件（扩展名）：（此方法由[@LarsTech 编写](https://stackoverflow.com/questions/6679385/how-to-get-recommended-programs-associated-with-file-extension-in-c-sharp)，我更改了其中的一些行。）

```
using Microsoft.Win32;

public IEnumerable<string> RecommendedPrograms(string ext)
{
    List<string> progs = new List<string>();

    string baseKey = @"Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\." + ext;

    using (RegistryKey rk = Registry.CurrentUser.OpenSubKey(baseKey + @"\OpenWithList"))
    {
        if (rk != null)
        {
            string mruList = (string)rk.GetValue("MRUList");
            if (mruList != null)
            {
                foreach (char c in mruList.ToString())
                if(rk.GetValue(c.ToString())!=null)
                    progs.Add(rk.GetValue(c.ToString()).ToString());
            }
        }
    }

    using (RegistryKey rk = Registry.CurrentUser.OpenSubKey(baseKey + @"\OpenWithProgids"))
    {
        if (rk != null)
        {
            foreach (string item in rk.GetValueNames())
                progs.Add(item);
        }
        //TO DO: Convert ProgID to ProgramName, etc.
    }

    return progs;
} 
```

在 frmSelectProgram 表单中：

```
public partial class frmSelectProgram : Form
{
    private IEnumerable<string> _programList;
    public frmSelectProgram(IEnumerable<string> programList)
    {
        InitializeComponent();
        _programList = programList;
    }

    private void frmSelectProgram_Load(object sender, EventArgs e)
    {
        foreach (string pro in _programList)
        {
           // MessageBox.Show(pro);
           // for example fill a list box
        }
    }
} 
```

# linux - 使 proc 可用于所有模块文件？

> ID：15980356
> 
> 赞同：1
> 
> 时间：2013-04-12T20:31:06.853
> 
> 标签：linux, module, tcl, modulefile

我正在使用[模块](http://modules.sourceforge.net/)来管理软件。我正在尝试设置环境，以便可以从任何模块文件调用某个函数，而无需每个文件都必须获取 proc 定义。

示例：我希望该`util:prereq`函数在以下模块文件中可用，而无需获取其定义：

```
#%Module1.0

util::prereq compiler_intel/13.0.1 mpi/openmpi-1.6.4_intel-13.0.1 
```

为了做到这一点，我知道我必须连接到模块文件或 tcl 或其他东西。有任何想法吗？

此函数的用法与 类似，`prereq`只是该函数将加载任何先决条件而不是因为未加载而失败。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-15T08:58:26.430

比 clarkw 建议的更好的方法是使用旧`tclIndex`文件。

该文件必须位于文件夹`$auto_path`或其子目录中（建议使用子目录）。
您可以`tclIndex`手动创建文件，也可以调用

```
auto_mkindex directory file.tcl 
```

再说一遍：目录应该是的（子）目录`$auto_path`
如果第一次使用其中的一个命令，这将获取您的 tcl 文件。

# php - 奇怪的php表单问题

> ID：15980359
> 
> 赞同：0
> 
> 时间：2013-04-12T20:31:25.560
> 
> 标签：php, forms, post

我有一个关于帖子和表单元素的简单但奇怪的问题。

我有一个表格

```
<form id='form' name='form' method='post' action='test.php'>

      <?php
          foreach ($tests as $test){
              echo $test['ID']."<br>"; //output 1  2  3  4  5   6
              echo $_POST['testSelect'].'<br>';  //output 3 3 3 3 3 3

              if($test['ID'] == $_POST['testSelect']){  //which 3 mataches 3
                  echo 'match';
              }
          }
      ?>

    <select name='testSelect'>
      <?php
          foreach ($tests as $test){
              echo '<option value="'.$test['ID'].'">'.$test['Name'].'</option>';
          }
      ?>
    </select>
     <input type='submit' value='Go'></input> 
```

我想匹配`$_POST`我的变量并`match`在匹配时输出“”。

但是，我的输出中没有看到 ' `Match`' 显示。这根本没有意义！

任何人都可以帮忙吗？非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:41:11.800

也许只是试试

```
if((int)trim($test['ID']) == (int)trim($_POST['testSelect'])){  
  echo 'Matched';
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:44:43.980

您确定您实际上是在执行 POST 请求吗？打开 error_reporting 也可能有帮助。

```
error_reporting(-1);
ini_set('display_errors', 1); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T20:56:30.103

我认为这与 Post 参数是一个字符串和测试参数可能是一个整数有关。将 parseInt() 放在 Post 变量周围

# jasper-reports - Ireport 5.0 多表导出到 Excel

> ID：15980361
> 
> 赞同：3
> 
> 时间：2013-04-12T20:31:33.427
> 
> 标签：jasper-reports, ireport, export-to-excel

当我从 Jasperserver 导出时，我试图将我的报告拆分为多个 Excel 工作表。

报告结构 - 包含四个子报告的主页。每个子报表的组页眉和页脚，页眉包含子报表元素，而在页脚中，我已将分页符元素与属性..

```
<property name="net.sf.jasperreports.export.xls.break.after.row" value="true"/> 
```

将 Pbreaks 放在页眉/页脚中似乎没有什么区别，并且每个子报表都选中了忽略分页（true）。

主报告有这个属性，

```
<property name="net.sf.jasperreports.export.xls.one.page.per.sheet" value="true"/> 
```

我在这里阅读了类似的问题，并且无法通过许多不同的组合产生任何结果。不确定我的问题是否特定于 Ireport 5.0。

编辑：根据 Zoran 的建议，我得到了报告！（现在只要它不会耗尽内存）这是文本字段后面的 XML。

```
<textField>
<reportElement uuid="73dc8dab-6ebf-4f47-bf8c-a1ab6b4b0454" x="0" y="0" width="100" height="1">
<property name="net.sf.jasperreports.export.xls.break.after.row" value="true"/>
</reportElement>
<textElement/>
</textField> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-14T09:15:14.717

将分页符放入主报告中。我在子报表中遇到了同样的问题，并尝试了所有可能的属性组合，但似乎不可能从子报表中断开页面。

编辑：它也停止处理我的报告，我通过添加 1px 高文本字段并将属性 net.sf.jasperreports.export.xls.break.after.row 设置为 true 来解决。我还使用此字段使用 net.sf.jasperreports.export.xls.sheet.name 设置工作表名称

我没有收到您回复的通知，否则我会尽快回复...

场源

```
<textField>
    <reportElement positionType="FixRelativeToBottom" x="1325" y="122" width="1" height="1" uuid="cbee8af0-8639-4f97-bd6a-4cd284e604c4">
        <property name="net.sf.jasperreports.print.keep.full.text" value="true"/>
        <propertyExpression name="net.sf.jasperreports.export.xls.break.after.row"><![CDATA[$V{REPORT_COUNT} < $F{MAX_ROW_CNT} ? "true" : "false"]]></propertyExpression>
        <propertyExpression name="net.sf.jasperreports.export.xls.sheet.name"><![CDATA[$F{GROUP_NAME}]]></propertyExpression>
    </reportElement>
    <textFieldExpression><![CDATA[($V{REPORT_COUNT} < $F{MAX_ROW_CNT}) ? "true" : "false"]]></textFieldExpression>
</textField> 
```

字段位于报表右边缘的子报表元素下方。我正在使用分页符的表达式来避免在报告末尾出现额外的空白页面。字段 MAX_ROW_CNT 来自查询中的分析函数，REPORT_COUNT 是指示当前行号的 JR 变量。

# django - Heroku 上的 Django 缓存，但在开发时没有

> ID：15980363
> 
> 赞同：0
> 
> 时间：2013-04-12T20:31:40.840
> 
> 标签：django, caching, heroku

我想在开发时禁用我的 Django 项目的缓存，但在部署到 Heroku 时启用它。

这是我当前的缓存设置：

```
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.filebased.FileBasedCache',
        'LOCATION': os.path.join(PROJECT_ROOT, 'cache/'),
    }
} 
```

我了解以下代码不会在开发时缓存：

```
CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.dummy.DummyCache',
    }
} 
```

我的问题是：如何将这两个设置组合到本地计算机上的虚拟缓存，但在 Heroku 上缓存？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:41:40.100

您需要在开发时为您的项目设置一个本地设置文件（只要确保您不部署本地设置！） -[这个 StackOverflow 答案](https://stackoverflow.com/a/4909964/240418)会有所帮助。

# symfony - Symfony2 CSRF 令牌无效。请尝试重新提交表单

> ID：15980367
> 
> 赞同：1
> 
> 时间：2013-04-12T20:31:46.130
> 
> 标签：symfony, webforms, csrf

我有一个表单不断收到“CSRF 令牌无效。请尝试重新提交表单。” 我一直找不到原因。

我知道这很简单。任何帮助，将不胜感激。

在控制器中我有这个：

```
public function settingsAction()
{   
    $request = $this->getRequest();

    /* @var $user User */
        $user = $this->get('security.context')->getToken();

    $settingsForm = $this->createForm(new SettingsFormType(), array($user));
    $billingForm = $this->createForm(new BillingFormType(), array($user));
    $accountForm = $this->createForm(new AccountFormType(), array($user));

        return $this->render('DeductrDeductrBundle:Settings:settings.html.twig', array(
                'settingsForm' => $settingsForm->createview(),'billingForm' => $billingForm->createview(),'accountForm' =>$accountForm->createview(),));
}

public function createAction()
{
    $em = $this->getDoctrine()->getEntityManager();

    $form = $this->createForm(new RegistrationFormType('Deductr\UserBundle\Entity\User'));

    $form->bind($this->getRequest());

    if ($form->isValid()) {
        $user = $form->getData();

        $em->persist($user);
        $em->flush();

        return $this->redirect('/settings');
    } 
```

.twig 文件有这个：

```
{% extends 'DeductrDeductrBundle:Base:base.html.twig' %}

{% block body %}
<div name='personal' style="padding-left:25px; width:600px;">
<h5>Personal Information</h5>
{#src/Deductr/DeductrBundle/Resources/views/settings/settings.html.twig #}
<form action="{{ path('user_registration_create') }}" {{ form_enctype(settingsForm) }}" method="POST" {{ form_enctype(settingsForm) }}>

 <table>
        <tr>
            <td>First Name</td>

            <td>Last Name</td>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td>
        {{ form_widget(settingsForm.first_name, {'attr': {'class' : 'half'}}) }}
            </td>

            <td>
                {{ form_widget(settingsForm.last_name, {'attr':    {'class' : 'half'}}) }}
            </td>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td colspan="3">Company</td>
        </tr>
        <tr>
            <td colspan="3">
                {{ form_widget(settingsForm.company, {'attr': {'class' : 'half'}}) }}

            </td>
        </tr>
        <tr>
            <td colspan="3">Address 1</td>
        </tr>
        <tr>
            <td colspan="3">
                {{ form_widget(settingsForm.address1, {'attr': {'class' : 'half'}}) }}

            </td>
        </tr>
        <tr>
            <td colspan="3">Address 2</td>
        </tr>
        <tr>
            <td colspan="3">
                {{ form_widget(settingsForm.address2, {'attr': {'class' : 'half'}}) }}

            </td>
            </tr>
            <tr>
            <td colspan='2'>
                <label for 'city'>City</label>
            </td>
            <td>&nbsp;</td>

            </tr>

        <tr>
            <td colspan='2'>
                {{ form_widget(settingsForm.city, {'attr': {'class': 'half'}}) }}
            </td>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td><label for 'state'>State</label>
            <td>
                <label for 'zip'>Zip/Postal</label>
            </td>
            <td>
                <label for 'phone'>Phone Number</label>
            </td>

        </tr>
            <tr>
            <td>
                {{ form_widget(settingsForm.province, {'attr': {'class': 'half'}}) }}
            </td>
            <td>
                {{ form_widget(settingsForm.postal_code, {'attr': {'class': 'half'}}) }}
            </td>
            <td>
                {{ form_widget(settingsForm.phone, {'attr': {'class': 'half'}}) }}
            </td>

        </tr>
        <tr>
    <td>&nbsp;</td>         
    <td>&nbsp;</td>
    <td><input type="submit" value="{{ 'submit'|trans({}, 'DeductrUserBundle') }}" /></td>
</tr>
 </table> 
 {{ form_row (settingsForm._token) }} 
</form>

</div>
<div id="billing" style="padding-left:25px; width:600px;">
<h5>Billing Information</h5>
<form action="" method="POST" {{ form_enctype(billingForm) }}>
    {{ form_row (billingForm._token) }}

 <table>
    <!--    <tr>
            <td>First Name</td>

            <td>Last Name</td>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td>
        {{ form_widget(billingForm.fname, {'attr': {'class' : 'half'}}) }}
            </td>

            <td>
                {{ form_widget(billingForm.lname, {'attr': {'class' : 'half'}}) }}
            </td>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td colspan="3">Address 1</td>
        </tr>
        <tr>
            <td colspan="3">
                {{ form_widget(billingForm.billingAddress1, {'attr': {'class' : 'half'}}) }}

            </td>
        </tr>
        <tr>
            <td colspan="3">Address 2</td>
        </tr>
        <tr>
            <td colspan="3">
                {{ form_widget(billingForm.billingAddress2, {'attr': {'class' : 'half'}}) }}

            </td>
            </tr>
            <tr>
            <td colspan='2'>
                <label for 'city'>City</label>
            </td>
            <td>&nbsp;</td>

            </tr>

        <tr>
            <td colspan='2'>
                {{ form_widget(billingForm.billingCity, {'attr': {'class': 'half'}}) }}
            </td>
            <td>&nbsp;</td>
        </tr>
        <tr>
            <td><label for 'state'>State</label>
            <td>
                <label for 'zip'>Zip/Postal</label>
            </td>
            <td>
                <label for 'phone'>Phone Number</label>
            </td>

        </tr>
            <tr>
            <td>
                {{ form_widget(billingForm.billingState, {'attr': {'class': 'half'}}) }}
            </td>
            <td>
                {{ form_widget(billingForm.billingZip, {'attr': {'class': 'half'}}) }}
            </td>
            <td>
                {{ form_widget(billingForm.billingPhone, {'attr': {'class': 'half'}}) }}
            </td>

        </tr> -->
<tr>
    <td colspan='3'>
     <h5>Payment Information</h5>
    </td>
</tr>
    <tr>
        <td>Expiration Date</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
        <tr>
        <td>{{ form_widget(billingForm.expMonth, {'attr': {'class': 'half'}}) }}</td>
        <td>{{ form_widget(billingForm.expYear, {'attr': {'class': 'half'}}) }}</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
    </tr>
    <tr>
        <td>Credit Card Type</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
        <tr>
        <td>{{ form_widget(billingForm.ccType, {'attr': {'class': 'half'}}) }}</td>
        <td>&nbsp;</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
    </tr>
    <tr>
        <td>Credit Card Number</td>
        <td>&nbsp;</td>
        <td>CVV</td>
    </tr>
        <tr>
        <td>{{ form_widget(billingForm.cardNumber, {'attr': {'class': 'half'}}) }}</td>
        <td>&nbsp;</td>
        <td>{{ form_widget(billingForm.cvv, {'attr': {'class': 'half'}}) }}</td>
    </tr>
    <tr>
    </tr>
<tr>
    <td>&nbsp;</td>         
    <td>&nbsp;</td>
    <td><input type="submit" value="{{ 'submit'|trans({}, 'DeductrUserBundle') }}" /></td>

</tr>
</table>
</div>
</form>

</div>
<div id="account" style="padding-left:25px; width:600px;">
<h5>Account Information</h5>
<form action="" method="POST" {{ form_enctype(accountForm) }}>
    {{ form_row (accountForm._token) }}
<table>
    <tr>
        <td colspan='2'>Email</td>
        <td>&nbsp;</td>
    </tr>
    <tr>
        <td colspan='3'>{{ form_widget(accountForm.email, {'attr': {'class': 'half'}}) }}</td>
    </tr>
    <tr>
        <td colspan='2'>Password</td>
        <td>Confirm Your Password</td>
    </tr>
    <tr>
        <td>{{ form_widget(accountForm.password, {'attr': {'class': 'half'}}) }}</td>
        <td>&nbsp;</td>
        <td>{{ form_widget(accountForm.confPass, {'attr': {'class': 'half'}}) }}</td>
    </tr>
    <tr>
    <td colspan='2'>&nbsp;</td>
    <td><input type="submit" value="{{ 'submit'|trans({}, 'DeductrUserBundle') }}" /></td>

</tr>
</table>
 </form>
</div>
{% endblock %} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-14T13:03:10.877

如果这是您的整个表单模板，它可能是这样的：

```
<form action="{{ path('user_registration_create') }}" {{ form_enctype(settingsForm) }}" method="POST" {{ form_enctype(settingsForm) }}>
    {{ form_row (settingsForm._token) }} 
```

确保包括`form_rest(settingsForm)`

而且，为什么一页上有三个表格？如果您是 Symfony 的新手，请先尝试让一个表单在页面上工作。你会 - 在你的情况下，需要三个`form_rest`s - 我认为每个表格的每个实例一个。

没有更多代码很难说。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-15T16:45:34.577

我找到了答案。我没有添加这个：

```
/** 
 * Creates a new settungsUser entity. 
 * 
 * @Route("/settings/create", name="user_settings") 
 * @Method("POST") 
 * @Template("DeductrDeductrBundle:Settings:settings.html.twig")
 * 
 */ 
```

一旦我更新了树枝中的路径，它就起作用了。

感谢所有的帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:41:18.093

我认为您正在混合两种不同的表单类型。

您正在呈现 type 的形式`SettingsFormType`并将其提交给它，`createAction`从而创建了 type 的形式`RegistrationFormType`。

生成 CSRF 令牌时可能会考虑表单名称。话虽如此，您的令牌每次都必然不同且不正确-无论如何；）

希望这对您的问题有所启发；）

# mongodb - 如何在 ruby 中监控我的 mongodb 服务器？

> ID：15980370
> 
> 赞同：0
> 
> 时间：2013-04-12T20:32:03.927
> 
> 标签：mongodb, mongohq

我目前在我的 Web 应用程序中遇到一些尴尬的超时，它们都指向我在我的 mongo 数据库中的我（我正在使用 MongoHQ）。这些超时发生在非常安静的时间（即每分钟 1 个请求）并且会发生几分钟然后停止。

所以，我正在尝试实施一些 mongo 监控。有没有人有什么建议？我正在考虑编写一个只测试以下内容的计时器？

```
unless Mongo::Connection.from_uri(uri).ping['ok']
  # alert me  of db being down
end 
```

我的配置设置如下：

```
@pool_size=1, @pool_timeout=5.0, @op_timeout=nil, @connect_timeout=nil, 
```

有一个更好的方法吗？还是更好的解决方案？

我正在运行 ruby​​ 驱动程序（mongo-1.6.2，因为我使用 mongoid-2）。

我看到的例外是：

```
vendor/ruby-1.9.3/lib/ruby/1.9.1/thread.rb:71:in `sleep'
vendor/ruby-1.9.3/lib/ruby/1.9.1/thread.rb:71:in `wait'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/util/pool.rb:298:in `block (2 levels) in checkout'
<internal:prelude>:10:in `synchronize'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/util/pool.rb:252:in `block in checkout'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/util/pool.rb:245:in `loop'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/util/pool.rb:245:in `checkout'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/connection.rb:500:in `checkout_writer'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/cursor.rb:524:in `checkout_socket_from_connection'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/cursor.rb:466:in `send_initial_query'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/cursor.rb:458:in `refresh'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/cursor.rb:128:in `next'
vendor/bundle/ruby/1.9.1/gems/mongo-1.6.2/lib/mongo/collection.rb:288:in `find_one'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/collections/master.rb:25:in `block in find_one'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/collections/retry.rb:29:in `retry_on_connection_failure'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/collections/master.rb:24:in `find_one'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/collection.rb:60:in `find_one'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/contexts/mongo.rb:205:in `first'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/criteria.rb:45:in `first'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/criterion/inclusion.rb:169:in `from_map_or_db'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/criterion/inclusion.rb:149:in `execute_or_raise'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/criterion/inclusion.rb:129:in `find'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid/finders.rb:84:in `find'
app/controllers/application_controller.rb:266:in `find_question'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:462:in `_run__469780332759358222__process_action__3401617144824505767__callbacks'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:405:in `__run_callback'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:81:in `run_callbacks'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/abstract_controller/callbacks.rb:17:in `process_action'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal/rescue.rb:29:in `process_action'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/notifications.rb:123:in `block in instrument'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/notifications/instrumenter.rb:20:in `instrument'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/notifications.rb:123:in `instrument'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal/instrumentation.rb:29:in `process_action'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/agent/instrumentation/rails3/action_controller.rb:34:in `block in process_action'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:268:in `block in perform_action_with_newrelic_trace'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/agent/method_tracer.rb:240:in `trace_execution_scoped'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/agent/instrumentation/controller_instrumentation.rb:263:in `perform_action_with_newrelic_trace'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/agent/instrumentation/rails3/action_controller.rb:33:in `process_action'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/abstract_controller/base.rb:121:in `process'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/abstract_controller/rendering.rb:45:in `process'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal.rb:203:in `dispatch'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_controller/metal.rb:246:in `block in action'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/routing/route_set.rb:73:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/routing/route_set.rb:36:in `call'
vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:68:in `block in call'
vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `each'
vendor/bundle/ruby/1.9.1/gems/journey-1.0.4/lib/journey/router.rb:56:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/routing/route_set.rb:601:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-pjax-0.6.0/lib/rack/pjax.rb:12:in `call'
vendor/bundle/ruby/1.9.1/gems/omniauth-1.1.1/lib/omniauth/strategy.rb:177:in `call!'
vendor/bundle/ruby/1.9.1/gems/omniauth-1.1.1/lib/omniauth/strategy.rb:157:in `call'
vendor/bundle/ruby/1.9.1/gems/omniauth-1.1.1/lib/omniauth/strategy.rb:177:in `call!'
vendor/bundle/ruby/1.9.1/gems/omniauth-1.1.1/lib/omniauth/strategy.rb:157:in `call'
vendor/bundle/ruby/1.9.1/gems/omniauth-1.1.1/lib/omniauth/builder.rb:48:in `call'
vendor/bundle/ruby/1.9.1/gems/oink-0.10.1/lib/oink/middleware.rb:17:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-timeout-0.0.3/lib/rack/timeout.rb:16:in `block in call'
vendor/bundle/ruby/1.9.1/gems/rack-timeout-0.0.3/lib/rack/timeout.rb:16:in `call'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/rack/error_collector.rb:8:in `call'
vendor/bundle/ruby/1.9.1/gems/newrelic_rpm-3.5.5.38/lib/new_relic/rack/browser_monitoring.rb:12:in `call'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/rack/mongoid/middleware/identity_map.rb:33:in `block in call'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/mongoid.rb:133:in `unit_of_work'
vendor/bundle/ruby/1.9.1/gems/mongoid-2.4.12/lib/rack/mongoid/middleware/identity_map.rb:33:in `call'
vendor/bundle/ruby/1.9.1/gems/sass-3.2.6/lib/sass/plugin/rack.rb:54:in `call'
vendor/bundle/ruby/1.9.1/gems/exception_notification-2.6.1/lib/exception_notifier.rb:34:in `call'
vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:35:in `block in call'
vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `catch'
vendor/bundle/ruby/1.9.1/gems/warden-1.2.1/lib/warden/manager.rb:34:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/etag.rb:23:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/conditionalget.rb:25:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/head.rb:14:in `call'
vendor/bundle/ruby/1.9.1/gems/remotipart-1.0.2/lib/remotipart/middleware.rb:30:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/params_parser.rb:21:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/flash.rb:242:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/session/abstract/id.rb:210:in `context'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/session/abstract/id.rb:205:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/cookies.rb:341:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:405:in `_run__1746387501225523832__call__2262895368653440085__callbacks'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:405:in `__run_callback'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/callbacks.rb:81:in `run_callbacks'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/callbacks.rb:27:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/rack/logger.rb:32:in `call_app'
vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/rack/logger.rb:16:in `block in call'
vendor/bundle/ruby/1.9.1/gems/activesupport-3.2.11/lib/active_support/tagged_logging.rb:22:in `tagged'
vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/rack/logger.rb:16:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/request_id.rb:22:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/methodoverride.rb:21:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/runtime.rb:17:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/lock.rb:15:in `call'
vendor/bundle/ruby/1.9.1/gems/actionpack-3.2.11/lib/action_dispatch/middleware/static.rb:62:in `call'
vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:136:in `forward'
vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:245:in `fetch'
vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:185:in `lookup'
vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:66:in `call!'
vendor/bundle/ruby/1.9.1/gems/rack-cache-1.2/lib/rack/cache/context.rb:51:in `call'
vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/engine.rb:479:in `call'
vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/application.rb:223:in `call'
vendor/bundle/ruby/1.9.1/gems/railties-3.2.11/lib/rails/railtie/configurable.rb:30:in `method_missing'
vendor/bundle/ruby/1.9.1/gems/rack-1.4.4/lib/rack/deflater.rb:13:in `call'
vendor/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:531:in `process_client'
vendor/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:606:in `worker_loop'
vendor/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:487:in `spawn_missing_workers'
vendor/bundle/ruby/1.9.1/gems/unicorn-4.3.1/lib/unicorn/http_server.rb:137:in `start'
vendor/bundle/ruby/1.9.1/gems/unicorn-4.3.1/bin/unicorn:121:in `<top (required)>'
vendor/bundle/ruby/1.9.1/bin/unicorn:23:in `load'
vendor/bundle/ruby/1.9.1/bin/unicorn:23:in `<main>' 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-13T05:24:45.000

10gen 提供名为 MMS 的 Mongo 监控服务，该服务包含在所有 MongoHQ 计划[的定价页面](https://www.mongohq.com/pricing)中。我将从那里开始，因为这将使您深入了解数据库正在做什么以及为什么它可能没有响应。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T12:46:12.380

如果您在请求几分钟后消失的低活动期间出现超时，可能的原因是您的[连接池中](https://github.com/mongodb/mongo-ruby-driver#connection-pooling)有陈旧的连接，当您尝试使用这些连接时会发现这些连接。过时的连接将导致您的应用程序出现超时错误，并且将重新建立数据库连接。当您的应用程序发出新请求时，陈旧的连接将被刷新，超时错误将消失。

您可以通过减少超时值来解决此问题，但您也可以通过在超时异常上重试查询来处理。MongoHQ 支持可能有一些关于为他们的服务设置适当的超时值的具体建议。

# php - php cURL 没有收到数据

> ID：15980371
> 
> 赞同：0
> 
> 时间：2013-04-12T20:32:08.890
> 
> 标签：php

我有一个`a.php`使用 cURL 将数据发布到页面的`b.php`页面。但是，当页眉到 时`b.php`，我没有收到任何 POST 数据。

这是我的代码：

```
$data=array();
$data['firstname']='A';
$data['lastname']='B';

$post_str='';
foreach($data as $key=>$value){
    $post_str.=$key.'='.urlencode($value).'&';  
}

$post_str=substr($post_str, 0, -1);//Remove last & from loop

$ch=curl_init();
curl_setopt($ch, CURLOPT_URL, 'http://localhost/b.php');
curl_setopt($ch, CURLOPT_POST, TRUE);
curl_setopt($ch, CURLOPT_POSTFIELDS, $post_str);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, TRUE);

$response=curl_exec($ch);

curl_close($ch);
header('location:b.php'); 
```

**b.php页面**

```
echo $_POST['firstname']; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:37:45.340

那是因为这个电话：

```
header('location:b.php'); 
```

重新定位到`b.php` **没有**任何`$_POST`数据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:14:26.837

您有两个 php 脚本，但就浏览器而言，它们并没有真正连接。毕竟，网络本来就是无国籍的。您的 a.php 很可能已成功发布到 b.php。

但是该`header('location:b.php');`行调用 b.php 时没有任何参数。

为了使 a.php 更通用一点，我改为
`curl_setopt($ch, CURLOPT_URL, 'http://localhost/b.php');`
：
`curl_setopt($ch, CURLOPT_URL, $_SERVER['SERVER_NAME'].'/b.php');`

b.php需要记录然后显示结果：

```
<?
// if called without POST data, dump the last POST,
// otherwise record the POST in a file

$filename = 'temp_data.txt';
if (count($_POST) == 0) {
    if (file_exists($filename)) {
        // dump recorded results
        echo "<pre>\n";
        readfile($filename);
        echo "</pre>\n";
    } else {
        echo 'No file available.';
    }

} else {
// record results:
    $fp = fopen($filename, 'w');
    fwrite($fp, print_r($_POST, true));
    fclose($fp);
} 
```

所以打开 a.php，然后在浏览器中打开 b.php。

# javascript - Javascript中按背景颜色排列的元素数组

> ID：15980375
> 
> 赞同：0
> 
> 时间：2013-04-12T20:32:15.563
> 
> 标签：javascript, arrays, background-color

我正在构建一个表单，它可以根据所做的选择更改某些元素的背景颜色。稍后我根据静态数值验证表单，但想为任何背景颜色更改的字段创建例外。

我的想法是根据背景颜色将这些元素收集到一个数组中。我不确定如何检查背景颜色。希望下面的代码显示了我的思考过程。if 语句中的条件不起作用，我不知道是否有类似的东西可以解决这个问题。

```
var group = document.getElementsByClassName = ('groupClass');
for(i=0;i < group.length;i++){
  if(group[i].style.backgroundColor == "#000"){
    //add group[i] to an array
  }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:34:32.787

**与其改变背景颜色，不如给它一个改变背景颜色的类，然后寻找那个类。**

不过，您的代码中有几个问题。

```
var group = document.getElementsByClassName = ('groupClass');` 
```

应该

```
var group = document.getElementsByClassName('groupClass'); 
```

另外，尝试比较 with`'rgb(0, 0, 0)'`而不是`'#000'`。（至少在 Chrome 中有效。）参见[http://jsfiddle.net/evrk4/](http://jsfiddle.net/evrk4/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:39:10.413

前进路线是个问题。

```
var group = document.getElementsByClassName = ('groupClass'); 
```

它应该是一个方法调用：

```
var group = document.getElementsByClassName('groupClass'); 
```

# python - 写入文件时乱码

> ID：15980376
> 
> 赞同：0
> 
> 时间：2013-04-12T20:32:19.647
> 
> 标签：python, file

我正在尝试读取一个文件，然后将其写回同一个文件，每个字符之间有一个空格，一组大写，一组正常。

我可以正常写任何一组，但我不能正常写这两个。

这是我的代码

```
import string
f = open('text.txt', 'r+')
file = f.read()
file = file.translate(None, string.whitespace)
file = file.translate(None, string.punctuation)
file = ' '.join(file)
file2 = file.upper()
f.seek(0)
f.write(file)
f.flush()
f.write(file2)
f.close() 
```

然而，遗憾的是这不起作用。在记事本中打开它时，它都是胡言乱语。在 python 中第二次读取它时，它完美地看到了两组字符串，然后乱码直到出现错误。例如：

```
 Y A L E T T E R S A Y I N G ô C    ƒ▬s ► É☺↨ ░☺≡≡≡ ≡≡≡                
 ☺☺☺        Ç>      ☺   ☺   ☺               ▼ ë☺                            ☺ 
```

那么结局应该是“麻烦多于值得”

因此，在所有事情进行到一半时，都会胡言乱语，而不是像应有的那样写作。

即使我不写入文件也会发生这种情况。

```
print file returns perfect string
print file2 returns perfect string
temp = file + file2
print temp returns gibberish part of the way through 
```

那么为什么它会返回乱码，我该怎么做才能解决这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:45:13.330

您需要在再次写入文件之前*截断文件：*

```
f.seek(0)
f.truncate() 
```

# jquery - 如何从 ajax 返回的 HTML 访问 json 数据？

> ID：15980387
> 
> 赞同：2
> 
> 时间：2013-04-12T20:33:31.567
> 
> 标签：jquery, ajax

我正在尝试从返回 html 和 json 的 Ajax 调用中检索 json 项目数据。我下面的 javascript 返回一条成功消息，这很有帮助；我只是不确定如何访问数据。我正在尝试`newPrice`从此响应中访问：

```
Data Loaded: <pre>Array
(
[point] => 86
[claimId] => 3594
[type] => yeh
)
</pre>{"data":{"newPrice":88,"lockedInPrice":86},"errors":[],"success":true,"code":200} 
```

我的代码如下。我特别想只返回 newPrice 值：

```
var newData = $.ajax({ 
    type: "POST",
    url: takeurl,
    dataType: "html",
    data: { point: point, claimId: id, type: val }
    })
    .success(function(data) { 
        alert("Data Loaded: " + data);
        //newPrice = data.newPrice; -- returned undefined?
        console.log(newPrice);
        })

    .error(function() { alert("not yet"); })
    .complete(function(data) { 
        console.log('complete 1' );
    });

// Set another completion function for the request above
newData.complete(function(data){ 
    console.log("second complete" );
    });

return false;
 }); 
```

谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:38:43.983

您的响应中似乎同时包含 HTML 和 JSON。通常响应只是 JSON，并以内容类型 application/JSON 进行响应。尽管可以使用响应，但这有点不正统。

您可以使用 substring 和 indexof 删除 HTML 部分“”，然后使用 JSON 创建一个 javascript 对象。

```
var data = "<pre>Array\n(\n[point] => 86\n[claimId] => 3594\n[type] => yeh\n)\n</pre>{\"data\":{\"newPrice\":88,\"lockedInPrice\":86},\"errors\":[],\"success\":true,\"code\":200}";

alert("Data Loaded: " + data);
var n = data.indexOf("</pre>{");
data = data.substring(n+6);
var result = JSON.parse(data);
alert("JSON.newPrice:"+result.data.newPrice); 
```

JSON.parse() 方法用于将 JSON 字符串转换为 JSON 对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:39:02.963

如果您想以 JSON 格式访问响应，则它必须以`application/json`内容类型返回，并且看起来像一个有效的 JavaScript 普通对象。还设置了`dataType`对 的`jQuery.ajax`调用`json`。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-13T06:52:51.683

为了避免在控制器的 Json 响应中获取带有“pre”标签的 HTML，请使用以下代码片段。

```
var result= objectData;
return Json(result, "text/html"); 
```

# mysql - Ruby on Rails 对 MySQL 的查询并不总是返回新添加的信息

> ID：15980393
> 
> 赞同：0
> 
> 时间：2013-04-12T20:33:56.317
> 
> 标签：mysql, ruby-on-rails, ruby, redhat

我已经接管了在 Rails (v2.3.5) 上运行 Ruby (v1.8.5) 和 Passenger (v2.2.9)、Thinking Sphinx (v1.3.14) 和 MySQL (v5.0.77-log) 的 Red Hat Enterprise Linux 5 系统. 我知道它们都过时了，但这不是问题。

该系统的用户已经注意到，最近输入的数据不像旧数据那样显示在查询中。例如，当查找旧数据时，这是日志中的一个片段：

> ```
>  7 Query       SELECT * FROM `patients` WHERE (`patients`.`id` = 618)
>                   7 Query       SELECT count(*) AS count_all FROM `notes` WHERE (patient_id = 618)
>                   7 Query       SELECT * FROM `notes` WHERE (`notes`.`id` IN (2238,2237,2092,2088))
>                   7 Query       SHOW FIELDS FROM `categories`
>                   7 Query       SELECT * FROM `categories` WHERE (`categories`.`id` = 3)
>                   7 Query       SELECT * FROM `users` WHERE (`users`.`id` = 2)
>                   7 Query       SELECT * FROM `categories` WHERE (`categories`.`id` = 2)
>                   7 Query       SELECT * FROM `categories` WHERE (`categories`.`id` = 1)
>                   7 Query       SELECT * FROM `users` WHERE (`users`.`id` = 6)
>                   7 Query       BEGIN
>                   7 Query       UPDATE `sessions` SET `data` = '[removed]\n', `updated_at` = '2013-04-12 20:08:26' WHERE `id` = 1836
>                   7 Query       COMMIT 
> ```

所以 MySQL 正在为患者 618 返回四个注释（id 为 2238、2237、2092 和 2088）。

另一方面，如果我选择上周二添加到系统中的患者，我知道该患者有三个与他相关的笔记，我会得到：

> ```
>  8 Query       SELECT * FROM `patients` WHERE (`patients`.`id` = 1157)
>                   8 Query       SELECT count(*) AS count_all FROM `notes` WHERE (patient_id = 1157)
>                   8 Query       BEGIN
>                   8 Query       UPDATE `sessions` SET `data` = '[removed]=\n', `updated_at` = '2013-04-12 20:19:00' WHERE `id` = 1836
>                   8 Query       COMMIT 
> ```

缺少整个“SELECT * FROM `notes`”部分。我知道这些笔记在那里，因为如果我手动搜索它们就可以看到它们。

一些额外的潜在要点：

*   这个系统已经三年多没有重新启动了，像 httpd 和 sqld 之类的东西也没有设置为在重新启动时自动启动，所以我不确定是否还有其他需要重新启动的东西。
*   我没有 Ruby on Rails 的背景。我不知道 Thinking Sphinx 是什么，但我知道在运行命令“rake -f ~user/project/Rakefile ts:start RAILS_ENV=production”之前遇到了 HTTP 500 错误。
*   系统刚刚从一个虚拟机场迁移到另一个（换句话说，V-to-V），但我已经检查了这可能会影响 RoR 安装的所有方式，并得出结论：它不会影响任何文件或功能。

您能给我的任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T19:09:50.460

原来是 Thinking Sphinx 的问题。

TS 被设置为每小时以拥有该项目的用户身份运行其重新索引服务 (rake ts:reindex)。在调试问题时，我以 root 身份运行它，这将所有索引文件的所有权更改为 root。当用户的重新索引作业随后运行时，它返回一个

> 权限被拒绝，不会索引。尝试 --rotate 选项。

错误，或

> 资源暂时不可用，不会索引。尝试 --rotate 选项。

错误。

我最终以非 root 用户的身份从头开始重新创建索引文件，现在它又可以工作了。

# javascript - 使用 decodeURI 时如何捕获错误？

> ID：15980396
> 
> 赞同：0
> 
> 时间：2013-04-12T20:34:25.070
> 
> 标签：javascript, decodeuricomponent

例如，如果使用`decodeURI('%C4%97%')`它会触发并出错（是的，这是一个错误，专门用于测试）：

> URIError: 格式错误的 URI 序列 ...('textarea#encode-url-result').val(decodeURI(jQuery('input#encode-url-input').va...

即使我把它放进去，`try-catch`它仍然会致命。有没有办法抓住它并显示警报？

**更新：**

这是我的代码，我仍然在控制台中收到错误

```
try{
    jQuery('a#encode-url-encode, a#encode-url-decode').click(function(){
        if(jQuery('input#encode-url-input').val().length == 0)
            showCustomAlert('<strong>Warning!</strong> Please enter value.');

        var result = null;

        if(jQuery(this).attr('id') == 'encode-url-encode')
            result = encodeURI(jQuery('input#encode-url-input').val());
        else if(jQuery(this).attr('id') == 'encode-url-decode')
            result = decodeURI(jQuery('input#encode-url-input').val());

        jQuery('textarea#encode-url-result').val(result);
    });
}
catch(e){
    alert(e);
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:36:22.677

这工作正常：

```
try {
    decodeURI('%C4%97%')
} catch (ex) {
    alert("ERROR DECODING URI");
} 
```

**演示：http:** [//jsfiddle.net/P6EBN/](http://jsfiddle.net/P6EBN/)

**编辑：**

从您的错误消息的外观来看，您正在尝试使用 jQuery 设置 textarea 的值。

尝试这样的事情：

```
var newVal = "";
var toDecode = jQuery('input#encode-url-input').val();
try {
    newVal = decodeURI(toDecode);
} catch (ex) {
    // alert("ERROR DECODING URI");
}
jQuery('textarea#encode-url-result').val(newVal); 
```

只是试图将其拆分，以便您可以专门针对解码。

此外，在选择器`tagName`前面使用 a`id`也是不必要的。只需使用这些选择器：

```
jQuery("#encode-url-input")
// and
jQuery("#encode-url-result") 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T20:48:42.787

如果包装异步回调传递，try-catch 不起作用。

```
jQuery('a#encode-url-encode, a#encode-url-decode').click(function() {
    if (jQuery('input#encode-url-input').val().length == 0) showCustomAlert('<strong>Warning!</strong> Please enter value.');
    var result = null;
    try { //It needs to be here.
        if (jQuery(this).attr('id') == 'encode-url-encode') result = decodeURI(encodeURI(jQuery('input#encode-url-input').val()));
        else if (jQuery(this).attr('id') == 'encode-url-decode') result = decodeURI(decodeURI(jQuery('input#encode-url-input').val()));
    } catch (e) {
        //handle
    }
    jQuery('textarea#encode-url-result').val(result);
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T20:40:58.277

```
try {
    var x = decodeURIComponent('%C4%97%');
} catch (ex) {
    console.log("ERROR DECODING URI: " + ex.message);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T20:37:39.837

```
try
{
    var x = decodeURI('%C4%97%');
}
catch(e)
{
    alert(e);
} 
```

# matlab - 如何在不评论 Matlab 中的每一行的情况下进行群组评论？

> ID：15980399
> 
> 赞同：13
> 
> 时间：2013-04-12T20:34:43.157
> 
> 标签：matlab

如何在不评论每一行的情况下评论一组行？

即像'c'

```
/*
printf("hello");
printf("there");
*/ 
```

在 Matlab 中，我知道这样做的唯一方法是注释每一行

```
%disp('hello')
%disp('there') 
```

我有 100 行要注释掉，我更愿意像“c”一样对它进行分组注释。

谢谢

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-12T20:37:25.663

[我可以像在 C 中一样使用 /* ... */ 注释 MATLAB 文件中的一行吗？](http://www.mathworks.com/support/solutions/en/data/1-17Y20/?solution=1-17Y20%20an%20I%20comment%20a%20block%20of%20lines%20in%20an%20MATLAB%20file%20using%20/%2a%20...%20%2a/%20as%20I%20can%20in%20C?)：

```
%{
...
Block of COMMENTS HERE
...
...
%}
%CODE GOES HERE
plot(1:10) 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-04-12T20:37:52.087

1) MATLAB v7+：

```
%{
...code to be commented
%} 
```

2）使用编辑器：

选择所有行，然后在菜单中选择切换注释或其他内容。在那里

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-02-07T07:25:57.127

或者只是选择要评论的行组，然后使用击键“Ctrl+/（正斜杠）”，瞧，它将用 % 评论所选块的每一行，就像单独做的那样。要撤消我试过但不知道什么击键可以工作，所以请任何人...

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-02-22T16:31:13.503

选择所有行然后执行：
注释：从文本菜单-->注释
取消注释：从文本菜单-->取消注释

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-04-22T16:17:43.920

您可以使用键盘快捷键：

注释多行：CTRL + r

取消注释多行：CTRL + t

它在 Matlab 2016 中完美运行。

# javascript - Grunt - 解析非字符串（例如数组）模板

> ID：15980401
> 
> 赞同：9
> 
> 时间：2013-04-12T20:34:59.917
> 
> 标签：javascript, gruntjs

假设我的 grunt 配置中有一个变量，其中一个数组作为值。一个真实的例子`grunt.regarde.changed`来自[grunt-regarde](https://github.com/yeoman/grunt-regarde)插件，它列出了所有已更改的文件。

我想使用模板解析该数组，以便（在这种情况下）复制更改的文件：

```
 copy: {
    staticWeb: {
      src: '<%= grunt.regarde.changed %>',
      dest: 'someDir'
    }, 
```

在`src`这种情况下得到的是单个逗号分隔的字符串而不是数组。Grunt 的文件处理器不解析字符串，因此它找不到 src 文件。

我无法删除模板周围的单引号，因为它是无效的 javascript。

那么如何将该`grunt.regarde.changed`数组传递给`src`变量呢？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2014-06-27T08:26:53.983

一旦你知道如何解决这个问题很容易，只需几行代码，但我花了很长时间从 Grunt 源代码中挖掘所有相关信息以了解该怎么做，所以请耐心等待当我带你穿越背景时...

* * *

*获取配置对象*属性的一般方法很简单：

```
<%= some.property %> // fetches grunt.config.get('some.property') 
```

这适用于已在`grunt.config`对象上设置的所有属性，其中（当然）包括传递给`grunt.initConfig()`. 这就是为什么您可以直接引用其他任务变量的原因，例如 in `<%= concat.typescriptfiles.dest %>`，因为配置对象中的所有属性都在模板自己的范围内。

从技术上讲，当 (LoDash) 模板与`options`对象（如果已定义）或`grunt.config`对象一起传递给模板处理器（LoDash`template`函数）时，就会发生这种扩展。

因此，这适用于在配置本身中设置的值，或者通过使用动态分配的值`grunt.config.set()`。有关更多信息，请参阅[API 文档](http://gruntjs.com/api/grunt.config)。

不能以相同方式工作的是访问配置对象上不可用的值。似乎由于某种原因我不太确定，所有其他值总是以字符串结尾。无论您是直接访问它们还是通过方法调用，都会发生这种情况。例如，试图通过`grunt.config.get()`获取一个字符串来访问配置中的一个数组。

# 保留文件顺序的问题的解决方法

接受的答案以某种方式起作用，但由于使用通配符语法，它将被*不保留文件顺序*`glob()`的模块解析。这对我的构建来说是一个禁忌。

 *如果您要使用的数组在配置对象上不可用，一种解决方法是通过中间任务将其添加到配置中。像下面这样的东西应该可以工作：

```
// This variable will be used twice to demonstrate the difference
// between directly setting an attribute on the grunt object
// and using the setter method on the grunt.config object
var myFiles = ['c/file1.txt', 'a/file2.txt', 'b/file3.txt']
module.exports = function(grunt){

    grunt.initConfig({

        debug : {
            using_attribute: {
                src : '<%= grunt.value_as_attribute %>' // will be a string
            },
            using_task: {
                src : '<%= value_by_setter %>' // will be an array
            },
            no_task_direct_setter: {
                src : '<%= value_by_setter_early %>' // will be an array
            }
        }        
    });

    grunt.registerTask('myValSetter', function() {
        grunt.config.set('value_by_setter', myFiles );
    });

    // a task that will report information on our set values
    grunt.registerMultiTask('debug', function(){
        grunt.log.writeln('data.src: ', this.data.src);
        grunt.log.writeln('type: ', Array.isArray(this.data.src)? "Array" : typeof this.data.src);
    });

    grunt.value_as_attribute = myFiles;

    grunt.config.set('value_by_setter_early', myFiles );

    grunt.registerTask('default',['myValSetter', 'debug']);
} 
```

这将输出

```
$ grunt
Running "myValSetter" task

Running "debug:using_attribute" (debug) task
data.src:  c/file1.txt,a/file2.txt,b/file3.txt
type:  string

Running "debug:using_task" (debug) task
data.src:  [ 'c/file1.txt', 'a/file2.txt', 'b/file3.txt' ]
type:  Array

Running "debug:no_task_direct_setter" (debug) task
data.src:  [ 'c/file1.txt', 'a/file2.txt', 'b/file3.txt' ]
type:  Array

Done, without errors. 
```

这个例子只是为了说明这个概念，但你应该能够很容易地为你的实例定制它:)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-02-06T16:07:37.757

我遇到了和你完全相同的问题，通过用大括号括住你的模板来解决它。

所以这是您的代码，已修改

```
copy: {
  staticWeb: {
    src: '{<%= grunt.regarde.changed %>}', // added curly brackets
    dest: 'someDir'
  }
} 
```

它将输出`src`as `{source1,source2,source3}`，这与使用数组相同。（请参阅[Grunt 文档中的通配模式](http://gruntjs.com/configuring-tasks#globbing-patterns)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-09-09T21:47:54.467

```
// assuming that regarde is a grunt plugin (haven't used—link is broken)

copy: {
  staticWeb: {
    src: '<% regarde.changed %>',
    dest: 'someDir'
  }
} 
```

[http://gruntjs.com/api/grunt.config#grunt.config.getraw](http://gruntjs.com/api/grunt.config#grunt.config.getraw)

#ezpz

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2013-04-12T20:45:31.033

你有没有尝试过：

```
copy: {
  staticWeb: {
    src: '<%= grunt.regarde.changed.split(",") %>',
    dest: 'someDir'
  }
} 
```*

# java - 应用程序在 4.0.3 上崩溃，但在 4.0.4 上运行良好

> ID：15980402
> 
> 赞同：2
> 
> 时间：2013-04-12T20:35:02.267
> 
> 标签：java, android, sms

我正在使用 SMS 发送应用程序。它在我的 4.0.4 LG optimus 3D 上运行良好，但在我按下发送按钮后，4.0.3 SGS2 出现了一点问题，应用程序崩溃。错误日志在这里..它应该在飞行模式下显示一个 toast 'radio off'，但它崩溃了。在 4.0.4 设备上显示正确的祝酒词。发送，无线电关闭等。请参阅代码以供参考。

```
java.lang.NullPointerException
at android.os.Parcel.readException(Parcel.java:1333)
at android.os.Parcel.readException(Parcel.java:1281)
at com.android.internal.telephony.ISms$Stub$Proxy.sendText(ISms.java:698)
at android.telephony.SmsManager.sendTextMessage(SmsManager.java:113)
at com.bahxlabs.simplesms.MainActivity.sendSMS(MainActivity.java:85)
at com.bahxlabs.simplesms.MainActivity.access$0(MainActivity.java:48)
at com.bahxlabs.simplesms.MainActivity$1.onClick(MainActivity.java:41)
at android.view.View.performClick(View.java:3620)
at android.view.View$PerformClick.run(View.java:14292)
at android.os.Handler.handleCallback(Handler.java:605)
at android.os.Handler.dispatchMessage(Handler.java:92)
at android.os.Looper.loop(Looper.java:137)
at android.app.ActivityThread.main(ActivityThread.java:4507)
at java.lang.reflect.Method.invokeNative(Native Method)
at java.lang.reflect.Method.invoke(Method.java:511)
at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:790)
at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:557)
at dalvik.system.NativeStart.main(Native Method)` 
```

我的代码：

```
Button btnSendSMS;

@Override
protected void onCreate(Bundle savedInstanceState) 
{
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    btnSendSMS = (Button) findViewById(R.id.btnSendSMS);
    btnSendSMS.setOnClickListener(new OnClickListener()
    {
        public void onClick(View v)
        {
            EditText editText = (EditText)findViewById(R.id.editText1);
            String phn = editText.getText().toString();
            EditText msgText = (EditText)findViewById(R.id.editText3);
            String msg = msgText.getText().toString();
            sendSMS(phn,msg);
        }
    });
} 
```

发送短信方法：

```
@SuppressLint("NewApi")
private void sendSMS(String phoneNumber, String message)
{
    String SENT="SMS SENT";
    PendingIntent sentPI=PendingIntent.getBroadcast(this,0,new Intent(SENT),0);
    registerReceiver(new BroadcastReceiver()
    {
        public void onReceive(Context arg0, Intent arg1) 
        {
            switch (getResultCode())
            {
                case Activity.RESULT_OK:
                    Toast.makeText(getBaseContext(), "SMS sent",Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_GENERIC_FAILURE:
                    Toast.makeText(getBaseContext(), "Generic failure",Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_NO_SERVICE:
                    Toast.makeText(getBaseContext(), "No service",Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_NULL_PDU:
                    Toast.makeText(getBaseContext(), "Null PDU",Toast.LENGTH_SHORT).show();
                    break;
                case SmsManager.RESULT_ERROR_RADIO_OFF:
                    Toast.makeText(getBaseContext(), "Radio off",Toast.LENGTH_SHORT).show();
                    break;
            }
        }
    }, 
    new IntentFilter(SENT));

    recreate();

    SmsManager sms = SmsManager.getDefault();
    sms.sendTextMessage(phoneNumber,  null, message,sentPI,null);
} 
```

希望能说明情况

# python - 打印 numpy 数组的全部内容

> ID：15980405
> 
> 赞同：11
> 
> 时间：2013-04-12T20:35:06.530
> 
> 标签：python, printing, numpy

我正在使用 python 进行图像处理，我想输出一个变量，现在该变量`b`是一个带有 shape 的 numpy 数组`(200,200)`。当我做的时候，`print b`我看到的是：

```
array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       ..., 
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]]) 
```

如何打印出这个数组的全部内容，将其写入文件或简单的东西，以便我可以完整查看内容？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-12T21:11:02.170

当然，您可以更改数组的打印阈值，如[在其他地方回答](https://stackoverflow.com/q/1987694/1730674)的那样：

```
np.set_printoptions(threshold=np.nan) 
```

但是根据您要查看的内容，可能有更好的方法来做到这一点。例如，如果您的数组确实如您所展示的那样大部分为零，并且您想检查它是否具有非零值，您可能会查看以下内容：

```
import numpy as np
import matplotlib.pyplot as plt

In [1]: a = np.zeros((100,100))

In [2]: a
Out[2]: 
array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       ..., 
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]]) 
```

更改一些值：

```
In [3]: a[4:19,5:20] = 1 
```

它看起来仍然一样：

```
In [4]: a
Out[4]: 
array([[ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       ..., 
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.],
       [ 0.,  0.,  0., ...,  0.,  0.,  0.]]) 
```

检查一些不需要手动查看所有值的东西：

```
In [5]: a.sum()
Out[5]: 225.0

In [6]: a.mean()
Out[6]: 0.022499999999999999 
```

或绘制它：

```
In [7]: plt.imshow(a)
Out[7]: <matplotlib.image.AxesImage at 0x1043d4b50> 
```

或保存到文件：

```
In [11]: np.savetxt('file.txt', a) 
```

![大批](https://i.stack.imgur.com/VtzFS.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:46:51.797

```
to_print = "\n".join([", ".join(row) for row in b])
print (to_print) #console

f = open("path-to-file", "w")
f.write(to_print) #to file 
```

如果它是 numpy 数组：[打印完整的 numpy 数组](https://stackoverflow.com/questions/1987694/print-the-full-numpy-array)

# wpf - New 不能在 MustInherit WPF VB.NET 的类中使用

> ID：15980406
> 
> 赞同：1
> 
> 时间：2013-04-12T20:35:09.980
> 
> 标签：wpf, vb.net, xaml

我在 vb.net 中有以下代码。我正在使用 WPF，并且在 XAML 中我在图像上有一个转换器。基本上基于状态级别的图像应该显示一个特定的图像。

我在使用这种语法时遇到了问题。我在“ImageSource”上有一个错误，因为它说“New 不能在 MustInherit 的类中使用”。我尝试删除 New 并将 ImageSource 声明为字符串，但代码不会将任何内容返回到我的 XAML 中。我需要做什么？！？

```
 Public Function Convert(ByVal value As Object, _ 
                            ByVal targetType As System.Type, 
                            ByVal parameter As Object, 
                            ByVal culture As System.Globalization.CultureInfo) _ 
        As Object Implements System.Windows.Data.IValueConverter.Convert
    Dim EstadoIndex As Integer
    If Integer.TryParse(value.ToString, EstadoIndex) Then
        Select Case EstadoIndex
            Case 1
                Return New ImageSource("/Cogent;component/Images/Green.png")
            Case 2
                Return New ImageSource("/Cogent;component/Images/Red.png")
            Case Else
                Return New ImageSource("/Cogent;component/Images/White.png")
        End Select
    Else
        Return New ImageSource("/Cogent;component/Images/White.png")
    End If
End Function 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:45:12.020

`ImageSource`是一个抽象类（我想`MustInherit`这就是你`abstract`在 VB.NET 中的命名方式）。如果要返回图像，可以使用[BitmapImage](http://msdn.microsoft.com/en-us/library/system.windows.media.imaging.bitmapimage.aspx)，它将为您将图像加载到内存中，请使用`new BitmapImage(new Uri("/Cogent;component/Images/Green.png"))`

此外，如果您需要将其设置为`Image.Source`- 您可以只返回字符串，`Image`将加载图像。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:10:10.973

感谢 OutColdMan 和 Pondidum，

我不得不做一些小偷小摸，但基本上这两个想法都在钱上。如果有人感兴趣，这是最终代码！

```
 Public Function Convert(ByVal value As Object, ByVal targetType As System.Type, ByVal parameter As Object, ByVal culture As System.Globalization.CultureInfo) As Object Implements System.Windows.Data.IValueConverter.Convert
    Dim EstadoIndex As Integer
    Dim bi As New BitmapImage()
    bi.BeginInit()
    'Dim ImageSource As String = "/Cogent;component/Images/White.png"
    If Integer.TryParse(value.ToString, EstadoIndex) Then
        Select Case EstadoIndex
            Case 1
                bi.UriSource = New Uri("/Cogent;component/Images/Green.png", UriKind.RelativeOrAbsolute)
                Return bi
                bi.EndInit()
            Case 2
                bi.UriSource = New Uri("/Cogent;component/Images/Red.png", UriKind.RelativeOrAbsolute)
                Return bi
                bi.EndInit()
            Case Else
                bi.UriSource = New Uri("/Cogent;component/Images/White.png", UriKind.RelativeOrAbsolute)
                Return bi
                bi.EndInit()
        End Select
    Else
        bi.UriSource = New Uri("/Cogent;component/Images/White.png", UriKind.RelativeOrAbsolute)
        Return bi
        bi.EndInit()
    End If
End Function 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:46:07.140

检查MSDN 上的[ImageSource](http://msdn.microsoft.com/en-gb/library/system.windows.media.imagesource.aspx)表明您需要使用它的子类之一，即[BitmapImage](http://msdn.microsoft.com/en-gb/library/system.windows.media.imaging.bitmapimage.aspx)

# c# - 不能为 /link 和 /reference 编译器选项指定程序集 stdformat.dll

> ID：15980408
> 
> 赞同：0
> 
> 时间：2013-04-12T20:35:35.950
> 
> 标签：c#, .net, visual-studio

目前使用 Visual Studios 2012 将 VB6 项目转换为 C#.NET。编译时出现以下错误消息：

```
The assembly 'c:\Windows\assembly\GAC\Microsoft.StdFormat\7.0.3300.0__b03f5f7f11d50a3a\Microsoft.stdformat.dll'
cannot be specified for both /link and /reference compiler options 
```

我试图摆脱与 COM 互操作和 StdFormat 相关的任何事情（虽然不确定有多成功），并且不知道从哪里开始。有人知道吗？

# c# - Simplemembership 的超时选项

> ID：15980413
> 
> 赞同：1
> 
> 时间：2013-04-12T20:35:53.610
> 
> 标签：c#, asp.net-mvc, simplemembership

simplemembership 是否有一种简单的方法来设置超时以在您处于非活动状态时经过一定时间后自动将您注销？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:52:27.443

SimpleMembership 不提供您可以配置的超时，身份验证机制提供。

如果您使用 FormsAuthentication，您可以在此处设置此超时：

```
<authentication mode="Forms">
  <forms loginUrl="~/Login" timeout="20" slidingExpiration="true" />
</authentication> 
```

在上面的示例中，超时设置为 20 分钟。这意味着一旦用户通过身份验证，身份验证 cookie（包含身份验证票证）将在 20 分钟不活动后过期。

成员资格提供者负责验证用户凭据，以及其他职责。但是，它不负责“识别”经过身份验证的用户的后续请求。

请查看[这篇](http://brockallen.com/2012/06/04/membership-is-not-the-same-as-forms-authentication/)文章，以便您更好地了解幕后发生的事情。

# html - 使用 HTML/CSS vs 设置网页的背景图片

> ID：15980414
> 
> 赞同：0
> 
> 时间：2013-04-12T20:35:57.263
> 
> 标签：html, css, background

我有一个 HTML 文件和一个 CSS 文件的链接。我通过这样做（在CSS文件中的body标签下）让它在CSS文件下显示重复的背景图像，它可以工作：

```
body {
    /*Set background image*/
    background: url("../img/background/main.jpg") repeat;
} 
```

但是当我尝试这样做时（在 CSS 文件中的 html 标记下）它不起作用：

```
html {
    /*Set background image*/
    background: url("../img/background/main.jpg") repeat; 
```

根据此站点，它显示了使用 html 标记的示例： [此站点显示 css 中的 html 与 html 标记一起使用](http://css-tricks.com/perfect-full-page-background-image/)

那么我该如何进行这项工作，或者我不应该这样做呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:38:13.957

将 CSS 放在 HTML 标签上通常被认为是不好的做法，因此您应该将其保留在 body 标签上。通常这是出于语义原因 - HTML 元素包含不应该也不能应用样式的子元素（即头部）。

开发人员倾向于将样式应用于 HTML 元素，或者因为他们不知道更好，或者避免向 DOM 添加其他元素，但这并不正确。

方便地，使用 body 元素已经为您工作了，所以 nbd. :)

# java - 不幸的是，应用程序已停止

> ID：15980420
> 
> 赞同：-2
> 
> 时间：2013-04-12T20:36:21.117
> 
> 标签：java, android, manifest

不幸的是，应用程序已停止。该应用程序的目的是在启动时显示网页。我研究了这个问题，并尝试更改清单文件中的代码。我未能成功消除此消息。

```
MainActivity.java

package com.example.testb1;

import android.os.Bundle;
import android.app.Activity;
import android.view.Menu;

import android.content.Intent;
import android.net.Uri;

 public class MainActivity extends Activity {

@Override
public void onCreate(Bundle savedInstanceState)

    {
    Intent getmobilepages = new Intent(Intent.ACTION_VIEW);
    Uri uri =    Uri.parse("http://www.mcohio.org/government/auditor/mobile_app/home.cfm");
    getmobilepages.setData(uri);
    startActivity(getmobilepages);
    } 
```

}

testb1 清单

```
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     package="com.example.testb1"
     android:versionCode="1"
     android:versionName="1.0" >

     <uses-sdk
         android:minSdkVersion="8"
         android:targetSdkVersion="17" />

     <application
         android:allowBackup="true"
         android:icon="@drawable/ic_launcher"
         android:label="@string/app_name"
         android:theme="@style/AppTheme" >
         <activity
             android:name="com.example.testb1.MainActivity"
             android:label="@string/app_name" >
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
                 <category android:name="android.intent.category.LAUNCHER" />

                 <action android:name="android.intent.action.getmobilepages" />
             </intent-filter>
         </activity>
     </application>

 </manifest> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:37:47.460

编辑：我尝试运行您的代码并且完全错误。你只是错过了这一行：

```
super.onCreate(savedInstanceState); 
```

在您的 oncreate 方法开始时。添加它，它应该编译得很好。

确保将来发布您的 logcat，错误会在那里清楚地识别出来。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:02:03.107

你没有调用 super 你会得到 SuperNotCalled 异常。您需要设置布局。最好在按钮单击时开始另一个活动。

在清单中添加互联网权限

```
 <uses-permission android:name="android.permission.INTERNET"/> 
```

主要活动

```
 public class MainActivity extends Activity {

Button b;
@Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
// call  super
setContentView(R.layout.activity_main);
// set your layout 
b = (Button) findViewById(R.id.button1);
//get button id  
b.setOnClickListener(new OnClickListener()
{
            public void onClick(View v)
            {
                // do something
                 Intent getmobilepages = new Intent(Intent.ACTION_VIEW);
                 Uri uri = Uri.parse("http://www.mcohio.org/government/auditor/mobile_app/home.cfm");
                 getmobilepages.setData(uri);
                 startActivity(getmobilepages);         
            } 
}); 
}
} 
```

# elasticsearch - Elasticsearch 自动完成和搜索多个术语字段

> ID：15980422
> 
> 赞同：1
> 
> 时间：2013-04-12T20:36:25.813
> 
> 标签：elasticsearch

我正在将弹性搜索集成到资产跟踪应用程序中。当我最初设置映射时，我设想“品牌”字段是像“日立”或“福特”这样的单项字段。相反，我发现实际数据中的品牌字段包含多个术语，例如：“MB 7 A/B”、“B-7”甚至“Brush Bull BB72X”。

我有一个自动完成组件设置，现在我配置为对 edgeNGram 字段执行自动完成，并针对 nGram 字段执行实际搜索。我设置它的方式完全没用，因为用户希望搜索结果仅限于自动完成匹配的内容。

关于设置我的映射以支持自动完成和随后针对这样的多个术语字段的搜索的最佳方式有什么建议吗？我正在考虑针对关键字字段进行术语查询，或者可能是使用“和”作为运算符的匹配查询？我还必须处理像“B-7”这样的连字符。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-06-23T13:22:49.027

您可以使用短语建议，指南在这里： [http ://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-suggesters.html](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-suggesters.html)

短语建议指南在这里： [http ://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-suggesters-phrase.html](http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-suggesters-phrase.html)

# java - 在递归中使用方法时输出不正确。方法中的 return 语句在输出的末尾返回一个整数

> ID：15980423
> 
> 赞同：0
> 
> 时间：2013-04-12T20:36:28.303
> 
> 标签：java

```
package abcde;

public class Abcde{

    public static void main(String[] args){
        System.out.println(recursion(97));
    }

    public static int recursion (int n) {
        for ( int i = n; i< 123; i++)
        {
            String achar = new Character((char)i).toString();
            System.out.print(achar);

        }
        return -1; 
    }
} 
```

所需的输出必须是 abcdefghijklmnopqrstuvwxyz 而输出是 abcdefghijklmnopqrstuvwxyz-1

我不想要最后的-1。当我将输入类型更改为 void 时，该方法不起作用。

我们对于它可以做些什么呢？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:39:46.187

final`-1`在方法之外打印`recursion`：`main()`打印`recursion`返回的内容，恰好是`-1`.

如果更改 to 的返回类型，`recursion`则`void`需要将其作为方法调用，而不是作为表达式调用。换句话说，您不能再调用`println(recursion(97))`，因为`println`需要打印一个值。

作为旁注，为了递归，方法需要有一个直接或间接调用相同方法的代码路径。由于您的`recursion`方法缺少“调用自身”功能，请考虑将其重命名为`iteration`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T20:39:12.583

将其重写为：

```
public static void main(String[] args){
    noRecursion(97);
}

public static void noRecursion (int n) {
            //^^^^
    for (int i = n; i< 123; i++) {
        System.out.print((char)i);
     } 
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-12T20:39:56.543

实际上，您的`recursion`函数除了 之外什么都不返回，**但** `-1`它确实在返回之前打印了所有其他字符。

如果你把它改成

```
public static void notRecursion (int n) {
    for ( int i = n; i< 123; i++)
    {
        String achar = new Character((char)i).toString();
        System.out.print(achar);

    }
} 
```

然后从你的主要调用它

```
notRecursion(97); 
```

它将打印您想要打印的内容

* * *

或者

```
public static String recursion (int n) 
{
    if(n >97 +1)
    {
        System.out.print(recursion(n-1)); 
    }

    String achar = new Character((char)n).toString();
    return(achar)
} 
```

然后用

```
System.out.println(recursion(123)); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T20:42:02.010

选择纯函数而不是副作用：

```
public static String iteration (int n) {
    final StringBuilder b = new StringBuilder();
    for (char c = (char)n; c < 123; c++)
        b.append(c);

    return b.toString();
} 
```

现在您可以像现在一样调用此方法，并打印其结果。

# wordpress - 为完美的 Wordpress 环境配置 VirtualHost

> ID：15980427
> 
> 赞同：4
> 
> 时间：2013-04-12T20:36:31.400
> 
> 标签：wordpress, apache2, virtualhost, httpd.conf, rackspace

我正在尝试在带有机架空间的云服务器中安装 wordpress。

但是我在服务器配置（LAMP 等）方面缺乏知识，这让我做了很多错过的配置。

首先，我认为 .httaccess 是不允许的。其次，不允许更新 Wordpress 和特色插件 第三可能是更多数字...

让我展示我的虚拟主机文件：

```
 <VirtualHost *:80>
  # Admin email, Server Name (domain name) and any aliases
  ServerAdmin adrian@my.com
  ServerName  my.com
  ServerAlias www.my.com

  # Index file and Document Root (where the public files are located)
  DirectoryIndex index.html, index.php
  DocumentRoot /home/devdreams/domains/my.com/public

  # Custom log file locations
  LogLevel warn
  ErrorLog  /home/devdreams/domains/my.com/log/error.log
  CustomLog /home/devdreams/domains/my.com/log/access.log combined

    <Directory />
      Options FollowSymLinks
      AllowOverride All
      Order deny,allow
      Deny from all
      Satisfy all
    </Directory>

  AccessFileName .htaccess

    <Directory /home/devdreams/domains/>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/
    <Directory "/usr/lib/cgi-bin">
        AllowOverride None
        Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch
        Order allow,deny
        Allow from all
    </Directory>

    Alias /doc/ "/usr/share/doc/"

    <Directory "/usr/share/doc/">
        Options Indexes MultiViews FollowSymLinks
        AllowOverride None
        Order deny,allow
        Deny from all
        Allow from 127.0.0.0/255.0.0.0 ::1/128
    </Directory>

    LoadModule rewrite_module modules/mod_rewrite.so

</VirtualHost> 
```

有人可以帮我为 wordpress 环境配置我的 VH

塔克斯

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-12T20:51:24.517

您的 .htaccess 将不起作用，因为您有`AllowOverride None`，将其更改为`AllowOverride All`

就能够更新 Wordpress 和插件而言，您需要将文件/目录的所有权更改为运行网络服务器的用户。例如： `chown -R apache:apache /home/devdreams/domains/`

# javascript - 从 Chrome 开发工具调用 JS 函数

> ID：15980428
> 
> 赞同：0
> 
> 时间：2013-04-12T20:36:32.463
> 
> 标签：javascript, google-chrome-devtools

我有 JS 功能。如何从 chrome 开发工具调用它？有什么方法可以插入它的参数？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:42:25.947

在此处输入：

![在此处输入图像描述](https://i.stack.imgur.com/pAp9P.png)

它是检查器窗口中的控制台。

# powershell - 使用以 DisplayName 命名的文件夹导入 GPO - Powershell

> ID：15980430
> 
> 赞同：2
> 
> 时间：2013-04-12T20:36:38.723
> 
> 标签：powershell, powershell-2.0, powershell-3.0

我正在使用 powershell 脚本导入已保存为 GUID（默认）的 GPO。

我希望在不同的系统上导入 GPO，此时 GPO 已保存到 CD。因此，导入单个 GPO 的简单方法是：

```
$domain=[System.DirectoryServices.ActiveDirectory.Domain]::GetCurrentDomain().Name

$import_array = get-childitem ($current_drive + $gpo_backup_location) | Select name
foreach ($GPO in $import_array) {
Import-GPO |
-backupgponame $GPO.name -path ($Current_Drive + $gpo_backup_location) |
-domain $domain | 
-Targetname $GPO.name |
-migrationtable ($Current_drive + $mig_table_path) |
-Createifneeded;
}
} 
```

$import_array 命令给了我我的文件夹名称

```
Name
----------
GPO-1
GPO-2
GPO-3
GPO-4
and so on... 
```

我想遍历这些并导入每一个。使用另一个代码块保存 GPO，以将 GPO 备份为它们的显示名称。（GPO-1、GPO-2 等）

我一生都无法弄清楚如何强制它查看文件夹名称并导入这些

## 编辑

* * *

备份是使用以下代码创建的：

```
Function GPO_Backup_DisplayName ($MenuChoice) {
    write 'Backing Up GPOs by Display Name'
    Foreach ($GPO in $GPO_Temp_Backup) {
        $GPOBackup = Backup-GPO `
            -name $GPO.DisplayName `
            -path ($Current_drive + $GPO_Backup_Location) `
            -Domain $domain;
        Get-GPOReport $GPO.DisplayName `
            -reporttype HTML `
            -Domain $domain `
            -path ($Current_drive + $GPO_Backup_HTML_Report + $GPO.DisplayName + ".html");
        Rename-item 
            -path ($Current_drive + $GPO_Backup_Location + "{" + $GPOBackup.Id + "}") `
            -newname $GPO.DisplayName
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T00:26:25.107

如果将每个 GPO 导出到其自己的文件夹并在 GPO 之后命名该文件夹，则可以循环遍历这些文件夹`foreach`以导入 GPO 并将目标名称设置为文件夹名称。像这样的东西应该工作：

```
Get-ChildItem "C:\backup" | % {
  $name = $_.name
  $id = (get-childitem $_) -replace '[{}]', ''
  Import-GPO -BackupId $id -TargetName $name -path $_.Path -CreateIfNeeded
} 
```

先决条件是您使用以下内容创建了备份：

```
Get-GPO -All | % {
  $name = $_.DisplayName
  $dir = New-Item "C:\backup\$name" -Type Directory
  Backup-GPO -Guid $_.Id -Path $dir
} 
```

此外，备份目录应仅包含具有单个 GPO 备份的文件夹，否则您必须在 和 之间添加过滤`Get-ChildItem`器`ForEach-Object`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-03T20:31:41.430

使用 PowerShell 列出组策略对象

# c++ - 清洁窗口套接字内部缓冲区

> ID：15980438
> 
> 赞同：1
> 
> 时间：2013-04-12T20:37:24.757
> 
> 标签：c++, sockets, winsock, msdn

我想知道是否有办法清理窗口套接字内部缓冲区，因为我想要实现的是这个

```
while(1){
 for(i=0;i<10;i++){
    sendto(...) //send 10 UDP datagrams
 }
 for(i=0;i<10;i++){
    recvfrom (Socket, RecBuf, MAX_PKT_SIZE, 0,
                   (SOCKADDR*) NULL, NULL);
    int Status = ProcessBuffer(RecBuf);
    if (Status == SomeCondition)
        MagicalSocketCleanUP(Socket); //clean up the rest of stuff in the socket, so that it doesn't effect the reading for next iteration of the outer while loop
        break; //occasionally the the receive loop needs to terminate before finishing off all 10 iteration
 }
} 
```

所以我问是否有一个功能可以清理套接字中剩余的任何东西，这样它就不会影响我的下一次阅读？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:08:08.383

从内部接收套接字缓冲区中清理数据的方法是读取数据，直到没有更多数据可读取。如果以非阻塞方式执行此操作，则无需在 中等待更多数据`select()`，因为`EWOUDBLOCK`错误值意味着内部接收套接字缓冲区为空。

```
int MagicalSocketCleanUP(SOCKET Socket) {
    int r;
    std::vector<char> buf(128*1024);
    do {
        r = recv(Socket, &buf[0], buf.size(), MSG_DONTWAIT);
        if (r < 0 && errno == EINTR) continue;
    } while (r > 0);
    if (r < 0 && errno != EWOULDBLOCK) {
        perror(__func__);
        //... code to handle unexpected error
    }
    return r;
} 
```

但这并不完全安全。套接字的另一端也可能已经向套接字缓冲区发送了良好的数据，因此该例程可能丢弃的数据比您要丢弃的数据多。

相反，套接字上的数据应该以您知道感兴趣的数据何时到达的方式构建。`ProcessBuffer()`因此，您可以扩展以丢弃输入，直到找到感兴趣的数据，而不是清理 API 。

更简单的机制是套接字两侧之间的消息交换。当进入错误状态时，发送者发送“DISCARDING UNTIL `<TOKEN>`”消息。接收方发回“ `<TOKEN>`”并知道只有“ `<TOKEN>`”消息之后的数据会被处理。“ `<TOKEN>`”可以是随机序列。

# php - 是否可以使用 Microsoft Word .docx 文件在服务器上动态生成 HTML 页面？

> ID：15980443
> 
> 赞同：0
> 
> 时间：2013-04-12T20:37:35.783
> 
> 标签：php, ms-word

让我简单地提出我的问题：（PHP）服务器是否可以使用也在服务器上的 Microsoft Word .docx 文档动态生成 HTML 页面？我希望 Microsoft Word 文档的内容在 body 标记中加载为 HTML。

例如，如果 Microsoft Word 文档仅包含短语“Hello world”而没有其他内容，我希望输出 HTML 如下所示：

```
<!doctype html>
<html>
    <head>
        <title>Random</title>
        <meta charset="utf-8">
        <link rel="stylesheet" href="style.css">
    </head>

    <body>
        <p>Hello world</p>
    </body>
</html> 
```

这可能吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T20:47:57.060

我认为你给自己提出了错误的问题。您将不得不使用 php 来读取您的文档，并在此基础上将其输出为 html。看看这里：[如何使用 php 将 docx 文档转换为 html？](https://stackoverflow.com/questions/4587216/how-can-i-convert-a-docx-document-to-html-using-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:48:08.500

是的，这是可能的。棘手的部分是阅读文档的内容。一旦你有了它，在你的 HTML 中显示内容就很简单了。

为了阅读内容，我建议您在 SO 上进行 Google 搜索或在此处搜索 - 有几个库可以帮助您：

*   [多维特](http://static.holloway.co.nz/docvert/index.html)
*   [PHPLiveDicX](http://www.phplivedocx.org/downloads/)

# javascript - 如何将 jquery 效果应用于使用 getElementById 插入的生成的 HTML？

> ID：15980449
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:37:52.020
> 
> 标签：javascript, jquery, getelementbyid

这似乎不起作用：

```
 <script>
    window.onload = function()   
    {    
        var div = '<div id="accordion">';
        div += '<div>';
          div += '<h3>section1</h3>';
          div += '<p>text 1</p>';
          div += '</div>';
        div += '<div>';
          div += '<h3>section2</h3>';
          div += '<p>text 2</p>';
        div += '</div>';
        div += '</div>';

        document.getElementById("list").innerHTML = div;
    }
    </script> 
```

带有指向 jquery 库的链接的其余 html 被排除在此代码之外

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:00:04.913

如果你想使用 jqueryui 手风琴，你的 html 代码是错误的，[根据 jqueryUi](http://jqueryui.com/accordion/) doc，你必须试试这个：

```
function initAccordion (){
    $(function() { 
        $( "#accordion" ).accordion({ heightStyle: "content" }); 
    });
}

window.onload = function()   
{    
    var div = '<div id="accordion">';
    div += '<h3>section1</h3><div>';
    div += '<p>text 1</p>';
    div += '</div>';
    div += '<h3>section2</h3><div>';
    div += '<p>text 2</p>';
    div += '</div>';
    div += '</div>';

    document.getElementById("list").innerHTML = div;
    //init jquery accordion
    initAccordion();    
 } 
```

看[这个例子](http://jsfiddle.net/edbNu/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:12:40.197

如果我没看错的话，有一个 ID 为手风琴的 div，其中包含两个 div。这两个 div 中的每一个都有一个标题标签和一个段落标签。两个标题标签和两个段落标签都包含副本。

我想不出一种非常简洁的方法来做到这一点，因为很多元素都是在动态创建的。我确实认为使用 createElement() 创建所有非 DOM 的东西，使用 appendChild() 对其进行安排，然后通过文档片段将它们全部加载是一种很好的方法，因为从性能的角度来看它明显更好。[Paul Irish 在这里](http://www.youtube.com/watch?feature=player_embedded&v=q_O9_C2ZjoA)详细介绍了这一切。

```
 $(function(){
    // on the page already...just targeting it with a variable
    var onPageEl = document.getElementById('list');

    // created off-DOM...we'll load our stuff here before loading it onto the page
    var frag = document.createDocumentFragment();

    // create elements
    var accordion = document.createElement('div');
    var div1 = document.createElement('div');
    var header1 = document.createElement('h3');
    var somePara1 = document.createElement('p');
    var div2 = document.createElement('div');
    var header2 = document.createElement('h3');
    var somePara2 = document.createElement('p');

    // use jQuery to give our containing element an ID of 'accordion'
    $(accordion).attr('id', 'accordion');

    // arrange the first bulk of div code
    accordion.appendChild(div1);
    div1.appendChild(header1);
    div1.appendChild(somePara1);
    header1.innerHTML = "section1";
    somePara1.innerHTML = "text1";

    // arrange the second bulk of div code
    accordion.appendChild(div2);
    div2.appendChild(header2);
    div2.appendChild(somePara2);
    header2.innerHTML = "section2";
    somePara2.innerHTML = "text2";

    // Load both bulks of content into the document fragment
    frag.appendChild(div1);
    frag.appendChild(div2);

    // Load the document fragment onto 'list' which is already on the page
    onPageEl.appendChild(frag);
  }); 
```

由于有些东西被创建了两次，所以可以使用一个函数来创建东西，但这可能会产生性能问题。

只是我的 0.02 美元...

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:42:00.473

如果你想要做的是对新内容做某种动画，你可以这样做：

```
<script>
window.onload = function()   
{    
    var div = '<div id="accordion" style="display: none;">';
    div += '<div>';
      div += '<h3>section1</h3>';
      div += '<p>text 1</p>';
      div += '</div>';
    div += '<div>';
      div += '<h3>section2</h3>';
      div += '<p>text 2</p>';
    div += '</div>';
    div += '</div>';

    document.getElementById("list").innerHTML = div;
    $("#accordion").fadeIn(2000);
}
</script> 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T20:43:29.757

转换这个：

```
window.onload = function()   
{    
    var div = '<div id="accordion">';
    div += '<div>';
      div += '<h3>section1</h3>';
      div += '<p>text 1</p>';
      div += '</div>';
    div += '<div>';
      div += '<h3>section2</h3>';
      div += '<p>text 2</p>';
    div += '</div>';
    div += '</div>';

    document.getElementById("list").innerHTML = div;
} 
```

进入这个：

```
$(window).on('load',function(){
    var div = '<div id="accordion">';
        div += '<div>';
        div += '<h3>section1</h3>';
        div += '<p>text 1</p>';
        div += '</div>';
        div += '<div>';
        div += '<h3>section2</h3>';
        div += '<p>text 2</p>';
        div += '</div>';
        div += '</div>';

    $('#list')
            .html(div)
            .promise()
            .done(function(){    
                $('#accordion').animate({opacity:0.2},1000);
            });
}); 
```

或者你想做的任何动画。基本上为对象创建一个服务员，`.promise()`直到所有操作都完成并`.done(function(){})`为其附加一个成功的回调。非常漂亮，您现在可以对任何元素执行此操作。

[.promise() 信息在这里](http://api.jquery.com/promise/)，[.done() 信息在这里](http://api.jquery.com/deferred.done/)

作为旁注，你真的应该考虑你正在做的附加。这可以在 HTML 中，设置为`display:none`，然后根据特定的内容在加载时显示吗？只是需要考虑的事情。

**编辑**：新方法，[在这里用基本动画测试](http://jsfiddle.net/B4M8C/)。作品。

# vim - CursorLine 和 NonText / SpecialKey 高亮冲突

> ID：15980451
> 
> 赞同：7
> 
> 时间：2013-04-12T20:37:57.207
> 
> 标签：vim

使用`:set cursorline`and ，当光标在同一行时，和高亮组`:set list`中的字符（例如，在每行的末尾，由+产生）失去高亮显示，像任何其他平淡的文本一样恢复到高亮组。这是非常令人困惑、丑陋和糟糕的。`NonText``SpecialKey``$``^M``Ctrl``V``Enter``Normal`

这些是我的配置中的相关亮点：

```
:hi Conceal      term=reverse    cterm=none      ctermfg=237     ctermbg=none
:hi CursorLine   term=underline  cterm=none      ctermfg=none    ctermbg=235
:hi NonText      term=reverse    cterm=none      ctermfg=237     ctermbg=none
:hi Normal       term=none       cterm=none      ctermfg=252     ctermbg=234
:hi SpecialKey   term=reverse    cterm=none      ctermfg=14      ctermbg=23 
```

无论我的高亮配置如何（包括根本没有配置），问题仍然存在。我知道一些高亮组总是胜过其他组，但是其他组（`Conceal`例如）的语法高亮和高亮保持不变；有没有办法制作`NonText`和`SpecialKey`保留他们的亮点？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T23:24:14.293

据我所知，没有。Bram Moolenaar就此事[发表了以下看法：](http://comments.gmane.org/gmane.editors.vim.devel/15511)

> 没有解决办法。[...]光标线突出显示需要推翻语法突出显示，否则它会在几种情况下消失，尤其是。如果语法突出显示使用背景突出显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-01-11T12:08:20.340

如果您只想突出显示光标所在的行号，您可以使用

```
hi CursorLineNr  term=underline  cterm=none      ctermfg=none    ctermbg=235
hi CursorLine    term=NONE cterm=NONE 
```

(vim8)

# dns - 使用子域和 CNAME 是否会影响 DNS 查找时间？

> ID：15980455
> 
> 赞同：2
> 
> 时间：2013-04-12T20:38:21.653
> 
> 标签：dns, nameservers

使用子域和 CNAME 是否会减慢 DNS 查找时间？据我了解，例如，如果客户想要查找，则`rweb.stat.ucla.edu`至少需要四个步骤：

```
[registrar] NS ucla.edu ==> ns2.dns.ucla.edu
[ns2.dns.ucla.edu] NS stat.ucla.edu ==> dns.stat.ucla.edu
[dns.stat.ucla.edu] CNAME rweb.stat.ucla.edu ==> id-86-243.stat.ucla.edu
[dns.stat.ucla.edu] A id-86-243.stat.ucla.edu  ==> 128.97.86.243 
```

这是否意味着客户端在访问页面时必须连接到这些服务器中的每一个？或者 DNS 服务器是否相互连接并直接解析（和缓存）`rweb.stat.ucla.edu ==> 128.97.86.243`？我也不清楚找到根域的初始记录需要做多少工作？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T21:31:35.783

首先，注册商*从不*参与实际的 DNS 查找。注册商（实际上是注册管理机构）是 DNS 协议范围之外的管理实体。实际的查找过程看起来更像这样：

1.  向根服务器询问 `A`.`rweb.stat.ucla.edu.`
    *   他们不会告诉你，但他们会为你指出`edu.`.
2.  向`edu.`服务器询问 `A`.`rweb.stat.ucla.edu.`
    *   他们不会告诉你，但他们会为你指出服务器`ucla.edu.`
3.  向`ucla.edu`服务器询问 `A`.`rweb.stat.ucla.edu.`
    *   `stat.ucla.edu`可能是委托给另一组名称服务器的区域，在这种情况下，您将第三次获得推荐答案。
    *   但不能说不是。
    *   你得到一个答案：`rweb.stat.ucla.edu.`有`CNAME` `id-86-243.stat.ucla.edu`。

现在你必须重新开始并抬头看`id-86-243.stat.ucla.edu`......

...除了因为目标与原始记录`CNAME`在同一个区域内（或者，一般来说，在恰好由同一个名称服务器提供服务的任何区域内），名称服务器将有助于您在DNS 响应的附加部分。解析器会注意到这一点，并且不必在记录本身之后运行。`A``id-86-243.stat.ucla.edu``A`

因为解析器缓存了答案，所以可以从缓存中回答许多查询，实际上不必每次都询问。特别是查询的前几个步骤很可能已经被解析器缓存了，除非在它启动后立即使用冷缓存。因此，解析器通常可以从第 3 步开始（因为它会记住`ucla.edu.`来自其缓存的名称服务器是什么）或至少在第 2 步（因为它记得名称服务器`edu.`是什么）如果它还不知道最终答案。

所以对你的问题的简短回答是**肯定**的，使用`CNAME`为解析器做更多的工作并使解析过程花费更长的时间。但实际上这并不重要，因为解析器的缓存非常有用。如果`CNAME`'s 的目标与记录本身位于同一区域`CNAME`，则由于有用的附加记录，它的重要性就更小了。

# android - ACS ACR122 SDK Android 点对点支持？

> ID：15980456
> 
> 赞同：5
> 
> 时间：2013-04-12T20:38:22.913
> 
> 标签：android, nfc, nfc-p2p, acr122

我希望使用他们的 SDK 通过 USB 将 ACS ACR122 连接到 Android 平板电脑。这部分有效，我可以读取 Mifare NFC 卡。

问题：当我点击 ACR122 时，我无法读取 Galaxy S3 或 Nexus S 等 NFC 智能手机。

在查看 ACS 提供的内容时，他们似乎忽略了 Android SDK 对等通信支持。

有谁知道解决方案、解决方法或替代方案。我正在尝试让我的平板电脑能够从 NFC 智能手机读取数据。

非常感激任何的帮助。

# excel - Excel中的1/3倍频程图表？

> ID：15980460
> 
> 赞同：0
> 
> 时间：2013-04-12T20:38:28.447
> 
> 标签：excel, vba

我想在 Excel 2007 中创建一个 1/3 倍频程图表，但我没有找到方法。Excel 只允许我将“x”轴设为对数轴，但 1/3 倍频程的刻度不是这个。

在 1/3 倍频程图表中，下一个值必须在“x”轴上等距分布：63、125、250、500、1000、2000、4000 (Hz)

我可以在 VBA Excel 中执行此操作吗？或者有更简单的方法吗？请问有什么建议吗？谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:48:42.697

如果我正确理解您的问题，那么您正在寻找的是对数 X 轴。

听起来您需要轴上的每个刻度都加倍。对数 x 轴是每个刻度乘以某个值“k”（如果 k = 2，则加倍）。

现在您要做的就是确定您想要的 x 轴间距。

演示带有*对数混合*X 轴的图表的示例

![在此处输入图像描述](https://i.stack.imgur.com/BOPZN.jpg)

# python - Python REST / TeamCity 备份

> ID：15980461
> 
> 赞同：0
> 
> 时间：2013-04-12T20:38:29.077
> 
> 标签：python, backup, teamcity, urllib2

我正在尝试开发一个 python 脚本来运行 REST 备份过程，如[http://confluence.jetbrains.com/display/TW/REST+API+Plugin#RESTAPIPlugin-DataBackup所示](http://confluence.jetbrains.com/display/TW/REST+API+Plugin#RESTAPIPlugin-DataBackup)

这是我的代码：

```
#!/usr/bin/env python
# -*- coding: utf-8 -*-

import urllib
import urllib2

"""
Data Backup
+++++++++++
Start backup: POST http://teamcity:8111/httpAuth/app/rest/
server/backup?includeConfigs=true&includeDatabase=true&
includeBuildLogs=true&fileName=<fileName> 
where <fileName> is the prefix of the file to save backup to. 
The file will be created in the default backup directory (see more).
"""

url = "http://localhost/httpAuth/app/rest/server/backup"

# === EDITED code = now working (see my answer below) ===
url = "http://localhost/httpAuth/app/rest/server/backup?includeConfigs=true&includeDatabase=true&
includeBuildLogs=true&fileName=TCBACKUP"
# === /EDITED code (see my answer below) ===

params = {
'fileName':'TCBACKUP',
'includeBuildLogs':'false',
'includeDatabase':'true',
'includeConfigs':'true'
}

post_data = urllib.urlencode(params)

req = urllib2.Request(url, post_data, headers={'Content-Type': 'application/xml'})

password_manager = urllib2.HTTPPasswordMgrWithDefaultRealm()
password_manager.add_password(None, url, 'user', 'pass')

auth_manager = urllib2.HTTPBasicAuthHandler(password_manager)
opener = urllib2.build_opener(auth_manager)

urllib2.install_opener(opener)

handler = urllib2.urlopen(req)
handler.close() 
```

无法弄清楚为什么它会失败

```
urllib2.HTTPError: HTTP Error 400: Bad Request 
```

和 REST 日志显示

```
WARN [hon-urllib/2.7 ] - est.jersey.ExceptionMapperUtil - 
Error 'Invalid request. Please check the request URL and 
data are correct.' for request http://server/app/rest/server/backup. 
Sending Bad Request error in response: jetbrains.buildServer.server.rest.errors.BadRequestException: 
No target file name specified. 
```

没有目标文件名？真的吗？打印 post_data 给了我：

```
includeConfigs=true&includeDatabase=true&includeBuildLogs=false&fileName=TCBACKUP 
```

任何指针将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T13:57:51.903

Python 代码很好——从 TC 文档中唯一不清楚的是——URL 仍然必须构建为

```
"POST http://teamcity:8111/httpAuth/app/rest/server/backup?
includeConfigs=true&includeDatabase=true&includeBuildLogs=true&
fileName=backup" 
```

即使 urllib2 POST 参数被传递给请求。

那好吧

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-07-19T08:27:37.203

就我而言，除了 URL 没有用双引号括起来之外，我做的一切都很好。

所以我必须做这样的事情`curl`才能让它工作

```
curl -d "" -X POST "http://<TeamCityUserName>:<TeamCityPassword>@teamcity.pi.home/httpAuth/app/rest/server/backup?includeConfigs=true&includeDatabase=true&includeBuildLogs=true&fileName=testBackup.bak" 
```

# php - facebook页面iframe中的Fancybox 2，页面加载

> ID：15980467
> 
> 赞同：0
> 
> 时间：2013-04-12T20:38:54.647
> 
> 标签：php, jquery, facebook, iframe, fancybox-2

我正在尝试使用fancybox 2 在facebook 页面中创建应用程序，其中页面作为iframe 加载到fancybox 中。它工作得很好，除了在 IE 中（谁会知道！）。

在我的fancybox 2 中，有一个按钮可以提交表单并将您发送到另一个页面。此页面与上一页加载在同一个花式框窗口中。这个页面加载的时候，fancybox的高度没有调整好，所以我的页面有一半是不可见的。

我现在要做的是更改fancybox iframe 的高度，但我已经坚持获取iframe 的实际大小。

这是我在fancybox iframe中加载的最后一页中的javascript代码：

```
$(document).ready(function() {
    var inner = $('.fancybox-inner');
    console.log(inner);
}); 
```

这个console.log 给了我'null'，告诉我这个类在页面中不存在。我还尝试了以下方法：

```
parent.$('.fancybox-inner');
parent.$('.fancybox-iframe');
$('.fancybox-iframe');
$.fancybox;
parent.fancybox; 
```

我的幻想箱加载：

```
$(document).ready(function() {
$(".uploadbox").fancybox({
    scrolling : 'no',
    preload   : true,
    type      : 'iframe',
    width     : '623px',
    height    : 'auto',
    autoSize  : true,
    afterLoad : function () { $.fancybox.update(); }, //this does not work
    closeBtn  : false,
        closeClick  : false,
        helpers     : { 
            overlay : {closeClick: false}
        }
    });
}); 
```

任何帮助将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T11:09:52.157

我从来没有设法解决这个问题。我会向你解释原因：

Facebook 页面使用 iframe 将您的网站显示到他们的网站中。要在 fancybox 2 中显示另一个页面，您也需要使用 iframe。因为 iframe 中的 iframe 总是会出现问题（跨浏览器等），所以由于双 iframe，无法为父窗口提供我的幻想框的高度。由于应用程序必须上线，我决定给它一个静态高度。将来我不会再使用 Fancybox 2 或其他任何事情，这只是 Facebook 内部的一大痛苦。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-12T20:44:40.517

您将需要 parent.jQuery.fancybox.resize(); 甚至 window.parent.jQuery.fancybox.resize();

如果我没记错的话，他们的网站上有一个关于这个问题的规范。

# spring - Spring Framework 是否带有自己的 bean？

> ID：15980473
> 
> 赞同：2
> 
> 时间：2013-04-12T20:39:20.370
> 
> 标签：spring, jsf, jakarta-ee

这段文字来自名为 Core Java Server Faces 的书：

> 对于可以在 JSF 页面中使用的 bean，有两种独立的机制，CDI bean 和 JSF 管理的 bean，这是一个历史性的意外。我们建议您使用 CDI bean，除非您的应用程序必须在普通的 servlet 运行程序（如 Tomcat）上运行。本书的源代码有两个版本，一个带有 CDI bean（用于 Java EE 6 应用程序服务器），另一个带有 JSF 托管 bean（用于不支持 CDI 的 servlet 运行器）。

我的问题是：

如果我使用 Spring Framework 和 Tomcat 服务器，是否需要使用上面提到的 bean 之一，或者 Spring Framework 是否带有自己的 bean 实现？

据我所知，Spring Framework 支持依赖注入。如果我在 Tomcat 上运行应用程序，它是否支持它？这是否意味着我既不会使用本书中提到的 CDI bean 也不会使用 JSF 托管方式？

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:43:28.810

谈论容器比bean实现更正确。是的，Spring 带有自己的容器。事实上，您可以将 Spring 框架视为完整 Java EE 堆栈的一种替代方案。

一起使用 Spring DI 和 CDI 几乎没有兴趣，但您仍然可以在 tomcat 上使用 JSF 和 spring，尽管在这种情况下我建议您切换到 Java EE 6 Web 配置文件服务器而不是 spring。

Spring自带的是自己的视图框架实现，名为spring mvc。

所有这些都可以在任何 servlet 容器（jetty tomcat 等）上完美运行，条件是您提供相关的依赖项 ofc。

# django - django modelformset_factory 中的 MultiValueDictKeyError

> ID：15980475
> 
> 赞同：9
> 
> 时间：2013-04-12T20:39:23.410
> 
> 标签：django, django-forms

我正在尝试实现一个编辑表单集。然后，我使用 modelformset_factory 实例化表单集中的对象。当请求不是 POST 时，formset 会完美加载，但是，如果请求是 POST，formset 构造函数会引发 MultiValueDictKeyError。

这是我的代码。

## 表格.py

```
class SchoolSectionForm(forms.ModelForm):

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_tag = False

        self.helper.layout = Layout(
            Div(
                'name',
                css_class='name',
            ),
        )

        super(SchoolSectionForm, self).__init__(*args, **kwargs)

    class Meta:
        model = SchoolSection

        exclude = [
            'school',
            'created_by',
        ]

class SectionBreakFormSet(BaseFormSet):

    def __init__(self, *args, **kwargs):
        super(SectionBreakFormSet, self).__init__(*args, **kwargs)

class SectionBreakForm(forms.ModelForm):

    def __init__(self, *args, **kwargs):
        self.helper = FormHelper()
        self.helper.form_tag = False

        self.helper.layout = Layout(
            Div(
                Div(
                    'start_time',
                    css_class='start_time',
                ),
                Div(
                    'end_time',
                    css_class='end_time',
                ),
            css_class='formset_element',
            )
        )

        super(SectionBreakForm, self).__init__(*args, **kwargs)

    class Meta:
        model = SectionBreak

        exclude = [
            'school_section',
            'created_by',
        ] 
```

## 视图.py

```
def school_section_edit(request, section_id):

    section = get_object_or_404(
        SchoolSection,
        id=section_id,
    )

    current_school = request.user.current_school
    school_sections_list = current_school.schoolsection_set.all()

    section_break_formset = modelformset_factory(
        SectionBreak,
        max_num=3,
        extra=0,
        form=SectionBreakForm,
    )

    formset_qset = SectionBreak.objects.filter(school_section=section)

    formset = section_break_formset(queryset=formset_qset)
    school_section_form = SchoolSectionForm(instance=section)

    if request.method == 'POST':
        school_section_form = SchoolSectionForm(request.POST)

        # Bug raises in this line
        formset = section_break_formset(request.POST, queryset=formset_qset) 
        # Bug raises in this line

        if school_section_form.is_valid() and formset.is_valid():

            school_section_form.save()
            formset.save()

            messages.success(
                request,
                u'xxx',
            )

            return HttpResponseRedirect(reverse('school:school_section_add'))

        else:
            messages.error(
                request,
                u'xxx',
            )

    return render(request, 'school/schoolsection_add.html', {
        'school_section_form': school_section_form,
        'formset': formset,
        'school_sections_list': school_sections_list,
    }) 
```

## 模板

```
<form class="new_section_form" method="post" action="">
    <div class="school_section_form">
        {% crispy school_section_form %}
    </div>

    <h3>Horarios de descanso:</h3>

    <div class="section_break_formset">
        {% crispy formset formset.form.helper %}
    </div>

    <button class="button color">guardar</button>
</form> 
```

当我发布表格时......崩溃......我有这个错误

![在此处输入图像描述](https://i.stack.imgur.com/zp4aI.png)

感谢帮助...

异常类型：MultiValueDictKeyError at /administrador/ciclo-educativo/editar/34/ 异常值：“Key u'form-0-id' not found in <>QueryDict: {u'name': [u'Primaria'], u 'form-MAX_NUM_FORMS': [u'3'], u'form-TOTAL_FORMS': [u'1'], u'form-0-start_time': [u'07:00:00'], u'form -0-end_time': [u'12:00:00'], u'form-INITIAL_FORMS': [u'1'], u'csrfmiddlewaretoken': [u'aZkZPJ6tlzJeCd1kjC0EpkjPuFbWe6IB', u'aZkZPJ6tlzJeCd1kjC0EpkjPuFbWe6IB']}<> "

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-05-08T23:16:16.773

您可能需要添加表单 id [{{ form.id }}](https://stackoverflow.com/questions/15980475/multivaluedictkeyerror-in-django-modelformset-factory)例如 `{% crispy formset formset.form.id %}`

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2015-04-01T06:55:59.703

表单 ID 是隐藏字段，但如果您没有将其包含在模板中的表单中，那么它将通过上述错误。如果将其包含在您的模板中，您将摆脱上述错误

```
Ex:
{{form.title}}  #this field you want to display
{{ form.id }}   # this is hidden field, this will not get display in form. but at the time of form-set submission this is required. 
```

# ruby-on-rails - HABTM 按多个关联记录搜索

> ID：15980476
> 
> 赞同：0
> 
> 时间：2013-04-12T20:39:25.097
> 
> 标签：ruby-on-rails, has-and-belongs-to-many

以下问题：
我有一个产品的 ID 和两个用于选项值的 IDS。我想查找与产品 ID 和两个选项值 ID 匹配的变体。举个例子：

> 我有一个名为“Tshirt”的产品，我想要的是蓝色和大号的。

我的以下设置是：

### 产品.rb

```
class Product < ActiveRecord::Base
  has_many :variants
end 
```

### 变体.rb

```
class Variant < ActiveRecord::Base
  belongs_to :product
  has_and_belongs_to_many :option_values, :join_table => :spree_option_values_variants
end 
```

### option_values.rb

```
class OptionValue < ActiveRecord::Base

  has_and_belongs_to_many :variants, :join_table => 'spree_option_values_variants', :class_name => "Spree::Variant"
end 
```

现在，我有：

以顶部为例：

> Spree::Variant.includes(:option_values).where(:spree_option_values => {:id => [color.id, size.id]}, :product_id => product.id)

这个艰难的让我回到了所有的变体，无论是大的还是蓝色的。我很坚强，我想要大而蓝色的变体。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:52:12.290

我想我找到了答案，它在 2 个查询中解决了这个问题：

```
(Spree::Variant.joins(:option_values).where(:spree_option_values => {:id => color.id}, :product_id => self.id) & Spree::Variant.includes(:option_values).where(:spree_option_values => {:id => size.id}, :product_id => self.id)).last 
```

# algorithm - 给定一个节点网络，如何找到具有有限移动次数的最高得分循环？

> ID：15980478
> 
> 赞同：2
> 
> 时间：2013-04-12T20:39:31.570
> 
> 标签：algorithm, nodes

对于我的一个项目，我正在尝试创建一个求解器，给定一组具有加权路径的随机加权节点，它将找到具有有限移动次数的最高得分路径。我创建了一个视觉对象来帮助描述问题。

[![例子](https://i.stack.imgur.com/YOpJs.png)](https://i.stack.imgur.com/YOpJs.png)

[![完整的例子](https://i.stack.imgur.com/Kqchf.png)](https://i.stack.imgur.com/Kqchf.png) *为了完整起见，此示例显示了所有连接边。边上的数字是遍历成本，节点内的数字是分数。一个节点只有在遍历到它时才被计算在内，并且不能从它自己遍历到它自己。*

正如您从图像中的描述中看到的那样，有一个开始/结束节点，其中包含随机放置的节点，每个节点都有一个任意分数。每个节点都连接到所有其他节点，并且**每个连接都具有从剩余移动单元总数中减去的任意权重。**为简单起见，您可以假设连接的权重是距离的函数。节点可以多次移动，并且再次应用它们的分数。目标是找到在给定移动限制下得分最高的循环路径。

求解器永远不会处理超过 30 个节点，通常处理 10-15 个节点。我仍然需要尝试让它尽可能快。

除了纯粹的蛮力方法之外，关于算法或方法的任何想法可以帮助我解决这个问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T00:53:33.173

这是一个 O(mn^2) 时间的算法，其中 m 是移动次数，n 是节点数。

对于 {0, 1, ..., m} 中的每个时间 t 和每个节点 v，计算从起始节点开始到 v 结束的 t 步步行的最大分数，如下所示。如果 t = 0，则只有 walk，即在起始节点处不做任何事情，因此如果 v 是起始节点，则 (0, v) 的最大值为 0，否则为 -infinity（即不可能）。

对于 t > 0，我们使用 t - 1 的条目来计算 t 的条目。为了计算 (t, v) 条目，我们将 v 的分数加上 (t - 1, w) 条目的所有节点 w 的最大值之差减去从 w 到 v 的转移惩罚。换句话说，一个到 v 的最优 t 步步行包括从某个节点 w 到 v 的一步，然后是 (t - 1) 步步行到 w，并且这个 (t - 1) 步步行必须是最优的，因为历史不会影响未来得分。

最后，我们查看 (m, start node) 条目。要恢复实际的行走，需要向后工作并反复确定哪个 w 是最好的节点。

# php - PHP 中的附属窗口 API 集成

> ID：15980479
> 
> 赞同：0
> 
> 时间：2013-04-12T20:39:33.430
> 
> 标签：php, affiliate, affiliates

我正在尝试编写一个与 Affiliate Window API 集成的应用程序。我唯一的问题是我在 php 方面的经验实际上是 0，所以发现自己甚至无法调试最基本的问题。

我下载了下面的代码，它应该是一个示例应用程序。不幸的是，运行它在第一个障碍中失败了：

```
Invalid argument supplied for foreach() in /Users/ravinthambapillai/Downloads/api.client/listmerchants.php on line 9 
```

这是我在运行以下命令时收到的错误消息：

任何人都可以帮助我解决我需要解决的问题吗？

```
<?php
define('API', 'PS');
require_once('constants.inc.php');
require_once('classes/class.ClientFactory.php');
$oClient = ClientFactory::getClient(REDACTED, REDACTED, merchant);
$listmerchants = array('iCategoryId'=> 97, 'iMaxResult' => 10);
echo 'hello world';
    $oResponse= $oClient->call('getMerchantList', $listmerchants);
    foreach($oResponse->oMerchant as $details){
        $name = $details->sName;
        $strapline = $details->sStrapline;
        $description = $details->sDescription;
        $logo = $details->sLogoUrl;
        $showurl = $details->sDisplayUrl;
        $deeplink = $details->sClickThroughUrl;
        $id = $details->iId;

        if ($logo<>'') {
            echo "<a href=".$deeplink."  title='".$name."'><img src=".$logo.
            " style='float:left; margin:5px;' alt='".$name.
            " :: ".$strapline." :: ".$description." :: ".$showurl.
            "' width=\"88\" height=\"31\" border=\"0\"></a>";
        }

    }

?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-09T23:13:25.957

您是否更新了 constants.inc.php 中的常量？

API_USERNAME 需要设置为您的帐户 ID，API_PASSWORD 需要设置为您的会员 API 密码，如[https://www.affiliatewindow.com/affiliates/accountdetails.php](https://www.affiliatewindow.com/affiliates/accountdetails.php)所示（当您登录时）

# ios - 我的应用因 UIBackgroundModes 而被拒绝

> ID：15980481
> 
> 赞同：15
> 
> 时间：2013-04-12T20:39:48.650
> 
> 标签：ios, app-store-connect, appstore-approval

> 我们发现您的应用使用后台模式，但不包含需要该模式持续运行的功能。此行为不符合 App Store 审核指南。
> 
> 我们注意到您的应用在 Info.plist 的 UIBackgroundModes 键中声明支持音频，但当应用在后台时不会播放任何可听内容。虽然您的意图可能是提供此功能，但在审核时，我们无法为您的应用播放背景音频。
> 
> 如 iOS 应用程序编程指南中所述：
> 
> “此密钥旨在供在后台向用户提供可听内容的应用程序使用，例如音乐播放器或流音频应用程序。”
> 
> 因此，在应用程序处于后台时向用户提供可听内容或从 UIBackgroundModes 键中删除“音频”设置是合适的。
> 
> 对于离散代码级别的问题，您可能希望咨询 Apple 开发人员技术支持。请务必：
> 
> *   包括您的拒绝问题的完整详细信息
> *   准备任何符号化的崩溃日志、屏幕截图和步骤，以便在 DTS 工程师跟进时重现问题。
> 
> 有关如何符号化和读取崩溃日志的信息，请参阅技术说明 TN2151 理解和分析 iPhone OS 应用程序崩溃报告。
> 
> 如果您在重现此问题时遇到困难，请尝试按照“[使用 Xcode 的存档功能测试工作流程](https://developer.apple.com/library/ios/qa/qa1764/_index.html)”中的说明测试工作流程。

所以这是我的问题/问题：

*   在分辨率中心，它告诉他们必须先开始播放视频，否则在后台模式下显然不会播放音频，并且还会向他们发送实际有效的屏幕截图

*   他们真的要回答我吗？大约一小时前我已经写了上面的内容，但仍然没有答案

*   我是否必须重新提交应用程序并再等待 7 天，还是他们仍然可以批准应用程序？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-12T21:40:10.617

我有*完全相同的*问题和拒绝原因。

我所做的是提出上诉，引用 Technical Q&A 1668，“Playing media while in the background using AV Foundation”（通常[在这里](http://developer.apple.com/library/ios/#qa/qa1668/_index.html)，但目前不是），其中明确表示 UIBackgroundModes 音频键可用于播放视频在后台，通过 AirPlay，或通过从 AVPlayer 分离 AVPlayerLayer 在本地设备上。

大约一周后，我的申诉获得批准，应用程序被提交到商店。并不是说我从苹果那里收到过明确的答复。但是，我想，批准是重要的部分。

// 编辑：几周前，我向 Apple 提交了一份雷达，要求提供明确的视频背景模式。如果你想欺骗它，它现在就在[OpenRadar上。](http://openradar.appspot.com/radar?id=2931406)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T21:38:16.810

您不必重新提交应用程序，他们会回复您。

[https://developer.apple.com/appstore/contact/appreviewboard/index.html](https://developer.apple.com/appstore/contact/appreviewboard/index.html)

此链接将带您进入上诉流程的表格，尽管我假设您已经根据帖子中的信息完成了此操作。如果您觉得需要快速审核，也有一个链接。你只需要提出你的理由，试着非常小心地解决他们提出的关于你的应用程序为什么不符合指南的每一点。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-08-13T09:10:32.983

我遇到了同样的问题，我在哪里使用 UIBackgroundModes 键通过 Airplay 在后台播放视频。而[技术问答1668](https://developer.apple.com/library/ios/qa/qa1668/_index.html)，明确提到是这样的

**重要提示：** UIBackgroundModes 音频键还允许应用使用 AirPlay 在后台流式传输媒体内容（另请参阅视频媒体的特殊注意事项）。

# vba - 检查范围内的数据类型

> ID：15980484
> 
> 赞同：1
> 
> 时间：2013-04-12T20:40:03.507
> 
> 标签：vba, excel, excel-2010

我正在尝试使用 VBA 函数验证用户选择范围内所有单元格的数据类型是否相同。我有以下代码（简化），它在大多数情况下都有效：

```
Dim vTempRange As Variant
Dim vCell As Variant

    vTempRange = DataRange.Value

    For Each vCell In vTempRange
        If Len(vCell) > 0 Then
            'Use TypeName(vCell)
            'Complete validation here
        End If
    Next vCell 
```

有时用户可以选择一列百分比，有时选择一列十进制值，有时选择时间值（与日期无关）。VBA 似乎将所有这三个都视为`Double`，这在技术上是不正确的。问题是，选择的格式将用作最终输出的一部分，因此`12:00:00`应该显示为这样，而不是`0.50`当前的情况。

我研究过结合使用这样的东西：

```
Dim vCell As Variant

    For Each vCell In DataRange
        If Len(vCell) > 0 Then
            'Use vCell.NumberFormat
            'Complete validation here
        End If
    Next vCell 
```

但`NumberFormat`并不一致。例如，用户可能将百分比列为`0%`vs.`0.000%`或时间列为`h:m:s`vs. `hh:mm:ss`，因此我认为很难正确捕获此值。

有没有一种方法可以在选择时间与其他类型之一的情况下准确确定**而无需用户干预？**确定百分比值与`0<x<1`十进制值也很好，但不是必需的。

我可以使用其他选项，例如忽略最终输出中的格式（真的不可取）或明确要求用户识别类型（但这既不像我想要的那样干净也不自动）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:52:28.340

尝试这个。将其粘贴到模块中。然后，您可以将其用作工作表公式。

我的数据库中有这段代码，它是从[这里](http://www.j-walk.com/ss/excel/tips/tip62.htm)获取的，我对其进行了修改以满足您的需要。

```
Public Function CellType(c)
    Application.Volatile
    Select Case True
        Case IsEmpty(c): CellType = "Blank"
        Case Application.IsText(c): CellType = "Text"
        Case Application.IsLogical(c): CellType = "Logical"
        Case Application.IsErr(c): CellType = "Error"
        Case IsDate(c): CellType = "Date"
        Case InStr(1, c.Text, ":") <> 0: CellType = "Time"
        Case InStr(1, c.Text, "%") <> 0: CellType = "Percentage"
        Case IsNumeric(c): CellType = "Value"
    End Select
End Function 
```

**截屏**

![在此处输入图像描述](https://i.stack.imgur.com/Z65W7.png)

您可以进一步修改它以在其中添加一个`IF`子句`Case IsNumeric(c): CellType = "Value"`来检查小数，科学记数法等使用`INSTR`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T20:49:11.777

声明`vCell as Range`然后进行检查：

`TypeName(vCell.Value)`

这将准确地捕捉到你的日期。

您可能需要添加一些 if/then 逻辑来捕获“百分比”，因为这些是双精度类型的值——“%”部分只是单元格格式，因此您可以只检查`Right(vCell.NumberFormat,1) = "%"`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-11-14T12:50:42.557

`VarType` 函数返回一个整数，指示变量的子类型，或对象的默认属性的类型。

[https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function](https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function)

Ex1：用来写如果。

```
Function DataType(x As Variant) As String
  If VarType(x) = vbDate Then
    DataType = "Date"
  ElseIf VarType(x) = vbString Then
    DataType = "String"
  '.....
  End If
End Function 
```

Ex2：连接具有值的范围内的单元格。

```
Function ConcatenateRange(cellRange As Range) As String
      Dim cel As Range, temp As String
      temp = ""
      For Each cel In cellRange
    'use VarType to check if the cell is empty.
    'if the cell is not empty concatinate it.

        If VarType(cel) <> vbEmpty Then 
             temp = temp & cel
    End If
      Next
      ConcatenateRange = temp
End Function 
```

# api - Lua：ProteaAudio API 混淆——如何使用它？

> ID：15980487
> 
> 赞同：1
> 
> 时间：2013-04-12T20:40:10.580
> 
> 标签：api, audio, lua

大家好。

很抱歉我的菜鸟问题，因为我只是一个试图学习使用 Lua 编程的非程序员。

Lua 非常吸引我，因为它确实非常简单，无论是大小还是语法。

我决定用这种巴西出生的语言进行进一步的实验，比如玩声音——就像我在 Python 和 Ruby 中所做的那样。

所以我找到了这个 ProteaAudio 并尝试播放我从[这里](http://viremo.eludi.net/proteaAudio/index.html)下载的包中的示例脚本。

该软件包附带两个示例脚本：

1.  首先命名为**example.lua**来播放 ogg 示例文件（也包含在包中）
2.  另一个播放函数生成的声音名为**scale.lua**

第一个脚本在我的 Win 7 和 Ubuntu 12.04 x86 机器上运行良好。

但是第二个脚本仅在 Windows 上运行，当我尝试在 Ubuntu 上运行它时出现错误，生成以下消息：

> ../lua52: scale.lua:13: bad argument #1 to 'soundLoop' (期望的数字，得到了 nil)
> 
> 堆栈回溯：
> 
> [C]：在函数“soundLoop”中
> 
> scale.lua:13：在函数“playNote”中
> 
> scale.lua:29: 在主块中
> 
> [C]：在？

**scale.lua**的完整原始源代码是：

```
-- function creating a sine wave sample:
function sampleSine(freq, duration, sampleRate)
    local data = { }
    for i = 1,duration*sampleRate do
        data[i] = math.sin( (i*freq/sampleRate)*math.pi*2)
    end
    return proAudio.sampleFromMemory(data, sampleRate)
end

-- plays a sample shifted by a number of halftones for a definable period of time
function playNote(sample, pitch, duration, volumeL, volumeR, disparity)
    local scale = 2^(pitch/12)
    local sound = proAudio.soundLoop(sample, volumeL, volumeR, disparity, scale)
    proAudio.sleep(duration)
    proAudio.soundStop(sound)
end

-- create an audio device using default parameters and exit in case of errors
require("proAudioRt")
if not proAudio.create() then os.exit(1) end

-- generate a sample:
local sample = sampleSine(440, 0.5, 88200)

-- play scale (a major):
local duration = 0.5
for i,note in ipairs({ 0, 2, 4, 5, 7, 9, 11, 12 }) do
    playNote(sample, note, duration)
end

-- cleanup
proAudio.destroy() 
```

而且由于我对这个 ProteaAudio Lua API 感到困惑，我真的不明白为什么会出现这个错误。

请帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T23:11:31.473

这实际上只是一个猜测，但...

要向上演奏“主要”音阶（8 个音符，跳跃：*全*半音，*全*半音），原始代码会：

```
local duration = 0.5
for i,note in ipairs({ 0, 2, 4, 5, 7, 9, 11, 12 }) do
    playNote(sample, note, duration)
end 
```

其中是一个由函数返回`sample`的预生成样本的句柄，它传递给它一个计算出的代表440hz正弦波的“表”（音符'A4'的音乐会音高频率，中间'C上方的第一个'）。 因此，通过改变（增加）该样本的“音高”（频率）（以 8 个步骤 = 音符）来播放“A 大调音阶”。音高计算是由 function 完成的。`proAudio.sampleFromMemory``sampleSine`
`playNote`

函数`playNote`接受以下参数：
`sample, pitch, duration, volumeL, volumeR, disparity`，
*但*它当前不*接收*参数：（
`volumeL, volumeR, disparity`然后将是`nil`）。

因此，当函数`playNote`尝试调用:
`proAudio.soundLoop(sample, volumeL, volumeR, disparity, scale)`时，
调用将结束于:
`proAudio.soundLoop(sample, nil, nil, nil, scale)`，
其中`sample`传递的`scale`是该样本的“播放音高”，正如函数 playNote 刚刚计算的（根据指定`note`的）。

您的错误消息指出：`bad argument #1 to 'soundLoop' (number expected, got nil)`。
***嗯，这似乎与正在发生的事情一致***（假设 'bad argument #1' 是第二个参数，在这种情况下`volumeL`）。

因此，
您可能想**尝试**指定一些值，`volumeL, volumeR, disparity`例如：

```
local duration = 0.5
local volumeL = 1.0
local volumeR = 1.0
local disparity = 0.0
for i,note in ipairs({ 0, 2, 4, 5, 7, 9, 11, 12 }) do
    playNote(sample, note, duration, volumeL, volumeR, disparity)
end 
```

从[proteaAudio 文档](http://viremo.eludi.net/proteaAudio/class_device_audio_sdl.html)中，可以阅读关于`soundLoop`的论点：

```
sample    -            A sample handle returned by a previous load() call
volumeL   - (optional) Left volume
volumeR   - (optional) Right volume
disparity - (optional) Time difference between left and right channel in seconds. 
                       Use negative values to specify a delay for the left 
                       channel, positive for the right.
pitch     - (optional) Pitch factor for playback. 0.5 corresponds to one octave 
                       below, 2.0 to one above the original sample. 
```

如果这样可以解决问题，那么参数在 Ubuntu 上可能不是那么可选。

希望这可以帮助！

# java - JavaFx lineChart 按 CategoryAxis 缩放（字符串类型）

> ID：15980498
> 
> 赞同：0
> 
> 时间：2013-04-12T20:41:18.513
> 
> 标签：java, javafx

我将鼠标移动到折线图缩放 xAxis 、yAxis(yAxis 是 NumberAxis,xAxis 是 categoryAxis.) 我这里搜索一个方法，这个方法 NumberAxis 缩放是没有问题的，但是 categoryAxis 缩放有问题。这个怎么做？谢谢大家。

 **```
import javafx.application.Application;
import javafx.beans.property.SimpleDoubleProperty;
import javafx.event.EventHandler;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.chart.CategoryAxis;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.chart.XYChart.Series;
import javafx.scene.input.MouseButton;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.StackPane;
import javafx.scene.paint.Color;
import javafx.scene.shape.LineTo;
import javafx.scene.shape.MoveTo;
import javafx.scene.shape.Path;
import javafx.scene.shape.Rectangle;
import javafx.stage.Stage;

public class Zoom extends Application {
Path path;//Add path for freehand
Rectangle rect;
SimpleDoubleProperty rectinitX = new SimpleDoubleProperty();
SimpleDoubleProperty rectinitY = new SimpleDoubleProperty();
SimpleDoubleProperty rectX = new SimpleDoubleProperty();
SimpleDoubleProperty rectY = new SimpleDoubleProperty();
LineChart lineChart2 =null;
double initXLowerBound = 0, initXUpperBound = 0, initYLowerBound = 0, initYUpperBound = 0;

@Override
public void start(Stage stage) {

    stage.setTitle("Lines plot");  
    StackPane Mainpane = new StackPane();
    Mainpane.getChildren().add(addMainpane());
    Scene scene = new Scene(Mainpane, 800, 600);
    stage.setScene(scene);        
    path = new Path();
    path.setStrokeWidth(1);
    path.setStroke(Color.BLACK);
    stage.show();
}
private StackPane addMainpane(){

    StackPane Mainpane = new StackPane();

    final CategoryAxis xAxis = new CategoryAxis();
    final NumberAxis yAxis = new NumberAxis(0, 13, 1);

    final LineChart lineChart = new LineChart(xAxis, yAxis);

    XYChart.Series series1 = new XYChart.Series();
    series1.getData().add(new XYChart.Data("2013-04-01", 1));
    series1.getData().add(new XYChart.Data("2013-04-02", 2));
    series1.getData().add(new XYChart.Data("2013-04-03", 3));
    series1.getData().add(new XYChart.Data("2013-04-04", 4));
    series1.getData().add(new XYChart.Data("2013-04-05", 5));
    series1.getData().add(new XYChart.Data("2013-04-06", 6));
    series1.getData().add(new XYChart.Data("2013-04-07", 7));
    series1.getData().add(new XYChart.Data("2013-04-08", 8));
    series1.getData().add(new XYChart.Data("2013-04-09", 9));
    series1.getData().add(new XYChart.Data("2013-04-10", 10));
    series1.getData().add(new XYChart.Data("2013-04-11", 11));
    series1.getData().add(new XYChart.Data("2013-04-12", 12));
    series1.getData().add(new XYChart.Data("2013-04-13", 1));
    series1.getData().add(new XYChart.Data("2013-04-14", 2));
    series1.getData().add(new XYChart.Data("2013-04-15", 3));
    series1.getData().add(new XYChart.Data("2013-04-16", 4));
    series1.getData().add(new XYChart.Data("2013-04-17", 5));
    series1.getData().add(new XYChart.Data("2013-04-18", 6));
    series1.getData().add(new XYChart.Data("2013-04-19", 7));
    series1.getData().add(new XYChart.Data("2013-04-20", 8));
    series1.getData().add(new XYChart.Data("2013-04-21", 9));
    series1.getData().add(new XYChart.Data("2013-04-22", 10));
    series1.getData().add(new XYChart.Data("2013-04-23", 11));
    series1.getData().add(new XYChart.Data("2013-04-24", 12));
    series1.getData().add(new XYChart.Data("2013-04-25", 1));
    series1.getData().add(new XYChart.Data("2013-04-26", 2));
    series1.getData().add(new XYChart.Data("2013-04-27", 3));
    series1.getData().add(new XYChart.Data("2013-04-28", 4));
    series1.getData().add(new XYChart.Data("2013-04-29", 5));
    series1.getData().add(new XYChart.Data("2013-04-30", 6));

    //initXLowerBound = ((CategoryAxis) lineChart.getXAxis()).getLowerBound();
    //initXUpperBound = ((CategoryAxis) lineChart.getXAxis()).getUpperBound();
    initYLowerBound = ((NumberAxis) lineChart.getYAxis()).getLowerBound();
    initYUpperBound = ((NumberAxis) lineChart.getYAxis()).getUpperBound();
    System.out.println("initXLowerBound:"+initXLowerBound);

    BorderPane pane;
    pane = new BorderPane();
    pane.setCenter(addpane(lineChart));
    Mainpane.getChildren().add(pane);
    lineChart.getData().addAll(series1);
    lineChart2 = lineChart;

    pane.setOnMouseClicked(mouseHandler);
    pane.setOnMouseDragged(mouseHandler);
    pane.setOnMouseEntered(mouseHandler);
    pane.setOnMouseExited(mouseHandler);
    pane.setOnMouseMoved(mouseHandler);
    pane.setOnMousePressed(mouseHandler);
    pane.setOnMouseReleased(mouseHandler);

    rect = new Rectangle();
    rect.setFill(Color.web("blue", 0.1));
    rect.setStroke(Color.BLUE);
    rect.setStrokeDashOffset(50);

    rect.widthProperty().bind(rectX.subtract(rectinitX));
    rect.heightProperty().bind(rectY.subtract(rectinitY));
    pane.getChildren().add(rect);

    return Mainpane;
}
 private StackPane addpane(LineChart lineChart){

    StackPane Subpane = new StackPane();
    Subpane.getChildren().add(lineChart);
    return Subpane;
}

EventHandler<MouseEvent> mouseHandler = new EventHandler<MouseEvent>() {

@Override
public void handle(MouseEvent mouseEvent) {
    if (mouseEvent.getButton() == MouseButton.PRIMARY) {
        if (mouseEvent.getEventType() == MouseEvent.MOUSE_PRESSED) {
            rect.setX(mouseEvent.getX());
            rect.setY(mouseEvent.getY());
            rectinitX.set(mouseEvent.getX());
            rectinitY.set(mouseEvent.getY());
            System.out.println("rect:"+rect);
        } else if (mouseEvent.getEventType() == MouseEvent.MOUSE_DRAGGED) {
            rectX.set(mouseEvent.getX());
            rectY.set(mouseEvent.getY());
        } else if (mouseEvent.getEventType() == MouseEvent.MOUSE_RELEASED) {

            if ((rectinitX.get() >= rectX.get()) && (rectinitY.get() >= rectY.get())) {
                //Condizioni Iniziali
                LineChart lineChart = lineChart2;

               // ((CategoryAxis) lineChart.getXAxis()).setLowerBound(initXLowerBound);
                //((CategoryAxis) lineChart.getXAxis()).setUpperBound(initXUpperBound);

                ((NumberAxis) lineChart.getYAxis()).setLowerBound(initYLowerBound);
                ((NumberAxis) lineChart.getYAxis()).setUpperBound(initYUpperBound);

            } else {
                //Zoom In

                double Tgap = 0;
                double newLowerBound, newUpperBound, axisShift;
                double xScaleFactor, yScaleFactor;
                double xaxisShift, yaxisShift;                  
                LineChart  lineChart = lineChart2;

                // Zoom in Y-axis by changing bound range.            
                NumberAxis yAxis = (NumberAxis) lineChart.getYAxis();
                Tgap = yAxis.getHeight()/(yAxis.getUpperBound() - yAxis.getLowerBound());
                axisShift = getSceneShiftY(yAxis);
                yaxisShift = axisShift;
                System.out.println("yAxisUPPER:"+yAxis.getUpperBound()+"yAxisLOWER:"+ yAxis.getLowerBound());
                newUpperBound = yAxis.getUpperBound() - ((rectinitY.get() - axisShift) / Tgap);
                newLowerBound = yAxis.getUpperBound() - (( rectY.get() - axisShift) / Tgap);

                if (newUpperBound > yAxis.getUpperBound())
                    newUpperBound = yAxis.getUpperBound();

                yScaleFactor = (yAxis.getUpperBound() - yAxis.getLowerBound())/(newUpperBound - newLowerBound);
                yAxis.setLowerBound(newLowerBound);
                yAxis.setUpperBound(newUpperBound);

                /*XYChart.Series series1 = (Series) lineChart.getData().get(0);
                if (!series1.getData().isEmpty()) {
                    series1.getData().remove(0);
                    series1.getData().remove(series1.getData().size() - 1);
                }*/

               // CategoryAxis xAxis = (CategoryAxis) lineChart.getXAxis();

            }
            // Hide the rectangle
            rectX.set(0);
            rectY.set(0);
        }
    }// end if (mouseEvent.getButton() == MouseButton.PRIMARY)

}
};

private static double getSceneShiftX(Node node) {
    double shift = 0;
    do { 
        shift += node.getLayoutX(); 
        node = node.getParent();
    } while (node != null);
    return shift;
}

private static double getSceneShiftY(Node node) {
    double shift = 0;
    do { 
        shift += node.getLayoutY(); 
        node = node.getParent();
    } while (node != null);
    return shift;
}
public static void main(String[] args) {
    launch(args);
}

} 
```*  ** * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-03-09T11:42:29.827

[1.您首先需要从此处](http://myjavafx.blogspot.co.il/2013/09/javafx-charts-display-date-values-on.html)下载并添加项目 DateAxis 类， 然后使用此代码（与您的数据相同），厚脸皮，它可以工作。

```
import java.util.Date;
import javafx.application.Application;
import javafx.beans.property.SimpleDoubleProperty;
import javafx.event.EventHandler;
import javafx.scene.Node;
import javafx.scene.Scene;
import javafx.scene.chart.CategoryAxis;
import javafx.scene.chart.LineChart;
import javafx.scene.chart.NumberAxis;
import javafx.scene.chart.XYChart;
import javafx.scene.chart.XYChart.Series;
import javafx.scene.input.MouseButton;
import javafx.scene.input.MouseEvent;
import javafx.scene.layout.BorderPane;
import javafx.scene.layout.StackPane;
import javafx.scene.paint.Color;
import javafx.scene.shape.LineTo;
import javafx.scene.shape.MoveTo;
import javafx.scene.shape.Path;
import javafx.scene.shape.Rectangle;
import javafx.stage.Stage;

public class DateLineChartTest extends Application {
Path path;//Add path for freehand
Rectangle rect;
SimpleDoubleProperty rectinitX = new SimpleDoubleProperty();
SimpleDoubleProperty rectinitY = new SimpleDoubleProperty();
SimpleDoubleProperty rectX = new SimpleDoubleProperty();
SimpleDoubleProperty rectY = new SimpleDoubleProperty();
LineChart lineChart2 =null;
Date initXLowerBound =new Date(2013-1900,4,1);
 Date  initXUpperBound =new Date(2013-1900,4,30);
double initYLowerBound , initYUpperBound;
 DateAxis xAxis;
 NumberAxis yAxis;

@Override
public void start(Stage stage) {

    stage.setTitle("Lines plot");  
    StackPane Mainpane = new StackPane();
    Mainpane.getChildren().add(addMainpane());
    Scene scene = new Scene(Mainpane, 800, 600);
    stage.setScene(scene);        
    path = new Path();
    path.setStrokeWidth(1);
    path.setStroke(Color.BLACK);
    stage.show();
}
private StackPane addMainpane(){

    StackPane Mainpane = new StackPane();

    final DateAxis xAxis = new DateAxis();
    final NumberAxis yAxis = new NumberAxis(0, 13, 1);

    final LineChart lineChart = new LineChart(xAxis, yAxis);

    XYChart.Series series1 = new XYChart.Series();
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,1), 1));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,2), 2));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,3), 3));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,4), 4));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,5), 5));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,6), 6));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,7), 7));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,8), 8));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,9), 9));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,10), 10));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,11), 11));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,12), 12));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,13), 1));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,14), 2));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,15), 3));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,16), 4));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,17), 5));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,18), 6));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,19), 7));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,20), 8));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,21), 9));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,22), 10));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,23), 11));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,24), 12));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,25), 1));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,26), 2));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,27), 3));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,28), 4));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,29), 5));
    series1.getData().add(new XYChart.Data(new Date(2013-1900,4,30), 6));

    initXLowerBound = xAxis.getLowerBound();
    initXUpperBound = xAxis.getUpperBound();
    initYLowerBound = ((NumberAxis) lineChart.getYAxis()).getLowerBound();
    initYUpperBound = ((NumberAxis) lineChart.getYAxis()).getUpperBound();
    System.out.println("initXLowerBound:"+initXLowerBound);

    BorderPane pane;
    pane = new BorderPane();
    pane.setCenter(addpane(lineChart));
    Mainpane.getChildren().add(pane);
    lineChart.getData().addAll(series1);
    lineChart2 = lineChart;

    pane.setOnMouseClicked(mouseHandler);
    pane.setOnMouseDragged(mouseHandler);
    pane.setOnMouseEntered(mouseHandler);
    pane.setOnMouseExited(mouseHandler);
    pane.setOnMouseMoved(mouseHandler);
    pane.setOnMousePressed(mouseHandler);
    pane.setOnMouseReleased(mouseHandler);

    rect = new Rectangle();
    rect.setFill(Color.web("blue", 0.1));
    rect.setStroke(Color.BLUE);
    rect.setStrokeDashOffset(50);

    rect.widthProperty().bind(rectX.subtract(rectinitX));
    rect.heightProperty().bind(rectY.subtract(rectinitY));
    pane.getChildren().add(rect);

    return Mainpane;
}
 private StackPane addpane(LineChart lineChart){

    StackPane Subpane = new StackPane();
    Subpane.getChildren().add(lineChart);
    return Subpane;
}

EventHandler<MouseEvent> mouseHandler = new EventHandler<MouseEvent>() {

@Override
public void handle(MouseEvent mouseEvent) {
    if (mouseEvent.getButton() == MouseButton.PRIMARY) {
        if (mouseEvent.getEventType() == MouseEvent.MOUSE_PRESSED) {
            rect.setX(mouseEvent.getX());
            rect.setY(mouseEvent.getY());
            rectinitX.set(mouseEvent.getX());
            rectinitY.set(mouseEvent.getY());
            System.out.println("rect:"+rect);
        } else if (mouseEvent.getEventType() == MouseEvent.MOUSE_DRAGGED) {
            rectX.set(mouseEvent.getX());
            rectY.set(mouseEvent.getY());
        } else if (mouseEvent.getEventType() == MouseEvent.MOUSE_RELEASED) {

            if ((rectinitX.get() >= rectX.get()) && (rectinitY.get() >= rectY.get())) {
                //Condizioni Iniziali
                LineChart lineChart = lineChart2;

               xAxis.setLowerBound(initXLowerBound);
                xAxis.setUpperBound(initXUpperBound);

                ((NumberAxis) lineChart.getYAxis()).setLowerBound(initYLowerBound);
                ((NumberAxis) lineChart.getYAxis()).setUpperBound(initYUpperBound);

            } else {
                //Zoom In

                double Tgap = 0;
                double newLowerBound, newUpperBound, axisShift;
                double xScaleFactor, yScaleFactor;
                double xaxisShift, yaxisShift;                  
                LineChart  lineChart = lineChart2;

                // Zoom in Y-axis by changing bound range.            
                NumberAxis yAxis = (NumberAxis) lineChart.getYAxis();
                Tgap = yAxis.getHeight()/(yAxis.getUpperBound() - yAxis.getLowerBound());
                axisShift = getSceneShiftY(yAxis);
                yaxisShift = axisShift;
                System.out.println("yAxisUPPER:"+yAxis.getUpperBound()+"yAxisLOWER:"+ yAxis.getLowerBound());
                newUpperBound = yAxis.getUpperBound() - ((rectinitY.get() - axisShift) / Tgap);
                newLowerBound = yAxis.getUpperBound() - (( rectY.get() - axisShift) / Tgap);

                if (newUpperBound > yAxis.getUpperBound())
                    newUpperBound = yAxis.getUpperBound();

                yScaleFactor = (yAxis.getUpperBound() - yAxis.getLowerBound())/(newUpperBound - newLowerBound);
                yAxis.setLowerBound(newLowerBound);
                yAxis.setUpperBound(newUpperBound);

               XYChart.Series series1 = (Series) lineChart.getData().get(0);
                if (!series1.getData().isEmpty()) {
                    series1.getData().remove(0);
                    series1.getData().remove(series1.getData().size() - 1);
                }

                DateAxis xAxis = (DateAxis) lineChart.getXAxis();

            }
            // Hide the rectangle
            rectX.set(0);
            rectY.set(0);
        }
    }// end if (mouseEvent.getButton() == MouseButton.PRIMARY)

}
};

private static double getSceneShiftX(Node node) {
    double shift = 0;
    do { 
        shift += node.getLayoutX(); 
        node = node.getParent();
    } while (node != null);
    return shift;
}

private static double getSceneShiftY(Node node) {
    double shift = 0;
    do { 
        shift += node.getLayoutY(); 
        node = node.getParent();
    } while (node != null);
    return shift;
}
public static void main(String[] args) {
    launch(args);
}

} 
```**

# ios - UIView 子视图向前触摸

> ID：15980500
> 
> 赞同：1
> 
> 时间：2013-04-12T20:41:23.377
> 
> 标签：ios, uiview

我有两个自定义 UIView（分别为 A 和 B），每个都有一个设置为相同原点和相同大小的框架。它们都作为子视图添加到父 UIView (C)。

作为 A 和 B 的一部分，我有一个触摸识别器，用于监听某些位置的触摸。如果收到该触摸，它会向父 UIView 提出一个委托，说明它已被触摸。问题在于，由于 B 是在 A 之后添加的，因此 B 永远不会收到触摸事件。

A 和 B UIViews 是带有端点的单行。他们都识别端点上的触摸并提出委托通知。如何添加子视图并识别对它们的触摸以及顶部的父视图？这就像一个排他性的东西。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:22:45.267

如果 A 正在接收触摸事件而 B 不是，尽管它们都是 C 的孩子，那么这是因为 A 正在为自己声明所有触摸事件，包括那些为 B 准备的触摸事件。

解决方案是覆盖 A 上的 pointInside:withEvent: 方法，以确定它是否应该为自己接受事件，如下所示：

```
-(BOOL)pointInside:(CGPoint)point withEvent:(UIEvent *)event {
    if ([self pointIsInHotspot:point]) return YES;
    return NO;
} 
```

其中 pointIsInHotspot 是您需要执行的任何测试，以确定该点是否位于视图内的活动区域上。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T22:39:49.890

`cancelsTouchesInView`在手势识别器中设置为 NO。

# sitefinity - Sitefinity 4+ -- 在 Sitefinity 4-5.x 中标准化站点内模块

> ID：15980503
> 
> 赞同：0
> 
> 时间：2013-04-12T20:41:32.250
> 
> 标签：sitefinity, sitefinity-4, sitefinity-5

我们编写了很多站内模块，并注意到它们现在在 SF 4+ 中确实与基于内容的模块有所不同。所以，在那张纸条上，我有一些问题：

1.  您如何获得编辑/创建表单的标准模块的确切外观？例如，您如何消除上面的菜单、使表单居中等，例如在事件模块中？
2.  如何将操作菜单下拉菜单添加到 radgrid，就像您在标准模块的网格中看到的一样？
3.  您如何将 Sitefinity 字段合并到用户控件中？例如 sf:ImageField 添加到控件时会引发脚本错误？此外，是否有关于每个字段的文档以及如何配置？

- -最后 - -

如果我们真的想要标准化，我们是否必须使用另一种模块类型？

4.是否有一种模块类型可以让我们访问非站点限制数据（即单独的数据库
，但也为我们提供与基于内容的模块完全相同的功能和 UI 体验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-01T14:59:24.843

站点内模块只是放置在后端页面中的自定义用户控件（ascx），用于将您的自定义功能添加到后端。为了复制站点其余部分的外观和感觉，我将 HTML 复制并粘贴到控件中。

不久前，我为此举办了一个网络研讨会，包括重新创建后端编辑器的代码。它似乎仍然有效，可在此处获得：[http ://www.sitefinity.com/blogs/joshmorales/posts/josh-morales-blog/2011/06/30/sitefinity_intra-site_module_webinar_notes](http://www.sitefinity.com/blogs/joshmorales/posts/josh-morales-blog/2011/06/30/sitefinity_intra-site_module_webinar_notes)

居中的视图有点不同，我没有那个 html，但你也可以这样做（从另一个本机页面复制它）。我并不总是 100% 准确（我的控件布局通常与 Sitefinity 所做的不同），但我离得足够近，不会破坏用户体验。

可以使用 javascript 重新创建操作菜单，但是如果您正在寻找可以为您完成所有这些操作的 NATIVE 集成，那么您确实会考虑继承或更好：只需使用模块构建器，它可以让您构建自动生成的自定义类型将它们自己安装到 Sitefinity 中，就好像它们是常规模块一样。

字段绝对设计为在本机 sitefinity 模块定义（使用 Sitefinity 上下文构成 UI 的类）的上下文中运行。这并不意味着您不能在模块中包含 Sitefinity 内容；它只是意味着如果你这样做，你必须使用 API 自己实现集成。

关于您的最后一个问题，使用外部数据但仍保留“Sitefinity 内容”UI 的唯一方法是从 Content 继承，然后创建一个自定义提供程序，该提供程序从您的数据库中读取并将其转换为 Sitefinity 内容类型。这当然是可能的，但这是一个相当大的项目。

除非您完全需要这种紧密集成，否则我建议您简单地进入站点内，通过 API 链接到 Sitefinity 内容类型、分类等并单独管理它。

我希望这可以帮到你！

# asp.net-mvc - .net MVC 4 步向导填充视图模型的正确方法？

> ID：15980517
> 
> 赞同：0
> 
> 时间：2013-04-12T20:42:35.870
> 
> 标签：asp.net-mvc, asp.net-mvc-4

我在 asp.net mvc (splitted viewmodels, single model) 中关注了 Darin 在 [多步骤注册过程问题上的帖子](https://stackoverflow.com/questions/6402628/multi-step-registration-process-issues-in-asp-net-mvc-splitted-viewmodels-sing/6403485#6403485)

它是一个非常优雅的解决方案，但是我无法看到如何用数据填充各个步骤视图模型。我试图模仿亚马逊结帐步骤系统，该系统首先选择地址，然后是运输选项，然后是付款信息。

对于我的第一个视图模型，我需要当前登录用户的地址列表，我轮询数据库以在屏幕上显示

在我看来，这是对我有意义的视图模型。

```
[Serializable]
public class ShippingAddressViewModel : IStepViewModel
{
    public List<AddressViewModel> Addresses { get; set; }

    [Required(ErrorMessage="You must select a shipping address")]
    public Int32? SelectedAddressId { get; set; }

    #region IStepViewModel Members

    private const Int32 stepNumber = 1;

    public int GetStepNumber()
    {
        return stepNumber;
    }

    #endregion
} 
```

但是，似乎没有从控制器填充地址的好方法。

```
public class WizardController : Controller
{
public ActionResult Index()
{
    var wizard = new WizardViewModel();
    wizard.Initialize();
    return View(wizard);
}

[HttpPost]
public ActionResult Index(
    [Deserialize] WizardViewModel wizard, 
    IStepViewModel step)
{
    wizard.Steps[wizard.CurrentStepIndex] = step;
    if (ModelState.IsValid)
    {
        if (!string.IsNullOrEmpty(Request["next"]))
        {
            wizard.CurrentStepIndex++;
        }
        else if (!string.IsNullOrEmpty(Request["prev"]))
        {
            wizard.CurrentStepIndex--;
        }
        else
        {
            // TODO: we have finished: all the step partial
            // view models have passed validation => map them
            // back to the domain model and do some processing with
            // the results

            return Content("thanks for filling this form", "text/plain");
        }
    }
    else if (!string.IsNullOrEmpty(Request["prev"]))
    {
        // Even if validation failed we allow the user to
        // navigate to previous steps
        wizard.CurrentStepIndex--;
    }
    return View(wizard);
    }
} 
```

所以我删除了地址视图模型列表

```
[Serializable]
public class ShippingAddressViewModel : IStepViewModel
{
    [Required(ErrorMessage="You must select a shipping address")]
    public Int32? SelectedAddressId { get; set; }

    #region IStepViewModel Members

    private const Int32 stepNumber = 1;

    public int GetStepNumber()
    {
        return stepNumber;
    }

    #endregion
} 
```

这就是我为视图模型设计的自定义编辑器模板。它调用一个 Html.RenderAction，它从我的用户控制器返回所有地址的部分视图，并使用 Jquery 填充视图模型所需的 SelectedAddressId 属性的隐藏输入字段。

```
@model ViewModels.Checkout.ShippingAddressViewModel

<script src="../../Scripts/jquery-1.7.1.js" type="text/javascript"></script>
<script type="text/javascript">
    $(document).ready(function () {
        //Check to see if the shipping id is already set
        var shippingID = $("#SelectedAddressId").val();

        if (shippingID != null) {
            $("#address-id-" + shippingID.toString()).addClass("selected");
        }

        $(".address-id-link").click(function () {
            var shipAddrId = $(this).attr("data-addressid").valueOf();
            $("#SelectedAddressId").val(shipAddrId);
            $(this).parent("", $("li")).addClass("selected").siblings().removeClass("selected");
        });
    });

</script>

<div>
    @Html.ValidationMessageFor(m => m.SelectedAddressId)
    @Html.HiddenFor(s => s.SelectedAddressId)
    <div id="ship-to-container">
        @{Html.RenderAction("UserAddresses", "User", null);}
    </div>
</div> 
```

和用户控制器动作

```
[ChildActionOnly]
        public ActionResult UserAddresses()
        {
            var user = db.Users.Include("Addresses").FirstOrDefault(
                u => u.UserID == WebSecurity.CurrentUserId);

            if (user != null)
            {
                return PartialView("UserAddressesPartial", 
                    Mapper.Map<List<AddressViewModel>>(user.Addresses));
            }

            return Content("An error occured");
        } 
```

局部视图

```
@model IEnumerable<AddressViewModel>

<ul>
    @foreach (var item in Model)
        {
        <li id="address-id-@item.AddressID">
            @Html.DisplayFor(c => item)
            <a class="address-id-link" href="#" data-addressid="@item.AddressID">Ship To this Address
            </a></li>
        }
</ul> 
```

我的解决方案对我来说似乎超级偏僻/草率，有没有比使用来自不同控制器的部分视图更好的更简洁的方法来填充视图模型？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:10:40.670

使用这样的子操作来填充用户的地址并没有错。事实上，我认为这实际上是最佳方法。您已经完全分离了关注点和单一职责。仅仅因为某事需要更多的“部分”（额外的行动、观点等）并不会使它变得草率或错误。

处理此问题的唯一其他方法是依赖注入。也就是说，您`ShippingAddressViewModel`需要当前登录用户的依赖关系，以便它可以从其构造函数中填充地址列表。但是，由于`ShippingAddressViewModel`未在您的视图中公开，因此您必须传递依赖关系，`Wizard`这有点代码味道。`Wizard`不依赖于用户，但由于您的视图模型在其中抽象出来，它会强制依赖它。

总而言之，虽然有一种方法*可以*在没有子动作和局部视图的情况下做到这一点，但实际上它会比使用它们更糟糕和草率。

# lucene - Lucene 查询和 AND 逻辑运算符

> ID：15980521
> 
> 赞同：0
> 
> 时间：2013-04-12T20:42:51.630
> 
> 标签：lucene

我需要在 Lucene .Net 版本 3 中 AND 两个 NumericRangeQueries 和一个 term 查询。我知道我可以将 Combine 方法用于 OR，但无法弄清楚如何对查询进行 AND。这可以做到吗？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:45:27.437

使用`BooleanQuery`并添加两个查询`Occur.MUST`。见[http://lucenenet.apache.org/docs/3.0.3/d8/d7c/class_lucene_1_1_net_1_1_search_1_1_boolean_query.html](http://lucenenet.apache.org/docs/3.0.3/d8/d7c/class_lucene_1_1_net_1_1_search_1_1_boolean_query.html)

# c++ - waitpid 返回 ECHILD - 但 pid 有效

> ID：15980523
> 
> 赞同：1
> 
> 时间：2013-04-12T20:42:57.823
> 
> 标签：c++, c, linux, process, posix

我有一个使用 execve 生成​​其他进程的程序：

```
 s32 ret = execve( argv[0], argv.data(), (char* const*) req.posixEnv() ); 
```

然后稍后在一个循环中，我调用 waitpid 来观察进程何时终止：

```
while( 1 )
{
  readOutputFromChildProcess( pid );

  int status;
  s32 retPid = waitpid( pid, &status, WNOHANG );

  if ( retPid < 0 )
  {
     if ( errno == ECHILD )
     {
         // I don't expect to ever get this error - but I do. why?
         printf( "Process gone before previous wait. Return status lost.\n" );
         assert(0); 
     } else {
         // other real errors handled here.
         handleError();
         break;
     }
  }

  if ( retPid == 0 )
  {
     waitSomeTime();
     continue; 
  }

  processValidResults( status );
  break;
} 
```

我已经大大简化了代码。我的理解是，一旦你产生了一个进程，进程表条目就会一直存在，直到调用者调用“waitpid”并获得一个大于零的返回值和一个有效的返回状态。

但是在某些情况下似乎发生的是进程自行终止，当我调用waitpid时，它返回-1，错误为ECHILD

ECHILD 表示在我调用 waitpid 时，进程表中没有具有该 ID 的进程。所以要么我的 pid 无效——而且我已经仔细检查过——它是有效的。

或 - 在此过程完成后已调用 waitpid - 在这种情况下，我无法从此过程中获取返回码。

该程序是多线程的。我也检查过我没有太早调用waitpid。它发生在几次“等待”之后。

有没有其他方法可以在不调用 waitpid 的情况下清理进程表条目？如何确保始终获得返回码？

@明确忽略 SIGCHLD：

好的，所以我知道明确忽略它会导致 waitpid() 失败。我没有明确地忽略它，但我确实设置了一些信号处理程序来捕获另一个地方的崩溃，如下所示：

```
void kxHandleCrashes()
{
   struct sigaction sa;
   sa.sa_flags = SA_SIGINFO;
   sa.sa_sigaction = abortHandler;
   sigemptyset( &sa.sa_mask );

   sigaction( SIGABRT, &sa, NULL );
   sigaction( SIGSEGV, &sa, NULL );
   sigaction( SIGBUS,  &sa, NULL );
   sigaction( SIGILL,  &sa, NULL );
   sigaction( SIGFPE,  &sa, NULL );
   sigaction( SIGPIPE, &sa, NULL );

   // Should I add aline like this:
   // sigaction( SIGCHLD, &sa, NULL );
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-06-26T00:17:42.440

我有类似的问题 - waitpid 会因 ECHLD 而失败。子进程正在运行，我没有触摸 SIGCHLD 处理程序（默认处理程序到位），但每次仍然在 waitpid 上获取 ECHLD。

经过几个小时的调查，事实证明我分叉了孩子，然后妖魔化了父母（它分叉了它），这有效地将所有孩子变成了孤儿。

我在分叉子代之前移动了父守护进程，一切都开始完美无缺。

因此，如果您收到这个神秘的 ECHLD 错误，并且您没有弄乱 SIGCHLD 信号处理程序 - 检查这些孩子是否实际上仍然是您的孩子，并且孩子的 PPID 等于父母的 PID。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T20:53:47.950

您的程序示例缺少一条重要信息：您如何声明`errno`？

您应该确保包含`errno.h`.

请参阅[线程安全和 POSIX.1](http://www.unix.org/whitepapers/reentrant.html)*的 errno 重新定义*部分。

# html - 如何将 HTML5 属性添加到 Ember 视图

> ID：15980524
> 
> 赞同：0
> 
> 时间：2013-04-12T20:42:59.077
> 
> 标签：html, ember.js

考虑我有以下 HTML 片段：

```
<div class="content" data-section-content></div> 
```

我想用这样的 Ember 视图替换它：

```
App.ContentView = Ember.View.extend({
   tagName :"div",
   classNames : ["content"],
   ... ( how can i add the >> data-section-content << to the view )
}); 
```

*将数据部分内容*添加到视图的最佳方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:21:03.503

似乎 `<div class="content" data-section-content></div>`是一样的`<div class="content" data-section-content=""></div>`

所以我可以通过实施来解决问题：

```
App.ContentView = Ember.View.extend({
   tagName :"div",
   classNames : ["content"],
   attributeBindings : ["data-section-content"],
   "data-section-content": ""
}); 
```

或更短

```
App.ContentView = Ember.View.extend({
   tagName :"div data-section-content",
   classNames : ["content"]
}); 
```

# sql - EXCEPT 子句的访问替代

> ID：15980525
> 
> 赞同：8
> 
> 时间：2013-04-12T20:43:09.070
> 
> 标签：sql, ms-access

如何在 ms 访问中获得与下面的 SQL 代码相同的结果？它不承认该`EXCEPT`子句...

```
SELECT DISTINCT 
       P.Name, 
       T.Training
  FROM Prof AS P, 
       Training_done AS TC, 
       Trainings AS T
 WHERE (P.Name Like '*' & NameProf & '*') 
   AND (P.Primary_Area = T.Cod_Area)
EXCEPT
SELECT DISTINCT 
       P.Name, 
       T.Training
  FROM Prof AS P, 
       Training_done AS TC, 
       Trainings AS T
 WHERE (P.Name Like '*' & NameProf & '*') 
   AND (P.Cod_Prof = TC.Cod_Prof); 
```

提前致谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:53:50.840

为了摆脱`EXCEPT`你可以结合条件并否定第二个：

```
SELECT DISTINCT 
       P.Name, 
       T.Training
  FROM Prof AS P, 
       Training_done AS TC, 
       Trainings AS T
 WHERE ((P.Name Like '*' & NameProf & '*') AND
        (P.Primary_Area = T.Cod_Area)) 
   AND NOT ((P.Name Like '*' & NameProf & '*') AND
            (P.Cod_Prof = TC.Cod_Prof)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-09-02T20:51:39.530

```
SELECT A.x FROM A
EXCEPT
SELECT B.x FROM B 
```

对应于

```
SELECT A.x FROM A 
LEFT JOIN B 
ON A.x = B.x 
WHERE B.x IS NULL 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-02-15T12:13:09.783

使用MS Access > Create > **Query Wizard中的****find unmatched 向导**，您将得到以下结果

 ****联合**是一个单独的访问查询，我用来联合几个表而不是使用子查询

```
SELECT TableMain.Field1
FROM TableMain LEFT JOIN [Union] ON TableMain.[Field1] = Union.[field1]
WHERE (((Union.field1) Is Null)); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-06-12T16:58:17.147

这里不是一个明确的例子，但考虑对两个获取的表进行 UNION 并从该联合中选择具有少于 2 个特定字段组合实例的对。这意味着，如果每个表在字段组合上具有多个具有相同值的记录实例，则这些记录是相同的并且可以从结果集中消除。如果不是，它们对一个表是唯一的，只留下所选表中与另一表不匹配的记录。有点像穷人的“除了”KW。**

# php - 链接函数调用时返回行的 PHP 标准

> ID：15980527
> 
> 赞同：5
> 
> 时间：2013-04-12T20:43:21.820
> 
> 标签：php, coding-style

在我的任何 Google 搜索中，我都无法找到答案，但是当我跨行链接函数调用时，在箭头运算符之前或之后是否有返回行的标准/最佳实践？

我想出的两个选项是在箭头运算符之后返回：

```
$myclass->
    foo->
    bar->
    baz(); 
```

在箭头运算符之前：

```
$myclass
    ->foo
    ->bar
    ->baz(); 
```

如果可能的话，我们会尽量坚持 PSR-2 编码标准。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:50:26.600

PSR2 没有指定。请参阅[https://stackoverflow.com/a/11894206/2016155](https://stackoverflow.com/a/11894206/2016155)。如果你问我，第二个选项更具可读性。

# xml - 使用 xmlReader 循环带有元素的 XML

> ID：15980532
> 
> 赞同：0
> 
> 时间：2013-04-12T20:43:46.683
> 
> 标签：xml, vb.net, xml-parsing, xmlreader

```
 Dim client As New WebClient()
   Dim xmlString As String = client.DownloadString("http://api.rovicorp.com/TVlistings/v9/listings/gridschedule/80000/info?locale=en-US&duration=220&includechannelimages=1&format=xml&apikey=" & api_TV)
   Dim counter As Integer = 0

Using reader As XmlReader = XmlReader.Create(New StringReader(xmlString))
    Dim tvListings As XDocument = XDocument.Parse(xmlString)

    For Each blah As XElement In tvListings.Root.Elements
        counter += 1
    Next

    Debug.Print(counter)
End Using 
```

我只得到一个8 的**计数器**，应该是 100+。

XML 如下所示：

```
<GetGridScheduleResult xmlns="http://api.rovicorp.com/v9/listings" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" Locale="en-US" ServiceId="5122" Name="Cityhere - Comcast" StartDate="2013-04-12T14:18:24.2054325Z" Duration="240">
<GridChannels>
  <GridChannel ServiceId="890138" SourceId="1280" Order="20002" Channel="2" CallLetters="WGNAMER" DisplayName="WGNAMER" SourceLongName="WGN America" Type="24-Hours" SourceType="Basic" ParentNetworkId="0" IconAvailable="false" IsChannelOverride="false" SourceAttributes="0">
    <ChannelSchedules/>
    <SourceAttributeTypes/>
    <Airings>
        <GridAiring ProgramId="35951" SeriesId="3490" Title="Matlock" EpisodeTitle="Santa Claus" AiringTime="2013-04-12T14:00:00Z" Duration="60" Color="Color" AiringType="Unknown" CC="true" LetterBox="false" Stereo="false" HD="false" SAP="false" TVRating="TV-PG" Dolby="false" DSS="false" HDLevel="HD Level Unknown" DVS="false" Category="Other" Subcategory="drama" Sports="false"/>
        <GridAiring ProgramId="828869" SeriesId="1409" Title="In the Heat of the Night" EpisodeTitle="Hatton's Turn" AiringTime="2013-04-12T15:00:00Z" Duration="60" Color="Color" AiringType="Unknown" CC="true" LetterBox="false" Stereo="false" HD="false" SAP="false" TVRating="TV-PG@V" Dolby="false" DSS="false" HDLevel="HD Level Unknown" DVS="false" Category="Other" Subcategory="crime drama" Sports="false"/>
        <GridAiring ProgramId="978338" SeriesId="1409" Title="In the Heat of the Night" EpisodeTitle="Hatton's Turn" AiringTime="2013-04-12T16:00:00Z" Duration="60" Color="Color" AiringType="Unknown" CC="true" LetterBox="false" Stereo="false" HD="false" SAP="false" TVRating="TV-PG@V" Dolby="false" DSS="false" HDLevel="HD Level Unknown" DVS="false" Category="Other" Subcategory="crime drama" Sports="false"/>
        <GridAiring ProgramId="4210626" Title="WGN Midday News" AiringTime="2013-04-12T17:00:00Z" Duration="60" Color="Color" AiringType="New" CC="true" LetterBox="false" Stereo="true" HD="false" SAP="false" TVRating="None" Dolby="false" DSS="false" HDLevel="HD Level Unknown" DVS="false" Category="News" Subcategory="newscast" Sports="false"/>
        <GridAiring ProgramId="878716" SeriesId="1028666" Title="Walker, Texas Ranger" EpisodeTitle="El Coyote, Part 2" AiringTime="2013-04-12T18:00:00Z" Duration="60" Color="Color" AiringType="Unknown" CC="true" LetterBox="false" Stereo="true" HD="false" SAP="false" TVRating="TV-14@V" Dolby="false" DSS="false" HDLevel="HD Level Unknown" DVS="false" Category="Other" Subcategory="crime drama" Sports="false"/>
    </Airings>
    <ChannelImages>
        <ImageGrid ImageUrl="http://cps-static.rovicorp.com/2/Open/TV%20Guide%20Widget%20Logos/WGN_2010.png" ImageId="427700" ImageTitle="WGN America" ImageCaption="Widget Logo" ObjectId="1280" ObjectName="WGN America" ImageCreditDisplay="false" ImageType="Station Logo" ImageHorizontalResolution="92" ImageVerticalResolution="36" ImageFormatId="0" AspectRatio="5:2" ParentImageId="16818227">
            <ObjectType>Source</ObjectType>
            <ImageFormat xsi:nil="true"/>
            <ImageExpiryDateTime xsi:nil="true"/>
            <LastUpdate>2012-01-24T15:20:46.453Z</LastUpdate>
        </ImageGrid>
    </ChannelImages>
  </GridChannel>
  etc etc...
</GridChannels>
</GetGridScheduleResult> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-17T12:22:32.407

通过这样做得到它：

```
 Dim jsonObject As RootObject = JsonConvert.DeserializeObject(Of RootObject)(s)

    For Each post In jsonObject.GridScheduleResult.GridChannels
        Dim Channel As String = post.Channel
        Dim DisplayName As String = post.DisplayName

        If post.ChannelImages.Count <> 0 Then
            Dim ImageUrl As String = post.ChannelImages.Item(0).ToString
            Dim tmpL As Integer = InStr(ImageUrl, ":")
            Dim tmpR As Integer = InStr(ImageUrl, ",")
        End If

        While counter < post.Airings.Count
            Dim Title As String = post.Airings.Item(counter).Title
            Dim EpisodeTitle As String = post.Airings.Item(counter).EpisodeTitle
        End While

        theTime = 0
        counter = 0
    Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T09:52:13.077

那就试试这个

```
Dim doc as XmlDocument =  new XmlDocument();
doc.LoadXml(xmlString)
XmlNode channelsNode = doc.documentElement.SelectSingleNode("GridChannels")
foreach XmlNode gridChannelNode in channelsNode.SelectNodes("GridChannel"))
///
Next 
```

鉴于您发布的内容，这应该只是获取 GridChannels 节点然后循环遍历它的 GridChannel 子节点的问题。

原谅缺乏VBness，我是C#男孩

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T22:03:52.820

如果您只想计算`<GridChannel>`元素数量，那么您只需要一个小的 LINQ 语句

C＃

```
XDocument document = XDocument.Parse(XmlString);
var count = document.Descendants("GridChannel").Count(); 
```

VB.Net

```
Dim document as XDocument = XDocument.Parse(XmlString)
Dim count = document.Descendants("GridChannel").Count() 
```

# sql - 插入而不是从选择和插入的数据

> ID：15980538
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:44:22.190
> 
> 标签：sql, sqlite

我在 SQLite DB 中创建触发器时遇到问题，该触发器将值插入到 2 个不同的表中，然后将这些表中的“ID”值和插入数据中的值插入到第三个表中。所以基本的想法是......

```
CREATE TABLE [TBL1] (ID UNIQUE INT AUTOINCREMENT,VAL1);
CREATE TABLE [TBL2] (ID UNIQUE INT AUTOINCREMENT,VAL2);
CREATE TABLE [TBL3] (ID1 INT,ID2 INT,VAL3);
CREATE VIEW [v_TBL3] AS 
  SELECT (TBL1.VAL1,TBL2.VAL2,TBL3.VAL3) 
  FROM TBL3 
  INNER JOIN TBL1 ON TBL3.ID1 = TBL1.ID
  INNER JOIN TBL2 ON TBL3.ID2 = TBL2.ID;

========== heres the problem ==========
CREATE TRIGGER [t_TBL3_INSERT] INSTEAD OF INSERT ON v_TBL3
  BEGIN
    INSERT OR IGNORE INTO [TBL1] (VAL1) VALUES NEW.VAL1;
    INSERT OR IGNORE INTO [TBL2] (VAL2) VALUES NEW.VAL2;

    INSERT INTO [TBL3] (ID1,ID2,v_TBL3.VAL3) 
      SELECT (TBL1.ID,TBL2.ID,VAL3)
      FROM TBL1,TBL2,v_TBL3
      WHERE TBL1.VAL1 = v_TBL3.VAL1 AND TBL2.VAL2 = v_TBL3.VAL2;
  END; 
```

我在网上四处查看，但我没有找到让我到达那里所需的东西。有人可以帮我到达那里吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:47:22.130

您没有提到您的问题是什么，但是当使用[正确的 SQL 语法](http://www.sqlite.org/lang.html)时，您的架构将如下所示：

```
CREATE TABLE TBL1 (ID INTEGER PRIMARY KEY AUTOINCREMENT, VAL1);
CREATE TABLE TBL2 (ID INTEGER PRIMARY KEY AUTOINCREMENT, VAL2);
CREATE TABLE TBL3 (ID1 INT, ID2 INT, VAL3);
CREATE VIEW v_TBL3 AS 
  SELECT TBL1.VAL1, TBL2.VAL2, TBL3.VAL3
  FROM TBL3 
  INNER JOIN TBL1 ON TBL3.ID1 = TBL1.ID
  INNER JOIN TBL2 ON TBL3.ID2 = TBL2.ID;

CREATE TRIGGER t_TBL3_INSERT
INSTEAD OF INSERT ON v_TBL3
BEGIN
    INSERT OR IGNORE INTO TBL1 (VAL1) VALUES (NEW.VAL1);
    INSERT OR IGNORE INTO TBL2 (VAL2) VALUES (NEW.VAL2);

    INSERT INTO TBL3 (ID1, ID2, VAL3) 
      SELECT TBL1.ID, TBL2.ID, VAL3
      FROM TBL1, TBL2, v_TBL3
      WHERE TBL1.VAL1 = v_TBL3.VAL1 AND TBL2.VAL2 = v_TBL3.VAL2;
END; 
```

# android - 使用 onPreferenceClick 创建 AlertDialog

> ID：15980541
> 
> 赞同：0
> 
> 时间：2013-04-12T20:44:29.730
> 
> 标签：android

当使用此代码单击首选项时，我正在尝试打开 AlertDialog：

```
public class Opciones extends PreferenceActivity {

    private Context ctx;

    @SuppressWarnings("deprecation")
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        addPreferencesFromResource(R.xml.opciones);

        Preference myPref = (Preference) findPreference("sobreApp");
        myPref.setOnPreferenceClickListener(new OnPreferenceClickListener() {
            public boolean onPreferenceClick(Preference preference) {
                AlertDialog.Builder builder = new AlertDialog.Builder(ctx);
                builder.setCancelable(true);
                builder.setTitle(R.string.sobreApp);
                builder.setMessage(R.string.sobrePokeDroidex);
                builder.show();
                return false;
            }
        });

    }

} 
```

但是，当我单击首选项时，应用程序将关闭。有什么建议么？

# c# - 在使用 C# 将事务提交到 SQL Server 之前备份原始行数据

> ID：15980543
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:44:40.893
> 
> 标签：c#, sql-server-2008, transactions, rollback

我希望能够备份表中已修改或删除的行的所有原始数据。我还想跟踪所有插入的行。这样做的原因是我的应用程序将有一个用户来更改对数据库的更改，并且我不想在用户确认所有更改都正确之前提交更改。

我该怎么做呢？我查看了 TransactionScope 和 Transaction 类，但是如果程序对 100 个不同的表进行 100 次更新怎么办。如果我的理解是正确的，那么我需要 100 个不同的线程，直到用户确认更改是正确的？我在搜索提交和回滚事务时遇到了[这个问题。](https://stackoverflow.com/questions/5657033/whats-the-use-of-isolationlevel-in-sqltransaction-if-i-never-get-to-read-volati)

帮助 ：（

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:28:43.580

As you want to track all changed rows your issue is not about Transaction. Transaction is for keeping integrity of database incase of an error between two commands. I think you need an Undo/Redo history model.

You can solve your problem by using additional tables. One table for keeping all changes and one for pointing approved version of changes. For a products table it may be something like that:

```
Products Table
RowId | ProductId | ProductName | Description | Price | ChangingTime

ApprovedProducts Table
ProductId | RowId 
```

Whenever user updates a product you add a new row into `Products` table and you can point the desired row with `RowId` in `ApprovedProducts` table.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T01:29:12.090

我认为你应该让数据库去做，你可以写一个插入、更新和删除的触发器，并保存新数据和旧数据。不推荐在前端执行此操作，触发器很容易且可移植到任何数据库引擎。

问候，

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:53:03.853

如果您正在等待用户输入，您不应该让交易一直处于打开状态。事务更适合处理数据库本身或管理数据库操作的 .NET 代码的低级别回滚。

如果您正在等待用户输入，请将临时数据存储在不同的表中，直到您得到他们的确认，然后将数据移动到其最终位置。

# ios - 从 Mac 命令行访问 iOS 应用程序目录（沙盒）

> ID：15980545
> 
> 赞同：5
> 
> 时间：2013-04-12T20:44:46.767
> 
> 标签：ios

我需要使用 Mac 或 Linux 的命令行（非 gui）访问安装在 iOS 设备上的应用程序的沙盒目录。这是为了帮助开发和测试自动化。将 json 文件拖放到沙箱中可以让我设置额外的调试消息和更短的刷新间隔等参数。

像 iFunBox 这样的工具可以完美运行，但只是图形化的，需要多次点击才能完成。发给开发人员的电子邮件没有得到答复。它也不支持 AppleScript。我确实找到了另一个提供 Fuse 模块的应用程序，但结果发现它有问题，特别是如果该应用程序被卸载然后重新安装（为了重置回第一次用户体验）。我向开发人员报告了这些问题，但目前还没有解决办法。

我需要做的事情是：

*   测试是否安装了具有特定捆绑 ID 的应用
*   如果不存在，则创建 Library/Caches/MYLIBNAME 目录
*   将 ~100 字节的 json 文件从 Mac 复制到该目录
*   获取该文件的副本
*   仅适用于 Linux 的解决方案也是可以接受的
*   设备未越狱，我不希望将其作为要求

在某些情况下，我没有应用程序的源代码，因为它是使用我的库的第三方，因此编译不同版本的应用程序是不切实际的。

**感谢lxt，答案在许多评论中。总结是：**

*   与 libimobiledevice 相关的各种库和程序可以解决问题
    *   使用已**修补**的 iFuse 挂载应用程序沙箱
    *   使用 idevicesyslog 查看控制台日志
    *   使用 ideviceinstaller 安装/卸载应用程序
*   与 libimobiledevice 相关的各种库和程序即使不是不可能在 Linux 或 Mac 上编译也非常困难，并且源代码或二进制文件没有统一分发
    *   对于 Ubuntu，请尝试 libimobiledevice（可能有 3 个后缀）、ideviceinstaller 和 libimobiledevice-utils 包
    *   对于 Mac，搜索 libimobiledevice-macosx 可能会为您提供一些帮助

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-09T14:14:02.970

这会有点棘手，因为我认为您已经发现应用程序名称是在每次安装时随机生成的。我不认为有办法过去，当然我知道。这解释了您在模拟新安装时遇到的问题（...应用程序目录名称更改为新的随机哈希，然后您就卡住了）。

虽然我的偏好是以其他方式访问此配置文件（可能通过网络，并且有一些仅在调试/测试构建检查时执行的代码），但如果您确实想这样做，那么我建议尝试类似于编写一个脚本，当您想模拟新安装时选择最近修改的应用程序目录。但这非常hacky。

如果您无法插入仅在调试/测试版本中执行的条件代码，那么我认为 iOS 在文件系统级别使用的随机应用程序命名模式对您来说无论采用何种方法都会有问题。

**更新**：关于 iFuse 和 libimobiledevice - 开箱即用，它将您限制在文档目录中。这是因为 iFuse 的作者不会让入门级用户感到困惑，也因为不同 iOS 版本的结构略有不同。您可以注释掉 iFuse 源代码中的行 - `fuse_opt_add_arg(&args, "-osubdir=Documents");`- 以通过挂载访问库目录。如果这样做，您显然需要自己重新编译 iFuse。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-11T06:41:49.960

您可以使用[MobileDevice Library](http://theiphonewiki.com/wiki/MobileDevice_Library)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-12-17T17:21:19.690

我知道这是一个老问题，我怀疑有人会再看这里，但我想我会提到你可以使用“brew install libimobiledevice”在mac上编译。有很多依赖项，Homebrew 通过为您安装它们确实有助于使其成为一个简单的过程。

# python - 将文本文件中的每个单词存储到列表中

> ID：15980548
> 
> 赞同：0
> 
> 时间：2013-04-12T20:45:06.997
> 
> 标签：python, string, list

所以我正在尝试制作一个读取文件并将每个单词存储到字符串列表中的程序。我可以将每一行添加到字符串列表中（参见下面的代码），但是如何将每个单词添加到字符串列表中？

此外，由于这是一个 Mad Libs 程序，我将有一些看起来像、*名词*或*身体部位*的短语。我如何将正文部分作为一个字符串存储到列表中，因为它在技术上是两个单独的单词？

参考代码：

```
def main():
  file_list = []
  while True: #while loop that runs until the user puts in a file name...
    #or types in quit
    #asks the user for a file name, or gives them an option to quit
    file_name = raw_input("Enter in the name of the file, or type in quit to quit: ")
    if file_name == "quit":
            sys.exit(0) #quits the program
    else:
            try: #attempts to open the file
                fin = open(file_name)
                break
            except: #prints out if file name doesn't exist
                    print "No, no, file no here."
  for eachLine in fin: #strips out the new lines from the file
        file_list.append(eachLine.strip())
  print file_list
if __name__ == '__main__':
    main() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:48:53.027

```
file_list.extend(eachLine.split()) 
```

# android - android读取文件并上传

> ID：15980551
> 
> 赞同：0
> 
> 时间：2013-04-12T20:45:19.683
> 
> 标签：android, upload

我有一个代码：

```
 File myFile = new File("/sdcard/Pictures/MyCameraApp/1.jpg");
            FileInputStream fin = null;

                // create FileInputStream object
                try {
                    fin = new FileInputStream(myFile);
                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                byte fileContent[] = new byte[(int)myFile.length()];

                // Reads up to certain bytes of data from this input stream into an array of bytes.
                try {
                    fin.read(fileContent);
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                //create string from byte array
                String s = new String(fileContent);

        return new NanoHTTPD.Response(HTTP_OK, "image/jpeg", s); 
```

但是当我使用浏览器时，我看到一个损坏的 JPEG 文件。我究竟做错了什么？我希望用户在输入某个地址时查看 1.jpg 文件

编辑：将代码更改为：

```
 File myFile = new File("/sdcard/Pictures/MyCameraApp/1.jpg");
            FileInputStream fin = null;

                // create FileInputStream object
                try {
                    fin = new FileInputStream(myFile);
                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }

                ByteArrayOutputStream bos = new ByteArrayOutputStream();
                byte[] b = new byte[1024];
                int bytesRead;
                try {
                    while ((bytesRead = fin.read(b)) != -1) {
                       bos.write(b, 0, bytesRead);
                    }
                } catch (IOException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                byte[] fileContent = bos.toByteArray();

                //create string from byte array
                String s = new String(fileContent);

        return new NanoHTTPD.Response(HTTP_OK, "image/jpg", s); 
```

仍然不起作用.....当我进入页面时，我得到损坏的 jpg 文件，（如果我写 image/jpeg 而不是 image/jpg 或 text/html，则将文本另存为 jpg 文件也不起作用。非常适合文本：\

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:07:13.537

## 如何在 Android 中从文件中读取字节

该代码仅读取文件的开头。这就是为什么到达服务器的*字节*显示为损坏的图像文件。

尝试这些代码修改：

```
fin = new FileInputStream(myFile);
ByteArrayOutputStream bos = new ByteArrayOutputStream();
byte[] b = new byte[1024];
while ((int bytesRead = fin.read(b)) != -1) {
   bos.write(b, 0, bytesRead);
}
byte[] fileContent = bos.toByteArray(); 
```

当然，您必须包含所有适当的`Exception`处理程序。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-13T07:36:53.407

这个解决方案不是我的，但很有用，模仿上传表单，你可以在[这里找到源代码](http://reecon.wordpress.com/2010/04/25/uploading-files-to-http-server-using-post-android-sdk/)

```
class Utils {
    public static void upload(String filePath, String urlServer) {
        HttpURLConnection connection = null;
        DataOutputStream outputStream = null;
        DataInputStream inputStream = null;

        String lineEnd = "\r\n";
        String twoHyphens = "--";
        String boundary =  "*****";

        int bytesRead, bytesAvailable, bufferSize;
        byte[] buffer;
        int maxBufferSize = 1*1024*1024;

        try  {
            FileInputStream fileInputStream = new FileInputStream(new File(pathToOurFile) );

            URL url = new URL(urlServer);
            connection = (HttpURLConnection) url.openConnection();

            // Allow Inputs & Outputs
            connection.setDoInput(true);
            connection.setDoOutput(true);
            connection.setUseCaches(false);

            // Enable POST method
            connection.setRequestMethod("POST");

            connection.setRequestProperty("Connection", "Keep-Alive");
            connection.setRequestProperty("Content-Type", "multipart/form-data;boundary="+boundary);

            outputStream = new DataOutputStream( connection.getOutputStream() );
            outputStream.writeBytes(twoHyphens + boundary + lineEnd);
            outputStream.writeBytes("Content-Disposition: form-data; name=\"uploadedfile\";filename=\"" + pathToOurFile +"\"" + lineEnd);
            outputStream.writeBytes(lineEnd);

            bytesAvailable = fileInputStream.available();
            bufferSize = Math.min(bytesAvailable, maxBufferSize);
            buffer = new byte[bufferSize];

            // Read file
            bytesRead = fileInputStream.read(buffer, 0, bufferSize);

            while (bytesRead > 0) {
                outputStream.write(buffer, 0, bufferSize);
                bytesAvailable = fileInputStream.available();
                bufferSize = Math.min(bytesAvailable, maxBufferSize);
                bytesRead = fileInputStream.read(buffer, 0, bufferSize);
            }

            outputStream.writeBytes(lineEnd);
            outputStream.writeBytes(twoHyphens + boundary + twoHyphens + lineEnd);

            // Responses from the server (code and message)
            serverResponseCode = connection.getResponseCode();
            serverResponseMessage = connection.getResponseMessage();

            fileInputStream.close();
            outputStream.flush();
            outputStream.close();
        }
        catch (Exception ex) {
            //Exception handling
        }
    }
} 
```

接收代码

```
<?php
    $target_path  = "./";
    $target_path = $target_path . basename( $_FILES['uploadedfile']['name']);
    if(move_uploaded_file($_FILES['uploadedfile']['tmp_name'], $target_path)) {
        echo "The file ".  basename( $_FILES['uploadedfile']['name']). " has been uploaded";
    } else{
        echo "There was an error uploading the file, please try again!";
    }
?> 
```

# css - Openshift - 尽管资产预编译，但 CSS 没有被刷新

> ID：15980554
> 
> 赞同：0
> 
> 时间：2013-04-12T20:45:33.223
> 
> 标签：css, ruby-on-rails-3, asset-pipeline, openshift

我有一个奇怪的问题，导致我拉了 6 个小时的头发。

尽管 git push log 说正在编译资产并通过 SSH 运行手动执行相同的操作

```
RAILS_ENV="production" bundle exec "rake assets:precompile" 
```

我的 CSS 在我的生产应用程序上仍然看起来不正确

在我的生产服务器上，我有：

```
margin: 0 2px 5px 0; 
```

但我想要和我的开发机器上的一样

```
margin: 1px 4px 1px 0; 
```

如何确保我的 CSS 与开发机器同步？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-06T21:13:08.560

[您可以通过操作挂钩https://www.openshift.com/developers/deploying-and-building-applications](https://www.openshift.com/developers/deploying-and-building-applications)更改 Openshift 部署行为

# javascript - 如何使用 Raphael.js 绘制“透明笔画”

> ID：15980555
> 
> 赞同：0
> 
> 时间：2013-04-12T20:45:36.913
> 
> 标签：javascript, canvas, svg, raphael, stroke

我正在尝试绘制图形的路径，以便路径是透明的，而画布的其余部分则不是。这样我就可以使用画布作为蒙版，并使用 html 元素用不同的颜色填充路径。有点像这样：

> ![在此处输入图像描述](https://i.stack.imgur.com/vppYf.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:29:22.300

There's no way to achieve this natively through Raphael, but it could be accomplished by some selective modification of the SVG produced by Raphael. Consider the use of a [mask](http://www.w3.org/TR/SVG/masking.html#Masking) applied to the path. This technique is used to absolutely delicious visual effect [here](http://atomicrobotdesign.com/blog_media/svg_mask.html).

Don't forget that you can access the DOM node associated with a Raphael paper object through that paper object's `canvas` property (I don't know why Baranovskiy chose such a misleading name!). You could use this to interact directly with the SVG in the DOM, though I can't vouch for interactions between Raphael and custom modifications =)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-16T18:30:49.177

要仅填充路径的外部，您必须绘制由两个路径字符串组成的通常称为“甜甜圈”的东西。

你会在这里找到一个很好的例子：[如何在 Raphael 中使用路径实现“甜甜圈洞”](https://stackoverflow.com/questions/3349651/how-to-achieve-donut-holes-with-paths-in-raphael)。

想法是： * 将外部路径字符串作为一个大的逆时针闭合矩形，告诉浏览器必须填充的是里面的内容 * 将内部路径字符串连接为您想要的顺时针闭合路径，告诉浏览器有什么被填满的是外面的东西。

从而产生带有孔的填充形状，该孔是两个填充形状的交集。

# javascript - 是否可以将 websocket 重新连接到不同的主机？

> ID：15980560
> 
> 赞同：1
> 
> 时间：2013-04-12T20:46:16.377
> 
> 标签：javascript, websocket, socket.io

使用 socket.io，我有：

```
var socket = io.connect('//' + Server_Hostname, {secure: true}); 
```

如果服务器断开连接，我想尝试重新连接到另一台服务器。如果不通过创建新的套接字对象`io.connect`（因此必须重新连接我所有的事件处理程序），这是否可能？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:21:46.900

我个人知道没有简单的方法可以做你想做的事，但为了让事情变得不那么复杂，你可以保存旧套接字的侦听器，连接到其他地方，然后转移旧的侦听器。

```
socket.disconnect();
var listeners = socket.$events; 
```

在我们存储了前一个套接字的侦听器之后，我们可以通过两种方式重新连接。

```
socket = io.connect(host, {
  'force new connection': true
});

//alternate reconnect method
socket.socket.connect(host); 
```

然后我们可以重新分配旧的侦听器对象。

```
socket.$events = listeners; 
```

然后，您确实有一个新的套接字对象，但是使用此方法重新连接事件处理程序并不太麻烦。

# javascript - 如何使用带有复选框的knockoutjs受保护的observable？

> ID：15980563
> 
> 赞同：9
> 
> 时间：2013-04-12T20:46:47.487
> 
> 标签：javascript, knockout.js

我正在使用带有受保护的 observable 的 knockoutjs，并且遇到了复选框问题。可以在[此处](http://www.knockmeout.net/2011/03/guard-your-model-accept-or-cancel-edits.html)找到一种受保护的 observables 的实现，但我见过一些非常相似的实现。

可以在[此处](http://jsfiddle.net/rhoadsce/r9pKr/1/)找到演示我的问题的 jsFiddle 。这是小提琴的一部分。

```
var ViewModel = function() {
    var self = this;

    self.protectedBool = ko.protectedObservable(true);
    self.commit = function(){
        ko.commitProtectedObservables(self);
    };
    self.rollback = function() {
        ko.rollbackProtectedObservables(self);
    };
};

$(function() {
    ko.applyBindings(new ViewModel());
}); 
```

要复制，请执行以下操作：

1.  运行小提琴（复选框的默认值为 true）
2.  取消选中复选框
3.  点击“提交”
4.  请注意，该值现在显示为 false（这是正确的行为）
5.  再次运行小提琴（复选框的默认值为 true）
6.  取消选中复选框，然后立即检查（在单击“提交”之前）
7.  点击“提交”
8.  您将看到该值将设置为 false/unchecked，即使在您单击“提交”时它已被选中。

在 protectedObservable 定义中计算的 observable 中的“write”事件*不会*在您第二次更改复选框时被触发，因此当提交值时，它会提交不正确的值。

另请注意，protectedObservable 非常适用于字符串。任何指导将不胜感激。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-30T18:04:49.900

`protectedObservable`的实现已经很老了。它仅适用于旧版本的 KO (<2)。

对于新的 KO 版本，请参阅同一作者 (Ryan Niemeyer) 实现的编辑器模式 - [http://www.knockmeout.net/2013/01/simple-editor-pattern-knockout-js.html](http://www.knockmeout.net/2013/01/simple-editor-pattern-knockout-js.html)

# jquery - jQuery 在这个里面选择 p

> ID：15980573
> 
> 赞同：-2
> 
> 时间：2013-04-12T20:47:38.200
> 
> 标签：jquery, html, jquery-ui, jquery-selectors

我在点击的ID中选择ap标签时遇到了一些问题，代码如下；

> ```
> <tbody>
>     <tr id="test1">
>     <p>
>         Some random text that should show up in the dialog.
>     </p>
>         <td>test</td>
>         <td>test</td>
>     </tr>
>     ... the rest of the tr's are identical, nothing else to see here.
>  </tbody>
> 
> $('#test1, #test2, #test3, #test4').click(function(){
>     $(this 'p').dialog();
> }); 
> ```

现场测试；[http://team-blandsaft.no-ip.org/](http://team-blandsaft.no-ip.org/)

最好习惯在 stackoverflow 编辑器中编写一些代码。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T20:48:22.897

使用[.find()](http://api.jquery.com/find/)

```
$(this).find('p').dialog(); 
```

或者您可以使用[上下文选择器](http://api.jquery.com/jQuery/#selector-context)

```
$('p',this).dialog(); 
```

在内部使用 find 方法

`<p>`正如其他人所提到的，您的 html 无效`<tr>`

来自tr 的[MDN 文档](https://developer.mozilla.org/en-US/docs/HTML/Element/tr)

> 允许的内容：零个或多个`<td>`或`<th>`元素，或它们的混合

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T22:52:15.577

```
$('#test1, #test2, #test3, #test4').click(function(){
    $(this).children('p').dialog();
}); 
```

# php - PHP时间戳上的数学

> ID：15980575
> 
> 赞同：0
> 
> 时间：2013-04-12T20:47:47.000
> 
> 标签：php

我有以下 PHP 块：

```
if ($data->timestamp > (time() - 10 * 60) ) {
 // data is newer than 10 mins
} else {
 // data is older than 10 mins
} 
```

这基本上说明了存储的时间戳`$data`是否超过 10 分钟。

我不确定这是如何准确计算出来的，我在这里阅读了时间函数：http: [//php.net/manual/en/function.time.php](http://php.net/manual/en/function.time.php)

我想将其编辑为**每小时**而不是 10 分钟。

任何人都可以分享一些建议/资源吗？例如，我将如何将其更改为 1 小时，以及它是如何计算出来的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:52:50.087

此代码行检查 $data 中保存的时间戳是否不超过 10 分钟。

time() 函数以秒为单位给出机器的 UNIX tiemstamp。如果您想将其更改为 60 秒 60*60 后的 60 分钟，则为一小时。您的代码将如下所示：

if ($data->timestamp > (time() - 60*60) )

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:53:20.760

它是在几秒钟内从右到左计算出来的。一小时将是

```
if ($data->timestamp > (time() - 60 * 60); 
```

格式化

```
time() + (7 * 24 * 60 * 60);
// 7 days; 24 hours; 60 mins; 60secs 
```

当您返回 60 乘以 60 分钟等时，您将其乘以

# sql-server - SQL Server：分页到 Excel

> ID：15980578
> 
> 赞同：1
> 
> 时间：2013-04-12T20:47:55.127
> 
> 标签：sql-server, pagination, recursive-query

我有一个大型数据集，我需要进入 excel 才能进行一些数据透视表和分析。

我通常能够做到这一点，因为数据永远不会达到 100 万行标记。我只是执行 SQL Server 数据导入并指定我的 SQL 语句。

这是我当前的 SQL

```
WITH n AS (
    Select A1.AccountID, A1.ParentAccountID, A1.Name
    FROM Account AS A1
    WHERE A1.ParentAccountID = 92
UNION ALL
    SELECT A2.AccountID, A2.ParentAccountID, A2.Name
    FROM Account AS A2
    JOIN n
    ON A2.ParentAccountID=n.AccountID
)
select n.*, D.DeviceID, A.*, P.*
FROM n
LEFT OUTER JOIN
    Device AS D
    ON D.AccountID = n.AccountID
LEFT OUTER JOIN
    Audit as A
    ON A.AccountID = n.AccountID
RIGHT OUTER JOIN
DeviceAudit As P
ON P.AuditID = A.AuditID
WHERE A.AuditDate > CAST('2013-03-11' AS DATETIME)
ORDER BY n.AccountID ASC, P.DeviceID ASC, A.AuditDate DESC 
```

现在这正在返回给我 100% 我需要的东西。过去 30 天的 1800 万条记录。我希望有一种简单的方法可以找到接下来的 100,000 或 500,000 条记录。

我可以`TOP 100000`用来获取我的第一个块，尽管我似乎没有可用的偏移量。

目前这运行并在 20 分钟内完成。这是我必须执行此操作的许多帐户层次结构之一。希望这种分页不会太昂贵的 CPU 明智。

我确实尝试导出到 CSV 以希望将其导入，但这只是给了我一个 12GB 的 csv 文件，我没有时间分解。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T14:29:50.510

Yes, you can do paginated subqueries on the row number since SQL 2005\. Add a row number to the select clause of your original query:

```
, ROW_NUMBER() OVER (ORDER BY {whatever id}) AS row 
```

Then you can make your old query a subquery and query against the row:

```
SELECT TOP {results per page} *
FROM ({your previous sql statement})
WHERE row > {page# * results per page} 
```

# excel - SSIS中的脚本任务以导入excel电子表格

> ID：15980580
> 
> 赞同：2
> 
> 时间：2013-04-12T20:47:58.220
> 
> 标签：excel, ssis

我已经查看了可能有我回答的问题，不幸的是它们似乎并不适用。这是我的情况。我必须从我的客户那里导入工作表。在 A、C、D 和 AA 列中，客户拥有我需要的信息。列的余额对我来说是毫无价值的信息。列标题在我需要的四列中是一致的，但在无关紧要的列中却非常不一致。例如，单元格 A1 包含除法。在所有电子表格中都是如此。单元格 B1 可以包含从袖长到整体长度的任何内容。我需要做的是只导入我需要的列并将它们映射到 SQL 2008 R2 表。我已经在当前调用 SSIS 函数的存储过程中定义了该表。

问题是，当我尝试导入具有不同列名的电子表格时，SSIS 失败，我必须手动返回运行它以正确设置字段。

我无法想象我正在尝试做的事情以前没有做过。只是为了不丢失数量级，我有 170 个用户，他们拥有超过 120 个不同的电子表格模板。

我迫切需要一个可行的解决方案。在将文件放入我的 SQL 表中后，我可以做任何事情。我什至编写了将文件移回 FTP 服务器的代码。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T16:38:34.190

我整理了一篇文章，描述了我如何使用[Script 任务来解析 Excel](http://billfellows.blogspot.com/2013/04/ssis-excel-source-via-script.html)。它允许我将明确的非表格数据导入数据流。

核心概念是您将使用 JET 或 ACE 提供程序并简单地从 Excel 工作表/命名范围中查询数据。一旦你有了它，你就有了一个数据集，你可以逐行遍历并执行你需要的任何逻辑。在您的情况下，您可以跳过第 1 行作为标题，然后只导入 A、C、D 和 AA 列。

该逻辑将进入 ExcelParser 类。所以，第 71 行的 Foreach 循环可能会被提炼成类似（代码近似）

```
// This gets the value of column A
current = dr[0].ToString();
// this assigns the value of current into our output row at column 0
newRow[0] = current;

// This gets the value of column C
current = dr[2].ToString();
// this assigns the value of current into our output row at column 1
newRow[1] = current;

// This gets the value of column D
current = dr[3].ToString();
// this assigns the value of current into our output row at column 2
newRow[2] = current;

// This gets the value of column AA
current = dr[26].ToString();
// this assigns the value of current into our output row at column 3
newRow[3] = current; 
```

您显然可能需要在这里进行类型转换等，但这是解析逻辑的核心。

# telerik - 删除 Kendo-UI 饼图上的悬停样式

> ID：15980581
> 
> 赞同：2
> 
> 时间：2013-04-12T20:48:04.380
> 
> 标签：telerik, kendo-ui, pie-chart

当用户悬停在 kendo-UI 饼图上时，每个切片都有一个悬停效果，我想起飞。有人知道怎么做吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-21T12:35:13.857

也许有点晚了，但请检查此配置属性：[http ://docs.kendoui.c​​om/api/dataviz/chart#configuration-series.highlight.visible](http://docs.kendoui.com/api/dataviz/chart#configuration-series.highlight.visible)

设置`series.highlight.visible`为`false`删除悬停（“突出显示”）效果。

# javascript - 如何将 emscripten 浏览器输入法从 window.prompt 更改为更明智的方法？

> ID：15980585
> 
> 赞同：7
> 
> 时间：2013-04-12T20:48:19.497
> 
> 标签：javascript, c++, node.js, stdin, emscripten

我有一个 C++ 函数，它曾经被调用消耗来自标准输入的输入。使用 emscripten 将此函数导出到 javascript 会导致调用 window.prompt。

与浏览器提示交互确实是一项繁琐的任务。首先，您一次只能粘贴一行。其次，指示 EOF 的唯一方法是按“取消”。最后但并非最不重要的唯一方法（在我的函数的情况下）使其停止通过 window.prompt 要求用户输入是通过选中复选框以防止弹出更多提示。

对我来说，最好的输入法是阅读一些 blob。我知道我可以破解 library.js，但我发现了一些问题：

1.  读取 blob 是异步的。
2.  要读取 blob，首先您必须打开一个用户必须先选择的文件。
3.  我真的不知道如何阻止我的函数永远读取这个 blob - 没有像 window.prompt 这样的复选框，我不确定如果在 window.prompt 情况下没有发现 EOF 是否会阻止它（仅检查复选框有帮助）。

最好的解决方案是某种回调，但我希望从更有经验的用户那里看到一些提示。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-13T15:32:12.590

据我了解，您可以尝试以下操作：

1.  实现在 Javascript 中选择文件并通过 Javascript`Blob`接口访问它。
2.  *在Emscripten*中分配一些内存

     *```
    var buf = Module._malloc( blob.size ); 
    ```* 
**   将您的内容写入`Blob`Javascript 返回的内存位置。

    ```
    Module.HEAPU8.set( new Uint8Array(blob), buf ); 
    ```

    *   将该内存位置传递给第二个*Emscripten*编译函数，该函数然后处理文件内容并

    *   释放分配的内存。

    ```
    Module._free( buf ); 
    ```* 

 *最好先阅读[wiki](http://kripken.github.io/emscripten-site/docs/porting/connecting_cpp_and_javascript/Interacting-with-code.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-15T14:36:06.693

一种方法是使用 Emscripten 文件系统 API，例如在 Module preRun 函数中调用[FS.init](http://kripken.github.io/emscripten-site/docs/api_reference/Filesystem-API.html#FS.init)，将自定义函数作为标准输入传递。

```
var Module = {
  preRun: function() {
    function stdin() {
      // Return ASCII code of character, or null if no input
    }

    var stdout = null; // Keep as default
    var stderr = null;  // Keep as default
    FS.init(stdin, stdout, stderr);
  }
}; 
```

该功能非常低级：一次必须处理一个字符。要从 blob 中读取一些数据，您可以执行以下操作：

```
var data = new Int8Array([1,2,3,4,5]);
var blob = new Blob([array], {type: 'application/octet-binary'});
var reader = new FileReader();
var result;
reader.addEventListener("loadend", function() {
  result = new Int8Array(reader.result);
});
var i = 0;
var Module = {
  preRun: function() {
    function stdin() {
      if (if < result.byteLength {
        var code = result[i];
        ++i;
        return code;
      } else {
        return null;
      }
    }

    var stdout = null; // Keep as default
    var stderr = null; // Keep as default
    FS.init(stdin, stdout, stderr);
  }
}; 
```

注意（正如您所暗示的），由于阅读器的异步特性，可能存在竞争条件：阅读器必须已加载，然后您才能在标准输入中预期数据。在实际情况下，您可能需要实现一些机制来避免这种情况。`main()`根据您的确切要求，您可以这样做，以便 Emscripten 程序在您拥有数据之前不会实际调用：

```
var fileRead = false;
var initialised = false;
var result;

var array =  new Int8Array([1,2,3,4,5]);
var blob = new Blob([array], {type: 'application/octet-binary'});
var reader = new FileReader();
reader.addEventListener("loadend", function() {
   result = new Int8Array(reader.result);
   fileRead = true;
   runIfCan();
});
reader.readAsArrayBuffer(blob);

var i = 0;
var Module = {
   preRun: function() {
      function stdin() {
         if (i < result.byteLength)
         {
            var code = result[i];
            ++i;
            return code;
         } else{
            return null;
         }
      }

      var stdout = null;
      var stderr = null;
      FS.init(stdin, stdout, stderr);
      initialised = true;
      runIfCan();
   },
   noInitialRun: true
};

function runIfCan() {
   if (fileRead && initialised) {
      // Module.run() doesn't seem to work here
      Module.callMain();
   }
} 
```

注意：这是我在[为 emscripten HTML 程序提供标准输入的答案的一个版本？](https://stackoverflow.com/questions/32912129/providing-stdin-to-an-emscripten-html-program/33119868#33119868)，但重点关注标准输入，并添加有关从 Blob 传递数据的部分。*

# javascript - 如何让 Backbone.ajax 成功返回数据

> ID：15980586
> 
> 赞同：5
> 
> 时间：2013-04-12T20:48:21.303
> 
> 标签：javascript, json, backbone.js

我试图让 Backbone.ajax 返回集合“集合”。我在程序的另一部分需要模型。

我想让数据在与 ajax 方法相同的级别上可用。

```
Backbone.ajax({
    dataType: "jsonp",
    url: "https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=twitterapi&count=25",
    data: "",
    success: function(val){ val
        var Model = Backbone.Model.extend({});
        var Collection = Backbone.Collection.extend({
            model:Model
        });
        collection = new Collection(val);
        console.log(collection);
    }
}); 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-13T04:03:33.233

不！您的连接的存在几乎不应该取决于任何“ajax”调用！您需要将集合的定义和实例移到 ajax 成功方法之外和 ajax 调用之前的某个位置，然后只是`reset`或`add`成功方法中的集合或类似的东西。您需要它外部，以便您可以在实际需要数据之前定义所有视图绑定等；否则你最终会遇到一个大麻烦——你试图通过使用 Backbone来*避免这种情况。*

```
//definitions
var MyModel = Backbone.Model.extend({});
var MyCollection = Backbone.Collection.extend({
    model:Model
});

//wherever you need a collection instance
collection = new MyCollection();

//wherever you need to do the ajax
Backbone.ajax({
    dataType: "jsonp",
    url: "https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=twitterapi&count=25",
    data: "",
    success: function(val){
        collection.add(val);  //or reset
        console.log(collection);
    }
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T20:57:57.153

您可以对函数应用回调，如下所示：

```
function ajaxCall(callback) {
  Backbone.ajax({
    dataType: "jsonp",
    url: "https://api.twitter.com/1/statuses/user_timeline.json?include_entities=true&include_rts=true&screen_name=twitterapi&count=25",
    data: "",
    success: function (val) {
      var Model = Backbone.Model.extend({});
      var Collection = Backbone.Collection.extend({
        model: Model
      });
      collection = new Collection(val);
      callback(collection);
    }
  });
}

ajaxcall(function (collection) {
  //do something with the collection when the callback is returned
}); 
```

当函数执行时，它将等待回调执行函数内部的任何内容。因此，我建议您为 AJAX 调用失败的情况添加回调。

# c - 为什么位域的类型会影响包含结构的大小？

> ID：15980589
> 
> 赞同：7
> 
> 时间：2013-04-12T20:48:34.067
> 
> 标签：c, gcc, struct

首先，这是 ISO C 标准对位字段的说明，引用了 2011 ISO C 标准的[N1570](http://www.open-std.org/jtc1/sc22/wg14/www/docs/n1570.pdf)草案，第 6.7.2.1 节：

> 位域的类型应为 、 、 或其他一些实现定义的类型的合格或非`_Bool`合格`signed int`版本`unsigned int`。是否允许原子类型是实现定义的。

...

> 位域被解释为具有由指定位数组成的有符号或无符号整数类型。如果值 0 或 1 存储到类型为 的非零宽度位域中`_Bool`，则位域的值应与存储的值进行比较；`_Bool` 位域具有 a 的语义`_Bool`。
> 
> 实现可以分配任何大到足以容纳位域的可寻址存储单元。如果有足够的空间剩余，紧跟在结构中另一个位域之后的位域将被打包到同一单元的相邻位中。如果剩余空间不足，则将不适合的位域放入下一个单元还是与相邻单元重叠是实现定义的。单元内位域的分配顺序（高位到低位或低位到高位）是实现定义的。未指定可寻址存储单元的对齐方式。

对于任何`struct`类型，该类型的对齐至少是该类型任何成员的最大对齐，任何类型的大小是其对齐的倍数。例如，如果一个结构包含一个（非位域）`int`成员，并且`int`需要 4 字节对齐，那么结构本身需要 4 字节或更多对齐。

`_Bool`许多编译器允许除和类型之外的整数类型的位字段`int`。

对于至少一些编译器，`struct`包含位字段的对齐至少是位字段*的声明类型*的对齐。例如，对于 x86_64 上的 gcc 4.7.2，给出：

```
struct sb {
    _Bool bf:1;
};
struct si {
    unsigned bf:1;
}; 
```

gcc 给出`struct sb`1 字节的大小和对齐方式（即 的大小和对齐方式`_Bool`），以及`struct si`4 字节的大小和对齐方式（即 的大小和对齐方式`int`）。它对实现定义类型的位字段做同样的事情；定义为的位字段`long long bf:1;`强制封闭结构的 8 字节大小和对齐方式。即使在这两种情况下，位字段`bf`都是宽度仅为 1 位的对象，也会这样做。

我在 SPARC/Solaris 9 上使用 Sun 的编译器看到了类似的行为。

实验表明，定义为 as`_Bool`或 as的多个位域`unsigned`可以打包到单个字节内的相邻位中（实际上这是必需的），因此位域本身没有严格的对齐要求。

我知道结构成员的布局主要是实现定义的，我不认为 gcc 的行为违反了 C 标准。

所以我的问题（*终于！*）是，为什么 gcc（连同至少一个不相关的 C 编译器，可能还有更多）这样做？gcc 的作者是否假设位字段的声明类型必须影响包含结构的大小和对齐方式？他们在这个假设中正确吗？我错过了 C 标准本身的要求吗？

这是一个展示该行为的测试程序。如果你想在你的系统上运行它，你可能需要注释掉它的一部分，如果你使用的是不支持某些新功能的旧编译器，或者不允许某些类型的位字段。我很想知道是否有编译器的行为*不像*gcc。

```
#include <stdio.h>
#include <limits.h>
#include <stdint.h>
int main(void) {
    struct sb  { _Bool    bf:1; };
    struct s8  { uint8_t  bf:1; };
    struct s16 { uint16_t bf:1; };
    struct s32 { uint32_t bf:1; };
    struct s64 { uint64_t bf:1; };
    printf("sizeof (struct sb)  = %2zu (%2zu bits)\n",
           sizeof (struct sb),
           sizeof (struct sb)  * CHAR_BIT);
    printf("sizeof (struct s8)  = %2zu (%2zu bits)\n",
           sizeof (struct s8),
           sizeof (struct s8)  * CHAR_BIT);
    printf("sizeof (struct s16) = %2zu (%2zu bits)\n",
           sizeof (struct s16),
           sizeof (struct s16) * CHAR_BIT);
    printf("sizeof (struct s32) = %2zu (%2zu bits)\n",
           sizeof (struct s32),
           sizeof (struct s32) * CHAR_BIT);
    printf("sizeof (struct s64) = %2zu (%2zu bits)\n",
           sizeof (struct s64),
           sizeof (struct s64) * CHAR_BIT);
    return 0;
} 
```

这是我在系统上得到的输出：

```
sizeof (struct sb)  =  1 ( 8 bits)
sizeof (struct s8)  =  1 ( 8 bits)
sizeof (struct s16) =  2 (16 bits)
sizeof (struct s32) =  4 (32 bits)
sizeof (struct s64) =  8 (64 bits) 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T21:47:36.187

在某种程度上，你已经用标准中的这个引文自己回答了这个问题：

> 未指定可寻址存储单元的对齐方式。

编译器可以选择任何对齐方式并遵守 C 标准，但这还不是全部。

为了使使用不同编译器编译的代码能够互操作，平台 ABI 必须指定这些详细信息。例如 Linux x86 使用的 SYS-V i386 ABI 说：

> 位域遵循与其他结构和联合成员相同的大小和对齐规则，并添加以下内容：[...]
> 
> *   位域必须完全驻留在适合其声明类型的存储单元中。

然后，无论宽度如何，`long`位域都必须位于与 4 字节边界对齐的内容中。

# javascript - 从命令行评估 JavaScript 文件的运行时/加载错误

> ID：15980590
> 
> 赞同：0
> 
> 时间：2013-04-12T20:48:36.990
> 
> 标签：javascript, command-line

我们使用 requirejs 将我们的 web 应用程序编译成一个单一的 uglified js 文件。

有时包含缺少定义，因此代码在启动期间以错误的顺序执行，应用程序抛出异常并停止。

我正在寻找一种工具，以便我可以在我们的 CI 环境中对此进行基本测试。

PhantomJS 看起来像是一个可能的赢家，但我还没有让一些东西起作用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T13:23:00.957

哦，是的，PhantomJS 就是答案，只是方法不对 :) 享受吧。

```
var fs = require( 'fs' );
var system = require( 'system' );
if( system.args.length === 2 ) {
    console.log( 'Missing script arguments...' );
    phantom.exit( 10 );
}

var server = require( 'webserver' ).create();
var service = server.listen( 8080, function( request, response ) {
    response.statusCode = 200;

    if( request.url == "/script" ) {
        response.setHeader( 'Content-Type', 'text/javascript' );
        try {
            response.write( fs.read( system.args[1] ) );
        } catch( e ) {
            console.log( e );
            phantom.exit(2);
        }
    } else {
        response.write( '<html><script type="text/javascript" src="/script"></script><body>Tjoff!</body></html>' );
    }

    response.close();
});

var page = require( 'webpage' ).create();
page.onError = function( msg, trace ) {
    console.log( 'ERROR: ' + msg );
    phantom.exit(1);
};
page.open( 'http://localhost:8080', function( status ) {
    setTimeout( function() {
        phantom.exit();
    }, 2500 );
}); 
```

# php - 语法错误，意外的 'mysql_connect' (T_STRING)

> ID：15980597
> 
> 赞同：0
> 
> 时间：2013-04-12T20:48:54.323
> 
> 标签：php, html, mysql

我需要帮助解决我使用 MySQL 的页面上的错误。

当我尝试访问该网站时，会弹出以下文本：
`Parse error: syntax error, unexpected 'mysql_connect' (T_STRING) in C:\xampp\htdocs\mywebsite\inc\scripts\mysql_connect.inc.php on line 11`

```
<?php
$conn_error = 'Colud not connect.';

$mysql_host = "localhost:8080";
$mysql_user = "liam";
$mysql_pass = "";

$mysql_db = 'socialnetwork'

mysql_connect($mysql_host, $mysql_user, $mysql_pass or die("Couldn't Connect") ;
mysql_select_db('mysql_db') or die($conn_error);

echo 'Connected!'
?> 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T20:49:26.087

```
$mysql_db = 'socialnetwork'
mysql_connect($mysql_host, $mysql_user, $mysql_pass or die("Couldn't Connect") ;
echo 'Connected!' 
```

应该

```
$mysql_db = 'socialnetwork';
                           ^
mysql_connect($mysql_host, $mysql_user, $mysql_pass) or die("Couldn't Connect") ;
                                                   ^
echo 'Connected!';
                 ^ 
```

[请不要`mysql_*`在新代码中使用函数](https://stackoverflow.com/questions/12859942)。它们不再被维护[并被正式弃用](https://wiki.php.net/rfc/mysql_deprecation)。看到[红框](http://uk.php.net/manual/en/function.mysql-connect.php)了吗？改为了解[*准备好的语句*](https://en.wikipedia.org/wiki/Prepared_statement)，并使用[PDO](http://php.net/pdo)或[MySQLi](http://php.net/mysqli) -[本文](http://php.net/manual/en/mysqlinfo.api.choosing.php)将帮助您决定使用哪个。如果您选择 PDO，[这里有一个很好的教程](http://wiki.hashphp.org/PDO_Tutorial_for_MySQL_Developers)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:54:23.150

这里工作代码

```
<?php
$conn_error = 'Colud not connect.';

$mysql_host = "localhost:8080";
$mysql_user = "liam";
$mysql_pass = "";

$mysql_db = 'socialnetwork' ;
mysql_connect($mysql_host, $mysql_user, $mysql_pass) or die("Couldn't Connect") ;
mysql_select_db('mysql_db') or die($conn_error);

echo 'Connected!' ;

?> 
```

你有 3 个错误。

1-你忘了`;`这里`$mysql_db = 'socialnetwork'`。

2-你忘了`)`这里`mysql_connect($mysql_host, $mysql_user, $mysql_pass`。

3-你忘了`;`这里`echo 'Connected!'`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:50:35.903

你的忘记

> ;

这里

```
$mysql_db = 'socialnetwork' 
```

# c++ - 埃拉托色尼筛法实施

> ID：15980599
> 
> 赞同：0
> 
> 时间：2013-04-12T20:49:05.600
> 
> 标签：c++, sieve-of-eratosthenes

我正在尝试为埃拉托色尼筛法实现算法，但我不知道为什么该程序会因较大的程序而崩溃。最初我正在使用`vector`，但现在我正在使用动态内存分配来实现它。

```
#include<iostream>
#include<cmath>
#include<cstdlib>
using namespace std;

unsigned isqrt(unsigned value) {
  return static_cast<unsigned>(sqrt(static_cast<float>(value)));
}

int main()
{
    int t;
    cin >> t;
    long long * N;
    long long * M;
    long long n, m;
    N = new long long[t];
    M = new long long[t];
    for(int i = 0; i < t ; i++){
        cin >> M[i] >> N[i];
    }

    for(int i = 0; i < t ; i++){
        n = N[i];
        m = M[i];

        bool * A;
        A = new bool[n];
        if(A == 0)
        {
            cout << "Memory cannot be allocated";
            return 0;
        }

        for(int i=0;i < n;i++){
            A[i]=true;
        }
        A[0] = false;
        A[1] = false;

        unsigned sqrt = isqrt(n);
        for(int i = 2; i <= sqrt; i++)
        {
            if(A[i] == true){
                for(int j = i*i; j <= n; j = j + i)
                {
                    A[j] = false;
                }
            }
        }

        for(int i = m;i < n;i++)
        {
            if(A[i] == true )
                cout << i << "\n";
        }

        delete[] A;
    }

    delete[] M;
    delete[] N;
    return 0;
} 
```

`n`程序因和`m`(~10^16)的较大值而崩溃。请帮帮我。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T20:51:57.553

```
for(int j = i*i; j <= n; j = j + i)
                   ^^ 
```

如果`j == n`then`A[j] = false`将分配给数组末尾之后的元素。测试应该是`j < n`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:44:14.983

如果您打算用 C++ 编写 Eratosthenes 筛选器，那么如果您实际*使用*C++ 怎么样，而不是试图将其视为 C 和汇编语言之间的某种疯狂的交叉。

```
#include <vector>
#include <iostream>

unsigned long primes = 0;

int main() {
    int number = 10000000;
    std::vector<bool> sieve(number,false);
    sieve[0] = sieve[1] = true;

    for(int i = 2; i<number; i++) {
        if(!sieve[i]) {
            ++primes;
            for (int temp = 2*i; temp<number; temp += i)
                sieve[temp] = true;
        }
    }
    std::cout << "found: " << primes << " Primes\n";
    return 0;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T21:06:19.003

如果 n 大到足以导致内存分配错误，程序将由于此处不正确的内存分配错误处理而崩溃

```
 A = new bool[n];
        if(A == 0)
        {
            cout << "Memory cannot be allocated";
            return 0;
        } 
```

new 不会在错误时返回 0，但会抛出没有被捕获的 std::bad_alloc，这反过来会导致意外（）然后终止（），最后中止（）被调用。
正确的版本是：

```
 try
  {
    A = new bool[n];
  }
  catch (std::bad_alloc& ba)
  {
    std::cerr << "Memory cannot be allocated: " << ba.what() << '\n';
  } 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-12T20:57:11.930

在调试器中运行它以确定崩溃的位置并从那里进行调试。那时很可能会很明显。

您可以从 IDE 或命令行执行此操作。在后一种情况下`-g`，使用诸如`gdb`. 谷歌诸如“gdb cheatsheet”之类的东西来开始。

# opencv - 生成 traincascade.exe

> ID：15980607
> 
> 赞同：1
> 
> 时间：2013-04-12T20:49:37.213
> 
> 标签：opencv

奇怪的是，其他应用程序文件夹中的 haartraining 通过采用完全相同的方式工作得很好。我在想在定义必要文件的路径时有一个错误，但一切看起来都很好。

这是我的设置（假设 OpenCV 2.4.5 和 Visual Studio）：

1.  在环境变量中设置 DLL 路径：
    *   设置`OPENCV245_DIR`为`C:\opencv\opencv245\build\x86\vc10\bin`
    *   添加`%OPENCV245_DIR%`到`PATH`
2.  配置包含目录：
    *   `C:\opencv\opencv245\build\include`
    *   `C:\opencv\opencv245\build\include\opencv`
    *   `C:\opencv\opencv245\apps\traincascade`
3.  配置库目录：
    *   `C:\opencv\opencv245\build\x86\vc10\lib`
4.  配置`.lib`依赖：
    *   `opencv_core245d.lib`
    *   `opencv_ml245d.lib`
    *   `opencv_imgproc245d.lib`
    *   `opencv_objdetect245d.lib`
    *   `opencv_highgui245d.lib`
    *   `opencv_calib3d245d.lib`
    *   `opencv_video245d.lib`
    *   `opencv_features2d245d.lib`
    *   `opencv_flann245d.lib`
    *   `opencv_legacy245d.lib`
    *   `opencv_haartraining_engined.lib`
    *   `opencv_contrib245d.lib`
    *   `opencv_gpu245d.lib`
    *   `opencv_nonfree245d.lib`
    *   `opencv_photo245d.lib`
    *   `opencv_stitching245d.lib`
    *   `opencv_ts245d.lib`
    *   `opencv_videostab245d.lib`

我为调试和发布模式制作了一个属性表。`Debug|Win32`我将工作表作为“属性表”窗格中（或）文件夹下的第一项放在顶部`Release|Win32`，因为我读到工作表的顺序决定了它们的优先级。此外，`Release`属性表省略了文件名`d`末尾的。`.lib`

如果我尝试编译代码，我会得到以下输出：

```
1>------ Build started: Project: traincascade245, Configuration: Debug Win32 ------
1>Build started 4/12/2013 3:11:03 PM.
1>InitializeBuildStatus:
1>  Touching "Debug\traincascade245.unsuccessfulbuild".
1>ClCompile:
1>  All outputs are up-to-date.
1>ManifestResourceCompile:
1>  All outputs are up-to-date.
1>Link:
1>  
1>  Searching libraries
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_core245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_ml245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_imgproc245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_objdetect245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_highgui245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_calib3d245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_video245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_features2d245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_flann245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_legacy245d.lib:
1>      Searching             C:\opencv\opencv245\build\x86\vc10\lib\opencv_haartraining_engined.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_contrib245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_gpu245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_nonfree245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_photo245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_stitching245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_ts245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_videostab245d.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\kernel32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\user32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\gdi32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\winspool.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\comdlg32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\advapi32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\shell32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\ole32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\oleaut32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\uuid.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\odbc32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\odbccp32.lib:
1>      Searching C:\Program Files (x86)\Microsoft Visual Studio     10.0\VC\lib\msvcprtd.lib:
1>      Searching C:\Program Files (x86)\Microsoft Visual Studio     10.0\VC\lib\MSVCRTD.lib:
1>      Searching C:\Program Files (x86)\Microsoft Visual Studio     10.0\VC\lib\OLDNAMES.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_core245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_ml245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_imgproc245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_objdetect245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_highgui245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_calib3d245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_video245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_features2d245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_flann245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_legacy245d.lib:
1>      Searching     C:\opencv\opencv245\build\x86\vc10\lib\opencv_haartraining_engined.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_contrib245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_gpu245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_nonfree245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_photo245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_stitching245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_ts245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_videostab245d.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\kernel32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\user32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\gdi32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\winspool.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\comdlg32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\advapi32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\shell32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\ole32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\oleaut32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\uuid.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\odbc32.lib:
1>      Searching C:\Program Files (x86)\Microsoft SDKs\Windows\v7.0A\lib\odbccp32.lib:
1>      Searching C:\Program Files (x86)\Microsoft Visual Studio     10.0\VC\lib\msvcprtd.lib:
1>      Searching C:\Program Files (x86)\Microsoft Visual Studio     10.0\VC\lib\MSVCRTD.lib:
1>      Searching C:\Program Files (x86)\Microsoft Visual Studio     10.0\VC\lib\OLDNAMES.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_core245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_ml245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_imgproc245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_objdetect245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_highgui245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_calib3d245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_video245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_features2d245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_flann245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_legacy245d.lib:
1>      Searching     C:\opencv\opencv245\build\x86\vc10\lib\opencv_haartraining_engined.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_contrib245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_gpu245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_nonfree245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_photo245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_stitching245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_ts245d.lib:
1>      Searching C:\opencv\opencv245\build\x86\vc10\lib\opencv_videostab245d.lib:
1>  
1>  Finished searching libraries
1>traincascade.obj : error LNK2019: unresolved external symbol "public: bool __thiscall         CvCascadeClassifier::train(class std::basic_string<char,struct std::char_traits<char>,class     std::allocator<char> >,class std::basic_string<char,struct std::char_traits<char>,class     std::allocator<char> >,class std::basic_string<char,struct std::char_traits<char>,class     std::allocator<char> >,int,int,int,int,int,class CvCascadeParams const &,class     CvFeatureParams const &,struct CvCascadeBoostParams const &,bool)" (?    train@CvCascadeClassifier@@QAE_NV?$basic_string@DU?$char_traits@D@std@@V?    $allocator@D@2@@std@@00HHHHHABVCvCascadeParams@@ABVCvFeatureParams@@ABUCvCascadeBoostParams    @@_N@Z) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: virtual bool     __thiscall CvCascadeBoostParams::scanAttr(class std::basic_string<char,struct     std::char_traits<char>,class std::allocator<char> >,class std::basic_string<char,struct     std::char_traits<char>,class std::allocator<char> >)" (?    scanAttr@CvCascadeBoostParams@@UAE_NV?$basic_string@DU?$char_traits@D@std@@V?    $allocator@D@2@@std@@0@Z) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: virtual bool     __thiscall CvCascadeParams::scanAttr(class std::basic_string<char,struct     std::char_traits<char>,class std::allocator<char> >,class std::basic_string<char,struct     std::char_traits<char>,class std::allocator<char> >)" (?scanAttr@CvCascadeParams@@UAE_NV?    $basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@0@Z) referenced in function     _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: virtual void     __thiscall CvCascadeBoostParams::printDefaults(void)const " (?    printDefaults@CvCascadeBoostParams@@UBEXXZ) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: virtual void     __thiscall CvCascadeParams::printDefaults(void)const " (?    printDefaults@CvCascadeParams@@UBEXXZ) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall     CvHOGFeatureParams::CvHOGFeatureParams(void)" (??0CvHOGFeatureParams@@QAE@XZ) referenced in     function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall     CvLBPFeatureParams::CvLBPFeatureParams(void)" (??0CvLBPFeatureParams@@QAE@XZ) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall CvHaarFeatureParams::CvHaarFeatureParams(void)" (??0CvHaarFeatureParams@@QAE@XZ) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall CvCascadeBoostParams::CvCascadeBoostParams(void)" (??0CvCascadeBoostParams@@QAE@XZ) referenced in function _main
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall CvCascadeParams::CvCascadeParams(void)" (??0CvCascadeParams@@QAE@XZ) referenced in function _main
1>traincascade.obj : error LNK2001: unresolved external symbol "public: virtual void __thiscall CvCascadeBoostParams::printAttrs(void)const " (?printAttrs@CvCascadeBoostParams@@UBEXXZ)
1>traincascade.obj : error LNK2001: unresolved external symbol "public: virtual void __thiscall CvParams::printDefaults(void)const " (?printDefaults@CvParams@@UBEXXZ)
1>traincascade.obj : error LNK2001: unresolved external symbol "public: virtual void __thiscall CvParams::printAttrs(void)const " (?printAttrs@CvParams@@UBEXXZ)
1>traincascade.obj : error LNK2001: unresolved external symbol "public: virtual bool __thiscall CvParams::scanAttr(class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >,class std::basic_string<char,struct std::char_traits<char>,class std::allocator<char> >)" (?scanAttr@CvParams@@UAE_NV?$basic_string@DU?$char_traits@D@std@@V?$allocator@D@2@@std@@0@Z)
1>traincascade.obj : error LNK2019: unresolved external symbol "public: virtual __thiscall CvCascadeImageReader::PosReader::~PosReader(void)" (??1PosReader@CvCascadeImageReader@@UAE@XZ) referenced in function __unwindfunclet$??0CvCascadeImageReader@@QAE@XZ$0
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall CvCascadeImageReader::NegReader::NegReader(void)" (??0NegReader@CvCascadeImageReader@@QAE@XZ) referenced in function "public: __thiscall CvCascadeImageReader::CvCascadeImageReader(void)" (??0CvCascadeImageReader@@QAE@XZ)
1>traincascade.obj : error LNK2019: unresolved external symbol "public: __thiscall CvCascadeImageReader::PosReader::PosReader(void)" (??0PosReader@CvCascadeImageReader@@QAE@XZ) referenced in function "public: __thiscall CvCascadeImageReader::CvCascadeImageReader(void)" (??0CvCascadeImageReader@@QAE@XZ)
1>C:\Users\knobukaw\Documents\Visual Studio 2010\Projects\traincascade245\Debug\traincascade245.exe : fatal error LNK1120: 17     unresolved externals
1>
1>Build FAILED.
1>
1>Time Elapsed 00:00:02.52
========== Build: 0 succeeded, 1 failed, 0 up-to-date, 0 skipped ========== 
```

# servicestack - OrmLite：使用属性时执行存储过程并将结果映射到模型上不起作用

> ID：15980611
> 
> 赞同：1
> 
> 时间：2013-04-12T20:49:56.560
> 
> 标签：servicestack, ormlite-servicestack

ORMLite 将存储过程调用的结果投影到模型上的实际要求是什么。我有一个具有某些属性的类，它不会正确映射 sp 的输出。如果我删除属性，那么它会正确映射它。例如：

```
public class Test
{
   [Alias("InsuredId")]
   public string Id { get; set; }
   public string LastName { get; set; }
   public string FirstName { get; set; }
   public string MiddleInitial { get; set; }
} 
```

SP 返回以下列：InsuredId、LastName、FirstName、MiddleInitial 等。如果我有 Alias 属性，则所有属性都填充为 null。如果我删除属性，那么除了 ID 之外一切都很好。以下是实际代码。

```
var  test =
        db.SqlList<Test>(
            "EXEC up_InsuredSearchTest @ItemId, @FirstName, @LastName, @DateOfBirth, @Max_Search_Records",
            new
                {
                    ItemId = memberId,
                    FirstName = firstName,
                    LastName = lastName,
                    DateOfBirth = dateOfBirth.HasValue? dateOfBirth.Value.ToShortDateString() : "",
                    Max_Search_Records = MAX_SEARCH_RECORDS
            }); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-16T15:04:45.173

ServiceStack 并不是真正的问题。返回的值是一个 int 但被映射为字符串，它在 ServiceStack 中默默地失败，但记录了错误。错误信息不是很丰富，所以我不得不通过 ORMLite 源进行调试以找出问题所在。

# mod-rewrite - 将具有一个查询字符串的 URL 重写为具有不同查询字符串的另一个 URL

> ID：15980615
> 
> 赞同：0
> 
> 时间：2013-04-12T20:50:14.170
> 
> 标签：mod-rewrite, apache2.2

我正在尝试完成一些重定向，如下所示：

```
#Basic Rule Set
RewriteRule ^/path$ http://newhost.com/Page?pagename=form1000 [R=301]
RewriteRule ^/path/index.html$ http://newhost.com/Page?pagename=form1000 [R=301] 
```

哪个工作正常。

但是，在源和目标中使用查询字符串进行重定向会将我返回到上述目标 url。例如，

```
# Advanced  Rule Set
RewriteRule ^/path/index.html?var=foo$ http://newhost.com/Page?pagename=form1000?id=hello  [R=301]
RewriteRule ^/path/index.html?var=bar$ http://newhost.com/Page?pagename=form1000?id=byebye [R=301]
RewriteRule ^/path/index.html?var=xyz$ http://newhost.com/Page?pagename=form1000?id=world  [R=301] 
```

全部重定向到`http://newhost.com/Page?pagename=form1000`. 我已经在上述三个规则之前尝试了 a `RewriteCond %{QUERY_STRING} ^var=(.*)$ [NC]`and `RewriteCond %{REQUEST_URI} ^/path/index.html [NC]`，但我仍然被重定向到`http://newhost.com/Page?pagename=form1000`. 我交换了 Basic 和 Advanced 规则集的顺序，并全部重定向到`http://newhost.com/Page?pagename=form1000`.

关于如何让这些规则集发挥作用的任何想法？CentOS 6.x，阿帕奇 2.2。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:24:31.403

你可以试试这个：

```
# Advanced  Rule Set
RewriteCond %{QUERY_STRING} var=foo [NC]
RewriteRule ^path/index.html/? http://newhost.com/Page?pagename=form1000?id=hello  [R=301,L,NC]

RewriteCond %{QUERY_STRING} var=bar [NC]
RewriteRule ^path/index.html/? http://newhost.com/Page?pagename=form1000?id=byebye [R=301,L,NC]

RewriteCond %{QUERY_STRING} var=xyz [NC]
RewriteRule ^path/index.html/? http://newhost.com/Page?pagename=form1000?id=world  [R=301,L,NC] 
```

# javascript - 在 JavaScript 中分配变量时使用命名函数的目的是什么？

> ID：15980616
> 
> 赞同：6
> 
> 时间：2013-04-12T20:50:14.740
> 
> 标签：javascript

[我最近在https://github.com/yeoman/generator-webapp](https://github.com/yeoman/generator-webapp)的源代码中遇到了这种模式：

```
AppGenerator.prototype.packageJSON = function packageJSON() {
  this.template('_package.json', 'package.json');
}; 
```

无论如何，当您要将函数分配给变量或对象属性时，将其命名为“packageJSON”的目的是什么？在类似的情况下，我总是使用匿名函数。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T20:51:57.410

用于调试目的。如果您使用命名函数，您可以在您最喜欢的开发工具的调用堆栈跟踪中看到该名称。否则你会看到`anonymous function`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:08:04.820

正如其他人所说，主要用于调试目的。但不仅如此。例如，您可以依赖这样一个事实，即在函数体中，您可以使用您设置的名称访问函数本身。举一个愚蠢的例子：

```
var sum = function (a, b) {
    if (a < 3)
        return sum(3 + a, b);

    return a + b;
}

sum(1, 2) // 3; 
```

但是让我们看看现在会发生什么：

```
var aSum = sum;
sum = null;

aSum(1, 3); // TypeError: sum is not a function 
```

命名函数，将涵盖该用例：

```
var sum = function sum(a, b) {
    if (a < 3)
        return sum(3 + a, b);

    return a + b;
}

sum(1, 2) // 6

var aSum = sum;
sum = null;

aSum(1, 2) // 6 
```

这是因为在函数体中，函数的名称总是引用它，而不是像第一个示例那样取自另一个范围。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T20:55:46.163

这称为[命名函数表达式](http://kangax.github.io/nfe/)（或 NFE），它使调试过程更加容易。

> 要记住的一个重要细节是该名称仅在新定义的函数范围内可用；规范要求标识符不应该对封闭范围可用：

```
var f = function foo(){
  return typeof foo; // "foo" is available in this inner scope
};
// `foo` is never visible "outside"
typeof foo; // "undefined"
f(); // "function" 
```

# ruby-on-rails - 复杂的 ActiveRecord 查询

> ID：15980623
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:51:02.393
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord, ruby-on-rails-3.2

我很难理解如何构建这个查询。我不确定是否应该尝试创建一堆范围并尝试链接它们。还是我将其放入类方法中？还是我会两者兼而有之？如果有人能给我一个简短的例子，它会让我不会跳出窗外，我已经为此工作了一个多星期。

```
class CensusDetail < ActiveRecord::Base  
  belongs_to  :apartment  
  belongs_to  :resident  
end  

class Apartment < ActiveRecord::Base  
  belongs_to :apartment_type  
  has_many  :census_details  
  has_many  :residents, :through => :census_details  
end  

class ApartmentType < ActiveRecord::Base  
  has_many :apartments  
end  

class Resident < ActiveRecord::Base  
  has_many :census_details  
  has_many :apartments, :through => :census_details  
end  

apartment.rent_ready       = boolean value if apartment is ready  
apartment_type.occupany    = the number of allowed occupants in an apartment  
census_detail.status       = either "past", "present", or "new"  
census_detail.moveout_date = date time resident is scheduled to move out 
```

我需要构建一个执行以下操作的查询：

```
- if the apartment is rent ready then do the following:  
- pull a list from census_details of all residents set as "current" for each apartment  
  -if the # of residents is less than the value of apartment_type.occupancy for this  
    apartment, then list it as available  
  -if the # of residents is = to the value of apartment_type.occupancy then  
    -does any resident have a scheduled move out date  
      -if not, do not list the apartment  
      -if yes, then list apartment 
```

提前感谢您的任何帮助或建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T17:28:23.667

我还没有清理它，但这对我有用，所以我想分享。

公寓类型.rb

```
class ApartmentType < ActiveRecord::Base
  has_many  :apartments, :dependent => :nullify
end 
```

census_detail.rb

```
class CensusDetail < ActiveRecord::Base
  belongs_to  :resident_contacts
  belongs_to  :apartments
  scope :get_current_residents,  ->(id) { where("status = ? and apartment_id = ?", "current", id) }
end 
```

大部分工作都在其中进行的公寓.rb

```
class Apartment < ActiveRecord::Base  
  belongs_to :apartment_type  
  has_many  :census_details  
  has_many  :residents, :through => :census_details  
  scope :rent_ready,      ->  { where(:enabled => true) }

  def self.available
    available_apartments = []
    rent_ready_apartments = self.rent_ready.all

    rent_ready_apartments.each do |apt|
      tmp = ApartmentType.where('id = ?', apt.apartment_type_id).pluck(:occupancy)
      occupancy = tmp[0]
      current_residents = CensusDetail.get_current_residents(apt.id)
      resident_count = current_residents.count

      if resident_count < occupancy
        available_apartments << apt
      end

      if resident_count = occupancy
        scheduled = false
        current_residents.each do |res|
          if res.moveout_date
            scheduled = true
          end
        end
        if scheduled == true
          available_apartments << apt
        end
      end
    end
    available_apartments
  end
end 
```

代码有点难看，但到目前为止它通过了我的测试。我会编辑我原来的问题而不是回答，以防有人有更好的方法来做这件事，但每次我做我的问题都会被否决。如果有人知道更好的方法，请告诉我，因为我在应用程序中的某个点上大约有 50 个表，现在所有这些都与复杂的查询联系在一起。

# android - Android NDK Build 对于简单的本机功能失败

> ID：15980626
> 
> 赞同：0
> 
> 时间：2013-04-12T20:51:18.270
> 
> 标签：android, c++, android-ndk, makefile, build-error

我正在尝试使用 ndk-build 构建一个非常简单的本机函数并收到以下错误。

```
DriverAdapter.cpp:6:69: error: expected ',' or '...' before 'this' 
```

以下是我的 .mk 和 .cpp 文件

驱动适配器.cpp

```
#include <jni.h>
#include <string.h>
#include <android/log.h>
#define DEBUG_TAG "NDK_AndroidNDK1SampleActivity"

void Java_com_ihearhtpi_MainActivity_helloLog(JNIEnv * env, jobject this, jstring logThis)
{
   jboolean isCopy;
    const char * szLogThis = (*env)->GetStringUTFChars(env, logThis, &isCopy);
    __android_log_print(ANDROID_LOG_DEBUG, DEBUG_TAG, "NDK:LC: [%s]", szLogThis);
    (*env)->ReleaseStringUTFChars(env, logThis, szLogThis);
} 
```

安卓.mk

LOCAL_PATH := $(调用我的目录)

```
include $(call all-subdir-makefiles)
include $(CLEAR_VARS)
LOCAL_LDLIBS := -llog
LOCAL_MODULE    :=driver
LOCAL_SRC_FILES :=DriverAdapter.cpp
include $(BUILD_SHARED_LIBRARY) 
```

不知道为什么会这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:09:06.757

你不能将你的论点命名为“this”

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:09:17.837

问题是`this`c++ 关键字。而且您不能使用关键字作为变量名。

# php - PHP - “意外的 t_variable”

> ID：15980631
> 
> 赞同：0
> 
> 时间：2013-04-12T20:51:29.127
> 
> 标签：php

我的错误是什么？

> 解析错误：语法错误，第 14 行 public_html/sign_up.php 中的意外 T_VARIABLE

对于我的一生，我无法弄清楚我做错了什么。

```
 include_once("../php/sign_up/connect_db.php");

    // Array for JSON response
    $response = array();

    // Check for required fields
    if (isset($_POST['firstname']) &&
        isset($_POST['surname'])   &&
        isset($_POST['postcode'])  &&
        isset($_POST['email'])     &&
        isset($_POST['phone'])

        $firstname = $_POST['firstname'];
        $surname   = $_POST['surname'];
        $postcode  = $_POST['postcode'];
        $email     = $_POST['email'];
        $phone     = $_POST['phone'];

        // Connecting to db
        $db = new DB_CONNECT();

        // MySQL inserting a new row
        $result = mysql_query("INSERT INTO TABLE 1(firstname, surname, postcode, phone, email) VALUES('$firstname', '$surname', '$postcode', '$phone', '$email')");

        // Check if row is inserted or not
        if ($result) {
            // Successfully inserted into database
            $response["success"] = 1;
            $response["message"] = "Thank you for registering.";

            // Echoing JSON response
            echo json_encode($response);
        } else {
            // Failed to insert row
            $response["success"] = 0;
            $response["message"] = "Oops! An error occurred.";

            // Echoing JSON response
            echo json_encode($response);
        }
    }
    else {
        // Required field is missing
        $response["success"] = 0;
        $response["message"] = "Required field(s) is missing";

        // Echoing JSON response
        echo json_encode($response);
    }
?> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:53:02.123

你忘了关闭 if 括号：

*改变*

```
if (isset($_POST['firstname']) && isset($_POST['surname']) && isset($_POST['postcode'])&& isset($_POST['email']) && isset($_POST['phone']) 
```

*至*

```
if (isset($_POST['firstname']) && isset($_POST['surname']) && isset($_POST['postcode'])&& isset($_POST['email']) && isset($_POST['phone'])) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T20:53:27.167

您缺少右括号：

```
if ( isset($_POST['firstname']) && isset($_POST['surname']) && isset($_POST['postcode'])
     && isset($_POST['email']) && isset($_POST['phone']) )
                                                         ^ here
{
^ you probably want this too as you do have the 'else' and closing brackets 
```

# ruby-on-rails-3 - Wicked Rails Gem 帮助接线

> ID：15980632
> 
> 赞同：3
> 
> 时间：2013-04-12T20:51:32.190
> 
> 标签：ruby-on-rails-3, forms, activerecord, rails-activerecord, multi-step

我想做一个多步骤的表格来获取新信息。一页我要收集姓名/联系信息，下一页我要收集病史，第三页人口统计信息。

我已经安装了 Wizard gem 并生成了一个专用控制器。我在上面看到的所有教程都适用于设计和注册过程，所以我对控制器操作和实例变量以及我应该如何编写它们有点迷茫。

想知道是否有人有除了注册之外的教程，这可能会帮助我学习如何将这一切连接起来。

任何指针或帮助表示赞赏。

编辑：

我认为我的问题出在我的向导的控制器中。

在演示和更新操作中，演示显示声明变量

```
@user = current_user 
```

这很好，但它是我不需要的辅助方法。我需要创建一个患者，将患者 ID 存储在一个会话中，我在我的主患者控制器的创建操作中执行该会话。然后以某种方式将其传递给 patientsteps 控制器。

这是我在耐心步骤中尝试过的

```
class PatientstepsController < Wicked::WizardController
  before_filter :authenticate_user!

  steps :medical, :summary

  def show
    @patient = Patient.find(params[:patient_id])
    render_wizard
  end

  def update
    @patient = Patient.find(params[:id])
    @patient.attributes = params[:patient]
    render_wizard @patient
  end
end 
```

当我这样做时，我无法找到没有 ID 的患者。我知道我做错了，但我不确定如何传入在我的患者控制器创建操作中创建的患者 ID。

患者控制器创建：

```
 def create
    @patient = Patient.new(params[:patient])

    if @patient.save
        session[:patient_id] = @patient.id
        redirect_to patientsteps_path, notice: "Patient was successfully created."
      else
        render :new
     end
  end 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-07T15:05:22.437

In your show action, instead of params[:patient_id] you should use session[:patient_id], because the id of the patient is stored in the session, not in the params hash.

Then in the update action, you will receive the patient id in params[:patient_id], not [:id], because wicked uses params[:id] to identify which step the wizard is on.

# visual-studio-2010 - 如何在 Visual Studio 2010 中安装 ReportViewer 2012

> ID：15980633
> 
> 赞同：1
> 
> 时间：2013-04-12T20:51:38.690
> 
> 标签：visual-studio-2010, reporting-services, webforms, reportviewer

我在 Visual Studio 2010 中使用 reportviewer 2010 控件，但我需要开始使用 reportviewer 2012。如何在 Visual Studio 2010 中使用新的 ASP.NET webforms [ReportViewer 2012 控件](http://www.microsoft.com/en-us/download/details.aspx?id=35747)（无需升级到 Visual Studio 2012）？最终我想升级到 Visual Studio 2012 和 dotnet 4.5，但我更愿意继续使用 dotnet 4.0 和 Visual Studio 2010 一段时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:02:07.483

我想您是在问如何通过声音为 SSRS“创建报告”，而不仅仅是显示它们。好的，这听起来很奇怪，但您需要 SQL Server 2012 Enterprise、Developer、Standard with Advanced Tools 版本。其中任何一个都足以为您提供所需的工具。如果您正在寻找“设计”报告，该工具是 Visual Studio 的一个附加组件，称为“商业智能开发工作室”，简称 BIDS。由于某种原因，它现在在 Windows 的“所有程序”下显示为“SQL Server Data Tools”。你可以感谢微软让这个版本尽可能让想要进入 SSRS 的人感到困惑。

要安装它，您只需安装所有 SQL Server，当您进入“功能”部分时，请确保选择了 BIDS。BIDS 的版本不在 VS 2012 上，而是在 VS 2010 上。由于某种原因，SQL 团队没有使 SQL Server 的部署与 Visual Studio 一致，所以它与 VS 2010 一起使用，而不是 2012。很多人得到这很困惑，但我可以说事实上 SSRS 是 BIDS 的扩展，而 BIDS 又是 Visual Studio 的扩展。不是反过来。您可以在 VS 2012 中创建本地化报告，这些报告是“rdlc”文件，但不是您部署到服务器的完整 SSRS。

# jquery - AngularJS 数据绑定和 jQuery 承诺

> ID：15980634
> 
> 赞同：1
> 
> 时间：2013-04-12T20:51:43.003
> 
> 标签：jquery, angularjs

在我的角度控制器中，我定义了以下方法

```
$scope.searchListing = function() {
    $http({
        url: App.Url.to('listing/feed/21312')
    }).success(function(data, status, headers, config) {
        $scope.data = data;
    });
} 
```

看来，$scope.data.listing 是循环的

```
<div class="item" ng-repeat="property in data.listings"><!-- stuff --></div> 
```

searchListing 是使用 ng-click 触发的，并且一切正常。但是我有一个单独的 API 来处理对我的应用程序的 API 调用，它基于 jQuery。集成我的基于 jQuery 的 API 之后

```
$scope.searchListing = function() {
    App.Listing.getListing().done(function(data){
        $scope.data = data;
    });
} 
```

API 返回 jqXHR 对象，因此我可以对它们调用 promise 方法。问题是即使数据被分配给 $scope.data 我的视图没有得到更新。ajax 请求完成后，我访问控制器以检查是否分配了数据

```
angular.element('[ng-controller=listingController]').scope().data 
```

它确实显示了数据，为什么视图没有更新？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T20:55:43.257

当 Angular 模型`$scope`（

但是，当这种数据更改发生在 Angular 视口之外的回调中时，Angular 无法监视更改。这发生在您的数据更改发生在 jQuery 承诺中的情况下，这不是 Angular 的一部分。在这种情况下，您需要像这样手动触发摘要循环：

```
App.Listing.getListing().done(function(data){
        $scope.data = data;

        // make sure your app is not currently in a digest loop
        if (!$scope.$$phase)
            $scope.$apply(); // trigger digest loop
}); 
```

# ruby-on-rails - 互相引用两个模型

> ID：15980644
> 
> 赞同：0
> 
> 时间：2013-04-12T20:52:51.633
> 
> 标签：ruby-on-rails

我正在阅读一本 ror 初学者书籍，它有这个参考示例：

```
class Article < ActiveRecord::Base
  attr_accessible :body, :excerpt, :location, :published_at, :publisher, :title

  validates :title, :presence => true
  validates :body, :presence => true

  belongs_to :user
  has_and_belongs_to_many :categories
end

class Category < ActiveRecord::Base
  attr_accessible :name

  has_and_belongs_to_many :articles
end 
```

所以这两个模型意味着通过 habtm 以两种方式连接，就像上面的代码一样。但是，这本书也告诉我我应该提供这样的迁移：

```
class CreateArticlesCategories < ActiveRecord::Migration
  def up
        create_table :articles_categories, :id => false do |t|
        t.integer :article
        t.integer :category
    end
  end

  def down
    drop_table :articles_categories
  end
end 
```

我的问题：为什么？为什么我需要创建此迁移而不是模型articles_categories？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:08:49.390

**tl;博士; 使用 a 时需要额外的模型，关联`has_many through`不需要它`habtm`**

`has_and_belongs_to_many`当您并不真正关心中间的表格（这里是articles_categories）时，应该使用该关联。我所说的“不”真正关心的是，此表中不需要额外的数据。它只是在这里告诉您哪些类别与给定文章相关，以及哪些文章与给定类别相关。为此，`has_and_belongs_to_many`关联非常重要，因为您不必创建模型，它只需要连接表。

如果不知何故您需要该表中的一些额外数据，例如标签、日期、状态或任何东西，那么拥有一个专用模型将非常方便，因此您可以显式地操作它。对于这些情况，您应该使用`has_many :through` [关联](http://guides.rubyonrails.org/association_basics.html#the-has_many-through-association)

如果您需要更多信息，我建议您阅读有关关联的 Rails 指南，这是一个好的开始。当然，如果我的解释不够清楚，请告诉我，我会添加更多细节。

# javascript - 从父页面隐藏表单，直到加载特定的 iframe 元素 ID

> ID：15980645
> 
> 赞同：0
> 
> 时间：2013-04-12T20:52:52.290
> 
> 标签：javascript, jquery, iframe

我只需要在 iframe 中加载特定元素 ID 时才显示父页面表单。父/iframe 在同一个域上。如何使用 javascript 实现这一点？

```
<form id="Search" action="../search.php" target="my-iframe" method="post">
<input type="text" id="location" name="keywords[all_words]"  />
<a href="#" onclick="document.getElementById('Search').submit()" >Search</a>
</form>

<iframe id="myiframe" src="../page.html" name="myiframe" width="100%" height="100%" scrolling="no" frameborder="0"></iframe> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:16:27.940

你可以使用这样的东西：

```
// wait for the page to finish loading
window.onload = function(){

    // hide your form
    document.getElementById('Search').style.display = 'none';

    // get the document of the iframe
    var frameDocument = document.getElementById('myiframe').contentWindow.document;
    // if this is true the element with id 'test' is in the frame
    if(frameDocument.getElementById('test')){
        // show your form
        document.getElementById('Search').style.display = 'block';
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:17:35.677

您可以使用 jQuery 将`load`事件附加到 iframe。这是一个工作示例：http: [//jsfiddle.net/kPqbS/](http://jsfiddle.net/kPqbS/)

# javascript - jQuery 添加的 svg 元素不显示

> ID：15980648
> 
> 赞同：3
> 
> 时间：2013-04-12T20:53:00.883
> 
> 标签：javascript, jquery, svg

抱歉，如果这已经得到回答，我是新来的。

我正在尝试使用 jquery 创建 svg 元素，并且我将此代码作为 HTML 页面的一部分：

```
<svg viewBox="0 0 1000 500">
    <defs>
        <clipPath id="clip">
            <ellipse cx="100" cy="250" rx="200" ry="50" />
        </clipPath>
    </defs>
    <g>
        <path d="M 0,0 L 1000,0 1000,500 0,500"
            fill="#9ADEFF" />
        <path id="boat" stroke="none" fill="red"
            d="M 100,175 L 300,175 300,325 100,325"
            clip-path="url(#clip)" />
    </g>
    <g id="0002" width="100" height="100%"
        transform="translate(1000)">
        <line x1="50" y1="0" x2="50" y2="300"
            stroke="green" stroke-width="100" />
    </g>
</svg> 
```

和这个 Javascript（使用 jQuery 1.9）：

```
var id = 10000,
    coinArray = []

function generateNextLine(type) {
    $('svg').append($(type()))
    return $('svg')[0]
}

function idNo() {
    id++
    return ((id-1)+"").substr(-4)
}

function random(x,y) {
    if (!y) {
        y=x
        x=0
    }
    x=parseInt(x)
    y=parseInt(y)
    return (Math.floor(Math.random()*(y-x+1))+x)
}

function coins() {
    coinArray[id%10000]=[]
    var gID = idNo(), x,
    g=$(document.createElement('g')).attr({
        id: gID,
        width: "100",
        height: "100%"
    })
    while (3<=random(10)) {
        var randomPos=random(50,450)
        coinArray[(id-1)%10000][x] = randomPos
        $(g).append(
            $(document.createElement('circle'))
            .attr({
                cx: "50",
                cy: randomPos,
                r: "50",
                fill: "yellow"
            })
        )
        x++
    }
    return $(g)[0]
} 
```

当我运行`generateNextLine(coins);`时，svg 添加了这个元素：

```
<g id="0000" width="100" height="100%">
    <circle cx="50" cy="90" r="50" fill="yellow"></circle>
</g> 
```

但是，svg 的实际显示不会改变。如果我将此代码直接添加到 svg，它会按我的预期呈现，但运行我的 javascript 函数似乎对显示没有任何作用。我在 OS X Lion 上使用 Chrome 28。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T21:09:44.260

您必须在 SVG 命名空间中创建 SVG 元素，这意味着您不能这样做

```
document.createElement('g') 
```

但相反，你必须写

```
document.createElementNS('http://www.w3.org/2000/svg', 'g') 
```

圆圈等也一样。

# jersey - 强制泽西灰熊服务器进行身份验证

> ID：15980658
> 
> 赞同：1
> 
> 时间：2013-04-12T20:53:39.787
> 
> 标签：jersey, grizzly

我正在对使用 Jersey 编写的 REST 服务进行验收测试。在我的服务中，我需要使用以下方法获取成功通过身份验证（BASIC）的用户的名称：

```
@Context private SecurityContext securityContext; //at class level

String username = securityContext.getUserPrincipal().getName()  //inside a resource 
```

我正在使用 Jersey 客户端 API 并针对 Grizzly 服务器运行。我将服务器设置如下：

```
public class BaseResourceTest extends JerseyTest {

   public BaseResourceTest() throws Exception {

    super(new WebAppDescriptor.Builder("net.tds.adm.na.batchcut")
        .contextPath(baseUri.getPath())
        .contextParam("contextConfigLocation","classpath:testContext.xml")
        .initParam("com.sun.jersey.api.json.POJOMappingFeature",
            "true").servletClass(SpringServlet.class)
        .contextListenerClass(ContextLoaderListener.class)
        .build());

     }

.......

} 
```

在我的测试中，我传递了一个授权标头，如下所示：

```
WebResource resource = resource().path(_url);
return resource.type(MediaType.APPLICATION_FORM_URLENCODED_TYPE).header(HttpHeaders.AUTHORIZATION, new String(Base64.encode("judge:smails"))).post(ClientResponse.class, _formData); 
```

但是，在我的资源中，我在尝试获取用户名时得到了 NPE。我想我需要让服务器主动对领域进行身份验证，但我还没有找到如何配置服务器来执行此操作。有没有人有这方面的经验？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T23:25:13.773

不幸的是，Grizzly HttpServer 目前不支持身份验证。但是在这里您可以找到一个简单的示例，如何使用 Jersey 过滤器实现身份验证。

[http://simplapi.wordpress.com/2013/01/24/jersey-jax-rs-implements-a-http-basic-auth-decoder/](http://simplapi.wordpress.com/2013/01/24/jersey-jax-rs-implements-a-http-basic-auth-decoder/)

# ruby - 一页上有多个 Rails 控制器请求

> ID：15980663
> 
> 赞同：1
> 
> 时间：2013-04-12T20:54:09.310
> 
> 标签：ruby, ruby-on-rails-3, oop, model-view-controller

前几天，我偶然发现了 Sandi Metz 的[规则](https://gist.github.com/henrik/4509394)，其中一个读到

> 当你的 Rails 控制器调用时，你只能实例化一个对象来做任何需要做的事情。

对 Rails 来说还是很新，但我一直认为我的控制器方法有一些味道，这证实了这一点。我有一个父模型的仪表板视图，它显示有关他们的孩子（不同的模型）和孩子的挑战（另一个模型）的信息，所有这些都具有不同的控制器。这是我们的控制器方法之一的示例。

```
def dash
  @parent = current_user
  @children = @parent.children
  @completed_challenges = @parent.assigned_challenges.where("parent_id =?", @parent.id).where("completed =?", true)
  @validated_challenges = @parent.assigned_challenges.where("parent_id =?", @parent.id).where("validated =?", true)
  @enabled_rewards = @parent.enabled_rewards.where("parent_id =?", @parent.id)
end 
```

我想知道是否可以发送多个请求以从它们各自的控制器中获取所有这些对象，而不是将它们全部集中在一个请求中。我知道我可以用 Ajax 做到这一点，但是有没有办法在页面加载时只做多个 http 请求？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-01-30T07:09:33.533

推荐的方法是使用外观模式。Thoughtbot 在这篇博文的“仅在控制器中实例化一个对象”部分提供了一个如何处理此问题的完美示例：

[http://robots.thoughtbot.com/sandi-metz-rules-for-developers](http://robots.thoughtbot.com/sandi-metz-rules-for-developers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T22:51:37.097

答案是**否定**的。

AJAX 是专门为此目的而构建的，以克服多个 http 请求的缺点。再加上多个 http 请求，而页面加载由于性能下降而被皱眉。对于一个小项目来说，这似乎是一条有利可图的道路，但当它扩大规模时，你肯定会遇到巨大的漏洞。

虽然我不是它的忠实粉丝，但在这种情况下，走老路可以为你节省很多精力。:)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T10:53:18.653

> 当你的 Rails 控制器调用时，你只能实例化一个对象来做任何需要做的事情。

我看到了这条规则的用处，但我认为你可以用稍微不同的方式来解释它。当你加载一个控制器时，你确实希望它做的越少越好。这是给定的。

但是，在您的情况下，您似乎有很多不同的数据要加载。除了看起来丑陋之外，您还会看到随着仪表板支持越来越多的指标，代码也会变得越来越大。您真的不希望处于代码行数与应用程序显示的数据量成比例增加的情况。

相反，发送**一个**对象 - 您需要显示的所有数据的字典。而且我建议将该字典的构建移至构建它的模型（或者更好的是服务）（可能基于某种配置）。控制器应该只是从某个地方获取该对象并以正确的格式将其发送回。

# c# - EF Lambda：包含路径表达式必须引用导航属性

> ID：15980665
> 
> 赞同：11
> 
> 时间：2013-04-12T20:54:22.127
> 
> 标签：c#, asp.net-mvc-3, entity-framework, lambda, entity-framework-5

这是我的表达：

```
Course course = db.Courses
  .Include(
    i => i.Modules.Where(m => m.IsDeleted == false)
      .Select(s => s.Chapters.Where(c => c.IsDeleted == false))
  ).Include(i => i.Lab).Single(x => x.Id == id); 
```

我知道原因是`Where(m => m.IsDeleted == false)`在模块部分，但为什么会导致错误？更重要的是，我该如何解决？

如果我删除 where 子句，它可以正常工作，但我想过滤掉已删除的模块。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-12T21:53:20.500

`.Include`用于从数据库中急切地加载相关实体。即，在您的情况下，请确保课程中加载了模块和实验室的数据。

里面的lamba表达式`.Include`应该告诉实体框架要包含哪个相关表。

在您的情况下，您还尝试在包含内执行条件，这就是您收到错误的原因。

看起来您的查询是这样的：

> 查找与给定 ID 匹配的课程，以及相关模块和实验室。只要不删除匹配的模块和章节。

如果这是正确的，那么这应该工作：

```
Course course = db.Courses.Include(c => c.Modules)
                          .Include(c => c.Lab)
                          .Single(c => c.Id == id && 
                                       !c.Module.IsDeleted &&
                                       !c.Chapter.IsDeleted); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-12T22:11:48.343

> 但为什么会导致错误？

我可以想象，有时 EF 团队会后悔他们引入这种`Include`语法的那一天。lambda 表达式表明任何有效的 linq 表达式都可以用来巧妙地操纵急切加载。但太糟糕了，并非如此。正如我[在这里](https://stackoverflow.com/a/15389265/861716)解释的那样，lambda 仅用作底层“真实”`Include`方法的伪装字符串参数。

> 我如何解决它？

最好的办法是投射到另一个班级（比如说，一个 DTO）

```
db.Courses.Select(x => new CourseDto {
    Id = x.Id,
    Lab = x.Lab,
    Modules = x.Modules.Where(m => !m.IsDeleted).Select( m => new ModuleDto {
        Moudle = m,
        Chapters = x.Chapters.Where(c => c.IsDeleted)
    }
}).Single(x => x.Id == id); 
```

但这对您来说可能是一个重大修改。

[`Load`另一种选择是禁用延迟加载，并通过命令](http://blogs.msdn.com/b/adonet/archive/2011/02/05/using-dbcontext-in-ef-feature-ctp5-part-11-load-and-asnotracking.aspx)预加载上下文中未删除的课程模块和章节。关系修复将填充正确的导航属性。`Include`for将`Lab`正常工作。

顺便说一句，此功能有一个[更改请求](https://entityframework.codeplex.com/workitem/47)。

# c# - 为什么 Code Contracts 静态分析器不将这些属性 getter 调用视为平等？

> ID：15980670
> 
> 赞同：3
> 
> 时间：2013-04-12T20:54:35.920
> 
> 标签：c#, code-contracts

我正在尝试使用代码合同来设置一个不可变的有序单链表类来强制执行排序。我遇到了一些归结为这个例子的问题：

```
[Pure, ContractVerification(true)]
public class Hierarchy
{
    private readonly object _data;
    private readonly Hierarchy _childField;

    public Hierarchy() { }

    public Hierarchy(object data, Hierarchy childParameter) {
        Contract.Requires<ArgumentNullException>(childParameter != null);

        _data = data;
        _childField = childParameter;

        Contract.Assert(HasChild);

        Contract.Assert(_childField == childParameter);
        Contract.Assert(_childField.Data == childParameter.Data);

        Contract.Assert(ChildProperty == _childField);
        Contract.Assert(ChildProperty.Data == _childField.Data);  //Warning -- CodeContracts: assert unproven
    }

    public bool HasChild { get { return _childField != null; } }

    public object Data {
        get {
            Contract.Ensures(Contract.Result<object>() == _data);
            return _data;
        }
    }

    public Hierarchy ChildProperty {
        get {
            Contract.Requires<InvalidOperationException>(HasChild);
            Contract.Ensures(Contract.Result<Hierarchy>() == _childField);

            //un-commenting this line causes the assertion to succeed.
            //Contract.Ensures(Contract.Result<Hierarchy>().Data == _childField.Data);

            return _childField;
        }
    }

    [ContractInvariantMethod]
    private void Invariant() {
        Contract.Invariant(HasChild == (ChildProperty != null));
    }
} 
```

在我看来，代码契约应该能够证明这个断言`ChildProperty.Data == _childField.Data`。前面的断言`ChildProperty == _childField`成功，并且在同一个对象上调用纯属`Data`性 getter 两次应该返回相同的结果。

还要注意（成功的）早期断言`_childField == childParameter`和`_childField.Data == childParameter.Data`。

如上面第二条评论所述，通过将后置条件添加`Contract.Ensures(Contract.Result<Hierarchy>().Data == _child.Data);`到`ChildProperty`getter 来解决问题。请注意，这就是我们需要做的所有事情——在这种情况下，代码契约认识到，当 时，在 x 和 y 上`x == y`调用getter 将产生相同的结果。`Data`

这种解决方法对于这个小例子来说很好，但是对于一个大类来说，必须为每个类型的属性添加一个后置条件是很麻烦的（更不用说有点傻了）。

它是一个错误吗？我是否错过了一些合同注释或其他`Child.Data == _child.Data`可以证明断言的内容？换句话说，有没有其他方法可以解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-24T22:09:08.763

你是绝对正确的。这应该是可证明的，但不是由于静态检查器的限制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:52:07.510

可能是因为该`Data`属性不保证不会更改 的内容`_data`（尽管它是`readonly`，但它的内容仍然可能是可变的）？

例如，假设你有这个：

```
public object Data {
    get {
        Contract.Ensures(Contract.Result<object>() == _data);
        ((SomeClass)_data).SomeProperty += 1;
        return _data;
    }
} 
```

然后两个后续调用`Data`会得到不同的结果。

将其添加到`Data`'s`get`工作吗？

```
Contract.Ensures(_data == Contract.OldValue<object>(_data)); 
```

# macos - chown 非法组名 (mac os x)

> ID：15980675
> 
> 赞同：53
> 
> 时间：2013-04-12T20:55:04.127
> 
> 标签：macos, unix, terminal, chown

我正在尝试在终端中运行以下命令：

```
chown -R couchdb:couchdb /usr/local/var/log/couchdb 
```

但是，我不断收到此消息：

```
chown: couchdb: illegal group name 
```

我正在使用 mac osx (mountain lion)，并且安装了命令行工具。我真的不太了解 unix，但我一直在谷歌搜索非法组名错误，并没有找到任何有用的信息。我在看什么？您认为可能有帮助的任何其他资源也值得赞赏。

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2017-04-06T22:06:13.127

如果没有组，请尝试仅使用所有者。

```
sudo chown -R user: /usr/local/var/log/couchdb 
```

* * *

## 回答 #2

> 赞同：45
> 
> 时间：2015-10-26T14:20:37.850

`illegal group name`实际上意味着您指定的组（`couchdb`冒号后的第一个`couchdb`是用户）不存在。您需要创建组、停止指定组或指定存在的组。

# php - 链接到表单的单个用户的唯一 ID

> ID：15980679
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:55:27.707
> 
> 标签：php, mysql

我正在尝试创建一个多用户站点，该站点将允许用户添加除该用户之外的任何其他人都无法查看的信息。我`userid`在数据库表“用户”中有一个字段将自动生成用户 ID，我需要`userid`与正在发布的信息相关联的字段，并且`userid`在检索和查看该信息时也需要使用该字段。

请帮忙，显然我是新手。

- 解决！--

由于你们中的许多人帮助我从这个网站上禁止我，请查看我*自己*研究并开始工作的代码。事实上，这种方法是我发现的最简单的一种。在使用 $_SESSION['myusername'] 从登录屏幕设置和检索用户名之后，为了将用户名插入到客户端或支付数据库表中，这就是我使用的：

```
 <input type="hidden" id="<? echo $_SESSION['username'] ; ?>"> 
```

砰！将其延续并充当表单中的一行 INSERTS 它就像其他表单字段数据一样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T20:59:08.620

在存储数据的其他表中创建一个用户 ID 字段，然后在显示数据时确保您的查询包含带有当前用户用户 ID 的 where 子句。

# javascript - 我可以使用 jquery 确定设备是处于纵向还是横向模式吗？

> ID：15980680
> 
> 赞同：5
> 
> 时间：2013-04-12T20:55:39.070
> 
> 标签：javascript, jquery, jquery-mobile, screen-orientation, landscape-portrait

我想根据用于查看网站的设备是纵向/垂直还是横向/水平模式/方向，有条件地更改用户在我要创建的照片库网站上看到的内容。这可能吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T21:01:33.980

尝试`orientationchange`事件处理程序，如下所示：

```
$(window).bind("orientationchange", function(evt){
    alert(evt.orientation);
}); 
```

这是关于检测和触发事件的[jQuery Mobile 条目。](http://api.jquerymobile.com/orientationchange/)`orientationchange`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:00:21.773

如果您只是更改布局，请考虑使用[CSS 媒体查询](https://developer.mozilla.org/en-US/docs/CSS/Media_queries#orientation)。

在 Chrome 7 和 Firefox 3.6 中，您可以收听该[`deviceorientation`事件。](https://developer.mozilla.org/en-US/docs/DOM/Mozilla_event_reference/deviceorientation)

* * *

针对您的评论，检测平板电脑和手机的一种简单方法是检测屏幕分辨率和尺寸。平板电脑通常比手机具有更高的显示分辨率。媒体查询可以确定这些因素。

至于平板手机选项

*   如果您的设备是手机，您可以使用基于设备方向的媒体查询来切换 CSS。

*   如果设备是平板电脑，您可以使用 JS 使用 body id/class 切换或换出样式表来切换 CSS。

# performance - 为什么函数式语言对大数据有好处？

> ID：15980682
> 
> 赞同：2
> 
> 时间：2013-04-12T20:55:45.553
> 
> 标签：performance, functional-programming, bigdata

我目前在一家银行工作，并与 Q(kdb+, K 不管它叫什么) 一起工作。我知道这是一种函数式语言，我也知道很多组织使用函数式语言来处理大型数据集。

我想知道为什么函数式语言（编程）对大数据有好处？是因为他们编译代码的方式，还是其他一些原因。

另外，如果这个想法是错误的，谁能解释为什么它是错误的？

ps：如有类似问题，请见谅：P

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T20:59:39.067

原因之一是拥有不可变变量可以让您并行执行代码并且非常容易扩展。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2014-09-11T05:37:23.977

Zdravko 对不可变状态的看法是正确的，这使并发更容易并且更不容易出现竞争条件式错误。但是，这只有助于多线程并发。当您谈论大数据时，您谈论的是水平扩展的集群计算。函数式编程语言对此没有太多支持。

FP 有一些东西吸引了拥有大数据梦想的开发人员的想象力。也许它与 FP 的面向流的高阶函数有关，它让您从处理数据流的角度进行思考。使用 FP，您可以解决语言问题，例如 union、intersection、diff、map、flatmap 和 reduce。

但是单靠 FP 在分布式计算环境中是行不通的。在 OSCON 2014 上，我了解了一些将 FP 语言与 Hadoop 集成的开源项目。请参阅[函数式编程和大数据](http://glennengstrand.info/analytics/fp)，以对三个这样的项目进行比较评估。Netflix Pig Pen、Cascalog 和 Apache Spark。

# python - HPUX 上的 Python 构建错误

> ID：15980684
> 
> 赞同：0
> 
> 时间：2013-04-12T20:55:50.663
> 
> 标签：python, gcc, python-2.7, python-3.x, hp-ux

我正在尝试使用 gcc 4.7.0 在 HPUX 11.31 Itanium 上构建 Python 2.7.4 和 Python 3.3.1。对于这两个项目，我得到相同的构建错误：

```
make
...

running build scripts

...

/bin/sh[5]: 26906 Abort (coredump)
make: *** [sharedmods] Error 134 
```

我找不到有关此错误的最新或相关信息。我可以使用相同的过程构建 Python 2.7.3，并且构建得很好。我们有一个我不久前构建的工作 Python 3.1.2，也使用相同的过程。

我的配置行很简单：

```
./configure --prefix="some path" --with-threads 
```

我试过有和没有线程。我也在构建一个 64 位版本，使用“-mlp64”

# html - 我如何将 div 堆叠在彼此的旁边和顶部？

> ID：15980688
> 
> 赞同：5
> 
> 时间：2013-04-12T20:56:05.003
> 
> 标签：html, css

我对 html 或 css 不太了解，但我已经做了很多；

![在此处输入图像描述](https://i.stack.imgur.com/pIemD.png)

我想堆叠 div，使它看起来像这样（请原谅糟糕的绘图）；

![在此处输入图像描述](https://i.stack.imgur.com/oaXBJ.png)

我已经用谷歌搜索了如何做并尝试了不同的东西，但喜欢/不喜欢的框总是最终不会移动或移动到最左边/最右边。

```
<div style="float:left;width:300px;height:350px;text-align:center;">
<div style="float:left;width:500px;height:200px;text-align:center;">
<div id="wrapper">
<div style="align=center;">
<div id="first">1</div>
<div id="second">2</div> 
```

这是我拥有的三个 div。第一个有链接[添加/消息等]

第二个有“thelastgecko”和个人资料文本。

我正在尝试使用最后一个框来表示喜欢/不喜欢，但无论我做什么都行不通。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:30:15.767

您通常使用一个“巨大”的 div，将其设置为低于 1024 像素宽，以便旧屏幕可以查看它，然后您通常将其置于屏幕中间。然后在那个大 div 里面，你把“添加我 - 给我发消息 - 画廊”和一个“浮动：左”或“位置：绝对”我更喜欢后者。然后你制作另一个包含“最后一个壁虎”+不喜欢和喜欢的div并将该div居中，然后我会制作另一个div并执行“float：right”或“position：absolute；left：'巨大的宽度减去这个宽度”。

我确实用文本编写了所有内容并且可读，因为放弃代码也不会**教**。

但如果你仍然没有得到它，这是我的想法：

```
<html>
  <head>
    <style>
      body{margin:0px;padding:0px;width:100%;height:100%;}
      #container{width:900px;margin:auto;margin-top:200px;}
      #add_me,#dislike_text{position:absolute;width:200px;background-color:#ace;}
      #last_gecko,#holder{margin:auto;width:500px;background-color:#eca;}
      #likes,#dislikes{float:left;width:250px;display:block;background-color:#cae;}
      #dislikes{background-color:#cea;}
      #dislike_text{margin-left:700px;background-color:#eac;}
    </style>
  </head>
  <body>
    <div id="container">
      <div id="add_me">add me<br>message me<br>wuts going on</div>
      <div id="dislike_text">dislike text</div>
      <div id="last_gecko">
      Last Gecko
        <div id="holder">
          <div id="dislikes">dislikes</div>
          <div id="likes">likes</div>
        </div>
      </div>
    </div>
  </body>
</html> 
```

让它可行，它至少会告诉你往哪个方向移动，这可能不是最好的方式，但它是我的方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:56:41.397

你可以这样做：http: [//jsfiddle.net/jAKgd/](http://jsfiddle.net/jAKgd/)

CSS

```
 #wrapper {
            width: 800px;
        }
        #leftColumn {
            float: left;
            height: 800px;
            width: 200px;
            margin-right: 5px;
        }
        #leftColumn a {
            display: block;
        }
        #rightColumn {
            width: 100%;
        }
        #contentDislike,
        #contentLike {
            display: inline-block;
            width: 250px;
        } 
```

显然，可以更改高度/宽度以满足您的需要。我只是在做一个简单的例子。

HTML

```
<div id="wrapper">
  <div id="leftColumn"> <a href="#">Link</a>
    <a href="#">Link</a>
    <a href="#">Link</a>
    <a href="#">Link</a>
    <a href="#">Link</a>
   </div>
   <div id="rightColumn">
    <div id="contentTop">
        <img src="/images/image_name.jpg" alt="image text here" />
        <p>THIS IS WHERE YOUR PROFILE TEXT WOULD SHOW. IT CAN EXPAND HEIGHT AS NEEDED.</p>
    </div>
    <div>
        <div id="contentDislike">DISLIKE CONTENT HERE</div>
        <div id="contentLike">LIKE CONTENT HERE</div>
    </div>
    <div>YOUR LOWER TWO COLUMNS WILL GO IN THIS DIV</div>
  </div>
</div> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-02T20:29:22.437

使用浮动将 div 放置在某个位置是一种糟糕的设计方式。这是一种更好的使用方式，例如，flex 布局。但并非所有浏览器都支持此功能（但几乎。如果可以，请选择此选项）。

另一种解决方案是：使用该`width`选项。当然，您将 html 的任何 div 的宽度设置为固定数字，以百分比为单位。[观看此示例](http://www.w3schools.com/css/css_max-width.asp) 但是，如果您这样做，则必须注意非常大和非常小的屏幕，我认为您将不得不编写与`(max-width)`和一起使用的替代 css 样式表`(min-width)`。

还有另一种解决方案：网格布局。它是自 2013 年以来标准的一部分（我认为），但尚未得到很好的支持。但也许在未来。

希望我能帮上忙

# html - 删除段落的顶部和底部填充？

> ID：15980695
> 
> 赞同：4
> 
> 时间：2013-04-12T20:56:33.243
> 
> 标签：html, css

我想删除段落文本的顶部和底部填充而不更改文本的行高。请看下图，我希望上下边框与文本之间没有任何填充。段落高度不固定。

![在此处输入图像描述](https://i.stack.imgur.com/8nM1Z.png)

**HTML：**

```
<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. </p> 
```

**CSS：**

```
p{
    width: 200px;
    line-height: 2.2;
    border: 1px solid red;   
} 
```

**演示：http:** [//jsfiddle.net/Dqmu8/](http://jsfiddle.net/Dqmu8/)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T20:58:19.130

你可以包装在 div 然后给它一个负边距 DEMO [http://jsfiddle.net/kevinPHPkevin/Dqmu8/7/](http://jsfiddle.net/kevinPHPkevin/Dqmu8/7/)

```
p{
    line-height: 2.2;
    margin:-10px 0 -10px 0;
}
div{
    width: 200px;
    border: 1px solid red; 
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:05:07.753

如果不解决该属性，您*将无法*实现这一点（毕竟，这是*造成空间的原因）；*但是，您可以专门针对仅*伪*元素的：`line-height``line-height`*`line-height`*`::first-line`**

 **```
p{
    width: 200px;
    line-height: 2.2;
    border: 1px solid red;
    padding: 0;
}

p::first-line {
    line-height: 1em;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Dqmu8/2/)。

不幸的是，没有`::last-line`伪选择器，所以只能定位第一个。

参考：

*   [`::first-line`伪元素](http://www.w3.org/TR/selectors/#first-line)。**

# ios - RKMappingTest 没有方法（RestKit）

> ID：15980697
> 
> 赞同：0
> 
> 时间：2013-04-12T20:56:42.950
> 
> 标签：ios, unit-testing, restkit

我正在使用`RestKit`并尝试按照他们 Github wiki 上的单元测试指南进行单元测试。

当我尝试创建 的实例时`RKMappingTest`，它就像它只有`NSObject`方法一样。它没有`testWithMapping:`自动完成中出现的方法或任何其他方法，如果我自己输入，则会出现错误。此外，`respondsToSelector:`返回`NO`该`testWithMapping`方法。

因此，由于该类可用，我确定标题存在，但我无法弄清楚为什么这些方法不存在。这些`textFixture`东西也很好用。我已经重新启动了 XCode，但似乎无法找出这里发生了什么。帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T17:19:25.537

我已经更新了 Wiki 页面。消息调用出错，应该是：

```
+ testForMapping:sourceObject:destinationObject: 
```

代替

```
+ testForMapping:withSourceObject:destinationObject: 
```

# regex - 搜索不以字母数字字符开头的模式

> ID：15980699
> 
> 赞同：0
> 
> 时间：2013-04-12T20:56:55.293
> 
> 标签：regex, vim

我想在 vim 中搜索不以字母数字字符开头的模式。这意味着以空格和换行符开头的模式。
如果 {pattern} = noremap
我试图搜索`/\Wnoremap`，但它错过了后一种情况，因为它需要在模式之前至少有一个字符。我知道`/^noremap`会起作用，但我想知道如何将这两种情况结合在一起。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:25:55.910

根据[vimregex](http://vimregex.com/)：

四。图案说明

4.1 锚点

\< 和 \> 是锚点。

您可以在链接中阅读有关它们的更多信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:13:24.423

尝试类似：

```
/\(^\|\W\)noremap 
```

`^\|\W`表示要么`^`要么`\W`。
(`()`转义`\`) 只是为了使它不是`^`or `\Wnoremap`。

负后视 ( `@<!`) 也可能起作用：

```
/\(@<!\W\)noremap 
```

[参考](http://vimregex.com/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:30:20.790

EHuhtala 回答了我的问题，但我想解释一下： `\>`是单词的开头。它的参考可以在 vim 下找到`ordinary-atom`

```
:h oridnary-atom 
```

# jquery-mobile - 渲染调用后，Backbone.js 视图未在浏览器中显示

> ID：15980701
> 
> 赞同：0
> 
> 时间：2013-04-12T20:57:04.543
> 
> 标签：jquery-mobile, backbone.js, cordova, backbone-views

JS代码如下

模型

```
var EntryName = Backbone.Model.extend({
    defaults : {
        name : ""
    },
}); 
```

模型集合

```
var EntryNames = Backbone.Collection.extend({
    model : EntryName,
    initialize : function() {

    }
}); 
```

模型视图

```
var EntryNameView = Backbone.View.extend({
    tagName : 'li',
    // Cache the template function for a single item.
    entrynametpl : _.template('<li><a href="#" ></a></li>'),
    // Re-render. 
```

渲染功能

```
 render : function() {
        this.$el.html(this.entrynametpl(this.model.toJSON()));
        return this;
    },

}); 
```

模型集合视图

```
var EntryNamesView = Backbone.View.extend({
    //      tagName: "ul",
    //      className: "nav-search",
    el : $('#entriestree'),
    initialize : function() {
        //this.template = _.template($('#entries-template').html());
        _.bindAll(this, 'render');
    }, 
```

渲染功能

```
 render : function() {
    var item, self = this;
    //var template = $("#item-template");
    this.collection.each(function(entry) {
        item = new EntryNameView({
            model : entry
        });
        self.$el.append(item.render().el);
    });
    console.log($(this.el));
    return this;
}    
}); 
```

模型集合

模型集合这是我调用渲染的位置和方式。

```
function onDeviceReady() 
        {  
//          console.log("Opening panel");
            $("#nav-panel").panel( "open");
            console.log("creating collection");
            var donuts = new EntryNames();
            donuts.reset([  {"name" : "Boston Cream"},  {"name" : "Lemon-Filled"},  {"name" : "Rusty Iron Shavings"}]);
            console.log("created collection");
            var donutCollectionView = new EntryNamesView({collection : donuts});
            donutCollectionView.render();
            $("#nav-panel" ).trigger( "updatelayout" );
        } 
```

模型集合

HTML 代码位于模型集合下方

```
<body>
<div id="panel-fixed-page1" class="jqm-demos ui-responsive-panel"
    data-url="panel-fixed-page1" data-role="page">
    <div data-role="header" data-theme="f" data-position="fixed">
        <div data-role="navbar" data-grid="d">
            <ul>
                <li><a class="ui-btn-active" href="#" data-         theme="a">Entry</a></li>
                <li><a href="#" data-theme="a">Addresses</a></li>
                <li><a href="#" data-                               theme="a">Attachments</a></li>

             <li><a href="#" datatheme="a">Delivery Collection</a></li>
            </ul>
        </div>
        <!-- /navbar -->
        <a href="#nav-panel" data-icon="bars" data-iconpos="notext">Menu</a>
    </div>
    <!-- /header -->
    <div class="jqm-content" data-role="content">
    </div>
    <!-- /content -->
    <div id="nav-panel" data-role="panel"
        data-position-fixed="true">
        <li><a href="#" data-rel="close" >INBOX</a></li>
        <ul id="entriestree" class="nav-search" data-role="listview" data-                      theme="a">
        </ul>
    </div>
</div>
      </body> 
```

模型集合

模型集合

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:44:17.343

在您的`EntryNamesView.render`,`this`中没有指向`view`，因为它在`each`回调函数范围内。尝试将其更改为使用`self`：

```
render : function() {
    var item, self = this;
    //var template = $("#item-template");
    this.collection.each(function(entry) {
        item = new EntryNameView({
            model : entry
        });
        self.$el.append(item.render().el);
    });
    console.log($(this.el));

    return this;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T23:12:03.677

您的 _.underscore 模板没有占位符变量：

```
entrynametpl : _.template('<li><a href="#" ></a></li>') //renders empty li's 
```

将此更正为：

```
entrynametpl: _.template('<li><a href="#"><%= name %></a></li>') 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-14T17:46:22.950

好的，我发现了问题，我在构造函数（初始化函数）之外设置了视图的元素“el”属性，因此它从未使用正确的 dom 元素进行设置，因为 dom 元素出现在 html 文件中的脚本引用之后. 一旦我将脚本导入移到页面末尾，瞧，生活是美好的……愚蠢的错误花费了您太多时间！

# string - 使用 C 中的函数初始分配 Char 数组

> ID：15980703
> 
> 赞同：0
> 
> 时间：2013-04-12T20:57:14.193
> 
> 标签：string, function, initialization, char, variable-assignment

正如我们在 C 中所知道的，一个字符串定义是，

```
char string[] = "Hello World"; 
```

那没问题，

但是我想使用一个函数，并且在最初相同的时候，我尝试了那些，例如；

```
char * to_string()
{
    return "Hello World";
} 
```

或者;

```
char * to_String(void)    // Function
{
    char buff[16];
    sprintf(buff, "%s", "Hello World");
    return buff;
}

main()    // main function
{
   char Initial_String[] = to_String();
} 
```

如何以另一种方式使这个或任何想法相同。

我发现我没有发送 char Initial_String[] 的地址来填写。没有。还有其他方法吗。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T20:15:18.310

是的，关于本地缓冲区错误，您是对的，

但这不是我想要的，

如果我以不同的方式编辑，

```
char buff[16];
char* to_String(void)    // Function
{                      
            //char buff[16];   /*this is a local variable*/
            sprintf(buff, "%s", "Hello World");
            return buff;
}                      

int main(void)    // main function
{                      
           char *Initial_String_1 = to_String();
           char *Initial_String_2 = to_String();
           char *Initial_String_3 = to_String();

           printf("%s", Initial_String_1 );
           printf("%s", Initial_String_2 );
           printf("%s", Initial_String_3 ); 
```

在这种情况下，所有字符串都是相同的，因为它们具有相同的缓冲区地址，

我想多开一点话题。

```
struct
{
     long   aaa;
     short  bbb;
     int    ccc;
     char   ddd;
     .
     .
     .    // the list goes on
}elements;

typedef struct 
{
    int lengt;
    int *adress;
    char name[10];
}_list;

char* to_String(long variable)    // Function
{                      
            sprintf(buff, "%ld", variable);
            return buff;
}  

int main (void)
{
 _list My_List[] = {
                  { sizeof(elements.aaa), &elements.aaa , to_string( elements.aaa) },
                  { sizeof(elements.bbb), &elements.bbb , to_string( elements.bbb) },
                  { sizeof(elements.ccc), &elements.ccc , to_string( elements.ddd) }, 
                  .
                  .
                  . //// the list goes on
                 }; 
```

我不知道，我是否让自己清楚。在这里，字符串必须填充到名称数组中，而不是为其分配地址。

我可能有语法错误。代码未经编译器测试。该想法仅用于说明目的。

我正在尝试为目的找到一种方法。

谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T18:51:55.440

当你编译它时，至少在 GCC 中，它会给你以下警告： `b.c:9: warning: function returns address of local variable` 为什么？因为`buff[]`是函数的局部变量`to_string()`。它的作用域只在函数内部`to_string()`。`main()`无权访问此变量。尝试创建`buff[]`一个全局变量。

第二个问题：`char Initial_String[] = to_String();`不能以这种方式赋值。`to_string()`返回一个 char 指针，因此赋值如下：

```
char *Initial_String = to_String(); 
```

下面的代码将起作用：

```
char buff[16];
char* to_String(void)    // Function
{                      
            //char buff[16];   /*this is a local variable*/
            sprintf(buff, "%s", "Hello World");
            return buff;
}                      

int main(void)    // main function
{                      
           char *Initial_String = to_String();
           printf("%s", Initial_String);
           return 0;
} 
```

# sitecore - Sitecore - 创建文件下载链接

> ID：15980704
> 
> 赞同：3
> 
> 时间：2013-04-12T20:57:17.543
> 
> 标签：sitecore, sitecore6, sitecore-media-library

在 sitecore 中，我有具有“文件”字段的项目。

当我使用如下代码时：

```
var bioDoc = item["BiographyDocument"]; 
```

我得到一个看起来像这样的字符串：

```
<file mediaid=\"{3891941C-AC19-4DEB-AD5D-2E4FA4DD2E07}\" src=\"~/media/3891941CAC194DEBAD5D2E4FA4DD2E07.ashx\" /> 
```

我如何从这个字符串转到 MediaItem 然后是下载链接？我在这上面花了很多时间，但在任何地方都找不到答案。

谢谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-12T21:13:32.893

使用 MediaManager 获取 MediaItem url：

```
Sitecore.Data.Fields.FileField field =  
             (Sitecore.Data.Fields.FileField)myItem.Fields["BiographyDocument"];
string url = Sitecore.Resources.Media.MediaManager.GetMediaUrl(field.MediaItem); 
```

# sharepoint-2010 - Sharepoint 2010 DataViewWebPart 带参数

> ID：15980705
> 
> 赞同：1
> 
> 时间：2013-04-12T20:57:22.470
> 
> 标签：sharepoint-2010, parameters, common-table-expression, dataviewwebpart

因此，在经历了很多挫折之后，我终于在 Sharepoint 2010 Designer 中创建了一个带有单个参数的 sql server 数据源。该查询是一个公用表表达式 (CTE)，可以在 SQL Server Management Studio 中正常运行。该参数是一个整数 (Int32)。

我希望有一个文本框，用户可以在其中输入数字，然后页面将检索查询结果。

我的问题是：

1）这甚至可能吗？

2）如果是这样，我该怎么做？我看起来高高在低，似乎无法在人们认为相当简单的事情上找到帮助。

# jquery - Nivo 滑块中的图像映射

> ID：15980709
> 
> 赞同：4
> 
> 时间：2013-04-12T20:57:27.793
> 
> 标签：jquery, html, wordpress, nivo-slider

我无法将图像映射添加到我的 nivo 滑块。下面是我正在使用的代码，这里是[该站点](http://dev.sourcetone.com/)的链接。有什么建议么？

```
<div class="slider-wrapper theme-default">
    <div id="slider" class="nivoSlider">
        <img src="wp-content/themes/sourcetone/images/1-difference.png" data-thumb="wp-content/themes/sourcetone/images/1-difference.png" alt="" />
        <img src="wp-content/themes/sourcetone/images/2-mood.png" data-thumb="wp-content/themes/sourcetone/images/2-mood.png" alt="" usemap="#mood" />
        <img src="wp-content/themes/sourcetone/images/3-activity.png" data-thumb="wp-content/themes/sourcetone/images/3-activity.png" alt="" usemap="#activity" />
        <img src="wp-content/themes/sourcetone/images/4-health.png" data-thumb="wp-content/themes/sourcetone/images/4-health.png" alt="" usemap="#health" />
        <img src="wp-content/themes/sourcetone/images/5-buy.png" data-thumb="wp-content/themes/sourcetone/images/5-buy.png" alt="" usemap="#buy" />
    </div>
    <map name="mood" id="mood"><area shape="rect" coords="10,453,162,482" href="/products/our-products/more-info/" alt="" /><area shape="rect" coords="10,400,162,445" href="google play" alt="" /></map>
    <map name="activity"><area shape="rect" coords="929,449,1081,478" href="/products/our-products/more-info/" alt="" /><area shape="rect" coords="929,398,1081,443" href="google play" alt="" /></map>
    <map name="health"><area shape="rect" coords="11,449,163,478" href="/products/our-products/more-info/" alt="" /><area shape="rect" coords="11,396,163,441" href="google play" alt="" /></map>
    <map name="buy"><area shape="rect" coords="563,251,790,314" href="/products/our-products/more-info/" alt="" /><area shape="rect" coords="563,333,790,375" href="google play" alt="" /></map>
</div>
<script type="text/javascript" src="<?php bloginfo('template_directory'); ?>/js/jquery-1.9.0.min.js"></script>
<script type="text/javascript" src="<?php bloginfo('template_directory'); ?>/js/jquery.nivo.slider.js"></script>
<script type="text/javascript">
    $(window).load(function() {
        $('#slider').nivoSlider({
            effect: 'fade', // Specify sets like: 'fold,fade,sliceDown'
            animSpeed: 800, // Slide transition speed
            pauseTime: 5000, // How long each slide will show
            lastSlide: function(){}, // Triggers when last slide is shown
        });
    });
</script> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:41:28.860

老实说，我不认为这是可能的，因为 Nivo Slider 实际上会将您的图像分解为数十个较小的图像。

本质上，Nivo 利用了与精灵相同的技术，通过将图像加载到页面中（因此，它被缓存），然后将其用作数十个较小图像的背景，所述背景移动了所需的任何数量显示整个`div`图像的所需部分。因此，您实际提供给 Nivo 的图像本身永远不会显示。

因为图像映射不能直接`div`应用于`div`. 如果这不可行，我建议您直接联系 Nivo，询问他们是否有任何想法/解决方案可以直接与他们的插件集成。

如果您还有其他问题，请告诉我。祝你好运！:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-08T04:25:01.977

您可以使用 jQuery 动态更新映射

```
function drawMap() {
    // remove image overlays used during transition
    $('.nivo-slice, .nivo-box').remove();
    // set usemap attribute for current image
    var currentImage = $('#nivo-slider').data('nivo:vars').currentSlide;
    $('.nivo-main-image').attr("useMap", "#map-" + currentImage);
} 
```

然后在加载后和每次转换后调用该函数

```
$('.nivoSlider').nivoSlider({
    // slider config
    afterLoad: drawMap,
    afterChange: drawMap
)); 
```

# java - Java GridBagConstraints

> ID：15980712
> 
> 赞同：0
> 
> 时间：2013-04-12T20:57:32.500
> 
> 标签：java, swing, gridbaglayout

我在 JPanel 中有 5 个组件。我添加的前 4 个组件看起来一切都很顺利。但是，当我尝试向 JPanel 添加第 5 个组件时，组件之间的间距会因任何原因发生变化！

没有第 5 个组件：

```
First Name: [..............]

Last Name: [..............] 
```

和：

```
First Name:---------------- [.............]

Last Name:----------------- [.............]

What is your favorite sport: 
```

假装标签和文本字段之间的破折号是空格

标签和文本字段之间的间距发生了变化！这是我的代码，请帮助我！

```
 public static void main(String[] args)
{
    JFrame frame = new JFrame("Survey");
    frame.setSize(800, 600);
    frame.setLayout(new FlowLayout(FlowLayout.CENTER));
    frame.setVisible(true);
    frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);

    JPanel p1 = new JPanel(new GridBagLayout());
    //LINE.START = Top Left Corner
    frame.add(p1);

    GridBagConstraints gbc = new GridBagConstraints();
    gbc.insets = new Insets(5, 5, 10, 10);

    JLabel lblFirstN = new JLabel("First Name:");
    JLabel lblLastN = new JLabel("Last Name:");
    JLabel lblFavSport = new JLabel("What is your favorite sport:");

    JTextField txtFirstN = new JTextField();
    txtFirstN.setPreferredSize(new Dimension(100, 20));

    JTextField txtLastN = new JTextField();
    txtLastN.setPreferredSize(new Dimension(100, 20));

    gbc.gridx = 0;
    gbc.gridy = 0;
    p1.add(lblFirstN, gbc);

    gbc.gridx = 1;
    gbc.gridy = 0;
    p1.add(txtFirstN, gbc);

    gbc.gridx = 0;
    gbc.gridy = 1;
    p1.add(lblLastN, gbc);

    gbc.gridx = 1;
    gbc.gridy = 1;
    p1.add(txtLastN, gbc);

    //this block of code is what is screwing me
    gbc.gridx = 0;
    gbc.gridy = 2;
    p1.add(lblFavSport, gbc);
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-13T00:14:21.507

您获得此输出的原因是，这就是布局管理器的设计方式。

`GridBagLayout`是 的（虚拟）扩展`GridLayout`。事实上，它把它的组件放在一个网格中，但比`GridLayout`. 在包含的布局管理器中，您将获得类似于 HTML 表格的内容。

让我们仔细看看。以下代码...

```
GridBagConstraints gbc = new GridBagConstraints();
gbc.gridx = 0;
gbc.gridy = 0;
gbc.anchor = GridBagConstraints.WEST;
add(new JLabel("First Name"), gbc);
gbc.gridy++;
add(new JLabel("Last Name"), gbc);

gbc.gridx = 1;
gbc.gridy = 0;
add(new JTextField(15), gbc);
gbc.gridy++;
add(new JTextField(15), gbc); 
```

生成

![在此处输入图像描述](https://i.stack.imgur.com/AimXo.png)

很明显，您可以看到行和列。每行具有相同的高度，每列具有相同的宽度......

现在，如果我们添加下一个标签和字段......

```
GridBagConstraints gbc = new GridBagConstraints();
gbc.gridx = 0;
gbc.gridy = 0;
gbc.anchor = GridBagConstraints.WEST;
add(new JLabel("First Name"), gbc);
gbc.gridy++;
add(new JLabel("Last Name"), gbc);
gbc.gridy++;
add(new JLabel("What is your favorite sport:"), gbc);

gbc.gridx = 1;
gbc.gridy = 0;
add(new JTextField(15), gbc);
gbc.gridy++;
add(new JTextField(15), gbc);
gbc.gridy++;
add(new JTextField(15), gbc); 
```

这是您当前的问题...

![在此处输入图像描述](https://i.stack.imgur.com/vsiw7.png)

您可以看到第一列的宽度已增加以适应新标签...

现在我们可以通过使用`gridWidth`...

```
GridBagConstraints gbc = new GridBagConstraints();
gbc.gridx = 0;
gbc.gridy = 0;
gbc.anchor = GridBagConstraints.WEST;
add(new JLabel("First Name"), gbc);
gbc.gridy++;
add(new JLabel("Last Name"), gbc);
gbc.gridy++;
gbc.gridwidth = 2;
add(new JLabel("What is your favorite sport:"), gbc);

gbc.gridwidth = 1;
gbc.gridx = 1;
gbc.gridy = 0;
add(new JTextField(15), gbc);
gbc.gridy++;
add(new JTextField(15), gbc);
gbc.gridx = 2;
gbc.gridy++;
add(new JTextField(15), gbc); 
```

*`gridx`注意：必须增加最后一个字段的位置，否则它实际上会位于标签上方！*

![在此处输入图像描述](https://i.stack.imgur.com/vgaNX.png)

现在，这更好，但是，我认为这不是您想要的：P

我们还需要调整前两个字段以跨越到下一个单元格......

```
GridBagConstraints gbc = new GridBagConstraints();
gbc.gridx = 0;
gbc.gridy = 0;
gbc.anchor = GridBagConstraints.WEST;
add(new JLabel("First Name"), gbc);
gbc.gridy++;
add(new JLabel("Last Name"), gbc);
gbc.gridy++;
gbc.gridwidth = 2;
add(new JLabel("What is your favorite sport:"), gbc);

gbc.gridwidth = 2;
gbc.gridx = 1;
gbc.gridy = 0;
add(new JTextField(15), gbc);
gbc.gridy++;
add(new JTextField(15), gbc);
gbc.gridx = 2;
gbc.gridy++;
add(new JTextField(15), gbc); 
```

![在此处输入图像描述](https://i.stack.imgur.com/yCYkF.png)

最后 :P - 像馅饼一样简单 :D

您可能需要仔细查看[如何使用 GridBagLayout](http://docs.oracle.com/javase/tutorial/uiswing/layout/gridbag.html)了解更多详细信息...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:28:21.077

The reason that the last `JLabel` is not aligned with the previous 2 is that all labels are center aligned and appear in the same column. When there are only 2 labels, they appear aligned due to the happy coincidence that their `FontMetric` widths are equal. Add a third and the labels appear staggered.

To fix, you can anchor the labels to counter this effect by anchoring the components to `GridBagConstraints.WEST` and set the weight along the x axis:

```
gbc.weightx = 1;
gbc.anchor = GridBagConstraints.WEST; 
```

This has the effect of left aligning component within their `GridBagLayout` "cells".

# java - 可运行或执行服务

> ID：15980713
> 
> 赞同：5
> 
> 时间：2013-04-12T20:57:44.150
> 
> 标签：java, multithreading, runnable, executorservice

这更容易也更适合用于在另一个线程中运行东西，特别是这样程序会等待结果但不会锁定 ui。

可能有一种方法比这两种方法都好，但我不知道。

谢谢 ：）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-12T22:35:28.133

*   `Runnable`表示要执行的代码。
*   `Executor`它的子类代表执行策略。

这意味着前者实际上被后者消耗。你的意思大概是：简单线程和执行器之间，哪个更合适？

这个问题的答案基本上是：视情况而定。

`Executor`s 是复杂的工具，可让您选择可能正在运行的并发任务的数量，并调整执行上下文的不同方面。它们还提供了监控任务执行的工具，方法是返回一个令牌（称为 a`Future`或有时称为 promise），让请求任务执行的代码查询该任务的完成情况。

线程不太复杂（或更准系统）是异步执行代码的解决方案。您仍然可以让他们`Future`手动返回 a，或者简单地检查线程是否仍在运行。

因此，根据您需要的复杂程度，您可能会选择其中一个：`Executor`s 用于更简化的需求（要执行和监控的许多任务）， Threads 用于一次性或更简单的情况。

# android - 从活动调用 getSupportFragmentManager() 时出错

> ID：15980722
> 
> 赞同：3
> 
> 时间：2013-04-12T20:58:52.797
> 
> 标签：android, android-fragments, swipeview

我正在尝试使用片段实现滑动视图。但**对我来说扩展简单活动而不是片段活动非常重要**。我在下面编写的代码中遇到 getSupportFragmentManager() 错误：

```
public class CollectionDemoActivity extends Activity {

DemoCollectionPagerAdapter mDemoCollectionPagerAdapter;

ViewPager mViewPager;

public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_collection_demo);

    mDemoCollectionPagerAdapter = new DemoCollectionPagerAdapter(getSupportFragmentManager());

    mViewPager = (ViewPager) findViewById(R.id.pager);
    mViewPager.setAdapter(mDemoCollectionPagerAdapter);
}

public static class DemoCollectionPagerAdapter extends FragmentStatePagerAdapter {

    public DemoCollectionPagerAdapter(FragmentManager fm) {
        super(fm);
        //int x=10;
    }

    @Override
    public Fragment getItem(int i) {
        Fragment fragment = new DemoObjectFragment();
        Bundle args = new Bundle();
        args.putInt(DemoObjectFragment.ARG_OBJECT, i + 10); 
        fragment.setArguments(args);
        return fragment;
    }

    @Override
    public int getCount() {
        // For this contrived example, we have a 100-object collection.
        return 100;
    }

    @Override
    public CharSequence getPageTitle(int position) {
        return "OBJECT " + (position + 1);
    }
}

public static class DemoObjectFragment extends Fragment {

    public static final String ARG_OBJECT = "object";

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
            Bundle savedInstanceState) {
        View rootView = inflater.inflate(R.layout.fragment_collection_object, container, false);
        Bundle args = getArguments();
        ((TextView) rootView.findViewById(android.R.id.text1)).setText(
                Integer.toString(args.getInt(ARG_OBJECT)));
        return rootView;
    }
}
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T21:11:52.880

这个错误是不言自明的。`getSupportFragmentManager()`仅为[FragmentActivity](http://developer.android.com/reference/android/support/v4/app/FragmentActivity.html)类定义。无论您多么想或需要调用该方法，对于普通的活动来说，它根本不存在。

另请参阅：[Activity 和 FragmentActivity](https://stackoverflow.com/questions/10477997/difference-between-activity-and-fragmentactivity)之间的差异和 Fragment和[FragmentActivity 之间的差异](https://stackoverflow.com/questions/10609268/difference-between-fragment-and-fragmentactivity)

# c# - 以编程方式运行单个 NUnit 测试

> ID：15980724
> 
> 赞同：6
> 
> 时间：2013-04-12T20:58:59.837
> 
> 标签：c#, nunit

我需要以编程方式运行单个 C# NUnit 测试。我发现[另一篇文章](https://stackoverflow.com/questions/2825918/how-to-run-nunit-tests-from-c-sharp-code)非常有助于向我展示如何以编程方式运行一整套测试，但我需要能够选择单独的测试。

我认为设置 NameFilter 可以解决问题，但 RemoteTestRunner 似乎只认为我的套件中有超过 50 个测试。是否真的将单个 DLL 中的所有测试集中到一个庞大的测试中？有没有办法可以将它们分开并运行单独的测试用例？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-02-27T13:59:36.003

我也必须通过一个过滤器，只是执行

```
TestResult testResult = remoteTestRunner.Run(new NullListener(), null , false, LoggingThreshold.Error); 
```

以 NullReferenceException 结束。我快速创建了一个空过滤器

```
class EmptyFilter : TestFilter
{

    public override bool Match(ITest test)
    {
        return true;
    }
} 
```

并将其传递给`remoteTestRunner`.

```
TestResult testResult = remoteTestRunner.Run(new NullListener(), new EmptyFilter() , false, LoggingThreshold.Error); 
```

那行得通。可以投入一点的是搜索 NUnit 是否已经有一个类似的可以重用的过滤器，而不是创建一个自定义的过滤器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-21T14:36:24.727

我必须使用 SimpleNameFilter 并将我想要运行的单元测试的名称传递给它的构造函数。这是我所拥有的：

```
SimpleNameFilter filter = new SimpleNameFilter("Google.Maps.Test.Integrations.GeocodingServiceTests.Empty_address");
TestResult testResult = remoteTestRunner.Run(new NullListener(), filter, false, LoggingThreshold.Error); 
```

您可以通过从测试本身或通过查看 NUnit 程序中的测试属性来获得完全限定的测试名称。

# arduino - 使用 Arduino 微控制器板的项目

> ID：15980725
> 
> 赞同：-1
> 
> 时间：2013-04-12T20:59:00.457
> 
> 标签：arduino

我想使用 arduino 微控制器板开始一个项目。在这个项目中，我将使用迷你热敏收据打印机、条形码扫描仪和 arduino 以太网屏蔽将数据传输到我的电脑和从我的电脑。我的问题是，我应该为这样的项目购买什么 arduino 板？arduino uno 够用吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-11-07T05:38:45.380

正确的 Arduino 的选择取决于您需要的外围设备类型，例如，如果您的条码阅读器启用了 SPI，并且您无法使用 bit-bang SPI，那么这将计入硬件 SPI 的使用，因此将占用 UNO 上的 SPI 引脚它仅支持 1 个 SPI 硬件连接，但如果您想要更多 SPI 连接，请使用 MEGA，类似 UART、两线等是您可能需要的通信协议，具体取决于您在项目中使用的芯片组，还有 GPIO它只是打开和关闭。我建议从一个 DIP ATmega328P 的 Arduino UNO 开始，并获得一个备用的 Bootloader 独立的 ATmega328P 芯片，以防作为新手你在板上用魔法吸食芯片。

# c - c中的wget无效编码

> ID：15980726
> 
> 赞同：2
> 
> 时间：2013-04-12T20:59:00.617
> 
> 标签：c, wget

我想用c下载一个带有wget的网页。我已经编写了这段代码，但是当我尝试它时，程序下载了仅以给定名称的一部分命名的页面，并且我在文件名中发现了无效的编码。

页面名称是这样的

```
test0L���i}�X�����L�������R�td]�{��+`��U{�@ (invalid encoding) 
```

我的程序的重要部分是这个。

```
#define PAGE "http://deckbox.org/games/mtg/cards?p="

char *cat_url(char *s1, char *s2)
{
    char *tmp;
    tmp = (char*)malloc(sizeof(char*) * (strlen(s1) + strlen(s2)));
    strcat(tmp, s1);
    strcat(tmp, s2);
    return tmp;
}

void get_card_name(char *pg_name)
{
    int i;
    int fk;
    char *args[6], tmp;

    for (i = 0; i < 8; i++) {
        tmp = itoa(i);
        args[0] = "wget";
        args[1] = "-q";
        args[2] = cat_url(PAGE, &tmp);
        args[3] = "-O";
        args[4] = cat_url("test", &tmp);
        args[5] = NULL;

        if (fork()) {
            wait(&fk);
        } else {
            if (execvp(args[0], args) == -1) {
               error_rep("ERROR.\n");
            }
       }
    }
} 
```

我该如何解决这个问题？谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T21:09:13.353

我认为你需要使用`strcpy()`in `s1`，`cat_url()`像这样

```
strcpy(tmp, s1); 
```

...也是`sizeof()`指针而不是目标类型`char`加上一个字符作为零终止符。也许是这样的

```
char *cat_url(char *s1, char *s2)
{
    char *tmp;
    tmp = (char*)malloc(sizeof(char)*(strlen(s1) + strlen(s2) + 1)); // sizeof char and not pointer
    strcpy(tmp, s1); // strcpy here
    strcat(tmp, s2);
    return tmp;
} 
```

Wizzard 的答案也有一个关于其结果的重要观点`itoa()`和用法。

...最后一点，在使用它们之后存在内存泄漏，`args[2]`并且`argc[4]`应该是`free()`'d 。您还可以考虑将整个`args`数组移动到 of 语句的 else 部分，因为它没有在 if 部分中使用。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:13:23.600

问题在于以下几行：

```
char tmp;
tmp = itoa(i); 
```

请尝试以下方法：

```
char tmp[2];   // to store 1 char and '\0'
...
snprintf (tmp, sizeof (tmp), "%d", i);   // portable way to convert int to string
...
args[2] = cat_url(PAGE, tmp); // tmp is a pointer now
...
args[4] = cat_url("test", tmp); 
```

希望能帮助到你 ！

# java - 这不是用 Java 解释 Final 的坏例子吗？

> ID：15980730
> 
> 赞同：1
> 
> 时间：2013-04-12T20:59:16.207
> 
> 标签：java, variables, synchronization, immutability, final

Java 规范[17.5](http://docs.oracle.com/javase/specs/jls/se7/html/jls-17.html#jls-17.5)有以下代码来说明 Java 内存模型中 final 字段的使用。（与普通字段相比）

```
class FinalFieldExample { 
    final int x;
    int y; 
    static FinalFieldExample f;

    public FinalFieldExample() {
        x = 3; 
        y = 4; 
    } 

    static void writer() {
        f = new FinalFieldExample();
    } 

    static void reader() {
        if (f != null) {
            int i = f.x;  // guaranteed to see 3  
            int j = f.y;  // could see 0
        } 
    } 
} 
```

规范继续说：

“类 FinalFieldExample 有一个最终 int 字段 x 和一个非最终 int 字段 y。一个线程可能执行方法 writer，另一个线程可能执行方法 reader。因为 writer 方法在对象的构造函数完成后写入 f，reader 方法将保证看到 fx 的正确初始化值：它将读取值 3。但是，fy 不是最终的；因此不能保证读取器方法看到它的值 4。

**我的问题是：这不是一个蹩脚的（或至少是人为的）例子吗？** 还是我在这里遗漏了什么？

我将这个例子称为“蹩脚”的理由是：

如果FinalFieldExample 类的对象要在多线程场景中被线程共享，它不应该遵循多线程的基本原则，即使用某种形式的同步。如果他们使用了同步，那么上面提到的问题就不会存在。

上面的示例似乎提倡将 Final 字段作为适当同步技术的替代方案（或部分安慰者）。据我了解，即使在正确同步的基础上使用 final 字段也是有用的。并且永远不应该用于获得示例中提到的优势（在没有同步的情况下）。

所以有人可能会问：难道没有一个像样的例子（带有同步）来解释 final 字段相对于普通字段的优势吗？我想，不变性是！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T21:08:35.017

你是混乱`synchronization`和并发的。

如果一个字段是一个常量，那么它可以在多个`Thread`a 之间安全地共享，而无需任何锁定。

如果一个字段是一个变量，那么它需要被`synchronized`锁定或以其他方式锁定。

你可以有一个*并发*程序，它有多个线程读取相同的常量字段，这不会阻塞任何`Thread`s。

任何使用`synchronized`块的代码都会付出*巨大*的代价。这是一个非常昂贵的过程，应尽可能避免。更不用说资源匮乏、死锁、活锁等问题......

如果你可以使用`final`而不是`synchronized`你应该这样做。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:07:04.423

**编辑：我错过了这个答案的重点。问题不在于可以更改该值。请参阅 bmorris591 的答案。**

不可变对象的优点之一是**您不需要同步。**

但是这个例子不是关于同步的，而是关于读者线程保证看到的值。即使同步， 的值也`y`可能发生变化，而 的值`x`始终保证为 3。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T21:14:08.430

您所指的这个规范只是描述了东西（应该）如何表现。根据此规范，您可以决定如何正确编码。这个例子绝不试图代表一个真实的用例。它只是用几行来说明行为是什么。如果你的 jvm 实现不这样，那么它就是一个错误。

# mysql - 在 mySQL 宽度 PDO 中组合多个 bindParam

> ID：15980731
> 
> 赞同：0
> 
> 时间：2013-04-12T20:59:19.053
> 
> 标签：mysql, pdo, sqlbindparameter

我是 PDO 的新手，实际上它有点复杂。

是否可以结合这些参数

```
$stmt->bindParam(':firstname', $firstname, PDO::PARAM_STR);
$stmt->bindParam(':lastname', $lastname, PDO::PARAM_STR);
$stmt->bindParam(':telephone', $telephone, PDO::PARAM_STR);
$stmt->bindParam(':fax', $fax, PDO::PARAM_STR);
$stmt->bindParam(':mobile', $mobile, PDO::PARAM_STR);
$stmt->execute(); 
```

到一个阵列？它有意义还是我应该保持原样？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:01:46.387

我记得以前做过这样的事情：

```
$arr = array();
$arr[':firstname'] = $firstname;
$arr[':lastname'] = $lastname;
$arr[':telephone'] = $telephone;
$arr[':fax'] = $fax;
$arr[':mobile'] = $mobile;
$stmt->execute($arr); 
```

由于您没有使用任何花哨的参数类型，因此应该这样做。

* * *

是的，我确认这就是我正在做的事情并且有效。查看我个人代码的摘录：

```
$sql = "INSERT INTO `tbl` (relid, `type`, `table`, `name`) VALUES (:PARAM1, :PARAM2, :PARAM3, :PARAM4)";

$stmt = $cn->prepare($sql);

$arrQP = array();
$arrQP[":PARAM1"] = $key;
$arrQP[":PARAM2"] = $arrRel[0];
$arrQP[":PARAM3"] = $arrRel[1];
$arrQP[":PARAM4"] = $arrRel[2];

$stmt->execute($arrQP); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:09:24.703

你可以试试这个

```
 $stmt->execute(array(
                        ':firstname' => $firstname,
                        ':lastname' => $lastname ,
                        ':telephone' => $telephone,
                        ':fax' => $fax,
                        ':mobile' => $mobile
                           )); 
```

# python - 按行/列对标签进行排序

> ID：15980733
> 
> 赞同：1
> 
> 时间：2013-04-12T20:59:23.627
> 
> 标签：python, pandas

假设我有一个数据框：

```
df = pandas.DataFrame(np.random.randn(5,3),
columns = ['A','B','C'], 
index   = ['r0', 'r1', 'r2', 'r3', 'r4')

          A         B         C
r0 -0.830305 -0.395235  0.589917
r1 -1.378534 -0.484204 -1.068907
r2 -0.407720  1.922942 -1.120012
r3  1.075495  0.968913  1.509079
r4 -2.858858  1.018327 -0.660672 
```

我想获得一个新的数据框，对于每一行，我都有按值排序的列名列表。

对于上面的示例，`descending order`按列排序的结果将是：

```
 0  1  2
r0  C  B  A
r1  A  B  C
r2  B  A  C
r3  C  A  B
r4  B  C  A 
```

有没有“熊猫/numpy”的方式来做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:42:39.830

一种方法是[`order`](http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.order.html)在每一行上使用 Series 方法（并获取索引）：

```
In [11]: df
Out[11]:
           A         B         C
r0  0.213505 -0.661328  1.489605
r1 -1.096459 -0.373994 -1.948745
r2  0.380518 -1.424787 -0.639996
r3 -0.327361  1.029477  0.153808
r4 -0.593371  0.112844  0.096872

In [12]: df.apply(lambda row: row.order(ascending=False).index, axis=1)
Out[12]:
    A  B  C
r0  C  A  B
r1  B  A  C
r2  A  C  B
r3  B  C  A
r4  B  C  A 
```

分解它：

```
In [21]: row = df.ix[0]

In [22]: row
Out[22]:
A    0.213505
B   -0.661328
C    1.489605
Name: r0

In [23]: row.order(ascending=False)
Out[23]:
C    1.489605
A    0.213505
B   -0.661328
Name: r0

In [24]: row.order(ascending=False).index
Out[24]: Index([C, A, B], dtype=object) 
```

# dart - 在 Dart 中，如果我不知道它的类型，我应该用动态或对象注释函数返回值吗？

> ID：15980734
> 
> 赞同：8
> 
> 时间：2013-04-12T20:59:34.113
> 
> 标签：dart

如果我有一个返回未知类型值的函数，我是使用`dynamic`, 表示任何对象，还是使用`Object`，它是所有其他类型的祖先？

[样式指南](http://www.dartlang.org/articles/style-guide/#do-annotate-with-object-instead-of-dynamic-to-indicate-any-object-is-accepted)针对参数讨论了这个问题，而不是针对返回值。

我应该如何注释返回值，为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-12T20:59:34.113

Dart 工程师 Bob Nystrom 写道：

返回类型是这个问题的一个有趣的转折点。对于参数类型，指南非常简单：

1.  如果您`Object`用作参数类型，您是在说“我的方法将安全地接受任何对象，并且只将它用于`toString()`所有对象都支持的东西”。

2.  如果你使用`dynamic`（或不使用）作为参数类型，你是在说“Dart 的类型系统不能轻易地表达我在这里接受的类型”或“我没有费心去注释”。

翻转 (1) 很棘手。对于返回类型，我想`Object`会说“在自己进行类型测试之前，你最好不要调用任何东西，除了`toString()`所有对象都支持的东西”，`dynamic`我认为这里的意思是“我们不能轻易注释这个，所以你和我最好知道我们在做什么”。

用户必须将其“强制转换”为他们希望看到的特定类型，以避免编译器警告并在检查模式下更早地收到错误。

对于它的价值，在许多情况下，即使您返回 Object，您也不必强制转换。当您使用类型注释初始化局部变量时，Dart 允许隐式向下转换。所以你可以这样做：

```
Object foo() => 123;

main() {
  int x = foo(); // Implicit downcast. No type warning.
} 
```

不过，我认为在这种情况下，我可能会这样做`dynamic`。我认为这比`Object`.

# paypal - 获取测试帐户的计费协议

> ID：15980737
> 
> 赞同：0
> 
> 时间：2013-04-12T20:59:38.193
> 
> 标签：paypal

我们正在设置新的 PayPal 集成，但我在获取账单协议时遇到了一些问题。这是我们的场景：

*   第三方获取支付授权
*   第三方向我们发送账单协议 ID（他们称之为交易编号）
*   我们使用该 ID 执行参考交易来执行付款（这样做是为了续订订阅，通常每 30 天左右）

我要做的实际上是写第三部分。但是，首先必须对其进行测试，并且我无法为我的测试帐户获取帐单协议 ID。我假设通常该部分是通过客户使用 PayPal 登录的网页处理的，因此 API 知道正在链接的购买者帐户。如何以编程方式执行此操作？还是手动？我不在乎，因为我们永远不会打这个电话，我只需要测试帐户的 ID。

任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-14T01:20:14.903

您可以使用 Express Checkout 执行此操作。当您调用 SetExpressCheckout 时，请确保包含计费协议参数。

# html - 样式标签转换为 nope

> ID：15980738
> 
> 赞同：0
> 
> 时间：2013-04-12T20:59:38.783
> 
> 标签：html, tags, styles

我以前也遇到过这个问题，但从来没有发生在任何重要的代码上；然而，这可能已经是第十次了。我给自己一个带有背景的滚动条的代码，代码如下（忽略光标位）：

```
<style>
::-webkit-scrollbar{ NotAllowed12px;NotAllowed17px;background:#010101}::-webkit-        
scrollbar-thumb{ background-image:url(photolinkhere);border:1px solid #; -webkit-border-
radius:0ex; -webkit-box-shadow:0px 0px 0px rgba(0,0,0,0.75)}::-webkit-scrollbar-corner{ background:#transparent}
div, table, tr, td, a, br, iframe, embed{cursor:url(http://i48.tinypic.com/dynp8p.jpg)
,progress;}a:hover{http://i48.tinypic.com/dynp8p.jpg)
,progress;}</style>
</span></span></a></div>style type="text/css" />*
</div> 
```

但是，当我保存演示文稿时（有些网站需要 tumblr，但我的是在一个名为 xat 的网站上）。无论哪种方式 - 当我保存演示文稿时，样式标签会简单地转换为`nope>`，我无法找到如何在任何地方解决此问题的答案。我不是html专家，一个朋友制定了这个，所以我不知道这可能来自我的计算机还是代码本身。

# c# - c# 刷新表

> ID：15980746
> 
> 赞同：-4
> 
> 时间：2013-04-12T21:00:16.410
> 
> 标签：c#, datagrid, datagridview, oledb

如何刷新表格，因此单击按钮时，表格将刷新数据。如果我更改了表数据，程序会显示旧的，所以我必须重新启动程序才能刷新表中的数据。

![桌子](https://i.stack.imgur.com/MvQ4q.jpg)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:01:52.433

DataTable 是一个断开连接的对象，这意味着如果其他人更改数据库中的数据，它就无法自动更新。要刷新表格内容，您需要调用最初填充表格的代码

# c - 等同于两个 2d 指针-2d 数组

> ID：15980747
> 
> 赞同：0
> 
> 时间：2013-04-12T21:00:20.790
> 
> 标签：c, pointers

我正在尝试以下代码

```
#include<stdio.h>

int main()
{
    int A[3][4] = {{1,2,3,4},{5,6,7,8,},{9,10,11,12}};

    int **t = &A[0]; //I do this or **t = A,I guess both are equivalent

    printf("%d %p\n\n",*t,A[0]);

    return 0;

} 
```

我期望发生的事情：

现在 t 是一个二维指针（指向指针的指针），它保存着 A[0] 的地址，而 A[0] 又保存着 A[0][0] 的地址。所以 *t 应该给我 A[0] 的值，即 A[0][0] 的地址，而 **t 应该给我 A[0][0] 的值，在这种情况下是 1 .

我得到了什么：

*t 给出的值是 1。试图找到 **t 是不可能的，因为它会导致分段错误。

谁能告诉为什么会这样？

我尝试了以下解释，但不确定它是否是“正确”的解释。t 保存 A[0] 的地址，但由于 A 是一个数组，而 A[0] 是一个数组指针（它“不完全是”一个指针），C 不会为指针 A 或 A[0] 分配内存特别是 UNLIKE 其他指针变量。它只为整个数组分配内存。所以 A[0] 和 A[0] 的地址（也就是 A[0][0] 的地址）本质上是相同的，都属于同一屋檐下，不像“独立”的实体。结果 t 又间接持有 A[0][0] 的地址，而 *t 给出了 A[0][0] 的值，即 1。

上面的解释正确吗？有点奇怪。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:03:35.917

***数组不是指针。***

嗯，更...

***多维数组不是双、三等指针。***

因此，您所拥有的一切都是**错误的，您的程序****多次**调用未定义的行为，并且**您无法期待任何事情。**

鉴于数组在内存中是连续的，您可以像这样重写您的示例：

```
int A[3][4] = {{1,2,3,4},{5,6,7,8,},{9,10,11,12}};
int *p = &A[0][0];

printf("%d %d %p\n", A[0][0], *p, (void *)p); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:55:31.940

> 我尝试了以下解释，但不确定它是否是“正确”的解释。

不完全是，但它有点接近。

> `t`保存`A[0]`, 但因为`A`是一个数组并且`A[0]`是一个数组指针

`A[0]`是一个*数组*，具体来说，它的类型是`int[4]`。

> （这“不完全是”一个指针），C 不为指针分配内存`A`或`A[0]`特别 UNLIKE 其他指针变量。

数组和指针是根本不同类型的实体。不要混淆他们。

在大多数情况下，类型表达式`array of T`被转换为类型值`pointer to T`（指向数组的第一个元素）这一事实肯定会造成混淆，但千万不要忘记它是一个*转换*。特别是对于高维数组，或者数组的数组，数组的元素类型本身就是数组类型，所以转换的结果是指向数组的指针。

> 它只为整个数组分配内存。所以 和 的地址`A[0]`（`A[0]`也就是 的地址`A[0][0]`）本质上是一样的，

不，它们本质上是不同的，一个 - `A[0]`- 是一个数组，`int[4]`另一个 - `&A[0]`- 是指向四个数组的指针`int`，`int(*)[4]`。也不是`&A[0][0]`。

但是当`A[0]`转换为指向它的第一个元素的指针时`&A[0][0]`，得到的地址通常与 的地址相同`A[0]`（通常，指向对象的指针持有属于该对象的最低地址的字节的地址，并且由于`A[0]`属于到对象（是对象的一部分）`A`，地址最低的对象，属于的第一个字节是属于的`A[0]`第一个字节`A`）。

所以`&A[0]`和`&A[0][0]`通常具有相同的表示，但一个是`int(*)[4]`，另一个是`int*`。

> 两者都属于同一个屋檐下，不像“独立”的实体。结果`t`又间接地持有 的地址`A[0][0]`并`*t`给出 的值`A[0][0]`，即 1。

除了导致取消引用`t`未定义行为的类型不匹配之外，这部分或多或少是正确的。形式上，未定义的行为允许任何事情发生。

在实践中，如果`sizeof(int) == sizeof(int*)`，取消引用将1`t`解释为地址，并且如果您将其打印为（又一个未定义的行为），您将被打印。如果像 64 位系统上常见的那样，解引用通常会将两个s和一起解释为地址 -或者可能取决于字节顺序。`int``A[0][0]``int``1``sizeof(int*) == 2*sizeof(int)``t``int``A[0][0]``A[0][1]``0x200000001``0x100000002`

# objective-c - 大小为 9 的 NSMutableArray

> ID：15980749
> 
> 赞同：-2
> 
> 时间：2013-04-12T21:00:37.680
> 
> 标签：objective-c

我需要有一个恒定计数为 9 的 NSMutableArray，我可以在其中进行特定于索引的插入和删除。我知道这`array = [[NSMutableArray alloc] initWithCapacity:9];`将声明一个容量为 9 的数组，但是当你获得数组的大小时，它返回 0。

我对解决方案的第一次尝试是声明一个容量为 9 的数组（见上文），然后用 NSNull 对象填充它。此代码因错误而崩溃

> [NSMutableArray insertObjects:atIndexes:]：数组参数不是 NSArray'

```
- (void) setBlankArray: (NSMutableArray*)array {
    for (int i = 0; i < 9; i++) {
        [array insertObjects:[NSNull null] atIndexes:i];
    }
}

-(void) addCurrentTile: (TileView*)aTile {
    [currentTurnTilesArray insertObject:aTile atIndex: aTile.getValue-1];
}

-(void) removeCurrentTile: (TileView*)aTile {
    [currentTurnTilesArray removeObjectAtIndex: aTile.getValue-1];
} 
```

有没有更好的方法来完成它？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:09:38.253

不确定您要完成什么或为什么，但您`removeCurrentTile`会破坏它，因为它会将数组的大小减小 1。您需要做的是用一个保护它的类来包装这个数组，这样它就永远不会永远不会有任何其他数量的元素而不是 9。

就个人而言，我认为你试图做的是愚蠢的。如果你知道你总是有 9 个插槽，那么你应该从一个*普通*数组开始，而不是一个可变数组。您要改变的是每个索引处的对象，而不是数组本身。例如，如果这些东西是字符串，那么你将创建一个由 9 个 NSMutableString 对象组成的不可变数组：

```
NSArray* arr = @[
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string],
    [NSMutableString string]
 ]; 
```

现在每个字符串都可以变异为另一个值，但不能添加或删除字符串，例如更改数组的长度。

当然这只是一个例子（我的意思是使用字符串）。为了获得最大的灵活性，这将是一个由九个 NSMutableDictionary 对象组成的 NSArray。现在每个 NSMutableDictionary 都可以包含任何内容，也可以不包含任何内容。但是 NSMutableDictionaries 的*数量*总是正好是 9，因为数组本身是不可变的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-13T08:14:26.553

我刚刚阅读了您的问题，我想我完全了解您的需求。这是代码：

声明一个属性：

```
@property (nonatomic, retain) NSMutableArray *myArray; 
```

合成它：

```
@synthesize myArray = _myArray; 
```

像这样覆盖它的吸气剂：

```
- (NSMutableArray *)myArray
{
    if (!_myArray)
    {
        _myArray = [[NSMutableArray alloc] initWithCapacity:9];

        for (int i = 0; i < 9; i++)
        {
            [self.myArray addObject:[NSNull null]];
        }
    }

    return _myArray;
} 
```

“setBlankArray”方法将简单地将属性设置为 nil，下次调用数组属性的 getter 时，它将自动按照您的需要进行初始化：

```
- (void)setBlankArray:(NSMutableArray *)array
{
    self.myArray = nil;
} 
```

非常重要：不要编写此代码：

```
for (int i = 0; i < 9; i++)
{
   [self.myArray addObject:[NSNull null]];
} 
```

在刚才提到的方法中，因为这将使数组包含 18 个元素。

然后编写其他2个方法：

```
// you can also change the parameter from "id" to "TileView *"
- (void)addCurrentTile:(id)sender
{
    NSInteger tileIndex = 1; // replace 1 with ((TileView *) sender).getValue - 1

    [self.myArray replaceObjectAtIndex:tileIndex
                            withObject:sender];
}

// you can also change the parameter from "id" to "TileView *"
- (void)removeCurrentTile:(id)sender
{
    NSInteger tileIndex = 1; // replace 1 with ((TileView *) sender).getValue - 1

    [self.myArray replaceObjectAtIndex:tileIndex
                            withObject:[NSNull null]];
} 
```

但是，不要忘记将“id”替换为“TileView *”，并将 tileIndex 的值设置为“((TileView *) sender).getValue - 1”。

希望这一切都有意义，并对您有所帮助。

此致

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:01:59.313

你正在寻找`insertObject:atIndex:`，或者更简单`addObject:`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T21:09:03.683

`[[NSMutableArray alloc] initWithCapacity:9]`不会创建包含 9 个元素的数组。它创建了一个**空**数组，初始化时具有足够的内存来容纳 9 个对象。此方法的目的是在您声明时一次分配那么多内存，因此您可以向该数组添加元素，系统不必每次都分配内存。这仅用于优化。

[NSMutableArray 参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSMutableArray_Class/Reference/Reference.html)

# scala - 如何在 Lift 中反序列化 DateTime

> ID：15980753
> 
> 赞同：4
> 
> 时间：2013-04-12T21:00:49.103
> 
> 标签：scala, datetime, lift, datetime-format

我无法将 org.joda.time.DateTime 字段从 JSON 反序列化为案例类。

JSON：
`val ajson=parse(""" { "creationDate": "2013-01-02T10:48:41.000-05:00" }""")`

我还设置了这些序列化选项：
`implicit val formats = Serialization.formats(NoTypeHints) ++ net.liftweb.json.ext.JodaTimeSerializers.all`

和反序列化：
`val val1=ajson.extract[Post]`

Post 是：
`case class Post(`creationDate`: DateTime){ ... }`

我得到的例外是：

```
 net.liftweb.json.MappingException: No usable value for creationDate
    Invalid date format 2013-01-02T10:48:41.000-05:00 
```

如何将该日期字符串反序列化为 DateTime 对象？

编辑：
这有效：`val date3= new DateTime("2013-01-05T06:24:53.000-05:00")` 它使用与反序列化中的 JSON 相同的日期字符串。这里发生了什么事？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-14T07:57:27.990

似乎这是`DateParser`Lift 默认使用的格式。在深入[研究代码](https://github.com/lift/framework/blob/master/core/json-ext/src/main/scala/net/liftweb/json/ext/JodaTimeSerializer.scala#L65)时，您可以看到解析器`DateParser.parse(s, format)`在将结果传递给构造函数之前尝试使用`org.joda.time.DateTime`.

```
object DateParser {
  def parse(s: String, format: Formats) = 
    format.dateFormat.parse(s).map(_.getTime).getOrElse(throw new MappingException("Invalid date format " + s))
}

case object DateTimeSerializer extends CustomSerializer[DateTime](format => (
  {
    case JString(s) => new DateTime(DateParser.parse(s, format))
    case JNull => null
  },
  {
    case d: DateTime => JString(format.dateFormat.format(d.toDate))
  }
)) 
```

Lift 似乎使用的格式是：`yyyy-MM-dd'T'HH:mm:ss.SSS'Z'`

为了解决这个问题，您可以指定正确的模式并将其添加到您的序列化选项中，或者如果您希望让 JodaTime 构造函数完成所有工作，您可以创建自己的序列化程序，例如：

```
case object MyDateTimeSerializer extends CustomSerializer[DateTime](format => (
  {
    case JString(s) => tryo(new DateTime(s)).openOr(throw new MappingException("Invalid date format " + s))
    case JNull => null
  },
  {
    case d: DateTime => JString(format.dateFormat.format(d.toDate))
  }
)) 
```

然后将其添加到您的格式列表中，而不是`net.liftweb.json.ext.JodaTimeSerializers.all`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-03-31T08:55:46.723

可能不是 100% 优雅，但只有几行，可读性强且有效：

```
val SourISODateTimeFormat = DateTimeFormat.forPattern("YYYY-MM-dd'T'HH:mm:ss.SSSZ")
val IntermediateDateTimeFormat = DateTimeFormat.forPattern("YYYY-MM-dd'T'HH:mm:ss'Z'")

def transformTimestamps(jvalue: JValue) = jvalue.transform {
  case JField(name @ ("createdTime" | "updatedTime"), JString(value)) =>
    val dt = SourceISODateTimeFormat.parseOption(value).get
    JField(name, JString(IntermediateDateTimeFormat.print(dt)))
} 
```

# java - Java中的局部变量或成员变量

> ID：15980756
> 
> 赞同：2
> 
> 时间：2013-04-12T21:01:16.213
> 
> 标签：java, global-variables, local, member-variables

我对 Java 中的局部变量和成员变量有疑问。情况是：有时如果我定义一个局部变量，该变量必须被传递到几个级别的方法调用中。我经常想，我为什么要为类定义一个成员变量，以便该变量在类中的任何地方都可用。类的成员变量就像在类中随处可访问的全局变量。

1.  这种情况的最佳做法是什么？或者什么是正确的做法？

2.  如果我将它定义为成员变量，它应该是静态变量还是非静态变量？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T21:05:08.650

成员变量具有特性——属性是另一个术语——代表程序中由类表示的“事物”。如果您的变量包含类似的内容，请将其设为成员变量；如果没有，不要。

静态变量具有类本身的特征，而不是该类的对象的特征。

不要根据您是否“将...传递给多个级别的方法调用来做出决定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:16:11.010

考虑到您的一般性问题，我根据自己的经验提出了以下准则：

*   使用最小的可能范围。如果局部变量很好，那么为什么要使用成员变量？
*   根据领域对类进行建模。如果您有一个值并且它是类责任的一部分，那么将其建模为类成员似乎是合适的。

对于您的第二个问题：我通常将静态变量定义为 final ，这使它们成为常量。多线程环境中的非最终静态成员可能很容易引入竞争条件。如果需要，更容易使访问非静态成员线程安全。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:04:26.173

1.  如果您决定声明一个成员变量，那么您应该考虑变量范围。如果您只是减少内部方法调用的参数数量，我会考虑将变量声明为**`private`**.

2.  您应该小心使用`Static`，因为该类的每个实例都将使用该变量的相同副本。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T21:04:39.190

这是行为上的。如果您的变量是类属性的一部分，即表征类行为，则将其定义为类成员变量，否则在方法内定义一个局部变量。

在我看来，传递参数对属性类型定义没有贡献。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-12T21:05:38.947

这取决于。

如果您希望所有（或多个）方法访问同一个成员变量，请在类中声明它。

静态与否取决于信息是属于类（静态）还是属于类的实例（非静态）。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-12T21:05:51.607

1.) 如果你打算在多个方法中使用它并且需要传递它，让它的成员变量。如果仅用于该方法，请将其设为本地。

2.)`static`表示它们只是该变量的一个实例，该变量在所有事物中共享。因此，例如，我有一个`totalGameScore`变量，无论如何都会保持我在整场比赛中的得分。你想使那个变量`static`。除此之外，可以说我的`health`敌人有一个变量。每个敌人都有自己的`health`，所以我不会做那个变量`static`。

您还可以声明成员变量`private`，以便其他类无法访问它们。 `Constants`通常应该总是成员变量。

# python - 如何防止 BeautifulSoup4 在汤中添加额外的标签？

> ID：15980757
> 
> 赞同：17
> 
> 时间：2013-04-12T21:01:16.987
> 
> 标签：python, beautifulsoup

在 BeautifulSoup 3 之前的版本中，我可以获取任何 HTML 块并以这种方式获得字符串表示：

```
from BeautifulSoup import BeautifulSoup
soup3 = BeautifulSoup('<div><b>soup 3</b></div>')
print unicode(soup3)
    '<div><b>soup</b></div>' 
```

然而对于 BeautifulSoup4，同样的操作会创建额外的标签：

```
from bs4 import BeautifulSoup
soup4 = BeautifulSoup('<div><b>soup 4</b></div>')
print unicode(soup4)
    '<html><body><div><b>soup 4</b></div></body></html>'
     ^^^^^^^^^^^^                        ^^^^^^^^^^^^^^ 
```

我不需要**`<html><body>..</body></html>`**BS4 添加的外部标签。我查看了 BS4 文档并在类内部进行了搜索，但找不到任何用于抑制输出中额外标签的设置。我该怎么做？降级到 v3 不是一种选择，因为 BS3 中使用的 SGML 解析器不如BS4 中可用的`lxml`或解析器好。`html5lib`

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-12T21:54:22.320

如果您希望您的代码在每个人的机器上工作，无论他们安装了哪个解析器等（基于2.9 和 2.8`lxml`构建的相同版本的行为非常不同，stdlib在 2.7.2 和 2.7 之间有一些根本性的变化.3, ...)，您几乎需要处理所有合法结果。`libxml2``html.parser`

如果你知道你有一个片段，像这样的东西会给你这个片段：

```
soup4 = BeautifulSoup('<div><b>soup 4</b></div>')
if soup4.body:
    return soup4.body.next
elif soup4.html:
    return soup4.html.next
else:
    return soup4 
```

当然，如果你知道你的片段是一个 single `div`，那就更容易了——但是想一个你知道的用例并不容易：

```
soup4 = BeautifulSoup('<div><b>soup 4</b></div>')
return soup4.div 
```

* * *

如果你想知道*为什么*会这样：

`BeautifulSoup`用于解析 HTML 文档。HTML 片段不是有效的文档。它*非常接近于*文档，但这还不足以保证您能准确地取回您所提供的内容。

正如[解析器之间的差异](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#differences-between-parsers)所说：

> HTML解析器之间也存在差异。如果你给 Beautiful Soup 一个格式完美的 HTML 文档，这些差异就无关紧要了。一个解析器会比另一个更快，但它们都会为您提供一个看起来与原始 HTML 文档完全相同的数据结构。
> 
> 但是如果文档的格式不完美，不同的解析器会给出不同的结果。

因此，虽然没有记录这种确切的差异，但它只是一种特殊情况。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:29:29.857

正如旧[BeautifulStoneSoup 文档](http://www.crummy.com/software/BeautifulSoup/bs3/documentation.html#Parsing%20XML)中所述：

> BeautifulSoup 类充满了类似网络浏览器的启发式方法，用于预测 HTML 作者的意图。但是 XML 没有固定的标记集，因此这些启发式方法不适用。所以 BeautifulSoup 不能很好地处理 XML。
> 
> 使用 BeautifulStoneSoup 类来解析 XML 文档。这是一个通用类，没有任何 XML 方言的特殊知识和非常简单的标签嵌套规则......

在[BeautifulSoup4 文档](http://www.crummy.com/software/BeautifulSoup/bs4/doc/#xml)中：

> 不再有用于解析 XML 的 BeautifulStoneSoup 类。要解析 XML，您将“xml”作为第二个参数传递给 BeautifulSoup 构造函数。出于同样的原因，BeautifulSoup 构造函数不再识别 isHTML 参数。

也许这会产生你想要的。

# python - 在空格字符处将列表分解到另一个列表

> ID：15980761
> 
> 赞同：0
> 
> 时间：2013-04-12T21:01:24.193
> 
> 标签：python

我想知道，如何将空间字符的元素列表分解到另一个列表？

例如，该列表包含以下元素：

```
['John', 'House', '23 4500', 'grass', '542 3256'] 
```

至

```
['John', 'House', '23', '4500', 'grass', '542', '3256'] 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-12T21:02:40.117

```
>>> L = ['John', 'House', '23 4500', 'grass', '542 3256']
>>> [y for x in L for y in x.split()]
['John', 'House', '23', '4500', 'grass', '542', '3256'] 
```

或者：

```
>>> from itertools import chain
>>> list(chain.from_iterable(map(str.split, L)))
['John', 'House', '23', '4500', 'grass', '542', '3256'] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:04:40.333

另一种方法：

```
>>> l = ['John', 'House', '23 4500', 'grass', '542 3256'];
>>> m = ' '.join(l).split()
['John', 'House', '23', '4500', 'grass', '542', '3256'] 
```

# sql - SQL Server 2012 使用 LAG 和 ROLLUP 删除字段中的连续重复 - 结果反转

> ID：15980762
> 
> 赞同：2
> 
> 时间：2013-04-12T21:01:24.917
> 
> 标签：sql, sql-server

我有一个我写的查询很好用`WITH ROLLUP`。它有 6 列宽，最后一列包含一个代表订单金额的数字。其他 5 列中的每一列在识别该订单时逐渐变得更加具体，第 5 列是订单号。

该查询显示了我们感兴趣的组织的任何给定“级别”的所有总数。但是，我需要从报告中删除重复数据。没有重复的行，但是每个更通用的列在连续的行中有很多重复的数据。

查询工作正常，生成如下结果：

```
+-----------------------------------------------------------------------------------------------+
¦ Affiliate Company ¦ Affiliate Name ¦ Customer Company ¦ Customer ¦ Order Number ¦ Total Sales ¦
¦-------------------+----------------+------------------+----------+--------------+-------------¦
¦ OL                ¦ Brian          ¦ Customer         ¦ Dennis   ¦ 105773       ¦ $111.60     ¦
¦ OL                ¦ Brian          ¦ Customer         ¦ Steve    ¦ 105776       ¦ $398.75     ¦
¦ OL                ¦ Brian          ¦ Customer         ¦ NULL     ¦ subtotal     ¦ $510.35     ¦
¦ OL                ¦ Brian          ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $510.35     ¦
¦ OL                ¦ NULL           ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $510.35     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ John     ¦ 104686       ¦ $1,228.10   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Julie    ¦ 105701       ¦ $152.64     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jennifer ¦ 104681       ¦ $5.00       ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jennifer ¦ 105766       ¦ $218.79     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 104684       ¦ $2,500.00   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 104691       ¦ $321.28     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105744       ¦ $739.80     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jean     ¦ 104682       ¦ $3,990.00   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 104688       ¦ $1,328.40   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 105699       ¦ $5,112.00   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 105711       ¦ $219.10     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 105758       ¦ $2,202.50   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105739       ¦ $2,278.04   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105769       ¦ $820.84     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105770       ¦ $797.12     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Dee Dee  ¦ 105702       ¦ $2,244.30   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ NULL     ¦ subtotal     ¦ $24,157.91  ¦
¦ ght               ¦ Tom            ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $24,157.91  ¦
¦ ght               ¦ NULL           ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $24,157.91  ¦
¦ NULL              ¦ NULL           ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $24,668.26  ¦
+-----------------------------------------------------------------------------------------------+ 
```

但是，当我将 LAG 添加到混合中以删除重复数据时，我得到了这个：

```
+----------------------------------------------------------------------------------------------------------+
¦ Affiliate Company ¦ Affiliate Name ¦ Customer Company ¦ Customer ¦ Order Number ¦ Total Sales ¦ Previous ¦
¦-------------------+----------------+------------------+----------+--------------+-------------+----------¦
¦ NULL              ¦ NULL           ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $24,668.26  ¦ NULL     ¦
¦ OL                ¦ NULL           ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $510.35     ¦ NULL     ¦
¦ OL                ¦ Brian          ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $510.35     ¦ NULL     ¦
¦ OL                ¦ Brian          ¦ Customer         ¦ NULL     ¦ subtotal     ¦ $510.35     ¦ NULL     ¦
¦ OL                ¦ Brian          ¦ Customer         ¦ Dennis   ¦ 105773       ¦ $111.60     ¦ NULL     ¦
¦ OL                ¦ Brian          ¦ Customer         ¦ Steve    ¦ 105776       ¦ $398.75     ¦ Dennis   ¦
¦ ght               ¦ NULL           ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $24,157.91  ¦ Steve    ¦
¦ ght               ¦ Tom            ¦ NULL             ¦ NULL     ¦ subtotal     ¦ $24,157.91  ¦ NULL     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ NULL     ¦ subtotal     ¦ $24,157.91  ¦ NULL     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ John     ¦ 104686       ¦ $1,228.10   ¦ NULL     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Julie    ¦ 105701       ¦ $152.64     ¦ John     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jennifer ¦ 104681       ¦ $5.00       ¦ Julie    ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jennifer ¦ 105766       ¦ $218.79     ¦ Jennifer ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 104684       ¦ $2,500.00   ¦ Jennifer ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 104691       ¦ $321.28     ¦ Jason    ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105744       ¦ $739.80     ¦ Jason    ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jean     ¦ 104682       ¦ $3,990.00   ¦ Jason    ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 104688       ¦ $1,328.40   ¦ Jean     ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 105699       ¦ $5,112.00   ¦ Random   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 105711       ¦ $219.10     ¦ Random   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Random   ¦ 105758       ¦ $2,202.50   ¦ Random   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105739       ¦ $2,278.04   ¦ Random   ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105769       ¦ $820.84     ¦ Jason    ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Jason    ¦ 105770       ¦ $797.12     ¦ Jason    ¦
¦ ght               ¦ Tom            ¦ Customer         ¦ Dee Dee  ¦ 105702       ¦ $2,244.30   ¦ Jason    ¦
+----------------------------------------------------------------------------------------------------------+ 
```

你可以看到我所做的只是添加了“Previous”列，我的数据现在被反转了。我的意图是我会回去过滤掉所有连续的重复项。但是，像这样反向数据，我无法有效地删除重复项，甚至无法轻松读取结果。关于如何完成我想要做的任何想法？

我的代码如下：

更新：在排序的帮助下，一切都使用以下代码：

```
WITH Names AS (
SELECT 
Customer.CustomerID
, Customer.LastName + ', ' + Customer.FirstName + ' (' + Customer.Email + ')' AS 'Customer'
FROM
Customer
)
SELECT
CASE WHEN (Affiliate.Company = LAG(Affiliate.Company, 1) OVER (ORDER BY Affiliate.Company) AND GROUPING(Affiliate.Name) < 1) THEN NULL ELSE CASE WHEN GROUPING(Affiliate.Name) < 1 THEN Affiliate.Company ELSE Affiliate.Company + ' subtotal:' END END AS 'Affiliate Company'
, CASE WHEN (Affiliate.Name = LAG(Affiliate.Name, 1) OVER (ORDER BY Affiliate.Company, Affiliate.Name) AND GROUPING(CustomerLevel.Name) < 1) THEN NULL ELSE CASE WHEN GROUPING(CustomerLevel.Name) < 1 THEN Affiliate.Name ELSE Affiliate.Name + ' subtotal:' END END AS 'Affiliate Name'
, CASE WHEN (CustomerLevel.Name = LAG(CustomerLevel.Name, 1) OVER (ORDER BY Affiliate.Company, Affiliate.Name, CustomerLevel.Name) AND GROUPING(Names.Customer) < 1) THEN NULL ELSE CASE WHEN GROUPING(Names.Customer) < 1 THEN CustomerLevel.Name ELSE CustomerLevel.Name + ' subtotal:' END END AS 'Customer Company'
, Names.Customer AS 'Customer'
, CASE GROUPING(Orders.OrderNumber) WHEN 1 THEN CASE WHEN GROUPING(Affiliate.Company) = 1 THEN 'GRAND TOTAL' ELSE 'subtotal' END ELSE CONVERT(VARCHAR,Orders.OrderNumber) END AS 'Order Number'
, '$' + CONVERT(VARCHAR,CONVERT(MONEY,SUM(Orders.OrderSubtotal)),1) AS 'Total Sales'
FROM            Orders INNER JOIN
                         Affiliate ON Orders.AffiliateID = Affiliate.AffiliateID INNER JOIN
                         Customer ON Orders.CustomerID = Customer.CustomerID INNER JOIN
                         CustomerLevel ON Customer.CustomerLevelID = CustomerLevel.CustomerLevelID INNER JOIN
                         Names ON Customer.CustomerID = Names.CustomerID
GROUP BY
Affiliate.Company
, Affiliate.Name
, CustomerLevel.Name
, Names.Customer
, Orders.OrderNumber
WITH ROLLUP
HAVING
GROUPING(Orders.OrderNumber) < 1
OR
GROUPING(Names.Customer) = 1
OR
GROUPING(Affiliate.Company) = 1
OR
GROUPING(Affiliate.Name) = 1
OR
GROUPING(CustomerLevel.Name) = 1
ORDER BY
CASE WHEN Affiliate.Company IS NULL THEN 1 ELSE 0 END
, Affiliate.Company
, CASE WHEN Affiliate.Name IS NULL THEN 1 ELSE 0 END
, Affiliate.Name
, CASE WHEN CustomerLevel.Name IS NULL THEN 1 ELSE 0 END
, CustomerLevel.Name
, CASE WHEN Names.Customer IS NULL THEN 1 ELSE 0 END
, Names.Customer 
```

更新：如果有人感兴趣，这里是删除所有不必要的连续重复的结果：

```
+-------------------+-----------------+--------------------+----------+--------------+-------------+
| Affiliate Company | Affiliate Name  |  Customer Company  | Customer | Order Number | Total Sales |
+-------------------+-----------------+--------------------+----------+--------------+-------------+
| OL                | Brian           | Customer           | Dennis   | 105773       | $111.60     |
| NULL              | NULL            | NULL               | Steve    | 105776       | $398.75     |
| NULL              | NULL            | Customer subtotal: | NULL     | subtotal     | $510.35     |
| NULL              | Brian subtotal: | NULL               | NULL     | subtotal     | $510.35     |
| WYN-OL subtotal:  | NULL            | NULL               | NULL     | subtotal     | $510.35     |
| ght               | Tom             | Customer           | John     | 104686       | $1,228.10   |
| NULL              | NULL            | NULL               | Julie    | 105701       | $152.64     |
| NULL              | NULL            | NULL               | Jennifer | 104681       | $5.00       |
| NULL              | NULL            | NULL               | Jennifer | 105766       | $218.79     |
| NULL              | NULL            | NULL               | Jason    | 104684       | $2,500.00   |
| NULL              | NULL            | NULL               | Jason    | 104691       | $321.28     |
| NULL              | NULL            | NULL               | Jason    | 105744       | $739.80     |
| NULL              | NULL            | NULL               | Jean     | 104682       | $3,990.00   |
| NULL              | NULL            | NULL               | Random   | 104688       | $1,328.40   |
| NULL              | NULL            | NULL               | Random   | 105699       | $5,112.00   |
| NULL              | NULL            | NULL               | Random   | 105711       | $219.10     |
| NULL              | NULL            | NULL               | Random   | 105758       | $2,202.50   |
| NULL              | NULL            | NULL               | Jason    | 105739       | $2,278.04   |
| NULL              | NULL            | NULL               | Jason    | 105769       | $820.84     |
| NULL              | NULL            | NULL               | Jason    | 105770       | $797.12     |
| NULL              | NULL            | NULL               | Dee Dee  | 105702       | $2,244.30   |
| NULL              | NULL            | Customer subtotal: | NULL     | subtotal     | $24,157.91  |
| NULL              | Tom subtotal:   | NULL               | NULL     | subtotal     | $24,157.91  |
| ght subtotal:     | NULL            | NULL               | NULL     | subtotal     | $24,157.91  |
| NULL              | NULL            | NULL               | NULL     | GRAND TOTAL  | $24,668.26  |
+-------------------+-----------------+--------------------+----------+--------------+-------------+ 
```

我知道这样的事情通常最好用 SQL 以外的语言来完成。但是，目前在项目中这不是一个选项。我要么在 SQL 中完成，要么我们必须处理“额外”数据。

*表扬[http://www.sensefulsolutions.com/2010/10/format-text-as-table.html](http://www.sensefulsolutions.com/2010/10/format-text-as-table.html)的表格格式化工具！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:53:34.723

正如其他人已经说过的那样，SQL Server（或与此相关的任何 RDBMS）不对输出顺序做出任何保证，除非您使用`ORDER BY`最外层的子句指定所需的输出顺序`SELECT`。如果`ORDER BY`指定 no，则执行计划更改可以更改输出顺序。即使是查询执行时可用（= 非忙碌）处理器的数量也会影响输出顺序。

`GROUP BY`不需要引擎对数据进行排序。如果数据集足够大，SQL Server 将使用 Hash-Aggregate 而不是 Stream-Aggregate。如果发生这种情况，行将按随机顺序返回。同样，如果您需要按特定顺序排列的行，则需要使用`ORDER BY`.

该`LAG()`函数的结果与最终的行顺序无关。它只受它自己的`OVER()`子句中指定的顺序的影响。你甚至可以有多个`LAG`s 使用不同的顺序。

这意味着，您可能想要在当前行的值和`LAG`ed 值之间进行的任何比较仍然是正确的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:53:26.593

这应该有效：

```
WITH Names AS (
SELECT 
Customer.CustomerID
, Customer.LastName + ', ' + Customer.FirstName + ' (' + Customer.Email + ')' AS 'Customer'
FROM
Customer
)
SELECT
Affiliate.Company AS 'Affiliate Company'
, Affiliate.Name AS 'Affiliate Name'
, CustomerLevel.Name AS 'Customer Company'
, Names.Customer as 'Customer'
, CASE GROUPING(Orders.OrderNumber) WHEN 1 THEN 'subtotal' ELSE CONVERT(VARCHAR,Orders.OrderNumber) END AS 'Order Number'
, '$' + CONVERT(VARCHAR,CONVERT(MONEY,SUM(Orders.OrderSubtotal)),1) AS 'Total Sales'
, LAG(Names.Customer, 1) OVER (ORDER BY Affiliate.Company, Affiliate.Name, CustomerLevel.Name, Names.Customer) AS 'Previous'
FROM            Orders INNER JOIN
                         Affiliate ON Orders.AffiliateID = Affiliate.AffiliateID INNER JOIN
                         Customer ON Orders.CustomerID = Customer.CustomerID INNER JOIN
                         CustomerLevel ON Customer.CustomerLevelID = CustomerLevel.CustomerLevelID INNER JOIN
                         Names ON Customer.CustomerID = Names.CustomerID
GROUP BY
Affiliate.Company
, Affiliate.Name
, CustomerLevel.Name
, Names.Customer
, Orders.OrderNumber
WITH ROLLUP
HAVING
GROUPING(Orders.OrderNumber) < 1
OR
GROUPING(Names.Customer) = 1
OR
GROUPING(Affiliate.Company) = 1
OR
GROUPING(Affiliate.Name) = 1
OR
GROUPING(CustomerLevel.Name) = 1
ORDER BY     
    GROUPING(Affiliate.Company),
    GROUPING(Affiliate.Name),
    GROUPING(CustomerLevel.Name),
    GROUPING(Names.Customer) 
```

# php - 为什么 PHP preg_match 返回空？

> ID：15980765
> 
> 赞同：2
> 
> 时间：2013-04-12T21:01:38.307
> 
> 标签：php, regex, vimeo

```
// gets video ID from URL
$url = "http://vimeo.com/12345678";
preg_match("/vimeo.*\/(\d+)/i", $url, $vimeoID);
var_dump($vimeoID); 
```

变量转储：

```
array(0) {
} 
```

它[在这里](http://www.switchplane.com/awesome/preg-match-regular-expression-tester?pattern=/vimeo.%2a%5C/%28%5Cd%2b%29/i&subject=vimeo.com/124565)工作，所以我错过了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:03:36.030

对我来说按预期工作。我明白了。。

```
array(2) {
 [0]=>
 string(18) "vimeo.com/12345678"
 [1]=>
 string(8) "12345678"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:05:34.373

更具体地使用您的正则表达式以防止贪婪表达式：

```
preg_match(":vimeo.\w{2,4}/(\d+):i", $url, $vimeoID); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:51:38.073

尝试这个： `preg_match("/vimeo\.com\/([0-9]{1,})/i", $url, $vimeoID);`

# google-analytics - 有没有人用 iOS 实现了最新的谷歌分析

> ID：15980772
> 
> 赞同：1
> 
> 时间：2013-04-12T21:02:09.187
> 
> 标签：google-analytics, google-analytics-api

我在这里使用了分步说明： [https ://developers.google.com/analytics/devguides/collection/ios/v2/#initialize](https://developers.google.com/analytics/devguides/collection/ios/v2/#initialize)

但是我的打击仍然没有被记录下来。我可以在调试窗口中看到它说一些关于调度号码的信息并重新开始跟踪。

我的另一个担心是他们分配给跟踪器然后从未使用它。我是不是错过了什么。有人请阐明一下。

我查看了互联网，所有旧的和指的是只有两个文件的旧谷歌分析库。GANTracker.h 和 libGoogleAnalytics.a

新库有一堆文件，因此他们实现的方式。代码非常简单，我不知道它没有跟踪点击。

是的，我已经创建了跟踪 ID，并且我熟悉 Google Analytics，因为我过去使用它来跟踪我的网站和博客。如果有人能给我一些正确的指示，我将不胜感激。谢谢。

由于日志窗口有很多信息，我创建了一个“粘贴” [http://pastie.org/7468881](http://pastie.org/7468881)

# java - JavaCV Grabber 网络摄像头只能在我的电脑上运行？

> ID：15980778
> 
> 赞同：0
> 
> 时间：2013-04-12T21:02:36.793
> 
> 标签：java, javacv, image-capture

因此，我使用此代码创建了一个可执行 JAR，并且在我的机器上一切正常，但是我在其他一些计算机上对其进行了测试，并且网络摄像头捕获从未开始。指示灯不亮。这是我在大多数教程中看到的用于进行图像捕获的示例，并且我正在进行面部识别，因此使用 javaCV 函数而不是添加另一个库是最简单的。所有建议表示赞赏，谢谢。

```
 CanvasFrame canvas = new CanvasFrame("Webcam");
    //Set Canvas frame to close on exit
    canvas.setDefaultCloseOperation(javax.swing.JFrame.EXIT_ON_CLOSE);
    try {
        //Start grabber to capture video
        grabber.start();
        //Declare img as IplImage
        IplImage img;
        long starttime = System.currentTimeMillis();
        while (temptime < 4000) {
            //inser grabed video fram to IplImage img
            img = grabber.grab();
            //Set canvas size as per dimentions of video frame.
            canvas.setCanvasSize(grabber.getImageWidth(), grabber.getImageHeight());
            if (img != null) {
                //Flip image horizontally
                cvFlip(img, img, 1);
                //Draw text over the canvas
                Graphics g = canvas.createGraphics();
                g.setFont(camfont);
                g.setColor(Color.red);
                //Show video frame in canvas
                canvas.showImage(img);
                if (temptime > 2000 && tempcount == 1) {
                    //take and save the picture
                    cvSaveImage("User-cap.jpg", img);
                    tempcount++;
                }
                temptime = System.currentTimeMillis() - starttime;
            }
        }
    } catch (Exception e) {
    }
    try {
        grabber.stop();
        canvas.dispose();
    } catch (Exception e) {
        System.out.println("Grabber couldn't close.");
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T08:54:45.123

您需要在运行该程序的机器上安装 OpenCV，jar 仅包含 javacv 包装器，但不包含 opencv 的 dll

# jquery - JQuery 插入的 HTML 导致与纯 HTML 不同的对齐方式

> ID：15980781
> 
> 赞同：0
> 
> 时间：2013-04-12T21:02:56.950
> 
> 标签：jquery, html, css, twitter-bootstrap

注意：请参阅 Brandson 的以下评论，这是正确的答案。

我有一个简单的表格，允许用户输入多种语言（英语、法语、西班牙语等）及其相应的级别（如招聘网站）。每种语言及其级别都由以下代码表示：

```
<div class="form-inline" style="position: relative; left: 105px; padding-top: 20px;">
        <label>Language&nbsp;<span>*</span></label>
        <input type="text" name="languages[]" class="input-medium" style="margin-left: 16px;" value="french" readonly>
        <label style="padding-left: 107px; padding-right: 15px">Level&nbsp;<span>*</span></label>
        <select>
            <option>beginner</option>
            <option>intermediate</option>
            <option>fluent</option>
            <option>bilingual</option>
        </select>
</div> 
```

JQuery 代码如下：

```
 $("#language_add_btn").click(function () {
            $("#language_add_btn").before(createEmptyLanguagePart());
        }); 
```

**如果我像以前**一样使用 jQuery 方法将这段代码添加到某个按钮之前，结果对齐方式与我直接将这些 HTML 代码放在按钮代码之前的结果对齐方式不同。我使用**firefox webtools**检查源代码和 dom 结构，但无法找出问题所在。谁能帮我 ？非常感谢 ！PS：你可能注意到了，我使用的是**Tweeter Bootstrap** HTML&CSS 框架。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:30:12.520

我的意思是元素之间是否存在空格很重要。如果你有`<label>...</label><input />`它会呈现不同的`<label>...</label> <input />`（注意元素之间的空间）。当人们“直接”将 HTML 放入您的 HTML 文件时，他们往往会在其中放入空格（换行符等），但当它是 JavaScript 中的字符串时，人们往往会忽略空格，有时这会导致呈现差异。

是的，HTML 文件中的空格也会影响渲染。请记住，这不是空格的数量。这是空白的存在：

这与以下内容相同：

```
<span>a</span> <span>b</span> 
```

作为：

```
<span>a</span>      <span>b</span> 
```

和：

```
<span>a</span>
<span>b</span> 
```

这呈现不同：

```
<span>a</span><span>b</span> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:41:20.917

布兰登在他的回答中对这个案例是正确的。在使用列表元素编写菜单时，我遇到过几次类似的情况。

```
<ul>
    <li>One</li>
    <li>Two</li>
    <li>Three</li>
</ul> 
```

`display:inline-block;`当添加到列表 css 属性时，上面的代码将在列表元素之间呈现空格。

[这篇文章](http://css-tricks.com/fighting-the-space-between-inline-block-elements/)很好地解释了这个问题，甚至提供了一些简单但有效的修复。

也许将来对某人有用:)

# jquery - 如何初始化 Foundation 3 以使用 Orbit？

> ID：15980783
> 
> 赞同：3
> 
> 时间：2013-04-12T21:03:08.427
> 
> 标签：jquery, zurb-foundation, orbit

我正在尝试使用我在[这个问题](https://stackoverflow.com/a/15545241/1469799)中找到的脚本在 Foundation 3 中运行 Orbit，但我无法让它正确初始化。我在页脚中添加了这个脚本，在页眉中添加了 Foundation.min.js。我在控制台的第 3 行收到 no method 'foundation' 错误，它不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-13T05:15:59.977

您链接到的那个 SO 线程中的脚本对您不起作用，因为它使用 Foundation 4。Orbit 在 Foundation 3 (F3) 中以不同方式初始化。所以假设你有一个 id 元素`orbitX`。你像这样初始化它：

```
$("#orbitX").orbit(); 
```

在您问的另一个 SO 问题中

> 您会在哪里添加其他设置？

当你像这样初始化你的轨道元素时你会这样做：

```
$("#orbitX").orbit({
    bullets: false; // to hide the bullets
}); 
```

这是完整的选项集

```
$('#orbitX').orbit({
  animation: 'fade',                  // fade, horizontal-slide, vertical-slide, horizontal-push
  animationSpeed: 800,                // how fast animtions are
  timer: true,                        // true or false to have the timer
  resetTimerOnClick: false,           // true resets the timer instead of pausing slideshow progress
  advanceSpeed: 4000,                 // if timer is enabled, time between transitions
  pauseOnHover: false,                // if you hover pauses the slider
  startClockOnMouseOut: false,        // if clock should start on MouseOut
  startClockOnMouseOutAfter: 1000,    // how long after MouseOut should the timer start again
  directionalNav: true,               // manual advancing directional navs
  captions: true,                     // do you want captions?
  captionAnimation: 'fade',           // fade, slideOpen, none
  captionAnimationSpeed: 800,         // if so how quickly should they animate in
  bullets: false,                     // true or false to activate the bullet navigation
  bulletThumbs: false,                // thumbnails for the bullets
  bulletThumbLocation: '',            // location from this file where thumbs will be
  afterSlideChange: function(){},     // empty function
  fluid: true                         // or set a aspect ratio for content slides (ex: '4x3')
}); 
```

# wordpress - IIS 中的输出缓存不适用于 Wordpress php 文件

> ID：15980785
> 
> 赞同：1
> 
> 时间：2013-04-12T21:03:10.330
> 
> 标签：wordpress, caching, iis, outputcache

我为 php 文件启用了输出缓存

```
<configuration>
   <system.webServer>
      <serverRuntime frequentHitThreshold="1" frequentHitTimePeriod="00:00:30" />
      <caching>
         <profiles>
           <add extension="*.php" policy="CacheForTimePeriod" kernelCachePolicy="CacheForTimePeriod" duration="00:00:59" location="Any" varyByQueryString="*" />
         </profiles>
      </caching>
   </system.webServer>
</configuration> 
```

缓存适用于打印时间的 PHP 测试文件

[http://www.ahangbaz.com/time.php](http://www.ahangbaz.com/time.php)

但它不适用于 wordpress（日期打印在第 3 行的页面上）

[http://www.ahangbaz.com/index.php/4002/omega-el-producto/](http://www.ahangbaz.com/index.php/4002/omega-el-producto/)

我没有在 wordpress 中使用任何插件。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-16T17:54:19.730

我对为什么第二个链接没有缓存的猜测是该链接没有*以*.`php`

如果您使用`*`扩展程序，您可能会有更好的运气。但是，这可能会缓存一些您不打算缓存的内容。

另一种选择是使用 Wordpress 插件，例如[W3 Total Cache](http://wordpress.org/extend/plugins/w3-total-cache/)。虽然我没有亲自使用过。

另请参阅：[在 IIS 7 上加速 Wordpress](http://ruslany.net/2008/12/speed-up-wordpress-on-iis-70/)

# c# - 谓词构建器组和/或带有内部外部的查询

> ID：15980789
> 
> 赞同：2
> 
> 时间：2013-04-12T21:03:27.757
> 
> 标签：c#, entity-framework, linq-to-entities, lambda, predicatebuilder

我有一个非常简单的谓词构建器查询，效果很好。我们有一个要搜索的关键字列表，我们遍历这些关键字以查看我们的任何对象属性是否匹配。

```
var predicateSearchText = PredicateBuilder.False<Asset>();
List<string> separatedKeywords = keywords.Split(',').ToList();

foreach (string s in separatedKeywords)
{
   if (s.Length > 0)
   {
      string temp = s;
      predicateSearchText = predicateSearchText.Or(m => m.Notes.Contains(temp));
      predicateSearchText = predicateSearchText.Or(m => m.Description.Contains(temp));
      predicateSearchText = predicateSearchText.Or(m => m.DetailedDescription.Contains(temp));
      predicateSearchText = predicateSearchText.Or(asset => asset.Keywords.Contains(temp));
      predicateSearchText = predicateSearchText.Or(a => a.AssetFiles.Any(x => x.FileName.Contains(temp)));
   }
} 
```

...我做的更进一步：

```
var query = (from a in masterQuery.Where(predicateSearchText); 
```

我得到了我需要的东西 - 只过滤那些我搜索过的关键字。

我需要更改它，以便在我的实体的某个属性中查找所有关键字。所以“notes”字段必须包含正在搜索的每个关键字，或者“description”字段必须包含正在搜索的所有关键字。我认为这涉及内部/外部谓词，但我无法想出它。我尝试过的结果太多了，它应该只给我一个……其他实体不符合标准。我的问题明显吗？我的关键字（其中 6 个）非常独特，我得到了 600 多个项目而不是 1...

```
var predicateSearchText = PredicateBuilder.False<Asset>();
var notesPred = PredicateBuilder.True<Asset>();
var descPred = PredicateBuilder.True<Asset>();
var detdescPred = PredicateBuilder.True<Asset>();
var keywordPred = PredicateBuilder.True<Asset>();
var filesPred = PredicateBuilder.True<Asset>();

foreach (string s in separatedKeywords.Where(xx=>xx.Length > 0))
   descPred.And(m => m.Description.Contains(s));

foreach (string s in separatedKeywords.Where(xx => xx.Length > 0))
   notesPred.And(m => m.Notes.Contains(s));

foreach (string s in separatedKeywords.Where(xx => xx.Length > 0))
   detdescPred.And(m => m.DetailedDescription.Contains(s));

foreach (string s in separatedKeywords.Where(xx => xx.Length > 0))
   keywordPred.And(m => m.Keywords.Contains(s));

foreach (string s in separatedKeywords.Where(xx => xx.Length > 0))
   filesPred.And(a => a.AssetFiles.Any(x => x.FileName.Contains(s)));

predicateSearchText = predicateSearchText.Or(notesPred.Expand());
predicateSearchText = predicateSearchText.Or(descPred.Expand());
predicateSearchText = predicateSearchText.Or(detdescPred.Expand());
predicateSearchText = predicateSearchText.Or(keywordPred.Expand());
predicateSearchText = predicateSearchText.Or(filesPred.Expand()); 
```

然后我做我的：

```
var query = (from a in masterQuery.Where(predicateSearchText); 
```

而且我得到的结果太多，谓词是正确的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-20T05:23:04.883

我今天遇到了同样的问题。将 PredicateBuilder 实例化和 Where() 函数移动到循环内，它将有效地与单独的关键字谓词进行 AND。

```
var predicateSearchText;
List<string> separatedKeywords = keywords.Split(',').ToList();

foreach (string s in separatedKeywords)
{
   if (s.Length > 0)
   {
      predicateSearchText = PredicateBuilder.False<Asset>();

      string temp = s;
      predicateSearchText = predicateSearchText.Or(m => m.Notes.Contains(temp));
      predicateSearchText = predicateSearchText.Or(m => m.Description.Contains(temp));
      predicateSearchText = predicateSearchText.Or(m => m.DetailedDescription.Contains(temp));
      predicateSearchText = predicateSearchText.Or(asset => asset.Keywords.Contains(temp));
      predicateSearchText = predicateSearchText.Or(a => a.AssetFiles.Any(x => x.FileName.Contains(temp)));

      Query = Query.AsExpandable().Where(predicateSearchText);
   }
} 
```

# javascript - Flot 未正确显示时间戳/日期

> ID：15980790
> 
> 赞同：0
> 
> 时间：2013-04-12T21:03:31.407
> 
> 标签：javascript, flot

浮动图未正确显示日期/小时。在 x 轴上有 unix 时间戳的值。

数据：

```
 [[1365712202000,61.39],[1365712510000,60.89],[1365712817000,0]] 
```

浮动配置：

```
 $.plot(plotarea , [
        {
            label: "Value",
            data: dataLine,
            color: "#FF8848",
            lines: { show: true, steps: false },
            points: { show: true },
            grid: { hoverable: true, clickable: true },
            xaxis: { mode: "time", timeformat: "%d/%H/%M" }
        }
    ] 
```

![在此处输入图像描述](https://i.stack.imgur.com/8lQ72.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T23:51:14.890

你的配置是错误的。 `xaxis`并且`grid`不是系列选项，而是情节选项。尝试：

```
$.plot($('#placeholder') ,[{
        label: "Value",
        data: dataLine,
        color: "#FF8848",
        lines: { show: true, steps: false },
        points: { show: true }            
    }],
    {
       grid: { hoverable: true, clickable: true },
       xaxis: { mode: "time", timeformat: "%d/%H/%M" }
    }
); 
```

[在这里](http://jsfiddle.net/9x7aJ/1694/)拉小提琴。

# php - PHP和MySQL - 在某些数值之间显示列的连接

> ID：15980799
> 
> 赞同：-1
> 
> 时间：2013-04-12T21:03:49.843
> 
> 标签：php, mysql

我是 MySQL 和 PHP 的新手，但想知道是否有人可以帮助我完成我为老板做的一个小项目。

我有一个 SQL 数据库（MyDB）和一个包含两列的表（mytable） - 第一列（索引）是 1-10 的自动递增整数，第二列（日期）在的格式`Year-month-day time` `2013-04-12 1326`

我正在尝试创建一个简单的 PHP 页面，它首先获取当前日期（很简单），然后查看表格并显示昨天日期内的行数。例如，如果我有 3 行`2013-04-11 XXXX`和 2 行`2013-04-12 XXXX`（今天是 2013 年 4 月 12 日），页面将显示`3`. （时间并不重要，但我们不能将它从表中删除，因为它是由其他员工的程序之一自动创建的，他拒绝更改它）。

到目前为止，我已经有了我的 php 页面，完成了与数据库的连接并定义了两个变量：

```
$startdate = date('Y'."-".'n'."-".'d'." "."0000");
$enddate = date('Y'."-".'n'."-".'d'." "."2359"); 
```

由于时间戳无关紧要，我已经选择了变量的最小/最大值。我意识到这只会给出当前日期，试图弄清楚如何让它将前一天显示为变量中的日期。

现在我正在尝试创建一个 sql 查询，该查询将计算日期字段落在 startdate 和 enddate 变量（-1 天）内的行数，但不太确定从哪里开始或看起来如何。然后我需要在 PHP 中将其作为变量输出，以便稍后在页面中回显它。

谁能指出我正确的方向？希望这一切都有意义。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:12:17.700

您可以编写一个没有参数的查询来执行此操作（如果它总是只是昨天）。

```
SELECT * FROM <table>
WHERE DATE_FORMAT(<date column>,'%j-%Y') = DATE_FORMAT(DATE_SUB(now(),INTERVAL 1 DAY), '%j-%Y'); 
```

where 子句中的日期函数在性能方面可能不是超级棒

# java - 在java中通过mac终端操作文件

> ID：15980800
> 
> 赞同：1
> 
> 时间：2013-04-12T21:03:56.817
> 
> 标签：java, terminal, text-files

我正在开发一个程序，该程序采用 .doc 或 .pdf 文件并将其转换为 .txt。从那里，我使用 java 扫描仪读取文件并按照我的意愿处理它。为了转换 .doc 和 .pdf 我使用`Runtime.getRuntime().exec("textutil")`来转换文件。

但是，当我尝试转换名称中包含空格的文件时，就会出现问题。它基本上需要一个包含段落问题和答案的文件，然后一次将它们读回给你一个句子，并不完全优雅。这是代码：

```
//it has to do with the space in the file name, i suppose i could just rename each file i plan on using
import java.io.*;
import java.util.Scanner;
import java.util.Arrays;

public class AClass
{
    public static void main(String[] args)
    {
        String fileName="/Users/name/Documents/Quizzes/Finals 1.doc"; // a default string
        try
        {
        String s="textutil -convert txt "+correct(fileName);    //see function correct
        System.out.println(s);    //prints the string, if I copy and paste it into terminal it DOES execute
        Process proc=Runtime.getRuntime().exec(s);         //executes in terminal, don't look into this... it works
    } catch (Exception e) { System.out.println("Conversion failed");}
    File file=new File(fileName);
    Scanner reader=null;
    Scanner keyboard=new Scanner(System.in);
    try
    {
        reader=new Scanner(file);
    }
    catch (FileNotFoundException e)
    {
        System.out.println(e.getMessage());
        System.out.println("Save the file to "+fileName);
        System.exit(0);
    }
    System.out.println("Found the file!");
    System.out.println("Hit enter to read each sentence (otherwise it will quit). \nThe program will notify you when the answer is next\n");

    int qCount=0;                       //just a counter
    while (reader.hasNext())       //not eof
    {
        String line=reader.nextLine().trim();
        String[] sentences;
        //System.out.println(line);
        sentences=breakUp(line);     //break up the entire line into sentences[], this //function DOES work.
        for (int i=0; i<sentences.length; i++)
        {
            String s="";
            if (!(line.equals("") || line.equals("\n")))
            {
                s= keyboard.nextLine();  //hit enter to see each sentence, this loop works
            }
            if (!s.equals("")) //quit on non-null input
            {
                System.out.println("Done");
                System.exit(0);
            }
            if (sentences[i].toLowerCase().indexOf("answer") != -1)     //if answer is in the sentence
            {
                System.out.println("\nThe answer is next, hit enter again to see it");
                keyboard.nextLine();
                System.out.println(sentences[i]);
                qCount++;
            }
            else
            {
                int max=120;                   //simple formatting (output window doesn't //auto \n for lines)
                if (sentences[i].length()<max)
                    System.out.println(sentences[i]);
                else
                {
                    for (int j=0; j<sentences[i].length(); j+=max)
                    {
                        if (j+max>sentences[i].length())
                            System.out.println(sentences[i].substring(j, sentences[i].length()));
                        else
                            System.out.println(sentences[i].substring(j, j+max));
                    }
                }
            }
        }
    }

    System.out.println("End of file");
    System.out.println("Total questions="+qCount);
}

public static String[] breakUp(String line)      //this function works, finds periods
{
    if ((line.equals("") || line.equals(null)) || line.length()<2)
        return new String[] {""};
    String[] tempSents=new String[500];
    int count=0;
    int pos=0;
    int dotPos=line.indexOf(".", pos);
    while (dotPos != -1 && count<tempSents.length)
    {
        tempSents[count]=line.substring(pos, dotPos+1);
        pos=dotPos+1;
        dotPos=line.indexOf(".", pos);
        count++;
    }
    if (count==0)
        return new String[] {line};
    else
    {
        tempSents[count]=line.substring(pos);
        count++;
    }
    return Arrays.copyOf(tempSents, count);
}

public static String correct(String s)   //this function works, it adds a '\' in front of //a space so that when it is passed to the terminal it is proper syntax
{
    for (int i=0; i<s.length(); i++)
    {
        if (s.charAt(i)==' ')
        {
            s=s.substring(0, i)+"\\"+s.substring(i);
            i++;
            if (i<=s.length())
                return s.trim();
        }
    }
    return s.trim();
}
} 
```

同样，当我打印出传递给 exec 的字符串并将其复制并粘贴到终端时，它确实可以正确执行，但是通过运行时命令没有任何反应（对于名称中带有空格的文件，否则它会起作用）。提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:19:01.933

尝试转义文件名中的空格。使用类似的东西`"file\\ name.doc"` 你可以优化你的正确（字符串）方法：`string.replaceAll(" ", "\\ ");`

# linux - 为什么我必须输入“\\\0”才能在zsh中创建一个字符串“\0”？

> ID：15980802
> 
> 赞同：7
> 
> 时间：2013-04-12T21:04:01.240
> 
> 标签：linux, bash, shell, unix, zsh

```
> echo 0
0
> echo \0
0
slu@dev:~
> echo \\0

slu@dev:~    
> echo "\\0"
                   # <--- What!!?
slu@dev:~
> echo \\\0

slu@dev:~
> echo "\\\0"
\0
slu@dev:~
> bash
Executing .bashrc
$ echo "\0"
\0
$ echo "\\0"
\0
$ echo "\\\0"
\\0 
```

我得说，bash 的行为对我来说更有意义。

更多细节：

```
slu@dev:~
> echo "0" | hexdump -C
00000000  30 0a                                             |0.|
00000002
slu@dev:~
> echo "\0" | hexdump -C
00000000  00 0a                                             |..|
00000002
slu@dev:~
> echo "\\0" | hexdump -C
00000000  00 0a                                             |..|
00000002
slu@dev:~
> echo "\\\0" | hexdump -C
00000000  5c 30 0a                                          |\0.|
00000003
slu@dev:~
> echo "\\\\0" | hexdump -C
00000000  5c 30 0a                                          |\0.|
00000003
slu@dev:~
> echo "\\\\\0" | hexdump -C
00000000  5c 00 0a                                          |\..|
00000003
slu@dev:~
> echo "\\\\\\0" | hexdump -C
00000000  5c 00 0a                                          |\..|
00000003
slu@dev:~
> echo "\\\\\\\0" | hexdump -C
00000000  5c 5c 30 0a                                       |\\0.|
00000004 
```

`\0`最大的问题是在 bash 和 zsh 上都没有产生预期结果的值。

更新：

```
slu@dev:~
> echo '0' | hexdump -C
00000000  30 0a                                             |0.|
00000002
slu@dev:~
> echo '\' | hexdump -C
00000000  5c 0a                                             |\.|
00000002
slu@dev:~
> echo '\\' | hexdump -C
00000000  5c 0a                                             |\.|
00000002
slu@dev:~
> echo \\ | hexdump -C
00000000  5c 0a                                             |\.|
00000002
slu@dev:~
> echo '\\0' | hexdump -C
00000000  5c 30 0a                                          |\0.|
00000003 
```

看起来使用单引号有助于获得一致的行为。我希望有人用双引号来解释这种行为。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T21:16:54.307

`-E`使用单引号并在带有标志的 echo 中关闭转义处理。

`echo -E '\0'`应该`\0`在 zsh 和 bash （和破折号）上产生一个。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:27:22.940

这是执行此操作的标准（读取便携式）方式：

```
printf "\0" 
```

无论外壳如何，都应该适用于（类Unix）操作系统。

# php - PHP 准备语句 - 查询返回 true，但它没有在 sql 表中更新

> ID：15980808
> 
> 赞同：0
> 
> 时间：2013-04-12T21:04:32.630
> 
> 标签：php, mysqli, prepared-statement, sql-injection

我正在尝试学习如何从 SQL 注入中使我的 PHP 代码更安全，并且目前正在尝试准备好的语句，但我在完成这项工作时遇到了一些麻烦。我**被**抛出以下错误：

```
Fatal error: Call to a member function prepare() on a non-object in /Applications/XAMPP/xamppfiles/htdocs/Zaptube/classes/class.Article.inc on line 59 
```

**但是在收到此错误后，我将 if 语句从**

```
$stmt = $mysqli->prepare 
```

**至**

```
 $stmt = $this->mysqli->prepare 
```

这将语句返回为 true，但它实际上并没有更新 sql 表。我不完全确定我哪里出错了。

以下是我完整使用的代码，欢迎任何帮助。

类.Article.inc

```
public function insert ($field) {

     if ($stmt = $mysqli->prepare("INSERT INTO articles (section, author, title, story, date_created, genre, youtubeid) values (?, ?, ?, ?, ?, ?, ?)")) {

     /* Bind our params */
     $stmt->bind_param('sssssss', $section, $author, $title, $story, $date_created, $genre, $youtubeid);

     /* Set our params */
     $obj->section = $_POST['section'];
     $obj->author = $_POST['author'];
     $obj->title = $_POST['title'];
     $obj->story = $_POST['story'];
     $obj->date_created = $_POST['date'];
     $obj->genre = $_POST['genre'];
     $obj->youtubeid = $_POST['youtubeid'];                 

     /* Execute the prepared Statement */
   $stmt->execute();

     /* Echo results */
     echo "Inserted {$lastName},{$firstName} into database\n";

     /* Execute second Query */
     $stmt->execute();

     echo "Inserted {$title} into database\n";

     /* Close the statement */
     $stmt->close();
     }
     else {
     /* Error */
     printf("Prepared Statement Error: %s\n", $mysqli->error);
   }

 } 
```

插入.php

```
<?php
$obj = new Article();
    if(isset($_POST['submit'])){

        $fields = array(
        'section'   => array('required' => True),
        'author'  => array('required' => True),
        'title'  => array('required' => True),
        'story'     => array('required' => True),
        'date_created'   => array('required' => True),
        'genre'=> array('required' => True),
        'youtubeid' => array('required' => True),
    );
    // We will check ALL fields, and store here any missing ones
        $missing = array();

        foreach($fields as $field => $definition)
        {
            if (!empty($_POST[$field]))
            {   
                 $obj->section = $_POST['section'];
                 $obj->author = $_POST['author'];
                 $obj->title = $_POST['title'];
                 $obj->story = $_POST['story'];
                 $obj->date_created = $_POST['date'];
                 $obj->genre = $_POST['genre'];
                 $obj->youtubeid = $_POST['youtubeid'];

                // We store the content in the object
                $obj->$field = $_POST[$field];

            }
            else
            {
                // Field is required? If so, its lack is an error
                if (True === $definition['required'])
                    $missing[] = $field;
                    }
                        }
                            if (!empty($missing))
                            {
                                echo "Sorry, field(s) missing: " . implode(',', $missing);
                            } else {
                                $obj->insert($field);
                            }
                 }
?>
<div id="mainContent">
<br/>
<div id="insertform"> <!-- Insert Form Div -->

<div id="formWrap">
    <h2>Add a New Article</h2>
    <div id="form">
    <form action="insert.php" method="post" name="insert" id="comments_form">
    <div class="row">
    <div class="label">Picture</div>
    <div class="input">  
    <input type="file" name="fileField" id="fileField" class="detail" />         
                </div> <!-- end input -->
                <div class="context"></div> <!-- end context -->
                </div> <!-- end .row -->   
    <div class="row">
    <div class="label">Section</div>
    <div class="input"> 
            <select name="section" id="section" class="detail">
                 <?php 
                 $sections = array("Game", "Movie", "Music", "Tv", "Sport");
                    foreach ($sections as $section) {   
                        echo "<option value='$section'>$section</option>";
                    }
                ?>                  </select> 

                </div> <!-- end input -->
                <div class="context"> What are you writing about today? e.g. Movie </div> <!-- end context -->
                </div> <!-- end .row -->
    <div class="row">
    <div class="label">Author</div>
    <div class="input">        
            <input type="input" name="author" id="author" class="detail"/>
                </div> <!-- end input -->
                <div class="context"> e.g. John Smith </div> <!-- end context -->
                </div> <!-- end .row -->   
    <div class="row">
    <div class="label">Title</div>
    <div class="input">        
            <input type="input" name="title" id="title" class="detail"/>
                </div> <!-- end input -->
                <div class="context"> e.g. X-Men Wolverine trailer </div> <!-- end context -->
                </div> <!-- end .row -->                    

    <div class="row">
    <div class="label">Article</div>
    <div class="input">            
            <textarea name="story" id="story" class="detail"></textarea>
                </div> <!-- end input -->
                <div class="context">  </div> <!-- end context -->
                </div> <!-- end .row -->      

    <div class="row">
    <div class="label">Date</div>
    <div class="input">                             
    <? $today = date("l j M Y");  // Monday 13 April 2013 ?>
     <input type="input" name="date_created" id="date_created" class="detail" value="<? echo $today;?>" />
                </div> <!-- end input -->
                <div class="context"> e.g. Monday 1st January 2013 </div> <!-- end context -->
                </div> <!-- end .row --> 

    <div class="row">
    <div class="label">Genre</div>
    <div class="input">                                      
            <input type="input" name="genre" class="detail" id="genre" />
                </div> <!-- end input -->
                <div class="context"> e.g. Movie = Action, Music = Hip Hop Etc. </div> <!-- end context -->
                </div> <!-- end .row -->        

    <div class="row">
    <div class="label">Youtube Id</div>
    <div class="input">                                      
            <input type="input" name="youtubeid" class="detail" id="youtubeid" />
                </div> <!-- end input -->
                <div class="context"> e.g. "oRT_JtSaRHg" please copy the value after "=?" from the youtube URL.</div> <!-- end context -->
                </div> <!-- end .row -->    

            <input type="submit" id="submit" name="submit" value="Submit Message" />
                    <div class="submit"> </div> <!-- end submit -->                
        </form>
</div> <!-- end form -->
</div> <!-- end form wrapper -->

 </div> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:16:59.100

```
/* Set our params */
$section = $_POST['section'];
$author = $_POST['author'];
$title = $_POST['title'];
$story = $_POST['story'];
$date_created = $_POST['date'];
$genre = $_POST['genre'];
$youtubeid = $_POST['youtubeid']; 
```

试试这个或至少将 $obj 的数据分配给您的参数变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:20:34.500

```
public function insert ($field) {

     if ($stmt = $mysqli->prepare("INSERT INTO articles (section, author, title, story, date_created, genre, youtubeid) values (?, ?, ?, ?, ?, ?, ?)")) { 
```

使用此代码将不起作用。方法中没有任何地方`insert()`被`$mysqli`定义，所以你的**整个**数据库链是没有意义的——你正在使用一个未定义的局部变量，因此从这一点开始的所有数据库东西都是没有意义的，例如你有相当于

```
$stmt = null->prepare(....); 
```

这就是为什么`$this->mysqli`让事情开始“工作”。您开始使用真正的数据库句柄，准备/执行开始工作。

如果没有行被更新，那不是 PHP 的问题——您以某种方式错误地编写了查询语句。但是您对查询调用绝对没有错误处理，因此您只是盲目地假设成功。这*不是*编写代码的好方法。始终检查故障。例如

```
$stmt = $this->mysqli->prepare(...) or die($this->mysqli->error);
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ 
```

# forms - 在 C# 中随机顺序的表单之间跳转

> ID：15980812
> 
> 赞同：0
> 
> 时间：2013-04-12T21:05:00.617
> 
> 标签：forms

使用表单创建了一个调查风格的应用程序，它包含 30 个表单。例如，第一页要求用户检查要加载哪些调查，并根据他们的检查打开正确的表单。一切都在一个方向上正常工作。我设置程序的方式是第一页保存静态布尔变量，控制类（Main方法），检查变量是真还是假，然后打开相应的表格。像这样;

```
if (Survey.r == true || Survey.s == true || SurveySelection.M == true )
            {
                Form6 newform6 = new Form6(); 
                Form6.Hide();
                Form6.ShowDialog();

                Form7 newform7 = new Form6(); 
                Form7.Hide();
                Form7.ShowDialog();          

             }
if (Survey.t == true)
            {
                Form12 newform12 = new Form12();
                newform12.Hide();
                newform12.ShowDialog();

            } 
```

等等总共30种形式。每个表单上的下一个按钮只包含 this.Hide()，在它们上面。

问题是如果我要在此调查中添加一个后退按钮，我不知道如何处理它，因为调查不是线性的更合乎逻辑，因为它取决于用户选择的调查类型。

它可以在一个实例中加载表格 4、19、24、26，在另一个实例中加载 3、6、9。我需要帮助或指导实现此逻辑的后退按钮。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T22:15:46.923

三十个表格不是很多。您可以创建一个列表并维护一个指向当前位置的指针。

```
private InitializeKnowSequence()
{
    _formIndex = 0;
    _formsList.Add(new Form2());
    _formsList.Add(new Form2());
    _formsList.Add(new Form3());
    _formsList.Add(new Form4());
}

private void NavigatePrior()
{
    if (_formIndex > 0)
    {
        _formsList[_formIndex--].Hide();
        _formsList[_formIndex].Show();
    }
}

private void NavigateNext()
{
    if(_formIndex<_formsList.Count()-1)
    {                
        _formsList[_formIndex++].Hide();
        _formsList[_formIndex].Show();
    }           
} 
```

然后添加一个 PushForm(Form form) 方法进行逻辑分支转发

```
private void PushForm(Form form)
{
    _formsList.Add(form);
     NavigateNext();
} 
```

# javascript - jQuery RS Carousel - 重命名 rs-carousel div

> ID：15980817
> 
> 赞同：0
> 
> 时间：2013-04-12T21:05:09.433
> 
> 标签：javascript, jquery, css, carousel

如何将 rs-carousel div 重命名为 my_carousel（例如..）？

[http://richardscarrott.github.io/jquery-ui-carousel/](http://richardscarrott.github.io/jquery-ui-carousel/)

非常感谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:08:37.143

简单地拥有一个包含该 id 或类的 div。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:36:23.660

您可以将其替换为以下内容：

```
$("#rs-carousel").attr("id","my_carousel"); 
```

但是，这可能会破坏轮播，因此您将不得不处理它。

# python - 各种角度的正弦/余弦/正切

> ID：15980819
> 
> 赞同：2
> 
> 时间：2013-04-12T21:05:28.373
> 
> 标签：python, math

有没有办法获得角度的确切正切/余弦/正弦（以弧度为单位）？

`math.tan()`//没有给出某些角度的精确值`math.sin()`：`math.cos()`

```
>>> from math import *
>>> from decimal import Decimal
>>> sin(pi) # should be 0
1.2246467991473532e-16
>>> sin(2*pi) # should be 0
-2.4492935982947064e-16
>>> cos(pi/2) # should be 0
6.123233995736766e-17
>>> cos(3*pi/2) # 0
-1.8369701987210297e-16
>>> tan(pi/2) # invalid; tan(pi/2) is undefined
1.633123935319537e+16
>>> tan(3*pi/2) # also undefined
5443746451065123.0
>>> tan(2*pi) # 0
-2.4492935982947064e-16
>>> tan(pi) # 0
-1.2246467991473532e-16 
```

我尝试使用 Decimal()，但这也无济于事：

```
>>> tan(Decimal(pi)*2)
-2.4492935982947064e-16 
```

`numpy.sin(x)`其他三角函数也有同样的问题。

或者，我总是可以创建一个带有值字典的新函数，例如：

```
def new_sin(x):
    sin_values = {math.pi: 0, 2*math.pi: 0}
    return sin_values[x] if x in sin_values.keys() else math.sin(x) 
```

然而，这似乎是一种廉价的绕过它的方法。还有其他方法吗？谢谢！

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T21:16:22.780

将 pi 的准确数值存储在计算机中是不可能的。`math.pi`是可以存储在 Python 浮点数中的最接近 pi 的近似值。`math.sin(math.pi)`返回近似输入的正确结果。

为避免这种情况，您需要使用支持符号算术的库。例如，同情：

```
>>> from sympy import *
>>> sin(pi)
0
>>> pi
pi
>>> 
```

sympy 将对表示 pi 的对象进行操作，并可以给出准确的结果。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:22:54.513

当您处理不精确的数字时，您需要明确地处理错误。`math.pi`(或`numpy.pi`) 不完全`π`是 ，例如，它是最接近 56 位的二进制有理数`π`。而`sin`那个数字的不是`0`。

但它*非常接近*0。同样，`tan(pi/2)`它不是无穷大（或 NaN），而是巨大的，`asin(1)/pi`非常接近 0.5。

因此，即使算法在某种程度上是精确的，结果仍然不准确。

如果您从未阅读过[关于浮点运算的每位计算机科学家都应该了解的](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html)内容，那么您现在应该阅读。

处理这个问题的方法是使用 epsilon-comparisons 而不是到处进行精确比较，并在打印出来时明确地四舍五入，等等。

使用[`decimal.Decimal`](http://docs.python.org/2/library/decimal.html)数字而不是`float`数字使这更容易。首先，您可能以十进制而不是二进制来思考，因此您更容易理解错误并做出决定。其次，您可以明确设置值的精度和其他上下文信息`Decimal`，而`float`始终是 IEEE 双精度值。

*正确*的做法是对算法进行全面的错误分析，适当地传播错误，并在需要的地方使用该信息。*简单*的方法是只选择一些对您的应用程序“足够好”的显式绝对或相对 epsilon（以及无穷大的等价物），并在任何地方使用它。（您可能还希望使用适当的特定领域知识将某些值视为倍数，`pi`而不仅仅是原始值。）

# c# - 检索随机数据库记录

> ID：15980821
> 
> 赞同：0
> 
> 时间：2013-04-12T21:05:38.713
> 
> 标签：c#, sql-server, entity-framework, asp.net-mvc-4, random

使用实体框架（如果相关，EF5）检索“X”个随机记录的最佳方法是什么。“X”的值将根据它的使用位置来设置。

是否有一种方法可以在 EF 中内置，或者最好是下拉结果集，然后使用 C# 随机数函数来拉记录。或者有没有我没有想到的方法？

* * *

如果它是相关的，我有一个表来存储我用于不同用途的图像（图像类型表有一个 FK）。我在主页上的轮播中使用的图像是我想要添加一些变化的图像……因此，它有多“随机”对我来说并不重要。我只是想摆脱总是显示的相同的六张左右的图片。（另外，我对辩论/讨论将图像存储在表中还是本地存储并不感兴趣。）

* * *

解决方案必须是通过 LINQ 语句使用 EF 的解决方案。如果这不是直接可能的，我最终可能会做一些类似于@cmd 在评论中推荐的事情。这很可能是检索记录计数的问题...测试 PK 以确保生成的对象不为空，并构建`LIST`X 个对象的 PK 以传递到前端。轮播延迟加载图像，因此当我构建轮播将使用的列表时，我实际上并不需要图像。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:08:35.013

您可以在查询中添加一个`ORDER BY RAND()`子句吗？

请参阅此相关问题：[MySQL：ORDER BY RAND() 的替代品](https://stackoverflow.com/questions/1823306/mysql-alternatives-to-order-by-rand)

# hosting - 在外部存储图像

> ID：15980830
> 
> 赞同：2
> 
> 时间：2013-04-12T21:06:26.227
> 
> 标签：hosting, storage, bandwidth

我有一个页面，没有那么多带宽，因此我想将图像外部存储在另一台服务器上，该服务器提供无限带宽。关于如何做到这一点的任何建议，或者更好的解决方案？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:13:50.137

[不同服务器上的图像存储](https://stackoverflow.com/questions/7300951/image-storage-on-different-server)

看看这个类似的帖子，Facebook 做到了，Google 做到了，所以它是在另一台服务器上存储图像的首选解决方案。您可以从外部服务器动态或静态地为图像分配链接，这就是您需要做的一切！您需要注意图像如何存储在外部服务器中的层次结构。

# python - 因为我持有十六进制格式的字符串而不编码字符串？

> ID：15980836
> 
> 赞同：1
> 
> 时间：2013-04-12T21:06:49.407
> 
> 标签：python

一般问题是我需要十六进制字符串保持该格式以将其分配给变量而不是保存编码？

不好：

```
>>> '\x61\x74'
'at'
>>> a = '\x61\x74'
>>> a
'at' 
```

效果很好，但不是：

```
>>> '\x61\x74'
'\x61\x74' ????????
>>> a = '\x61\x74'
>>> a
'\x61\x74' ???????? 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T21:10:58.813

使用`r`前缀（[在 SO 上解释](https://stackoverflow.com/a/4780104/882918)）

```
a = r'\x61\x74'
b = '\x61\x74'
print (a) #prints  \x61\x74
print (b) # prints at 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:11:05.483

它是*相同的数据*。Python 允许您使用不同的方法指定文字字符串，其中一种方法是使用转义码来表示字节。

因此，`'\x61'` *是与 相同的字符*值`'a'`。Python 只是选择将可打印的 ASCII 字符显示为可打印的 ASCII 字符而不是转义码，因为这使得使用字节串变得更加容易。

如果您需要*文字*斜杠、`x`字符以及两位数字`6`和`1`字符（因此是长度为 4 的字符串），则需要将斜杠加倍或使用原始字符串。

为了显示：

```
>>> '\x61' == 'a'  # two notations for the same value
True
>>> len('\x61')    # it's just 1 character
1
>>> '\\x61'        # escape the escape
'\\x61'
>>> r'\x61'        # or use a raw literal instead
'\\x61'
>>> len('\\x61')   # which produces 4 characters
4 
```

# jquery - 使用 AJAX/jQuery 加载内容

> ID：15980838
> 
> 赞同：0
> 
> 时间：2013-04-12T21:07:12.953
> 
> 标签：jquery

请参阅[http://www.elitedeafpoker.com/dev/poker-players.html](http://www.elitedeafpoker.com/dev/poker-players.html) - 我尝试使用 AJAX/jQuery 在此页面上加载三个内容，但它不会加载内容（最终，我想使用加载每个内容JSON 调用），但首先我想看看这是否有效，然后再深入使用 JSON。如果这不是使用 AJAX/jQuery 加载内容的最佳方式，请告诉我 - 不胜感激。

HTML

```
<article class="span3">
  <ul class="list-1">
    <li class="navlinks" id="pokerplayers"><a href="#pokerplayers">EDPS Poker Players </a></li>
    <li class="navlinks" id="playerofthemonth"><a href="#playerofthemonth">Players of the Month</a></li>
    <li class="navlinks" id="playeroftheyear"><a href="#playeroftheyear">Players of the Year </a></li>
 </ul>
</article>
<article class="span9">
 <div id="content">
    Contents to load...
 </div>
</article> 
```

Javascript（内容.js）

```
$(document).ready(function(){
$("#pokerplayers").click(function(e){
var page = $(this).attr('href, word: hash');
e.preventDefault(); 
$("#content").load("content.html #pokerplayers");
$(this).hide().fadeIn("slow");
});
$("#playerofthemonth").click(function(e){ 
var page = $(this).attr('href, word: hash');
e.preventDefault(); 
$("#content").load("content.html #playerofthemonth");
$(this).hide().fadeIn("slow");
});
$("#playeroftheyear").click(function(e){
var page = $(this).attr('href, word: hash'); 
e.preventDefault(); 
$("#content").load("content.html #playeroftheyear");
$(this).hide().fadeIn("slow");
});
}); 
```

内容.html

```
<div id="pokerplayers">
   <p class="content-text">Poker Players</p>
</div>
<div id="playerofthemonth">
   <p class="content-text">Player of the Month</p>
</div>
<div id="playeroftheyear">
   <p class="content-text">Player of the Year</p>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:22:05.763

它对我有用，你是通过打开文件还是使用服务器来运行它？像这样运行它时不起作用：

```
file:///C:/Users/xxx/Desktop/stackoverflow/index.html 
```

但是当我将它上传到我的服务器时它工作得很好，看[这里](http://consultingfox.com/stackoverflow/)

# mysql - 使用嵌套的 WHERE 子句？

> ID：15980839
> 
> 赞同：1
> 
> 时间：2013-04-12T21:07:13.163
> 
> 标签：mysql, sql

```
SELECT ymd, 
       creative_id, 
       sum(imps) as imps, 
       sum(booked_revenue_dollars) as booked_rev
  FROM agg_dw_advertiser_publisher_analytics_adjusted
 WHERE buyer_member_id=456
   AND (sum(imps) > 500 WHERE ymd > current_date() - 14) #this part is wrong
 GROUP BY 1,2
HAVING min(ymd) < current_date() - 14
 ORDER BY 2,1 ASC; 
```

ymd = 年/月/日

我试图过滤掉过去 2 周内`creative_id`字段总和`imps`小于 500 的 's 。我显然做的不对，但我尝试过作为附加`HAVING`子句和子查询。我究竟做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:12:34.670

没有这样的概念称为**嵌套 WHERE**。你可以`HAVING`像这样修改你的。

```
SELECT creative_id, 
       sum(imps) as imps, 
       sum(booked_revenue_dollars) as booked_rev
  FROM agg_dw_advertiser_publisher_analytics_adjusted
 WHERE buyer_member_id=456
 GROUP BY creative_id
HAVING sum(imps) > 500 AND min(ymd) > current_date() - 14
 ORDER BY 2,1 ASC; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:34:06.917

像这样的东西（我的头顶）

```
SELECT ymd, creative_id, 
       sq.imps as imps,
       sq.booked_rev as booked_rev
  FROM agg_dw_advertiser_publisher_analytics_adjusted a
  INNER JOIN 
      (
       SELECT creative_id, sum(imps) as imps, sum(booked_revenue_dollars) as booked_rev
       FROM agg_dw_advertiser_publisher_analytics_adjusted
       WHERE buyer_member_id=456 and ymd > current_date() - 14
       GROUP BY creative_id
      ) as sq
    ON  a.creative_id = sq.creative_id
 WHERE buyer_member_id=456 and sq.imps > 500 and ymd > current_date() - 14
 ORDER BY ymd,creative_id ASC; 
```

# jquery - jQUERY 意外的字符串？

> ID：15980842
> 
> 赞同：0
> 
> 时间：2013-04-12T21:07:15.873
> 
> 标签：jquery, ajax

**问题**

我收到意外的字符串错误，但我没有看到任何错误？...

这是我的代码：

```
$(document).ready(function() {

    var search = $("#search");

        $("#bla").click(function() {
            if (search.val() != '') {
                load();
                $.post("ajax_search.php", { search : search.val()}, function(data) {
                    stop_load();
                    $(".result").html(data);
                });
            } 
            else 
            {
                $(".result").html('');
            }
        });
        $("#hover").hover(function() {
            load();
            $.post"ajax_search.php?type=sidebar", { sidebar : seach.val() }, function(get_data) {
                stop_load();
                $("sidebar").html(get_data);
            }
        });     

function load() {
    $('.load').html('<img src="http://i.imgur.com/ZoI4x5I.gif" />');
}
function stop_load(){
    $('.load').html('');
}   
}); 
```

**问题**

基本上，在我删除在

```
 $("#hover").hover(function() { 
```

这是我得到的错误：

未捕获的语法错误：意外的字符串：29

这是第 29 行：

```
 }); 
```

就在之前

```
 $("#hover").hover(function() { 
```

这是什么原因造成的？我做错了什么？谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T21:08:35.933

您的语法`$.post`不正确。您缺少左括号和右括号。

```
$("#hover").hover(function() {
    load();
//        v-- opening parathesis here
    $.post("ajax_search.php?type=sidebar", { sidebar : seach.val() }, function(get_data) {
        stop_load();
        $("sidebar").html(get_data);
//   v-- closing here
    });
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:28:27.300

Just a suggestion for your future post:

Before posting any `javascript/jQuery` code. Please do the folowing:

1.  Visit the site [**jsfiddle.net**](http://jsfiddle.net/)

2.  Then, paste your code in the `javascript` panel.

3.  If it is a jQuery code, select the version from the **Frameworks & Extensions** box on right-side.

4.  Then, click on the button at the top, named `JSHint`.

5.  If there is any error, you will get to know them as red dots on right side.

6.  Fix them and again click on `JSHint`.

7.  Finally, if you get a message like below :

> JSLint Valid! Good work! Your JavaScript code is perfectly valid.

Then run the code on your local machine once again and still if you are getting any error, then post your question on SO. No offence!

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-12T21:08:43.007

你失踪`(`了`)`

```
 $.post("ajax_search.php?type=sidebar", { sidebar : seach.val() }, function(get_data) {
                stop_load();
                $("sidebar").html(get_data);
 }); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-12T21:08:59.117

您的`post()`方法缺少括号。

这个：

```
$.post "ajax_search.php?type=sidebar", {
    sidebar: seach.val()
}, 
```

应该

```
$.post("ajax_search.php?type=sidebar", {
    sidebar: seach.val()
}), 
```

如果您没有使用显示 JS 错误的 IDE，我建议您在使用的任何 Web 浏览器上检查控制台，或者甚至将您的 JS 弹出到[jsfiddle](http://jsfiddle.net)并单击 JSHint。

# django - Django 模型继承——防止子类实例出现在超类管理中

> ID：15980845
> 
> 赞同：0
> 
> 时间：2013-04-12T21:07:27.033
> 
> 标签：django, inheritance

我有两节课：

```
class Article(ContentAsset):

    title =  models.CharField(max_length=2000)
    author =  models.CharField(max_length=2000, blank=True)
    source = models.CharField(max_length=2000, default="")
    datePublished = models.DateField(default=datetime.now)

    def __unicode__(self):
        return self.title 
```

和

```
class PubMedArticle(Article):
    pubMedID = models.CharField(max_length=100)
    abstract = models.TextField(max_length=20000) 
```

所有 PubMedArticle 实例在管理界面中出现两次——在所有`PubMedArticle`对象列表和所有对象列表下`Article`。这是正常行为吗？我认为子类通常不会出现在其超类的管理列表中。确保这些`PubMedArticle`对象仅显示在`PubMedArticle`管理员列表下的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:19:42.657

这是正常行为。从数据库的角度来看，表的主键`PubMedArticle`只是指 `Article`表。因此，对于 PubMedArticle 表中的每条记录，都必须是 Article 表中的一条记录。

现在到管理员。有两种方式：

1）使文章模型抽象 - 如果您不需要所有文章的唯一主键，这是一个好主意。2) 自定义 django 管理员列表查询。

# yii - Yii 主题 - 在什么场景下？

> ID：15980850
> 
> 赞同：0
> 
> 时间：2013-04-12T21:07:53.903
> 
> 标签：yii

我们一直在使用 Yii 来构建 Web 应用程序。有时，**主题**会出现在我们的讨论桌上。

但是，如果我们有一个 Web 应用程序并且我们只想更改外观，我们也可以更改**public_html**文件夹，因为结构将是相似的。

我们在拥有主题时看到的唯一一点是，我们可能希望动态地（用户通过单击“更改布局按钮”进行选择）更改应用程序的外观和感觉。

是否有人将**主题**用于任何其他建议或配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T09:53:33.393

我们使用主题效果很好。我们使用 Yii 应用程序的单个实例来运营 6 个站点。然后根据域名选择主题。

是的，我们可以只使用 6 个不同的应用程序文件夹并分别提供它们。不过，这有几个优点，如果它们与您无关，您可能已经忽略了它们，但这里它们是：

*   共享代码、更新和维护要容易得多
*   添加一个新主题更干净IMO（只是一个新的主题文件夹而不是整个应用程序目录）
*   全局资产，然后在主题中很容易被覆盖，而不是完全抹去它们，你正在扩展它们。
*   共享缓存，整个应用程序缓存到单个目录，视图缓存，数据缓存等。
*   共享资产目录，资产只发布一次（尽管理论上可以在复制环境中设置）

我更喜欢这种设置，它看起来更干净只是**覆盖**而不是**覆盖**。另外，真的，我想不出复制整个目录会比这种方法更好的原因，是的，主题中存在必须解决的问题，但复制整个源代码并不能解决它们。

# php - url 友好的用户名函数，检查 db，如果它是唯一的

> ID：15980862
> 
> 赞同：0
> 
> 时间：2013-04-12T21:08:45.370
> 
> 标签：php, codeigniter, loops

我正在尝试在 codeigniter 中创建一个使用户名“对 url 友好”的函数。它必须全部小写，替换丹麦字符`æ, ø, å with ae, oe, aa`，然后进行数据库检查它是否是唯一的，例如，如果有一个名为的用户`ægir`和一个名为的用户`aegir`。如果它已经存在，我只想添加一个数字，然后再次检查。

这是我到目前为止所拥有的：

```
public function url_username($username)
{
    for($i = 1, "What should i write here?", "What about here?")
    {
        $url_username = str_replace(array('æ','ø','å'),array('ae','oe','aa'),strtolower($username));
        $this->db->select('url_username')->from('users')->where('url_username',$username);
        $q = $this->db->get();

        if($q > 0)
        {
            "what should i write here?"
        }
    }
} 
```

如果有人能帮我完成这件事，我将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:21:03.107

```
public function url_username($username)
{
    $url_username = str_replace(array('æ','ø','å'),array('ae','oe','aa'),strtolower($username));

    $this->db->select('url_username');
    $this->db->from('users');
    $this->db->like('url_username', $url_username, 'after');
    $this->db->order_by('url_username', 'desc');
    $this->db->limit(1);
    $q = $this->db->get();

    if($q->num_rows() > 0)
    {
        // increment the username with the String Helper
        $this->load->helper('string');
        $url_username = increment_string($q->url_username, '_');
    }
    return $url_username;
} 
```

好的，所以我们只需更改查询以查找以 sanitized 开头的任何内容`url_username`。我们为此使用该`like`语句，然后按`url_username`降序排序（意思`myusername_3`是`myusername_2`在结果集中之前）。然后我们只返回第一行（因为它将是最大的递增值）——然后我们只用[String Helper](http://ellislab.com/codeigniter/user-guide/helpers/string_helper.html)递增结尾。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:27:19.957

对@swatkins 的回答稍作修改。可能 tha aegir 和 aegir1 都存在于您的数据库中，因此您需要在之后继续增加该数字以确保您拥有一个唯一的用户名。

```
public function url_username($username)
{
    $url_username = str_replace(array('æ','ø','å'),array('ae','oe','aa'),strtolower($username));
    $this->db->select('url_username')->from('users')->like('url_username', $url_username, 'after');
    $q = $this->db->get();

    if($q->num_rows() > 0)
    {
        $this->load->helper('string');
        return $this->url_username(increment_string($q->url_username, '-', $i));
    }

    return $url_username;
} 
```

# android - 意图不返回数据

> ID：15980881
> 
> 赞同：0
> 
> 时间：2013-04-12T21:10:33.027
> 
> 标签：android, bundle

我正在开发一个 Android 项目，我必须将数据从一个活动发送到另一个活动。但是，当我将数据从一个活动发送到另一个活动时，它不会将数据从一个活动发送到另一个活动。

从其他人接收数据的部分代码是：

```
Intent intent=getIntent();
String str,str1;
str=intent.getExtras().getString("phoneno"); 
Log.d("completre", "complete"); 
phonePhoneno.setText(str);

Log.d("complete","complete1");

if(intent.getExtras()==null) {
    txtMessage.setText("u duffer write program properly");
} else {
    str1=intent.getExtras().toString();
    txtMessage.setText(str1);
    Log.d("complete","complete2");
} 
```

我用于从其他活动发送数据的部分代码是：

```
if(v.getId()==R.id.main_act) {
    String str=txtText.getText().toString();
    Intent intent=new Intent(getApplicationContext(), MainActivity.class);
    intent.putExtra("username",str);
    intent.putExtra("phoneno", phoneno);
    startActivity(intent);
} 
```

当我尝试通过单击按钮接收数据时，它会强制关闭。

在这个项目中，我在第一个活动中进行了两项活动，我正在阅读电话号码。将其发送到第二个活动只是为了将其保存以备将来使用。在第二个活动中，我有一个编辑文本，其中我通过语音识别系统添加文本，之后我通过上面显示的单击按钮将数据电话号码和编辑文本字段从第二个活动发送到第一个活动（在代码的第二部分) . 它正在发送电话号码但不编辑文本内容（猜测），当我单击完成按钮（在第一个活动中填写两个字段）时，它会在电话号码字段中添加电话号码但不添加消息。

应用程序未自行关闭时的最新日志猫

```
 04-13 13:33:46.206: I/TextToSpeech(834): Sucessfully bound to com.svox.pico
04-13 13:33:46.206: W/TextToSpeech(834): speak failed: not bound to TTS engine
04-13 13:33:47.005: I/TextToSpeech(834): Connected to ComponentInfo{com.svox.pico/com.svox.pico.PicoService}
04-13 13:33:47.125: E/test(834): hhhhhhhhhhhhhhhhh
04-13 13:33:47.125: I/Choreographer(834): Skipped 174 frames!  The application may be doing too much work on its main thread.
04-13 13:33:47.575: I/Choreographer(834): Skipped 69 frames!  The application may be doing too much work on its main thread.
04-13 13:33:56.535: W/IInputConnectionWrapper(834): showStatusIcon on inactive InputConnection
04-13 13:33:56.535: I/Choreographer(834): Skipped 174 frames!  The application may be doing too much work on its main thread.
04-13 13:33:56.975: D/dalvikvm(834): GC_CONCURRENT freed 127K, 9% free 3017K/3288K, paused 37ms+5ms, total 108ms
04-13 13:34:00.274: V/(834): Got a contact result: content://com.android.contacts/data/3
04-13 13:34:00.674: V/(834): Got phone no : (986) 743-561
04-13 13:34:00.914: I/Choreographer(834): Skipped 164 frames!  The application may be doing too much work on its main thread.
04-13 13:34:01.244: I/Choreographer(834): Skipped 37 frames!  The application may be doing too much work on its main thread.
04-13 13:34:05.494: I/Choreographer(834): Skipped 139 frames!  The application may be doing too much work on its main thread.
04-13 13:34:05.974: I/Choreographer(834): Skipped 60 frames!  The application may be doing too much work on its main thread.
04-13 13:34:12.965: I/TextToSpeech(834): Sucessfully bound to com.svox.pico
04-13 13:34:12.965: W/TextToSpeech(834): speak failed: not bound to TTS engine
04-13 13:34:13.065: I/TextToSpeech(834): Connected to ComponentInfo{com.svox.pico/com.svox.pico.PicoService}
04-13 13:34:13.155: E/test(834): hhhhhhhhhhhhhhhhh
04-13 13:34:13.155: I/Choreographer(834): Skipped 35 frames!  The application may be doing too much work on its main thread.
04-13 13:34:14.425: I/Choreographer(834): Skipped 308 frames!  The application may be doing too much work on its main thread.
04-13 13:34:15.235: I/Choreographer(834): Skipped 95 frames!  The application may be doing too much work on its main thread.
04-13 13:34:16.265: I/Choreographer(834): Skipped 31 frames!  The application may be doing too much work on its main thread.
 04-13 13:34:20.025: D/completre(834): complete
 04-13 13:34:20.035: D/AndroidRuntime(834): Shutting down VM
 04-13 13:34:20.035: W/dalvikvm(834): threadid=1: thread exiting with uncaught exception (group=0x40a71930)
 04-13 13:34:20.085: E/AndroidRuntime(834): FATAL EXCEPTION: main
 04-13 13:34:20.085: E/AndroidRuntime(834): java.lang.NullPointerException
 04-13 13:34:20.085: E/AndroidRuntime(834):     at com.example.sms.MainActivity.onClick(MainActivity.java:322)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at android.view.View.performClick(View.java:4204)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at android.view.View$PerformClick.run(View.java:17355)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at android.os.Handler.handleCallback(Handler.java:725)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at android.os.Handler.dispatchMessage(Handler.java:92)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at android.os.Looper.loop(Looper.java:137)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at android.app.ActivityThread.main(ActivityThread.java:5041)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at java.lang.reflect.Method.invokeNative(Native Method)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at java.lang.reflect.Method.invoke(Method.java:511)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
 04-13 13:34:20.085: E/AndroidRuntime(834):     at dalvik.system.NativeStart.main(Native Method) 
```

我想在这里提到的更多事情是，当我从第二个活动返回到主要活动而不记录任何消息时，我没有设置编辑文本的内容，并且我尝试将内容发送到第一个活动，如第二部分所示它工作的代码......理想情况下它应该强制关闭自己，因为编辑文本没有数据......我不明白为什么当时它不强制关闭自己。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:16:17.200

**捆绑使用**：

使用它从您的变量中获取变量`Intent`：

```
Intent intent = getIntent();
final Bundle bundle = intent.getExtras();
if(bundle != null) {
    String username = bundle.getString("username");
    String phoneno = bundle.getString("phoneno");
} 
```

**强制关闭**：

*   确保变量`str`和`phoneno`不`null`适合您的`intent.putExtra()`命令。这可能会导致您的力量关闭。
*   确保`id`“main_act”是在 XML 布局文件中为您的按钮定义的***唯一***ID。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-13T14:24:46.220

好吧，经过一番挖掘，我发现了问题所在......

该问题与`Bundle`.

问题是你试图打电话`setText()`和`getText()`打电话。该字段从未在.`EditText``phonePhoneno``onCreate``MainActivity`

所以，要解决这个问题，在你的for`NullPointerException`中初始化`phonePhoneno`为正确的，你很好;-)`EditText``main.xml``MainActivity`

也许它应该像这样初始化？

```
phonePhoneno = (EditText) findViewById(R.id.phonenofromcontact); 
```

我不知道？

老实说，这看起来像是一种类型或“自动完成”错误：P

只是一个小建议：清理你的代码，你可能已经`Exception`自己找到了;-)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-13T15:29:16.003

David Manperl 说你做错了什么是正确的，你的意思是在 Intent 的地方发生了变化。如果你有一个意图没有帮助，你可以使用另一种方式。还有其他方法可以将数据传递给另一个活动。

例如：

1.  [共享首选项](http://developer.android.com/reference/android/content/SharedPreferences.html)

2.  不过，Application 对象是另一种方式，在处理跨多个活动的相同状态（而不是必须在任何地方获取/放置它）或比原语和字符串更复杂的对象时，它有时更容易。您可以扩展应用程序，然后在那里设置/获取您想要的任何内容，并使用 getApplication() 从任何 Activity（在同一应用程序中）访问它。

或者尝试在Activity的onCreate方法中从Intent中获取数据

# pentaho - Pentaho MDX 角色

> ID：15980891
> 
> 赞同：0
> 
> 时间：2013-04-12T21:11:15.330
> 
> 标签：pentaho, mondrian

我尝试在 pentaho jpivot
1 中创建一些限制。我有 2 个用户（user1 - role1 和 user2 - role2）
2\. 我有一个带有这个值的轴

```
商店 | 所有者 | 销售量
 ---------------------
 s1 | 用户1 | 1235
       | 用户2 | 2684
 s2 | 用户1 | 1628
       | 用户2 | 1002
 s3 | 用户1 | 1111
       | 用户2 | 1596
...

```

我的架构看起来像这样：

```
<Schema name="asimov1">
  <Dimension type="StandardDimension" visible="true" foreignKey="owner" name="owner">
   <Hierarchy name="owner" visible="true" hasAll="false" primaryKey="owner" primaryKeyTable="storeTable">
     <Level name="owner" visible="true" table="storeTable" column="owner" uniqueMembers="false">
     </Level>
   </Hierarchy>
 </Dimension>
 <Dimension type="StandardDimension" visible="true" foreignKey="store1" name="store1">
  <Hierarchy name="store1" visible="true" hasAll="true" primaryKey="store1" primaryKeyTable="storeTable">
     <Level name="store1" visible="true" table="storeTable" column="store1" uniqueMembers="false">
     </Level>
  </Hierarchy>
</Dimension>
<Cube name="asimov1" caption="asimov1" visible="true" description="asimov1"  cache="true" enabled="true">
  <Table name="storeTable">
  </Table>
  <DimensionUsage source="store1" name="store1" visible="true" foreignKey="store1">
  </DimensionUsage>
  <DimensionUsage source="owner" name="owner" visible="true" foreignKey="owner">
  </DimensionUsage>
  <Measure name="sales" column="sales" formatString="#" aggregator="sum">
  </Measure>

 </Cube>
</Schema> 
```

我的选择：

```
select NON EMPTY Crossjoin({[owner].[owner].Members}, {[Measures].[sales]}) ON COLUMNS,
NON EMPTY {[store].[store].Members} ON ROWS
from [role_test] 
```

我希望当我以 user1 身份登录时只看到 user1 的值，所以对于 user2。

我使用 xaction 添加了 where 子句，但如果访问 jpivot OLAP 导航器，user1 仍然可以看到 user2 的值。

我将 visible="false" 添加到维度所有者，但没有效果。我制作了没有效果的角色。

```
<Role name="user1">
<SchemaGrant access="none">
  <CubeGrant cube="asimov1" access="all">
    <HierarchyGrant hierarchy="owner" topLevel="owner" bottomLevel="owner" access="custom">
      <MemberGrant member="[owner].[user1]" access="all">
      </MemberGrant>
      <MemberGrant member="[owner].[user2]" access="none">
      </MemberGrant>
    </HierarchyGrant>
  </CubeGrant>
</SchemaGrant> 
```

……

就是这样，所以请给一些指导。

最好的问候， dga

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T19:26:33.410

一切都很好，除了这个：

在使用角色之前，必须在**biserver-ce/pentaho-solutions/system/pentahoObjects.spring.xml中取消注释此行**

```
<bean id="Mondrian-UserRoleMapper" 
    name="Mondrian-One-To-One-UserRoleMapper"  
    class="org.pentaho.platform.plugin.action.mondrian.mapper.MondrianOneToOneUserRoleListMapper" 
    scope="singleton" /> 
```

# php - 我的页面需要很长时间才能加载，我无法进入

> ID：15980892
> 
> 赞同：-2
> 
> 时间：2013-04-12T21:11:18.510
> 
> 标签：php, html

我在 20 分钟前问过这个问题，但是当我插入代码时，网站需要很长时间才能加载。10 分钟后，我收到以下错误消息：

```
Warning: mysql_connect(): MySQL server has gone away in C:\xampp\htdocs\ShareLife\inc\scripts\mysql_connect.inc.php on line 11  

Warning: mysql_connect(): Error while reading greeting packet. PID=2252 in C:\xampp\htdocs\ShareLife\inc\scripts\mysql_connect.inc.php on line 11  

Warning: mysql_connect(): MySQL server has gone away in C:\xampp\htdocs\ShareLife\inc\scripts\mysql_connect.inc.php on line 11  

Fatal error: Maximum execution time of 30 seconds exceeded in C:\xampp\htdocs\ShareLife\inc\scripts\mysql_connect.inc.php on line 11 
```

**使用以下代码：**

```
<?php
$conn_error = 'Colud not connect.';

$mysql_host = "localhost:8080";
$mysql_user = "liam";
$mysql_pass = "";

$mysql_db = 'socialnetwork';

mysql_connect($mysql_host, $mysql_user, $mysql_pass) or die("Couldn't Connect") ;
mysql_select_db('mysql_db') or die($conn_error);

echo 'Connected!';
?> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-12T21:15:42.890

您正在使用字符串作为变量：

```
mysql_select_db('mysql_db') or die($conn_error); 
```

应该：

```
mysql_select_db($mysql_db) or die($conn_error); 
```

应该是 × 2

```
// make your db the current db http://php.net/manual/en/function.mysql-select-db.php
$db_selected = mysql_select_db($mysql_db);
if (!$db_selected) {
    die ("Can\'t use $mysql_db : " . mysql_error());
} 
```

**但真的应该是（使用 PDO，更改所有代码）：**

```
 try {
        $DB= new PDO('mysql:host=localhost;dbname=socialnetwork', 'liam', '');
    } catch (PDOException $e) {
        print "Error!: " . $e->getMessage() . "<br/>";
        die();
    } 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:15:15.227

Windows 使用[TCP/IP](http://en.wikipedia.org/wiki/Internet_protocol_suite)，它使用 localhost 来获得更好的性能，因为它的开销更少。

```
$mysql_host = "localhost"; 
```

Unix 系统使用[Unix Domain Socket](http://en.wikipedia.org/wiki/Unix_domain_socket)

```
$mysql_host = '127.0.0.1'; 
```

但是 apache 使用 TCP/IP 或 Unix Domain Socket 连接到 PHP。所以任何一种方式都应该有效。

# ios - 从导航控制器中删除工具栏

> ID：15980894
> 
> 赞同：2
> 
> 时间：2013-04-12T21:11:25.067
> 
> 标签：ios, uinavigationcontroller, toolbar

我有一个导航控制器，我在其中添加基于用户输入的工具栏。

当用户返回主屏幕时。我不想要工具栏。

```
self.navigationcontroller.toolbar.hidden = YES; 
```

这只是隐藏了工具栏，主页上的 UIImage 现在向上移动了 40 像素，黑色背景出现在工具栏隐藏的位置。

如何删除工具栏以使图像不会被向上推。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T23:20:13.960

```
self.navigationController.toolbar.hidden = YES; 
```

需要更换为...

```
self.navigationController.toolbarHidden = YES; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:52:21.013

为了保持子 VC 的位置`frame`向下移动 40px（动画持续时间为 0.25 fe），当您隐藏工具栏或使用 +40 更改导航控制器`bounds`原点时`origin.y`，就像您在隐藏状态栏时所做的那样. 但我认为会留下一个空白空间，你应该用它做点什么。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-11-13T20:48:44.777

为了快速，您需要编写：

```
 self.navigationController?.isToolbarHidden = true 
```

# jquery-mobile - Photoswipe 自定义标签立即关闭幻灯片

> ID：15980896
> 
> 赞同：1
> 
> 时间：2013-04-12T21:11:30.320
> 
> 标签：jquery-mobile, hashtag, photoswipe

使用 JQM 在桌面上进行测试不会产生这个问题，因此很难确定。

**背景故事：**我创建了服务器端代码 (php) 来接受查询字符串并直接打开图片库。但是，如果用户想在移动设备上浏览画廊时分享链接，尤其是某张照片；大多数移动浏览器共享核心链接，而不是实际照片。在事件中轻扫时很容易为带有照片 ID（例如 #photoID=987）的 URL 创建 URL 主题标签修饰符，但前提是画廊最初是在没有主题标签的情况下启动的。然后很容易与手机的本机方法共享。

```
(function(window, $, PhotoSwipe){
    $(document).ready(function(){
        //More Code is here but not needed fro this question

        $(photoSwipeInstance).bind(PhotoSwipe.EventTypes.onDisplayImage, function(e){
            var pid = codeThatGetsPhotoIDFromDisplayedIMGURL();
            window.location.hash = '&pid='+pid[0];

        });
        if(getUrlVars()["pid"]!=null || getUrlVars()["pid"]!=undefined)
        {
            console.log(getUrlVars()["pid"]);
            var photopid= getPhoto(getUrlVars()["pid"]);
            photoSwipeInstance.show(photopid);
        }
    });//End Documentstrong text
}(window, window.jQuery, window.Code.PhotoSwipe));
function getUrlVars()
{
    var vars = [], hash;
    var hashes = window.location.href.slice(window.location.href.indexOf('?') + 1).split('&');

    for(var i = 0; i < hashes.length; i++)
    {
        hash = hashes[i].split('=');
        vars.push(hash[0]);
        vars[hash[0]] = hash[1];
    }
    return vars;
} 
```

**问题：**如果画廊加载了主题标签，画廊将弹出正确的图像，但随后立即关闭幻灯片放映。并且在此之后的每张照片都以相同的方式执行，幻灯片打开然后关闭。

我已经关闭了 JQM 使用的所有 AJAX 和主题标签锚函数。此主题标签 url 功能在使用桌面浏览器时按预期工作，但在使用任何移动浏览器时不起作用。

有没有其他人尝试过这个功能？

我可能使这比我的描述更加混乱。

**答：** JQM 的标签处理程序不需要关闭。Photoswipe 需要将此处理程序添加到选项中：`backButtonHideEnabled: false`

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:56:48.737

JQM 的主题标签处理程序不需要被关闭。Photoswipe 需要将此处理程序添加到选项中：backButtonHideEnabled: false

# jquery - 为什么这个 jQuery 事件不在 gmail 中触发？

> ID：15980898
> 
> 赞同：2
> 
> 时间：2013-04-12T21:11:37.347
> 
> 标签：jquery, google-chrome-extension, gmail, jquery-events

我在将 jQuery 事件绑定到 gmail 'body' 时遇到问题

```
$('body').on('click', function(event) {
        console.log("Entered function");
}); 
```

访问 IMDB.com（例如）并在 Google Chrome 开发者控制台中粘贴上述代码。当您点击页面时，您可以在控制台上看到“输入的功能”。

但是当我对 gmail 进行同样的尝试时，我收到以下消息：

> TypeError: Object #<HTMLBodyElement> 没有“on”方法

gmail是怎么回事，我该如何解决这个问题？

编辑 ：-

非 JQuery 版本：

```
document.addEventListener("click", function() {
   console.log("Entered function");
}, false); 
```

就像评论者指出的那样，Gmail 没有加载 jQuery，这是一个非 jQuery 版本，当你点击 gmail 时它可以工作，但是当你点击一个链接时（打开一封包含一些链接的电子邮件）它不会工作了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-13T20:35:10.650

大多数 DOM 事件，包括 click 事件，按如下方式调度：

1.  捕获阶段（从`document`^(( `window`, `document`, `document.documentElement`, ...))沿着树向下到单击的元素）。
2.  冒泡阶段（从树上被点击的元素到`document` ^(...,`window`)）。

与 jQuery 绑定的事件总是在 #2 中触发，在冒泡阶段。Gmail 似乎绑定了一个事件添加捕获阶段，并`event.stopPropagation();`在用户单击`<a>`元素时调用。此方法停止事件的传播，因此 jQuery 永远不会知道该事件，因为 #2 永远不会发生。

所以，放弃 jQuery 并使用 vanilla JavaScript 来绑定事件：

```
document.addEventListener('click', function(event) {
    // Do whatever you want
}, true); 
```

[`addEventListener`](https://developer.mozilla.org/en-US/docs/DOM/EventTarget.addEventListener)通过设置to的第三个参数`true`，监听器在捕获阶段被触发。

* * *

关于 jQuery 错误（来自问题）：
Gmail 不加载 jQuery，因此您不能使用它。通常，您会得到 ReferenceError: "$ is not defined"。相反，您看到了“TypeError: Object # has no method 'on'”，因为当页面未声明时，它在 Chrome 的开发人员工具中`$`被定义为简写。[`document.querySelector`](https://developer.mozilla.org/en-US/docs/DOM/Document.querySelector)`$`

如果您在扩展中包含 jQuery，则可以通过切换到适当的上下文来使用它。有关更多详细信息，请参阅[为什么 jQuery 无法在 Facebook 中加载？](https://stackoverflow.com/a/15197993/938089)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:13:30.020

我查看了 gmail 正在加载的内容，似乎 gmail 没有加载 jquery。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T21:16:42.800

并非所有网站都使用 jQuery。如果你想访问一个特定的 jQuery 库版本，你需要加载它，这样你就可以在你的扩展中访问它。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T00:39:14.337

所以我测试了它，它工作得很好。就像我在评论中所说的那样，在所有情况下您都需要自己注入 jQuery。您无法访问页面的 javascript，也无法访问其他扩展程序中的任何 javascript。一些示例代码：

**清单.json**

```
{
  "name": "Gmail jQuery Test",
  "version": "0.1",
  "description": "Gmail jQuery Test",
  "manifest_version": 2,
  "permissions": [
    "https://mail.google.com/*"
  ],
  "content_scripts": [{
    "matches": ["https://mail.google.com/*"],
    "js": ["jquery.js", "script.js"],
    "all_frames": true
  }]
} 
```

**脚本.js**

```
$('body').on('click', function(event) {
  console.log("Entered function");
}); 
```

这会显示收件箱页面上的消息，以及任何消息和其他页面的内部。

# django - django-social-auth login 总是显示 twitter 登录页面

> ID：15980901
> 
> 赞同：5
> 
> 时间：2013-04-12T21:11:54.073
> 
> 标签：django

我在 twitter 上使用[django-social-auth](http://django-social-auth.readthedocs.org/en/latest/configuration.html)。用户第一次必须在 twitter 上授权应用程序，但在第二次登录时，twitter**应该**只是将用户重定向回来，而不要求再次授权应用程序。

对我来说，即使我之前已经授权过应用程序，它也总是要求授权应用程序。我正常登录，但它不应该如何工作。为什么？

django-social-auth 演示不这样做。我做了什么不同的事情？

我在这里错过了什么来获得这种行为吗？也许是一个将某些东西保存为 cookie 的管道？

**关联**

```
<a href="{% url 'socialauth_begin' "twitter" %}" class="btn_1">Login with Twitter</a> 
```

**管道**

```
SOCIAL_AUTH_PIPELINE = (
    'social_auth.backends.pipeline.social.social_auth_user',
    #'social_auth.backends.pipeline.associate.associate_by_email',
    'social_auth.backends.pipeline.user.get_username',
    'social_auth.backends.pipeline.user.create_user',
    'social_auth.backends.pipeline.userena.create_profile',
    'social_auth.backends.pipeline.userena.create_account',
    'social_auth.backends.pipeline.social.associate_user',
    'social_auth.backends.pipeline.social.load_extra_data',
    'social_auth.backends.pipeline.user.update_user_details'
) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-18T13:18:36.267

也许您的问题不在您的代码中，而在您的 Twitter 应用程序设置中。确保在您的设置中选中“允许此应用程序用于使用 Twitter 登录”

# c# - gridview 内的 ASP.NET 列表框

> ID：15980905
> 
> 赞同：0
> 
> 时间：2013-04-12T21:12:26.483
> 
> 标签：c#, asp.net

我在单击编辑时出现的网格视图内有一个列表框，它有一个事件类型列表，您可以选择多个。单击更新按钮时，我无法弄清楚如何更新我的实体。我需要能够使用从 gridview 内的列表框中进行的选择来更新实体集合。gridview 正在使用实体数据源。下面是gridview 中的列表框。

```
 <asp:TemplateField HeaderText="Event Type">
            <ItemTemplate>
                <asp:Label runat="server" ID="eventTypeLabel" Text="<%#VenueExplorer.Utilities.StringUtils.convertEventsToCommaString(Container.DataItem) %>" />
            </ItemTemplate>
            <EditItemTemplate>
                <asp:ListBox ID="eventListbox" runat="server" DataSourceID="eventTypeDataSource" DataValueField="EventTypeID" DataTextField="EventType" SelectionMode="Multiple"></asp:ListBox>
            </EditItemTemplate>
        </asp:TemplateField> 
```

有没有办法在执行实际保存之前更新绑定到 gridview 的实体？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T00:58:22.227

在您的`RowUpdating`事件期间`GridView`，您可以捕获`ListBox`的选定值。

在不知道您的完整标记或数据库结构的情况下，我只能模拟预期的代码。像这样的东西，虽然你显然必须修改它以满足你的需要：

```
protected void grdView_RowUpdating(object sender, GridViewUpdateEventArgs e)
{
    ListBox eventListbox = (ListBox)grdViewName.Rows[e.RowIndex].Cells[ZeroBasedCellNumberOfTheListBox].FindControl("eventListbox");

    // Retrieve the currently selected entity (row) from the database
    ParentEntity yourParentEntity = from entity in DataContext.ParentEntity where entity.ID == grdViewName.Rows[e.RowIndex].Cells[IndexOfYourEntitysID].Text;

    foreach (ListItem item in eventListbox.Items)
    {
        if (item.Selected)
        {
            EventType eventType = new EventType();
            eventType.ID = item.Value;
            eventType.Name = item.Text;

            yourParentEntity.EventTypes.Add(eventType);            }
    }

    DataContext.Commit(); 
```

}

# excel - 将 .xlsx 工作簿中的工作表导出到制表符分隔的 .txt 文件的宏不适用于 .xlsm 工作簿

> ID：15980910
> 
> 赞同：2
> 
> 时间：2013-04-12T21:12:38.770
> 
> 标签：excel, vba

编辑：我根据评论更新了我的代码，但得到了相同的症状。

编辑 2：我再次更新了代码，我知道它适用于 .xlsx 文件的目录。如果我将所有 .xlsm 文件转换为 .xlsx 文件以删除宏/代码，那么代码效果很好。这个问题很可能过于局部化。

[今天早些时候，](https://stackoverflow.com/questions/15975315/loop-over-folder-of-workbooks-and-export-all-sheets-to-tab-delimited-text-with-e/15976556?noredirect=1#comment22780286_15976556)我学习了如何遍历 .xlsx 文件的文件夹并将每张工作表导出到制表符分隔的 .txt 文件。我更大的目标是遍历一个包含 .xlsm 文件的文件夹（我的机器上的宏并不全部）并将数据工作表写入 .txt 文件。

这是修改后的代码。

```
Sub exportsSheetsToTextForAll()

    Application.AutomationSecurity = msoAutomationSecurityForceDisable

    excelFiles = Dir(ThisWorkbook.Path & "\" & "Payout data*.xlsm")
    fromPath = ThisWorkbook.Path

    Do While Len(excelFiles) > 0
        Debug.Print Files
        Set oWb = Workbooks.Open(Filename:=fromPath & "\" & excelFiles)
        Application.Run "exportSheetsToText", oWb
        oWb.Close SaveChanges:=False
        excelFiles = Dir
    Loop

End Sub

Sub exportSheetsToText(iWb As Workbook)

    For Each ws In iWb.Worksheets
        ws.Copy
        Set wb = ActiveWorkbook
        textFile = Left(iWb.FullName, InStr(iWb.FullName, ".") - 1) & "-" & ws.Name & ".txt"
        wb.SaveAs Filename:=textFile, FileFormat:=xlText
        wb.Close SaveChanges:=False
    Next ws
End Sub 
```

由于 .xlsm 文件的结构，我修改了第一个问题的答案。每个 .xlsm 文件都有一个数据查询工作表（“REQUEST_TABLE”），其中包含用于查询条目的单元格和用于宏的按钮。运行查询会生成包含我要导出的数据的新工作表（“Sheet1”、“Sheet2”等）。

当我运行`exportAllSheetsToText()`宏时，它会打开第一个工作表，但它从数据查询工作表（“REQUEST_TABLE”）开始，将其保存到制表符分隔的文本文件中，然后停止而不是继续浏览所有工作表。我认为宏会像我原来的宏一样遍历所有工作表，用于循环目录中的所有工作簿和工作表。

当我在 .xlsm 文件上运行宏时会发生什么变化？我是否需要先将这些工作表剥离到它们自己的 .xlsx 文件中？谢谢！

# .net - 将图片框复制到面板中（VB.net）

> ID：15980913
> 
> 赞同：0
> 
> 时间：2013-04-12T21:12:43.750
> 
> 标签：.net, vb.net, winforms, controls

我一直在做一些研究，但还没有找到如何做到这一点：

我在一个面板中有一个图片列表，并且想知道当我单击其中一张图片时，它是否会将所选图像放入另一个面板中以获取某些内容。我还想要一种通过按钮将其删除的方法。这可能吗？我还没有找到一种方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:58:16.727

好吧，如果我理解...您可以设置`visible = false`单击的图像，并将相同的 BMP/PNG 加载到第二个面板上的图像并设置为它`visible = true`（在图像单击事件中执行此操作），这只是一个技巧，您可以做到很多事情只是“有想象力”。

# textpad - TextPad 7 不会自动重新加载

> ID：15980914
> 
> 赞同：2
> 
> 时间：2013-04-12T21:12:45.080
> 
> 标签：textpad

TextPad 7 不会自动重新加载。有谁知道如何打开它。

我已经完成了过去所做的事情：从菜单中设置“当文件被另一个进程修改时：”组的自动重新加载标志：Configure.Preferences。但是，在 TextPad 7 中，文件不会自动重新加载。

非常感谢，阿维

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-08-20T05:52:11.683

您可以配置 Textpad 以在不提示的情况下重新加载文件。

转到配置->首选项...->文件，然后在文件被另一个进程修改时选择自动重新加载选项。

需要注意的一点是，如果光标位于文件的末尾，TextPad 将在进行更新时将其保留在末尾，以便文件可以很好地滚动。如果光标在文件中的其他位置，它将不会滚动。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-10T05:25:26.697

可能会有一些偏好变化。您可以使用链接配置在 F5 上重新加载

[http://skatterbrainz.blogspot.in/2010/11/textpad-tip-assign-f5-to-refresh-view.html](http://skatterbrainz.blogspot.in/2010/11/textpad-tip-assign-f5-to-refresh-view.html)

基本上优先 -> 键盘 -> 所有命令 -> 选择 FileRevert -> 分配 F5。

一切都很好

# javascript - Javascript 复选框场景

> ID：15980916
> 
> 赞同：2
> 
> 时间：2013-04-12T21:12:49.017
> 
> 标签：javascript, jquery

我目前有一个代码显示基于两个复选框的 DIV。目前，您可以同时选中这两个复选框，两个 DIV 都会显示。我不希望这种情况发生。我怎样才能做到这一点，以便您选择显示另一个 DIV 的两个复选框？

总之，一个复选框显示一个 DIV，另一个复选框显示另一个，两者都将显示完全不同的内容。

```
<input type="checkbox" name="checkbox_insert" 
id="checkbox_insert" value="insert">Insert<br>
<input type="checkbox" name="checkbox_update" 
id="checkbox_update" value="update">Update</p>

<script type="text/javascript">
    $('#checkbox_insert').change(function() {
        $('#insert_div').toggle();
    });

    $('#checkbox_update').change(function() {
        $('#update_div').toggle();
    });
</script>

<div id="insert_div" style="display:none">
    INSERT
</div>

<div id="update_div" style="display:none">
    UPDATE
</div>

<div id="both_div" style="display:none">
    BOTH
</div> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:31:00.407

```
var $i = $('#checkbox_insert, #checkbox_update'),
    $d = $('div'),
    $b = $d.filter('#both_div');

$i.change(function () {
    $b.toggle($i.filter(':checked').length === $i.length);
    $d.filter('#' + this.value + '_div').toggle(this.checked);
}); 
```

[http://jsfiddle.net/EeJXy/](http://jsfiddle.net/EeJXy/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:29:14.477

你会想要这样的东西（使用 jQuery）：

**编辑**toggle() 中的更新布尔值（此处为工作示例[http://jsfiddle.net/uYUK2/](http://jsfiddle.net/uYUK2/)）：

```
$('input[type="checkbox"]').on('change', function() {
    var inserted = $('#checkbox_insert').prop('checked');
    var updated =  $('#checkbox_update').prop('checked'); 

    $('#both_div').toggle(inserted && updated);
    $('#insert_div').toggle(inserted && !updated);
    $('#update_div').toggle(updated && !inserted);
}); 
```

# php - 如何解析数组中返回的 JSON？

> ID：15980917
> 
> 赞同：0
> 
> 时间：2013-04-12T21:12:54.237
> 
> 标签：php, jquery, json, jsonp

我有一个 PHP 后端，当被查询时，它将返回一组 JSON 格式的帖子。但是，由于有多个帖子，它在一个数组中。例如：（开头的字符串只是一个JSONP回调）

```
jQuery19107630979726091027_1365800375610?_=1365800375611([
    {
        "content": "Hello",
        "time": "1349829544",
        "info": {
            "email": "test@test.com",
            "username": "test",
            "first": "Test",
            "last": "User",
            "id": "2"
        }
    },
    {
        "content": "test.",
        "time": "1349829535",
        "info": {
            "email": "test@test.com",
            "username": "test",
            "first": "Test",
            "last": "User",
            "id": "2"
        }
    }
]) 
```

请注意 JSON 是如何被方括号括起来的。当我使用 jQuery 脚本调用和解析此数据时，我收到错误“Uncaught SyntaxError: Unexpected end of input”，将我指向括号所在的最后一行数据。JS：

```
$("#getPosts").click(function(){
    $.getJSON("http://mysite.com/api/posts/list/byfriends/callback=?", function(data){
        $.each(data, function(){
            $('#posts').append("<li><p>"+this.content+"</br>By: "+this.info.first+" "+this.info.last+" ("+this.info.email+")");
        });
    });
}); 
```

最后，这是发送 JSON 的 PHP：

```
include('config.inc');
header("Content-type: text/javascript");
$posts = array();
$subscribe = "SELECT subscribed FROM subscribe WHERE subscriber = '{$_SESSION['id']}'";
$query = mysql_query("SELECT * FROM `posts` WHERE (`post_owner` IN ({$subscribe}) OR `post_owner` = {$_SESSION['id']}) ORDER BY `id` DESC");
$num = mysql_numrows($query);
for ($i = 0; $i < $num; $i++) {
    $post['content'] = mysql_result($query, $i, 'content');
    $post['time'] = mysql_result($query, $i, 'timestamp');
    $post['info'] = getInfo_other(mysql_result($query, $i, 'post_owner'));
    array_push($posts, $post);
}
echo $callback."("json_encode($posts, JSON_PRETTY_PRINT).")"; 
```

回调变量正在运行。我有一个简单的 PHP 路由器设置来处理这个问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:15:30.327

下面是一个使用回调响应 JSONP 调用的示例以及它应该如何返回（在本例中为 CouchDB）：

要求：

[http://whatever.com/couchdb/db/2010-07-09T23%3A57%3A38.500000Z?callback=a](http://whatever.com/couchdb/db/2010-07-09T23%3A57%3A38.500000Z?callback=a)

回复：

```
a({
    "_id" : "2010-07-09T23:57:38.500000Z",
    "_rev" : "1-750aa2bc0a40e32120e8f6af49b7e979",
    "timestamp" : 2500,
    "data" : {
        "time" : "2010-07-09T23:57:38.500000Z",
        "audio" : {
            "crowd_score" : 0.012911000000000001,
            "traffic_score" : 0.155251,
            "applause_score" : 0.0,
            "music_score" : 0.22573499999999999,
            "@ID" : "freesound_org_100840",
            "position" : 2.5
        }
    }
}); 
```

尝试在末尾添加分号和？_ 在您生成的响应中应该被删除，因为它会使 Javascript 发生比较。

你的回复应该是这样的：

```
jQuery19107630979726091027_1365800375610([{
                "content" : "Hello",
                "time" : "1349829544",
                "info" : {
                    "email" : "test@test.com",
                    "username" : "test",
                    "first" : "Test",
                    "last" : "User",
                    "id" : "2"
                }
            }, {
                "content" : "test.",
                "time" : "1349829535",
                "info" : {
                    "email" : "test@test.com",
                    "username" : "test",
                    "first" : "Test",
                    "last" : "User",
                    "id" : "2"
                }
            }
        ]); 
```

最后，你可以看看[https://stackoverflow.com/a/1678243/1688441](https://stackoverflow.com/a/1678243/1688441)，这很有趣。

# qt - QLineEdit 的自定义框架

> ID：15980918
> 
> 赞同：0
> 
> 时间：2013-04-12T21:12:56.883
> 
> 标签：qt

（使用 Qt 4.8.4）

我想为 QLineEdit 创建一个自定义框架。一张是在 Photoshop 中创建的，我有三张图片（因为它需要在宽度上拉伸）：

![在此处输入图像描述](https://i.stack.imgur.com/j1sba.png)

1.  左侧图像
2.  中心街道图像
3.  右侧图像

我想找到一种方法将 QTLineEdit 的外观替换为此，同时仍保留其中的编辑视觉效果/感觉。这只是我想要替换的框架。

我该怎么做？如果我覆盖paintEvent，则什么都看不到，甚至看不到我键入的内容，甚至看不到闪烁的光标。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T15:51:05.263

好的。我想我搞定了：

我正在为我的 QLineEdit 对象设置以下样式表：

```
this->ui->myLineEdit->setStyleSheet("border-image: url(input_bg.png) 5 5 5 5 stretch stretch;border-width: 5px 5px 5px 5px;"); 
```

我使用“5”是因为在我使用的图像中，每个角的 5x5 切割封装了由于内部渐变而无法优雅拉伸的区域。

这确保了当编辑控件的大小可变时边框可以很好地工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T22:04:16.797

你有没有尝试过：

*   创建您自己的`CustomLineEdit`继承自的类`QLineEdit`，
*   在构造函数/析构函数中加载/释放你的图片`CustomLineEdit`，
*   重新实现自己`paintEvent()`，`CustomLineEdit`
*   根据`paintEvent()`需要放置所有图片。

# c# - 在 C# 中添加和划分颜色

> ID：15980919
> 
> 赞同：6
> 
> 时间：2013-04-12T21:13:01.350
> 
> 标签：c#, wpf, xaml, math, colors

我想从两种颜色生成中间颜色：

```
Color Middle = Color.FromRGB(Color.FromRgb( Color1.R + Color2.R) / 2, (Color1.G + Color2.G) / 2, (Color1.B + Color2.B) / (2); 
```

此代码不会编译，因为`FromRGB()`需要一个`byte`.

所以我尝试了这个：

```
Color myColorMiddle = Color.FromRgb((byte)(Color1.R + Color2.R) / (byte)2, (byte)(Color1.G + Color2.G) / (byte)2, (byte)(Color1.B + Color2.B) / (byte)2); 
```

但我得到同样的错误。任何人都可以帮助我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-12T21:15:43.073

对字节（和短）的算术运算产生一个 int 结果。您必须将整个表达式放在括号中并强制转换：

```
Color myColorMiddle = Color.FromRgb((byte)((Color1.R + Color2.R) / 2), (byte)((Color1.G + Color2.G) / 2), (byte)((Color1.B + Color2.B) / 2)); 
```

如果您将其提取到函数中，您的代码会更清晰：

```
byte Average(byte a, byte b)
{
    return (byte)((a + b) / 2);
} 
```

然后您的代码如下所示：

```
Color myColorMiddle = Color.FromRgb(Average(Color1.R, Color2.R), Average(Color1.G, Color2.G), Average(Color1.B, Color2.B)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-12T21:28:21.683

If you are using System.Windows.Media.Color, I think you can do this:

```
 Color start = Color.FromRgb(255, 0, 0);
  Color end = Color.FromRgb(0, 255, 0);
  Color middle = start + (end - start) * 0.5F; 
```

Note, I did not try this, but I did get it from MSDN:

[http://msdn.microsoft.com/en-us/library/system.windows.media.color.aspx](http://msdn.microsoft.com/en-us/library/system.windows.media.color.aspx)

UPDATE

I have tested my most recent edit and it does work.

# c# - 将 Windows 窗体应用程序转换为 Web 用户控件（功能）

> ID：15980920
> 
> 赞同：0
> 
> 时间：2013-04-12T21:13:02.643
> 
> 标签：c#, web-applications

我有一个编辑配置文件的 C# Windows 窗体应用程序。它基本上从 XML 文件中读取字符串，并允许管理员在需要时编辑该字符串。

我被要求在我们的服务器上进行设置，以便用户可以登录网站并运行应用程序。我几乎没有做过 Web 开发，我在网上看到很多答案说您无法将 Windows 窗体应用程序转换为 Web 窗体应用程序。但这些答案似乎专门指转换 UI。

我真的只对移植功能感兴趣。我的 UI 只是一个用于编辑字符串的文本框、一个显示当前字符串值的列表视图，以及一个用于提交更改的按钮。我非常乐意为我的内容设计一个新的 UI。但是功能呢？我可以使用我当前的 C# 代码并将其挂接到 Web UI 中吗？还是我需要为网络编写不同的代码？

除了 button_Click 和 KeyDown 函数，我真的只有这两个：

列出字符串中的内容：

```
 /// <summary>
    /// Find current phrases being ignored and list them
    /// </summary>
    internal void listPhrases()
    {
        string myFile = Environment.CurrentDirectory + "\\CGEmailCnctr.exe.config";

        string strFile = File.ReadAllText(myFile);
        var sb = new StringBuilder(strFile);

        string getThis = "<add key=\"messageFilter\" value=\"";
        string subStr = strFile.Substring(strFile.IndexOf(getThis) + getThis.Length);
        string[] igPhrases = subStr.Substring(0, subStr.IndexOf(";\"")).Split(';');

        foreach (string s in igPhrases)
        {
            listView1.Items.Add(s);
        }
    } 
```

添加到字符串：

```
 /// <summary>
    /// Checks to see if the phrase is already in the list.  If not, then add it.
    /// </summary>
    /// <param name="addThis"></param>
    internal void addPhrase(string addThis)
    {
        foreach (ListViewItem lvi in listView1.Items)
        {
            if (addThis == lvi.Text)
            {
                lvi.Selected = true;
                MessageBox.Show("List of phrases already contains \"" + addThis + ".\"  Please check the phrase again. \nIf the problem persists, contact your system administrator.");
                return;
            }
        }

        string myFile = Environment.CurrentDirectory + "\\CGEmailCnctr.exe.config";
        string pattern = "messageFilter";
        string pattern2 = ";\"";
        string igPhrase = ";" + addThis + ";\"";

        string strFile = File.ReadAllText(myFile);
        var sb = new StringBuilder(strFile);

        //Find messageFilter, the key we need to change, and get the index of it
        int index = strFile.IndexOf(pattern);
        string after = strFile.Substring(index);

        strFile = strFile.Substring(0, index) + strFile.Substring(index).Replace(pattern2, igPhrase);

        //MessageBox.Show(strFile);

        try
        {
            File.WriteAllText(myFile, strFile);

            MessageBox.Show("Operation complete.  Messages with the phrase \"" + addThis + "\" in the subject line will no longer automatically generate ChangeGear tickets.", "Phrase Added");

            listView1.Items.Add(addThis);
        }
        catch (Exception ex)
        {
            MessageBox.Show("Operation failed. \n" + ex.ToString());
        }
    } 
```

我的 using 语句，以防它们阐明任何内容：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.IO;
using System.Linq;
using System.Text;
using System.Windows.Forms; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T22:29:17.777

如果您尝试在 Web 窗体中使用此代码，则会出现一些问题，第一个是您使用的：`Environment.CurrentDirectory`可能需要使用它`Server.MapPath`，另一个是您在代码中直接调用 UI，例如`MessageBox.Show`和`ListViewItem`，连接到 UI 的代码必须重新考虑，所以你有一条前进的道路。

您最好尝试在 Web 窗体中从头开始重新创建应用程序，而不是移植代码，这样可能更容易，并且将帮助您更好地理解 Web 窗体的工作原理。

# css - Twitter Bootstrap 轮播组件控制 Firefox 中的定位故障

> ID：15980921
> 
> 赞同：2
> 
> 时间：2013-04-12T21:13:17.283
> 
> 标签：css, firefox, twitter-bootstrap

我使用 twitter bootstrap 为朋友重新设计了一个网站，我认为这可以让我不必考虑跨浏览器的兼容性。

现在我尝试将它与 firefox 一起使用，只是注意到当您将 Carousel 组件的控件悬停时它们会移开，因此无法单击它们。更不用说它看起来相当不专业。

可以在这里看到奇怪的行为，并且在 Firefox 18.0.2 上发生在我身上：http: [//snow-first.com/snow-rabbit-3/](http://snow-first.com/snow-rabbit-3/)

有人知道发生了什么吗？尝试查看css，但悬停时唯一应该发生的是不透明度变化......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:47:26.910

对于选择器`.carousel-control:hover, .carousel-control:focus`（CSS 的第 576 行）添加`position:absolute`

# asp.net-mvc - 未找到主页/索引。我不能使用约束吗？

> ID：15980925
> 
> 赞同：0
> 
> 时间：2013-04-12T21:13:23.880
> 
> 标签：asp.net-mvc

我有经典的默认 ASP.NET MVC 路由：

```
 System.Web.Routing.RouteTable.Routes.MapRoute(
      "Default",
      "{controller}/{action}/{id}",
      new { controller = "Home", action = "Index", id = UrlParameter.Optional },
  ); 
```

因为我想在一个区域内有另一个 HomeController，所以我添加了以下内容：

```
 System.Web.Routing.RouteTable.Routes.MapRoute(
      "Default",
      "{controller}/{action}/{id}",
      new { controller = "Home", action = "Index", id = UrlParameter.Optional }, 
      typeof(MVCSite.Controllers.HomeController).Assembly
  ); 
```

所以这条路线只适用于根主控制器。

但是当我用这个启动网站时，我得到一个 404 错误。

这是为什么？我不能指定这个约束吗？

谢谢你！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:29:09.687

我能够使用以下方法解决这个问题：

```
RouteTable.Routes.MapRoute(
  "Default", 
  "{controller}/{action}/{id}", 
  new { controller = "Home", action = "Index", id = UrlParameter.Optional }, 
  new String[] { typeof(HomeController).Namespace 
}); 
```

谢谢你，米格尔

# python - ImportError：没有名为 MySQLdb 的模块 - Debian 6.0

> ID：15980928
> 
> 赞同：0
> 
> 时间：2013-04-12T21:13:27.057
> 
> 标签：python, mysql, debian, mysql-python

在尝试导入 mysql 时，我在 Python 中遇到了问题。我的代码的开头是（我正在使用 monkeyrunner 运行脚本）：

```
#!/usr/bin/env python

import sys  
import MySQLdb
.
.
.
etc 
```

每次我尝试运行代码时，都会收到当前错误：

```
dani@debian:~/public/Yandex Maps Test$ monkeyrunner test.py
130413 00:49:22.066:S [main] [com.android.monkeyrunner.MonkeyRunnerOptions] Script terminated due to an exception
130413 00:49:22.066:S [main] [com.android.monkeyrunner.MonkeyRunnerOptions]Traceback (most recent call last):
  File "/home/dani/public/Yandex Maps Test/test.py", line 4, in <module>
    import MySQLdb
ImportError: No module named MySQLdb

130413 00:49:22.066:S [main] [com.android.monkeyrunner.MonkeyRunnerOptions] at org.python.core.PyException.fillInStackTrace(PyException.java:70)
.
.
.
etc 
```

我试图为python重新安装mysql：

```
sudo apt-get reinstall python-mysqldb mysql-server 
```

但没有任何帮助。有什么想法或提示吗？

问候，，，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T22:11:23.903

问题是它`monkeyrunner`与默认系统 Python 的解释器不同，并且不共享相同的站点包等。

脚本`#!/usr/bin/env python`顶部的内容具有误导性。如果您实际上使用`/usr/bin/env python test.py`或只是`./test.py`（假设`chmod +x`）运行脚本，它将起作用。但你不是，你用`monkeyrunner`.

因此，您为系统安装的任何内容 Python 都不会在`monkeyrunner`. 您必须安装它`monkeyrunner`。

此外，正如[文档](http://developer.android.com/tools/help/monkeyrunner_concepts.html)所说：

> monkeyrunner 工具使用 Jython，这是一种使用 Java 编程语言的 Python 实现。

虽然 Jython 是 Python，并且实现了与 CPython 相同的 Python 语言和（几乎）标准库，但它没有实现 CPython C API，因此不能使用像 MySQLdb 这样的 C-API 扩展。（他们实际上正在开发一个聪明的包装器，它将在未来改变这一点，但这对你今天没有帮助。）

还有其他 MySQL 驱动程序可与 CPython 和 Jython 一起使用（因为它们使用纯 Python），例如[`PyMySQL`](https://github.com/petehunt/PyMySQL). 但最简单的解决方案是只使用 Java 的`JDBC`驱动程序。正如[Jython 常见问题解答](http://wiki.python.org/jython/JythonFaq/JythonModules)所建议的那样，最简单的方法是：

> 使用[`zxJDBC`](http://www.jython.org/archive/21/docs/zxjdbc.html)它通过 Python DB API 2.0 接口从 Jython 提供数据数据库连接......</p>

与直接使用 JDBC 不同，使用`zxJDBC`经常意味着您只需更改 MySQLdb 代码中的一行即可使其工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-04T08:09:44.213

我和你有同样的问题。我尝试使用 zxJDBC 来修复它。但是当我运行脚本时，它找不到“org.gjt.mm.mysql.Driver”或“com.mysql.jdbc.Driver”。即使我将 mysql-connector-java-5.1.34-bin.jar 和 zxJDBC.jar 放在系统 CLASSPATH 下。我尝试在 jython 下运行这个脚本。有效。所以我认为这个问题与monkeyrunner有关。

# ios - 如何使用 Kiwi 测试 UICollectionViewLayout？

> ID：15980930
> 
> 赞同：3
> 
> 时间：2013-04-12T21:13:29.470
> 
> 标签：ios, unit-testing, bdd, kiwi

我需要用 Kiwi 测试一个 UICollectionViewFlowLayout 子类，

我已经正确地模拟了 UICollectionView 的委托和数据源，但我仍然遇到一些问题。

使用指定的项目大小`CGSize(200.0f, 200.0f)`，我应该在屏幕上获得 5 个项目，但由于某种原因，最后一行返回的属性数组确实返回 10 个属性，这意味着有 10 个可见单元格。

这里会发生什么？如果我的布局按预期工作，屏幕上总是有 5 个元素：

这就是我到目前为止所拥有的（阅读评论），而且它大部分都有效。

```
describe(@"LineLayout", ^{
    __block UICollectionView *collectionView;
    __block HICollectionViewLineLayout *layout;
    __block const CGRect windowFrame = CGRectMake(0.0f, 0.0f, 1024.0f, 768.0f);
    __block const CGSize itemSize = CGSizeMake(200.0f, 200.0f);

    // Create a Collection View that uses a LineLayout and set the datasource delegate
    // before each test
    beforeEach(^{
        layout = [[HICollectionViewLineLayout alloc] init];
        collectionView = [[UICollectionView alloc] initWithFrame:windowFrame collectionViewLayout:layout];

        // Mock the UILineLayout data source
        id delegateMock = [KWMock mockForProtocol:@protocol(UICollectionViewDelegateFlowLayout)];
        [[delegateMock should] conformToProtocol:@protocol(UICollectionViewDelegateFlowLayout)];
        [delegateMock stub:@selector(collectionView:layout:sizeForItemAtIndexPath:) andReturn:theValue(itemSize)];
        [delegateMock stub:@selector(collectionView:layout:insetForItemAtIndex:) andReturn:theValue(UIEdgeInsetsZero)];

        // Mock the UICollection View dataSource
        id dataSourceMock = [KWMock mockForProtocol:@protocol(UICollectionViewDataSource)];
        [[dataSourceMock should] conformToProtocol:@protocol(UICollectionViewDataSource)];
        [dataSourceMock stub:@selector(numberOfSectionsInCollectionView:) andReturn:theValue(1)];
        [dataSourceMock stub:@selector(collectionView:numberOfItemsInSection:) andReturn:theValue(10)];

        // Set the delegate and the data source
        collectionView.delegate = delegateMock;
        collectionView.dataSource = dataSourceMock;

        // Reload the collectionView Data
        [collectionView reloadData];
    });

    it(@"Should properly identify central element when cell number is not even", ^{
        NSArray *attributes = [layout layoutAttributesForElementsInRect:windowFrame];

        // test that [attributes count] == 5
    }); 
```

这是我在没有测试的情况下运行应用程序时看到的：

![在此处输入图像描述](https://i.stack.imgur.com/v2mK2.png)

# python - 使用 subprocess 模块从 Python 执行命令行命令

> ID：15980932
> 
> 赞同：0
> 
> 时间：2013-04-12T21:13:30.063
> 
> 标签：python, linux

我正在尝试在 python 中使用并`subprocess module`尝试获取`process id``firefox`

```
cmd = "firefox &" 
fire = subprocess.Popen(cmd,shell=True, stdout=subprocess.PIPE, preexec_fn=os.setsid)
fire_task_procs = find_task(fire.pid)
print "fire_task_procs",fire_task_procs 
```

我想我得到了`pid`我正在执行的命令行参数。我做错了什么吗？我确认使用`ps aux | grep firefox`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:16:39.390

如果您使用`shell=True`pid，您将得到启动 shell 的那个，而不是您想要的进程的那个，特别是当您`&`用来将进程发送到后台时。

您应该使用长（列表）形式来提供参数，而不使用`&`，因为如果将其与输出重定向结合使用，这无论如何都没有意义。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:20:02.170

不要使用外壳，而只需使用

```
subprocess.Popen(['firefox'], stdout=subprocess.PIPE, preexec_fn=os.setsid) 
```

但是，如果 firefox 已经在运行，那么这也不起作用，因为在这种情况下，firefox 将使用一些 IPC 来告诉现有进程打开一个新窗口然后终止。

# python - 从根中删除元素时，Python ElementTree 会出错

> ID：15980933
> 
> 赞同：1
> 
> 时间：2013-04-12T21:13:30.353
> 
> 标签：python, elementtree

尝试从 xml 文档中删除元素时出现以下错误。“ValueError: list.remove(x): x not in list” 这是代码，错误发生在删除的那一行。

```
import xml.etree.ElementTree as ET
tree = ET.parse("AddInClasses.xml")
rootElem = tree.getroot()
for class2 in rootElem.findall("Transforms/class"):
    name2 = class2.find("name")
    if name2.text == "Get Field":
        rootElem.remove(class2)
tree.write("AddInClassesTrimmed.xml") 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-12T21:23:53.980

您正在循环不是根的*直接*子元素的元素。您需要获取对直接父级的*引用*。

使用不是那么容易的 ElementTree，元素上没有父指针。您需要先循环`Transforms`，然后循环`class`：

```
for parent in rootElem.findall("Transforms[class]"):
    for class2 in parent.findall("class"):
        name2 = class2.find("name")
        if name2.text == "Get Field":
            parent.remove(class2) 
```

我添加了一个额外的循环，用于查找`Transforms`至少包含一个`class`元素的所有元素。

如果您要`lxml`改用，那么您可以只使用`class2.getparent().remove(class2)`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2018-05-08T07:26:31.877

以下也应该工作......

```
 import xml.etree.ElementTree as ET
    tree = ET.parse("AddInClasses.xml")
    rootElem = tree.getroot()
    for class2 in rootElem.findall("Transforms/class"):
        name2 = class2.find("name")
        if name2.text == "Get Field":
           rootElem.find("Transforms").remove(class2) #<<< see the lone change here
    tree.write("AddInClassesTrimmed.xml") 
```

# java - AVL 树：解决 StackOverflowError

> ID：15980935
> 
> 赞同：0
> 
> 时间：2013-04-12T21:13:35.630
> 
> 标签：java, avl-tree

基本上，我通过从文本文件中读取一组整数来实现 AVL 树，然后使用 add() 方法填充树。此外，该程序应该按整数集的顺序打印。

当我运行程序时，会弹出 StackOverflowError。我认为这个错误是由于 add() 方法出现故障而触发的。

如果有人帮助我，我真的很感激，因为我是这种编程的新手。

这是主类的一部分：

```
 public static void main(String[] args) throws FileNotFoundException
   {

            AVL s1 = new AVL();

            Scanner file = new Scanner(new File("C:\\Users\\Dell\\Desktop\\integers.txt"));

            while(file.hasNext())
            {
               // String str = file.next();

                //int b = Integer.parseInt(str);
                int b = file.nextInt();
                s1.add(b);

            }

            v1.PrintInOrder(v1.root); 
```

这些是 add() 和 PrintInOrder() 方法：

```
public boolean add(int key)
 {
        root = add(root, key);
        return true;
 }

private Node add(Node b1, int key)
 {

     if(b1 == null)
     {
        return new Node(key);
     }

     if(key < b1.element){
            b1.left = add(b1.left, key);
     }
     else
     {
            b1.right = add(b1.right, key);
     }

     int Left_Height = getHeight(b1.left);
     int Right_Height = getHeight(b1.right);

     // a height imbalance requires that two subtrees differ by two
     if(Math.abs(LeftHeight - RightHeight )== 2)
         return Balance(n1);
     else
     {
        n1.ResetHeight();
        return b1;
     }
 }

   public void PrintInOrder(Node b1){
      if(b1 != null){
        PrintInOrder(b1.left);
        System.out.println(b1.element);
        PrintInOrder(b1.right);
      }
 } 
```

这是节点类：

```
public class Node {

Node left;
Node right;
int element;
int height;

public Node(int keys){
    this(keys, null, null);
}

public Node(int d, Node right1, Node left1){
    element = d;
    height = 0;
    left = left1;
    right = right1;
}

// This method recalculates the height if the right or left subtrees have been altered
 public void ResetHeight(){

    int LeftHeight = AVL.getHeight(left);
    int RightHeight = AVL.getHeight(right);
    height = 1 + Math.max(LeftHeight,RightHeight);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:23:27.397

由于堆栈溢出通常发生在递归中。使用您的 IDE 并在您已完成 recusion 的位置设置中断，然后进行调试。一步一步通过它。

# cassandra - Cassandra 计数器表使用什么 ConsistencyLevel？

> ID：15980936
> 
> 赞同：3
> 
> 时间：2013-04-12T21:13:37.410
> 
> 标签：cassandra

我有一张桌子，每秒大约有 1000 次页面浏览量。我应该使用什么读写 ConsistencyLevel？我正在使用 Cassandra Thrift 客户端。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-15T08:21:38.940

卡罗的想法或多或少是正确的。但是你必须平衡它与你的用例。

我在游戏行业工作，我们使用 cassandra 来获取玩家数据。它受读-修改-写模式的严重约束，这不是 cassandra 的强项。但是我们也有一些写入量很大的功能（每天几次读取的数千次写入）。

这是我根据经验对如何使用一致性级别的看法。

在 QUORUM 上写入 + 读取意味着在返回两个操作之前，它将等待集群中的大多数节点确认操作。这是我在读写频率大致相同时使用的解决方案。（玩家数据块）

写一个 + 全部读对于写繁重的东西很有用。我们将其用于高分示例（通常每 5 分钟读取一次以重新生成整个游戏的高分表）如果您不太关心数据（想到非关键日志），您可以使用 Write Any。

对于 Write All + Read One，我能想到的唯一用例是定期检查更新的消息或提要。聊天和消息似乎很适合这种情况，因为 Cassandra 没有订阅/推送功能。

Write & Read ALL 是一个糟糕的实现。这是一种资源浪费，因为您将获得与使用我上面提到的三种设置之一相同的一致性。

关于 Write ANY 与 Write ONE 的最后一点说明：ANY 仅确认集群中的任何内容都已收到突变，但 ONE 确认它已被至少一个节点应用。ANY 是不安全的，因为即使负责该突变的所有节点都关闭，或者任何其他可能导致突变在接收后失败的情况，它也可以无错误地返回。它也稍微快一些（我只将它用作非关键日志的异步转储），这是它唯一的优势，但不要相信 100% 的响应。

研究这个关于 cassandra 的主题的一个很好的参考是[http://www.datastax.com/docs/1.2/dml/data_consistency](http://www.datastax.com/docs/1.2/dml/data_consistency)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T22:28:39.367

如果您想在任何阅读时始终保持一致，则规则是

（写一致性级别+读一致性级别）>复制因子。

所以你可以

```
Write All + Read All (worst solution)
Write One + Read All (second-worst solution)
Write All + Read One (probably faster solution)
Write Quorum + Read Quorum (imho, best solution) 
```

我想记住，如果在 r/w 操作期间 RF 的一个节点关闭，则操作将失败，所以我会避免 CL ALL。

问候， 卡罗

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-01-12T19:00:46.793

根据他们的文档 ( [https://docs.datastax.com/en/cql/3.0/cql/ddl/ddl_counters_c.html](https://docs.datastax.com/en/cql/3.0/cql/ddl/ddl_counters_c.html) )，推荐一致性级别 ONE。我猜想某种合并用于解决计数器列的冲突，而不是通常的最后一次写入胜利。这可能是不允许设置值的原因。

# python - 装饰器可以做到这一点吗？

> ID：15980937
> 
> 赞同：3
> 
> 时间：2013-04-12T21:13:37.893
> 
> 标签：python, python-3.x

我是 python 新手，我在构建真正的应用程序时正在探索我的语言方式。现在我正在尝试构建一个基于事件的应用程序，并且正在考虑使用装饰器作为添加函数作为侦听器的一种方式：

```
@onEvent(eventSpecificArgument)
def foo():
    print('foo') 
```

在上面的示例中，我添加了函数 foo 作为事件的侦听器，并传递了一个将由装饰器使用的参数。

这是我想要的可能（并且足够聪明）的解决方案吗？如果是，我怎么能/应该实施它？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T21:16:51.800

当然，装饰器*只是可调用*的。装饰符号只是语法糖，您的示例转换为：

```
def foo():
    print('foo')
foo = onEvent(eventSpecificArgument)(foo) 
```

所以你的`onEvent()`可调用对象需要返回可以调用的东西；那个“东西”会被传入`foo`。

无论您在`onEvent`返回的“某物”中做什么，都取决于您。

像下面这样的东西会起作用：

```
registry = {}

def onEvent(eventname):
    def eventdecorator(func):
        registry.setdefault(eventname, []).append(func)
        return func
    return eventdecorator 
```

这只是`func`将给定事件名称添加到注册表并返回未更改的函数。

稍后，当您需要处理该事件时，您只需查找该事件的事件处理程序：

```
for func in registry.get(eventname, ()):
    func() 
```

# r - R for循环和带有非数字参数的列表到二元运算符错误

> ID：15980938
> 
> 赞同：1
> 
> 时间：2013-04-12T21:13:38.053
> 
> 标签：r, list, for-loop, dataframe, numeric

提前感谢您花时间帮助我解决我的问题。

我正在尝试编写一个程序来计算几个不同组的标准差，最后一步让我有点难过。

```
data<- read.dta("FinalRfile.dta")
Data<-data
grouplist<-16
grange<-range(Data[grouplist])
groupnum<-grange[2]-grange[1]+1
groupnums<-(1:groupnum)

groupmean<-list()
for (i in groupnums) groupmean[[i]]<-sapply(subset(Data, Data[grouplist] == i),mean)

groupvar<-list()
for (i in groupnums) groupvar[[i]]<-sapply(subset(Data, Data[grouplist] == i),var)
#creating a matrix of the all possible combinations that do not repeat
totcombs<-combn(groupnum,2)
# creating variable for total number of columns, which are total number of combinations
ncombs<-ncol(totcombs)
ncols<-(1:ncombs)

gbias<-list()
# The code below is the section causing the problem
for (i in ncombs) gbias[[i]]<-(groupmean[totcombs[1,i]]-groupmean[totcombs[2,i]])/((groupvar[totcombs[1,i]]-groupvar[totcombs[2,i]])^(.5))

Error in groupmean[totcombs[1, i]] - groupmean[totcombs[2, i]] : 
non-numeric argument to binary operator 
```

基本上我正在尝试使用公式“(mean_1-mean_2/sqrt(variance_1-variance_2)) 与列表 groupmean 和 groupvar 中的变量以及所有可能的组合。例如组 1&2,1&3,1&4,1&5,2&4 等。以下是设置列表的示例以提供帮助

```
>groupmean[1]
[[1]]
         zid     tookphys        black       income          age       female 
3.729809e+05 6.303419e-01 1.783806e-01 8.128384e+03 2.498148e+01 5.080128e-01 
     educdec          num          mhi        disea        child      xghindx 
1.177905e+01 4.027778e+00 7.684203e+01 1.109670e+01 4.209402e-01 7.283730e+01 
     afairnm       ghinnm     xghindx2     planlist 
9.396368e-01 8.173077e-01 5.531082e+03 1.000000e+00    

> totcombs
     [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
[1,]    1    1    1    1    2    2    2    3    3     4
[2,]    2    3    4    5    3    4    5    4    5     5 
```

后注：在人们的帮助下确定。我已经到了它返回值的地步。一些值是 NaN 任何想法。再次感谢。

```
group1<-totcombs[1,]
group2<-totcombs[2,]

gbias<-list()
    > for (i in ncols) gbias[[i]]<-abs(groupmean[[group1[i]]]-groupmean[[group2[i]]])/(sqrt((groupvar[[group1[i]]]+groupvar[[group2[i]]])/2))
> 
> gbias
[[1]]
        zid    tookphys       black      income         age      female 
0.122500336 0.090412751 0.015108219 0.049922006 0.006736868 0.018827112 
    educdec         num         mhi       disea       child     xghindx 
0.092545644 0.077577473 0.010293535 0.069193643 0.019816257 0.074608054 
    afairnm      ghinnm    xghindx2    planlist 
0.029083388 0.133190608 0.063947169         Inf 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:34:57.893

简单地说，该代码并不是最好的方法。最直接的问题是，当您几乎肯定要使用双括号 ( ) 时，您正在使用单括号 ( `[`) 从列表中进行选择。`groupmean``[[`

```
for (i in ncombs) gbias[[i]]<-(groupmean[[totcombs[1,i]]]-groupmean[[totcombs[2,i]]])/((groupvar[[totcombs[1,i]]]-groupvar[[totcombs[2,i]]])^(.5)) 
```

但是，由于您并没有真正做到这一点，因此很难测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:51:27.433

看起来您希望 for 循环对 totcombs 中的每一列进行索引。为此，您可以通过将 totcombs 中的列数分配给 ncombs，然后将从 1 到 ncombs 的数字列表分配给变量 ncols。所以for循环应该开始：

对于（我在 ncols 中）

但是，在您的代码中，结果将是 for 循环将只执行一次，索引 i 等于 10。这并不能解释为什么 R 向二元运算符抱怨非数字参数。

# sql - 大小写和连接，sql

> ID：15980939
> 
> 赞同：-2
> 
> 时间：2013-04-12T21:13:46.753
> 
> 标签：sql, sql-server, case

我使用的是 SQL Server 数据库，但我的案例陈述很难。我想要做的是在 id 字段（state_issue_teacher_id）等于''（空字段）时将属性串联插入。问题是我有一些空的 id 字段，我需要用通过 case 语句连接属性创建的唯一 id 来填充这些字段。

![在此处输入图像描述](https://i.stack.imgur.com/GXHH0.gif)

上面的空行我需要用 last_name+first_name+gender+race_ethnicity_code+high_degree_code+position_code+assignment_code 的串联来填充。

这是我到目前为止所拥有的：

```
SELECT    
        state_issue_teacher_id,
        region_code
        + county_code
        + district_code AS district_code ,
        last_name ,
        first_name ,
        assigned_fte = CASE assign_fte
                  WHEN '' THEN 0
                  ELSE CAST(assign_fte AS NUMERIC(18,
                  2))
                  END ,
        CASE WHEN state_issue_teacher_id = '' THEN 
        RTRIM([last_name]) + '_' + RTRIM([first_name]) + '_' + RTRIM([gender])
        + '_' + RTRIM([race_ethnicity_code]) + '_' + high_degree_code + '_'
        + position_code  + '_' + assignment_code
        ELSE state_issue_teacher_id
        END,
        year_time

FROM      dbo.example 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:28:11.263

When concatenating like that you need to account for two possible problems.

First are all of the fields you are concatenating together varchar (or nvarchar) or are some of them int or numeric? If your datatypes are not varchar or nvarchar, then you need to convert them to use them in a concatentation.

The next possible problem is if one or more of the values can be null. You will need to coalesce any value that could be null with a varchar value (usually a space or empty string for a concatenations although sometimes the value "unknown" works too)) or the concatenation will return null as null concatenated with anything else is null.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:31:56.367

```
SELECT    
    state_issue_teacher_id,
    region_code
    + county_code
    + district_code AS district_code ,
    last_name ,
    first_name ,
    assigned_fte = CASE assign_fte
              WHEN '' THEN 0
              ELSE CAST(assign_fte AS NUMERIC(18,
              2))
              END ,
    CASE WHEN state_issue_teacher_id = '' THEN 
    RTRIM(coalesce([last_name],'ValueYouUseInsteadOfNull')) + '_' + 
    RTRIM(coalesce([first_name],'ValueYouUseInsteadOfNull')) + '_' + 
    RTRIM(coalesce([gender],'ValueYouUseInsteadOfNull')) + '_' + 
    RTRIM(coalesce([race_ethnicity_code],'ValueYouUseInsteadOfNull')) + '_' + 
    coalesce(high_degree_code,'ValueYouUseInsteadOfNull') + '_' + 
    coalesce(position_code,'ValueYouUseInsteadOfNull')  + '_' + 
    coalesce(assignment_code,'ValueYouUseInsteadOfNull')
    ELSE state_issue_teacher_id
    END,
    year_time
FROM      dbo.example 
```

奇怪的是，您在其中一些字段中有 null 。试试这个查询。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:53:26.943

感谢所有回答问题的人。我让它与下面的查询一起工作。

```
SELECT    
    state_issue_teacher_id,
    region_code
    + county_code
    + district_code AS district_code ,
    last_name ,
    first_name ,
    gender,
    race_ethnicity_code,
     high_degree_code, 
    position_code,
    assignment_code,  
    assigned_fte = CASE assign_fte
              WHEN '' THEN 0
              ELSE CAST(assign_fte AS NUMERIC(18,
              2))
              END ,
    state_issue_teacher_id =
    CASE state_issue_teacher_id WHEN  '' THEN
    RTRIM([last_name]) + '_' + RTRIM([first_name]) + '_' + RTRIM([gender])
      + '_' + RTRIM([race_ethnicity_code]) + '_' + high_degree_code + '_'
      + position_code  + '_' + assignment_code
      ELSE state_issue_teacher_id
    END,
    year_time
FROM dbo.example 
```

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-12T21:33:55.603

怎么样？：

```
update example
set state_issue_teacher_id = 
RTRIM([last_name]) + '_' + RTRIM([first_name]) + '_' + RTRIM([gender])
        + '_' + RTRIM([race_ethnicity_code]) + '_' + high_degree_code + '_'
        + position_code  + '_' + assignment_code
WHERE isnull(state_issue_teacher_id, '') = '' 
```

# c# - 'method' 没有重载匹配委托 'delegate'

> ID：15980941
> 
> 赞同：0
> 
> 时间：2013-04-12T21:13:57.933
> 
> 标签：c#, visual-studio-2010, windows-phone-7

*这只是代码的一部分*

几行下来，我正在尝试将 Int 转换为 double。但是 double 是一个数组的事实使得它很难......

我需要像在上一个函数中那样包含“i”，但它不起作用，并且出现以下错误；

**'webKoordx_OpenReadComplete' 没有重载匹配委托 'System.Net.OpenReadCompletedEventHandler'**

如果您知道任何解决方案，或者能够看到我错过的东西，请帮助我！

```
private void getKoord(int i)
    {
        string stringKoX = "http://media.vgy.se/kristoferpk/spots/" + i + "/koordinatx.html";
        string stringKoY = "http://media.vgy.se/kristoferpk/spots/" + i + "/koordinaty.html";

        var webKoordx = new WebClient();
        webKoordx.OpenReadAsync(new Uri(stringKoX));
        webKoordx.OpenReadCompleted += new OpenReadCompletedEventHandler(webKoordx_OpenReadComplete);

        var webKoordy = new WebClient();
        webKoordy.OpenReadAsync(new Uri(stringKoY));
        webKoordy.OpenReadCompleted += new OpenReadCompletedEventHandler(webKoordy_OpenReadComplete);
    }

    void webKoordx_OpenReadComplete(object sender, OpenReadCompletedEventArgs e, int i)//<<-----
    {
        try
        {
            using (var reader = new StreamReader(e.Result))
            {
                koordx = reader.ReadToEnd();
                koordx_d[i] = Convert.ToDouble(koordx);
            }
        }
        catch
        {
            MessageBox.Show("Kan ej ansluta");
            MessageBox.Show("Kontrollera din anslutning");
        }
    }
    void webKoordy_OpenReadComplete(object sender, OpenReadCompletedEventArgs e)//<<-----
    {
        try
        {
            using (var reader = new StreamReader(e.Result))
            {
                koordy = reader.ReadToEnd();
                koordy_d[i] = Convert.ToDouble(koordy);
            }
        }
        catch
        {
            MessageBox.Show("Kan ej ansluta");
            MessageBox.Show("Kontrollera din anslutning");
        }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:26:17.307

您不能将额外的信息传递给这样的事件处理程序。

相反，您可以添加一个 lambda 表达式来处理事件并从其[闭包](http://blog.slaks.net/2011/06/delegates-vs-function-pointers-part-4-c.html)中传递您的额外信息：

```
webKoordx.OpenReadCompleted += (sender, e) => MyMethod(e.Result, i); 
```

# eclipse - 连接到 SQLite

> ID：15980944
> 
> 赞同：0
> 
> 时间：2013-04-12T21:14:08.107
> 
> 标签：eclipse, ubuntu, sqlite

我正在尝试与 SQLite 交互。在我的项目中，我有 sqlite3.c 和 6_1.cpp（我的主要源文件）。

当我尝试编译时，我收到许多与此错误类似的错误：未定义的对 `dlerror' 的引用。根据我读过的内容，这个错误表明 gcc 编译器没有正确链接到某些库。但是，我收到的错误发生在 sqlite3.c 中，而不是 6_1.cpp 中。其他人遇到过这个问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T17:55:56.307

要构建您的程序，请使用以下命令：

```
gcc -c sqlite3.c
g++ -c 6_1.cpp
gcc -o 6_1 6_1.o sqlite3.o -ldl -lpthread 
```

你应该阅读[make](http://en.wikipedia.org/wiki/Make_%28software%29)。

# ios - iOS 相机实时颜色识别：跟踪球

> ID：15980946
> 
> 赞同：3
> 
> 时间：2013-04-12T21:14:10.333
> 
> 标签：ios, opengl-es, camera, real-time, motion-detection

我一直在寻找并知道人们能够使用核心图像和 openGL 跟踪面部。但是，我不确定从哪里开始使用 iOS 相机跟踪彩球的过程。

一旦我有能力跟踪球。我希望创造一些可以检测的东西。当球改变方向时。

抱歉，我没有源代码，但我不确定从哪里开始。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:41:58.283

关键是图像预处理和过滤。您可以使用 Camera API-s 从摄像头获取视频流。从中拍摄快照照片，然后您应该在其上使用高斯模糊（空间增强），然后使用亮度平均阈值过滤器（制作黑白图像）。之后，形态学预处理应该是明智的（打开、关闭运算符），以隐藏小噪音。然后是边缘检测算法（例如 Prewitt 算子）。在这些过程之后，只剩下边缘，你的球应该是一个圆圈（当录制环境理想时）之后你可以使用霍夫变换找到球的中心。您应该记录球的位置，在下一帧中，可以处理图片的一小部分（仅在球周围）。

其他关键字可能是：斑点检测

Brad Larsons 是一个用于图像处理的快速库（在 GPU 上使用 openGL）：GPUImage 库[https://github.com/BradLarson/GPUImage](https://github.com/BradLarson/GPUImage)

它实现了所有需要的过滤器（霍夫变换除外）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-25T17:11:46.043

跟踪过程可以定义如下：

1.  具有给定视觉特征（图像特征）的对象的初始坐标和尺寸
2.  在下一帧视频中，在最后一帧的坐标附近找到相同的视觉特征。

Near 表示考虑与最后一帧相关的基本变换：

*   每个方向的翻译；
*   规模;
*   回转;

这些变换的变化与帧速率密切相关。帧速率越高，最近的位置将在下一帧中。

[Marvin Framework](http://www.marvinproject.org)提供插件和示例来执行此任务。它还与 iO 不兼容。但是，它是开源的，我认为您可以轻松地移植源代码。

该[视频](http://www.youtube.com/watch?v=D5mBt0kRYvk)演示了一些跟踪功能，从 1:10 开始。

# ios - NSMutableArray 添加成一个循环

> ID：15980947
> 
> 赞同：-2
> 
> 时间：2013-04-12T21:14:13.523
> 
> 标签：ios, xcode, arrays, nsmutablearray, cycle

我有这个...

```
allTableData = [[NSMutableArray alloc] initWithObjects:
 [[Food alloc] initWithName:@"1" andDescription:@"Hi man!"],
 [[Food alloc] initWithName:@"2" andDescription:@"Hi woman"],
nil ]; 
```

我怎么能做这样的事情？

```
NSArray *array = [NSArray arrayWithObjects:@"Hi man",@"Hi woman",nil]; 
allTableData = [[NSMutableArray alloc] initWithObjects
for(i=0; i<2; i++)
{
   NSString *aString = [NSString stringWithFormat:@"%d", i];
   [[Food alloc] initWithName:aString andDescription:@"array[i]"];
} 
```

...以及通过一个循环进入？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:17:54.437

```
[[Food alloc] initWithName:aString andDescription:@"array[i]"]; 
```

应该

```
[[Food alloc] initWithName:aString andDescription:array[i]]; 
```

在第一种情况下，您添加了 string `"array[i]"`，而您想要访问数组的第 i 个元素。

此外，还有一种更短的方法可以`int`将`NSString`

```
[NSString stringWithFormat:@"%d", i]; 
```

可以替换为

```
@(i).stringValue 
```

数字的`@`语法是 llvm 3.3 引入的一项功能，允许您创建`NSNumbers`文字。`NSNumber`然后有`stringValue`你可以用来获得所需的方法`NSString`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:21:17.783

尝试这个

```
NSArray *array = [NSArray arrayWithObjects:@"Hi man",@"Hi woman",nil]; 
allTableData = [NSMutableArray array];
for(i=0; i<[array count]; i++){
   NSString *aString = [@(i) stringValue];
   Food *food = [[Food alloc] initWithName:aString andDescription:array[i]];
   [allTableData addObject:food];
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:27:57.910

```
NSArray *array = [NSArray arrayWithObjects:@"Hi man",@"Hi woman",nil];
NSMutableArray* tableData = [NSMutableArray arrayWithCapacity:array.count];

[array enumerateObjectsUsingBlock:^(id obj,NSUInteger index,BOOL* stop){

[tableData addObject:[[Food alloc] initWithName:[@(index) stringValue] andDescription:obj]];

}]; 
```

# ruby-on-rails - 为什么 rails noobs 不应该使用 Gem Devise？

> ID：15980949
> 
> 赞同：6
> 
> 时间：2013-04-12T21:14:18.623
> 
> 标签：ruby-on-rails, ruby, devise, gem

我是铁轨上的红宝石菜鸟。相比之下，我的 HTML CSS javascript 和 jQuery 相当不错。最近，我使用 Michael Hartl 的本教程进入了 ruby​​ on rails：[http](http://ruby.railstutorial.org/ruby-on-rails-tutorial-book) ://ruby.railstutorial.org/ruby-on-rails-tutorial-book 。

但唉，我正在尝试构建自己的项目并使用[gem devise](https://github.com/plataformatec/devise)作为一种简单的身份验证方式。因为初学者很难进行身份验证。然而，每个人都提到菜鸟不应该使用这个宝石。

为什么菜鸟不应该为自己的项目使用设计？

完全感谢您提供的任何提示，但我更喜欢冗长的答案。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-12T22:42:09.907

我完全不同意你迄今为止给出的建议，包括这里的其他答案。

滚动您自己的身份验证，尤其是作为初学者，是让您的用户面临风险的好方法。安全性（尤其是加密）很难，即使您有经验，您也可能会以某种方式弄错。

如果您想了解基于密码的身份验证的工作原理（并且应该），请在空闲时间学习。不要让您的用户在不知情的情况下测试受试者并将他们的隐私置于危险之中。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-04-12T21:29:07.077

除非您打算在不做任何修改的情况下直接使用 Devise，否则使用 Devise 可能会比编写自己的身份验证花费更多时间。

这取决于您的需求有多复杂。例如，是否需要忘记密码功能、验证功能等...

使用 Rails 实现您自己的身份验证非常简单`has_secure_password`。了解幕后发生的事情也非常有帮助。这是学习过程的一部分，简单而有趣。

编写一个基本的身份验证实际上需要大约 10 行代码。正如其他人所说，除非您有迫切需要，否则请按照教程进行操作。你会从中学到很多好东西，而使用 Devise 会让你错过很多重要的信息。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-12T21:24:26.433

这个想法是，作为一个菜鸟，学习身份验证如何工作的基础知识非常有用。即使在未来的项目中您最终一直使用 Devise，拥有开发自己的身份验证的经验以便您了解 Devise 幕后发生的事情也是非常有帮助的。

您需要对此做出自己的决定。如果您急于推出一款应用程序，那么首先学习如何使用 Devise 可能是正确的方法。如果你有时间，试着弄清楚如何自己动手是个好主意。至少，值得您花时间查看 Ryan Bates 自己制作的视频：[http ://railscasts.com/episodes/250-authentication-from-scratch](http://railscasts.com/episodes/250-authentication-from-scratch)

此外，这来自 Devise 文档阻止新的 Rails 开发人员使用 Devise： [https ://github.com/plataformatec/devise#starting-with-rails](https://github.com/plataformatec/devise#starting-with-rails)

# python - 具有特殊情况的 Python 规范化路径名

> ID：15980953
> 
> 赞同：1
> 
> 时间：2013-04-12T21:14:40.680
> 
> 标签：python, debugging, path, directory, normalization

考虑下面的例子

```
#junk path ending with a test file
test = "C:\\test1/test2\test3.txt" 
```

with`import os`和`os.path.abspath`in 可以规范化路径名

```
test_norm = os.path.abspath(test)
print test_norm    
C:\\test1\\test2\test3.txt' 
```

如果我将路径名拆分为`os.path.split`我有以下问题

```
os.path.split(test_norm)
('C:\\test1', 'test2\test3.txt') 
```

代替

```
C:\\test1\\test2 and test3.txt 
```

此问题源于用户键入`input_raw`目录作为示例的事实。我可以避免这种情况`raw_input`吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T21:16:11.083

Easy：`'\t'`是一个制表符。您需要使用`'C:\\test1\\test2\\test3.txt'`或`r'C:\test1\test2\test3.txt'`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-12T21:18:10.873

你没有逃脱最后的斜线，所以 python 认为你想要一个制表符 (\t) 而不是分隔符 (\\)。`test = "C:\\test1/test2\test3.txt"`应该是`test = "C:\\test1/test2\\test3.txt"`。

# android - 安卓返回软键怎么用

> ID：15980955
> 
> 赞同：0
> 
> 时间：2013-04-12T21:14:45.807
> 
> 标签：android, back-button, back

我有一个简短的问题：

我是 android 世界的新手，我现在开始编写一个小应用程序。现在我已经完成并在我的三星 Galaxy S3 上调试了它。该应用程序有 4 种布局。使用一个按钮，您可以转到下一个布局。所以，我会说，如果我按下设备上的后退软键，它会返回到最后一个布局（比如从布局 4 到布局 3）。当我在我的设备上测试它时，如果我按下返回软键，它总是会关闭应用程序。

如果显示 main_actity，我可以做什么，如果按下后退软键，按下应用程序将更改为以前的布局并关闭？

非常感谢每一个答案。

最诚挚的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:21:24.997

`onBackPressed()`您可以在 Activity 的回调中响应后按。请注意，从用户的角度来看，您所做的任何事情都是有意义的。在您的视图层次结构中返回一个“页面”并关闭应用程序，这一切似乎都很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:16:56.593

你所谓的“新布局”应该是一个新的活动/片段。没有其他的

时期

不要试图改变这种行为。

```
Intent myIntent = new Intent(CurrentActivity.this, NextActivity.class);
CurrentActivity.this.startActivity(myIntent); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-08-05T03:53:23.323

按照您的说法，您希望后退按钮在布局之间导航。然而，后退按钮在活动中导航。如果您需要后退按钮来执行除浏览活动之外的其他操作，则必须将其包含在`onBackPressed()`方法中。例如，如果你想从 layout2 移动到 layout1 你可以这样做：

```
@Override
    public void onBackPressed() {
        //do something to hide layout2 and show layout1.
        //You can use View.visibility or anything!    
    } 
```

> 这是众多解决方案之一。

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2019-08-05T00:05:02.917

您应该在当前活动中输入这些代码以在设备上按回时转到 WantActivity：

```
onBackPressed()
{
startActivity(new(Intent(currentActivity.this , wantedActivity.class));
} 
```

# html - 不能使 DIV 在父 div 内浮动

> ID：15980958
> 
> 赞同：1
> 
> 时间：2013-04-12T21:14:54.007
> 
> 标签：html, css

我有 2 个 DIV 元素（下面标有“模块”的那些不正确！当我尝试浮动它们时，它们会并排显示，它们会跳出父容器并落在它下面。我一直无法解决这个问题，有人可以帮忙吗？

jsfiddle：[jsfiddle](http://jsfiddle.net/FAPCW/)

HTML

```
 <div id="contentwrap">
        <div id="content">
            <div>
                <span style="text-align:center;">
                    <h2>Application Title</h2>
                </span>
            </div>
            <br/>
            <br/>
            <div class="module">
                <a class="modlink" href=" ../csc/index.php">
                    <img class="modimg" src="./images/csc.png" alt="csc"/>
                    <br/>Client Support Center
                </a>
                <br/>
            </div>
            <div class="module">
                <a class="modlink" href=" ../icm/index.php">
                    <img class="modimg" src="./images/icm.png" alt="icm"/>
                    <br/>Inventory Control Management
                </a>
                <br/>
            </div>                
        </div>
    </div> 
```

CSS

```
 body {
        font-family: Verdana, Arial, Helvetica, sans-serif;
        font-size: 13px;
        color:#E1E6FA;
        background-color:#183152;
    }

    p {
        padding: 10px;
    }

    h1 { 
        font-size: 2em; 
    }
    h2 { 
        font-size: 1.5em; 
    }
    h3 {
        margin-bttom:2px;
    }

    #wrapper {
        margin: 0 auto;
        width: 1000px;
    }

    #headerwrap {
        width: 1000px;
        float: left;
        margin: 0 auto;
    }

    #header {
        height: 100px;
        background: #375D81;
        border-radius: 10px;
        border: 1px solid #C4D7ED;
        margin: 5px;
    }

    #contentwrap {
        width: 820px;
        float: left;
        margin: 0 auto;
    }

    #content {
        background: #ABC8E2;
        border-radius: 10px;
        border: 1px solid #C4D7ED;
        margin: 5px;
        color:black;
    }

    #companylabel {
        margin: 10px;
        top:50%;
        position:absolute;
        margin-top:-.5em;
    }

    #loginbox
    {
        width:100%;

    }

    #loginboxbot
    {
        width:100%;

    }

    .ra
    {
        text-align:right;
    }

    #borderresults {
        color:orangered;
        font-weight:bold;
        padding:0px;
        margin:0px;
        border-radius:10px;
    }

    #alert {
        background-color:yellow;
    }

    .module {
        text-align:center;
        width:120px;
        padding:5px;
        border-radius:5px;
        border: 1px solid #E1E6FA;
        color:#E1E6FA;
        background-color:#375D81;
        float:left;
    }

    .modimg {
        height:100px;
        width:100px;
    }

    .modlink {
        color:#E1E6FA;
        text-decoration:none;
    } 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-12T21:33:24.177

这非常简单，您只需在内容 div 上添加溢出：自动我在这里为您完成了它，它可以工作。

[http://jsfiddle.net/alaingoldman/FAPCW/5/](http://jsfiddle.net/alaingoldman/FAPCW/5/)

```
#content {
...
overflow:auto;
} 
```

享受并 +1 我 :)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T21:23:14.837

不是最优雅的修复，但我在你`<br style="clear:both">`的第二个下方添加了一个，这似乎可以解决问题，尽管违反了语义标记。`.module``container`

[http://jsfiddle.net/FAPCW/1/](http://jsfiddle.net/FAPCW/1/)

这是一个常见问题，通常通过“clearfix”修复。

存在很多版本。这是关于一般问题的更多详细信息：http: [//perishablepress.com/lessons-learned-concerning-the-clearfix-css-hack/](http://perishablepress.com/lessons-learned-concerning-the-clearfix-css-hack/)

这里有更多信息：[https ://stackoverflow.com/a/10184992/363701](https://stackoverflow.com/a/10184992/363701)

这是我使用的一个：

```
.cf:before, .cf:after { content: " "; display: table; }
.cf:after { clear: both; }
.cf { *zoom: 1; } 
```

您只需将`cf`类放在容器上，漂浮的孩子就会被正确清除。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-12T21:23:31.057

典型的新手玩意！在“浮动” div 的末尾使用具有清晰两种样式的 div。

```
 <div class="module">
            <a class="modlink" href=" ../csc/index.php">
                <img class="modimg" src="./images/csc.png" alt="csc"/>
                <br/>Client Support Center
            </a>
            <br/>
        </div>
        <div class="module">
            <a class="modlink" href=" ../icm/index.php">
                <img class="modimg" src="./images/icm.png" alt="icm"/>
                <br/>Inventory Control Management
            </a>
            <br/>
        </div>
        *<div style="clear:both"></div>*    
    </div>
</div> 
```

# ruby-on-rails - 如何从 Foreman 启动一个支持 Thin Socket 的集群

> ID：15980959
> 
> 赞同：1
> 
> 时间：2013-04-12T21:14:55.423
> 
> 标签：ruby-on-rails, nginx, thin, foreman

[我正在尝试在Nginx](http://nginx.org)代理后面设置[Discourse ，通过](http://discourse.org)[Thin](http://code.macournoyer.com/thin/)提供服务并通过[Foreman](https://github.com/ddollar/foreman)启动。

所以我有一个`Procfile`这样的：

```
web: thin start -p $PORT --socket tmp/sockets/thin.sock
sidekiq: bundle exec sidekiq -e $RAILS_ENV
clockwork: bundle exec clockwork config/clock.rb 
```

`conf`还有一个指向套接字的 nginx文件：

```
upstream discourse {
  server unix:///var/www/discourse/tmp/sockets/thin.sock;
} 
```

这一切都很好......只要我只想要一个连接到套接字的网络工作者。如果我只是`thin`自己运行，我可以加入 a`-s4`并获得四个瘦工人，它甚至可以处理套接字文件，创建`thin.0.socket`,`thin.1.socket`等。但是以`thin`这种方式运行会在他们自己的进程中启动工人，然后退出，所以如果我把它`-s4`放进我的`Procfile`，`foreman`认为有什么东西死了，然后瀑布，也把它自己弄下来了。

只是告诉`foreman start -c web=2`带来了两个进程......但它们都指向同一个`sock`文件，而且似乎都不起作用。

我敢肯定有一个简单的方法来处理这个，但我似乎无法弄清楚魔法咒语。我在这里做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T08:35:40.900

所以这有效：

```
# Procfile
web: thin start -p 9292 --socket /tmp/thin.0.sock
web: thin start -p 9293 --socket /tmp/thin.1.sock
web: thin start -p 9294 --socket /tmp/thin.2.sock
# and so on 
```

和

```
# nginx.conf
upstream backend {
  server unix:/tmp/thin.0.sock
  server unix:/tmp/thin.1.sock
  server unix:/tmp/thin.2.sock
} 
```

[编辑] 我认为使用 unix 套接字时不需要端口选项。

* * *

[编辑 2] 好的，在我昨天测试之后，我开始阅读更多关于瘦、unix 套接字和 nginx 的主题，并找到了这个博客：http: [//jordanhollinger.com/2011/04/22/threaded-thin-is -really-really-slow-on-ruby-1-9-2/](http://jordanhollinger.com/2011/04/22/threaded-thin-is-really-really-slow-on-ruby-1-9-2/)。关于这个的很多或资源。在此处添加它，因为它可能会帮助人们寻找它。

* * *

# entity-framework - 对基于 ASP.NET MVC Onion 架构的看法

> ID：15980963
> 
> 赞同：20
> 
> 时间：2013-04-12T21:15:17.090
> 
> 标签：entity-framework, asp.net-mvc-4, onion-architecture

您对以下“通用”代码优先洋葱启发的 ASP.NET MVC 架构有何看法： ![解决方案资源管理器的屏幕截图](https://i.stack.imgur.com/Q1Ngh.png)

层，解释：

**核心**- 包含领域模型。例如，这就是业务对象及其关系。我正在使用实体框架来直观地设计实体及其之间的关系。它让我为数据库生成一个脚本。我得到了自动生成的类似 POCO 的模型，我可以在下一层（持久性）中自由地引用它们，因为它们很简单（即它们不是特定于数据库的）。

**持久性**- 存储库接口和实现。基本上是域模型上的 CRUD 操作。

**BusinessServices** - 存储库周围的业务层。所有的业务逻辑都应该在这里（例如`GetLargestTeam()`，等等）。使用 CRUD 操作来组合返回对象或获取/过滤/存储数据。应包含所有业务规则和验证。

**Web（或任何其他 UI）** ——在这种特殊情况下，它是一个 MVC 应用程序，但该项目背后的想法是提供 UI，由业务服务提供的驱动。UI 项目使用业务层并且无法直接访问存储库。MVC 项目有自己的 View 模型，它们特定于每个 View 情况。我不是想强制喂它领域模型。

**所以引用是这样的：** UI -> 业务服务 -> 存储库 -> 核心对象

**我喜欢它的地方：**

*   我可以设计我的对象，而不是手动编码。我正在获取代码生成的模型对象。
*   UI 由业务层驱动/强制执行。不同的 UI 应用程序可以针对相同的业务模型进行编码。

**百感交集：**

*   好吧，我们有一个可插入的存储库实现，但是你真的多久有一次相同持久性接口的不同实现？
*   UI 也是如此——我们拥有针对相同业务规则实现不同 UI 应用程序的技术能力，但是当我们可以简单地呈现不同的视图（移动设备、桌面设备等）时，我们为什么要这样做呢？
*   我不确定 UI 是否应该只通过视图模型与业务层通信，或者我应该像现在一样使用域模型来传输数据。对于显示，我使用视图模型，但对于数据传输，我使用域模型。错误的？

**我不喜欢的：**

*   现在在所有其他项目中都引用了核心项目 - 因为我想要/必须访问域模型。在经典的 Onion 架构中，核心仅被下一层引用。
*   DbContext 是在 .Core 项目中实现的，因为它是由实体框架生成的，位于 .edmx 所在的相同位置。我实际上想使用 .EDMX 进行可视化模型设计，但我觉得 DbContext 属于 Persistence 层，位于特定于数据库的存储库实现中的某个位置。

作为最后一个问题 - 什么是一个没有过度设计的好架构（例如成熟的洋葱，我们有注入，服务定位器等），但同时在你会的地方提供了一些合理的灵活性真的需要吗？

谢谢

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-04-15T15:59:08.480

哇，这里有很多话要说！;-)

首先，让我们谈谈整体架构。

我在这里看到的是它并不是真正的洋葱架构。您忘记了最外层，即“依赖解析”层。在 Onion 架构中，由这一层将核心接口连接到基础设施实现（您的持久性项目应该驻留的地方）。

以下是您应该在 Onion 应用程序中找到的内容的简要说明。核心层的内容是业务独有的一切：领域模型、业务工作流……这一层将所有技术实现需求定义为接口（即：存储库接口、日志接口、会话接口……）。核心层不能引用任何外部库，也没有特定于技术的代码。第二层是基础设施层。这一层提供了非业务核心接口的实现。这是您调用数据库、Web 服务的地方……您可以引用提供实现所需的任何外部库，根据需要部署尽可能多的块 :-)。第三层是你的 UI，你知道在里面放什么 ;-) 最后一层，就是我上面提到的依赖解析。

层之间的依赖方向是朝向中心的。

下面是它的样子：

![洋葱应用结构](https://i.stack.imgur.com/bpfhF.jpg)

现在的问题是：如何在 Onion 架构中适应您已经编码的内容。

> 核心：包含领域模型

是的，这是正确的地方！

> 持久性 - 存储库接口和实现

好吧，您需要将接口与实现分开。接口需要移到 Core 中，实现需要移到 Infrastructure 文件夹中（您可以将此项目称为 Persistence）。

> BusinessServices - 存储库周围的业务层。所有的业务逻辑都应该在这里

这需要在 Core 中移动，但您不应该在此处使用存储库实现，只需操作接口！

> Web（或任何其他 UI）——在这种特殊情况下，它是一个 MVC 应用程序

凉爽的 ：-）

您将需要添加一个“Bootstrapper”项目，只需在[此处](https://stackoverflow.com/questions/14891371/dependency-resolution-in-onion-architecture)查看如何继续。

关于你的复杂感受：

我不会讨论是否需要拥有存储库，你会在 stackoverflow 上找到很多答案。

在我的 ViewModel 项目中，我有一个名为“Builder”的文件夹。由我的构建者与我的业务服务接口讨论以获取数据。构建器将接收 Core.Domain 对象的列表，并将它们映射到正确的 ViewModel。

关于你不喜欢的：

> 在经典的 Onion 架构中，核心仅被下一层引用。

错误的 ！:-) 每一层都需要核心才能访问其中定义的所有接口。

> DbContext 在 .Core 项目中实现，因为它是由实体框架生成的，在 .edmx 所在的同一位置

再一次，只要编辑与您的 EDMX 关联的 T4 模板真的很容易，这不是问题。您只需要更改生成文件的路径，就可以在基础设施层中拥有 EDMX，在 Core.Domain 项目中拥有 POCO。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-13T13:46:50.837

我将我的服务注入到我的控制器中。服务返回驻留在核心中的 DTO。您拥有的模型看起来不错，我不使用存储库模式，但很多人使用。我很难在这种类型的架构中使用 EF，这就是我选择使用 Nhibernate 的原因。

您最后一个问题的可能答案。

1.  核
2.  领域
3.  DI
4.  基础设施
5.  介绍
6.  服务

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-03-03T23:17:40.533

在我看来：

*   “在经典的 Onion 架构中，核心仅被下一层引用。” 这不是真的，核心应该被任何层引用......记住层之间的依赖方向是朝向中心（核心）。

![在此处输入图像描述](https://i.stack.imgur.com/xZs2l.png)

“上面的层可以使用它们下面的任何层”作者 Jeffrey Palermo [http://jeffreypalermo.com/blog/the-onion-architecture-part-3/](http://jeffreypalermo.com/blog/the-onion-architecture-part-3/)

*   关于你的 EF，它在错误的地方......它应该在基础设施层而不是核心层。并使用 POCO Generator 在 Core/Model 中创建实体（POCO 类）。或使用自动映射器，以便您可以将核心模型（业务对象）映射到实体模型（EF 实体）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-07-05T10:37:13.377

你所做的看起来很不错，基本上是我经常看到的两种标准架构之一。

> 百感交集：
> 
> 好吧，我们有一个可插入的存储库实现，但是你真的多久有一次相同持久性接口的不同实现？

Pluggable 经常被吹捧为很好的设计，但我从未见过一个团队将某项的主要实现换成其他的。他们只是修改现有的东西。恕我直言，“可插拔性”仅对能够模拟组件以进行自动化单元测试有用。

> 我不确定 UI 是否应该只通过视图模型与业务层通信，或者我应该像现在一样使用域模型来传输数据。对于显示，我使用视图模型，但对于数据传输，我使用域模型。错误的？

我认为视图模型是一个 UI（MVC Web）问题，例如，如果您添加了不同类型的 UI，它可能不需要视图模型或可能需要不同的东西。所以我认为业务层应该返回域实体并允许它们映射到 UI 层中的视图模型。

> 我不喜欢的：
> 
> 现在在所有其他项目中都引用了核心项目 - 因为我想要/必须访问域模型。在经典的 Onion 架构中，核心仅被下一层引用。

正如其他人所说，这是很正常的。通常一切最终都依赖于域。

> DbContext 是在 .Core 项目中实现的，因为它是由实体框架生成的，位于 .edmx 所在的相同位置。我实际上想使用 .EDMX 进行可视化模型设计，但我觉得 DbContext 属于持久层，位于特定于数据库的存储库实现中的某个位置。

我认为这是实体框架的结果。如果你在“代码优先”模式下使用它，你实际上可以——而且通常会——在持久层中拥有上下文和存储库，在你所谓的核心中使用域（表示为 POCO 类）。

> 作为最后一个问题 - 什么是一个没有过度设计的好架构（例如成熟的洋葱，我们有注入，服务定位器等），但同时在你会的地方提供了一些合理的灵活性真的需要吗？

正如我上面提到的，除了允许自动化单元测试外，我不会担心需要交换东西。除非有您知道的特定要求，否则这很有可能。

祝你好运！

# javascript - jQuery blur()....它究竟是如何工作的？

> ID：15980965
> 
> 赞同：1
> 
> 时间：2013-04-12T21:15:40.030
> 
> 标签：javascript, jquery, blur

我为响应式网站创建了一个移动下拉菜单，当您单击某个元素时，它实质上会显示一个隐藏的无序列表。它工作得很好，除了我无法让 blur() 函数工作，因此当用户单击页面上除菜单内部以外的任何位置时，它会隐藏菜单。这是一个代码笔：http: [//codepen.io/trevanhetzel/pen/wIrkH](http://codepen.io/trevanhetzel/pen/wIrkH)

我的 javascript 看起来像这样：

```
$(function() {
    var pull = $('#pull');
    menu = $('header ul');

    $(pull).on('click', function(e) {
        e.preventDefault();
        $('.close-menu').toggle();
        $('.mobi-nav span').toggle();
        menu.slideToggle(250);
    });

    $(menu).blur(function() {
        $(this).slideToggle();
    });
}); 
```

我过去一直在与 blur() 作斗争，所以真的很想一劳永逸地弄清楚它是如何工作的，以及我是否在这里正确的上下文中使用它。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:23:07.580

您必须自己注意点击。并使用[$.contains](http://api.jquery.com/jQuery.contains/)查看单击的内容是否在您的菜单中：

```
$(document).click(function (ev) {
    if (ev.target !== menu.get(0) && !$.contains(menu.get(0), ev.target)) {
       menu.slideUp();
    }
}); 
```

只需确保在切换单击处理程序中调用 ev.stopPropagation() 以防止上面的处理程序在事件冒泡时立即关闭菜单。

# ruby-on-rails - 将密码字段设置为 attr_accessible 是否安全？

> ID：15980968
> 
> 赞同：2
> 
> 时间：2013-04-12T21:15:45.413
> 
> 标签：ruby-on-rails, security, mass-assignment

```
attr_accessible :email, :password, :password_confirmation 
```

如果没有，您能否举例说明在删除 attr_accessible 时防止“未定义”错误的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-12T22:40:31.417

如果你是安全偏执狂，你可以这样做是定义方法密码：

```
def password
  self.password
end 
```

这样密码就不能手动设置了。

但是你不应该担心它，因为许多像 devise 这样的登录 gem 需要 attr_accessible 中的密码。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-13T05:55:38.020

这是安全的。Attr_accessible 仅对控制应用程序逻辑的属性是危险的。例如，如果您有一个标志，上面写着“是的，我已经检查过这个用户是管理员”，并且它可以由用户设置，因为它是 attr_accessible，那么它就是一个漏洞。

由于密码是由用户提供的一条信息，因此使其可由同一用户设置并不会改变任何内容。

# python - 为什么我的代码在 else 语句中不起作用？

> ID：15980969
> 
> 赞同：-1
> 
> 时间：2013-04-12T21:15:48.917
> 
> 标签：python, if-statement

任何人都可以帮我处理我的代码。我写了一个小程序，以便我可以了解一些功能以及发生了什么。让我告诉你我的代码。

```
print "Hello student need help multiplying by any mutiplicaton"
student = raw_input("If so then tell me which ones? => ").lower()
for i in range(0, 11):
    if student == str(0):
       i_num = 0 * i
       print "0 times %d equals %d" % (i,i_num)
    elif student == str(10):
       i_num = 1 * 1
       print "1 times %d equals %d" % (i,i_num)
else:
    print "Try this program when you can't figure it out your multiplications." 
```

如果学生输入的内容与 if 语句无关，它将打印 else。但是，如果学生输入 str(1)，它会打印乘法并打印 else，这是我不想发生的代码问题。谁能帮我。我只是想学习 if 和 elif 的这个功能等等。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:17:48.437

当前`else`设置为运行就成功完成了`for`循环，看看缩进。如果将它移到循环内，一切正常。您的代码确实包含一些语法错误。

您的程序的固定版本：

```
print "Hello student need help multiplying by any mutiplicaton"
student = raw_input("If so then tell me which ones? => ") # no need for lower()
for i in range(0, 11):
    if student == '0':
        i_num = 0 * i
        print "0 times %d equals %d" % (i,i_num)
    elif student == '1':
        i_num = 1 * 1
        print "1 times %d equals %d" % (i,i_num)
    else:
        print "Try this program when you can't figure it out your multiplications." 
```

但是乘法很容易，所以为什么不这样做：

```
print "Hello student need help multiplying by any mutiplicaton"
num = int(raw_input("If so then tell me which ones? => "))
for i in range(0, 11):
    print "%d times %d equals %d" % (num, i, i * num) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:23:56.773

你在这里缺少一个）：

```
elif student == str(10): 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-12T21:36:38.020

```
def isAnInt(s):
   try: 
      int(s)
      return True
   except ValueError:
    print "You must enter a number"

print "Hello student need help multiplying by any mutiplicaton"
student = raw_input("If so then tell me which ones? => ")
if(isAnInt(student)):
  number_to_calc = int(student)
  for i in range(0,11):
    i_num = number_to_calc * i
    print "%d times %d equals %d" % (number_to_calc, i, i_num) 
```

# plsql - 使用序列作为主键

> ID：15980970
> 
> 赞同：1
> 
> 时间：2013-04-12T21:15:55.333
> 
> 标签：plsql, oracle11g, oracle-sqldeveloper, plsqldeveloper

我有一个名为的表`INTER`，我想使用一个过程将一些数据传输`INTER`到`FINAL`（一个已经创建且为空的新表）。

我必须使用序列作为`FINAL`表的主键。`INTER`是父表，它的所有列都存在于`FINAL`.

我创建了一个序列`M_SQ`。这是我尝试过的：

```
create or replace 
PROCEDURE STAGING_TO_CUSTOMER
    AS
     BEGIN
         INSERT INTO FINAL (C_ID,C_NAME,C_PHONE,C_ADDRESS)
         SELECT M_SQ.NEXTVAL,C_NAME,C_PHONE,C_ADDRESS FROM INTER;
         COMMIT;
         EXCEPTION
         WHEN OTHERS THEN
         ROLLBACK;
     END; 
```

此过程已编译，但没有记录传输到`FINAL`.

有人可以帮忙吗？我正在使用 sqldeveloper 11g。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T21:20:41.000

您不需要存储过程 - 您可以按原样运行命令：

```
INSERT INTO FINAL (C_ID,C_NAME,C_PHONE,C_ADDRESS) SELECT M_SQ.NEXTVAL,C_NAME,C_PHONE,C_ADDRESS FROM INTER; 
COMMIT; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T22:06:56.877

您实际上必须运行该程序才能执行其中的操作：

```
BEGIN
    STAGING_TO_CUSTOMER;
END; 
```

此外，您的程序也可能如下所示：

```
CREATE OR REPLACE PROCEDURE STAGING_TO_CUSTOMER AS
BEGIN
     INSERT INTO FINAL (C_ID,C_NAME,C_PHONE,C_ADDRESS)
     SELECT M_SQ.NEXTVAL,C_NAME,C_PHONE,C_ADDRESS FROM INTER;
     COMMIT;
     EXCEPTION
     WHEN OTHERS THEN
         ROLLBACK;
         RAISE;
END; 
```

所以你知道如果有什么事情发生。

# javascript - 内联 SVG 与 embedded I'm building an in-game browser RoR app for Eve Online. One of the requirements of my app is displaying an SVG graph generated by graphviz. I'm having some issues getting my requirements met within this environm 问问题 问问题 2013-04-12T21:15:59.873 2734 次 This question shows research effort; it is useful and clear 12 This question does not show any research effort; it is unclear or not useful Bookmark this question. Show activity on this post. I'm building an in-game browser RoR app for Eve Online. One of the requirements of my app is displaying an SVG graph generated by graphviz. I'm having some issues getting my requirements met within this environment. No official documentation is available for Eve's IGB, but the wiki indicates: The new EVE Online in-game browser (code-named Moondoggie) is based on a technology stack combining two elements: Awesomium: A middleware layer that delivers rendered webpages as data parseable by a 3D engine. Awesomium is developed by Khrona Software. Chromium: A middleware layer that provides interprocess communication, webpage rendering, HTTP communications, and all the other basics needed for writing a web browser. It is, itself, based on Apple’s Webkit framework. Chromium is an open-source project championed primarily by Google. Because of this, Moondoggie is able to pass the Acid3 test and thus can support the full HTML 4.01 and CSS3 specifications. I need the links I'm including in the SVG to have access to my app's javascript. Embedding it with <embed> or <object> puts the SVG out of the scope of my JS files. Using <embed> or <object> DOES render the svg properly within the in-game browser. When it is inline like I have it below, it displays one line of text containing JUST the text elements from the SVG. Update Here's where I'm at. I'm pretty sure most of this is redundant, as I didn't notice a difference by just using the render file: inside my view on its own. I think the mime type registration is more for use with respond_to, but I'm not really sure how to use that in this scenario. snippet of main view: <%= render "map/map" %> partial view file: <html xmlns="http://www.w3.org/1999/xhtml" xmlns:svg="http://www.w3.org/2000/svg"> <head> <title>Embedded SVG</title> </head> <body> <%= render file: @map.output_file_path %> </body> </html> config/initializers/mime_types.rb: Mime::Type.register "image/svg+xml", :svg I don't understand why it renders fine inside an <object> tag but not when inline. How do I emulate the environment inside an <object> in my main view? Or, how can I give the <object> tag access to my javascript functions? ODP.NET Connection Pooling Parameters I am trying to configure connection pooling for my .NET application using ODP.NET version 2.111.6.20\. The database is Oracle 11.1. I am using the following connection string in my .NET 2.0 application: Data Source=prod; User Id=FAKE_USER; Password=FAKE_PASS; Pooling=true; Min Pool Size=2; Max Pool Size=5; Connection Timeout=30;" According to the documentation the connection pool should initialize with 2 connections and and increment up to 5 connections as needed. It should never get higher than 5 connections. What I am seeing is the the connections are growing 2 at a time and growing up to 10 connections. I am monitoring the connections in the Oracle database by querying the v$session table so I know the connections are from that specific application originating from my application. If anyone can help me identify what might be happening in the connection pool inside this application that might be allowing for more than the Max number of connections I would appreciate it. Sample C# Code Here is a sample of the code making the calls to the database: const string connectionString = "Data Source=prod; User Id=FAKE_USER; Password=FAKE_PASS; Pooling=true; Min Pool Size=5; Max Pool Size=5; Connection Timeout=30;"; using (OracleConnection connection = new OracleConnection(connectionString)) { connection.Open(); using (OracleCommand command = new OracleCommand("ALTER SESSION SET TIME_ZONE='UTC'", connection)) { command.ExecuteScalar(); } using (OracleTransaction transaction = connection.BeginTransaction()) { const string procSql = @"BEGIN P_SERVICES.UPDATE_VERSION(:id, :version, :installDate); END;"; using (OracleCommand command = new OracleCommand(procSql, connection)) { command.Parameters.Add(new OracleParameter("id", OracleDbType.Varchar2) { Value = id }); command.Parameters.Add(new OracleParameter("version", OracleDbType.Varchar2) { Value = version }); command.Parameters.Add(new OracleParameter("installDate", OracleDbType.TimeStamp) { Value = dateUpdated }); try { command.ExecuteNonQuery(); } catch (OracleException oe) { if (Log.IsErrorEnabled) { Log.ErrorFormat("Update Error: {0}", oe.Message); } throw; } transaction.Commit(); } } } javascriptruby-on-railssvghtml4 4 1 回答 1 This answer is useful 4 可以从父文档访问 <object> 或 <embed> 内的文档。这是 ACID3 仍在测试的（太少的）svg 事物之一。 这是一个如何从父 html 文档中的脚本修改 svg 文档的示例。 于 2013-04-23T13:17:39.920 回答 Related 1 javascript - 从 iFrame 获取元素返回 Null/未定义？ 4 php - php picasa api 显示大图 2 asp.net-mvc-3 - HTML.CheckBox MVC3 的同名 1 macos - 使用现有 CA 颁发的证书签署 OS X 应用程序并让 Gatekeeper 满意 2 vba - 将事件处理程序分配给在 VBA 中动态创建的用户表单上的控件 1 php - php会话ID无缘无故更改 2 scala - 同时在多台（集群）机器上运行 SBT (Scala) 1 mysql - SQL 同列减法 3 android - 安卓sdk。startActivity() 移动 prog。背景 1 css - 滚动条样式表 Reference php × 1429865 c/c++ × 756500 nginx × 49975 mongodb × 159057 mybatis × 3233 anaconda × 13410 pycharm × 14671 python × 1902243 vscode × 56040 docker × 110988 github × 49000 flask × 49129 ffmpeg × 24037 jmeter × 16910 matplotlib × 63493 bootstrap × 54641

> ID：15980971
> 
> 赞同：12
> 
> 时间：
> 
> 标签：javascript, ruby-on-rails, svg, html4

I'm building an in-game browser RoR app for Eve Online. One of the requirements of my app is displaying an SVG graph generated by graphviz. I'm having some issues getting my requirements met within this environment.

No official documentation is available for Eve's IGB, but the wiki indicates:

> The new EVE Online in-game browser (code-named Moondoggie) is based on a technology stack combining two elements:
> 
> Awesomium: A middleware layer that delivers rendered webpages as data parseable by a 3D engine. Awesomium is developed by Khrona Software.
> 
> Chromium: A middleware layer that provides interprocess communication, webpage rendering, HTTP communications, and all the other basics needed for writing a web browser. It is, itself, based on Apple’s Webkit framework. Chromium is an open-source project championed primarily by Google.
> 
> Because of this, Moondoggie is able to pass the Acid3 test and thus can support the full HTML 4.01 and CSS3 specifications.

I need the links I'm including in the SVG to have access to my app's javascript. Embedding it with `<embed>` or `<object>` puts the SVG out of the scope of my JS files.

Using `<embed>` or `<object>` DOES render the svg properly within the in-game browser. When it is inline like I have it below, it displays one line of text containing JUST the text elements from the SVG.

**Update** Here's where I'm at. I'm pretty sure most of this is redundant, as I didn't notice a difference by just using the `render file:` inside my view on its own. I think the mime type registration is more for use with respond_to, but I'm not really sure how to use that in this scenario.

snippet of main view:

```
<%= render "map/map" %> 
```

partial view file:

```
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:svg="http://www.w3.org/2000/svg">
<head>
    <title>Embedded SVG</title>
</head>
    <body>
        <%= render file: @map.output_file_path %>
    </body>
</html> 
```

config/initializers/mime_types.rb:

```
Mime::Type.register "image/svg+xml", :svg 
```

I don't understand why it renders fine inside an `<object>` tag but not when inline. How do I emulate the environment inside an `<object>` in my main view? Or, how can I give the `<object>` tag access to my javascript functions?

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-23T13:17:39.920

可以从父文档访问 <object> 或 <embed> 内的文档。这是 ACID3 仍在测试的（太少的）svg 事物之一。

[这是一个](http://xn--dahlstrm-t4a.net/svg/html/get-embedded-svg-document-script.html)如何从父 html 文档中的脚本修改 svg 文档的示例。

# c# - ODP.NET 连接池参数

> ID：15980979
> 
> 赞同：8
> 
> 时间：2013-04-12T21:16:20.453
> 
> 标签：c#, .net, oracle, connection-pooling, odp.net

我正在尝试使用 ODP.NET 版本 2.111.6.20 为我的 .NET 应用程序配置连接池。数据库是 Oracle 11.1。

我在 .NET 2.0 应用程序中使用以下连接字符串：

`Data Source=prod; User Id=FAKE_USER; Password=FAKE_PASS; Pooling=true; Min Pool Size=2; Max Pool Size=5; Connection Timeout=30;"`

根据文档，连接池应初始化为 2 个连接，并根据需要最多增加 5 个连接。它永远不应超过 5 个连接。

我所看到的是连接一次增长 2 个，并且增长到 10 个连接。我通过查询 v$session 表来监视 Oracle 数据库中的连接，因此我知道这些连接来自源自我的应用程序的特定应用程序。

如果有人可以帮助我确定此应用程序内的连接池中可能发生的情况，可能允许超过最大连接数，我将不胜感激。

**示例 C# 代码**

以下是调用数据库的代码示例：

```
const string connectionString = "Data Source=prod; User Id=FAKE_USER; Password=FAKE_PASS; Pooling=true; Min Pool Size=5; Max Pool Size=5; Connection Timeout=30;";

using (OracleConnection connection = new OracleConnection(connectionString)) {
    connection.Open();

    using (OracleCommand command = new OracleCommand("ALTER SESSION SET TIME_ZONE='UTC'", connection)) {
        command.ExecuteScalar();
    }

    using (OracleTransaction transaction = connection.BeginTransaction()) {
        const string procSql = @"BEGIN P_SERVICES.UPDATE_VERSION(:id, :version, :installDate); END;";
        using (OracleCommand command = new OracleCommand(procSql, connection)) {
            command.Parameters.Add(new OracleParameter("id", OracleDbType.Varchar2) { Value = id });
            command.Parameters.Add(new OracleParameter("version", OracleDbType.Varchar2) { Value = version });
            command.Parameters.Add(new OracleParameter("installDate", OracleDbType.TimeStamp) { Value = dateUpdated });

            try {
                command.ExecuteNonQuery();
            } catch (OracleException oe) {
                if (Log.IsErrorEnabled) {
                    Log.ErrorFormat("Update Error: {0}", oe.Message);
                }

                throw;
            }

            transaction.Commit();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-16T17:12:40.107

我发现数据库中看到的最大连接数增加超过连接字符串中连接池设置中允许的数量的原因。

IIS 中的应用程序池配置为**“最大工作进程数”**设置不同于默认值 1。我发现在数据库中看到的连接数可以增长到`Max Pool Size * Number of Worker Processes`.

因此，如果我的**最大池大小**为 5 和 5 个**工作进程**，则允许的连接总数为 25。所以似乎每个工作进程都有自己的连接池实例，该实例不被其他工作进程共享。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-13T21:33:23.353

您可以使用此查询来监控您的连接计数和状态。使用此查询，我能够确认连接字符串设置是否正常工作，解释如下。

```
select   COUNT(*) AS Connections
        ,s.username
        ,s.status
        ,s.module
        ,s.osuser
from    V$process p
join    V$session s on s.paddr = p.addr
where  NOT s.UserName IS NULL
group by s.username
        ,s.status
        ,s.module
        ,s.osuser 
```

我用 2 个页面运行了这个，这些页面做了一堆数据库检索。这是我的不同结果：

**最大池大小=5**

![最大池大小 = 5](https://i.stack.imgur.com/bxA2d.png)

我看到与网络服务器具有相同用户名的空模块下的计数波动。我不确定他们为什么会出现在那个桶和网络服务器下。

**最大池大小=1**

![最大池大小 = 1](https://i.stack.imgur.com/yX28V.png)

当我限制池大小时，我只看到空模块的 1 个连接和 web 服务器的 1 个连接，但随后在 DBMS_SCHEDULER 下弹出连接，这向我表明其余的检索正在等待？

我认为这证明 Max Pool Size 有效，但我不确定。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-13T18:52:01.923

根据[Tom kyte 的说法：](http://asktom.oracle.com/pls/asktom/f?p=100:11:0%3a%3a%3a%3aP11_QUESTION_ID:5671284058977)
连接是您和数据库之间的物理电路。
连接可能是多种类型之一——最流行的开始是专用服务器和共享服务器。
可以通过与数据库的给定连接建立零个、一个或多个会话 。会话
将使用进程来执行语句。
有时 CONNECTION->SESSION->PROCESS 之间存在一对一的关系（例如：正常的专用服务器连接）。
有时，从连接到会话是一对多的。
进程不必专用于特定的连接或会话，但是，例如，当使用共享服务器 (MTS) 时，您的 SESSION 将从进程池中获取进程以执行语句。当调用结束时，该进程被释放回进程池。
所以运行
`select username from v$session where username is not null` 将显示当前的seeions（不是连接）
查看您可能使用的连接

```
select username, program from v$process; 
```

可以在[这里找到一本关于 JDBC 和 Session VS Connection 的有用书籍](http://books.google.com/books?id=9MsOpXrElhUC&pg=PA529&lpg=PA529&dq=oracle%2b%22sessions%2bvs%2bconnections%22&source=bl&ots=mBwnWKBDQl&sig=XPkoqteZ_B_C8NT1tHh4rS4UKwI&hl=en&ei=s2BCSoKFHI3SMNbyvMAH&sa=X&oi=book_result&ct=result&resnum=1)

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-15T01:39:41.203

如果您绝对必须解决这个问题，并且愿意对性能计数器感到沮丧，那么这篇博文可能会有所帮助。至少，它可能有助于缩小 Oracle 报告的连接数与 .NET 声称拥有的池化和非池化连接数之间的差异。

[http://blog.ilab8.com/2011/09/02/odp-net-pooling-and-connection-request-timed-out/](http://blog.ilab8.com/2011/09/02/odp-net-pooling-and-connection-request-timed-out/)

这些计数器似乎特别有用：

```
NumberOfActiveConnectionPools
NumberOfActiveConnections
NumberOfFreeConnections
NumberOfInactiveConnectionPools
NumberOfNonPooledConnections
NumberOfPooledConnections
NumberOfReclaimedConnections
NumberOfStasisConnections 
```

# javascript - Array sorting creating linked arrays?

> ID：15980981
> 
> 赞同：0
> 
> 时间：2013-04-12T21:16:24.657
> 
> 标签：javascript, arrays

I am creating a Chrome extension and am getting some weird results with sorted arrays. I have two global arrays called "timearray" and "timearrayorig" (timearray is the sorted version of timearrayorig). In a function, I set a bunch of values in timearrayorig and then copy the entire array to timearray and sort timearray. For some reason, this also sorts timearrayorig. I would greatly appreciate it if someone could explain why this is the case.

```
for (var i = 0; i < triparray.length; i++) {
    for (var j = 0; j < trainsfeed.length; j++) {
        if (trainsfeed[j].getElementsByTagName('Trip')[0].childNodes[0].nodeValue == triparray[i]) {
            if (timearrayorig.length < i + 1 || timearrayorig[i] > Number(trainsfeed[j].getElementsByTagName('Scheduled')[0].childNodes[0].nodeValue)) {
                timearrayorig.push(Number(trainsfeed[j].getElementsByTagName('Scheduled')[0].childNodes[0].nodeValue));
            }
        }
    }
}
timearray = timearrayorig;
//timearray.sort(); 
```

(trainsfeed is a bunch of XML separated by messages and triparray is the list of all the different values for the "Trip" field. timearrayorig and timearray are the earliest times for each element of triparray from the elements of trainsfeed.)

If I run this script and find the value of timearrayorig and timearray in the debug console, they are the same, for example [1365801720, 1365801180, 1365801600, 1365802800, 1365800940]. But when I sort timearray, they both become [1365800940, 1365801180, 1365801600, 1365801720, 1365802800].

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-12T21:19:44.070

```
timearray = timearrayorig; 
```

这不会**复制**数组；它创建了第二个变量，它引用了**同一个**数组。仍然只有一个数组，这就是为什么对它进行排序会影响两个变量。要[复制数组](https://stackoverflow.com/questions/7486085/copying-array-by-value-in-javascript)，请执行以下操作：

```
var timearray = timearrayorig.slice(); 
```

有关详细信息，请参阅：[在 JavaScript 中按值复制数组](https://stackoverflow.com/questions/7486085/copying-array-by-value-in-javascript)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-12T21:20:43.547

`timearrayorig`持有对数组的引用，因此当您分配`timearray = timearrayorig;`两个标签时，引用相同的内存空间。

如果要复制数组，可以执行以下操作：

```
timearray = [];
for(var i = 0; i < timearrayorig.length; i++) timerray[i] = timearrayorig[i]; 
```

# django - 带有 django-nose 的 Django：两个相同的设置文件，在运行测试命令时具有不同的行为

> ID：15980984
> 
> 赞同：4
> 
> 时间：2013-04-12T21:16:32.047
> 
> 标签：django, django-testing, django-settings, django-nose

对于 Django 1.4.5，我使用的是 django-nose 1.1.0。

我有两个没有差异的设置文件。

```
-> % diff local_settings.py test_settings/sqlite.py 
```

我运行测试：

```
-> % python manage.py test foo --settings=local_settings 
```

我得到

```
Ran 91 tests in 5.273s
OK (SKIP=6) 
```

从不同位置运行相同的相同设置

```
-> % python manage.py test foo --settings=test_settings.sqlite 
```

测试在没有全部运行的情况下保释：

```
Ran 43 tests in 1.230s
FAILED (errors=1) 
```

我得到了一个回溯，`DatabaseError: no such table: django_content_type` 回溯来自于 url 的加载。在那里实例化的东西调用`ContentType.objects.get_for_model(self.model)`. 当设置相同时，这种差异怎么可能？

我的 manage.py 文件是通用的：

```
#!/usr/bin/env python

from django.core import management

if __name__ == "__main__":
    management.execute_from_command_line() 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T09:29:33.910

您的数据库是否`NAME`设置为 sqlite DB 的相对路径？

如果是这样，您可能只需要使用 test_settings 中的设置文件进行同步。

`DatabaseError: no such table: django_content_type`表示未找到 django 特定表之一，这听起来像是数据库本身的问题，而不是您的应用程序或设置文件本身的问题。

# r - get xts objects from within an environment

> ID：15980985
> 
> 赞同：4
> 
> 时间：2013-04-12T21:16:39.250
> 
> 标签：r, get, environment, xts, quantmod

I have stored xts objects inside an environment. Can I subset these objects while they are stored in an environment, i.e. act upon them "in-place"? Can I extract these objects by referring to their *colname*?

Below an example of what I'm getting at.

```
# environment in which to store data 
data <- new.env()

# Set data tickers of interest
tickers <- c("FEDFUNDS", "GDPPOT", "DGS10")

# import data from FRED database
library("quantmod")
dta <- getSymbols( tickers
  , src = "FRED"
  , env = data
  , adjust = TRUE
) 
```

This, however, downloads the entire dataset. Now, I want to discard some data, save it, use it (e.g. plot it). I want to keep the data within this date range:

```
# set dates of interest
date.start <- "2012-01-01"
date.end <- "2012-12-31" 
```

I have two distinct objectives.

1.  to subset all of the data inside of the environment (either acting in-place or creating a new environment and overwriting the old environment with it).
2.  to take only some tickers of my choosing and to subset those, say FEDFUNDS and DGS10, and afterwards save them in a new environment. I also want to preserve the xts-ness of these objects, so I can conveniently plot them together or separately.

Here are some things I did manage to do:

```
# extract and subset a single xts object 
dtx1 <- data$FEDFUNDS
dtx1 <- dtx1[paste(date.start,date.end,sep="/")] 
```

The drawback of this approach is that I need to type FEDFUNDS explicitly after data$. But I'd like to work from a prespecified list of tickers, e.g.

```
tickers2 <- c("FEDFUNDS", "DGS10") 
```

I have got one step closer to being systematic by combining the function *get* with the function *lapply*

```
# extract xts objects as a list
dtxl <- lapply(tickers, get, envir = data) 
```

But this returns a list. And I'm not sure how to conveniently work with this list to subset the data, plot it, etc. How do I refer to, say, DGS10 or the pair of tickers in tickers2?

I very much wanted to write something like **data$tickers[1]** or **data$tickers[[1]]** but that didn't work. I also tried **paste0('data','$',tickers[1])** and variations of it with or without quotes. At any rate, I believe that the order of the data inside an environment is not systematic, so I'd really prefer to use the ticker's name rather than its index, something like **data$tickers[colnames = FEDFUNDS]** None of the attempts in this paragraph have worked.

If my question is unclear, I apologize, but please do request clarification. And thanks for your attention!

**EDIT: Subsetting**

I've received some fantastic suggestions. **GSee**'s answer has several very useful tricks. Here's how to subset the xts objects to within a date interval of interest:

```
dates <- paste(date.start, date.end, sep="/")
as.environment(eapply(data, "[", dates)) 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T22:10:39.460

这将子集环境中的每个对象，并返回具有子集数据的环境：

```
data2 <- as.environment(eapply(data, "[", paste(date.start, date.end, sep="/"))) 
```

您可以对第二个问题做基本相同的事情。`lapply`只需将返回的列表的组件命名为`setNames`，然后强制转换为环境：

```
data3 <- as.environment(setNames(lapply(tickers, get, envir = data), tickers)) 
```

或者，更好的是，使用`mget`这样您就不必使用`lapply`或`setNames`

```
data3 <- as.environment(mget(tickers, envir = data)) 
```

* * *

或者，我实际上有几个[`qmao`](https://r-forge.r-project.org/R/?group_id=1113)专门为此设计的便利功能： [`gaa`](https://r-forge.r-project.org/scm/viewvc.php/pkg/qmao/R/gaa.R?view=markup&root=twsinstrument)代表“获取、应用、分配”和[`gsa`](https://r-forge.r-project.org/scm/viewvc.php/pkg/qmao/R/gsa.R?view=markup&root=twsinstrument)代表“获取、子集、分配”。

To，获取一些代码的数据，对数据进行子集化，然后分配到环境中

```
gsa(tickers, subset=paste(date.start, date.end, sep="/"), env=data, 
    store.to=globalenv()) 
```

`gaa`允许您在保存到相同或不同环境之前对每个对象应用任何功能。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-12T22:09:29.327

如果我正确地阅读了这个问题，你想要这样的东西：

```
dtxl = do.call(cbind, sapply(tickers2,
           function(ticker) get(ticker, env=data)[paste(date.start,date.end,sep="/")])
       ) 
```

# haskell - Haskell - 获得没有“！！”的第 n 个元素

> ID：15980989
> 
> 赞同：9
> 
> 时间：2013-04-12T21:16:45.367
> 
> 标签：haskell

我需要获取列表的第 n 个元素，但不使用`!!`运算符。我对haskell非常陌生，所以如果您能更详细地回答而不仅仅是一行代码，我将不胜感激。这就是我目前正在尝试的：

```
nthel:: Int -> [Int] -> Int
nthel n xs = 0
let xsxs = take n xs
nthel n xs = last xsxs 
```

但我得到：解析错误（可能不正确的缩进）

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-12T21:39:54.470

这里有很多东西有点不对劲，

```
nthel :: Int -> [Int] -> Int 
```

在技​​术上是正确的，我们真的想要

```
nthel :: Int -> [a] -> a 
```

所以我们可以在任何列表上使用它（可选）

```
nthel n xs = 0 
```

你刚才说的是“不管你付出什么都`nthel`返回0”。这显然是错误的。

```
let xsxs = ... 
```

这不是合法的haskell。`let ... in ...`是表达式，不能用于顶层。

从那里我不确定那应该做什么。

也许这会帮助你走上正确的轨道

```
nthelem n [] = <???> -- error case, empty list
nthelem 0 xs = head xs
nthelem n xs = <???> -- recursive case 
```

尝试填写`<???>`您的最佳猜测，我很乐意从那里提供帮助。

或者，您可以使用 Haskell 的“模式匹配”语法。[我在这里](https://stackoverflow.com/a/15936587/784338)解释了如何使用列表来做到这一点。

这将我们的上述更改为

```
nthelem n [] = <???> -- error case, empty list
nthelem 0 (x:xs) = x --bind x to the first element, xs to the rest of the list
nthelem n (x:xs) = <???> -- recursive case 
```

这样做很方便，因为它不需要使用显式`head`和`tail`s。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2013-04-12T22:23:39.543

我想你的意思是：

```
nthel n xs = last xsxs
  where xsxs = take n xs 
```

...您可以简化为：

```
nthel n xs = last (take n xs) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-13T10:39:29.927

我认为你应该尽可能避免使用`last`- 列表是从“前端”使用的，而不是从后面使用。您想要的是摆脱前 n 个元素，然后获取剩余列表的头部（当然，如果其余部分为空，则会出现错误）。您可以直接将其表达为：

```
nthel n xs = head (drop n xs) 
```

或更短：

```
nthel n = head . drop n 
```

或者有点疯狂：

```
nthel = (head .) . drop 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-13T15:39:52.283

如您所知，列表不是自然索引的，但可以使用通用技巧来克服它。

试试 ghci, `zip [0..] "hello"`, 什么是`zip [0,1,2] "hello"`or `zip [0..10] "hello"`？
从这个观察开始，我们现在可以很容易地获得一种方法来索引我们的列表。
此外，它很好地说明了懒惰的使用，为您的学习过程提供了很好的提示。

然后基于此并使用模式匹配，我们可以提供一种有效的算法。

1.  边界案例的管理（空列表、负索引）。
2.  使用 zipper 将列表替换为索引版本。
3.  调用辅助函数设计来递归处理我们的索引列表。

现在对于辅助函数，列表不能为空，然后我们可以天真地进行模式匹配，并且，

*   如果我们的索引等于 n 我们就有赢家
*   否则，如果我们的下一个元素为空，则结束
*   否则，使用下一个元素调用辅助函数。

附加说明，因为我们的函数可能会失败（空列表......），使用 Maybe 类型包装我们的结果可能是一件好事。

把这一切放在一起，我们就结束了。

```
nth :: Int -> [a] -> Maybe a
nth n xs 
    | null xs || n < 0 = Nothing
    | otherwise        = helper n zs 
      where 
        zs = zip [0..] xs 
        helper n ((i,c):zs) 
            | i == n    = Just c
            | null zs   = Nothing
            | otherwise = helper n zs 
```

# ruby-on-rails - 所有用户都发布到同一个 Twitter 帐户而不是他们自己的帐户（rails 3）

> ID：15980990
> 
> 赞同：0
> 
> 时间：2013-04-12T21:16:49.413
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, twitter-oauth

我被困在 Twitter gem 实施的最后一步，一切正常。除了，当用户发布时，所有内容都会发送到同一个 Twitter 帐户。

有些用户未使用omniauth 进行身份验证，有些是。目前，Authentications 表中只有 1 个条目，所有内容都通过它发布到同一个 Twitter 帐户。

这是代码

```
class PostsController < ApplicationController
def create
    twitter.update(@post.content)
    redirect_to root_path
end 
```

这是在我的应用程序控制器中定义“twitter”的方式

```
class ApplicationController < ActionController::Base
def twitter
    unless @twitter_user
      provider = Authentication.find_by_provider('twitter')
      @twitter_user = Twitter::Client.new(:oauth_token => provider.token, :oauth_token_secret => provider.secret) rescue nil
    end
    @twitter_user
  end 
```

我怎样才能让`twitter.update(@post.content)`那些通过omniauth认证的人只发生这种情况，并确保发送到Twitter的任何帖子都发送到给定上述代码的正确帐户？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-12T23:10:47.070

```
provider = Authentication.find_by_provider('twitter') 
```

您仅基于提供者是“twitter”来提取 Twitter 身份验证信息。如果您希望发布到与特定用户绑定的帐户，则需要*根据唯一标识该用户的内容获取 twitter 凭据*。

我不知道您的确切模型方案，但在伪代码中它可能看起来像这样：

```
provider = Authentication.find_by_email(current_user.email) 
```

或者

```
provider = Authentication.find_by_handle(current_user.handle) 
```

# mysql - 在 MySQL 中，您能否仅使用一次比较来检查字段是否为 NULL 或空？

> ID：15980995
> 
> 赞同：20
> 
> 时间：2013-04-12T21:16:58.013
> 
> 标签：mysql, null, comparison

如果我想使用 MySQL 查询检查某个字段是否为 NULL 或为空，我知道我可以执行以下操作：

```
column = '' OR column IS NULL 
```

但是，有没有办法在不进行两次单独比较的情况下检查这一点？

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-04-12T21:25:59.870

用于`COALESCE()`“规范化”值（将 NULL 值转换为空字符串）；

```
WHERE COALESCE(mycolumn, '') = '' 
```

阅读文档：[`COALESCE()`](http://dev.mysql.com/doc/refman/5.0/en/comparison-operators.html#function_coalesce)

或者反过来；将空字符串转换为 NULL；

```
WHERE NULLIF(mycolumn, '') IS NULL 
```

文档：[`NULLIF()`](http://dev.mysql.com/doc/refman/5.0/en/control-flow-functions.html#function_nullif)

在这两个中，我更喜欢 COALESCE() 因为它是 ANSI SQL 标准的一部分

你可以自己试验一下，就这样做；

```
SELECT 
    mycolumn                      AS orig_value,
    COALESCE(mycolumn, '')        AS coalesce_value,
    (COALESCE(mycolumn, '') = '') AS compare_result

FROM mytable; 
```

这将并排显示表中每一行的原始值、“合并”值和比较结果

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-12T21:26:01.273

```
WHERE COALESCE(column, '') = '' 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2016-03-01T12:52:46.940

另一种没有 WHERE 的方法，试试这个..

将同时选择 Empty 和 NULL 值

```
SELECT ISNULL(NULLIF(fieldname,''))  FROM tablename 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-12T21:20:00.613

尝试这个：

```
WHERE NOT(column LIKE '_%') 
```

如果没有 NOT，则 column 的值必须至少有一个字符，并且不能是`NULL`。

编辑：MySQL 似乎仍然以这种方式吞下 NULL 值。这应该会更好：

```
WHERE IFNULL(column, '') = '' 
```

# javascript - nodejs中是否存在深层对象控件

> ID：15980998
> 
> 赞同：0
> 
> 时间：2013-04-12T21:17:13.033
> 
> 标签：javascript, node.js, object

```
var session = {}
session.query = {}
session.query.username = "foo";

if( session.query.username )
    console.log('surname exists');

if( session.query2.username )
    console.log('surname exists'); 
```

此代码引发此异常：“ **TypeError：无法读取未定义的属性'query2'** ”

在stackoverflow中搜索并找到了这个解决方案：

```
...
if( session && session.query2 && session.query2.username )
    console.log('surname exists') 
```

但这很长，而且我有非常嵌套的对象控件，所以我不能使用这种方法。我可以使用任何简短的方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-13T21:14:03.143

这可以为您工作：

```
try {
    session.query.username &&
    console.log('Username exists');
} catch () {
    console.log('Username does not exist');
} 
```

如果路径非常深（或者当您需要测试其中的许多路径时），它可能会更短。