# StackOverflow 问答 13941000-13941999

# r - 将 R 连接到 POP 电子邮件服务器 (Gmail)

> ID：13941003
> 
> 赞同：2
> 
> 时间：2012-12-18T20:32:51.627
> 
> 标签：r

是否可以让 R 连接到 gmail 的 POP 服务器并读取/下载我的特定文件夹中的消息？我一直在存储电子邮件，想回去开始分析主题行等。

基本上，我需要一种方法来导出我的 gmail 帐户中的文件夹，如果可能的话，我想以编程方式执行此操作。

提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:10:39.917

我不确定这可以通过单个命令完成。也许那里有一个包，我不知道它可以实现这一点，但只要你不遇到它，也许下面的过程将是一个解决方案......

考虑 got-your-back ( [http://code.google.com/p/got-your-back/wiki/GettingStarted#Step_4%3a_Performing_A_Backup](http://code.google.com/p/got-your-back/wiki/GettingStarted#Step_4%3a_Performing_A_Backup) )，它“是一个命令行工具，用于备份和恢复您的 Gmail 帐户”。

您可以像这样调用它（假设您的机器上可以使用 python）：

```
python gyb.py --email foo@bar.com --search "from:pip@pop.com" --folder "mail_from_pip" 
```

完成后，您将找到`--search`与指定的 匹配的所有电子邮件`--folder`，以及一个 sqlite 数据库。（由 dukedave 发布，2011 年 12 月 4 日）

因此，根据您的操作系统，您应该能够从 R 中调用上述命令，然后访问相应文件夹中下载的邮件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-02-11T00:24:14.053

GotYourBack 是一个很好的备份实用程序，但对于下载元数据进行分析，您可能需要一些不需要您首先获取所有电子邮件的全部内容的东西。

我最近使用[gmailr](http://cran.r-project.org/web/packages/gmailr/index.html)包进行了类似的分析。

# html - 使 HTML5 应用程序离线可用

> ID：13941006
> 
> 赞同：3
> 
> 时间：2012-12-18T20:32:57.633
> 
> 标签：html, html5-appcache, cache-manifest

我正在为客户开发一个 HTML 应用程序。整个应用程序前端由 1 个 HTML 文件、1 个 Javascript 文件、1 个 CSS 文件（加上 jquery）和一些图像完成。服务器上有一些 php 脚本，它们使用 AJAX 调用，但前提是 Internet 连接可用。如果没有可用的连接，则站点将使用本地缓存的数据（使用`localStorage`）。

为了使站点可以离线使用，我在我的 HTML 中声明了缓存清单。我的 HTML 如下所示：

```
<!DOCTYPE html>
<html manifest="cache.manifest.php" language="en">
...
</html> 
```

的`cache.manifest.php`输出如下所示：

```
CACHE MANIFEST
#VersionHash: 80b9345e6c39efbbe8431e394b014b4f

CACHE:
/css/ebot.css
/favicon.ico
/images/appicon.png
/images/list-arrow.png
/images/list-checkmark.png
/images/woman.png
/index.html
/js/jquery-1.8.3.min.js
/js/ebot.ls.js

NETWORK:
/emaillog.php
/getdata.php
/uploadlog.php 
```

到目前为止，一切都很好。现在，我从具有 Internet 连接的浏览器访问该站点。我收到一个小通知，询问是否允许该站点存储信息以供离线使用 - 我允许。当我检查设置时，我看到该站点存储了 316K 的数据 - 大约是正确的。

现在我关闭互联网连接并尝试访问`http://www.mysite.com/index.html`- 并收到一条错误消息，显示“互联网连接不可用”（或类似程度的内容）并且页面未显示。这发生在我在我的开发机器（firefox、safari 和 chrome）以及客户端的 ipad 上测试的 3 个浏览器中（该应用程序最终在 ipad 上使用）。

我在这里想念什么？我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-24T17:30:17.103

这可能有很多原因。看看这篇文章：

*   [http://www.fuckyeahtml5.com/2011/06/debugging-html5s-offline-web-apps](http://www.fuckyeahtml5.com/2011/06/debugging-html5s-offline-web-apps)
*   [http://appcachefacts.info/](http://appcachefacts.info/)
*   [http://diveintohtml5.info/offline.html](http://diveintohtml5.info/offline.html)
*   [https://developer.mozilla.org/en/docs/HTML/Using_the_application_cache](https://developer.mozilla.org/en/docs/HTML/Using_the_application_cache)

我猜您没有为清单指定正确的内容类型 (MIME)。它应该是“文本/缓存清单”。在 Chrome 的控制台中检查事件。当 appcache 清单正确时，您应该会看到如下内容：

使用清单创建应用程序缓存[http://example.com/manifest.appcache](http://example.com/manifest.appcache)
应用程序缓存检查事件
应用程序缓存下载事件
应用程序缓存进度事件 (YYY of XXX)
应用程序缓存缓存事件

我建议从最简单的清单开始，以确保解析清单。尝试：

```
CACHE MANIFEST
NETWORK:
* 
```

这样的清单应该只缓存您的起始 html 页面。

# c# - 线程代码导致 UI 挂起

> ID：13941008
> 
> 赞同：0
> 
> 时间：2012-12-18T20:33:00.823
> 
> 标签：c#, multithreading, user-interface

我编写了一个简单的类来生成数组，因为我需要一些硬编码的随机数组来进行自己的调试，但是尽管在单独的工作线程中调用了及时操作，但我的 UI 仍然挂起！这是代码...

```
 private static Random randGenerator = new Random();

    private void generateButton_Click(object sender, EventArgs e)
    {
        string dataType = "System.";
        if (typeComboBox.Text != "Byte")
            dataType += signedCheckBox.Checked ? "" : "U";
        else if (typeComboBox.Text == "Byte")
            dataType += signedCheckBox.Checked ? "S" : "";
        dataType += typeComboBox.Text;

        generateButton.Enabled = false;

        new Thread(() =>
            {
                Process(Type.GetType(dataType), (int)sizeNumericUpDown.Value, hexCheckBox.Checked);
            }).Start();
    }

    private void Process(Type type, int size, bool hex)
    {
        StringBuilder sBuilder = new StringBuilder();
        sBuilder.Append(string.Format(@"{0}[] values = new {0}[{1}] {{", type.Name, size));

        for (int i = 0; i < size; i++)
        {
            int random = randGenerator.Next(0, GetIntegralMaxValue(type));
            sBuilder.Append((hex ? "0x" + random.ToString("x2") : random.ToString()) + (i < size - 1 ? ", " : " };"));
        }

        outputTextBox.BeginInvoke((MethodInvoker)delegate
        {
            outputTextBox.Text = sBuilder.ToString();
        });
    }

    private int GetIntegralMaxValue(Type type)
    {
        var field = type.GetField("MaxValue").GetValue(null);
        return Convert.ToInt32(field);
    } 
```

我认为问题可能在于尝试访问在主线程上创建的对象，因此我将它们传递给了该方法。我还尝试在类中声明我的 randGenerator 对象，但仍然没有运气。有人可以确定问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-20T04:49:06.977

TextBox 不是为保存大量数据而设计的——当数据量增加时它会变得非常慢。我会说填充 StringBuilder 需要大约 5% 的时间，而将此数据分配给 TextBox（在 UI 线程中执行）需要剩余 95% 的时间。您可以轻松检查这一点。只需在调试模式下运行此代码，然后在挂起期间单击“暂停”按钮。它应该在“outputTextBox.Text = sBuilder.ToString();”上中断 线。

# objective-c - 在 ViewController 之外的 UIScrollView 内绘制/布局宽 UIView 的内容

> ID：13941009
> 
> 赞同：0
> 
> 时间：2012-12-18T20:33:02.117
> 
> 标签：objective-c, ios, xcode, uiscrollview, uikit

我正在尝试制作一个`UIScrollView`比 iPhone 的屏幕更大（更宽）的各种 UI 元素。

我希望能够将这些元素放在 a`UIView`中，然后将其加载`UIView`到`UIScrollView`. 这样，我可以在 Interface Builder 中清楚地看到我在用那个大视图做什么。

在 Storyboard 处于活动状态的情况下，我该怎么做？我正在尝试做类似于 #2 示例的事情，但使用情节提要：

[http://agilewarrior.wordpress.com/2012/05/18/uiscrollview-examples/](http://agilewarrior.wordpress.com/2012/05/18/uiscrollview-examples/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:01:55.930

看看 Ray Wenderlich 的这个教程是否有帮助，它非常详细地介绍了`UIScrollView`：

[http://www.raywenderlich.com/10518/how-to-use-uiscrollview-to-scroll-and-zoom-content](http://www.raywenderlich.com/10518/how-to-use-uiscrollview-to-scroll-and-zoom-content)

如果您以编程方式进行布局，请注意以下重要注释：

`You might ask why we don’t do all of the above in viewDidLoad, and you’d be right to ask. The reason you can’t is that the view size isn’t definitely known until viewWillAppear:, and since you use the size of scrollView when calculating the minimum zoom, things might go wrong if we do it in viewDidLoad.`

祝你好运！

# authorization - 来自服务器的 OAuth2“无效授权”响应

> ID：13941012
> 
> 赞同：12
> 
> 时间：2012-12-18T20:33:22.383
> 
> 标签：authorization, google-api, in-app-purchase, oauth-2.0

我要求我的客户使用他创建 google api 项目的授权 gmail 帐户访问此 URL。

```
https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com/auth/androidpublisher&response_type=code&access_type=offline&redirect_uri=http://www.XXXXXXXX.com/oauth2callback&client_id=XXXXXX.apps.googleusercontent.com&state=profile&approval_prompt=force 
```

然后让他提供重定向 URL 中的 code 参数

```
http://www.XXXXXXXX.com/oauth2callback?code=4/jUxc2MdX0xmF-b4_I6v2SLMQMuxO.cvQLVEpcJMUXOl05ti8ZT3ZvsT9ddwI 
```

然后我自己用以下信息发布此表格。

```
<form action="https://accounts.google.com/o/oauth2/token" method="post" >

<input type="hidden" name="grant_type" value="authorization_code" >
<input type="text" name="code" value="**is the one i recieved from previous step**">
<input type="hidden" name="client_id" value="XXXXXXX.apps.googleusercontent.com" >
<input type="hidden" name="client_secret" value="XXXXXXXXXXXX" >
<input type="hidden" name="redirect_uri" value="http://www.XXXXXX.com/oauth2callback" >
<input type="submit" value="Submit">

</form> 
```

然后我收到以下错误

```
{
    "error" : "invalid_grant"
} 
```

当我自己生成代码 url 参数并执行下一步时。我成功收到以下回复

```
{
  "access_token" : "XXXXXXStBkRnGyZ2mUYOLgls7QVBxOg82XhBCFo8UIT5gM",
  "token_type" : "Bearer",
  "expires_in" : 3600,
  "refresh_token" : "XXXXXX3SEBX7F2cfrHcqJEa3KoAHYeXES6nmho"
} 
```

但是，如果客户端生成 url 参数“代码”，那么我会看到无效的授权错误。

我的客户在英国，我在另一个国家。任何人都可以确认这是否是错误，因为客户端正在另一个国家/地区生成代码参数，而我在另一个国家/地区使用该代码？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-03T14:40:53.827

我对 invalid_grant 错误感到恼火，而不是相同的代码有时让我获得了正确的访问令牌。

谢赫的回答指引我正确的方向。

首先，我们尝试从以下位置获取访问代码：

[https://accounts.google.com/o/oauth2/auth](https://accounts.google.com/o/oauth2/auth)

用户被引导到“允许权限”屏幕，然后我们的应用程序收到访问代码。

使用该访问代码，我们尝试从以下位置获取访问令牌：

[https://accounts.google.com/o/oauth2/token](https://accounts.google.com/o/oauth2/token)

在第一次尝试中，它会返回 access_token 和 grant_type=authorization_code，但是一旦向我们提供了 access_token，它就不再期望再次收到 grant_type=authorization，而是喜欢收到 grant_type=refresh_token

安卓开发者代码如下：

```
String accessToken = null, refreshToken = null;
HttpPost httppost = new HttpPost(https://accounts.google.com/o/oauth2/token);
HttpParams myParams = new BasicHttpParams();
httppost.setHeader("Content-type", "application/x-www-form-urlencoded");
List<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>(4);
nameValuePairs.add(new BasicNameValuePair("client_id", BLOGGER_CLIENT_ID));
SharedPreferences prefs = context.getSharedPreferences(PREFERENCES_NAME, Context.MODE_PRIVATE);
String bloggerAccessToken = prefs.getString(PREFERENCES_KEY_BLOGGER_ACCESS_TOKEN, null);

if(bloggerAccessToken != null && bloggerAccessToken.length() > 0){
    nameValuePairs.add(new BasicNameValuePair("refresh_token",  prefs.getString(PREFERENCES_KEY_BLOGGER_REFRESH_TOKEN, null)));
    nameValuePairs.add(new BasicNameValuePair("grant_type",    "refresh_token"));
} else{
    nameValuePairs.add(new BasicNameValuePair("code",  prefs.getString(PREFERENCES_KEY_BLOGGER_ACCESS_CODE, null)));
    nameValuePairs.add(new BasicNameValuePair("grant_type",    "authorization_code"));
    nameValuePairs.add(new BasicNameValuePair("redirect_uri",  "http://localhost"));
}

httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
HttpClient httpClient = new DefaultHttpClient(myParams);
response = httpClient.execute(httppost);

String returnedJsonStr = EntityUtils.toString(response.getEntity());
JSONObject jsonObject = new JSONObject(returnedJsonStr);
accessToken = jsonObject.getString("access_token");
if(jsonObject.has("refresh_token"))
    refreshToken = jsonObject.getString("refresh_token"); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-19T08:25:58.460

您可以要求客户端自己生成代码以及随后的刷新令牌。让他访问上面生成 refresh_token 的表单。

然后可以使用 refresh_token 生成 access_tokens。

希望它能解决你的问题。

# php - 分隔值的最佳方法

> ID：13941016
> 
> 赞同：1
> 
> 时间：2012-12-18T20:33:34.213
> 
> 标签：php, mysql, pdo

我想用逗号分隔来自数据库的值。我找不到执行此操作的 SQL 方法，如果我尝试在 while 循环中执行此操作，它会在字符串末尾放置一个逗号，这是我不想要的。

```
 private function retrieve_subjects(){
    $dbh = $this->connect();
    $stmt = $dbh->prepare("SELECT name FROM subject");
    $stmt->execute();
    $stmt->bindColumn('name', $name);
    while($stmt->fetch(PDO::FETCH_BOUND)){
        $sub .= $name;
    }
    return $sub;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:36:44.593

尝试使用`implode`.

PHP： http: [//php.net/manual/en/function.implode.php](http://php.net/manual/en/function.implode.php)

MySQL (GROUP_CONCAT)：[http ://dev.mysql.com/doc/refman/5.5/en/group-by-functions.html#function_group-concat](http://dev.mysql.com/doc/refman/5.5/en/group-by-functions.html#function_group-concat)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:36:16.797

试试这个：

```
$sub = '';    
while($stmt->fetch(PDO::FETCH_BOUND)){
    if($sub == '')
        $sub = $name;
    else
        $sub .= ',' . $name;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:37:24.467

使用分隔符变量

```
$delim = "";
while($stmt->fetch(PDO::FETCH_BOUND)){
    $sub .= $delim;
    $sub .= $name;
    $delim = ", ";
} 
```

# c# - 模态窗口，但仅适用于某些窗口

> ID：13941017
> 
> 赞同：0
> 
> 时间：2012-12-18T20:33:37.507
> 
> 标签：c#, winforms, modal-dialog

我有一个表格。这个表单可以打开一个编辑器，它扩展自 Form。编辑器具有您单击的链接，这会打开一个模式表单来定义该链接。

```
// Main form
private void OnMainForm_MouseClick(object sender, MouseEventArgs e)
{
    Editor editor = new Editor();
    editor.Show();
}

// editor
private void OnEditorLink_MouseClick(object sender, MouseEventArgs e)
{
    LinkConfigDialog linkDialog = new LinkConfigDialog();
    linkDialog.ShowModal();
} 
```

这确保了用户不能单击并尝试修改已经编辑的其他链接（或相同的链接）。这是设计使然。

但是，现在我希望让人们打开多个编辑器。我仍然希望模态表单能够工作，但仅适用于那些编辑器，而不适用于整个应用程序。

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:36:36.670

我认为您应该在您的`Editor`课程中编写一个“冻结”您的编辑器对话框的方法。例如，通过禁用控件等。`LinkDialog`然后您可以在打开a 时调用该方法。这样，您可以拥有多个`Editor`仅由它们自己`LinkDialog`的 s 禁用的实例。您可以使用另一种方法来重新启用将在`LinkDialog`关闭时调用的控件。

# javascript - 当其他属性的值相同时，对属性的值求和

> ID：13941027
> 
> 赞同：0
> 
> 时间：2012-12-18T20:34:15.050
> 
> 标签：javascript, google-maps-api-3

我有一组像这样的对象：

```
{'shapeId': 'shapeid1', 'latlong': '45.42342,-65.23424', 'number': 5} 
```

`number`当属性的值相同时，我想要属性值的总和`shapeId`。

有内置的方法吗？谢谢！

到目前为止我尝试的是这个，使用`reduce()`方法，但是当函数被多次调用时结果很奇怪。

```
 function selectMarkersInPoly() {
        allTotal = new Array();
        alert(allMarkers.length)
        for (var i=0; i < createdShapes.length; i++) {
            for (var j=0; j < allMarkers.length; j++){
                var latlong = allMarkers[j].getPosition();
                if(google.maps.geometry.poly.containsLocation(latlong, createdShapes[i]) == true) {
                    allMarkers[j].setOptions({
                        icon : "http://labs.google.com/ridefinder/images/mm_20_white.png",
                        shapeId:createdShapes[i].id
                    });
                }else{
                    allMarkers[j].setOptions({
                        icon : "http://labs.google.com/ridefinder/images/mm_20_red.png",
                        shapeId: 'shapeid0'
                    });
                }    
            }
        }            
        allTotal = allMarkers.reduce(function(res, obj) {
          if (!(obj.shapeId in res)){
            res.__array.push(res[obj.shapeId] = obj);
          }else {
            res[obj.shapeId].number += obj.number;
          }
          return res;
          }, {__array:[]}).__array
                .sort(function(a,b) { return b.shapeId - a.shapeId;
          });

          for (var j=0; j < allTotal.length; j++) {
            alert(allTotal[j].shapeId + ': ' + allTotal[j].number)
          }
    } 
```

3505 个对象中的 allMarkers.number 共有 32600 个数字。我第一次调用我得到的函数：

```
allTotal= [
   Object { number=32598,  shapeId='shapeid0'},
   Object { number=2,  shapeId='shapeid1'}
] 
```

其中 shapeid0 未选择。我第二次调用该函数而不更改任何内容时，我得到：

```
allTotal= [
   Object { number=65193,  shapeId='shapeid0'},
   Object { number=2,  shapeId='shapeid1'}
] 
```

第三次：

```
allTotal= [
   Object { number=97788,  shapeId='shapeid0'},
   Object { number=2,  shapeId='shapeid1'}
] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:45:39.027

您的代码格式有点奇怪。但是，问题在于，在表达式内部，`res.__array.push(res[obj.shapeId] = obj);`您将对象本身分配给`res`，而不是克隆。然后与`res[obj.shapeId].number += obj.number;`您一起操作*原始对象*，这就是结果在后续调用中增长的原因。

更好的：

```
var numberSums = allMarkers.reduce(function(res, obj) {
    var id = obj.shapeId;
    if (id in res)
        res[id] += obj.number;
    else
        res[id] = obj.number;
    return res;
}, {});
Object.keys(numberSums).sort(function(a,b){return a-b;}).forEach(function(id) {
    alert(id+": "+numberSums[id]);
}); 
```

# python - list.__str__ 反转

> ID：13941034
> 
> 赞同：3
> 
> 时间：2012-12-18T20:34:27.960
> 
> 标签：python, python-3.x

> **可能重复：**
> [将表示列表的字符串转换为实际的列表对象](https://stackoverflow.com/questions/5214344/converting-a-string-that-represents-a-list-into-an-actual-list-object)

有这样的字符串：

```
"[81, 102, 114, 132, 194, 210, 228, 317, 357, 358, 379, 396, 407, 417, 418, 420, 470, 471, 506, 526, 533, 538]" 
```

如何轻松将其解析为相应的列表？

我知道我可以使用`re`模块或拆分`", "`等。

是否有任何现有的功能可以做到这一点？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:37:44.483

使用[`ast.literal_eval()`](http://docs.python.org/3/library/ast.html#ast.literal_eval)：

```
>>> import ast
>>> s = "[81, 102, 114, 132, 194, 210, 228, 317, 357, 358, 379, 396, 407, 417, 418, 420, 470, 471, 506, 526, 533, 538]"
>>> ast.literal_eval(s)
[81, 102, 114, 132, 194, 210, 228, 317, 357, 358, 379, 396, 407, 417, 418, 420, 470, 471, 506, 526, 533, 538] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:35:52.833

```
>>> l = "[81, 102, 114, 132]"
>>> map(int, l.strip("[]").split(", "))
[81, 102, 114, 132] 
```

对于 Python 3+，您需要从`map`迭代器中创建列表：

```
>>> l = "[81, 102, 114, 132]"
>>> list(map(int, l.strip("[]").split(", ")))
[81, 102, 114, 132] 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T20:37:19.490

最直接的方法是使用[eval()](http://docs.python.org/2/library/functions.html#eval)。但是，这通常被认为是不好的做法，因为它可能导致安全问题。

# sql - 如何查找并发 SQL Server 连接的数量

> ID：13941036
> 
> 赞同：7
> 
> 时间：2012-12-18T20:34:28.330
> 
> 标签：sql, sql-server, connection

我有一个达到并发连接最大限制的 SQL Server。我有许多不同的服务器和服务同时连接到一个 SQL Server。

我确实找到了另一个似乎有效的查询：

```
SELECT DB_NAME(dbid) AS DBName,
       COUNT(dbid)   AS NumberOfConnections,
       loginame      AS LoginName,
       nt_domain     AS NT_Domain,
       nt_username   AS NT_UserName,
       hostname      AS HostName
FROM   sys.sysprocesses
WHERE  dbid > 0
GROUP  BY dbid,
          hostname,
          loginame,
          nt_domain,
          nt_username
ORDER  BY NumberOfConnections DESC; 
```

但是，这给了我很好的连接数。我如何进一步深入挖掘以查看每个连接以及它们正在执行的操作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:49:56.463

sql 命令“sp_who”提供有关 Microsoft SQL Server 数据库引擎 ( [MSDN](http://msdn.microsoft.com/en-us/library/ms174313.aspx) ) 实例中当前用户、会话和进程的信息 从这里，您应该能够将结果发送到临时表并按服务器名分组.

比如下面...

```
CREATE TABLE #tbl (
      spid      int
    , ecid      int
    , status    varchar(50)
    , loginame  varchar(255)
    , hostname  varchar(255)
    , blk       varchar(50)
    , dbname    varchar(255)
    , cmd       varchar(255)
    , request_id varchar(255)
    )
GO

INSERT INTO #tbl EXEC sp_who

SELECT COUNT(0), hostname FROM #tbl group by hostname

DROP TABLE #tbl
GO 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:53:49.933

您是在谈论如何检查到达您的 SQL Server 实例的连接吗？一些DOS命令怎么样？尝试搜索端口 1433 或 SQL Server 进程的 PID。

> 网络统计-nao | 找到“1433”

要查找您要查找的 PID（进程标识符），只需转到您的任务管理器并自定义进程视图，此处的模式详细信息： [http ://www.mydigitallife.info/how-to-get-and-view-进程标识符进程 id 或 pid-on-windows/](http://www.mydigitallife.info/how-to-get-and-view-process-identifier-process-id-or-pid-on-windows/)

# php - PHP OOP：当对象被分配为属性时做一些事情

> ID：13941041
> 
> 赞同：3
> 
> 时间：2012-12-18T20:34:50.873
> 
> 标签：php, oop, getter-setter

考虑这个假设场景：

我有一个`Stomach`类，它有一个`contents`属性，类的对象`Food`应该分配给它。一种方法是使用一种 setter，例如`setContents($food)`.

但是让我们假设我们直接分配食物，如`$stomach->contents = $orange`.

还假设每当一个`Food`对象被分配给我们时，`contents`我们需要将对象的`eaten`属性更改为`true`。有没有办法在不使用分配给它的对象的方法的情况下做到这一点（在这种情况下，是`$stomach`'s setter）？

基本上，我的问题是：**当一个对象作为属性分配给另一个对象时，我们可以调用一个方法吗？**另外，即使有可能，这是糟糕的设计吗？抱歉，如果这是一个愚蠢的问题，所有这些对我来说都很新鲜。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:36:49.770

这里最好的 OOP 解决方案是创建一个指示动作的方法，例如`eat()`.

为了确保正确的对象被*吃掉*，你可以定义一个[*接口*](http://php.net/manual/en/language.oop5.interfaces.php)（比如*食物*）。这个接口可以定义一个方法 setEaten()。胃（虽然我更喜欢哺乳动物或类似的*可以*吃的东西）然后可以调用 setEaten()。

由于它在评论中引起了一些争议，我想指出一个对象定义应该尽可能地反映它的实际作用。为了减少*对象耦合*，最好避免直接从其他类访问对象属性，但是在有意义的情况下使用 setter 代替操作没有任何问题（请注意，我在*Food*的定义中使用了一个），而且它可能经常取决于开发者的观点。

然而，这里说得通。考虑“猴子吃香蕉”的情况（为简单起见，请允许我凭空实现香蕉）。

```
$m = new Monkey();
$m->eat(new Banana()); 
```

完美的。现在让我们尝试一个二传手。

```
$m->setContents(new Banana()); 
```

现在我们有一个问题，猴子已经包含了很多东西，比如骨头、血液、肌肉和大脑等。所以 setContents 在这里没有意义。您可以尝试`$m->getStomach()->setContents(new Banana())`，但这只会增加对象耦合。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:40:55.327

我同意@dualed 关于该`eat`方法的看法。这就是说实现这一点的方法是使所有属性成为私有/受保护的，然后使用`__get`/`__set`代理到设置器。

```
class Stomach {

   protected $contents;

   public function setContents(Food $food) {
      $this->contents = $food;
      $food->eaten = true;    
   }

   public function __set($name, $value) {
      $method = array($this, 'set' . $name);
      if(is_callable($method)) {
         return call_user_func_array($method, array($value));
      }
   }

  public function __get($name) {
     $method = array($this, 'get'.$name);
     if(is_callable($method)) {
        return call_user_func($method);
     }
  }
} 
```

你会注意到我使用`is_callable`的不是，`method_exists`因为如果你正在使用虚拟方法处理一些复杂的事情`is_callable`，应该考虑到这些，而`method_exists`依赖于类层次结构中定义的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T20:41:30.023

[__set](http://php.net/__set)函数将在这里为您提供帮助。但**请确保您没有`contents`在 class 中定义**任何名为的属性。像这样做

```
class Stomach{
    private $props = array();
    public __set($prop, $value){
        if($prop === 'contents' and $value instanceof Food){
            $this->prop[$prop] = $value;
        }
    }
} 
```

# sql - 使用许多外连接的查询中的查询优化

> ID：13941042
> 
> 赞同：0
> 
> 时间：2012-12-18T20:34:54.873
> 
> 标签：sql, sql-server, database, sql-server-2008

我正在寻找优化以下 SQL 查询的方法。我正在使用 MS SQL Server 2008。我在想是否有任何方法可以整合外部连接，它会加快速度……如果有人有任何意见，将不胜感激。谢谢

```
SELECT employee.employee_id,
   coalesce (room.ship_id, ship.ship_id) AS ship_id,
   SUBSTRING (employee.service_id, 0, 6) AS cost_code,
   employee_station.room_cat AS nws_room_cat
FROM employee
   LEFT OUTER JOIN room
      ON     employee.ship_id = room.ship_id
         AND employee.floor_id = room.floor_id
         AND employee.room_id = room.room_id
   LEFT OUTER JOIN ship
      ON employee.ship_id = ship.ship_id
   LEFT OUTER JOIN employee_station
      ON COALESCE (ship.property_type, '') =
            COALESCE (employee_station.property_type, '')
         AND COALESCE (room.work_center_id, '') = COALESCE (employee_station.work_center_id, '')
         AND COALESCE (employee.pay_plan, '') =
                COALESCE (employee_station.pay_plan, '')
         AND COALESCE (employee.employee_type, '') =
                COALESCE (employee_station.employee_type, '')
         AND COALESCE (SUBSTRING (employee.service_id, 0, 6), '') =
                COALESCE (employee_station.cost_code, '')
   LEFT OUTER JOIN roomtype
      ON room.room_type = roomtype.room_type
   LEFT OUTER JOIN dp
      ON employee.service_id = dp.service_id 
```

注意：为了清楚起见，我故意省略了 SELECT 语句中的许多字段。所以 roomtype 和 dp 表实际上正在被使用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:43:09.663

OUTER JOIN 不是问题。问题在于将列包装在函数中。

```
ON COALESCE (ship.property_type, '') = COALESCE (employee_station.property_type, '') 
```

这种结构会阻止优化器制定有效的查询计划——直到运行时它才知道函数的值是什么，因此如果索引存在，它就无法使用它们。

在没有函数的情况下重写查询，优化器将能够做出更好的决策。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:17:37.273

您可以尝试加入 CHECKSUMS - 根据我的经验，它通常比复杂条件提供更好的性能：

```
SELECT 
--columns you need
FROM employee
LEFT OUTER JOIN room
ON CHECKSUM(employee.ship_id, employee.floor_id, employee.room_id) 
= CHECKSUM(room.ship_id, room.floor_id, room.room_id)
LEFT OUTER JOIN ship
ON employee.ship_id = ship.ship_id
LEFT OUTER JOIN employee_station
ON CHECKSUM(ship.property_type, room.work_center_id, employee.pay_plan, employee.employee_type, SUBSTRING (employee.service_id, 0, 6)) 
= CHECKSUM(employee_station.property_type, employee_station.work_center_id, employee_station.pay_plan, employee_station.employee_type, employee_station.cost_code)
LEFT OUTER JOIN roomtype
ON room.room_type = roomtype.room_type
LEFT OUTER JOIN dp
ON employee.service_id = dp.service_id 
```

# django - 如何在不登录的情况下使用用户配置文件？

> ID：13941045
> 
> 赞同：0
> 
> 时间：2012-12-18T20:34:49.937
> 
> 标签：django, django-views

我有功能：

```
def my_function(request):
    if request.method == 'POST':
        if 'get_id' in request.POST:
            try:
                object = MyModel.objects.get(pk=int(request.POST['get_id']))
                return HttpResponse(str(object.id))
            except:
                pass
    return HttpResponse('Error') 
```

我想使用`@login_required`装饰器——这个功能需要授权。但是如何在我的系统中授权外部系统（不是用户 - 其他脚本）？系统相互交换数据。

怎么做？我想使用 Django 用户身份验证，但我不想发送用户名并以明文形式传递。

# javascript - 在javascript中传递函数

> ID：13941046
> 
> 赞同：2
> 
> 时间：2012-12-18T20:35:03.573
> 
> 标签：javascript, jquery, json

我正在尝试将一个函数传递给另一个函数以在其回调中使用，我使用...调用该函数

```
call("login", {email:user,password:pw}, alert(getResponse())); 
```

调用定义为：

```
function call(url, p, f){
    $.getJSON(baseUrl + url, p, f(data));
}; 
```

getResponse 定义为：

```
function getResponse(d){
    return d.result.success;
}; 
```

`data`由`getJSON`（见这里：[http](http://api.jquery.com/jQuery.getJSON/) ://api.jquery.com/jQuery.getJSON/ ）返回

我该如何传递`data`给该函数？

该函数被调用，因为它达到了我设置的断点。

`getResponse`虽然我得到了什么时候被调用`Uncaught ReferenceError: data is not defined`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:36:11.197

采用

```
call("login", {email:user,password:pw}, function(data){alert(getResponse(data)})); 
```

该表达式`alert(getResponse())`是警报函数的调用（`getResponse`调用时不带任何参数，因此这会引发错误，就像从 获取一样），但它`d.result`是一个以数据为参数的新函数的定义。`result``undefined``function(data){alert(getResponse(data)})`

另外请注意，您不需要只需要`f(data)`，因此您可以致电`$.getJSON(baseUrl + url, p, f(data));``f``$.getJSON(baseUrl + url, p, f);`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:38:21.177

该表达式`alert(getResponse())`会弹出一个警报，并且不会计算为函数，而是计算`undefined`.

您必须传递一个实现为 alert(getResponse(d)) 的函数，其中 d 是它的参数。

比如表达式`function(d){alert(getResponse(d);}`举例

# android - libcurl 和 android 在 localhost 连接到 Web 服务

> ID：13941048
> 
> 赞同：0
> 
> 时间：2012-12-18T20:35:19.827
> 
> 标签：android, libcurl, cocos2d-x

我已设法将我的应用程序连接到 Web 服务，但我遇到了 android 平台的问题。（如果有人不知道，使用 cocos2d-x 可以制作多平台应用）

现在，Web 服务托管在 localhost 的“http://127.0.0.1:9876/ts?wsdl”。

我已经设法为它生成请求，它在 win32 应用程序中运行良好。当我尝试使用 android 应用程序连接到 Web 服务时，问题就出现了。它总是会给出“代码：7”（无法连接），但有趣的是，如果我连接到任何托管服务器，它就会起作用。

所以我想知道为什么它不允许我连接到本地主机，还要注意我正在使用模拟器，因为我没有设备，但我认为这不是问题。

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:05:48.900

我假设您使用的是模拟器而不是手机。所以当你输入localhost时，它指的是手机的IP地址，而不是你的电脑。Android 为您提供映射到您的 PC 本地主机的 IP 地址。所以使用 10.0.2.2。而不是localhost，它应该可以工作。

# javascript - 添加超时/滑出菜单

> ID：13941049
> 
> 赞同：0
> 
> 时间：2012-12-18T20:35:21.447
> 
> 标签：javascript, jquery

```
$('#nav-menu').bind("mousedown touchstart", function(){
        if ($('#patients-panel').hasClass('open')) {
            $('#patients-panel').animate({
                left: '-165px',
            }, 500);
            $('#patients-panel').removeClass('open');
            $('#nav-patients').removeClass('active');
        }
        slideMenu();
        $('#menu-panel').toggleClass('open');
        $('#nav-menu').toggleClass('active');
        swapImage();
    });
    $('#nav-patients').bind("mousedown touchstart", function(){
        if ($('#menu-panel').hasClass('open')) {
            $('#menu-panel').animate({
                left: '-165px',
            }, 500);
            $('#menu-panel').removeClass('open');
            $('#nav-menu').removeClass('active');
        }
        slidePatientMenu();
        $('#patients-panel').toggleClass('open');
        $('#nav-patients').toggleClass('active');
        swapImage();
    }); 
```

我想在我的滑出菜单中添加一个 3 秒计时器；所以，本质上；在菜单“滑出”后，它将在 3 秒内滑回。我怎么能写这个？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:49:15.573

基本上，这就是您需要做的，在*“显示”*菜单的回调函数的末尾，添加以下内容：

```
setTimeout(function()
{
    $('#patients-panel').animate({left: '0px'}, 500);
},3000); 
```

这应该可以解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:43:03.550

为什么不设置一个 setTimeout 来调用你的“关闭窗口函数”？

```
setTimeout(myCloseWindowFunction,3000);

....

myCloseWindowFunction(){
    //do stuff
}; 
```

您只需将计时器放入每个 .bind 函数中。它会打开..计时器会减少毫秒，然后调用“更接近”的功能

# android - 在我的活动中不会调用处理程序

> ID：13941052
> 
> 赞同：0
> 
> 时间：2012-12-18T20:35:37.757
> 
> 标签：android, android-service, android-handler

我在我的活动中创建了一个处理程序。处理程序将存储在应用程序对象中。

```
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.action_activity);
    appData = (AttachApplication) getApplication();

    Handler updateHandler = new Handler() {
        public void handlerMessage(Message msg) {
            Log.d( TAG, "handle message " );
        }
    };
    appData.setUpdateHandler( updateHandler );

} 
```

我的计划是当我在我的服务中 setEmtpyMessage 时将调用这个 handleMessage。该服务从应用程序对象中检索处理程序。

```
public int onStartCommand(Intent intent, int flags, int startId) {
    Log.d(TAG, "onStartCommand of attachService");
    List<Job> jobList = DBManager.getInstance().getAllOpenJobs();
    appData = (AttachApplication) getApplication();
    updateHandler = appData.getUpdateHandler();
            updateHandler.sendEmptyMessage( 101 ); 
```

我检查了日志，但没有句柄消息，因此我的计划似乎不起作用。每次我的服务完成工作时，我都想更新一个文本字段。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:01:31.047

在您的情况下，您应该像这样使用 BroadcastReceiver：

在您的 Activity 类中定义接收器：

```
public class DataUpdateReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        if (intent.getAction().equals(MainService.REFRESH_DATA_INTENT)) {
                        //do something
        }
    }
} 
```

在您的 onCreate 或 onStart 方法上，您必须注册接收器：

```
DataUpdateReceiver dataUpdateReceiver = new DataUpdateReceiver();
IntentFilter intentFilter = new IntentFilter(MainService.REFRESH_DATA_INTENT);
registerReceiver(dataUpdateReceiver, intentFilter); 
```

在您的服务上添加以下内容：

```
public static final String REFRESH_DATA_INTENT = "done"; 
```

当你完成所有工作人员后，你必须像这样发送广播：

```
sendBroadcast(new Intent(MainService.REFRESH_DATA_INTENT)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:02:45.270

你的代码片段说`public void handlerMessage(Message msg)`，但我认为你`public void handleMessage(Message msg)`的意思是，没有`r`. 当您打算覆盖超类中的方法时，可以使用@Override 标签来避免这些问题；所以你的代码片段会被渲染`@Override public void handleMessage(Message msg)`，而`@Override public void handlerMessage(Message msg)`会是一个错误。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:02:48.753

你想做什么？我真的没有看到在 Activity 中实例化 Handler 的意义，因为您所做的只是从 MessageQueue 获取消息。您当然不想与 Android 发布的任何消息混为一谈，而且还有更好的方法可以向 Activity 发送消息。

当然，您没有包含 AttachApplication 的代码，所以我只能推测。

您还尝试从服务访问此处理程序。发生了什么事，但我不确定是什么。

如果您想在每次服务完成工作时更新 TextView，请从 Service 向 Activity 发送广播 Intent，并在 Activity 中使用广播接收器。您还应该考虑使用 IntentService 而不是 Service。

# iphone - 从 AlAsset 获取图像导致我的应用程序崩溃

> ID：13941053
> 
> 赞同：1
> 
> 时间：2012-12-18T20:35:42.263
> 
> 标签：iphone, objective-c, alassetslibrary, alasset

我的应用程序中有此代码：

```
[[self assetsLibrary] assetForURL:info.media.url resultBlock:^(ALAsset *asset) {
    ALAssetRepresentation *rep = [asset defaultRepresentation];
    CGImageRef img = [rep fullScreenImage];
    photoLayer.contents =  img;
} failureBlock:^(NSError *error) {

}]; 
```

代码到达填充 img 变量的行并停在那里，应用程序锁定且没有错误。NSLog 回显出一个大小，所以我知道资产在那里。我不知道如何解决这个问题，它以前工作过，但刚刚停止！有没有人看到这里有什么不合适的地方？

这是网址的样子：

```
assets-library://asset/asset.JPG?id=36E68169-7BB4-48D7-B8E1-244234C9F1DA&ext=JPG 
```

冻结时的堆栈跟踪：

```
Thread 1, Queue : NSManagedObjectContext Queue
#0  0x37b1af38 in syscall_thread_switch ()
#1  0x331a5978 in OSSpinLockLock$VARIANT$wfe ()
#2  0x3318bcae in pthread_once ()
#3  0x348f66e2 in _internalCheckSupportsDCTDownScaling ()
#4  0x348f63fa in _initalizeService ()
#5  0x3318bcde in pthread_once ()
#6  0x348f63ba in jpegService ()
#7  0x3497009c in FigCreateCGImageFromJPEG ()
#8  0x356b5728 in PLCreateImageFromDataWithFormat ()
#9  0x35a3205e in __block_global_0 ()
#10 0x356a03f4 in -[PLAssetsSaver requestSynchronousImageFromAsset:withFormat:completionBlock:] ()
#11 0x35a32028 in __40-[ALAssetRepresentation fullScreenImage]_block_invoke_0 ()
#12 0x35a387ec in __53-[ALAssetRepresentationPrivate _performBlockAndWait:]_block_invoke_0 ()
#13 0x328e79a0 in developerSubmittedBlockToNSManagedObjectContextPerform ()
#14 0x3121c5da in _dispatch_client_callout ()
#15 0x3121f80e in _dispatch_barrier_sync_f_invoke ()
#16 0x328e7b22 in -[NSManagedObjectContext performBlockAndWait:] ()
#17 0x35a351b2 in -[ALAssetsLibrary _performBlockAndWait:] ()
#18 0x35a385ac in -[ALAssetRepresentationPrivate _performBlockAndWait:] ()
#19 0x35a31f24 in -[ALAssetRepresentation fullScreenImage] ()
#20 0x0008a3ca in __31-[MasterTimeLine getPhotoItem:]_block_invoke_0 at /Users/jasoncandelora/Desktop/Glance/iOS/projects/VideoBuilderTest1/VideoBuilderTest1/MasterTimeLine.m:789
#21 0x35a371b2 in __block_global_14 ()
#22 0x3121c792 in _dispatch_call_block_and_release ()
#23 0x3121c5da in _dispatch_client_callout ()
#24 0x3121fe44 in _dispatch_main_queue_callback_4CF ()
#25 0x357ff1b0 in __CFRunLoopRun ()
#26 0x3577223c in CFRunLoopRunSpecific ()
#27 0x357720c8 in CFRunLoopRunInMode ()
#28 0x3702133a in GSEventRunModal ()
#29 0x340ec290 in UIApplicationMain ()
#30 0x0006eda4 in main at /Users/jasoncandelora/Desktop/Glance/iOS/projects/VideoBuilderTest1/VideoBuilderTest1/main.m:16

Thread 3, Queue : com.apple.libdispatch-manager
#0  0x37b1b5d0 in kevent64 ()
#1  0x31221d26 in _dispatch_mgr_invoke ()
#2  0x3121d378 in _dispatch_mgr_thread ()

Thread 5 WebThread, Queue : (null)
#0  0x37b1ae30 in mach_msg_trap ()
#1  0x37b1afd4 in mach_msg ()
#2  0x358002ba in __CFRunLoopServiceMachPort ()
#3  0x357ff030 in __CFRunLoopRun ()
#4  0x3577223c in CFRunLoopRunSpecific ()
#5  0x357720c8 in CFRunLoopRunInMode ()
#6  0x3376ea5c in RunWebThread(void*) ()
#7  0x331950e0 in _pthread_start ()
#8  0x33194fa8 in thread_start ()

Thread 8 com.apple.coremedia.player.async, Queue : (null)
#0  0x37b2b08c in __psynch_cvwait ()
#1  0x3318db00 in _pthread_cond_wait ()
#2  0x33197cfc in pthread_cond_wait ()
#3  0x336ef8b8 in FigSemaphoreWaitRelative ()
#4  0x39b30eae in fpa_AsyncMovieControlThread ()
#5  0x3370d97a in figThreadMain ()
#6  0x331950e0 in _pthread_start ()
#7  0x33194fa8 in thread_start ()

Thread 9 com.apple.coremedia.player.remote, Queue : (null)
#0  0x37b1ae30 in mach_msg_trap ()
#1  0x37b1afd4 in mach_msg ()
#2  0x39b370d8 in FigExpressNotificationThread ()
#3  0x3370d97a in figThreadMain ()
#4  0x331950e0 in _pthread_start ()
#5  0x33194fa8 in thread_start () 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:41:46.107

您不应该使用这种诡计来尝试将异步资产检索操作强制转换为同步操作。最可能的原因是死锁，检查各种线程的堆栈跟踪，您可能会看到多个线程在一个信号量上等待。

我建议你删除信号量锁定的东西，让操作是异步的。

另一个建议：您是否确定用户实际上已允许访问照片（iOS6 上的新隐私设置）？

关于您发布的堆栈输出：

我看到了 FigSemaphoreWaitRelative 和 OSSpinLockLock$VARIANT$wfe。第一个是等待信号量被解锁。后者是另一种形式的锁定，而系统显然会检查您尝试访问的媒体是否可以在硬件中解码（_internalCheckSupportsDCTDownScaling）。

由于某种原因，此操作不仅卡住了，而且还阻塞了线程 1 的主线程。您是否可能打开了一个媒体播放器视图（com.apple.coremedia.player.async），它阻塞了视频硬件，而这防止上述 DCTDownScaling 检查死锁？

长话短说：听起来你应该为此提交一个雷达，对我来说很像一个 iOS 错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:56:13.913

尝试将最后一行代码移至主队列：

```
[[self assetsLibrary] assetForURL:info.media.url resultBlock:^(ALAsset *asset) {
    ALAssetRepresentation *rep = [asset defaultRepresentation];
    CGImageRef img = [rep fullScreenImage];
    dispatch_async(dispatch_get_main_queue(), ^{
        photoLayer.contents =  img;
    };
} failureBlock:^(NSError *error) {

}]; 
```

如果这不起作用，这是多大的资产？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T18:49:36.553

就我而言，我重新启动了设备，它现在可以工作了。感谢你的帮助

# jquery - 无法使用 ajaxSubmit：TypeError: Object [object Object] has no method 'ajaxSubmit'

> ID：13941054
> 
> 赞同：1
> 
> 时间：2012-12-18T20:35:48.200
> 
> 标签：jquery, ajax

你必须忍受我，因为我刚刚开始使用 jQuery，所以这可能是我忽略的一件非常简单的事情。我有一个正在开发的网站的登录表单，我正在尝试使用 ajaxSubmit 发送丢失密码请求的请求。此请求源自模态 div 上的表单。

形式：

```
<div id="dialog" style="display: none" title="Retrieve your password">
        <p>
            Please enter your username below and you will have a new password sent to the email address you registered with the account.
        </p>
        <form id="passform" action="comment.php" method="post">
            <input type="text" name="user" id="user">
        </form>
    </div> 
```

jQuery提交请求：

```
$(document).ready(function()
        {
            function doit(formData, jqForm, options)
            {
                // formData is an array; here we use $.param to convert it to a string to display it
                // but the form plugin does this for you automatically when it submits the data
                var queryString = $.param(formData);

                // jqForm is a jQuery object encapsulating the form element.  To access the
                // DOM element for the form do this:
                // var formElement = jqForm[0];

                alert('About to submit: \n\n' + queryString);

                // here we could return false to prevent the form from being submitted;
                // returning anything other than false will allow the form submit to continue
                return true;
            }

            $("#getpass").click(function()
            {

                $("#dialog").dialog(
                {
                    autoOpen : true,
                    resizable : false,
                    height : 270,
                    modal : true,
                    hide : "fold",
                    show : "fold",
                    buttons :
                    {
                        "Retrieve Password" : function()
                        {
                            $("#passform").ajaxSubmit(
                            {
                                url : "php/lostpassword.php",
                                type : "post",
                                success : doit
                            });
                            return false;
                        },
                        Cancel : function()
                        {
                            $(this).dialog("close");
                        }

                    }
                });

            });

        }); 
```

但是，当我实际按下按钮时，我收到以下控制台错误： Uncaught TypeError: Object [object Object] has no method 'ajaxSubmit'

我已经检查了 ID 是否全部匹配，并且正在加载相关的 js 文件。

我现在没有想法了，有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-28T09:15:09.410

有同样的错误信息，并通过添加具有 ajaxSubmit 功能的 jQuery Form 插件解决。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T09:45:05.997

仅供将来参考，因为我是个白痴，所以抛出了错误：/我显然包含了两个不同版本的 jQuery，只要我删除了额外的包含，它就开始工作了。

# javascript - 当用户单击按钮时，将文本字符串添加到输入字段中

> ID：13941055
> 
> 赞同：20
> 
> 时间：2012-12-18T20:35:49.340
> 
> 标签：javascript, jquery

基本上只是试图将文本添加到已经包含一个值的输入字段..触发器是一个按钮..

在我们点击按钮之前，表单字段看起来像..（用户输入了一些数据）

```
[This is some text]
(Button) 
```

点击按钮后，字段看起来像..（我们添加`after clicking`到当前值）

```
[This is some text after clicking]
(Button) 
```

尝试仅使用 javascript 完成..

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2012-12-18T20:51:07.523

您的工作示例

**HTML：**

```
<input type="text" value="This is some text" id="text" style="width: 150px;" />
<br />
<input type="button" value="Click Me" id="button" />​ 
```

**jQuery：**

```
<script type="text/javascript">
$(function () {
    $('#button').on('click', function () {
        var text = $('#text');
        text.val(text.val() + ' after clicking');    
    });
});
<script> 
```

**Javascript**

```
<script type="text/javascript">
document.getElementById("button").addEventListener('click', function () {
    var text = document.getElementById('text');
    text.value += ' after clicking';
});
</script> 
```

工作 jQuery 示例： http: [//jsfiddle.net/geMtZ/](http://jsfiddle.net/geMtZ/) ​</p>

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T20:47:50.333

这将只使用 javascript - 您也可以将函数放在 .js 文件中并使用 onclick 调用它

```
//button
<div onclick="
   document.forms['name_of_the_form']['name_of_the_input'].value += 'text you want to add to it'"
>button</div> 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-18T20:45:45.173

这是：http: [//jsfiddle.net/tQyvp/](http://jsfiddle.net/tQyvp/)

如果您不喜欢使用 jsfiddle，请使用以下代码：

html

```
<input id="myinputfield" value="This is some text" type="button">​ 
```

Javascript：

```
$('body').on('click', '#myinputfield', function(){
    var textField = $('#myinputfield');
    textField.val(textField.val()+' after clicking')       
});​ 
```

# ios - 在固定点上旋转 UIImageView

> ID：13941060
> 
> 赞同：0
> 
> 时间：2012-12-18T20:36:05.227
> 
> 标签：ios, xcode

在我的应用程序中，我想在屏幕中央放置一个圆形的 UIImage。然后我希望用户能够旋转图像，触摸圆周上的一个特定点，然后像轮子一样拖动，但我不知道从哪里开始。

我知道我可以使用开始、移动和结束的触摸，但是我怎样才能确定一个点呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:45:16.243

`origin`您可以调整`UIView`. 这应该强制围绕该点旋转。

# database - 价目表的数据库表结构

> ID：13941061
> 
> 赞同：0
> 
> 时间：2012-12-18T20:36:04.683
> 
> 标签：database, structure

我有大约 10 个表，其中记录了日期范围和一些值属于日期范围。

每个表都有一些含义。

例如

费率

```
 start_date DATE
    end_date DATE
    price DOUBLE 
```

可用性

```
 start_date DATE
    end_date DATE 
    availability INT 
```

然后表日期

```
 day DATE 
```

未来 2 年的每一天的日期在哪里。

最终结果是将这 10 个表连接到日期表。查询需要更长的时间，因为还有一些其他的连接和子查询。

我一直在考虑创建一个更大的表，其中包含每天的所有 10 个表数据，但最终表将有大约 1.5M - 2M 记录。

从测试来看，在此表中搜索而不是连接表并在连接结果中搜索似乎更快（0.2 秒而不是大约 1 秒）。

有没有什么真正的理由为什么有一个包含这么多记录的表是个坏主意？

决赛桌看起来像

```
 day DATE 
    price DOUBLE 
    availability INT 
```

谢谢您的意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:19:09.833

我曾经沿着这条路走了一次，然后就后悔了。

您拥有数百万行的投影这一事实告诉我，一个表中的日期与另一个表中的日期不一致，导致为某些属性创建额外的边界，因为在一个表中所有属性必须共享相同的边界。

我遇到的问题是业务发生了变化，突然间我要处理更多的组合，并且行数激增，大大降低了查询速度。另一个问题是使数据保持最新——我的“超级”表是从单独的表中计算出来的，当它们发生变化时。

我发现将它们分开并将逻辑移动到应用程序层对我有用。

我处理的数据几乎和你的一样，除了我只有 3 个表：我有可用性、定价和利润。事实是这 3 个是不相关的，所以日期范围从不对齐，租给大表中的许多人工行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:27:44.687

这是一个复杂的问题。答案很大程度上取决于使用模式。据推测，大多数值不会每天都在变化。因此，您可能会大大增加数据库的大小。

另一方面，可用性之类的东西可能每天都在变化，因此您的数据库中已经有一个大表。

如果您的使用模式一次只关注一张桌子，我会很想说“别管它”。也就是说，如果它没有损坏，请不要进行更改。如果您的使用涉及对一种记录的多次更新，我倾向于将它们留在单独的表中（因此锁定一种类型的值不会阻止对其他类型的查询）。

但是，您的用法表明您正在组合这些表。如果是这样，我认为将它们每天每件放在一排是有道理的。如果您一次获得连续的天数，您可能会发现在基础表中具有不同的天数会大大简化您的查询。而且，如果您的查询专注于特定的时间范围，您建议的结构会将相关数据保留在缓存中，从而为更好的性能留出空间。

我很欣赏波西米亚人所说的。但是，您已经进入了最低级别的粒度，并看到它对您有用。我认为你应该继续进行重组。

# ios - 在 iOS 中使用按钮

> ID：13941065
> 
> 赞同：-2
> 
> 时间：2012-12-18T20:36:17.943
> 
> 标签：ios, objective-c, xcode

我正在尝试学习如何获得一个按钮（在我的情况下是一个“取消”按钮）来引导我回到它所在的上一页。我的上一页上有一个按钮，可将我引导至此页面，我希望此按钮将我带回上一页并丢弃我在该页面上写的任何内容。我的第一页上的按钮通过模式连接将视图推送到此页面。我知道只为取消按钮使用简单的模式连接来返回我的原始页面是有意义的，但我希望有一种更优雅的方式来做到这一点。我敢肯定，创建自定义视图是一个好主意，但我真的不知道该怎么做......哈哈，但任何建议都将不胜感激！

```
#import "AddEventViewController.h"
#import <QuartzCore/QuartzCore.h>

@interface AddEventViewController ()
@property (weak, nonatomic) IBOutlet UITextField *textField1;
@property (weak, nonatomic) IBOutlet UITextField *textField2;
@property (weak, nonatomic) IBOutlet UITextField *textField3;
@property (strong, nonatomic) IBOutlet UIScrollView *myScrollView;
@property (weak, nonatomic) IBOutlet UINavigationBar *addEventTitleBar;
@property (weak, nonatomic) IBOutlet UIBarButtonItem *cancelButton;
@property (weak, nonatomic) IBOutlet UIBarButtonItem *saveButton;
@property (weak, nonatomic) IBOutlet UITextView *myTextView;
- (IBAction)textFieldReturn:(id)sender;

@end

@implementation AddEventViewController

@synthesize textField1, textField2, textField3, myTextView;

- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
    self = [super initWithNibName:nibNameOrNil bundle:nibBundleOrNil];
    if (self) {
        // Custom initialization
    }
    return self;
}

- (IBAction)textFieldReturn:(id)sender;
{
    [sender resignFirstResponder];
}

- (void)viewDidLoad
{      // Do any additional setup after loading the view.
    [super viewDidLoad];
    self.textField1.delegate = self;
    textField1.delegate = self;
    self.textField2.delegate = self;
    textField2.delegate = self;
    self.textField3.delegate = self;
    textField3.delegate = self;

    [myTextView.layer setCornerRadius:10.0f];
    [myTextView.layer setBorderColor:[UIColor lightGrayColor].CGColor];
    [myTextView.layer setBorderWidth:1.5f];
    [myTextView.layer setShadowColor:[UIColor blackColor].CGColor];
    [myTextView.layer setShadowOpacity:0.002f];
    [myTextView.layer setShadowRadius:3.0f];
    [myTextView.layer setShadowOffset:CGSizeMake(2.0, 2.0)];
}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

- (void)touchesBegan: (NSSet *) touches withEvent: (UIEvent *)event
{
    if (textField1)
    {
        if ([textField1 canResignFirstResponder]) [textField1 resignFirstResponder];
    }
    [super touchesBegan: touches withEvent: event];

    if (textField2)
    {
        if ([textField2 canResignFirstResponder]) [textField2 resignFirstResponder];
    }
    [super touchesBegan: touches withEvent: event];

    if (textField3)
    {
        if ([textField3 canResignFirstResponder]) [textField3 resignFirstResponder];
    }
    [super touchesBegan: touches withEvent: event];
}

- (BOOL)textFieldShouldReturn:(UITextField *)textField
{
    if (textField == textField1)
    {
        [textField1 resignFirstResponder];
    }
    else if (textField == textField2)
    {
        [textField2 resignFirstResponder];
    }
    else if (textField == textField3)
    {
        [textField3 resignFirstResponder];
    }
    return YES;
}

-(void)addCancelButton
{
    UIBarButtonItem *cancelButton = [[UIBarButtonItem alloc] initWithTitle:@"Cancel"style:UIBarButtonSystemItemAction target:self action:@selector(cancel:)];

    self.navigationItem.leftBarButtonItem = cancelButton;
}

-(void)cancel:(id)sender
{
    [self.navigationController dismissViewControllerAnimated:YES completion:nil];

    [self.navigationController popViewControllerAnimated:NO];
}

@end 
```

修复了问题！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:00:28.130

你可以这样解决它：

```
- (void)addCancelButton{

    UIBarButtonItem *cancelButton = [[UIBarButtonItem alloc] initWithTitle:@"Cancel"
                                                                     style:UIBarButtonSystemItemCancel target:self action:@selector(cancel:)];

    self.navigationItem.leftBarButtonItem = cancelButton;

}

- (void)cancel:(id)sender{
    //If presented
    [self.navigationController dismissViewControllerAnimated:YES completion:nil];

    //If pushed
    [self.navigationController popViewControllerAnimated:NO];
    } 
```

AddCancelButton 中的代码可以移动到 viewDidLoad 或适当的地方。您可能希望根据视图的添加方式（推送、呈现等）来编辑视图的移除方式。

# java - 在 Oracle 中设置时间戳

> ID：13941071
> 
> 赞同：1
> 
> 时间：2012-12-18T20:36:37.700
> 
> 标签：java, sql, oracle, jdbc, oracle11g

我在 Oracle SQL 查询中使用准备好的语句。我有问题，我不知道如何解决。

我想像这样设置时间戳：

```
ps.setTimestamp(36, null); 
```

问题是我不知道要设置什么参数才能在 Oracle 中执行时间戳？在我的情况下，我必须如何替换 null ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:00:12.383

此示例将`Timestamp`值设置为当前时间（精确到毫秒）：

```
Timestamp ts = new Timestamp(new Date().getTime());
ps.setTimestamp(36, ts); 
```

如果您还需要纳秒，您可以单独设置它们：

```
Timestamp ts = new Timestamp(new Date().getTime());
ts.setNanos(12345);
ps.setTimestamp(36, ts); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:44:10.743

如果您查看 PreparedStatement 类中的[方法](http://docs.oracle.com/javase/6/docs/api/java/sql/PreparedStatement.html#setTimestamp%28int,%20java.sql.Timestamp%29)，您需要创建一个[TimeStamp](http://docs.oracle.com/javase/6/docs/api/java/sql/Timestamp.html)对象，您将用它来替换您的 null。

# java - 使用单个 logging.properties 记录到不同的文件

> ID：13941076
> 
> 赞同：0
> 
> 时间：2012-12-18T20:36:52.373
> 
> 标签：java, logging

我正在尝试配置在多个应用程序之间共享的 logging.properties 文件。我想要我的一个类的特定日志文件，但我不希望文件中包含其他日志（来自其他类）。

如何仅通过修改 logging.properties 文件来实现此目的？

我有以下 logging.properties 文件：

```
############################################################
#   Default Logging Configuration File
#
# You can use a different file by specifying a filename
# with the java.util.logging.config.file system property.  
# For example java -Djava.util.logging.config.file=myfile
############################################################
############################################################
#   Global properties
############################################################
# "handlers" specifies a comma separated list of log Handler 
# classes.  These handlers will be installed during VM startup.
# Note that these classes must be on the system classpath.
# By default we only configure a ConsoleHandler, which will only
# show messages at the INFO and above levels.
handlers= java.util.logging.ConsoleHandler
# To also add the FileHandler, use the following line instead.
#handlers= java.util.logging.FileHandler, java.util.logging.ConsoleHandler
# Default global logging level.
# This specifies which kinds of events are logged across
# all loggers.  For any given facility this global level
# can be overriden by a facility specific level
# Note that the ConsoleHandler also has a separate level
# setting to limit messages printed to the console.
.level= INFO
############################################################
# Handler specific properties.
# Describes specific configuration info for Handlers.
############################################################
# default file output is in user's home directory. 
```

**java.util.logging.FileHandler.pattern = %h/default.log（所有日志当前都到这个文件）**

```
java.util.logging.FileHandler.limit = 50000
java.util.logging.FileHandler.count = 1
java.util.logging.FileHandler.formatter = java.util.logging.XMLFormatter
# Limit the message that are printed on the console to INFO and above.
java.util.logging.ConsoleHandler.level = INFO
java.util.logging.ConsoleHandler.formatter = java.util.logging.SimpleFormatter
############################################################
# Facility specific properties.
# Provides extra control for each logger.
############################################################

# For example, set the com.xyz.foo logger to only log SEVERE
# messages: 
```

**my.class.logger.level = INFO（我希望这个类记录到文件/home/myuser/myclass.log）**

```
other.class.logger.level = ALL 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-09-30T22:47:10.433

也可以使用纯 jdk（尝试使用 jdk 7 或 jdk 8）。

只需创建自定义文件处理程序；使用类似于`java.util.logging.FileHandler`并扩展它。

```
public class JULTestingFileHandler extends FileHandler {

    public JULTestingFileHandler() throws IOException, SecurityException 
    {
        super();    
    }
} 
```

用户属性文件；

```
com.xxx.handlers = com.xxx.JULXXXFileHandler

com.xxx.JULXXXFileHandler.pattern   = ./logs/test1_test2.%u.%g.log 
```

# jquery - 使用 Bootstrap 更改背景和 CSS

> ID：13941079
> 
> 赞同：0
> 
> 时间：2012-12-18T20:36:54.753
> 
> 标签：jquery, css, twitter-bootstrap

我正在尝试通过每个模块加载来更改我的网站的背景。它在不导入引导程序的情况下完美运行，但是一旦我尝试导入引导程序，它似乎 `$('html').css({"background":background})`只对不使用 Twitter 引导程序的部分有效。

我觉得只有在导入 Twitter 引导程序时才应该更改背景。这里是截图：[https ://www.dropbox.com/s/ztcx56p9b7twq8b/Screen%20Shot%202012-12-18%20at%203.35.21%20PM.png?m](https://www.dropbox.com/s/ztcx56p9b7twq8b/Screen%20Shot%202012-12-18%20at%203.35.21%20PM.png?m)

```
 <!DOCTYPE html>
<html>
<head>

    <script src="/javascripts/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="/javascripts/jquery-1.8.3.min.js"></script>
    <script type="text/javascript" src="/javascripts/background_decider.js"></script>
    <link rel='stylesheet' href='/stylesheets/css/bootstrap.min.css'/>
    <link rel='stylesheet' href='/stylesheets/style.css' />
</head>

  <body>
      <script type="text/javascript">

         window.onload = function() {
           window.setTimeout(function () {
                var background = select_background();
                $('html').css({"background":background});
           }, 0);
           };

      </script>
    <div class="title">
      <form class="form-horizontal">
        <div class="control-group">
          <div class="controls">
            <label class="control-label" for="inputEmail">Email</label>
            <input type="text" id="inputEmail" placeholder="Email">
          </div>
        </div>
        <div class="control-group">
          <div class="controls">
            <label class="control-label" for="inputPassword">Password</label>
            <input type="password" id="inputPassword" placeholder="Password">
          </div>
        </div>
      </form>

    </div>
  </body>

</html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:47:28.350

看起来某个元素覆盖了您页面的一部分。如果没有看到完整的 HTML/CSS，很难说出那是什么。但是，这是我要开始的地方：

1.  使用 FireBug（在 FireFox 中）或开发者工具（在 Chrome 中：Ctrl+Shift+J，IE：F12）来选择元素以确定它是什么。
2.  将下面的代码添加到您的 CSS 文件中。它确保使用它的元素没有背景。
3.  添加`class="transparent"`到步骤 1 中的元素。

.

```
.transparent
{
    border-color: transparent;
    background-color: transparent;
    background-image: none;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-20T19:36:01.023

感谢您的帮助，但这就是我解决问题的方法：

我改变了 $('html').css({"background":background}); 到 $('body').css({"background":background});

# delphi - DCC 错误：发布的字段不是类或接口类型

> ID：13941082
> 
> 赞同：4
> 
> 时间：2012-12-18T20:36:57.180
> 
> 标签：delphi, class, interface, syntax-error, field

我不断收到以下 DCC 错误，发布的字段“名称”不是以下类的类或接口类型。

```
 TGroup = class
    name:string[32]; <<<========================
    rwFeatures:TFeatures;
    roFeatures:TFeatures;
    levels:TLevels;   
  private

  public
    constructor Create;
    procedure Read(var f:file);
    procedure ReadOld(var f:file);
    procedure Write(var f:file);   
  end; 
```

这是什么意思？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:57:30.323

该类是在启用[Emit 运行时类型信息](http://docwiki.embarcadero.com/RADStudio/XE3/en/Run-Time_Type_Information_%28Delphi%29)设置的情况下编译的。当使用运行时类型信息编译类时，默认可见性为`published`. 这意味着短字符串字段是`published`. 并且不允许发布短字符串字段。

[文档](http://docwiki.embarcadero.com/RADStudio/XE3/en/Classes_and_Objects#Published_Members)说：

> 只有当它们是类或接口类型时，才能发布字段。

这是一个相当严格的要求。例如，这意味着您不能发布整数或布尔字段。

我怀疑这个限制是因为发布字段的主要用途是对象引用。想想表单上的组件。

使用以下选项之一解决问题：

1.  不要发出此类的运行时类型信息。
2.  使短字符串字段公开而不是发布。
3.  使用属性而不是字段。

# objective-c - 为什么 NSURLConnection 的 currentRequest 重定向后没有指明正确的 URL？

> ID：13941084
> 
> 赞同：4
> 
> 时间：2012-12-18T20:37:09.180
> 
> 标签：objective-c, ios, cocoa, ios5

通过阅读文档`NSURLConnection`，该`currentRequest`方法应该反映加载时可能发生的任何重定向：

> 当连接执行负载时，请求可能会由于协议规范化或由于以下重定向而改变。此方法用于检索当前值。

但是，当我检查它时`currentRequest`，`connectionDidFinishLoading:`它总是有原始请求的 URL，即使检查响应数据表明重定向成功完成。（请参见下面的人为示例）

我的问题是：为什么不`currentRequest`返回实际的当前请求？我做错了什么还是这是预期的行为？如果这*是*预期的行为，那么`currentRequest`应该有什么用处？

```
@interface AppDelegate : UIResponder <UIApplicationDelegate, NSURLConnectionDataDelegate>
@property (strong, nonatomic) NSURLConnection *connection;
@end

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    NSURL *url = [[NSURL alloc] initWithString:@"http://jigsaw.w3.org/HTTP/300/301.html"];
    NSURLRequest *request = [[NSURLRequest alloc] initWithURL:url];
    self.connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];

    return YES;
}

- (NSURLRequest *)connection:(NSURLConnection *)connection willSendRequest:(NSURLRequest *)request redirectResponse:(NSURLResponse *)response
{
    NSLog(@"willSendRequest // request: %@ // currentRequest: %@", request, [connection currentRequest]);
    return request;
}

- (void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    NSLog(@"didFinishLoading // originalRequest: %@ // currentRequest: %@", [connection originalRequest], [connection currentRequest]);
}

@end 
```

运行这个例子会给我以下输出：

```
2012-12-18 15:18:44.949 ConnectionTest[12534:c07] willSendRequest // request: <NSURLRequest http://jigsaw.w3.org/HTTP/300/301.html> // currentRequest: <NSURLRequest http://jigsaw.w3.org/HTTP/300/301.html>
2012-12-18 15:18:44.954 ConnectionTest[12534:c07] willSendRequest // request: <NSURLRequest http://jigsaw.w3.org/HTTP/300/Overview.html> // currentRequest: <NSURLRequest http://jigsaw.w3.org/HTTP/300/301.html>
2012-12-18 15:18:44.955 ConnectionTest[12534:c07] didFinishLoading // originalRequest: <NSURLRequest http://jigsaw.w3.org/HTTP/300/301.html> // currentRequest: <NSURLRequest http://jigsaw.w3.org/HTTP/300/301.html> 
```

我的期望是最后一次调用`currentRequest`会显示以 结尾的页面 URL `Overview.html`，但它仍然显示`301.html`。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-30T20:20:49.630

我只是将这归结为 Apple 不得不混淆文档。我可以通过检查响应对象来获得最终的请求 URL，但对我来说，所谓的东西`currentRequest`应该反映在重定向之后发出的最后一个请求。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-30T09:10:53.490

重定向是如何发生的？http 服务器是否返回重定向状态？

原始 URL 请求可能不是可变的，因此系统无法修改 URL。

您必须为每个重定向发出一个新请求，如此处的答案所述：[使用 NSURLConnection 正确处理重定向](https://stackoverflow.com/questions/1446509/handling-redirects-correctly-with-nsurlconnection)

您不是从连接中获取最终 URL，而是从响应对象中获取。例如，请参阅我制作的这个 URL unshortener：http: [//www.cocoanetics.com/2012/06/mine-is-longer-than-yours/](http://www.cocoanetics.com/2012/06/mine-is-longer-than-yours/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T05:50:01.253

我不是 Iphone Developper（只是 Mac），但似乎大多数 NSURLConnectionDelegate 方法在 iOS5 中已被弃用，而 NSURLDownload （及其委托）似乎是执行此操作的新方法：[NSURLConnectionDelegate](http://developer.apple.com/library/ios/#documentation/Foundation/Reference/NSURLConnectionDelegate_Protocol/DeprecationAppendix/AppendixADeprecatedAPI.html#//apple_ref/occ/instm/NSObject/connection%3adidReceiveResponse%3a) [NSURLDownloadDelegate](https://developer.apple.com/library/mac/#documentation/Foundation/Reference/NSURLDownloadDelegate_Protocol/Reference/Reference.html#//apple_ref/occ/intf/NSURLDownloadDelegate)

# javascript - 在rails hidden_ field_tag中调用javascript函数

> ID：13941085
> 
> 赞同：1
> 
> 时间：2012-12-18T20:37:13.150
> 
> 标签：javascript, ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, braintree

我正在一个简单的站点中设置 Braintree。Braintree 是一个支付平台。在他们的示例中，他们使用 hiddel_field_tag 如下：

```
<%= hidden_field_tag :tr_data, Braintree::TransparentRedirect.transaction_data(
  :redirect_url => confirm_payment_url,
  :transaction => {:type => "sale", :amount => @amount }
) %> 
```

现在，就我而言，我想通过 javascript 函数设置交易金额，因为我只有三个选项，而不是通过服务器。我尝试了很多东西，比如

```
<%= hidden_field_tag :tr_data, Braintree::TransparentRedirect.transaction_data(
  :redirect_url => confirm_payment_url,
  :transaction => {:type => "sale", :amount => "return amountFunction();" }
) %> 
```

在哪里

```
function amountFunction()
{
  var amount = $('input[name=optionsRadios]:radio:checked').val();
  return amount;
} 
```

但不工作。如您所见，我仍处于使用 Rails 的学习阶段。所以问题是，如何更改变量或将函数添加到 hidden_​​field_tag？我也可以制作 :amount => "variable-set-by-javascript"，但没能做到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-02T15:02:02.520

[我在布伦特里工作。我们错过了这个问题，但希望您联系[支持](https://www.braintreepayments.com/support)或找出您的问题。]

该`Braintree::TransparentRedirect.transaction_data`方法在呈现表单之前在服务器上运行，因此它需要一个实际金额，而不是稍后将评估并返回金额的字符串。

此外，您通常不能/不应该在`transaction_data`. 这将允许某人更改浏览器中的金额并提交他们想要的任何金额的交易——这是您想要避免的事情，因为这可能会花费您金钱。

由于您发布了这个问题，我们已经启动了[Braintree.js](https://www.braintreepayments.com/docs/javascript/encryption/overview)，它允许您将整个表单发布到您的服务器，并[在将表单提交到 Braintree 之前](https://www.braintreepayments.com/docs/ruby/guide/getting_paid)验证金额是否有效。我建议对任何新的集成使用该集成方法，或者如果您需要对付款流程进行其他更改，则升级到它。

# c++ - 试图让多图打印出问题

> ID：13941089
> 
> 赞同：0
> 
> 时间：2012-12-18T20:37:25.963
> 
> 标签：c++, printing, random, multimap

多图包含`multimap<int,Questions*> map;`. 我尝试使用以下方法打印地图：

```
Questions* Questions::printQuestion(int level)
{
    multimap<int, Questions*>::iterator it;
    pair<multimap<int, Questions*>::iterator,multimap<int, Questions*>::iterator> ret;

    ret = map.equal_range(level);
    if(ret.first != ret.second)
    {
    size_t sz = distance(ret.first, ret.second);
    size_t idx = rand() % sz;
    advance(ret.first, idx);
    it =ret.first;
    return (*it).second;
    }
    else
    {
        return NULL;
    }
} 
```

但是该方法什么也没做。有人可以帮我吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:25:11.280

此功能不打印任何内容。它返回`Questions*`从具有给定级别的所有问题中随机选择的一个。因此，如果有 3 个级别为 5 的问题，并且您调用`printQuestion(5)`，您将获得指向这三个问题的随机问题的指针。如果要打印在此函数中选择的问题，则必须执行以下操作：

```
Questions* question = (*it).second;
std::cout << question->getText() << std::endl; 
```

替换`getText()`为打印问题所需的任何内容。

如果您希望调用该函数的客户端打印问题，您将执行以下操作：

```
Questions* question = printQuestion(5);
std::cout << question->getText() << std::endl; 
```

顺便说一句，用复数形式命名类并不常见。如果您的类被调用`Question`而不是`Questions`.

# android - 如何通过共享意图共享整个 Android 应用程序

> ID：13941093
> 
> 赞同：52
> 
> 时间：2012-12-18T20:37:39.553
> 
> 标签：android, android-intent, sharing

我之前使用过共享类型的意图，例如：

```
Intent intent = new Intent(Intent.ACTION_SEND);
intent.setType("plain/text");
intent.putExtra(Intent.EXTRA_EMAIL, new String[] { "---" });
intent.putExtra(Intent.EXTRA_SUBJECT, "---");
startActivity(Intent.createChooser(intent, "Contact Us!")); 
```

但是，这基本上与电子邮件/彩信和其他文本或文档类型的应用程序共享。你如何做同样的事情，但包括 Facebook、Twitter 和 Google Plus 等社交分享（举出重要的名字）。我想分享的是这个应用程序，上面的文字说，“嘿，下载这个链接来看看这个应用程序！” （或类似的东西）。

* * *

## 回答 #1

> 赞同：138
> 
> 时间：2012-12-18T20:43:11.053

要添加 Facebook、Twitter 等共享选项，用户只需**安装这些应用程序**。这取决于其他应用程序`Intents`它们将告诉系统它们可以处理的类型。

然后一个基本的`ACTION_SEND`意图将被拾起。

```
Intent sendIntent = new Intent();
sendIntent.setAction(Intent.ACTION_SEND);
sendIntent.putExtra(Intent.EXTRA_TEXT,
    "Hey check out my app at: https://play.google.com/store/apps/details?id=" + BuildConfig.APPLICATION_ID);
sendIntent.setType("text/plain");
startActivity(sendIntent); 
```

[来源](http://developer.android.com/training/sharing/send.html)

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2018-07-31T11:56:56.787

如果您应用此代码，则如下图所示

```
Intent intent = new Intent(Intent.ACTION_SEND);
intent.setType("text/plain");
intent.putExtra(Intent.EXTRA_SUBJECT, "My application name");
intent.putExtra(Intent.EXTRA_TEXT, "This is my text");
startActivity(Intent.createChooser(intent, "choose one")); 
```

[![在此处输入图像描述](../Images/f62f3f74b91c903f5146b03ebee7a8db.png)](https://i.stack.imgur.com/r75nO.png)

**==================================================== ====================**

如果您应用此代码，则如下图所示

```
Intent sendIntent = new Intent(Intent.ACTION_SEND);
sendIntent.setType("text/plain");
sendIntent.putExtra(Intent.EXTRA_TEXT, "This is my text to send.");
startActivity(sendIntent); 
```

[![在此处输入图像描述](../Images/05f5550170c612c252478a24096255b1.png)](https://i.stack.imgur.com/Qccue.png)

* * *

## 回答 #3

> 赞同：6
> 
> 时间：2012-12-18T20:43:02.533

您可以通过使用共享意图来做到这一点

```
 Intent shareIntent = new Intent(Intent.ACTION_SEND);
            shareIntent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
            shareIntent.setType("text/plain");
            shareIntent.putExtra(android.content.Intent.EXTRA_TEXT, "Hey, download this app!");
            startActivity(shareIntent); 
```

您可以将此意图放在 onclick 中或在任何您想要的地方使用它

我认为这回答了你的问题=）

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-07-31T13:20:42.157

在 Kotlin 中，我们可以这样做：

```
 private fun share(messageToShare: String, appUrl: String) {
    val intent = Intent(Intent.ACTION_SEND)
    intent.type = "text/plain"
    intent.putExtra(Intent.EXTRA_TEXT, messageToShare + appUrl)
    startActivity(Intent(intent))
} 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2012-12-18T20:43:41.513

`Intent.EXTRA_TEXT`额外分享google play的链接

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2018-06-14T11:08:51.640

您还可以在共享应用程序时添加标题、主题和正文：

```
Intent sharingIntent = new Intent(android.content.Intent.ACTION_SEND);
                sharingIntent.setType("text/plain");
                sharingIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, "My App Name");
                sharingIntent.putExtra(android.content.Intent.EXTRA_TEXT, getResources().getString(R.string.share_app_text));
                startActivity(Intent.createChooser(sharingIntent, "Share app via")); 
```

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2018-06-14T11:21:38.757

> 试试这对我来说工作正常：

```
 Intent intent = new Intent();
    intent.setAction(Intent.ACTION_SEND);
    intent.putExtra(Intent.EXTRA_TEXT,"I suggest this app for you : https://play.google.com/store/apps/details?id=com.android.chrome");
    intent.setType("text/plain");
    startActivity(intent); 
```

# macos - 是否可以在特定页面使用 Preview.app 打开 PDF？

> ID：13941104
> 
> 赞同：5
> 
> 时间：2012-12-18T20:38:32.570
> 
> 标签：macos, cocoa

`path`我可以在我的应用程序中使用 Preview.app愉快地打开 PDF 文件

```
[NSWorkspace.sharedWorkspace openFile: path]; 
```

但是，我想在某个页面上使用该文件启动 Preview.app。这可能吗，例如通过传递特定`NSAppleEventDescriptor`的 in `NSWorkspace`'s

```
- (BOOL)openURLs:(NSArray *)urls withAppBundleIdentifier:(NSString *)bundleIdentifier options:(NSWorkspaceLaunchOptions)options additionalEventParamDescriptor:(NSAppleEventDescriptor *)descriptor launchIdentifiers:(NSArray **)identifiers 
```

方法？QuickLook 可以做到这一点，我想模仿这种行为。

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-10-03T17:12:36.743

你可以通过 NSAppleScript 做到这一点。

下面是一个打开文件并跳转到指定页面的 NSWorkspace 类别方法：

```
- (void)openPreviewFile:(NSString*)filePath onPage:(int)pageNumber {
    [self openFile:filePath];

    NSString *sysEvents = @"System Events";

    NSString *source = [NSString stringWithFormat:@"tell application \"%@\" to activate\ntell application \"%@\" to keystroke \"g\" using {command down, option down}\ndelay %f\ntell application \"%@\" to keystroke \"%i\"\ntell application \"%@\" to keystroke return",
                        @"Preview", sysEvents, 0.5, sysEvents, pageNumber, sysEvents];

    NSAppleScript *script = [[[NSAppleScript alloc] initWithSource:source] autorelease];
    [script executeAndReturnError:nil];
} 
```

这是这样做的：

*   在 NSWorkspace 实例上调用 openFile:
*   打开预览的转到页面对话框
*   等待对话框弹出
*   模拟应该被激活的页面的按键，然后按回车

然后，您可以像这样调用该方法：

```
[[NSWorkspace sharedWorkspace] openPreviewFile:@"/YOUR_PDF.pdf"
                                        onPage:3]; 
```

*免责声明：如果用户为“转到页面...”菜单项定义了自定义键盘快捷键，则会中断！*

# ruby-on-rails-3 - 在 Rails 视图中列出数据表的订单计数

> ID：13941116
> 
> 赞同：3
> 
> 时间：2012-12-18T20:39:11.053
> 
> 标签：ruby-on-rails-3

我一直在寻找解决我面临的问题的方法，并找到了相关的解决方案，但到目前为止还没有什么是完全正确的。

我有一个 Rails 3.2.9 应用程序，在名为 Mentions 的表中有超过 100,000 行数据。提及是已针对某些主题进行分类的推文的快照，这些主题记录为`event_types`. 表结构的简化版：

```
 create_table "mentions", :force => true do |t|
        t.integer  "event_id"
        t.string   "event_type"
        t.string   "event_name"
        t.integer  "source_author_follower_count"
        t.integer  "impressions"
        end 
```

我想要做的是在一个视图中创建一个表，其中包含一个有序的唯一`event_name`实例列表，该列表按`event_name`数据库中出现相同行的次数以及每个实例`source_author_follower_count`和`impressions`字段的总和进行排序。

所以最终结果看起来像：

```
 Event ID     Number Occurrences    Reach    Impressions

    event 1      3000000               1234     5000
    event 1      2000000               1034     4000
    event 1      1550000                834     2250 
```

等等

我已经能够弄清楚如何以多种方式进行计数，但无法找到一种方法将数据实现到视图中的表中，并且不会用浏览器来破坏浏览器巨大的要求。

非常感谢任何输入/反馈。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:37:23.887

对于大量数据，您应该考虑使用具有服务器端处理功能的 DataTables：http: [//datatables.net/usage/server-side](http://datatables.net/usage/server-side)

# c++ - 无法分配给 qstring 变量

> ID：13941119
> 
> 赞同：2
> 
> 时间：2012-12-18T20:39:23.970
> 
> 标签：c++, qt

我很擅长编程，但对 c++/qt 的世界很陌生。

我一直在修改 qwt 库中的示波器示例，以使用 QtExtSerialPort 库从 arduino 板读取输入。（是的，我知道 QtSerial，但是当我发现时，我对实现有点太远了）

arduino 将值写入串行端口，一行一个数字，如

```
1.23
2.33
4.56
2.12
0.32 
```

等等。当 PC 读取数据时，它以块的形式进入，所以在一次读取中，我可能会得到类似的东西

```
3
2.33
4 
```

然后下次

```
.56
2\. 
```

等等。

在阅读器线程的头文件中，我定义了一个

```
QString buffer; 
```

然后在阅读时我正在使用这个功能：

```
double SamplingThread::value( double timeStamp ) const
{
  double v;
  QByteArray inpt;
  int a = port->bytesAvailable();
  inpt.resize(a);
  port->read(inpt.data(), inpt.size());
  QString strng=buffer+QString::fromAscii(inpt); 
  // This concatenates what is left over since last time to what is read now:
  int j=strng.indexOf("\n");
  if(j>-1){
  // if a newline, ie the first number is complete 
    QString s=strng.left(j-1);
    v=s.toFloat();
    s=strng.mid(j+1,-1); // What is to be saved to next time
    buffer =s; // store it in the global buffer
    return v*d_amplitude/5;
  }
} 
```

（是的，我知道一旦我读到一个包含两个 \n 的块，我就会遇到问题）

这很好用，除了我无法存储全局缓冲区中剩下的内容。在那一行我得到错误：

```
samplingthread.cpp:89: error: no match for 'operator*=' in
'((const SamplingThread*)this)->SamplingThread::buffer *= s' 
```

我一直对这意味着什么感到困惑。我打算将一个 QString 复制到另一个 QString - 但是......？我是否在某处用指针弄乱了一些东西，但如果是这样，为什么我可以将 QStrings 分配给其他地方？和我只做一条线有什么区别？( s=strng.right(j+1) )

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:43:39.977

摆脱价值函数上的“const”。

“const”函数只能调用其类变量的函数，如果它们也是“const”的话。这就是为什么有些功能起作用，而有些则不起作用的原因。

# python - 使用乘法运算符在 Python 中定义列表

> ID：13941124
> 
> 赞同：4
> 
> 时间：2012-12-18T20:39:38.430
> 
> 标签：python, list, append

最近在Python中我遇到了这样的说法：

```
board.append([' '] * 8) 
```

我曾尝试用谷歌搜索互联网以找到有关此类声明的更多信息，但我不能。

我知道*该*声明的作用，但我不明白它是*如何*、以什么方式做的。

这是我第一次看到在`*`列表中使用的运算符。您能否请我到一个可以找到有关此类陈述的更多信息的地方？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T20:43:08.823

> 你能否请我到一个地方，在那里我可以找到有关此类陈述的更多信息。

大多数相关的运算符和方法都在这里定义：[序列类型](http://docs.python.org/2/library/stdtypes.html#sequence-types-str-unicode-list-tuple-bytearray-buffer-xrange)。

具体`s * n`定义为

> `s * n, n * s` --连接`n`的浅拷贝`s`

这里，`s`是一个序列，`n`是一个数字。

因此，`[' '] * 8`返回一个由八个组成的列表`' '`。

`board.append()`将结果附加到`board`，这可能是一个列表（列表）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:44:26.500

它是这样工作的：

```
>>> L = [0]*10
>>> L
[0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
>>> 
```

如果您需要了解 Python 中的某些内容是如何工作的，请在[Python](http://en.wikipedia.org/wiki/Python_%28programming_language%29)[文档](http://docs.python.org/2/)中查找它，或者自己尝试一下。

# windows-phone-7 - 是否可以仅更改给定应用程序的语言/文化信息？/ WinPhone7

> ID：13941127
> 
> 赞同：0
> 
> 时间：2012-12-18T20:39:52.410
> 
> 标签：windows-phone-7, multilingual

是否可以仅更改给定应用程序的语言/文化信息？期望的行为是让用户选择他们喜欢在我的应用程序中使用的语言，而无需更改设备/手机的语言。此外，它必须是一个运行时功能（即用户选择语言并且应用程序同时切换到该语言）。这可能吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:43:31.207

这是可能的，但您必须手动设置应用程序的本地化行为。[在此处](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff637520%28v=vs.105%29.aspx)查看更多详细信息。具体来说，您将不得不重新处理要附加到本地管理值的绑定，这些值根据应用程序而不是系统范围的设置进行更改。

# javascript-events - asp按钮不触发javascript客户端

> ID：13941129
> 
> 赞同：0
> 
> 时间：2012-12-18T20:39:57.090
> 
> 标签：javascript-events, aspbutton

这让我很丧，必须是我忽略的简单事情。我试图通过单击 ASP 按钮来触发一个简单的 javascript 函数。我的按钮如下所示：

```
<asp:Button ID="btnFinalize" runat="server" Enabled="False" OnClientClick="finalizeClick(); return false;" Text="Finalize Selection" /> 
```

我确实根据其他一些客户端逻辑启用它，一旦启用，我单击它但没有任何反应。

我在 JS 函数 finalizeClick() 中有一个断点，它永远不会到达那里。

所以我尝试了一个常规的 HTML 按钮，它调用了这个函数并按预期执行。看起来像：

```
<input  type="button" id="btnFinalizeNotASP" value="button" onclick="finalizeClick();"/> 
```

快疯了，求救。

编辑更多信息。必须是 Enabled="False"。如果我把它从 ASP 标签中取出来，它就可以工作。我想从禁用按钮开始并在其他事件客户端启用它我在我设置的另一个 javascript 事件中执行此操作：

```
finalizeButton.disabled = false; 
```

不知道为什么，但 finalizeButton.enabled = ture; 从来没有打开过按钮。

仍然不解

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:23:41.637

我想出了一些可行的方法，但我真的不喜欢它。想从其他人那里知道为什么以及是否有更好的解决方案。

如果我离开：

```
Enabled="False" 
```

从我的 ASP 标签中取出

```
var btnfinalize = document.getElementById("<%=btnFinalize.ClientID %>");
btnfinalize.disabled = true; 
```

在我页面的 javascript 中，ASP 按钮在设计期间启用，在页面加载时禁用，并在以后启用（真正禁用=false）并单击时正确触发我想要的 javascrip 功能

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:45:09.020

不，当您不需要控件在服务器端运行时使用 HTML 控件，而不是 ASP.NET 服务器控件。

IE

```
< input type="button" / > 
```

代替

```
< asp:Button ID="btn" runat="server" / > 
```

# css - Firefox 水平列表滚动 CSS

> ID：13941135
> 
> 赞同：0
> 
> 时间：2012-12-18T20:40:15.293
> 
> 标签：css, firefox, scroll

我有一个设置为水平显示而不是垂直显示的列表。它也设置为全屏高度（不确定这是否会有所不同）。该列表在 Chrome 和 Safari 中正确显示，但在 Firefox 中仅显示第一项。有时如果我刷新，它会显示所有项目，但仅以垂直格式显示。我尝试了几种修复方法，但似乎都没有。如果有人能对此有所了解，将不胜感激。

这是HTML：

```
<ul class="project">

<li class="item">
<div class="overlay">
<section class="img-info">
  <h1>Ro, 2012</h1>

</section>
</div>
<img src="01.jpg" />
</li>

<li class="item">
<div class="overlay">
<section class="img-info">
  <h1>Jonathan, 2012</h1>

</section>
</div>
<img src="02.jpg" />
</li>
</ul> 
```

这是CSS：

```
article.projects {
    height:100%;
    float:none;
    overflow-x: scroll;
    overflow-y: hidden;
    white-space:nowrap;
}

article.projects ul.project {
    height:100%;
    width:auto;
    display:inline-block;
    float:left;
    padding-left:72px;
}

article.projects ul.project li.item {
    height:100%;
    width:auto;
    min-width:300px;
    float:left;
    padding-bottom:0px;
    padding-right:1px;
} 
```

该网站在这里 - [http://jennagarrett.com/](http://jennaegarrett.com/)

该站点是响应式的，因此如果您进入代码，相关的 css 将位于文件的底部。

# c++ - 为什么 memory_order 作为 std::atomic 函数的运行时参数给出

> ID：13941136
> 
> 赞同：19
> 
> 时间：2012-12-18T20:40:14.687
> 
> 标签：c++, c++11, atomic, memory-model

`std::atomic``store`和`load`接受参数等`std::memory_order`函数。参数可以在运行时确定，就像任何其他函数参数一样。但是，实际值可能会影响编译期间代码的优化。考虑以下：

```
std::atomic<int> ai1, ai2;
int value = whatever;

void foo() {
    std::memory_order memOrd = getMemoryOrder();
    register int v = value; // load value from memory
    ai1.store(v, memOrd);   // dependency on v's value
    ai2.store(1, memOrd);   // no dependency. could this be move up?
} 
```

如果`memOrd`碰巧`memory_order_relaxed`，第二家商店可以安全地移到第一家之前。这将在加载`value`和使用它之间增加一些额外的工作，这可能会防止其他需要的停顿。但是，如果`memOrd`是`memory_order_seq_cst`，则不应允许切换存储，因为某些其他线程可能会依赖`ai1`已设置为`value`if`ai2`设置为 1。

我想知道为什么将内存顺序定义为运行时参数而不是编译时间。在决定最佳内存操作语义之前，是否有任何理由让某人在运行时检查环境？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T07:52:09.063

这是作为运行时参数而不是编译时参数实现的原因是为了启用组合*。*

假设您正在编写一个函数，该函数使用提供的原子操作来执行相当于*加载*操作的操作，但在更高级别的构造上操作。通过将内存顺序指定为运行时参数，更高级别的负载可以将用户提供的内存顺序参数传递给提供排序所需的低级别原子操作，而无需高级操作必须是模板。

通常，原子指令是内联的，如果内存顺序参数实际上是一个编译时常量，编译器将消除对内存顺序参数的测试。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T22:28:24.757

它只是一个*允许*在`memory_order`运行时指定的接口规范。它不需要实现来使用该津贴。

例如`memory_order_seq_cst`，无论您指定什么，x86 硬件都可能是您所得到的。`memory_order_relaxed`由于硬件缓存一致性协议，只是不可用。

在其他硬件上，您可能能够针对编译时间已知顺序进行优化，实现可能会提供利用默认参数的额外重载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-09-03T05:41:20.780

C++ 的作者可以将 memory_order 实现为编译时功能，而不是运行时功能。然而，他们不会因此得到任何好处。任何能够理解内存顺序的编译器都可以轻松优化 x.load(memory_order_acq) 等明显的情况，因此它们不会从它作为编译时特性中受益。

同时，使用运行时特性意味着他们不必为内存顺序引入任何新的符号。它们只是函数参数。这意味着它们获得了与编译时版本相同的好处，但复杂性更低。

同时，对于更简单的编译器来说也非常方便，因为它们可以将 atomic 实现为普通类，而无需特殊处理。

```
T atomic<T>::compare_exchange_strong(T& compare, T exchange, memory_order order)
{
    lockBeforeUsing(order); // handle the acquire part of the memory order
    if (mValue == compare) {
        compare = mValue;
        mValue = compare;
    } else {
        compare = mValue;
    }
    lockAfterUsing(order); // handle the release part of the memory order
} 
```

# c# - 反序列化以数字开头的 json 对象时出错

> ID：13941138
> 
> 赞同：0
> 
> 时间：2012-12-18T20:40:19.783
> 
> 标签：c#, json.net, getresponsestream

我正在从服务调用中获取一个 json 字符串，但尝试使用 json.net 解析它时出错。这是我的服务电话：

```
var request = (HttpWebRequest)WebRequest.Create(url);
var response = (HttpWebResponse)request.GetResponse();
using (var sr = new StreamReader(response.GetResponseStream()))
{
   var json = sr.ReadToEnd();
   var address = JsonConvert.DeserializeObject<Address>(json);
} 
```

json 变量填充了“奇怪”的 json 结果：

```
88
{"url":"http:\/\/www.google.com\/login?id=123&ref="}8|10
_srvtime1355861894 
```

所以反序列化给了我以下错误：

```
Error converting value 88 to type 'NameSpace.ClassName+Address'. Path '', line 1, position 2. 
```

您是否知道如何反序列化这种 json 对象，或者至少如何指示我的 WebRequest 不返回这些数字（我猜它们来自分块传输）？

如何处理返回到 json 对象的 url 中的“\”？我只是用空字符串替换它吗？

# c# - Linq 是否根据实际集合类型优化执行？

> ID：13941140
> 
> 赞同：6
> 
> 时间：2012-12-18T20:40:24.157
> 
> 标签：c#, .net, linq

Linq to objects 适用于任何 IEnumerable 对象。变量

```
string[] foo = new string[] { }; 
```

和

```
var bar = new List<string>(); 
```

两者都是`IEnumerable<string>`，但如果我想知道它们每个有多少项，我可以使用`Length`数组上的`Count`属性和列表上的属性。或者我可以使用`Count`Linq 中的方法，这对两者都适用。

问题是：Linq 是否提供了某种优化，例如为每个方法实现不同的算法，根据被查询对象的实际类型调用一个或另一个？

我想象这样的事情：

```
if (obj is Array<T>)
    DoSomethingForArray(obj as Array<T>);
else if (obj is List<T>)
    DoSomethingForList(obj as List<T>);
else if (obj is Collection<T>)
    DoSomethingForCollection(obj as Collection<T>);
else
   DoSomethingThatWorksForAnyIEnumerable(obj); 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-18T20:42:44.983

答案是：视情况而定——Linq 扩展方法`Count()`检查该类型是否实现`ICollection<T>`或`ICollection`使用该类型的`Count`属性（如果可能），但它并未针对每种可能的情况进行优化。

# android - 在android中处理大量图像

> ID：13941151
> 
> 赞同：0
> 
> 时间：2012-12-18T20:41:12.800
> 
> 标签：android, memory-management, bitmap, storage, android-viewpager

我正在将 MySQL 数据库中的大约 200 张图像加载到我的 android 应用程序中。当我尝试将它们全部存储在 Bitmaps 和 Bitmaps 的 ArrayLists 中时，我很快就会遇到内存不足的异常。

我想知道存储这些图像的最佳方式是什么。我可以将它们全部保存在 sd 卡上，并且只将它们的路径保存在我的应用程序中。

但我还需要始终在 ViewPager 的页面中显示这些图像（每页显示大约 8 个图像）。如果我用来自资源的图像填充 ViewPager，Android 和 ViewPager 会自行管理内存问题（它会在内存不足时从 RAM 中删除未显示的图像，并在您滚动回它们时将它们加载回来）

如何在不耗尽内存的情况下管理存储这么多图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:48:05.517

由于可用内存有限，您将无法直接引用每个图像，否则就像您说的那样，您将耗尽内存。只要有对`BitMap`对象的引用，这些图像就会占用内存空间。要释放此内存，您需要取消引用这些`BitMaps`和/或清除`ArrayList`，这将允许垃圾收集器释放未使用的内存。理想情况下，您只需要参考您可以看到的图像，或者您接下来会看到的图像。

您可以只查找每个页面视图的 8 个图像，或者可能是周围页面视图中的图像。如果您显示的图像比它们占用的尺寸大得多，那么您可能需要动态调整这些图像的大小，并且只将它们存储为它们显示的大小，这也应该有助于减少图像的内存占用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T22:57:27.403

Android 开发人员就这个主题编写了一系列教程：http: [//developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)

# iphone - 将 iOS 游戏嵌入另一个 iOS 应用程序

> ID：13941152
> 
> 赞同：-2
> 
> 时间：2012-12-18T20:41:12.860
> 
> 标签：iphone, ios, embed

我有一个主应用程序，它将充当游戏的门户（例如 Kongregate）。当您选择游戏时，游戏就会加载（无需任何额外下载，只需按需预加载）。

我想让我的游戏与主应用程序分开，然后将它们嵌入到主项目中，这样我就可以使用 StencylWorks（或只是在另一个单独的项目中）和我在 xCode 中的主应用程序制作游戏。

实现这一目标的最佳方法是什么？（我认为我最想做的是将其他 SWF 嵌入到 adobe air 应用程序中）。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:44:05.427

您编写每个游戏并在按下按钮时“开始”它们。它们必须是应用程序包本身的一部分。

您不能执行外部编译代码，例如`.swf`.

# javascript - 意外的 childNodes 行为

> ID：13941157
> 
> 赞同：0
> 
> 时间：2012-12-18T20:41:48.977
> 
> 标签：javascript, html, dom, dom-traversal, textnode

我设置了一些简单的 HTML 和 JS 代码，以便更好地处理遍历 DOM。

这是我的 HTML：

```
<!DOCTYPE html>
<html>
  <head>
    <title>Sandbox</title>
  </head>
  <body>
    <div>
      <h1 id="title">Sandbox</h1>
      <button id="clickMe" onclick="playingAroundWithNodes()">Play with nodes!</button>
    </div>
  </body>
  <script type="text/javascript" src="Sandbox3.js"></script>
</html> 
```

这是我的 JavaScript：

```
function playingAroundWithNodes() {

    //Getting a reference to some nodes!

    var theHtmlNode = document.childNodes[1];
    var theHeadNode = theHtmlNode.childNodes[0];
    var theBodyNode = theHtmlNode.childNodes[1];

    //Let's check out those nodes!

    console.log("theHtmlNode is a " + theHtmlNode.nodeName + " type node.");
    console.log("theHeadNode is a " + theHeadNode.nodeName + " type node.");
    console.log("theBodyNode is a " + theBodyNode.nodeName + " type node.");

} 
```

这是我得到的控制台日志：

```
theHtmlNode is a HTML type node.
theHeadNode is a HEAD type node. 
theBodyNode is a #text type node. 
```

是什么赋予了？那个文本节点到底在哪里，那不是标题节点吗？我很困惑并且已经玩了一堆（并且发现根据js，body节点实际上是HEAD的第三个孩子，但是查看对我来说没有意义的HTML）。我可以看到它是第三个后代或其他东西，但我认为孩子意味着直接孩子......任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:48:21.147

首先，你认为我有新意。我根本没有意识到`document`有一个`childNodes`属性（通常根元素（html）是通过访问的`document.documentElement`）。

至于文本节点，这些将取决于您如何格式化 HTML 文件。上面出现的文本节点可能是一个返回字符或在 close`</head>`和 opening之间的几个空格`<body>`。

您可能正在寻找的是 (最初是非标准的，但现在最近[提出了标准化](http://www.w3.org/TR/domcore/#dom-element-children)) `element.children`。[John Resig 有一个很好的概述](http://ejohn.org/blog/element-traversal-api/)。

因此，如果您按如下方式修改上述代码，您将得到您所期望的：

```
var theHeadNode = theHtmlNode.children[0];
var theBodyNode = theHtmlNode.children[1]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:06:16.673

IE 是唯一一个行为与您预期一样的浏览器。所有其他浏览器都实现了该标准，并且该标准规定空格也必须是 DOM 的一部分。

因此，对于看起来像这样的 HTML：

```
<html>
    <body>
        <div>Hello</div>
    </body>
</html> 
```

IE 将创建这个 DOM：

```
html +
     |____ body +
                |____ div +
                          |____ text("Hello") 
```

但是所有其他浏览器都会创建这个 DOM

```
html +
     |____ text("\n    ")
     |
     |____ body +
     |          |____ text("\n        ")
     |          |
     |          |____ div +
     |          |         |____ text("Hello")
     |          |
     |          |____ text("\n        ")
     |
     |____ text("\n    ") 
```

我不确定你是如何得到结果的，因为之前和之后应该有文本节点`<html>`。

无论如何，答案是因为标准要求它。所以不要盲目地使用硬编码索引来遍历 childNode，因为像 minifiers 这样的东西可能会因为空白而改变 DOM。循环遍历所有子节点并在找到所需节点后停止，或使用 getElementsByTagName。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T05:20:17.727

@mcabrams：除了@slebatman 提到的，如果你想直接访问正文名称，只需使用：

```
var bodyNode = document.body;  //it returns a refrence to the body node 
```

希望有帮助。

# php - 带有codeigniter的jpegcam

> ID：13941158
> 
> 赞同：0
> 
> 时间：2012-12-18T20:41:56.790
> 
> 标签：php, javascript, codeigniter

`<script language="JavaScript"> webcam.set_api_url( 'test.php' ); webcam.set_quality( 90 ); // JPEG quality (1 - 100) webcam.set_shutter_sound( true ); // play shutter click sound </script>`

我在我的网站上尝试 jpegcam（我使用 codeigniter）。我无法加载我的 webcam.swf 或 webcam.php 或 test.php。我如何在 javascript 中访问 php 在 codeigniter 中锁定这个？

当我刷新我的网站时，那里无事可做，但是当我尝试 jpegcam（没有 codeigniter）时，它运行良好。对不起我的愚蠢问题，我是codeigniter的新手，

```
<table><tr><td valign=top>
<h1>JPEGCam Test Page</h1>

<!-- First, include the JPEGCam JavaScript Library -->
<script type="text/javascript" src="webcam.js"></script>

<!-- Configure a few settings -->
<script language="JavaScript">
    webcam.set_api_url( 'test.php' );
    webcam.set_quality( 90 ); // JPEG quality (1 - 100)
    webcam.set_shutter_sound( true ); // play shutter click sound
</script>

<!-- Next, write the movie to the page at 320x240 -->
<script language="JavaScript">
    document.write( webcam.get_html(320, 240) );
</script>

<!-- Some buttons for controlling things -->
<br/><form>
    <input type=button value="Configure..." onClick="webcam.configure()">
    &nbsp;&nbsp;&nbsp;
    <input type=button value="Take Snapshot" onClick="webcam.snap()">
</form>

<!-- Code to handle the server response (see test.php) -->
<script language="JavaScript">
    webcam.set_hook( 'onComplete', 'my_completion_handler' );

    function my_completion_handler(msg) {
        // extract URL out of PHP output
        if (msg.match(/(http\:\/\/\S+)/)) {
            var image_url = RegExp.$1;
            // show JPEG image in page
            document.getElementById('upload_results').innerHTML = 
                '<h1>Upload Successful!</h1>' + 
                '<img src="'+image_url+'">';
        }
        else alert("PHP Error: " + msg);
    }
</script>

</td><td width=50>&nbsp;</td><td valign=top>
    <div id="upload_results"></div>
</td></tr></table> 
```

请帮助我，非常感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T03:42:08.143

Use the base_url function of the URL Helper ([http://ellislab.com/codeigniter/user-guide/helpers/url_helper.html](http://ellislab.com/codeigniter/user-guide/helpers/url_helper.html)) to load your assets file and controller.

For example:

```
echo base_url("path/to/webcam.swf");
echo base_url("path/to/webcamuploadhandler/controller"); 
```

I think you also need to set the `set_shutter_sound` to load the appropriate .mp3 file, something like this in your view file:

```
webcam.set_shutter_sound(true, "<?php echo base_url("path/to/shutter.mp3"); ?>"); 
```

Furthermore, since you use a framework, I guess you have to set response Content-type of the `webcamuploadhandler/controller` as `"text/plain"`. There is an issue I experienced lately: [http://code.google.com/p/jpegcam/issues/detail?id=15](http://code.google.com/p/jpegcam/issues/detail?id=15)

# php - PHP 代码适用于 Chrome，但不适用于 IE

> ID：13941159
> 
> 赞同：-2
> 
> 时间：2012-12-18T20:42:01.673
> 
> 标签：php, html, forms

此处的代码在 Chrome 中有效，其中数据库列表显示在下拉框中，但是在 IE 中它只是列出而不在下拉框中：

```
if (!$result)
{
/*echo $query;*/
$message = 'ERROR: ' . sqlsrv_errors();
return $message;
}
else
{ 
$i = 0;
echo '<html><body><table><tr><td>&nbsp;Forte ID:&nbsp;&nbsp;&nbsp;</td></tr><select id="ForteID" name="ForteID"><table width="150"><tr>';
while ($i < sqlsrv_num_rows($result))
{
    $meta = sqlsrv_fetch($result, $i);
    echo '<td>' . $meta->name . '</td>';
    $i = $i + 1;
}
echo '';

while ( $row = sqlsrv_fetch_array( $result, SQLSRV_FETCH_ASSOC ))
{
    $count = count($row);
    $y = 0;
    echo '<tr><option>';
    while ($y < $count)
    {
        $c_row = current($row);
        echo '<td>' . $c_row . '</td>';
        next($row);
        $y = $y + 1;
    }
    echo '</option></tr>';
}
sqlsrv_free_stmt ($result);

echo '</table></select></body></html>';
}
sqlsrv_close( $connection);
?> 
```

让我知道是否需要更好地描述。提前致谢！

编辑：

这就是我现在所拥有的：

```
<?php
$serverName = 'localhost\SQLEXPRESS';
$connectionInfo = array('Database'=>'database', 'UID'=>'username', 'PWD'=>'password','ReturnDatesAsStrings'=>true,);
$connection = sqlsrv_connect($serverName, $connectionInfo);

$query = '  SELECT Column1
        FROM database.dbo.Reps 
        ORDER By Column1';
$result = sqlsrv_query($connection,$query);

// Move the data to a simple array to simplify presentation code.
$resultAsArray = array(); 
while ( $row = sqlsrv_fetch_array( $result, SQLSRV_FETCH_ASSOC )) {
$resultAsArray []= $row;
}
?>

<form method="get" action="getlog.php">
<select>
<?php foreach ($resultAsArray as $row): ?>
<option value="<?php= $row['Column1'] ?>"><?php= $row['Column1'] ?></option>
<?php endforeach; ?>
</select>
<input type="submit" name="getLog" value="Get Log">
</form>
</html> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:56:03.880

正如第一条评论所述，不应期望在 select 中嵌套表。我假设您只是想将数据库查询的内容放入选择中。为此，您只需要`<select>`和`<option>`标签。此外，为了帮助您的代码更具可读性（和可维护性！），请将您的代码分成两部分，即数据库访问和演示。我不使用 sqlsrv 库，所以我将只使用伪代码进行数据库访问。

```
<?php
$resultSet = db_call_to_load_the_data();

// Move the data to a simple array to simplify presentation code.
$resultAsArray = array(); 
while ($row = $resultSet->getNextRow()) {
    $resultAsArray []= $row;
} 
```

然后显示它...

```
<select>
<?php foreach ($resultAsArray as $row): ?>
    <option value="<?= $row['value_column'] ?>"><?= $row['display_value_column'] ?></option>
<?php endforeach; ?>
</select> 
```

我想这就是你要找的。如果我把事情简单化了，我很抱歉。

# asp.net - 使用“使用本地 IIS Web 服务器”时出现 Microsoft JScript 运行时错误

> ID：13941162
> 
> 赞同：5
> 
> 时间：2012-12-18T20:42:10.210
> 
> 标签：asp.net, visual-studio-2012, crash, jscript

一切正常，直到 Microsoft 论坛中的某个人在命令提示符模式下尝试了几个 devenv 开关：devenv /Resetsettings 和 Run devenv /ResetSkipPkgs.提示一个不相关的问题，即我无法通过单击保存来保存 aspx 文件按钮。从那以后，我遇到了一个新问题。

我尝试卸载VS2012，重新启动并重新安装无济于事。

问题是我在使用“使用本地 IIS Web 服务器”设置时收到 Microsoft JScript 运行时错误。IIS 找不到在它加载的文件中定义的变量。当我使用“使用 Visual Studio 开发服务器”选项运行时，它可以工作。

为什么会这样，我怎样才能让“使用本地 IIS Web 服务器”再次工作。

2张图片显示问题。 ![实际错误信息](../Images/557edda051f01242a9437c50c527fbc8.png) ![显示文件的实际代码和解决方案资源管理器](../Images/a3dea14aa707ce311130804347ce908c.png)

（我昨天上传了图片，不知道发生了什么。）

我不知道该怎么解决这个问题。我在另一个论坛上看到了另一个关于类似问题的帖子。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-11T06:55:46.797

0x800a1391 错误代码是由 Windows 操作系统中配置错误的系统文件以一种或另一种方式引起的。

0x800a1391错误可能是windows系统文件损坏引起的。可能有许多事件可能导致系统文件错误。不完整的安装、不完整的卸载、应用程序或硬件的不当删除。

我真诚地说，您应该将计算机恢复到使用 devenv 开关之前的较早时间。他们什么也没做，只是破坏了您的系统文件并在内部创建了一个错误，以阻止程序检索数据以执行 javascript 代码。

[http://www.wiki-errors.com/wiki-errors.php?wiki=0x800a1391](http://www.wiki-errors.com/wiki-errors.php?wiki=0x800a1391) 您可以随时访问此 wiki 文章下载错误检测工具，帮助您协助纠错

# wcf - 私钥访问错误

> ID：13941165
> 
> 赞同：0
> 
> 时间：2012-12-18T20:42:29.070
> 
> 标签：wcf, x509certificate

我正在尝试基于证书制作具有安全性的 WCF Web 服务。在服务器上我有一个带有私钥的证书，在客户端上有一个带有公钥的证书。当我尝试运行客户端时，我收到一条错误消息，提示“进程必须具有私钥的访问权限”不，我的问题是，这是服务器错误还是导致客户端必须拥有带有私钥的证书。

谢谢

# ios - 带有自己的 Nib 和 UITableViewCell 子类的 TableViewCell 设计

> ID：13941167
> 
> 赞同：0
> 
> 时间：2012-12-18T20:42:36.713
> 
> 标签：ios, uitableview

我已经分类`UITableViewCell`为`MyCell`并试图让表格显示。我总是收到消息：

`exception 'NSInternalInconsistencyException', reason: 'UITableView dataSource must return a cell from tableView:cellForRowAtIndexPath:`

的代码`tableView:cellForRowAtIndexPath`如下：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"Cell";
MyCell* cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
// Configure the cell...
MyCell* theCell = (MyCell *)cell;
UILabel* lab = theCell.theLabel;
lab.text = @"This is the label text";
return cell;
} 
```

我已在笔尖中将 CellIdentifier 设置为“Cell”。我以为我要返回一个带有最后一行的单元格？我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:52:39.433

您的单元格必须为零。你应该像白色一样：

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";
    MyCell* cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (!cell) {
        cell = [[NSBundle mainBundle] loadNibNamed:@"MyCell"].lastObject;
    }
    // Configure the cell...
    UILabel* lab = cell.theLabel;
    lab.text = @"This is the label text";
    return cell;
} 
```

# javascript - Rails 3 PaperClip NoHandlerError

> ID：13941170
> 
> 赞同：0
> 
> 时间：2012-12-18T20:42:46.090
> 
> 标签：javascript, ruby-on-rails-3, file-upload, paperclip

我正在使用回形针来管理个人资料图片上传和 css/js 的 jasny 引导程序。我可以上传个人资料图片并提交我的表单，而无需选择文件，没有任何问题。但是，当我选择一个文件并在提交表单之前将其删除时生成 NoHandlerError 时。

我对 javascript 不是很熟悉，但看起来这是正在生成的，因为 clear 函数有效地选择了一个名为“”（设置：avatar =>“”）的文件，而不是将其留空。

我的目标是能够选择一个文件，然后将其删除并能够提交表单。

提前非常感谢您的帮助。

**用户.rb**

```
class User < ActiveRecord::Base
  has_attached_file :avatar, styles: { :default => "x150>", :thumbnail => "100x100>" },
                        default_url: '/assets/missing_avatar.png'
end 
```

**_avatar.html.erb**

```
<div class="fileupload fileupload-new" data-provides="fileupload">
  <div class="fileupload-preview thumbnail" style="width: 200px; height: 150px;"></div>
  <div>
    <span class="btn btn-file"><%= f.file_field :avatar %>
      <span class="fileupload-new">Select image</span>
      <span class="fileupload-exists">Change</span>
      <input type="file" />
    </span>
    <a href="#" class="btn fileupload-exists" data-dismiss="fileupload">Remove</a>
  </div>
</div> 
```

**bootstrap.file-upload.js**

```
!function ($) {

  "use strict"; // jshint ;_

  var Fileupload = function (element, options) {
    this.$element = $(element)
    this.type = this.$element.data('uploadtype') ||     (this.$element.find('.thumbnail').length > 0 ? "image" : "file")

    this.$input = this.$element.find(':file')
    if (this.$input.length === 0) return

    this.name = this.$input.attr('name') || options.name

    this.$hidden = this.$element.find(':hidden[name="'+this.name+'"]')
    if (this.$hidden.length === 0) {
      this.$hidden = $('<input type="hidden" />')
      this.$element.prepend(this.$hidden)
    }

    this.$preview = this.$element.find('.fileupload-preview')
    var height = this.$preview.css('height')
    if (this.$preview.css('display') != 'inline' && height != '0px' && height != 'none')     this.$preview.css('line-height', height)

    this.$remove = this.$element.find('[data-dismiss="fileupload"]')

    this.$element.find('[data-trigger="fileupload"]').on('click.fileupload',     $.proxy(this.trigger, this))

    this.listen()
  }

  Fileupload.prototype = {

    listen: function() {
      this.$input.on('change.fileupload', $.proxy(this.change, this))
      if (this.$remove) this.$remove.on('click.fileupload', $.proxy(this.clear, this))
    },

    change: function(e, invoked) {
      var file = e.target.files !== undefined ? e.target.files[0] : (e.target.value ? { name: e.target.value.replace(/^.+\\/, '') } : null)
      if (invoked === 'clear') return

      if (!file) {
        this.clear()
        return
      }

      this.$hidden.val('')
      this.$hidden.attr('name', '')
      this.$input.attr('name', this.name)

      if (this.type === "image" && this.$preview.length > 0 && (typeof file.type !==     "undefined" ? file.type.match('image.*') : file.name.match('\\.(gif|png|jpe?g)$')) && typeof FileReader !== "undefined") {
        var reader = new FileReader()
        var preview = this.$preview
        var element = this.$element

        reader.onload = function(e) {
      preview.html('<img src="' + e.target.result + '" ' + (preview.css('max-height') != 'none' ? 'style="max-height: ' + preview.css('max-height') + ';"' : '') + ' />')
      element.addClass('fileupload-exists').removeClass('fileupload-new')
    }

        reader.readAsDataURL(file)
      } else {
        this.$preview.text(file.name)
        this.$element.addClass('fileupload-exists').removeClass('fileupload-new')
      }
    },

    clear: function(e) {
      this.$hidden.val('')
      this.$hidden.attr('name', this.name)
      this.$input.attr('name', '')
      this.$input.val('') // Doesn't work in IE, which causes issues when selecting the same file twice

      this.$preview.html('')
      this.$element.addClass('fileupload-new').removeClass('fileupload-exists')

      if (e) {
        this.$input.trigger('change', [ 'clear' ])
        e.preventDefault()
      }
    },

    trigger: function(e) {
      this.$input.trigger('click')
      e.preventDefault()
    }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-25T04:37:37.390

我不知道解决这个问题的正确方法，但它有效:)

**在控制器中**

```
def update
  @user = User.find(params[:id])
  respond_to do |format|
      validate_avatar
      if @user.update_attributes(params[:usuario])
        sign_in @usuario
        format.html { redirect_to @user }
      else
        format.html { render action: "edit" }
      end
  end
end 
```

只需添加此功能

```
def validate_avatar
  params[:user].delete 'avatar' if params[:user]['avatar'] = ""
end 
```

# java - 文件上传后Struts2文件复制到不同的文件夹？

> ID：13941171
> 
> 赞同：0
> 
> 时间：2012-12-18T20:42:55.203
> 
> 标签：java, struts2

我正在通过 struts2 文件上传拦截器上传用户个人资料图片。上传图片后，我想将其保存在 webapp/upload/images 文件夹下的 webapp 中。我使用以下代码来执行此操作。

```
public String uploadPhoto() {
    try {
        String filePath = servletRequest.getContextPath() + "/uploads/images";
        System.out.println("Server path:" + filePath);
        File fileToCreate = new File(filePath, this.userImageFileName);

        FileUtils.copyFile(this.userImage, fileToCreate);
    } catch (Exception e) {
        e.printStackTrace();
        addActionError(e.getMessage());

        return INPUT;
    }
    return SUCCESS;
} 
```

但我收到以下错误

```
Server path:/picvik/uploads/images
java.io.IOException: Destination '/picvik/uploads/images/one.jpg' directory cannot be created
    at org.apache.commons.io.FileUtils.copyFile(FileUtils.java:777)
    at org.apache.commons.io.FileUtils.copyFile(FileUtils.java:731)
    at com.picvik.action.ChangePhotoAction.uploadPhoto(ChangePhotoAction.java:28) 
```

请纠正我做错了什么。以及如何实现这一点。我基本上想将所有用户的个人资料图片保存在我的 webapp 下：webapp/uploads/images。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:04:47.900

这很简单，你不能使用相对路径创建文件，你应该使用它的真实路径：

```
String filePath = servletRequest.getContextPath().getRealPath("/uploads/images"); 
```

那应该没问题。

# javascript - 尽管保留了脚本，但解析 html 会破坏与 javascript 相关的项目

> ID：13941180
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:43:20.460
> 
> 标签：javascript, html, google-chrome-extension

所以，我有一个脚本，它采用 body 的 innerHTML（是的，body 标记中的所有内容），将所有阿拉伯数字 (123) 转换为阿拉伯-印度数字 (١٢٣)，并用更改后的替换 innerHTML。现在，解析器完美运行，只更改用户在页面上可见的数字，并避免标签属性中的数字，并保留“敏感”标签内的内容（如脚本、样式、noscript ...）不变（使用我正在解决的一些问题），就像我想要的那样！（顺便说一下，这是在chrome扩展中运行的，脚本在触发onLoad事件时运行）

但是由于某种原因，有些事情会停止正常运行。例如，对堆栈溢出进行随机问题；向上/向下投票按钮停止工作。我什至继续比较原始和未解析的 html：

[http://www.diffchecker.com/gJE1v50f](http://www.diffchecker.com/gJE1v50f)

那里一切看起来都很好；唯一的区别是数字，虽然一些对用户可见的链接（例如，格式帮助部分中的一个）被改变了，但我计划修复它，它对脚本没有影响，所以我忽略了它们目前。

感谢您花时间阅读，更感谢您的回答:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:21:24.930

如上面评论中所述，替换页面正文中的 html 会导致生成所有新的（尽管与原始元素相同）元素，这会导致附加到它们的所有事件被丢弃。您要做的是遍历正文中的所有文本节点。使用 xpath 最容易做到这一点：

```
xpath = new XPathEvaluator()
xpath.evaluate("//text()", document.body) 
```

这将返回当前文档正文中所有文本节点的数组。然后，您可以遍历它们并修改它们的每个内容。

另一个问题是，这可能仍然会破坏从您正在修改的文本节点中解析数字的脚本。我能想到的唯一解决方案（是的，它非常hackish）是扩展`Number`函数的行为：

```
(function (){
  var oldNumber = Number
  window.Number = function(obj){
    if(typeof obj == "string"){
      // replace numerals
      var numerals = ["٠","١","٢","٣","٤","٥","٦","٧","٨","٩"]
      for(idx in numerals){
        obj = obj.replace(new RegExp(numerals[idx],"g"), idx)
      }
      // replace decimal point
      obj.replace(/٫/g,".")
    }
    return oldNumber(obj)
  }
})() 
```

您还必须扩展 parseInt 和 parseFloat 函数以使一切正常，尽管代码几乎相同。这将使从 html 中解析数字的脚本不会中断；但请注意，当它们将数字显示回网页时，它们将是普通的阿拉伯数字。要解决这个问题，您可以扩展 Number 的`toString`方法，但这可能比扩展相对安全的数字解析函数更危险。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:14:00.460

我建议获取文本节点并直接修改它们：http: [//jsfiddle.net/6pLeR/](http://jsfiddle.net/6pLeR/)

```
// this will get all text nodes that are descendant of element. 
function getTextNodes(element) {
    var nodes = [],
        children = element.childNodes,
        i=0, child = children[0];

    for (; i < children.length; i++, child=children[i]) {
        if (child.nodeType === 3) nodes.push(child);
        else nodes = nodes.concat(getTextNodes(child));
    }

    return nodes;
}

var nodes = getTextNodes(document.body); // get all text nodes in the body.

for (var i = 0; i < nodes.length; i++) {
    var node = nodes[i];

    node.data = node.data.replace(/text/g, "banana"); // replace "text" with "banana"
}​ 
```

在demo中可以看到点击事件不受节点数据变化的影响。

# asp.net - 评估绑定字段上的数据字段以相应地显示文本

> ID：13941184
> 
> 赞同：4
> 
> 时间：2012-12-18T20:43:35.280
> 
> 标签：asp.net, gridview, boundfield

大家好，如何根据数据字段的值在绑定字段中显示不同的字符串？

例如，如果 datafield 的值为 1，它应该显示“Pending”。如果为 2，则“已删除”。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:05:52.350

您可以使用服务器端功能来显示条件值。

看看这个样本：

```
 <asp:TemplateField ItemStyle-CssClass="TemplateFieldOneColumn">
            <ItemTemplate>
                <asp:Label runat="server" Text='<% #GetLabelText(Eval("status")) %>' />
            </ItemTemplate>
         </asp:TemplateField> 
```

这是在托管页面上声明的服务器端函数：

```
 public string GetLabelText(object dataItem)
    {
        string text = "";
        int? val = dataItem as int?;
        switch (val)
        {
            case 1:
                text = "Pending";
                break;
            case 2:
                text = "Deleted";
                break;

        }
        return text;
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:54:37.757

使用 TemplateField，而不是 BoundField。然后为 RowDataBound 向 GridView 添加一个事件。在调用的方法中，您将评估您的值（在下面的示例中存储在隐藏字段中）并输出适当的文本（在示例中为 Label）。

这是一些入门代码。

```
<ItemTemplate>
  <asp:HiddenField ID="hdnStatus" runat="server" Value='<%# Bind("status") %>' />
  <asp:Label ID="lblStatus" runat="server" />
</ItemTemplate> 
```

使用它，并对使用 RowDataBound 事件进行一些研究。如果您遇到问题，请使用您编写的代码以及您遇到问题的方式更新您的问题。我很乐意提供更多帮助。

研究很重要，这对您在该领域建立技能非常有益。有人问很好，但有时你只能依靠自己。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-11-12T12:12:11.177

对于布尔值，您可以这样做：

```
<asp:Label ID="Label1" runat="server" Text='<%# Boolean.Parse(Eval("Status").ToString()) ? "Yes" : "No" %>'></asp:Label> 
```

你也可以为其他类型做。
希望这会帮助你。

# objective-c - insertObject:atIndex: over replaceObjectAtIndex:withObject: 在 NSMutableArray 上有什么好处

> ID：13941187
> 
> 赞同：-3
> 
> 时间：2012-12-18T20:43:47.957
> 
> 标签：objective-c, cocoa, nsmutablearray, automatic-ref-counting

当用 NSMutableArray 中的新值替换某个索引处的值时，旧值保存在内存中。要解决的问题是在每个循环之前初始化一个新的 NSMutableArray。

重现步骤：

```
- (id) init{
    self.overlays = [[NSMutableArray alloc] initWithCapacity: [self.anotherArray count]];
}

- (void) someOtherMethod{
    for(int i = 0 ; i < self.anotherArray ; i++){
        UIView *view = [[UIView alloc] initWithFrame:CGRectMake(x, y, width, height)];
        [view setBackgroundColor:[UIColor colorWithRed:0 
                                                green:0 
                                                 blue:0 
                                                alpha:1]];
        [view setAlpha: .2];
        [self.overlays insertObject:view atIndex: i]
    }
}

- (void) main{
    for(int i = 0 ; i < 4 ; i++){
        [myObject someOtherMethod];
    }
} 
```

insertObject:atIndex 实际上会导致内存泄漏，因为它不会释放数组中该索引处的旧值。

我提交了一份错误报告，Apple 回复：

insertObject:atIndex: 的行为符合定义。它正在插入，而不是替换。如果你想替换，你应该使用 -replaceObjectAtIndex:withObject:

insertObject:atIndex: 怎么可能有任何好处，因为您总是会丢失对该索引处旧对象的引用。

这仅仅是为了避免解决问题，因为它符合旧的文档定义吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T20:52:16.140

这两种方法做不同的事情。想象一下以下数组：

```
NSMutableArray *anArray = [@[ @1, @2, @3 ] mutableCopy]; 
```

如果在 position*插入*一个元素`1`，如下所示：

```
[anArray insertObject:@4 atIndex:1]; 
```

数组变得等​​于`@[ @1, @4, @2, @3 ]`。插入新元素而不删除另一个元素。

相反，如果您*替换*position 处的元素`1`，如下所示：

```
[anArray replaceObjectAtIndex:1 withObject:@4]; 
```

你得到`@[ @1, @4, @3 ]`. 该位置的前一个对象被删除。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:51:40.267

`insertObject:atIndex`正如您已经指出的那样，不会删除旧项目。相反，它会在您指定的索引处插入新项目。调用此方法后，数组的元素计数加 1。

这与 不同`replaceObjectAtIndex:withOjbect`，后者是替代品。数组的元素计数保持不变。

Insert 正是这样做的。考虑一个包含 5 个元素的数组：如果您调用`[myArray insertObject:insertedObj atIndex:1];`， myArray 实例现在有 6 个元素，并`insertedObj`在第一个索引处插入。

# android - “强制停止”在其生命周期中将 Activity 留在何处？

> ID：13941193
> 
> 赞同：4
> 
> 时间：2012-12-18T20:44:08.730
> 
> 标签：android, android-activity, lifecycle

假设我的应用程序已启动并正在运行。然后我转到我的设备主屏幕。导航到**设置>>应用程序>>管理**应用程序，选择我的应用程序，然后按`Force stop`。

`Activity`下次打开应用程序时会调用哪个方法？在我因不检查自己而受到攻击之前，我的,和方法`Log`中有许多语句，但实际上在重新打开应用程序时它们都没有显示。`onCreate``onStart``onResume``LogCat`

如果您知道`Force stop`我的应用程序所处状态的答案，但缺少的`Log`陈述没有意义，请分享。`Force stop`我认为除了我错过了我的程序放置在哪里之外，可能还有一个不同的问题。

Android 活动生命周期： ![在此处输入图像描述](../Images/c994d86ba3eaa04b8ca172a9ac3d79ee.png)

onCreate()

```
public void onCreate(Bundle savedInstanceState) {
    Log.i( TAG, "Whats going onnnn0" );
    // This calls all inherited methods, as this is a subclass of Activity.
    super.onCreate(savedInstanceState);
    if(D) Log.e(TAG, "+++ ON CREATE +++");
    Log.i( TAG, "Whats going onnnn" );

    // Set the view the main.xml
    setContentView(R.layout.main);
    RelayAPIModel.bluetoothConnected = false;
    // Initialize the connection.
    setupConnection();
    Log.i( TAG, "Whats going onnnn2" );

    // Check how if bluetooth is enabled on this device.
    mService.checkBluetoothState();
    // Initialize stuff from PilotMain() method
    initMain();
    Log.i( TAG, "Whats going onnnn3" );
    // Add listeners to all of the buttons described in main.xml
    buildButtons();
    Log.i( "HERE", "HERE" );
    // If the adapter is null, then Bluetooth is not supported
    if (mService.getAdapter() == null) {
        Toast.makeText(this, R.string.toast_bt_not_avail, Toast.LENGTH_LONG).show();
        finish();
        return;
    }
    savedStuff = (SerializableObjects)LocalObjects.readObjectFromFile( getApplicationContext(), "LastDevice.txt" );
    if( savedStuff != null ) {
        hasLastDevice = true;
        Log.i( "HAS", "LAST DEVICE" );
        Log.i( "HAS", savedStuff.getName() );
    } else {
        hasLastDevice = false;
        Log.i( "HAS NO", "LAST DEVICE" );
    }

    pairedDeviceList = new ArrayList<BluetoothDevice>();
    pairedDevices = mService.getAdapter().getBondedDevices();

    for( BluetoothDevice device: pairedDevices ) {
        pairedDeviceList.add( device );
    }
    if( hasLastDevice ) {
        for( int i = 0; i < pairedDeviceList.size(); i++ ) {
            Log.i( "1 HERE HERE", pairedDeviceList.get( i ).getName() );
            Log.i( "1 HEUH?I@JD", savedStuff.getName() );
            if( pairedDeviceList.get( i ).getName().equals( savedStuff.getRealName() ) ) {
                // THIS IS THE DEVICE WE NEED
                previousDevice = pairedDeviceList.get( i );
                i = pairedDeviceList.size();
            }
        }
    }

} 
```

开始（）

```
public void onStart() {
    super.onStart();
    if(D) Log.e(TAG, "++ ON START ++");

    savedStuff = (SerializableObjects)LocalObjects.readObjectFromFile( getApplicationContext(), "LastDevice.txt" );
    if( savedStuff != null ) {
        hasLastDevice = true;
        Log.i( "HAS", "LAST DEVICE" );
        Log.i( "HAS", savedStuff.getName() );
    } else {
        hasLastDevice = false;
        Log.i( "HAS NO", "LAST DEVICE" );
    }

    pairedDeviceList = new ArrayList<BluetoothDevice>();
    pairedDevices = mService.getAdapter().getBondedDevices();

    for( BluetoothDevice device: pairedDevices ) {
        pairedDeviceList.add( device );
    }
    if( hasLastDevice ) {
        for( int i = 0; i < pairedDeviceList.size(); i++ ) {
            Log.i( "2 HERE HERE", pairedDeviceList.get( i ).getName() );
            Log.i( "2 HEUH?I@JD", savedStuff.getName() );
            if( pairedDeviceList.get( i ).getName().equals( savedStuff.getRealName() ) ) {
                // THIS IS THE DEVICE WE NEED
                previousDevice = pairedDeviceList.get( i );
                i = pairedDeviceList.size();
            }
        }
    }

    // If BT is not on, request that it be enabled.
    // setupChat() will then be called during onActivityResult
    if (!mService.getAdapter().isEnabled()) {
        Log.i( TAG, "first !isEnabled " );
        Intent enableIntent = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableIntent, REQUEST_ENABLE_BT);
        Log.i( TAG, "second !isEnabled" );
    // Otherwise, setup the connection
    } else {
        if (mService == null) {
            Log.i( TAG, "setupConnection BEFORE" );
            setupConnection();
            Log.i( TAG, "setupConnection AFTER" );
        }
    }
} 
```

onResume()

```
public synchronized void onResume() {
    Log.i( "RESUME", "HERE" );
    super.onResume();
    if(D) Log.e(TAG, "+ ON RESUME +");

    Log.i( "RESUME", "AFTER HERE" );

    // Performing this check in onResume() covers the case in which BT was
    // not enabled during onStart(), so we were paused to enable it...
    // onResume() will be called when ACTION_REQUEST_ENABLE activity returns.
    if (mService != null) {
        // Only if the state is STATE_NONE, do we know that we haven't started already
        if (mService.getState() == BluetoothService.STATE_NONE) {
          // Start the Bluetooth chat services
          mService.start();
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T20:48:25.070

当你强行停止一个应用程序时，你会彻底杀死它，**什么也没有**。没有方法被调用，什么都没有。这与系统杀死应用程序以保留内存不同。强制关闭并不意味着甜蜜，它意味着杀死错误的应用程序，这样它就不会浪费了。

所以下次你打开你的应用程序时，它会从头开始 - MainActivity。这就是为什么强制停止“可能导致应用程序行为不端”的原因。你可能在做一些有用的事情的过程中停止了它——比如写入服务器/文件系统等。这就是为什么你应该让你的应用程序尽可能高效，或者以能够处理意外关闭的方式对其进行编码。这可能意味着远离冗长的任务并快速且经常地储蓄。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T20:54:21.747

由于强制停止旨在在您的应用程序没有响应时使用，因此它不会生成任何回调，但会删除您的进程。因此，您应该会看到与从“ActivityStart”重新启动活动一样的日志消息，因此以`onCreate()`. 至于为什么您没有看到日志记录消息，我不确定。确保您没有按 PID 过滤 logcat，因为您的新实例具有不同的 PID。

# php - a href 中的 PHP 和 MySQL 查询

> ID：13941194
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:44:08.523
> 
> 标签：php, mysql

我有一点问题要找到为什么我的查询不起作用。

我的问题是我必须使用 TID 来创建指向我正在显示的数据库条目的链接。

这是我的代码：

```
$sql = "SELECT `titulo`, `uid`, `tid`,`username` FROM `treinos` ORDER BY tid DESC limit 4";
$result = mysql_query($sql);

while($row = mysql_fetch_array($result)) {
    echo ('Titulo: <a href="treino.php?id="' . $row["tid"] . '">' .  $row['titulo'] . "</a> Usuario " . $row['usuario'] );
    echo '</br>';    
} 
```

出于某种原因，`$row['tid']`在该区域内不起作用，但在外部工作得很好，例如，如果对查询的更改`$row['titulo']`将为`$row['tid']`我提供信息。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:51:51.360

你有一个流氓`"`在你的`href`。删除`"`后`id=`。

```
echo ('Titulo: <a href="treino.php?id=' . $row["tid"] . '">' .  $row['titulo'] . "</a> Usuario " . $row['usuario'] ); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T20:52:35.080

错误在于`id="`. `href`在打印 id 之前关闭。所以改成：

`echo ('Titulo: <a href="treino.php?id=' . $row["tid"] . '">' . $row['titulo'] . "</a> Usuario " . $row['usuario'] );`

# c++ - 从子继承的不同基类调用基类方法

> ID：13941199
> 
> 赞同：0
> 
> 时间：2012-12-18T20:44:27.883
> 
> 标签：c++, inheritance, base-class

```
class A {
 void methodToCall() {};
}

class B {
 B() {
   subscribeToEvent();
 }
 void eventHandler(Event* E) {
   call A::methodToCall()
 }
}

class C : public A, public B{
} 
```

这似乎是一种罕见的情况，所以让我解释一下我正在尝试做什么。

我有很多类似于 A 类的类。这些是由另一个框架生成的，所以我无法控制它们的生成方式。

对于每一个类 AI 都有一个或多个类**C**继承了像 A 这样的类。

我已经开发了在调用 eventHandler() 时调用 A::MethodToCall() 的需要。我的目标是不必在我的所有类（如 C 类）中订阅和提供 eventhadler 方法。

我宁愿创建一个 B 类，我的所有 C 类都可以简单地继承。

我的问题是我不知道如何从 B 类呼叫 A 类。

如果有更好的方法可以做到这一点，我愿意接受。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:03:34.507

您的代码与您的描述不匹配（在代码中 B 不从 A 继承，而在您的描述中它确实如此），但我认为您的意思是“我有大量像 A 这样的类，还有一个大从 A 类（在您的示例中为 C）继承的类的数量，并且在这些子类中有很多常见的东西我想排除（在您的示例中为 B），但它包括取决于特定的东西A（在你的例子中调用了一个 A 方法）并且它破坏了必须使许多 B （每个 A 一个）几乎都是一样的。”

您可以使用的一件事是“从参数继承的模板类”技巧将大量 B 变体定义为单个模板类：

```
template<class A> B : public A {
    void eventHandler(Event* E) {
       call methodToCall(); 
    }
}

class C1 : public B<A1> {
     ... whatever

class C2 : public B<A2> { ... 
```

如果您有某些 A 类需要在 B 中稍有不同的东西，您也可以为这些类专门化 B 模板。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T20:48:59.693

您可以编写一个包装类，它是 A 和 B 的子类。称为 D 的子类将知道 A 和 B，因此当事件发生时，D 负责处理它并调用 A。然后您可以让你的 C 类继承 D 类。

编辑：我想我在这里误解了你的问题。如果 B 继承了 A，那么 B 可以直接调用 A 中的函数（只要 A 的方法不是私有的。如果是，你无论如何都无法调用它）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T20:56:00.937

这段代码

```
class A {
 void methodToCall() {};
} 
```

应该

```
class A {
 static void methodToCall() {};
} 
```

为此：

```
 void eventHandler(Event* E) {
   A::methodToCall()
 } 
```

因为您没有类型的对象`A`并且“B”一无所知`A`- 所以只有静态方法可用。

或者这样做

```
class B : public A ....
class C: public B 
```

然后不需要静态，因为 B 继承了 A。

这是你的选择。

# jquery - jQuery ajax() 在 json 传递 jsonlint 时说 parseerror

> ID：13941200
> 
> 赞同：0
> 
> 时间：2012-12-18T20:44:29.930
> 
> 标签：jquery, ajax, json, parsing

我有一个使用 jQuery (1.8.2) 进行 ajax 调用的简单网站：

```
$.ajax({
  url: 'http://localhost:1337?callback=?',
  dataType: 'jsonp',
  crossDomain: true,
  success: function(a,b,c) {
    console.log('success',a,b,c);
  },
  error: function(a,b,c) {
    console.log('error',a,b,c);
  }
}); 
```

该网页具有标题：

```
Access-Control-Allow-Origin *
Access-Control-Expose-Headers Access-Control-Allow-Origin
Access-Control-Allow-Headers * 
```

返回的ajax是：

```
[{"a":"b"}] 
```

（也通过 JSONlint）， json 被用作`application/json`

但是我得到一个解析错误：

```
'error'
[object]
'parsererror'
Error
  arguments: undefined
  get stack: function () { [native code] }
  message: "jQuery18209882410678546876_1355861965752 was not called"
  set stack: function () { [native code] }
  type: undefined 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:47:27.930

你将不得不返回

```
$_GET["callback"] . "('[\"a\":\"b\"]')" 
```

而不仅仅是 JSON，因为使用 JSONP jQuery 期望返回可执行的脚本代码。

# objective-c - 对托管对象持有强引用

> ID：13941203
> 
> 赞同：2
> 
> 时间：2012-12-18T20:45:00.167
> 
> 标签：objective-c, core-data, nsmanagedobject

如果我对 ManagedObject 有强引用，然后从 Context 中删除了该 ManagedObject，那么我对 ManagedObject 的强引用是否仍然有效？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:14:03.947

是的，尽管如果您的托管对象是错误的（因为您从未访问过其中的任何值，或者因为您已将其变成错误`refreshObject:mergeChanges:`），那么如果您尝试访问已删除对象上的任何属性，它会抛出异常。

因此，您应该小心检查 isDeleted 或监听通知（例如 NSManagedObjectDidSaveNotification）并检查您的对象是否被删除。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:54:29.257

据我了解是的，就是这样。

[参考](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreData/Articles/cdMemory.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T21:01:54.263

是的，它将是有效的。它应该反映它已被删除。`object.isDeleted`

# visual-c++ - 正确同步两个线程

> ID：13941211
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:45:33.327
> 
> 标签：visual-c++, mfc

有两个线程使用 AfxBeginThreads 启动并同步，如图所示。如何使用 Createevent、SetEvent..etc 正确同步它们？我可以查看调用每个事件的实际代码顺序吗？它似乎有效，但可能不是正确的实施。

```
volatile  unsigned char r = 0;

    DWORD thread1(Lpvoid ...)
    {
        WritetoBuffer
        r=1;
    }

    DWORD thread2(Lpvoid ...)
    {
        if(r==1)
        ReadsBuffer
        r=0;
    } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T11:44:56.397

您的问题不清楚您*要*达到的目标：`thread1`只写一次，`thread2`只读一次吗？还是`thread1`不断地写，而`thread2`不断地读？

您可能想查看wikipedia 上对[生产者-消费者问题的描述。](http://en.wikipedia.org/wiki/Producer-consumer_problem)该页面甚至包含一个 C++ 实现（它使用新的 C++11 功能，因此您可能无法编译它），它应该让您了解如何使用 MFC 和 Win32 API 来实现它。

您还可以查看[使用信号量：CodeProject 上的多线程生产者/消费者](http://www.codeproject.com/Articles/1201/Using-Semaphores-Multithreaded-Producer-Consumer)。文章提供了一个使用 Windows API 函数的实现，很好地解释了这种情况。

我希望这个对你有用。

# c# - 当我尝试从方法返回命令时，Ado.net 数据提供程序引发错误

> ID：13941214
> 
> 赞同：0
> 
> 时间：2012-12-18T20:45:41.827
> 
> 标签：c#, ado.net, sqlbase

我很抱歉标题不好，不确定如何完全描述这个问题。

我正在使用 SQLBase NET 数据提供程序。

当我尝试创建命令并添加参数时，它会引发异常

> *对象未设置为对象的实例*

但是，当我在对象之外创建命令时，我可以毫无问题地添加参数。

`SQLBaseDatabase`class 是我编写的一个包装器，它基本上会返回一个连接并创建一个命令。

```
var db = new SQLBaseDatabase(ConfigurationManager.ConnectionStrings["UDSConnectionString"].ConnectionString); 
```

此代码有效：我在我`HomeController`的测试中创建了此代码。我可以毫无问题地添加参数。

```
var command = new SQLBaseCommand();
command.Connection = db.GetConnection() as SQLBaseConnection;
command.Parameters.Add(db.GetParameter(":1", "1234", DbType.String)); 
```

此代码失败：

```
var parameters = new List<IDataParameter>();
parameters.Add(db.GetParameter(":1", "1234", DbType.String));
var cmd = db.GetCommand(db.GetConnection(), "Select * From DX_CODES Where (DX = :1)", parameters); 
```

当我尝试通过传入的参数在此方法中添加参数时，它会引发对象未设置错误。

```
public IDbCommand GetCommand(IDbConnection connection, string sql, IEnumerable<IDataParameter> parameters)
{
    var command = new SQLBaseCommand(connection as SQLBaseConnection);            

    foreach (var parameter in parameters)
        command.Parameters.Add(parameter); // This throws an error. Command.Parameters is read only.

    command.CommandText = sql;

    return command;
} 
```

命令参数是只读的

这是我创建参数的方法

```
 public IDbDataParameter GetParameter(string name, object value, DbType type)
 {
     return new SQLBaseParameter(name, type, value);
 } 
```

我不确定我在 C# 中是否从根本上做错了可能导致此错误的错误。或者考虑到它在一种情况下有效，但在另一种情况下无效，我该如何解决。

** 更新 ** SqlServer ADO.Provider 也会出现同样的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:56:40.133

我会尝试在您的方法中初始化 SQLBaseCommand，就像您在第一个示例中所做的那样。

```
var command = new SQLBaseCommand();    
command.Connection = connection as SQLBaseConnection; 
```

带有和不带有构造函数参数的构造函数可能有非常不同的实现。例如，Parameters 属性可能不会被隐式更新。

# ruby-on-rails - Rails/AJAX 部分渲染

> ID：13941215
> 
> 赞同：9
> 
> 时间：2012-12-18T20:45:42.800
> 
> 标签：ruby-on-rails, ajax

我做了一个有`project`模型的应用程序。模型中存储了一些信息，用户可以向`project`（使用`comment`模型）添加评论。在项目的显示视图中，我希望用户能够在“信息”部分（包含项目信息）和“评论”部分（包含在项目上写的评论）之间切换。我想使用AJAX. 所以我将有两个按钮：信息和评论。

现在我知道如何根据“远程链接”渲染部分内容，但我还必须找出点击了哪个链接。到目前为止，当单击一个链接时，我可以渲染一个部分，如下所示：

```
// In show.html.haml

= link_to("Information", :project, :id => "link_one", :remote => true)
= link_to("Comments", :project, :id => "link_two", :remote => true)

#partial_window

// In show.js.haml
$("#partial_window").html("#{j(render("comments"))}") 
```

现在，`_comment.html.haml`当我单击其中一个链接时，这会呈现部分内容。我需要知道的是如何检查单击了*哪个*链接，然后呈现适当的 partial:`_info.html.haml`或`_comments.html.haml`.

在此先感谢您的帮助！

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-12-19T18:16:50.363

像这样的东西*应该*工作。我们将使用嵌套路由。查看[ryan 的截屏视频](http://railscasts.com/episodes/139-nested-resources)（有点旧，但可以理解）或这个[关于嵌套表单的更新版本](http://railscasts.com/episodes/196-nested-model-form-revised)（使用相同的原则）。您必须为更新版本付费，但我发现我的 RailsCast 订阅物超所值，每月 9 美元。此外，这里是示例[文档](http://guides.rubyonrails.org/routing.html#nested-resources)。

`config/routes.rb`

```
resources :projects do
  resources :comments
end 
```

`comments_controller.rb`

```
class CommentsController < ApplicationController
  def index
    project = Project.find params[:project_id]
    @comments = project.comments
    respond_to do |format|
     format.html #responds with default html file
     format.js #this will be the javascript file we respond with
    end
  end
end 
```

`views/comments/index.js.erb`

```
$('#holderDiv').empty().append('<ul> <%= j render @comments %> </li>') 
```

这使用了一个漂亮的 rails 东西，它会查找`comment`部分内容并将其呈现给`@comments`. j 助手转义 javascript 并将渲染的部分插入到`append`函数中。

`views/comments/_comment.html.erb`

```
 <li> <%= @comment.description %> </li> 
```

所以我们现在已经清除`#holdingDiv`并插入了我们的评论。对于`information`，也许是这样的：

`projects_controller.rb`

```
class ProjectsController < ApplicationController
  def index
    @project = Project.find params[:id]
    respond_to do |format|
      format.html
      format.js
    end
  end
end 
```

`views/project/index.js.erb`

```
 $('#holderDiv').empty().append('<%= j render 'information', information: @project.information %>') 
```

`views/project/_information.html.erb`

```
<h2>
  <%= information.title %>
</h2>
<p>
  <%= infomration.details %>
</p> 
```

然后，您的远程链接将类似于：

```
= link_to("Information", @project, :remote => true)
= link_to("Comments", project_comments_url(@project), :remote => true) 
```

我不得不对你的数据结构做一些假设。让我知道我在哪里让你感到困惑。

另外，我确定我有一些错别字，抱歉。我没有对此进行测试，只是想了想。

# android - 从不同的活动android访问LocationManager回调

> ID：13941218
> 
> 赞同：1
> 
> 时间：2012-12-18T20:45:55.573
> 
> 标签：android, android-activity, locationmanager

我想从一个以文本显示更新的活动启动[LocationManager 。](http://developer.android.com/guide/topics/location/strategies.html)而且还允许用户切换到“地图视图”活动以查看地图上的进度。

我怎样才能允许两个单独的活动接收回调，以便我可以更新这两个活动？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:52:45.103

您可以从一项服务注册更新，然后该服务将向您的各种活动广播位置更新是什么，允许多个活动查看这些更新，而无需为每个活动注册位置更新。

# c++ - CPU周期计数c ++

> ID：13941219
> 
> 赞同：2
> 
> 时间：2012-12-18T20:46:01.637
> 
> 标签：c++, optimization, inline-assembly, cpu-cycles

> **可能重复：**
> [使用 RDTSC 获取 cpu 周期 - 为什么 RDTSC 的值总是增加？](https://stackoverflow.com/questions/8602336/getting-cpu-cycles-using-rdtsc-why-does-the-value-of-rdtsc-always-increase)
> [获取 CPU 周期数？](https://stackoverflow.com/questions/13772567/get-cpu-cycle-count)

我想编写分析排序算法的 C++ 代码，并且我需要知道对数组进行排序需要多少个处理器周期。

关于如何做到这一点的任何建议？

[我在这里](https://stackoverflow.com/questions/13772567/get-cpu-cycle-count)找到了这段代码：

```
uint64_t rdtsc(){
    unsigned int lo,hi;
    __asm__ __volatile__ ("rdtsc" : "=a" (lo), "=d" (hi));
    return ((uint64_t)hi << 32) | lo;
} 
```

我知道它是内联汇编，有人可以解释它是如何工作的以及如何使用它吗？

我运行 Linux。我的电脑是双核的，有区别吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T20:49:22.640

你看过电话`clock`吗？

它[记录在这里](http://www.cplusplus.com/reference/ctime/clock/)，并且似乎是您想要的。

# html - 将 div 向上移动到其他 div

> ID：13941221
> 
> 赞同：1
> 
> 时间：2012-12-18T20:46:15.443
> 
> 标签：html, css, css-float, position

我有一组动态生成的 div。我在那里设置了宽度，但每次的高度都不同。我已经给出了 div`float:left`问题是它们的位置不正确。表单行和高度最大的 div 是行的高度。这在 div 之间留下了很多空间（垂直）

请看示例：[JsFiddle](http://jsfiddle.net/Mpw3f/1/)

如何在 div1 下获得显示“将这个 div 向上移动”的 div？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:59:05.197

如果您的 div 的高度是静态的（我知道这不太可能），您可以在`margin-top`要向上移动的 div 中添加一个负数。看到[这个小提琴](http://jsfiddle.net/jcurran/2TEZA/)。

对于动态创建的 div，您最好的选择可能是第三方插件（正如我在上面的评论中提到的），如 jquery masonry 或类似的东西。

# javascript - AutoCompleteExtender - 强制用户只能从返回的列表中选择 - ASP.NET

> ID：13941222
> 
> 赞同：1
> 
> 时间：2012-12-18T20:46:18.810
> 
> 标签：javascript, asp.net, autocompleteextender

我在姓氏、名字、唯一 ID 的文本框中有一个 AutoCompleteExtender。

我想让它让用户只能从列表中选择一个项目，而不是输入他们自己的唯一 ID 号。我不能使用 AJAX ComboBox，因为我需要使用的数据库非常大，而且我读到 AutoCompleteExtender 最适合与大型数据库一起使用。

任何想法我怎么能做到这一点？在这一点上，Javascript 是我的最佳选择。我不想在后面的代码中这样做。我只找到了一个例子。我尝试使用带有一些 Javascript 的 onblur="checkItemSelected(this)" 但问题是我已经在使用 onclientclick="alert('Your data has been SAVED!')" 因为这个页面是为用户设计的名称在同一个屏幕上，它不合作。

非常感谢帮忙。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T13:07:44.257

最好的做法是在使用 AutoCompleteExtender 的文本框中使用一点 Javascript onBlur。

这是代码：

var isItemSelected = false;

```
 //Handler for AutoCompleter OnClientItemSelected event
  function onItemSelected() {
      isItemSelected = true;
  }

  //Handler for textbox blur event
  function checkItemSelected(myTextBox) {
      if (!isItemSelected) {
          alert("Please select item from the list only!");
          myTextBox.focus();
      }
      else {
          //reset isItemSelected
          isItemSelected = false;
      }
  } 
```

然后把它扔到文本框中：

onblur="checkItemSelected(这个)"

# javascript - Jasmine 测试：监视对函数的第一次调用

> ID：13941225
> 
> 赞同：0
> 
> 时间：2012-12-18T20:46:30.653
> 
> 标签：javascript, jasmine

我正在编写一个强制异常的测试，然后在 catch 块中调用相同的函数。

在我的测试中，我需要监视 localStorage.setItem 一次，这是我模拟异常的地方。当调用者再次被调用时，我需要删除间谍或以某种方式防止 catch 块再次被击中。

```
it('handles quota_exceeded exceptions', function() {
   spyOn(localStorage, 'setItem').andCallFake(function() {
      throw new Error("QUOTA_EXCEEDED_ERR", "QUOTA_EXCEEDED_ERR: DOM Exception 22");
   });
   spyOn(Obj, 'add').andCallThrough();
   spyOn(Obj, 'clean');

   expect(function() {
      Obj.add('foo', 'bar');
   }).not.toThrow();
   expect(Garage.add.callCount).toBe(2);
}); 
```

上面的测试代码会产生一个无限循环，因为 localStorage.setItem 每次都会引发异常。

任何想法或替代测试模式将不胜感激。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:05:31.197

您可以将 localStorage 配额状态存储在本地变量中。就像是：

```
it('handles quota_exceeded exceptions', function() {
   var quota_exceeded = true;

   spyOn(localStorage, 'setItem').andCallFake(function() {
      if (quota_exceeded) {
         throw new Error("QUOTA_EXCEEDED_ERR", "QUOTA_EXCEEDED_ERR: DOM Exception 22");
      }
   });
   spyOn(Obj, 'add').andCallThrough();
   spyOn(Obj, 'clean').andCallFake(function () {
       quota_exceeded = false;
   });

   expect(function() {
      Obj.add('foo', 'bar');
   }).not.toThrow();
   expect(Garage.add.callCount).toBe(2);
}); 
```

# php - 使用 jQuery 拖放从列表中选择

> ID：13941228
> 
> 赞同：0
> 
> 时间：2012-12-18T20:46:45.720
> 
> 标签：php, jquery

我有我的 php 文件作为无序列表输出到网页的项目。我想选择这些项目，然后将它们放入一个数组中。

我想使用第一个答案中看到的 jQuery 拖放功能：

[jQuery Sortable - 选择并拖动多个列表项](https://stackoverflow.com/questions/3774755/jquery-sortable-select-and-drag-multiple-list-items)

并随后在此处的小提琴中演示：

[http://jsfiddle.net/T68Fn/](http://jsfiddle.net/T68Fn/)

我的问题是，如何将拖动的项目放入可以与 php 一起使用的数组中？这是上面代码中的html：

```
<div class="demo">
    <p>Available Boxes (click to select multiple boxes)</p>    
    <ul id="draggable">
        <li>Box #1</li>
        <li>Box #2</li>
        <li>Box #3</li>
        <li>Box #4</li>
    </ul>

    <p>My Boxes</p>
    <ul id="droppable">
    </ul>

</div> 
```

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T20:56:46.040

将您的 UL 的内容复制到输入 [type=text] 字段并提交到您的 PHP 脚本。

在您的 PHP 脚本中，您可以将输入字符串拆分为数组

*   [http://php.net/manual/en/function.str-split.php](http://php.net/manual/en/function.str-split.php)

    您可能需要稍微修剪和清理您的字符串，但您明白了。

    希望这可以帮助。

    祝你好运。

# uiscrollview - UIScrollView 滚动时内容偏移重置

> ID：13941229
> 
> 赞同：0
> 
> 时间：2012-12-18T20:46:47.880
> 
> 标签：uiscrollview, contentoffset

当用户拉下表格视图以使其可见时，我希望能够显示表格的部分标题视图。同样，当用户将标题推到视野之外时，我想隐藏它。

为此，我设置了一个内容插图来隐藏表格的顶部。我还设置了一个内容偏移来隐藏我想要显示的部分

```
+------------------------------+
| Top part of header (hidden)  |
+------------------------------+
|                              |
| Bottom part (I want to show) |
|                              |
+------------------------------+
|                              |
|                              |
|         Table view           |
|                              |
|                              |
+------------------------------+ 
```

问题是，当我滚动视图时，内容偏移量似乎会重置并显示我想要显示的部分，即使我将表格向上推也是如此。

这个问题阻止我使用`scrollViewWillEndDragging:withVelocity:targetContentOffset:targetContentOffset`动画内容偏移相对于我滚动的方向。

这是我的代码（在`viewDidAppear:`）

```
CGRect hiddenPartOfHeaderFrame = self.hiddenPartOfHeaderFrame.frame;

UIEdgeInsets tableContentInset = UIEdgeInsetsMake(- CGRectGetHeight(hiddenPartOfHeaderFrame), 0.0f, 0.0f, 0.0f);

[self.tableView setContentInset:tableContentInset];

CGPoint tableContentOffset = CGPointMake(0.0f, (CGRectGetHeight(self.tableView.tableHeaderView.frame)));

[self.tableView setContentOffset:tableContentOffset]; 
```

它是在滚动时更改的内容偏移的属性，还是我没有考虑到这里发生的其他事情？

一如既往的感谢

# java - 即使使用包装类，SwingWorker 异常也会丢失

> ID：13941236
> 
> 赞同：10
> 
> 时间：2012-12-18T20:47:35.887
> 
> 标签：java, swing, swingworker

我一直在努力解决 SwingWorker 吃掉后台任务中抛出的任何异常的可用性问题，例如，[在这个 SO thread 上](https://stackoverflow.com/questions/791223/how-should-i-handle-exceptions-when-using-swingworker)描述的。该线程很好地描述了问题，但没有讨论恢复原始异常。

我收到的小程序需要向上传播异常。但我什至无法抓住它。我正在使用[此博客条目](http://jonathangiles.net/blog/?p=341)中的 SimpleSwingWorker 包装类来专门尝试解决此问题。这是一个相当小的课程，但我会在最后重新发布它以供参考。

调用代码看起来很像

```
try {
    // lots of code here to prepare data, finishing with
    SpecialDataHelper helper = new SpecialDataHelper(...stuff...);
    helper.execute();  // this will call get+done on the actual worker
} catch (Throwable e) {
    // used "Throwable" here in desperation to try and get
    // anything at all to match, including unchecked exceptions
    //
    // no luck, this code is never ever used :-(
} 
```

包装：

```
class SpecialDataHelper extends SimpleSwingWorker {
    public SpecialDataHelper (SpecialData sd) {
        this.stuff = etc etc etc;
    }
    public Void doInBackground() throws Exception {
        OurCodeThatThrowsACheckedException(this.stuff);
        return null;
    }
    protected void done() {
        // called only when successful
        // never reached if there's an error
    }
} 
```

的特点`SimpleSwingWorker`是会自动调用实际的 SwingWorker`done()/get()`方法。从理论上讲，这会重新引发后台发生的任何异常。在实践中，什么都没有被抓到，我什至不知道为什么。

SimpleSwingWorker 类，供参考，为简洁起见，没有省略：

```
import java.util.concurrent.ExecutionException;
import javax.swing.SwingWorker;

/**
 * A drop-in replacement for SwingWorker<Void,Void> but will not silently
 * swallow exceptions during background execution.
 *
 * Taken from http://jonathangiles.net/blog/?p=341 with thanks.
 */
public abstract class SimpleSwingWorker {
    private final SwingWorker<Void,Void> worker =
        new SwingWorker<Void,Void>() {
            @Override
            protected Void doInBackground() throws Exception {
                SimpleSwingWorker.this.doInBackground();
                return null;
            }

            @Override
            protected void done() {
                // Exceptions are lost unless get() is called on the
                // originating thread.  We do so here.
                try {
                    get();
                } catch (final InterruptedException ex) {
                    throw new RuntimeException(ex);
                } catch (final ExecutionException ex) {
                    throw new RuntimeException(ex.getCause());
                }
                SimpleSwingWorker.this.done();
            }
    };

    public SimpleSwingWorker() {}

    protected abstract Void doInBackground() throws Exception;
    protected abstract void done();

    public void execute() {
        worker.execute();
    }
} 
```

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-12-18T23:01:40.957

忘记你的包装器，它会吃掉异常，而 SwingWorker 不会。以下是应该如何使用 SwingWorker，以及应该如何处理从后台任务抛出的特定异常：

```
class MeaningOfLifeFinder extends SwingWorker<String, Object> {
    @Override
    public String doInBackground() throws SomeException {
        return findTheMeaningOfLife();
    }

    @Override
    protected void done() { // called in the EDT. You can update the GUI here, show error dialogs, etc.
        try { 
            String meaningOfLife = get(); // this line can throw InterruptedException or ExecutionException
            label.setText(meaningOfLife);
        } 
        catch (ExecutionException e) {
            Throwable cause = e.getCause(); // if SomeException was thrown by the background task, it's wrapped into the ExecutionException
            if (cause instanceof SomeException) {
                // TODO handle SomeException as you want to
            }
            else { // the wrapped throwable is a runtime exception or an error
                // TODO handle any other exception as you want to
            }
        }
        catch (InterruptedException ie) {
            // TODO handle the case where the background task was interrupted as you want to
        }
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:46:06.110

包装器似乎按预期工作。`done()`但是，如果发生异常，它的实现将永远不会调用。这不适用于许多情况。调用它可能更简单`get()`。`done()`这将抛出任何发生在`doInBackground()`.

不确定您的示例的结构如何，但它在没有 EDT 的应用程序中不起作用。所以包装工人执行`SwingUtilities.invokeLater`确实有帮助，即：

```
SwingUtilities.invokeLater(new Runnable() {
    public void run() {
        new SpecialDataHelper().execute();
    }
}); 
```

以下示例确实打印了异常堆栈跟踪：

```
public class Tester {

    static class SpecialDataHelper extends SimpleSwingWorker {
        public SpecialDataHelper () {
        }
        public Void doInBackground() throws Exception {
            throw new Exception("test");
        }
        protected void done() {
        }
    }

    public static void main(String[] args) {
        try{
            SwingUtilities.invokeLater(new Runnable() {
                public void run() {
                    new SpecialDataHelper().execute();
                }
            });
        } catch(Exception ex){
            ex.printStackTrace();
        }
    }
} 
```

还要考虑这个简单的示例，该示例演示如何在`doInBackground()`不使用包装器的情况下获取发生的异常。包装器只是一个帮手，以防您忘记调用`get()`.

```
import javax.swing.JOptionPane;
import javax.swing.SwingUtilities;
import javax.swing.SwingWorker;

public class Tester {
    static class Worker extends SwingWorker<Void,Void> {
        @Override
        protected Void doInBackground() throws Exception {
            throw new Exception("test");
        }
        @Override
        protected void done() {
            try {
                get();
                JOptionPane.showMessageDialog(null, "Operation completed");
            } catch (Exception ex) {
                JOptionPane.showMessageDialog(null, "Operation failed");
            } 
        }
    }

    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                new Worker().execute();
            }
        });         
    }
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-14T10:35:02.640

我想每个人都把这件事弄得太复杂了。试试这个：

```
String myResult="notSet";
try {
    // from your example above
    helper.execute();  // this will call get+done on the actual worker
    myResult=helper.get();
} catch (Exception e) {
// this section will be invoked if your swingworker dies, and print out why...
     System.out.println("exception ");
     e.printStackTrace() ;
     myResult="Exception "+e.getMessage();
}
return myResult; 
```

您抛出但被吃掉的异常将被揭示。有两点可以解释为什么会这样。一，你只从调用线程中捕获远程异常，而你 .get() 结果。更详细地说：要使上述示例异步，只需将 .execute() 在代码中向上移动。您将发现远程异常的那一刻是在异步线程被炸毁并且您 .get() 结果之后。第二，通过捕获所有异常，您将捕获您可能构建的调用程序可能不知道的所有特殊和子类异常。

# apache - 在 WHM Manager 中设置默认虚拟主机

> ID：13941237
> 
> 赞同：1
> 
> 时间：2012-12-18T20:47:37.527
> 
> 标签：apache, centos, virtualhost, whm

我在 CentOS 服务器上托管了一堆带有 WHM 管理器的网站。我的一个网站 (examplesiteone.com) 允许将用户帐户创建为子域 (username.examplesiteone.com)。有了这个功能，我就可以选择让用户添加一条 A 记录来将他们自己的 url (theircompanyname.com) 指向我的服务器的 IP，然后我的渲染器会进行查找以找到相应的子域来为页面提供服务。

为了使它工作，我设置了我的服务器，以便 examplesiteone.com 是要在我的服务器上解析的默认域名；我通过将其列为 /etc/httpd/conf.d/ 中的 vhost.conf 文件中的第一个站点来实现这一点

我现在需要将站点切换到使用 WHM 管理器的新服务器，但我似乎找不到任何方法来为未知主机名设置默认网站。

# javascript - JsLinb：如何将 JSON 转换为 jsLinb 代码

> ID：13941241
> 
> 赞同：1
> 
> 时间：2012-12-18T20:47:46.103
> 
> 标签：javascript, json

如何将 JSON 代码转换为 jsLinb 代码并将其发布到代码编辑器，以便绘制像文本文件这样的小部件。

我正在做的是将 jsLinb UI 构建器生成的 JSON 代码存储在数据库中，当用户返回时，他可以检索他在 jsLinb UI 构建器上的工作。

我已经想出了如何存储 JSON 代码，但我无法将其转换回 jsLinb 代码并再次生成小部件。

这是 jsLinb UI 构建器网站： [http ://www.linb.net/VisualJS/UIBuilder.html](http://www.linb.net/VisualJS/UIBuilder.html)

jsLinb网站： [http ://www.linb.net/](http://www.linb.net/)

# java - Java 2D ImageIO.Write 阻碍性能

> ID：13941243
> 
> 赞同：2
> 
> 时间：2012-12-18T20:48:01.003
> 
> 标签：java, image, performance, 2d, javax.imageio

我维护了一个生成大量小部件的 Java 应用程序（我说小部件是因为它会生成 PDF 或 PNG 文件 - 到磁盘）。该应用程序旨在生成 PDF 和后来的图像成为一个要求。

生成图像时，我的每秒事务数 (TPS) 受到影响。基本流程是我创建了一个 BufferedImage 和 Graphics2D 实例。使用 Graphics2D 对象绘制一些文本。我拉入了一些其他图像以添加到我的新图像中。然后我将 BufferedImage 写入到 OutputStream。

我已经将 ImageIO.write() 方法视为可能的罪魁祸首。该应用程序是 RESTful 的，整个事务可能需要 500 毫秒。我已经为 ImageIO.write() 方法计时，以占用该事务时间的至少 80-90%。

```
ImageIO.write(image,"PNG",os);  // 420ms !!!! 
```

我很难找到解决 ImageIO.write() 的方法......任何建议都值得赞赏。

注意：图像是 RGB ColorModel && 最终大小约为 50kb。我已经看到二进制颜色模型的性能更好，但颜色是必需的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-06T15:41:12.663

Just to back up jonwilks' link to ObjectPlanet's "[PngEncoder](http://objectplanet.com/pngencoder/)" - we tested it and had similar results, roughly 30-50% improvement over ImageIO.write which is pretty awesome - and it's free when you use the binary only. Recommended.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T23:50:58.267

我也看到，PNG 上的 ImageIO 很慢，JPEG 更快，但我认为 PNG 更适合文本。

你可以试试[JMagick](http://www.jmagick.org/index.html)。也可以维护 ImageIO API，因为它可以处理多个用于写入/读取图像 mime 类型的提供程序。

我没有尝试但可能会有所帮助的一件事是将缓存目录设置为快速 RAM 磁盘：`ImageIO.setCacheDirectory(ramdisk)`或`setUseCache(false)`.

# android - Google Maps API v2：CameraPosition 的 LatLngBounds

> ID：13941253
> 
> 赞同：41
> 
> 时间：2012-12-18T20:48:33.623
> 
> 标签：android, google-maps, android-maps

有没有一种简单的方法可以使用 Android Google Maps API v2`LatLngBounds`从 a 获取可见地图，`CameraPosition`以便我可以使用它`OnCameraChangeListener`来获取标记的新数据。

```
mMap.setOnCameraChangeListener(new OnCameraChangeListener() {
            @Override
            public void onCameraChange(CameraPosition position) {
                LatLngBounds bounds = ?;
                fetchNewData(bounds);
            }
        }); 
```

* * *

## 回答 #1

> 赞同：78
> 
> 时间：2012-12-18T21:50:55.907

您无法从 CameraPosition 获取 LatLngBounds，但您可以从 GoogleMap 轻松获取它们。

```
private GoogleMap mMap;

mMap.setOnCameraChangeListener(new OnCameraChangeListener() {
            @Override
            public void onCameraChange(CameraPosition position) {
                LatLngBounds bounds = mMap.getProjection().getVisibleRegion().latLngBounds;
                fetchData(bounds);
            }
        }); 
```

* * *

## 回答 #2

> 赞同：41
> 
> 时间：2015-12-02T14:40:55.653

**自 2016 年 8 月以来的更新**

**总结**现在这个问题的*正确*答案是使用新`onCameraIdle`的，而不是`OnCameraChangeListener`现在[已弃用](https://developers.google.com/android/reference/com/google/android/gms/maps/GoogleMap.OnCameraChangeListener)的。阅读下面的方法。

现在，您可以在最新版本的 Android 版 Google 地图上收听“dragEnd”类事件，甚至其他事件。

如[文档](https://developers.google.com/maps/documentation/android-api/events#camera_change_events)中所示，您可以通过使用新的侦听器来避免多次（又名“*多次*”）调用的问题。`OnCameraChangeListener`例如，您现在可以检查相机移动的原因是什么，这是`fetchData`根据要求解决问题的理想选择。以下代码大多直接取自文档。还有一件事，有必要使用[Google Play Services 9.4](https://developers.google.com/android/guides/releases#august_1_-_v94)。

```
public class MyCameraActivity extends FragmentActivity implements
        OnCameraMoveStartedListener,
        OnCameraMoveListener,
        OnCameraMoveCanceledListener,
        OnCameraIdleListener,
        OnMapReadyCallback {

    private GoogleMap mMap;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_my_camera);

        SupportMapFragment mapFragment =
            (SupportMapFragment) getSupportFragmentManager()
                    .findFragmentById(R.id.map);
        mapFragment.getMapAsync(this);
    }

    @Override
    public void onMapReady(GoogleMap map) {
        mMap = map;

        mMap.setOnCameraIdleListener(this);
        mMap.setOnCameraMoveStartedListener(this);
        mMap.setOnCameraMoveListener(this);
        mMap.setOnCameraMoveCanceledListener(this);

        // Show Sydney on the map.
        mMap.moveCamera(CameraUpdateFactory
                .newLatLngZoom(new LatLng(-33.87365, 151.20689), 10));
    }

    @Override
    public void onCameraMoveStarted(int reason) {

        if (reason == OnCameraMoveStartedListener.REASON_GESTURE) {
            Toast.makeText(this, "The user gestured on the map.",
                           Toast.LENGTH_SHORT).show();
        } else if (reason == OnCameraMoveStartedListener
                                .REASON_API_ANIMATION) {
            Toast.makeText(this, "The user tapped something on the map.",
                           Toast.LENGTH_SHORT).show();
        } else if (reason == OnCameraMoveStartedListener
                                .REASON_DEVELOPER_ANIMATION) {
            Toast.makeText(this, "The app moved the camera.",
                           Toast.LENGTH_SHORT).show();
        }
    }

    @Override
    public void onCameraMove() {
        Toast.makeText(this, "The camera is moving.",
                       Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onCameraMoveCanceled() {
        Toast.makeText(this, "Camera movement canceled.",
                       Toast.LENGTH_SHORT).show();
    }

    @Override
    public void onCameraIdle() {
        Toast.makeText(this, "The camera has stopped moving. Fetch the data from the server!", Toast.LENGTH_SHORT).show();
        LatLngBounds bounds = mMap.getProjection().getVisibleRegion().latLngBounds;
        fetchData(bounds)
    }
} 
```

* * *

**2016 年 8 月之前有效解决方案的解决方法**

由于这个问题得到了正确的回答，我想补充一下可能是下一个问题的问题。

`OnCameraChangeListener`由于触发此方法的频率，使用从服务器获取数据时会出现问题。

有一个[问题](https://code.google.com/p/gmaps-api-issues/issues/detail?id=4636)报告了在进行简单的地图滑动时触发此方法的频率有多疯狂，因此在问题的示例中`fetchData`，即使没有相机更改，它也会触发多个连续时间以进行非常小的相机更改，是的，它发生了相机边界没有改变，但该方法被触发。

这可能会影响服务器端的性能，并且会通过从服务器按顺序获取数据数十次而浪费大量设备资源。

您可以在该链接中找到此问题的解决方法，但还没有正式的方法来解决此问题，例如，使用期望`dragEnd`的 或`cameraChangeEnd`回调。

下面的一个例子，基于那里的例子，是我如何通过使用调用的时间间隔并丢弃具有相同边界的调用来避免上述问题。

```
// Keep the current camera bounds
private LatLngBounds currentCameraBounds;

new GoogleMap.OnCameraChangeListener() {
    private static int CAMERA_MOVE_REACT_THRESHOLD_MS = 500;
    private long lastCallMs = Long.MIN_VALUE;

    @Override
    public void onCameraChange(CameraPosition cameraPosition) {
      LatLngBounds bounds = map.getProjection().getVisibleRegion().latLngBounds;
      // Check whether the camera changes report the same boundaries (?!), yes, it happens
      if (currentCameraBounds.northeast.latitude == bounds.northeast.latitude
         && currentCameraBounds.northeast.longitude == bounds.northeast.longitude
         && currentCameraBounds.southwest.latitude == bounds.southwest.latitude
         && currentCameraBounds.southwest.longitude == bounds.southwest.longitude) {
         return;
       }

      final long snap = System.currentTimeMillis();
      if (lastCallMs + CAMERA_MOVE_REACT_THRESHOLD_MS > snap) {
        lastCallMs = snap;
        return;
      }

      fetchData(bounds);

      lastCallMs = snap;
      currentCameraBounds = bounds;

} 
```

# javascript - 花式框图像标题和计数不起作用

> ID：13941254
> 
> 赞同：1
> 
> 时间：2012-12-18T20:48:49.643
> 
> 标签：javascript, jquery, fancybox, fancybox-2

我最近将我的 fancybox 版本更新到当前的 v2.1.3。但在那之后，在我的幻想库中出现了标题，并且图像计数无法正常工作。在我的以下代码中完成了这项工作，但是即使当前版本给出了相同的代码，它现在也无法正常工作。

```
$(document).ready(function(){
        $("a[rel=img_gallery]").fancybox({
        'transitionIn'      : 'none',
        'transitionOut'     : 'none',
        'titlePosition'     : 'over',
        'titleFormat'       : function(title, currentArray, currentIndex, currentOpts) {
            return '<span id="fancybox-title-over">Image ' +  (currentIndex + 1) + ' / ' + currentArray.length + ' ' + title + '</span>';
            }
        });
    }); 
```

这是我的示例画廊页面[链接](http://www.apartmentslanka.com/ztest_calender/hotel2.html)。如果您仔细注意到图​​片标题标题在我的画廊中有效，但与预期不同。实际上我的要求是在[fancybox主页](http://fancybox.net/)上第三个有一个图片库示例。如果单击它，您将获得一个带有图像标题和图像计数的图像库弹出窗口，例如：黑色覆盖的 1/3。我只想简单地将它应用到我的画廊。谁能告诉我怎么做？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T22:04:57.843

fancybox v2.x 中的 API 选项是新的，并且与以前的版本 (v1.3.x)**不**兼容

检查[http://fancyapps.com/fancybox/#docs](http://fancyapps.com/fancybox/#docs)以获得您正在使用的新版本的正确 API 选项。

为了更快，您的代码现在应该如下所示：

```
$("a[rel=img_gallery]").fancybox({
    helpers: {
        title: {
            type: 'over'
        }
    },
    // helpers
    beforeShow: function() {
        this.title = 'Image ' + (this.index + 1) + ' of ' + this.group.length + (this.title ? ' - ' + this.title : '');
    } // beforeShow
}); // fancybox​ 
```

见**[演示](http://jsfiddle.net/BP2Ew/)**

# java - Java：重载方法，方法（null）会发生什么？

> ID：13941256
> 
> 赞同：-2
> 
> 时间：2012-12-18T20:48:55.773
> 
> 标签：java

> **可能重复：**
> [带有空参数的 Java 方法分派](https://stackoverflow.com/questions/377203/java-method-dispatch-with-null-argument)

为什么这会打印“a(String)”？

```
public class Test{
    public static void main(String[] args){
        a(null);
    }
    public static void a(Object x){
        System.out.println("a(Object)");
    }
    public static void a(String x){
        System.out.println("a(String)");
    }
    public static void a(int x){
        System.out.println("a(int)");
    }
    public static void a(){
        System.out.println("a()");
    }
} 
```

爪哇版：

```
java version "1.7.0_04-ea"
Java(TM) SE Runtime Environment (build 1.7.0_04-ea-b228)
Java HotSpot(TM) 64-Bit Server VM (build 23.0-b12, mixed mode) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T20:50:10.083

因为规则是选择最具体的方法，而 String 继承自 Object。

[从规范：](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12)

> 如果在适用性测试的三个阶段之一中确定了几种适用的方法，则选择最具体的一种

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:50:19.690

在重载方法的情况下，编译器使用 **最具体的参数**调用方法。与以字符串为参数的方法相比，编译器调用 `java.lang.String`更**具体的类。**`java.lang.Object`

来自[**Java 语言规范：**](http://docs.oracle.com/javase/specs/jls/se7/html/jls-15.html#jls-15.12)

> 如果在适用性测试的三个阶段之一中确定了几种适用的方法，则选择最具体的一种

# java - 使用 Java Servlet 和 Tomcat 6 交付 HTML5 视频

> ID：13941266
> 
> 赞同：3
> 
> 时间：2012-12-18T20:49:39.380
> 
> 标签：java, google-chrome, tomcat, html5-video

> **可能重复：**
> [如何将 MP3 流式传输到 HTML5 播放器，例如 Accessible Audio Player](https://stackoverflow.com/questions/13588149/how-to-stream-mp3-to-html5-player-such-as-accessible-audio-player)

我正在开发一个 Java 解决方案来为 HTML5 页面执行 MP4 视频交付。该解决方案检查用户是否已登录，以及是否开始向用户提供视频。

我的代码在我的带有 Eclipse Indigo 和 Tomcat 6 的笔记本电脑上正常工作，我可以毫无问题地播放视频，但是当我将它以 WAR 文件的形式传送到我的生产服务器（Tomcat 6+Debian）时，我无法播放视频我的导航器（谷歌浏览器）。如果我通过 Chrome 的开发人员模式检查标题，我会看到一切正常，我们可以在“网络选项卡”中看到它正在从服务器下载的视频，但它没有出现在窗口上。

我的servlet的代码如下：

```
protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException
{
    HttpSession sesion = request.getSession();      
    try
    {
        Integer idUsuario = (Integer) sesion.getAttribute("ID_USUARIO");
        Integer vID = Integer.parseInt((String) request.getParameter("vID"));
        if (idUsuario != null && idUsuario > 0 && vID != null && vID > 0)
        {
            VideoService servVideo = new VideoService();
            TipoVideo video = new TipoVideo();
            video = servVideo.obtieneVideo(vID);
            String ruta = "/home/video/vod/";
            String[] litVideo = video.getLiteralVideo().split(":");
            if (litVideo.length > 1)
            {
                ruta = ruta.concat(litVideo[1]);
            }
            else
            {
                ruta = ruta.concat(litVideo[0]);
            }
            if (ruta != null && !ruta.isEmpty() && ruta.length()>2)
            {   
                java.io.File fichero = new java.io.File(ruta);
                java.io.FileInputStream fileInputStream = new java.io.FileInputStream(fichero);                 
                response.setContentType("video/mp4");   
                response.setHeader("Content-Length", Long.toString(fichero.length()));
                log("Antes: " + Long.toString(fichero.length()));
                response.setContentLength(Integer.parseInt(Long.toString(fichero.length())));
                log("Pasamos la petición");
                ServletOutputStream op = response.getOutputStream();
                int i;
                while ((i=fileInputStream.read()) != -1) 
                {
                 //out.write(i);
                    op.write(i);
                }       
                fileInputStream.close();
                op.flush();
                op.close();
                return; 
            }
        }
        else
        {
            response.getWriter().println("ACCESO DENEGADO");
            log("Acceso denegado");
        }
    }
    catch (NumberFormatException nfex)
    {
        response.getWriter().println("nfex: " + nfex.getMessage());
        log("nfex: " + nfex.getMessage());          
    }
    catch (ServicioException servEx)
    {
        response.getWriter().println("servEx: " + servEx.getMessage());
        log("servEx: " + servEx.getMessage());
    }
    catch (Exception ex)
    {
        response.getWriter().println("Excepción: " + ex.getMessage());
        log("Excepción: " + ex.getMessage());
    }
       } 
```

在我的生产服务器中，我有默认的 tomcat 6 配置。机器上没有安装其他应用程序或 Web 服务器。

任何人都知道这里出了什么问题或者我该如何解决？

# android - Nexus 7 上的 Android 4.2：canvas.drawText() 无法正常工作

> ID：13941270
> 
> 赞同：7
> 
> 时间：2012-12-18T20:50:11.657
> 
> 标签：android, layout, user-interface, drawtext, android-4.2-jelly-bean

我的应用程序面临一个严重的问题，该应用程序发布在 Google Play 上，显然在除 > 4.0 之外的所有版本的 Android 上都可以正常工作。

这是我的 Android 4.0 HTC 手机的屏幕截图：

![在此处输入图像描述](../Images/b8ce57f31856a5373fc8c937be626048.png)

这就是我在 Nexus 7、Android 4.2.1 上得到的（在模拟器中的行为相同）：

![在此处输入图像描述](../Images/1df4ce248432f543fff67d5a0cd2a810.png)

**我看到使用绘制的每个文本都有相同的行为`canvas.drawText()`**

用于绘制文本的 Paint 是：

```
paint = new Paint();
paint.setAntiAlias(true);
paint.setColor(color); //some color
paint.setTextSize(size); //some size
paint.setTypeface(Typeface.defaultFromStyle(Typeface.BOLD));
paint.setTextAlign(Align.CENTER); 
```

在 logCat（4.2.1 模拟器）中，我看到了很多

```
12-18 20:42:21.096: W/Trace(276): Unexpected value from nativeGetEnabledTags: 0 
```

我在清单中使用这些设置：

```
 <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="8" /> 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2012-12-20T11:53:33.023

经过大量谷歌搜索后，我回答了我自己的问题......

诀窍在于**`setLinearText(true)`**使用用于绘制文本的 Paint 对象。现在，一切看起来都很棒。

```
paint = new Paint();
paint.setAntiAlias(true);
paint.setColor(color);
paint.setTextSize(size);
paint.setTypeface(Typeface.defaultFromStyle(Typeface.BOLD));
paint.setTextAlign(Align.CENTER);
paint.setLinearText(true); 
```

这是节省我一天的链接：

[http://gc.codehum.com/p/android/issues/detail?id=39755](http://gc.codehum.com/p/android/issues/detail?id=39755)

我希望它可以帮助别人。

文本尚未呈现最佳状态：

![在此处输入图像描述](../Images/7df18891c4df08486a8b62c9e23c9233.png)

**已编辑（2013 年 14 月 1 日）**

我仍然面临一个 kering 问题（仅在 4.2.1 上）。请在此处查看我的另一个问题：

[Android 4.2.1 错误的字距调整（间距）](https://stackoverflow.com/questions/13974129/android-4-2-1-worng-character-kerning-spacing)

**已编辑（2013 年 5 月 2 日）**

我看到另一个项目有同样的问题。看看下面的链接：

[http://mindtherobot.com/blog/272/android-custom-ui-making-a-vintage-thermometer/](http://mindtherobot.com/blog/272/android-custom-ui-making-a-vintage-thermometer/)

如果您在 Nexus 4.2.1（或模拟器 Android 4.2）上运行示例，您会得到相同的“奇怪”文本...

**已编辑（2013 年 2 月 20 日）**

找到了一个不使用的解决方法`setLinearText(true)`，看这里：

[Android 4.2.1 错误的字距调整（间距）](https://stackoverflow.com/questions/13974129/android-4-2-1-worng-character-kerning-spacing)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:39:56.870

Android 4 默认开启硬件加速。启用此选项后，某些绘图功能无法正常工作。不记得究竟是哪些，但尝试在清单文件中关闭硬件加速，看看它是否有所作为。

当然，这可能不是原因，但值得一试。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-10-09T00:45:23.047

我有一个类似的问题，试图用自定义字母间距制作一个视图，所以我只做了这两种方法，希望有人觉得它们有帮助。

```
/**
 * Draws a text in the canvas with spacing between each letter.
 * Basically what this method does is it split's the given text into individual letters
 * and draws each letter independently using Canvas.drawText with a separation of
 * {@code spacingX} between each letter.
 * @param canvas the canvas where the text will be drawn
 * @param text the text what will be drawn
 * @param left the left position of the text
 * @param top the top position of the text
 * @param paint holds styling information for the text
 * @param spacingPx the number of pixels between each letter that will be drawn
 */
public static void drawSpacedText(Canvas canvas, String text, float left, float top, Paint paint, float spacingPx){

    float currentLeft = left;

    for (int i = 0; i < text.length(); i++) {
        String c = text.charAt(i)+"";
        canvas.drawText(c, currentLeft, top, paint);
        currentLeft += spacingPx;
        currentLeft += paint.measureText(c);
    }
}

/**
 * returns the width of a text drawn by drawSpacedText
 */
public static float getSpacedTextWidth(Paint paint, String text, float spacingX){
    return paint.measureText(text) + spacingX * ( text.length() - 1 );
} 
```

# python - 将 Python Windows 二进制包分组到需求文件中

> ID：13941271
> 
> 赞同：-1
> 
> 时间：2012-12-18T20:50:15.013
> 
> 标签：python, pip, setuptools

我希望将所有包要求集中到一个位置，最好是纯文本文件，以简化部署。我的应用程序依赖于简单的安装包，如 Flask：

```
(pythonenv) C:\>pip install flask 
```

[以及来自Stickpeople Project](http://www.stickpeople.com/projects/python/win-psycopg/)的预构建 Windows 二进制包，例如 psycopg2 ：

```
(pythonenv) C:\>easy_install psycopg2-2.4.6.win32-py2.7-pg9.2.2-release.exe 
```

pip 对我想做的事情有一个非常有用的论据：

```
(pythonenv) C:\>pip install -r python_packages.txt 
```

除了我还没有找到一种方法来让 pip 安装预构建的 Windows 二进制文件。

如何将所有依赖包分组到一个位置？

我能想到的一些方法可以使这成为可能：

*   easy_install 是否有类似的方式来使用列出包的文件？
*   有没有办法让 pip 安装预构建的二进制文件并将二进制包包含在 pip 要求文件中？

我正在使用 Python 2.7.3 进行开发，并且正在使用 virtualenv。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:15:25.253

这是在我的计算机上运行良好的策略：

1）安装Visual Studio 2008（快捷版就可以）

2) 从“Visual Studio 2008 命令提示符”调用 pip 命令。

Python 需要 VS2008 编译器（或等效的 gcc、mingw）来编译二进制文件。这些命令提示符为您设置环境。

对于不熟悉 Visual Studio 产品系列的用户：多个版本的 Visual Studio 不会相互冲突。因此，您可以保留当前的 ​​Visual Studio 版本，无需卸载它即可安装另一个 Visual Studio 产品。

# css - rem 与 CSS 中的 em 有何不同？

> ID：13941275
> 
> 赞同：119
> 
> 时间：2012-12-18T20:50:18.363
> 
> 标签：css

在网站源代码中，我有时会看到开发人员使用该`rem`单元。它类似于`em`吗？我试着看看它实际上做了什么，但它与什么相关？

[演示](http://jsfiddle.net/uJfWD/)

HTML

```
<div>Hello <p>World</p></div> 
```

CSS

```
div {
    font-size: 1.4rem;
}

div p {
    font-size: 1.4rem;
} 
```

* * *

## 回答 #1

> 赞同：187
> 
> 时间：2012-12-18T20:54:48.920

`EM`s 相对于其父级的字体大小

`REM`s 是相对于基本字体大小的

这在中间容器更改字体大小时很重要。使用 EM 的子元素会受到影响，使用 REM 的子元素不会。

* * *

## 回答 #2

> 赞同：48
> 
> 时间：2012-12-18T22:07:47.240

[单位`rem`](http://www.w3.org/TR/css3-values/#rem-unit)(root em) 代表根元素的字体大小。在 HTML 文档中，根元素是`html`元素。

* * *

## 回答 #3

> 赞同：26
> 
> 时间：2015-03-02T12:19:27.893

虽然***em***与其直接或最近的父级的字体大小相关，但***rem***仅与 html（根）字体大小相关。

***em***提供了控制设计区域的能力。如在该特定区域中相对缩放类型。 ***rem***提供了在整个页面上轻松缩放类型的能力。

* * *

## 回答 #4

> 赞同：18
> 
> 时间：2017-06-12T06:34:33.787

基本上**em**是相对于 CSS 中最近的父级，而**rem**是相对于页面的父级，通常是 html 标签......

如果您运行下面的 css 以及父级如何影响它，您会清楚地看到差异：

```
html {
  font-size: 16px;
}

.lg-font {
  font-size: 30px;
}

p.rem {
  font-size: 1rem;
}

p.em {
  font-size: 1em;
}
```

```
<div class="lg-font">
  <p class="em">Hello World - em</p>
</div>

<div class="lg-font">
  <p class="rem">Hello World - rem</p>
</div>
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2018-09-08T20:31:14.750

## 概括：

*   `rem`：`CSS`相对于**`html`**元素字体大小的单位。
*   `em`:`CSS`相对于**父**元素字体大小的单位。

例子：

```
.element {
  width: 10rem;
  height: 10rem;
  background-color: green;
  font-size: 5px;
}

.innerElement {
  width: 10em;
  height: 10em;
  background-color: blue;
}
```

```
<div class="element">
  <div class="innerElement"></div>
</div>
```

在上面的示例中，绿色方块是 160 像素 x 160 像素（除非您没有浏览器默认设置`16px`）。这是因为`html`元素的浏览器默认`font-size`值为`16px`and `10rem`* `16px`= 160。

里面的广场`10em`很大。因为它的父元素是`5px`正方形，所以是 5em * `10px` = `50px`。

## 这有什么用：

通过设置所有单位`rem`具有以下优点：

*   我们可以使用一个 CSS 媒体查询来扩展我们的整个应用程序，在这个媒体查询中我们可以指定字体大小。通过更改字体大小，所有具有该单位的元素`rem`都会相应地缩放。
*   当用户不使用默认浏览器时，`16px`我们应用程序的字体大小将随用户选择的字体大小进行缩放。

* * *

## 回答 #6

> 赞同：6
> 
> 时间：2015-08-28T02:08:16.823

这是一个例子。随着我们改变元素的`divs`大小而改变大小。而那些尺寸只有随着我们改变.`rem``font-size``html``em``font-size``div`

```
$(function() {
  var htmlSize = $('input#html');
  htmlSize.change(function() {
    $('html').css('font-size', htmlSize.val() + 'px');
  });

  var divSize = $('input#div');
  divSize.change(function() {
    $('div').css('font-size', divSize.val() + 'px');
  });
});
```

```
* {
  float: left;
  font-size: 20px;
  margin:2px;
}
label {
  clear:both;
}
div {
  border: thin solid black;
}
div.rem1 {
  width:4rem;
  height: 4rem;
  clear: both;
}
div.rem2 {
  width: 3rem;
  height: 3rem;
}
div.em1 {
  width: 4em;
  height: 4em;
  clear: both;
}
div.em2 {
  width: 3em;
  height: 3em;
}
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<label>Change html font-size
  <input id="html" type='number' value="20" min="18" max="30" />
</label>
<div class="rem rem1">rem</div>
<div class="rem rem2">rem</div>
<label>Change div font-size 
  <input id="div" type='number' value="20" min="18" max="30" />
</label>
<div class="em em1">em</div>
<div class="em em2">em</div>
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2020-08-14T17:55:33.837

在**em**相对单位中，字体大小是在**最近的父字体大小**的基础上测量的，但是如果没有为任何父元素定义字体大小，则默认情况下，字体大小将根据**根 html 元素定义**

**rem**相对单位仅由根 html 元素计算，**因此**，父元素的字体大小不影响它

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2021-09-09T13:25:15.753

只是一些示例 CSS 来展示如何`rem`工作，注意*根*字体大小是通过**html**标签使用**px设置的**

 **```
html, body { font-size: 16px; }
div { font-size: 18px; }
p { font-size: 1rem; } 
```

以及相应的 HTML：

```
<div>
  <p>Lorem Ipsum</p>
</div> 
```

因为`<p>`标签设置为**1rem它忽略了****18px**的父`div’s`字体大小。但是，如果我们将 font-size 设置为**1em**，则段落将继承其父元素的**18px字体大小。**我知道这个例子不是特别有用，但希望它可以帮助说明和之间的区别。******`em``rem`******

 ******* * *

## 回答 #9

> 赞同：1
> 
> 时间：2020-07-14T08:33:15.363

em 和 rem 是基于字体的相对单位，将 ems 用于字体或长度是不同的，因此 ems 和 rem 都是基于字体的，但它们之间的区别在于 ems 使用**父**元素或**当前**元素作为参考，而 rems使用根字体大小作为参考。

如果我们想使用 ems 来表示字体大小，那么参考就是父代计算的字体大小，类似于百分比。

在下面的示例中，标题子元素上的 3 em 字体大小导致 72 像素，因为这是父字体大小的三倍，即 (150/100)*16=24px。现在就长度而言，它只是有点不同。标题上的 2em 填充，因为它是长度测量，使用当前元素的字体大小作为参考，我们已经知道这是 24 像素，所以 2em 将导致 48 像素填充，明白了吗？这是一个微妙的区别，但很重要。当您使用 em 时，如果它用于字体，则引用是父元素，而对于长度，引用是当前元素。

```
html,body{
font-size:16px;
width:80vw;
}
header{
font-size:150%;
padding 2em;
margin-bottom:10rem;
height:90vh;
widht 1000px;
}
header-child{
font-size:3em;
padding:10%;
} 
```

关于 rem，它实际上对字体大小和长度的工作方式相同，因为它总是只使用根字体大小作为参考。这意味着我们这里的 10 rem 填充将导致 160 像素，因为根字体大小是 16。

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-09-19T14:12:45.953

CSS 测量单位：**em**，**rem**都相对于它们的父项正面尺寸。大小将根据其父母字体大小而变化。示例：
**rem**：根元素字体大小的 100%。
**em**：父字体大小的 100%。

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2021-04-22T06:36:47.903

EM 与其直接或最近父级的字体大小相关，而 REM 仅与 html（根）字体大小相关。

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2021-05-23T11:11:04.580

当有父字体大小时，主要问题在于使用“em”和“rem”...... **这是示例：假设我想要我的网站正文的字体大小为 2em，所以我们包括 2em 字体正文中的大小被称为父字体大小......对于我的 H1，我想要一个 5.6 的大小，在我们点击保存并返回我们的网站并刷新之后，我们会注意到我们的 H1 现在变得超过5.6 . 发生这种情况是因为字体被继承并添加到它从父级获得的任何内容之上......（当我们使用 em 和百分比时会发生这个问题）所以，为了摆脱这种类型的问题，程序员使用雷姆。********

# android - 我对 NavigationUpTo() 和使用 Intent 之间的导航感到困惑

> ID：13941276
> 
> 赞同：0
> 
> 时间：2012-12-18T20:50:21.933
> 
> 标签：android, navigation

对不起我的愚蠢，我想问两个问题，但有相关的。

在谷歌阅读文档后：http: [//developer.android.com/training/implementing-navigation/ancestral.html](http://developer.android.com/training/implementing-navigation/ancestral.html) 我仍然不明白一些东西。

我想处理向上或（主页）按钮导航到一级父屏幕：

代码一：

```
Intent upIntent = new Intent(this, MyParentActivity.class);
NavUtils.navigateUpTo(this, upIntent);
return true; 
```

和代码b：

```
Intent parentActivityIntent = new Intent(this, MyParentActivity.class);
parentActivityIntent.addFlags(
        Intent.FLAG_ACTIVITY_CLEAR_TOP |
        Intent.FLAG_ACTIVITY_NEW_TASK);
startActivity(parentActivityIntent);
finish();
return true; 
```

两个代码都放在 onOptionsItemSelected(MenuItem item) 事件处理程序中。

这有什么区别？

我的第二个问题是，实际上我想在以下情况下导航：a）我有一个菜单屏幕，假设它是一个主屏幕。b) 菜单屏幕可以导航到表单屏幕以从用户那里获取信息。c) 菜单屏幕也可以导航到报告屏幕向用户显示报告。

用户完成表单屏幕后，我想直接将屏幕导航到报告屏幕，但不希望菜单屏幕因为经过它而显示一点点。

这有点像横向导航的情况，但我不确定。

希望有人帮忙。非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:16:14.263

两个片段之间的区别在于标志定义的行为。

从[文档](http://developer.android.com/reference/android/content/Intent.html)中：

> FLAG_ACTIVITY_CLEAR_TOP：
> 如果设置，并且正在启动的 Activity 已经在当前任务中运行，那么不会启动该 Activity 的新实例，而是关闭它上面的所有其他 Activity，并且此 Intent 将被传递到（现在在顶部）作为新意图的旧活动。
> 
> FLAG_ACTIVITY_NEW_TASK
> 如果设置，此活动将成为此历史堆栈上新任务的开始。

NavUtils 是一个包装器，旨在以符合人们对不同版本 Android 的期望的方式更轻松地实现主页按钮。如果您查看源代码，在 pre-jellybean 设备上它将使用 FLAG_ACTIVITY_CLEAR_TOP 标志，而*不是*FLAG_ACTIVITY_NEW_TASK 标志。在 Jellybean 设备上，它不使用任何一个标志。

对于您的第二个问题（直接从表单到报表活动），当用户在表单活动中完成表单时，创建报表活动的意图并调用 startActivity。没有理由回到家庭活动。

# database - 单独的应用程序和数据库服务器与多合一的性能

> ID：13941277
> 
> 赞同：1
> 
> 时间：2012-12-18T20:50:24.440
> 
> 标签：database, performance, ubuntu, lamp, hardware-infrastructure

我们正在迁移一个需要良好数据库设置的现有应用程序。我们在两个服务器配置上运行了一个简单的 mysqlslap 测试 - 组合的应用程序和数据库服务器，单独的应用程序和 2 个数据库服务器（主/从）：

`mysqlslap --auto-generate-sql --concurrency=50 --number-of-queries=1000 --number-char-cols=50 --number-int-cols=50 -vv`

*   即使使用相同的实例大小并从 db 服务器运行，单独服务器的结果也会变慢。
*   在另一个测试中，使用微时间和循环查询 - 服务器之间存在显着延迟。示例：测试 1 是 0.01 秒组合和 0.1 单独，0.2（组合）与 3.0（单独）相比。

我的问题：

1.  这些是预期的结果吗？
2.  有没有办法最小化服务器之间的延迟？
3.  我们无法使用 sysbench 来匹配现有服务器 - 我们执行的测试是否令人满意或者是否有更好的替代方案？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:56:42.787

不是 MySQL 专家，但是，嘿，现实并不在乎 ;)
物理是一样的。

1.  是的。你引入一个网络，有延迟。
2.  请求，批处理。保证 45 纳秒延迟。一般来说：不要提出小请求，批量。
3.  一般可能是小集。我的数据库服务器被数百人击中。1000个查询一般可能是一个小集合。

最后，你有延迟 - 处理它。做到这一点的主要方法是请求成批的数据，而不是逐行。然后了解“延迟”是一个线程的东西 - 由于容量更高，吞吐量仍然可以更高。这是一个权衡。

如果对您很好：所有较大的应用程序都会拆分，所以这不是您可以处理的事情。不过，有助于拥有一个真正的数据库服务器。基本上，这台机器应该足够强大，不会成为另一个瓶颈。你得到延迟，你也得到可扩展性。通常可扩展性比延迟更有价值。

再一次，这是物理学——这里对 MySQL 没有什么特别的。

# r - R读取前面0的数据

> ID：13941278
> 
> 赞同：0
> 
> 时间：2012-12-18T20:50:27.163
> 
> 标签：r

如何读取前面为 0 的数据，例如：

```
read.table(header=T, stringsAsFactors=F,text="
a b
1 2
3 04
") 
```

我得到了第二排 3, 4 而不是 3, 04，我应该怎么做才能保持 0 在前面，谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:58:50.267

您可以使用`read.table()`'`colClasses=`参数让它知道您要将列读取为 class 的向量`"character"`：

```
read.table(header=T, stringsAsFactors=F,
colClasses="character", 
text="
a b
1 2
3 04
")
#   a  b
# 1 1  2
# 2 3 04 
```

（或者，要将您的第一列读取为数字，而仅将第二列读取为字符，请设置`colClasses=c("numeric", "character")`）

# android - Android cmake 是否与较新的 NDK 版本兼容？

> ID：13941279
> 
> 赞同：7
> 
> 时间：2012-12-18T20:50:28.393
> 
> 标签：android, android-ndk, cmake

我有兴趣将 cmake 脚本移植到 Android，到目前为止我已经找到[了这个项目](https://code.google.com/p/android-cmake/)，问题是它看起来真的很旧，而且在安装文件中也[只有对 NDK r5b 的引用，](http://android-cmake.googlecode.com/hg/docs/INSTALL.html)它真的很老释放。

Android 有替代的构建脚本吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-19T22:08:19.173

文档从一开始就没有更新，但实际上该项目的工具链文件支持所有 NDK 版本，`r5`并`r8b`在`r8c`明确指向其位置时使用。

如果您需要完全支持 NDK`r8c`功能，包括 Clang 编译器，那么您可以从我在 GitHub 上的 fork 获取最新版本的 CMake 工具链：[https ://github.com/taka-no-me/android-cmake](https://github.com/taka-no-me/android-cmake)

# php - 如何解压缩 tar.gz 字符串

> ID：13941285
> 
> 赞同：1
> 
> 时间：2012-12-18T20:50:46.930
> 
> 标签：php, tar, gzip, compression

我有一个字符串，它是 tar.gz 压缩文件的内容（如果有的话，文件名将是 tar.gz）。它以 JSON 格式传递给我，并且字符串是 base64 编码的。

我已经设法从 base64 解码字符串，现在剩下一个 tar.gz 字符串。有谁知道我在不创建临时文件然后使用 system('tar -zxvf ...') 的情况下将其提取到内存的方法？它认为这样做真的会浪费资源，但是如果我无法弄清楚，我想我将不得不创建一个文件并使用 system().

里面只有一个文件（xml文件），所以它不是多个文件。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:12:31.150

您可以使用[proc_open](http://php.net/proc_open)和管道将文件流式传输到 tar 的标准输入。这是一个来自 php.net 的稍微改编的示例

```
$descriptorspec = array(
   0 => array("pipe", "r"),  // stdin is a pipe that the child will read from
   1 => array("pipe", "w"),  // stdout is a pipe that the child will write to
   2 => array("file", "/tmp/error-output.txt", "a") // stderr is a file to write to
);

$process = proc_open('tar xz', $descriptorspec, $pipes, __DIR__, $env);

if (is_resource($process)) {
    // $pipes now looks like this:
    // 0 => writeable handle connected to child stdin
    // 1 => readable handle connected to child stdout
    // Any error output will be appended to /tmp/error-output.txt

    fwrite($pipes[0], $tar_gz_string);
    fclose($pipes[0]);

    echo stream_get_contents($pipes[1]);
    fclose($pipes[1]);

    proc_close($process);
} 
```

# tomcat - 使用 Struts2 的 Tomcat 数据库连接池

> ID：13941289
> 
> 赞同：0
> 
> 时间：2012-12-18T20:51:04.887
> 
> 标签：tomcat, struts2

使用 Struts2、Tomcat 7 和 oracle 数据库开发应用程序。现在我已经为每个操作设置了简单的 JDBC 连接，但我想使用连接池。我尝试遵循以下教程，因为我找不到专门针对 Struts 2 的教程：http:
[//viralpatel.net/blogs/database-connection-pooling-tomcat-eclipse-db/](http://viralpatel.net/blogs/database-connection-pooling-tomcat-eclipse-db/)

将它与 Struts2 一起使用需要哪些添加/更改？我可以只调用 doGet() 并让它返回一个字符串来显示相应的网页（就像典型的执行方法一样）吗？

或者是否有在 Struts2 应用程序中管理数据库连接的替代方法？（不使用其他框架，例如 Spring 或 Hibernate）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:58:38.150

数据库连接与 Struts 无关。[Tomcat 文档](http://tomcat.apache.org/tomcat-7.0-doc/jndi-datasource-examples-howto.html)中详细说明了正确的方法。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T09:19:38.440

即使您*可以*直接管理（付出很大的努力）您自制的连接池，

通常`Connection Pooling`由应用服务器以透明的方式执行。

您可以在 Tomcat 上或直接从应用程序配置 DataSource，[如本文所述](http://theopentutorials.com/examples/java-ee/servlet/servlet-jndi-datasource-in-tomcat/)。

# javascript - 没有在 jsTree 的元素中获得一个类来悬停？

> ID：13941296
> 
> 赞同：0
> 
> 时间：2012-12-18T20:51:38.060
> 
> 标签：javascript, html, jstree

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T03:15:27.163

我想到了。这是一个愚蠢的问题。我在主题中放置了“UI”而不是“ui”。我从某个地方复制了它，他们把它作为大写字母。奇怪的。

# javascript - .options[e.selectedIndex].innerHTML 没有获取价值

> ID：13941298
> 
> 赞同：0
> 
> 时间：2012-12-18T20:51:48.897
> 
> 标签：javascript, html

我有一个带有 id 的选择字段的表单。我想在 javascript 函数中获取选定的值。第一次运行此函数时，它不会获取所选值，但第二次运行该函数时，它会获取该函数。我试过.text，这不起作用。非常感谢您的帮助。

```
var e = document.getElementById("to");
var str = e.options[e.selectedIndex].innerHTML; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:05:48.357

那么第一次运行，是在元素渲染之前运行吗？如果是这样，您必须等待 document.ready 或页面加载事件。

获取选择元素的文本和值的工作示例

**HTML**

```
<select id="foo">
    <option value="1">One</option>
    <option value="2">Two</option>
    <option value="3">Three</option>
</select>
<button id="bar">Console it</button> 
```

**JavaScript**

```
function getText() {
    var sel = document.getElementById("foo");        
    var option = sel.options[sel.selectedIndex];
    //assuming that there is always a selection
    var text = option.text;
    var value = option.value;
    console.log(text, value);
}

document.getElementById("bar").onclick = getText;

getText(); 
```

​</p>

[工作示例](http://jsfiddle.net/dVR48/)在小提琴中，您可以看到它在尝试读取值时正在运行 onload。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:08:56.223

尝试将它放在 onReady 函数中。也许 JS 在页面完全加载之前正在运行？如果您使用 jQuery：

```
$(document).ready(function(){
    alert($("#to option:selected").text());
)}; 
```

# c# - 在 2 个表上加入测试记录

> ID：13941301
> 
> 赞同：2
> 
> 时间：2012-12-18T20:52:00.283
> 
> 标签：c#, linq

我有两个表，`FruitInventory`和`PeachInventory`，它们有以下列：

```
FruitInventory 
FruitID | UserID | ....

PeachInventory
PeachID | FruitID | ... 
```

我想根据用户是否在 PeachID 的 FruitID 上获得授权来测试用户是否有权访问某个 PeachID。

为了测试他是否在 FruitID 上获得授权，我目前正在做这样的事情：

```
public bool GetUserAuthorizedOnFruitID(int TheUserID, long TheFruitID)
{
   using (MyDataContext TheDC = new MyDataContext())
   {
      bool IsAuthorized = false;

      IsAuthorized = TheDC.FruitInventory
                          .Any(f => f.FruitID == TheFruitID && 
                                     f.UserID == TheUserID);

      return IsAuthorized;
   }
} 
```

我知道我可以执行第二个查询，该查询将在此查询之后执行，它将检查 ThePeachID 是否是 TheFruitID 的一部分，但我想知道如何使用返回布尔值的连接在一个查询中进行授权。

函数签名将是：

```
public bool GetUserAuthorizedOnPeachID(int TheUserID, long ThePeachID) 
```

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:12:26.410

根据您拥有的内容使用以下架构：

![在此处输入图像描述](../Images/38c057223a6f45efafd7ccb84d5d17bf.png)

您可以使用此功能/查询：

```
public bool GetUserAuthorizedOnPeachId(int userid, int peachId)
{
    using(var context = new MyDataDataContext())
    {
        bool isAuthorized = false;
        isAuthorized = (from p in context.PeachInventories.Where(p => p.PeachId == peachId)
                                    join f in context.FruitInventories.Where(f => f.UserId == userid) on p.FruitId equals f.FruitId select p).Any();

        return isAuthorized;

    }
} 
```

您还可以在 LINQ 中使用链，如下所示：

```
public bool GetUserAuthorizedOnPeachIdUsingAChainQuery(int userid, int peachId)
{
    using (var context = new MyDataDataContext())
    {
        bool isAuthorized = false;

        isAuthorized = context.PeachInventories.Where(p => p.PeachId == peachId)
                        .Join(context.FruitInventories.Where(f => f.UserId == userid), p => p.FruitId, f => f.FruitId, (p, f) => f).Any();

        return isAuthorized;

    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:05:52.723

从内存中执行此操作：

```
IsAuthorized = (from f in TheDC.FruitInventory
                join p in TheDC.PeachInventory on p.FruitID equals f.FruitID
                where f.UserID == TheUserID
                   && p.PeachID == ThePeachID
                select p.PeachID).Any() 
```

这将通过加入水果 ID 上的水果库存来检查用户是否可以访问给定的桃子。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T21:13:37.403

这是链中 linq 查询的解决方案。

```
bool exists = TheDC.PeachInventory.Join(TheDC.PeachInventory, 
                             peach=> peach.FruitID,
                             fruit=> fruit.FruitID,
                             (peach, fruit) => fruit).Any(f => f.FruitID == TheFruitID &&                                                         
                                                          f.UserID == TheUserID) 
```

# php - Joomla 麻烦 strtotime()

> ID：13941303
> 
> 赞同：0
> 
> 时间：2012-12-18T20:52:11.733
> 
> 标签：php, joomla

joomla 发生了一些奇怪的事情......有人可以帮助我吗？

这是错误：

警告：strtotime() [function.strtotime]：依赖系统的时区设置是不安全的。您*需要*使用 date.timezone 设置或 date_default_timezone_set() 函数。如果您使用了这些方法中的任何一种，但仍然收到此警告，您很可能拼错了时区标识符。我们在第 56 行的 /home/fundacio/public_html/libraries/joomla/utilities/date.php 中为 'CLST/-3.0/DST' 选择了 'America/Santiago'

这是网站：www.fundacioncasadelafamilia.cl

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T01:54:17.597

这是 PHP 更改，而不是 Joomla 更改。PHP 5.3.0 需要正确设置 date.timezone ini 条目以避免发出警告。在 PHP 5.3.0 之前，该行存在于 PHP ini 中，但通常被注释掉。

如果您无法让您的主机更改此设置，您还可以在主 Joomla 安装的 index.php 文件或模板文件中添加：

```
date.timezone = "America/Anchorage" 
```

但是，这会在 Joomla 更新中被覆盖，因此 php.ini 更改更可取！另外，如果是托管问题，我怀疑许多主机客户会看到此消息！

希望这可以帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T02:42:45.817

尝试这个

在 joomla 我们有一个选项可以在后端设置默认时区（管理员部分）设置他们需要的区域并使用下面的代码在 php 中设置它

```
//setting the default time zone
$config = JFactory::getConfig();
date_default_timezone_set($config->getValue('config.offset')); 
```

此代码可以放置在您的 root/includes/framework 或任何根级别文件中，它将覆盖任何地方。

希望对你有帮助..

# php - mysql查询条件适用于int但不适用于字符串

> ID：13941308
> 
> 赞同：1
> 
> 时间：2012-12-18T20:52:33.420
> 
> 标签：php, mysql, sql

查询是

```
$sql = "update students set status = 'active', student_password='{$password}' where student_id ='".$_GET['id']."'"; 
```

它显示结果为

```
update students set status = 'active', student_password='50d0d53f546b7' where student_id ='112s23dd' 
```

错误来了

```
Unknown column '112s23dd' in 'where clause' 
```

当我在 where 子句中输入任何 int 值时，它可以正常工作，但不能在字符中工作，student_id 是主键 varchar(30)
另一个奇怪的事情，当我将它粘贴到 phpmyadmin 时它正在工作，但当我执行它时不起作用网页

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:00:57.313

看起来您发现了一个错误：

[http://www.sqlfiddle.com/#!2/56e3e/1](http://www.sqlfiddle.com/#!2/56e3e/1)

如果您可以尝试将代码直接运行到 PHPMyAdmin 中进行测试，请向我们提供您的 Mysql 版本，这样会更好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:29:23.977

我已经对您提供的数据做了一个[修改](http://sqlfiddle.com/#!2/f4119/1)。您的查询工作得很好。我认为问题可能出在您尚未更新网站上的数据库或同时更改“student_id”列的类型。请仔细检查服务器上的数据库。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:32:12.063

试试这个：

```
 mysql_query("update `students` set `status`='active', `student_password`='{$password}' where `student_id`='" . mysql_real_escape_string($_GET['id']) . "'") or die(mysql_error()); 
```

通过使用它，您将获得此查询未执行的原因。

# jquery - jQuery mobile 如何将单个按钮主题应用于所有按钮

> ID：13941311
> 
> 赞同：2
> 
> 时间：2012-12-18T20:52:39.500
> 
> 标签：jquery, css, mobile, button

我希望我所有的 (data-role="button") 的主题都是 ( `data-theme="b"`) 浅蓝色..

我知道编写 jQuery 的人不会认真地浪费他们的生命来重新输入数千次。那么它是否像定义了 .css 属性一样应用，我只需要将它放在我的标题中或将另一个 .js 文件链接到它？

在 CSS 中，我知道它看起来`.button { data-theme: b; }`很容易。聪明的人通过在一个地方完成需要一遍又一遍地重复的任务来节省时间。

但在 jquery 中，它似乎总是写成..

```
<div data-role="navbar">
    <ul>
        <li><a href="#home" data-role="button" data-icon="home" data-theme="b">Home</a></li>
        <li><a href="#" data-role="button"data-icon="arrow-r" data-theme="b">Blog</a></li>
        <li><a href="#videos" data-role="button" data-icon="arrow-r" data-theme="b">Videos</a></li>
        <li><a href="#photos" data-role="button" data-icon="arrow-r" data-theme="b">Photos</a></li>
        <li><a href="#tweets" data-role="button" data-icon="arrow-r" data-theme="b">Tweets</a></li>
    </ul>
</div> 
```

有没有办法解决这个问题，或者将其保留为默认主题是否更聪明？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:02:15.493

您应该能够通过结合`<a>`标签和`button`属性的 JQuery 选择器来实现这一点。

```
$("a[data-role='button']").attr("data-theme","b"); 
```

**编辑**

显然，刷新 JQuery Mobile 主题可能有点棘手。[在 SO 上被问了几次](https://stackoverflow.com/questions/5562461/refresh-a-section-after-adding-html-dynamically-to-jquery-mobile)；[这里有一些信息。来自 JQM 常见问题解答](http://jquerymobiledictionary.pl/faq.html)。

# fonts - openGL 中的字体

> ID：13941312
> 
> 赞同：0
> 
> 时间：2012-12-18T20:52:41.960
> 
> 标签：fonts

我是 C++ 的新手，我正在尝试制作自己的字体绘图功能因此，我有一个字体类，其中包含许多像这样的 Image 对象：

```
 Image A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q, R, S, T, U, V, W, X, Y, Z;
  Image a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z;
  Image n0, n1, n2, n3, n4, n5, n6, n7, n8, n9; 
```

我将从单个大图像文件中填充字符图像，并根据需要将它们绘制到四边形上。现在，显而易见的解决方案是将所有这些都保存在地图中。但是，我担心性能问题必须遍历整个地图以为每一帧显示的每个字符寻找正确的字母。

这里有什么捷径吗，还是仅此而已？

请注意，我知道那里可能有大量免费和开源的 opengl 文本绘图库，但我这样做是为了练习。我对当前问题的有效解决方案感兴趣，不一定是更好但完全不同的解决方案。除非我的方法在某种程度上根本上是错误的，否则就是这样。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T00:49:50.117

每当您发现自己编写了 62 个相同的变量定义时，都应该强烈暗示您正在做一些根本错误的事情。

字符代码是非常好的数组索引。或者，至少当 ASCII 是唯一的字符集并且最大值是 255 时，他们这样做了。在这些 Unicode 时代，您需要对分配的范围更加小心，但是从您的示例代码中您不感兴趣无论如何，除了字母数字。

由于您将此作为学习练习，因此在转换为数组后，请考虑将所有字符形状放在单个图像中（有时称为罢工）并仅存储每个字符的像素坐标，而不是整个图像。

# jquery - jqgrid没有正确渲染mvc 4

> ID：13941313
> 
> 赞同：1
> 
> 时间：2012-12-18T20:52:42.627
> 
> 标签：jquery, asp.net-mvc, jqgrid

我正在将我的 mvc 3 代码复制到一个 mvc 4 应用程序，我注意到我的 jqgrid 代码部分不再正确呈现。正如您在图像中看到的那样，缺少分页器，并且列名远大于默认的 jqgrid 设置。关于如何解决这个问题的任何想法？

**图片**

![奇怪的jqgrid渲染](../Images/cf7bab1abb0b0916b94f96dbc4eccec4.png) **代码**

```
<link href="@Url.Content("~/Content/jqgrid/ui.jqgrid.css")" rel="stylesheet" typpe="text/css" /> 

<script src="@Url.Content("~/Scripts/jquery-1.8.3.min.js")" type="text/javascript"></script>     
<script src="@Url.Content("~/Scripts/jquery-ui-1.9.2.cupertino.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/grid.locale-en.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.jqGrid.min.js")" type="text/javascript"></script>

<script type="text/javascript">
    jQuery(document).ready(function () {
        var id = 0;
        jQuery("#tblUsers").jqGrid({
            url: '/Configuration/GetUsers/',
            datatype: 'json',
            mtype: 'POST',
            colNames: ['User Name', 'Role'],
            colModel: [
                { name: 'User Name', index: 'User Name', width: 90, align: 'left' },
                { name: 'Role', index: 'Role', width: 80, align: 'left' }],
            //pager: jQuery('#pager'),
            width: 700,
            height: 200,
            rowNum: 20,
            rowList: [5, 10, 20, 50],
            sortname: 'User Name',
            sortorder: "desc",
            viewrecords: true,
            imgpath: '',
            caption: 'Users'
        });

        jQuery("#tblUsers").jqGrid('navGrid', '#pager',
        {
            editfunc: function (rowid) {
                //$('#dialogEdit').data('id', rowid);
                //$('#dialogEdit').dialog('open');
            },
            addfunc: function () {
                //$('#dialog').dialog('open');
            },
            delfunc: function (rowid) {
                //$('#dialogDelete').data('id', rowid);
                //$('#dialogDelete').dialog('open');
            }
        }, //options
        {}, // edit options 
        {}, // add options 
        {}, // del options
        {} // search options
        );
    });
</script>

<table id="tblUsers" class="scroll" cellpadding="0" cellspacing="0"></table>
<div id="pager" class="scroll" style="text-align:center;"></div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T20:55:30.107

您可能缺少此工作所需的 CSS 文件。有几件事要检查。

*   您是否复制了主题和其他相关的 css 文件？
*   如果您在 3 中将事物捆绑在一起，则 ASP.NET MVC 4 使用不同的捆绑过程。

# ios - 从 iOS 应用发布带有文字的照片

> ID：13941314
> 
> 赞同：1
> 
> 时间：2012-12-18T20:52:42.890
> 
> 标签：ios, facebook, facebook-graph-api, facebook-ios-sdk

我想从我的应用中发布图片+文字。我现在所做的 - 我只是将照片发布到用户的相册。但是没有指向我的应用程序的链接，我看不到它等等。我想在带有照片的文本中提及我的 Facebook 页面，所以我会收到通知。或者至少链接到我的网站，所以喜欢这篇文章的人可以去那里。

理想的方式是 Runkeeper 是如何做到的： ![跑卫截图](../Images/413cf56e65d4d246c89861f68f7fc77b.png)

我喜欢它有链接 RunKeeper，底部有 RunKeeper 的小图标，也有指向他们网站的链接。

或者，我很乐意发布带有文字的照片并链接到我的 Facebook 页面或外部页面。像这样的东西： ![在此处输入图像描述](../Images/e2ce4b16354d84d885014814efcfed00.png)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2012-12-18T21:24:20.127

[使用Facebook 的 SDK](http://developers.facebook.com/ios/)非常简单。

您需要在 Facebook 中设置一个应用程序以链接到您的手机应用程序，在那里您可以使用您的图标和链接。

```
 NSMutableDictionary *postParams = @{ @"message" : <#Your Message#>,
                                      @"app_id" : <#Your AppId#>,
                                      @"picture" : <#Your Image#>,
                                      @"link" : <#Your App Link#>,
                                      @"name" : <#Your App Name#>,
                                      @"caption" : <#Your Caption#>,
                                      @"description" : <#Your Description#>
                                   };

[FBWebDialogs presentFeedDialogModallyWithSession:self.session parameters:postParams handler:^(FBWebDialogResult result, NSURL *resultURL, NSError *error) {
      <#Your Completion handler#>} 
```

# c# - 搜索相等对象的集合

> ID：13941316
> 
> 赞同：0
> 
> 时间：2012-12-18T20:52:48.503
> 
> 标签：c#

如何搜索泛型集合以查看对象的属性是否相等？

```
List<Customer> = customers = GetCustomers();

Customer c = new Customer() { FirstName = "Sam" };

customers.Contains(c); //doesn't work 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T20:54:29.990

您需要为对象定义“平等”。您可以通过多种方式做到这一点。

1.  覆盖自身的`Equals`方法`Customer`，以便它使用您认为的相等性。
2.  定义一个自定义比较器，它实现`IEqualityComparer`了您可以传递给 contains。如果您需要在不同时间使用不同的“平等”定义，或者如果您没有修改类型的能力，请执行此操作。

请注意，任何时候您覆盖`Equals`一个类型时，覆盖也很重要`GetHashCode`，反之亦然。确保被定义为相等的任何对象`Equals`也具有相同的哈希码是很重要的。在这种特殊情况下无关紧要，但在使用基于散列的数据结构时会很重要。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:12:46.660

覆盖 Equals、实现 IEqualityComparer 和覆盖 GetHashCode 需要一些工作。

如果你有 Resharper，你可以[生成这些方法](http://www.jetbrains.com/resharper/documentation/help20/AdvEditing/generateEquals.html)。

唯一一次我会覆盖 Equals、实现 IEqualityComparer 和覆盖 GetHashCode 是如果我计划在整个应用程序中比较客户。可能还有其他一些原因，例如排序。

如果您只在一个位置进行比较，则 LINQ 扩展为您提供强大的集合方法来查找和检索项目。在去覆盖 Equals 方法的麻烦之前，我会先看看那里。

```
[TestFixture]
public class ContainsTest
{
    [Test]
    public void TestFind()
    {
        var customers = new List<Customer>
                            {
                                new Customer() {FirstName = "Chuck"},
                                new Customer() {FirstName = Path.GetRandomFileName()},
                                new Customer() {FirstName = Path.GetRandomFileName()},
                                new Customer() {FirstName = Path.GetRandomFileName()},
                                new Customer() {FirstName = Path.GetRandomFileName()},

                            };

        //Get all objects that match
        var findResult = customers.Find(c => c.FirstName =="Chuck");
        var findSingle = customers.Single(c => c.FirstName == "Chuck");

        //Has at least one instance
        customers.Any(c => c.FirstName.Contains("Chuck"));
    }

    public class Customer
    {
        public string FirstName { get; set; }
    }
} 
```

# scala - Scala 最佳实践：简单的 Option[] 用法

> ID：13941317
> 
> 赞同：9
> 
> 时间：2012-12-18T20:52:55.137
> 
> 标签：scala, null

作为一个 Java 到 Scala 的切换器，我经常发现自己重写 null 处理的东西，比如

```
val itemOpt: Option[Item] = items.get(coords) // "items" is something like a Map
if (itemOpt.isDefined) {
  val item = itemOpt.get
  // do something with item, querying item fields a lot of times, for example
  if (item.qty > 10) {
    storeInVault(item.name, item.qty, coords)
  } else {
    storeInRoom(item)
  }
} 
```

我猜它看起来很难看，它看起来*真的*像一段从 Java 重写的代码：

```
Item item = items.get(coords);
if (item != null) {
  // do something with item, querying item fields a lot of times, for example
} 
```

它在 Java 中看起来也很丑陋，但至少少了一行。在 Scala 中处理这种简单案例的最佳实践是什么？我已经知道`flatMap`并`flatten`处理 的集合`Option[Stuff]`，并且我知道`getOrElse`处理默认值。我梦想着这样的事情：

```
items.get(coords).doIfDefined(item =>
  // do stuff with item
) 
```

但我在`Option`API 中看不到类似的东西。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T20:59:13.263

非常流行的使用模式：

```
val item: Option[Int] = None
val result = item map (_ + 1) getOrElse 0 
```

因此，如果已定义，您只需使用`map`它来转换值。

如果您只想使用存储在 中的值`Option`，那么只需使用`foreach`：

```
item foreach { it =>
    println(it)
} 
```

如您所见，`Option`它还支持多种收集方法，因此您实际上不需要学习新的 API。您可以将其视为具有 1 个或 0 个元素的集合。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2012-12-18T20:56:35.523

这应该完成您想要做的事情：

```
items.get(coords).foreach{ item => 
  //do stuff
} 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2012-12-19T00:06:30.567

检查这个托尼莫里斯[帖子](http://blog.tmorris.net/scalaoption-cheat-sheet/)。当我试图理解 Option 时，它对我帮助很大。您的代码可能会以这种方式重写：

```
for (item <- items.get(coords)) { // "items" is something like a Map
  // do something with item, querying item fields a lot of times, for example
  if (item.qty > 10) {
    storeInVault(item.name, item.qty, coords)
  } else {
    storeInRoom(item)
  }
} 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-12-19T01:00:27.713

此外，Option 可用于带有`if`保护的模式匹配。我个人喜欢在这种情况下使用它，并且认为它更易于阅读。

因为`map`on a Option 只有在 Option is not 时才会生效`None`，所以你可以先这样做，然后使用 Pattern Matching 来检查你的 itemOpt 是否是 a`Some`或`None`。

```
def shouldInVault(item: Item) = item.qty > 10

val itemOpt: Option[Item] = items.get(coords).map(...)

itemOpt match {
    case Some(item) if shouldInVault(item) => storeInVault(item.name, item.qty, coords)
    case Some(item) => storeInRoom(item)
    case None =>
} 
```

# jquery - 如果tinymce包含特定单词，请检查jquery

> ID：13941320
> 
> 赞同：0
> 
> 时间：2012-12-18T20:53:07.300
> 
> 标签：jquery, tinymce

如果其中的文本包含特定单词，我想检查tinymce textarea，如果是，则将其颜色更改为红色。

```
$(".show_words").click(function(){
$("#content tinymce.get('textarea_id').getContent():contains('word')").css("color","red");
}); 
```

不幸的是，什么也没有发生。如何正确编写此命令？谢谢

编辑：HTML：

```
<div id="content">

<input type="button" value="show words" class="show_words"/><br/>
<textarea name="drug_description" id="textarea_id" cols="50" rows="15"></textarea>
</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:40:09.123

`tinymce.get('textarea_id').getContent()`返回一个 html 字符串（确保实际设置`textarea_id`）。您可以使用 vanilla javascript 来搜索它。

```
if(tinymce.get('textarea_id').getContent().search("word")) {
    $("#content").css("color", "red");
} 
```

# c# - C# 流布局面板

> ID：13941321
> 
> 赞同：0
> 
> 时间：2012-12-18T20:53:10.073
> 
> 标签：c#, flowlayoutpanel

我希望能够在表单中添加一些进度条（进度条的数量可能因用户而异）。

我编写了这段代码来添加 1 个进度条：

```
 ProgressBar progressbar = new System.Windows.Forms.ProgressBar();
        progressbar.Name = "progressBar1";
        progressbar.Size = new Size(280, 30);
        progressbar.TabIndex = 9;
        progressbar.Show();
        flowLayoutPanel.Container.Add(progressbar); 
```

当我运行此代码时，我得到一个 Exception: `"Object reference not set to an instance of an object."`。困扰我的是，当我使用 IDE 查看进度条和 flowLayoutPanel 时，它们都不为空。我做错了什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T20:57:57.330

我猜`flowLayoutPanel.Container`是空的。我想你想要

```
flowLayoutPanel.Controls.Add(progressbar); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T20:56:38.933

```
progressbar.Show(); 
```

这条线不应该是必要的

你以前放过这段代码`InitializeComponents`吗？then`flowLayoutPanel`为 null，因为在此函数中，所有表单元素都已初始化

然后，子元素在`FlowLayoutPanel.Controls`，而不是容器

# php - CakePHP 模型保存到错误的表

> ID：13941323
> 
> 赞同：4
> 
> 时间：2012-12-18T20:53:24.780
> 
> 标签：php, cakephp

在我的用户模型中，我有以下关系：

```
public $hasAndBelongsToMany = array(
        'User'=>array(
            'className'              => 'User',
            'joinTable'              => 'friends',
            'with'                   => 'Friend',
            'foreignKey'             => 'user_id',
            'associationForeignKey'  => 'friend_id'
        )
); 
```

它将用户链接到用户作为朋友。但是，当我对单个用户执行某些操作时，例如更改密码或编辑用户详细信息（与朋友无关），它将开始在朋友表中执行操作，例如删除所有现有记录，然后添加空数据行。 .

我是不是把关系搞错了？命名是否应该不同，这样我在处理`$this->User`它时就不会触动朋友？

**编辑：自从发布此问题以来，我已将 user_id 和friend_id 更改为 user1_id 和 user2_id 以防止 Cake 通过假设它们是主键或 nIcO 下面解释的任何内容来对字段进行任何自动操作。但是同样的问题还是会发生！**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T21:07:51.733

我强烈建议使用真正的 Friends 模型进行此操作。像这样设置它：

```
User hasMany FriendList
User hasMany FriendOf (alias of FriendList)

FriendList belongsTo User
FriendList belongsTo Friend (alias of User) 
```

示例代码：

```
Table definitions (skeleton):

users:
  id
  name

friend_lists:
  id
  user_id
  friend_id

Model Definitions:

class User extends AppModel {
  var $hasMany = array(
    'FriendList',
    'FriendOf' => array(
      'className' => 'FriendList',
      'foreignKey' => 'friend_id'
    )
  );
}

class FriendList extends AppModel {
  var $belongsTo = array(
    'User',
    'Friend' => array(
      'className' => 'User',
      'foreignKey' => 'friend_id'
     )
  );
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:47:00.420

您的连接表被调用`friends`并使用名为 的模型`Friend`。通过查看 HABTM 关系声明，该`friends`表似乎包含一个名为的字段`user_id`和一个名为 的字段`friend_id`。

在表中拥有一个`friend_id`字段`friends`就像在表中拥有一个`user_id`字段`users`，您可能不会这样做。而且我猜 Cake 不喜欢它，因为`friend_id`Cake 将其视为指向*另一个*名为`Friend`.

无论如何，使用 HABTM 关系处理同一张表之间的 HABTM 并不容易（参见[HABTM with self 需要 2x 连接表中的行？](https://stackoverflow.com/questions/12232011/habtm-with-self-requires-2x-the-rows-in-join-table)），您可能应该改用连接模型（参见[http://book.cakephp.org/ 2.0/en/models/associations-linking-models-together.html#hasmany-through-the-join-model](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasmany-through-the-join-model) )

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-20T21:17:27.117

不要创建与 hasAndBelongsToMany 关系中使用的模型具有相同别名/名称的模型。这让我对 CakePHP 感到头疼。

例如;

我有一个名为“公司”的模型，HABTM“用户”记录。所以我的数据库中有一个名为“companyies_users”的表。

您可能很想在您的公司模型中做这样的事情。

```
var $hasAndBelongsToMany = array(
    'User'=>array('with'=>'CompanyUser')
); 
```

然后创建一个“CompanyUser”模型，因为你想在关联中存储额外的数据。

不要这样做。我不知道为什么，但 Cake 无法预测它何时会自动创建一个名为“CompanyUser”的模型以及何时会实际加载您创建的 PHP 文件。

最好在您的模型中定义 HABTM 以使用默认关联，然后从表中创建一个**不同**名称的模型，并使用它来处理记录。这确保 CakePHP 也将使用自动生成的模型并正常工作。

因此，在我的示例中，我创建了一个名为“Members”的模型，将“useTable”变量设置为“companies_users”。

现在我知道当我使用“公司”模型时，CakePHP 会正确处理 HABTM，如果我需要访问那些连接记录，那么我会使用“成员”模型。

使用“with”选项的风险是你永远不知道 CakePHP 什么时候会失败，并自动生成模式。在这种情况下，您的任何回调或行为都不会发生。

编辑：

更直接地回答这个问题。

修改 User.php 模型文件，以便 HABTM 使用更多默认值。

```
 public $hasAndBelongsToMany = array('Friend'); 
```

确保您没有为连接表定义 UserFriend.php 模型文件。如果您需要修改连接表，请使用具有不同别名的模型指向数据库中的该表。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-24T13:33:59.660

我猜你的问题是由于错误地声明了关联引起的。试试这个：

```
public $hasAndBelongsToMany = array(
        'Friend'=>array(
            'className'              => 'Friend',
            'joinTable'              => 'friends',
            'foreignKey'             => 'user_id',
            'associationForeignKey'  => 'friend_id'
        )
); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-24T18:41:26.827

有几种方法可以实现友谊关联，因为友谊中有两个方向。可以说用户 A 是用户 B 的好友，也可以说用户 B 是用户 A 的好友。

当一个人在数据库中建立友谊时。您必须在连接表中创建两条记录来表示双向的这种友谊（假设您想要双向）。

这涵盖了方向的概念。

您可能会遇到记录消失的问题，因为默认情况下，CakePHP 会在记录更新时擦除记录的所有连接数据行。查看 HABTM 上“唯一”选项的描述。

> **unique**：如果为true（默认值），更新记录时，蛋糕将首先删除外键表中现有的关系记录，然后再插入新的关系记录。所以更新时需要再次传递已有的关联。

这意味着您必须在更新记录时始终包含 HABTM 数据。否则，这些记录将被删除，并根据通过的内容进行更新。

现在，您可以创建的最基本的友谊设置将涉及两个表。

```
CREATE TABLE `users` (
   `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
   `name` varchar(45) NOT NULL,
   PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1;

CREATE TABLE `users_users` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(10) unsigned NOT NULL,
  `friend_id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `user` (`user_id`),
  KEY `friend` (`friend_id`)
) ENGINE=InnoDB DEFAULT CHARSET=latin1; 
```

第一个表'users'将保存我们的用户数据，第二个'users_users'是HABTM连接表。请注意名称，它是 users_users 因为它自己加入。

您仍然需要在 CakePHP 中创建两个模型。

第一个是 User.php，它将描述系统中的用户。我们将主要使用 CakePHP 中的默认值来使其工作。因此，HABTM 只是一行“朋友”。

```
class User extends AppModel
{
    var $name = 'User';
    var $hasAndBelongsToMany = array(
          'Friend'
    );
} 
```

现在，CakePHP 会抱怨表 users_friends 丢失了。我们需要创建一个 Friend 模型，但将其指向 users 表。

```
class Friend extends AppModel
{
    var $name = 'Friend';
    var $useTable = 'users';
} 
```

现在 CakePHP 将使用 users_users 表作为连接。Friend 模型现在描述了作为朋友的用户。

重要的是要了解您必须在两个方向上创建朋友。当您为用户 A 保存数据时说他/她是用户 B 的朋友，那么您还必须保存用户 B 并说他/她是用户 A 的朋友。否则，只有一个用户将定义好友关系。

这里还有另一个答案，它使用别名定义了友谊的双重方向，但我建议不要实现它，因为它为 CakePHP 增加了您的应用程序可能不需要的额外 SQL 查询工作。当您阅读用户 A 的记录时，您只需要知道他们的朋友是谁，反之则不需要。

您可以创建一个行为，以确保在更新用户记录时友谊是双向的。那会更有效率。

> **注意：**我的代码示例适用于我目前正在使用的 CakePHP **1.3 ，但它在 2.x 中应该可以正常工作。**

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2012-12-26T10:46:43.830

根据 Cakephp HABTM 文档，

> HABTM 数据被视为一个完整集，每次添加新的数据关联时，数据库中的完整关联行集都会被删除并再次创建，因此您始终需要传递整个数据集以进行保存。

从 2.1 开始，与

> 您可以设置独特的设置来保持现有的规避在保存操作期间丢失额外的数据。IE，

```
public $hasAndBelongsToMany = array(
        'User' => array(
                ....
                'unique' => 'keepExisting',
                ....
        ),
); 
```

[http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasmany-through](http://book.cakephp.org/2.0/en/models/associations-linking-models-together.html#hasmany-through)

# twig - 即使定义了变量，Twig 也会在“如果变量被定义”中运行

> ID：13941324
> 
> 赞同：5
> 
> 时间：2012-12-18T20:53:28.690
> 
> 标签：twig

我想在设置变量时包含一个模板。未设置变量时，不得包含模板。

```
{% if data is defined %}
    {% block content %}
        {% include 'data.html.twig' with  { 'data' : data} %} {# Line 14 #}
    {% endblock %}  
{% endif %} 
```

但是这个检查不起作用。`data`未定义时会发生错误：

```
 Twig_Error_Runtime: Variable "data" does not exist in "text.html.twig" at line 14 
```

`data`但是 Twig 在定义时必须跳过该行。谁能解释这种行为，更重要的是：我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-18T22:53:47.957

感谢我的室友，我找到了解决方案。`if`必须在`block`. 我仍然不知道为什么需要这样做。

```
 {% block content %}
    {% if data is defined %}
        {% include 'data.html.twig' with  { 'data' : data} %} {# Line 14 #}
   {% endif %}
{% endblock %} 
```

# api - Trello API：updateCard:idList 过滤器不返回任何卡片

> ID：13941326
> 
> 赞同：0
> 
> 时间：2012-12-18T20:53:37.803
> 
> 标签：api, trello

使用 Trello API，“filter=updateCard:idList”似乎不起作用？如果我关闭 ":idList"，它会返回我的卡片。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T12:43:38.280

根据我的经验，他们的系统在移动卡片时只生成一个通用的 updateCard 动作。为了充实[我的 .Net 包装器](https://nuget.org/packages/Manatee.Trello/)的属性，我已经玩了很多次，但似乎无法确定如何生成该特定操作。

鉴于此，我会说过滤器工作正常，但特定的操作类型并未应用于任何操作，因此不会产生任何结果。

# android - 添加 EDITTEXT 作为子菜单选项 android

> ID：13941331
> 
> 赞同：1
> 
> 时间：2012-12-18T20:53:56.713
> 
> 标签：android, xml, android-edittext, submenu

我在 XML 菜单文件中定义了我的子菜单（它有效）。我的意图是添加一个 EDIT 选项和一个 View 选项。我想为 EDIT 选项使用 EDITTEXT。如何将 EDIT 文本链接到我的子菜单？先感谢您。

如果我问的是非常简单的问题，请耐心等待:)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:31:27.373

我不建议在菜单中使用 EditText *，*这工作量太大，而且您偏离了 Android 菜单的默认功能。相反，我要做的是使“编辑”选项单独启动`Activity`或显示`Dialog`带有`EditText`. 在这两者中，我建议使用[DialogFragment](http://developer.android.com/reference/android/support/v4/app/DialogFragment.html)显示一个 Dialog ，这是您可以做的最简单的方法。[这篇](http://android-developers.blogspot.ca/2012/05/using-dialogfragments.html)Android 开发博客文章提供了一个教程。基本上，您必须为 DialogFragment 制作自己的布局（您可能需要一个`EditText`and `Button`，然后在`DialogFragment`创建 时，膨胀布局并将一个附加`[onClickListener][3]`到您的布局，以`Button`保存文本并关闭`DialogFragment`.

这些接下来的代码块只是展示了你的菜单应该如何实现。此代码膨胀您的菜单 xml - 它是必需的。

```
@Override
public boolean onCreateOptionsMenu(Menu menu) {
        getMenuInflater().inflate(R.menu.activity_main, menu);
        return true;
    } 
```

此代码处理您的逻辑。请注意，`case R.id.menu_edit:`这就是您必须处理用户从菜单中按下“编辑”的逻辑的地方。

```
 @Override
 public boolean onOptionsItemSelected(MenuItem item) {
            switch (item.getItemId()) {
            case R.id.menu_view:
                //do stuff here
                return true;
            case R.id.menu_edit:
                //make a Dialog or show an Activity
                return true;
            default:
                return super.onOptionsItemSelected(item);
            }
        } 
```

最后，不要害怕尝试，它不会咬人。

# asp.net-mvc-4 - 模型的子集合始终为空

> ID：13941338
> 
> 赞同：3
> 
> 时间：2012-12-18T20:54:22.257
> 
> 标签：asp.net-mvc-4

我似乎无法理解 ASP.MVC 4 和 Code First 绑定中的子集合。当涉及到子集合时，我总是收到模型对象为空的错误。我什至无法检查子集合是否为空，因为模型为空。

我已经验证，如果我在控制器中创建一个 Batch 对象并向其添加步骤，那么它将起作用。

我确定这很简单，但我无法弄清楚。

这是我的对象：

```
public class Batch
{
    public virtual int Id { get; set; }
    public virtual string Title { get; set; }
    public virtual string Details { get; set; }
    public virtual ICollection<Step> Steps { get; set; }
}
public class Step
{
    public virtual int Id { get; set; }
    public virtual string Title { get; set; }
    public virtual int Days { get; set; }
    public virtual Batch Batch { get; set; }
} 
```

这是我的控制器操作：

```
 [Authorize]
    public ActionResult Create()
    {
        return View();
    } 
```

这是我的看法：

```
@model BC.Models.Batch

@{
    ViewBag.Title = "Create";
}

<h2>Create</h2>

@using (Html.BeginForm())
{
    @Html.ValidationSummary(true)

    <fieldset>
        <legend>Batch</legend>

        <div class="editor-label">
            @Html.LabelFor(model => model.Title)
        </div>
        <div class="editor-field">
            @Html.EditorFor(model => model.Title)
            @Html.ValidationMessageFor(model => model.Title)
        </div>

        <div class="editor-label">
            @Html.LabelFor(model => model.Details)
        </div>
        <div class="editor-field">
            @Html.TextAreaFor(model => model.Details)
            @Html.ValidationMessageFor(model => model.Details)
        </div>

        <div>
            <h3>Steps</h3>
            // Here is where I get a error that model is null
            @if(model.Steps != null)
            {
                foreach(var item in model.Steps)
                {
                    @Html.EditorFor(model => item)
                }
            }
        </div>
        <p>
            <input type="submit" value="Create" />
        </p>
    </fieldset>
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:07:38.760

实例化您的模型并将其传递给视图。

```
public ActionResult Create()
        {
            var model = new Batch();
            return View(model);
        } 
```

这将解决视图中空模型的 NullReference 异常。

但是，当您到达 Psot 操作时，Steps（Batch 中的集合）可能会为空。为了解决这个问题，在构造函数中新建集合，如下所示：

```
public class Batch
    {
        public Batch()
        {
            Steps = new Collection<Step>();
        }
        public virtual int Id { get; set; }
        public virtual string Title { get; set; }
        public virtual string Details { get; set; }
        public virtual ICollection<Step> Steps { get; set; }
    } 
```

# java - 只允许程序编辑 JTable，但允许用户从中复制数据

> ID：13941342
> 
> 赞同：0
> 
> 时间：2012-12-18T20:54:36.393
> 
> 标签：java, swing, jtable, abstracttablemodel

不知道如何写标题而不使它成为一个段落。

基本上我的`JTable`程序中有一个不能让用户编辑的内容。但是程序必须能够自己编辑它。此外，必须允许用户从表格中的单元格中实际选择和复制文本，而不是对其进行编辑。

我怎样才能做到这一点？最好是通用解决方案，以便它可以应用于我的程序中具有不同布局等的多个表。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:00:24.043

您需要将表格的选择属性设置为 true，如下所示。您还必须确保该`isCellEditable`方法被覆盖并设置为 false，`AbstractTableModel`该类默认执行此操作。

```
 final JTable table = new JTable(new AbstractTableModel() {

        @Override
        public Object getValueAt(int r, int c) {
            return data[r][c];
        }

        @Override
        public int getRowCount() {
            return data.length;
        }

        @Override
        public int getColumnCount() {
            return data[1].length;
        }

    });

    table.setRowSelectionAllowed(true);
    table.setColumnSelectionAllowed(true);
    table.setCellSelectionEnabled(true); 
```

这将允许单独突出显示单元格并从中复制，但不允许编辑单元格。

编辑：改变答案！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-07T02:22:56.777

Tom 的解决方案允许您单击一个单元格并按 Ctrl+C 复制其全部内容。如果您希望能够选择单元格内的文本*区域，您可以执行以下操作：*

```
JTable table = new JTable(...);

JTextField textField = new JTextField();
textField.setEditable(false);
table.setDefaultEditor(String.class, new javax.swing.DefaultCellEditor(textField)); 
```

然后确保您`TableModel.isCellEditable`返回`true`任何您希望能够从中复制的单元格。

（如果你走这条路，你可以跳过允许/启用行/列/单元格选择。）

# json.net - 如何使用 Json.net 反序列化带有 NodaTime.Instant 的字典而不会出现异常？

> ID：13941349
> 
> 赞同：11
> 
> 时间：2012-12-18T20:55:08.963
> 
> 标签：json.net, nodatime

使用json.net将带有 NodaTime.Instance 的字典序列化为 json**效果****很好**，但是在**反序列化时会抛出**Newtonsoft.Json。**JsonSerializationException**。下面的测试显示了问题：

```
[Test] 
public void DeserializeDictionaryThowsException() {
    JsonConverter[] converters = { NodaConverters.IntervalConverter, NodaConverters.InstantConverter };

    var dictionary = new Dictionary<Instant, int>() {
         {Instant.FromUtc(2012, 1, 2, 3, 4, 5), 0}
    };            
    var json = JsonConvert.SerializeObject(dictionary, Formatting.None, converters);
    Assert.AreEqual("{\"2012-01-02T03:04:05Z\":0}", json); //ok
    var result = JsonConvert.DeserializeObject<Dictionary<Instant, int>>(json, converters); // throws
} 
```

反序列化对象抛出：

*Newtonsoft.Json.JsonSerializationException：无法将字符串“2012-01-02T03:04:05Z”转换为字典键类型“NodaTime.Instant”。创建一个 TypeConverter 以从字符串转换为键类型对象。第 1 行，位置 24。----> Newtonsoft.Json.JsonSerializationException：将值“2012-01-02T03:04:05Z”转换为类型“NodaTime.Instant”时出错。第 1 行，第 24 位。----> System.Exception：无法从 System.String 转换或转换为 NodaTime.Instant。*

作为旁注，反序列化 DateTime 字典可以正常工作。我猜是因为 String 有一个 DateTime 转换器。

```
[Test]
public void DeserializeDiciotnaryOfDateTime() // OK
{
    var expected = new DateTime(2012, 1, 2, 3, 4, 5, DateTimeKind.Utc);
    var dictionary = new Dictionary<DateTime, int>() { { expected, 0 } };
    var json = JsonConvert.SerializeObject(dictionary);       
    var result = JsonConvert.DeserializeObject<Dictionary<DateTime, int>>(json); 
    Assert.AreEqual(expected, dictionary.Keys.First()); // OK
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-20T09:58:09.203

您需要添加更多 JSON.NET 转换器来序列化 NodaTime.Instance 时间，如下所示。

```
public void DeserializeDictionaryThowsException()
{
    var dtzProvider = DateTimeZoneCache.GetSystemDefault();
    JsonConverter[] converters = { NodaConverters.IntervalConverter, 
                                   NodaConverters.InstantConverter,
                                   NodaConverters.LocalDateConverter,
                                   NodaConverters.LocalDateTimeConverter,
                                   NodaConverters.LocalTimeConverter,
                                   NodaConverters.OffsetConverter,
                                   NodaConverters.DurationConverter,
                                   NodaConverters.RoundtripPeriodConverter,
                                   NodaConverters.OffsetDateTimeConverter,
                                   NodaConverters.CreateDateTimeZoneConverter(dtzProvider),
                                   NodaConverters.CreateZonedDateTimeConverter(dtzProvider)
                                 };

    var dictionary = new Dictionary<Instant, int>() { { Instant.FromUtc(2012, 1, 2, 3, 4, 5), 0 } };
    var json = JsonConvert.SerializeObject(dictionary, Formatting.None, converters);
    Assert.AreEqual("{\"2012-01-02T03:04:05Z\":0}", json);
    var result = JsonConvert.DeserializeObject<Dictionary<Instant, int>>(json, converters);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-08-08T01:54:42.580

这个问题正在[https://github.com/nodatime/nodatime.serialization/issues/2上解决](https://github.com/nodatime/nodatime.serialization/issues/2)

我有一个从[http://stackoverflow.com/q/6845364/634824](http://stackoverflow.com/q/6845364/634824)修改的工作。这绝不是高性能的，并且尚未经过全面测试。

```
public class DictionaryWithNodaTimeKeyConverter : JsonConverter
{
    private static IDateTimeZoneProvider dtzProvider = DateTimeZoneProviders.Tzdb;
    private JsonSerializerSettings _settings;

    public DictionaryWithNodaTimeKeyConverter(IDateTimeZoneProvider dtzProvider)
        : base()
    {
        _settings = new JsonSerializerSettings().ConfigureForNodaTime(dtzProvider);
    }

    public override void WriteJson(JsonWriter writer, object value, JsonSerializer serializer)
    {
        IDictionary dictionary = (IDictionary)value;
        writer.WriteStartObject();

        foreach (object key in dictionary.Keys)
        {
            writer.WritePropertyName(ConvertToPropertyKey(key));
            serializer.Serialize(writer, dictionary[key]);
        }

        writer.WriteEndObject();
    }

    public override object ReadJson(JsonReader reader, Type objectType, object existingValue, JsonSerializer serializer)
    {
        if (reader.TokenType == JsonToken.Null)
        {
            return null;
        }

        Type keyType = objectType.GetGenericArguments()[0];
        Type valueType = objectType.GetGenericArguments()[1];

        Type intermediateDictionaryType = typeof(Dictionary<,>).MakeGenericType(typeof(string), valueType);
        IDictionary intermediateDictionary = (IDictionary)Activator.CreateInstance(intermediateDictionaryType);
        serializer.Populate(reader, intermediateDictionary);

        IDictionary finalDictionary = (IDictionary)Activator.CreateInstance(objectType);
        foreach (DictionaryEntry pair in intermediateDictionary)
        {
            object parsedObject;
            if (TryConvertKey(pair.Key.ToString(), keyType, out parsedObject))
            {
                finalDictionary.Add(parsedObject, pair.Value);
            }
        }

        return finalDictionary;
    }

    public override bool CanConvert(Type objectType)
    {
        bool canConvert = objectType.IsA(typeof(IDictionary<,>));

        if (canConvert)
        {
            Type keyType = objectType.GetGenericArguments()[0];
            canConvert = canConvert && IsNodaTimeType(keyType);
        }

        return canConvert;
    }

    private bool IsNodaTimeType(Type type)
    {
        return type.IsA(typeof(Instant))
                || type.IsA(typeof(OffsetDateTime))
                || type.IsA(typeof(DateTimeZone))
                || type.IsA(typeof(ZonedDateTime))
                || type.IsA(typeof(LocalDateTime))
                || type.IsA(typeof(LocalDate))
                || type.IsA(typeof(LocalTime))
                || type.IsA(typeof(Offset))
                || type.IsA(typeof(Duration))
                || type.IsA(typeof(Period));
        // Interval is not Support because Interval is serialized as a compound object.
    }

    private string ConvertToPropertyKey(object property)
    {
        if (!IsNodaTimeType(property.GetType()))
        {
            throw new InvalidOperationException();
        }

        string result = JsonConvert.SerializeObject(property, _settings);
        if (!string.IsNullOrWhiteSpace(result))
        {
            // Remove the "" from JsonConvert
            int first = result.IndexOf('"');
            int last = result.LastIndexOf('"');
            if (first != -1 && last != -1 && first < last)
            {
                result = result.Substring(first + 1, last - (first + 1));
            }
        }

        return result;
    }

    private bool TryConvertKey(string text, Type keyType, out object value)
    {
        if (!IsNodaTimeType(keyType))
        {
            throw new InvalidOperationException();
        }

        value = keyType.CreateDefault();

        try
        {
            value = JsonConvert.DeserializeObject($"\"{text}\"", keyType, _settings);
            return true;
        }
        catch
        {
            return false;
        }
    }
} 
```

我还定义了一些扩展

```
public static class TypeExtensions
{
    public static bool IsA(this Type type, Type typeToBe)
    {
        if (!typeToBe.IsGenericTypeDefinition)
            return typeToBe.IsAssignableFrom(type);

        List<Type> toCheckTypes = new List<Type> { type };
        if (typeToBe.IsInterface)
            toCheckTypes.AddRange(type.GetInterfaces());

        Type basedOn = type;
        while (basedOn.BaseType != null)
        {
            toCheckTypes.Add(basedOn.BaseType);
            basedOn = basedOn.BaseType;
        }

        return toCheckTypes.Any(x => x.IsGenericType && x.GetGenericTypeDefinition() == typeToBe);
    }

    public static object CreateDefault(this Type type)
    {
        return type.IsValueType ? Activator.CreateInstance(type) : null;
    }
} 
```

要使用它：

```
IDateTimeZoneProvider provider = DateTimeZoneProviders.Tzdb;
JsonConverter[] converters = { NodaConverters.IntervalConverter, NodaConverters.InstantConverter, new DictionaryWithNodaTimeKeyConverter(provider) };

var dictionary = new Dictionary<Instant, int> {
    { Instant.FromUtc(2012, 1, 2, 3, 4, 5), 0 }
};

var json = JsonConvert.SerializeObject(dictionary, Formatting.None, converters);
Console.WriteLine(json);
var result = JsonConvert.DeserializeObject<Dictionary<Instant, int>>(json, converters); 
```

# c# - 基于 2 个纬度、经度点的方向

> ID：13941352
> 
> 赞同：1
> 
> 时间：2012-12-18T20:55:29.840
> 
> 标签：c#, google-maps, latitude-longitude, computational-geometry, google-earth

我正在寻找一个允许我发送 2 Lat, Longs 的功能。1 Lat, long 是我的基础，第二个是我想确定它是 N、S、E 还是 West。还是我必须去 NW,N,NE,EN,E,ES,SE,S,SW,WS,W,WN？无论哪种方式，有人在 C# 中有这样的东西吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T20:59:23.687

首先你可以计算大圆轴承

> θ = atan2( sin(Δλ).cos(φ2), cos(φ1).sin(φ2) - sin(φ1).cos(φ2).cos(Δλ) )

JavaScript（可轻松转换为 C#）：

```
var y = Math.sin(dLon) * Math.cos(lat2);
var x = Math.cos(lat1)*Math.sin(lat2) -
        Math.sin(lat1)*Math.cos(lat2)*Math.cos(dLon);
var brng = Math.atan2(y, x).toDeg(); 
```

[http://www.movable-type.co.uk/scripts/latlong.html](http://www.movable-type.co.uk/scripts/latlong.html)

然后将结果分割成所需的基本方向，例如，如果方位在 -45（315 度）度和 45 度之间，则为北，依此类推。

```
public string Cardinal(double degrees)
{
    if (degrees > 315.0 || degrees < 45.0)
    {
        return "N";
    }
    else if (degrees >= 45.0 && degrees < 90)
    {
        return "E";
    }
    // Etc for the whole 360 degrees.  Segment finer if you want NW, WNW, etc.
} 
```

# mysql - 如何遍历 SQL 查询结果？（还有一些关于 SQL 结果操作的进一步问题。）

> ID：13941354
> 
> 赞同：0
> 
> 时间：2012-12-18T20:55:52.053
> 
> 标签：mysql, sql

我有一个相当简单的脚本要编写：我必须为我的组织计算所有国际通话费用。我有两个表：电话记录表和费率表。

我确定的解决方案很简单：

从电话记录表中选择目的地国家代码和通话时长

从费率表中选择每分钟的费用（使用我刚刚选择的目的地国家代码）

然后将每个国际电话的持续时间和每分钟费用 (CPM) 相乘，并将其添加到一个名为 total 的变量中，该变量在最后显示给用户。

现在，如果我能够以任何我想要的方式写这个，我将能够在大约 30 分钟内完成。但是，有人告诉我，我必须用 SQL 编写大部分内容。

所以我用谷歌搜索了一下并决定使用存储过程，所以：

我将如何遍历第一个选择查询的结果？如果这是在 ColdFusion 或 PHP 中，我会简单地将结果放入一个数组中——但我还没有找到一种方法将一个查询的结果插入到 SQL 中的一个数组中。

第二：有没有办法浓缩这些步骤？

例如：

```
total = 0
select destinationareacode, duration from phonelogs, where destination=international 
for each record, select CPM from rates, where areacode = (record.destinationareacode)
 total+=CPM*(duration/60) 
```

然后总数会显示给用户。

无论如何...澄清我的问题：

如何遍历一组查询结果？是否可以在遍历这些结果时执行另一个查询，使用结果本身（区域代码）作为该查询中的条件？

抱歉，如果这一切看起来令人费解，我不知道该如何表达我的问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:25:24.097

您显然习惯于[命令式编程](http://en.wikipedia.org/wiki/Imperative_programming)语言（其中一种明确定义机器的状态和从操作到操作的执行控制流），而 SQL 更具[声明性](http://en.wikipedia.org/wiki/Declarative_programming)（其中一种仅表达计算逻辑）。

这是一个非常不同的[范式](http://en.wikipedia.org/wiki/Programming_paradigm)，非常值得花一些时间来研究，不仅因为它在关系数据库领域非常有用（并且有点无处不在），而且还因为人们可以通过研究替代范式来学习很多关于编程的知识。

在您的情况下，您想要做的是选择每个呼叫的持续时间（以分钟为单位）的总和，乘以每分钟的成本：

```
SELECT SUM(duration/60 * CPM) 
```

您正在从`phonelogs`和`rates`表中获取此数据，并加入区号：

```
FROM   phonelogs JOIN rates ON rates.areacode = phonelogs.destinationareacode 
```

就是这样（如果有任何歧义，对于具有表标识符的限定列可能除外）：

```
SELECT SUM(phonelogs.duration/60 * rates.CPM)
FROM   phonelogs JOIN rates ON rates.areacode = phonelogs.destinationareacode 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:03:12.547

你可能想要类似的东西

```
select rates.areacode, sum(cpm*(duration/60))
from  phonelogs
    join rates on rates.areacode = phonelogs.destinationareacode
where phonelogs.destination = 'international'
group by rates.areacode 
```

从理论上讲，这将按区号为您提供日志中所有电话的总费用。我显然不知道它是否会在不了解表格等的情况下为您工作，但这应该让您知道去哪里。 *一般来说*，如果你想在 sql 中做一个循环，那么你做错了。

# c# - c# mvc 从 AJAX 调用返回 JSON 或文件

> ID：13941358
> 
> 赞同：4
> 
> 时间：2012-12-18T20:56:03.817
> 
> 标签：c#, asp.net-mvc-3, jquery

我的视图中有这样的东西：

```
 var url = '@Url.Action("DownloadZip", "Program")' + '?programNums=' + selectedRow;

        $.ajax({
            url: url,
            dataType: 'json',
            async: false,
            success: function (data) {
                if (data != "Successful") {
                    alert(data);
                }
            }
        }); 
```

如果出现错误，控制器可以返回文件或返回 JSON 结果。一直无法让他们两个一起工作。

这是它的样子：

```
 public ActionResult DownloadZip(string programNums)
    {

        if(string.IsNullOrEmpty(programNums))
        {
          return Json("Error, blank info sent.", JsonRequestBehavior.AllowGet);
        }            

        var memoryStream = new MemoryStream();

        using (var zip = new ZipFile())
        {
            zip.AddFile("C:\\sitemap.txt");
            zip.Save(memoryStream);
        }

        memoryStream.Seek(0, 0);
        return File(memoryStream, "application/octet-stream", "archive.zip");

    } 
```

我看到的是 ajax 调用需要返回一个 JSON 值。因为在我的情况下，它返回一个文件，它不能工作。无论如何，要处理我正在做的事情，它可以从 ajax 调用中返回 JSON 或 File。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:10:32.957

我认为你会在这个实现中遇到很多问题。您实际上无法通过 AJAX 上传或下载文件。请参阅下面的链接。

[如何使用 jQuery AJAX 和 Spring MVC 3 从服务器下载文件](https://stackoverflow.com/questions/6722716/how-to-download-file-from-server-using-jquery-ajax-and-spring-mvc-3)

您应该使用上面粘贴的问题中共享的两种实现之一。如果您使用 IFRAME 方法，您可以使用 jQuery 来检查文档何时完成以及是否成功。

编辑：你可以抛出一个服务器异常（500）。如何处理来自 IFRAME 的 500 取决于您。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:30:03.450

您的代码将永远无法工作，因为您无法将二进制数据流式传输到 Ajax 请求 - 您没有正常的响应上下文可写入。

您可以采取几种方法：

1.  如果验证通过，只需将新链接返回到另一个处理程序，该处理程序会将数据流式传输给用户。然后，您将在 Javascript 回调函数中阅读此链接并在新窗口中打开它。
2.  正如上面 DAN Natic 建议的那样，使用 IFRAME。
3.  更复杂：Base64 编码二进制数据并将其作为 Json 结果的一部分返回。读取 base64 编码的文件，使用 Javascript 对其进行解码（网上有很多库可以做到这一点）并对结果做一些事情*。

^*我不确定在 ZIP 文件的情况下是否可以做任何事情。您可以使用这种技术在浏览器内内联显示 PDF 文件，但高度怀疑它是否适用于所有浏览器。我的建议是选择选项 1。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T21:21:31.563

您是否考虑过使用文件 URL 传回 JSON？

如果成功找到/创建文件。发回带有文件链接的 JSON 结果。然后在javascript中使用`windows.location`来检索文件。当出现错误时，JSON 结果将包含错误信息，并且可以将这些信息显示给用户。为此，您需要创建另一个可以流式传输文件的端点（操作）。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2014-12-15T08:23:31.130

Ajax: window.location = '/Home/download';

C＃：

```
 public FileResult download()
        {
           return File("~/" + path, "application/pdf", string.Format(fileName));
        } 
```

# jquery - 可以标记 Jquery.ui 滑块句柄吗？即<<或>>

> ID：13941359
> 
> 赞同：0
> 
> 时间：2012-12-18T20:56:06.670
> 
> 标签：jquery, jquery-ui

是否可以用文字或图像装饰滑块手柄？我想区分范围滑块配置上的高低手柄。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:02:35.633

当然，这是一个**[jsFiddle 示例](http://jsfiddle.net/j08691/MFNpD/)**，其中一个句柄使用文本，另一个句柄使用图像。

基本上你可以使用滑块的[create 方法](http://api.jqueryui.com/slider/#event-create)来改变手柄：

```
create: function() {
    $('.ui-slider-handle:eq(0)').text('<');
    $('.ui-slider-handle:eq(1)').append('<img src="http://cdn1.iconfinder.com/data/icons/Sizicons/12x12/arrow_right_blue_round.png" />');
} 
```

# grails - interceptUrlMap 被覆盖？

> ID：13941363
> 
> 赞同：2
> 
> 时间：2012-12-18T20:56:17.547
> 
> 标签：grails, spring-security

我正在开发一个使用 Grails 的相当大的 Web 应用程序，我们正在尝试实现角色安全性的使用。当系统建立时，grails 基本上是授予 CAS 认证用户完全的角色访问权限，但是当我为每个控制器方法创建特定的角色时，它只是完全忽略了这些角色并继续允许完全访问认证的用户。

这是我在 Config.groovy 中所做的：

```
grails.plugins.springsecurity.securityConfigType = SecurityConfigType.InterceptUrlMap
grails.plugins.springsecurity.interceptUrlMap = [
    "/controllerName/create":                       [ "hasRole( 'ROLE_CREATE' )" ],
    "/controllerName/remove":                       [ "hasRole( 'ROLE_DELETE' )" ],
    "/controllerName/listEntries":                  [ "hasRole( 'ROLE_VIEW' )" ],
    "/controllerName/listAllEntries":               [ "hasRole( 'ROLE_VIEW' )" ],
    "/controllerName/getDefaultCategories":         [ "hasRole( 'ROLE_VIEW' )" ]
] 
```

UrlConfig.goovy 没有控制器名称的条目。

当应用程序调用controllerName 中的create、remove 或其他服务时，用户是否具有指定的角色并不重要。它就像那里没有映射一样。

是否有可能其他一些设置覆盖了interceptUrlMap？如果是这样，我应该从哪里开始寻找？

我应该提到我们必须使用 Grails 1.3.8

更新：我尝试了下面提到的小写字母，但仍然失败。但是，如果我只是做了一个顶级（“/controllername/**”）控制器条目（与在控制器中指定一个操作相反，它会限制访问。不幸的是，我们想做“/controllername/create”类型的安全性。有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:12:47.410

URL 必须是小写的，在启动时应该有一个警告。将“controllerName”更改为“controllername”，将“listAllEntries”更改为“listallentries”等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-03T16:48:20.830

它必须是这样的，这是我的例子：
请注意***表示该控制器内的所有操作

```
grails.plugins.springsecurity.interceptUrlMap = [
   '/secure/create':    ['ROLE_ADMIN'],
   '/finance/***':   ['ROLE_FINANCE', 'IS_AUTHENTICATED_FULLY'],
   '/js/**':        ['IS_AUTHENTICATED_ANONYMOUSLY'],
   '/css/**':       ['IS_AUTHENTICATED_ANONYMOUSLY'],
   '/images/**':    ['IS_AUTHENTICATED_ANONYMOUSLY'],
   '/*':            ['IS_AUTHENTICATED_ANONYMOUSLY'],
   '/login/**':     ['IS_AUTHENTICATED_ANONYMOUSLY'],
   '/logout/**':    ['IS_AUTHENTICATED_ANONYMOUSLY']
] 
```

# javascript - 是否可以通过 Javascript 终止 SharePoint 工作流？

> ID：13941378
> 
> 赞同：2
> 
> 时间：2012-12-18T20:57:01.213
> 
> 标签：javascript, sharepoint, powershell, workflow, sharepoint-workflow

我想通过单击功能区中的自定义按钮（使用 JavaScript）按 ID 抓取列表中的选定项目来批量终止工作流。我可以终止 JavaScript 中的工作流程吗？

或者，我制作了一个 PowerShell 脚本，可以按项目 ID 终止所有正在运行的工作流。将所选项目数据从 JavaScript 发送到 PowerShell 脚本或让它们完全对话（显然与客户端/服务器相关的问题）的最佳方式是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T20:12:53.010

如果您的意思是 SharePoint 功能区 - 因此您的自定义按钮位于 SharePoint 页面上，您可以使用将项目 ID 作为参数的方法创建 Web 服务。方法将通过对象模型终止所有正在运行的 WF（代码与您在 PS 脚本中编写的代码非常相似）。Web 服务必须部署在 SharePoint 中。

然后你可以在javascript中调用webservice。

仅当 javascript 和 web 服务位于同一 SharePoint 应用程序上时，所描述的场景才可能，因此您不必处理身份验证。

检查这篇[文章](http://www.codeproject.com/Articles/1231/ASP-NET-Web-Service)。它描述了如何创建 web 服务以及如何从 javascript 调用它。

# c - 使用 gcc 原子内置函数？

> ID：13941385
> 
> 赞同：9
> 
> 时间：2012-12-18T20:57:32.040
> 
> 标签：c, gcc, gnu, atomic

我正在尝试`__atomic_load_n`从`gcc` [atomic builtins](http://gcc.gnu.org/onlinedocs/gcc/_005f_005fatomic-Builtins.html)页面使用，编译

```
gcc -Wall -march=i686 -std=gnu99 ll.c -o ll 
```

但它告诉我它不能

> 警告：函数'__atomic_load_n'的隐式声明</p>

`gcc`我认为提供`arch`和标志就足够了`march`（并通过设置`std=gnu99`标志来确保），但无济于事。事实上，即使我测试通用`__GCC_VERSION__`或`__GNUC__`宏似乎没有价值......但我有一个非常普通`gcc`的安装，它来自 Ubuntu。

我知道我在做一些愚蠢的事情，但我不知道是什么。我有 gcc (Ubuntu/Linaro 4.6.3-1ubuntu5) 4.6.3

代码如下所示：它是一个从未被调用的函数（还），所以问题出在编译时。

```
type* func(type* p) {
    type* q = __atomic_load_n (p, __ATOMIC_SEQ_CST);
} 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-19T09:42:06.937

在 GCC 4.6.3 之前，用于原子操作的编译器内置程序是纯粹的编译器扩展，在 GCC 中它们被分组到[`__sync_*`](http://gcc.gnu.org/onlinedocs/gcc-4.6.3/gcc/Atomic-Builtins.html)函数系列中。

从 4.7.0 版开始，新的 C++11 和 C11 标准都已最终确定，GCC 更新了它们的原子内置函数以更好地反映这两个新语言修订版的新内存模型。新功能被分组到该[`__atomic_*`](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/_005f_005fatomic-Builtins.html)系列中。

但是，较旧的内置插件[仍然可用](http://gcc.gnu.org/onlinedocs/gcc-4.7.2/gcc/_005f_005fsync-Builtins.html)，并且[文档](http://gcc.gnu.org/wiki/Atomic/GCCMM)说明了这一点：

> 将调用替换为使用内存模型的调用**始终**是安全的。`__sync``__atomic``__ATOMIC_SEQ_CST`

# c# - 在 XML 调用中保持为空

> ID：13941392
> 
> 赞同：0
> 
> 时间：2012-12-18T20:58:21.827
> 
> 标签：c#, xml, web-services, http, httpwebrequest

我正在尝试从 XML 返回某些行。

```
<geoip>
    <source>smart-ip.net</source>
    <host>68.9.63.33</host>
    <lang>en</lang>
    <countryName>United States</countryName>
    <countryCode>US</countryCode>
    <city>West Greenwich</city>
    <region>Rhode Island</region>
    <latitude>41.6298</latitude>
    <longitude>-71.6677</longitude>
    <timezone>America/New_York</timezone>
</geoip> 
```

我之前得到了完整的转储，但现在我正在使用这段代码......

当我单击提交时，这是给我`null`的。`name`不知道为什么它不读取 XML 调用。

这是我的代码...

```
try {
    WebClient wc = new WebClient();

    var xml = wc.DownloadString(string.Format("http://smart-ip.net/geoip-xml/",
                                txtIP.Text));

    XmlDocument doc = new XmlDocument();
    doc.LoadXml(xml);

    var name = doc.DocumentElement.SelectSingleNode("//geoip/countryName").Value;
    txtIPresults.Text = name;
} catch (Exception myException) {
    throw new Exception("Error Occurred:", myException);
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:01:08.783

您正在搜索的 XML`SelectSingleNode`不包含与您的参数匹配的路径。该函数的默认返回为 null - 因此，当找不到您的路径时，将`null`返回。

此外，当我尝试访问您指定的网页时，我收到了服务器错误。我建议您至少检查一下以确保您的`xml`变量有内容。

**（编辑）**

查看 XML 后，我注意到您正在调用`Value`返回的单个节点。你不想要价值，你想要`InnerText`财产——在那里你会找到你正在寻找的价值。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:16:23.123

除了`InnerText`按照 Jon 的正确建议使用之外，请尝试：

```
var name = doc.DocumentElement.SelectSingleNode("countryName").InnerText; 
```

我认为你的问题是它`doc.DocumentElement`已经是`geoip`XML 元素，所以你只需要获取它的`countryName`子元素。

或者：

```
var name = doc.SelectSingleNode("//geoip/countryName").InnerText; 
```

# c++ - C函数指针参数打印问题

> ID：13941393
> 
> 赞同：0
> 
> 时间：2012-12-18T20:58:23.463
> 
> 标签：c++, c, function-pointers

我有以下代码：

```
struct cache_t *                /* pointer to cache created */
cache_create(char *name,        /* name of the cache */
             int nsets,         /* total number of sets in cache */
             int bsize,         /* block (line) size of cache */
             int balloc,        /* allocate data space for blocks? */
             int usize,         /* size of user data to alloc w/blks */
             int assoc,         /* associativity of cache */
             enum cache_policy policy,  /* replacement policy w/in sets */
             /* block access function, see description w/in struct cache def */
             unsigned int (*blk_access_fn) (enum mem_cmd cmd,
                                            md_addr_t baddr, int bsize,
                                            struct cache_blk_t * blk,
                                            tick_t now,
                                            int context_id),
             unsigned int hit_latency)
{                               /* latency in cycles for a hit */
    struct cache_t *cp;
    struct cache_blk_t *blk;
    int i, j, bindex;
----
----
---

  cp->blk_access_fn = blk_access_fn;

----
--- 
```

**我想打印 context_id 和 baddr 。我该怎么做 ？** 我已经尝试过类型转换和一切，但它一直给我错误：符号“context_id”在当前上下文中无效。帮助将不胜感激。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:01:19.557

我想你误解了这个`cache_create`功能。它根本没有`context_id`或`baddr`参数。它作为参数所`blk_access_fn`具有的是**函数指针**。该函数可能被调用`cache_create`并且**它将**这两个变量作为参数。

一种更好地可视化的方法是这样的：

```
typedef unsigned int (*blk_access_fn_ptr)(enum mem_cmd cmd, md_addr_t baddr, int bsize, struct cache_blk_t *blk, tick_t now, int context_id);

struct cache_t *            /* pointer to cache created */
cache_create(char *name,        /* name of the cache */
     int nsets,         /* total number of sets in cache */
     int bsize,         /* block (line) size of cache */
     int balloc,        /* allocate data space for blocks? */
     int usize,         /* size of user data to alloc w/blks */
     int assoc,         /* associativity of cache */
     enum cache_policy policy,  /* replacement policy w/in sets */
     /* block access function, see description w/in struct cache def */
     blk_access_fn_ptr blk_access_fn,
     unsigned int hit_latency)  /* latency in cycles for a hit */
{
    ...
} 
```

此代码在功能上与您发布的代码**相同。**如您所见，`cache_create`根本没有您要查找的参数。您必须传递一个带有适当原型的函数作为`blk_access_fn`参数，并且它将具有它们。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:03:57.207

如果我没看错，你没有传入 context_id，你正在接受一个 fxn 指针，它接受一个 context_id 的参数。您可以在 blk_access_fn 内部访问它们，但不能在 cache_create 内部访问。

# java - 在 jsp 中获取当前操作 - struts2

> ID：13941394
> 
> 赞同：1
> 
> 时间：2012-12-18T20:58:31.603
> 
> 标签：java, facebook, jsp, struts2

问题是我想在 jsp 页面中获取当前 url，但不显示 .jsp 页面，而是显示操作名称。例如：

我有操作[http://www.mypage.com/Index](http://www.mypage.com/Index)，它显示页面[http://www.mypage.com/pages/index.jsp](http://www.mypage.com/pages/index.jsp)。有什么方法可以获取 jsp 文件中的第一个 Url？我总是返回jsp的路径，但我想要的是动作名称。我所拥有的是：

```
<%=  (request.getServletPath()) %> 
```

和

```
${pageContext.request.requestURL}?${pageContext.request.queryString} //to get the id attached 
```

我想要一个简单的 facebook 分享按钮：

```
<div class="fb-like" data-href="${pageContext.request.requestURL}?${pageContext.request.queryString}" data-send="true" data-width="450" data-show-faces="true"></div> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:19:14.980

为此使用`<s:url>`标签。

```
<s:url forceAddSchemeHostAndPort="true" includeParams="all"/> 
```

设置为的`forceAddSchemeHostAndPort`属性`true`将添加您的主机名和端口，`includeParams`设置为`all`将包括所有参数。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-04-21T03:50:32.910

如果您只想使用 JSTL 的操作名称，您可以使用

```
${request.context['struts.actionMapping'].name} 
```

# php - 数据库中不存在zend表单检查记录

> ID：13941395
> 
> 赞同：1
> 
> 时间：2012-12-18T20:58:36.457
> 
> 标签：php, database, forms, zend-framework

我有一个表格，用于检查 2 个表中的数据库中是否存在电子邮件。

我使用 Zend_Validate_Db_NoRecordExists 进行两个验证，但它只检查第二个。

知道为什么它不起作用吗？

```
class Application_Form_ReferUser extends Zend_Form
{
public $email, $freeDownload, $buyNow;

public function init()
{
    $this->setName('referUser');

    $EmailExists = new Zend_Validate_Db_NoRecordExists(
        array(
            'table' => 'referrals',
            'field' => 'email'
        )
    );

    $EmailExists2 = new Zend_Validate_Db_NoRecordExists(
        array(
            'table' => 'users',
            'field' => 'email'
        )
    );

    $EmailExists->setMessage('This e-mail is already taken');
    $EmailExists2->setMessage('This e-mail is already taken');

    $this->email = $this->createElement('text', 'email')
                     ->setLabel('Email')
                     ->addValidator($EmailExists)
                     ->addValidator($EmailExists2)
                     ->addValidator('EmailAddress')
                     ->setRequired(true);

    $this->freeDownload = $this->createElement('button', 'btn_free_download')
                            ->setLabel('Free Download')
                            ->setAttrib('type', 'submit');

    $this->buyNow = $this->createElement('button', 'btn_buy_now')
                            ->setLabel('Buy Now')
                            ->setAttrib('type', 'submit');

    $this->addElements(array($this->email, $this->freeDownload, $this->buyNow));

    $elementDecorators = array(
        'ViewHelper'
    );
    $this->setElementDecorators($elementDecorators);
}
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T11:01:42.613

我认为您不会在一个元素上多次添加相同的验证器。检查类`Zend_Form_Element` `addValidator()`第 1153 行。根据代码`$this->_validators[$name] = $validator;`，当我们向一个元素多次添加相同的验证器时，前者将被覆盖。

我认为您必须创建一个自定义表单验证器或`isValid()`在元素上单独使用并验证它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:21:29.197

使用这个：

```
addValidators (array $ validators, $ files = null) 
```

伊姆：

```
$this->addValidators(array($EmailExists,$EmailExists2,'EmailAddress')); 
```

我自己工作

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T03:22:34.950

```
$this ->addElement($email = new Zend_Form_Element_Text('email'));   

$email->setLabel('E-mail')
      ->addValidator('Db_NoRecordExists', false, array('table' => 'table1', 'field' => 'email'))
      ->addValidator('Db_NoRecordExists', false, array('table' => 'table2', 'field' => 'email'))
      ->addValidator('EmailAddress', false); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-19T05:33:46.400

试试下面的东西（未经测试的），

```
$emailNotEmpty = new Zend_Validate_NotEmpty();
        $emailNotEmpty->setMessage('You must enter a email address.');
        $emailFormat = new Zend_Validate_Regex('/^([A-Za-z0-9_\-\.])+\@([A-Za-z0-9_\-\.])+\.([A-Za-z]{2,4})$/');
        $emailFormat->setMessage('You must enter a valid email address.');
        $emailUnique1 = new Zend_Validate_Db_NoRecordExists('referrals', 'email');
        $emailUnique1->setMessage('This email address is already registered.');
        $emailUnique2 = new Zend_Validate_Db_NoRecordExists('users', 'email');
        $emailUnique2->setMessage('This email address is already registered.');
        $email = new Zend_Form_Element_Text('email', array(
          'label' => 'Email Address:',
          'class' => 'text-size text hastip',
          'title' => $qtips_messages['key_email'],
          'tabindex' => '2',
          'required' => true,
          'value'=> '',
          'filters' => array('StringTrim'),
          'validators' => array(
            array($emailNotEmpty, true),
            array($emailFormat, true),
            array($emailUnique1,true),
            array($emailUnique2,true),
          ),
      'decorators' => $this->requiredElementDecorators,
      'description' => '<img src="../../images/star.png" alt="required" />',
        ));
        $this->addElement($email); 
```

# mysql - 带有分组的单列表中的 MySql 多列选择

> ID：13941413
> 
> 赞同：1
> 
> 时间：2012-12-18T20:59:42.777
> 
> 标签：mysql, select, group-by, case

我想在我所在的位置显示这样的`GROUP`数据`DATE`：

```
Date        Star1   Star2   Star3   Star4   Star5
2012-10-25  null    null    null     1       1 
```

我的当前表有三 (3) 列，显示：

```
ID DATE        RATING
5  2012-10-25    4
6  2012-10-25    5 
```

我正在使用此查询来尝试实现上述数据：

```
SELECT 
    DATE,
    CASE
        WHEN RATING = 1 THEN 1
        ELSE NULL
    END AS STAR1,
    CASE
        WHEN RATING = 2 THEN 1
        ELSE NULL
    END AS STAR2,
    CASE
        WHEN RATING = 3 THEN 1
        ELSE NULL
    END AS STAR3,
    CASE
        WHEN RATING = 4 THEN 1
        ELSE NULL
    END AS STAR4,
    CASE
        WHEN RATING = 5 THEN 1
        ELSE NULL
    END AS STAR5
FROM
    table1
WHERE
    DATE = '2012-10-25'
GROUP BY DATE
ORDER BY DATE 
```

这只会吐出一个评级：

```
Date        Star1   Star2   Star3   Star4   Star5
2012-10-25  null    null    null    null      1 
```

就像它不是在日期上进行分组一样，我该如何实现呢？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:06:03.237

MySQL 允许这样的查询有点令人惊讶，因为 GROUP BY 没有涵盖 SELECT 列表中的所有非聚合列。

如果您将 CASE 语句包装成计数，那么我认为您最终会得到您想要的：

```
SELECT 
    DATE,
    COUNT(CASE
        WHEN RATING = 1 THEN 1
        ELSE NULL
    END) AS STAR1,
    COUNT(CASE
        WHEN RATING = 2 THEN 1
        ELSE NULL
    END) AS STAR2,
    COUNT(CASE
        WHEN RATING = 3 THEN 1
        ELSE NULL
    END) AS STAR3,
    COUNT(CASE
        WHEN RATING = 4 THEN 1
        ELSE NULL
    END) AS STAR4,
    COUNT(CASE
        WHEN RATING = 5 THEN 1
        ELSE NULL
    END) AS STAR5
FROM
    table1
WHERE
    DATE = '2012-10-25'
GROUP BY DATE
ORDER BY DATE 
```

请让我知道您如何使用这种方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:34:43.230

```
SELECT 
DISTINCT DATE, 
(SELECT COUNT(RATING) FROM Table1 WHERE RATING = '1') AS Star1,
(SELECT COUNT(RATING) FROM Table1 WHERE RATING = '2') AS Star2,
(SELECT COUNT(RATING) FROM Table1 WHERE RATING = '3') AS Star3,
(SELECT COUNT(RATING) FROM Table1 WHERE RATING = '4') AS Star4,
(SELECT COUNT(RATING) FROM Table1 WHERE RATING = '5') AS Star5
FROM 
Table1
WHERE 
DATE = '2012-10-25'
GROUP BY DATE
ORDER BY DATE 
```

# python - Google App Engine Datastore 到 BigQuery 进程的 UnicodeEncodeError

> ID：13941416
> 
> 赞同：1
> 
> 时间：2012-12-18T20:59:48.083
> 
> 标签：python, google-app-engine, mapreduce, google-bigquery, google-cloud-storage

我正在尝试跟随[这个 Codelab](https://developers.google.com/bigquery/articles/datastoretobigquery)，它向您展示如何从您的 Google App Engine 数据存储中获取数据，并通过设置 MapReduce 管道将其通过 Google Cloud Storage 移动到 BigQuery。我设置了一个 Google App Engine 数据存储实体，并有一个流程来收集关于某些股票的推文，我想收集这些数据作为测试。我相信我已经按照示例中概述的所有内容进行了操作，但是完成分解数据并将其加载到 Cloud Storage 的所有工作的分片正在引发 UnicodeEncodeErrors。这是我在开发应用服务器上测试应用程序的日志：

```
INFO     2012-12-18 20:41:07,645 dev_appserver.py:3103] "POST /mapreduce/worker_callback HTTP/1.1" 500 -
WARNING  2012-12-18 20:41:07,648 taskqueue_stub.py:1981] Task appengine-mrshard-1582400592541472B07B9-0-0 failed to execute. This task will retry in 0.100 seconds
ERROR    2012-12-18 20:41:09,453 webapp2.py:1552] 'ascii' codec can't encode character u'\u2019' in position 80: ordinal not in range(128)
Traceback (most recent call last):
File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1535, in __call__
rv = self.handle_exception(request, response, e)
File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1529, in __call__
rv = self.router.dispatch(request, response)
File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1278, in default_dispatcher
return route.handler_adapter(request, response)
File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 1102, in __call__
return handler.dispatch()
File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 572, in dispatch
return self.handle_exception(e, self.app.debug)
File "C:\Program Files (x86)\Google\google_appengine\lib\webapp2\webapp2.py", line 570, in dispatch
return method(*args, **kwargs)
File "C:\Users\Tank\Documents\Aptana Studio 3 Workspace\jibdantest-bq\mapreduce\base_handler.py", line 65, in post
self.handle()
File "C:\Users\Tank\Documents\Aptana Studio 3 Workspace\jibdantest-bq\mapreduce\handlers.py", line 181, in handle
entity, input_reader, ctx, tstate)
File "C:\Users\Tank\Documents\Aptana Studio 3 Workspace\jibdantest-bq\mapreduce\handlers.py", line 298, in process_data
output_writer.write(output, ctx)
File "C:\Users\Tank\Documents\Aptana Studio 3 Workspace\jibdantest-bq\mapreduce\output_writers.py", line 659, in write
ctx.get_pool("file_pool").append(self._filename, str(data))
UnicodeEncodeError: 'ascii' codec can't encode character u'\u2019' in position 80: ordinal not in range(128) 
```

这是代码：

```
import json
import webapp2
import urllib2
import time
import calendar
import datetime
import httplib2

from google.appengine.ext import db
from google.appengine.api import taskqueue
from google.appengine.ext import blobstore
from google.appengine.ext.webapp.util import run_wsgi_app
from google.appengine.ext.webapp import blobstore_handlers
from google.appengine.ext.webapp import util
from google.appengine.ext.webapp import template
from google.appengine.api import urlfetch

from mapreduce.lib import files
from mapreduce import base_handler
from mapreduce import mapreduce_pipeline
from apiclient.discovery import build
from oauth2client.appengine import AppAssertionCredentials

SCOPE = 'https://www.googleapis.com/auth/bigquery'
PROJECT_ID = 'project_id' # Your Project ID here
BQ_DATASET_ID = 'datastore_data'
GS_BUCKET = 'bucketname'
ENTITY_KIND = 'main.streamdata'

class streamdata(db.Model):
    querydate = db.DateTimeProperty(auto_now_add = True)
    ticker = db.StringProperty()
    created_at = db.StringProperty()
    tweet_id = db.StringProperty()
    text = db.TextProperty()
    source = db.StringProperty()

class DatastoreMapperPipeline(base_handler.PipelineBase):

    def run(self, entity_type):

        output = yield mapreduce_pipeline.MapperPipeline(
          "Datastore Mapper %s" % entity_type,
          "main.datastore_map",
          "mapreduce.input_readers.DatastoreInputReader",
          output_writer_spec="mapreduce.output_writers.FileOutputWriter",
          params={
              "input_reader":{
                  "entity_kind": entity_type,
                  },
              "output_writer":{
                  "filesystem": "gs",
                  "gs_bucket_name": GS_BUCKET,
                  "output_sharding":"none",
                  }
              },
              shards=10)

        yield CloudStorageToBigQuery(output)

class CloudStorageToBigQuery(base_handler.PipelineBase):

    def run(self, csv_output):

        credentials = AppAssertionCredentials(scope=SCOPE)
        http = credentials.authorize(httplib2.Http())
        bigquery_service = build("bigquery", "v2", http=http)

        jobs = bigquery_service.jobs()
        table_name = 'datastore_data_%s' % datetime.datetime.utcnow().strftime(
            '%m%d%Y_%H%M%S')
        files = [str(f.replace('/gs/', 'gs://')) for f in csv_output]
        result = jobs.insert(projectId=PROJECT_ID,
                            body=build_job_data(table_name,files))

        result.execute()

def build_job_data(table_name, files):
  return {"projectId": PROJECT_ID,
          "configuration":{
              "load": {
                  "sourceUris": files,
                  "schema":{
                      "fields":[
                          {
                              "name":"querydate",
                              "type":"INTEGER",
                          },
                          {
                              "name":"ticker",
                              "type":"STRING",
                          },
                          {
                              "name":"created_at",
                              "type":"STRING",
                          },
                          {
                              "name":"tweet_id",
                              "type":"STRING",
                          },
                          {   "name":"text",
                              "type":"TEXT",
                          },
                          {    
                              "name":"source",
                              "type":"STRING",
                          }
                          ]
                      },
                  "destinationTable":{
                      "projectId": PROJECT_ID,
                      "datasetId": BQ_DATASET_ID,
                      "tableId": table_name,
                      },
                  "maxBadRecords": 0,
                  }
              }
          }

def datastore_map(entity_type):
    data = db.to_dict(entity_type)
    resultlist = [timestamp_to_posix(data.get('querydate')),
                    data.get('ticker'),
                    data.get('created_at'),
                    data.get('tweet_id'),
                    data.get('text'),
                    data.get('source')]
    result = ','.join(['"%s"' % field for field in resultlist])
    yield("%s\n" % result)

def timestamp_to_posix(timestamp):
    return int(time.mktime(timestamp.timetuple()))

class DatastoretoBigQueryStart(webapp2.RequestHandler):
    def get(self):
        pipeline = DatastoreMapperPipeline(ENTITY_KIND)
        pipeline.start()
        path = pipeline.base_path + "/status?root=" + pipeline.pipeline_id
        self.redirect(path)

class StreamHandler(webapp2.RequestHandler):

    def get(self):

        tickers = ['AAPL','GOOG', 'IBM', 'BAC', 'INTC',
                   'DELL', 'C', 'JPM', 'WFM', 'WMT', 
                   'AMZN', 'HOT', 'SPG', 'SWY', 'HTSI', 
                   'DUK', 'CEG', 'XOM', 'F', 'WFC', 
                   'CSCO', 'UAL', 'LUV', 'DAL', 'COST', 'YUM',
                   'TLT', 'HYG', 'JNK', 'LQD', 'MSFT',
                   'GE', 'LVS', 'MGM', 'TWX', 'DIS', 'CMCSA',
                   'TWC', 'ORCL', 'WPO', 'NYT', 'GM', 'JCP', 
                   'LNKD', 'OPEN', 'NFLX', 'SBUX', 'GMCR', 
                   'SPLS', 'BBY', 'BBBY', 'YHOO', 'MAR', 
                   'L', 'LOW', 'HD', 'HOV', 'TOL', 'NVR', 'RYL', 
                   'GIS', 'K', 'POST', 'KRFT', 'CHK', 'GGP', 
                   'RSE', 'RWT', 'AIG', 'CB', 'BRK.A', 'CAT']

        for i in set(tickers):

            url = 'http://search.twitter.com/search.json?q='
            resultcount = '&rpp=100'
            language = '&lang=en'
            encoding = '%40%24'
            tickerstring = url + encoding + i + resultcount + language
            tickurl = urllib2.Request(tickerstring)
            tweets = urllib2.urlopen(tickurl)
            code = tweets.getcode()

            if code == 200:
                results = json.load(tweets, 'utf-8')
                if "results" in results:
                    entries = results["results"]
                    for entry in entries:
                        tweet = streamdata()
                        created = entry['created_at']
                        tweetid = entry['id_str']
                        tweettxt = entry['text']
                        tweet.ticker = i
                        tweet.created_at = created
                        tweet.tweet_id = tweetid
                        tweet.text = tweettxt
                        tweet.source = "Twitter"
                        tweet.put()

class MainHandler(webapp2.RequestHandler):

    def get(self):
        self.response.out.write('<a href="/start">Click here</a> to start the Datastore to BigQuery pipeline. ')
        self.response.out.write('<a href="/add_data">Click here</a> to start adding data to the datastore. ')

app = webapp2.WSGIApplication([
                               ('/', MainHandler),
                               ('/start', DatastoretoBigQueryStart), 
                               ('/add_data', StreamHandler)], 
                              debug=True) 
```

任何人可能有的任何见解都会有很大帮助。

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:12:30.227

您正在将 Unicode 数据转换为字节串：

```
ctx.get_pool("file_pool").append(self._filename, str(data)) 
```

当您在不指定编码的情况下执行此操作时，Python 会回退到默认值，即 ASCII。您需要改用另一种编码，一种可以处理您的数据包含的所有 Unicode 代码点的编码。

对于大多数文本，UTF-8 是一个不错的选择；如果您有很多非西方文本（阿拉伯文、亚洲文等），那么 UTF-16 可能更有效。无论哪种情况，您都必须显式编码：

```
ctx.get_pool("file_pool").append(self._filename, data.encode('utf8')) 
```

从该文件读回数据时，使用`filedata.decode('utf8')`解码回 Unicode。

有关 Python 和 Unicode 的更多信息，请参阅[Python Unicode HOWTO](http://docs.python.org/2/howto/unicode.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:03:25.067

```
ctx.get_pool("file_pool").append(self._filename, str(data)) 
```

如果数据包含 unicode 字符，这将失败。尝试

```
ctx.get_pool("file_pool").append(self._filename, unicode(data)) 
```

# javascript - Internet Explorer 中 MutationObservers 的可用性

> ID：13941417
> 
> 赞同：5
> 
> 时间：2012-12-18T20:59:54.730
> 
> 标签：javascript, internet-explorer, dom-manipulation, mutation-observers

IE 中尚不提供 AFAIK 突变观察器。Chrome、Safari、Firefox 都有自己的实现方式，并通过标准化流程进行工作。我想知道是否有人（最好是 MS 员工）知道 IE 的故事，或者可能会给我一个指向我错过的文章的指针。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-12-23T03:36:30.157

IE 11 原生支持`MutationObservers`。对于 IE 9-10，你可以使用这个 polyfill： [https ://github.com/Polymer/MutationObservers](https://github.com/Polymer/MutationObservers)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-10T19:18:56.787

最近有一篇关于[Windows 8](http://blogs.msdn.com/b/windowsappdev/archive/2012/09/19/make-your-html-javascript-app-accessible.aspx)应用程序开发的文章`onpropertychange`用于处理 DOM 突变。

> 示例 4：处理 ARIA 选定属性的 onpropertychange 以检测选项卡选择的编程更改。

```
 tabElement.attachEvent("onpropertychange", selectionChanged);

    function selectionChanged(event) 
     {
     if (event.propertyName === "aria-selected")
       {
       if (event.srcElement.getAttribute("aria-selected") === "true") 
         {
         // execute code to load the content that corresponds with the selected tab element 
         } 
       else 
         {
         // execute code for deselected tab, if needed
         }
       }
     } 
```

**参考**

*   [使您的 HTML/JavaScript 应用程序可访问 - Windows 8 应用程序开发人员博客](https://blogs.msdn.microsoft.com/windowsappdev/2012/09/19/make-your-htmljavascript-app-accessible/)

*   [Firefox中文本框的onpropertychange？](https://stackoverflow.com/questions/919428/)

*   [来自 jquery 工具的 flashembed 的回调](https://stackoverflow.com/questions/8325189/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-06-24T17:56:07.833

为了与 IE9-10 兼容，[https://github.com/webmodules/mutation-observer](https://github.com/webmodules/mutation-observer)公开了浏览器提供的原生 MutationObserver API，或者基于突变事件的 polyfill。

# web-services - 在 ColdFusion 中应该使用什么来映射到 SOAP 类型 tns:ArrayOfString？

> ID：13941422
> 
> 赞同：2
> 
> 时间：2012-12-18T21:00:14.740
> 
> 标签：web-services, soap, coldfusion

如果一个`cfinvoke`参数类型设置为 的 SOAP Web 服务`tns:ArrayOfString`，将得到：

> 无法执行 Web 服务调用 Hello。调用 Web 服务操作时返回的错误是：''java.lang.IlligalArgumentException: argument type mismatch

如何使用 type 调用 Web 服务`tns:ArrayOfString`？

根据[http://forums.adobe.com/message/4337438](http://forums.adobe.com/message/4337438)

这有效：

```
<cfscript>
     root = structnew();
     text = arraynew(1);
     text[1] = "Hello";
     text[2] = "world";
     root.string=text;
</cfscript>

<cfinvoke method="Hello"
  webservice="http://localhost/Service1.asmx?wsdl"
  returnvariable="response">
     <cfinvokeargument name="array" value=#root#/>
</cfinvoke> 
```

现在的问题是，为什么这行得通？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:26:24.470

就像我在您引用的线程中提到的那样，没有[直接映射](http://help.adobe.com/en_US/ColdFusion/9.0/Developing/WSc3ff6d0ea77859461172e0811cbec22c24-78b2.html). `ArrayOfString`所以它本质上被视为一个结构，就像任何其他复杂类型一样。如果您查看 wsdl，则`ArrayOfString`包含一个名为 的键`string`，其值是一个数组`type="s:string"`：

```
<s:complexType name="ArrayOfString">
   <s:sequence>
     <s:element minOccurs="0" maxOccurs="unbounded" 
           name="string" nillable="true" type="s:string" /> 
   </s:sequence>
</s:complexType> 
```

所以 CF 代码之所以有效，是因为它创建了一个具有正确键名 ( `string`) 和值类型（字符串数组）的结构。

```
 root.string = [ arrayOfStrings ]; 
```

# vba - 使用宏删除重复项

> ID：13941428
> 
> 赞同：0
> 
> 时间：2012-12-18T21:00:39.703
> 
> 标签：vba, excel

我得到了一个来自多个来源的 url 列表，一些来源重叠，所以我有重复的列表，虽然它们不是完全重复的，有些有 http://，有些 www.，有些带有斜杠等.

目前我得到了一个可以使用精确重复的脚本，我需要改变 init 以像上面一样工作吗？

这就是我到目前为止所得到的

```
Sub Delete_duplicates()
Dim iListCount As Integer
Dim iCtr As Integer

' Turn off screen updating to speed up macro.
Application.ScreenUpdating = False

' Get count of records to search through.
iListCount = Sheets("Sheet1").Range("A1:A100").Rows.Count
Sheets("Sheet1").Range("A1").Select
' Loop until end of records.
Do Until ActiveCell = ""
   ' Loop through records.
   For iCtr = 1 To iListCount
      ' Don't compare against yourself.
      ' To specify a different column, change 1 to the column number.
      If ActiveCell.Row <> Sheets("Sheet1").Cells(iCtr, 1).Row Then
         ' Do comparison of next record.
         If ActiveCell.Value = Sheets("Sheet1").Cells(iCtr, 1).Value Then
            ' If match is true then delete row.
            Sheets("Sheet1").Cells(iCtr, 1).Delete xlShiftUp
               ' Increment counter to account for deleted row.
               iCtr = iCtr + 1
         End If
      End If
   Next iCtr
   ' Go to next record.
   ActiveCell.Offset(1, 0).Select
Loop
Application.ScreenUpdating = True
MsgBox "Done!"
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T08:12:02.757

您可以使用函数来“规范化”您的 URL，即

```
...
            If strapUrl(ActiveCell) = strapUrl(Sheets("Sheet1").Cells(iCtr, 1)) Then
...

Function strapURL(Arg As String) As String
Dim Tmp As String

    Tmp = Replace(Arg, "http://", "")     ' remove http://
    Tmp = Replace(Tmp, "www.", "")        ' remove www.
    If Right(Tmp, 1) = "/" Then
        Tmp = Left(Tmp, Len(Tmp) - 1)     ' remove trailing /
    End If
    strapURL = Tmp

End Function 
```

将此函数应用于工作表中的某些示例，您将产生

```
http://www.mydomain.com/    mydomain.com
www.mydomain.com/           mydomain.com
mydomain.com/               mydomain.com
http://www.mydomain.com     mydomain.com
www.mydomain.com            mydomain.com
mydomain.com                mydomain.com 
```

这使您可以“平等地”比较 URL。

# jquery - 混合 ZK 6 和 Jquery UI 组件？

> ID：13941429
> 
> 赞同：1
> 
> 时间：2012-12-18T21:00:42.667
> 
> 标签：jquery, jquery-ui, zk

有谁知道如何将 JQuery UI 与 ZK 框架（ZKOSS）集成？我试图从 Maven 原型构建一个新组件，但对我来说似乎并不明显。

有谁知道教程或任何人都可以给我一些想法？提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-26T02:58:48.523

在 ZK 中有两种使用 JQuery UI 小部件的方法

1.  将其包装为 ZK 组件。使用 ZK 客户端 API 将您的 JQuery UI Widget 转换为 ZK 组件 Widget。这样你就可以在客户端和服务器端处理它。有关详细信息，请参阅[本文](http://books.zkoss.org/wiki/Small_Talks/2010/December/How_to_Wrap_a_jQuery_UI_Widget)

2.  只需在 ZK 客户端编程的帮助下在客户端使用它，如此处[所述](http://books.zkoss.org/wiki/Small_Talks/2009/July/ZK_5.0_and_jQuery_part_2)

有关使用 3rd 方 Javascript 库的更多通用指南，请参阅[此 smalltalk](http://books.zkoss.org/wiki/Small_Talks/2012/November/Integrate_3rd_Party_Javascript_Libraries_In_ZK)

# ruby - Rubyrep 与 Postgres-> PG::ERROR: 尝试扫描时连接已关闭

> ID：13941430
> 
> 赞同：2
> 
> 时间：2012-12-18T21:00:45.730
> 
> 标签：ruby, database-replication

我使用服务器信息设置了 ruby​​rep 配置文件。没有额外的选择。我测试了我是否可以使用 PGAdmin 从外部连接到两个数据库。

当我尝试它时，我在监控图上看到了连接峰值，所以它确实进入了那里并扫描了初始表。我认为*它也连接到第二张桌子，但它在某处中断。我得到的错误是

```
Exception caught: PG::Error: connection is closed: show search_path 
```

我在两个数据库上都有相同的架构。我的 ruby​​rep 版本是 1.20，我的 pg 版本是 0.14，我尝试了 0.11 和 0.12，因为我在一些问题中看到它修复了一些连接问题，但我仍然有问题。我不确定还有什么可以尝试的。

* * *

添加更多信息

当我尝试 2 个本地数据库时 - 没有问题。所以我的设置似乎没有问题。当我将地址更改为外部数据库时，我想从上述问题中复制的地址再次发生。

当我对此进行测试时，我看到了相应的负载峰值，但是没有返回任何数据。我对服务器的访问权限有限，因此无法检查服务器日志中是否存在实际上导致 ruby​​ rep 给我该错误的问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-22T13:42:48.240

我找到了答案。只需使用此存储库[https://github.com/ncoders/rubyrep](https://github.com/ncoders/rubyrep)！

# r - 如何通过R删除字符串中的反斜杠

> ID：13941433
> 
> 赞同：2
> 
> 时间：2012-12-18T21:00:54.143
> 
> 标签：r

我需要删除字符串中的所有反斜杠，如下所示。 `x <- ' [{\"Petal.Width\" : 1.8, \"Species\" : \"virginica\" } ] '`

我想要的结果字符串是 `[{"Petal.Width" : 1.8, "Species" : "virginica" } ]`

我尝试了一些不起作用的方法。 `gsub("\\\\", "\\", x)`

有人可以提出一些方法吗？非常感谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:17:38.660

反斜杠是 R 在字符串中转义引号的方式（请参阅 参考资料`?Quotes`）。您不太可能必须删除它们。例如，如果您希望将对象`x`用作绘图的标题，则不会出现反斜杠：

```
plot(1, 1, main = x) 
```

![在此处输入图像描述](../Images/a50da73b6a0aacbb36c0beea4c34ca1a.png)

# python - smtplib 电子邮件格式

> ID：13941436
> 
> 赞同：0
> 
> 时间：2012-12-18T21:01:01.357
> 
> 标签：python

我正在使用 smtplib 用 python 发送电子邮件。我可以让电子邮件在正文中包含我想要的信息，但我找不到一个很好的资源来查看如何格式化邮件本身。

谁知道一个好的资源......

我有一个列表，我想迭代并在其间放置行。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:05:22.550

这更像是一个电子邮件问题，而不是一个 python 问题。我会参考电子邮件上的 RFC。但是，要在正文之间解决您的问题，您应该放置一个 CRLF

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-22T12:05:04.267

我也在做同样的事情，所以我将与您分享。注意：您只能进行简单的格式化（如简单的表格、粗体文本）

示例如下：

```
log = open("xyz.txt","r")
lines = [line.strip() for line in log]
FROM = 'abc@abc.com'
TO = 'abc@abc.com'
SMTP_TO = ['abc@abc.com']
mail_sub = 'Test Mail'
message = """From: abc@abc.com>
To: abc@abc.com>
MIME-Version: 1.0
Content-type: text/html
Subject: """ + mail_sub + """

Hello,
<br></br>
<br><b>Your message from text file is given below</b></br>
"""+'\n'.join(lines)+"""
<br><b>Thank you.</b></br>
"""
smtpObj = smtplib.SMTP('adress','port')
smtpObj.sendmail('%s'%FROM,SMTP_TO,message) 
```

上面的代码从文件中读取数据`xyz.txt`并将其嵌入到电子邮件中`'\n'.join(lines)`

希望对你有帮助，谢谢。

# php - JSON数组不打印键

> ID：13941440
> 
> 赞同：0
> 
> 时间：2012-12-18T21:01:24.783
> 
> 标签：php, mysql, json

从查询中获取 JSON 数组。它不是在数据中打印密钥。

我的期望：

```
["0":"3675E5010E2738","1":"4114009","2":"2012-11-05","3":"Active","4":"2012-12-11"] 
```

我得到什么...

```
["3675E5010E2738","4114009","2012-11-05","Active","2012-12-11"] 
```

JSON 由 PHP/JSON 编码生成：

```
$array = $model->ListData();
echo json_encode($array); 
```

我已经尝试加载两者`loadRowList();`并且`loadAssocList();`都没有生成密钥。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:06:05.670

因为这不是 JSON 表示数组的方式

`["0":"3675E5010E2738","1":"4114009","2":"2012-11-05","3":"Active","4":"2012-12-11"]`不是有效的 JSON。

`{"0":"3675E5010E2738","1":"4114009","2":"2012-11-05","3":"Active","4":"2012-12-11"}`是，但那是对象的表示，而不是数组。

如果`$model->ListData();`返回一个数组，正如您的代码所暗示的那样，那么您得到的表示是正确的。

无论如何，既然`json[0]`会以同样的方式工作，不管它是一个数组还是一个带有数字键的对象，那有什么关系呢？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:05:33.723

您有从 0 开始按顺序排列的数字键。您不需要存在键来正确解释它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:25:31.000

请记住，JSON 是 javascript 对象表示法，这意味着它使用 javascript 语法。

var myObject = { 0: '零', 1: '一', 2: '二' }; var myArray = ['零'，'一'，'二'];

数组和对象用于不同的目的。对象支持键，数组不支持。

# xml - XQuery：最多只有几个数据？

> ID：13941441
> 
> 赞同：0
> 
> 时间：2012-12-18T21:01:27.647
> 
> 标签：xml, xquery

我有一个这样的 XML 文件：

```
<mountain>
   <altitude>3780</altitude>
</mountain>
<mountain>
   <altitude>4355</altitude>
</mountain>
... 
```

我想得到最大值，所以我当然可以使用**max(//mountain/altitude)**，我应该得到 8848（珠穆朗玛峰），但有些条目是错误的，所以一开始我只想保持高度 < 9000 ，然后找到所有这些之间的 max()。我应该怎么做 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:06:02.347

谓词应该可以解决问题：

```
max(//mountain/altitude[. lt 9000]) 
```

# asp.net - CrystalDecisions.Web 运行 webapp 时参考版本突然变化

> ID：13941444
> 
> 赞同：0
> 
> 时间：2012-12-18T21:01:33.067
> 
> 标签：asp.net, crystal-reports

我对这个问题感到头疼，我有一个 web 应用程序，它有一个使用水晶报告的报告，在开发电脑上它工作正常，但是当我将同一个项目复制到另一台电脑时，当我加载项目时（VS 2003）出现以下味精：

`One or more projects in solution need to be updated to use Crystal Reports XI Release 2\. If you choose "Yes", the update will be applied permanently...`

我选择“是”，然后我可以看到 CrystalDecisions.Web 引用具有正确的版本，并且根据开发机器的位置，在本例中为：11.5.3300.0。

但是在运行webapp时，我可以看到版本和路径突然变为：11.0.3300.0。

并且在尝试查看报告时出现以下错误：

**解析器错误消息：**基类包含字段“CrystalReportViewer1”，但其类型 (CrystalDecisions.Web.CrystalReportViewer) 与控件类型 (CrystalDecisions.Web.CrystalReportViewer) 不兼容。

**asp.net 有以下内容：**

```
<%@ Register TagPrefix="cr" Namespace="CrystalDecisions.Web" Assembly="CrystalDecisions.Web, Version=11.5.3300.0, Culture=neutral, PublicKeyToken=692fbea5521e1304" %> 
```

这怎么可能？这里发生了什么事？

**编辑** 这就是我所做的：

错误的版本 (11.0.3300.0) 位于： `C:\Program Files\Common Files\Business Objects\3.0\managed`

正确的版本（11.5.3300.0）位于： `C:\Program Files\Business Objects\Common\3.5\managed`

所以我只是删除了错误解决方案的文件，并使其在我的新计算机上运行，​​运行 webapp 时不再出现错误，报告显示正常。

但是当尝试在生产服务器中做同样的事情时，出现了一个不同的错误，现在是一个异常：

`This report could not be loaded due to the following issue: The type initializer for 'CrystalDecisions.CrystalReports.Engine.ReportDocument' threw an exception.`

知道现在可能导致此错误的原因是什么吗？

这是代码：

```
Try
            Dim cr As New ReportDocument
            cr.Load(strpath)
            cr.SetDatabaseLogon("user", "pwd")
            Select Case rt
                Case 1
                    cr.SummaryInfo.ReportTitle = "RMA Ticket"
                Case 2
                    cr.SummaryInfo.ReportTitle = "Service Ticket"
            End Select
            'cr.SummaryInfo.ReportTitle = tt
            cr.SetParameterValue("TicketNo", tn)
            'cr.SummaryInfo.ReportComments = comment
            CrystalReportViewer1.PrintMode = CrystalDecisions.Web.PrintMode.ActiveX
            CrystalReportViewer1.ReportSource = cr
            CrystalReportViewer1.ShowFirstPage()
            'cr.Close()
            'cr.Dispose()
        Catch ex As Exception
            MsgBox1.alert("This report could not be loaded due to the following issue: " & ex.Message)
        End Try 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:10:30.557

.dll 可能有一些问题。尝试从解决方案中更新甚至删除 .dll 并重新链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-31T16:52:16.173

我认为每个人对这件事都有自己的噩梦：\

就我而言，业务视图管理器没有完全安装。成功安装后，报告变得完美。

# ios - NSArray 对另一个 NSArray 字符串排序

> ID：13941448
> 
> 赞同：2
> 
> 时间：2012-12-18T21:01:48.997
> 
> 标签：ios, sorting, nsstring, nsarray

我觉得这很简单，但我就是无法理解它。我有一组用户可以选择的一周中的几天：

```
NSArray * daysOfTheWeek = [NSArray arrayWithObjects:@"sunday", @"monday", @"tuesday", @"wednesday", @"thursday", @"friday", @"saturday", nil]; 
```

我作为打开和关闭日期的开关，我想根据 NSArray 对所选日期的`dayOfTheWeek`NSArray 进行排序。因此，如果用户有：

```
NSArray * userDays = [NSArray arrayWithObjects:@"thursday", @"monday", @"friday"]; 
```

我想对它进行排序，以便星期一、星期四、星期五。

我似乎发布了一些类似的问题，但没有一个足够清楚让我知道如何将它们应用于此。可能是我睡眠不足:)

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:10:19.260

```
NSArray *sortedUserDays = [userDays sortedArrayUsingComparator:^(id a, id b) {
    return [@([daysOfTheWeek indexOfObject:a]) compare:@([daysOfTheWeek indexOfObject:b])];
}]; 
```

**编辑：**这使用块作为比较器对数组进行排序。

为了比较`userDays`数组的两个元素，它首先在模板数组中搜索它们的位置`daysOfTheWeek`：`[daysOfTheWeek indexOfObject:a]`

然后它将位置包装到 NSNumbers:`@(index)`中。

接下来它调用`compare:`包装的索引。这只是`NSComparisonResult`为两个`NSUInteger`职位返回 an 的一种懒惰方式。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-12-18T21:20:24.407

您可以执行此操作的另一种方法是使用用户选项简单地过滤您的星期几。

```
NSArray *sortedUserDays = [daysOfTheWeek filteredArrayUsingPredicate:[NSPredicate predicateWithFormat:@"SELF in (%@)", userDays]]; 
```

# video-streaming - 准备使用 Red5 应用程序

> ID：13941455
> 
> 赞同：1
> 
> 时间：2012-12-18T21:02:14.630
> 
> 标签：video-streaming, red5

我正在寻找一个现有的 Red5 应用程序。

我们的需求非常基本：
* 只需要一个提要
* 通过 IP 地址或用户/通行证限制广播
* 通过用户/通行证或令牌限制观看

我找到[了 videowhisper](http://www.videowhisper.com/?p=RTMP+Applications)，但它似乎缺乏身份验证功能。

开源应用程序会很棒，但如果成本不太高，我可以接受商业产品。

RTMPT 解决方案似乎很适合限制观看访问，但任何人仍然可以在未经授权的情况下在我的服务器上开始广播。如何限制广播访问？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-20T10:24:33.537

我正在使用以下使用 RTMPT（RTMP over HTTP）的 IP 安全机制：

所有 RTMPT 请求都通过在我的 apache 配置中使用 mod_proxy 传递到 red5（端口 5080），除了 /open/1 请求：

```
#send open/1 request to authentification script:
Alias /open/1 /var/www/html/auth.php

#other RTMP request directly to red5:
ProxyPass /send http://localhost:5080/send
ProxyPassReverse /send http://localhost:5080/send
ProxyPass /idle http://localhost:5080/idle
ProxyPassReverse /idle http://localhost:5080/idle
ProxyPass /close http://localhost:5080/close
ProxyPassReverse /close http://localhost:5080/close
ProxyPass /fcs http://localhost:5080/fcs
ProxyPassReverse /fcs http://localhost:5080/fcs 
```

当用户启动播放器时，网页将首先联系一个 php 脚本来验证用户是否已登录。如果是这样，它的 IP 地址将被临时存储，包括当前时间（时间戳）。然后 RTMPT 流将在端口 80 上启动。现在 auth.php 脚本将接收来自播放器的 /open/1 请求。它将检查 IP 地址和时间戳。如果 IP 地址存在且时间戳不超过 3 秒，则 /open/1 请求将传递给 red5。结果（标识符）被传回给玩家。在 PHP 中：

```
<?php
 //after user is verified, send /open/1 request to red5:
 $data = `curl -s -F a=b localhost:5080/open/1`;
 $data_size = strlen($data);

 header("Content-Type: application/x-fcs");
 header("Connection: Keep-Alive");
 header("Content-Length: $data_size");
 header('Cache-Control: no-cache');

 echo $data;  //return answer from red5 (identifier) back to player
 exit;
?> 
```

不幸的是，/open/1 请求不包含来自网页的任何 cookie 或引用信息，只有来自客户端的 REMOTE_ADDR（IP 地址）和 REQUEST_TIME 是来自 PHP $_SERVER 变量（使用 JW-player）的有用信息。

# ios - 集合视图或表格视图

> ID：13941462
> 
> 赞同：2
> 
> 时间：2012-12-18T21:02:45.457
> 
> 标签：ios, xcode, collections, uicollectionview

我试图让一个简单的集合视图工作。基本上，我希望集合视图与数据库中的表完全一样，其中包含可以水平滚动的行和列。像这样的东西：

玩家 1 单元 1 单元 2 单元 3 单元 4 ... 单元 20

玩家 2 单元 1 单元 2 单元 3 单元 4 ... 单元 20

<----------- 滚动--------------->

我正在使用集合视图，因此我可以准确地确定玩家正在单击的单元格，并且与 tableview 相比，它似乎总体上会给我更大的灵活性。

问题是我无法在我的一生中让集合视图像我想要的那样显示。单元格垂直堆叠...示例（无法使它们保持在一行中并水平滚动以查看该行的其他列。示例...

玩家 1 细胞 1 细胞 2 细胞 3

单元 4 单元 6 单元 7 ...

玩家 2 细胞 1 细胞 2 细胞 4

单元格 4...

我开始认为，也许集合视图不是一个好的 api，也许我应该简单地使用一个 tableview。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T23:19:48.440

这是我的尝试。它有效，但由于这是我第一次尝试自定义布局，我确信可以做一些事情来改进它。我使用以下代码创建了一个名为 MultipleLineLayout 的 UICollectionViewFlowLayout 子类：

```
@implementation MultpleLineLayout {
    NSInteger itemWidth;
    NSInteger itemHeight;
}

-(id)init {
    if (self = [super init]) {
        itemWidth = 60;
        itemHeight = 60;
    }
    return self;
}

-(CGSize)collectionViewContentSize {
    NSInteger xSize = [self.collectionView numberOfItemsInSection:0] * (itemWidth + 20) + 60;
    NSInteger ySize = [self.collectionView numberOfSections] * (itemHeight + 20) ;
    return CGSizeMake(xSize, ySize);
}

- (UICollectionViewLayoutAttributes *)layoutAttributesForItemAtIndexPath:(NSIndexPath *)path {
    UICollectionViewLayoutAttributes* attributes = [UICollectionViewLayoutAttributes layoutAttributesForCellWithIndexPath:path];
    NSInteger xValue;
    if (path.row == 0) {
        itemWidth = 120;
        attributes.size = CGSizeMake(itemWidth,itemHeight);
        xValue = itemWidth/2 + path.row * (itemWidth +20);
    }else{
        itemWidth = 60;
        attributes.size = CGSizeMake(itemWidth,itemHeight);
        xValue = itemWidth/2 + path.row * (itemWidth +20) + 60;
    }
    NSInteger yValue = itemHeight + path.section * (itemHeight +20);
    attributes.center = CGPointMake(xValue, yValue);
    return attributes;
}

-(NSArray*)layoutAttributesForElementsInRect:(CGRect)rect {
    NSInteger minRow =  (rect.origin.x > 0)?  rect.origin.x/(itemWidth +20) : 0; // need to check because bounce gives negative values  for x.
    NSInteger maxRow = rect.size.width/(itemWidth +20) + minRow;
    NSMutableArray* attributes = [NSMutableArray array];
    for(NSInteger i=0 ; i < self.collectionView.numberOfSections; i++) {
        for (NSInteger j=minRow ; j < maxRow; j++) {
            NSIndexPath* indexPath = [NSIndexPath indexPathForItem:j inSection:i];
            [attributes addObject:[self layoutAttributesForItemAtIndexPath:indexPath]];
        }
    }
    return attributes;
} 
```

这是视图控制器中的代码：

```
#import "ViewController.h"
#import "MultpleLineLayout.h"

@interface ViewController ()
@property (strong,nonatomic) UICollectionView *collectionView;
@property (strong,nonatomic) NSArray *theData;
@end

@implementation ViewController

- (void)viewDidLoad {
    self.theData = @[@[@"Player 1",@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9",@"10",@"11",@"12",@"13",@"14",@"15",@"16",@"17",@"18",@"19",@"20"], @[@"Player 2",@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9",@"10",@"11",@"12",@"13",@"14",@"15",@"16",@"17",@"18",@"19",@"20"],@[@"Player 3",@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9",@"10",@"11",@"12",@"13",@"14",@"15",@"16",@"17",@"18",@"19",@"20"],@[@"Player 4",@"1",@"2",@"3",@"4",@"5",@"6",@"7",@"8",@"9",@"10",@"11",@"12",@"13",@"14",@"15",@"16",@"17",@"18",@"19",@"20"]];
    MultpleLineLayout *layout = [[MultpleLineLayout alloc] init];
    self.collectionView = [[UICollectionView alloc] initWithFrame:self.view.bounds collectionViewLayout:layout];
    self.collectionView.dataSource = self;
    self.collectionView.delegate = self;
    layout.scrollDirection = UICollectionViewScrollDirectionHorizontal;
    self.view.backgroundColor = [UIColor blackColor];
    [self.view addSubview:self.collectionView];
    [self.collectionView registerClass:[UICollectionViewCell class] forCellWithReuseIdentifier:@"Cell"];
    [self.collectionView reloadData];
}

- (NSInteger)collectionView:(UICollectionView *)view numberOfItemsInSection:(NSInteger)section {
    return [self.theData[section] count];
}

- (NSInteger)numberOfSectionsInCollectionView: (UICollectionView *)collectionView {
    return [self.theData count];
}

- (UICollectionViewCell *)collectionView:(UICollectionView *)collectionView  cellForItemAtIndexPath:(NSIndexPath *)indexPath
{
    UICollectionViewCell *cell = [collectionView  dequeueReusableCellWithReuseIdentifier:@"Cell" forIndexPath:indexPath];
    [cell.contentView.subviews.lastObject removeFromSuperview]; //removes the label from a dequeued cell so we can make a new one of the right size.
    UILabel *label;
    if (indexPath.row == 0) {
        label = [[UILabel alloc]initWithFrame:CGRectMake(10, 15, 100, 30)];
    }else{
        label = [[UILabel alloc]initWithFrame:CGRectMake(10, 15, 40, 30)];
    }
    label.backgroundColor = [UIColor yellowColor];
    label.textAlignment = NSTextAlignmentCenter;
    label.text = self.theData[indexPath.section][indexPath.row];
    [cell.contentView addSubview:label];
    cell.backgroundColor = [UIColor orangeColor];
    return cell;
}

- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:(NSIndexPath *)indexPath {
    UICollectionViewCell *item = [collectionView cellForItemAtIndexPath:indexPath];
    NSLog(@"%@",[(UILabel *)item.contentView.subviews.lastObject text]);

} 
```

所以，我的数据被设置为一个数组数组，每个子数组是一个球员和他的分数。这种布局似乎确实使每个玩家单元格保持在一条水平线上。我将每行的第一个单元格放大以保存球员姓名——我不确定处理这个较大单元格的最佳方法是什么。我已经硬编码了一些数字，但这可能不是最好的方法。

我欢迎任何改进或修复的建议。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T07:12:26.303

UICollectionView 非常强大且易于扩展，因为它添加了一个新功能：UICollectionViewFlowLayout。恐怕您无法在 Cocoa 中默认实现所需的完美解决方案，但是在您的情况下将 UICollectionViewFlowLayout 扩展到新布局可能是蛇式布局，这很容易。

如果有任何帮助，也许您可​​以查看这个 github 网址：[KMCollectionViewSnakeLayout](https://github.com/kimimaro/KMKit)以获得一些提示。这不是这样的风格：

```
Player 1 cell 1 cell 2 cell3

cell 4 cell 6 cell 7 ...

Player 2 cell 1 cell 2 cell4

cell 4... 
```

但是是这样的风格：

```
Player 1 cell 1 cell 2 | Player 2 cell 1 cell 2

cell3 cell 4 cell 6    | cell3 cell 4 cell6

cell 7 ...             | cell7 
```

花点时间阅读它或 Apple Doc，你会得到很多！

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:09:39.973

我个人没有使用过这个，但似乎在其他 SO 帖子上推荐：

[https://github.com/TheVole/Horizo​​ntalTable](https://github.com/TheVole/HorizontalTable)

也许这可能比 a 更好用`UICollectionView`？

（另见这篇文章：[如何在 iPhone 上制作水平 UI 表格视图？](https://stackoverflow.com/questions/2834840/how-to-make-a-horizontal-ui-table-view-on-iphone)）

祝你好运！

# azure - Azure ServiceConfiguration.Cloud.cscfg 文件的更改

> ID：13941467
> 
> 赞同：1
> 
> 时间：2012-12-18T21:02:56.807
> 
> 标签：azure

当我更改云部署应用程序的设置文件 (ServiceConfiguration.Cloud.cscfg) 时发生的事件顺序是什么？工作人员角色是否会重新启动以反映新的更改？（是否会在更改设置值时触发 OnStop、OnStart、Run 事件？）

在我的云服务中，我从 WorkerRole 的 Run() 方法中的配置文件中读取自定义值，并想知道对部署在云中的应用程序的 ServiceConfiguration.Cloud.cscfg 文件的任何更改是否会重新触发 OnStart 和 Run事件？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:18:38.570

确实，您的实例将在每次配置更改后通过 OnStop / (Reboot) / OnStart / Run。例如，如果您将应用程序中的设置存储在静态变量中，那么让这种情况发生可能是一件好事。这样，重新启动后，您的应用程序将重新启动，并且有机会重新初始化静态变量中的所有设置。

另一方面，如果您希望实例重新启动，您可以自己处理此更改（也许您将设置缓存在某处，或者在没有这些设置的情况下初始化静态对象）。您需要通过处理[RoleEnvironment.Changing](http://msdn.microsoft.com/en-us/library/microsoft.windowsazure.serviceruntime.roleenvironment.changing.aspx)事件来触发重启：

```
public override bool OnStart()
{
   RoleEnvironment.Changing += RoleEnvironmentChanging;

   return base.OnStart();
}

private void RoleEnvironmentChanging(object sender, RoleEnvironmentChangingEventArgs e) 
{
   if ((e.Changes.Any(change => change is RoleEnvironmentConfigurationSettingChange))) 
   {
      e.Cancel = true;
   }
} 
```

# flash - FDT 找不到 Flash 播放器

> ID：13941468
> 
> 赞同：0
> 
> 时间：2012-12-18T21:02:57.110
> 
> 标签：flash, fdt

我使用 FlashDevelop 3 年了，一切运行良好。现在我必须使用 Mac 。我有一些麻烦，我是 FDT 的新手，我无法构建我的项目。我从 Internet 下载了一个 AIR-Flex 组合 SDK，因为我在将 AIR3.5 SDK 复制到 Flex4.6 文件夹时遇到了一些麻烦。某些文件夹/文件被替换但未合并。

# 案例 1：AIR 项目。

我创建了一个 AIR 项目，选择在桌面（而不是设备）上运行并运行没有窗口出现的项目。控制台的信息是有线的。

运行模式：

```
Starting Launcher FDTTest-FDTTest.

Using: Flex SDK Compiler
Starting Incremental Build of FDTTest-FDTTest.

File /Users/Feng/Documents/Workspace/FlashWork/FDTTest/bin/FDTTest.swf has not changed.
Build successful.

Launching AIR Debug Launcher
/Users/Feng/Documents/Tools/flex_sdk_4.6_air3.5_fp11.5/bin/adl
    -nodebug
    -profile
    extendedMobileDevice
    -screensize
    480x762:480x800
    /Users/Feng/Documents/Workspace/FlashWork/FDTTest/bin/FDTTest-app.xml
    /Users/Feng/Documents/Workspace/FlashWork/FDTTest/bin 
```

调试模式：

```
[Info] Listening to port 7935.
[Info] Could not connect to the player, will try to connect for the next 72000 ms 
```

# 案例 2：SWF 项目

我创建了一个 swf 项目，可以看到带有外部播放器（java）但看不到 adobe flash 播放器的窗口。

我下载了最新的 adobe flash 调试播放器并将它们安装在我的 Mac OSX 10.8 上。但是当我尝试设置 FDT -> 首选项 -> FDT -> 工具 -> Flash -> FlashPlayer 的路径时，我找不到 Flash 播放器独立文件。

我检查了用户/库和其他文件夹，但找不到。我已经挣扎了好几个小时。谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T16:18:45.327

您可以尝试以下方法：

下载文件：

[http://labs.adobe.com/downloads/flashplayer.html](http://labs.adobe.com/downloads/flashplayer.html) 下载适用于 Mac OS X 32 位的独立调试器（DMG，14.5 MB）

将 Flash Player 安装到您的应用程序文件夹。

您可以在此处找到 Flash Player 调试器二进制文件：

> /Application/Flash Player.app/Contents/MacOS/Flash Player 调试器

请注意，浏览仅适用于应用程序级别。您需要使用调试器的直接路径。

# xcode - Xcode，查看方法在哪里使用

> ID：13941470
> 
> 赞同：6
> 
> 时间：2012-12-18T21:03:11.737
> 
> 标签：xcode

我在某个类中有一个方法，我想看看它在哪里被使用。与 Java 和 Eclipse 相比，您可以简单地告诉它显示所有引用，甚至显示方法的调用层次结构。Xcode中有类似的东西吗？

我知道 Objective-C 没有遵循与 Java 相同的方法签名识别方法（即，类没有方法，只有一堆在运行时映射到 id 的选择器），所以我很难过试图弄清楚 Xcode 是如何做到这一点的。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T21:18:11.050

看这里：

![在此处输入图像描述](../Images/6e4d2cd1965af00722335ebab9b532f6.png)

没有等效的菜单或上下文菜单。除了调用者之外，您还可以访问被调用者、超类等。

如果您不使用`Ctrl-1`Spaces，您可以使用它访问该菜单。

请注意，您需要使用标准或助理编辑器： ![在此处输入图像描述](../Images/b965ffe02cf653dc0c597466b8ff2630.png)

如果选择了版本编辑器，则不会显示调用者和被调用者： ![在此处输入图像描述](../Images/9f9605e5e17de7739edcf60bdf7b50a7.png)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:17:10.253

您最好的选择可能是字符串搜索，但要意识到您可以使用模式（单击文件浏览器窗格中搜索栏中的小放大镜）。

您已经暗示了其他方式很难做到的原因之一。Objective-C 的运行时允许许多不同的方式来查找和执行代码。

# python - Python样条曲线或其他在x轴上随时间工作的插值？

> ID：13941472
> 
> 赞同：8
> 
> 时间：2012-12-18T21:03:21.513
> 
> 标签：python, scipy, pandas

尝试使用非常有用的 pandas 将数据处理为时间序列，我现在绊倒了这样一个事实，即似乎不存在可以直接插值（使用样条线或类似物）对 DateTime 作为 x-的数据的库轴？我似乎总是被迫首先转换为一些浮点数，比如自 1980 年以来的秒数或类似的东西。

到目前为止，我一直在尝试以下事情，对于奇怪的格式感到抱歉，我只有在 ipython 笔记本中有这些东西，而且我无法从那里复制单元格：

```
from scipy.interpolate import InterpolatedUnivariateSpline as IUS
type(bb2temp): pandas.core.series.TimeSeries
s = IUS(bb2temp.index.to_pydatetime(), bb2temp, k=1)
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-67-19c6b8883073> in <module>()
----> 1 s = IUS(bb2temp.index.to_pydatetime(), bb2temp, k=1)

/Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/site-packages/scipy/interpolate/fitpack2.py in __init__(self, x, y, w, bbox, k)
    335         #_data == x,y,w,xb,xe,k,s,n,t,c,fp,fpint,nrdata,ier
    336         self._data = dfitpack.fpcurf0(x,y,k,w=w,
--> 337                                       xb=bbox[0],xe=bbox[1],s=0)
    338         self._reset_class()
    339 

TypeError: float() argument must be a string or a number 
```

通过使用`bb2temp.index.values`（看起来像这样：

```
array([1970-01-15 184:00:35.884999, 1970-01-15 184:00:58.668999,
       1970-01-15 184:01:22.989999, 1970-01-15 184:01:45.774000,
       1970-01-15 184:02:10.095000, 1970-01-15 184:02:32.878999,
       1970-01-15 184:02:57.200000, 1970-01-15 184:03:19.984000, 
```

) 作为 x 参数，有趣的是，Spline 类确实创建了一个插值器，但在尝试插值/外推到更大的 DateTimeIndex 时它仍然会中断（这是我在这里的最终目标）。看起来是这样的：

```
all_times = divcal.timed.index.levels[2] # part of a MultiIndex

all_times
<class 'pandas.tseries.index.DatetimeIndex'>
[2009-07-20 00:00:00.045000, ..., 2009-07-20 00:30:00.018000]
Length: 14063, Freq: None, Timezone: None

s(all_times.values) # applying the above generated interpolator
---------------------------------------------------------------------------
TypeError                                 Traceback (most recent call last)
<ipython-input-74-ff11f6d6d7da> in <module>()
----> 1 s(tall.values)

/Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/site-packages/scipy/interpolate/fitpack2.py in __call__(self, x, nu)
    219 #            return dfitpack.splev(*(self._eval_args+(x,)))
    220 #        return dfitpack.splder(nu=nu,*(self._eval_args+(x,)))
--> 221         return fitpack.splev(x, self._eval_args, der=nu)
    222 
    223     def get_knots(self):

/Library/Frameworks/EPD64.framework/Versions/7.3/lib/python2.7/site-packages/scipy/interpolate/fitpack.py in splev(x, tck, der, ext)
    546 
    547         x = myasarray(x)
--> 548         y, ier =_fitpack._spl_(x, der, t, c, k, ext)
    549         if ier == 10:
    550             raise ValueError("Invalid input data")

TypeError: array cannot be safely cast to required type 
```

我尝试使用`s(all_times)`and`s(all_times.to_pydatetime())`以及相同的`TypeError: array cannot be safely cast to required type`.

可悲的是，我是正确的吗？是否每个人都习惯于将时间转换为浮点数，以至于没有人认为这些插值应该自动工作是个好主意？（我最终会找到一个超级有用的项目来贡献..）或者你想证明我错了并获得一些 SO 积分？;)

编辑：警告：在将其交给插值例程之前，请检查您的 Pandas 数据中的 NaN。他们不会抱怨任何事情，只会默默地失败。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T21:44:00.597

问题是那些在下面使用的 fitpack 例程需要浮动。因此，在某些时候必须从日期时间转换为浮点数。这种转换很容易。如果`bb2temp.index.values`是您的日期时间数组，只需执行以下操作：

```
In [1]: bb2temp.index.values.astype('d')
Out[1]: 
array([  1.22403588e+12,   1.22405867e+12,   1.22408299e+12,
         1.22410577e+12,   1.22413010e+12,   1.22415288e+12,
         1.22417720e+12,   1.22419998e+12]) 
```

你只需要把它传递给你的样条线。并且要将结果转换回日期时间对象，您可以执行`results.astype('datetime64')`.

# android - 无法解析java中的某些xml

> ID：13941477
> 
> 赞同：0
> 
> 时间：2012-12-18T21:03:41.667
> 
> 标签：android, xml-parsing

我无法解析这个：

```
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
  <response>
     <status>OK</status>
     <time>2012-12-18 21:55</time>
  </response> 
```

通过代码：

```
InputStream is=sock.getInputStream();
        String sa="";
        int cc;
        while((cc=is.read())!=-1){
            sa+=(char) cc;
        }
ByteArrayInputStream sr=new ByteArrayInputStream(sa.getBytes());
DocumentBuilderFactory dbf=DocumentBuilderFactory.newInstance();
DocumentBuilder db=dbf.newDocumentBuilder();
Document doc=db.parse(sr); 
```

`sr`是`String`放置的地方。怎么可能？当我使用时，`doc.getNodeName`我得到空值。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:12:58.203

还有另一个可以解析您的输入流。试试这个，你将拥有完全的控制权

[使用java解析xml文件——基于android的应用程序](https://stackoverflow.com/questions/12855391/parsing-xml-file-using-java-for-android-based-application/12856079#12856079)

或者

```
public class Tester {

    String getString() throws IOException, ParserConfigurationException, SAXException {
        InputStream inputStream = getClass().getResourceAsStream("input.xml");
        String sa = "";
        int cc;
        while((cc = inputStream.read()) != -1) {
            sa += (char) cc;
        }
        ByteArrayInputStream sr = new ByteArrayInputStream(sa.getBytes());
        DocumentBuilderFactory dbf = DocumentBuilderFactory.newInstance();
        DocumentBuilder db = dbf.newDocumentBuilder();
        Document doc = db.parse(sr);

        Node node=doc.getDocumentElement().getFirstChild();
        String data=node.getNodeName();
        return data;
    }

    public static void main(String[] args) throws IOException, ParserConfigurationException, SAXException {
        Tester t = new Tester();
        System.out.println(t.getString());

    }

} 
```

# c# - PushSharp 总是返回设备过期

> ID：13941485
> 
> 赞同：0
> 
> 时间：2012-12-18T21:04:07.680
> 
> 标签：c#, apns-sharp, pushsharp

我正在尝试使用[https://github.com/Redth/PushSharp发送推送通知](https://github.com/Redth/PushSharp)

我按原样使用示例项目（已注释掉 program.cs 中的非 ios 内容），我确认我正在使用的应用程序是正确的应用程序，我已经重新生成了开发人员推送证书。

我正在从 xcode 运行应用程序，因此它是 devlopment providsioned..

该消息似乎很好，但随后又回来了

```
Waiting for Queue to Finish...
Sent: Apple -> {"aps":{"alert":"1 Alert Text!","badge":7,"sound":"default"}}
Queue Finished, press return to exit...
Device Subscription Expired: Apple -> [Device Id Removed] 
```

我正在从我的应用程序中获取设备 ID，以确认它被分解为十六进制八位字节，我只是删除了空格

所以......不知道从哪里开始，似乎apns说我的设备上不存在该应用程序，但它确实存在......

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-23T20:16:38.310

这几乎总是由于开发和生产配置文件证书之间的不匹配造成的。

检查您使用的是正确的...如果这仍然是一个问题！

# r - Rstudio 编辑器片段

> ID：13941487
> 
> 赞同：5
> 
> 时间：2012-12-18T21:04:21.150
> 
> 标签：r, rstudio, geany

Rstudio 是否具有配置代码片段的机制，例如 Geany？为了更快地编写用户预定义的频繁代码的整个部分。它与 rstudio 中已经内置的 TAB 补全并不完全相同。

**模仿 geany 片段的示例**

虽然片段定义如下所示：

```
fun = %cursor% <- function(x, ...)\s{\n\n}\n 
```

用法是这样的：

```
fun<TAB> (like bash style completion)
# will end up in following insertion:

 <- function(x, ...) {

} 
```

这样用户就可以使用自己的片段定义更快地编写代码。并且用户可以定义任何大小的任何片段以通过 TAB 完成。

它不是 Rstudio 提取 cmd，而是 Rstudio 现有的 TAB 上下文浏览器。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-04-09T01:21:47.857

RStudio 版本 0.99 中提供了代码片段。

[https://support.rstudio.com/hc/en-us/articles/204463668-Code-Snippets](https://support.rstudio.com/hc/en-us/articles/204463668-Code-Snippets)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T14:31:15.763

我不知道这样的功能。但是，如果您想通过小的更改快速实现功能，您也可以使用函数来实现。

* * *

好的，我现在清楚你的问题了。据我所知，Rstudio 目前没有这种功能。但是，您可以[在他们的论坛上](http://support.rstudio.org/help/discussions/suggestions)发布有关此功能的请求。他们非常积极地响应这些类型的请求，因此您可以尝试一下。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-01T20:55:58.937

RStudio 中的“提取函数”功能可能正是您想要的。向下滚动到 rstudio.com 文档页面上的提取函数部分和随附的屏幕截图：[http ://www.rstudio.com/ide/docs/using/source](http://www.rstudio.com/ide/docs/using/source)

该部分的文本内容为：“RStudio 可以分析源编辑器中的代码选择，并自动将其转换为可重用的函数。选择中的任何“自由”变量（在选择中引用但未创建的对象） ) 被转换为函数参数。”

另请参阅此屏幕截图：[http ://www.rstudio.com/images/screenshots/rstudio-code-transform.png](http://www.rstudio.com/images/screenshots/rstudio-code-transform.png)

# css - 如何创建一个主题化的网站？

> ID：13941489
> 
> 赞同：1
> 
> 时间：2012-12-18T21:04:31.167
> 
> 标签：css, html, themes, less

我正在开发一个网站，我希望允许用户切换主题（主要是颜色、字体等，而不是布局）。

我的想法是在 body 上有一个类，比如 theme1，然后将所有样式放在该类下：

```
.theme1{
    //less code here
}

.theme2{
    //less code here
} 
```

这样，为了切换主题，我所要做的就是替换 body 上的类。

这是一个很好的解决方案，有没有更好的方法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:09:30.570

如果您使用的是 LESS，那么将所有样式包装在一个

```
body.theme-class { } 
```

选择器。

这似乎是合理的；它使更改主题成为更改 body 标签上的类的简单案例。

# c# - linq 选择新的和字符串

> ID：13941490
> 
> 赞同：0
> 
> 时间：2012-12-18T21:04:34.427
> 
> 标签：c#, linq

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace ConsoleApplication1
{ 
    class TestIO
    {  
        static void Main()
        {
            string line = "first-main-in-c#";

            var stringQuery = from ch in line where Char.IsDigit(ch) select new string(ch + '-');

            foreach (var c in stringQuery)
                Console.Write(c); 
            Console.WriteLine(System.Environment.NewLine + "Press any key to exit");

            Console.ReadKey();  
        }
    }
} 
```

我是 c# 的初学者，我的错误是什么，我期望这个输出：

```
f-i-r-s-t-m-a-i-n-i-n-c 
```

但我得到：

```
System.Linq.Enumerable+WhereSelectEnumerableIterator`2[System.Char,<>f__Anonymou
sType0`1[System.Int32]] 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:08:59.640

Char.IsDigit 确定字符是否为十进制数字。该字符串中没有十进制数字字符。您可以使用`Char.IsLetter`or `Char.IsLetterOrDigit`，具体取决于您是否要包含数字。

您还在不存在的字符串上调用构造函数。您可以使用带有 char 数组的那个。

最后，查询将返回一个字符串序列。为了获得所需的结果（如您所说的一个字符串），考虑到上述内容的代码可能是：

```
string line = "first-main-in-c#";
var stringQuery = from ch in line where Char.IsLetter(ch) select new string(new char[] {ch, '-'});
string result = String.Join("", stringQuery); 
```

但是，这将包括 - 最后您需要修剪。`String.Join`用分隔符连接字符串，所以为了得到你想要的结果，这可能更简单：

```
string line = "first-main-in-c#";
var result = String.Join("-", from ch in line where Char.IsLetter(ch) select ch.ToString()); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:07:07.137

将字符转换为字符串的最简单方法是在`ToString`字符上使用。

`string`仅采用一个字符或一个字符串的构造函数没有重载。

您可以使用以下任何一种：

```
char c = 'a';

string s = c.ToString();
s = new string(c, 1);
s = new string(new[] { c });
s = c + ""; 
```

`new string`由于您将两个字符加在一起，您已经有了一个字符串，所以首先不需要：

```
var stringQuery = from ch in line
                  where Char.IsDigit(ch) 
                  select ch + '-'; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:12:18.230

您可以使用以下内容：

```
var stringQuery = from ch in line where Char.IsLetter(ch) select ch + "-"; 
```

您仍然需要修剪最后一个“-”以获得您想要的确切输出。

我希望这有帮助

# html - 星 ★ 在 Chrome 中不显示

> ID：13941492
> 
> 赞同：1
> 
> 时间：2012-12-18T21:04:49.663
> 
> 标签：html, google-chrome, firefox, html-entities

我有一些 html，其中星星只是在代码中，如下所示：

```
<strong>This is my ★ star, I'm not using entities!</strong> 
```

它适用于 Firefox，但不适用于 Chrome（显示一个框）。为什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-21T09:37:02.277

只是为了扩展 Gil 的答案，star 的 unicode 字符实体`&#9733;`没有在 Chrome 中为我显示，但在 Firefox 中。我发现正如 Gil 所说，当它在页面加载的 html 中时它确实在 Chrome 中工作，但是*当**随后*通过 ajax 加载包含星号的 html 时，它在 Chrome 中不起作用。

这是我修复它的方法：这不起作用......

```
<span>&#9733; &#9733; &#9733;</span> 
```

...但这确实-添加了CSS`text-rendering`声明...

```
<span style="text-rendering:auto;">&#9733; &#9733; &#9733;</span> 
```

作为记录，我在此站点上使用 Bootstrap。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:06:33.507

最好使用 HTML 特殊字符代码来显示它。

试一试`&#9733;`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T23:40:59.667

对于将来遇到此问题的任何人，在通过 JavaScript 设置页面元素的 HTML 时，该问题看起来像 Chrome 错误...

*更新*：centralscru 的回答为我解决了这个问题

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T21:09:04.327

通常，任何浏览器在其字符集中没有定义该字符时都会显示正方形。

那么您是否明确提供了一种字体，或者您是否依赖浏览器的默认设置？由于它存在于字符集中，因此显式更改字体可能会为您提供符号。

您可能还想考虑使用 HTML 字符代码 ( `&#9733;`)。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T21:41:39.890

为此使用字符代码！我正在使用 chrome，我可以看到很好！

# ruby-on-rails - XML 输入 Rails 对象

> ID：13941493
> 
> 赞同：0
> 
> 时间：2012-12-18T21:04:51.877
> 
> 标签：ruby-on-rails, ruby, xml

我正在与[Adcourier 合作](http://api.adcourier.com/docs/index.cgi?page=jobboards_overview)。他们向我发送了一个带有一些工作数据的 xml 提要，例如`job_title`，`job_description`等等。

我想在我的应用程序中为他们提供一个 url，即`myapp:3000/job/inbox`. 当他们将提要发送到该 URL 时，它会获取数据并将其存储在我的数据库中我已经创建的 Job 对象上。

1.  构建这个的最佳方法是什么？我对 MVC 很陌生，我不确定这样的东西适合哪里。

2.  我怎样才能得到一个动作来解释来自外部源的 XML 提要？我使用 Nokogiri 处理本地 XMl 文档，但从不使用来自提要的文档。

我正在考虑使用[http://api.rubyonrails.org/classes/ActionDispatch/Request.html#method-i-raw_post](http://api.rubyonrails.org/classes/ActionDispatch/Request.html#method-i-raw_post)来处理帖子。有没有人对此有任何想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T08:47:34.557

在您的作业控制器中添加一个操作收件箱，该收件箱从发布请求中获取正确的参数并保存它们（或您需要对其进行的任何操作）。

```
def inbox
  data = Xml::ParseStuff(params[:data])
  title = data[:title]
  description = data[:description]
  if Job.create(:title => title, :description => description)
    render :string => "Thanks!"
  else
    render :string => "Data was not valid :("
  end
end 
```

接下来设置您的 routes.rb 以将该 URL 的帖子请求发送到正确的位置

```
resources :jobs do
  collection do
    post 'inbox'
  end
end 
```

请注意，我只是在这里编写了 xml 解析的东西，只需谷歌一下，找出解析您的请求的最佳解决方案/宝石。

# node.js - 处理 Javascript 渲染与服务器端模板的最佳方法

> ID：13941496
> 
> 赞同：3
> 
> 时间：2012-12-18T21:05:21.713
> 
> 标签：node.js, model-view-controller, backbone.js, template-engine, singlepage

> **可能重复：**
> [在使用 Backbone.js pushstate 进行 seo/书签时重用服务器上的主干视图/路由](https://stackoverflow.com/questions/7098130/reusing-backbone-views-routes-on-the-server-when-using-backbone-js-pushstate-for)

我正在使用**Backbone.js**和一堆其他模块来处理**单页应用程序**方法。我的目标：

1.  该网站必须是 SEO 友好的

2.  服务器将 html 代码引导到客户端和存储在 JSON 模型中的数据。

3.  子序列操作全部由 Javascript 处理（例如渲染新屏幕，使用 Backbone 路由器更改 url）。

**我的问题是**：*如何构建服务器以与每个路由器 url 上的 Javascript 保持一致并保持**干燥**？*

**例如：**如果用户去`wwww.mysite.com`然后点击某个链接去`www.mysite.com/page/2`，它必须和他`www.mysite.com/page/2`在第一次加载时直接去一样。

这似乎是一个老话题，但我找不到任何关于在服务器端处理此问题的最佳方法的可靠资源，而无需在 Javascript 中重复模板代码。

我正在考虑的一个选择是将后端拆分为 Node.js 和另一台服务器以仅处理 API。Node.js 服务器以某种方式共享模板构造代码作为 Javascript 前端

无论如何，如果这不是提出此类问题的正确地方，我很乐意听到一些建议和道歉。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:51:00.893

我会将我的节点服务器视为我的数据的 REST 接口。然后我将在客户端处理其他所有事情：我可以使用[require.js](http://requirejs.org/)和像 jam 这样的模板插件[来](https://github.com/rocketlabsdev/require-jade)加载模板，使用 Backbone.Router 进行所有路由，然后使用 Backbone.sync 方法访问我的模型和集合（比如[`collection.fetch()`](http://backbonejs.org/#Collection-fetch)。）

例如，当用户访问“mysite.com/#page/2”时，我可以让我的 Backbone 路由器加载并显示页面上的任何模板。如果我碰巧需要在该页面上显示一个产品列表，那么我可以让我的`product`收藏做一个`product.fetch()`. 这会将 GET 请求发送到“/products”——或者在`product.url`. 然后，我的节点服务器将响应一组产品对象，我的集合所属的视图可以用于呈现自身。

# java - Java实例化参数化类型的类

> ID：13941506
> 
> 赞同：0
> 
> 时间：2012-12-18T21:06:06.807
> 
> 标签：java, generics, reflection

这是我所拥有的：

```
class Class1 <T>
{
     public void foo()
   {
      ParameterizedType parameterizedType = (ParameterizedType)getClass().getGenericSuperclass();
      Class<T> type = (Class<T>) parameterizedType.getActualTypeArguments()[0];
      System.out.println(type);
   }
}

class Class2 <G>
{
    public Class2 ()
    {
        Class1<G> class1 = new Class1<G>();
    }
} 
```

但是当我调用 class1.foo() 时，我得到的是超类而不是参数。

如果我做

```
Class1<String> class1 = new Class1<String>(); 
```

然后在 Class1 中调用 class1.foo()，得到 String。

如何修复以使用 Class2 的泛型类型实例化 Class1？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:45:22.397

你不能。在运行时，`Class2`不知道它的泛型类型参数是什么。

# javascript - 为什么得到有价值的回应？

> ID：13941509
> 
> 赞同：1
> 
> 时间：2012-12-18T21:06:21.940
> 
> 标签：javascript, xml, asp-classic, http-headers, xmlhttprequest

`request.asp`在我的页面下面的代码

```
<%
    dim http,http_response
    set http = createobject("msxml2.serverxmlhttp")
    http.open "GET", "http://domainname.com/test.asp", 0
    http.send ""
    http_response = http.responsetext
    response.write http_response
%> 
```

这是`test.asp`页面中的代码

```
<%
response.write "<response>test page</response>"
%> 
```

这是我运行`request.asp`页面时得到的响应

```
<frameset rows="100%,*" frameborder="no" border="0" framespacing="0">
    <frame src="http://domainname.com/?fp=ssl4sm3dbT82UQtwt%2FcElI%2F47tomswsXNyVoSMsfzsty1tUgidK8%2B%2FaJjeRd8ac1FUh%2FcmXV3MNb7AmhC4wlOQ%3D%3D&prvtof=zmVIoXe%2Fdx%2Faywx2PgM4XkFMifEssGS%2BBZ%2Bv8jbeBOk%3D&poru=tssDKxk5smXL0%2FeMnaWALWsu5YRg73QpTvCz8WHAcausUGwak41FGWvF7gnH7iHqUt%2F5cMy5W44y9ULdgKGAlnm9TKvHTUD9BHK09RHSEjP%2FzPHkJ%2Fwrt39XgUfQAyLUF6%2FcBnd3MXRAgR5GfzmUoHuFQmCYJH%2FEUhx1zwtrYNEoPNIwS%2Buj78ykAwnptmxiZW9xt139gcrHTu5VreWbbRnugsEEcQzyzi8GMRMkn5407WGwnrCK2wN8cuXYHNKdku0xjVFftA3HQ%2FjEnghyaUA4qii43c1vBidwn0t2tYfDGtqXXAwNgx%2FfxAJgl9XMW2V9%2BgplVT8jaOZiZMobPfRbqwT1xnab3abkOrvuFy6SB5bJT0KqgkPnxzPFnroPiTeiuKQ83KumBVASvugBWl0llS6qCH5FFcoAwoyVO34%3D&">

</frameset>

<noframes>

    <body bgcolor="#ffffff" text="#000000">

    <a href="http://domainname.com/?fp=ssl4sm3dbT82UQtwt%2FcElI%2F47tomswsXNyVoSMsfzsty1tUgidK8%2B%2FaJjeRd8ac1FUh%2FcmXV3MNb7AmhC4wlOQ%3D%3D&prvtof=uKpPMOl34IdXXSlj8gUi7lqY0vikl7iXCpbiTe9pUiQ%3D&poru=rbTj4%2BV%2BmkQH2cvm%2Fv7ahzD9D1YRsSnlfbxP8FyhsbQ9K%2F80EE0py7DsE7W2lWdTJRdJJOcUoO7W1We7VyW7YmRPGJUjz0DT6BNMP%2F86OZXXQzb7%2Foa4QdJ4VRcj4XSPMMw45DSw5PJ7UvSRIYrxV1KHSSUP%2Fgeos7Hjd9ndeKT7%2BO8SA1CJiOxj037xR3ppzX4wMCdJjAt6NlbdpSN4x5bHrLaxs5IUzUPMQPiAl31jA1RwSEKX%2F3JJPp%2FUB3lGOIGqilRliOfjGVoM2Ce5fojLDAH2UX3jOZmsRxiNmFa613TCXGB646iJEtjJwa44E%2FUelIbScYVNaKLGWouSod8Y8Qla%2FDpCZsKID3uu1u6Z0f3VoT89N0g6xowRsje6kvV4BaVdJmPanFb5%2Fc851WQbvCU5u547PneOko8%2BzHs%3D&">Click here to proceed</a>.

    </body>

</noframes> 
```

因为此响应无效

我用谷歌搜索了数据`?fp=&prvtof=&poru=&`。这样的网站有很多页面。我认为这有点像`Wayback Machine - Internet Archive`。但我对此一无所知。

1.  是病毒吗？
2.  iiS7 中是否有设置（我使用的是 windows 2008 服务器）？
3.  如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:13:25.210

1.  是病毒吗？不，[它只是一项服务](http://web.archive.org)，用于扫描站点并保持该站点的旧版本在线。将其视为时不时经过的搜索引擎/机器人。看看这个网站，没什么太邪恶的

2.  IIS7中有设置吗？当然，很多......但我认为可以在上述网站（存档内容）上注册/取消注册您的网站，这样爬虫就不会再次停下来。或者你可以忽略它。

3.  如何解决这个问题？见上文 - 也查看了存档的网站：[这是您需要做的以防止您的网站被抓取](http://archive.org/about/exclude.php)
    一个简单的 robots.txt 文件，该文件不允许`/`

# jdbc - Jasper Designer 和 BigQuery JDBC 驱动程序：无法使用某些关键字执行查询

> ID：13941511
> 
> 赞同：0
> 
> 时间：2012-12-18T21:06:35.873
> 
> 标签：jdbc, jasper-reports, google-bigquery

我正在使用***Jaspersoft iReport Designer*** 5.0.0 和 bqjdbc-0.1.jar（[一个**BigQuery JDBC 驱动程序**](http://code.google.com/p/starschema-bigquery-jdbc)），并且我想将查询与新报告相关联。

***我目前在使用关键字“ count*** ”或“ ***as*** ”的查询创建新报告时遇到了一些问题。如果我不输入这些关键字，我的查询将正常工作。

我觉得奇怪的是，如果我从“服务”窗口中的数据库连接中选择“执行命令...”，我的有问题的查询将起作用。

Jasper 4.8 也有同样的问题。我不确定问题出在 BigQuery 驱动程序还是 Jasper 上。

当我尝试将查询关联到新报告时出现的错误如下：

```
Message:
    net.sf.jasperreports.engine.JRException: General problem: null

Check username and password; is the DBMS active ?!
Level: SEVERE
Stack Trace:
General problem: null Check username and password; is the DBMS active ?!        
 com.jaspersoft.ireport.designer.data.fieldsproviders.SQLFieldsProvider.getFields(SQLFieldsProvider.java:172) 
 com.jaspersoft.ireport.designer.connection.JDBCConnection.readFields(JDBCConnection.java:472)
 com.jaspersoft.ireport.designer.wizards.ConnectionSelectionWizardPanel.validate(ConnectionSelectionWi    zardPanel.java:146)
 org.openide.WizardDescriptor$7.run(WizardDescriptor.java:1357)
 org.openide.util.RequestProcessor$Task.run(RequestProcessor.java:572)
 org.openide.util.RequestProcessor$Processor.run(RequestProcessor.java:997) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-01T15:07:13.330

这很有趣，您能给我们举一个您的查询示例吗？

对我来说，iReport 似乎想要阅读一些不存在的东西。

更大的问题是，我们的记录器并不真正喜欢 iReport，但如果您可以检查您的日志，那对我们来说将是一个很大的帮助。有关日志记录的更多信息： [http ://code.google.com/p/starschema-bigquery-jdbc/wiki/Logger](http://code.google.com/p/starschema-bigquery-jdbc/wiki/Logger)

在当前的 0.1 版本中，我们不对查询做任何事情，只需将其传递给 BigQuery。因此，如果您的查询在 BigQuery Browser Tool 上运行良好，那么它也应该在 Driver 上运行良好。

另外，我们并没有真正检查stackoverflow，所以请在这里发布您的问题，因为我们可以更快地回答您的问题，在那里：

[http://code.google.com/p/starschema-bigquery-jdbc/issues/entry](http://code.google.com/p/starschema-bigquery-jdbc/issues/entry)

# c# - 如何使用活动报告在 C# 中优化 PDF 和 PCL 创建3

> ID：13941525
> 
> 赞同：1
> 
> 时间：2012-12-18T21:07:42.253
> 
> 标签：c#

我正在为工作中的一个批处理优化性能。这个批处理从几个表中读取数据，人员 --> 就业 组装域对象

```
 Person
{
//person fields
List<IEmployment> EmploymentList
}
IEmployment
{
//employment fields
} 
```

, 创建 PDF 和 PCL 文件。我需要为每个人创建一个 PCL 和 PDF 文件。目前我正在遍历每个人，创建 ActiveReport 实例，将人设置为 ActiveReport 的数据源，创建 PCL，创建 PDF 并退出。我一次加载 500 条人员记录，创建 pcl 和 pdf 并阅读下 500 条未处理的人员记录。完成 500 条记录大约需要 5 分钟，有时我们可能需要处理 30,000 条记录，这相当于 5 小时。我正在尝试优化如果。请让我知道是否有更好的方法来生成这个批量 pdf 和 pcl。

# html - PySide QTextEdit html表格宽度

> ID：13941526
> 
> 赞同：3
> 
> 时间：2012-12-18T21:07:47.360
> 
> 标签：html, qt, pyqt, pyside, qtextedit

我正在尝试设置我的 html 表格的宽度以`QTextEdit`通过内联样式表获取我的总宽度，但表格的宽度不会改变。我试图以百分比（%）甚至像素（px）的形式给它赋值，但没有任何变化。你能看看吗？

```
#!/usr/bin/env python2

import sys
from PySide import QtGui, QtCore

class MainWid(QtGui.QWidget):
    htmlTable = '''<table border="1" style="width:100%"> <!-- XXX Nothing happens!! -->
        <tr><th colspan="2">HEADER</th></tr>
        <tr><td>name</td><td>value</td></tr>
        <tr><td>name</td><td>value</td></tr>
    </table>'''
    def __init__(self, parent=None):
        super(MainWid, self).__init__(parent)
        self.initgui()

    def initgui(self):
        lay = QtGui.QVBoxLayout()
        txt = QtGui.QTextEdit(self)

        lay.addWidget(txt)
        txt.setReadOnly(True)
        txt.setHtml(self.htmlTable)

        self.setLayout(lay)
        self.show()

def main():
    app = QtGui.QApplication(sys.argv)
    wid = MainWid()
    sys.exit(app.exec_())

if __name__=="__main__":
    main() 
```

我提前感谢大家。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-19T00:05:23.570

看看这是不是你要找的：

```
htmlTable = ''' <table border="1" width="100%">
                    <tr><th colspan="2">HEADER</th></tr>
                    <tr><td>name</td><td>value</td></tr>
                    <tr><td>name</td><td>value</td></tr>
                </table>
            ''' 
```

# javascript - 如何使用地图作为背景？

> ID：13941530
> 
> 赞同：2
> 
> 时间：2012-12-18T21:08:03.380
> 
> 标签：javascript, html, leaflet

我想做一些类似于 Foursqure.com 的事情。他们使用您当前位置的地图作为背景。我正在为我的地图使用[Leaflet ，并显示了地图。](http://leafletjs.com)我想如果我只是放一些类似的东西：

```
<div id="map">
    <h1>Welcome!</h1>
</div> 
```

然后欢迎！会覆盖在地图上。但是，我很天真，这不起作用。谁能建议我可以做到这一点的方法？

**编辑：** 这是我的一些自定义 CSS。我正在使用 Twitter 引导程序，因此它也会发挥作用。html 几乎就是我在这里展示的内容。

```
#map {
    width: 100%;
    height: 400px;
    z-index: 0;
}

.leaflet-container {
    background: #ffffff;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:53:05.993

`<div>`问题是 Leaflet 会吹掉你给它的任何内容。Leaflet 需要一个空的`<div>`.

只需在其余内容下方对地图进行 z-index 索引，它应该是地图元素的兄弟，而不是子元素。

```
<div id="map"></div>
<h1>Welcome!</h1> 
```

[演示](http://jsfiddle.net/josh3736/tnaVa/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:16:03.560

试试这个：

```
#map{
  position:fixed;
  width:100%;
  height:100%;
  z-index:0;
} 
```

任何其他内容都应使 z-index 高于 0

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-12-18T21:51:31.950

```
 z-index: -1; 
```

试试这个而不是 0

抱歉，这也不起作用，因为您在地图中有标题...您将不得不重组您的 html ..

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-30T09:50:59.093

将两个 div 作为兄弟，同时将地图作为第二个兄弟。两者都应该有一个绝对的位置。

在 HTML 代码中：

```
<div class="nxt-content">test</div>
<div id="map"></div> 
```

在 CSS 代码中：

```
#map {
   z-index: 0 !important;
   position: absolute;
   height: calc(100% - 56px);
   width: calc(100% - 15rem);
}

.nxt-content {
  z-index: 1 !important;
  position: absolute;
  height: 100px;
  padding: 20px;
  color: white;
  background: yellow;
} 
```

# wix - 在 WiX 中检查 .NET Framework 4.5 的属性参考是什么？

> ID：13941531
> 
> 赞同：5
> 
> 时间：2012-12-18T21:08:04.503
> 
> 标签：wix, .net-framework-version

我正在使用 WiX Toolset 3.7，我需要在我的安装程序中检查 .NET Framework 4.5 的安装。但是，[文档](http://wix.sourceforge.net/manual-wix3/wixnetfxextension.htm)似乎没有更新为包含 4.5 属性。有一个错误似乎暗示确实存在此类属性：[https](https://sourceforge.net/p/wix/bugs/3167/) ://sourceforge.net/p/wix/bugs/3167/ ，但我找不到参考。我尝试只复制 4.0 属性并使用 NETFRAMEWORK45FULL 但 WiX 编译器无法识别它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T21:44:15.323

在查看了 WiX 源代码后，我找到了这些属性。我决定使用的只是 NETFRAMEWORK45。其他可以在这里找到： [http ://wix.codeplex.com/SourceControl/changeset/view/62deafa7b2a4#src/ext/NetFxExtension/wixlib/NetFx4.5.wxs](http://wix.codeplex.com/SourceControl/changeset/view/62deafa7b2a4#src/ext/NetFxExtension/wixlib/NetFx4.5.wxs)

更新：移至[https://github.com/wixtoolset/wix4/blob/709560017c322dca0059d1c8849184e22b85bea7/src/ext/NetFxExtension/wixlib/NetFx4.5.wxs](https://github.com/wixtoolset/wix4/blob/709560017c322dca0059d1c8849184e22b85bea7/src/ext/NetFxExtension/wixlib/NetFx4.5.wxs)

# gwt - 在 GWT 客户端代码中检测 HTTPS

> ID：13941532
> 
> 赞同：0
> 
> 时间：2012-12-18T21:08:06.813
> 
> 标签：gwt

我希望我的登录页面的视图实现检测其页面是否已通过 HTTPS 下载。然后它可能会警告说，除非整个站点都通过 HTTPS 提供服务，否则登录将不起作用，因为我在服务器端进行了检查，并且由于它通常是不明智的。它可以避免通过常规 HTTP 发送任何密码。

有没有办法在 GWT 客户端代码中执行此操作而无需编写一些 Javascript？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:13:32.743

是的。这个测试应该这样做：

[Window.Location.getProtocol()](http://google-web-toolkit.googlecode.com/svn/javadoc/latest/com/google/gwt/user/client/Window.Location.html#getProtocol%28%29) .equals("https")

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T14:27:19.533

一个可能更好的选择是在您的用户点击您的登录页面后立即编写重定向到 https 规则（在服务器端），这样您就可以强制您的用户从登录过程开始就使用 https，然后再发送到您的服务器任何用户名/密码，因此它们保证被加密。

# map - Go：编辑代替地图值

> ID：13941534
> 
> 赞同：5
> 
> 时间：2012-12-18T21:08:13.740
> 
> 标签：map, go

我使用 golang.org 上的 Go Playground编写了一个[简单的程序。](http://play.golang.org/p/ChmeymPRHG)

输出显然是：

```
second test
first test 
```

有没有办法就地编辑地图值？我知道我不能接受`a.Things[key]`。那么，设置`a.Things[key] = firstTest`是唯一的方法吗？也许有一个功能`ChangeThing(key string, value string)`？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-12-18T21:26:04.683

您可以通过使映射指针的值指向另一个结构来做到这一点。

[http://play.golang.org/p/UouwDGuVpi](http://play.golang.org/p/UouwDGuVpi)

```
package main

import "fmt"

type A struct {
    Things map[string]*str
}

type str struct {
    s string
}

func (a A) ThingWithKey(key string) *str {
    return a.Things[key]
}

func main() {
    variable := A{}

    variable.Things = make(map[string]*str)
    variable.Things["first"] = &str{s:"first test"}

    firstTest := variable.ThingWithKey("first")
    firstTest.s = "second test"

    fmt.Println(firstTest.s)
    fmt.Println(variable.ThingWithKey("first").s)
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:30:29.237

您可以使用指针作为地图值[http://play.golang.org/p/BCsmhevGMX](http://play.golang.org/p/BCsmhevGMX)

# javascript - 滑块不显示在 chrome 中

> ID：13941535
> 
> 赞同：0
> 
> 时间：2012-12-18T21:08:18.587
> 
> 标签：javascript, html, css

这里。[http://www.host-bg.eu/](http://www.host-bg.eu/)我有一个滑块，我在 IE、mozilla 中看到它，但我在 google chrome 中看不到任何想法？

```
// Set up Sliders
        // **************
        $(function(){

            $('#slider1').anythingSlider({
                theme           : 'metallic',
                easing          : 'easeInOutBack',
                autoPlay        : true,

                navigationFormatter : function(index, panel){
                    return ['Slab', 'Parking Lot', 'Drive', 'Glorius Dawn', 'Bjork?', 'Traffic Circle'][index - 1];
                },
                onSlideComplete : function(slider){
                    // alert('Welcome to Slide #' + slider.currentPage);
                }

            });

            // tooltips for first demo
            $.jatt();

        });
    </script> 
```

# php - 我可以与免费的 HTTPS 服务共享 PHP 会话吗

> ID：13941538
> 
> 赞同：0
> 
> 时间：2012-12-18T21:08:33.630
> 
> 标签：php, http, session, ssl, https

我的客户希望我使用 Heart Internets SSL 证书设置免费的 HTTPS 服务。这是一个有效的证书。

heart internet（托管公司）这样做的方式是这样的：

网址： http: [//www.domain.com](http://www.domain.com) 免费 SSL：[https ://web000.secure-secure.co.uk/domain.com](https://web000.secure-secure.co.uk/domain.com)

问题是客户端正在使用 OpenCart 并依赖于会话。此会话包含活动登录和最重要的用户购物车中的项目。这些会话项目存储在标准 URL 中，是否也可以将它们添加到安全 URL 中？

谢谢彼得

# php - 无法使用肥皂连接到橙色 m2m

> ID：13941539
> 
> 赞同：1
> 
> 时间：2012-12-18T21:08:42.073
> 
> 标签：php, soap, wsdl, m2m

我正在尝试*`soap connection`*使用该标准创建一个*`php soap client`*，我相信它的编码都是正确的，但是我收到了这个错误：

```
 Fatal error: Uncaught SoapFault exception: [WSDL] SOAP-ERROR: Parsing WSDL: Couldn't load from 'https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl' : Start tag expected, '<' not found in C:\wamp\www\php\run.php:16 Stack trace: #0 C:\wamp\www\php\run.php(16): SoapClient->SoapClient('https://m2mconn...') #1 {main} thrown in C:\wamp\www\php\run.php on line 16 
```

从我在网上发现的情况来看，似乎一个问题可能与端口有关，但我不确定要检查/使用哪些端口或如何检查。

我也不确定这是否与我的互联网连接有关，因为从一个路由器到另一个路由器有点奇怪。

这是我的代码：

```
$client = new SoapClient("https://m2mconnect.orange.co.uk/orange-soap/services/MessageServiceByCountry?wsdl"); 
```

# python - 无法从 Python 迭代 VBA 宏

> ID：13941540
> 
> 赞同：4
> 
> 时间：2012-12-18T21:08:48.697
> 
> 标签：python, vba, excel, win32com

我将 VBA 与 Python 结合使用。

我导入了模块 OS，并使用 excel - openpyxl。当它迭代从 Excel 运行 VBA 宏的函数时会出现问题。

```
import random
from openpyxl import load_workbook
import os, os.path, win32com.client

wbi = load_workbook('Input.xlsm')
wsi = wbi.get_active_sheet()
wbo = load_workbook('Output.xlsx')
wso = wbo.get_active_sheet()

def run_macro(fName, macName, path=os.getcwd()):
    """    
    pre: fName is the name of a valid Excel file with macro macName
    post: fName!macName is run, fName saved and closed
    """
    fName = os.path.join(path, fName)
    xlApp = win32com.client.Dispatch("Excel.Application")
    fTest = xlApp.Workbooks.Open(fName)
    macName = fTest.Name + '!' + macName
    xlApp.Run(macName)
    fTest.Close(1)
    xlApp.Quit()
    xlApp = None

def IBP():
    ibp = wsi.cell('G12')
    ibpv = random.randint(0,45)
    ibp.value = ibpv
    return ibp.value

def BP10():
    bp10 = wsi.cell('G13')
    bpv10 = random.randint(30,50)
    bp10.value = bpv10
    return bp10.value

for n in range(6):
    IBP()
    print IBP()
    BP10()
    run_macro('Input.xlsm','macro1')
    wbo.save('Output.xlsx') 
```

我认为错误在于`run_macro('Input.xlsm','macro1')`- 它无法迭代。

**输出：**

```
Qt: Untested Windows version 6.2 detected!
35
4
Traceback (most recent call last):
  File "C:\Users\User\Desktop\Python Exp\Pr 1.py", line 77, in <module>
    run_macro('Input.xlsm','macro1')
  File "C:\Users\User\Desktop\Python Exp\Pr 1.py", line 18, in run_macro
    fTest = xlApp.Workbooks.Open(fName)
  File "C:\Python27\lib\site-packages\win32com\client\dynamic.py", line 522, in __getattr__
    raise AttributeError("%s.%s" % (self._username_, attr))
AttributeError: Excel.Application.Workbooks 
```

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T20:40:34.770

我不确定这会有所帮助，但您可以尝试提前绑定。运行此脚本，然后再试一次：

```
import win32com.client

xl = win32com.client.gencache.EnsureDispatch ("Excel.Application")
print xl.__module__ 
```

如果这不起作用，您总是可以通过像这样连接到 Excel 来返回后期绑定：

```
xl = win32com.client.dynamic.Dispatch("Excel.Application") 
```

或通过简单地删除此文件夹：`C:\Python27\Lib\site-packages\win32com\gen_py\00020813-0000-0000-C000-000000000046x0x1x7`

从错误消息来看，您的问题似乎已经上线`wb = xlApp.Workbooks.Open(fname)`。如果 Excel com 服务器的 Python 挂钩工作正常，则该行不会引发异常。我看不出发生异常的代码有什么问题。有时早期绑定在这种情况下会有所帮助。

祝你好运

麦克风

# mysql - 在mysql中将日期转换为UTC时间戳

> ID：13941542
> 
> 赞同：3
> 
> 时间：2012-12-18T21:08:57.440
> 
> 标签：mysql, sql, timezone

我有一个包含以下列的表格：

```
|start_date  |TZ      | 
|Dec 2, 2012 |Eastern |
|Dec 2, 2012 |GMT     | 
```

注1：我们的服务器是UTC时间。

注 2：start_date 列是日期字段，而不是时间戳字段。2012 年 12 月 2 日隐含的意思是“2012-12-02 00:00:00”

注3：上表实际上是多个规范化的表，但为了简单起见，我对其进行了反规范化。

注 4：我可以将任何东西放入 TZ 表中以简化操作。

我想`select from my_table where start_date <= now()`

但是，由于时区，这不起作用。如果当前日期/时间是东部时间 12 月 1 日晚上 9 点（UTC 时间 12 月 2 日凌晨 1 点），上述查询将返回两个结果，但我真的只想要第二个。夏令时使这进一步复杂化。

理想情况下，我想要一个执行以下操作的查询：

```
select * from my_table where convert_to_utc_timestamp(start_date,tz) <= now() 
```

上述方法会将 start_date 转换为时间戳，然后将其转换为正确的时区。

我将如何在 SQL 中执行此操作？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:30:13.633

您可能会发现有两个功能很有用。

第一个是：

```
STR_TO_DATE(start_date,'%M %d,%Y') 
```

这将使您的字符串以指定的格式转换为 MySQL`DATE`数据类型。如果你有`mysql.time_zone_name`等。填充表，您可以使用以下功能：

```
CONVERT_TZ() 
```

（需要检查是否`CONVERT_TZ`需要一个 DATE 并将返回一个 DATETIME 或 TIMESTAMP，或者在要转换的字符串中包含一个时间组件以获得 DATETIME，例如

```
STR_TO_DATE( CONCAT(start_date,' 00:00:00'),'%M %d,%Y %T') 
```

将该表达式包装在 CONVERT_TZ() 函数中，例如

```
CONVERT_TZ(  datetime_expr ,'US/Eastern','GMT') 
```

要使用存储在`TZ`列中的值，这些值需要匹配，或者您需要想出一种方法来匹配存储在`mysql.time_zone_name`表中的值。

# python - Python 在两个 html 标签之间重新编译

> ID：13941545
> 
> 赞同：1
> 
> 时间：2012-12-18T21:09:05.600
> 
> 标签：python, regex, beautifulsoup

这应该很简单，但我不能很细枝。我想从此 html 字符串中获取名称：

```
 soup =   </ul>
  Brian
  <p class="f"> 
```

我试过了：

```
namePattern = re.compile(r'(?<=</ul>)(.*?)(?<=<p)')
rev.reviewerName = re.findall(namePattern,  str(soup)) 
```

和

```
namePattern = re.compile(r'</ul>(.*?)<p') 
```

你能告诉我怎么做吗？谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:10:43.363

默认情况下，`.`不匹配换行符。您需要指定[`re.DOTALL`](http://docs.python.org/2/library/re.html#re.S)为[`re.compile()`](http://docs.python.org/2/library/re.html#re.compile).

请注意，这将包括换行符作为捕获组的一部分。如果你不想这样，你可以明确地将它们与`\s*`：

```
In [5]: re.findall(r'</ul>\s*(.*?)\s*<p', s)
Out[5]: ['Brian'] 
```

# fortran - 在 Ubuntu 上编译 Fortran netCDF 程序

> ID：13941549
> 
> 赞同：7
> 
> 时间：2012-12-18T21:09:28.400
> 
> 标签：fortran, netcdf

好的，这里是新手问题。

我正在尝试在 Ubuntu 上使用 gfortran 编译[simple_xy_wr.f90——](http://www.unidata.ucar.edu/software/netcdf/docs/netcdf-tutorial.html#simple_005fxy_005fwr_002ef90)一个 netCDF 示例程序，而我一定是在做一些非常愚蠢的事情；我没有太多编译 Fortran 的经验。

首先，我安装了[libnetcdf-dev](http://packages.ubuntu.com/quantal/libnetcdf-dev)包，其中包括像

```
/usr/lib/libnetcdf.a
/usr/lib/libnetcdff.a
/usr/include/netcdf.mod 
```

所以，我试图用（各种命令，如）编译代码

```
f95 -o xy -I/usr/include/ -L/usr/lib/ -lnetcdff -lnetcdf simple_xy_wr.f90 
```

我得到以下输出

```
/tmp/ccE6g7sr.o: In function `check.1847':
simple_xy_wr.f90:(.text+0x72): undefined reference to `__netcdf_MOD_nf90_strerror'
/tmp/ccE6g7sr.o: In function `MAIN__':
simple_xy_wr.f90:(.text+0x284): undefined reference to `__netcdf_MOD_nf90_create'
simple_xy_wr.f90:(.text+0x2b6): undefined reference to `__netcdf_MOD_nf90_def_dim'
simple_xy_wr.f90:(.text+0x2e8): undefined reference to `__netcdf_MOD_nf90_def_dim'
simple_xy_wr.f90:(.text+0x432): undefined reference to `__netcdf_MOD_nf90_def_var_manydims'
simple_xy_wr.f90:(.text+0x468): undefined reference to `__netcdf_MOD_nf90_enddef'
simple_xy_wr.f90:(.text+0x4aa): undefined reference to `__netcdf_MOD_nf90_put_var_2d_fourbyteint'
simple_xy_wr.f90:(.text+0x4cb): undefined reference to `__netcdf_MOD_nf90_close'
collect2: error: ld returned 1 exit status 
```

我认为我包含了正确的库。例如，似乎 __netcdf_MOD_nf90_strerror 应该在那里：

```
$ nm /usr/lib/libnetcdff.a | grep __netcdf_MOD_nf90_strerror
000000000004a100 T __netcdf_MOD_nf90_strerror 
```

我究竟做错了什么？

（FWIW，我看过的一些相关参考资料如下。

1.  [使用 netcdf 库的未定义引用](http://www.unidata.ucar.edu/mailing_lists/archives/netcdfgroup/2007/msg00050.html)

2.  [gfortran 和 NETCDF 的编译问题](http://ubuntuforums.org/archive/index.php/t-1033570.html)

3.  [编译和运行 Fortran 程序 - 基本指南](http://www.fortran.gantep.edu.tr/compiling-g95-basic-guide.html)

)

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-19T13:20:13.693

在 Unix 系统上，链接器命令行上的目标文件和存档的顺序**非常重要，因为默认的链接器行为是仅在目标文件或存档***之后*的存档中搜索符号定义，其中找到未解析的引用，称为单遍链接。

这意味着如果您的代码引用`__netcdf_MOD_nf90_strerror`，则包含此符号 ( `libnetcdff.a`) 定义的存档必须出现*在*程序的目标文件列表之后。`libnetcdff.a`它本身引用了 C 库中的符号`libnetcdf.a`，因此它必须在`libnetcdff.a`. 所以正确的链接顺序是：

```
/tmp/ccE6g7sr.o libnetcdff.a libnetcdf.a 
```

`/tmp/ccE6g7sr.o`汇编器从编译的源文件生成的临时目标文件在哪里。编译代码的正确命令行是：

```
f95 -o xy -I/usr/include/ simple_xy_wr.f90 -lnetcdff -lnetcdf 
```

在这种情况下，不会直接调用链接器，而是编译器会这样做。GCC 编译器将所有与链接相关的东西以相同的顺序传递给一个名为的中间实用程序`collect2`，然后该实用程序调用实际的链接器`ld`。

请注意，如果 netCDF 库存档的共享对象版本也存在（即存在`libnetcdff.so`和`libnetcdf.so`），那么链接器会更喜欢它们而不是静态存档（除非使用该`-static`选项启用静态链接）并且最终链接阶段将被处理为运行时链接编辑器 (RTLD)（`/lib64/ld-linux-x86-64.so.2`在 Ubuntu 上）。在这种情况下，与您的问题相同的命令行实际上会成功而不会出现链接错误，尽管这两个库都位于引用它们的代码之前，因为丢失的符号引用将由 RTLD 在加载可执行文件时解决文件。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-12-19T10:44:58.387

In Ubuntu 12.10, the order of the libraries is the trick (as Hristo suggested):

```
 angelv@palas:~$ gfortran  -o xy -I/usr/include/ -L/usr/lib/  -lnetcdf -lnetcdff simple_xy_wr.f90
/tmp/ccj95anF.o: In function `check.1847':
simple_xy_wr.f90:(.text+0x72): undefined reference to `__netcdf_MOD_nf90_strerror'
/tmp/ccj95anF.o: In function `MAIN__':
simple_xy_wr.f90:(.text+0x284): undefined reference to `__netcdf_MOD_nf90_create'
simple_xy_wr.f90:(.text+0x2b6): undefined reference to `__netcdf_MOD_nf90_def_dim'
simple_xy_wr.f90:(.text+0x2e8): undefined reference to `__netcdf_MOD_nf90_def_dim'
simple_xy_wr.f90:(.text+0x432): undefined reference to `__netcdf_MOD_nf90_def_var_manydims'
simple_xy_wr.f90:(.text+0x468): undefined reference to `__netcdf_MOD_nf90_enddef'
simple_xy_wr.f90:(.text+0x4aa): undefined reference to `__netcdf_MOD_nf90_put_var_2d_fourbyteint'
simple_xy_wr.f90:(.text+0x4cb): undefined reference to `__netcdf_MOD_nf90_close'
collect2: error: ld returned 1 exit status

angelv@palas:~$ gfortran  -o xy -I/usr/include/ simple_xy_wr.f90 -L/usr/lib/  -lnetcdf -lnetcdff 

angelv@palas:~$ ./xy 
           0          12          24          36
 *** SUCCESS writing example file simple_xy.nc! 
```

# ruby-on-rails-3 - 如何保护我的电子邮件地址免受垃圾邮件攻击

> ID：13941554
> 
> 赞同：2
> 
> 时间：2012-12-18T21:09:44.207
> 
> 标签：ruby-on-rails-3, ruby-on-rails-3.2

**我想知道 Rails 提供什么来混淆电子邮件地址，以保护它免受爬虫、垃圾邮件机器人和邮件收割机的侵害，收集地址以发送垃圾邮件。**

可能是我使用了错误的关键字，但并没有真正找到宝石。

我发现了一个比较不同方法来掩盖邮件地址的统计数据：http: [//techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/](http://techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/)

我写了一个片段，结合了前两种方法。

**剪辑还不成熟，但我还是喜欢分享它，这可能是其他面临同样问题的人的起点。** （下一步是用模糊的纯文本替换已经链接的地址。）

在继续之前，我想知道什么是 Rails 的最佳实践。这是一个常见问题，我一定错过了处理它的宝石！？

**如果我使用我的方法，在我的应用程序中集成/触发它的最佳方法是什么？**

任何一种before_filter？渲染前？？？类似的东西？

还是像我现在做的那样，在视图中将其称为 helper_methode？

它甚至可以添加到字符串类中……</p>

* * *

**在我的`application_helper.rb`**

```
def obfuscate_emails(content, domain_prefix = 'nirvana', clss = 'maildecode')
  # This shall protect emails from spam spiders/crawlers gathering emails from webpages
  # Add the following SASS to your Stylesheets
  #
  # span.maildecode
  #   direction: rtl
  #   unicode-bidi: bidi-override
  #
  # Further more you might want to use Javascript(.erb) to add links to the email addresses like this
  #
  # $(document).ready(function() {
  #   function link_emails(subdomain){
  #     console.log("Find an replace reverse emails, fake subdomain is "+subdomain);
  #     $(".maildecode").each(function() {
  #       email = $(this).text().replace('.'+subdomain,'').split("").reverse().join("");
  #       console.log("- clean email is "+email);
  #       // $(this).html($(this).text().replace('.'+subdomain,'')); // uncomment if you like to clean up the html a bit
  #       $(this).wrap('<a href="mailto:'+email+'">');
  #     });
  #   }
  #
  #   link_emails('<%= ENV['OBFUSCATE_EMAIL_SUBDOMAIN'] %>');
  # });
  #
  # Thanks to
  # http://techblog.tilllate.com/2008/07/20/ten-methods-to-obfuscate-e-mail-addresses-compared/

  email_re = /[\w.!#\$%+-]+@[\w-]+(?:\.[\w-]+)+/
  content.scan(email_re).each do |mail|
    obfuscate_mail = "<span class='#{clss}'>#{mail.reverse.split('@')[0]}<span style='display: none;'>.#{domain_prefix}</span>@#{mail.reverse.split('@')[1]}</span>"
    content = content.sub(mail, obfuscate_mail)
  end
  content # use raw(obfuscate_emails(content)) otherwise rails will escape the html
end 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:13:34.740

`mail_to`只需使用Rails内置的帮助程序...

[http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-mail_to](http://api.rubyonrails.org/classes/ActionView/Helpers/UrlHelper.html#method-i-mail_to)

```
mail_to 'email@here.com', 'click to email', :encode => .... # couple of encoding options 
```

注意：这不再适用于 Rails 4。来自文档：在 Rails 4.0 之前，mail_to 提供了对地址进行编码的选项，以阻止电子邮件收割者。要利用这些选项，请安装 actionview-encoded_mail_to gem。（感谢@zwippie）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T17:28:33.927

您可以简单地将 @-sign 替换为一个简单的解决方案：

```
"example@example.com".sub("@","-at-") #=> example-at-example.com
"example@example.org".sub("@","{at}") #=> example{at}example.org 
```

查看[使用 ruby​​ 混淆电子邮件以防止收割机](https://stackoverflow.com/questions/19386871/obfuscate-emails-with-ruby-to-protect-against-harvesters)

# javascript - Chrome 扩展和本地存储

> ID：13941556
> 
> 赞同：3
> 
> 时间：2012-12-18T21:09:54.823
> 
> 标签：javascript, google-chrome, cookies, google-chrome-extension, storage

我正在尝试制作 Chrome 扩展程序。对于该扩展，我需要一些动态创建的信息，但我希望稍后（在不同的页面上）添加这些数据。

这是我希望始终可以访问的某种数据（当插件运行时）：

```
var villages = new Array();
villages[0][0] = "village1"; 
villages[0][1] = "1325848"; 
villages[1][0] = "village2"; 
villages[1][1] = "8744351"; 
villages[2][0] = "village3"; 
villages[2][1] = "8952187"; 
```

如您所见，数组是多维的。这是因为我想将名称 [0] 和村庄 id [1](http://archive.plugins.jquery.com/project/Cookie)一起存储。

有人知道处理这个问题的好方法吗？

我看过这个：[jQuery Cookie](http://archive.plugins.jquery.com/project/Cookie)

但不知道这是否是处理问题的正确方法。

或者，我是否必须创建某种包含所有值的 XML 文件？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T23:10:23.727

# 更新：

***这是一个骨架示例，如果您只想存储村庄.id 和村庄.name，只需更改默认数据，仍然有效。我已经为您更改了所有代码，您将看到如何迭代数组并在代码下方获取村庄数据。***

* * *

首先我应该说将数据保存在多维数组中是非常糟糕的做法。

您应该使用对象，它使您的数据整洁，而不是您可以轻松地操作它。

这是您的情况的示例对象，

```
var village = {
  id: "1325848", 
  name : "village1"
};

console.log(village.id); //1325848
console.log(village.name); //village1 
```

这是一个基本的入门示例。

这是解决本地存储和 javascript 对象问题的方法。

```
var ExtensionDataName = "myfirstextensiondata";
var ExtensionData = {
  dataVersion: 3, //if you want to set a new default data, you must update "dataVersion".
  villages: []
};

//default data
ExtensionData.villages.push(
    {id: "1325848", name: "village1"},
    {id: "8744351", name: "village2"},
    {id: "8952187", name: "village3"}
);

function DB_setValue(name, value, callback) {
    var obj = {};
    obj[name] = value;
    console.log("Data Saved!");
    chrome.storage.local.set(obj, function() {
        if(callback) callback();
    });
}

function DB_load(callback) {
    chrome.storage.local.get(ExtensionDataName, function(r) {
        if (isEmpty(r[ExtensionDataName])) {
            DB_setValue(ExtensionDataName, ExtensionData, callback);
        } else if (r[ExtensionDataName].dataVersion != ExtensionData.dataVersion) {
            DB_setValue(ExtensionDataName, ExtensionData, callback);
        } else {
            ExtensionData = r[ExtensionDataName];
            callback();
        }
    });
}

function DB_save(callback) {
    DB_setValue(ExtensionDataName, ExtensionData, function() {
        if(callback) callback();
    });
}

function DB_clear(callback) {
    chrome.storage.local.remove(ExtensionDataName, function() {
        if(callback) callback();
    });
}

function isEmpty(obj) {
    for(var prop in obj) {
        if(obj.hasOwnProperty(prop))
            return false;
    }
    return true;
}

DB_load(function() {
    //YOUR MAIN CODE WILL BE HERE
    console.log(ExtensionData);
    console.log(ExtensionData.villages); //array of villages
    console.log(ExtensionData.villages[0]); //first village object
    console.log(ExtensionData.villages[0].id); //first village id
    console.log(ExtensionData.villages[0].name); //first village name

    //HOW TO ITERATE VILLAGES

    for (var i = 0; i < ExtensionData.villages.length; i++) {
        console.log(ExtensionData.villages[i].id); //village id
        console.log(ExtensionData.villages[i].name); //village name
    } 
}); 
```

# 问题：

*   **ExtensionDataName 是否相同？或者我可以改变吗？**

ExtensionDataName 用作将数据保存到本地存储时的名称，它只是您的数据集合的名称。因此，你当然可以改变它，做你想做的，这取决于你。

*   **当您更改此行的编号时，您实现的目标是什么：** `dataVersion: 3, //if you want to set a new default data, you must update "dataVersion"`**？**

用户第一次运行此扩展时，本地存储中没有数据。所以使用默认的村庄列表，

在我的示例中，默认村庄列表是，

```
[
    {id: "1325848", name: "village1"},
    {id: "8744351", name: "village2"},
    {id: "8952187", name: "village3"}
] 
```

此默认列表保存到本地存储。当扩展再次运行（不是第一次）之后，默认列表不再重要，因为在 localstorage 中存储了一个村庄列表，所以它从 localstorage 加载村庄列表。

例如，如果您想在扩展运行时添加一个新村庄，您可以这样做，

```
ExtensionData.villages.push({id: "1215555", name: "village4"});
DB_save(); 
```

那么目标是`dataVersion`什么？

如果你看`DB_load()`功能，它在那里使用。它检查 dataVersion 是否仍然相同，如果不同，它决定

“*有一个更新的默认数据，所以我应该清除本地存储并将新数据重新加载到本地存储*”

所以如果你不改变这条线，

```
ExtensionData.villages.push(
    {id: "1325848", name: "village1"},
    {id: "8744351", name: "village2"},
    {id: "8952187", name: "village3"}
); 
```

比你不会改变`dataVersion`

# python - 为什么我不能从多处理队列中捕获 Queue.Empty 异常？

> ID：13941562
> 
> 赞同：30
> 
> 时间：2012-12-18T21:10:22.130
> 
> 标签：python, exception-handling, python-2.7

我正在尝试捕获如果 multiprocessing.Queue 为空时引发的 Queue.Empty 异常。以下不起作用：

```
import multiprocessing
f = multiprocessing.Queue()
try:
      f.get(True,0.1)
except Queue.Empty:
      print 'foo' 
```

这给了我一个名称错误： NameError: name 'Queue' is not defined

用 multiprocessing.Queue.Empty 替换 Queue.Empty 也无济于事。在这种情况下，它给了我一个“AttributeError：'function'对象没有属性'Empty'”异常。

* * *

## 回答 #1

> 赞同：54
> 
> 时间：2012-12-18T21:34:59.390

您要查找的`Empty`异常不能直接在`multiprocessing`模块中使用，因为`multiprocessing`它是从模块中借用的（它曾经在 Python 2`queue`中命名）。`Queue`要使您的代码正常工作，只需`import queue`在顶部执行以下操作：

尝试这个：

```
import multiprocessing
import queue # or Queue in Python 2

f = multiprocessing.Queue()
try:
    f.get(True,0.1)
except queue.Empty: # queue here refers to the module, not a class
    print('foo') 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2019-01-02T04:34:22.623

Blckknght 在 2012 年的回答仍然是正确的，但是使用 Python 3.7.1 我发现你必须使用 queue.Empty 作为要捕获的异常的名称（注意“队列”中的小写“q”。）

所以，回顾一下：

```
import queue

# Create a queue
queuevarname = queue.Queue(5) # size of queue is unimportant

while some_condition_is_true:
    try:
        # attempt to read queue in a way that the exception could be thrown
        queuedObject = queuevarname.get(False)

        ...
    except queue.Empty:
        # Do whatever you want here, e.g. pass so
        # your loop can continue, or exit the program, or... 
```

# javascript - 如何使用 MS Dynamics CRM REST 端点更新或删除现有电话/电子邮件记录的发件人和收件人

> ID：13941567
> 
> 赞同：3
> 
> 时间：2012-12-18T21:10:35.377
> 
> 标签：javascript, rest, dynamics-crm-2011, dynamics-crm

我正在开发需要使用 REST API 在 MS Dynamics CRM 2011 中创建和稍后更新电话/电子邮件记录的应用程序。使用 Soap API 不是一种选择。

我已经弄清楚如何创建电话/电子邮件记录（[在此处](http://mscrmshop.blogspot.ca/2011/09/how-to-create-email-activity-using-rest.html) 或[此处](http://community.dynamics.com/product/crm/crmtechnical/b/crmcustomereffective/archive/2011/12/06/using-the-crm-2011-rest-services-and-deep-insert-to-create-activities.aspx)有详细记录）。

更新现有的电话/电子邮件记录本身也不是问题。

我的问题是：如何更新现有电话/电子邮件记录的收件人和发件人字段（收件人和发件人）？

到目前为止，我已经尝试了下面描述的不同方法，但没有运气。

`Error processing request stream. Deep updates are not supported in PUT operations.`如果我尝试更新 phonecall_activity_parties 关系，我会收到错误 - 请参阅下面的代码

```
var callLogEntity = { 
    "Subject": "My call", "Description": "Call comments go here" };

var activityParties = [];
activityParties.push({
    "PartyId": {"Id":"4A9FD17D-5890-4BF0-94AA-D68285C46039", "LogicalName":"contact"},
    "ParticipationTypeMask": { "Value": 1 }
}); // sender is a contact
activityParties.push({
    "PartyId": { "Id": Xrm.Page.context.getUserId(), "LogicalName": "systemuser" },
    "ParticipationTypeMask": { "Value": 2 }
}); // receiver is a current user
callLogEntity.phonecall_activity_parties = activityParties;

var restQueryUrl = "http://<crm_url>/XRMServices/2011/OrganizationData.svc/" +
    "PhoneCallSet(guid'" + callLogId + "')";
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    datatype: "json",
    data: JSON.stringify(callLogEntity),
    url: restQueryUrl,
    beforeSend: function (XMLHttpRequest)
    {
        XMLHttpRequest.setRequestHeader("Accept", "application/json");
        XMLHttpRequest.setRequestHeader("X-HTTP-Method", "MERGE");
    },
    success: function (data, textStatus, XmlHttpRequest)
    {
        console.log("Success");
    },
    error: function (XmlHttpRequest, textStatus, errorObject)
    {
        console.warn("Request FAILED: " + XmlHttpRequest.responseText);
    }
}); 
```

[如果我尝试使用此 SDK 示例](http://technet.microsoft.com/en-us/library/hh372956.aspx)`An activityparty cannot be disassociated from an activity`中的 disassociateRecords 方法取消关联活动，我会收到错误- 请参阅下面的代码

```
var restQueryUrl = "http://<crm_url>/XRMServices/2011/OrganizationData.svc/" +
    "PhoneCallSet(guid'" + callLogId + "')/$links/" +
    "phonecall_activity_parties(guid'" + activityPartyId + "')";
$.ajax({
    type: "POST",
    contentType: "application/json; charset=utf-8",
    url: restQueryUrl,
    beforeSend: function (XMLHttpRequest)
    {
        XMLHttpRequest.setRequestHeader("Accept", "application/json");
        XMLHttpRequest.setRequestHeader("X-HTTP-Method", "DELETE");
    },
    success: function (data, textStatus, XmlHttpRequest)
    {
        console.log("Success");
    },
    error: function (XmlHttpRequest, textStatus, errorObject)
    {
        console.warn("Request FAILED: " + XmlHttpRequest.responseText);
    }
}); 
```

当我`Forbidden`尝试直接从 ActivityPartySet 删除 phonecall_activity_parties 中找到的 ActivityParty 之一时出现错误。

```
var restQueryUrl = "http://<crm_url>/XRMServices/2011/OrganizationData.svc/" +
    "ActivityPartySet(guid'" + activityPartyId + "')";
// then do an AJAX POST request with "X-HTTP-Method": "DELETE" header 
```

单独更新该列表中的每个 ActivityParty 对电话记录没有影响（即 MERGE 请求似乎成功，但 ActivityParty 仍然指向旧记录）

```
var activityData = {
    "PartyId":{"Id":"cc1cdb40-a844-e211-ab1a-000c297d9c06","LogicalName":"contact"},
    "ParticipationTypeMask":{"Value":1}
};
var restQueryUrl = "http://<crm_url>/XRMServices/2011/OrganizationData.svc/" +
    "ActivityPartySet(guid'" + activityPartyId + "')";
// then do an AJAX post request with "X-HTTP-Method": "MERGE" header
// and activityData as the message body 
```

如果有人可以阐明如何更改（或删除，如“清除字段”）现有电话/电子邮件记录的发件人和收件人，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T10:03:34.433

你可以试试这个代码。我希望这会有所帮助。

```
var lookupValue = new Array();

lookupValue[0] = new Object();
lookupValue[0].id = "3D417D54-412C-440D-A390-33ED7398254D";
lookupValue[0].name = "UserName";
lookupValue[0].entityType = "systemuser";

lookupValue[1] = new Object();
lookupValue[1].id = "8BD96ECC-573D-E211-A12B-1CC1DE79B4CA";
lookupValue[1].name = "QueueName";
lookupValue[1].entityType = "queue";

createRecord(lookupValue, "EmailSet", _emailCreateSuccess, _error);

//Xrm.Page.getAttribute("to").setValue(lookupValue); 
```

# php - 调试 PDO mySql 将 NULL 插入数据库而不是空

> ID：13941568
> 
> 赞同：4
> 
> 时间：2012-12-18T21:10:38.163
> 
> 标签：php, mysql, insert, pdo, null

我正在尝试使用 PDO 将“NULL”动态插入数据库。

表结构：

```
CREATE TABLE IF NOT EXISTS `Fixes` (
  `Id` int(11) NOT NULL AUTO_INCREMENT COMMENT 'PK',
  `CurrencyId` int(11) NOT NULL COMMENT 'FK',
  `MetalId` int(11) NOT NULL COMMENT 'FK',
  `FixAM` decimal(10,5) NOT NULL,
  `FixPM` decimal(10,5) DEFAULT NULL,
  `TimeStamp` timestamp NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`Id`),
  KEY `CurrencyId` (`CurrencyId`),
  KEY `MetalId` (`MetalId`)
) ENGINE=InnoDB  DEFAULT CHARSET=latin1 COLLATE=latin1_general_ci AUTO_INCREMENT=13 ; 
```

PHP / PDO查询：

```
$sql = 'UPDATE 
            Fixes
    SET 
            FixAM = :fixAM,
        FixPM = :fixPM
        WHERE
            MetalId IN (SELECT Id FROM Metals WHERE Name = :metal) AND
        CurrencyId IN (SELECT Id FROM Currencies Where Id = :currency)';

$stmt = $db->prepare($sql); 

for ($i = 0; $i<3; $i++) {  
    $stmt->execute(array(
    ':metal' => 'Silver', 
    ':fixAM' => $fix['FixAM'][$i], 
    ':fixPM' => $fix['FixPM'][$i],
    ':currency' => ($i+1))
    );      
} 
```

例如，有时，值**有时**`$fix['FixPM'][$i]`是“NULL”。如何将其插入数据库？当我运行查询然后查看数据库中的数据时，这条记录显示 0.0000，而不是 null。

 **[如何使用 PDO 插入 NULL 值？](https://stackoverflow.com/questions/1391777/how-do-i-insert-null-values-using-pdo)提供了一些解决方案。

*   我认为我不能`$stmt->execute(array( ':v1' => null, ':v2' => ... ))`按照示例使用，因为有时该项目为空，有时则不是。因此，我需要引用我创建的变量，并在需要时`$fix['FixPM'][$i]`将其设为**null**

提前致谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T22:07:24.573

在我看来，这似乎是 PDO 准备好的语句仿真中的一个（n 未报告？）错误：

1.  [最终](http://code.metager.de/source/xref/php/ext/pdo/pdo_stmt.c#497)调用的[实现](http://code.metager.de/source/xref/php/ext/pdo/pdo_stmt.c#434)；_`PDOStatement::execute()` [`pdo_parse_params()`](http://code.metager.de/source/xref/php/ext/pdo/pdo_sql_parser.c#432)

2.  反过来，[尝试](http://code.metager.de/source/xref/php/ext/pdo/pdo_sql_parser.c#584)根据相关参数的数据类型引用/转义值（如参数所指示的那样`$data_type`-[`PDOStatement::bindValue()`](http://php.net/manual/en/pdostatement.bindvalue.php)所有[`PDOStatement::bindParam()`](http://php.net/manual/en/pdostatement.bindparam.php)提供的参数`$input_parameters`都[`PDOStatement::execute()`](http://php.net/manual/en/pdostatement.execute.php)被视为`PDO::PARAM_STR`，如该函数的文档中所述）；

3.  字符串类型的值通过[调用](http://code.metager.de/source/xref/php/ext/pdo/pdo_sql_parser.c#604)相关数据库驱动程序的[`quoter()`](http://code.metager.de/source/xref/php/ext/pdo/php_pdo_driver.h#302)方法进行转义/引用，无论它们是否为`null`: 在 PDO_MySQL 的情况下，即[`mysql_handle_quoter()`](http://code.metager.de/source/xref/php/ext/pdo_mysql/mysql_driver.c#302)，它（最终）将值传递给[`mysqlnd_cset_escape_quotes()`](http://code.metager.de/source/xref/php/ext/mysqlnd/mysqlnd_charset.c#686)or [`mysql_cset_escape_slashes()`](http://code.metager.de/source/xref/php/ext/mysqlnd/mysqlnd_charset.c#740)，具体取决于服务器的[`NO_BACKSLASH_ESCAPES`](http://dev.mysql.com/doc/en/server-sql-mode.html#sqlmode_no_backslash_escapes)SQL 模式；

4.  给定一个`null`参数，这两个函数都返回一个空字符串。

我的观点是，在[打开参数的类型](http://code.metager.de/source/xref/php/ext/pdo/pdo_sql_parser.c#584)之前（在上面的步骤 2 中），`pdo_parse_params()`应该将类型设置为`PDO::PARAM_NULL`if 值为`null`. 但是，有些人可能会争辩说，这将`null`在适当的情况下阻止特定类型的值处理，在这种情况下，[字符串大小写](http://code.metager.de/source/xref/php/ext/pdo/pdo_sql_parser.c#602)（在上面的步骤 3 中）肯定应该`null`在继续调用驱动程序方法之前处理值`quoter()`。

作为临时解决方法，禁用准备好的语句仿真通常是最好的：

```
$db->setAttribute(PDO::ATTR_EMULATE_PREPARES, FALSE); 
```**

# android - 可以绘制 Fragment 及其父 FragmentActivity 的生命周期吗？

> ID：13941584
> 
> 赞同：6
> 
> 时间：2012-12-18T21:11:50.543
> 
> 标签：android, android-fragments, android-lifecycle, android-fragmentactivity

在 Android 文档中，我找到了关于`Activity`生命周期和`Fragment`生命周期的规范，但从来没有在一起。当我附加了一个调试器来托管我的片段时，这似乎并不明显`FragmentActivity`，而且生命周期不仅仅是疯狂的。看起来活动先完成，然后片段开始，这是不可能的。

**片段的生命周期** ![](../Images/c63139ced6ac82c2adfafe338868b8ca.png)

* * *

**活动的生命周期** ![](../Images/65e0664312fafa27c9458058e936f29b.png)

* * *

从逻辑上讲，片段应该在它之后“跳入”活动的生命周期，`onResume`并且它会在活动之前结束`onPause`，但**它似乎**没有发生。

有人可以向我展示与其父活动相关的片段的生命周期，或者指导我找到一些关于此的好教程吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:18:16.327

你见过[这个](http://developer.android.com/reference/android/app/Fragment.html#Lifecycle)吗？Fragment 是在 Activity 创建之后创建的。“活动先完成然后片段开始”似乎不可能你能发布代码吗？
这是我测试的，1 FragmentActivity ，两个 Fragment ：![在此处输入图像描述](../Images/73469a2b4920089eb6c55bba47934e40.png)

# python - 你能用排序加速python中的“for”循环吗？

> ID：13941585
> 
> 赞同：2
> 
> 时间：2012-12-18T21:11:54.843
> 
> 标签：python, list

如果我有一个包含 300k 个元素的长未排序列表，是否会先对该列表进行排序，然后在列表上执行“for”循环以加快代码速度？无论如何，我都需要做一个“for循环”，不能使用列表理解。

```
sortedL=[list].sort() 

for i in sortedL:
  (if i is somenumber)
     "do some work" 
```

我如何向 python 发出 sortedL 已排序而不是读取整个列表的信号。对列表进行排序有什么好处吗？如果有那么我该如何实施？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-18T21:20:45.493

您似乎正在考虑对列表进行排序，以便您可以快速查找`somenumber`.

排序是否值得取决于您是要搜索一次还是重复搜索：

*   如果您只搜索一次，对列表进行排序不会加快速度。只需遍历列表以查找元素，就完成了。

*   另一方面，如果您需要重复搜索值，请务必对列表进行预排序。这将使您能够用于[`bisect`](http://docs.python.org/2/library/bisect.html)快速查找值。

第三种选择是将元素存储在`dict`. 这可能会提供最快的查找，但可能会比使用列表的内存效率低。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:14:01.900

`for`python中循环的成本**不**取决于输入数据是否排序。

话虽如此，如果您先排序，您可能能够提前`break`退出`for`循环或在算法级别保存其他计算。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-18T21:22:02.920

如果要在 sorted 中进行搜索`list`，则需要一种利用排序的算法。

一种可能性是内置[`bisect`](http://docs.python.org/2/library/bisect.html)模块。这使用起来有点麻烦，但是文档中有一个用于在其之上构建简单排序列表函数的方法。

有了这个食谱，你可以这样写：

```
i = index(sortedL, somenumber) 
```

当然，如果您只是为了加快单个搜索的速度而进行排序，这有点愚蠢。排序需要 O(N log N) 时间，然后搜索需要 O(log N)，总共需要 O(N log N)；仅进行线性搜索将花费 O(N) 时间。因此，除非您通常在同一个列表上进行 log N 次搜索，否则这是不值得的。

如果您实际上不需要排序，只需要快速查找，则可以使用 a`set`而不是 a `list`。这使您可以 O(1) 查找除病理情况外的所有情况。

Also, if you want to *keep* a list sorted while continuing to add/remove/etc., consider using something like [`blist.sortedlist`](http://pypi.python.org/pypi/blist/) instead of a plain list.

# r - R地图包缺失县

> ID：13941586
> 
> 赞同：3
> 
> 时间：2012-12-18T21:11:59.640
> 
> 标签：r, maps, package, missing-data

我正在尝试使用 R“maps”包按县制作美国的热图/等值线/专题图。不幸的是，数据库中似乎缺少一些县。

```
library(maps)
data(county.fips)
which(county.fips[,1] == 35006)
which(county.fips[,2] == 'new mexico,cibola') 
```

结果找不到条目

```
> library(maps)
> data(county.fips)
> which(county.fips[,1] == 35006)
integer(0)
> which(county.fips[,2] == 'new mexico,cibola')
integer(0) 
```

我知道这个fips代码存在！（http://en.wikipedia.org/wiki/Cibola_County,_New_Mexico [http://en.wikipedia.org/wiki/List_of_counties_in_New_Mexico](http://en.wikipedia.org/wiki/List_of_counties_in_New_Mexico)）

有人知道我怎样才能制作完整的情节吗？所有我能找到的都在这里列出：http: [//grokbase.com/t/r/r-sig-geo/0964515wmd/missing-county-in-maps](http://grokbase.com/t/r/r-sig-geo/0964515wmd/missing-county-in-maps)

谢谢你的帮助！！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-23T16:52:25.543

啊哈，问题不在于地图，而在于county.fips。Cibola 县没有出现在该数据集中，所以当我去匹配我的数据 {variable-to-plot, FIPS code} 到列表时，Cibola 总是丢失。

有一种显示 Cibola 县的解决方法...为不涉及 County.fips 数据集的县写一条明确的行。

```
countynames <- match(county.fips[,"fips"], mydatavector$fips)
cibola_value <- mydatavector[which(mydatavector$fips == 35006)]
m <- map("county")
map("county", countynames, col=rainbow(100)[mydatavector$var_to_plot], fill=TRUE, add=TRUE)
map("county", "new mexico,cibola", col=rainbow(100)[cibola_value], fill=TRUE, add=TRUE) 
```

注意：我还发现地图功能无法绘制美国的所有县，但如果我将调用分成 2 组，它就可以工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:09:58.750

“县”数据库中不缺少 Cibola 县。应该足以绘制地图。参见例如：

```
map.text('county', 'new mexico') 
```

# java - “新的 IClasspathEntry[0]”是如何工作的？

> ID：13941588
> 
> 赞同：0
> 
> 时间：2012-12-18T21:12:13.003
> 
> 标签：java, interface, new-operator

我有来自[Java 项目助手](http://alvinalexander.com/java/jwarehouse/eclipse/org.eclipse.jdt.debug.tests/test-plugin/org/eclipse/jdt/debug/testplugin/JavaProjectHelper.java.shtml)的这段代码。

```
javaProject.setRawClasspath(new IClasspathEntry[0], null); 
```

如何`new IClasspathEntry[0]`运作？

![在此处输入图像描述](../Images/7ee20451111c427e5bf82cf9dcc68e2e.png)

1.  如何用 new 实例化接口？
2.  如何使用数组`[0]`而不是`()`新的括号？

## 添加

我认为这是一种更安全的说法 null。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:15:28.597

> 1.如何用new实例化一个接口？

不，永远不能实例化接口。

> 2.如何用数组[0]代替括号()和new？

`IClasspathEntry[0]`只是`IClasspathEntry(well, asubtype of IClasspathEntry)`数组中索引为零的类型元素。你不能实例化一个接口。

```
IClasspathEntry[] arr = new IClasspathEntry[size]; 
```

以上只是创建了一个接受元素的类型**数组。**`IClasspathEntry``subtypes(class's which implement IClasspathEntry)`

## 示例代码：

```
interface IClasspathEntry {}

class Xyz implements IClasspathEntry {}

class main
{
    public static void main(String...args)
    {
        IClasspathEntry[] arr = new IClasspathEntry[1];
        IClasspathEntry inst = new Xyz();
        arr[0] = inst;
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:13:45.560

> 如何用 new 实例化接口？

`new IClasspathEntry[0]`正在创建一个`array object`而不是实例化您的界面。就像`new int[4]`不实例化原始 int 类型，而是创建一个长度为 4 的数组对象。

> 如何用数组[0]代替括号()和new？

它是有效的，因为它正在创建一个数组 - 一个 0 长度的数组。

您可以像这样创建一个数组，以便您可以添加添加到其中的不同实现类的多个实例。

```
IClasspathEntry[] arr = new IClasspathEntry[2];
arr[0] = // instance of class implementing IClasspathEntry 
```

# javascript - 如何在Javascript的弹出警报中以颜色显示特定字符 串

> ID：13941590
> 
> 赞同：0
> 
> 时间：2012-12-18T21:12:21.090
> 
> 标签：javascript

我想在 Java 脚本的弹出警告框消息中以彩色显示特定文本。例如：

```
function redirect()
{
  if ERCode == 'TEST' 
  {
    alert("You will be redirected to www.google.com.");
  }
} 
```

我希望 www.google.com 在弹出警报出现时以蓝色显示。这在 Java Script 中可行吗？

是否可以在至少一个字符串下划线？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:13:50.670

不，这是不可能的`alert`。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:15:17.630

您不能使用默认弹出对话框来执行此操作。您需要使用类似[http://jqueryui.com/dialog/的东西](http://jqueryui.com/dialog/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:32:18.433

在警报中不可能，但使用`jQuery`（也有其他库）你可以实现这一点，即

```
function redirect()
{
    if ERCode == 'TEST' 
    {
        $('<div/>', {'html':'You will be redirected to <span style="color:blue">www.google.com.</span>'})
       .dialog({
            width:400,
            height:'auto',
            modal:true,
            resizable:false,
            buttons: {  
                "Ok":function(){
                    //$(this).dialog("close"); 
                    window.location='www.google.com';
                 } 
             }
         });
    }
} 
```

[**示例在这里。**](http://jsfiddle.net/ThH6d/1/)或[**这一个**](http://jsfiddle.net/ThH6d/2/)。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T21:14:25.117

你不能，警告框使用浏览器开发人员设置的颜色。

获得自定义彩色警报框的唯一方法是创建自己的并为其编写代码。不添加依赖项的[自定义 html 警报](http://slayeroffice.com/code/custom_alert/)示例。我还没有测试过该代码，但它似乎可以工作。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-18T21:20:33.033

使用 jQuery 和 jQuery UI。

```
var dialogUI = $( '<p>You text here <a href="http://google.com">google.com</a></p>' ).dialog( {
   modal: true,
   title: 'Alert',
   buttons: {
      'Okay': function() {
         dialogUI.dialog( 'destroy' );
         // code going to google here
      }
   }
} ); 
```

# iphone - 在缩放的 CALayer 周围拟合视图框架

> ID：13941596
> 
> 赞同：2
> 
> 时间：2012-12-18T21:12:44.397
> 
> 标签：iphone, ios, cocoa-touch, core-animation, calayer

在下面的方法中，我只是`CAShapeLayers`通过使用`CATransform3DMakeScale`. 我能够正确放大形状图层，但是很难让视图框架放大并适合形状图层生成的图形，就像它应该的那样。一切都是相同的大小，即视图框架与所有形状层的大小相同。

有人对如何解决这个问题有任何建议吗？我尝试更改视图转换属性以及视图层转换属性。不知道我在这里缺少什么。

```
- (void) setSize:(CGSize)size
{
    CATransform3D transform = CATransform3DMakeScale(size.width / (self.graphic.initialSize.width), size.height / (self.graphic.initialSize.height), 1);
    self.layer.sublayerTransform = transform;
    self.frame = CGRectMake(0, 0, size.width, size.height);
    self.graphic.size = CGSizeMake(size.width, size.height);
} 
```

也供参考，这是我设置视图层的方式：

```
- (id)initWithGraphic:(Graphic*)graphic
{
    self = [super initWithFrame:CGRectZero];
    if (self) 
    {
        self.backgroundColor = [UIColor clearColor];

        _graphic = [graphic retain];

        self.frame = CGRectMake(0,0, _graphic.initialSize.width, _graphic.initialSize.height);
        self.layer.shouldRasterize = YES;

        for (int i = 0; i < [_graphic.shapeLayers count]; i++)
        {
            [self.layer addSublayer:[_graphic.shapeLayers objectAtIndex:i]];
        }
    }
    return self;
} 
```

这是我设置其中一个形状图层的方式：

```
CAShapeLayer *outlineShapeLayer = [[CAShapeLayer alloc] init];
outlineShapeLayer.anchorPoint = CGPointMake(0, 0);
outlineShapeLayer.fillColor = [UIColor colorWithRed:0 green:0 blue:0 alpha:1].CGColor;
outlineShapeLayer.bounds = shapeLayerFrame;
outlineShapeLayer.mutablePath = mutablePath; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-25T19:14:37.763

我必须这样做，所以我的视图层也设置了锚点和位置以匹配我的 CAShapeLayers，然后它就起作用了：

```
self.layer.anchorPoint = CGPointMake(0, 0);
self.layer.position = CGPointMake(0, 0); 
```

# css - css：目标选择器与新页面

> ID：13941600
> 
> 赞同：0
> 
> 时间：2012-12-18T21:13:02.260
> 
> 标签：css, web-analytics

我正在使用“：target”伪选择器构建一个页面，该伪选择器链接到不同的内容，并产生可书签的带有哈希标记的“页面” 例如：

```
<ul class="menu">
  <li><a href="#home">Home</a></li>
  <li><a href="#history">History</a></li>
  <li><a href="#news">News</a></li>
</ul>
<div class="pages">  
  <div id="home">...</div>
  <div id="history">...</div>
  <div id="news">...</div>
</div> 
```

与指向唯一页面的链接相比，我想知道这如何影响页面点击率和搜索引擎排名。我假设只要 href 是同一页面上的内容，它就只算作一次点击。真的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:33:34.477

`_trackPageview`如果**您**想将这些注册为不同的页面点击，您仍然需要调用。Google Analytics 不会自动捕获这些事件，否则会将其视为单个页面。

# jquery - JQuery 手风琴样式列表

> ID：13941602
> 
> 赞同：1
> 
> 时间：2012-12-18T21:13:07.997
> 
> 标签：jquery

我试图有一个可折叠的元素列表，在任何给定时间只能看到一个。

我将其设置为：

```
<div class="grid_12" id="menu_container">

    <div class="grid_12 title" style="background-color:pink;">
        Book 1
    </div>

    <div class="grid_12 row" style="background-color:white;">
        Chapter 1
        <div class="grid_12 details">Lorem lipsum sin dolor chapter 1</div>
    </div>

    <div class="grid_12 row" style="background-color:white;">
        Chapter 2
        <div class="grid_12 details">Lorem lipsum sin dolor chapter 2</div>
    </div>                                       

</div>​ 
```

我用我的javascript函数尝试了很多东西，结果迷失了方向……有人可以帮我解决这个问题吗？

```
$(".row").click(function(e){

    $(".current").slideUp(function(){
        $(".current").hide();
        $(".current").removeClass("current");                                                                                    
    });

    $(this).children("div.details").addClass("current");
    $(this).children("div.details").slideDown();

});​ 
```

提前致谢！S。

[这是一个 JSFiddle 版本](http://bit.ly/VPpryU "JSFiddle")

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:21:38.163

像这样的东西？

```
$(".row").click(function(e){
    var $e = $(this).children();
    if ($e.hasClass('current')) return;

    $(".current").slideUp(function(){
        $(this).removeClass("current");                                        
    });

    $e.addClass("current").slideDown();
}); 
```

[http://jsfiddle.net/DLFV9/](http://jsfiddle.net/DLFV9/)

# javascript - 打印时在表格中添加分页符

> ID：13941607
> 
> 赞同：2
> 
> 时间：2012-12-18T21:13:29.560
> 
> 标签：javascript, css, printing

这是我的php页面的粗略结构-

```
<table>
  <tr>
    <th> header 1 </th>
    <th> header 2 </th>
  </tr>

 foreach (values as value) {

  <tr>
    <td> column 1 </td>
    <td> column 1 </td>
  </tr>

/* Here if condition is true and media=print I want to close the table, add a page break and start a whole new table as below so the page prints nicely */

  if (condition) {
     </table>
     <div style='page-break-after:always;'> </div>
     <table>

     <tr>
       <th> header 1 </th>
       <th> header 2 </th>
     </tr>

 }

} 
```

有没有办法（可能在 javascript 中）检查 media=print 是否然后在表格中添加分页符？

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:15:37.350

您可以为您的打印需求创建 CSS 样式指南。`page-break`在需要分页符的地方添加一个类。

```
@media all {
  .page-break  { display: none; }
}

@media print {
  .page-break  { display: block; page-break-before: always; }
} 
```

> 第一个声明确保分页符永远不会在视觉上看到......而第二个声明确保分页符被打印机看到。

```
<div class="page-break"></div> 
```

# javascript - HTML - 分组标签索引；旧版 HTML 代码中间的 tabindexes

> ID：13941615
> 
> 赞同：1
> 
> 时间：2012-12-18T21:13:49.680
> 
> 标签：javascript, html, tabindex

我正在维护一个高级 eform 应用程序，其中包含我无法轻易更改的混合遗留自由文本 HTML。以前没有使用 tabindex，它依赖于字符流顺序。

在页面中间，我需要引入一个表格，其中包含带有自定义跳格顺序的输入，例如：

```
|-----|-----|-----|
| 1 | 3 | 5 |
|-----|-----|-----|
| 2 | 4 | 6 |
|-----------------|

```

在页面上呈现遗留/先前添加的输入的方式，我实际上可以动态/集中更改它们，以便它们按顺序输出标签索引。如：

```
[输入，标签索引：1]

|-----|-----|-----|
| 2 | 4 | 6 |
|-----|-----|-----|
| 3 | 5 | 7 |
|-----------------|

[输入，标签索引：8]

```

但是，当自由文本 HTML 锚点开始出现时，问题就出现了，这些锚点不是动态呈现的（因此不能轻易地将 tabindex 添加到它们，除非我添加了相当多的正则表达式逻辑）。那么标签就变成了这样：

```
[输入，标签索引：1]

|-----|-----|-----|
| 2 | 4 | 6 |
|-----|-----|-----|
| 3 | 5 | 7 |
|-----------------|

[锚链接]
[输入，标签索引：8]

```

这使得链接**无法被选项卡到**. 可能有更糟糕，更高级的案例......但我认为这个问题可以理解吗？

**所以我的问题是**……是否有可能以某种方式分配某种 tabindex 组：

```
[标签组1]
[输入]
[/标签组1]

[标签组2]
|-----|-----|-----|
| 1 | 3 | 5 |
|-----|-----|-----|
| 2 | 4 | 6 |
|-----------------|
[/标签组2]

[标签组3]
[锚链接]
[输入]
[/标签组3]

```

这样我就可以像以前一样进行制表工作，按字符流的顺序跳转，从输入到最近的锚点，到下一个输入，等等……但是在 [tabgroup2] 内部时，它将按tabindexes 在那里，但随后继续进入 [tabgroup2] 和 tab 就好像所有元素都有*tabindex="0"*

* * *

我正在寻找的是一些神奇的 HTML 解决方案（这不太可能）或一个相对简单的 javascript 库，它可能已经实现了类似的东西。

或者，如果这实际上不存在，那么如果我自己尝试实现它，听到一些替代想法或可能的警告想法会很有趣。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T22:45:01.997

好的，我用自己的一些代码解决了这个问题。生成的 javascript 如下所示：

```
function updateTabIndex() {
    $('a, area, button, input, object, select, textarea').each(function(i, e) {
        var element = $(e);

        var tabIndex = i;
        if (element.attr('data-tabindexoffset')) {

            var tabgroup = $(element.closest('[data-tabgroup]'));
            if (!tabgroup.attr('data-tabindexstart')) {
                tabgroup.attr('data-tabindexstart', tabIndex);
            }

            var tabIndexStart = parseInt(tabgroup.attr('data-tabindexstart'));
            tabIndex = tabIndexStart + parseInt(element.attr('data-tabindexoffset'));
        }

        $(e).attr('tabindex', tabIndex);
    });
}

$(function() {
    updateTabIndex();
}); 
```

这使我能够不使用 tabindexes，除了已知元素组内的偏移量，其中 tabindex 不会遵循常规字符流顺序。它似乎工作得很好，因为组之后的标签索引总是相同的；只是它们之间的那些被重新排序。

像这样的解决方案的唯一问题是，如果在 AJAX 调用中添加和删除了元素，那么所有索引都需要重新计算。但它应该相当快。

示例 HTML 是：

```
<table data-tabgroup="1">
    <tr>
        <td><input type="text" name="b" data-tabindexoffset="0" value="1" /></td>
        <td><input type="text" name="c" data-tabindexoffset="2" value="3" /></td>
    </tr>
    <tr>
        <td><input type="text" name="d" data-tabindexoffset="1" value="2" /></td>
        <td><input type="text" name="e" data-tabindexoffset="3" value="4" /></td>
    </tr>
</table>

<a href="#">A link</a>
<input type="text" name="f" /> 
```

# c# - 如何确定 .NET 认为我引用的 DLL 驻留在哪个区域？

> ID：13941626
> 
> 赞同：1
> 
> 时间：2012-12-18T21:15:07.113
> 
> 标签：c#, .net, vb.net

我知道在`security.config`.NET 文件中定义了可用的区域以及适用于每个区域的权限：“FullTrust”、“Internet”等。

假设我在我的应用程序中引用了一个 DLL，该 DLL 位于`\\someserver\somedir\library.dll`. 如何找出 .NET 认为它属于哪个区域？

这是`TrustedZone`, `RestrictedZone`,`Internet`还是`Intranet`?

哪些权限适用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:28:58.833

我过去用它来获取区域

```
using System.Security.Policy;

...

Assembly myAssembly = ...;
var zone = myAssembly.Evidence.GetHostEvidence<Zone>();
Console.WriteLine(zone.SecurityZone); 
```

# objective-c - GTMLogger 可以获取标准错误作为输入吗？

> ID：13941627
> 
> 赞同：0
> 
> 时间：2012-12-18T21:15:15.563
> 
> 标签：objective-c, logging, stdout, stderr

我正在尝试在我的应用程序中嵌入 GTMLogger 以记录所有信息。我的应用程序使用将事件记录到标准错误和标准输出的第 3 方代码。我已将它们重定向到我的应用程序的 stderr 并希望将它们打印到日志文件中。是否可以天真地做到这一点？有人可以举例说明它是如何完成的吗？我是objc的新手，所以请原谅我的无知:)

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T15:27:34.980

最终将标准输出和标准错误重定向到我的标准错误，打开了一个 GTMLogger 对象并将编写器设置为我的标准错误。然后使用 freopen 我将 stderr 打印到所需的日志文件中。

# php - 在 XML 文件中搜索多个元素

> ID：13941629
> 
> 赞同：0
> 
> 时间：2012-12-18T21:15:22.873
> 
> 标签：php, xml, xml-parsing, domdocument

我正在使用[此处](http://www.w3schools.com/php/php_ajax_livesearch.asp)找到的 W3C Live Ajax 搜索。他们的代码只搜索一个元素，即“标题”。我想让它接受用户的查询并搜索多个元素，例如“标题”和“网址”。

```
<?php
$xmlDoc=new DOMDocument();
$xmlDoc->load("live.xml");

$x=$xmlDoc->getElementsByTagName('link');

//get the q parameter from URL
$q=$_GET["q"];

//lookup all links from the xml file if length of q>0
if (strlen($q)>0)
{
$hint="";
for($i=0; $i<($x->length); $i++)
  {
  $d=$x->item($i)->getElementsByTagName('title');
  $z=$x->item($i)->getElementsByTagName('url');
  if ($d->item(0)->nodeType==1)
    {
    //find a link matching the search text
    if (stristr($d->item(0)->childNodes->item(0)->nodeValue,$q) !=false)   
      {
      if ($hint=="")
        {
        $hint=
        $z->item(0)->childNodes->item(0)->nodeValue . "<br />" . 
        $d->item(0)->childNodes->item(0)->nodeValue;
        }
      else
        {
        $hint=$hint . "<br /><br />" .
        $z->item(0)->childNodes->item(0)->nodeValue . "<br />" .  
        $d->item(0)->childNodes->item(0)->nodeValue;
        }
      }
    }
  }
}

// Set output to "no suggestion" if no hint were found
// or to the correct values
if ($hint=="")
  {
  $response="no suggestion";
  }
else
  {
  $response=$hint;
  }

//output the response
echo $response;

?> 
```

有人可以给我一个如何使它工作的例子吗？据我了解， stristr 只会搜索一个干草堆，你不能使用数组，那么还有另一种方法吗？提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:33:15.220

好吧，我想出了一个办法：

```
if ( (stristr($d->item(0)->childNodes->item(0)->nodeValue,$q) !=false) || 
     (stristr($z->item(0)->childNodes->item(0)->nodeValue,$q) !=false) ) 
```

我怀疑这是最佳方式，所以如果有人有更好的解决方案，请随时添加。

# assembly - 除emu 8086组装错误

> ID：13941631
> 
> 赞同：2
> 
> 时间：2012-12-18T21:15:25.750
> 
> 标签：assembly, x86-16, divide-by-zero

> **可能重复：**
> [ASM x86 整数溢出](https://stackoverflow.com/questions/13391152/asm-x86-integer-overflow)

我得到一个除法错误-溢出，不知道为什么。这是重现错误的完整代码

```
include emu8086.inc

org 100h

       mov ax, 2 
       mov bx, 10
       div bx

       mov ax, 2
       mov bx, 2
       div bx   
       ret 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T21:21:45.450

尝试`xor dx, dx`在每个之前添加`div`，看看是否没有帮助。

由于您指定的是 16 位目标，因此`div`除以`dx:ax`该目标。如果`dx`一开始包含一个很大的数字（更准确地说，不是很小的数字），结果将溢出。即使它没有溢出，您的结果也不会像您显然想要的那样`ax`/ 。`bx`

# iphone - 振动到声音 iphone

> ID：13941633
> 
> 赞同：1
> 
> 时间：2012-12-18T21:15:33.950
> 
> 标签：iphone, audio, vibration

我正在开发视频应用程序。并且我的手机处于振动或静音状态，我播放视频然后没有播放视频声音。但是即使手机处于静音或振动状态，我也想播放声音。所以请让我知道这可能吗？如果是，那么如何？请给我示例源代码。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:18:04.747

IOS 不会给您的应用程序那种控制。
当用户将 ios 设置为静音时，所有应用程序都处于静音状态。

# c# - 执行 File.Copy 时拒绝访问路径“autorun.inf”

> ID：13941638
> 
> 赞同：1
> 
> 时间：2012-12-18T21:15:49.383
> 
> 标签：c#, .net, visual-studio-2010, windows-applications

当我尝试在 Windows 应用程序中复制文件时出现以下异常...

**拒绝访问路径“autorun.inf”。**

我要复制的文件是一个快捷方式文件。但是，当我在独立应用程序中移动 EXACT 代码行时，它可以完美执行。相同的用户凭据。我如何启动这两个应用程序没有区别。

这是代码行...

```
File.Copy(Path.Combine(Path.GetDirectoryName(Application.ExecutablePath), "JEE Startup.lnk"), @"C:\Documents and Settings\All Users\Start Menu\Programs\Startup\JEE Startup.lnk", true); 
```

我尝试删除 bin 文件夹并重建。没运气。

我不知道出了什么问题。

该应用程序正在 XP 机器上执行。

# asp.net - 在 localhost 上调用 asp.net webservice

> ID：13941640
> 
> 赞同：3
> 
> 时间：2012-12-18T21:16:03.323
> 
> 标签：asp.net, web-services, iis, localhost, asmx

我接到了一项任务，我必须为也使用 Web 服务的 ASP.NET 网站编写一些代码。

Web 服务在 Web 服务器上运行良好，但是当我在 Visual Studio 中以调试模式运行时，调用其中一种方法（ip 127.0.0.1）时出现不允许访问。

我需要在调试模式下运行以查看代码的作用...

从这里做什么？

1.  我是否需要对主机文件进行一些更改。
2.  我是否需要在我的 PC 上安装 IIS 而不是使用 VS 本地网络服务器 (cassini)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:30:17.000

Cassini Web 服务器不允许远程连接。对于某些给定的请求，您可以使用 Fiddler 将 localhost 上的流量转发到同一台机器上的另一个端口。

到目前为止，最简单的解决方案是在本地计算机上安装 IIS 并从那里运行它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-26T16:51:07.530

Cassini 非常适合开发和快速运行。

但*从来没有*我们用它来测试将在“真正的”IIS 上投入生产的东西。

是的，微软说它完全一样，但是在你的本地机器上运行的 IIS 也为你提供了与任何实时托管环境*完全相同*的环境。

当然，它需要做更多的工作，但是以这种方式开发可以减少错误和伪影，这可能会占用您一些时间。

# php - PHP OOP 设计：一个对象可以有多种“模式”。我如何定义它们？

> ID：13941641
> 
> 赞同：1
> 
> 时间：2012-12-18T21:16:05.307
> 
> 标签：php, oop, properties

我有一个`Display`处理脚本的 HTML 输出的对象。它有一个`mode`属性，它定义了如何生成输出的许多方面。有几种模式，我以后可能会添加更多。每种模式都暗示着它自己的参数。例如，一个`author`模式意味着一个`authorID`. `search`模式意味着将对象`Search`作为参数，其中将包含查询信息。一个`comment`模式意味着一个`postID`和`commentID`参数。

因此， a`mode`有 a`name`和一定数量的`parameters`，具体取决于`name`。

我决定创建一个`Display_Mode`对象，它有两个属性：`name`和`parameters`. 但是我该如何`parameters`分配`names`？所以，如果我有一个`comment`模式，它必然意味着有`postID`和`commentID`参数？

我目前的解决方案是这样的：

```
class display_mode{
    public $name;
    public $params;

    public function __construct($name)
        {
        $this->name = $name;
        switch ($this->name){
            case 'comment':
                $this->params = array('postID', `commentID`);
                break;
            case 'author':
                $this->params = array('authorID');
            }
            //etc..
        }
    } 
```

这似乎有点乱。有没有更好的办法？

UPD：给定的答案让我问[了另一个](https://stackoverflow.com/questions/13942092/is-it-a-bad-idea-to-use-a-display-class-to-handle-html-generation-logic-in-php)关于整个设计的问题，这也为这个设计提供了背景。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:18:47.133

您最好将`Display_Mode`类的通用功能抽象为抽象基类或接口，然后将每个单独的模式定义为从基类继承（或实现接口）的类。

然后，这些专用模式类将在其构造函数和/或方法中显式定义它们所需的参数，并负责生成每个“模式”所需的输出。

但是，如果不确切知道您的`Display_Mode`班级应该做什么，就很难给出比这更具体的建议。

* * *

这里的想法是，您应该避免 OOP 中的全能类，而更喜欢小型的、自包含的类，每个类都有一个单一的目的。通过为每种模式提供可以独立呈现其内容的类，您可以轻松更改显示模式的工作方式或添加新模式。您所要做的就是添加一个新类。

这称为*[松耦合](http://en.wikipedia.org/wiki/Coupling_%28computer_programming%29)*。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:25:44.617

描述有点令人困惑，但我会为每个可能的“参数”创建一个适配器`Display`。该适配器可以提供单一接口，独立于您要显示的资源。

```
$parameter = new UnknownPrameter;

$adapterFactory = new AdapterFactory;
$parameter = $adapterFactory->build( $parameter );

$display->present( $parameter ); 
```

在哪里`AdapterFactory::build()`为您提供的特定类型的参数创建包装器。返回的实例是该参数的容器。

这种方法还可以防止计算在构造函数中累积，这会使代码更难测试/扩展。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:50:03.537

@Will Vousden 已经给了你答案。这是一个如何解决您的问题的快速示例。

```
abstract class DisplayMode {
    protected $_params = array();

    public function __construct(array $params) {
        $this->_params = $params;
    }

    public function hasParameter($key) {
        if (array_key_exists($key, $this->_params)) {
            return true;
        }
        return false;
    }

    public function setParameters(array $params) {
        $this->_params = $params;
        return $this;
    }

    public function getParameters() {
        return $this->_params;
    }
}

class CommentMode extends DisplayMode {
    public function getCommentId() {
        if ($this->hasParameter('comment_id')) {
            return $this->_params['comment_id'];
        }    
        return null;
    }

    public function getPostId() {
        if ($this->hasParameter('post_id')) {
            return $this->_params['post_id'];
        }    
        return null;
    }
}

class AuthorMode extends DisplayMode {
    public function getAuthorId() {
        if ($this->hasParameter('author_id')) {
            return $this->_params['author_id'];
        }    
        return null;
    }
}

$comment = new CommentMode(array('post_id' => 4, 'comment_id' => 2));
$author = new AuthorMode(array('author_id' => 3));

// example

print $comment->getCommentId() . ' -  ' . $comment->getPostId() . '  - ' . $author->getAuthorId(); 
```

# php - 使用传递值重定向页面

> ID：13941642
> 
> 赞同：2
> 
> 时间：2012-12-18T21:16:11.680
> 
> 标签：php, html

我有一个真正的问题，它是语法问题。通常，当我需要重定向任何页面时，我只使用标题功能。有时我在需要时使用变量，如下所示：

```
if(condition) header("Location: home.php?wrong=1"); 
```

有时可能是：

```
if(condition) header("Location: home.php?wrong=1&&success=2"); 
```

直接使用变量没有问题（错误或成功）。当我需要通过 post 方法从 html 表单中重定向一个值时，我使用此代码并且它可以工作：

```
if (condition) header("Location: home.php?id=".$_POST['topic_id']); 
```

但我需要更多，我也需要传递另一个值。所以我使用：

```
if (condition) header("Location: home.php?id=".$_POST['topic_id']&&wrong=1); 
```

而这一次我变成了一个笨蛋。任何人都可以通过提供正确的语法来帮助我吗？我也只需要通过 WRONG=1 部分。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:17:20.583

你需要：

```
if (condition) header("Location: home.php?id=" . $_POST['topic_id'] . "&wrong=1"); 
```

或者

```
if (condition) header("Location: home.php?id={$_POST['topic_id']}&wrong=1"); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:23:33.433

有时可能是

```
if (condition) {
  $_SESSION['error']['topicId'] = $_POST['topic_id'];
  $_SESSION['error']['otherData'] = array('sadfasdfasdfasd' => 'adsfasdf');
  header("Location: home.php?wrong=1");
  exit;
} 
```

进而：

```
//home.php
if (!empty($_SESSION['error'])) {
  $topicId = $_SESSION['error']['topicId'];
  //... do someth ...
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:25:53.700

如果 PHP 标头函数有任何问题，请记住，您可以在脚本 HTML 输出中打印出刷新元标记。

```
<meta http-equiv="refresh" content="0;url=http://yoursite.com/thepath/you/want/file.php?parames=anything"> 
```

这是关于元刷新标签的资源：

[http://webdesign.about.com/od/metataglibraries/a/aa080300a.htm](http://webdesign.about.com/od/metataglibraries/a/aa080300a.htm)

# wcf - 使用本地帐户的 WCF userPrincipalName 值属性格式是什么？

> ID：13941645
> 
> 赞同：1
> 
> 时间：2012-12-18T21:16:15.123
> 
> 标签：wcf, userprincipal

假设本地帐户名称是“JohnDoe”并且本地机器名称是“Development”...

在一个清晰、明确的功能示例中，userPrincipalName 的值应该是什么？

```
 <identity>
      <userPrincipalName value="WHAT GOES HERE IF USING A LOCAL ACCOUNT?" />
    </identity> 
```

# excel - 增加范围维度

> ID：13941647
> 
> 赞同：-1
> 
> 时间：2012-12-18T21:16:24.830
> 
> 标签：excel, excel-2007, excel-2010, vba

我有一个命名范围，它指的是范围`D3:I23`，这个范围是为某些自动化目的而明确定义的。

最近我有一个更新，要求我重新定义这个范围`F3:I23`，最初排除列`D`& `E`。但在各种逻辑编码中，我需要包括`E`评估（将动态数据转换为静态数据）。

正在考虑使用`Resize`，但似乎不正确。也想过`Offset`，但这会使整个范围向前或向后移动。我基本上需要在保留原始定义范围的同时将范围调整回 1 列

本质上，我需要将命名范围定义为，`F3:I23`但在这一代码段中，我需要评估范围`E3:I23`。

在 VBA 中使用的任何想法或 Range 属性的组合？在我传递引用时，它被存储在一个`Range`对象中，因此任何链接的属性集都是公平的游戏。

`KISS`请在回答时尝试应用该政策。不需要是一个过于复杂的公式，因为我不能保证是支持最终结果的人。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:55:01.613

正如 Rachel 指出的那样......这应该可以解决问题，假设您的命名范围被定义为 namedRange：

```
Set neededRange = namedRange.Resize(namedRange.Rows.Count, _
              namedRange.Columns.Count + 1).Offset(0, -1) 
```

调整大小以将包含的列增加 1，然后将整个范围偏移 -1 列以获得您的`neededRange`.

# jquery - jQuery 创建一个页面“地图概览”

> ID：13941650
> 
> 赞同：2
> 
> 时间：2012-12-18T21:16:36.140
> 
> 标签：jquery, offset, dimensions, jquery-calculation

我尝试创建一个这样的“页面'地图'-概述” （甚至更复杂[的这样](http://larsjung.de/fracs/)[）](http://www.chromazone-imaging.co.uk/flashindex.html)但是我坚持计算，不知道问题在哪里或如何消除。

这[是我](http://jsfiddle.net/ARTsinn/NzBSr/0/)到目前为止所做的：

```
var Overview = (function() {

    $('.spot').each(function() {
        var el = $(this),
            map = $('#map'),
            point = document.createElement('span');

        point.className = 'point';
        map.append(point);

        var offsetX = el.offset().left, // Might the problem is here,
            offsetY = el.offset().top, // and here?!
            winW = $(window).width(),
            winH = $(window).height(),

            mapWidth = map.width() - $(point).width(),
            mapHeight = map.height() - $(point).height(),

            posX = offsetX / winW * mapWidth,
            posY = offsetY / winH * mapHeight;

        $(point).css({
            top: posY,
            left: posX
        });
    });

})(); 
```

我想不通，问题出在哪里。任何想法如何修复或改进我的计算？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T21:08:35.067

好的，我自己[修好](http://jsfiddle.net/ARTsinn/N5Rmp/3/)了。也许它可以帮助别人：

```
var Overview = function() {
    $('body').append('<div class="minimapWrapper"><div class="miniMap"><i class="cursor"></i></div></div>');

    var holder = $("#holder"),
        miniMap = $(".miniMap"),
        spots = holder.find('.spot'),
        holderPos = holder.offset();

    if (spots.length > 0) {
        var holderW = holder.width(),
            holderH = holder.height(),
            mapW = miniMap.width(),
            mapH = miniMap.height();

        spots.each(function() {
            var point = $(this),
                pointPos = point.offset(),
                top = pointPos.top - holderPos.top,
                left = pointPos.left - holderPos.left,

                marker = $(document.createElement('span')),
                markerTop = (mapH * top) / holderH,
                markerLeft = (mapW * left) / holderW;

            markerTop = Math.abs(markerTop);
            markerLeft = Math.abs(markerLeft);

            marker.css({
                top: markerTop,
                left: markerLeft
            })[0].className = 'marker';

            miniMap.append(marker);

            marker.click(function() {
                $('html,body').animate({
                    scrollTop: pointPos.top,
                    scrollLeft: pointPos.left
                });
                return false;
            });
        });
    }
}; 
```

# asp.net - 访问多个动态控件值

> ID：13941661
> 
> 赞同：0
> 
> 时间：2012-12-18T21:17:31.210
> 
> 标签：asp.net, vb.net, dynamic-controls

我根据用户选择的下拉列表动态添加多个控件。即，如果用户选择 3，则添加 3 组控件。我的问题不在于添加控件，我可以很好地添加它们，我没有添加所有代码，但主要部分是为了了解我在做什么。

创建控件后，将捕获相关信息。在更新单击上，我需要通过以正确的顺序循环访问这些动态控件的值并检索值并写入数据库。我似乎无法正确访问它们。

希望我说得通。任何帮助，将不胜感激。谢谢

```
''Loop through first set of controls and get values and then the next set etc..

Dim Description as string = ''Get Textbox value
Dim Type as string = ''Get RadComboBox value
Dim XFieldName as string = ''Get RadComboBox value
Dim Colour as string = ''Get RadColorPicker value 
```

以下是我的代码：

VB

```
Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load

    RecreateControlsTxt("txt", "TextBox")
    RecreateControlsChart("comboChart", "RadComboBox")
    RecreateControls("combo", "RadComboBox")
    RecreateControlsCP("cp", "RadColorPicker")

End Sub

Protected Sub AddControls_Click(sender As Object, e As EventArgs) Handles AddControls.Click

    For i As Integer = 0 To ddlFieldNames.SelectedIndex
        CreateTextbox("txt-" & Convert.ToString(i + 1))
    Next

    For i As Integer = 0 To ddlFieldNames.SelectedIndex
        CreateComboChart("comboChart-" & Convert.ToString(i + 1))
    Next

    For i As Integer = 0 To ddlFieldNames.SelectedIndex
        CreateComboField("combo-" & Convert.ToString(i + 1))
    Next

    For i As Integer = 0 To ddlFieldNames.SelectedIndex
        CreateColourPicker("cp-" & Convert.ToString(i + 1))
    Next

End Sub

Private Sub CreateTextbox(ByVal ID As String)
    Dim txt As New TextBox()
    txt.ID = ID
    txt.Height = 20
    Me.divDesc.Controls.Add(txt)
End Sub

Private Sub CreateComboField(ByVal ID As String)
    Dim combo As New RadComboBox()
    combo.ID = ID
    combo.DataSource = Me.odsChartsSeriesField
    combo.DataTextField = "FieldNames"
    combo.DataValueField = "FieldNames"
    combo.DataBind()
    Me.divField.Controls.Add(combo)
End Sub

Private Sub CreateComboChart(ByVal ID As String)
    Dim comboChart As New RadComboBox()
    comboChart.ID = ID
    Dim item1 As New RadComboBoxItem()
    item1.Text = "Line"
    item1.Value = "smoothedLine"
    item1.ImageUrl = ("Images/linechart.png")
    comboChart.Items.Add(item1)
    Dim item2 As New RadComboBoxItem()
    item2.Text = "Column"
    item2.Value = "column"
    item2.ImageUrl = ("Images/bar chart.png")
    comboChart.Items.Add(item2)
    Dim item3 As New RadComboBoxItem()
    item3.Text = "Pie"
    item3.Value = "pie"
    item3.ImageUrl = ("Images/pie chart.jpg")
    comboChart.Items.Add(item3)
    Me.divChart.Controls.Add(comboChart)
End Sub

Private Sub CreateColourPicker(ByVal ID As String)
    Dim cp As New RadColorPicker()
    cp.ID = ID
    cp.ShowIcon = True
    cp.Style("padding-top") = "1px"
    cp.CssClass = "CustomHeight"
    Me.divCol.Controls.Add(cp)
End Sub

Protected Sub Update_Click(sender As Object, e As EventArgs) Handles Update.Click
    Try
            Dim alltxt = divDesc.Controls.OfType(Of TextBox)()
            Dim allcomboChart = divChart.Controls.OfType(Of RadComboBox)()
            Dim allcomboField = divField.Controls.OfType(Of RadComboBox)()
            Dim allcp = divCol.Controls.OfType(Of RadColorPicker)()

            ''Loop through first set of controls and get values and then the next etc..
            Dim Description as string = ''Get Textbox value
            Dim Type as string = ''Get RadComboBox value
            Dim XFieldName as string = ''Get RadComboBox value
            Dim Colour as string = ''Get RadColorPicker value

            If Page.IsValid Then
                Dim da As New dsSVTableAdapters.Chart
                Dim Result As String = da.Series(60, Description, Type, Colour, "YFieldName", XFieldName)
            End If

    Catch ex As Exception
        lblResult.Text = ex.Message
    End Try
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:59:25.320

您有一组重复的控件。因此，您需要一组相应的重复变量来存储这些值。我建议创建一个可以存储变量（或属性）集的类。

```
Public Class ControlSet
    Public Property Description As String
    Public Property Type As String
    Public Property XFieldName As String
    Public Property Colour As String
End Class 
```

创建一个包含这些值的数组

```
Dim Values = New ControlSet(ddlFieldNames.SelectedIndex) {} 
```

并在循环中检索值

```
For i As Integer = 0 To Values.Length - 1
    Values(i).Description = CType(divDesc.FindControl("txt-" & Convert.ToString(i + 1)), TextBox).Text
    Values(i).Type = CType(divChart.FindControl("comboChart-" & Convert.ToString(i + 1)), RadComboBox).SelectedValue
    Values(i).XFieldName = ...
    ...
Next 
```

还要使用控件的ID；如果您有多个相同类型的控件，这有助于避免混淆。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:13:17.920

您可以使用`.FindControl(string id)`方法，并且应该将控件计数保持在视图状态或会话中：

```
Protected Sub Update_Click(sender As Object, e As EventArgs) Handles Update.Click
Try
        ''Loop through first set of controls and get values and then the next etc..
        For i As Integer = 0 To controlsCount - 1
            Dim Description as string = ((TextBox)divDesc.FindControl("txt-" & Convert.ToString(i + 1))).Text ''Get Textbox value
            Dim Type as string = ((RadComboBox)divChart.FindControl("comboChart-" & Convert.ToString(i + 1))).SelectedValue ''Get RadComboBox value
            Dim XFieldName as string = ((RadComboBox)divField.FindControl("combo-" & Convert.ToString(i + 1))).SelectedValue ''Get RadComboBox value
            Dim Colour as string = ((RadColorPicker)divField.FindControl("cp-" & Convert.ToString(i + 1))).SelectedValue ''Get RadColorPicker value

            If Page.IsValid Then
                Dim da As New dsSVTableAdapters.Chart
                Dim Result As String = da.Series(60, Description, Type, Colour, "YFieldName", XFieldName)
        Next
        End If

    Catch ex As Exception
        lblResult.Text = ex.Message
    End Try
End Sub 
```

# c# - C# 中的 IPv6 隧道多线程

> ID：13941664
> 
> 赞同：2
> 
> 时间：2012-12-18T21:17:47.400
> 
> 标签：c#, multithreading, proxy, ipv6

我的 ISP 不支持`IPv6`，因此我只有 IPv4 地址。假设我们在[http://tunnelbroker.net/](http://tunnelbroker.net/)上有一个帐户，在[http://www.sixxs.net/](http://www.sixxs.net/)上有一个帐户。这些资源中的每一个都提供了从 IPv4 到 IPv6 的隧道，据我所知，在输出中您可以分别访问 IPv6 网络和 IPv6 地址。

问题如下 - 我需要一个具有两个线程的应用程序，每个线程都将使用自己的隧道选项，例如服务器 IPv4 地址、可用的 DNS 解析器等。显然，线程必须并行工作 + 请记住可能会有超过他们两个。是否可以在不使用 netsh 修改全局窗口设置的情况下以某种方式组织它？也许有一种方法可以只为线程设置隧道选项，就像它在`HttpWebRequest`：

```
HttpWebRequest.Proxy = new WebProxy(); // 
```

好的，所以如果我们使用较低级别的 API，我需要做什么才能将默认的 HttpWebRequests/Responses 放入这样的隧道中（如果我理解正确的话，ofc）？

*已编辑

这些是 tunnelbroker.com 建议申请默认隧道工作的设置：

```
netsh interface teredo set state disabled
netsh interface ipv6 add v6v4tunnel IP6Tunnel my_ip_here server_ip_here
netsh interface ipv6 add address IP6Tunnel 2001:470:18:201::2
netsh interface ipv6 add route ::/0 IP6Tunnel 2001:470:18:201::1 
```

实际上，我正在寻找任何提示，因为我是低级网络编程的新手。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:37:09.523

6to4 隧道为您的机器提供了一个实际的 IPv6 地址。您可以使用多个 6to4，并且您将获得多个 IPv6 地址。要指定要使用哪一个，您需要将套接字绑定到您想要的 IP。

大多数更高级别的 API 不支持设置它们绑定的 IP——你在这里很不走运，完全受 API 开发人员的摆布。大多数 API 甚至不会尝试自己绑定到特定地址，而是让操作系统来处理选择。这是一个奇怪的要求，所以很难责怪他们:)

# jquery - 如何将 jQuery error-ui 应用于下拉列表？

> ID：13941675
> 
> 赞同：0
> 
> 时间：2012-12-18T21:18:54.827
> 
> 标签：jquery, drop-down-menu, validation, jquery-ui-theme

所以我正在开发这个应用程序，我正在使用 jQuery 进行输入控制。只是标准。

```
if ($( "#naam" ).val() == "") {
    $( "#name" ).addClass( "ui-state-error" );
    ok = false;
} else {
    $( "#name" ).removeClass( "ui-state-error" );
} 
```

但是我找不到如何让这个 css(ui-state-error) 出现在下拉列表中。最简单的方法是什么？

# android - 如何插入到 SQLliteDatabase android？

> ID：13941676
> 
> 赞同：-1
> 
> 时间：2012-12-18T21:19:03.240
> 
> 标签：android, database, sqlite

当我尝试将一些数据插入到我在 android 中创建的 SQLliteDatabase 时遇到问题。

下面是我在名为 SQLlitenew 的类中创建数据库的代码：

```
public class SQLlitenew{
    public static final String KEY_ROWID="id";
    public static final String KEY_PRODUCTNAME="ProductName";
    public static final String KEY_PRODUCTTYPE="ProductType";
    public static final String KEY_LOCATION="place";
    public static final String KEY_WORKER="worker";
    public static final String KEY_QUESTION1="Question1";
    public static final String KEY_QUESTION2="Question2";
    public static final String KEY_QUESTION3="Question3";
    public static final String KEY_QUESTION4="Question4";
    public static final String KEY_QUESTION5="Question5";
    public static final String KEY_TIME="time";
    public static final String KEY_UPLOADED="uploaded"; 
    public static final String KEY_EMAIL="emailAdd";
    public static final String TAG="DBAdapter"; // This is for logging information e.g LOG.d

    private static final String DATABASE_NAME="NOID";
    private final static String DATABASE_TABLE="session";

    private static final int DATABASE_VERSION = 2;

    private static final String DATABASE_CREATE = "create table if not exists " + DATABASE_TABLE + " (id INT(11) primary key autoincrement, " +
            "ProductName VARCHAR, ProductType VARCHAR, place INT(5), worker VARCHAR, " +
            "Question1 VARCHAR, Question2 VARCHAR, Question3 VARCHAR, Question4 VARCHAR, Question5 VARCHAR, " +
            "time long, uploaded INT(1), emailAdd VARCHAR );";

    //create instant of DBhelper class
    private DBHelper ourHelper;
    private final Context ourContext;
    private SQLiteDatabase ourDatabase;

    private static class DBHelper extends SQLiteOpenHelper{

        public DBHelper(Context context) {
            super(context, DATABASE_NAME, null, DATABASE_VERSION);
            // TODO Auto-generated constructor stub
        }

        @Override
        public void onCreate(SQLiteDatabase ourDatabase) {
            // TODO Auto-generated method stub

            //First create the database table
            try{
            ourDatabase.execSQL(DATABASE_CREATE);
            Log.w(DATABASE_CREATE,"successssssssssssssss!");

            }catch(SQLException e){
                e.printStackTrace();
                Log.w(DATABASE_CREATE,"FFFAAAAIIIIIILLLLLLEEEDDDDDDDDDDDD!");
            }
        }

        @Override
        public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
            // TODO Auto-generated method stub
            //----always move the Data before Deleting the Data----->
            Log.w(TAG, "This is will delete the previous data which will make you lose all information from the" +oldVersion + "and will create a new database to the " + newVersion);
            db.execSQL("DROP TABLE IF EXIST " + DATABASE_TABLE);
            onCreate(db);
        }

    }

    //set up public contructor
    public SQLlitenew(Context c){
        this.ourContext = c;
        ourHelper = new DBHelper(c);

    }

    public long insertRecord(String productName,  String productType, String place, String name, String ans1, String ans2, String ans3, String firstChoice, String secondChoice, long time, int uploaded, String email){

        //writing stuff into db
        ContentValues content = new ContentValues();

        content.put(KEY_PRODUCTNAME, productName);
        content.put(KEY_PRODUCTTYPE, productType);
        content.put(KEY_LOCATION, place);
        content.put(KEY_WORKER, name);
        content.put( KEY_QUESTION1, ans1);
        content.put( KEY_QUESTION2, ans2);
        content.put( KEY_QUESTION3, ans3);
        content.put( KEY_QUESTION4, firstChoice);
        content.put( KEY_QUESTION5, secondChoice);
        content.put(KEY_TIME, time);
        content.put( KEY_UPLOADED, uploaded);
        content.put(KEY_EMAIL, email);      

        return ourDatabase.insert(DATABASE_TABLE, null, content);

    }
    public void close(){
        ourHelper.close();

    }

    public SQLiteDatabase getWritableDatabase() {
        ourHelper = new DBHelper(ourContext);
        ourDatabase = ourHelper.getWritableDatabase();
        // TODO Auto-generated method stub
        return null;
    }
} 
```

这是一个单独的类中的代码，我在其中调用函数来插入数据：

```
SQLlitenew entry = new SQLlitenew(this);
entry.open();
entry.insertRecord(product, productType, place, name, ans1, ans2, ans3, firstChoice, secondChoice, time, uploaded, email);
entry.close(); 
```

问题是当我尝试插入时，它会带来这个错误：

```
12-18 13:08:45.029: I/Database(4282): sqlite returned: error code = 1, msg = no such table: session
12-18 13:08:45.044: E/Database(4282): Error inserting time=1355864924948 ProductType=Food Question5=Fresh & Clean Scents i.e nourishing milk & honey that hydrates and protects
12-18 13:08:45.044: E/Database(4282):  uploaded=0 Question4=Chip resistant nail polish 
12-18 13:08:45.044: E/Database(4282):  worker=ttt Question3=YES ProductName=tyyyy Question2=African American Question1=Under 25 place=56677 emailAdd=t@n.com
12-18 13:08:45.044: E/Database(4282): android.database.sqlite.SQLiteException: no such table: session: , while compiling: INSERT INTO session(time, ProductType, Question5, uploaded, Question4, worker, Question3, ProductName, Question2, Question1, place, emailAdd) VALUES(?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?); 
```

将 database_version 提升到 3 的新错误。

```
12-18 14:00:38.794: I/Database(4384): sqlite returned: error code = 1, msg = AUTOINCREMENT is only allowed on an INTEGER PRIMARY KEY
12-18 14:00:38.794: E/Database(4384): Failure 1 (AUTOINCREMENT is only allowed on an INTEGER PRIMARY KEY) on 0x279960 when preparing 'create table if not exists session (id INT(11) primary key autoincrement, ProductName VARCHAR, ProductType VARCHAR, place INT(5), worker VARCHAR, Question1 VARCHAR, Question2 VARCHAR, Question3 VARCHAR, Question4 VARCHAR, Question5 VARCHAR, time long, uploaded INT(1), emailAdd VARCHAR );'.
12-18 14:00:38.802: W/System.err(4384): android.database.sqlite.SQLiteException: AUTOINCREMENT is only allowed on an INTEGER PRIMARY KEY: create table if not exists session (id INT(11) primary key autoincrement, ProductName VARCHAR, ProductType VARCHAR, place INT(5), worker VARCHAR, Question1 VARCHAR, Question2 VARCHAR, Question3 VARCHAR, Question4 VARCHAR, Question5 VARCHAR, time long, uploaded INT(1), emailAdd VARCHAR ); 
```

我想不通，它一直让我发疯！感谢您花时间研究这个问题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:02:58.237

对于 Android，您`INTEGER PRIMARY KEY`应该命名`_id`并根据您需要使用的错误`INTEGER`not `INT(11)`。正确的语法是：

```
_id INTEGER PRIMARY KEY, 
```

`AUTOINCREMENT`并且`NOT NULL`是隐含的。您可以根据需要添加它们，但它们是“语法糖”。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T22:02:10.073

我试图执行你的代码。

问题是数据库创建`ourDatabase.execSQL(DATABASE_CREATE);` 失败是因为

> 引起：android.database.sqlite.SQLiteException: AUTOINCREMENT 只允许在 INTEGER PRIMARY KEY: 上，同时编译：

您需要将 id 声明为 INTEGER PRIMARY KEY，而不是 INT(11)

鉴于表创建失败，后续插入将不起作用。

# php - 模型没有在 symfony 1.3 中自动加载

> ID：13941684
> 
> 赞同：0
> 
> 时间：2012-12-18T21:19:41.553
> 
> 标签：php, symfony1, propel, symfony-1.3

我的数据库中有一个名为 的表`student`，当我尝试使用

```
StudentPeer::retreiveByPk($stid) 
```

我收到一个致命错误说

> 调用未定义的方法 StudentPeer::retreiveByPk

有没有办法动态加载我的模型？有没有办法让我看到所有自动加载的模型？还有一种方法可以为这个模块自动加载我的模型吗？

我正在使用 symfony 1.3。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:53:40.027

您拼错了方法调用 - 它应该是`StudentPeer::retrieveByPk($stid)`. 该模型应该可以很好地自动加载，但我不希望它在未定义的方法上。

# html - 重新设计旧的 wwwboard 网站：如何在不更改 .html 扩展名的情况下分解导航栏？

> ID：13941685
> 
> 赞同：0
> 
> 时间：2012-12-18T21:19:56.110
> 
> 标签：html, css, object, embed, navigationbar

我试图让 90 年代的旧 wwwboard 看起来比 90 年代的东西更新。有 46,770 个文件需要转换。我将使用我用 Java 编写的程序从每个页面上撕下内容并将其推送到更新的页面中，但是在我转换所有内容之前，我想确保我放入内容的模板可以轻松编辑在将来。

这对于导航栏、页脚和广告很重要。通常，如果我使用的是 PHP，我会使用

```
<?php include ('header.html'); ?>
<?php include ('navbar.html'); ?>
<!--actual content-->
<?php include ('footer.html'); ?> 
```

不幸的是，所有文件都需要保留其 .html 文件名。所以PHP是不可能的。（如果我错了，请纠正我。）所以我试图通过使用来分解标题和导航栏

```
<object id="HeaderObj" data="header.html" >
    <embed src="header.html">
</object>
<object id="NavbarObj" data="navbar.html" >
    <embed src="navbar.html">
</object> 
```

这两个部分都将具有由 CSS 控制的宽度和属性，以便将来轻松更改嵌入。 ![在此处输入图像描述](../Images/2ceb9c148b6cccf044512a0edee3da6b.png)

不幸的是，当您点击这些嵌入图片中的链接时，它会在嵌入页面中打开新链接。它看起来像这样。 ![在此处输入图像描述](../Images/73a54d3fff3baa78bbcc1d28bd5ff384.png)

如果嵌入标签没有为用户提供可用链接，我将无法使用它们。有没有人可以解决我当前的问题？如果我无法弄清楚这一点，那么每次我们需要进行微观更改时，我都必须运行我的批处理网站转换器。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:40:25.780

[http://php.about.com/od/advancedphp/p/html_php.htm](http://php.about.com/od/advancedphp/p/html_php.htm) ^这对我有用。接下来，我将确保没有 PHP 注入的可能性，或者 PHP 作为一种语言可能发生的任何事情。

# java - 无法插入 Java Hibernate MySQL 数据库中的表错误

> ID：13941686
> 
> 赞同：-2
> 
> 时间：2012-12-18T21:20:16.453
> 
> 标签：java, mysql, hibernate, pojo

在我的项目中，我得到“无法插入表格错误”，我在这里添加了必要的代码部分并希望最好:)

我的登录类

```
package DAO;

import org.hibernate.Hibernate;
import org.hibernate.Session;
import org.hibernate.SessionFactory;
import org.hibernate.Transaction;
import org.hibernate.cfg.Configuration;
import org.hibernate.cfg.AnnotationConfiguration;

import tables.Users;

public class LogIn {

    Session session;

    public boolean RegisterUsers(Object user) {

        if (SaveDatabase(user)) {
            return true;
        } else {
            return false;
        }

    }

    public boolean GetUsersWithId(Users user) {

        SessionFactory sessionfactory = new Configuration().configure()
                .buildSessionFactory();
        session = sessionfactory.openSession();

        user = (Users) session.get(Users.class, user.getUserId());
        session.close();
        if (user == null) {
            return false;
        } else {
            return true;
        }

    }

    public boolean SaveDatabase(Object object) {
        try {

            Session session = HibernateUtil.getSessionFactory().openSession();
            Transaction transaction = null;
            Long courseId = null;
            try {
                transaction = session.beginTransaction();
                session.save(object);
                courseId = (Long) session.save(object);
                transaction.commit();
            } catch (Exception e) {
                transaction.rollback();
                System.out.println(e.getMessage());
                return false;
            }
        } finally {
            session.close();
        }
        return true;
    }

} 
```

休眠实用程序

```
package DAO;
import org.hibernate.SessionFactory;
import org.hibernate.cfg.Configuration;

public class HibernateUtil {
private static final SessionFactory sessionFactory;
static {
    try {
        sessionFactory = new Configuration().configure()
                .buildSessionFactory();
    } catch (Throwable ex) {
        System.err.println("Initial SessionFactory creation failed." + ex);
        throw new ExceptionInInitializerError(ex);
    }
}

public static SessionFactory getSessionFactory() {
    return sessionFactory;
}
} 
```

这些代码的测试类

```
import DAO.LogIn;
import tables.Location;
import tables.Users;

public class Test {
public static void main(String[] args) {
    // Test RegisterUser and GetUsersWithId in here

    LogIn test = new LogIn();
    Users user = new Users();

    user.setUserEmail("email");
    user.setUserAdress("adres here");
    user.setUserFbId(3);
    test.RegisterUsers(user);

}
} 
```

![确切的错误](../Images/44a0731fa5ed5093e304cf4e658d24a7.png)

感谢帮助

编辑：删除配置。xml 文件和自动创建的用户类来清理混乱。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:35:08.647

您有一个名为的*字段*`session`，以及一个也名为的*局部变量*`session`。您打开一个 Hibernate 会话并将其分配给*局部变量*，但您关闭了*字段*而不是*局部变量*。

删除`session`字段。您不应该将 Hibernate Session 存储在这样的字段中。这没有意义。然后你会得到一个编译错误，你需要通过在更大的范围内（在 try 块之外）声明会话局部变量来修复它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-02T15:36:42.003

相同的字段名称在类级别的全局范围内，另一个在 SaveDatabase() 方法下的本地范围内。

解决方案：删除全局范围会话。

```
public class LogIn {
    Session session;    //Remove this field ..... 
```

# asp.net - 在中继器中使用 XPath 和条件语句

> ID：13941688
> 
> 赞同：0
> 
> 时间：2012-12-18T21:20:24.107
> 
> 标签：asp.net, vb.net

我正在尝试向中继器添加条件语句，但收到以下错误：

*   *Eval()、XPath() 和 Bind() 等数据绑定方法只能在数据绑定控件的上下文中使用。*

我尝试使用的代码如下：

```
<asp:Repeater ID="repLeftmenu" DataSourceID="xmlMenu" runat="server" EnableViewState="false">
  <HeaderTemplate>
    <ul class="leftMenu">
  </HeaderTemplate>
  <ItemTemplate>
    <li>
      <%  If XPath("@url").ToString = HttpContext.Current.Request.Url.AbsolutePath.ToString Then%>
        <a href="<%# XPath("@url") %>">
          <%# XPath("@title")%>
        </a>  
      <% Else %>
        <a href="<%# XPath("@url") %>">
          <%# XPath("@title")%>
        </a>              
      <%  End If%>
   </li>
 </ItemTemplate>
 <FooterTemplate>
   </ul>
 </FooterTemplate>
</asp:Repeater> 
```

我的语法有问题吗？

谢谢，垃圾

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:04:54.483

您在常规代码块中使用数据绑定表达式，这是不受支持的。数据绑定表达式应该出现在`<%# ... %>`块内。常规代码块如下所示：`<% ... %>`. （唯一的区别是`#`在块的开头。）

如果您需要在数据绑定块内使用条件，则需要使用表达式（简单地说：单行）。完成此操作的唯一方法是使用以下代码：

```
<%# If(XPath("Url").ToString = HttpContext.Current.Request.Url.AbsolutePath.ToString, "Display this when true", "Display this when false") %> 
```

当有条件地显示整个 HTML 块时，这很快就会变得笨拙。然后你可以做的是创建两个块并根据条件表达式设置每个块的可见性：

```
<span runat="server" visible='<%# XPath("Url").ToString = <%# If(XPath("Url").ToString = HttpContext.Current.Request.Url.AbsolutePath.ToString %>'>

  HTML that should be displayed when condition is true

</span>
<span runat="server" visible='<%# XPath("Url").ToString <> <%# If(XPath("Url").ToString = HttpContext.Current.Request.Url.AbsolutePath.ToString %>'>

  HTML that should be displayed when condition is false

</span> 
```

# leaflet - ^= 如何与 CartoCSS 匹配？

> ID：13941692
> 
> 赞同：0
> 
> 时间：2012-12-18T21:20:56.370
> 
> 标签：leaflet, openstreetmap, mapbox, cartography, cartocss

查看[以下 DBF 数据库](http://i47.tinypic.com/1085ppu.png)，我将如何定位“医院”类型？在 CSS3 中，您可以执行类似`*[attr^='hospital']`.

但是，我不知道如何使用 CartoCSS 做到这一点。我能做的最好的是：`#poi[zoom>=10][CATEGORY="Health care"]`，但许多与“医疗保健”相关的实体实际上是药房，我不想在上面做标记。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-02T22:46:59.077

为此，您可以使用正则表达式选择器，例如`#points[attr =~ "$hospital"]`.

一个更好的长期解决方案（因为正则表达式选择器倾向于创建许多过滤器组合）是在[Imposm](http://imposm.org/)的预处理中执行此操作。

# javascript - 删除 FB.ui 对话框上的十字按钮

> ID：13941698
> 
> 赞同：0
> 
> 时间：2012-12-18T21:21:37.023
> 
> 标签：javascript, facebook, facebook-javascript-sdk

我正在使用 facebook ios sdk，如何删除弹出窗口上的左上角十字按钮？我试图删除资源包中的图像，但即使没有十字架，您仍然可以单击左上角并取消对话框...

我想删除它的原因是因为当你点击那个十字架时，回调函数不会被调用......我只想用户点击“取消”或“分享”，这对我来说可以通过查看来轻松检测到到回调函数

![在此处输入图像描述](../Images/42771b600ea9180a7b1597ee207aaa90.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T04:46:05.923

在 iOS SDK 版本 3.1.1 中运行 Hackbook，单击左上角会导致在对话框委托上调用“dialogDidNotComplete”。你在处理这个选择器吗？

# javascript - 用javascript改变图片

> ID：13941703
> 
> 赞同：1
> 
> 时间：2012-12-18T21:21:50.740
> 
> 标签：javascript, jquery, html, forms

> **可能重复：**
> [使用 jquery 更改 img src](https://stackoverflow.com/questions/6568424/changing-the-img-src-with-jquery)

标题可能使这听起来很容易，而且可能确实如此。但是我，以我对 js 的了解非常少，发现它令人难以置信的伤脑筋......基本上我有图片设置在一个表格中（比如说 img1 img2 和 img3），我希望用户能够点击一个图像和它将更改为不同的，例如您单击 img1 并变为 img1a。等等，代码如下：

```
<form>
<p align="center">
<input type="checkbox" name="interest1" id="interest1" value="x">
<input type="checkbox" name="interest2" id="interest2" value="x">
<input type="checkbox" name="interest3" id="interest3" value="x"></p>   
<p align="center">
<label for="interest1" id="label-interest1"><img src="/images/img1.jpg" width="781" height="800" /></label>
<label for="interest2" id="label-interest2"><img src="/images/img2.jpg" width="781" height="800" /></label>
<label for="interest3" id="label-interest3"><img src="/images/img3.jpg" width="781" height="800" /></label></P><!-- code making checkbox be an image-->
</form> 
```

当前有复选框，但是这些将被隐藏，因此我需要在单击时更改图像以向用户显示它实际上已被选中，有什么想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:27:29.190

在图像标签中添加一个 onclick 事件并在那里添加 javascript 以更改图像源。

```
<script type="text/javascript">
function func()
{
    var img1= document.getElementById("img1");

    if(img1.name == "on")
    {
        img1.src = "/images/" + "img1a.jpg";
        img1.name = "off";
    }
    else
    {
        img1.src = "/images/" + "img1.jpg";
        img1.name = "on";
    }
}
</script>

<img src="/images/img1.jpg" width="781" height="800" onclick="func()" id="img1" name="on" /> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:31:48.637

您不一定需要使用另一个图像，您可以区分现有图像。

使用 CSS 类：

```
<head>
    <style>
        .selected {
            outline: solid 2px blue;
        }
    </style>
</head>
<body>
    <img class="selected" src="http://bugzilla.mozilla.org/extensions/BMO/web/images/mozchomp.gif" />
</body> 
```

使用 javascript，将 className 更改为“selected”以获得突出显示效果或更改为“”（无，空）以取消选择。

（或使用内联 css 样式属性`style="outline: solid 2px blue"`）

# javascript - 按下箭头时在选择时触发jQuery更改事件

> ID：13941707
> 
> 赞同：3
> 
> 时间：2012-12-18T21:22:13.770
> 
> 标签：javascript, jquery

我在很多地方都看到 jQuery 在选择上的更改事件只会在模糊或鼠标单击时触发，但是当我尝试它时，该事件也会在每次按下箭头键时触发。当使用箭头选择选项时，我试图让 change 事件不触发。例如：

```
<select size="4" id="more" name="more" required="required">
    <option value="0">No</option>
    <option value="1">Yes</option>
    <option value="2">Maybe</option>
    <option value="3">No clue</option>
</select>

$('#more').on('change', function(event){
    alert('hi');
});​ 
```

这个小提琴演示了在以下情况下触发的事件：http: [//jsfiddle.net/McWatt/x5cTr/7/](http://jsfiddle.net/McWatt/x5cTr/7/)

根据 jQuery change() 页面，如果我选择选项卡，然后使用箭头选择一个选项，则更改事件不应该触发，直到选择失去焦点（至少我是这样阅读它的）。实际上，我看到每次按下箭头键都会触发更改事件。

[http://api.jquery.com/change/](http://api.jquery.com/change/)

> 对于选择框、复选框和单选按钮，当用户使用鼠标进行选择时会立即触发该事件，但对于其他元素类型，该事件会延迟到元素失去焦点为止。

这种行为是否发生了变化，还是我不了解该功能？

更新：我误读了 jQuery 文档，尽管它们可能更清楚。我已经接受了导致我意识到这一点的答案。对于我的问题的实际解决方案，如果使用箭头，我将 keydown 事件绑定到将数据属性设置为 false 的选择。然后在更改绑定中，我设置了一个条件，如果数据属性为真，则仅在更改时执行代码。这不是最好的解决方案，因为如果使用箭头，它会有效地终止更改回调代码，但由于有另一种触发功能的方法（通过按钮），我可以接受这个功能。

Update2：这是一个工作小提琴：http: [//jsfiddle.net/McWatt/BR8QQ/](http://jsfiddle.net/McWatt/BR8QQ/)

```
// prevent change event being fired on arrow keys
$('#more').data('activation', 'activated').bind({
    keydown: function(event) {
        if(event.which === 38 || event.which === 40){
            $(this).data('activation', 'paused');
        }
    },
    click: function(event) {
        if($(this).data('activation') === 'paused'){
            $(this).data('activation', 'activated');
            $(this).trigger('change');
        }
    },
    change: function(event) {    
        if($(this).data('activation') === 'activated'){
            var time = new Date();
            $('#changed').text(event.type + ": " + time.getTime());
        }
    }
}); 
```

​</p>

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:25:06.670

好像不太准确 据我所知，这与原版`change`事件没有什么不同。

基本上，每当基于文本的输入在其值更改后失去焦点时，它都会触发该事件。每当单击复选框（或在聚焦时使用空格键切换）时，它都会触发事件。Whenever a radio button is selected (by clicking, spacebar, arrows keys...) it fires the event. 每当更改选择框（通过选择，箭头键...）时，它也会触发事件。

jQuery 在这方面与原版 JS 没有什么不同。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:31:52.010

也许您也可以在那里添加点击检查

```
$('#more').change(function(event){
    $(this).click(function(event){
    var time = new Date();
    $('#changed').text(event.type + ": " + time.getTime());
    });
 });​ 
```

[http://jsfiddle.net/x5cTr/13/](http://jsfiddle.net/x5cTr/13/)

# ckeditor - CKEditor“发送到服务器”按钮不可见

> ID：13941708
> 
> 赞同：0
> 
> 时间：2012-12-18T21:22:19.210
> 
> 标签：ckeditor

使用 CKEditor 遇到奇怪的行为。我已经设置好所有东西，我可以上传图片了。但我唯一的问题是我在上传表单中看不到“发送到服务器”按钮。我知道它在那里，因为如果我将鼠标悬停在它应该在的区域上，替代信息会显示为“将其发送到服务器”。此外，如果我按下该区域，它将上传照片：

![](../Images/45bf242e1941b1aa7aa8424ed4a89358.png)

除了包含上传脚本外，我没有编辑任何 CSS 文件或篡改代码。

`image.js`文件内容如下：

```
{
    id: 'Upload',
    filebrowser: 'uploadButton',
    label: editor.lang.image.upload,
    elements: [
        {
        type: 'file',
        id: 'upload',
        label: editor.lang.image.btnUpload,
        style: 'height:40px',
        size: 38
    },
        {
        type: 'fileButton',
        id: 'uploadButton',
        filebrowser: 'info:txtUrl',
        label: editor.lang.image.btnUpload,
        'for': [ 'Upload', 'upload' ]
        }
    ]
} 
```

文件输入显示但不显示按钮。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:37:47.413

结果是我使用的自定义皮肤不包含所有必要的类。

# objective-c - 如果页面加载太快而无法首先显示，我如何确定我的 UIActivityIndi catorView 是否正常工作？

> ID：13941709
> 
> 赞同：0
> 
> 时间：2012-12-18T21:22:22.303
> 
> 标签：objective-c, ios, uiwebview, uiactivityindicatorview

我设置了一个委托方法，它`UIActivityIndicatorView`在 a`UIWebView`开始加载时开始为 a 设置动画，并在`UIWebView`停止加载时停止为它设置动画。NSLogging 显示两个委托方法都被调用（即，`webViewDidStartLoading`和`webViewDidFinishLoading`）。

```
- (void)webViewDidStartLoad:(UIWebView *)webView{
//start animating
[self.indicator startAnimating];
}

-(void)webViewDidFinishLoad:(UIWebView *)webView{
//finish animating
[self.indicator stopAnimating];
} 
```

问题是页面在`UIActivityIndicatorView`显示之前完成加载。这意味着要么 a) 一切正常并且我的连接速度足够快以至于`UIActivityIndicatorView`不需要显示，要么 b) 并非一切正常。

但是我怎么知道它是a）还是b）？有没有办法人为地减慢我的连接速度？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:23:51.443

通过慢速代理隧道传输流量，因此您将有时间查看指示器是否显示。

一种方法是安装具有节流功能的[Charles Proxy 。](http://www.charlesproxy.com/)（并且对于其他 http-network 调试也非常方便）。

Windows 上的等效工具是[Fiddler](http://fiddler2.com/fiddler2/)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:26:04.623

在我的应用程序中，加载完成后我根本没有关闭/停止活动指示器，这表明它正在工作，然后我返回并停止。因此，如果它正在替换一个按钮，它仍然会显示，或者如果它在警报视图中，它仍然会出现在屏幕上。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T21:30:21.963

我会注释掉您对 stopAnimating 的调用，并查看您的活动指示器视图是否仍在旋转。如果是，那么您知道您的请求非常快。

Or change the URL to load a webpage that you know takes a long time to load and see if you notice any difference.

# api - 如何使用 SoundManager2 从 SoundCloud 流式传输，并进行可视化？

> ID：13941711
> 
> 赞同：1
> 
> 时间：2012-12-18T21:22:33.767
> 
> 标签：api, soundcloud, soundmanager2

SoundManager2 出现数据错误，我无法可视化任何内容？

或者

我无法访问歌曲，权限被拒绝？

或者

我第一次播放时它可以工作，但是如果我暂停它并再次播放，我会收到数据错误？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:22:33.767

这最近已得到修复，部分原因是所需文件的一半在那里。现在它已修复，但它仍然可能无法立即工作。

显而易见的第一步是您使用 api 获取轨道 stream_url，它看起来像`http://api.soundcloud.com/tracks/69322564/stream?client_id=CLIENT_ID`

如果你在 SoundCloud 中使用它作为媒体 url，你会发现你按下了播放，如果你有可视化，它们就可以工作，一切都很好。但是，如果您现在暂停曲目，然后再次按播放，您将收到数据错误，元数据将不再可访问，并且您的可视化将中断。这是因为`api.soundcloud.com`有一个跨域文件，当你访问它时，你会得到一个 3XX 重定向到`ec-media.soundcloud.com`. 这个站点现在也有一个 crossdomain.xml 文件，但是讨厌的 3XX 重定向破坏了这两个权限，所以你遇到了一个错误。

答案是您首先在 soundmanager2 之外进行重定向跳跃，这样就没有重定向会破坏它。例如在 Python 中：

```
import urllib2
starturl = 'http://api.soundcloud.com/tracks/69322564/stream?client_id=CLIENT_ID'
res = urllib2.urlopen(starturl)
finalurl = res.geturl()
print finalurl 
```

这可能更优雅，但它会打印 api 重定向到的 url。这个网址看起来像`http://ec-media.soundcloud.com/2j0lNF81jv9m.128.mp3?LONG_STRING&AWSAccessKeyId=ACCESS_KEY&Expires=1355864871&Signature=SIGNATURE`

这个域有crossdomain.xml文件，由于没有重定向，所以一切顺利，数据访问，一切顺利。

“我这样做了，它有效，但现在它说该文件被禁止”

现在我们提请您注意之前的 url，特别是`&Expires=1355864871`. 您被重定向到的文件不是永久的，因此您每次都需要抓取它。对我来说这很容易，我在 django 中工作，所以我可以简单地在我的视图脚本中运行上面的 python。您必须找到一种方法在您选择的代码中实现这一点。（也应该在 javascript 中工作）。

完成所有这些之后，您应该可以随意暂停和播放，并检索波形数据、EQ 数据和峰值数据。有了这些东西，就可以做一些有趣的事情了。希望这有帮助。

# java - 在 Android 上创建了一个简单的计时器，但没有按预期工作

> ID：13941714
> 
> 赞同：3
> 
> 时间：2012-12-18T21:22:44.623
> 
> 标签：java, android, multithreading, handler

我正在尝试在我的应用程序上显示一个计时器，其中一个线程计算经过的时间，一个处理程序来修改视图。

我知道Android不允许UI Thread修改视图的其他线程，所以我使用Handler来做到这一点。

但是好像没有效果，因为我还有“ **android.view.ViewRoot$CalledFromWrongThreadException: Only the original thread that created a view hierarchy can touch its views.** ”

我该怎么办 ？

（哦，如果这可能有帮助，代码如下）

```
package com.hangin.arround.emergency;

import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.Calendar;

import android.annotation.SuppressLint;
import android.os.Bundle;
import android.os.Handler;
import android.os.Message;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.TextView;

import com.actionbarsherlock.app.ActionBar;
import com.actionbarsherlock.app.SherlockActivity;

public class MainActivity extends SherlockActivity {

    private static final String TAG = "MainActivity";

    private TextView elapsedTime;

    private Button startButton;
    private Button stopButton;

    private boolean shouldContinue = false;
    private Handler mHandler;
    private Runnable runnable;

    private static final int MESSAGE_ELAPSED_TIME = 1;

    @Override
    protected void onCreate(Bundle savedInstanceState) {

        // Creating the action bar, initializing my views and stuff

        // Creating the Handler
        mHandler = new Handler() {
            @SuppressLint("SimpleDateFormat")
            @Override
            public void handleMessage(Message msg){
                super.handleMessage(msg);
                switch(msg.what) {
                    case MESSAGE_ELAPSED_TIME :
                        // Converting from milliseconds to a String
                        DateFormat formatter = new SimpleDateFormat("hh:mm:ss.SSS");
                        Calendar calendar = Calendar.getInstance();

                        calendar.setTimeInMillis(msg.arg1);
                        String elapsedTimeString = formatter.format(calendar.getTime());

                        elapsedTime.setText(elapsedTimeString);
                        break;
                    default:
                        break;
                }
            }
        };

        // Creating the Runnable
        runnable = new Runnable(){

            @Override
            public void run() {
                int startTime, actualTime;
                startTime = (int) System.currentTimeMillis();
                Log.d(TAG, "startTime = " + startTime);

                while(shouldContinue) {
                    // Calcul du temps écoulé
                    actualTime = (int)System.currentTimeMillis() - startTime;
                    Log.d(TAG, "actualTime = " + actualTime);

                    // Creating the message sent to the Handler
                    Message elapsedTimeMessage = new Message();
                    elapsedTimeMessage.what = MESSAGE_ELAPSED_TIME;
                    elapsedTimeMessage.arg1 = (int) actualTime;

                    // Sending the message
                    mHandler.handleMessage(elapsedTimeMessage);
                }
            }

        };

        // Adding the OnClickListeners on startButton and stopButton
        startButton.setOnClickListener(new OnClickListener(){
            @Override
            public void onClick(View v) {

                // Launching Thread 
                (new Thread(runnable)).start();
                shouldContinue = true;
            }
        });

        stopButton.setOnClickListener(new OnClickListener(){
            @Override
            public void onClick(View v) {

                // Stopping the thread
                shouldContinue = false;
            }
        });
    }   
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:26:27.910

改变

```
Message elapsedTimeMessage = new Message();
elapsedTimeMessage.what = MESSAGE_ELAPSED_TIME;
elapsedTimeMessage.arg1 = (int) actualTime;
// Sending the message
mHandler.handleMessage(elapsedTimeMessage); 
```

到

```
Message.obtain(mHandler, MESSAGE_ELAPSED_TIME, (int) actualTime, 0).sendToTarget(); 
```

从 API 文档来看，它似乎`handleMessage`是在处理过程中稍后调用的东西，不应直接调用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:28:51.300

为了在创建处理程序的线程上处理消息，您需要调用[sendMessage](http://developer.android.com/reference/android/os/Handler.html#sendMessage%28android.os.Message%29)

你应该`mHandler.handleMessage(elapsedTimeMessage);` 改变`mHandler.sendMessage(elapsedTimeMessage);`

# java - 为什么这个泛型 java 方法接受两个不同类型的对象？

> ID：13941716
> 
> 赞同：7
> 
> 时间：2012-12-18T21:22:51.250
> 
> 标签：java, generics, methods, parameters

此方法应采用两个**相同类型**的对象并随机返回其中一个对象：

```
public static <T> T random(T o1, T o2)
{
   return Math.random() < 0.5 ? o1 : o2;
} 
```

现在，为什么编译器接受两个具有不同类型的参数？

```
random("string1", new Integer(10)); // Compiles without errors 
```

**编辑：** 现在我知道这两个参数都被隐式向上转换，我想知道为什么编译器**在**调用以下方法时会抱怨：

```
public static <T> List<T> randomList(List<T> l1, List<T> l2) {
        return Math.random() < 0.5 ? l1 : l2;
    } 
```

称呼：

```
randomList(new ArrayList<String>(), new ArrayList<Integer>()); // Does not Compile 
```

如果这些 ArrayList 参数也被向上转换为 Object，为什么这次它会给我一个错误？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-12-18T21:24:45.040

**`T`被推断为`Object`，并且两个参数都被隐式地向上转换。**

因此代码等价于：

```
Main.<Object>random((Object)"string1", (Object)new Integer(10)); 
```

可能更令人惊讶的是以下编译：

```
random("string1", 10); 
```

第二个参数被自动装箱为`Integer`，然后两个参数都被向上转换为`Object`。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-12-18T21:39:48.160

`T`被推断为 and 的常见超类型`String`，`Integer`即

```
Object & Serializable & Comparable<? extends Object & Serializable & Comparable<? extends ... ... 
```

好吧，没有人需要关心这个。

您可以在参数类型上添加更多约束

```
public static <T1,T2 extends T1> T1 random(T1 o1, T2 o2) 
```

在您的列表示例中，您需要通配符才能获得类似的效果

```
public static <T> List<? extends T> randomList(
                                    List<? extends T> l1, List<? extends T> l2) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-12-19T02:26:21.763

> 知道我知道这两个参数都被隐式向上转换，我想知道为什么编译器在调用以下方法时会抱怨：

因为即使 when`A`是 的子类型`B`，`List<A>`也不是`List<B>`if A 和 B 不同的子类型。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T21:27:32.527

因为您没有以安全、通用的方式调用它。尝试

```
MyClass.<String>random("string1", new Integer(10)); 
```

你会得到一个编译错误。

或者让编译器推断类型，你也应该得到一个编译错误：

```
String s = random("string1", new Integer(10)); 
```

# c# - 根据应用位置更改连接字符串

> ID：13941717
> 
> 赞同：0
> 
> 时间：2012-12-18T21:23:06.513
> 
> 标签：c#

如何根据它是在本地调试还是在服务器上进行调试，将连接字符串更改为我的实体框架数据库。我想在服务器上使用数据库的内部 IP 地址以提高性能。我希望每次发布网站时都不必更改连接字符串。我正在使用 Visual Studo 11。我没有尝试过任何东西，因为我不确定选项是什么。我一直在部署到文件系统，但我将在不久的将来进行 Web 部署。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:30:43.167

您可以使用 web.config 转换来指定在每种情况下应使用的转换。有关更多信息，请参阅此博客文章。

[http://blogs.msdn.com/b/webdev/archive/2009/05/04/web-deployment-web-config-transformation.aspx](http://blogs.msdn.com/b/webdev/archive/2009/05/04/web-deployment-web-config-transformation.aspx)

基本上，您将在 web.debug.config 中指定调试连接字符串，在 web.release.config 中指定您的版本。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:30:23.833

听起来您需要[Web.config 转换](http://msdn.microsoft.com/en-us/library/dd465318.aspx)。

有了它，您可以根据构建配置自动替换配置文件中的值。如果需要，为服务器创建单独的构建配置，或者只使用 Release。

# spring - 如何限制使用 JAXB 显示 xml

> ID：13941719
> 
> 赞同：1
> 
> 时间：2012-12-18T21:23:24.543
> 
> 标签：spring, xml-parsing, jaxb, annotations

使用 Spring，我正在构建一个 RESTful Web 服务并拥有一个正在编组的对象 (Jaxb2Marshaller)，这与具有 @OneToMany 和 @ManyToOne 注释的 MYSQL 数据库相关联。如何不显示返回的子元素？对此有一些注释吗？

```
<?xml version='1.0' encoding='UTF-8'?>
<entry xmlns="http://www.w3.org/2005/Atom">
  <title type="text">UNUSED</title>
  <id></id>
  <updated>2012-12-18T20:54:47.961Z</updated>
  <content type="application/xml">
    <paymentTokenWrapper xmlns="http://www.oclc.org/SampleService">
      <createDate>2012-12-18 15:54:47.848-0500</createDate>
      <expirationTime>2012-12-18 16:14:47.848-0500</expirationTime>
      <payee>
        <id>32</id>
        <name>Vendor Center</name>
        <symbol>CCC</symbol>
        <paymentTokenPayee>41</paymentTokenPayee>
        <paymentTokenPayee>41</paymentTokenPayee>
        <paymentTokenPayee>41</paymentTokenPayee>
        <paymentTokenPayee>41</paymentTokenPayee>
        <paymentTokenPayee>41</paymentTokenPayee>
      </payee>
      <payer>
        <id>41</id>
        <name>OCLC ASIA PACIFIC, JAPAN1</name>
        <symbol>AAJ1</symbol>
        <paymentTokenPayer>41</paymentTokenPayer>
        <paymentTokenPayer>41</paymentTokenPayer>
     </payer>
      <paymentTokenStatus>UNUSED</paymentTokenStatus>
      <principalIDNS>43453241</principalIDNS>
      <spendingLimit>100.00</spendingLimit>
      <tokenUUID>VxsvpDZb6o3SMWz0ZY3OMXaz0DzbKtKXnAN0FkPkTc8MfMSVXy4h0nKf0c9Rldf7V0VzB6MPiWKeHDhu</tokenUUID>
      <updateDate>2012-12-18 15:54:47.848-0500</updateDate>
      <userPrincipalId>754645341</userPrincipalId>
    </paymentTokenWrapper>
  </content>
</entry> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:28:41.180

您可以使用`@XmlTransient`注释来防止字段/属性被编组为 XML。或者您可以`@XmlAccessorType(XmlAccessType.FIELD)`在类上指定，并且只有带注释的字段/属性将编组为 XML。

**了解更多信息**

*   [http://blog.bdoughan.com/2012/04/jaxb-and-unmapped-properties.html](http://blog.bdoughan.com/2012/04/jaxb-and-unmapped-properties.html)

# algorithm - 这个算法的运行时间复杂度是多少

> ID：13941720
> 
> 赞同：1
> 
> 时间：2012-12-18T21:23:29.963
> 
> 标签：algorithm, math, complexity-theory, big-o

这个算法的时间复杂度是多少：

```
sum = 0
i = 1

while (i < n) {

    for j = 1 to i {
        sum = sum + 1
    }

    i = i*2;
}

return sum 
```

我知道`while`循环是`O(logn)`，但是循环的复杂性是`for`多少？是`O(n)`还是`O(logn)`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T21:27:38.540

对此进行分析的一种方法是计算内部循环的迭代次数。在第一次迭代中，循环运行一次。在第二次迭代中，它运行两次。它在第三次迭代中运行四次，在第四次迭代中运行八次，更一般地在第^k次迭代中运行 2k 次。这意味着内部循环的迭代次数由下式给出

> 1 + 2 + 4 + 8 + ... + 2 ^r = 2 ^(r + 1) - 1

其中 r 是内部循环运行的次数。正如您所指出的，r 大约是 log n，这意味着这个总和（大约）

> 2 ^(log n + 1) - 1 = 2(2 ^(log n) ) - 1 = 2n - 1

因此，内部循环在 O(n) 中的所有迭代中完成的总工作量。由于程序在运行外循环时总共做了 O(log n) 的工作，所以这个算法的总运行时间是 O(n + log n) = O(n)。请注意，我们不会将这些项相乘，因为 O(log n) 项是纯粹在维护外部循环中完成的工作总量，而 O(n) 项是纯粹由内循环。

希望这可以帮助！

# c - 使用 cstdio 读取键盘输入

> ID：13941727
> 
> 赞同：0
> 
> 时间：2012-12-18T21:23:58.283
> 
> 标签：c, string, integer, stdio

以下 C 代码有什么问题？（更新）

```
int nfds = 0;
char c[2] = " ";
char ans[2] = " ";

printf("Test p or s [p,s]: p? ");
ans[0] = (char)getchar();
if (ans[0] != '\n')
  {
    ans[1] = '\0';
    printf("ans = %s\n", ans);
  }
else
  ans[0] = '\0';

/* FIXME: answering 's' -> nfds is never read */
printf ("Choose [0, 1, 2, 3]: 0? ");
c[0] = (char)getchar();
if (c[0] != '\n') 
  {
    c[1] = '\0';
    nfds = strtol(c, NULL, 10);
  }
else
  c[0] = '\0'
printf( "nfds=%d\n", nfds); 
```

回答“return”有效，但回答“s+return”不会在 print("Choose...") 处停止并继续，就好像“return”已经给出一样？

也许更好的解决方案是：首先读取一个 char/string in `ans`，默认值：`"return"`in char/string='s'/"s" 询问下一个问题以读取 integer `nfds`，默认值：`"return"`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T21:27:08.340

第一的：

`c[2] = '\n';`

您的两个元素数组中没有`c[2]`。对`ans`.

第二：

```
c[1] = getchar();
...
nfds = atoi(c); 
```

您的数组有两个元素，并且一个字符串必须以空值结尾。通过覆盖`c[1]`然后`c`数组不能保存一个字符串。

还要注意[`getchar`](http://en.cppreference.com/w/c/io/getchar)返回 an`int`而不是 a `char`，如果您必须将其返回值与 进行比较，这一点很重要`EOF`。

函数[`atoi`](http://en.cppreference.com/w/c/string/byte/atoi)也不能做错误检查，你应该使用[`strtol`](http://en.cppreference.com/w/c/string/byte/strtol).

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:53:25.167

为了建立 ouah 所说的[getchar()](http://www.cplusplus.com/reference/cstdio/getchar/)返回一个 int 值，该值将是按下的任何键的[十进制值。](http://asciitable.com "十进制")因此，您应该将用户的击键捕获为 int，然后将其[类型转换](http://www.cprogramming.com/tutorial/c/lesson11.html)为 char 并将其插入到您的 char 数组中。

```
int key_stroke;
char array[size]

key_stroke = getchar();
array[1] = (char)key_stroke; 
```

如果我错了，请纠正我，但您正在尝试处理击键直到按下回车键？使用以下代码可以更简单、更干净地完成。

```
int key_stroke;
char array[size]

for(i = 0; ((char)key_stroke != '\n') && (i < size); i++)
{
  key_stroke = getchar();
  array[i] = (char)key_stroke;
} 
```

用户按下的键将被添加到 array[] 直到按下回车键或直到数组空间不足。'i' 将随着每次旋转而增加，因此您的索引将自动更新。

# php - 参数注入嵌入式 PHP 脚本

> ID：13941728
> 
> 赞同：1
> 
> 时间：2012-12-18T21:23:59.387
> 
> 标签：php

如何在对象嵌入期间将查询参数注入到作为对象输入处理的 PHP 脚本中？例如，Shockwave 播放器提供了一个由脚本生成的音乐播放列表，如代码示例中所示：

```
<object type="application/x-shockwave-flash" data="swf_player.swf?sort=track&skin_url=player/skin.xml&playlist_url=music/Playlist_Generator.php"> 
```

其中 swf_player.swf 识别查询参数“skin_url”和“playlist_url”，而 Playlist_Generator.php 识别参数“sort”。播放列表生成器脚本识别指定目录中的 .mp3 曲目并解构它们以获取 ID3 信息标签（艺术家、标题、曲目编号、专辑等）。然后它会发出一个播放列表，该列表主要由一个带有相关曲目信息的曲目列表组成，该曲目列表指向 .mp3 目录，swf_player 可以在该目录中找到这些曲目。

当直接在浏览器的地址栏上调用生成器时，Playlist_Generator.php 从查询字符串中提取排序参数，如

```
http://localhost/music/Playlist_Generator.php?sort=track 
```

通过

```
$sort_type = $_REQUEST['sort'];
$sort_type = !empty($sort_type) ? $sort_type : 'title'; 
```

sort 参数表示用户对播放列表中曲目排序的偏好。直接脚本调用是播放列表生成器正在开发时使用的设置，因为它有助于丰富的调试信息。但是，一旦生成器与播放器“内联”使用，如上所述，查询参数对它不可用。在上面显示的嵌入样本中，播放列表生成器的 PHP 代码在查询扩展期间被处理，因此查询参数，特别是“排序”，对其不可用。

我应该非常感谢任何可能为 PHP 脚本设计了一种在“动态”处理时获取外部信息的方法的人。虽然上述问题已被描述为无法访问查询参数，但可能存在替代方案，脚本可以获取外部信息。欢迎所有问题，评论和特别建议！

在此先感谢所有做出贡献的人。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-27T23:57:14.783

XSPF_Playlist_Generator.php 的服务器端包含（SSI）创建了一个播放列表文件，可以很好地完成这项工作。（可能需要在服务器上启用 SSI。请参阅[http://httpd.apache.org/docs/current/howto/ssi.html](http://httpd.apache.org/docs/current/howto/ssi.html)和其他 SSI 站点，其中搜索短语“服务器端包含”会引发配置和语法参考.) 注意使用 PHP 将从浏览器的地址行获得的查询参数 sort 的值插入到附加到 php 文件 url 的查询字符串中：

```
<!--#include virtual='music/XSPF_Playlist_Generator.php?sort=<?php echo $_GET['sort'];?>' --> 
```

除了发出的 XSPF 播放列表之外，播放列表生成器还能够将播放列表写入文件。此功能已启用，然后播放列表文件读入 SWF 播放器，如下所示：

```
<object type="application/x-shockwave-flash" data="swf_player.swf?skin_url=player/skin.xml&playlist_url=music/XSPF_Playlist.xspf"> 
```

...创建（遗憾的是）一个两步过程。中间步骤似乎是必要的，因为我还没有发现将浏览器地址栏中的查询参数“排序”的值直接注入 php 文件的方法。对于那些好奇的人，播放器可以识别参数 playlist_url 的两种类型的值：一个 .php 文件，它“动态”生成一个播放列表（注入其中将是一步过程），以及一个（准）静态.xspf 文件可以在页面刷新时重新生成（繁琐的中间第二步）。

该解决方案已在 IE、Opera、Safari、Firefox 和 Chrome 上成功测试。请注意，Apache、nginx、lighttpd 和 IIS 是支持 SSI 语言的四大 Web 服务器。

感谢所有做出贡献的人。任何可能无法跟进并想要完整源代码的人，请将您的请求通过电子邮件发送给我：kanone@rogers.com。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:35:05.083

我相信您的问题的答案是：

```
<?php
    $sort = isset($_GET["sort"]) ? $_GET["sort"] : "title"

?>
<object type="application/x-shockwave-flash" data="swf_player.swf?sort=<?php echo $sort ?>&skin_url=player/skin.xml&playlist_url=music/Playlist_Generator.php"> 
```

编辑：再三考虑，我怀疑这是您正在寻找的答案。你的意思是“生成器是内联使用的”？

# c# - c#的javascript函数的序列化

> ID：13941731
> 
> 赞同：0
> 
> 时间：2012-12-18T21:24:01.617
> 
> 标签：c#, javascript, json, javascriptserializer

在我的 c# 类中，我有以下类：

```
public class Product
{
    public int product_id;
    public int quantity;
    public string book_cost;
} 
```

如果我用它序列化它，`JavaScriptSerializer`那么我会回来

```
{"product_id":0,"quantity":0,"book_cost":"hello"} 
```

设置值后。

那是c#，但我怎么能序列化一个javascript函数来匹配这个呢？

我想将 js 函数解析为 ac# 类

示例....如果我在 c# 中有一个类并且我想将它发送到其他一些网络服务器，我可以序列化该对象并使用它将其转换为 JSON

```
var serializer = new JavaScriptSerializer();
serializer.Serialize(new Product());

public class Product
{
   public int product_id = 0;
   public int quantity = 0;
   public string book_cost = "hello";
} 
```

然后在另一边我可以有这个：

```
var serializer = new JavaScriptSerializer();
Product p = serializer.Deserialize<Product>(products);
Console.WriteLine(p.product_id);

public class Product
{
   public int product_id;
   public int quantity;
   public string book_cost;
} 
```

它会打印出 0，因为我使用来自另一个类的这些值创建了一个新产品类，但是我希望一侧是 js（发送端），另一端是 c#（接收端）

这是更多示例：

js侧...

我有这个功能，我已经将值设置为这个，但我会在运行时更改它们。

```
function Product(){
    this.product_id = 0;
    this.quantity = 0;
    this.book_cost = "hello";   
} 
```

然后我想从中生成我想生成

```
{"product_id":0,"quantity":0,"book_cost":"hello"} 
```

然后在另一边，我想填充上面的 Product 类。我只会使用字符串、整数和日期对象。如果我在 c# 中序列化一个 DateTime 对象，结果是

```
{"date":"\/Date(-62135596800000)\/"} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:10:44.540

[您可以使用JSON.stringify](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/JSON/stringify)方法序列化 JSON 中的对象。就像是：

```
function Product() {
    this.product_id = 0;
    this.quantity = 0;
    this.book_cost = "hello";   
}

var p = new Product();
p.quantity = 5;
var json = JSON.stringify(p); 
```

[例子](http://jsfiddle.net/NsdRt/)

不要担心日期格式。任何好的序列化器都将能够识别日期的各种表示。无需手动*重新格式化*任何内容。

# python - wxpython Gridsizer 不适合面板

> ID：13941735
> 
> 赞同：2
> 
> 时间：2012-12-18T21:24:28.543
> 
> 标签：python, grid, wxpython, panel, sizer

我正在开发一个 wxpython GUI。我有三个面板（左侧两个水平拆分，右侧一个与另外两个垂直拆分——想想左半边的两个正方形和右半边的高矩形）。我正在尝试在面板 3 中安装 Gridsizer（图像中的 P3）。我似乎无法让网格面板“填充”整个面板 3。相反，它们会捕捉到顶部和底部。理想情况下，我希望 10 个小面板（2 行，5 列）调整大小并很好地填充面板 3（大小相同且大到足以看到每个面板）。我究竟做错了什么？谢谢！

**** 编辑 **** 我已将代码更改为如下所示：

```
 sizer_31 = wx.BoxSizer(wx.VERTICAL)
        gs = wx.GridSizer(0,4,7,7)

        for i in self.Panel_Others.keys():
            gs.Add(self.Panel_Others[i],0,wx.ALIGN_CENTER|wx.ALL,5)

        sizer_31.Add(gs,0,wx.ALIGN_CENTER|wx.ALL,5)
        self.OtherTeams.SetSizer(sizer_31)
        sizer_31.SetSizeHints(self.OtherTeams) 
```

我的新面板 3 如下图所示。这是一些改进。但是，我希望各个面板（总共 10 个）扩展相同的数量，以便整个笔记本页面被相同大小的较小面板覆盖（想象一下日历的样子，每天都是一个面板）。

![在此处输入图像描述](../Images/472f83642d671375c21df74db2a4046e.png)

**** 结束编辑 ****

以下是我的原始代码：

注意： `self.OtherTeams`是 wx.Notebook 下的页面`self.Panel3`。`self.Panel_Others`是包含我正在显示的 wx.Panels 的字典（这会动态变化，所以这就是为什么我有它们的字典而不是指定它们的原因）。

```
 sizer_31 = wx.BoxSizer(wx.HORIZONTAL)
        gs = wx.GridSizer(2,5,5,5)

        for i in self.Panel_Others.keys():
            sizer_temp = wx.BoxSizer(wx.VERTICAL)
            sizer_temp.Add(self.Panel_Others[i],1,wx.EXPAND)
            gs.Add(sizer_temp,1,wx.EXPAND,0)

        sizer_31.Add(gs,0,wx.EXPAND)
        self.OtherTeams.SetSizer(sizer_31) 
```

![在此处输入图像描述](../Images/cb4d260f29931b9597d8e5cad815d4fc.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-21T06:06:18.077

这`wxPython 2.8`将导致页面左上角出现单一模糊。 `wxPython 2.9`当涉及到尺寸大小时，它会更聪明一些，这就是为什么它似乎有点工作。

首先，您在 a`GridSizer`内创建 a`BoxSizer`但不允许它动态扩展 ( `wx.EXPAND`)。其次，您将大小调整器设置为`wx.Notebook`而不是页面（面板），这会将整个布局向下移动并裁剪网格大小调整器中控件/面板的底行，或者将完全忽略，`2.8`从而将所有内容移动到左上角。

这应该可以解决问题：

```
sizer_31 = wx.BoxSizer(wx.VERTICAL) # page (panel) sizer for outer border
gs = wx.GridSizer(0,4,7,7) # content sizer

for i in self.Panel_Others.keys():
    gs.Add(self.Panel_Others[i],0,wx.EXPAND|wx.ALL,5) 
    # + wx.EXPAND: allow the content to fill the 'cells'
    #              (proportion is ignored here so it can be 0)
sizer_31.Add(gs,1,wx.EXPAND|wx.ALL,5) 
# + 1, wx.EXPAND: allow the grid to expand to the main sizer
#                 which in turn fits to the page
self.Panel3.SetSizer(sizer_31) # set the sizer to page, not the notebook 
```

**编辑**：以下示例演示如何在 wx.Notebook 页面中动态更新 wx.GridSizer 的内容：

```
import wx

class MyFrame(wx.Frame):
    def __init__(self):
        wx.Frame.__init__(self, None, title='wx.Notebook')
        # create a wx.Notebook
        book = wx.Notebook(self)
        # create a new page; wx.Notebook owns the page
        # therefore the notebook must be the parent window
        page = MyPage(parent=book)
        # add the page to the notebook:
        book.AddPage(page, 'Page 1')
        book.AddPage(MyPage(book),'Page 2')
        book.AddPage(MyPage(book),'Page 3')

class MyPage(wx.Panel):
    "a page for wx.Notebook"
    def __init__(self, parent):
        # NOTE: wxPython 2.9.4/winXP may create graphic 
        # artifacts when more than one page is added. This can
        # be avoided by creating the page with a size of (0,0).
        # the reason for this is: the page (here a panel) is
        # created with the default size and position (upper
        # left corner). Once the layout is applied, the page
        # is moved to the proper coordinates. However, the
        # wx.Notebook is not redrawn so it will leave a black
        # spot where the page was moved away from. Alternatively,
        # the frame or notebook can be Refresh()ed after the
        # frame is shown.
        wx.Panel.__init__(self, parent, size=(0,0))
        # create sizer to add a border
        pageSizer = wx.BoxSizer(wx.VERTICAL)
        # create a grid sizer for the content
        self.grid = wx.GridSizer(0, 4, 5, 5)
        # add the grid sizer to the page sizer:
        # to allow the grid to fill the entire page,
        # set proportion>0 and add the wx.EXPAND flag.
        # the border of 10 is the spacing between the
        # page and the cells of the grid
        pageSizer.Add(self.grid, 1, wx.EXPAND|wx.ALL, 10)
        # set the main sizer:
        self.SetSizer(pageSizer)
        # add content to the grid
        self.GenerateContent()
        # DEMO: click any white space on the page to 
        # generate new content
        self.Bind(wx.EVT_LEFT_DOWN, self.GenerateContent)

    def GenerateContent(self, event=None):
        "dynamically create page content"
        # remove all items from the grid and destroy them
        # NOTE: if you don't actually create new controls here,
        # but use a list of controls created elsewhere (like in
        # in your code), do not delete the items! Use:
        # deleteWindows=False instead.
        self.grid.Clear(deleteWindows=True)
        # generate new grid content
        for i in range(10):
            # the contents are owned by the page,
            # therefore the page must be the parent window:
            # NOTE: size=(0,0) here is not required but
            # eliminates a briefly shown graphic artifact
            cell = wx.Panel(self, size=(0,0))
            cell.SetBackgroundColour(self.NewColor())
            # add the content (cells) to the grid:
            # specify the wx.EXPAND flag to fit the
            # content to the grid cell
            self.grid.Add(cell, flag=wx.EXPAND)
        # DEMO: hint text
        self.grid.Add(wx.StaticText(self, label=
            'Click empty cell to update content ->'),
                      flag=wx.EXPAND)
        # recalculate the layout to move the new contents
        # of the grid sizer into place
        self.Layout()

    col = 0 # DEMO: coloring
    def NewColor(self):
        self.col = (self.col + 3) % 241
        return wx.Colour(0, self.col * 10 % 255, self.col % 255)

app = wx.App(False)
MyFrame().Show()
app.MainLoop() 
```

# php - PHP MySQL将一个字段的内容附加到另一个字段的内容

> ID：13941739
> 
> 赞同：-1
> 
> 时间：2012-12-18T21:24:33.290
> 
> 标签：php, mysql

我有一个 MySQL 表，其中包含字段`product_category`和`product_name`. 我想将 附加`product_category`到`product_name`特定的`product_category`.

我该怎么做呢？在输入数百条记录后，我意识到这`product_category`是`product_name`.

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:26:47.800

您可以使用[CONCAT_WS](http://dev.mysql.com/doc/refman/5.0/en/string-functions.html#function_concat-ws)连接字符串、跳过空值和分隔符，这可能是您的更新查询：

```
UPDATE your_table
SET product_name = CONCAT_WS(' ', product_category, product_name)
WHERE product_category = 'category' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:27:52.927

你会运行：

```
UPDATE `tablename` SET product_name = product_category.' '.product_name WHERE product_category = ? 
```

# python - 使用 Python 请求的 REST 发布

> ID：13941742
> 
> 赞同：10
> 
> 时间：2012-12-18T21:25:01.693
> 
> 标签：python, python-2.7, python-requests

为什么这个简单的代码不向我的服务发布数据：

```
import requests
import json

data = {"data" : "24.3"}
data_json = json.dumps(data)
response = requests.post(url, data=data_json)
print response.text 
```

我的服务是使用 WCF 开发的，如下所示：

```
 [OperationContract]
  [WebInvoke(Method = "POST", UriTemplate = "/test", ResponseFormat =    
      WebMessageFormat.Json,RequestFormat=WebMessageFormat.Json)]
  string test(string data ); 
```

注意：如果删除输入参数`data`一切正常，可能是什么问题。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-12-18T21:26:42.310

您需要设置内容类型标头：

```
data = {"data" : "24.3"}
data_json = json.dumps(data)
headers = {'Content-type': 'application/json'}

response = requests.post(url, data=data_json, headers=headers) 
```

如果我设置`url`为`http://httpbin.org/post`，该服务器会向我回显发布的内容：

```
>>> import json
>>> import requests
>>> import pprint
>>> url = 'http://httpbin.org/post'
>>> data = {"data" : "24.3"}
>>> data_json = json.dumps(data)
>>> headers = {'Content-type': 'application/json'}
>>> response = requests.post(url, data=data_json, headers=headers)
>>> pprint.pprint(response.json())
{u'args': {},
 u'data': u'{"data": "24.3"}',
 u'files': {},
 u'form': {},
 u'headers': {u'Accept': u'*/*',
              u'Accept-Encoding': u'gzip, deflate, compress',
              u'Connection': u'keep-alive',
              u'Content-Length': u'16',
              u'Content-Type': u'application/json',
              u'Host': u'httpbin.org',
              u'User-Agent': u'python-requests/1.0.3 CPython/2.6.8 Darwin/11.4.2'},
 u'json': {u'data': u'24.3'},
 u'origin': u'109.247.40.35',
 u'url': u'http://httpbin.org/post'}
>>> pprint.pprint(response.json()['json'])
{u'data': u'24.3'} 
```

如果您使用的是`requests`2.4.2 或更高版本，则可以将 JSON 编码留给库；它也会自动为您设置正确的 Content-Type 标头。将要作为 JSON 发送的数据传入`json`关键字参数：

```
data = {"data" : "24.3"}
response = requests.post(url, json=data) 
```

# eclipse - 带有所需插件的 Eclipse / STS

> ID：13941743
> 
> 赞同：0
> 
> 时间：2012-12-18T21:25:06.170
> 
> 标签：eclipse, sts-springsourcetoolsuite

我想在我的 Eclipse 安装上安装所有需要的插件，然后生成一个我可以分发给其他开发人员的 zip 或 exe，这样他们就不必重新安装插件。

我想知道是否有办法做到这一点。请倾诉你的想法和经验。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T06:41:21.627

您可以在您的机器上创建一个[镜像更新站点](https://stackoverflow.com/questions/6360424/how-to-create-an-eclipse-update-archive-from-an-online-update-site)作为存档文件并将其分发给开发人员。这样做的工作量非常大，但您的同事可以离线安装插件。

或者，您可以使用 File -> Export -> Install -> Installed plugins 导出已安装插件的*描述*，您的同事可以使用 File -> Import 下的相同菜单进行安装。这很容易做到，但您的同事之后需要在线，因为他们将从您使用的相同更新站点进行安装。

我建议从第二个选项开始。

# java - 使用 JAXB 和 Any 进行序列化

> ID：13941747
> 
> 赞同：12
> 
> 时间：2012-12-18T21:25:21.827
> 
> 标签：java, xsd, jaxb, axis2

我有一个定义以下类型的架构：

```
<xsd:complexType name="Payload">
   <xsd:sequence>
      <xsd:any namespace="##any" minOccurs="0" maxOccurs="unbounded" processContents="lax"/>
   </xsd:sequence>
</xsd:complexType> 
```

这会创建一个像这样的对象：

```
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "Payload", propOrder = {
    "any"
})
public class Payload {

    @XmlAnyElement(lax = true)
    protected List<Object> any;
} 
```

现在我尝试将另一个生成的 JAXB 对象添加到该 Payload，执行如下操作：

```
Class payloadClass = ...;
JAXBContext context = JAXBContext.newInstance( WrapperRequest.class, payloadClass);
...
marshaller.marshal( wrappedRequest ); 
```

但是我得到了一个可怕的异常，看起来它永远不会起作用，所以我决定先将有效负载对象序列化为 XML，然后将其作为字符串添加到有效负载中。

```
StringWriter writer = new StringWriter();
JAXBContext context = JAXBContext.newInstance( sdoRequest.getClass() );
Marshaller marshaller = context.createMarshaller();
marshaller.marshal(new JAXBElement(new QName("uri", sdoRequest.getClass().getSimpleName()), sdoRequest.getClass(), sdoRequest), writer);
payload.getAny().add( writer.toString() ); 
```

这会引发异常，说“java.lang.String”不包含@XmlRootElement。

那么 xs:any 将如何与 JAXB 一起使用呢？似乎什么都不想工作，因为 JAXB 将 Payload 转换为 Object，并且它不会序列化 Object 中的任何内容。这也都在 Axis2 内部，因此达到这一点非常具有挑战性。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2012-12-19T11:09:26.603

下面我将演示[**JAXB (JSR-222)**](http://jcp.org/en/jsr/detail?id=222)并`any`举例：

**有效载荷**

该`any`属性用 注释`@XmlAnyElement(lax=true)`。这意味着对于该属性，如果元素通过`@XmlRootElement`或与类关联，`@XmlElementDecl`则将使用相应对象的实例来填充该属性，否则该元素将被设置为`org.w3c.dom.Element`.

```
package forum13941747;

import java.util.List;
import javax.xml.bind.annotation.*;

@XmlRootElement
@XmlAccessorType(XmlAccessType.FIELD)
@XmlType(name = "Payload", propOrder = {
    "any"
})
public class Payload {

    @XmlAnyElement(lax = true)
    protected List<Object> any;

} 
```

**富**

下面是一个用 注释的类的例子`@XmlRootElement`。

```
package forum13941747;

import javax.xml.bind.annotation.XmlRootElement;

@XmlRootElement
public class Foo {

} 
```

**酒吧**

下面是一个没有`@XmlRootElement`注释的类的例子。在这个用例中，我们将利用用`@XmlElementDecl`注释的工厂类（通常称为`ObjectFactory`）上的注释`@XmlRegistry`。

```
package forum13941747;

public class Bar {

} 
```

**对象工厂**

下面是为类指定`@XmlElementDecl`注释的示例`Bar`。

```
package forum13941747;

import javax.xml.bind.JAXBElement;
import javax.xml.bind.annotation.*;
import javax.xml.namespace.QName;

@XmlRegistry
public class ObjectFactory {

    @XmlElementDecl(name="bar")
    public JAXBElement<Bar> createBar(Bar bar) {
        return new JAXBElement<Bar>(new QName("bar"), Bar.class, bar);
    }

} 
```

**输入.xml**

下面是我们将用于此示例的输入文档。有 3 个元素对应于该`any`属性。第一个对应于类上的`@XmlRootElement`注解`Foo`。第二个对应于类的`@XmlElementDecl`注释，`Bar`第三个不对应于任何域类。

```
<?xml version="1.0" encoding="UTF-8"?>
<payload>
    <foo/>
    <bar/>
    <other/>
</payload> 
```

**演示**

在下面的演示代码中，我们将解组输入文档，然后在结果`any`属性中输出对象的类，然后将`payload`对象编组回 XML。

```
package forum13941747;

import java.io.File;
import javax.xml.bind.*;

public class Demo {

    public static void main(String[] args) throws Exception {
        JAXBContext jc = JAXBContext.newInstance(Payload.class, Foo.class, ObjectFactory.class);

        Unmarshaller unmarshaller = jc.createUnmarshaller();
        File xml = new File("src/forum13941747/input.xml");
        Payload payload = (Payload) unmarshaller.unmarshal(xml);

        for(Object o : payload.any) {
            System.out.println(o.getClass());
        }

        Marshaller marshaller = jc.createMarshaller();
        marshaller.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, true);
        marshaller.marshal(payload, System.out);
    }

} 
```

**输出**

下面是运行演示代码的输出。请注意与属性中的对象对应的类`any`。该`foo`元素成为`Foo`该类的一个实例。`bar`元素变成了 的实例，它`JAXBElement`拥有 的实例`Bar`。该`other`元素成为 的一个实例`org.w3c.dom.Element`。

```
class forum13941747.Foo
class javax.xml.bind.JAXBElement
class com.sun.org.apache.xerces.internal.dom.ElementNSImpl
<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<payload>
    <foo/>
    <bar/>
    <other/>
</payload> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-06-09T22:25:03.517

使用对象工厂对对象进行如下处理，您无需在 DemoType.java 中有 @XmlRootElement 。，

```
DemoType demoServiceRequest = new DemoType();
ObjectFactory obDemo = new ObjectFactory();  
Request requestObject = new Request();     
requestObject.setAny(obDemo.createDemo(demoServiceRequest)); 
```

并在 Request.java 中添加 DemoType 类，如 @XmlSeeAlso({DemoType.class})

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-05-23T16:06:25.833

如果您的有效负载是 XML 字符串，我设法使用以下代码解决了同样的问题：

```
import javax.xml.parsers.DocumentBuilderFactory;

//...

String XMLPAYLOAD = "...";

Payload payload = new ObjectFactory().createPayload();
try {
    payload.setAny(DocumentBuilderFactory
           .newInstance()
           .newDocumentBuilder()
           .parse(new InputSource(new StringReader(XMLPAYLOAD)))
           .getDocumentElement());
} catch (Exception e) {
    e.printStackTrace();
}

//... 
```

# html - JSP简单程序

> ID：13941754
> 
> 赞同：0
> 
> 时间：2012-12-18T21:25:41.373
> 
> 标签：html, jsp

我正在尝试做一个有数字和按钮的 JSP 程序。单击按钮后，上面的数字会增加。我需要在这个程序中使用会话。

这是我做的代码：

```
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title> Welcome </title>
</head>

<body>

<%
    // check if there already is a "Counter" attrib in session  
    AddCount addCount = null;
    int test = 0;
    String s;

    try {
        s = session.getAttribute("Counter").toString(); 

    } catch (NullPointerException e){
        s = null;
    }

    if (s == null){ 
        // if Counter doesn't exist create a new one

        addCount = new AddCount();
        session.setAttribute("Counter", addCount);

    } else {
        // else if it already exists, increment it
        addCount = (AddCount) session.getAttribute("Counter");
        test = addCount.getCounter();
        addCount.setCounter(test); 
        addCount.addCounter(); // increment counter
        session.setAttribute("Counter", addCount);
    }

%>

<%! public void displayNum(){ %>
        <p> Count: <%= test %> </p>
<%! } %>

<input TYPE="button" ONCLICK="displayNum()" value="Add 1" />

</body>
</html> 
```

结果是每次我运行程序时，数字都会增加..但是我不希望这种情况发生..我希望数字在单击按钮时增加：/我做错了什么？

谢谢你的帮助。将不胜感激！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:10:43.070

***一个示意图 JSP，因为它本来可以完成。***

这里我假设页面被命名为“counter.jsp”并且AddCount 类驻留在包“mypkg”中。

JSP 编码可以在 HTML 标题行中设置，位于第一个 HTML 浏览器文本之前。

对于 ISO-8859-1，您实际上可以使用编码 Windows-1252，并带有额外的字符，例如特殊的类似逗号的引号。甚至 MacOS 浏览器也会接受这些。

在这里，我检查是否单击了按钮，是否存在表单参数“somefield”。（还有其他可能性。）

**session="true"**在这里至关重要。

```
<%@page contentType="text/html; charset=Windows-1252"
        pageEncoding="Windows-1252"
        session="true"
        import="java.util.Map, java.util.HashMap, mypkg.AddCount" %>
<%
    // Check if there already is a "Counter" attrib in session  
    AddCount addCount = (AddCount)session.getAttribute("Counter"); 
    if (addCount == null) { 
        // If Counter doesn't exist create a new one
        addCount = new AddCount();
        session.setAttribute("Counter", addCount);
    }

    // Inspect GET/POST parameters:
    String somefield = request.getParameter("somefield");
    if (field != null) {
        // Form was submitted:

        addCount.addCounter(); // increment counter
    }

    int count = addCount.getCounter();
%>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
        <title>Welcome - counter.jsp</title>
    </head>

    <body>
        <p> Count: <%= count %></p>
        <form action="counter.jsp" method="post">
            <input type="hidden" name="somefield" value="x" />
            <input type="submit" value="Add 1" />
        </form>
    </body>
</html> 
```

# javascript - Chrome 中的 Flash 渲染错误

> ID：13941758
> 
> 赞同：0
> 
> 时间：2012-12-18T21:25:44.377
> 
> 标签：javascript, flash, google-chrome, render

看看这个bug，

这是代码：“我们有一个简单的网页，其中有一个非常大的 iframe，向左移动，我们看到它的中心部分。然后使用 javascript，我们在中间添加一个 flash 对象（一个时钟）（位置 1000x1000) 所以它位于 iframe 的可见部分。起初，flash 片段渲染得很好，但在我在这里提到的“魔术”步骤之后，flash 片段没有渲染“

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
</HEAD>
<BODY>
<iframe id="iframe" style="position: absolute; left: -1000px; top: -1000px; width:2000px; height: 2000px; border: 1px solid black"></iframe>
<SCRIPT LANGUAGE="JavaScript">
window[0].document.write('<body><div id="FlashContainer" style="display: inline;"><embed id="embed" name="embed" type="application/x-shockwave-flash" wmode="transparent" src="http://edmullen.net/flash/relog.swf" allowscriptaccess="always" allowfullscreen="true" swliveconnect="true" style="vertical-align: top; margin: 0px; width: 728px; height: 300px; clip: rect(0px 728px 300px 0px); position: absolute; left: 1000px; top: 1000px; z-index: 1;"></div></body>');
window[0].document.body.style.paddingLeft = "1000px"; //without this works
window[0].document.body.style.paddingTop = "1000px"; //without this works
</SCRIPT>
</BODY>
</HTML> 
```

在 Chrome 中运行此代码，打开 devtool (F12)：

选择元素嵌入：

1.  更改值：

    *   职位：亲戚
    *   左：0px
    *   顶部：0px
        *   （有时这里没有渲染闪光灯！）
2.  再次更改为：

    *   位置：绝对
    *   左：1200
    *   最高：1200

点评：通过这两个步骤，我们将embed元素移动到了iframe的左上角，然后我们恢复了原来的位置

那么，漏洞在哪里？错误是未呈现 flash 元素（可以在步骤 1 或 2 中）。要检查它，请按右键单击（在视口的左上角），然后会出现 Flash 弹出菜单。

那不是所有人！如果你改变元素“FlashContainer”的显示属性，那么flash片段就会出现在那里！

注意：问题是由填充 left & top 引起的，我不知道为什么会这样。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:37:37.790

尝试将 iframe 的 z-index 设置为 1 或更大。

# php - PHP 和双向文本搜索

> ID：13941764
> 
> 赞同：0
> 
> 时间：2012-12-18T21:26:14.337
> 
> 标签：php, regex, text-search

给定一个包含许多字符串的文本文件。

例如，如果搜索**red apples**，则以下代码：

```
$search = "red apples";
$contents = file_get_contents("file.txt");
$pattern = "/^.*$search*\$/m";
preg_match_all($pattern, $contents, $matches);
implode("\n", $matches[0]); 
```

将返回（连同其他字符串）以下一个：

```
Plate with many red apples blah blah 
```

我需要找到相同的字符串，但要搜索**apples red**。有没有办法做到这一点？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:37:13.730

```
$search_inversed = implode(' ', array_reverse(explode(' ', $search))); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T02:41:22.090

试试这样：

```
<?php

$string = 'Lets locate red apple, or even, apple red!';

$search = 'red apple';

$search_parts = ( strpos( ' ', $search ) !== false ) ? explode( ' ', $search ) : array( $search );

preg_match_all( '#(' . preg_quote(  implode( ' ', $search_parts ), '#' ) . ')|(' . preg_quote( implode( ' ', array_reverse( $search_parts ) ), '#' ) . ')#i', $string, $matches );

echo '<pre>' ;
print_r( $matches[0] );
echo '</pre>' ; 

?> 
```

请注意使用 strpos() 和 preg_quote() 来避免正则表达式模式错误。

# qt - Qt Creator `.pro.shared` 文件似乎没有任何效果

> ID：13941766
> 
> 赞同：4
> 
> 时间：2012-12-18T21:26:20.797
> 
> 标签：qt, qt-creator

我在 Mac OS 10.8.2 上使用 Qt Creator 2.6.0，并且`myproject.pro.shared`在与`myproject.pro`. 我将示例 XML 从[https://qt-project.org/doc/qtcreator-2.6/creator-sharing-project-settings.html](https://qt-project.org/doc/qtcreator-2.6/creator-sharing-project-settings.html)复制到`myproject.pro.shared`文件中。我删除了我的`~/.config/QtProject/`文件夹，但我没有`myproject.pro.user`文件。

当我启动 Qt Creator 并打开项目文件时，`myproject.pro.shared`不使用中指定的设置。例如，`myproject.pro.shared`指定`TabSize`为 14，但在 Projects > Editor 下，“Editor settings”仍然显示“Global”，并且 Tab 大小不是 14。

我怎样才能让它工作，以便在我第一次在新工作站上打开项目时填充默认设置？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-21T16:44:41.887

我错过了这一行：

```
<value type="bool" key="EditorConfiguration.UseGlobal">false</value> 
```

添加后，Qt Creator 默认使用具有正确设置的自定义配置。

这是我的工作，带注释的`.pro.shared`文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE QtCreatorProject>
<qtcreator>
    <data>
        <variable>ProjectExplorer.Project.Updater.FileVersion</variable>
        <value type="int">12</value>
    </data>

    <!-- "Projects > Editor" tab -->
    <data>
        <variable>ProjectExplorer.Project.EditorSettings</variable>
        <valuemap type="QVariantMap">
            <value type="bool" key="EditorConfiguration.UseGlobal">false</value>

            <!-- "Tabs And Indentation" section -->
            <value type="bool" key="EditorConfiguration.SpacesForTabs">false</value>
            <value type="bool" key="EditorConfiguration.AutoSpacesForTabs">false</value>
            <value type="int" key="EditorConfiguration.TabSize">4</value>
            <value type="int" key="EditorConfiguration.IndentSize">4</value>
            <value type="int" key="EditorConfiguration.PaddingMode">2</value> <!-- 0="Not At All", 1="With Spaces", 2="With Regular Indent" -->

            <!-- "Typing" section -->
            <value type="bool" key="EditorConfiguration.AutoIndent">true</value>
            <value type="int" key="EditorConfiguration.SmartBackspaceBehavior">0</value> <!-- 0="None", 1="Follows Previous Indents", 2="Unindents" -->
            <value type="int" key="EditorConfiguration.TabKeyBehavior">0</value> <!-- 0="Never", 1="Always", 2="In Leading White Space" -->

            <!-- "Cleanups Upon Saving" section -->
            <value type="bool" key="EditorConfiguration.cleanWhitespace">true</value>
            <value type="bool" key="EditorConfiguration.inEntireDocument">true</value>
            <value type="bool" key="EditorConfiguration.cleanIndentation">true</value>
            <value type="bool" key="EditorConfiguration.addFinalNewLine">true</value>

            <!-- "File Encodings" section -->
            <value type="QByteArray" key="EditorConfiguration.Codec">UTF-8</value>
            <value type="int" key="EditorConfiguration.Utf8BomBehavior">1</value> <!-- 0="Add If Encoding Is UTF-8", 1="Keep If Already Present", 2="Always Delete" -->

            <!-- "Mouse and Keyboard" section -->
            <value type="bool" key="EditorConfiguration.MouseNavigation">true</value>
            <value type="bool" key="EditorConfiguration.ScrollWheelZooming">false</value>
            <value type="bool" key="EditorConfiguration.CamelCaseNavigation">true</value>
            <value type="bool" key="EditorConfiguration.ConstrainTooltips">false</value>
            <value type="bool" key="EditorConfiguration.KeyboardTooltips">false</value>
        </valuemap>
    </data>
</qtcreator> 
```

# http - 有人知道支持持久 HTTP 连接的 Netty HTTP 服务器的简单示例吗？

> ID：13941768
> 
> 赞同：7
> 
> 时间：2012-12-18T21:26:22.293
> 
> 标签：http, netty

谁能提供一个使用 Netty 实现的简单 HTTP 服务器的示例，它支持持久的 HTTP 连接。

换句话说，它不会关闭连接，直到客户端关闭它，并且可以通过同一连接接收额外的 HTTP 请求？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-12-19T11:27:02.583

这正是他们的[示例 http 代码](http://netty.io/4.0/xref/io/netty/example/http/snoop/package-summary.html)演示的事情之一。

# mysql - 子查询 where 子句中的未知列

> ID：13941770
> 
> 赞同：10
> 
> 时间：2012-12-18T21:26:27.967
> 
> 标签：mysql, subquery

我的 INNER JOIN 子查询的 where 子句有问题。我收到一个未知的列错误`M.idMembre`。我尝试使用表名而不是别名，但我遇到了同样的问题。我还尝试从子查询中删除 WHERE 子句，并在子查询之后的 ON 子句中添加此条件。但是，无论哪种方式，我都有同样的问题。我觉得这很明显我在这里失踪了。

```
SELECT DISTINCT M.`idMembre` ,  `couponsTypes`.`maxCouponType` 
FROM membres AS  `M` 
INNER JOIN (
SELECT idMembre, MAX( coupons.`idType` ) AS  `maxCouponType` 
FROM coupons
WHERE coupons.`idMembre` = M.`idMembre` 
GROUP BY idMembre
) AS  `couponsTypes` 
ON M.`idMembre` = couponsTypes.`idMembre`
ORDER BY maxCouponType DESC 
```

如果您需要更多信息，请与我们联系。

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2012-12-18T21:36:36.697

不允许在连接子句的子查询中引用外部表。解决此问题的一种方法是`group by`根据连接条件在子查询中执行：

```
SELECT DISTINCT M.`idMembre`, `couponsTypes`.`maxCouponType`
FROM membres AS `M` 
INNER JOIN
(SELECT idMembre, MAX(coupons.`idType`) AS `maxCouponType`
   FROM coupons
   GROUP BY idmembre
) `couponsTypes`
ON couponstypes.idMembre = M.idMember
ORDER BY maxCouponType DESC 
```

但是，你根本不需要这张`membres`桌子。虽然在 external 中引用了`select`，但它相当于coupons type 表中的member id。因此，您可以将查询编写为：

```
SELECT idMembre, MAX(coupons.`idType`) AS `maxCouponType`
FROM coupons
GROUP BY idmembre
ORDER BY 2 DESC 
```

这可能是最简单和最有效的方式制定。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:35:07.433

您的子查询无权访问外部查询中的表。也就是说，在评估子查询时，`membres`表（别名为`M`）不可用。`couponsTypes`

但是，在这种情况下不需要这样的子查询；您只需要直接加入表格并将结果分组：

```
SELECT   idMembre, MAX(coupons.idType) AS maxCouponType
FROM     membres JOIN coupons USING (idMembre)
GROUP BY idMembre
ORDER BY maxCouponType DESC 
```

# php - PHP的htmlentities函数不编码★星

> ID：13941771
> 
> 赞同：1
> 
> 时间：2012-12-18T21:26:28.540
> 
> 标签：php, html-entities

```
htmlentities($this->name, null, "UTF-8"); 
```

不编码星号 (★)。我怎样才能让它对星星进行编码？

**更新：** `&acirc`不渲染星星。另外，我正在使用：

`<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:29:36.427

在 PHP >= 5.4 中，参数的默认值`encoding`更改为`UTF-8`.

如果您使用：

```
htmlentities( "★", null, "ISO-8859-1"); 
```

星号将转换为`&acirc;`.

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T22:24:30.870

> 我怎样才能让它对星星进行编码？

你不能。`htmlentities`不编码所有 Unicode 字符。但是你可以尝试一些解决方法，比如[这个](http://php.net/manual/en/function.htmlentities.php#107985)

或者您可以使用以下输出`json_encode`：

```
$txt = preg_replace_callback(
    '/[\x80-\xFF]{3,}/', //do not trust this, it's only example that works for small range of unicode characters, that happens to include black star 
     function($m){ 
         return str_replace('\\u','&#x',trim(json_encode($m[0]),'"')).';';
      }, "Black ★ Star"
); // Black &#x2605; Star 
```

# javascript - JQuery 在 Firefox 和 Chrome/Safari 中的行为不同

> ID：13941772
> 
> 赞同：0
> 
> 时间：2012-12-18T21:26:29.843
> 
> 标签：javascript, jquery

我有这个将图像放在列中的代码（不是我的代码，而是修改过的）。我刚刚添加了一个无限滚动脚本，以便保留图像的先前顺序，我将它们嵌套在页面 div 中，因此我遍历页面 div，然后继续遍历页面中的每个图像。奇怪的是，Firefox 似乎正确地放置了图像，但 chrome 和 safari 只是通过重复添加将位置弄乱了。任何人有任何想法为什么？

```
var colCount = 0;
var colWidth = 225;
var margin = 10;
var spaceLeft = 0;
var windowWidth = 0;
var blocks = [];

$(function(){
  $(window).resize(setupBlocks);
});

function setupBlocks() {
  windowWidth =  $("#container").outerWidth();
  blocks = [];
  // Calculate the margin so the blocks are evenly spaced within the window
  colCount = Math.floor(windowWidth /(colWidth + margin*2));
  spaceLeft = (windowWidth - ((colWidth*colCount)+(margin*(colCount-1)))) / 2;
  for(var i=0;i<colCount;i++){
    blocks.push(margin);
  }
  positionBlocks();

}

function positionBlocks() {
 $('.page').each(function(i){
  $(this).children('.block').each(function(j){
    var min = Array.min(blocks);
    var index = $.inArray(min, blocks);
    var leftPos = (index * (colWidth + margin));
    $(this).css({
      'left':(leftPos + spaceLeft) + 'px',
      'top':min+'px'
    });
    blocks[index] = min+$(this).outerHeight() + margin;
  });
  }); 
}

$(window).scroll(function(){
  if($(window).scrollTop() == $(document).height() - $(window).height()){
  //$('div#loadmoreajaxloader').show();
  $.ajax({
    url: "/more",
    success: function(html){
      if(html){
        $("#container").append(html);
        setupBlocks()
        //$('div#loadmoreajaxloader').hide();
      }else{
        $('div#loadmoreajaxloader').html('<center>No more posts to show.</center>');
      }
    }
  });
}
}); 
```

# actionscript-3 - AS3：奇怪的动态文本错误

> ID：13941773
> 
> 赞同：0
> 
> 时间：2012-12-18T21:26:35.233
> 
> 标签：actionscript-3, flash, text

我正在开发一款游戏，当我想显示分数时，会发生奇怪的错误。

例如，它显示 5 而不是 75。它有时会发生，不是定期发生，而且只是片刻，直到变量再次发生变化。

代码很简单：

`point_txt.text = String(points);`

当我用 trace() 检查变量“点”时；它显示正确。

有人遇到同样的问题并知道如何解决吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:31:53.930

这应该可以解决您的问题：

```
point_txt.text = String(points);
point_txt.width = point_txt.textWidth; 
```

干杯!

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-03T08:48:54.117

从“属性”面板更改行为：单行

# c++ - 正在跳过字符串数组中的第一个字符串

> ID：13941775
> 
> 赞同：0
> 
> 时间：2012-12-18T21:26:43.583
> 
> 标签：c++

不知何故，当我运行这段代码并输入字符串时，第一个 i=0 的字符串被跳过，它开始从 A[1] 输入字符串。所以我最终得到 A[0] 充满了内存中的随机内容。有人可以指出问题吗？

```
cin>>s;
char** A;
A = new char *[s]; 
cout<<"now please fill the strings"<<endl;
for (int i=0;i<s;i++)
{ 
    A[i] = new char[100];
    cout<<"string "<<i<<": ";
    gets(A[i]);
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:37:50.317

那个代码太可怕了。下面是它在真正的 C++ 中的样子：

```
#include <string>
#include <iostream>
#include <vector>

int main()
{
    std::cout << "Please start entering lines. A blank line or "
              << "EOF (Ctrl-D) will terminate the input.\n";

    std::vector<std::string> lines;

    for (std::string line; std::getline(std::cin, line) && !line.empty(); )
    {
        lines.push_back(line);
    }

    std::cout << "Thank you, goodbye.\n";
} 
```

请注意没有任何指针或`new`表达式。

如果您愿意，可以通过在循环`std::cout << "> " &&`中条件检查的开头添加一些提示打印。`for`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:34:59.250

可能是因为您正在使用gets()...永远不要使用gets() 而是使用fgets()。

[得到与 fgets](http://www.gidnetwork.com/b-56.html)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-18T21:38:09.563

好吧，您可能会得到一个空字符串：读取`s`时使用格式化输入，一旦遇到非数字就停止，例如，用于指示其输入完成的换行符。`gets()`，因此，立即找到一个换行符，终止读取的第一个字符串。

也就是说，你**永远不要**使用`gets()`：这是一个主要的安全问题，也是许多潜在攻击的根本原因！相反，您应该使用`fgets()`or，更好的是，`std::getline()`与`std::string`s 和 a一起使用`std::vector<std::string> >`。此外，您应该**始终**验证输入尝试是否成功：

```
if ((std::cin >> s).ignore(std::numeric_limits<std::streamsize>::max(), `\n`)) {
    std::string line;
    for (int i(0); i != s && std::getline(std::cin, line); ) {
        A.push_back(line);
    }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-12-18T21:38:09.780

问题是，它只是`cin>>s;`拿起你想要的数字，然后在第一次迭代中留下一个`\n`（`enter`新闻界的换行符） 。这不是修复它的最佳方法，但为了证明它在该行之后写下这一行：`stdin``gets()`

```
int a = fgetc(stdin); 
```

之后检查`a`以确认它有一个换行符。

# c# - Web 浏览器控件未注册导航事件

> ID：13941779
> 
> 赞同：0
> 
> 时间：2012-12-18T21:27:07.730
> 
> 标签：c#, windows-phone-7, webbrowser-control

我在放置在应用程序第二页上的 Web 浏览器控件中使用导航事件。似乎前进和后退的导航事件工作正常。但是，我执行某些操作，例如在我的 Navigated 事件处理程序中维护在我的导航事件中使用的当前浏览器 url 堆栈，根据某些情况，当页面导航到时并不总是注册。维护当前浏览器 url 堆栈的目的是确保如果主页（这是我加载的应用程序的第二页后导航到的第一个页面）使用后堆栈导航到，应用程序应该返回到Microsoft 要求所述的应用程序的第一页。

根据我的调试，如果我使用以下 Web 浏览器控件导航方案，我不会单步执行 Navigated 事件（如下所示）

MainPage > SecondPage with browser( Homepage > Forward > Forward > Back > Forward > Back (导航事件不发生) )

这似乎令人困惑，但本质上，一旦浏览器被导航回来（一次或用户想要的多次），然后继续向前导航，下次用户希望导航到前一页时，导航事件就不会发生即使页面被导航回。

为了显示

```
//should always pass through this event when ANY navigation occurs
void TheWebBrowser_Navigated(object sender,
        System.Windows.Navigation.NavigationEventArgs e)
    {
        //If we are Navigating Backward and we Can Navigate back, 
        //remove the last uri from the stack.
        if (_IsNavigatingBackward == true && CanNavigateBack)
        {
            _NavigatingUrls.Pop();
        }

        //Else we are navigating forward so we need to add the uri 
        //to the stack.
        else
        {
            _NavigatingUrls.Push(e.Uri);

            //If we do not have the navigated uri in our history 
            //we add it.
            if (!_History.Contains(e.Uri.ToString()))
                _History.Add(e.Uri.ToString());
        }

        //If there is one address left you can't go back.
        if (_NavigatingUrls.Count > 1)
            CanNavigateBack = true;
        else
            CanNavigateBack = false;

        //Finally we hide the progress bar.
        ShowProgress = false;

        _IsNavigatingBackward = false;  //to eliminate staying as true when navigating forward and forward btn not pressed
    }

public void NavigateForward()
    {
        _IsNavigatingBackward = false;
        TheWebBrowser.InvokeScript("eval", "history.go(1)");

        //_IsNavigating = true;
    }

public void NavigateBack()
    {
        _IsNavigatingBackward = true;
        TheWebBrowser.InvokeScript("eval", "history.go(-1)");
    }

protected override void OnBackKeyPress(System.ComponentModel.CancelEventArgs e)
    {
        if (CanNavigateBack)
        {
            e.Cancel = true;
            NavigateBack();
        }
        else
            base.OnBackKeyPress(e);            
    } 
```

未发生 Navigated 事件的问题会抛出 NavigatingUrls 的计数，因此 CanNavigateBack 标志在主页上保持为真（当用户尝试再次通过返回堆栈导航到 MainPage 时）实际上应该为假，并且我的应用程序的 MainPage 永远无法导航到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T10:28:13.197

我已经测试了您的代码（没有 NavigateForward 方法）并且工作正常。我不确定您是如何使用该方法的。

根据我的观察，您的 NavigateForward 方法使用可能有问题。你怎么叫它，你什么时候叫它？

# iphone - iPhone开发：如何构建自定义视图层次结构？

> ID：13941786
> 
> 赞同：0
> 
> 时间：2012-12-18T21:27:40.330
> 
> 标签：iphone, objective-c, ios, uinavigationcontroller, uikit

我对 iOS 和 iOS 开发还很陌生，我需要为我完成一项相当复杂的任务。我正在开发的应用程序有一个主视图，用户必须能够通过单击三个不同的按钮从主视图移动到三个不同的视图。这些视图将有自己的子视图层次结构，但这不是我现在的目标。目前，我正在努力完成这个子任务。我已经阅读了大部分关于 iPhone 开发的基础教程，并了解到该类`UINavigationController`负责在视图层次结构中进行遍历。据我从教程中可以看到，`UINavigationController`它提供了一个导航栏，但这提供了一个到单个视图的过渡。我的第一个问题是如何构建自定义导航系统，我应该子类化并以某种方式修改`UINavigationController`还是另一种方法可能？这可能是一个非常简单的问题，但是那里有大量的材料只会让我更加困惑。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:34:24.190

首先，**不要**子类化`UINavigationController`。苹果说不要，而且真的没有很好的理由这样做。

听起来您需要在尝试创建此应用程序之前完成更多教程。我强烈推荐 Ray Wenderlich 的网站，该网站有很多免费教程以及他提供的“iOS 示例”系列。（见[http://www.raywenderlich.com/](http://www.raywenderlich.com/)）

只需阅读他的一些免费教程即可开始，几乎所有教程都显示了如何做您正在寻找的东西。

祝你好运！

**编辑**

“垂直选项卡”不是 iOS 中的原生组件。但是，似乎有一些 3rd 方回购可以解决问题。我没有亲自使用过这个，但它似乎在其他 SO 帖子中被推荐（参见[iOS 垂直标签栏](https://stackoverflow.com/questions/5698723/ios-vertical-tab-bar)），看看这是否有帮助：

[https://github.com/futuresimple/FSVerticalTabBarController](https://github.com/futuresimple/FSVerticalTabBarController)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:34:50.387

我不会子类化`UINavigationController`

由于您是 iOS 开发的新手，我建议您使用故事板来完成您的流程。`UINavigationController`使用、`UIButtons`和其他基本元素可以很容易地实现这一点。

您必须构建一个 iOS 5 及更高版本的应用程序才能使用故事板。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:38:39.490

看看[UITabBarController](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UITabBarController_Class/Reference/Reference.html)。

一个标签栏管理一组 viewController。它可能比 UINavigationController 更接近您的想法，并且更易于实现。每个选项卡栏项可以是具有自己层次结构的 NavController，也可以是单个 viewController。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T00:28:19.727

根据您的需要，您可以使用包含创建自己的导航层次结构；这是在 iOS 5 中引入的。如果你这样做，会涉及更多的工作。

我最近用它来做一些自定义用户界面。在一种情况下，我需要使用包含 UI 页面视图控制器的内容。

如果有的话，请绘制一个图表来表示您需要首先构建的控制器视图层次结构，然后决定您是否需要沿着这条路线走。

这是 Apple 文档的链接。

[关于创建自定义容器视图控制器的 Apple 文档](http://developer.apple.com/library/ios/#featuredarticles/ViewControllerPGforiPhoneOS/CreatingCustomContainerViewControllers/CreatingCustomContainerViewControllers.html#//apple_ref/doc/uid/TP40007457-CH18-SW6)

还有一个来自 WWDC 2011 的视频。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-12-21T09:24:16.387

感谢所有分享他们知识的人。我想我已经想出了如何创建一个简单的视图层次结构，我现在正在应用它。我使用 UINavigationController 并在从 .xib 文件创建的视图控制器上调用它的 push-pop 方法。顺便说一句，[http://www.simplecode.me/2011/09/04/an-introduction-to-uinavigationcontroller/](http://www.simplecode.me/2011/09/04/an-introduction-to-uinavigationcontroller/)上的教程也很有帮助，以防像我这样的其他新手寻求构建视图层次结构的方法。

# javascript - 绘制多个 HTML 画布只绘制最后一个？

> ID：13941787
> 
> 赞同：4
> 
> 时间：2012-12-18T21:27:50.410
> 
> 标签：javascript, html, loops, canvas, for-loop

在我正在编写的一个应用程序中，有一个页面，我从我的数据库中加载了多个 base64 编码的图像，并将它们放在一个 JavaScript 数组中。这是通过 EJS 模板在服务器上发生的，因此当用户收到 HTML 页面时，会出现 base64 编码的图像（我检查了这个）。

下一步是在客户端使用 JavaScript 循环遍历画布，然后用相应的图像数据填充每个画布。但是，我得到了一些奇怪的行为。每次只填充最后一个画布。

```
for (var i = 1; i < 13; i++) {
    var ctx = document.getElementById('canvas-' + i).getContext('2d'),
        image = new Image();

    image.onload = function() {
        ctx.drawImage(image, 0, 0);
    }
    image.src = images[(i - 1)];
} 
```

图像数组在此代码的正上方定义（在同一范围内）。如果我像这样执行代码，则只会填充最后一个画布（id 为“canvas-12”）。如果我将 for 循环结束条件降低到例如 i < 11，则只会填充 id 为“canvas-10”的画布。

有什么我想念的吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-12-18T21:34:38.113

似乎是一个关闭问题；每次循环时，您都在更改函数`ctx`中包含的对象`onload`。您需要确保在循环期间不使用闭包更新对象：

```
for (var i = 1; i < 13; i++) {
    var ctx = document.getElementById('canvas-' + i).getContext('2d'),
        image = new Image();
    (function(ctx, image) {
        image.onload = function() {
            ctx.drawImage(image, 0, 0);
        }
        image.src = images[(i - 1)];
    })(ctx, image);
} 
```

注意：我没有对此进行测试。

# silverlight - Windows Phone 测试广告未在 VS2012 上显示

> ID：13941792
> 
> 赞同：1
> 
> 时间：2012-12-18T21:28:17.943
> 
> 标签：silverlight, windows-phone

我试图在运行模拟器的应用程序和设备上显示测试广告，它只显示没有测试广告图像的黑色空间，我错过了什么吗？我的 XAML.CS 文件是否需要任何代码？似乎此 VS 版本已弃用以前在 Google 上找到的信息...

编辑：将 AdControl 从工具箱拖放到简单的应用程序模板上会在加载模拟器时显示测试广告图像，但在将其放置在 HTML5 VS2012 模板上时不会显示...限制？

这是我的 XAML：

```
 <Grid x:Name="LayoutRoot" Grid.Row="1" Background="Transparent">

        <Grid x:Name="Grid1">
         <phone:WebBrowser x:Name="Browser"
                      Loaded="Browser_Loaded"
                      NavigationFailed="Browser_NavigationFailed" Margin="0,0,0,80" />
    </Grid>
    <Grid x:Name="Grid2">
        <UI:AdControl ApplicationId="test_add" Foreground="White" AdUnitId="Image480_80" Height="80" Margin="0,616,0,0" Width="480"/>
    </Grid>  
</Grid> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T18:38:46.430

根据您需要更改ApplicationId[的文档：](http://msdn.microsoft.com/en-us/library/advertising-mobile-windows-phone-test-mode-values%28v=msads.20%29.aspx)

> 模拟器中不提供实时广告。在模拟器中运行时，您必须使用 ApplicationId 和 AdUnitId 的测试值。要验证实时广告，您必须在设备上运行该应用程序。如果应用程序在模拟器中运行时**ApplicationId 未设置为值 test_client**，应用程序将抛出错误。错误消息将告诉您“您不能使用 pubCenter ID 从模拟器进行测试。如果您想使用这些 ID 进行测试，请将您的应用程序部署到设备上。否则，请将您的 ApplicationId 更改为 test_client，并将 AdUnitId 更改为文档中列出的受支持的广告类型之一。”</p>

也就是说，对于 Windows Phone 8 项目，我似乎无法在 Blend 或 VS 2012 的设计器中显示测试图像。但是，它似乎确实适用于 Windows Phone 7 项目（引用不同的 dll）。

您是否需要查看图像才能开发您的应用程序？您应该假设它可以工作，然后通过将其部署到测试手机进行测试，以确保您收到广告。

# apache - 样板 .htaccess mod_deflate 不起作用

> ID：13941793
> 
> 赞同：0
> 
> 时间：2012-12-18T21:28:27.493
> 
> 标签：apache, .htaccess, html5boilerplate

我刚刚将网站上传到网络主机（它使用 CPanel）并且我正在使用**Boilerplate** .htaccess 文件（未更改） - 所以**mod_deflate**应该可以工作，但它没有（我在[http://www.whatsmyip.org检查了这个/http-compression-test/](http://www.whatsmyip.org/http-compression-test/)（地址是[okcpirot.rs](http://okcpirot.rs)））。我对这件事很陌生 - 我需要在 CPanel 中打开一些东西才能让它工作还是应该自动工作？

**mod_deflate**的代码

 **```
<IfModule mod_deflate.c>

  # Force deflate for mangled headers developer.yahoo.com/blogs/ydn/posts/2010/12/pushing-beyond-gzipping/
  <IfModule mod_setenvif.c>
    <IfModule mod_headers.c>
      SetEnvIfNoCase ^(Accept-EncodXng|X-cept-Encoding|X{15}|~{15}|-{15})$ ^((gzip|deflate)\s*,?\s*)+|[X~-]{4,13}$ HAVE_Accept-Encoding
      RequestHeader append Accept-Encoding "gzip,deflate" env=HAVE_Accept-Encoding
    </IfModule>
  </IfModule>

  # Compress all output labeled with one of the following MIME-types
  <IfModule mod_filter.c>
    AddOutputFilterByType DEFLATE application/atom+xml \
                                  application/javascript \
                                  application/json \
                                  application/rss+xml \
                                  application/vnd.ms-fontobject \
                                  application/x-font-ttf \
                                  application/xhtml+xml \
                                  application/xml \
                                  font/opentype \
                                  image/svg+xml \
                                  image/x-icon \
                                  text/css \
                                  text/html \
                                  text/plain \
                                  text/x-component \
                                  text/xml
  </IfModule>

</IfModule> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-28T12:48:48.910

这可能是因为 mod_deflate.c 未安装或被禁用。如您所见，脚本首先检查是否安装了 mod_deflate.c ( `<IfModule mod_deflate.c>`)。情况可能并非如此。

您最好的选择是询问您的托管服务提供商是否可以启用它。**

# sql - 搜索和替换方法？

> ID：13941794
> 
> 赞同：0
> 
> 时间：2012-12-18T21:28:33.593
> 
> 标签：sql, replace

有一个小的搜索和替换问题。假设您有一些文本：

```
(1, 'car', 'http://cara', 'test'),
(2, 'car', 'http://cara', 'test'),
(3, 'car', 'http://cara', 'test'), 
```

我想用 null 替换所有 id 列（数字），例如：

```
(, 'car', 'http://cara', 'test'),
(, 'car', 'http://cara', 'test'),
(, 'car', 'http://cara', 'test'), 
```

一个人会怎么做？有人知道如何在 bbedit、textwrangler 中执行此操作吗？还有其他工具吗？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:35:49.163

您可以使用 vim 的视觉选择：http: [//vim.wikia.com/wiki/Cut/copy_and_paste_using_visual_selection](http://vim.wikia.com/wiki/Cut/copy_and_paste_using_visual_selection)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T00:15:16.217

您可以在 vim 中使用正则表达式来处理您的搜索和替换：

`%s/(\S\{-},/(,`在给定的行中用“(”替换“(foo”)的第​​一个实例

# hibernate - 为什么hibernate为单向OneToMany创建一个连接表？

> ID：13941801
> 
> 赞同：17
> 
> 时间：2012-12-18T21:29:33.193
> 
> 标签：hibernate, hibernate-onetomany

为什么hibernate对这些类使用连接表？

```
@Entity
public class CompanyImpl {
    @OneToMany
    private Set<Flight> flights;

@Entity
public class Flight { 
```

我既不想要连接表也不想要双向关联:(

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2012-12-18T21:35:16.410

因为这就是它的设计方式，以及 JPA 规范告诉它映射这种关联的方式。如果您想在 Flight 表中添加一个连接列，请使用

```
@Entity
public class CompanyImpl {
    @OneToMany
    @JoinColumn(name = "company_id")
    private Set<Flight> flights;
} 
```

这[是记录在案的](http://docs.jboss.org/hibernate/core/3.6/reference/en-US/html_single/#collections-mapping)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2018-08-12T16:09:10.693

Hibernate 使用关联表来映射关系，而另一个多方表不存在任何表。然后它将创建一个映射器。

该文档指出，使用 @OneToMany 和 @ManyToMany 您可以映射关联实体的集合、列表、映射和集合。

如果您没有指定@joincolumn，这是关于您的问题，使用连接表的单向一对多。表名是所有者表名、_ 和另一侧表名的串联。引用所有者表的外键名称是所有者表、_ 和所有者主键列名称的串联。

因此，如果您不想使用一对多创建连接表（映射器），您可能必须指定@joinColumn。

```
@Entity
public class CompanyImpl {
    @OneToMany
     @JoinColumn(name=flights_id)
    private Set<Flight> flights;

@Entity
public class Flight { 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-11-07T02:59:48.210

我认为上面给出的答案不够详尽，所以我希望这会有所帮助

**原因。为什么 Hibernate 创建一个连接表。**

Hibernate 为单向 OneToMany 创建了一个 Join Table，因为通过实现，外键总是保存在多端。因此，在您的示例中，外键将保留在 Flight 表端，从而防止在 Hibernate 选择创建 JoinTable 的多端具有空值。

以你为例，

每个 Flight 都会有一个 CompanyImpl 列，如果没有设置，它必须为 null，因此为了避免在某些 Flight 记录中出现 null，Hibernate 选择有一个 JoinTable 来存储 Flight 和 CompanyImpl 的 Id。

# javascript - 具有 i18n（排序规则）支持的 JQuery 可过滤插件

> ID：13941803
> 
> 赞同：4
> 
> 时间：2012-12-18T21:29:39.457
> 
> 标签：javascript, jquery, internationalization, collation, non-ascii-characters

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T15:24:16.863

您已经看过[https://github.com/Teradata/lasca](https://github.com/Teradata/lasca)了吗？

似乎适合或至少是实现 jquery 插件的起点。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-28T10:37:45.987

这不是搜索到的 JQuery 插件，但似乎[新的 Internationalization API 规范](https://developer.mozilla.org/en-US/docs/Web/JavaScript/JavaScript_technologies_overview?redirectlocale=en-US&redirectslug=JavaScript/JavaScript_technologies_overview#Internationalization_API)包含了表达的需求，例如排序规则处理。

# asp.net - 如何将水晶报表转换或导入到activereports 7

> ID：13941805
> 
> 赞同：2
> 
> 时间：2012-12-18T21:29:41.143
> 
> 标签：asp.net, visual-studio-2010, crystal-reports, activereports

我有 Visual Studio 2010 Ultimate、Crystal Reports 和 Active Reports 7，我需要将我的 Crystal Reports 转换为 Active Reports 7。在 VS 2010 Crystal Report 中，我单击工具 Convert to Active Reports 7 并收到以下消息：`ActiveReports Developer Upgrade tool "there is no content to upgrade in (project name) project.`

应该先创建 ActiveReport 吗？如何将水晶报表转换为 ActiveReports？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-23T06:23:47.933

“转换为 ActiveReports 7”命令用于将项目从 ActiveReports 6 或更早版本转换为 ActiveReports 7。

您要做的是从“开始”菜单运行“ActiveReports Developer Import”应用程序。不幸的是，我运行的是 Windows 8，所以我不能告诉你它的确切位置，但它在 ComponentOne\ActiveReports Developer 下的某个地方。

这是我们关于使用[导入向导](http://downloads.gcpowertools.com/arhelp/?Converting%20with%20Import%20Wizard.html)的文档。

# ios - google drive api iOS 示例

> ID：13941812
> 
> 赞同：3
> 
> 时间：2012-12-18T21:30:16.947
> 
> 标签：ios, google-drive-api

是否有适用于 iOS 的 Google Drive API 的工作示例？此示例不起作用 - [https://developers.google.com/drive/quickstart-ios](https://developers.google.com/drive/quickstart-ios)

# git - Sencha Touch 2 的版本控制中应包含哪些文件/文件夹

> ID：13941821
> 
> 赞同：2
> 
> 时间：2012-12-18T21:30:48.563
> 
> 标签：git, file, sencha-touch

我正在构建我的第一个 sencha touch 2 应用程序。调用下面的命令后，它创建了一个大小为的`application`目录`23M`！

```
sencha generate app -n application` 
```

我还没有添加任何代码，它那么大。你能告诉哪些文件和文件夹应该进入`git`。我不想添加所有这些。`.git`会变大。一些免费`git`提供程序（bitbucket、unfuddle、beantalk 等）不会允许那么多空间！

这是目前的结构。

```
.
├── app
│   ├── controller
│   ├── model
│   ├── profile
│   ├── store
│   └── view
├── app.js
├── app.json
├── index.html
├── packager.json
├── resources
│   ├── css
│   ├── icons
│   ├── images
│   ├── loading
│   ├── sass
│   └── startup
└── sdk
    ├── command
    ├── microloader
    ├── resources
    ├── sencha-touch-all.js
    ├── sencha-touch.js
    ├── src
    └── version.txt 
```

### 更新 1：

我知道不应该修改生成的文件。但最终我也必须修改一些生成的文件。还有一些我根本不需要修改的生成文件（例如`sdk`目录）。现在我想知道`sdk`我不需要修改的其他实体是什么，所以我可以将它们放入`.gitignore`.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T06:45:02.853

可以生成的该结构的任何部分都不应成为您的 git 存储库的一部分并添加到`.gitignore`文件中。

`.gitignore`您可以在[GitHub gitignore 项目](https://github.com/github/gitignore)中看到许多文件示例。

# c++ - 想在读取文件时对 char 类型使用 atoi() 吗？

> ID：13941822
> 
> 赞同：0
> 
> 时间：2012-12-18T21:30:52.173
> 
> 标签：c++

我已将映射到内存中的文件的内容提取到一个数组中，如下所示：

```
char* const arr = static_cast<char *>(file.get_address()); 
```

在遍历数组时，我希望能够调用：

```
for(int i=0; i<file.get_size(); i++){
    atoi(arr[i]);
} 
```

但是，atoi 需要 const char* 类型，而 arr[i] 是 char* const 类型。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T22:11:44.957

首先，我质疑你使用`const`in...

```
char* const arr = static_cast<char *>(file.get_address()); 
```

在这种情况下，`const`适用于指针，而不是它指向的内容。所以，通过你的`arr`指针，你可以做到这一点......

```
arr[0] = 'a'; 
```

...我认为这不是您要防止的。相反，我认为您真正想要的是：

```
const char* arr = static_cast<const char *>(file.get_address()); 
```

...这解决了您发布的问题。这样，您就有了一个指向无法更改的字符的指针（至少不能直接通过该指针）。

然后，在你的循环中，你在整个文件的每个字符上调用 atoi() ，我怀疑这是你真正想要做的。您是否期待一大堆没有分隔符的个位数十进制（以 10 为底）数字？这是以您的方式循环的唯一用例。为了争论，让我们假设这就是你真正想要的。好的，那么，您希望结果到哪里？您没有将 atoi() 的返回值分配给任何东西。您正在将单个数字（可能是 ASCII）数字从文本转换为数字形式，但会丢弃结果。

但我认为这可能不是你真正想要的。

让我们重写您的代码，以便它将文件的第一个文本值（假设它前面没有垃圾）转换为整数，然后打印它。在您的示例中，我们假设文件已经读入某个名为的对象`file`，并且我们可以通过调用来获取其数据缓冲区`file.get_address()`。这就是你想要的：

```
const char* arr = static_cast<const char *>(file.get_address());

int firstNumericValue = atoi(arr);

std::cout << "firstNumericValue = " << firstNumericValue << "\n"; 
```

...就是这样，不需要循环！如果您想从文件中读取多个值，当然可以使用循环，但您需要研究更高级的函数，例如`sscanf()`or `strtol()`。如果您使用 strtol()，它的第二个参数可以让您获得一个指向下一个位置的指针，以便为任何后续调用开始转换。但是这些例子比比皆是，你可以自己研究它们。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:40:08.713

```
atoi(&(arr[i])); 
```

会成功的。

运算符为您提供指向 char的`&`指针，额外的括号确保您获得指向`i`-th 元素的指针。

atoi 不关心数组声明中的 const，所以它在这里不相关。

# python - Ubuntu 12.04 Precise 上的 pyInstaller 可执行文件缺少模块“_struct”

> ID：13941828
> 
> 赞同：2
> 
> 时间：2012-12-18T21:31:59.633
> 
> 标签：python, module, pyinstaller

我想将我的 python 项目打包成一个 UNIX 可执行文件。为此，我尝试了 py2exe、cxfreeze 和 pyInstaller，但没有任何效果。希望你能帮助我使用 pyinstaller。所以这里是：

我从[http://www.pyinstaller.org/](http://www.pyinstaller.org/)下载了 pyinstaller-2.0 的 zipfile并解压。

在文件夹中，我运行`python pyinstaller.py ../helloworld.py`（最后列出的输出）。

然后我尝试执行文件：`./helloworld/dist/helloworld/helloworld` 它给了我输出：

```
mod is NULL - structTraceback (most recent call last):
  File "/usr/lib/python2.7/struct.py", line 1, in <module>
    from _struct import *
ImportError: No module named _struct
mod is NULL - archiveTraceback (most recent call last):
  File "/home/jelle/Downloads/pyinstaller-1.5.1/archive.py", line 42, in <module>
    import struct
ImportError: No module named struct
Traceback (most recent call last):
  File "<string>", line 25, in <module>
ImportError: No module named archive 
```

我正在使用带有 Python 2.7.3 的 Ubuntu 12.04。我的 PYTHONPATH 包括 /usr/lib/python2.7。看起来问题似乎是缺少模块_struct，但我不知道在哪里可以找到它。我已经尝试过 pyinstaller 1.5.1 和开发版本，在这里都不起作用。

请帮忙！

的输出`python pyinstaller.py ../helloworld.py`：

```
 7 INFO: wrote /home/jelle/Downloads/pyinstaller-2.0/helloworld/helloworld.spec
    27 INFO: UPX is not available.
    583 INFO: checking Analysis
    583 INFO: building Analysis because out00-Analysis.toc non existent
    583 INFO: running Analysis out00-Analysis.toc
    702 INFO: Analyzing /home/jelle/Downloads/pyinstaller-2.0/support/_pyi_bootstrap.py
    1570 INFO: Analyzing /home/jelle/Downloads/pyinstaller-2.0/PyInstaller/loader/archive.py
    1637 INFO: Analyzing /home/jelle/Downloads/pyinstaller-2.0/PyInstaller/loader/carchive.py
    1701 INFO: Analyzing /home/jelle/Downloads/pyinstaller-2.0/PyInstaller/loader/iu.py
    1720 INFO: Analyzing ../helloworld.py
    1721 INFO: Hidden import 'encodings' has been found otherwise
    1721 INFO: Looking for run-time hooks
    1721 INFO: Analyzing rthook /home/jelle/Downloads/pyinstaller-2.0/support/rthooks/pyi_rth_encodings.py
    2197 INFO: Looking for Python library libpython2.7.so
    objdump: section '.dynamic' mentioned in a -j option, but not found in any input file
    2308 INFO: Warnings written to /home/jelle/Downloads/pyinstaller-2.0/helloworld/build/pyi.linux2/helloworld/warnhelloworld.txt
    2311 INFO: checking PYZ
    2311 INFO: rebuilding out00-PYZ.toc because out00-PYZ.pyz is missing
    2312 INFO: building PYZ out00-PYZ.toc
    2706 INFO: checking PKG
    2706 INFO: rebuilding out00-PKG.toc because out00-PKG.pkg is missing
    2706 INFO: building PKG out00-PKG.pkg
    2711 INFO: checking EXE
    2712 INFO: rebuilding out00-EXE.toc because helloworld missing
    2712 INFO: building EXE from out00-EXE.toc
    2772 INFO: Appending archive to EXE /home/jelle/Downloads/pyinstaller-2.0/helloworld/build/pyi.linux2/helloworld/helloworld
    2773 INFO: checking COLLECT
    2773 INFO: building COLLECT out00-COLLECT.toc 
```

顺便说一句：我的 helloworld.py 只包含语句 print "hello world"。我尝试将 #!/usr/bin/python2.7 放在顶部。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-09-07T11:41:07.277

检查系统变量 LD_LIBRARY_PATH 的值

```
echo $LD_LIBRARY_PATH 
```

它可能指向错误的 python 库 libpython2.7.so。

就我而言，我可以通过重置它来解决这个问题：

```
export LD_LIBRARY_PATH= 
```

# python - Fabric 可以将 telnet 用于 run() 命令吗？

> ID：13941832
> 
> 赞同：2
> 
> 时间：2012-12-18T21:32:22.697
> 
> 标签：python, telnet, fabric

过去我使用fabric 进行Web 开发，但目前我正在一个没有ssh 但有telnet 的嵌入式系统上做一些工作。

我有很多可以从自动化中受益的测试/安装任务，所以我想知道：

*有没有办法让面料使用 telnet 来执行 run() 和 sudo() 命令？*

是否有与织物类似的工具可以与 telnet 一起使用？我真的只是想避免重新发明轮子来解决一个小麻烦。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T13:15:02.557

您可以使用[pexpect](http://www.noah.org/wiki/pexpect)库，它可以让您进行流程自动化。您可以使用它来自动化诸如 telnet、ftp、vi 之类的东西。对于 telnet，请查看[此脚本](http://code.activestate.com/recipes/152043-simple-telnet-session-scripting/)。这应该是自动化该过程所需的全部内容。您可以将您的 pexpect 代码放入一个结构任务中，然后以这种方式使用结构。但我不确定采用这种方法是否会获得更多额外价值。

# python - 让 pygame 在 python 2.7 和 3 上工作的问题

> ID：13941833
> 
> 赞同：-1
> 
> 时间：2012-12-18T21:32:32.777
> 
> 标签：python, macos, osx-snow-leopard, pygame

我最近在我的 Mac 上安装了 python 2.7 和 3（运行 OSX Snow Leopard）。我也尝试安装 pygame，但是每当我尝试在 2.7 或 3 中导入 pygame 时，我都会收到错误消息：

```
Traceback (most recent call last):
File "<pyshell#0>", line 1, in <module>
import pygame
ImportError: No module named pygame 
```

我知道 pygame 的一个版本已经成功安装，因为当我使用 2.5 版的 python 时，我可以很好地导入它。有谁知道我如何将 pygame 库链接到其他版本？

当我运行这个时：

```
import struct; print( 8 * struct.calcsize("P")) 
```

2.5 版本返回 32，但 3.2 版本返回 64。这可能是问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:36:35.313

每个版本的 python 都有不同的包。去安装python 2.7的包。 [http://www.pygame.org/download.shtml](http://www.pygame.org/download.shtml)

请注意，64 位尚不支持 pygame

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-05-17T13:22:13.150

尝试`sudo pip install pygame`或`sudo easy_install pygame`安装。Pygame 不适用于 python 3。

# php - opauth linkedin 电子邮件

> ID：13941836
> 
> 赞同：0
> 
> 时间：2012-12-18T21:32:46.567
> 
> 标签：php, linkedin

我正在编写一些代码并尝试从linkedin 获取电子邮件地址。我查看了那里的文档以确认他们现在确实支持通过 api 发送电子邮件。

我试图添加“范围”=> r_emailaddress。如果我查看回复的原始部分，我会看到电子邮件地址，但这似乎没有被添加为 ['auth']['info'] 数组作为电子邮件，所以我没有标准的方式来总是从所有人那里收到电子邮件我的各种供应商。

我也尝试了以下但没有成功。

*   $this->mapProfile($profile, 'email', 'info.email-address');
*   $this->mapProfile($profile, 'email', 'email-address');

有什么想法吗？

[http://opauth.org/](http://opauth.org/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-20T18:49:40.183

结果变成了这样。

```
$this->mapProfile($profile, 'email-address', 'info.email'); 
```

您还需要将此添加到linkedinstrategy.php $defaults 变量

```
'scope' => 'r_emailaddress' 
```

# winapi - 如何从资源中获取版本信息？

> ID：13941837
> 
> 赞同：3
> 
> 时间：2012-12-18T21:32:48.737
> 
> 标签：winapi, visual-c++, resources

我在资源中声明了版本信息：

```
100 VERSIONINFO
FILEVERSION 1,0,0,2
PRODUCTVERSION 1,0,0,2
FILEOS VOS_NT
FILETYPE VFT_APP
{
    BLOCK "StringFileInfo"
    {
        BLOCK "000004b0"
        {
            VALUE "FileDescription", "My application"
            VALUE "FileVersion", "1.0.0.2"
            VALUE "InternalName", "app.exe"
            VALUE "LegalCopyright", "Copyright ©  2012 by David."
            VALUE "OriginalFilename", "app.exe"
            VALUE "ProductName", "app"
            VALUE "ProductVersion", "1.0.0.2"
            VALUE "Assembly Version", "1.0.0.2"
        }
    }

    BLOCK "VarFileInfo"
    {
        VALUE "Translation", 0x0000 0x04B0
    }
} 
```

我以这种方式获取版本信息：

```
HRSRC hResInfo;
HGLOBAL hResData;
LPCVOID pRes;
UINT uLen;
VS_FIXEDFILEINFO *lpFfi;

hResInfo = FindResource(hInst, MAKEINTRESOURCE(100), RT_VERSION);
MessageBox(0, "FindResource", 0,0);

hResData = LoadResource(hInst, hResInfo);
MessageBox(0, "LoadResource", 0,0);

pRes = LockResource(hResData);
MessageBox(0, "LockResource", 0,0);

VerQueryValue(pRes, "\\" ,(LPVOID*)&lpFfi, &uLen);
MessageBox(0, "VerQueryValue", 0,0);

FreeResource(hResData);

DWORD dwFileVersionMS = lpFfi->dwFileVersionMS;
DWORD dwFileVersionLS = lpFfi->dwFileVersionLS;

DWORD dwLeftMost     = HIWORD(dwFileVersionMS);
DWORD dwSecondLeft   = LOWORD(dwFileVersionMS);
DWORD dwSecondRight  = HIWORD(dwFileVersionLS);
DWORD dwRightMost    = LOWORD(dwFileVersionLS); 
```

在函数 VerQueryValue 中是一个错误，因为程序中断（带有文本“VerQueryValue”的消息框不显示）并且 Visual C++ 向我显示以下消息：

> ProxyCU.exe 中 0x77bf15a5 处的第一次机会异常：0xC0000005：访问冲突写入位置 0x00483192。

如何修复此代码？

问候，大卫

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2012-12-18T22:16:12.297

`VerQueryValue()`无法直接从原始资源访问版本信息。您必须在内存中制作资源的副本，然后将该内存传递给`VerQueryValue()`。原因是因为`VerQueryValue()`它设计为使用`GetFileVersionInfo()`，它需要用户分配的可写内存块并在该内存中执行某些修复。访问`VS_FIXEDFILEINFO`结构不需要修复，但内存块必须仍然是可写的。您不能将原始资源直接传递给，`VerQueryValue()`因为它是只读内存。

试试这个：

```
HRSRC hResInfo;
DWORD dwSize;
HGLOBAL hResData;
LPVOID pRes, pResCopy;
UINT uLen;
VS_FIXEDFILEINFO *lpFfi;

hResInfo = FindResource(hInst, MAKEINTRESOURCE(100), RT_VERSION);
dwSize = SizeofResource(hInst, hResInfo);
hResData = LoadResource(hInst, hResInfo);
pRes = LockResource(hResData);
pResCopy = LocalAlloc(LMEM_FIXED, dwSize);
CopyMemory(pResCopy, pRes, dwSize);
FreeResource(hResData);

VerQueryValue(pResCopy, TEXT("\\"), (LPVOID*)&lpFfi, &uLen);

DWORD dwFileVersionMS = lpFfi->dwFileVersionMS;
DWORD dwFileVersionLS = lpFfi->dwFileVersionLS;

DWORD dwLeftMost     = HIWORD(dwFileVersionMS);
DWORD dwSecondLeft   = LOWORD(dwFileVersionMS);
DWORD dwSecondRight  = HIWORD(dwFileVersionLS);
DWORD dwRightMost    = LOWORD(dwFileVersionLS);

LocalFree(pResCopy); 
```

**更新：**这仅在您仅访问`VS_FIXEDFILEINFO`结构时才有效。如果您需要访问任何其他值，则必须使用`GetFileVersionInfo()`. 根据 Raymond Chen 的博客：

[VerQueryValue 的第一个参数确实必须是您从 GetFileVersionInfo 获得的缓冲区](https://devblogs.microsoft.com/oldnewthing/20061226-06/?p=28603)

> 文档说 VerQueryValue 的第一个参数必须是 GetFileVersionInfo 函数返回的缓冲区，这是有原因的。**GetFileVersionInfo 返回的缓冲区是一个不透明的数据块，专门格式化以便 VerQueryValue 可以工作**。您不应该查看该缓冲区的内部，当然也不能尝试“以其他方式获取数据”。因为**如果您这样做，VerQueryValue 将在缓冲区中查找未按照函数期望的方式格式化的内容。**

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2016-05-26T11:28:22.213

以上将在调试模式下创建一个堆损坏错误消息，例如“Free Heap block b753e70 modified at b753ed4 after it was freed”。很多年前有人在[http://microsoft.public.win32.programmer.kernel.narkive.com/mqoHgVwM/verqueryvalue-bug](http://microsoft.public.win32.programmer.kernel.narkive.com/mqoHgVwM/verqueryvalue-bug)上发布了这个问题。今天仍在发生。可以通过使 dwSize 足够大来使消息消失，例如将其乘以 4。

# css - CSS 翻转 1 div 和另一个 div 更改

> ID：13941838
> 
> 赞同：0
> 
> 时间：2012-12-18T21:32:51.783
> 
> 标签：css, hover, rollover

我的客户想要的是，当您将鼠标悬停在浅橙色上时，它会变成深橙色，这很容易，但是当您到达按钮的中心并将鼠标悬停在深橙色上时，它会变成浅橙色（这就是我我很难相处..请指教

![在此处输入图像描述](../Images/71866dcd34134478c06263ace0f52094.png)

```
<a href="#"><div class="buttonblue">
<div class="buttontitle">local businesses</div>
<div class="buttonaction_blue">NEXT</div>
<div class="buttonsmallprint">Leverage online</div>
</div></a> 
```

css

```
.buttontitle { 
 font-family: 'BebasNeueRegular', Arial, sans-serif;
 letter-spacing: 0;
 padding:4px 0px 4px 0px;
 font-size:36px; 
 color:#fff;
 text-align:center;
 } 
 .buttonaction_blue:hover
  {
    background-color:#418dc7
  }  
  .buttonaction_blue 
 {
  width:355px; 
  margin:0 auto;
  background-color:#4795d1;
  -webkit-border-radius: 2px; 
  -moz-border-radius: 2px;
  border-radius: 2px;
  font-family: 'Oxygen', sans-serif; 
  font-size:32px; 
  text-align:center;  
  color:#fff;
  padding:10px 0px 10px 0px; 
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:02:42.397

你说

```
"What my client wants is when you hover over the light orange it changes to the dark orange" 
```

如果您想要浅橙色（在您的示例中即提供的蓝色）变为深色并且深橙色没有变化然后替换它

```
.buttonaction_blue:hover
{
background-color:#418dc7
} 
```

和

```
.buttonblue:hover
{
background-color:#5BCAE9;
} 
```

或如果您想要浅橙色（在您的示例中为蓝色，即提供）更改为深橙色，深橙色更改为浅橙色，然后添加此

```
 .buttonblue:hover
{
background-color:#418dc7;
} 
```

[jsfiddle](http://jsfiddle.net/J9yhf/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:03:07.207

看起来您只是想将 :hover 堆叠在 div 上：

[http://jsfiddle.net/tSZ2u/1/](http://jsfiddle.net/tSZ2u/1/)

```
.buttonaction_blue:hover {
     background-color:#5BCAE9
}

.buttonblue:hover {
     background-color: #4795d1;
} 
```

如果向 bluebutton 和 buttonaction_blue 添加悬停可以解决问题，那就太好了。如果没有，则项目的父级没有 CSS 选择器（此时）。您需要使用 .parent() 查看一些 jQuery：http: [//api.jquery.com/parent/](http://api.jquery.com/parent/)

# c# - MVC 4 登录/SimpleMembership 是如何工作的

> ID：13941840
> 
> 赞同：5
> 
> 时间：2012-12-18T21:33:00.293
> 
> 标签：c#, asp.net, asp.net-mvc-4

我希望将我的项目从 ASP.NET Web 窗体升级到 MVC 4。

在升级过程中，我试图重新评估我们处理身份验证和登录的方式。

目前，当用户尝试登录时，我（前端）调用数据库进行验证，然后返回为 yay 或 nay 并带有关联的“令牌”。然后，我必须将该令牌传递到我们网站上的下一页，然后将其放入 javascript 对象中。然后，每次调用 ajax 时都会传递该令牌，并在每次调用后使用新令牌进行更新。我个人在客户端浏览器中管理该令牌。

现在，在 MVC 4 中，默认的 Internet 应用程序带有使用某种形式的本地注册和登录所需的逻辑。但我不明白它是如何工作的。

**在用户“注册”之后，它会存储在哪里？**

**当用户登录然后更改页面时，该用户如何保持登录状态？他的凭据如何传递？**

在我看来，我们处理登录的当前方式已经严重过时且存在缺陷。但此时我不明白如何设置 MVC 来查看我们当前的（外部，它不在这个项目中）数据库来验证用户。

我有一本关于 MVC 4 的书，但似乎没有详细说明它是如何工作的。

任何帮助，将不胜感激。

谢谢！

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T21:42:18.943

> 用户“注册”后存储在哪里

如果您使用 VS2012、ASP.NET MVC 4，它会将用户存储在[`LocalDB`](http://msdn.microsoft.com/en-us/library/hh510202.aspx). 这是使用 new 的默认开箱即用实现[`Simple Membership Provider`](http://weblogs.asp.net/jgalloway/archive/2012/08/29/simplemembership-membership-providers-universal-providers-and-the-new-asp-net-4-5-web-forms-and-asp-net-mvc-4-templates.aspx)。

> 当用户登录然后更改页面时，该用户如何保持登录状态？他的凭据如何传递？

当前经过身份验证的用户存储在加密的[`Forms Authentication`](http://msdn.microsoft.com/en-us/library/ff647070.aspx)cookie 中。查看`LogOn`发出此 cookie 的 POST 操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-12-18T21:41:15.973

我有一个类似的问题，你可以**[在这里](https://stackoverflow.com/questions/13000824/mvc-4-connectionstring-to-sql-server-2012)**看到我的帖子，但我找到并使用的解决方案来自**[这篇文章](http://www.dwdmbi.com/2012/09/visual-studio-2012-uses.html)**。它非常详细地介绍了新的 SimpleMembership 系统的工作原理。

最大的变化是您不再需要任何 aspnet_regsql 的东西了。注册后，将为用户创建数据库模式以及一行。无需 SP 或视图！

# delphi - DCC 错误：E2003 未声明的标识符：“结果”

> ID：13941841
> 
> 赞同：1
> 
> 时间：2012-12-18T21:33:01.837
> 
> 标签：delphi, debugging, syntax-error

我在我的编译器上搞乱了调试设置，现在我得到了这些我似乎无法摆脱的错误。

**[DCC 错误] HASPCODE.PAS(223)：E2003 未声明的标识符：“结果”**

它以前没有抱怨，但现在无论我对它说什么调试设置都会只针对 HASPCODE.PAS 文件引发上述错误。

例如，Here 是引发错误的函数之一。

```
function THasp.IsHasp:Boolean;
begin
  Result := fIsHasp; <<=======
end; 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-12-18T21:40:58.627

隐式函数 Result 变量仅在启用[扩展语法编译器](http://docwiki.embarcadero.com/RADStudio/XE3/en/Extended_syntax_%28Delphi%29)选项时可用。

> 结果变量。在 {$X+} 模式下，预定义的变量 Result 可以在函数体内使用来保存函数的返回值。

# c# - 如何在 Visual Studio 中有条件地包含 XML

> ID：13941842
> 
> 赞同：0
> 
> 时间：2012-12-18T21:33:13.573
> 
> 标签：c#, xml, visual-studio, debugging

我的 C# 程序中有一些测试代码，我使用 #if 和调试变量有条件地包含/排除这些代码。

我还想有条件地包含/排除相关 XML 文件中的一些设置。现在我只是用 XML 注释排除它们，但我想找到一种方法，根据我用于 C# 代码的相同调试变量有条件地包含/排除它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T22:58:03.287

请参阅[web.config 转换](http://msdn.microsoft.com/en-us/library/dd465326.aspx)。它们允许为每个构建配置自动更改 web.config 文件（在 VS2012 中，为每个部署环境）。

# .htaccess - 当强制使用斜杠时，我的 href 已更改

> ID：13941846
> 
> 赞同：1
> 
> 时间：2012-12-18T21:33:35.493
> 
> 标签：.htaccess, mod-rewrite, href

我的 .htaccess 代码如下：

```
 Options +FollowSymLinks 
  RewriteEngine On
  RewriteBase /
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_URI} !(\.[a-zA-Z0-9]{1,5}|/|#(.*))$
  RewriteRule ^(.*)$ $1/ [R=301,L]

  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteCond %{REQUEST_FILENAME}\.php -f
  RewriteRule ^([^\.]+)/$ $1.php 
```

它对我很有用，因为如果我使用 www.domain.com/login 链接，我会返回以下 www.domain.com/login/ ，这很好。唯一的问题是，我的 href 链接变为：www.domain.com/login/login，这非常糟糕。当然，当我单击它时，我会收到 404 错误，这是正常的。

任何人都可以帮助避免这个问题！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:58:12.550

听起来像是相对路径与绝对路径的问题。当您被重定向到`/login/`时，基本 URI 将`/login/`变为`/`. 因此，要么将您的 href 设为绝对 URI，要么指定一个基数：

```
<a href="/login/">link</a> 
```

或将其添加到页面的标题中：

```
<base href="/"> 
```

# facebook - 如何获取 FB.Canvas.getPageInfo 的“scrollTop”值

> ID：13941847
> 
> 赞同：2
> 
> 时间：2012-12-18T21:33:40.290
> 
> 标签：facebook, facebook-javascript-sdk, facebook-iframe, facebook-canvas

到目前为止，我可以提醒“ [FB.Canvas.getPageInfo](http://developers.facebook.com/docs/reference/javascript/FB.Canvas.getPageInfo/) ”的“scrollTop”值：

```
FB.Canvas.getPageInfo(
      function(info) {
          alert('scrollTop: ' + info.scrollTop);
      }
  ); 
```

现在我想在我的一个函数中使用这个值，但我不知道如何。以下不起作用：

```
function test() {
    var fbScrollTop = FB.Canvas.getPageInfo();
    alert(fbScrollTop);
} 
```

如何访问该值？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-20T01:55:19.487

我不知道它是否有用。但现在我可以在我的 facebook 应用程序中将我的 div 居中。这是功能：

```
jQuery.fn.center = function () {
    var temp = this;
    FB.Canvas.getPageInfo(
    function(info) {
            $(temp).css("position","absolute");
            $(temp).css("top", Math.max(0, ((info.clientHeight - $(temp).outerHeight()) / 2) + info.scrollTop) + "px");
            $(temp).css("left", Math.max(0, ((info.clientWidth - $(temp).outerWidth()) / 2) + info.scrollLeft) + "px");
        }
    );

    return this;
} 
```

我这样使用：

```
var loading = $("#loading");
    loading.center(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T19:34:40.643

SDK 中可用的大多数方法都是*异步*的- 这意味着在调用提供的回调（使用响应）之前，响应将不可用。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-19T11:12:31.293

只需将两者结合起来

```
function test() {
    var fbScrollTop;
    FB.Canvas.getPageInfo(function(info) {
        fbScrollTop = info.scrollTop;
        alert(fbScrollTop);
    });
} 
```

# ruby-on-rails-3 - 如何检查 ActiveRecord 表条目是否为空

> ID：13941848
> 
> 赞同：1
> 
> 时间：2012-12-18T21:33:53.353
> 
> 标签：ruby-on-rails-3, postgresql, activerecord

我不确定这个问题的标题是否使用了正确的术语，但希望这个描述会有所帮助。如果您需要更多信息，请告诉我。

我从表单中获取中文文本并将其拆分为二维的句子和单词数组。然后，我想使用数据库中的字典条目定义所有单词。有些词不在数据库中，所以我想检查一下。我正在尝试的方法不起作用。

这是我当前的代码：

```
<% @lesson.parsed_content.each_with_index do |sentence, si| %> #iterate 1st dimension
  <% sentence.each_with_index do |word,wi| %> #iterate 2nd dimension
    <% sentence = sentence.to_s %>
    <div class="word blt" id="<%= wi %>">
    <div class="definition blt">
        <% definition = DictionaryEntry.where(:simplified => word) %> #search by simplified chinese
        <% definition.find_each do |w| %>
        <% if w.definition == nil %> # PROBLEM: this never returns true.
            <%= word %>
            <% else %>
        <%= w.definition %>
        <% end %>
        <% end %>
    </div>
    <div class='chinese blt'> <%= word %></div>
    </div>
  <% end %>
<% end %> 
```

`<% if w.definition == nil %>`如果我的数据库中没有定义，如何更改为返回 true？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T22:16:35.710

这是在黑暗中拍摄的，但首先我会在您将变量句子转换为字符串并循环遍历它时切换您的代码。（除非你有理由这样做）

```
<% sentence = sentence.to_s %>
<% sentence.each_with_index do |word,wi| %> #iterate 2nd dimension 
```

其次，根据您的数据在数据库中的放置方式，它可能是一个空字符串而不是 nil。所以我会改变条件

```
<% if w.definition == nil %> # PROBLEM: this never returns true. 
```

到

```
<% if w.definition.blank? %> # Checks to see if definition is blank 
```

Blank 将检查其是否为假、空或空白字符串。

最后，缩进很有帮助，尤其是在运行循环和条件时。它在眼睛上更容易，并帮助您了解正在发生的事情。

```
<% @lesson.parsed_content.each_with_index do |sentence, si| %> 
  <% sentence = sentence.to_s %>
  <% sentence.each_with_index do |word,wi| %> 
    <div class="word blt" id="<%= wi %>">
      <div class="definition blt">
      <% definition = DictionaryEntry.where(:simplified => word) %> 
      <% if definition.empty? %>
        <% word %>
      <% else %>  
        <% definition.find_each do |w| %>
          <%= w.definition %>
        <% end %>
      <% end %>
      </div>
      <div class='chinese blt'> <%= word %></div>
    </div>
  <% end %>
<% end %> 
```

让我知道结果。

# sql - 使用 add_months 将日期添加到表中

> ID：13941855
> 
> 赞同：0
> 
> 时间：2012-12-18T21:34:27.817
> 
> 标签：sql, oracle, insert

我正在创建一个表格，其中包含员工的开始和结束日期，我正在尝试找到最简单的方法来确定该人员的结束日期。结束日期基于开始日期和合同期限，两者位于同一个`Insert`. 这就是我刚刚尝试的（我之前的尝试比这更残酷）：

```
Insert Into EMPHIREINFO (empno, empname, startdt, enddt, cntrlgth)
Values (7566,'JONES', to_date('2011/10/15', 'yyyy/mm/dd'),add_months(startdt,cntrlgth), 12); 
```

我已经使用`add_months`过，`Update`所以我尝试使用它的`Insert`成功率要低得多。我认为这可能是因为我在插入之前使用了 cntrlgth，但即使我硬编码了我想要添加的月份数，我仍然会出错。

如果有人感兴趣，这是错误：

```
00933\. 00000 -  "SQL command not properly ended" 
```

任何帮助表示赞赏，谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:36:34.020

您不能在插入中引用其他列。两者都需要写表达式：

```
Insert Into EMPHIREINFO (empno, empname, startdt, enddt, cntrlgth)
Values (7566,'JONES', to_date('2011/10/15', 'yyyy/mm/dd'),
        add_months(to_date('2011/10/15', 'yyyy/mm/dd'),12), 12); 
```

# javascript - Marionette.js ItemView - 将子视图放在区域中

> ID：13941862
> 
> 赞同：8
> 
> 时间：2012-12-18T21:34:54.663
> 
> 标签：javascript, backbone.js, marionette

我有以下`ItemView`模板，其中填充了客户数据（名字、姓氏），我想将 a 添加`CollectionView`到 div`.addresses`中。

模板

```
<script type="text/html" id="template-customer-details">
    <h4><%= firstName %> <%= lastName %></h4>
    <button class="edit">Edit</button>
    <h5>Addresses</h5>
    <div class="addresses">...</div>
</script> 
```

布局

```
Layout.Details = Backbone.Marionette.ItemView.extend({
    template: '#template-customer-details',

    regions: {
        addresses: ".addresses"
    },

    serializeData: function () {
        return this.model.attributes;
    },

    initialize: function () {

        this.addressList = new App.Models.AddressList();

        // Error!
        this.regions.addresses.show(this.addressList);

        this.bindTo(this, "render", this.$el.refresh, this.$el);
        this.model.bind("change", this.render.bind(this));
    }
}); 
```

我收到错误“Uncaught TypeError: Object .addresses has no method 'show'”。

我必须等到视图加载吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-12-18T21:51:03.370

我认为你的事情有点混乱。An`ItemView`不会对`regions`属性做任何事情（您可能正在考虑`Application`类），因此当您尝试调用时`this.regions.addresses.show`，它与调用`".addresses".show`.

我认为您可能希望`CompositeView`在这种情况下使用 a，因为它结合了一个`ItemView`（您可以将其用于您的客户数据）和一个`CollectionView`您可以用于您的 AddressList。您还需要为地址定义一个单独`ItemView`的地址（因为`CollectionView`只是`ItemView`为集合中的每个项目创建一个）。

有点像这样（我没有测试过，所以可能不完全正确）：

```
AddressView = Backbone.Marionette.ItemView.extend({
    template: '#addressTemplate'
});

Layout.Details = Backbone.Marionette.CompositeView.extend({
    template: '#template-customer-details',
    itemView: AddressView,
    itemViewContainer: '.addresses'
});

// Then create your view something like this:
new Layout.Details({
  model: new App.Models.CustomerDetails(),
  collection: new App.Models.AddressList()
}); 
```

我也不认为您需要像在您的示例中那样专门绑定更改和渲染事件，因为木偶通常会处理这一点（与您的 serializeData 实现相同，看起来与默认实现大致相同）

# eclipse - IProgressMonitor 作为 eclipse 插件编程中的参数

> ID：13941868
> 
> 赞同：6
> 
> 时间：2012-12-18T21:35:05.363
> 
> 标签：eclipse, eclipse-plugin, progressmonitor

我看到很多 Eclipse 插件 API 都`IProgressMonitor`将其作为参数之一。

```
void setRawClasspath(IClasspathEntry[] entries, IProgressMonitor monitor)
    throws JavaModelException; 
```

1.  这个 IProgressMonitor 是做什么用的？你有什么好的例子吗？
2.  可以传给`null`它吗？还是我必须创建并传递一个对象 ( `new ProgressMonitor()`)？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-12-18T23:45:21.880

1)`IProgressMonitor`为被调用者提供向调用者报告进度而不仅仅是状态的方法。您可以在[http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html](http://www.eclipse.org/articles/Article-Concurrency/jobs-api.html)的文章中找到示例，以及在整个 Eclipse SDK 中的使用。

2)`null`只有当该方法的 JavaDoc 说它是时才可以。否则，假设应该不是。在禁止但您仍然需要提供`NullProgressMonitor`的情况下，该实现很有用。`null`

# linux - 如何始终如一地从串行端口记录数据？

> ID：13941871
> 
> 赞同：11
> 
> 时间：2012-12-18T21:35:11.760
> 
> 标签：linux, putty, udev

我需要处理两个自定义硬件，它们都通过两个串行连接发送调试数据。这些串行连接通过两个串行到 USB 转换器。串行转 USB 设备具有相同的供应商编号、设备编号，并且显然具有相同的序列号。

这是问题所在：我想分别记录两个串行端口。自定义硬件需要不断重启，它们是否附加到相同的硬件`/dev/ttyUSB*`是完全随机的。我怎样才能让他们每次都选择相同的设备路径？我可以让它依赖于它插入的端口，但这似乎有点hacky。

因此，我对 udevadm 的输出进行了比较，如下所示：

```
$ udevadm info -a -p `udevadm info -q path -n /dev/ttyUSB1` > usb1
$ udevadm info -a -p `udevadm info -q path -n /dev/ttyUSB2` > usb2
$ diff usb1 usb2 
```

[diff的输出很长；在这里你可以看到它](https://gist.github.com/4332185)

Grepping for serial（两者相同）：

```
$ udevadm info -a -p `udevadm info -q path -n /dev/ttyUSB2` | grep serial
SUBSYSTEMS=="usb-serial"
ATTRS{serial}=="0001"
ATTRS{serial}=="0000:00:1d.7" 
```

其他信息：

我正在使用 PuTTY 从串行端口读取数据。
操作系统：

```
$ uname -a
Linux xxxxxxxx.localdomain 2.6.32-279.14.1.el6.x86_64 #1 SMP Tue Nov 6 23:43:09 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:30:12.257

请检查usb-serial转换器是否基于ftdi芯片？（您可以检查驱动程序文件名）

如果是这样; 您有机会更改序列号，甚至是制造商信息。

[http://www.ftdichip.com/Support/Utilities.htm](http://www.ftdichip.com/Support/Utilities.htm) 检查工具；MProg 和 FT_PROG 实用工具。

# cuda - 使用非均匀节点点优化 CUDA 内核插值

> ID：13941872
> 
> 赞同：3
> 
> 时间：2012-12-18T21:35:14.653
> 
> 标签：cuda, interpolation

**原始问题**

我有以下内核使用非均匀节点点执行插值，我想对其进行优化：

```
__global__ void interpolation(cufftDoubleComplex *Uj, double *points, cufftDoubleComplex *result, int N, int M)
{
    int i = threadIdx.x + blockDim.x * blockIdx.x;

    int PP;
    double P;
    const double alfa=(2.-1./cc)*pi_double-0.01;
    double phi_cap_s;
    cufftDoubleComplex temp;

    double cc_points=cc*points[i];
    double r_cc_points=rint(cc*points[i]);

    temp = make_cuDoubleComplex(0.,0.);

    if(i<M) {   
        for(int m=0; m<(2*K+1); m++) {
            P = (K*K-(cc_points-(r_cc_points+m-K))*(cc_points-(r_cc_points+m-K)));

            if(P>0.)  phi_cap_s = (1./pi_double)*((sinh(alfa*sqrt(P)))/sqrt(P));  
            if(P<0.)  phi_cap_s = (1./pi_double)*((sin(alfa*sqrt(-P)))/sqrt(-P));   
            if(P==0.) phi_cap_s = alfa/pi_double;        

            PP = modulo((r_cc_points + m -K ),(cc*N)); 
            temp.x = temp.x+phi_cap_s*Uj[PP].x; 
            temp.y = temp.y+phi_cap_s*Uj[PP].y; 
        } 

        result[i] = temp; 
    }
} 
```

K 和 cc 是常数，points 包含节点，Uj 包含要插值的值。modulo 是一个基本上作为 % 工作的函数，但适当地扩展到负值。对于某种安排，内核调用需要 2.3 毫秒。我已经证实最昂贵的零件是

```
 if(P>0.)  phi_cap_s = (1./pi_double)*((sinh(alfa*sqrt(P)))/sqrt(P));  
            if(P<0.)  phi_cap_s = (1./pi_double)*((sin(alfa*sqrt(-P)))/sqrt(-P));   
            if(P==0.) phi_cap_s = alfa/pi_double; 
```

这大约需要总时间的 40%，并且

```
 PP = modulo((r_cc_points + m -K ),(cc*N)); 
        temp.x = temp.x+phi_cap_s*Uj[PP].x; 
        temp.y = temp.y+phi_cap_s*Uj[PP].y; 
```

这大约需要 60%。通过 Visual Profiler，我已经验证了前者的性能不受`if`语句存在的影响。请注意，我想要双精度，所以我避免使用 __exp() 解决方案。我怀疑，对于后者，“随机”内存访问 Uj[PP] 可能是造成这么多计算百分比的原因。关于减少计算时间的技巧或评论有什么建议吗？提前致谢。

**以下评论和答案的版本**

按照答案和评论中提供的建议，我最终得到了以下代码：

```
__global__ void interpolation(cufftDoubleComplex *Uj, double *points, cufftDoubleComplex *result, int N, int M)
{
    int i = threadIdx.x + blockDim.x * blockIdx.x;

    int PP;
    double P,tempd;
    const double alfa=(2.-1./cc)*pi_double-0.01;
    cufftDoubleComplex temp = make_cuDoubleComplex(0.,0.);

    double cc_points=cc*points[i];
    double r_cc_points=rint(cc_points);

    cufftDoubleComplex rtemp[(2*K+1)];
    double phi_cap_s[2*K+1];

    if(i<M) {   
     #pragma unroll //unroll the loop
     for(int m=0; m<(2*K+1); m++) {
         PP = modulo(((int)r_cc_points + m -K ),(cc*N)); 
            rtemp[m] = Uj[PP]; //2

         P = (K*K-(cc_points-(r_cc_points+(double)(m-K)))*(cc_points-(r_cc_points+(double)(m-K))));
         if(P<0.) {tempd=rsqrt(-P); phi_cap_s[m] = (1./pi_double)*((sin(alfa/tempd))*tempd);  }
         else if(P>0.) {tempd=rsqrt(P); phi_cap_s[m] = (1./pi_double)*((sinh(alfa/tempd))*tempd); }
         else phi_cap_s[m] = alfa/pi_double;  
     }

     #pragma unroll //unroll the loop
     for(int m=0; m<(2*K+1); m++) {
         temp.x = temp.x+phi_cap_s[m]*rtemp[m].x; 
           temp.y = temp.y+phi_cap_s[m]*rtemp[m].y; 
     } 

     result[i] = temp; 
     }
 } 
```

特别是： 1) 我将全局内存变量 Uj 移动到大小为 2*K+1 的寄存器 rtemp 数组中（在我的例子中，K 是一个等于 6 的常数）；2) 我将变量 phi_cap_s 移动到一个 2*K+1 大小的寄存器；3）我使用了if ... else语句而不是之前使用的三个if语句（条件P<0.和P>0.发生概率相同）；3）我为平方根定义了额外的变量；4）我用的是rsqrt而不是sqrt（据我所知，sqrt()是CUDA计算的1/rsqrt()）；

我一次添加了每个新功能，验证了对原始版本的改进，但我必须说，它们都没有给我任何相关的改进。

执行速度受限于： 1) sin/sinh 函数的计算（大约 40% 的时间）；有没有办法通过以某种方式利用内在数学作为“起始猜测”来以双精度算术计算它们？2) 由于映射索引 PP，许多线程最终访问相同的全局内存位置 Uj[PP]；避免它的一种可能性是使用共享内存，但这意味着强大的线程合作。

我的问题是。我完成了吗？也就是说，有没有办法改进代码？我通过 NVIDIA Visual Profiler 分析了代码，结果如下：

```
IPC = 1.939 (compute capability 2.1);
Global Memory Load Efficiency = 38.9%;
Global Memory Store Efficiency = 18.8%;
Warp Execution Efficiency = 97%;
Instruction Replay Overhead = 0.7%; 
```

最后，我想注意到这个讨论与[CUDA 上的讨论有关：CUDA 中的一维三次样条插值](https://stackoverflow.com/questions/10859322/cuda-1-dimensional-cubic-spline-interpolation-in-cuda)

**使用共享内存的版本**

我已经对使用共享内存进行了可行性研究。我已经考虑`N=64`使整体`Uj`适合共享内存。下面是代码（基本上是我的原始版本）

```
 __global__ void interpolation_shared(cufftDoubleComplex *Uj, double *points, cufftDoubleComplex *result, int N, int M)
 {
         int i = threadIdx.x + blockDim.x * blockIdx.x;

     int PP;
     double P;
     const double alfa=(2.-1./cc)*pi_double-0.01;
     double phi_cap_s;
     cufftDoubleComplex temp;

     double cc_points=cc*points[i];
     double r_cc_points=rint(cc*points[i]);

     temp = make_cuDoubleComplex(0.,0.);

     __shared__ cufftDoubleComplex Uj_shared[128];

     if (threadIdx.x < cc*N) Uj_shared[threadIdx.x]=Uj[threadIdx.x];

     if(i<M) {  
         for(int m=0; m<(2*K+1); m++) {
         P = (K*K-(cc_points-(r_cc_points+m-K))*(cc_points-(r_cc_points+m-K)));

         if(P>0.)  phi_cap_s = (1./pi_double)*((sinh(alfa*sqrt(P)))/sqrt(P));  
         if(P<0.)  phi_cap_s = (1./pi_double)*((sin(alfa*sqrt(-P)))/sqrt(-P));  
         if(P==0.) phi_cap_s = alfa/pi_double;        

         PP = modulo((r_cc_points + m -K ),(cc*N)); 
         temp.x = temp.x+phi_cap_s*Uj_shared[PP].x; 
         temp.y = temp.y+phi_cap_s*Uj_shared[PP].y; 
      } 

      result[i] = temp; 
    }
 } 
```

结果再次没有显着改善，尽管这可能取决于输入数组的小尺寸。

**详细的 PTXAS 输出**

```
ptxas : info : Compiling entry function '_Z13interpolationP7double2PdS0_ii' for 'sm_20'
ptxas : info : Function properties for _Z13interpolationP7double2PdS0_ii
  352 bytes stack frame, 0 bytes spill stores, 0 bytes spill loads
ptxas : info : Used 55 registers, 456 bytes cumulative stack size, 52 bytes cmem[0] 
```

**P 的值，对于第一个 WARP 和 m=0**

```
 0.0124300933082964
 0.0127183892149176
 0.0135847002913749
 0.0161796378170038
 0.0155488126345702
 0.0138890822153499
 0.0121163187739057
 0.0119998374528905
 0.0131600831194518
 0.0109574866163769
 0.00962949548477354
 0.00695850974164358
 0.00446426651940612
 0.00423369284281705
 0.00632921297092537
 0.00655137618976198
 0.00810202954519923
 0.00597974034698723
 0.0076811348379735
 0.00604267951733561
 0.00402922460255439
 0.00111841719893846
 -0.00180949615796777
 -0.00246283218698551
 -0.00183256444286428
 -0.000462696661685413
 0.000725108980390132
 -0.00126793006072035
 0.00152263101649197
 0.0022499598348702
 0.00463681632275836
 0.00359856091027666 
```

**模函数**

```
__device__ int modulo(int val, int modulus)
{
   if(val > 0) return val%modulus;
   else
   {
       int P = (-val)%modulus;
       if(P > 0) return modulus -P;
       else return 0;
   }
} 
```

**根据答案优化模函数**

```
__device__ int modulo(int val, int _mod)
{
    if(val > 0) return val&(_mod-1);
    else
    {
        int P = (-val)&(_mod-1);
        if(P > 0) return _mod -P;
        else return 0;
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-27T22:29:11.617

```
//your code above
cufftDoubleComplex rtemp[(2*K+1)] //if it fits into available registers, assumes K is a constant

if(i<M) {   
#pragma unroll //unroll the loop
    for(int m=0; m<(2*K+1); m++) {

        PP = modulo((r_cc_points + m -K ),(cc*N)); 
        rtemp[m] = Uj[PP]; //2
    }
#pragma unroll
    for(nt m=0; m<(2*K+1); m++) {
        P = (K*K-(cc_points-(r_cc_points+m-K))*(cc_points-(r_cc_points+m-K)));
        // 1
        if(P>0.)  phi_cap_s = (1./pi_double)*((sinh(alfa*sqrt(P)))/sqrt(P));  
        else if(P<0.)  phi_cap_s = (1./pi_double)*((sin(alfa*sqrt(-P)))/sqrt(-P));   
        else phi_cap_s = alfa/pi_double;  

        temp.x = temp.x+phi_cap_s*rtemp[m].x; //3
        temp.y = temp.y+phi_cap_s*rtemp[m].y; 
    }

    result[i] = temp; 
} 
```

## 解释

1.  添加 else if 和 else 因为这些条件是互斥的，如果可以的话，您应该在发生概率之后对语句进行排序。例如，如果 P<0。大多数时候，您应该首先评估它。

2.  这会将请求的内存获取到多个寄存器，您之前所做的可能肯定会导致该线程上的阻塞，因为没有及时可用的内存进行计算。请记住，如果一个线程在一个经线中阻塞，则整个经线都将被阻塞。如果就绪队列中没有足够的 warp，程序将阻塞，直到任何 warp 准备好。

3.  我们现在已经及时将计算向前推进，以补偿错误的内存访问，希望之前完成的计算已经补偿了错误的访问模式。

这应该起作用的原因如下：

来自 GMEM 中的内存的请求大约是 >~400-600 滴答。如果一个线程试图对当时不可用的内存执行操作，它将阻塞。这意味着如果每个内存请求不在 L1-L2 中，则每个 warp 必须等待该时间或更长时间才能继续。

我怀疑是`temp.x+phi_cap_s*Uj[PP].x`这样做的。通过分阶段（第 2 步）将每个内存传输到一个寄存器，然后继续下一个阶段，您将通过允许您在内存传输时执行其他工作来隐藏延迟。

当您到达第 3 步时，内存有望可用，否则您必须等待更少的时间。

如果`rtemp`不适合收银机以实现 100% 的入住率，您可能必须分批进行。

您也可以尝试制作`phi_cap_s`一个数组并将其放入第一个循环中，如下所示：

```
#pragma unroll //unroll the loop
    for(int m=0; m<(2*K+1); m++) {
        //stage memory first
        PP = modulo((r_cc_points + m -K ),(cc*N)); 
        rtemp[m] = Uj[PP]; //2

        P = (K*K-(cc_points-(r_cc_points+m-K))*(cc_points-(r_cc_points+m-K)));
        // 1
        if(P>0.)  phi_cap_s[m] = (1./pi_double)*((sinh(alfa*sqrt(P)))/sqrt(P));  
        else if(P<0.)  phi_cap_s[m] = (1./pi_double)*((sin(alfa*sqrt(-P)))/sqrt(-P));   
        else phi_cap_s[m] = alfa/pi_double; 

    }
#pragma unroll
    for(nt m=0; m<(2*K+1); m++) {
        temp.x = temp.x+phi_cap_s[m]*rtemp[m].x; //3
        temp.y = temp.y+phi_cap_s[m]*rtemp[m].y; 
    } 
```

## 编辑

表达

```
P = (K*K-(cc_points-(r_cc_points+(double)(m-K)))*(cc_points-(r_cc_points+(double)(m-K)))); 
```

可以分解为：

```
const double cc_diff = cc_points-r_cc_points;
double exp = cc_diff - (double)(m-K);
exp *= exp;
P = (K*K-exp); 
```

这可能会减少使用的指令数量。

## 编辑 2

```
__global__ void interpolation(cufftDoubleComplex *Uj, double *points, cufftDoubleComplex *result, int N, int M)
{
    int i = threadIdx.x + blockDim.x * blockIdx.x;

    int PP;
    double P,tempd;

    cufftDoubleComplex rtemp[(2*K+1)];
    double phi_cap_s[2*K+1];

    if(i<M) {
         const double cc_points=cc*points[i];
         cufftDoubleComplex temp = make_cuDoubleComplex(0.,0.);

         const double alfa=(2.-1./cc)*pi_double-0.01;

         const double r_cc_points=rint(cc_points);
         const double cc_diff = cc_points-r_cc_points;

     #pragma unroll //unroll the loop
         for(int m=0; m<(2*K+1); m++) {
             PP = m-k; //reuse PP
             double exp = cc_diff - (double)(PP); //stage exp to be used later, will explain

             PP = modulo(((int)r_cc_points + PP ),(cc*N)); 
             rtemp[m] = Uj[PP]; //2

             exp *= exp;
             P = (K*K-exp);

             if(P<0.) {tempd=rsqrt(-P); phi_cap_s[m] = (1./pi_double)*((sin(alfa/tempd))*tempd);  }
             else if(P>0.) {tempd=rsqrt(P); phi_cap_s[m] = (1./pi_double)*((sinh(alfa/tempd))*tempd); }
             else phi_cap_s[m] = alfa/pi_double;  
         }

     #pragma unroll //unroll the loop
         for(int m=0; m<(2*K+1); m++) {
             temp.x = temp.x+phi_cap_s[m]*rtemp[m].x; 
             temp.y = temp.y+phi_cap_s[m]*rtemp[m].y; 
         } 

     result[i] = temp; 
     }
 } 
```

我所做的是在 if 语句中的所有计算中移动，以在计算和内存获取方面释放一些资源，不知道你在第一个 if 语句上的分歧`if(i<M)`。在`m-K`代码中出现了两次，我先把它放在`PP`你计算`exp`和的时候使用`PP`。

你还能做的就是尝试对你的指令进行排序，这样，如果你设置了一个变量，在下次使用所述变量之间尽可能多地制作指令，因为它需要大约 20 次才能设置到寄存器。因此，我将常量 cc_diff 放在顶部，但是，由于这只是一个指令，它可能不会显示任何好处。

## 模函数

```
__device__ modulo(int val, int _mod) {
    int p = (val&(_mod-1));// as modulo is always the power of 2
    if(val < 0) {
        return _mod - p;
    } else {
        return p;
    }
} 
```

正如我们`_mod`一直使用的 2( `cc = 2, N = 64, cc*N = 128`) 的整数一样，我们可以使用这个函数来代替 mod 运算符。这应该“快得多”。不过检查一下，这样我的算术就正确了。它来自[Optimizing Cuda - Part II Nvidia](http://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=2&cad=rja&ved=0CEAQFjAB&url=http://developer.download.nvidia.com/CUDA/training/NVIDIA_GPU_Computing_Webinars_Further_CUDA_Optimization.pdf&ei=kwTmUIeeFerw4QTohoCIAg&usg=AFQjCNH2RKW7cJyidG54T4LBdRg7-mKhsA&sig2=cUz1vOV-5xD0mLkqC1rCbw&bvm=bv.1355534169,d.bGE)第 14 页。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-26T01:48:28.357

您可能想要研究的一种优化是使用快速数学。使用内在数学函数并使用 -use-fast-math 选项进行编译。

[内在数学](http://developer.download.nvidia.com/compute/cuda/4_2/rel/toolkit/docs/online/group__CUDA__MATH__INTRINSIC__SINGLE_gfa0ea4b2cee94521792ead0deb03addb.html)

# java - 使用对象数组

> ID：13941874
> 
> 赞同：0
> 
> 时间：2012-12-18T21:35:23.243
> 
> 标签：java, arrays, object

@edit IT 工作，感谢您的回答:) 我想我的错误是当我认为

```
WORLD[i]=global.Values.CHUNKPATTERN(); 
```

只需获取右侧的对象，克隆其值，并将它们分配给左侧的部分，而事实证明它在两者之间建立了引用。再次感谢：）

我有简单的初学者/新手数组问题：

```
for(int i=0; i<global.Values.WORLDVOLUME(); i++)  
// global.Values.WORLDVOLUME() --> const, int. always the same.
{
WORLD[i]=global.Values.CHUNKPATTERN(); //to pre-define as 'zero only' object. Always the same. Const.
WORLD[i].chunknr=i+1;
}

System.out.println(WORLD[4].chunknr); 
```

当然，我想要`WORLD[0]`chunknr 1，`WORLD[4]`chunnr 为 5 等等。

相反`WORLD[i].chunknr=i+1;` ，似乎更新了所有元素的 chunknr （不仅`WORLD[i]`）。所以它看起来像`WORLD[0].chunknr = WORLD[1].chunknr=global.Values.WORLDVOLUME()`这里。任何人都知道如何绕过它？我相信有一个简单的解决方案......我是否正确理解了对象数组？

你可以喜欢（前提是你有类和构造函数）

```
Point POINTARRAY[]= new Point[10];
POINTARRAY[1].x=5
POINTARRAY[1].y=6
POINTARRAY[3].x=17
POINTARRAY[3].y=1 
```

正确的？如何通过循环分配它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:44:15.217

这条线是你的问题：

```
WORLD[i]=global.Values.CHUNKPATTERN(); 
```

这是`WORLD[i]`对 的**引用**，`global.Values.CHUNKPATTERN()`这意味着它们都指向同一个对象！并且对于循环的每次迭代，您只是在创建对**同一个**全局对象的越来越多的引用。

有时这不是你想要的。在这种情况下，您需要**复制**该值，这可以通过多种方式完成，但在大多数情况下，您可以简单地克隆它。所有 Java 对象都支持一种`clone()`方法，尽管有时您需要重写它才能为您的类做正确的事情。

这意味着您应该将上面的行替换为：

```
WORLD[i]=(YourType)global.Values.CHUNKPATTERN().clone(); 
```

where`YourType`是类的实际类型，因为您从发布的代码片段中省略了它。

希望有帮助！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:38:58.290

我猜以下行总是返回相同的引用：

```
global.Values.CHUNKPATTERN(); 
```

所以不同的数组索引实际上指向同一个参考。这只是一个猜测，因为您没有告诉我们上述函数是如何工作的。

这是一个不同数组元素可以指向同一个实例的示例：

```
public class AClass{ 
  public int val = 0;

 }
AClass[] array = new AClass[2];
AClass classInstance = new AClass();
array[0] = classInstance;
array[1] = classInstance; 
```

上面的代码实例化了一个 AClass 对象（classInstance），但是使用 2 个不同的数组元素来引用同一个实例：

```
System.out.println("array 1 value " + array[1].val ); // both element initialized to 0 so it prints 0
array[0].val = 15; // actually is classInstance.val to be modified, through the reference to it stored inside the first element of the array. 
System.out.println("array 1 value " + array[1].val ); // print 15 
```

对于 POINT 示例的关注点，您可以这样使用 for 循环：

```
Point POINTARRAY[]= new Point[10];
for(int i = 0 ; i < POINTARRAY.length; ++i)
{
  POINTARRAY[1].x=...;
  POINTARRAY[1].y=...;

} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:39:10.030

> 相反`WORLD[i].chunknr=i+1;`，似乎更新了所有元素的 chunknr。

是`WORLD[0]`和`WORLD[1]` *不同的*对象吗？``WORLD[0] == WORLD[1]`如果评估为真，它们没有什么不同。

你有：

```
WORLD[i]=global.Values.CHUNKPATTERN(); 
```

每次调用时都会`CHUNKPATTERN`创建一个对象吗？`new`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-18T21:40:46.953

我打赌这个方法

`WORLD[i]=global.Values.CHUNKPATTERN();`

总是返回一个对象的相同实例，因此您在数组的每个插槽中都有对相同对象的引用。

随后

`WORLD[i].chunknr=i+1;`

您在每次迭代中更改`chunknr`同一对象的属性。你说

> ...似乎更新了所有元素的 chunknr

有点真实，因为所有元素都引用同一个实例。

您需要找到一种方法来`global.Values.CHUNKPATTERN();`每次都返回一个新对象。

# php - 带有 jQ uery/AJAX 用户端的 PHP 套接字

> ID：13941876
> 
> 赞同：0
> 
> 时间：2012-12-18T21:35:40.697
> 
> 标签：php, ajax, sockets, jquery, cross-browser

我一直在研究套接字，通常在 PHP 中工作了一段时间。目前我有一个用于连接聊天服务器的 PHP 客户端，并输出从它所连接的服务器发送的每个数据。

为了更广泛地解释这一点，我使用 PHP 中的 flush() 函数来写出每个在循环中等待的缓冲区。缓冲区读取器正在使用一段时间，条件是连接套接字的状态。但这并不重要。

现在到我想要完成的事情。我想通过 AJAX/jQuery 保持对服务器端的套接字处理和从服务器输出到客户端的数据。到目前为止，我的研究总是返回给我 HTML5 WebSocket 和 node.js，但是，我“必须”对此非常挑剔，至于这个用户，我最小的依赖可能是：

*   WinXP IE6 用户（已经禁用 jQuery，甚至）
*   未安装 JAVA/Flash 的用户

所以我必须考虑这方面的可能性，这就是为什么我不能使用 Flash/Java 后端或 WebSocket 之类的新技术，也不想在客户端处理服务器的东西。**我真的很讨厌被困在旧技术中，但这是必须的。**

当我四处寻找时，我发现这个与我的需求相似。

[PHP 套接字是制作基于 PHP jQuery 的聊天的可行选项吗？](https://stackoverflow.com/questions/3267324/is-php-socket-a-viable-option-for-making-php-jquery-based-chat)

为了快速查看答案，他们都指向一个方向，PHP 多进程和内存消耗。我知道这是一个减号，但这是我目前能做的最好的。但是，在一定的延迟内，非活动连接会超时断开连接，如果需要，延迟会延长。所以我对这个不太感兴趣。

其次，最后一个答案指向“Ajax 聊天应用程序教程”，我进行了全面审查，但是哇，将每一行写入一个 html 文件并每次都重新包含它，这是我可以在不使用额外文件的情况下做到的，但是，真的有必要吗？再加上从服务器端重新读取文件，每次都将整个读取的文件重新导入到文档中，这对“双方”来说不是更糟吗？

不管怎样，我有一段时间无法得出结论，它发生了，我又来了。(:P) 等待您的回答/建议/想法，谢谢。

问候。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-19T00:39:48.787

有专门处理此类问题的服务器软件可用。称为推送服务器/服务。例如 APE（[http://www.ape-project.org/](http://www.ape-project.org/)）；根据他们的网站，它与所有网络浏览器兼容，他们甚至在那里进行了演示聊天。我建议你去那个解决方案。

# c# - 通过python登录网站进行抓取的方法

> ID：13941877
> 
> 赞同：2
> 
> 时间：2012-12-18T21:35:45.847
> 
> 标签：c#, python, mobile, login, screen-scraping

所以已经厌倦了很多方法来登录我的大学网站

我厌倦的任何方法都给了我 401，我使用了机械化请求 ntlm，所有这些都给了我一个 401，所以无论如何。

另外请记住，我正在尝试开发一个移动应用程序，并且将通过登录信息从该网站获取数据，我现在该怎么做，但似乎无法通过。

如果不是其他语言，可以像 C# 或 Vb.net 那样做，但他们会像 android 和 ios 那样工作吗？

12 月 18 日 10:27 更新：得到 200 状态码，因为我输入了错误的域名，域名必须是本地网络上使用的服务器名称，

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:47:27.740

尝试使用[requests_ntlm](http://docs.python-requests.org/en/latest/)[请求](https://github.com/requests/requests-ntlm)：

```
 import requests
    from requests_ntlm import HttpNtlmAuth

    requests.get("http://ntlm_protected_site.com",auth=HttpNtlmAuth('domain\\username','password')) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T21:49:08.073

显然，如果不登录您的大学网站，就很难对其进行逆向工程，但是通过查看该链接，我看到了以下内容：

```
WWW-Authenticate: Negotiate
WWW-Authenticate: NTLM 
```

我不是 Python 方面的专家，但我确实记得 NTLM 在历史上对非 Microsoft 客户来说是痛苦的，但并非不可能。

当然，使用 .NET 客户端访问此内容应该没有问题。

您是否尝试过例如[python-ntlm](http://code.google.com/p/python-ntlm/)？我看到它基于[NTLM 授权代理服务器](http://ntlmaps.sourceforge.net/)的代码，我记得多年前使用它来处理 NTLM 身份验证。

# sql - 如何拥有每月重置的数据库计数器？

> ID：13941879
> 
> 赞同：2
> 
> 时间：2012-12-18T21:35:50.020
> 
> 标签：sql, database, counter, reset

我有一个应用程序需要为每个项目生成一个唯一标识符，这个标识符是一些首字母、日期和每个新项目递增的 4 位数字的组合。棘手的部分是最后 4 位数字应该每月重置一次。

例如，假设我们有 UID **"SP-20121218-0001"**，最后 4 位数字**"0001"**将递增到一月份，然后在一月份创建的第一个项目应该有**"SP-20130101-0001"**。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:43:10.593

创建一个包含字段 Year、Month、CurrentCount 的表。编写一个存储过程，为当前年份和月份选择一行，如果不存在则创建它并增加数字。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:46:17.127

对我来说，这听起来像是存储函数的完美用例。

在 postgresql 中，您可以通过拥有一个序列，然后使用一个函数从序列中选择一个值，并结合计算当前日期和日期何时翻转，重置序列来做到这一点。

最好的方法是不要费心重置序列，而只需使用一个唯一的数字，并加上日期。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T21:42:43.253

一种可能的选择是将最后 4 位数字基于数据库序列，然后有一个单独的进程在新月份开始时重置该数据库序列。

# servlets - 同一过滤器的多个过滤器映射

> ID：13941880
> 
> 赞同：0
> 
> 时间：2012-12-18T21:35:52.307
> 
> 标签：servlets, servlet-filters

我在 weblogic 中部署了 2 个 Web 应用程序。因为他们每个人都有一个单独的休眠会话工厂。我在 webapp2 中使用 specialServlet 使二级缓存无效。 `filter1`用于设置休眠会话，因此我可以调用以使二级缓存无效。

从 web app1 我包括 web app2 中的 /servlet/specialServlet。

我希望定期提出`filter1`要求`/servlet/*`。

但是对于`servlet/specialServlet`我来说，`filter1`不仅要按常规请求调用，还要按`include`请求调用。指定过滤器映射的最佳方法是什么？过滤器映射元素的顺序也很重要`filter1`吗？

```
 <web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://java.sun.com/xml/ns/javaee   http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd">          
  xxx
                  <filter>
                      <filter-name>filter1</filter-name>
                      <filter-class>xxx</filter-class>
                  </filter>
                  <filter-mapping>
                    <filter-name>filter1</filter-name>
                    <url-pattern>/servlet/*</url-pattern>
                  </filter-mapping>          
                  <filter-mapping>
                    <filter-name>filter1</filter-name>
                    <url-pattern>/servlet/specialServlet</url-pattern>
                    <dispatcher>INCLUDE</dispatcher>
                  </filter-mapping>
   xxx
  </web-app> 
```

# java - 动态更改 JTextPane 中文本的字体

> ID：13941884
> 
> 赞同：1
> 
> 时间：2012-12-18T21:36:25.620
> 
> 标签：java, swing, jtextpane, jeditorpane

我想动态更改写在 JTextPane 上的某些文本。我有一个字符串数组，其中包含应该更改的单词

```
String ListMethod [] = {"forward", "backward", "left", "right"}; 
```

我浏览了一些帖子，许多人建议使用 JTextPane 或 JEditorPane 来编辑文本，但给出的大多数答案都适用于静态文本。我想这样做，当我在文本窗格中输入“前进”或“后退”等...时，它会检测到这个词并改变颜色。我该怎么办？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:47:07.033

请参阅此处如何将 DocumentListener[值更改侦听器实现为 JTextField](https://stackoverflow.com/questions/3953208/value-change-listener-to-jtextfield)。看看 javax.swing.text.Highlighter 和 javax.swing.text.HighlightPainter。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T21:49:18.110

您必须捕获适当的事件并执行操作。例如，在您的情况下，您可以创建一个更改颜色的 ActionListener 并使用 registerKeyBoardAction 将其附加到您的 JTextPane 上。

Oracle 有一个很好的教程：[http](http://docs.oracle.com/javase/tutorial/uiswing/events/index.html) ://docs.oracle.com/javase/tutorial/uiswing/events/index.html关于事件监听器。我建议你开始熟悉那里

# sql-server-2008 - SQL Server 2008：U 和 X 锁 - 一个没有任何索引的表上的死锁。如何？

> ID：13941886
> 
> 赞同：3
> 
> 时间：2012-12-18T21:36:31.767
> 
> 标签：sql-server-2008, locking, deadlock, database-deadlocks

我观察到我的数据库非常奇怪的行为。我有一个小表（大约 300 行），其中一个字段不断更新。

而且我在那里遇到了很多死锁 - 表的更新导致同一张表的类似更新死锁（U 锁与 X 锁）。

所以我决定删除聚集索引（所以表现在没有任何索引）来修复死锁。但这并没有帮助，现在我在 U 和 X 锁定模式之间陷入僵局。

所以一张表，没有索引和 2 个会话更新一张表

**受害者**

```
update dbo.MyNumber set
  @nextno = nextno = nextno + 1
where [type] = @type
  and yearid = @yearid 
```

**中奖查询：**

```
update dbo.MyNumber set
  @nextno = nextno = nextno + 1
where [type] = @TYPE
  and yrclosedyn = 0 
```

**行肯定不同，但页面是相同的。**

这怎么可能？也许它与锁升级有关，或者......？

我真的很感激任何建议。

在此先感谢迈克

死锁 XML：

```
<deadlock-list>
 <deadlock victim="process6c492e8">
  <process-list>
   <process id="processb6a988" taskpriority="0" logused="1848" waitresource="RID: 5:1:127478:16" waittime="3478" ownerId="17153439" transactionname="user_transaction" lasttranstarted="2012-12-18T12:31:40.147" XDES="0xffffffff89482258" lockMode="U" schedulerid="7" kpid="4248" status="suspended" spid="98" sbid="0" ecid="0" priority="0" transcount="2" lastbatchstarted="2012-12-18T12:31:49.913" lastbatchcompleted="2012-12-18T12:31:49.913" clientapp="PenAIR" hostname="S16047425" hostpid="9300" loginname="sa" isolationlevel="read committed (2)" xactid="17153439" currentdb="5" lockTimeout="4294967295" clientoption1="673185824" clientoption2="128056">
    <executionStack>
     <frame procname="MYDATABASE.dbo.MyStoredProcedure" line="92" stmtstart="9062" stmtend="9388" sqlhandle="0x030005002d15a05e58b5710016a100000100000000000000">
UPDATE dbo.MyNumber Set
  @NEXTNO = NEXTNO = NEXTNO + 1
WHERE  (TYPE = @TYPE) AND (YRCLOSEDYN = 0)     </frame>
    </executionStack>
    <inputbuf>
Proc [Database Id = 5 Object Id = 1587549485]    </inputbuf>
   </process>
   <process id="process6c492e8" taskpriority="0" logused="192" waitresource="RID: 5:1:127478:20" waittime="8252" ownerId="17153562" transactionname="user_transaction" lasttranstarted="2012-12-18T12:31:45.140" XDES="0x6583b1e0" lockMode="U" schedulerid="13" kpid="19824" status="suspended" spid="143" sbid="0" ecid="0" priority="0" transcount="2" lastbatchstarted="2012-12-18T12:31:45.140" lastbatchcompleted="2012-12-18T12:31:45.140" clientapp="PenAIR" hostname="S16047425" hostpid="4760" loginname="sa" isolationlevel="read committed (2)" xactid="17153562" currentdb="5" lockTimeout="4294967295" clientoption1="673185824" clientoption2="128056">
    <executionStack>
     <frame procname="MYDATABASE.dbo.MyStoredProcedure" line="92" stmtstart="9062" stmtend="9388" sqlhandle="0x030005002d15a05e58b5710016a100000100000000000000">
UPDATE dbo.MyNumber Set
  @NEXTNO = NEXTNO = NEXTNO + 1
WHERE  ([TYPE] = @TYPE) AND (YRCLOSEDYN = 0)     </frame>
    </executionStack>
    <inputbuf>
Proc [Database Id = 5 Object Id = 1587549485]    </inputbuf>
   </process>
  </process-list>
  <resource-list>
   <ridlock fileid="1" pageid="127478" dbid="5" objectname="MYDATABASE.dbo.MyNumber" id="lock464f2640" mode="X" associatedObjectId="72057594131120128">
    <owner-list>
     <owner id="processb6a988" mode="X"/>
    </owner-list>
    <waiter-list>
     <waiter id="process6c492e8" mode="U" requestType="wait"/>
    </waiter-list>
   </ridlock>
   <ridlock fileid="1" pageid="127478" dbid="5" objectname="MYDATABASE.dbo.MyNumber" id="lockfffffffff1974980" mode="X" associatedObjectId="72057594131120128">
    <owner-list>
     <owner id="process6c492e8" mode="X"/>
    </owner-list>
    <waiter-list>
     <waiter id="processb6a988" mode="U" requestType="wait"/>
    </waiter-list>
   </ridlock>
  </resource-list>
 </deadlock>
</deadlock-list> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-20T13:58:12.103

[将您的死锁图](http://blog.waynesheffield.com/wayne/code-library/shred-deadlock-graph/)分解为表格形式显示以下内容。

```
+----------+-------------------------+-----------+-----------+------------+----------+--------------------+--------------------+---------+
| LockMode |      LockedObject       | TranCount | LockEvent | LockedMode | WaitMode |    WaitResource    |   IsolationLevel   | LogUsed |
+----------+-------------------------+-----------+-----------+------------+----------+--------------------+--------------------+---------+
| U        | MYDATABASE.dbo.MyNumber | NULL      | rid       | X          | U        | RID: 5:1:127478:20 | read committed (2) |     192 |
| U        | MYDATABASE.dbo.MyNumber | NULL      | rid       | X          | U        | RID: 5:1:127478:16 | read committed (2) |    1848 |
+----------+-------------------------+-----------+-----------+------------+----------+--------------------+--------------------+---------+ 
```

您还没有在评论中回答我关于序列生成代码是否在每个事务中只调用一次的问题。

如果没有，很容易生成类似于您帖子中的死锁图。

## 设置

```
CREATE TABLE dbo.MyNumber
  (
     [TYPE]     CHAR(1),
     YRCLOSEDYN INT,
     NEXTNO     INT
  )

INSERT INTO dbo.MyNumber
VALUES      ('X', 0, 1),
            ('Y', 0, 1)

GO

CREATE PROC MyStoredProcedure @TYPE   CHAR(1),
                              @NEXTNO INT OUTPUT
AS
    UPDATE dbo.MyNumber
    SET    @NEXTNO = NEXTNO = NEXTNO + 1
    WHERE  ( [TYPE] = @TYPE )
           AND ( YRCLOSEDYN = 0 ) 
```

## 连接 1

```
BEGIN TRAN

DECLARE @NEXTNO INT

EXEC MyStoredProcedure 'Y', @NEXTNO OUTPUT

WAITFOR DELAY '00:00:05'

EXEC MyStoredProcedure 'X', @NEXTNO OUTPUT

ROLLBACK 
```

## 连接 2

（执行连接1中的代码后立即运行）

```
BEGIN TRAN
DECLARE @NEXTNO INT

EXEC MyStoredProcedure 'X', @NEXTNO OUTPUT

EXEC MyStoredProcedure 'Y', @NEXTNO OUTPUT

ROLLBACK 
```

从中输出的死锁图与上面的非常相似

```
+----------+-------------------------+-----------+-----------+------------+----------+-----------------+--------------------+---------+
| LockMode |      LockedObject       | TranCount | LockEvent | LockedMode | WaitMode |  WaitResource   |   IsolationLevel   | LogUsed |
+----------+-------------------------+-----------+-----------+------------+----------+-----------------+--------------------+---------+
| U        | MYDATABASE.dbo.MyNumber |         2 | rid       | X          | U        | RID: 11:1:144:1 | read committed (2) |     248 |
| U        | MYDATABASE.dbo.MyNumber |         2 | rid       | X          | U        | RID: 11:1:144:0 | read committed (2) |     248 |
+----------+-------------------------+-----------+-----------+------------+----------+-----------------+--------------------+---------+ 
```

如果这是对您的问题的解释，您将需要确保在所有事务中以相同的顺序更新序列（我认为必须有一些充分的理由说明您不能只使用[基于`IDENTITY`列的解决方案](https://stackoverflow.com/a/3462957/73226)）

# excel - 将 XY 坐标从 Excel 导入 MatLab

> ID：13941888
> 
> 赞同：1
> 
> 时间：2012-12-18T21:36:34.333
> 
> 标签：excel, matlab

我已将我的 XY 数据（在同一个 excel 工作表中）导入到 matlab，所有 X 和 Y 坐标位于单独的列（'FHC'）中，X 在 b 列中，Y 在 c 列中。我想使用 k-means 绘制这些图。

我被卡住了，因为我不喜欢绘制所有坐标，我喜欢包括前 10 个，跳过 2 个单元格，然后包括接下来的 10 个等。我试图指定这样的单元格 (b2:b12,1);( c2:c12,2)，它超过矩阵尺寸？

我如何告诉 matlab 从哪个单元格到我希望它包含的其他单元格，可能告诉它跳过中间的一些单元格？我的代码目前看起来像这样（但现在它绘制了所有 X 和所有 Y）；

```
X =['FHC',(:,1);(:,2)] %written differently 
opts = statset('Display','final');

[idx,ctrs,sumd,D] = kmeans(X,1,...

 plot(X(idx==1,1),X(idx==1,2),'r.','MarkerSize',12)
 hold on
 plot(ctrs(:,1),ctrs(:,2),'ko',...
 legend('Cluster 1','Centroid',... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T00:04:20.830

如果`X`并且`Y`是细胞，那么试试这个：

```
 %if X is a n by 2 cell array
 hold on
 for ii=1:2:length(X)
     plot(X{ii,1}(1:10),X{ii,2}(1:10),'r.','MarkerSize',12);
 end
 hold off 
```

# php - PHP DOM 移除子节点

> ID：13941894
> 
> 赞同：0
> 
> 时间：2012-12-18T21:37:01.973
> 
> 标签：php, xml, dom, simplexml

我试图`<wcccanumber>`从我的 xml 中删除父节点，如果它的内容符合某个标准，但它只会删除一个节点`<wcccanumber>`。如何删除整个父节点？

这是我的代码：

```
$xml = new SimpleXMLElement('<xml/>');

if (file_exists("xml/units/E01.xml")) {

    $xml = simplexml_load_file("xml/units/E01.xml");

    echo "File exists";
    echo "</br>";

    $wcccanumber = "121202482";

    foreach ($xml->call->wcccanumber as $call) {
        if ($call == $wcccanumber) {
            $dom = dom_import_simplexml($call);
            $dom->parentNode->removeChild($dom);

            $fp = fopen("xml/units/E01.xml","wb");
            fwrite($fp,$xml->asXML());
            fclose($fp);
        }
    }
} 
```

这是xml：

```
<xml>
  <call>
     <wcccanumber>121202482</wcccanumber>
     <currentcall>FALL</currentcall>
     <county>W</county>
     <id>82</id>
     <location>234 E MAIN ST</location>
     <callcreated>12:26:09</callcreated>
     <station>HBM</station>
     <units>E01</units>
     <calltype>M</calltype>
     <lat>45.5225067888299</lat>
     <lng>-122.987112718574</lng>
     <inputtime>12/18/2012 12:27:01 pm</inputtime>
  </call>
</xml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:48:03.223

遍历并与`call`比较。转换为 dom 并将其删除 ( )。`$call->wcccanumber``$wcccanumber``$call``parentNode->removeChild`

```
foreach ($xml->call as $call) {
    if ($call->wcccanumber == $wcccanumber) {
        $dom = dom_import_simplexml($call);
        $dom->parentNode->removeChild($dom);
        $fp = fopen("xml/units/E01.xml","wb");
        fwrite($fp,$xml->asXML());
        fclose($fp);
    }
} 
```

如果有多个删除，则在所有删除完成*后*只保存一次是有意义的。

```
$deletionCount = 0;

foreach ($xml->call as $call) {
    if ($call->wcccanumber != $wcccanumber) {
        continue;
    }
    $dom = dom_import_simplexml($call);
    $dom->parentNode->removeChild($dom);
    $deletionCount++;
}

if ($deletionCount) {
    file_put_contents("xml/units/E01.xml", $xml->asXML());
} 
```

# c - 向量、矩阵和数据框是如何在 R 中实现的？

> ID：13941901
> 
> 赞同：8
> 
> 时间：2012-12-18T21:37:33.647
> 
> 标签：c, r, data-structures

我一直在尝试了解流行语言中使用的不同数据结构，例如 Python 中的列表和字典、PHP 中的关联数组（本质上是哈希表）、C++ 中的向量等。

我有很多同事虔诚地使用 R，我想知道向量、矩阵和数据框是如何在 R 中实现的。它们的优点和缺点是什么？我正在查看源代码，但我找不到数据结构本身。这些定义在源代码中的什么位置？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T17:00:14.347

如前所述，请查看[“R internals”](http://cran.r-project.org/doc/manuals/R-ints.html)手册以及[“Writing R extensions”的这一部分](http://cran.r-project.org/doc/manuals/R-exts.html#Handling-R-objects-in-C)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-20T19:17:26.757

来自 R Internals，1.1 SEXP：

> ... R 对象的基本构建块通常称为节点... 这两种类型的节点结构的前三个字段都有一个 32 位 spxinfo 标头，然后是三个指针（指向属性以及前一个和下一个节点）双向链表）

因此，R 中的向量被实现为双向链表。而且，似乎没有比单节点链表更小的数据结构。这可以通过以下方式证明：

```
> a <- 4
> a[1]
4 
```

正如其他人所提到的：`builtin.c`有`do_makevector`和`do_makelist`，并且`array.c`有来源`do_matrix`。此外`array.c`包含源`allocMatrix`和`memory.c`包含源`allocVector`。

虽然发生了很多事情，但很明显，矩阵只是双向链表的双向链表。我相信（尽管不确定）行和列名（如存储在数据框中的那些）存储在每个列表的“属性”中。

对数据结构实现的“优势和劣势”的回应是（根据我的有限知识）双向链表的优势在于动态内存分配更简单，并且不需要复制开销和重新分配整个数组，缺点是（取决于有多少指向列表的指针：头、尾、中间、四分之一等）访问随机值`v[99]`可能会花费在所需元素之前遍历几个元素的开销被发现。

它是否正确？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2017-02-01T08:49:47.000

有点晚了，但想指出其他答案之一的错误并给出明确的答案。查看内部手册：

[https://cran.r-project.org/doc/manuals/R-ints.html#The-_0027data_0027](https://cran.r-project.org/doc/manuals/R-ints.html#The-_0027data_0027)

阅读本节的开头以及“INTSXP”条目。似乎整数向量被实现为 C int 的数组。'REALSXP' 和 'CHARSXP' 也是如此。

将其实现为链表会非常缓慢。

# python - 何时使用 Tornado，何时使用 Twisted / Cyclone / GEvent / other

> ID：13941903
> 
> 赞同：182
> 
> 时间：2012-12-18T21:37:38.430
> 
> 标签：python, webserver, twisted, tornado, gevent

这些框架/库中的哪一个是构建现代多用户 Web 应用程序的最佳选择？我很想拥有一个异步网络服务器，它可以让我轻松扩展。什么解决方案将提供**最佳性能**/**可扩展性**/**最有用的框架**（在易于使用和易于开发方面）？

如果它能提供良好的**功能**（websockets、rpc、流媒体等），那就太好了。

每种解决方案的优缺点是什么？

* * *

## 回答 #1

> 赞同：231
> 
> 时间：2013-05-19T02:33:19.530

*“ **[Django](https://www.djangoproject.com/)**是一个高级 Python Web 框架，它鼓励快速开发和简洁、实用的设计”*。如果您正在构建类似于电子商务网站的东西，那么您可能应该使用 Django。它会让你的工作快速完成。您不必担心太多的技术选择。它提供了从模板引擎到 ORM 所需的一切。对于您构建应用程序的方式，它会有点固执己见，如果您问我，这很好。它拥有所有其他库中最强大的社区，这意味着可以轻松获得帮助。

*“ **[Flask](http://flask.pocoo.org/)**是基于 Werkzeug、Jinja 2 和善意的 Python 微框架”*。当心 - “微框架”可能会产生误导。这并不意味着 Flask 是一个半生不熟的库。这意味着烧瓶的核心非常非常简单。与 Django 不同，它不会为您做出任何技术决策。您可以自由选择任何您喜欢的模板引擎或 ORM。尽管它默认带有 Jinja 模板引擎，但您始终可以自由选择我们自己的模板引擎。据我所知，Flask 可用于编写 API 端点（RESTful 服务）。

*“ **[Twisted](https://twistedmatrix.com/)**是一个用 python 编写的事件驱动的网络引擎”*。这是一个高性能的引擎。其速度的主要原因是所谓的延迟。Twisted 建立在 deferred 之上。对于那些不了解延迟的人来说，它是通过异步架构实现的机制。Twisted 非常快。但不适合编写常规的 webapps。如果你想做一些底层网络的东西，twisted 是你的朋友。

*" **[Tornado](http://www.tornadoweb.org/en/stable/)**是一个 Python web 框架和异步网络库，最初在 FriendFeed 开发。通过使用非阻塞网络 I/O，Tornado 可以扩展到数万个打开的连接，使其成为长轮询、WebSockets 和其他应用程序的理想选择需要与每个用户建立长期连接”*。Tornado 位于 Django 和 Flask 之间。如果你想用 Django 或 Flask 写东西，但如果你需要更好的性能，你可以选择 Tornado。如果架构正确，它可以很好地处理 C10k 问题。

*“ **[Cyclone](http://cyclone.io/)**是 Python 的 Web 服务器框架，将 Tornado API 实现为 Twisted 协议”*。现在，如果您想要一些几乎与 Twisted 一样高性能但易于编写传统 web 应用程序的东西怎么办？向旋风问好。我更喜欢旋风而不是龙卷风。它有一个与 Tornado 非常相似的 API。事实上，这是 Tornado 的一个分支。但问题是它的社区相对较小。Alexandre Fiori 是回购协议的唯一主要提交者。

*“ **[Pyramid](http://docs.pylonsproject.org/en/latest/docs/pyramid.html)**是一个通用的、开源的 Python Web 应用程序开发框架。它的主要目标是让 Python 开发人员更容易创建 Web 应用程序。”* 我还没有真正使用过 Pyramid，但我浏览了文档。据我了解，Pyramid 与*Flask*非常相似，我认为您可以在*Flask*看起来合适的任何地方使用 Pyramid，反之亦然。

***编辑***：欢迎请求审查任何其他框架！

资料来源：[http ://dhilipsiva.com/2013/05/19/python-libraries-django-twisted-tornado-flask-cyclone-and-pyramid.html](http://dhilipsiva.com/2013/05/19/python-libraries-django-twisted-tornado-flask-cyclone-and-pyramid.html)

* * *

## 回答 #2

> 赞同：61
> 
> 时间：2012-12-19T17:55:37.340

这显然是一个[有点偏颇](http://glyph.twistedmatrix.com)的答案，但这与[错误](https://en.wikipedia.org/wiki/Accuracy_and_precision)答案不同；你应该总是使用 Twisted。我之前回答过[类似的问题](https://stackoverflow.com/questions/4384360/which-python-async-library-would-be-best-suited-for-my-code-asyncore-twisted)，但是由于你的问题不太一样，这里有一些原因：

## “最棒的表演”

[Twisted 在speed.twistedmatrix.com](http://speed.twistedmatrix.com)网站上持续监控我们的表现。我们也是[PyPy 的类似站点监控](http://speed.pypy.org)的首批项目之一，从而确保了 Twisted 在运行时的良好性能，任何人都关心 Python 中的高性能应用程序。

## “可扩展性”

据我所知，列出的框架都没有对自动扩展的内置支持。它们都是通信框架，因此您必须在扩展节点之间进行通信。然而，Twisted 的优势在于其[对本地多处理的内置支持](https://twistedmatrix.com/documents/current/api/twisted.internet.interfaces.IReactorProcess.spawnProcess.html)。公平[地说，Tornado 有一个第三方插件](http://pypi.python.org/pypi/tornado_subprocess/)可以让你做同样的事情。在最近的版本中，[Twisted 添加了一些功能](https://twistedmatrix.com/trac/ticket/5615)，增加了您可以在内核之间共享工作的方式的数量，并且该领域的工作正在进行中。Twisted 还有一些[集成良好的](http://amp-protocol.net)“[原生”](https://twistedmatrix.com/documents/current/core/howto/pb-intro.html) RPC 协议，它们为您想要追求的任何扩展习惯提供了一个构建工具包。

## “最有用”

[很多人](http://twistedmatrix.com/trac/wiki/ProjectsUsingTwisted)似乎发现 Twisted[非常有用](http://twistedmatrix.com/trac/wiki/SuccessStories)。 [如此之多，以至于他们中的许多人都对其进行了扩展，并为您提供了他们的扩展。](https://launchpad.net/tx)

## “功能性”

开箱即用，Twisted 包括：

*   对以下所有[测试驱动开发的良好支持](https://twistedmatrix.com/documents/current/core/howto/trial.html)
*   [TCP](https://twistedmatrix.com/documents/current/core/howto/servers.html)服务器、[客户端](https://twistedmatrix.com/documents/current/core/howto/clients.html)、[传输层安全](https://twistedmatrix.com/documents/current/core/howto/ssl.html)
*   [SSH](https://twistedmatrix.com/documents/current/conch/index.html)客户端和服务器
*   [IMAP4、ESMTP、POP3](https://twistedmatrix.com/documents/current/mail/index.html)客户端和服务器
*   [DNS](https://twistedmatrix.com/documents/current/names/index.html)客户端和服务器
*   [HTTP](https://twistedmatrix.com/documents/current/web/index.html)客户端和服务器
*   [IRC、XMPP、OSCAR、MSN](https://twistedmatrix.com/documents/current/words/index.html)客户端和服务器

至少在最后一个部门中，Twisted 似乎是内置功能的明显赢家。而这一切，都在一个超过 2 兆字节的包中！

* * *

## 回答 #3

> 赞同：48
> 
> 时间：2013-01-29T20:37:34.987

我喜欢@Glyph 的回复。Twisted 是一个非常全面、丰富的python 框架。Twisted 和 Tornado 的设计非常相似。我非常喜欢这个设计：

*   它很快
*   容易明白
*   易于扩展
*   不需要*c 扩展*
*   在 PyPy 上工作。

但我想强调*Tornado*，我更喜欢它并且最近获得了人气。Tornado 和 Twisted 一样，使用回调样式编程，但可以使用`tornado.gen.engine`( `twisted.internet.inlineCallbacks`in Twisted) 内联。

### 代码库

最好的评论来自[http://cyclone.io](http://cyclone.io)网站。*旋风*试图混合 Twisted 和 Tornado，因为：

> Twisted 是可供公众使用的最成熟的非阻塞 I/O 库之一。Tornado 是 FriendFeed 的 web 服务器的开源版本，它是 Python 最流行和最快速的 web 服务器之一，具有非常不错的 API 用于构建 web 应用程序。
> 
> 这个想法是将 Tornado 优雅而直接的 API 与 Twisted 的 Event-Loop 连接起来，从而实现大量支持的协议。

但在 2011`tornado.platform.twisted`年推出，它带来了类似的功能。

### 表现

[Tornado 的性能](https://web.archive.org/web/20140916094802/http://casbon.me/what-will-pypy-do-for-your-website-benchmarki)要好得多。它还可以与 PyPy 无缝协作，并获得巨大收益。

### 可扩展性

和 Twisted 一样。Tornado 在`tornado.process`其上实现了许多 rpc 服务。

### 功能性

[有 71 个](http://pypi.python.org/pypi?:action=search&term=tornado)基于 Tornado 的软件包，相比之下，有 148 个 Twisted 和 48 个 Gevent。但是如果你仔细观察并计算包上传时间的中位数，你会发现 Twisted 是最旧的，然后是 Gevent 和 Tornado 是最新鲜的。此外，还有一个`tornado.platform.twisted`模块允许您**在 Tornado 上运行为 Twisted 编写的代码**。

### 概括

使用 Tornado，您可以使用 Twisted 的代码。无需使用只会*扭曲*您的代码的旋风（您的代码变得更加混乱）。

至于 2014 年，Tornado 被认为是被广泛接受的默认异步框架，适用于 python2 和 python3。最新版本 4.x 还带来了来自[https://docs.python.org/dev/library/asyncio.html](https://docs.python.org/dev/library/asyncio.html)的许多功能。

我写了一篇文章，解释了为什么我认为[Tornado - 最好的 Python Web 框架](http://rz.scale-it.pl/2013/01/25/tornado___the_best_web_framework.html)，我在其中写了更多关于 Tornado 功能的内容。

* * *

## 回答 #4

> 赞同：16
> 
> 时间：2013-03-04T19:46:15.870

（**更新**：我很遗憾这里推荐甚至提到 Gevent 的答案很少——我认为这与这个优秀库的受欢迎程度、性能和易用性不成比例！）

Gevent 和 Twisted 并不是相互排斥的，尽管相反的情况起初看起来很明显。有一个名为的项目`geventreactor`可以让人们相对顺利地利用两全其美，即：

*   Gevent 的高效且廉价（合作绿色）线程模型，在并发方面更容易编程——坦率地说，Twisted`inlineCallbacks`在性能方面根本无法胜任许多协程的工作，而且在易用性/透明性条款：`yield`无处不`Deferreds`在；通常很难构建一些抽象；裸`Deferred`s 以及 . 甚至更是如此`@inlineCallbacks`.
*   您梦寐以求的 Twisted 的所有内置功能，包括但不限于`IReactorProcess.spawnProcess`.

我个人目前使用 Gevent 1.0rc2 和 Twisted 12.3 桥接`geventreactor`。我已经实现了我自己的尚未发布的添加和增强`geventreactor`，我将很快发布，希望作为`geventreactor`原始 GitHub 存储库的一部分：[https](https://github.com/jyio/geventreactor) ://github.com/jyio/geventreactor 。

我当前的布局允许我在 Gevent 的良好编程模型中进行编程，并利用诸如非阻塞和其他模块之类的`socket`东西`urllib2`。我可以使用常规的 Python 代码来做常规的事情，而不是像 Twisted 那样做一些简单、基本的事情所带来的学习曲线和不便。我还可以轻松地使用大多数通常与 Twisted 无关或需要使用线程的第 3 方库。

我还可以通过使用 greenlets（而不是`Deferred`s 和回调，和/或`@inlineCallbacks`）来完全避免尴尬且通常过于复杂的基于回调的编程。

（这个答案是根据我在现实生活项目中同时使用 Twisted 和 Gevent 的个人经验编写的，使用 Twisted 的经验要多得多（但我不声称自己是 Twisted 专家）。我必须编写的软件没有不必使用太多 Twisted 的功能，因此根据您需要的 Twisted 功能集，混合 Gevent 和 Twisted 的（相对轻松的）额外复杂性可能不值得麻烦。）

# javascript - 在字母之间添加分隔符

> ID：13941909
> 
> 赞同：4
> 
> 时间：2012-12-18T21:37:50.940
> 
> 标签：javascript, jquery, html, separator

我有以下 HTML 为一长串项目提供 ABC 链接，这些项目按字母表的字母分为页面。我无法更改 HTML。

```
<p>
    <a href="A.html">A</a>

    <!-- all the items on this page start with this letter 
         It is not contained in any special div, just floats among the links -->
    B

    <a href="c.html">C</a>        
    <a href="d.html">D</a>        
    <a href="e.html">E</a>        
    <a href="f.html">F</a>        
    <a href="g.html">G</a>

    <!-- and so on through z -->
</p> 
```

我需要在每个字母之间放置一个分隔符（以下 HTML）：

```
<span class="separator">|</span> 
```

但是，如果我在每个链接之前或之后放置一个分隔符，那么纯字母本身和它周围的一个链接之间将没有分隔符。

如何在不更改 HTML 的情况下在每个链接之间放置分隔符，记住任何字母都可以是没有包含`<a>`或任何其他标记的纯文本，除了外部`<p>`？

**编辑**以显示所需的结果（多种可能性中的两种）。粗体字母不是链接；所有其他字母是：

**一个**| 乙| C | D | E | F ...

一个 | 乙| **C** | D | E | F ...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:42:39.840

试试这个：

```
var p = // some method of getting the correct <p> tag
var c = p.childNodes, i, isfirst = true, s;
for(i=0;i<c.length;i++) { // skip the first child node
  if( c[i].tagName || c[i].nodeValue.match(/[a-z]/)) {
    // if node is a tag or a non-empty text node
    if( isfirst) isfirst = false; // skip first node
    else {
      s = p.insertBefore(document.createElement('span'),c[i]);
      s.className = "separator";
      s.appendChild(document.createTextNode("|"));
      i++; // IMPORTANT! Adding a node requires us to manually iterate forward one step!
    }
  }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:45:35.083

```
var separator = "<span class='separator'>|</span>";

$("p").contents().each(function(){
    var $this = $(this);

    if($.trim($this.text()).length>0){
        if(this.nodeType == 3){
            // text node, possibly multiple characters that need separation
            var characters = this.nodeValue.replace(/\s/g, "").split("");
            var output = "";

            for(var i=0; i<characters.length; i++){
                output += " " + characters[i] + separator;
            }                    

            $(this).replaceWith(output + " ");                
        } else {
            $this.after(separator);
        }
    }
});

$(".separator:last").remove(); 
```

[http://jsfiddle.net/kJ3yW/1/](http://jsfiddle.net/kJ3yW/1/)

# css - CSS 使用 :before 和 :after 插入括号图像但 :before 括号丢失构建导航栏

> ID：13941910
> 
> 赞同：1
> 
> 时间：2012-12-18T21:37:51.080
> 
> 标签：css, wordpress

我正在构建一个导航栏，需要在按钮之前和按钮之后插入一个括号，以便在悬停并选择时突出显示按钮，如下例所示

```
[  Button 1  ]    button 2    button 3    button 4 
```

我正在使用括号宽度=7px 高度=30px 的图像。我的 CSS 是有限的，我正在自学！**如果我使用position: relative** ，我已经设法让它全部工作，如下所示

```
#np-access a:hover:before{ 
  content: url(images/bracket-left.png); 
  position:relative;
  top: 10px; 
}

#np-access a:hover:after {
   content: url(images/bracket-right.png); 
   position:relative;
   top: 10px;
} 
```

但这会导致导航 '<strong>bounce' ，当鼠标悬停时按钮会向右移动。我改变了这个并使用了**position: absolute**，它可以工作，但是括号显示在文本 (narrow) 上。为了将它们分开一点，我添加了**left: 0.5px** for **:before**和**right: 0.5px** for **:after**可以工作，但是第一个括号丢失了，其他的看起来不错但是太近了，即按钮 2 右括号是太靠近按钮 3 左括号（无填充），但它们可以正常工作（下面的示例）。

```
 button 1  ][   button 2   ][  button 3  ][  button 4  ] 
```

为了尝试在括号中添加一些填充（按钮 2 右括号太靠近按钮 3 左括号），我将锚属性的填充从**1.5em**增加到**2em**，但紧随其后的是括号，并且外观保持不变

```
#np-access a {
color: #5F5B5B; 
display: block;
line-height: 3.333em;
padding: 0 1.5em;
text-decoration: none;

} 
```

为什么使用绝对位置时缺少第一个括号？以及如何添加填充？希望有人可以解释我哪里出错了！提前谢谢我的CSS在下面

```
#np-access .current-menu-item > a:after,
#np-access .current-menu-ancestor > a:after,
#np-access .current_page_item > a:after,
#np-access .current_page_ancestor > a:after {
 content: url(images/bracket-right.png); 
 position:absolute;
 right: 0.5px;
 top: 10px;
}

#np-access .current-menu-item > a:before,
#np-access .current-menu-ancestor > a:before,
#np-access .current_page_item > a:before,
#np-access .current_page_ancestor > a:before {
     content: url(images/bracket-left.png); 
     position:absolute;
     left: -0.5px;
     top: 10px; 
}

#np-access a:hover:before{ 
    content: url(images/bracket-left.png); 
    position:absolute;
    left: -0.5px;
    top: 10px; 
}

#np-access a:hover:after {
    content: url(images/bracket-right.png); 
    position:absolute;
    right: 0.5px;
    top: 10px; 
```

}

# 现在可以工作的代码

```
#np-access a:hover:before{ 
   content: url(images/bracket-left.png); 
    position:absolute;
    left: 1px;
    top: 10px; 
    padding: 0 10px;
 }

 #np-access a:hover:after {
    content: url(images/bracket-right.png); 
    position:absolute;
    right: 0.5px;
    top: 10px;
    padding: 0 10px;
  } 
```

谢谢大夫！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:41:34.840

左边的 -0.5px 导致第一个括号超出页面。

为什么在 :before 和 :after 上没有 left:0 right:0 但是在 #np-access a:hover 中添加了一个填充，比如 padding: 0 3px; ??

# gcc - 如何使用特定于 GCC 的 automake 启用标志

> ID：13941912
> 
> 赞同：4
> 
> 时间：2012-12-18T21:37:54.383
> 
> 标签：gcc, automake

我是 automake 的新手，但通过文档找到了自己的方式，并按照我的喜好构建了所有内容。但是，我目前打开了 CFLAGS="-Wall -Werror" 。虽然这对 gcc 非常有用，但我假设有人将使用非 gcc 编译器构建我的代码。检测是否正在使用 GCC 并仅为 GCC 设置这些标志的正确方法是什么？

**编辑**

解决方案如下所示：

1.  下载[http://www.gnu.org/software/autoconf-archive/ax_check_compile_flag.html](http://www.gnu.org/software/autoconf-archive/ax_check_compile_flag.html)并将宏放在项目的 ./m4/ 目录中。
2.  将以下行添加到您的 configure.ac：

    ```
    AX_CHECK_COMPILE_FLAG([-Wall], [CFLAGS="$CFLAGS -Wall"], [], [])
    AX_CHECK_COMPILE_FLAG([-Werror], [CFLAGS="$CFLAGS -Werror"], [], []) 
    ```

**编辑 2**

这个宏也可能比 -Wall 更有用，因为它对多个编译器做同样的事情：[http ://www.gnu.org/software/autoconf-archive/ax_cflags_warn_all.html](http://www.gnu.org/software/autoconf-archive/ax_cflags_warn_all.html)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-19T14:11:35.143

您可以使用 Autoconf 宏（例如[`AX_CHECK_COMPILE_FLAG`](http://www.gnu.org/software/autoconf-archive/ax_check_compile_flag.html).

# ios - 延迟后自动切换uiview

> ID：13941913
> 
> 赞同：2
> 
> 时间：2012-12-18T21:38:00.190
> 
> 标签：ios, xcode, cocoa-touch

我有两个为我的应用程序设计的视图！我想知道是否有任何方法可以在延迟 10 秒后自动切换视图！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:53:52.230

创建一个显示您的视图的方法。

调用该方法在 10 秒后显示

```
[self performSelector:@selector(showAnotherView) withObject:self afterDelay:10.0]; 
```

# jquery - 使用 jQuery 解析 JSON，给出单个字符而不是条目值

> ID：13941914
> 
> 赞同：0
> 
> 时间：2012-12-18T21:38:07.570
> 
> 标签：jquery, ajax, json

我有一个 AJAX 回调，它应该为数组中的每一行返回一个条目值

```
$.ajax({
    url: url,
    datatype: JSON,
    success: function(data){
        $.each(data, function (key, value){
            alert(key + ': ' + value);
        });
    },
    error: function(){
        alert('There was an error loading your request.  <br />Please try again later.');
    }
}); 
```

它不是`alert()`为每个条目做一个，而是`alert()`为数组中的所有单个字符做一个。就好像它在一个维度上钻得太远了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:41:32.703

这意味着您的日期没有被转换为 json，它正在循环响应字符串中的字符。验证数据是否如您所想。

我怀疑`datatype`需要是`dataType`，并且该参数的值需要是“json”

# algorithm - 如何使用集合中的权重一次有效地选择所有项目？

> ID：13941918
> 
> 赞同：0
> 
> 时间：2012-12-18T21:38:27.697
> 
> 标签：algorithm

我有一组对象，我想一次检查一个，直到检查完所有对象。每个对象都由具有许多可能重复项的预定义权重选择。最终结果将是集合中项目的有序列表。获取此列表的有效方法是什么？

例如，考虑以下具有指定体积的球：

```
A: 2
B: 3
C: 25
D: 100 
```

让我们在一个袋子中添加 4 个 A 球、3 个 B 球、1 个 C 球和 2 个 D 球。假设抽到特定球的概率与其体积成正比，那么此时抽到特定 D 球的概率为 100/242（它们具有相同的重量但不相同）。假设这个 D 被绘制并继续。此时抽到 C 的几率是 25/142，因为 D 球之前已被移除。假设你在这里画了 C 球并继续。继续画，直到所有的球都被移除，这样你就有了一个像 DCDBABBA 这样的序列。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:51:46.937

**[编辑：更新以添加单个球号]**

假设有不同类型的`n`球。`k`创建一个表示初始状态`k`的三元组的 -element 数组。`(balltype, weight, count)`执行此操作时，将每个添加`weight[i] * count[i]`到`total`从 0 开始的 。

首先，为每种球类型设置一个球号数组：

1.  `i`从 1到`k`:
    *   创建一个`count[i]`-element array `b[i]`，分配`j`给`b[i][j]`1 <= j <= `count[i]`。

现在随机挑选一个球。可以重复以下步骤`n`以随机顺序选择所有球：

1.  `r`选择一个介于 0 和- 1 之间的随机整数`total`，包括 0 和 - 1。
2.  设置`p`= 0。
3.  `i`从 1到`k`:
    *   添加`weight[i] * count[i]`到`p`.
    *   如果`r < p`：
        *   我们选择了一个类型的球`balltype[i]`。输出它。
        *   `c`在 1 和 之间选择一个随机整数`count[i]`，包括 1 和 。
        *   输出`b[i][c]`为球号。
        *   减少`count[i]`1。
        *   设置`b[i][c] = b[i][count[i]]`。这使未使用的球号保持“密集”。
        *   设置`total = total - weight[i]`。
        *   停止。

挑出所有`n`球需要 O( `nk`) 时间。`i`这可以通过将三元组数组中的最后一个条目移动到 0时`count[i]`（即当所有类型的球`i`都用完时）并减少1来加速大约 2 倍`n`，但是对于选择球的代码要继续工作，必须将整个数组`b[n]`也复制到`b[i]`，或者必须使用另一层间接。

# jquery - jquery draggable不想在chrome中工作

> ID：13941921
> 
> 赞同：1
> 
> 时间：2012-12-18T21:38:40.300
> 
> 标签：jquery, html, draggable, jsfiddle

我已经准备了一个带有代码的[jsfiddle](http://jsfiddle.net/jWRhr/11/)。

当“小气泡”被按下时，有一个大气泡和一个小气泡，（将名称更改为其他气泡会出现另一个气泡）。问题是它不想在 chrome 和 opera 中可拖动。在 IE 下它工作正常，我可以拖动两个气泡（它们一起移动）。在chrome或opera下，只有大的可以拖动，其他的不能。

所需的元素结构是

```
<div id="bubble-someUserName" class="bubbles-user" >
     <div class="bubbles-view"></div>
     <div class="bubbles-view"></div>
     <div class="bubbles-view"></div>
</div> 
```

我正在设置

```
$('.bubbles-user').draggable(); 
```

那我在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:56:44.390

**更新**

有几个问题：

1）在您正在使用的 JSFiddle

```
MainContainer().find('#bubbles-' + userName) ... 
```

这是寻找一个ID，而不是一个类。第二个气泡没有 id，也没有`bubbles-user`您要查找的类。

2）您的元素没有按照您期望的方式嵌套。

较小的气泡是较大气泡的子元素，而不是容器。这可能是因为您的动画要求。

3）即使你清除了这些，它也行不通。仍然不确定为什么，但我认为这与第 2 项有关，并且点击处理没有像预期的那样冒泡。您可能需要[`.delegate()`](http://api.jquery.com/delegate/)在某处使用 a 将处理程序附加到新创建的元素

# xml - 无法使用正则表达式定位某些 XML 元素

> ID：13941925
> 
> 赞同：0
> 
> 时间：2012-12-18T21:39:08.790
> 
> 标签：xml, regex, preg-match-all

我一直在使用正则表达式来定位 XML 元素之间的文本，它适用于 XML 树中的大多数元素。但是，在 Web 浏览器中查看原始 XML 文档时可单击/可扩展的元素不会成为正则表达式的目标。当我在 PHP 中使用 preg_match 时，我只得到一个空数组。

现在，我知道有效，但为了清楚起见，这里是：

```
$contents "random fetched xml doc";
$regex = '/<element>(.*?)<\/element>/';
preg_match_all($regex, $contents, $output);

print_r($output); 
```

**请注意：**我用谷歌搜索了这个问题，发现很多结果说你不应该用正则表达式解析 XML。我对学习如何解析 XML**不**感兴趣，我正在学习一种从网站上抓取数据的技术，我只是在包含 XML 页面的网站上练习，因为它们提供了直观的分隔符（XML 标记）。

我的问题很简单：如何修改我的正则表达式以定位可扩展的 XML 元素？

**编辑：已解决的问题** 该问题基于错误的前提。这个问题与 XML 无关，而是我的正则表达式匹配元素之间的任何内容，但换行符*除外。*在我的表达式末尾添加 /s 后，它就像一个魅力。谢谢你的时间！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T23:56:51.093

一段时间后我想通了。这个问题是基于错误的前提。这个问题与 XML 无关，而是我的正则表达式匹配元素之间的任何内容，但换行符除外。在我的表达式末尾添加 /s 后，它就像一个魅力。谢谢你的时间！

# android - 通过 Exchange Server 从 Android 应用程序自动发送电子邮件

> ID：13941927
> 
> 赞同：4
> 
> 时间：2012-12-18T21:39:12.877
> 
> 标签：android, email, exchange-server, email-client

有没有人尝试通过交换协议从您的 Android 应用程序自动发送电子邮件（无需用户交互）？我通过 SMTP 看到了很多示例，它们运行良好。但我想知道是否可以使用 Exchange 协议发送？android允许建立我们自己的交换客户端吗？

有什么图书馆可以使用吗？还是我应该从头开始构建？如果是这样，谁能指出我一个好的起点？

谁能给我一个线索？任何想法？有什么建议从哪里开始看？还是什么？

谢谢， 卡提克

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-24T20:51:50.450

作为移动用户，交换协议（取决于设置方式）几乎总是通过 HTTP/HTTPS 进行 RPC。ActiveSync 是替代方案，但没有什么优势。

您可能遇到的一个问题是 MS Exchange 的客户端访问策略要求 Exchange 服务器对电话进行一定程度的控制（强制 PIN 锁定、远程擦除电话等可能需要 root 访问权限）。还有证书信任要求。

如果您正在开发一个内部平台，那么查看 IMAP 哪个交易所做得相当好可能会更快。

# include - 需要文件会引发意外错误

> ID：13941928
> 
> 赞同：0
> 
> 时间：2012-12-18T21:39:17.913
> 
> 标签：include, require, php, require-once

我有一个课程包含在另一个课程中，但出现错误：

`PHP Parse error: syntax error, unexpected '$path' (T_VARIABLE)`

在类内部，`$path`变量实际上被注释掉了。

这是我包括的课程的一部分：

```
class SQLite {

private $name   = '';
private $dir    =  '';
private $handle = '';

public function __construct($class) {
    if(!$class) exit('Must supply class name.');

    $name = $this->name = preg_replace('/[^a-zA-Z0-9]+/', '_', $class);
    $dir  = $this->dir  = str_replace(basename(__DIR__), 'db', __DIR__);

        #$path = $this->dir . DIRECTORY_SEPARATOR . $this->name . '.sqlite3'; 
```

我不知道为什么我会收到这个错误。我尝试使用`require()`,`include()`等`require_once()`，但无济于事。我确定文件正在保存。我已经尝试通过我包含的类来扩展我的新类，并且我还尝试在新类的构造函数中创建它的实例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:48:02.930

有`new PDO('sqlite:' $path)`而不是`new PDO('sqlite:' . $path);`

# jquery - 记住选定的选项卡

> ID：13941930
> 
> 赞同：2
> 
> 时间：2012-12-18T21:39:46.160
> 
> 标签：jquery, jquery-ui, jquery-tabs

我试图弄清楚如何让 jquery-tabs 记住当表单被提交并重定向到 get 时哪个选项卡处于打开状态。我找到了很多例子，但他们都说要`ui.index`在`select`事件中使用[，文档中](http://api.jqueryui.com/tabs/#event-activate)都没有；我已经确认这`ui.index`不是该对象的一部分。`$("#MyTabs").tabs("option", "selected")`在事件中使用`activate`可以让我获得先前选择的选项卡的索引，而不是用户刚刚选择的选项卡。如，如果选择了选项卡 0 并单击选项卡 3，我得到 0，而不是 3。`active`如果我不知道索引，则无法使用该选项。

我应该只计算 jquery 变成选项卡的无序列表中的列表项，然后使用它们从 div ID 映射`ui.newPanel`，还是有更优雅的方法来做到这一点？一旦我得到了正确的索引，我可能会将它添加到查询字符串中。如果用户打开了多个窗口或浏览器选项卡，cookie 解决方案并不适合我。

**编辑**：问题是该`active`选项需要一个索引，但事件的`ui`参数`activate`似乎只给了我选项卡和选项卡内容的`li`and`div`元素。由于曾经有一处`ui.index`房产，我想知道我是否遗漏了什么。

**编辑**：感谢 Kush，这是我使用的解决方案；为简洁起见，我省略了一些代码。

```
function Document_OnReady() {
    $("#MyTabs").tabs({
        active: $("input.InitialTabIndex").val()
    });

function SetInitialTab() {
    $("input.InitialTabIndex").val($("#MyTabs").tabs("option", "selected"));
}

function Form_OnSubmit() {
    SetInitialTab();
} 
```

当服务器处理 POST 时，我读取表单值，然后在重定向到 get 时将其添加到查询字符串中。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:41:59.827

一般情况下，服务器端代码会为所选元素添加一个类名，并将页面输出到浏览器。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-19T13:38:43.957

创建一个隐藏字段。单击任何选项卡时，将选项卡索引保留在该隐藏字段上，这样下次重定向页面不会有问题。您可以使用隐藏字段表单元素来重定向页面。

```
$('#hidden_field').val($tabs.tabs('option', 'selected')); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-12-19T13:38:46.680

试试这个：

```
<div id="selector" class="ui-mainColTabs">
    <ul>
        <li><a href="#tabs-1">Tab 1</a></li>
        <li><a href="#tabs-2">Tab 2</a></li>
    </ul>
    <div id="tabs-1"></div>
    <div id="tabs-2"></div>
</div>

<form id="form">
    <input type="submit" value="Kill" />
</form>

<a href="#" id="getCookie">Get</a>

<script type="text/javascript">
<!--
$(document).ready(function() {
    $("#selector").tabs({
        cookie: {
            name: 'tab_cookie',
            expires: 7
        }
    });

    $('#getCookie').click(function() {
        alert($.cookie('tab_cookie'));
    });

    $('#form').submit(function() {
        alert($.cookie('tab_cookie'));
    });
});
//-->
</script> 
```

您需要从[**这里添加 jQuery cookie 文件**](https://github.com/carhartl/jquery-cookie)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-12-19T13:35:58.700

记住数据适用于

```
jQuery.data('key', data); 
```

# javascript - Javascript循环结构需要测试多个条件并推送一组自定义对象

> ID：13941931
> 
> 赞同：0
> 
> 时间：2012-12-18T21:39:45.857
> 
> 标签：javascript, arrays, json, object

我的代码在这里有一点逻辑问题，想知道是否有人能指出我正确的方向。

约束：

1.  推送的每个项目都是一个事件，按“名称”分组并内联显示在图表中。
2.  EPC、M1 或 M2 的值可能为 null。
3.  应该使用第一个非空时间线的“开始”和下一个非空时间线值的“结束”来创建事件。（无需检查 m2 以外的内容，因为没有任何内容包含空值）。每组至少应有 4 个里程碑。
4.  应该继续，直到不再存在“组”（内容[i].name）。

目前，我的代码有几个问题：

1.  每组只创建一个事件。
2.  EPC 在迭代中未考虑，并且如果开始且非空则未处理。

这是代码：

```
getMileStone = function(obj) {
    if(!obj) { return };
        propCounter = 1;
        newcount = 0;
        for(propCounter = 1; propCounter <= 7; propCounter++) {
            if(obj.timeline["m" + propCounter]) {
                data[newcount] = {key: "m" + propCounter, value: obj.timeline["m" + propCounter]};
                return data[newcount];
                newcount++;
            }
         }

        };

        getSecondStone = function(obj) {

            switch(getMileStone(current).key){

                case 'm1': return {value: obj.timeline['m2']};
                break;
                case 'm2': return {value: obj.timeline['m3']};
                break;
                case 'm3': return {value: obj.timeline['m4']};
                break;
                case 'm4': return {value: obj.timeline['m5']};
                break;
                case 'm5': return {value: obj.timeline['m6']};
                break;
                case 'm6': return {value: obj.timeline['m7']};
                break;
                default: return {value: obj.timeline['m1']};
            }

        };

for(i=0;i< content.length;i++) {
 current = content[i];
 firstMileStone = getMileStone(current); 
 secondMileStone = getSecondStone(current);
  result.push({
  'start': new Date(current.epc || firstMileStone.value),
  'end': new Date(current.m1 || secondMileStone.value),
  'content': firstMileStone.key,
  'group' : current.name,
  'className' : firstMileStone.key
 });
} 
```

这是正在读取的数组内容：

```
content = [{
"name": "5-HP-N/A-N/A-F8",
"node": {
    "name": "5",
    "id": 14
},
"timeline": {
    "epc": null,
    "m1": null,
    "m2": null,
    "m3": 1554087600000,
    "m4": 1593572400000,
    "m5": 1625108400000,
    "m6": 1641006000000,
    "m7": 1656644400000
},
"fab": {
    "name": "F8",
    "id": 1
  }
},
{
  "name": "7-HP-N/A-N/A-F8",
  "node": {
    "name": "7",
    "id": 15
},
"timeline": {
    "epc": null,
    "m1": null,
    "m2": null,
    "m3": 1491015600000,
    "m4": 1530414000000,
    "m5": 1561950000000,
    "m6": 1577847600000,
    "m7": 1593572400000
},
"fab": {
    "name": "F8",
    "id": 1
  }
},
{
"name": "5-XM-N/A-PLT-F8",
"node": {
    "name": "5",
    "id": 14
},
"timeline": {
    "epc": null,
    "m1": null,
    "m2": null,
    "m3": 1554087600000,
    "m4": 1593572400000,
    "m5": 1625108400000,
    "m6": 1641006000000,
    "m7": 1656644400000
},
"fab": {
    "name": "F8",
    "id": 1
  }
},
{
"name": "40-LP-TFS-FSL-F7",
"node": {
    "name": "40",
    "id": 4
},
"timeline": {
    "epc": 1349060400000,
    "m1": null,
    "m2": null,
    "m3": 1262314800000,
    "m4": 1301626800000,
    "m5": 1333249200000,
    "m6": 1341111600000,
    "m7": 1357009200000
},
"fab": {
    "name": "F7",
    "id": 3
  }
},
{
"name": "40-LP-SST-TI-F7",
"node": {
    "name": "40",
    "id": 4
},
"timeline": {
    "epc": 1349060400000,
    "m1": null,
    "m2": null,
    "m3": 1262314800000,
    "m4": 1301626800000,
    "m5": 1333249200000,
    "m6": 1341111600000,
    "m7": 1357009200000
},
"fab": {
    "name": "F7",
    "id": 3
  }
},
{
"name": "28-LPQ-TN3-QCOM-F1",
"node": {
    "name": "28",
    "id": 2
},
"timeline": {
    "epc": 1349060400000,
    "m1": null,
    "m2": null,
    "m3": 1285902000000,
    "m4": 1325386800000,
    "m5": 1357009200000,
    "m6": 1372647600000,
    "m7": 1388545200000
},
"fab": {
    "name": "F1",
    "id": 2
}
}]; 
```

目前，所有创建的事件也以 m3 开头。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-19T00:12:26.127

我对你之前的问题发表了评论。这是我的评论的实现。

```
// get all non-null milestones
getMileStone = function (obj) {
    var result = [];

    for (var o in obj.timeline) {
        if (obj.timeline[o]) {
            result.push({ key: o, value: obj.timeline[o] });
        }
    }
    //dummy value for end pairing
    result.push({key: 'end', value : null});
    return result;
};

// loop over content array (seems like you have an array of objects)
for (var i = 0; i < content.length; i++) {
    current = content[i];
    var milestones = getMileStone(current);

    //loop through the non-null milestones
    for (var j = 0; j < milestones.length - 1; j++) {
        result.push({
            'group': current.name,
            'content': milestones[j].key,
            'start': new Date(milestones[j].value),
            'end': milestones[j + 1].value != null ? new Date(milestones[j + 1].value):null,
            'classname': milestones[j].value
        });
    }

} 
```

# javascript - 唯一 ID 或对象签名

> ID：13941933
> 
> 赞同：2
> 
> 时间：2012-12-18T21:39:49.507
> 
> 标签：javascript

我正在开发一个日志记录系统，并期待实现一次*日志记录*方法。

我坚持的是，我将如何检索唯一标识符和/或对象签名，以用作哈希键？

我的想法是：

```
var Log = {
    messages : {},
    once : function(message)
    {
        // get unique id and/or passed objects signature, use it as a key
        var key = unique( message );

        if ( !Log.messages.hasOwnProperty(key) )
        {
            Log.messages[key] = message;
        }
    }
}; 
```

我试过`.toString()`了，但它确实只是`[object Object]`为一个基本对象和`[object <type>]`其他任何东西返回。没有身份证，什么都没有。

我也尝试了该`toSource()`功能，但在 Chrome 中它不想使用基本对象。

不过，我需要的是让它适用于每种类型的对象。无论是字符串、整数还是函数，我都需要获取该签名/ID。

也许已经在某个地方实现了这样的功能？

## 更新

这意味着在循环中进行日志记录，但不是每次迭代都记录，而是只记录一次，以防止控制台污染。

我的特定循环实际上是一个游戏循环，我希望调试一些信息。

喜欢：

```
for (var i = 0; i < 100; i++)
{
    console.log('message');
}
// this would log 100 entries 
```

在哪里：

```
for (var i = 0; i < 100; i++)
{
    Log.once('message');
}
// would execute behind the scenes console.log() only once. 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T22:02:17.407

您可以使用`JSON.stringify`来获取任意值的“签名”。当然这不会保存对象类型，也不适用于`Date`or`Function`实例；它也不区分具有相同值的不同对象。如果需要，您需要存储对它们的显式引用（当然会阻碍垃圾收集器释放它们）：

```
var loggedVals = [];
console.once = function() {
    var args = [].slice.call(arguments).filter(function(arg) {
        return (loggedVals.lastIndexOf(arg)==-1) && loggedVals.push(arg);
    });
    if (args.length)
        console.log.apply(console, args);
}); 
```

如果您不想存储对它们的引用，则需要通过添加隐藏属性将它们标记为“已记录”（就像 UID 生成器那样）：

```
… function(arg) {
        return !arg.__hasbeenlogged__ && 
          Object.defineProperty(arg, "__hasbeenlogged__", {value: true});
          // configurable, enumarable and writable are implicitly false
    } … 
```

请注意，此解决方案不适用于原始值，甚至无法用于`null`and `undefined`- 您可能需要混合使用这两种方法。

# mysql - Mysql子查询优化-如何减少/删除子查询

> ID：13941937
> 
> 赞同：0
> 
> 时间：2012-12-18T21:40:04.933
> 
> 标签：mysql

经过多次传递后，我想知道是否可以进一步优化此查询？非常感谢任何见解。除了必须使用一堆不理想的子查询之外，我还必须使用其中一个两次，因为“标签”引用不能在 where 子句中使用......（无法弄清楚如何将此重写为连接以解决该问题）

```
SELECT `t1`.*, 
(SELECT GROUP_CONCAT(tag_id) FROM media_tag WHERE media_id=t1.id GROUP BY media_id ) as tags, 
(SELECT GROUP_CONCAT(award_id) FROM media_award WHERE media_id=t1.id GROUP BY media_id ) as awards, 
(SELECT GROUP_CONCAT(client_id) FROM media_client WHERE media_id=t1.id GROUP BY media_id ) as clients, 
(SELECT GROUP_CONCAT(collaborator_id) FROM media_collaborator t2 LEFT JOIN collaborator t3 ON t2.collaborator_id=t3.id WHERE media_id=t1.id AND t3.collaborator_type_id='1' GROUP BY media_id ) as agencies, 
(SELECT GROUP_CONCAT(collaborator_id) FROM media_collaborator t2 LEFT JOIN collaborator t3 ON t2.collaborator_id=t3.id WHERE media_id=t1.id AND t3.collaborator_type_id<>'1' GROUP BY media_id ) as collaborators, 
`t2`.`idx`, `t2`.`type` 
FROM (`media` t1) 
LEFT JOIN `sort` t2 ON `t1`.`id`=`t2`.`id` AND t2.type="media" 
WHERE 
    FIND_IN_SET('1',(SELECT GROUP_CONCAT(tag_id) FROM media_tag WHERE media_id=t1.id GROUP BY media_id )) 
    AND IF(t2.tag_id IS NOT NULL,t2.tag_id='1',1) 
GROUP BY `t1`.`id` 
ORDER BY `t1`.`date_mod` DESC, `title` ASC, `t2`.`idx` ASC, `date_mod` DESC, `title` ASC 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-18T21:53:05.197

你应该尽量减少每一行的选择语句，你可以加入那些行并按一些标识符分组，如果你可以发布你的表结构并告诉我们你想从他们那里得到什么信息会更好......

# oracle - 不能在 CREATE TABLE 中使用内联约束

> ID：13941938
> 
> 赞同：4
> 
> 时间：2012-12-18T21:40:07.193
> 
> 标签：oracle, sqlplus

我在 Oracle 中有以下内容作为 CREATE TABLE：

```
CREATE TABLE cs2_users (
    empnum     varchar2(12) PRIMARY KEY,
    toolsId    varchar2(20) 
        CONSTRAINT nn_cs2_users_toolsId NOT NULL
        CONSTRAINT fk_cs2_users_users FOREIGN KEY REFERENCES users.userid,
    admin      number(1,0) DEFAULT 0
        CONSTRAINT nn_cs2_users_admin NOT NULL
        CONSTRAINT ck_cs2_users_admin (admin IN (0,1)),
    givenname  varchar2(30) NOT NULL,
    middlename varchar2(30),
    sn         varchar2(30) NOT NULL,
    mail       varchar2(50) NOT NULL
); 
```

但是它失败并出现此错误：

```
ERROR at line 5:
ORA-02253: constraint specification not allowed here` 
```

当我使用 SQL*Plus 连接时，这是版本信息：

```
SQL*Plus: Release 11.2.0.3.0 Production on Tue Dec 18 16:38:27 2012

Copyright (c) 1982, 2011, Oracle.  All rights reserved.

Connected to:
Oracle Database 11g Enterprise Edition Release 11.2.0.3.0 - 64bit Production
With the Partitioning, OLAP, Data Mining and Real Application Testing options 
```

帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-12-18T21:50:11.433

如果要指定内联约束，则该定义与列的定义是分开的。如果要创建约束，则需要指定约束的类型`CHECK`。并且您的外键约束需要指定您引用的列。因此，例如，这将起作用

```
SQL> create table users( userid varchar2(20) primary key );

Table created.

SQL> CREATE TABLE cs2_users (
  2      empnum     varchar2(12) PRIMARY KEY,
  3      toolsId    varchar2(20) constraint nn_cs2_users_toolsId NOT NULL,
  4          CONSTRAINT fk_cs2_users_users FOREIGN KEY(toolsId) REFERENCES users(userid),
  5      admin      number(1,0) DEFAULT 0 constraint nn_cs2_users_admin NOT NULL,
  6          CONSTRAINT ck_cs2_users_admin CHECK(admin IN (0,1)),
  7      givenname  varchar2(30) NOT NULL,
  8      middlename varchar2(30),
  9      sn         varchar2(30) NOT NULL,
 10      mail       varchar2(50) NOT NULL
 11  );

Table created. 
```

尽管从. `toolsId`_ 您似乎更有可能希望该列从表中引用该列，或者您希望将该列命名为，如果您想从. 但是我会质疑为什么你有一个单独的列，而不是简单地将这些信息放在表格中。`userId``users``toolsId``toolsId``tools``userId``userId``users``cs2_users``users`

# c# - 将datagridview值与数组中的项目进行比较

> ID：13941942
> 
> 赞同：1
> 
> 时间：2012-12-18T21:40:27.453
> 
> 标签：c#, winforms, datagridview

我在 C# winforms 应用程序中有一个 datagridview，我将每行中某个单元格中的值与我从文件中读取的数组中的一个项目进行比较。

```
 foreach (DataGridViewRow dr in dataGridView2.Rows)
                {
                    if (dr.Cells[AcctNoIndex-1].Value == items[custAcctNo-1])//row in datagridview that contains the customer account number
                    {
                        items[custState-1] = dr.Cells[ShipStateIndex-1].Value.ToString();
                        items[custCountry-1] = dr.Cells[ShipCountryIndex-1].Value.ToString();
                        items[custShipState-1] = dr.Cells[ShipStateIndex-1].Value.ToString();
                        items[custShipCountry-1] = dr.Cells[ShipCountryIndex-1].Value.ToString();
                    }

                } 
```

因此，对于 datagridview 中的每一行 dr，我查看 AcctNoIndex-1 处的单元格。如果该值等于该数组中的值，我将一些数据读入 items[custAcctNo-]，我将执行以下操作。

然而，我正在调试代码，并在 Watch 窗口中注意到 items[custAcctNo-1] 与 dr.Cells[AcctNoIndex-] 相同。对于其中一行，值是相同的。但是，当我单步调试调试器时，程序会跳过 if 块中的所有内容并继续。

![我的调试输出](../Images/55b8bd3eb71249e1ed49fdb10afb819c.png)

谁能帮我这个？我认为由于两个值都是字符串，因此条件应该为真，并且程序应该在 if 块中继续，但我对调试器为什么认为这两个值不一样感到困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:43:36.143

一个说字符串，一个是对象。将它们都转换为字符串，它会起作用。

# linux - 为什么 dlsym() 返回的符号的值可以为空？

> ID：13941944
> 
> 赞同：7
> 
> 时间：2012-12-18T21:40:34.863
> 
> 标签：linux, dlsym

在 Linux 中。根据 dlsym(3) Linux 手册页，

```
 *Since the value of the symbol could actually be NULL
    (so that a NULL return from dlsym() need not indicate an error),* 
```

为什么会这样，什么时候一个符号（特别是对于一个函数）实际上是 NULL？我正在查看代码，发现了一段使用 dlerror 先清理，然后使用 dlsym，然后使用 dlerror 检查错误。但它不会在调用它之前检查结果函数是否为空：

*   dlerror();
*   a_func_name = ...dlsym(...);
*   if (dlerror()) 转到结束；
*   a_func_name(...); // 从不检查 a_func_name == NULL;

我只是一个审阅者，所以没有添加检查的选项。也许作者知道 NULL 永远无法返回。我的工作是挑战这一点，但不知道什么可以使它返回有效的 NULL，因此我可以检查在此代码的上下文中是否可以满足这样的条件。没有找到合适的东西来谷歌阅读，一个好的文档的指针就足够了，除非你想明确地解释哪个会很棒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2018-12-03T08:32:24.303

我知道 dlsym() 返回的符号值可以为 NULL 的一种特殊情况，即在使用[GNU 间接函数](https://willnewton.name/2013/07/02/using-gnu-indirect-functions/)(IFUNC) 时。但是，可能还有其他情况，因为[dlsym(3) 手册页](http://man7.org/linux/man-pages/man3/dlsym.3.html)中的文本早于 IFUNC 的发明。

这是一个使用 IFUNC 的示例。首先，将用于创建共享库的文件：

```
$ cat foo.c 
/* foo.c */

#include <stdio.h>

/* This is a 'GNU indirect function' (IFUNC) that will be called by
   dlsym() to resolve the symbol "foo" to an address. Typically, such
   a function would return the address of an actual function, but it
   can also just return NULL.  For some background on IFUNCs, see
   https://willnewton.name/uncategorized/using-gnu-indirect-functions/ */

asm (".type foo, @gnu_indirect_function");

void *
foo(void)
{
    fprintf(stderr, "foo called\n");
    return NULL;
} 
```

现在是主程序，它将`foo`在共享库中查找符号：

```
$ cat main.c
/* main.c */

#include <dlfcn.h>
#include <stdio.h>
#include <stdlib.h>

int
main(int argc, char *argv[])
{
    void *handle;
    void (*funcp)(void);

    handle  = dlopen("./foo.so", RTLD_LAZY);
    if (handle == NULL) {
        fprintf(stderr, "dlopen: %s\n", dlerror());
        exit(EXIT_FAILURE);
    }

    dlerror();      /* Clear any outstanding error */

    funcp = dlsym(handle, "foo");

    printf("Results after dlsym(): funcp = %p; dlerror = %s\n",
            (void *) funcp, dlerror());

    exit(EXIT_SUCCESS);
} 
```

现在构建并运行以查看`dlsym()`返回的情况`NULL`，同时`dlerror()`也返回`NULL`：

```
$ cc -Wall -fPIC -shared -o libfoo.so foo.c
$ cc -Wall -o main main.c libfoo.so -ldl
$ LD_LIBRARY_PATH=. ./main
foo called
Results after dlsym(): funcp = (nil); dlerror = (null) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:45:00.320

好吧，如果它没有错误地返回，那么指针是有效的，并且与`NULL`来自共享对象的任何随机指针一样非法。比如错误的函数、数据或其他什么。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2018-12-03T09:24:28.100

如果库/PIE 是普通 C 编译的产物，则不可能，因为 C 永远不会将全局对象放在`NULL`地址处，但您可以获得一个符号来解析以`NULL`使用特殊的链接器技巧：

空.c：

```
#include <stdio.h>
extern char null_addressed_char;
int main(void) 
{
    printf("&null_addressed_char=%p\n", &null_addressed_char);
} 
```

编译、链接和运行：

```
$ clang null.c -Xlinker --defsym -Xlinker null_addressed_char=0 && ./a.out
&null_addressed_char=(nil) 
```

如果您不允许任何此类怪异，您可以将`NULL`返回的结果`dlsym`视为错误。

* * *

## 回答 #4

> 赞同：-2
> 
> 时间：2012-12-18T22:08:57.877

`dlerror()`返回最后一个错误，而不是最后一次调用的状态。因此，如果没有其他问题，您显示的代码可能会从中获得**有效**结果，`dlsym()`并自欺欺人地认为存在错误（因为队列中还有一个错误）。dlerror 背后的目的是提供人类可读的错误消息。如果您没有打印结果，则说明您使用错误。

# php - 切割字符串大小时如何阻止 bbcode 被切断？

> ID：13941945
> 
> 赞同：0
> 
> 时间：2012-12-18T21:40:36.620
> 
> 标签：php, regex

目前，我正在将文本传递给此函数，以将其缩短为有 255 个字符限制的标语：

```
function myTruncate($string, $limit, $break=".", $pad="...") 
{ 
    // return with no change if string is shorter than $limit 
    if(strlen($string) <= $limit)
    {
        return $string; 
    }

    // is $break present between $limit and the end of the string? 
    if(false !== ($breakpoint = strpos($string, $break, $limit))) 
    { 
        if($breakpoint < strlen($string) - 1) 
        { 
            $string = substr($string, 0, $breakpoint) . $pad; 
        } 
    } 
    return $string; 
} 
```

问题是它不断切断 bbcode，如果它在任何 bbcode 标签内，有没有办法让它完成它被切断的任何东西？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:47:48.190

不要解析你自己的 BBCode。使用`BBCode`PHP 自带的模块。

[http://php.net/manual/en/book.bbcode.php](http://php.net/manual/en/book.bbcode.php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-19T00:20:46.940

可能没有简单的解决方案。您需要检查整个输入字符串字符以查找记住内存堆栈中每个打开的 bbcode 标记的字符（= 也称为 Lexer）。然后，如果您的字符数已达到限制，您需要附加您存储在堆栈中的所有关闭 bbcode 标记。

此外，您的 truncate 函数还有一个很大的缺点，就是它将 bbcode 标签本身计为文本长度的一部分。想象一个用户通过 [url=http://very long link]picture[/url] 发布一个 250 字符长的链接。例如，Google 图片会创建如此长的链接。

您最好的选择是完全去除这些情况下的 bbcode，除非该功能证明 5-20 小时的解决方案编程是合理的。

# node.js - 无法将日志保存到 winston-nodejs 的 mongodb 数据库

> ID：13941957
> 
> 赞同：7
> 
> 时间：2012-12-18T21:41:49.340
> 
> 标签：node.js, mongodb, logging, winston

我正在使用 winston 库：[https](https://github.com/flatiron/winston) ://github.com/flatiron/winston 尝试将数据存储到 mongodb 数据库：[https ://github.com/indexzero/winston-mongodb](https://github.com/indexzero/winston-mongodb)

插入我使用的数据：

```
var MongoDB = require('winston-mongodb').MongoDB;
var logger = new (winston.Logger)({
transports: [
    new (winston.transports.Console)(),
    new (winston.transports.MongoDB)({ host: ip,  db: 'caribcultivate', collection: 'log', level: 'info'})
], exceptionHandlers: [ new winston.transports.Console() ]
});
logger.log('info', "Running logs "+ d);
logger.info("Drive: "+ (new Date(d)).toDateString()); 
```

但是，当我尝试使用以下方法查询数据时：

```
winston.query(options, function (err, results) {
    if (err) {console.log(err);}
    console.log(results);
}); 
```

我得到：

```
{} 
```

它适用于控制台，并且我正在使用 Mongoose 库在应用程序的其他部分中使用数据库。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-07-22T04:06:36.303

I was having a similar issue. It turned out the problem for me was that the Winston MongoDB transport expects the host option to be just the host name and I was prefixing it with `mongodb://`.

The following works for me after removing `mongodb://` from `mongodb://123456.mongolab.com`:

```
var logger = new(winston.Logger)({
    transports : [
        new(winston.transports.MongoDB)({
            db : 'logs',
            host : '123456.mongolab.com',
            username : 'username',
            password : 'password'
        })
    ]
}); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2015-12-08T10:26:18.793

它应该很简单，它将全部在一行中：

```
db : 'mongodb://myuser:mypass@ds047777.mongolab.com:54545/MyLogDB 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-09-25T17:16:11.583

如果您在 2021 年使用它，这是使用 MONGODB 的 logger.js 示例

```
mongodb://<username>:<password>@mernshopping-shard-00-00.tzqom.mongodb.net:27017,mernshopping-shard-00-01.tzqom.mongodb.net:27017,mernshopping-shard-00-02.tzqom.mongodb.net:27017/myFirstDatabase?ssl=true&replicaSet=MernShopping-shard-0&authSource=admin&retryWrites=true&w=majority 
```

```
const {createLogger, format, transports} =require('winston');
require('winston-mongodb');
const env= require('dotenv');
env.config();

const MONGO_URI = process.env.WINSTON_MONGODB_URI;

module.exports = createLogger({
    transports:[

 // File transport
    new transports.File({
    filename: 'logs/winstonLogs.log',
    format:format.combine(
        format.timestamp({format: 'MMM-DD-YYYY HH:mm:ss'}),
        format.align(),
        format.printf(info => `${info.level}: ${[info.timestamp]}: ${info.message}`),
    )}),
    new transports.MongoDB({
        level:'info',
        db: MONGO_URI,
        options:{
            useUnifiedTopology:true
        },
        collection:'server_logs',
        format:format.combine(
            format.timestamp(),
            //convert logs to a json format for mongodb
            format.json()
                )
    })
    ]
}) 
```

# firefox - 让 Firefox 在启动时运行 XUL 类型脚本

> ID：13941960
> 
> 赞同：3
> 
> 时间：2012-12-18T21:42:07.133
> 
> 标签：firefox, firefox-addon, xul

在 Firefox 17.0.1 中，我使用了一个名为**KeyConfig 20110522**的附加组件来设置一些新的热键，并为我的新键以及不需要这样做的附加组件设置`acceltext`of 。`menuitems`

我*希望*在*Firefox 启动时*`acceltext`设置`menuitems`，但目前我只是使用热键通过*KeyConfig*对 UI 执行以下代码：

 **```
document.getElementById("tabmix-menu")
  .setAttribute("acceltext","Alt+Ctrl+Shift+T");
// more of the same... 
```

我需要一些初学者提示：

*   如何以与通过控制台对 HTML 页面执行相同的方式对 UI 执行任意代码？

*   有没有一种偷偷摸摸的方法来让一堆代码在浏览器启动时执行而无需深入研究 XUL 开发？

*   有没有办法跟踪对 UI 执行的命令，这样当我设置热键时，我可以调用命令而不是使用触发器：

`document.getElementById("tabmix-menu").click();`

也欢迎有关此类低级黑客攻击的任何其他提示。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-12T08:16:18.957

您可以从插件对 Firefox UI 执行任意代码，但正如您所说，做所有与 XUL 相关的事情有点无聊:-)

输入“自举”扩展！

**第1部分：**

“Bootstrapped”（或重新启动）扩展只需要一个 install.rdf 文件来识别插件，以及一个 bootstrap.js 文件来实现引导接口。

*   引导扩展：[https ://developer.mozilla.org/en-US/docs/Extensions/Bootstrapped_extensions](https://developer.mozilla.org/en-US/docs/Extensions/Bootstrapped_extensions)

*   很好的例子：[http ://blog.fpmurphy.com/2011/02/firefox-4-restartless-add-ons.html](http://blog.fpmurphy.com/2011/02/firefox-4-restartless-add-ons.html)

bootstrap 接口可以非常简单地实现：

```
function install() {}
function uninstall() {}
function shutdown(data, reason) {}
function startup(data, reason) { /* YOUR ARBITRARY CODE HERE! */ } 
```

`install.rdf`通过将和`bootstrap.js`放入新 zip 文件的顶层来编译扩展名，并将zip 文件扩展名重命名为 .xpi。

**第2部分：**

您的代码具有特权，可以使用任何 Mozilla 平台 API。但是有一个时间问题。执行“启动”功能的时刻是尚不存在 Chrome 窗口对象的时刻！

如果您有一个 Chrome 窗口对您的代码很重要，我们需要等待它出现：

```
// useful services.
Cu.import("resource://gre/modules/Services.jsm");    
var loader = Cc["@mozilla.org/moz/jssubscript-loader;1"]
                .getService(Ci.mozIJSSubScriptLoader);

var wmSvc = Cc["@mozilla.org/appshell/window-mediator;1"]
                .getService(Ci.nsIWindowMediator);

var logSvc = Cc["@mozilla.org/consoleservice;1"]
                .getService(Ci.nsIConsoleService);

// get the first gBrowser 
var done_startup = 0;
var windowListener;
function do_startup(win) {

    if (done_startup) return;
    done_startup = 1;
    wmSvc.removeListener(windowListener);

    var browserEnum = wmSvc.getEnumerator("navigator:browser");
    var browserWin = browserEnum.getNext();
    var tabbrowser = browserWin.gBrowser;

    /* your code goes here! */
}

// window listener implementation
windowListener = {
    onWindowTitleChange: function(aWindow, aTitle) {},
    onCloseWindow:       function(aWindow) {},
    onOpenWindow:        function(aWindow) {
        var win = aWindow.QueryInterface(Ci.nsIInterfaceRequestor)
                     .getInterface(Ci.nsIDOMWindowInternal || Ci.nsIDOMWindow);
        win.addEventListener("load", function(aEvent) {
            win.removeEventListener("load", arguments.callee, false);
            if (aEvent.originalTarget.nodeName != "#document") return;
            do_startup();
        }
};

// CODE ENTRY POINT (put this in bootstrap "startup" function)
wmSvc.addListener(windowListener); 
```**

# php - 处理 CodeIgniter 中每个页面上的表单

> ID：13941965
> 
> 赞同：0
> 
> 时间：2012-12-18T21:42:19.850
> 
> 标签：php, forms, codeigniter

我使它工作的方式是创建一个专用控制器来处理我在多个页面上重复的表单，即`somedomain.com/form/callmeback/`到目前为止一切都很好。但是，一旦验证器完成它的工作，我需要返回到提交表单的页面，显示要显示的错误列表或发送消息，然后返回原始表单页面并显示成功消息。

实现这一目标的“最佳”方式是什么？

到目前为止，我的想法一直停留在使用`$_SERVER['HTTP_REFERER']`或以 a`current_url()`作为其值的隐藏字段上，然后就这样做，`header('Location:'.$_POST['ref'])`但这不允许我发回验证错误。

**[编辑]**

最后，我使用 codeIgniter 会话闪存数据功能解决了我的问题

```
//redirect back to source
    if($_SERVER['HTTP_REFERER'] && strpos($_SERVER['HTTP_REFERER'], base_url()) !== false) {
        //do form handling stuff here
        $this->session->set_flashdata('callmeback_errors', validation_errors());
        header('Location:' . $_SERVER['HTTP_REFERER']);
    } else {
        //invalid referer, do nothing say nothing, pretend the page doesn't exist
        show_404();
    } 
```

谢谢你的想法:)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:48:22.323

Flash 会话是个好主意，但我不确定它是否能正常工作`validation_errors()`，

但我有一个不同的想法，而不是专用控制器和专用助手来执行相同的功能，包括这样您就不必更改控制器并将 POST 数组发送到助手功能，希望这会有所帮助

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T18:37:34.263

将您的错误序列化到会话中，然后在下一个请求（如“flash”消息）中将其删除。我以前用 Symfony 做过类似的事情。

# c# - 在 C# 中从 XML 加载对象数据

> ID：13941966
> 
> 赞同：0
> 
> 时间：2012-12-18T21:42:26.980
> 
> 标签：c#, xml, serialization

我有以下课程：

```
[Serializable]

public class SerialAssassin
{
    public Hero hero;
    public Point heroPB;
    public Boss boss;
    public Point bossPB;
    public Attack attack;
    public Point attackPB;
    public HPMeter bossHP;
    public Point bossHPPB;
    public PPMeter heroPP;
    public Point heroPPPB;

    public Rectangle bossRect;
    public Rectangle attackRect;

    public int heroState;
    public int stepRate;
    public int attackDirection;
    public int attackLoop;
    public int contadorPaso;
    public int contadorPasoBoss;
    public int bossTop, bossLeft;
    public int bossState;
    public int bossHealth;
    public int bossHPCap;
    public int opa;
    public int battlesWon;
    public int mainBossCounter;
    public int ppleft;
    public bool paso;
    public bool inStadium;
    public bool fading;
    public bool fightingMainBoss;
    public bool fainted;
    public string currentPokemon;
} 
```

我在从 XML 读取数据时遇到问题，其编写如下：

```
XmlSerializer serializer = new XmlSerializer(typeof(SerialAssassin));
TextWriter textWriter = new StreamWriter(@"..\..\Resources\saveState.xml");
serializer.Serialize(textWriter, serial);
textWriter.Close(); 
```

从那里，我不太清楚如何读取数据。再加上 XML 不序列化 Hero、Boss、Attack、HPMeter、PPMeter 的对象这一事实。

英雄等级：

```
public class Hero
    {

        int state = 0;
        int x, y;
        string path;
        Image img;

        //methods
    } 
```

如果您能向我解释如何加载这些对象/基元然后使用它们，我将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-12-18T21:48:46.920

~~IIRC，`XmlSerializer`检查属性，而不是字段。~~（我认为它可以使用公共字段，但无论如何你真的应该切换到属性）此外，类不需要*标记*为`Serializable`. （`Serializable`用于其他，如二进制和 SOAP 序列化程序）

将您的字段替换为具有公共 getter 和 setter 的属性。此外，请确保您的其他类（例如`Hero`、`Point`、`Boss`）也都可以根据`XmlSerializer`的规则进行序列化：

```
public class SerialAssassin
{
    public Hero hero { get; set; }
    public Point heroPB { get; set; }
    public Boss boss { get; set; }
    public int heroState { get; set; }
    ... 
```

要反序列化，请使用其`Deserialize`方法（[http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.deserialize.aspx](http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.deserialize.aspx)）：

```
Stream xmlInputStream = ... //get your file stream, or TextReader, or XmlReader
XmlSerializer deserializer = new XmlSerializer(typeof(SerialAssassin));
SerialAssassin assassin = (SerialAssassin)deserializer.Deserialize(xmlInputStream) 
```

编辑：查看您的示例`Hero`类，它没有序列化它的任何值，因为您已将它们全部声明为私有。改为公开它们。

```
public class Hero
{
    public int state {get; set; }
    public int x { get; set; }
    public int y { get; set; }
    public string path { get; set; }

    [XmlIgnore]
    public Image img { get; set; }
} 
```

我怀疑这*不会*`Image`是可序列化的，因此您可能想要存储图像的文件路径（或其他一些识别信息），以便您可以保存/加载它。将指示忽略该属性，使其在序列化/反序列化期间不会失败。*`[XmlIgnore]``XmlSerializer`*

 ** * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T21:48:17.957

```
XmlSerializer serializer = new XmlSerializer(typeof(SerialAssassin));
SerialAssassin assassin;

using(var reader = File.OpenText(@"..\..\Resources\saveState.xml"))
{
   assassin = (SerialAssassin)serializer.Deserialize(reader);
} 
```*

# ios - iOS 中的 PDF 文本提取

> ID：13941967
> 
> 赞同：0
> 
> 时间：2012-12-18T21:42:29.183
> 
> 标签：ios, pdf, uiwebview

> **可能重复：**
> [在 iOS 中从 pdf 文档中读取文本和图像](https://stackoverflow.com/questions/5732219/reading-text-and-images-from-a-pdf-document-in-ios)

我有一个应用程序，目前使用 PDF Kitten ( [https://github.com/KurtCode/PDFKitten](https://github.com/KurtCode/PDFKitten) ) 从 PDF 中提取文本。这很好用，但正如 Kurt 所说，它不支持所有字体。

有时，我得到的文本只是单个字符的集合。但是，捕获从同一个 PDF 复制到粘贴缓冲区中的文本就可以了。

我想获得 Apple 在 iOS 中用于从 PDF 复制文本的相同功能。它必须在 Quartz 框架的某个地方，但我无法弄清楚。

我想过挂入 UIWebView 并做一个 selectAll: 但 UIWebView 不支持 selectAll: 并且似乎没有办法打开它。

有没有人有关于如何以与粘贴板相同的方式获取该文本的经验或线索？

# c# - 检索多个节点的元素属性

> ID：13941968
> 
> 赞同：0
> 
> 时间：2012-12-18T21:42:29.803
> 
> 标签：c#, xml-parsing

我很难弄清楚这一点，我有一个 XML 文档，它有多个同名节点。在这些节点中甚至还有更多具有相同名称但属性不同的节点，这就是我想要捕获的内容。以下是 XML 的示例：

```
<?xml version="1.0" encoding="utf-8"?>
<TopologyDefinition xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://schemas.microsoft.com/online/managementsystems/topologydefinition/2009/11">
    <Topology Name="testenv">
        <DataCenters>
            <DataCenter Name="FL" Type="Active">
                <Machines>
                    <Machine Name="FLVMServer1" VmHost="FLVHost100">
                        <IPBindings>
                            <IPBinding VirtualNetworkType="Data" IP="192.168.0.10" />
                        </IPBindings>
                    </Machine>
                        <Machine Name="FLVMServer2" VmHost="FLVHost200">
                        <IPBindings>
                            <IPBinding VirtualNetworkType="Data" IP="192.168.0.20" />
                        </IPBindings>
                    </Machine>
            </DataCenter>
            <DataCenter Name="RI" Type="Passive">
                <Machines>
                    <Machine Name="RIVMServer1" VmHost="RIVHost100">
                        <IPBindings>
                            <IPBinding VirtualNetworkType="Data" IP="192.168.2.10" />
                        </IPBindings>
                    </Machine>
                        <Machine Name="RIVMServer2" VmHost="RIVHost200">
                        <IPBindings>
                            <IPBinding VirtualNetworkType="Data" IP="192.168.2.20" />
                        </IPBindings>
                    </Machine>
            </DataCenter>
        </DataCenters>
    </Topology>
</TopologyDefinition> 
```

我需要为所有 DC 捕获以下内容：机器名称 VmHost IP

我已经尝试过 XPATH，我也尝试过遍历每个节点，但没有运气

```
 ServerInfoClass serverInfo = new ServerInfoClass();
        XmlDocument doc = new XmlDocument();
        doc.Load(FilePath);

        XmlNodeList dcElemList = doc.GetElementsByTagName("DataCenter");
        for(int j = 0; j < dcElemList.Count; j++)
        {
            XmlNodeList elemList = doc.GetElementsByTagName("Machine");
            for (int i = 0; i < elemList.Count; i++)
            {
                serverInfo.ServerName = elemList[i].Attributes["Name"].Value;
                serverInfo.VmHost = elemList[i].Attributes["VmHost"].Value;

                XmlNodeList ipList = doc.GetElementsByTagName("IPBindings");
                for (int x = 0; x < ipList.Count; x++) ;
                {
                    //serverInfo.IPAddress = ipList[x].Attributes["IP"].Value;
                }
                OutPut(serverInfo.ServerName, serverInfo.VmHost, serverInfo.IPAddress);
            }
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:54:08.367

如果你把它放到一个 XDocument 中，你可以像这样查询它：

```
XDocument document = // ... your document.
var ns = document.Root.Name.Namespace;
var results = from dcNode in document.Descendants(ns + "DataCenter")
    let Name = dcNode.Attribute("Name").Value
    let Type = dcNode.Attribute("Type").Value
    let Machines = dcNode.Descendants(ns + "Machine").Select(mNode => 
        new { 
            Name = mNode.Attribute("Name").Value,
            VmHost = mNode.Attribute("VmHost").Value,
            Bindings = mNode.Descendants(ns + "IPBinding").Attributes("IP").Select(x => x.Value).ToArray()
        })
    select new { Name, Type, Machines }; 
```

我建议制作一个辅助扩展方法来获取属性值，它还检查空值。

这里的关键之一是记住您的 XML 元素存在于命名空间中，并且您需要在查询时提供完整的命名空间。这就是为什么首先`ns`从根节点提取命名空间实例很方便的原因。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:55:33.020

您的示例格式不正确。您缺少`</Machines>`标签。

另一种方法是使用 LINQ to XML：

```
XNamespace ns = "http://schemas.microsoft.com/online/managementsystems/topologydefinition/2009/11";
foreach (var machine in XElement.Load(@"c:\mydata.xml").Descendants(ns + "Machine"))
{
    string name = machine.Attribute("Name").Value;
    string vmHost = machine.Attribute("VmHost").Value;

    XElement ipBinding = machine.Descendants(ns + "IPBinding").Single();
    string vnType = ipBinding.Attribute("VirtualNetworkType").Value;
    string ip = ipBinding.Attribute("IP").Value;
} 
```

# c# - Excel 互操作服务不会在客户端计算机上保存工作簿

> ID：13941973
> 
> 赞同：0
> 
> 时间：2012-12-18T21:42:53.120
> 
> 标签：c#, backgroundworker, excel-interop

我遇到的问题涉及在客户端计算机上保存用 C# 代码创建的工作簿。该程序的已发布版本可以在我的机器上完美运行，但不能在客户端上运行。

**过程概述：**

当程序完成迭代后，它将创建工作表，一旦完成，它将保存工作簿并显示一个消息框，说明导出成功并显示创建的工作簿。

**问题：**

在客户端机器上运行时，它将完成创建工作表的过程，但由于某种原因，它不会保存文件。它将excel的实例保留在内存中，因此当您打开任务管理器时，您将看到该过程。此外，在您运行程序并尝试关闭计算机后，它会提示您保存或不保存创建的工作簿，因为实例仍在内存中。这就是我如何解决并保存工作簿以验证程序确实创建了工作表。

**我的想法：**

我在想可能有一些针对 windows 或 excel 的设置会阻止 excel 文件被保存并自动打开。我也在使用后台工作者来完成监视工作簿创建过程的进度的任务，所以这也可能是一个问题。

如果有人遇到此问题或知道解决方案，请告诉我。如果需要更多信息，那么我可以提供。

*我没有包含代码，因为我没有发现它有助于了解为什么会发生问题，因为一切都在我的开发机器上运行，而不是客户端。*

*编辑*

我与 Jared 一起工作，终于能够在另一台安装了 VS 的机器上调试程序。事实证明，问题根本不在于保存功能，而在于客户端计算机上创建的默认工作表数量。

创建工作簿时，程序应该遍历工作表并删除除第一个之外的所有工作表。有一个逻辑缺陷（由我编码：/）会在工作簿中留下一个空工作表，从而导致此语句出现问题：

```
int lastRow = _excelWorksheet.Cells.Find("*", Type.Missing, Type.Missing, Type.Missing, 
                XlSearchOrder.xlByRows, XlSearchDirection.xlPrevious, false, Type.Missing, Type.Missing).Row; 
```

显然它不喜欢在空白纸上搜索东西。我们的开发机器目前默认设置为仅一张纸，所以我们没有遇到问题。

我发现奇怪的是，在调试时，程序会在该行抛出 System.NullReferenceException。但是，该程序不会在客户端计算机上崩溃。相反，它只会按照描述将 Excel 实例留在内存中，然后就坐在那里。正如 Jared 所说，excel 的东西在后台线程上运行，所以可能与它有关。

# python - 使用 Python 在 python 文件中的模块中搜索字符串

> ID：13941974
> 
> 赞同：0
> 
> 时间：2012-12-18T21:42:55.773
> 
> 标签：python, file, copy, line

```
#!/usr/bin/env python`
import sys`
import binascii`
import string
sample = "foo.apples"
data_file = open("file1.py","r")
dat_file = open("file2.txt", "w")
for line in data_file:
    if sample in line:
        dat_file.writelines(line)
 dat_file.close()` 
```

当我这样做时，我能够找到字符串 foo.apples。问题`foo.apples`存在于 python 文件的各个行中。我想要那些在特定函数内的行。我需要这个 def 函数中的行。

`Example:`

```
def start():
    foo.apples(a,b)
    foo.apples(c,d) ... so on. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-18T21:55:18.140

一，稍微偏离常规的方法是使用模块的`getsource`方法。`inspect`考虑以下（理论）`test1.py`文件：

```
class foo(object):
    apples = 'granny_smith'
    @classmethod
    def new_apples(cls):
        cls.apples = 'macintosh'

def start():
    """This is a pretty meaningless python function.
    Attempts to run it will definitely result in an exception being thrown"""
    print foo.apples
    foo.apples = 3
    [x for x in range(10)]
    import bar as foo 
```

现在您想了解`start`代码：

```
import inspect
import test1  #assume it is somewhere that can be imported

print inspect.getsource(test1.start) 
```

好的，现在我们只有该函数的来源。我们现在可以解析：

```
for line in inspect.getsource(test1.start).splitlines():
    if 'foo.apples' in line:
        print line 
```

这里有一些优点——python 在导入文件时完成了解析功能块的所有工作。缺点是文件实际上需要导入。根据您的文件来自哪里，这可能会在您的程序中引入一个**巨大**的安全漏洞——您将运行（可能）“不受信任”的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-18T22:01:02.770

这是一种非常非 Pythonic 的方式，未经测试，但它应该可以工作。

```
sample = "foo.apples"
infile = open("file1.py", "r")
outfile = open("file2.txt", "w")
in_function = False

for line in infile.readlines():
    if in_function:
        if line[0] in(" ", "\t"):
            if sample in line:
                outfile.write(line)
        else:
            in_function = False
    elif line.strip() == "def start():":
        in_function = True
infile.close()
outfile.close() 
```

我建议做一个这样的函数，它需要`sample`输入文件和我们应该搜索的函数作为它的参数。然后它将返回包含文本的所有行的列表或元组。

```
def findFromFile(file, word, function):
    in_function = False
    matches = []
    infile = open(file, "r")

    for line in infile.readlines():
        if in_function:
            if line[0] in(" ", "\t"):
                if word in line:
                    matches.append(line)
            else:
                in_function = False
        elif line.strip() == "def %s():"%function:
            in_function = True

    infile.close()
    return matches 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-12-18T22:14:21.037

以下程序找到`def`s 并将示例字符串附加到输出文件，如果缩进仍在`def`.

```
import re

sample = 'foo.apples'
data_file = open("file1.py", "r")
out_file = open("file2.txt", "w")
within_def = False
def_indent = 0

for line in data_file:
    def_match = re.match(r'(\s*)def\s+start\s*\(', line)  # EDIT: fixed regex
    if def_match and not within_def:
        within_def = True
        def_indent = len(def_match.group(1))
    elif within_def and re.match(r'\s{%s}\S' % def_indent, line):
        within_def = False

    if within_def and sample in line:
        out_file.writelines(line)

out_file.close()
data_file.close() 
```

测试了一个例子`file1.py`。

# git - 在远程存储库上提交历史记录

> ID：13941976
> 
> 赞同：247
> 
> 时间：2012-12-18T21:43:30.720
> 
> 标签：git, git-log

我正在尝试访问远程存储库上的分支提交历史记录。我查看[了文档](http://git-scm.com/book/en/Git-Basics-Viewing-the-Commit-History)，但找不到有关如何使用本地 git 客户端访问远程 repo 提交历史的任何实质性信息。

* * *

## 回答 #1

> 赞同：294
> 
> 时间：2012-12-19T01:18:10.033

```
git log remotename/branchname 
```

将显示该存储库中给定远程分支的日志，但仅显示您从其存储库“获取”到远程存储库的个人“副本”的日志。

请记住，您的存储库克隆将仅通过执行更新其任何远程分支的状态`git fetch`。您不能直接连接到服务器以查看那里的日志，您要做的是下载服务器的状态，`git fetch`然后在本地查看远程分支的日志。

也许另一个有用的命令可能是：

```
git log HEAD..remote/branch 
```

这将向您显示远程分支中的提交，而不是当前分支（`HEAD`）中的提交。

* * *

## 回答 #2

> 赞同：77
> 
> 时间：2012-12-18T21:56:32.710

注意。下面的“origin”用于表示克隆存储库的上游，将“origin”替换为远程存储库的描述性名称。“远程参考”可以使用与克隆命令相同的格式。

```
git remote add origin <remote reference>
git fetch
git log origin/master 
```

* * *

## 回答 #3

> 赞同：17
> 
> 时间：2015-12-22T11:04:05.697

一种快速的方法是使用`--bare`关键字进行克隆，然后检查日志：

```
git clone --bare git@giturl tmpdir
cd tmpdir
git log branch 
```

* * *

## 回答 #4

> 赞同：15
> 
> 时间：2018-02-17T08:53:28.307

这对我有用：

```
git fetch --all 
git log production/master 
```

请注意，这从所有远程获取，即您可能[“必须克隆价值 2GB 的对象才能查看提交日志”](https://stackoverflow.com/questions/13941976/commit-history-on-remote-repository#comment60695863_13944180)。

* * *

## 回答 #5

> 赞同：15
> 
> 时间：2020-03-31T14:18:37.217

我不确定何时添加了过滤，但如果您只想获取历史记录/参考日志，这是一种排除对象 blob 的方法：

```
git clone --filter=blob:none --no-checkout --single-branch --branch master git://some.repo.git .
git log 
```

* * *

## 回答 #6

> 赞同：13
> 
> 时间：2015-07-25T09:57:37.770

您只能在本地存储库中查看日志，但是其中可以包括您设置的所有远程的提取分支。

所以，如果你克隆一个 repo...

```
git clone git@gitserver:folder/repo.git 
```

这将默认为`origin/master`.

除了`origin`让我们添加`production`. 从本地克隆文件夹中：

```
git remote add production git@production-server:folder/repo.git 
```

如果我们想查看日志，`production`我们需要这样做：

```
git fetch --all 
```

这从所有遥控器中获取（默认获取没有`--all`将仅从 获取`origin`）

获取后我们可以查看`production`远程日志，您还必须指定分支。

```
git log production/master 
```

所有选项都将像登录本地分支一样工作。

* * *

## 回答 #7

> 赞同：11
> 
> 时间：2015-01-26T19:22:32.023

我不相信这是可能的。我相信您必须先在本地克隆该远程仓库并对其执行`git fetch`，然后才能针对它发出`git log`警告。

* * *

## 回答 #8

> 赞同：2
> 
> 时间：2020-10-31T16:49:47.963

`git`不是像这样的集中式 scm，`svn`因此您有两种选择：

*   使用目标平台的网页界面（fe [GitHub REST API](https://docs.github.com/en/free-pro-team@latest/rest)或[GitLab REST API](https://docs.gitlab.com/ee/api/api_resources.html)）
*   下载存储库并在本地显示日志

为许多不同的平台（GitHub、GitLab、BitBucket、SourceForge、Launchpad、Gogs 等）实现可能很烦人，但获取数据非常慢（我们谈论的是秒数）——没有完美的解决方案。

* * *

获取到临时目录的示例：

```
git clone https://github.com/rust-lang/rust.git -b master --depth 3 --bare --filter=blob:none -q .
git log -n 3 --no-decorate --format=oneline 
```

或者：

```
git init --bare -q
git remote add -t master origin https://github.com/rust-lang/rust.git
git fetch --depth 3 --filter=blob:none -q
git log -n 3 --no-decorate --format=oneline origin/master 
```

两者都针对性能进行了优化，将一个分支的 3 次提交限制为一个没有文件内容的最小本地副本并防止控制台输出。*尽管在获取*期间打开连接并计算增量需要一些时间。

* * *

GitHub 的示例：

```
GET https://api.github.com/repos/rust-lang/rust/commits?sha=master&per_page=3 
```

GitLab 的一个例子：

```
GET https://gitlab.com/api/v4/projects/inkscape%2Finkscape/repository/commits?ref_name=master&per_page=3 
```

两者都非常快，但具有不同的界面（如每个平台）。

* * *

*免责声明：选择 Rust 和 Inkscape 是因为它们的大小和安全性，没有广告*

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-06-09T18:21:38.293

这是一个 bash 函数，可以轻松查看远程日志。它需要两个可选参数。第一个是**分支**，默认为**master**。第二个是**remote**，默认是**staging**。

```
git_log_remote() {
  branch=${1:-master}
  remote=${2:-staging}

  git fetch $remote
  git checkout $remote/$branch
  git log
  git checkout -
} 
```

例子：

```
 $ git_log_remote
 $ git_log_remote development origin 
```

* * *

## 回答 #10

> 赞同：-4
> 
> 时间：2016-05-26T11:53:43.590

您可以轻松获取远程服务器的日志。就是这样：

(1) 如果通过 ssh 使用 git - 那么只需使用您的 git 登录名和密码登录到远程服务器 - 并 chdir 存储库所在的远程文件夹 - 并在远程服务器上的存储库中运行“git log”命令。

(2) 如果通过 Unix 的标准登录协议使用 git，那么只需 telnet 到您的远程服务器并在那里执行 git log。

希望这可以帮助。

# javascript - Javascript 十六进制字符串 fromCharCode

> ID：13941978
> 
> 赞同：2
> 
> 时间：2012-12-18T21:43:43.183
> 
> 标签：javascript, node.js, hex

十六进制字符串：

```
var str = [0x6A, 0xE8, 0x05, 0x01, 0x00, 0x01, 0xD9, 0xDC, 0x0A, 0x09];
byte = '';
for (var i=0; i < str.length; i++) {
    byte += String.fromCharCode( parseInt(str[i], 16).toString(16) );
} 
```

但接收器显示：

```
6A C3A8 05 01 00 01 C399 C39C 0A 09 
```

知道如何保持 2 个字节吗？或者也许我的代码错了，尤其是。对于nodejs？

*更新了脚本。我对 nodejs 有点陌生，我想看看 nodejs 提供什么非阻塞事件，因为在“忙碌”的日子里我有一些丢失的数据。使用 binascii.(un)hexlify 和 PHP mbstring (un)pack（用于 Web 视图）使脚本适用于 python。

期待：

```
6A E8 05 01 00 01 D9 DC 0A 09 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-18T22:10:04.637

如果我再次解码，您的代码似乎对我有用。在 Javacript 中使用 for() 循环对象时要小心。这也迭代了对象的属性。

```
var str = [0x6A, 0xE8, 0x05, 0x01, 0x00, 0x01, 0xD9, 0xDC, 0x0A, 0x09];
byte = '';
for (var i=0; i < str.length; i++) {
    byte += String.fromCharCode( parseInt(str[i], 16).toString(16) );
}

var hexarrayout = [];
for (var i=0; i<byte.length; i++) {
    hexarrayout.push(byte.charCodeAt(i).toString(16));
}

alert(hexarrayout); 
```

[​ http://jsfiddle.net/ycG4n/](http://jsfiddle.net/ycG4n/)上的示例

发送到接收器时，您的问题看起来非常像 utf8<=>iso-.../ascii/etc 转换问题，其中一些 1 字节字符串字符被转换为 2 字节字符。由于 UTF-8 的部分向后兼容性，一些十六进制值将保持 1 字节。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-12-18T22:08:02.240

即使您正在编写`0x6A`代码，JavaScript 也会自动将其理解为它的值 106。它已经是一个数字，因此`parseInt()`不会对它做任何事情并且可以将其删除。

您可能只想这样做：

```
var str = [0x6A,0xE8...];
var byte = String.fromCharCode.apply(null,str); 
```

# ruby-on-rails-3 - ruby on rails 3 - 通过 Capybara 测试，StateMachine 不会移动到下一个状态

> ID：13941979
> 
> 赞同：2
> 
> 时间：2012-12-18T21:43:45.060
> 
> 标签：ruby-on-rails-3, capybara, factory-bot, state-machine

我正在使用工厂女孩水豚编写集成测试。我的网站正在使用 state_machine gem。我正在记录转换并且正在调用事件，但是状态没有保持不变。我模拟了我的工厂女孩​​模型正在填写的相同数据，它在开发环境中工作；但是在测试环境中它并没有粘住。我在想我错过了一些简单的东西。

我想我会检查其他人是否有这个问题并有解决方案。我正在使用 rails'、'3.2.8' ruby​​ 1.9.3 并且所有 gem 都是最新的。

# javascript - 两个不同的网站可以相互交互吗？

> ID：13941982
> 
> 赞同：2
> 
> 时间：2012-12-18T21:44:11.097
> 
> 标签：javascript, html, cookies, google-chrome-extension, local-storage

可以说，我必须访问具有完全不同域的网站。

域 1 是 water.com

域 2 是 fire.com

如果域 1 (water.com) 使用 localStorage 存储用户名，域 2 (fire.com) 可以查看该用户名是什么并使用它进行身份验证吗？

这不一定是 localStorage，如果它们允许上述交互，我也可以使用 cookie...

我没有两个域，相反，我有一个 chrome 扩展和一个需要交互的域。IE，如果扩展名已登录，则域也将登录，反之亦然。

设置这些 cookie/存储变量的最佳做法是什么？

你能指点我一些文档和一个例子吗？

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:51:26.613

我确信出于安全原因，您不能使用跨域 cookie。我相信也是如此。但是，您的第二个域或您的扩展名可以重定向到第一个域，而第一个域可以通过所需的信息（例如凭据）发送。

这个问题可能会帮助你更多：

[stackoverflow.com/questions/4177803/...](https://stackoverflow.com/questions/4177803/can-html5-databases-and-localstorage-be-shared-across-subdomains)

正确答案上的链接讨论了一种使用 XAuth 共享信息的方法。我对此不太了解，但也许该链接会给您一些想法。

希望这可以帮助。

# objective-c - 在 iOS 中实现 HTTP post/Get 的正确方法

> ID：13941983
> 
> 赞同：1
> 
> 时间：2012-12-18T21:44:11.617
> 
> 标签：objective-c, ios, cocoa-touch

我对 iOS 很陌生，正在尝试实现 HTTP 发布/获取通信的最佳方式。

问题：

我想进行多个 api 调用，每个调用都有其单独的响应。我正在尝试编写常见的网络工具，理想情况下它将使用 api url，进行调用并将数据返回给调用者。实现它的正确方法是什么？我发现每种方法都有中等程度的辩论和粉丝。

选项1：

```
 dispatch_async(aQueue,^{
    ...[ make a sync network request get data back]
    --- perform operation on data 
   --- then pass proceed data UI or set it in model. 

   dispatch_async(dispatch_get_main_queue()
  } 
```

选项 2：

```
 -(NSString *) postData:(NSDictionary *)data serverUrl:(NSString *)targetUrl
   -- call post data method with seperate delegate for each caller 
   -- start async request 
   -- on DidFinishedLaunching or OnError check delegate & then 
      return response back to callback 
```

感谢您的投入。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T23:32:32.280

我认为您的第一个选择不好。它将长时间阻塞池化线程，这是不可取的。在任何环境中实现多线程时，系统提供的池线程不应用于长时间运行的进程。第二个同步网络调用并不真正被建议，它有它自己的陷阱。

您的第二个选项更可行。您可以做的一个改进是执行在确实完成启动到 GCD 线程中发生的工作，并在处理后在主线程上发送数据

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-12-18T23:03:27.390

有一个很棒的库，叫做[AFNetworking](https://github.com/AFNetworking/AFNetworking)，它很容易实现。

它使用块，这极大地简化了类之间的数据通信（取消了委托），并且是异步的。

示例用法如下：

```
AFHTTPClient *client = [[AFHTTPClient alloc] initWithBaseURL:[NSURL URLWithString:"www.yourwebsite.com/api"]];

NSDictionary *params = @{
    @"position": [NSString stringWithFormat:@"%g", position]
};

[client postPath:@"/api" parameters:params success:^(AFHTTPRequestOperation *operation, id responseObject) {

} failure:^(AFHTTPRequestOperation *operation, NSError *error) {

}]; 
```

就如此容易！Result 在调用 HTTP Post 或 Get 方法的类中直接可用。

它甚至包括图像和 JSON 请求、JSON 反序列化、带有进度回调的文件下载等等。

# jquery - 多个下拉菜单：处理它们的正确方法是什么？

> ID：13941984
> 
> 赞同：4
> 
> 时间：2012-12-18T21:44:11.803
> 
> 标签：jquery, css, user-interface, drop-down-menu, frameworks

我必须建立一个点击触发的小下拉系统。我已经设法处理“点击 div”问题（感谢之前发布的[这个问题）。](https://stackoverflow.com/questions/152975/how-to-detect-a-click-outside-an-element)

我可以隐藏*当前*下拉菜单，单击另一个下拉菜单的触发器或单击*下拉菜单*本身。所以，问题是这些：

1.  点击当前下拉菜单的触发器没用；当其他事情正常工作时，下拉菜单不会消失
2.  *在*当前下拉列表中单击（例如： .divider 项目）会导致下拉列表消失

所以，这里是 html 代码（假设我在标题中有多个下拉菜单）

```
 ...
    <div id="header" class="navbar">
        <div class="line">
            <a href="#" class="logo">Site Name</a>
            <ul class="nav right">
                <li>
                    <a href="#" class="has-drop">Item 1</span>
                    <ul class="dropdown-menu">
                        <li><a href="#">Action A</a></li>
                        <li><a href="#">Action B</a></li>
                        <li><a href="#">Action C</a></li>
                        <li class="divider"></li>
                        <li><span>Inline note</span></li>
                    </ul>
                </li>
                <li>
                    <a class="has-drop" href="#">Item 2</a>
                    <ul class="dropdown-menu">
                        <li><a href="#">Action D</a></li>
                        <li><a href="#">Action E</a></li>
                        <li><a href="#">Action F</a></li>
                        <li class="divider"></li>
                        <li><a href="#">Action G</a></li>
                    </ul>
                </li>
            </ul>
        </div>
    </div> <!-- end #header -->
    ... 
```

这实际上是我正在使用的 JS 代码，在一个专用文件中

```
 $(document).ready(function(){

        $("html").on({
            click: function(e) {
                $(".dropdown-menu.opened").toggleClass("opened");
            }
        });

        $(".nav > li > a").on({
            click: function(e){
                e.stopPropagation();

                $(".dropdown-menu.opened").toggleClass("opened"); // should close each .dropdowns before opening the current one
                $(e.target).siblings(".dropdown-menu").toggleClass("opened");
            }
        });

    }); 
```

为什么你认为当我重新点击它的触发器时下拉菜单没有隐藏？因为在里面`$(".nav > li > a").on()`做几乎同样的事情？

此外，有一种方法可以防止单击其中一些子项时下拉隐藏本身？但也许这与另一个问题更相关，我不知道。

最后但同样重要的是：在您看来，这是完成整个事情的正确方法吗？

谢谢大家

* * *

**编辑**：感谢@Beetroot-Beetroot 我设法解决了这个问题，所以这是当前的工作代码 $(document).ready(function(){

```
 $("html").on("click", function(e) {
            $(".dropdown-menu.opened").removeClass("opened");
        });

        $(".nav").find("li :first-child").on("click", function(e) {
            e.preventDefault();
            e.stopPropagation();

            var $thisMenu = $(this).siblings(".dropdown-menu").toggleClass("opened");
            $(".dropdown-menu").not($thisMenu).removeClass("opened");
        });

    }); 
```

“秘密”是 .not() 的巧妙使用，我现在对此了解得更多。

我只是将目标（可以`<a>`或`<span>`）更改为更通用的目标。不确定长期的表现，但肯定是一个很好的起点。

*从*

```
$(".nav").find("a.has-drop").on(... 
```

*到*

```
$(".nav").find("li :first-child").on(... 
```

也在这里

$(this).closest(".nav").find(".dropdown-menu").not(... 我使它更通用 $(".dropdown-menu").not(...那是因为我想隐藏**所有**打开的下拉菜单。以前的行为是只考虑一种目标和一个原点区域（例如：也许我需要这些下拉菜单以及标题和某种工具栏内的内容）。

* * *

**编辑 2**：@Beetroot-Beetroot 再次帮助了我。正如他所建议的那样，当我在 jsFiddle 中移植当前代码时，突然解决方案本身就出现了。所以现在这`$("html").on("click", ...`部分看起来像这样

```
 $("html").on("click", function(e) {

        if ( $(e.target).hasClass("dropdown-menu") || $(e.target).parents(".dropdown-menu").length ) {
            // do nothing, basically
        } else {
            $(".dropdown-menu.opened").removeClass("opened");
        }
    }); 
```

基本上我只是看点击`$("html")`是否有做下拉下拉菜单的事情。如果是，什么也不做。如果不是，那么这确实意味着我点击了任何地方，*但*没有点击下拉菜单的位置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T01:52:11.293

它认为这样的事情应该可以完成：

```
$(document).ready(function() {
    $("html").on('click', function(e) {
        $(".dropdown-menu.opened").removeClass("opened");
    });
    $(".nav").find("a.has-drop").on('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        var $thisMenu = $(this).siblings(".dropdown-menu").toggleClass("opened");
        $(this).closest(".nav").find(".dropdown-menu").not($thisMenu).removeClass("opened");
    });
}); 
```

*未经测试*

备注：

*   `removeClass()``toggleClass()`在几个地方替换。
*   秘诀是先切换`$thisMenu`，然后`not($thisMenu)`在以下行中使用以确保它`$thisMenu`保持在切换到的任何状态。

# php - 在 PHPStorm 中使用变量来表示静态属性的类名

> ID：13941987
> 
> 赞同：0
> 
> 时间：2012-12-18T21:44:18.607
> 
> 标签：php, static, abstraction, phpstorm

我正在尝试使用 PHPStorm 在 PHP 中编写一些抽象的 MVC 类。我用于泛型类包装器的一些覆盖类属性往往更适合使用静态方法和属性。代码工作正常，但是每当我使用一个变量来表示一个静态变量（存在于继承方法中的变量）时，PHPStorm 不知道如何处理它并将其显示为 IDE 中的错误。我只是想知道是否有更好的方法来做这种事情，或者它是否只是我必须学会在 IDE 中忽略的东西。

例子：

```
class AbstractModel {
    protected static $_dataMapper     = null;
    protected static $_subs    = null;

    public function __construct($data=null) {
        // constructor omitted with things like a generic class init, etc.
    }

    // $_subs is a static array who's value is a class name use for
    // populating sub-objects as part of a class instance
    public function setSubProperty($subKeyName,$value) {
        $dataType = get_called_class();

        /*************************************
         * PHPStorm complains here on $_subs *
         *************************************/
        if(is_array($dataType::$_subs)
            && array_key_exists($subKeyName,$dataType::$_subs)) {

            $setMethod = 'set' . ucfirst($subKeyName);
            return $dataType->$setMethod($value);
        } else {
            return false; // or throw an exception
        }
    }
}

class SomedataModel extends AbstractModel {
    public $other = null;
    protected static $_subs = array(
        'other'   => "OtherModel"
    );

    public function __construct($data=null) {
        parent::__construct($data=null);
        foreach(array_keys(self::$_subs) as $_k) {
            $setMethod = 'set'.ucfirst($_k);
            $this->$setMethod();
        }
    }

    public function setOther($data=null) {
        // sanitize and set instance of 'other' as $this->other
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T22:07:28.803

`static`您可以通过使用关键字轻松解决此问题：

```
...

public function setSubProperty($subKeyName,$value) {

    if (is_array(static::$_subs)
        && array_key_exists($subKeyName, static::$_subs)) {

        $setMethod = 'set' . ucfirst($subKeyName);

        ... 
```

PHPStorm 很好地支持它。不支持将变量字符串值作为静态成员和属性的类名解析。您可能想要打开一个功能请求（如果它尚不存在），但我怀疑它在技术上是否可行，因为它不是类型提示，而是我认为 Phpstorm 不支持的值提示。

# javascript - 使文本自动缩放到父容器

> ID：13941996
> 
> 赞同：0
> 
> 时间：2012-12-18T21:45:01.243
> 
> 标签：javascript

我希望我能很好地解释这一点。

我正在制作一个 Tumblr 主题，并且正在设置帖子标题，如果它太长，文本不会溢出到第二行。我想让文本在到达父级边缘时变小，而不是掉入新行或被截断。

我尝试了 fittext.js 和 bigtext.js，但我都无法工作。而且我不认为它们会为我想要的工作，因为 fittext.js 似乎是更具响应性的文本，而 bigtext.js 总是使文本与父级的宽度相同，这不适用于我想要的。

有谁知道我可以做到这一点？我是 Javascript 的菜鸟，所以在回复时请记住这一点。;D

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-12-18T21:48:10.197

第一步是阻止断线：

```
white-space:nowrap; 
```

然后，您需要允许滚动：

```
overflow:hidden; 
```

现在您可以访问`scrollWidth`. 如果它大于`offsetWidth`，则文本太大。

您可以一次将文本缩小一个字体大小单位（可以是 0.1em、1px、1pt ......任何你想要的）。重复此步骤，直到`scrollWidth`小于或等于`offsetWidth`。达达！

# asp.net-mvc - 通过 mvc 路由图像路径

> ID：13941997
> 
> 赞同：2
> 
> 时间：2012-12-18T21:45:05.067
> 
> 标签：asp.net-mvc, asp.net-mvc-4, asp.net-mvc-routing

我目前正在创建一个 MVC4 Web 应用程序。此应用程序显示产品，包括图像。我有一家公司来审查该网站的 SEO 方面，他们回来后就产品图片提出了建议。

目前我的图片路径是：folder/images/productimage/PROD_98713204_LARGE.gif

他们推荐了以下内容：/folder/images/productimage/98713204-160x260-0-0_My+Product+Name.gif

我遇到的问题是我在网站上有大量图像，因此很难全部重命名以包含产品名称等。所以我考虑过使用 MVC 中的路由功能，在 html 标记中输出推荐的但是从文件系统中选择上面显示的当前图像路径。

我有2个问题是：

*   使用这种路由来管理图像路径是否会影响性能？我的网站将有大量流量负载和大量图像，因此这是一个问题。
*   有人可以给我一个我需要配置以实现上述目标的路由示例吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-19T03:45:36.473

为了执行路由选项，您必须提出一些关于 url 如何映射到实际图像的规范。我们在谈论多少图像？1000？10,000？一百万？如果您的数量少于 100,000，那么我可能会继续使用您已经编写的规范来继续重命名所有文件，然后使用规范来命名从现在开始进入文件系统的文件。

该系统的优点是它限制了数据更改的范围，并且您只需影响系统的一个点（当文件正在进入时）。在性能方面，将一个字符串映射到另一个字符串的开销可能可以忽略不计，即使对于大量请求也是如此。短字符串的字符串操作非常快，但无论如何，如果请求开始花费太长时间，您应该分析整个请求并关注主要的痛点。当然，如果您只是重命名文件，则可以确保您不必担心任何此类分析。

至于创建路由来进行 url 映射，您首先必须让 ASP.NET 将请求交给您的代码。默认情况下，ASP.NET 首先检查文件是否存在于 url 指定的位置，如果存在，它只是根据 IIS 中注册的处理程序处理文件。我的建议是保留这些设置，因为当您更改它们时它们会对系统进行非常大的更改。对于图像，处理程序只是尝试将文件发送到客户端。

如果磁盘上不存在该文件，则它会通过遍历路由集合来查找请求的处理程序，这是您通常将路由注册到`Global.asax`. 由于您没有告诉我们您尝试了什么，我假设您知道路线是如何工作的。你可以通过路线变得非常狡猾，但我会坚持一些简单的事情：

```
routes.MapRoute(
    name: "images",
    url: "{folder}/images/productimage/{unmappedFileName}",
    defaults: new { controller = "Home", action = "Images" }
); 
```

此路由将匹配您提供的示例 url。然而，在他们使用实际文件名的情况下，这条路线永远不会被击中，正如我上面解释的那样。然而，由于*SEOed*文件名不存在，这条路线将被命中，它会尝试在 Home 控制器上运行 Images 操作（我在这里列出了我的整个 Home 控制器以消除对这些部分去向的任何混淆）：

```
public class HomeController : Controller
{
    public ActionResult Index()
    {
        return View();
    }

    public ActionResult Images(string unmappedFileName)
    {
        if (String.IsNullOrWhiteSpace(unmappedFileName))
        {
            return HttpNotFound();
        }

        var fileName = MapFileName(unmappedFileName);
        var diskLocation = GetDiskLocation(fileName);
        return File(diskLocation, "image/png");
    }

    private string MapFileName(string unmappedFileName)
    {
        return unmappedFileName + ".png";
    }

    private string GetDiskLocation(string fileName)
    {
        var fullPath = String.Format("~/Content/themes/base/images/{0}", fileName);
        var diskLocation = Server.MapPath(fullPath);
        return diskLocation;
    }
} 
```

显然，您需要将文件名映射更新为您决定的任何规范。我正在使用这里的内容，因为当您创建新的 MVC4 项目时，该文件夹中有一堆示例文件。

显示它有效的一种简单方法是在 Home 文件夹中实现 Index 视图，如下所示：

```
{
    ViewBag.Title = "Index";

    var imagesDirectory = Server.MapPath("~/Content/themes/base/images/");
    var imageFileNames = Directory.GetFiles(imagesDirectory).Select(m => m.Replace(imagesDirectory, "").Replace(".png", ""));
}

<h2>Index</h2>

@foreach (var imageFileName in imageFileNames)
{
    <div>@Html.ActionLink(imageFileName, "Images", new { unmappedFileName = imageFileName })</div>
} 
```

以后遇到这样的问题，还是先想办法解决。当您提出问题时，请务必告诉我们您已经尝试过什么，这样我们就可以帮助您度过下一个难关并为您指明正确的方向，而不是仅仅要求我们提供代码来解决您的问题。如果您不知道从哪里开始，请尝试搜索或询问[更抽象的问题](https://stackoverflow.com/questions/186062/can-an-asp-net-mvc-controller-return-an-image)。谁知道呢，他们甚至可能同时回答您的其他问题。:)

And lastly, this solution is really complicated. I don't even know how your mapping function is going to work, but I know this is complicated. It also adds a layer of complexity when debugging because now the urls you have don't directly relate to the file name on disk, and that time will add up later on. Of course there are reasons why I might favor this mapping, most notably if you intend to change the url structure in the future for further *SEO* changes, but then you're breaking urls on the internet and damn you for that. So really, I suggest just changing all of your file names if that is feasible.

# sql-server - 通过 SSMS 连接时 SQL Server 2012 集成服务失败

> ID：13941998
> 
> 赞同：39
> 
> 时间：2012-12-18T21:45:20.760
> 
> 标签：sql-server, ssis

我最近安装了 SQL Server 2012，我主要使用默认设置。数据库工作正常，我可以愉快地使用 SSMS (SQL Server Management Studio) 进行连接，但是当我连接到 Integration Services 服务器时，我收到了这条消息

> 连接到计算机“localhost”上的 Integration Services 服务失败，出现以下错误：“访问被拒绝。”
> 
> 默认情况下，只有管理员有权访问 Integration Services 服务。在 Windows Vista 及更高版本上，该进程必须以管理权限运行才能连接到 Integration Services 服务。有关如何配置对服务的访问的信息，请参阅帮助主题。

这是屏幕截图 ![在此处输入图像描述](../Images/0c1d6430e3b227536a59a48ee623abc3.png)

我不知道为什么，但我是域管理员并且对服务器拥有完全权限。还有为什么当我从我的桌面连接时它可以成功连接，只有当我从服务器本身连接时才会出现这个问题。如何解决此问题，以便使服务器上的 SSMS 连接到其集成服务实例。

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2012-12-18T22:27:59.060

据我了解，用户访问控制或[UAC](http://technet.microsoft.com/en-us/library/cc709691%28v=ws.10%29.aspx)基本上可以拦截对您的组成员身份的请求，因此在这种情况下，它似乎阻止了您的成员身份传递给 SQL Server。

其他人在他们的评论中指出，您可能仍需要右键单击并以管理员身份运行 SSMS。

正如一位精明的观察者所指出的，“这是一个快速修复，而不是真正的解决方案。人们不应该只是以管理员身份运行东西。这些安全墙的存在是有原因的”我同意。UAC 旨在让 Windows 用户进入[最小权限原则原则](https://en.wikipedia.org/wiki/Principle_of_least_privilege)- 仅在需要时升级到强大的帐户。问题是众所周知，SSMS 不能与 UAC “很好地配合”。如我所见，这为您提供了三个选择

*   您可以关闭 UAC 并完成工作
*   开启 UAC 并告诉你的老板你无法工作
*   编写不受UAC影响的自己的查询工具

* * *

## 回答 #2

> 赞同：36
> 
> 时间：2013-12-05T04:36:37.567

转到所有程序 单击 Microsoft SQL Server 2012 文件夹 右键单击​​ SQL Server Management Studio 单击以管理员身份运行

这现在应该解决问题。（有了这个你需要总是重复相同的过程）。为了每次都避免这种情况并获得更持久的解决方案，您需要获得许可。请执行以下过程，您应该会很好。

在 SQL Server 的早期版本中，默认情况下，当您安装 SQL Server 时，用户组中的所有用户都可以访问 Integration Services 服务。安装当前版本的 SQL Server 时，用户无权访问 Integration Services 服务。该服务默认是安全的。安装 SQL Server 后，管理员必须授予对该服务的访问权限。

授予对集成服务服务的访问权限

1.  运行 Dcomcnfg.exe。Dcomcnfg.exe 提供用于修改注册表中某些设置的用户界面。
2.  在“组件服务”对话框中，展开“组件服务”>“计算机”>“我的电脑”>“DCOM 配置”节点。
3.  右键单击 Microsoft SQL Server Integration Services 11.0，然后单击属性。
4.  在安全选项卡上，单击启动和激活权限区域中的编辑。
5.  添加用户并分配适当的权限，然后单击确定。
6.  对访问权限重复步骤 4 - 5。
7.  重新启动 SQL Server Management Studio。
8.  重新启动集成服务服务。

*（来源 MSDN）*

我希望这个能帮上忙

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-03-12T07:31:45.110

右键单击 Sql Server Management Studio 并选择以管理员身份运行并尝试连接，如果它安装在本地实例上

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2012-12-18T22:07:30.633

您应该检查一下 SSIS 服务在哪个用户下运行。转到开始 > 运行 > 键入“services.msc”并向下滚动到 SQL Server Integration Services 11.0 条目。右键单击并检查属性以找出它在哪个用户下运行。第二个选项卡应该是登录选项卡。由于您只是在本地实例上运行，您可以将您的用户设置为登录用户帐户，SSIS 将拥有与您相同的权限。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2017-10-05T04:14:02.347

在这个问题上浪费了一天的工作。我的包有一个 .NET 脚本任务，用于将文件从共享网络文件夹复制到本地文件夹，每次尝试从服务器执行包（通过 SQL Studio）时，我都会遇到“拒绝访问”异常。该软件包在本地运行时运行良好。

在这里和那里尝试了很多东西，最终有效的是创建一个作业（所有者是 sa），它将包作为 SSISExecutor 执行。

不得不提一下，网络上的文件对每个人都有读取权限，我还是不明白哪里出了问题。