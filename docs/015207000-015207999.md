# StackOverflow 问答 15207000-15207999

# postgresql - Postgres：PreparedStatement 错误地识别数据类型

> ID：15207008
> 
> 赞同：0
> 
> 时间：2013-03-04T17:07:16.400
> 
> 标签：postgresql, insert, prepared-statement, auto-increment

我无法正确执行此命令。表的第一列是一个自动递增的整数，所以我希望在第 2 列开始输入数据。当我执行以下操作时：

```
PREPARE fooplan (text, smallint, smallint, text, date, timestamp with time zone) as 
INSERT INTO "table" VALUES($2, $3, $4, $5, $6, $7);
EXECUTE fooplan('Add New Record', 2, 2, 'User', '1999-Jan-08', '04:05:06'); 
```

我收到此错误：

```
SQL error:

ERROR:  column "category_id" is of type smallint but expression is of type text
LINE 2: insert into "MOP" values($2, $3, $4, $5, $6, $7);
                                     ^
HINT:  You will need to rewrite or cast the expression.
In statement:
prepare fooplan (text, smallint, smallint, text, date, time without time zone) as 
insert into "MOP" values($2, $3, $4, $5, $6, $7);
execute fooplan('Add New Mop', 2, 2, 'User', '1999-Jan-08', '04:05:06'); 
```

谁能帮我理解我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:14:24.263

后面的数字是`$`指参数顺序。

```
INSERT INTO "table" VALUES($1, $2, $3, $4, $5, $6); 
```

除此之外，您还必须命名要插入的列：

```
INSERT INTO "table" (col2, col3, col4, col5, col6, col7) 
VALUES($1, $2, $3, $4, $5, $6); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:14:45.130

如果您只是尝试插入值，但没有指定第一个字段值，那么您需要说明您要插入哪些列。

我不知道你的列叫什么，所以我只称它们为 column_1、column_2 等。

```
prepare fooplan (text, smallint, smallint, text, date, timestamp with time zone)
INSERT INTO MOP(column_2, column_3, column_4, column_5, column_6, column_7) 
VALUES ($1, $2, $3, £4, $5, $6); 
```

# java - 休眠：选择具有子条件的父级

> ID：15207011
> 
> 赞同：0
> 
> 时间：2013-03-04T17:07:27.967
> 
> 标签：java, hibernate, jpa

我有以下表格：

**标题**

```
---------------------------------
ID             |      STATUS
---------------------------------
1              |        A
---------------------------------
2              |        B
--------------------------------- 
```

**数据**

```
--------------------------------------------------
ID         |  HEADER_ID    |    DKEY    |   DVALUE
--------------------------------------------------
1          |      1        |    Age     |    90
--------------------------------------------------
2          |      1        |    Gender  |    M
--------------------------------------------------
3          |      1        |    Score   |    1000
--------------------------------------------------
1          |      2        |    Age     |    8
--------------------------------------------------
2          |      2        |    Gender  |    M
--------------------------------------------------
3          |      2        |    Score   |    0
-------------------------------------------------- 
```

我的 JPA 课程是：

```
**@Entity
@Table (name="HEADER")
public class Header {
    @Id
    @GeneratedValue
    private int id;

    @Column (name="STATUS")
    private String status;

    @OneToMany (cascade=CascadeType.ALL, orphanRemoval=true, mappedBy="header")
    @LazyCollection(LazyCollectionOption.FALSE)
    private Set<Data> dataList;

    --- getters and Setters ---
}

@Entity
@Table (name="DATA")
publi class Data {
    @Id
    @GeneratedValue
    private int id;

    @ManyToOne(fetch = FetchType.EAGER)
    @JoinColumn(name = "HEADER_ID", nullable = false)
    private Header header;

    @Column (name="DKEY")
    private String key;

    @Column (name="DVALUE")
    private String value;
}** 
```

现在，我的问题是，我想使用休眠选择一个“年龄”等于“90”且“性别”等于“M”的数据的标题。我尝试了以下方法：

**从 Header h 中选择不同的 h left join h.dataList dl where (dl.key = 'Age' and dl.value = '90') and (dl.key = 'Gender' and dl.value = 'M')**

这不会给我任何回报，因为条件“（dl.key = 'Age' and dl.value = '90'）和（dl.key = 'Gender' and dl.value = 'M'）”在一个“DATA”中执行" 总是会产生错误的记录。

如果我输入或“（dl.key = 'Age' and dl.value = '90'）或（dl.key = 'Gender' and dl.value = 'M'）”结果是错误的，因为我想获取那些满足年龄和性别条件的 Header。

由于这个问题，我头疼了好几个小时，而且我没有办法再尝试了。希望有人能指出我正确的方向/解决方案。

非常感谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:28:26.733

您可以尝试这样重写它：

```
select distinct h from Header as h 
where h.id in 
    (select dl.header.id from Data as dl where dl.key = 'Age' and dl.value = '90') 
and h.id in 
    (select dl.header.id from Data as dl where dl.key = 'Gender' and dl.value = 'M') 
```

# ios - iOS 5.1 shouldAutorotateToInterfaceOrientation: 调用但 didRotateFromInterfaceOrientation: 不是第一次加载

> ID：15207012
> 
> 赞同：0
> 
> 时间：2013-03-04T17:07:30.160
> 
> 标签：ios, objective-c, ios5.1

所以看起来我第一次将 UIVIewController 推送到我的 UINavigationController 堆栈时调用了这个方法：

```
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation 
```

但这种方法不是：

```
-(void) didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation 
```

现在，如果我在加载 UIViewContoller 后旋转设备，那么这两个都会按预期触发。

为什么`didRotateFromInterfaceOrientation`我的控制器加载时没有被调用？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:58:35.917

来自[UIViewController 类参考](http://developer.apple.com/library/ios/documentation/uikit/reference/UIViewController_Class/Reference/Reference.html#//apple_ref/occ/instm/UIViewController/didRotateFromInterfaceOrientation%3a "UIViewController 类参考")：

> didRotateFromInterfaceOrientation：
> 
> 用户界面旋转后发送到视图控制器。

`didRotateFromInterfaceOrientation`在加载期间没有被调用，因为没有用户界面旋转。

`shouldAutorotateToInterfaceOrientation`在每次旋转之前调用。我不确定为什么在加载过程中调用它。我认为这可能是`UINavigationViewController`.

# perl - 非零值的 perl 数组

> ID：15207013
> 
> 赞同：2
> 
> 时间：2013-03-04T17:07:30.290
> 
> 标签：perl

我试图编写基于“ps”的“服务”脚本。我的代码：

```
#!/usr/bin/perl
use strict;
use warnings;
die "usage:    $0 <service name>\n" unless $ARGV[0];
my $service = $ARGV[0];
open(my $ps, "ps -aux |") || die "Uknown command\n";
my @A = <$ps>;
close $ps;
foreach my $i(grep /$service/, @A){
    chomp $i;
    if($i=~ /root/){
        next
    }
    print "$i\n";
} 
```

我的问题：针对 undef arg 运行脚本时，例如：

```
$0 blablabla 
```

如果没有出现这样的服务/当返回 0，我想返回一个输出谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:19:28.607

我假设您要问的是：找不到匹配行时如何给出正确的消息？

好吧，只需将结果存储在数组中即可：

```
my @lines = grep { !/root/ && /$service/ } @A;

if (@lines) {   # if any lines are found
    for my $line (@lines) {
        ...
    }
} else {
    print "No match for '$service'!\n";
} 
```

或者您可以打印匹配的数量，而不管它们的数量：

```
my $found = @lines;
print "Matched found: $found\n"; 
```

另请注意，您可以在 grep 中添加对 root 的检查。

作为旁注，这部分：

```
die "usage:    $0 <service name>\n" unless $ARGV[0];
my $service = $ARGV[0]; 
```

也许写得更好

```
my $service = shift;
die "usage ...." unless defined $service; 
```

它专门检查参数是否已定义，而不是真实与否。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:16:49.463

如果我理解正确，如果没有找到此类服务，您想通知用户吗？如果是这样，您可以按如下方式修改脚本：

```
my $printed;                        # Will be used as a flag.
foreach my $i(grep /$service/, @A){
    chomp $i;
    if($i=~ /root/){
        next
    }
    $printed = print "$i\n";        # Set the flag if the service was found.
}
warn "No service found\n" unless $printed; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:17:57.350

你可以尝试这样的事情：

```
my @processes = grep /$service/, @A;
if ( scalar @processes ) {
    foreach my $i( @processes ){
        chomp $i;
        if($i=~ /root/){
            next;
        }
        print "$i\n";
    }
}
else {
    print 'your message';
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T17:18:16.307

您可以在循环`grep`中遍历它之前检查命令的结果，例如：`for`

```
...

my @services = grep { m/$service/ } @A;

# Filter the perl process running this script and...
if ( ! @services ) { 
    print "No service found\n";
    exit 0;
}

foreach my $i( @services ){
    ...
} 
```

考虑到该`grep`命令永远不会给出错误的返回，因为它包含`perl`进程，所以你必须过滤它，但我希望你明白。

# java - Update and delete in oracle using java

> ID：15207021
> 
> 赞同：1
> 
> 时间：2013-03-04T17:08:02.900
> 
> 标签：java, oracle11g, sql-update

I have a table named bcfsite with a field named activestate.

```
update bcfsite set activestate = 1 where bscname like '%B361Z%' 
```

When I run the above query SQLPlus or Oracle SQL Developer, it works fine without any problems, but when I run it in Java using this code:

```
String sqlstrString = "update bcfsite 
                       set activestate = 0 where bscname like '%B361Z%' ";
PreparedStatement ps = d.prepareStatement(sqlstrString);
ResultSet rs = ps.executeUpdate(); 
```

or this code :

```
ResultSet rs = DBConnection.RunStatement(sqlstrString, d); 
```

My program pends and doesn't pass the update statement.

I changed the table and column and tried delete instead of update but still I see the same problem.

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-14T18:12:08.777

I am putting this is the answer box because there is not enough room in the comments...

```
String qString = "update bcfsite set activestate = 0 where bscname like ?"; 
```

That is the correct way to do this with a replaceable parameter. Remember when using the like operator everything passed to it is a varchar2 as far as oracle is concerned so:

```
ps.setString(1,"%B361Z%"); 
```

Again, this is the correct way to accomplish this.

The resulting string passed to oracle via jdbc will look like:

```
update bcfsite set activestate = 0 where bscname like '%B361Z%' 
```

setString() applies the correct markup so the oracle query parser will see a correct query.

Queries with a "?" in them are not simply string replaced. The statement is parsed by the server, and then the parameter(s) are passed to the server.

BTW this was answered in several places on SO. Please learn how to search SO and it will shorten your response time considerably and not waste our time.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:38:20.877

Try this approach:

```
String sqlstrString = "update bcfsite " +
                       "set activestate = 0 where bscname like '?'";
PreparedStatement ps = d.prepareStatement(sqlstrString);
ps.setString(1, "%"+"B361Z"+"%");
ResultSet rs = ps.executeUpdate(); 
```

And a second approach would be:

```
 ...set activestate=0 where bscname like CONCAT('%', ?, '%')"; 
 ...
 ps.setString(1, "B361Z"); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:26:10.793

Can you try following approach first to clear out it updates atleast one row through Java code, don't give wild characters try to update single row.

```
String sqlstrString = "update bcfsite 
                       set activestate = 0 where bscname=?";
PreparedStatement ps = d.prepareStatement(sqlstrString);
ps.setString(1, "B361Z");
ResultSet rs = ps.executeUpdate(); 
```

This may rule out other issues like connectivity/different schema ..

Please post the result.

# php - 文件上传 PHP JPG 问题

> ID：15207022
> 
> 赞同：1
> 
> 时间：2013-03-04T17:08:03.013
> 
> 标签：php, file, file-upload, upload, jpeg

我在使用文件上传 HTML 表单和一些 PHP 来处理输入时感到困惑。在表单中，我有两个图像文件选择。上传 .png 文件时，我可以使用 $_FILES 获取文件大小等。但是，当我尝试上传 .jpg 文件时，我无法获得比文件名更多的信息，没有大小、类型、临时名称。

当一次上传两个文件时，.png 和 .jpg，一切都适用于 .png 文件，但不适用于 .jpg。

我在这里想念什么？将 $_FILES 与 .jpg 文件类型或我不知道的其他内容一起使用时是否有任何“限制”？

示例代码：

```
 if (isset($_FILES['upload1'])) {            // JPG FILE
        $fileName1 = $_FILES['upload1']['name'];
        $fileSize1 = $_FILES['upload1']['size'];
        echo $fileName1;
        echo $fileSize1;
    }
    if (isset($_FILES['upload2'])) {            // PNG FILE
        $fileName2 = $_FILES['upload2']['name'];
        $fileSize2 = $_FILES['upload2']['size'];
        echo $fileName2;
        echo $fileSize2;
    } 
```

输出类似（不带括号）：

```
"filename1.jpg" "0" "filename2.png" "12313" 
```

print_r($_FILES) 输出：
Array (
[upload1] => Array (
[name] => volvo1.png
[type] => image/png
[tmp_name] => C:\wamp\tmp\php14AD.tmp
[error] => 0
[size] => 6380)

[upload2] => Array (
[name] => IMG0379.JPG
[type] => [tmp_name] =>
[error] => 1
[size] => 0)
)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:03:20.333

**Issue solved, for those that might encounter the same issue the solution is as easy as to change the upload_max_filesize in php.ini.**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-05-28T08:00:31.007

Markus 对，更改 /etc/php/7.3/apache2/php.ini 中的 upload_max_filesize

```
; http://php.net/upload-max-filesize
upload_max_filesize = 200M 
```

如果仍然没有，也许安装这些库

```
apt-get install -y libpng-dev 
apt-get install -y    libwebp-dev 
apt-get install -y    libjpeg62-turbo-dev 
apt-get install -y    libjpeg-dev 
apt-get install -y    libpng-dev libxpm-dev 
apt-get install -y    libfreetype6-dev 
```

# git - Git commit 显示全部文件替换而不是逐行更改

> ID：15207024
> 
> 赞同：3
> 
> 时间：2013-03-04T17:08:07.977
> 
> 标签：git, github, pull-request

每次一位同事向我发送拉取请求并且我在 GitHub 上查看它时，提交中的一些文件会显示为全新的内容，例如 1200 行删除和 1220 行添加，而他实际上只添加了 20 行新行。

这些文件没有被重新格式化，看起来几乎没有变化，但 Git 显示 100% 粉红色，然后是 100% 绿色。

任何可能导致这种情况的想法都将非常感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:10:55.763

一个真实的例子会有所帮助，但很可能......

## 新线

行尾不同。Github 有一个[有用的页面](https://help.github.com/articles/dealing-with-line-endings#platform-all)，解释了如何配置 git 以便透明地处理这些差异：

```
git config --global core.autocrlf input
# Set this setting on OSX or Linux

git config --global core.autocrlf true
# Set this setting on Windows 
```

您也可以通过修改编辑器设置来解决问题。

## 仅查看非空白更改

[`git diff`](https://www.kernel.org/pub/software/scm/git/docs/git-diff.html)可用于查看忽略空格的实际差异。它有多种模式，例如：

```
git diff --ignore-space-change someotherbranch 
```

将输出一个差异，忽略缩进和行尾的差异。

# java - 使用字符串变量来引用对象字段

> ID：15207031
> 
> 赞同：1
> 
> 时间：2013-03-04T17:08:47.730
> 
> 标签：java, reflection

我有一个带有几个不同字符串字段（标题、作者、主题...）的 Book 对象，并且我正在设计一个 GUI 来显示书籍集合中的每个字段。我有一个面板，对于每个字段，我想要一个标签（命名字段）、一个 TextField（显示存储在该字段中的值）和一个编辑按钮，它使 TextField 可编辑并显示第二个按钮保存所做的任何编辑。

我不想将这些中的每一个单独编码到面板中，而是创建一个带有单个标签、TextField 和按钮的“字段面板”。然后我想使用 foreach 循环为每个字段（存储在列表中）创建这些面板之一并将这些面板加载到主面板中。

我知道以下是不可能的：

```
Book b = new Book();
String[] fieldTitles = {title, author, subject, publisher};
for (String str : fieldTitles) { 
    FieldPanel fp = new FieldPanel();
    fp.namelabel.settext(str);
    fp.textField.settext(b.str);
} 
```

但是有没有另一种方法来实现我在最后一行尝试做的事情，即使用命名的字符串变量来引用对象的字段？换句话说，我想做：（`objectInstance.stringVariable`其中 stringVariable 匹配 objectInstance 的字段名称。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:11:31.847

你在寻找反思。有一个关于该主题的[Java 教程](http://docs.oracle.com/javase/tutorial/reflect/index.html)可以帮助您入门，然后有很多很多库可以使反射更容易，例如[Commons BeanUtils和](http://commons.apache.org/proper/commons-beanutils//)[Spring 的 util 包](http://static.springsource.org/spring/docs/current/javadoc-api/org/springframework/util/package-summary.html)中的几个类。几乎所有的框架都会在其中包含某种反射辅助类，因为直接使用反射非常麻烦。

作为您的案例的快速示例，使用[Commons BeanUtils.getProperty()](http://commons.apache.org/proper/commons-beanutils//api/org/apache/commons/beanutils/BeanUtils.html#getProperty%28java.lang.Object,%20java.lang.String%29)，您可以说：

```
fp.textField.settext((String) BeanUtils.getProperty(b, str)); 
```

这是一个以手动方式执行此操作的完整示例，因此您可以了解它是如何适应的：

```
import java.lang.reflect.Field;

public class BasicReflectionGettingFieldValues {
    public static void main(String[] args) {
        FieldPanel fp = new FieldPanel();
        Book b = new Book("Mostly Harmless", "Douglas Adams");
        for (String str : Arrays.asList("author", "title")) {
            fp.namelabel.settext(str);
            fp.textField.settext(getField(b, str));
        }
    }

    private static String getField(Book b, String str) {
        try {
            Field field = Book.class.getDeclaredField(str);
            field.setAccessible(true);
            return (String) field.get(b);
        } catch (NoSuchFieldException e) {
            throw new IllegalStateException("Bad field name: " + str, e);
        } catch (IllegalAccessException e) {
            throw new IllegalStateException("Failed to access field " + str + " after making it accessible", e);
        }
    }

    static class Book {
        private String title;
        private String author;

        Book(String title, String author) {
            this.title = title;
            this.author = author;
        }
    }
    static class TextField {
        void settext(String s) {
            System.out.println("Setting text field to '" + s + "'");
        }
    }
    static class NameLabel {
        void settext(String s) {
            System.out.println("Setting name label to '" + s + "'");
        }
    }
    static class FieldPanel {
        private NameLabel namelabel = new NameLabel();
        private TextField textField = new TextField();
    }
} 
```

# python - Python：使用异或和移位寄存器的 CRC 实现

> ID：15207036
> 
> 赞同：1
> 
> 时间：2013-03-04T17:09:00.903
> 
> 标签：python, hardware, xor, crc

我试图用 CRC 生成器 100101 实现 5 位 CRC。但是，此代码没有反映 CRC 中的硬件 Xor 和移位寄存器；在硬件层面，我们有以下内容：

![在此处输入图像描述](../Images/53eecce91f450adc13410c6604d10460.png)

这如何在 python 上实现？

作为澄清，我想知道是否有一些代码可以处理按位异或和移位运算符 << 作为解决此问题的方法

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:35:06.683

我不确定你在问什么——到目前为止，你的代码看起来还不错，而且正如你所说，它给出了正确的结果。

我可能会指出标准库中的[collections.deque](http://docs.python.org/2/library/collections.html#collections.deque)数据结构，我发现它对于表示移位寄存器非常有用，因为它提供了`rotate()`完全执行这种循环移位的方法。

此代码给出与您的代码相同的结果：

```
from collections import deque

deque_crc = deque([0,0,0,0,0],maxlen=5)

myID.extend(deque_crc)

for x in myID:
    deque_crc.rotate(-1)
    deque_crc[2] = (deque_crc[2] + deque_crc[4]) % 2
    deque_crc[4] = (deque_crc[4] + x) % 2

myID[-5:] = deque_crc

print myID 
```

编辑：

由于您要求算法的按位实现，您可能需要检查这些来源：

*   [http://wiki.python.org/moin/BitManipulation](http://wiki.python.org/moin/BitManipulation)
*   [位串模块](http://pythonhosted.org/bitstring/index.html)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T08:34:28.447

如果您想真正使用 CRC 代码（而不是研究它们的实现），您可能会发现[Python crcmod](http://crcmod.sourceforge.net/)模块非常有用。我已经使用它多年了，它非常易于使用。只需输入多项式并准备好一个 CRC 函数来处理您的数据。

然而，它可能不支持 5 位 CRC 多项式。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-06T12:01:10.833

> 然而，这段代码并没有反映 CRC 中的硬件异或和移位寄存器；

确实如此！

这个：

```
CRC[0] = CRC[1]
CRC[1] = CRC[2]
CRC[2] = CRC[3]
CRC[3] = CRC[4]
CRC[4] = input 
```

*是*移位寄存器的模型。

这`(Something+1) %2`是表示 XOR 操作的一种方式。

我认为您已经非常准确地建模了您展示的图表！

# cluster-computing - @ApplicationScoped 和 JBoss 集群

> ID：15207042
> 
> 赞同：0
> 
> 时间：2013-03-04T17:09:20.267
> 
> 标签：cluster-computing, jboss6.x

是通过`@ApplicationScoped`JBoss 6 集群的所有节点共享的资源吗？你有一些文档可以建议吗？TIA。

# javascript - WordPress 主题中使用的脚本（sticky.js）不起作用

> ID：15207043
> 
> 赞同：1
> 
> 时间：2013-03-04T17:09:32.277
> 
> 标签：javascript, jquery, wordpress-theming, wordpress

我正在尝试在我的**wordpress**网站上使用**sticky.js 。**我已经通过函数文件成功添加了它们，它们应该出现在我的页脚中。我的问题是让sticky.js 附带的代码片段运行：

 **```
<script>
  $(document).ready(function(){
    $("#sticker").sticky({topSpacing:0});
  });
</script> 
```

我将此代码放在 header.php 中标题部分的底部，但它不起作用，因此我添加并包含了另一个名为 run-sticky.js 的 js 文件，并将其添加到我的函数中，从而成功地将脚本添加到页脚。

我用#nav-wrapper 替换了#sticker，因为一旦用户像创建者网站上的按钮一样滚动到该点，我希望将其固定到页面顶部：

[http://labs.anthonygarand.com/sticky](http://labs.anthonygarand.com/sticky)

这是我正在开发的网站。

[http://futurehistoryfestival.com](http://futurehistoryfestival.com)

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:13:34.387

在您的控制台中，它显示“$ 不是函数”。似乎 jQuery 以无冲突模式运行。试试这个：

```
jQuery(document).ready(function(){
  jQuery("#nav-inner-wrapper").sticky({ topSpacing: 0 });
}); 
```**

# asp.net - 无法在 LINQ 查询中使用选择

> ID：15207044
> 
> 赞同：0
> 
> 时间：2013-03-04T17:09:32.670
> 
> 标签：asp.net, linq, entity-framework

我有一个方法，我试图通过 LINQ 查询返回一些数据库结果，但是 Visual Studio 不允许我使用 select 语句。这是我到目前为止所拥有的：

```
public static int GetCurrentUserDepartmentId(Guid userGuid)
{
    int departmentId = -1;

    using (PTMS_DataEntities entities = new PTMS_DataEntities())
    {
        var userDepartment = from employee in entities.Employees
                             join user in entities.aspnet_Users
                             on employee.User_Id equals user.UserId
                             where employee.User_Id equals userGuid                                     

        departmentId = (int)userDepartment;                
    }

    return departmentId;
} 
```

但是，在 LINQ 段中，我希望*它*如下所示：

```
from employee in entities.Employees
join user in entities.aspnet_Users
on employee.User_Id equals user.UserId
where employee.User_Id equals userGuid  
select employee.Department_Id 
```

不允许我添加最后一个选择部分是否有特殊原因？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:15:15.293

纠正你的

```
where employee.User_Id equals userGuid 
```

和

```
where employee.User_Id == userGuid 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:16:50.540

问题在于您的 where 子句：

```
var userDepartment = from employee in entities.Employees
                         join user in entities.aspnet_Users
                         on employee.User_Id equals user.UserId
                         where employee.User_Id equals userGuid 
```

应该：

```
var userDepartment = from employee in entities.Employees
                         join user in entities.aspnet_Users
                         on employee.User_Id equals user.UserId
                         where employee.User_Id == userGuid
                         select employee.Department_Id 
```

# c# - 通过 GetSchema 确定主键列

> ID：15207045
> 
> 赞同：5
> 
> 时间：2013-03-04T17:09:37.663
> 
> 标签：c#, .net, tsql, ado.net

有没有办法使用 ADO.NET 方法确定列是否是主键`GetSchema`？

这是我到目前为止所得到的：

```
public IEnumerable<DbColumnInfo> GetColumns(string providerName, string connectionString, string tableName)
{
    DbProviderFactory factory = DbProviderFactories.GetFactory(providerName);
    using (DbConnection connection = factory.CreateConnection())
    using (DbCommand command = factory.CreateCommand())
    {
        connection.ConnectionString = connectionString;
        connection.Open();
        command.Connection = connection;

        var columns = connection.GetSchema("Columns", tableName.Split('.'));
        foreach (DataRow row in columns.Rows)
        {
            yield return new DbColumnInfo()
            {
                Name = row.Field<string>(3),
                OrdinalPosition = row.Field<short>(4),
                DataType = this.FormatDataType(row),
                IsNullable = string.Equals(row.Field<string>(6), "yes", StringComparison.InvariantCultureIgnoreCase),
                IsPrimaryKey = // ... ?
            };
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T18:30:38.837

恐怕您无法确定 connection.GetSchema() ...

但作为一种解决方法，您可以尝试使用 dataadapter，如果它适合您：

```
 var da = factory.CreateDataAdapter();
    command.CommandText = "select * from Employees";
    da.SelectCommand = command;
    da.MissingSchemaAction = MissingSchemaAction.AddWithKey;

    var dtab = new DataTable();
    da.FillSchema(dtab, SchemaType.Source);

    foreach (DataColumn col in dtab.Columns)
    {
        string name = col.ColumnName;
        bool isNull = col.AllowDBNull;
        bool isPrimary = dtab.PrimaryKey.Contains(col);
    } 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-04-30T16:26:30.553

自从*qes*询问以来，我目前使用的（自从*Laszlo*提供了他的工作解决方案以来，经过几个版本重构代码之后）并不像我希望的那样优雅，但它更有效并且满足了我的需求。基本上，我提供了一个`DbInfoProvider`类，该类旨在为给定的提供者生产`DbTableInfo`和`DbColumnInfo`服务。`SqlDbInfoProvider`仅用于获取 SQL Server 的列信息：

```
public IEnumerable<DbColumnInfo> GetColumns(string connectionString, DbTableInfo table)
{
    DbProviderFactory factory = DbProviderFactories.GetFactory(this.providerName);
    using (DbConnection connection = factory.CreateConnection())
    using (DbCommand command = factory.CreateCommand())
    {
        connection.ConnectionString = connectionString;
        connection.Open();
        command.Connection = connection;
        command.CommandText = ColumnInfoQuery;
        command.CommandType = CommandType.Text;
        var tableSchema = factory.CreateParameter();
        tableSchema.ParameterName = "@tableSchema";
        tableSchema.DbType = DbType.String;
        tableSchema.Value = table.Schema;
        command.Parameters.Add(tableSchema);
        var tableName = factory.CreateParameter();
        tableName.ParameterName = "@tableName";
        tableName.DbType = DbType.String;
        tableName.Value = table.Name;
        command.Parameters.Add(tableName);

        var dataTable = new DataTable();
        using (var reader = command.ExecuteReader())
        {
            while (reader.Read())
            {
                yield return new DbColumnInfo()
                {
                    Name = reader.GetString(0),
                    OrdinalPosition = reader.GetInt32(1),
                    DataType = reader.GetString(2),
                    IsNullable = reader.GetBoolean(3),
                    IsPrimaryKey = reader.GetBoolean(4),
                    IsForeignKey = reader.GetBoolean(5),
                    IsUnique = reader.GetBoolean(6),
                };
            }
        }
    }
} 
```

`ColumnInfoQuery`像这样的静态字符串在哪里：

```
SELECT c.[column_name]
     , CAST(c.[ordinal_position] AS int) [ordinal_position]
     , CASE WHEN c.[data_type] IN ( 'bit', 'date', 'datetime', 'smalldatetime', 'int', 'bigint', 'smallint', 'tinyint', 'real', 'money', 'smallmoney', 'image', 'text', 'ntext' )  THEN c.[data_type]
            WHEN c.[character_maximum_length] IS NOT NULL
            THEN c.[data_type] + '(' + CAST(c.[character_maximum_length] AS VARCHAR(30)) + ')'
            WHEN c.[datetime_precision] IS NOT NULL 
            THEN c.[data_type] + '(' + CAST(c.[datetime_precision] AS VARCHAR(30)) + ')'
            WHEN c.[numeric_scale] IS NOT NULL 
            THEN c.[data_type] + '(' + CAST(c.[numeric_precision] AS VARCHAR(30)) + ',' + CAST(c.[numeric_scale] AS VARCHAR(30)) + ')'
            WHEN c.[numeric_precision] IS NOT NULL 
            THEN c.[data_type] + '(' + CAST(c.[numeric_precision] AS VARCHAR(30)) + ')'
            ELSE c.[data_type]
       END [data_type]
     , CAST(MAX(CASE c.[is_nullable] WHEN 'YES' THEN 1 ELSE 0 END) AS bit) [is_nullable]
     , CAST(MAX(CASE WHEN pk.[constraint_type] = 'PRIMARY KEY' THEN 1 ELSE 0 END) AS bit) [is_primary_key]
     , CAST(MAX(CASE WHEN pk.[constraint_type] = 'FOREIGN KEY' THEN 1 ELSE 0 END) AS bit) [is_foreign_key]
     , CAST(MAX(CASE WHEN pk.[constraint_type] = 'FOREIGN KEY' THEN 0 ELSE 1 END) AS bit) [is_unique]
FROM information_schema.columns c
LEFT JOIN information_schema.constraint_column_usage ccu 
        ON c.[column_name] = ccu.[column_name] 
        AND c.[table_name] = ccu.[table_name] 
        AND c.[table_schema] = ccu.[table_schema]
        AND c.[table_catalog] = ccu.[table_catalog]
LEFT JOIN information_schema.table_constraints pk 
        ON pk.[constraint_name] = ccu.[constraint_name]
        AND pk.[table_name] = ccu.[table_name] 
        AND pk.[constraint_schema] = ccu.[table_schema]
        AND pk.[constraint_catalog] = ccu.[table_catalog]
        AND pk.[constraint_type] IN ( 'PRIMARY KEY', 'FOREIGN KEY', 'UNIQUE' )
WHERE c.[table_schema] = @tableSchema
        AND c.[table_name] = @tableName
GROUP BY c.[table_schema], c.[table_name], c.[column_name], c.[ordinal_position]
       , c.[data_type], c.[character_maximum_length], c.[datetime_precision]
       , c.[numeric_precision], c.[numeric_scale], c.[is_nullable] 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2014-09-01T18:33:10.873

Yes, you can determine which columns are primary keys by requesting the schema for the Indexes. Then search the indexes for the specific colum / table

```
DataTable indexes = conn.GetSchema("Indexes");
List<string> PrimaryKeys = new List<string>();
foreach (DataRow row in indexes.Rows)
  if (Convert.ToBoolean(row["PRIMARY_KEY"]))
    PrimaryKeys.Add(row["TABLE_NAME"] + "." + row["COLUMN_NAME"]); 
```

the PrimaryKeys will contain the list of primary keys in the database. simply check if your [table].[column] is in this list.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-10-28T15:37:03.243

至少对于 Oracle ODP.Net 提供程序，GetSchema() 有一个“PrimaryKeys”选项。我建议您使用不带参数的 GetSchema() 来查看为您的实现定义了哪些其他调用。此代码检索描述 Oracle 提供程序的其他已实现 GetSchema() 调用的 GetSchema() 元定义。

```
 private void GetSchemaMetaInfo(DbConnection connection)
    {
        var metaDataCollections = connection.GetSchema("MetaDataCollections");
        var dataSourceInformation = connection.GetSchema("DataSourceInformation");
        var dataTypes = connection.GetSchema("DataTypes");
        var restrictions = connection.GetSchema("Restrictions");
        var reservedWords = connection.GetSchema("ReservedWords");
    } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-03-10T22:42:48.437

这适用于 SQLITE 和可能的其他数据库：-

```
 string[] restrictions = new string[] { null, null,   strTable };
            DataTable tableInfo = Connection.GetSchema("IndexColumns", restrictions);

            if (tableInfo == null)
                throw new Exception("TableInfo null Error");

            foreach (DataRow test in tableInfo.Rows)
            {
                Console.WriteLine(test["column_name"]);             
            } 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2015-06-04T14:41:50.680

可以使用 PrimaryKeys 集合来确定特定表的主键，然后检索相应的索引名称，然后从 IndexColumns 集合中获取构成索引和主键的列。

```
String pkIndxNm = null;
List<String> lstPkColNms = new List<String>();

DataTable dt = dbConn.GetSchema("PrimaryKeys", new[] { owner, tblNm });
if (dt.Rows.Count == 1) {
    DataRow pkRow = dt.Rows[0];
    pkIndxNm = pkRow["INDEX_NAME"] as String;

    // Now use the IndexColumns collection to pick up the names of the 
    // columns which constitute the primary key.
    //
    dt = dbConn.GetSchema("IndexColumns", new[] { owner, pkIndxNm });
    foreach (DataRow icRow in dt.Rows) {
        String colNm = icRow["COLUMN_NAME"] as String;
        lstPkColNms.Add(colNm);
    }
} 
```

这适用于使用 System.Data.Common.DbConnection 类和底层 System.Data.OracleClient 连接的 Oracle 数据库。

对于其他数据库，您可能需要检查 Restrictions 集合以了解可以作为参数传递的内容。GetSchema 限制的文档似乎毫无用处。我发现仅转储 Restrictions 集合的 DataTable 是了解如何最好地查询每个集合的最佳方式：

```
 DataTable dt = dbConn.GetSchema("Restrictions");
  AppLog.Log.Info("CollectionName | RestrictionName | ParameterName | " +
                  "RestrictionDefault | RestrictionNumber");
  AppLog.Log.Info(" ");
  foreach (DataRow r in dt.Rows) {
      String s = r["CollectionName"] as String;
      s += " | " + r["RestrictionName"] as String;
      s += " | " + r["ParameterName"] as String;
      s += " | " + r["RestrictionDefault"] as String;
      s += " | " + r["RestrictionNumber"].ToString();
      AppLog.Log.Info(s);
  } 
```

这是我得到的，从中我知道在数组的第一个和第二个位置传递所有者和 indexName 以将其约束到正确的索引。

用户 | 用户名 | 姓名 | 用户名 | 1

表 | 所有者 | 所有者 | 所有者 | 1

表 | 表 | 表名 | 表名 | 2

专栏 | 所有者 | 所有者 | 所有者 | 1

专栏 | 表 | 表名 | 表名 | 2

专栏 | 专栏 | 栏名 | COLUMN_NAME | 3

意见 | 所有者 | 所有者 | 所有者 | 1

意见 | 查看 | 视图名 | VIEW_NAME | 2

同义词 | 所有者 | 所有者 | 所有者 | 1

同义词 | 同义词 | 同义词 | SYNONYM_NAME | 2

序列 | 所有者 | 所有者 | SEQUENCE_OWNER | 1

序列 | 序列 | 序列 | SEQUENCE_NAME | 2

程序参数 | 所有者 | 所有者 | 所有者 | 1

程序参数 | 对象名 | 对象名 | 对象名 | 2

功能 | 所有者 | 所有者 | 所有者 | 1

功能 | 姓名 | 姓名 | 对象名 | 2

索引列 | 所有者 | 所有者 | 索引所有者 | 1

索引列 | 姓名 | 姓名 | 索引名称 | 2

索引列 | 桌主 | 桌主 | 表所有者 | 3

索引列 | 表名 | 表名 | 表名 | 4

索引列 | 专栏 | 栏名 | COLUMN_NAME | 5

索引 | 所有者 | 所有者 | 所有者 | 1

索引 | 姓名 | 姓名 | 索引名称 | 2

索引 | 桌主 | 桌主 | 表所有者 | 3

索引 | 表名 | 表名 | 表名 | 4

包 | 所有者 | 所有者 | 所有者 | 1

包 | 姓名 | 包名 | 对象名 | 2

封装体 | 所有者 | 所有者 | 所有者 | 1

封装体 | 姓名 | 姓名 | 对象名 | 2

论据 | 所有者 | 所有者 | 所有者 | 1

论据 | 包名 | 包名 | 包名 | 2

论据 | 对象名 | 对象名 | 对象名 | 3

论据 | 参数名称 | 参数名称 | ARGUMENT_NAME | 4

程序 | 所有者 | 所有者 | 所有者 | 1

程序 | 姓名 | 姓名 | 对象名 | 2

唯一键 | 所有者 | 所有者 | 所有者 | 1

唯一键 | 表名 | 表名 | 表名 | 2

唯一键 | 约束名称 | 约束名称 | 约束_名称 | 3

主键 | 所有者 | 所有者 | 所有者 | 1

主键 | 表名 | 表名 | 表名 | 2

主键 | 约束名称 | 约束名称 | 约束_名称 | 3

外键 | Foreign_Key_Owner | 所有者 | FKCON.OWNER | 1

外键 | Foreign_Key_Table_Name | 表名 | FKCON.TABLE_NAME | 2

外键 | Foreign_Key_Constraint_Name | 约束名称 | FKCON.CONSTRAINT_NAME | 3

外键列 | 所有者 | 所有者 | FKCOLS.OWNER | 1

外键列 | 表名 | 表名 | FKCOLS.TABLE_NAME | 2

外键列 | 约束名称 | 约束名称 | FKCOLS.CONSTRAINT_NAME | 3

# python - matplotlib 颜色映射 - 预定义映射到值？

> ID：15207052
> 
> 赞同：2
> 
> 时间：2013-03-04T17:10:04.077
> 
> 标签：python, matplotlib, python-2.x

我有一个正在查看的数组`imshow()`。（确实是 imsave()，但过程应该是相同的）。

我知道数组中的值将在 0-9 之间，并且想知道是否可以使用 cmap 将每个输出设置为特定的“颜色”。也许通过将这些映射到字典？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T02:45:53.040

只需使用`ListedColormap`.

作为一个快速（但丑陋）的例子：

```
import matplotlib.pyplot as plt
from matplotlib.colors import ListedColormap

cmap = ListedColormap(['red', 'green', 'blue', 'black'], 'indexed')

fig, ax = plt.subplots()
im = ax.imshow([range(4)], interpolation='none', cmap=cmap)
fig.colorbar(im)
plt.show() 
```

![在此处输入图像描述](../Images/dc82784c984fb727200232f416b8ff98.png)

# java - 片段内的自定义列表适配器实例化

> ID：15207055
> 
> 赞同：0
> 
> 时间：2013-03-04T17:10:13.500
> 
> 标签：java, android

我正在尝试实例化自定义列表适配器。

**适配器：**

```
private class ProverbAdapter extends ArrayAdapter<String> {
    public ProverbAdapter(Context context, int layout, int resId, String[] items) {
        super(context, layout, resId, items);
    }

    @Override
    public View getView(int position, View convertView, ViewGroup parent) {
        View row = convertView;
        if(row == null) {
            row = getLayoutInflater().inflate(R.layout.proverb_layout, parent, false);
        }

        String item = getItem(position);

        return row;
    }
} 
```

**实例化**

```
Context c = getActivity().getApplicationContext();
ProverbAdapter adapter = new ProverbAdapter(c,R.layout.proverb_layout,R.id.proverb_content,all_proverbs); 
```

我从编译器那里得到一个错误，上面写着

> 无法访问任何封闭类型的 MainActivity。必须使用 MainActivity 类型的封闭实例来限定分配。

我不确定我在这里做错了什么。似乎传递片段上下文就足够了。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:15:59.140

你有两个选择：

1.  使您的 ProverbAdapter 静态：`private static class ProverbAdapter`
2.  在 MainActivity 的实例中实例化 ProverbAdapter。

这是因为非静态内部类具有对其外部类实例的引用，因此您可以轻松访问该外部类的方法和变量。如果您不在外部类的实例中实例化内部类，则该外部类没有可用的引用。

* * *

如果您将 ProverbAdapter 设为静态，您将在`getLayoutInflater()`. 静态内部类不能访问外部类的方法或变量。您可以通过调用来解决这个特殊问题`LayoutInflater.from(getContext());`。

# c# - 根据我的模型中列表中的项目显示字段

> ID：15207056
> 
> 赞同：1
> 
> 时间：2013-03-04T17:10:15.847
> 
> 标签：c#, asp.net-mvc

在我的模型中，我实际上有一个来自另一个模型的项目列表。

我想为列表中每个项目的每个属性显示一个 TextBoxFor(disabled)，有点像购物车。

这是我的模型的一部分：

```
public class ObjOrderInfo
{
    (...)
    public List<ObjOrderDetailInfo> m_ListObjOrderDetail { get; set; }
} 
```

这是我的部分观点：

```
@using (Html.BeginForm())
{
    (...)
    @foreach (var item in Model.m_ListObjOrderDetail)
    {
        (insert code here)
    }
} 
```

基本上，我的另一个对象 (ObjOrderDetailInfo) 具有数量、价格和另一个对象等属性。我总是想为这些属性中的每一个显示一个 textboxfor 或 displayfor 。但我不知道我怎么能这样做......有人可以帮我解决这个问题吗？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:13:44.933

```
@using (Html.BeginForm())
{
    (...)
    @for (var i = 0; i < Model.m_ListObjOrderDetail.Count; i++)
    {
        @Html.DisplayFor(x => x.m_ListObjOrderDetail[i].SomeProperty)

        @Html.TextBoxFor(x => x.m_ListObjOrderDetail[i].SomeOtherProperty)

        @Html.TextBoxFor(
            x => x.m_ListObjOrderDetail[i].YetAnotherProperty, 
            new { @readonly = "readonly" }
        )
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:33:50.560

1) 创建一个名为“ObjOrderDetailInfo.cshtml”的视图。这个视图应该是强类型的`ObjOrderDetailInfo`，并且你需要`ObjOrderDetailInfo`在视图中放入控件来编辑（如果你愿意，可以使用“编辑”脚手架模板）。

2）将上面的View放在Views/Shared/EditorTemplates文件夹中。

3) 在您的 ObjOrderInfo 视图中，执行以下操作：

```
@Html.EditorFor(model => model.m_ListObjOrderDetail) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:14:39.813

像这样简单的东西应该可以工作：

```
@using (Html.BeginForm())
{
    <ul>
    @foreach (var item in Model.m_ListObjOrderDetail)
    {
        <li>@Html.DisplayFor(m => item)</li>
    }
    </ul>
} 
```

# mongodb - 以 XML 格式在 Apache Xindice 中存储视频和图像数据集

> ID：15207062
> 
> 赞同：0
> 
> 时间：2013-03-04T17:10:50.497
> 
> 标签：mongodb, xml-database

要拥有包含图像和视频的大型数据集，我想使用 Apache Xindice。Apache Xindece 的 WWW 上的教程和指南很少。如何在 Apache Xindice 中存储图像和视频文件？Apache Xindice 是否适合处理大量数据？是否有任何最新的存储库可以存储大量 XML 格式的数据（不是 SQL 类型的数据库。应该保存 TB 大小的数据）？我可以使用 MongoDB 来存储大型数据集吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-27T14:43:07.137

我建议使用 GridFS 文件系统将外部文档（图像/视频、XML 文件）存储在 MongoDB 中。GirdFS 集合由两部分组成：块集合（存储二进制数据）和文件集合（保存有关文件的信息，包括客户定义的元数据）。从[常见问题解答](http://docs.mongodb.org/manual/faq/developers/#when-should-i-use-gridfs)：

> 在某些情况下，在 MongoDB 数据库中存储大文件可能比在系统级文件系统中更有效。
> 
> 如果您的文件系统限制了目录中的文件数量，您可以使用 GridFS 存储所需数量的文件。当您希望在多个系统和设施中自动同步和部署文件和元数据时。
> 
> 当使用地理分布的副本集时，MongoDB 可以自动将文件及其元数据分发到多个 mongod 实例并提供便利。
> 
> 当您想从大文件的一部分中访问信息而不必将整个文件加载到内存中时，您可以使用 GridFS 来调用文件的部分而不将整个文件读入内存。

对于大型数据集，可以对 GridFS 进行分片（参见[http://docs.mongodb.org/manual/core/sharded-cluster-internals/#sharding-gridfs-stores](http://docs.mongodb.org/manual/core/sharded-cluster-internals/#sharding-gridfs-stores)）。

为了快速交付 GridFS 数据，有适用于 ngnix ( [ngnix-gridfs](https://github.com/mdirolf/nginx-gridfs) ) 和 Apache ( [mod_gridfs](https://bitbucket.org/onyxmaster/mod_gridfs) ) 的模块。另请参阅[http://nosql.mypopescu.com/post/28085493064/mongodb-gridfs-over-http-with-mod-gridfs](http://nosql.mypopescu.com/post/28085493064/mongodb-gridfs-over-http-with-mod-gridfs)进行快速比较

# sql - TSQL相似查询不同结果

> ID：15207063
> 
> 赞同：0
> 
> 时间：2013-03-04T17:10:53.610
> 
> 标签：sql

这个查询：

```
SELECT ROWNUMBER,FATHERITEMNO,FATHERVARIANT
FROM STOCKBILLMAT WHERE FATHERVARIANT ='LOCK' 
AND FATHERITEMNO ='U5138' 
```

给了我2个结果：

```
12779526   "U5138"   "LOCK"
12779527   "U5138"   "LOCK" 
```

但在同一张表上的以下查询：

```
SELECT ROWNUMBER,FATHERITEMNO,FATHERVARIANT
FROM STOCKBILLMAT WHERE FATHERVARIANT ='LOCK' 
AND ROWNUMBER > 12818500 
AND ROWNUMBER < 12818590 
```

给了我这5个：

```
12818532   "U5318"   "LOCK"
12818533   "U5318"   "LOCK"
12818558   "U5318"   "LOCK"
12818559   "U5318"   "LOCK"
12818560   "U5318"   "LOCK" 
```

我的问题是，除非我有一个严重的金发时刻，否则第二个查询“应该”返回的所有行也都由第一个查询返回！

笔记：

1.  我只添加了 ROWNUMBER 范围来缩小结果范围，因为我大致知道它们在哪里。如果我省略该过滤器并向下滚动，我会看到 5 个结果，而不是第一个查询中的 2 个结果......
2.  STOCKBILLMAT 是一个表，而不是一个视图。
3.  查询在同一个数据库上执行，在同一个 QueryExpress 会话中，所有内容都相同。
4.  服务器上有多个数据库具有大致相同的数据，并且在其他数据库上也会发生同样的事情。

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:20:22.800

`U5138`将您的第一个查询从TO更改`U5318`：

```
SELECT ROWNUMBER,FATHERITEMNO,FATHERVARIANT
FROM STOCKBILLMAT WHERE FATHERVARIANT ='LOCK' 
AND FATHERITEMNO ='U5318' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:22:50.440

查询按行号关闭。第一个查询返回 ROWNUMBERs 12* *7* *79526 和 12* *7* *79527，但第二个查询是不同的范围，以 12* *8* * 开头。

# .net - 多个环境中的程序集重定向/例如，对于 F# 4.0.0.0

> ID：15207065
> 
> 赞同：3
> 
> 时间：2013-03-04T17:10:58.113
> 
> 标签：.net, f#, .net-assembly, fusion, fscheck

我收到了一台新机器，并认为插入一些[机器范围的重定向只适用](https://stackoverflow.com/questions/11718385/system-wide-bindingredirect-for-f-4-0-0-0-to-4-3-0-0)于我的 FsCheck 测试，就像在我以前的机器上一样。

事实并非如此，我收到了 [与旧机器上类似的错误，](https://stackoverflow.com/questions/14530385/exception-upon-using-fscheck)所以我知道这是 FsCheck 加载 F# 4.X 而我的测试绑定到其他一些版本 4.Y

启用 FusionLog 后，重新启动以激活该野兽，为所有绑定启用 fusionlog，重新启动。我在日志中找到了罪魁祸首：

> 装配管理器加载自：
> 
> C:\Windows\Microsoft.NET\Framework\v4.0.30319\clr.dll 在可执行文件下运行 C:\PROGRAM FILES (X86)\MICROSOFT VISUAL STUDIO 11.0\COMMON7\IDE\COMMONEXTENSIONS\MICROSOFT\TESTWINDOW\vstest.executionengine.x86 。可执行程序
> 
> === 预绑定状态信息 ===
> 
> 日志：DisplayName =FSharp.Core，版本 = 4.0.0.0，文化 = 中性，
> 
> 调用程序集：FsCheck.Xunit，Version=0.3.0.0，Culture=neutral，PublicKeyToken=null。

我对绑定不太熟悉，但是：

*   为什么 fscheck 在运行测试之前没有抱怨它找到正确的 dll 而不是在运行时崩溃。我有兴趣知道什么是处理此类问题的优雅方式

*   如果 fscheck 不兼容，为什么要尝试加载版本 4.0.0.0。再次尝试理解我必须缺少的东西，因为这听起来很明显。我想这不是支持 4.X VS 4.Y 的问题，而是更多的“跑步者”被绑定到 4.X 而 fscheck 被绑定到 4.Y（是吗？在这种情况下，什么会阻止'重用'第一个绑定？）

*   为什么我的机器范围的重定向被忽略了。我想它的优先级低于任何其他本地配置文件，但 dotnet 框架不应该在解决之前的某个阶段对其进行调查。

* * *

显然我添加了以下内容以`vstest.executionengine.x86.exe.config`避免 4.0.0 绑定，但我仍然对我的无知和我们的“框架”的变幻莫测所引起的变迁感到困惑：

```
<runtime>
  <assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
    <dependentAssembly>
      <assemblyIdentity name="FSharp.Core" publicKeyToken="b03f5f7f11d50a3a"
                        culture="neutral"/>
      <bindingRedirect oldVersion="4.0.0.0" newVersion="4.3.0.0"/>
    </dependentAssembly>
  </assemblyBinding>
</runtime> 
```

# wcf - 在 EF 对象上使用 .Include 时，底层连接已关闭错误

> ID：15207066
> 
> 赞同：0
> 
> 时间：2013-03-04T17:10:59.507
> 
> 标签：wcf, entity-framework

以下代码行给了我一个错误，提示“底层连接已关闭”。

```
return this.repository.GetQuery<Countries>().Include(g => g.Cities).AsEnumerable().ToList(); 
```

但如果我删除`.Include(g => g.cities)`它工作正常。

此代码是在我的 WCF 服务中的一项操作中编写的，我尝试使用 WCF 测试客户端对其进行测试。我也尝试从 MVC 应用程序调用此操作，并且那里也发生了同样的问题。另外，我正在使用带有实体框架的通用存储库

存储库代码（只有少数重要的摘录）

构造函数：

```
public GenericRepository(DbContext objectContext)
        {
            if (objectContext == null)
                throw new ArgumentNullException("objectContext");
            this._dbContext = objectContext;

            this._dbContext.Configuration.LazyLoadingEnabled = false;
            this._dbContext.Configuration.ProxyCreationEnabled = false;
        } 
```

获取查询方法：

```
public IQueryable<TEntity> GetQuery<TEntity>() where TEntity : class
    {
        var entityName = GetEntityName<TEntity>();
        return ((IObjectContextAdapter)DbContext).ObjectContext.CreateQuery<TEntity>(entityName);
    } 
```

**尝试#1** 在存储库代码中创建了以下重载：

```
public IQueryable<TEntity> GetQuery<TEntity>(params string[] includes) where TEntity : class
        {
            var entityName = GetEntityName<TEntity>();
            IQueryable<TEntity> query = ((IObjectContextAdapter)DbContext).ObjectContext.CreateQuery<TEntity>(entityName);
                foreach(string include in includes)
                {
                    query = query.Include(include);
                }
            return query;
        }

public IQueryable<TEntity> GetQuery<TEntity>(Expression<Func<TEntity, bool>> predicate, params string[] includes) where TEntity : class
        {
            return GetQuery<TEntity>(includes).Where(predicate);
        } 
```

WCF 现在正在尝试执行以下代码行：

```
return this.repository.GetQuery<Countries>("Cities").AsEnumerable().ToList() 
```

但它仍然给出“底层连接已关闭”的相同错误。我在 WCF 测试客户端中对其进行了测试。但是，当我调试存储库代码时，它显示导航对象包含在结果中，但是在尝试将输出传递给客户端（WCF 测试客户端或任何其他客户端）时似乎出现了问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:51:13.817

查看您现在发布的代码后，我可以得出结论，确实，您的 DbContext 在 GetQuery 方法结束时被关闭，因此在您尝试使用`include`. 您可能想要解决的问题是为方法设置一个可选`params`变量，该变量`GetQuery`将包含一些要包含的属性，并且只需在`GetQuery`方法本身中执行包含权限。

# ruby - 从 Markdown 文件中删除 YAML 标头

> ID：15207069
> 
> 赞同：4
> 
> 时间：2013-03-04T17:11:04.120
> 
> 标签：ruby, regex, replace, yaml

如何从 Ruby 中的文本文件中删除像这样的 YAML 标头：

```
---
date: 2013-02-02 11:22:33
title: "Some Title"
Foo: Bar
...

--- 
```

（YAML 被三个破折号 (-) 包围）

我试过

```
text.gsub(/---(.*)---/, '') # text is the variable which contains the full text of the file 
```

但它没有用。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2015-11-05T05:41:33.363

上面提到的解决方案将匹配从第一次出现`---`到最后一次出现`---`以及介于两者之间的所有内容。这意味着如果`---`稍后出现在您的文件中，您不仅会删除标题，还会删除其他一些内容。

此正则表达式只会删除 yaml 标头：

```
/\A---(.|\n)*?---/ 
```

`\A`确保它开始与 的第一个实例匹配，并且`---`使`?`成为`*`非贪婪的，这使得它在 . 的第二个实例停止匹配`---`。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-03-04T17:20:30.610

找到了解决方案，正则表达式应该是：

```
/---(.|\n)*---/ 
```

# sql - 检查患者的最新结果是否具有一定价值的最快方法

> ID：15207070
> 
> 赞同：0
> 
> 时间：2013-03-04T17:11:06.007
> 
> 标签：sql, sql-server, tsql

mssql < 2005

我有一个包含很多表的复杂数据库，但现在只有患者表和测量表很重要。

我需要的是最新值`'code'`与某个值匹配的患者人数。此外，datemeasurement 必须在“2012-04-01”之后。我用两种不同的方式解决了这个问题：

```
SELECT
COUNT(P.patid)
FROM T_Patients P
WHERE P.patid IN (SELECT patid
                        FROM T_Measurements M WHERE (M.code ='xxxx'  AND result= 'xx')  
                AND datemeasurement = 
                    (SELECT MAX(datemeasurement) FROM T_Measurements 
                     WHERE datemeasurement > '2012-01-04' AND patid = M.patid
                     GROUP BY patid
                        GROUP by patid) 
```

和：

```
SELECT
            COUNT(P.patid)
            FROM T_Patient P

WHERE 1 = (SELECT TOP 1 case when result = 'xx' then 1 else 0 end 
        FROM T_Measurements M 
    WHERE (M.code ='xxxx')  AND datemeasurement > '2012-01-04' AND patid = P.patid
    ORDER by datemeasurement DESC
) 
```

这工作得很好，但它使查询非常慢，因为它必须在子查询上加入外部表（如果你知道我的意思）。查询需要 10 秒而不进行最近一次检查，而需要 3 分钟进行最近一次检查。

我很确定这可以做得更有效率，所以如果你愿意，请赐教:)。

我尝试实施`HAVING datemeasurment=MAX(datemeasurement)`，但不断向我抛出错误。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:28:07.997

所以我的方法是编写一个查询，获取自 2012 年 1 月 4 日以来所有最后的患者结果，然后为您的代码和结果过滤它。所以像

```
select 
    count(1) 
from
    T_Measurements M 
    inner join (
            SELECT PATID, MAX(datemeasurement) as lastMeasuredDate from
            T_Measurements M
            where datemeasurement > '01-04-2012'
            group by patID
            ) lastMeasurements 
    on lastMeasurements.lastmeasuredDate = M.datemeasurement
       and lastMeasurements.PatID = M.PatID
where
    M.Code = 'Xxxx' and M.result = 'XX' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:38:50.203

最快的方法可能是使用`row_number()`：

```
SELECT COUNT(m.patid)
from (select m.*,
             ROW_NUMBER() over (partition by patid order by datemeasurement desc) as seqnum
      FROM T_Measurements m
      where datemeasurement > '2012-01-04'
     ) m
where seqnum = 1 and code = 'XXX' and result = 'xx' 
```

`Row_number()`枚举每个患者的记录，因此最近的获得值 1。结果只是一个选择。

# java - jdbc 的 SQLServer 身份验证异常

> ID：15207074
> 
> 赞同：0
> 
> 时间：2013-03-04T17:11:21.877
> 
> 标签：java, sql-server, jdbc

我正在尝试通过我的 java 应用程序使用 jdbc 连接到新安装的 SQLServer 实例。当我尝试打开连接时，服务器返回此错误：

```
com.microsoft.sqlserver.jdbc.SQLServerException: Login failed for user 'sa'. 
```

错误堆栈跟踪：

```
com.microsoft.sqlserver.jdbc.SQLServerException: Login failed for user 'sa'. at
com.microsoft.sqlserver.jdbc.SQLServerException.makeFromDatabaseError(SQLServerE‌​xception.java:197) at    
com.microsoft.sqlserver.jdbc.TDSTokenHandler.onEOF(tdsparser.java:246) 
```

我已经启用了“SQL Server 和 Windows 身份验证模式”选项。我也尝试使用 SquirreL 连接到数据库服务器，但我遇到了同样的问题，但是使用 SQL Server Management Studio 我可以连接到数据库。

我有一个 SQLServer 2008 R2 express、jdk 6u41 和 sqljdbc4.jar JDBC 连接器。我已经在使用 SQLServer 2008 R2 express、jdk 6u33 和 sqljdbc4.jar JDBC 连接器的环境中尝试了相同的应用程序，它工作正常。

是否有一些我需要修改的 SQL 服务器配置？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:43:19.883

我认为，您在安装时已将 SQL Server 配置为 Windows 身份验证模式，但是更改程序中的设置不会将其从 Windows 身份验证模式更改。

你能做一件事吗？从您的计算机中删除 SQL Server 2008 和所有相关程序并安装新副本，这次使用 SQL Server 身份验证。它会工作...

# json - Jersey 基于 JAXB 的 JSON 支持

> ID：15207075
> 
> 赞同：1
> 
> 时间：2013-03-04T17:11:31.370
> 
> 标签：json, jaxb, jersey, jboss7.x

我正在尝试使用 Jersey 的功能从我的 Web 服务方法中生成 JSON。一切正常，但后来我发现对于对象列表，JSON 表示包含类似于封闭根标记的内容。我发现我可以使用 JSONConfiguration.natural() 配置基于 JAXB 的 JSON 支持以产生理想的结果。所以我写了以下

```
@Provider
@Produces(MediaType.APPLICATION_JSON)
public class JAXBContextResolver implements ContextResolver<JAXBContext> {

    private final JAXBContext context;

    private final Set<Class> types;

    private final Class[] cTypes = {TrRegion.class};

    public JAXBContextResolver() throws Exception {
        this.types = new HashSet(Arrays.asList(cTypes));
        this.context = new JSONJAXBContext(JSONConfiguration.natural().build(), cTypes);
    }

    @Override
    public JAXBContext getContext(Class<?> objectType) {
        return (types.contains(objectType)) ? context : null;
    }
} 
```

并像这样插入

```
public class WebServiceApplication extends Application {

    @Override
    public Set<Class<?>> getClasses()
    {
        Set<Class<?>> resources = new HashSet<Class<?>>();

        resources.add(OrderInfrastructureResource.class);
        resources.add(OrderResource.class);

        resources.add(JAXBContextResolver.class);

        return resources;
    }
}

  <servlet>
    <description>JAX-RS Tools Generated - Do not modify</description>
    <servlet-name>JAX-RS Servlet</servlet-name>
    <servlet-class>com.sun.jersey.spi.spring.container.servlet.SpringServlet</servlet-class>
    <init-param>
        <param-name>javax.ws.rs.Application</param-name>
        <param-value>com.[...].WebServiceApplication</param-value>
    </init-param>
    <load-on-startup>1</load-on-startup>
  </servlet> 
```

但由于某种原因，我总是得到

```
java.lang.IllegalStateException: No JAXB provider found for the following JAXB context: class com.sun.xml.bind.v2.runtime.JAXBContextImpl
    at com.sun.jersey.json.impl.JSONHelper.getJaxbProvider(JSONHelper.java:106) [jersey-json-1.17.jar:1.17]    
at com.sun.jersey.json.impl.JSONHelper.getJaxbProvider(JSONHelper.java:106) [jersey-json-1.17.jar:1.17]
at com.sun.jersey.json.impl.DefaultJaxbXmlDocumentStructure.getXmlDocumentStructure(DefaultJaxbXmlDocumentStructure.java:76) [jersey-json-1.17.jar:1.17]
at com.sun.jersey.json.impl.writer.Stax2JacksonWriter.<init>(Stax2JacksonWriter.java:169) [jersey-json-1.17.jar:1.17]
at com.sun.jersey.json.impl.Stax2JsonFactory.createWriter(Stax2JsonFactory.java:105) [jersey-json-1.17.jar:1.17]
at com.sun.jersey.json.impl.provider.entity.JSONListElementProvider.writeList(JSONListElementProvider.java:133) [jersey-json-1.17.jar:1.17] 
```

有人能告诉我为什么吗？

当我换线时

```
this.context = new JSONJAXBContext(JSONConfiguration.natural().build(), cTypes); 
```

至

```
this.context = new JSONJAXBContext(JSONConfiguration.mapped().build(), cTypes); 
```

它开始工作，但给出了封闭的根标签（这与不指定任何 ContextResolver 相同）。奇怪。（奇怪的意思，区别仅在于我提供的映射类型）。

我尝试在禁用 Restesy 的 Jboss 7.1.1 上运行我的应用程序（我已经删除了行`<extension module="org.jboss.as.jaxrs"/>`并`<subsystem xmlns="urn:jboss:domain:jaxrs:1.0"/>`从我的 Standalone.xml 文件中删除了）。我也使用 com.sun.jersey.spi.spring.container.servlet.SpringServlet 作为 Jersey servlet。

请告诉我我错过了什么。可能是什么问题呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T11:09:29.640

显然我的应用程序缺少 jaxb-impl 库，所以我只是`com.sun.xml.bind`在我的 jboss-deployment-structure 文件中添加了 jBoss 模块，如下所示：

```
<dependencies>
  <module name="com.sun.xml.bind" />
  <module name="org.codehaus.jackson.jackson-core-asl" />
  <module name="org.codehaus.jackson.jackson-jaxrs" />
  <module name="org.codehaus.jackson.jackson-mapper-asl" />
  <module name="org.codehaus.jackson.jackson-xc" />
</dependencies> 
```

# qt - OpenSceneGraph 和多个查看器

> ID：15207076
> 
> 赞同：4
> 
> 时间：2013-03-04T17:11:31.530
> 
> 标签：qt, opengl, openscenegraph, qglwidget

我正在使用 OpenSceneGraph 和 Qt 开发模拟软件。模拟可以涉及同一虚拟世界中的多个机器人。我对视图的要求如下：

*   能够显示静态世界相机
*   能够显示机器人摄像头
*   能够移动这些视图和/或堆叠它们

为了完成这些任务，我制作了一个“OSGWidget”，它使用一个 Osg Viewer 在 QGLWidget 中渲染场景。这个 OSGWidget 又被放置在一个 QDockWidget 中，该 QDockWidget 可以四处移动和/或堆叠，以满足该要求。

问题是，当使用多个单一查看器在不同的小部件中渲染相同的场景时，我得到了奇怪的渲染行为。即，纹理无法正确显示，有时甚至根本无法显示。

我查看了 SO 和 OSG 论坛，虽然人们也遇到过类似的问题，但我看到的唯一回复是建议切换到 Osg CompositeViewer。出于我的目的，我想避免使用它，因为它打破了我对渲染相同场景的可移动和可堆叠小部件的期望要求。

这是一个很难被 Osg 轻松处理的棘手情况吗？我看过几篇帖子说这不是 OSG 的“应该工作”方式，但他们并没有真正提供事实来支持这种说法。有没有人做过类似的事情或有任何想法/见解？如果需要，我可以提供代码片段，但这可能与 Osg 的意识形态相矛盾，我将等待得到一些回应。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-12T15:21:03.227

感谢评论和其他几个站点的帮助，我能够成功地从 CompositeViewer 获得我想要的行为。

基本上，所有 OSG 视图都通过包含 CompositeViewer 的“WidgetDriver”。

```
class OsgWidgetDriver {
public:
    void init() {
        compositeViewer = new osgViewer::CompositeViewer;
        compositeViewer->setThreadingModel(osgViewer::Viewer::SingleThreaded);
        compositeViewer->setReleaseContextAtEndOfFrameHint(false);
    }

    void start() {
        initialized = true;
    }

    void stop() {
        compositeViewer->stopThreading();
        compositeViewer->setDone(true);
    }

    void updateFrame() {
        if (initialized)
            compositeViewer->frame();
    }

    void addView(osgViewer::View *view) { compositeViewer->addView(view); }
    bool isInitialized() { return initialized; }
protected:
    bool initialized;
    osgViewer::CompositeViewer *compositeViewer;
}; 
```

然后，每当我制作一个新的 Qt OSG Widget 时，我都会将 osg::View 交给驱动程序。我让驱动程序更新渲染窗口，而 Qt 仍然可以相应地更新 QWidget。它甚至允许我将小部件放置在 QDockWidget 中，以便我可以移动它们并根据需要堆叠它们。

如果其他人想这样做，请对过程进行一些最后的说明：

*   当多个 OSG 查看器查看一个场景时，您很可能会遇到奇怪的纹理显示问题。如果发生这种情况，请使用 osgUtil::Optimizer::TextureVisitor 将所有纹理设置为“UnrefImageAfterApply = false”。这将允许在多个 osg::View 实例中正确显示纹理。
*   如果您希望单个线程作用于多个视图，则我在上面设置的 CompositeViewer 选项（将线程模型设置为 SingleThreaded 并将 releaseContextAtEndOfFrame 设置为 false）是必要的。如果你像我一样使用小部件驱动程序，你会想要这样做。

# mootools - mootools 每个都不为我迭代

> ID：15207080
> 
> 赞同：0
> 
> 时间：2013-03-04T17:11:35.340
> 
> 标签：mootools, each

我在这里发疯了，但是每个功能都不适合我。我有大约 20 个类名为“lookup”（文本框）的元素，此函数成功地将所有元素变为红色：

```
 document.addEvent('domready', function()
    {
        var tb = $$('.lookup');
        tb.setStyle("color", "red");
    }); 
```

但是，在下面的代码中，我希望每个元素都得到一些警报，但警报根本没有命中，也没有引发异常。就像 each 正在迭代 0 个项目....

```
 document.addEvent('domready', function()
    {
        var tb = $$('.lookup');
        tb.each(function(el) 
        {
            alert("hi"); 
        });
    }); 
```

知道我可能做错了什么吗？在上面的两个示例中，我使用了 $$('.lookup').each 和 $$('.lookup').setStyle() 具有相同的结果（示例 1 有效；示例 2 无效）。

提前致谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-05T02:16:45.543

哪些浏览器有问题？尝试使用“窗口”而不是“文档”

```
window.addEvent('domready', function(){
    var tb = $$('.lookup');
    tb.each(function(el){
        el.setStyle("color", "red");
        alert("hi"); 
    });
}); 
```

在 mootools 中，最好始终使用“每个”来处理元素数组。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-07-29T01:53:25.973

我发现重新排序 mootools 包含脚本，以便在 Microsoft包含脚本解决问题**后引用它。**`WebResource.axd?d=`Mootools 似乎可以处理冲突，而 Microsoft ASP.NET 则不能。

# javascript - 使用变量引用数组索引时无法更改 Jquery 中的 css

> ID：15207082
> 
> 赞同：1
> 
> 时间：2013-03-04T17:11:39.343
> 
> 标签：javascript, jquery

```
var bubble = [$('#bubble1'), $('#bubble2'), $('#bubble3'), $('#bubble4'), $('#bubble5'), $('#bubble6')];
var bubbleFirst = 0;
var visibleBubbles = 3;
var bubbleHeight = 200;
var bubbleTimeDelay = 5000;

var bubbleTimer = setTimeout(function(){animateBubbles();}, bubbleTimeDelay/2);

function animateBubbles(){
    clearTimeout(bubbleTimer);//stop from looping before this is finished

    for(var i = 0; i < visibleBubbles + 1; i++){
        count = i + bubbleFirst;
        if ( count >= bubble.length ) count = count - bubble.length;//keep index inside array
        bubble[count].animate({top:'-=' + bubbleHeight}, 2000);
    }
    bubble[bubbleFirst].css('top', '600px');//put elements moving off top to bottom
    //resetBubbles();
    bubbleFirst++;
    if(bubbleFirst >= bubble.length) bubbleFirst = 0;//bubbles have looped
    bubbleTimer = setTimeout(function(){animateBubbles();}, bubbleTimeDelay);//start looping again
} 
```

*   气泡1以`top: 0px;`
*   气泡2以`top: 200px;`
*   bubble3 以`top: 400px;`
*   泡泡4-6开始`top: 600px;`
*   都`position: absolute`在一个包装器 div 中

为代码转储道歉。我的问题都集中在第 16 行：

```
bubble[bubbleFirst].css('top', '600px'); 
```

这段代码似乎从未执行过，我的控制台中没有错误，并且我已经验证了 bubble[bubbleFirst] 正在使用 console.log 返回正确的元素。（这是一个div）

我目前正在使用一种解决方法，但它不是动态的：

```
function resetBubbles(){
    /*bubble[bubbleFirst].css('top', '600px');//put elements moving off top to bottom*/
    if(bubble[0].css('top') == '-200px') bubble[0].css('top', '600px');
    if(bubble[1].css('top') == '-200px') bubble[1].css('top', '600px');
    if(bubble[2].css('top') == '-200px') bubble[2].css('top', '600px');
    if(bubble[3].css('top') == '-200px') bubble[3].css('top', '600px');
    if(bubble[4].css('top') == '-200px') bubble[4].css('top', '600px');
    if(bubble[5].css('top') == '-200px') bubble[5].css('top', '600px');
} 
```

我不知道为什么这不起作用，这可能是我的逻辑错误。但我一辈子都找不到它。任何帮助，将不胜感激。谢谢你的时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:19:12.257

对动画的调用是否可能与您自定义设置 top 属性冲突？IE。您设置了它，但`top`立即再次被`animate`. 您可以将回调传递给`animate`动画完成后将运行的回调。那是你应该重置你的气泡位置的时候。

```
function animate_bubble(index) {
    bubble[index].animate({ top: "0px" }, 2000 /* 2 seconds */, function () {
        bubble[index].css({ top: "600px" });
        animate_bubble(index);
    }
}
animate_bubble(0);
animate_bubble(1);
// etc .. probably do this in a for-loop 
```

您需要找到一些方法来取消动画，但应该不会太难。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:54:33.533

问题是`bubbleFirst`在动画完成之前增加了。我将我的功能更改为以下内容：

```
function animateBubbles(){
    clearTimeout(bubbleTimer);//stop from looping before this is finished

    for(var i = 0; i < visibleBubbles + 1; i++){
        count = i + bubbleFirst;
        if ( count >= bubble.length ) count = count - bubble.length;//keep index inside array
        if (count == bubbleFirst) 
        {
            bubble[count].animate({top:'-=' + bubbleHeight, opacity: 0}, bubbleAnimationSpeed, function(){
                bubble[bubbleFirst].css('top', displayHeight+'px');
                bubble[bubbleFirst].css('opacity', '1'); 
            });
        }
        else if(i == visibleBubbles)
        {
            bubble[count].animate({top:'-=' + bubbleHeight}, bubbleAnimationSpeed, function(){
                bubbleFirst++;
                if(bubbleFirst >= bubble.length) bubbleFirst = 0;//bubbles have looped
                bubbleTimer = setTimeout(function(){animateBubbles();}, bubbleTimeDelay);/*start looping again*/
            });
        }
        else bubble[count].animate({top:'-=' + bubbleHeight}, bubbleAnimationSpeed);
    }       
} 
```

谢谢你们的意见！

# python - 了解矩阵到列表列表，然后是 Numpy 数组

> ID：15207087
> 
> 赞同：3
> 
> 时间：2013-03-04T17:11:57.530
> 
> 标签：python, arrays, numpy

我想构造一个矩阵，如：

```
 Col1 Col2 Col3 Coln
row1  1    2    4    2     
row2  3    8    3    3
row3  8    7    7    3
rown  n    n    n    n 
```

我还没有在 python 文档中找到任何说明列表列表是如何组装的，是这样的：

```
a = [[1,2,4,2],[3,8,3,3],[8,7,7,3],[n,n,n,n]] 
```

每行都是一个列表项，或者每列应该是一个列表项：

```
b = [[1,3,8,n],[2,8,7,n],[4,3,7,n],[2,3,3,n]] 
```

我认为这将是一个常见问题，但我似乎无法找到一个直接的答案。

根据文档，我猜我可以通过以下方式将其转换为 numpy 数组：

```
np.array(a) 
```

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:15:37.543

你想要第一个版本：

```
a = [[1,2,4,2],[3,8,3,3],[8,7,7,3],[n,n,n,n]] 
```

当访问矩阵中的元素时，您通常使用`matrix[row][col]`, 因此使用上述 Python 列表格式`a[i]`将为您提供 row `i`，并`a[i][j]`为您提供第 i 行中的第 j 个元素。

将其转换为 numpy 数组`np.array(a)`是正确的方法。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:14:53.860

这： `a = [[1,2,4,2],[3,8,3,3],[8,7,7,3],[n,n,n,n]]` 将创建您想要的列表，是的， np.array(a) 会将其转换为 numpy 数组。

此外，这是“pythonish”是创建一个包含`m`行和`n`列的数组（并将所有元素设置为 0）：

`a = [[0 for i in range(n)] for j in range(m)]`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:21:39.520

使用第一个约定。如果需要转置：

```
>>> a = [[1,2,4,2],[3,8,3,3],[8,7,7,3],['n','n','n','n']]
>>> trans=[]
>>> for i in range(len(a)):
...    trans.append([row[i] for row in a])
... 
>>> trans
[[1, 3, 8, 'n'], [2, 8, 7, 'n'], [4, 3, 7, 'n'], [2, 3, 3, 'n']] 
```

然后一个元素是`a[row][col]`vs `trans[col][row]`（关于`a`你的例子）

第一个由 Python 使用，很容易看出为什么在布局时应该使用第一个约定：

```
a = [[1,2,4,2],
     [3,8,3,3],
     [8,7,7,3],
     ['n','n','n','n']] 
```

当然，当您使用 numpy 时，请使用第一个约定，因为 numpy 使用了该约定：

```
>>> np.array(a)
array([['1', '2', '4', '2'],
       ['3', '8', '3', '3'],
       ['8', '7', '7', '3'],
       ['n', 'n', 'n', 'n']], 
      dtype='|S1')
>>> np.array(trans)
array([['1', '3', '8', 'n'],
       ['2', '8', '7', 'n'],
       ['4', '3', '7', 'n'],
       ['2', '3', '3', 'n']], 
      dtype='|S1') 
```

注意：numpy 将整数转换为字符串，因为`'n'`在最后一行/列中。

当您实际开始打印该表时，这是一种方法：

```
def pprint_table(table):
    def format_field(field, fmt='{:,.0f}'):
        if type(field) is str: return field
        if type(field) is tuple: return field[1].format(field[0])
        return fmt.format(field)     

    def get_max_col_w(table, index):
        return max([len(format_field(row[index])) for row in table])         

    col_paddings=[get_max_col_w(table, i) for i in range(len(table[0]))]
    for i,row in enumerate(table):
        # left col
        row_tab=[row[0].ljust(col_paddings[0])]
        # rest of the cols
        row_tab+=[format_field(row[j]).rjust(col_paddings[j]) for j in range(1,len(row))]
        print(' '.join(row_tab))                

pprint_table([
        ['','Col 1', 'Col 2', 'Col 3', 'Col 4'],
        ['row 1', '1','2','4','2'],
        ['row 2','3','8','3','3'],
        ['row 3','8','7','7','3'],
        ['row 4', 'n','n','n','n']]) 
```

印刷：

```
 Col 1 Col 2 Col 3 Col 4
row 1     1     2     4     2
row 2     3     8     3     3
row 3     8     7     7     3
row 4     n     n     n     n 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T17:28:17.680

既然你提到了“矩阵”，我还要补充一点，你也有 np.matrix() 选项。

例如：您可以使用

```
A = [[1,2,3],[4,5,6],[7,8,9]] 
```

创建一个列表（列表），每个内部列表代表一行。

然后

```
AA = np.array(A) 
```

将创建一个具有矩阵外观的二维数组，但不是矩阵的所有属性。

然而

```
AM = np.matrix(A) 
```

将创建一个矩阵。

如果您对这两个执行算术运算，那么您会看到差异。例如

```
AA**2 
```

将平方二维数组中的每个元素。然而

```
AM**2 
```

将自行执行 AM 的矩阵乘法。

顺便提一句。上述用法当然假设“将 numpy 导入为 np”。

# jquery - 在哪里使用 JQuery-UI AJAX PHP 添加验证？

> ID：15207089
> 
> 赞同：0
> 
> 时间：2013-03-04T17:12:17.483
> 
> 标签：jquery, ajax, jquery-ui, jquery-validate

我已经尝试了所有我能想到的在创建表单 DOM 对象后添加验证的变体。代码本身可以打开和关闭 jquery-ui.dialog。我只是不知道在处理程序中的何处拼接以进行任何验证。

```
 //party_device_edit Begin 
    var party_device_edit = $('#party_device_edit').dialog({
      autoOpen: false,  width:'auto',  modal: true, title: 'Edit Device', 
      buttons: {
        'Save': function(){
**//Tried Adding Validation Here**
            $.ajax({
            url: '/party_device/save.php',
            type: 'POST',
            data: $('#party_device_edit_form').serialize(),
            success: function(data){
              //Re-queries the data and refreshes the piece of the page that has updated data.
              $.get('helper.php?function=party_device&id=<?php echo $_GET['id'];?>',function(data){$('#party_device').html(data);});
              $('#party_device_edit').dialog('close');
            }
          });
        return false;
        }
      }
    });
    $(document).on('click', '.party_device_edit', function (e) {
        e.preventDefault();
        $.ajax({
        url: $(this).attr('href'),
        type: 'POST',
        success: function(data){
          party_device_edit.html(data);
**//Tried Adding Validation Here**
          party_device_edit.dialog('open');
**//Tried Adding Validation Here**
        }
      });
    });
    //party_device_edit End 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:24:35.043

[你把`ajax`里面的`submitHandler`Validate plugin](http://docs.jquery.com/Plugins/Validation/validate#toptions)，然后`.submit()`为你的模态分配一个“保存”按钮。

```
$(document).ready(function () {

    $("#party_device_edit_form").validate({
        // // validate rules & options,
        submitHandler: function (form) {
            $.ajax({
                url: '/party_device/save.php',
                type: 'POST',
                data: $(form).serialize(),
                success: function (data) {
                    //Re-queries the data and refreshes the piece of the page that has updated data.
                    $.get('helper.php?function=party_device&id=<?php echo $_GET['
                    id '];?>', function (data) {
                        $('#party_device').html(data);
                    });
                    $('#party_device_edit').dialog('close');
                }
            });
            return false;
        }
    });

    var party_device_edit = $('#party_device_edit').dialog({
        autoOpen: false,
        width: 'auto',
        modal: true,
        title: 'Edit Device',
        buttons: {
            'Save': function () {
                $("#party_device_edit_form").submit();
            }
        }
    });

}); 
```

*由于您未能显示 HTML，我无法创建特定的演示，但这里有一个与您的非常*相似的测试用例......

**演示：http: [//jsfiddle.net/7bA8M/](http://jsfiddle.net/7bA8M/)**

# wordpress - WordPress WP-admin IP 检查和重定向

> ID：15207095
> 
> 赞同：1
> 
> 时间：2013-03-04T17:12:35.753
> 
> 标签：wordpress, security, .htaccess

我计划在即将到来的项目中使用 Wordpress，对我来说最大的问题是安全性。

我将拥有几个能够更新站点的用户，并且我给了自己几个选项。我可以构建一个静态网页，然后有一个“博客”页面，该页面仅使用 WordPress 安装该页面。这对于博客功能来说似乎有点过分，但它是一种选择。

我正在考虑的另一个选项是完整的 WordPress 安装来为整个网站提供动力。我的大问题是阻止`/wp-admin`所有人，但不会改变静态 IP 的人。我在想，如果我走这条路线，我可以用我`.htaccess`的来检查 IP，如果它返回 false，则将其重定向到主页。如果是真的，那么继续到 wp-admin 登录页面。

如果我选择第二个选项，我如何使用`.htaccess`它来检查 IP，如果它返回 false，则重定向回主页。如果是真的，请继续访问 WordPress 登录页面。

这是最好的起点吗？

```
<Location /wp-admin/>
    order allow,deny
    allow from 1.1.1.1
    deny from all 
</Location> 
```

我很感激任何提前输入！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:31:15.567

您不能[`Location`](http://httpd.apache.org/docs/current/mod/core.html#location)在 .htaccess 文件中使用。如您所见，[`Context`](http://httpd.apache.org/docs/current/mod/directive-dict.html#Context)它只允许在主服务器配置文件或虚拟主机部分中使用。

此外，如果`wp-admin`是文件系统中的真实目录，则不应将其用于安全性

> **<Location> 指令**
> <Location> 部分完全在文件系统之外运行。这有几个后果。最重要的是，不应使用 <Location> 指令来控制对文件系统位置的访问。由于几个不同的 URL 可能映射到相同的文件系统位置，因此可以绕过这种访问控制。

如果您使用[主机访问控制](http://httpd.apache.org/docs/current/howto/access.html)，则顺序应为

```
Order deny,allow
Deny from all
Allow from 1.1.1.1 
```

这确保了任何人都被禁止访问`/wp-admin/`，除了给定的 IP 地址或域。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:29:43.790

我认为这是记录在这里：[http ://httpd.apache.org/docs/trunk/howto/auth.html](http://httpd.apache.org/docs/trunk/howto/auth.html)

您可能需要将其与以下内容结合使用：[http](http://httpd.apache.org/docs/2.2/howto/htaccess.html) ://httpd.apache.org/docs/2.2/howto/htaccess.html和以下内容：[http://httpd.apache.org/docs/trunk/mod/mod_authz_core。 html#要求](http://httpd.apache.org/docs/trunk/mod/mod_authz_core.html#require)

但是，似乎这样的事情可以工作：

```
<Directory /wp-admin/>
    Require ip 192.168.1.104 192.168.1.205
</Directory> 
```

全面披露：我猜。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T19:42:07.483

我能够使用 Olaf Dietsche 写的东西来引导我朝着正确的方向前进。通过将下面的代码放在我的 wp-admin 文件夹而不是根目录中，我能够控制谁可以访问我的 url/wp-admin 登录名，如果他们不匹配允许的 IP，那么我将它们重定向回主页。

```
Options +FollowSymlinks
RewriteEngine on

#urls to exclude
RewriteCond %{REQUEST_URI} !/wp-admin$
RewriteCond %{REQUEST_URI} !^/images$
RewriteCond %{REQUEST_URI} !^/$

#ip to allow access
RewriteCond %{REMOTE_HOST} !^111\.111\.111\.111$

#send to root. If you want a specific URL, use /yourcustomurl.html
RewriteRule .? / [R=302,L] 
```

我感谢大家的意见。非常感谢！

# java - 在 Java (Swing) 中设置背景图像和灰色 GlassPane

> ID：15207097
> 
> 赞同：1
> 
> 时间：2013-03-04T17:12:50.700
> 
> 标签：java, image, swing, glasspane

我目前正在为两个 Java GUI 事情苦苦挣扎。

情况是这样的：我正在使用 Swing 组件设计一个文字游戏。我有一个放置所有东西的主 JFrame（我的 GUI 类扩展了 JFrame）。我想做两件事：

**第一种：**我想设置一个图像作为主框架的背景图像，它必须显示在所有组件的后面。我四处寻找，但没有找到可行的解决方案。我尝试制作一个扩展的 BackGroundPanel 类，但是当我创建 BackGroundPanel 的一个实例时，我不知道如何使它成为框架的背景......我也没有找到从“图像”加载图像的好方法我的 src 文件夹中的目录...

**第二：**当程序启动时，用户会看到一个未装饰的 JDialog，需要禁用主框架，我想通了，但我也想让它变暗一点。我相信 GlassPane 应该是可能的，但我不知道如何设置 GlassPane 用一种颜色覆盖面板......

帮助将不胜感激，我认为我没有任何有用的代码可以分享，但我认为上面解释的情况给出了一个大致的想法？我只是希望有人能让我走上正轨，这样我就可以进一步解决这个问题！谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:07:10.517

> 我的 Main 类扩展`JFrame`了，它有一个`BorderLayout`.

将您添加`BorderLayout`到拥有`JPanel`中，例如`GridLayout()`。

1.  这[`AnimationTest`](https://stackoverflow.com/a/3256941/230513)说明了在组件后面绘制背景图像。

2.  此[`Translucent`](https://stackoverflow.com/a/2166500/230513)示例说明使用`AlphaComposite`; 另请参阅此[`AlphaTest`](https://stackoverflow.com/a/2234020/230513)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:24:24.153

那么对于您的第一个问题，您可以使用标签并设置它的图标：

```
JLabel lblimage = new JLabel("");

lblimage.setIcon(new ImageIcon(Main.class.getResource("/img/background.png")));
lblimage.setBounds(0, 0, 794, 711); //size of frame

contentPane.add(lblimage); //bottom
contentPane.add(component1); //middle low
contentPane.add(component2); //middle top
contentPane.add(component3); //top 
```

至于你的第二个问题..你可能会做同样的事情，只需使用纯色图像并降低透明度，然后放在其他组件的顶部（虽然不确定这个解决方案）。

# mysql - 使用通配符的 SQL 文本搜索

> ID：15207098
> 
> 赞同：0
> 
> 时间：2013-03-04T17:12:53.447
> 
> 标签：mysql, sql

我必须对我的完整 InnoDB MySql 数据库的 2 个字段进行文本搜索。过去我用过：

```
Field1 LIKE %text% OR Field2 LIKE %text% 
```

但是现在我的数据增加了很多，“Like”搜索变得太慢了。所以我开始寻找另一个更好的解决方案。

从现在开始我尝试：

*   全文索引 (MATCH(...) AGAINST) -> 不支持前导通配符

*   包含 -> 在 MySql 中不可用（仅 Transact-Sql）

*   反向全文索引 -> 使用前导通配符，但如果匹配位于中间则不使用

*   REGEXP -> 并不比 LIKE 快

我使用 MyISAM“影子表”作为全文索引...

我不想使用 Sphinx、Lucene 或 se 等外部搜索引擎

所以我的问题是：有什么我忘记了吗？我正在考虑一个让两个通配符工作的技巧。就像 Oracle 中的上下文索引。或者我不知道……这就是我问的原因；）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T00:18:38.200

模式中的前导百分号“%”会导致执行表扫描，因此随着数据量的增加，性能会下降。

请注意，这也反映了由于字段的非原子性质，您的数据不再是“相关的”；您的数据库不再是关系数据库，尽管您仍在使用 RDBMS 作为数据存储引擎。

真正的解决方案是通过将 Field1 和 Field2 转换回一组关系（即原子）字段来重构数据表。我知道，这可能超出手头项目的任何合理范围；但这是解决方案。

# javascript - 延迟被调用函数中的javascript代码执行

> ID：15207103
> 
> 赞同：0
> 
> 时间：2013-03-04T17:13:18.520
> 
> 标签：javascript, jquery

所以我有这个类，它具有捕获一些特定信息的方法。一种非常重要的方法是`getViewportWidth`。

由于 Android 2.2 左右的错误/功能，报告的宽度对于使用此设备平台的用户来说不太准确（您可以在此处查看更多信息：[如何使用 Javascript 找到虚拟视口/屏幕宽度？](https://stackoverflow.com/questions/8677794/how-do-i-find-the-virtual-viewport-screen-width-using-javascript)

解决方法似乎是延迟整个脚本的脚本执行。但是，因为我需要处理这种对用户的透明性，所以我想在函数级别（即我的`getViewportWidth`函数）延迟脚本执行。

这样用户就可以调用：

`MyClass.getViewportWidth();`

延误会得到解决。

所以基本上，我试图找到一种方法将我的`getViewportWidth`函数中的代码执行延迟 200 毫秒，以适应这个错误/功能。我怎样才能做到这一点？！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:16:27.953

您可以使用`setTimeout`将函数的执行延迟几毫秒。像这样使用：

```
var text = "Hi!";
setTimeout(function () {
    alert(text);
}, 200); // 200 ms 
```

# asp.net - 在验证器被评估为无效之前，是否可以避免从 ASP.Net 验证器控件呈现错误消息？

> ID：15207110
> 
> 赞同：2
> 
> 时间：2013-03-04T17:13:50.853
> 
> 标签：asp.net, css, section508

考虑到我无法在其他任何地方找到需要此功能的其他人的单个实例，这*可能*是一个不可行的要求。那说：

我正在开发的一个网站使用几十个不同的验证器控件（从RequiredFieldValidaotrs 到CustomValidators 的所有控件）来进行表单验证。作为我们第 508 节合规性的一部分，我们必须支持禁用 CSS 的用户，这是有问题的，因为验证器将错误文本呈现到页面并使用 CSS 显示属性来隐藏它。当 CSS 被禁用时，所有错误消息都可以被屏幕阅读器看到和阅读。

缺少使用标签和回发来显示和隐藏所述标签，是否有任何已知的方法可以使用禁用 CSS 的 ASP.Net 验证器控件？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:38:38.513

使用`Display="None"`FieldValidator 控件上的属性和`ValidationSummary`标签来包含消息。

```
<form id="form1" runat="server">
        <asp:TextBox runat="server" ID="TextBox1"  /> <br />
        <asp:TextBox runat="server" ID="TextBox2"  /> <br />
        <asp:Button runat="server" Text="Go"  />

        <div class="messages">
            <asp:ValidationSummary id="summery1"  runat="server"/>
        </div>

        <div>
        <asp:Panel ID="Panel1" runat="server" >
            <asp:RequiredFieldValidator ID="RequiredFieldValidator1"  runat="server" 
                    ErrorMessage="Required Field Validator1 empty" ControlToValidate="TextBox1" Display="None" />
                <asp:RequiredFieldValidator ID="RequiredFieldValidator2"  runat="server" 
                    ErrorMessage="Required Field Validator2 empty" ControlToValidate="TextBox2" Display="None" />
        </asp:Panel>
        </div>
    </form> 
```

但是......（总是有一个问题）......使用这种方法，验证消息本身仅存储在 JavaScript 中。这意味着如果禁用 Javascript，它将无法工作。我假设这不是一个大问题，因为您正在使用 WebForms（依赖于 JS），但我认为这值得一提。

并且为了记录，可访问性问题主要是胡扯。我以为我知道可访问性，直到我真正与视障程序员（100% 失明）一起工作。然后，我了解到 JS 工作得很好（假设他们知道要寻找新内容......）并且他们只是从一个链接到另一个链接跳过页面，直到他们找到他们想要的。并且基于表格的布局并没有减慢 1 秒钟的速度。在对 CSS 进行了几年令人难以忍受的宣讲之后，这真是一颗难以下咽的药丸……

# javascript - 即使表格切换为不可见，滚动时也会出现粘性标题

> ID：15207111
> 
> 赞同：0
> 
> 时间：2013-03-04T17:13:58.900
> 
> 标签：javascript, jquery, html, header, tablesorter

我是一名菜鸟程序员，对表格有一些问题，该表格最终将成为网站的一部分，该网站将包括其他图形以及表格。为了避免视觉混乱的可能性，我希望用户能够打开或关闭表格（它显示来自名为“testdatastickyheadersissue.csv”的外部 CSV 文件的数据）。当表格打开时，用户应该能够对表格进行排序并在向下滚动页面时看到粘性标题。下面的代码使用了 tablesorter 插件和它的几个小部件，对所有这些功能都很有效，除了当表格关闭时，粘性标题不会与表格的其余部分一起禁用，所以粘性标题仍然显示向下滚动页面时，即使表格的其余部分不可见。关闭表格时如何隐藏粘性标题？我敢肯定，这可能有一个简单的解决方法，但我很难过，希望能得到任何帮助。谢谢！

```
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
  <meta http-equiv="expires" content="0"> 
<meta name="generator" content="CoffeeCup HTML Editor (www.coffeecup.com)">
<meta name="dcterms.created" content="Thu, 14 Feb 2013 20:13:32 GMT">
<meta name="description" content="">
<meta name="keywords" content="">

<title>Test</title>

<style type="text/css">

 a {
   font-family:arial;
background-color: #FFFFFF;
margin:10px 0pt 15px;
font-size: 10pt;
width: 100%;
text-align: left;
position:absolute;
top:1px;
left:1px}

/* CSS from 'style.css' - tables */
table.tablesorter {
font-family:arial;
background-color: #CDCDCD;
margin:10px 0pt 15px;
font-size: 8pt;
width: 100%;
text-align: left;
position:absolute;
top:25px;
left:1px;
}
table.tablesorter thead tr th, table.tablesorter tfoot tr th {
background-color: #e6EEEE;
border: 1px solid #FFF;
font-size: 8pt;
padding: 4px;
}

table.tablesorter thead tr .header {
background-image: url(bg.gif);
background-repeat: no-repeat;
background-position: center right;
cursor: pointer;
background-color: #3182BD;
}

table.tablesorter tbody td {
color: #3D3D3D;
padding: 4px;
background-color: #FFF;
vertical-align: top;
}

table.tablesorter tbody tr.odd td {
background-color:#F0F0F6;
}
table.tablesorter thead tr .headerSortUp {
background-image: url(asc.gif);
background-color: #9ECAE1;
}

table.tablesorter td.primary,
table.tablesorter tr.odd td.primary {
background-color: #99b3e6;
}
table.tablesorter tr.even td.primary {
background-color: #c2d1f0;
}

table.tablesorter td.secondary,
table.tablesorter tr.odd td.secondary {
background-color: #c2d1f0;
}
table.tablesorter tr.even td.secondary {
background-color: #d6e0f5;
}

table.tablesorter td.tertiary,
table.tablesorter tr.odd td.tertiary {
background-color: #d6e0f5;
}
table.tablesorter tr.even td.tertiary {
background-color: #ebf0fa;
}

/*table tr:hover {
background: #fff;
color: #ccc;
}*/

/*table tr:nth-child(even) {
background: #f0f8ff;
}

table th {
  background: #9ECAE1;
  }

table {
  border-width:0px;
  border-style:solid;
  border-color:black;
  position:absolute;
  top:5px;
  left:5px;
}*/

</style>

</head>

<body>

<script type="text/javascript" src="jquery-1.9.1.min.js"></script> 
<script type="text/javascript" src="jquery.csvToTable.js"></script>
<script type="text/javascript" src="jquery.tablesorter.min.js"></script>
<script type="text/javascript" src="jquery.tablesorter.widgets.js"></script>
<table id="CSVTable" class="tablesorter" style="display: none; visibility: hidden;">   </table>
<script>

$('#CSVTable').CSVToTable('testdatastickyheadersissue.csv', {
loadingImage: 'loading.gif', 
startLine: 1,
headers: ['id', 'name', 'pop11']
}).bind("loadComplete",function() { 
$(document).find('#CSVTable').tablesorter({
    headerTemplate : '{content}{icon}',
    widgets : ['zebra', 'stickyHeaders', 'columns'], // include the widgets
    widgetOptions : {
    stickyHeaders : 'tablesorter-stickyHeader',
  // change the default column class names
  // primary is the first column sorted, secondary is the second, etc
  columns : ['primary', 'secondary', 'tertiary']
  // include thead when adding class names
  /*columns_thead : true,
  // include tfoot when adding class names
  columns_tfoot : true*/
}

});
});

function toggle() {
var ele = document.getElementById("CSVTable");
var text = document.getElementById("displayText");
if(ele.style.display == "block") {
        ele.style.display = "none";
    text.innerHTML = "Show data table for counties";
}
else {
    ele.style.display = "block";
    text.innerHTML = "Hide data table for counties";
}
} 

function toggleVisibility() {
 document.getElementById("CSVTable").style.display = "";
 if(document.getElementById("CSVTable").style.visibility == "hidden" ) {
 document.getElementById("CSVTable").style.visibility = "visible";
 }
 else {
 document.getElementById("CSVTable").style.visibility = "hidden";
 }
} 

</script>  
<a href="javascript:toggleVisibility();">Click here to display/hide data table for counties.</a>
</body>
</html> 
```

外部测试 CSV 文件的内容：

```
id,name,pop11
1,A,1000
2,B,2000
3,C,3000
4,D,4000
5,E,5000
6,F,6000
7,G,7000
8,H,8000
9,I,9000
10,J,10000
11,K,11000
12,L,12000
13,M,13000
14,N,14000
15,O,15000
16,P,16000
17,Q,17000
18,R,18000
19,S,19000
20,T,20000
21,U,21000
22,V,22000
23,W,23000
24,X,24000
25,Y,25000
26,Z,26000
27,AA,27000
28,BB,28000
29,CC,29000
30,DD,30000
31,EE,31000
32,FF,32000
33,GG,33000
34,HH,34000
35,II,35000
36,JJ,36000
37,KK,37000
38,LL,38000
39,MM,39000
40,NN,40000
41,OO,41000
42,PP,42000
43,QQ,43000
44,RR,44000
45,SS,45000
46,TT,46000
47,UU,47000
48,VV,48000
49,WW,49000
50,XX,50000
51,YY,51000
52,ZZ,52000
53,AAA,53000
54,BBB,54000
55,CCC,55000
56,DDD,56000
57,EEE,57000
58,FFF,58000
59,GGG,59000
60,HHH,60000
61,III,61000
62,JJJ,62000
63,KKK,63000
64,LLL,64000
65,MMM,65000
66,NNN,66000
67,OOO,67000
68,PPP,68000
69,QQQ,69000
70,RRR,70000
71,SSS,71000
72,TTT,72000
73,UUU,73000
74,VVV,74000
75,WWW,75000
76,XXX,76000
77,YYY,77000
78,ZZZ,78000 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T05:37:32.313

我似乎无法复制您所描述的问题...[演示](http://jsfiddle.net/Mottie/abkNM/473/)）

实际上，使用隐藏表格`visiblilty: hidden`会导致这种情况，但看起来表格被隐藏了`display: none`and `visibility: hidden`。

由于您使用的是 tablesorter，一个 jQuery 插件，我将修改您用来隐藏表格以使用 jQuery 的代码：

HTML

```
<a href="#" class="toggle">Click here to display/hide data table for counties.</a> 
```

脚本

```
jQuery(function($){
  $('.toggle').click(function(){
    var isHidden = $('#CSVTable').toggle().is(':hidden');
    $('#displayText').html( (isHidden ? 'Show' : 'Hide') + ' data table for counties');
    return false;
  });
}); 
```

# c - 使用注释在代码之间交换

> ID：15207114
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:14:08.763
> 
> 标签：c, comments

我想出了一种快速的方法，可以使用注释在代码的两个变体之间进行交换以进行快速测试：

```
doSomeNormalCode();
findAnObject()
//*/
.doA()
/*/
.doB()
//*/
;
additionalNormalCode(); 
```

这调用`findAnObject().doA();` 只需删除和`/`之间的第一次交换。这可以通过添加更多行来扩展：`.doA()``.doB()``/*/`

```
doSomeNormalCode();
findAnObject()
//*/
.doA()
/*/
.doB()
/*/
.doC()
/*/
.doD()
/*/
.doE()
//*/
;
additionalNormalCode(); 
```

这执行`findAnObject().doA().doC().doE();` 您可以将 any`/*/`转换为 a`//*/`以切换它下面的所有行。所以添加`/`之前`.doB()`会将其更改为`findAnObject().doA().doB().doD().doF();`

这当然是非常复杂的。我已经习惯了，它对我来说很快。我*从不*将它保存在提交的代码中，只是为了在选项之间快速交换测试。

除了注释掉一个部分并取消注释另一部分之外，有没有一种更简单的方法可以在各种选项之间*快速*切换，如果注释掉的代码中有 /**/ 注释，这可能会很麻烦，要求每一行都以`//`.

我显然在这里指的是 C 风格的注释，但我也对其他语言感兴趣。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T17:16:34.780

怎么样

```
#if 0
  doA()
#else
  doB()
#endif 
```

只需将 0 切换为 1 即可。或者使用定义，一旦你有两个以上的选项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:16:25.480

`#define`和`#ifdef`, `#ifndef`,`#else`很好地解决了这个问题。

例如。

```
#ifdef DEFA
doA();
#endif

#ifdef DEFB
doB();
#endif 
```

在大多数编译器中，您可以在命令行中传递#define 以在选项之间切换。

例如，在 Visual C++ 中，您可以编译为

`cl /DDEFA a.c`

或者

`cl /DDEFB a.c`

或者

`cl /DDEFA /DDEFB a.c`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:22:29.637

这是第一个答案的示例

```
#define DOB

#ifdef DOA
doA()
#elif DOB
doB()
#elif DOC
doC()
#endif 
```

# html - 尝试将鼠标悬停在 HTML 子菜单上时消失

> ID：15207117
> 
> 赞同：2
> 
> 时间：2013-03-04T17:14:29.173
> 
> 标签：html, css

我创建了一个包含子菜单的 HTML 菜单，但是当我将鼠标悬停在主菜单上并显示子菜单时，我无法访问它。在我向下移动鼠标导航到它之前，它就消失了。我不知道我做错了什么，也许有人可以用我的代码来帮忙。谢谢

```
#header ul { position: absolute; top: 88px; left: 0; }
#header ul li { display: inline;}
#header ul li a { font-size: 11px; text-decoration: none; text-transform: uppercase; margin-right: 20px; color: #fff; line-height: 2em;}
#header ul li ul{ position: static;display: none; z-index: 999;top:150%;}
#header ul li:hover a { font-weight:bold; color: #000000}
#header ul li:hover ul { display: block; position:absolute;} 
```

**编辑以显示 HTML**

```
 <ul>
                <li><a href="/Default.aspx">Home</a>              
                </li>
                <li>
                    <a href="/Cover/HRMS.aspx">HRMS</a>
                    <ul>
                    <li>
                    <a href="/Cover/HRMS.aspx">Position</a>
                    </li>
                    <li>
                    <a href="/Cover/HRMS.aspx">COA</a>
                    </li>
                    <li>
                    <a href="/Cover/HRMS.aspx">Employee</a>
                    </li>
                    <li>
                    <a href="/Cover/HRMS.aspx">Estate</a>
                    </li>
                    </ul>
                </li>
                <li>
                    <a href="/Cover/EmployeeMaintenance.aspx">Employee Maintenance</a>
                </li>
                <li>
                <a href="/Cover/Payroll.aspx">Payroll</a>
                </li>
                <li>
                <a href="/Cover/DataTransfer.aspx">Data Transfer</a>
                </li>
                <li>
                <a href="/Cover/Reports.aspx">Reports</a>
                </li>
                <li>
                <a href="/Cover/Administration.aspx">Administration</a>
                </li>
                <li>
                <a href="/Cover/Help.aspx">Help</a>
                </li>
              </ul> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:34:50.260

问题是主要和孩子之间的脱节`<ul>`。

以你的风格`ul li ul { position: static;display: none; z-index: 999;top:150%;}`

创建断开连接（因此当您将鼠标悬停在至时，您将鼠标`top:150%;`悬停在任何内容上而不是点击子菜单的 `:hover`逻辑）。您可以尝试改用：`ul li``ul li ul``padding-top`

`ul li ul{ position: static;display: none; z-index: 999; padding-top:10px;}`

编辑：[这](http://www.cssnewbie.com/example/css-dropdown-menu/)是您可以查看的工作导航菜单示例。

编辑 2：看起来它适用于 Firefox 和 Chrome，但不适用于 IE。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:48:02.263

您将需要一个直接子选择器，位于以下位置：

`li:hover > ul { display: block; (...) }`

这意味着当它的直接父级悬停在`<ul>`列表中时，将显示列表中的子级。`<li>`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:07:40.857

我用葡萄牙语写了一篇关于下拉菜单的文章，但我想它会帮助你使用谷歌翻译或类似的东西。

看看：[http ://www.linhadecodigo.com.br/artigo/3474/menu-em-css-menu-dropdown-horizo​​ntal-com-html5-e-css3.aspx](http://www.linhadecodigo.com.br/artigo/3474/menu-em-css-menu-dropdown-horizontal-com-html5-e-css3.aspx)

# mysql - 如何从一个表返回所有行并从另一个表返回值，如果不存在则返回 0？

> ID：15207118
> 
> 赞同：0
> 
> 时间：2013-03-04T17:14:30.000
> 
> 标签：mysql

我的数据库中有两个表：

表 1：采购项目

```
Item | Qnt | Rate |Total
Meat | 1   | 20   | 20
Fish | 0.5 | 30   | 15
Chicken|1  | 25   | 25
Meat | 2   | 20   | 40

Table2: Trading Price
Item |      Datetime       | Price
Meat | 2013-02-20 10:00:00 | 20
Meat | 2013-02-20 09:00:00 | 18
Meat | 2013-02-19 08:00:00 | 21
Fish | 2013-02-19 09:00:00 | 15
Fish | 2013-02-19 08:00:00 | 17
Chicken|2013-02-20 09:00:00|26
Chicken|2013-02-20 08:00:00|25 
```

表 1 列出了已购买的项目，表 2 每小时更新每个项目的当前价格。因此，从表 2 中可以清楚地看出，Meat 最后一次交易是在 2013 年 2 月 20 日上午 10 点，而鱼不是在同一天交易，它是在 2013 年 2 月 19 日上午 9 点交易的，而鸡肉是在 2013 年 2 月 9 日上午交易的2013 年 2 月 20 日上午 9 点。我想要做的是，列出表 1 中的所有项目，并加入表 2 中各个项目的最后交易价格，如下所示：

```
Output:
Item | Qty | Total | Last Trade Price
Meat | 1   | 20    | 20
Meat | 2   | 40    | 20
Fish | 0.5 |15     | 15
Chicken|1  |25     |26 
```

在这里应该应用什么类型的连接和什么子句来获得理想的输出？我试过这个查询： SELECT p.Item, p.Qnt l.price FROM Table1 as p INNER JOIN Table2 as l ON p.Item=l.Item WHERE l.Datetime=(SELECT max(Datetime) FROM Table2); 但是通过这个查询，我没有找到所需的结果，因为每个项目的最大日期时间都不相同，这就是输出中缺少项目的原因。

那么在 WHERE 子句中应该应用什么连接类型和什么条件来获得上述输出呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:28:06.480

试试这个查询：

```
SELECT p.Item, p.Qnt, LatestPriceTable.price FROM Table1 as p 

INNER JOIN

(SELECT Table2.Item, Table2.Price FROM Table2 INNER JOIN
(SELECT Item, MAX(DateTime) FROM Table2
GROUP BY Item) AS A ON Table2.Item = A.Item) AS LatestPriceTable

ON p.Item=LatestPriceTable.Item 
```

最里面的查询将为每个查询`SELECT Item, MAX(DateTime) FROM Table2 GROUP BY Item`输出最新的。我们将此结果称为 A。现在我们将 A 与 Table2 连接起来，以获取这些最新日期的列值。生成的表称为LatestPriceTable，将仅包含项目名称和最新价格。现在您可以简单地将它与 Table1 连接起来进行计算。`DateTime``Item``Price`

我确实有一种感觉，您设计的系统可能不足以实现您想要实现的目标。它是一种库存类型的应用程序吗？我看到的问题是您总是将当前库存数量与最新市场价格相乘。实际上，库存几乎总是包含在不同日期以不同价格进行的购买。

但话又说回来，我不确定你的确切目的，所以也许你可以忍受你正在做的事情。

# php - 如何使用 PHP 顺序重命名文件夹中的文件？

> ID：15207129
> 
> 赞同：1
> 
> 时间：2013-03-04T17:14:53.920
> 
> 标签：php

我在一个名为“thumbs”的文件夹中有文件。它们的名称基于其原始作者的命名/重命名方式。我想将它们按顺序重命名为两位数，我设法找到了这个 PHP 代码：

```
function sequentialImages($path, $sort=false) {
 $i = 1;
 $files = glob($path."/{*.gif,*.jpg,*.jpeg,*.png}",GLOB_BRACE|GLOB_NOSORT);

 if ( $sort !== false ) {
  usort($files, $sort);
 }

 $count = count($files);
 foreach ( $files as $file ) {
  $newname = str_pad($i, strlen($count)+1, '0', STR_PAD_LEFT);
  $ext = substr(strrchr($file, '.'), 1);
  $newname = $path.'/'.$newname.'.'.$ext;
  if ( $file != $newname ) {
   rename($file, $newname);  
  }
  $i++;
 }
} 
```

执行此代码的 php 称为“rename.php”，它位于名为“admin”的文件夹中。

因此它们如下

1.  'admin' 文件夹（包含 rename.php'）
2.  'thumbs' 文件夹（包含随机名称的图像）

两个文件夹位于同一级别。

如果两者都在不同的文件夹中，我该如何执行“rename.php”。

我试图包含`$path = '../thumbs';`，但它不起作用。

请问为什么不工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:46:09.730

我想我会首先检查您是否真的收到任何错误报告。由于您说您只会得到一个没有任何错误的空白页面，因此它可以像启用错误报告以查看实际出了什么问题一样简单。

例如，如果 PHP 没有对 thumbs 文件夹的写入权限，那么当您尝试重命名文件时，您可能会收到一堆警告。检查您的 php.ini 并确保`display_errors = On`再次运行该脚本并检查您是否收到任何有用的错误消息。

不确定这是否对您有帮助（或者是否`display_errors`已经设置为开启），但这将是我尝试的第一步，希望能为您提供有关问题所在的更多详细信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:33:24.317

```
$path = realpath(__DIR__ . '/..') . '/thumbs'; 
```

realpath() 函数： http: [//php.net/manual/en/function.realpath.php](http://php.net/manual/en/function.realpath.php)

**DIR**（和其他魔术常量）： http: [//php.net/manual/en/language.constants.predefined.php](http://php.net/manual/en/language.constants.predefined.php)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:24:16.493

在函数顶部添加：

```
if( !is_dir($path) ) {
  die("error: $path is not a valid directory.");
  // or whatever error handling method you prefer
} 
```

如果由于某种原因，您的服务器上禁用了父路径，或者路径存在其他问题，您将在此处收到通知。

如果一切正常，那么单步执行您的代码并确保一切都符合您的预期。例如：`$files`具有您期望的内容，`$newname`格式正确，`rename()`未返回`false`，这表明可能由于权限等原因导致错误...

# javascript - HighCharts - 带有滚动导航器的 HightStock 倒轴

> ID：15207133
> 
> 赞同：1
> 
> 时间：2013-03-04T17:15:00.080
> 
> 标签：javascript, graph, highcharts

我正在尝试使用**Highcharts**工具来显示一些包含大量数据和系列比较的图表。

我需要的图形之王正是[这个例子](http://www.highcharts.com/stock/demo/compare)中给出的那个。

除了我的必须垂直显示（时间线在y轴上，从上到下，值在x轴上）

就像“样条倒置”示例（[参见此处](http://www.highcharts.com/demo/spline-inverted)）所示，例如显示与高度相关的数据非常有用。

我可以很容易地想象反转值和交换轴图例，但我认为时间线导航器不会跟随......

我还尝试将图形设置为倒置，就像在“带倒轴的样条曲线”示例中一样：

```
chart = new Highcharts.StockChart({
           chart: {
               renderTo: 'container',
               inverted: true
           },
... 
```

但它没有用。

有没有办法用 y 轴上的时间线导航器垂直显示完全相同的图形？

编辑：似乎不可能在 HighStock 图上使用反转（[如文档中所见](http://api.highcharts.com/highstock#chart)），所以我调整了我的问题：我们可以使用 HighCharts 反转图来显示 HighStock 图表中的点数吗？（即使我们不会在 y 轴上获得任何滚动导航器）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T10:25:13.953

Highstock 不支持倒排图表，参见：[http ://api.highcharts.com/highstock#chart](http://api.highcharts.com/highstock#chart)

编辑：可以将倒置的 Highcharts 与 dataGrouping 一起使用，它当然需要文件中的 Highstock，但只需使用 Highcharts.Chart() 创建图表。不要忘记从 Highstock 启用 dataGrouping。参见示例：http: [//jsfiddle.net/PATyv/2/](http://jsfiddle.net/PATyv/2/)

代码：

```
 window.chart = new Highcharts.Chart({
        chart: {
            renderTo: 'container',
            inverted: true
        },
        title: {
            text: 'USD to EUR exchange rate'
        },
        tooltip: {
            style: {
                width: '200px'
            },
            valueDecimals: 4
        },
        yAxis: {
            title: {
                text: 'Exchange rate'
            }
        },
        xAxis: {
            type: 'datetime'
        },
        series: [{
            name: 'USD to EUR',
            data: data,
            id: 'dataseries',
            dataGrouping: {
                enabled: true
            }
        }]
    }); 
```

# django - 在使用 django 视图响应之前等待 celery 任务完成

> ID：15207134
> 
> 赞同：4
> 
> 时间：2013-03-04T17:15:02.180
> 
> 标签：django, django-views, celery, django-celery

我正在尝试使用 celery 尽可能提高浏览器响应时间。我正在处理这个工作流程问题。

1.  用户进入第一页，输入数据。
2.  View 启动一个 celery 任务，然后用第二页响应。
3.  用户在第二页输入数据。
4.  视图以第三页响应，这需要完成由第 1 页视图响应启动的任务。

所以在视图可以响应第 3 页的请求之前，它需要检查 celery 任务是否完成。

我目前的想法通过这个模型起作用：

```
class CeleryTaskmeta(models.Model): # found using python manage.py inspectdb
    task_id = models.CharField(max_length=255, unique=True)
    status = models.CharField(max_length=150)
    result = models.TextField(blank=True)
    date_done = models.DateTimeField()
    traceback = models.TextField(blank=True)
    hidden = models.IntegerField()
    meta = models.TextField(blank=True)

    class Meta:
        db_table = u'celery_taskmeta' 
```

它会工作吗/存储`celerytaskmeta_id`. 然后当用户请求第 3 页时，我将使用以下内容开始视图：

```
def SomeView(request):
    result = CeleryTaskmeta(id = celerytaskmeta_id)
    result.get()
    rest of SomeView ... 
```

从主题上讲，是不是用芹菜来开始一个冗长的任务，做一些其他的事情，然后在完成冗长的任务后继续？

# actionscript-3 - 将 AS2 与 AS3 连接时出错

> ID：15207135
> 
> 赞同：0
> 
> 时间：2013-03-04T17:15:06.813
> 
> 标签：actionscript-3, actionscript-2

我在将两个脚本合二为一时遇到问题。

[这是脚本的主要部分：AS3。](http://pastebin.com/XCV7YLbi)

[这已经是加入脚本了。](http://pastebin.com/Rx8vYzK0)

这是我需要导入的部分代码（AS2）：

```
stop();
var banners:Array = new Array();
var imagePaths:Array = new Array();
var links:Array = new Array();
var bodyTexts:Array = new Array();
var imageTime:Number;
var numberOfBanners:Number;
var isRandom:String;
var showHeader:String;
var bannersXML:XML = new XML();
bannersXML.ignoreWhite = true;
bannersXML.load("banners.xml");
bannersXML.onLoad = function(success) {
    if (success) {
        trace("XML LOADED");
        imageTime = parseInt(this.firstChild.firstChild.firstChild)*1000;
        numberOfBanners = parseInt(this.firstChild.childNodes[1].firstChild);
        isRandom = this.firstChild.attributes["isRandom"];
        showHeader = this.firstChild.childNodes[2].attributes["showHeader"];

        var bannerSequence:Array = new Array();
        if (isRandom == "true") {
            //Make a random sequence
            while (bannerSequence.length<numberOfBanners) {
                newRandomNumber = random(numberOfBanners);
                //Make sure that the random one chosen is not already chosen
                for (var i = 0; i<=bannerSequence.length; i++) {
                    if (newRandomNumber != bannerSequence[i]) {
                        alreadyThere = false;
                    } else {
                        alreadyThere = true;
                        break;
                    }
                }
                //Add only random values that aren't in the array
                if (!alreadyThere) {
                    bannerSequence.push(newRandomNumber);
                }
            }
        } else {
            for (var i = 0; i<numberOfBanners; i++) {
                bannerSequence.push(i);
            }
        }
    }

    //Read XML in the Random Order Chosen
    for (var i = 0; i<numberOfBanners; i++) {
        banners.push(this.firstChild.childNodes[2].childNodes[bannerSequence[i]].firstChild.firstChild.toString());
        bodyTexts.push(this.firstChild.childNodes[2].childNodes[bannerSequence[i]].childNodes[1].firstChild.nodeValue);
        imagePaths.push(this.firstChild.childNodes[2].childNodes[bannerSequence[i]].childNodes[2].firstChild.nodeValue);
        links.push(this.firstChild.childNodes[2].childNodes[bannerSequence[i]].childNodes[3].firstChild.nodeValue);
    }
    play();
};
//Start the image counter at 0
var imageCounter = 0; 
```

我在这部分代码中遇到错误

```
function doRandArray(a:Array):Array {//make random array
 var nLen:Number = a.length;
 var aRand:Array = a.slice();
 var nRand:Number;
 var oTemp:Object;
 for (var i:Number = 0; i < nLen; i++) {
  oTemp = aRand[i];
  nRand = i + (random(nLen – i));
  aRand[i] = aRand[nRand];
  aRand[nRand] = oTemp;
 }
 return aRand;
} 
```

当我运行它时，我在这个地方得到一个错误：

```
nRand = i + (random(nLen – i));
Scene 1, Layer 'Layer 1', Frame 1, Line 265 1084: Syntax error: expecting rightparen before i. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T23:24:29.353

as2`random(random(nLen – i));`生成 0,1,...nLen-i-1。不只浮动 int 值。

正确的 as3 代码是`int(Math.random()*(nLen-i));`或`Math.floor(Math.random()*(nLen-i));`

as2：[随机（）](http://help.adobe.com/en_US/as2/reference/flashlite/WS5b3ccc516d4fbf351e63e3d118cd9b5f6e-7a36.html)

as3: [Math.random()](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Math.html#random%28%29)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-03-04T17:28:51.690

在**ActionScript 3**中，[随机](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/Math.html#random%28%29)函数与在 as2 代码中的函数有点不同，只需将有问题的行更改为：

```
nRand = i + Math.random()*(nLen-1); 
```

这应该可以修复所有错误并正常工作。

编辑：正如@bitmapdata.com 所指出的，为了使其与 as2 中的运行相同，必须截断随机值（去除其十进制值）。除了他建议的几种可能性之外，我个人只会在声明时将 nRand 的类型更改为 uint：

```
var nRand:uint; 
```

您还可以将迭代器类型更改为`var i:uint`. 更少的内存使用总是好的；）

# memory - 执行“.exe”文件时出现环境空间不足

> ID：15207136
> 
> 赞同：0
> 
> 时间：2013-03-04T17:15:10.200
> 
> 标签：memory, windows-7, console, dos, clipper

我正在尝试使用一个名为的应用程序`CLUT.exe`，它是一个旧应用程序`MS-DOS`，可用于为数据库重新索引`NTX`文件。`DBF`

（这不是主要话题，但如果有人想测试应用程序并且完全不信任内容，我只是在写这个）。

尝试通过控制台 ( `cmd.exe`) 运行命令行版本时问题开始出现，并出现此错误：

```
C:\>CLUT.exe [arg1] [arg2] [arg3]

run-time error R6009
- not enough space for environment 
```

因此，根据我的搜索，这可能是一个可能的解决方案：

[http://support.microsoft.com/default.aspx?scid=kb;en-us;230205](http://support.microsoft.com/default.aspx?scid=kb;en-us;230205)

但它不起作用，我发现通过互联网解决这个问题的所有替代方法都是一样的。

另一种选择是在**.exe文件中****单击鼠标右键**，转到“**属性**”然后**“内存”**选项卡，并将“**初始环境内存**”从**“自动”**增加到**最大值**，但它也不起作用。

 ******* * *

好吧，我被困住了，没有“可能的”解决方案对我有用。如果有人对此问题感兴趣，了解更多并想测试，您可以从这里下载应用程序*（单击“免费下载”绿色按钮）*：

[http://www.filebasket.com/free/Development-Clipper-programming-language/clut-exe/13996.html](http://www.filebasket.com/free/Development-Clipper-programming-language/clut-exe/13996.html)

或直接从我的 DropBox：

[https://dl.dropbox.com/u/15208254/stackoverflow/clut_214.rar](https://dl.dropbox.com/u/15208254/stackoverflow/clut_214.rar)

* * *

只是要知道，我正在使用`Windows 7`并且该`CLUT.exe`应用程序是一个`Clipper`基于应用程序（旧编程语言），可以在 Windows 控制台（`cmd.exe`）下运行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T08:00:44.063

维基百科确实提到了其他[dos 模拟器](http://en.wikipedia.org/wiki/Category%3aDOS_emulators)，但奇怪的是，没有提到[BOCHS](http://bochs.sourceforge.net/)。

重新索引 NTX 文件并不是一件难事，可以使用 CLUT 以外的工具来完成。例如，可以使用[Download32这一部分中列出的许多实用程序。](http://www.download32.com/ntx-reindex-software.html)[否则，您可以使用Harbor Project](http://harbour.github.io/)或[xHarbour](http://www.xharbour.org/)编写自己的代码。或者联系我，我会在 Clipper 5.3 中做点什么。

**之后**

如果我正确阅读了 CLUT 的 README，它可以替代 Clipper 5.x 附带的 DBU 实用程序。如果您使用其他方法不成功，我可以为您提供一个构建。******

# ios - 创建新的 xcode 项目时找不到基于 phonegap 的项目模板

> ID：15207137
> 
> 赞同：1
> 
> 时间：2013-03-04T17:15:12.490
> 
> 标签：ios, cordova

我必须使用 phonegap 1.5 继续现有的 phoengap 应用程序。但是当我在我的 xcode 4.5.2 中安装 phonegap 时，我没有得到任何“基于Phonegap 的项目”的选项。我确定我有 ios SDK 和其他所需的一切，但不知道这里有什么问题。在同一个问题上卡了几个星期，没有输出。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:45:57.707

在最新版本的PhoneGap 中，XCode 中没有可用的模板。您需要使用命令行来创建一个新项目。此链接告诉如何做到这一点： http: [//docs.phonegap.com/en/2.5.0/guide_getting-started_ios_index.md.html#Getting%20Started%20with%20iOS](http://docs.phonegap.com/en/2.5.0/guide_getting-started_ios_index.md.html#Getting%20Started%20with%20iOS)

检查**项目创建**部分。

# node.js - 使用 npm 安装 Geddy

> ID：15207140
> 
> 赞同：0
> 
> 时间：2013-03-04T17:15:22.330
> 
> 标签：node.js, geddy

当我尝试使用 npm 安装 Geddy 时，出现以下错误：

[http://s15.postimage.org/rwkrcxeuz/geddy.png](http://s15.postimage.org/rwkrcxeuz/geddy.png)

我已经安装了 SDK 和 VS 2008，但仍然安装 Geddy 会出现错误... Geddy 命令目前正在运行，但由于错误，我可能会在以后遇到一些问题。

关于摆脱错误的任何建议？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:42:56.260

尝试[此处给出的选项](https://github.com/TooTallNate/node-gyp/issues/182)

1.  为您的 Windows 版本、.NET Framework 3、Microsoft Visual Studio 2008 安装 Microsoft Windows SDK
2.  设置环境变量 PATH 以包含所需的目录
3.  尝试使用管理员权限安装它

# iis - IIS 时间是什么意思？

> ID：15207141
> 
> 赞同：1
> 
> 时间：2013-03-04T17:15:23.757
> 
> 标签：iis, iis-6

一个简单但谷歌无法帮助解决的问题。在 IIS 日志记录中，字段`time`. 这是 IIS 收到请求的时间还是它响应的时间？

```
#Software: Microsoft Internet Information Services 6.0
#Version: 1.0
#Date: 2013-03-04 08:32:02
#Fields: date **time** s-sitename s-computername 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:17:10.127

> IIS 高级日志记录使用 W3C 日志文件格式记录有关服务器上所有站点的信息
> 
> **本地时间**
> 
> 以本地时间记录请求发生的时间。
> 
> **时间-UTC**
> 
> 以 UTC 记录请求发生的时间。

[http://technet.microsoft.com/en-us/library/ee791933(v=ws.10).aspx](http://technet.microsoft.com/en-us/library/ee791933(v=ws.10).aspx)

# java - 在没有 Java Preference 应用程序的 Mac OS X 上启用 Java 日志记录

> ID：15207143
> 
> 赞同：1
> 
> 时间：2013-03-04T17:15:43.110
> 
> 标签：java, macos

由于 Apple 已删除 Java Preferences App，我正在寻找一种启用 Java 控制台日志记录的方法。有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:19:00.383

如果您想查看异常等，只需从终端启动您的应用程序。

假设你有一个 jar，语法是

```
java -jar path-to-my-jar.jar 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-19T21:51:50.880

如果是网络应用程序：

在 ~/Library/Application Support/Oracle/Java/Deployment 编辑 deployment.properties 这样

`deployment.console.startup.mode=SHOW`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-07-18T10:28:09.117

没有官方文档，但是如果您从 java.com 网站（重新）安装 java，您将在系统偏好设置中获得 Java 控制面板。

# python - 检测网页是否更改

> ID：15207145
> 
> 赞同：8
> 
> 时间：2013-03-04T17:16:01.140
> 
> 标签：python, web, screen-scraping, if-modified-since

在我的 python 应用程序中，我必须阅读许多网页来收集数据。为了减少 http 调用，我只想获取更改的页面。我的问题是我的代码总是告诉我页面已更改（代码 200），但实际上并非如此。

这是我的代码：

```
from models import mytab
import re
import urllib2
from wsgiref.handlers import format_date_time
from datetime import datetime
from time import mktime

def url_change():
    urls = mytab.objects.all()
    # this is some urls:
    # http://www.venere.com/it/pensioni/venezia/pensione-palazzo-guardi/#reviews
    # http://www.zoover.it/italia/sardegna/cala-gonone/san-francisco/hotel
    # http://www.orbitz.com/hotel/Italy/Venice/Palazzo_Guardi.h161844/#reviews
    # http://it.hotels.com/ho292636/casa-del-miele-susegana-italia/
    # http://www.expedia.it/Venezia-Hotel-Palazzo-Guardi.h1040663.Hotel-Information#reviews
    # ...

    for url in urls:
        request = urllib2.Request(url.url)
        if url.last_date == None:
            now = datetime.now()
            stamp = mktime(now.timetuple())
            url.last_date = format_date_time(stamp)
            url.save()

        request.add_header("If-Modified-Since", url.last_date)

        try:
            response = urllib2.urlopen(request) # Make the request
            # some actions
            now = datetime.now()
            stamp = mktime(now.timetuple())
            url.last_date = format_date_time(stamp)
            url.save()
        except urllib2.HTTPError, err:
            if err.code == 304:
                print "nothing...."
            else:
                print "Error code:", err.code 
                pass 
```

我不明白出了什么问题。谁能帮我？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:26:33.270

当您发送“If-Modified-Since”标头时，Web 服务器不需要发送 304 标头作为响应。他们可以随意发送 HTTP 200 并再次发送整个页面。

发送 'If-Modified-Since' 或 'If-None-Since' 会提醒服务器您想要缓存的响应（如果可用）。这就像发送一个“Accept-Encoding: gzip, deflate”标头——你只是告诉服务器你会接受一些东西，而不是要求它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-04T14:13:00.010

检查网站是否返回 304 的一个好方法是使用 google chrome 开发工具。例如，下面是在 bls 网站上使用 chrome 的带注释示例。继续刷新，你会看到服务器一直返回 304。如果你用 Ctrl+F5（windows）强制刷新，你会看到它返回状态码 200。

您可以在示例中使用此技术来确定服务器是否不返回 304，或者您是否以某种方式错误地格式化了请求标头。有时网页上导入了不尊重 If- 标头的资源，因此无论您做什么它都会返回 200（如果页面上的任何资源不返回 304，则整个页面将返回 200），但有时您是只查看网站的特定部分，您可以通过直接加载资源并绕过整个文档来作弊。

[![](../Images/37f4d1ceee5bf8a02383d758315bdadb.png)](https://i.stack.imgur.com/PpouQ.png)

# matlab - 从mathematica到matlab的转换

> ID：15207147
> 
> 赞同：0
> 
> 时间：2013-03-04T17:16:14.577
> 
> 标签：matlab, wolfram-mathematica

我在 Mathematica 中有以下代码，需要将其转换为 Matlab，但我一生都无法理解如何做到这一点，尽管我认为我需要使用`fzero`; 命令。请问有人可以帮助我或给我一个提示吗？

函数`f`已经定义，但我需要找到它的根源，变量`a`来自 0-0.6 等。

```
list1 = For[a=-0.01, a<0.6, a+=0.01; sol=Findroot[f,{u, 1.00,1.10}];
v1[i] = sol[[1,2]]; i++] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:32:10.543

阅读 Matlab 的文档，我猜你想要的类似于：

> 要找到函数的零`f(x) = x3 – 2x – 5`，请编写一个匿名函数`f`：
> 
> `f = @(x)x.^3-2*x-5`;

所以：

```
i = 1;
for a = -0.01:0.01:0.6
    f = @(x)x.^3-2*x-a;
    sol = fzero(f,1.0);
    v[i] = sol(something); %depending on which solution you are interested in
    i = i+1;
end 
```

# java - Android 开发：将参数传递到 onClickListener()

> ID：15207148
> 
> 赞同：0
> 
> 时间：2013-03-04T17:16:14.990
> 
> 标签：java, android, onclicklistener

基本上我在 for 循环中创建按钮，我需要每个按钮在按下时返回不同的值。

我曾认为创建自己的 onClickListener() 并在初始化时将所需的数据作为参数传递是可行的。我想出的内容似乎没有语法错误，但是在运行时单击按钮时，应用程序崩溃。

这是迄今为止我所拥有的简化版本。

```
int counter = 1;
for( Program element :  someList)
    {
    //some other code for dynamically creating textviews to stick the buttons in

    //code which creates the buttons on the fly
    moreInfo = new Button(this);
    moreInfo.setText("More Info");  
    moreInfo.setOnClickListener(new DynamicOnClickListener(counter));
    counter++;

    } 
```

自定义监听器类

```
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Toast;

public class DynamicOnClickListener implements OnClickListener
{

    int counter;
    public DynamicOnClickListener(int acounter) {
         this.counter = acounter;
    }

    public void onClick(View v) {
        Log.v("DynamicOnClickListener","1");
        Toast.makeText(v.getContext(), counter, Toast.LENGTH_LONG).show();
    }

 } 
```

所以理论上如果这有效，每个按钮都会返回一个不同的数字，希望这是有道理的。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:23:15.913

`Toast.makeText`将字符串资源 id 作为第二个参数。您的计数器值不是有效的资源 ID，这是您收到错误的方式。你需要通过 a`String`而不是`int`它会起作用。

```
Toast.makeText(v.getContext(), String.valueOf(counter), Toast.LENGTH_LONG).show(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:30:14.577

您可以使用 setTag() 而不是创建多个侦听器

```
moreInfo = new Button(this);
moreInfo.setText("More Info");
moreInfo.setTag(new Integer(counter));
moreInfo.setOnClickListener(new DynamicOnClickListener(); 
```

然后，在你的听众中

```
public void onClick(View v) {
    Log.v("DynamicOnClickListener","1");
    Toast.makeText(v.getContext(), ((Integer)v.getTag()).toString(), Toast.LENGTH_LONG).show();
} 
```

# java - Java：java.util.date 不能转换为 java.sql.Time

> ID：15207158
> 
> 赞同：2
> 
> 时间：2013-03-04T17:16:28.257
> 
> 标签：java, sql, time, insert

我已经从毫秒转换了时间，现在我想用那个时间值创建一个 SQL 插入。我试过这个，但它不工作：

```
 String INSERT_RECORD ="INSERT INTO PRAVIDLA (CAS,DEN,MIESTNOST,STAV) values(?,?,?,?)";
        PreparedStatement pstmt = con.prepareStatement(INSERT_RECORD);

        Calendar calendar1 = Calendar.getInstance(TimeZone.getTimeZone("UTC"));       
        calendar1.setTimeInMillis(milli);
        Time Cas2 = (Time) calendar1.getTime();

        pstmt.setTime(1, Cas2);
        pstmt.setInt(2, DEN);
        pstmt.setString(3, MIESTNOST);
        pstmt.setString(4, STAV);
        pstmt.executeUpdate(); 
```

请问有什么建议吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T17:20:16.573

`java.sql.Time`extends `java.util.Date`，所以你不能简单地转换它。

你可以尝试这样的事情：

```
Time time = new Time(date.getTime()); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T17:24:38.943

以下是我遇到类似问题时所做的。

```
java.util.Date utilDate = new java.util.Date("mm/dd/yyyy");
java.sql.Date sqlDate = new java.sql.Date(utilDate.getTime()); 
```

用真实日期替换“mm/dd/yyyy”

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:20:12.923

`calendar1.getTime()`返回一个`Date`对象，并且`Time`是 的子类`Date`，因此 a`Date`不能强制转换为 a `Time`。你可以试试这个：

```
Time Cas2 = new Time(calendar1.getTimeInMillis()); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T17:20:26.943

```
public class Time extends java.util.Date 
```

无法转换`Date`为`Time`.

您可以改用它：

```
Time time = new Time(date.getTime()) 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T17:23:57.427

你可以试试这个。我没有测试过代码。

```
Time time = new Time(calendar.get(Calendar.MILLISECOND) 
            + calendar.get(Calendar.ZONE_OFFSET)); 
```

您可能必须减去区域偏移量。

# c# - 从填充到捕捉视觉状态时的首选行为

> ID：15207173
> 
> 赞同：2
> 
> 时间：2013-03-04T17:17:22.953
> 
> 标签：c#, .net, animation, windows-8, visualstates

我目前正在实施一些快照视图，但遇到了一个我找不到答案的问题。也许你美丽的头脑可以帮助我。

当我将我的应用程序从填充状态拖动到捕捉状态时，大约 1 - 1.5 秒的时间段内，旧的“填充”视图仍显示在捕捉的视图空间中。不好看！我想应该在这里应用一个标准行为。我是否显示启动画面？我是否在项目中制作动画（如果是，我应该听什么事件）？

感谢大家的帮助！

编辑：这是我经历过这种滞后的一个观点的一些简化代码 - 搜索结果页面：

```
<Grid x:Name="LayoutRoot">
  <Grid x:Name="FullViewGrid">
    <!-- Two GridViews containing up to 27 items each (not very advanced) -->
  </Grid>
  <Grid x:Name="SnappedViewGrid">
    <!-- Two ListViews doing the same thing, with different item templates -->
  </Grid>
</Grid> 
```

基本上我正在实现我自己的 VS2012 中给出的标准搜索合同模板的旋转。我感觉在 UI 中渲染这些变化时 CPU 压力太大了——这就是为什么事情进展不太顺利的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T21:53:41.920

是的，所以这是你做错了。SnapView 没有这样的延迟。如果您有兴趣，可以查看我的 SnapView 演练：[http ://blog.jerrynixon.com/2012/12/walkthrough-implementing-snapview-in.html](http://blog.jerrynixon.com/2012/12/walkthrough-implementing-snapview-in.html)

如果没有来自您的应用程序的代码示例，这是我现在能提供的最好的。但希望这将是您为 SnapView 走上正确道路所需要的一切。祝你好运！

# javascript - 禁用超时按钮

> ID：15207177
> 
> 赞同：2
> 
> 时间：2013-03-04T17:17:28.077
> 
> 标签：javascript, jquery, html

我有此表单，其中包含在发布数据之前警告验证错误的条件。问题是，如果有人双击（可能是错误的），提交了表单，然后在第一次单击时清除了表单，然后第二次单击将警告“表单为空”，这可能会令人困惑，因为这一切都发生在一瞬间. 所以我想要的是在单击 3 秒时暂时禁用该按钮。但我现在只是将整个功能超时 3 秒，而不仅仅是禁用按钮。我应该怎么做？这是表格的简化版本。谢谢

```
$('#send').click(function(){

   var self = $('#send');
       setTimeout(function() {
       self.disabled = false;
   if(!$('#text').val()){
      alert('field empty');
  }else{
        $('#message').html('done');
        $('#text').val('');
    }
  }, 3000);
}); 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T17:27:40.817

我为你写了一个小例子，在点击时禁用按钮。超时将在 3000 毫秒后启用按钮。

**[工作演示](http://jsfiddle.net/hqftf/2/)**

html:

```
<input id="text">
<input id="send" type="button" value="send"/>
<div id="message"></div> 
```

Javascript：

```
$('#send').click(function(){
    var button = $(this);
    button.attr('disabled', 'disabled');
    setTimeout(function() {
         button.removeAttr('disabled');
    },3000);
    if(!$('#text').val()){
       alert('field empty');
       button.removeAttr('disabled');
    }else{
        $('#message').html('done');
        $('#text').val('');
    }
}); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:23:46.487

您可以使用 jQuery[`one()`](http://api.jquery.com/one/)代替`click()`. 一旦函数运行，它将被解除绑定。
如果要重新启用它，可以将超时重新绑定到函数末尾。

使用您的方法，您似乎从未真正禁用该按钮：

```
this.disabled = 'disabled'; 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T17:24:56.587

您没有正确禁用该按钮。您`.disabled`在 jQuery 对象上设置属性，而不是包装的 DOM 元素。

尝试：

```
self.prop('disabled', false); 
```

代替：

```
self.disabled = false; 
```

编辑：

实际上，上面的代码试图重新启用按钮。没有禁用该按钮的代码。

我还认为您想立即执行验证。调用`setTimeout()`应该只是为了重新启用按钮，如下所示：

```
$('#send').click(function() {
    var self = $(this);

    // Disable the button.
    self.prop('disabled', true);

    // Process click.
    if (!$('#text').val()) {
        alert('field empty');
    } else {
        $('#message').html('done');
        $('#text').val('');
    }

    // Cause the button to re-enable after 3 seconds.
    setTimeout(function() {
        self.prop('disabled', false);
    }, 3000);
}); 
```

# php - mysql左连接不返回连接表中的行

> ID：15207178
> 
> 赞同：0
> 
> 时间：2013-03-04T17:17:29.473
> 
> 标签：php, mysql, yii

我有 2 个相同的表（_impressionsdaily，_impressionsalltime），在每天结束时，我将所有数据从每天移动到所有时间。结构为：ID、purchaseID、impression、unique、date。

我运行以下查询：

```
SELECT  
    daily.purchaseID,
    SUM(daily.impression + IFNULL(alltime.impression, 0)) AS impression,
    SUM(daily.unique + IFNULL(alltime.unique, 0)) AS `unique`
    FROM _impressionsdaily daily
    LEFT JOIN _impressionsalltime alltime ON alltime.purchaseID= daily.purchaseID
    GROUP BY daily.purchaseID; 
```

问题是，如果所有时间表中有日常购买的商品，我将看不到它们。

基本上，这个想法是总结每天和所有时间的所有印象。

---编辑事情是在每天上午12:00，每日表被复制到所有时间，然后被删除。所以给出的解决方案是错误的..

谢谢你的帮助，丹尼

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:28:04.257

我认为您正在寻找[Union Select](http://dev.mysql.com/doc/refman/5.0/en/union.html)。尝试这样的事情：

```
SELECT DISTINCT(p.ID), p.purchaseID
FROM (SELECT *
      FROM _impressionsdaily
      UNION SELECT *
      FROM _impressionsalltime) AS p
GROUP BY p.purchaseID 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:34:57.563

```
SELECT  
daily.purchaseID,
SUM(daily.impression + IFNULL(alltime.impression, 0)) AS impression,
SUM(daily.unique + IFNULL(alltime.unique, 0)) AS `unique`
FROM _impressionsdaily daily
LEFT JOIN _impressionsalltime alltime ON alltime.purchaseID= daily.purchaseID
GROUP BY daily.purchaseID; 
```

在这种情况下，您没有选择 _impressionsalltime 表中的任何字段。

您也可以使用此 sql 从 _impressionsalltime 表中选择字段

```
SELECT  
alltime.*,
daily.purchaseID,
SUM(daily.impression + IFNULL(alltime.impression, 0)) AS impression,
SUM(daily.unique + IFNULL(alltime.unique, 0)) AS `unique`
FROM _impressionsdaily daily
LEFT JOIN _impressionsalltime alltime ON alltime.purchaseID= daily.purchaseID
GROUP BY daily.purchaseID; 
```

# javascript - 如何在输出结果之前单击按钮？

> ID：15207179
> 
> 赞同：0
> 
> 时间：2013-03-04T17:17:29.740
> 
> 标签：javascript

所以有 2 个单选项目，我希望用户选择执行哪一个，用户选择其中一个后，他/她将点击按钮“绘制！” 并将从他们选择的收音机项目的功能之一输出结果。但我不知道如何调用这两个函数并等到用户点击“Draw！” 按钮实际调用该函数。

我的 HTML 中有：

```
<p>
Do you want to <input type="radio" name="draw" id="draw" value="drawTriangle">Draw Triangle
or
<input type="radio" name="draw" id="draw" value="drawZigZag">Draw ZigZag<br>
<input type="button" value="Draw!" onclick="drawEither()">
</p>

<pre id="outputTriangle">
</pre>

<pre id="outputZigZag">
</pre> 
```

和 Javascript：

```
function makeZigZag () {
var sizeTextField = document.getElementById('sizeTextField')
//block of codes
drawButton.onclick = function () {
    outputTri.innerHTML = makeTriangle(sizeTextField.value);
};

}

function makeTriangle () {
var sizeTextField = document.getElementById('sizeTextField')
//block of codes
drawButton.onclick = function () {
    outputZZ.innerHTML = makeTriangle(sizeTextField.value);
};
}

function drawEither () {
outputTri = document.getElementById('outputTriangle');
outputZZ = document.getElementById('outputZigZag');
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:25:39.323

一种方法是循环检查选择了哪个单选按钮。就像是：

```
function drawEither () {
  if (document.getElementById('drawTriangle').checked) {
    do stuff for radio 1
  } else {
    do stuff for radio 2
  }
} 
```

顺便说一句，您的示例 HTML 中有重复的 ID。ID 必须是唯一的。我在示例中使用了建议的 ID。

# sql - T-SQL 相当于 Oracle 的收集方法（第一个、最后一个、下一个）？

> ID：15207181
> 
> 赞同：2
> 
> 时间：2013-03-04T17:17:30.263
> 
> 标签：sql, sql-server, oracle

我们正在从 Oracle 迁移到 SQL Server，并且我正在从填充了 BULK COLLECT INTO 查询的表变量转换查询。我正在考虑使用游标（绝对可以接受其他建议），但是在处理它正在使用的查询的 Oracle 代码中`Table_var.FIRST` `.NEXT`和`.LAST`. 这是一些关于如何使用这些的示例代码。似乎第一个/下一个/最后一个正在为表 var 的记录提供索引。

```
TYPE Pers_DOB_LastInitial IS RECORD (
  Person_ID Person.Person_ID%TYPE,
  DOB Person.Birthdate%TYPE,
  LastInitial VARCHAR2(1)
);

TYPE Dup_Table IS TABLE OF Pers_DOB_LastInitial INDEX BY BINARY_INTEGER;

Dup_Tab Dup_Table; 
```

以及使用这些类型的函数：

```
FUNCTION Last_In_Group( pStart NUMBER, pDOB Person.Birthdate%TYPE, pLastInitial VARCHAR2 )
     RETURN NUMBER IS
  vResult NUMBER;
BEGIN
  IF pStart = Dup_Tab.LAST THEN
     RETURN pStart;
  END IF;

  vResult := pStart;

  FOR vIndex IN pStart .. Dup_Tab.LAST LOOP
     IF Dup_Tab.EXISTS( vIndex ) THEN
        IF Dup_Tab( vIndex ).DOB = pDOB AND Dup_Tab( vIndex ).LastInitial = pLastInitial THEN
           vResult := vIndex;
        ELSE
           EXIT;
        END IF;
     END IF;
  END LOOP;

  RETURN vResult;
END Last_In_Group; 
```

我不需要为我完成编码，只需要指出正确的方向。我正在考虑使用游标，但我唯一熟悉的只是从 T-SQL 中的游标中获取下一条记录，并想看看是否有等效的方法来引用游标（或临时表）的行索引）。

* * *

**编辑**：我刚刚发现了以下内容并正在调查它。绝对愿意接受有关这是否是一条好路径或者游标是否更好的提示。

[http://www.sql-server-performance.com/2004/operations-no-cursors/2/](http://www.sql-server-performance.com/2004/operations-no-cursors/2/)

```
DECLARE @dupTab TABLE (
    person_id numeric(8,0),
    DOB date,
    LastInitial char(1)
)

INSERT @dupTab
SELECT ... 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-04T12:19:58.840

我将您的示例代码翻译成它的 SQL-Server 对应物。如果您想逐行处理，最好的执行方式是 imo 使用 FAST_FORWARD 游标。

代码：

```
 IF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[Last_In_Group]') AND xtype in (N'FN', N'IF', N'TF'))
        drop function  Last_In_Group
    go

    create function Last_In_Group(@pStart  int, @pDOB date, @pLastInitial varchar(1))
    returns int
    AS
    BEGIN
        DECLARE @Dup_Tab TABLE(
            Person_ID int,
            DOB date,
            LastInitial varchar(1)
        )
        -- populate the table with some data
        insert @Dup_Tab values
        (1, '31.12.2013', 'P'), (2, '24.12.2013', 'C'), (3, '24.12.2013', 'C')

        declare @vResult int = 0,
                @cDOB date,
                @cLastInitial varchar(1)

        if(@vResult = @pStart) return @pStart
        set @vResult = @pStart

        -- loop over your data with a fast cursor
        declare cur cursor FAST_FORWARD for select DOB, LastInitial from @Dup_Tab
        open cur
        fetch next from cur
        into @cDOB, @cLastInitial

        while @@FETCH_STATUS = 0
        begin
            if(@cDOB = @pDOB and @cLastInitial = @pLastInitial)
                set @vResult += 1
            fetch next from cur
            into @cDOB, @cLastInitial
        end

        return @vResult;
    end
    go

    print dbo.Last_In_Group(1, '24.12.2013', 'C')
    go 
```

它可能无法作为您上面的示例，但我希望这可以为您提供一些进一步的提示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:56:06.800

假设您的表名为 Dup_Tab，而 @DOB 和 @LastInitial 是您传递给函数的变量，这可行吗？

```
select PersonID from(
select
 rank = row_number() over (order by DOB DESC, LastInitial DESC),
 PersonID
from dup_tab where DOB=@DOB and LastInitial=@LastInitial
) subgroup 
where rank=1 
```

它只是使用窗口化的 Rank() 函数根据 DOB/LastInitial 最后排序为每条记录分配一个行号，然后选择 rank = 1 的行，为您提供具有特定 DOB 的人员集中的最后一条记录和 LastInitial。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:22:56.673

不是 100% 确定您在问什么，但是您是否查看过 Sql Server 2012中新的[LEAD](http://msdn.microsoft.com/en-us/library/hh213125.aspx)、[LAG](http://msdn.microsoft.com/en-us/library/hh231256.aspx)、[FIRST_VALUE](http://msdn.microsoft.com/en-us/library/hh213018.aspx)和[LAST_VALUE关键字？](http://msdn.microsoft.com/en-us/library/hh231517.aspx)

# java - 使用嵌入式 for 循环的 NxN 矩阵

> ID：15207183
> 
> 赞同：0
> 
> 时间：2013-03-04T17:17:37.187
> 
> 标签：java, loops, for-loop, matrix

我正在尝试使用嵌入式 for 循环创建 NxN 矩阵。我想我几乎拥有它，但我觉得我在循环中遗漏了一些东西。假设用户给我 n 并且我根据该输入生成矩阵。

```
public static void printMatrix( int n ){

    for ( int i = 1; i < n; i++ ){
        System.out.println(" "+(int)(Math.random() + 0.5));

        for( int k = 1; k < n+1; k++)
            System.out.print(" "+(int)(Math.random() + 0.5));

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:25:21.960

您只需要在第二个循环中使用 print 语句来打印“矩阵”。IE，

```
public static void printMatrix(int n)
{
    for( int i = 1; i <= n; i++ )
    {
        for( int k = 1; k <= n; k++ )
            System.out.print("\t"+(int)(Math.random() + 0.5));
        System.out.println();
    }
} 
```

实际上，在这里您并没有真正创建矩阵（这意味着您没有将其存储在任何结构中，例如二维数组），而只是打印出`n*n`随机值的数量。

也要这样做，

```
public static void printMatrix(int n)
{
    int[][] yourArray = new int[n][n];
    for( int i = 1; i <= n; i++ )
        for( int k = 1; k <= n; k++ )
            yourArray[i][k] = Math.random() + 0.5; //Populating the array.
    for( int i = 1; i <= n; i++ )
    {
        for( int k = 1; k <= n; k++ )
            System.out.print("\t"+yourArray[i][k]); //Reading data from the array.
        System.out.println();
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:42:50.143

您似乎正在尝试使用第一个`for`循环来控制矩阵中的行数。这是个好主意，但看看你的第一个 for 循环

```
for ( int i = 1; i < n; i++) 
```

会有多少次迭代？

现在似乎您正在尝试使用第二个`for`循环打印一行的所有元素，这也是个好主意。唯一的问题是，在第二秒内打印行元素之前，您正在打印带有新行标记的附加随机数`for`。请记住，您已经在 second for 内打印了该行的所有元素，因此您不需要在它之前打印另一个元素。

如果您不想在开始时以空行结束，也可以在打印整行后尝试打印新行标记。

# java - Eclipse：如何在 VerticalRuler 上自定义标记的绘制

> ID：15207185
> 
> 赞同：2
> 
> 时间：2013-03-04T17:17:47.163
> 
> 标签：java, eclipse, eclipse-plugin, eclipse-rcp

我正在开发一个 Eclipse 插件，它在 Eclipse 自己的 AbstractTextEditor 中显示自定义多行标记。

这是我到目前为止所拥有的：

*   具有超类型“org.eclipse.core.resources.textmarker”的自定义标记
*   annotationType (org.eclipse.ui.editors.annotationTypes)
*   一个markerAnnotationSpecification (org.eclipse.ui.editors.markerAnnotationSpecification)

这一切都很好，我的标记出现在编辑器中。但我需要自定义它们在 VerticalRuler 上的绘制方式，因此它们不仅显示为图标，而且显示为跨越受影响源行的垂直线。

我知道，这可以通过实现 IAnnotationPresentation 并覆盖paint() 来使用注释来完成。

但是我怎样才能为标记做到这一点？

*编辑*：这是我想要实现的截图：

![左边的红条](../Images/9748ab44acaa9f980ab44f3137a09afa.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T16:59:45.007

我通过提供一个 RulerColumn （扩展点`org.eclipse.ui.workbench.texteditor.rulerColumns`）并配置`markerAnnotationSpecification`为*不*包含`verticalRulerPreferenceKey`and来解决这个问题`verticalRulerPreferenceValue`（因此它不会显示在默认的 AnnotationRulerColumn 上）。

如果有人还发现有关如何最好地实现`IContributedRulerColumn`有点稀疏的文档：似乎要走的路是子类`AbstractContributedRulerColumn`化并将方法委托给`AbstractRulerColumn`.

例如：

```
public class MyRulerColumn extends AbstractContributedRulerColumn {
    private IVerticalRulerColumn delegate = new AbstractRulerColumn() { … }
    public void setModel(IAnnotationModel model) {
        delegate.setModel(model);
    }
    …
} 
```

然后，自定义外观就像覆盖委托中的一种绘制方法一样简单。

# c# - 具有透明背景色问题的自定义 ListBox

> ID：15207186
> 
> 赞同：0
> 
> 时间：2013-03-04T17:17:51.697
> 
> 标签：c#, winforms, listbox, custom-controls, transparent

我创建了一个继承自 ListBox 的自定义多行 ListBox 控件。在表单中，ListBox 位置位于 ElementHost 中托管的 WPF 圆形透明面板上方。现在，我想要的是 ListBox 背景色是透明的。显然，这在 Winforms 中是不允许的，ListBox 不能是透明的。然后，我尝试了一些东西，但总是有一个问题。

我想要实现的是：

![在此处输入图像描述](../Images/436d5e47a5ca85f515446adda9cd65bb.png)

如您所见，这非常有效，但实际上我遇到了两个问题。

我得到的第一个是当我选择一个项目时。字母变得非常难看。只需将下一张图片与第一张图片进行比较。你可以看到它们看起来都很丑，因为它们都被选中了。

![在此处输入图像描述](../Images/8e6bec07679371d2562ade3ded630972.png)

我遇到的第二个问题是当我向下/向上滚动 ListBox 时。透明的颜色消失了，我得到了黑色。

![在此处输入图像描述](../Images/3c258d6c6ccf59ae6c075e898ef8dcbe.png)

我记得在表单中使用可滚动面板遇到了这个问题。面板是透明的，解决方法是在面板滚动事件中调用 Invalidate() 方法。但我在 ListBox 中没有该事件。

另外，我想隐藏滚动条但可以滚动。

我附上了 CustomListBox 代码，这样你就可以看到我做了什么。如果您也想要一个简单的多行 ListBox，您可以随意使用它。

以防万一，我用来将 ListBox 设置为透明的方式是重写 CreateParams。

公共类 MultiLineListBox : System.Windows.Forms.ListBox { public MultiLineListBox() { this.DrawMode = DrawMode.OwnerDrawVariable; this.ScrollAlwaysVisible = true; }

```
 protected override CreateParams CreateParams
    {
        get
        {
            CreateParams cp = base.CreateParams;
            cp.ExStyle |= 0x20; // WS_EX_TRANSPARENT
            return cp;
        }
    }

    protected override void OnMeasureItem(MeasureItemEventArgs e)
    {
        if(Site!=null)
            return;
        if(e.Index > -1)
        {
            string s = Items[e.Index].ToString();
            SizeF sf = e.Graphics.MeasureString(s,Font,Width);
            int htex = (e.Index==0) ? 15 : 10;
            e.ItemHeight = (int)sf.Height + htex;           
            e.ItemWidth = Width;
        }
    }

    protected override void OnDrawItem(DrawItemEventArgs e)
    {
        if(Site!=null)
            return;
        if(e.Index > -1)
        {
            string s = Items[e.Index].ToString();                           

            if((e.State & DrawItemState.Focus)==0)
            {
                e.Graphics.DrawString(s,Font,new SolidBrush(Color.White),e.Bounds);             
                e.Graphics.DrawRectangle(new Pen(Color.FromArgb(255, 26, 36, 41)),e.Bounds);                
            }
            else
            {
                e.Graphics.DrawRectangle(new Pen(Color.FromArgb(255, 0, 185, 57)), e.Bounds);
                //e.Graphics.DrawString(s,Font,new SolidBrush(Color.FromArgb(255, 0, 161, 47)),e.Bounds);
            }
        }
    }
} 
```

哦，我差点忘了。我尝试覆盖 OnPaintBackGround()，它通过将 SetStyle 设置为 userPaint 来工作。但这更不可取，因为我不仅遇到了与其他解决方案相同的问题，而且没有显示文本，所以我坚持第一个解决方案。

希望有人可以帮助我！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:28:35.483

你可以试试这个...

```
protected override void OnPaintBackground(PaintEventArgs pevent)
{
    IntPtr hdc = pevent.Graphics.GetHdc();
    Rectangle rect = this.ClientRectangle;
    NativeMethods.DrawThemeParentBackground(this.Handle, hdc, ref rect);
    pevent.Graphics.ReleaseHdc(hdc);
}

internal static class NativeMethods
{
    [DllImport("uxtheme", ExactSpelling = true)]
    public extern static Int32 DrawThemeParentBackground(IntPtr hWnd, IntPtr hdc, ref Rectangle pRect);
} 
```

当我需要为不支持它的控件绘制透明背景颜色时，它对我有用。我将它与 TabControl 一起使用。

# java - Eclipse JDT 自动格式化：'if' 后的缩进语句没有大括号

> ID：15207187
> 
> 赞同：0
> 
> 时间：2013-03-04T17:17:53.863
> 
> 标签：java, eclipse, code-formatting

我正在尝试设置 Eclipse 的自动格式化以符合我公司的编码风格，但我在这种情况下遇到了严重的问题：“if”语句有一个语句（不是块），它是一个“try”语句。我们的指导方针是它的格式应该是这样的：

```
if (condition)
    try
    {
        something;
    }
    catch (WhateverException e)
    {
        and do something with it;
    } 
```

但 Eclipse 似乎总是想像这样格式化它：

```
if (condition) try
{
    something;
}
catch (WhateverException e)
{
    and do something with it;
} 
```

我查看了所有设置，但看不到任何似乎可以满足我要求的东西，至少当它们具有简单内容（我们确实想要）时，也不会阻止单行 if 语句。有什么我错过的，或者 Eclipse 不能应付这个吗？

# google-apps-script - 使用样式属性的正确方法

> ID：15207190
> 
> 赞同：0
> 
> 时间：2013-03-04T17:17:59.210
> 
> 标签：google-apps-script

我正在使用 DocumentApp.Attribute 的结果好坏参半。这是一个例子：

```
var underline = {};
underline[DocumentApp.Attribute.UNDERLINE] = true;
underline[DocumentApp.Attribute.WIDTH] = 100;
underline[DocumentApp.Attribute.MARGIN_LEFT] = 10;

doc.appendParagraph("Paragraph text").setAttributes(underline); 
```

该段落已创建并带有下划线，但未应用其他两个属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-06T01:56:36.633

我认为您会发现段落不能具有 Margin 或 width 属性……它们适用于整个页面或文档。通过使用 Indent 属性集，您可能会获得您希望的效果。这就引出了下一个问题“如何设置页面属性？”

MARGIN-LEFT 显示为 Body 部分的属性，因此 getActiveSection().setAttributes(style)

我不确定宽度指的是什么，但你可以为每个元素类型做一个 getAttributes 来追踪它 PAGE-WIDTH 又是 Body Section 的一个属性。玩弄这段代码......

```
function myFunction() {
 var doc = DocumentApp.openById("1lqjkdfdsafgdsafsdaQI3kjtY");
var docele = doc.getActiveSection();
Logger.log(docele.getAttributes());
var para = doc.getParagraphs()[0];
var atts = para.getAttributes();
Logger.log(atts)
// Define a custom paragraph style.
var style = {};

style[DocumentApp.Attribute.WIDTH] = 100;
style[DocumentApp.Attribute.MARGIN_LEFT] = 200;
docele.setAttributes(style); 
```

}

对我来说，这给了身体部分的属性`{UNDERLINE=null, MARGIN_BOTTOM=72.0, PAGE_HEIGHT=792.0, BOLD=null, BACKGROUND_COLOR=null, FONT_SIZE=null, FONT_FAMILY=null, STRIKETHROUGH=null, MARGIN_LEFT=10.0, PAGE_WIDTH=612.0, LINK_URL=null, ITALIC=null, MARGIN_RIGHT=72.0, MARGIN_TOP=72.0, FOREGROUND_COLOR=null}`

和段落属性`{UNDERLINE=null, INDENT_END=8.25, LEFT_TO_RIGHT=true, BOLD=null, BACKGROUND_COLOR=null, FONT_SIZE=12, FONT_FAMILY=Comic Sans MS, SPACING_BEFORE=null, SPACING_AFTER=null, STRIKETHROUGH=null, INDENT_START=0.0, LINE_SPACING=null, LINK_URL=null, ITALIC=null, INDENT_FIRST_LINE=0.0, HORIZONTAL_ALIGNMENT=null, HEADING=null, FOREGROUND_COLOR=null}`

这为设置属性的替代形式提供了线索 `docele.setAttributes({"FOREGROUND_COLOR":"#ff0000"})`

# cocoa-touch - 在具有自动布局的 UITableView 前面显示一个视图

> ID：15207193
> 
> 赞同：1
> 
> 时间：2013-03-04T17:18:13.143
> 
> 标签：cocoa-touch, autolayout, nslayoutconstraint

以下是我为我的视图设置的内容。有一个`mask`(UIView)`bottom space to superview`为 0。![在此处输入图像描述](../Images/41a013ce4e91266948de6260b02b4bac.png)

当我在模拟器（iphone-retina 4）或设备（iphone 5）上显示时，面具正在消失。但是，模拟器（iphone或iphone 3.5）或设备（iphone4）没有问题

'bottom space to superview = 0'不应该让面具离开屏幕吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-06T11:54:17.197

自动布局约束很好。掩码不会显示，因为颜色为`[UIColor clearColor]`，`alpha`属性为 0.f，“隐藏”属性设置为“是”，或其他一些原因，例如视图从`superview`其父级中删除。

# excel - 通过 Excel 更新 ODBC DB

> ID：15207196
> 
> 赞同：7
> 
> 时间：2013-03-04T17:18:23.653
> 
> 标签：excel, odbc

我可以通过excel查询和查看表格，但是我想知道是否有一种方法可以通过修改excel中的数据来直接更新或插入。

可能类似于 Microsoft Access 链接表？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-03-04T18:00:45.943

您可以使用 VBA、ADODB 和数据驱动程序编写自定义应用程序来执行此操作。但是 Excel 中没有内置任何内容用于写回 ODBC 数据源。Excel 中的 QueryTables 是只读的。

# objective-c - MGSplitViewController 作为模态无法正常工作

> ID：15207197
> 
> 赞同：0
> 
> 时间：2013-03-04T17:18:25.183
> 
> 标签：objective-c, uisplitviewcontroller

我正在尝试使用 MGSplitViewController，但不是将其设置为 rootViewController，而是希望它以模态方式显示。这是我目前使用的代码

```
- (void)collectionView:(UICollectionView *)collectionView didSelectItemAtIndexPath:    (NSIndexPath *)indexPath
{

    if(splitViewController == nil)
    {
        self.splitViewController = [[MGSplitViewController alloc] init];
        self.rootViewController = [[RootViewController alloc] init];
        self.detailViewController = [[DetailViewController alloc] init];
    }

    [splitViewController setViewControllers:[NSArray arrayWithObjects:rootViewController, detailViewController, nil]];

    if (NO) { // whether to allow dragging the divider to move the split.
        splitViewController.splitWidth = 15.0; // make it wide enough to actually drag!
        splitViewController.allowsDraggingDivider = YES;
    }

    splitViewController.delegate = detailViewController;

    [rootViewController performSelector:@selector(selectFirstRow) withObject:nil afterDelay:0];
    [detailViewController performSelector:@selector(configureView) withObject:nil afterDelay:0];

    [self presentViewController:splitViewController animated:YES completion:nil];
} 
```

这几乎可以正常工作，但 detailViewController 中的按钮不起作用。他们什么都不做。此外，当我单击左侧面板中的按钮时，detailViewController 中的文本不会像在同一项目中那样更改。

我错过了什么吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-16T14:23:48.593

我也在使用 MGSplitViewController，但在我看来，您需要在主视图和详细视图之间建立一些通信。如果您查看演示项目，您可以看到他们使用委托来实现该效果。

# pdf - 日语不显示在 PDF 中

> ID：15207198
> 
> 赞同：0
> 
> 时间：2013-03-04T17:18:27.417
> 
> 标签：pdf, reporting-services

我有一个生成的带有日文文本的 PDF 文件我使用[Arial Unicode MS](http://en.wikipedia.org/wiki/Arial_Unicode_MS)作为字体，一些字母正确显示，但对于其他人，我看到像这样的乱码〠ぇ》❥（希望你能看到它）

如何让它显示日文字符？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T14:10:57.613

看起来 Arial Unicode MS 有 2 个不同的版本 0.84 和 1.01，后者对日语有更好的支持

# c# - 模型绑定列表的问题 在 RedirectToAction() 上正确

> ID：15207202
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:18:47.880
> 
> 标签：c#, asp.net-mvc-4, model-binding, generic-list

我有一个`form`用于过滤的普通多选列表框。

因此，按照标准设计，我将过滤器作为 GET 操作进行。所以表单提交会产生一个完全可以接受的 URL：

```
http://example.com/Matrix?role=1&role=6&role=2 
```

`roles`这与论点完美结合：

```
[HttpGet]
public virtual ViewResult Matrix(List<int> roles) { ... } 
```

现在返回的过滤视图包含一个需要`post`编辑到服务器的表单，因为它包含在`CustomViewModel`. 表单再次发布到相同的 URL，并且绑定完美：

```
[HttpPost]
public virtual ActionResult Matrix(CustomViewModel vm, List<int> roles)
{
    ...
    //Passing the list 'roles' untouched directly to the redirect
    //Problem sirens set off!!
    return RedirectToAction(MVC.T4Path.To.Matrix(roles));
} 
```

尝试执行重定向时会出现问题。现在从逻辑上讲，它似乎是一个直接的重定向，`roles`并作为保留过滤器的参数传递。但生成的 GET 请求是：

```
http://example.com/Matrix?roleSelector=System.Collections.Generic.List%601%5BSystem.Int32%5D 
```

**为什么会这样？我该怎么做才能使生成的 URL 与漂亮的 URL 相似？**

我目前正在使用的解决方法是使用 将数据传回`TempData`，但这会导致数据从 URL 中消失，尽管保留了过滤器，但表单本身是空的/重置。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:11:48.780

如果我正确阅读了源代码，即使路径构建过程相当聪明，它`Convert.ToString()`在构建查询参数方面仍然很简单：

```
stringBuilder1.Append(Uri.EscapeDataString(str));
stringBuilder1.Append('=');
stringBuilder1.Append(Uri.EscapeDataString(Convert.ToString(obj, (IFormatProvider) CultureInfo.InvariantCulture))); 
```

所以你不能做太多让你的网址漂亮。在这种情况下，我看到的唯一选择是手动构建您的网址并将其传入`return Redirect(url)`

# java - 谷歌图表内的链接

> ID：15207203
> 
> 赞同：0
> 
> 时间：2013-03-04T17:18:48.257
> 
> 标签：java, google-visualization

我知道您可以基于此从 Google 图表中链接： [如何在 google chart api 中添加链接](https://stackoverflow.com/questions/6205621/how-to-add-links-in-google-chart-api)

但是，我有存储在 Javascript Literal Notation 的“f”属性中的参数，我想用它来发送到动态链接。例如，我的数据如下所示：

```
 "Load Time":
{"cols":[{"id":"date","label":"Date","type":"string"},
         {"id":"First View","label":"First View","type":"number"},
 "rows":[{"c":[{"f":"130303_67_C", "v":"2013-02-26"},{"v":3.565},{"v":2.495}]},
         {"c":[{"f":"130304_R6_C", "v":"2013-02-27"},{"v":3.6550000000000002},{"v":2.63}]}]}, 
```

我的问题是如何检索“f”中的值以用作我的链接的参数，该链接看起来像[http://www.example.com?testId=](http://www.example.com?testId=)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:11:54.003

以下函数将返回您需要的格式化值： `data.getFormattedValue(chart.getSelection()[0].row, 0)`

可以在以下链接中阅读有关此功能的更多信息：

*   [https://developers.google.com/chart/interactive/docs/events](https://developers.google.com/chart/interactive/docs/events)
*   [https://developers.google.com/chart/interactive/docs/reference#DataTable_getFormattedValue](https://developers.google.com/chart/interactive/docs/reference#DataTable_getFormattedValue)

# c++ - 做一个圈子把别人推开？

> ID：15207204
> 
> 赞同：1
> 
> 时间：2013-03-04T17:18:51.677
> 
> 标签：c++, actionscript-3, math

我的问题对你们来说可能很简单，我只是编程新手，所以是的。

我想在屏幕的中心画一个圆圈，然后我希望当一个玩家靠近它时，他会相对于他来自的方向被推开，这是我画的一个小图清除![图片](../Images/163e605c86c46ecc6ef50f33d75e645a.png)

红色圆圈是来自不同方向的玩家，绿色圆圈是障碍物。箭头显示玩家应该被推向哪个方向 玩家仅在 x,y 轴上移动

非常感谢您的宝贵时间

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-10-14T14:53:54.977

将玩家坐标（红色圆圈中心）从类似笛卡尔的屏幕系统转换为具有中心障碍物原点（绿色圆圈）的极坐标。

为此目的选择复数可能是一个解决方案：`complex(x,y) == polar(r,th)`. 给定对象的半径和公差半径（'close'）。遍历玩家坐标并比较它们的大小（红色圆圈中心到 origo 的距离）。当距离大于它们的半径 + 容差之和时，它们不被认为是接近的。否则调整幅度。将输出坐标反向转换为屏幕给出了结果。

```
void PushAway( std::vector< std::complex< double > > & player_coords )
{
    const double r_o = 3.0; // obstacle radius
    const double r_p = 1.0; // player radius
    const double r_t = 0.1; // 'close'
    const double push = 10.0; // pushing amount
    for( uint idx = 0; idx < player_coords.size(); ++idx )
    {
        std::complex< double > & pc = player_coords[idx];
        double magn = std::abs( pc );
        // too close ?
        if( magn < r_o + r_t + r_p )
        {
            // push away in appropriate direction
            pc = std::polar( push + magn, std::arg( pc ) );
        }
    }
} 
```

# excel - Excel 数据验证源

> ID：15207206
> 
> 赞同：5
> 
> 时间：2013-03-04T17:18:53.797
> 
> 标签：excel, excel-formula, validation

我已经尝试过搜索，但可能只是没有找到正确的关键词组合并且无法找到解决方案。

我在 Excel 中尝试做的是根据在另一个单元格中输入的键值生成一个动态验证列表。

我有 3 个工作表：WSName(Columns)

1.  日志（建筑物、楼层）
2.  建筑物（BuildingId、BuildingName）
3.  楼层（FloorId、BuildingId、FloorName）

我为我所有的建筑 id 创建了一个名为“BuildingIds”的命名范围

我通过名为“Floor#BuildingId#”的建筑为所有楼层创建了单独的命名范围

我想要的是，当在日志工作表中选择建筑物时，楼层列表会动态填充楼层工作表中该建筑物的可用楼层。

我的想法是在数据验证源中我应该能够做到这一点：

```
=INDIRECT("Floors"&$A$2) 
```

它部分有效，但总是返回相同的楼层列表，因为 $A$2 不是动态的，具体取决于它所在的行，所以我需要 $A$2 才能使用当前行的值。

这将返回我想要用于当前行的所选建筑物的值：

```
=INDIRECT("A"&ROW()) 
```

但是当我尝试时：

```
=INDIRECT(CONCATENATE("Floor","A"&ROW())) 
```

或者

```
=CONCATENATE("Floor",INDIRECT("A"&ROW())) 
```

我得到一个错误。

你能帮我这个公式吗？！提前致谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:22:20.610

您使用了不正确的语法 - 这就是手动链接的样子：

```
='Sheet 1'!A1 
```

加上感叹号，`'`你就完成了。其余的对我来说似乎很好）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:13:28.280

好的，我已经完成了这项工作，我只需将数据验证源设置为：

```
=INDIRECT(CONCATENATE("Floors",A2)) 
```

然后，当将公式复制到整个列时，A2 会按预期更新到当前行。

@Peter L. 感谢您的帮助！

# netbeans - 将junit测试单文件目标添加到netbeans中的自由格式java项目

> ID：15207207
> 
> 赞同：3
> 
> 时间：2013-03-04T17:18:54.277
> 
> 标签：netbeans, ant

**我保证，我读过： http: [//netbeans.org/kb/articles/freeform-config.html](http://netbeans.org/kb/articles/freeform-config.html)**

我有一个 java 自由格式项目，我想修改它以在**Netbeans 7.2的上下文菜单中包含一个“测试单个文件”目标**

包含的链接概述了创建一个名为“test.single”的操作（为了覆盖 Netbeans 的测试单个文件命令），并且在该操作创建中，必须指定一个 ant 目标和一个上下文对象，如下所示：

```
<context>
    <property>testclass</property>
    <folder>${current.dir}</folder>
    <pattern>\.java$</pattern>
    <format>java-name</format>
    <arity>
        <one-file-only/>
    </arity>
 </context> 
```

总而言之，我有：

在 ide-actions 块中的 project.xml 中创建操作：

```
<action name="test.single">                                     
  <target>test-single</target>

  <context>
      <property>testclass</property>
      <folder>${current.dir}</folder>
      <pattern>\.java$</pattern>
      <format>java-name</format>
      <arity>
          <one-file-only/>
      </arity>
  </context>
</action> 
```

将 ide-action 添加到上下文菜单块”

```
<ide-action name="test.single"/> 
```

Adding this to the free-form project's project.xml file yields a grayed out "test.single" entry in the context menu upon right-clicking on the project name. Further, right clicking on a test class in my src/test directory yields a grayed out "Test Single File" entry.

I've checked and validated the xml and it all seems to check out. What could I be doing wrong?

thanks in advance!

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-07-11T19:53:16.073

Had the same problem and managed to solve it by cloning the action run.single in by nbproject/project.xml and calling it test.single:

```
<action name="test.single">
    <script>build.xml</script>
    <target>test-single</target>
    <context>
        <property>test.class</property>
        <folder>src/java</folder>
        <pattern>\.java$</pattern>
        <format>java-name</format>
        <arity>
            <one-file-only/>
        </arity>
    </context>
</action> 
```

I also changed the property to test.class as we need this in the projects build.xml to run the appropriate test class.

In the main build.xml I have a target test-single:

```
<target name="test-single" description="Run individual Unit tests" depends="compile, compile-test" >  
    <junit
        printsummary="yes"
        errorProperty="test.failed"
        failureproperty="test.failed"
        haltonfailure="yes" 
        fork="yes"
        showoutput="yes">
        <formatter type="plain" usefile="false"/>
        <classpath>
            <pathelement location="${build.base.classes.dir}" />
            <pathelement location="${unit.test.classes.dir}" />
            <pathelement location="${junit.dir}" />
        </classpath>
        <test name="${test.class}Test" todir="${results}">
        </test>
    </junit>
    <fail message="Tests failed!" if="test.failed"/>
</target> 
```

Note that the refers to the property ${test.class}. But when I leave it like that it tries to run the class being tested instead of the JUnit test class. Since this is always called the same as the class being tested with the word "Test" at the end I have written it so that the name is ${test.class}Test.

# php - 在 Kohana 2 中将自定义字段添加到多对多关系

> ID：15207208
> 
> 赞同：1
> 
> 时间：2013-03-04T17:18:54.890
> 
> 标签：php, orm, kohana

我有 2 个模型：家庭和用户。一个用户可以有很多家，一个家可以有很多用户。

表 home_users（关系表）具有以下字段：User_id、home_id、date

我需要在 X 用户和 Y 家之间创建一个关系，在 Z 日期（只是一个日期）中创建我正在使用的代码是：

```
$user = ORM::factory('User',$user_id);
$user->home_id = $home_id;
$user->date = date("Y-m-d");
$user->save(); 
```

但系统显示“用户模型中不存在该属性 home_id”

我可以为用户添加住宅，但我无法为**在 Z 日期创建的用户添加住宅。**

我怎样才能做到这一点？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:05:53.990

你必须为你的数据透视表创建一个模型，所以你可以检查[这个问题](https://stackoverflow.com/questions/1946357/kohana-3-0-x-orm-read-additional-columns-in-pivot-tables)。然后在数据透视模型中添加：`protected $_created_column = array('column' => 'date', 'format' => 'Y-m-d H:i:s');`其中“日期”是您的列名。

# javascript - iPhone/Mobile Safari：获得可靠的视口高度

> ID：15207212
> 
> 赞同：3
> 
> 时间：2013-03-04T17:19:10.417
> 
> 标签：javascript, sencha-touch, mobile-safari, kendo-ui, viewport

有没有办法从移动 Safari 获得可靠的视口高度值？我已经挣扎了好几天了，我知道我不是唯一一个遇到这个问题的人。
甚至像[http://responsejs.com](http://responsejs.com)这样的工具包也没有帮助我。如何 Sencha Touch 或 Kendo UI 获得屏幕高度，有人知道吗？那可靠吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-06T05:58:08.650

我总是使用这个： [http ://docs.sencha.com/touch/2-1/#!/api/Ext.viewport.Default-method-getWindowHeight](http://docs.sencha.com/touch/2-1/#!/api/Ext.viewport.Default-method-getWindowHeight)

```
Ext.Viewport.getWindowHeight(); 
```

# c# - SharpBITS.NET - rpc 服务器不可用

> ID：15207218
> 
> 赞同：0
> 
> 时间：2013-03-04T17:19:19.723
> 
> 标签：c#, rpc, bits

Win Server 2008 R2 64bit + 实现为 Windows 服务/C#（已经更新到最新的 SharpBITS 库）。

此错误随机发生 - 几天一次。它使对 BITS 管理器对象的所有其他调用失败 => 并且 Windows 服务由于 BITS 错误事件启动而停止。我做了一个解决方法 - 使用“try .. catch”包装对列表队列方法的调用，并“错误”重新创建 BITS 管理器对象。但是这种 hack 风格的解决方案只提高了一点点稳定性——现在服务突然停止工作，大约每周一次，没有任何错误。:(

（相同的代码在 Win Server 2003 上运行良好。）

SharpBITS 库来自：[http ://sharpbits.codeplex.com/](http://sharpbits.codeplex.com/)

# css - Twitter Bootstrap：打印选择元素

> ID：15207223
> 
> 赞同：0
> 
> 时间：2013-03-04T17:19:43.857
> 
> 标签：css, forms, twitter-bootstrap, printing

在 Chrome twitter bootstrap 中，选择元素会导致阴影看起来像垂直拉伸的错误。

![在此处输入图像描述](../Images/d8d42bc75b0db54ab53ba17e3b8187e9.png)

该图像来自 Twitter Bootstrap 站点本身，因此它看起来像是框架的一个错误（尽管我在 github 存储库中看到了他们不太关心打印问题的评论）。我尝试将所有效果类设置为无，但这似乎并没有消除故障。

我仍然需要 Bootstrap 的布局，但我想我可以制作一个没有表单样式的自定义打印版本，但我希望有一个快速修复。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-09-03T22:15:01.420

我有同样的问题，只是重写了这个 css 规则：

```
@media print {
    * { background: transparent !important; }
} 
```

至：

```
@media print {
    select { background: #fff !important; }
} 
```

# sql - 我的 vb.net 网络方法有什么问题？

> ID：15207224
> 
> 赞同：0
> 
> 时间：2013-03-04T17:19:54.210
> 
> 标签：sql, vb.net

此网络方法从数据库中检索 plist、firstaname、lastname、orgid，然后在 2 个不同的表中插入 2 行。第一个 sql 很好 - 第二个不运行

```
<WebMethod()> _
Public Function Register(ByVal meetingid As String, ByVal myid As String, ByVal PartType As Integer, ByVal startDate As String) As String
    Dim connection As New SqlConnection(ConfigurationManager.ConnectionStrings("EPBconnection").ConnectionString)
    Dim sSQL As String
    Dim plistid As String = ""
    Dim LastName As String = ""
    Dim FirstName As String = ""
    Dim orgID As String = ""

    'get plistID
    sSQL = "select pl.PLIST_ID"
    sSQL = sSQL + " From PERSON_LIST pl"
    sSQL = sSQL + " Where MTG_ID = '" + meetingid + "'"
    Dim myCommand As New SqlCommand(sSQL, connection)
    connection.Open()
    Dim myReader As SqlDataReader = myCommand.ExecuteReader
    While myReader.Read()
        plistid = myReader("PLIST_ID").ToString()
    End While
    connection.Close()

    'get firstname, lastname, orgid
    sSQL = "SELECT p.LASTNAME, p.FIRSTNAME, p.ORGA_ID FROM PERSON p WHERE PERSON_ID = '" + myid + "'"
    myCommand = New SqlCommand(sSQL, connection)
    connection.Open()
    myReader = myCommand.ExecuteReader
    While myReader.Read()
        LastName = myReader("LASTNAME").ToString()
        FirstName = myReader("FIRSTNAME").ToString()
        orgID = myReader("ORGA_ID").ToString()
    End While
    connection.Close()

    Return "You are registered for this meeting"

End Function 
```

当我删除以下内容时，它会返回字符串，但否则不会（无论哪种方式编译都没有错误）：

```
While myReader.Read()
    LastName = myReader("LASTNAME").ToString()
    FirstName = myReader("FIRSTNAME").ToString()
    orgID = myReader("ORGA_ID").ToString()
End While 
```

问题似乎来自 myReader.Read()??? 我不明白为什么

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:23:43.620

```
 orgID = myReader("ORGA_ID").ToString() 
```

您已将 orgId 定义为 Integer；

```
 Dim orgID As Integer 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-06T15:27:53.973

抱歉，问题在一夜之间自行解决了。还是不知道是什么问题。哈哈

# php - PHP PayPal沙箱在交易后无法获得价值

> ID：15207225
> 
> 赞同：1
> 
> 时间：2013-03-04T17:19:54.190
> 
> 标签：php, transactions, paypal, sandbox

您好我正在尝试使用 Paypal Sandbox 处理我的 php 代码。我找到了一个我认为不错的教程，并对其进行了测试。第一部分工作正常，但是当我在事务完成后尝试检索值时会出现问题。

这是网站

[http://www.phpgang.com/payment-system-with-paypal_249.html](http://www.phpgang.com/payment-system-with-paypal_249.html)

我的问题也已作为评论发布在他们页面的底部，因此我将在此处复制。

“我总是在成功页面收到付款失败。这是因为 $item_price 和 $item_currency 是空的。它们是空的，因为页面没有像演示那样在 10 秒内从 paypal 页面重定向，您必须单击返回存储，这会让你回到success.php，没有任何东西可以检索$_REQUEST而不是success.php?tx=83437E384950D&st=Completed&amt=10.00&cc=USD&cm=&item_number=1。希望你能帮助谢谢”

谢谢，希望有人可以帮助我解决问题

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:35:59.863

该系统很容易绕过

看：[http ://demo.phpgang.com/payment_with_paypal/success.php?amt=10&cc=USD](http://demo.phpgang.com/payment_with_paypal/success.php?amt=10&cc=USD)

您必须使用 PDT 系统验证交易（使用 curl 发送请求以通过 $_GET 使用返回的详细信息检查交易的有效性），您可以在此处找到一些有用的代码

[https://www.x.com/payment-data-transfer-php-5.3](https://www.x.com/payment-data-transfer-php-5.3)

# java - 检查字符串是否有大量不同的增量值

> ID：15207227
> 
> 赞同：4
> 
> 时间：2013-03-04T17:20:01.320
> 
> 标签：java, string, loops

目前我正在检查以下字符串：

```
if(parseCommand.contains("vlan1") 
|| parseCommand.contains("Fa0/1i") || parseCommand.contains("Fa0/1o") 
|| parseCommand.contains("Fa1/0") || parseCommand.contains("Fa1/1") 
|| parseCommand.contains("Fa1/2") || parseCommand.contains("Fa1/3") 
|| parseCommand.contains("Fa1/4") || parseCommand.contains("Fa1/5") 
|| parseCommand.contains("Fa1/6") || parseCommand.contains("Fa1/7") 
|| parseCommand.contains("Fa1/8") || parseCommand.contains("Fa1/9") 
|| parseCommand.contains("Fa1/11") || parseCommand.contains("Gi0")) 
{
    //do things here                              
} 
```

但是它可能包含 vlan1 到 vlan4094，我必须检查这些。最简单的方法是什么，我猜我是否必须将它全部放在一个递增到 4094 的 for 循环中？

```
 for (int i = 1; i <= 4094; i++)

    {
     if(parseCommand.contains("vlan"[i]))
    {  
    //do stuff here 
    }
    }

    if(other conditions from above)

    {
    //do same stuff again here
    } 
```

否则我可以将所有条件都粘贴在 for 循环中并在那里做所有事情。这一切看起来都很混乱，有没有一种不混乱的方法呢？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T17:27:49.400

**我认为这个正则表达式应该这样做：**

```
String parseCommand = "vlan4094";
if (parseCommand.matches(".*?vlan([1-3][0-9]{3}|" +
                                 "[1-9][0-9]{0,2}|" +
                                 "40(9[0-4]|[0-8][0-9])).*"))
   System.out.println("matches"); 
```

`[1-3][0-9]{3}`- 1000-3999
`[1-9][0-9]{0,2}`- 1-999
`9[0-4]`- 90-94
`[0-8][0-9]`- 00-89
`40(9[0-4]|[0-8][0-9])`- 4000-4094

**这样的事情可能更简单：**

```
String parseCommand = "vlan4094";
if (parseCommand.startsWith("vlan"))
{
   int v = Integer.parseInt(parseCommand.substring(4));
   if (v >= 1 && v <= 4094)
      /* do stuff */
} 
```

**建议更改：**

代替：

```
parseCommand.contains("Fa1/0") || parseCommand.contains("Fa1/1") 
|| parseCommand.contains("Fa1/2") || parseCommand.contains("Fa1/3") 
|| parseCommand.contains("Fa1/4") || parseCommand.contains("Fa1/5") 
|| parseCommand.contains("Fa1/6") || parseCommand.contains("Fa1/7") 
|| parseCommand.contains("Fa1/8") || parseCommand.contains("Fa1/9") 
```

和

```
parseCommand.matches(".*?Fa1/[0-9].*") 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:29:08.073

您可以将它们组合成一个布尔值

```
boolean b = false;

for(int i = 1 ; i < 4094 ; i ++){
    b = b || parseCommand.contains("vlan" + i);
} 
```

然后检查你的布尔值

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:29:42.167

如果唯一的问题是“vlanXXX”，您可以删除字符串的“vlan”部分：

```
parseCommand = parseCommand.replaceFirst("vlan", ""); 
```

然后将其转换为 int

```
int value = Integer.parseInt(parseCommand); 
```

然后将此结果与您想要的结果进行比较

```
if((value >= 1) && (value <= 4094)){....} 
```

这仅适用于给定的情况，您必须处理无法将 parseCommand 强制转换为 int 的情况。它比使用任何正则表达式更容易理解

# android - java.lang.UnsatisfiedLinkError 在某些设备上崩溃

> ID：15207237
> 
> 赞同：5
> 
> 时间：2013-03-04T17:20:30.897
> 
> 标签：android, android-ndk

我有一个已发布的应用程序`java.lang.UnsatisfiedLinkError`在某些设备上报告崩溃。更准确地说，应用程序在启动时崩溃并显示以下日志消息：

`Caused by: java.lang.UnsatisfiedLinkError: Couldn't load qcc: findLibrary returned null`

实际的崩溃在`System.loadLibrary("qcc");`指令中，因此应用程序无法确定找到库。

问题是我自己无法重现该问题。实际上，同一个 apk 在许多不同的设备和版本上都能完美运行。

* * *

该应用程序使用由第三方编写和编译的两个 C 库。它们是使用`arm-linux-androideabi-4.6`工具链编译的，我将它们集成到我的项目中，`nkd-build`并使用以下`Android.mk`文件运行：

```
LOCAL_PATH := $(call my-dir)

include $(CLEAR_VARS)
LOCAL_MODULE := libqcc
LOCAL_SRC_FILES := qcc/libqcc.so
include $(PREBUILT_SHARED_LIBRARY)

include $(CLEAR_VARS)
LOCAL_MODULE := libqpe
LOCAL_SRC_FILES := qpe/libqpe.so
include $(PREBUILT_SHARED_LIBRARY) 
```

该错误正在不同的设备上报告，但目前它们都是以下 Android 版本之一：2.2、2.2.1 或 2.2.2。

* * *

我认为这可能是架构问题或安装过程中的奇怪问题。

有谁知道是什么问题？

* * *

**更新：**

我意识到我可以在 Android 2.2 模拟器中重现该问题。这是我可以从 logcat 收集的额外信息。

```
11:14:59.962 I/dalvikvm(  287): Unable to dlopen(/data/data/.../lib/libqcc.so): Cannot load library: link_image[1995]: failed to link libqcc.so
11:14:59.962 W/dalvikvm(  287): Exception Ljava/lang/UnsatisfiedLinkError; 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-11T19:17:43.623

在这种情况下，问题在于该库使用了一些 Android 2.2 不支持的 C 方法

这个[链接](http://mpigulski.blogspot.com.es/2010/09/debugging-dlopen-unsatisfiedlinkerror.html)是发现问题的方法。

诸如此类的方法`pthread_rwlock_init`直到 Android 2.3（[源代码](https://code.google.com/p/android/issues/detail?id=24228)）才在系统的 C 库中实现。

# ruby-on-rails - 缺少必需的包裹？- 包括 libyaml

> ID：15207239
> 
> 赞同：1
> 
> 时间：2013-03-04T17:20:39.153
> 
> 标签：ruby-on-rails, rvm, homebrew, libyaml

我觉得我的电脑有一些根深蒂固的问题，并且 100% 反对我安装 rails/ruby/rvm 和其他的。或者我只是无能:)

我已经安装了 rvm 和 ruby​​ 没有问题。这是我当前的设置（来自终端的日志）：

```
Mac-mini:rubygems-1.8.25 Riley$ rvm -v

rvm 1.18.15 (master) by Wayne E. Seguin <wayneeseguin@gmail.com>, Michal Papis <mpapis@gmail.com> [https://rvm.io/]

Mac-mini:rubygems-1.8.25 Riley$ ruby -v
ruby 1.9.3p392 (2013-02-22 revision 39386) [x86_64-darwin12.2.1] 
```

但是rails有点不同..

```
Mac-mini:rubygems-1.8.25 Riley$ rails -v
/Users/Jamie/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/yaml.rb:56:in `<top (required)>':
It seems your ruby installation is missing psych (for YAML output).
To eliminate this warning, please install libyaml and reinstall your ruby.
Rails 3.2.12 
```

所以我尝试安装 libyaml：

```
rvm pkg install libyaml
rvm reinstall all --force 
```

但后来我明白了：

```
Missing required packages: autoconf, automake, libtool, pkg-config, apple-gcc42, libyaml, readline, libxml2, libxslt, libksba, openssl, curl-ca-bundle, sqlite. 
```

作为黄色输出，尽管它说安装成功。好的，然后我再次检查rails。

```
Mac-mini:rubygems-1.8.25 Riley$ rails -v
/Users/Jamie/.rvm/rubies/ruby-1.9.3-p392/lib/ruby/1.9.1/yaml.rb:56:in `<top (required)>':
It seems your ruby installation is missing psych (for YAML output).
To eliminate this warning, please install libyaml and reinstall your ruby.
Rails 3.2.12 
```

伟大的。它不工作。所以我尝试安装 Homebrew 让我的生活更轻松一些。

```
ruby -e "$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)" 
```

已安装。凉爽的。

```
Mac-mini:API Riley$ brew help
/usr/local/bin/brew: /usr/local/Library/brew.rb: /System/Library/Frameworks/Ruby.framework/Versions/1.8/usr/bin/ruby: bad interpreter: No such file or directory
/usr/local/bin/brew: line 21: /usr/local/Library/brew.rb: Undefined error: 0 
```

嗯？为了清楚起见，这发生在所有`brew`动作上。

现在，这正是我过去几个小时所面临的。几天来我一直在努力解决这个问题，但我不断收到新的错误。我已经尝试完全删除 Triple R（RVM、Rails 和 Ruby）并重新安装，但似乎没有多少谷歌搜索和调试有效。我只是不知道该怎么办了。我没有任何进展。我已经在其他几台计算机上安装了 Triple R，但这台计算机只是拒绝与我合作。

非常感谢帮助让 Triple R 在我的计算机上工作。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T20:13:52.157

试试这个答案[Running RVM requirements, Skipping brew update](https://stackoverflow.com/questions/15230092/running-rvm-requirements-skipping-brew-update/15233170#15233170) - 这不是同一个问题，但解决方案+解释是一样的。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-07T20:47:52.647

问题源于我安装的 Ruby。显然，如[this answer](https://stackoverflow.com/a/9905801/1292230)中所述，“非 LLVM 版本的 GCC”不再包含在 XCode 命令行工具中。

安装红宝石：

`rvm install ruby --with-gcc=clang`

工作，我在大约 10 分钟内安装了 RVM、Ruby 和 Rails，尽管我花了一周的时间进行调试和重新安装。

# ruby-on-rails-3 - 将表子查询转换为等效的活动记录

> ID：15207241
> 
> 赞同：2
> 
> 时间：2013-03-04T17:20:44.100
> 
> 标签：ruby-on-rails-3, activerecord

我正在尝试在 Rails3 活动记录中复制以下 SQL，到目前为止我发现没有任何东西可以接近。因此，任何帮助将不胜感激。

```
SELECT AVG(DAILY_AVG) FROM (
    SELECT user_code, (COUNT(actioned_at) / 200) as DAILY_AVG
    FROM transactions
    GROUP BY user_code
) TMP 
```

我目前正在使用 ...connection.select_value(sql) 直接执行此操作，但真的很想弄清楚执行此操作的活动记录方式。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-05-21T01:44:39.473

内部查询可以写成：

```
Transaction.group(:user_code).select("COUNT(actioned_at) / 200 AS daily_avg") 
```

然后嵌套它以获得我们可以做的平均值：

```
Transaction.select("AVG(daily_avg)").from(Transaction.group(:user_code).select("COUNT(actioned_at) / 200 AS daily_avg"))[0].avg.to_f 
```

# linux - 仅使用 smbclient 获取文件夹

> ID：15207247
> 
> 赞同：3
> 
> 时间：2013-03-04T17:20:52.583
> 
> 标签：linux, bash, shell, samba, windows-share

我正在努力使用 smbclient 仅从具有以下目录结构的远程 Windows 共享中检索子文件夹。有没有办法发出只获取文件夹的命令？到目前为止我的命令是：

`smbclient //$host/$share -U"$USER%$PASSWORD" -c 'cd RootFolder; prompt; recurse; mget Test*\'`

```
RootFolder/
    Test001/
        Revisions.txt
    Test002/
        Revisions.txt
    Test003/
        Revisions.txt
    Test001=2012_12_05.log
    Test001=2012_12_06.log
    Test001=2012_12_07.log
    Test001=2012_12_08.log
    ... more log files here 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:31:11.710

您可以通过管道输出命令的输出`grep`，查找以 . 结尾的行`/`。

```
smbclient ... | egrep '/$' 
```

相反，您可以挂载远程 Windows 文件系统，然后使用 find 命令搜索文件夹。find 命令将仅递归搜索所有目录。这将是我推荐的方法。假设您将 Windows 文件系统挂载为`/mnt/win_host`...

```
find /mnt/win_host -type d 
```

# android - 从 Android 上的本机代码读取铃声文件

> ID：15207250
> 
> 赞同：0
> 
> 时间：2013-03-04T17:21:03.950
> 
> 标签：android, c, audio, native

我一直在开发一个需要我从本机代码播放适当铃声的应用程序。直到现在我没有找到解决我的问题的方法。是否有任何已知的方法可以让铃声字节解码和播放它们，即：OpenSL ES？

我目前的印象是，这些文件通常是受保护的，需要 root 或其他一些不正当的机制才能访问。它是否正确？

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T10:22:44.783

对于这个问题，我有一个可行的解决方案，它涉及 1 个 JNI 调用来获取一个`ParcelFileDescriptor`，以便获得可以在 OpenSLES 上本地使用的适当 FD。只需要记住保存`ParcelFileDescriptor`最后**关闭**FD而不是收集垃圾。

注意：获取 FD 所需的**API 级别为 12**

注意2：如果您愿意`detachFd()`，则必须关闭本机代码上的FD，并且不需要保留引用。

```
static public ParcelFileDescriptor getFileDescriptor(Context context) {
    Uri uri =  RingtoneManager.getDefaultUri(RingtoneManager.TYPE_RINGTONE);

    ContentResolver contentResolver = context.getContentResolver();

    ParcelFileDescriptor openFileDescriptor;
    try {
        openFileDescriptor = contentResolver.openFileDescriptor(uri, "r");
    } catch (FileNotFoundException e) {
        return null;
    }

    return  openFileDescriptor;
} 
```

# zend-framework - Zend_Date 本地化中的奇怪错误

> ID：15207251
> 
> 赞同：1
> 
> 时间：2013-03-04T17:21:11.110
> 
> 标签：zend-framework, localization, zend-date

我的小脚本中有两个问题。我正在尝试创建一个使用 Zend Framework 1.12.1、Doctrine、Zend_locale、Zend_Currency 和 Zend_Date 的应用程序。

**日期：**

数据库需要这种格式的日期 Ymd H:i:s 但每个用户在自定义控制面板中设置他们的区域设置首选项。所以当我从数据库中得到一个日期时，我必须在选择的语言环境中转换它。

这是我的代码：

```
<?php

     $dboutdata = "4/3/13 12:00 AM"; // 4 March 2013 12:00 AM

     $date = new Zend_Date($dboutdata, null, "en_US");
     echo $date . "<br/>";

     $date = new Zend_Date($dboutdata, null, "it_IT");
     echo $date . "<br/>";

?> 
```

这是结果：

```
Apr 3, 13 12:00:00 AM
04/mar/13 12.00.00 
```

如您所见，结果是错误的。Zend_Date 混淆了月份和日期。我该如何解决这个问题？

**更新：**

```
/**
 * Convert a date from yyyy/mm/dd formatted by the locale setting
 *
 * @param date $dbindata
 * @return date formatted by the locale setting
 */
static public function formatDateOut($dbindata) {
    if (empty ( $dbindata ))
        return false;

    $locale = Zend_Registry::get('Zend_Locale');
    $date = new Zend_Date($dbindata, "yyyy-MM-dd HH:mm:ss", $locale);

    return $date->toString(Zend_Date::DATETIME_SHORT, $locale);
}

/**
 * Convert a date from Zend Locale selected to yyyy/mm/dd H:i:s
 *
 * @param string $dboutdata
 * @return string Y-m-d H:i:s
 */
static public function formatDateIn($dboutdata) {
    if (empty ( $dboutdata ))
        return null;

    $InDb = null;

    $locale = Zend_Registry::get('Zend_Locale');
    $date = new Zend_Date($dboutdata);

    return $date->toString('yyyy-MM-dd HH:mm:ss');
} 
```

此外，如果我需要保存此日期，我该如何对其进行规范化以便将其保存在数据库中？

此致

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:08:24.830

通过将语言环境传递给`Zend_Date`构造函数，您可以告诉它日期的格式。美国日期格式首先具有月份，而欧洲日期格式具有日期，这就是您得到不同结果的原因。

您可能只想在输出日期时设置语言环境，例如：

```
$dboutdata = "4/3/13 12:00 AM";
$date = new Zend_Date($dboutdata, null, "en_US");

echo $date->toString(null, 'en_US') . '<br>'; // outputs Apr 3, 13 12:00:00 AM
echo $date->toString(null, 'it_IT') . '<br>'; // outputs 03/apr/13 00.00.00 
```

# spring - 需要帮助才能开始使用 Spring 框架

> ID：15207254
> 
> 赞同：0
> 
> 时间：2013-03-04T17:21:21.687
> 
> 标签：spring, jakarta-ee

我想学习 Java EE Spring 框架。所以，我从他们的网站下载了 Spring Tool Suite，并按照这个“Hello World”示例：[http ://www.tutorialspoint.com/spring/spring_hello_world_example.htm](http://www.tutorialspoint.com/spring/spring_hello_world_example.htm)

如您所见，他正在导入一些 .jar 文件，我也导入了它们，但我没有 antlr-runtime-3.0.1 和 commons-logging-1.1.1，或者至少我找不到它们。

所以当我运行尝试运行应用程序时，我不知道如何运行应用程序，因为我只有 2 个选项：AspectJ/Java 和 Java 应用程序。

当然，当我尝试运行应用程序时，我得到了错误。

你可以看看截图。

![在此处输入图像描述](../Images/0e9de00873cb0a1698ea342c608e6a80.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:27:49.760

这里是寻找罐子的好地方：

[http://mvnrepository.com/artifact/org.antlr/antlr-runtime](http://mvnrepository.com/artifact/org.antlr/antlr-runtime)

请注意，此页面有多个版本的 antlr。如果点击3.0.1的链接，就可以下载jar了。

可能有一个 antlr 网站有这些罐子，但它可能没有旧的罐子，它们很容易找到。

类似地，对于 commons-logging，它有一个 Apache 站点。但是您可以通过在[http://mvnrepository.com](http://mvnrepository.com)上搜索找到它，尽管您可能需要四处寻找才能找到它。

对于第二个问题，作为 Java 应用程序运行。本教程有一个包含`main()`方法的 MainApp 类。您`MainApp`用作起始类，它将开始运行该`main()`方法的代码。

这是标准的 Java 行为。您可能想通过一些简单的 Java 教程来了解普通的旧 Java 是如何工作的，然后在您更加熟练时添加 Spring Framework。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:33:00.627

在您的情况下，Java 应用程序运行器被占用，因为您确实在编写 Java 应用程序。您正在遵循的教程指定安装第一个 spring 和 commons-logging API。( [http://www.tutorialspoint.com/spring/spring_environment_setup.htm](http://www.tutorialspoint.com/spring/spring_environment_setup.htm) ) 然后您将能够在 API 安装文件夹中找到预期的库。我建议对每个 java 项目使用 maven，它可以让您轻松管理您的依赖项。

# matplotlib - 有没有办法在 matplotlib 中使用双变量颜色图？

> ID：15207255
> 
> 赞同：14
> 
> 时间：2013-03-04T17:21:23.337
> 
> 标签：matplotlib, heatmap, complex-numbers, color-mapping

换句话说，我想制作一个颜色随*2 个*变量变化的热图（或曲面图）。（具体来说，亮度 = 幅度，色调 = 相位。）有没有本地方法可以做到这一点？类似地块的一些示例：

![使用两个颜色条，一个用于幅度，一个用于相位](../Images/c7b0e5094cdc8731a1c40dfefe0a01fc.png)

![使用颜色条表示幅度，使用圆形图例表示相位](../Images/b9456c7e072b7648cee42e5b9e2e4bca.png)

![使用 2D 颜色条来指示两个变量的变化](../Images/dd5e4adc3e969dc67f9abda6a5ce7b78.png)

[我想要做什么的几个很好的例子。](http://lcni.uoregon.edu/%7Edow/Geek_art/Simple_recursive_systems/2-D/3x3_boundary/3x3_boundary_L-systems.html)

[更多来自天文学的例子，但带有非感知色调](http://spie.org/x31118.xml?pf=true)

**编辑：**这就是我所做的：[https ://github.com/endolith/complex_colormap](https://github.com/endolith/complex_colormap)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-06-14T16:42:23.313

`imshow`可以采用 [r, g, b] 条目的数组。因此，您可以将绝对值转换为强度和相位 - 转换为色调。

我将使用复数作为示例，因为它最有意义。如果需要，您可以随时添加`numpy`数组`Z = X + 1j * Y`。

因此，对于您的数据`Z`，您可以使用例如

```
imshow(complex_array_to_rgb(Z)) 
```

哪里（编辑：多亏了[这个建议](https://stackoverflow.com/a/17134353/907575)，让它变得更快更好）

```
def complex_array_to_rgb(X, theme='dark', rmax=None):
    '''Takes an array of complex number and converts it to an array of [r, g, b],
    where phase gives hue and saturaton/value are given by the absolute value.
    Especially for use with imshow for complex plots.'''
    absmax = rmax or np.abs(X).max()
    Y = np.zeros(X.shape + (3,), dtype='float')
    Y[..., 0] = np.angle(X) / (2 * pi) % 1
    if theme == 'light':
        Y[..., 1] = np.clip(np.abs(X) / absmax, 0, 1)
        Y[..., 2] = 1
    elif theme == 'dark':
        Y[..., 1] = 1
        Y[..., 2] = np.clip(np.abs(X) / absmax, 0, 1)
    Y = matplotlib.colors.hsv_to_rgb(Y)
    return Y 
```

因此，例如：

```
Z = np.array([[3*(x + 1j*y)**3 + 1/(x + 1j*y)**2
              for x in arange(-1,1,0.05)] for y in arange(-1,1,0.05)])
imshow(complex_array_to_rgb(Z, rmax=5), extent=(-1,1,-1,1)) 
```

![在此处输入图像描述](../Images/24af136f64e1c90ef22e61046966ddf3.png)

```
imshow(complex_array_to_rgb(Z, rmax=5, theme='light'), extent=(-1,1,-1,1)) 
```

![在此处输入图像描述](../Images/b58299ad256664f9f3edebb35f4fef67.png)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-03-15T15:06:28.290

`imshow`将采用 NxMx3 (rbg) 或 NxMx4 (grba) 数组，因此您可以“手动”进行颜色映射。

您可以通过子类化将您的矢量映射到缩放器并*非常*`Normalize`巧妙地布置自定义颜色图来获得一些牵引力（但我认为这最终将不得不对您的一个维度进行分类）。

 *我做过类似的事情（[pdf链接](http://bigbro.biophys.cornell.edu/publications/242_Caswell.pdf)，见第24页的图），但代码在`MATLAB`（并埋在我的档案中的某个地方）。

我同意双变量颜色图会很有用（主要用于表示非常密集的矢量场，无论你做什么，你都会在小溪中前进）。我认为明显的扩展是让颜色图采用复杂的参数。它需要专门的子类`Normalize`and `Colormap`，如果我认为实现它需要做很多工作，我会来回走动。我怀疑如果你让它手动工作，那将只是一个 api 争论的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2021-08-30T09:08:26.740

我创建了一个易于使用的 2D 颜色图类，它采用 2 个 NumPy 数组并将它们映射到基于参考图像的 RGB 图像。

我以@GjjvdBurg 的[回答](https://stackoverflow.com/a/65596724/5099168)为起点。通过一些工作，这仍然可以改进，并可能变成一个合适的 Python 模块 - 如果你愿意，请随意这样做，我授予你所有学分。

***TL;博士：***

```
# read reference image
cmap_2d = ColorMap2D('const_chroma.jpeg', reverse_x=True)  # , xclip=(0,0.9))

# map the data x and y to the RGB space, defined by the image
rgb = cmap_2d(data_x, data_y)

# generate a colorbar image
cbar_rgb = cmap_2d.generate_cbar() 
```

**`ColorMap2D`班级：**

```
class ColorMap2D:
    def __init__(self, filename: str, transpose=False, reverse_x=False, reverse_y=False, xclip=None, yclip=None):
        """
        Maps two 2D array to an RGB color space based on a given reference image.
        Args:
            filename (str): reference image to read the x-y colors from
            rotate (bool): if True, transpose the reference image (swap x and y axes)
            reverse_x (bool): if True, reverse the x scale on the reference
            reverse_y (bool): if True, reverse the y scale on the reference
            xclip (tuple): clip the image to this portion on the x scale; (0,1) is the whole image
            yclip  (tuple): clip the image to this portion on the y scale; (0,1) is the whole image
        """
        self._colormap_file = filename or COLORMAP_FILE
        self._img = plt.imread(self._colormap_file)
        if transpose:
            self._img = self._img.transpose()
        if reverse_x:
            self._img = self._img[::-1,:,:]
        if reverse_y:
            self._img = self._img[:,::-1,:]
        if xclip is not None:
            imin, imax = map(lambda x: int(self._img.shape[0] * x), xclip)
            self._img = self._img[imin:imax,:,:]
        if yclip is not None:
            imin, imax = map(lambda x: int(self._img.shape[1] * x), yclip)
            self._img = self._img[:,imin:imax,:]
        if issubclass(self._img.dtype.type, np.integer):
            self._img = self._img / 255.0

        self._width = len(self._img)
        self._height = len(self._img[0])

        self._range_x = (0, 1)
        self._range_y = (0, 1)

    @staticmethod
    def _scale_to_range(u: np.ndarray, u_min: float, u_max: float) -> np.ndarray:
        return (u - u_min) / (u_max - u_min)

    def _map_to_x(self, val: np.ndarray) -> np.ndarray:
        xmin, xmax = self._range_x
        val = self._scale_to_range(val, xmin, xmax)
        rescaled = (val * (self._width - 1))
        return rescaled.astype(int)

    def _map_to_y(self, val: np.ndarray) -> np.ndarray:
        ymin, ymax = self._range_y
        val = self._scale_to_range(val, ymin, ymax)
        rescaled = (val * (self._height - 1))
        return rescaled.astype(int)

    def __call__(self, val_x, val_y):
        """
        Take val_x and val_y, and associate the RGB values 
        from the reference picture to each item. val_x and val_y 
        must have the same shape.
        """
        if val_x.shape != val_y.shape:
            raise ValueError(f'x and y array must have the same shape, but have {val_x.shape} and {val_y.shape}.')
        self._range_x = (np.amin(val_x), np.amax(val_x))
        self._range_y = (np.amin(val_y), np.amax(val_y))
        x_indices = self._map_to_x(val_x)
        y_indices = self._map_to_y(val_y)
        i_xy = np.stack((x_indices, y_indices), axis=-1)
        rgb = np.zeros((*val_x.shape, 3))
        for indices in np.ndindex(val_x.shape):
            img_indices = tuple(i_xy[indices])
            rgb[indices] = self._img[img_indices]
        return rgb

    def generate_cbar(self, nx=100, ny=100):
        "generate an image that can be used as a 2D colorbar"
        x = np.linspace(0, 1, nx)
        y = np.linspace(0, 1, ny)
        return self.__call__(*np.meshgrid(x, y)) 
```

**用法：**

完整示例，使用从[此处](https://github.com/BIDS/colormap/issues/6#issuecomment-352002922)获取的恒定色度参考作为屏幕截图：

```
# generate data
x = y = np.linspace(-2, 2, 300)
xx, yy = np.meshgrid(x, y)
ampl = np.exp(-(xx ** 2 + yy ** 2))
phase = (xx ** 2 - yy ** 2) * 6 * np.pi
data = ampl * np.exp(1j * phase)
data_x, data_y = np.abs(data), np.angle(data)

# Here is the 2D colormap part
cmap_2d = ColorMap2D('const_chroma.jpeg', reverse_x=True)  # , xclip=(0,0.9))
rgb = cmap_2d(data_x, data_y)
cbar_rgb = cmap_2d.generate_cbar()

# plot the data
fig, plot_ax = plt.subplots(figsize=(8, 6))
plot_extent = (x.min(), x.max(), y.min(), y.max())
plot_ax.imshow(rgb, aspect='auto', extent=plot_extent,  origin='lower')
plot_ax.set_xlabel('x')
plot_ax.set_ylabel('y')
plot_ax.set_title('data')

#  create a 2D colorbar and make it fancy
plt.subplots_adjust(left=0.1, right=0.65)
bar_ax = fig.add_axes([0.68, 0.15, 0.15, 0.3])
cmap_extent = (data_x.min(), data_x.max(), data_y.min(), data_y.max())
bar_ax.imshow(cbar_rgb, extent=cmap_extent, aspect='auto',  origin='lower',)
bar_ax.set_xlabel('amplitude')
bar_ax.set_ylabel('phase')
bar_ax.yaxis.tick_right()
bar_ax.yaxis.set_label_position('right')
for item in ([bar_ax.title, bar_ax.xaxis.label, bar_ax.yaxis.label] +
             bar_ax.get_xticklabels() + bar_ax.get_yticklabels()):
    item.set_fontsize(7)
plt.show() 
```

[![示例图](../Images/00720c369ea9b44e94e7ad9bef1cea05.png)](https://i.stack.imgur.com/n2rbV.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2022-03-04T04:33:28.907

我知道这是一个旧帖子，但想帮助其他可能迟到的人。[下面是从sage](https://doc.sagemath.org/html/en/index.html)实现 complex_to_rgb 的 python 函数。注意：这个实现不是最优的，但它是可读的。见链接：（[例子](https://doc.sagemath.org/html/en/reference/plotting/sage/plot/complex_plot.html)）（[源代码](https://github.com/sagemath/sage/blob/f716a0b366e31bbb546230140489244cfb68390d/src/sage/plot/complex_plot.pyx#L69)）

代码：

```
import numpy as np

def complex_to_rgb(z_values):

    width = z_values.shape[0]
    height = z_values.shape[1]
    rgb = np.zeros(shape=(width, height, 3))

    for i in range(width):

        row = z_values[i]

        for j in range(height):

            # define value, real(value), imag(value)
            zz = row[j]
            x = np.real(zz)
            y = np.imag(zz)

            # define magnitued and argument
            magnitude = np.hypot(x, y)
            arg = np.arctan2(y, x)

            # define lighness
            lightness = np.arctan(np.log(np.sqrt(magnitude) + 1)) * (4 / np.pi) - 1

            if lightness < 0:
                bot = 0
                top = 1 + lightness
            else:
                bot = lightness
                top = 1

            # define hue
            hue = 3 * arg / np.pi

            if hue < 0:
                hue += 6

            # set ihue and use it to define rgb values based on cases
            ihue = int(hue)

            # case 1
            if ihue == 0:
                r = top
                g = bot + hue * (top - bot)
                b = bot

            # case 2
            elif ihue == 1:
                r = bot + (2 - hue) * (top - bot)
                g = top
                b = bot

            # case 3
            elif ihue == 2:
                r = bot
                g = top
                b = bot + (hue - 2) * (top - bot)

            # case 4
            elif ihue == 3:
                r = bot
                g = bot + (4 - hue) * (top - bot)
                b = top

            # case 5
            elif ihue == 4:
                r = bot + (hue - 4) * (top - bot)
                g = bot
                b = top

            # case 6
            else:
                r = top
                g = bot
                b = bot + (6 - hue) * (top - bot)

            # set rgb array values
            rgb[i, j, 0] = r
            rgb[i, j, 1] = g
            rgb[i, j, 2] = b

    return rgb 
```*

# login - Prestashop 1.5.3.1 无法将商品添加到购物车或登录到店面

> ID：15207256
> 
> 赞同：0
> 
> 时间：2013-03-04T17:21:26.290
> 
> 标签：login, prestashop, cart

我的网站[http://www.lordswoods.co.uk](http://www.lordswoods.co.uk)有两个问题，

1.  没有产品可以添加到购物车，
2.  客户无法登录到店面。

我已经尝试卸载并重新安装购物车块并将整个站点恢复到问题存在之前。

我已经改变了定义（'_PS_MODE_DEV_'，假）；定义（'_PS_MODE_DEV_'，真）；在 config/define.inc.php 中显示错误。

它似乎与标题有关，任何人都知道这里有什么问题。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T19:29:39.330

与 PHP 上常见的标题相关的错误：检查模板中的 PHP 打开标记之前是否没有字符。

还要检查文件的字符集编码，如果它与 HTML 代码中的 UTF8 声明匹配。

# mysql - 拉取最近 60 分钟的 mysql 数据

> ID：15207258
> 
> 赞同：2
> 
> 时间：2013-03-04T17:21:35.613
> 
> 标签：mysql, sql, date, time

嗨，我的 mysql 数据库表中有一个名为 FirstAdded 的列——日期并以这种格式存储：2013-03-04 16:37:05

我想根据 FirstAdded 列提取过去一小时内添加到数据库中的所有行。

我已经阅读过有关 INTERVAL 的信息，但不知道从这里开始

有人可以帮忙吗？

非常感谢，

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:22:54.313

这应该让你开始

```
SELECT *
FROM Tablename
WHERE FirstAdded > CURRENT_TIMESTAMP - INTERVAL 1 HOUR 
```

# c# - 有关结构实现接口时发生的情况的详细信息

> ID：15207260
> 
> 赞同：14
> 
> 时间：2013-03-04T17:21:37.673
> 
> 标签：c#, .net, struct, value-type, boxing

我最近遇到了这个 Stackoverflow 问题：[何时使用结构？](https://stackoverflow.com/questions/521298/when-to-use-struct-in-c)

在里面，它有一个回答有点深奥：

> 此外，要意识到当一个结构实现了一个接口 - 就像 Enumerator 所做的那样 - 并被强制转换为该实现的类型时，该结构成为一个引用类型并被移动到堆中。在 Dictionary 类的内部，Enumerator 仍然是一个值类型。但是，只要方法调用 GetEnumerator()，就会返回引用类型的 IEnumerator。

这究竟是什么意思？

如果我有类似的东西

```
struct Foo : IFoo 
{
  public int Foobar;
}

class Bar
{
  public IFoo Biz{get; set;} //assume this is Foo
}

...

var b=new Bar();
var f=b.Biz;
f.Foobar=123; //What would happen here
b.Biz.Foobar=567; //would this overwrite the above, or would it have no effect?
b.Biz=new Foo(); //and here!? 
```

值类型结构的详细语义究竟是什么被视为引用类型？

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-03-04T20:15:35.667

结构类型的每个声明实际上都在运行时声明了两种类型：值类型和堆对象类型。从外部代码的角度来看，堆对象类型的行为类似于具有相应值类型的字段和方法的类。从内部代码的角度来看，堆类型的行为就像它具有`this`相应值类型的字段一样。

尝试将值类型转换为引用类型（`Object`、`ValueType`、`Enum`或任何接口类型）将生成其相应堆对象类型的新实例，并返回对该新实例的引用。如果尝试将值类型存储到引用类型存储位置，或者将其作为引用类型参数传递，也会发生同样的事情。一旦该值被转换为一个堆对象，它将表现为——从外部代码的角度来看——作为一个堆对象。

值类型的接口实现可以在没有首先将值类型转换为堆对象的情况下使用的唯一情况是，当它作为泛型类型参数传递时，接口类型作为约束。在那种特定情况下，接口成员可以在值类型实例上使用，而不必先将其转换为堆对象。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-05-14T10:26:17.710

阅读有关**装箱**和**拆箱**的信息（搜索互联网）。例如 MSDN：[装箱和拆箱（C# 编程指南）](http://msdn.microsoft.com/en-us/library/yz2be5wk.aspx)。

另请参阅 SO 线程[为什么我们需要在 C# 中装箱和拆箱？](https://stackoverflow.com/questions/2111857/why-do-we-need-boxing-and-unboxing-in-c)，以及链接到该线程的线程。

注意：如果您“转换”为值类型的基类并不那么重要，如

```
object obj = new Foo(); // boxing 
```

或“转换”为已实现的接口，如

```
IFoo iFoo = new Foo(); // boxing 
```

唯一的基类 a`struct`有、是`System.ValueType`和`object`（包括`dynamic`）。类型的基类`enum`是`System.Enum`、`System.ValueType`和`object`。

结构可以实现任意数量的接口（但它不从其基类继承接口）。枚举类型实现`IComparable`（非泛型版本）`IFormattable`，，并且`IConvertible`因为基类`System.Enum`实现了这三个。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-27T12:47:17.223

我在 2013 年 3 月 4 日回复你关于你的实验的帖子，虽然我可能有点晚了:)

请记住这一点：每次将结构值分配给接口类型的变量（或将其作为接口类型返回）时，它将被装箱。可以将其想象为将在堆上创建一个新对象（盒子），并将结构的***值******复制***到那里。该框将一直保留，直到您对其进行引用，就像任何对象一样。

对于行为 1，您具有 IFoo 类型的 Biz auto 属性，因此当您在此处设置值时，它将被装箱并且该属性将保留对该框的引用。每当您获得属性的值时，都会返回该框。这样，它的工作方式就好像 Foo 是一个类一样，你得到你所期望的：你设置一个值，然后你把它取回来。

现在，使用行为 2，您存储了一个结构（字段 tmp），并且您的 Biz 属性将其值作为 IFoo 返回。这意味着***每次调用 get_Biz 时，都会创建并返回一个新框***。

查看 Main 方法：每次看到 b.Biz 时，都是不同的对象（框）。这将解释实际行为。

比如排队

```
 b.Biz.Foobar=567; 
```

b.Biz 在堆上返回一个框，您将其中的 Foobar 设置为 576，然后，由于您不保留对它的引用，因此您的程序会立即丢失它。

在下一行中，您编写 b.Biz.Foobar，但是对 b.Biz 的调用将再次创建一个全新的框，其中 Foobar 具有默认值 0，这就是打印的内容。

下一行，前面的变量 f 也被一个 b.Biz 调用填充，它创建了一个新框，但是您保留了该 (f) 的引用并将其 Foobar 设置为 123，所以这仍然是您在该框中的其余部分的方法。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:27:21.087

所以，我决定亲自测试一下这种行为。我会给出“结果”，但我无法解释为什么会这样。希望对它的工作原理有更多了解的人能够出现并以更彻底的答案启发我

完整的测试程序：

```
using System;

namespace Test
{
    interface IFoo
    {
        int Foobar{get;set;}
    }
    struct Foo : IFoo 
    {
        public int Foobar{ get; set; }
    }

    class Bar
    {
        Foo tmp;
        //public IFoo Biz{get;set;}; //behavior #1
        public IFoo Biz{ get { return tmp; } set { tmp = (Foo) value; } } //behavior #2

        public Bar()
        {
            Biz=new Foo(){Foobar=0};
        }
    }

    class MainClass
    {
        public static void Main (string[] args)
        {
            var b=new Bar();
            var f=b.Biz;
            f.Foobar=123; 
            Console.WriteLine(f.Foobar); //123 in both
            b.Biz.Foobar=567; /
            Console.WriteLine(b.Biz.Foobar); //567 in behavior 1, 0 in 2
            Console.WriteLine(f.Foobar); //567 in behavior 1, 123 in 2
            b.Biz=new Foo();
            b.Biz.Foobar=5;
            Console.WriteLine(b.Biz.Foobar); //5 in behavior 1, 0 in 2
            Console.WriteLine(f.Foobar); //567 in behavior 1, 123 in 2
        }
    }
} 
```

如您所见，通过手动装箱/拆箱，我们会得到**截然不同**的行为。不过，我并不完全理解这两种行为。

# python - 如何在 Python 中使用 dir/s 命令？

> ID：15207271
> 
> 赞同：5
> 
> 时间：2013-03-04T17:22:18.207
> 
> 标签：python, windows, python-2.7, subprocess

**背景**

`dir/s`我一直在批处理文件中使用该命令。但是，我无法使用 python 调用它。**注意：**我使用的是 Python 2.7.3。

**代码**

```
import subprocess
subprocess.call(["dir/s"]) 
```

**错误信息**

```
Traceback (most recent call last):
  File "<pyshell#2>", line 1, in <module>
    subprocess.call(["dir/s"])
  File "C:\Python27\lib\subprocess.py", line 493, in call
    return Popen(*popenargs, **kwargs).wait()
  File "C:\Python27\lib\subprocess.py", line 679, in __init__
    errread, errwrite)
  File "C:\Python27\lib\subprocess.py", line 896, in _execute_child
    startupinfo)
WindowsError: [Error 2] The system cannot find the file specified 
```

我曾尝试更改报价，但没有任何效果。

我将如何`dir/s`使用 调用模块`subprocess`？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T17:29:59.910

怎么样

```
subprocess.call("dir/s", shell=True) 
```

未验证。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T17:28:48.640

这与您所要求的有很大不同，但它解决了同样的问题。此外，它以 Python 式的多平台方式解决了这个问题：

```
import fnmatch
import os

def recglob(directory, ext):
    l = []
    for root, dirnames, filenames in os.walk(directory):
        for filename in fnmatch.filter(filenames, ext):
            l.append(os.path.join(root, filename))
    return l 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T21:30:52.380

我终于找到了答案。要列出目录中的*所有*目录（例如`D:\\`，`C:\\`），需要首先导入`os`模块。

```
import os 
```

然后，他们需要说他们想列出*所有内容。*在此范围内，他们需要确保打印输出。

```
for top, dirs, files in os.walk('D:\\'):
    for nm in files:       
        print os.path.join(top, nm) 
```

这就是我能够解决它的方法。多亏了[这一点。](https://stackoverflow.com/a/120695/1993598)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T17:24:39.120

`dir`和之间需要一个空格`/s`。所以把它分解成一个由 2 个元素组成的数组。同样正如 carlosdoc 指出的那样，您需要添加 shell=True，因为该`dir`命令是内置的 shell。

```
import subprocess
subprocess.call(["dir", "/s"], shell=True) 
```

但是，如果您要获取目录列表，请使用模块中可用的功能使其独立于操作系统，`os`例如`os.listdir()`，`os.chdir()`

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2013-03-04T17:29:47.630

由于它是命令行的内置部分，因此您需要将其运行为：

```
import subprocess
subprocess.call("cmd /c dir /s") 
```

# android - 服务中的 getWindow() 方法

> ID：15207273
> 
> 赞同：0
> 
> 时间：2013-03-04T17:22:19.607
> 
> 标签：android, service

我知道服务没有 UI，但我想在服务中使用 getWindow()。我也知道我可以使用活动引用。但我想在不同的活动中使用这项服务。可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:27:39.380

服务与您的 UI 在同一线程上运行。如果您愿意，您可以从服务连接到您的 UI，但在您追求这条道路之前，您想做什么？您想跨应用程序使用相同的服务吗？

# c# - 将图像转换为字节[]

> ID：15207275
> 
> 赞同：0
> 
> 时间：2013-03-04T17:22:24.037
> 
> 标签：c#, image

我想开始学习如何将图像撕开以找到其中的模式，但为了做到这一点，我需要先看看它是由什么组成的。我想获取一个 png 并将其转换为字节数组，以便我可以将其打印出来，看看我是否可以识别数组值中的简单模式。

到目前为止我有这个

```
public MainWindow()
{
    InitializeComponent();
    System.Drawing.Image image;
    image = System.Drawing.Image.FromFile("one.png");            

    byte[] imArray = imageToByteArray(image);

    String bytes = "";
    foreach (Char bite in imArray)
    {
        bytes += "-"+bite;
    }
    MessageBox.Show(bytes);

}

public byte[] imageToByteArray(System.Drawing.Image imageIn)
{
    MemoryStream ms = new MemoryStream();
    imageIn.Save(ms, System.Drawing.Imaging.ImageFormat.Gif);
    return ms.ToArray();
} 
```

但这似乎不起作用。调用转换方法时，它给了我一个空错误。我不知道为什么这不起作用，因为我对组件的理解为零。

如果您可以建议一种更简单的方法来进行此转换，请随时发布。我没有停留在这段代码上，我只想要一个工作示例，所以我有一个起点。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:43:16.023

我建议从位图开始查看二进制数据 - 大多数其他格式存储压缩数据，因此您没有机会通过查看字节来了解图像内部的内容。

您想要的方法是[Bitmap.LockBits](http://msdn.microsoft.com/en-us/library/5ey6h79d.aspx)。这篇文章还包括完整的示例如何从文件中读取并查看 t 位，摘录如下：

```
Bitmap bmp = new Bitmap("c:\\fakePhoto.jpg");
Rectangle rect = new Rectangle(0, 0, bmp.Width, bmp.Height);
BitmapData bmpData =
   bmp.LockBits(rect, ImageLockMode.ReadWrite, bmp.PixelFormat);

int bytes  = Math.Abs(bmpData.Stride) * bmp.Height;
byte[] rgbValues = new byte[bytes];

// Copy the RGB values into the array.
Marshal.Copy(bmpData.Scan0, rgbValues, 0, bytes); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:33:53.313

您可以尝试将图像转换为 dataURI，然后将其转换为 blob，这是一个如何将 dataURIs 转换为 [blob 从 DataURL 的示例？](https://stackoverflow.com/questions/12168909/blob-from-dataurl)

```
function dataURItoBlob(dataURI) {

var byteString = atob(dataURI.split(',')[1]);
var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0];
var ab = new ArrayBuffer(byteString.length);
var ia = new Uint8Array(ab);

for (var i = 0; i < byteString.length; i++) {
    ia[i] = byteString.charCodeAt(i);
  }

var bb = new BlobBuilder();
bb.append(ab); return bb.getBlob(mimeString);
} 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-11-05T23:33:33.003

或者您可以在二进制编辑器中打开文件。

# python - 返回在熊猫中跳过nan值的排序索引？

> ID：15207279
> 
> 赞同：3
> 
> 时间：2013-03-04T17:22:33.967
> 
> 标签：python, pandas

我有以下数据集：

```
PID,RUN_START_DATE,PUSHUP_START_DATE,SITUP_START_DATE,PULLUP_START_DATE
1,2013-01-24,2013-01-02,,2013-02-03
2,2013-01-30,2013-01-21,2013-01-13,2013-01-06
3,2013-01-29,2013-01-28,2013-01-01,2013-01-29
4,2013-02-16,2013-02-12,2013-01-04,2013-02-11
5,2013-01-06,2013-02-07,2013-02-25,2013-02-12
6,2013-01-26,2013-01-28,2013-02-12,2013-01-10
7,2013-01-26,,2013-01-12,2013-01-30
8,2013-01-03,2013-01-24,2013-01-19,2013-01-02
9,2013-01-22,2013-01-13,2013-02-03,
10,2013-02-06,2013-01-16,2013-02-07,2013-01-11 
```

我知道我可以`numpy.argsort`用来返回值的排序索引：

```
SQ_AL_INDX = numpy.argsort(df_sequence[['RUN_START_DATE', 'PUSHUP_START_DATE', 'SITUP_START_DATE', 'PULLUP_START_DATE']], axis=1) 
```

...返回...

```
 RUN_START_DATE  PUSHUP_START_DATE  SITUP_START_DATE  PULLUP_START_DATE
0               2                  1                 0                  3
1               3                  2                 1                  0
2               2                  1                 0                  3
3               2                  3                 1                  0
4               0                  1                 3                  2
5               3                  0                 1                  2
6               1                  2                 0                  3
7               3                  0                 2                  1
8               3                  1                 0                  2
9               3                  1                 0                  2 
```

但是，它似乎把`pandas.NaT`价值观放在第一位。所以在这个例子`where PID == 1`中，排序顺序返回`2 1 0 3`。但是，第二个索引位置是一个`pandas.Nat`值。

如何在跳过`pandas.NaT`值的同时获取已排序的索引（例如，返回索引值将是`2 1 np.NaN 3`or`2 1 pandas.NaT 3`或更好`1 0 2`，`PID 1`而不是`2 1 0 3`）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:49:23.813

传递`numpy.argsort`给`apply`方法而不是直接使用它。这样，NaN/NaT 会持续存在。对于您的示例：

```
In [2]: df_sequence[['RUN_START_DATE', 'PUSHUP_START_DATE', 'SITUP_START_DATE', 'PULLUP_START_DATE']].apply(numpy.argsort, axis=1)
Out[2]: 
                RUN_START_DATE  PUSHUP_START_DATE  SITUP_START_DATE  PULLUP_START_DATE
0               1                  0               NaN               2
(etc.) 
```

# xml - 在 Javascript 中使用正则表达式来抓取 RSS/XML 标记之间的文本

> ID：15207281
> 
> 赞同：0
> 
> 时间：2013-03-04T17:22:37.787
> 
> 标签：xml, regex, json, rss

我正在创建一个 jQuery Mobile 应用程序，它解析 RSS 提要并将条目动态输入到 DOM 中。我正在使用该`.contentSnippet`功能`<description>...</description>`从`<em>...</em>`. 如何使用 Javascript 和 RegEx 选择此内容？这是我正在使用的 RSS 的样子。

`<description><![CDATA[<font size="2"><em>American Banker Magazine (03/13) Fest, Glen</em>...</description>`

我将提要作为 JSON 对象引入。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:32:30.123

如果您确定要使用正则表达式，可以使用

```
var str = '<description><![CDATA[<font size="2"><em>American Banker Magazine (03/13) Fest, Glen</em>...</description>',
    m = str.match( /<em>(.+?)<\/em>/ );

console.log( m && m[1] || 'Nothing doing' );
// American Banker Magazine (03/13) Fest, Glen 
```

# rpm - 用 scons 构建 rpm 的问题

> ID：15207282
> 
> 赞同：1
> 
> 时间：2013-03-04T17:22:40.657
> 
> 标签：rpm, scons

我是 SCons 的新手，我正在尝试用 SCons 构建一个 rpm。这是失败的部分

```
rpm_env = Environment(tools=['default','packaging'])
rpm_env['RPM_BUILD_ROOT'] = os.path.join(os.environ['HOME'], 'test-rpm')

rpmDist = rpm_env.Package(
PACKAGEROOT = os.path.join(os.environ['HOME'], 'test-rpm'),
NAME='pmpb',
VERSION='1.2.3',
PACKAGEVERSION="1",
PACKAGETYPE='rpm',
DESCRIPTION = "Test",
SUMMARY = "test Sum",
LICENSE = "liscent",
X_RPM_GROUP="Application/pattern-matcher"
)
rpm_env = Environment(tools=['default','packaging'])
rpm_env['RPM_BUILD_ROOT'] = os.path.join(os.environ['HOME'], 'test-rpm') 
```

运行 scons 时，创建规范文件时出现错误

```
scons: *** [build/debug/applications/pattern_matching/pmpb-1.2.3.spec] AttributeError :      'File' object has no attribute 'PACKAGING_INSTALL_LOCATION' 
```

谁能告诉我我做错了什么谢谢

# linq - 在查询定义之后，使用列表过滤 linq

> ID：15207286
> 
> 赞同：0
> 
> 时间：2013-03-04T17:22:56.067
> 
> 标签：linq, list

我正在尝试使用列表对 linq 结果进行过滤。

我有一个包含客户姓名的列表：

```
List<string> custList = new List<string> { "customer1", "customer2", "customer3" }; 
```

然后我有我的 linq 代码：

```
var userRoles = from u in db.UserRoles.Include(c => c.Customers)
select u; 
```

然后我想使用我的客户列表进行过滤：

```
userRoles = userRoles.Where(.........); 
```

我已经通过执行以下操作在查询定义中进行了过滤：

```
var userRoles = from u in db.UserRoles.Include(c => c.Customers)
where custList.contain(u.Customers.Name)
select u; 
```

但出于设计目的，我需要在查询定义之后进行过滤。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:24:45.003

```
var userRoles = from u in db.UserRoles.Include(c => c.Customers)
var someRoles = userRoles.Where(........); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:32:12.980

不确定我是否完全理解，但您可以将其拆分为两个查询：

```
var userRoles = from u in db.UserRoles.Include(c => c.Customers)
                select u; 
```

然后在其他位置：

```
List<string> custList = new List<string> { "customer1", "customer2", "customer3" };

var custRoles = from u in userRoles
                where custList.Contains(u.Customers.Name)
                select u; 
```

# eclipse - 其他人创建的分支不可见

> ID：15207296
> 
> 赞同：0
> 
> 时间：2013-03-04T17:23:40.807
> 
> 标签：eclipse, git, egit

我可以通过 Eclipse/eGit 访问 github 中有一个分支。然后，一位同事从该现有分支创建了一个分支，但我在 Eclipse 或命令行中看不到该新分支。我需要做什么才能使我可以看到该分支的分支？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:38:59.257

您的同事需要将其[推](https://www.kernel.org/pub/software/scm/git/docs/git-push.html)送到 Github，然后您需要进行[fetch](https://www.kernel.org/pub//software/scm/git/docs/git-fetch.html)从 Github 获取。然后，如果你想自己在同一个分支上工作，你需要基于它创建一个本地分支，在最近的 Git 版本中，可以简单地通过[`git checkout <simple branch name>`](https://www.kernel.org/pub//software/scm/git/docs/git-checkout.html).

**更新：**因此，当您无法获取远程参考时，您应该检查您的 fetch refspec 是否类似于`+refs/heads/*:refs/remotes/origin/*`，否则您将看不到整个画面。

# c++ - 如何使用 CMake 链接多个库

> ID：15207297
> 
> 赞同：14
> 
> 时间：2013-03-04T17:23:43.007
> 
> 标签：c++, cmake

我有一些与 DCMTK 相关的代码。如果我从命令行使用 g++，我可以成功构建并运行它。这是代码：

```
#include "dcmtk/config/osconfig.h"
#include "dcmtk/dcmdata/dctk.h"

int main()
{
DcmFileFormat fileformat;
OFCondition status = fileformat.loadFile("test.dcm");
if (status.good())
{
   OFString patientsName;
   if (fileformat.getDataset()->findAndGetOFString(DCM_PatientsName, patientsName).good())
   {
      cout << "Patient's Name: " << patientsName << endl;
   } else
     cerr << "Error: cannot access Patient's Name!" << endl;
} else
cerr << "Error: cannot read DICOM file (" << status.text() << ")" << endl;
return 0;
} 
```

这是构建命令：

```
g++ testeapp.cxx -DHAVE_CONFIG_H -I/path_to_dcmtk/include -L/path_to_dcmtk/lib -pthread -ldcmdata -lz -loflog -lofstd -o main 
```

我想制作一个 CMakeLists.txt 以在 Kdevelop 中构建它。这是我目前拥有的：

```
 # Configure toplevel directories
    SET( PREFIX     ${CMAKE_INSTALL_PREFIX} CACHE PATH "Top level.")
    SET( INCLUDEDIR ${PREFIX}/include       CACHE PATH "Include files.")
    SET( LIBDIR     ${PREFIX}/lib           CACHE PATH "Libraries.")
    FIND_PACKAGE ( Threads REQUIRED )
    # Configure DCMTK
    FIND_PATH( DINIFTI_DCMTK_INCLUDE dcmtk
               PATHS ${INCLUDEDIR}
               PATH_SUFFIXES dcmtk
               DOC "Path to the DCMTK headers." )
    FIND_LIBRARY(DINIFTI_DCMTK_LIB NAMES dcmdata ofstd oflog 
                 HINTS ${LIBDIR} ${LIBDIR})
TARGET_LINK_LIBRARIES( dinifti ${DINIFTI_DCMTK_LIB}
                               ${DINIFTI_ZNZ_LIB}
                               ${CMAKE_THREAD_LIBS_INIT}
                               z ) 
```

但是当我构建它时，它有这个错误：

```
/usr/local/lib/libdcmdata.a(dcfilefo.o): In function `DcmFileFormat::remove(DcmItem*)':
dcfilefo.cc:(.text+0x1788): undefined reference to `log4cplus::Logger::forcedLog(int, OFString const&, char const*, int, char const*) const' 
```

你能帮我解决这个错误吗？谢谢你。

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-03-04T22:20:15.413

看起来您希望[`find_library`](http://www.cmake.org/cmake/help/v2.8.10/cmake.html#command:find_library)调用`DINIFTI_DCMTK_LIB`使用 3 个单独的库填充变量。

这不是`find_library`工作方式。后面的不同参数`NAMES`代表一个库*可以*调用的所有不同名称。这允许命令跨平台工作，其中相同的库可以在不同的平台上被称为不同的东西。

一个小问题是您可能应该更喜欢使用`PATHS`而不是`HINTS`此处。形成文档：

> ...`HINTS`选项...应该是系统自省计算的路径，例如由已找到的另一个项目的位置提供的提示。应使用该`PATHS`选项指定硬编码猜测。

我想你想要更多类似的东西：

```
find_library(DINIFTI_DCMTK_LIB NAMES dcmdata PATHS ${LIBDIR})
find_library(OFSTD_LIB NAMES ofstd PATHS ${LIBDIR})
find_library(OFLOG_LIB NAMES oflog PATHS ${LIBDIR})
target_link_libraries(dinifti ${DINIFTI_DCMTK_LIB}
                              ${OFLOG_LIB}
                              ${OFSTD_LIB}
                              ${DINIFTI_ZNZ_LIB}
                              ${CMAKE_THREAD_LIBS_INIT}
                              z) 
```

# javascript - JS - 数组中每个对象的相同功能

> ID：15207299
> 
> 赞同：1
> 
> 时间：2013-03-04T17:23:44.260
> 
> 标签：javascript, jquery, oop

我有像棋盘这样的二维对象数组。

您可以通过`data.field(x,y);`（对象存储在二维对象数组中）获取对象

我希望每个字段都有功能：`top`, `bottom`, `left`,`right`将返回邻居字段。

例如`data.field(3,3).top().left().bottom().name`将返回字段 (4,3) 的名称。

但是：我必须为每个对象声明这些函数吗？我的意思是，例如在 8x8 字段上，这将是同一函数的 64 个实例：

```
data.field(0,0).top = function(){...}
data.field(0,1).top = function(){...}
... 
```

Ofc 我可以很容易地在循环中声明它们，但这纯粹是浪费内存，我确信这不是这样做的方法。是否可以仅在 field(x,y) 函数返回的每个对象中声明此函数一次可用？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:25:56.523

> 是否可以仅在 field(x,y) 函数返回的每个对象中声明此函数一次？

绝对地：

```
function top() {
    // ...do your thing, using `this`
}

data.field(0,0).top = top; 
```

当作为从对象中`top`检索它的表达式的一部分被调用时，在对 的调用中将是对象。同样对于等。`field(0,0)``top``this``field(0,0)``field(0,1)`

更多（在我的博客上）：

*   [*神话方法*](http://blog.niftysnippets.org/2008/03/mythical-methods.html)

现在，假设无论出于何种原因，您已经拥有了`field(0,0)`和这样的对象（也许它们是由您无法控制的代码创建的）。如果您控制代码，则可以通过原型链执行此操作：

```
function Field() {
}
Field.prototype.top = function() {
    // ...do your top thing, using `this`
}; 
```

...以及在创建字段时：

```
yourField = new Field(); 
```

所以这取决于你`data.fields(0,0)`是什么以及你从哪里得到它。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:28:41.167

如果你想节省内存，你应该看看原型。它们就像面向对象语言中的类，因此有机会进行内存优化。

```
var Field = function() {}; // this is your constructor
Field.prototype.top = function () { /* .. */
    return this; // return the field so you can do chaining: field.top().left();
};
Field.prototype.left = function () { /* .. */
    return this;
};
/* .. */
var field = new Field();
data.set(0, 0, field);
data.field(0, 0).top().left(); 
```

# javascript - 将一个元素的 xy 坐标与元素列表进行比较以找到匹配项 (jQuery)

> ID：15207301
> 
> 赞同：2
> 
> 时间：2013-03-04T17:23:47.520
> 
> 标签：javascript, jquery, css

我有一个 10x10 的方形 div 网格，具有唯一的 id（比如 #square1、#square2 到 #square100）

这些 div 中的每一个都报告它们在 CSS 中的 X 和 Y 位置。

说：

```
…#square42 {left:20px; top:400px; width:10px; height:10px;}
#square43 {left:30px; top:400px; width:10px; height:10px;}... 
```

我试图做的是将页面上单独选择器的 X 和 Y 位置与 css 中列出的方形 div 进行比较。如果该选择器与其中一个正方形具有相同的顶部/左侧值，则执行某些操作。

即如果这个 div 的 xy 是

```
#squareElement {left:50px; top:70px;} 
```

然后我可以为这个元素的 ID 添加一个样式

```
#square75 
```

一些伪代码：获取#squareElement 顶部/左侧值，与#square1 到#square100 进行比较，如果相等则显示该ID 的内部段落标签。

谁能帮我用一些 jQuery 来完成这个？谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T21:16:20.047

我不完全确定您要做什么。jsfiddle 示例似乎与您的问题完全不同。如果您试图获取节点的位置，可能最简单的方法是

```
var pos = $('#square1').position();
console.log(pos.left, pos.top); 
```

或者使用类似的东西

```
$('#square1').css('left); 
```

# android - 使用带有 ViewPager 的选项卡时出现错误“Java.lang.IllegalStateException Activity 已被破坏”

> ID：15207305
> 
> 赞同：111
> 
> 时间：2013-03-04T17:24:10.687
> 
> 标签：android, android-fragments, android-viewpager, actionbarsherlock, android-nested-fragment

我有一个应用程序，它包括在选项卡模式下使用 ActionBarSherlock。我有 5 个选项卡，每个选项卡的内容都使用片段处理。不过，对于 tab2，我有一个片段，其中的 xml 文件包含一个 ViewPager 元素，该元素又具有一些片段页面。当我最初启动应用程序时，我可以在选项卡之间切换没有问题，但是当我第二次按下 tab2 时，我得到了上面提到的错误。主要活动如下：

```
public class MainActivity extends SherlockFragmentActivity
{
    @Override
    protected void onCreate(Bundle savedInstanceState) 
    {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        ActionBar actionBar = getSupportActionBar();

        ActionBar.Tab tab1 = actionBar.newTab().setText("Tab1");
        ActionBar.Tab tab3 = actionBar.newTab().setText("Tab3");
        ActionBar.Tab tab2 = actionBar.newTab().setText("Tab2");
        ActionBar.Tab tab4 = actionBar.newTab().setText("Tab4");
        ActionBar.Tab tab5 = actionBar.newTab().setText("Tab5");

        Fragment fragment1 = new Tab1();
        Fragment fragment3 = new Tab3();
        Fragment fragment2 = new Tab2();
        Fragment fragment5 = new Tab5();
        Fragment fragment4 = new Tab4();

        tab1.setTabListener(new MyTabListener(fragment1));
        tab3.setTabListener(new MyTabListener(fragment3));
        tab2.setTabListener(new MyTabListener(fragment2));
        tab5.setTabListener(new MyTabListener(fragment5));
        tab4.setTabListener(new MyTabListener(fragment4));

        actionBar.addTab(tab1);
        actionBar.addTab(tab2);
        actionBar.addTab(tab3);
        actionBar.addTab(tab4);
        actionBar.addTab(tab5); 

        actionBar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);
    }

    class MyTabListener implements ActionBar.TabListener
    {
        Fragment fragment;

        public MyTabListener(Fragment fragment)
        {
            this.fragment = fragment;
        }

        @Override
        public void onTabSelected(com.actionbarsherlock.app.ActionBar.Tab tab,FragmentTransaction ft) 
        {
            ft.replace(R.id.fragment_container,fragment);
        }

        @Override
        public void onTabUnselected(com.actionbarsherlock.app.ActionBar.Tab tab,FragmentTransaction ft) 
        {

        }

        @Override
        public void onTabReselected(com.actionbarsherlock.app.ActionBar.Tab tab,FragmentTransaction ft) 
        {

        }
    }
} 
```

没有 ViewPager 的片段类如下：

```
public class Tab1 extends Fragment 
{
    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState)
    {
        return inflater.inflate(R.layout.activity_tab1, container, false);
    }
} 
```

带有 ViewPager 的片段类如下：

```
public class Tab2 extends Fragment 
{
    ViewPager mViewPager;
    private MyFragmentPagerAdapter mMyFragmentPagerAdapter;  
    private static int NUMBER_OF_PAGES = 5;

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,Bundle savedInstanceState)
    {
        View view =  inflater.inflate(R.layout.activity_tab2, container, false); 
        return view;
    }

    @Override
    public void onViewCreated(View view,Bundle savedInstanceState)
    {
        super.onViewCreated(view, savedInstanceState);
        mViewPager = (ViewPager) view.findViewById(R.id.viewpager);
        mMyFragmentPagerAdapter = new MyFragmentPagerAdapter(getChildFragmentManager());  
        mViewPager.setAdapter(mMyFragmentPagerAdapter);  
    }

    private static class MyFragmentPagerAdapter extends FragmentPagerAdapter 
    {    
        public MyFragmentPagerAdapter(FragmentManager fm) 
        {  
             super(fm);  
        }  

        @Override  
        public Fragment getItem(int index) 
        {  
             return PageFragment.newInstance("My Message " + index);
        }  

        @Override  
        public int getCount() 
        {  
             return NUMBER_OF_PAGES;  
        }  
   }
} 
```

从我在不同地方读到的内容（如果我错了，请纠正我），发生这种情况是因为第二遍的片段管理器试图重用不再存在的活动中的片段，从而给出错误。但是我不确定为什么会在这里发生这种情况，因为我没有使用片段活动。根据 logcat，错误出现在 Tab2 类中，onViewCreated 方法位于 mViewPager.setAdapter(mMyFragmentPagerAdapter) 行上。非常感谢任何帮助...谢谢。

```
03-04 12:01:05.468: E/AndroidRuntime(2474): FATAL EXCEPTION: main
03-04 12:01:05.468: E/AndroidRuntime(2474): java.lang.IllegalStateException: Activity has been destroyed
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.FragmentManagerImpl.enqueueAction(FragmentManager.java:1342)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.BackStackRecord.commitInternal(BackStackRecord.java:595)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.BackStackRecord.commitAllowingStateLoss(BackStackRecord.java:578)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.FragmentPagerAdapter.finishUpdate(FragmentPagerAdapter.java:139)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.view.ViewPager.populate(ViewPager.java:1011)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.view.ViewPager.populate(ViewPager.java:880)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.view.ViewPager.setAdapter(ViewPager.java:433)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at com.example.tabs.Tab2.onViewCreated(Tab2.java:31)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:925)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.FragmentManagerImpl.moveToState(FragmentManager.java:1088)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.BackStackRecord.run(BackStackRecord.java:682)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.FragmentManagerImpl.execPendingActions(FragmentManager.java:1444)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.support.v4.app.FragmentManagerImpl$1.run(FragmentManager.java:429)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.os.Handler.handleCallback(Handler.java:587)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.os.Handler.dispatchMessage(Handler.java:92)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.os.Looper.loop(Looper.java:123)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at android.app.ActivityThread.main(ActivityThread.java:3687)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at java.lang.reflect.Method.invokeNative(Native Method)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at java.lang.reflect.Method.invoke(Method.java:507)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:842)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:600)
03-04 12:01:05.468: E/AndroidRuntime(2474):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：284
> 
> 时间：2013-03-27T10:18:14.767

这似乎是新添加的对嵌套片段的支持中的一个错误。基本上，当孩子`FragmentManager`从活动中分离出来时，它的内部状态就会破裂。为我修复它的一个短期解决方法是将以下内容添加到您调用`onDetach()`的所有内容中：`Fragment``getChildFragmentManager()`

```
@Override
public void onDetach() {
    super.onDetach();

    try {
        Field childFragmentManager = Fragment.class.getDeclaredField("mChildFragmentManager");
        childFragmentManager.setAccessible(true);
        childFragmentManager.set(this, null);

    } catch (NoSuchFieldException e) {
        throw new RuntimeException(e);
    } catch (IllegalAccessException e) {
        throw new RuntimeException(e);
    }
} 
```

* * *

## 回答 #2

> 赞同：13
> 
> 时间：2013-03-19T23:53:46.827

我有完全相同的问题。我发现的唯一解决方法是在每次更改选项卡时用新实例替换片段。

```
ft.replace(R.id.fragment_container, Fragment.instantiate(PlayerMainActivity.this, fragment.getClass().getName())); 
```

不是一个真正的解决方案，但我还没有找到一种方法来重用以前的片段实例......

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2014-08-09T11:50:43.883

`super.onCreate()`在我的方法结束时调用时遇到了同样的问题。原因：`attachActivity()`在FragmentActivity的onCreate()中调用。当覆盖`onCreate()`，例如，创建选项卡时，选项卡管理器将尝试切换到片段，而不会将活动附加到 FragmentManager。

简单的解决方案：将调用移动到`super.onCreate()`函数体的头部。

一般来说，似乎有很多原因可能会发生此问题。这只是另一个...

马蒂亚斯

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-07-17T18:28:32.113

想补充一点，我的问题出在一个活动中，我在调用之前尝试`FragmentTransaction`在 onCreate中进行操作`super.onCreate()`。我刚刚移到`super.onCreate()`功能的顶部并且工作正常。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2014-01-10T14:47:38.080

我有这个错误，因为我正在使用 LocalBroadcastManager 并且我做到了：

```
unregisterReceiver(intentReloadFragmentReceiver); 
```

代替：

```
LocalBroadcastManager.getInstance(this).unregisterReceiver(intentReloadFragmentReceiver); 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-12-19T06:41:53.423

我遇到了同样的问题，后来发现，我错过了`super.onCreate( savedInstanceState );`对`onCreate()`FragmentActivity 的调用。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2014-05-13T06:03:05.713

`FragmentManager`在片段完全初始化（即附加到活动或至少`onCreateView()`被调用）之前尝试访问子项时，我遇到了同样的错误。否则，将使用导致上述异常`FragmentManager`的 Activity 进行初始化。`null`

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-07-30T17:17:45.827

我在 onPause 中强制包含子片段的片段为 NULL，它解决了我的问题

```
fragment = null; 
```

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-07-15T08:05:05.100

我知道这是一篇旧帖子，但建议的答案对我不起作用。我想把它留在这里，以防有人会发现它有用。

我所做的是：

```
@Override
public void onResume() {
    super.onResume();
    // add all fragments
    FragmentTransaction fragmentTransaction = getChildFragmentManager().beginTransaction();
    for(Fragment fragment : fragmentPages){
        String tag = fragment.getClass().getSimpleName();
        fragmentTransaction.add(R.id.contentPanel, fragment, tag);
        if(fragmentPages.indexOf(fragment) != currentPosition){
            fragmentTransaction.hide(fragment);
        } else {
            lastTag = tag;
        }
    }
    fragmentTransaction.commit();
} 
```

然后在：

```
@Override
public void onPause() {
    super.onPause();
    // remove all attached fragments
    for(Fragment fragment: fragmentPages){
        getChildFragmentManager().beginTransaction().remove(fragment).commit();
    }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2014-04-03T08:48:33.633

我遇到了这个问题，在这里找不到解决方案，所以我想分享我的解决方案，以防其他人再次遇到这个问题。

我有这个代码：

```
public void finishAction() {
  onDestroy();
  finish();
} 
```

并通过删除“onDestroy();”行解决了这个问题

```
public void finishAction() {
  finish();
} 
```

我编写初始代码的原因：我知道当您执行“finish()”时，活动会调用“onDestroy()”，但我正在使用线程，并且我想确保在开始下一个活动之前销毁所有线程，并且看起来“finish（）”并不总是立即的。我需要处理/减少很多“位图”并显示大“位图”，我正在努力改善我的应用程序中内存的使用

现在我将使用不同的方法终止线程，并从“onDestroy();”执行此方法 当我认为我需要杀死所有线程时。

```
public void finishAction() {
  onDestroyThreads();
  finish();
} 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2015-06-16T15:41:38.807

我遇到了这个问题并意识到这是因为我在我的电话中打`setContentView(int id)`了两次电话`Activity``onCreate`

* * *

## 回答 #12

> 赞同：0
> 
> 时间：2017-04-26T08:11:13.293

这让我为 Xamarin 疯狂。

我在 Fragment 中使用 TabLayout 的 ViewPager 实现遇到了这个问题，它本身在 DrawerLayout 中实现：

```
 - DrawerLayout
   - DrawerFragment
     - TabLayout
     - TabViewPager
       - TabViewPagerFragments 
```

因此，您必须在**DrawerFragment**中实现以下代码。请注意选择正确的 FragmentManager-Path。因为您可能有两个不同的 FragmentManager 引用：

1.  Android.Support.V4.App.FragmentManager
2.  Android.App.FragmentManager

--> 选择你使用的那个。如果你想使用 ChildFragmentManager，你必须为你的 ViewPager 使用类声明*Android.App.FragmentManager*！

**Android.Support.V4.App.FragmentManager**

在您的“主要”片段中实现以下方法 - 在本例中：*DrawerFragment*

```
public override void OnDetach() {
    base.OnDetach();
    try {
        Fragment x = this;
        var classRefProp = typeof(Fragment).GetProperty("class_ref", BindingFlags.NonPublic | BindingFlags.Static);
        IntPtr classRef = (IntPtr)classRefProp.GetValue(x);
        var field = JNIEnv.GetFieldID(classRef, "mChildFragmentManager", "Landroid/support/v4/app/FragmentManagerImpl;");
        JNIEnv.SetField(base.Handle, field, IntPtr.Zero);
    }
    catch (Exception e) {
        Log.Debug("Error", e+"");
    }
} 
```

**Android.App.FragmentManager**

```
public class TabViewPager: Android.Support.V13.App.FragmentPagerAdapter {} 
```

这意味着您必须使用 Android.App.FragmentManager 来初始化 ViewPager。

在您的“主要”片段中实现以下方法 - 在本例中：*DrawerFragment*

```
public override void OnDetach() {
    base.OnDetach();
    try {
        Fragment x = this;
        var classRefProp = typeof(Fragment).GetProperty("class_ref", BindingFlags.NonPublic | BindingFlags.Static);
        IntPtr classRef = (IntPtr)classRefProp.GetValue(x);
        var field = JNIEnv.GetFieldID(classRef, "mChildFragmentManager", "Landroid/app/FragmentManagerImpl;");
        JNIEnv.SetField(base.Handle, field, IntPtr.Zero);
    }
    catch (Exception e) {
        Log.Debug("Error", e+"");
    }
} 
```

* * *

## 回答 #13

> 赞同：0
> 
> 时间：2020-05-21T08:00:15.040

该错误已在最新的 androidx 版本中修复。著名的解决方法现在会导致崩溃。所以我们现在不需要它。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2020-12-28T00:23:29.670

我发现我在后台运行了一个计时器。当活动被杀死时，计时器仍在运行。在计时器完成回调中，我访问片段对象做一些工作，这是错误！！！！片段存在，但活动不存在。

如果您有计时器服务或任何后台线程，请确保不要访问片段对象。

# ruby-on-rails - 在 ActiveRecord 中向 Rails“包含”添加“where”子句

> ID：15207307
> 
> 赞同：0
> 
> 时间：2013-03-04T17:24:16.540
> 
> 标签：ruby-on-rails, ruby-on-rails-3, activerecord

*   用户有很多站点
*   站点有许多控制器
*   控制器有许多检查

这就是我目前所拥有的。

```
current_user
   .sites
   .joins(:controllers)
   .where('controllers.inspections_enabled = true')
   .all(:include => [:controllers => [:inspections]]) 
```

这给了我：

“启用控制器的所有站点，包括所有控制器和检查”

我想

“启用控制器的所有站点，并且仅包括具有'inspections_enabled = true'的控制器，以及所有子检查”

提前致谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:53:28.760

您应该定义一个已定义条件的关联，请参阅[*文档*](http://api.rubyonrails.org/classes/ActiveRecord/Associations/ClassMethods.html)

> 如果您确实希望只加载关联的某些成员，通常更自然地包含一个定义了条件的关联。

在你的情况下：

```
class Site < ActiveRecord::Base
  has_many :inspections_enabled_controllers, 
           :class_name => 'Controller', 
           :conditions => ['inspections_enabled = ?', true]
end

current_user
    .sites
    .joins(:inspections_enabled_controllers)
    .all(:include => [:inspections]) 
```

# tomcat - Grails 在 tomcat 上失败，缺少类 GrailsMock

> ID：15207311
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:24:21.653
> 
> 标签：tomcat, grails, deployment, dependencies

当我在 Tomcat 7 上部署我的应用程序时，我在生产 Ubuntu 和开发 iOS 上都遇到了这个奇怪的失败。奇怪......而且我找不到导致问题的确切代码/：调用$ grails run-app 工作得很好..

这是我的错误信息：

```
2013-03-04 16:47:27,966 [localhost-startStop-1] ERROR context.ContextLoader  - Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/
applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Unable to locate constructor with Class p
arameter for class org.codehaus.groovy.grails.commons.DefaultGrailsControllerClass
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsC
ontrollerClass
        ... 6 more
Caused by: java.lang.reflect.InvocationTargetException
        ... 6 more
Caused by: java.lang.NoClassDefFoundError: grails/test/GrailsMock
        at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
        at java.lang.Class.getDeclaredMethods(Class.java:1808)
        ... 6 more
Caused by: java.lang.ClassNotFoundException: grails.test.GrailsMock
        ... 8 more
2013-03-04 16:47:27,991 [localhost-startStop-1] ERROR context.GrailsContextLoader  - Error initializing the application: Error creating bean with na
me 'pluginManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.
lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsControllerClass
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/
applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Unable to locate constructor with Class p
arameter for class org.codehaus.groovy.grails.commons.DefaultGrailsControllerClass
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsC
ontrollerClass
        ... 6 more
Caused by: java.lang.reflect.InvocationTargetException
        ... 6 more
Caused by: java.lang.NoClassDefFoundError: grails/test/GrailsMock
        at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
        at java.lang.Class.getDeclaredMethods(Class.java:1808)
        ... 6 more
Caused by: java.lang.ClassNotFoundException: grails.test.GrailsMock
        ... 8 more
2013-03-04 16:47:28,003 [localhost-startStop-1] ERROR context.GrailsContextLoader  - Error initializing Grails: Error creating bean with name 'plugi
nManager' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.Runt
imeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsControllerClass
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'pluginManager' defined in ServletContext resource [/WEB-INF/
applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.RuntimeException: Unable to locate constructor with Class p
arameter for class org.codehaus.groovy.grails.commons.DefaultGrailsControllerClass
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
        at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:334)
        at java.util.concurrent.FutureTask.run(FutureTask.java:166)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
        at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.RuntimeException: Unable to locate constructor with Class parameter for class org.codehaus.groovy.grails.commons.DefaultGrailsC
ontrollerClass
        ... 6 more
Caused by: java.lang.reflect.InvocationTargetException
        ... 6 more
Caused by: java.lang.NoClassDefFoundError: grails/test/GrailsMock
        at java.lang.Class.privateGetDeclaredMethods(Class.java:2442)
        at java.lang.Class.getDeclaredMethods(Class.java:1808)
        ... 6 more
Caused by: java.lang.ClassNotFoundException: grails.test.GrailsMock
        ... 8 more 
```

还有我的 BuildConfig：

```
grails.servlet.version = "2.5" // Change depending on target container compliance (2.5 or 3.0)
grails.project.class.dir = "target/classes"
grails.project.test.class.dir = "target/test-classes"
grails.project.test.reports.dir = "target/test-reports"
grails.project.target.level = 1.6
grails.project.source.level = 1.6
//grails.project.war.file = "target/${appName}-${appVersion}.war"

grails.project.dependency.resolution = {
    // inherit Grails' default dependencies
    inherits("global") {
        // specify dependency exclusions here; for example, uncomment this to disable ehcache:
        // excludes 'ehcache'
    }
    log "error" // log level of Ivy resolver, either 'error', 'warn', 'info', 'debug' or 'verbose'
    checksums true // Whether to verify checksums on resolve

    repositories {
        inherits true // Whether to inherit repository definitions from plugins

        grailsPlugins()
        grailsHome()
        grailsCentral()

        mavenLocal()
        mavenCentral()

        mavenRepo "http://repository.codehaus.org/"
        mavenRepo "http://repository.jboss.org/maven2/"

        // uncomment these (or add new ones) to enable remote dependency resolution from public Maven repositories
        //mavenRepo "http://snapshots.repository.codehaus.org"
        //mavenRepo "http://repository.codehaus.org"
        //mavenRepo "http://download.java.net/maven/2/"
        //mavenRepo "http://repository.jboss.com/maven2/"
    }
    dependencies {
        compile 'com.googlecode.json-simple:json-simple:1.1'
        compile 'org.mongodb:mongo-java-driver:2.10.1'
        // specify dependencies here under either 'build', 'compile', 'runtime', 'test' or 'provided' scopes eg.

        // runtime 'mysql:mysql-connector-java:5.1.20'
    }

    plugins {
        compile ":mongodb:1.0.0.GA"
        build ":tomcat:$grailsVersion"
        runtime(":hibernate:$grailsVersion") {
            export = false
        }
        test ":build-test-data:2.0.3"
        compile ":crypto:2.0"
    }
} 
```

谢谢，

阿米特。

PS：链接到我在 grails-users 列表中的问题：http: [//grails.1312388.n4.nabble.com/Grails-fails-on-tomcat-with-missing-class-GrailsMock-tt4642038.html](http://grails.1312388.n4.nabble.com/Grails-fails-on-tomcat-with-missing-class-GrailsMock-tt4642038.html)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T09:25:00.260

问题是我引用了我的一项服务顶部的 @Mock 注释。@Mock 注释显然不属于那里，而是属于测试类。这创建了对无法从 .war 包中解析的 Grails 测试包的引用。

我可能在做 TDD / 时把它弄混了：

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T06:01:47.253

缺少的类在 grails-test-2.1.1.jar 中（根据您的版本调整 2.1.1）。

请确保您部署了该 jar 文件。

或者，您可以使用 Grails Console 插件来检查类路径。

# r - 处理点图像 R pa

> ID：15207319
> 
> 赞同：1
> 
> 时间：2013-03-04T17:24:44.200
> 
> 标签：r, satellite-image

我在 DN 中有一个 SPOT 图像（波段 1 到 4），我需要将它们转换为反射率值。有谁知道 R 中的任何包可以帮助解决这个问题？谢谢大家。。诺拉

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-08T15:34:07.260

了解您正在计划的 SPOT 图像的应用会很有趣。在许多情况下，可能不需要大气和辐射校正。

没有专门处理 SPOT 图像的包，但您可以调整`landsat`包提供的功能。

有很好的参考资料处理 SPOT 应用和原始 DN 转换以适应大气和辐射校正。我会说[Song et al 2001](http://www.unc.edu/courses/2008spring/geog/577/001/www/Song01_RSE.pdf)是基本读物，但请参阅[Clark dissertation](http://www.doria.fi/bitstream/handle/10024/62221/enhanced.pdf?sequence=1)。

您会发现 Spot[参考表](http://www.isprs.org/proceedings/XXXVI/part1/Papers/PS2-20.pdf)，类似于[Landsat](http://landsathandbook.gsfc.nasa.gov/data_prod/prog_sect11_3.html)可用的参考表。

让我们知道您是否找到了解决方案。

# python - 超出范围的对象 Python

> ID：15207322
> 
> 赞同：2
> 
> 时间：2013-03-04T17:24:56.257
> 
> 标签：python, object

我最近在学习 python，但在创建对象时遇到了问题。我创建了一个名为 pdf 的类，它有助于解析输入的 pdf（工作）。我遇到的问题是，由于我不确定的原因，单独创建的对象正在共享内存空间。

```
for root, dirnames, filenames in os.walk("../PDF_DB_100//"):
for filename in filenames:
    if filename.endswith('.pdf'):
        print filename
        pdf("../PDF_DB_100/"+filename).get_info()
        count+=1
        if count == 10:
            break

class pdf(object):
    Uno = []
    Dos = []
    Tress = []
    Quatro = []

    def __init__(self,path):
       operations, mostly appends onto the above variables
    .... 
```

此代码遍历 .pdf 的目录并为 10 个 pdf 创建一个 pdf 对象。但是由于没有引用 pdf 对象，一旦 get_info() 行完成，它不应该超出范围。为什么单独的 pdf 将数据附加到单个列表中？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:29:16.037

在 Python 中，在类顶层定义的类属性是类本身的属性，而不是实例。

具体来说，您想要的可能是

```
class pdf(object):
    def __init__(self,path):
      self.S_Linc = []
      self.Short_Legal = []
      self.Title_Number = []
      self.Legal_Description = []

       operations, mostly appends onto the above variables
    .... 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:30:41.207

问题是您在对象内部而不是在构造函数内部声明列表。

改为这样做。

```
class pdf(object):
    def __init__(self):
        self.Uno = [] 
```

# python - 比较 2 个不同 Excel 文件中 1 列的记录，报告缺失或添加的内容

> ID：15207325
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:25:06.343
> 
> 标签：python, excel

我正在寻找建议，同时尝试在运行月度报告之前比较两个 Excel 数据文件。我希望这可以在 python 中完成。

2 个 .xls 文件应该是相同的（一个是当前月份的数据，一个是上个月的数据），但可能有添加或缺失的记录（作为一行）。我有一个“ID”列，其中包含我要比较的信息。

**如果有任何差异（添加或缺失的行），我想报告任何差异。**

理想情况下，此报告将导出为 .txt 或第三个 .xls 文件。

任何代码片段或示例将不胜感激！

下面是我在 .txt 中执行类似操作的代码，但是一旦遇到第一个差异，您就无法看到导致问题的记录。

```
f1 = open("AuditData.txt", "r")
f2 = open("AuditData2.txt", "r")

fileOne = f1.readlines()
fileTwo = f2.readlines()

f1.close()
f2.close()

outFile = open("AuditData3.txt", "w")
x = 0
for i in fileOne:
    if i != fileTwo[x]:
        outFile.write(i+" <> "+fileTwo[x])
    x += 1
outFile.close() 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T18:05:23.510

我会看看[熊猫图书馆](http://pandas.pydata.org/)。例如，如果我们从两个相似的文件开始：

```
>>> import pandas as pd
>>> 
>>> df0 = pd.ExcelFile("id_data1.xls").parse("Sheet1")
>>> df1 = pd.ExcelFile("id_data2.xls").parse("Sheet1")
>>> df0 = df0.set_index("ID")
>>> df1 = df1.set_index("ID")
>>> df0
    A  B
ID      
1   a  e
2   b  f
3   c  g
4   d  h
>>> df1
    A          B
ID              
1   a          e
2   b  nolongerf
4   d          h
5   g          h 
```

我们可以对齐它们，查看差异，然后将结果保存到 excel 文件中：

```
>>> a0, a1 = df0.align(df1)
>>> different = (a0 != a1).any(axis=1)
>>> comp = a0[different].join(a1[different], lsuffix='_old', rsuffix='_new')
>>> comp
   A_old B_old A_new      B_new
ID                             
2      b     f     b  nolongerf
3      c     g   NaN        NaN
5    NaN   NaN     g          h
>>> comp.to_excel("comparison.xls")
>>> 
```

等等。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:29:39.363

`xlrd`并且`xlwt`都是我已成功用于读取/写入 Excel 文档的 Python 库。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T18:09:26.207

如果 excel 文件只有一个或几个选项卡，那么您最简单的解决方案实际上是将每个单独的选项卡保存为单独的 csv，并使用现有工具，如`diff`在许多平台的命令行上可以正常工作，或在许多文本编辑器中，如vim、emacs 或记事本++。

```
$ diff file1.csv file2.csv 
```

[http://unixhelp.ed.ac.uk/CGI/man-cgi?diff](http://unixhelp.ed.ac.uk/CGI/man-cgi?diff)

如果您需要在大量文件上运行它，我仍然建议仅使用 python 作为脚本胶水，使用 sys 库重复调用 unix diff 程序。

显然，python在标准库中*确实*有一个“difflib”，但我以前从未使用过它，甚至没有听过任何人谈论它，但欢迎您查看它：[http://docs.python。 org/2/library/difflib.html](http://docs.python.org/2/library/difflib.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T17:49:55.867

几年前我遇到了类似的问题，最终选择了 C# 作为我的解决方案。在建立了一个基础的 .NET 环境之后，我可以毫不费力地直接访问 excel 电子表格的内容。

如果您决定使用 python，一种方法是使用 COM 对象来访问每个电子表格的详细信息：http: [//oreilly.com/catalog/pythonwin32/chapter/ch12.html](http://oreilly.com/catalog/pythonwin32/chapter/ch12.html)

我建议使用 C# 的原因是 .NET 具有专门为便于访问电子表格而设计的类。 [http://msdn.microsoft.com/en-us/library/7fzyhc74(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/7fzyhc74(v=vs.80).aspx)

# java - Java中队列的实现

> ID：15207327
> 
> 赞同：0
> 
> 时间：2013-03-04T17:25:11.780
> 
> 标签：java, oop, linked-list, queue

我只是好奇，我有一个实现队列的类，它目前有一个项目......我很好奇哪里是最有效或最干净的位置来初始化我希望添加到队列中的其他项目.. . 这是作业的一部分，所以请提供解释，而不仅仅是回答！在此先感谢...这是我建立的课程...

```
import java.util.*;

public class Queue<T> extends Node<T> {
    private LinkedList<T> list;

    // Queue constructor
    public Queue()  {
        // Create a new LinkedList.
        list = new LinkedList<T>();
    }
    //check if empty
    public boolean isEmpty() {
        return (list.size() == 0);
    }
    //add items to queue
    public void enqueue(Object item) {
        // Append the item to the end of our linked list.
        list.add((T) item);
    }
    //remove items from queue
    public T dequeue() {

        T item = list.get(1);
        list.remove(1);     
        // Return the item
        return item;
    }
    //check top item
    public T peek() {
        return list.get(1);
    }
    //check size of queue
    public int size() {
        return list.size();
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2017-02-20T07:43:00.887

这是您编写队列的方式：

```
/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package Queue;

import java.util.*;

/**
 *
 * @author Madhurlucky
 */
public class arrayQueue {

    public static int[] Queue;
    public static int len, front, rear, size;

    public arrayQueue(int n) {
        len = 0;
        size = n;
        front = -1;
        rear = -1;
        Queue = new int[size];
    }

    public boolean isEmpty() {
        return front == -1;
    }

    public boolean isFull() {
        return (front == 0 && rear == size - 1);
    }

    public int getsize() {
        return len;
    }

    public void insert(int i) {
        if (rear == -1) {
            rear = front = 0;
            Queue[rear] = i;
        } else if (rear + 1 >= size) {
            System.out.println("OverFlow Queue");
        } else if (rear + 1 < size) {
            Queue[++rear] = i;
        }
        len++;
    }

    public int remove() {
        int x = -99;
        if (front != -1) {
            x = Queue[front];
            if (front == rear) {
                front = rear = -1;
            } else if (front < rear) {
                front += 1;
            }
            len--;
        }
        return x;
    }

    /*  Function to check the front element of the queue */
    public int peek() {
        if (isEmpty()) {
            throw new NoSuchElementException("Underflow Exception");
        }
        return Queue[front];
    }

    public void display() {
        System.out.print("\nQueue = ");
        if (len == 0) {
            System.out.print("Empty\n");
            return;
        }
        for (int i = front; i <= rear; i++) {
            System.out.print(Queue[i] + " ");
        }
        System.out.println();
    }

    public static void main(String[] args) {
        Scanner scan = new Scanner(System.in);

        System.out.println("Array Queue Test\n");
        System.out.println("Enter Size of Integer Queue ");
        int n = scan.nextInt();
        /* creating object of class arrayQueue */
        arrayQueue q = new arrayQueue(n);
        /* Perform Queue Operations */
        char ch;
        do {
            System.out.println("\nQueue Operations");
            System.out.println("1\. insert");
            System.out.println("2\. remove");
            System.out.println("3\. peek");
            System.out.println("4\. check empty");
            System.out.println("5\. check full");
            System.out.println("6\. size");
            int choice = scan.nextInt();
            switch (choice) {
                case 1:
                    System.out.println("Enter integer element to insert");
                    try {
                        q.insert(scan.nextInt());
                    } catch (Exception e) {
                        System.out.println("Error : " + e.getMessage());
                    }
                    break;
                case 2:
                    try {
                        System.out.println("Removed Element = " + q.remove());
                    } catch (Exception e) {
                        System.out.println("Error : " + e.getMessage());
                    }
                    break;
                case 3:
                    try {
                        System.out.println("Peek Element = " + q.peek());
                    } catch (Exception e) {
                        System.out.println("Error : " + e.getMessage());
                    }
                    break;
                case 4:
                    System.out.println("Empty status = " + q.isEmpty());
                    break;
                case 5:
                    System.out.println("Full status = " + q.isFull());
                    break;
                case 6:
                    System.out.println("Size = " + q.getsize());
                    break;
                default:
                    System.out.println("Wrong Entry \n ");
                    break;
            }
            /* display Queue */
            q.display();
            System.out.println("\nDo you want to continue (Type y or n) \n");
            ch = scan.next().charAt(0);

        } while (ch == 'Y' || ch == 'y');
    }
} 
```

# azure - transactionScope 如何影响 Azure 队列？

> ID：15207328
> 
> 赞同：1
> 
> 时间：2013-03-04T17:25:16.100
> 
> 标签：azure, azure-storage, azure-storage-queues

如果在 transactionScope 内进行 Azure 队列事务（推送/弹出），是否需要提交它们，或者无论事务完整性如何都已完成？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T17:31:24.647

Azure 存储队列[不支持事务](https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-azure-and-service-bus-queues-compared-contrasted)，因此更改是即时的。

# ios - 使用带有 ios 5 核心数据并发的 RestKit 时崩溃

> ID：15207329
> 
> 赞同：0
> 
> 时间：2013-03-04T17:25:16.530
> 
> 标签：ios, core-data, restkit

我是 Core Data 的新手，也是 RestKit。

由于存在一些性能问题，我想在 ios5 中使用并发技术。但是，当它与 RestKit 结合时，就出现了崩溃问题。这是我的崩溃代码：

```
[[RKObjectManager sharedManager] getObjectsAtPath: HOT_PATH
                                       parameters: params
                                          success:
 ^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    NSManagedObjectContext *newContext = [[NSManagedObjectContext alloc] initWithConcurrencyType:NSPrivateQueueConcurrencyType];
     newContext.parentContext = [self managedContext];
     [newContext performBlock:^{

         Rumor *rumorInOtherContext = (Rumor *)[mappingResult.array lastObject];;
         Rumor *rumor = (Rumor *)[newContext objectWithID:rumorInOtherContext.objectID];

         rumor.updateDate = [NSDate date]; // <- crash at this point.
}]; 
```

但是，我的代码的旧版本不会崩溃：

```
[[RKObjectManager sharedManager] getObjectsAtPath: HOT_PATH
                                       parameters: params
                                          success:
 ^(RKObjectRequestOperation *operation, RKMappingResult *mappingResult) {
    Rumor *rumor = (Rumor *)[mappingResult.array lastObject];;
    rumor.updateDate = [NSDate date]; // <- save!
}]; 
```

控制台对话框中没有出现崩溃报告。:(

我的代码正确吗？或者，是否有其他方法可以做同样的事情？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:34:06.287

1.  您使用的是什么目标版本的 iOS？
2.  你用的是什么版本的 RK？

如果您的目标是 5.x，则不能将基于块的并发编程代码用于 Core Data 或父子上下文。（是的，它们在 5.x 中被合并到 iOS 中，但在 6.x 之前它不起作用并且不安全）

您可能想查看[GCD](http://developer.apple.com/library/ios/#documentation/Performance/Reference/GCD_libdispatch_Ref/Reference/reference.html)。

我对 RK 有很多问题，并决定放弃它，就像在这个问题中讨论的那样：

[RestKit 并作为 NSManagedObject 保存到 CoreData](https://stackoverflow.com/questions/14854641/restkit-and-saving-to-coredata-as-nsmanagedobject/15075931#15075931)

什么是堆栈跟踪（如果您在设备上遇到这种情况，将会有一个崩溃日志，您可以从 Window->Organizer->Devices 访问该日志）告诉您何时崩溃？？？

# sql-server - 将磁盘上的图像转换为 MSSQL 图像数据类型

> ID：15207332
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:25:27.107
> 
> 标签：sql-server, asp-classic

我在 Web 服务器的磁盘上有图像，我想用经典的 asp (vbscript) 编写一个脚本，该脚本将获取图像并将其保存在 MSSQL (2005) 数据库（图像数据类型列）中。SQL 数据库位于不同的服务器上

任何帮助，将不胜感激。

谢谢，

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:39:46.980

MSSQL 图像数据类型是“byte[]”数组

```
byte[] buffer = File.ReadAllBytes("Path to file"); 
```

现在使用此缓冲区插入 MSSQL 表图像列

现在 MSSQL 命令将是这样的

```
SqlCommand cmd = new SqlCommand("INSERT INTO <your_table_name> (ImageColumn) values (@parameter)");
cmd.Parameters.AdWithValues("@parameter",buffer); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T19:14:43.343

感谢您的帮助。我想我想出了如何在经典 ASP 中做到这一点

```
strFilePath = Server.MapPath("your file")

Set oConn = Server.CreateObject("ADODB.Connection")
With oConn 
.connectiontimeout = 0
.commandtimeout = 0
.connectionstring = <your connection string>
.cursorlocation = 3 'adUseClient
.open
End With

Set oStream = Server.CreateObject("ADODB.Stream")
oStream.Type = 1 'AdBinary
oStream.Open
oStream.LoadFromFile strFilePath
xBin = oStream.Read

Set oCmd = Server.CreateObject("ADODB.Command")
oCmd.ActiveConnection = oConn
strSql = "INSERT INTO dbo.YourTable (strImage) VALUES(?);"
oCmd.CommandText = strSql
oCmd.Parameters.Item(0) = xBin
Set oRs = oCmd.Execute
Set oRs = Nothing
Set oStream = Nothing
Set oConn = Nothing 
```

# url - Google 仅将特定域编入索引

> ID：15207333
> 
> 赞同：1
> 
> 时间：2013-03-04T17:25:29.243
> 
> 标签：url, dns, seo, indexing

我对 Google 索引有疑问。
问题是我有几个域（语言突变）示例：`www.example.com`, `www.example.co.uk`, `www.example.de`.

所以每个网站都有自己的语言和自己的 SEO 链接，例如：

*   `search/en-us/building/window/77/1/`
*   `search/en-gb/building/window/77/1/`
*   `search/de-de/gebaude/fenster/77/1/`

现在谷歌正在索引那些带有错误域的 SEO url 链接，`www.example.co.uk/search/de-de/gebaude/fenster/77/1/`显然应该是正确的：`www.example.de/search/de-de/gebaude/fenster/77/1/`

每种语言都绑定到自己的域，因此 EN-GB 不可能导致德语突变`www.example.de`

我愿意接受所有建议。先感谢您。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:40:47.703

这种事情会发生。创建坏链接比您想象的要容易。一个硬编码的域名放错了地方，而您有一个链接到您不想链接的地方。一旦 Googlebot 发现在错误域上提供的网站，它就会抓取整个网站。即使您是正确的，您**永远不会**创建这样的链接，也许用户创建了一个外部链接，他们在其中混淆了域名。

您需要应用的技术称为**URL 规范化**。你有两个选择：

*   将 rel 规范元标记放在您的每个页面上。 `search/de-de/gebaude/fenster/77/1/` 将在具有正确域的标记中具有规范 URL：`http://www.example.de/search/de-de/gebaude/fenster/77/1/` 您必须确保规范标记中的`.de`域是域，无论该页面是在`.co.uk`域上还是在`.de`域上访问的。
*   使用 301 重定向来更正任何错误的 URL。让您的服务器检测到域名错误。301重定向`www.example.co.uk/search/de-de/gebaude/fenster/77/1/`到`www.example.de/search/de-de/gebaude/fenster/77/1/`

另一个随机的 SEO 建议：我会从你的 URL 中删除“搜索”这个词。Google 不喜欢在其搜索结果中将网站搜索结果编入索引。我见过这样的情况，它假定 URL 中的“搜索”一词表明该页面不应因此而被编入索引。

# java - 如何更改枚举的 IntelliJ 12 重新格式化行为？

> ID：15207343
> 
> 赞同：3
> 
> 时间：2013-03-04T17:26:16.887
> 
> 标签：java, enums, intellij-idea, autoformatting

IntelliJ 的重新格式化代码选项 (ctrl+alt+l) 在枚举声明中添加了额外的行。它将改变这一点：

```
public enum Day {MON, TUE, FRI}; 
```

对此：

```
public enum Day {MON, TUE, FRI}

; 
```

如何更改重新格式化的行为以不添加额外的空白？我无法在代码样式设置 ( `File -> Settings -> Code Styles -> Java`) 中找到枚举。

***更新：**事实证明，IntelliJ 将枚举和分号视为两个单独的语句，这显然是因为枚举声明不需要分号。IntelliJ 在类声明（枚举）之后添加一个空行，然后显示分号。删除分号解决了我的问题。*

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-03-04T18:16:49.177

找到一个名为`Code Style -> java -> 'Wrapping and Braces'`. 在列表中有最新的元素称为`'Enum constants'`

![在此处输入图像描述](../Images/313fd922c8ec6258009e873a8b333c62.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T17:31:55.160

它不是也给你一个警告说分号是不必要的吗？它对我有用。如果您删除分号，是否可以解决您的问题？它不会以这种方式创建不必要的空白。

# javascript - 如何使 JavaScript 代码在另一个之前运行

> ID：15207344
> 
> 赞同：0
> 
> 时间：2013-03-04T17:26:28.503
> 
> 标签：javascript, html, adsense

由于 AdSense 脚本，我的脚本出现问题...当 AdSense 脚本无法加载时，我的脚本运行良好，但如果 AdSense 加载，我的脚本无法加载。而且我知道我的脚本在 AdSense 脚本之后运行。

所以我在想，如果我的脚本在 AdSense 脚本运行之前运行（因为是一个将 pre 标记更改为表格的脚本，因此它只会更改布局），所有内容都会加载，而不仅仅是加载 AdSense ...

我的 javascript 是：

```
window.onload = function(){
var preElements = document.getElementsByTagName('pre');
var codeLine = new Array();
var newContent

for(var i = 0; i < preElements.length; ++ i)
{
    var element = preElements[i];
    newContent='<div align="center"><table width="75%" border="1" cellpadding="0" cellspacing="0" >'

    codeLine = element.innerHTML.split('\n');

    for(var j=0 ; j < codeLine.length ; j++){
        newContent = newContent + '<tr><td width="30" class="codeNumber" >' + j.toString() + ' </td><td class="codeTab"> ' + codeLine[j] + '</td></tr>';
    }

    newContent = newContent + '</table></div>';
    element.innerHTML = newContent;

}

} 
```

它加载在 Head 部分，AdSense 加载在一个单元格内，我只有一个广告空间。我无法为单元格提供 ID，因为 AdSense 不是单元格上唯一的东西……还有一件事……调用 AdSense 的地方与我有 pre 标签的地方完全不同

已解决：首先，我对此真的了解不多，经过一番研究，我发现了问题所在。1º AdSense 存在连接问题，因此在它之后运行的所有脚本都不会加载 2º 如果您在其中有“window.onload”，那么脚本的位置并不重要......我想该功能在窗口加载时起作用，但实际上，它会在窗口完全加载后起作用，这就是它与 AdSense 发生冲突的原因。

你们帮助我更快地看到了这些东西！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:27:10.863

通常，大多数人将广告和分析代码包含在结束`</body>`标记之前。

你应该尽量避免你的代码出现竞争条件，从加载到执行它应该是事件驱动和模块化的。如果 Adsense 需要进入由另一个脚本设置的容器中，那么让另一个脚本在完成更新 DOM 时加载 Adsense 是有意义的，作为回调。像这样的东西：

```
function loadAdsense(elementId) {

    var js = document.createElement('script');
    js.src = 'http://pagead2.googlesyndication.com/pagead/show_ads.js';

    window.google_ad_client = 'ca-pub-xxxxxxxxxxxx';
    window.google_ad_slot   = '1234567890';
    window.google_ad_width  = 336;
    window.google_ad_height = 280;

    document.getElementById(elementId).appendChild(script);
}

function preToTable() {
    // set PRE to TABLE - id = myNewTable
    // then load Adsense
    loadAdsense('myNewTable');
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:33:01.700

您应该将 javascript 放在 head 标记中，并将 AdSense 代码放在内容的末尾。另一种解决方案是在您的第一个脚本完成后使用 javascript 事件来打印 AdSense 脚本。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-05T15:07:02.980

已解决：首先，我对此真的了解不多，经过一番研究，我发现了问题所在。1º AdSense 存在连接问题，因此在它之后运行的所有脚本都不会加载 2º 如果您在其中有“window.onload”，那么脚本的位置并不重要......我想该功能在窗口加载时起作用，但实际上，它会在窗口完全加载后起作用，这就是它与 AdSense 发生冲突的原因。

# css - rotate3d 速记

> ID：15207351
> 
> 赞同：81
> 
> 时间：2013-03-04T17:26:38.083
> 
> 标签：css, css-transforms

如何`rotateX(50deg) rotateY(20deg) rotateZ(15deg)`在速记中结合`rotate3d()`？

* * *

## 回答 #1

> 赞同：315
> 
> 时间：2013-03-04T18:51:06.220

`rotateX(50deg)`相当于`rotate3d(1, 0, 0, 50deg)`

`rotateY(20deg)`相当于`rotate3d(0, 1, 0, 20deg)`

`rotateZ(15deg)`相当于`rotate3d(0, 0, 1, 15deg)`

所以...

`rotateX(50deg) rotateY(20deg) rotateZ(15deg)`

相当于

`rotate3d(1, 0, 0, 50deg) rotate3d(0, 1, 0, 20deg) rotate3d(0, 0, 1, 15deg)`

* * *

对于泛型`rotate3d(x, y, z, α)`，您有矩阵

![通用旋转矩阵](../Images/c2a2d03038ae0891991343a6ee6e7644.png)

在哪里

![解释](../Images/767cf0316b158f97cbb8d667ddce8def.png)

* * *

您现在获得了 3 个变换中的每一个的矩阵，`rotate3d`并将它们相乘。并且得到的矩阵是对应于得到的 single 的矩阵`rotate3d`。不知道如何轻松地从中提取值`rotate3d`，但肯定很容易为单个`matrix3d`.

* * *

在第一种情况下（`rotateX(50deg)`或`rotate3d(1, 0, 0, 50deg)`），您有：

`x = 1`, `y = 0`, `z = 0`,`α = 50deg`

所以在这种情况下矩阵的第一行是`1 0 0 0`。

第二个是`0 cos(50deg) -sin(50deg) 0`。

第三个`0 sin(50deg) cos(50deg) 0`。

而第四个显然是`0 0 0 1`。

* * *

在第二种情况下，您有`x = 0`, `y = 1`, `z = 0`, `α = 20deg`。

第一行：`cos(20deg) 0 sin(20deg) 0`。

第二行：`0 1 0 0`。

第三行：`-sin(20) 0 cos(20deg) 0`。

第四：`0 0 0 1`

* * *

在第三种情况下，您有`x = 0`, `y = 0`, `z = 1`, `α = 15deg`。

第一行：`cos(15deg) -sin(15deg) 0 0`。

第二排`sin(15deg) cos(15deg) 0 0`。

第三和第四行分别是`0 0 1 0`和`0 0 0 1`。

* * *

***注意****：您可能已经注意到 rotateY 变换的 sin 值的符号与其他两个变换不同。这不是计算错误。这样做的原因是，对于屏幕，y 轴指向下方，而不是向上。*

* * *

因此，这些是`4x4`您需要相乘的三个矩阵，以便获得`4x4`用于生成的单个`rotate3d`变换的矩阵。正如我所说，我不确定取出这 4 个值有多容易，但 4x4 矩阵中的 16 个元素正是`matrix3d`链式变换等效项的 16 个参数。

* * *

**编辑**：

实际上，事实证明这很容易......您计算矩阵的矩阵的迹线（对角线元素的总和）`rotate3d`。

`4 - 2*2*(1 - cos(α))/2 = 4 - 2*(1 - cos(α)) = 2 + 2*cos(α)`

然后，您计算三个`4x4`矩阵的乘积的迹线，将结果等同于`2 + 2*cos(α)`您 extract `α`。然后计算`x`, `y`, `z`.

在这种特殊情况下，如果我计算正确，则由三个`4x4`矩阵的乘积产生的矩阵轨迹将是：

```
T = 
cos(20deg)*cos(15deg) + 
cos(50deg)*cos(15deg) - sin(50deg)*sin(20deg)*cos(15deg) + 
cos(50deg)*cos(20deg) + 
1 
```

所以`cos(α) = (T - 2)/2 = T/2 - 1`，这意味着`α = acos(T/2 - 1)`。

* * *

## 回答 #2

> 赞同：15
> 
> 时间：2013-03-04T17:39:16.697

句法：

```
rotate3d(x, y, z, a) 
```

价值观：

*   `x``<number>`描述表示旋转轴的向量的 x 坐标 。
*   `y` 是`<number>`描述表示旋转轴的向量的 y 坐标。
*   `z` 是`<number>`描述表示旋转轴的矢量的 z 坐标。
*   `a` 是一个`<angle>`表示旋转的角度。正角表示顺时针旋转，负角表示逆时针旋转。

像 ：

```
.will-distort{
    transform:rotate3d(10, 10, 10, 45deg);
} 
```

[在这里摆弄](http://jsfiddle.net/wvYKZ/)

[Caniuse 在这里](http://caniuse.com/#feat=transforms3d)

[更多关于它的文档](http://msdn.microsoft.com/en-us/library/ie/hh673529%28v=vs.85%29.aspx#the_ms_transform_style_property)

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2015-03-07T04:27:51.417

取决于你想要做什么，这个“黑客”可以帮助你。假设您正在制作动画，并且您希望在转换之后添加转换等等，并且您不希望 CSS 看起来像是在进行 100 次转换：

这适用于 chrome： 1\. 将您想要的任何变换应用于元素。2\. 下次要添加变换时，将其添加到计算的变换中：“window.getComputedStyle(element).transform” - 但确保将新变换放在左侧。3\. 现在你的变换看起来像“rotateZ(30deg) matrix3d(......)。 4\. 下次你想添加另一个变换时，重复这个过程 - Chrome 总是将变换简化为 matrix3d 表示法。

TL;DR- 应用你想要的任何变换，然后得到计算的 matrix3d 变换。

这个技巧还可以让您快速（即，无需自己进行任何数学运算）创建一个功能，使对象相对于您的参考系在任何方向上旋转。请参阅下面的示例：

**编辑**：我也添加了 xyz 翻译。使用它，将对象放置在特定方向的特定 3d 位置将非常容易。或者......想象一个立方体反弹并改变它的旋转轴，每次反弹取决于它的着陆方式！

```
 var boxContainer = document.querySelector('.translator'),
	    cube = document.getElementById('cube'),
	    optionsContainer = document.getElementById('options');
	var dims = ['x', 'y', 'z'];
	var currentTransform;
	var currentTranslate;
	var init = function () {
	    optionsContainer.querySelector('.xRotation input')
	        .addEventListener('input', function (event) {
	        if (currentTransform != 'none') {
	            var newTransform = 'rotateX(' + (360 - event.target.value) + 'deg) ' + currentTransform;
	        } else {
	            var newTransform = 'rotateX(' + (360 - event.target.value) + 'deg)';
	        }
	        cube.style.transform = newTransform;
	    }, false);

	    optionsContainer.querySelector('.yRotation input')
	        .addEventListener('input', function (event) {
	        if (currentTransform != 'none') {
	            var newTransform = 'rotateY(' + (360 - event.target.value) + 'deg) ' + currentTransform;
	        } else {
	            var newTransform = 'rotateY(' + (360 - event.target.value) + 'deg)';
	        }
	        cube.style.transform = newTransform;
	    }, false);

	    optionsContainer.querySelector('.zRotation input')
	        .addEventListener('input', function (event) {

	        if (currentTransform != 'none') {
	            var newTransform = 'rotateZ(' + (360 - event.target.value) + 'deg) ' + currentTransform;
	        } else {
	            var newTransform = 'rotateZ(' + (360 - event.target.value) + 'deg)';
	        }
	        cube.style.transform = newTransform;
	    }, false);

	    optionsContainer.querySelector('.xTranslation input')
	        .addEventListener('input', function (event) {

	        if (currentTranslate != 'none') {
	            var newTransform = 'translateX(' + (100 - event.target.value) + 'px) ' + currentTranslate;
	        } else {
	            var newTransform = 'translateX(' + (100 - event.target.value) + 'px)';
	        }
	        boxContainer.style.transform = newTransform;
	    }, false);

	    optionsContainer.querySelector('.yTranslation input')
	        .addEventListener('input', function (event) {

	        if (currentTranslate != 'none') {
	            var newTransform = 'translateY(' + (100 - event.target.value) + 'px) ' + currentTranslate;
	        } else {
	            var newTransform = 'translateY(' + (100 - event.target.value) + 'px)';
	        }
	        boxContainer.style.transform = newTransform;
	    }, false);
	    optionsContainer.querySelector('.zTranslation input')
	        .addEventListener('input', function (event) {

	        if (currentTranslate != 'none') {
	            var newTransform = 'translateZ(' + (500 - event.target.value) + 'px) ' + currentTranslate;
	        } else {
	            var newTransform = 'translateZ(' + (500 - event.target.value) + 'px)';
	        }
	        boxContainer.style.transform = newTransform;
	    }, false);

reset();

	};

	function reset() {
	    currentTransform = window.getComputedStyle(cube).transform;
	    currentTranslate = window.getComputedStyle(boxContainer).transform;
	    optionsContainer.querySelector('.xRotation input').value = 360;
	    optionsContainer.querySelector('.yRotation input').value = 360;
	    optionsContainer.querySelector('.zRotation input').value = 360;
	    optionsContainer.querySelector('.xTranslation input').value = 100;
	    optionsContainer.querySelector('.yTranslation input').value = 100;
	    optionsContainer.querySelector('.zTranslation input').value = 500;

	}

	window.addEventListener('DOMContentLoaded', init, false);
	document.addEventListener('mouseup', reset, false);
```

```
.translator
{
	height: 200px;
	position: absolute;
	width: 200px;
    transform-style: preserve-3d;
}
.threeSpace
{
	height: 200px;
	moz-perspective: 1200px;
	o-perspective: 1200px;
	perspective: 200px;
	position: absolute;
	transform-origin: 50px 50px 100px;
	webkit-perspective: 1200px;
	width: 100px;
    perspective-origin: 100px 25px;
    transform-style: preserve-3d;
}
#pointer{
    position:relative;
    height:2px;
    width:2px;
    top:25px;
    left:100px;
    background:blue;
    z-index:9999;

}

#cube
{
	height: 100%;
	moz-transform-origin: 90px 110px 0px;
	moz-transform-style: preserve-3d;
	o-transform-origin: 90px 110px 0px;
	o-transform-style: preserve-3d;
	position: absolute;
	transform-origin: 90px 110px 0px;
	transform-style: preserve-3d;
	webkit-transform-origin: 90px 110px 0px;
	webkit-transform-style: preserve-3d;
	width: 100%;
}
#cube .midPoint{
    position:absolute;
    top:48px;
    left:48px;
    height:1px;
    width:1px;
    background:green;
}

#cube figure
{
	border: 2px solid black;
	color: white;
	display: block;
	font-size: 60px;
	font-weight: bold;
	height: 96px;
	line-height: 96px;
	position: absolute;
	text-align: center;
	width: 96px;
    /* transform-style: preserve-3d; */
}
#cube .front
{
	background: hsl(0, 100%, 50%);
}

#cube .back
{
	background: hsl(60, 100%, 50%);
}
#cube .right
{
	background: hsl(120, 100%, 50%);
}
#cube .left
{
	background: hsl(180, 100%, 50%);
}
#cube .top
{
	background: hsl(240, 100%, 50%);
}
#cube .bottom
{
	background: hsl(300, 100%, 50%);
}
#cube .front
{
	moz-transform: translateZ(50px);
	o-transform: translateZ(50px);
	transform: translateZ(50px);
	webkit-transform: translateZ(50px);
}

#cube .back
{
	moz-transform: rotateX(-180deg) translateZ(50px);
	o-transform: rotateX(-180deg) translateZ(50px);
	transform: rotateX(-180deg) translateZ(50px);
	webkit-transform: rotateX(-180deg) translateZ(50px);
}
#cube .right
{
	moz-transform: rotateY(90deg) translateZ(50px);
	o-transform: rotateY(90deg) translateZ(50px);
	transform: rotateY(90deg) translateZ(50px);
	webkit-transform: rotateY(90deg) translateZ(50px);
}
#cube .left
{
	moz-transform: rotateY(-90deg) translateZ(50px);
	o-transform: rotateY(-90deg) translateZ(50px);
	transform: rotateY(-90deg) translateZ(50px);
	webkit-transform: rotateY(-90deg) translateZ(50px);
}
#cube .top
{
	moz-transform: rotateX(90deg) translateZ(50px);
	o-transform: rotateX(90deg) translateZ(50px);
	transform: rotateX(90deg) translateZ(50px);
	webkit-transform: rotateX(90deg) translateZ(50px);
}
#cube .bottom
{
	moz-transform: rotateX(-90deg) translateZ(50px);
	o-transform: rotateX(-90deg) translateZ(50px);
	transform: rotateX(-90deg) translateZ(50px);
	webkit-transform: rotateX(-90deg) translateZ(50px);
}
#options{
    position:absolute;
    width:80%;
    top:40%;

}
#options input
{
	width: 60%;
}
```

```
<body>

     <div class="threeSpace">
         <div id="pointer"></div>
    <div class="translator">
        <div id="cube">
            <figure class="front"><div class='midPoint'></div></figure>
            <figure class="back"></figure>
            <figure class="right"></figure>
            <figure class="left"></figure>
            <figure class="top"></figure>
            <figure class="bottom"></figure>
        </div>
    </div>
    </div>
    <section id="options">
        <p class="xRotation">
            <label>xRotation</label>
            <input type="range" min="0" max="720" value="360" data-units="deg" />
        </p>
        <p class="yRotation">
            <label>yRotation</label>
            <input type="range" min="0" max="720" value="360" data-units="deg" />
        </p>
        <p class="zRotation">
            <label>zRotation</label>
            <input type="range" min="0" max="720" value="360" data-units="deg" />
        </p>
        <p class="xTranslation">
            <label>xTranslation</label>
            <input type="range" min="0" max="200" value="100" data-units="deg" />
        </p>
        <p class="yTranslation">
            <label>yTranslation</label>
            <input type="range" min="0" max="200" value="100" data-units="deg" />
        </p>
        <p class="zTranslation">
            <label>zTranslation</label>
            <input type="range" min="0" max="1000" value="500" data-units="deg" />
        </p>
    </section>
</body>
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-03-04T18:09:11.073

确切的值是`rotate3d(133,32,58,58deg)`

查看[小提琴](http://jsfiddle.net/Qqe7j/)（对于 chrome 和 Safari，使用 -webkit-transform）

# jquery - 有效方法如果返回 true，则不会清除错误消息

> ID：15207353
> 
> 赞同：2
> 
> 时间：2013-03-04T17:26:47.160
> 
> 标签：jquery, jquery-validate

我提交的是空表单，其中一个字段无效。比我更改表单中的某些内容（不适用于当前的无效字段）并在代码中为我的无效字段调用验证：

```
$('.myinvalidfield').valid() 
```

它返回我这个字段是有效的，但不会删除它的验证错误消息。我应该怎么做才能修复它？（我不想手动删除消息和错误类。可以使用设置或 JQuery 吗？）

*更新。*

我有两个字段，第一个元素不是必需的，只有当第一个为空时才需要第二个。我使用这个规则：

一、必填字段：

```
 required: function (element) {
        var secondElement = $(selector);
        var value = secondElement.val();
        return value == ""; //if second (not required) field has value, that current element is not required
    }, 
```

二、非必填字段：

```
 required: function (element) {
        var secondElement = $(selector);
        if (secondElement.length == 0) return false; //becouse my forms builds dynamicly
        secondElement.valid(); //invoke validation for required field
        return false;
    } 
```

此规则有效，但如果我提交带有空字段的表单，它会向我显示所需字段的一个错误，并且当我首先更改非必填字段时，所有表单都是有效的，但错误消息不会从第二个元素中消失。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:41:14.107

默认情况下，当字段变为有效时，所有错误都会自动清除。

**演示：http: [//jsfiddle.net/d55hj/](http://jsfiddle.net/d55hj/)**

* * *

**编辑**：

根据 OP：

> “我有两个字段，第一个元素不是必需的，只有当第一个为空时才需要第二个。”

试试这个简化版...

```
$(document).ready(function () {

    $('#myform').validate({ // initialize the plugin
        rules: {
            field2: {
                required: function () {
                    return $('#field1').is(':blank');
                }
            }
        }
    });

}); 
```

**HTML**：

```
<form id="myform">
    <input type="text" name="field1" id="field1" />
    <input type="text" name="field2" id="field2" />
    <input type="submit" />
</form> 
```

**演示：http: [//jsfiddle.net/d55hj/4/](http://jsfiddle.net/d55hj/4/)**

* * *

否则，您将不得不[创建一个自定义方法](http://docs.jquery.com/Plugins/Validation/Validator/addMethod#namemethodmessage)来更精确地控制一切......

```
$(document).ready(function () {

    jQuery.validator.addMethod('customrule', function (value, element) {
        if ($('#field1').val() === "" && $('#field2').val() === "") {
            return false;
        } else {
            $('label.error').hide();
            return true;
        }
    }, "Please fill out field #2 when field #1 is empty");

    $('#myform').validate({ // initialize the plugin
        groups: {  // use 'groups' option to combine both error messages into one
            name: "field1 field2"
        },
        rules: {
            field1: {
                customrule: true
            },
            field2: {
                customrule: true
            }
        }
    });

}); 
```

**工作演示：http: [//jsfiddle.net/d55hj/7/](http://jsfiddle.net/d55hj/7/)**

# jquery - jquery：仅在特定条件不发生时才在一段时间间隔后执行函数

> ID：15207355
> 
> 赞同：-4
> 
> 时间：2013-03-04T17:27:06.083
> 
> 标签：jquery

我有一个jquery函数！

当用户点击一个 div 时，该函数就会被执行！如果用户在 5 秒内单击 div，我不希望该函数再次执行。

这可能是什么解决方案？

帮助表示赞赏。谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:29:35.667

一个简单的计时器会限制 5 秒的点击。见下文，

```
var isClickAllowed = true;
$(element).click (function () {
    if (!isClickAllowed) return false;

    setTimeout(function () {
      isClickAllowed = true;
    }, 5000);
    isClickAllowed = false;
}); 
```

# c++ - 我可以将 C++ 与 UDK 一起使用吗？

> ID：15207361
> 
> 赞同：2
> 
> 时间：2013-03-04T17:27:41.803
> 
> 标签：c++, unreal-development-kit

我可以将 C++ 与 UDK 一起使用吗？我知道他们在他们的页面上提到了 unrealscript，但我也听说可以使用 C++，是这样吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T21:16:32.300

这取决于。如果您使用 UDK 的免费版本，您不能用 C++ 编写游戏代码，但您可以包含可以用 C++ 编写的自写 DLL。

如果您成为被许可人，您将获得虚幻引擎 3 的 C++ 源代码，然后能够使用 C++ 进行编程。

但是获取源代码非常昂贵，如果我没记错的话，要花好几笔钱，所以你可能大部分时间都在使用 UnrealScript。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-04T08:24:56.130

有关如何使用 DLL 的更多信息： [Calling DLLs from UnrealScript (DLLBind)](http://udn.epicgames.com/Three/DLLBind.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-04-01T10:01:30.810

虚幻引擎 4 最近发布，每月 20 美元 + 5% 的利润，您可以访问它的源代码，您可以将其与您的代码一起编译。

但是，您不会找到 UnrealScript 组件，唯一可用的脚本解决方案是基于 GUI 的类似 Kismet 的东西。

# c# - 如何：WCF 服务检查 Windows 窗体用户是否仍处于活动状态？

> ID：15207364
> 
> 赞同：1
> 
> 时间：2013-03-04T17:27:49.297
> 
> 标签：c#, winforms, session, windows-mobile

我有以下场景：一个 Windows Mobile 6.1 (.NET Compact Framwork 2.0) Forms 应用程序（同时在多个设备上运行），它使用来自服务器的多个 WCF 服务。要使用 windows 窗体应用程序，用户必须登录。

服务器使用来自 SAP 系统的数据。WCF 服务器必须根据记录的用户从 SAP 检索一些信息。因此，我的 Windows 窗体应用程序必须（不时）显示它们仍在运行到我的 WCF 服务器。

我能做些什么来完成这项任务？我正在考虑创建一个更新 WCF 服务器的 SQL 服务器的后台任务。（如会话控制）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T15:47:39.670

您可以侦听应用程序中的[电源状态](http://msdn.microsoft.com/en-us/library/aa929251.aspx)更改。文档显示它仅适用于 Windows Mobile 6.5，但我在运行 .NET CF 3.5 的 Windows Mobile 5.0 应用程序中使用它。

就像手机一样，如果移动设备长时间不使用，操作系统会显示电池处于同一水平，直到它真正被使用。所以，不是很靠谱。

但是，您可以侦听事件（[如 POWER_STATE_CRITICAL](http://msdn.microsoft.com/en-us/library/aa931596.aspx)等）并让您的软件进行相应的更改以与您的 WCF 服务器交互。

下面是我使用的东西的编辑版本。

这不会 100% 解决您的问题，但它应该让您了解如何做您需要的事情。

```
using Microsoft.WindowsMobile.Status;

BatteryLevel _batteryLevel;
BatteryState _batteryState;

void Mobile5_Load(object sender, EventArgs e) {
  _batteryLevel = (BatteryLevel)SystemState.GetValue(SystemProperty.PowerBatteryStrength);
  _batteryState = (BatteryState)SystemState.GetValue(SystemProperty.PowerBatteryState);
  if (!BatteryCritical(false)) {
    // Continue
  }
}
/// <summary>
/// Sets the Battery Level and Battery State for the Mobile Device
/// <para><value>showDialog=True show the dialog box</value></para>
/// <para><value>Returns True <b>if</b> the battery is in a critical state</value></para>
/// </summary>
/// <param name="showDialog">Do you want a dialog box to be displayed or not?</param>
/// <returns>false if the Battery is NOT in the critical state</returns>
bool BatteryCritical(bool showDialog) {
  _batteryAlert = false;
  bool bad = false; // everything starts out ok. We are actually running, after all.
  _batteryLevel = (BatteryLevel)SystemState.GetValue(SystemProperty.PowerBatteryStrength);
  _batteryState = (BatteryState)SystemState.GetValue(SystemProperty.PowerBatteryState);
  bool present = ((_batteryState & BatteryState.NotPresent) != BatteryState.NotPresent);
  bool charging = ((_batteryState & BatteryState.Charging) == BatteryState.Charging);
  bool critical = ((_batteryState & BatteryState.Critical) == BatteryState.Critical);
  bool lowbatry = ((_batteryState & BatteryState.Low) == BatteryState.Low);
  Color c;
  if (present) {
    if (charging) {
      c = Color.Cyan;
    } else {
      if (critical) {
        c = Color.Orange;
        _batteryAlert = true;
      } else if (lowbatry) {
        c = Color.Yellow;
        _batteryAlert = true;
      } else {
        c = Color.White;
      }
    }
  } else {
    c = Color.Silver;
  }
  StatusPanel.BackColor = c;
  switch (_batteryLevel) {
    case BatteryLevel.VeryHigh: // (81-100%)
      BatteryPanel.BackColor = Color.Cyan;
      break;
    case BatteryLevel.High: // (61-80%)
      BatteryPanel.BackColor = Color.Lime;
      break;
    case BatteryLevel.Medium: // 41-60%)
      BatteryPanel.BackColor = Color.Yellow;
      break;
    case BatteryLevel.Low: // (21-40%)
      BatteryPanel.BackColor = Color.Orange;
      //WirelessUpdate(RadioState.Off, false);
      break;
    case BatteryLevel.VeryLow: // (0-20%)
      BatteryPanel.BackColor = Color.Red;
      //WirelessUpdate(RadioState.Off, false);
      bad = (!charging && present);
      break;
  }
  if (showDialog) {
    string msg = string.Format("Level is {0}\r\nState is {1}", _batteryLevel, _batteryState);
    if (_batteryLevel == BatteryLevel.Low) {
      msg += "\r\n\r\nThe wireless radio will be inactive until it has been charged.";
    } else if (bad == true) {
      msg += "\r\n\r\nThis Application will now close to preserve the device. Please return it to a charging base immediately.";
    }
    MessageBox.Show(msg, "Battery Meter", MessageBoxButtons.OKCancel, MessageBoxIcon.None, 0);
  }
  if (!bad) {
    StatusPanel.Refresh();
    // You could signal your app here
  } else {
    // Tell your app this device needs to turn off now.
  }
  return bad;
} 
```

# ios - 在 Xcode 中导出为 Xcode 存档有什么意义？

> ID：15207367
> 
> 赞同：3
> 
> 时间：2013-03-04T17:27:50.743
> 
> 标签：ios, xcode

如果我导出它，我能用它做什么？

# c# - 预期的 LINQ 类型

> ID：15207369
> 
> 赞同：4
> 
> 时间：2013-03-04T17:27:56.577
> 
> 标签：c#, xml, linq

有以下 linq 代码，尝试将 xml 文件解析为数据表，但我在生成的数据表中得到奇怪的值，所有单元格值显示为

```
System.Xml.Ling.XContainer+<GetElements>d_11 
```

这是我的 LINQ

```
 XDocument doc1 = XDocument.Load(@"D:\m.xml");
            var q = from address in doc1.Root.Elements("Address")
                    let name = address.Elements("Name")
                    let street = address.Elements("Street")
                    let city = address.Elements("city")
                    select new
                    {
                        Name = name,
                        Street = street,
                        City = city
                    };

            var xdt = new DataTable();

            xdt.Columns.Add("Name", typeof(string));
            xdt.Columns.Add("Street", typeof(string));
            xdt.Columns.Add("City", typeof(string));

            foreach (var address in q)
            {
                xdt.Rows.Add(address.Name, address.Street, address.City);
            }

            dataGrid1.ItemsSource = xdt.DefaultView; 
```

这是我的xml：

```
<PurchaseOrder PurchaseOrderNumber="99503" OrderDate="1999-10-20">
  <Address Type="Shipping">
    <Name>Ellen Adams</Name>
    <Street>123 Maple Street</Street>
    <City>Mill Valley</City>
    <State>CA</State>
    <Zip>10999</Zip>
    <Country>USA</Country>
  </Address>
  <Address Type="Billing">
    <Name>Tai Yee</Name>
    <Street>8 Oak Avenue</Street>
    <City>Old Town</City>
    <State>PA</State>
    <Zip>95819</Zip>
    <Country>USA</Country>
  </Address>
</PurchaseOrder> 
```

这是我得到的结果！ ![在此处输入图像描述](../Images/6a2334bcf78845d79c6f75c4bf325ea7.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:32:13.450

您忘记恢复 XElements 的内部文本。因此，您正在选择具有属性等的整个元素。使用这部分代码：

```
var q = from address in doc1.Root.Elements("Address")
let name = address.Element("Name")
let street = address.Element("Street")
let city = address.Element("city")
select new
{
    Name = name.Value,
    Street = street.Value,
    City = city.Value
}; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T17:31:33.417

`address.Elements("Name")`是“名称”类型的所有元素的*集合*。碰巧在您的情况下，它是一个大小的集合，但它仍然是一个集合。您想从该集合中获取第一项（因为您知道它将是唯一一项），然后获取该元素的文本值。如果你使用`Element`而不是`Elements`你会得到第一个匹配的项目，而不是项目的集合。

现在您有了单个元素，您还需要获取该元素的值，而不是元素本身（在一般情况下它还包含许多其他信息，即使在这种特殊情况。

```
var q = from address in doc1.Root.Elements("Address")
        select new
        {
            Name = address.Element("Name").Value,
            Street = address.Element("Street").Value,
            City = address.Element("City").Value
        }; 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:30:24.937

这对你有什么作用？

```
 var q = from address in doc1.Root.Elements("Address")
                let name = (string)(address.Element("Name"))
                let street = (string)(address.Element("Street"))
                let city = (string)(address.Element("city")) 
                //... 
```

[http://msdn.microsoft.com/en-us/library/bb155263.aspx](http://msdn.microsoft.com/en-us/library/bb155263.aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T17:32:46.393

您正在调用`Elements`which 返回包装在帮助器类中的 n 个元素。

您可能的意思是调用`Element`which 将第一个元素作为`XElement`对象返回。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T17:33:02.713

试试这个：

```
var q = from address in doc1.Root.Elements("Address")
        let name = address.Element("Name").Value
        let street = address.Element("Street").Value
        let city = address.Element("City").Value 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-03-04T17:36:35.953

改成等等`address.Elements("Name")`。`address.Elements("Name").FirstOrDefault()`

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-03-04T17:38:51.130

Elements 方法返回一个 IEnumerable。因此，您的 let 变量指向一系列元素，而不是单个元素。您应该获取返回的单个元素，这将是一个 XElement，然后获取其 Value 属性以获取其内容的连接文本。（根据文档）

代替

```
 select new
                    {
                        Name = name,
                        Street = street,
                        City = city
                    } 
```

你应该写：

```
 select new
                    {
                        Name = name.Single().Value,
                        Street = street.Single().Value,
                        City = city.Single().Value
                    } 
```

要么在那里，要么直接在 let 表达式中。您可能还会发现一个有用的辅助方法：

```
 public static string StringValueOfElementNamed(XElement node, string elementName) {
        return node.Elements(elementName).Single().Value;
    } 
```

如果您希望使用成员访问语法，请将此帮助方法转换为扩展方法。

**编辑：**阅读并发答案后，更好的使用方法是：

```
 public static string StringValueOfElementNamed(XElement node, string elementName) {
        return node.Element(elementName).Value;
    } 
```

Element 返回第一个找到的元素。注意没有找到元素时返回的空指针。

# javascript - JavaScript Regexp - 允许回车让其他不需要的字符验证

> ID：15207371
> 
> 赞同：2
> 
> 时间：2013-03-04T17:27:59.667
> 
> 标签：javascript, regex, carriage-return

我有一个文本区域，我只想在其中允许 az 0-9 \s .,- 和 \r \n

我正在使用 JQuery 3rd 方插件。这就是我对验证规则的要求：

```
 jQuery("#description").validate({
        expression: "if (VAL.match(/^[a-z0-9 ,.-]*$/gi)) return true; else return false;",
        message: "Only: a-z 0-9 period comma dash space"
    }); 
```

这适用于 az 0-9 ，.-

但是，当我在这些 sq.brackets 中添加 \r 时，它允许输入验证哪个不会抛出消息，但用户可以输入他们想要的*任何*字符并验证。如果需要，消息会显示焦点离开文本区域的时间。

我还为多行添加了 'm' 标志，但没有添加给我相同效果的 \r。

一个星期以来一直在为此挠头，才刚刚开始学习正则表达式。有谁知道我应该寻找哪个方向来解决这个问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:39:54.460

```
var string = "This is a\ntest";

string.match(/^[a-z\s]$/i); // ["This is a\ntest" ]
string.match(/^[a-z \r\n]+$/i); // ["This is a\ntest" ] 
```

`m`显然你甚至不需要。也许您需要双重转义您的转义字符？看起来那里可能正在进行一些处理。所以：

```
string.match(/^[a-z \\r\\n]+$/i); 
```

请记住`\s`包含空格、换行符、回车和制表符 ( `\t`)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:02:51.437

我认为您的问题与“-”字符有关。在字符集（“[xyx]”）中，破折号是少数特殊字符之一。当它出现在两个字符之间时，它会设置一个范围。当它仅在一侧有字符时，它被简单地视为破折号字符。

在您的第一个正则表达式中，您以破折号 ( `/^[a-z0-9 ,.-]*$/gi`) 结尾，因此它将其视为破折号字符。

在您的第二个 ( `/^[a-z0-9 ,.-\r]*$/gi`) 中，您以 \r 结尾，创建了一个小的子范围`.-\r`

您应该能够通过将破折号移动到集合的末尾（或开头）或将其转义来解决此问题：

`/^[a-z0-9 ,.\r-]*$/gi`

. . . 或者 。. .

`/^[a-z0-9 ,.\-\r]*$/gi`

# javascript - Javascript鼠标悬停，为图像添加边框

> ID：15207377
> 
> 赞同：0
> 
> 时间：2013-03-04T17:28:17.840
> 
> 标签：javascript, image, dom-events, border

我的网站上有一些圆形按钮，我想在你的时候得到一个蓝色的轮廓`mouseover`。

```
<img src="/images/example.png" onmouseover="JavascriptHere"> 
```

我该怎么做？我正在尝试执行此操作的网站是[http://www.inglesfield.com/](http://www.inglesfield.com/)。我已经有一个`mousedown`防止图像拖动的事件，是否可以同时拥有两个事件（`mousedown`和`mouseover`）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:33:31.163

您可以在图像上添加 CSS 悬停样式

```
#content:hover { border: 2px solid blue; border-radius: 100px; } 
```

顺便说一句：不要对图像使用 id，而是使用 class="content"，因为 id 在 html 页面上应该是唯一的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:35:16.930

只需使用 css :hover 伪类 .. 你不需要 javascript

```
<img class="hover" src="http://www.hollywoodreporter.com/sites/default/files/2012/12/img_logo_blue.jpg"/>
<style> img.hover:hover {border:5px solid #555;} </style> 
```

例如：http: [//jsfiddle.net/orlando/Y3Ux6/](http://jsfiddle.net/orlando/Y3Ux6/)

# python - 在 Python 中使用列表而不是字典进行优化

> ID：15207378
> 
> 赞同：1
> 
> 时间：2013-03-04T17:28:17.977
> 
> 标签：python, optimization, python-3.2

我有一些 Python 代码比它应该的要慢得多。

```
#Generate planets
for t in range(stars*3): #There are 3 planets for every star, but not every star will have 3 planets
    theplanet=Planet()

    if random.randint(0,100) <= 25: #25% of planets have life
        theplanet.tl=random.randint(1,9)    #With a random tech level
    else:
        theplanet.tl=0  #The rest don't

    theplanet.star=stardict[random.choice(list(stardict.keys()))]     #Choose a random star
    theplanet.star.planets+=(theplanet,)    #Append the new planet to the star's list of planets
    theplanet.name=theplanet.star.name+"-"+str(len(theplanet.star.planets)) #Name the planet Starname-X, where X is the length of the star's planets tuple. Since this increases every time a planet is added, it will be 1 for the first planet, 2 for the next, etc...

    if math.floor((t/(stars*3))*100)==(t/(stars*3))*100: print("Generating planets: "+str((t/(stars*3))*100)+"% done.") 
```

我很确定瓶颈在`star=stardict[random.choice(list(`etc... 行。我在这里猜测，但我假设 dicts 通过搜索 dict 中的每个条目并查看哪个具有正确的键来工作。我再次假设，列表只会在从条目号派生的内存位置读取信息，并且对于非常大的（准确地说是 200,000 个条目）列表/字典要快得多。

将字典的条目转换为列表会使这段代码更快吗？我该怎么做（我以为我看到了它的功能，现在正在查看文档......）？有没有其他人注意到可以加快速度的方法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:35:43.547

您每次通过循环创建一个列表，但该列表是不变的。将其移出循环。

```
starlist=list(stardict.keys())
...
    theplanet.star=stardict[random.choice(starlist)]     #Choose a random star 
```

问题几乎肯定不在字典查找中。它们基于非常快的哈希表。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:45:00.780

1.  将列表生成`list(stardict.keys())`移到循环之外

2.  尝试分析您的代码（[文档](http://docs.python.org/2/library/profile.html)）

3.  假设您正在运行 CPython，请检查您的代码是否可以使用[Pypy](http://pypy.org/)运行。由于其优化的 JIT，这可能会带来更好的性能

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:00:04.470

您仅将密钥用作中间值来选择 stardict 中的随机项目。您可以直接使用字典的值列表：

```
#Generate planets
starlist = stardict.values()
for t in range(stars*3): #There are 3 planets for every star, but not every star will have 3 planets
    theplanet=Planet()

    if random.randint(0,100) <= 25: #25% of planets have life
        theplanet.tl=random.randint(1,9)    #With a random tech level
    else:
        theplanet.tl=0  #The rest don't

    theplanet.star=random.choice(starlist)     #Choose a random star
    theplanet.star.planets+=(theplanet,)    #Append the new planet to the star's list of planets
    theplanet.name=theplanet.star.name+"-"+str(len(theplanet.star.planets)) #Name the planet Starname-X, where X is the length of the star's planets tuple. Since this increases every time a planet is added, it will be 1 for the first planet, 2 for the next, etc...

    if math.floor((t/(stars*3))*100)==(t/(stars*3))*100: print("Generating planets: "+str((t/(stars*3))*100)+"% done.") 
```

# php - android通过http请求从Web数据库中检索数据，PHP不起作用

> ID：15207380
> 
> 赞同：0
> 
> 时间：2013-03-04T17:28:32.837
> 
> 标签：php, android, database

我试图通过 Http 请求从 Web 数据库中检索数据。但它不起作用。只有当 sql 字符串包含引号时，才会失败。否则，它工作正常。

当我调试时，返回字符串总是这样：

```
Warning:  mysql_fetch_array(): supplied argument is not a valid MySQL result resource in /home/content/28/8269928/html/test.php on line 12 null (id=830020201688) 
```

安卓端代码：

```
 ArrayList<NameValuePair> nameValuePairs = new ArrayList<NameValuePair>();
    nameValuePairs.add(new BasicNameValuePair("strSql", "select * from user where username='test'"));

    try {
        HttpClient httpclient = new DefaultHttpClient();
        HttpPost httppost = new HttpPost("http://test.com/test.php");
        httppost.setEntity(new UrlEncodedFormEntity(nameValuePairs));
        HttpResponse response = httpclient.execute(httppost);
        HttpEntity entity = response.getEntity();
        is = entity.getContent();
    }
    catch(Exception e) {
           System.out.println("Connectiong Error");
    }

    String js = "";
    try {
        BufferedReader reader = new BufferedReader(new InputStreamReader(is, "iso-8859-1"), 8);
        StringBuilder sb = new StringBuilder();
        String line = null;

        while ((line = reader.readLine()) != null) {
            sb.append(line + "/n");
        }

        is.close();

        js = sb.toString();
        System.out.println("get = " + js);
    }
    catch(Exception e) {
           System.out.println("Error converting to String");
    } 
```

网络服务器 PHP 代码：

```
$myconn=mysql_connect("68.178.139.15", "username", "password");  
mysql_select_db("dbname");
mysql_query("set names 'utf8'");

$strSql = $_REQUEST['strSql'];

$result = mysql_query($strSql, $myconn);
while($row = mysql_fetch_array($result)) {
    $output[]=$row;
}

print(json_encode($output));
mysql_close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:01:33.747

solved

android side: URLEncoder.encode("select * from test where name=\'test\'")

php side: urldecode($_REQUEST['strSql']);

# java - 如何在 Java Web 应用程序中将 WordML 转换为 Office Open XML？

> ID：15207384
> 
> 赞同：0
> 
> 时间：2013-03-04T17:28:50.637
> 
> 标签：java, python, openxml, docx, wordml

我有一个 Java Web 应用程序，它生成 WordML 格式的 MS Word 文档（Word 2003 XML 格式的单个 XML 文件，带有`.xml`文件扩展名）。我想自动将其转换为较新的 Office Open XML 格式，以便可以将文档保存为`.docx`文件（本质上是包含多个 XML 文件的 zip 文件）。

这必须是完全自动化的，并且不能要求用户下载文件并手动转换它。此外，不能假定用户安装了 MS Word（他们可能正在使用 LibreOffice）。

我一直在寻找可以用来执行此操作的 Java 库，但找不到任何可以转换`.xml`为`.docx`. 我能找到的唯一转换器是[JODconverter](http://www.artofsolving.com/opensource/jodconverter)但它不支持从`.xml`to 的转换`.docx`。

**是否有可以进行这种转换的 Java 库？或者也许我应该寻找非 Java 解决方案？也许 Python 模块可以做到这一点？**（例如，Python 脚本可以获取 Java 应用程序生成的文件并将它们转换为`.docx`.）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-05T19:37:28.197

如果您无法修改您的应用程序以发出 Flat OPC XML，您可以编写一个 XSLT 以将 Word 2003 XML 格式转换为 Flat OPC XML。它们非常相似。

然后，docx4j（披露：我维护这个）支持 Flat OPC XML 到 docx。

# php - SQL 多连接 SELECT 查询

> ID：15207387
> 
> 赞同：1
> 
> 时间：2013-03-04T17:28:51.787
> 
> 标签：php, mysql, sql

我已经构建了以下查询

```
$subforumsquery = "
        SELECT
          forums.*,
          posts.title   AS lastmsgtitle,
          posts.timee   AS lastmsgtime,
          posts.useraid AS lastmsguseraid,
          posts.useradn AS lastmsguseradn,
          users.photo   AS lastmsgphoto
        FROM forums
          LEFT JOIN posts
            ON (posts.forumid = forums.id)
          LEFT JOIN users
            ON (posts.useraid = users.id)
        WHERE forums.relatedto = '$forumid'
            and posts.type = 'post'
        ORDER BY `id` DESC"; 
```

我不知道为什么，但即使只有1个子论坛，我也会两次获得相同的子论坛。

顺便说一句，有没有办法只选择最后一个搜索全部的帖子？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:31:29.593

使用分组依据

```
SELECT
  forums.*,
  posts.title   AS lastmsgtitle,
  posts.timee   AS lastmsgtime,
  posts.useraid AS lastmsguseraid,
  posts.useradn AS lastmsguseradn,
  users.photo   AS lastmsgphoto
FROM forums
  LEFT JOIN posts
    ON (posts.forumid = forums.id)
  LEFT JOIN users
    ON (posts.useraid = users.id)
WHERE forums.relatedto = '$forumid'
    and posts.type = 'post'
GROUP BY forums.id
ORDER BY `id` DESC 
```

编辑 ：

将 MAX 与派生查询一起使用

```
SELECT
  forums.*,
  posts.title   AS lastmsgtitle,
  posts.timee   AS lastmsgtime,
  posts.useraid AS lastmsguseraid,
  posts.useradn AS lastmsguseradn,
  users.photo   AS lastmsgphoto
FROM forums
  LEFT JOIN (
        SELECT  
            * 
        FROM posts
        LEFT JOIN (
                SELECT 
                    MAX(id) AS ID 
                FROM posts 
                GROUP BY forumid
            ) AS l ON l.ID = posts.id
     GROUP BY forumid) AS posts
    ON posts.forumid = forums.id
  LEFT JOIN users
    ON (posts.useraid = users.id)
WHERE forums.relatedto = '$forumid'
    and posts.type = 'post'
GROUP BY forums.id
ORDER BY `id` DESC 
```

# web-applications - 已安装的客户端与 Web 应用程序

> ID：15207391
> 
> 赞同：0
> 
> 时间：2013-03-04T17:29:05.510
> 
> 标签：web-applications, client-server, javafx

我们正试图决定开发一个仅供内部使用的支持应用程序：

*   已安装的客户端（可能是带有 JavaFX UI 的 Java）
*   一个网络应用程序

考虑因素是：

1.  必须能够由小团队快速开发和部署
2.  必须能够在添加新业务需求时快速修改
3.  必须有一个单独的服务器端层。该服务器将有权访问数据，并且必须通过 Internet 将信息安全地传递给客户端。
4.  “客户端”应用程序的部署/分发不是问题（客户端应用程序通常的“分发是一个问题”问题不是问题）

很明显，部署的客户端应用程序比 Web 应用程序更能满足这些需求（特别是在第 1 点和第 2 点周围......我们不需要 Web UI 专家，不需要与后退按钮争吵等），但这使得我担心我错过了一些明显的担忧。

在这种情况下，您为什么*不*选择已部署的客户端应用程序？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:50:01.230

这实际上取决于您的客户**状态**、*需求*以及您的团队可以提供的*专业知识。*如果您已经有一个能够开发基于 java 的客户端的团队，那么我不明白您为什么要问，但是好吧。

我不会选择部署的客户端应用程序，因为：

*   可以在*任何地方使用 Web 应用程序*
*   数据传输更快
*   数据显示不正确或损坏没有问题
*   通过一些好的研究可以开发一个跨浏览器兼容的应用程序
*   减少您公司的带宽使用（显然取决于您拥有多少客户）
*   更容易更新

我个人需要更多信息才能提供更好的答案。

# ssis - 如何用适当数据类型的 NULL 标记替换平面文件中的缺失值？

> ID：15207392
> 
> 赞同：1
> 
> 时间：2013-03-04T17:29:05.770
> 
> 标签：ssis

我有一个包含货币价值的平面文件。有些有价值观，有些没有。因此，当我直接通过 SSIS 导入数据时，如果行中没有值，则它正在插入**`0`**，但从技术上讲没有值。如何**`0`**使用派生列替换这些值。

我尝试了以下表达式，但这两个表达式都没有产生预期的结果。

### 表达式 1：

```
MontlyAmt == "" ? NULL(DT_CY) 
```

### 表达式 2：

```
MontlyAmt == "" ? NULL(DT_CY) : MonthlyAmt 
```

如何使用 SSIS 表达式将缺少的货币数据从平面文件导入数据库？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:46:23.300

您不需要表达式来保留**`NULL`**值。当您使用 阅读平面文件*`Flat File Source`*时*`Data Flow Task`*，您需要选中该框**`Retain null values from the source as null values in the data flow`**。当您选中此框时，任何没有值的列都将转换为*平面文件连接管理器*上定义的相应数据类型的*NULL*标记。

 *![平面文件源编辑器](../Images/ad2145e813d4ae710d37fa3fa9e0a3af.png)*

# asp.net - 链接 btn 工作，但看起来像普通文本

> ID：15207395
> 
> 赞同：0
> 
> 时间：2013-03-04T17:29:09.233
> 
> 标签：asp.net, css, asplinkbutton

我有一个链接 btn，单击它会执行它应该执行的任务。但是，它不会显示为链接 btn，它只是看起来像一段普通的文本。

我已将其缩小到我的 css 文件中的某个位置，该属性的文本装饰设置为无。

然而，有太多的参考资料要逐一阅读以弄清楚它是哪一个。

我可以写一个新的css来覆盖以前的css吗？

我的尝试是：

```
a.linkBtn {
      text-decoration: underline;
      color: blue
 }

<asp:Repeater id="rptChecklistRecords" runat="server">
<HeaderTemplate>
    <table class="detailstable FadeOutOnEdit">
        <tr>   
          <th style="width:200px;">Title</th> 
          <th style="width:200px;">Timestamp</th>    
        </tr>
</HeaderTemplate>
<ItemTemplate>
         <tr>                  
           <th style="width:200px;">
                 <asp:LinkButton id="linkBtn" CssClass="linkBtn" runat="server" Text='<%# Eval("Title") %>' OnCommand="LoadCheckListRecordEntry"/>
           </th>  
           <th style="width:200px;"><%# Eval("Timestamp") %></th>  
         </tr>
</ItemTemplate>
<FooterTemplate>
    </table>
</FooterTemplate> 
```

我的代码是：

```
<asp:LinkButton id="linkBtn" CssClass="linkBtn" runat="server" Text='<%# Eval("Title") %>' OnCommand="LoadCheckListRecordEntry"/> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:31:54.220

您可以使用 !Important 标签。看看这篇文章[http://webdesign.about.com/od/css/f/blcssfaqimportn.htm](http://webdesign.about.com/od/css/f/blcssfaqimportn.htm)。

此标签允许您覆盖其他设置。

# python - 您如何使用 pyparsing 解析文字星号？

> ID：15207397
> 
> 赞同：2
> 
> 时间：2013-03-04T17:29:29.100
> 
> 标签：python, grammar, pyparsing

我目前正在解析一个可以包含通配符的字符串。如果您将星号放在引号中，我的语法才有效。如何指定文字 *.

```
selection = QuotedString('"') | Word(printables) | Literal('*') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:38:32.113

任何文字 '*' 都会被`Word(printables)`. 你的意思是让这个词由任何不是星号的印刷品组成吗？如果是这样，那么您可以更改为：

```
selection = QuotedString('"') | Word(printables, excludeChars='*') | Literal('*') 
```

# performance - R中的慢速嵌套循环

> ID：15207398
> 
> 赞同：1
> 
> 时间：2013-03-04T17:29:30.113
> 
> 标签：performance, r, loops, nested, vectorization

我是 R 新手，在矢量化特别慢的嵌套循环时遇到了麻烦。循环遍历中心列表（存储在结构中的向量）并找到这些向量与下面称为数组的行之间的距离`x`。我知道这需要矢量化以提高速度，但无法找出适当的功能或使用`apply`来做到这一点。

```
clusterCenters <- matrix(runif(10000),nrow=100)
clusterMembers <- matrix(runif(400000),nrow=4000)

features <- matrix(0,(dim(clusterMembers)[1]),(dim(clusterCenters)[1]))

for(c in 1:dim(clusterCenters)[1]){
  center <- clusterCenters[c,]
  for(v in 1:(dim(clusterMembers)[1])){
    vector <- clusterMembers[v,]
    features[v,c] <- sqrt(sum((center - vector)^2))
  }
} 
```

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:41:09.683

您可以利用 R 的回收规则来加快速度。**但是**您必须知道并考虑到 R 以列优先顺序存储矩阵的事实。你通过转置来做到这一点，`clusterMembers`然后`center`向量将沿着`t(clusterMembers)`.

```
set.seed(21)
clusterCenters <- matrix(runif(10000),nrow=100)
clusterMembers <- matrix(runif(400000),nrow=4000)
# your original code in function form
seven <- function() {
  features <- matrix(0,(dim(clusterMembers)[1]),(dim(clusterCenters)[1]))
  for(c in 1:dim(clusterCenters)[1]){
    center <- clusterCenters[c,]
    for(v in 1:(dim(clusterMembers)[1])){
      vector <- clusterMembers[v,]
      features[v,c] <- sqrt(sum((center - vector)^2))
    }
  }
  features
}
# my fancy function
josh <- function() {
  tcm <- t(clusterMembers)
  Features <- matrix(0,ncol(tcm),nrow(clusterCenters))
  for(i in 1:nrow(clusterCenters)) {
    # clusterCenters[i,] returns a vector because drop=TRUE by default
    Features[,i] <- colSums((clusterCenters[i,]-tcm)^2)
  }
  Features <- sqrt(Features)  # outside the loop to avoid function calls
}
system.time(seven())
#    user  system elapsed 
#     2.7     0.0     2.7 
system.time(josh())
#    user  system elapsed 
#    0.28    0.11    0.39 
identical(seven(),josh())
# [1] TRUE 
```

# c++ - C++ Index variable changing radically in Debug Version

> ID：15207408
> 
> 赞同：-4
> 
> 时间：2013-03-04T17:29:55.107
> 
> 标签：c++, c

I have found a lot of answers that have to do with release version problems but none with the exact opposite.

I have a loop similar to the following:

```
while(index < 7 && FlagIsUp)
{
  // process
  Inner Loop
    Inner Inner Loop
    Array[index] = number;
  ++index;
} 
```

Problem is that index changes radically from 6 (the last iteration) to 17209 for an int16_t and 1133165442 for size_t. NOTHING IN THE LOOP changes the index except the ++index. I replaced the while with a for and it still happens.

It only happens in debug mode, in release version it does finish without issues.

I also added volatile to the index and results were the same, it still overflowed.

Any ideas, pointers, would be appreciated. I can't provide a working copy of the bug so any theories are welcomed, I want to exhaust my options to find the problem.

EDIT: Yes I'm sorry. I gave to little information. First off I'm working with QNX Momentics Version: 4.6.0 and my debugger is part of the GNU Compiler Collection 4.3.3.

Now the inner loop is this:

```
cSignalNoIndex = 0;
  while ((cSignalNoIndex < (2 * NO_PHASES + 1)) && !ShutDownFlag)
  {
    wSF0 = 0;
    wExtSF = 0;
    dwSFAcc = 0;
    dwExtSFAcc = 0;
    std::string SignalNo= " Waveform number " + Tool::toString(cSignalNoIndex);
    Results[cSignalNoIndex].printWaveForm(SignalNo);
    // Prepare Input vectors for FFT compute
    cComponent = 0;
    while (cComponent < (HCYCLE_SAMPLES << 1))
    {
      awReal[cComponent] = static_cast<int>(Results[cSignalNoIndex].WaveForm[cComponent/64][cComponent % 64]);
      awImg[cComponent] = 0;
      pwSource++;
      cComponent++;
    }
    Results[cSignalNoIndex].printWaveForm(SignalNo);
    // Get FFT (forward)
    // Changed the wPwr from 7 to something else
    iFft(&awReal[0], &awImg[0], wPwr, 1);
    Results[cSignalNoIndex].printWaveForm(SignalNo);
    // Compute magnitudes
    //fMult = pInBlock3->fMult[cSignalNoIndex];         // Get Multiplier
    fMult = 1;
    for (cComponent = 0; cComponent < HCYCLE_SAMPLES && !ShutDownFlag; cComponent++)
    {
      int64_t dlOp = static_cast<int64_t>(awReal[cComponent]) * awReal[cComponent] + static_cast<int64_t>(awImg[cComponent]) * awImg[cComponent];
      dlOp <<= 1;       // Apply sqrt(2) term to result
      dlOp = static_cast<int>(fMult * isqrt64(dlOp));

      // Store into FFT object
      oFFTMag3.wFFT[cSignalNoIndex][cComponent] = static_cast<int16_t>( dlOp );

      // Set Base frequency magnitude and accumulate harmonics
      if (cComponent == 1)  // Base
      {
        wSF0 = dlOp;

        if(cSignalNoIndex == 6)
        {
          wRefMagnitude = static_cast<int16_t> ( 0.4 * wSF0 );
        }

        if(awReal[1] != 0)  // Also get phase for Base
        {
          dfPhase = std::atan((double)((float)awImg[1]/awReal[1])) * 180.0 / PI;
        }
        else
        {
          if(awImg[1] >= 0)
          {
            dfPhase = 90.0;
          }
          else
          {
            dfPhase = -90.0;
          }
        }

        if(awReal[1] < 0)   // convert to 2*PI range
        {
          dfPhase += 180.0;
        }
        else if(awImg[1] < 0)
        {
          dfPhase += 360.0;
        }
        //// THIS IS THE LINE
        fPhase[cSignalNoIndex] = dfPhase; ////////// WTF! cSignalNoIndex = 6 - cComponent = 2
        /// HERE cSignalNoIndex is overflown
      }
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:31:47.560

You haven't really posted enough code but my best bet is `Array[index] = number` overwrites `index` at some point. The fact that it only happens *sometimes* (in your case, when debugging) is a good example of "undefined behavior".

# jquery - 使用 jquery 替换输入按钮文本

> ID：15207411
> 
> 赞同：-6
> 
> 时间：2013-03-04T17:30:07.193
> 
> 标签：jquery

我一直在试图弄清楚如何实现这一目标，但没有取得任何成功。

将不胜感激一些帮助。

我有一个`input[type="submit"]`.

它的基值始终为`"Next > some more text"`。

`<em>`我不想在零件周围添加一个，`"Next >"`这样我最终会得到 `"<em>Next ></em> some more text"`.

有任何想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:32:32.410

你可以只使用：

```
input[type=submit] {
    font-style: italic;
} 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Vvj4x/)。

虽然不幸的是，这会使*整个*元素的文本斜体，而不是特定部分。

元素不能包含任何其他 HTML ，`input`因此不可能`value`用`em`元素包装 。

但是，如果您使用了`button`元素，则可以使用：

```
<button>
    <em>Next ></em> some more text
</button> 
```

[JS 小提琴演示](http://jsfiddle.net/davidThomas/Vvj4x/1)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:34:08.433

然后为按钮添加一个 id：

```
$("#btnId").attr('value', 'New Text Goes here'); 
```

# eclipse - Eclipse 没有启动

> ID：15207412
> 
> 赞同：0
> 
> 时间：2013-03-04T17:30:07.487
> 
> 标签：eclipse

我正在使用 iMac（OS 10.8.2），当我启动 Eclipse 时，启动画面只是挂起。我已经安装了最新的 Java 版本 7，更新 15 希望可以解决问题，但它没有。

任何帮助表示赞赏。

问候，斯蒂芬

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T14:30:52.947

由于我的评论能够提供帮助，因此我将其发布为答案：

> `eclipse -clean`请从安装目录尝试。如果这不起作用，重新安装 Eclipse 应该可以解决您的问题。

# android - 在android中设计国际象棋用户界面

> ID：15207421
> 
> 赞同：0
> 
> 时间：2013-03-04T17:30:51.803
> 
> 标签：android

我在 Android 中使用 64 个按钮设计了一个棋盘。但是在设计之后，我遇到了很多问题，因为我需要实现 64 个 OnClickListeners。有没有其他方法可以使用`for`循环实现 OnClickListener，或者使用按钮设计棋盘是不正确的？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:43:00.687

您应该查看[开发人员示例](http://developer.android.com/tools/samples/index.html)，尤其是井字游戏应用程序，它使用基于网格的游戏板的自定义视图。你应该能够扩展这个想法。

如果您想继续为每个方块使用按钮，您必须知道它们的 id 才能创建`onClickListener`s。有两种方法可以解决这个问题；
在布局 xml 中添加 onClickListener：

```
<Button
parameters...
onClick="myOnClick"
</ 
```

然后，您可以在您`Activity`的方法中创建 myOnClick 方法：

```
public void myOnClick(View clickedView){
    //code
} 
```

按钮解决方案的一种可能更好的方法是从代码中创建它们，或者获取`LayoutInflater`并创建您的 xml 按钮并添加到您当前的内容中，或者使用相应的 java 类创建新按钮：`Button myButton e3 = new Button(context);`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T17:50:43.447

*如果你真的想要有 64 个独立的视图*，你不需要 64 个独立的 onClickListener；只需在 XML 中为视图提供一个 onClick 属性，所有这些都与关联活动的相同方法有关。然后，您可以在构建时生成一个表以将 id 映射到坐标，或者您可以使用您自己的属性将坐标添加到每个视图。

但是，为您的棋盘*提供单一视图会更有意义。*此视图会将自身划分为 64 个方格，维护一个内部表格，指示哪些棋子在哪里，绘制方格和其中的棋子`.onDraw()`，并在单击时进行一些数学运算以确定单击了哪个方格。`TileView.java`在[示例](http://developer.android.com/tools/samples/index.html)Snake 应用程序中学习；一旦您理解了该代码，您将在`ChessboardView`课堂上轻松自如。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:35:58.763

是的，可以遍历按钮并为每个按钮添加一个侦听器。在您的循环中，您将执行以下操作：

```
button.setOnClickListener(new View.OnClickListener() {      
    @Override
    public void onClick(View v) {
        // Handle click events...   
    }
}); 
```

# c# - 将外键相关表中的字段加载为本机类型

> ID：15207423
> 
> 赞同：0
> 
> 时间：2013-03-04T17:31:05.837
> 
> 标签：c#, entity-framework

假设我有 2 张桌子：

```
Customer
    Id int
    Name varchar
    TypeId int

CustomerType
    Id int
    Type varchar 
```

TypeId 是 CustomerType 的 Id 的外键。现在如何使用 EF 将 Customer 加载为这样的实体：

```
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }

    public int TypeId { get; set; }
    [ForeignKey("TypeId")]
    public string Type { get; set; }
} 
```

Type 是 CustomerType 的 Type 属性。我在 EF5 中使用代码优先。它目前不起作用，我不断收到`The navigation property X is not a declared property on type..` 异常。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:37:11.530

您不能将属性映射到单独的表。只有实体可以映射到表。作为解决方法，您可以创建属性，其类型`CustomerType`将映射到第二个表，并将`Type`属性标记为未映射：

```
public class Customer
{
    public int Id { get; set; }
    public string Name { get; set; }
    public int TypeId { get; set; }
    [ForeignKey("TypeId")]
    protected CustomerType CustomerType { get; set; }
    [NotMapped]
    public string Type 
    { 
        get { return CustomerType.Type; }
        set { CustomerType.Type = value; }
    }
} 
```

# c# - 使用 RectangleF 和 DrawString 用文本填充图形

> ID：15207425
> 
> 赞同：1
> 
> 时间：2013-03-04T17:31:06.913
> 
> 标签：c#, image, text, font-size, graphic

我被要求为数据库中的某些项目生成占位符图形，但有一个警告 - 字体大小需要是动态的，以便文本填充整个图形。

代码的第一次迭代工作得很好，但客户希望字体更大，以便图形更易于阅读。这是生成文本的部分的片段：

```
using (Graphics Graphic = Graphics.FromImage(Img))
{
   // Add Some Padding
   Width = Width - 20;
   Height = Height - 20;

   // Generate The Text
   Font GraphicFont = new Font("Arial", 26, FontStyle.Bold);
   RectangleF RectF = new RectangleF(10, 10, (float)Width, (float)Height);
   StringFormat sf = new StringFormat();
   sf.Alignment = StringAlignment.Near;
   sf.LineAlignment = StringAlignment.Near;
   Graphic.DrawString(Title, GraphicFont, Brushes.Black, RectF, sf);
} 
```

有没有我可以检测到我的文本溢出`RectangleF`，或者我可以在我将它应用到图形之前检测我的大小`DrawString`，或者我可以做一些其他的魔法来让文本填充图形？

我希望文本自动换行，并且所有单词的字体大小相同，因此不一定需要完全填充图形 - 希望这一切都有意义。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:34:55.023

使用`Graphics.MeasureString`（文档：http: [//msdn.microsoft.com/en-us/library/6xe5hazb.aspx](http://msdn.microsoft.com/en-us/library/6xe5hazb.aspx)）

如果要调整文本大小以填充区域，可以对不同大小进行二进制搜索以确定仍适合目标区域的最大大小，然后使用该大小实际绘制字符串。

# jsf-2 - JSF2 commandButton 动作执行顺序

> ID：15207426
> 
> 赞同：1
> 
> 时间：2013-03-04T17:31:08.030
> 
> 标签：jsf-2

我在事件上有一个带有 Ajax 功能的输入字段，`blur`在我的页面上有一个 commandButton。如果我修改输入字段上的值并单击命令按钮而不跳出，首先调用哪个方法？附加到输入字段或按钮的侦听器？

根据我迄今为止的经验，第一个被调用的会有所不同，这导致我的应用程序出现了一些问题。我希望始终首先调用输入字段的侦听器。

有谁知道如何处理这种情况？

**更新：** 感谢您的回复，在进行了更多故障排除后，我注意到如前所述，首先调用 ajax 侦听器，但在极少数情况下，在侦听器方法完成处理某些所需逻辑之前调用按钮操作。就我而言，我需要侦听器方法在调用按钮操作之前完成处理，否则可能会发生一些意外行为。是否有可能做到这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:34:40.640

请记住，JSF 中的所有内容都被转换回 HTML 和 JavaScript。因此，一个简单的测试是这样的：

```
<input type="text" id="field1" onblur="blurFunction();">
<br/>
<button onclick="clickFunction()">Click</button> 
```

将向您展示您需要了解的内容。通过我所做的测试，`blur`首先出现。

如果您对此有疑问，为什么不在单击按钮时进行简单检查以确保运行所需的任何内容`blur`？

### 编辑

根据已编辑的问题，您始终可以为您的`blur`活动设置一个标志。

```
function blurFunction() {
    document.myVar = 1;
    //... rest of the function
}

function clickEvent() {
    if(document.myVar = 1) {
        //wait
    } else {
        //do your click event
    }
} 
```

不建议将您的变量放在全局范围内。这只是如何做到这一点的一个例子。

# c# - BITS 不下载示例文本文件

> ID：15207428
> 
> 赞同：0
> 
> 时间：2013-03-04T17:31:12.307
> 
> 标签：c#, microsoft-bits, bits-service

我有以下代码：

```
 BitsManager manager = new BitsManager();
 manager.EnumJobs(JobOwner.CurrentUser);

 BitsJob newJob = manager.CreateJob("TestJob", JobType.Download);

 string remoteFile = @"http://www.pdrrelaunch.com/img/New Text Document.txt";
 string localFile = @"C:\temp\Test Folder\New Text Document.txt";
 newJob.AddFile(remoteFile,localFile);
 newJob.Resume(); 
```

BITS正在运行，我使用的是win7 64位机器。没有在目标文件夹中创建文本文件（New Text Document.txt）的原因是什么。此外，此远程位置是部署在本地 IIS 中的网站。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-11-03T13:19:07.543

如果你的工作处于`Transferred`你必须打电话的状态`Complete`，文件就会出现。

# google-maps - 在 KML 中隐藏用于居中和缩放地图的地标

> ID：15207429
> 
> 赞同：0
> 
> 时间：2013-03-04T17:31:12.607
> 
> 标签：google-maps, kml

我在我的网站上有一个嵌入式地图，我在其中根据用户的搜索结果显示各种位置。在某些情况下，我们没有位置数据，而是显示一个屏幕叠加层来表明这一点。我还设置了几个地标来强制地图缩放并以特定区域为中心（如果没有位置数据则默认为完全缩小，这有点难看）。

我的问题是我想隐藏这些地标，否则它们似乎表明有可用的位置并且以下方法均无效：

1.  元素上的可见性标志似乎仅在谷歌地球中受支持
2.  指定为地标图标 href 的自定义透明 png 未加载，我得到默认的蓝色图钉。
3.  我尝试在包含地标的文件夹上创建一个区域并设置一个应该禁用它的 LOD，但这似乎根本没有做任何事情（下面的 KML）。

我相信我错过了一种简单的方法来实现这一点，但轻推会有所帮助。这是使用区域的 KML：

```
<?xml version="1.0" encoding="utf-8"?>
<kml xmlns="http://www.opengis.net/kml/2.2">
  <Document>
    <ScreenOverlay>
      <Icon>
        <href>URL/mapDisclaimer.png</href>
      </Icon>
      <overlayXY x="0.5" xunits="fraction" y="0.5" yunits="fraction" />
      <screenXY x="0.5" xunits="fraction" y="0.5" yunits="fraction" />
      <size x="0" xunits="pixels" y="0" yunits="pixels" />
    </ScreenOverlay>
    <Folder>
      <name>PlaceHolderFolder</name>
      <Style id="placeholderStyle">
        <IconStyle>
          <Icon>
            <href>URL/transparentBlock.png</href>
          </Icon>
        </IconStyle>
      </Style>
      <Region>
        <LatLonAltBox>
          <north>79</north>
          <south>59</south>
          <east>-102</east>
          <west>-137</west>
        </LatLonAltBox>
        <Lod>
          <maxLodPixels>20</maxLodPixels>
        </Lod>
      </Region>
      <Placemark>
        <styleUrl>#placeholderStyle</styleUrl>
        <Point>
          <coordinates>-136.582031,69.16256</coordinates>
        </Point>
      </Placemark>
      <Placemark>
        <styleUrl>#placeholderStyle</styleUrl>
        <Point>
          <coordinates>-110.566406,78.560486</coordinates>
        </Point>
      </Placemark>
      <Placemark>
        <styleUrl>#placeholderStyle</styleUrl>
        <Point>
          <coordinates>-102.128906,59.977005</coordinates>
        </Point>
      </Placemark>
    </Folder>
  </Document>
</kml> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T22:50:39.870

透明PNG应该可以工作，但是您必须将`<Style/>`-element 移出`<Folder/>`并使其成为`<Document/>`

# php - preg_replace_callback 与匿名函数

> ID：15207434
> 
> 赞同：1
> 
> 时间：2013-03-04T17:31:26.177
> 
> 标签：php, eval, anonymous-function, preg-replace-callback

我收到此错误，但我无法找出原因：

`Parse error: syntax error, unexpected $end in C:\wamp\www\test.php(19) : eval()'d code on line 1`

任何见解将不胜感激！

```
$table = '<table><tr><td>${Q*10}</td></tr></table>';

$symbols = array('Q' => 10);

preg_replace_callback('/\${(\w+)([*+-\/])(\d+)}/', function($matches) use ($symbols, $table) {
    return repl($matches, $symbols, $table); 
}, $table);

function repl($tokens, $symbols, $table)
{
    $replace = array_shift($tokens);

    $operand1 = $symbols[$tokens[0]];
    $operator = $tokens[1];
    $operand2 = $tokens[2];

    $val = eval("$operand1 $operator $operand2");
    // Fix: $val = eval("return $operand1 $operator $operand2;");

    $table = str_replace($replace, $val, $table);

    echo $table; // Should be 100
}

// EOF 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:38:20.900

[`eval`](http://php.net/eval)需要包含一个语句或语句块，而不仅仅是一个表达式。

要实际获得结果并分配它，您需要：

```
 $val = eval("return $operand1 $operator $operand2;"); 
```

正如@ggutenberg 所说，至少分号可以避免语法错误。但是`return`做你打算做的事情。

~~该`$matches`列表将包含位置的完整字符串`[0]`。捕获组从 开始`[1]`。您可能需要调整`$tokens`回调中的分配。~~

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:35:03.407

尝试在 eval 字符串的末尾添加分号。

# ruby-on-rails - ruby on rails if else 逻辑

> ID：15207438
> 
> 赞同：1
> 
> 时间：2013-03-04T17:31:35.660
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, ruby-on-rails-3.1, ruby-on-rails-3.2

如何缩短下面的 if else 语句。

现在，这两条语句的唯一区别是第一行。手风琴体和手风琴体。折叠。

```
- if @office.to_i == office.id
        .accordion-body{id: "collapse-#{index}"}
          .accordion-inner 
            - office.positions.each_with_index do |position, index|
              #measures-accordion.accordion
                .accordion-group
                  .accordion-heading
                    .row-fluid
                      .span2{class: "offices-#{position.status}"}= position.status
                      .span1= position.results.first.value
                      .span2= position.results.first.value_date_time.blank? ? '' : Date.parse(position.results.first.value_date_time)
                      .span5= position.name
      - else
        .accordion-body.collapse{id: "collapse-#{index}"}
          .accordion-inner 
            - office.positions.each_with_index do |position, index|
              #measures-accordion.accordion
                .accordion-group
                  .accordion-heading
                    .row-fluid
                      .span2{class: "offices-#{position.status}"}= position.status
                      .span1= position.results.first.value
                      .span2= position.results.first.value_date_time.blank? ? '' : Date.parse(position.results.first.value_date_time)
                      .span5= position.name 
```

上面的代码有效。但是如果我把它缩短到下面，我的逻辑就行不通了

```
 - if @office.to_i == office.id
      .accordion-body{id: "collapse-#{index}"}
    - else
      .accordion-body.collapse{id: "collapse-#{index}"}
      .accordion-inner 
        - office.positions.each_with_index do |position, index|
          #measures-accordion.accordion
            .accordion-group
              .accordion-heading
                .row-fluid
                  .span2{class: "offices-#{position.status}"}= position.status
                  .span1= position.results.first.value
                  .span2= position.results.first.value_date_time.blank? ? '' : Date.parse(position.results.first.value_date_time)
                  .span5= position.name 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:36:17.557

我建议将重复的代码移动到部分中，但如果你不想这样做，请尝试：

```
 .accordion-body{id: "collapse-#{index}", class: (@office.to_i == office.id) ? "" : "collapse" }
      .accordion-inner 
        - office.positions.each_with_index do |position, index|
          #measures-accordion.accordion
            .accordion-group
              .accordion-heading
                .row-fluid
                  .span2{class: "offices-#{position.status}"}= position.status
                  .span1= position.results.first.value
                  .span2= position.results.first.value_date_time.blank? ? '' : Date.parse(position.results.first.value_date_time)
                  .span5= position.name 
```

# asp.net - 使用 ASP .NET 向移动设备发送 SMS 的问题

> ID：15207451
> 
> 赞同：0
> 
> 时间：2013-03-04T17:32:13.247
> 
> 标签：asp.net

我正在做一个关于 MOBILE ADVERTISING 的项目。我使用以下代码，我必须以 msg 到移动设备的形式向用户发送广告。这是我使用的代码 -

```
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Net;
using net.webservicex.www;

public partial class msg : System.Web.UI.Page
{

    protected void Page_Load(object sender, EventArgs e)
    {

    }

    protected void Button1_Click(object sender, EventArgs e)
    {
        try
        {

            net.webservicex.www.SendSMS smsIndia = new net.webservicex.www.SendSMS();

            smsIndia.SendSMSToIndia(Txt_Mobile.Text, TxtEmail.Text.Trim(), TxtMessage.Text);

            Label3.Visible = true;
            Label3.Text = "Message Send Succesfully";
        }
        catch (Exception ex)
        {
            Label3.Visible = true;
            Label3.Text = "Error in Sending message" + ex.ToString();
        }
    } 
```

}

显示“net”时出现错误，错误是找不到类型或命名空间名称“net”（您是否缺少 using 指令或程序集引用？）

我绝望地寻找解决方案..请帮助...-(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:32:23.373

我认为您仅使用网络服务。所以我认为你错过了那件事。

您可以按照以下步骤操作。

右键单击项目 -> 添加 Web 引用 -> 编写您正在使用的 SMS 服务的 URL。

我想通过应用这种方法，我相信你会解决你的问题。

# c++ - (C++) AspectC++ 截取派生类的方法

> ID：15207453
> 
> 赞同：0
> 
> 时间：2013-03-04T17:32:24.100
> 
> 标签：c++, intercept, aspect

这可能是一个愚蠢的问题，但在搜索了几个小时后我找不到答案。

使用 AspectC++，我们可以定义切入点，它表示一旦匹配就会被拦截的东西。例如，我可以做

```
pointcut pc() = call("% Base::%(...)"); 
```

这样任何`advice`使用切入点的`pc`人都会拦截对类的某些方法的任何调用`Base`。即使稍后创建了一个子类，这仍然有效`Sub`：`Base`也`pc`将拦截对方法的调用`Sub`。现在，我想要的是*仅*拦截的方法`Sub`，即.`Sub`中不存在的方法`Base`。我们如何才能`pc()`拦截最终创建的任何子类的任何方法`Base`，而不是`Base`其本身的方法？

# colors - 如何更改 toolstripmenuitem 边框颜色？

> ID：15207460
> 
> 赞同：4
> 
> 时间：2013-03-04T17:33:01.497
> 
> 标签：colors, border, toolstripmenu

我做了一个这样的表格（语言c＃-VisualStudio2012）： http:
[//i.stack.imgur.com/5GEY1.jpg](http://i.stack.imgur.com/5GEY1.jpg)
如何将toolstripmenuitem的边框颜色从白色更改为另一种，或禁用它？
代码：

```
class CustomProfessionalColors : ProfessionalColorTable
{
    public override Color MenuItemSelected
    { get { return Color.FromArgb(51, 51, 52); } }

    public override Color MenuBorder
    { get { return Color.Black; } }

    //fill màu item của menu khi mouse enter
    public override Color MenuItemSelectedGradientBegin
    { get { return Color.FromArgb(64, 64, 66); } }

    public override Color MenuItemSelectedGradientEnd
    { get { return Color.FromArgb(64, 64, 66); } }

    // chọn màu viền menu item khi mouse enter
    public override Color MenuItemBorder
    { get { return Color.FromArgb(51, 51, 52); } }

    // fill màu nút item của menu khi dc nhấn
    public override Color MenuItemPressedGradientBegin
    { get { return Color.FromArgb(27, 27, 28); } }

    public override Color MenuItemPressedGradientEnd
    { get { return Color.FromArgb(27, 27, 28); } }

    // fill màu thanh menu strip
    public override Color MenuStripGradientBegin
    { get { return Color.FromArgb(51, 51, 52); } }

    public override Color MenuStripGradientEnd       
    { get { return Color.FromArgb(51, 51, 52); } }
}

public Form1()
    {
        InitializeComponent();
        menuStrip1.Renderer = new ToolStripProfessionalRenderer(new CustomProfessionalColors());      
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-25T16:29:42.260

这将完成这项工作。它实际上不是边界，而是背景。

```
public override Color ToolStripDropDownBackground {
    get { return Color.Red; }
} 
```

# matlab - 如何根据上一个术语为系列执行循环条件？

> ID：15207465
> 
> 赞同：0
> 
> 时间：2013-03-04T17:33:09.747
> 
> 标签：matlab

例如，我得到了一个 y = x + 1 的函数进行迭代，当相对值小于一个值时，我如何让程序停止，比如说 0.0001。相对值定义为，

当 x=1, y=2 ; x=2，y=3；x=3，y=4；等等等等。然后，

y 的相对值（当 x=2 时）= (3-2)/3 = 0.333333

这个过程不断重复，直到相对值小于 0.0001。

现在的问题是如何定义当前的 y 值和之前的 y 值，以便我可以将其置于循环条件中

```
x = input('enter initial value of x');
while abs((current y-previous y)/current y) < 0.0001
y = 1 + x
end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:38:27.443

怎么样：

```
x = input('enter initial value of x');
previousy = x;
currenty = x+1;

while( abs((currenty-previousy)/currenty) >= 0.0001)
    previousy = currenty;
    currenty = currenty+1;
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:53:34.227

您在这里不需要任何用户输入，也不需要循环，您的方法并不是 MATLAB 真正原生的。

我对解决方案的建议不包括循环，而是如下所示：

```
x = 1:1e5;                                  %// Values of x
y = x + 1;                                  %// Corresponding values of y
idx = find([NaN diff(y)] ./ y < 0.0001, 1); %// First index satisfying condition
currenty = y(idx)                           %// Value of y at that index 
```

这将产生`currenty = 10001`.

# windows-phone-7 - 如何使用 c#.net 将 writeablebitmap 保存到 windows phone 中的新图像？

> ID：15207466
> 
> 赞同：1
> 
> 时间：2013-03-04T17:33:10.990
> 
> 标签：windows-phone-7, windows-phone-8

我正在使用下面的代码在图像上写文本。但我无法保存它。有没有办法可以将更改保存到新图像或覆盖现有图像？

```
 BitmapImage img = new BitmapImage(new Uri(@"\DefaultImage.jpg", UriKind.Relative));
        img.CreateOptions = BitmapCreateOptions.None;
        img.ImageOpened += (s, e) =>
        {
            WriteableBitmap wbitmap = new WriteableBitmap((BitmapImage)s);
            TextBlock textBlock = new TextBlock();
            textBlock.Text = stringToRender;

            wbitmap.Render(textBlock, null);
            wbitmap.Invalidate();

        }; 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:45:58.183

您可以通过调用`SaveJpeg()`WriteableBitmap 来保存生成的图像。请参阅[http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.media.imaging.extensions.savejpeg(v=vs.105).aspx](http://msdn.microsoft.com/en-us/library/windowsphone/develop/system.windows.media.imaging.extensions.savejpeg(v=vs.105).aspx)

# java - 匹配空格或不匹配的正则表达式

> ID：15207469
> 
> 赞同：5
> 
> 时间：2013-03-04T17:33:25.630
> 
> 标签：java, regex

我有 JTextPane 将“int”字涂成蓝色。这样的正则表达式是错误的，因为它也会为“打印”着色：

```
int + "(\\[\\])*" //To match eg. int[] 
```

所以我想到了这样的正则表达式：

```
"\\s" + int + "(\\[\\])*" 
```

没关系，但如果用户在文本窗格中键入 int 作为第一个，则不起作用。如何解决这个问题呢？有没有什么象征？所以我可以制作：\s | 没有

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T17:34:56.957

只需匹配[由 . 匹配的单词边界](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#bounds)`int`包围。图案：[`\b`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#bounds)

```
"\\bint\\b" 
```

[在永远优秀的 regular-expressions.info](http://www.regular-expressions.info/wordboundaries.html)上阅读更多内容。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:34:38.547

你想要一个可选的空间吗？那将是`\\s?`。或允许零个或多个空格：`\\s*`.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:48:00.237

我建议使用这个：

```
/\bint\S*/ig 
```

不完全确定如何将其转换为 Java，但字符串部分如下所示：

```
"\\bint\\S*" 
```

正则表达式转换为：

在单词边界之后找到“int”，捕获它和其他任何东西，直到一个空白字符。

它允许你匹配

```
int[]
int()
interesting
int!@#$%^&*()_+~=- 
```

等等等等

如果您只想捕获`int[], int()`等，则正则表达式显然会有所不同。

# git - GIT SVN 外部 URL 目录顺序

> ID：15207471
> 
> 赞同：0
> 
> 时间：2013-03-04T17:33:36.583
> 
> 标签：git, svn, svn-externals

我在工作中使用 GIT-SVN，因为我广泛使用了 GIT，并且喜欢在我自己的机器上创建本地分支的能力。话虽如此，他们还在我的工作中使用 svn externals 来处理共享库组件。到目前为止，我无法控制我所说的任何事情。

我有一个脚本可以拉下外部并克隆它们并创建链接。在我主要控制的存储库上运行良好。然而，该公司的大多数其他人都在使用 TurtoiseSVN，而且它似乎设置了不同的外部订单。

例如..

{如果有的话} {url} {子目录}

其中.. 脚本使用 git svn show-externals 来查找期望顺序为的外部对象：

{子目录} {如果有的话} {url}

subversion 的命令行版本不关心这两种方法。

为什么在这方面存在分歧？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-14T04:09:21.527

在我发布这个之后..我发现了这个：svnbook.red-bean.com/en/1.8/svn.advanced.externals.html 说明turtoise使用的格式是“新”格式..我猜show-externals已更新以支持此功能。

# jquery - 如何通过单击缩略图暂停 CarouFredSel 轮播

> ID：15207473
> 
> 赞同：1
> 
> 时间：2013-03-04T17:33:52.370
> 
> 标签：jquery, wordpress, jquery-plugins, caroufredsel

使用 CarouFredSel 继续我的无限问题：

我有一组控制轮播的缩略图。这是我之前关于如何设置它的问题的链接：

[WordPress中的caroufredsel图像缩略图分页](https://stackoverflow.com/questions/14189869/caroufredsel-image-thumbnail-pagination-in-wordpress)

还有一个关于单击拇指时如何暂停它的问题

[点击 caroufredsel 时暂停轮播](https://stackoverflow.com/questions/14449646/pause-carousel-on-click-caroufredsel)

我的解决方案是添加延迟。

在您单击另一个缩略图之前，一切都很好。没发生什么事。我认为这与暂停/延迟有关。就像我删除了超时功能一样，它会淡入每个单击的缩略图......但不再在每次单击缩略图时暂停幻灯片放映。

```
$('#thumbs .thumb a').each(function(i) {
        $(this).addClass( 'itm'+i );

        /* add onclick event to thumbnail to make the main 
        carousel scroll to the right slide*/
        $(this).click(function() {

                $('#project-carousel').trigger( 'slideTo', [i, 0, true] );
                    setTimeout(function() {
                        $('#project-carousel').trigger('pause', true);
                    }, 1000);
                    return false;
        });
    }); 
```

总而言之，当您第一次单击任何缩略图时，这可以正常工作，随后单击任何缩略图都无济于事。就像我无法再次开始幻灯片放映一样。

我想到了一些条件语句，但我能想到的每一个都适用于每个实例，而不是来自后续点击的一个。像这样的东西：

```
if($(this).not(".paused")) {
       $('#project-carousel').trigger( 'slideTo', [i, 0, true] );
       }
       else {
        $(this).addClass("paused");
       $('#project-carousel').trigger( 'slideTo', [i, 0, true] );
            setTimeout(function() {
           $('#project-carousel').trigger('pause', true);
            }, 1000);
             return false;
        } 
```

但是，唉，这总是会达到第一个条件并且不会达到其他条件，因此不会暂停。我认为这可能只是一个逻辑问题，但也许它只是我需要添加的触发器以再次启动轮播。不知道。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-13T22:10:00.630

这是一个延迟问题。这是解决的代码：

```
jQuery(function(){

    $(".project-arrows").click(function() {
        $('#project-carousel').trigger('play',true);
    });

    /* Attached an unique class name to each thumbnail image */
    $('#thumbs .thumb a').each(function(i) {
        $(this).addClass( 'itm'+i );

        /* add onclick event to thumbnail to make the main 
        carousel scroll to the right slide*/
        $(this).click(function() {
            $('#project-carousel').trigger('play',true);
            $('#project-carousel').trigger( 'slideTo', [i, 0, true] );
            $('#project-carousel').trigger('stop');
            return false;
        });
    }); 
```

诀窍是使用停止而不是暂停，并在任何点击时触发播放。

# php - 不使用提交按钮更新数据库

> ID：15207475
> 
> 赞同：1
> 
> 时间：2013-03-04T17:33:55.747
> 
> 标签：php, database, forms, button

我想在没有表单提交的情况下发布输入值。我有这个链接，其中`onClick()`声明了一个函数。

```
 <a href="javascript:void(0);" id = "graph" onClick="validation('graph','D');" >Link</a> 
```

我在我的项目中受到限制，以避免我们使用 FORM SUBMIT 技术。我必须选择其他方式来发布值并更新数据库。做什么而不是表单发布？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:38:20.943

您需要使用 AJAX 来执行此操作。即使您可以`onblur()`在字段自动停用时使用文本字段的`JavaScript`函数，也会调用一个函数，您可以在其中放置代码以更新数据库。

```
$.ajax({
type: 'POST',
url: 'http://xyz.com/updatedb.php',
data: { 
    'foo': 'bar'
}
}); 
```

此代码将从您的表单发送数据。

在 updatedb.php 文件中使用以下代码：

```
<?php
 $in = $_POST['foo'];
 $con = //connection string;
 $query = "insert into tablename values('$in')";
 $result = mysqli_query($con, $query)
   or die('Something is wrong in query chek it');
 ?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:53:34.257

如果您严格地谈论表单，并且如果您可以使用 javascript 框架，例如 jQuery，它将立即为您提供您正在寻找的所有 AJAX 功能：

见[http://api.jquery.com](http://api.jquery.com)

你可以检查这个问题： [jQuery AJAX 提交表单](https://stackoverflow.com/questions/1960240/jquery-ajax-submit-form)

这为您提供了一种方法。您还可以改进您的代码，使其更易于访问和更少阻碍（这使得它更容易支持，因为 javascript 将与您的 html 代码分离）。

```
 <button id = "graph" >my action</a> 
```

在您的脑海中，在脚本元素中：

```
$(document).ready(function() {
    // the functions below are executes once the document is loaded
    $("#graph").click(function(){
        validation('graph','D');
    });

}); 
```

如果您不严格谈论表单，则可以通过定义 uri 和处理程序来实现： http: [//www.domain.com/](http://www.domain.com/?r=my-action/arg1/arg2/arg3) ?r=my-action/arg1/arg2/arg3 ...

您会在模型视图控制器框架中找到一些通用技术（我不知道您正在使用哪种服务器语言）。

注意：除了 jQuery，还有其他框架，但我习惯了 [http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks](http://en.wikipedia.org/wiki/Comparison_of_JavaScript_frameworks)

# ruby - 安装 Ruby 2.0.0 后安装 Ruby 1.9.3

> ID：15207480
> 
> 赞同：0
> 
> 时间：2013-03-04T17:34:06.287
> 
> 标签：ruby, installation, rvm, osx-mountain-lion

我安装了 gcc-4.2 并安装了 Ruby 2.0.0，但在此过程中我删除了一些旧版本的 ruby​​。具体来说，Ruby 1.9.3，现在我想回去安装那个版本，`rvm install 1.9.3`但我一直收到错误。它使用 gcc-4.2 来安装，但 gcc-4.2 安装 1.9.3 时有问题。既然我处于这种状态，如何安装 1.9.3？有什么想法或建议吗？

这些是错误：

```
Error running '__rvm_package_extract /Users/marty/.rvm/archives/yaml-0.1.4.tar.gz /Users/marty/.rvm/src', please read /Users/marty/.rvm/log/ruby-1.9.3-p392/yaml/extract.log
There has been an error while trying to extract the source. Halting the installation.

Error running './configure --disable-install-doc --prefix=/Users/marty/.rvm/rubies/ruby-1.9.3-p392 --with-opt-dir=/Users/marty/.rvm/usr --disable-shared', please read /Users/marty/.rvm/log/ruby-1.9.3-p392/configure.log
There has been an error while running configure. Halting the installation. 
```

这是日志

提取日志

```
[2013-03-04 12:08:08] __rvm_package_extract
yaml-0.1.4/: Can't update time for yaml-0.1.4
yaml-0.1.4/tests/: Can't update time for yaml-0.1.4/tests
yaml-0.1.4/tests/example-reformatter-alt.c: Can't unlink already-existing object
yaml-0.1.4/tests/example-deconstructor.c: Can't unlink already-existing object
yaml-0.1.4/tests/test-reader.c: Can't unlink already-existing object
yaml-0.1.4/tests/Makefile.am: Can't unlink already-existing object
yaml-0.1.4/tests/test-version.c: Can't unlink already-existing object
yaml-0.1.4/tests/run-dumper.c: Can't unlink already-existing object
yaml-0.1.4/tests/run-emitter.c: Can't unlink already-existing object
yaml-0.1.4/tests/run-parser.c: Can't unlink already-existing object
yaml-0.1.4/tests/run-scanner.c: Can't unlink already-existing object
yaml-0.1.4/tests/run-loader.c: Can't unlink already-existing object
yaml-0.1.4/tests/Makefile.in: Can't unlink already-existing object
yaml-0.1.4/tests/example-reformatter.c: Can't unlink already-existing object
yaml-0.1.4/tests/example-deconstructor-alt.c: Can't unlink already-existing object
yaml-0.1.4/config.h.in: Can't unlink already-existing object
yaml-0.1.4/aclocal.m4: Can't unlink already-existing object
yaml-0.1.4/Makefile.am: Can't unlink already-existing object
yaml-0.1.4/configure: Can't unlink already-existing object
yaml-0.1.4/yaml-0.1.pc.in: Can't unlink already-existing object
yaml-0.1.4/LICENSE: Can't unlink already-existing object
yaml-0.1.4/README: Can't unlink already-existing object
yaml-0.1.4/include/: Can't update time for yaml-0.1.4/include
yaml-0.1.4/include/Makefile.am: Can't unlink already-existing object
yaml-0.1.4/include/yaml.h: Can't unlink already-existing object
yaml-0.1.4/include/Makefile.in: Can't unlink already-existing object
yaml-0.1.4/Makefile.in: Can't unlink already-existing object
yaml-0.1.4/configure.ac: Can't unlink already-existing object
yaml-0.1.4/config/: Can't update time for yaml-0.1.4/config
yaml-0.1.4/config/ltmain.sh: Can't unlink already-existing object
yaml-0.1.4/config/config.sub: Can't unlink already-existing object
yaml-0.1.4/config/missing: Can't unlink already-existing object
yaml-0.1.4/config/config.guess: Can't unlink already-existing object
yaml-0.1.4/config/install-sh: Can't unlink already-existing object
yaml-0.1.4/config/depcomp: Can't unlink already-existing object
yaml-0.1.4/doc/: Can't update time for yaml-0.1.4/doc
yaml-0.1.4/doc/doxygen.cfg: Can't unlink already-existing object
yaml-0.1.4/doc/html/: Can't update time for yaml-0.1.4/doc/html
yaml-0.1.4/doc/html/functions_vars_0x6c.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x74.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/doxygen.css: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x69.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x6f.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__event__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/files.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/tab_h.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x74.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x72.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__tokens.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x64.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__emitter.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/bc_s.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x77.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x6b.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__parser__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x62.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x76.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x66.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x72.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/index.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x63.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__mark__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__alias__data__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/closed.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__version.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x75.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/annotated.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x64.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__document__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/modules.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x65.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x6d.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x6d.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/tabs.css: Can't unlink already-existing object
yaml-0.1.4/doc/html/globals_enum.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x71.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x63.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__tag__directive__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/classes.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x77.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x68.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x6b.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x71.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/doxygen.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/open.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x70.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/yaml_8h.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__node__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x75.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x68.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/tab_a.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x73.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/nav_f.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x73.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/tab_s.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/globals_eval.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x69.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__token__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x65.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x62.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__nodes.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__emitter__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__export.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x6e.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__parser.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/globals_type.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x6f.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x76.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/globals_defs.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/globals.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__node__pair__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x6e.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__events.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x66.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_0x6c.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/globals_func.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/tab_b.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/nav_h.png: Can't unlink already-existing object
yaml-0.1.4/doc/html/functions_vars_0x70.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__basic.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__simple__key__s.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/group__styles.html: Can't unlink already-existing object
yaml-0.1.4/doc/html/structyaml__version__directive__s.html: Can't unlink already-existing object
yaml-0.1.4/src/: Can't update time for yaml-0.1.4/src
yaml-0.1.4/src/parser.c: Can't unlink already-existing object
yaml-0.1.4/src/reader.c: Can't unlink already-existing object
yaml-0.1.4/src/Makefile.am: Can't unlink already-existing object
yaml-0.1.4/src/emitter.c: Can't unlink already-existing object
yaml-0.1.4/src/writer.c: Can't unlink already-existing object
yaml-0.1.4/src/api.c: Can't unlink already-existing object
yaml-0.1.4/src/dumper.c: Can't unlink already-existing object
yaml-0.1.4/src/Makefile.in: Can't unlink already-existing object
yaml-0.1.4/src/yaml_private.h: Can't unlink already-existing object
yaml-0.1.4/src/scanner.c: Can't unlink already-existing object
yaml-0.1.4/src/loader.c: Can't unlink already-existing object
yaml-0.1.4/win32/: Can't update time for yaml-0.1.4/win32
yaml-0.1.4/win32/Makefile.am: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/: Can't update time for yaml-0.1.4/win32/vs2003
yaml-0.1.4/win32/vs2003/example_deconstructor_alt.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/run_scanner.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/example_reformatter_alt.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/test_reader.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/example_deconstructor.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/run_dumper.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/libyaml.sln: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/run_parser.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/yaml.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/test_version.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/run_emitter.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/example_reformatter.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/run_loader.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2003/yamldll.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/: Can't update time for yaml-0.1.4/win32/vc6
yaml-0.1.4/win32/vc6/run_emitter.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/run_dumper.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/example_deconstructor_alt.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/yaml.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/run_parser.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/example_deconstructor.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/example_reformatter_alt.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/run_scanner.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/run_loader.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/test_reader.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/libyaml.dsw: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/example_reformatter.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/yamldll.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/vc6/test_version.dsp: Can't unlink already-existing object
yaml-0.1.4/win32/Makefile.in: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/: Can't update time for yaml-0.1.4/win32/vs2008
yaml-0.1.4/win32/vs2008/example_deconstructor_alt.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/run_scanner.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/example_reformatter_alt.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/test_reader.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/example_deconstructor.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/run_dumper.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/libyaml.sln: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/run_parser.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/yaml.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/test_version.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/run_emitter.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/example_reformatter.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/run_loader.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/vs2008/yamldll.vcproj: Can't unlink already-existing object
yaml-0.1.4/win32/config.h: Can't unlink already-existing object
tar: Error exit delayed from previous errors. 
```

配置日志

```
[2013-03-04 12:08:08] ./configure
checking build system type... x86_64-apple-darwin12.2.1
checking host system type... x86_64-apple-darwin12.2.1
checking target system type... x86_64-apple-darwin12.2.1
checking whether the C compiler works... yes
checking for C compiler default output file name... a.out
checking for suffix of executables... 
checking whether we are cross compiling... no
checking for suffix of object files... o
checking whether we are using the GNU C compiler... yes
checking whether clang accepts -g... yes
checking for clang option to accept ISO C89... none needed
checking whether we are using the GNU C++ compiler... no
checking whether /usr/bin/g++-4.2 accepts -g... no
checking how to run the C preprocessor... /usr/bin/cpp-4.2
configure: error: in `/Users/marty/.rvm/src/ruby-1.9.3-p392':
configure: error: C preprocessor "/usr/bin/cpp-4.2" fails sanity check 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-05T00:25:36.853

与@mpapis 聊天后，问题是 2 倍。

首先，您必须取消设置 CC 并确保 gcc-4.2 在 /usr/local/bin 而不是 /usr/bin 中。

其次，apple-gcc42没有在brew中链接，所以你必须运行：

```
brew unlink apple-gcc42 && brew link apple-gcc42 
```

然后运行

```
rvm install 1.9.3 --debug --autolibs=3 
```

并安装了 ruby​​ 1.9.3。

再次感谢@mpapis

# android - 避免重新启动应用程序

> ID：15207481
> 
> 赞同：0
> 
> 时间：2013-03-04T17:34:06.580
> 
> 标签：android, instance

在我的应用程序开始之前，我有几个文件将被下载，然后它将自动从启动屏幕开始并移动到下一个屏幕，现在当文件被下载时，用户单击主页按钮，以便应用程序将在后台下载文件。

现在假设下载完成并自动启动启动画面，现在在通知中用户可以看到下载完成并点击现在发生的情况是应用程序再次启动启动画面，所以有 2 个实例活动如何避免这种情况？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:39:39.877

在您的清单中

```
<activity
        android:name=your splash screen name
        android:launchMode="singleInstance"
</activity> 
```

当用户触摸通知时，您当前的初始屏幕 onNewIntent 将被调用。因此，如果您想更改任何内容，请覆盖 onNewIntent。

# java - HTTP 发布问题

> ID：15207483
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:34:08.870
> 
> 标签：java, http, post

我的代码如下所示，并打印出来自客户端的所有输入。

除了，当我尝试阅读它时，没有发布数据通过......

```
while ((s = input.readLine()) != null){
    System.out.println(s);
} 
```

我的帖子数据：

```
POST / HTTP/1.1
Host: localhost
Connection: keep-alive
Content-Length: 27
Cache-Control: max-age=0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Origin: (http://) localhost
User-Agent: Mozilla/5.0 (Windows NT 6.1) AppleWebKit/537.22 (KHTML, like Gecko) Chrome/25.0.1364.97 Safari/537.22
Content-Type: application/x-www-form-urlencoded
Referer: (http://) localhost/
Accept-Encoding: gzip,deflate,sdch
Accept-Language: en-GB,en-US;q=0.8,en;q=0.6
Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.3 
```

所以我没有收到任何数据，除了我在我的 HTML 中放了一个表单

```
<form method="post">
    TestText: <input type="text" name="test1"><br>
    TestText2: <input type="text" name="test2">
    <input type="submit" value="Submit">
</form> 
```

那么有什么想法吗？

我编写了自己的 HTTP 服务器，所以我实现了一种获取 POST、GET 和其他内容的方法

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:05:35.860

由于我还不能发表评论（谢谢），我将发表我的评论作为答案。

由于`Content-Length`标头不是 0，我假设请求正文确实包含表单数据，即使您没有将其包含在您的帖子数据中。

如果是这种情况，那么我们需要查看`input`变量的来源，以便了解它为什么不包含预期数据。我建议您修改您的问题并添加设置`input`变量的代码。

# sql - SQL Server 2008、规范化和主键

> ID：15207484
> 
> 赞同：0
> 
> 时间：2013-03-04T17:34:10.083
> 
> 标签：sql, sql-server, sql-server-2008

我有一个查询，我已经搜索了一段时间，但无法充分回答。

我正在为我的 SQL 类将记录插入到我的 2008 SQL Server 中，并且我必须将数据规范化为第三种形式。我相信我这样做是正确的，给我的例子是将记录分成它们自己的原子行（在其他要求中）。这产生了具有相同 OrderID（这是我的主键）的几行，并将订单的各个部分拆分为所述行。

例子：

```
OrderID ItemNumber Price  QTY
101     1          $1.00  5
101     2          $9.00  4
101     3          $5.00  3 
```

但是，如何插入这些行，而我的 PK (OrderID) 重复了这么多次？我已经尝试过一次，它拒绝除第一个不重复的实例之外的每个 INSERT INTO（给我一个 PK 约束错误）。如果这是一个愚蠢的问题，我深表歉意，但我正在努力理解。我上面发布的小例子正是我的导师想要的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:41:22.710

因此，您可能在课堂上学过，也可能没有学过，主键的约束之一是它必须是唯一的。

从更合乎逻辑的角度来看，主键本质上应该定义每行对业务用户表示的内容。在这种情况下，每一行代表一个项目，而不是一个订单。每个项目由订单号和该订单的项目号定义。

您的主键应该是 OrderID 和 ItemNumber 的组合。

# windows-ce - Windows CE 中的内存配置（操作系统设计）

> ID：15207485
> 
> 赞同：1
> 
> 时间：2013-03-04T17:34:10.570
> 
> 标签：windows-ce

我是 Windows ce 的新手。我正在研究“友好臂 mini2440”板。我已经对电路板进行了编程，我觉得 Windows 不能使用我所有的 SDRAM，我觉得 NAND 闪存也有同样的问题。我查看了系统属性，它显示 RAM 内存为 30640 KB。在 BSP 中，我查看了文件 C:\WINCE600\PLATFORM\Mini2440\Files\config.bib，它包含以下几行：

内存 NK 80200000 01e00000 RAMIMAGE RAM 82000000 01e00000 RAM ; 闪存 92000000 00100000 保留

我将01e00000从十六进制转换为十进制，等于31457280。我认为config.bib文件在配置RAM和Flash中起着重要作用。但是当我更改它并尝试构建操作系统设计时，构建过程以错误结束。我不知道如何解决这个问题。我也没有板子的地址内存映射。

# javascript - 从右到左的语言和编程问题

> ID：15207486
> 
> 赞同：2
> 
> 时间：2013-03-04T17:34:10.590
> 
> 标签：javascript, arabic, right-to-left

我正在创建一个使用我创建的新语言（如 BBcode）的 Web 文本编辑器。这种标记语言将是阿拉伯语，但我面临这些问题：

*   在所有 IDE 和编辑器中，很难在同一行中混合英语和阿拉伯语文本，因为会发生奇怪的事情（单词和字符的顺序会发生变化）
*   使用模式用 javascript 替换文本时，不会出现阿拉伯文本（例如：`"1 text arabic here 1".replace(/1(*)1/,"($1)")`我得到空 **()**）

我怎样才能解决这个问题 ？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:50:02.573

也许您可以使用一些不太可能的分隔符来指定数据缓冲区中编码切换的点。这将使您的解析函数识别必须以不同方式处理的文件块。

我不知道您的阿拉伯语文本是否使用 UTF-8 字符。希望可以在 UTF-8 中以英语和阿拉伯语呈现所有必要的字符。然后，您可以使用定界符告诉您的其他代码如何处理行为不同的文本片段。

```
>some english/L-T-R markup  
Ⓐ**...markup R-T-L Some**كل الخارجي للنص أو شكل توضع الفقرات في الصفحة التي يقرأها. ولذلك يتم استخدام طريقة لوريم إيبسوم لأنها تعطي توزيعاَ طبيعياَ -إلى حد ما- للأحرف عوضاً عن استخدام "هنا يوجد محتوى نصي، هنا يوجد محتوى نصي" فتجعلها تبدو (أي الأحرف) وكأنها نص مقروء. العديد من برامح النشر المكتبي وبرامح تحرير صفحات الويب تستخدم لوريم إيبسوم بشكل إفتراضي كنموذج عن اⒶ 
```

不知道关于正则表达式，希望 github 上已经有库可以处理混合的阿拉伯文和英文正则表达式 :)

编辑：Stack Overflow 的降价第一次吃了一些东西（天知道它对我粘贴的阿拉伯语 lorem ipsum 做了什么）

编辑：这是寻找阿拉伯语标签的开始

```
var src = "try to write javascript that replaces <رابط>نص تجريبي</رابط> by <a href='#'>نص تجريبي</a> and you wil notice all the difficulties – user2080105 15 mins ago"
var a = src.match(/try/);
console.log(a);
var b = src.match(/<[^>]*>/);
console.log(b);
var c = src.match(/<\/?[^>]*>/g);
console.log(c);

//Output in node v0.9.4-pre

[ 'try',
  index: 0,
  input: 'try to write javascript that replaces <رابط>نص تجريبي</رابط> by <a href=\'#\'>نص تجريبي</a> and you wil notice all the difficulties – user2080105 15 mins ago' ]
[ '<رابط>',
  index: 38,
  input: 'try to write javascript that replaces <رابط>نص تجريبي</رابط> by <a href=\'#\'>نص تجريبي</a> and you wil notice all the difficulties – user2080105 15 mins ago' ]
[ '<رابط>', '</رابط>', '<a href=\'#\'>', '</a>' ] 
```

# vb.net - 等效负载控制

> ID：15207487
> 
> 赞同：3
> 
> 时间：2013-03-04T17:34:11.053
> 
> 标签：vb.net, ascx

我有一个 .ascx 文件，我可以毫无问题地使用

```
<uc1:EL ID="EL1" BusinessID="8" runat="server" /> 
```

其中 BusinessID 是公共属性。

```
Public Property BusinessID As Integer
    Set(ByVal value As Integer)
        _BusinessID = value
    End Set
    Get
        Return _BusinessID
    End Get
End Property 
```

我可能需要多次将此 ascx 文件加载到具有不同 BusinessID 变量值的占位符中。

这样做的等效 LoadControl 方式是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:37:35.490

首先，您需要创建用户控件的实例，然后获取占位符的句柄。然后，您可以将一个添加到另一个。例子：

```
 'get place holder
 Dim getPh As New PlaceHolder
 getPh = CType(Me.FindControl("myPlaceHolder"), PlaceHolder)

 'get user controls    
 Dim newUserControl As New user_controls_myControlName
 newUserControl = CType(LoadControl("~/user_controls/myControlName.ascx"), user_controls_myControlName)    

 getPh.Controls.Add(newPortlet) 
```

一旦您创建了用户控件的实例，您就可以访问它的所有属性，包括 BusinessID，并且您可以随意分配它。

忘了一件事，您需要在 ascx 文件的客户端代码中添加一个引用，如下所示：

```
<%@ Reference Control="~/user_controls/myControlName.ascx"%> 
```

# ios - 追踪一条线 iOS

> ID：15207490
> 
> 赞同：0
> 
> 时间：2013-03-04T17:34:20.700
> 
> 标签：ios, objective-c, uigesturerecognizer, uitouch

我想做的是创建一个儿童游戏，你必须在其中追踪一条线。我想弄清楚的是最好的方法。我在想我可以使用带有线条的透明png作为参考。我知道您可以分析 png 并从非透明部分创建形状，但我不知道该怎么做。这样做的最佳方法是什么？如果使用PNG很好，我将如何去做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:47:47.637

您需要阅读一些资料——从[Quartz 2D Programming Guide 开始。](https://developer.apple.com/library/archive/documentation/GraphicsImaging/Conceptual/drawingwithquartz2d/Introduction/Introduction.html) 我个人会使用一种利用路径而不是位图的方法。

您可能还想查看他[在此处](https://stackoverflow.com/questions/3463256/what-are-some-great-quartz-2d-drawing-tutorials)引用的[Brad 的](https://stackoverflow.com/users/19679/brad-larson) [视频](https://podcasts.apple.com/us/podcast/advanced-iphone-development-spring-2010/id407243032)。

# cassandra - 当种子节点（总共 2 个）使用虚拟节点死亡时重新平衡 Cassandra 1.2 集群

> ID：15207491
> 
> 赞同：4
> 
> 时间：2013-03-04T17:34:34.020
> 
> 标签：cassandra, cluster-computing

我在本地机器上有一个 Cassandra 1.2 集群，并修改了主机：

```
#cassandra nodes
m.y.i.p               m.y.i.p   (Node 1)<---- seed 1
m.y.i.p               127.0.0.3 (Node 2)
m.y.i.p               127.0.0.4 (Node 3)<---- seed 2
m.y.i.p               127.0.0.5 (Node 4)
m.y.i.p               127.0.0.6 (Node 5) 
```

...所以集群总共有 5 个节点。我正在使用虚拟节点，所以我不必在任何地方设置 initial_token。

我遵循的步骤：

1.  启动种子节点（1 和 3）
2.  启动节点 2 和 4。
3.  关闭节点 3。
4.  尝试加入节点 5。

问题出在第 4 步，当我尝试加入 Node 5 时，Cassandra 抛出此异常：

```
 java.lang.IllegalStateException: unable to find sufficient sources for streaming range (-7204018021044318047,-6965052533844316617]
        at org.apache.cassandra.dht.RangeStreamer.getRangeFetchMap(RangeStreamer.java:205)
        at org.apache.cassandra.dht.RangeStreamer.addRanges(RangeStreamer.java:129)
        at org.apache.cassandra.dht.BootStrapper.bootstrap(BootStrapper.java:81)
        at org.apache.cassandra.service.StorageService.bootstrap(StorageService.java:890)
        at org.apache.cassandra.service.StorageService.joinTokenRing(StorageService.java:659)
        at org.apache.cassandra.service.StorageService.initServer(StorageService.java:514)
        at org.apache.cassandra.service.StorageService.initServer(StorageService.java:411)
        at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:278)
        at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:366)
        at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:409)
java.lang.IllegalStateException: unable to find sufficient sources for streaming range (-7204018021044318047,-6965052533844316617]
        at org.apache.cassandra.dht.RangeStreamer.getRangeFetchMap(RangeStreamer.java:205)
        at org.apache.cassandra.dht.RangeStreamer.addRanges(RangeStreamer.java:129)
        at org.apache.cassandra.dht.BootStrapper.bootstrap(BootStrapper.java:81)
        at org.apache.cassandra.service.StorageService.bootstrap(StorageService.java:890)
        at org.apache.cassandra.service.StorageService.joinTokenRing(StorageService.java:659)
        at org.apache.cassandra.service.StorageService.initServer(StorageService.java:514)
        at org.apache.cassandra.service.StorageService.initServer(StorageService.java:411)
        at org.apache.cassandra.service.CassandraDaemon.setup(CassandraDaemon.java:278)
        at org.apache.cassandra.service.CassandraDaemon.activate(CassandraDaemon.java:366)
        at org.apache.cassandra.service.CassandraDaemon.main(CassandraDaemon.java:409)
Exception encountered during startup: unable to find sufficient sources for streaming range (-7204018021044318047,-6965052533844316617]
ERROR 16:55:47,634 Exception in thread Thread[StorageServiceShutdownHook,5,main]
java.lang.NullPointerException
        at org.apache.cassandra.service.StorageService.stopRPCServer(StorageService.java:321)
        at org.apache.cassandra.service.StorageService$1.runMayThrow(StorageService.java:479)
        at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:28)
        at java.lang.Thread.run(Thread.java:722) 
```

范围（-7204018021044318047,-6965052533844316617] 只是属于死节点（节点3）。由于我使用的是虚拟节点，我认为环必须重新平衡：

> 添加或删除节点时不再需要重新平衡集群。当一个节点加入集群时，它承担来自集群中其他节点的偶数部分数据的责任。如果一个节点发生故障，负载将均匀分布在集群中的其他节点上。

但我错了，显然:)。

当前一个节点关闭时，我可以做些什么来加入现有集群中的新节点？请注意，我每个节点有 256 个令牌，nodetool move 不是一个选项（我认为）。

在此先感谢您，欢迎提供任何信息！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-07-04T11:59:43.663

解决方案是手动从令牌中删除节点 3（已关闭）。

# mysql - 将串行 COM 消息插入 MySQL 数据库

> ID：15207498
> 
> 赞同：0
> 
> 时间：2013-03-04T17:34:57.760
> 
> 标签：mysql, serial-port

我有一个 Arduino 设置，可以通过 USB 串行端口输出消息。不需要做任何“聪明”的事情来过滤或排序这些消息。

我想将这些消息（连同日期戳）插入 MySQL 数据库。可靠地做到这一点的最佳方法是什么？C++/PHP/等？

请提供一些信息来为我指明正确的方向。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:59:04.767

任何你使用的编程语言，都应该有COM口的中断功能

（如 func get_COM 实现 com_listener）

您必须使用该中断功能并写入数据库。

# java - jar 和类路径通配符

> ID：15207499
> 
> 赞同：4
> 
> 时间：2013-03-04T17:34:58.410
> 
> 标签：java, jar, directory, classpath, wildcard

我想为 Win 7 下的独立 java 应用程序指定多个类路径目录，java 7 均为 64 位。

目录结构应该如下

```
-app
|-lib
|-dynamicLib
|app.jar 
```

lib 文件夹包含在清单中直接引用的依赖项。`dynamicLib`也应该加载所有内容。

我尝试了以下方法：

添加`dynamicLib\*`到清单类路径

像这样添加`dynamicLib`到命令行

```
java -cp "dynamicLib\*";app.jar my.mainclass 
```

后者带和不带引号、绝对和相对路径、反斜杠等。但两者都不起作用。

那么，如何在执行 jar 时将通配符目录添加到现有的类路径中呢？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T22:29:53.700

使用正斜杠并将整个类路径放在引号中：

```
java -cp "app.jar;dynamicLib/*" my.mainclass 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:44:32.660

类路径看起来不错。

但是，为了执行`jar`文件，您必须使用该`-jar`选项。

```
java -cp "dynamicLib\*" -jar app.jar 
```

请参阅[文档](http://docs.oracle.com/javase/7/docs/technotes/tools/windows/java.html)。

- 更新：

1.  使用上述命令仅从 .jar 加载**jar**或**JAR**文件`dynamicLib`。
2.  通配符不是递归的：`dynamicLib\nestedDir`不会加载下面的 jar 文件。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:02:39.103

From Oracle's documentation

> ... Class paths to the .jar, .zip or .class files. Each classpath should end with a filename or directory depending on what you are setting the class path to:
> 
> For a .jar or .zip file that contains .class files, the class path ends with the name of the .zip or .jar file.
> 
> For .class files in an unnamed package, the class path ends with the directory that contains the .class files.
> 
> For .class files in a named package, the class path ends with the directory that contains the "root" package (the first package in the full package name).

[Source](http://docs.oracle.com/javase/1.5.0/docs/tooldocs/windows/classpath.html)

This then means that `-cp dynamiclib\*` won't work. If dynamic lib contains jars, you must specify each jar in the classpath, if it contains class files then defining the folder (without the *) should be enough, unless you have classes defined in the unnamed package AKA the default package.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2017-07-19T09:16:26.123

从 .jar 文件启动应用程序时，**命令行参数 -cp 被忽略**。相反，需要在**MANIFEST.MF 文件的“Class-Path”属性**中指定类路径。不幸的是，**此属性不支持通配符**，因此所有 .jar 文件都需要显式命名。

因此，只有在 .jar 文件的名称不变的情况下，拥有“dynamicLib”目录的最初想法才有效。

或者，您可以不使用中央 app.jar 而使用 .class 文件，从而允许您在命令行级别使用通配符。

# c - Mips 到 C 的转换

> ID：15207502
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:35:09.143
> 
> 标签：c, assembly, mips

我正在尝试将其转换为 C 代码，我知道它将是一个从 50 开始并向下运行的 forloop。但是我迷失在其他一些过程中，例如当我们进入中间时。

```
addi $t1, $0, 50
LOOP: lw $s1, 0($s0)
add $s2, $s2, $s1
lw $s1, 4($s0)
add $s2, $s2, $s1
addi $s0, $s0, 8
subi $t1, $t1, 1
bne $t1, $0, LOOP 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:40:36.697

立即它可能看起来像这样：

```
 t1 = 0 + 50;
LOOP:
    s1 = *s0;
    s2 = s2 + s1;
    s1 = *s0 + 4;
    s0 = s0 + 8;
    t1 = t1 - 1;
    if (t1 != 0) goto LOOP; 
```

转换`goto`为`for`循环：

```
int *s0 = /* ... */;
int s2 = /* ... */;

for (t1 = 50; t1 != 0; t1--) {
    s2 += *s0;
    s0 += 8;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-10T12:44:57.910

它直接翻译为：

```
int32_t* s0;
int32_t i = 50;
int32_t s2;
do {
    s2 += s0[j];
    s2 += s0[j+1];
    s0 += 2;
} while(--i); 
```

s0 和 s2 的初始值没有在汇编代码中给出，但我相信你可以弄清楚

# javascript - 删除 JQuery/Javascript 键盘钩子（例如 Portfolio Slide Gallery）

> ID：15207503
> 
> 赞同：2
> 
> 时间：2013-03-04T17:35:13.710
> 
> 标签：javascript, jquery, keyboard, event-handling, jquery-events

我在我的网站（[http://tympanus.net/codrops/2011/08/09/portfolio-image-navigation/](http://tympanus.net/codrops/2011/08/09/portfolio-image-navigation/)）中实现了投资组合幻灯片库，它包含用于图像导航的键盘事件处理程序。如果您查看链接，他会描述 init.js 文件，但下载中还包含portfolio.js、css 文件和演示 html。

不幸的是，在我用 AJAX 刷新内容窗格的地方，键盘处理程序仍然存在。在页面完全刷新之前，任何键盘按下都会被阻止。

我不确定该怎么做，但有一些我可能没有正确实施的想法。

1.  我想尝试结束“js 进程”，因为需要一个更好的术语，这可能与与 init.js 中的代码相关的调用有关；
2.  我已经尝试将捆绑的画廊 js 文件函数设置为空，该函数似乎将处理程序处理为空；
3.  我尝试过各种 jQuery 处理程序解绑程序，它们会抛出“...不是函数”。处理程序似乎也不在portfolio.js 中；
4.  我目前不在其他任何地方使用键盘，所以也许一个全局键盘处理程序 unbinder 函数可以解决它。

这里的任何帮助都会很棒，我会根据需要添加代码

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:41:38.437

从portfolio.js 中删除以下内容应该可以解决问题，这是我在codrops 示例中可以找到的唯一绑定。（编辑：下载演示的源代码并尝试，确认删除以下绑定有效。）

```
 $(document).bind(type, function(e) {
                            var code = e.keyCode ? e.keyCode : e.which;
                            if(code == key && $(element).is(':visible')) { 
                                if (!inside.is(':animated')) {
                                    inside.animate(object, s.animationSpeed, function(){
                                        plugin.position.get(inside);
                                    });
                                }
                            }
                            return false;
                        }); 
```

# amazon-web-services - S3 是否提供更快的检索或 EBS 块存储

> ID：15207516
> 
> 赞同：1
> 
> 时间：2013-03-04T17:36:01.963
> 
> 标签：amazon-web-services, amazon-s3

我正在创建一个富互联网应用程序，它必须从运行在 EC2 上的服务器中快速检索大量文件。我需要从任何 EC2 实例访问所有文件，并且检索速度极快。我想知道我应该使用 S3 还是 EBS 来存储文件？我倾向于 S3，因为它可以从任何 EC2 实例访问，但我担心它比 EBS 块存储慢。求高手指导。顺便说一句，我是亚马逊的新手！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:54:29.733

安装到您的实例的 EBS 磁盘将比 s3 更快。但是，您只能将 EBS 卷挂载到单个磁盘。有一些网络文件系统选项可以解决这个问题。

S3 是对象存储而不是块设备，它并不适合所有用例。

# regex - sed 删除 '.' 仅在字符串的一部分

> ID：15207517
> 
> 赞同：0
> 
> 时间：2013-03-04T17:36:04.227
> 
> 标签：regex, replace, sed

我可能在这里遗漏了一些基本的东西。我想删除以下字符串中 & 之间的所有 '.'。我应该在我的 sed 中使用什么正则表达式？

```
**&v15.0&** something.anything abc.deg
**&v15.03.15&** something.anything abc.deg
**&v15.01.16.01&** something.anything abc.deg
**&v15.000.155.123.125&** something.anything abc.deg 
```

修改为：

```
**&v150&** something.anything abc.deg
**&v150315&** something.anything abc.deg
**&v15011601&** something.anything abc.deg
**&v15000155123125&** something.anything abc.deg 
```

& 可以有任意数量的 '.'，我不希望 & 之外的 '.' 被修改。

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:49:12.373

试试这个oneliner：

```
awk -F'&' '{gsub(/\./,"",$2)}1' file 
```

如果你真的想用 sed 来做，并且你有**Gnu sed**，你可以这样做：

```
sed -r 's/([^&]*&)([^&]*)(&.*)/echo "\1"$(echo "\2"\|sed "s#\\.##g")"\3"/ge' file 
```

测试 sed 行：

```
kent$  echo "**&v15.0&** something.anything abc.deg
**&v15.03.15&** something.anything abc.deg
**&v15.01.16.01&** something.anything abc.deg
**&v15.000.155.123.125&** something.anything abc.deg"|sed -r 's/([^&]*&)([^&]*)(&.*)/echo "\1"$(echo "\2"\|sed "s#\\.##g")"\3"/ge'
**&v150&** something.anything abc.deg
**&v150315&** something.anything abc.deg
**&v15011601&** something.anything abc.deg
**&v15000155123125&** something.anything abc.deg 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:29:23.130

使用常规`sed`（也非 GNU）尝试：

```
sed -e :a -e 's/\(&.*\)\.\(.*&\)/\1\2/; ta' file 
```

# c# - 当我签出使用 EDMX 的 MVC 项目时，我必须按 Ctrl + S 来更新模型在进行自动构建时如何解决这个问题

> ID：15207519
> 
> 赞同：1
> 
> 时间：2013-03-04T17:36:04.470
> 
> 标签：c#, model-view-controller, entities, edmx

当我签出使用 EDMX 的 MVC 项目时，我必须先按 Ctrl + S 来更新模型，然后才能构建。否则我会得到很多构建错误。进行自动构建时如何解决这个问题

# php - Zend 在哪里使用 gethostname

> ID：15207520
> 
> 赞同：0
> 
> 时间：2013-03-04T17:36:07.343
> 
> 标签：php, zend-framework, session-variables

**目标：**我想知道是否可以在 Zend 框架中的*一个位置*确定主机是 localhost 还是我的开发站点的主机，并通过会话变量在站点的其余部分使用该确定。

**详细信息：**我正在与一小群人一起开发一个网站。我们使用 svn 工具来合并我们的代码，并在将更改和添加移动到开发服务器之前在 localhost 上进行测试。由于我们`gethostname()`在 php 中使用的每个平台都使用相同的代码来确定我们是通过 localhost 还是服务器访问我们的站点。我们需要这个，以便我们可以适当地设置文件路径（`http://localhost/images/dog.jpg`vs `https://mysite.com/images/dog.jpg`）。最初，每次这发挥作用时，我们都会在控制器中设置一个变量 $host，`public function init()`其中包含要在整个页面中使用的适当字符串。然后我们切换到将 $host 放入会话变量中，这显着减少了冗余代码的数量。但我确信有一种方法可以将它设置在*一个地方*并完成它，但我不知道这个地方会在哪里（在 Zend 框架内）。索引登录页面不起作用，因为用户可能会从其他地方进入。我最好的猜测是在布局中设置它，但这给了我错误，因为布局代码在页面加载过程中运行得太晚了。有没有更好的地方来确定主机？有没有办法在布局代码中对其进行优先级排序，以便在页面需要它之前以某种方式执行？

**代码：**

```
if(!isset($_SESSION['hostname'])){
  $hostname = gethostname();
  if ($hostname == 'prodserver') { 
    $_SESSION['hostname'] = 'https://mysite.com'; 
  } else { 
    $_SESSION['hostname'] = 'http://localhost'; 
  }
} 
```

我们目前的方法工作得很好，但我无法摆脱一定有更好的方法的感觉！如果你知道 - 我很想听听。谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:00:41.537

要回答您评论中的问题，不，会话变量根据定义是用户特定的。然而 ZF（按照惯例）设置了`APPLICATION_ENV`可用于执行特定环境检查的常量。您还可以通过设置变量（包括 baseUrl）。application.ini 如果需要，您将如何解决问题中的问题。

# asp.net-mvc - Facing issue while trying to Fetch Access Token required for Facebook

> ID：15207523
> 
> 赞同：0
> 
> 时间：2013-03-04T17:36:13.653
> 
> 标签：asp.net-mvc, asp.net-mvc-3, asp.net-mvc-2, asp.net-mvc-4, facebook-c#-sdk

My Url is like below...

```
http://localhost:1561/Facebook/Facebook/MainPage 
```

**Controller Class**

```
public class FacebookController : Controller
{
    public ActionResult MainPage()
    {
        return View();
    }

    public PartialViewResult ShowMyDetails()
    {
        return PartialView("FacebookUserControl");
    }

    [CanvasAuthorize(Permissions = "user_about_me, publish_stream")]
    public ActionResult GetMyDetails()
    {
        var fb = new FacebookClient();
        dynamic CurrentUser = fb.Get("100003533388420");
        User user = new User
        {
            id = CurrentUser.id,
            first_name = CurrentUser.first_name,
            gender = CurrentUser.gender,
            last_name = CurrentUser.last_name,
            name = CurrentUser.name,
            username = CurrentUser.username
        };
        return Json
        (
            user,
            JsonRequestBehavior.AllowGet
        );
    }
} 
```

I don't have any Facebook related in my Web.Config.

**Issue** - In case I add below mentioned line. I am facing Issue "**settings.AppId is null**"

```
[CanvasAuthorize(Permissions = "user_about_me, publish_stream")] 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:53:36.173

Let me preface this by saying that I have not worked on a canvas app before, so not really sure what the differences are.

But, when creating the FacebookClient, you need to provide the accessToken.

```
 public ActionResult LoginFacebookAuth(string access_token)
        {
            var accessToken = access_token;

            try
            {
                var facebookClient = new Facebook.FacebookClient(accessToken);

                dynamic me = facebookClient.Get("me");
                var fbUserId = me.id.ToString();
                var email = me.email.ToString();

... 
```

Also, in web.config, I do have an entry.

```
<appSettings>
   <add key="FbAppId" value="" /> 
```

Code in View that passes in access_token:

```
window.fbAsyncInit = function() {
                FB.init({
                    appId: '{FbAppId from web.config}',
                    status: true, // check login status
                    cookie: true, // enable cookies to allow the server to access the session
                    xfbml: true  // parse XFBML
                });
            };
            $(document).ready(function() {
                $('body').append('<div id="fb-root" name="fb-root"></div>');
                $('.fbLoginLink') //When my fb icon is clicked, call FbLogin
                    .click(function(e) {
                        e.preventDefault();
                        FbLogin();
                    });

            });
            // Load the SDK Asynchronously
            (function(d) {
                var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
                if (d.getElementById(id)) {
                    return;
                }
                js = d.createElement('script');
                js.id = id;
                js.async = true;
                js.src = "//connect.facebook.net/en_US/all.js";
                ref.parentNode.insertBefore(js, ref);
            }(document));

            function FbLogin() {
                FB.login(
                    function(response) {
                        if (response.authResponse) {
                            var uid = response.authResponse.userID;
                            var accessToken = response.authResponse.accessToken;
                            window.location = '@Url.RouteUrl("LoginFacebookAuth", new { })?accessToken=' + accessToken + '&uid=' + uid;
                        } else {
                            window.location = '/'; //User cancelled authorization
                        }
                    },
                    { scope: 'email,user_birthday' }
                ); //FB.login
            } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T06:43:50.513

```
public ActionResult GetFriendsDetails()
{
    List<User> UserList = new List<Models.User>();
    var fb = new FacebookClient("MyAppID", "MySecret");
    //This will give the Access Token
    dynamic FriendsList = fb.Get("MyAppID/friends");
    foreach (var item in FriendsList.data)
    {
        dynamic CurrentUser = fb.Get(item.id);
        UserList.Add
        (
            new User
            {
                id = CurrentUser.id,
                first_name = CurrentUser.first_name,
                gender = CurrentUser.gender,
                last_name = CurrentUser.last_name,
                name = CurrentUser.name,
                username = CurrentUser.username
            }
        );
    }
    return Json
    (
        UserList,
        JsonRequestBehavior.AllowGet
    );
} 
```

# iphone - 实现一个可以通过触摸进行拉伸和旋转的 UIView

> ID：15207525
> 
> 赞同：1
> 
> 时间：2013-03-04T17:36:26.300
> 
> 标签：iphone, ios, cocoa-touch, uiview, uigesturerecognizer

我正在尝试实现执行以下操作的矩形视图。当用户从左侧或右侧拖动矩形视图时，它会拉伸如下：

![在此处输入图像描述](../Images/ea1953891e9141c89c315b9af974a755.png)

当用户在 UIView 上拉起或拉下时，它会旋转如下：

![在此处输入图像描述](../Images/a1a02640c8faf3532e77052c272152fc.png)

想知道是否有人可以给我一个关于如何实现这一点的线索。我不相信你可以用手势识别器来做到这一点。有人知道吗？

更新：假设没有轮换，这实际上还不错。您可以按用户向左或向右拖动的量拉伸它，或者按他们向上拉的量旋转它。但是，当视图旋转时，这种方法不再有效，因为点发生了变化。关于如何执行此操作的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-06T18:57:11.870

我有一个 Github 项目，展示了如何轻松使用每种类型的 UIGesture，包括捏调整大小和旋转。

查看“捏合”、“旋转”和“同时”部分。我想你会找到你正在寻找的东西。

[https://github.com/EmperiorEric/UIGestures](https://github.com/EmperiorEric/UIGestures)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:20:37.237

您可以使用手势识别器来做到这一点。但是，当这些手势发生时，您需要告诉 iOS 如何处理视图。

您将放入旋转手势识别器操作的代码如下所示：

```
self.myView.transform = CGAffineTransform(CGAffineTranformIdentity, self.rotationRecognizer.rotation);
// Where myView is an outlet to your UIView
// rotationRecognizer is an outlet to your rotation gesture recognizer 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:55:41.713

看看这些 UIView 方法。您的子类可以覆盖这些方法并执行您需要的操作。

`touchesBegan:withEvent:, touchesMoved:withEvent:, touchesEnded:withEvent:, touchesCancelled:withEvent:`

*   如果您需要直接处理触摸事件，请实现这些方法。（对于基于手势的输入，请使用手势识别器。）

# jquery - 选择带有 ID 的表单不起作用，但使用 $('form') 选择它可以

> ID：15207528
> 
> 赞同：2
> 
> 时间：2013-03-04T17:36:37.930
> 
> 标签：jquery, jquery-selectors, forms

我在我的代码中发现了一些奇怪的东西，我通过使用 $('form') 选择元素来解决它但是我的页面上可能有一个或多个表单以避免全局选择，我只想选择一个特定的表单元素。

我的问题是从序列化（）开始，通过使用 ID 选择器选择我的特定表单，但我无法在 .submit 事件时序列化。但是，如果我选择带有 ID ($("#formid")) 的表单，serialize() 不适用于表单提交。

我的 JS 代码是：

```
var entrylist = $('form');  //<< if I put $("#entrylist) here, 'data' displays null.
  entrylist.submit(function(e){
  e.preventDefault();
  var data = JSON.stringify($(this).serializeObject())
  console.log(data);
}); 
```

形式是：

```
<form id="entrylist" action="" method="post">
 <textarea name="inputarea"></textarea>
 some more inputs.. bla bla
</form> 
```

$('form') 的结果

```
{"inputarea":"brobrobrobro","thread_id":"399196","csrf_token":"aIw3dXzCbJGp4c32PzPeo9pVDKwTkCuQotyRWVll"} 
```

$('#entrylist') 的结果

```
{} 
```

注意：serializeObject 是我从[https://stackoverflow.com/a/1186309/1932414获得的自定义函数](https://stackoverflow.com/a/1186309/1932414)

# jsf-2 - 自定义验证器不适用于 sjf 中的下拉菜单

> ID：15207530
> 
> 赞同：0
> 
> 时间：2013-03-04T17:36:38.887
> 
> 标签：jsf-2

我在 jsf 中有一个用于下拉菜单的自定义验证器。但是这个自定义验证器永远不会被调用。

下面是具有自定义验证器 categoryValidator 的代码

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"   
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core">

      <h:head>
          <h:title>Add Category</h:title>
      </h:head>

      <h:body>
        <h:form>
            <h:panelGrid columns="3">
                <h:outputLabel id="catNameLabel" value="Category name" for="j_catName"/>
                <h:inputText id="j_catName" value="#{categoryActionBean.category.name}" required="true"
                  label="Cateory name">
                   <f:validateRequired />
                </h:inputText>
                <h:message for="j_catName" style="color:red;"/>

                <h:outputLabel id="catDescLabel" value="category Description" for="j_catDesc"/>
                <h:inputText id="j_catDesc" value="#{categoryActionBean.category.description}" required="true"
                  label="Category Description">
                    <f:validateRequired />
                </h:inputText>
                <h:message for="j_catDesc" style="color:red;"/>

                <h:outputLabel id="selParentCatLabel" value="Parent Category" for="j_selParentCat"/>
                <h:selectOneMenu id="j_selParentCat" value="#{categoryActionBean.selectedParentCategory}"
                 label="Selected category">
                     <f:validator validatorId="categoryValidator"/>
                     <f:selectItem itemValue="" itemLabel="">
                         <f:param name="isParent" value=""/>
                     </f:selectItem>
                     <c:forEach items="#{categoryActionBean.categories}" var="catMap">
                        <f:selectItem itemValue="#{catMap.key}" itemLabel="#{catMap.value.name}">
                           <f:param name="isParent" value="false"/>
                        </f:selectItem>
                     </c:forEach>
                </h:selectOneMenu>
                <h:message for="j_selParentCat" style="color:red;"/>

            </h:panelGrid>

            <h:commandButton value="Save category" action="#{categoryActionBean.saveCategory}" type="submit"/>
          </h:form>  
      </h:body>

</html> 
```

下面是我的自定义验证器。

```
package com.auction.jsf.validator;

import javax.faces.application.FacesMessage;
import javax.faces.component.UIComponent;
import javax.faces.context.FacesContext;
import javax.faces.validator.FacesValidator;
import javax.faces.validator.Validator;
import javax.faces.validator.ValidatorException;

@FacesValidator("categoryValidator")
public class CategoryValidator implements Validator{

      @Override
    public void validate(FacesContext context, UIComponent component,
            Object value) throws ValidatorException {

             System.out.println("Inside category validator");

         // My validation logic
         ---
         ---
         ---

         if(validationFalied) {
                   throw new ValidatorException(facesMessage);

         }
        }

} 
```

不调用选择菜单的 categoryValidator。任何帮助表示赞赏。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:05:17.923

您可以对 selectedParentCategory 使用 Bean Validation (JSR 303)，请参阅在 Jeetutorial6 第 206 页上使用 BeanValidation。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:52:12.787

您需要在`faces-config.xml`

```
<validator>
    <validator-id>customValidator</validator-id>
    <validator-class>path to this categoryValidator class</validator-class>
</validator> 
```

或者你可以直接在 Jsf 2.0 +versions 中注释

```
 @FacesValidator("path to this categoryValidator class")
    public class CategoryValidator {

} 
```

但不要两者都做。即使你这样做也`faces-config.xml`优先。

# excel - 设置打印区域时防止激活用户表单

> ID：15207535
> 
> 赞同：1
> 
> 时间：2013-03-04T17:36:47.687
> 
> 标签：excel, vba

对此可能有一个非常简单的答案。我在 Excel 电子表格上设计了一张捕获表，并为单元格 D2 使用了 DatePicker。到目前为止，一切都很好。当我关闭电子表格时，我有一个小宏设置打印区域 B1:M37 准备打印。发生这种情况时，宏会激活必须手动关闭的日期选择器，然后我才能继续打印。如何抑制事件发生，或使用代码关闭用户表单。我的代码如下：

```
Sub Test_a_Print_again()
    Range("B1:M37").Select 
    ActiveSheet.PageSetup.PrintArea = "$B$1:$M$37"
       ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _
        IgnorePrintAreas:=False
    Range("B1").Select
End Sub  

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If Not Intersect(Target, Range("D2")) Is Nothing Then frmCalendar.Show        '
End Sub 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:33:40.707

您的 SelectionChange 事件由以下行触发：

```
Range("B1:M37").Select 
```

你可以做几件事：

*   不要使用选择。目前尚不清楚这里是否需要它，除非绝对必要，否则它是 VBA 最糟糕的做法之一。
*   在您的 Worksheet_SelectionChange 事件中，如果您只希望它在 D2 并且仅选择 D2 时运行，您可以添加另一个条件：

    If Target.Cells.Count > 1 Then Exit Sub If Not Intersect(Target, Range("D2")) Is Nothing Then frmCalendar.Show

但同样，我只是摆脱了 Select 语句。

# open-source - 可以定义用户权限以读取页面部分的开源 CMS

> ID：15207538
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:36:52.803
> 
> 标签：open-source, content-management-system

是否有允许为页面的一部分而不是整个页面定义用户读取权限的开源 CMS（甚至只是一个 wiki）？

我有一个用例要求页面的某些部分对某些用户不可见，我在谷歌搜索时遇到了真正的麻烦，因为显然不同的 CMS 倾向于使用略有不同的术语。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:43:34.587

在 Drupal 中，您可以从代表（可以说）单个内容块并且可以单独提供的部分构建页面。我不确定标准模块集是否能提供您想要的，但只需稍作修改即可。

Drupal：[http ://drupal.org/](http://drupal.org/)

CMS Made Simple 有一个“前端用户”模块，可以根据用户显示整个页面。但是，如果您将 {if $loggedIn}secured content{endif} （伪代码）之类的智能标签添加到相关模板中，您可以创建如下功能：打开部分/安全部分/打开部分/安全部分/打开部分/安全部分/打开部分/一页/模板上的安全部分。

CMSms：[http ://www.cmsmadesimple.org/](http://www.cmsmadesimple.org/)

我确信 Joomla 和 Typo3 可以以类似或其他方式做这样的事情，但在这里我没有经验。

# ruby-on-rails - 设计身份验证有时会以 302 而不是 201 响应

> ID：15207539
> 
> 赞同：2
> 
> 时间：2013-03-04T17:37:06.607
> 
> 标签：ruby-on-rails, login, devise, http-response-codes

我稍微修改了 Devise 的会话控制器，即使用户已登录，它也会以 201 代码响应：

```
class SessionsController < Devise::SessionsController
  # POST /resource/sign_in
  def create
    resource = warden.authenticate!(auth_options)
    set_flash_message(:notice, :signed_in) if is_navigational_format?
    sign_in(resource_name, resource)
    resource[:is_admin] = resource.is_admin?
    #respond_with resource, :location => after_sign_in_path_for(resource)
    render :status => :created, :location => '/#/editor', :json => resource
  end
end 
```

（最后一行替换了注释的行），但它一直以 302 状态代码而不是 201 响应身份验证 JSON。我做错了什么？

# iphone - xcode 在视图之间传递 3 个 nsstring 值时遇到问题

> ID：15207543
> 
> 赞同：0
> 
> 时间：2013-03-04T17:37:21.813
> 
> 标签：iphone, ios, objective-c, nsview

大家好，我在视图之间传递值时遇到了很多麻烦，

我有一个带有 3 个文本框 FirstName LastName 电子邮件的 StartViewController 我想将它们的值传递给 ViewController 我尝试了一些不同的东西，但我所做的似乎没有任何工作我试过这个： [http ://highscoreapps.blogspot.com/ 2012/05/passing-data-between-view-controllers.html](http://highscoreapps.blogspot.com/2012/05/passing-data-between-view-controllers.html) [http://www.theappcodeblog.com/2011/04/15/passing-data-between-views-tutorial-using-a-protocol-delegate-in -你的 iPhone 应用程序/](http://www.theappcodeblog.com/2011/04/15/passing-data-between-views-tutorial-using-a-protocol-delegate-in-your-iphone-app/)

但我似乎无法得到任何工作。到目前为止，这是我的一些代码：

在 StartViewControler.h

```
@protocol DataPassingControllerDelegate <NSObject>

-(void)passDataMethod:(NSString *)TextFirstName Data2:(NSString *)TextLastName Data3:(NSString *)TextEmail;

@property(nonatomic,retain) IBOutlet UITextField *uTextFirstName;
@property(nonatomic,retain) IBOutlet UITextField *uTextLastName;
@property(nonatomic,retain) IBOutlet UITextField *uTextEmail;

@property (nonatomic, strong) NSString *sTextFirstName;
@property (nonatomic, strong) NSString *sTextLastName;
@property (nonatomic, strong) NSString *sTextEmail; 

@property (nonatomic, unsafe_unretained) id<DataPassingControllerDelegate> delegate; 
```

在 StartViewController.M

```
-(IBAction)ButtonTakeSurvey:(id)sender{
self.sTextFirstName = uTextFirstName.text;
self.sTextLastName = uTextLastName.text;
self.sTextEmail = uTextEmail.text;

[self.delegate passDataMethod:sTextFirstName Data2:sTextLastName Data3:sTextEmail];

ViewController *myView1 = [[ViewController alloc]initWithNibName:@"ViewController" bundle:nil];
[self.view addSubview:myView1.view];
} 
```

在 ViewController.HI 中添加了 #import "StartViewController.h"

```
@interface ViewController : UIViewController <DataPassingControllerDelegate> 
```

如何在 ViewController.m 上获取 firstName LastName 电子邮件我希望它填充我已加载的 3 个局部变量。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:08:41.790

我通常使用单例类来处理 ViewController 之间的通信。单例模式允许您将数据与控制器本身分开。下面是我使用的代码版本。

数据管理器.h

```
#import <Foundation/Foundation.h>

@interface DataManager : NSObject

+(DataManager*)sharedInstance;
-(void) setObject:(id)anObject forKey:(id<NSCopying>)aKey;
-(id) objectForKey:(id)aKey;
-(void) removeAllObjects;
@end 
```

数据管理器.m

```
#import "DataManager.h"

@implementation DataManager

static DataManager *sharedInstance;
static NSMutableDictionary* dictionary;

- (id)init {
    self = [super init];
    if (self) {
        dictionary = [[NSMutableDictionary alloc] initWithCapacity:0];
    }
    return self;
}

+ (DataManager *) sharedInstance
{
    @synchronized(self)
    {
        if (sharedInstance == NULL)
        {
            sharedInstance = [[DataManager alloc] init];
        }
    }

    return sharedInstance;
}

-(void) setObject:(id)anObject forKey:(id<NSCopying>)aKey
{
    [dictionary setObject:anObject forKey:aKey];
}

-(id) objectForKey:(id)aKey
{
    return [dictionary objectForKey:aKey];
}

-(void) removeAllObjects
{
    [dictionary removeAllObjects];
}

@end 
```

为了使用它，您所要做的就是在第一个视图控制器中，获取 sharedInstance 并在推送（或在模态 VC 的情况下呈现）ViewController 之前设置值。

```
DataManager* dm = [DataManager sharedInstance]
[dm removeAllObjects];
[dm setObject:firstNameString forKey:@"firstName"];
[dm setObject:lastNameString forKey:@"lastName"];
[dm setObject:emailString forKey:@"email"]; 
```

然后在第二个 ViewController 的 ViewDidLoad （或 viewWillAppear 或其他）中，您可以从单例中获取值，例如：

```
DataManager* dm = [DataManager sharedInstance]
NSString* firstName = (NSString*)[dm objectForKey:@"firstName"];
NSString* lastName = (NSString*)[dm objectForKey:@"lastName"];
NSString* email = (NSString*)[dm objectForKey:@"email"];
//do stuff with the values. 
```

如果您想了解更多关于单例的信息（如果您目前不熟悉该模式，我会推荐它）维基百科文章非常好，并且有许多 OO 设计站点对其进行了更详细的讨论。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:48:35.493

我建议将数据模型与您的控制器分开。有很多方法可以做到这一点，但一种简单的方法是创建一个“用户配置文件”类作为单例（跨应用程序的共享实例）并将数据存储在那里。这样，每个需要该数据的控制器都可以自己访问它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:02:41.263

在我看来，您需要做的就是添加`passDataMethod`到您的 ViewController.m 中：

```
-(void)passDataMethod:(NSString *)TextFirstName Data2:(NSString *)TextLastName Data3:(NSString *)TextEmail
{
    NSString *myLocalVar1 = [NSString stringWithString:TextFirstName];
    NSString *myLocalVar2 = [NSString stringWithString:TextLastName];
    NSString *myLocalVar3 = [NSString stringWithString:TextEmail];

    // Do something useful with myLocalVar1, 2, and 3 here
} 
```

# objective-c - 如何让相机在 UIPopoverController 内的 iPad 上工作？

> ID：15207544
> 
> 赞同：1
> 
> 时间：2013-03-04T17:37:25.153
> 
> 标签：objective-c, xcode, ipad, uiimagepickercontroller, uipopovercontroller

我正在尝试编写使用相机或照片库拍照的 iOS 应用程序。这是我的第一个 iOS 应用程序，所以我没有经验。我找到了几个如何为 iPhone 执行此操作的示例，并将模态窗口调用替换`presentViewController`为`IUPopoverController`. 这适用于照片库 ( `imagePicker.sourceType = UIImagePickerControllerSourceTypePhotoLibrary`) 但对于相机 ( `imagePicker.sourceType = UIImagePickerControllerSourceTypeCamera`) 有以下错误：

```
Terminating app due to uncaught exception 'NSGenericException', reason: 'The content view controller argument must be the root of its associated view controller hierarchy.' 
```

使用 Xcode 4.6 测试 iOS 6.1

我的代码：

```
- (void) useCamera:(id)sender
{
    if ([UIImagePickerController isSourceTypeAvailable:
         UIImagePickerControllerSourceTypeCamera])
    {
        UIImagePickerController *imagePicker =
        [[UIImagePickerController alloc] init];
        imagePicker.delegate = self;
        imagePicker.sourceType =
        UIImagePickerControllerSourceTypeCamera;
        imagePicker.mediaTypes = @[(NSString *) kUTTypeImage];
        imagePicker.allowsEditing = NO;

        if(UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)
        {
            _popover = [[UIPopoverController alloc] initWithContentViewController: imagePicker];
            [_popover presentPopoverFromRect: _popoverCenter inView:self.view permittedArrowDirections:UIPopoverArrowDirectionUp animated:YES];
        }
        else
        {
            [self presentViewController:imagePicker
                               animated:YES completion:nil];
        }

        _newMedia = YES;
    }
    else
    {
        UIAlertView *alert = [[UIAlertView alloc]
                              initWithTitle: @"Camera failed to open"
                              message: @"Camera is not available"
                              delegate: nil
                              cancelButtonTitle:@"OK"
                              otherButtonTitles:nil];
        [alert show];
    }
} 
```

是否可以在 iPad 上的弹出框内显示相机？谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T18:09:19.823

以下回答了OP关于如何在iPad上全屏显示相机的评论。

将您的代码更改为：

```
- (void) useCamera:(id)sender
{
    if ([UIImagePickerController isSourceTypeAvailable:
         UIImagePickerControllerSourceTypeCamera])
    {
        UIImagePickerController *imagePicker =
        [[UIImagePickerController alloc] init];
        imagePicker.delegate = self;
        imagePicker.sourceType =
        UIImagePickerControllerSourceTypeCamera;
        imagePicker.mediaTypes = @[(NSString *) kUTTypeImage];
        imagePicker.allowsEditing = NO;
        imagePicker.modalPresentationStyle = UIModalPresentationFullScreen;

        [self presentViewController:imagePicker
                           animated:YES completion:nil];

        _newMedia = YES;
    }
    else
    {
        UIAlertView *alert = [[UIAlertView alloc]
                              initWithTitle: @"Camera failed to open"
                              message: @"Camera is not available"
                              delegate: nil
                              cancelButtonTitle:@"OK"
                              otherButtonTitles:nil];
        [alert show];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-12-11T09:41:01.757

```
-(void)showCamera
{
UIImagePickerController *cameraUI = [[UIImagePickerController alloc] init];
cameraUI.sourceType = UIImagePickerControllerSourceTypeCamera;

// Displays a control that allows the user to choose picture or
// movie capture, if both are available:
cameraUI.mediaTypes =
    [UIImagePickerController availableMediaTypesForSourceType:
        UIImagePickerControllerSourceTypeCamera];

// Hides the controls for moving & scaling pictures, or for
// trimming movies. To instead show the controls, use YES.
cameraUI.allowsEditing = NO;

cameraUI.delegate = delegate;

[controller presentModalViewController: cameraUI animated: YES];
}

- (void) imagePickerControllerDidCancel: (UIImagePickerController *) picker {

[[picker parentViewController] dismissModalViewControllerAnimated: YES];
[picker release];
}

// For responding to the user accepting a newly-captured picture or movie
- (void) imagePickerController: (UIImagePickerController *) picker
        didFinishPickingMediaWithInfo: (NSDictionary *) info {

NSString *mediaType = [info objectForKey: UIImagePickerControllerMediaType];
UIImage *originalImage, *editedImage, *imageToSave;

// Handle a still image capture
if (CFStringCompare ((CFStringRef) mediaType, kUTTypeImage, 0)
        == kCFCompareEqualTo) {

    editedImage = (UIImage *) [info objectForKey:
                UIImagePickerControllerEditedImage];
    originalImage = (UIImage *) [info objectForKey:
                UIImagePickerControllerOriginalImage];

    if (editedImage) {
        imageToSave = editedImage;
    } else {
        imageToSave = originalImage;
    }

// Save the new image (original or edited) to the Camera Roll
    UIImageWriteToSavedPhotosAlbum (imageToSave, nil, nil , nil);
}

// Handle a movie capture
if (CFStringCompare ((CFStringRef) mediaType, kUTTypeMovie, 0)
        == kCFCompareEqualTo) {

    NSString *moviePath = [[info objectForKey:
                UIImagePickerControllerMediaURL] path];

    if (UIVideoAtPathIsCompatibleWithSavedPhotosAlbum (moviePath)) {
        UISaveVideoAtPathToSavedPhotosAlbum (
                moviePath, nil, nil, nil);
    }
}

[[picker parentViewController] dismissModalViewControllerAnimated: YES];
[picker release];
} 
```

# java - 从 Java 运行 .bat 不显示 CMD

> ID：15207548
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:37:33.857
> 
> 标签：java, batch-file, runtime.exec

我正在尝试运行`a.bat`位于此处的文件：

**C:\A\B\C\DE\F**

所以我调用：

```
cmd /c "cd C:\A\B\C\D E\F && a.bat" 
```

在 CMD 上，我可以看到文件的执行。

现在我想运行这个文件`Java`然后删除它，所以我运行：

```
Runtime.getRuntime().exec("cmd start /wait /c "+ "\"cd C:\\A\\B\\C\\D E\\F && a.bat\""); 
```

（`/wait`因为我只想在执行后删除文件）

但我没有看到程序的执行（CMD 没有打开）。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:50:17.257

```
Runtime run = Runtime.getRuntime();  
        Process process = null;  
        String cmd = "cmd start /wait /c "+ "\"cd C:\\A\\B\\C\\D E\\F && a.bat\"";  
        try {  
            process = run.exec(cmd);
            process.waitFor();
            System.out.println(process.exitValue());
        }  
        catch (IOException e) {  
            e.printStackTrace();  
            process.destroy();  
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:01:12.097

我建议你输入命令：

```
start /wait /c "cd C:\A\B\C\D E\F && a.bat" 
```

在一个单独的批处理文件中（比如`abc.bat`）。然后使用以下行
运行该文件：`abc.bat`

```
Process process = Runtime.getRuntime().exec("rundll32 url.dll,FileProtocolHandler " + "abc.bat");
process.waitFor();//throws InterruptedException . So it must be caught.
if (process.exitValue() == 0 )
{
 System.out.println("Process is executed successfully!");
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T18:20:46.583

这有点乱。当然，您的第一个命令可以在命令提示符下运行，但随后您尝试在 java.util 中运行一个完全不同的（并且不起作用的）命令。

我假设您要从 java 中删除 a.bat，在这种情况下，START /WAIT 永远不会对您有任何好处。子进程将等待 START 的目标完成，但这对您的 java 进程没有影响。

为什么不让子进程删除文件？我相信以下将起作用。

```
Runtime.getRuntime().exec("cmd /c \"cd C:\\A\\B\\C\\D E\\F&&a.bat&&del a.bat\""); 
```

直到批处理脚本完成后，删除命令才会触发。如果您想始终删除脚本，即使它失败，也请更改`&&`为`&`.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T18:07:34.587

我找到了解决方案:)

我将**start /wait**移至命令的第二部分，它起作用了：

`Runtime.getRuntime().exec("cmd "+ "\"cd C:\\A\\B\\C\\D E\\F && start /wait a.bat\"");`

# frameworks - 工单系统的 ColdFusion 框架

> ID：15207552
> 
> 赞同：4
> 
> 时间：2013-03-04T17:37:57.023
> 
> 标签：frameworks, coldfusion, cfml

在过去的两年里，我一直在使用 ColdFusion。到目前为止，我只使用了一个框架：fusebox（一个较旧的框架）。根据我的下一个开发需求，我必须开发一个“工单软件系统”，但使用的是ColdFusion框架。我的问题是我应该使用哪个框架？我对使用哪一个有点困惑。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:58:56.343

如果您来自 Ruby on Rails 背景，那么您会喜欢 CFWheels - [http://cfwheels.org/](http://cfwheels.org/)

即使你不是，它也是一个很棒的框架。我的第一个而且很容易上手！有据可查，并有大量示例可供参考。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T06:38:15.303

如果您喜欢面向对象的技术，那么我将参考 Model-Glue 和 Coldbox。Model-Glue 支持 Ajax 和 jQuery，但需要比 Coldbox 更多的努力。两者都使用事件来调用函数。有关更多信息，请访问[model-glue](http://www.model-glue.com/blog/index.cfm/2007/11/5/ModelGlue--New-Flex-Integration-Features)，[coldbox](http://www.coldbox.org/) 您需要阅读视图如何工作，但文档的此页面简洁地总结了它：

[http://docs.model-glue.com/wiki/ReferenceMaterials/ViewApi#ViewAPI](http://docs.model-glue.com/wiki/ReferenceMaterials/ViewApi#ViewAPI)

特别是这段代码片段：

```
<cfoutput>#viewcollection.getView("body")#</cfoutput> 
```

这可能是一个阅读文档的案例，并提醒自己模型胶水的 MVC 实现（特别是 V 部分，在您的情况下！）是如何工作的。

# javascript - 检测多个类中的一个类的 if 语句

> ID：15207553
> 
> 赞同：0
> 
> 时间：2013-03-04T17:37:58.120
> 
> 标签：javascript, if-statement, equality

我有这个简单的 if 语句：

```
if(comments.className === "hide") 
```

但是，我试图“选择”的元素的类是`class="hide slide"`，如果是这种情况，这似乎不起作用。我将如何写这个，以便他在 2 个班级中“找到”隐藏？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:40:11.987

您可以使用`comments.className.split(/\s+/);`然后迭代选项以找到您想要的

```
var classes = comments.className.split(/\s+/);
var classexists = false;
for(i=0; i<classes.length; i++){
    if(classes[i] === "specifiedclass"){
        classexists = true;
        break;
    }
if(classexists){... 
```

### 作为一个函数来做这个

```
function hasClass(desiredClass,el){
  var classes = el.className.split(/\s+/);
    var classexists = false;
    for(i=0; i<classes.length; i++){
        if(classes[i] === desiredClass){
            classexists = true;
            break;
        }
    }
   return classexists;
}
if(hasClass("specifiedclass",comments){... 
```

（感谢`the system`您的建议）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:55:27.527

如果他用可能的空格或开始或结束标记测试“隐藏”，dogberts 解决方案（已删除）会更好 -

```
if(/(^|\s)hide(\s|$)/.test(comments.className)) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:41:14.120

使用`split`并循环它（或使用[kennebec 和 Dogbert 的优雅正则表达式解决方案](https://stackoverflow.com/a/15207847/157247)，它也适用于任何边缘情况）：

```
var parts = comments.className.split(" ");
var hasHide = false;
for (var i=0;i<parts.length;i++){
   if (parts[i] == "hide"){
      hasHide = true;
   }
}
if (hasHide){
   //...
} 
```

或者使用 jQuery：

```
 if ($(comments).hasClass("hide")){
      //...
   } 
```

# asp.net - ASP.NET 无法读取网络文件夹中的 Access DB

> ID：15207554
> 
> 赞同：0
> 
> 时间：2013-03-04T17:38:09.657
> 
> 标签：asp.net, ms-access, oledb

我有一个 ASP.NET 页面，它需要将一些数据推送到一个使用 Access 2003 数据库作为后端的旧程序。我已经设置了所有连接字符串来执行此操作（成功到数据库的本地副本）但是当我尝试从其网络共享位置的数据库中读取时，我收到以下错误：

> **无法读取记录；'tblDevice' 没有读取权限。**

数据库上没有密码或任何安全措施，所以我很确定这与网络有关。我不知道有什么方法可以在[连接字符串](http://www.connectionstrings.com/access)中包含网络登录名/密码。我认为这将需要将某个用户添加到文件夹中。但是，我不确定哪个用户需要对该文件夹的权限才能使其工作（来自 Visual Studio 和 IIS）。任何人都有过此类错误的经验或知道需要向哪些“用户”授予对该文件夹的权限？

* * *

我的参考代码：

**访问连接字符串**

```
Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\\srv.local\SHAREDOCS\data.mdb;
    User Id=admin;Password=; 
```

**选择代码**

```
public static DataTable GetDevices(string serialNum)
{
    var conn = new OleDbConnection();
    var builder = new OleDbConnectionStringBuilder();
    builder.ConnectionString = ConfigurationManager.ConnectionStrings["development"].ToString();
    conn = builder.ConnectionString;

    var sqlString = "SELECT DeviceID, SN FROM tblDevice WHERE Active=True AND SN=@serialNum ORDER BY SN, DeviceID; "

    using (var cmd = new OleDbCommand(sqlString, conn))
    {
        cmd.Parameters.AddWithValue("@serialNum", serialNum);
        var ds = new DataSet();
        var da = new OleDbDataAdapter(cmd);

        da.Fill(ds);

        return ds.Tables[0];
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:40:47.560

Finally figured this out, and it was no where near what I expected. For some odd reason, the database had random differences in permission on the various tables. (Some had full access, some none, some mixed... no rhyme or reason from what I know about the way the program works.) To get to the permissions, I had to go here *(Access 2010 but a 2003 MDB file)*:

`File -> Info -> Users and Permissions -> User and Group Permissions...`

That presented me with the following options:

![enter image description here](../Images/e2d9f5a11178abc9265640496a9adb80.png)

All I had to do was check the appropriate permissions for each object and now it works.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:42:59.563

检查运行应用程序池的服务帐户是否具有对数据库的权限。如果您的服务帐户在没有权限下运行，那么您很可能会遇到这样的问题。

# c# - 此方案不支持数据库预览

> ID：15207566
> 
> 赞同：0
> 
> 时间：2013-03-04T17:38:29.627
> 
> 标签：c#, asp.net, visual-studio, asynchronous

我最近开始在 Visual Studio for Web 应用程序中使用发布功能。我正在我的 PC 上运行一个 LocalDB 实例，我想与我的主机同步。

但是，当我进入“预览”选项卡（发布向导中的最后一步）页面时，它说由于选择了“场景”而无法生成预览。

这是一个屏幕截图。

![在此处输入图像描述](../Images/f3e9d293b272a6e90914d57b84b223c1.png)

**编辑**应该注意的是，我使用的是 LocalDB 实例。这可能是为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-21T14:25:48.657

结果是我指定了要以编程方式使用的连接字符串，而不是在我的 web.config 文件中。在那里添加它们并制作转换 web.config 文件后，它工作得很好。

# database - sql用另一个表计算多条记录

> ID：15207573
> 
> 赞同：0
> 
> 时间：2013-03-04T17:38:52.340
> 
> 标签：database, oracle, relational-database, calculated-columns

我这里有两张桌子。我想要的是计算（添加）这两个表中的金额和余额。但困难在于事务表中的两个account_no 相同（A-102）。那么如何添加`amount`到`balance`when `transactions.account_id`= `account.account_no = A-102`??

![这是交易表](../Images/13f49d5b02393460ad1735ed9ec4a348.png)

![账户表](../Images/b174ca212e04b7f8b324934bc0725b73.png)

我所做的是：

```
 select account_no, balance + (
                              select t.amount
                              from transactions t
                              where t.account_no = 'A-222')
    from b_account 

    where account_no = 'A-222'; 
```

此方法仅适用于 A-305 和 A-222。这么写就不行了。。

```
select account_no, balance + (
                              select t.amount
                              from transactions t
                              where t.account_no = (
                                                    select t.account_no 
                                                    from b_account ba, transactions t
                                                    where ba.account_no = t.account_no
                                                    )      
                              )
from b_account 
where account_no = (select t.account_no 
                    from b_account ba, transactions t
                    where ba.account_no = t.account_no); 
```

任何帮助，谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:51:02.913

您可以`group`按帐号和`sum`所有金额，然后将结果加入帐户表。试试这个

```
with cte as
(
 select account_no, SUM(t.amount) amount
 from transactions t
 --where t.account_no = 'A-222'
 group by account_no
)

Select a.account_no, balance + coalesce(b.amount,0) new_balance
from b_account a
left outer join cte b on a.account_no = b.account_no
--where a.account_no = 'A-222' 
```

# regex - regex to match group of characters

> ID：15207581
> 
> 赞同：1
> 
> 时间：2013-03-04T17:39:21.397
> 
> 标签：regex, preg-match

This regex `^.*.*.*.*.*.*00` will return true for this number `10102001` with preg_match.

i know that will catch the first seven numbers, but if the last number is not 0, so, the result should be false and not true. This is what I need. For this number the regex will work as i expect (false): `10102011`

```
10102001 -- true why?
10102011 -- false 
```

What is wrong with the regex?

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:44:38.970

`.*` will match zero or MORE of any character that is not a line break. Your regex would actually be equivalent to just writing `^.*00`. It matches because there is the substring "1010200" in "10102001".

You will want something like: `^.{6}00` (which is the same as `^......00`) to give you what you want. Better yet, you'd probably want to be more specific and specify that you only want numbers prefixed. So `^[0-9]{6}00`. And if you what to make sure that the 0s at the end are at the very end of the line or target string, then add on a $. `^.{6}00$`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:42:30.313

> 10102001 -- true why?

Because you are not matching to the end of string so the regex will match anything with 00 *somewhere* before the end (anything may follow the zeroes). In addition, `*` means "zero or more", which means that `.*` matches anything - the empty string, ten characters, four characters, 1 character...

Here is a regex that catches everything which starts with 7 characters and ends in two zeroes (9 characters in total):

```
^.......00$ 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:41:38.647

Your regex is all kinds of messed up. The last 5 `.*`s are pointless, `^.*00` would do the same thing.

`10102001` is true because it's matching its substring, `1010200`. It's leaving the 1 on the end off. If you want to check and see if it matches the entire string, use this: `^.*00$`.

Here's what your regex is doing. Add a `$` at the end to see how it should work.

[http://www.regex101.com/r/wK3qI1](http://www.regex101.com/r/wK3qI1)

I can't make any recommendations for how your regex should be other than that, since you haven't posted any constraints.

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T17:43:03.880

this should be the right regex for you:

```
[0-9]{7}0$ 
```

# ajax - 使用 ajax 将 JSON 数据发送到私有服务器时出错

> ID：15207589
> 
> 赞同：1
> 
> 时间：2013-03-04T17:39:55.010
> 
> 标签：ajax, google-chrome, userscripts

我对为 Chrome/Firefox 编写用户脚本非常陌生。我试图从网站获取 AJAX 生成的 JSON 数据并将它们发送到我自己的服务器，以分析它们并将它们放入数据库中。

我设法使用 Ajax 发送数据并将它们放入我自己服务器上的文本文件中。但在 Chrome 控制台中，它说我有：

> 未捕获的 SyntaxError：意外的标记 j

，但我已经收到了每条消息，即*“数据已发送”*和*“通话后”-*这些是日志消息。

是否有一个回调，我应该实现，还是我遗漏了一些明显的东西？我将我的代码的缩短版本放在这里。

```
// Injecting javascript in the original page
function inject(func) {
    var source = func.toString();
    var script = document.createElement('script');
    script.innerHTML = "(" + source + ")()";
    document.body.appendChild(script);
}

function injection() {
}

// This function intercepts the ajax
function interceptAjax() {
    $('body').ajaxSuccess (
            function (event, requestData, settings) {
                serverData = requestData.responseText;

                if(JSON.parse(settings.data).method == "dashboard.getPaginatedPlextsV2"){

                console.log("Sending");
                $.ajax({
                    type: "POST",
                    url: "http://mywebsite.com/collectdata.php",
                    data: { json: JSON.stringify(serverData) },
                    success: function(msg) {
                        console.log("Data were sent");
                    },
                    error: function(xhr, ajaxOptions, thrownError) {
                        console.log("Failed: " + xhr.status + " - " + thrownError);
                    }
                });

                console.log("After the call");
                }
            }
    );
}

// A helperfunction for the ajaxInterception to work in Chrome
function addJS_Node (text, s_URL, funcToRun) {
    var D = document;
    var scriptNode = D.createElement('script');
    scriptNode.type = "text/javascript";
    if(text) scriptNode.textContent = text;
    if(s_URL) scriptNode.src = s_URL;
    if(funcToRun) scriptNode.textContent = '(' + funcToRun.toString() + ')()';

    var targ = D.getElementsByTagName('head')[0] || D.body || D.documentElement;
    targ.appendChild(scriptNode);
}

// This function is necessary to intercept the ajax
addJS_Node(null, null, interceptAjax);

inject(injection); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T20:28:59.680

几件事：

1.  是否`mywebsite.com`与目标页面相同的域？如果没有，那么你不能像那样做跨域 AJAX（除非目标页面服务器有一个慷慨的 CORS 策略）。

    如果是这样，那么您控制服务器（或有权访问），那么为什么要搞乱数据的用户脚本呢？;-)

2.  这一行：

    ```
    if(JSON.parse(settings.data).method == "dashboard.getPaginatedPlextsV2") 
    ```

    看起来容易导致错误。

即使您有理由确定所有页面的 AJAX 调用都只发送有效的 JSON 数据，但并非所有数据都具有`method`属性。（例如：看起来 AJAX 调用`http://mywebsite.com/collectdata.php`可能没有。

您需要使该检查更具防撞性。像这样的东西（未经测试）：

```
var jsonData    = null;

try {
    jsonData    = JSON.parse (settings.data);
}
catch (e) {
    jsonData    = null;
}

if (jsonData  &&  jsonData.method
    &&  jsonData.method == "dashboard.getPaginatedPlextsV2"
) {
    ... 
```

# asp.net-mvc - 如何在投票系统中投票？

> ID：15207590
> 
> 赞同：0
> 
> 时间：2013-03-04T17:39:56.460
> 
> 标签：asp.net-mvc, asp.net-mvc-4

这些是我的 POCO 课程：

```
public class PollOptions
    {
        public int Id { get; set; }
        public virtual Polls Polls { get; set; }
        public string Answer { get; set; }
        public int Votes { get; set; }
    }
public class Polls
    {
        public int Id { get; set; }
        public string Question { get; set; }
        public bool Active { get; set; }
        public virtual ICollection<PollOptions> PollOptions { get; set; }
    } 
```

我已经通过这种方式将我的模型传递给索引视图：

```
public ActionResult Index()
        {
           var poll = db.Polls.Include("PollOptions").Where(x => x.Active).ToList();
           return View(model);
        } 
```

在索引视图中，我希望用户投票，下面是我的投票部分：

```
@section Polling{
   @foreach (var question in Model.Polls)
    {
        <h3>@question.Question</h3>
       <ul class="pollUnordedList">
       @foreach(var answer in question.PollOptions)
        {
            <li><input type="radio" name="opt" id="@answer.Id" value="1"/><span>@answer.Answer</span></li>
        }
        </ul>
    }
    @using (Html.BeginForm(actionName: "Radio", controllerName: "Home",routeValues: new { id = 2, value = 5 }))
    {
        <p><input type="submit" class="btn btn-primary" value="ارسال نظر" /></p>
    }
} 
```

我的行动方法：

```
public void Radio(int Id=0,int value=0)
       {
           PollOptions opt = db.PollOptions.Find(Id);
           db.Entry(opt).State = System.Data.EntityState.Modified;
           opt.Votes += value;
           db.SaveChanges();
       } 
```

如何获取作为路由值传递的单选按钮的值和 id，例如在上面的路由值中，Id 和值的值为 2,5

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:17:36.457

我使用 jQuery AJAX 解决了我的问题：

```
@using (Html.BeginForm(actionName: "Radio", controllerName: "Home")) {
        foreach (var question in Model.Polls)
        {
            <h3>@question.Question</h3>
            <ul class="pollUnordedList">
                @foreach (var answer in question.PollOptions)
                {
                    <li>
                        @*@Html.RadioButton("options",false,new {id=@answer.Id})<span>@answer.Answer</span>*@
                        @Html.RadioButton("options",answer.Id)<span>@answer.Answer</span>
                    </li>
                }
            </ul>
        }
         <p>
            <input type="submit" id="btnVote" class="btn btn-primary" value="ارسال نظر" />
        </p>
    } 
```

和我的行动方法：

```
[HttpPost]
       public ActionResult Radio(int options)
       {
           var option = db.PollOptions.Find(options);
           if (option != null) option.Votes++;
           db.SaveChanges();
           return RedirectToAction("Index");
       } 
```

感谢Daniel Liuzzi，不需要foreach，因为如果选择了单选按钮，则在发布表单时提交的单选按钮的值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:50:37.453

为所有单选按钮使用相同的名称：

```
@using (Html.BeginForm(actionName: "Radio", controllerName: "Home")) {
    foreach (var question in Model.Polls) {
        <h3>@question.Question</h3>
        foreach (var answer in question.PollOptions) {
            <label>
                <input type="radio" name="answers" value="@answer.Id" />
                @answer.Answer
            </label>
        }
    }

    <p><input type="submit" class="btn btn-primary" value="ارسال نظر" /></p>
} 
```

然后在您的操作方法上，您会收到作为数组的选定答案：

```
[HttpPost]
public ActionResult Radio(int[] answers)
{
    // TODO: Save your answers
} 
```

**编辑**

根据您关于 value 始终等于 1 的评论，那么传递它是没有意义的。您只需*假设*每个选定单选按钮的值为 1。您的操作方法看起来像这样：

```
[HttpPost]
public ActionResult Radio(int[] answers)
{
    foreach (var id in answers)
    {
        var option = db.PollOptions.Find(id);
        if (option != null) option.Votes++;
        db.SaveChanges();
    }
} 
```

# android - 如何在图标下写应用程序的名称

> ID：15207591
> 
> 赞同：0
> 
> 时间：2013-03-04T17:40:03.633
> 
> 标签：android, android-layout, homescreen

我创建了一个作为主屏幕的启动器应用程序，其中有许多图标，每个图标代表一个不同的应用程序。我想知道如何在这些图标下显示每个应用程序的名称。这是显示图标的类：

ImageAdapter.java

```
package com.seniorDesign.main.project;

import android.content.Context;
import android.graphics.Color;
import android.view.View;
import android.view.ViewGroup;
import android.widget.BaseAdapter;
import android.widget.GridView;
import android.widget.ImageView;

public class ImageAdapter extends BaseAdapter{
    private Context mContext;

    public ImageAdapter(Context c) {
        mContext = c;
    }

    public int getCount() {
        return mThumbIds.length;
    }

    public Object getItem(int position) {
        return null;
    }

    public long getItemId(int position) {
        return 0;
    }

    // create a new ImageView for each item referenced by the Adapter
    public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imageView = new ImageView(mContext);
        //imageView.setBackgroundColor(Color.BLACK);
        imageView.setLayoutParams(new GridView.LayoutParams(250,200));
        imageView.setScaleType(ImageView.ScaleType.FIT_CENTER);
        imageView.setPadding(8,8,8,8);
        imageView.setImageResource(mThumbIds[position]);
        return imageView;
    }

    // references to our images
    private Integer[] mThumbIds = {
            R.drawable.phone, R.drawable.calendar, R.drawable.calculator,
            R.drawable.gallery, R.drawable.browser, R.drawable.email, 
            R.drawable.map, R.drawable.sms, R.drawable.camera, R.drawable.contacts,
            R.drawable.notepad_icon
            };
} 
```

任何帮助将不胜感激。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:44:06.753

使用图像和文本为每个项目创建一个布局。将此布局设置为列表或网格视图的项目。您可以使用文本名称映射图像。因此，在 getView 中，您可以为每个项目设置文本和图像。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:21:03.137

查看这篇文章：

[http://www.vogella.com/articles/AndroidListView/article.html#adapterperformance_example](http://www.vogella.com/articles/AndroidListView/article.html#adapterperformance_example)

它与`ListView`'s 相关，但您可以对`GridView`. 阅读有关列表及其性能的整篇文章，以了解其工作原理。

简而言之，您需要使用垂直方向和在其中膨胀`ImageView`LinearLayout `TextView`。一些灵感：

```
@Override
public View getView(int position, View convertView, ViewGroup parent) {
    View rowView = convertView;
    if (rowView == null) {
        LayoutInflater inflater = context.getLayoutInflater();
        rowView = inflater.inflate(R.layout.rowlayout, null);
        ViewHolder viewHolder = new ViewHolder();
        viewHolder.text = (TextView) rowView.findViewById(R.id.text_view);
        viewHolder.image = (ImageView) rowView.findViewById(R.id.image_view);
        rowView.setTag(viewHolder);
    }

    ViewHolder holder = (ViewHolder) rowView.getTag();

    holder.text.setText(names[position]);
    holder.image.setImageResource(mThumbIds[position]);

    return rowView;
} 
```

# jquery - 文本区域未禁用或保持禁用状态

> ID：15207594
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:40:06.707
> 
> 标签：jquery, html, checkbox, disabled-input

**我有一个复选框**：

```
<input type="checkbox" id="catDescript" class="category_description" name="aisis_options[category_description]" value="category_description"> 
```

**和一个文本区域**

```
<textarea id="categoryHeader" class="input-xlarge" name="aisis_options[category_header_text]" rows="10" cols="100%"></textarea> 
```

和下面的 Jquery，假设一个在单击复选框时禁用文本区域，两个在单击复选框时保持文本区域禁用。

```
$("#catDescript").change(function() {
    if($(this).is(":checked")) {                
        $("#categoryHeader").attr("disabled", "disabled");
    }
    else {
        $("#categoryHeader").removeAttr("disabled");
    }
}); 

if ($('input[value=category_description]:checkbox:checked').attr('id') === "catDescript") {
    $('#categoryHeader').attr('disabled', 'disabled');
} 
```

问题是，我点击了复选框，文本区域并没有被禁用。我单击提交复选框已选中，但文本区域未禁用。

我究竟做错了什么？请发布一个jsfiddle。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:42:11.580

要修改元素的属性， `prop`应该使用 method 而不是`attr`.

```
$(function() {
    $("#catDescript").change(function() {
        $("#categoryHeader").prop("disabled", this.checked);
    }).change(); // trigger the event on DOM Ready
}) 
```

# java - 为什么这个 Java 正则表达式不匹配我的字符串？

> ID：15207595
> 
> 赞同：0
> 
> 时间：2013-03-04T17:40:09.703
> 
> 标签：java, regex

我有以下 Java 代码：

```
String data = "MaxL-450";

if(!data.matches("MaxL\\-*"))
    throw new IllegalArgumentException("Did not match."); 
```

当我执行它时，抛出异常，因为显然正则表达式与我的字符串不匹配`data`。我的正则表达式有问题还是这里发生了其他事情？提前致谢。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T17:41:30.453

`*`表示前一个字符出现零次或多次。你想要类似的东西`"MaxL-[0-9]*"`，假设你想在破折号后匹配一个数字。

或者，您可以使用`"MaxL-\\d*"`. 请注意，您需要在 Java 中使用两个斜杠，因为您需要转义斜杠本身。就我个人而言，我喜欢在 Java 中使用显式字符类（即`[0-9]`），因为它更容易阅读，因为您的正则表达式不可避免地会变得更长和更复杂。

编辑：另外，正如戴夫牛顿指出的那样，破折号前面的转义斜线不是必需的，因为破折号不在字符类中。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:42:21.073

如果您正在寻找连字符后的任何字符：

```
if(!data.matches("MaxL\\-.*"))
    throw new IllegalArgumentException("Did not match."); 
```

# java - 尝试加载资源时 clojure.lang.Compiler 中的 NPE

> ID：15207596
> 
> 赞同：7
> 
> 时间：2013-03-04T17:40:11.093
> 
> 标签：java, clojure

我已经在[CLJ-1172](http://dev.clojure.org/jira/browse/CLJ-1172)中报告了这个问题，但没有收到 Clojure 团队的任何反馈。也许这里有人可以告诉我出了什么问题。这是我的代码：

```
import clojure.lang.Compiler;
Compiler.load(new StringReader("(+ 5 6)")); 
```

运行时异常：

```
java.lang.ExceptionInInitializerError
  at clojure.lang.Compiler.<clinit>(Compiler.java:47)
Caused by: java.lang.NullPointerException
  at clojure.lang.RT.baseLoader(RT.java:2043)
  at clojure.lang.RT.load(RT.java:417)
  at clojure.lang.RT.load(RT.java:411)
  at clojure.lang.RT.doInit(RT.java:447)
  at clojure.lang.RT.<clinit>(RT.java:329) 
```

看起来`RT`和`Compiler`类静态地相互引用。我正在使用`org.clojure:clojure:1.5.0`依赖项。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T23:59:27.520

只要它们的字段以正确的顺序初始化，类就可以静态地相互引用。在这种情况下，Clojure 可能期望`RT`在`Compiler`. 以下是事件的顺序：

1.  当您对 进行静态调用时`Compiler`，Java 会初始化该类中的所有静态字段。
2.  （第 47 行）的静态初始化程序`Compiler.FNONCE`调用 in 中的静态方法，这会导致整个类在计算和设置`RT`的值之前被初始化。`FNONCE`
3.  从第 299 行开始的静态初始化程序块`RT`调用一个静态方法，该方法最终引用静态`Compiler.LOADER`字段。
4.  JVM 通常会在`Compiler`此处初始化该类，但它看到`Compiler`当前正在初始化并仅获取当前值。字段按照它们在文件中声明的顺序进行初始化，并且由于`LOADER`在返回`FNONCE`未初始化的值之后`null`，当它被取消引用时抛出一个 NPE `RT`。

底线：在调用`RT`之前调用（或读取静态字段）中的某些静态方法，`Compiler.load`并且您的错误应该消失。

有关类初始化细节的更多详细信息，请参见[Java 语言规范](http://docs.oracle.com/javase/specs/jls/se7/html/jls-12.html#jls-12.4)的第 12.4 节。

# html - IE8 不呈现某些 HTML 名称实体

> ID：15207604
> 
> 赞同：3
> 
> 时间：2013-03-04T17:40:43.763
> 
> 标签：html, character-encoding, html-entities

某些 HTML 名称实体未在 IE8 中呈现，而是我可以看到未呈现的 HTML 实体！例如`&scedil;`或`&inodot;`。

我找到了使用 HTML 数字实体的解决方案，例如`&#351;`代替`&scedil;`.

我想知道是否有人知道这个问题的原因以及是否有办法在 IE8 中正确查看`&scedil;`或`&inodot;`类似实体？

这是我在 jsfiddle 上的代码：（如果将此代码复制到 HTML 文件中，它将不会在 IE8 中呈现）

[http://jsfiddle.net/7uBrd/](http://jsfiddle.net/7uBrd/)

```
<HTML lang="TR">
 <HEAD>
  <meta http-equiv="Content-type" content="text/html;charset=UTF-8"> 
  <TITLE>test</TITLE>
 </HEAD>
 <BODY>
  <p>This is not working in IE8: afi&scedil;ler, e&scedil;yalar&inodot;, k&inodot; </p>
  <p> This is working: afi&;#351;ler, e&#351;yalar&#305;, k&#305; </p>    
  <p>This is Working as well: test&nbsp;test&ndash;</p>
 </BODY>
</HTML> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T17:58:55.880

浏览器对命名 HTML 实体的支持总是比对数字实体的支持差。毕竟，数字是字符的 Unicode 代码点，而名称需要手动更新浏览器源代码中的查找表。您提到的那些实体只是不支持 Internet Explorer 版本 8（甚至版本 9，不知道 10）。

您已经有一个解决方法，但我建议您切换到 UTF-8 并完全避免实体（保存`&amp;`和其他合理的例外）。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T17:57:50.360

HTML4 规范不包含`scedil`实体。 [http://www.w3.org/TR/html4/sgml/entities.html](http://www.w3.org/TR/html4/sgml/entities.html)

但是，HTML5 规范确实如此。 [http://www.w3.org/TR/2011/WD-html5-20110113/named-character-references.html](http://www.w3.org/TR/2011/WD-html5-20110113/named-character-references.html)

# ftp - Orchard CMS - 如何同步生产和本地仪表板项目更改

> ID：15207606
> 
> 赞同：4
> 
> 时间：2013-03-04T17:40:45.240
> 
> 标签：ftp, orchardcms

如果一个人有一个本地构建的 Orchard CMS - 故意从完整的源代码构建，以便我可以编写自己的扩展/进行自己的更改 - 这是否意味着我永远无法通过已发布的生产运行实例对站点进行仪表板更改？

问题是，如果我通过在线生产站点安装一个模块（或 10 个或 100 个）或主题，这些都不会反映在我的本地副本中，那么这两者如何同步呢？那么答案是“当然不能”吗？但这意味着永远无法利用简单地在任何浏览器上跳转（例如在旅行时等）在需要时进行更改（当然有很多事情，例如编辑内容，只是对数据库，这不是我关心的问题）。

或者，如果以及当我通过生产实例进行更改时，是否确实有一种简单的方法来同步本地和远程源（我确定通过 ftp，在这种情况下从远程同步到本地）？如果是这样，有什么先决条件，例如，我必须转向预编译才能使其工作？或者选项*严格来说*是两个：1）始终从本地副本工作并从那里发布更改（*始终*），或 2）*始终*从生产/非本地实例工作，但这意味着实际上您没有/甚至不能拥有本地实例？

ps这是作为共享的天蓝色网站发布的，我在Visual Studio 2012（不是webmatrix）中工作

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T18:23:41.747

简而言之，好的做法是在您的开发盒上更改代码，并在生产中更改数据。添加源控制和数据库备份以实现回滚能力和灾难恢复。我们将很快通过启用数据分段来改进这个故事，但目前这是最佳实践。所以：

1.  永远不要在生产中安装模块（这是一个代码更改，所以应该在开发中完成）。当然，一旦在 dev 或 staging 中验证了其正确行为，就必须在生产中*启用该模块。*
2.  更新站点在产品上的数据，除非您愿意在站点之间导出/导入该数据。
3.  请务必使用草稿（保存与发布按钮）功能来准备新版本的内容。
4.  定期将 prod 数据库恢复到您的开发盒中，以便在开发中使用合理的最新数据。

# asp.net-mvc - 我必须为 Azure 更改我的 ASP MVC 身份验证系统吗？

> ID：15207607
> 
> 赞同：1
> 
> 时间：2013-03-04T17:40:48.843
> 
> 标签：asp.net-mvc, azure, forms-authentication

前段时间我创建了一个 ASP MVC 网站，它使用`Forms authentication`和`Sessions`. 现在我将在 Azure的**WebRole中发布它。**

我的问题是，我必须更改身份验证系统中的某些内容，还是应该起作用？

如果它不应该工作，你能解释一下问题吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:52:01.587

*不，*您不必更改身份验证系统即可使用 azure。在最坏的情况下（如果您使用 AD 集成身份验证），您将需要使用 Azure Connect 设置 VPN 隧道以将您的网站连接到 AD。

如果您有本地 SQL 服务或任何其他身份验证来源，您也可以这样做。

如果您使用 ADFS 或任何其他被动身份验证，那么它们将照常重定向。

# c# - RegEx 之后使用特定文本捕获执行时间

> ID：15207608
> 
> 赞同：2
> 
> 时间：2013-03-04T17:40:49.087
> 
> 标签：c#, .net, regex, regex-lookarounds

我有我正在尝试解析的以下日志文​​件。我正在使用正则表达式来收集我需要的信息并完成了大部分工作。我有日志文件的某个部分根据它执行的步骤重复了几次。我可以使用以下正则表达式，然后返回捕获数组，但步骤的顺序可能会改变。我希望能够有把握地捕捉特定步骤。

正则表达式：

```
\[Total execution Time: (.+) min 
```

日志摘录：

> 02/19 00:48:46:762 [INFO] [MigrationWizard] [总执行时间：11.05 分钟] [管理员] [(null)] [14]
> 02/19 00:48:46:762 [INFO ] [MigrationWizard] [错误总数：0] [administrator] [(null)] [14]
> 02/19 00:48:46:762 [INFO] [MigrationWizard] [Step 1 Done.] [administrator ] [（空）] [14]

我是否需要使用前瞻断言来确保总执行时间后跟特定的步骤名称？我如何解释介于两者之间的所有角色？我如何考虑多行馈送？我正在使用 C#。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:52:03.483

试试这个正则表达式

```
Total execution Time: ([\d.]+).*\r?\n.*\r?\n.*\[Step 1\s 
```

其中“步骤 1”当然需要更改为您希望匹配的步骤。这只会匹配“步骤 1”的总执行时间。

确保未启用单行模式（因此 . 与换行符不匹配）

我假设日志条目的顺序总是相同的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:35:50.173

尝试这样的事情：

```
string strRegex = @"(Total execution Time: )(\d{2}[\.:]\d{2})\s+";
RegexOptions myRegexOptions = RegexOptions.Multiline | RegexOptions.Singleline;
Regex myRegex = new Regex(strRegex, myRegexOptions);

string strTargetString = @"..............";

foreach (Match myMatch in myRegex.Matches(strTargetString))
{
  if (myMatch.Success)
  {
    // ........ do something
  }
} 
```

输入字符串：

```
02/19 00:48:46:762 [INFO ] [MigrationWizard] [Total execution Time: 11.05 minute(s)] [administrator] [(null)] [14]
02/19 00:48:46:762 [INFO ] [MigrationWizard] [Total number of error(s): 0] [administrator] [(null)] [14]
02/19 00:48:46:762 [INFO ] [MigrationWizard] [Step 1 Done.] [administrator] [(null)] [14]
02/19 00:48:46:762 [INFO ] [MigrationWizard] [Total execution Time: 13:25 minute(s)] [administrator] [(null)] [14] 
```

火柴：

```
Total execution Time: 11.05
Total execution Time: 13:25 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T20:11:33.800

你的正则表达式

```
 \[Total execution Time: (.+) min 
```

效率低下，因为`.+`在回溯之前会尽可能多地贪婪地匹配任何字符（换行符除外）以尝试匹配它`" min"`后面的字符。更好的是`.+?`之前匹配尽可能少的字符`" min"`，更好的是只匹配数字和点`[\d.]+`或匹配特定格式`\d\d\.\d\d`。

无论如何，要获得下一步的执行时间`[Step 1`，您可以使用，例如

```
Match m = Regex.Match(str,
    @"\[Total execution Time: ([\d.]+)(?:(?!\[Step ).)+\[Step 1 Done",
        RegexOptions.Singleline
);

if (m.Success) {
    Console.WriteLine(m.Groups[1].Value);         
} 
```

负前瞻`(?!\[Step )`意味着`.`只会匹配字符，直到`"[Step "`出现在字符串中。`"[Step 1 Done"`如果整个匹配要成功，则必须匹配。

`RegexOptions.Singleline`用于`.`跨换行符的匹配。

或者，您可以将模式前面的模式放在`[\d.]+`正向的后视中，并将其后的模式放在正向的前瞻中，避免使用捕获组来获取值，但这对任何事情都没有什么影响。

# javascript - 模态出现 onLoad

> ID：15207612
> 
> 赞同：1
> 
> 时间：2013-03-04T17:41:03.447
> 
> 标签：javascript, jquery, twitter-bootstrap, jquery-ui, jquery-events

我对我的脚本的意图是`modal`只有在您单击链接后才会显示该对话框。不幸的是，它会在页面加载后立即弹出。我已经包含了一个 jsFiddle 和相关的片段。我究竟做错了什么？

[http://jsfiddle.net/rajkumart08/y88WX/25/](http://jsfiddle.net/rajkumart08/y88WX/25/)

**jQuery** :

```
$(document).ready(function(){
    $(function() {
        $('#event-modal').modal({
            backdrop: true
        });
    });
}); 
```

**HTML**：

```
<div id="event-modal" class="modal hide fade">
  <div class="modal-header">
    <a class="close" href="#">x</a>
    <h3>Modal Heading</h3>
  </div>
  <div class="modal-body">
    <p>Some information</p>
  </div>
  <div class="modal-footer">
    <a class="btn primary" href="#">Primary</a>
    <a class="btn secondary" href="#">Secondary</a>
  </div>
</div>
<a href="/events/2-fefewfewfe/rsvps" data-backdrop="true" data-controls-modal="event-modal" data-keyboard="true">click to open model<span class="ico join"></span></a> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:57:51.173

首先，`$(document).ready(function(){})`和`$(function(){})`都是一样的东西，所以你只需要一个。

其次，您的模态窗口 HTML 使用数据属性，因此您不需要使用 javascript 调用它。**删除javascript，它应该可以正常工作。**

如果它仍然不起作用，我建议您[阅读 Bootstrap 上的文档](http://twitter.github.com/bootstrap/javascript.html#modals)。您甚至可以复制并粘贴示例，然后根据您的需要进行自定义。

您的代码对数据属性很好，但更改模式的关闭按钮以使用它：

```
 <a class="close" href="#" onclick="$('#event-modal').modal('hide')">x</a> 
```

我还想建议您下次发布小提琴时，请将 javascript、CSS 和 HTML 分成各自的部分。如果您将其分解并仅保留相关内容，您可能会及早发现错误/错误。

* * *

对于其他用户，

## 通过 Javascript：

更改您的代码添加以下选项以从一开始就将其隐藏：

```
$(function(){
    $('#event-modal').modal({
        backdrop: true,
        show: false
    });
}); 
```

然后显示它，使用这个javascript：

```
$('#event-modal').modal('show'); 
```

要使其隐藏，请使用以下命令：

```
$('#event-modal').modal('hide'); 
```

# c++ - OpenCV：如何读取浮动图像

> ID：15207616
> 
> 赞同：1
> 
> 时间：2013-03-04T17:41:15.023
> 
> 标签：c++, opencv, io, mat

我在 openCV 中创建了一个 Mat 如下：

```
cv::Mat m = cv::Mat(10,10, CV_32FC1);
for(int i = 0; i < 10; i++){
    for(int j = 0; j < 10; j++){
        m.at<float>(i,j) = 1;
     }
} 
```

并通过以下方式将其保存到磁盘：

```
imwrite("out.png", m); 
```

我现在尝试如下阅读：

```
cv::Mat m = imread("out.png", CV_LOAD_IMAGE_UNCHANGED); 
```

但是 m 中的数据似乎是完全随机的，`m.at<float>(5,5)`例如在访问时。

如何读回写入其中的数据？例如，在 matlab 中我可以这样做：

```
m = imread("out.png") 
```

它给了我正确的 1 矩阵

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T18:11:00.447

看[`imwrite`](http://docs.opencv.org/modules/highgui/doc/reading_and_writing_images_and_video.html?highlight=imread#imwrite)

> 函数 imwrite 将图像保存到指定文件。图像格式是根据文件扩展名选择的（有关扩展名列表，请参见 imread()）。**使用此功能只能保存 8 位（或 16 位无符号 (CV_16U)，在 PNG、JPEG 2000 和 TIFF 的情况下）单通道**或 3 通道（具有“BGR”通道顺序）**图像。**如果格式、深度或通道顺序不同，**请在保存前使用 Mat::convertTo() 和 cvtColor() 进行转换。**或者，使用通用 XML I/O 函数将图像保存为 XML 或 YAML 格式。

[深度](http://docs.opencv.org/modules/core/doc/old_basic_structures.html?highlight=cv_16u#int%20depth)，[转换为](http://docs.opencv.org/modules/core/doc/basic_structures.html#void%20Mat%3a%3aconvertTo%28OutputArray%20m,%20int%20rtype,%20double%20alpha,%20double%20beta%29%20const)

# python - 使用 xlwt 为整个 Excel 表格设置边框

> ID：15207619
> 
> 赞同：0
> 
> 时间：2013-03-04T17:41:29.270
> 
> 标签：python, excel, xlwt

你好！

我正在使用 Python 的 xlwt 包来制作 excel 文档。我需要的是在文档中的每个单元格周围放置一个边框（即数据之间）。

假设我已经在第 1 行第 1 列的单元格中写入内容。然后我在第 3 行第 1 列的单元格中写入内容。我可以轻松地为这些单元格设置边框，同时将内容写入它们。但是，它们之间的单元格，第 2 行第 1 列，没有任何边框。

如何做到这一点？我想我可以在这些实际上是空的单元格中写一个空字符串，然后在它们周围加上边框，但我希望有一个更优雅的解决方案。也许 xlwt 包中有一个简单的方法？

非常感谢！

# java - 自动监控 Ajax 网页的资源使用情况（最好在 CI 中）

> ID：15207626
> 
> 赞同：1
> 
> 时间：2013-03-04T17:41:44.993
> 
> 标签：java, javascript, selenium, cpu-usage, performance-testing

我有一套我刚刚继承的硒测试，用于重复测试应用程序以监控资源使用情况（内存是主要关注点）。这侧重于客户端资源使用而不是服务器，因此关于如何监控这一点的答案似乎更加模糊（如果我正在测试服务器，我会有一些想法）

他们目前所做的是运行测试 X 次（x 在 100 范围内），同时在另一个线程中检查 IE 的总内存使用情况并记录下来。在许多方面，这似乎远非理想，我们真正需要的是探查器解决方案或其他东西，但我不确定我可以调用任何编程 API 来使用这样的东西作为自动化测试的一部分。我一直找不到任何东西来满足我认为会更好甚至完全不同的解决方案来获取他们需要的数据。有没有其他人尝试过这样的事情？

我很高兴听到关于以自动化方式监控浏览器内资源使用情况的完全不同的解决方案。

# php - 使用 PHP 从 URL 中提取信息

> ID：15207627
> 
> 赞同：2
> 
> 时间：2013-03-04T17:41:49.210
> 
> 标签：php, url, url-parsing

我想使用 PHP 从 url 中提取信息。如何从 url 中获取值“matt”：

```
www.shareit.me/matt 
```

另外，我怎么可能检查那里是否有一个值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:46:38.833

无需在这里过度复杂化：

```
$url  = 'www.shareit.me/matt';
$segs = explode('/', $url);
echo $segs[1]; // matt 
```

检查它是否存在就像`if ( !empty($segs[1]) ) {}`

假设您想要价值`matt`而不仅仅是“路径”，这将适用于所有这些：

```
www.shareit.me/matt // matt
www.shareit.me/matt/photos
www.shareit.me/matt/photos/vacation/nebraska/cows/ // matt
www.shareit.me/matt/photos?vacation=mexico&gallery=donkeyshow // matt
www.shareit.me/matt/loves/cheese // matt 
```

如果你真的想让人们知道 matt 喜欢奶酪，你应该使用[parse_url()](http://php.net/manual/en/function.parse-url.php)代替：

```
parse_url('www.shareit.me/matt/loves/cheese', PHP_URL_PATH); // /matt/loves/cheese 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T17:45:34.150

瞧，RTM： http: [//php.net/manual/en/function.parse-url.php](http://php.net/manual/en/function.parse-url.php)

```
<?php

$url = 'http://username:password@hostname/path?arg=value#anchor';
print_r(parse_url($url));
echo parse_url($url, PHP_URL_PATH);
?> 
```

上面的示例将输出：

```
Array
(
    [scheme] => http
    [host] => hostname
    [user] => username
    [pass] => password
    [path] => /path
    [query] => arg=value
    [fragment] => anchor
)
/path 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-03-04T17:46:17.613

您可以使用[parse_url](http://php.net/parse-url)函数，这将返回一个包含有关 URL 的所有信息的数组。像这样的东西可能是你想要的：

```
echo explode('/', parse_url('http://www.shareit.me/matt')['path'])[1]; 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T17:47:09.140

如果要获取用于浏览脚本的 url，请使用该`$_SERVER['REQUEST_URI']`变量。在您的情况下，它将返回：

```
/matt 
```

但是您需要过滤掉您实际需要的信息。为此，您可以使用`preg_match`或替代方式。有关`$_SERVER`变量的更多信息：[请参阅此页面](http://php.net/manual/en/reserved.variables.server.php)

如果要获取包含 url 的字符串的信息，可以使用

> 爆炸（“/”，$ url）；

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T17:52:18.120

## 代码：

```
$url = "http://www.shareit.me/matt";

$parts = Explode('/', $url);

$id = $parts[count($parts) - 1]; 
```

## 示范：

*   [http://stepolabs.com/lab/explode/index.php](http://stepolabs.com/lab/explode/index.php)

*   [http://stepolabs.com/lab/explode/index.php.txt](http://stepolabs.com/lab/explode/index.php.txt)

*顺便[从字符串中获取一部分](https://stackoverflow.com/questions/15100249/getting-a-part-from-a-string/15100296#15100296)*。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T17:43:45.330

你可以使用正则表达式`preg_match`

```
preg_match("/.\/(.*)$/",$url,$matches); 
```

比检查匹配项是否包含您想要的内容

# .net - 如何为异步方法编写单元测试用例？

> ID：15207631
> 
> 赞同：3
> 
> 时间：2013-03-04T17:42:04.823
> 
> 标签：.net, unit-testing, nunit, rhino-mocks

我想通过模拟依赖项来编写一个单元测试用例。整体流程如下。

我们有`WorklistLoader`一个 async 方法`LoadWorklistItemsAsync()`。完成这项任务`WorklistLoader`取决于较低层的 API（我想模拟）`QueryManager.StartQueryTask()`。`StartQueryTask()`也是一种异步方法，它查询文件系统并`ProgressChanged()`定期引发`CompletedEvent`. `StartQueryTask()`返回对 TPL 的引用`Task`。

的签名`StartQueryTask`是

```
Task StartQueryTask(
    "SomeId",
    EventHandler<ProgressChanged> progressChanged,
    EventHandler<QueryCompleted> queryCompleted); 
```

一旦从`WorklistLoader`接收到`ProgressChanged`事件`QueryManager`，它会进行一些处理，然后引发其`ProgressChanged`事件（`ViewModel`已订阅）。

我想测试with mocking `LoadWorklistItemsAsync()`的方法。`WorklistLoader``QueryManager.StartQueryTask()`

这是我的问题。

1.  为带有模拟的方法编写单元测试的最佳实践是什么`Async()`？
2.  如何为依赖项使用 TPL 的方法编写单元测试用例？（方法返回`Task`类型）

另一个问题是

1.  如果我使用 Rhinomocks 模拟我的 QueryManager.StartQueryTask() 方法，它会是什么样子？（模拟代码。它必须引发progresschanged，完成事件并返回任务）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:45:22.600

为了模拟某些东西，您需要能够将模拟注入到您正在使用的任何东西中。有很多方法可以做到这一点，使用控制反转容器、环境上下文引导代码等。最简单的方法是构造函数注入和引导你的环境上下文，以便在你想要测试时拥有你想要的模拟。例如：

```
WorklistLoader worklistLoader;

[SetUp]
public void Setup()
{
    worklistLoader = new WorklistLoader(new MockQueryManager());
}

[Test]
public async Task TestWorklistLoader()
{
    await worklistLoader.LoadWorklistItemsAsync();
} 
```

这也意味着 WorklistLoader 不依赖于`QueryManager`但依赖于将实现的`IQueryManager`抽象`MockQueryManager`。

哪里`MockQueryManager`可能是这样的：

```
public class MockQueryManager : IQueryManager
{
    public Task StartQueryTask() {/* TODO: */}
} 
```

当然，您原来的 QueryManager 必须实现 IQueryManagear：

```
public class QueryManager : IQueryManager
{
    public Task StartQueryTask() {/* TODO: */}
} 
```

现在，在测试使用 TPL 的类方面，您会注意到我已经实现了一个返回任务的异步测试方法。这告诉测试运行者在认为测试方法已经执行之前等待结果。如果你只是写了类似的东西：

```
[Test]
public async void TestWorklistLoader()
{
    await worklistLoader.LoadWorklistItemsAsync();
} 
```

运行程序将执行`TestWorklistLoader`，它会在`LoadWorklistItemsAsync`完成之前立即返回，并可能绕过任何断言。

# 更新：

如果您不使用 C# 5，那么我建议您在单元测试中等待任务完成。例如：

```
[Test]
public void TestWorklistLoader()
{
    var task = worklistLoader.LoadWorklistItemsAsync();
    if(!task.IsComplete()) task.Wait();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-12T21:23:50.620

这可能看起来有点古怪，但我对类似的测试构建场景采取的简单方法是使用这个方便的功能：

```
/// <summary>
/// Wait no longer than @waitNoLongerThanMillis for @thatWhatWeAreWaitingFor to return true.
/// Tests every second for the 
/// </summary>
/// <param name="thatWhatWeAreWaitingFor">Function that when evaluated returns true if the state we are waiting for has been reached.</param>
/// <param name="waitNoLongerThanMillis">Max time to wait in milliseconds</param>
/// <param name="checkEveryMillis">How often to check for @thatWhatWeAreWaitingFor</param>
/// <returns></returns>
private bool WaitFor(Func<bool> thatWhatWeAreWaitingFor, int checkEveryMillis, int waitNoLongerThanMillis)
{
    var waitedFor = 0;
    while (waitedFor < waitNoLongerThanMillis)
    {
        if (thatWhatWeAreWaitingFor()) return true;

        Console.WriteLine("Waiting another {0}ms for a situation to occur.  Giving up in {1}ms ...", checkEveryMillis, (waitNoLongerThanMillis - waitedFor));
        Thread.Sleep(checkEveryMillis);
        waitedFor += checkEveryMillis;
    }
    return false;
} 
```

用法：

```
// WaitFor (transaction to be written to file, checkEverySoOften, waitNoLongerThan)
int wait = (Settings.EventHandlerCoordinatorNoActivitySleepTime + 5) * 1000;
var fileExists = WaitFor(() => File.Exists(handlerConfig["outputPath"]), checkEveryMillis: 1000, waitNoLongerThanMillis: wait);

if(!fileExists)
     Assert.Fail("Waited longer than " + wait + " without any evidence of the event having been handled.  Expected to see a file appear at " + handlerConfig["outputPath"]); 
```

在我的场景中，我期望写入一个文件，这就是我所等待的。在您的情况下，您正在等待调用 progressChanged 和 queryCompleted ，因此您最好注入这些 Mocks 并且您等待为真的表达式是：

```
var eventsCalled = WaitFor(() => progressChanged.Called(Time.Once) && queryCompleted.Called(Times.Once), checkEveryMillis: 1000, waitNoLongerThanMillis: wait); 
```

# cuda - cudaMemcpy2D 的大小是否有限制？

> ID：15207632
> 
> 赞同：0
> 
> 时间：2013-03-04T17:42:09.703
> 
> 标签：cuda, nvidia

我一直在使用 cudaMemcpy2D 将 2D 数组从 20 * 20 字符值发送到我的内核，但是当我想尝试发送 20 * 30 数组时出现错误。

这些行的代码如下：

我这样定义常量：

```
//Define for 2D arrays
#define TEXTSIZE 20
#define NUMBERTEXT 30 
```

我这样定义我的 textPitch

```
size_t pitch_text; 
```

我像这样初始化我的数组：

```
char text[NUMBERTEXT][TEXTSIZE] = {{'A','A','B','C','B','B','C','A','B','A','A','B','B','A','A','A','C','A','A','B'},\ ... }}; 
```

我像这样制作我的cudamalloc：

```
gpuErrchk(cudaMallocPitch( (void**)&d_text, &pitch_text, NUMBERTEXT * sizeof(char), TEXTSIZE)); 
```

CudaMemcpy2D 的初始化如下：

```
gpuErrchk(cudaMemcpy2D(d_text, pitch_text, text, TEXTSIZE * sizeof(char), TEXTSIZE * sizeof(char),NUMBERTEXT, cudaMemcpyHostToDevice)); 
```

收到的错误如下：

```
 GPUassert: invalid argument ../2D.cu 212 
```

第 212 行的错误基本上是 CudaMemcpy2D 行。

有没有更好的方法将大型二维数组发送到全局内存中的 GPU？请注意，如果我使用 20 * 20 数组，代码可以正常工作。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:16:04.933

问题在于您对[cudaMallocPitch](http://docs.nvidia.com/cuda/cuda-runtime-api/index.html#group__CUDART__MEMORY_1g80d689bc903792f906e49be4a0b6d8db)的调用（不在 cudaMemcpy2D 中）。您颠倒了高度和宽度参数。在 C 中，双下标数组的声明类似于`array[rows][columns]`where `columns`（即第二个下标）指的是宽度。

要解决这个问题，而不是这个：

```
cudaMallocPitch( (void**)&d_text, &pitch_text, NUMBERTEXT * sizeof(char), TEXTSIZE); 
```

做这个：

```
cudaMallocPitch( (void**)&d_text, &pitch_text, TEXTSIZE * sizeof(char), NUMBERTEXT); 
```

cudaMallocPitch 的最后一个参数是`Requested pitched allocation height`，即 rows 参数。

**编辑**：为了回答评论中的更多问题，这里是/是我用于测试目的的代码。特别是关于文本数组大小的问题，我无法使用此代码重现 90x120 左右大小的段错误。因此，我认为段错误可能是一个单独的问题。

我的测试代码（没有段错误）：

```
#include <stdio.h>
//Define for 2D arrays
#define TEXTSIZE 90
#define NUMBERTEXT 120

#define cudaCheckErrors(msg) \
    do { \
        cudaError_t __err = cudaGetLastError(); \
        if (__err != cudaSuccess) { \
            fprintf(stderr, "Fatal error: %s (%s at %s:%d)\n", \
                msg, cudaGetErrorString(__err), \
                __FILE__, __LINE__); \
            fprintf(stderr, "*** FAILED - ABORTING\n"); \
            exit(1); \
        } \
    } while (0)

int main(){

  size_t pitch_text;
  char *d_text;
  char text[NUMBERTEXT][TEXTSIZE];

  cudaMallocPitch( (void**)&d_text, &pitch_text, TEXTSIZE * sizeof(char), NUMBERTEXT);
  cudaCheckErrors("cudaMallocPitch error");
  cudaMemcpy2D(d_text, pitch_text, text, TEXTSIZE * sizeof(char), TEXTSIZE * sizeof(char),NUMBERTEXT, cudaMemcpyHostToDevice);
  cudaCheckErrors("cudaMemcpy2D error");

  return 0;
} 
```

# python - Tkinter 画布滚动/拖动通知

> ID：15207636
> 
> 赞同：0
> 
> 时间：2013-03-04T17:42:25.640
> 
> 标签：python, events, canvas, scroll, tkinter

我想在视图更改时重绘画布（自定义滚动大图像）。

目前我使用了几个函数来实现这一点：xview_moveto、yview_moveto、scan_dragto

有没有可以用来做这个清洁的事件？或者另一种方式来做到这一点？

当前代码看起来像：

```
class CustomCanvas(Tkinter.Canvas):
    def xview(self, *args):
        r = Tkinter.Canvas.xview(self, *args)
        if args:
            self.event_generate("<<ScrollEvent>>")
        return r
    def yview(self, *args):
        r = Tkinter.Canvas.yview(self, *args)
        if args:
            self.event_generate("<<ScrollEvent>>")
        return r    
    def xview_moveto(self, *args):
        Tkinter.Canvas.xview_moveto(self, *args)
        self.event_generate("<<ScrollEvent>>")
    def yview_moveto(self, *args):
        Tkinter.Canvas.yview_moveto(self, *args)
        self.event_generate("<<ScrollEvent>>")
    def scan_dragto(self, *args):
        Tkinter.Canvas.scan_dragto(self, *args)
        self.event_generate("<<ScrollEvent>>") 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:16:38.207

如果您不反对一些开箱即用的想法，您可以使用一些自定义 Tcl 代码来解决这个问题。*我写这篇文章并不是因为它本身*就是最好的解决方案，而是因为它很有趣。

解决方案是这样工作的：当您滚动时，最终调用的是底层 tk 小部件的子命令，以实际执行滚动。例如，`self.canvas.xview_moveto(...)`导致 tcl 命令看起来像`.123455.234123 xview moveto ...`. 奇怪的数字和点系列是小部件的内部名称。它也是实现滚动行为的命令的名称。“xview”在 tcl 命名法中被称为子命令，尽管它可以被认为是小部件对象上的一个方法。

现在，Tcl 最酷的地方在于，您可以重命名任何命令并将其替换为不同的名称。由于此小部件发生的所有事情都调用此命令，因此我们可以创建一个代理，通过该代理发送所有命令。

在您的情况下，您希望在滚动画布时触发一个事件。我们知道，只要使用“xview”或“yview”子命令调用小部件命令，它就会滚动。因此，通过用代理替换小部件命令，并让代理查找这些子命令，我们就可以完成这件事。

这是一个使用 python 2.7 的工作示例：

```
# use 'tkinter' instead of 'Tkinter' if using python 3.x
import Tkinter as tk 

class CustomCanvas(tk.Canvas):
    def __init__(self, *args, **kwargs):
        '''A custom canvas that generates <<ScrollEvent>> events whenever
           the canvas scrolls by any means (scrollbar, key bindings, etc)
        '''
        tk.Canvas.__init__(self, *args, **kwargs)

        # replace the underlying tcl object with our own function
        # so we can generate virtual events when the object scrolls
        tcl='''
            proc widget_proxy {actual_widget args} {
                set result [$actual_widget {*}$args]
                set command [lindex $args 0]
                set subcommand [lindex $args 1]
                if {$command in {xview yview} && $subcommand in {scroll moveto}} {
                    # widget has been scrolled; generate an event
                    event generate {widget} <<ScrollEvent>>
                }
                return $result
            }

            rename {widget} _{widget}
            interp alias {} ::{widget} {} widget_proxy _{widget}
        '''.replace("{widget}", str(self))
        self.tk.eval(tcl)

class Example(tk.Frame):
    def __init__(self, *args, **kwargs):
        tk.Frame.__init__(self, *args, **kwargs)

        # create an instance of the custom canvas. Make sure it
        # has a largeish scroll region, for demonstration purposes
        self.canvas = CustomCanvas(self, width=400, height=400, 
                                   borderwidth=0, scrollregion=(0,0,1000,1000))
        self.vsb = tk.Scrollbar(self, orient="vertical", command=self.canvas.yview)
        self.hsb = tk.Scrollbar(self, orient="horizontal", command=self.canvas.xview)
        self.canvas.configure(xscrollcommand=self.hsb.set, yscrollcommand=self.vsb.set)

        self.canvas.grid(row=0, column=0, sticky="nsew")
        self.vsb.grid(row=0, column=1, sticky="ns")
        self.hsb.grid(row=1, column=0, sticky="ew")
        self.grid_rowconfigure(0, weight=1)
        self.grid_columnconfigure(0, weight=1)

        # this binds to the virtual event that is sent by the proxy
        self.canvas.bind("<<ScrollEvent>>", self.on_scroll)

        # some data, just so that we can see that the canvas
        # really is scrolling
        for y in range(0, 1000, 100):
            for x in range(0, 1000, 100):
                self.canvas.create_text(x, y, text="%s/%s" % (x,y), anchor="nw")

    def on_scroll(self, event):
        print "widget scrolled..."

if __name__ == "__main__":
    root = tk.Tk()
    view = Example(root)
    view.pack(side="top", fill="both", expand=True)
    root.mainloop() 
```

警告：这仅在您滚动该区域时有效，尽管即使您使用键盘滚动它也应该有效（例如：向上翻页、向下翻页等）。如果您调整窗口大小，则不会触发该事件。您可以通过绑定到`<Configure>`. 另外，为了简洁起见，我省略了错误检查，尽管它应该相当健壮。最后，你只能在程序中使用这个特定的实现一次，因为我硬编码了“widget_proxy”，而不是让它变得更独特。这是留给读者的练习。

# html - 在 HTML 中为屏幕阅读器设置焦点

> ID：15207637
> 
> 赞同：1
> 
> 时间：2013-03-04T17:42:25.990
> 
> 标签：html, list, accessibility, voiceover, blind

我想知道是否可以为屏幕阅读器设置特定区域以专注于 HTML 内容。

我有一个类似于以下内容的列表：

```
<ol>
  <li>
    <div class="duration">
      <time>10:00</time>
      <span>to</span>
      <time>11:00</time>
    </div>
    <div class="info">
      <span>CA267 Lecture</span>
      <span>Software Testing</span>
      <span>Location: QG27</span>
    </div>
  </li>
</ol> 
```

当我将屏幕阅读器（在我的情况下是画外音）放在列表​​项上时，它从 10:00 开始，然后我必须按 ctrl+alt+左箭头键移动到“to”，然后再次移动到 11： 00 以此类推。

我想知道有没有办法对元素进行分组，以便屏幕阅读器专注于`<li>`标签并相应地读出其中的所有内容？

我尝试设置一个 tabindex 它有点工作，但需要屏幕阅读器用户使用 tab 键进行导航，而不是其内置的快捷键。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T11:48:29.173

ARIA 属性可以做到这一点，但规范还没有完成，有点令人困惑（至少对我来说），并且屏幕阅读器支持不是最佳的。我在想也许你可以申请`aria-labelledby`or `aria-describedby`，但我在 mdn 中查看的两​​种解决方案都需要更改你的标记。它看起来`aria-labelledby`可以通过简单地添加一些 id 到你的`ol`然后在 s 上的`aria-labelledby`元素来实现`div`。你可以在这里查看：[https ://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute](https://developer.mozilla.org/en-US/docs/Accessibility/ARIA/ARIA_Techniques/Using_the_aria-labelledby_attribute)

# django - 检查用户是否是会员

> ID：15207639
> 
> 赞同：0
> 
> 时间：2013-03-04T17:42:35.047
> 
> 标签：django, django-models, many-to-many

在我的项目管理应用程序中，我有一个列出所有项目的页面，但是我想显示项目是否归用户所有，用户是否是项目的成员，或者两者都不是。我通过模板中的以下代码执行此操作：

```
...
{% load custom_filters %}
...

{% for project in projects %}
    {% if project|ownership:user %}
        <div class="users_project label label-info">
            Admin
        </div>
        <a href="{% url show_project project.id %}">{{ project }}</a><br/>
    {% else %}
        {% if project|membership:user %}
            <div class="users_project label label-success">
                Member
            </div>
            <a href="{% url show_project project.id %}">{{ project }}</a><br/>
        {% else %}
                <div class="users_project label label-error">
        Not member
        </div>
            <a href="{% url show_project project.id %}">{{ project }}</a><br/>
        {% endif %}
    {% endif %}
{% endfor %} 
```

此处使用的第一个自定义过滤器（项目|所有权）按预期工作：

```
@register.filter(name='ownership')
def ownership(project, user):
    return project.added_by_user == user 
```

...但至于其他（项目|成员）我需要帮助。

```
@register.filter(name='membership')
def membership(project, user):
    return ? 
```

模型“用户”和“项目”具有多对多关系：

```
class Project(models.Model):
... other fields...
added_by_user = models.ForeignKey(User)
users = models.ManyToManyField(User, related_name='projects') 
```

...这导致在数据库中生成一个名为“project_users”的表，其中包含以下字段：

```
project_id (INT)
user_id    (INT) 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:49:30.167

您可以直接查询 ManyToMany 字段：

```
project.users.filter(id=user.id).exists() 
```

这将返回一个布尔值，显示该用户记录是否包含在用户列表中。

# android - 服务未在后台正常运行

> ID：15207644
> 
> 赞同：0
> 
> 时间：2013-03-04T17:42:53.947
> 
> 标签：android

我的服务正在运行，问题是在运行时它显示黑屏，直到服务完成。

```
Intent Service = new Intent();
Service.setClass(Activity.this,sendInformation.class);
Service.putExtra("IP",IP1); 
Service.putExtra("Port",Port1);
Activity.this.startService(Service); 
```

我怎么能说“服务正在运行”回家？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:46:05.053

您在服务器中所做的事情发生在主线程上。尝试改用[IntentService](http://developer.android.com/reference/android/app/IntentService.html)或尝试从服务器的 onStartCommand 跨越您自己的线程。通常 IntentService 很好。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:53:16.003

[从`Service`文档](http://developer.android.com/reference/android/app/Service.html)中：

> 请注意，服务与其他应用程序对象一样，在其托管进程的主线程中运行。这意味着，如果您的服务要执行任何 CPU 密集型（例如 MP3 播放）或阻塞（例如网络）操作，它应该生成自己的线程来完成这项工作。

[`AsyncTask`](http://developer.android.com/reference/android/os/AsyncTask.html)如果你想要多线程，只需创建一个。

# wpf - 在屏幕/某些坐标之间移动 WPF 应用程序

> ID：15207649
> 
> 赞同：0
> 
> 时间：2013-03-04T17:43:03.260
> 
> 标签：wpf, screen

我正在尝试在 WPF 中创建一个具有 2 个按钮的应用程序，这些按钮将处理我拥有的 2 个屏幕。一个按钮将应用程序移动到主屏幕，另一个按钮移动到辅助屏幕。这在 WPF 中是否可行，如果可以，有人能告诉我怎么做吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:51:49.253

这不是一个通用的解决方案，但在您的特定情况下，您可以简单地为`window.Left`和设置值`window.Top`。

[有关屏幕上的更多详细信息，](https://stackoverflow.com/questions/2465646/how-do-i-know-what-monitor-a-wpf-window-is-in)请参阅此 SO 问题

# java - 从存储在容器中的类构造对象

> ID：15207651
> 
> 赞同：0
> 
> 时间：2013-03-04T17:43:07.707
> 
> 标签：java

这是代码：

```
import java.util.ArrayList;
import java.util.List;

public class Main {
    public abstract static class Base {
    }

    public static class Derived1 extends Base {
    }

    public static class Derived2 extends Base {
    }

    public static <T> T createObject(Class<T> someClass) {
        T a = null;
        try {
            a = someClass.newInstance();
        } catch (InstantiationException e) {
        } catch (IllegalAccessException e) {
        }
        return a;
    }

    public static void main(String[] args) {
        Derived2 d2 = createObject(Derived2.class);   // here it works

        // here is some array with classes
        Class[] someClasses = new Class[] { Derived1.class, Derived2.class };
        // here is some list which should be filled with objects of these classes
        List<? extends Base> l = new ArrayList();
        // in this loop, the list should be filled with objects
        for(Class c : someClasses) {
            l.add(createObject<? extends Base>(c));   // ERROR: java: illegal start of expression
        }
    }
} 
```

上面代码中的错误就行了：

```
l.add(createObject<? extends Base>(c));   // ERROR: java: illegal start of expression 
```

如何正确构造`for`循环以及如何`createObject`正确调用方法以使列表`l`充满数组中的类对象`someClasses`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:59:25.017

你`Class[]`应该是一个`Class<? extends Base>[]`. 或者，使用 a `List<Class<? extends Base>>`，这不会导致泛型警告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:57:29.517

你不能用数组来做到这一点。您只能创建其组件类型是可*具体化类型*的数组，因为在运行时，当您放入一个元素时，JVM 必须进行类型检查（并且如果元素的类型与数组的类型不同，`ArrayStoreException`则会抛出一个）。这意味着您只能创建`Class`or的数组`Class<?>`，并且由于您无法表达元素与 的关系，因此`Class<Base>`您必须对从数组中取出的项目执行未经检查的强制转换。

第一个*修复*是丢弃数组并为源使用通用容器，例如`List<Class<? extends Base>>`

```
@SuppressWarnings("serial")
public static void main(String[] args) {

    List<Class<? extends Base>> src = new LinkedList<Class<? extends Base>>() {
        {
            add(Derived1.class);
            add(Derived2.class);
        }
    };

    List<Base> dst = new LinkedList<Base>();

    for (Class<? extends Base> c : src)
        dst.add(createObject(c));

} 
```

# c# - 如何覆盖部分类属性

> ID：15207652
> 
> 赞同：11
> 
> 时间：2013-03-04T17:43:11.560
> 
> 标签：c#, asp.net-mvc-4, entity-framework-5

我有一个部分课程，我想做如下的事情：

```
[MetadataType(typeof(UserMetaData))]
public partial class Person
{
    public override string PrivateData
    {
        get
        {
            return customDecrypt(base.PrivateData);
        }
        set
        {
            base.PrivateData = customEncrypt(value);
        }
    }
} 
```

但是，上述方法不起作用。

有没有办法覆盖基础实体框架类的属性以允许自定义 getter/setter？

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2013-03-04T18:09:24.520

部分类与继承无关，`override`完全是关于继承的。

类上的`partial`关键字只是意味着它可以在同一个程序集中多次声明。这与将 every 的每个部分复制`partial class`到同一个文件并删除`partial`关键字完全相同。`partial`由于您不能在同一个类中定义相同的属性/函数/等两次，因此即使使用关键字，您也不能在同一类的两个单独部分中定义它两次。

`override`另一方面，在*派生*类中使用它来表示它们正在替换它们所继承的基类的功能。如果它没有显式继承，它继承自`object`，它允许您覆盖`ToString()`（以及其他）。

您最好的选择是使用自定义 T4 模板来生成加密/解密逻辑，或者在设计器中`protected`或`private`在设计器中设置加密属性并手动添加`public`执行解密的版本。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-08-07T20:34:10.880

如果您可以更改代码生成器，则可以使用极其强大的**部分方法**轻松“模拟”它（“覆盖”默认值） 。

[https://msdn.microsoft.com/en-us/library/wa80x488.aspx](https://msdn.microsoft.com/en-us/library/wa80x488.aspx)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2019-09-09T08:40:47.823

虽然您不能覆盖 Entity Framework 基类，但有一种变通方法。在 .edmx 模型中（对于 DB 优先，如果代码优先，则直接在实体中）在要“覆盖”的属性上将 Getter / Setter 更改为私有并重命名属性。然后使用公共名称创建具有属性的部分类，这将不再冲突。

在公共部分类属性中，如果需要，您将能够访问私有重命名属性。

# c++ - c ++如何在不知道确切参数的情况下定义函数

> ID：15207664
> 
> 赞同：5
> 
> 时间：2013-03-04T17:43:53.120
> 
> 标签：c++, templates

我有一个模板功能

```
template <class T>
void foo() {
  // Within this function I need to create a new T
  // with some parameters. Now the problem is I don't
  // know the number of parameters needed for T (could be
  // 2 or 3 or 4)
  auto p = new T(...);
} 
```

我该如何解决这个问题？不知何故，我记得看到了带有（...，...）之类的输入的函数？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T17:50:33.060

您可以使用可变参数模板：

```
template <class T, class... Args>
void foo(Args&&... args){

   //unpack the args
   T(std::forward<Args>(args)...);

   sizeof...(Args); //returns number of args in your argument pack.
} 
```

[这个问题](https://stackoverflow.com/questions/4926674/unpacking-argument-list-with-variadic-template)在这里有更多关于如何从可变参数模板中解包参数的细节。这里的这个[问题](https://stackoverflow.com/questions/106508/what-is-a-smart-pointer-and-when-should-i-use-one)也可能提供更多信息

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:59:22.167

这是基于[可变参数模板](http://en.wikipedia.org/wiki/Variadic_template)为您工作的 C++11 示例：

```
#include <utility> // for std::forward.
#include <iostream> // Only for std::cout and std::endl.

template <typename T, typename ...Args>
void foo(Args && ...args)
{
    std::unique_ptr<T> p(new T(std::forward<Args>(args)...));
}

class Bar {
  public:
    Bar(int x, double y) {
        std::cout << "Bar::Bar(" << x << ", " << y << ")" << std::endl;
    }
};

int main()
{
    foo<Bar>(12345, .12345);
} 
```

希望能帮助到你。祝你好运！

# functional-programming - OCaml 中基于列表的快速排序中的 stack_overflow

> ID：15207668
> 
> 赞同：0
> 
> 时间：2013-03-04T17:44:11.577
> 
> 标签：functional-programming, ocaml

这是我的快速排序实现`list-based`：

```
let partition pivot l = 
    let rec p left right = function
      | [] -> (left, right)
      | hd::tl ->
    let c = compare pivot hd
    in 
    if c > 0 then
      p (hd::left) right tl
    else 
      p left (hd::right) tl
    in
    p [] [] l;;

let quicksort l =
  let rec qs = function
    | [] -> []
    | pivot::tl ->
      let (left, right) = partition pivot tl
      in 
      (qs left) @ (pivot::(qs right))
  in 
  qs l;; 
```

* * *

当我尝试使用 列表时`100,000`，它很好并且没有问题。

但是，如果我尝试使用`1,000,000`，它会给出错误`stack_overflow`。

* * *

我不明白为什么它会给出`stack_overflow`，因为我认为堆栈大小应该是这样的`log1000000 ~ 20`，对吧？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T18:01:38.133

`@`我假设操作员将使用线性数量的堆栈。（这只是对列表进行快速排序的问题之一。）

这是`@`Pervasives 模块的定义：

```
let rec ( @ ) l1 l2 =
  match l1 with
    [] -> l2
  | hd :: tl -> hd :: (tl @ l2) 
```

就目前而言，这是一种异常缓慢的排序。如果你真的想让这个工作，你必须更聪明。至少你需要一个尾递归版本的`@`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-05T19:26:33.760

快速排序不能用于链表。**效果**不好。用于列表的正确排序算法是归并排序。基本上，一旦你在算法中使用列表连接，你就应该意识到你没有做对，或者你应该使用其他数据结构。列表有很多优点，串联不是其中之一。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-15T06:05:13.360

如前所述，问题在于@。这不是一个无法解决的问题：您需要将内部排序函数重新定义为排序和连接的函数。

```
 let partition pivot l = 
     let rec p left right = function
       | [] -> (left, right)
       | hd::tl ->
     let c = compare pivot hd
     in 
     if c > 0 then
       p (hd::left) right tl
     else 
       p left (hd::right) tl
     in
     p [] [] l;;

 let quicksort l =
   let rec qs l acc = 
   match l with
     | [] -> acc
     | pivot::tl ->
       let (left, right) = partition pivot tl
       in 
       qs left (pivot::(qs right acc)) 
   in 
   qs l [];; 
```

# javascript - 带有返回布尔值的jquery错误

> ID：15207670
> 
> 赞同：1
> 
> 时间：2013-03-04T17:44:24.410
> 
> 标签：javascript, jquery

我是 javascript 的新手，我无法返回函数的布尔值。我正在验证文本框是否为 null，如果它的帮助为空，请返回 false？

```
validateForm : function() {
    $('.requiredField :input').each(function(){
        if ('input[type=text]'){
            if($(this).val().length === 0){
                    $(this).addClass('warning');
                    var  errorMsg = $('<br /><span>Please Fill in the TextBox</span>').addClass('warning');
                    errorMsg.insertAfter(this);
                    $(errorMsg).css('color','red');
                    $('.warning').css('border-color','red');
            //$(this).focus(function(){
                //$(this).removeClass('warning');   
                //$(this).parent().children('span').remove();
                //$(this).parent().children('br').remove();         
            //});
                    return false;
                }
            else 
                return true;
            }
        }); 

},
Form.validateForm(); // call to the function 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:48:42.490

您是`return`从. *_* `.each()`这不会使您的函数返回值。

在一个`.each()`循环中，`return false;`就像 using`break;`和`return true;`using `continue;`。

您需要在*之外*声明一个变量，在循环*内*`.each()`设置它的值，然后在循环*后*返回它。

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:51:58.517

检查这一行

```
if ('input[type=text]'){ 
```

它应该是

```
 if($('input[type=text]')){ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:59:48.707

你可以试试这个：

```
$('.requiredField :input').each(function(){
var i=$(this).val();

if(i == '' || i == null)
 {
 //execute your codes
 return false;
 }else{
 return true;
 }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:00:26.013

看来您正在尝试编写插件？试试下面的代码：

```
(function($) {
    $.fn.validateForm = function()
    {
        var formID = $(this).attr('id');

        $('#'+ formID +' input[type=submit]').click(function(e)
        { 

            e.preventDefault();

            $('input[type=text]').each(function(){

                if($(this).val().length === 0){                 

                        $(this).addClass('warning');
                        var  errorMsg = $('<span>Please Fill in the TextBox</span>').addClass('warning');
                        errorMsg.insertAfter(this);
                        $(errorMsg).css('color','red');
                        $('.warning').css('border-color','red');          
                        return false;
                }else{
                    return true;
                }
            });
        });
    };
})(jQuery); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-03-04T19:38:15.493

正如@RocketHazmat 所提到的，您的函数需要聚合来自内部循环的结果并具有单个退出点，以便验证（并添加 css 类/html 元素）**每个**输入。

你需要做这样的事情：

```
validateForm : function () {

        var invalidInputs = [];

        // only test the type='text' inputs
        $('.requiredField :input[type="text"]').each(function () {

            // if there is no value
            if ($(this).val() == undefined || $(this).val().length == 0) {

                $(this).addClass('warning');
                var errorMsg = $('<br /><span>Please Fill in the TextBox</span>').addClass('warning');
                errorMsg.insertAfter(this);
                $(errorMsg).css('color','red');
                $('.warning').css('border-color','red');

                // add the invalid input to an array
                invalidInputs.push($(this));
            }
        }); 

        // The form is only valid for no invalid inputs were found.
        return invalidInputs.length == 0;
    } 
```**

# jquery - jQuery 争用问题

> ID：15207675
> 
> 赞同：0
> 
> 时间：2013-03-04T17:44:37.317
> 
> 标签：jquery, setinterval

我有一个网页，其中加载了很多与 jQuery 相关的脚本。我在页面中包含另一个脚本以及现有脚本。

以下脚本可以正常工作，但除外。

```
 $(".mytext").emoticons(); 
```

但是当我在 setInterval 中使用相同的脚本时，其他与 jquery 相关的东西不起作用。

```
 $(function() {
      setInterval(function() { $(".mytext").emoticons() }, 5 * 1000);
  }); 
```

我错过了什么吗？如果我需要提供任何其他信息，请告诉我。我确信我可以为这个模糊的信息提供什么信息（是的，我知道），但对此一无所知。

编辑：上面提到的 emoticons() 是来自[http://users.dcc.uchile.cl/~skreft/emoticon/的 jquery 插件](http://users.dcc.uchile.cl/~skreft/emoticon/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:50:00.967

你为什么用jquery调用函数？像 $(function()...); 尝试在全局命名空间中设置间隔而不用 jquery 包装它

```
setInterval(function() { $(".mytext").emoticons() }, 5 * 1000); 
```

或将其放入匿名函数中：

```
(function(){
    setInterval(function() { $(".mytext").emoticons() }, 5 * 1000);
})(); 
```

请注意，也许您在加载表情脚本之前就开始了 setInterval

# html - 在 url 中隐藏 .html

> ID：15207678
> 
> 赞同：1
> 
> 时间：2013-03-04T17:44:49.713
> 
> 标签：html, .htaccess, url, hide

我想从 url 中隐藏 .html，例如 www.site.com/videos.html 到 www.site.com/videos。我在这里寻找类似的问题，但没有结果。

这是我的 .htaccess 文件：

```
RewriteEngine On
RewriteRule ^index.html$ index.php
RewriteRule ^browse-(.*)-videos.html$ category.php?cat=$1
RewriteRule ^browse-(.*)-videos-([0-9]+)-(.*).html$ category.php?cat=$1&page=$2&sortby=$3

RewriteRule ^register.html$ register.php
RewriteRule ^contact_us.html$ contact_us.php
RewriteRule ^edit_profile.html$ edit_profile.php
RewriteRule ^suggest.html$ suggest.php
RewriteRule ^upload.html$ upload.php
RewriteRule ^upload_avatar.html$ upload_avatar.php
RewriteRule ^suggest.html$ suggest.php

RewriteRule ^favorites.html(.*)$ favorites.php$1
RewriteRule ^login.html(.*)$ login.php$1
RewriteRule ^newvideos(.*)$ newvideos.php$1
RewriteRule ^topvideos.html(.*)$ topvideos.php$1
RewriteRule ^profile.html(.*)$ profile.php$1
RewriteRule ^favorites.html(.*)$ favorites.php$1
RewriteRule ^playlist/(.*)$ myfavorites.php?u=$1
RewriteRule ^memberlist.html(.*)$ memberlist.php$1

RewriteRule ^articles/read-(.*)_([0-9]+).html$ article_read.php?a=$2
RewriteRule ^articles/index-([0-9]+).html$ article.php?page=$1
RewriteRule ^articles/browse-(.*)-([0-9]+).html$ article.php?c=$1&page=$2
RewriteRule ^articles/tag/([^/]+)/page-([0-9]+)(/)?$ article.php?tag=$1&page=$2
RewriteRule ^articles/tag/([^/]+)(/)?$ article.php?tag=$1&page=1
RewriteRule ^articles/popular-([0-9]+).html$ article.php?show=popular&page=$1
RewriteRule ^articles(\/|.html)?$ article.php
RewriteRule ^article(\/|.html)?$ article.php
RewriteRule ^pages/(.*)\.html$ page.php?name=$1

RewriteRule ^tags/([^/]+)/$ tag.php?t=$1&page=1
RewriteRule ^tags/([^/]+)/page-([0-9]+)(/)?$ tag.php?t=$1&page=$2
RewriteRule ^([^/]*)-video_(.*).html$ watch.php?vid=$2
RewriteRule ^fpembed-(.*).swf$ fpembed.php?vid=$1
RewriteRule ^rss.xml$ rss.php [L]</code></pre> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:49:02.293

如果您只想将客户端重定向`videos.html`到`videos`

```
RewriteRule ^/?videos.html$ /videos 
```

这要求，那`/videos`是一个有效的 URL。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-12-24T16:57:03.310

试试这个：
RewriteRule ^([^.]+)$ $1.html [NC,L]

# google-apps-script - 为 Google Docs 电子表格添加行、移动数据和添加字符的脚本

> ID：15207679
> 
> 赞同：0
> 
> 时间：2013-03-04T17:44:54.453
> 
> 标签：google-apps-script

我正在 Google Docs 中运行一个项目，我需要脚本方面的帮助。我需要一个能够在两列电子表格中执行以下任务的人。

1.  在每个现有数据行之间插入一个新的空白行。
2.  将第二列中的数据下移一位，使它们占据新插入的空白行
3.  将大括号{}添加到第二列数据中的文本*即* **anytext--> {anytext}**

以下是它应该如何工作的示例：[示例 GDocs 电子表格](https://docs.google.com/spreadsheet/ccc?key=0AvvkJKPw-5d9dFBEY2VrY2c0NUQ0elpyQ1dtbkF4TGc&usp=sharing)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:20:09.373

您的问题与我刚刚尝试回答的上一个问题相距不远，所以我可以继续并提出一个可行的解决方案来解决这个（简单的）问题......所以它就是这样，不是最优雅但最简单且有效的。

```
function insertBlank() {
  var sh = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet()
  var last = lastRowinCol(sh,'A');
  var colA = sh.getRange('A1:A'+last).getValues();
  var colB =  sh.getRange('B1:B'+last).getValues();
  var nA = [];
  var nB = [];
  for(n=0;n<last;++n){
  nA.push([colA[n]])
  nA.push(['']);
  nB.push([''])
  nB.push(['{'+colB[n][0]+'}']);
  }
  Logger.log(nA.length+' = '+nA)
  Logger.log(nB.length+' = '+nB)
  sh.getRange(1,1,nA.length,1).setValues(nA);
  sh.getRange(1,2,nB.length,1).setValues(nB);
}

function lastRowinCol(sh,col){
  var coldata = sh.getRange(col+'1:'+col).getValues();
  for(var c in coldata){if(coldata[c][0]==''){break}}
  return c
  } 
```

也就是说，您最好提出更合适的问题，并表明您已经尝试过，然后才能免费购物；-)

* * *

**编辑：**[在 Mogsdad 对另一篇文章发表](https://stackoverflow.com/questions/15189695/add-timeline-when-cell-value-is-changed-google-script)非常相关的评论之后，我建议您用他的代码替换 for-next 循环，`function lastRowinCol`该代码向后迭代，以便处理列中的空单元格。此外，他的代码有一个有趣的结构，因为循环限制和条件在同一个语句中。

```
function lastRowinCol(sh,col){
  var coldata = sh.getRange(col+'1:'+col).getValues();
  for (var c=coldata.length; (c) && coldata[c-1][0]==''; c--) {}
  return c
 } 
```

# c# - 为什么 c# 编译器在某些情况下会发出 newobj/stobj 而不是“调用实例 .ctor”来进行结构初始化

> ID：15207683
> 
> 赞同：19
> 
> 时间：2013-03-04T17:45:04.337
> 
> 标签：c#, .net, il

这里有一些 C# 中的测试程序：

```
using System;

struct Foo {
    int x;
    public Foo(int x) {
        this.x = x;
    }
    public override string ToString() {
        return x.ToString();
    }
}

class Program {
    static void PrintFoo(ref Foo foo) {
        Console.WriteLine(foo);
    }

    static void Main(string[] args) {
        Foo foo1 = new Foo(10);
        Foo foo2 = new Foo(20);

        Console.WriteLine(foo1);
        PrintFoo(ref foo2);
    }
} 
```

这里是方法Main的反汇编编译版本：

```
.method private hidebysig static void Main (string[] args) cil managed {
    // Method begins at RVA 0x2078
    // Code size 42 (0x2a)
    .maxstack 2
    .entrypoint
    .locals init (
        [0] valuetype Foo foo1,
        [1] valuetype Foo foo2
    )

    IL_0000: ldloca.s foo1
    IL_0002: ldc.i4.s 10
    IL_0004: call instance void Foo::.ctor(int32)
    IL_0009: ldloca.s foo2
    IL_000b: ldc.i4.s 20
    IL_000d: newobj instance void Foo::.ctor(int32)
    IL_0012: stobj Foo
    IL_0017: ldloc.0
    IL_0018: box Foo
    IL_001d: call void [mscorlib]System.Console::WriteLine(object)
    IL_0022: ldloca.s foo2
    IL_0024: call void Program::PrintFoo(valuetype Foo&)
    IL_0029: ret
} // end of method Program::Main 
```

我不明白为什么发出 newobj/stobj 而不是简单的 call .ctor ？为了让它更神秘，由 jit-compiler 在 32 位模式下对一个 ctor 调用进行了优化的 newobj+stobj，但在 64 位模式下却没有......

**更新：**

为了澄清我的困惑，以下是我的期望。

值类型声明表达式，如

`Foo foo = new Foo(10)`

应该通过编译

`call instance void Foo::.ctor(int32)`

值类型声明表达式，如

`Foo foo = default(Foo)`

应该通过编译

`initobj Foo`

在我看来，构造表达式的临时变量或默认表达式的实例应被视为目标变量，因为这不会导致任何危险行为

```
try{
    //foo invisible here
    ...
    Foo foo = new Foo(10);
    //we never get here, if something goes wrong
}catch(...){
    //foo invisible here
}finally{
    //foo invisible here
} 
```

赋值表达式如

`foo = new Foo(10); // foo declared somewhere before`

应该编译成这样的：

```
.locals init (
    ...
    valuetype Foo __temp,
    ...
)

...
ldloca __temp
ldc.i4 10
call instance void Foo::.ctor(int32)
ldloc __temp
stloc foo
... 
```

这是我理解 C# 规范所说的方式：

> 7.6.10.1 对象创建表达式
> 
> ...
> 
> new T(A) 形式的对象创建表达式的运行时处理，其中 T 是类类型或结构类型，A 是可选的参数列表，包括以下步骤：
> 
> ...
> 
> 如果 T 是结构类型：
> 
> *   T 类型的实例是通过分配一个临时**局部**变量来创建的。由于结构类型的实例构造函数需要明确地为正在创建的实例的每个字段分配一个值，因此不需要初始化临时变量。
>     
>     
> *   根据函数成员调用规则（第 7.5.4 节）调用实例构造函数。对新分配的实例的引用会自动传递给实例构造函数，并且可以从该构造函数中访问实例作为 t​​his。

我想强调“分配一个临时**局部**变量”。在我的理解中，newobj 指令假设在堆上创建对象......

在这种情况下，对象创建与使用方式的相关性让我感到沮丧，因为 foo1 和 foo2 对我来说看起来相同。

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-03-04T18:26:26.413

首先，你应该阅读我关于这个主题的文章。它没有解决您的*具体*情况，但它有一些很好的背景信息：

[https://ericlippert.com/2010/10/11/debunking-another-myth-about-value-types/](https://ericlippert.com/2010/10/11/debunking-another-myth-about-value-types/)

好的，现在您已经阅读，您知道 C# 规范声明构造结构的实例具有以下语义：

*   创建一个临时变量来存储结构值，初始化为结构的默认值。
*   将对该临时变量的引用作为构造函数的“this”传递

所以当你说：

```
Foo foo = new Foo(123); 
```

这相当于：

```
Foo foo;
Foo temp = default(Foo);
Foo.ctor(ref temp, 123); // "this" is a ref to a variable in a struct.
foo1 = temp; 
```

*现在，您可能会问，当我们已经有*`foo`一个可能是的变量时，为什么还要麻烦分配一个临时变量`this`：

```
Foo foo = default(Foo);
Foo.ctor(ref foo, 123); 
```

这种优化称为*复制省略*。当 C# 编译器和/或抖动使用其启发式方法确定这样做*始终是不可见*的时，允许执行复制省略。在极少数情况下，复制省略会导致程序发生可观察到的变化，在这种情况下，不得使用优化。例如，假设我们有一个整数对结构：

```
Pair p = default(Pair);
try { p = new Pair(10, 20); } catch {}
Console.WriteLine(p.First);
Console.WriteLine(p.Second); 
```

我们期望`p`这里是`(0, 0)`or `(10, 20)`，从不是`(10, 0)`or `(0, 20)`，即使 ctor 中途抛出。也就是说，要么赋值`p`是完全构造的值，要么根本没有进行任何修改`p`。这里不能进行复制省略；我们必须制作一个临时文件，将临时文件传递给 ctor，然后将临时文件复制到`p`.

同样，假设我们有这种精神错乱：

```
Pair p = default(Pair);
p = new Pair(10, 20, ref p);
Console.WriteLine(p.First);
Console.WriteLine(p.Second); 
```

如果 C# 编译器执行复制省略 then`this`并且`ref p`都是 的别名`p`，这明显不同于 if`this`是临时的别名！ctor 可以观察到更改是否`this`会导致更改，`ref p`如果它们为同一个变量起别名，但如果它们为不同的变量起别名，则不会观察到这一点。

C# 编译器启发式决定在您的程序中`foo1`而不是`foo2`在您的程序中执行复制省略。它是看到`ref foo2`你的方法中有一个并决定在那里放弃。它可以进行更复杂的分析，以确定它*不在*这些疯狂的混叠情况之一，但事实并非如此。如果有任何机会（无论多么遥远）可能存在使省略可见的混叠情况，那么便宜且容易做的事情就是跳过优化。它生成`newobj`代码并让抖动决定是否要进行省略。

至于抖动：64 位和 32 位抖动具有完全不同的优化器。显然，其中一个决定它可以引入 C# 编译器没有的复制省略，而另一个则不是。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:28:52.373

那是因为变量`foo1`和`foo2`不同。

`foo1`变量只是一个值，但变量`foo2`既是值又是指针，因为它在使用`ref`关键字的调用中使用。

当`foo2`变量被初始化时，指针被设置为指向该值，并使用指针的值而不是值的地址调用构造函数。

如果您设置了两种`PrintFoo`方法，唯一的区别是一种方法具有`ref`关键字，并分别使用一个变量调用它们：

```
Foo a = new Foo(10);
Foo b = new Foo(20);
PrintFoo(ref a);
PrintFoo(b); 
```

如果你反编译生成的代码，变量之间的差异是可见的：

```
&Foo a = new Foo(10);
Foo b = new Foo(20);
Program.PrintFoo(ref a);
Program.PrintFoo(b); 
```

# hibernate - 如何在带有 envers 的审计实体中强制进行字段更新？

> ID：15207684
> 
> 赞同：1
> 
> 时间：2013-03-04T17:45:19.180
> 
> 标签：hibernate, hibernate-envers

我正在使用 Envers 来了解我的实体的最后一个字段更新。

有时我需要（在审计表中）强制更新一个字段（新版本：该字段的新日期和布尔值为 true），而该字段没有更改。

Envers是否可以默认使用？

如果没有，我可以扩展机制吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T11:21:30.117

Envers 是不可能的，我认为没有任何扩展点可以允许这样做。使用 .equals() 比较字段。

# php - Mysql cpu使用增加排序lat lon距离最近点

> ID：15207685
> 
> 赞同：0
> 
> 时间：2013-03-04T17:45:20.110
> 
> 标签：php, mysql, performance, coordinates, point

问题是：当我在脚本 php 中添加此查询时，为什么 mysql 的 cpu 使用率会达到 300% -> 400%？

我想从坐标点（MYLAT，MYLON）中找到某个类别（cat_id）最近的兴趣点（poi_id）

**POI**（poi）表：

```
 | poi_id | name | city_id | lat | lon | 
```

**相关性**表（corr）：

```
| cat_id | poi_id | city_id | 
```

城市表（**城市**）

```
| city_id | name | 
```

**脚本：**

$lat = **MYLAT** ; // 我起点的纬度

$lon =**麦隆**; // 我起点的经度

**边界框**：

$lon1 = $lon - ($dist/abs(cos(rad2deg($lat)) * 60 * 1.1515));

$lon2 = $lon + ($dist/abs(cos(rad2deg($lat)) * 60 * 1.1515));

$lat1 = $lat - ($dist/ 60 * 1.1515);

$lat2 = $lat + ($dist/ 60 * 1.1515);

当我添加此查询时，CPU 使用率变得疯狂：

```
SELECT a.poi_id,a.name,a.city_id,g.name,a.lat, a.lon,
((ACOS(SIN($lat * PI() / 180) * SIN(a.lat * PI() / 180) +
COS($lat * PI() / 180) * COS(a.lat * PI() / 180) *
COS(($lon - a.lon) * PI() / 180)) * 180 / PI()) * 69.09) AS distance
FROM poi a JOIN corr c on a.poi_id = c.poi_id JOIN city g on c.city_id = g.city_id 
WHERE  a.lon > $lon1 and a.lon < $lon2
AND a.lat > $lat1 and  a.lat < $lat2
AND c.cat_id = $cat_id
HAVING distance < $dist
ORDER BY distance
LIMIT 20

+----+-------------+-------+--------+----------------------------------+---------+---------+--------------------+------+-----------------------------+
| id | select_type | table | type   | possible_keys                    | key     | key_len | ref                | rows | Extra                       |
+----+-------------+-------+--------+----------------------------------+---------+---------+--------------------+------+-----------------------------+
|  1 | SIMPLE      | a     | range  | poi_id,lat,lon,lat_2             | lat_2   | 14      | NULL               | 6924 | Using where; Using filesort |
|  1 | SIMPLE      | c     | eq_ref | city_id_2,cat_id,poi_id,city_id  | cat_id  | 5       | const,a.poi_id     |    1 |                             |
|  1 | SIMPLE      | g     | eq_ref | PRIMARY                          | PRIMARY | 4       | c.city_id          |    1 | Using where                 |
+----+-------------+-------+--------+----------------------------------+---------+---------+--------------------+------+-----------------------------+

mysql> show profile;
+----------------------+----------+
| Status               | Duration |
+----------------------+----------+
| starting             | 0.000138 |
| checking permissions | 0.000010 |
| checking permissions | 0.000006 |
| checking permissions | 0.000008 |
| Opening tables       | 0.000028 |
| System lock          | 0.000015 |
| init                 | 0.000043 |
| optimizing           | 0.000023 |
| statistics           | 0.000221 |
| preparing            | 0.000024 |
| Creating tmp table   | 0.000029 |
| executing            | 0.000005 |
| Copying to tmp table | 0.174197 |
| Sorting result       | 0.000066 |
| Sending data         | 0.000065 |
| end                  | 0.000006 |
| removing tmp table   | 0.000010 |
| end                  | 0.000006 |
| query end            | 0.000005 |
| closing tables       | 0.000011 |
| freeing items        | 0.000077 |
| logging slow query   | 0.000005 |
| cleaning up          | 0.000006 |
+----------------------+----------+
23 rows in set (0.00 sec) 
```

# java - 如何创建类声明对象然后赋值

> ID：15207690
> 
> 赞同：0
> 
> 时间：2013-03-04T17:45:38.283
> 
> 标签：java, reflection

用户输入一个表达式。假设用户输入以下内容：

```
new y java.util.ArrayList int:5 
```

我已成功标记字符串并将其存储到我的字符串数组的不同位置。接下来我要做的是检查索引上的内容并按照上述输入中提到的内容进行反思。我被卡住了怎么做。到目前为止，这是我的代码

```
 public static void handling_input()
    {
         System.out.println("Welcome To Java Command Prompt: ");
         aLine = null;
         try
         {
            System.out.println("Enter The Command Line Expression: ") ;
            keyboard = new BufferedReader(new InputStreamReader(System.in));
            aLine = keyboard.readLine();
         st =  new StringTokenizer(aLine);
         dt = new StringTokenizer(aLine);
         }
         catch (IOException ex)
         {
             System.out.println("Error reading input!");
         }

    }
    public static void storing_tokens()
    {
        int counter =0;
        while(st.hasMoreTokens())
        {
            counter++;
            st.nextToken();
        }
        int i=0;
        expression_keeper= new String[counter];
        do
        {
            expression_keeper[i] = dt.nextToken().toString();
            i++;
        }while(dt.hasMoreTokens());
    }
    public static void token_classification()
    {
        for(int i=0; i<expression_keeper.length; i++)
        {
            if(expression_keeper[0].equalsIgnoreCase("new"))
            {

            }
            else
            if(expression_keeper[0].equalsIgnoreCase("call"))
            {

            }
            else
            if(expression_keeper[0].equalsIgnoreCase("print"))
            {

            }
            else
            {
                System.out.println("Invalid Script!");
            }
        }
    }
} 
```

在这个 if 条件里面：

```
if(expression_keeper[0].equalsIgnoreCase("new"))
        {

        } 
```

我想创建指定的类，它的对象并将值分配给提到的修饰符！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:53:52.210

我不清楚您的输入字符串标记的真正含义。“java.util.ArrayList”是“y”的类型吗？它的初始大小应该是 5 个单位吗？还是第一个元素应该是 5 的整数？

在过去，我发现编写自己的语法标记器和解析器是一件很复杂的事情。即使在简单的情况下，我也经常发现从长远来看使用[JavaCC](http://javacc.java.net/)之类的东西更容易。

通过正式指定您的语法，您可以为您的代码提供很多结构性和可调试性。然后如其他地方所说，使用内省进行创作。执行此操作的软件包位于`java.lang.reflect`.

# c# - DataFormatString 在gridview 列中不起作用

> ID：15207693
> 
> 赞同：1
> 
> 时间：2013-03-04T17:45:52.300
> 
> 标签：c#, asp.net

我在页面中有一个带有 gridview 的 ASP.NET 3.5 应用程序。

我想将其中一列格式化为日期时间。我试过了：

```
<asp:BoundField DataField="StatusDate" HeaderText="as of" SortExpression="StatusDate" DataFormatString="{0:d}" /> 
```

问题是无论我做什么，我的格式都不会改变。我已经尝试过其他日期格式字符串（通用、可排序、长日期等），但此列的格式永远不会改变。

我不认为我做错了什么，但是当我尝试根据此列进行排序时，这让我发疯了。因为默认将列格式化为字符串，所以当我按列标题排序时它不能正确排序。

有人看到这个并且有某种解决方法吗？我看过文章提到添加自定义排序方法，但如果可以的话，我会尝试坚持使用开箱即用的功能。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-11-19T19:01:23.770

我实际上遇到过几次这个问题，并提出了以下解决方案。首先，我将所有数据放在 DataTable 中进行存储。

其次，我需要专门格式化的列我也隐式定义了数据类型。

```
 DataTable table = new DataTable();
    table.Columns.Add("decimalNumber").DataType = System.Type.GetType("System.Decimal");
    table.Columns.Add("date").DataType = System.Type.GetType("System.DateTime"); 
```

然后当我在 GridView 中调用它时

```
 <asp:BoundField DataField="decimalNumber" DataFormatString="{0:C}" />
    <asp:BoundField DataField="date" DataFormatString="{0:dd/MM/yyyy}" /> 
```

结果将如下所示 **$0.00 & 19/11/2014**。我希望这有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:55:19.483

您不能从字符串格式化为日期时间。

但是，您可以使用以下方法。输出与使用 BoundField 基本相同。

```
<asp:TemplateField HeaderText="as of" SortExpression="StatusDate">
   <ItemTemplate>
      <asp:Literal ID="Literal1" runat="server" 
        Text='<%# string.Format("{0:d}",  Convert.ToDateTime(Eval("StatusDate"))) %>'>        
      </asp:Literal>
   </ItemTemplate>
</asp:TemplateField> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-06-13T11:27:02.517

问题是您的数据/列的数据类型是字符串。您的 DataFormatString 属性仅适用于日期时间列。这个问题的解决方案可以在这个 SO 答案中找到。

[应用于gridview中的boundfields的格式不起作用](https://stackoverflow.com/questions/3629837/formatting-applied-to-boundfields-in-gridview-is-not-working)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-05-18T11:39:01.110

因为该列的源的数据类型不是日期时间！

# c++ - boost:python 传递一个指向指针的指针作为参数

> ID：15207696
> 
> 赞同：4
> 
> 时间：2013-03-04T17:46:01.780
> 
> 标签：c++, python, image, pointers, boost

首先，我不是 python 程序员，所以请原谅我的愚蠢错误。

在 C++ 中，我有一个来自 MyClass 的公共方法，它动态创建图像并返回其大小。

```
int MyClass::getImg(uchar *uimg[])
{
    int size = variable_size;
    *_uimg = new uchar[size];
    memcpy(*_uimg, imageOrigin->data(), size);
    uimg = _uimg;
    return size;
} 
```

和升压：蟒蛇：

```
BOOST_PYTHON_MODULE(mymodule)
{
    class_<MyClass>("MyClass")
        .def("getImg", &MyClass::getImg)
    ;
} 
```

当我尝试在 python 中使用它时：

```
def getImg():
    img = c_char_p()
    size = mymodule.MyClass.getImg(byref(img)) 
```

我收到此错误：

```
Boost.Python.ArgumentError: Python argument types in
    MyClass.getImg(MyClass, CArgObject, CArgObject)
did not match C++ signature:
    getImg(class MyClass {lvalue}, unsigned char * *) 
```

在python中我也尝试过声明

```
img = POINTER(c_ubyte)() 
```

但这也没有帮助。

我用谷歌搜索了几个小时，但没有想出任何好的解决方案。

我只需要在 python 中访问该图像，我该如何完成？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-25T17:49:40.743

修订版和工作版，将数据公开为 python 列表。

我不确定如何实现这一点，但如果您可以自由选择 python 接口，可能会有更好的实现方式。我认为创建一个列表可能是公开它的更好方法。你对返回值有什么期望？也许您也可以将其包装为 numpy 数组以获得更好的性能（如果您搜索 boost python 和 numphy，stackoverflow 上也有一些问题）

```
class TestPtr
{
public:
  int getImg(uchar **uimg)
  {
     int size = 9045;
     uchar *_uimg = new uchar[size];
     for( int i = 0; i < size; ++i )
       _uimg[i] = i;  

    *uimg = _uimg;
     return size;
 }
};

boost::python::list getImgList( TestPtr &p )
{
  uchar *uimg;
  int rv = p.getImg(&uimg);
  boost::python::list l;
  for ( int i = 0; i < rv; ++i)
    l.append( uimg[i] );
  return l;
}

BOOST_PYTHON_MODULE(mymodule)
{
  class_<TestPtr>("TestPtr")
    .def("getImg",&getImgList)
    ;
} 
```

另一个提示，在您的问题中，您使用以下行来调用该方法：

```
 mymodule.MyClass.getImg() 
```

这将对您的对象进行类调用（或多或少等同于静态调用）。这是一种更正确的方法：

```
img = mymodule.MyClass()
data = img.getImg() 
```

# mule - 如何干净地终止 Mule 3 中的消息处理？

> ID：15207704
> 
> 赞同：1
> 
> 时间：2013-03-04T17:46:29.660
> 
> 标签：mule, mule-studio

这必须是一个共同的特征，但我似乎无法找到它。我有这样的流程；

```
 <inbound-endpoint.../>
   <collection-splitter.../>
   <custom component.../>
   ... 
```

如果自定义组件收到我想丢弃的消息，没有进一步的操作，它是如何完成的？我不想中止处理集合的其余元素，只是一个项目。

现在，我让组件返回 null 并在其后面加上有效负载类型过滤器，但这似乎很笨拙。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:06:40.560

在这种情况下，将您的组件转换为拦截器：组件将决定是否转发当前的 Mule 事件以进行下游处理。

为此，您需要实施[`org.mule.api.interceptor.Interceptor`](http://www.mulesoft.org/docs/site/3.2.1/apidocs/index.html?org/mule/api/interceptor/Interceptor.html).

阅读以下内容以获取更多信息： http: [//www.mulesoft.org/documentation/display/current/Using+Interceptors#UsingInterceptors-WritingInterceptors](http://www.mulesoft.org/documentation/display/current/Using+Interceptors#UsingInterceptors-WritingInterceptors)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-11T10:14:25.377

我们应该在 mule 3 流中使用消息过滤器。mule 3 流不支持 muleEventContext 的 setStopFurtherProcessing。

```
<message-filter doc:name="Message">
   <not-filter>
      <payload-type-filter expectedType="org.mule.transport.NullPayload"></payload-type-filter>
  </not-filter>
</message-filter> 
```

# jquery - HTML5 localStorage 对复选框执行操作

> ID：15207710
> 
> 赞同：0
> 
> 时间：2013-03-04T17:46:52.650
> 
> 标签：jquery, html

按照这里的教程，[http://css-tricks.com/video-screencasts/96-localstorage-for-forms/](http://css-tricks.com/video-screencasts/96-localstorage-for-forms/)。我能够使用提交按钮重新创建功能，但是，是否可以使用复选框而不是按钮？

这是我到目前为止所拥有的，

```
if (localStorage) {

$(function() {

    // Insert new buttons
    $("#savelinks")
        .after("<input type='submit' value='Save Address' id='saveData'> &nbsp;&nbsp;")
        .after("<input type='submit' value='Clear Saved Address' id='clearData'>");

    $("#saveData")
        .click(function(e) {

                    e.preventDefault();
                    // Test if saved data exists on page load
                    localStorage.setItem("flag", "set");
                    var data = $("#form1").serializeArray();

                    // iterate over results
                    $.each(data, function(i, obj) {

                                   localStorage.setItem(obj.name, obj.value);

                     });

        });

    if (localStorage.getItem("flag") == "set") {
        var data = $("#form1").serializeArray();
        $.each(data, function(i, obj) {
            $("[name='" + obj.name +"']").val(localStorage.getItem(obj.name));
        });
    }   

    $("#clearData")
        .click(function(e) {
            e.preventDefault();
            localStorage.setItem("flag", "");
        });
});
} 
```

先感谢您！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:29:55.953

使用[change](http://api.jquery.com/change/)事件，查看复选框是否被选中；

```
$('#MyCheckbox').change(function() {

  var $this = $(this), // Current checkbox
      isChecked = this.checked, // We can also use $this.prop('checked')
      data = $('#form1').serializeArray();

  if (isChecked) {
    // Store serialized form data
  } else {
    // Clear stored form data
  }

}); 
```

# cocoa - 如何定位 Cocoa 窗口以最小化与其他窗口的重叠？

> ID：15207711
> 
> 赞同：3
> 
> 时间：2013-03-04T17:46:53.057
> 
> 标签：cocoa, nswindow, heuristics, window-managers, nsworkspace

我正在开发一个具有主窗口和预览窗口的 Cocoa 应用程序。我希望预览窗口能够自动定位以尽量减少与其他窗口的重叠——它绝对不应该与我的应用程序的主窗口重叠，并且它应该尽量不与其他应用程序的窗口重叠。

我该怎么做？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T20:29:18.823

Apple 有一个名为[Son of Grab](http://developer.apple.com/library/mac/#samplecode/SonOfGrab/Introduction/Intro.html)的示例应用程序，它向您展示如何使用所有当前窗口。

`CFArrayRef windowList = CGWindowListCopyWindowInfo(kCGWindowListOptionOnScreenOnly, kCGNullWindowID);`会给你当前的窗口。您可以查询该`kCGWindowBounds`值以获取返回窗口的边界。

# java - http:// a href 链接在 Android 中不起作用

> ID：15207717
> 
> 赞同：4
> 
> 时间：2013-03-04T17:47:12.747
> 
> 标签：java, android, android-intent

我在我的 Android 应用程序中使用 webview。

我有 3 个按钮 1 用于链接到网站 1 用于拨打号码和 1 电子邮件按钮。

起初调用我的网站按钮有效，[http://www.somelink.com](http://www.somelink.com) 。

但是我的电话：链接不起作用。所以我集成了一些代码，使我的电话：按钮工作。

问题是它使我的网站或 http: 按钮不起作用？

当您单击它时，html 按钮什么也不做。

```
package de.sonae.novolam;

import android.annotation.SuppressLint;
import android.app.Fragment;
import android.content.Intent;
import android.net.Uri;
import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.webkit.WebView;
import android.webkit.WebViewClient;

@SuppressLint("SetJavaScriptEnabled")
public class DFragment extends Fragment {

public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
View mainView = (View) inflater.inflate(R.layout.dfragment, container, false);
WebView webView = (WebView) mainView.findViewById(R.id.webview);
webView.getSettings().setJavaScriptEnabled(true);

webView.setWebViewClient(new WebViewClient() {
    @Override
    public boolean shouldOverrideUrlLoading(WebView wv, String url) {
    if (url.startsWith("tel:")) { 
            Intent intent = new Intent(Intent.ACTION_DIAL,
                    Uri.parse(url)); 
            startActivity(intent); 
    }

    return true;
}
    });
webView.loadUrl("file:///android_asset/contact.html");
return mainView;
}

public boolean shouldOverrideUrlLoading(WebView webView, String url) {
    if( url.startsWith("http:") || url.startsWith("https:") ) {
        webView.loadUrl(url);
         Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
         startActivity( intent ); 
    }

    else if (url.startsWith("mailto:")) { 

    }

    // Otherwise allow the OS to handle it
    Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
    startActivity( intent ); 
    return true;
}
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T17:56:08.190

您的代码中有两种`shouldOverrideUrlLoading`方法。唯一的第一个实际上是由 a 调用的`WebView`。将代码从第二个移动`shouldOverrideUrlLoading`到第一个，它将起作用。

```
webView.setWebViewClient(new WebViewClient() {
    @Override
    public boolean shouldOverrideUrlLoading(WebView wv, String url) {
        if (url.startsWith("tel:")) { 
            Intent intent = new Intent(Intent.ACTION_DIAL, Uri.parse(url)); 
            startActivity(intent);
            return true;
        } else if( url.startsWith("http:") || url.startsWith("https:") ) {
            Intent intent = new Intent(Intent.ACTION_VIEW, Uri.parse(url));
            startActivity(intent); 
            return true;
        } else if (url.startsWith("mailto:")) { 
            // TODO : handle mail url
            return true;
        }

        return false;
    }   
}); 
```

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-03-04T18:08:41.977

当您自己处理 url 加载以及何时要对其进行委托处理时，您需要告诉 web 视图。`shouldOverrideUrlLoading`只需从您通过自己的操作处理 url 加载时返回 true 。否则返回 false：

```
webView.setWebViewClient(new WebViewClient() {
    @Override
    public boolean shouldOverrideUrlLoading(WebView wv, String url) {
        if (url.startsWith("tel:")) { 
            Intent intent = new Intent(Intent.ACTION_DIAL,
                    Uri.parse(url)); 
            startActivity(intent); 

            return true; // we handled the url loading
        }

        return false; // let WebView handle this event
    }
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T18:10:34.340

如果您想覆盖（即阻止默认处理），则 shouldOverrideUrlLoading 方法应该返回 true，如果您希望一切正常工作，则应该返回 false。

```
@Override
public boolean shouldOverrideUrlLoading(WebView wv, String url) {
    if (url.startsWith("tel:")) { 
        Intent intent = new Intent(Intent.ACTION_DIAL, Uri.parse(url)); 
        startActivity(intent);
        return true;
    }

    return false;
} 
```

# codeigniter - CodeIgniter 和自定义路由

> ID：15207718
> 
> 赞同：0
> 
> 时间：2013-03-04T17:47:22.443
> 
> 标签：codeigniter, content-management-system, routes, theory

我对一个理论问题感兴趣。例如，我想创建具有可读 URL 的 CMS（例如，/hot-news/very-hot-news/）。我不想破坏引擎的面向对象模型，所以我计划创建一个路由文件，每次添加新文章时都会从管理面板重写。

例如，如果我的项目增长到 10,000 个这些 URL，这不会是额外的负载，因为路由引擎 - 一个保存所有记录的数组。是的，我想对某些部分使用正则表达式，但理论上它可能位于具有不同控制器的 10,000 个页面的根目录（/my-gallery/ → /gallery/$1、/feedback/ → /feedback/ 等）。

向您展示如何在 CodeIgniter 中正确添加对 URL-read 的完全支持以及我是否要构建我的系统？

# c# - 将 byte[] 转换为字符串并再次返回

> ID：15207731
> 
> 赞同：1
> 
> 时间：2013-03-04T17:48:16.927
> 
> 标签：c#, type-conversion

我有一个应用程序以 varbinary(16) 的方式将请求的 IP 地址存储在数据库中，其方式如下：[Byte Array Size for a IPv6 IP Address](https://stackoverflow.com/questions/15115463/byte-array-size-for-a-ipv6-ip-address)。

我需要将 IP 地址从一台服务器传递到另一台服务器。因此，我不能只依赖 Request 对象。我的问题是，如果我将 IP 地址作为字节 []，我如何将其编码为字符串，然后再次将其解码为字节 []？我总是对 ASCII、UTF8、Unicode 等编码感到困惑。

非常感谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:52:19.670

```
var ipString = (new IPAddress(myBytes)).ToString() 
```

然后在另一端

```
var addressBytes = IPAddress.Parse(ipString).GetAddressBytes(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:52:32.833

对于稍微更用户友好的字符串表示，您可以使用[Base64](http://en.wikipedia.org/wiki/Base64)

```
str = System.Convert.ToBase64String(bytes);
bytes = System.Convert.FromBase64String(str); 
```

# php - PHP Json Web 服务错误

> ID：15207734
> 
> 赞同：0
> 
> 时间：2013-03-04T17:48:28.633
> 
> 标签：php, json

我在使用 php 创建的 JSON Web 服务时遇到问题。当我包含 echo $_GET['jsoncallback'].'('.json_encode($posts).')'; 除此之外，我在行（某个数字）上收到了一个错误的未识别索引，但它是 echo $_GET['jsoncallback'].'('.json_encode($posts).')'; 出现。

如果我离开那条线，我会得到 JSON，但最终会出现标签无效的错误

我该如何解决这个问题？我的代码如下。

```
<?php
$link = mysql_connect('localhost','root','') or die('Cannot connect to the DB');
mysql_select_db('music_db',$link) or die('Cannot select the DB');

/* grab the posts from the db */
$query = "SELECT track.track_id, track.track_name, artist.artist_name, genre.genre_name FROM artist INNER JOIN (genre INNER JOIN track ON genre.genre_id = track.genre_id) ON artist.artist_id = track.artist_id";
$result = mysql_query($query,$link) or die('Errant query:  '.$query);

/* create one master array of the records */
$posts = array();
if(mysql_num_rows($result)) {
while($post = mysql_fetch_assoc($result)) {
  $posts[] = array('post'=>$post);
 }
}

/* output in necessary format */
header('Content-type: application/json');
echo json_encode(array('posts'=>$posts));
@mysql_close($link);
?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:51:18.007

您收到通知是因为您尝试使用的索引未设置。在使用它之前，您需要检查它。

```
if(isset($_GET['jsoncallback'])) {
  // Code here
} 
```

# f# - F# 3.0 运行时是否可再发行？

> ID：15207738
> 
> 赞同：8
> 
> 时间：2013-03-04T17:48:50.737
> 
> 标签：f#, f#-3.0

在法律上可以重新分发 F# 3.0 运行时（FSharp.Core.dll 版本 2.3.0.0、4.3.0.0），我在哪里可以找到证明？我准备了一个带有这些的 NuGet 包，但在发布包之前对许可有第二个想法。Microsoft 将 F# 2.0 运行时作为 redist 包发布 - 所以没有问题，但我的印象是获得 F# 3.0 运行时的唯一方法是安装 VS 2011 或类似版本；我不确定检查重新分发 F# 运行时是否正常的许可证在哪里。

请注意，问题仅与使用 Microsoft 密钥签名的二进制文件有关。代码源可在 Apache 许可下获得。

拥有带有 DLL 的 NuGet 包将使一些构建情况更容易。

开源 F# 存储库继续进行并重新分发 Microsoft 签名的 FSharp.Core.dll（请参阅[https://github.com/fsharp/fsharp](https://github.com/fsharp/fsharp)），但我仍然想确保这是允许的。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-05T02:20:19.007

答案是肯定的，F# 3.0 运行时可以重新分发。EULA 可在[http://www.microsoft.com/en-us/download/details.aspx?id=34675找到](http://www.microsoft.com/en-us/download/details.aspx?id=34675)

感谢 Don Syme 在 F# 开源论坛上的回答：[https ://groups.google.com/forum/#!msg/fsharp-opensource/VQawzPvLKPI/HIBz1iw9Z1UJ](https://groups.google.com/forum/#!msg/fsharp-opensource/VQawzPvLKPI/HIBz1iw9Z1UJ)

# r - 是否已经存在可以将任何列表作为树打印到控制台的 R 包（使用 ASCII 符号）？

> ID：15207741
> 
> 赞同：2
> 
> 时间：2013-03-04T17:49:00.660
> 
> 标签：r, dendrogram, hclust

我发现能够使用与`str.dendrogram`. 我编写了自己的函数，这种方法很有效，但重复努力是没有意义的。那么，有人知道已经这样做的任何软件包吗？或者一种从任意嵌套列表轻松创建假树状图或 hclust 对象而无需实际聚类的方法？

谢谢。

# php - mongodb 嵌入式更新对象

> ID：15207746
> 
> 赞同：0
> 
> 时间：2013-03-04T17:49:18.063
> 
> 标签：php, mongodb

我有这个结构：

```
{
 "_id": NumberInt(101),
 "link_id": {
 "125": {
   "thumb_position": NumberInt(1),
   "last_scan": NumberInt(1234563645),
   "row_numb": NumberInt(301),
   "clicks": NumberInt(120)
   },
 "126": {
   "thumb_position": NumberInt(2),
   "last_scan": NumberInt(-2147483648),
   "row_numb": NumberInt(1301),
   "clicks": NumberInt(199)
     },
    {
    ...
    }
}
} 
```

我想用新的linkids更新文档并得到：

```
{
"_id": NumberInt(101),
"link_id": {
  "125": {
   "thumb_position": NumberInt(1),
   "last_scan": NumberInt(1234563645),
   "row_numb": NumberInt(301),
   "clicks": NumberInt(120)
},
 "126": {
   "thumb_position": NumberInt(2),
   "last_scan": NumberInt(-2147483648),
   "row_numb": NumberInt(1301),
   "clicks": NumberInt(199)
},
 "127": {
   "thumb_position": NumberInt(1),
   "last_scan": NumberInt(-2147483628),
   "row_numb": NumberInt(1304),
   "clicks": NumberInt(195)
}
} 
```

我在php中尝试过：

```
$value = array (
'130' => 
array (
  'thumb_position' => 1,
  'last_scan' => 1234563640,
  'row_numb' => 300,
  'clicks' => 120,
));
$update_status = $collection->update( array('_id'=>intval(101)), array('$set' => array('link_id' => $value)) , array("upsert"=>true ,"multiple"=> true , "safe"=> true) ); 
```

但这只是用这个 130 覆盖 link_ids。

嵌入式方法......因为这不是一个数组，而是对象，关于如何解决这个问题的任何想法？多谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:49:03.940

请尝试以下代码：

```
$value = array (
    'thumb_position' => 1,
    'last_scan' => 1234563640,
    'row_numb' => 300,
    'clicks' => 120,
);

$update_status = $collection->update(
    array('_id'=>intval(101)),
    array('$set' => array('link_id.130' => $value)),
    array("upsert"=>true ,"multiple"=> true , "safe"=> true)
); 
```

# sql - SQL Server +将选择语句中的值插入表中

> ID：15207747
> 
> 赞同：1
> 
> 时间：2013-03-04T17:49:19.783
> 
> 标签：sql

是否有可能做到这一点：

```
SELECT UserName FROM payroll p
INNER JOIN aspnet_Users u
ON (p.staffId= u.UserId)
WHERE jobId = '1011' 
```

例如，如果上面的选择返回 3 个结果：john001、mary002、peter003

如何使用它将单个结果插入到我的表（通知）列中？在这种情况下，只有 [Recipient] 列将具有不同的值，并且将是上述 Select 语句返回的结果。

```
INSERT INTO [Notification]
(
[Recipient], 
[Message],
[Type],
[DateCreated]
)
VALUES
(
-- The results from the select statement
'Testing Message'
'Type1,
GETUTCDATE()
) 
```

所以最终我应该在我的通知表中有这些列：

```
john001, Testing Message, Type1, 10/10/1945
mary002, Testing Message, Type1, 10/10/1945
peter003, Testing Message, Type1, 10/10/1945 
```

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:51:59.570

您将需要使用`INSERT INTO..SELECT..FROM`查询：

```
INSERT INTO [Notification]
(
    [Recipient], 
    [Message],
    [Type],
    [DateCreated]
)
SELECT UserName, 'Testing Message', 'Type1', GETUTCDATE()
FROM payroll p
INNER JOIN aspnet_Users u
    ON (p.staffId= u.UserId)
WHERE jobId = '1011' 
```

参考资料：

*   MSDN 文档[`INSERT`](http://msdn.microsoft.com/en-us/library/aa933206%28v=sql.80%29.aspx)
*   MSDN Docs -[使用 INSERT 和 SELECT 添加行](http://msdn.microsoft.com/en-us/library/ms188263%28v=sql.105%29.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:52:39.767

你可以做

```
INSERT INTO [Notification]
(
[Recipient], 
[Message],
[Type],
[DateCreated]
)
SELECT UserName, 
'Testing Message' 
'Type1,
GETUTCDATE()
FROM payroll p
INNER JOIN aspnet_Users u
ON (p.staffId= u.UserId)
WHERE jobId = '1011' 
```

> 您可以通过以下方式使用 INSERT 和 SELECT 语句向表中添加行：
> 
> 使用 INSERT 语句直接或从子查询中指定值。
> 
> 使用带有 INTO 子句的 SELECT 语句。

[http://msdn.microsoft.com/en-us/library/ms188263(v=sql.105).aspx](http://msdn.microsoft.com/en-us/library/ms188263(v=sql.105).aspx)

附加参考：

[http://blog.sqlauthority.com/2007/08/15/sql-server-insert-data-from-one-table-to-another-table-insert-into-select-select-into-table/](http://blog.sqlauthority.com/2007/08/15/sql-server-insert-data-from-one-table-to-another-table-insert-into-select-select-into-table/)

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-04T17:55:47.930

```
INSERT INTO Notification
(
Recipient, 
Message,
Type,
DateCreated
)
SELECT UserName, 'Testing Messag', 'Type1', GETUTCDATE()
 FROM payroll p
 JOIN aspnet_Users u
  ON (p.staffId= u.UserId)
Where jobId = '1011' 
```

# php - 简单的 php 在 drupal 模板中定义

> ID：15207751
> 
> 赞同：1
> 
> 时间：2013-03-04T17:49:48.890
> 
> 标签：php, drupal, drupal-7

我几乎没有将 php 作为一种语言的经验，并且在生成 Drupal 主题时运行它有点问题。我需要的是执行一次函数，它将返回一个布尔值，然后在整个模板中使用该布尔值。

这是我到目前为止所拥有的：

`html.tpl.php`->

```
<?php 

   function testMobile(){
       return false;
   }

   define('isMobile', testMobile());

?>

...

<?php 
    if(!isMobile){
        echo '<h1>NOT MOBILE</h1>';
    }else{
        echo '<h1>IS MOBILE</h1>';
    }
?> 
```

`page.tpl.php`->

```
<?php 
   if(!isMobile){
       echo '<h1>IS DESKTOP</h1>';
   }else{
       echo '<h1>NOT DESKTOP</h1>';
   }
?> 
```

在drupal输出中我得到了这个->

```
NOT MOBILE

NOT DESKTOP 
```

连同此错误消息：

```
Notice: Use of undefined constant isMobile - assumed 'isMobile' in include() (line 77 of /Users/#/#/#/sites/all/themes/#/templates/page.tpl.php). 
```

我在这里做错了什么？我怎样才能最容易地实现我的目标？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:04:20.680

似乎定义的变量超出了模板文件的范围。您可以通过使用会话变量来简单地解决这个问题。

下面是一个代码示例...

```
session_start(); // not necessary with drupal
$_SESSION['isMobile'] = testMobile();

function testMobile(){
   return false;
} 
```

在您的模板中，您可以添加以下...

```
<?php 
   if(!$_SESSION['isMobile']){
       echo '<h1>IS DESKTOP</h1>';
   }else{
       echo '<h1>NOT DESKTOP</h1>';
   }
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-05T11:27:22.257

尝试在`template.php`in 中定义变量`hook_theme_preprocess_page(&$vars, $hook)`。

所以`template.php`看起来可以这样：

```
function testMobile(){
  return false;
}

function YOURTHEME_theme_preprocess_page(&$vars, $hook) {
  $vars['isMobile'] = testMobile();
} 
```

和`page.tpl.php`

```
<?php 
   if(!$isMobile){
       echo '<h1>IS DESKTOP</h1>';
   }else{
       echo '<h1>NOT DESKTOP</h1>';
   }
?> 
```

# linux - 无法在 ec2 实例开发服务器上访问 django 网站

> ID：15207761
> 
> 赞同：1
> 
> 时间：2013-03-04T17:50:07.453
> 
> 标签：linux, django, ubuntu, amazon-ec2

这是我尝试运行我的开发服务器的方法（我已经尝试过使用和不使用 sudo，只是为了确保）：

```
python manage.py runserver ec2-##-##-###-##.compute-1.amazonaws.com:8000 
```

这是我的 iptables 清单：

```
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     tcp  --  anywhere             anywhere             tcp dpt:8000

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
ACCEPT     tcp  --  anywhere             anywhere             state ESTABLISHED 
```

这是我尝试在浏览器中调用它的方法：ec2-##-##-###-##.compute-1.amazonaws.com:8000/

知道怎么了？我正在使用 Ubuntu 微型实例。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:00:42.767

EC2 使用存在于实例外部的称为安全组的防火墙系统。需要在安全组中打开端口才能从外部访问它们。您可以通过 API 或使用 EC2 控制台更改规则。

# c - c pthreads + valgrind = 内存泄漏：为什么？

> ID：15207762
> 
> 赞同：6
> 
> 时间：2013-03-04T17:50:09.810
> 
> 标签：c, memory-leaks, pthreads, valgrind

我开始使用 C 语言中的 pthreads，而且我也是一个尽可能将我的代码写成“无错误”的狂热者。

尽管尝试格外小心，但 valgrind 告诉我，无论天气如何，我都在泄漏内存：

1.  我创建完成后加入的可连接线程（代码片段 1）
2.  我创建了在创建后分离的可连接线程（代码片段 2）
3.  我创建了分离线程（代码片段 3）

我知道这已经被讨论过（见[这个](https://stackoverflow.com/questions/13132890/leaking-memory-with-pthreads)、[这个](https://stackoverflow.com/questions/11123823/pthread-memory-leak-in-c-programming)和[这个](https://stackoverflow.com/questions/6412120/detached-pthread-create-leaks-memory)），但我仍然很好奇：

1.  为什么在某些运行中我最终没有错误？
2.  为什么在处理分离线程时似乎有一个随机数量的整体 mallocs()？<< nos 提供的答案，代码片段“已修复”，在 main() 中增加了延迟
3.  为什么即使在处理分离的线程时“内存泄漏”仍然存在？<< 同 2。

正如我从以前的答案和 valgrind 跟踪中了解到的那样，pthread_create() 是根本原因，它根据需要扩展线程使用的堆栈并有时重用它，因此缺少一些释放。但不太清楚的是为什么它取决于执行运行以及为什么在创建分离线程时也会发生这种情况。正如我从某些答案、评论以及该人所看到的那样，来自分离线程的资源将在线程完成后被释放。我已经尝试了各种调整来解决这个问题（在每个线程结束之前，在主线程结束之前添加一个睡眠时间，增加堆栈大小，添加更多“工作”......）但它并没有改变最终结果很多。另外，为什么在处理分离的线程时会有随机数量的整体“mallocs()”，valgrind 是否会丢失一些分离的线程？这似乎也不取决于堆栈大小。

提供的代码是经理/工作人员模型的模拟示例，对于该模型，线程管理的 joinable/join() 方法似乎更适合恕我直言。

感谢您提供的任何启发！我也希望这些（过度注释的）代码片段对希望开始使用 pthreads 的人有所帮助。

- 交换

PS 系统信息：debian 64 位架构上的 gcc

**代码片段 1**（加入的可连接线程）：

```
/* Running this multiple times with valgrind, I sometimes end with :
    - no errors (proper malloc/free balance) 
    - 4 extra malloc vs free (most frequently) 
   The number of mallocs() is more conservative and depends on the number of threads. 
*/

#include <stdlib.h>             /* EXIT_FAILURE, EXIT_SUCCESS macros & the likes */
#include <stdio.h>              /* printf() & the likes */
#include <pthread.h>            /* test subject */

#define MAX_THREADS 100         /* Number of threads */
pthread_attr_t tattr;           /* Thread attribute */
pthread_t workers[MAX_THREADS]; /* All the threads spawned by the main() thread */

/* A mock container structure to pass arguments around */
struct args_for_job_t {
    int tid;
    int status;
};

/* The job each worker will perform upon creation */
void *job(void *arg)
{
    /* Cast arguments in a proper container */
    struct args_for_job_t *container;
    container = (struct args_for_job_t *)arg;

    /* A mock job */
    printf("[TID - %d]\n", container->tid);

    /* Properly exit with status code tid */
    pthread_exit((void *)(&container->status));
}

int main ()
{
    int return_code;                            /* Will hold return codes */
    void *return_status;                        /* Will hold return status */
    int tid;                                    /* Thread id */
    struct args_for_job_t args[MAX_THREADS];    /* For thread safeness */

    /* Initialize and set thread joinable attribute */
    pthread_attr_init(&tattr);
    pthread_attr_setdetachstate(&tattr, PTHREAD_CREATE_JOINABLE);

    /* Spawn detached threads */
    for (tid = 0; tid < MAX_THREADS; tid++)
    {
        args[tid].tid = tid;
        args[tid].status = tid;
        return_code = pthread_create(&workers[tid], &tattr, job, (void *)(&args[tid]));
        if (return_code != 0) { printf("[ERROR] Thread creation failed\n"); return EXIT_FAILURE; }
    }

    /* Free thread attribute */
    pthread_attr_destroy(&tattr);

    /* Properly join() all workers before completion */
    for(tid = 0; tid < MAX_THREADS; tid++)
    {
        return_code = pthread_join(workers[tid], &return_status);
        if (return_code != 0)
        {
            printf("[ERROR] Return code from pthread_join() is %d\n", return_code);
            return EXIT_FAILURE;
        }
        printf("Thread %d joined with return status %d\n", tid, *(int *)return_status);
    }

    return EXIT_SUCCESS;
} 
```

**代码片段 2**（创建后分离的线程）：

```
/* Running this multiple times with valgrind, I sometimes end with :
    - no errors (proper malloc/free balance) 
    - 1 extra malloc vs free (most frequently) 
   Most surprisingly, it seems there is a random amount of overall mallocs 
*/

#include <stdlib.h>             /* EXIT_FAILURE, EXIT_SUCCESS macros & the likes */
#include <stdio.h>              /* printf() & the likes */
#include <pthread.h>            /* test subject */
#include <unistd.h>         

#define MAX_THREADS 100         /* Number of threads */
pthread_attr_t tattr;           /* Thread attribute */
pthread_t workers[MAX_THREADS]; /* All the threads spawned by the main() thread */

/* A mock container structure to pass arguments around */
struct args_for_job_t {
    int tid;
};

/* The job each worker will perform upon creation */
void *job(void *arg)
{
    /* Cast arguments in a proper container */
    struct args_for_job_t *container;
    container = (struct args_for_job_t *)arg;

    /* A mock job */
    printf("[TID - %d]\n", container->tid);

    /* For the sake of returning something, not necessary */
    return NULL;
}

int main ()
{
    int return_code;                            /* Will hold return codes */
    int tid;                                    /* Thread id */
    struct args_for_job_t args[MAX_THREADS];    /* For thread safeness */

    /* Initialize and set thread joinable attribute */
    pthread_attr_init(&tattr);
    pthread_attr_setdetachstate(&tattr, PTHREAD_CREATE_JOINABLE);

    /* Spawn detached threads */
    for (tid = 0; tid < MAX_THREADS; tid++)
    {
        args[tid].tid = tid;
        return_code = pthread_create(&workers[tid], &tattr, job, (void *)(&args[tid]));
        if (return_code != 0) { printf("[ERROR] Thread creation failed\n"); return EXIT_FAILURE; }
        /* Detach worker after creation */
        pthread_detach(workers[tid]);
    }

    /* Free thread attribute */
    pthread_attr_destroy(&tattr);

    /* Delay main() completion until all detached threads finish their jobs. */
    usleep(100000);
    return EXIT_SUCCESS;
} 
```

**代码片段 3**（创建时分离线程）：

```
/* Running this multiple times with valgrind, I sometimes end with :
    - no errors (proper malloc/free balance) 
    - 1 extra malloc vs free (most frequently) 
   Most surprisingly, it seems there is a random amount of overall mallocs 
*/

#include <stdlib.h>             /* EXIT_FAILURE, EXIT_SUCCESS macros & the likes */
#include <stdio.h>              /* printf() & the likes */
#include <pthread.h>            /* test subject */

#define MAX_THREADS 100         /* Number of threads */
pthread_attr_t tattr;           /* Thread attribute */
pthread_t workers[MAX_THREADS]; /* All the threads spawned by the main() thread */

/* A mock container structure to pass arguments around */
struct args_for_job_t {
    int tid;
};

/* The job each worker will perform upon creation */
void *job(void *arg)
{
    /* Cast arguments in a proper container */
    struct args_for_job_t *container;
    container = (struct args_for_job_t *)arg;

    /* A mock job */
    printf("[TID - %d]\n", container->tid);

    /* For the sake of returning something, not necessary */
    return NULL;
}

int main ()
{
    int return_code;                            /* Will hold return codes */
    int tid;                                    /* Thread id */
    struct args_for_job_t args[MAX_THREADS];    /* For thread safeness */

    /* Initialize and set thread detached attribute */
    pthread_attr_init(&tattr);
    pthread_attr_setdetachstate(&tattr, PTHREAD_CREATE_DETACHED);

    /* Spawn detached threads */
    for (tid = 0; tid < MAX_THREADS; tid++)
    {
        args[tid].tid = tid;
        return_code = pthread_create(&workers[tid], &tattr, job, (void *)(&args[tid]));
        if (return_code != 0) { printf("[ERROR] Thread creation failed\n"); return EXIT_FAILURE; }
    }

    /* Free thread attribute */
    pthread_attr_destroy(&tattr);

    /* Delay main() completion until all detached threads finish their jobs. */
    usleep(100000);
    return EXIT_SUCCESS;
} 
```

代码片段 1 的 Valgrind 输出（已加入线程和内存泄漏）

```
==27802== 
==27802== HEAP SUMMARY:
==27802==     in use at exit: 1,558 bytes in 4 blocks
==27802==   total heap usage: 105 allocs, 101 frees, 28,814 bytes allocated
==27802== 
==27802== Searching for pointers to 4 not-freed blocks
==27802== Checked 104,360 bytes
==27802== 
==27802== 36 bytes in 1 blocks are still reachable in loss record 1 of 4
==27802==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==27802==    by 0x400894D: _dl_map_object (dl-load.c:162)
==27802==    by 0x401384A: dl_open_worker (dl-open.c:225)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x4013319: _dl_open (dl-open.c:639)
==27802==    by 0x517F601: do_dlopen (dl-libc.c:89)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x517F6C3: __libc_dlopen_mode (dl-libc.c:48)
==27802==    by 0x4E423BB: pthread_cancel_init (unwind-forcedunwind.c:53)
==27802==    by 0x4E4257B: _Unwind_ForcedUnwind (unwind-forcedunwind.c:130)
==27802==    by 0x4E4069F: __pthread_unwind (unwind.c:130)
==27802==    by 0x4E3AFF4: pthread_exit (pthreadP.h:265)
==27802== 
==27802== 36 bytes in 1 blocks are still reachable in loss record 2 of 4
==27802==    at 0x4C2B6CD: malloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==27802==    by 0x400B7EC: _dl_new_object (dl-object.c:161)
==27802==    by 0x4006805: _dl_map_object_from_fd (dl-load.c:1051)
==27802==    by 0x4008699: _dl_map_object (dl-load.c:2568)
==27802==    by 0x401384A: dl_open_worker (dl-open.c:225)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x4013319: _dl_open (dl-open.c:639)
==27802==    by 0x517F601: do_dlopen (dl-libc.c:89)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x517F6C3: __libc_dlopen_mode (dl-libc.c:48)
==27802==    by 0x4E423BB: pthread_cancel_init (unwind-forcedunwind.c:53)
==27802==    by 0x4E4257B: _Unwind_ForcedUnwind (unwind-forcedunwind.c:130)
==27802== 
==27802== 312 bytes in 1 blocks are still reachable in loss record 3 of 4
==27802==    at 0x4C29DB4: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==27802==    by 0x4010B59: _dl_check_map_versions (dl-version.c:300)
==27802==    by 0x4013E1F: dl_open_worker (dl-open.c:268)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x4013319: _dl_open (dl-open.c:639)
==27802==    by 0x517F601: do_dlopen (dl-libc.c:89)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x517F6C3: __libc_dlopen_mode (dl-libc.c:48)
==27802==    by 0x4E423BB: pthread_cancel_init (unwind-forcedunwind.c:53)
==27802==    by 0x4E4257B: _Unwind_ForcedUnwind (unwind-forcedunwind.c:130)
==27802==    by 0x4E4069F: __pthread_unwind (unwind.c:130)
==27802==    by 0x4E3AFF4: pthread_exit (pthreadP.h:265)
==27802== 
==27802== 1,174 bytes in 1 blocks are still reachable in loss record 4 of 4
==27802==    at 0x4C29DB4: calloc (in /usr/lib/valgrind/vgpreload_memcheck-amd64-linux.so)
==27802==    by 0x400B57D: _dl_new_object (dl-object.c:77)
==27802==    by 0x4006805: _dl_map_object_from_fd (dl-load.c:1051)
==27802==    by 0x4008699: _dl_map_object (dl-load.c:2568)
==27802==    by 0x401384A: dl_open_worker (dl-open.c:225)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x4013319: _dl_open (dl-open.c:639)
==27802==    by 0x517F601: do_dlopen (dl-libc.c:89)
==27802==    by 0x400F175: _dl_catch_error (dl-error.c:178)
==27802==    by 0x517F6C3: __libc_dlopen_mode (dl-libc.c:48)
==27802==    by 0x4E423BB: pthread_cancel_init (unwind-forcedunwind.c:53)
==27802==    by 0x4E4257B: _Unwind_ForcedUnwind (unwind-forcedunwind.c:130)
==27802== 
==27802== LEAK SUMMARY:
==27802==    definitely lost: 0 bytes in 0 blocks
==27802==    indirectly lost: 0 bytes in 0 blocks
==27802==      possibly lost: 0 bytes in 0 blocks
==27802==    still reachable: 1,558 bytes in 4 blocks
==27802==         suppressed: 0 bytes in 0 blocks
==27802== 
==27802== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
--27802-- 
--27802-- used_suppression:      2 dl-hack3-cond-1
==27802== 
==27802== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2) 
```

代码片段 1 的 Valgrind 输出（没有内存泄漏，稍后运行几次）

```
--29170-- Discarding syms at 0x64168d0-0x6426198 in /lib/x86_64-linux-gnu/libgcc_s.so.1 due to munmap()
==29170== 
==29170== HEAP SUMMARY:
==29170==     in use at exit: 0 bytes in 0 blocks
==29170==   total heap usage: 105 allocs, 105 frees, 28,814 bytes allocated
==29170== 
==29170== All heap blocks were freed -- no leaks are possible
==29170== 
==29170== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2)
--29170-- 
--29170-- used_suppression:      2 dl-hack3-cond-1
==29170== 
==29170== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 2 from 2) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-04T18:02:42.237

当您的线程被分离时，您有一个错误，导致未定义的行为。

在 main 中，您有这行代码：

```
struct args_for_job_t args[MAX_THREADS]; 
```

您将指针指向您的工作线程。

然后 main() 到达这部分

```
pthread_exit(NULL); 
```

并且 main() 不再存在，但您周围仍然可能有工作线程，它访问 main() 堆栈上的上述`args`数组 - 不再存在。您的工作线程可能在 main() 在某些运行中结束之前全部完成，但在其他运行中不会。

# javascript - 如何使用当前数据提交 jQuery 表单的克隆？

> ID：15207764
> 
> 赞同：1
> 
> 时间：2013-03-04T17:50:28.217
> 
> 标签：javascript, jquery, ajax

我需要动态创建和提交 HTML 表单。

我将许多表单加入到一个 AJAX 请求中，因此我将它们克隆并通过 jQuery 发送。链接中的代码显示了不工作的部分。问题是 jQuery 发送的是原始 HTML 代码，而不是生成/用户更改代码。

我错了什么？ [http://ajax.dev.brown.sk/test1.html](http://ajax.dev.brown.sk/test1.html)

整个例子：

```
<html>
    <head>
        <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.js"></script>
        <script>
        $(document).ready(function(){
            $("form").submit(function(){

                // copy inputs and take it to form element
                $clone = $(this).clone(true,true);

                // display the code to below
                $("pre:first").text($clone[0].outerHTML);

                // ajax form submit
                $.post("/post.php", $clone.serialize(), function(data){
                    // data contains output of <?php print_r($_POST) ?>
                    $("pre:last").text(data);
                });

                return false;
            });
        });
        </script>
    </head>

    <body>

        <form>
            <select name="select">
                <option value="a">aaa</option>
                <option value="b" selected="selected">bbb</option>
                <option value="c">ccc</option>
            </select>
            <input type="submit" />
        </form>

        <hr />
        <pre></pre>

        <hr />
        <pre></pre>

    </body>
</html> 
```

**编辑：**

我认为问题在于克隆形式的序列化。检查这个例子：

```
<html>
    <head>
        <script type="text/javascript" src="//code.jquery.com/jquery-1.9.1.js"></script>
        <script>
        $(document).ready(function(){
            $("form").submit(function(){

                // copy inputs and take it to form element
                $clone = $(this).clone();

                // display the serialized values below
                $("pre").text($clone.serialize());

                return false;
            });
        });
        </script>
    </head>

    <body>

        <form>
            <select name="select">
                <option value="a">aaa</option>
                <option value="b" selected="selected">bbb</option>
                <option value="c">ccc</option>
            </select>
            <input type="submit" />
        </form>

        <pre></pre>

    </body>
</html> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T17:54:53.383

您需要让它响应**委托**，因为它不是**初始 DOM**

```
$(document).ready(function(){
            $("form").on('submit',function(){

                // copy inputs and take it to form element
                $clone = $(this).clone(true,true);

                // display the code to below
                $("pre:first").append($clone[0].outerHTML);

                // ajax form submit
                $.post("/post.php", $clone.serialize(), function(data){
                    $("pre:last").append(data);
                });

                return false;
            });
        }); 
```

**编辑**

你只得到outerHTML，你需要一切

```
$(document).ready(function(){
            $("form").on('submit',function(){

                // copy inputs and take it to form element
                $clone = $(this).clone(true,true);

                // display the code to below
                $("pre:first").append($clone);

                // ajax form submit
                $.post("/post.php", $clone.serialize(), function(data){
                    $("pre:last").append(data);
                });

                return false;
            });
        }); 
```

我希望这可以帮助:)

# java - 如何摆脱 em.persist();

> ID：15207765
> 
> 赞同：0
> 
> 时间：2013-03-04T17:50:28.583
> 
> 标签：java, hibernate, spring-transactions

我不再喜欢写 em.persist() 了。我可以在返回新实例时执行此操作吗？

嗯，也许 id 与 grails-domains 混淆了。

例如，我有一个 AppConfig.java：

```
package spring;
import org.springframework.context.annotation.*;
import org.springframework.orm.jpa.*;
import org.springframework.transaction.PlatformTransactionManager;
import org.springframework.transaction.annotation.*;

@Configuration
@EnableAspectJAutoProxy
@EnableTransactionManagement
public class AppConfig implements TransactionManagementConfigurer {

    @Bean
    public LocalEntityManagerFactoryBean entityManagerFactory() {
        LocalEntityManagerFactoryBean bean = new LocalEntityManagerFactoryBean();
        bean.setPersistenceUnitName("persistenceUnit");
        return bean;
    }

    @Bean
    @Scope("session")
    public Test test() {
        return new Test();
    }

    @Bean
    public JpaTransactionManager txManager() {
        return new JpaTransactionManager();
    }

    public PlatformTransactionManager annotationDrivenTransactionManager() {
        return txManager();
    }
} 
```

和一个实体用户

```
package spring;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity @Table(name = "User")
public class User {
    private long id;
    @Id
    @GeneratedValue
    public long getId() { return id; }
    public void setId(long id) { this.id = id; }

    private String name;
    @Column
    public void setName(String name) { this.name = name; }
    public String getName() { return name; }

} 
```

一个persistence.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<persistence xmlns="http://java.sun.com/xml/ns/persistence" version="2.0">
    <persistence-unit name="persistenceUnit">
        <properties>
            <property name="hibernate.ejb.cfgfile" value="/META-INF/hibernate.cfg.xml" />
        </properties>
    </persistence-unit>
</persistence> 
```

和一个hibernate.cfg.xml

```
 <?xml version="1.0" encoding="utf-8"?>
    <!DOCTYPE hibernate-configuration PUBLIC
    "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
    "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
    <hibernate-configuration>
        <session-factory name="sessionFactory">
            <property name="hibernate.hbm2ddl.auto">false</property>
            <property name="hibernate.connection.driver_class">org.hsqldb.jdbcDriver</property>
            <property name="hibernate.connection.password"></property>
            <property name="hibernate.hbm2ddl.auto">create-drop</property>
            <property name="hibernate.connection.url">jdbc:hsqldb:mem:jamsession</property>
            <property name="hibernate.connection.username">sa</property>
            <property name="hibernate.dialect">org.hibernate.dialect.HSQLDialect</property>
            <property name="hibernate.search.autoregister_listeners">false</property>
            <property name="hibernate.show_sql">true</property>
            <property name="hibernate.format_sql">false</property>
            <mapping class="spring.User" />
        </session-factory>
    </hibernate-configuration> 
```

一个名为 Test 的控制器：

```
package spring;

import java.util.List;

import javax.persistence.EntityManager;
import javax.persistence.PersistenceContext;

import org.springframework.stereotype.Controller;
import org.springframework.transaction.annotation.Transactional;

@Controller
public class Test {
    @PersistenceContext
    transient EntityManager em;

    @Transactional
    public User newUser(String name) {
        User user = new User();
        user.setName(name);
        // em.persist(user);
        return user;
    }

    public List<User> getUsers() {
        return em.createQuery("from User").getResultList();
    }
} 
```

最后但同样重要的是，这个 index.jsp：

```
<%@page import="spring.User"%>
<%@page import="spring.Test"%>
<%@page import="org.springframework.web.context.WebApplicationContext"%>
<%@page import="org.springframework.web.context.support.WebApplicationContextUtils"%>
<%
    WebApplicationContext wac = WebApplicationContextUtils.getWebApplicationContext(getServletContext());
    Object o = wac.getBean("appConfig");
    Test test = (Test) wac.getBean("test");
    if (request.getParameter("insert") != null) {
        test.newUser(request.getParameter("name"));
    }
%>
<ol>
<% for (User u : test.getUsers()) {
     out.print("<li>"+u.getName()+"</li>");
   } %>
</ol>

<form method="post">
  <input type="text" name="name" value="unnamed" />
  <input type="submit" value="Insert" name="insert" />
</form> 
```

要使用插入按钮保存新用户，我需要 em.persist(user);！我怎样才能摆脱 em.persist？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:05:44.267

你可以摆脱`em.persist`使用`AOP`:)你可以自己做一个注释，在函数被执行后做`em.persist()`它返回的任何事情:)..

你可以 ：

1.  在java ee的情况下编写一个拦截器......
2.  如果您使用 spring，请使用[aspectj或 AOP](http://en.wikipedia.org/wiki/AspectJ)
3.  使用 some `DAO`s 来操作对象

如果您正在使用 Spring 使用 AOP 会容易得多......只需用谷歌搜索 AOP 并发明你想要的任何东西......

你也可以使用`spring-data`...给你很多东西...只需编写一个接口就完成了...`spring-data`将实现您的接口...

在这里你可以看到一个`spring-data`项目

1.  [弹簧数据 JPA](https://github.com/SpringSource/spring-data-jpa-examples)
2.  [将由 spring 实现的接口（使用 AOP）](https://github.com/SpringSource/spring-data-jpa-examples/blob/master/spring-data-jpa-example/src/main/java/org/springframework/data/jpa/example/repository/UserRepository.java)

PS：这不是一个玩笑...您不必为该接口编写任何实现...您只需要使用“ `save()`，`findUserByName(String name)`”等命名约定...

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T20:06:42.073

您可以做到这一点的一种方法是使用来自根对象的[级联。](http://en.wikibooks.org/wiki/Java_Persistence/Relationships#Cascading)在您的情况下，也许`User`s 属于 a `Department`。您可以将该类`@OneToMany`映射到`User`，标记为`CascadeType.ALL`：

```
@Entity
public class Department {
    @OneToMany(mappedBy = "department", cascade = CascadeType.ALL)
    private Set<User> users;
} 
```

然后要创建一个用户，您将创建它并将其添加到`Department`：

```
Department d = em.find(Department.class, "Coinage");
User u = new User("Felix Schlag");
d.addUser(u); 
```

提交封闭事务时，`Department`将保存现有但已修改的事务，并且保存的内容也将级联到新事务`User`。

如果没有`User`像 a 这样的自然聚合`Department`，您可以为所有用户创建一个主根对象。或者，您可以将用户分类为类型（管理员、客户、作者等），并`UserType`为每个类型创建一个实例，其中包含该类型的所有用户的集合。

最后我应该说，虽然这种方法在技术上是可行的，但我认为这通常不是一个好主意。我会担心遇到与多个线程同时更新根对象的集合相关的问题（这可能表现为事务提交失败），或者将这些巨大的集合加载到内存中（这不应该是必要的，但无论如何都可能发生） ）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-03-05T07:28:45.310

是的你可以。此外，您还可以：

*   用更少的代码完成相同的功能
*   用更简单的代码完成相同的功能
*   使用更易于阅读的代码完成相同的功能
*   使用更易于理解的代码完成相同的功能
*   更有效率
*   减少耦合（这使您的代码维护成本更低）

您可以通过使用 GORM 而不是 CMP 来获得所有这些。请注意，这只是一种观点。

对此没有行业共识，也没有更普遍的 Spring 持久性与 CMP 辩论。因此，这应该由您的组织彻底讨论。

理想情况下，应该以客观的方式记录利弊，并通过现实世界的证据进行权衡。只有这样，您的组织才能做出明智的决定，并且您应该坚持这样做。

不幸的是，有些人有“坚定的信念”（也就是强烈的意见），他们偏爱一个。恕我直言，更好的建筑师正在等待基于证据的结果。

意见本质上是基于收集、解释和基于时间的信息（意思是意见会随着时间的推移而变化，因为收集到更多信息并提高理解。）这是 IT 中的一个常见问题（恕我直言），决策是基于少看证据，多看最有影响力的人的意见。

我观察到许多人将意见与事实混为一谈。

一些 IT 领导者（例如 Venkat Subramaniam）警告不要过度使用注释，因为它们会将您的代码与特定的实现相结合。您的代码使用了大量注释。

Spring 框架的好处之一是大多数类都没有对 Spring 的引用，并且是完全解耦的。业界普遍认为，去耦可以降低维护成本。

Spring 将配置从代码移动到外部 (XML) 配置文件。这被广泛认为是应用程序架构发展中的积极一步。

Grails 和 Ruby on Rails 框架迈出了下一步，通过“约定优于配置”消除了大部分配置文件。

查看代码片段的一种方法是将它们还原为两代，成为紧密耦合的解决方案（具有讽刺意味的是，为了利用“新”技术。）

同样，这只是一种观点。但我发现，在实践中，很少有组织会客观地权衡利弊。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T19:02:43.050

如果您想使用休眠将用户域对象存储在数据库中 - 您只需**调用`em.persist(user)`某处**。将持久性操作包装在*数据访问层*中被认为是一种很好的做法。数据访问层用于`EntityManager`执行常见的持久性操作，如保存、查找、删除、列表、计数......）并使用`EntityManager`. 上面的数据访问层应该是提供与您的应用程序相关的业务方法的*事务服务层*，例如`UserService`与方法`createUserAccount`- 服务层调用数据访问层来执行基本操作（例如在事务中保存用户并为他分配一些安全角色）。最后，应用程序中的控制器应该只与服务层通信——这样你就可以从低级 ORM API 中抽象出来。

# c# - 如何在画布中移动图像而不使其绑定到它所属的外部网格？

> ID：15207769
> 
> 赞同：1
> 
> 时间：2013-03-04T17:50:39.613
> 
> 标签：c#, wpf, image, canvas, grid

我想在我正在制作的基于图块的游戏中将图像放在某个图块的顶部。问题是，当我生成随机地图时，当绘制 Canvas 的 Rectangle 子项时，它会在 Image 上绘制。我通过将图像作为窗口外部网格的一部分解决了这个问题。问题是当我想将图像放置在画布内的某个矩形上时，坐标关闭，因为网格大于画布。如何将图像边距限制为仅画布的边距（画布边界作为限制）而不是网格边界作为限制？

例如，为图像赋予 Margin.Left = 50 的值会将其放置在画布中的最佳位置，但由于其比例较大，它将被放置在网格中的不同位置。

```
// Image displays, but does not display when I add child Rectangles to the Canvas
<Canvas Height="700" HorizontalAlignment="Left" Name="canvas1" VerticalAlignment="Top" Width="700">
        <Image Name="heroImage" Stretch="Fill" Source="hero.png" Height="74" Canvas.Left="558" Canvas.Top="602" />
</Canvas>

<Grid>
    <Canvas Height="700" HorizontalAlignment="Left" Name="canvas1" VerticalAlignment="Top" Width="700">
        // Removed the Image
    </Canvas>

    // Placed the Image outside the Canvas, but now it will draw according to the Grid's Margin limits and not the Canvas Margin limits
    <Image Name="heroImage" Stretch="Fill" Source="hero.png" Height="74" Canvas.Left="558" Canvas.Top="602" />
</Grid> 
```

![画布内的图像位置](../Images/7cb6e46f2a332532175f061dc45b1bf5.png) 画布内的图像，完美定位

![网格中画布外的图像位置](../Images/bafcd018e44597607a01e08ef6851d53.png) 网格中的图像，由于我使用 Canvas Margin 坐标而放置错误

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:25:58.780

我认为您可以在 Canvas 内使用您的图像，如果您希望图像在 Rectangle 上，则需要将图像的（Palen.ZIndex 或 Canvas.ZIndex）属性设置为大于 Rectangles 之一。例如：

```
<Canvas Height="700" HorizontalAlignment="Left" Name="canvas1" VerticalAlignment="Top" Width="700">
        <Image Name="heroImage" Stretch="Fill" Source="hero.png" Height="74" Canvas.Left="558" Canvas.Top="602" Canvas.ZIndex="1000" />
        <Rectangle x:Name="Some Rectangle" Canvas.ZIndex="1"/>
</Canvas> 
```

图像将显示在矩形上。我认为这是解决方案。将图像放在画布上，因为要设置您想要的确切位置将非常复杂。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T19:20:28.133

你做的第一种方式很好，你的形象应该是你的 Canvas 的孩子来做 Canvas.Left...

为了解决您的问题，您可以使用 ZIndex 将您的图像放在所有其他矩形的顶部吗？

```
Canvas.ZIndex="3 or whatever" 
```

值为 2 的图像被绘制在值为 1 的矩形上。所以你可以输入一个高数字......

# visual-studio-2012 - 从 Visual Studio SDK 解决方案中的所有（已关闭）文件中获取代码

> ID：15207772
> 
> 赞同：1
> 
> 时间：2013-03-04T17:50:55.840
> 
> 标签：visual-studio-2012, visual-studio-extensions, visual-studio-sdk, projectitem

我正在尝试获取和编辑项目中所有 html 文件的代码

我找到了一种遍历所有 ProjectItems 的方法

```
IEnumerator Projects = _applicationObject.Solution.Projects.GetEnumerator();

while (Projects.MoveNext())
{
    IEnumerator Items = ((Project)Projects.Current).ProjectItems.GetEnumerator();
    Queue<ProjectItem> ProjectItems = new Queue<ProjectItem>();
    while (Items.MoveNext())
    {
        ProjectItem SubItem = (ProjectItem)Items.Current;
        try
        {
            if (SubItem.Document != null) DocumentIndex.Add(SubItem.Document);
        }
        catch (Exception Exception)
        {
            Console.WriteLine(Exception.Message);
            //ignore
        }
        ProjectItems.Enqueue(SubItem);
    }

    //follow the tree down
    while (ProjectItems.Count != 0)
    {
        ProjectItem ProjectItem = ProjectItems.Dequeue();
        if (ProjectItem.ProjectItems != null)
        {
            foreach (ProjectItem SubItem in ProjectItem.ProjectItems)
            {
                ProjectItems.Enqueue(SubItem);
                try
                {
                    try
                    {
                        SubItem.Open(SubItem.Kind);
                        DocumentIndex.Add(SubItem.Document);
                    }catch(Exception Ex){
                        Console.WriteLine(Ex.Message);
                    }
                }
                catch (Exception Exception)
                {
                    Console.WriteLine(Exception.Message);
                    //ignore
                }
            }
        }
    }
} 
```

现在我无法获取未在编辑器窗口中打开的文件的代码。

如何获取和编辑“未打开”项目项的代码？
如何检测文件是否为代码文件？（例如：.cs、.html、.htm、.asp、....

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2020-10-25T23:19:05.220

您必须打开要阅读或编辑的 ProjectItem

```
DTE dte = (DTE)Package.GetGlobalService(typeof(DTE));
var project = dte.Solution.Projects.Item(1);
var projectItems = project.ProjectItems;
var anyItem = projectItems.Item(0);
Window anyItemWindow = anyItem.open()
var selection = anyItem.Document.Selection as TextSelection;
selection.SelectAll();
Console.WriteLine(selection.Text) // All code
anyItem.Document.Close() //Close Document 
```

如果您不打开 ProjectItem`anyItem.Doument`为空。

注：`selection.Insert("")`可用于更改代码

# intellij-idea - 未安装 IntelliJ JDK

> ID：15207774
> 
> 赞同：0
> 
> 时间：2013-03-04T17:50:59.940
> 
> 标签：intellij-idea, java

我刚刚安装了 IntelliJ 并尝试导入一个 Eclipse 项目。我安装了 jre 但没有 jdk。它不想在没有 jdk 的情况下编译。我究竟做错了什么？我需要一个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:11:58.340

是的，你需要它。JRE 只需要运行 java 程序。JDK - 用于开发。

# ruby-on-rails-3 - 在 Rails 模型中获取资源的完整 URL 的最佳方法是什么？

> ID：15207777
> 
> 赞同：0
> 
> 时间：2013-03-04T17:51:10.183
> 
> 标签：ruby-on-rails-3

我在 Rails 模型中使用 as_json 来自定义从控制器访问的返回 json，如下所示：

```
def as_json(options={})
    {
      :id         => self.uuid,
      :href       => full_url_to_resource,
      :file       => self.file.url,
      :filename   => self.filename,
      :file_size  => self.file_size,
      :date       => self.created_at
    }
  end 
```

我想将资源的完整 url 作为 href 属性提供给客户端。我想知道是否有一种非硬编码的方式来做到这一点。

我已经在我的模型中包含了 Url Helpers

```
include Rails.application.routes.url_helpers 
```

这允许我这样做：

```
:href => url_for_file(:host => "example.com") + '/files/' + self.uuid, 
```

这很好用，但我显然不想对 url 进行硬编码。Rails 中是否有基于当前访问的 URL 或 default_url_options 中定义的 url 的内置方法？

还是我应该创建一个助手来代替？

# actionscript-3 - 使用 TweenMax 更改单个影片剪辑的帧速率

> ID：15207784
> 
> 赞同：0
> 
> 时间：2013-03-04T17:51:33.443
> 
> 标签：actionscript-3

我的目标是通过可点击的控件（慢/中/快）更改我的单个（循环）电影剪辑的帧速率。我听说仅通过 as3/flash 无法实现这一点，所以我尝试了 greensock 的 TweenMax ......但是我似乎无法弄清楚如何做到这一点。有没有人可以帮忙？

```
box1.addEventListener(MouseEvent.MOUSE_DOWN, box1down);
function box1down(event:MouseEvent):void {

//FRAMERATE CODE HERE

} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T20:07:34.313

这是 TweenMax 的 API 文档：http: [//www.greensock.com/as/docs/tween/com/greensock/TweenMax.html](http://www.greensock.com/as/docs/tween/com/greensock/TweenMax.html)

如果您有多个要控制的影片剪辑，您可以创建一个具有您想要的功能的抽象类并扩展该类。所以像：

```
public class ControlledMovieClip extends MovieClip {

    public function ControlledMovieClip() {
        stop();
    }

    public function animate(frameRateInSeconds:Number):void {            
        TweenMax.to(this, frameRateInSeconds, { frame: this.totalFrames - 1, repeat: -1, ease: Linear.easeNone });
    }
} 
```

让所有循环的影片剪辑扩展该类，然后您可以在`box1down`事件处理程序中的对象上调用 animate 函数。

我尚未测试该代码，因此您可能需要`gotoAndStop(1)`在每次迭代结束时使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:58:30.920

仅通过 Actionscript 就可以实现，它只需要您自己处理帧进程（而不是使用 mc.play() 来停止影片剪辑并自己调用 nextFrame()）。

假设一个 Movieclip (myMC) 有 20 帧动画。要以正常速度手动运行动画，您只需调用`myMC.nextFrame();`项目的每一帧（例如使用`ENTER_FRAME`侦听器）。

要让动画以半速运行，您可以使用帧数和帧触发器：

```
var frameTick = 0;
var frameAnimTrigger = 2;

function Update(e:Event):void
{
  frameTick++;
  if(frameTick == frameAnimTrigger)
  {
    myMC.nextFrame();
    frameTick = 0;
  }
} 
```

因为`nextFrame`仅每隔一帧调用一次，动画似乎以半速运行。

# events - ng-repeat 完成时调用函数

> ID：15207788
> 
> 赞同：249
> 
> 时间：2013-03-04T17:51:48.230
> 
> 标签：events, angularjs, handler, directive, ready

我想要实现的基本上是一个“on ng 重复完成渲染”处理程序。我能够检测到它何时完成，但我不知道如何从中触发功能。

检查小提琴：http: [//jsfiddle.net/paulocoelho/BsMqq/3/](http://jsfiddle.net/paulocoelho/BsMqq/3/)

JS

```
var module = angular.module('testApp', [])
    .directive('onFinishRender', function () {
    return {
        restrict: 'A',
        link: function (scope, element, attr) {
            if (scope.$last === true) {
                element.ready(function () {
                    console.log("calling:"+attr.onFinishRender);
                    // CALL TEST HERE!
                });
            }
        }
    }
});

function myC($scope) {
    $scope.ta = [1, 2, 3, 4, 5, 6];
    function test() {
        console.log("test executed");
    }
} 
```

HTML

```
<div ng-app="testApp" ng-controller="myC">
    <p ng-repeat="t in ta" on-finish-render="test()">{{t}}</p>
</div> 
```

**答案**：finishmove 的工作小提琴：http: [//jsfiddle.net/paulocoelho/BsMqq/4/](http://jsfiddle.net/paulocoelho/BsMqq/4/)

* * *

## 回答 #1

> 赞同：400
> 
> 时间：2013-03-04T18:23:51.913

```
var module = angular.module('testApp', [])
    .directive('onFinishRender', function ($timeout) {
    return {
        restrict: 'A',
        link: function (scope, element, attr) {
            if (scope.$last === true) {
                $timeout(function () {
                    scope.$emit(attr.onFinishRender);
                });
            }
        }
    }
}); 
```

请注意，我没有使用`.ready()`，而是将其包装在`$timeout`. `$timeout`确保在 ng-repeated 元素真正完成渲染`$timeout`时执行它（因为它将在当前摘要周期结束时执行——**它也会在`$apply`内部调用，不像`setTimeout`**）。因此，在`ng-repeat`完成之后，我们使用`$emit`向外部范围（兄弟范围和父范围）发出事件。

然后在您的控制器中，您可以使用以下命令捕获它`$on`：

```
$scope.$on('ngRepeatFinished', function(ngRepeatFinishedEvent) {
    //you also get the actual event object
    //do stuff, execute functions -- whatever...
}); 
```

使用看起来像这样的 html：

```
<div ng-repeat="item in items" on-finish-render="ngRepeatFinished">
    <div>{{item.name}}}<div>
</div> 
```

* * *

## 回答 #2

> 赞同：89
> 
> 时间：2013-03-04T19:19:09.407

如果您希望在构造 DOM 之后但在浏览器呈现之前执行回调（即 test()），请使用[$evalAsync 。](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24evalAsync)这将防止闪烁 -[参考](https://github.com/angular/angular.js/issues/734#issuecomment-3657272)。

```
if (scope.$last) {
   scope.$evalAsync(attr.onFinishRender);
} 
```

[小提琴](http://jsfiddle.net/mrajcok/W8nhv/)。

如果您真的想在渲染后调用回调，请使用 $timeout：

```
if (scope.$last) {
   $timeout(function() { 
      scope.$eval(attr.onFinishRender);
   });
} 
```

我更喜欢 $eval 而不是事件。对于一个事件，我们需要知道该事件的名称并将该事件的代码添加到我们的控制器中。使用 $eval，控制器和指令之间的耦合更少。

* * *

## 回答 #3

> 赞同：29
> 
> 时间：2014-09-29T03:04:14.137

**到目前为止给出的答案只会在第一次`ng-repeat`渲染**时起作用，但如果你有一个动态的`ng-repeat`，这意味着你将要添加/删除/过滤项目，并且每次需要通知你`ng-repeat`被渲染，这些解决方案对你不起作用。

所以，**如果你需要每次都被通知`ng-repeat`重新渲染**，而不仅仅是第一次，我已经找到了一种方法来做到这一点，这很“hacky”，但如果你知道你是什么，它会工作得很好正在做。`$filter`在你使用`ng-repeat` **任何其他之前使用它`$filter`**：

```
.filter('ngRepeatFinish', function($timeout){
    return function(data){
        var me = this;
        var flagProperty = '__finishedRendering__';
        if(!data[flagProperty]){
            Object.defineProperty(
                data, 
                flagProperty, 
                {enumerable:false, configurable:true, writable: false, value:{}});
            $timeout(function(){
                    delete data[flagProperty];                        
                    me.$emit('ngRepeatFinished');
                },0,false);                
        }
        return data;
    };
}) 
```

这将在每次渲染时`$emit`调用一个事件。`ngRepeatFinished``ng-repeat`

## 如何使用它：

```
<li ng-repeat="item in (items|ngRepeatFinish) | filter:{name:namedFiltered}" > 
```

`ngRepeatFinish`过滤器需要直接应用到您定义的一个`Array`或一个，之后您可以应用其他过滤器。`Object``$scope`

## 如何不使用它：

```
<li ng-repeat="item in (items | filter:{name:namedFiltered}) | ngRepeatFinish" > 
```

不要先应用其他过滤器，然后再应用`ngRepeatFinish`过滤器。

## 我什么时候应该使用这个？

如果您想在列表完成渲染后将某些 css 样式应用到 DOM 中，因为您需要考虑已被重新渲染的 DOM 元素的新尺寸`ng-repeat`。（顺便说一句：这类操作应该在指令内完成）

## `ngRepeatFinished`在处理事件的函数中不要做什么：

*   不要`$scope.$apply`在该函数中执行 a ，否则您会将 Angular 置于 Angular 无法检测到的无限循环中。

*   不要使用它来更改`$scope`属性，因为这些更改在下一个循环之前不会反映在您的视图中`$digest`，并且由于您无法执行`$scope.$apply`它们将没有任何用处。

## “但过滤器不应该那样使用！！”

不，他们不是，这是一个 hack，如果你不喜欢它就不要使用它。如果你知道更好的方法来完成同样的事情，请告诉我。

## 总结

> **这是一个 hack**，以错误的方式使用它是危险的，仅在`ng-repeat`完成渲染后使用它来应用样式，你不应该有任何问题。

* * *

## 回答 #4

> 赞同：10
> 
> 时间：2015-06-05T15:10:18.677

如果你需要在同一个控制器上为不同的 ng-repeats 调用不同的函数，你可以尝试这样的事情：

**指令：**

```
var module = angular.module('testApp', [])
    .directive('onFinishRender', function ($timeout) {
    return {
        restrict: 'A',
        link: function (scope, element, attr) {
            if (scope.$last === true) {
            $timeout(function () {
                scope.$emit(attr.broadcasteventname ? attr.broadcasteventname : 'ngRepeatFinished');
            });
            }
        }
    }
}); 
```

**在您的控制器中，使用 $on 捕获事件：**

```
$scope.$on('ngRepeatBroadcast1', function(ngRepeatFinishedEvent) {
// Do something
});

$scope.$on('ngRepeatBroadcast2', function(ngRepeatFinishedEvent) {
// Do something
}); 
```

**在具有多个 ng-repeat 的模板中**

```
<div ng-repeat="item in collection1" on-finish-render broadcasteventname="ngRepeatBroadcast1">
    <div>{{item.name}}}<div>
</div>

<div ng-repeat="item in collection2" on-finish-render broadcasteventname="ngRepeatBroadcast2">
    <div>{{item.name}}}<div>
</div> 
```

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2014-01-31T01:44:06.717

其他解决方案在初始页面加载时可以正常工作，但从控制器调用 $timeout 是确保在模型更改时调用函数的唯一方法。这是一个使用 $timeout的工作[小提琴。](http://jsfiddle.net/JohnHarley/W5z3Z/)对于您的示例，它将是：

```
.controller('myC', function ($scope, $timeout) {
$scope.$watch("ta", function (newValue, oldValue) {
    $timeout(function () {
       test();
    });
}); 
```

ngRepeat 只会在行内容是新的时评估指令，因此如果您从列表中删除项目，onFinishRender 将不会触发。例如，尝试在这些 fiddles 中输入过滤器值[emit](http://jsfiddle.net/JohnHarley/sEq7Y/)。

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-09-26T03:53:03.680

如果您不反对使用双美元范围道具并且您正在编写一个唯一内容是重复的指令，那么有一个非常简单的解决方案（假设您只关心初始渲染）。在链接函数中：

```
const dereg = scope.$watch('$$childTail.$last', last => {
    if (last) {
        dereg();
        // do yr stuff -- you may still need a $timeout here
    }
}); 
```

这对于您有一个指令需要根据渲染列表成员的宽度或高度执行 DOM 操作的情况很有用（我认为这是最有可能提出这个问题的原因），但它不是通用的作为已经提出的其他解决方案。

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2018-11-30T16:04:12.837

我很惊讶在这个问题的答案中没有看到最简单的解决方案。你想要做的是`ngInit`在你的重复元素（带有`ngRepeat`指令的元素）上添加一个指令，检查`$last`（一个在范围内设置的特殊变量`ngRepeat`，指示重复元素是列表中的最后一个）。如果`$last`是真的，我们正在渲染最后一个元素，我们可以调用我们想要的函数。

```
ng-init="$last && test()" 
```

您的 HTML 标记的完整代码是：

```
<div ng-app="testApp" ng-controller="myC">
    <p ng-repeat="t in ta" ng-init="$last && test()">{{t}}</p>
</div> 
```

除了要调用的范围函数（在本例中为 ）之外，您的应用程序中不需要任何额外的 JS 代码，`test`因为`ngInit`它由 Angular.js 提供。只需确保您的`test`函数在范围内，以便可以从模板访问它：

```
$scope.test = function test() {
    console.log("test executed");
} 
```

* * *

## 回答 #8

> 赞同：1
> 
> 时间：2015-04-22T08:57:13.523

使用过滤的 ngRepeat 解决此问题的方法可能是使用[Mutation](https://developer.mozilla.org/en-US/docs/Web/Guide/Events/Mutation_events)事件，但它们已被弃用（没有立即替换）。

然后我想到了另一个简单的方法：

```
app.directive('filtered',function($timeout) {
    return {
        restrict: 'A',link: function (scope,element,attr) {
            var elm = element[0]
                ,nodePrototype = Node.prototype
                ,timeout
                ,slice = Array.prototype.slice
            ;

            elm.insertBefore = alt.bind(null,nodePrototype.insertBefore);
            elm.removeChild = alt.bind(null,nodePrototype.removeChild);

            function alt(fn){
                fn.apply(elm,slice.call(arguments,1));
                timeout&&$timeout.cancel(timeout);
                timeout = $timeout(altDone);
            }

            function altDone(){
                timeout = null;
                console.log('Filtered! ...fire an event or something');
            }
        }
    };
}); 
```

这通过一键式 $timeout 挂钩到父元素的 Node.prototype 方法，以观察后续修改。

它的工作原理大部分是正确的，但我确实遇到了一些 altDone 会被调用两次的情况。

再次...将此指令添加到 ngRepeat 的*父*级。

* * *

## 回答 #9

> 赞同：1
> 
> 时间：2016-01-28T16:26:20.740

很简单，我就是这样做的。

```
.directive('blockOnRender', function ($blockUI) {
    return {
        restrict: 'A',
        link: function (scope, element, attrs) {

            if (scope.$first) {
                $blockUI.blockElement($(element).parent());
            }
            if (scope.$last) {
                $blockUI.unblockElement($(element).parent());
            }
        }
    };
})
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2013-03-04T18:10:18.467

请看一下小提琴，[http://jsfiddle.net/yNXS2/](http://jsfiddle.net/yNXS2/)。由于您创建的指令没有创建新的范围，我继续这样做。

`$scope.test = function(){...`做到了。

# iphone - Send multiple messages in Photoshop SDK

> ID：15207791
> 
> 赞同：3
> 
> 时间：2013-03-04T17:51:58.343
> 
> 标签：iphone, objective-c, networking, sdk, photoshop

I am using the Photoshop Connection SDK to get my iPad app connected to Photoshop.

*(The SDK with all sample iOS projects can be downloaded here if you want to look closer: [http://www.adobe.com/devnet/photoshop/sdk.html](http://www.adobe.com/devnet/photoshop/sdk.html))*

While I have it working, its hard for me to solve my issue as I don't entirely understand the networking between the iPad and Photoshop. So here is my issue:

```
NSString *s1 = [NSString stringWithUTF8String:"app.activeDocument.layers[0].name;"];
NSData *dataToSend = [s1 dataUsingEncoding:NSUTF8StringEncoding];
[self sendJavaScriptMessage:dataToSend];
artLayerName_transaction = transaction_id -1; 
```

There is a little snippet of code, to send a message asking for the name of layer at index 0\. That works great. However, let's say I try and send the same message straight after that but for index 1 as well.

Both messages are sent, but only one returns its string. The string is returned here:

```
- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)streamEvent; 
```

If you see the example projects its just the same, each message with its own transaction id as well. The method goes through a bunch of decrypting and things to receive that string and then reaches this:

```
NSString *string = [[NSString alloc] initWithBytes:received_data length:received_length encoding:NSUTF8StringEncoding];
if (content != 1)
{
     if (transaction == artLayerName_transaction)
         {
              [self processLayerName:string];
              needOutput = NO;
         }
} 
```

I've out the full method at the bottom for full analysing.

It checks that its receiving the specific message so I can then take the result (string, my layer name) and do what I like with it. However when I try and send more than one message with the same transaction id I only get one of the two results. In the code above, string gives me both my layer names, but the if statement is only called once.

Is there a known way around sending several messages at once? I have tried getting an array back rather than several strings without luck as well.

Apparently I need to modify the code to accept more then message. However I don't really understand the code well enough, so please also explain any of the principals behind it.

```
- (void)stream:(NSStream *)aStream handleEvent:(NSStreamEvent)streamEvent
{
    NSInputStream * istream;
    switch(streamEvent)
    {
        case NSStreamEventHasBytesAvailable:;

            UInt8 buffer[1024];
            unsigned int actuallyRead = 0;

            istream = (NSInputStream *)aStream;
            if (!dataBuffer)
            {
                dataBuffer = [[NSMutableData alloc] initWithCapacity:2048];
            }

            actuallyRead = [istream read:buffer maxLength:1024];

            [dataBuffer appendBytes:buffer length:actuallyRead];

            // see if we have enough to process, loop over messages in buffer
            while( YES )
            {

                // Did we read the header yet?
                if ( packetBodySize == -1 )
                {
                    // Do we have enough bytes in the buffer to read the header?
                    if ( [dataBuffer length] >= sizeof(int) ) {
                        // extract length
                        memcpy(&packetBodySize, [dataBuffer bytes], sizeof(int));
                        packetBodySize = ntohl( packetBodySize );       // size is in network byte order

                        // remove that chunk from buffer
                        NSRange rangeToDelete = {0, sizeof(int)};
                        [dataBuffer replaceBytesInRange:rangeToDelete withBytes:NULL length:0];
                    }
                    else {
                        // We don't have enough yet. Will wait for more data.
                        break;
                    }
                }

                // We should now have the header. Time to extract the body.
                if ( [dataBuffer length] >= ((NSUInteger) packetBodySize) )
                {
                    // We now have enough data to extract a meaningful packet.
                    const int kPrologLength = 16;
                    char *buffer = (char *)[dataBuffer bytes];

                    // if incoming message is color change, then don't display message
                    BOOL needOutput = YES;

                    // fetch the communication status
                    unsigned long com_status = *((unsigned long *)(buffer + 0));
                    com_status = ntohl( com_status );

                    // decrypt the message
                    size_t decryptedLength = (size_t) packetBodySize - 4;  // don't include com status

                    int skip_message = 0;

                    if (com_status == 0 && sCryptorRef)
                    {
                        PSCryptorStatus decryptResult = EncryptDecrypt (sCryptorRef, false, buffer+4, decryptedLength, buffer+4, decryptedLength, &decryptedLength);

                        if (kCryptorSuccess != decryptResult)
                        {
                            // failed to decrypt.  Ingore messageg and disconnect
                            skip_message = 1;
                            [self logMessage:@"ERROR:  Decryption failed.  Wrong password.\n" clearLine:NO];
                        }
                    }
                    else
                    {
                        if (com_status != 0)
                        [self logMessage:@"ERROR: Problem with communication, possible wrong password.\n" clearLine:NO];

                        if (!sCryptorRef)
                        [self logMessage:@"ERROR: Cryptor Ref is NULL, possible reason being that password was not supplied or password binding function failed.\n" clearLine:NO];
                    }

                    // Interpret encrypted section
                    if (!skip_message)
                    {
                        // version, 32 bit unsigned int, network byte order
                        unsigned long protocol_version = *((unsigned long *)(buffer + 4));
                        protocol_version = ntohl( protocol_version );

                        if (protocol_version != 1)
                        {
                            // either the message is corrupted or the protocol is newer.
                            [self logMessage:@"Incoming protocol version is different the expected. (or the message is corrupted.)  Not processing.\n" clearLine:NO];
                            skip_message = 1;
                        }

                        if (!skip_message)
                        {
                            // transaction, 32 bit unsigned int, network byte order
                            unsigned long transaction = *((unsigned long *)(buffer + 8));
                            transaction = ntohl( transaction );

                            // content type, 32 bit unsigned int, network byte order
                            unsigned long content = *((unsigned long *)(buffer + 12));
                            content = ntohl( content );

                            unsigned char *received_data = (unsigned char *)(buffer+kPrologLength);
                            int received_length = (decryptedLength-(kPrologLength-4));

                            if (content == 3) // image data
                            {
                                // process image data
                                unsigned char image_type = *((unsigned char *)received_data);
                                [self logMessage:@"Incoming data is IMAGE.  Skipping\n" clearLine:NO];

                                if (image_type == 1) // JPEG
                                {
                                    [self logMessage:@"By the way, incoming image is JPEG\n" clearLine:NO];
                                }
                                else if (image_type == 2) // Pixmap
                                {
                                    [self logMessage:@"By the way, incoming image is Pixmap\n" clearLine:NO];
                                }
                                else
                                {
                                    [self logMessage:@"Unknown image type\n" clearLine:NO];
                                }
                            }
                            else
                            {
                                // Set the response string
                                NSString *string = [[NSString alloc] initWithBytes:received_data length:received_length encoding:NSUTF8StringEncoding];

                                //NSLog(@"string: %@\n id:%li", string, transaction);

                                // see if this is a response we're looking for
                                if (content != 1)
                                {                                    
                                    if (transaction == foregroundColor_subscription || transaction == foregroundColor_transaction)
                                    {
                                        [self processForegroundChange:string];
                                        needOutput = NO;
                                    }
                                    if (transaction == backgroundColor_subscription || transaction == backgroundColor_transaction)
                                    {
                                        [self processBackgroundChange:string];
                                        needOutput = NO;
                                    }
                                    if (transaction == tool_transaction)
                                    {
                                        [self processToolChange:string];
                                        needOutput = NO;
                                    }
                                    if (transaction == artLayerName_transaction)
                                    {
                                        [self processLayerName:string];
                                        needOutput = NO;
                                    }
                                }
                                //Tells me about every event thats happened (spammy tech nonsence, no good for user log)
                                //if (needOutput) [self logMessage:string clearLine:NO];
                            }
                        }

                    }

                    // Remove that chunk from buffer
                    NSRange rangeToDelete = {0, packetBodySize};
                    [dataBuffer replaceBytesInRange:rangeToDelete withBytes:NULL length:0];

                    // We have processed the packet. Resetting the state.
                    packetBodySize = -1;
                }
                else
                {
                    // Not enough data yet. Will wait.
                    break;
                }
            }

            break;
        case NSStreamEventEndEncountered:;
            [self closeStreams];
            [self logMessage:[NSString stringWithFormat: @"%@ End encountered, closing stream.\n", outputMessage.text] clearLine:NO];
            break;
        case NSStreamEventHasSpaceAvailable:
        case NSStreamEventErrorOccurred:
        case NSStreamEventOpenCompleted:
        case NSStreamEventNone:
        default:
            break;
    }
} 
```

EDIT:

While this has worked, it has bumped me into another issue. I looked at the psconnection sample and saw what you were talking about, however I haven't been using the full framework but have it connect like in the other sample projects. I very simply increase my transaction id by 1 every time it comes to process a layer name such as in the code above.

Like this:

```
if (transaction == docName_transaction)
{
     docName_transaction++;
     [self processDocName:string];
} 
```

This works for the most part, however if I do this to another transaction id at the same time I get overlap. Meaning I end up processing the result for one id at the wrong time. Say I am getting both the total number of docs and the name of each one.

So I have two if statements like above, but I end up processing the total docs in both if statements and I can't see how to atop this overlap. Its fairly important to be able to receive multiple messages at once.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-09T14:32:23.853

I just downloaded samples, and as far as i can see, you should use unique transaction IDs for transactions that are waiting for response.

I mean if you send layer_name request with transactionID 1, you cannot use 1, until it's response is received.

So better case will be, store your transactionID's in a Dictionary (transactionID as key), and message type as value.

just like:

transactions[transaction_id] = @"layername";

and when you receive response:

use: transactions[transaction_id] to get the message type (ex: layername) behave according to this.

You can also put some other details to transactions dictionary (you can put a dictionary containing all information, which command, on which object, etc)

# python - 在两个 Python 列表中查找公共切片

> ID：15207794
> 
> 赞同：-6
> 
> 时间：2013-03-04T17:52:02.180
> 
> 标签：python, list, slice

我想在两个 Python 列表中找到常见的切片。

例如：

```
list1 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

list2 = [0, 0, 3, 4, 5, 0, 0, 8, 9, 0] 
```

应该返回两个列表： [3, 4, 5] 和 [8,9]

可以有任何数字或字符来代替 0。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:56:08.383

使用[`difflib.SequenceMatcher`](http://docs.python.org/2/library/difflib.html#sequencematcher-objects)：

```
>>> import difflib
>>> list1 = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
>>> list2 = [0, 0, 3, 4, 5, 0, 0, 8, 9, 0]
>>> matcher = difflib.SequenceMatcher(a=list1, b=list2)
>>> match = matcher.find_longest_match(0, len(list1), 0, len(list2))
>>> match
Match(a=2, b=2, size=3)
>>> print list1[match.a:match.a+match.size]
[3, 4, 5] 
```

`SequenceMatcher.find_longest_match()` 为其每个序列（alo、ahi、blo、bhi）获取开始和结束索引，因此在找到匹配项后，您可以调用`find_longest_match()`同一个`matcher`对象，但调整参数以便开始查看前一个匹配项。

您可以循环执行此操作，我会编写一个函数来执行此操作，如下所示：

```
import difflib
def common_slices(a, b):
    matcher = difflib.SequenceMatcher(a=a, b=b)
    sa, sb, size = matcher.find_longest_match(0, len(a), 0, len(b))
    while size != 0:
        if size > 1:
            yield a[sa:sa+size]
        sa, sb, size = matcher.find_longest_match(sa+size, len(a), sb+size, len(b))

>>> list(common_slices(list1, list2))
[[3, 4, 5], [8, 9]] 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T17:56:51.130

```
>>> from itertools import groupby
>>> from operator import itemgetter
>>> list1
[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
>>> list2
[0, 0, 3, 4, 5, 0, 0, 8, 9, 0]
>>> [[e[0] for e in v]
     for k,v in groupby(((a ,b, a==b)
             for a,b in zip(list1, list2)), itemgetter(2))
      if k]
[[3, 4, 5], [8, 9]] 
```

如果您不想按照@FJ 的建议使用 difflib，您应该以这种方式使用

```
>>> [list1[match.a: match.a + match.size]
     for match in SequenceMatcher(None,list1,list2).get_matching_blocks()[:-1]] 
```

但请记住，这将远低于之前的线性解决方案

# android - sqlite如何保证数据只插入一次

> ID：15207795
> 
> 赞同：0
> 
> 时间：2013-03-04T17:52:10.610
> 
> 标签：android, database, android-sqlite

我正在使用 a它以如下格式`web service`返回数据：`JSON`

```
{"content":[{"id":"1","asset_id":"62","title":"sample page","alias":"","introtext":"","fulltext":"Some Contents"},{"id":"2","asset_id":"62","title":"sample page2","alias":"","introtext":"","fulltext":"Some Contents"},{"id":"3","asset_id":"62","title":"sample page3","alias":"","introtext":"","fulltext":"Some Contents"}]} 
```

`onCreate()`是`MainActivity.java`：

```
boolean myFlag = false;

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);     
    textView = (TextView) findViewById(R.id.myView);

    setFlag = PreferenceManager.getDefaultSharedPreferences(MainActivity.this);

    dataSource = new ContentsDataSource(this);
    dataSource.open();
    parseAndIsertData();

} 
```

是`parseAndInsertData()`：

`EDIT`

```
private void parseAndIsertData() {
    // Creating JSON Parser instance
    MyJSONParser jParser = new MyJSONParser();

    contentDataObject = new ContentDataObject();        
    // getting JSON string from URL
    JSONObject json = jParser.getJSONFromUrl(BASE_URL); 

    try {
        // first time check if data is inserted
        editor = setFlag.edit();
        editor.putBoolean(MY_KEY, true);            

        // Getting Array of Contents
        jsonArray = json.getJSONArray(MOBILE_CONTENT);          
        // looping through All Contents

        if(!myFlag){            

            for(int i = 0; i < jsonArray.length(); i++){

                contentDataObject.setId(jsonArray.getJSONObject(i).getInt(MOBILE_CONTENT_ID));
                contentDataObject.setTitle(jsonArray.getJSONObject(i).getString(MOBILE_CONTENT_TITLE));
                contentDataObject.setFulltext(jsonArray.getJSONObject(i).getString(MOBILE_CONTENT_FULLTEXT));
                contentDataObject.setState(jsonArray.getJSONObject(i).getInt(MOBILE_CONTENT_STATE));
                contentDataObject.setNewValue(jsonArray.getJSONObject(i).getInt(MOBILE_CONTENT_NEW));
                contentDataObject.setHeader(jsonArray.getJSONObject(i).getString(MOBILE_CONTENT_HEADER));
                contentDataObject.setColor(jsonArray.getJSONObject(i).getInt(MOBILE_CONTENT_COLOR));
                contentDataObject.setNext(jsonArray.getJSONObject(i).getString(MOBILE_CONTENT_NEXT));
                contentDataObject.setPrevious(jsonArray.getJSONObject(i).getString(MOBILE_CONTENT_PREVIOUS));

                contentDataObject = dataSource.create(contentDataObject);

                Log.i(MY_TAGT, "Data Inserted " + contentDataObject.getId() + " Times");

            }

            myFlag = setFlag.getBoolean(MY_KEY, false);

        }

    } catch (JSONException e) {
        e.printStackTrace();
    }
}} 
```

现在我`logcat`的第一次发布是：

![在此处输入图像描述](../Images/f434a1990f9927f7b4e4fb0785d2734d.png)

当我重新启动应用程序时，我`logcat`是：

![在此处输入图像描述](../Images/da2759fd73e7a9806e6c74046f03dbe6.png)

现在我想问一下这种方法是否正确`YES`！那我以后就可以更新了！！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T09:22:16.447

1.  将表中的列定义为`primary key`或`unique`
2.  `SQLiteDatabase.insertWithOnConflict(...)`与`conflictAlgorithm`设置为“SQLiteDatabase.CONFLICT_IGNORE”的参数（最后一个）一起使用

看到[这个](http://developer.android.com/reference/android/database/sqlite/SQLiteDatabase.html#insertWithOnConflict%28java.lang.String,%20java.lang.String,%20android.content.ContentValues,%20int%29)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:04:40.007

您是正确的，此代码将多次插入数据。实现一个只允许一行的模式将取决于您。

您需要先查询数据源，如果数据存在则不插入数据，或者您需要从数据源中删除数据，然后每次插入。还有其他模式，但这两种将是最常见的。您选择哪一个将取决于数据是什么以及您希望它如何维护或更新。

# javascript - 使页面变量在 kendoui 网格模板中可用

> ID：15207800
> 
> 赞同：1
> 
> 时间：2013-03-04T17:52:19.673
> 
> 标签：javascript, kendo-ui, kendo-grid

我有一个 kendoui 模板定义如下（简化）：

```
<script id="detailsTemplate" type="text/x-kendo-template">

<tr class="row k-alt">
  <td>
        #(OwnerId == userInfo.UserId)? "Me" : OwnerName#
    </td>
</tr>    
</script> 
```

在我的文档就绪事件中，我定义了`userInfo`对象：

```
$(document).ready(function () {
     var userInfo = $.parseJSON($.cookie('visitorData')); 
```

`userInfo.UserId`当数据源读取返回数据时，我收到一个未定义的 js 错误。有什么方法可以让我的`userInfo`对象在模板中可用？有没有其他方法可以解决这个问题，而不必在返回数据的每个项目中定义 userInfo ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:45:54.713

模板中的变量（afaik）需要是绑定数据的一部分或全局变量。

尝试定义：

```
userInfo = $.parseJSON($.cookie('visitorData'));
$(document).ready(function () {

    ....
} 
```

模板为：

```
<script id="detailsTemplate" type="text/x-kendo-template">
    <tr class="row k-alt">
        <td>
            #= (OwnerId == userInfo.UserId)? "Me" : OwnerName #
        </td>
    </tr>    
</script> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T18:47:51.257

上下文不一样。您定义变量的范围与执行模板的范围不同。

为对象创建一个全局变量，在`userInfo`您共享的文档就绪处理程序之外声明它。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-03-29T10:17:41.970

使用带有剑道网格的内联模板

```
template: "<input type='checkbox' class='checkbox' #: defaultCost > "+self.range +"? 'disabled':'' #/>" 
```

self.range 我的页面级别可在哪里

# ruby-on-rails - ruby 的多值表单标记

> ID：15207802
> 
> 赞同：1
> 
> 时间：2013-03-04T17:52:22.783
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

这是我遇到的问题，我已经尝试过思考，但仍然无法找出解决方案。所以我有两个模型

1.  用户
2.  数据

和体验属于用户，并接受嵌套属性

现在问题来了！我有想要更新或插入的页面/表单。

所以在数据模型中

```
flavor, body 
```

那么如何添加表单标签，我可以在其中指定我的风格，但让用户决定主体，例如，目前我有

```
<%= f.text_field :body, placeholder: "...." %> 
```

那么我该怎么做（错误的语法）

```
<%= f.text_field :body, :flavor => "someflav" , placeholder: "...." %>
<%= f.text_field :body, :flavor => "Otherflav" , placeholder: "...." %> 
```

等等...

如何做到这一点？我环顾了 rails api，但无法弄清楚如何解决我的问题。

感谢您的考虑和时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:05:42.740

你需要使用`fields_for`

Rails 构造输入名称，帮助它准确地确定属性在哪里。

例如： `user[datas_attributes][0][body]`

因为（如果我的解释正确的话）用户有很多数据，它看起来像这样：

```
<%= fields_for :datas do |data_fields| %>
  <%= data_fields.text_field :body %>
<% end %> 
```

要完成这项工作，您需要做一些事情。

在您的模型中，您需要添加以下两行：

```
accepts_nested_attributes_for :datas
attr_accessible :datas_attributes 
```

# java - 在 Java 启动时加载 DLL

> ID：15207807
> 
> 赞同：0
> 
> 时间：2013-03-04T17:53:06.147
> 
> 标签：java, dll, native

我想知道是否可以在执行 java 应用程序时加载 DLL。也许通过一些命令行参数或类似的东西。基本上，我只是想确保在启动 Java 时，我的 DLL 已加载，因此不必仅在我使用它时才完成。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:57:43.567

你有[System.load(String filename)](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#load%28java.lang.String%29)和[System.loadLibrary(String libname)](http://docs.oracle.com/javase/7/docs/api/java/lang/System.html#loadLibrary%28java.lang.String%29)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:17:10.660

它可以是静态初始化块中的一个

```
public class App {

    static {
        System.loadLibrary("libname");
    }

    public static void main(String[] args) throws Exception {
... 
```

# wcf - IIS 需要哪些权限才能与托管在不同计算机上的 WCF 服务通信？

> ID：15207810
> 
> 赞同：0
> 
> 时间：2013-03-04T17:53:20.477
> 
> 标签：wcf, iis

在这个问题中：[ASP.NET Web 应用程序无法连接到作为 Windows 服务托管的 WCF](https://stackoverflow.com/questions/13963534/asp-net-web-application-unable-to-connect-to-wcf-hosted-as-windows-service)

据称，IIS 无法与托管在另一台计算机上的 WCF 服务通信的原因是未分配应用程序池标识的权限。

我相信我面临着同样的问题。这些权利是什么，我在哪里设置它们？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T18:03:06.930

这取决于您尝试访问的服务的配置。但是，如果您在连接到另一台计算机时遇到问题，您很可能无权使用托管 IIS 的服务器的计算机帐户访问该计算机。您可以尝试添加对目标服务器（托管 WCF 服务的服务器）的 [domain][iismachine] 访问权限。

[这个概述](http://www.iis.net/learn/manage/configuring-security/application-pool-identities)有一些关于在不同场景中需要做什么的很好的信息。

# sql - 如何将日期时间字段添加到 + 1 天

> ID：15207811
> 
> 赞同：1
> 
> 时间：2013-03-04T17:53:22.137
> 
> 标签：sql, sql-server, sql-server-2008, stored-procedures

在我的存储过程中，我有一个 StartDate 和 EndDate 字段在 Varchar(10)

```
@StartDate Varchar(10),
@EndDate Varchar(10) 
```

我正在从 UI 输入开始日期 03/01/2013 和 03/04/2013

对于结束日期，我需要添加一天 + 如果我的 EndDate 是 03/04/2013 我需要将其更新为 03/05/2013..

谢谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T18:09:04.273

如果这是一个新的存储过程（或者不是任何其他使用它的代码），最好将变量更改为 Date 类型。因为`if you comparing data by date` *你应该比较* `Dates not varchar values`。

如果您`CAN`更改变量类型，则可以使用`DATEADD()`如下函数添加一天。

```
--if @enddate is a date type
select @enddate = dateadd(day,1,@enddate) 
```

如果您`CANNOT`更改变量类型，最好将它们传递给`ISO format`(ie; `yyyymmdd`)，因为您当前的字符串格式是特定于文化的，并且在具有不同文化的服务器中查询可能会失败。

```
--date pass as yyyymmdd (not culture specific)
select @enddate = convert(varchar(10), 
                      dateadd(day, 1, convert(date, @enddate)), 101)

--date pass as mm/dd/yyyy (US culture)
select @enddate = convert(varchar(10), 
                      dateadd(day, 1, convert(date, @enddate,101)), 101) 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-03-04T17:55:51.490

`SET @EndDate = DATEADD (d, 1, CAST(@StartDate AS datetime))`给你答案`datetime`。然后，如果需要，您可以转换回 varchar：

`SET @EndDate = CAST(DATEADD (d, 1, CAST(@StartDate AS datetime)) AS varchar(10))`

# c# - 将 PNG 拆分为 RGB 和 Alpha 通道

> ID：15207815
> 
> 赞同：2
> 
> 时间：2013-03-04T17:53:34.093
> 
> 标签：c#, png

我正在尝试对接受 RGBa .png 文件并输出两个 jpeg 文件的 PNG 文件进行一些自动处理：1 个只是 RGB 通道，另一个只是 alpha 通道，作为灰度图像。

有什么办法可以在 C# 中原生地做到这一点吗？如果需要第三方库，只要它是免费/开源的就可以了，但我更愿意直接使用 GDI 或其他东西来做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-28T07:03:30.917

这是我的工作代码：

```
 /// <summary>
    /// Split PNG file into two JPGs (RGB and alpha)
    /// </summary>
    private void SplitPngFileIntoRGBandAplha(string imagePath)
    {
        try
        {
            // Open original bitmap
            var bitmap = new Bitmap(imagePath);

            // Rectangle 
            var rect = new Rectangle(0, 0, bitmap.Width, bitmap.Height);

            // Get RGB bitmap
            var bitmapInRgbFormat = bitmap.Clone(rect, PixelFormat.Format32bppRgb);

            // Read bitmap data
            BitmapData bmData = bitmap.LockBits(rect, ImageLockMode.ReadOnly, bitmap.PixelFormat);

            // Prepare alpha bitmap
            var alphaBitmap = new Bitmap(bmData.Width, bmData.Height, PixelFormat.Format32bppRgb);

            for (int y = 0; y <= bmData.Height -1; y++)
            {
                for (int x = 0; x <= bmData.Width -1; x++)
                {
                    Color PixelColor = Color.FromArgb(Marshal.ReadInt32(bmData.Scan0, (bmData.Stride * y) + (4 * x)));
                    if (PixelColor.A > 0 & PixelColor.A <= 255)
                    {
                        alphaBitmap.SetPixel(x, y, Color.FromArgb(PixelColor.A, PixelColor.A, PixelColor.A, PixelColor.A));
                    }
                    else
                    {
                        alphaBitmap.SetPixel(x, y, Color.FromArgb(0, 0, 0, 0));
                    }
                }
            }

            bitmap.UnlockBits(bmData);

            // Prepare JPG format
            ImageCodecInfo jgpEncoder = GetEncoder(ImageFormat.Jpeg);
            var encoder =  Encoder.Quality;
            var encoderParameters = new EncoderParameters(1);
            var encoderParameter = new EncoderParameter(encoder, 100L);
            encoderParameters.Param[0] = encoderParameter;

            // Save RGB bitmap
            bitmapInRgbFormat.Save(imagePath.Replace("png", "jpg"), jgpEncoder, encoderParameters);

            // Save Alpha bitmpa
            alphaBitmap.Save(imagePath.Replace(".png", "_alpha.jpg"), jgpEncoder, encoderParameters);

            bitmap.Dispose();
            bitmapInRgbFormat.Dispose();
            bitmap.Dispose();

            // Delete bitmap
            System.IO.File.Delete(imagePath);
        }
        catch(Exception e)
        {
             // Handle exception
        }

    } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:03:44.757

Option - load to Bitmap, [clone to get RGB only](https://stackoverflow.com/questions/2940558/load-a-bitmap-from-file-in-rgb-format-without-alpha), than manually [grab bits with LockBits](https://stackoverflow.com/a/15207655/477420) and extract alpha channel to create new greyscale bitmap from it.

```
// get RGB copy
var bitmapInRgbFormat = loadedBitmap.Clone(
        new Rectangle(0, 0, loadedBitmap.Width, loadedBitmap.Height),
        PixelFormat.Format32bppRgb) 
```

# javascript - glDatePicker 2 - 来自 Asp 文件的数据

> ID：15207822
> 
> 赞同：0
> 
> 时间：2013-03-04T17:54:07.230
> 
> 标签：javascript, asp-classic

我正在使用 glDatePicker 2，我想修改脚本以更新从数据库 ACCES 获取数据的 ASP 文件中的日期“selectableDateRange”。

示例： [http ://www.tutoisole.it/public/aldo/a.htm](http://www.tuttoisole.it/public/aldo/a.htm)

asp 文件： [http ://www.tutoisole.it/public/aldo/calendario.asp](http://www.tuttoisole.it/public/aldo/calendario.asp)

asp 文件返回以下值： [ { from: new Date(2013, 2, 1), to: new Date(2013, 2, 10) },{ from: new Date(2013, 2, 19), to: new日期(2013, 2, 22) } ]

但它不起作用。

你可以帮帮我吗。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-17T13:58:06.903

我有类似的问题，我需要更新一些选项。

从他们的文档

```
// This example updates some options (calling render will re-generate the calendar)
$.extend(myDatePicker.options,
{
    cssName: 'darkneon',
    allowMonthSelect: false,
    allowYearSelect: false
});
myDatePicker.render();

// If the calendar is not set to showAlways=true, you can force it to show by calling the show() function
myDatePicker.show(); 
```

# dotnetnuke - DotnetNuke 7 对空间数据类型的支持

> ID：15207823
> 
> 赞同：2
> 
> 时间：2013-03-04T17:54:08.073
> 
> 标签：dotnetnuke, entity-framework-5, spatial, petapoco

我想知道 DotNetNuke 7 中是否有任何简单的方法可以使用空间数据类型，特别是 System.Data.Spacial.DbGeography 在读取和写入数据库表方面。

DotNetNuke 利用 PetaPoco，因为它支持使用存储过程，所以我可以通过传入经度和纬度来创建地理条目。但是我不能只通过 DbGeography，因为它错误地说没有本机类型。

然后在从包含地理数据的数据表中读取时，PetaPoco 错误说 IConvertable 必须实现（我不明白这个错误，它可能是一个单独的问题的理由）

我认为放弃 PetaPoco 并在我的 DotNetNuke 项目中实施 Entity Framework 5 Code First 可能会更好，但似乎存在 EF 无法（轻松）映射到预先存在的 DotNetnuke 数据库的问题。该博客建议它需要一个单独的数据库供 EF 与 DotNetNuke DB 一起使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-06T02:20:04.380

如果您编写自定义 DotNetNuke 模块，您可以使用任何其他您想要的 .NET 库，并使用 Spacial 数据类型或您想要的任何内容按照您自己的条件连接到数据库。您可以连接 ADO .NET，我们使用实体空间[http://www.entityspaces.net/www.entityspaces.net/Portal/Default.aspx.html](http://www.entityspaces.net/www.entityspaces.net/Portal/Default.aspx.html)

自从我使用实体空间多年以来，我还没有使用过实体框架，它的作用与 EF 几乎相同。

但是您没有理由不能使用该库是您的自定义 DNN 模块。

# java - JDBC 连接池是单例的吗？

> ID：15207825
> 
> 赞同：3
> 
> 时间：2013-03-04T17:54:10.593
> 
> 标签：java, jdbc, singleton, connection-pooling

我正在学习 JDBC，目前正在研究 JDBC DataSource 和连接池。您是否需要确保您创建的数据源只在应用程序中创建一次，然后与所有需要引用数据源的类共享？或者它在幕后做了什么神奇的事情？

如果您在 Java EE 服务器或 Spring 中配置数据源，它是否只创建一个数据源对象？JNDI 中的对象是单例的，还是每次需要时都会获得一个新对象？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T17:57:22.893

`DataSource`实例并不神奇。如果您创建其中两个，您将拥有两个，并且每个都有自己的连接池。使用 JNDI，您可以在名称下注册一个对象，因此根据定义，每次都会给出相同的对象。你可以认为它或多或少是夸大其词`HashMap`。在 Spring 中，单例是默认范围，因此`DataSource`将创建一个单例并在使用它的所有对象之间共享，除非您更改 bean 的范围。

# c++ - 在按钮过程中处理按钮单击

> ID：15207827
> 
> 赞同：1
> 
> 时间：2013-03-04T17:54:17.870
> 
> 标签：c++, winapi

我正在使用以下代码创建一个按钮并更改它的过程：

```
INT_PTR CALLBACK Proc(HWND hDlg, UINT message, WPARAM wParam, LPARAM lParam)
{
    //switch( LOWORD(wParam) )
    //switch( HIWORD(wParam) )
    switch (message)
    {
    case 200:
    case BN_CLICKED:
        MessageBox(NULL,NULL,NULL,NULL);
        break;

    default: return oldproc(hDlg, message, wParam, lParam);
    }
    return (INT_PTR)FALSE;
} 
```

和

```
HWND handle = CreateWindowEx( NULL,
        L"button",
        L"TEXT",
        WS_CHILD | WS_VISIBLE | WS_TABSTOP | BS_DEFPUSHBUTTON,
        50,
        50,
        500,
        500,
        hWnd,
        (HMENU)200,
        hInstance,
        nullptr);

    oldproc = (WNDPROC)SetWindowLong(handle, GWL_WNDPROC, (LONG)Proc); 
```

问题是，无论我如何在 Proc 中处理消息，都没有创建消息框。

注意：注释最后一行并在窗口过程中处理它，如下所示：

```
case WM_COMMAND:
    wmId    = LOWORD(wParam);
    wmEvent = HIWORD(wParam);
    switch (wmId)
    {
    case 200:
         if(wmEvent == BN_CLICKED)
            MessageBox(NULL,NULL,NULL,NULL);
... } 
```

工作正常，但由于我的设计方式，我不能使用它。

有没有办法让这个工作？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T17:58:43.957

您看不到您的消息框，因为`BM_CLICK`不是按钮收到的消息。当您希望按钮模拟单击操作时，它是您发送给按钮的消息。

您正在寻找的是[`BN_CLICKED`](http://msdn.microsoft.com/en-us/library/windows/desktop/bb761825.aspx)通知。但是，`BN_CLICKED`它包含在`WM_COMMAND`发送到按钮的父窗口而不是按钮本身的消息中。因此，您需要对父窗口进行子类化才能接收它。

如果这不是一个选项，那么您可以改用特定于线程的消息挂钩，`SetWindowsHookEx()`并让该回调查找发送到按钮父窗口的消息。例如：

```
HWND hBtn, hBtnParent;
HHOOK hHook;

LRESULT CALLBACK BtnMsgProc(int iCode, WPARAM wParam, LPARAM lParam)
{
    if ((iCode == HC_ACTION) && (wParam == PM_REMOVE))
    {
        MSG *msg = reinterpret_cast<MSG*>(lParam);
        if ((msg->hwnd == hBtnParent) &&
            (msg->message == WM_COMMAND) &&
            (HIWORD(msg->wParam) == BN_CLICKED) &&
            (reinterpret_cast<HWND>(msg->lParam) == hBtn))
        {
            // button has been clicked...
        }
    }

    return CallNextHookEx(hHook, iCode, wParam, lParam);
} 
```

.

```
hBtnParent = hWnd;
hBtn = CreateWindowEx(
    NULL,
    L"button",
    L"TEXT",
    WS_CHILD | WS_VISIBLE | WS_TABSTOP | BS_DEFPUSHBUTTON,
    50,
    50,
    500,
    500,
    hWnd,
    (HMENU)200,
    hInstance,
    NULL);

hHook = SetWindowsHookEx(WH_GETMESSAGE, (HOOKPROC)BtnMsgProc, NULL, GetCurrentThreadId());
...
UnhookWindowsHookEx(hHook);
DestroyWindow(hBtn); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T18:08:44.930

关于 SetWindowsHookEx 示例的问题：[MSDN](http://msdn.microsoft.com/en-us/library/windows/desktop/ms644960%28v=vs.85%29.aspx#installing_releasing)

# php - Contactformular 仅适用于本地主机

> ID：15207830
> 
> 赞同：0
> 
> 时间：2013-03-04T17:54:35.257
> 
> 标签：php, html

我已经制作了一个联系表格。它在本地主机上工作正常，当我发送电子邮件时我会收到电子邮件。然后我将它上传到我的服务器，并会现场试用，现在我没有收到任何电子邮件，但我没有收到任何错误。

我迷路了，不知道该怎么办。我已经尝试了几个小时让它工作，但没有任何运气。

该怎么办？

# javascript - chrome web控制台中的Javascript“意外标识符”

> ID：15207831
> 
> 赞同：0
> 
> 时间：2013-03-04T17:54:37.847
> 
> 标签：javascript, html, mouseover, onmouseover

当 div 被鼠标悬停时，我正在使用一些 javascript 代码来显示图像：

```
function show()
{
document.getElementById("reveal").innerHTML = "<img src=\"..." border=\"0\">";
}

function hide()
{
document.getElementById("reveal").innerHTML = "Hidden";
} 
```

然后是 HTML：

```
<a onMouseOver="show()" onMouseOut="hide();"><div id="reveal">Mouseover me!</div></a> 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T17:55:59.883

语法高亮显示了它。你错过了之前`\`的。`"``border`

```
document.getElementById("reveal").innerHTML = "<img src=\"...\" border=\"0\">"; 
```

或者，使用单引号来分隔您的 JS 字符串：

```
document.getElementById('reveal').innerHTML = '<img src="..." border="0">'; 
```

正确混合单引号和双引号时不需要转义。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T17:56:30.977

在此处添加反斜杠

```
document.getElementById("reveal").innerHTML = "<img src=\"...\" border=\"0\">"; 
```

（在 src 的末尾）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T17:57:16.407

尝试在显示功能中使用它...

```
document.getElementById("reveal").innerHTML = '<img src="..." border="0">'; 
```

而不是转义，只需使用单引号

# jquery - 如何在没有插件的情况下使用 .hover() 设置色移延迟？

> ID：15207839
> 
> 赞同：0
> 
> 时间：2013-03-04T17:55:04.787
> 
> 标签：jquery, hover, delay

我的导航上有一个悬停事件，如下所示：

```
$('#floatingNav a').hover( function() {

  $(this).css({'background-color': '#f00'}),

  $(this).delay(300).css({'background-color': '#c00'})},

  mouseOffFunction() 
} 
```

我只需要它闪烁到#f00 片刻，然后将其恢复为原始颜色，但它会显示原始颜色而不转换为#f00。

我是否正确使用延迟（）？我已经以不同的方式对其进行了调整，但无法让该项目同时显示两种颜色。

我见过人们引用hoverIntent，但我觉得这可以在没有插件的情况下完成。

建议？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:16:22.137

我认为这是因为您的`delay()`方法没有效果。的文档`delay()`说只有使用效果队列的方法可以延迟，我假设`css()`不会。这里还有更多内容：http: [//api.jquery.com/delay/](http://api.jquery.com/delay/)。

# entity-framework - 插入前在实体模型上手动设置主键的值

> ID：15207843
> 
> 赞同：0
> 
> 时间：2013-03-04T17:55:16.027
> 
> 标签：entity-framework

我有我的实体模型，其中每个实体都有一个主键，它们标有 StoreGeneratedPattern = "Identity"，我感兴趣的实体是人。它是在 oracle 中创建的，并且在另一个模式中存在一个带有它的序列的“PEOLPE_HIST”表。在插入 PEOPLE 之前，我会搜索 PEOPLE_HIST 以及该人是否存在。我获得了包含要插入新 PEOPLE 表的 ID（主键）的历史信息。我为 PEOPLE 表创建了一个触发器来检查 ID 是否大于等于 0，如果是，那么我将不使用序列并插入 Hist ID。

这可能吗？

提前致谢

# php - 如何将数值转换为字符串？

> ID：15207853
> 
> 赞同：0
> 
> 时间：2013-03-04T17:55:42.943
> 
> 标签：php, javascript, json

我有一个 JS 函数，我正在传递一些 JSON。我用 PHP 生成这个 JSON：

```
<?php

$array[] = array('hello','123','456');

echo json_encode($array);

?> 
```

这给了我一些对 JS 来说很简洁的东西，比如：

```
[["hello","123","456"]] 
```

我的 JS 函数似乎喜欢这种格式。

然而，我遇到的问题是当我直接在 JS 中生成一个类似的数组时，如下所示：

```
var json = [[text_var,number_var,number_var]]; // these vars established earlier in the code

var json_stringify = JSON.stringify(json); 
```

我最终得到了如下所示的内容：

```
[["hello",123,456]] 
```

所以基本上，它不是用引号封装我的数字。我认为这无关紧要，但没有它们我会得到一个*Uncaught RangeError: Maximum call stack size exceeded*

我尝试做一些类似自己准备 JSON 的事情：

```
var json = '[["'+place_name+'","'+longitude+'","'+latitude+'"]]'; 
```

但是传递它也不喜欢 - 也许它不觉得它是一个 JSON var，我已经尝试通过 JSON.stringify 解析它，但我最终在每个引用之前都有反斜杠，它也不喜欢那样.

我虚弱的头脑在这里没有看到什么？

**编辑：**我的 PHP 数组在另一个数组中，因此是 [["hello',"123","456"]] 的结果，而不是单括号 [ ]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T17:57:54.750

JSON 支持数字（不带引号）和字符串（带引号）。要强制它使用字符串，请尝试：

```
var json = [[text_var,number_var + "",number_var + ""]]; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T17:59:58.447

将数字转换为字符串：

```
var json = [[text_var,number_var.toString(),number_var.toString()]]; 
```

# hibernate - Jadira UserType 库 JavaTimeZoneWorkaroundHelper

> ID：15207857
> 
> 赞同：1
> 
> 时间：2013-03-04T17:55:52.987
> 
> 标签：hibernate, jakarta-ee, jodatime

我将 Joda 库用于我的 Date/Time 对象，并使用 jadira userType 项目通过 Hibernate 在我的 MySQL 数据库中保存这些东西。

运行应用程序时，我得到

```
4 mars 2013 18:48:18 org.jadira.usertype.spi.reflectionutils.JavaTimeZoneWorkaroundHelper <clinit>
ATTENTION: Under JDK 6 it may not be possible to handle DST transitions correctly
4 mars 2013 18:48:18 org.jadira.usertype.spi.reflectionutils.JavaTimeZoneWorkaroundHelper <clinit>
GRAVE: Running under a Zone that uses daylight saving time. To avoid incorrect datetimes being stored during DST transition, either update to JDK 7 or use a Timezone for the JDK without Daylight Saving Time 
```

所以从文本中我有两个选择： - 安装 JDK 7，我不想这样做（我在 mac OS 10.6.8 上，我也不想使用“太新”的 java 版本） -使用没有 DST 的时区。这意味着我必须将我的 JVM 的默认 TimeZone 设置为俄罗斯或南美洲的某个地方。

*   我可以简单地禁用`JavaTimeZoneWorkaroundHelper`Jadira 的功能吗？如何 ？

*   我想到了另一种选择：不要将 jadira 用于它提供的功能（将 joda 对象转换为字符串以及从字符串转换为 joda 对象）并自己进行转换器。

你有什么建议？谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:38:51.457

You can explicitly set java and database time zones used for mapping independent of the machine your app is running. Generally it is good practice to store date and time in UTC time zone in database. Try if this solves your problem.

```
 @TypeDef(name = "myDateTime", 
          typeClass = org.jadira.usertype.dateandtime.joda.PersistentDateTime.class,
      parameters = {@Parameter(value="UTC", name="databaseZone"), 
                    @Parameter(value="UTC", name="javaZone")}) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-06-20T09:12:26.757

如果将此 @TypeDef 添加到 package-info.java 文件中，并将 @Type(name = "myDateTime") 添加到应该具有此类型的属性中，它会完美运行。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-05-13T08:41:45.410

由于创建了此问题，因此创建了删除消息的用户类型库的更新版本。因此，如果您[在 maven central 中使用 3.2.0.GA](http://search.maven.org/#artifactdetails%7Corg.jadira.usertype%7Cusertype.core%7C3.2.0.GA%7Cjar)等最新版本。它解决了这个问题。

# c# - 使用 asp.net 将 2 个 .txt 文件导入 sql server 数据库

> ID：15207858
> 
> 赞同：-3
> 
> 时间：2013-03-04T17:55:57.527
> 
> 标签：c#, sql-server, csv, import, streamreader

我有 2 个 .txt 文件，其中包含我需要导入到 sql server 数据库中的数据，以便在 Visual Studio C# 中继续我的项目。有人告诉我使用 Stream writer/reader。有人可以向我解释如何使用它，并向我展示如何使用它的所有方面吗？我很新。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:11:58.423

如果您只需要手动插入信息，您可以按照[此处](https://stackoverflow.com/questions/5791710/import-txt-file-to-sql-server-2008)提供的提示进行操作。

如果你想通过 C# 来做，这里有一些链接可以帮助你开始：

*   首先，您需要解析文本文件以检索数据。这是有关如何执行 此操作的[示例。](https://stackoverflow.com/questions/858756/how-to-parse-a-text-file-with-c-sharp)
*   接下来，您需要插入信息。这是执行此操作的[初学者指南](http://www.codeproject.com/Articles/4416/Beginners-guide-to-accessing-SQL-Server-through-C)。

祝你好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:31:52.347

我这里有一个例子。

[http://granadacoder.wordpress.com/2009/01/27/bulk-insert-example-using-an-idatareader-to-strong-dataset-to-sql-server-xml/](http://granadacoder.wordpress.com/2009/01/27/bulk-insert-example-using-an-idatareader-to-strong-dataset-to-sql-server-xml/)

它是为 VS2003 编写的，但将其更新到 VS2010 或（或 2008 或其他）将是微不足道的。

它不使用流阅读器。它使用 OleDb。如果您需要在插入数据之前对数据进行任何验证，上述方法是一个很好的解决方案。

这是另一个想法。

[http://www.codeproject.com/Articles/27802/Using-OleDb-to-Import-Text-Files-tab-CSV-custom](http://www.codeproject.com/Articles/27802/Using-OleDb-to-Import-Text-Files-tab-CSV-custom)

# php - 使用 MAX() 的 SQL 多连接 SELECT 查询

> ID：15207864
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:56:10.183
> 
> 标签：php, mysql, sql, database

以下查询从数据库中选择子论坛以及每个子论坛中的最后一篇文章。

```
SELECT
    forums.*,
    MAX(posts.id),
    posts.title AS lastmsgtitle,
    posts.timee AS lastmsgtime,
    posts.useraid AS lastmsguseraid,
    posts.useradn AS lastmsguseradn,
    users.photo AS lastmsgphoto
FROM forums
    LEFT JOIN posts
        ON(posts.forumid = forums.id)
    LEFT JOIN users
        ON(posts.useraid = users.id)
WHERE forums.relatedto='$forumid'
    and posts.type='post'
GROUP BY forums.id
ORDER BY `id` DESC 
```

唯一的问题，查询没有选择最后一个帖子，有什么想法吗？

论坛[1](http://i.stack.imgur.com/xL7pG.png)

帖子[2](http://i.stack.imgur.com/6oDD0.png)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:03:48.167

我建议使用子查询`max(id)`为每个帖子选择。

```
SELECT
    f.*,  -- replace the f.* with the columns that you need to return
    p1.MaxId,
    p2.title AS lastmsgtitle,
    p2.timee AS lastmsgtime,
    p2.useraid AS lastmsguseraid,
    p2.useradn AS lastmsguseradn,
    u.photo AS lastmsgphoto
FROM forums f
LEFT JOIN
(
    select MAX(id) MaxId, forumid
    from posts
    group by forumid
) p1
    ON p1.forumid = f.id
LEFT JOIN posts p2
    ON p2.forumid = f.id
    and p1.MaxId = p2.id
    and p2.type='post'
LEFT JOIN users u
    ON p2.useraid = u.id
WHERE f.relatedto='$forumid'
ORDER BY `id` DESC 
```

# c# - ASP.NET 4.5 模型绑定自定义更新

> ID：15207865
> 
> 赞同：1
> 
> 时间：2013-03-04T17:56:20.370
> 
> 标签：c#, asp.net, .net, model-binding, asp.net-4.5

我正在使用 .NET 4.5 中添加的 ASP.NET 表单模型绑定。我看到有很多关于模型绑定的东西应该使它更容易并减少你需要编写的代码量。但是，我想知道是否有办法手动更新项目。

我发现 TryUpdateModel 方法是这样的：

```
public void UpdateEquipment(int Id)
{
    var equip = EquipCondContext.Equipments.Single(x => x.Id == Id);
    TryUpdateModel(equip);
} 
```

但是，我希望有能力做到这一点：

```
public void UpdateEquipment(int Id)
{
    var equip = EquipCondContext.Equipments.Single(x => x.Id == Id);
    //equip.Description = A TextBox.Text on that row that I just saved in my list.
    EquipCondContext.SaveChanges();
} 
```

有没有办法可以像这样进行更手动的更新？

* * *

这是一个示例场景。假设我在用户输入用户 ID 的行上有一个文本框，但在更新时我想实际设置他们的徽章编号。在我的更新函数中，我首先要进行查询以获取给定用户 ID 的徽章编号，然后在保存上下文之前在我的实体中设置此属性。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:42:41.020

您正在尝试做的是挂钩模型绑定过程并在保存之前更改值。我不确定 Webforms 中的模型绑定是否与 MVC 中的 1:1 相同，但你可以试试这篇文章：

[http://www.markeverard.com/2011/07/18/creating-a-custom-modelbinder-allowing-validation-of-injected-composite-models/](http://www.markeverard.com/2011/07/18/creating-a-custom-modelbinder-allowing-validation-of-injected-composite-models/)

这篇文章是关于验证的，但您也可以轻松地更改那里的值。

基本上，您所做的是为您的类注册一个自定义 ModelBinder，然后将其挂接到绑定模型的调用中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:10:49.607

如果您想手动跟踪文本框中的更改，您必须收听[`Textbox.TextChanged`事件](http://msdn.microsoft.com/en-us/library/system.web.ui.webcontrols.textbox.textchanged.aspx)。

```
<asp:Textbox ... OnTextChanged="MyTextBoxOnTextChanged" /> 
```

在那里，您可以随心所欲地使用文本框值，在您的情况下将其存储为相应的设备描述。

# math - 非均匀网格上的二维积分

> ID：15207866
> 
> 赞同：1
> 
> 时间：2013-03-04T17:56:22.540
> 
> 标签：math, numeric, numerical-methods

我正在编写一个数据分析程序，其中一部分需要找到形状的体积。形状信息以丢失点的形式出现，给出点的半径和角坐标。

如果数据点在坐标空间中均匀分布，我将能够执行积分，但不幸的是数据点基本上是随机分布的。

我的低效方法是找到每个点的最近邻居，然后像这样将形状缝合在一起，找到缝合在一起的部分的体积。

有没有人有更好的方法可以采取？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T19:44:38.550

如果这些是表面点，那么一种好方法是将表面离散化为三角形，并使用格林定理将体积积分转换为表面积分。然后你可以在三角形上使用简单的高斯求积。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-24T00:29:01.313

好的，这就是我认为的 duffymo 的路线。

首先，对曲面进行三角剖分，并确保三角形的方向一致。这意味着相邻三角形的方向使得公共边沿相反方向遍历。

其次，对于每个三角形 ABC，计算以下表达式：H*cross2D(BA,CA)，其中 cross2D 仅使用坐标 X 和 Y 计算叉积，忽略 Z 坐标，H 是三角形中任何方便点的 Z 坐标（尽管重心会提高精度）。

第三，总结以上所有表达式。结果将是表面内的有符号体积（正负取决于方向的选择）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2016-11-07T09:11:09.663

听起来你想要点云的[凸包](https://en.wikipedia.org/wiki/Convex_hull)。幸运的是，有一些有效的方法可以让你到达那里。退房[`scipy.spatial.ConvexHull`](https://docs.scipy.org/doc/scipy-0.18.1/reference/generated/scipy.spatial.ConvexHull.html)。

# php - mysql_fetch_array 有条件

> ID：15207867
> 
> 赞同：0
> 
> 时间：2013-03-04T17:56:24.160
> 
> 标签：php, mysql

我正在制作一个足球网站。我有以下表结构：

```
season1 (name of the table)
id | player1 | player2 | score 
```

我想把分数放到一个 html 表中。此表仅适用于名为nickname1 的玩家与其他所有玩家。我有这个：

```
$query = mysql_query("SELECT * FROM season1 WHERE player1='nickname1'") or die(mysql_error());  

while($row = mysql_fetch_array( $query )) {
    echo "<tr><td>"; 
    echo "";
    echo "</td><td>";   
    echo $row['score2'];
    echo "</td><td>"; 
    echo $row['score3']; 
    echo "</td><td>"; 
    echo $row['score4'];  
    echo "</td><td>";   
    echo $row['score5'];  
    echo "</td></tr>"; 
} 
echo "</table> <br>"; 
```

*   而不是 $row['score2'] 我需要昵称1与昵称2之间的分数
*   而不是 $row['score3'] 我需要昵称1与昵称3之间的分数
*   而不是 $row['score4'] 我需要昵称1与昵称4之间的分数
*   而不是 $row['score5'] 我需要昵称1与昵称5之间的分数

我试过`SELECT * FROM season1 WHERE player1='nickname1' AND player2='nickname2'`了，但它只会在表格中显示 player1 vs player2。我想在同一张桌子上显示所有 4 名玩家 vs player1。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:02:01.803

You need to focus your loop only on making one row:

```
echo "<table><tr>";
while($row = mysql_fetch_array( $query )) {
    echo "<td>{$row['score']}</td>";
}
echo "</tr></table>"; 
```

This will ONLY output the scores of the players. You can modify it to have nickname headers and so forth.

Take note that the `$row` array resembles your table structure. `$row['score']` will give you the scores of the players where as since `score1` is not a column in the table, it does not exist in `$row`.

Possible design:

```
echo "<table><tr><th>Player 1</th><th>Player 2</th><th>Score</th></tr><tr>";
while($row = mysql_fetch_array( $query )) {
    echo "<td>{$row['player1']}</td>";
    echo "<td>{$row['player2']}</td>";
    echo "<td>{$row['score']}</td>";
}
echo "</tr></table>"; 
```

will output (depending on ID's in database)

```
Player 1  |  Player 2 |  Score
   p1           p2         0
   p1           p3         0 
```

**NOTICE:** MySQL_* has been deprecated in PHP 5.5\. Use MySQLi or PDO instead

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:05:45.227

假设 score1 是玩家 1 的分数：

```
$query = mysql_query("SELECT * FROM season1 WHERE player1='nickname1'") or die(mysql_error());  

while($row = mysql_fetch_array( $query )) {
echo "<tr><td>"; 
echo "";
echo "</td><td>";   
echo $row['player1']." vs ".$row['player2'].", with a score of: ".$row['score'];
echo "</td></tr>"; 
} 
echo "</table> <br>"; 
```

我希望它有所帮助。

萨卢多斯 ;)

# django - Django REST 框架中的子类 FileField

> ID：15207875
> 
> 赞同：0
> 
> 时间：2013-03-04T17:56:55.907
> 
> 标签：django, api, django-rest-framework

我有一个带有音频文件的 django 模型：

```
class Thing(models.Model):

    audio_file = AudioFileField(    upload_to=audio_dir, blank=True, null=True )
    photo_file = models.ImageField( upload_to=img_dir,   blank=True, null=True )
    ... 
```

其中是执行一些验证`AudioFileField`的子类：`FileField`

```
class AudioFileField(models.FileField):
    def validate(self, value, model_instance):
        try:
            if not (value.file.content_type == "audio/x-wav" or 
                    value.file.content_type == "audio/amr" or 
                    value.file.content_type == "video/3gpp"):
                raise ValidationError(u'%s is not an audio file' % value)
        except IOError:
            logger.warning("no audio file given") 
```

`audio_dir`回调设置路径并重命名文件：

```
def audio_dir(instance, filename):
        return os.path.join("audio", "recording_%s%s" % (
            datetime.datetime.now().isoformat().replace(":", "-"), 
            os.path.splitext(filename)[1].lower() )) 
```

在 Django REST 框架中`ImageField`工作正常，但子类`AudioFileField`没有。这是因为子类`serializers.FileField`不接受关键字参数`upload_to`。

如何通过 API 公开相同的功能？`audio_dir`回调对我来说特别重要。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:38:13.820

I search how to customize filefield and I don't know if it's fix your problem. If not I will search again for it and just tell me the error.

```
class Thing(models.Model):
    audio_file = AudioFileField(
        upload_to=audio_dir, 
        blank=True, null=True,
        content_types=['audio/x-wav', 'audio/amr', 'video/3gpp'] 
    )

    ...............

class AudioFileField(models.FileField):
    def __init__(self, *args, **kwargs):
        self.content_types = kwargs.pop("content_types")

        super(AudioFileField, self).__init__(*args, **kwargs)

    def clean(self, *args, **kwargs):        
        data = super(AudioFileField, self).clean(*args, **kwargs)

        audio_file = data.audio_file
        try:
            content_type = audio_file.content_type
            if content_type in self.content_types:
                raise ValidationError(u'{0} is not an audio file'.format(content_type))
            else:
                raise forms.ValidationError(_('Audio file type not supported.'))
        except AttributeError:
            pass        

        return data 
```

# arm - LPC 1769(cortex m3) Code Red IDE---没有可用于 g_pfnVectors() at0x0 的源

> ID：15207877
> 
> 赞同：1
> 
> 时间：2013-03-04T17:57:22.043
> 
> 标签：arm, inline-assembly, cortex-m3, thumb, lpc

我正在尝试使用堆栈 PSP 从用户模式调用 SVC。我在调试 LPC 1769(cortex m3) 上的代码时观察到以下错误------- No source available for "g_pfnVectors() at 0x0" 我使用的 IDE 是来自 Embedded 的带有 LPC 1769 的 CODE RED LPC Xpresso艺术家。

这是汇编代码

```
 .syntax unified
        .cpu cortex-m3
        .thumb
        .align 2
        .global Start
        .thumb
        .thumb_func
    Start:
//  LDR r0,=0xf00d   //initial value of r0 which has to be changed in svc handler
    PUSH {lr}

    MOV r0,#0x2      // set stack to PSP now. Set CONTROL[1]=1
    MSR CONTROL,r0
    ISB              // Instruction memory barrier – ensures that the above is executed

    MOV r0,#0x3         //change to user level
    MSR CONTROL, r0
    ISB

    MOV r0,#0x2
    MOV r2,#0x2
exp:
    MUL r0,r0
    SUBS r2,#1
    BNE exp

    SVC 1 //print in hex

    MOV r0,#0x4  //print in decimal
    SVC 2

    MOV r0,#'A'
    SVC 3         //print character

    MOV r1,0x0
    MSR CONTROL,r1
             ISB

    POP {lr}
    BX lr 
```

在 SVC 中，我进行堆栈检查并调用相应的函数以在控制台上打印。这是 SVC 代码：

```
__attribute__ ((section(".after_vectors")))
void SVCall_Handler(void)
{
  while(1)
  {
    __asm(
            "TST lr, #4         \n"
            "ITE eq         \n"
            "MRSEQ r0, MSP      \n"
            "MRSNE r0, PSP      \n"
            "LDR r0,[r0,#0]     \n"
            "LDR r1, [r0, #24]  \n"
            "LDRB r1, [r1, #-2] \n"
            //immediate data in r1 and input parameter in r0

            //"PUSH {LR}            \n"
            "CBNZ r1,svc_hex            \n"
            "B svc_end          \n"

            "svc_hex:           \n"
            "CMP r1,#1          \n"
            "BNE svc_decimal             \n"
            " BL printhex               \n"
            "B svc_end          \n"

            "svc_decimal:               \n"
            "CMP r1,#2          \n"
            "BNE svc_character          \n"
            "BL printdecimal            \n"
            "B svc_end          \n"

            "svc_character:              \n"
            "CMP r1,#3          \n"
            "BL printcharacter          \n"
            "B svc_end          \n"

            "svc_end:           \n"
            "MOV r0,#0x0                \n"
            "MSR CONTROL,r0             \n"
            "ISB                \n"
            "BX LR              \n"
    );
  }
} 
```

printhex/printcaharacter/printdecimal 是用于在控制台上打印相应值的函数。

在调试、单步模式期间，在 SVC 指令之后，出现错误 No source available for "g_pfnVectors() at 0x0" 。

错误的原因和到来是非常出乎意料的。gdb 调试器有什么问题，还是我解释代码的方式有误？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-10T16:15:01.583

这对您来说可能有点晚，但也许对其他人有用。

`g_pfnVectors`（或任何位置`0x0`），是中断/异常向量表。SVC 会调用 SVC 异常，指向其函数的指针应该在`g_pfnVectors`. 您的代码中似乎不是这种情况，因此`PC`跳转到`0x0`，顺便说一下`g_pfnVectors`.

# php - 获取显示列phpmyadmin

> ID：15207879
> 
> 赞同：0
> 
> 时间：2013-03-04T17:57:30.877
> 
> 标签：php, sql, phpmyadmin

在 phpmyadmin 的关系视图中，可以选择默认显示列，这对于外键非常方便。

我想在 php 中获取此列名，但此信息存储在哪里？

我在 information_schema 中搜索过，但在任何地方都找不到。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:23:30.607

信息存储在一个名为`phpmyadmin`. 要获取该信息，请发出如下查询：

```
SELECT `display_field`
FROM `phpmyadmin`.`pma_table_info`
WHERE `db_name` = 'your_db' AND `table_name` = 'your_table' 
```

# heidisql - heidisql - 每个数据库一个窗口

> ID：15207880
> 
> 赞同：0
> 
> 时间：2013-03-04T17:57:33.430
> 
> 标签：heidisql

多年来，我一直在使用 HeidiSQL 3.2 版，并且刚刚升级到 7.0。

是否有任何选项可以为每个不同的数据库强制使用不同的 heidisql 窗口？目前它们都集中在一个窗口下——对我个人而言，这对于在错误的数据库上运行脚本很危险。

任何建议都会很有用。谢谢大卫

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-08T14:57:16.150

从新会话管理器窗口而不是现有会话开始新会话。如果您从现有会话开始，则合并会话。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-12-10T08:04:24.757

如果您不确定是否在错误的服务器上运行查询，您可以为每个会话赋予其自己的树背景颜色。只需登录您的会话，然后单击`File > Select session background color`以选择一种颜色。这有助于您区分会话。

除此之外，HeidiSQL 将非焦点会话的数据库树文本颜色略微调暗，因此焦点会话显示为黑色（取决于您的 Windows 颜色设置），而其他打开的会话显示为灰色。

除此之外，HeidiSQL 会自动检测不带 WHERE 子句的不安全 UPDATE 和 DELETE 查询，并在`Query`选项卡中实际执行此类查询之前通过确认对话框警告您：

[![在此处输入图像描述](../Images/22cbbb0df48ecb6653c0372e7fea5c22.png)](https://i.stack.imgur.com/bsUMb.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2019-01-24T08:33:43.527

如果您担心在错误的数据库上运行脚本，另一种选择是在每个数据库上创建一个只读帐户。然后，仅在需要运行查询时才专门连接启用写入的帐户。

# c - 指向二维结构数组 C 的指针

> ID：15207888
> 
> 赞同：4
> 
> 时间：2013-03-04T17:57:54.020
> 
> 标签：c, arrays, pointers, struct

我有一个特定的结构`structX`和一个包含这些结构的二维数组。

我希望能够保存指向该 2D 结构的指针并对其进行迭代

以动态的方式，意味着指针可以持有任何`structX`并迭代。

一般行示例：

```
struct structX *ptr = NULL;

...

  if(i == OK)
    {
        ptr = General_struct_which_holds_others->ptr1;
    }
    else if(i ==NOT_OK)
    {
        ptr = General_struct_which_holds_others->ptr2;
    } 
```

现在迭代：

```
if(ptr[x][y] == OK) <----Error, subscripted value is neither array nor pointer
{
...
} 
```

我希望我能理解，正如我所说，这是非常笼统的。

如何进行迭代？意思是没有错误？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:09:01.883

我可以在您的代码中注意到两个问题`if(ptr[x][y] == OK)`

(1):

`ptr`是指向结构（单 *）的指针，你不能使用双索引`[][]` ，所以在`if(ptr[x][y] == OK)`

**错误，**下标值既不是数组也不是指针，因为`ptr[][]`

(2):

**错误：**使用了需要标量的结构类型值**意味着** `if(struct are not allow)`.

```
if(should be a scalar value ) 
```

标量值意味着可以转换成`0/1.`

## 指向二维结构数组 C 的指针

```
struct structX matrix2D[ROW][COL]; 
```

它的指针

```
struct structX (*ptr2D)[ROW][COL];

ptr2D = &matrix2D; 
```

好的，像这样访问你的数组结构：

```
struct structX i;
(*ptr2D)[r][c] = i; 
```

如果您想传入一个函数，请执行以下操作：

```
void to(struct structX* ptr2D[][COL]){
   struct structX i;
   ptr2D[][COL] = i;
}
void from(){
  struct structX matrix2D[ROW][COL];
  to(matrix2D);
} 
```

只是为了让你确定我写了一个简单的代码来展示如何使用`ptr2D`. 希望对您有所帮助：

```
#include<stdio.h>
#define ROW 10
#define COL 5
typedef struct {
 int a;
 char b;
} structX;
void to(structX ptr2D[][COL], int r, int c){
 printf("in to: %d %c\n", ptr2D[r][c].a, ptr2D[r][c].b);
}
int main(){
 structX matrix[ROW][COL];
 structX (*ptr2D)[ROW][COL];
 ptr2D = &matrix;
 structX  i;
 i.a = 5; 
 i.b = 'a';
 int r = 3;
 int c = 2;
 (*ptr2D)[r][c] = i;
 printf("%d %c\n", (*ptr2D)[r][c].a, (*ptr2D)[r][c].b);
 to(matrix, r, c);
} 
```

及其工作，输出：

```
5 a
in to: 5 a 
```

**编辑**

我想展示两个技巧，但现在我认为我应该提供一个统一的方法（*正如您评论*的那样）：所以这里是代码：

```
#include<stdio.h>
#define ROW 10
#define COL 5
typedef struct {
 int a;
 char b;
} structX;
void to(structX (*ptr2D)[ROW][COL], int r, int c){
 printf("in to: %d %c\n", (*ptr2D)[r][c].a, (*ptr2D)[r][c].b);
}
int main(){
 structX matrix[ROW][COL];
 structX (*ptr2D)[ROW][COL];
 ptr2D = &matrix;
 structX  i;
 i.a = 5; 
 i.b = 'a';
 int r = 3;
 int c = 2;
 (*ptr2D)[r][c] = i;
 printf("%d %c\n", (*ptr2D)[r][c].a, (*ptr2D)[r][c].b);
 to(&matrix, r, c);
} 
```

输出

```
5 a
in to: 5 a 
```

**编辑**：

**错误：**使用了需要标量的结构类型值**意味着** `if(struct are not allow)`.

```
if(should be a scalar value ) 
```

你不能这样做`if((*ptr2D)[r][c]);`

但这是允许的：

```
if((*ptr2D)[r][c].a == 5); 
```

或者

```
if((*ptr2D)[r][c].b == 'a'); 
```

或者

```
if((*ptr2D)[r][c].a == 5 && (*ptr2D)[r][c].b == 'a'); 
```

或者

```
structX  i;
if((*ptr2D)[r][c] == i); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-04T19:33:03.207

您可能希望准备好[这篇](http://www.cplusplus.com/forum/articles/17108/)关于多维数组的文章。如果你想迭代一个数组，你需要知道它有多大（它是否是动态的）。如果您希望它是动态的，这意味着您需要在它需要增长时为其分配内存并且您需要释放旧内存。您的问题也有问题 - 您声明了一个空指针，然后尝试取消引用它，但您从未为它分配内存。

如果你确实为它分配了内存，你可以通过说

```
ptr[x * ROW_WIDTH + y] 
```

如果将 ROW_WIDTH 设置为 y 的最大值。根据您要表示主要行还是主要列数组，您可以使用 y * width 而不是 x * width。

# c# - Castle Windsor：类型化工厂设施可以将参数向下传递给类型的依赖项之一吗？

> ID：15207890
> 
> 赞同：2
> 
> 时间：2013-03-04T17:58:09.417
> 
> 标签：c#, castle-windsor, typed-factory-facility

我对构造函数有这样的看法：

`MyView(MyViewModel viewModel)`

和具有如下构造函数的视图模型：

`MyViewModel(RuntimeParameter runtimeParam, <design-time resolvable parameters>)`

我想使用 Castle Windsor 的 Typed Factory Facility 功能创建一个视图工厂，以便我可以通过调用创建视图

`MyView view = factory.Create(runtimeParam);`

我已经能够在[此处](http://stw.castleproject.org/Windsor.Typed-Factory-Facility-interface-based-factories.ashx)使用 Castle Windsor 文档制作 ViewModel 工厂，但我无法让 View Factory 工作。传递给 View 工厂的运行时参数需要传递给 ViewModel。有没有办法告诉温莎这样做？

我想我可以使用两个工厂——一个用于视图，一个用于视图模型，但这看起来很难看......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:10:39.007

无法以您尝试的方式通过多层类型化工厂传递参数。我认为您最好的选择是让您的 View 依赖于您的 ViewModel 类型化工厂，并在其构造函数中从工厂请求 ViewModel（如果您愿意，可以从另一个 Views 类型化工厂调用）。

作为替代方案，请考虑您的 ViewModel 是否真的需要通过类型化工厂来解析。可以从在容器中注册的某些服务中获取该 RuntimeParameter 吗？一般来说，如果我能找到一种使“默认”行为起作用的方法，我会尽量避免使用类型化工厂。

# ios - Restkit 是否默认支持延迟加载？

> ID：15207893
> 
> 赞同：0
> 
> 时间：2013-03-04T17:58:19.173
> 
> 标签：ios, lazy-loading, restkit

我在我的 ios 应用程序中使用 Restkit 0.20。对于每个请求，服务器都会使用包含数百个对象的 json 数组进行响应，这需要大量时间来映射/加载。是否默认支持延迟加载 Restkit 中的对象？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-05T17:03:07.667

您可能可以通过使用 CoreData 完成您想做的事情。

RestKit 允许您将 CoreData 实体映射到从 REST 调用返回的对象。这些对象将本地存储在您指定的 CoreData 存储中。

然后，如果您不想进行 Web 服务调用，您可以做的只是从 CoreData 存储中提取对象。它不会自动为您执行此操作，但执行起来并不难。

# jquery - History.JS 后退按钮不适用于第一页

> ID：15207896
> 
> 赞同：1
> 
> 时间：2013-03-04T17:58:35.650
> 
> 标签：jquery, html, pushstate, history.js

我正在使用 history.js 更改页面的 URL，`pushState`同时使用 ajax 更改内容。

我的问题是我去的初始页面不适用于**后退**按钮。内容未存储或我用于获取内容的信息未存储。

如果我调用`pushState`有效的初始化，但我不知何故有该页面的两个条目。所以当我回击时，我必须再次回击才能到达我来自的主页。不知道这是否有意义。似乎在这里找不到与我的特定案例相关的任何内容。

```
$(function() {
    var History = window.History; 
    if ( !History.enabled ) {
        return false;
    }
    if($.url().attr('fragment')){
        var url = $.url().attr('fragment').split("-");
    }else{
        var url = $.url().attr('path').split("-");
    }

    photo_ajax(url[3],url[2],url[4]); //perform ajax content update

    //initialize first page but doesn't quite work as it creates two entries
    //History.pushState({pho_id:url[3],per_id:url[2],a_id:url[4]}, "Viewing Photo", $.url().attr('path')); 

    History.Adapter.bind(window,'statechange',function() {
        var State = History.getState();
        photo_ajax(State.data.pho_id,State.data.per_id,State.data.a_id);
    });
});

$(document).ready(function(){  
    $(document).on('click', '[id^="dopho_"]', function(event){
        var id = $(this).attr("id").split('_');
        event.preventDefault();
        History.pushState({pho_id:id[1],per_id:id[2],a_id:id[3]}, "Viewing Photo", $(this).attr('href'));
    });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T21:09:53.270

好吧，我想出了一些可行的方法。如果我`replaceState`改为使用，则初始化行有效，并且似乎不会发生双重输入。所以我现在就这样做。

```
$(function() {
        var History = window.History; 
        if ( !History.enabled ) {
            return false;
        }
        if($.url().attr('fragment')){
            var url = $.url().attr('fragment').split("-");
        }else{
            var url = $.url().attr('path').split("-");
        }

        photo_ajax(url[3],url[2],url[4]); //perform ajax content update

        //initialize first page but doesn't quite work as it creates two entries
        History.replaceState({pho_id:url[3],per_id:url[2],a_id:url[4]}, "Viewing Photo", $.url().attr('path')); 

        History.Adapter.bind(window,'statechange',function() {
            var State = History.getState();
            photo_ajax(State.data.pho_id,State.data.per_id,State.data.a_id);
        });
    });

    $(document).ready(function(){  
        $(document).on('click', '[id^="dopho_"]', function(event){
            var id = $(this).attr("id").split('_');
            event.preventDefault();
            History.pushState({pho_id:id[1],per_id:id[2],a_id:id[3]}, "Viewing Photo", $(this).attr('href'));
        });
    }); 
```

# javascript - Javascript 重定向 - 新窗口

> ID：15207898
> 
> 赞同：6
> 
> 时间：2013-03-04T17:58:36.890
> 
> 标签：javascript, html, iframe

我正在尝试使用 Javascript 从空白 iframe 中创建重定向，该 iframe 将指向新窗口或选项卡内的 URL。

更具体地说，我试图让 Facebook 选项卡指向我公司的网页，而不是在选项卡的 iframe 中加载页面，该 iframe 的宽度与我们的网页不同。

这是我已经拥有的重定向脚本，但它不会在新窗口中打开 URL。

```
<script language="JavaScript">
<!--Redirect to 75th page
var time = null
function move() {
window.location = 'http://philmontscoutranch.org/Camping/75.aspx'
}
timer=setTimeout('move()',0000)
//-->
</script> 
```

* * *

好的 - 此代码段将在页面加载时打开一个新窗口，但 Chrome 的弹出窗口阻止程序阻止了它。直到现在我才想到这个。也许我可以把它装在一个光窗里？

```
<script language="JavaScript">
<!--Redirect to 75th page
var time = null
function open_win()
{
window.open("http://philmontscoutranch.org/Camping/75.aspx", "_blank");
}

timer=setTimeout('open_win()',0000)
//-->
</script> 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-03-04T18:03:33.110

Here you go: [Jsfiddle Example](http://jsfiddle.net/zachrip/hqKQg/1)

```
function opennewtab(url){
    var win = window.open(url, '_blank');
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:20:24.817

```
<html>
<head>
<script>
function open_win()
{
window.open("http://philmontscoutranch.org/Camping/75.aspx", "_blank");
}
</script>
</head>
<body>
<input type="button" value="Open Window" onclick="open_win()">
</body>
</html> 
```

[资源](http://www.w3schools.com/jsref/met_win_open.asp)

# sql-server - 使用 SQL Server 2012 转换向导进行转换时出错

> ID：15207899
> 
> 赞同：0
> 
> 时间：2013-03-04T17:58:41.377
> 
> 标签：sql-server, sql-server-2012, bids

我正在使用 SQL Server 集成服务项目转换向导并不断遇到以下错误：

> “检索属性“CertificateContext”的值时发生错误。错误代码为 0x800200009。

我做了一个谷歌搜索，没有任何关于转换的结果。原始**dtx**是用**BIDS 9** (SQL server 2008 R2) 编写的。

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:09:50.200

尝试 Project 的另一个副本，该文件可能已损坏或 C:\Program Files\Common Files\Microsoft Shared\web server extensions\12\TEMPLATE\1033\XML 目录已损坏并导致问题。

# php - Wordpress 菜单选定状态

> ID：15207900
> 
> 赞同：1
> 
> 时间：2013-03-04T17:58:42.177
> 
> 标签：php, css, wordpress

我需要帮助来更改`li`处于选定状态的 a 的样式。我正在为我的页面使用自定义 wordpress 模板。我不想创建几个模板只是为了将每个页面上的 li 类设置为`.selected`.

无论如何，这是我的代码：

```
<nav class="topmenu">
<ul>
<?php wp_nav_menu( array( 'theme_location' => 'menu-2' ) ); ?>
</ul>
</nav> 
```

我确实有几页，我将它们添加到`menu-2`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:13:24.693

您不需要将 .selected 类添加到菜单中。WordPress 自动将以下两个类添加到当前菜单项。您可以将 .selected 类的代码放在这些类中，它会起作用..

```
current-menu-item
current_page_item 
```

# c# - 我应该能够位移>>一个字节数组吗？

> ID：15207903
> 
> 赞同：-1
> 
> 时间：2013-03-04T17:58:46.453
> 
> 标签：c#, bytearray, biginteger, bit-shift, overflowexception

我试图理解为什么 BigInteger 会引发溢出异常。我试图通过将 BigInteger 转换为 a`byte[]`并迭代地增加 shift 来可视化这一点，直到我看到异常发生的位置。

*   我应该能够位移>>一个字节[]，还是C#根本不能？

**导致异常的代码**

```
 uint amountToShift2 = 12;
        BigInteger num = new BigInteger(-126);
        uint  compactBitsRepresentation = (uint)(num >> (int)amountToShift2); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:24:26.767

关于您编辑的问题：

```
uint amountToShift2 = 12;
BigInteger num = new BigInteger(-126);
uint compactBitsRepresentation = (uint)(num >> (int)amountToShift2); 
```

位移可以正常工作并产生一个`BigInteger`值`-1`（负值）。

但是转换为`uint`抛出异常，因为`-1`超出了`uint`. `BigInteger`从to的转换`uint`不会“环绕” modulo `2**32`，而是简单地抛出。

你可以通过以下方式解决这个问题：

```
uint compactBitsRepresentation = (uint)(int)(num >> (int)amountToShift2); 
```

这不会抛出`unchecked`上下文（这是通常的上下文）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:07:39.263

C# 中的字节数组没有`>>`或`<<`移位运算符。您需要手动编写代码来执行此操作（注意脱落的位）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-03-04T18:07:43.007

有些事情告诉我，该`>>`运算符不适用于数组等引用类型，而是适用于原始类型。

你`int`的 s 实际上是由一系列字节表示的，所以说

`int i = 6;`

`i`表示为

```
00000000000000000000000000000110 
```

将`>>`所有位向右移动，将其更改为

```
00000000000000000000000000000011 
```

或者`3`

* * *

如果您确实需要移动字节数组，那么定义自己的方法将数组的所有项目移动到 1 个插槽上应该不会太难。不过，它将具有**O(n)**时间复杂度。

# core-data - 检查 iCloud 中的现有内容

> ID：15207904
> 
> 赞同：1
> 
> 时间：2013-03-04T17:58:51.443
> 
> 标签：core-data, icloud

检查 iCloud 中现有数据的最佳方法是什么？

我需要检查本地设备或 iCloud 上是否不存在数据，以便我可以下载它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:17:31.077

由于您包含了`core-data`标签，我假设您的意思是您使用的是 Core Data，而不是 iCloud 文件 API 或无处不在的键值存储。

借助 Core Data 内置的 iCloud 支持，您可以像不使用 iCloud 一样检查现有数据。创建核心数据堆栈后，您可以通过正常的核心数据获取来检查存在哪些数据。没有（公开的）本地数据与云数据的概念，只有一个数据存储恰好知道如何与 iCloud 通信。您无需明确启动下载——它们会自动发生。

*   在您调用 应用程序启动时`addPersistentStoreWithType:configuration:URL:options:error:`，Core Data 会在内部启动下载任何本地尚不可用的数据。因此，此方法可能会阻塞一段时间。如果它成功返回，则可以假定所有当前下载已完成。

*   如果在您的应用程序运行时出现新的更改，Core Data 将下载并导入它们，并在完成后发布`NSPersistentStoreDidImportUbiquitousContentChangesNotification`通知您刚刚发生的情况。

这一切都描述了 Core Data 的 iCloud*应该*如何工作。在实践中，您可能会发现它并不总是按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:40:51.023

感谢@Tom Harrington 指出，此错误与开发人员/编码无关 - 它纯粹与 iCloud/Apple/连接问题有关。

关于我找到的这个[SO 答案的更多信息。](https://stackoverflow.com/questions/14098022/icloud-time-out-using-icloud-core-data-magical-record)

# java - 索引 14 附近的未封闭组

> ID：15207906
> 
> 赞同：-3
> 
> 时间：2013-03-04T17:58:52.160
> 
> 标签：java, regex

我在这一行收到错误：

```
Pattern pattern = Pattern.compile(word + "\\(.*\\)"); 
```

它说：

```
Exception in thread "AWT-EventQueue-0" java.util.regex.PatternSyntaxException: Unclosed group near index 14 
```

我知道这个错误是当你留下没有转义的特殊字符但我在那里看不到任何..

**完整代码：**

```
 StyleConstants.setItalic(set, true);
                    for (String word : code.split("\\s")) {
                        Pattern pattern = Pattern.compile(word + "\\(.*\\)");
                        Matcher matcher = pattern.matcher(word);
                        while (matcher.find()) {
                            doc.setCharacterAttributes(matcher.start(), word.length(), set, true);
                        }
                    } 
```

代码是一个字符串。它分解代码并检查每个单词。如果单词匹配，则为其着色

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:09:45.137

我尝试了以下方法：

```
Pattern pattern = Pattern.compile("abcd" + "\\(.*\\)");
log.debug("RegEx: " + pattern); 
```

这很好用：

```
RegEx: abcd\(.*\) 
```

我只能假设您在`word`.

`word`如果您在编译时不知道 的值，则在调用`compile()`方法之前构建模式并记录它：

```
String regex = word + "\\(.*\\)";
System.out.println("Regex: \"" + regex + "\"");
Pattern pattern = Pattern.compile(regex); 
```

# c++ - OpenMP 并行线程

> ID：15207909
> 
> 赞同：1
> 
> 时间：2013-03-04T17:58:56.847
> 
> 标签：c++, performance, parallel-processing, openmp

我需要并行化这个循环，我虽然使用它是一个好主意，但我以前从未研究过它们。

```
 #pragma omp parallel for

for(std::set<size_t>::const_iterator it=mesh->NEList[vid].begin();
        it!=mesh->NEList[vid].end(); ++it){

    worst_q = std::min(worst_q, mesh->element_quality(*it));
} 
```

在这种情况下，循环没有并行化，因为它使用迭代器并且编译器无法理解如何分割它。

你能帮助我吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T23:13:02.527

OpenMP 要求并行循环中的控制谓词具有`for`以下关系运算符之一：`<`、`<=`或。只有*随机访问迭代器*提供这些运算符，因此 OpenMP 并行循环仅适用于提供随机访问迭代器的容器。仅提供双向迭代器。您可以使用显式任务来克服该限制。可以通过首先对每个线程变量的私有部分进行部分归约，然后对部分值进行全局归约来执行归约。`>``>=`*`std::set`*

 *```
double *t_worst_q;
// Cache size on x86/x64 in number of t_worst_q[] elements
const int cb = 64 / sizeof(*t_worst_q);

#pragma omp parallel
{
   #pragma omp single
   {
      t_worst_q = new double[omp_get_num_threads() * cb];
      for (int i = 0; i < omp_get_num_threads(); i++)
         t_worst_q[i * cb] = worst_q;
   }

   // Perform partial min reduction using tasks
   #pragma omp single
   {
      for(std::set<size_t>::const_iterator it=mesh->NEList[vid].begin();
          it!=mesh->NEList[vid].end(); ++it) {
         size_t elem = *it;
         #pragma omp task
         {
            int tid = omp_get_thread_num();
            t_worst_q[tid * cb] = std::min(t_worst_q[tid * cb],
                                           mesh->element_quality(elem));
         }
      }
   }

   // Perform global reduction
   #pragma omp critical
   {
      int tid = omp_get_thread_num();
      worst_q = std::min(worst_q, t_worst_q[tid * cb]);
   }
}

delete [] t_worst_q; 
```

（我假设`mesh->element_quality()`返回`double`）

一些关键点：

*   该循环仅由一个线程串行执行，但每次迭代都会创建一个新任务。这些很可能排队等待由空闲线程执行。
*   在构造的隐式屏障处等待的空闲线程在`single`创建任务后立即开始使用它们。
*   指向的值`it`在任务主体之前被取消引用。如果在任务主体内取消引用，`it`将会`firstprivate`为每个任务（即在每次迭代中）创建迭代器的副本。这不是你想要的。
*   每个线程在其私有部分执行部分缩减`t_worst_q[]`。
*   为了防止由于错误共享而导致性能下降`t_worst_q[]`，每个线程访问的元素被间隔开，以便最终在单独的高速缓存行中结束。在 x86/x64 上，缓存行是 64 字节，因此线程数乘以`cb = 64 / sizeof(double)`.
*   全局最小值减少在`critical`构造内部执行，以防止`worst_q`同时被多个线程访问。这仅用于说明目的，因为减少也可以通过并行区域之后的主线程中的循环来执行。

请注意，显式任务需要支持 OpenMP 3.0 或 3.1 的编译器。这排除了所有版本的 Microsoft C/C++ 编译器（它仅支持 OpenMP 2.0）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-06-06T15:16:33.877

## 随机存取容器

最简单的解决方案是将所有内容放入一个随机访问容器（如`std::vector`）并使用 OpenMP 青睐的基于索引的循环：

```
// Copy elements
std::vector<size_t> neListVector(mesh->NEList[vid].begin(), mesh->NEList[vid].end());

// Process in a standard OpenMP index-based for loop
#pragma omp parallel for reduction(min : worst_q)
for (int i = 0; i < neListVector.size(); i++) {
    worst_q = std::min(worst_q, complexCalc(neListVector[i]));
} 
```

除了非常简单之外，在您的情况下（`size_t`可以轻松复制的微小类型元素），这也是具有最佳性能和可扩展性的解决方案。

## 避免复制

但是，在与您的情况不同的情况下，您可能拥有不容易复制的元素（较大的元素）或根本无法复制。在这种情况下，您可以将相应的指针放入随机访问容器中：

```
// Collect pointers
std::vector<const nonCopiableObjectType *> neListVector;
for (const auto &entry : mesh->NEList[vid]) {
    neListVector.push_back(&entry);
}

// Process in a standard OpenMP index-based for loop
#pragma omp parallel for reduction(min : worst_q)
for (int i = 0; i < neListVector.size(); i++) {
    worst_q = std::min(worst_q, mesh->element_quality(*neListVector[i]));
} 
```

这比第一个解决方案稍微复杂一些，在小元素上仍然具有相同的良好性能，并且在较大元素上具有更高的性能。

## 任务和动态调度

由于其他人在他的回答中提出了 OpenMP 任务，我想对此发表评论。任务是一个非常强大的结构，但它们有巨大的开销（甚至随着线程数量的增加而增加），在这种情况下只会让事情变得更加复杂。

为了`min`减少使用 Tasks 是不合理的，因为在主线程中创建一个 Task 的成本*远远*超过了`std::min`它本身！

对于更复杂的操作`mesh->element_quality`，您可能认为 Tasks 的动态特性可以帮助您解决负载平衡问题，以防`mesh->element_quality`迭代之间的执行时间差异很大并且您没有足够的迭代来平衡它。但即使在这种情况下，也有一个更简单的解决方案：只需在我以前的解决方案之一中将`schedule(dynamic)`指令添加到您的行中，即可使用动态调度。`parallel for`它实现了相同的行为，但开销要少得多。*

# python - 为什么 __import__() 返回的是包而不是模块？

> ID：15207914
> 
> 赞同：0
> 
> 时间：2013-03-04T17:59:14.920
> 
> 标签：python, module, package, python-import

我有这个文件结构（点是我的工作目录）：

```
.
+-- testpack
     +-- __init__.py
     +-- testmod.py 
```

如果我用语句加载`testmod`模块`import`，我可以调用一个在其中声明的函数：

```
>>> import testpack.testmod
>>> testpack.testmod.testfun()
hello 
```

但是如果我尝试使用该`__import__()`功能做同样的事情，它就不起作用：

```
>>> __import__("testpack.testmod").testfun()

Traceback (most recent call last):
  File "<pyshell#7>", line 1, in <module>
    __import__("testpack.testmod").testfun()
AttributeError: 'module' object has no attribute 'testfun' 
```

实际上，它返回的是包`testpack`而不是模块`testmod`：

```
>>> __import__("testpack.testmod").testmod.testfun()
hello 
```

怎么会？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T18:03:37.593

这种行为在[文档](http://docs.python.org/2/library/functions.html#__import__)中给出：

> 当 name 变量的形式为 package.module 时，通常会返回顶级包（直到第一个点的名称），而不是按名称命名的模块。但是，当给定非空 fromlist 参数时，将返回按名称命名的模块。

...

> 语句 import spam.ham 导致此调用：
> 
> `spam = __import__('spam.ham', globals(), locals(), [], -1)`
> 
> 注意这里如何`__import__()`返回顶层模块，因为这是由 import 语句绑定到名称的对象。

另请注意顶部的警告：

> 这是日常 Python 编程中不需要的高级功能，与`importlib.import_module()`.

然后后来：

> 如果您只想按名称导入模块（可能在包中），请使用`importlib.import_module()`.

所以这里的解决方案是使用[`importlib.import_module()`](http://docs.python.org/2/library/importlib.html#importlib.import_module).

值得注意的是，Python 中名称两侧的双下划线意味着手头的对象大部分时间都不能直接使用。就像您通常应该使用`len(x)`over`x.__len__()`或`vars(x)`/ `dir(x)`over一样`x.__dict__`。除非您知道为什么需要使用它，否则这通常表明有问题。

# iis - ColdFusion 与基于 IIS 表单的身份验证

> ID：15207916
> 
> 赞同：1
> 
> 时间：2013-03-04T17:59:18.463
> 
> 标签：iis, coldfusion, forms-authentication

我正在尝试使用 ColdFusion 10 在 IIS 7.5 中设置[基于表单的身份验证](http://msdn.microsoft.com/en-us/library/xdt4thhy(v=vs.100).aspx)。它有点工作，但没有提示 ColdFusion 页面。是的，我确实启用了[集成管道](http://www.iis.net/learn/application-frameworks/building-and-running-aspnet-applications/how-to-take-advantage-of-the-iis-integrated-pipeline#htmlrewrite_content_rewrite)以强制对所有文件进行身份验证。然后，我在两个 ColdFusion 虚拟目录上[禁用了身份验证。](https://stackoverflow.com/questions/2425514/asp-net-forms-authentication-and-a-no-authentication-subfolder)不这样做会导致重定向到 /jakarta/isapi_redirect.dll 而不是真实/调用页面。

所以有趣的是，ColdFusion 文件 (.cfm .cfc) 似乎通过了身份验证，因为它们是由未经身份验证的虚拟目录处理的。？。（即使请求的页面仍然是被调用的页面..）

任何想法将不胜感激。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:44:42.533

好吧，我找到了一种解决方法，但我不确定它是否是正确/最佳的解决方案。基本上禁用匿名身份验证，除了 ColdFusion 虚拟目录和包含登录页面的文件夹。对任何人可能有的任何其他想法持开放态度。

现在，使用带有 .NET 对象的 ColdFusion 获得基于表单的身份验证... :)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-08T13:45:22.057

我发现没有调用 FormAuthentication iis 模块`isapi_redirect.dll(jakarta pages)`可能是因为`preCondition="managedHandler"`FormAuthentication 模块的默认前提条件。添加

```
<modules runAllManagedModulesForAllRequests="true" >; 
```

在`web.config`允许的事情按预期工作。

为失败的请求启用跟踪日志记录对于解决这个问题是必不可少的。这是win2016/cf2016/iis10。

# grouping - XSLT 2.0 如何为每个组循环添加值

> ID：15207920
> 
> 赞同：1
> 
> 时间：2013-03-04T17:59:28.323
> 
> 标签：grouping, xslt-2.0

我正在尝试计算 for 循环中的记录数及其值的总和（对于特定列）。请找到以下代码并建议我。

```
<xsl:for-each-group select="current-group()" group-by="CostCentre/PCCode">
                 <!-- variables for each pc code -->
                 <xsl:variable name="chargeRate" select="SpaceTariffGroup/ChargeRate"/>
                 <xsl:variable name="dedicatedArea"
                    select="sum((current-group()[SpaceType/ChargeBackType = $chargeBackTypeDedicatedArea]/(Area*CalculationFactor)))"/>            

                 <xsl:variable name="floorFactor"
                    select="$dedicatedArea div ($totalDedicatedAreaPerFloor )"/>`enter code here`
                 <xsl:variable name="floorCommonArea"
                    select="$floorFactor * $totalFloorCommonAreaPerFloor"/>
                 <xsl:variable name="dedicatedAndFloorCommonArea"
                    select="($dedicatedArea + $floorCommonArea)"/>                     

                 <xsl:variable name="totalChargedArea"
                    select="$dedicatedAndFloorCommonArea"/>
                 <xsl:variable name="totalChargedAmount"
                    select="$chargeRate * $totalChargedArea"/>
 <xsl:value-of select="$totalChargedArea"/>
 <xsl:text>,</xsl:text>   
 <xsl:value-of select="$totalChargedAmount"/>
enter code here
</xsl:for-each-group> 
```

会打印这样的东西。100,5000 200,5000 300,5000 400,5000

我想要这样的输出。100,5000 200,5000 300,5000 400,5000 4,20000 （最后一行是总记录，这些记录的值的总和）不知道我怎样才能得到它

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:29:32.710

那么你可以将每个组的结果存储在一个变量中，例如

```
<xsl:variable name="charges">
<xsl:for-each-group select="current-group()" group-by="CostCentre/PCCode">
                 <!-- variables for each pc code -->
                 <xsl:variable name="chargeRate" select="SpaceTariffGroup/ChargeRate"/>
                 <xsl:variable name="dedicatedArea"
                    select="sum((current-group()[SpaceType/ChargeBackType = $chargeBackTypeDedicatedArea]/(Area*CalculationFactor)))"/>            

                 <xsl:variable name="floorFactor"
                    select="$dedicatedArea div ($totalDedicatedAreaPerFloor )"/>`enter code here`
                 <xsl:variable name="floorCommonArea"
                    select="$floorFactor * $totalFloorCommonAreaPerFloor"/>
                 <xsl:variable name="dedicatedAndFloorCommonArea"
                    select="($dedicatedArea + $floorCommonArea)"/>                     

                 <xsl:variable name="totalChargedArea"
                    select="$dedicatedAndFloorCommonArea"/>
                 <xsl:variable name="totalChargedAmount"
                    select="$chargeRate * $totalChargedArea"/>
 <charge>
    <area><xsl:value-of select="$totalChargedArea"/></area>
    <amount><xsl:value-of select="$totalChargedAmount"/></amount>
  </charge>
</xsl:for-each-group>
</xsl:variable> 
```

然后您可以使用例如处理变量

```
<xsl:for-each select="$charges/charge">
  <xsl:value-of select="concat(area, ',', amount)"/>
</xsl:for-each> 
```

并输出总和

```
<xsl:value-of select="sum($charges/charge/amount)"/> 
```

# javascript - 如何动态地将高度添加到包含响应图像的 div

> ID：15207922
> 
> 赞同：0
> 
> 时间：2013-03-04T17:59:29.850
> 
> 标签：javascript, jquery, html, css, responsive-design

我在响应式容器中放置了一个简单的 jquery 图像滑块。滑块以响应方式工作，但高度以像素为单位设置，在其最大视口宽度下看起来不错，但正如您可以想象的那样，在较小的视口宽度下滑块和内容之间的距离太大。

我想知道是否有一种简单的方法使用 CSS 或 jQuery 来动态设置包含图像滑块的 div 的高度，以便它看起来适合所有视口宽度。

jQuery：

```
 function slideSwitch() {
            var $active = $('#slideshow DIV.active');

            if ( $active.length == 0 ) $active = $('#slideshow DIV:last');

            var $next =  $active.next().length ? $active.next()
                : $('#slideshow DIV:first');

            $active.addClass('last-active');

            $next.css({opacity: 0.0})
                .addClass('active')
                .animate({opacity: 1.0}, 1000, function() {
                    $active.removeClass('active last-active');
                });
        }

        $(function() {
            setInterval( "slideSwitch()", 5000 );
        }); 
```

的CSS：

```
 .responsive-container {
            width: 80%;
            margin: 0 auto;
        }

        .responsive {
            display: block;
            max-width: 100%;
            margin: 0 auto;
        }

        #slideshow {
            position:relative;
            height: 60%;
        }

        #slideshow div {
            position:absolute;
            top:0;
            left:0;
            z-index:8;
            opacity:0.0;
            background-color: #FFF;
        }

        #slideshow div.active {
            z-index:10;
            opacity:1.0;
        }

        #slideshow div.last-active {
            z-index:9;
        }

        #slideshow div img {
            display: block;
            border: 0;
            margin-bottom: 10px;
        } 
```

的HTML：

```
<div id="slideshow" class="responsive-container">
    <div class="active">
        <img class="responsive" src="img/slider/image1.jpg" alt="Slideshow Image 1" />  
    </div>

    <div>
        <img class="responsive" src="img/slider/image2.jpg" alt="Slideshow Image 2" />
    </div>

    <div>
        <img class="responsive" src="img/slider/image3.jpg" alt="Slideshow Image 3" />
    </div>                            
</div> 
```

有没有办法动态增加高度：

```
<div id="slideshow" class="responsive-container"> 
```

我不知道这是否重要，但最大图像尺寸是：531px 宽 x 400px 高。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-03-04T18:02:57.227

# 离散高度过渡

CSS[媒体查询](http://css-tricks.com/css-media-queries/)将允许您设置高度变化的离散宽度。

```
@media (max-width: 979px) and (min-width: 768px) {
  #slideshow {
    height: whatever;
  }
} 
```

有关这些如何工作的示例（如果您不熟悉它们），请在 CSS Tricks 网站上调整您的浏览器大小（请参阅上面的链接）。当您达到特定宽度时，您会看到布局发生变化。这就是实际的媒体查询。

# 连续高度过渡

对于连续的高度转换，您需要使用 Javascript。这是一个小 jQuery 设置，可能会帮助您入门。[**在 JSFiddle 上查看。**](http://jsfiddle.net/aq3uE/)

**javascript**

```
$(window).resize(function(){
  winWidth = $(window).width();
  $("#resize").height(winWidth*.3);
}); 
```

# objective-c - iOS应用中HTTP多部分数据的客户端解析

> ID：15207923
> 
> 赞同：0
> 
> 时间：2013-03-04T17:59:31.377
> 
> 标签：objective-c

我有一个来自服务器的多部分响应（它是 asp.net，托管在 IIS 上），如下所示：“--​​myboundary\r\n”+“Content-Type:image/jpeg\r\n”+ "内容长度：" + length.ToString() + "\r\n\r\n";

我想为帧（图像）添加时间戳属性。如何在上面的字符串中添加它，以及如何在我的客户端 iOS 应用程序中访问（提取）它？

我尝试使用 NSASCIIString 编码将 NSData 对象转换为 NSString ，但它是徒劳的。请帮我。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:22:26.427

通常，要从 HTTP 响应中获取字符串，请使用：

```
NSString *result = [[NSString alloc] initWithData:data encoding:NSUTF8StringEncoding]; 
```

# html - HTML5 视频流 - 下载

> ID：15207924
> 
> 赞同：0
> 
> 时间：2013-03-04T17:59:41.117
> 
> 标签：html, video, streaming

我读到 HTML5 视频标签无法流式传输视频...

流式传输是指仅从视频中间而不是从头开始下载视频的可能性。

显然，您可以将*currentTime*设置为中间，但在后台它将下载所有电影。

另一方面，YouTube 的 HTML5 播放器似乎可以正常播放。

我错过了什么？

谢谢...

# javascript - 我是否保证在 JavaScript 事件处理程序中获得具有目标属性的事件对象？

> ID：15207928
> 
> 赞同：2
> 
> 时间：2013-03-04T17:59:56.873
> 
> 标签：javascript, javascript-events

正如标题所说，我很好奇是否可以保证在 Javscript 事件处理程序中获取事件对象。我要问的主要原因是我见过像这样的 onClick 事件处理程序。

```
function(e) {
    if(e && e.target) {
        //Code in here
    }
} 
```

这对我来说似乎是错误的，但我知道 Javascript 在浏览器之间可能会有细微的差异。是否有适合检查事件对象的时间？还是事件目标？似乎您必须有一个目标才能触发一个事件。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:01:54.720

不。旧版本的 Windows 不会将事件参数传递给事件处理程序。他们将它放在一个全局变量`window.event`中，目标位于`.srcElement`. 除了那个例外，你应该总是得到一个事件结构。

旧版本 IE 的解决方法是：

```
function(e) {
    if (!e) {
        e = window.event;
        e.target = e.srcElement;
    }
    // code that uses e here
} 
```

但是，通常，这是由您用于安装事件处理程序的函数在更高级别上解决的。例如：

```
// add event cross browser
function addEvent(elem, event, fn) {
    if (elem.addEventListener) {
        elem.addEventListener(event, fn, false);
    } else {
        elem.attachEvent("on" + event, function() {
            // set the this pointer same as addEventListener when fn is called
            window.event.target = window.event.srcElement;
            return(fn.call(elem, window.event));   
        });
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:05:48.173

根据他们希望实现的浏览器兼容性，这可能是一个可接受的解决方案。**但是**，对于旧版本的 IE，该`event`对象是全局`window`对象的一部分。为了在这种情况下得到你想要的目标`window.event.srcElement`，因为没有`target`。

[`event`](http://msdn.microsoft.com/en-us/library/ie/ms535863%28v=vs.85%29.aspx)有关IE 对象的更多信息。

# php - Composer 是供服务器使用还是本地使用？

> ID：15207930
> 
> 赞同：7
> 
> 时间：2013-03-04T17:59:58.970
> 
> 标签：php, composer-php

[Composer](http://getcomposer.org)设计为安装在 Web 服务器上**还是**本地计算机上？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T18:03:15.987

It is designed for both.

You can use it in development (you will use `composer update` a lot then) and you can use it in production (you will install your dependencies with `composer install` then).

In development phrase, you define with which dependencies your project works. And in production, you make sure these dependencies are installed.

# php - 如何让 GROUP_CONCAT 的查询返回更多的一行？

> ID：15207936
> 
> 赞同：0
> 
> 时间：2013-03-04T18:00:13.333
> 
> 标签：php, mysql, sql, database, group-concat

```
TXNID PARENT_TXN_ID ITEM_NAME

5G161631H9141883L 商品总计
4HD251984H4919123 木工 101@Fri 04-05-2013 8:00 pm
4LA48638GR031562M 木工 101@Fri 04-05-2013 8:00 pm
6TU64611FM249252D 木工 101@Fri 04-05-2013 8:00 pm
7S953179AV7967542 木工 101@Fri 04-05-2013 8:00 pm
04916720G2800071A 木工 101@Fri 04-05-2013 8:00 pm
测试1 4HD251984H4919123 设置

```

以上是我的数据。这是我的查询。

```
SELECT ppv1.*,GROUP_CONCAT(ppv2.txn_id SEPARATOR ' <BR>') GC 
from paypal_valid ppv1
LEFT JOIN (SELECT txn_id,parent_txn_id from paypal_valid where parent_txn_id!='')
ppv2 ON ppv1.txn_id=ppv2.parent_txn_id
where ppv1.item_name!='Merchandise Total' and ppv1.parent_txn_id='' 
```

这仅返回 1 行...我认为它应该返回 5。我只是不确定为什么只返回一行。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T18:06:19.600

试试这个`group by`

```
 SELECT ppv1.*,GROUP_CONCAT(ppv2.txn_id SEPARATOR ' <BR>') GC 
 from paypal_valid ppv1
LEFT JOIN (SELECT txn_id,parent_txn_id from paypal_valid where parent_txn_id!='')
 ppv2 ON ppv1.txn_id=ppv2.parent_txn_id
where ppv1.item_name!='Merchandise Total' and ppv1.parent_txn_id=''
group by ppv1.txn_id
                ^^^-------//make sure u have this in your ppv1 table 
```

# php - Codeigniter 命令行错误 - PHP 致命错误：找不到类“CI_Controller”

> ID：15207937
> 
> 赞同：8
> 
> 时间：2013-03-04T18:00:29.010
> 
> 标签：php, codeigniter, command-line

遵循此处找到的用户指南说明：http: [//ellislab.com/codeigniter/user-guide/general/cli.html](http://ellislab.com/codeigniter/user-guide/general/cli.html)我无法通过命令行运行测试脚本。

我的控制器位于 /var/www/mysite/application/controllers/

```
 class Tools extends CI_Controller {

    public function message($to = 'World')
    {
        echo "Hello {$to}!".PHP_EOL;
    }
} 
```

在我的浏览器中，我可以访问

```
http://mysite/tools/message/ben 
```

并且该函数正确输出“Hello ben”

从终端我应该能够运行：

> $ php index.php 工具消息“Ben”

我的终端应该打印：“Hello Ben”

但是我收到以下错误：

> PHP 致命错误：在第 233 行的 /var/www/mysite/system/core/CodeIgniter.php 中找不到类“CI_Controller”

我的服务器非常标准；Ubuntu的灯。Codeigniter 也很标准，我通过命令行运行非 CI 脚本没有问题

我的 PHP 二进制文件仅位于 /usr/bin/php <--[这篇文章](https://stackoverflow.com/questions/10322587/codeigniter-command-line-cron-cpanel/11156257#11156257)提出了直接从 usr/bin/php 运行 CI 的问题，但是我没有运行共享的 PHP 服务，我不明白为什么会这样将对 PHP 执行 CI 脚本的方式产生影响。

任何帮助或只是关于如何调试的指示将不胜感激。

提前致谢。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-03-28T18:52:03.120

解决了！（部分）问题是 CodeIgniters 错误记录。

在 application/config/config.php 中，我修改了以下配置属性：

```
$config['log_threshold'] = 0; 
```

这将禁用日志记录，并允许`$ php index.php`执行。

如果有人能解释为什么 CI 只在 CLI PHP 上显示此错误 - 可能会帮助遇到此问题并需要通过错误登录来解决此问题的任何其他人。

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-06-25T13:32:13.300

要解决错误“找不到类'CI_Controller'”，请尝试`Application -> Config -> database.php`检查数据库详细信息，如*主机名*、*用户名*、*密码*和*数据库*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-10-16T00:10:50.953

致米扬：

我遇到了同样的问题，经过大约两个小时的代码跟踪以找出问题，似乎在使用原生 PHP load_class 函数时加载 CI_Controller 存在某种冲突。

我通过对 Common.php 文件进行以下更改来解决此问题（黑客，我知道）。

```
//$_log =& load_class('Log');
require_once('system/libraries/Log.php');
$_log = new CI_Log(); 
```

然后我的日志完全按照我想要的方式创建。希望这个 hack 有所帮助。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-03-04T21:10:45.360

该[站点](http://larrykagan.com/blog/view/CodeIgniter-from-the-Command-Line)说要从命令行运行 codeigniter，必须设置 $_SERVER['PATH_INFO'] 变量。

> $_SERVER['PATH_INFO'] 通常由 php 在发出 Web 请求时提供。但是，由于我们是从命令行调用此脚本，因此我们需要将环境的这一小部分模拟为 Web 请求。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-12-12T10:44:41.527

[这篇 Stack Overflow 帖子](https://stackoverflow.com/questions/31932372/codeigniter-fatal-error-class-ci-controller-not-found-after-upgrade-php-and)中提供的答案对我有用。

在 内`system/core/CodeIgniter.php`，在第 75 行左右，更改：

`set_error_handler('_exception_handler');`

到...

`set_exception_handler('_exception_handler');`

其他用户报告说，这为他们提供了更好的回溯来调试潜在问题，但对我来说，这实际上完全消除了问题。

# python - 为什么 setuptools 需要写字节码？

> ID：15207938
> 
> 赞同：5
> 
> 时间：2013-03-04T18:00:31.140
> 
> 标签：python, virtualenv, setuptools

如果您尝试`virtualenv`使用设置的环境变量运行`PYTHONDONTWRITEBYTECODE=true`，则会出现以下错误：

`The PYTHONDONTWRITEBYTECODE environment variable is not compatible with setuptools. Either use --distribute or unset PYTHONDONTWRITEBYTECODE.`

为什么 setuptools 需要编写字节码的能力？

我不是特别喜欢有`.pyc`文件，所以我喜欢防止它被写入。

（我不是在问如何解决这个问题；这很简单：只需`PYTHONDONTWRITEBYTECODE=""`在任何需要取消设置标志或全局取消设置的命令的开头添加）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-11-27T13:13:24.223

使用最新版本，`virtualenv`您将不会看到此错误。

# sharepoint - Sharepoint 2007 to 2010 - HTML Spaces being added " "

> ID：15207946
> 
> 赞同：4
> 
> 时间：2013-03-04T18:00:59.133
> 
> 标签：sharepoint, sharepoint-2010, sharepoint-2007

After we did the upgrade of Sharepoint 2007 to 2010 a number of Article Pages now have the HTML equivalent of a space actually showing up in the text. ( ) Has anyone ever heard of this & is there a way to remove the `&nbsp;` from the pages and replace with an actual space?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-12T05:42:36.760

确保您的 pageLayOuts 或母版页中有此行

**`<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />`**

如果不是，请尝试将其添加到 Head 标签中的 Master Pages 中，然后再次检查..

让我知道结果

谢谢

# jquery - jQuery DOM 事件在主干视图上不起作用

> ID：15207952
> 
> 赞同：1
> 
> 时间：2013-03-04T18:01:35.157
> 
> 标签：jquery, dom, backbone.js, backbone-views, backbone-events

我有一个观点，每次调用都会重新渲染视图中的元素，这是一段代码：

```
Project.Views.CheckinScheduledView = Backbone.View.extend({
tagName: 'div',
id:'CheckinScheduledView',
className:'section',
checkinsHtml: '',

initialize: function() {
    _.bindAll(this);

    this.checkinsCollections = new Project.Collections.Checkins();

    this.checkinsCollections.on('reset', this.render);
    this.checkinsCollections.fetch();
},

events: {
    'click .scheduled_checkin a':'deleteCheckin'
},

render: function() {
    var that = this;

    // HERE IS THE PROBLEM
    if($('li.scheduled_checkin').length) {
        $('li.scheduled_checkin').each(function() {
            $(this).css('display','none').empty().remove();
        });
    }

    if(Project.InfoWindow.length) {
        Project.InfoWindow[0].close();
    }

    _.each(this.checkinsCollections.models, function(item) {
        that.renderLocation(item);
    });

    $(this.el).html(this.template());
    this.renderCheckins();
    return this;
},

refreshData: function() {
    this.checkinsCollections.fetch();
} 
```

这是一个案例：

1.  打开主页
2.  点击checkIn（当前查看代码）
3.  回家
4.  视图渲染但将项目添加到列表中

图片

我第一次加载视图 ![我第一次加载视图](../Images/cee8f016b6f54dd2cb3a1625e8b31e39.png)

假设我去另一个视图，现在我回到这个视图 ![假设我去另一个视图，现在我回到这个视图](../Images/60cdfb02302679422279d2054d7e2ffb.png)

然后再次 ：（ ![然后再次](../Images/da85fd1e659823625da1d206eb4d7d6c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-06T18:43:31.803

从您的 jsfiddle 没有工作的 HTML 示例，在这个函数：

```
renderLocation: function(location) {
    this.checkinsHtml = this.checkinsHtml+'<li class="scheduled_checkin"><a data-id="'+location.attributes.scheduleId+'" href="#/checkin/" title="Delete: '+location.attributes.description+'">'+location.attributes.title+'</a></li>';
} 
```

我猜你在重新渲染视图时忘记重置 this.checkinsHtml 了。

**编辑**：为了更好的方法，您应该从模板呈现 html。

使用 Mustache.js 的示例

```
var template = '{{#models}}' +
               '<li class="scheduled_checkin">' +
                   '<a data-id="{{attributes.scheduleId}}" href="#/checkin/" title="Delete: {{attributes.description}}">{{attributes.title}}</a>' +
               '</li>' +
               '{{/models}}';
$('#scheduled_checkins .two-columns').html(Mustache.render(template, this.checkinsCollections)); 
```

# php - 来自数组的html输出逻辑

> ID：15207956
> 
> 赞同：2
> 
> 时间：2013-03-04T18:01:40.017
> 
> 标签：php, html, foreach, logic, output

我的数据来自数据库，并且一直是`grouped by` `day_id`，因此数组按 排序`day_id`。

提供代码+示例输出，有点难以用语言表达。

到目前为止，我从[这个公认的答案](https://stackoverflow.com/questions/1060622/php-blog-need-to-make-a-good-looking-archives-section)中得到了灵感，但我需要稍作调整。

```
$array = array(
            0 => array(
                'id' => '5',
                'day_id' => '1',
                'Foo' => array(
                    'id' => '28',
                    'name' => 'My day_id is 1'
                )
            ),
            1 => array(
                'id' => '6',
                'day_id' => '1',
                'Foo' => array(
                        'id' => '29',
                        'name' => 'My day_id is 1'
                )
            ),
            2 => array(
                'id' => '7',
                'day_id' => '2',
                'Foo' => array(
                     'id' => '30',
                     'name' => 'My day_id is 2'
                )
            ),    
            3 => array(
                'id' => '8',
                'day_id' => '3',
                'Foo' => array(
                       'id' => '31',
                      'name' => 'My day_is 3'
                )
            )
); 
```

我的代码输出它：

```
$day = 0;
foreach($array as $a) {

     // $a['day_id'] = 1, condition is true. output header once.
    if($day != $a['day_id']) {
        echo '<h3>The Day is ' . $a['day_id'] . '</h3>' . "\n";
    }

    // output the elements Foo key content.
    echo $a['Foo']['name'] . "\n";

    // store the current value to compare on the next iteration
    // $a['day_id'] will eventually be 2, causing the condition to fire again.
    $day = $a['day_id']; 
} 
```

这输出：

```
<h3>The Day is 1</h3>
My day_id is 1
My day_id is 1

<h3>The Day is 2</h3>
My day_id is 2

<h3>The Day is 3</h3>
My day_is 3 
```

我现在想将每个“Day”包装在一个 DIV 中，但我无法弄清楚逻辑。如果我用`<h3>`打开的 div 替换 ，我不知道在哪里放置关闭`</div>`。到目前为止，我的尝试只是导致每天都有一个`open`div，但不是一个封闭的，所以它们是嵌套的，而不是分开的。

我不能放，`</div><div class="day-X">`因为一开始会有一个额外`</div>`的东西会破坏布局。

期望的输出：

```
<div class="day-1">
  <h3>The Day is 1</h3>
  My day_id is 1
  My day_id is 1
</div>
<div class="day-2">
  <h3>The Day is 2</h3>
  My day_id is 2
</div>

<div class="day-3">
  <h3>The Day is 3</h3>
  My day_is 3
</div> 
```

希望这是有道理的-谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:18:22.573

您将需要循环两次，一次用于日期，另一次用于具有这一天的项目。在不使用任何其他 SQL 查询的情况下，您需要先将日期存储在数组中。然后您可以循环播放日期，并且对于每一天，您将回显`<div>`和日期标题，最后您将回显`</div>`.

在 foreach 中，您可以使用相同的数组再次循环以检查每个项目是否在同一天。如果是，则回显项目的名称，否则不做任何事情。

我已经测试了这段代码，你可以检查一下，如果你有任何问题，请告诉我。

```
foreach($array as $day){
    $days[] = $day['day_id']; // store all the days in an array
}
    // now days[] has [1,1,2,3]

$days = array_unique($days); // get unique days only no duplicated 

    //now days[] has [1,2,3]

foreach($days as $d){ // for each day

    echo '<div class = "day-'.$d.'">';
     echo '<h3>The Day is ' . $d . '</h3>' . "\n";

    foreach($array as $a) { // check all other items if the item has the same day then echo 

        if($a['day_id'] == $d){

            echo $a['Foo']['name'] . "\n";
        }
    }

    echo '</div>';

} 
```

输出：

```
<div class = "day-1">
    <h3>The Day is 1</h3>
        My day_id is 1
        My day_id is 1
</div>

<div class = "day-2">
    <h3>The Day is 2</h3>
        My day_id is 2
</div>

<div class = "day-3">
    <h3>The Day is 3</h3>
        My day_is 3
</div> 
```

# r - 多个样本的 F 检验

> ID：15207958
> 
> 赞同：-2
> 
> 时间：2013-03-04T18:01:46.777
> 
> 标签：r, statistics

我有 3 个数据系列 A、B、C、D 和 E。如何使用 F 检验测试 A 和 B 以及 B 和 C 等的平均值是否共同相等。我想在 R 中做到这一点。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-04T18:40:01.287

补资料：

```
A <- runif(100); B <- runif(100); C <- runif(100) 
```

将其折叠成一个数据框：

```
d <- data.frame(group=rep(c("A","B","C"),each=100),y=c(A,B,C)) 
```

运行单向方差分析：

```
anova(lm(y~group,data=d))
## Analysis of Variance Table
## 
## Response: y
##            Df  Sum Sq  Mean Sq F value Pr(>F)
## group       2  0.2346 0.117310  1.3734 0.2548
## Residuals 297 25.3677 0.085413 
```

# javascript - Ajax - How to wait until php is done?

> ID：15207963
> 
> 赞同：0
> 
> 时间：2013-03-04T18:01:55.203
> 
> 标签：javascript, jquery, ajax

I am a complete noob to Ajax so please forgive me if this is a completely asinine piece of code:

```
for (var i=0; i<11; i++) {
    jQuery('#position').html(i);
    var offset = jQuery('#offset').html();
    var postcall = 'controller.php?url='+encodeURIComponent(scrapurl)+'&scrape_absolute='+absoluteep+'&scrape_season='+season+'&scrape_show='+showslug+'&scrape_defimg='+encodeURIComponent(defaultimg)+'&offset='+offset;
    jQuery.post(postcall,function(data){
    jQuery('#offset').html(data);
    });
  } 
```

The goal here is to execute controller.php with the given values and plug 'offset' back into each call using the returned info. It works but it runs from 0 to 10 instantly and my webserver rejects the subsequent calls.

My goal is to make sure it doesn't call the php again until the last operation has completed.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:07:16.337

*关键是在*回调函数中进行下一次 AJAX 调用。这样，您的下一篇文章在第一次完成之前不会出现。在您的代码中，因为`.post()`是非阻塞（异步），它会立即继续循环，递增`i`/`#position`并触发下一个`.post()`。

为了解决这个问题，将你封装`.post()`在一个包装函数中。有一个计数器来跟踪它被调用了多少次。从 的回调中调用该函数`.post()`，您最终会得到一个递归函数，该函数将按顺序执行调用：

```
var position=0;

function doNextAJAXPost() {
    if(position < 11) {
        jQuery('#position').html(position);
        position++;
        var offset = jQuery('#offset').html();

        jQuery.post('controller.php?url='+encodeURIComponent(scrapurl)+'&scrape_absolute='+absoluteep+'&scrape_season='+season+'&scrape_show='+showslug+'&scrape_defimg='+encodeURIComponent(defaultimg)+'&offset='+offset, function(data){
            jQuery('#offset').html(data);
            doNextAJAXPost();
        });
    }
}

doNextAJAXPost(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:11:15.937

使用自执行递归函数

```
(function callself(i) {
  jQuery('#position').html(i);
  var offset = jQuery('#offset').html();
  var postcall = 'controller.php?url='+encodeURIComponent(scrapurl)+'&scrape_absolute='+absoluteep+'&scrape_season='+season+'&scrape_show='+showslug+'&scrape_defimg='+encodeURIComponent(defaultimg)+'&offset='+offset;
  jQuery.post(postcall,function(data){
    jQuery('#offset').html(data);
    i++;
    if ( i < 11 ) callself(i);
  });
})(0) 
```

# javascript - 现有的 javascript 框架来处理会话超时警告？

> ID：15207964
> 
> 赞同：0
> 
> 时间：2013-03-04T18:01:57.557
> 
> 标签：javascript, session, session-timeout

我需要能够在到期之前向用户显示会话即将到期的消息。如果用户什么都不做，则页面将重定向到会话过期页面。这种需求并不奇怪。

所以我希望一些 JavaScript 库或框架可以帮助这样一个项目。我现有的解决方案实际上打开了一个新窗口。但是现在随着 iPad 的普遍使用，我看到了一些解决方案，它会做一些动态 HTML 来提示用户在当前页面上。

我有现有的代码可以进行 AJAX 调用来决定用户会话何时到期。（也许网站在多个标签中打开）。所以我可以处理何时显示消息的时间。

我只是希望可能有一些通用代码来帮助创建用于超时警告的 UI。

从技术上讲，我们的大多数页面都是 Java 页面。但是使用 Javascript 解决方案，显示的页面应该不那么重要了。

我希望 JQuery 或 YUI 有一些东西。但到目前为止我还没有找到它。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:07:02.387

你可能会考虑一个“toast”插件，这个名字的意思是消息就像从烤面包机里弹出一样；请参阅以下内容：[https ://ux.stackexchange.com/questions/11998/what-is-a-toast-notification](https://ux.stackexchange.com/questions/11998/what-is-a-toast-notification)

对于实际的 jquery 插件，有以下内容：[https ://github.com/azcoov/jQuery-Toaster](https://github.com/azcoov/jQuery-Toaster)

# iphone - add two background image for selected and unselected UISegments iphone

> ID：15207966
> 
> 赞同：0
> 
> 时间：2013-03-04T18:02:04.107
> 
> 标签：iphone, uisegmentedcontrol, setbackground

I have two segment buttons (1 and 2) I want to add a background image one for selected segment and another image for unselected segment.How can I do that?

Here is what I have so far,should I set the background image here?:

```
- (void)selectWithSegment:(UIButton *)sender
{
    for (UIButton *button in self.segments) {
        if (button == sender) {
            if (self.staySelected) {
                button.backgroundColor = [UIColor colorWithRed:17.0/255.0 green:17.0/255.0 blue:17.0/255.0 alpha:1.0];
                [button setBackgroundImage:nil forState:UIControlStateNormal];
            }
            if ([self.delegate respondsToSelector:@selector(segmentControl:didSelectSegment:)]) {
                [self.delegate segmentControl:self didSelectSegment:sender];
            }
        } else {
            [self decorateButton:button];
        }
    }
} 
```

how can I set image1.png and image2.png for for selected and unselected segments?Can someone help me with the implementation?

![enter image description here](../Images/024cd12162a9591a0ad1096bb4669368.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:09:03.840

我不知道任何其他方式来处理这种情况，但我认为这可以帮助你：

使 UISegmentControl 的 IBOutlet 设置 IBAction 为 valueChange 事件后，具有以下操作：

```
-(IBAction)selectedSegment:(id)sender{
    int totalNumberOfSegment = 5;
    UISegmentedControl *tmpSig = (UISegmentedControl *)sender;
    NSLog(@"Inside sender method");

    for (int i = 0; i < totalNumberOfSegment; i++) {
        [tmpSig setImage:[UIImage imageNamed:@"unselect.png"] forSegmentAtIndex:i];
    }

    [tmpSig setImage:[UIImage imageNamed:@"select.png"] forSegmentAtIndex:tmpSig.selectedSegmentIndex];

} 
```

# google-chrome - Adding to the “right-click” menu for a Google Chrome extension

> ID：15207967
> 
> 赞同：3
> 
> 时间：2013-03-04T18:02:06.550
> 
> 标签：google-chrome, google-chrome-extension, right-click

So most Google Chrome Extension have an "Options" Page, which is navigable by right-clicking on the extension icon.

Is it possible to add another entry to ***that*** right-click menu? Just when you're right-clicking your extension icon, not adding to the browser context menu in general.

For example under the "Options" option have an "Enable/Disable Alerts" option which changes dynamically between "Enable Alerts" and "Disable Alerts"

Or is this only possible by adding to the general right-click browser context menu using the ContextMenu APIs?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-05T11:26:46.337

到目前为止，只能在[**Browser View Port中添加**](http://www.quirksmode.org/mobile/viewports.html)[**上下文菜单**](https://developer.chrome.com/extensions/contextMenus.html)。[](http://www.quirksmode.org/mobile/viewports.html)

# apache - 无法从 mod_lua 连接到 postgresql

> ID：15207968
> 
> 赞同：3
> 
> 时间：2013-03-04T18:02:07.493
> 
> 标签：apache, postgresql, lua, mod-lua

我已经下载并安装了 Apache 2.4.4（现在带有 mod_lua 模块）。像这样启用它：

--httpd.conf--

```
LoadModule lua_module modules/mod_lua.so
AddHandler lua-script .lua 
```

并运行了一个简单的脚本，它可以工作。

--htdocs/hello.lua--

```
function handle(r)
    r.content_type = "text/html"
    r:puts("Hello Lua World!\n")
end 
```

我现在想连接到本地 pg 数据库，但无法正常工作。

```
function handle(r)
    r.content_type = "text/html"
    r:puts("Hello Lua World!\n")
    local db, err = r:dbacquire("postgres", "postgres://user:secret@localhost/db0")
    if not err then
     r:puts("connected!")
    else
     r:puts("couldn't connect!")
    end
end 
```

没有任何错误消息。我是否缺少进一步的配置？

感谢您的任何意见！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-22T12:09:19.313

Apache httpd 基于提供数据库连接的[APR ；](http://apr.apache.org/)所以请确保您的 APR 安装支持您要使用的数据库层。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-22T14:05:37.083

原来我的驱动程序名称和连接字符串错误。用这个替换问题中的 dbacquire 行应该可以正常工作。

```
db = r:dbacquire("pgsql", "hostname=localhost dbname=foo user=bar password=baz") 
```

更好的是，通过像这样将这些嵌入到 httpd.conf

```
DBDriver pgsql
DBDParams "hostname=localhost dbname=foo user=bar password=baz" 
```

您可以通过在您的 lua 脚本中执行此操作来逃脱

```
db = r:dbacquire()
--start using your db here 
```

# selenium - 如何在 PHPUnit 中使用正则表达式 waitForAlertPresent？

> ID：15207969
> 
> 赞同：0
> 
> 时间：2013-03-04T18:02:10.687
> 
> 标签：selenium, phpunit, selenium-ide

我有一个 JavaScript 警报，上面写着“该回合已结束”。或“回合结束。您不能执行此操作。”

我现在在 PHPUnit 中的代码是：

```
$this->waitForAlertPresent('The round is closed.'); 
```

如果警报为“回合已结束。”则测试通过，但如果警报为“回合已结束。您不能执行此操作。” 它失败。

是否可以对 waitForAlertPresent 使用正则表达式？在 PHPUnit 中？

我在想我可以尝试waitForCondition并做preg_match，但我认为它不起作用，因为它会弹出一个警报

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-04T19:18:51.820

你怎么不知道警报中的文本应该是什么？通常，您应该针对您设置的内容进行测试。如果不一样，则测试失败。

除此之外，诸如...

```
$this->assertEquals('The round is closed.', $this->getAlert()); 
```

...应该为你工作。您已经找到[SeleniumTestCaseTest](https://github.com/sebastianbergmann/phpunit-selenium/blob/master/Tests/SeleniumTestCaseTest.php)了吗？它非常简单地展示了 PHPUnit_Selenium 的可能性。

从我自己的经验来看，[Selenium2TestCase](https://github.com/sebastianbergmann/phpunit-selenium/blob/master/Tests/Selenium2TestCaseTest.php)（使用 Selenium webdriver 而不是注入的 javascript）似乎更加一致，也许值得一试。

**编辑** 我不太熟悉 Selenium RC / SeleniumTestCase，但`$this->getAlert()`应该给你警报框的文本。那么它当然会像`$this->assertContains("closed", $this->getAlert())`.

但是，当您更改警报消息时，也许最好也更新您的测试......

# c# - 将 i 值添加到控件名称

> ID：15207971
> 
> 赞同：3
> 
> 时间：2013-03-04T18:02:14.713
> 
> 标签：c#, asp.net, controls

我在一页上有十个标签。我想让这些在页面加载时的 for 循环中不可见。

我试过这个（不起作用）：

```
 for (int i = 0; i < 10; i++)
    {
        my_lbl+i.Visible = false;
    } 
```

因此，它应该这样做：

```
my_lbl1.Visible = false;
my_lbl2.Visible = false;
my_lbl3.Visible = false;
my_lbl4.Visible = false; 
```

ETC...

有没有办法做到这一点？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-03-04T18:04:53.777

将所有标签放入一个集合中：

```
private List<Label> labels = new List<Label>{my_lbl1, my_lbl2, my_lbl3, my_lbl4}; 
```

然后你可以迭代整个集合：

```
foreach(var label in labels)
    label.Visible = false; 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-03-04T18:06:47.173

做一个[`List`](http://msdn.microsoft.com/en-us/library/6sh2ey19.aspx)；

```
List<Label> yourlabels = new List<Label>{my_lbl1, my_lbl2, my_lbl3...}; 
```

并使用`foreach`循环使它们可见。

```
foreach(var label in yourlabels)
{
   label.Visible = false;
} 
```

我不知道是否有更好的方法，但这种方法对我来说似乎是合乎逻辑的。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-03-04T18:10:52.820

将标签放在集合中（如先前的答案所建议的那样）是一个很好的解决方案。您还可以使用`FindControl`.`Page`

```
for (int i = 0; i < 10; i++)
{
    this.FindControl("my_lbl" + i.ToString()).Visible = false;
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-03-04T18:10:52.007

或者，您可以将它们放入`dictionary`：

```
 Dictionary<string, Label> nameOfDict = new Dictionary<string, Label>();

    nameOfDict.Add("label1", label1);
    nameOfDict.Add("label2", label2); 
```

为了...

```
nameOfDict ["label" + incrementator].visible = false; 
```

或者，将它们动态创建到标签数组中。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-03-04T18:12:07.783

我想你可以利用 Page 的 FindControl 方法：

```
for (int i = 0; i < 10; i++)
{
    FindControl(string.Format("my_lbl{0}", i)).Visible = false;
} 
```

但是，如果没有找到控制，请检查案例。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-03-04T18:09:16.347

如果您确定要取消选中**groupbox 中的所有复选框**，也可以这样做：

```
foreach (var item in groupBox1.Controls)
{
    if (item.GetType() == typeof(CheckBox))
    {
        ((CheckBox)item).Checked = true;
    }
} 
```

使用 LINQ：

```
foreach (var item in groupBox1.Controls.Cast<object>().Where(item => item.GetType() == typeof(CheckBox)))
{
    ((CheckBox)item).Checked = true;
} 
```

# magento - Uninstall the Magento extension with its associated database tables and settings

> ID：15207972
> 
> 赞同：3
> 
> 时间：2013-03-04T18:02:19.377
> 
> 标签：magento

I have created the Magento extension. I have installed and uninstalled it. During the uninstallation, what I found that the associated database tables are not being deleted and the settings from the `core_config_data` and `core_resource`. Can somebody help me?

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-03-04T18:17:11.877

删除扩展名的文件时，存储在数据库中的数据（专用表和配置`core_config_data`）不会被删除。

为此，您有两个选择，创建一个 sql 升级设置以删除这些条目，然后升级您的扩展，或者在 phpmyadmin 中手动进行。

即使不推荐，我总是使用第二个，我只是运行查询喜欢

```
DROP TABLE 'mytable';
DELETE FROM 'core_config_data' WHERE path LIKE '%mymodule%'; 
```

当然，最干净的方法是另一种方法，在 sql 文件中创建这些请求，从您的版本升级到下一个版本，然后通过升级`etc/config.xml`扩展中的版本来运行它。

如果扩展名不是您的，我建议查看模块文件夹中的`system.xml`和/或其他 xml 文件`etc/`以查找存储在 core_config_data 中的信息，然后在 sql/ 文件夹中的所有文件中查找其他信息（表、列、行添加）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-03-05T02:56:31.923

对于某些扩展，添加了与属性相关的附加条目。因此，除了从 core_config_data 中删除条目之外，还需要将其删除。

```
$eav->addAttribute('customer', 'some_property', array(
    'label'     => 'some label',
    'type'      => 'varchar',
    'input'     => 'text',
    'visible'   => true,
    'required'  => true,
    'position'  => 1,
)); 
```

# r - R：根据因子身份将两行分组为新行

> ID：15207974
> 
> 赞同：3
> 
> 时间：2013-03-04T18:02:28.650
> 
> 标签：r

在一个大型数据框中，我正在尝试创建一个新行，该行根据另一个因素的身份对来自其他行的特定数据进行分组。以下是一些示例数据：

```
> Species    Status    Value
> A         Introduced   10
> A          Native      3
> B          Crypt       6
> C         Introduced   19
> C          Native      4 
```

对于每个物种，我想创建一个新行，它只获取状态“引入”或“地穴”的数据，而忽略“原生”状态中的数据。每个物种要么只有“引进”和“本地”的数据，要么只有“地穴”的数据。

因此，我想要的输出将如下所示：

```
> Species    Status    Value
> A         Introduced   10
> A          Native      3
> A         IC.Total     10
> B          Crypt       6
> B         IC.Total     6
> C         Introduced   19
> C          Native      4
> C         IC.Total     19 
```

for 循环是解决此问题的最佳方法，还是有更优雅的方法？任何建议都会非常感谢您的帮助！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:19:41.543

以下使用该`data.table`包。
假设您的原始 data.frame 被称为`myDat`：

```
library(data.table)
myDT <- data.table(myDat, key="Species")

# Creates a new DT, of only the Speices column
myDT2 <- setkey(unique(myDT[, list(Species)]), "Species")

# Add IC.Total values
myDT2[myDT[Status=="Introduced"], c("Status", "ValueC") := list("IC.Total", Value)]

# Add Crypt values
myDT2[myDT[Status=="Crypt"], c("Status", "ValueC") := list("Crypt", Value)]

# fix the column name
setnames(myDT2, "ValueC", "Value")

# combine and sort by speicies
myDT <- setkey(rbind(myDT, myDT2), "Species")

myDT
#    Species     Status Value
# 1:       A Introduced    10
# 2:       A     Native     3
# 3:       A   IC.Total    10
# 4:       B      Crypt     6
# 5:       B      Crypt     6
# 6:       C Introduced    19
# 7:       C     Native     4
# 8:       C   IC.Total    19 
```

* * *

请注意，如果您不想重复`crypt`计数，只需取出上面的那一行。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-03-04T18:20:39.890

您可以使用`merge`and `aggregate`（即使没有任何东西可以聚合）：

```
merge(mydf, 
      cbind(aggregate(Value ~ Species, mydf, sum, 
                      subset = c(Status != "Native")), 
            Status = "IC.Total"),
      all = TRUE)
#   Species     Status Value
# 1       A Introduced    10
# 2       A     Native     3
# 3       A   IC.Total    10
# 4       B      Crypt     6
# 5       B   IC.Total     6
# 6       C Introduced    19
# 7       C     Native     4
# 8       C   IC.Total    19 
```

我使用`aggregate`它是因为它有一个方便的参数，可以让您对数据进行子集化。在这种情况下，我们对“Native”不感兴趣。此外，我们知道对于一个物种，我们永远不会同时拥有“Introduced”和“Crypt”，并且我们知道“Introduced”或“Crypt”永远不会有多个值，因此将`sum`其用作我们的聚合函数不会不要改变任何东西。

* * *

### 更新

即使您有多个“值”变量（正如您在评论中指出的那样），此解决方案背后的这一概念仍然有效，但需要进行一些细微的修改，如下所示。

首先，让我们整理一些数据：

```
mydf <- data.frame(
  Species = c("A", "A", "B", "C", "C"),
  Status = c("Introduced", "Native", "Crypt", "Introduced", "Native"),
  Value1 = c(10, 3, 6, 19, 4),
  Value2 = c(6, 8, 12, 19, 5),
  Value3 = c(18, 19, 14, 13, 2))
mydf
#   Species     Status Value1 Value2 Value3
# 1       A Introduced     10      6     18
# 2       A     Native      3      8     19
# 3       B      Crypt      6     12     14
# 4       C Introduced     19     19     13
# 5       C     Native      4      5      2 
```

其次，和以前一样使用`aggregate`and `merge`，但要注意细微的差别。首先，我们不能使用`subset`之前的方式，所以不是聚合整个数据集，而是只聚合我们感兴趣的行。其次，我们添加了“状态”作为分组变量，它应该与您所描述的当前数据结构相比，您的结果不会产生任何影响。第三，在我们聚合之后，我们需要删除“状态”列并添加一个新的状态列（这就是`[-2]`代码正在做的 - 删除第二列。）

在这里，所有内容都在一个整洁的包装中：

```
merge(mydf, 
      cbind(aggregate(. ~ Species + Status, 
                      mydf[mydf$Status != "Native", ], sum)[-2], 
            Status = "IC.Total"),
      all = TRUE)
#   Species     Status Value1 Value2 Value3
# 1       A Introduced     10      6     18
# 2       A     Native      3      8     19
# 3       A   IC.Total     10      6     18
# 4       B      Crypt      6     12     14
# 5       B   IC.Total      6     12     14
# 6       C Introduced     19     19     13
# 7       C     Native      4      5      2
# 8       C   IC.Total     19     19     13 
```

# ios - 数组类型“int [16]”不可分配

> ID：15207977
> 
> 赞同：10
> 
> 时间：2013-03-04T18:02:38.580
> 
> 标签：ios, objective-c

我正在使用最新的 SDK 开发一个 iOS 应用程序。

我想对`.mm`文件执行此操作：

```
@interface MyClass ()
{
   int _cars[16];

   ...
}

@end

@implementation MyClass

-(id)init
{
    self = [super init];

    if (self)
    {
        _cars = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0};
    }

    ...
} 
```

但我收到以下错误：

```
Array type 'int [16]' is not assignable 
```

我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T18:04:59.710

如果您只想初始化数组：

```
int _cars[16] = {0}; 
```

删除多余的零是安全的，编译器会找出它们。不可能在 C 中分配整个数组，这就是编译器在您的情况下抱怨的原因。只能初始化它们，并且仅当作为声明的一部分完成时，分配才被认为是初始化。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-03-04T18:05:23.520

在这种情况下，Objective-C++ 与 C、Objective-C 或 C++ 没有什么不同。声明数组时必须初始化数组：

```
int _cars[16] = { 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}; 
```

数组不是可分配的左值。

# android - How to get week dates in SQLite database

> ID：15207986
> 
> 赞同：0
> 
> 时间：2013-03-04T18:03:00.097
> 
> 标签：android, sqlite

I am developing android application. One of my application table has "foo_date" as column name. and data type is TEXT. I have following data in my table

```
primary key  | foo_date  | foo_value
--------------------------------------
1             2013-3-1    100

2             2013-3-2    2

3             2013-3-4    100

4             2013-3-3    1000 
```

my requirement is to get data for the current week(i.e. 2013-3-4 to 2013-3-10). When i write below query, i am getting all data except row # 3

```
select * from foo_tbl where foo_date between '2013-3-4' and '2013-3-10'; 
```

How do I write `sqlite` query so that it includes all data for current week?

Thansk Chintan

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T18:36:45.603

您的问题是您以无法轻松比较的格式存储了日期；字符`1`在前`4`，所以`2013-3-10`比较小于`2013-3-4`。

如[文档](http://www.sqlite.org/datatype3.html#datetime)所述，您应该使用 ISO 日期格式`yyyy-mm-dd`。使用恒定的字段大小，您可以使用具有有效字符串比较的查询：

```
SELECT * FROM foo WHERE foo_date BETWEEN '2013-03-04' AND '2013-03-10' 
```

或使用[日期函数](http://www.sqlite.org/lang_datefunc.html)来计算星期：

```
SELECT * FROM foo WHERE strftime('%W', foo_date) = '09' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:43:15.947

首先，将日期存储为标准 sqlite 时间字符串格式（即 YYYY-MM-DD）。然后，你可以使用这个：

```
select * from foo where strftime('%W', foo_date) == strftime('%W', 'now') 
```

选择与 now 具有相同周**数****的**行。

# sql - 从脚本中获取 sql 日志文件名

> ID：15207988
> 
> 赞同：4
> 
> 时间：2013-03-04T18:03:07.670
> 
> 标签：sql, sql-server-2008, tsql

我们有一些测试数据库，我们将测试索引放入其中，并且由于我们删除表的内容并重新填充它，日志文件很快变得臃肿。

多亏了 Stack Overflow，我找到了一些脚本，并将它们放在一起来做我需要的事情。

这是脚本：

```
USE SSSIndexes
GO
ALTER DATABASE SSSIndexes SET RECOVERY SIMPLE WITH NO_WAIT
GO
DBCC SHRINKFILE(N'SSSIndexes_Log', 1)   <-- my issue is here
GO 
```

问题是日志文件名。有没有一种方法可以获取日志文件名，而无需手动查找并将其包含在脚本中，以使这部分自动化？

顺便说一句，我们从来没有打算恢复这个数据库。这些是临时索引。

谢谢！

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-03-04T18:16:17.917

```
USE SSSIndexes
GO
ALTER DATABASE SSSIndexes SET RECOVERY SIMPLE WITH NO_WAIT
GO
DECLARE @Name NVARCHAR(50)

DECLARE cur CURSOR FOR
SELECT [name]
FROM [sys].[database_files] 
where [type] = 1

OPEN cur
FETCH NEXT FROM cur INTO @Name
WHILE @@FETCH_STATUS = 0
BEGIN
    DBCC SHRINKFILE(@Name, 1)
    FETCH NEXT FROM cur INTO @Name
END
CLOSE cur
DEALLOCATE cur 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-06-28T06:13:44.673

您可以使用它来生成用于截断特定服务器上所有数据库的日志文件的脚本。要坚持特定的数据库，请使用过滤器。

```
SELECT
' USE [' + name + ']; GO

-- Truncate the log by changing the database recovery model to SIMPLE.
ALTER DATABASE [' + name + '] SET RECOVERY SIMPLE;
GO

-- Shrink the truncated log file to 1 MB.
DECLARE @logname varchar(128);
SELECT TOP 1 @logname=[name] FROM [' + name + '].[sys].[database_files] WHERE [type] = 1;
DBCC SHRINKFILE (@logname, 1);
GO

-- Reset the database recovery model.
ALTER DATABASE [' + name + '] SET RECOVERY FULL;
GO

' AS qry FROM master.dbo.sysdatabases
WHERE dbid > 6 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-07-17T02:57:01.487

警告！！！：您应该只在测试数据库服务器上执行此操作。生产数据库通常希望具有完整的恢复模式。测试您通常不关心的数据库。

扩展 Abdul 的答案（我很难让它在新行中显示）和 Dis 的答案，这会找到第一个恢复 FULL 的数据库，将其设置为简单并缩小它......只需继续单击执行，直到它返回 null

```
declare @dbname nvarchar(50)
declare @logfilename nvarchar(100)
select top(1) @dbname = name from sys.databases where recovery_model_desc <> 'SIMPLE' AND name <> 'tempdb'

declare @shrinkdb nvarchar(500)
set @shrinkdb = 'USE master 
ALTER DATABASE [' + @dbname + '] SET RECOVERY SIMPLE 
'
select @shrinkdb
execute sp_executesql @shrinkdb

set @shrinkdb = 'USE [' + @dbname + ']

DECLARE @Name NVARCHAR(50)

DECLARE cur CURSOR FOR
SELECT [name]
FROM [sys].[database_files] 
where [type] = 1

OPEN cur
FETCH NEXT FROM cur INTO @Name
WHILE @@FETCH_STATUS = 0
BEGIN
    DBCC SHRINKFILE(@Name, 1)
    FETCH NEXT FROM cur INTO @Name
END
CLOSE cur
DEALLOCATE cur

'

select @shrinkdb
execute sp_executesql @shrinkdb 
```

# postgresql - Postgres 数据库链接到单独的 Heroku 环境

> ID：15207992
> 
> 赞同：0
> 
> 时间：2013-03-04T18:03:18.817
> 
> 标签：postgresql, heroku

使用这篇文章：[Heroku 开发环境](https://devcenter.heroku.com/articles/multiple-environments#starting-from-scratch "Heroku 上的多个环境")

我成功地制作了两个独立的 Heroku 应用程序，一个测试和一个产品。这每个在我的本地开发框中都有自己的遥控器。但是现在我不知道如何分离我现在不同的开发和产品应用程序的 postgres 表。

这是我使用 Heroku 应用程序创建 postgres 表的命令：

```
heroku addons:add heroku-postgresql 
```

但后来我无法访问我原来的 postgres 数据库。我想要这样的设置，这样我就不会无意中从我的开发分支中软管我的产品数据库。

**TL;DR：我如何使用具有多个环境的单个 Heroku 应用程序来保持不同的 postgres 数据库？**

编辑＃1：我发现我可以打电话：

```
heroku addons:add heroku-postgresql:dev 
```

多次创建多个开发数据库。将我的开发与生产应用程序指向每个数据库的最佳实践是什么，而无需像这样对我的数据库链接进行硬编码：

```
//this function connects to the Heroku postgres db
function pg_connection_string(){
        return "dbname=dcs1k5588jbfad host=ec2-54-243-224-162.compute-1.amazonaws.com port=5432 user=###user_name### password=######### sslmode=require"; 
} 
```

是否有交换数据库指针的 Heroku 风水？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-04T19:53:57.340

您可以将环境变量或 heroku 配置变量设置`DATABASE_URL`为您想要的任何内容。这是 Heroku 应用程序期望成为该应用程序的默认数据库的内容。

如果您使用的是生产数据库，您可以从生产应用程序分叉到测试应用程序以获取数据的副本：[https ://devcenter.heroku.com/articles/heroku-postgres-fork](https://devcenter.heroku.com/articles/heroku-postgres-fork)

# java - 读取特定行并更改该行 Java 中的字符串

> ID：15207995
> 
> 赞同：0
> 
> 时间：2013-03-04T18:03:32.530
> 
> 标签：java, string, file

我有一个名为“Hello.txt”的文本文件，它包含以下内容：

```
dog
cat
mouse
horse 
```

我想有一种方法来检查当阅读器读取行时，如果行等于 2，它将用“hen”替换“cat”并写回同一个文件。到目前为止，我已经尝试了很多，但我不知道在哪里放置条件来检查 line=2，然后它会进行替换。我的代码是：

```
import java.io.*;

public class Python_Read_Replace_Line
{
public static void main(String args[])
{
try
{
File file = new File("C:\\Hello.py");
LineNumberReader lnr = new LineNumberReader(new FileReader(new File("C:\\Hello.txt")));
int numlines = lnr.getLineNumber();

BufferedReader reader = new BufferedReader(new FileReader(file));
String line = "", oldtext = "";
while((line = reader.readLine()) != null)
{

    oldtext += line + System.lineSeparator();

}
reader.close();

String newtext = oldtext.replaceFirst("cat", "hen");

FileWriter writer = new FileWriter("C:\\Hello.txt");
writer.write(newtext);
writer.close();
}
catch (IOException ioe)
{
ioe.printStackTrace();
}
}
} 
```

文件内容应该是这样的：

```
 dog
 hen
 mouse
 horse 
```

**我在上面发布的代码有效，因为它只是用母鸡替换了猫。我想要一个条件（行号=2），然后它会替换它。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-03-04T18:06:32.267

像这样的东西？

```
int lineCount = 1;
while((line = reader.readLine()) != null)
{
  if (lineCount == 2)
    oldText += parseCommand.replaceFirst("\\w*( ?)", "hen\1")
      + System.lineSeparator();
    //oldText += "hen" + System.lineSeparator();
  else
    oldtext += line + System.lineSeparator();
  lineCount++;
} 
```

[参考](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-04T18:09:25.580

您可以创建一个变量来跟踪您所在的行号，如下所示：

```
int line = 0;
while((line = reader.readLine()) != null)

    if (line == 1)
    {
       oldtext += line + System.lineSeparator();
     }
    ++line;
} 
```

# windows-phone-7 - Do you need a license to develop a windows phone and blackberry application?

> ID：15207998
> 
> 赞同：5
> 
> 时间：2013-03-04T18:03:42.520
> 
> 标签：windows-phone-7, windows-phone-8, blackberry

Do I need to pay for a license to be able to debug an application **on the device** on these 2 types of phones?

I only own an iOS license which someone needs to have to be able to debug on the phone and not only in the simulator.

What about Windows Phone and blackberry? And if I am able to debug/develop on the phone without a license, would I be able to test push notification, which in the end is what I want to do?

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-03-10T16:29:59.807

对于 WP 和 Win8，您需要开发人员许可证才能“侧面加载”应用程序，这意味着它们可以在许可的机器上运行，而无需从商店获取它们。见这里[您是否需要许可证才能开发 Windows Phone 和黑莓应用程序？](https://stackoverflow.com/questions/15207998/do-you-need-a-license-to-develop-a-windows-phone-and-blackberry-application)

您还需要注册您的手机以在其上加载和运行应用程序[http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff769508(v=vs.105).aspx#BKMK_UsingtheWindowsPhoneDeveloperRegistrationTool](http://msdn.microsoft.com/en-us/library/windowsphone/develop/ff769508(v=vs.105).aspx#BKMK_UsingtheWindowsPhoneDeveloperRegistrationTool)

您无需为这些许可证付费。它们只是允许代码在不通过商店获取应用程序的情况下执行的机制。