# StackOverflow 问答 14665000-14665999

# php - Word文档的PHP MySQL存储

> ID：14665000
> 
> 赞同：1
> 
> 时间：2013-02-02T18:23:42.923
> 
> 标签：php, mysql, database

我怎样才能使用户可以上传然后将他们的word文档存储在数据库中，以便他们以后可以将其下载为word文档？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:27:23.087

将文件存储在常规 RDBM 中通常被认为是不好的做法。我建议将文件存储在文件系统上，并将文件的路径存储在数据库中的某种`VARCHAR`或`TEXT`字段中。如果您不顾一切地将文件存储在数据库中，请考虑将其存储在`BINARY`blob 或 base64 编码中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:25:40.730

Word 文档不应存储在数据库中。一个好的做法是只存储指向您网站公共范围内的文件的链接。

# css - 网站在 Safari 5.1.7 的顶部有间距

> ID：14665001
> 
> 赞同：0
> 
> 时间：2013-02-02T18:23:57.790
> 
> 标签：css, safari

[http://goo.gl/28W72](http://goo.gl/28W72)

当我在 safari 上查看该网站时，我会在其顶部看到空白区域。我怎么能把它拿出来？我已经在使用css重置了？？这个间距是从哪里来的？

![在此处输入图像描述](../Images/d0d8d5862f740958eb12ecb6fcd5bd0c.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:43:41.790

如上所述，这没有出现在我的 Safari 5.1.7 版本中。请看下图。

![在此处输入图像描述](../Images/2790d73f120bb8bb7c779dc83ffc788f.png)

我会说这仅是您的浏览器的问题。

我会建议 -

• 清除缓存

• 重置Safari 设置。

• 您已安装的任何额外插件。

• 我注意到您的工具栏看起来略有不同，您是否安装了任何主题？

您是否尝试过使用网络检查器查看该空间中是否有任何内容？

# twitter-bootstrap - 将文件放入流星中的文件夹不会被客户端或服务器使用？

> ID：14665015
> 
> 赞同：1
> 
> 时间：2013-02-02T18:25:07.220
> 
> 标签：twitter-bootstrap, less, meteor

我正在尝试包含引导较少的文件，以便我可以使用自定义主题轻松覆盖它们，但单个较少的文件将提供给客户端。我希望能够在其中放置一个较少的文件并从那里导入。这样，只会提供已编译的 less 文件。

是否有任何我可以使用的文件夹不会为客户端或服务器捆绑流星？

就像是

```
/meteor-project
  /external
    /bootstrap-overrides
      variables.less
    /bootstrap
      /less
        reset.less
        etc..
  mybootstraptheme.less 
```

其中 mybootstaptheme.less 从 external/bootstrap 导入，如下所示：

```
// CSS Reset
@import "external/bootstrap/less/reset.less";

// Core variables and mixins
@import "external/bootstrap-overrides/variables.less"; // Modify this for custom colors, font-sizes, etc
@import "external/bootstrap/less/mixins.less";

// Grid system and page structure
@import "external/bootstrap/less/scaffolding.less";
//etc.. 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T23:00:06.583

放置在`tests`文件夹中的文件将被忽略。

```
/meteor-project
  /tests 
```

尽管将该文件夹用于 LESS 文件并不理想。`_`理想情况下，LESS 编译器会忽略以允许导入开头的文件，但是关于此存在一个未解决的问题。

[`less`@import 失败](https://github.com/meteor/meteor/issues/203)

# ruby-on-rails - rails activesupport 通知 - 错误的数据库运行时值

> ID：14665016
> 
> 赞同：11
> 
> 时间：2013-02-02T18:25:09.657
> 
> 标签：ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.2, activesupport

我正在尝试记录我的 REST API 应用程序的请求。我为此使用 Rails 通知，例如这里[http://railscasts.com/episodes/249-notifications-in-rails-3](http://railscasts.com/episodes/249-notifications-in-rails-3)

我不明白如何用 rails 通知解决一个问题。

我的初始化代码

```
ActiveSupport::Notifications.subscribe "process_action.action_controller" do |name, start, finish, id, payload|
 p name
 p start 
 p finish
 p id
 p payload
end

Controller respond section

    class PostsController < ApplicationController
      # GET /posts
      # GET /posts.json

      respond_to  :json, :html
     ....
end 
```

控制器创建动作

```
 def create
    @post = Post.new(params[:post])
    @post.save!
    respond_with(@post, :location => nil)
 end 
```

控制台输出

```
"process_action.action_controller"
2013-02-02 20:13:11 +0200
2013-02-02 20:13:11 +0200
"951b8999e9b71d4a8949"
{:controller=>"PostsController", :action=>"create", :params=>{"utf8"=>"✓", "authenticity_token"=>"1WugY9gh6ZCRXjfBTuckye3c9XDvtCqMQ2JdBpCo88s=", "post"=>{"name"=>"post3", "title"=>"post3", "content"=>"post3"}, "commit"=>"Create Post", "action"=>"create", "controller"=>"posts"}, :format=>:html, :method=>"POST", :path=>"/posts", :status=>302, :view_runtime=>nil, :db_runtime=>0} 
```

如您所见 **：db_runtime=>0**

但是，如果我将控制器操作代码更改为默认脚手架

```
 def create
    @post = Post.new(params[:post])
    #@post.save!
    #respond_with(@post)
    respond_to do |format|
      if @post.save
        format.html { redirect_to @post, notice: 'Post was successfully created.' }
        format.json { render json: @post, status: :created, location: @post }
      else
        format.html { render action: "new" }
        format.json { render json: @post.errors, status: :unprocessable_entity }
      end
    end
  end 
```

我可以看到

```
"process_action.action_controller"
2013-02-02 20:22:51 +0200
2013-02-02 20:22:51 +0200
"bf2a3173c08a0fd9008e"
{:controller=>"PostsController", :action=>"create", :params=>{"utf8"=>"✓", "authenticity_token"=>"1WugY9gh6ZCRXjfBTuckye3c9XDvtCqMQ2JdBpCo88s=", "post"=>{"name"=>"post3", "title"=>"post3", "content"=>"post3"}, "commit"=>"Create Post", "action"=>"create", "controller"=>"posts"}, :format=>:html, :method=>"POST", :path=>"/posts", :status=>302, :view_runtime=>nil, :db_runtime=>4.727} 
```

**:db_runtime=>4.727**

这是什么原因以及如何修复它以使其在第一个示例中工作？谢谢 ！

UPD

```
 bundle show rails
/Users/admin/.rvm/gems/ruby-1.9.3-p125/gems/rails-3.2.11
rvm current
ruby-1.9.3-p125 
```

UPD2

当我使用respond_with时，它似乎不起作用！有人能告诉我为什么吗？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-07T22:35:49.610

好吧，这似乎是一个错误。让我们看看，发生了什么：

首先，我们有用于控制器操作的 AR railtie 及其实现，用于使用 cleanup_view_runtime 钩子设置 db_runtime

```
def cleanup_view_runtime
      if ActiveRecord::Base.connected?
       db_rt_before_render = ActiveRecord::LogSubscriber.reset_runtime
       runtime = super
       db_rt_after_render = ActiveRecord::LogSubscriber.reset_runtime
       self.db_runtime = db_rt_before_render + db_rt_after_render
       runtime - db_rt_after_render
     else
       super
     end
end 
```

应用程序调用控制器动作 -> 执行一些数据库查询的动作并渲染一些东西 -> 渲染前后 AR Logger 保存运行时数据。好的。

让我们看看 respond_with 是如何工作的

```
def respond_with(*resources, &block)
  raise "In order to use respond_with, first you need to declare the formats your " <<
        "controller responds to in the class level" if self.class.mimes_for_respond_to.empty?

  if collector = retrieve_collector_from_mimes(&block)
    options = resources.size == 1 ? {} : resources.extract_options!
    options[:default_response] = collector.response
    (options.delete(:responder) || self.class.responder).call(self, resources, options)
  end
end

def self.call(*args)
  new(*args).respond
end

def to_format
  if get? || !has_errors? || response_overridden?
    default_render
  else
    display_errors
  end
rescue ActionView::MissingTemplate => e
  api_behavior(e)
end 
```

这里的代码似乎太多了，但你应该看到这个问题的调用堆栈：respond_with -> self.class.responder.respond -> self.class.responder.to_format -> default_render -> default_renderer raise ActionView::MissingTemplate(因为我们没有）。此时我们可以通过捕获 ActionView::MissingTemplate 看到渲染 :json 和 :xml(api_behaviour) 的实现。

现在我们知道 respond_with 是如何工作的，但 AR Logger 不知道.. cleanup_view_runtime 钩子被调用了两次：for default_renderer（当时模板数据已准备好并调用了一些数据库查询，但我们在渲染过程中捕获了 ActionView::MissingTemplate）

```
db_rt_before_render = ActiveRecord::LogSubscriber.reset_runtime
runtime = super # <-- here
db_rt_after_render = ActiveRecord::LogSubscriber.reset_runtime 
```

对于 api_behavour（当时所有模板数据都已准备好渲染，没有数据库查询）

一些混乱的解释，但我希望它会有所帮助:)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:47:00.317

Rails 工具通过在机架金属级别包装请求并记录不同指标的事件来工作。在这两种情况下，整个块都应该被标准仪器包装和跟踪。

在深入研究源代码后我能看到的唯一区别是调用 save() 与 save!()。看起来 ActiveRecord 中的底层方法事件订阅可能表现不同。

尝试更改您的 respond_with() 示例以使用保存与保存！看看它是否正确记录了db_runtime？如果是这样，那就是 Rails 错误，您可以通过模仿保存来解决它！使用保存的功能。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-07T10:58:48.803

更新：

这并不简单，需要一些调整..

除非您编写自己的 Railtie 来挂钩，否则不会`Active Record`，但它比复制`Active Record`已经...

但它是这样做的：

1)[日志订阅者](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/log_subscriber.rb)

2)[铁轨](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/railtie.rb#L81)

3)[控制器运行时](https://github.com/rails/rails/blob/master/activerecord/lib/active_record/railties/controller_runtime.rb)

我希望你得到了如何开始进入它的提示。

干杯!

# sql - 无法形成 SQL 查询

> ID：14665017
> 
> 赞同：1
> 
> 时间：2013-02-02T18:25:20.153
> 
> 标签：sql

我有三张桌子。SurveyFact、问题和响应。调查事实包含客户进行的调查的数据，而问题和响应表包含明显的数据、问题列表和每个问题的可能响应。

调查事实：

```
| SurveyFactID | ClientID   |  QuestionID   | ResponseCode |
------------------------------------------------------------
|    1         |    1       |     1         |     3        |    
|    2         |    1       |     2         |     3        |
|    3         |    1       |     3         |     1        | 
```

问题：

```
| QuestionID| QuestionText          |
-------------------------------------
|    1      |    blah blah blah     |    
|    2      |    blah blah blah     |
|    3      |    blah blah blah     | 
```

回复：

```
| ResponseID| QuestionID  | ResponseCode |ResponseText     |
-----------------------------------------------------------|
|    1      |    1       |      1       |   like           |    
|    2      |    1       |      2       |   don't care     |
|    3      |    1       |      3       |   hate           |
|    4      |    2       |      1       |   like           |    
|    5      |    2       |      2       |   don't care     |
|    6      |    2       |      3       |   hate           | 
```

这是我提出的查询。（那失败了）

```
select
    sf.QuestionCode as [Question Number],
    q.QuestionText as [Question Text],
    r.ResponseText as [Reponse]
from SurveyFact sf
inner join Question q
    on q.QuestionID = sf.QuestionID
inner join Responses r
    on r.ResponseCode = sf.ResponseCode
where sf.ClientID = '1'
    and sf.QuestionID = q.QuestionID
    and sf.ResponseCode = r.ResponseCode 
```

即使当我使用 select distinct 时，它也会为我生成带有每个可能答案的调查和问题，而不是仅在 SurveyFact 中列出的问题/答案组合。

请帮忙？

要求的表：我所看到的

```
| Question Number | Question Text |Response Text     |
------------------------------------------------------
|    1       |  blah blah blah    |   like           |    
|    1       |  blah blah blah    |   don't care     |
|    1       |  blah blah blah    |  hate            |
|    2       |  blah blah blah    |   like           |    
|    2       |  blah blah blah    |   don't care     |
|    2       |  blah blah blah    |   hate           | 
```

我想要的是：

```
| Question Number | Question Text |Response Text     |
------------------------------------------------------ 
|    1       |  blah blah blah    |   don't care     |
|    2       |  blah blah blah    |   like           | 
```

第一个是数字，问题，然后是所有可能的答案。第二个只是数字，问题，只是选择的答案

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:01:38.933

```
select
    sf.QuestionID as QuestionNumber,
    q.QuestionText as QuestionText,
    r.ResponseText as Reponse
from SurveyFact sf, Question  q, Response  r
where sf.ClientID = '1'
and
sf.QuestionID = q.QuestionID
and
r.QuestionID = q.QuestionID
and
sf.ResponseCode = r.ResponseCode 
```

我想这就是你要找的。

结果将是：

```
| Question Number | Question Text |Response Text     |
------------------------------------------------------ 
|    1       |  blah blah (q1)    |   hate           |
|    2       |  blah blah (q2)    |   hate           | 
```

在您的结果中，您写道：

```
| Question Number | Question Text |Response Text     |
------------------------------------------------------ 
|    1       |  blah blah blah    |   don't care     |
|    2       |  blah blah blah    |   like           | 
```

但我看不出应该如何获取“不关心”和“喜欢”？他们有 ResponseCode 1 和 2。ResultCode 1 和 2 不在 SurveyFact 中。那么 1 是，但它适用于问题 3，问题 3 不在响应表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:29:06.533

添加一个条件，即响应必须针对正确的问题：

```
inner join Responses r
    on r.ResponseCode = sf.ResponseCode
       and r.QuestionID = q.QuestionID 
```

# php - CodeIgniter 连接到数据库

> ID：14665018
> 
> 赞同：4
> 
> 时间：2013-02-02T18:25:33.473
> 
> 标签：php, codeigniter

我决定结束与 Doctrine 2.3 的合作，现在我想只使用 CodeIgniter 连接到数据库，你知道我的代码哪里出了问题吗？

**我得到的这个错误：**

```
A PHP Error was encountered

Severity: Notice

Message: Undefined property: Hello::$db

Filename: core/Model.php

Line Number: 51 
```

**数据库.php**

```
$db['default']['hostname'] = 'localhost:8080';
$db['default']['username'] = 'root';
$db['default']['password'] = '';
$db['default']['database'] = 'ci_doctrine';
$db['default']['dbdriver'] = 'mysql'; 
```

**控制器**

```
<?php
    // system/application/controllers/hello.php

    class Hello extends CI_Controller {

        public function __construct()
        {
             parent::__construct();
        }
       function world() {
            echo "Hello CodeIgniter!";
        }

        function user_test() {

            $this->load->model('user');

            $this->user->save_User('username','password','first_name','last_name');

       }
}

?> 
```

**模型 - 数据库“用户”中的表名**

```
<?php
    // system/application/models/user.php

    class User extends CI_Model {

            function __construct()
            {
                // Call the Model constructor
                parent::__construct();
            }

             function save_User($username,$password,$fName,$lName)  {

                $this->username   = $username; 
                $this->password = $password;
                $this->first_name    = $fName;
                $this->last_name    = $lName;
                $this->db->insert('user', $this);
              }

    }
?> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:33:29.593

您需要加载数据库库：

配置/自动加载.php

```
$autoload['libraries'] = array('database'); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T18:32:36.427

问题是您没有加载数据库类

```
$this->load->database(); 
```

[这](http://ellislab.com/codeigniter/user-guide/database/connecting.html)是 Codeigniter 用户指南

如果没有连接，您将无法使用数据库类，因此它说的是未定义的属性 db。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-11-03T06:01:32.270

手动连接
在你的控制器文件中使用这个

```
$this->load->database(); 
```

用于自动连接数据库

转到控制器，然后在 autoload.php 中进行以下更改

```
$autoload['libraries'] = array('database'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-11-04T06:10:56.447

您需要加载数据库库：

**配置/自动加载.php**

```
 $autoload['libraries'] = array('database'); 
```

尝试一下 。

# ember.js - 对象属性数组（服务器上的枚举）和 ember 复选框组之间的双向绑定

> ID：14665026
> 
> 赞同：8
> 
> 时间：2013-02-02T18:26:07.533
> 
> 标签：ember.js

我正在寻找一种解决方案，将包含字符串数组（表示服务器上的枚举）的对象属性绑定到复选框列表。绑定应该是双向的。

在服务器上，我们有一些枚举定义，例如，角色的值为“ADMIN”、“GUEST”、“USER”。一个用户对象可能有几个这样的角色，因此 Ember 中的用户对象的形式是

```
App.User = Ember.Object.create({
    roles: ["USER", "ADMIN"]
}); 
```

在用户管理中，应该有一组复选框。每个角色一个复选框。因此，可以选择无、全部或多个。

我知道有`Ember.Checkbox`可以用于此的视图。我正在寻找的是一个简单而通用的视图来处理上述任何类型的枚举。

因此，问题是：

*   有人对此有一个很好的解决方案吗？
*   有人知道为 ember 提供此类扩展的开源项目吗？

提前致谢。// ph

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T21:15:26.967

如果您愿意手动同步服务器和客户端上的枚举（使用 AJAX 或 WebSockets），则可以使用普通的 Ember.js 来实现处理 Ember 对象和复选框之间的双向绑定的通用方法，而无需任何插件. 请注意，Ember 可以在同步后使用 Checkbox 自动更新选项列表。

所以从今以后，我假设你有一个枚举，角色是一个 Ember 数组：

```
App.Roles = [ "USER", "ADMIN", "GUEST" ]; 
```

然后我们将像这样在[CollectionView](http://emberjs.com/api/classes/Ember.CollectionView.html)中显示用户可用的选项（模板如下所示）。

```
OptionsView = Em.CollectionView.extend({
    contentBinding: 'App.Roles',  // Show a list of _all_ available roles
    userBinding: 'App.User',      // This points to the active user
    tagName: 'ul',                // Shown as a <ul>
    itemViewClass: Em.View.extend({
        userBinding: 'parentView.user',  // For convenience
        templateName: 'user-roles' // Defined later
    })
}); 
```

每个选项的模板是：

```
<script data-template-name="user-roles" type="text/x-handlebars">
  <label> {{view App.RoleCheckbox 
            contentBinding="view.content"}} 
  {{view.content}}
  </label>
</script> 
```

请注意，`<label>`标签的使用确保 Checkbox 的`click`事件在单击标签上的任意位置时被触发。

最后`App.RoleCheckbox`是`Ember.Checkbox`类的扩展，它处理`checked`属性和`click`事件来切换角色：

```
App.RoleCheckbox = Em.Checkbox.extend({
    userRolesBinding: 'parentView.user.roles', // Points to the roles of the user

    checked: function () {
        var userRoles = this.get('userRoles');
        return userRoles.contains(this.get('content'));
    }.property('content', 'userRoles.@each'),

    click: function (evt) {
        var isPresent = this.get('checked'),
            userRoles = this.get('userRoles'),
            role      = this.get('content');

         if (!isPresent) { 
             userRoles.pushObject(role); 
         } else {
             userRoles.removeObject(role);
         }
     }
}); 
```

一个工作示例是： http: [//jsfiddle.net/BLQBf/](http://jsfiddle.net/BLQBf/)（查看控制台以查看日志消息）

请注意，这并不完全是 Ember 式的，因为 View 正在做部分工作，这意味着`controller`. 理想情况下，该`click`事件将调用一个函数，该函数`RoleCheckboxController`将对对象进行更改`User`。

# python - 无法让 crypt 正常工作

> ID：14665031
> 
> 赞同：1
> 
> 时间：2013-02-02T18:26:35.943
> 
> 标签：python, crypt

我只是在乱看是否可以使用“crypt”模块，我似乎遇到了一个我一生都无法解决的问题。我运行后的输出是这样的：

```
Password Not Found. secret HXXxJi0n6Huro HXXxJi0n6Huro 
```

这意味着 cryptWord 和 cryptPass 是相同的，那么为什么程序不执行 ( `if cryptWord == cryptPass:`) 和`print 'Found Password:`

我只是不明白。

dictionary.txt 文件中多次包含secret 这个词，都在不同的行中。evil.txt 文件有这一行：

```
test_user:HXXxJi0n6Huro 
```

据我所知，一切正常吗？但是有些东西阻碍了它的正常工作，我就是想不通。任何帮助，将不胜感激。

```
import crypt

def testPass(cryptPass):

        salt = cryptPass[0:2]
        dictFile = open('dictionary.txt', 'r')
        for word in dictFile.readlines():
            word = word.strip('\n')
            cryptWord = crypt.crypt(word, salt)
            if cryptWord == cryptPass:
                print "[+] Found Password: "+word+"\n"
                return
        print "[-] Password Not Found. " +word,  cryptWord,  cryptPass+  "\n"
        return

def main():

    passFile= open('evil.txt')
    for line in passFile.readlines():
        if ":" in line:
            user = line.split(':')[0]
            cryptPass = line.split(':')[1]
            print "[*] Cracking Password For: "+user
            testPass(cryptPass)
if __name__ == '__main__':

        main() 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T18:30:48.290

您的`crypPass`值仍然附有换行符。先剥离它：

```
user, cryptPass = line.split(':')
cryptPass = cryptPass.strip() 
```

# facebook - spring security facebook 插件（Grails）网络服务访问

> ID：14665035
> 
> 赞同：0
> 
> 时间：2013-02-02T18:27:02.193
> 
> 标签：facebook, grails, spring-security, grails-plugin

我对 Grails 和插件的使用很陌生。现在我正在尝试使用 grails 构建宁静的服务。我需要对用户进行某种身份验证，因此我将 spring-security-facebook 插件用于 grails。它适用于我所有的网页。但我需要对 `<facebookAuth:connect />` Android 应用程序执行操作。是否可以使用某种宁静的网络服务来调用 spring security facebook 插件的用户创建或身份验证方法？现在我在 android 应用程序中使用 webview 将登录页面放入其中，但它并没有给原生应用程序的感觉。

任何指针都会很有用。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T05:34:48.537

对此有特殊类型的身份验证：[JSON Authentication](http://splix.github.com/grails-spring-security-facebook/guide/3%20Usage.html#3.5%20Json%20Authentication)

简而言之：您应该发布 Facebook `access_token`，插件将验证 FB 用户（如果需要则创建）并使用包含用户详细信息的 JSON 进行响应。

# java - 在 servlet 中获取初始化参数

> ID：14665037
> 
> 赞同：28
> 
> 时间：2013-02-02T18:27:14.253
> 
> 标签：java, servlets, deployment-descriptor, init-parameters

我是 servlet 的新手。我在使用（“名称”）的方法中获得了`init`DD 中的参数。我从方法内部尝试了很多来访问参数，但它总是返回.`init()``getInitParameter``doGet()``init``null`

我试过了

`getServletContext().getInitParametr("name")`

与

`getServletConfig().getInitParametr("name")`

但他们都回来了`null`。我可以得到 init 参数`doGet()`吗？

* * *

## 回答 #1

> 赞同：72
> 
> 时间：2013-02-03T21:57:40.903

答案是——**是的，你可以**。

好的，除了*JB Nizet 的*评论，这里还有一些建议。

**1)**您是否在[Web 容器](http://en.wikipedia.org/wiki/Web_container)/[应用程序服务器](http://en.wikipedia.org/wiki/Application_server)运行时添加了初始化参数？

引自[“ *Head First Servlets & JSP: Passing the Sun Certified Web Component Developer Exam* ”](https://rads.stackoverflow.com/amzn/click/com/0596516681)：

> **servlet 初始化参数是只读的——当 Container 初始化 servlet 时**。...
> 当容器创建一个 servlet 时，它会读取 DD 并为 ServletConfig 创建名称/值对。Container 再也不会读取 init 参数了！一旦参数在 ServletConfig 中，**它们将不会被再次读取，直到/除非您重新部署 servlet**。

**2)**有两种类型的*init 参数*可用。*“ Head First Servlets and JSP* ”（强调我的） 的另一句话：

> 有**上下文初始化参数**（在`<context-param>`元素中定义）和**servlet 初始化参数**（在`<init-param>`元素中定义）。尽管在不同的元素中定义，但它们都被称为*初始化参数。*
> 
> *   *上下文*初始化参数可用于作为当前 Web 应用程序一部分的**任何servlet 或 JSP。**
>     
>     
> *   *Servlet*初始化参数仅**可**用于为其配置的 servlet `<init-param>`。
>     
>     
> *   *上下文*初始化参数在`<web-app>`元素内定义。
>     
>     
> *   *Servlet*初始化参数在**每个特定 servlet**`<servlet>`的元素中定义。

 *** * *

## 例子：

```
<?xml version="1.0" encoding="UTF-8"?>
<web-app xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee
                        http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd"
    version="3.0">

    <display-name>Servlet testing app</display-name>

    <!-- This is a context init parameter -->
    <context-param>
        <param-name>email</param-name>
        <param-value>admin@example.com</param-value>
    </context-param>

    <servlet>
        <servlet-name>Info Servlet</servlet-name>
        <servlet-class>com.example.InfoServlet</servlet-class>
        <!-- This is a servlet init parameter -->
        <init-param>
            <param-name>name</param-name>
            <param-value>John Doe</param-value>
        </init-param>
    </servlet>
    <servlet-mapping>
        <servlet-name>Info Servlet</servlet-name>
        <url-pattern>/test/ShowInfo.do</url-pattern>
    </servlet-mapping>

</web-app> 
```

*   在 servlet 中访问**上下文初始化参数：**
    `getServlet**Context**().getInitParameter(“email”);`
*   访问在[*部署描述符*](https://en.wikipedia.org/wiki/Deployment_descriptor)中定义的 servlet 中的**servlet init 参数**：[](https://en.wikipedia.org/wiki/Deployment_descriptor) *`getServlet**Config**().getInitParameter("name");`*

 ***获取servlet 初始化参数**的另一种方法是使用抽象类[*GenericServlet*](http://docs.oracle.com/javaee/7/api/javax/servlet/GenericServlet.html#getInitParameter-java.lang.String-)中定义的方法：
`public String getInitParameter(String name);`
提供此方法是为了方便。*它从 servlet 的ServletConfig*对象中获取命名参数的值。

[*ServletContext*](http://docs.oracle.com/javaee/7/api/javax/servlet/ServletContext.html)和[*ServletConfig*](http://docs.oracle.com/javaee/7/api/javax/servlet/ServletConfig.html)也有获取**所有**初始化参数的`Enumeration<String> getInitParameterNames()`方法。[](http://docs.oracle.com/javaee/7/api/javax/servlet/ServletContext.html)*[](http://docs.oracle.com/javaee/7/api/javax/servlet/ServletConfig.html)*

 ***** * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-05-31T11:47:48.403

如果您覆盖了默认的 init() 方法，请确保将 Servlet 配置参数传递给它并调用超级 init 方法。因为如果您不这样做，您的代码将无法找到您的 servlet 配置。

这是 servlet init() 代码的代码：

```
 public void init(ServletConfig config) throws ServletException {
    super.init(config);
    // Rest of your code ...
    } 
```

我还注意到您使用了 Servlet 版本 3，我不确定它是否支持定义 servlet 标签，所以如果上述解决方案有效，请尝试删除 web-app 属性。*******

# java - 播放框架控制器继承

> ID：14665043
> 
> 赞同：2
> 
> 时间：2013-02-02T18:28:07.407
> 
> 标签：java, playframework, playframework-1.x

我试图创建一个控制器继承来检查它是如何`Interceptions`工作的。

默认控制器ie`Application.java`是这样的：

```
@Before
static void display(){
    System.out.println("Interception method \"Before\" invoked!!!");
}

public static void index() {
    System.out.println("Inside index!!!");
    render();
} 
```

我创建了一个名为的新控制器`App.java`，它是这样的：

```
@With(Application.class)

public class App extends Controller {

public static void welcome(String txtName){
    render(txtName);
}

} 
```

这是 index.html 文件：

```
#{extends 'main.html' /}
#{set title:'Home' /}

<form action="@{App.welcome()}" method="get">
Enter your name: <input type="text" name="txtName">
<input type="submit" value="Submit">
</form> 
```

这是`Welcome.html`文件：

```
#{extends 'main.html' /}
#{set title:'Home' /}

Welcome ${txtName?:'Guest'} 
```

我在路由文件中添加了这个条目：

```
GET     /InterceptionDemo                       controllers.App.welcome 
```

当我输入名称并单击其中的按钮`index.html`时，出现错误：

```
The template App/welcome.html does not exist. 
```

我正在尝试使用`App.java`控制器，但它不工作。该`welcome.html`文件存在于也存在的`views/Application`文件夹下`index.html`。

请让我知道如何使它工作......这只是一个垃圾应用程序，它试图开始使用 Play 框架继承。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T18:43:35.107

您想将 welcome.html 从 移动`views/Application`到`views/App`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T18:43:59.287

试过你的例子，它工作得很好。将 Welcome.html 文件放在错误的目录中，并得到与您相同的错误。但随后创建了 views/App 目录并将其放置在那里，它就可以工作了。

# javascript - 变量声明在函数声明之前是否有任何优先级？

> ID：14665048
> 
> 赞同：2
> 
> 时间：2013-02-02T18:28:24.490
> 
> 标签：javascript

我测试了以下代码：

```
(function(){
  var x = false;  
  function x(){
    return true;
  }  
  return typeof x;
})(); 
```

它返回“布尔值”。只有当我评论第二行时：

```
(function(){
  //var x = false;  
  function x(){
    return true;
  }  
  return typeof x;
})(); 
```

它返回“功能”。这意味着如果有人之前在代码中的某处声明了一个变量，我使用相同名称的函数声明将失败，对吧？请有人给我解释一下。谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:30:42.277

在 JavaScript 中，函数声明被视为首先编写的。然后是变量声明。（如果有的话，那个特定的顺序很少重要。）

在变量声明中，任何赋值部分都被视为单独的表达式语句，出现在`var`语句实际出现的函数中。因此：

```
function foo() {
  // ... some code ...
  if (whatever) {
    var x = whatever + 1;
  }
} 
```

被视为：

```
function foo() {
  var x;
  // ... some code ...
  if (whatever) {
    x = whatever + 1;
  }
} 
```

因此，总体而言，您的第一个样本被视为：

```
(function() {
  function x() {
    return true;
  }
  var x;
  x = false;
  return typeof x;
})(); 
```

另请注意，函数和变量共享一个公共命名空间。对于`var`已声明的变量名，没有赋值部分的声明无效。（至少，我认为它没有有意义的效果，但是 JavaScript 有奇怪的暗角......）

# python - python生成序列

> ID：14665049
> 
> 赞同：0
> 
> 时间：2013-02-02T18:28:38.453
> 
> 标签：python

我有一个与序列相关的大问题要解决，以下是子问题，我确信它是 python 中非常基本的东西，我不知道。

```
seq = [4*x for x in range (1,(20/4))]
generates seq = [4, 8, 12, 16] 
```

我怎样才能生成

```
[4, 4, 8, 8, 12, 12, 16]

seq = [4*x, 4*x for x in range (1,(20/4))] does not work 
```

我可以通过编写一个小函数轻松解决上述问题，但我在变量定义时需要它。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T18:32:13.230

您的解决方案不起作用，因为它会生成一个元组列表。

您正在寻找的是一种扁平化您生成的列表的方法 - 最简单的方法是[`itertools.chain.from_iterable()`](http://docs.python.org/3/library/itertools.html#itertools.chain.from_iterable)：

```
>>> list(itertools.chain.from_iterable([4*x]*2 for x in range(1, 5)))
[4, 4, 8, 8, 12, 12, 16, 16] 
```

如果您打算只获得最后一个值一次，如您的示例所示，只需将列表的末尾切片 ( `seq[:-1]`)。

请注意，您可以使用一个列表并将其相乘（假设这些值是不可变的，或者您不介意它们是同一个对象），而不是为您想要的每次重复重复您的值。另一种选择是[`itertools.repeat()`](http://docs.python.org/3/library/itertools.html#itertools.repeat).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:52:49.473

有时只需要一个简单的生成器：

```
def doubler_almost(seq):
    """
    Yield elements from a sequence twice until the last element
    which is only yielded once
    """
    iseq = iter(seq)
    y = next(iseq)
    yield y
    for x in iseq:
        yield y
        yield x
        y = x

print list(doubler_almost(range(4,20,4))) 
```

-- 虽然这个生成器肯定可以从一个更好的名字中受益......

你从这个答案中得到的东西是你从其他人那里没有得到的，你不需要转换为列表来切掉最后一个元素——它可以被完全懒惰地评估。它也可以传递给一个生成器，它仍然可以工作（尽管 Lattyware 的答案在这种情况下仍然有效——但`zip`除非你先使用答案，否则答案不会`itertools.tee`）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:48:03.663

@shantanoo 答案的变体：

```
[ 4 * i for s in itertools.izip(*itertools.tee(range(1,5))) for i in s] 
```

输出

```
[4, 4, 8, 8, 12, 12, 16, 16] 
```

真的，这只是一个借口`itertools.tee`：D

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T18:40:54.380

另一种方式：

```
>>> seq = [4, 8, 12, 16]
>>> seq = [i for s in zip(seq,seq) for i in s]
>>> seq
[4, 4, 8, 8, 12, 12, 16, 16] 
```

在 seq 作为迭代器的情况下，

```
>>> seq = [4, 8, 12, 16]
>>> seq = [i for s in zip(seq,seq.copy()) for i in s]
>>> seq
[4, 4, 8, 8, 12, 12, 16, 16] 
```

感谢@mgilson 的迭代反馈。

# java - jdialog进入和退出不起作用

> ID：14665057
> 
> 赞同：2
> 
> 时间：2013-02-02T18:29:24.820
> 
> 标签：java, swing, escaping, key-bindings, enter

上下文：我正在尝试创建模态 JDialog 并在一个条件下使用自定义按钮几乎复制 JOptionPane 功能 - 我不想使用 UIManager 来设置窗口样式。

问题：JDialog 没有像它应该的那样回答 ESCAPE 和 ENTER 键。我已经尝试了我可以在网上找到的所有建议的解决方案（多个听众解决方案、设置默认按钮等），但我无法让它工作。

全班上传到[http://pastebin.com/Kcj82h2i的 pastebin](http://pastebin.com/Kcj82h2i)

扩展 JDialog 类中的实际键设置是通过

```
InputMap inputMap = getRootPane().getInputMap(JComponent.WHEN_IN_FOCUSED_WINDOW);
ActionMap actionMap = getRootPane().getActionMap(); 

inputMap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ENTER, 0), "returnyes");
actionMap.put("returnyes", new ResultYes());

inputMap.put(KeyStroke.getKeyStroke(KeyEvent.VK_ESCAPE, 0), "returnno");
actionMap.put("returnno", new ResultNo()); 
```

并且使用以下代码从 JFrame 调用该对话框：

```
if (results == 1)
{
    InvoiceLinesTableModel tm = (InvoiceLinesTableModel) tbl_invoiceItems.getModel();
    InvoiceLinesTableRow row = tm.getRow(tbl_invoiceItems.getSelectedRow());
    tm.deleteRow(row);
    tm.fireTableDataChanged();
    StaticFunctions.updateTableRowHeights(tbl_invoiceItems);
} 
```

帮助？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T18:45:17.213

由于是模态的，当窗口变得可见时，`JDialog`调用将被阻止。`addCustomKeyMaps()`你应该在打电话*之前*打这个电话`setVisible(true)`。

# tableview - JavaFX Tableview EnsureVisible

> ID：14665062
> 
> 赞同：0
> 
> 时间：2013-02-02T18:29:56.640
> 
> 标签：tableview, javafx

有人可以指出一种为 javafx tableview 实现确保可见例程的方法吗？我花了几个小时研究，但没有发现任何东西。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-07-18T19:38:29.127

你可以使用这个方法

```
setTableMenuButtonVisible(boolean value)
//Sets the value of the property tableMenuButtonVisible. 
```

这是有关表视图的更多信息 [https://docs.oracle.com/javase/8/javafx/api/javafx/scene/control/TableView.html](https://docs.oracle.com/javase/8/javafx/api/javafx/scene/control/TableView.html)

# python - 将 Python “请求”与现有套接字连接一起使用

> ID：14665064
> 
> 赞同：18
> 
> 时间：2013-02-02T18:30:01.747
> 
> 标签：python, http, sockets, python-requests

Python“请求”库目前风靡一时，因为它为发出 HTTP 请求提供了漂亮的接口——但在它之下似乎有许多间接层——会话、HTTP 适配器，最后是 urllib3 的机制。

如果我已经持有一个打开的套接字，并且想要使用“请求”沿着该套接字发送 HTTP 响应并接收回复，那么在这个抽象堆栈中的哪个位置是正确的干预位置？

如果没有某种干预（或定制？），堆栈将尝试为我创建一个新的 TCP/IP 套接字，但在我的特定应用程序中，我的代码在代表我建立连接之前不会被调用，所以我会如果我希望能够使用 Requests 的功能，需要说服 Requests 谈论现有的套接字。

请求库：

[http://pypi.python.org/pypi/requests](http://pypi.python.org/pypi/requests)

[https://github.com/kennethreitz/requests](https://github.com/kennethreitz/requests)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-03T09:33:11.557

以下代码需要来自 git 的请求（尤其是`requests.packages.urllib3.poolmanager.PoolManager._new_pool()`）

我用`ncat -v -l 127.0.0.1 8000`

问题在于，连接不是由 urllib3 而是由标准库中的 httplib 打开的。

```
import socket
import requests
from requests.adapters import HTTPAdapter
from requests.packages.urllib3 import PoolManager, HTTPConnectionPool

try:
    from http.client import HTTPConnection
except ImportError:
    from httplib import HTTPConnection

class MyAdapter(HTTPAdapter):
    def init_poolmanager(self, connections, maxsize):
        self.poolmanager = MyPoolManager(num_pools=connections,
                                         maxsize=maxsize)

class MyPoolManager(PoolManager):
    def _new_pool(self, scheme, host, port):
        # Important!
        if scheme == 'http' and host == my_host and port == my_port:
            return MyHTTPConnectionPool(host, port, **self.connection_pool_kw)
        return super(PoolManager, self)._new_pool(self, scheme, host, port)

class MyHTTPConnectionPool(HTTPConnectionPool):
    def _new_conn(self):
        self.num_connections += 1
        return MyHTTPConnection(host=self.host,
                            port=self.port,
                            strict=self.strict)

class MyHTTPConnection(HTTPConnection):
    def connect(self):
        """Connect to the host and port specified in __init__."""
        # Original
        # self.sock = socket.create_connection((self.host, self.port),
        #                                    self.timeout, self.source_address)
        # Important!
        self.sock = my_socket
        if self._tunnel_host:
            self._tunnel()

if __name__ == '__main__':
    import time

    my_host = '127.0.0.1'
    my_port = 8000

    my_socket = socket.create_connection((my_host, my_port))
    time.sleep(4)
    s = requests.Session()
    s.mount('http://', MyAdapter())
    s.get('http://127.0.0.1:8000/foo') 
```

编辑：

或者直接对连接池进行monkeypatching：

```
class MyHTTPConnection(HTTPConnection):
    def connect(self):
        self.sock = my_socket
        if self._tunnel_host:
            self._tunnel()

requests.packages.urllib3.connectionpool.HTTPConnection = MyHTTPConnection

if __name__ == '__main__':
    my_host = '127.0.0.1'
    my_port = 8000

    my_socket = socket.create_connection((my_host, my_port))
    requests.get('http://127.0.0.1:8000/foo') 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:32:25.263

直接去`urllib3`图书馆；[`urllib3.connectionpool`它在模块](https://github.com/shazow/urllib3/blob/master/urllib3/connectionpool.py)中拥有一个连接池。

您可以更换池或通过破解[`poolmanager`模块](https://github.com/shazow/urllib3/blob/master/urllib3/poolmanager.py)来调整它。

# javascript - 表单未在 javascript 中验证

> ID：14665081
> 
> 赞同：2
> 
> 时间：2013-02-02T18:31:23.877
> 
> 标签：javascript, html, forms, validation

我正在尝试通过链接 JS 文件来验证输入来验证用户的输入。但是，当我单击带有错误数据的提交按钮时，表单被提交并且没有给出验证错误。

表格：

```
<form id="user_form" name="contactForm" action="#" method="GET" onsubmit="return validateForm();">

<p id="first_name" class="input_title">First name <span class="asterisk_red">*</span></p>

<!-- The HTML 5 'Required' attribute will not allow the form to be sent empty. -->
<input class="input_box" type="text" name="first_name" placeholder="Joe" />

<input id="submit_button" type="submit" name="submit" value="Submit"/>

</form> 
```

还有我用来验证的 JS：

```
function validateForm(){

/* Validate the first name field of the form */
var fn = document.forms['contactForm'].first_name.value;

/* If the Name string is empty then return false and show warning. */
if (fn == ""){
    alert("First name must be filled out");
    document.forms['contactForm'].first_name.reset();
    return false;
}else if(fn.length <= 2){
    alert("Your first name must more than two characters");
    document.forms['contactForm'].first_name.reset();
    return false;
}

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:06:58.777

我不确定您是否可以在元素上调用 reset()。我认为您在表单对象上使用该方法来清除所有字段。IE 和 FF 似乎没有问题，但 Chrome 似乎有。结果，chrome 不执行 javascript 并始终提交表单。这是小提琴[表单提交](http://jsfiddle.net/ubjTH/6/)和更新的代码：

```
function validateForm() {

            /* Validate the first name field of the form */
            var fn = document.forms['contactForm'].first_name.value.trim();

            /* If the Name string is empty then return false and show warning. */
            if (fn == "") {
                alert("First name must be filled out");
                document.forms['contactForm'].first_name.value = '';//Removed reset
                return false;
            } else if (fn.length <= 2) {
                alert("Your first name must more than two characters");
                document.forms['contactForm'].first_name.value = '';//Removed reset
                return false;
            }
            return true;//Added
        } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:46:06.117

请检查这个结果：[Form Validation jsFiddle](http://jsfiddle.net/FGRyn/) 你有更多输入和 GET 的表单验证。

还请参阅有关如何构建 [jQuery 验证的 Jquery 参考](http://docs.jquery.com/Plugins/Validation)

或者只使用插件验证：

```
<script type="text/javascript" src="http://jzaefferer.github.com/jquery-validation/jquery.validate.js"></script>

$(document).ready(function(){
    $("#commentForm").validate();
  }); 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-02T18:45:50.320

您可以在表单中使用普通按钮并使用 javascript 函数提交表单。

# c++ - C++ 析构函数，EXC_BAD_ACCESS，无法访问内存

> ID：14665082
> 
> 赞同：3
> 
> 时间：2013-02-02T18:31:30.497
> 
> 标签：c++, destructor

我计划使用排序数组来构建平衡的二叉搜索树。一切运行良好，直到程序结束。看来二叉搜索树的析构函数有问题。

错误信息：

> 程序收到信号 EXC_BAD_ACCESS，无法访问内存。原因：KERN_PROTECTION_FAILURE 地址：0x00007fff5f3ffff8 0x0000000100002857 在 BST_Node::~BST_Node (this=0x100100920) at BST_Node.h:18 ~BST_Node() {delete parent; 左边删除；删除权；}

```
#ifndef BST_NODE_H
#define BST_NODE_H

#include <cstddef>

class BST_Node {
    public:
        BST_Node(int k) : key(k), parent(NULL), left(NULL), right(NULL) {}
        ~BST_Node() {if (parent!=NULL) delete parent;if (left!=NULL) delete left;if (right!=NULL) delete right;}
        // data member
        int key;
        BST_Node* parent;
        BST_Node* left;
        BST_Node* right;
};

#endif

#include <iostream>
#include <vector>
#include "BST_Tree.h"
#include "BST_Node.h"

using namespace std;

// use recursion to construct the tree. Find the mid of the array to be the root of the subtree. Use left part of the array to construct the left subtree and right part to construct the right subtree.
BST_Node* CreateTree(vector<int> &a, int start, int end) {
    if (end<start) {
        return NULL;
    } else {
        int mid = (start+end+1)/2;
        BST_Node* p = new BST_Node(a[mid]);
        BST_Node* l_tmp = CreateTree(a, start, mid-1);
        if (l_tmp)
            l_tmp->parent = p;
        p->left = l_tmp;
        BST_Node* r_tmp = CreateTree(a, mid+1, end);
        if (r_tmp)
            r_tmp->parent = p;
        p->right = r_tmp;
        return p;
    }
}

int main() {
    vector<int> a;
    a.push_back(0);
    a.push_back(1);
    a.push_back(2);
    a.push_back(3);
    a.push_back(4);
    a.push_back(5);
    a.push_back(6);
    BST_Tree t;
    t.root = CreateTree(a, 0, 6);
    t.InOrderWalk(t.root);
    return 0;
} 
```

非常感谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T18:48:08.573

任何所有权关系（当不再需要该对象时，一个对象负责删除另一个对象）不得有循环。在您的情况下，您的父节点拥有其子节点，反之亦然。

当根节点被删除时，它的构造函数会首先删除左孩子。孩子的析构函数将删除已经被删除的父母。

树中典型的所有权关系是父节点拥有它们的子节点。孩子有一个指向不携带所有权的父母的指针。该指针将在子节点的生命周期内保持有效，因为子节点将作为父节点销毁的一部分被删除。

所以你的析构函数应该简单地做：

```
BST_Node::~BST_Node() {
   delete left;
   delete right;
} 
```

补充说明：

*   您不需要检查空指针 - 删除空指针是安全的，并且不会执行任何操作。
*   您应该防止复制 BST_Node 对象。隐式定义的复制构造函数和复制赋值运算符将创建另一个拥有相同子节点的对象，也会导致对象的双重删除。

表达指针所有权语义的最佳方式是使用合适的智能指针类。在您的情况下，最合适的声明是

```
class BST_Node {
    public:
        ~BST_Node() = default; // you can simply omit this completely

        // other things

        BST_Node* parent; // no ownership
        std::unique_ptr<BST_Node> left;  // exclusive ownership
        std::unique_ptr<BST_Node> right;
}; 
```

作为一个有用的附加效果，隐式生成的复制操作将被抑制，因为`std::unique_ptr<T>`不可复制。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:39:08.103

只是通过代码运行，我在这一部分看到了一个问题

> ```
>  if (l_tmp)
>         l_tmp->parent = p;
>     p->left = l_tmp;
>     BST_Node* r_tmp = CreateTree(a, mid+1, end);
>     if (r_tmp)
>         r_tmp->parent = p;
>     p->right = r_tmp; 
> ```

`l_tmp->parent`并且`r_tmp->parent`都指向同一个节点`p`。因此，节点 p 被双重删除，一次是在调用 l_tmp 的析构函数时，另一次是在调用 r_tmp 的析构函数时。这可能是您看到错误的原因。正如 Andy 在评论中所建议的，这似乎是使用智能指针的好场景。

# c# - C# 什么是“？” 操作员

> ID：14665083
> 
> 赞同：9
> 
> 时间：2013-02-02T18:31:51.620
> 
> 标签：c#, .net

> **可能重复：**
> [布尔值是什么？返回类型是什么意思？](https://stackoverflow.com/questions/5064806/what-does-the-bool-return-type-mean)

我在一个班级中遇到了以下财产

```
public long? EmployeeId { get; set; } 
```

我用谷歌搜索了这个运算符，但没有运气，根据 MSDN [MSDN OPERATOR](http://msdn.microsoft.com/en-us/library/6a71f45d.aspx)，只有运算符`??` null-coalescing 运算符和`?:`条件运算符。但是关于`?`

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-02T18:32:53.680

在这种情况下`?`不是运营商。这是一种更短的写法：`Nullable<long>`

`T?``Nullable<T>`与（具有`T`类型）完全相同

它被称为可空类型（参见[MSDN](http://msdn.microsoft.com/en-us/library/2cf62fcy%28v=vs.100%29.aspx)）

它用于允许为“不可为空”类型（如`int`、`long`、 a `struct`）分配一个`null`值。

当您需要值类型的可能无效状态时，或者从可能包含空值的数据库中检索数据时，它很有用。

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-02T18:33:10.990

这不是操作员。这是[Nullable 类型](http://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.80).aspx)的简写。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T18:33:06.803

它是一个可以为空的类型。看这里：

[http://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.80).aspx](http://msdn.microsoft.com/en-us/library/1t3y8s4s(v=vs.80).aspx)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T18:33:32.947

> 语法 T? 是 System.Nullable 的简写，其中 T 是值类型。这两种形式可以互换。

来源： [看这里](http://msdn.microsoft.com/en-us/library/1t3y8s4s%28v=vs.80%29.aspx)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T18:46:00.677

它使类型可以为空，这是将 null 分配给结构所必需的。

# c# - 具有继承模板类参数的集合

> ID：14665084
> 
> 赞同：0
> 
> 时间：2013-02-02T18:31:53.523
> 
> 标签：c#, templates, inheritance

对我来说，这样做是完美的：

```
public class A { }
public class B : A { }

public class C
{
    public List<A> b = new List<B>();
} 
```

List 期望元素属于 A 类，对于 List 也是如此。我知道存在类型不匹配，但从逻辑上讲，编译器允许这种不匹配是完全合理的。为什么不？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:38:24.830

`List<B>`不能分配给`List<A>`一个很好的理由。

让我们假设允许不匹配，让我们想象一下您的类中的以下假想方法`C`：

```
public void DoSomething()
{
    b.Add(new A()); // (1)
    List<B> tmp = (List<B>)b; // (2)
    foreach (B item in tmp) { // (3)
        // ...
    }
} 
```

*   第 (1) 行有效，因为`b`它是作为`A`项目列表输入的，所以很自然地，我们可以`A`向`b`.
*   第 (2) 行有效，因为引用的实例`b`实际上是 的实例`List<B>`，所以强制转换是有效的。
*   第 (3) 行将崩溃，因为`b`包含不属于 类型的项目`B`。`tmp`这是 type的事实`List<B>`保证列表的所有项目都是 type ，但如果允许分配to `B`，情况就不再如此了。`List<B>``List<A>`

因此，编译器不允许这种不匹配。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:49:09.643

因为如果列表存储在`List<A>`变量中，程序期望能够将类型的对象`A`放入该变量中。`List<B>`将对象存储在`List<A>`变量中会阻止您将类型的对象放入`A`明确声明能够保存类型的列表中`A`。

那是：

```
List<A> b = new List<B>()
// compiler knows list should be of type A, so it expects this to work:
b.add(new A()); 
```

但是，如果您可以将 a 分配`List<B>`给`List<A>`变量，则会产生类型错误，即使编译器*知道*该变量`b`是类型的`List<A>`，因此应该能够保存类型`A`对象。

相反，您只需使用`new List<A>`并向其添加类型的元素`B`，这是允许的，或者您将变量的类型更改为`List<B>`.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:47:00.340

您期望`List<T>`在 中是协变的`T`，但事实并非如此。

在 C# 中，一些*接口*是协变的，但类不是。和上面一样`A`，`B`可以说

```
IEnumerable<A> b = new List<B>(); 
```

或者

```
IReadOnlyList<A> b = new List<B>(); 
```

因为有问题的接口是协变的，即用“out”声明，如

```
public interface IEnumerable<out T> ...

public interface IReadOnlyLies<out T> ... 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T19:15:57.767

您无法使用类来实现这一点。您可以使用接口（查找协变和逆变），但不能在使用`List`/时使用`IList`。想象以下场景：

```
public class MyClass<T> 
{
    T GetT() { /* Blah blah */ }
    void SetT(T value) { /* Blah Blah */ }
} 
```

写这个：

```
MyClass<object> example = new MyClass<string>(); 
```

这适用于第一种方法；`example`应该返回一个`object`, 并`MyClass<string>`返回一个字符串，由于多态性，这是合法的。

第二种方法问题更大。假设你后来写了这个：

```
example.SetT(new object()); 
```

这是非法的，因为`MyClass<string>`期望 a`string`但得到`object`. 不好。

您可以使用前面提到的协变和逆变来使接口工作。你可以写一个这样的接口：

```
public interface Covariant<out T>
{
    T FunctionReturningT();
}

public class MyInterfaceImplementation<T> : Covariant<T>
{
    public T FunctionReturningT() { /* Blah Blah */ }
} 
```

使接口**covariant**，这意味着它是合法的写：

```
Covariant<object> example = new MyInterfaceImplementation<string>(); 
```

而您也可以编写以下内容：

```
public interface Contravariant<in T>
{
    void FunctionAskingForT(T value);
}

public class MyInterfaceImplementation<T> : Contravariant<T>
{
    public void FunctionAskingForT(T value) { /* Blah Blah */ }
} 
```

您刚刚使该接口**contravariant**，这意味着这样写是合法的：

```
Contravariant<string> example = new MyInterfaceImplementation<object>(); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T18:37:54.010

这取决于泛型容器是否设置了**[协变](http://msdn.microsoft.com/en-us/library/dd469487.aspx)**或**[逆变](http://msdn.microsoft.com/en-us/library/dd469484.aspx)**泛型参数。

您可以查看 MSDN 以了解它是如何声明的。

# ios - 从 Core Data 中删除和添加存储

> ID：14665090
> 
> 赞同：0
> 
> 时间：2013-02-02T18:32:29.543
> 
> 标签：ios, core-data, nsmanagedobject

我在 Core Data 中存储了一些敏感信息，如密码等。我希望我的应用程序在应用程序进入后台或终止时加密整个 SQLite 数据库（它不是很大，< 1 MB）。我自己弄清楚了加密的事情，但是我在正确“关闭”并重新打开商店的核心数据堆栈时遇到了问题。

当我的应用程序终止/进入后台时，我现在这样做：

*   保存上下文
*   从协调器中删除存储
*   加密存储并保存
*   删除商店

当我的应用程序返回时，我执行以下操作：

*   解密并保存存储文件
*   将商店添加回协调器
*   重置上下文

根据我从文档中了解到的情况，这应该足够了，但是一旦主视图控制器尝试再次对上下文进行提取，我的应用程序就会崩溃。

有谁知道从核心数据中暂时删除商店然后再次添加它的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T20:10:58.923

这不是您问题的答案，但值得一说：

**你的加密策略存在致命缺陷，我强烈建议你想出一个不同的方案。**

如果数据应该在磁盘上加密，并且实际上值得加密，则永远不应该以未加密状态将其写入磁盘，原因如下：

*   **如果应用程序强制退出，或设备断电，文件在磁盘上仍保持未加密状态**。然后有人可以四处寻找未加密的数据。

*   **删除存储文件的普通版本很可能不会*安全地*删除文件**，因此磁盘分析/工具可以找到文件的未加密版本。

如果要在写入磁盘时加密数据，则**必须每次将加密的数据写入磁盘，无一例外**。“它有时是加密的”是没有用的。

作为替代策略，您可能需要考虑对存储在核心数据本身中的数据进行加密。例如，您可以 NSArchive 您的数据并在将结果数据字节存储为 BLOB 之前对其进行加密。

# html - 可以做成圆形吗？六边形、八边形等形状？

> ID：14665093
> 
> 赞同：-4
> 
> 时间：2013-02-02T18:32:37.297
> 
> 标签：html, css, shapes

一段时间以来，我一直在尝试圆角六边形，但是我发现我的方法都不起作用。你们对如何做到这一点有什么建议吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:55:08.167

[http://jsfiddle.net/9BTTQ/4/](http://jsfiddle.net/9BTTQ/4/)

# HTML

```
<div class="hexagon">
    <div>1</div>
    <div>2</div>
    <div>3</div>
</div> 
```

# CSS

```
.hexagon {
    position: relative;    
}

.hexagon > DIV {
    position: absolute;
    top: 0;
    left: 48px;
    -moz-border-radius: 16px;
    border-radius: 16px;
    width: 64px;
    height: 96px;
    background-color: blue;
}

.hexagon > DIV:nth-child(2) {
    -moz-transform: rotate(60deg);
    -ms-transfrom: rotate(60deg);
    -webkit-transform: rotate(60deg);
    transform: rotate(60deg);
}

.hexagon > DIV:nth-child(3) {
    -moz-transform: rotate(120deg);
    -ms-transfrom: rotate(120deg);
    -webkit-transform: rotate(120deg);
    transform: rotate(120deg);
} 
```

笔记：

*   除非它是一个孤立的需要，否则这可能会更好地使用 SVG 或画布来完成。创建一堆元素来形成一个形状既没有语义又乏味。

*   `transform`由于,`border-radius`和, IE 7/8 根本无法工作`nth-child`。

*   您会注意到边界半径大小、宽度和高度之间的简单数学关系。

*   [该站点](http://css-tricks.com/examples/ShapesOfCSS/)显示了许多其他可以生成的有趣形状。

# android - javax.net.sslException no trust server certificate for Android App 获取 android 2.3 版本错误

> ID：14665095
> 
> 赞同：1
> 
> 时间：2013-02-02T18:33:03.813
> 
> 标签：android

我在 wi-fi 连接上收到 Android 应用程序错误`javax.net.sslException no trusted server certificate`，但我的 android 应用程序在 4.0 及更高版本上运行良好，我已经测试过。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:09:12.623

根本原因可能是您服务器上的 SSL 证书是由您的旧（Gingerbread）设备无法识别并因此不信任的证书颁发机构 (CA) 签署的。如果您使用的是自签名证书，这是一个常见问题。如果您使用的是更新的或鲜为人知的 CA，也可能会发生这种情况。

理想的解决方案是将服务器的公共证书添加到应用的受信任存储中。[（这里](http://blog.crazybob.org/2010/02/android-trusting-ssl-certificates.html)的例子。）

用于测试目的的一个不太理想的~~解决方案~~是[不验证证书](https://stackoverflow.com/questions/995514/https-connection-android#1000205)；但[请注意安全风险](https://stackoverflow.com/questions/995514/https-connection-android#comment12047258_1000205)！

**编辑**：

在较旧的 Android 设备上，类似的问题（例如[这个](https://stackoverflow.com/questions/9574870/no-peer-certificate-error-in-android-2-3-but-not-in-4?rq=1)）已通过从 切换`HttpClient`到`HttpsUrlConnection`.

# php - 类属性中的 PHP 函数调用

> ID：14665097
> 
> 赞同：4
> 
> 时间：2013-02-02T18:33:07.753
> 
> 标签：php, static, pdo, singleton

为什么我不能在 PHP 中执行此操作？单例类在哪里`Database`，getInstance() 返回一个 PDO 对象。

```
<?php

class AnExample
{
    protected static $db = Database::getInstance();

    public static function doSomeQuery()
    {
        $stmt = static::$db->query("SELECT * FROM blah");
        return $stmt->fetch();
    }
} 
```

> 与任何其他 PHP 静态变量一样，静态属性只能使用文字或常量进行初始化；不允许表达。因此，虽然您可以将静态属性初始化为整数或数组（例如），但您不能将其初始化为另一个变量、函数返回值或对象。

[http://php.net/manual/en/language.oop5.static.php](http://php.net/manual/en/language.oop5.static.php)

为什么？！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:36:40.900

[http://php.net/language.oop5.properties](http://php.net/language.oop5.properties)

> Class member variables are called "properties". You may also see them referred to using other terms such as "attributes" or "fields", but for the purposes of this reference we will use "properties". They are defined by using one of the keywords public, protected, or private, followed by a normal variable declaration. **This declaration may include an initialization, but this initialization must be a constant value--that is, it must be able to be evaluated at compile time and must not depend on run-time information in order to be evaluated.**

The important part is

> that is, it must be able to be evaluated at compile time

Expressions were evaluated at runtime, so it isn't possible to use expression to initialize properties: They are simply not evaluatable yet.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:36:33.770

即时通讯 ;)

请参阅 PHP 文档中第一段的最后一句以获取属性[http://www.php.net/manual/en/language.oop5.properties.php](http://www.php.net/manual/en/language.oop5.properties.php)

> 这个声明可能包括一个初始化，但是这个初始化必须是一个常量值——也就是说，它必须能够在编译时被评估，并且不能依赖于运行时信息才能被评估。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:57:16.937

You can't execute code to produce the value of a static variable as, by definition, static variables are affected at compile time, see :

*   [http://en.wikipedia.org/wiki/Static_memory_allocation](http://en.wikipedia.org/wiki/Static_memory_allocation)
*   [http://en.wikipedia.org/wiki/Static_variable](http://en.wikipedia.org/wiki/Static_variable)

Getting the run-time value of a variable, or calling a function (run-time too) can't be done at compile-time to they cannot be affected to static variables.

# jquery - 创建一个 jQuery 图像滑块

> ID：14665098
> 
> 赞同：0
> 
> 时间：2013-02-02T18:33:09.217
> 
> 标签：jquery

我正在尝试使用 jQuery 开发一个图像滑块，仅用于学习目的。我的代码工作正常，但是当我到达最后一张幻灯片时，它的工作非常尴尬，我只希望用户在第一张幻灯片上然后点击下一个按钮，然后用户跳转到第一张幻灯片。请检查给定的链接，请帮助我...

[关联](http://jsfiddle.net/VMZ8J/)

**HTML**

```
<div id="wrapper">
    <div class="slider_cont">
        <ul>
            <li>first slide</li>
            <li>second slide</li>
            <li>third slide</li>
            <li>fourth slide</li>
        </ul>
    </div>

    <div class="button">
        <button data-dir="prev">pev</button>
        <button data-dir="next">next</button>
    </div>
</div> 
```

**CSS**

```
body{margin:0; padding:0;}
*{margin:0; padding:0;}
#wrapper{width:300px; margin:0 auto; padding:100px 0 0;}
.slider_cont{width:300px; height:100px; overflow:hidden; position:relative;}
.slider_cont ul{width:10000px; position:absolute;}
.slider_cont ul li{ list-style:none; float:left; width:300px; height:100px; text-align:center; color:#fff; background:#ccc;}

.button{padding:30px 0 0;}
.button button{padding:10px; margin:0 20px 0 0;} 
```

**脚本**

```
var imageWidth = $('.slider_cont ul li').width(),
    imageLen =  $('.slider_cont ul li').length,
    totalWidth = imageWidth * imageLen,
    current = 1,
    lastWidth = totalWidth - imageWidth;

$('button').on('click',function(){
    var direction = $(this).data('dir');    
    (direction == 'next')?++current:--current;
    var Unit = (direction == 'next')?'-=':'+=';
    var curUnite = Unit+imageWidth;
    alert(curUnite)
    if(current!=0)
    {

        $('.slider_cont ul').animate({
            left: curUnite+'px',
            }, 500, function() {
            // Animation complete.
            });

        }

            if(current==0)
    {

        $('.slider_cont ul').animate({
            left: '-='+lastWidth+'px',
            }, 500, function() {
            current = imageLen;
                    });

        }
        if(current>imageLen)
        {
            $('.slider_cont ul').animate({
            left: '0px',
            }, 500, function() {
            current = 1;

            });
            }   
    }) 
```

任何帮助和建议将不胜感激:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T18:37:15.360

你这样做：

```
 if (current == 0) {

    $('.slider_cont ul').animate({
        left: '-=' + lastWidth + 'px',
    }, 500, function () {
        current = imageLen;
    });

}
else if (current > imageLen) {
    $('.slider_cont ul').animate({
        left: '0px',
    }, 500, function () {
        current = 1;

    });
}
else if (current != 0) {

    $('.slider_cont ul').animate({
        left: curUnite + 'px',
    }, 500, function () {
        // Animation complete.
    });

} 
```

这就是奇怪动画的来源。因为你排队第二个。Whichc 跳回到开头。将第一个动画放在 else 语句中。你不会有奇怪的跳跃。

现场示例：http: [//jsfiddle.net/VMZ8J/3/](http://jsfiddle.net/VMZ8J/3/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T18:43:06.363

`**[jsFiddle demo](http://jsfiddle.net/VMZ8J/6/)**`

```
var imageWidth = $('.slider_cont ul li').width(),
    imageLen =  $('.slider_cont ul li').length,
    counter = 0;

$('button[data-dir]').click(function(){

    var dir = $(this).data('dir') == 'next' ? counter++ : counter-- ;
    counter = counter<0 ? imageLen-1 : counter%imageLen ;
    $('.slider_cont').stop().animate({scrollLeft: imageWidth*counter},800);

}); 
```

# c# - 创建一个固定在桌面上的不可最小化的窗口

> ID：14665099
> 
> 赞同：0
> 
> 时间：2013-02-02T18:33:09.123
> 
> 标签：c#, wpf, drag-and-drop

我考虑过创建一个简单的文件共享应用程序。它应该易于使用和直观：只需从您的文件系统中选择一个文件并将其拖放到例如屏幕的右上角，文件就会分布在 LAN 中。

问题在于，一旦用户按下`Win + D`指定的拖放区，就会最小化或变得不可见。我已经尝试过一些[这样](https://stackoverflow.com/questions/2794612/pin-wpf-window-on-the-desktop-in-windows-7)或[这样](https://stackoverflow.com/questions/3350934/pin-to-desktop-in-win-7-xp-compatible)的解决方案，但对于我的程序而言，它们似乎都不“正确”。可能你们中的一些人会知道能够以这种方式运行的程序（我知道一个能够这样做的程序，但我不记得它的名字......）

除此之外的一切都在工作，我有一个支持多个文件传输的普通 UI 和一个用于共享网络链接的集成聊天。

关于如何添加这个非常特殊的功能的任何想法？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:10:14.710

尝试处理最小化事件并恢复窗口。关于窗口最小化事件的检测，请参阅[this 。](https://stackoverflow.com/questions/938924/get-the-minimize-box-click-of-a-wpf-window)

# jsf - Primefaces 命令按钮在 ajax 开启时停止文件上传

> ID：14665104
> 
> 赞同：0
> 
> 时间：2013-02-02T18:33:24.930
> 
> 标签：jsf, file-upload, primefaces

有一个奇怪的问题，我有一个 primefaces 命令按钮：

```
<p:commandButton action="#{userBean.buttonToUploadText}" value="Submit" icon ="ui-icon-arrowstop-1-n"/> 
```

用户Bean.java

```
public String buttonToUploadText() {
    System.out.println("buttonToUploadText invoked"); //testing to make sure it is called
    return "/upload/uploadText.xhtml";
} 
```

这一切应该做的只是将用户带到上传文本页面，它会这样做，但是每当我有这个按钮时，文件上传什么都不做，但是第二个我编辑这个命令按钮并使用一个正常的文件上传工作完美吗？我究竟做错了什么

编辑：

刚刚发现ajax是假的，它工作得很好，为什么会这样？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T01:30:29.233

您没有显示所有代码，但如果您的 PrimeFaces 文件上传组件具有`mode="simple"`. 这将生成一个`<input type="file">`没有任何 JS/Ajax 支持的原生 HTML。这需要一个带有 的命令按钮`ajax="false"`，正如[展示](http://www.primefaces.org/showcase/ui/fileUploadSimple.jsf)中所示。

如果您希望能够通过 ajax 上传文件并提交表单，请使用`mode="advanced"`. 另请参阅[陈列柜](http://www.primefaces.org/showcase/ui/fileUploadSingle.jsf)。

### 也可以看看：

*   [如何使用 PrimeFaces p:fileUpload？侦听器方法从未被调用或 UploadedFile 为空](https://stackoverflow.com/questions/8875818/how-to-use-primefaces-pfileupload-listener-method-is-never-invoked/8880083#8880083)

# xquery - Xquery 如何在服务器上工作

> ID：14665108
> 
> 赞同：0
> 
> 时间：2013-02-02T18:34:00.870
> 
> 标签：xquery

我不确定 Xquery 如何在服务器上工作。我知道语法，但不确定如何为我的网站实现它。

例如。我有将用户名和密码存储在 XML 文件中的站点。现在我想验证登录或注册的用户名和密码。

我怎样才能做到这一点？我是否只是编写一个 Xquery 文件并上传到服务器然后调用它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:25:40.410

请在下面找到在 Sausalito 之上运行的基本身份验证模块的示例。

```
module namespace auth = "[project logical uri]lib/auth";

import module namespace base64 = "http://www.zorba-xquery.com/modules/converters/base64";

import module namespace req = "http://www.28msec.com/modules/http/request";
import module namespace res = "http://www.28msec.com/modules/http/response";

declare variable $auth:login := "login";
declare variable $auth:password := "password";

declare function auth:authorize() as empty-sequence()
{
 let $auth := "Basic " || string(base64:encode($html:login || ":" || $html:password)) eq  req:header-value("Authorization")
 return
  if(not($auth) and not($unprotected)) then
    error($res:unauthorized);
  else
    (); 
}; 
```

# sql - 检查列表中的每个数字是否与 int4range[] 中的范围匹配

> ID：14665109
> 
> 赞同：4
> 
> 时间：2013-02-02T18:34:16.750
> 
> 标签：sql, arrays, postgresql, range, postgresql-9.2

我有一个字段：`ages pg_catalog.int4range[][][]`
示例值`{"[0,6)","[8,10)"}`表示 2 个范围 0-6 和 8-10。
如何在 WHERE 子句中添加正确的条件以进行检查：

*   9 和 3 拟合示例值
*   9 和 9 不适合（每个范围应该只有一个值）

类似的东西`WHERE ages <@ ARRAY[9,3]`，`WHERE ages <@ ARRAY[9,9]`

**更新**
逻辑描述了应用儿童年龄规则的合同条件。我认为将所有数据保存在一个字段中并避免多个检查和比较阶段是很有吸引力的 - 只是为了使值和范围相交。
范围数通常是可变的，可以是 1、2、3、4 等。检查的值被计数并仅应用于匹配的范围数 - 如果 3 个年龄，则只有内部具有 3 个范围的数组。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T23:18:15.047

### 澄清问题

你的问题显示一个一维数组。所以使用正确的列定义：

```
ages int4range[] 
```

除了令人困惑之外，这并不是说它有任何区别。我引用手册[中的数组类型声明](http://www.postgresql.org/docs/current/interactive/arrays.html#ARRAYS-DECLARATION)一章：

> 当前的实现也不强制声明的维数。无论大小或维数如何，特定元素类型的数组都被认为是同一类型。因此，在其中声明数组大小或维数 `CREATE TABLE`只是文档；它不会影响运行时行为。

此外，这个问题本身是模棱两可的。前任。：

```
INSERT INTO tbl(ages) VALUES ('{"[0,6)","[5,9)","[8,10)"}') 
```

测试：`'{5,8,7}'::int[]`。

如果按顺序应用，则检查*失败*：
`5`适合 1st range `[0,6)`。
`8`适合第二个范围`[5,9)`。
`7`不适合第三个范围`[8,10)`。

但是，以不同的顺序应用`5,7,8`，检查*成功*。你需要

1.  要么保证不重叠的间隔。
2.  或按定义的顺序应用检查。
3.  澄清两边的元素数量总是匹配的。

最后，在问题中编辑有关您尝试做什么的解释。不要在评论中隐藏重要信息。

## 回答

根据评论，假设上面目录中的 1.、2.和 3.。此查询测试所有`ages`( `array of int4range`)`tbl`是否符合提供的`age_list`( `int[]`)：

```
WITH tbl(id, ages) AS (
   VALUES
     (1, '{"[0,2)","[4,6)","[8,10)"}'::int4range[])
    ,(2, '{"[2,4)","[6,8)","[9,10)"}')
   )                                    -- stand-in for table
SELECT id, bool_and(i <@ r) AS passes_test
FROM  (
   SELECT id
         ,unnest('{1,5,9}'::int[]) AS i -- supply age_list here
         ,unnest(ages)             AS r
   FROM tbl
   ) AS sub
GROUP  BY 1 
```

回报：

```
 id | passes_test
----+------------
  1 | t
  2 | f 
```

### 要点

*   CTE`tbl`只是您桌子的替代品。如果`tbl`确实存在，您可以将其删除。

*   这两个[`unnest()`](http://www.postgresql.org/docs/current/interactive/functions-array.html#ARRAY-FUNCTIONS-TABLE)函数并排取消嵌套两个数组。我添加`id`（任何唯一列）来标识行。

*   [`<@`使用运算符](http://www.postgresql.org/docs/current/interactive/functions-range.html#RANGE-OPERATORS-TABLE)检查每个元素是否包含在范围内，然后使用 重新聚合[`bool_and`](http://www.postgresql.org/docs/current/interactive/functions-aggregate.html)。`TRUE`当且仅当所有检查都是 时返回`TRUE`。

# java - 使第一个和最后一个 JList 项目突出显示平方

> ID：14665110
> 
> 赞同：0
> 
> 时间：2013-02-02T18:34:21.990
> 
> 标签：java, swing, jlist, nimbus

我正在使用 Nimbus 的外观和感觉。当我有一个 JList 并选择第一个或最后一个项目时，突出显示是四舍五入的。通常它是一个正方形。

![在此处输入图像描述](../Images/719b5a0f45489af1fcf335a1427d476b.png)

如何将其更改为与其他元素一样的正方形？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T18:18:34.653

我不小心将 BorderFactory 更改为使用带圆角的 Line Border。删除后，单元格正确显示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T09:35:54.453

你可以定义你自己的[`ListCellRenderer`](http://docs.oracle.com/javase/7/docs/api/javax/swing/ListCellRenderer.html)，给它你喜欢的可视化。

# javascript - 当 URL 带有 www 时，XMLHttpRequest 无法加载

> ID：14665111
> 
> 赞同：1
> 
> 时间：2013-02-02T18:34:30.833
> 
> 标签：javascript, jquery

我已经在我的网站上使用 jQuery 实现了自动建议脚本。当浏览器使用 www ( ie ) 搜索建议加载我的网站时`www.xyz.com`不起作用并在浏览器控制台中打印以下错误：

> XMLHttpRequest 无法加载 [http://xyz.com/json.php?json=true&limit=15&input=testing](http://xyz.com/json.php?json=true&limit=15&input=testing)。Access-Control-Allow-Origin 不允许来源 [http://www.xyz.com 。](http://www.xyz.com)

我知道 jQuery / Chrome 不允许我进行跨域 AJAX 调用，但是当我在没有 www（即只是`xyz.com`）的情况下访问我的网站时，一切正常。我怎么解决这个问题 ？有没有人对此有想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:41:37.697

您违反了[同源政策限制](http://en.wikipedia.org/wiki/Same_origin_policy)。

`http://www.xyz.com`并且`http://xyz.com`根据此政策被视为跨域。

`$.ajax()`要解决此问题，只需在您的请求中使用相对 url ：

```
$.ajax({
    url: '/json.php',
    ...
}); 
```

而不是绝对：

```
$.ajax({
    url: 'http://xyz.com/json.php',
    ...
}); 
```

# r - 移动平均线和移动季度数据

> ID：14665114
> 
> 赞同：2
> 
> 时间：2013-02-02T18:35:11.020
> 
> 标签：r, moving-average

我有一个每日时间序列数据，并希望构建一个每日移动平均线并创建一个季度数据框。例如，第一个数据集（示例数据）应该包括一月、二月和三月的每日数据，而第二个系列应该是二月、三月和四月。同样，最后一个数据集应该是 10 月、11 月和 12 月的数据集。我希望对样本数据中的变量“tmpd、pm10median 和 so2median”执行此操作。我怎样才能做到这一点？

```
library(gamair) 
data(chicago) 
chicago$date<-seq(from=as.Date("1987-01-01"), to=as.Date("2000-12-31"),length=5114)
data<- chicago[,c("date","tmpd", "pm10median", "so2median" )] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:58:49.867

使用`xts`package ，你可以做这样的事情

```
library(xts)
dat.ts <- xts(x=data[,-1],                   ## create an xts object 
              order.by=as.Date(data[,1]))    ## coerce the index to date
dat.quart <- apply.quarterly(dat.ts,mean)    ## apply for each quarter 
```

要显示一些行：

```
 rbind(head(dat.quart),tail(dat.quart))
               tmpd pm10median  so2median
1987-03-31 33.60556         NA         NA
1987-06-30 62.19231         NA -0.3283393
1987-09-30 71.31522         NA -1.9137842
1987-12-31 41.09783         NA         NA
1988-03-31 27.06593         NA         NA
1988-06-30 60.48352         NA         NA
1999-09-30 71.01087   2.697414 -0.4532943
1999-12-31 42.86957   1.565251 -0.4035715
2000-03-31 34.74725  -4.704813  0.2392453
2000-06-30 59.07692         NA -0.5426823
2000-09-30 69.67391         NA -1.9221470
2000-12-31 36.59783         NA -0.2387025 
```

更新

看起来 OP 想要按季度拆分移动平均线系列。

```
dat.ts <- xts(x=data[,-1],                   ## create an xts object 
              order.by=as.Date(data[,1]))    ## coerce the index to date
dat.m <- rollmean(dat.ts,k=2)                ## compute the MA
ep <- endpoints(dat.m, "quarters")           ## create an index
## this split the seriers by quarter
xx <- sapply(1:(length(ep) - 1), function(y) { 
  dat.m[(ep[y] + 1):ep[y + 1]]
}) 
```

# node.js - 为 REST api NodeJS MongoDB 编写测试

> ID：14665115
> 
> 赞同：4
> 
> 时间：2013-02-02T18:35:28.320
> 
> 标签：node.js, testing, express, integration-testing, mocha.js

我正在使用 Mongoose 在 ExpressJS 中编写一个小型 REST API。我已经为应用程序内的所有逻辑编写了单元测试。现在唯一未测试的是 API 是否返回正确的状态代码，以及受限资源是否实际上受到限制。

**到目前为止我已经尝试过：**

我尝试使用[Request](https://github.com/mikeal/request)对资源执行 GET/POST/PUT/DELETE，但我发现将东西扔到数据库中非常笨拙，保留对对象的引用并稍后再次删除它。

这是解决这个问题的最聪明的方法吗？如果我需要通过实际数据库的实际请求来测试某些东西，我的实现是否错误？

如果这是测试 API 的首选方式，是否有必要将内部功能作为一个完整的解决方案进行测试，或者我应该只测试状态代码和访问权限。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T22:31:39.347

我们通常创建一个测试数据库并使用 NODE_ENV='test' ... 运行测试，这会触发与测试数据库的连接。

这样您就可以毫无问题地擦除测试数据库，并且您不必担心在测试之前/之后进行清理。

REST 测试的一个有用工具是 superagent（或 supertest，虽然我更喜欢 agent）：

*   [https://github.com/visionmedia/superagent](https://github.com/visionmedia/superagent)
*   [https://github.com/visionmedia/supertest](https://github.com/visionmedia/supertest)

全面披露：我是 superagent 的贡献者。

# php - 我应该如何更改工作表并添加一列来跟踪时间？

> ID：14665117
> 
> 赞同：1
> 
> 时间：2013-02-02T18:35:32.220
> 
> 标签：php, mysql, performance

我有一张桌子，大约有 30 列。它被几个不同的 PHP 页面使用。

我将在此表中添加一个时间列。查询中不会选择 3 个月或更早发布的行。

所以，我的想法很少。

1.  添加一个带有 INT 的“时间戳”列，使用 PHP microtime() 进行计算。
2.  依赖 PHP 的日期函数。
3.  在 MySQL 本身中处理这个过程。

    *   我正要使用第一个选项，因为它很容易维护整数。
    *   我一直担心 PHP 日期函数的标准化，所以以前从不依赖它们。例如，在一张桌子上我可以做 12.12.2012，在另一张桌子上我可以做 12.12.2012 13:00 或类似的事情。
    *   该网站在共享主机上运行，​​所以将来我可能会移动另一个主机，我不知道“导出向导”是否也导出那些预设值/触发器等。

简而言之，您将如何做到这一点？你还有什么可以给我建议的吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T18:41:40.130

我认为如果 MySQL 什么都做，它会表现得更好。

会像以下工作吗？

```
SELECT *
FROM table_name
WHERE timestamp_column >= UNIX_TIMESTAMP(NOW()) - 60 * 60 * 24 * 90 
```

# android - 如何设置链接网址+可点击文本

> ID：14665118
> 
> 赞同：0
> 
> 时间：2013-02-02T18:35:37.543
> 
> 标签：android, textview, android-alertdialog

我正在尝试设置链接 url 和链接以开始花药活动。这是我的代码，它与 html 链接一起工作，但不知道如何做链接来启动另一个活动。

我的代码示例：

```
final AlertDialog d = new AlertDialog.Builder(this)
            .setPositiveButton(android.R.string.ok, null)
            .setMessage(Html.fromHtml(getResources().getString(R.string.infoAuthor)+" <br> <a href=\"https://www.youtube.com">click here for help</a>"))
            .create();
            d.show();
            // Make the textview clickable. Must be called after show()   
            ((TextView)d.findViewById(android.R.id.message)).setMovementMethod(LinkMovementMethod.getInstance()); 
```

如果你能给出一些代码怎么做。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T14:24:15.747

在你的布局 xml

```
 <TextView
        android:id="@+id/description"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"           
        android:autoLink="web|phone|email"           
        android:text="" /> 
```

网络到网址、电话和电子邮件

您还可以更改颜色 android:textColorLink="@color/linkscolor"

从 xml 膨胀您的视图并使用 setView 方法设置对话框视图

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:22:09.103

试试看这个[帖子](https://stackoverflow.com/questions/1997328/android-clickable-hyperlinks-in-alertdialog)。作者用来完成此操作的代码是：

```
public static class MyOtherAlertDialog {

 public static AlertDialog create(Context context) {
  final TextView message = new TextView(context);
  // i.e.: R.string.dialog_message =>
            // "Test this dialog following the link to dtmilano.blogspot.com"
  final SpannableString s = 
               new SpannableString(context.getText(R.string.dialog_message));
  Linkify.addLinks(s, Linkify.WEB_URLS);
  message.setText(s);
  message.setMovementMethod(LinkMovementMethod.getInstance());

  return new AlertDialog.Builder(context)
   .setTitle(R.string.dialog_title)
   .setCancelable(true)
   .setIcon(android.R.drawable.ic_dialog_info)
   .setPositiveButton(R.string.dialog_action_dismiss, null)
   .setView(message)
   .create();
 }
} 
```

同一篇文章中对上述内容的另一种选择是：

```
 // Linkify the message
    final SpannableString s = new SpannableString(msg);
    Linkify.addLinks(s, Linkify.ALL);

    final AlertDialog d = new AlertDialog.Builder(activity)
        .setPositiveButton(android.R.string.ok, null)
        .setIcon(R.drawable.icon)
        .setMessage( s )
        .create();

    d.show();

    // Make the textview clickable. Must be called after show()
    ((TextView)d.findViewById(android.R.id.message)).setMovementMethod(LinkMovementMethod.getInstance()); 
```

# ruby-on-rails - Google Drive 上的服务帐户需要登录

> ID：14665121
> 
> 赞同：0
> 
> 时间：2013-02-02T18:35:58.510
> 
> 标签：ruby-on-rails, ruby, google-drive-api, google-api-ruby-client

我正在尝试使用 Ruby on Rails 应用程序创建/查看 Google Doc。我认为我可以创建文档，但是当我单击从 API 回调中获得的链接时，我收到错误 401：需要登录。

这是我用来创建文档的代码。

```
key = Google::APIClient::PKCS12.load_key(SERVICE_ACCOUNT_PKCS12_FILE_PATH, 'notasecret')
asserter = Google::APIClient::JWTAsserter.new(SERVICE_ACCOUNT_EMAIL,
    'https://www.googleapis.com/auth/drive', key)
client = Google::APIClient.new
client.authorization = asserter.authorize()
drive = client.discovered_api('drive', 'v2')
puts 'hello'
file = drive.files.insert.request_schema.new({
  'title' => 'My document',
  'description' => 'A test document',
  'mimeType' => 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'
})
puts 'world'
media = Google::APIClient::UploadIO.new(Rails.root.to_s + '/app/assets/documents/document.doc', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document')
result = client.execute(
  :api_method => drive.files.insert,
  :body_object => file,
  :media => media,
  :parameters => {
  'uploadType' => 'multipart',
  'alt' => 'json'}
)

puts '==========='
puts result
puts '==========='
jj result.data.to_hash 
```

有什么建议么？

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:36:22.070

如果您单击的链接是 ，`downloadUrl`那么这在浏览器中将不起作用。您应该`webContentLink`在浏览器中使用并登录 Google。

# css - div 标签的高度被忽略

> ID：14665126
> 
> 赞同：3
> 
> 时间：2013-02-02T18:36:32.367
> 
> 标签：css, html

我确信这是我正在做的愚蠢的事情，但是自从我弄乱 CSS 以来已经有一段时间了。对于我的生活，我无法弄清楚为什么 div 框没有显示正确的高度（如 CSS 中指定的那样）......以及为什么标题 div 和列之间存在黑色空间块。

任何帮助将不胜感激！我知道这是非常简单的，我只是试图降低主要布局。

谢谢你的帮助！！CSS：

```
#container { width: 1000px; margin: 30px auto 60px;}

    h1 { text-align: center;}

    #header { height: 200 px; width: 1000 px;  background-color: #993300}
    #mcol1 { height: 600; width: 500px; float: left; background-color: #2a9c3b;}
    #mcol2 { height: 600; width: 500px; float: left; background-color: #996666;} 
```

HTML：

```
<div id="container">

<div id="header">
<h1> Name</h1>
</div>
<div id="mcol1">
<h1>Test1</h1>
</div>

<div id="mcol2">
<h1>Test2</h1>
</div>
</div>

</body> 
```

由于我是新手，所以不能直接发布图片，这里有一个链接到它的显示方式：http: [//imgur.com/gW0vY7a](http://imgur.com/gW0vY7a) 谢谢！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:39:21.417

添加**`px`**到每个高度值：

```
#header { height: 200px; width: 1000px;  background-color: #993300}
#mcol1 { height: 600px; width: 500px; float: left; background-color: #2a9c3b;}
#mcol2 { height: 600px; width: 500px; float: left; background-color: #996666;} 
```

[jsfiddle](http://jsfiddle.net/e9uEa/)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T18:41:19.193

不是

```
height: 200 px; 
height: 200; 
```

但

```
height: 200px; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:41:32.537

尝试使用以下命令清除 mcol1 和 mcol2 上的浮点数：

```
 <!-- html -->
          <div id="container">

            <div id="header">
              <h1> Name</h1>
            </div>
            <div id="mcol1">
              <h1>Test1</h1>
            </div>

            <div id="mcol2">
              <h1>Test2</h1>
            </div>
            <div class="clear"></div>
           </div>

           <!-- css -->
           .clear{
             clear:both;
             height:0;
             line-height:1px;
           }
            #mcol1 { height: 600px; width: 500px; float: left; background-color:#2a9c3b;}
            #mcol2 { height: 600px; width: 500px; float: left; background-color: #996666;} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T18:46:36.513

此外，您可能希望将样式溢出隐藏到您的 div 中，尤其是对于 Internet Explorer 中的小型 div

```
style = "overflow: hidden;" 
```

你也可能想下载 reset.css 并将其包含在头部

```
<link rel = "stylesheet" type = "text/css" href = "css/reset.css"/> 
```

# xcode - 如何在 Xcode 4.6 中定义自定义键盘绑定？

> ID：14665129
> 
> 赞同：0
> 
> 时间：2013-02-02T18:36:51.133
> 
> 标签：xcode, keyboard-shortcuts, xcode4.6

我在 Xcode 4.5 中定义/自定义了一些键盘绑定，以便给我更好的打字体验。

只有捷径`selectWord:`是Xcode原来定义的，其他的都是我自己加的。它们在 Xcode 4.5 中运行良好。但是在我将 Xcode 更新到 4.6 之后，它们不再工作，除了`selectedWord`Xcode 定义的。

键绑定文件位于**/Users/jason/Library/Developer/Xcode/UserData/KeyBindings/Default.idekeybindings**

```
<key>Text Key Bindings</key>
    <dict>
        <key>Key Bindings</key>
        <dict>
            <key>@
</key>
            <array>
                <string>moveToEndOfLine:</string>
                <string>insertNewline:</string>
            </array>
            <key>^$D</key>
            <array>
                <string>selectLine:</string>
                <string>copy:</string>
                <string>moveToEndOfLine:</string>
                <string>insertNewline:</string>
                <string>paste:</string>
                <string>deleteBackward:</string>
            </array>
            <key>^$K</key>
            <array>
                <string>deleteToBeginningOfLine:</string>
                <string>moveToEndOfLine:</string>
                <string>deleteToBeginningOfLine:</string>
                <string>deleteBackward:</string>
                <string>moveDown:</string>
                <string>moveToBeginningOfLine:</string>
            </array>
            <key>~w</key>
            <string>selectWord:</string>
        </dict> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-18T16:21:33.823

看来Xcode更新的时候，我们自己定义的快捷功能会被新版Xcode定义的默认快捷功能覆盖。**总之，我们自己定义的捷径功能会消失，我们需要再做一次**。

1.我将以下代码添加回以`/Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/Resources/IDETextKeyBindingSet.plist`再次定义快捷方式功能。

```
 <key>Customerized</key>
  <dict>
    <key>Insert new line in middle</key>
    <string>moveToEndOfLine:, insertNewline:</string>
    <key>Duplicate Current Line</key>
    <string>selectLine:, copy:, moveToEndOfLine:, insertNewline:, paste:, deleteBackward:</string>
    <key>Delete Current Line</key>
    <string>deleteToBeginningOfLine:, moveToEndOfLine:, deleteToBeginningOfLine:, deleteBackward:, moveDown:, moveToBeginningOfLine:</string>
  </dict> 
```

2.转到Xcode中的键绑定设置，并为它们键入新的快捷键。 ![在此处输入图像描述](../Images/340f1417a2ded9bfe24ec667d9c05415.png)

# knockout.js - 如何使用淘汰赛js添加数据破折号属性

> ID：14665131
> 
> 赞同：14
> 
> 时间：2013-02-02T18:36:52.110
> 
> 标签：knockout.js

我需要像 data-id、data-action 这样的属性

```
<div class="dd" id="nestable3">
        <ol class="dd-list">
            <li class="dd-item dd3-item" data-id="13">
                <div class="dd-handle dd3-handle">Drag</div><div class="dd3-content">Item 13</div>
            </li>
            <li class="dd-item dd3-item" data-id="14">
                <div class="dd-handle dd3-handle">Drag</div><div class="dd3-content">Item 14</div>
            </li>
            <li class="dd-item dd3-item" data-id="15">
                <div class="dd-handle dd3-handle">Drag</div><div class="dd3-content">Item 15</div>
                <ol class="dd-list">
                    <li class="dd-item dd3-item" data-id="16">
                        <div class="dd-handle dd3-handle">Drag</div><div class="dd3-content">Item 16</div>
                    </li>
                    <li class="dd-item dd3-item" data-id="17">
                        <div class="dd-handle dd3-handle">Drag</div><div class="dd3-content">Item 17</div>
                    </li>
                    <li class="dd-item dd3-item" data-id="18">
                        <div class="dd-handle dd3-handle">Drag</div><div class="dd3-content">Item 18</div>
                    </li>
                </ol>
            </li>
        </ol>
    </div> 
```

我需要创建属性 data-id="13"。如何使用淘汰赛 js attr 绑定创建它...

* * *

## 回答 #1

> 赞同：28
> 
> 时间：2014-05-14T01:19:39.160

使用 attr 绑定`data-bind="attr: {'data-id': id}"`

# c++ - 放弃 CPU 时间

> ID：14665137
> 
> 赞同：0
> 
> 时间：2013-02-02T18:37:36.670
> 
> 标签：c++, c, cpu

在 C/C++ 中是否有可能“放弃”线程的 CPU 时间？例如：

```
void wait(int s) //Low cpu usage
{
 int tmp = time();
 while(tmp + CLOCKS_PER_SEC * s > time())
  __AbandonCPUTime();
  //Tell cpu to do sth else.
} 
```

我试过 Sleep(0)，但它不起作用。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T18:58:36.070

看看 C++11 的：

```
#include <thread>
std::this_thread::yield(); 
```

您的 CPU 可能支持`_mm_pause()`内在的（`__asm__("pause")`用于 gcc），这可能会或可能不会帮助您。

否则，您将查看特定于操作系统的功能： `sched_yield()`Linux 或`SwitchToThread()`Windows上的 pthreads

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-05-29T22:10:14.327

编辑以更直接地回答问题：您应该等待某些东西（WaitForSingleObject 或 GetMessage 或类似的东西），或者，如果没有事件可以等待 Sleep 一些非零毫秒数。

Sleep(0) 通常会立即返回，因此您仍然会消耗大量能量并耗尽用户的电池或增加他们的电费。Sleep(1) 仍然是一个 hack，但它比 Sleep(0)、_mm_pause()、sched_yield() 或 SwitchToThread() 好很多数量级。

如果有一个线程正在等待运行，Windows 上的 Sleep(0) 将让给具有相同优先级的另一个线程。这很少有用，因为，尤其是在动态调整线程优先级的情况下，您永远无法判断是否有另一个具有相同优先级的线程。Sleep(0) 通常不会切换到更高优先级的线程，因为该线程（更高优先级）已经在运行。它不会切换到较低优先级的线程，因为它不会。SwitchToThread 也有类似的问题。

_mm_pause() 告诉 CPU 空闲几个周期。这降低了功耗，并且在超线程机器上可以让该内核上的其他线程运行得更快。但是，这不是您通常应该做的事情。

如果您想在 n 毫秒内醒来，请调用 Sleep(n)。或者，更好的是，等待特定事件。

sched_yield、Sleep(0) 和 SwitchToThread 等函数通常都是坏主意，因为它们不会告诉操作系统您何时想再次运行。

无论你做什么都不要忙着等待，即使是 _mm_pause。 [http://randomascii.wordpress.com/2012/06/05/in-praise-of-idleness/](http://randomascii.wordpress.com/2012/06/05/in-praise-of-idleness/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:41:33.563

sched_yield() “导致调用线程放弃 CPU。”

[http://www.kernel.org/doc/man-pages/online/pages/man2/sched_yield.2.html](http://www.kernel.org/doc/man-pages/online/pages/man2/sched_yield.2.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-05-07T05:44:32.083

仅供参考，英特尔发布了两个关于如何做你想做的事的最佳实践，主要是通过使用`_mm_pause()`. 请注意，他们的第 6 代等待周期时间已故意增加，因此您需要结合以下文章中描述的内容：

[https://software.intel.com/en-us/articles/a-common-construct-to-avoid-the-contention-of-threads-architecture-agnostic-spin-wait-loops](https://software.intel.com/en-us/articles/a-common-construct-to-avoid-the-contention-of-threads-architecture-agnostic-spin-wait-loops)

[https://software.intel.com/en-us/articles/benefiting-power-and-performance-sleep-loops](https://software.intel.com/en-us/articles/benefitting-power-and-performance-sleep-loops)

# xcode - 无法通过单击使 NSTableView 可编辑

> ID：14665138
> 
> 赞同：6
> 
> 时间：2013-02-02T18:37:40.220
> 
> 标签：xcode, nstableview

我正在尝试制作一个简单的 NSTableView（仅限文本），可以在其中单击单元格视图来编辑文本。这里的所有教程和相关问题都表明这是自动行为，但我无法理解。

我可以毫不费力地连接我的代表和数据源；我可以以编程方式填充所有单元格，并且可以弄清楚如何处理在编辑时输入的新文本。...我只是无法打开文本框进行编辑！

（NSTable 列在 IB 中被标记为可编辑）

感谢您提供任何线索。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-07-18T23:52:38.530

您可以在 Interface Builder 中执行此操作，方法是选择 Text Field Cell，然后使用 Attributes Inspector，向下滚动到名为“Behavior”的下拉菜单并选择“Editable”。

仅此一项就使您能够双击单个单元格并将它们变成可编辑的文本字段。

为了使您所做的编辑生效，您还必须从 NSTableViewDelegate 协议中实现以下方法： - (void)tableView:setObjectValue:forTableColumn:row:

[有关此功能，请参阅 Apple Docs] ( [https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSTableDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSTableViewDataSource /tableView:objectValueForTableColumn:row](https://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Protocols/NSTableDataSource_Protocol/Reference/Reference.html#//apple_ref/occ/intfm/NSTableViewDataSource/tableView:objectValueForTableColumn:row) :)

像往常一样，必须在您设置为 NSTableView 对象的委托的对象中实现此方法。

[如果您想查看代表，请参阅 Apple Docs on delegates] ( [https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/ uid/TP40002974-CH7-SW18](https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/CocoaFundamentals/CommunicatingWithObjects/CommunicateWithObjects.html#//apple_ref/doc/uid/TP40002974-CH7-SW18) )

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-24T21:10:28.500

在 tableView:viewForTableColumn 委托方法中，我必须专门将每个单元格设置为可编辑。

使用几周后它似乎可以正常工作，但我仍然认为一定有一种不那么费力的方法。

```
- (NSView *)tableView:(NSTableView *)tableView viewForTableColumn:(NSTableColumn *)tableColumn row:(NSInteger)row {

    NSTableCellView *cellView;
    if( [tableColumn.identifier isEqualToString:@"word"] )
    {
        wordCellView = [tableView makeViewWithIdentifier:tableColumn.identifier owner:self];
        cellView = wordCellView;
        [cellView.textField setEditable:YES]; // Make Cell Editable!
     }
} 
```

# linux - 如何将多个子目录中的所有文件移动到一个目录中

> ID：14665141
> 
> 赞同：0
> 
> 时间：2013-02-02T18:37:49.203
> 
> 标签：linux, ubuntu, filesystems

你好，假设我们有一个这样的目录树：

```
src/
src/sub1/a.cpp
src/sub2/b.cpp

lib/
lib/doc1.cpp
lib/doc2.cpp 
```

如何将所有这些文件移动到一个公共目录中，例如测试，以便测试目录中的结果如下所示：

```
test/
test/a.cpp
test/b.cpp
test/doc1.cpp
test/doc2.cpp 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:41:23.217

谷歌坏了吗？;)

我在“将文件移动到单个目录 linux”中发现了这一点

[http://www.howtogeek.com/wiki/Move_Files_Into_One_Directory_in_Linux_With_Find](http://www.howtogeek.com/wiki/Move_Files_Into_One_Directory_in_Linux_With_Find)

# jquery - 通过 jQuery 加载后无法使用 jQuery

> ID：14665146
> 
> 赞同：-1
> 
> 时间：2013-02-02T18:38:15.057
> 
> 标签：jquery, function, click

我用了两个jquery

首先点击“First”并显示内容

点击“两次”后不显示内容

我的代码的这个链接：http: [//jsfiddle.net/cFxsa/](http://jsfiddle.net/cFxsa/)

代码 ：

```
$(function(){
    $('.first').click(function(){
        $('#load').html('<a href="#" class="second">Twice</a>');
    });

    $('.second').click(function(){
        $('#twice').html('<a href="#" class="third">Third</a>');
    });
}); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T18:40:13.473

`click`只能附加到现有元素，`.second`在您尝试添加回调后添加，`on`支持`delegation events`：

```
$('.first').click(function(){
    $('#load').html('<a href="#" class="second">Twice</a>');
});

$('#containerId').on('click', '.second', function(){
    $('#twice').html('<a href="#" class="third">Third</a>');
}); 
```

[**固定小提琴**](http://jsfiddle.net/cFxsa/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:43:47.090

```
$(".first").click(function() {
   $("#load").html('<a href="#" class="second">Twice</a>');
});
$(document).delegate(".second","click",function() {
    $("#twice").html('<a href="#" class="third">Third</a>');
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:17:46.567

在 $('.first').click() 之后为 $('.second') 重新分配 .click() ，因为 .html() 插入了新事物。为了更容易使用如下功能：

Function firstClick(){ -- 你的代码 } Function secondClick(){ -- 你的代码 }

可以更容易重新签名..只需调用“secondClick();”

希望这会有所帮助.. :)

# bash - 如何在行尾附加模式匹配数的计数器？

> ID：14665149
> 
> 赞同：1
> 
> 时间：2013-02-02T18:38:42.973
> 
> 标签：bash, sed, awk

我正在尝试在行尾附加模式匹配的计数器。

样本输入：

```
>first_match
a
b
>second_match
c
d 
```

想要的输出：

```
>first_match,1
a
b
>second_match,2
c
d 
```

我所做的是这样，但我不知道如何添加计数器：

```
sed '/>.*$/ s/$/,/' file 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T18:48:21.643

我注意到您已标记此[awk](/questions/tagged/awk "显示标记为“awk”的问题")，但仅在`sed`.

awk 是一种不同的工具，具有不同的优势和局限性。特别是`awk`有一个更一般的变量概念然后`sed`确实，这变得非常容易。

尝试：

```
awk '/^>/{printf("%s,%d\n",$0,++counter);next}{print $0}' file 
```

一个更“尴尬”的解决方案很简单：

```
awk '/^>/ { $0=$0 "," ++i }1' file 
```

两者都利用了未初始化变量的默认值。

# syntax-highlighting - 从 PEG.js 语法生成 TextMate 语言语法

> ID：14665151
> 
> 赞同：16
> 
> 时间：2013-02-02T18:39:06.237
> 
> 标签：syntax-highlighting, grammar, textmate, peg, pegjs

是否有将 PEG.js 语法转换为[TextMate](http://macromates.com/)语法的工具？

我正在构建我自己的语言，并希望在我首选的编辑器 TextMate 中为它突出显示语法。我的语言语法是用[PEG.js 构建](http://pegjs.majda.cz/)的。根据此用例的 [TextMate 文档](http://manual.macromates.com/en/language_grammars)，我必须以与 PEG.js 不兼容的形式编写 TextMate 语法。

我开始编写一个新的 TextMate 语法，但我很快注意到翻译整个语法，甚至是与可接受的语法突出显示相关的子集都需要相当长的时间。由于我非常懒惰并且不想做所有这些乏味的工作，所以我考虑过自动化这项任务。

谁能给我任何线索如何自动化或至少加速从 PEG.js 语法生成 TextMate 语法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-10-27T18:45:46.470

> 谁能给我任何线索如何自动化或至少加速从 PEG.js 语法生成 TextMate 语法？

使用以下过程：

*   了解正则表达式
*   理解解析表达式语法
*   根据相似度创建映射表
*   根据差异创建函数

**参考**

*   [语法不明确和 PEG.js 的问题（未找到示例）](https://stackoverflow.com/questions/24659684/1113772)

*   [为文本编辑器定义语法的最佳方法是什么？](https://stackoverflow.com/questions/4170180/1113772)

*   [PEG和CFG有什么区别？](https://stackoverflow.com/questions/5501074/1113772)

# ruby-on-rails - ActionMailer 和验证

> ID：14665156
> 
> 赞同：2
> 
> 时间：2013-02-02T18:39:40.947
> 
> 标签：ruby-on-rails, validation, actionmailer

我有一个 rails actionMailer 联系表格，它发送电子邮件但不检查它是否不检查表格是否有错误。如果我发送了不正确的电子邮件：`ewfw`与正确的电子邮件相反：`test@test.com` 它们都发送，如果表单为空白，则不会发送电子邮件，也不会出现错误消息，但是如果发送了电子邮件，则通知警报会起作用。

任何帮助，将不胜感激。

*模型/support.rb*

```
class Support
  include ActiveModel::Validations

  validates_presence_of :email, :sender_name, :support_type, :content
  # to deal with form, you must have an id attribute
  attr_accessor :id, :email, :sender_name, :support_type, :content

  def initialize(attributes = {})
    attributes.each do |key, value|
      self.send("#{key}=", value)
    end
    @attributes = attributes
  end

  def read_attribute_for_validation(key)
    @attributes[key]
  end

  def to_key
  end

  def save
    if self.valid?
      Notifier.support_notification(self).deliver!
      return true
    end
    return false
  end
end 
```

*控制器/supports_controller.rb*

```
class SupportsController < ApplicationController
  def new
    # id is required to deal with form
    @support = Support.new(:id => 1)

  end

  def create
    @support = Support.new(params[:support])
    if @support.save
      redirect_to('/contact', :notice => "Your message was successfully sent.")
    else
      flash[:alert] = "You must fill all fields."
      render 'new'
    end
  end
end 
```

*views/support/form_.html.erb*

```
<% form_for @support, :url => { :action => "create" }, :html => { :method => :post } do |f| %>

  <p>
    <%= f.label "Name" %>
  </p>
  <p>
    <%= f.text_field :sender_name, "size" => 37 %>
  </p>
  <p>
    <%= f.label "Email" %>
  </p>
  <p>
    <%= f.text_field :email, "size" => 37 %><br /><br />
  </p>
  <p>
    <%= f.label "Subject" %>
  </p>
  <p>
    <%= f.select :support_type, options_for_select(["Hire", "General", "Collaboration"]) %>
  </p>
  <p>
    <%= f.label "Details" %>
  </p>
  <p>
    <%= f.text_area :content, "rows" => 3, "cols" => 27  %>
  </p>
  <p><br />
    <%= f.submit "Submit" %>
  </p>
<% end %> 
```

*初始化程序/mailer.rb*

```
# config/initializers/mailer.rb
ActionMailer::Base.delivery_method = :sendmail
ActionMailer::Base.perform_deliveries = true #default value
ActionMailer::Base.raise_delivery_errors = true

ActionMailer::Base.sendmail_settings = {

:tls => true,
:address => 'smtp.test.com',
:port => 587,
:domain => 'test.com',
:user_name => 'test@test.com',
:password => '#',
:authentication => 'login',
:openssl_verify_mode=>nil,
:enable_starttls_auto => true

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:13:55.803

您将需要使用额外的验证器来验证电子邮件的格式是否正确。

它可能看起来像这样：

```
validates_format_of :email, :with => /\A([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})\Z/i 
```

更多信息可以在这里找到：http: [//apidock.com/rails/ActiveModel/Validations/ClassMethods/validates_format_of](http://apidock.com/rails/ActiveModel/Validations/ClassMethods/validates_format_of)

# php - 在mysql中将数据库值从'0'更新为'1'？

> ID：14665157
> 
> 赞同：1
> 
> 时间：2013-02-02T18:39:50.400
> 
> 标签：php, mysql

目前，此 HTML 表单的作用`complete.php`如下：

```
<form action\"includes/welcome_complete.php\" method=\"post\"><input type=\"submit\" class=\"welcome-submit3\" name=\"submit\" value=\"Finish ->\" id=\"submit\"/></form> 
```

然后我试图`complete.php`运行一个 MySQL 查询，我希望它为用户更新数据库中的列，`initial_prompt`然后重定向。`'0'``'1'`

由于某种原因，它重定向但不更新数据库中的值。

有人可以告诉我哪里出错了。谢谢。

`complete.php`：

```
<?php
    require_once('includes/session.php');
    require_once('includes/functions.php');
    require('includes/_config/connection.php');

    session_start();

    $result1 = mysql_query("UPDATE ptb_users SET initial_prompt='1' WHERE id=".$_SESSION['user_id']."") 
    or die(mysql_error());

    if($result1) 
    { 
        $_SESSION['dashboard_intro']="<div class=\"user_settings_box_home\"><strong>Welcome to your new profile</strong> - This is your Dashborad.</div><div class=\"infobox-close4\"></div>"; 
        header('Location: dashboard.php');
    }
?> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T18:48:01.610

它如何能够重定向是我想学习的东西。

问题似乎在您的`form`定义中。这是实际的 HTML 代码（除非我对这个问题有误解）。

```
<form action="includes/welcome_complete.php" method="post">
    <input type="submit" class="welcome-submit3" name="submit" value="Finish ->" id="submit"/>
</form> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:47:15.593

由于重定向有效并且您正在检查 sql 查询是否成功，我的第一个猜测是 $_SESSION['user_id'] 不是您所期望的，请尝试回显它

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-02T18:43:23.687

似乎您试图添加`'1' (string)`而不是添加`1 (integer)`到您的表中

# javascript - 函数声明的javascript范围

> ID：14665160
> 
> 赞同：21
> 
> 时间：2013-02-02T18:39:54.397
> 
> 标签：javascript, function, scope

javascript 中的`var`关键字导致变量存储在本地范围内。没有`var`变量属于全局范围。函数呢？很清楚当函数被声明为变量时会发生什么

```
var foo = function() {...} 
```

但是作用域是什么

```
function foo() {...} 
```

属于？

编辑：我意识到我没有问完全正确的问题，所以作为跟进。在最外层的嵌套中，上面的两个声明和下面的声明有区别吗？

```
foo = function() {...} 
```

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-02-02T18:41:18.537

它始终属于*当前*范围。例如：

```
// global scope

// foo is a global function
function foo() {

    // bar is local to foo
    function bar() {

    }

} 
```

关于你的第二个问题，这个：

```
foo = function() {...} 
```

是分配给全局变量的匿名函数表达式（除非您运行的是严格模式，否则`foo`将是未定义的）。和之间的区别在于`function foo() {}`后者是一个函数*声明*（相对于*变量*声明，它被分配了一个匿名函数*表达式*）。

您可能会对这篇关于函数声明和函数表达式的优秀文章感兴趣：[命名函数表达式揭秘](https://kangax.github.io/nfe/)。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-02-02T18:49:07.210

函数声明始终是当前作用域的局部变量，就像使用`var`关键字声明的变量一样。

但是，不同之处在于，如果它们被*声明*（而不是分配给变量），它们的定义将被*提升*，因此即使声明出现在代码末尾，它们也将在范围内的任何地方可用。另见[var functionName = function() {} vs function functionName() {}](https://stackoverflow.com/q/336859/1048572)。

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-12-16T23:43:52.737

考虑到隐式全局变量的值得注意的区别：

```
var foo = function() {
  // Variables
  var myVar1 = 42;  // Local variable
      myVar2 = 69;  // Implicit global (no 'var')

  // Functional Expressions
  var myFn1 = function() { ... }  // Local 
      myFn2 = function() { ... }  // Implicit global

  function sayHi() {
    // I am a function declaration. Always local.
  }
} 
```

希望这能澄清一点。如果您`var`在分配之前忘记了 a，则会定义隐式全局变量。它是一种危险的危险，适用于变量声明和函数表达式。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T18:45:37.947

您的第一个示例 ( `var foo = function() {...}`) 称为匿名函数。它是在运行时动态声明的，并不遵循与普通函数相同的规则，而是遵循变量的规则。

# c - getchar 的意外行为

> ID：14665166
> 
> 赞同：1
> 
> 时间：2013-02-02T18:40:31.147
> 
> 标签：c, do-while, getchar

只是学习 C 编程，并坚持我确定的关于 Do/While 循环的一些小事。我有一段代码要求用户按“E”退出程序：

```
char exitletter;

do {
printf ("Please hit E to exit the Program\n");
exitletter = getchar();
} while (exitletter !='E'); 
```

但是，如果用户输入了错误的字符，它会打印两次“请按 E 退出程序”。如果用户输入say abcd，它会打印五次消息。

有人可以解释一下这里发生了什么吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T18:43:53.890

那是因为在第一次输入的换行符`getchar`

考虑您是否按下`N`然后按下`enter`键来提供输入方式。实际上，您正在输入两个字符`N`，一个是换行符 ( `\n`)。首先将`getchar`读取并且换行符保留在缓冲区本身中。现在它将打印该语句，然后它会尝试第二次它不会等待您输入，因为缓冲区中已经有一个字符，所以它会读取换行符然后它会检查，这次循环也不会中断，它会打印statemnt，它会在第三次等待用户输入输入。`N``stdin``stdin``getchar``stdin``E``getchar`

如果输入的方式`getchar`就像输入那个字符并按回车键的意思，使用下面的逻辑可以帮助你摆脱这个问题。

```
do {
    printf ("Please hit E to exit the Program\n");
    exitletter = getchar();
    while(exitletter == '\n')exitletter = getchar();
} while (exitletter !='E'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:10:00.913

虽然迟了一个不同的答案：

您可以`fflush`在阅读角色后立即致电。

```
char exitletter;

    do {
        printf ("Please hit E to exit the Program\n");
        exitletter = getchar();
        fflush(stdin);
    } 
    while (exitletter !='E'); 
```

这会像你预期的那样工作。

# prolog - Prolog 逻辑提示

> ID：14665169
> 
> 赞同：1
> 
> 时间：2013-02-02T18:41:02.173
> 
> 标签：prolog, logic

学习一些基本的序言，我很难理解逻辑。

情景：一个人感染了病毒性脑膜炎，并且碰巧与其他人发生了互动。到目前为止，这是我的序言逻辑。

```
%-- Set a sickness condition.
%-- -------------------------------------------------------- --%
setILL(X) :- write(X), write(' is ill'), nl.

%-- Link some interactions between individuals.
%-- -------------------------------------------------------- --%
interact(ella, james).
interact(ella, tyrone).
interact(james, ben).
interact(james, frank).
interact(james, carl).
interact(carl, james).
interact(carl, evan).
interact(evan, mike).
interact(evan, kelly).
interact(mike, frank).
interact(kelly, carl).
interact(kelly, frank).
interact(kelly, ben).
interact(sven, mike).

%-- Create an interaction condition.
%-- -------------------------------------------------------- --%
came_in_contact(X, Y) :- setILL(X), write(X), write(' has had contact with '), write(Y), X\=Y, !, nl.  

%-- Create a rule for sickness
%-- -------------------------------------------------------- --%
sick(X) :- interact(X, Y), contact(X, Y), Y\=X.  
whosick(R) :- findall([X], sick(X), R). 
```

现在交互是它们应该是的，应该有两条路径，每条路径都以 ella （最初生病的人）开始，以 sven （假设的最后一个生病的人）结束。我只是希望打印出两种可能的路径，而不包括无用的交互。例如，tyrone 不会与其他人交谈，ben 也不会。我也希望删除重复（见下文）。

当我执行

```
whosick(X). 
```

我明白了

```
ella is ill
ella has had contact with james
ella is ill
ella has had contact with tyrone
james is ill
james has had contact with ben
james is ill
james has had contact with frank
james is ill
james has had contact with carl
carl is ill
carl has had contact with james
carl is ill
carl has had contact with evan
evan is ill
evan has had contact with mike
evan is ill
evan has had contact with kelly
mike is ill
mike has had contact with frank
kelly is ill
kelly has had contact with carl
kelly is ill
kelly has had contact with frank
kelly is ill
kelly has had contact with ben
sven is ill
sven has had contact with mike
X = [[ella], [ella], [james], [james], [james], [carl], [carl], [evan], [...]|...]. 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T07:21:48.873

首先，您提供的代码中有一个错字：`came_in_contact`应该`contact`或者它不会运行。小问题。

第二个问题：我不确定你的意思是什么：`findall([X], sick(X), R).`没有特别的理由在`[X]`这里使用而不是 just `X`，并且这个更改的结果看起来更好一点：

```
X = [ella, ella, james, james, james, carl, carl|...]. 
```

一个更重要的问题是，从风格上讲，`setill`尽管名称听起来很有状态，但它是 100% 的副作用。`setill`不会“设置”任何人“生病”，它只是打印到标准输出有人生病了。如果这是 MVC，您可能会说，它是“视图”的一部分。因此，您遇到的部分问题是您从`sick/2`.

您在括号中提到 Ella 是爆发的起源，但是您的 Prolog 数据库中没有任何事实，因此 Prolog 肯定没有意识到这一点。此外，您似乎对感染所采用的“路径”感兴趣，但您的 Prolog 对路径一无所知 - 事实上，它实际上只是在转储您的事实数据库。为了证明这一点，让我们在顶部添加一个新事实：

```
interact(gail, hank). 
```

果然，它现在是第一个“解决方案”，即使 Gail 和 Hank 与图表的其余部分隔离：

```
gail is ill
gail has had contact with hank
… (old output repeated) 
```

...

**所以**，你在这里的杂草丛生。你有一个不完整的事实数据库，你的规则并没有真正捕捉到问题的逻辑，它们在打印中散布了逻辑。当我们在这里完成时，代码看起来会大不相同。我不确定这是否是家庭作业，听起来你是在自学，但它有一种家庭作业的氛围，所以我将尝试勾勒出我将如何在不把它们放在一起的情况下进行。

* * *

首先，您需要让 Prolog 了解计算解决方案所需的*所有*事实。也就是说，您必须添加有关发起者的事实：

```
infected(ella) :- !. 
```

这将成为基本情况。现在我们需要使用归纳推理并说，如果该人与感染者接触过，则该人被感染：

```
infected(X) :- interact(X, Y), X \= Y, infected(Y), !. 
```

**注意**：这些削减是相当重要的。没有必要计算另一个解决方案，因为一个人要么被感染，要么没有被感染。如果我们在任何一个分支上都成功证明他们被感染了，那就没什么好说的了。

现在我们可以为一些人得到合理的解决方案：

```
?- infected(ella).
true.

?- infected(gail).
false. 
```

其他人似乎没有解决方案：

```
?- infected(james).
(I typed Ctrl+C)
^CAction (h for help) ? abort
% Execution Aborted 
```

James 没有找到解决方案的原因是 Prolog 使用的是深度优先搜索。方便的是，接下来你要做的就是发现感染路径，所以如果你能阻止 Prolog 尝试已经在路径中的人，你可以通过获取你也需要的路径来解决问题。您将不得不采用类似的基本案例/归纳案例结构，但传递一个额外的感染路径参数。您可以在各处找到此类事情的示例，因此我不会在这里详细介绍您。

请注意这一点：我们*不会*将问题的逻辑与结果的显示混为一谈。由于回溯，这只是 Prolog 的好策略。如果您因为此处的绑定成功而将某些内容打印出来，而在下一个术语中它失败了，那么整个失败可能会回到打印输出之后，从而使用户感到困惑。我们可以很容易地欺骗 Prolog 从后来失败的解决方案中打印出谎言。所以你*总是*想编写你的 Prolog 以便它找到解决方案，然后单独显示它们。想想模型-视图-控制器。

所以让我们假设你找到了一个谓词，`path/3`（大概`path(Source, Last, Path)`）。当你运行它时，你会得到这样的解决方案：

```
?- path(ella, X, Path).
X = sven
Path = [ella, james, ...] ;

X = sven
Path = [ella, tyrone, ...] ;
false. 
```

这是您要使用 包装的谓词`findall/3`，然后您将要遍历结果并逐个打印出您需要的部分。

**编辑**：针对您的评论，让我们来看看您的新谓词：

```
path(_, X, P) :- findall(X, interact(_, X), P). 
```

恐怕这不会比以前更近了。让我们看看当我向自己询问路径时会发生什么：

```
?- path('Daniel Lyons', X, Path).
Path = [james, tyrone, ben, frank, carl, james, evan, mike|...]. 
```

事实上，你可以把任何东西放在那里，你会得到完全相同的结果：

```
?- path('Jack Donaghy', X, Path).
Path = [james, tyrone, ben, frank, carl, james, evan, mike|...].
?- path(3.1415926, X, Path).
Path = [james, tyrone, ben, frank, carl, james, evan, mike|...].
?- path([a,b,c,d,e], X, Path).
Path = [james, tyrone, ben, frank, carl, james, evan, mike|...]. 
```

这是因为您的规则适用于*任何*处于首位的事物。如果你有更多的子句，这可能是有意义的，因为其他子句之一可以说明这个论点，但缺乏它确实意味着什么。所以你的谓词也可以写成：

```
path(X, P) :- findall(X, interact(_, X), P). 
```

每一个`_`都是一个完全独特的绑定；它们根本不会相互影响，所以如果你希望在那里产生效果，你会想要更像这样的东西：

```
path(F, X, P) :- findall(X, interact(F, X), P). 
```

你马上就会发现这对你没有多大帮助：

```
?- path(ella, X, P).
P = [james, tyrone]. 
```

所以我们已经解决了这个问题。

```
person(X) :- interact(X, _) ; interact(_, X). 
```

这只是一个帮助器，它返回每个人，无论他们是在交互的左侧还是右侧。

```
path(Originator, Path) :- 
  setof(X, person(X), People), 
  path(Originator, Path, People). 
```

该助手为您提供特定人的路径。我们依赖于一个辅助函数，我将在稍后展示。我们从所有人的名单开始，将可能性修剪成合理的东西。这样我们就可以从我们还没有检查过的人列表中选择下一个人，我们不必担心循环或过多的递归。

```
path(Originator, [], _).
path(Originator, [NextPerson|Rest], Considering) :-
  select(NextPerson, Considering, RemainingToConsider),
  interact(Originator, NextPerson), 
  path(NextPerson, Rest, RemainingToConsider). 
```

第一个子句说，我们总是可以完成的。从始发者到无人的路径是空路径。这是我们归纳的基本情况。

第二个子句说，从我们剩下要考虑的人列表中选择一个人。有人与发起人互动。现在从那个人到剩下的要考虑的人找到一条路径。（`select/3`将第三个参数与没有第一个参数的第二个参数统一起来）。

让我们看一下运行：

```
?- path(ella, X).
X = [] ;
X = [james] ;
X = [james, ben] ;
X = [james, carl] ;
X = [james, carl, evan] ;
X = [james, carl, evan, kelly] ;
X = [james, carl, evan, kelly, ben] ;
X = [james, carl, evan, kelly, frank] ;
X = [james, carl, evan, mike] ;
X = [james, carl, evan, mike, frank] ;
X = [james, frank] ;
X = [tyrone] ;
false. 
```

现在，在您最初的问题中，您说了一些关于本和弗兰克的事情，并且对其他路径不感兴趣。我仍然没有看到可以区分这些情况的逻辑阅读，但您至少可以找到所有最长的路径，如下所示：

```
longest_paths(Originator, Path) :-
  path(Originator, Path),
  \+ (path(Originator, Path2), 
      length(Path, MaxLen), 
      length(Path2, NextLen), 
      NextLen > MaxLen). 
```

这不是非常有效，但它说的是，从 Originator 为我找到一条路径 Path，这样就没有其他长度更长的路径了。这为我们找到了三个解决方案：

```
?- longest_paths(ella, X).
X = [james, carl, evan, kelly, ben] ;
X = [james, carl, evan, kelly, frank] ;
X = [james, carl, evan, mike, frank] ;
false. 
```

这与我认为我可以为您提供所需的解决方案一样接近。我希望它有帮助！

# vim - Netrw 在对面的垂直窗口中将文件打开到选项卡中

> ID：14665170
> 
> 赞同：8
> 
> 时间：2013-02-02T18:41:06.920
> 
> 标签：vim, netrw

想象一下我`:Vex`在启动 vim 之后。我希望能够按下`t`并将选项卡附加到对面的窗口而不是 Netrw 窗口。这可能吗？

如果我按下`P`，我可以将文件打开到拆分窗口中，但我希望能够在垂直拆分中的文件中切换，同时让我的 Netrw 窗口可见 - 就像 Sublime 或 Komodo 一样。

可能的？

是的，我已经冲刷过了`:h netrw`！

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2015-01-28T12:25:32.750

几乎得到了一些`.vimrc`重新映射和选项。

它看起来像这样[http://i.imgur.com/rUf19SF.png](http://i.imgur.com/rUf19SF.png)

**用法：**

1.  运行 vim。
2.  打`shift enter`。这将打开 netrw 作为侧边栏（右侧的一个小拆分窗口）并聚焦它。
3.  像往常一样浏览并点击`enter`打开文件。默认情况下，这将在左侧窗口中打开它并聚焦它。
4.  打`control-w control-w`。这将再次聚焦 netrw。
5.  像往常一样浏览，但这次点击`control-enter`打开文件。这将在一个新选项卡中打开它，该选项卡还包含 netrw 侧边栏。

**.vimrc 配置：**

```
" netrw magic
" enable mouse usage. makes it easier to browse multiple tabs
set mouse=a
" hide netrw top message
let g:netrw_banner=0
" tree listing by default
let g:netrw_liststyle=3
" hide vim swap files
let g:netrw_list_hide='.*\.swp$'
" open files in left window by default
let g:netrw_chgwin=1
" remap shift-enter to fire up the sidebar
nnoremap <silent> <S-CR> :rightbelow 20vs<CR>:e .<CR>
" the same remap as above - may be necessary in some distros
nnoremap <silent> <C-M> :rightbelow 20vs<CR>:e .<CR>
" remap control-enter to open files in new tab
nmap <silent> <C-CR> t :rightbelow 20vs<CR>:e .<CR>:wincmd h<CR>
" the same remap as above - may be necessary in some distros
nmap <silent> <NL> t :rightbelow 20vs<CR>:e .<CR>:wincmd h<CR> 
```

**注意事项：**

每个选项卡中的 netrw “侧边栏”是独立的，这意味着一个选项卡中的当前目录可能与另一个选项卡中的不同。建议？曾考虑在每个“侧边栏”窗口中使用 netrw 缓冲区，但 netrw 在更改目录时使用新缓冲区。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-03T00:41:14.717

您似乎将 Vim 的“选项卡”与您在几乎所有其他程序中都可以找到的“选项卡”混淆了。

与其他实现不同，Vim 的选项卡不绑定到缓冲区。在 Vim 中，“选项卡”的行为类似于您所说的“工作区”：它们旨在将一个或多个窗口保持在一起。这些窗口可以显示任何缓冲区，您最终可以在多个选项卡的多个窗口中显示相同的缓冲区！

考虑到这一点，随意使用它们是*非常错误的。*“选项卡”不代表文件，*跳转到另一个“选项卡”*根本不等同于*跳转到另一个文件*。

创建的窗口`:Vex`是一个普通的窗口。像所有其他窗口一样，它包含在“选项卡”中，不能位于“选项卡”之外。而且你不能在窗口内有“标签”。

所以，基本上，你问的是*不可能的。*

如果你在 Mac 上，并且这个“其他类似编辑器的功能”对你来说*真的很*重要（比说，拥抱 Vim 方式更重要），你可以试试[这个 MacVim fork ，它在](https://github.com/alloy/macvim)*外部*添加了一个“常规”文件资源管理器缓冲区/窗口/选项卡三重奏。你也可以试试[PIDA](https://launchpad.net/pida)，它试图围绕 Vim 构建一个 IDE；包括一个单独的文件资源管理器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2014-05-30T16:34:35.843

正如 romainl 所说，选项卡不是文件（或缓冲区）。因此，如果我将您的问题重新解释为：“我想按 t 并让*文件*出现在对面的窗口中……”。然后我建议阅读 :help netrw-C。如果您确实是指“追加”而不是“出现”，那么这将更加复杂，在我努力弄清楚如何做之前，我想知道这就是您的真正意思。最新的 netrw（截至今天，它是 v153f）具有我在上面给出的帮助参考中提到的其他选项。

# ubuntu - 通过 scp 上传文件时的 Ec2 问题

> ID：14665171
> 
> 赞同：0
> 
> 时间：2013-02-02T18:41:07.670
> 
> 标签：ubuntu, amazon-ec2, scp

我正在尝试将文件上传到我的新 ec2 vps，但没有任何运气。

我可以通过 ssh 连接没有任何问题。

当我尝试上传我的外壳时说：

```
scp -v -i ~/.ssh/maurospage.pem wp-config.php ubuntu@ec2-54-247-43-158.eu-west-1.compute.amazonaws.com:/var/www/blog
Executing: program /usr/bin/ssh host ec2-54-247-43-158.eu-west-1.compute.amazonaws.com, user ubuntu, command scp -v -t -- /var/www/blog
OpenSSH_5.9p1, OpenSSL 0.9.8r 8 Feb 2011
debug1: Reading configuration data /Users/mauromarano/.ssh/config
debug1: Reading configuration data /etc/ssh_config
debug1: /etc/ssh_config line 20: Applying options for *
debug1: Connecting to ec2-54-247-43-158.eu-west-1.compute.amazonaws.com [54.247.43.158] port 22.
debug1: Connection established.
debug1: identity file /Users/mauromarano/.ssh/maurospage.pem type -1
debug1: identity file /Users/mauromarano/.ssh/maurospage.pem-cert type -1
debug1: Remote protocol version 2.0, remote software version OpenSSH_5.9p1 Debian-5ubuntu1
debug1: match: OpenSSH_5.9p1 Debian-5ubuntu1 pat OpenSSH*
debug1: Enabling compatibility mode for protocol 2.0
debug1: Local version string SSH-2.0-OpenSSH_5.9
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: server->client aes128-ctr hmac-md5 none
debug1: kex: client->server aes128-ctr hmac-md5 none
debug1: SSH2_MSG_KEX_DH_GEX_REQUEST(1024<1024<8192) sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_GROUP
debug1: SSH2_MSG_KEX_DH_GEX_INIT sent
debug1: expecting SSH2_MSG_KEX_DH_GEX_REPLY
debug1: Server host key: RSA 1c:58:69:51:4a:5e:60:4a:a1:39:c8:03:55:cb:f9:10
debug1: Host 'ec2-54-247-43-158.eu-west-1.compute.amazonaws.com' is known and matches the RSA host key.
debug1: Found key in /Users/mauromarano/.ssh/known_hosts:7
debug1: ssh_rsa_verify: signature correct
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: Roaming not allowed by server
debug1: SSH2_MSG_SERVICE_REQUEST sent
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey
debug1: Next authentication method: publickey
debug1: Offering RSA public key: /Users/mauromarano/.ssh/id_rsa
debug1: Authentications that can continue: publickey
debug1: Trying private key: /Users/mauromarano/.ssh/maurospage.pem
debug1: read PEM private key done: type RSA
debug1: Authentication succeeded (publickey).
Authenticated to ec2-54-247-43-158.eu-west-1.compute.amazonaws.com ([54.247.43.158]:22).
debug1: channel 0: new [client-session]
debug1: Requesting no-more-sessions@openssh.com
debug1: Entering interactive session.
debug1: Sending environment.
debug1: Sending env LANG = it_IT.UTF-8
debug1: Sending env LC_CTYPE = it_IT.UTF-8
debug1: Sending command: scp -v -t -- /var/www/blog
Sending file modes: C0777 3504 wp-config.php
Sink: C0777 3504 wp-config.php
scp: /var/www/blog/wp-config.php: Permission denied

MacBook-Pro-di-Mauro: ~/Desktop                                                         
→ debug1: client_input_channel_req: channel 0 rtype exit-status reply 0
debug1: channel 0: free: client-session, nchannels 1
debug1: fd 0 clearing O_NONBLOCK
debug1: fd 1 clearing O_NONBLOCK
Transferred: sent 2672, received 2304 bytes, in 0.7 seconds
Bytes per second: sent 3996.1, received 3445.7
debug1: Exit status 1 
```

ls -l of the folder in with 我试图复制文件（一个 wp 文件夹）

```
ubuntu@ip-10-227-45-167:/var/www/blog$ ls -l
total 192
-rwxrwxrwx 1 ubuntu root   395 Jan  8  2012 index.php
-rwxrwxrwx 1 ubuntu root   408 Dec 14 09:21 LEGGIMI.txt
-rwxrwxrwx 1 ubuntu root 19929 May  6  2012 license.txt
-rwxrwxrwx 1 ubuntu root 24880 Dec 14 09:21 licenza.html
-rwxrwxrwx 1 ubuntu root  8946 Dec 14 09:21 readme.html
-rwxrwxrwx 1 ubuntu root  4663 Nov 17 15:11 wp-activate.php
drwxrwxrwx 9 ubuntu root  4096 Dec 14 09:21 wp-admin
-rwxrwxrwx 1 ubuntu root   271 Jan  8  2012 wp-blog-header.php
-rwxrwxrwx 1 ubuntu root  3522 Apr 10  2012 wp-comments-post.php
-rwxrwxrwx 1 ubuntu root  3737 Dec 14 09:21 wp-config-sample.php
drwxrwxrwx 5 ubuntu root  4096 Dec 14 09:21 wp-content
-rwxrwxrwx 1 ubuntu root  2718 Sep 23 16:57 wp-cron.php
drwxrwxrwx 9 ubuntu root  4096 Dec 14 09:21 wp-includes
-rwxrwxrwx 1 ubuntu root  1997 Oct 23  2010 wp-links-opml.php
-rwxrwxrwx 1 ubuntu root  2408 Oct 26 19:40 wp-load.php
-rwxrwxrwx 1 ubuntu root 29310 Nov 30 13:40 wp-login.php
-rwxrwxrwx 1 ubuntu root  7723 Sep 25 05:26 wp-mail.php
-rwxrwxrwx 1 ubuntu root  9899 Nov 22 09:52 wp-settings.php
-rwxrwxrwx 1 ubuntu root 18219 Sep 11 12:27 wp-signup.php
-rwxrwxrwx 1 ubuntu root  3700 Jan  8  2012 wp-trackback.php
-rwxrwxrwx 1 ubuntu root  2719 Sep 11 20:11 xmlrpc.php 
```

我试过`chmod 777 myfile`在我的电脑上，我`chmod -R 777 *`在我的 ec2 实例的博客文件夹中做了。没有改变。

我哪里错了？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T05:10:05.430

父文件夹缺少正确的权限。Scp 无法在当前文件夹中创建新文件。您可能希望修复您的权限，以便不对所有文件使用 777。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-05-23T13:20:55.043

如果这会杀死其他任何人，请尝试使用波浪号 (~) 而不是根目录 (/)

即，而不是在这个例子中：

```
scp -v -i ~/.ssh/maurospage.pem wp-config.php ubuntu@ec2-54-247-43-158.eu-west-1.compute.amazonaws.com:/var/www/blog 
```

尝试...

```
 scp -v -i ~/.ssh/maurospage.pem wp-config.php ubuntu@ec2-54-247-43-158.eu-west-1.compute.amazonaws.com:~ 
```

..然后像往常一样按照 ec2 管理控制台中的连接步骤连接到您的实例，并将文件作为 sudo 移动到 var/www/html 目录

# android - onSensorChanged 是否应该在 Android 虚拟设备（模拟器）中工作？

> ID：14665180
> 
> 赞同：0
> 
> 时间：2013-02-02T18:41:38.087
> 
> 标签：android, android-emulator, android-sensors

我正在测试一些示例代码来学习 Android。

`onSensorChanged`应该在 Android 虚拟设备（模拟器）中工作吗？

我的`onSensorChanged`(for `TYPE_AMBIENT_TEMPERATURE`) 永远不会被调用。

在参考 [http://developer.android.com/reference/android/hardware/SensorEventListener.html#onSensorChanged(android.hardware.SensorEvent)](http://developer.android.com/reference/android/hardware/SensorEventListener.html#onSensorChanged(android.hardware.SensorEvent))中没有关于模拟器的信息。

# java - 从 JLayeredPane 中删除 JLabel

> ID：14665183
> 
> 赞同：0
> 
> 时间：2013-02-02T18:42:01.833
> 
> 标签：java, swing, jlabel, imageicon, jlayeredpane

我有一个分层窗格，其中包含各种动画。我正在使用 Jlabel (breakB) 在正在破坏的块上显示破坏动画。当块破裂时，问题就出现了。标签应该消失，但它仍然可见。我一直在寻找解决方案几个小时，真的不知道发生了什么，所以任何帮助将不胜感激。

```
class breakBlock implements ActionListener {
    public void actionPerformed(ActionEvent e) {

        damageCount+=1;
        System.out.println(damageCount);
        JLabel breakB = new JLabel();
        ImageIcon breakIcon = new ImageIcon();

        if(digDown){
            blockInt = standingOn;
        } else {blockInt = nextTo;}

        if(damageCount == 1){
            breakIcon =  new ImageIcon(break01);

        }

        if(damageCount == 2){
            breakIcon =  new ImageIcon(break02);
        }

        if(damageCount == 3){
            breakIcon =  new ImageIcon(break03);

        }

        if(damageCount == 4){ 
            breakIcon =  new ImageIcon(break04);
        }

        if(damageCount == 5){
            breakIcon =  new ImageIcon(break05);
        }

        breakB.setIcon(breakIcon);
        breakB.setBounds(solidObjects.get(blockInt).getX(), solidObjects.get(blockInt).getY(), breakIcon.getIconHeight(), breakIcon.getIconWidth());
        layeredPane.add(breakB, new Integer(2), 0);

        if(damageCount == 6){
            layeredPane.remove(solidObjects.get(blockInt));
            layeredPane.remove(breakB);
            layeredPane.repaint(); // sometimes needed
            solidObjects.remove(blockInt);
            damageCount = 0;
            breakBlock.stop();
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T09:53:11.800

我认为你遇到的问题是你在`actionPerformed`方法中创建了一个本地标签......

```
JLabel breakB = new JLabel(); 
```

这意味着，每次您进入该方法时，您都在创建标签的一个新实例，这意味着您在移除它时不再引用任何现有标签。

考虑创建变量的单个实例`breakB`或维护某种列表，以便您知道哪些需要删除，如果您需要多个...

# c++ - C++ 中的懒惰日志记录

> ID：14665184
> 
> 赞同：8
> 
> 时间：2013-02-02T18:42:27.353
> 
> 标签：c++, logging, lazy-evaluation

假设我们有几个级别的日志记录：跟踪、调试、信息、错误。我想知道是否有办法编写以下代码：

```
enum log_level = {trace, debug, info, error};

log_level global_log_level = info;

void log(log_level level, string& message){
    if (level >= global_log_level){
        std::cout << message << std::endl;
    }
}

string create_message(){
    ...
}

log_level level = debug;
log (level, create_message()); 
```

如果 level 小于 global_severity_level，则不调用 create_message。实际上， create_message 可以很长，而且不管它创建什么字符串。如果有很多“调试”日志，那么在非调试模式下运行时，这些日志可能会成为很大的开销。

我知道如果函数“log”是一个宏，则可以这样做，只有在 severity > minimum_severity 时才调用 create_message()；但是没有宏就没有另一种方法吗？

**编辑**

在上面，我没有指定 create_message，因为它可以是任何东西，特别是：

```
log(level, "Created object " + my_object.getName()); 
```

在这种情况下，有没有办法以相对透明的方式编写日志而不创建完整的字符串，以便程序员调用日志？

非常感谢

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T18:50:44.033

有几种选择。一个有趣的方法是`create_message`作为 a传递`std::function<std::string()>`并从内部调用它`log`：

```
void log(log_level level, std::function<std::string()> message_creator){
    if (level >= global_log_level){
        std::cout << message_creator() << std::endl;
    }
} 
```

然后你会这样称呼它：

```
log(level, create_message); 
```

如果将任意表达式包装在 lambda 中，这可以使用任意表达式作为参数：

```
log(level, [&](){ return "Created object " + my_object.getName(); }); 
```

如果您真的不想对参数进行评估（正如您在评论中所描述的那样），那么您需要检查调用之外的级别：

```
if (level >= global_log_level) {
  log(level, create_message());
} 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-02-02T19:31:55.820

类似于@sftrabbit，但正如@ipc 所建议的那样。

使用模板来避免 std::function 机制，编译器可能能够内联它，因此希望它最终会更快。

```
template< typename F >
void log(log_level level, F message_creator){
    if (level >= global_log_level){
        std::cout << message_creator() << std::endl;
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T18:58:09.767

@sftrabbit 答案是首选。但是，如果您不想更改 log()，您可以调用它：

```
log (level, (level >= global_log_level)? create_message() : ""); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T19:25:54.040

您可以创建一个宏

```
 #define log(level, message) { \
    if(level >= global_log_level) {\
    cout << message; }} 
```

现在如果你打电话

```
log(debug, create_message());
```

仅当调试级别是所需的级别时才会调用 create_message。

# javascript - 使用单独的 Javascript 函数提交隐藏的 PayPal 表单

> ID：14665185
> 
> 赞同：0
> 
> 时间：2013-02-02T18:42:33.797
> 
> 标签：javascript, jquery, paypal

我需要在 Javascript 函数中包含对 PayPal 的调用。我希望在执行and**之前**调用 PayPal 。`myStep1``myStep2`

这是功能：

```
function() {    
    // need call to PayPal here, before myStep1 and myStep2 
    $.when.apply(undefined, myStep1()).done(function () {
    $.ajax({
        url: sURL + "myController/myStep2",
        success: function() {  
                $.msg("Success Message", live:10000
                });
            },
        error: function(){
                $.msg("Error Message", live:10000
                });
            }
        }); 
    });
}; 
```

这是需要不可见并通过上述 Javascript 函数以某种方式提交的 PayPal 表单：

```
<form action="https://www.paypal.com/cgi-bin/webscr" method="post">
  <input type="hidden" name="cmd" value="_s-xclick">
  <input type="hidden" name="hosted_button_id" value="123456789">
  <input type="image"
      src="https://www.paypalobjects.com/en_US/i/btn/btn_paynow_SM.gif"
      border="0" name="submit"
      alt="PayPal - The safer, easier way to pay online!">
  <img alt="" border="0"
      src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1"
      height="1">
</form> 
```

关于如何最好地将这个 PayPal 表单提交到 Javascript 函数中的任何想法？我想我可能想要做的是模拟 PayPal 按钮的点击。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T10:31:18.833

尝试这个？

```
// This will disable the normal PayPal submit
var buttn = $('input[name=submit]');
buttn.click(function(e) {
    e.preventDefault();
});

function() {    
    // need call to PayPal here, before myStep1 and myStep2
    buttn.closest('form').submit();
    $.when.apply(undefined, myStep1()).done(function () {
    $.ajax({
        url: sURL + "myController/myStep2",
        success: function() {  
                $.msg("Success Message", live:10000
                });
            },
        error: function(){
                $.msg("Error Message", live:10000
                });
            }
        }); 
    });
}; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T10:12:00.307

贝宝按钮是 iFramed 项目。

首先，你不能通过JS函数调用提交，跨浏览器成功。其次，不能影响 iFrame 的 JS 行为。您只能影响包含 iFrame 的页面的操作。这就是 iFrame 的本质。

您正在有效地尝试通过客户端脚本控制另一个站点上另一个页面的操作。

# jsp - JSP获取外部站点的标题和元标记 - 代码日志

> ID：14665198
> 
> 赞同：0
> 
> 时间：2013-02-02T18:43:43.157
> 
> 标签：jsp, title, meta-tags

我想尝试弄清楚如何从链接中获取网站标题和元数据

我已经看到了 PHP 的解决方案（[从外部网站获取标题和元标记](https://stackoverflow.com/questions/3711357/get-title-and-meta-tags-of-external-site)），但是我想知道是否有**JSP**的解决方案。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:53:14.233

使用 java.net.HttpURLConnection 或[http 组件](http://hc.apache.org/)获取外部站点的字符串。使用 regex 或[htmlcleaner](http://htmlcleaner.sourceforge.net/)提取标题和元数据。

# android - “进程被信号（11）终止”总是与NDK有关吗？

> ID：14665200
> 
> 赞同：2
> 
> 时间：2013-02-02T18:43:51.777
> 
> 标签：android, android-ndk, segmentation-fault

我正在跟踪我的项目中的错误。有时，我的应用程序会被杀死，并且在 logcat 中总是有以下行：

`D/Zygote ( xx): Process xxxx terminated by signal (11)`

我一直在搜索这个错误，我总是发现提到`NDK`.

我正在开发一个使用第三方 C 库的项目。我不太了解这个库，但我可以告诉你它与服务器进行了一些网络通信。在我的项目中有几个`Services`，其中一些使用这个库。

所以我的问题是，这个错误是否总是暗示问题来自 C 库？

如果没有，您能否给我一些 Android 中的 Java 代码示例，这也可能导致此错误？

谢谢。

**编辑**：顺便说一句，在 logcat 输出中，在上一行之前没有堆栈跟踪。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T08:45:20.273

很可能，SIGSEGV 之前已在您的日志中报告过。它可能比最后的消息早了很长一段时间。这是我日志中此类崩溃之一的实际快照：

```
01-29 16:00:39.124 F/libc    ( 3033): Fatal signal 11 (SIGSEGV) at 0x0000002c (code=1)
... many more ...
01-29 16:00:48.367 D/Zygote  (  116): Process 3033 terminated by signal (11) 
```

您可以看到 Zygote 在收到致命信号后报告进程终止花了将近 10 秒。您的里程可能会有所不同。

SIGSEGV 的实际原因可能在第三方 C 库中，或者在您的 Java 中，或者在您调用 C 库的方式中。请注意，例如，在引发 Java 异常时，禁止进行大多数 JNI 调用。

# ruby - 如何按类别名称过滤所有广告？

> ID：14665204
> 
> 赞同：0
> 
> 时间：2013-02-02T18:44:01.377
> 
> 标签：ruby, ruby-on-rails-3, activerecord, where

我的用例很简单：

> 获取所有类别名称为 params[:category_name] 的广告。

* * *

这是我的模型关联：

```
class Ad < ActiveRecord::Base
  belongs_to :category

  attr_accessible :anonymous, :celular, :name, :precio, :category_id
end

class Category < ActiveRecord::Base
  has_many :ads

  attr_accessible :name
end 
```

这是我的控制器代码：

```
def by_category
  @ads = Ad.where(:category => params[:category_name])
end 
```

但它没有按预期工作，我得到一个例外：

> SQLite3::SQLException：没有这样的列：ads.category: SELECT "ads".* FROM "ads" WHERE "ads"."category" = 'aeronautica'

如何按类别名称过滤广告对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:20:39.593

在您的广告数据库中，您只有一个名为 category_id 的列，因此在广告数据库中搜索类别名称是没有用的。

```
 Category.find_by_name(params[:category_name]).ads 
```

这将显示参数中具有 category_name 的类别的所有广告。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:14:50.817

```
Ad.where(:category => Category.find_by_name(params[:category_name])) 
```

`params[:category_name]`只是一个字符串，而`:category`是 Category 类型的对象。

```
Category.find_by_name 
```

会给你一个类别对象，你可以比较`:category`

**编辑：**

对于这种特殊情况，您可以尝试以下操作，因为您可能已经使用`category_id:integer`而不是`category:reference`创建 Ad 模型。

```
Ad.where(:category_id => Category.find_by_name(params[:category_name]).id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:15:58.180

```
Ad.where(:category => {:name => params[:category_name]}) 
```

# ruby-on-rails - 在 ruby 中更改 Google Doc 的权限？

> ID：14665206
> 
> 赞同：3
> 
> 时间：2013-02-02T18:44:11.753
> 
> 标签：ruby-on-rails, ruby, google-drive-api

我可以创建一个 Google Doc，但每当我尝试访问该链接时，我都会收到一个权限被拒绝通知。有没有办法将文档公开给任何与 ruby​​ 客户端 api 有链接的人？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T21:05:04.490

[https://developers.google.com/drive/v2/reference/permissions/insert](https://developers.google.com/drive/v2/reference/permissions/insert)上的代码展示了如何使用 Ruby 向文档添加新权限。

要使所有人都可以使用文档，您必须将权限设置`type`为`anyone`。

# c# - AppDomain.UnhandledException 自动重新抛出已处理的异常

> ID：14665207
> 
> 赞同：2
> 
> 时间：2013-02-02T18:44:21.537
> 
> 标签：c#, wpf, exception, exception-handling

我试图在我的应用程序中捕获所有未处理的异常，以便有条件地处理那些可以在不终止应用程序的情况下发生的异常，但我无法解决一个非常基本的问题：它不会停止异常。未处理的异常在代码的某处被抛出，它来到这里，显示消息框，然后应用程序要么显示相同的异常未处理（如果处于调试模式），要么只是崩溃（如果运行时没有调试）。这意味着即使调用了处理程序，异常仍处于未处理状态。

```
App() {
    AppDomain.CurrentDomain.UnhandledException += (s, a) => {
        var ex = (Exception)a.ExceptionObject;
        MessageBox.Show(ex.Message, "Error", MessageBoxButton.OK, MessageBoxImage.Error);
    };
} 
```

这是来自一个新的空白测试项目，其中除了这段代码和一个在单击时引发异常的按钮之外什么都没有。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:25:04.077

您忘记终止程序。所以它继续进行正常的未处理异常处理。添加这一行：

```
 Environment.Exit(System.Runtime.InteropServices.Marshal.GetHRForException(ex)); 
```

稍微费力的 Marshal 调用确保为您的进程获取 Process.ExitCode 的另一个进程获得合理的错误指示。它是可选的，仅推荐。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T18:57:30.507

如果这确实是您想要的行为，您可以将以下内容添加到您的应用程序配置文件中：

```
<legacyUnhandledExceptionPolicy enabled="1"/> 
```

请参阅[托管线程中的异常](http://msdn.microsoft.com/en-us/library/ms228965.aspx)。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:02:54.990

[来自 MSDN：](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)

> 此事件提供未捕获异常的通知。它允许应用程序在系统默认处理程序向用户报告异常并终止应用程序之前记录有关异常的信息。如果有关应用程序状态的足够信息可用，则可以采取其他措施——例如保存程序数据以供以后恢复。建议小心，因为如果不处理异常，程序数据可能会损坏。

换句话说，它只是一个处理程序，允许您告诉用户发生了什么，如果您需要能够恢复数据，则生成最后一分钟的保存信息，或者执行诸如触发自定义错误报告之类的操作。 **它不是一个 catch 块。** 要捕获异常，您必须使用 Try-Catch。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T18:54:01.497

它不应该“停止”异常，该行为[是设计使然](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception%28v=vs.100%29.aspx)：

> 此事件提供未捕获异常的通知。**它允许应用程序在系统默认处理程序向用户报告异常并终止应用程序**之前记录有关异常的信息。

 **考虑到这个地方没有其他人费心处理有问题的异常，除了记录和死亡之外没有什么明智的事情要做。

您应该处理那些应该在更接近它们发生的地方终止应用程序的异常。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T19:03:19.647

您实际上并没有捕获未处理的异常，而只是处理在终止应用程序之前发生的事件（在发布模式下）。订阅此事件不算捕获已经未处理的异常。

来自[MSDN](http://msdn.microsoft.com/en-us/library/system.appdomain.unhandledexception.aspx)：此事件提供未捕获异常的通知。它允许应用程序在系统默认处理程序向用户报告异常并终止应用程序之前记录有关异常的信息。如果有关应用程序状态的足够信息可用，则可以采取其他措施——例如保存程序数据以供以后恢复。建议小心，因为如果不处理异常，程序数据可能会损坏。**

# android - BootUpReceiver 崩溃

> ID：14665209
> 
> 赞同：0
> 
> 时间：2013-02-02T18:44:32.317
> 
> 标签：android, service

我有一个从引导启动的应用程序。但它正在崩溃。当我从一个按钮启动它时，服务就可以工作了。我有所有的许可..

我的清单：

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    package="com.my.app"
    android:versionCode="1"
    android:versionName="1.0" >

    <uses-sdk
        android:minSdkVersion="8"
        android:targetSdkVersion="16" />
    <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.RECEIVE_BOOT_COMPLETED" />
    <uses-permission android:name="android.permission.VIBRATE"/>

    <application
        android:allowBackup="true"
        android:icon="@drawable/ic_launcher"
        android:label="@string/app_name"
        android:theme="@style/AppTheme" >
        <activity
            android:name="com.my.app.MainActivity"
            android:label="@string/app_name" >
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />

                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>
        <service android:enabled="true" android:name=".StartUpService" />
        <receiver
            android:name="com.my.app.StartUpReceiver"
            android:enabled="true"
            android:exported="false" >
        </receiver>
        <receiver android:name="com.my.app.BootReceiver">
            <intent-filter>
                <action android:name="android.intent.action.BOOT_COMPLETED" />
            </intent-filter>
        </receiver>
    </application>

</manifest> 
```

引导接收器：

```
package com.my.app;

import java.util.Calendar;

import android.app.AlarmManager;
import android.app.PendingIntent;
import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class BootReceiver extends BroadcastReceiver {
    @Override
    public void onReceive(Context context, Intent intent) {
        AlarmManager am = (AlarmManager)context.getSystemService(Context.ALARM_SERVICE);
        Calendar cal = Calendar.getInstance();
        Intent i = new Intent(context, StartUpReceiver.class);
        PendingIntent pi = PendingIntent.getBroadcast(context, 0, i, 0);
        am.cancel(pi);
        am.setInexactRepeating(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), 5*60*1000, pi);
    }
} 
```

启动接收器：

```
package com.my.app;

import android.content.BroadcastReceiver;
import android.content.Context;
import android.content.Intent;

public class StartUpReceiver extends BroadcastReceiver {

    @Override
    public void onReceive(Context context, Intent intent) {
        Intent service = new Intent(context, StartUpService.class);
        context.startService(service);
    }
} 
```

启动服务：

```
package com.my.app;

import java.io.ByteArrayOutputStream;
import java.net.URLEncoder;

import org.apache.http.HttpResponse;
import org.apache.http.HttpStatus;
import org.apache.http.StatusLine;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpGet;
import org.apache.http.impl.client.DefaultHttpClient;

import android.app.Notification;
import android.app.NotificationManager;
import android.app.PendingIntent;
import android.app.Service;
import android.content.Context;
import android.content.Intent;
import android.content.SharedPreferences;
import android.os.AsyncTask;
import android.os.IBinder;
import android.os.Vibrator;
import android.util.Log;
import android.webkit.CookieManager;
import android.webkit.CookieSyncManager;
import android.widget.Toast;

public class StartUpService extends Service {   
    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }

    @Override
    public void onCreate() {
        return;
    }

    @Override
    public void onDestroy() {
        return;
    }

    @Override
    public void onStart(Intent intent, int startid) { 

        String preferences = "SERVICE";

        SharedPreferences settings = getSharedPreferences(preferences, 0);

        SharedPreferences.Editor editor = settings.edit();
        editor.putBoolean("firstrun", false);
        editor.commit();

        CookieSyncManager.getInstance().sync();
        CookieManager cookie_manager = CookieManager.getInstance();

        String cookies = cookie_manager.getCookie("myurl");
        if(cookies != null) {
            int index = cookies.indexOf("sessiecode");
            if(index != -1) {
                String[] cookie = cookies.split("sessiecode=");
                String c = cookie[cookie.length - 1]; 
                new GetInteger().execute("myurl");
            }
        }

    }

    class GetInteger extends AsyncTask<String, String, String>{
        @Override
        protected String doInBackground(String... uri) {

            try {
                HttpClient httpclient = new DefaultHttpClient();
                HttpResponse response;  

                HttpGet post = new HttpGet(uri[0]);

                response = httpclient.execute(post);
                StatusLine statusLine = response.getStatusLine();

                if(statusLine.getStatusCode() == HttpStatus.SC_OK){                 
                    ByteArrayOutputStream out = new ByteArrayOutputStream();
                    response.getEntity().writeTo(out);
                    out.close();
                    String responseString = out.toString();
                    return responseString;
                } else { 
                    response.getEntity().getContent().close();
                    Log.e("com.my.app", "HTTPRequest error");
                }

            } catch (Exception e) {
                Log.e("com.my.app", "Error: " + e.getMessage());
                e.printStackTrace();
            }
            */
            return "5"; 
        }

        @Override
        protected void onPostExecute(String result) {
            super.onPostExecute(result);

            int responseInt = Integer.parseInt(result);
            int NOTIF_ID = 1234;  
            NotificationManager notifManager = (NotificationManager) getSystemService(NOTIFICATION_SERVICE); 
            notifManager.cancel(NOTIF_ID);
            if(responseInt > 0) {

                Notification note = new Notification(R.drawable.ic_note, "Nieuw privébericht", System.currentTimeMillis());  
                PendingIntent pintent = PendingIntent.getActivity(One2xsService.this, 0, new Intent(StartUpService.this, MainActivity.class), 0); 

                String noteString;
                if(responseInt > 1) {
                    noteString = "Je hebt " + responseInt + " ongelezen berichten";
                } else {
                    noteString = "Je hebt 1 ongelezen bericht";                     
                }

                note.setLatestEventInfo(One2xsService.this, "Nieuw privébericht", noteString, pintent);  
                note.flags = Notification.FLAG_AUTO_CANCEL;
                notifManager.notify(NOTIF_ID, note); 

                Vibrator v = (Vibrator) getSystemService(Context.VIBRATOR_SERVICE);
                v.vibrate(200);
            }

        }

    }

} 
```

我希望任何人都可以提供帮助！

编辑，记录：

```
02-02 19:00:27.100: E/AndroidRuntime(261): FATAL EXCEPTION: main
02-02 19:00:27.100: E/AndroidRuntime(261): java.lang.RuntimeException: Unable to start service com.my.app.StartUpService@40518b30 with Intent { cmp=com.my.app/.StartUpService }: java.lang.IllegalStateException: CookieSyncManager::createInstance() needs to be called before CookieSyncManager::getInstance()
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2052)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.app.ActivityThread.access$2800(ActivityThread.java:117)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.app.ActivityThread$H.handleMessage(ActivityThread.java:994)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.os.Handler.dispatchMessage(Handler.java:99)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.os.Looper.loop(Looper.java:123)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.app.ActivityThread.main(ActivityThread.java:3683)
02-02 19:00:27.100: E/AndroidRuntime(261):  at java.lang.reflect.Method.invokeNative(Native Method)
02-02 19:00:27.100: E/AndroidRuntime(261):  at java.lang.reflect.Method.invoke(Method.java:507)
02-02 19:00:27.100: E/AndroidRuntime(261):  at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:839)
02-02 19:00:27.100: E/AndroidRuntime(261):  at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:597)
02-02 19:00:27.100: E/AndroidRuntime(261):  at dalvik.system.NativeStart.main(Native Method)
02-02 19:00:27.100: E/AndroidRuntime(261): Caused by: java.lang.IllegalStateException: CookieSyncManager::createInstance() needs to be called before CookieSyncManager::getInstance()
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.webkit.CookieSyncManager.getInstance(CookieSyncManager.java:81)
02-02 19:00:27.100: E/AndroidRuntime(261):  at com.blay.one2xs.One2xsService.onStart(One2xsService.java:56)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.app.Service.onStartCommand(Service.java:428)
02-02 19:00:27.100: E/AndroidRuntime(261):  at android.app.ActivityThread.handleServiceArgs(ActivityThread.java:2039)
02-02 19:00:27.100: E/AndroidRuntime(261):  ... 10 more 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:21:48.553

如日志：

> CookieSyncManager::createInstance() 需要在 CookieSyncManager::getInstance() 之前调用

在调用 getInstance() 方法之前，您需要调用 createInstance()：

```
CookieSyncManager.createInstance(getApplicationContext); 
CookieSyncManager.getInstance().sync();
CookieManager cookie_manager = CookieManager.getInstance(); 
```

# jquery - 优化 Facebook 图形查询

> ID：14665211
> 
> 赞同：0
> 
> 时间：2013-02-02T18:44:42.373
> 
> 标签：jquery, facebook, facebook-graph-api, facebook-fql

是否有任何最佳方式来检索*带有*个人资料图片的朋友列表？

我正在获取朋友列表，然后查询每个朋友`userid`的个人资料图片 URL。

如果您要加载一大群 500+ 的朋友并查询他们每个人的个人资料图片 URL，这似乎非常低效。

如果无法通过图表完成，那么使用 FQL 执行此操作的最佳方法是什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T18:56:23.270

这很容易：

```
/me/friends?fields=name,picture 
```

如果您想要特定尺寸的照片，请使用以下命令：

```
/me/friends?fields=name,picture.type(SIZE) 
```

,或`SIZE`之一在哪里。`small``normal``large``square`

在 FQL 中，您可以使用

```
SELECT uid, name, pic FROM user WHERE uid IN (SELECT uid1 FROM friend WHERE uid2=me()) 
```

# javascript - 包括 if else 语句的 for 循环仅返回最后一次迭代。做什么？(javascript)

> ID：14665212
> 
> 赞同：0
> 
> 时间：2013-02-02T18:44:46.683
> 
> 标签：javascript, if-statement, for-loop

我今天才开始使用javascript，并在网络上对此事进行了研究。但是我无法掌握闭包的用法，尤其是对于我编写的这段代码：

```
function writeit()
{
    var tbox = document.getElementById('a_tbox').value;
    var letters = tbox.split("");
    for(var i=0;i<letters.length;i++)
    {
        if(letters[i]==="a")
        {
            document.a_form.b_tbox.value = i+1 + ". character is a";
        }
        else if(letters[i]==="b")
        {
            document.a_form.b_tbox.value = i+1 + ". character is b";
        }
        else
        {
            document.a_form.b_tbox.value = i+1 + ". character is not a nor b";
        }
    }
} 
```

正如您在此处看到的，我想从文本框中获取一个字符串，将其拆分为一个数组并使用 for 循环更改其中的值。我对我的代码的期望是，如果文本框包含“abc”作为用户贡献，则输出将是“1\. value is a 2\. value is b 3\. value is not a or b”。但它只给出“3\. value is not a nor b”作为输出。可以做些什么来防止这个问题？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T18:50:42.673

循环的每次迭代都会覆盖最后一个结果，因为您要替换文本框的值，而不是为每次迭代添加。使用 += 来避免这种情况，如下所示：

```
document.a_form.b_tbox.value += i+1 + ". character is not a nor b"; 
```

# php - 一键提交多个表单，在MySQL中存储变量

> ID：14665213
> 
> 赞同：4
> 
> 时间：2013-02-02T18:44:47.570
> 
> 标签：php, ajax

我目前正在学习表单和 Ajax 发布而无需刷新页面。我有树形表格和一个提交按钮。我已经为每个输入字段分配了 php 变量，这些变量将采用输入的值。每个输入框都会回显该值。是否可以同时提交所有三个表格？如果是，单击按钮后如何将这些值提交到 MySQL 数据库？

**阿贾克斯：**

```
function() {
    $.ajax({
        type: "POST",
        url: "posting.php",
        data: { 
            "name": $("#name").val(),
            "age": $("#age").val(),
            "phone": $("#phone").val(),
            "email": $("#email").val(),
            "job": $("#job").val(),
            "hobby": $("#hobby").val(),
        },
        success: function(data) {
            $("#inputResult").html(data);
        }
    });
} 
```

**PHP**

```
if ($_SERVER['REQUEST_METHOD'] == 'POST')
{
    if (isset($_POST['name'])) {
        $name = $_POST['name'];
        echo '<div id="name_input"><h2 class="lastTab">Name:</h2>' . $name . '</div>';
    }

    if (isset($_POST['age'])) {
        $age = $_POST['age'];
        echo '<div id="age_input"><h2 class="lastTab">Age:</h2>' . $age . '</div>';
    }

    if (isset($_POST['phone'])) {
        $phone = $_POST['phone'];
        echo '<div id="phone_input"><h2 class="lastTab">Phone:</h2>' . $phone . '</div>';
    }

    if (isset($_POST['email'])) {
        $email = $_POST['email'];
        echo '<div id="email_input"><h2 class="lastTab">Email:</h2>' . $email . '</div>';
    }           

    if (isset($_POST['job'])) {
        $job = $_POST['job'];
        echo '<div id="job_input"><h2 class="lastTab">Job:</h2>' . $job . '</div>';
    }       

    if (isset($_POST['hobby'])) {
        $hobby = $_POST['hobby'];
        echo '<div id="hobby_input"><h2 class="lastTab">Hobby:</h2>' . $hobby . '</div>';
    }
} 
```

**HTML**

```
<div id="tab-1" class="ui-tabs-panel ui-tabs-hide">
    <form autocomplete="off" method="post" enctype="multipart/form-data" id="postForm1" name="postForm1" class="postForm">
       Name
        <input type="text" id="name" class="detail" name="name" value="" /> 
        Age
        <input type="text" id="age" class="detail" name="age" value="" />   
    </form>         
    </div>.

    <div id="tab-2" class="ui-tabs-panel ui-tabs-hide">
    <form autocomplete="off" method="post" enctype="multipart/form-data" id="postForm2" name="postForm2" class="postForm">
        Phone Number
        <input type="text" id="phone" class="detail" name="phone" value="" />       
        Email
        <input type="text" id="email" class="detail" name="email" value="" /> 
    </form>     
    </div>

    <div id="tab-3" class="ui-tabs-panel ui-tabs-hide">
    <form autocomplete="off" method="post" enctype="multipart/form-data" id="postForm3" name="postForm3" class="postForm">
        Job
        <input type="text" id="job" class="detail" name="job" value="" /> 
        Hobby
        <input type="text" id="hobby" class="detail" name="hobby" value="" />       
    </form>     
    </div> 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T18:59:37.977

您可以使用 javascript 来捕获`submit`表单，也可以触发您创建的函数。对于第二种情况，它不必是 3 个表单甚至是表单元素

HTML：

```
<div id="tab-1" class="ui-tabs-panel ui-tabs-hide">
    <form autocomplete="off" method="post" enctype="multipart/form-data" id="postForm1" name="postForm1" class="postForm">
       Name
        <input type="text" id="name" class="detail" name="name" value="" /> 
        Age
        <input type="text" id="age" class="detail" name="age" value="" />   
    </form>         
    </div>.

    <div id="tab-2" class="ui-tabs-panel ui-tabs-hide">
    <form autocomplete="off" method="post" enctype="multipart/form-data" id="postForm2" name="postForm2" class="postForm">
        Phone Number
        <input type="text" id="phone" class="detail" name="phone" value="" />       
        Email
        <input type="text" id="email" class="detail" name="email" value="" /> 
    </form>     
    </div>

    <div id="tab-3" class="ui-tabs-panel ui-tabs-hide">
    <form autocomplete="off" method="post" enctype="multipart/form-data" id="postForm3" name="postForm3" class="postForm">
        Job
        <input type="text" id="job" class="detail" name="job" value="" /> 
        Hobby
        <input type="text" id="hobby" class="detail" name="hobby" value="" />
        <input type="button" value="SAVE" onclick="saveThem()" />       
    </form>     
    </div> 
```

阿贾克斯：

```
 function saveThem() {

var name = $.trim($("#name").val());
var age = $.trim($("#age").val());
var phone = $.trim($("#phone").val());
var email = $.trim($("#email").val());
var job = $.trim($("#job").val());
var hobby = $.trim($("#hobby").val());

var dataString = 'name='+name+'&age='+age+'&phone='+phone+'&email='+email+'&job='+job+'&hobby='+hobby;

      $.ajax({
          type: "POST",
          url: 'http://www.yourdomain.com/something.php',
          data: dataString,
          dataType: "json",
          success: function(data) {
            if(data.response){ alert(data.message); }
            $("#inputResult").html(data);
          }
      });
    } 
```

东西.php

```
//Get posted variables
$name = (isset($_POST['name'])) ? strip_tags($_POST['name']) : NULL;
$age = (isset($_POST['age'])) ? strip_tags($_POST['age']) : NULL;
$phone = (isset($_POST['phone'])) ? strip_tags($_POST['phone']) : NULL;
$email = (isset($_POST['email'])) ? strip_tags($_POST['email']) : NULL;
$job = (isset($_POST['job'])) ? strip_tags($_POST['job']) : NULL;
$hobby = (isset($_POST['hobby'])) ? strip_tags($_POST['hobby']) : NULL;

//execute your query
$sql = "INSERT INTO ...";

//Return results back to ajax  
$result = array(
'response' => 1,
'message' => 'We have a success!'
);
echo json_encode($result); 
```

所以总而言之与使用 php 几乎相同，但中间有一些 javascript。
**表单**：为要发送到服务器（php）的每个元素创建一个 id
**Js**：根据元素 id 捕获值并将它们发送到 php
**Php**：获取值，清理它们，查询或其他任何内容并将结果发送回 js

**编辑：使用 jQuery 序列化（）**

```
$('form').submit(function() {
 $dataString = $(this).serialize(); //This will produce the same result, based on input names

}); 
```

# python - 如何轻松分发具有 Python 模块依赖项的 Python 软件？在 Unix 上安装 Python 包的挫折

> ID：14665216
> 
> 赞同：59
> 
> 时间：2013-02-02T18:45:27.467
> 
> 标签：python, pip, setuptools, python-packaging, distribute

我的目标是分发一个 Python 包，其中包含其他几个广泛使用的 Python 包作为依赖项。我的包依赖于编写良好的、带有 Pypi 索引的包，如 pandas、scipy 和 numpy，并在 setup.py 中指定需要某些版本或更高版本，例如“numpy >= 1.5”。

我发现对于*不是*Python 打包专家（即使他们知道如何编写 Python）的精通 Unix 的用户来说，安装像我这样的包是非常令人沮丧和几乎不可能的，即使在使用应该易于使用的包管理器时也是如此. 我想知道是否有人可以提供这个痛苦过程的替代方案，或者我的经验是否只是反映了 Python 打包和分发当前非常困难的状态。

假设用户将您的软件包下载到他们的系统上。大多数人会尝试“天真地”安装它，使用类似的东西：

```
$ python setup.py install 
```

因为如果你在谷歌上搜索安装 Python 包的说明，通常会出现这种情况。对于绝大多数用户来说，这将失败，因为大多数用户在他们的 Unix/Linux 服务器上没有 root 访问权限。通过更多搜索，他们会发现“--prefix”选项并尝试：

```
$ python setup.py install --prefix=/some/local/dir 
```

`--prefix`由于用户不了解 Python 打包的复杂性，他们会选择任意目录作为`"~/software/mypackage/"`. 它不会是所有其他 Python 包所在的干净策划的目录，因为同样，大多数用户并不知道这些细节。如果他们安装另一个包“myotherpackage”，他们可能会通过它`"~/software/myotherpackage"`，你可以想象这将如何导致令人沮丧的黑客攻击`PYTHONPATH`和其他并发症。

继续安装过程，一旦用户尝试使用该包，调用`"setup.py install"`with`"--prefix"`也将失败，即使它似乎已正确安装，因为可能缺少其中一个依赖项（例如 pandas、scipy 或 numpy）和一个包不使用管理器。他们将尝试单独安装这些软件包。即使成功，`PYTHONPATH`由于给定的非标准目录，包将不可避免地不在`"--prefix"`，耐心的用户将涉足其修改`PYTHONPATH`以使依赖项可见。

在这个阶段，精通 Python 的朋友可能会告诉用户，他们应该使用包管理器`"easy_install"`（主流管理器）来安装软件并处理依赖关系。安装后`"easy_install"`，这可能很困难，他们会尝试：

```
$ easy_install setup.py 
```

这也会失败，因为用户通常没有权限在生产 Unix 服务器上全局安装软件。通过更多阅读，他们将了解该`"--user"`选项，并尝试：

```
$ easy_install setup.py --user 
```

他们会得到错误：

```
usage: easy_install [options] requirement_or_url ...
   or: easy_install --help

error: option --user not recognized 
```

他们会非常困惑，为什么他们`easy_install`没有`--user`选项，而在线上有明确的页面描述了该选项。他们可能会尝试将其升级`easy_install`到最新版本并发现它仍然失败。

如果他们继续咨询Python打包专家，他们会发现有**两个版本**，`easy_install`都命名为“`easy_install"`以便最大程度地混淆”，但一个是“distribute”，另一个是“setuptools”。恰好是只有`"easy_install"`支持和`"distribute"`绝大多数`"--user"`服务器/系统管理员安装`"setuptools"`，`easy_install`所以本地安装是不可能的。请记住，对于非 Python 包管理专家的人来说，和之间的这些区别`"distribute"`是`"setuptools"`没有意义的并且难以理解。

在这一点上，即使是尝试安装我的软件包的最坚定、最精明和耐心的用户，我也会失去 90% 的用户——这是理所当然的！他们想安装一个碰巧用 Python 编写的软件，而不是成为最先进的 Python 包分发方面的专家，这太令人困惑和复杂了。他们会放弃并为浪费的时间感到沮丧。

继续询问更多 Python 专家的极少数用户将被告知他们应该`pip/virtualenv`使用`easy_install`. 安装`pip`和`virtualenv`弄清楚这些工具是如何工作的，以及它们与传统`"python setup.py"`或`"easy_install"`调用的不同之处本身就是耗时且困难的，对于只想安装一个简单的 Python 软件并使用它的用户来说，要求也太高了。即使是那些追求这条道路的人也会对他们安装的任何依赖项是否仍然可用`easy_install`或者是否需要从头开始重新安装所有依赖项感到困惑。`setup.py install --prefix``pip/virtualenv`

如果一个或多个有问题的包依赖于安装与默认版本不同的 Python 版本，则此问题会更加严重。确保您的 Python 包管理器使用的是您想要的 Python 版本，以及确保所需的依赖项安装在相关的 Python 2.x 目录而不是 Python 2.y 中的困难，将让用户无休止地感到沮丧，以至于他们肯定会在那个阶段放弃。

有没有更简单的方法来安装 Python 软件，不需要用户深入研究 Python 包、路径和位置的所有这些技术细节？例如，我不是 Java 大用户，但我偶尔会使用一些 Java 工具，并且不记得曾经担心我正在安装的 Java 软件的 X 和 Y 依赖关系，而且我不知道 Java 是如何打包的管理作品（我很高兴我不这样做——我只是想使用一个碰巧用 Java 编写的工具。） .

是否有 Python 的等价物？以一种不依赖于用户必须追逐所有这些依赖项和版本的方式分发软件的方法？一种可能将所有相关包编译成独立的东西的方法，可以下载并用作二进制文件？

我想强调的是，即使将软件包分发给精通的 Unix 用户的狭隘目标也会发生这种挫败感，这使问题变得更简单，无需担心跨平台问题等。我假设用户精通 Unix，甚至可能了解 Python，但只是不了解（也不想被告知）Python 打包的来龙去脉以及不同包管理器的无数内部复杂性/竞争。这个问题的一个令人不安的特点是，即使您的所有 Python 包依赖项都是众所周知的、编写良好且维护良好的 Pypi 可用包（如 Pandas、Scipy 和 Numpy），它也会发生。这不像是我依赖于一些不是格式正确的包的晦涩依赖：相反，我使用的是许多人可能依赖的最主流的包。

对此的任何帮助或建议将不胜感激。我认为 Python 是一门很棒的语言，拥有很棒的库，但我发现几乎不可能以一种易于人们在本地安装并运行的方式分发我用它编写的软件（一旦它具有依赖项）。我想澄清一下，我正在编写的软件不是用于编程使用的 Python 库，而是具有用户作为单独程序运行的可执行脚本的软件。谢谢。

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-02T20:24:00.600

我们还开发依赖于 numpy、scipy 和其他 PyPI 包的软件项目。毫无疑问，目前用于管理远程安装的最佳工具是[zc.buildout](http://www.buildout.org/)。它**非常**易于使用。您从他们的网站下载引导脚本并将其与您的包一起分发。您编写了一个“本地部署”文件，通常称为`buildout.cfg`，它解释了如何在本地安装包。您将`bootstrap.py`文件和`buildout.cfg`您的包一起发送 - 我们使用`MANIFEST.in`我们的 python 包中的文件来强制使用 PyPI 分发的 zip 或 tar 球嵌入这两个文件。当用户解包时，它应该执行两个命令：

```
$ python bootstrap.py # this will download zc.buildout and setuptools
$ ./bin/buildout # this will build and **locally** install your package + deps 
```

该包已编译，所有依赖项都安装**在本地**，这意味着安装您的包的​​用户甚至不需要 root 权限，这是一个附加功能。脚本（通常）放在 下`./bin`，因此用户可以在此之后执行它们。`zc.buildout`用于`setuptools`与 PyPI 交互，因此您期望的一切都可以开箱即用。

如果所有这些功能还不够，您可以很容易地进行扩展`zc.buildout`——您可以创建所谓的“配方”，帮助用户创建额外的配置文件、从网上下载其他东西或实例化自定义程序。[zc.buildout](http://www.buildout.org/)网站包含一个视频教程，详细解释了如何使用 buildout 以及如何扩展它。我们的项目[Bob](http://www.idiap.ch/software/bob/)广泛使用 buildout 来分发包以供科学使用。如果您愿意，请[访问以下页面](https://pythonhosted.org/bob.extension/guide.html)，其中包含为我们的开发人员提供的详细说明，了解他们如何设置他们的 python 包，以便其他人可以使用`zc.buildout`.

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-09-15T12:11:24.970

我们目前正在努力让用户更容易开始以独立于平台的方式安装 Python 软件（特别是请参阅[https://python-packaging-user-guide.readthedocs.org/en/latest/future.html](https://python-packaging-user-guide.readthedocs.org/en/latest/future.html)和[http://www.python.org/dev/peps/pep-0453/](http://www.python.org/dev/peps/pep-0453/)）

目前，easy_install 的两个竞争版本的问题已经解决，竞争的 fork “distribute”被合并到 setuptools 开发主线。

当前关于 Python 软件跨平台分发和安装的最佳建议可在此处获取：[https ://packaging.python.org/](https://packaging.python.org/)

# php - 缺少论点？

> ID：14665220
> 
> 赞同：1
> 
> 时间：2013-02-02T18:45:54.937
> 
> 标签：php

我的脚本中出现 MySQL 无效查询错误。它没有列出发生错误的行，所以我不确定它是 SQL 语法错误还是找不到连接。为了尝试捕捉错误，我创建了一个错误函数。但是，即使是缺少 arg 的错误：Warning: Missing argument 1 for senderroremail(), calle

```
function senderroremail($line) {
    mail('xxx@xxx.co.uk', 'IntegrityCheck script error', mysql_error().' error');
    die('Invalid query: ' . mysql_error().' '.$line );  
}

if (!$squid_conn_int)     {senderroremail(__LINE__);} 
```

每次查询、插入、更新等后，我都会收到 senderroremail。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:04:18.047

那个错误不是说**_ *LINE* _**没有返回值吗？

**print( _ *LINE* _** );是什么意思？明白？您是否尝试过类似 senderroremail(777); ?

# c++ - 高效访问矩阵列

> ID：14665229
> 
> 赞同：0
> 
> 时间：2013-02-02T18:46:53.680
> 
> 标签：c++, c, performance, matrix

高效访问问题：我需要按列访问大型矩阵（超过 2000x2000），我的算法需要 1 行通道和 1 列通道。行传对内存效率（缓存未命中）很好，但是如何减少列传中的缓存未命中？我需要效率。

我唯一的东西是：声明 n 局部变量（基于内存获取大小），

`int a1, a2, a3, a4; for ( int j = 0 ; j < DIM_Y ; j+=4 ) for ( int i = 0 ; i < DIM_X ; i++ ) a1 = matrix[i][j]; ... ; a4 = matrix[i][j+4]; // make the column processing on the 4 variables.`

它在 C 或 C++ 中，在数组或 int 或 char 中。

欢迎任何提议和评论。

谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-04T10:41:17.103

应用两种基本技术：

1) 循环阻塞

代替

```
 for (j=0;j<2000;j++)
   for (i=0;i<2000;i++) 
     process_element(i,j); 
```

利用

```
for (j=0;j<2000;j+=8) 
  for (i=0;i<2000;i+=8) 
    process_block_of_8x8(i,j); 
```

2) 2 行跨度的非幂（例如 8192 字节 + 64）——必要时填充

在这种情况下 row[i] .. row[i+7] 不会争夺同一个缓存行

数据应位于具有手动计算填充的连续内存区域中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:58:11.840

存储 2D 矩阵的有效方法是使用`C`如下样式数组：

```
| a11 a12 a13 |
| a21 a22 a23 |   -> memory: [a11,a12,a13,a21,a22,a23,a31,a32,a33]
| a31 a32 a33 | 

Element(i,j) = memory[N_COL*i+j] 
```

其中`i`是从 开始的行号索引，也是从 开始的列号索引，`0`以及列数。`j``0``N_COL`

希望编译器/jit 将所有值按顺序放置在内存中以便快速访问。通常，您试图欺骗编译器的次数越多（例如手动展开循环），您对性能的伤害就越大。编写干净的代码，让编译器完成它的工作。

# python - 允许值的 argparse 选择结构

> ID：14665234
> 
> 赞同：10
> 
> 时间：2013-02-02T18:47:16.983
> 
> 标签：python, argparse

`argparse`对于使用 argparse 的组之间的Python[依赖关系](https://stackoverflow.com/questions/14660876/python-dependencies-between-groups-using-argparse)，我有一个解析器的某个解析器组的参数部分 - 例如：

```
group_simulate.add_argument('-P',
                            help='simulate FC port down',
                            nargs=1,
                            metavar='fc_port_name',
                            dest='simulate') 
```

如何使用[选项](http://docs.python.org/2/library/argparse.html#choices)将选项限制为下一个结构的参数列表：

```
1:m:"number between 1 and 10":p:"number between 1 and 4" 
```

我尝试使用范围选项，但找不到创建可接受选项列表的方法

示例： 合法参数：

```
test.py -P 1:m:4:p:2 
```

不合法的参数：

```
test.py -P 1:p:2
test.py -P abvds 
```

非常感谢你们的帮助！

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-02-05T16:15:30.483

`argparse.ArgumentTypeError`您可以定义一个自定义类型，如果字符串与您需要的格式不匹配，它将引发一个。

```
def SpecialString(v):
    fields = v.split(":")
    # Raise a value error for any part of the string
    # that doesn't match your specification. Make as many
    # checks as you need. I've only included a couple here
    # as examples.
    if len(fields) != 5:
        raise argparse.ArgumentTypeError("String must have 5 fields")
    elif not (1 <= int(fields[2]) <= 10):
        raise argparse.ArgumentTypeError("Field 3 must be between 1 and 10, inclusive")
    else:
        # If all the checks pass, just return the string as is
        return v

group_simulate.add_argument('-P',
                        type=SpecialString,
                        help='simulate FC port down',
                        nargs=1,
                        metavar='fc_port_name',
                        dest='simulate') 
```

更新：这是一个完整的自定义类型来检查值。所有检查都在正则表达式中完成，尽管如果任何部分错误，它只会给出一个通用错误消息。

```
def SpecialString(v):
    import re  # Unless you've already imported re previously
    try:
        return re.match("^1:m:([1-9]|10):p:(1|2|3|4)$", v).group(0)
    except:
        raise argparse.ArgumentTypeError("String '%s' does not match required format"%(v,)) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-12-01T19:12:00.563

如果我正确理解了这个问题，那么您只是在寻找：

```
group_simulate.add_argument('-P',
                            help='simulate FC port down',
                            type=int, 
                            metavar='fc_port_name',
                            dest='simulate',
                            choices=range(1, 10)) # answer 
```

来源：[https ://docs.python.org/3/library/argparse.html#choices](https://docs.python.org/3/library/argparse.html#choices)

# r - 如何将 1 列匹配到 2 列？

> ID：14665235
> 
> 赞同：3
> 
> 时间：2013-02-02T18:47:21.957
> 
> 标签：r

我正在尝试将一列中的数字与另外两列中的数字相匹配。当仅匹配单个列时，我可以做到这一点，但在扩展到两列时会遇到问题。这是我正在做的事情：

我有 2 个数据框，df1：

```
number  value
1   
2   
3   
4   
5 
```

和df2：

```
number_a    number_b    value
3                       3
            1           5  
5                       1 
            4           2
            2           4 
```

我想要做的是将df1中的“number”列匹配到df2中的“number_a”或number_b”，然后将df2中的“value”插入df1的“value”，将结果df1设为：

```
number  value
1           5
2           4
3           3   
4           2
5           1 
```

我的方法是使用

```
df1$value <- df2$value[match(df1$number, df2$number_a)] 
```

或者

```
df1$value <- df2$value[match(df1$number, df2$number_b)] 
```

分别产生 df1

```
number  value
1           NA
2           NA
3           3
4           NA
5           1 
```

和

```
number  value
1           5
2           4
3           NA
4           2
5           NA 
```

但是，我似乎无法使用这种方法填写 df1 中的所有“值”列。如何一举将“number”与“number_a”和“number_b”匹配。我试过了

```
df1$value <- df2$value[match(df1$number, df2$number_a:number_b)] 
```

但这没有用。

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T18:56:19.987

更简单的解决方案：

```
df2$number <- ifelse(is.na(df2$number_a), df2$number_b, df2$number_a) 
```

如果您不熟悉 ifelse，它可以使用以下形式的向量：

```
ifelse(Condition, ValueIfTrue, ValueIfFalse) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:49:33.663

我是 R 的新手（来自 C 几年）。正在尝试这些建议，我想我会粘贴我想出的：

```
// Assuming either 'number_a' or 'number_b' is valid
// Combine into new column 'number' and delete them original columns

df2 <- transform(df2, number = ifelse(is.na(df2$number_a), df2$number_b, 
       df2$number_a))[-c(1:2)]

// Combine the two data frames by the column 'number'
df <- merge(df1, df2, by = "number") 
```

```
  数值
       1 5
       2 4
       3 3
       4 2
       5 1

```

# jquery - 为什么这个 jQuery css() 不起作用？

> ID：14665238
> 
> 赞同：2
> 
> 时间：2013-02-02T18:47:35.027
> 
> 标签：jquery

我有一个链接样式表，其中包含以下内容：

```
.dirContent {width: 190px, padding: 10px;) 
```

我正在运行这个脚本：

```
var npad = $(".dirContent").css("padding");
alert(npad); 
```

...但它不起作用 - 它返回一个空白警报框。现在如果我运行这个脚本：

```
var npad = $(".dirContent").css("width");
alert(npad); 
```

它返回“190px”，警报显示正确的值。

想法？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:58:28.267

我看到的两个问题：

*   格式错误的 CSS（在其他答案中介绍）
*   [对速记属性](https://stackoverflow.com/questions/9135922/jquery-and-setting-css-with-shorthand)的不一致处理

本质上，*检索*速记属性在浏览器中的工作方式不一致。在 Chrome 中，查询“padding”属性会返回一个部分字符串（“1px”），如果所有 4 个边都被均匀填充，如果任何边的填充不同，则返回一个 4 部分（“1px 2px 3px 4px”）字符串.

但是 IE9 什么也没返回。Firefox 18 不返回任何内容。

```
var npad = $(".dirContent").css("padding");
alert(npad);
npad = $(".dirContent").css("padding-left");
alert(npad); 
```

在几个浏览器中尝试此示例，您应该会看到不同之处：http: [//jsfiddle.net/XDL3N/1/](http://jsfiddle.net/XDL3N/1/)

如果你仔细想想，这种行为是有道理的。虽然速记对于设置属性非常有用，但对于*获取*它们却没有多大用处。您需要解析多段字符串才能对其进行任何有用的操作。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T18:52:40.873

您正在使用 a`,`来终止 CSS 属性。

```
.dirContent {width: 190px; padding: 10px;} 
```

这是[小提琴](http://jsfiddle.net/9K6zR/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T18:54:09.313

您的 css 属性格式错误，它必须是：

```
.dirContent {width: 190px; padding: 10px;} 
```

工作小提琴：http: [//jsfiddle.net/XDL3N/](http://jsfiddle.net/XDL3N/)

# opencv - 在 OpenCV 中编译

> ID：14665245
> 
> 赞同：1
> 
> 时间：2013-02-02T18:48:09.427
> 
> 标签：opencv

每次我尝试在 OpenCV 中编译此代码时，我都会收到此错误。我要做的就是创建一个窗口：

```
//#include <iostream>
//#include <stdio.h>
#include "highgui.h"

int main() {
    int cvNamedWindow(const char* name, int flags = CV_WINDOW_AUTOSIZE);
    {
        cvNamedWindow("sample");
    }
    cvDestroyWindow("sample");    
} 
```

但是我收到了这个错误：

> window.cpp:4:21：致命错误：highgui.h：没有这样的文件或目录

我已经签入了必要的文件夹并且`highgui.h`安装得非常好。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:12:12.063

包括以下文件

```
#include "opencv2/highgui/highgui.hpp" 
```

并编译文件

```
g++ -ggdb `pkg-config --cflags opencv` filename `pkg-config --libs opencv` 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:16:13.480

如果您将 OpenCV 包含作为包含路径的一部分，则它应该是

`#include "opencv/highgui.h"`

或者

`#include "opencv2/highgui/highgui.hpp"`

取决于您使用 c 或 c++

# android - 启动活动会导致 ViewPager 重置

> ID：14665246
> 
> 赞同：0
> 
> 时间：2013-02-02T18:48:10.290
> 
> 标签：android, android-activity, android-actionbar, actionbarsherlock, android-viewpager

我之前问过这个问题，并认为它正在工作并删除了这个问题，但因为发现这不起作用。我的`ViewPager`应用程序中有一个，每个`Fragment`都`ViewPager`持有一个`ListView`. When an item in the `ListView`is selected, I am starting a new activity in `onListItemClick`:

```
@Override
public void onListItemClick(ListView l, View v, int position, long id)
{
    super.onListItemClick(l, v, position, id);

    final Intent browser = new Intent(activity, Browser.class);

    startActivity(browser);
} 
```

问题是，当我按下后退按钮或 中的 Home 按钮时`Actionbar`，`ViewPager`它会自行重置以显示第一个片段。

这是我用于主页按钮的代码：

```
@Override
public boolean onOptionsItemSelected(final MenuItem item) 
{
     if (item.getItemId() == android.R.id.home) {

        Intent intent = new Intent(this, Main.class);

        startActivity(intent);
        return true;
    } else {
        return super.onOptionsItemSelected(item);
    }
} 
```

在我最初的问题中，建议将 Android Manifest 中的启动模式设置为`singleTop`，这是我为启动活动以及从 启动的活动所做的`ListView`，但这似乎并没有解决它。

我考虑过将`ViewPager's`位置传递给新活动，然后`onResume`从原始活动中检索它并手动设置`ViewPager's`位置，但这对我来说似乎真的很暴力。

# asp.net - 如何为 IIS 应用程序池帐户授予数据库权限？

> ID：14665250
> 
> 赞同：4
> 
> 时间：2013-02-02T18:48:33.700
> 
> 标签：asp.net, sql-server

如何授予从 IIS 登录和访问 AdventureWorks 数据库的权限？

我正在 Visual Studio 2010（IIS 中托管的 Silverlight）中开发一个应用程序，我收到一条错误消息，指出它无法打开 AdventureWorks 数据库，因为用户 IIS APPPOOL\ASP .NET 4.0 登录失败。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:07:40.770

使用 SQL Server 管理工作室。

1.  在 SQL Server 中为 IIS AppPool\{YourApplicationPoolName} 创建一个 Windows 登录
2.  将此登录名添加到您的数据库
3.  根据需要为数据库中的帐户授予权限。

# php - 在www下定义一个临时目录来上传文件

> ID：14665255
> 
> 赞同：0
> 
> 时间：2013-02-02T18:49:40.663
> 
> 标签：php

我正在尝试将文件上传到 apache public_html 目录。好吧，我相信值得一提的是，我在一个虚拟主机环境中，该环境在具有几个域和子域的 VPS 上运行。

通常在我的 XAMPP 服务器上，将文件加载到临时文件夹不会有任何问题，但在新服务器上尝试上传时它不可能给我一个错误。

我检查了超全局 $_FILES 并收到此错误：

```
array(1) { ["file"]=> array(5) { ["name"]=> string(9) "test.gif" ["type"]=> string(0) "" ["tmp_name"]=> string(0) "" ["error"]=> int(1) ["size"]=> int(0) } } 
```

我尝试使用 get_init('/tmp') 在服务器上设置一个 tmp 文件夹，但没有成功。

非常感谢您的关注。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T13:19:50.823

显然我无法在我的 VPS 上设置一个新的临时文件夹来上传文件。

我尝试了什么：

使用 ini_set('upload_tmp_dir', '/tmp'); 设置一个新的临时文件夹 没有任何成功！那是什么原因呢？答：没有权限。

因此，在使用 ini_set() 之前，请确保您有权使用它，否则它不会影响 php 引擎的行为。

反正好像不设置临时文件夹的话，PHP会默认使用/tmp。总之，如果您不设置新的临时文件夹，上传文件不会有问题。您可能还有其他与文件大小有关的问题。检查 file_uploads -> ON、upload_max_filesize、max_file_uploads 的 php 信息，您可以在 upload_tmp_dir 设置一个新的临时文件夹，但肯定不会有问题。

如果您仍然无法上传文件，则可能是库依赖项存在问题。我的建议是确保您使用的所有功能都安装在服务器上，例如 GD 库，特别是在您尝试操作图像时。

您可以通过创建一个带有 php 扩展名的新文件并在 php 标记之间使用函数来检查 php 信息： phpinfo();

注意：您可以在 php.ini 中或使用 ini_set() 函数进行上述所有更改。

我的服务器问题是 GD 库！！！

这就是我的十美分贡献。我希望它可以帮助某人:)

# ruby-on-rails - 用于 nil:NilClass 的 Rails Linked Models 未定义方法

> ID：14665257
> 
> 赞同：0
> 
> 时间：2013-02-02T18:50:01.350
> 
> 标签：ruby-on-rails, templates, relational-database

我一直在关注[这个](http://guides.rubyonrails.org/getting_started.html#adding-a-second-model "导轨初学者教程")，在必要时进行修改。

我有 和 的等价`@post`物`@comment`。我的评论是“问题”。我已经尝试过再次遵循这个程序，但只关注评论（而不是帖子）。如果您愿意，可以对评论发表评论，这些是对问题的回答/回复。

我没有成功地让它发挥作用。

```
undefined method 'answers' for nil:NilClass` 
```

是作为评论的一部分呈现的错误，`answers/_form.html.erb`而评论又被呈现为我的等效帖子的一部分。

`<%= form_for([@question, @question.answers.build]) do |f| %>`是引发异常的行。我在想问题是`@question`由于某种原因没有被赋予价值？

那个或我的路线文件不正确（至少我猜是这样）。

```
resources :posts-equivalent do
 ...
 resources :questions
end

resources :questions do
 resources :answers
end 
```

这让我**一整天**都难过- 任何想法都会受到赞赏。如果您想查看更多代码，请发表评论，我会在此处更新。

**附加代码：**

错误信息：

```
Showing .../app/views/answers/_form.html.erb where line      #1 raised:

undefined method `answers' for nil:NilClass
Extracted source (around line #1):

1: <%= form_for([@question, @question.answers.build]) do |f| %> 
```

答案控制器：

```
class AnswersController < ApplicationController
 def create
  @question = Question.find(params[:question_id])
  @answer = @question.answers.create(params[:answer])
  redirect_to concept_path(@question.concept)
 end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:43:30.707

看起来您的 AnswersController 没有为 @question 实例变量赋值。目前尚不清楚您正在运行什么操作，但我假设它是新的或根据您拥有表单的事实进行编辑。在这些操作中你应该有这样的东西：

```
class AnswersController < ApplicationController
  def new
    @question = Question.find(params[:question_id])
    @answer = @question.answers.new
  end

  def edit
    @question = Question.find(params[:question_id])
    @answer = @question.answers.find(params[:id])
  end
end 
```

然后，您可以在 new 和 edit 之间共享一个表单：

```
<%= form_for([@question, @answer]) %> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-07T13:42:12.273

最后，我以不同的方式对此进行了排序。每个问题只会有一个答案，所以我只是给问题一个答案属性并分配它。

在帖子页面上：

```
...
<%= render @questions %>
<%= render "questions/form" %>
... 
```

在 _form.html.erb 中

```
<%= form_for([@concept, @concept.question.build]) do |f| %>
 <%= f.hidden_field :contributor_id, :value => session[:contributor_id] %>
 <div class="field">
  <%= f.text_field :question, :placeholder => "Follow-up Question" %>
 </div>
<% end %> 
```

在 _question.html.erb

```
<%= form_for(question) do |f| %>
 <div id="question">
 "<%= question.question %>" asked by <%= question.contributor.email %> | <%= question.created_at %>. 
<div id="answer">
 - Answer: <%= question.answer %>
 <%= f.text_field :answer, :placeholder => "Respond..." %>
 </div>
 </div>
<% end %> 
```

将此添加到问题控制器：

```
def update
 @question = Question.find(params[:id])
 @question.update_attributes(params[:question])

 @concept = Concept.find(@question.concept.id)
 redirect_to concept_path(@concept)
end 
```

这对我有用，我知道这不是我最初要求的，但它解决了我的问题。感谢那些试图提供帮助的人。

# java - 法语字符没有以正确的格式显示

> ID：14665258
> 
> 赞同：0
> 
> 时间：2013-02-02T18:50:27.997
> 
> 标签：java, jsp, servlets, character-encoding

我在数据库中存储了一些法语内容，但它转换为`?`.

字符串 : `médiévaux, principalement pour l’anglais et le français`, 转换为`médiévaux, principalement pour l??anglais et le français`,

我已将 utf-8 编码应用于 jsp 页面以及 servlet。

```
<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%> 
```

在 servlet 中

```
response.setCharacterEncoding("utf-8"); 
```

我也尝试过解码字符串

```
return (string != null) ? new String(string.getBytes(), UTF8_CHARSET) : null; 
```

然后对其进行编码。

```
return (string != null) ? new String(string.getBytes(UTF8_CHARSET)) : null; 
```

从 JSP 获取并将其设置在 servlet 中的代码

```
response.setCharacterEncoding("utf-8");
String content = request.getParameter("inputFr");
        if(content == null){
            throw new Exception("exception");
        }

        content = new String(string.getBytes(), UTF8_CHARSET); 
```

但仍然出现在上述内容字符串中的问号。很感谢任何形式的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:02:11.147

问题是您在未编码的 URL 中发送参数。要对其进行编码，请使用 `URLEncoder.encode(content, "UTF-8");`. 您可以在 JSP 中将其解码为

```
 <%
    out.println(java.net.URLDecoder.decode(((String[])request.getParameterMap().get("inputFr"))[0], "UTF-8"));
  %> 
```

# scala - 如何将不同的函数fa、fb（不同的签名，包括返回类型）作为同一个参数传递给另一个函数fc？

> ID：14665262
> 
> 赞同：1
> 
> 时间：2013-02-02T18:50:59.197
> 
> 标签：scala

MWE（obs。：我避免每次调用c时都必须实例化一个类，这就是需要函数的原因）：

```
object Main extends  App {
     def a(s:String, i:Int) ={
        s + i * i         //some complex op that yields String
     }

     def b(i:Int) ={
        i / 3             //another complex op that yields Int
     }

     def c(f: Any => Any) = { 
        val L = List(1,2,3,4) //list of complex elements
        L map f               //apply f within some complex loop
     }

     println(c(a))
     /*
        scala: type mismatch;
        found   : (String, Int) => String
        required: Any => Any
        println(c(a))
                  ^
      */

     println(c(b))
     /*
        scala: type mismatch;
        found   : Int => Int
        required: Any => Any
        println(c(b))
                  ^
     */
} 
```

也许一个等效的问题是“是否有某种函数继承？”，比如

```
def f
def fa(i: Int):String extends f
def fb(s: String):Int extends f 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:08:20.207

您尝试做的不是类型安全的，因为如果是，您可以将 a 传递`String`给带有`Int`参数的函数：

例如

```
def c(f: Any => Any) = { 
    val L = List("a", "b", "c")
    L map f
}

c(a) 
```

但是，您可以使用 type 的函数`Int => Any`，因为将更派生的类型分配给 是安全的`Any`。

```
def c(f: Int => Any) = {
    val l = List(1,2,3,4)
    l.map(f)
} 
```

现在是安全的：

```
val bList: List[Any] = c(b) 
```

但是，您仍然无法传递`a`给`c`，因为它需要两个参数而不是一个。您可以部分应用第一个`String`参数并传递：

```
val cList = c(a("SomeString", _:Int)) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:27:48.080

如果您发现自己在使用`Any`,

1.  你可能做错了什么，并且
2.  你很可能需要泛型。

在你的情况下

```
def c[X,Y](f: X => Y) = { ... } 
```

可能会成功，具体取决于您在该复杂循环中的内容。

# javascript - 通过javascript将点击事件绑定到对象标签内的文档

> ID：14665264
> 
> 赞同：2
> 
> 时间：2013-02-02T18:51:17.797
> 
> 标签：javascript, jquery, object, tags, click

> **可能重复：**
> [JQuery + SVG 对象：正确捕获点击事件](https://stackoverflow.com/questions/13237995/jquery-svg-object-capture-click-event-properly)

假设有一个这样的html

```
<html>
<body>
<object data="data:image/svg+xml;utf8,<svg ....>...</svg>"></object>
...
<script src="jquery.js"></script>
<script>
    $(document).on('click', function(e){
        console.log("clicked");
    });
</script>
</body>
</html> 
```

除了加载的 svg 图像之外，click 事件在任何地方都有效。也可以将单击事件绑定到此图像。谢谢你。

# python - win7下Django使用postgresql？

> ID：14665266
> 
> 赞同：1
> 
> 时间：2013-02-02T18:51:32.890
> 
> 标签：python, django, configuration, psycopg2

我目前正在玩 django 并想用作我的数据库 postgresql：

![在此处输入图像描述](../Images/6013f1ff428b88a8053992d688454b0c.png)

这些是我在设置文件中的配置：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql', # Add 'postgresql_psycopg2', 'postgresql', 'mysql', 'sqlite3' or 'oracle'.
        'NAME': 'django',                      # Or path to database file if using sqlite3.
        'USER': 'postgres',                      # Not used with sqlite3.
        'PASSWORD': 'postgres',                  # Not used with sqlite3.
        'HOST': '',                      # Set to empty string for localhost. Not used with sqlite3.
        'PORT': '5432',                      # Set to empty string for default. Not used with sqlite3.
    }
} 
```

我还尝试使用 postgresql_psycopg2 并安装了 psycopg2（[http://www.stickpeople.com/projects/python/win-psycopg/](http://www.stickpeople.com/projects/python/win-psycopg/)）。

任何想法配置有什么问题？

**更新：**

错误：

```
>   File
> "C:\Python27\lib\site-packages\django\core\management\__init__.py",
> line 382, in execute
>     self.fetch_command(subcommand).run_from_argv(self.argv)   File "C:\Python27\lib\site-packages\django\core\management\base.py", line
> 196, in run_from_argv
>     self.execute(*args, **options.__dict__)   File "C:\Python27\lib\site-packages\django\core\management\base.py", line
> 232, in execute
>     output = self.handle(*args, **options)   File "C:\Python27\lib\site-packages\django\core\management\base.py", line
> 371, in handle
>     return self.handle_noargs(**options)   File "C:\Python27\lib\site-packages\django\core\management\commands\syncdb.py",
> line 57, in handle_noargs
>     cursor = connection.cursor()   File "C:\Python27\lib\site-packages\django\db\backends\dummy\base.py", line
> 15, in complain
>     raise ImproperlyConfigured("settings.DATABASES is improperly configured. " django.core.exceptions.ImproperlyConfigured:
> settings.DATABASES is improperly configured. Please supply the ENGINE
> value. Check settings documentation for more details. 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-02-15T13:34:00.410

这是一个老问题，但我正在为未来的访客添加一个答案。您似乎有几个错误：

1.  如果您已经安装了 psycopg2，则应将`ENGINE`名称更改为`django.db.backends.postgresql_psycopg2`.

2.  在您的设置中，您将数据库指定`NAME`为`django`，但在您的 pgAdmin 屏幕截图中可以看出您没有这样的数据库。创建一个`django`使用 pgAdmin 命名的数据库。

正确的设置将是：

```
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.postgresql_psycopg2',
        'NAME': 'django',
        'USER': 'postgres',
        'PASSWORD': 'postgres',
        'HOST': '127.0.0.1',
        'PORT': '5432',
    }
} 
```

# unix - nginx 代理和主干推送状态

> ID：14665267
> 
> 赞同：1
> 
> 时间：2013-02-02T18:51:41.877
> 
> 标签：unix, nginx

我正在尝试设置 nginx 以与我的骨干网应用程序和 api 服务器一起使用。

API 服务器是外部的，并通过[https://website.com/api/](https://website.com/api/)路由...

本质上，我希望将任何不匹配的 url 路由到 /index.html 以供骨干应用程序处理。

我试过使用`try_files`，但这只是覆盖了我的 API。我尝试设置另一个位置，在该位置检查请求是否为 GET 以及是否不匹配`register`or `login`or `api`，但这也不起作用。这是我`server`到目前为止：

```
server {
    listen 80; ssl off;
    listen  443 ssl;
    server_name app.io;
    ssl_certificate /etc/nginx/conf/ssl.crt;
    ssl_certificate_key /etc/nginx/conf/app.key;

    root /home/ubuntu/app/public;

    access_log /var/log/nginx/app.access.log;
    error_log /var/log/nginx/app.error.log;

    index index.html;

    location / {
                    if ($scheme = "http") {
                            rewrite ^ https://$http_host$request_uri? permanent;
                    }
            }

    location ~ ^/(api)|(auth).*$ {
        proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-Server $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; 
        proxy_pass https://app.aws.af.cm;
    }

    location ~ ^(/(register)|(login)).*$ {
        proxy_set_header X-Forwarded-Host $host;
                    proxy_set_header X-Forwarded-Server $host;
                    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        # GETs only
        limit_except POST {
            proxy_pass https://app.aws.af.cm;
        }
    }

    location ~* \.(?:ico|css|js|gif|jpe?g|png)$ {
        expires max;
        add_header Cache-Control "public, must-revalidate, proxy-revalidate";
    }

} 
```

目前，try_files 覆盖 API 并仅重定向到 index.html。知道我怎样才能让所有东西都能很好地相互配合吗？

这就是我想要的：

```
if / - /index.html
else if /api/*|/auth/* - external proxy
else if /login|/register - POST - external proxy
else /* - /#$1 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:08:04.370

弄清楚了：

添加`try_files @uri @rewrites;`并`Location /`添加以下`@rewrites`功能。

```
server {
    listen 80; ssl off;
    listen  443 ssl;
    server_name app.io;
    ssl_certificate /opt/nginx/conf/ssl.crt;
    ssl_certificate_key /opt/nginx/conf/app.key;

    root /home/ubuntu/app/public;

    access_log /var/log/nginx/app.access.log;
    error_log /var/log/nginx/app.error.log;

    index index.html;

    location / {
                    if ($scheme = "http") {
                            rewrite ^ https://$http_host$request_uri? permanent;
                    }

                               try_files $uri @rewrites;
            }

    location ~ ^/(api)|(auth)|(logout)|(register)|(login).*$ {
        proxy_set_header X-Forwarded-Host $host;
            proxy_set_header X-Forwarded-Server $host;
            proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; 
        proxy_pass https://app.cm;
    }

    location ~* \.(?:ico|css|js|gif|jpe?g|png)$ {
        expires max;
        add_header Cache-Control "public, must-revalidate, proxy-revalidate";
    }

    location @rewrites {
            rewrite ^/.+ /#$uri redirect;
    }

} 
```

# haskell - 地图 。foldr 函数组合 - Haskell

> ID：14665268
> 
> 赞同：5
> 
> 时间：2013-02-02T18:52:30.297
> 
> 标签：haskell, map, fold, function-composition

所以，让我们直奔主题。

```
:t (map.foldr)
(map.foldr) :: (a1 -> a -> a) -> [a] -> [[a1] -> a] 
```

什么是 [[a1] -> a]？我真的很想理解这个组合，所以我这样做了：

```
-- map.foldr

    map.foldr :: (a1 -> a -> a) -> [a] -> [[a1] -> a]

    map :: (a1 -> b1) -> [a1] -> [b1]
    (.) :: (y -> w) -> (x -> y) -> x -> w
    foldr :: (a -> b -> b) -> b -> [a] -> b

    y = (a1 -> b1)      w = ([a1] -> [b1])
    x = (a -> b -> b)   y = (b -> [a] -> b)

    y = (a1 -> b1)  
    y = (b -> [a] -> b)
_________________________ 
```

在这一点上会发生什么？谢谢！

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2013-02-02T21:26:17.573

要回答这个问题，最好回忆一下做什么`foldr`和`map`做什么。

两者中比较复杂的是`foldr`, 有类型

```
--              list to be folded
--                              v
foldr :: (a -> b -> b) -> b -> [a] -> b
--             ^          ^
--folding function        terminal value 
```

要折叠的列表实际上是一个 conses 链`(:)`和一个终端空列表：

```
1 : 2 : 3 : [] 
```

的作用`foldr`是将`:`和`[]`构造函数分别替换为折叠函数和终止值：

```
foldr (+) 0 (1 : 2 : 3 : []) == 1 + 2 + 3 + 0 
```

* * *

`map`功能更简单。一种思考方式是获取一个函数和一个列表，并将该函数应用于列表的每个参数：

```
map :: (a -> b) -> [a] -> [b]
--        ^         ^
-- function         list 
```

但是，您也可以将其视为一个函数，并将其提升为一个作用于列表的函数：

```
map :: (a -> b) -> ( [a] -> [b] )
--        ^              ^
-- function              function on lists 
```

* * *

组合这两个函数是什么意思`map . foldr`？请注意，这只是一个接一个地应用功能 - 特别是，

```
(map . foldr) f == map (foldr f) 
```

由于您`foldr`首先应用，因此您必须将其应用到一个函数`f :: a -> b -> b`，然后您将返回另一个函数：

```
foldr f :: b -> [a] -> b
--         ^     ^
--terminal val   list to be folded 
```

现在你 apply `map`，它提升了作用于列表的功能：

```
map (foldr f) :: [b] -> [[a] -> b]
--                ^          ^
--list of terminal vals      functions that fold lists 
```

这种类型看起来很奇怪，但它是有效的。现在不是单个终端值，而是给它一个终端值列表，然后返回一个折叠函数列表 - 一个用于您提供的每个终端值。

* * *

为了更清楚，我们可以查看一个特定的函数`(+)`，它具有类型

```
(+) :: Num a => a -> a -> a 
```

如果我们把它代入上面的等式，我们得到

```
(map . foldr) (+) :: Num a => [a] -> [[a] -> a]
--                             ^          ^
--         list of terminal vals          functions that fold lists 
```

如果我们现在将它应用到列表中`[0, 1, 2]`，我们会得到一个包含三个函数的列表：

```
(map . foldr) (+) [0,1,2] :: Num a => [[a] -> a] 
```

我们可以使用`map ($x)`成语将列表中的每个函数应用于特定参数。它必须是一个数字列表，我会选择`[3,4,5]`. 仔细观察：

```
> map ($[3,4,5]) ((map.foldr) (+) [0,1,2])
[12, 13, 14] 
```

该列表`[3,4,5]`被用作折叠函数折叠了三次`(+)`，每次都使用不同的终端值：

```
3 + 4 + 5 + 0 == 12
3 + 4 + 5 + 1 == 13
3 + 4 + 5 + 2 == 14 
```

当终端值为 时`0`，我们只需得到值的总和：`3 + 4 + 5 == 12`。当终值是`1`我们得到的值比总和多 1`13`时，当终值是我们得到的值`2`比总和多 2`14`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:51:25.827

要从上次中断的地方继续， 的两个定义`y`必须相等：

```
y = (a1 -> b1) = (b ->  [a] -> b)
               = (b -> ([a] -> b)) 
```

所以我们可以得出结论：

```
a1 = b
b1 = [a] -> b 
```

函数组合提供了两个函数参数，因此结果类型为：

```
x -> w 
```

但我们知道：

```
x = a -> b -> b
w = [a1] -> [b1] = [b] -> [[a] -> b] 
```

所以，结果类型是：

```
(x -> w) = ((a -> b -> b) -> ([b] -> [[a] -> b]))
         =  (a -> b -> b) ->  [b] -> [[a] -> b] 
```

这与：

```
(a1 -> a -> a) -> [a] -> [[a1] -> a] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:31:14.647

```
map.foldr :: (a1 -> a -> a) -> [a] -> [[a1] -> a]

map :: (a1 -> b1) -> [a1] -> [b1]
(.) :: (y -> w) -> (x -> y) -> x -> w
foldr :: (a -> b -> b) -> b -> [a] -> b

-- if you substitute: x = (a -> b -> b)   y = (b -> [a] -> b)
-- then you get for map :: (b -> ([a] -> b)) -> [b] -> [[a] -> b]
-- so if composition operator applied:
map . foldr :: (a -> b -> b) -> [b] -> [[a] -> b] 
```

# ruby-on-rails - 保存失败后Rails不回滚事务（）

> ID：14665269
> 
> 赞同：4
> 
> 时间：2013-02-02T18:52:30.580
> 
> 标签：ruby-on-rails, ruby, postgresql, rspec, transactions

我有这个域模型：用户有一组项目，项目的状态可能无法通过验证。

验证工作正常，我什至看到在我使用`save!`.

在我的控制器中，我有这个：

```
@user.items() << item

if @user.save
  render :json => {}, :status => :ok
else
  render :json => {:status => :error, :errors => item.errors}, :status => :bad_request
end 
```

第一个 POST 成功，第二个 POST 失败，但是当我点击索引时，我仍然看到两个对象，好像第二个事务从未回滚。到底是怎么回事？

我的测试是这样的：

```
 post :create
  post :create
  get :index
  ActiveSupport::JSON.decode(response.body).length.should == 1 
```

编辑：即使在运行服务器时，事务也不会回滚（sqlite3）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T17:17:24.563

将项目添加到集合中会立即保存它（除非用户未保存）。调用 save 创建自己的事务，这就是回滚的内容，而不是保存项目的事务

您可以通过显式创建一个事务来强制所有内容进入同一个事务。

```
begin
  User.transaction do
    @user.items << item
    @user.save!
    render :json => {}, :status => :ok
  end
rescue ActiveRecord::RecordInvalid
  render :json => {:status => :error, :errors => item.errors}, :status => :bad_request
end 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T19:07:34.343

听起来您在测试中遇到了嵌套事务问题。

我不相信 Postgres 的 Ruby 驱动程序处理嵌套事务，因此您只能获得外部事务的范围。如果您启用了事务性固定装置，则会有一个外部事务包装您的测试执行。这意味着如果您的被测控制器创建第二个内部事务并尝试回滚它 - 您可能无法获得正确的行为。

您可以通过关闭 rspec 中的事务来确认事务干扰：

```
RSpec.configure do |config|
  config.use_transactional_fixtures = false
end 
```

# javascript - Javascript计算功能不起作用

> ID：14665273
> 
> 赞同：1
> 
> 时间：2013-02-02T18:52:50.643
> 
> 标签：javascript, function, jsfiddle

这是一个[JS Fiddle](http://jsfiddle.net/m54Du/)。剧本不言自明。我只想指出它不起作用。请看一下并告诉我该怎么做。提前致谢。我遵循了我认为是 javascript 编程中的每条规则，但不知何故，我一定忽略了一些东西。我还制作了一个实际的工作版本，即 PHP 脚本。工作中的 PHP 是本文中的第二个脚本：[PHP split string at last number, insert a extra string and merge the new string](https://stackoverflow.com/questions/14463110/php-split-string-at-last-number-insert-an-extra-string-and-merge-the-new-string)。

```
function calTime(x) {

if (x === '') {
    x = 54098;
} // Time in seconds
var f = 31536000, // seconds in a year
    d = 86400, // seconds in a day
    h = 3600, // seconds in an hour
    m = 60, // seconds in a minute
    xa,
    xb,
    xc,
    xe,
    xq,
    string,
    lb_y = 'year',
    lb_ys = 'years',
    lb_d = 'day',
    lb_ds = 'days',
    lb_h = 'hour',
    lb_hs = 'hours',
    lb_m = 'minute',
    lb_ms = 'minutes',
    lb_s = 'second',
    lb_ss = 'seconds',
    lb_and = 'and';

// a = years
var a = x / f;

// To prevent complications using scientific numbers less than 0 ex 7.2341232E-23
var a1 = a.indexOf("E-");
if (a1) {
    a = 0;
}

// Split a so we only get the numbers before '.'
var a2 = a.indexOf(".");
if (a2) {
    Math.floor(a);
}

// if $a is less or equal to 0 - it is 0
if (a <= 0) {
    a = 0;
}

// b = days
var b = (x - (f * a)) / d;

// To prevent complications using scientific numbers less than 0 ex 7.2341232E-23
var b1 = b.indexOf("E-");
if (b1) {
    b = 0;
}

// Split b so we only get the numbers before '.'
var b2 = b.indexOf(".");
if (b2) {
    Math.floor(b);
}

// if $b is less or equal to 0 - it is 0
if (b <= 0) {
    b = 0;
}

// c = hours
var c = (x - (f * a) - (d * b)) / h;

// To prevent complications using scientific numbers less than 0 ex 7.2341232E-23
var c1 = c.indexOf("E-");
if (c1) {
    c = 0;
}

// Split c so we only get the numbers before '.'
var c2 = c.indexOf(".");
if (c2) {
    Math.floor(c);
}

// if $c is less or equal to 0 - it is 0
if (c <= 0) {
    c = 0;
}

// e = minutes
var e = (x - (f * a) - (d * b) - (h * c)) / m;

// Split $e so we only get the numbers before '.'
var e2 = e.indexOf(".");
if (e2) {
    Math.floor(e);
}

// if $e is less or equal to 0 - it is 0
if (e <= 0) {
    e = 0;
}

// $q = seconds
var q = (x - (f * a) - (d * b) - (h * c) - (m * e));

// Rewrite numbers if below 9
if (a <= 9) {
    xa = '0' + a;
} else {
    xa = a;
}
if (b <= 9) {
    xb = '0' + b;
} else {
    xb = b;
}
if (c <= 9) {
    xc = '0' + c;
} else {
    xc = c;
}
if (e <= 9) {
    xe = '0' + e;
} else {
    xe = e;
}
if (q <= 9) {
    xq = '0' + q;
} else {
    xq = q;
}

// Rewrite labels
if (a <= 1) {
    lb_ys = lb_y;
}
if (b <= 1) {
    lb_ds = lb_d;
}
if (c <= 1) {
    lb_hs = lb_h;
}
if (e <= 1) {
    lb_ms = lb_m;
}
if (q <= 1) {
    lb_ss = lb_s;
}

// if == 0 - do not show
if (a === 0) {
    a = '';
} else {
    a = a + ' ' + lb_ys;
}
if (b === 0) {
    b = '';
} else {
    b = b + ' ' + lb_ds;
}
if (c === 0) {
    c = '';
} else {
    c = c + ' ' + lb_hs;
}
if (e === 0) {
    e = '';
} else {
    e = e + ' ' + lb_ms;
}
if (q === 0) {
    q = '';
} else {
    q = q + ' ' + lb_ss;
}

var time = [a, b, c, e, q];

time = time.filter(Number);

var count = time.count();
var last = time[time.length - 1];

if (count == 1) {
    string = last;
} else if (count === 0) {
    string = '<i>No Time described</i>';
} else {
    string = time.join(', ') + ' ' + lb_and + ' ' + last;
}

return string;
}

document.getElementById("demo").innerHTML = calTime(83200); 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:17:20.297

我将尝试在一处找出脚本在技术上存在的所有问题。

1.  **时间计算不正确**

    一天有 86400 秒，一年有 365 天有 31536000 秒。如果他们不想担心价值观，你通常会看到人们做这样的事情：

    ```
    var minutes = 60;
    var hours = 60 * 60;
    var days = 24 * 60 * 60;
    var years = 365 * 24 * 60 * 60; 
    ```

2.  **使用`indexOf()`不支持该方法的对象（在本例中为数字）。**

    其他人在评论和答案中指出了这一点，但基本上，如果您要在它们上调用字符串方法，请将您的数字转换为字符串：

    ```
    num = num + "";
    numIndex = (num + "").indexOf("foo"); 
    ```

3.  **没有正确检查返回值`indexOf()`**

    `indexOf()`返回字符串开始位置的索引（从 0 开始）。如果未找到该字符串，则返回 -1。在多个位置，您正在执行以下操作：

    ```
    var a2 = a.indexOf("E-");
    if (a2) {
      a = 0;
    } 
    ```

    在这种情况下，如果 a2 与科学记数法不匹配，则 a2 将为 -1。唯一考虑的整数值`false`是 0。因此，-1 值始终被认为是 true，并且您始终将年、日和小时设置为 0，无论它们是否采用科学记数法格式。

4.  **不考虑科学记数法格式的大小写**

    在我的浏览器中，非常小，接近于零的值如下所示：

    ```
    7.888609052210118e-31 
    ```

    您的搜索与此值不匹配。考虑到您的逻辑，这甚至可能无关紧要。有什么理由不总是使用`Math.floor()`吗？您的 JS 浮点问题无论以何种方式切片都将是一个问题。

5.  **不使用 Math.floor() 的返回值**

    在多个位置，您可以执行以下操作：

    ```
    Math.floor(a); 
    ```

    然后你继续假设它`a`已经假设了它的底值。您需要执行以下操作才能做到这一点：

    ```
    a = Math.floor(a); 
    ```

6.  **将所有时间组件设置为字符串，然后通过`Number`**

    您在时间数组中显式存储字符串格式（例如 23 小时 6 分钟），但随后您将时间数组过滤为`Number`. 我认为您正在尝试过滤掉空白字符串，这是您将时间值设置为 0 时的值。传递一个函数`filter()`来过滤掉这些空白条目，如下所示：

    ```
    time.filter(function(x) { return x === "" ? false : true; }); 
    ```

7.  **`count()`不是一种方法`Array`**

    您可能正在寻找`length`，您实际上在下面正确使用了它。

8.  **您将整个时间数组连接在一起，然后再次添加数组中的最后一项**

    我会让你解决这个问题。您不想复制最后一项，并且您可能还想处理时间平均分为一个类别的情况

这些是您的脚本的技术问题。另一个完整的答案可以写成更优雅的方式来完成你想要做的事情。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:58:47.680

为了补充已经给出的答案，您的代码的主要样式问题是有很多不必要的重复，您可以使用循环和/或函数来摆脱这些重复。

话虽如此，数学可以大大简化，似乎不需要所有搜索“E”或“.”的东西，在这种情况下，可能不值得使用循环；在下面的建议中，我只使用循环来添加标签。另一个提示是尽可能使用描述性变量名称（`hours`, `minutes`，而不是`a`, `b`），以使您的代码更具可读性。

[http://jsfiddle.net/m54Du/16/](http://jsfiddle.net/m54Du/16/)

```
function calTime(seconds) {
    if (seconds === '') {
        seconds = 54098;
    } // Time in seconds
    seconds = Math.floor(seconds);
    if (isNaN(seconds) || seconds <= 0) {
        return '<i>No time described</i>';
    }
    var minutes = Math.floor(seconds / 60), 
        hours = Math.floor(minutes / 60),
        days = Math.floor(hours / 24), 
        years = Math.floor(days / 365), // assuming not leap!
        timeData = [years, days % 365, hours % 24, minutes % 60, seconds % 60],
        pluralLabels = ['years', 'days', 'hours', 'minutes' , 'seconds'],
        singularLabels = ['year', 'day', 'hour', 'minute', 'second'],
        time = [];
    for (var i = 0; i < timeData.length; i++) {
        if (timeData[i] > 1) {
            time.push(timeData[i] + ' ' + pluralLabels[i]);
        }
        else if (timeData[i] > 0) {
            time.push(timeData[i] + ' ' + singularLabels[i]);
        }
    }
    var last = time.pop();
    return time.length ? time.join(', ') + ' and ' + last : last;
}
document.getElementById("demo").innerHTML = calTime(83200); 
```

[这是一种](http://jsfiddle.net/m54Du/18/)更多地使用循环来进行数学运算的替代方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:03:04.910

您的变量 a、b 等是数字。indexOf 是 JavaScript 中字符串的一种方法。

解决此问题的一种方法是将您的数字转换为字符串，例如：

```
a = a + ""; 
```

它消除了 indexOf() 错误。

对于其余的错误，我认为您也在滥用功能。例如，您使用 count() 方法，该方法在 JavaScript 中似乎不存在。

# python - Py2neo - 正确使用“set_node_property”

> ID：14665274
> 
> 赞同：1
> 
> 时间：2013-02-02T18:52:50.947
> 
> 标签：python, py2neo

我正在尝试使用 py2neo 在索引列表中的特定节点上设置新属性。这个想法是列表中的第一个节点将获得一个新属性。属性值将是静态的，以便将来查找所有相关节点。在下面的示例中，“nodez”列表将发生变化，但第一项始终需要新属性和静态值。

```
from py2neo import neo4j, cypher
graph_db = neo4j.GraphDatabaseService("http://localhost:7474/db/data/")

nodez = ['test1', 'test2', 'test3']
mytestindex = graph_db.get_or_create_index(neo4j.Node, "name")
nodes2 = []
for word in nodez:
    nodes2.append(mytestindex.get_or_create("name", word, {"name": word}))
a = nodes2[0]
newpropkey = "new_property"
newpropvalue = "static_value"
set_node_property(a, newpropkey, newpropvalue) 
```

所以如果下次运行这个程序并且 nodez = ['test4', 'test5', 'test6']，那么 'test1' 和 'test4' 都将包含新的属性值。例如，以下密码查询将返回索引“name”中“test1”和“test4”的节点。谢谢你的帮助！

```
START a = node:name(new_property="static_value") 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T09:36:20.593

`set_node_property`仅适用于批处理操作。在这种情况下，您只需要使用：

```
a[newpropkey] = newpropvalue 
```

# ruby-on-rails - 加载该会话的力如何？

> ID：14665275
> 
> 赞同：19
> 
> 时间：2013-02-02T18:53:07.183
> 
> 标签：ruby-on-rails, ruby-on-rails-3, session, ruby-on-rails-3.2

我正在开发一个需要使用会话 ID 信息的应用程序。我的会话存储在 cookie 中。我遇到的问题是，当用户第一次访问该站点时，控制器无法立即使用我的会话。我想我可能遗漏了一些关于如何在 Rails 中初始化会话的信息。但我对会话未加载这一事实持肯定态度，因为这是以下内容的输出`session.inspect`：

```
#<Rack::Session::Abstract::SessionHash:0x15cb970 not yet loaded> 
```

`Rails 3.2.11`以下是使用and重现问题的方法`ruby 1.9.3`：

`test`使用控制器创建一个新应用程序：

```
rails new my_app
cd my_app/
rails g controller test
rm app/assets/javascripts/test.js.coffee
touch app/views/test/index.html.erb 
```

尝试在该控制器中获取会话 ID：

```
class TestController < ApplicationController
  def index
    puts session[:session_id]
    puts session.inspect
  end
end 
```

添加所需的路线：

```
MyApp::Application.routes.draw do
  resources :test
end 
```

然后访问应用程序并查看它的作用：

```
rails server 
```

必须：`http://localhost:3000/test`

这是控制台中的输出：

```
#<Rack::Session::Abstract::SessionHash:0x3fd10f50eea0 not yet loaded> 
```

然后又一次`http://localhost:3000/test`，这次我们有一个会话：

```
400706c0b3d95a5a1e56521e455075ac
{"session_id"=>"400706c0b3d95a5a1e56521e455075ac", "_csrf_token"=>"Euaign8Ptpj/o/8/ucBFMgxGtiH7goKxkxeGctumyGQ="} 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-02-04T09:53:02.947

我找到了一种强制初始化会话的方法。访问会话显然不会强制初始化，但写入会话会。我现在在控制器中所做的是：

```
class MyController < ApplicationController
  protect_from_forgery
  def index
    session["init"] = true
    do_stuff
  end
end 
```

我仍然不确定这是否应该被视为 Rails 中的正常行为。在我看来，必须写入会话来强制初始化是不对的。读书应该够了。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2015-01-22T10:29:23.080

我同意@joscas 的回答，但我不会写一个值，而是将其删除，以免有冗余数据。

```
class MyController < ApplicationController
  protect_from_forgery
  def index
    session.delete 'init'
    do_stuff
  end
end 
```

会话也以这种方式加载。

**注意：**确保您没有在应用程序中使用要删除的密钥。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2013-02-02T20:24:54.773

[以下是ActionDispatch::Session](https://github.com/rails/rails/blob/master/actionpack/lib/action_dispatch/request/session.rb)的一些相关代码：

```
 def [](key)
    load_for_read!
    @delegate[key.to_s]
  end

  private

  def load_for_read!
    load! if !loaded? && exists?
  end 
```

这意味着一旦您通过它的键访问任何值，会话对象就会被加载`[]`。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T19:47:48.460

我真的不明白你的问题。如果您需要用户注册或登录才能访问该站点，则应该没有问题。创建用户时，他的信息会立即存储在 cookie 中。例如：

用户控制器：（通过 users#new 完成注册）

```
def create
   @user = User.new(params[:user])
   if @user.save
     cookies.permanent[:remember_token] = user.remember_token
     redirect_to root_path, notice: "Thank you for registering!"
   else
     render :new
   end
 end 
```

会话控制器：（通过会话#new 完成登录）

```
 def create
  user = User.find_by_email(params[:session][:email].downcase)

  if user && user.authenticate(params[:session][:password])
    cookies.permanent[:remember_token] = user.remember_token
    redirect_to root_path, notice: "Logged in."
  else
    flash.now.alert = "Email or password is incorrect."
    render :new
 end
end 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-05-18T08:11:07.200

因此，问题可能归结为存储 session_id 的 cookie 在您尝试访问会话时尚未创建。

当您读取会话对象时，Rails 会调用一个私有方法`session.load_for_read!`，但顾名思义，它只加载会话以进行读取，如果会话根本不存在，则不会实例化它。

另一方面，调用`session.merge!({})`（例如）强制会话实例化。

# ios - 如何从大小约为 2mb 的 csv 文件创建 NSString？

> ID：14665278
> 
> 赞同：0
> 
> 时间：2013-02-02T18:53:21.927
> 
> 标签：ios, objective-c

我在应用程序包中有一个大约 2.2 mb 数据的 csv 文件。我正在尝试将此 csv 文件的内容存储在一个`NSString`变量中。用于此的代码是：

```
 NSString *strBundle = [[NSBundle mainBundle] pathForResource:@"large" ofType:@"csv"];
   NSError *error = nil;
   NSString *dataStr = [NSString stringWithContentsOfFile:strBundle
                                                  encoding:NSUTF8StringEncoding
                                                     error:&error]; 
```

但是，上面的代码不会将文件的文本存储在 dataStr 变量中。相反，我收到以下错误消息：

> 错误=错误域=NSCocoaErrorDomain 代码=261“操作无法完成。（Cocoa 错误 261。）”UserInfo=0x1fdab580 {NSFilePath=/var/mobile/Applications/0C68E393-FBBE-45F6-819E-336D31C78043/DemoApp。 app/large.csv, NSStringEncoding=4}

如果我删除了文件的内容，使文件相对小于 2.2 mb，则上面的代码可以正常工作并获取 dataStr 变量中的字符串值。有人可以告诉我为什么会这样。可以存储在`NSString`变量中的数据量是否有任何限制。那么如何存储CSV文件的数据呢？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T19:12:33.363

NSCocoaErrorDomain 代码=261 是：NSFileReadInapplicableStringEncodingError。

读取错误，因为字符串编码不适用。`NSStringEncodingErrorKey`使用密钥从 userInfo 字典中访问错误编码。

这将表明该文件不是`NSUTF8StringEncoding`.

您可以使用： `- (id)initWithContentsOfFile:(NSString *)path usedEncoding:(NSStringEncoding *)enc error:(NSError **)error`

它将返回编码或错误。

> 通过从路径命名的文件中读取数据来初始化的 NSString 对象。返回的对象可能与原始接收者不同。如果文件无法打开或存在编码错误，则返回 nil。

[苹果文档](https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Miscellaneous/Foundation_Constants/Reference/reference.html)

# forms - Grails 自定义验证场景

> ID：14665279
> 
> 赞同：0
> 
> 时间：2013-02-02T18:53:42.473
> 
> 标签：forms, validation, grails

我刚开始研究 grails，我以前主要使用 PHP，所以我的问题是向表单添加自定义验证场景的最佳方式是什么。因此，假设我们在域中拥有所有约束，但是在某个控制器操作下，表单绑定到域，我们想要添加某种额外的自定义验证（为了参数，假设我们有一个日期，并且仅在这种情况应该在未来 2 周以上）。这样做的最佳方法是什么？

谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T21:54:31.707

根据您的要求，您可以使用带有约束的[命令对象：](http://grails.org/doc/latest/guide/single.html#commandObjects)

```
@grails.validation.Validateable
class CommandObject {
    Date date

    static constraints = {
        date(/*constraint here*/)

    }
} 
```

**编辑：**

关于第二个问题，是的，您可以使用 将域对象的约束共享到命令对象`importFrom [EntityName]`，请参见文档中的示例：

**域对象：**

```
class User {
    String firstName
    String lastName
    String passwordHash
    static constraints = {
        firstName blank: false, nullable: false
        lastName blank: false, nullable: false
        passwordHash blank: false, nullable: false
    }
} 
```

**命令对象：**

```
class UserCommand {
    String firstName
    String lastName
    String password
    String confirmPassword   
    static constraints = {
        importFrom User
        password blank: false, nullable: false
        confirmPassword blank: false, nullable: false
    }
} 
```

[共享约束](http://grails.org/doc/latest/ref/Constraints/Usage.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T11:33:47.850

我建议您在表单到达控制器之前使用 jquery 进行表单验证。如果需要，您还可以对 gsp 本身进行单独验证（例如，检查输入字段是否是必需的、仅接受电子邮件、仅接受整数等）。您甚至可以在控制器上执行此操作。但我认为使用 jquery 进行表单验证已经足够了 :)

# jquery - 淡入淡出页面过渡

> ID：14665285
> 
> 赞同：0
> 
> 时间：2013-02-02T18:54:04.000
> 
> 标签：jquery, ajax, wordpress, transition

我正在寻找一种类似于以下 URL 的淡入淡出页面的方法，同时将每个页面保持为单独的页面。我尝试使用 jQuery 来完成此操作，但在页面加载时的转换之间会出现时间间隔。有谁知道在保持页面分离的同时实现这一点的任何方法。我的网站在 Wordpress 中。

[http://spring.tnvacation.com/#!/winning](http://spring.tnvacation.com/#!/winning)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-02-02T18:58:36.070

您需要查看历史 API 以动态更改浏览器历史记录并使用 Ajax 加载内容。[Davis.js](http://davisjs.com/)将是一个好的开始。

# javascript - 在使用 XMLSerializer() 序列化之前从 XML 中删除无效字符

> ID：14665288
> 
> 赞同：6
> 
> 时间：2013-02-02T18:54:12.907
> 
> 标签：javascript, xml, xmlserializer, well-formed

我正在尝试将用户输入存储在客户端（javascript）的 XML 文档中，并将其传输到服务器以进行持久性。

例如，一位用户粘贴了包含 STX 字符 (0x2) 的文本。XMLSerializer 没有转义 STX 字符，因此没有序列化为格式良好的 XML。或者也许 .attr() 调用应该已经转义了 STX 字符，但是在任何一种情况下，都会产生无效的 XML。

我发现浏览器内 XMLSerializer() 的输出并不总是格式正确，（甚至不满足浏览器自己的 DOMParser()

此示例显示 XMLSerializer() 未正确编码 STX 字符：

```
> doc = $.parseXML('<?xml version="1.0" encoding="utf-8" ?>\n<elem></elem>');
    #document
> $(doc).find("elem").attr("someattr", String.fromCharCode(0x2));
    [ <elem someattr=​"">​&lt;/elem>​ ]
> serializedDoc = new XMLSerializer().serializeToString(doc);
    "<?xml version="1.0" encoding="utf-8"?><elem someattr=""/></elem>"
> $.parseXML(serializedDoc);
    Error: Invalid XML: <?xml version="1.0" encoding="utf-8"?><elem someattr=""/></elem> 
```

我应该如何在浏览器中构造一个 XML 文档（参数由任意用户输入确定），以便它始终格式正确（所有内容都正确转义）？我不需要支持 IE8 或 IE7。

（是的，我确实在服务器端验证了 XML，但是如果浏览器将一个格式不正确的文档交给服务器，那么服务器可以做的最好的事情就是拒绝它，这对可怜的用户没有多大帮助)

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-10T19:40:04.847

这里有一个函数*sanitizeStringForXML()*可以用来在赋值之前清理字符串，或者一个派生函数*removeInvalidCharacters(xmlNode)*可以传递一个 DOM 树并自动清理属性和 textNode 以便安全存储。

```
var stringWithSTX = "Bad" + String.fromCharCode(2) + "News";
var xmlNode = $("<myelem/>").attr("badattr", stringWithSTX);

var serializer = new XMLSerializer();
var invalidXML = serializer.serializeToString(xmlNode);

// Now cleanse it:
removeInvalidCharacters(xmlNode);
var validXML = serializer.serializeToString(xmlNode); 
```

我基于此[维基百科文章的非限制字符部分的](http://en.wikipedia.org/wiki/Valid_characters_in_XML)字符列表，但补充平面需要 5 位十六进制数字 unicode 字符，并且 Javascript 正则表达式不包含此语法，所以现在，我'我只是把它们剥离出来（你并没有错过太多......）：

```
// WARNING: too painful to include supplementary planes, these characters (0x10000 and higher) 
// will be stripped by this function. See what you are missing (heiroglyphics, emoji, etc) at:
// http://en.wikipedia.org/wiki/Plane_(Unicode)#Supplementary_Multilingual_Plane
var NOT_SAFE_IN_XML_1_0 = /[^\x09\x0A\x0D\x20-\xFF\x85\xA0-\uD7FF\uE000-\uFDCF\uFDE0-\uFFFD]/gm;
function sanitizeStringForXML(theString) {
    "use strict";
    return theString.replace(NOT_SAFE_IN_XML_1_0, '');
}

function removeInvalidCharacters(node) {
    "use strict";

    if (node.attributes) {
        for (var i = 0; i < node.attributes.length; i++) {
            var attribute = node.attributes[i];
            if (attribute.nodeValue) {
                attribute.nodeValue = sanitizeStringForXML(attribute.nodeValue);
            }
        }
    }
    if (node.childNodes) {
        for (var i = 0; i < node.childNodes.length; i++) {
            var childNode = node.childNodes[i];
            if (childNode.nodeType == 1 /* ELEMENT_NODE */) {
                removeInvalidCharacters(childNode);
            } else if (childNode.nodeType == 3 /* TEXT_NODE */) {
                if (childNode.nodeValue) {
                    childNode.nodeValue = sanitizeStringForXML(childNode.nodeValue);
                }
            }
        }
    }
} 
```

请注意，这只会从属性的 nodeValues 和 textNodes 中删除无效字符。它不检查标签名称或属性名称、注释等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-04-17T20:55:50.360

检查 [https://gist.github.com/john-doherty/b9195065884cdbfd2017a4756e6409cc](https://gist.github.com/john-doherty/b9195065884cdbfd2017a4756e6409cc)，

非常有用的要点，示例用法：

```
const resultXml = removeXMLInvalidChars(INPUT_XML_STRING, true); 
```

# javascript - 使用 AngularJs 只允许文本框中的字符

> ID：14665289
> 
> 赞同：0
> 
> 时间：2013-02-02T18:54:16.957
> 
> 标签：javascript, angularjs, angularjs-directive

我只想以这样一种方式验证我的项目中的文本框，以便用户无法输入除字符以外的任何值。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:24:39.417

**骇客？方式**，$watch 控制器中的 ng-model：

```
<input type="text" ng-model="myText"> 
```

控制器：

```
$scope.$watch('myText', function() {
   // put logic to strip out all non-character characters here
   if ($scope.myText  ... regex to look for ... ) {
      // strip out the non-characters
   }
}) 
```

**最好的方法**，在指令中使用 $parser。我不会重复@pkozlowski.opensource 提供的已经很好的答案，所以这里是链接：[https ://stackoverflow.com/a/14425022/215945](https://stackoverflow.com/a/14425022/215945)

不要尝试使用 ng-change - 它会导致问题。请参阅[AngularJS - 重置 $scope.value 不会更改模板中的值（随机行为）](https://stackoverflow.com/questions/12176925/angularjs-reset-of-scope-value-doesnt-change-value-in-template-random-behav)

**更新：** [ng-pattern](http://docs.angularjs.org/api/ng.directive:input.text)也可用于定义一个正则表达式，该表达式将限制该字段中允许的内容。另请参阅[有关表单的“食谱”页面](http://docs.angularjs.org/cookbook/form)。

# c# - 返回按重复/重复项计数排序的唯一列表

> ID：14665292
> 
> 赞同：1
> 
> 时间：2013-02-02T18:54:33.930
> 
> 标签：c#, asp.net, linq, list, distinct

我正在寻找的结果的最有效途径是什么？我正在使用 ASP.NET 4.5 和 C#。

假设我有以下`int`列表：

`5,7,2,7,8,5,8,0,2,9,8,8,7`

我想从列表中删除重复项并按每个项目的出现次数对其进行排序。我知道我可以使用 LINQ`Distinct()`使项目独一无二，但我怎样才能让它按出现次数排序？这是上述示例的预期结果：

`8,7,5,2,0,9`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T18:58:24.793

您可以对项目进行分组，然后按每组中的数量对它们进行排序：

```
var items = new[] { 5, 7, 2, 7, 8, 5, 8, 0, 2, 9, 8, 8, 7 };
var result = items
    .GroupBy(x => x)
    .OrderByDescending(x => x.Count())
    .Select(x => x.Key); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T18:58:20.577

```
var ordered = list
    .GroupBy(x => x)
    .OrderByDescending(g => g.Count())
    .Select(g => g.Key); 
```

# datetime - Symfony2，Doctrine，如何将日期时间设置为实体

> ID：14665293
> 
> 赞同：1
> 
> 时间：2013-02-02T18:54:56.030
> 
> 标签：datetime, symfony, doctrine

我不明白如何将日期时间保存到数据库。我有字符串

```
 (string) $oXml->currentTime 
```

实际上它不是一个字符串，但我们将它转​​换，所以我怎样才能将它添加到实体而不会出错

```
 Fatal error: Call to a member function format() on a non-object in... 
```

当前代码

```
 $currentTime = \DateTime::createFromFormat('Y-m-d H:m:s', (string) $oXml->currentTime);
    $cachedUntil = \DateTime::createFromFormat('Y-m-d H:m:s', (string) $oXml->cachedUntil);

    $oApiKeyInfo
            ->setCurrentTime($currentTime)
            ->setCachedUntil($cachedUntil) 
```

不工作:(

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:29:55.867

您需要传递一个 DateTime 对象。用new语句创建它，可以用第一个构造函数参数指定时间使用。

```
$currentTime = new \DateTime((string) $oXml->currentTime);
$cachedUntil = new \DateTime((string) $oXml->cachedUntil);

$oApiKeyInfo->setCurrentTime($currentTime)
  ->setCachedUntil($cachedUntil); 
```

如果需要指定时区，可以使用 DateTimeZone 类并将其作为第二个参数传递给 DateTime 构造函数。

# android - android搜索小部件菜单项

> ID：14665294
> 
> 赞同：1
> 
> 时间：2013-02-02T18:55:08.920
> 
> 标签：android, search

我使用此代码，因为[此 Android API 指南](http://developer.android.com/guide/topics/search/search-dialog.html#UsingSearchWidget)建议在 android 3.0 或更高版本中有一个搜索小部件：

```
 @Override
public boolean onCreateOptionsMenu(Menu menu) {
    // Inflate the options menu from XML
    MenuInflater inflater = getMenuInflater();
    inflater.inflate(R.menu.options_menu, menu);

    // Get the SearchView and set the searchable configuration
    SearchManager searchManager = (SearchManager) getSystemService(Context.SEARCH_SERVICE);
    SearchView searchView = (SearchView) menu.findItem(R.id.menu_search).getActionView();
    searchView.setSearchableInfo(searchManager.getSearchableInfo(getComponentName()));
    searchView.setIconifiedByDefault(false); // Do not iconify the widget; expand it by default

    return true;
} 
```

我在 res/menu/menu.xml 中声明了搜索菜单项（和其他菜单项）

```
<?xml version="1.0" encoding="utf-8"?>
<menu xmlns:android="http://schemas.android.com/apk/res/android">
    <item android:id="@+id/help"
        android:icon="@android:drawable/ic_menu_help"
        android:title="Help" 
        />
    <item android:id="@+id/menu_search"
        android:icon="@android:drawable/ic_menu_search"
        android:title="Search" 
        android:showAsAction="ifRoom"
    />
</menu> 
```

正如 API 指南所建议的那样，我还为搜索结果及其 res/xml/searchable.xml 设置创建了一个活动。但是当我启动我的应用程序时，我得到了一个`NullPointerException`at`onCreateOptionsMenu`和 at`onCreatePanelMenu`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-17T18:47:45.397

正如@A--C 所说，您忘记了您的 menu_search 项目需要`android:actionViewClass="android.widget.SearchView` 尝试添加它并查看它是否有效。如果没有，请确保附加您的 LogCat 堆栈跟踪作为对您问题的编辑。

# javascript - 在 JavaScript 中合并两个对象（NodeList）数组

> ID：14665295
> 
> 赞同：15
> 
> 时间：2013-02-02T18:55:40.977
> 
> 标签：javascript, arrays, object, merge

我正在尝试合并两个对象数组，以便验证表单。在这种情况下，通常的 concat 方法似乎不起作用。Concat 适用于普通数值和字符串数组，但不适用于对象数组。线路`var allTags = allInputs.concat(allSelects);`不工作。

```
var allInputs = document.getElementsByTagName("input");
alert("Inputs: " + allInputs.length);

var allSelects = document.getElementsByTagName("select");
alert("Selects: " + allSelects.length);

var allTags = allInputs.concat(allSelects);
alert("allTags: " + allTags.length); 
```

* * *

## 回答 #1

> 赞同：26
> 
> 时间：2013-02-02T19:02:38.390

> Concat 适用于普通数值和字符串数组，但不适用于对象数组。

实际上，它确实如此，但`NodeList`实例没有`concat`方法，`Array#concat`也没有办法识别您想要展平那些（因为它们不是数组）。

但这仍然很容易做到*（不过，请参阅下面的警告）*。更改此行：

```
var allTags = allInputs.concat(allSelects); 
```

至

```
var allTags = [];
allTags.push.apply(allTags, allInputs);
allTags.push.apply(allTags, allSelects); 
```

[实例](http://jsbin.com/alabat/1)| [资源](http://jsbin.com/alabat/1/edit)

这通过使用一些技巧来工作：[`Array#push`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.4.4.7)接受可变数量的元素添加到数组中，并[`Function#apply`](http://www.ecma-international.org/ecma-262/5.1/#sec-15.3.4.3)使用给定的值`this`（在我们的例子中，`allTags`）和任何类似数组的对象作为传递给它的参数调用函数. 由于`NodeList`实例是类似数组的，因此很`push`乐意将列表的所有元素推送到数组中。

这种行为`Function#apply`（不需要第二个参数真的是一个数组）在规范中**非常**明确地定义，并且在现代浏览器中得到很好的支持。

遗憾的是，IE6 和 7 不支持上述内容（我认为它专门使用主机对象——`NodeLists` 作为`Function#apply`的第二个参数），但是，我们也不应该支持*它们*。:-) IE8 也没有，这更有问题。IE9 对此很满意。

如果您需要支持 IE8 及更早版本，可悲的是，我认为您会遇到一个无聊的旧循环：

```
var allInputs = document.getElementsByTagName('input');
var allSelects = document.getElementsByTagName('select');
var allTags = [];

appendAll(allTags, allInputs);
appendAll(allTags, allSelects);

function appendAll(dest, src) {
  var n;

  for (n = 0; n < src.length; ++n) {
    dest.push(src[n]);
  }

  return dest;
} 
```

[实例](http://jsbin.com/alabat/2)| [资源](http://jsbin.com/alabat/2/edit)

这**确实**适用于 IE8 及更早版本（以及其他）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T19:04:11.027

`document.get[something]`返回一个[NodeList ，它看起来与](https://developer.mozilla.org/en-US/docs/DOM/NodeList)[Array](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Global_Objects/Array)非常相似，但具有许多独特的功能，其中两个是：

*   它不包含 concat 方法
*   项目列表是*实时*的。这意味着它们会随着文档的实时变化而变化。

如果您将 NodeLists 转换为实际数组没有任何问题，您可以执行以下操作以达到您想要的效果：

```
var allInputs  = document.getElementsByTagName("input")
  , allSelects = document.getElementsByTagName("select")
;//nodeLists

var inputList  = makeArray(allInputs)
  , selectList = makeArray(allSelects)
;//nodeArrays

var combined   = inputList.concat(selectList);

function makeArray(list){
  return Array.prototype.slice.call(list);
} 
```

您将失去原始 NodeList 的所有行为，包括它能够实时更新以反映对 DOM 的更改，但我的猜测是，这不是一个真正的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-04T22:28:17.327

我找到了一种简单的方法来按照它们出现在页面或表单上的顺序来收集 dom 对象。首先，在对象上创建一个虚拟类样式“reqd”，然后使用以下内容按照它们在页面上出现的顺序创建一个列表。只需将类添加到您希望收集的任何对象。

```
var allTags = document.querySelectorAll("input.reqd, select.reqd"); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T19:05:00.350

您正在处理的是`HTMLCollection`s，它们是*实时*集合（即，当您将节点添加到 DOM 时，它会自动添加到集合中。

可悲的是，它没有`concat`方法……是有原因的。您需要做的是将其转换为数组，从而失去其实时行为：

```
var allInputsArray = [].slice.call(allInputs),
    allSelectsArray = [].slice.call(allSelects),
    allFields = allInputsArray.concat(allSelectsArray); 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T19:03:05.237

完全查看 underscore.js 吗？你可以做

```
 var allSelectsAndInputs = _.union(_.values(document.getElementsByTagName("input")),_.values(document.getElementsByTagName("select"))); 
```

有关更多信息，请参阅：[http ://underscorejs.org/#extend](http://underscorejs.org/#extend)

该函数适用于对象，但在此设置中有效。

# magento - Magento 销售 > 订单 > 发货历史 > 默认在前端可见

> ID：14665296
> 
> 赞同：1
> 
> 时间：2013-02-02T18:55:49.623
> 
> 标签：magento, soap

![运输](../Images/98ba0d3b982320f5b222329dfc1da47a.png)

客户无法查看他们所下订单的跟踪信息。我认为这可能与默认设置“在前端可见”有关。我该怎么做呢？我认为它类似于此解决方案：[Magento - Email Shipment = Default](https://stackoverflow.com/questions/3941371/magento-email-shipment-default)但如果不是，我可以将其放入为导入订单跟踪号而进行的 SOAP 调用中。

将订单跟踪信息导入系统的部分脚本：

```
// Attempt to create the order, notify on failure
            try { $newShipmentId = $client->call($sess_id, 'sales_order_shipment.create', array($ShippedOrderId, array(), $comment, true, false, $shippedby, $shipname, $fields[4])); }
            catch (Exception $e) { echo 'Shipment creation failed on order '. $ShippedOrderId . ': ', $e->getMessage(); }
            // Add comment to order with all the info
            $client->call($sess_id, 'sales_order.addComment', array($ShippedOrderId, 'complete',  $comment,  false));
            $client->call($sess_id, 'sales_order_shipment.addTrack', array($ShippedOrderId, $shippedby, $shipname, $fields[4]));
            $mail_content .= $line . "\n";
            $importcount++; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:05:43.423

您正在寻找此文件：

```
app/design/adminhtml/default/default/template/sales/order/comments/view.phtml 
```

只需更换

```
<input name="comment[is_visible_on_front]" type="checkbox" id="history_visible" value="1" /> 
```

和

```
<input name="comment[is_visible_on_front]" type="checkbox" id="history_visible" value="1" checked /> 
```

默认情况下检查它。

仅供参考，我刚刚在输入标签中添加了“已检查”。

# iphone - 为什么我的洪水填充算法中的 objectAtIndex 出现 exc_bad_access 错误

> ID：14665298
> 
> 赞同：1
> 
> 时间：2013-02-02T18:56:04.520
> 
> 标签：iphone, objective-c, exc-bad-access, flood-fill

我有一个洪水填充功能：

```
-(void) fillArea :(int) fillNum x:(int) xSpot y:(int) ySpot
{
    int gridValue = 1;
    int gridCount = [theGrid count];
    [[theGrid objectAtIndex:(xSpot+ySpot*120)] getValue:&gridValue];

    if (gridValue != 0) {
        return;
    }
    [theGrid replaceObjectAtIndex:(xSpot + ySpot*120) withObject:[NSNumber numberWithInt:fillNum]];
    [self fillArea:fillNum x:(xSpot+1) y:(ySpot)];
    [self fillArea:fillNum x:(xSpot+1) y:(ySpot-1)];
    [self fillArea:fillNum x:(xSpot)   y:(ySpot-1)];
    [self fillArea:fillNum x:(xSpot-1) y:(ySpot-1)];
    [self fillArea:fillNum x:(xSpot-1) y:(ySpot)];
    [self fillArea:fillNum x:(xSpot-1) y:(ySpot+1)];
    [self fillArea:fillNum x:(xSpot)   y:(ySpot+1)];
    [self fillArea:fillNum x:(xSpot+1) y:(ySpot+1)];

    return;
} 
```

`theGrid`是一个`NSMutableArray`整数（ a`0`或 a `1`）。它只是一个**一维数组**，通过乘以（我的网格的宽度）来模拟**二维数组。**我检查了并且它等于。`ySpot``120``gridCount``9600`

但是，我得到一个`exc_bad_access`at `[[theGrid objectAtIndex:(xSpot+ySpot*120)] getValue:&gridValue]`。我检查我的`xSpot`，当这种情况发生时，我每次都`ySpot`知道。`(xSpot+ySpot*120) < 9600`所以我知道这并不是我试图访问一个索引在我的数组之外的对象。

此外，在我的刻度函数中，我运行了代码：

```
int gVal = 1;
int gIndex = 0;
while (gIndex < [theGrid count]) {
    [[theGrid objectAtIndex:gIndex] getValue:&gVal];
    gIndex += 1;
} 
```

我没有收到`exc_bad_access`错误。请帮我弄清楚为什么我会`exc_bad_access`出错。

编辑：

我拆分 [[theGrid objectAtIndex:(xSpot+ySpot*120)] getValue:&gridValue]; 进入：

```
id object = [theGrid objectAtIndex:(xSpot+ySpot*widthInGridSize)];
gridValue = [object intValue]; 
```

我仍然得到 exc_bad_access，它说它在线：gridValue = [object intValue];

所以我假设这意味着对象已经被释放？我不明白这怎么可能。我认为整数不需要以任何方式保留，因为它们只是整数。另外我认为将对象添加到数组会自动保留它，所以为什么我的 int 会被释放。

在调试部分中，对象的值等于： (_NSCFNumber *) 0x005aec80 (int) 0

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:53:54.573

根据评论 - 这实际上不是一个越界问题，而是您从“theGrid”中拉出的对象是伪造的（已经发布）。将其分成多行以确认；并在调试设置中打开“僵尸”。干杯!

# visual-c++ - 不明白如何为我的 Windows 8 商店应用程序制作试用许可证

> ID：14665303
> 
> 赞同：1
> 
> 时间：2013-02-02T18:56:35.243
> 
> 标签：visual-c++, windows-store-apps, c++-cx

我正在开发一个应用程序，一切都完成了，但我想免费提供一些限制，让用户购买完整版。在 C# 的 Windows DEV 上有一个很好的教程，但我不明白如何在 C++ 中进行操作。我明白我必须使用 CurrentAppSimulator 来模拟这个东西。

因此，例如，我想做一个实验：我有一个带有两个 TextBlocks 的应用程序：如果我有试用版，我只想看到 TextBlock1，如果我有完整版，我还想看到第二个。然后我想要一个按钮来从试用版和完整版更改。我怎样才能实现这么简单的事情？

# jsplumb - jsPlumb 新连接处理程序：如何获取端点锚点位置？

> ID：14665304
> 
> 赞同：4
> 
> 时间：2013-02-02T18:56:44.047
> 
> 标签：jsplumb

是的，所以我一直在玩 jsPlumb。假设我有一个带有两个端点的 div；一个顶部中心，一个底部中心。

创建新连接后，我可以使用以下函数绑定到该事件。我的问题是，如何获得端点的锚点位置？我确实得到了 Source 和 TargetEndpoint 对象，但是查看文档，我看不到获取锚点位置的方法......

谢谢！

```
jsPlumb.bind("jsPlumbConnection", function(connectionInfo) {
 /*
                         connection         :   the new Connection.  you can register listeners on this etc.
                        sourceId        :   id of the source element in the Connection
                          targetId      :   id of the target element in the Connection
                          source        :   the source element in the Connection
                          target        :   the target element in the Connection
                          sourceEndpoint    :   the source Endpoint in the Connection
                          targetEndpoint    :   the targetEndpoint in the Connection
                          */
}); 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-03-19T16:08:19.043

`connectionInfo.connection.endpoints[0].anchor.type`是源位置。 `connectionInfo.connection.endpoints[1].anchor.type`是目标位置。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T14:21:32.793

我找到了以下问题的解决方案：console.log('anchors: %o %o',connectionInfo.sourceEndpoint.anchor.x, connectionInfo.sourceEndpoint.anchor.y);

通过获取端点的 x 和 y 坐标，我知道锚点的位置，并且可以使用它来重新创建图表。

# c# - UPS WSDL/C# 示例编译错误

> ID：14665306
> 
> 赞同：2
> 
> 时间：2013-02-02T18:56:54.933
> 
> 标签：c#, web-services, wsdl, ups

我有一个 C# ASP.NET 站点，我正在尝试将 UPS 引用添加到该站点。我使用示例中的代码并导入了包含的 WSDL，除了`RateService`类之外，所有对象都正确映射到 wsdl。

[这是我正在使用的代码示例和 WSDL](http://delta.djdmarketing.com/PACKAGEWebServices.zip)。

这是有错误的代码片段：

```
RateService rate = new RateService();
RateRequest rateRequest = new RateRequest();
UPSSecurity upss = new UPSSecurity(); 
```

编译错误是`RateService`找不到。

我很确定 WSDL 正在导入，因为其余的类编译得很好。UPS 是否在样品发布后更改了他们的 API？有人有想法么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:05:44.740

您的 WSDL 文件有这个块：

```
<wsdl:service name="RateService">
    <wsdl:port name="RatePort" binding="tns:RateBinding">
        <!-- Production URL -->
            <!-- <soap:address location="https://onlinetools.ups.com/webservices/Rate"/> -->
            <!-- CIE (Customer Integration Environment) URL -->
            <soap:address location="https://wwwcie.ups.com/webservices/Rate"/>
    </wsdl:port>
</wsdl:service> 
```

看起来`RateService`服务已定义。你确定它导入正确吗？

示例代码（在您的 zip 中）还显示了生成的 Web 参考 - 它有一个`RateService`类。

要将此引用添加到您的项目，请转到`Add Service Reference`，选择`Advanced`对话框底部的，然后选择`Add Web Reference`第二个对话框底部的。输入 WSDL 文件的 URL，然后添加引用。

确保将正确的`using`语句添加到代码文件以使用 WSDL 中的类型。

（这适用于 VS 2008 和 VS 2010。）

# cross-compiling - Scratchbox2 错误——进行安装

> ID：14665309
> 
> 赞同：1
> 
> 时间：2013-02-02T18:57:28.550
> 
> 标签：cross-compiling, qemu, scratchbox

我在使用 Scratchbox 时遇到以下错误，请进行安装

```
$ cd $HOME/sbox2/src
$ git clone git://gitorious.org/scratchbox2/scratchbox2.git
$ cd scratchbox2
$ git checkout 2.3.90 -b devel_env
$ ./autogen.sh
$ ./configure --prefix=$HOME/sbox2/bin/scratchbox
$ make install 
```

make install 后我得到的错误：---

```
ignite@ignite:~/sbox2/src/scratchbox2$ make install
make[1]: Entering directory `/home/ignite/sbox2/src/scratchbox2'
echo "/* Automatically generated file. Do not edit. */" >include/scratchbox2_version.h
echo '#define SCRATCHBOX2_VERSION "'`cat .version`'"' >>include/scratchbox2_version.h
echo '#define LIBSB2_SONAME "'"libsb2.so.1"'"' >>include/scratchbox2_version.h
[CC] sblib/sb_log.o
[ARCHIVE] sblib/libsblib.a
[SHLIB] preload/libsb2.so
[CC] utils/sb2dctl.o
In file included from /usr/include/i386-linux-gnu/sys/socket.h:251:0,
                 from /usr/include/netinet/in.h:25,
                 from utils/sb2dctl.c:25:
utils/sb2dctl.c: In function ‘recvfrom_nomap_nolog’:
/usr/include/i386-linux-gnu/bits/socket2.h:65:1: error: inlining failed in call to always_inline ‘recvfrom’: mismatched arguments
utils/sb2dctl.c:166:2: error: called from here
make[1]: *** [utils/sb2dctl.o] Error 1
make[1]: Leaving directory `/home/ignite/sbox2/src/scratchbox2'
make: *** [regular] Error 2 
```

请建议我该如何解决。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-11T20:21:04.897

尝试通过编辑 utils/Makefile 的第 28 行在 CFLAGS 之后添加 -O0（即减去大写-哦零）来关闭 sb2dctl 上的 gcc 优化，如下所示。

```
# sb2dctl, a tool for communicating with sb2d
$(D)/sb2dctl: override CFLAGS := $(CFLAGS) -O0 -Wall -W -Werror \ 
```

在 Ubuntu 12.10 64bit 上使用 gcc 4.7.2 及更高版本对我有用。可能是由 gcc 内联错误引起的。

# php - 为什么这个 PHP 不起作用？它说我的 $_FILES 变量不存在，当我认为我已经创建它时

> ID：14665311
> 
> 赞同：0
> 
> 时间：2013-02-02T18:57:34.610
> 
> 标签：php, html

```
<body>
    <div class="wrapper">

        <div class="header">
            <h1>Text2<span class="fancy">FairyTale</span></h1>
            <h4>Input: text, Output: <span class="fancy">fairy tale</span></h4>
        </div>

        <?php
            if ($_SERVER["REQUEST_METHOD"] == "POST") {

                echo "<pre>";
                print_r($_FILES);
                echo "</pre>";
                $filename = $_FILES["file-input"]["name"];
                $extension = pathinfo($filename, PATHINFO_EXTENSION);

                move_uploaded_file($_FILES["file-input"]["tmp_name"], $filename);
            }
        ?>

        <div class="upload-form">
            <form action="" method="post" encytype="multipart/form-data">
                <div class="upload">
                    <input type="file" name="file-input" class="file-input">
                    <input type="button" value="Browse">
                    <span class="filename">No file selected</span>
                </div>
                <input type="submit" name="submit" value="Upload">

                <span class="valid-formats">Valid input: .txt files &lt;= 512 KB</span>
            </form>
        </div>
    </div>
</body> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T19:06:23.143

你只写表单 Attribute Wrongly is Not **encytype** is **enctype**

```
 enctype="multipart/form-data" 
```

# php - 使用 php session 列出多个表单输入

> ID：14665312
> 
> 赞同：2
> 
> 时间：2013-02-02T18:57:45.107
> 
> 标签：php

我是 php 新手。我如何使用 session 来记住我的多个表单输入，如下所示：在第一个网页中，我可以输入例如产品名称，当我点击提交时，第二页可以告诉我我输入的产品名称。并且，如果我再次回到第一页，输入另一个产品名称，点击提交，第二页可以显示第一个产品和新产品。如果我以这种方式连续输入更多的产品名称，我可以看到第二页列出的所有产品。我怎样才能使用会话来做到这一点？

第一页（order.html）：

```
<html><body>
<h4>Order Form</h4>
<form action="showorder.php" method="post"> 
Product name: <input name="prodname" type="text" /> 
<input type="submit" />
</form>
</body></html> 
```

第二页（showorder.php）：

```
<html><body>
<?php
$Pname = $_POST['prodname'];
echo "You ordered ". $Pname . ".<br />";
?>
</body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:01:53.713

您可以按以下方式使用 $_SESSION 数组：

```
$_SESSION['products'][] = $_POST['prodname']; 
```

这意味着这`$_SESSION['products']`将是一个包含所有购买产品的数组。

不要忘记`session_start()`在所有相关页面的开头调用，并针对 SQL 注入等过滤您的代码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:03:14.597

session_start();

$_SESSION['everthing'] = $_POST['username'];

然后你可以回显会话，或者只是为它分配一个变量。会话将一直留在那里，直到浏览器关闭

# c# - Razor 是否在解决方案文件夹中查找？

> ID：14665315
> 
> 赞同：3
> 
> 时间：2013-02-02T18:58:24.303
> 
> 标签：c#, asp.net-mvc, razor, namespaces

我正在尝试在我的 .cshtml 文件中使用自定义命名空间中的模型。但是，每当我尝试设置模型时，Razor 都会引发`The type or namespace name could not be found`错误。

我有一个项目设置，它使用解决方案文件夹来帮助组织，如下所示： ![显示 MyProject 的文件夹结构](../Images/e7ace5c51afa9afd8d628f2fc8e3bcfc.png)

MyViewModel.cs 文件中的代码如下所示：

```
namespace MyProject.ViewModels
{
    public class MyViewModel
    {
    }
} 
```

好的，这就是基本的布局。问题是当我尝试`MyViewModel`在我的 Razor 视图中使用该对象时，Razor 说它找不到命名空间。如此处所示： ![Razor 找不到命名空间](../Images/4b713ef034f380c36ed34127aeff23bc.png)

我相信我正在按照我应该的方式做每一件事。似乎 Razor 无法查看解决方案文件夹。如何让`MyViewModel`Razor 识别对象？有什么我想念的吗？

请注意：我确实意识到我可以简单地更改我的`@using`声明以引用整个路径。但是，在我的项目中，我在 ViewModels 文件夹中有许多解决方案文件夹，我不想逐个指定。

**更新**

我接受了达林的回答，因为它成功地回答了这个问题。我还在下面提供了一些关于我的具体情况以及为什么会出现这个问题的更多信息。

我进一步研究了这个问题，并弄清楚发生了什么。我通常使用 SparkViewEngine，它允许像这样引用我的视图模型：`<viewdata model="ViewModels.MyViewModel"/>`当 Razor 不允许我以相同的方式引用视图模型时，我认为 Razor 有问题。

每个 ViewEngine 创建用于帮助生成视图的临时 CS 文件。Spark 创建的临时文件使用“控制器”命名空间。在这种情况下，Spark 会`MyProject.Controllers`在其临时 CS 文件中使用命名空间。这意味着我可以在`ViewModels.MyViewModel`不指定完整命名空间的情况下引用该对象，因为它与生成的 CS 文件位于同一命名空间中。

Razor 生成的临时文件使用`ASP`命名空间。这意味着我无法在`ViewModels.MyViewModel`不指定完整命名空间的情况下引用该对象，因为它与生成的 CS 文件不在同一个命名空间中。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T19:01:17.570

`@using`使用指令将声明视图模型的命名空间添加到剃刀视图的顶部：

```
@using MvcApplication1.ViewModels
@model MyViewModel 
```

此外，为了避免在您想使用它的每个剃刀视图中添加它，您可以将它添加到文件的`<namespaces>`部分`~/Views/web.config`（不要与 混淆`~/web.config`）：

```
<system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Routing" />

        <add namespace="MvcApplication1.ViewModels" />
      </namespaces>
    </pages>
</system.web.webPages.razor> 
```

还要注意我是如何指定完整的命名空间的。在您展示的屏幕截图中，您似乎只是在使用`ViewModels.MyViewModel`，但您确定这是正确的命名空间吗？通常，当您在 Visual Studio 中添加类文件时，它将使用应用程序名称 + 文件夹作为命名空间的前缀，例如`MvcApplication1.ViewModels`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:00:44.947

该`@using`指令应指向您的命名空间：

```
@using MyProject.ViewModels 
```

然后将您的模型声明为类：

```
@model MyViewModel 
```

或者，直接使用全名：

```
@model MyProject.ViewModels.MyViewModel 
```

# .htaccess - 如果域不等于 .. 并且域不等于，则 htaccess 重定向

> ID：14665317
> 
> 赞同：0
> 
> 时间：2013-02-02T18:58:27.067
> 
> 标签：.htaccess, http, redirect

我试图把这两个条件放在一条线上..

**如果访问者来自除 example2.com 之外的**任何其他网址，我想将域名更改为 example.com

 **这意味着如果我来自*example3.com/blah/blah*它应该是 -> *example.com/blah/blah*
如果我来自*example2.com/blah/blah* **它应该保持不变**

我已经完成了第一部分

```
#RewriteCond %{HTTP_HOST} !^(www\.)?example.com$ [NC]
#RewriteRule ^(.*)$ http://example.com/$1 [L,R] 
```

这个说如果网站不是 www.example.com 或 example.com 则将域更改为 example.com 我如何从中排除*example2.com*并保持原样而不更改为任何其他域？**

# c# - 我如何使用 TaskScheduler.FromCurrentSynchronizationContext() 解决后台线程异常的 UI 更新

> ID：14665321
> 
> 赞同：0
> 
> 时间：2013-02-02T18:58:37.273
> 
> 标签：c#, asynchronous, .net-4.5

这是我的问题的一个小例子，我无法从关于同一错误的其他问题中解决它。

UI 线程通过单击按钮调用具有以下行的函数：

```
await DataSet.AddFileAsync(String.Format("ms-appdata:///local/IMM_FACE_DB/{0}", file.Name)); 
```

AddFileAsync 看起来像这样：

```
public ObservableCollection<Model> Data {get;set;}
public Task AddFileAsync(string path)
{
     return Task.Factory.StartNew((state) =>
     {
         // Here some IO and computation is done, eventually some content is added 
         // to Data. Data is also bound to a GridView and this fails.

         //I assumed that TaskScheduler.FromCurrentSynchronizationContext()
         // would solve this, but it does not.
     }, TaskScheduler.FromCurrentSynchronizationContext());
} 
```

正如我在上面的代码中所写的那样，我假设 TaskScheduler 可以确保它在 UI 线程上运行。由于 AddFileAsync 是从 Databound Buttonclick 命令调用的。

我在哪里误解了什么？什么是正确的等待这样做。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:21:38.463

没必要`StartNew`我看得出来...

```
public async Task AddFileAsync(string path)
{
  // Do some IO
  var ioResult = await DoIoAsync(path);

  // Do some computation
  var computationResult = await Task.Run(() => DoComputation(ioResult));

  // Update Data
  Data.Add(computationResult);
} 
```

# iphone - 使用 Cocos2d 自动生成精灵动画

> ID：14665322
> 
> 赞同：0
> 
> 时间：2013-02-02T18:58:39.337
> 
> 标签：iphone, objective-c, cocoa, cocos2d-iphone

我有一个类代表我在 Cocos2d 中的角色。
我已经导出了 spritesheet + .plist 文件。

角色有多个动画。

这些框架简称为**"Character_1.png"**。
最多四个。这是基本的行走动画。

在许多精灵动画教程中，我找到了这个示例代码，它循环通过精灵帧缓存并将其添加到数组中，以便您可以对其进行动画处理：

```
for(int i = 1; i <= 4; ++i) {
    [animationFrames addObject:[[CCSpriteFrameCache sharedSpriteFrameCache] spriteFrameByName:[NSString stringWithFormat:@"Character_%d.png", i]]];
} 
```

然而，因为我的大多数精灵都会像这样被动画化，我想把它委托给一个超类。

我想把它称为

```
spriteWithAnimations:(NSArray *)animationNames 
```

然后我会查看它们，就像上面的示例一样。

因此，作为数组中的参数，我会得到一个 string `@"Character_%d"`，我会做一个 while 循环并检查文件是否存在，而这样的话，我会将它添加到数组中。

唯一的问题是，我无法检查框架**“Character_05.png”**是否存在，因为`CCSpriteFrameCache`没有这样的方法。

这通常是如何解决的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:29:35.087

如果 CCSpriteFrameCache 为给定的帧名称返回 nil，您就知道它不存在。不优雅，但它有效。

# xcode - mac osx上的sqlite3链接错误

> ID：14665323
> 
> 赞同：1
> 
> 时间：2013-02-02T18:58:39.290
> 
> 标签：xcode, sqlite

在将程序从 windows 移植到 mac 时，我正在 xcode 中构建一个 C/C++ 库。该库使用 sqlite3 c api。以前在 Windows 中，sqlite3 源代码被编译为库的一部分。

我必须编译我的库以兼容 32 位和 64 位平台，并且需要支持 mac osx 10.5 到 10.8

在mac上好像内置了sqlite3，所以我想我不需要在项目中编译sqlite3代码，而是参考平台上已经存在的库

该库编译但给出了 sqlite3 函数调用的链接错误，

我能够在 mac 上找到 sqlite3.dylib，它是一个动态库。

在 Windows 中，我们会使用 loadlibrary() 函数调用来使用 dll。那么让我感到困惑的是我是否必须更改我的代码以可能进行类似于 mac 的 loadlibrary() 的调用然后使用它？我不确定..我是mac的新手。

我期待 mac 上有一个 sqlite3 的静态库，我发现的是 dylib，如果我可以静态链接 sqlite3，那可能是最好的，因为我不需要更改太多代码。

如何在我的 xcode 项目中将其链接到平台可用的 sqlite3 库？还是我需要将 sqlite3 代码编译为我的项目的一部分并忽略平台上的 dylib？

请问有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:50:18.493

```
#ifndef WIN32
typedef void* HANDLE
inline HANDLE LoadLibrary(char path[])
{
    return (HANDLE) dlopen(path, RTLD_NOW);
}
inline void FreeLibrary(HANDLE handle)
{
    dlclose((void*) handle);
}
#endif 
```

// 把上面的函数放在一个header中，就可以继续使用LoadLibrary语法了

# c# - Linq to SQL 将两个表中的数据联合到单个 IEnumerable/IQueryable

> ID：14665325
> 
> 赞同：1
> 
> 时间：2013-02-02T18:58:42.303
> 
> 标签：c#, sql-server, linq, linq-to-sql, .net-4.0

我在单独的 SQL Server 数据库中有两个日志表（在不同的服务器上）。这两个表具有完全相同的架构。在我的 .NET 应用程序中，我可以创建两个 Linq to SQL 类集合（DBML 文件），然后执行我自己的自定义 Linq 查询来合并两个表并返回一个匿名类型。但是我在同一张表上有几个查询（都略有不同），每次都做联合是重复的。

是否可以将这两个表合并为一个具体/命名类型 IEnumerable？基本上我想做的是：

```
var logs = Logs.Where(l => l.TimeStart >= DateTime.Today) 
```

并且`Logs`实际上已经从两个表返回数据，并且无论我在`.Where()`.

这可能吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:54:23.890

我相信开箱即用您无法获得一个涵盖多个数据上下文的 IQueryable。你提到你有

> 单独的 SQL Server 数据库（在不同的服务器上）。

一种解决方案可能是创建链接视图。示例：[在 SQL Server 中使用 Linked Server db 创建视图](https://stackoverflow.com/q/2493866/532498)

获得链接视图后，查询将相当简单和直接。

# python - Python App Engine 不会部署 - 超时

> ID：14665328
> 
> 赞同：3
> 
> 时间：2013-02-02T18:58:51.777
> 
> 标签：python, google-app-engine

我的应用程序拒绝部署，只是写

> 检查部署是否成功。
> 
> 将在 60 秒后再次检查。

一遍又一遍，然后超时。

这是我的 .bat 文件：

> python "C:\Program Files (x86)\Google\google_appengine\appcfg.py" --email=my email --passin update "app directory"

否则我的互联网连接工作正常。有任何想法吗？

完整错误：

```
2013-02-02 21:01:22,963 WARNING appcfg.py:2053 Version still not ready to serve,
 aborting.
2013-02-02 21:01:22,966 ERROR appcfg.py:2267 An unexpected error occurred. Abort
ing.
Traceback (most recent call last):
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 2253, in DoUpload
    app_summary = self.Commit()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 2054, in Commit
    raise Exception('Version not ready.')
Exception: Version not ready.
09:01 PM Rolling back the update.
Traceback (most recent call last):
  File "C:\Program Files (x86)\Google\google_appengine\appcfg.py", line 171, in
<module>
    run_file(__file__, globals())
  File "C:\Program Files (x86)\Google\google_appengine\appcfg.py", line 167, in
run_file
    execfile(script_path, globals_)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 4377, in <module>
    main(sys.argv)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 4368, in main
    result = AppCfgApp(argv).Run()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 2605, in Run
    self.action(self)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 4103, in __call__
    return method()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 3115, in Update
    self.UpdateVersion(rpcserver, self.basepath, appyaml)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 3097, in UpdateVersion
    return appversion.DoUpload(paths, openfunc)
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 2253, in DoUpload
    app_summary = self.Commit()
  File "C:\Program Files (x86)\Google\google_appengine\google\appengine\tools\ap
pcfg.py", line 2054, in Commit
    raise Exception('Version not ready.')
Exception: Version not ready. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T19:24:37.113

我不认为你做错了什么。有时 Google App Engine 不会以您想要的方式响应，因为他们可能会遇到一些问题。

尝试更改版本并重新部署（或`--version=version-name`在命令行中使用）。如果这不能解决它，你将不得不等待一段时间，然后再试一次

# android - Android TimePicker 在 Fragment 中使用时看起来很旧，但在 Activity 中具有新外观

> ID：14665329
> 
> 赞同：0
> 
> 时间：2013-02-02T18:58:53.920
> 
> 标签：android, android-4.0-ice-cream-sandwich, timepicker

在我的选项卡式 Android 应用程序中，我扩展了 TabActivity 并且选项卡具有不同的活动，这些活动在创建时使用 setContentView(int) 设置内容，如下所示：

报警器.java

```
public class Alarm extends Activity implements OnClickListener {

    @Override
    public void onCreate(Bundle bundle) {
        super.onCreate(bundle);
        setContentView(R.layout.alarm);
        // ...
    }
} 
```

警报.xml

```
<?xml version="1.0" encoding="utf-8"?>
<RelativeLayout 
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:background="@color/trans_white" >

    <TextView
        android:id="@+id/textView1"
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_alignParentLeft="true"
        android:gravity="center"
        android:text="example text"
        android:textColor="@color/black"
        android:textSize="17sp" />

    <TimePicker
        android:id="@+id/alarmTimePicker"
        android:layout_width="match_parent"
        android:layout_height="wrap_content"
        android:layout_below="@+id/textView1"
        android:layout_centerHorizontal="true"
        android:layout_marginLeft="10dp"
        android:layout_marginRight="10dp"
        android:layout_marginTop="32dp"
        android:background="@color/black"
        android:paddingBottom="10dp"
        android:paddingLeft="10dp"
        android:paddingRight="10dp"
        android:paddingTop="10dp" />

    <TextView
        android:id="@+id/alarmActiveTV"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@+id/alarmTimePicker"
        android:layout_centerHorizontal="true"
        android:layout_marginTop="42dp"
        android:text="@string/replacement_txt"
        android:textSize="18sp" />

    <Button
        android:id="@+id/alarm_button"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_alignParentBottom="true"
        android:layout_centerHorizontal="true"
        android:layout_marginBottom="50dp"
        android:gravity="bottom"
        android:onClick="showTimePickerDialog"
        android:text="@string/set_alarm_btn_txt"
        android:textSize="20sp" />

</RelativeLayout> 
```

这带来了一个漂亮的新 TimePicker ![新的时间选择器](../Images/461ae2577b45858803a926a4977a22bb.png)

但后来我注意到 TabActivity 已被弃用并更改为扩展 FragmentActivity ，其中选项卡扩展 Fragment 而不是活动，如下所示：

报警器.java

```
public class Alarm extends Fragment implements OnClickListener {

    @Override
    public View onCreateView(LayoutInflater inflater, 
        ViewGroup container, Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        if (container == null) {
            return null;
        }
        return (RelativeLayout)inflater.inflate(R.layout.alarm, container, false);
} 
```

在这个新结构中，我膨胀了布局。

这将外观更改为旧的 TimePicker 外观：

![旧时光拾取器](../Images/e02079e7201af5450e2cd4e7878f57c9.png)

为什么这会改变 TimePicker 的样式？如何使用这个新的 FragmentActivity 获得新的 TimePicker？

我导入 v4 支持库以支持较旧的 SDK:s。minSDK 是 8。目标是 17。（将 minSDK 更改为 16 没有帮助）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-11-18T17:57:16.530

如果您使用**ContextThemeWrapper**（或不使用），则可能是 xml 中的样式问题

```
ContextThemeWrapper l_contextThemeWrapper = new ContextThemeWrapper(this, R.style.myStyle); 
```

不要使用父样式

```
<style name="myStyle">
...
</style> 
```

# virtualenv - pip - 要求已经满足？

> ID：14665330
> 
> 赞同：16
> 
> 时间：2013-02-02T18:58:56.410
> 
> 标签：virtualenv, pip, virtualenvwrapper

pip 识别全局安装包..？！:-(

我使用 virtualenvwrapper 预激活钩子来清理 PYTHONPATH，

```
export PYTHONPATH="" 
```

然后 echo $PYTHONPATH 返回空字符串，但这没有帮助。

怎么了？

```
bentzy@lama:~$ mkvirtualenv test
New python executable in test/bin/python
Installing setuptools............done.
Installing pip...............done.
virtualenvwrapper.user_scripts creating /home/bentzy/.virtualenvs/test/bin/predeactivate
virtualenvwrapper.user_scripts creating /home/bentzy/.virtualenvs/test/bin/postdeactivate
virtualenvwrapper.user_scripts creating /home/bentzy/.virtualenvs/test/bin/preactivate
virtualenvwrapper.user_scripts creating /home/bentzy/.virtualenvs/test/bin/postactivate
virtualenvwrapper.user_scripts creating /home/bentzy/.virtualenvs/test/bin/get_env_details
(test)bentzy@lama:~$ which pip
/home/bentzy/.virtualenvs/test/bin/pip
(test)bentzy@lama:~$ sudo pip install simplejson
Requirement already satisfied (use --upgrade to upgrade): simplejson in /usr/lib    /python2.7/dist-packages
Cleaning up...
(test)bentzy@lama:~$ echo $PYTHONPATH

(test)bentzy@lama:~$ pip --version
pip 1.2.1 from /home/bentzy/.virtualenvs/test/lib/python2.7/site-packages/pip-1.2.1-py2.7.egg (python 2.7) 
```

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-02-03T17:22:52.867

您正在使用`sudo`安装 simplejson，但如果您使用`sudo`您的`$PATH`可能会更改，这似乎是问题所在。

只需使用`pip install simplejson`（不`sudo`包括在内），它可能会起作用。

`sudo`仅在您想影响整个系统时使用。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-04-10T12:54:16.077

已经满意意味着您已经安装了“它”。

尝试： **pip卸载simplejson**

然后： **pip install simplejson**

# ruby-on-rails - Vagrant 是否需要本地源代码？

> ID：14665331
> 
> 赞同：1
> 
> 时间：2013-02-02T18:58:58.447
> 
> 标签：ruby-on-rails, vagrant

假设我在我的机器上本地有一个 rails 应用程序，并且我在该应用程序中使用 vagrant。

我已经在那个流浪者身上工作过，并用它做了一个盒子。

现在我把盒子给了其他人。

其他人是否需要在他们的机器上本地拥有 rails 应用程序的源代码，或者他们可以只使用我提供的 vagrant box 而无需在本地拥有源代码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:13:25.327

我们在下一个方案中使用 Vagrant for VDE（虚拟开发环境）（也许它对你也有用）：

1.  我们将源代码保存在 git 下（可以是 svn/csv/etc）；
2.  我们将 Vagrantfile 保存在 git 存储库的根文件夹中；
3.  在 Vagrantfile 中，我们添加：

    ```
    config.vm.box_url = "http://<url for our box>"

    nfs = !Kernel.is_windows?

    config.vm.share_folder "v-root", "/tmp/vde", ".", :nfs => nfs 
    ```

我们将盒子存储在 S3 上很容易，但最简单的方法是保管箱。

因此，要共享您的资源，您只需要共享存储库。在 Readme.md 中，您可以描述启动 vde 的几个步骤

使用 share_folder 您的所有资源都可以从文件夹 /tmp/vde 中的 vde（内部实例）获得

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:02:20.613

通常，您的 Rails 应用程序的源代码从您自己的文件系统*共享*到您使用 Vagrant 运行的虚拟机；它不*存储*在虚拟机的驱动器上。该应用程序实际上永远不会永久存储在盒子上。因此，将其发送给其他人将不允许他们运行该应用程序，因为该应用程序在 VM 上不存在。

有关更多信息，请参阅[Vagrant SSH 文档中的“访问项目文件”](http://docs.vagrantup.com/v1/docs/getting-started/ssh.html)：

> ## 访问项目文件
> 
> Vagrant 通过使用 VirtualBox 共享文件夹将您的应用程序与虚拟环境连接起来。虚拟机上的共享文件夹位置默认为`/vagrant`，但可以更改。这可以通过在 SSH 会话中列出该文件夹中的文件来验证：
> 
> ```
> vagrant@vagrantbase:~$ ls /vagrant
> index.html Vagrantfile 
> ```
> 
> VM 对共享文件夹具有读写访问权限。
> 
> **请记住：任何更改都会在两个系统之间进行镜像。**

# google-chrome-extension - Chrome 扩展：使用 addEventListener()

> ID：14665332
> 
> 赞同：4
> 
> 时间：2013-02-02T18:59:01.937
> 
> 标签：google-chrome-extension, addeventlistener

在将[Google Chrome 扩展迁移到清单版本 2 的教程中](http://developer.chrome.com/extensions/tut_migration_to_manifest_v2.html)，我被指示*从 HTML 代码中删除内联事件处理程序（如 onclick 等），将它们移动到外部 JS 文件中并改用 addEventListener()。*

好的，我目前有一个像这样的 background.html 页面……</p>

```
<html>
<script type="text/javascript">
    // Lots of script code here, snipped
    …
</script>

<body  onload="checkInMyNPAPIPlugin('pluginId');">
    <object type="application/x-mynpapiplugin" id="pluginId">
</body>
</html> 
```

按照另一个指令，我已经将*大量脚本代码*移到一个单独的 .js 文件中，并且按照这个指令，我需要从 body 标记中删除 onload= ，而是在我的脚本代码中调用 addEventListener() 。我尝试了几种方法，但显然猜错了。该代码会是什么样子？特别是，我在什么对象上调用 addEventListener()？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-05-02T06:11:38.627

我通常将其用于正文加载事件...

```
document.addEventListener('DOMContentLoaded', function () {
    //   My code here.. ( Your code here  )
}); 
```

对于某些东西它正在工作..但实际上，我认为我们应该使用..

```
window.addEventListener('load', function () {
    document.getElementById("#Our_DOM_Element").addEventListener('change - or - click..', function(){
//      code..
    });
}); 
```

# java - 将图像/按钮叠加到主屏幕/ Android

> ID：14665333
> 
> 赞同：0
> 
> 时间：2013-02-02T18:59:12.577
> 
> 标签：java, android, button

我有一个简单的问题..我在网上查找并找不到答案..如果有人能指出我正确的方向，我只想问。有一些应用程序可以在您的屏幕上放置一个半透明按钮，该按钮将保持静止。即使应用程序打开..有人可以指出正确的方向来学习如何做到这一点

# html - 使用 experss.js 动态更改 HTML

> ID：14665334
> 
> 赞同：1
> 
> 时间：2013-02-02T18:59:19.053
> 
> 标签：html, model-view-controller, express

我不确定我是否正确理解了 express MVC：

如果我想制作一个单页应用程序并动态更改 HTML，是否有 express 可以帮助我的东西？或者我是否会得到静态页面，如果我想更改我必须使用前端 JavaScript？

更具体地说，HTML（或 Jade）模板可以以某种方式更改前端的 HTML？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T14:18:05.900

> 如果我想制作一个单页应用程序并动态更改 HTML，是否有 express 可以帮助我的东西？

是的。

> 或者我是否会得到静态页面，如果我想更改我必须使用前端 JavaScript？

是的，如果您不想刷新整个页面，则需要在前端使用 JavaScript 来更改页面。

> 更具体地说，HTML（或 Jade）模板可以以某种方式更改前端的 HTML？

通常，您在 Express.js 中使用的 HTML（或 Jade）模板将生成页面的初始版本。

当用户在浏览器上与页面交互时（比如用户点击链接或从下拉列表中选择某些内容），您的客户端代码将向服务器提交 Ajax 请求，Express.js 将处理此请求并返回 JSON （不是 HTML）返回到客户端，您的前端 JavaScript 将重新填充客户端上的一些数据。请记住，此时您不会从服务器生成更多 HTML。

您的 Express.js 可以为这些请求返回 HTML 而不是 JSON，但这很快就会变得混乱，因此大多数编写单页应用程序的人选择将 JSON 返回给客户端并使用客户端 JavaScript 重新填充需要更新的任何 DOM 元素。

# json - 在 Play 应用程序中使用 ModelCompanion 的 fromJSON 方法会引发 NoSuchMethodException

> ID：14665336
> 
> 赞同：1
> 
> 时间：2013-02-02T18:59:20.010
> 
> 标签：json, scala, playframework, salat

我是 Scala 的新手，我正在尝试做我的第一个 Play 2.0 应用程序。我在用着：

*   斯卡拉 2.9.3
*   玩 2.0.4
*   [SalatWithPlay2](https://github.com/novus/salat/wiki/SalatWithPlay2) 1.1

我的`conf/routes`文件中有这个：

```
PUT /newVenue   controllers.Application.createNewVenue 
```

我的`Application.scala`文件中有这个：

```
def createNewVenue = Action(parse.json) { request =>
    val newVenue = Venue.fromJSON(request.body.toString)
    Venue.insert(newVenue)
    Ok("New Venue Created")
  } 
```

这是代码`Venue.scala`：

```
import play.api.Play.current
import com.novus.salat._
import com.novus.salat.global._
import com.novus.salat.annotations._
import com.novus.salat.dao._
import com.mongodb.casbah.Imports._
import se.radley.plugin.salat._

object Venue extends ModelCompanion[Venue, ObjectId] {
        val collection = mongoCollection("venues")
        val dao = new SalatDAO[Venue, ObjectId](collection = collection) {}
    }

case class Venue(
        @Key("_id") val venueId:ObjectId,
        var playlist:Playlist, 
        var isPlaying:Boolean = false) 
```

为了测试这是否有效，我`localhost:9000/newVenue`以这个 JSON 为主体发送了一个 PUT 请求：

```
{"venueId": 3,"playlist":{"playlistId":2,"currentSongPosition":5},"isPlaying":false} 
```

然后我得到这个**错误**：

```
[error] application - 

! @6d7oco1hf - Internal server error, for request [PUT /newVenue] ->

play.core.ActionInvoker$$anonfun$receive$1$$anon$1: Execution exception [[NoSuchMethodException: model.Venue$.apply$default$1()]]
    at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:134) [play_2.9.1.jar:2.0.4]
    at play.core.ActionInvoker$$anonfun$receive$1.apply(Invoker.scala:115) [play_2.9.1.jar:2.0.4]
    at akka.actor.Actor$class.apply(Actor.scala:318) [akka-actor.jar:2.0.2]
    at play.core.ActionInvoker.apply(Invoker.scala:113) [play_2.9.1.jar:2.0.4]
    at akka.actor.ActorCell.invoke(ActorCell.scala:626) [akka-actor.jar:2.0.2]
    at akka.dispatch.Mailbox.processMailbox(Mailbox.scala:197) [akka-actor.jar:2.0.2]
Caused by: java.lang.NoSuchMethodException: model.Venue$.apply$default$1()
    at java.lang.Class.getMethod(Class.java:1605) ~[na:1.6.0_37]
    at com.novus.salat.ConcreteGrater.defaultArg(Grater.scala:350) ~[salat-core_2.9.1-1.9.1.jar:1.9.1]
    at com.novus.salat.ConcreteGrater.safeDefault(Grater.scala:360) ~[salat-core_2.9.1-1.9.1.jar:1.9.1]
    at com.novus.salat.ConcreteGrater$$anonfun$6$$anonfun$apply$7.apply(Grater.scala:319) ~[salat-core_2.9.1-1.9.1.jar:1.9.1]
    at com.novus.salat.ConcreteGrater$$anonfun$6$$anonfun$apply$7.apply(Grater.scala:319) ~[salat-core_2.9.1-1.9.1.jar:1.9.1]
    at scala.Option.orElse(Option.scala:218) ~[scala-library.jar:0.11.3] 
```

我认为触发错误的行是**val newVenue = Venue.fromJSON(request.body.toString)**。

有谁知道出了什么问题？我遵循了 SalatWithPlay2 页面中的教程，也遵循了[类似问题](https://stackoverflow.com/questions/10987476/play-2-0-and-mongodb-interfacing-with-salat)中的一些建议），但到目前为止我没有运气。

**更新**：

我找到了一种解决方法，虽然它不完全是一个解决方案，但也许它对其他人和理解什么是实际解决方案有帮助。

如果我去掉注解@Key，案例类Venue的代码是这样的：

```
case class Venue(
        val venueId:ObjectId,
        var playlist:Playlist, 
        var isPlaying:Boolean = false) 
```

然后我得到另一个错误：

```
[RuntimeException: in: unexpected OID input class='net.liftweb.json.JsonAST$JInt', value='3'] 
```

例如，如果我不使用 ObjectId 而是使用 Long，则代码如下所示：

```
case class Venue(
        val venueId:Long,
        var playlist:Playlist, 
        var isPlaying:Boolean = false) 
```

我没有错误！

所以 NoSuchMethodException 显然与 _id 相关的@Key 注释有关。我还尝试将 placeId 重命名为 _id 并出现相同的 NoSuchMethodException 错误。那么问题来了：**为什么我不能用@Key注解说我的哪些属性映射到mongo数据库中文档的对象id呢？** 除此之外，由于某些其他原因，常规整数无法自动转换为 ObjectId 实例。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T03:03:25.813

所以我发现了问题所在。

请求正文中发送的 Json 的属性必须与 mongodb 文档的属性名称匹配，而不是 Scala 对象的属性。

因此，如果我的类 Venue 定义如下： case class Venue(@Key("_id") val avenueId:ObjectId, var playlist:Playlist, var isPlaying:Boolean = false)

我必须在 PUT 请求中发送的 Json 是：

```
{"_id": 3,"playlist":{"playlistId":2,"currentSongPosition":5},"isPlaying":false} 
```

而**不是**：

```
{"venueId": 3,"playlist":{"playlistId":2,"currentSongPosition":5},"isPlaying":false} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:20:56.247

只是在黑暗中拍摄，但您可以尝试将您的对象类命名为其他名称吗？也许到 VenueCompanion？似乎编译器可能对应用哪个对象感到困惑。IE 它不适用于您想要的案例类地点。我很好奇之后异常是否仍然相同。

# spring - 从 DB 中使用 JSP 中的外键查看的列表

> ID：14665341
> 
> 赞同：1
> 
> 时间：2013-02-02T18:59:52.797
> 
> 标签：spring, jsp, jpa, spring-mvc

我在显示来自 DB 的数据源时遇到问题。如果我想要显示 ID（外键）一切正常，但我想要显示名称。

工作良好并显示部门 ID：

```
<c:if test="${!empty contactList}">
    <table class="data">
        <tr>
            <th>First name</th>
            <th>Last name</th>
            <th>Email</th>
            <th>Telephone</th>
            <th>Department</th>
            <th>&nbsp;</th>
        </tr>
        <c:forEach items="${contactList}" var="contact">
            <tr>
                <td>${contact.firstname}</td>
                <td>${contact.lastname}</td>
                <td>${contact.email}</td>
                <td>${contact.telephone}</td>
                <td>${contact.department.id}</td>

            <!--    <td><a href="delete/${contact.id}.html">delete</a></td>-->
            <td>
                &nbsp;<a href="updateContact.do?id=${contact.id}">Edit</a>
                &nbsp;&nbsp;<a href="javascript:deleteContact('deleteContact.do?id=${contact.id}');">delete</a>

            </td>

            </tr> 
```

我想：

```
<td>${contact.department.name}</td> 
```

控制器：

```
 @RequestMapping("/showContacts")
    public String listContacts(Map<String, Object> map) {

        User user = (User)SecurityContextHolder.getContext().getAuthentication().getPrincipal();
        String name = user.getUsername();       
        map.put("username", name);
        map.put("contact", new Contact());      
    //  map.put("department", new Department());
        map.put("contactList", contactService.listContact());

        return "showContacts";
    } 
```

具有外键的实体：

```
package pl.ivmx.contact.form;

import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.JoinColumn;
import javax.persistence.ManyToOne;
import javax.persistence.Table;

import pl.ivmx.department.form.Department;

@Entity
@Table(name="CONTACTS")
public class Contact {

    @Id
    @Column(name="ID")
    @GeneratedValue(strategy = GenerationType.AUTO)
    private Integer id;

    @Column(name="FIRSTNAME")
    private String firstname;

    @Column(name="LASTNAME")
    private String lastname;

    @Column(name="EMAIL")
    private String email;

    @Column(name="TELEPHONE")
    private int telephone;

    @ManyToOne(fetch = FetchType.LAZY)
    @JoinColumn(name = "Department_ID", nullable = false)
    private Department department;

    public String getEmail() {
        return email;
    }
    public int getTelephone() {
        return telephone;
    }
    public void setEmail(String email) {
        this.email = email;
    }
    public void setTelephone(int telephone) {
        this.telephone = telephone;
    }
    public String getFirstname() {
        return firstname;
    }
    public String getLastname() {
        return lastname;
    }
    public void setFirstname(String firstname) {
        this.firstname = firstname;
    }
    public void setLastname(String lastname) {
        this.lastname = lastname;
    }
    public Integer getId() {
        return id;
    }
    public void setId(Integer id) {
        this.id = id;
    }
    public Department getDepartment() {
        return department;
    }
    public void setDepartment(Department department) {
        this.department = department;
    }

} 
```

第二实体：

```
package pl.ivmx.department.form;

import java.io.Serializable;
import java.util.HashSet;
import java.util.Set;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
import javax.persistence.FetchType;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;
import javax.persistence.OneToMany;

import pl.ivmx.contact.form.Contact;;

@Entity
@Table(name = "department")
public class Department implements Serializable{

    private int id;
    private String name;
    private Set<Contact> contact = new HashSet<Contact>();

    @Id
    @GeneratedValue(strategy = GenerationType.AUTO)
    @Column(name = "Department_ID")
    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    @Column(name = "Name")
    public String getName() {
        return name;
    }
    public void setName(String name) {
        this.name = name;
    }

    @OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, mappedBy = "department")
    public Set<Contact> getContact() {
        return contact;
    }
    public void setContact(Set<Contact> contact) {
        this.contact = contact;
    }

} 
```

错误：

FeachType.EAGER：

```
type Exception report

message javax.el.ELException: Error reading 'name' on type pl.ivmx.department.form.Department_$$_javassist_0

description The server encountered an internal error (javax.el.ELException: Error reading 'name' on type pl.ivmx.department.form.Department_$$_javassist_0) that prevented it from fulfilling this request.

exception

org.apache.jasper.JasperException: javax.el.ELException: Error reading 'name' on type pl.ivmx.department.form.Department_$$_javassist_0
    org.apache.jasper.servlet.JspServletWrapper.handleJspException(JspServletWrapper.java:549)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:470)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)

root cause

javax.el.ELException: Error reading 'name' on type pl.ivmx.department.form.Department_$$_javassist_0
    javax.el.BeanELResolver.getValue(BeanELResolver.java:98)
    javax.el.CompositeELResolver.getValue(CompositeELResolver.java:67)
    org.apache.el.parser.AstValue.getValue(AstValue.java:169)
    org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)
    org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)
    org.apache.jsp.WEB_002dINF.pages.showContacts_jsp._jspx_meth_c_005fforEach_005f0(showContacts_jsp.java:368)
    org.apache.jsp.WEB_002dINF.pages.showContacts_jsp._jspx_meth_c_005fif_005f2(showContacts_jsp.java:318)
    org.apache.jsp.WEB_002dINF.pages.showContacts_jsp._jspService(showContacts_jsp.java:137)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259)

root cause

org.hibernate.LazyInitializationException: could not initialize proxy - no Session
    org.hibernate.proxy.AbstractLazyInitializer.initialize(AbstractLazyInitializer.java:132)
    org.hibernate.proxy.AbstractLazyInitializer.getImplementation(AbstractLazyInitializer.java:174)
    org.hibernate.proxy.pojo.javassist.JavassistLazyInitializer.invoke(JavassistLazyInitializer.java:190)
    pl.ivmx.department.form.Department_$$_javassist_0.getName(Department_$$_javassist_0.java)
    sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    java.lang.reflect.Method.invoke(Method.java:601)
    javax.el.BeanELResolver.getValue(BeanELResolver.java:87)
    javax.el.CompositeELResolver.getValue(CompositeELResolver.java:67)
    org.apache.el.parser.AstValue.getValue(AstValue.java:169)
    org.apache.el.ValueExpressionImpl.getValue(ValueExpressionImpl.java:189)
    org.apache.jasper.runtime.PageContextImpl.proprietaryEvaluate(PageContextImpl.java:985)
    org.apache.jsp.WEB_002dINF.pages.showContacts_jsp._jspx_meth_c_005fforEach_005f0(showContacts_jsp.java:368)
    org.apache.jsp.WEB_002dINF.pages.showContacts_jsp._jspx_meth_c_005fif_005f2(showContacts_jsp.java:318)
    org.apache.jsp.WEB_002dINF.pages.showContacts_jsp._jspService(showContacts_jsp.java:137)
    org.apache.jasper.runtime.HttpJspBase.service(HttpJspBase.java:70)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.apache.jasper.servlet.JspServletWrapper.service(JspServletWrapper.java:432)
    org.apache.jasper.servlet.JspServlet.serviceJspFile(JspServlet.java:390)
    org.apache.jasper.servlet.JspServlet.service(JspServlet.java:334)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.springframework.web.servlet.view.InternalResourceView.renderMergedOutputModel(InternalResourceView.java:238)
    org.springframework.web.servlet.view.AbstractView.render(AbstractView.java:262)
    org.springframework.web.servlet.DispatcherServlet.render(DispatcherServlet.java:1180)
    org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:950)
    org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:852)
    org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
    org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:778)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:621)
    javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:369)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.invoke(FilterSecurityInterceptor.java:109)
    org.springframework.security.web.access.intercept.FilterSecurityInterceptor.doFilter(FilterSecurityInterceptor.java:83)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.access.ExceptionTranslationFilter.doFilter(ExceptionTranslationFilter.java:97)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.session.SessionManagementFilter.doFilter(SessionManagementFilter.java:100)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AnonymousAuthenticationFilter.doFilter(AnonymousAuthenticationFilter.java:78)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.servletapi.SecurityContextHolderAwareRequestFilter.doFilter(SecurityContextHolderAwareRequestFilter.java:54)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.savedrequest.RequestCacheAwareFilter.doFilter(RequestCacheAwareFilter.java:35)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.www.BasicAuthenticationFilter.doFilter(BasicAuthenticationFilter.java:177)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.AbstractAuthenticationProcessingFilter.doFilter(AbstractAuthenticationProcessingFilter.java:187)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.authentication.logout.LogoutFilter.doFilter(LogoutFilter.java:105)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.context.SecurityContextPersistenceFilter.doFilter(SecurityContextPersistenceFilter.java:79)
    org.springframework.security.web.FilterChainProxy$VirtualFilterChain.doFilter(FilterChainProxy.java:381)
    org.springframework.security.web.FilterChainProxy.doFilter(FilterChainProxy.java:168)
    org.springframework.web.filter.DelegatingFilterProxy.invokeDelegate(DelegatingFilterProxy.java:346)
    org.springframework.web.filter.DelegatingFilterProxy.doFilter(DelegatingFilterProxy.java:259) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:47:52.500

这里的问题是您正在尝试访问正在延迟获取的 bean 的属性。呈现视图时，与数据库的会话已经关闭。为了能够做到这一点，请将获取类型设置为或`FetchType.EAGER`使用`Open Session In View Pattern``LAZY`

如果您使用 Hibernate 作为您的 JPA 提供程序，您可能会考虑阅读此[示例](http://blog.cloudmate.pl/2010/09/hibernates-open-session-in-view-in.html)以了解如何使用 和 实现 Open Session in view`Spring MVC`模式`Hibernate`。

# php - â€™s 出现，而 不是 PHP 中的撇号 '

> ID：14665342
> 
> 赞同：2
> 
> 时间：2013-02-02T19:00:15.460
> 
> 标签：php, encoding

> **可能重复：**
> [在 PHP 中获取 â€™ 而不是撇号（'）](https://stackoverflow.com/questions/2292004/getting-a-instead-of-an-apostrophe-in-php)

我是 PHP 编程语言的新手，我需要一些帮助。当用 PHP 写入文件时，当一个撇号写入文件时，它实际上写的是 â€™s。例如，当我尝试写：

> 你好太棒了

程序改为写道：

> 你好，太棒了

我尝试了多种解决方案，但仍然无法正常工作。如果有人可以提供帮助，我将不胜感激。

编辑：好的，这就是我尝试过的：

echo mb_convert_encoding(file_get_contents($filename), "HTML-ENTITIES", "UTF-8");

结果是：\"Hello\" 而不是 "Hello"

我也试过：

$text = fgets($fp); $html = mb_convert_encoding($text, "HTML-ENTITIES", "UTF-8");

但并没有真正理解如何处理该代码

我也想从字符转换变量 $stringDatad 或从字符转换整个文件。文件名保存在 $filename

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T19:22:26.410

尝试

```
echo stripslashes(mb_convert_encoding( file_get_contents($filename), "HTML-ENTITIES", "UTF-8" )); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:46:20.097

我认为 mb_convert_encoding 需要 $to/$from_encoding 作为参数： `mb_convert_encoding($str, 'UTF-8', 'ISO-8859-1');`

字符串后面的第一个参数是`HTML-ENTITIES`有效值吗？

# mysql - 选择历年发表文章的作者

> ID：14665345
> 
> 赞同：0
> 
> 时间：2013-02-02T19:00:41.667
> 
> 标签：mysql, sql

我有一个作者表，其中包含他们的姓名、书名和出版年份。时间段如果从 2000 年到 2010 年。

我想选择在所检查的时间间隔的每一年都发表过（至少一次）的作者。我怎样才能做到这一点？好心提醒。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:10:14.713

```
select  *
from    pubs
where   author in
        (
        select  author
        from    pubs
        where   publicationYear between 2000 and 2010
        group by
                author
        having
                count(distinct publicationYear) = 11
        ) 
```

# jquery - Nivo 滑块未正确显示

> ID：14665348
> 
> 赞同：0
> 
> 时间：2013-02-02T19:00:53.713
> 
> 标签：jquery, css, nivo-slider

遇到 Nivo Slider 问题

最初加载网站时，滑块加载正常并且反应正确。当导航到另一个页面然后返回到滑块页面时，它不会加载。

我尝试在关联的 CSS 和 JS 文件中添加一个随机数函数，以尝试消除缓存，但这并没有解决问题——你能想到任何挂断的地方吗？

网站链接：已删除

让我知道您想查看什么代码（如果有的话）。

谢谢您的帮助

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-08T18:09:44.490

在 JS 和 CSS estensions 之后使用 php rand 函数修复了 Firefox 中的问题，但是由于从 Nivo JS 文件调用了 slider.xml 文件，问题仍然存在于 IE 中。在 Nivo JS 文件中添加以下代码，以修复 IE 中的问题

```
var randomNumber=Math.floor(Math.random()*1000000);
var xml = 'slider.xml' + "?" + randomNumber; 
```

再次感谢

# php - GET 参数正在获取不需要的文件扩展名

> ID：14665357
> 
> 赞同：0
> 
> 时间：2013-02-02T19:01:57.533
> 
> 标签：php, .htaccess

GET 正在获取文件扩展名以及值。这是我的 .htaccess -

```
RewriteCond %{SCRIPT_FILENAME} !-d
RewriteCond %{SCRIPT_FILENAME} !-f 
RewriteRule ^test/(.*)/(.*)/$ /Test3.php?u=$1&i=$2 [NC,L]
RewriteRule ^test/(.*)/(.*)$ /Test3.php?u=$1&i=$2 [NC,L]
RewriteRule ^test/(.*)/$ /Test3.php?u=$1 [NC,L] 
```

文件 Test3.php 是这样的 -

```
<?php
echo $_GET['u'];
echo '<br/>';
echo $_GET['i'];
?> 
```

我正在传递的网址 - [http://example.com/test/something/more/](http://example.com/test/something/more/)

我浏览器上的输出 -

```
something/more.php 
```

所需的输出在哪里

```
something
more 
```

我已经刮掉了我的整个网站来解决这个问题，但没有运气。不知道为什么我最后会得到那个 php，而[http://example.com/test/](http://example.com/test/)之后的完整值只会转到第一个参数。

请帮忙 ！

谢谢大家！我相信这个问题来自这条线。请就此提出解决方案。

```
RewriteCond %{THE_REQUEST} ^[A-Z]+\ /([^/]+/)*[^.#?\ ]+\.php([#?][^\ ]*)?\ HTTP/
RewriteRule ^(([^/]+/)*[^.]+)\.php http://www.example.com/$1 [R=301,L] 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:18:13.983

我不是 RewruteRules 方面的专家，但我知道一些正则表达式和`.*`in：

```
^test/(.*)/(.*)/$ 
```

表示它匹配任何内容，包括 /'s。

您可能想尝试：

```
RewriteRule ^test/([^/]+)/([^/]+)/?$ /Test3.php?u=$1&i=$2 [L,NC]
//removed this one because they are basically the same
//by adding '/?' it says that the slash is optional
RewriteRule ^test/([^/]+)/?$ /Test3.php?u=$1 [L,NC] 
```

有人可能想对正则表达式提出建议，但我认为它会为您服务。

**编辑**：或者你可以做类似[https://stackoverflow.com/a/14663292/1700963](https://stackoverflow.com/a/14663292/1700963)

如果有人有更好的例子，请编辑或发表评论。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:19:23.517

我发现一个页面描述了我在评论中提到的贪婪的东西： [http ://www.mspo.com/how-to/greed-in-apache-rewrite-rules.html](http://www.mspo.com/how-to/greed-in-apache-rewrite-rules.html)

# php - 如何在 html div 中显示 php 文件输出？

> ID：14665364
> 
> 赞同：0
> 
> 时间：2013-02-02T19:02:19.500
> 
> 标签：php, html, css, gallery

好的，所以我正在尝试嵌入一个 php 脚本，该脚本将图像库输出到我的 html div 容器中。然而，经过一个小时左右的搜索，我一无所知。

[http://craftedbyfrank.com/test/instagram.php](http://craftedbyfrank.com/test/instagram.php)

这是 php 库脚本的链接。

我想将它显示到该 div 内的主页上。[已删除] - 谢谢！

我尝试了以下方法，但我相信这是错误的。我没有输出。

```
 <div id="container">
 <?php include "instagram.php"; ?>
 </div> 
```

我试图避免将 php 脚本实际粘贴到 html 文件中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:08:10.260

php 没有在您的服务器上被解析。如果您查看 html 源代码，您会看到用于包含该文件的实际 php 代码。确保已安装 php，或者您没有从对您的标签进行编码的 cms 嵌入 php。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:05:28.690

您可以使用 AJAX 从 PHP 文件中获取结果并写入包含的 div。

```
$.ajax({
    type:'GET',
    url:'http://craftedbyfrank.com/test/instagram.php',
    data:'',
    success: function(data){
            $('#container').html(data);
    }
}); 
```

您可能需要调整以使您的精美盒子插件正常工作。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:12:45.827

正如@vletech 建议的那样，您可以使用`AJAX`从 php 文件中获取结果。

然而，它不起作用的主要原因是因为您试图`php`在文件中执行脚本`.html`：例如，您的页面加载在 - [/test/index.html](http://craftedbyfrank.com/test/index.html)上。为了工作，文件必须带有`.php`扩展名。

# bash - svn 从 bash 脚本提交而不打开编辑器

> ID：14665366
> 
> 赞同：4
> 
> 时间：2013-02-02T19:02:28.667
> 
> 标签：bash, svn, commit

我尝试编写一个 bash 脚本，它应该提交给一个 svn repo。一切正常，直到我尝试提交。提交命令打开编辑器，脚本以提交消息留在的错误结束`svn-commit.tmp`

我尝试了几件事，但没有一个会奏效

```
commit_msg="$1"
svn commit -m "$commit_msg" 
```

和

```
commit_msg="$1"
svn commit -m '$commit_msg' 
```

和

```
commit_msg=$1
svn commit -m '$commit_msg' 
```

以及所有与`-q`和`--non-interactive`运算符。甚至`svn commit -m "woohoo"`打开编辑器，脚本以错误结束。

任何想法为什么在不打开编辑器的情况下无法在 bash 脚本中提交？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:07:16.663

You should use the --non-interactive option on the svn command:

```
svn commit --non-interactive -m '$commit_msg' 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-03T00:35:58.943

在我尝试`svn ci`而不是之后`svn commit`，一切都很好。我的第一个想法是 svn 的错误版本。询问大转储（又名谷歌）我找到了解决方案:: 在我的 .bash_profile 中有一个代码片段，它强制总是在按预期工作`svn commit`时打开编辑器。`svn ci`

我不知道代码片段的确切来源，但 Windows 用户必须与许多神秘行为作斗争。

感谢你的帮助。

# php - 计算多个表的行数

> ID：14665367
> 
> 赞同：0
> 
> 时间：2013-02-02T19:02:33.873
> 
> 标签：php, mysql

我正在尝试做一些非常基本的事情，但无法完全弄清楚这一点。我使用的是 PHP 和 MySQLi (OOP) 而不是 MySQL。我可以使用多个单一选择语句，然后将每个数字的计数放入一个变量中，但我认为它效率低下。

好的，有几张桌子；

```
TABLE NAME: UCC_STAFF
id
email
username
password
status

TABLE NAME: UCC_TEMP_STAFF
id
email
username
password
status

TABLE NAME: UCC_TEMP_STUDENTS
id
email
username
password
status

TABLE NAME: UCC_VISITORS
id
email
username
password
status 
```

我要做的是计算每个表的行数，每行代表一个用户。正如我所解释的；使用一个表很容易，但我想将单个请求的结果组合成一个数组，而不是将多个语句组合成多个变量。

期望结果的一个例子是；

```
$a = results('UCC_STAFF' => '35',
            'UCC_TEMP_STAFF' => '12',
            'UCC_STUDENTS' => '543',
            'UCC_VISITORS'  => '6',); 
```

我想这会是什么样子；

```
$db_host = "dbhost";
$db_username = "username"; 
$db_pass = "password";
$db_name = "dbname";

$mysqli = new mysqli("$db_host", "$db_username", "$db_pass", "$db_name");

if ($mysqli->connect_errno) {
    printf("Connect failed: %s\n", $mysqli->connect_error);
    exit();
}

$query  = "SELECT * FROM UCC_STAFF;";
$query .= "SELECT * FROM UCC_TEMP_STAFF;";
$query .= "SELECT * FROM UCC_STUDENTS;";
$query .= "SELECT * FROM UCC_VISITORS";

if ($mysqli->multi_query($query)) {

// Results into $results
// How do I do this, what goes here?    

    }

// Print Array
print_r ($results); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:43:51.977

您可以执行类似的操作，通过一个查询计算来自多个表的数据。

```
$query  = "SELECT ";
$query .= "(SELECT COUNT(*) FROM UCC_STAFF) AS count_staff, ";
$query .= "(SELECT COUNT(*) FROM UCC_TEMP_STAFF) AS count_temp_staff, ";
$query .= "(SELECT COUNT(*) FROM UCC_TEMP_STUDENTS) AS count_students, ";
$query .= "(SELECT COUNT(*) FROM UCC_VISITORS) AS count_visitors"; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:08:14.547

创建**一张**表

```
TABLE NAME: UCC_PEOPLE
id
email
username
password
status
type <-- use this field to distinguish different types 
```

运行**一个**查询以获取记录**数**，而不是记录本身

```
SELECT type, count(*) cnt, FROM UCC_PEOPLE GROUP BY type 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:44:28.630

我想你正在寻找这样的东西`UNION`

```
 $query  =(  (SELECT CONCAT('UCC_STAFF', '')as UCC_STAFF ,count(*)as count from UCC_STAFF )

              UNION ALL
              (SELECT CONCAT('UCC_TEMP_STAFF', '')as UCC_TEMP_STAFF ,count(*) from UCC_TEMP_STAFF )

              UNION ALL
              (SELECT CONCAT('UCC_TEMP_STUDENTS', '')as UCC_TEMP_STUDENTS ,count(*) from  UCC_TEMP_STUDENTS )

              UNION ALL
              (SELECT CONCAT('UCC_VISITORS', '')as UCC_VISITORS ,count(*) from UCC_VISITORS ) ); 
```

[**在这里演示 SQLFIDDLE**](http://www.sqlfiddle.com/#!2/8d4e3/4)

# javascript - Backbone JS - 如何编写可重用的组件

> ID：14665370
> 
> 赞同：3
> 
> 时间：2013-02-02T19:02:53.570
> 
> 标签：javascript, backbone.js, backbone-views, backbone-events

我想编写一个可重用的组件作为我的 Backbone 应用程序的一部分。从根本上说，我想编写一个表单过滤器助手，这样我就可以：

*   在视图 js 文件中调用一个 func 函数，该函数将创建一个下拉列表，该下拉列表可以监听更改，然后触发数据更改并刷新视图。

最终我希望能够做这样的事情：

```
// generic view.js

// to spawn a dropdown
formFilter('select', data);

// to spawn a series of checkboxes
formFilter('checkbox', data); 
```

显然，模块代码会监听事件并处理工作。

我的问题是，创建可重用组件的标准方法是什么？谷歌没有给我太多，#documentcloud IRC 也不是特别活跃。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:15:31.240

根据您在问题中提供的信息，很难说出您的特定组件将如何最好地组件化。然而，一种强大的可重用策略是**mixins**。

只需在简单的对象字面量中定义方法，例如：

```
Mixins.filterable = {
  filterForm: function(selector, data) {
    this.$(selector)...
  }
}

Mixins.sortable = {
  sortForm: function(selector) {
    this.$(selector)...
  }
} 
```

然后你可以将它们混合到任何`View`的原型中：

```
_.extend(FooView.prototype, Mixins.filterable, Mixins.sortable); 
```

然后，mixin 方法将在`FooView`.

```
render: function() {
  //..
  this.filterForm('select', this.model);
} 
```

因为 mixin 方法将绑定到视图实例的上下文，所以您可以在 mixin 方法中引用`this`，并通过逻辑扩展，`this.$el`。这将使您能够监听视图的事件：

```
Mixins.filterable = {
  filterForm: function(selector, data) {
    this.$(selector).on('change', this._handleFilterChange);
  },

  _handleFilterChange: function(e) {
    //..
  }      
} 
```

要使这些方法在所有视图上可用，请将它们混合到`Backbone.View`原型中：

```
_.extend(Backbone.View.prototype, Mixins.filterable, Mixins.sortable); 
```

# java - 安装 java,ide 并创建一个示例 Web 应用程序

> ID：14665376
> 
> 赞同：-4
> 
> 时间：2013-02-02T19:03:16.400
> 
> 标签：java, macos

我最近收到了一个 macbook pro。我想学习 java、jsp 并在我的本地机器上开发一些示例 Web 应用程序。谁能给我一个特定的链接，我可以在我的 Mac Os 上执行以下操作以开始：

*   安装 Java
*   安装 IDE。
*   设置tomcat
*   创建包含 java、jsp 的学习示例程序的教程连接到本地数据库并在我的本地 Web 浏览器中进行测试。

我知道网络上有很多不同的说明，如果这里的一些专家指出我最好的入门方法，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:06:24.720

1.  已经安装在 Mac 上

2.  我建议将[IntelliJ](http://www.jetbrains.com/idea/)或[Eclipse](http://www.eclipse.org/)作为优秀 Java IDE 的两个示例。两者都对用 Java 开发 Web 应用程序提供了很好的支持。IDE 问题可能永无止境，因此它确实是一个适合您的案例。

3.  对于 Tomcat，您无法击败[这些](http://tomcat.apache.org/)说明。

4.  每个框架都有自己的指令。也许从 Spring 或 Play 开始！对于java

# python - 从文本文件中获取数据并将其放入 numpy 数组中

> ID：14665379
> 
> 赞同：0
> 
> 时间：2013-02-02T19:03:24.460
> 
> 标签：python, numpy

我需要一些帮助，从 .txt 文件中获取数据并将其放入数组中。我对 Python 有一个非常基本的了解，并且我已经阅读了与我的问题相关的线程中的文档，但是经过数小时的尝试，我仍然无法到达任何地方。我文件中的数据如下所示：

> > 0.000000000000000000e+00 7.335686114232199684e-02
> > 
> > 1.999999999999999909e-07 7.571960558042964973e-01
> > 
> > 3.999999999999999819e-07 9.909475704320810374e-01
> > 
> > 5.999999999999999728e-07 3.412754086075696081e-01

我用过`numpy.genfromtxt`，但得到以下输出：`array(nan)`

你能告诉我这样做的正确方法是什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:18:52.663

仅供参考 -`numpy.genfromtxt`即使使用空行， using 也会做正确的事情。

也许分享你的代码。

```
In [289]: numpy.genfromtxt('afile')
Out[289]:
array([[  0.00000000e+00,   7.33568611e-02],
       [  2.00000000e-07,   7.57196056e-01],
       [  4.00000000e-07,   9.90947570e-01],
       [  6.00000000e-07,   3.41275409e-01]])

In [290]: !cat afile
0.000000000000000000e+00 7.335686114232199684e-02

1.999999999999999909e-07 7.571960558042964973e-01

3.999999999999999819e-07 9.909475704320810374e-01

5.999999999999999728e-07 3.412754086075696081e-01 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:13:34.073

`numpy.loadtxt()`是您正在寻找的功能。这将返回一个二维数组。

# .htaccess - htaccess 帮助重命名目录

> ID：14665384
> 
> 赞同：-1
> 
> 时间：2013-02-02T19:03:49.910
> 
> 标签：.htaccess, rename, directory

我有 2 个目录，我想在不丢失搜索排名的情况下重命名它们。这是 url 约定和建议的名称更改：

旧：mysitename.com/folder1/folder2/filenames

到

新：mysitename.com/newfoldername1/newfoldername2/filenames

文件名是每个页面的给定名称

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T00:23:35.827

`RewriteRule ^(.*)/folder1/folder2/(.*)$ $1/newfoldername1/newfoldername2/$2 [R,L]`

这个规则的问题是 RewriteRules 只匹配路径，而不是域。您`(.*)/`在规则的前面有 ，就好像您正在尝试匹配域一样，这不是必需的。您还将其设置为重定向而不是重写...也许这就是您想要的，在这种情况下，请保留“R”标志，但我会在下面的代码中将其删除，以防您只是想重写。修改规则如下，它应该工作：

`RewriteRule ^newfoldername1/newfoldername2/(.*)$ /folder1/folder2/$1`

编辑：既然您已经发布了其他规则，我删除了`[L]`并将顺序颠倒到我认为您正在尝试做的事情。

编辑 2：上述规则假设您希望用户输入`domain.com/newfoldername1/newfoldername2/whatever`被静默重写为`domain.com/folder1/folder2/whatever`. 您最新评论的措辞表明您希望将输入的用户`domain.com/folder1/folder2/whatever`重定向（换句话说，在他们的浏览器中更改地址），`domain.com/newfoldername1/newfoldername2/whatever`并且服务器已准备好处理此新路径。在这种情况下，需要以下规则：

`RewriteRule ^folder1/folder2(/.*)?$ /newfoldername1/newfoldername2$1`[R=301,L]

# php - php数组电话号码字段存储为int

> ID：14665387
> 
> 赞同：0
> 
> 时间：2013-02-02T19:04:10.573
> 
> 标签：php, arrays, phone-number

我有一个包含一些用户数据的 MySQL 表，我需要对其进行更正并迁移到一个新的 MySQL 表。我使用“Geoffray Warnants”中的“Export to PHP Array plugin for PHPMyAdmin”导出了表格，它返回了一个（PHP）数组。

其中一个字段包含电话号码。现在一些条目已导出为字符串。但是，某些条目将电话号码表示为整数。当我尝试读取数字时，它会返回如下内容：

```
4.36991052022E+12 
```

什么时候应该：

```
4369910520219 
```

我想整数值太大了，所以这一定是问题所在。（这就是 E+12 的原因）我有近 300 个条目，我无法手动在数字的前面和结尾写引号，因为我还有一个传真字段。

最近，我尝试（在演示 sublime text 2 的帮助下）通过在数字前面写（字符串）来投射数字 - 它不起作用。

我现在有点无助，请求你的帮助。我能做些什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:07:03.350

请看一下这个问题，它应该回答你的问题：

[在 PHP 中将一个大整数转换为一个完整的字符串](https://stackoverflow.com/questions/9621792/convert-a-big-integer-to-a-full-string-in-php)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T20:39:28.947

由于我没有时间了解安装 GMP 库的“复杂”过程，因此我决定将其变成老派，并在每个电话号码值前面加上双引号（“”），无论是是一个字符串或“大整数”，并从最终字符串中删除（单）引号。感谢 Sublime Text 2！

所以我有：

```
array(..., 'phone'=>' 43 664 1000383', ...); 
```

和

```
array(..., 'phone'=>4369910520219, ...); 
```

> 搜索并查找所有**'phone'=>**并在之后添加**“** 然后搜索（在我的情况下）**，'fax'=>**并预先添加**”** 对于每个字符串

```
preg_replace("/\'/i", "", $user["phone"]); 
```

不过感谢图书馆。我可能有一天会真正使用它。;)

问候，约瑟夫

# python - 如何摆脱我在 Python 中的循环（并缩短我的代码）？

> ID：14665390
> 
> 赞同：0
> 
> 时间：2013-02-02T19:04:54.757
> 
> 标签：python, loops, goto

我开始学习一般的编程，到目前为止，我最难理解的是如何以正确的方式摆脱我的循环，而不是使用“goto”。我听说这是不好的做法。我知道 Python 没有“goto”功能，但如果有，这是我知道如何摆脱以下循环的唯一方法，无论它使用什么语言。循环让我感到困惑。另外，我不喜欢在编程时使用多少重复代码，但我真的不知道如何避免它。可能是通过使用函数，但我不太了解它们。

有人可以看看我的代码并指导我如何使其正常工作吗？唯一的问题是最后当它询问用户是否愿意进行更多更改时，当我输入“y”时，它会进入一个无限循环，说“祝你有美好的一天”。我希望它返回并要求用户再次在选项 AB 和 C 之间进行选择。其他一切似乎都在工作。如果你也可以帮助我缩短我的代码，那就太好了。谢谢！

```
#Global variables
more='y'
#Enter your name
name = raw_input("What is your first name? \n")
##print('Your first name is ') + name
lastName = raw_input("What is your last name? \n")
##print('Your last name is ') + lastName
##raw_input('Press enter to continue...')
fullName = name + " " + lastName
nameList = list(fullName)
print('Your full name is ') + fullName + '. Would you like to \
edit your name? If yes, type "y" and if no type "n".\n'
ans = raw_input()
#Check if changing the name
while more != 'n':
    if ans == 'y':
        ans=raw_input('Would you like to A) change a letter B) remove a \
letter or C) add a letter?\
\n\n(Note: For all changes write the position of the letter to be affected \
starting at 1 and going from left to right.)\n')       
#If yes, change the name       
        if ans=='A' or ans=='a':
        #Change letter
            change=input('Which letter would you like to change? ')
            change -= 1
            ans=raw_input('What would you like to change it to? ')
            nameList[change]=ans
            #Change the name
            fullName = ''.join(nameList)
            #Check if you want more changes
            more=raw_input("Your name is now " + fullName + ".\n" + "Would you \
like to do anything else? Type 'y' if yes or 'n' if no. ")           
        elif ans=='B' or ans=='b':
        #Remove letter
            remove=input('Which letter would you like to remove? ')
            remove -= 1
            del nameList[remove]
            #Change the name
            fullName = ''.join(nameList)
            #Check if you want more changes
            more=raw_input("Your name is now " + fullName + ".\n" + "Would you \
like to do anything else? Type 'y' if yes or 'n' if no. ")           
        elif ans=='C' or ans=='c':
        #Add letter
            add=input('After which letter would you like to add one? ')
            ans=raw_input('What letter would you like to add? ')
            nameList.insert(add,ans)
            #Change the name
            fullName = ''.join(nameList)
            #Check if you want more changes
            more=raw_input("Your name is now " + fullName + ".\n" + "Would you \
like to do anything else? Type 'y' if yes or 'n' if no. ")            
#Otherwise say goodbye
    else:
        print('Have a nice day.') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:10:08.743

我只是将剩下的学习过程留给你，然后说：看看`break`& `continue`，也许你会知道如何解决问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:20:54.047

我想这就是你想要的。

最大的变化是变量 more 设置在循环中，就在 if 块之后，因此不需要重复该部分 3 次。此外，如果 ans = "n"，程序会立即退出（我想这就是你想要做的）。

```
from sys import exit

more='y'
name = raw_input("What is your first name? ")
lastName = raw_input("What is your last name? ")
fullName = '%s %s' % (name, lastName)
nameList = list(fullName)

print 'Your full name is %s. Would you like to edit your name? If yes, type "y" and if no type "n".\n' % fullName
ans = raw_input()
if ans == 'n':
    print('Have a nice day.')
    exit(0)

while more != 'n':

    ans=raw_input('Would you like to A) change a letter B) remove a \
letter or C) add a letter?\
\n\n(Note: For all changes write the position of the letter to be affected \
starting at 1 and going from left to right.)\n')       
    if ans in ('A','a'):
        change=input('Which letter would you like to change? ')
        change -= 1
        ans=raw_input('What would you like to change it to? ')
        nameList[change]=ans
        fullName = ''.join(nameList)
    elif ans in ('B','b'):
        remove=input('Which letter would you like to remove? ')
        remove -= 1
        del nameList[remove]
        fullName = ''.join(nameList)
    elif ans in ('C','c'):
        add=input('After which letter would you like to add one? ')
        ans=raw_input('What letter would you like to add? ')
        nameList.insert(add,ans)
        fullName = ''.join(nameList)

    more=raw_input("Your name is now " + fullName + ".\n" + "Would you \
like to do anything else? Type 'y' if yes or 'n' if no. ") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:09:18.340

要退出循环，您可以`break`，或者将循环放入函数中并`return`退出循环（和函数），或者，确保在准备退出时可以在循环内更改退​​出条件。你正在尝试做第三个，它几乎可以工作了。您的代码的问题在于，条件`if ans='y' ... else: print('Have a nice day')`应该在循环之外，而条件却在循环内部，并且您还通过重用变量 name 来混淆事情`ans`。无论如何，您可以将该`if`条件与以下条件结合起来`while`：

```
name = raw_input("What is your first name? \n")
last_name = raw_input("What is your last name? \n")
full_name = name + " " + last_name
edit = raw_input('Your full name is %s. Would you like to edit your name? \
If yes, type "y" and if no type "n" ' % full_name).lower()

while edit != 'n':
    option = raw_input("""Would you like to A) change a letter B) remove a \
letter or C) add a letter?\n\n(Note: For all changes write the position of the \ 
letter to be affected starting at 1 and going from left to right.)\n""").lower()
    if option == 'a':
        change = int(raw_input('Which letter would you like to change? '))
        to = raw_input('What would you like to change it to? ')
        full_name = full_name[:change-1] + to + full_name[change:]
    elif option == 'b':
        remove = int(raw_input('Which letter would you like to remove? '))
        full_name = full_name[:remove-1] + full_name[remove:]
    elif option == 'c':
        after = int(raw_input('After which letter would you like to add one? '))
        letter = raw_input('What letter would you like to add? ')
        full_name = full_name[:after] + letter + full_name[after:]
    edit = raw_input("""Your name is now %s.\n Would you like to do \
anything else? Type "y" if yes or "n" if no. """ % full_name).lower()
print "Have a nice day." 
```

无需将字符串转换为字符列表即可对其进行编辑，因此我已对其进行了更改，但如果（例如）您将其用作练习来学习列表操作，那么您可能希望将其放回原处。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T23:42:11.903

将循环重构为函数是逃避嵌套循环的好方法。有时虽然我需要一个快速而肮脏的解决方案，但对于这个例外是一个很好的工具。

```
try:
  while True:
    #some logic
    while True:
      #some logic
      if condition:
        raise Exception
except Exception:
  pass #or something else 
```

如果您发现编码后需要跳出循环并且不想重构为函数，则可以使用此方法跳出深度循环。

# ruby - 学习 tk/tile 的资源

> ID：14665393
> 
> 赞同：1
> 
> 时间：2013-02-02T19:05:14.427
> 
> 标签：ruby, user-interface, tk, tile

除了 Ruby-Doc 之外，还有哪些来源可以最好地获取一些示例和教程，尤其是关于 Ruby 中的 Tk/Tile？我发现自己更正常

*   [http://www.tutorialspoint.com/ruby/ruby_tk_guide.htm](http://www.tutorialspoint.com/ruby/ruby_tk_guide.htm)
*   [http://www.perfectxml.com/syngress/ruby/Page1.asp](http://www.perfectxml.com/syngress/ruby/Page1.asp)

但是信息很模糊，没有太多可以学习的东西。我不得不咨询多个来源。我从 O'Reilly Media 找到了两本书：

*   [http://shop.oreilly.com/product/9781565924987.do](http://shop.oreilly.com/product/9781565924987.do)
*   [http://shop.oreilly.com/product/9781565924338.do](http://shop.oreilly.com/product/9781565924338.do)

但不知道这是否是正确的开始。甚至 Lynda.com 也没有什么有趣的东西可供研究。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T23:23:39.737

我所知道的学习 Tk 的最佳网站是[TkDocs](http://www.tkdocs.com/)，它有一个涵盖多种语言的[教程，包括 Ruby。](http://www.tkdocs.com/tutorial/index.html)（要仅查看 Ruby 版本，请在侧栏中设置语言。或者，将其保留为“所有语言”的默认设置，以了解其他语言如何绑定同一库；差异可能很明显……）

# embedded - 如何保持中断时间短？

> ID：14665397
> 
> 赞同：11
> 
> 时间：2013-02-02T19:05:42.927
> 
> 标签：embedded, arm, interrupt, firmware, interrupt-handling

嵌入式编程中听到最多的建议是“保持中断短”。

现在我的情况是，我的 main() 循环中有一个运行时间很长的任务（将大块数据写入 SD 卡），有时可能需要 100 毫秒。所以为了让我的系统保持响应，我把所有其他的东西都移到了中断处理程序中。

例如，通常会在中断中处理传入的 UART 数据，然后在 main() 循环中处理传入的命令，然后发回响应。但就我而言，命令的整个处理/处理也发生在中断中，因为我的 main() 循环可以（相对）长时间阻塞。

最佳解决方案是切换到 RTOS，但我没有 RAM。我的设计是否有中断可以很短的替代方案？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T19:20:28.273

传统的方法是让中断安排一个延迟的过程并尽快结束中断。

一旦中断完成，延迟过程的列表就会从最重要到最不重要。

考虑这样一种情况，您有主要（较低优先级）操作，以及两个中断 I1 和 I2，其中 I2 比 main 更重要，但不如 I1 重要。

在这种情况下，假设您正在运行 main 并且 I1 触发。I1 安排一个延迟的过程并向硬件发出 I1 已完成的信号。I1 的 DPC 现在开始运行。突然，I2 来自硬件。I2 的中断从 I1 的 DPC 接管并调度 I2 的 DPC 并向硬件发出它已完成的信号。

然后调度器返回到 I1 的 DPC（因为它更重要），当 I1 的 DPC 完成时，I2 的 DPC 开始（因为它比 main 更重要），然后最终返回执行到 main。

这种设计允许您安排不同中断的重要性，鼓励您保持较小的中断，并允许您以有序和按优先级的方式完成 DPC。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-02-02T20:18:19.227

根据 CPU 架构（中断嵌套和优先级、软件中断支持等），有 100 种不同的方法可以给这只猫换皮，但让我们采用一种相对简单易懂且不受竞争条件和资源共享的直接方法抢占式内核的危害。

（免责声明：我的首选通常是抢占式实时内核，其中许多可以在资源极其受限的系统中运行……SecurityMatt 的建议很好，但如果您不习惯实现自己的抢占式内核/任务切换器，尤其是一个处理异步（中断触发）抢占，你可以很快地绕在轴上。所以我在下面提出的不如基于抢占的内核响应迅速，但它更简单且通常足够）。

创建 3 个事件/工作队列：

*   Q1 是最低优先级，处理缓慢的后台 SD 卡写入
*   Q2 持有处理传入 UART 数据包的请求
*   Q3（最高优先级）保存 UART RX FIFO 读取请求。

我将 UART RX FIFO 读取和读取数据包的处理分开，以便始终在数据包处理之前为 FIFO 读取提供服务；也许你想让它们在一起，你的选择。

**为此，您将大型（约 100 毫秒）SD 卡写入过程分解为一组较小的、离散的、运行到完成的步骤**。

例如，要写入 5 个块，每个 20 毫秒，您写入第一个块，然后将“写入下一个块”排入队列到 Q1。您在每个步骤结束时返回调度程序并按优先级顺序扫描队列，从 Q3 开始。如果 Q2 和 Q3 为空，则将下一个事件从 Q1 中拉出（“写入下一个块”），然后再运行该命令 20 毫秒，然后再返回并再次扫描队列。如果 20 毫秒的响应不够快，您可以将每个 20 毫秒的块写入分解为一组更细粒度的步骤，不断将下一个工作步骤发布到 Q1。

现在对于传入的 UART 的东西；在 UART RX ISR 中，您只需在 Q3 中将“读取 UART FIFO”命令排入队列，然后从中断返回到被中断的 20 毫秒“写入块”步骤。一旦 CPU 完成写入，它就会返回并按优先级顺序扫描队列（如果块写入在中断时刚刚开始，最坏情况下的响应将是 20 毫秒）。队列扫描器（调度器）将看到 Q3 现在有工作要做，它会在返回并再次扫描之前运行该命令。

在最坏的情况下，系统中的响应能力将取决于系统中最长的运行到完成步骤，而不管优先级如何。通过在小的、离散的、运行到完成的步骤中进行工作，您可以保持系统的响应速度非常快。

请注意，我必须在这里泛泛而谈。也许您想读取 ISR 中的 UART RX FIFO，将数据放入缓冲区，并且只延迟数据包处理，而不是实际读取 FIFO（那么您只有 2 个队列）。你必须自己解决这个问题。但我希望这种方法是有意义的。

这种具有优先队列的事件驱动方法正是[Quantum 平台 (QP) 事件驱动框架](http://www.state-machine.com)使用的方法。QP 实际上支持底层的非抢占式（协作式）调度程序，例如这里描述的，或者在每个事件排队时运行调度程序的抢占式调度程序（类似于 SecurityMatt 建议的方法）。您可以在 QP 网站上查看 QP 协作调度程序的代码/实现。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-04T13:56:04.210

另一种解决方案如下：

在 FAT 库可以长时间捕获处理器的任何地方，您插入一个对新函数的调用，该函数通常非常快，并在几个机器周期后返回给调用者。如此快速的功能不会影响您耗时操作的实时性能，例如读取/写入 SD Flash。您将在等待擦除闪存扇区的任何循环中插入此类调用。您还可以在每写入 512 个字节或读取 512 个字节之间插入对此类函数的调用。

该函数的目标是执行您通常在嵌入式设备的典型“main()”中的“while(1)”循环中执行的大部分任务。它首先会增加一个整数并对新值执行快速模运算，然后如果模不等于任意常数则返回。代码如下：

```
void premption_check(void)
{
    static int fast_modulo = 0;
    //divide the number of call
    fast_modulo++;
    if( (fast_modulo & 0x003F) != 3)
    {
        return;
    }
    //the processor would continue here only once every 64 calls to "premption_check" 
```

接下来，您调用从串行端口中断中提取 RS232 字符/字符串的函数，如果收到完整的字符串则处理任何命令等

上面使用的二进制掩码 0x3F 意味着我们只查看计数器的 6 个最低有效位。当这 6 位恰好等于任意值 5 时，继续调用可能需要一些微秒甚至毫秒才能执行的函数。您可能需要尝试更小或更大的二进制掩码，具体取决于您希望为串行端口和其他操作提供服务的速度。您甚至可以同时使用多个面罩来比其他面罩更快地为某些操作提供服务。

例如，当两次 Flash 擦除操作之间发生一些零星延迟时，FAT 库和 SD 卡应该不会遇到任何问题。

这里给出的解决方案甚至适用于只有 2K 字节的微控制器，就像 8051 的许多变体一样。尽管看起来令人难以置信，1980 到 1990 年的弹球机只有几 K 的 RAM，处理器速度很慢（比如 10 MHz）他们可以测试一百个开关……完全去抖，更新 X/Y 矩阵显示，产生声音效果等这些工程师开发的解决方案仍然可以用来提高大型系统的性能。即使拥有 64 Gig RAM 和许多 TB 硬盘的最好的服务器，我认为当某些公司想要索引数十亿个 WEB 页面时，任何字节都算数。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-04T10:46:17.757

由于没有人建议从这一端开始，但我会把它扔在帽子里：

将**SD 卡服务例程**置于低优先级中断中，如果可以的话，可能会抛出一些 DMA，这可能会释放主循环和其他中断以提高响应速度，而不是卡在 main() 循环等待中很长时间来完成某件事。

对此的警告是，我不知道当 SD 卡准备好更多时硬件是否有任何方式触发中断，您可能必须通过运行轮询计时器来检查并强制中断来作弊。不过，我不在这种事情之上，如果你有备用的硬件定时器和中断，它可以用很少的开销来完成。

为这样的事情诉诸 RTOS 似乎有点矫枉过正，而且我承认失败了……；）

# java - 为什么这个分隔符不能正常工作？

> ID：14665404
> 
> 赞同：2
> 
> 时间：2013-02-02T19:06:18.440
> 
> 标签：java, string, delimiter

好的，所以我们应该制作一个程序，它可以简单地读取格式为 mm/dd/yyyy 的日期的正确输入。到目前为止，我所学到的只是 if-else 语句、枚举的一些内容、字符串处理、switch 语句，仅此而已。我认为解决此问题的最佳方法是使用 / 分隔符来分别捕获每个月的日和年输入，但是当我运行您在下面看到的内容时，程序实际上会在您输入后停止，例如 1985 年 5 月 16 日......澄清程序实际上仍在运行，但没有任何反应（即预期的字符串过程及其值的输出）。一旦我输入日期，它什么也不做，我想知道为什么？分隔符不起作用吗？我是否正在考虑以错误的方式使用分隔符？它让我发疯，哈哈，任何建议都会很好！

还想补充一点，我尝试了在分隔符之后创建字符串（如下所示）和尝试使用 nextInt 捕获 INT 值.....仍然做同样的事情，并且在初始日期输入后没有任何反应。 ...

```
Scanner keyboard = new Scanner(System.in);

keyboard.useDelimiter("/");

String month = keyboard.next();
String day = keyboard.next();
String year = keyboard.next();

int monthi = Integer.parseInt(month);
int dayi = Integer.parseInt(day);
int yeari = Integer.parseInt(year);

System.out.println(monthi);
System.out.println(dayi);
System.out.println(yeari); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:08:44.953

更改您的分隔符以包括换行符：

```
keyboard.useDelimiter("[/\n]"); 
```

这样你的最后一个`.next()`电话就会有一些东西需要解析。您还可以使用`keyboard.hasNext()`来确定是否还有任何要解析的内容（如果没有，您可能需要处理这种情况，因为输入了无效的日期）。

您的代码在当前状态下永远运行的原因是您正在使用 3 个`next()`调用，但仅提供 2个调用，`\`当您以以前的方式添加第 3 个时，您的程序将终止`\`，但通过在事物列表中添加换行符分隔（`\n`字符）最后一次`next()`调用将拉出最后一个斜杠和换行符之间的内容。

# php - php从数组垂直创建表

> ID：14665414
> 
> 赞同：-3
> 
> 时间：2013-02-02T19:07:16.220
> 
> 标签：php, arrays, html

嗨，我在[这里找到了这个问题](https://stackoverflow.com/questions/6047757/php-create-table-from-array) ，但它并不完全符合我的要求。

我希望表格改为这样显示：

```
 **     | array1         | array2 
           -------------------------------
 logtime   | 1305732210     | 1305732216
           -------------------------------
 useragent | Mozilla        | Mozilla
           ------------------------------- 
```

编辑：

我不发布代码很糟糕，但这是我坚持的。

我有这个查询，它从 mysql 输出一组数据

```
SELECT s.*, m.id AS wmMake
                                  FROM `table1` AS s
                                  JOIN `table2` AS m
                                  WHERE s.code = m.code
            AND (s.ic='123'
            OR s.ic='1234" 
```

它的输出看起来像这样

```
Array ( [0] => PAS [cat] => PAS [1] => H4B12A [ic] => H4B12A [2] => SMALL [segment] => SMALL [3] => 6 [wmMake] => 6 ) 
Array ( [0] => PAS [cat] => PAS [1] => HUV12A [ic] => HUV12A [2] => SMALL [segment] => SMALL [3] => 6 [wmMake] => 6 ) 
```

现在在我的php方面我有这个：

```
for ($i =0; $c = mysql_fetch_array($query); $i++)
{
   print_r($c); 
} 
```

for 循环，一次循环遍历 1 行，我如何遍历每一行，并获取第一个值，然后再每行获取数组的第二个值，依此类推。我的 html 输出应该是这样的。

```
 **     | array1         | array2 
           -------------------------------
 cat       | PAS            | PAS
           -------------------------------
 ic        | H4B12A         | HUV12A
           -------------------------------
 segment   | SMALL          | SMALL
           -------------------------------
  wmMake   | 6              | 6 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T19:11:31.137

1.  知道如何构建 HTML 表格
2.  知道如何使用`arrays`以及它们如何与`keys`和一起使用`values`。
3.  知道如何使用`for`循环或`foreach`循环`arrays`。
4.  结合上面的知识，创造你想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:15:35.203

假设您可以确定两个/所有数组都具有完全相同的键，您可以使用 foreach：

```
foreach ($array1 as $key => $value)
{
   echo '<tr>';
   echo '<td>'.$key.'</td>';
   echo '<td>'.$array1[$key].'</td>';
   echo '<td>'.$array2[$key].'</td>';
   // ... etc
   echo '</tr>';
} 
```

然而，我会注意到 Mike de Klerk 的回答是相关的，不应忽视——StackOverflow 不是为您编写代码或教您如何编写代码，它是为了获得有关您所坚持的特定事物的答案。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:20:42.113

首先获取数组键。然后遍历键并回显两个数组中的值。

```
$keys = array_keys($arr1, $arr2);

echo "<table>";
foreach($keys as $k) {
    echo "<tr>";
    echo "<td>".$k."</td>";
    echo "<td>".$arr1[$k]."</td>";
    echo "<td>".$arr2[$k]."</td>";
    echo "</tr>";
}
echo "</table>"; 
```

# r - 从数据框创建逻辑向量

> ID：14665417
> 
> 赞同：5
> 
> 时间：2013-02-02T19:07:24.747
> 
> 标签：r, dataframe

我有一个名为 y 的数据框

```
dput(y)
structure(list(val1 = c(25L, 615L, 30L, 76L, 97L, 211L, 0L, 40L, 
10L, 10L), val2 = c(101L, 286L, 124L, 77L, 176L, 120L, 0L, 8L, 
56L, 49L), val3 = c(157L, 454L, 106L, 242L, 144L, 31L, 0L, 40L, 
45L, 57L)), .Names = c("val1", "val2", "val3"), row.names = c(NA, 
10L), class = "data.frame") 
```

我希望能够查看 val1 和 val2 列，如果 val1>10，则将值替换为 TRUE 否则为 FALSE 并查看 val2，如果 val2<5，则将值替换为 TRUE 否则为 FALSE

我可以使用子集函数来选择它们，但不是使用子集，我喜欢用 TRUE 或 FALSE 替换值，有什么想法可以做到这一点吗？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-02T19:11:52.380

只需使用布尔运算符：

```
y$val1 > 10 | (y$val1 <=10 & y$val2<5)
# [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE FALSE 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-02-02T19:28:04.767

```
 transform(dat, x= val1 > 10 , y = val2 < 5)
   val1 val2 val3     x     y
1    25  101  157  TRUE FALSE
2   615  286  454  TRUE FALSE
3    30  124  106  TRUE FALSE
4    76   77  242  TRUE FALSE
5    97  176  144  TRUE FALSE
6   211  120   31  TRUE FALSE
7     0    0    0 FALSE  TRUE
8    40    8   40  TRUE FALSE
9    10   56   45 FALSE FALSE
10   10   49   57 FALSE FALSE 
```

# django - Django-Registration：创建要求名字/姓氏的帐户？

> ID：14665420
> 
> 赞同：1
> 
> 时间：2013-02-02T19:07:39.427
> 
> 标签：django

这个问题是 Muki 在这里解释的解决方案的后续：

[将自定义字段添加到 django-registration 时出现问题](https://stackoverflow.com/questions/2934867/problem-in-adding-custom-fields-to-django-registration/14660348#14660348)

我已经安装并成功使用了 Django-registration 包。默认情况下，当您使用此软件包创建帐户时，它会询问您的用户名、电子邮件地址和密码。我希望它还要求（可选）名字+姓氏。Muki 在上面链接中的回答解释了如何做到这一点。

然而，Muki 忽略了他在 custom/forms.py 中创建的文件中应该包含的内容。我需要知道我应该在这里创建的类的名称是什么以及字段定义应该是什么样子。

有人可以发布一个示例 forms.py ，我可以用它来完成我想要做的事情吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:44:50.460

如果您的自定义后端位于`custom`文件夹中，则`custom/forms.py`可能是这样的：

```
from django import forms
from registration.forms import RegistrationForm

class RegistrationFormWithName(RegistrationForm):
    first_name = forms.CharField(required=False)
    last_name = forms.CharField(required=False) 
```

这会将您的两个可选字段添加到默认注册表单中。要告诉您的自定义后端使用这种新形式而不是默认形式，您需要更改[Muki 答案](https://stackoverflow.com/a/2935578/2035785)`get_form_class`中的方法，解释了如何做到这一点。`custom/__init__.py`

当然，您还需要处理保存`first_name`和`last_name`字段中的数据。

**编辑**：

您`custom/__init__.py`需要看起来像这样：

```
from registration.backends.default import DefaultBackend
from registration.backends.custom.forms import RegistrationFormWithName

class CustomBackend(DefaultBackend):
    def get_form_class(self, request):
        return RegistrationFormWithName 
```

并且`custom/urls.py`需要这样的一行：

```
url(r'^register/$', register, {'backend': 'registration.backends.custom.CustomBackend'}, name='registration_register'), 
```

将两个文件中的类名称更改为`CustomBackend`您调用的新后端。

查看[默认后端源](https://bitbucket.org/ubernostrum/django-registration/src/27bccd108cdef30dc0a91ed1968be17bb1e60da4/registration/backends/default/__init__.py?at=default)以了解您可以覆盖的其他方法。希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-07-02T05:30:53.137

此[链接](http://johnparsons.net/index.php/2013/06/28/creating-profiles-with-django-registration/#comment-456) 很好地解释了该过程并与 django-registration 1.0 一起使用

除了上面的代码之外，这里还有一些额外的指针。

要更新名字，请在 models.py 中进行更改

```
def user_registered_callback(sender, user, request, **kwargs):
profile = ExUserProfile(user = user)
profile.is_human = bool(request.POST["is_human"])
user.first_name = request.POST["firstname"]
user.save()
profile.save()

user_registered.connect(user_registered_callback) 
```

并在 forms.py 文件中

```
class ExRegistrationForm(RegistrationForm):
    is_human = forms.BooleanField(label = "Are you human?:")
    firstname = forms.CharField(max_length=30)
    lastname = forms.CharField(max_length=30) 
```

最后看到表格上的变化创建一个合适的模板。通过在您的应用程序中创建一个名为 admin.py 的文件并编写以下代码，可以在管理员中看到该配置文件

```
from django.contrib import admin
from django.contrib.auth.models import User
from django.contrib.auth.admin import UserAdmin
from prof.models import ExUserProfile

admin.site.unregister(User)

class UserProfileInline(admin.StackedInline):
    model = ExUserProfile

class UserProfileAdmin(UserAdmin):
    inlines = [ UserProfileInline, ]

admin.site.register(User, UserProfileAdmin) 
```

# php - 为什么我会收到“调用未定义函数 get_filenames()”？

> ID：14665422
> 
> 赞同：0
> 
> 时间：2013-02-02T19:07:53.487
> 
> 标签：php, codeigniter

我正在尝试使用[url 帮助](http://ellislab.com/codeigniter/user-guide/helpers/file_helper.html)程序获取文件名列表，但出现以下错误：

> 调用未定义函数 get_filenames()

我自动加载了 url 帮助程序，然后将其显式加载到控制器中，但仍然出现错误。为什么我会收到此错误？

控制器：

```
<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Downloads extends CI_Controller {

    public function index()
    {   
        $this->load->helper("url");
        $this->template->write_view('content', 'download_view');
        $this->template->render();
    }
} 
```

看法：

```
<? get_filenames("/somefolder"); ?> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T19:14:01.787

[您已经](http://ellislab.com/codeigniter/user-guide/helpers/url_helper.html)加载了不包含任何类似`get_filenames()`. 也许您打算加载[文件帮助程序](http://ellislab.com/codeigniter/user-guide/helpers/file_helper.html)：

```
$this->load->helper('file'); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:23:58.270

您没有定义名为的函数`get_filenames()`。可能需要正确包含文件。尝试使用`$this`名称。

# box-api - Box API v2.0 SDK for PHP

> ID：14665423
> 
> 赞同：3
> 
> 时间：2013-02-02T19:08:02.830
> 
> 标签：box-api

我试图找到适用于 Box API v 2.0 的 PHP SDK，但没有找到。我发现只有 SDK for v1.0 [https://github.com/box/box-php-sdk](https://github.com/box/box-php-sdk) 它存在吗？

或者

是否可以在该 v1.0 sdk [https://github.com/box/box-php-sdk](https://github.com/box/box-php-sdk)中的 Box API v1.0 中使用 refresh_token ？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-09-10T12:56:52.233

为 v2 编写 PHP SDK

只需包含 api 类并启动该类：

```
<?php
    include('library/BoxAPI.class.php');

    $client_id = 'CLIENT ID';
    $client_secret = 'CLIENT SECRET';
    $redirect_uri = 'REDIRECT URL';
    $box = new Box_API($client_id, $client_secret, $redirect_uri);

    if(!$box->load_token()){
        if(isset($_GET['code'])){
            $token = $box->get_token($_GET['code'], true);
            if($box->write_token($token, 'file')){
                $box->load_token();
            }
        } else {
            $box->get_code();
        }
    }
    // User details
    $box->get_user();
?> 
```

看看[这里](http://www.ulhas.net/GitHub/BoxPHPAPI/) 下载：[BoxPHPAPI](https://github.com/golchha21/BoxPHPAPI)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T17:42:07.040

我们目前没有用于 v2 的 PHP SDK，尽管我们正在开发一个。

OAuth 2 令牌（刷新和访问）仅适用于 V2 API。

# android - 在 Android 上登录 Facebook 并获得访问令牌作为回报

> ID：14665424
> 
> 赞同：0
> 
> 时间：2013-02-02T19:08:07.710
> 
> 标签：android, facebook, authentication, login, token

首先，如果这是一个被问过很多次的问题，我深表歉意。

这样做的不同版本太多（其中许多包含已弃用的代码）。

我想知道如何实现以下内容：

1.  到达活动页面时的 Facebook 登录提示
2.  登录成功后返回访问令牌

我已经获得了一个 APP id 并在 Facebook 中配置了密钥。

我需要以下权限：[“email”、“user_birthday”、“publish_actions”、“user_likes”]

一个补充问题！如果设备上未安装官方 Facebook 应用程序，是否可以有 Facebook 登录提示？

期待您的建议、示例代码模板或方向！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:42:18.273

您需要的一切都在这里：[https ://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/](https://developers.facebook.com/docs/getting-started/facebook-sdk-for-android/3.0/)

你不需要安装脸书。如果未安装应用程序，将使用 webview。

# ruby - 为什么 Nokogiri 将空白输出返回到 Excel？

> ID：14665430
> 
> 赞同：0
> 
> 时间：2013-02-02T19:08:21.483
> 
> 标签：ruby, nokogiri

**我的任务**

[从http://www.asus.com/Notebooks_Ultrabooks/ASUS_TAICHI_21/#specifications](http://www.asus.com/Notebooks_Ultrabooks/ASUS_TAICHI_21/#specifications)中提取所有规格并将其放入电子表格中（我们稍后会进行格式化）

**问题**

电子表格已创建，但我的输出返回空白。

**我的代码**

```
require 'Nokogiri'
require 'open-uri'
require 'spreadsheet'

doc = Nokogiri::HTML(open("http://www.asus.com/Notebooks_Ultrabooks/ASUS_TAICHI_21/#specifications"))

data = puts doc.css('//div#specifications/div#spec-area/ul#product-spec/li')

Spreadsheet.client_encoding = 'UTF-8'
book = Spreadsheet::Workbook.new

sheet1 = book.create_worksheet
sheet1.name = 'My First Worksheet'

sheet1[0,0] = data
book.write 'C:/Users/Barry/Desktop/output.xls' 
```

**以下代码对我有用**

```
require 'Nokogiri'
require 'open-uri'
require 'spreadsheet'

doc = Nokogiri::HTML(open("http://www.asus.com/Notebooks_Ultrabooks/ASUS_TAICHI_21/#specifications"))

data = doc.css('div#specifications div#spec-area ul.product-spec')[0].text

Spreadsheet.client_encoding = 'UTF-8'
book = Spreadsheet::Workbook.new

sheet1 = book.create_worksheet
sheet1.name = 'My First Worksheet'

sheet1[0,0] = data
book.write 'C:/Users/Barry/Desktop/output.xls' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:01:57.727

这里有几个问题：

1.  看起来您正在尝试通过在该行中打印出`css`调用结果来进行调试：

    ```
    data = puts doc.css('//div#specifications/div#spec-area/ul#product-spec/li') 
    ```

    该方法[`puts`](http://ruby-doc.org/core-1.9.3/Kernel.html#method-i-puts)返回`nil`，因此`data`将`nil`不会显示任何内容。

2.  在您正在解析的页面中，`product-spec`列表实际上是一个类，而不是一个 id，因此您需要`.product-spec`（`.`而不是`#`）。

3.  您使用的语法实际上不是 CSS，看起来您正在混合 CSS 和 Xpath。你想要这样的东西：

    ```
    doc.css('div#specifications div#spec-area ul.product-spec li') 
    ```

    （最后一点似乎并没有真正影响结果。Nokogiri 将 CSS 选择器转换为 xpath，看来转换结果仍然是有效的 xpath）。

# cuda - 什么是 GPU 上的静态和动态调度？

> ID：14665432
> 
> 赞同：3
> 
> 时间：2013-02-02T19:08:43.887
> 
> 标签：cuda, gpu, nvidia

GTX 4xx、5xx (Fermi) 具有动态调度，而 GTX 6xx (Kepler) 切换到静态调度。

*   什么是 GPU 上下文中的静态和动态调度？
*   静态与动态的设计选择如何影响现实世界计算工作负载的性能？
*   有什么可以在代码中完成来优化静态或动态调度的算法吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T15:27:09.957

我假设您指的是硬件中的静态/动态[*指令*调度](http://en.wikipedia.org/wiki/Instruction_scheduling)。

动态指令调度意味着处理器可以在运行时重新排序各个指令。这通常涉及一些硬件，它们将尝试预测指令流水线中任何内容的最佳顺序。在您提到的 GPU 上，这是指为每个单独的扭曲重新排序指令。

从动态调度器切换回静态调度器的原因在[GK110 架构白皮书](http://www.nvidia.co.uk/content/PDF/kepler/NVIDIA-Kepler-GK110-Architecture-Whitepaper.pdf)中描述如下：

> 我们还寻找机会来优化 SMX warp 调度器逻辑的功能。例如，Kepler 和 Fermi 调度器都包含类似的硬件单元来处理调度功能，包括：
> 
> *   为长延迟操作（纹理和负载）注册记分板
>     
>     
> *   经线间调度决策（例如，在合格的候选人中选择最好的经线进行下一步）
>     
>     
> *   线程块级调度（例如，GigaThread 引擎）
>     
>     
> 
> 然而，Fermi 的调度器还包含一个复杂的硬件阶段，以防止数学数据路径本身中的数据危害。多端口寄存器记分板跟踪尚未准备好有效数据的任何寄存器，依赖检查器块根据记分板分析大量完全解码的 warp 指令的寄存器使用情况，以确定哪些有资格发布。
> 
> 对于 Kepler，我们认识到此信息是确定性的（数学流水线延迟不是可变的），因此编译器可以预先确定指令何时准备好发出，并在指令本身中提供此信息。这使我们能够用一个简单的硬件块替换几个复杂且功耗高的块，该硬件块提取预先确定的延迟信息，并使用它来屏蔽 warp 在 inter-warp 调度程序阶段的资格。

所以基本上，他们是在用芯片复杂性（即更简单的调度程序）来换取效率。但是，编译器现在可以预测最佳顺序，至少对于数学管道而言，这种潜在的效率损失现在已被拾取。

至于你的最后一个问题，即可以在代码中做什么来优化静态或动态调度的算法，我个人的建议是*不要*使用任何内联汇编器，而让编译器/调度器来做它的事情。

# php - 在按钮单击表单上执行 2 个操作

> ID：14665438
> 
> 赞同：0
> 
> 时间：2013-02-02T19:09:15.210
> 
> 标签：php, javascript, html

**我的要求**

> 在新窗口中提交表单并在同一次点击时将现有页面重定向到新页面。

*当我尝试只提交表单时。用于重定向的 Javascript 函数不起作用。*

**html**

```
<form id="feedback.php" name="form1" method="post" action="feedback.php" target="_blank">
<input type="submit" class="button" value="SUMBIT" onclick="btntest_onclick();"/>
</form> 
```

**Javascript**

```
<script>
function btntest_onclick() 
{
window.location.href("mainpage.php");
}
</script> 
```

**实际的**

> 但只有表单提交发生在新窗口中。现有页面未重定向。

请告诉我该怎么做？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:29:54.733

你的 HTML ：

```
<form id="feedback.php" name="form1" method="post" action="feedback.php" target="_blank">
<input type="submit" class="button" value="SUMBIT" onClick="btntest_onclick()"/>
</form> 
```

见**onClick**

你的 Javascript ：

```
function btntest_onclick() 
{
    setTimeout(function(){
       window.location.href = "mainpage.php";
    },0);
} 
```

`window.location.href`不是函数。
显然它需要异步才能工作。

[提琴手](http://jsfiddle.net/9Y5SQ/3)

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-02-02T19:13:28.190

添加`onsubmit`到您的表单中。
和内部函数做这样的事情：

```
function btntest_onclick() {
   window.open("http:// your url");
   window.location.href="/mainpage.php";
} 
```

# ruby-on-rails - 鸭式康康舞场景

> ID：14665441
> 
> 赞同：0
> 
> 时间：2013-02-02T19:09:40.110
> 
> 标签：ruby-on-rails, ruby, cancan

这是我的能力。初始化：

```
user ||= User.new # handle guest user

if user.has_role? :admin
    can :manage, :all
elsif user.has_role? :moderator
    can :read, :all
    can :update, :all do |clazz|
        clazz.managed_by? user
    end
elsif user.has_role? :participant
    can :update, :all do |clazz|
        clazz.owned_by? user
    end
    can :read, :all do |clazz|
        clazz.visible_to? user
    end
else
    raise "Role decoding in Ability fell through"
end 
```

结尾

我的意图是关键域类 [User、Round、Participant、Question 和 Program] 都定义了 own_by?、managed_by? 和一个可见的？方法。并且统一应用允许更新或查看其中之一的规则。

但我相信这样的陈述：

```
 can :update, :all do |clazz|
        clazz.owned_by? user
    end 
```

没有按照我的想法做，因为我认为我什至没有到达 clazz.owned_by？线。

有人可以纠正我吗？我查看了文档，无法真正将它所说的内容与我正在使用的技术联系起来。谢谢你！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:34:46.987

我相信 :all 只是一个符号，而不是所有类的迭代器。您可以像我在这里所做的那样明确列出它们，也可以使用此解决方案来获取所有模型的列表：[https ://stackoverflow.com/a/516605/2033014](https://stackoverflow.com/a/516605/2033014)

```
[User, Round, Participant, Question, Program].each do |klass|
  can :update, klass, klass.owned_by?(user)
  can :read, klass, klass.visible_to?(user)
end 
```

# android - 无法在android中保存文件

> ID：14665443
> 
> 赞同：0
> 
> 时间：2013-02-02T19:09:59.400
> 
> 标签：android, file, sd-card

再会。

我需要将 PKCS10 CSR 保存在外部存储卡中。

但是，以下代码显示错误

java.io.FileNotFoundException：/storage/sdcard0pkcs10.req：打开失败：EROFS（只读文件系统）

虽然 AndoidManifest.xml 正确包含

我觉得问题是目录路径，因为它显示 0 而不是 /

```
package exam.blowfishcipher;

import java.io.FileWriter;
import java.io.OutputStreamWriter;
import java.security.*;
import org.spongycastle.jce.provider.BouncyCastleProvider;
import java.security.SecureRandom;

import javax.security.auth.x500.X500Principal;

import org.spongycastle.jce.PKCS10CertificationRequest;
import org.spongycastle.openssl.PEMWriter;

import android.os.Environment;
import android.util.*;
import android.widget.*;

public class PKCS10Generater
{
    static {
        Security.addProvider(new org.spongycastle.jce.provider.BouncyCastleProvider());
    }

    public static PKCS10CertificationRequest generateRequest(
            KeyPair pair)
            throws Exception

            {           
             return new PKCS10CertificationRequest(
                     "SHA256withRSA",
                     new X500Principal("CN=Test CA Certificate"),
                     //new X500Principal("CN=end"),
                     pair.getPublic(),
                     null,
                     pair.getPrivate());
            }

    public static void pemEncodeToFile(String filename, Object obj, char[] password) throws Exception{
        PEMWriter pw = new PEMWriter(new FileWriter(filename));
           Log.e("Position", "PEMWriter");
           if (password != null && password.length > 0) {
               pw.writeObject(obj, "DESEDE", password, new SecureRandom());
           } else {
               pw.writeObject(obj);
           }
           pw.flush();
           pw.close();
    }

    public static void reqGen() throws Exception
    {
        //create the keys
        Log.e("Position", "reqGen");
        KeyPair pair = Utils.generateRSAKeyPair();

        //modified 20130203
        PKCS10req pkcs10req = new PKCS10req();
        PKCS10CertificationRequest request = pkcs10req.generateRequest(pair);

        pemEncodeToFile(Environment.getExternalStorageDirectory()+"pkcs10.req", request, null);
        Log.e("Position", "getExternalStorage");
        PEMWriter pemWrt = new PEMWriter( new OutputStreamWriter(System.out));
        pemWrt.writeObject(request);
        pemWrt.close();

    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:16:35.960

只需修改行

```
pemEncodeToFile(Environment.getExternalStorageDirectory()+"pkcs10.req", request, null); 
```

至

```
pemEncodeToFile(Environment.getExternalStorageDirectory()+"/pkcs10.req", request, null); 
```

# excel - VS2005中的UAC清单文件不起作用

> ID：14665450
> 
> 赞同：-1
> 
> 时间：2013-02-02T19:10:47.150
> 
> 标签：excel, windows-7, visual-studio-2005, add-in, uac

我在 Excel 中有一个加载项，需要在 HKEY_LOCAL_MACHINE 注册表中存储一些数据。由于 Windows Vista 及更早版本中的 UAC 控件，我添加了一个清单文件。但这只是行不通。我什至在我的解决方案的每个项目中都添加了清单。我的解决方案中有 5 个项目（3 个 VB 项目、1 个 c++ 和 1 个部署）。

我正在使用VS2005。我将清单文件添加到项目中（将 requestedExecutionLevel 设置为“requireAdministrator”并使用 mt.exe 在构建后命令中嵌入清单。即便如此，我仍然拒绝访问 HKEY_LOCAL_MACHINE。唯一的事情当我以“以管理员身份运行”启动 Excel 时，这是有效的。

任何线索可能是什么问题？谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-03T16:59:56.490

DLL 中的清单不影响应用程序的执行级别，在这种情况下它是`excel.exe`.

以下是您的选择：

*   以管理员身份运行 Excel；
*   修改加载项以写入 HKCU 而不是 HKLM。

如果您需要存储可供其他用户使用的数据，请考虑使用`ProgramData`文件夹 (`CSIDL_COMMON_APPDATA`或`FOLDERID_ProgramData`)。然后你的插件在里面创建一个子目录`ProgramData`并修改它的权限，这样这个新目录就可以被任何人写（默认情况下，只有创建文件夹的用户帐户有写权限，其他用户只能读）。

* * *

还有一些其他选项：

*   您可以编写一个服务，您的附加组件将与之通信以将数据写入 HKLM，但事实并非如此。
*   您可以创建一个[提升的 COM 对象](http://msdn.microsoft.com/en-us/library/windows/desktop/ms679687%28v=vs.85%29.aspx)，它将数据写入 HKLM。

尽管用户不希望 Excel 在运行时需要提升，因此请考虑更改您的逻辑，以便您的加载项根本不需要提升。

# jquery - JasmineJS 无法识别我注入的模块

> ID：14665453
> 
> 赞同：0
> 
> 时间：2013-02-02T19:10:59.107
> 
> 标签：jquery, angularjs, jasmine

该应用程序上的所有内容都运行良好，因此只是我的测试在语法上不正确。这是我正在使用的截断版本。名称和位置已更改以保护无辜者。

```
var m;

m = angular.module('CustomService', []);

window.CustomService = m.factory("CustomService", function($rootScope) {
  var sharedService;
  sharedService = {};
  sharedService.broadcastItem = function() {
    return console.log('Works!');
  };
  return sharedService;
});

window.MyCtrl = function($scope, $location, CustomService) {
  this.$inject = ['$scope', 'CustomService'];
  return $scope.test_method = function(date) {
    return CustomService.broadcastItem(date);
  };
};

describe('MyCtrl', function() {
  beforeEach(inject(function($rootScope, $controller, $location) {
    this.scope = $rootScope.$new;
    return this.controller = $controller(MyCtrl, {
      $scope: this.scope,
      $location: $location,
      CustomService: CustomService
    });
  }));
  return it('tests my method', function() {
    return this.scope.test_method('10-1984');
  });
}); 
```

最后一行返回：

```
TypeError: Object #<Object> has no method 'test_method' 
```

奇怪的！因为我的整个应用程序都可以正常工作并蓬勃发展，因为该方法可以完美运行。所以一定是我没有正确注入这个模块（猜测！）。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:12:46.867

您的代码和测试中发生了很多事情，因此很难将它们全部列出。由于您没有提供要测试的实现（除了日志），因此很难完全帮助这个测试，所以我已经存根了一些我认为您想做和测试的东西。

所以，这里是测试：

```
describe('MyCtrl', function() {

  var scope, controller;
  beforeEach(module('CustomService'));
  beforeEach(inject(function($rootScope, $controller, $location) {
    scope = $rootScope.$new();
    controller = $controller('MyCtrl', {
      $scope: scope
    });
  }));

  it('tests my method', function() {
    scope.test_method('10-1984');
    expect(scope.brodcastedValue).toEqual('10-1984');
  });
}); 
```

测试中的问题是：

*   范围创建不正确（`$new()`是方法而不是属性
*   缺少对模块的引用：`beforeEach(module('CustomService'));`
*   为控制器指定的依赖项过多

我还修改了代码本身以使测试通过：

```
m.factory("CustomService", function($rootScope) {
  var sharedService;
  sharedService = {};
  sharedService.broadcastItem = function(date) {
    $rootScope.$broadcast('works', date);
  };
  return sharedService;
});

m.controller('MyCtrl', function($scope, $location, CustomService) {

  $scope.test_method = function(date) {
    CustomService.broadcastItem(date);
  };

  $scope.$on('works', function(event, date){
    $scope.brodcastedValue = date;
  });
}); 
```

不确定以上是否是您的意图。无论如何，看起来代码是从 CoffeScript 或其他东西转换而来的（充满了回报和这个），所以我不确定我是否做对了。

Finally, a working plunk, hopefully this one will clarify all the details: [http://plnkr.co/edit/x2Jjvm8zwwaLZYV9aLfo?p=preview](http://plnkr.co/edit/x2Jjvm8zwwaLZYV9aLfo?p=preview)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T20:03:06.627

我注意到这一行的语法有一个错误：

```
this.scope = $rootScope.$new; 
```

您不是创建新范围，而是引用 $rootScope 的 $new 函数。试试这个：

```
this.scope = $rootScope.$new(); 
```

# python - Python：Pygame：如何使球以类似 sin() 的模式移动？

> ID：14665455
> 
> 赞同：1
> 
> 时间：2013-02-02T19:11:04.727
> 
> 标签：python, animation, pygame, trigonometry

你如何让球像 sin() 图那样以重复的波浪模式移动？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T19:30:30.793

您可以使用计数器、pygame's[`Clock`](http://www.pygame.org/docs/ref/time.html#pygame.time.Clock)或仅[`pygame.time.get_ticks`](http://www.pygame.org/docs/ref/time.html#pygame.time.get_ticks)计算时间。这里有一些示例代码可以帮助您入门。

```
import math
import pygame

pygame.init()
screen = pygame.display.set_mode((400,400))

while True:
    t = pygame.time.get_ticks() / 2  % 400 # scale and loop time
    x = t
    y = math.sin(t/50.0) * 100 + 200       # scale sine wave
    y = int(y)                             # needs to be int

    screen.fill((0,0,0))
    pygame.draw.circle(screen, (255,255,255), (x, y), 40)

    pygame.display.flip() 
```

# objective-c - Objective C - 保存过滤后的 UIImage

> ID：14665456
> 
> 赞同：2
> 
> 时间：2013-02-02T19:11:06.753
> 
> 标签：objective-c, image, colors, filter

我有一个带有滑块和背景图像的视图。背景图像根据滑块更新，其中滑块控制过滤器的级别。

我正在使用这个框架[https://github.com/BradLarson/GPUImage](https://github.com/BradLarson/GPUImage)来处理带有过滤器的图像。

从下面的代码中，图像正在使用滑块进行更新，并且过滤器工作得很好。但是我试图在过滤器处理后保存图像（在另一个类中设置 UIImage），但我无法实现这一点（过滤后的图像未保存，但保存了 ufiltered 图像）...我保存图片不对，格式不对？

请帮助我，我已经在这几个小时了！

```
- (void)loadView
{
CGRect mainScreenFrame = [[UIScreen mainScreen] applicationFrame];
GPUImageView *primaryView = [[GPUImageView alloc] initWithFrame:mainScreenFrame];
self.view = primaryView;

*imageSlider = [[UISlider alloc] initWithFrame:CGRectMake(25.0, mainScreenFrame.size.height - 50.0, mainScreenFrame.size.width - 50.0, 40.0)];
[imageSlider addTarget:self action:@selector(updateSliderValue:) forControlEvents:UIControlEventValueChanged];
imageSlider.autoresizingMask = UIViewAutoresizingFlexibleWidth | UIViewAutoresizingFlexibleTopMargin;
imageSlider.minimumValue = 0.0;
imageSlider.maximumValue = 1.0;
imageSlider.value = 0.5;

[primaryView addSubview:imageSlider];

[self setupDisplayFiltering];

- (IBAction)updateSliderValue:(id)sender
{
CGFloat midpoint = [(UISlider *)sender value];
[(GPUImageBrightnessFilter *)sepiaFilter setBrightness:midpoint];
//[(GPUImageSepiaFilter *)sepiaFilter setIntensity:[(UISlider *)sender value]];
//[(GPUImageSaturationFilter *)sepiaFilter setSaturation:midpoint];
//[(GPUImageRGBFilter *)sepiaFilter setGreen:midpoint];

[sourcePicture processImage];
}

- (void)setupDisplayFiltering;
{

NSUserDefaults *defaults = [NSUserDefaults standardUserDefaults];
NSData *imageToUseData = [defaults dataForKey:@"imageToUse"];
UIImage *inputImage = [UIImage imageWithData:imageToUseData];

sourcePicture = [[GPUImagePicture alloc] initWithImage:inputImage smoothlyScaleOutput:YES];
//sepiaFilter = [[GPUImageSepiaFilter alloc] init];
sepiaFilter = [[GPUImageBrightnessFilter alloc] init];

GPUImageView *imageView = (GPUImageView *)self.view;
[sepiaFilter forceProcessingAtSize:imageView.sizeInPixels]; // This is now needed to make the filter run at the smaller output size

[sourcePicture addTarget:sepiaFilter];
[sepiaFilter addTarget:imageView];

[sourcePicture processImage];

UIImage *outputImage = [sepiaFilter imageFromCurrentlyProcessedOutput];
UIImage *quickFilteredImage = [brightnessFilter imageByFilteringImage:inputImage];

// set the image chosen for other classes to set uiimages with
NSData *imageToStore = UIImageJPEGRepresentation(outputImage, 100);
[defaults removeObjectForKey:@"imageToUse"];
[defaults setObject:imageToStore forKey:@"imageToUse"];
} 
```

# jquery-mobile - jQuery Mobile 如何设置 hidePlaceholderMenuItems 值

> ID：14665457
> 
> 赞同：0
> 
> 时间：2013-02-02T19:11:11.647
> 
> 标签：jquery-mobile

我有一个使用 json 填充的选择项，但 jquery 移动选择不显示默认选择值。我已经阅读了文档，他们说需要设置以下内容：

```
$.mobile.selectmenu.prototype.options.hidePlaceholderMenuItems = false; 
```

但我真的不知道该怎么做

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:11:59.407

您需要在初始化 jQuery Mobile 之前在 mobileinit 事件中设置它，如下所示：

```
<head>
    <title>jQM Complex Demo</title>
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0"/>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.css" />
    <script>
        $(document).on("mobileinit", function () {
            $.mobile.selectmenu.prototype.options.hidePlaceholderMenuItems = true;
        });        
    </script>
    <script src="http://code.jquery.com/mobile/1.2.0/jquery.mobile-1.2.0.min.js"></script>    
</head> 
```

示例：http: [//jsfiddle.net/Gajotres/VmsRg/](http://jsfiddle.net/Gajotres/VmsRg/)

# r - ggplot中的欧洲/法国千位分隔符

> ID：14665461
> 
> 赞同：6
> 
> 时间：2013-02-02T19:11:18.620
> 
> 标签：r, ggplot2

我正在尝试将 ggplot 图中的 y 轴格式化为空格（而不是逗号）作为千位分隔符`;`，例如 10 000 而不是 10,000。`scale_y_continuous`我在帮助中找不到。

感谢您的任何提示。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-03-06T15:53:01.957

正如@David 和@joran 刚才所说。

首先，定义标签格式化程序：

```
space <- function(x, ...) { 
  format(x, ..., big.mark = " ", scientific = FALSE, trim = TRUE)
} 
```

然后使用它`scale_y_continous`：

```
plot + scale_y_continuous(labels = space) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:17:26.210

我只是在黑暗中尝试一下，但`scale_y_continuous(labels = space)`可能会成功。

# javascript - 如何用 JavaScript 替换同一索引处的文本？

> ID：14665464
> 
> 赞同：0
> 
> 时间：2013-02-02T19:11:42.023
> 
> 标签：javascript, replace, getselection

如何替换同一索引处的文本。此文本可能具有相同的模式。假设我想在下一个文本中替换粗体“是”。

“山姆*是*个男孩，多莉是他的妹妹，但约翰**是**他的父亲。他不是医生。”

当我使用以下代码时，它会替换第一个模式，即斜体“is”！

```
function getSelectedHTMLText() {
    if (window.getSelection) {  // all browsers, except IE before version 9 contents
    var range = window.getSelection ();
    var container = document.createElement("div");
    for (var i = 0, len = range.rangeCount; i < len; ++i) {
        container.appendChild(range.getRangeAt(i).cloneContents());
    }
            html = container.innerHTML;
            return html;
    } 
    else {
        if (document.selection.createRange) { // Internet Explorer
            var range = document.selection.createRange();
            html = range.htmlText;
            return html;
        }
    }
}

var txt = "Sam is a boy and Dory is his sister, but John <b>is</b> his father. He isn't a doctor.";

var htmlText = getSelectedHTMLText(); //This return s

var txtModified = txt.replace(htmlText, "is"); 
```

**注意：**我使用此代码将 HTML 代码替换为非 HTML 代码，反之亦然

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:44:32.670

Tim Down[在这里](https://stackoverflow.com/a/3997896)回答了您的问题。实际上看起来与您的代码非常相似。

我做了一个小提琴来演示[http://jsfiddle.net/DggQL/](http://jsfiddle.net/DggQL/)它也适用于您的情况。

这是代码

```
/* taken from https://stackoverflow.com/a/3997896*/
function replaceSelectedText(replacementText) {
    var sel, range;
    if (window.getSelection) {
        sel = window.getSelection();
        if (sel.rangeCount) {
            range = sel.getRangeAt(0);
            range.deleteContents();
            range.insertNode(document.createTextNode(replacementText));
        }
    } else if (document.selection && document.selection.createRange) {
        range = document.selection.createRange();
        range.text = replacementText;
   }
} 
```

# facebook-graph-api - 最佳 Facebook Graph API / FQL 查询以获取带有封面照片的专辑列表

> ID：14665468
> 
> 赞同：0
> 
> 时间：2013-02-02T19:12:02.117
> 
> 标签：facebook-graph-api, facebook-fql

我目前正在做一个图形 api 调用来获取一个人的相册列表，然后额外调用来查询这些相册的 id 以获取每个相册的封面照片 url。有没有办法在一个查询中完成这一切？

# android - 3 窗格布局片段动画卡顿

> ID：14665469
> 
> 赞同：4
> 
> 时间：2013-02-02T19:12:09.527
> 
> 标签：android, android-fragments, android-animation, objectanimator

**实施信息：** 我已经实施了一个 3 窗格布局，遵循 CommonsWare 对他自己的问题的回复：[Gmail 三片段动画场景的完整工作示例？](https://stackoverflow.com/questions/12253965/complete-working-sample-of-the-gmail-three-fragment-animation-scenario)

作为一个总体思路，我的布局由以下级别（1 到 3）组成：

1.  `MainActivity`
2.  `SlidingMenu`（Side Drawer UI 模式）片段隐藏在左侧，`ContentFragment`作为容纳 3 窗格布局的片段。
3.  在`ContentFragment`: `LeftListFragment`(每行有 3 个 TextViews 的行), `MiddleListFragment`(每行有 8 个 TextViews 的行), `DetailFragment`.

`LeftListFragment`并`MiddleListFragment`用于`CursorLoaders`从`ContentProvider`每个列表中加载数据。`DetailFragment`还需要在需要时使用带有数据的游标。所以我什至没有实现自定义`Adapters`（这种方式更好的设计）。然后我添加了 3 窗格布局 + 动画。就工作而言，它按预期工作，没有问题。`Animation`时间为 500 毫秒。

**问题：** 动画有点卡顿。一些丢帧。当左侧和中间都可见并且我单击中间列表项以打开详细信息时；以及当我点击后退按钮再次查看左侧和中间列表时（实际上没有加载任何内容）。

**我试过的：**

1.  删除了加载片段的代码`DetailView`。我只需点击一个项目，`MiddleFragment`动画就开始了，实际上没有加载任何细节。还是口吃。此外，当回击时，没有任何负载并且它仍然口吃，所以我认为加载器/光标不是造成这种情况的原因。
2.  我使用 dumpsys gfxinfo 来查看计算每一帧的平均时间（以毫秒为单位）。实际上，计算的平均时间是 18 毫秒，高于 16 毫秒的阈值。那么这是否意味着口吃是因为在制作动画时再次绘制列表需要时间？如果是这样，为什么？我的意思是......我在行视图中根本没有任何图像。而且我不能搞砸适配器代码，因为我还没有写任何...
3.  `Animation`将时间从 500 毫秒减少到 200 毫秒。如果你仔细观察它仍然会卡顿，它只是更快。

**编辑：**我从下面切换`rightPaneWidth`到`leftPaneWidth`下面（是的，这删除了重新调整尺寸的动画），现在口吃消失了。该列表仍向左侧滑动，但宽度并没有变小。因此，如果现在不再出现口吃，这是否意味着我的代码中的 ObjectAnimator 存在问题？

```
ObjectAnimator.ofInt(this, "middleWidth", rightPaneWidth, leftPaneWidth)
                    .setDuration(ANIM_DURATION).start(); 
```

谢谢你的时间 ！

**3 窗格布局的代码：**

```
package com.xyz.view.widget;

import android.animation.ObjectAnimator;
import android.annotation.SuppressLint;
import android.annotation.TargetApi;
import android.content.Context;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewPropertyAnimator;
import android.widget.LinearLayout;

public class ThreePaneLayout extends LinearLayout
{
    private View leftView = null;
    private View middleView = null;
    private View rightView = null;

private static final int ANIM_DURATION = 500;
private int leftPaneWidth = -1;
private int rightPaneWidth = -1;

// -------------------------------------------------------------------------------------------
// --------------   Constructor
// -------------------------------------------------------------------------------------------

public ThreePaneLayout(Context context, AttributeSet attrs)
{
    super(context, attrs);
    setOrientation(HORIZONTAL);
}

@Override
public void onFinishInflate()
{
    super.onFinishInflate();
    leftView = getChildAt(0);
    middleView = getChildAt(1);
    rightView = getChildAt(2);
}

// -------------------------------------------------------------------------------------------
// --------------   Public methods
// -------------------------------------------------------------------------------------------

public View getLeftView()
{
    return leftView;
}

public View getMiddleView()
{
    return middleView;
}

public View getRightView()
{
    return rightView;
}

@SuppressLint("NewApi")
public void hideLeft()
{
    if (leftPaneWidth == -1)
    {

        leftPaneWidth = leftView.getWidth();
        rightPaneWidth = middleView.getWidth();
        resetWidget(leftView, leftPaneWidth);
        resetWidget(middleView, rightPaneWidth);
        resetWidget(rightView, rightPaneWidth);
        requestLayout();
    }
    translateWidgets(-1 * leftPaneWidth, leftView, middleView, rightView);
    ObjectAnimator.ofInt(this, "middleWidth", rightPaneWidth, leftPaneWidth)
                    .setDuration(ANIM_DURATION).start();
}

@SuppressLint("NewApi")
public void showLeft()
{
    translateWidgets(leftPaneWidth, leftView, middleView, rightView);
    ObjectAnimator.ofInt(this, "middleWidth", leftPaneWidth, rightPaneWidth)
                    .setDuration(ANIM_DURATION)
                    .start();
}

// -------------------------------------------------------------------------------------------
// --------------   Private methods
// -------------------------------------------------------------------------------------------

private void setMiddleWidth(int value)
{
    middleView.getLayoutParams().width = value;
    requestLayout();
}

@TargetApi(12)
private void translateWidgets(int deltaX, View... views)
{
    for (final View view : views)
    {
        ViewPropertyAnimator viewPropertyAnimator = view.animate();
        viewPropertyAnimator.translationXBy(deltaX)
                            .setDuration(ANIM_DURATION);
    }
  }

  private void resetWidget(View view, int width)
  {
      LinearLayout.LayoutParams layoutParams = (LinearLayout.LayoutParams)view.getLayoutParams();  
      layoutParams.width = width;
      layoutParams.weight = 0;
  }
} 
```

**ContentFragment 的 XML：**

```
 <?xml version="1.0" encoding="utf-8"?>
<com.xyz.view.widget.ThreePaneLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:id="@+id/fragment_content_three_pane_layout"
    android:layout_width="match_parent"
    android:layout_height="match_parent" >

<FrameLayout
    android:id="@+id/fragment_content_framelayout_left"
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight="3" />

<FrameLayout
    android:id="@+id/fragment_content_framelayout_middle"
    android:layout_width="0dp"
    android:layout_height="match_parent"
    android:layout_weight="7" />

<FrameLayout
    android:id="@+id/fragment_content_framelayout_right"
    android:layout_width="0dp"
    android:layout_height="match_parent" />
</com.xyz.view.widget.ThreePaneLayout> 
```

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-08T19:33:36.103

问题不在于 ObjectAnimator，而在于您的应用程序在动画的每一帧上都做了太多事情。具体来说，您正在为布局参数设置动画并在每一帧上请求布局。布局功能强大且有用......但在除了最琐碎的视图层次结构之外的任何地方都可能非常昂贵。在动画期间避免每帧昂贵的操作很重要，并且布局属于“昂贵”的类别。滑动东西很好（translationX/Y），淡入/淡出很好（alpha），但实际上在每一帧上都放置东西？拒绝吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T11:48:08.200

我最终完全删除了 ObjectAnimator……当然，它仍然有幻灯片动画，但同时没有平滑的重新调整尺寸。并不是说它实际上是光滑的......

无论如何，如果有人确实提出了这个问题的实际解决方案，请随时分享。谢谢。

```
package com.anfuddle.view.widget;

import android.annotation.TargetApi;
import android.content.Context;
import android.os.Build;
import android.util.AttributeSet;
import android.view.View;
import android.view.ViewPropertyAnimator;
import android.widget.LinearLayout;

public class ThreePaneLayout extends LinearLayout
{
    private View leftView = null;
    private View middleView = null;
    private View rightView = null;

private static final int ANIM_DURATION = 500;
private int rootWidth = -1;
private int leftPaneWidth = -1;
private int rightPaneWidth = -1;

// -------------------------------------------------------------------------------------------
// --------------   Constructor
// -------------------------------------------------------------------------------------------

public ThreePaneLayout(Context context, AttributeSet attrs)
{
    super(context, attrs);
    setOrientation(HORIZONTAL);
}

@Override
public void onFinishInflate()
{
    super.onFinishInflate();

    leftView = getChildAt(0);
    middleView = getChildAt(1);
    rightView = getChildAt(2);
}

// -------------------------------------------------------------------------------------------
// --------------   Public methods
// -------------------------------------------------------------------------------------------

public View getLeftView()
{
    return leftView;
}

public View getMiddleView()
{
    return middleView;
}

public View getRightView()
{
    return rightView;
}

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
public void hideLeftAndMiddle()
{
    if (leftPaneWidth == -1)
    {
        rootWidth = getWidth();
        leftPaneWidth = leftView.getWidth();
        rightPaneWidth = middleView.getWidth();
    }
    resetWidget(leftView, leftPaneWidth);
    resetWidget(middleView, rightPaneWidth);
    resetWidget(rightView, rootWidth);
    requestLayout();

    translateWidgets(-1 * rootWidth, leftView, middleView, rightView);
}

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
public void hideLeft()
{
    if (leftPaneWidth == -1)
    {
        leftPaneWidth = leftView.getWidth();
        rightPaneWidth = middleView.getWidth();
    }
    resetWidget(leftView, leftPaneWidth);
    resetWidget(middleView, leftPaneWidth);
    resetWidget(rightView, rightPaneWidth);
    requestLayout();
    translateWidgets(-1 * leftPaneWidth, leftView, middleView, rightView);
}

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
public void showLeftAndMiddle()
{
    translateWidgets(rootWidth, leftView, middleView, rightView);
}

@TargetApi(Build.VERSION_CODES.HONEYCOMB)
public void showLeft()
{
    resetWidget(leftView, leftPaneWidth);
    resetWidget(middleView, rightPaneWidth);
    resetWidget(rightView, rightPaneWidth);
    requestLayout();
    translateWidgets(leftPaneWidth, leftView, middleView, rightView);
}

// -------------------------------------------------------------------------------------------
// --------------   Private methods
// -------------------------------------------------------------------------------------------

@TargetApi(12)
private void translateWidgets(int deltaX, View... views)
{
    for (final View view : views)
    {
        ViewPropertyAnimator viewPropertyAnimator = view.animate();
        viewPropertyAnimator.translationXBy(deltaX)
                            .setDuration(ANIM_DURATION);
    }
  }

  private void resetWidget(View view, int width)
  {
      LinearLayout.LayoutParams layoutParams = (LinearLayout.LayoutParams)view.getLayoutParams();  
      layoutParams.width = width;
      layoutParams.weight = 0;
  }
} 
```

# javascript - 超大的 jQuery 幻灯片到特定的

> ID：14665474
> 
> 赞同：1
> 
> 时间：2013-02-02T19:12:47.437
> 
> 标签：javascript, jquery, css, plugins, supersized

知道如何让[Supersize jQuery 幻灯片](http://www.buildinternet.com/project/supersized/)在特定`<div>`而不是整个身体中工作吗？这里的另一个线程建议添加 a `<div id="supersized">`，它有 0 个赞成票，也对我不起作用。目前它忽略了所有其他元素并停留在后台。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:31:43.773

这是用于 Supersized 的 jQuery 的第一行；

```
(function(a){a(document).ready(function(){
a("body").append('<div id="supersized-loader"></div><ul id="supersized"></ul>')
}); 
```

基于此，如果您不想全屏使用它，他们会在文档中告诉您执行以下操作：

**您可以通过调整 CSS 文件中的 #supersized 样式来定义尺寸。您将希望创建所有位置实例：固定 -> 位置：绝对。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-13T20:51:08.073

我将 supersized.css 和 supersized.shutter.css 下的大约 4 或 5 个位置属性从固定更改为绝对，这允许您在图像幻灯片放映下方添加内容。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-07-12T19:03:07.537

无需创建或添加另一个 div。只需将位置从固定设置为绝对。背景图像将从顶部开始。您可以使用顶部或左侧调整位置，因为它是绝对 div。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2014-03-06T15:55:51.123

我遇到了同样的问题，本教程为我节省了[http://arushad.org/how-to-use-supersized-inside-a-div-for-a-background-image-slideshow/](http://arushad.org/how-to-use-supersized-inside-a-div-for-a-background-image-slideshow/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2016-01-12T09:08:21.160

您可以使用以下作为样式表，不要使用插件附带的 supersized.css 文件

```
/**************************************** BEGIN: slider *************************************************/
.slider{
    position:relative;
    height:100%;
}
#slidecounter,
#slidecaption{
    overflow:hidden;
    color:#FFF;
    font-size:13px;
    text-transform:capitalize;
    padding:10px 13px;
    line-height:15px;
    position:absolute;
    top:112px;
    right:25px;
    z-index:5;
    background-color:#fff;
    color:#565656;
    font-family: 'Oswald', sans-serif;
    letter-spacing:0.05em;
    border-bottom:2px solid #bdbdbd;
    display:block;
}

ul#slide-list{
    float:right; 
    height:25px; 
    bottom:25px; 
    right:25px; 
    z-index:9999999; 
    position:absolute;
}
ul#slide-list li{
    list-style:none; 
    width:15px; 
    height:15px; 
    float:left; 
    margin-left:5px;
}
ul#slide-list li:first-child{margin:0;}
ul#slide-list li.current-slide a, 
ul#slide-list li a:hover{background-color:#fff;}
ul#slide-list li a{
    display:block; 
    width:15px; 
    height:15px; 
    background-color:#eee; 
    background-color:rgba(255,255,255,0.6); 
    cursor:pointer;
}

#progress-back{
    z-index:5; 
    position:absolute; 
    bottom:0px; 
    left:0; 
    height:5px; 
    width:100%; 
    background:url(../images/progress-back.png) repeat-x;
}
#progress-bar{
    position:relative; 
    height:5px; 
    width:100%;
    background:#666666;
}

#supersized-loader{
    position:absolute; 
    top:50%; 
    left:50%; 
    z-index:0; 
    width:60px; 
    height:60px; 
    margin:-30px 0 0 -30px; 
    text-indent:-999em; 
    background:url(../images/progress.gif) no-repeat center center;
}
#supersized{
    display:block; 
    position:absolute; 
    left:0; top:0; 
    overflow:hidden; 
    z-index:1; 
    height:100%; 
    width:100%;
}
#supersized img{
    width:auto; 
    height:auto; 
    position:relative; 
    display:none; 
    outline:none; 
    border:none; 
}
#supersized.speed img{
    -ms-interpolation-mode:nearest-neighbor;
    image-rendering: -moz-crisp-edges;
}
#supersized.quality img{
    -ms-interpolation-mode:bicubic; 
    image-rendering: optimizeQuality;
}
#supersized li{
    display:block; 
    list-style:none; 
    z-index:-30; 
    position:absolute; 
    overflow:hidden; 
    top:0; 
    left:0; 
    width:100%; 
    height:100%; 
    background:#111;
}
#supersized a{
    width:100%; 
    height:100%; 
    display:block; 
}
#supersized li.prevslide{z-index:-20;}
#supersized li.activeslide{z-index:-10;}
#supersized li.image-loading{
    background:#111 url(../img/progress.gif) no-repeat center center; 
    width:100%; 
    height:100%; 
}
#supersized li.image-loading img{visibility:hidden;}
#supersized li.prevslide img, #supersized li.activeslide img{display:inline;}

#prevslide, #nextslide{ position:absolute; height:45px; width:45px; top:50%; margin-top:-23px; opacity:0.3; z-index:2; }
#prevslide{ left:10px; background:url(../images/back.png); }
#nextslide{ right:10px; background:url(../images/forward.png); }
#prevslide:active, #nextslide:active{ margin-top:-19px; }
#prevslide:hover, #nextslide:hover{ cursor:pointer; }
/**************************************** END: slider *************************************************/ 
```

# java - 创建使用 whois 的套接字

> ID：14665475
> 
> 赞同：1
> 
> 时间：2013-02-02T19:12:57.213
> 
> 标签：java, sockets

这是我从`Java Complete Reference: 7th Edition`. 稍作修改：

```
import java.net.*;
import java.io.*;

public class WhoIs {
    public static void main(String[] args) throws Exception{
        Socket s = new Socket("internic.net",43);

        OutputStream os = s.getOutputStream();
        String domain = "facebook.com"+"\n";
        byte[] stringToByte = domain.getBytes();
        os.write(stringToByte);

        InputStream is = s.getInputStream();
        InputStreamReader reader = new InputStreamReader(is);
        BufferedReader buf = new BufferedReader(reader);

        String temp;
        while((temp=buf.readLine())!="\n"){
            System.out.println(temp);
        }
    }
} 
```

它只是联系`internic.net`并获取有关 Facebook 的信息。但是，套接字不会连接。我得到一个例外如下：

```
Exception in thread "main" java.net.ConnectException: Connection refused: connect
    at java.net.DualStackPlainSocketImpl.connect0(Native Method)
    at java.net.DualStackPlainSocketImpl.socketConnect(Unknown Source)
    at java.net.AbstractPlainSocketImpl.doConnect(Unknown Source)
    at java.net.AbstractPlainSocketImpl.connectToAddress(Unknown Source)
    at java.net.AbstractPlainSocketImpl.connect(Unknown Source)
    at java.net.PlainSocketImpl.connect(Unknown Source)
    at java.net.SocksSocketImpl.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.connect(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at java.net.Socket.<init>(Unknown Source)
    at javacomplete.WhoIs.main(WhoIs.java:8) 
```

**除了**读回数据外，一切都与书中完全相同。我用a`BufferedReader`和书用来`InputStream`读单字。

帮助！为什么连接不上？？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T19:16:42.373

正确的主机名是`whois.internic.net`而不是`internic.net`：

```
$ telnet internic.net 43
Trying 192.0.43.9...
telnet: connect to address 192.0.43.9: Connection refused
Trying 2001:500:88:200::9...
telnet: connect to address 2001:500:88:200::9: No route to host
telnet: Unable to connect to remote host

$ telnet whois.internic.net 43
Trying 199.7.56.74...
Connected to whois.internic.net.
Escape character is '^]'. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:16:27.713

从“连接被拒绝”错误中可以清楚地看到，`internic.net`端口 43 上没有运行 WHOIS 服务器。

您想联系哪个 WHOIS 服务器？大多数域名注册商运行 WHOIS 服务器，许多 ccTLD 运营商也运行一个（例如`whois.cira.ca`用于`ca`ccTLK），所有 RIR（ARIN、RIPE 等）运行一个，还有一个`whois.internic.net`用于 gTLD 注册等， ETC...

# javascript - 在 D3 中使用上下文缩放和画笔移动散点图圆圈

> ID：14665482
> 
> 赞同：3
> 
> 时间：2013-02-02T19:13:57.307
> 
> 标签：javascript, jquery, d3.js

我正在尝试基于[http://bl.ocks.org/1667367](http://bl.ocks.org/1667367)的 d3 示例创建 Focus+Context+Tooltip 图。我已经使基本图表正常工作，但是当我尝试使用焦点图表放大某个区域时，我打算用于工具提示的“圆圈”不会移动。

这是我的代码：

```
var margin = {top: 10, right: 10, bottom: 100, left: 40},
margin2 = {top: 430, right: 10, bottom: 20, left: 40},
width = 960 - margin.left - margin.right,
height = 500 - margin.top - margin.bottom,
height2 = 500 - margin2.top - margin2.bottom;

var data = [{
'Wed Jan 23 00:00:00 IST 2013': 3383387
}, {
'Thu Jan 24 00:00:00 IST 2013': 3883387
}, {
'Fri Jan 25 00:00:00 IST 2013': 4383387
}, {
'Sat Jan 26 00:00:00 IST 2013': 2383387
}, {
'Sun Jan 27 00:00:00 IST 2013': 5383387
}, {
'Mon Jan 28 00:00:00 IST 2013': 2283387
}];

var format = d3.time.format("%a %b %d %H:%M:%S IST %Y");

var parseDate = d3.time.format("%b %Y").parse;

var x = d3.time.scale().range([0, width]),
x2 = d3.time.scale().range([0, width]),
y = d3.scale.linear().range([height, 0]),
y2 = d3.scale.linear().range([height2, 0]);

var xAxis = d3.svg.axis().scale(x).orient("bottom"),
xAxis2 = d3.svg.axis().scale(x2).orient("bottom"),
yAxis = d3.svg.axis().scale(y).orient("left");

var brush = d3.svg.brush()
.x(x2)
.on("brush", brush);

var area = d3.svg.area()
.interpolate("monotone")
.x(function(d) { return x(format.parse(d3.keys(d)[0])); })
.y0(height)
.y1(function(d) { return y(d3.values(d)[0]); });

var area2 = d3.svg.area()
.interpolate("monotone")
.x(function(d) { return x2(format.parse(d3.keys(d)[0])); })
.y0(height2)
.y1(function(d) { return y2(d3.values(d)[0]); });

var svg = d3.select("body").append("svg")
.attr("width", width + margin.left + margin.right)
.attr("height", height + margin.top + margin.bottom);

svg.append("defs").append("clipPath")
.attr("id", "clip")
.append("rect")
.attr("width", width)
.attr("height", height);

var focus = svg.append("g")
.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var context = svg.append("g")
.attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");

x.domain(d3.extent(data.map(function(d) { return format.parse(d3.keys(d)[0]); })));
y.domain([0, d3.max(data.map(function(d) { return d3.values(d)[0]; }))]);
x2.domain(x.domain());
y2.domain(y.domain());

focus.append("path")
  .datum(data)
  .attr("clip-path", "url(#clip)")
  .attr("d", area);

focus.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height + ")")
  .call(xAxis);

focus.append("g")
  .attr("class", "y axis")
  .call(yAxis);

context.append("path")
  .datum(data)
  .attr("d", area2);

context.append("g")
  .attr("class", "x axis")
  .attr("transform", "translate(0," + height2 + ")")
  .call(xAxis2);

context.append("g")
  .attr("class", "x brush")
  .call(brush)
  .selectAll("rect")
  .attr("y", -6)
  .attr("height", height2 + 7);

focus.append("g").selectAll('dot')
.data(data)
.enter().append("svg:circle")
.attr("cx",function(d){ return x(format.parse(d3.keys(d)[0]));})
.attr("cy", function(d){ return y(d3.values(d)[0]);})
.attr("r", function(d){ return 4;})
.on('mouseover', function(d){ d3.select(this).attr('r', 8)})
.on('mouseout', function(d){ d3.select(this).attr('r', 4)});    

function brush() {
x.domain(brush.empty() ? x2.domain() : brush.extent());
focus.select("path").attr("d", area);
focus.select(".x.axis").call(xAxis);
focus.select("circle").attr("cx",function(d){ return x(format.parse(d3.keys(d)[0]));}).attr("cy", function(d){    return y(d3.values(d)[0]);});
} 
```

我在这里为此创建了一个小提琴：http: [//jsfiddle.net/PyvZ7/](http://jsfiddle.net/PyvZ7/)。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-03T11:52:28.527

我已经更新了小提琴：http: [//jsfiddle.net/PyvZ7/7/](http://jsfiddle.net/PyvZ7/7/)

别忘了申请`clip-path`加入群。您的代码使用`select`而不是`selectAll`. 因此，变换并未应用于组内的所有圆圈。也是`selectAll`一个 css3 选择器。你需要确保你这样做，`selectAll('.dot')`而不是`selectAll('dot')`因为后者意味着一个标签，而前者意味着元素有一个 class `dot`。

这是修改后的代码：

```
var margin = {top: 10, right: 10, bottom: 100, left: 40},
    margin2 = {top: 430, right: 10, bottom: 20, left: 40},
    width = 960 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom,
    height2 = 500 - margin2.top - margin2.bottom;

var data = [{
    'Wed Jan 23 00:00:00 IST 2013': 3383387
}, {
    'Thu Jan 24 00:00:00 IST 2013': 3883387
}, {
    'Fri Jan 25 00:00:00 IST 2013': 4383387
}, {
    'Sat Jan 26 00:00:00 IST 2013': 2383387
}, {
    'Sun Jan 27 00:00:00 IST 2013': 5383387
}, {
    'Mon Jan 28 00:00:00 IST 2013': 2283387
}];

var format = d3.time.format("%a %b %d %H:%M:%S IST %Y");

var parseDate = d3.time.format("%b %Y").parse;

var x = d3.time.scale().range([0, width]),
    x2 = d3.time.scale().range([0, width]),
    y = d3.scale.linear().range([height, 0]),
    y2 = d3.scale.linear().range([height2, 0]);

var xAxis = d3.svg.axis().scale(x).orient("bottom"),
    xAxis2 = d3.svg.axis().scale(x2).orient("bottom"),
    yAxis = d3.svg.axis().scale(y).orient("left");

var brush = d3.svg.brush()
    .x(x2)
    .on("brush", brush);

var area = d3.svg.area()
    .interpolate("monotone")
    .x(function(d) { return x(format.parse(d3.keys(d)[0])); })
    .y0(height)
    .y1(function(d) { return y(d3.values(d)[0]); });

var area2 = d3.svg.area()
    .interpolate("monotone")
    .x(function(d) { return x2(format.parse(d3.keys(d)[0])); })
    .y0(height2)
    .y1(function(d) { return y2(d3.values(d)[0]); });

var svg = d3.select("body").append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom);

svg.append("defs").append("clipPath")
    .attr("id", "clip")
  .append("rect")
    .attr("width", width)
    .attr("height", height);

var focus = svg.append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

var context = svg.append("g")
    .attr("transform", "translate(" + margin2.left + "," + margin2.top + ")");

  x.domain(d3.extent(data.map(function(d) { return format.parse(d3.keys(d)[0]); })));
  y.domain([0, d3.max(data.map(function(d) { return d3.values(d)[0]; }))]);
  x2.domain(x.domain());
  y2.domain(y.domain());

  focus.append("path")
      .datum(data)
      .attr("clip-path", "url(#clip)")
      .attr("d", area);

  focus.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height + ")")
      .call(xAxis);

  focus.append("g")
      .attr("class", "y axis")
      .call(yAxis);

  context.append("path")
      .datum(data)
      .attr("d", area2);

  context.append("g")
      .attr("class", "x axis")
      .attr("transform", "translate(0," + height2 + ")")
      .call(xAxis2);

  context.append("g")
      .attr("class", "x brush")
      .call(brush)
    .selectAll("rect")
      .attr("y", -6)
      .attr("height", height2 + 7);

    var circlegroup = focus.append("g");
    circlegroup.attr("clip-path", "url(#clip)");
    circlegroup.selectAll('.dot')
    .data(data)
    .enter().append("circle")
    .attr('class', 'dot')
    .attr("cx",function(d){ return x(format.parse(d3.keys(d)[0]));})
    .attr("cy", function(d){ return y(d3.values(d)[0]);})
    .attr("r", function(d){ return 4;})
    .on('mouseover', function(d){ d3.select(this).attr('r', 8)})
    .on('mouseout', function(d){ d3.select(this).attr('r', 4)});    

function brush() {
  x.domain(brush.empty() ? x2.domain() : brush.extent());
  focus.select("path").attr("d", area);
  focus.select(".x.axis").call(xAxis);
  circlegroup.selectAll(".dot").attr("cx",function(d){ return x(format.parse(d3.keys(d)[0]));}).attr("cy", function(d){ return y(d3.values(d)[0]);});
} 
```

# apache - .htaccess 文件有问题

> ID：14665490
> 
> 赞同：0
> 
> 时间：2013-02-02T19:14:30.490
> 
> 标签：apache, .htaccess, mod-rewrite

```
Options +FollowSymLinks
RewriteEngine on
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^(css|js|images)
RewriteRule ([A-Za-z0-9-]+).html index.php?page=$1 [L] 
```

这是我所能得到的，它似乎不符合我需要的所有资格。基本上，如果我网站上的用户访问*mydomain.com/([A-Za-z0-9-]+).html*，我希望我的服务器看到*mydomain.com/index.php?page=$1*。如果他们转到任何其他文件或除 css、图像、js 或 js/util 之外的文件夹，我希望服务器查看*mydomain.com/index.php？*或*mydomain.com/index.php?page=*。谢谢你的帮助！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:42:44.033

```
RewriteRule ([A-z0-9\-]+).html$ index.php?page=$1 [L] 
```

1.  在集合内使用`\-`匹配。
2.  而不是`!-d`，我认为你需要使用[`!-f`](http://amandine.aupetit.info/135/apache2-mod_rewrite/ "Apache2 mod_rewrite 和 %{REQUEST_FILENAME}").

看看[这个](http://amandine.aupetit.info/135/apache2-mod_rewrite/ "Apache2 mod_rewrite 和 %{REQUEST_FILENAME}")链接。

# asp.net - 为什么在 MVC4 Razor 布局文件中无法识别 @Scripts 和 @Styles 命令？

> ID：14665491
> 
> 赞同：41
> 
> 时间：2013-02-02T19:14:32.420
> 
> 标签：asp.net, asp.net-mvc, razor, asp.net-mvc-4

以下 MVC4 Razor 布局文件加载在 Bundle.config 中创建的几个脚本和 css 包。

```
<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
  <meta charset="utf-8" />
  <title>XXX Beta</title>
  @Scripts.Render(
  "~/bundles/bundle_jquery",
  "~/bundles/bundle_modernizr",
  "~/bundles/bundle_foundation",
  "~/bundles/bundle_jhs")
  @Styles.Render(
  "~/Content/bundle_foundation",
  "~/Content/bundle_jhs")
  @RenderSection("pageHeadContent", false)
</head>
<body>
  <div id="bodyContainer">
    @Html.Partial("Partial/_header")
    <div id="contentContainer">
      <div id="mainContentContainer">
        <div id="sidebarContainer">
          @RenderSection("sidebarContent", required: true)
        </div>
        @RenderBody()
      </div>
      <div class="clearBoth">
      </div>
    </div>
    @Html.Partial("Partial/_footer")
  </div>
</body>
</html> 
```

呈现页面时会发生以下错误。由于某种原因，@Scripts 和 @Styles 命令未被识别。如果我在文件中输入“@Scripts”，Intellisense 不会显示/显示命令。该项目确实引用了 Bundle.config 中使用的 System.Web.Optimization。

什么可能导致无法识别 @Scripts 和 @Styles 命令？

* * *

“/”应用程序中的服务器错误。

编译错误

说明：在编译服务此请求所需的资源期间发生错误。请查看以下特定错误详细信息并适当修改您的源代码。

编译器错误消息：CS0103：当前上下文中不存在名称“脚本”

源错误：

第 4 行：第 5 行：XXX Beta 第 6 行：@Scripts.Render（第 7 行：“~/bundles/bundle_jquery”，第 8 行：“~/bundles/bundle_modernizr”，

源文件：c:\Users\username\Documents\Visual Studio 2010\Projects\XXX\Solution\xxx.website\Views\Shared_sidebarLayout.cshtml 行：6

显示详细的编译器输出：

显示完整的编译源：

## 版本信息：Microsoft .NET Framework 版本：4.0.30319；ASP.NET 版本：4.0.30319.272

* * *

## 回答 #1

> 赞同：126
> 
> 时间：2013-02-02T19:19:05.807

确保`System.Web.Optimization.dll`程序集已在您的项目中被引用，并且`<add namespace="System.Web.Optimization"/>`命名空间已添加到您的`~/Views/web.config`文件（不是`~/web.config`文件）中：

```
<system.web.webPages.razor>
    <host factoryType="System.Web.Mvc.MvcWebRazorHostFactory, System.Web.Mvc, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31BF3856AD364E35" />
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>
        <add namespace="System.Web.Mvc" />
        <add namespace="System.Web.Mvc.Ajax" />
        <add namespace="System.Web.Mvc.Html" />
        <add namespace="System.Web.Optimization"/>
        <add namespace="System.Web.Routing" />
      </namespaces>
    </pages>
</system.web.webPages.razor> 
```

该`System.Web.Optimization.dll`程序集包含在[`Microsoft.AspNet.Web.Optimization`](http://nuget.org/packages/microsoft.aspnet.web.optimization)NuGet 中，因此请确保它已安装在您的项目中（当您使用 Internet 模板在 Visual Studio 中创建新的 ASP.NET MVC 4 项目时，此 NuGet 会自动添加到项目中）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2015-01-13T18:15:38.100

如果您正在使用捆绑包（如相关示例中所示），您可能还需要将捆绑包配置添加到您的应用程序：

将 Bundle Config 添加到您的 App_Start 文件夹：

```
public class BundleConfig
{
    public static void RegisterBundles(BundleCollection bundles)
    {
        bundles.Add(new ScriptBundle("~/bundles/jquery").Include(
            "~/Scripts/jquery-{version}.js"));

        bundles.Add(new ScriptBundle("~/bundles/jqueryval").Include(
            "~/Scripts/jquery.validate.js",
            "~/Scripts/jquery.validate.unobtrusive.js"
            ));

        bundles.Add(new StyleBundle("~/Content/css").Include(
            "~/Content/YourStyles.css"));

#if DEBUG

        BundleTable.EnableOptimizations = false;
#else
        BundleTable.EnableOptimizations = true;
#endif
    }
} 
```

将以下行添加到您的 Global.asax.cs

```
BundleConfig.RegisterBundles(BundleTable.Bundles); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2016-01-24T16:18:07.433

您的项目中有两个 webconfig 文件...它们都需要

```
<add namespace="System.Web.Optimization"/> 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2016-05-11T15:51:04.137

[如此处](https://stackoverflow.com/a/34056658/381082)所述：

1.  打开文件夹：Users\(user)\AppData\Local\Microsoft\VisualStudio（版本）

2.  删除文件夹：ComponentModelCache

3.  重新启动 Visual Studio（重新创建 ComponentModelCache 并且问题消失）

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2015-12-23T04:53:30.010

就我而言，我必须将项目的目标框架从 4.5 更改为 4.5.1。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2016-04-20T13:57:39.603

我在这里找到了答案 在此处[输入链接描述](https://stackoverflow.com/questions/10951669/mvc-4-scripts-does-not-exist)

显然你需要从你的根 web.config 添加 web.optimization。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2019-01-10T03:30:50.000

**1.**确保 System.Web.Optimization dll 在项目的参考中被重新引用。如果没有，请使用 NuGet（包管理器控制台）安装它：

```
Install-Package Microsoft.AspNet.Web.Optimization 
```

**2.**将 System.Web.Optimization 命名空间添加到**“视图”** web.config：

```
<system.web.webPages.razor>   
    <pages pageBaseType="System.Web.Mvc.WebViewPage">
      <namespaces>        
        <add namespace="System.Web.Optimization"/>       
      </namespaces>
    </pages>
</system.web.webPages.razor> 
```

**3.**如果问题仍然存在，请尝试关闭/重新打开 Visual Studio 以刷新缓存。

# linux - 为什么 CUDA 被 bashrc 中的变量声明搞糊涂了？

> ID：14665495
> 
> 赞同：1
> 
> 时间：2013-02-02T19:14:52.030
> 
> 标签：linux, bash, cuda

[我最近按照NVidia](http://docs.nvidia.com/cuda/cuda-getting-started-guide-for-linux/index.html)站点、[本站](http://www.zamaudio.com/?p=651)点和[本站](http://sn0v.wordpress.com/2012/12/07/installing-cuda-5-on-ubuntu-12-04/)点上的说明在 64 位 Ubuntu 12.04 系统上安装了 CUDA 5.0 。（注意，Ubuntu 12.04 不是 NVidia 网站上列出的支持 CUDA 5.0 的操作系统之一，但显然其他人已经安装了它并让它在他们的系统上运行。）正确安装驱动程序和软件包后，我会尝试编译并运行

1) 包含示例中的第一个程序（~/NVIDIA_CUDA-5.0_Samples/1_Utilities/deviceQuery/ 中的可执行 deviceQuery），以及

2) 第一个支持 GPU 的程序 - 第 3 章中的 simple_kernel.cu - 包含在NVidia 出版 的*CUDA By Example一书的源代码中（可*[在此处](https://developer.nvidia.com/content/cuda-example-introduction-general-purpose-gpu-programming-0)获得） 。

 *`make`1）我在对应目录下运行得到的可执行文件；可执行文件 2) 我用`nvcc simple_kernel.cu`. 两者的结果都是这个输出：

```
./deviceQuery: error while loading shared libraries: libcudart.so.5.0: cannot open shared object file: No such file or directory 
```

或者

```
./a.out: error while loading shared libraries: libcudart.so.5.0: cannot open shared object file: No such file or directory 
```

为清楚起见，是的，我已将`PATH`变量设置为 include `/usr/local/cuda-5.0/bin`，并将变量设置为同时`LD_LIBRARY_PATH`包含`/usr/local/cuda-5.0/lib`and `/usr/local/cuda-5.0/lib64`，是的，有`/usr/local/cuda-5.0/lib/libcudart.so`指向`/usr/local/cuda-5.0/lib/libcudart.so.5.0`和`/usr/local/cuda-5.0/lib/libcudart.so`指向的链接`/usr/local/cuda-5.0/lib/libcudart.so.5.0`。但这导致了我的问题......

我通过在 ~/.bashrc 文件中添加行来修改我的 PATH 和 LD_LIBRARY_PATH 变量

`export PATH=${PATH}:/usr/local/cuda-5.0/bin` 和 `export LD_LIBRARY_PATH=${LD_LIBRARY_PATH}:/usr/local/cuda-5.0/lib:/usr/local/cuda-5.0/lib64`

打开一个终端窗口并输入`echo $PATH`，`echo $LD_LIBRARY_PATH`会显示两个变量都已正确设置，但我在运行上述 CUDA 可执行文件时遇到了问题。

然后我在stackoverflow上找到[了这个](https://stackoverflow.com/questions/12416629/issues-in-running-devicequery-of-cuda-sdk)帖子，并尝试了sivapal ayyappan nadar提供的建议——`PATH`通过修改`/etc/environment`和`LD_LIBRARY_PATH`修改来设置`/etc/ld.so.conf.d/cuda50.conf`（我同时注释掉了~/.bashrc中的相应行）。现在，当我编译并运行我的 CUDA 示例时，它们就可以工作了！

所以，现在我的问题是：这里发生了什么？为什么在设置 LD_LIBRARY_PATH 时 libcudart 库被正确链接，但在设置`/etc/ld.so.conf.d/cuda50.conf`时却没有`~/.bashrc`？一个做什么而另一个不做什么？或者，这不是我问题的真正根源吗？

回复时，请记住我提出问题的动机。我想 1) 了解 Linux 系统的复杂性，以及 2) 为其他可能遇到相同问题的人发布一个可能的解决方案，即使遵循了其他可用的优秀说明。非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-03-03T22:05:50.597

这是一个有趣的话题，我将尝试解释。所以，在这个例子中，我安装了一个小库[jansson](http://www.digip.org/jansson/)来测试。我将继续配置它以安装在非标准目录中：

```
./configure --prefix=/home/ubuntu/mystuff 
```

现在在执行`make install`此警告后出现：

```
Libraries have been installed in:
   /home/ubuntu/mystuff/lib

If you ever happen to want to link against installed libraries
in a given directory, LIBDIR, you must either use libtool, and
specify the full pathname of the library, or use the `-LLIBDIR'
flag during linking and do at least one of the following:
   - add LIBDIR to the `LD_LIBRARY_PATH' environment variable
     during execution
   - add LIBDIR to the `LD_RUN_PATH' environment variable
     during linking
   - use the `-Wl,--rpath -Wl,LIBDIR' linker flag
   - have your system administrator add LIBDIR to `/etc/ld.so.conf'

See any operating system documentation about shared libraries for
more information, such as the ld(1) and ld.so(8) manual pages. 
```

好的，我将继续尝试使用其中一个测试套件程序链接它：

```
$ gcc test_dump.c -ljansson 
test_dump.c:8:21: fatal error: jansson.h: No such file or directory 
```

为了让 C 知道它可以使用什么，它首先需要知道包含文件。幸运的是，这只需要在编译时发生。我们使用包含目录传递，`-I`因此`gcc`知道在哪里可以找到包含文件：

```
$ gcc test_dump.c -I/home/ubuntu/mystuff/include -ljansson
/usr/bin/ld: cannot find -ljansson 
```

好的，现在回到链接问题。因此，让我们在链接时尝试`LD_LIBRARY_PATH`：

```
$ LD_LIBRARY_PATH="/home/ubuntu/mystuff/lib" gcc test_dump.c -I/home/ubuntu/mystuff/include -ljansson
/usr/bin/ld: cannot find -ljansson 
```

这不起作用，这背后的原因是 gcc 正在查看不同的目录，如运行所示：

```
gcc -print-search-dirs 
```

告诉 gcc 使用我们想要的目录，`-L`使用：

```
$ gcc test_dump.c -I/home/ubuntu/mystuff/include -L/home/ubuntu/mystuff/lib -ljansson
$ 
```

现在我们可以使用一个名为的程序`ldd`来查看它链接的内容：

```
$ ldd a.out 
        linux-vdso.so.1 =>  (0x00007fc4c872d000)
        libjansson.so.4 => not found
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fc4c8366000)
        /lib64/ld-linux-x86-64.so.2 (0x00007fc4c872e000) 
```

您会注意到它对我们想要的库显示“未找到”。现在尝试解决这个问题：

```
$ LD_RUN_PATH="/home/ubuntu/mystuff/lib" gcc test_dump.c -I/home/ubuntu/mystuff/include -L/home/ubuntu/mystuff/lib -ljansson 
```

这是一种方法，使用`LD_RUN_PATH`. 它不仅链接到库，还链接到库的完整路径。再次运行`ldd`显示：

```
$ ldd a.out 
        linux-vdso.so.1 =>  (0x00007fff481d7000)
        libjansson.so.4 => /home/ubuntu/mystuff/lib/libjansson.so.4 (0x00007fe86b0dd000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007fe86ad18000)
        /lib64/ld-linux-x86-64.so.2 (0x00007fe86b2eb000) 
```

现在，当我们在不`LD_RUN_PATH`涉及的情况下尝试这个时，我们会得到：

```
$ ./a.out 
./a.out: error while loading shared libraries: libjansson.so.4: cannot open shared object file: No such file or directory 
```

为了解决这个问题，`LD_LIBRARY_PATH`使用：

```
$ LD_LIBRARY_PATH="/home/ubuntu/mystuff/lib" ./a.out
$ 
```

然而，这有点像黑客和皱眉。大卫巴尔[在这件事上写了一篇很棒的文章](http://xahlee.info/UnixResource_dir/_/ldpath.html)。发生的事情是有一个动态库加载器，`ld.so/ld-linux.so`它“加载程序所需的共享库，准备程序运行，然后运行它”。如果您查看`ld.so`联机帮助页，它会指出：

```
 The necessary shared libraries needed by the program are searched for in the following order

   o      Using the environment variable LD_LIBRARY_PATH (LD_AOUT_LIBRARY_PATH for a.out programs).  Except if the executable is a setuid/setgid binary, in which case it is ignored.

   o      From the cache file /etc/ld.so.cache which contains a compiled list of candidate libraries previously found in the augmented library path. Libraries installed in hardware capabilities
          directories (see below) are prefered to other libraries.

   o      In the default path /lib, and then /usr/lib. 
```

那`/etc/ld.so.cache`就是您希望该路径所在的位置。此缓存是通过`ldconfig`使用生成的`/etc/ld.so.conf`。如果您在 Ubuntu 上查看该文件：

```
include /etc/ld.so.conf.d/*.conf 
```

这就是它所说的一切。默认情况下，在`/etc/ld.so.conf.d`目录中是 glib、gcc 的目录，`/usr/local/lib`因为它在默认路径之外。要将我们想要的目录添加到缓存中，您只需在该目录中添加一个文件：

```
$ sudo vim /etc/ld.so.conf.d/50-jansson.conf
- add /home/ubuntu/mystuff/lib to the file -
$ sudo ldconfig 
```

这将为`/etc/ld.so.cache`加载程序重新生成该文件。`ldconfig`您可以通过打印出缓存目录来确认该目录已被拾取：

```
$ ldconfig -p | grep "mystuff"
        libjansson.so.4 (libc6,x86-64) => /home/ubuntu/mystuff/lib/libjansson.so.4
        libjansson.so (libc6,x86-64) => /home/ubuntu/mystuff/lib/libjansson.so 
```

现在，如果我们`ldd`再次尝试运行：

```
$ ldd a.out 
        linux-vdso.so.1 =>  (0x00007fff1e510000)
        libjansson.so.4 => /home/ubuntu/mystuff/lib/libjansson.so.4 (0x00007f529da67000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f529d6a8000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f529dc7b000) 
```

最后运行程序：

```
$ ./a.out
$ 
```

这一切都有效！这是在进行链接时查看后端发生的情况。有关更多详细信息，我建议查看`man ld.so`and `man ldconfig`。如果您需要任何澄清，请随时询问。*

# java - 奇数/素数桶的可变范围字符串散列函数

> ID：14665496
> 
> 赞同：3
> 
> 时间：2013-02-02T19:14:58.100
> 
> 标签：java, hash

有谁知道可变范围的桶的散列函数（对于字符串，如果重要的话），它总是奇数（或素数，如果需要）？

本质上，我正在寻找一个散列函数，它将在 n 个桶上提供均匀分布，其中 n 是奇数（或素数，因为 n 会很小）。

Java`.hashCode()`提供统一分布，但仅适用于 2 的幂。

这是[我编写的一些快速测试代码，它断言了这一点](https://gist.github.com/4698738)。

[我在CS Theory StackExchange](https://cstheory.stackexchange.com/questions/16330/variable-range-string-hashing-function-for-odd-prime-buckets)上交叉发布了这个，因为它似乎介于理论和工程之间。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:31:58.740

以 37 作为存储桶长度运行您的程序，并将散列部分替换为

```
for (String key : keys) {
    int hash = key.hashCode();
    int index = Math.abs(hash % buckets.length);
    buckets[index] = buckets[index] + 1;
} 
```

导致以下结果：

```
Bucket 0: 4152
Bucket 1: 2593
Bucket 2: 2703
Bucket 3: 2620
Bucket 4: 2742
Bucket 5: 2647
Bucket 6: 2707
Bucket 7: 2673
Bucket 8: 2664
Bucket 9: 2685
Bucket 10: 2734
Bucket 11: 2708
Bucket 12: 2661
Bucket 13: 2678
Bucket 14: 2681
Bucket 15: 2662
Bucket 16: 2682
Bucket 17: 2667
Bucket 18: 2619
Bucket 19: 2572
Bucket 20: 2608
Bucket 21: 2669
Bucket 22: 2670
Bucket 23: 2629
Bucket 24: 2748
Bucket 25: 2651
Bucket 26: 2618
Bucket 27: 2628
Bucket 28: 2740
Bucket 29: 2608
Bucket 30: 2650
Bucket 31: 2645
Bucket 32: 2687
Bucket 33: 2699
Bucket 34: 2627
Bucket 35: 2715
Bucket 36: 2558
Mean: 2702.7027027027025
Standard Deviation: 245.8085241264752 
```

这看起来相当不错。

您不是在测试`String.hashCode()`. 如果 HashMap 的`hash()`方法使用密钥的 hashCode，并且旨在尝试为其容量获得均匀分布，则您正在测试分布，这必须是 2 的幂。如果`hashCode()`已经返回分布良好的值，只需取模使用素数作为除数将导致良好的分布。

# java - 数组中最大组合的算法

> ID：14665497
> 
> 赞同：-2
> 
> 时间：2013-02-02T19:15:06.920
> 
> 标签：java, arrays, algorithm, math

我有一个数组，例如长度为 4 个元素，我想知道在使用 3 个数字时如何计算可能的组合。

例如：

```
3 6 2
3 6 8
6 2 8
8 3 2 
```

我的数组是：3 6 2 8

有 4 种可能性，但我如何以编程方式计算它们？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:21:23.533

好吧，看来您实际上要寻找的是，这是从候选**[`Choose(n,k)`](http://en.wikipedia.org/wiki/Binomial_coefficient)**中选择`k`元素的方法的数量。`n`

它的公式基本上是`Choose(n,k) = n! / (k! * (n-k)!)`

其背后的道理是：

排序`n`项目的方法数（n！可能性），然后首先选择`k`。选择后，您不关心第一个`k`项目（`k!`可能性）和最后一个`n-k`项目（`(n-k)!`可能性）的顺序。

在您的示例中`Choose(4,3) = 4!/(3!*1!) = 4`，正如预期的那样。

# wordpress - 使用 Wordpress 多站点（子域），根据浏览器用户代理重定向特定站点，同时保留目录 url

> ID：14665498
> 
> 赞同：0
> 
> 时间：2013-02-02T19:15:12.627
> 
> 标签：wordpress, .htaccess, redirect, subdomain, user-agent

这是情况以及我需要它做什么，我不知道该怎么做。

我有一个 Wordpress 多站点（网络）设置。我的主站点是[http://domain.com ，我在](http://domain.com)[http://sub.domain.com](http://sub.domain.com)有一个 rss feeder 站点。[我需要来自http://sub.domain.com](http://sub.domain.com)的共享链接以重定向到[http://domain.com](http://domain.com)上的同一篇文章（即[http://sub.domain.com/2013/02/02/story/](http://sub.domain.com/2013/02/02/story/)应该基于用户代理重定向到[http://domain.com/2013/02/02/story/ ）。](http://domain.com/2013/02/02/story/)

例如，来自除 iPhone 之外的所有浏览器的读者都应该被重定向到主域上的相同故事。

我已经用 sub.domain.com 主题文件中的 .htaccess 尝试了几种方法，但它似乎不起作用 - 我不知道这是因为 domain.com .htaccess 文件覆盖它还是这是我正在使用的代码。

# java - Java泛型：接收实现类的类型参数的接口方法

> ID：14665499
> 
> 赞同：29
> 
> 时间：2013-02-02T19:15:12.907
> 
> 标签：java, generics, types

在Java中，是否可以定义一个具有接收实现类参数的方法的接口？

界面：

```
public interface MyInterface {
   public <T is/extends of the type of the implementing class> void method(T object);
} 
```

班级：

```
public class A implements MyInterface {

    public void method(A object) {
       ...
    }

} 
```

我要避免的是一个类可以用另一个像它自己的类来实现 MyInterface。

所以这不应该被允许：

```
public class A implements MyInterface<B> {

    public void method(B object) {
       ...
    }

} 
```

**编辑：**

好的，我尝试以另一种方式描述我想要实现的目标。我希望有几个类具有接受该类类型的 arg 的方法。因此，除了上面的 A 类之外，还可以说还有另一个 B 类，如下所示：

```
public class B implements MyInterface {

    public void method(B object) {
       ...
    }

} 
```

展位类 A 和 B 的共同点是一种称为“方法”的方法，它接收类本身类型的 arg。

在我的项目中，我想实现以下目标。我在写一个小游戏，想实现某种碰撞检测。基本上我想通过做一些“智能”多态调用来做到这一点。

我定义了一个接口 ICollisionReceiver，如下所示：

```
public interface ICollisionReceiver<T extends IShape> extends IShape {

    public boolean collides(T t);

} 
```

我定义了另一个这样的接口：

```
public interface ICollisionChecker<T extends ICollisionChecker<T>> extends IShape {

    public void addCollisionReceiver(ICollisionReceiver<T> receiver);

    public void removeCollisionReceiver(ICollisionReceiver<T> receiver);

} 
```

现在，例如，我的播放器在播放器接收碰撞并处理它们时实现接口 ICollisionReceiver。这应该以通用方式完成，例如我有盒子和圆圈，现在播放器实现 ICollisionReceiver < Box > 和 ICollisionReceiver < Circle > 所以我有这两种方法

```
@Override
public boolean collides(final Box b) {        
    ...
    return false;
} 
```

和

```
@Override
public boolean collides(final Circle c) {        
    ...
    return false;
} 
```

在我的 box 和 circle 类中，我可以注册 ICollisionReceivers，然后在更新方法中执行以下操作：

```
 boolean conti = true;
    int i=0;
    while(conti && i<collisionReceivers.size()) {
        final ICollisionReceiver<Bonus> rec = collisionReceivers.get(i);               
        if(this.collidesWith(rec)) {
            conti = rec.collides(this);
        }            
        ++i;
    } 
```

这基本上检查此框是否与某个接收器发生碰撞，然后调用接收器的 collides() 方法。

现在的重点是，我要确保 box 和 circle 类都仅使用它们自己的类型实现 ICollisionChecker 接口。

我明确地可以通过做这样的事情来做到这一点

```
public class Bonus extends AnimatedSprite implements ICollisionChecker<Bonus>... 
```

但这对我来说不是很满意......

对不起，很长的帖子，我希望这能说清楚。

* * *

## 回答 #1

> 赞同：38
> 
> 时间：2013-02-03T00:43:33.103

你想要的东西在 Java 中是不可能的，也没有用。

> 所以这不应该被允许：

为什么不？那有什么用？泛型不是为你做出任意限制的。泛型仅对消除您原本需要的强制转换有用，因为它可以证明强制转换总是安全的。

只要`public class A implements MyInterface<B>`是类型安全的，就没有必要制定禁止它的任意限制。

您应该简单地将您的界面定义为

```
public interface MyInterface<T> {
   public void method(T object);
} 
```

你可以定义你的班级

```
public class A implements MyInterface<A> {
    public void method(A object) {
    }
} 
```

如果其他人定义了一个类

```
public class B implements MyInterface<A> {
    public void method(A object) {
    }
} 
```

那么就这样吧。你为什么在乎？它会导致什么问题？

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-02T20:17:34.357

好吧，这至少是可能的：

```
public interface SelfImplementer<T extends SelfImplementer<T>> {
    void method(T self);
} 
```

如您所见，泛型声明看起来有点像无限递归，我相当确定如果 Java*没有*类型擦除，那将是 - 谢天谢地（？）所有泛型实际上都是`Objects`在编译器处理它们之后所以你可以这样做

```
public class Impl implements SelfImplementer<Impl> {
    @Override
    public void method(Impl self) {
        System.out.println("Hello!");
    }
} 
```

正如所料，这

```
public static void main(String[] args) {
    Impl impl = new Impl();
    impl.method(impl);
} 
```

打印出来

```
Hello! 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-02T19:25:39.613

你想要做的可能是这样的：

```
public interface MyInterface <T extends A> {
    public void method(T object) {
        ...
    }
}

public class A implements MyInterface<A_or_class_extending_A>
{ ... } 
```

我希望这有帮助！

# django - Hamlpy 和包含标签弄乱了 div

> ID：14665505
> 
> 赞同：0
> 
> 时间：2013-02-02T19:16:09.657
> 
> 标签：django, django-templates, haml

感谢您花时间看我的问题。

我有一个 hamlpy 模板，它调用呈现另一个模板的包含标记。

父模板和包含的模板都正确缩进。但是，在包含标记之后，html 的其余部分将被呈现，就好像它与包含标记在同一个 div 中一样。

我尝试在包含的模板和父模板中添加缩进，但这没有帮助。

父哈姆

```
 .main-column
    .column-holder
        .title
         ...
    - for promotion in live_promotions
      - display_promotion promotion
 .main-column
    .column-holder
      .title
        ...
  - for promotion in completed_promotions
    - display_promotion promotion 
```

有没有人有什么建议？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-10T06:56:41.757

其中一个父模板存在缩进问题。感谢您尝试提供帮助！

# mongodb - Casbah 和 Scala 的 MongoDB 插入行为

> ID：14665507
> 
> 赞同：0
> 
> 时间：2013-02-02T19:16:27.427
> 
> 标签：mongodb, scala, casbah

我在 Scala 中使用 casbah 插入 MongoDB，但不理解我看到的一些行为。

```
val wr = dao.collection.insert(myRecord, dao.defaultWriteConcern)
val error = wr.getCachedLastError 
```

好吧，这里没什么特别的。事实上，如果我插入一个文档，它会很好用。我的问题是，如果我再次插入同一个文档，那么我的错误 == null，我会期望某种迹象表明我正在尝试插入已经存在的记录。

这是因为我的 defaultWriteConcern 太“松散”，还是我只是不理解正确的行为？我正在使用 casbah 2.5.0.SNAPSHOT。我使用的是旧版本，我似乎记得它给了我某种错误，这是我所期望的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:52:31.487

除非您违反具有重复字段的唯一索引，否则您不会收到创建具有重复内容的记录的错误。

# java - debian蓝牙bluecove java7不工作

> ID：14665511
> 
> 赞同：6
> 
> 时间：2013-02-02T19:16:47.460
> 
> 标签：java, bluetooth, debian, java-7, bluecove

我有一个干净的 Debian 挤压安装，并试图让一个 jar 应用程序运行，该应用程序将与 USB 端口中的蓝牙加密狗进行通信。硬件方面都在这里运行良好的蓝牙功能。我需要通过从 oracle 下载 jdk 并使用 update-alternatives 将其绑定到系统来运行已安装的 Java7。

Java 应用程序需要 bluecove 作为与系统通信的库。我的 bluecove.jar 文件在我的类路径 /home/app/lib 中有 gpl 和普通快照。

当我通过执行应用程序时，`java -cp /home/app/lib/bluecove-2.1.1-SNAPSHOT.jar -jar myapp.jar`我一遍又一遍地遇到相同的错误，无法弄清楚。它就像java无法加载bluecove。

```
Exception in thread "main" javax.bluetooth.BluetoothStateException: BlueCove com.intel.bluetooth.BluetoothStackBlueZ|com.intel.bluetooth.BluetoothStackBlueZDBus not available
        at com.intel.bluetooth.BlueCoveImpl.loadStackClass(BlueCoveImpl.java:356)
        at com.intel.bluetooth.BlueCoveImpl.detectStack(BlueCoveImpl.java:447)
        at com.intel.bluetooth.BlueCoveImpl.access$500(BlueCoveImpl.java:69)
        at com.intel.bluetooth.BlueCoveImpl$1.run(BlueCoveImpl.java:1044) 
```

有人见过这个吗？谢谢！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2016-07-04T07:35:35.267

[https://code.google.com/archive/p/bluecove/downloads](https://code.google.com/archive/p/bluecove/downloads)

下载“bluecove-2.1.0.jar”和“bluecove-gpl-2.1.0.jar”。linux 也需要一个 bluecove-gpl jar 文件。

然后在运行时导出或使用 -cp

```
export CLASSPATH=$CLASSPATH:(/your bluecove jar location)
export CLASSPATH=$CLASSPATH:(/your bluecove gpl jar location)
java -jar myapp.jar 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-03-07T16:07:24.887

我终于做了这里描述的事情，经过几次尝试，它终于在重新编译后工作了。不知道为什么需要这样做，但它有效：

[https://sites.google.com/site/opengaragedoor1/home/stages/raspberry-pi](https://sites.google.com/site/opengaragedoor1/home/stages/raspberry-pi)

# css - 使用 Draw AP DIV Tool 使用 Dreamweaver 创建布局

> ID：14665512
> 
> 赞同：0
> 
> 时间：2013-02-02T19:16:49.070
> 
> 标签：css

我是使用 Dreamweaver 的新手，在设计视图中，我在布局中看到了一个名为 Draw API DIV 的选项。通过使用这个我得到了这样的css

```
#apDiv1 {
    position:absolute;
    left:895px;
    top:554px;
    width:279px;
    height:385px;
    z-index:1;
    background-color: #C3D4EE;
} 
```

这是为网站做布局的正确方法吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:21:10.177

这是*一种*方式，但非常脆弱。

当字体大小发生变化时，可能会导致文本从容器中溢出（这些天浏览器倾向于使用页面缩放而不是文本大小调整，但是如果指定的字体在客户端上不可用，那么替代品很可能会占用不同数量的空间）。

它不会适应不同的视口大小（通常由台式机/笔记本电脑上的窗口大小以及手机和平板电脑上的屏幕大小决定）。

根据经验，通过指向和单击生成的任何类型的布局都不适合在 WWW 上使用。

# android - API自动将apk上传到Google Play？

> ID：14665518
> 
> 赞同：98
> 
> 时间：2013-02-02T19:17:38.390
> 
> 标签：android, api, apk, publish, google-play

是否有任何 API 或工具可以让我自动将 APK 上传到 Google Play？我想自动将定制的应用程序发布到我的帐户，而无需任何手动步骤或图形界面。

我四处搜索，但找不到任何用于执行此操作的 API（只有[android-publisher](https://developers.google.com/android-publisher/v1/)，但它不支持发布，尽管它的名称）。有没有人已经解决了这个问题，似乎是一个基本功能？

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2014-07-29T00:16:19.757

截至今天，有一个新的官方发布 API 允许您上传到任何频道（即 alpha、beta...）或更新标题和描述等。

从文档：

> *   上传应用程序的新版本发布应用程序，通过将 APK 分配到各种轨道（alpha、beta、分阶段推出或生产）
> *   创建和修改 Google Play 商店列表，包括
> *   本地化文本和图形以及多设备屏幕截图

在这里查看更多信息：[https ://developers.google.com/android-publisher/](https://developers.google.com/android-publisher/)

* * *

## 回答 #2

> 赞同：23
> 
> 时间：2015-06-20T17:49:45.053

[gradle-play-publisher](https://github.com/Triple-T/gradle-play-publisher)是一个 Gradle 插件，用于将您的 APK 和应用详细信息上传到 Google Play 商店。

我只是`./gradlew publishApkRelease`从我的终端运行，它会上传 APK 和最近更改的摘要。还有更多这样的任务可用。

它使用[Google Play 开发者 API](https://developers.google.com/android-publisher/)

* * *

## 回答 #3

> 赞同：20
> 
> 时间：2013-04-29T14:32:45.977

~~没有用于自动使用 Google Play 的官方 Google API。~~（2014 年 7 月后情况并非如此）

您可以创建一个封装 Web 浏览器并模拟用户行为的脚本：查找 HTML 字段、在此处输入信息、提交页面等。

我们正在开发这样的开源 Python 工具： [https ://github.com/onepf/AppDF/tree/master/tools/uploader](https://github.com/onepf/AppDF/tree/master/tools/uploader)

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2014-08-17T21:21:15.043

我也在这个问题上回答了[这个问题](https://stackoverflow.com/questions/23427304/automatic-publish-beta-android-app-to-the-google-play-store/25353690#25353690)，但我想我会在这里添加相同的评论。让我知道这是否是错误的方法（重复答案）。

我能够创建一个 gradle 插件，它可以使用新的 Google Play Publishing API 发布到您希望的任何风格/变体的任何轨道。

在此处查看来源：[https ://github.com/bluesliverx/savillians-gradle](https://github.com/bluesliverx/savillians-gradle)

我正在努力将它发布到 maven Central，以便它可以在构建脚本中使用，但是现在你可以`android-publisher`在 repo 中获取子目录，将它放在你的 gradle 构建的根目录中，然后将文件夹重命名为`buildSrc`. `build.gradle`在文件中为您要发布的 android 项目使用以下行：

```
apply plugin: com.savillians.gradle.androidpublisher.AndroidPublisherPlugin 
```

然后，您可以使用`androidPublisher`build.gradle 文件中的块设置发布设置。

```
android {
    ...
}
androidPublisher {
    applicationName = "Company-Name-Product-Name/1.0"
    packageName = "<package name>"
    serviceAccountEmail = "<service account email>"
    serviceAccountKeyFile = file('<p12 keyfile - NOT the json file>')
    track = "alpha" // default, don't need to specify
    variantName = "release" // default, don't need to specify
} 
```

确保您创建的服务帐户具有“发布管理器”权限，下载 p12 密钥文件并将其放在项目目录中。然后运行这个命令：

```
gradle androidPublish 
```

这将使用您指定的凭据将其发送到 Google Play。祝你好运，如果您有任何问题，请告诉我，因为这是全新的。

# c# - 将文本设置为自定义标题页枢轴

> ID：14665521
> 
> 赞同：0
> 
> 时间：2013-02-02T19:18:01.357
> 
> 标签：c#, silverlight, windows-phone-7, xaml

我已经创建了数据透视页面，我希望在顶部的 2 个文本块中显示一些信息。我创建了 DataTemplate 并为文本字段设置了 x:names。但是我不能从页面构造函数到这个文本块并在那里放置文本。为什么？我怎么能欺骗这种情况？我需要在页面加载时将信息放入文本块中。

```
 <controls:Pivot.TitleTemplate>
            <DataTemplate>
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="textBlock_eventID" TextWrapping="NoWrap" Margin="0"/>
                    <TextBlock x:Name="textBlock_eventName"  TextWrapping="NoWrap" Opacity="0.7"/>
                </StackPanel>
            </DataTemplate>
        </controls:Pivot.TitleTemplate> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T10:04:51.030

使用 DataTemplate 的目的是定义业务对象的表示。也就是说，如果你有一个像下面这样的类：

```
public class MyClass
{
    public string StringOne { get; set; }
    public string StringTwo { get; set; }
} 
```

如果将 Pivot 控件的 Title 属性设置为此类的实例，则可以使用 DataTemplate 来定义您希望它的外观。

在您的情况下，模板可能如下所示：

```
 <controls:Pivot.TitleTemplate>
        <DataTemplate>
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="{Binding StringOne}" TextWrapping="NoWrap" Margin="0"/>
                <TextBlock Text="{Binding StringTwo}" TextWrapping="NoWrap" Opacity="0.7"/>
            </StackPanel>
        </DataTemplate>
    </controls:Pivot.TitleTemplate> 
```

然后从代码隐藏中，您将设置 Pivot 控件的 Title 属性。像这样的东西：

```
 myPivotControl.Title = new MyClass 
     { 
         StringOne = "Some String", 
         StringTwo = "Some other string" 
     }; 
```

* * *

还有另一种方法可以做到这一点，它允许您从后面的代码中简单地设置文本框，但这不涉及 DataTemplate。

如下设置 Pivot 控件的 Title 属性，将使您能够按名称访问 TextBox：

```
 <controls:Pivot.Title>
        <StackPanel Orientation="Horizontal">
            <TextBlock x:Name="textBlock_eventID" TextWrapping="NoWrap" Margin="0"/>
            <TextBlock x:Name="textBlock_eventName"  TextWrapping="NoWrap" Opacity="0.7"/>
        </StackPanel>
    </controls:Pivot.Title> 
```

[阅读本文以了解有关 DataTemplate 的更多信息](http://msdn.microsoft.com/en-us/library/cc903947%28v=vs.95%29.aspx)

# nsurl - -[NSURL isFileReferenceURL] 有什么特点？

> ID：14665522
> 
> 赞同：8
> 
> 时间：2013-02-02T19:18:07.697
> 
> 标签：nsurl, file-reference-url

该方法`-isFileReferenceURL`是在类上定义的，`NSURL`但我不知道该方法是什么。我认为这决定了 URL 是否指向实际文件，但事实并非如此。`NO`即使文件存在，它也会返回。手册说只是

```
isFileReferenceURL Returns whether the URL is a file reference URL.

- (BOOL)isFileReferenceURL Return Value YES if the URL is a file reference URL; otherwise, NO.

Availability Available in iOS 5.0 and later. (Symbol is present in iOS 4, but performs no operation.) Declared In NSURL.h 
```

这是什么方法？*文件参考 URL*是什么？这个方法什么时候返回`YES`？

* * *

## 回答 #1

> 赞同：22
> 
> 时间：2013-02-02T19:35:46.920

文件引用 URL 是一个特殊的 URL，它直接引用文件，而不是“此路径中的任何文件”。例如，如果用户移动它，这允许它仍然指向文件，这非常有用。`-fileReferenceURL`您可以通过在任何常规文件 URL 上调用该方法来创建文件引用URL。

* * *

## 回答 #2

> 赞同：-6
> 
> 时间：2013-02-02T19:32:48.133

尝试使用`isFileURL`. “文件参考 URL”和“指向文件的 URL”是有区别的。;)

# c# - 泛型运算符“+”不能应用于“T”和“T”类型的操作数

> ID：14665527
> 
> 赞同：-1
> 
> 时间：2013-02-02T19:18:59.647
> 
> 标签：c#, generics

> **可能重复：**
> [.NET 泛型中重载运算符约束的解决方案在泛型中](https://stackoverflow.com/questions/147646/solution-for-overloaded-operator-constraint-in-net-generics)
> [实现算术？](https://stackoverflow.com/questions/10951392/implementing-arithmetic-in-generics)

我写了泛型类，但我遇到了标题中描述的问题。

```
class Program
    {
        static void Main(string[] args)
        {
            int a = 1;
            int b = 2;
            int c = 3;

            dynamic obj = new Gen<int>();
            obj.TestLine1(ref a, ref b);
            obj = new Gen<string>();
            obj.TestLine2(ref a, ref b, ref c);
            System.Console.WriteLine(a + " " + b);
            Console.ReadLine();
        }
    }

public class Gen<T>
    {
        public void TestLine1(ref T a, ref T b)
        {
            T temp;
            temp = a;
            a = b;
            b = temp;
        }
        public void TestLine2(ref T a, ref T b, ref T c)
        {
            T temp;
            temp = a;
            a = a + b;
            b = a + c;
            c = a + b;
        }
    } 
```

在方法 TestLine2(ref T a, ref T b, ref T c) 里面我遇到了以下问题：

```
Operator '+' cannot be applied to operands of type 'T' and 'T' 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T19:21:29.930

由于`T`可以是任何类型，因此不能保证`T`会有静态`+`运算符。在 C# 中，没有办法限制`T`支持静态运算符，例如`+`，因此您必须传递函数以用于组合 to 的`T`值`TestLine2`：

```
public void TestLine2(ref T a, ref T b, ref T c, Func<T, T, T> op)
{
    T temp;
    temp = a;
    a = op(a, b);
    b = op(a, c);
    c = op(a, b);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:31:53.060

你不知道是否`T`实现了 + 运算符。如果你`object`作为类型参数传递呢？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:31:27.147

假设我像这样创建了你的类的一个实例：`var gen = new Gen<Object>()`. 现在`T`意味着`Object`在你的类的这个实例中的任何地方。当您调用 时`TestLine2()`，该方法将尝试添加到对象中，这在 C# 中是无法完成的。

更广泛地说，由于 C# 不提前知道您将使用什么类型的参数创建`Gen`对象，因此它限制您只能使用为所有对象定义的方法。

在我看来，您真的想`TestLine2`成为一种组成字符串的方法。为什么不创建`Gen`一个非泛型类并告诉它在`String`任何地方都使用 s 呢？

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T19:21:14.623

因为直到实例化才知道 T 的类型，所以不能保证类型 T 将支持 + 运算符。

# jquery - Jquery Slider 在 IE7 中损坏

> ID：14665530
> 
> 赞同：0
> 
> 时间：2013-02-02T19:19:19.587
> 
> 标签：jquery, internet-explorer-7, slider, anythingslider

我似乎无法弄清楚/调试 IE7 中的 jquery 滑块。它在anythingslider.js 文件的第680 行抛出一个错误，指出[2] 为空。知道发生了什么吗？

这是页面： [http ://www.baltimoreschoolofmusic.org](http://www.baltimoreschoolofmusic.org)

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-04T15:44:48.447

问题是 IE7 似乎无法识别其中的任何内容，`UL`如果每个内容`LI`都包含在链接中：

```
<ul id="slider">
  <a href="slide-page.php">
    <li>
      <img src="myimage.jpg">
      <h2>Header</h2>
      <p>text.</p>
    </li>
  </a>

  <!-- more li's wrapped in a's -->

</ul> 
```

因此，将链接移动到内部`LI`：

```
<ul id="slider">
  <li>
    <a href="slide-page.php">
      <img src="myimage.jpg">
      <h2>Header</h2>
      <p>text.</p>
    </a>
  </li>

  <!-- more li's -->

</ul> 
```

我试图做[一个演示](http://jsfiddle.net/ycUB6/4066/)，但 jsFiddle 似乎不想在 IE7 中运行......哦，好吧。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:52:29.937

我还在您页面的第 13 行而不是 js 插件上收到错误。我在 WinXP 上测试 IE7。第 13 行错误： `Object doesn't support this property or method.`

这是： `$("#sildes").slides();`

您在第 608 行和第 619 行引用的错误类似，因为数组节点中有一个 if 语句：

`d[base.dir] = -base.panelSize[(o.infiniteSlides && base.pages > 1) ? page : page - 1][2];`

阵列有多深？抱歉，我已将此作为评论添加，但我还没有达到 50 分。而且，我同意，IE7 应该被淘汰！

**这个怎么样：在你的脑海中你正在打电话`slides.js`- 那就是抛出一个 404。**

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T09:51:04.733

就是不支持IE7。这是简单的答案。检查浏览器是否为 IE7，然后将滑块替换为图像。无论如何，IE 的用户通常会被滑块分散注意力，并且总体上不喜欢交互性。如果他们想要漂亮的观看/交互体验，他们就不会使用 IE7。

说真的，你在浪费你的时间，这对你的用户/客户转换目标没有帮助，即使是 1%。这不是编码答案，而是基于营销和商业的答案。

# c# - 从 DataGridView 和数据库中删除行

> ID：14665532
> 
> 赞同：1
> 
> 时间：2013-02-02T19:19:25.903
> 
> 标签：c#, sql-server, winforms

我在每个论坛上都在搜索，但找不到解决方案。这应该很容易，但它不起作用。

我创建了`DataGridView`名为“doctorsDataGridView”的以 Doctors Table 作为源。我不想让用户添加项目，但允许删除和编辑。对于删除首先我把这个代码：

```
private void doctorsDataGridView_RowsRemoved(object sender, DataGridViewRowsRemovedEventArgs e)
{
    // Update the balance column whenever rows are deleted.
    try
    {
        SqlCommand cmd = new SqlCommand("DELETE FROM [Doctors] WHERE ([DoctorCode] = @code)", Welcome.con);
        cmd.Parameters.Add("@code", SqlDbType.Int).Value = doctorsDataGridView.Rows[e.RowIndex].Cells["DoctorCode"].Value;
        cmd.ExecuteNonQuery();
    }
    catch (Exception ex)
        { MessageBox.Show(ex.ToString()); }
}

private void doctorsBindingNavigatorSaveItem_Click(object sender, EventArgs e)
{
    this.Validate();
    this.doctorsBindingSource.EndEdit();
    this.tableAdapterManager.UpdateAll(this.clincDataSet);
}

private void AllDoctors_Load(object sender, EventArgs e)
{
    // TODO: This line of code loads data into the 'clincDataSet.Doctors' table. You can move, or remove it, as needed.
    this.doctorsTableAdapter.Fill(this.clincDataSet.Doctors);
} 
```

但是当我尝试删除任何行时，它只会从数据库中删除，`DatagridView`而不是从数据库中删除。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T23:36:37.220

尝试将您的代码放入[`DataGridView.UserDeletingRow Event`](http://msdn.microsoft.com/en-us/library/system.windows.forms.datagridview.userdeletingrow.aspx)

```
private void doctorsDataGridView_UserDeletingRow(object sender, DataGridViewRowCancelEventArgs e)
{
    // Update the balance column whenever rows are deleted.
    try
    {
        SqlCommand cmd = new SqlCommand("DELETE FROM [Doctors] WHERE ([DoctorCode] = @code)", Welcome.con);
        cmd.Parameters.Add("@code", SqlDbType.Int).Value = doctorsDataGridView.Rows[e.RowIndex].Cells["DoctorCode"].Value;
        cmd.ExecuteNonQuery();
    }
    catch (Exception ex)
        { MessageBox.Show(ex.ToString()); }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:39:10.840

我在这里看不出任何问题，但如果我是你，我会这样做：

*   打开 SQL Server 探查器并首先查看是否有任何东西到达 SQL Server
*   检查您的数据库引用？Doctors 表是否被其他表引用？也许这会阻止您删除数据
*   使用调试器单步执行代码并在执行 cmd.ExecuteNonQuery() 之前检查 SQL 语句 - 尝试在 SSMS 中手动执行相同的语句

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T23:06:25.837

你确定你的 sql 命令执行正确吗？
MSDN：“ExecuteNoneQuery() 对于 UPDATE、INSERT 和 DELETE 语句，返回值是受命令影响的行数”，因此您的 ExecuteNonewQuery() 必须返回 1；

注意：每次加载数据时都会调用 datagridview rowsremoved 事件。在一定程度上，每次加载数据时，都会删除现有的行。所以从技术上讲，该事件应该被调用。

你可以有一个私有的布尔变量来知道你什么时候加载，什么时候不加载。

```
 private bool IsLoading { get; set; }

    private void MyForm_Load(object sender, EventArgs e)
{
    this.IsLoading = true;
// do stuff
    this.IsLoading = false;
}

private void DataGridView_RowsRemoved(object sender, DataGridViewRowsRemovedEventArgs e)
{
            if (!this.IsLoading)
            {
                return;
            }

   //do stuff
} 
```

# actionscript-3 - 如何选择输入文本框中的所有文本

> ID：14665537
> 
> 赞同：0
> 
> 时间：2013-02-02T19:20:12.583
> 
> 标签：actionscript-3, flash-cs6

![在此处输入图像描述](../Images/2e07df3b77b03c053b9288f785d1c8f7.png)

嗨，我正在使用 actionscript 3，我想选择文本框中的所有文本，如上图所示。

一旦我想在文本框中输入我自己的值，我想选择所有文本。

目前，当我想输入自己的值时，我必须在手机和计算机上按退格键。

任何人都可以为此提供代码吗？

提前感谢任何重播的人！

# java - 缓存 WSDL 响应的有效方法

> ID：14665539
> 
> 赞同：1
> 
> 时间：2013-02-02T19:20:29.290
> 
> 标签：java, xml, database, caching, wsdl

我的基于 Java 的 Web 应用程序正在与远程 WSDL Web 服务交互。

我构造了一个特定于服务的 WSDL 请求。我使用 HTTP 客户端发出此 WSDL 请求，并返回 WSDL 响应。

由于我的情况可以接受，为了优化性能和带宽使用，我想缓存 WSDL 响应，以便下次我发出相同的请求时，我的 Web 应用程序可以直接从持久数据库加载响应。

有了`JAXB.marshal`，`JAXB.unmarshal`我可以得到序列化 XML 格式和“Java 对象表示”的响应表示。所以我有了建立一个数据库来保存编组的 XML 表示的想法。但在我的例子中，典型响应的 XML 文件表示很容易达到 200 KB。正如我们对 XML 文件所了解的那样，这个大小在很大程度上与 XML 的冗长有关，并且可能会大大减少以优化数据库容量使用和数据库读写速度。

是否有缓存和持久化 WSDL 响应的有效方法？也就是说，我正在寻找一种为函数实现映射的好方法 `f(someWSDLRequest) -> someWSDLResponse`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-03T02:02:02.533

要缓存，您需要一个键和一个值。在这种情况下，显然值是来自 SOAP 服务的响应。

对于关键，为什么不尝试将参数连接成一个字符串（我以前见过很多次）或者对请求进行 MD5 散列。它使缓存键小而简单，如果请求相同，它将始终相同。

当一个请求进来并且你在缓存中有响应时，提供它。

如果不存在，则从数据库中获取，放入缓存中，然后提供服务。

如果底层对象发生变化（缓存的响应），则使缓存无效，或者只是在其上设置一个过期时间，让它随着时间的推移而发生。

# c++ - 如何在 C++ 中使用 winsock 接收 udp 数据包？

> ID：14665543
> 
> 赞同：12
> 
> 时间：2013-02-02T19:20:51.720
> 
> 标签：c++, sockets, udp, winsock

作为试图围绕 udp 套接字的尝试，我尝试将代码从本教程页面[http://www.linuxhowtos.org/C_C++/socket.htm](http://www.linuxhowtos.org/C_C++/socket.htm)移植到 winsock（如果重要，在 win 8 上运行）。[以下直接链接]

代码当前编译并运行，但我从未收到数据包，两个程序都只是等待并阻塞 recvfrom()。我一直遇到同样的问题（例如，使用包含 recvfrom() 调用的此代码的修改版本[https://stackoverflow.com/a/679529/873217 。并且使用此代码](https://stackoverflow.com/a/679529/873217)[C++ 问题与 Datagram (UDP)winsocket 到sendto 和 recvfrom 通过环回适配器在同一个套接字上进行](https://stackoverflow.com/questions/6538707/c-problem-with-datagram-udpwinsocket-to-sendto-and-recvfrom-on-the-same-sock)建议的更改）。我想我犯了一些简单而根本的错误；但我无法自己找到它。希望有更多经验的人可以为我解决这个问题。谢谢。

附加说明：
我在同一台计算机上运行服务器 exe，然后运行客户端 exe。它连接到互联网。我也尝试过使用解析为我的 IP 地址的域。我也尝试过禁用防火墙，尽管我已经允许两个程序完全访问。

直接链接到原始客户端和服务器代码：
[http ://www.linuxhowtos.org/data/6/client_udp.c](http://www.linuxhowtos.org/data/6/client_udp.c)
[http://www.linuxhowtos.org/data/6/server_udp.c](http://www.linuxhowtos.org/data/6/server_udp.c)

我目前的尝试：

都链接到 libws2_32.a

客户端代码：

```
#include <stdio.h>
#include <winsock2.h>
#include <string.h>

void error(const char *);

int main()
{
    WSAData data;
    WSAStartup( MAKEWORD( 2, 2 ), &data );

    int sock, n;
    int length;
    struct sockaddr_in server, from;
    struct hostent *hp;
    char buffer[256];
    unsigned short serverPort = 27072;
    sock = socket(AF_INET, SOCK_DGRAM, 0);
    if (sock < 0) error("socket");
    server.sin_family = AF_INET;
    hp = gethostbyname("localhost");//have also tried my url
    if (hp==0) error("Unknown host");
    memmove((char *)hp->h_addr, (char *)&server.sin_addr, hp->h_length);
    server.sin_port = htons(serverPort);
    length = sizeof(struct sockaddr_in);
    printf("Please enter the message: ");
    memset(buffer, 0, 256);
    fgets(buffer, 255, stdin);
    n = sendto (sock, buffer, strlen(buffer), 0, (const struct sockaddr *)&server, length);
    if (n < 0) error("Sendto");
    printf("sent %i bytes\n", n);
    n = recvfrom(sock, buffer, 256, 0, (struct sockaddr *)&server, &length);
    if (n < 0) error("recvfrom");
    //write(1,"Got an ack: ", 12);
    //write(1, buffer, n);
    printf("Got msg: %s\n",buffer);

    closesocket(sock);
    WSACleanup();
    return(0);
}

void error(const char *msg)
{
    perror(msg);
    exit(0);
} 
```

服务器代码：

```
#include <stdio.h>
#include <winsock2.h>
#include <string.h>

void error(const char *);

int main()
{
    WSAData data;
    WSAStartup( MAKEWORD( 2, 2 ), &data );

    int sock, length, n;
    int fromlen;
    struct sockaddr_in server;
    struct sockaddr_in from;
    char buf[1024];
    unsigned short serverPort = 27072;
    sock=socket(AF_INET, SOCK_DGRAM, 0);
    if (sock < 0) error("Opening socket");
    length = sizeof(server);
    memset(&server, 0, length);
    server.sin_family = AF_INET;
    server.sin_addr.s_addr=INADDR_ANY;
    server.sin_port=htons(serverPort);
    if (bind(sock,(struct sockaddr *)&server, length)<0) error ("binding");
    fromlen = sizeof(struct sockaddr_in);
    while(1)
    {
        n = recvfrom(sock, buf, 1024, 0, (struct sockaddr *)&from, &fromlen);
        if (n<0) error("recvfrom");
        //write(1,"Received a datagram: ", 21);
        //write(1,buf,n);
        printf("Received a datagram: %s", buf);
        n = sendto(sock, "Got your message\n",17,0,(struct sockaddr *)&from,fromlen);
        if (n<0)error("sendto");
    }
    closesocket(sock);
    WSACleanup();
    return 0;
}

void error (const char *msg)
{
    perror(msg);
    exit(0);
} 
```

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2014-08-12T05:11:49.130

以下 UDP 测试应用程序在我的设置上正常工作 - Windows 7、VS 2013。

我创建了一些轻量级的包装类来进行资源管理，并将错误代码转换为异常。这使得客户端和服务器代码更易于阅读。请务必先运行服务器。

**网络.h**

```
#include <WinSock2.h>
#include <WS2tcpip.h>
#include <system_error>
#include <string>
#include <iostream>

#pragma once

class WSASession
{
public:
    WSASession()
    {
        int ret = WSAStartup(MAKEWORD(2, 2), &data);
        if (ret != 0)
            throw std::system_error(WSAGetLastError(), std::system_category(), "WSAStartup Failed");
    }
    ~WSASession()
    {
        WSACleanup();
    }
private:
    WSAData data;
};

class UDPSocket
{
public:
    UDPSocket()
    {
        sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP);
        if (sock == INVALID_SOCKET)
            throw std::system_error(WSAGetLastError(), std::system_category(), "Error opening socket");
    }
    ~UDPSocket()
    {
        closesocket(sock);
    }

    void SendTo(const std::string& address, unsigned short port, const char* buffer, int len, int flags = 0)
    {
        sockaddr_in add;
        add.sin_family = AF_INET;
        add.sin_addr.s_addr = inet_addr(address.c_str());
        add.sin_port = htons(port);
        int ret = sendto(sock, buffer, len, flags, reinterpret_cast<SOCKADDR *>(&add), sizeof(add));
        if (ret < 0)
            throw std::system_error(WSAGetLastError(), std::system_category(), "sendto failed");
    }
    void SendTo(sockaddr_in& address, const char* buffer, int len, int flags = 0)
    {
        int ret = sendto(sock, buffer, len, flags, reinterpret_cast<SOCKADDR *>(&address), sizeof(address));
        if (ret < 0)
            throw std::system_error(WSAGetLastError(), std::system_category(), "sendto failed");
    }
    sockaddr_in RecvFrom(char* buffer, int len, int flags = 0)
    {
        sockaddr_in from;
        int size = sizeof(from);
        int ret = recvfrom(sock, buffer, len, flags, reinterpret_cast<SOCKADDR *>(&from), &size);
        if (ret < 0)
            throw std::system_error(WSAGetLastError(), std::system_category(), "recvfrom failed");

        // make the buffer zero terminated
        buffer[ret] = 0;
        return from;
    }
    void Bind(unsigned short port)
    {
        sockaddr_in add;
        add.sin_family = AF_INET;
        add.sin_addr.s_addr = htonl(INADDR_ANY);
        add.sin_port = htons(port);

        int ret = bind(sock, reinterpret_cast<SOCKADDR *>(&add), sizeof(add));
        if (ret < 0)
            throw std::system_error(WSAGetLastError(), std::system_category(), "Bind failed");
    }

private:
    SOCKET sock;
}; 
```

**服务器**

```
#include "Network.h"

int main()
{
    try
    {
        WSASession Session;
        UDPSocket Socket;
        char buffer[100];

        Socket.Bind(100);
        while (1)
        {
            sockaddr_in add = Socket.RecvFrom(buffer, sizeof(buffer));

            std::string input(buffer);
            std::reverse(std::begin(input), std::end(input));
            Socket.SendTo(add, input.c_str(), input.size());
        }
    }
    catch (std::system_error& e)
    {
        std::cout << e.what();
    }
} 
```

**客户**

```
#include "Network.h"

int main()
{
    try
    {
        WSASession Session;
        UDPSocket Socket;
        std::string data = "hello world";
        char buffer[100];

        Socket.SendTo("127.0.0.1", 100, data.c_str(), data.size());
        Socket.RecvFrom(buffer, 100);
        std::cout << buffer;
    }
    catch (std::exception &ex)
    {
        std::cout << ex.what();
    }
    char c;
    std::cin >> c;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T19:45:06.007

好吧，我不确定 winsock2.h 在 Windows 和 Linux 中的工作方式是否相同，但是在 Windows 中，当您创建套接字时，您必须设置您使用的协议，TCP 或 UDP：

```
SOCKET sock = socket(AF_INET, SOCK_STREAM, IPPROTO_TCP); 
```

AF_INET = IPv4；SOCK_STREAM = TCP 的字节流；IPPROTO_TCP = TCP 协议。

对于 UDP（我以前从未使用过），根据 MSDN，它将是：

```
SOCKET sock = socket(AF_INET, SOCK_DGRAM, IPPROTO_UDP); 
```

SOCK_DGRAM = UDP 的字节流；IPPROTO_UDP = UDP 协议。

该代码将在 Windows 中运行。我想在Linux中它会是相似的。

# iphone - 播放 2048 X 1536 .mov 文件

> ID：14665544
> 
> 赞同：0
> 
> 时间：2013-02-02T19:20:53.890
> 
> 标签：iphone, ios, objective-c, media-player

我正在`MPMoviePlayerController`尝试播放 .mov 文件。我没有做任何不寻常的事情，只是按照一些样板代码来播放视频。

现在，一切都在模拟器上运行良好。但是，当我尝试在实际的 iPad（视网膜和非视网膜）上播放视频时，什么也没有发生。它尝试播放，显然失败且没有错误，并调用完成通知。

.mov 文件大小为 16 MB，采用 H.264、线性 PCM 和时间码编码；颜色配置文件：高清 (1-1-1)。

查看一些文档，我发现一些不寻常的事情：

> 支持的格式：H.264 Baseline Profile Level 3.0 视频，在 30 fps 时高达 640 x 480。

高达 640 x 480？这很奇怪。我误解了吗？如何播放更高分辨率的视频？

同样奇怪的是，将视频的分辨率降低到 1840 x 1376 会播放视频，但任何更高的分辨率都无法在设备上播放。在我看来，该设备可能会遇到一些内存问题，但我确信这是可以做到的。例如，Apple 如何播放从 iTunes 下载的高清预告片或电影？

播放我的 mov 文件的正确方法是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-06-26T17:29:19.567

iPad2 技术规格在[这里](http://www.apple.com/ipad/ipad-2/specs.html)。他们声明 1080p (1920×1080)“高清”是最大分辨率。那就是h.264 High Profile level 4.1。这个维基百科页面描述了[h.264 配置文件](http://en.wikipedia.org/wiki/H.264/MPEG-4_AVC#Profiles)。这是一次可以解码多少个宏块的硬件限制，而不是严格的像素大小，所以我看不出你如何解决它。您只需要查看可以运行的最大尺寸是多少，然后使用它。

# c++ - C++ 中的互斥锁是否必须绑定到某个对象或变量？

> ID：14665546
> 
> 赞同：9
> 
> 时间：2013-02-02T19:20:58.460
> 
> 标签：c++, multithreading, mutex

我对线程有点陌生，我试图了解它在 C++11 中是如何工作的。我班的教授给了我们这个示例代码来演示互斥锁的使用：

```
#include <list> 
#include <mutex> 
#include <algorithm>

std::list<int> some_list; // A data structure accessed by multiple threads
std::mutex some_mutex; // This lock will prevent concurrent access to the shared data structure

void
add_to_list(int new_value) {
    std::lock_guard<std::mutex> guard(some_mutex); // Since I am going to access the shared data struct, acquire the lock
    some_list.push_back(new_value); // Now it is safe to use some_list. RAII automatically releases lock at end of function }
}

bool
list_contains(int value_to_find) {
    std::lock_guard<std::mutex> guard(some_mutex); // Must get lock every time I access some_list return
    std::find (some_list.begin(),some_list.end(),value_to_find) != some_list.end();
} 
```

我认为代码有点不言自明，但我有一些具体问题。

1.  是否不需要专门将互斥锁与列表相关联？
2.  如果不是，这是否意味着任何时候使用互斥锁，所有线程都会停止，直到互斥锁被销毁？或者它只是线程的一个子集；也许某个线程池中的线程或以其他方式相互关联？
3.  无论是哪种情况，只停止试图访问数据结构的线程不是更好吗？因为否则，我们不担心数据竞争等。
4.  最后，互斥锁和锁有什么区别？互斥锁只是一个 RAII 锁吗？或者 RAII 是通过守卫发生的？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T19:30:07.197

1.  互斥体与列表相关联，但这种关联完全是手动的——编译器和运行时库不知道两者是关联的。该关联完全存在于您的文档和您的头脑中，您负责确保访问列表的任何线程首先锁定/获取互斥锁。

2.  每当使用互斥锁时，锁定/获取互斥锁的线程将停止（该术语实际上是*block*），直到没有其他线程拥有该互斥锁。不使用互斥锁的线程将不受影响。

3.  您负责确保只有访问列表的线程锁定/获取互斥锁，并且您还负责确保访问列表的所有线程锁定/获取互斥锁。同样，只有那些线程可以阻塞等待互斥锁。

4.  同一个对象有许多不同的名称：“mutex”、“lock”或“critical section”。守卫使用 RAII 锁定/获取互斥锁。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T19:35:43.983

> 是否不需要专门将互斥锁与列表相关联？

不，或者至少不是明确的，而且通常以声明的方式也不可能。每次需要访问受该互斥锁保护的对象时，您的代码都必须（尝试）获取适当的互斥锁，并在完成读取或更改其状态后释放它。关于哪个互斥锁保护哪个对象的知识只存在于程序员的脑海中（当然也存在于程序的文档中）。

> 如果不是，这是否意味着任何时候使用互斥锁，所有线程都会停止，直到互斥锁被销毁？或者它只是线程的一个子集；也许某个线程池中的线程或以其他方式相互关联？

这意味着想要对某个对象执行原子操作序列的所有线程首先必须获取保护该对象的互斥锁，以便与竞争相同资源的其他线程同步访问。互斥锁保证只有一个线程可以拥有它，并且在该线程*释放*（而不是“销毁”）互斥锁之前，所有其他线程都将等待获取它。

> 无论是哪种情况，只停止试图访问数据结构的线程不是更好吗？因为否则，我们不担心数据竞争等。

确实是的。通过强制需要对某个对象进行独占访问的线程（并且仅是那些线程）获取保护它的互斥锁，您不会强制其他线程停止。

> 最后，互斥锁和锁有什么区别？互斥锁只是一个 RAII 锁吗？或者 RAII 是通过守卫发生的？

互斥锁是客户端可以（尝试）获取的同步对象，以便对受该互斥锁保护的对象执行某些操作，而不必担心其他线程会干扰其操作（只要其他线程也遵守尝试获取的协议）当然，访问对象之前的互斥锁）。

锁通常被理解为一个 RAII 包装对象，它封装了您对互斥锁的锁定，并且其析构函数在调用时会自动解锁互斥锁。因此，当锁超出范围时（因为从函数返回，或者因为抛出异常等），获取的互斥锁会自动释放。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-02-02T19:36:30.373

> 是否不需要专门将互斥锁与列表相关联？

不，那里没有。在这种情况下，互斥锁只是保护代码块，而不是列表本身。因为`some_list.push_back()`和`std::find`是在由同一个互斥锁保护的代码块中执行的，所以单独的线程不会在受保护的块中一起传播，直到一个线程退出该块。

> 如果不是，这是否意味着任何时候使用互斥锁，所有线程都会停止，直到互斥锁被销毁？或者它只是线程的一个子集；也许某个线程池中的线程或以其他方式相互关联？

否 - 所有试图进入由互斥锁保护的块的线程都被挂起，直到互斥锁被**解锁**（这可能通过破坏`lock_guard`持有互斥锁的对象来实现）。

> 无论是哪种情况，只停止试图访问数据结构的线程不是更好吗？因为否则，我们不担心数据竞争等。

正如我所说，只有试图访问受保护块的线程可能会被挂起，所以没有必要阻塞所有线程。

> 最后，互斥锁和锁有什么区别？互斥锁只是一个 RAII 锁吗？或者 RAII 是通过守卫发生的？

不，互斥锁只是在不同系统上实现不同的同步原语，但 C++ 为其提供了统一的接口。互斥锁本身只知道三个操作：和`lock`，所以它周围有不同的包装器。其中之一，提供 RAII 是.`try_lock``unlock``std::lock_guard`

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-02-02T19:28:55.413

> 是否不需要专门将互斥锁与列表相关联？

不，您手动执行此操作。

> 如果不是，这是否意味着任何时候使用互斥锁，所有线程都会停止，直到互斥锁被销毁？或者它只是线程的一个子集；也许某个线程池中的线程或以其他方式相互关联？

互斥=互斥。如果两个线程试图锁定互斥锁，其中一个线程将阻塞，直到**该**互斥锁被释放。如果您尝试锁定一个互斥锁，而另一个线程有一个锁，它将阻塞直到它被释放。

> 无论是哪种情况，只停止试图访问数据结构的线程不是更好吗？因为否则，我们不担心数据竞争等。

是的。当并发访问出现问题时，您应该只锁定保护数据结构的互斥锁。例如在修改数据结构时。这就是为什么您的`add_to_list`函数仅`some_mutex`在`some_list.push_back()`.

> 最后，互斥锁和锁有什么区别？互斥锁只是一个 RAII 锁吗？

C++ lock_guard 是一个围绕互斥锁的 RAII 包装器。当对象被创建时，互斥锁被锁定，当它被销毁（超出范围）时，互斥锁被解锁。

# iphone - 检查数字是浮点数还是整数

> ID：14665549
> 
> 赞同：0
> 
> 时间：2013-02-02T19:21:19.933
> 
> 标签：iphone, ios, ios6, floating-point, integer

我正在制作一个 IOS 计算器应用程序。我想知道两个数字的除法是否会给出一个浮点值或一个 int 值。任何人都可以告诉我如何得到这个吗？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:28:27.763

如果您想知道而不实际计算 a/b，请检查 a/b 的其余部分是否为空：

```
if (fmod(a,b) == 0) {
  // integer result
} else {
  // floating-point result
} 
```

见[http://www.cplusplus.com/reference/cmath/fmod/](http://www.cplusplus.com/reference/cmath/fmod/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:24:27.053

如果[`floor()`](http://en.wikipedia.org/wiki/Math.h#Overview_of_functions)一个数的 等于那个数，它就是一个整数。

但是，请注意[浮点](http://docs.oracle.com/cd/E19957-01/806-3568/ncg_goldberg.html) [陷阱](https://stackoverflow.com/q/1458633/139010)。

# django - 从 FOSUserBundle 迁移到 Django

> ID：14665550
> 
> 赞同：3
> 
> 时间：2013-02-02T19:21:19.943
> 
> 标签：django, fosuserbundle

我正在将带有 FOSUserBundle 的 php 站点迁移到 Django 用户模型。

的内容`app/config/security.yml`：

```
security:
    encoders:
        FOS\UserBundle\Model\UserInterface: sha512 
```

来自 PHP 站点的用户测试的密码/盐值：

*   密码：`3EBoIIMrD73n2y+4hMUpCq2lmJ8tHStrBweonQClP+/Jhmaw7ipLbamQJQfB87Acg45sBH3HlgnpKI+QZN7m/Q==`
*   盐：`2n4fxtazv1us0csgg8s880ck4skcskg`
*   使用的密码是`amdpower`

我试图用这段代码生成相同的哈希：

```
raw_password = 'amdpower'
salt = '2n4fxtazv1us0csgg8s880ck4skcskg'

salted = '%s{%s}' % (raw_password, salt)
digest =  hashlib.sha512(salted).digest()
for i in range(5000):
   digest = hashlib.sha512(digest).digest()
print base64.b64encode(digest)
>>> wqgbbFZ/IPvwZktbmYz7inffofmT5HbRNf04BQ+w33Jgman8uVYbjWyiKzfp5EIFX2wqYGOb7hRzi5BdZlzDKw== 
```

我尝试过的哈希码有什么问题？如何生成相同的哈希？

更新：

PHP 函数是：

*   FOSUserBundle：[https ://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Model/UserManager.php#L180](https://github.com/FriendsOfSymfony/FOSUserBundle/blob/master/Model/UserManager.php#L180)

*   Symfony：[https ://github.com/symfony/symfony/tree/master/src/Symfony/Component/Security/Core/Encoder](https://github.com/symfony/symfony/tree/master/src/Symfony/Component/Security/Core/Encoder)

解决了：

```
raw_password = 'amdpower'
salt = '2n4fxtazv1us0csgg8s880ck4skcskg'

salted = '%s{%s}' % (raw_password, salt)
digest =  hashlib.sha512(salted).digest()
for i in range(4999):
    digest = hashlib.sha512('%s%s' % (digest, salted)).digest()
print base64.b64encode(digest)
>>> 3EBoIIMrD73n2y+4hMUpCq2lmJ8tHStrBweonQClP+/Jhmaw7ipLbamQJQfB87Acg45sBH3HlgnpKI+QZN7m/Q== 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:12:49.380

在这里，我重新创建了 Symfony 如何散列密码的场景。

[http://codepad.org/AhC64q4r](http://codepad.org/AhC64q4r)

Now it's all about converting it to python, which I know you can do it Juan :)

# html - Web 应用程序 UI - 100% 高度的布局

> ID：14665558
> 
> 赞同：1
> 
> 时间：2013-02-02T19:21:51.143
> 
> 标签：html, css

我已经看到应用程序占用了浏览器窗口的所有可用空间，但浏览器窗口上没有任何滚动条，但有特定 div 的滚动条（例如，jsfiddle，它使用 html、css、javascript 和结果 div 的滚动条但没有浏览器窗口滚动条）。我正在尝试为我的应用程序开发这样的布局，并且我尝试了一些关键字，例如应用程序样式 UI、100% 高度宽度布局、流体布局，但它们似乎都没有返回所需的结果。请原谅我，但作为一个初学者，我不得不问这个。这种布局是否有特定的术语。我确实遇到了一些技术和 jquery 插件来实现这一点，但仍然想知道最好的方法是什么。链接建议非常受欢迎。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:39:59.767

这是非常基本的东西。

首先，您必须在 CSS中设置*html、body的 height 属性*

```
html, body {
   height:100%;
   overflow:hidden;
} 
```

隐藏的*溢出*将*隐藏*窗口的滚动条。

然后在 HTML 中定义一个 div 并为 div 分配一个类名，如*.foo*

```
.foo {
    height:400px;
    overflow:auto;
} 
```

通过将*溢出*设置为*auto*，您的 div 将负责其内容的滚动。

看看：http: [//jsfiddle.net/mXU3f/](http://jsfiddle.net/mXU3f/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-10-04T17:23:31.933

看看这篇博文。上面选择的答案对于全屏 Web 应用程序 UI 来说有点过于简单了。

[http://blog.stevensanderson.com/2011/10/05/full-height-app-layouts-a-css-trick-to-make-it-easier/](http://blog.stevensanderson.com/2011/10/05/full-height-app-layouts-a-css-trick-to-make-it-easier/)

一些基本的 CSS 可以让您在构建全屏、100% 高度或任何您想称呼它的 Web 应用程序 UI 方面走得更远。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:48:10.563

也许这可以帮助我理解你：

html:

```
 <div id="container">
<div class="box">
    <p>
        "Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque laudantium, totam rem aperiam, eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo. Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Neque porro quisquam est, qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit, sed quia non numquam eius modi tempora incidunt ut labore et dolore magnam aliquam quaerat voluptatem. Ut enim ad minima veniam, quis nostrum exercitationem ullam corporis suscipit laboriosam, nisi ut aliquid ex ea commodi consequatur? Quis autem vel eum iure reprehenderit qui in ea voluptate velit esse quam nihil molestiae consequatur, vel illum qui dolorem eum fugiat quo voluptas nulla pariatur?"
    </p>
    </div>
</div> 
```

CSS：

```
 #container {
        display:block;
        position:absolute;
        height: auto !important;
        bottom:0;
        top:0;
        left:0;
        right:0;
        background-color:red}

.box {
    margin:50px;
    height: 200px;
width: 200px;
position:relative;
background-color:green;
 overflow-y: scroll;
} 
```

# php - 删除 SimpleXMLElement？

> ID：14665559
> 
> 赞同：3
> 
> 时间：2013-02-02T19:21:55.217
> 
> 标签：php, simplexml

我找到了（[here](https://stackoverflow.com/questions/13002313/php-simplexml-delete-please-tell-me-why-the-first-variant-is-not-working)）关于删除 SimpleXMLElement 对象节点的方法的答案。

问题是我无法真正理解这是如何发生的。

我的意思是，那个 $image var 是一个 ref，对吧？那么，那是什么，在哪里`$image[0][0]`？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:29:24.657

`SimpleXMLElement`通过魔术方法在其子节点上呈现类似数组的接口。此行为是由于自定义[`__unset`](http://www.php.net/manual/en/language.oop5.overloading.php#object.unset)行为导致 SimpleXMLElement 表现得好像其“数组”（子元素集）的“成员”（子元素）已被删除。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:24:00.323

如果你在 $image = $galleries->xpath(...

你会看到的：

```
Array
(
    [0] => SimpleXMLElement Object
        (
            [@attributes] => Array
                (
                    [name] => Hansio
                )

        )

) 
```

# html - 使 Twitter Bootstrap 列具有相同的高度

> ID：14665562
> 
> 赞同：7
> 
> 时间：2013-02-02T19:22:41.793
> 
> 标签：html, css, twitter-bootstrap, fluid-layout

我有一个带有以下 Twitter Bootstrap 布局的 ASP.NET MVC 视图：

```
<div class="container">
    <div class="container-fluid header">
        [Header content]
    </div>

    <div class="row-fluid">
        <div class="span9">
            <div class="container-fluid main-content">
                [Main Content]
            </div>
        </div>

        <div id="right-sidebar" class="span3">
            [Right Sidebar Content]
        </div>
    </div>
</div> 
```

我的问题是我的 [主要内容] 比我的 [右侧边栏内容] 高得多。由于我的 [右侧边栏内容] 具有不同的背景颜色，我希望它一直延伸到我的页脚（我的 [主要内容] 的整个高度。）

我尝试设置`height: 100%`到侧边栏，但在 Chrome 中没有明显效果。谁能看到如何实现这一目标？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T19:57:49.013

我改变了一点结构和元素的类/ID。

```
<div class="container-fluid">
    <div class="row-fluid header">
        [Header content]
    </div>

    <div id="parent" class="row-fluid">
        <div class="span9 main-content">
                [Main Content]
        </div>
        <div id="right-sidebar" class="span3">
            [Right Sidebar Content]
        </div>
    </div>
</div> 
```

现在是 CSS：

```
#parent{
  position: relative
}

#right-sidebar{
  position: absolute;
  right: 0;
  height: 100%;
  background: blue;
}

.main-content{
  background: red;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T19:50:31.680

高度 100% 不起作用，因为周围的容器需要高度属性。

您可以在容器上设置 800px 的高度，以使您的高度 100% 生效。但是，这并不等于主要内容，只是使它们看起来没有那么不同的一种方式。

您可以使用 display: table; 对于像列一样的表格。[http://jsbin.com/ojavub/1/edit](http://jsbin.com/ojavub/1/edit)

```
#right-sidebar {
  background-color: red;
  display: table-cell;
}

.container {
  display: table;
}

.row-fluid {
  display: table-row;
} 
```

# c++ - CRTP 和赋值运算符

> ID：14665564
> 
> 赞同：0
> 
> 时间：2013-02-02T19:22:56.620
> 
> 标签：c++, templates, crtp

我有一些分配给 CRTP 类的代码，如下所示：

```
 IChunkWindow<WindowDerived, IChunk<ChunkDerived>> editWindow = chunkWindow.create(
                                                                chunkWindow.getOrigin().getX() + x / ChunkDimensions::MAX_X,
                                                                chunkWindow.getOrigin().getZ() + z / ChunkDimensions::MAX_Z,
                                                                chunkWindow); 
```

这是 CRTP 类：

```
 template <class Derived, class T>
struct IChunkWindow : public IWindow<IChunkWindow<Derived,T>, T> {

    Point3D const& getOrigin() const {
        return static_cast<Derived const*>(this)->getOrigin();
    }

    void setOrigin(Point3D const& origin) {
        this->origin = origin;
        static_cast<Derived*>(this)->setOrigin(origin);
    }
    T* getChunk(int cx, int cz) {
        return static_cast<Derived*>(this)->getChunk(cx,cz);
    }
    void setChunk(int cx, int cz, T* ptr) {
        static_cast<Derived*>(this)->setChunk(cx,cz,ptr);
    }

    unsigned char getTerrainBlock(int x, int y, int z) const {
        return static_cast<Derived const*>(this)->getTerrainBlock(x,y,z);
    }
    void setTerrainBlock(int x, int y, int z, unsigned char value) {
        static_cast<Derived*>(this)->setTerrainBlock(x,y,z,value);
    }
    unsigned char getLightBlock(int x, int y, int z) const {
        return static_cast<Derived const*>(this)->getLightBlock(x,y,z);
    }
    void setLightBlock(int x, int y, int z, unsigned char value) {
        static_cast<Derived*>(this)->setLightBlock(x,y,z,value);
    }
    unsigned char getMetaBlock(int x, int y, int z) const {
        return static_cast<Derived const*>(this)->getMetaBlock(x,y,z);
    }
    void setMetaBlock(int x, int y, int z, unsigned char value) {
        static_cast<Derived*>(this)->setMetaBlock(x,y,z,value);
    }
    bool isChunkDirty(int cx, int cz) {
        return static_cast<Derived*>(this)->isChunkDirty(cx,cz);
    }
    bool inBounds(int x, int y, int z) {
        return static_cast<Derived*>(this)->inBounds(x,y,z);
    }
    bool inBounds(int a_cx, int a_cz) {
        return static_cast<Derived*>(this)->inBounds(a_cx, a_cz);
    }
    void insert(int a_x, int a_y, int a_z, unsigned char blockType) {
        static_cast<Derived*>(this)->insert(a_x,a_y,a_z,blockType);
    }
    void remove(int a_x, int a_y, int a_z) {
        static_cast<Derived*>(this)->remove(a_x, a_y, a_z);
    }
    std::vector<BlockPosition> waterPhysics(int a_x, int a_y, int a_z, std::vector<BlockPosition> const& waterSources) {
        static_cast<Derived*>(this)->waterPhysics(a_x,a_y,a_z, waterSources);
    }

    IChunkWindow<Derived, T> create(int a_cx, int a_cz, IChunkWindow<Derived, T> & otherWindow) {
        return static_cast<Derived*>(this)->create(a_cx, a_cz, otherWindow);
    }

}; 
```

我可以在 editWindow 上进行方法调用，但基类的私有数据（未显示）是垃圾，因此看起来分配失败。我是否需要覆盖 IChunkWindow 类中的赋值运算符才能使其工作？

# opengl - OpenGL - 我如何在这上面映射纹理？

> ID：14665569
> 
> 赞同：0
> 
> 时间：2013-02-02T19:23:50.467
> 
> 标签：opengl, textures

我的游戏中有一块地板，由 100x100 的四边形组成。我不能只用 1 个四边形来做到这一点，因为它会破坏照明。问题来了——我如何在所有这些上放置一个纹理？此代码将纹理放在每个四边形上，但这不是我想要的效果。

```
glBegin(GL_QUADS);
glNormal3f(0,0,1);

for(float j = 0; j < 1; j+=0.01)
{       
      for(float i = 0; i < 1; i+=0.01)
    {           
        glTexCoord2f(0.0,0.0); glVertex2f(i,j+0.01);
        glTexCoord2f(1.0,0.0); glVertex2f(i,j);
        glTexCoord2f(1.0,1.0); glVertex2f(i+0.01,j);
        glTexCoord2f(0.0,1.0); glVertex2f(i+0.01,j+0.01);
    }

}
glEnd();
glPopMatrix(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:33:31.403

一个快速而简单的解决方案是使用与地板相同的纹理坐标值：

```
glTexCoord2f(i, j+0.01);      glVertex2f(i, j+0.01);
glTexCoord2f(i, j);           glVertex2f(i, j);
glTexCoord2f(i+0.01, j);      glVertex2f(i+0.01, j);
glTexCoord2f(i+0.01, j+0.01); glVertex2f(i+0.01, j+0.01); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:39:05.177

好吧，看起来您使用的是旧版本的 OpenGL，因此您可能无法使用它们，但使用自定义片段着色器可以解决您的问题。这就是我会做的。但我认为您正在寻找的是您只需要插入 UV 坐标。例如，如果您有 4 个正方形，而不是

```
0.0f,0.0f
1.0f,0.0f
1.0f,1.0f
0.0f,1.0f 
```

第一个应该是

```
0.0f,0.0f
.5f,0.0f
.5f,.5f
.0f,.5f 
```

我也会在你的 for 循环中使用整数以获得更可预测的行为，但你可以根据你所拥有的来调整计算顶点位置到索引的方式。

```
 glTexCoord2f(i,j); glVertex2f(i,j+0.01);
    glTexCoord2f(i+.01,j); glVertex2f(i,j);
    glTexCoord2f(i+.01,j+.01); glVertex2f(i+0.01,j);
    glTexCoord2f(i,j+.01); glVertex2f(i+0.01,j+0.01); 
```

注意tex坐标的顺序。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-02-02T19:40:43.007

> 我不能只用 1 个四边形来做到这一点，因为它会破坏照明。

这就是每像素照明的全部意义所在。逐顶点光照，您仅在顶点评估光照颜色，并在整个三角形上进行插值，当您的三角形相对于其与灯光的距离相当大时（如在您的落地案例中），结果会很差。如果您使用逐像素光照，您将不得不编写自己的片段着色器，但是您可以只为整个地板使用一个四边形，并且无论光线有多近或多远，光照都是正确的。

另见：[http](http://www.swiftless.com/tutorials/glsl/5_lighting_perpixel.html) : [//www.swiftless.com/tutorials/glsl/5_lighting_perpixel.html，http ://en.wikipedia.org/wiki/Per-pixel_lighting](http://en.wikipedia.org/wiki/Per-pixel_lighting)

# jakarta-ee - 避免手动刷新实体以从新创建的实体中获取 Dtype

> ID：14665570
> 
> 赞同：0
> 
> 时间：2013-02-02T19:23:54.450
> 
> 标签：jakarta-ee, entity, jpa-2.0, ejb-3.1

我有一些实体继承了如下所示的 AbstractEntity。

```
@Entity
@Inheritance(strategy = InheritanceType.JOINED)
public abstract class AbstractEntity implements Serializable {
    private static final long serialVersionUID = 1L;

    @Id
    @GeneratedValue
    private int id;

    @Column(insertable = false, updatable = false)
    private String dtype;

    public String getDtype() {
        return dtype;
    }
} 
```

然后我坚持一些扩展 AbstractEntity 的实体。

```
ConcreteEntity concreteEntity = new ConcreteEntity();
em.persist(concreteEntity); 
```

如果然后在其他一些 ejb 中使用

```
someEntity = query.getResultList().get(0); 
```

返回的实例将有`dtype == null`直到

```
em.refresh(someEntity); 
```

我猜这是因为实体管理器返回一个不知道在 em.persist() 上插入了哪个 dtype 的缓存实例。

但我的问题是如何让查询返回设置 dtype 的实例？

我使用 glassfish 3.1.2.2（默认 jpa 提供程序和包含的 javadb）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:34:52.897

为什么你甚至需要它？`dtype`是 ORM 需要的内部实现细节。您可以简单地使用 Java 类型来区分子类。例如，在 Facelets 上下文中，您可以尝试`.getClass().getSimpleName()`：

```
#{entity.class.simpleName == 'ConcreteEntity'} 
```

不完全清洁，但有效。

# twitter-bootstrap - 如何在 Bootstrap 中指定选择元素的大小

> ID：14665578
> 
> 赞同：0
> 
> 时间：2013-02-02T19:24:50.190
> 
> 标签：twitter-bootstrap

我正在为我的页面使用 Bootstrap。我有一个 3 列布局：span3 span6 span3。在我的中间列中，我希望用户能够选择一个日期。到目前为止我有这个，但所有 3 个选择的项目都是相同的确切宽度。我希望它们足够宽以显示其中的文本。这可能吗？

```
<select name="month" id="month" class="span1"></select>
<select name="day" id="day" class="span1"></select>
<select name="year" id="year" class="span1"></select> 
```

我用 JavaScript 以编程方式填充这些内容。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:39:19.170

您是否尝试过使用简单的 CSS 选择器？使用“检查元素”确定宽度并添加 css。例如。

```
select#day { width : 250px; } 
```

# python - 继承和扩展 Python 字节数组

> ID：14665579
> 
> 赞同：5
> 
> 时间：2013-02-02T19:25:03.963
> 
> 标签：python, inheritance, bytearray

我希望能够写入字节数组缓冲区并通过调用方法来清除它，所以我有一个如下所示的类：

```
import struct

class binary_buffer(bytearray):
    def __init__(self, message=""):
        self = message
    def write_ubyte(self, ubyte):
        self += struct.pack("=B", ubyte)
        return len(self)
    def clear(self):
        self = "" 
```

但是，调用 clear() 似乎根本没有做任何事情。示例输出如下所示：

```
>>> bb = binary_buffer('')
>>> bb
bytearray(b'')  # As expected, the bytearray is empty
>>> bb.write_ubyte(255)
1  # Great, we just wrote a unsigned byte!
>>> bb
bytearray(b'\xff') # Looking good. We have our unsigned byte in the bytearray.
>>> bb.clear() # Lets start a new life!
>>> bb
bytearray(b'\xff') # Um... I though I just cleared out the trash? 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:30:51.470

代替

```
 self = "" 
```

和

```
 self[:] = "" 
```

否则，您所做的就是重新绑定`self`引用。

同样，以下内容不会达到您的预期：

```
 self = message 
```

# opengl - 如何插入使用中点算法绘制的线的颜色

> ID：14665582
> 
> 赞同：0
> 
> 时间：2013-02-02T19:25:27.663
> 
> 标签：opengl, graphics

我目前正在尝试在软件级别实现图形管道。现在我已经实现了中点算法来绘制一条线，但是我应该如何在两个端点之间插入像素的颜色。我的意思是，我知道线性插值，但我的问题是通过中点算法生成的像素的 (x, y) 坐标并不准确地位于由两个端点定义的实际线上。我想知道OpenGL是如何处理它的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:24:17.407

我不确切知道OpenGL如何处理颜色插值，但您可以通过将像素（中点）的坐标投影到线上来解决您的问题，然后通过对颜色使用线性插值来计算***投影***点的颜色线的端点。

这可能不是最快的方法，但结果应该是正确的。

有关如何将点投影到线段上的信息： [http ://en.wikibooks.org/wiki/Linear_Algebra/Orthogonal_Projection_Onto_a_Line](http://en.wikibooks.org/wiki/Linear_Algebra/Orthogonal_Projection_Onto_a_Line)

# php - MySQL 循环或嵌套查询

> ID：14665583
> 
> 赞同：0
> 
> 时间：2013-02-02T19:25:36.150
> 
> 标签：php, mysql, loops, nested

说我有一桌朋友

```
user_1  |  user_2 
```

然后，说我想看看这些朋友都在做什么，所以我检查了帖子表和更新表

```
post_id  | post_title | post_message |  user_id | timestamp

update_id | title | userid | timestamp 
```

我想实现如下逻辑：获取朋友列表，查看生成的朋友列表，看看他们是否添加了任何内容，按最近的活动排序（时间戳）。

```
Select user_1 from friends where user_2 = '$my_userid'
union
Select user_2 from friends where user_1 = '$my_userid'

//now loop through each of these friends and check the update/post tables to see if they have added anything recently 
```

我可以通过 1 个 MySQL 查询来完成这一切，还是必须将其分解并使用 PHP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:35:22.227

post_id | post_title | post_message | 用户 ID | 时间戳 - Table_A

更新ID | 标题 | 用户名 | 时间戳 - Table_B

试试下面的查询

```
SELECT A.*, B.* FROM Table_A AS A JOIN Table_B AS B ON B.userid = A.user_id
WHERE A.user_id IN (100,101,102) 
ORDER BY B.timestamp DESC; 
```

A.* - 将为您提供表 A 中的所有列。如果您想要特定列`A.post_id`。

您可以通过添加 LIMIT 子句来确定结果数量。

注意：我假设 100,101,102 是生成的用户 ID。您可以在 IN 子句中添加用户 ID。

**更新**

如果您想限制好友，请将您需要的用户 ID 放在 IN 子句中。如果不去掉where子句，就可以无限制地获取所有好友的更新。您可以按您需要的任何列订购。你可以做 ORDER BY A.user_id , A.post_id, 甚至多列也是可能的

# android - Nexus 7 编译上没有出现按钮

> ID：14665588
> 
> 赞同：1
> 
> 时间：2013-02-02T19:25:55.370
> 
> 标签：android, button

我正在编译并运行到 Nexus 7 设备而不是模拟器，因为模拟器在我的 macbook 上运行非常缓慢。

这是我的代码：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView 
        android:layout_width="fill_parent"
        android:layout_height="fill_parent"
        android:text="@string/hello" />

   <Button 
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:text="@string/button_send"/>

</LinearLayout> 
```

我正在阅读一本书，但我不知道我做错了什么。我正在使用 ADT eclipse ide。有任何想法吗？文本在那里，但按钮没有显示，当我在图形视图中添加一个按钮时，它在注入代码时似乎工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:34:35.630

LinearLayout 在使用 fill_parent 时，一一测量其每个子级需要多少大小。因此，在您的示例中，它看到第一个孩子想要拥有它给它的所有可用高度（fill_parent）。

## 如果你不关心间距

更改`android:layout_height="fill_parent"`为`android:layout_height="wrap_content"`

## 假设您希望按钮位于底部

您可以使用 layout_weight 解决此问题。告诉两个视图只使用它们需要的空间（即使用 wrap_content）。接下来将第一个视图设置为使用 layout_weight=1，以便在决定哪个视图获得剩余空间时，第一个视图优先。

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="fill_parent"
    android:layout_height="fill_parent"
    android:orientation="vertical" >

    <TextView 
        android:layout_width="fill_parent"
        android:layout_height="wrap_content"
        android:layout_weight="1"
        android:text="Hello" />

   <Button 
       android:layout_width="fill_parent"
       android:layout_height="wrap_content"
       android:layout_weight="0"
       android:text="Send"/>

</LinearLayout> 
```

这是结果的样子，这是我假设你想要的：

![在此处输入图像描述](../Images/5020e0299c8c83359538c135ff3b4c09.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:29:46.133

您的 TextView 填充父级。所以它没有空间留给一个按钮。改变：

```
android:layout_height="fill_parent" 
```

到：

```
android:layout_height="wrap_content" 
```

# android - Android - 初始化失败的监视器线程无法建立环回连接

> ID：14665591
> 
> 赞同：0
> 
> 时间：2013-02-02T19:26:34.603
> 
> 标签：android

由于我是新用户，因此我删除了所有链接上的 http:，以便我可以发布迄今为止在故障排除中所做的工作。

我正在学习 android 开发课程并已安装/下载以下内容

JDK 7 JDK 6 Eclipse IDE for Java Android SDK

Java 代码在这个 Eclipse 中运行没有任何问题。对于运行 Android：

起初，我进入 Eclipse-> 帮助菜单，然后安装新软件。单击添加，将其命名为 ADT 并用于使用的位置：http: [//dl-ssl.google.com/android/eclipse](http://dl-ssl.google.com/android/eclipse)。

出现的新窗口，我点击了所有这些框并选择下一步。至此，一切正常，安装了 ADT，并要求我重新启动 Eclipse。当 Eclipse 启动时，会出现一个新窗口并要求我安装 Android 软件开发工具包 (SDK) 或选择现有的 SDK 位置。我选择安装 Android 软件开发工具包 (SDK)（我检查了所有选项）。我已将 SDK 位置设置为默认位置。一切完成后，当 Eclipse 控制台尝试伸出手并安装软件包时，我看到两个错误。

```
 Failed to initialize monitor Thread: Unable to establish loopback connection 
```

和

```
 Cannot find tools in the android-sdk folder 
```

我已关闭来自 IPV6 和 IPV4 的所有隧道

*   禁用 IPV6
*   关闭防火墙

将 -Djava.net.preferIPv4Stack=true 添加到 eclipse.ini 文件中

跟随这里的所有方向。

//blogs.msdn.com/b/richin/archive/2010/11/26/how-to-disable-teredo-tunneling-pseudo-interface-6to4-adapter.aspx

//www.java.net/node/703177

//stackoverflow.com/questions/9011539/failed-to-initialize-monitor-thread-unable-to-establish-loopback-connection

//stackoverflow.com/questions/7300211/eclipse-ide-failed-to-initialize-monitor-thread-error-after-installing-android

//stackoverflow.com/questions/9114741/serious-problems-in-configuring-android-sdk-with-eclipse

仍然没有运气，我已经完成了 JAVA、Android SDK、Eclipse 的全新安装

我还下载了 Java 6 而不是 7 并将编译器设置为 1.6

我曾尝试运行 SDK 管理器，但出现以下错误

```
 Fetching //dl-ssl.google.com/android/repository/addons_list-2.xml

   Failed to fetch URL ://dl-ssl.google.com/android/repository/addons_list-2.xml, reason: Invalid argument: connect

   Fetched Add-ons List successfully

   Fetching URL: //dl-ssl.google.com/android/repository/repository-7.xml

   Failed to fetch URL //dl-ssl.google.com/android/repository/repository-7.xml, reason: Socket Invalid argument: connect 
```

我已经完成了-Android SDK Manager->Tools->Options，现在检查显示以下内容的框： force https://... sources to be fetched using http://

然后单击包-> 重新加载。- 仍然从上面得到相同的错误

我以管理员身份运行了一切

我已经把所有东西都放在了c目录的根目录下

一旦我到达在 Eclipse 中安装 sdk 的点，我就无法完成安装。

尽管我运行的是 64 位，但我完成了 32 位的所有操作，唯一剩下的就是下载 64 位的所有内容，看看是否有什么不同。

任何有答案或建议的人请告诉我谢谢。

我让它只在我妻子的笔记本电脑上运行，但在我的台式机上到目前为止什么都没有。我运行 Win 7 Pro X64，我的以太网是 Bigfoot Network 杀手级以太网卡。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-22T02:49:24.513

我还必须在 eclipse.ini 中更新一行：

我将 java 更新到 1.7，并且不得不告诉 eclipse。

-Dosgi.requiredJavaVersion=1.7

# mysql - 从我的实体框架到 MySQL 数据库的更快性能

> ID：14665596
> 
> 赞同：0
> 
> 时间：2013-02-02T19:27:02.273
> 
> 标签：mysql, entity-framework, entity-framework-4, jqgrid

在我的程序中，我从我的 MySQL 数据库中复制数据，理论上我正在通过分页减少结果集。对于 30 行数据，大约 25 列数据，每个单元格中没有太大的数据，似乎仍然需要很长时间 600-800 毫秒。

这只是我通过访问数据库来检索数据所必须承受的性能损失吗？我经常更新这些数据，每个用户都有不同的数据集，所以我无法将其缓存或预加载到内存中。

我会喜欢一些关于我如何从这里开始的建议。我看着制作一个单独的存储过程来为我的分页计算总行数，但主要的打击似乎是当我必须将数据复制到程序到一个列表中，然后为我的网页视图生成 JSON。

我对此有点陌生，我认为由于产生这些结果所花费的时间，我的前端页面的响应能力开始受到影响。1.8 - 2.5 秒的页面刷新时间似乎太长了，无法重新加载显示 30 个结果的网格。

先感谢您。

编辑：附加细节：

表中的所有主键都已编入索引。是的，我已经分析了耗时最长的 EF 查询，它似乎没有做任何比分页选择更多的事情。前任

```
sql = "System.Collections.Generic.List`1[PeerTrader.usercollectionenhancedview].OrderBy(Param_0 => Param_0.CardName).Skip(90).Take(30)" 
```

我们可以将客户端排除在外，因为我正在我的控制器上测量诊断，基本上客户端不会为显示的呈现增加任何实际开销。基本上准备 JSon 数据以将其返回给客户端所需的时间是相同的。

它通常是 30 页（尽管当我将其减少到行数为 5 时它所花费的时间并没有真正改变）来自存储过程，结果总计数约为 20K。

真正的打击是在我实际从数据库中“读取”数据的地方。因此，无论我在哪里注入从数据库中实际加载结果的部分，似乎都是最大的打击。运行应该模拟我的服务器在 MySQL 服务器上进行的页面调用的分页查询会返回大约 60 毫秒的结果。

这是我的控制器操作：在下面的示例中，我将整个数据集复制到过滤器后的列表中，因为我在 5、30 或 20K 行中复制似乎无关紧要，它似乎是读取操作中的相同命中，然后它让我稍后在控制器中多次枚举数据集。

```
public ActionResult GridData(string sidx, string sord, int page, int rows, bool _search, string filters)
    {
    ///**********Diagnostics Start********
    System.Diagnostics.Stopwatch sw = new System.Diagnostics.Stopwatch();
    sw.Start();
    ///**********Diagnostics End********

    MembershipUser currentUser = Membership.GetUser(User.Identity.Name, true /* userIsOnline */);
    int currentUserID = (int)currentUser.ProviderUserKey;

    var serializer = new JavaScriptSerializer();
    //Filters f = (!_search || string.IsNullOrEmpty(filters)) ? null : serializer.Deserialize<Filters>(filters);
    Filters_IQueryable f = (!_search || string.IsNullOrEmpty(filters)) ? null : serializer.Deserialize<Filters_IQueryable>(filters);

    IQueryable<usercollectionenhancedview> query = db.SingleUserCollectionView(currentUserID).AsQueryable();

    var filteredQuery = (f == null ? query : f.FilterObjectSet(query)).ToList();

    ///**********Diagnostics Start********
    sw.Stop(); long t1 = sw.ElapsedMilliseconds; sw.Start();
    System.Diagnostics.Debug.WriteLine("");
    System.Diagnostics.Debug.WriteLine("**************");
    System.Diagnostics.Debug.WriteLine("T1: " + t1);
    ///**********Diagnostics End********

    int totalRecords;

    totalRecords = filteredQuery.Where(x => x.fk_IdUsers == currentUserID).Count();
    pagedQuery = filteredQuery.AsQueryable().Where(x => x.fk_IdUsers == currentUserID).OrderBy(sidx + " " + sord).Skip((page - 1) * rows).Take(rows);

     ///**********Diagnostics Start********
     sw.Stop(); long t2 = sw.ElapsedMilliseconds; sw.Start();
     System.Diagnostics.Debug.WriteLine("T2: " + t2);
     ///**********Diagnostics End******** 
```

我希望我已经添加了足够的额外信息以供进一步评论，如果不只是让我知道的话。我非常感谢您对我的问题的探索。

编辑2：

`sql = "System.Data.Objects.ObjectResult`1[PeerTrader.usercollectionenhancedview].OrderBy(Param_0 => Param_0.CardName).Skip(0).Take(30)" `When I go looking on my DB, the actual call on the DB to do the`order by` 实际上需要相当长的时间，实际数据库本身需要 300 毫秒，所以看起来就像我追踪了一次昂贵的降级

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:19:13.907

```
var filteredQuery = (f == null ? query : f.FilterObjectSet(query)).ToList(); 
```

上面的线看起来很可疑。见[这里](http://msdn.microsoft.com/en-us/library/bb342261%28v=vs.103%29)：

> ToList(IEnumerable) 方法强制立即查询评估

如果您只需要计数和 30 个项目，则无需实现 1000 多个结果。应重写以下查询以对数据库而不是物化集合进行操作。使用 count() 和 Skip().Take() 时生成的 SQL 应该足以将结果限制为您需要的结果，但您可能希望使用检查实际查询`ObjectQuery.ToTraceString()`

```
totalRecords = filteredQuery.Where(x => x.fk_IdUsers == currentUserID).Count();
pagedQuery = filteredQuery.AsQueryable().Where(x => x.fk_IdUsers == currentUserID)
                          .OrderBy(sidx + " " + sord).Skip((page - 1) * rows).Take(rows); 
```

如果您仍然遇到问题并且这是只读情况，您可以尝试使用`.AsNoTracking()`并关闭任何代理生成。

# javascript - jScrollPane 忽略可滚动的 zWeatherFeed

> ID：14665598
> 
> 赞同：0
> 
> 时间：2013-02-02T19:27:11.463
> 
> 标签：javascript, jquery, jscrollpane

我使用[jScrollPane](http://jscrollpane.kelvinluck.com/index.html#)滚动垂直块但是当我包含在块中时[zweatherfeed](http://www.zazar.net/developers/jquery/zweatherfeed/)块不滚动所以我在天气 div 滚动工作之后添加了一些

```
<div style="padding: 0px; width: 300px; overflow: hidden;" class="scroll-pane jspScrollable" tabindex="0">
   <div class="jspContainer" style="width: 300px; height: 190px;">
      <div class="jspPane" style="padding: 10px; width: 266px; top: 0px;">
         <div id="test" class="weatherFeed"></div>
         <div>1</div>
         <div>3</div>
         <div>4</div>
         <div>5</div>
         <div>6</div>
         <div>7</div>
         <div>8</div>
         <div>1</div>
      </div>
<div class="jspVerticalBar"> 
```

我为活动滚动添加 13

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T22:19:10.613

在这里查看 autoReinitialise true 它是如何工作的......但我不确定为什么 jsPane 首先加载。

[http://jsfiddle.net/ggS8b/4/](http://jsfiddle.net/ggS8b/4/)

```
$(document).ready(function () {
    $('#test').weatherfeed(['UKXX0085','EGXX0011','UKXX0061','CAXX0518','CHXX0049']);

    $('.scroll-pane').jScrollPane( {autoReinitialise: true} )
}); 
```

# extjs - 使用 Ext JS 显示繁忙的进度条

> ID：14665599
> 
> 赞同：0
> 
> 时间：2013-02-02T19:27:30.340
> 
> 标签：extjs, progress-bar, messagebox

我想使用 Ext JS 显示繁忙的进度条。我使用`Ext.MessageBox.wait()`标题为“忙碌”来显示忙碌的消息框，我正在使用`Ext.Msg.hide()` 我的自定义 java 脚本关闭进度条。

它正在显示进度条，但是正在加载一个特定于产品的（我的应用程序）脚本，这会导致进度条关闭。产品脚本正在使用 hide 方法关闭消息框。我无法控制或编辑产品特定脚本。

我只想用我的自定义 java 脚本代码关闭消息框。

请建议如何进行此操作。有没有其他方法可以显示和隐藏忙碌的进度条，这样我就可以摆脱产品特定的`Ext.Msg.hide()`调用？

非常感谢期待..!!

问候，

乌代。

# regex - 正则表达式太多或根本没有。

> ID：14665601
> 
> 赞同：0
> 
> 时间：2013-02-02T19:27:58.143
> 
> 标签：regex

这是我要匹配的字符串的示例。

```
<div class="unique"><a href="/2343242/link to something target="_self">"HERE IS THE TEXT 
I'D LIKE"</a></div> 
```

这让我太过分了。因为它并没有停止，它似乎仍然返回 div 和 a 标签。

```
/(?:<div class="unique">)?(?:<a href=.*>)?.*(?:<)?/ 
```

这不返回任何内容

```
/(?:<div class="unique">)?(?:<a href=.*>)?.*(?:</a>)?/ 
```

所以第一部分不应该与唯一的“div”标签和下面的“a”标签匹配并且不返回它们。然后抓住所有东西，直到它击中的第一个 < 将是结束的“a”标签？我不知道是什么搞砸了。

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:56:03.090

似乎这效果更好。

```
(?:<div class="unique">)(?:<a href=.*?>)?.*?(?:<.a>) 
```

效果很好。

# ios - 可可：无法删除子视图控制器

> ID：14665607
> 
> 赞同：0
> 
> 时间：2013-02-02T19:28:23.247
> 
> 标签：ios, cocoa-touch, uiviewcontroller, childviewcontroller, parentviewcontroller

我加载我的主视图控制器的视图。这个主视图控制器然后添加 2 个子视图控制器（拆分视图：主视图和细节）。当我在 init 方法中添加子 VC 后立即记录它们的数量时，我得到“2”作为输出。然后当我调用 -switchToCommunication 方法并尝试删除详细子 VC 时，视图不会改变。但日志告诉我，该阵列实际上已从 2 个子 VC 缩减为 1 个。

怎么了？

```
- (id)initWithNibName:(NSString *)nibNameOrNil bundle:(NSBundle *)nibBundleOrNil
{
[super init];

//add master view controller as childVC
self.test2 = [test2 new];
[self addChildViewController:self.test2];
self.test2.view.frame = CGRectMake(0, 0, 256, 768);
[self.view addSubview:self.test2.view];
[self.test2 didMoveToParentViewController:self];

//add detail view controller as childVC 
self.detail1Vc = [EADetailSupportViewController new];
[self addChildViewController: self.detail1Vc];
self.detail1Vc.view.frame = CGRectMake(284, 0, 740, 768);
[self.view addSubview: self.detail1Vc.view];
[self.detail1Vc didMoveToParentViewController:self];
NSLog(@"Child VC in childVC array: %d", [self.childViewControllers count]);

- (void) switchToCommunication {
//remove currently active detail view controller from parent view
NSLog(@"Child VC in childVC array: %d", [self.childViewControllers count]);

[[self.childViewControllers lastObject] willMoveToParentViewController:nil];
[[[self.childViewControllers lastObject] view] removeFromSuperview];
[[self.childViewControllers lastObject] removeFromParentViewController];

NSLog(@"Child VC in childVC array: %d", [self.childViewControllers count]);

NSLog(@"pushed");

//add communication detail view controller as child view controller
...
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-03-20T16:25:21.153

此代码可以帮助您删除子视图，对我来说很好。self.childViewControllers 是一个数组，因此您可以从特定索引中删除。

```
 [[self.childViewControllers objectAtIndex:0] removeFromParentViewController]; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2017-07-12T08:43:24.100

试试这个

```
 [self.childviewcontroller willMoveToParentViewController:nil;
  [self.childviewcontroller removeFromParentViewController]; 
  [self.childviewcontroller.view removeFromSuperview]; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T10:39:07.790

我想我想通了：我没有将指针转发给子 VC，而是创建了父 vc 的一个新类，从而导致了新的初始化（恢复所有子 VC）。您应该始终将指向包含类的指针转发给子 VC！

# javascript - 导致附加无法正常工作的变量

> ID：14665617
> 
> 赞同：0
> 
> 时间：2013-02-02T19:29:48.583
> 
> 标签：javascript, jquery

在 IE9 兼容性视图关闭和其他主要浏览器（chrome、firefox、safari 和 opera）中，当我单击`Add Question`按钮时，它会在下方附加一个表格行。

但是如果我在 IE 中打开兼容性视图，它会在下表中附加一个空白。

现在我意识到，如果我删除下面的这行代码：

```
var flag = true; 
```

然后它适用于 IE 中的兼容性视图，但我会在错误控制台中收到一个错误，说明标志未定义。

那么我该如何修复它，以便我在控制台中没有错误，但它能够在 IE 兼容性上将表行附加到表中？

代码如下：

```
var flag = true;

if(flag == true)
{
    var tbl_qanda = $("#qandatbl").width();
    $("#qandatbl").css({"width": (tbl_qanda - 16)+ "px"});
}

var tbl_qanda_onthefly = $("#qandatbl_onthefly").width();

if(tbl_qanda > tbl_qanda_onthefly)
{
     $("#qandatbl").css({"width": (tbl_qanda_onthefly - 16)+ "px"});
     $("#qandatbl_onthefly_container").css({"width": (tbl_qanda_onthefly)+ "px"});
} 
```

**更新：**

这是 jsfiddle 向您展示代码：http: [//jsfiddle.net/7GjYK/](http://jsfiddle.net/7GjYK/)

要查看工作版本，要查看发生了什么，请使用此链接[DEMO](http://helios.hud.ac.uk/u0867587/Mobile_app/Text23.php)并在 IE9 兼容性关闭或任何其他主要浏览器中打开它，您会看到当您单击时`Add Question`，它会在下方附加一个表格行，但如果您更改兼容性查看并做同样的事情，它显示一个空白追加。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-09T22:22:56.627

为什么不通过禁用兼容性来保留它 IE9：

`<meta http-equiv="X-UA-Compatible" content="IE=edge" />`

# c - 解决对“xmlNewTextWriterFilename”的未定义引用

> ID：14665620
> 
> 赞同：1
> 
> 时间：2013-02-02T19:29:56.350
> 
> 标签：c, xml, compilation, libxml2

> **可能重复：**
> [什么是未定义的引用/未解决的外部符号错误，我该如何解决？](https://stackoverflow.com/questions/12573816/what-is-an-undefined-reference-unresolved-external-symbol-error-and-how-do-i-fix)

我开始用 C 开发并想使用`libxml2`C-Library 来编写一个简单的 xml 文件。

为此，我创建了单独的源文件，它们应该提供编写 xml 文件的功能。

**xmlutils.h：**

```
#include <libxml/encoding.h>
#include <libxml/xmlwriter.h>

void writeXML(const char *uri); 
```

**xmlutils.c：**

```
#include <libxml/encoding.h>
#include <libxml/xmlwriter.h>

void writeXML(const char *uri){

int rc;
xmlTextWriterPtr writer;
xmlChar *tmp;

 /* Create a new XmlWriter for uri, with no compression. */
writer = xmlNewTextWriterFilename(uri, 0);
if (writer == NULL) {
    printf("testXmlwriterFilename: Error creating the xml writer\n");
    return;
}

 //more code...

} 
```

在我的**main.c**文件中，我想使用这个 writeXML 函数：

```
#include<stdio.h>
#include<string.h>
#include "xmlutils.h"

main() {

writeXML("test.xml");
} 
```

我正在编译：

```
gcc -o myapp main.c xmlutils.c -I/usr/include/libxml2 
```

我得到：

```
xmlutils.c:(.text+0x19): undefined reference to `xmlNewTextWriterFilename'
collect2: ld returned 1 exit status 
```

我在这里做错了什么？如果我看一下`usr/include/libxml2/libxml/xmlwriter.h`文件，那里有函数......

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:40:32.257

不要忘记要链接的对象`-lxml2` **后面的选项。**

```
gcc -o myapp main.c xmlutils.c -I/usr/include/libxml2 -lxml2 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:39:20.923

您缺少`-l`链接 libxml 的选项。

# alloy - 在合金中运行命令范围

> ID：14665629
> 
> 赞同：1
> 
> 时间：2013-02-02T19:31:38.177
> 
> 标签：alloy

在合金考虑

信号队列{链接：队列，元素：整数}

考虑到我有一些谓词 predicate-1，当我为 Queue <=1、int ={-3,-2,0,2} 运行 predicate-1 时，我将如何定义范围。我没有在这里列出谓词

为 1 个队列运行 predicate-1，此处为 int 范围

不知道 int 范围的语法是什么

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:03:56.703

语法是

```
run predicate1 for 1 Queue, 3 Int 
```

整数的范围始终是位宽，因此您不能指定 Int 集正好包含 {-3。-2。0\. 2}; 您只能指定一个位宽，并且将使用该位宽内的所有整数。在我上面的示例中，Int 集将包含从 -4 到 3 的所有整数。

# python - time.sleep() 需要保持 QThread 响应？

> ID：14665636
> 
> 赞同：2
> 
> 时间：2013-02-02T19:32:25.697
> 
> 标签：python, matplotlib, pyqt4, qthread, blit

首先，我是 Python 新手。我是一名长期使用 MatLab 的用户（工程师，而不是计算机科学家），我正在尝试将 Python、NumPy、SciPy 等应用到我的工作流程中。所以，请原谅我对什么是美妙的编程语言的明显无知！

作为我的第一个尝试，我决定构建一个应用程序来与我正在开发的传感器进行交互。传感器具有微秒分辨率（每 500 微秒来自 512 个高能“像素”和 512 个低能“像素”的数据），但 I/O 会阻塞。由于我会不断地轮询设备，我知道线程对于保持 GUI 响应很重要（GUI 最终还将与另一个设备集成串行通信，并具有对传感器数据进行操作的图像处理子程序）。我创建了一个 MatPlotLib 的线程实例来绘制来自传感器的这些“实时”数据。虽然我已经构建了与传感器独立通信的模块并验证了我知道如何在 Python 中做到这一点，但我只是从“模拟”开始 通过为低能量“像素”生成 8 到 12 个之间的 512 个随机数和为高能量“像素”生成 90 到 110 个之间的 512 个随机数来对数据进行分类。这就是线程。从这里的许多示例中工作，我还学会了使用 blitting 来使用 MatPlotLib 获得足够快的屏幕更新——但是，问题是除非我使用将线程进程休眠 20 毫秒`time.sleep(0.02)`，GUI 无响应。这可以验证，因为来自 MatPlotLib 的交互式 X、Y 数据点反馈不起作用，并且“停止”按钮不能用于中断该过程。任何长于`time.sleep(0.02)`使 GUI 操作更流畅的时间，但都会以“数据速率”为代价。任何比`time.sleep(0.02)`使 GUI 无响应更慢的东西。我不确定我明白为什么。我打算离开并尝试使用 GUIqwt，但我想在放弃 MatPlotLib 之前在这里问一下，因为我不确定这甚至是问题所在。我担心让线程休眠 20 毫秒意味着我会错过来自传感器阵列的至少 40 条潜在数据线（40 线 * 500us/线 = 20 毫秒）。

这是当前代码：

```
import time, random, sys
from PyQt4.QtCore import *
from PyQt4.QtGui import *

from matplotlib.figure import Figure
from matplotlib.backends.backend_qt4agg import NavigationToolbar2QTAgg as NavigationToolbar
from matplotlib.backends.backend_qt4agg import FigureCanvasQTAgg as FigureCanvas

class ApplicationWindow(QMainWindow):

    def __init__(self, parent = None):

        QMainWindow.__init__(self, parent)

        self.thread = Worker()

        self.create_main_frame()
        self.create_status_bar()

        self.connect(self.thread, SIGNAL("finished()"), self.update_UI)
        self.connect(self.thread, SIGNAL("terminated()"), self.update_UI)       
        self.connect(self.startButton, SIGNAL("clicked()"), self.start_acquisition)       
        self.connect(self.stopButton, SIGNAL("clicked()"), self.stop_acquisition)
        self.thread.pixel_list.connect(self.update_figure)

    def create_main_frame(self):
        self.main_frame = QWidget()

        self.dpi = 100
        self.width = 10
        self.height = 8
        self.fig = Figure(figsize=(self.width, self.height), dpi=self.dpi)
        self.axes = self.fig.add_subplot(111)               
        self.axes.axis((0,512,0,120))

        self.canvas = FigureCanvas(self.fig)
        self.canvas.setParent(self.main_frame)
        self.canvas.updateGeometry()    
        self.canvas.draw()
        self.background = None

        self.lE_line, = self.axes.plot(range(512), [0 for i in xrange(512)], animated=True)
        self.hE_line, = self.axes.plot(range(512), [0 for i in xrange(512)], animated=True)          

        self.mpl_toolbar = NavigationToolbar(self.canvas, self.main_frame)

        self.startButton = QPushButton(self.tr("&Start"))
        self.stopButton = QPushButton(self.tr("&Stop"))

        layout = QGridLayout()
        layout.addWidget(self.canvas, 0, 0)
        layout.addWidget(self.mpl_toolbar, 1, 0)
        layout.addWidget(self.startButton, 2, 0)       
        layout.addWidget(self.stopButton, 2, 1)

        self.main_frame.setLayout(layout)
        self.setCentralWidget(self.main_frame)

        self.setWindowTitle(self.tr("XRTdev Interface"))

    def create_status_bar(self):
        self.status_text = QLabel("I am a status bar.  I need a status to show!")
        self.statusBar().addWidget(self.status_text, 1)

    def start_acquisition(self):
        self.thread.exiting = False
        self.startButton.setEnabled(False)
        self.stopButton.setEnabled(True)
        self.thread.render()

    def stop_acquisition(self):
        self.thread.exiting = True
        self.startButton.setEnabled(True)
        self.stopButton.setEnabled(False)
        self.cleanup_UI()

    def update_figure(self, lE, hE):
        if self.background == None:
            self.background = self.canvas.copy_from_bbox(self.axes.bbox)
        self.canvas.restore_region(self.background)
        self.lE_line.set_ydata(lE)
        self.hE_line.set_ydata(hE)
        self.axes.draw_artist(self.lE_line)
        self.axes.draw_artist(self.hE_line)
        self.canvas.blit(self.axes.bbox)

    def update_UI(self):
        self.startButton.setEnabled(True)
        self.stopButton.setEnabled(False)
        self.cleanup_UI()        

    def cleanup_UI(self):
        self.background = None
        self.axes.clear()        
        self.canvas.draw()

class Worker(QThread):

    pixel_list = pyqtSignal(list, list)

    def __init__(self, parent = None):
        QThread.__init__(self, parent)
        self.exiting = False

    def __del__(self):
        self.exiting = True
        self.wait()

    def render(self):
        self.start()

    def run(self):
        # simulate I/O
        n = random.randrange(100,200)
        while not self.exiting and n > 0:
            lE = [random.randrange(5,16) for i in xrange(512)]
            hE = [random.randrange(80,121) for i in xrange(512)]
            self.pixel_list.emit(lE, hE)
            time.sleep(0.02)
            n -= 1

def main():
    app = QApplication(sys.argv)
    form = ApplicationWindow()
    form.show()
    app.exec_()

if __name__ == "__main__":
    main() 
```

也许我的问题甚至不在于 MatPlotLib 或 PyQT4，而是我实现线程的方式。正如我所指出的，我对此并不陌生，并且正在学习。而且，我什至不确定 GUIqwt 会解决这些问题中的任何一个——但我确实知道我在这里看到了很多建议，使用比 MatPlotLib 更快的东西在 GUI 中进行“实时”绘图。感谢您对此的帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T21:40:53.717

[编辑因为`QThread`令人困惑/困惑]

似乎有两种使用它的方法，一种是对其进行子类化（如您的示例和文档所述），另一种是创建一个工作对象，然后将其移动到一个线程中（请参阅[此博客文章](http://blog.qt.digia.com/blog/2010/06/17/youre-doing-it-wrong/)）。然后，当您混合信号/插槽时，我会更加困惑。正如 Avaris 所说，这种变化可能不是您的问题。

我将您的课程重新`Worker`作为一个子类`QObject`（因为这是我理解的风格）。

一个问题是，如果您不将 a`sleep`放入您的假数据系统中，那么您会在 < 1 秒内生成对主窗口的所有回调。然后主线程基本上被阻塞，因为它清除了信号队列。如果您将延迟设置为您指定的延迟（0.0005s），那么它通过生成数据的速度远远快于它可以显示的速度，这似乎表明这可能不适合您的问题（务实，您也可以看不到那么快，而且它似乎在 30-40 fps 时还可以）。

```
import time, random, sys
#from PySide.QtCore import *
#from PySide.QtGui import *

from PyQt4 import QtCore
from PyQt4 import QtGui

from matplotlib.figure import Figure
from matplotlib.backends.backend_qt4agg import NavigationToolbar2QTAgg as NavigationToolbar
from matplotlib.backends.backend_qt4agg import FigureCanvasQTAgg as FigureCanvas

class ApplicationWindow(QtGui.QMainWindow):
    get_data = QtCore.pyqtSignal()

    def __init__(self, parent = None):

        QtGui.QMainWindow.__init__(self, parent)

        self.thread = QtCore.QThread(parent=self)
        self.worker = Worker(parent=None)
        self.worker.moveToThread(self.thread)

        self.create_main_frame()
        self.create_status_bar()

        self.startButton.clicked.connect(self.start_acquisition) 
        self.stopButton.clicked.connect(self.stop_acquisition)
        self.worker.pixel_list.connect(self.update_figure)
        self.worker.done.connect(self.update_UI)

        self.get_data.connect(self.worker.get_data)

        self.thread.start()

    def create_main_frame(self):
        self.main_frame = QtGui.QWidget()

        self.dpi = 100
        self.width = 10
        self.height = 8
        self.fig = Figure(figsize=(self.width, self.height), dpi=self.dpi)
        self.axes = self.fig.add_subplot(111)               
        self.axes.axis((0,512,0,120))

        self.canvas = FigureCanvas(self.fig)
        self.canvas.setParent(self.main_frame)
        self.canvas.updateGeometry()    
        self.canvas.draw()
        self.background = None

        self.lE_line, = self.axes.plot(range(512), [0 for i in xrange(512)], animated=True)
        self.hE_line, = self.axes.plot(range(512), [0 for i in xrange(512)], animated=True)          

        self.mpl_toolbar = NavigationToolbar(self.canvas, self.main_frame)

        self.startButton = QtGui.QPushButton(self.tr("&Start"))
        self.stopButton = QtGui.QPushButton(self.tr("&Stop"))

        layout = QtGui.QGridLayout()
        layout.addWidget(self.canvas, 0, 0)
        layout.addWidget(self.mpl_toolbar, 1, 0)
        layout.addWidget(self.startButton, 2, 0)       
        layout.addWidget(self.stopButton, 2, 1)

        self.main_frame.setLayout(layout)
        self.setCentralWidget(self.main_frame)

        self.setWindowTitle(self.tr("XRTdev Interface"))

    def create_status_bar(self):
        self.status_text = QtGui.QLabel("I am a status bar.  I need a status to show!")
        self.statusBar().addWidget(self.status_text, 1)

    def start_acquisition(self):
        self.worker.exiting = False
        self.startButton.setEnabled(False)
        self.stopButton.setEnabled(True)
        self.get_data.emit()

    def stop_acquisition(self):
        self.worker.exiting = True
        self.startButton.setEnabled(True)
        self.stopButton.setEnabled(False)
        self.cleanup_UI()

    def update_figure(self, lE, hE):
        if self.background == None:
            self.background = self.canvas.copy_from_bbox(self.axes.bbox)
        self.canvas.restore_region(self.background)
        self.lE_line.set_ydata(lE)
        self.hE_line.set_ydata(hE)
        self.axes.draw_artist(self.lE_line)
        self.axes.draw_artist(self.hE_line)
        self.canvas.blit(self.axes.bbox)

    def update_UI(self):
        self.startButton.setEnabled(True)
        self.stopButton.setEnabled(False)
        self.cleanup_UI()        

    def cleanup_UI(self):
        self.background = None
        self.axes.clear()        
        self.canvas.draw()

class Worker(QtCore.QObject):

    pixel_list = QtCore.pyqtSignal(list, list)
    done = QtCore.pyqtSignal()

    def __init__(self, parent = None):
        QtCore.QObject.__init__(self, parent)
        self.exiting = True

    @QtCore.pyqtSlot()
    def get_data(self):
        # simulate I/O
        print 'data_start'
        n = random.randrange(100,200)
        while not self.exiting and n > 0:
            lE = [random.randrange(5,16) for i in xrange(512)]
            hE = [random.randrange(80,121) for i in xrange(512)]
            self.pixel_list.emit(lE, hE)
            time.sleep(0.05)
            n -= 1
        print 'n: ', n
        self.done.emit() 
```

# ios - 将一个字符串插入另一个字符串

> ID：14665641
> 
> 赞同：1
> 
> 时间：2013-02-02T19:32:50.753
> 
> 标签：ios, objective-c, syntax, nsstring

我正在开发 iPhone 应用程序。我有 SQL 查询：

```
 NSString *myRed = [NSString stringWithFormat: @"%1.4f", slideR.value];

 [self insertData:@"INSERT INTO colour VALUES("+myRed+")"]; 
```

它会产生语法错误。如何将字符串插入字符串。Java 中的这种方法会奏效。最好的祝福

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:34:47.700

试试这个 ：

```
NSString *myRed = [NSString stringWithFormat: @"%1.4f", slideR.value];

[self insertData:[NSString stringWithFormat:@"INSERT INTO colour VALUES(\"%@\")",myRed]]; 
```

如果你不想要`"`那么:-

```
[self insertData:[NSString stringWithFormat:@"INSERT INTO colour VALUES(%@)",myRed]]; 
```

希望它可以帮助你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:37:10.130

您可以尝试事先编写查询并将字符串附加在一起。

```
 NSString *str = @"Your values";
             NSString *query = [NSString stringWithFormat:@"INSERT INTO color VALUES(%@)", str];
             [self insertData:query]; 
```

# mysql - 使用 WHERE ON INNER JOIN 正确查询 MySQL 正确的顺序和语法

> ID：14665646
> 
> 赞同：2
> 
> 时间：2013-02-02T19:33:22.417
> 
> 标签：mysql, inner-join, where-clause

只是尝试使用 Joins 并找出查询的最佳用法和公式。尝试为 OWNER 获取所有宠物 - 我是否通过比较调用加入？

```
SELECT *
FROM VISITOR
INNER JOIN OWNER ON VISITOR.OWNER_ID = 1
AND OWNER.ID = 1 
```

或者，我是否调用完整连接并添加 WHERE 语句？

```
SELECT *
FROM VISITOR
INNER JOIN OWNER ON VISITOR.OWNER_ID = OWNER.ID
WHERE VISITOR.OWNER_ID =1 
```

任何关于什么是正确方法的解释也将不胜感激。谢谢大家:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:50:52.847

查询时，通常会根据表到表的关系字段进行联接。此外，您可以在相应级别添加其他标准，以进一步过滤您的最终数据集。那就是说...

```
SELECT 
      *
   FROM 
      VISITOR V
         INNER JOIN OWNER Own
            ON V.OWNER_ID = Own.OWNER_ID
   WHERE
      V.OWNER_ID = 1 
```

确保您在“owner_id”键上的访问者表上有一个索引以帮助优化......或者，您可以反转它，例如

```
SELECT 
      *
   FROM 
      OWNER Own
         JOIN VISITOR V
            ON Own.OWNER_ID = V.OWNER_ID
   WHERE
      Own.OWNER_ID = 1 
```

# asp.net - ASP.net Visual Studio 2008 SQL 数据源

> ID：14665647
> 
> 赞同：0
> 
> 时间：2013-02-02T19:33:28.180
> 
> 标签：asp.net, date, datetime, gridview, dbtype

我正在研究一个 GridView 控件，我想在网格中显示几个数据。列是；2 个字符串名称、1 个整数和日期时间。当我想输入数据以在网格中显示以确保其正常工作时，会出现异常错误（教授给出的代码）；

> System.ArgumentException：正在使用的 SQL Server 版本不支持数据类型“日期”。

但是，我想出了什么问题。在我的 HTML 源代码中，我正在查看 Date 列中的 Delete、Update、Insert Parameters；dbtype="日期"。我必须将其更改为；键入 =“DateTime”，它可以工作。

是什么导致它是 Dbtype="date" 而不是 Type="DateTime"？回答时非常感谢。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T23:24:05.893

可能您的 mssql 服务器版本是 2005 ，因此它不支持“日期”作为数据类型

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T05:43:30.653

实际上，**DATE**是在 MS SQL Server 2008 和 MS SQL Server 2012 中引入的数据类型。很可能您使用的是 MS SQL Server 2005 或更早版本。请检查您的 SQL Server 的版本。

我希望它对你有帮助。

# php - 正则表达式仅选择 TVShow 名称

> ID：14665649
> 
> 赞同：0
> 
> 时间：2013-02-02T19:33:32.650
> 
> 标签：php, regex

我希望我的 PHP 脚本搜索文件夹中的文件，并且我希望 ReGEX 仅从中获取主文件名。

这些文件是带有 fansub 组的电视节目等。但我只需要节目名称。

```
[Final8]Nazo no Kanojo X 01-13 + OVA (BD 10-bit 1920x1080 x264 FLAC)  
[Final8]Nazo no Kanojo X 01-13 + OVA (BD 10-bit 1280x720 x264 AAC)  
[HorribleSubs] OreShura - 05 [1080p].mkv  
[HorribleSubs] OreShura - 05 [720p].mkv  
[Hatsuyuki]_Naruto_Shippuuden_-_298_[720p][3FF2ABFE].mp4  
[Commie] Mondaiji-tachi ga Isekai kara Kuru Sou Desu yo - 04 [18B50CAF].mkv  
[FFF] Maoyuu Maou Yuusha - 05 [E84974F0].mkv  
[Commie] Chihayafuru 2 - 04 [AB85B68E].mkv  
[gg]_Sasami-san@Ganbaranai_-_04_[4D5B88AF].mkv  
[Nutbladder] JoJo's Bizarre Adventure - 17  
[UTW]_Shinsekai_Yori_-_18_[h264-720p][FAC060C0].mkv 
```

我想删除 [ ] 括号中的 Fansub 名称以及文件名的所有其余部分，如剧集编号等。我只想要主文件名，如 Nazo no Kanojo、OreShura、Naruto_Shippuuden（或更好的 Naruto Shippuuden）等。

我尝试自己制作一个 REGEX，但它并不顺利，任何帮助将不胜感激，如果可能的话，请看看您是否也可以评论 RegEX 的哪个部分做了什么，因为这样我也可以学习。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:53:33.103

这个正则表达式会给你标题，但它看起来并不完美。它仍然会在名称中出现任何破折号和下划线。

```
(?<=])[^\.][\D]+ 
```

这是一个使用您提供的一些字符串的工作示例：http: [//fiddle.re/hz9b](http://fiddle.re/hz9b)

然后，您可以进行第二次传递以删除任何不需要的字符。

# php - PHP 使用 PDO 语句清理输入

> ID：14665651
> 
> 赞同：1
> 
> 时间：2013-02-02T19:33:47.067
> 
> 标签：php, mysql, pdo, input-sanitization

> **可能重复：**
> [如何防止 PHP 中的 SQL 注入？](https://stackoverflow.com/questions/60174/how-to-prevent-sql-injection-in-php)

我使用 PDO 准备好的语句来防止 MySQL 注入，但我应该做更多的事情来清理用户输入吗？用户只会看到他自己的输入和他“朋友”的其他人的输入。我还需要做些什么来清理输入吗？

我认为没有启用魔术引号，而且我想不出任何其他方式可以让用户弄乱我的网站，但我是新手，所以我不确定。

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:41:40.410

如果您使用的是准备好的语句，那么[MySQL injection 应该没有任何问题](http://www.php.net/manual/en/pdo.prepared-statements.php)。

> 如果应用程序专门使用预准备语句，开发人员可以确定不会发生 SQL 注入（但是，如果查询的其他部分是使用非转义输入构建的，则 SQL 注入仍然是可能的）。

但是，您可能会考虑[清理您的*输出*](http://php.net/manual/en/function.htmlspecialchars.php)，例如只显示某些 HTML 标记（如果有的话），以避免有人弄乱网站的布局或更糟的是，执行任意 JavaScript 的问题。

# python - 使用循环更改文件名和扩展名

> ID：14665652
> 
> 赞同：0
> 
> 时间：2013-02-02T19:33:57.013
> 
> 标签：python

我需要更改一系列文件的名称和扩展名。这些名称目前是“tmax.##.txt”，但我需要它是“tmax_##.txt”。然后，我想将 .txt 扩展名更改为 .asc。我已经尝试了下面的代码，第一个循环按预期工作以产生“tmax_01”。第二个循环运行，但产生了意想不到的结果，'t'。

```
list_raw = 'tmax.01.txt', 'tmax.02.txt', 'tmax.03.txt'

for i in list_raw:
    list_conv = i.replace('.','_')

for i in list_conv:
list_final = i.replace('_txt','.asc') 
```

有什么建议么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:36:20.500

您只是在循环的每次迭代中为变量分配新值。您想要做的是从现有列表的修改元素创建一个新列表，最好使用[列表理解](http://www.youtube.com/watch?v=pShL9DCSIUw)来完成：

```
list_raw = ['tmax.01.txt', 'tmax.02.txt', 'tmax.03.txt']
list_final = [i.replace(".", "_").replace("_txt", ".asc") for i in list_raw] 
```

请注意，您可以像在我的示例中那样，一步完成此操作 - 没有理由对列表进行两次迭代，并生成一个中间列表，这是低效的。

您也可以`i.replace(".", "_", 1)`只替换第一个`.`，并避免使用文件扩展名进行尴尬的破解。但是，我个人会使用`i[:-4].replace(".", "_") + ".asc"`——即用切片将现有的扩展名剪掉，替换掉`.`s，然后添加新的扩展名。

如果扩展的长度可能会有所不同，您可能需要按照[sotapme](https://stackoverflow.com/a/14665716/722121)`os.path`的建议查看模块。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-02T19:40:09.627

因为您正在谈论文件，所以它可能值得使用`os.path`，因为您的代码的下一部分可能是操作这些或其他文件。（只是猜测）

```
os.path.splitext('afile.txt')[0] + '.asc' 
```

给

```
'afile.asc' 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:41:03.357

在第一个循环中： -

```
for i in list_raw:
    list_conv = i.replace('.','_') 
```

你`list_conv`包含一个`str`对象。它将包含列表中的最后一个元素并进行适当的替换。

然后在你的第二个循环中： -

```
for i in list_conv:
    list_final = i.replace('_txt','.asc') 
```

您只是在遍历字符串序列，这将一次给您 1 个字符。并将`list_final`包含完成适当替换的最后一个字符。

由于最后一个字符`tmax_03_txt`是`t`，这就是你得到的原因`t`。

* * *

如果要对列表的每个元素进行替换，则可以使用`list comprehension`, 并更改方法调用：-

```
>>> list_raw = ['tmax.01.txt', 'tmax.02.txt', 'tmax.03.txt']
>>> [elem.replace('.', '_').replace('_txt', '.asc') for elem in list_raw]
16: ['tmax_01.asc', 'tmax_02.asc', 'tmax_03.asc'] 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T22:37:14.710

或者，您可以使用[字符串方法 rsplit](http://docs.python.org/3/library/stdtypes.html#str.rstrip)。

```
list_raw = ['tmax.01.txt', 'tmax.02.txt', 'tmax.03.txt']
list_final = [filename.rsplit('.',1)[0] + '.ext' for filename in list_raw] 
```

其中 ext 是新的扩展名。rsplit() 中的 1 表示只有最右边的 '.' 将作为分割点。

# c - 如何在 Windows 上使用 Flex

> ID：14665653
> 
> 赞同：8
> 
> 时间：2013-02-02T19:34:01.090
> 
> 标签：c, windows, lex, flex-lexer

如果这是一个愚蠢的问题，我深表歉意，但我对这个工具的经验为零，想知道我是否要正确使用它。我已经下载了 flex，它在编译我的 lex 文件时会生成一个 C 文件，然后需要单独编译该文件。这是最好的方法吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T19:39:40.483

可以设置一个`flex`用作自定义构建步骤的 Visual Studio 项目，以便自动调用`flex`然后编译生成的文件。去年夏天我教了一门编译器课程，我们在存档课程网站上有[关于如何获取`flex`和示例项目文件的说明。](http://www.stanford.edu/class/archive/cs/cs143/cs143.1128/)您应该查看标有“用于 PP1 的 Visual Studio Starter Files”的公告。

希望这可以帮助！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2014-05-07T15:16:08.260

Using Win flex-bison with visual studio is quite easier and straightforward. You can find it at [Win Flex-Bison](http://sourceforge.net/projects/winflexbison/).

# ios - 接受聊天室邀请

> ID：14665654
> 
> 赞同：10
> 
> 时间：2013-02-02T19:34:08.517
> 
> 标签：ios, objective-c, xmpp, xmppframework, multiuserchat

我可以使用 XMPPFramework 创建一个 MUC，并使用下面的代码向用户发送加入该房间的邀请请求。

```
// Creating
AppDelegate *dele =(AppDelegate *) [[UIApplication sharedApplication]delegate];

xmppRoom = [[XMPPRoom alloc] initWithRoomStorage:dele jid:[XMPPJID jidWithString:self.roomName] dispatchQueue:dispatch_get_main_queue()];
[xmppRoom addDelegate:dele delegateQueue:dispatch_get_main_queue()];
[xmppRoom activate:dele.xmppStream];
[xmppRoom joinRoomUsingNickname:self.myNick history:nil];

// Inviting
[xmppRoom inviteUser:[XMPPJID jidWithString:@"abc@host"] withMessage:@"Come Join me"]; 
```

用户“abc”如何知道他已收到邀请，以及如何通过接受或拒绝对邀请做出反应？

我在 XMPPFramework 中找不到任何直接处理聊天室邀请的类。我的研究表明，每当用户收到聊天室邀请时，都会调用 xmmppStream 的委托方法：

```
- (void)xmppStream:(XMPPStream *)sender didReceiveMessage:(XMPPMessage *)message 
```

在该消息中，我检查它是否包含名称为“invite”的 NSXMLElement，如果包含则我向用户发送回调。然后我创建与用户收到邀请的聊天室名称同名的聊天室，然后进入新创建的房间。它工作正常，但安静冗长，效率不高。我想知道 XMPPFramework 中是否有一个可以单独处理聊天室邀请[的类。](https://github.com/robbiehanson/XMPPFramework)例如，检测、接受和拒绝房间邀请。

我提取房间名称的代码：

```
- (void)xmppStream:(XMPPStream *)sender didReceiveMessage:(XMPPMessage *)message
{
    NSXMLElement * x = [message elementForName:@"x" xmlns:XMPPMUCUserNamespace];
    NSXMLElement * invite  = [x elementForName:@"invite"];
    NSXMLElement * decline = [x elementForName:@"decline"];
    NSXMLElement * directInvite = [message elementForName:@"x" xmlns:@"jabber:x:conference"];
    NSString *msg = [[message elementForName:@"body"]stringValue];
    NSString *from = [[[message attributeForName:@"from"]stringValue];
    if (invite || directInvite)
    {
        [self createAndEnterRoom:from Message:msg];
        return;
    }
    [self.delegate newMessageRecieved:msg];
} 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-02-02T19:42:46.137

对于房间邀请和拒绝，实施[`XMPPMUCDelegate`](https://github.com/robbiehanson/XMPPFramework/blob/master/Extensions/XEP-0045/XMPPMUC.h#L56-L62)及其方法`-xmppMUC:didReceiveRoomInvitation:`和`-xmppMUC:didReceiveRoomInvitationDecline:`。

要获取房间 JID，请调用`[message from]`;

要加入房间，请实例化 an`XMPPRoom`并调用`-joinRoomUsingNickname:history:`。

然后让你的房间委托类实现`XMPPRoomDelegate`，并实现一些[委托方法](https://github.com/robbiehanson/XMPPFramework/blob/master/Extensions/XEP-0045/XMPPRoom.h#L272-L304)来处理房间中的接收消息。

目前似乎没有更自动的方式来响应邀请。

**更新：**委托回调现在接收房间 JID 作为参数，稍微澄清语义。

```
- (void)xmppMUC:(XMPPMUC *)sender roomJID:(XMPPJID *) roomJID didReceiveInvitation:(XMPPMessage *)message;
- (void)xmppMUC:(XMPPMUC *)sender roomJID:(XMPPJID *) roomJID didReceiveInvitationDecline:(XMPPMessage *)message; 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2014-04-10T13:05:30.877

只需添加以下代码

```
if  ([presenceType isEqualToString:@"subscribe"]) {

     [_chatDelegate newBuddyOnline:[NSString stringWithFormat:@"%@@%@", presenceFromUser, @"localhost"]];
     NSLog(@"presence user wants to subscribe %@",presenceFromUser);

     [xmppRoster acceptPresenceSubscriptionRequestFrom:[presence from] andAddToRoster:YES];

 //For reject button
//     [xmppRoster rejectPresenceSubscriptionRequestFrom:[tmpPresence from]];          
} 
```

方法里面

```
 - (void)xmppStream:(XMPPStream *)sender didReceivePresence:(XMPPPresence *)presence ;
method 
```

# jquery-ui - 使用 helper:'clone' 克隆 jQuery UI 可拖动对象后运行代码

> ID：14665655
> 
> 赞同：1
> 
> 时间：2013-02-02T19:34:10.937
> 
> 标签：jquery-ui, jquery-ui-draggable

我正在尝试在可拖动的新克隆项目上执行一些代码。克隆可拖动对象后，我想在其中的元素上使用 Twitter Bootstrap 的弹出框。

如何在使用以下可拖动项时实现这一点：

```
 $( "#draggables li" ).draggable({
    connectToSortable: "#sortable",
    helper: "clone",
    revert: "invalid"
  }); 
```

被拖动的项目：

```
<ul id="draggables">
  <li>
    <a href="#" class="btn pop-me" data-content="popover text">click</a>
  </li>
</ul>

<ul id="sortable">
</ul> 
```

在我的文档加载中，我调用 pop over：

```
$('.pop-me').popover() 
```

克隆元素时需要再次调用弹出框。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-03T13:11:33.673

不确定你期待什么，但你可以在回调中做你想做的事

```
 $( "#draggables li" ).draggable({
    connectToSortable: "#sortable",
    revert: "invalid",
    helper: function(event,ui){
        //Call your function here based on ui or event object
        return $(this).clone();
    },
    stop: function(event,ui){
        //Call your function here based on ui or event object
    }
  }); 
```

# php - 提交按钮没有监听 isset 处理程序

> ID：14665660
> 
> 赞同：0
> 
> 时间：2013-02-02T19:34:49.967
> 
> 标签：php, forms, events, button, handler

我没有很多 PHP 对我不利的实例。但这肯定是其中之一，我已经检查了一整天，并认为它可能来自第 3 方。但是告诉我这个错误是随机的一个症状是我什至不能尝试设置一个字符串变量来从提交中回发。既不`isset`也不`empty`工作来捕捉事件。当我按下提交时，我唯一看到的是我的 txtbox 变量被射入 URL。但没有验证发生。

所以现在我有一个登录页面的提交按钮，如下所示：

```
<form action='Login.php' method='post'>
    <table align="center">
        <tr><td>Username</td></tr><tr>
        <td><input type="text" name="txtUsername"/></td></tr>
        <tr><td>Password</td></tr><tr>
        <td><input type="text" name="txtPass"/></td></tr>
        <td colspan="2"><input type="submit" name="btnLogin" ID="btnBlueTemp" value="Sign in!" /></td></tr>
        <tr><td class="errorLogin"><?php echo $Error;?></td></tr>
    </table>
</form> 
```

我已经调用了必要的 POST，这就是事件。

```
$txtUsername = $_POST["txtUsername"];
$txtPass = $_POST["txtPass"];
$btnLogin = $_POST["btnLogin"];
if(isset($btnLogin)){
$Error = "ok";
} 
```

什么可能导致无法让我的按钮处理程序被捕获的问题？我正在使用 Internet Explorer 9。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:41:45.087

不要使用提交按钮来检查表单是否已提交。要么添加一个隐藏的表单字段并检查它是否已设置，要么使用其他机制。在 Firefox 中你不会有这个问题，但在 IE 中你会。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:44:31.267

你这样做是不对的。使用 时`$btnLogin = $_POST["btnLogin"];`，实际上是在设置变量。因此，即使您从地址栏中点击 url 而没有点击提交按钮，您的脚本也会被执行。

而是使用 -

```
if(isset($_POST['btnLogin']){
      // do stuff
}else{
      // do other stuff
} 
```

# ocaml - 硬编码 OCaml

> ID：14665663
> 
> 赞同：-1
> 
> 时间：2013-02-02T19:35:11.743
> 
> 标签：ocaml

我必须生成一个大小为 7 且高度为 3 的二叉搜索树。但是，我的答案只需硬编码，而不是生成一个的函数。

所以

```
let bst_size7_height3 = 
```

硬编码到底是什么意思？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:43:04.223

这意味着树将只是您程序中的一个表达式。这是三个数字的硬编码列表：

```
let numbers = [2; 1; 0] 
```

这是一个计算数字列表的函数：

```
let rec downfrom n = if n < 0 then [] else n :: downfrom (n - 1)

let numbers2 = downfrom 2 
```

# javascript - 如何处理 AJAX XMLHttpRequest 返回的元素？

> ID：14665664
> 
> 赞同：0
> 
> 时间：2013-02-02T19:35:12.743
> 
> 标签：javascript, ajax, xmlhttprequest

我是 AJAX 和 Javascript 的新手，在尝试访问 AJAX XMLHttpRequest 返回的元素时遇到问题。

场景如下：

我从另一个网站获取一个表格，并在使用 send() 方法将其打印到我的页面后，我想访问它的元素。[多亏了dystroy的帖子](https://stackoverflow.com/a/11351773/2034041)，我才知道为什么我不能这样做。我通过 stackoverflow 和谷歌搜索，但我找不到任何有用的东西。如果我错过了我正在寻找的答案，我应该为重复的帖子道歉。

所以我的问题是：由于请求的异步性质，我不能在获取代码之后使用结果，那么在请求之后访问获取的元素的方法是什么？

感谢您的关注和帮助：）

编辑：上下文

基本上我获取一个表，将其写入指定`<div>`元素（#table），然后过滤其内容，我现在的目标是将其写入另一个指定`<div>`元素（#dersler），然后仅隐藏第二列以外的列。我面临的问题如上所述，我无法到达刚刚获取的表格元素。

这是代码：

```
function fetchPage(str)
        {
            if(str=="")
            {
                document.getElementById("table").innerHTML="";
                $('#saatler').val(1);   //some filtering configuration
                $('#gunler').val(1);    //resetting filters in other words
                $('#bolumler').val(1);
                return;
            }
            if (window.XMLHttpRequest) // code for IE7+, Firefox, Chrome, Opera, Safari
                xmlhttp=new XMLHttpRequest();
            else // code for IE6, IE5
                xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

            xmlhttp.onreadystatechange=function()
            {
                if (xmlhttp.readyState==4 && xmlhttp.status==200){
                    document.getElementById("table").innerHTML=xmlhttp.responseText;
                    document.getElementById("dersler").innerHTML=xmlhttp.responseText;                        
                }
            }
            xmlhttp.open("GET", "fetch.php?url=http://www.sis.itu.edu.tr/tr/ders_programlari/LSprogramlar/prg.php?fb="+str, true);
            xmlhttp.send();
            $('#saatler').val(1);   //some filtering configuration
            $('#gunler').val(1);    //resetting filters in other words
            $('#bolumler').val(1);

            //after fetch, new filter
             $("#dersler").find('table').css("background-color", "blue");
        } 
```

现在我只是想把它的背景涂成蓝色。问题是当我获取页面时，为测试创建的已经存在的表被蓝色填充，但在 500 毫秒左右后，新表被覆盖到现有示例表上，并且新表的背景没有填充蓝色.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T03:31:25.767

要在返回后执行更多操作，只需在回调函数中添加该功能。从您的代码：

```
xmlhttp.onreadystatechange=function()
{
   if (xmlhttp.readyState==4 && xmlhttp.status==200){
     document.getElementById("table").innerHTML=xmlhttp.responseText;
     document.getElementById("dersler").innerHTML=xmlhttp.responseText;                        
     // Add lots of good stuff here!!
   }
} 
```

* * *

**这是另一种可能更清晰的样式**

```
function fetchPage(str)
{
   // other stuff removed to save space

   xmlhttp.onreadystatechange=postCallack;

   xmlhttp.open("GET", "fetch.php?url=http://www.sis.itu.edu.tr/tr/ders_programlari/LSprogramlar/prg.php?fb="+str, true);
   xmlhttp.send();

   // any stuff that goes here will happen before callback
   //  (this is a good place to update a UI element showing a call is resolving.)
   //  (for example a spinner or text saying "fetching")

}

function postCallback()
{
  if (xmlhttp.readyState==4 && xmlhttp.status==200){
      document.getElementById("table").innerHTML=xmlhttp.responseText;
      document.getElementById("dersler").innerHTML=xmlhttp.responseText;                        

    // continue to process post callback.
    $('#saatler').val(1);   //some filtering configuration
    $('#gunler').val(1);    //resetting filters in other words
    $('#bolumler').val(1);

    //after fetch, new filter
    $("#dersler").find('table').css("background-color", "blue");
  }
  else {
    // report error with fetch
  }

} 
```

# asp.net - AjaxFileUpload 回发 false

> ID：14665667
> 
> 赞同：5
> 
> 时间：2013-02-02T19:35:23.337
> 
> 标签：asp.net, ajax, file-upload, asp.net-ajax, postback

我`AjaxFileUpload`在`ASP.NET 4.0`网站上使用。问题是，当我上传文件时，它`UploadComplete`会触发回发到页面。对每一个`postback`造成`AjaxFileUpload`的`Ispostback`财产是`False`哪个应该的`True`。是什么原因。我检查了它`updatePanel`和没有它。它对它没有影响。这里是

```
 <ajax:AjaxFileUpload ID="AjaxFileUpload1" ContextKeys="fred" 
     AllowedFileTypes="jpg,jpeg,png,gif" MaximumNumberOfFiles="3" runat="server" 
        OnUploadComplete="AjaxFileUpload1_UploadComplete" /> 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-02T20:10:44.760

To detect postback from the AjaxFileUpload use this control's property: `AjaxFileUpload.IsInFileUploadPostBack`. The `IsPostBack` property doesn't works because this control submits not to the same page where is was rendered but to hidden frame instead so it's the first time for frame it loading on server. See more in AjaxControlToolkit sources: [AjaxControlToolkit AjaxFileUpload](http://ajaxcontroltoolkit.codeplex.com/SourceControl/changeset/view/a2a6dc6854e0#SampleWebSites/AjaxControlToolkitSampleSite/AjaxFileUpload/AjaxFileUpload.aspx.cs)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-03-11T07:48:12.847

它是这个问题的直接解决方案代码

```
protected void Page_Load(object sender, EventArgs e) 
 {
        // check if postback came through AjaxFileUpload control
        if (AjaxFileUpload1.IsInFileUploadPostBack)
        {
            // do for ajax file upload partial postback request
        }
        else
        { 
            // do for normal page request
        }
} 
```

# jquery - 没有jQuery的signalR客户端？

> ID：14665670
> 
> 赞同：3
> 
> 时间：2013-02-02T19:35:36.710
> 
> 标签：jquery, signalr

我正在编写一个移动应用程序唱 Titanium。我使用 SignalR，因为服务器是用 C# 编写的，但我需要在手机的 web 视图中运行 signalR 客户端。我的问题是是否有任何不需要 JQuery 的 SignalR 客户端实现

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T22:32:16.227

简单回答是不。至少现在还没有。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:43:57.803

> 我的问题是是否有任何不需要 JQuery 的 SignalR 客户端实现

这些可[`Signalr clients`](https://github.com/SignalR/SignalR/tree/master/src)用于各种平台：

*   [`Microsoft.AspNet.SignalR.Client.JS`](https://github.com/SignalR/SignalR/tree/master/src/Microsoft.AspNet.SignalR.Client.JS)（Signalr 的 jQuery 插件）
*   [`Microsoft.AspNet.SignalR.Client.Silverlight5`](https://github.com/SignalR/SignalR/tree/master/src/Microsoft.AspNet.SignalR.Client.Silverlight5)（对于 Silverlight 5 客户端）
*   [`Microsoft.AspNet.SignalR.Client.WP8`](https://github.com/SignalR/SignalR/tree/master/src/Microsoft.AspNet.SignalR.Client.WP8)（适用于 Windows Phone 8 客户端）
*   [`Microsoft.AspNet.SignalR.Client.WinRT`](https://github.com/SignalR/SignalR/tree/master/src/Microsoft.AspNet.SignalR.Client.WinRT)（对于 WinRT 客户端）
*   [`Microsoft.AspNet.SignalR.Client`](https://github.com/SignalR/SignalR/tree/master/src/Microsoft.AspNet.SignalR.Client)（对于 .NET 客户端 - 完整框架）
*   [`Microsoft.AspNet.SignalR.Client45`](https://github.com/SignalR/SignalR/tree/master/src/Microsoft.AspNet.SignalR.Client45)（对于 .NET 4.5 客户端 - 完整框架）

在您的问题中，您似乎在谈论一些*webview*和一些*电话*，但没有给出任何细节，但如果这是一个 Windows Phone 应用程序，那么它`Microsoft.AspNet.SignalR.Client.WP8`就是适合您的。如果这是其他平台，如果没有官方客户端实现，您将不得不检查文档是否有一些可用的 WebSockets 实现。

# android - Android：WebView - 在 WebView 内打开某些 URL，其余在外部打开？

> ID：14665671
> 
> 赞同：5
> 
> 时间：2013-02-02T19:35:42.960
> 
> 标签：android, webview

这是我的代码：

```
public class MainActivity extends Activity {

@SuppressLint("SetJavaScriptEnabled") @Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
    WebView mywebview = (WebView) findViewById(R.id.webview);
    mywebview.loadUrl("http://www.shufflemylife.com/shuffle");
    WebSettings webSettings = mywebview.getSettings();
    webSettings.setJavaScriptEnabled(true);
    mywebview.setWebViewClient(new WebViewClient());

}

class MyWebViewClient extends WebViewClient {
    @Override
    public boolean shouldOverrideUrlLoading(WebView view, String url) {
        if(url.contains("/shuffle")){
            Intent i = new Intent(Intent.ACTION_VIEW);
            i.setData(Uri.parse(url));
            startActivity(i);
            }
        return true;

        }
    }
    } 
```

基本上，我希望在 WebView 中加载任何包含“/shuffle”的 url，并在外部浏览器中打开任何其他内容。可行吗？我离实现这个目标有多近？

谢谢你的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-07-25T01:11:46.643

为了澄清，这就是你应该如何编写你的 shouldOverrideUrlLoading 方法：

```
@Override
public boolean shouldOverrideUrlLoading(WebView view, String url) {
    if (url.contains("/shuffle")) {
        mWebView.loadUrl(url);
        return false;
    } else {
        Intent intent = new Intent(Intent.ACTION_VIEW);
        intent.setData(Uri.parse(url));
        startActivity(intent);
        return true;
    }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:02:25.527

> 可行吗？

是的。

> 我离实现这个目标有多近？

关闭，但向后。a 的默认行为`WebView`是在外部浏览器中显示链接。因此，如果`url.contains("/shuffle")`，您想调用`loadUrl()`您`WebView`的链接以保持内部链接，并`true`在这种情况下返回。如果这是您希望正常处理的 URL，请返回`false`.

# python - 试图在while循环中设置“按下错误的键”错误

> ID：14665674
> 
> 赞同：1
> 
> 时间：2013-02-02T19:35:48.190
> 
> 标签：python, python-2.7

所以我正在用“Learn Python The Hard Way”来学习 Python，我目前正在写一个简单的文本冒险。

我的问题出在代码的“战斗”部分（如下提供）。只有数字 1 和 2 是由用户按下的。如果按下不同的 int，它会正确地抛出“对不起，不明白”，但如果按下一个字母，它会吓坏并退出说，（非常正确）它期待一个 int。显然我的问题是，我如何将它设置为期望两者，并在按下字母时抛出错误？

提前致谢 ：）

```
 while True:
            player_dmg = randint(1, 10)
            enemy_dmg = randint(1, 10)

            if enemy_hp < 0:
                os.system('clear')
                print "[ENEMY NUTRALISED]"
                print
                print hit_e
                raw_input()
                return 'forth_area'
            elif player_hp < 0:
                return 'death'

            else:
                print "[COMBAT OPTIONS]"
                print "1\. Attack"
                print "2\. Defend"
                print
                choice = raw_input("*>>*")
                choice = int(choice)
                print
            if choice == 1:
                enemy_hp = enemy_hp - player_dmg
                print "[ENEMY STATUS: %d]" % enemy_hp
                print "[DAMAGE DONE: %d]" % player_dmg
                print
                player_hp = player_hp - enemy_dmg
                print "[DAMAGE RECIVED: %d]" % enemy_dmg
                print "[CURRENT STATUS: %d]" % player_hp
            elif choice  == 2:
                enemy_hp = enemy_hp - player_dmg / 2
                print "[ENEMY STATUS %d]" % enemy_hp
                print "[DAMAGE DONE %d]" % player_dmg
                print
                player_hp = player_hp - enemy_dmg
                player_hp = player_hp + 3
                print "[DAMAGE RECIVED: %d]" % enemy_dmg
                print "[CURRENT STATUS: %d]" % player_hp
                print
            else:
                print no_understand 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:41:58.077

你有：

```
choice = raw_input("*>>*")
choice = int(choice)
# . . .
if choice == 1:
# . . .
elif choice == 2: 
```

最简单的解决方法是使用：

```
choice = raw_input("*>>*")
# . . .
if choice == '1':
# . . .
elif choice == '2': 
```

`raw_input`返回一个字符串。为什么要转换成数字？只需测试 text`'1'`和`'2'`等。它还可以更轻松地添加字符命令（如`'q'`退出）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:01:47.910

我已经回答了一个类似的问题[https://stackoverflow.com/a/14644220/1481060](https://stackoverflow.com/a/14644220/1481060)并建议使用`cmd`处理这些命令循环的标准模块。

它应该使您能够在游戏中添加诸如**kill**、**look**等动词。

--

您可能还希望将您的游戏建模为对象，这样您就不会保留太多变量，因为我可以想象当某些东西得到`hit`健康时，伤害和耐力等也会下降。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:40:07.047

有几种方法可以处理这个问题。

我认为一个简单的解决方案是例外。

```
try:
    choice = int(choice)
except:
    choice = None 
```

它只是尝试将其`choice`转换为 int 类型。如果失败，则运行 except 块，并将选项设置为 None，因此 if/elif 块将不会运行。

好的，不是最简单的，@jimhark 有一个更简单的方法。

在这种情况下，将输入转换为整数似乎没有什么价值。

# wpf - 如何在 WPF 中创建重复的对角线作为背景？

> ID：14665678
> 
> 赞同：8
> 
> 时间：2013-02-02T19:35:58.143
> 
> 标签：wpf

好的，我已经绞尽脑汁、Google 和 stackoverflow 试图弄清楚这一点，但就是无法完全理解。我正在尝试使用带有 DrawingGroup 的 DrawingBrush 对我的 WPF 应用程序（最新版本）的背景做两件事。一，我想要一个 RadialGradientBrush 在我的背景中放置一个微妙的渐变。这部分工作得很好。我要完成的第二部分是我还希望将重复的对角线作为该背景的一部分。我知道我可以用图像来做到这一点，但我更愿意使用几何图形，因为我正在努力学习和掌握 WPF。这是我到目前为止所拥有的。径向看起来很好，但线条却没有。任何帮助，将不胜感激。

```
<Style x:Key="WindowBackground" TargetType="Grid">
        <Setter Property="Background">
            <Setter.Value>
                <DrawingBrush>
                    <DrawingBrush.Drawing>
                        <DrawingGroup>
                            <GeometryDrawing>
                                <GeometryDrawing.Brush>
                                    <RadialGradientBrush GradientOrigin="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                                        <GradientStop Color="#EE9D40" Offset="0"/>
                                        <GradientStop Color="#BF8230" Offset="1"/>
                                    </RadialGradientBrush>
                                </GeometryDrawing.Brush>
                                <GeometryDrawing.Geometry>
                                    <RectangleGeometry Rect="0,0,1,1"/>
                                </GeometryDrawing.Geometry>
                            </GeometryDrawing>
                            <GeometryDrawing>
                                <GeometryDrawing.Brush>
                                    <DrawingBrush TileMode="Tile" Stretch="None" Viewbox="0,0,1,1" Viewport="0,0,25,25" ViewportUnits="Absolute">
                                        <DrawingBrush.RelativeTransform>
                                            <TranslateTransform X="0" Y="0" />
                                        </DrawingBrush.RelativeTransform>
                                        <DrawingBrush.Drawing>
                                            <GeometryDrawing Brush="#20FFFFFF" Geometry="M10,0 22,0 12,25 0,22 Z" />
                                        </DrawingBrush.Drawing>
                                    </DrawingBrush>
                                </GeometryDrawing.Brush>
                                <GeometryDrawing.Geometry>
                                    <RectangleGeometry Rect="0,0,1,1"/>
                                </GeometryDrawing.Geometry>
                            </GeometryDrawing>
                        </DrawingGroup>
                    </DrawingBrush.Drawing>
                </DrawingBrush>
            </Setter.Value>
        </Setter>
    </Style> 
```

* * *

## 回答 #1

> 赞同：23
> 
> 时间：2013-02-02T19:40:42.663

这个技巧应该有效。

```
<LinearGradientBrush EndPoint="0,0" StartPoint="8,8" 
                     MappingMode="Absolute" SpreadMethod="Repeat">
    <GradientStop Color="Black" Offset="0" />
    <GradientStop Color="Black" Offset="0.1" />
    <GradientStop Color="White" Offset="0.1" />
    <GradientStop Color="White" Offset="1" />
</LinearGradientBrush> 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-07-22T23:02:52.153

*   尝试旋转水平线刷以避免角落间隙：

    ```
    <VisualBrush TileMode="Tile" 
     Viewport="0,0,5,5" ViewportUnits="Absolute" 
     Viewbox="0,0,5,5"  ViewboxUnits="Absolute">
     <VisualBrush.Visual>
        <Grid Background="White" Height="5">
            <Path Stroke="Black" Data="M 0 3 l 8 0" />
        </Grid>
     </VisualBrush.Visual>
     <VisualBrush.RelativeTransform>
         <RotateTransform CenterX="0.5" CenterY="0.5" Angle="45" />
     </VisualBrush.RelativeTransform>
    </VisualBrush> 
    ```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T23:58:18.120

I finally got it working, but not with a single composite brush like I was wanting. I used the following styles:

```
<Style x:Key="WindowBackground" TargetType="Grid">
            <Setter Property="Background">
                <Setter.Value>
                    <RadialGradientBrush GradientOrigin="0.5,0.5" RadiusX="0.5" RadiusY="0.5">
                        <GradientStop Color="#EAA659" Offset="0"/>
                        <GradientStop Color="#BF8230" Offset="1"/>
                    </RadialGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="HatchOverlay" TargetType="Rectangle">
            <Setter Property="Fill">
                <Setter.Value>
                    <VisualBrush Opacity=".1" TileMode="Tile" Viewport="0,0,10,20" ViewportUnits="Absolute">
                        <VisualBrush.Visual>
                            <Canvas>
                                <Path Stroke="#825821" Data="M 0 0 l 10 20" />
                            </Canvas>
                        </VisualBrush.Visual>
                    </VisualBrush>
                </Setter.Value>
            </Setter>
        </Style> 
```

Then, to enable it at run time, I added a rectangle as the first child of my grid, like so:

```
<Grid Style="{StaticResource WindowBackground}">
    <Rectangle Style="{StaticResource HatchOverlay}"/>... 
```

This gave me the effect that I was after. Thanks for your help; I'll up-vote each of you.

# dom - Chrome 扩展：访问框架元素

> ID：14665679
> 
> 赞同：2
> 
> 时间：2013-02-02T19:35:58.720
> 
> 标签：dom, google-chrome-extension, frame

我正在开发一个 chrome 扩展（内容脚本）来访问网页内容。我使用 DOM 访问页面中的所有元素。当网页包含“框架集”时，我的代码无法正常工作。在这件事上，我可以计算帧数，但无法访问帧内容。我使用此代码来计算当前页面上可用的框架对象：

对于框架集：

```
parent.frames.length 
```

对于 iframe ：

```
document.getElementsByTagName("iframe").length 
```

但以下代码不起作用：

```
parent.frames[0] 
```

并返回“未定义”。

我的问题：如何访问 chrome 扩展中的框架集元素（对于 iframe 和框架集）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-02-06T05:40:37.857

与[Jerinaw](https://stackoverflow.com/users/808603/jerinaw)的处理方式类似，我通过 jQuery 执行了以下操作：

```
// Find the frame
var frame = $(document).find("frame[name='nameOfFrame']")[0];
// Callback once frame's internals are loaded
$(frame).load(function() {
  accessFrame();
});

function accessFrame() {
  // The following line is really important to accessing the frame's content.
  var frameContent = frame.contentDocument;
  // Notice that $(".objectSelectorClass") won't discover the object you're hunting for.  You have to find it within the frame's contentDocument.
  var objectInFrame = $(frameContent).find(".objectSelectorClass");
  var objectInFrame_AlternateSyntax = $(".objectSelectorClass", frameContent)
  // do stuff to objectInFrame
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-09-01T23:46:02.403

我遇到了同样的问题。框架不是 iframe，它们位于框架集中。我必须做的是向框架加载（由于某种原因 addEventListener 不起作用），但通过它的 contentWindow

例如：来自主文档

```
document.querySelector('#SomeFrameSelector').contentWindow.document.body.onload 
```

以这种方式访问​​框架让我进入框架文档并允许我附加 onload。一旦使用相同的选择器触发，我就可以修改框架内容。

# jquery - CakePHP + ajaxForm - 加载部分视图

> ID：14665681
> 
> 赞同：1
> 
> 时间：2013-02-02T19:36:01.840
> 
> 标签：jquery, ajax, cakephp

我通过 jQuery 插件 AjaxForm 将表单提交到服务器。

这是我的简化视图：

```
<div id="output1">...here goes my CakePHP PHP form code...</div>

<script type="text/javascript">
    $(document).ready(function() { 
        var options = { 
            target:'#output1',
            beforeSubmit: onBeforeSubmit,
            success: onSuccess,
            error: onError
        }; 
        $('#CommentEditForm').ajaxForm(options); 
    });
</script> 
```

在我的控制器功能中，当我收到未经模型验证的表单数据时，我更改了 ajax 布局的布局并返回没有默认布局的 html 内容的视图，并将其附加到我视图中的 div#output1 中。

似乎没问题，但现在除了 div#output1 和 javascript 代码之外，我还可以查看表单。我知道我的问题在哪里 - 我需要解决方案如何*只*返回表单数据而不是 javascript 代码和 div#output1 的东西。这个逻辑将在我的所有应用程序中使用，所以我想避免在我的所有视图中硬编码 {if...else} 条件。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:19:06.257

thaJezath 的回答很好，但还有其他一些事情：

1.  将 CakePHP Js 助手用于所有 ajax 内容更容易、更 DRY：

    ```
    <div id="output">
    <?php
        echo $this->Form->create();
        echo $this->Form->input('input1');
        echo $this->Form->input('input2');
        echo $this->Js->submit('submit',array('update' => '#output');
    ?>
    </div> 
    ```

这将自动添加将为您处理 ajax 提交的缓冲脚本。但是你需要在标签`echo $this->Js->writeBuffer();`之前的布局中使用 line 。`</body>`但这仍然会返回`<div id="output">...`- 如果您更改为`'update' => '#content'`，它将重新加载整个内容 div。

1.  如果你真的需要更新只是形式而不是其他东西：

在您的视图文件中：

```
 <div id="output">
     <?php $this->start('ajax-content'); // this line starts new block ?>
     <?php
        echo $this->Form->create();
        echo $this->Form->input('input1');
        echo $this->Form->input('input2');
        echo $this->Js->submit('submit',array('update' => '#output');
    ?>
    <?php
        $this->end(); // this line ends block
        echo $this->fetch('ajax-content'); // this line print contents of block
    ?>
    </div> 
```

在您的 /View/Layouts/ajax.ctp 中：

```
 <?php
        // next 2 lines only ensure that ajax-content block exists
        // if not it will be just empty string
        $this->startIfEmpty('ajax-content'); 
        $this->end();
        echo $this->fetch('ajax-content'); // this line outputs ajax-content block (the form)
    ?> 
```

因此，总而言之，此方法将您想要返回的内容包含在视图块内的 ajax 内容中。然后 ajax 布局而不是打印整个视图 ( `$this->fetch('content');`)，它只打印 ajax-content 块 ( `$this->fetch('ajax-content');`) 的内容。这样，您可以在每个视图中标记您想要在 ajax 请求期间返回的所有内容。

这些行：

```
 $this->end(); // this line ends block
        echo $this->fetch('ajax-content'); // this line print contents of block 
```

可能不太方便 - 将所有块记录代码放在您自己的助手中以简单地使用它是个好主意：

```
 <div id=...
    $this->AjaxContent->start();
    your form here
    $this->AjaxContent->stop();
    </div> 
```

正如 thaJezath 在评论中所写，JsHelper 将在未来的版本中被弃用，因此如他所说，使用视图块会更安全。HtmlHelper 有这样做的方便的方式：

```
 <?php $this->Html->scriptStart(array('inline' => false)); ?>
        $(document).ready(function(){ 
            // your code here
        });
    <?php $this->Html->scriptStart(array('inline' => false)); ?> 
```

这会将您的脚本添加到`"script"`以默认布局打印的 viewBlock 中`$this->fetch('script');`

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:36:43.923

You should use the JavaScript buffer or a 'view block' to output your JavaScript, this way you can output the javascript inside your Layout, not in your view. As you're already switching to a different layout (or no layout) for your AJAX requests, the script will not be included when retrieving via AJAX.

Change your view to this:

Modify the content of your view to this:

```
<div id="output1">...here goes my CakePHP PHP form code...</div>

<?php

/**
 * I'm using 'heredoc' notation so that you don't have to escape quotes and '$'
 * @link http://www.php.net/manual/en/language.types.string.php#language.types.string.syntax.heredoc
 */
$script = <<< JS
    $('#CommentEditForm').ajaxForm({ 
        target:'#output1',
        beforeSubmit: onBeforeSubmit,
        success: onSuccess,
        error: onError
    }); 
JS;

/**
 * Append the JavaScript to the JavaScript-buffer
 * using the JS helper
 * 
 * @link http://book.cakephp.org/2.0/en/core-libraries/helpers/js.html
 */
$this->Js->buffer($script); 
```

Output the JavaScript in your layout (e.g. Layouts/default.ctp)

```
<!-- rest of your layout here -->

<?php
// Output the JavaScript and wrap it in a 'onDomready()' wrapper
echo $this->Js->writeBuffer();
?>
</body>
</html> 
```

NOTE: You DONT have to add the 'onDomready()' to your scripts when using the JS-buffer, CakePHP will add them automatically when outputing the buffer with $this->Js->writeBuffer()

NOTE2: Using the output-buffer allows you to add JavaScript to the buffer multiple times. For example, if you're using 'elements', you are able to add javascript to the buffer as well. This allows you to add script 'as-you-go' and output them all at once at the end of your body

# php - htaccess 防止直接页面加载

> ID：14665685
> 
> 赞同：0
> 
> 时间：2013-02-02T19:36:23.353
> 
> 标签：php, .htaccess

我试图阻止使用 htaccess 直接访问我网站上除 index.php 之外的所有 php 文件。到目前为止，我已经有了以下代码，但是它仍然不能阻止表单直接访问 php 文件。

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond $1 !^(index\.php)
RewriteRule ^(.*)$ index.php?page=$1 [L]
</IfModule> 
```

我的解决方案：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteCond $1 !^(index\.php|.*\.css|.*\.js|.*\.png|.*\.gif|.*\.jpg)
RewriteRule ^(.*)$ index.php?page=$1 [L]
</IfModule> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:40:18.050

那是因为这些行：

```
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d 
```

如果请求的资源是文件或目录，您明确告诉重写模块不运行以下规则

但是，我同意最好将它们完全移出网络根目录。

# java - 总是相同的线程处于等待状态

> ID：14665687
> 
> 赞同：2
> 
> 时间：2013-02-02T19:36:36.327
> 
> 标签：java, multithreading, wait

我对这个简单的练习有一个问题：有一个停车场，一次最多允许 4 辆车，有 6 辆车。

问题是4辆车进入后，接下来的2辆车进入等待状态，从不进入。

这是我在屏幕上看到的：

```
Car 1 in
Car 2 in
Car 5 in
Car 6 in
Car 4 is waiting
Car 3 is waiting
Car 1 out
Car 1 in
Car 3 is waiting
Car 4 is waiting
Car 5 out
Car 5 in
Car 2 out
Car 2 in
and so on.. 
```

这里的类：

```
public class Car extends Thread{

    int idCar;
    Monitor monitor;

    public Car(int id, Monitor monitor){
        idCar=id;
        this.monitor=monitor;
    }

    public void run(){
        while(true){
            monitor.enter(idCar);
            try{
               sleep(2000);
            }catch(Exception e){}
            monitor.exit(idCar);
        }
    }

}

public class Monitor {

    int maxSpots;
    int parkedCars;

    public Monitor(int maxSpots){
        this.maxSpots=maxSpots;
        parkedCars=0;
    }

    public synchronized void enter(int idCar){
        while(parkedCars==maxSpots){
            try{
                System.out.println("Car "+idCar+" is waiting");
                wait();
            }catch(Exception e){}
        }
        ++parkedCars;
        System.out.println("Car "+idCar+" in");
        notifyAll();

    }

    public synchronized void exit(int idCar){
        /*while(parkedCars==0){   // i'm not sure if this check is needed, because
            try{              // no car will ever get out, if it's not in.
                wait();
            }catch(Exception e){}
        }*/
        --parkedCars;
        System.out.println("Car "+idCar+" out");
        notifyAll();

    }

}

public class Parking {

    public static void main(String[] args){

        Monitor m = new Monitor(4);

        Car c1 = new Car(1, m);
        Car c2 = new Car(2, m);
        Car c3 = new Car(3, m);
        Car c4 = new Car(4, m);
        Car c5 = new Car(5, m);
        Car c6 = new Car(6, m);

        c1.start();
        c2.start();
        c3.start();
        c4.start();
        c5.start();
        c6.start();

    }
} 
```

谁能解释一下？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T19:48:33.530

您设计的代码使您的监视器**不公平**。如果 a`Car`退出插槽，它将进入循环的下一步，因此它会立即尝试再次进入。与此同时，你的其他等待`Car`者会被 吵醒`Thread.notifyAll()`。
好吧，那些`Thread`s 不是最快的。他们不能保证立即开始工作......

`Car`刚刚退出插槽的会发生什么？它试图再次停车。而且由于它的线程没有等待它不需要重新开始工作......它会立即停放。
您可能想要的是一个**队列**。将您的请求添加`Car`到 a 中`Queue`，如果发生输入，请先通知您最长的等待时间`Car`。正如 Jan 建议的那样，另一种方法是**让那些离开`Car`的人稍等片刻**，给其他停车者一个机会。这可以通过使用`Thread.yield()`或`Thread.sleep()`退出来实现`Car`（在退出完成之后）。

你制作的这个场景对所有相关方来说都很烦人。诚实`Car`的等待者永远在等待他们的位置，而自我停车者永远不会回家；）

# jquery - 自定义 jQuery 滚动条

> ID：14665688
> 
> 赞同：0
> 
> 时间：2013-02-02T19:36:45.577
> 
> 标签：jquery, scrollbar

我正在使用一个名为[Tiny Scrollbar](http://baijs.nl/tinyscrollbar/)的自定义滚动条插件。在滚动条内，我有一个手风琴式导航。

我的问题是当导航高度改变时滚动条没有更新，有人有什么想法吗？我在想每次点击时可能会更新某种形式的 ajax，但是我没有 ajax 经验，所以我不知道。这是导航的代码。

```
<div id="nav-container">
  <div class="scrollbar">
    <div class="track">
      <div class="thumb">
        <div class="end"></div>
      </div>
    </div>
  </div>
<div class="viewport">
  <div class="overview">
    <nav class="main">

    <div class="menu-item">
      <h4><a href="#">Inledning</a></h4>
        <ul>
          <li><a href="#">Link 1</a></li>
          <li><a href="#">Link 2</a></li>
          <li><a href="#">Link 3</a></li>
        </ul>
    </div>

    </nav>
  </div>
</div>
</div> 
```

jQuery：

```
$(document).ready(function() {
var $ul = $('ul');

$( "h4" ).click(function() {
  $( "h4" ).removeClass( "menu-selected" );
  $ul.hide( "blind", 1000 );
$(this).toggleClass( "menu-selected" );
  $(this).next().show( "blind", 1000 );
});

$( "li" ).click(function() {
  $( "li" ).removeClass( "select" );
    $(this).addClass( "select" );
  });
}); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:47:08.343

在 Tiny Scrollbar 网站上，它说当添加新内容时，您需要更新容器。例如

```
//The update method can be used for adjusting a scrollbar to its new content.
var yourScrollBar = $('nav-container');
yourScrollBar.tinyscrollbar();

//The below function would be called when updating the content. 
yourScrollBar.tinyscrollbar_update(); 
```

[上面的代码是来自插件网站](http://baijs.nl/tinyscrollbar/)的示例。

例如使用您的代码。

```
$( "h4" ).click(function() {
  $( "h4" ).removeClass( "menu-selected" );
  $ul.hide( "blind", 1000 );
  $(this).toggleClass( "menu-selected" );
  $(this).next().show( "blind", 1000 );
  yourScrollBar.tinyscrollbar_update(); <-------- Here. 
}); 
```

# mingw - 使用 libwinpthread 进行静态链接

> ID：14665691
> 
> 赞同：9
> 
> 时间：2013-02-02T19:37:03.937
> 
> 标签：mingw, static-linking, mingw-w64

我尝试使用静态链接工具链库构建程序。我通过：

```
LDFLAGS="-Wl,-Bstatic -lwinpthread -Wl,-Bdynamic -static-libgcc -static-libstdc++" 
```

但程序与 shared 链接`libwinpthread-1.dll`。

我做错了什么？

只有当我得到静态链接的 libwinpthreads 时，才能传递`-static`给`LDFLAGS`. 但它破坏了带有插件系统的构建程序。

我使用 MinGW-builds 项目中的 mingw-w64 + GCC-4.7.2：http: [//sourceforge.net/projects/mingwbuilds/](http://sourceforge.net/projects/mingwbuilds/)

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2015-01-17T15:55:03.877

尝试这个：

```
-static-libgcc -static-libstdc++ -Wl,-Bstatic -lstdc++ -lpthread -Wl,-Bdynamic 
```

注意`-lstdc++`前面的`-lpthread`。它对我有用。

确保将其添加到`g++`命令行的最后。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-11-28T14:37:03.723

你没有做任何不正确的事情，Mingw-Builds 就是这样工作的。

我最近偶然发现了这一点，但还有一个原因：

Mingw-Builds 自动将可执行文件链接到 GCC 动态库（libwinpthread-1.dll、libstdc++-6.dll、libgcc_s_dw2-1.dll）以节省可执行文件大小（问题：当您发布可执行文件时，您必须记住同时添加丢失的 dll使用您的二进制文件，因为不能保证用户在他们的系统上拥有这些 DLL）

就我而言，问题是我在同一个系统上有多个 GCC 包，因此我没有将它们添加到 PATH 以避免名称冲突。

有趣的是，CMAKE 在配置您的项目之前会生成一个 C-SourceFile，该文件已被编译并用于获取有关您的编译器的信息，因为 DLL 不在 PATH 中，CMake 生成的小型可执行文件由于缺少 DLL 而崩溃并停止了整个构建过程。

解决该问题的解决方案是将编译器路径添加到 PATH TEMPORARILY（或者更好地在另一个环境中运行 CMake）。

手动将 DLL 添加到 Cmake 临时目录不起作用，因为 Cmake 在每个配置中清理该目录..

如果你使用 mingwbuilds 你必须链接到 pthreadBLAH.dll 没有解决方法

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-04-15T19:15:41.783

不理想，但如果您不介意将运行时 DLL 与可执行文件放在同一目录中，则可以在 CMakeLists.txt 文件中添加类似的内容。这会将必要的 DLL 从 MingW bin 目录复制到当前的构建目录中。

```
# ...
# change to name of your project
set(TARGET_NAME ${PROJECT_NAME})
# change to path to your minw bin directory
set(MINGW_BIN_PATH "C:\\Program Files\ \(x86\)\\mingw-w64\\i686-4.9.2-posix-dwarf-rt_v3-rev1\\mingw32\\bin")

set(LIBGCC_DLL "${MINGW_BIN_PATH}\\libgcc_s_dw2-1.dll")
add_custom_command(TARGET ${TARGET_NAME} PRE_BUILD
                   COMMAND ${CMAKE_COMMAND} -E copy
                   ${LIBGCC_DLL} $<TARGET_FILE_DIR:${TARGET_NAME}>)
set(LIBSTDCPP_DLL "${MINGW_BIN_PATH}\\libstdc++-6.dll")
add_custom_command(TARGET ${TARGET_NAME} PRE_BUILD
                   COMMAND ${CMAKE_COMMAND} -E copy
                   ${LIBSTDCPP_DLL} $<TARGET_FILE_DIR:${TARGET_NAME}>)
 set(LIBWINPTHREAD_DLL "${MINGW_BIN_PATH}\\libwinpthread-1.dll")
 add_custom_command(TARGET ${TARGET_NAME} PRE_BUILD
                    COMMAND ${CMAKE_COMMAND} -E copy
                    ${LIBWINPTHREAD_DLL} $<TARGET_FILE_DIR:${TARGET_NAME}>) 
```

# css - 垂直和水平中心在 div 内对齐

> ID：14665693
> 
> 赞同：0
> 
> 时间：2013-02-02T19:37:17.243
> 
> 标签：css, header, alignment, center

我需要一些帮助。我已经尝试了好几个小时，但找不到有效的解决方案。

```
<div id="Header">
<img src='http://3.bp.blogspot.com/-rN0cMMTn_Mw/ToQ6VTghSOI/AAAAAAAAAfs/xl1XMFyn7Jo/s640/18_5_orig.jpg'
/>
 <h1>siajdasdasdasd</h1>

<p>sdhaosidasdas</p> 
```

[我想做什么的例子](http://jsfiddle.net/74Rnq/20/)

我想要一个液体标题，其图像向左对齐，标题与中心对齐，但是两个 em 都必须对齐到高度的中间，如果我增加 img / div 的高度就不行了

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:52:18.403

不得不添加更多的div，但它的工作原理。[http://jsfiddle.net/74Rnq/23/](http://jsfiddle.net/74Rnq/23/)

HTML：

```
<div id="Header">
    <div class="wrap">
        <img src='http://3.bp.blogspot.com/-rN0cMMTn_Mw/ToQ6VTghSOI/AAAAAAAAAfs/xl1XMFyn7Jo/s640/18_5_orig.jpg'/>
        <div class="text">
            <h1>siajdasdasdasd</h1>
            <p>sdhaosidasdas</p>
        </div>
    </div>
</div> 
```

CSS：

```
#Header {
    position: relative;
    height: 200px;
    padding: 15px;
    background: #DBE6EC;
    border-bottom: 1px solid #595959;
    overflow: auto;
}
#Header h1, p {
    text-align: center;
    letter-spacing: -1px;
    text-align: center;
    font-size: 2em;
    color: #1F1F1F;
}
#Header p {
    font-size: 1em;
}
#Header img {
    float: left;
    max-height:100px;
}

#Header .wrap {
    display: block;
    position: absolute;
    width: 100%;
    top: 50%;
    margin-top: -50px; /* Half of wrap div height */
}

#Header .wrap .text {
    position: absolute;
    top: 50%;
    margin-top: -27.5px; /* Half of text div height */
    width: 100%;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:09:52.340

对于现代浏览器，您可以通过 display:table、table-row 表格单元格来完成：

像这样修改你的html：

```
<div id="Header" class="table">
    <div class="row">
        <div class="cell">
            <img src='http://3.bp.blogspot.com/-rN0cMMTn_Mw/ToQ6VTghSOI/AAAAAAAAAfs/xl1XMFyn7Jo/s640/18_5_orig.jpg'/>
        </div>
        <div class="cell main">
             <h1>siajdasdasdasd</h1>
             <p>sdhaosidasdas</p>
        </div>
    </div>
</div>

#Header {
    background: #DBE6EC;
    border-bottom: 1px solid #595959;
    position:relative;
    padding:15px;
    -moz-box-sizing: border-box; 
    -webkit-box-sizing: border-box; 
    box-sizing: border-box; 
}

.table {
    display:table;
    width:100%;
}

.row {
    display:table-row;
}

.cell {
    display:table-cell;
    vertical-align:middle;
}

.cell.main {
    width:100%;
} 
```

更新的小提琴在[这里](http://jsfiddle.net/fBN3D/1/)。此解决方案不适用于 ie7。如果您必须支持 ie7，则[垂直对齐中间](http://www.jakpsatweb.cz/css/priklady/vertical-align-valid-solution-en.html)有一个较旧的解决方法。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:13:56.483

制作容器 div`display: table-cell`和每个子 div `display: table-cell`。然后你可以给子 div `vertical-align: middle`，它们总是垂直居中。

HTML：

```
<div id="Header">
    <div id="image">
        <img src='http://3.bp.blogspot.com/-rN0cMMTn_Mw/ToQ6VTghSOI/AAAAAAAAAfs/xl1XMFyn7Jo/s640/18_5_orig.jpg' />
    </div>
    <div id="title">
       <h1>siajdasdasdasd</h1>
       <p>sdhaosidasdas</p>
    </div>
</div> 
```

和 CSS：

```
#Header {
    padding: 15px;
    background: #DBE6EC;
    border-bottom: 1px solid #595959;
    display: table;
}
#Header h1, p {
    text-align: center;
    letter-spacing: -1px;
    font-size: 2em;
    color: #1F1F1F;
}
#Header p {
    font-size: 1em;
}
#Header img {
    float: left;
    max-height:100px;
}
#title{
    display: table-cell;
    vertical-align: middle;    
    width: 100%;
}
#image{
    display: table-cell;
    vertical-align: middle;
} 
```

Aaand 这是**[jsFiddle](http://jsfiddle.net/bQKhp/)**。

# python - git merge 与我们的数据库文件冲突（多个开发人员）

> ID：14665695
> 
> 赞同：8
> 
> 时间：2013-02-02T19:37:45.053
> 
> 标签：python, django, git, github, django-database

我和一个朋友正在开发一个 Django 应用程序并使用 git。

在我们工作的过程中，我们会在我们的网站上创建虚假帐户、登录并将内容上传到数据库等......出于测试目的。**每次合并分支时，我们的数据库文件中都会出现合并冲突**。数据库文件位于存储库中，并且由于我们是单独测试的，因此文件的本地副本的开发方式不同。

如何防止数据库文件被跟踪，以便我们每个人都可以保留本地副本？

通过以下方式，我们能够避免使用本地路径：

```
## settings.py

from os.path import dirname, join

PROJECT_DIR = dirname(__file__)

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': join(PROJECT_DIR, 'foo.db'),
        'USER': '',
        'PASSWORD': '',
        'HOST': '',
        'PORT': '',
    }
} 
```

理想的情况是：

```
## settings.py

from os.path import dirname, join

PROJECT_DIR = dirname(__file__)

DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.sqlite3',
        'NAME': join('../../../', PROJECT_DIR, 'foo.db'), # this path is outside the repository (ie, 'Users/sgarza62/foo.db')
        'USER': '',
        'PASSWORD': '',
        'HOST': '',
        'PORT': '',
    }
} 
```

* * *

我们如何防止我们的数据库文件被提交？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T19:42:45.593

将您的数据库文件添加到`.gitignore`. 然后您可以将其保留在当前位置，但它不受版本控制。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-02-02T20:02:36.030

首先，您需要从 git 存储库中删除数据库文件。

```
git rm <database_file> 
```

为了防止文件被添加到您的存储库，请在您的存储库签出中创建一个名为“.gitignore”的文件，将数据库文件添加到 .gitignore，然后将 .gitignore 添加到您的存储库。（[文档](http://git-scm.com/book/en/Git-Basics-Recording-Changes-to-the-Repository#Ignoring-Files)）

为了防止与 settings.py 发生冲突，我还将 settings.py 添加到 .gitignore。然后我创建一个名为“settings.production.py”的文件，其中包含生产服务器的所有设置，并将其添加到存储库中。在本地结帐时，我只需将此文件复制到 settings.py 并根据需要修改变量。在我的生产服务器上，我创建了 settings.production.py 的符号链接。

```
ln -s settings.production.py settings.py 
```

**警告：**

1.  如果您的存储库是公开的，它不应该存储密钥、密码、证书等。您不希望其他人有权访问这些文件。
2.  您还应该验证您的 Web 服务器不提供“.git”文件夹。如果可以访问，黑客可以[访问您的源代码](http://www.skullsecurity.org/blog/2012/using-git-clone-to-get-pwn3d)`http://example.com/.git`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:44:40.580

当您与其他 ppl 共享存储库一起处理项目时，您必须制作 local_settings.py 并保留所有本地设置:) 然后在 settings.py 中添加`from local_settings import *`. 并将 local_settings.py 和数据库文件添加到`.gitignore`文件中。

例如，如果您的文件名`database.db`在此文件所在的目录中，则创建具有名称的文件`.gitignore`并写入其中`database.db`或`*.db`忽略所有 db 文件。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T21:06:30.767

这是一个常见的问题。我建议不要签入数据库并根据需要加载和保存数据夹具。（[https://docs.djangoproject.com/en/dev/howto/initial-data/](https://docs.djangoproject.com/en/dev/howto/initial-data/)）

创建 test_data 目录并运行以下命令将数据库导出到与数据库无关的 json 文件：./manage.py dumpdata > test_data/test_file_1.json

将该文件签入源。如果您想在任何时候将数据库恢复到该点，只需运行：./manage.py loaddata test_data/test_file_1.json

这也具有用于单元测试的优点（阅读[在 django 单元测试中加载固定装置](https://stackoverflow.com/questions/2470634/loading-fixtures-in-django-unit-tests)）

```
from django.test import TestCase
class MyTestCase(TestCase):
    fixtures = ['/myapp/fixtures/dump.json',] 
```

# regex - 正则表达式匹配每个字符，但以下

> ID：14665696
> 
> 赞同：0
> 
> 时间：2013-02-02T19:38:04.367
> 
> 标签：regex, match

你能帮我建立一个匹配所有字符的正则表达式`[a-zA-Z][\w:.-]`吗？

例如：在测试字符串`abc)def`中，`)`应该是最终正则表达式的匹配字符。

我尝试使用正则表达式的几种变体`(?!fox\b)\b\w+`（[请参阅](http://www.codinghorror.com/blog/2005/10/excluding-matches-with-regular-expressions.html)），但没有任何结果。

为了方便测试，您可以使用[此服务](http://www.cuneytyilmaz.com/prog/jrx/)。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:05:00.773

如果这是 javascript，您可以这样做：

```
<script type="text/javascript">
function match_with_space(str) {
    return str.match(/[^\w:.-]/g);
}
function match_without_space(str) {
    return str.match(/[^\w\s:.-]/g);
}
</script> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:42:18.577

你可以[*否定*一个字符类](http://www.regular-expressions.info/charclass.html#negated)：`[^a-zA-Z]`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T19:43:49.457

对不起，我似乎忽略了这个问题。

答案是：

```
[^a-zA-Z\w:.-] 
```

谢谢！

# google-apps-script - 谷歌脚本：有条件地将行从一个工作表复制到同一个电子表格中的另一个工作表

> ID：14665698
> 
> 赞同：6
> 
> 时间：2013-02-02T19:38:40.997
> 
> 标签：google-apps-script, google-sheets, google-spreadsheet-api

我阅读了[Google Script：有条件地将行从一个电子表格复制到另一个电子表格](https://stackoverflow.com/questions/10907267/google-script-conditionally-copy-rows-from-one-spreadsheet-to-another)，但无法让它为我工作。

我需要一个脚本来允许我执行下面引用的文本。请随时编辑[我的电子表格](https://docs.google.com/spreadsheet/ccc?key=0AoJdwy8V1ldHdFA5M1M1Wlp1NHZhcmxJOUZKVEU4X3c&usp=sharing)以制作完整的工作脚本。我会将电子表格公开，任何人都可以复制脚本供自己使用。我真的对脚本写作一无所知，所以我需要把它全部拼出来。抱歉，我对这一切都很陌生，但这将帮助我学习。

[https://docs.google.com/spreadsheet/ccc?key=0AoJdwy8V1ldHdFA5M1M1Wlp1NHZhcmxJOUZKVEU4X3c&usp=sharing](https://docs.google.com/spreadsheet/ccc?key=0AoJdwy8V1ldHdFA5M1M1Wlp1NHZhcmxJOUZKVEU4X3c&usp=sharing)

> 如果工作表“All_Mileage”上的 B 列显示“John”，那么我希望将该行从第 3 行开始复制并粘贴到工作表“John”中。
> 
> 如果工作表“All_Mileage”上的 B 列显示“Adam”，那么我希望将该行从第 3 行开始复制并粘贴到工作表“Adam”中。
> 
> 如果工作表“All_Mileage”上的 B 列显示“Mike”，那么我希望将该行从第 3 行开始复制并粘贴到工作表“Mike”中。

我在这里看到了其他脚本，但我无法让它们工作。就像我说的，在代码方面我比树苗更环保。

万分感谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-02T20:28:17.520

C.Lang 是对的，这不是获取现成脚本的地方……但是由于这个问题很常见并且经常被回答，所以我花了几分钟来编写和测试……所以它是：

```
var ss=SpreadsheetApp.getActiveSpreadsheet();// some global variables
var master = ss.getSheetByName('All_Mileage');
var colWidth = master.getMaxColumns();

    function copyRowsOnCondition() {
      var data = master.getDataRange().getValues();
      for(n=2;n<data.length;++n){
        if(data[n][1].length<16){ // if not pre-filled with your text
        Logger.log(data[n][1])
         var dest = ss.getSheetByName(data[n][1].toString().replace(/ /g,''));//remove any spaces that could be included in the name so the name = sheetName for sure
         var destRange = dest.getRange(dest.getLastRow()+1,1);// the place to write
         master.getRange(n+1,1,1,colWidth).copyTo(destRange);the copy itself value & format
         }
      }// loop
    } 
```

**编辑：**因为我使用 MasterSheet 中的名称值来查找目标工作表，所以我认为通过使用相同的规则创建目标工作表来处理不存在目标工作表的情况可能很有用，即。`name = sheetName`...

另一个问题是没有办法知道哪些行已经被复制了......所以我制作了一个处理所有这些的版本，只复制手动选择的行（即使只有一个列）并更改背景颜色表示这些行已被处理。我还添加了一个菜单以获得最小的舒适度；-)

*（如何在寒冷的周日下午保持忙碌 ;-)*

```
var ss=SpreadsheetApp.getActiveSpreadsheet();
var master = ss.getSheetByName('All_Mileage');
var colWidth = master.getLastColumn();// last used col in masterSheet
var sheets = ss.getSheets();// number of sheets

function onOpen() {
  var menuEntries = [ {name: "Copy selected Rows to sheets", functionName: "copyRowsOnConditionV2"},

                     ];
  ss.addMenu("Copy functions",menuEntries);// custom menu
}
function copyRowsOnConditionV2() {
  var sheetNames = [];// array of existing sheet names
  var sheets = ss.getSheets();// number of sheets
  for(s=0;s<sheets.length;++s){sheetNames.push(sheets[s].getName())};
  ss.getActiveSelection().setBackground('#ffffbb'); 
  var selectedfirstRow = ss.getActiveSelection().getRowIndex();
  var selectedHeigth = ss.getActiveSelection().getHeight()
  var selectedFullRange = master.getRange(selectedfirstRow,1,selectedHeigth,colWidth);
  var data = selectedFullRange.getValues();
  for(n=0;n<data.length;++n){
    if(data[n][1].length<16){
     if(sheetNames.toString().match(data[n][1].toString().replace(/ /g,''))!=data[n][1].toString().replace(/ /g,'')){// if no sheet exist with this name
     var newSheet = ss.insertSheet(data[n][1].toString().replace(/ /g,''),ss.getSheets().length);// then create it
     master.getRange(1,1,2,colWidth).copyTo(newSheet.getRange(1,1));// and copy the headers on 2 first rows, then continue as usual
     newSheet.getRange(1,1).setValue('Gas Mileage Log - '+data[n][1].toString().replace(/ /g,''));// set name in header
     SpreadsheetApp.flush();
     var sheets = ss.getSheets();// number of sheets
     var sheetNames = [];// update array of existing sheet names
     for(s=1;s<sheets.length;++s){sheetNames.push(sheets[s].getName())};
     Logger.log(sheetNames)
     };
     var dest = ss.getSheetByName(data[n][1].toString().replace(/ /g,''));//find the destination sheet
     Logger.log(data[n][1].toString().replace(/ /g,''))
     var destRange = dest.getRange(dest.getLastRow()+1,1);// define range
     master.getRange(selectedfirstRow+n,1,1,colWidth).copyTo(destRange);// and make copy below last row
     }
  }
} 
```

下图：

![在此处输入图像描述](../Images/0cea15c451f976fa779714bb596f6895.png)

# ruby-on-rails-3 - Rails 3：使用 Carrierwave/Minimagick 上传图像文件时遇到问题

> ID：14665700
> 
> 赞同：1
> 
> 时间：2013-02-02T19:38:59.473
> 
> 标签：ruby-on-rails-3, carrierwave, minimagick

最近在使用 Carrierwave/Minimagick 上传文件时遇到了一些麻烦。当我上传一个图像文件（由 Minimagick 处理）时，我得到了这种错误：

```
No such file or directory - identify -ping /tmp/mini_magick20130202-16398-ph54gr.jpg 
```

这在我的应用程序中没有发生过。不是图像的文件给我带来了麻烦。这是我的图片上传文件：

```
class ImageUploader < CarrierWave::Uploader::Base

  include CarrierWave::MiniMagick

  ...

  version :small do
    process :resize_to_fit => [300, 100]
  end

  # Add a white list of extensions which are allowed to be uploaded.
  # For images you might use something like this:
  def extension_white_list
    %w(jpg jpeg gif png)
  end

end 
```

我发现没有请求图像的版本，没有发生错误（但我没有得到版本）。

# sql - PLS-00201：必须声明标识符“用户输入”

> ID：14665701
> 
> 赞同：4
> 
> 时间：2013-02-02T19:39:03.777
> 
> 标签：sql, oracle, plsql, cursor, sqlplus

当我尝试在提示“请输入区域：”时输入用户输入时，我收到错误“PLS-00201：必须声明标识符'CHICAGO'”，例如如果我输入“CHICAGO”（当然不带引号） ) 我收到 PLS-00201 错误。我不知道为什么-有什么想法吗？提前致谢。

```
ACCEPT p_1 PROMPT 'PLEASE ENTER THE REGION:'

DECLARE
  V_CHILD  REGIONS.CHILD_NAME%TYPE := &p_1;
  V_PARENT REGIONS.PARENT_NAME%TYPE;
  CURSOR REG_CUR (p_child_name varchar2) IS 
    SELECT UPPER(CHILD_NAME) 
      FROM REGIONS
     where CHILD_NAME = p_child_name;

BEGIN
  OPEN REG_CUR (V_CHILD);
  FETCH reg_cur INTO V_CHILD;
  WHILE REG_CUR%FOUND LOOP
    DBMS_OUTPUT.PUT_LINE(V_CHILD);
    FETCH reg_cur INTO V_CHILD;
  END LOOP;
  CLOSE REG_CUR;
END; 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T20:12:34.243

如果您需要一个字符串，则需要在使用时将替换变量括在引号中：

```
 V_CHILD  REGIONS.CHILD_NAME%TYPE := '&p_1'; 
```

事实上，它试图将替换值解释为标识符，即另一个变量或列名。所以如果你输入`CHICAGO`它会看到：

```
 V_CHILD  REGIONS.CHILD_NAME%TYPE := CHICAGO; 
```

如果您输入`"CHICAGO"`：

```
 V_CHILD  REGIONS.CHILD_NAME%TYPE := "CHICAGO"; 
```

在 Oracle 中，使用双引号仍然表示标识符。实际上，您可以输入`'CHICAGO'`，在您的输入中加上引号，并且它会起作用 - 但必须记住这样做并不理想。

如果您`set verify on`在 SQL*Plus 或 SQL Developer 中，那么您可以看到每个替换的前后，这可以帮助识别这样的事情。

# java - 如何通过传递数据从另一个活动调用方法？

> ID：14665705
> 
> 赞同：0
> 
> 时间：2013-02-02T19:39:18.717
> 
> 标签：java, android, function, methods

我有 2 个活动。我开始一个，然后我开始另一个：

```
 Intent enabler = new Intent(this, cprompt.class);
        startActivity(enabler); 
```

我想从旧方法中调用一个方法，但我也想传递一些数据。

这就是我尝试的方式：

```
Activity1.sendcommand(DATA); 
```

我得到了这个：

```
Cannot make a static reference to the non-static method sendcommand(String) from the type Activity1 
```

而且我不想将方法更改为静态。如果我做一个听众的唯一方法？如果我必须，你可以为我描述如何？

java对我来说是新的......：/但是如果这个问题得到解决，我想我的程序已经完成了:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:49:03.343

一次只有一个活动处于活动状态。您是否只是因为要传递一些数据而尝试触发该方法？您可以通过`Intent`

```
Intent intent = new Intent(this, SecondActivity.class);
intent.putExtra("YOUR_DATA_KEY", "Data Value");
startActivity(intent); 
```

在 中`SecondActivity`，您可以检索数据并对其进行处理

```
String data = getIntent().getStringExtra("YOUR_DATA_KEY"); 
```

您可以通过这种方式发送的不仅仅是字符串。您甚至可以传输`Serializable`和`Parcelable`附加内容。有关更多信息，请参阅 - [Android 开发者网站上的 Intents](http://developer.android.com/reference/android/content/Intent.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:44:04.813

您可以声明一个`interface`并`Activity1` **实现**该接口..
然后当您需要调用Activity1的方法时调用inetrface的方法...

你的界面：

```
public interface OnSendCommand{
    public void onSendCommand(values);
} 
```

活动1：

```
public Activity1 implements OnSendCommand {
    public void onSendCommand(values){}
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T06:02:31.227

执行此方法时，您是否从第二个活动返回到第一个活动？如果是这样，您可以按照[本](http://developer.android.com/training/basics/intents/result.html)教程使用 startActivityForResult()。如果不是，那么如果这个方法不能是静态的，那么你的应用程序的结构就有问题，并且这个方法应该在一个单独的类中，而不是从 Activity 继承。

# hadoop - MapReduce 与 Hadoop：类型不匹配

> ID：14665711
> 
> 赞同：0
> 
> 时间：2013-02-02T19:39:50.437
> 
> 标签：hadoop, mapreduce

我正在运行一个简单的 hadoop 程序，但出现以下错误：

```
java.io.IOException: Type mismatch in key from map: expected org.apache.hadoop.io.Text, recieved org.apache.hadoop.io.LongWritable 
```

映射器：

```
public static class myMapper extends Mapper<LongWritable, Text, Text, Text>
public void map(LongWritable key, Text line,OutputCollector<Text,Text> output, Reporter reporter) throws IOException, InterruptedException 
```

减速器：

```
public static class triangleCounterReducer extends Reducer<Text, Text, Text, Text> 
public void reduce(Text key,Iterable<Text> line,OutputCollector<Text,Text> output,Reporter reporter) throws IOException, InterruptedException 
```

主要的：

```
...
job.setOutputKeyClass(Text.class);
job.setOutputValueClass(Text.class);
job.setMapOutputKeyClass(Text.class);
job.setMapOutputValueClass(Text.class);
... 
```

我怎样才能解决这个问题？？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:50:05.893

看起来您使用的是新的 API 类（您的 mapper 扩展了 mapred.Mapper），但您已经使用旧 API 编写了 map 方法（您使用的是 OutputCollector 和 Reporter）

将您的 mapper 映射签名和 reducer reduce 方法更改为以下内容：

```
public void map(LongWritable key, Text value, Context context) { .. }
public void reduce(Text key, Iterable<Text> value, Context context) { .. } 
```

`@Override`如果您在方法上方添加注释也会有所帮助，如果您有错误的签名，这将导致编译器失败。

# wpf - XAML 中的命名空间错误中不存在该名称

> ID：14665713
> 
> 赞同：148
> 
> 时间：2013-02-02T19:40:00.403
> 
> 标签：wpf, vb.net, xaml, visual-studio-2012

使用 VS2012 处理 VB.NET WPF 应用程序。我有一个用于学习 WPF 的简单 MusicPlayer 教程应用程序。我正在逐步将教程的 C# 版本转换为 VB.NET。

它在应用程序中有 2 个类，它们都在同一个命名空间下。我能够在 XAML 中引用命名空间，但是当我尝试在 XAML 中引用类对象时出现错误并且无法编译。

奇怪的是，IntelliSense 在通过 xmlns:c= 标记引用命名空间以及使用键入类对象时 `<c:` 都可以正常工作，但是该对象带有下划线，并且在尝试在设计器中构建或工作时会生成错误。

.vb 类文件位于名为 \Controls 的文件夹中。主项目根命名空间故意留空。这个类是这样编码的......

```
Namespace MusicPlayer.Controls
    Public Class UpdatingMediaElement
       .... code here
    End Public
End Namespace 
```

xaml 看起来像这样

`<Window >`（标签中定义的命名空间

```
xmlns:c="clr-namespace:MusicPlayer.Controls" 
```

（在 a 中定义的对象`<Grid>`）

```
 <c:UpdatingMediaElement Name="MyMediaElement" /> 
```

（显示错误）名称“UpdatingMediaElement”在命名空间“clr-namespace:MusicPlayer.Controls”中不存在。

不知道出了什么问题或如何解决？

* * *

## 回答 #1

> 赞同：267
> 
> 时间：2014-08-01T11:07:28.277

当您编写 wpf 代码时，VS 告诉您“名称 ABCDE 不存在于命名空间 clr-namespace:ABC 中”。但是您可以完全成功地构建您的项目，只有一点不便，因为您看不到 UI 设计（或者只是想清理代码）。

尝试执行以下操作：

*   在 VS 中，右键单击您的解决方案 -> 属性 -> 配置属性

*   打开一个新对话框，尝试将项目配置从 Debug 更改为 Release，反之亦然。

之后，重新构建您的解决方案。它可以解决你的问题。

* * *

## 回答 #2

> 赞同：54
> 
> 时间：2013-04-01T11:35:14.930

如果程序集与包含类的命名空间不同，则必须明确指定它。

前任：-

```
xmlns:Local="clr-namespace:MusicPlayer.Controls;assembly=MusicPlayer" 
```

* * *

## 回答 #3

> 赞同：38
> 
> 时间：2013-05-28T09:48:16.210

就我而言，这是因为**其他编译错误**。当其他错误得到解决时，这个看似相关的错误也从列表中删除。特别是错误列表底部和您最近更改的页面上的错误。

> 所以不要直接关注这个错误，先关注**其他错误**。

* * *

## 回答 #4

> 赞同：32
> 
> 时间：2016-03-03T18:44:54.017

通过清除 Xaml Design Shadow Cache，我已经看到这个问题消失了。我遇到了 Visual Studio 2015 Update 1 的问题。

在 Visual Studio 2015 中，缓存位于此处：

```
%localappdata%\Microsoft\VisualStudio\14.0\Designer\ShadowCache 
```

过程：

1.  右键单击解决方案资源管理器中的解决方案，然后选择“清洁解决方案”
2.  关闭 Visual Studio
3.  删除 ShadowCache 文件夹
4.  重新打开 Visual Studio 项目
5.  重建解决方案

瞧，不再有命名空间错误。

* * *

## 回答 #5

> 赞同：24
> 
> 时间：2014-12-26T22:00:44.477

尝试将构建目标平台更改为 x86 并构建项目。

我通过 Subversion 注意到我显然将项目构建平台目标更改为 x64。这是我所做的唯一改变。进行该更改后，代码运行了一段时间，然后开始显示您遇到的相同错误。我将平台目标更改为 x86 进行测试，突然我的设计师又开始工作了。后来我又改回x64，问题就彻底消失了。我怀疑设计者在 x32 中构建了某种缓存代码，并且在您更改代码时更改 x64 构建平台会破坏它。

* * *

## 回答 #6

> 赞同：8
> 
> 时间：2017-03-24T14:33:05.120

当项目编译但 XAML 错误显示时，也许是另一种解决方案：

1.  在解决方案探索中，在包含 xaml 的项目节点上
2.  右键单击项目并选择“卸载项目”
3.  右键单击项目并选择“重新加载项目”确保您的项目仍被选为“启动项目”。如果不 ：
4.  右键单击项目并选择“设置为启动项目”

**无需重建或关闭视觉工作室。**

* * *

## 回答 #7

> 赞同：8
> 
> 时间：2017-12-15T09:36:09.387

耶稣......五年后在 Visual Studio 2017 中这仍然是一个问题。由于我是 WPF 新手，我确信问题出在我身上，但不，一切都编译并正确运行。

我尝试重新构建、清理和重新构建、在 x86/x64 输出之间切换、重新启动 Windows、清理 ShadowCache 文件夹、在 XML 命名空间声明中添加“;assembly={my main assembly name}”，没有任何效果！做的一件事：

将我的静态命令类（在我的情况下，交易是关于让设计发现我的 WPF 命令）在其单独的程序集中，并将程序集名称更改为那个。

* * *

## 回答 #8

> 赞同：7
> 
> 时间：2016-03-14T18:12:30.190

不知道这是否对其他人有帮助

我是 WPF 的新手，并且仍然是 VB.net 的新手 - 所以我假设得到这个错误是由于我做峰会愚蠢造成的........假设我是真的！通过将我的项目从共享驱动器移动到我的本地驱动器之一，我设法摆脱了它。错误消失了，项目编译完美，没有其他问题 - 还没有。看起来 VS2015 在共享驱动器上的项目仍然存在问题。

* * *

## 回答 #9

> 赞同：3
> 
> 时间：2016-09-28T10:37:40.737

我最近在 .NET 4.6.2 中为我的 WPF 项目使用 VS 2015 Update 3 时遇到了这个问题。我的项目副本位于**网络文件夹**中，我将其移至本地并解决了问题。

这可能会解决其他类型的问题，因为看起来 VS 2015 不喜欢网络路径。另一个对他们来说是个大问题的问题是同步 git 存储库，如果我的项目位于网络路径中，也可以通过在本地移动它来解决。

* * *

## 回答 #10

> 赞同：2
> 
> 时间：2013-06-02T13:55:20.167

我遇到了同样的问题，在我的情况下，标记设计视图要求我重新构建解决方案，并且没有向我显示带有以下消息的表单布局： `Design view is unavailable for x64 and ARM target platforms`或`Build the Project to update Design view`。

它不能通过重建解决方案来解决（设计视图和“名称不存在于命名空间”错误中）

我认为这是因为我玩过解决方案 - > 属性 > 配置属性上的设置

我终于用 2 个工作解决了这个问题：

1.  选中页面构建列上的所有复选框：解决方案->属性->配置属性
2.  将解决方案配置从**调试**更改为**发布**，反之亦然。

我认为这是 Visual Studio2012 Update 2 中的错误。

* * *

## 回答 #11

> 赞同：2
> 
> 时间：2015-01-15T23:24:46.883

同样的问题困扰着 Visual Studios 2013 Service Pack 4。我还尝试了 Visual Studios 2015 Preview，结果相同。

这只是 Visual Studios 团队尚未修复的 WPF 可视化工具的一个限制。作为证明，在 x86 模式下构建会启用可视化工具，而在 x64 模式下构建会禁用它。

奇怪的是，智能感知适用于 Visual Studios 2013 Service Pack 4。

* * *

## 回答 #12

> 赞同：2
> 
> 时间：2017-06-02T19:07:45.883

我浏览了所有答案，但没有一个对我有帮助。终于能够自己解决了，所以提出答案，因为它可能会帮助别人。

就我而言，该解决方案有两个项目，一个包含模型（比如项目和程序集名称是**Models**），另一个包含视图和视图模型（按照我们的约定：项目、程序集名称和默认命名空间是**Models.Monitor**） . Models.Monitor 引用了 Models 项目。

在 Models.Monitor 项目中，我在其中一个 xaml 中包含了以下命名空间：xmlns:monitor="clr-namespace:Models.Monitor"

我怀疑***MsBuild 和 Visual Studio 然后在试图在程序集 'Models' 中找到 'Monitor' 类型时出错***。为了解决我尝试了以下方法：

1.  xmlns:monitor="clr-namespace:Models.Monitor;assembly=" - 如果命名空间与[https://msdn.microsoft.com/en-us/library/ms747086(v=vs ) 位于同一程序集中，则此选项有效.110).aspx](https://msdn.microsoft.com/en-us/library/ms747086(v=vs.110).aspx)
2.  还尝试了显式命名空间声明： xmlns:monitor="clr-namespace:Models.Monitor;assembly=Models.Monitor"

以上都不起作用。

最后我放弃了，作为解决方法，**将我试图使用的 UserControl 移到另一个命名空间： 'ModelsMonitor'**。在那之后我能够很好地编译。

* * *

## 回答 #13

> 赞同：2
> 
> 时间：2018-11-26T12:10:36.757

我也遇到了很多麻烦这个！Intellisense 帮助我完成命名空间和一切，但编译器哭了。我已经尝试了在此线程和其他线程中找到的所有内容。但是在我的情况下，最终有帮助的是写这样的东西：

```
xmlns:util="clr-namespace:LiveSpielTool.Utils;assembly=" 
```

将程序集名称留空。不知道为什么。但是这里提到了。我必须补充说我正在开发一个程序集，所以程序集属性可能有意义。但是输入程序集名称不起作用。太奇怪了。

* * *

## 回答 #14

> 赞同：2
> 
> 时间：2019-04-30T20:30:04.147

在我的情况下，问题是由于项目的 obj 目录下的一些幻像文件。以下为我解决了这个问题：

*   清洁项目
*   退出VS
*   rm -rf /obj/*
*   调用VS并重建

* * *

## 回答 #15

> 赞同：1
> 
> 时间：2016-07-22T07:44:42.120

尝试验证您的程序集引用。如果您在项目引用上有一个黄色感叹号，那么那里就有问题，您会遇到各种错误。

如果您知道项目引用是正确的，请检查 Target 框架。例如，让使用 4.5 框架的项目引用具有 4.5.2 框架的项目并不是一个好的组合。

* * *

## 回答 #16

> 赞同：1
> 
> 时间：2016-07-25T23:40:41.093

看起来这个问题可以通过各种“技巧”来解决。

就我而言，我一直在构建/重建/清理整个解决方案，而不仅仅是我在解决方案中从事的项目。一旦我单击“构建 [我的项目]”，错误消息就会消失。

* * *

## 回答 #17

> 赞同：1
> 
> 时间：2017-02-21T15:15:44.723

我的解决方案是解除对程序集 DLL 的阻止。您收到的错误消息并未表明这一点，但 XAML 设计器拒绝加载它所谓的“沙盒”程序集。您可以在构建时在输出窗口中看到这一点。如果从 Internet 下载 DLL，则它们会被阻止。要取消阻止您的第 3 方程序集 DLL：

1.  在 Windows 资源管理器中右键单击 DLL 文件并选择属性。
2.  在“常规”选项卡的底部，单击“取消阻止”按钮或复选框。

**注意：只有在您确定 DLL 安全的情况下才能解除对它们的阻止。**

* * *

## 回答 #18

> 赞同：1
> 
> 时间：2017-04-03T15:59:30.150

在我的例子中，用户控件被添加到主项目中。我尝试了上述各种解决方案均无济于事。要么我会得到 Invalid Markup 但解决方案会编译并工作，要么我会添加 xmlns:c="clr-namespace:MyProject;assembly=MyProject" 然后标记会显示，但我会得到一个编译错误XML 命名空间中不存在标记。

最后，我在解决方案中添加了一个新的 WPF 用户控件库项目，并将我的用户控件从主项目移到了那个项目中。添加了引用并将程序集更改为指向新库，最后标记工作并且项目编译没有错误。

* * *

## 回答 #19

> 赞同：1
> 
> 时间：2018-10-10T18:06:15.177

在我的例子中，我的命名空间和类的拼写完全相同，例如，我的命名空间之一是

```
firstDepth.secondDepth.Fubar 
```

其中包含自己的类（例如 firstDepth.secondDepth.Fubar.someclass）

但我在命名空间中也有一个“ **Fubar** ”类

```
firstDepth.secondDepth 
```

它在文本上解析为与上面的 Fubar 命名空间相同。

不要这样做

* * *

## 回答 #20

> 赞同：1
> 
> 时间：2018-12-14T00:21:02.163

如果您引用的程序集实际上并未构建，也可能会导致此问题。例如，如果您的 xaml 在 Assembly1 中，并且您也在 Assembly1 中引用一个类，但该程序集有错误并且未构建，则会显示此错误。

我对此感到很傻，但在我的情况下，我在用户控制下撕裂了，结果在相关类中出现了各种错误。当我试图修复它们时，我从有问题的错误开始，没有意识到 xaml 依赖于构建的程序集来查找这些引用（不像 c#/vb 代码甚至可以在构建之前解决它）。

* * *

## 回答 #21

> 赞同：1
> 
> 时间：2019-03-12T16:53:31.767

我一直遇到这个问题。我的视图位于 WPF 自定义控件库项目（类库的变体）中。我可以引用预构建的程序集，但不能引用同一解决方案的另一个项目中的任何代码。一旦我将代码移动到与 xaml 相同的项目，它就会被识别。

* * *

## 回答 #22

> 赞同：1
> 
> 时间：2020-07-06T16:18:18.933

如果没有一个答案有效

对我来说，我正在使用的 .Net Framework 版本兼容性问题比引用的要旧

> 从属性 => 应用程序然后目标框架

* * *

## 回答 #23

> 赞同：0
> 
> 时间：2013-09-30T14:57:08.920

VB.NET 不会像在 C# 中那样根据文件夹结构自动添加命名空间信息。我想我正在经历与您相同的教程（在 24 小时内自学 WPF），并对 VB 进行相同的转换。

我发现您必须手动将命名空间信息添加到XAML 类和后面的**XAML.VB**代码中，才能使用书中描述的命名空间。即使这样，VB 也不会像在 VB 中那样自动将命名空间分配给程序集。

这里有另一篇文章展示了如何将其包含在您的项目模板中，以便它自动构建命名空间信息 - [添加新项目时自动添加命名空间](https://stackoverflow.com/questions/3317141/automatically-add-namespace-when-adding-new-item)

* * *

## 回答 #24

> 赞同：0
> 
> 时间：2014-09-14T21:56:26.337

在解决方案属性页中，检查包含“UpdatingMediaElement”的程序集的平台以及包含“UpdatingMediaElement”子类或实现的任何超类和接口的程序集。看来所有这些程序集的平台必须是“AnyCPU”。

* * *

## 回答 #25

> 赞同：0
> 
> 时间：2016-02-15T20:12:37.790

另一个可能的原因：构建后事件正在从构建文件夹中删除项目 DLL。

澄清一下：WPF 设计器可能会报告“名称 XXX 不存在于名称空间中......”，即使名称确实存在于名称空间中，并且*如果*构建后事件从构建文件夹（bin\Debug、bin\Release 等）。我在 Visual Studio 2015 中对此有个人经验。

* * *

## 回答 #26

> 赞同：0
> 
> 时间：2016-07-28T18:46:48.470

好的，不幸的是，这些技巧都不适合我。我最终能够解决这个问题。似乎 Visual Studio 不能很好地与网络驱动器配合使用。我通过将项目从共享驱动器移动到我的本地并重新编译来解决了这个问题。没有更多的错误。

* * *

## 回答 #27

> 赞同：0
> 
> 时间：2017-03-01T18:10:25.593

添加到堆中。

我的 WPF 应用程序的程序集名称与引用的 dll 的程序集名称相同。因此，请确保您的任何项目中都没有重复的程序集名称。

* * *

## 回答 #28

> 赞同：0
> 
> 时间：2017-05-10T22:05:17.870

我将解决方案存储在网络共享上，每次打开它都会收到有关不受信任来源的警告。我将它移动到本地驱动器，“命名空间不存在”错误也消失了。

* * *

## 回答 #29

> 赞同：0
> 
> 时间：2018-02-16T12:40:54.960

还尝试右键单击您的项目-> 属性并将平台目标更改为任何 CPU 并重建，然后它将工作。这对我有用

* * *

## 回答 #30

> 赞同：0
> 
> 时间：2019-01-25T21:08:37.913

我将程序集添加为项目-首先删除了专门添加到对dll的引用的ddl-这样做了。

* * *

## 回答 #31

> 赞同：0
> 
> 时间：2019-05-09T08:10:55.220

就我而言，当 wpf 程序的体系结构与依赖关系不完全相同时，就会发生此问题。假设您有一个依赖项是 x64，另一个是 AnyCPU。那么如果选择x64，AnyCPU dll中的类型会“不存在”，否则x64 dll中的类型会“不存在”。你只是不能模仿他们两个。

* * *

## 回答 #32

> 赞同：0
> 
> 时间：2019-08-23T18:10:55.427

这个线程中的两个想法的组合对我有用，所以我将发布我所做的事情，希望在接下来的 5 年内它可以帮助其他人解决这个问题。我正在使用 VS2017 社区）

1.  删除对dll的引用
2.  清洁、重建、建造
3.  关闭 VS，解除对 dll 的阻塞*（见下面的注释）*，删除影子缓存
4.  打开 VS，清理，重建，构建
5.  恢复对 dll 的引用
6.  清洁、重建、建造

在第 2、4 和 6 步中，我可能没有完全正确的顺序，但在解决这个问题将近 2 小时后，我抓住了稻草。我认为对我来说关键是删除引用、解锁 dll 和删除影子缓存的组合。

*（第 3 步的注意事项 - 我正在使用的 dll 是由我的同事/导师编写的，所以我知道它是安全的。如果您不知道 dll 的来源，请谨慎执行此步骤）*

我将在此线程上添加书签以供后代使用，因为 MS 似乎不想清理这些东西。WPF 很难自学，当你做对了所有事情时，不得不破解这样的东西是令人愤怒的。

* * *

## 回答 #33

> 赞同：0
> 
> 时间：2019-12-14T11:17:41.770

正如另一个人发布的那样，这可能是由于将项目保存在网络共享上造成的。我发现如果我从使用网络路径切换到映射网络驱动器，一切正常。

**来自：** “\\SERVER\Programming\SolutionFolder”

**至：** “Z:\Programming\SolutionFolder” *（精确映射可选）*

* * *

## 回答 #34

> 赞同：0
> 
> 时间：2020-03-12T13:11:42.260

尝试检查该部分，并查看您包含的库参考是否`References`有*警告图标：*

[![在此处输入图像描述](../Images/564dd17253992efbf6fac08ed3eb9950.png)](https://i.stack.imgur.com/VRKWb.png)

如果您看到它，请转到*项目 -> 属性 -> 应用程序*并确保两个库都针对相同版本的`.NET framework`.

PS 发生此问题时，也可以从以下`Warnings`部分注意到：

[![在此处输入图像描述](../Images/609f378b18a07113fa8c6652d4da88a2.png)](https://i.stack.imgur.com/SWhQK.png)

* * *

## 回答 #35

> 赞同：0
> 
> 时间：2020-05-08T09:58:56.370

在 Visual Studio 2019 中，我能够按照其他答案中的建议将下拉列表更改为 Release 来修复它。但是当我改回调试模式时，错误再次出现。

在调试模式下为我修复了什么：

1.  切换到发布模式
2.  在 XAML 设计器中单击“禁用项目代码”

[![XAML 编辑器：禁用项目代码](../Images/0a7f898e9c7dfa29964bc298157ea901.png)](https://i.stack.imgur.com/Ahln1.png)

3.  切换回调试模式 => 错误消失了

* * *

## 回答 #36

> 赞同：0
> 
> 时间：2020-06-17T19:43:10.603

在一个复杂的 WPF 应用程序中，这种情况已经发生过两次，其中有 4 个多平台项目、1 个共享项目、2 个支持库和 1 个测试项目。

这个非常具体的 XAML 命名空间错误在共享项目上最近修改的文件上发生了两次。在我的两种情况下，它都是一个添加了重复命名空间条目的新 c# 文件；

像**命名空间 MyProgram.MyFolder.MyProgram.MyFolder**

我错误地重复粘贴了一次，有一次是由于 JetBrains Rider 重复粘贴了命名空间。（如果您曾在 Rider 中重命名项目，有时会在新文件创建时开始双重粘贴命名空间，尤其是在共享项目中。）。然后在 XAML 文件引用的 ViewModel 中调用这些具有重复命名空间的 c# 文件。那么你会得到这些不相关和误导性的错误，你可能会遇到一个文件的问题，你所有的 Xaml 文件最终都会开始出错。

无论如何，如果您遇到此类错误，则大多数情况下是新添加的文件或代码更改的问题。我的建议是查看您最近的更改。

* * *

## 回答 #37

> 赞同：0
> 
> 时间：2021-12-12T18:18:08.787

再转一转，希望其他人可能会发现它有帮助。我和这里的其他人有同样的问题，我尝试了所有的建议——验证参考、调试/发布开关、重新启动 VS、检查构建配置级别、多次重建——但没有任何帮助。最后，我尝试了创建一个新项目并将我试图解决的单个对象移动到该项目的建议，这解决了参考问题。
然而——这就是我在这里添加另一篇文章的原因——最终我发现实际问题是原始项目包含一个引用 SQLite 数据库的对象。事实证明，安装的 NuGet SQLite 包实际上是导致问题的原因。当我将 DB 访问代码和 NuGet SQLite 引用移至其自己的项目时，我能够将原始对象与所有其他对象一起移回原始项目，并且引用问题没有再次出现。显然 NuGet SQLite 包中的某些设置使系统感到困惑。

* * *

## 回答 #38

> 赞同：-1
> 
> 时间：2017-10-05T20:48:29.157

为您的视图模型添加一个空的构造函数并重建解决方案。

* * *

## 回答 #39

> 赞同：-1
> 
> 时间：2019-06-24T02:52:58.203

*   就***我***而言，问题是 Visual Studio 中的一个错误 - 因为该错误没有任何意义，当我重建时 - 一切都神奇地起作用了！经过 45 分钟的挫折后，这个解决方案使我的头部和显示器​​免于严重受伤。也许它也可以拯救你——它当然值得一试？

# 解决方案：尝试重新构建解决方案

*   重建快捷方式：CTRL + SHIFT + B

[![只需重建，它应该可以工作！](../Images/366f8973977d1e61a898284dc9300438.png)](https://i.stack.imgur.com/Qs3sx.gif)

# 解决方案 2：尝试重新启动 Visual Studio

* * *

## 回答 #40

> 赞同：-1
> 
> 时间：2019-12-18T15:02:26.317

我有相同的症状“名称空间错误中不存在名称”，但原因却不同。我遇到了 C: 驱动器崩溃，不得不重新安装 Visual Studio 2017。我恢复了源代码文件并打开了解决方案。建造它。没有骰子。除了“名称在命名空间中不存在”错误，我还注意到我的子项目抱怨他们找不到 MyProject.cs 文件（'MyProject' 不是实际的项目名称，只是在这里用作示例） . 我一直在寻找 MyProject.cs 的去向，然后才想起从来没有这样的文件！我查看了每个子项目的 Properties 文件夹，发现 Visual Studio 自己添加了对 MyProject.cs 的虚假引用！我删除了这些引用，现在解决方案像以前一样构建得很好。

# jscrollpane - JScrollPane 中的 JTextArea

> ID：14665714
> 
> 赞同：0
> 
> 时间：2013-02-02T19:40:03.200
> 
> 标签：jscrollpane, jtextarea

我想让 JTextArea 可滚动...
我尝试了以下代码..但不明白为什么它不起作用...请帮助！

```
jacontactsDeatil = new JTextArea();  
jspn = new JScrollPane();  
jspn.setLayout(null);  
jspn.setBounds(10, 170, 950, 300);
jspn.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_ALWAYS);  
    jspn.isWheelScrollingEnabled();  
    jspn.setVisible(true);  
    jspn.setAutoscrolls(true);  
    jspn.setEnabled(true);

    jspn.setBackground(Color.orange);  
    jspn.add(jacontactsDetail);
    jspn.repaint();
    jacontactsDetail.setBounds(0,0,jspn.getWidth(),jspn.getHeight()); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T21:57:42.233

一种选择是将 JTextArea 和 JScrollPane 与 GroupLayout 一起使用。

```
jTextArea1.setColumns(20);
jTextArea1.setRows(5);
jScrollPane1.setViewportView(jTextArea1);

javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
jPanel1.setLayout(jPanel1Layout);
jPanel1Layout.setHorizontalGroup(jPanel1Layout.createSequentialGroup().
    addComponent(jScrollPane1,
    javax.swing.GroupLayout.PREFERRED_SIZE, 328,
    javax.swing.GroupLayout.PREFERRED_SIZE)
);
jPanel1Layout.setVerticalGroup(jPanel1Layout.createSequentialGroup().
    addComponent(jScrollPane1,
    javax.swing.GroupLayout.PREFERRED_SIZE, 79,
    javax.swing.GroupLayout.PREFERRED_SIZE)
); 
```

# visual-studio-2012 - VS2012项目在bin文件夹中找不到Typescript项目的输出dll

> ID：14665718
> 
> 赞同：0
> 
> 时间：2013-02-02T19:40:16.410
> 
> 标签：visual-studio-2012, typescript

我正在用 TypeScript 编写游戏，刚刚升级到 TS 0.8.2，现在 VS 2012 web express 抱怨这样的错误：

> 该系统找不到指定的路径。游戏 -> C:\Users\me\pr\game.dll

我可以确认该文件存在于文件系统中

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:42:32.627

它最有可能找不到的文件实际上是......

> c:\Program Files\Microsoft SDKs\TypeScript\0.8.1.1\tsc

现在可能在下面找到

> c:\Program Files\Microsoft SDKs\TypeScript\tsc

因为他们删除了 0.8.2.0 中的版本文件夹，以使我们免于在项目文件中不断更新此路径！

错误消息可能具有误导性 - 因此请检查此路径。

如果您使用的是 64 位版本的 Windows，请查看 in`Program Files (x86)`而不是普通的`Program Files`.

# git - 解决方法 git commit

> ID：14665724
> 
> 赞同：1
> 
> 时间：2013-02-02T19:40:52.593
> 
> 标签：git, merge, commit, ignore

假设我有 3 个 git 提交：

1.  在侧边栏提交更改
2.  在页脚提交更改
3.  提交对标头的更改

现在让我们假设我已经经历了精神觉醒并意识到我需要的唯一更改是在页眉和侧边栏上，页脚很好，不需要更改。

**有没有可以执行以下操作的命令？**：

*   合并提交#3 减去提交#2
*   删除提交#2
*   合并提交#3 加上提交#1

（或任何其他使 commit#2 从未发生过的方法）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:52:44.553

交互式 rebase 允许您修改、重新排列、合并提交、更改消息等：

```
git rebase --interactive 
```

引用帮助：

```
# Commands:
#  p, pick = use commit
#  r, reword = use commit, but edit the commit message
#  e, edit = use commit, but stop for amending
#  s, squash = use commit, but meld into previous commit
#  f, fixup = like "squash", but discard this commit's log message
#  x, exec = run command (the rest of the line) using shell
#
# If you remove a line here THAT COMMIT WILL BE LOST.
# However, if you remove everything, the rebase will be aborted.
# 
```

丢失提交是您想要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:43:51.940

您始终可以使用[`git-revert`](http://git-scm.com/docs/git-revert).

> 给定一个或多个现有提交，还原相关补丁引入的更改，并记录一些记录它们的新提交。这要求您的工作树是干净的（不修改 HEAD 提交）。
> 
> 注意：`git revert`用于记录一些新的提交，以扭转一些早期提交的效果（通常只是一个错误的提交）。如果您想丢弃工作目录中所有未提交的更改，您应该看到[git-reset(1)](http://git-scm.com/docs/git-reset.html)，尤其是该`--hard`选项。如果您想像在另一个提交中一样提取特定文件，您应该看到[git-checkout(1)](http://git-scm.com/docs/git-checkout.html)，特别是`git checkout <commit> -- <filename> syntax`. 请注意这些替代方案，因为它们都会丢弃工作目录中未提交的更改。

所以：

```
git revert <commit-id-of-footer-changes> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:58:39.383

您可以使用`cherry-pick`合并您想要的提交，然后`revert`在页脚更改之前提交开发分支。

```
git checkout branch_to_merge_into
git cherry-pick commit#1 commit#3 
```

# php - Symfony2安全@Secure注释不起作用

> ID：14665725
> 
> 赞同：3
> 
> 时间：2013-02-02T19:40:57.867
> 
> 标签：php, security, symfony

我正在尝试使用注释来保护我的控制器：

```
namespace Vinny\StreamBundle\Controller;

use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use JMS\SecurityExtraBundle\Annotation\Secure;
use Sensio\Bundle\FrameworkExtraBundle\Configuration\Route;

class HomeController extends Controller
{

    /**
     * @Route("/home", name="home") 
     * @Secure(roles="ROLE_USER")
     */
    public function indexAction()
    {
     ... 
```

但我似乎无法让我的控制器真正得到保护。是否有任何情况会被忽略？

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-02-03T16:10:04.047

在一个几乎完全不相关的注释中，我的问题不是源于我的配置或控制器中的任何东西，而是从 Symfony 2.0 切换到 Symfony 2.1 的迁移混淆。我未能注册 JMSDiExtraBundle，它默默地破坏了 JMSSecurityExtraBundle 的（和其他人的）注释。

在我的 AppKernel.php 中，我错过了：

```
public function registerBundles()
{
    $bundles = array(
    ...
    new JMS\DiExtraBundle\JMSDiExtraBundle($this),
    ... 
```

这样一切正常，再次。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-03T00:22:23.313

您需要尝试使用`ROLE_ADMIN`or `ROLE_SUPER`，然后查看其是否安全。 `ROLE_USER`是应用于所有用户的默认角色，所以你被允许

```
@Secure(roles="ROLE_SUPER") 
```

# silverlight-5.0 - SL5 浏览器外应用，控制包含窗口

> ID：14665728
> 
> 赞同：0
> 
> 时间：2013-02-02T19:41:26.347
> 
> 标签：silverlight-5.0, out-of-browser

在 SL5 中，您可以创建多个窗口。此包允许您以模态方式使用窗口，而不受父窗口的约束： http: [//slmultiwindow.codeplex.com/](http://slmultiwindow.codeplex.com/)

有什么方法可以控制包含窗口的背景或不透明度？我想为模态窗口的外观和消失设置动画；虽然我可以通过情节提要控制窗口内容，但包含窗口的白色背景有点破坏效果......

对于如何控制包含窗口的外观的任何想法都将不胜感激......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-08T05:48:14.553

我认为你应该尝试这种方式............

1\. 单击 Sliverlight 项目

2\. 选择属性选项

3\. 选择第一个选项卡选项，例如 Silverlight

4\. 单击浏览器外设置选项

5\. 设置窗口大小、窗口标题或窗口位置等......

# android - HttpTransportSE 的默认超时时间是多少？

> ID：14665729
> 
> 赞同：1
> 
> 时间：2013-02-02T19:41:29.433
> 
> 标签：android

我使用[http://code.google.com/p/ksoap2-android/](http://code.google.com/p/ksoap2-android/)库，我想知道 HttpTransportSE 的默认超时时间是多少？当启动它时

```
HttpTransportSE aht = new HttpTransportSE(WebServiceURL); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-18T19:50:32.840

记录一下：根据[GitHub 源文件 ServiceConnection (line34)](https://github.com/mosabua/ksoap2-android/blob/master/ksoap2-base/src/main/java/org/ksoap2/transport/ServiceConnection.java#L34)，Transport 类（HttpTransport 和 HttpTransportSE 的基类）中使用的默认超时为 20 秒。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T21:14:02.427

从代码的[提示部分](http://code.google.com/p/ksoap2-android/wiki/CodingTipsAndTricks)，您可以通过向您调用的方法添加更多参数来设置自己的超时时间

```
 HttpsTransportSE transport = new HttpsTransportSE(host, port, file, timeout); 
```

超时是一个int。

# android - 基于上次 GPS 位置和传感器的短期坐标

> ID：14665738
> 
> 赞同：0
> 
> 时间：2013-02-02T19:42:25.173
> 
> 标签：android, geolocation, gps

我正在开发一个应用程序，我需要每隔几秒钟进行一次（GPS）坐标，不幸的是 GPS 会消耗大量电池。

是否有可能根据 Android 智能手机的最后 GPS 位置和运动传感器（例如 1 分钟）获得良好的估计位置（包括高度）？我需要研究哪些算法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:42:27.007

这不适用于 GPS。
GPS芯片必须始终跟踪卫星，因此如果您每分钟一次或每秒一次，对电池消耗没有影响。
当您每 5 分钟只需要一个位置时，情况就会发生变化，那么停止定位服务并重新启动可能是有意义的。（但即使这只是一个模糊的估计）。
最后，您必须测量哪个间隔真正节省电池。

顺便说一句：我可以在 iPhone 4 上以每秒一次的方式记录 8 小时的 GPS

# python - Django 表单错误未显示

> ID：14665743
> 
> 赞同：0
> 
> 时间：2013-02-02T19:42:46.493
> 
> 标签：python, django

我已经在 stackoverflow 和 Internet 上查看过这个问题，所以我将只展示我的代码。

*视图.py*

```
def UserSell(request,username):

theuser=User.objects.get(username=username)
thegigform=GigForm()
#if the user is submitting a form
if request.method=='POST':
    #bind form with form inputs and image
    gigform=GigForm(request.POST,request.FILES)
    if gigform.is_valid():
        gigform.title=gigform.cleaned_data['title']
        gigform.description=gigform.cleaned_data['description']
        gigform.more_info=gigform.cleaned_data['more_info']
        gigform.time_for_completion=gigform.cleaned_data['time_for_completion']
        gigform.gig_image=gigform.cleaned_data['gig_image']
        finalgigform=gigform.save(commit=False)
        finalgigform.from_user=theuser
        finalgigform.save()
        return HttpResponseRedirect('done')
thegigform=GigForm()
context=RequestContext(request)
return render_to_response('sell.html',{'theuser':theuser,'thegigform':thegigform},context_instance=context) 
```

*模板*

```
<form action="{% url sell user.username %}" method="post" enctype="multipart/form-data">
{% csrf_token %}
<fieldset>
    <legend><h2>Sell A Gig</h2></legend>
    {% for f in thegigform %}
    <div class="formWrapper">
        {{f.errors}}
        {{f.label_tag}}: {{f}}
        {{f.help_text}}
    </div>
    {% endfor %}
</fieldset>
<input type="submit" value="Sell Now!" /> 
```

这段代码似乎遵循正常的 django 表单协议，所以请告诉我为什么我的 django 模板没有显示错误。谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T19:54:09.657

看起来您缺少一个 else 块。

如果 gigform.valid() 返回 false，您将覆盖变量“thegigform”。尝试像这样重组您的代码：

```
if request.method=='POST':
    #bind form with form inputs and image
    thegigform=GigForm(request.POST,request.FILES)
    if thegigform.is_valid():
        thegigform.title=gigform.cleaned_data['title']
        thegigform.description=gigform.cleaned_data['description']
        thegigform.more_info=gigform.cleaned_data['more_info']
        thegigform.time_for_completion=gigform.cleaned_data['time_for_completion']
        thegigform.gig_image=gigform.cleaned_data['gig_image']
        finalgigform=gigform.save(commit=False)
        finalgigform.from_user=theuser
        finalgigform.save()
        return HttpResponseRedirect('done')
else:
    thegigform=GigForm()
context=RequestContext(request)
return render_to_response('sell.html',{'theuser':theuser,'thegigform':thegigform},context_instance=context) 
```

# php - 我如何知道 socketIO 是否会比长轮询提供任何好处？

> ID：14665746
> 
> 赞同：2
> 
> 时间：2013-02-02T19:43:14.113
> 
> 标签：php, performance, socket.io, scalability, long-polling

我最近继承了一个使用 CodeIgniter 框架的 PHP 应用程序——它完美地处理了身份验证、用户会话、CRUD 操作、路由、模板以及应用程序的几乎所有方面。但是，一项功能需要使用长轮询。某些管理员需要对其他用户的操作进行近乎实时的更新。现在几百个用户一切正常，但我们正在扩大以支持几千个用户，我担心长轮询会导致一些性能问题。

以下是长轮询过程的基础知识：

1.  浏览器发出一个启动长轮询过程的 GET 请求。

2.  长轮询过程每 1/4 秒检查一次 txt 文件的时间戳。

3.  a) 如果更新了 txt 文件，长轮询过程将更改返回给浏览器并更新视图。

    b) 如果 25 秒内没有发现变化，则长轮询结束并返回 null。

4.  重复步骤 1。

这个过程发生在 codeigniter 框架之外。我认为用 socket.io 实现替换这个过程是个好主意。

socket.io 会比长轮询更好吗？如果是这样，在没有实际构建演示和进行负载测试的情况下，我有什么令人信服的证据？在我看来，这似乎是一个好主意，但我需要证明做出转换的时间和精力是合理的。

另外，很抱歉，如果这没有意义，或者按照 SO 标准“不是一个真正的问题”。我对后端可扩展性还很陌生，而且大部分这些东西对我来说都是全新的。请在否决之前提供有用的指导以重新措辞（如果需要）。谢谢。

编辑：这里的首选是保持原样，因为撕掉代码并用新东西替换它的成本很高，尤其是当新东西未经测试时。所以我想我的问题是，当/如果长轮询解决方案碰壁时，socket.io 会是一个可行的替代品吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:24:55.007

我认为 websockets 比长轮询更好，轮询主要是因为您的应用程序规模有不必要的网络吞吐量开销。检查这两个链接：

*   [http://www.websocket.org/quantum.html](http://www.websocket.org/quantum.html)
*   [http://dsheiko.com/weblog/websockets-vs-sse-vs-long-polling](http://dsheiko.com/weblog/websockets-vs-sse-vs-long-polling)

# r - 总结中的 p 值与 R lm() 中的方差分析之间的差异

> ID：14665748
> 
> 赞同：4
> 
> 时间：2013-02-02T19:43:28.100
> 
> 标签：r, lm

根据我访问它的方式，我看到 anova 的 p 值存在差异。

有没有办法获得与摘要返回的值相同的值？

一个易于表示的案例在摘要和方差分析中返回 < 2.2e-16，但当我直接访问该值时给我 8.129959e-100：

```
x <- lm(formula = eruptions ~ waiting, data = faithful)
summary(x)
anova(x)
anova(x)$"Pr(>F)"[1] 
```

在另一个更难以表示的情况下（有更多数据）我得到 p-value: < 2.2e-16 in the summary but 0 from anova.

有什么方法可以获取摘要和方差分析中返回的实际值？

我非常感谢您的帮助-

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T20:02:46.627

你必须深入研究`stats:::print.summary.lm`。该值不存储在`summary.lm`对象中，它是根据`fstatistic`对象的组件动态计算的。

```
s <- summary(x)$fstatistic
(p <- pf(s["value"], s["numdf"], s["dendf"], lower.tail = FALSE))
##         value 
## 8.129959e-100 
```

`anova()`...并且它与...产生的值相同

...正如@Dason 在下面指出的那样，您可以使用`format.pval()`它来恢复显示格式`summary()`：

```
format.pval(p)
## [1] "< 2.22e-16" 
```

除了自己破解之外，我看不到任何方法`print.summary.lm`来覆盖其中的`format.pval()`调用以在摘要中打印出完整的 p 值。

# android - 来自 InputStream 的 URI

> ID：14665754
> 
> 赞同：3
> 
> 时间：2013-02-02T19:44:01.460
> 
> 标签：android

是否可以从 InputStream 获取 URI？

如果它是 FileInputStream 我可以从它的路径创建一个 URI。但如果它只是一个 InputStream，还是一个 PipedInputStream？

# python - Networkx 特定节点标记

> ID：14665767
> 
> 赞同：20
> 
> 时间：2013-02-02T19:45:22.390
> 
> 标签：python, networkx

我想绘制一个网络，并且我希望它没有标记，除了 cretin 节点。

我现在拥有的是这样的：

```
nx.draw(G, pos=pos, node_color='b', node_size=8, with_labels=False)

for hub in hubs:
     nx.draw_networkx_nodes(G, pos, nodelist=[hub[0]], node_color='r') 
```

目前的代码更改了集线器列表中节点的大小和颜色。我也想给它们贴上标签。

我尝试添加标签参数并将其值设置为集线器名称。但它没有用。

谢谢

* * *

## 回答 #1

> 赞同：39
> 
> 时间：2013-02-02T23:08:48.720

根据 Bula 的评论，解决方案非常简单

诀窍是在字典中设置标签，其中键是节点名称，值是您需要的标签。因此，要仅标记集线器，代码将类似于以下内容：

```
labels = {}    
for node in G.nodes():
    if node in hubs:
        #set the node name as the key and the label as its value 
        labels[node] = node
#set the argument 'with labels' to False so you have unlabeled graph
nx.draw(G, with_labels=False)
#Now only add labels to the nodes you require (the hubs in my case)
nx.draw_networkx_labels(G,pos,labels,font_size=16,font_color='r') 
```

我得到了我想要的，如下： ![在此处输入图像描述](../Images/8073bf0b262d65842906e228ffdb06f8.png)

我希望这会帮助像我这样的其他 python/networkx 新手:)

再次感谢布拉

# android - 以下Android拖放示例，错误“btn_default_pressed无法解析或不是字段”

> ID：14665768
> 
> 赞同：0
> 
> 时间：2013-02-02T19:45:48.700
> 
> 标签：android, android-layout, android-widget, android-listview, android-ui

在 min API 15 中工作，我试图找到如何将一个项目元素从 ListView 列表拖放到其上方的 TextView 上（只是将文本复制到其中）。

我正在尝试遵循此示例：

[http://techdroid.kbeanie.com/2011/10/drag-and-drop-honeycombics.html](http://techdroid.kbeanie.com/2011/10/drag-and-drop-honeycombics.html)

即这两部分...

[http://code.google.com/p/myandroidwidgets/source/browse/trunk/HCDragDrop/src/com/beanie/hcsample/dragdrop/MyDragShadowBuilder.java](http://code.google.com/p/myandroidwidgets/source/browse/trunk/HCDragDrop/src/com/beanie/hcsample/dragdrop/MyDragShadowBuilder.java)

[http://code.google.com/p/myandroidwidgets/source/browse/trunk/HCDragDrop/src/com/beanie/hcsample/dragdrop/HCDragDropActivity.java](http://code.google.com/p/myandroidwidgets/source/browse/trunk/HCDragDrop/src/com/beanie/hcsample/dragdrop/HCDragDropActivity.java)

但是，我不知道如何解决此错误

```
The import android.view.View.DragShadowBuilder cannot be resolved 
```

或者如果我删除导入然后 DragShadowBuilder 给我

```
DragShadowBuilder cannot be resolved to a type 
```

我将我的 minSDK 和目标 SDK 都更改为“15”。我现在不应该访问这些课程吗？如何解决此错误？

编辑：我已经解决了这个问题-属性，android，设置目标。清洁，刷新。行。

但现在我得到

```
btn_default_pressed cannot be resolved or is not a field 
```

在 mShadow = v.getResources().getDrawable(R.drawable.btn_default_pressed);

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:04:31.377

看起来那个类是在 API 11 中出现的。所以可能你有几个问题之一。

1.  您已在清单中设置了 SDK 目标，但尚未更新实际的 SDK。如果是这种情况，请转到 SDK 管理器并获取必要的更新。

2.  您的项目仍链接到 API 10 或更低版本的 jar。如果是这种情况，请进入 Project > Properties > Android 并选择正确的库。

Project > Clean 并重新启动 Eclipse 也无妨。

# ios - 自动布局问题 iOS 6

> ID：14665769
> 
> 赞同：0
> 
> 时间：2013-02-02T19:45:58.673
> 
> 标签：ios, objective-c, xcode, constraints, autolayout

新手问题。

我将 UIScrollView 作为子视图添加到 Interface Builder 的主视图中，然后我在 UIScrollView 上方添加了 UILabel。在横向模式下，标签滚动良好（标签的高度超过 scrollView 高度），但在纵向上它不能滚动。我意识到我需要删除一些 scrollView 自动布局约束，但它们都在实用程序中处于非活动状态的删除选项 - >尺寸检查员。我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-20T07:22:51.847

你说 ：

> “我在 UIScrollView 上方添加了 UILabel”

这意味着`UILabel`是 a `subView`，`UIScrollView`对吧？如果您正在使用，`autoLayout`那么这不是问题。使用`autoLayout`设备决定本身的框架，`UIControls`这就是您无法滚动的原因`UILabel`

摆脱后`autoLayout`，您将能够滚动`UILabel`设置`[scrollView setContentSize:aframe];`。如果由于某种原因您不能离开，那么您可以在加载后使用此方法`autoLayout`覆盖`autoLayout``delegate`

```
- (void)viewDidLayoutSubviews 
{

...........Your code goes here

} 
```

# iphone - 检测设备是否有 GPS

> ID：14665773
> 
> 赞同：2
> 
> 时间：2013-02-02T19:46:35.973
> 
> 标签：iphone, objective-c, gps, detect

如何检测 GPS 是否可用？

iPod touch 和 iPad WiFi 版本没有 GPS，它们有基于 WiFi 的其他东西。无论如何，如何知道 GPS 是否可用？或者如何检测 iPod Touch 或 iPad Wifi 型号？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:55:56.257

这是 iOS 上的常见困难......一种方法是获取位置并检查高度是否存在。

*   如果存在有效高度，则该位置很可能是使用 GPS 计算的
*   否则 GPS 尚未接收到任何信号，或者它不存在。

无论如何，在 iOS 上，Apple 为所有位置提供者提供了单一界面，因为他们希望开发人员在准确性方面表达他们的要求，所使用技术的控制权应留给操作系统。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-09-28T13:26:25.213

尚不确定我的解决方案是否会涵盖所有设备……但是……我要做的是询问设备是否具有蜂窝连接（[知道 iOS 设备是否具有蜂窝数据功能](https://stackoverflow.com/questions/7101206/know-if-ios-device-has-cellular-data-capabilities)）。如果是这样，它很可能也有 GPS。不确定这是否会正确覆盖每个设备，但至少我的测试设备被正确检测到。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T21:31:52.510

To be 100% sure that it is a GPS loaction, check for attribute course. if this is valid then its from GPS. but when not moving course is invalid too.
you can use that condition as initial trigger that now you have GPS.

If you need an initial valid GPS when not moving, check for vertical accuracy < 100 and horicontal < 50m

# mysql - 如何在 JPQL 中编写此 SQL 查询

> ID：14665774
> 
> 赞同：0
> 
> 时间：2013-02-02T19:46:54.323
> 
> 标签：mysql, sql, jpa, jpql

我希望将以下 SQL 转换为 JPQL：

```
SELECT  *
FROM    rooms
WHERE   NOT EXISTS
(        
    SELECT  *
    FROM    booking, booking_has_rooms
    WHERE   rooms.number=booking_has_rooms.rooms_number AND 
            booking.booking_id=booking_has_rooms.booking_booking_id AND 
            :date BETWEEN booking.checkin AND booking.checkout
); 
```

到目前为止，我有这个：

```
SELECT rooms 
FROM Rooms rooms 
WHERE NOT EXISTS 
(
    SELECT bk 
    FROM Booking b 
    JOIN  b.roomsCollection bk 
    WHERE :date BETWEEN b.checkin AND b.checkout
) 
```

如果在指定日期没有预订，它将正确返回所有房间。但是，如果任何预订在指定日期 - 它根本不会返回任何房间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:16:36.237

您在内部查询中缺少一个子句：

```
SELECT rooms 
FROM Rooms rooms 
WHERE NOT EXISTS 
(
    SELECT bk 
    FROM Booking b 
    JOIN  b.roomsCollection bk 
    WHERE :date BETWEEN b.checkin AND b.checkout
    and bk.id = rooms.id
) 
```

如果您将房间重命名为房间，您的代码会更清晰。每个实例都是一个房间，所以它应该使用单数形式。

# ios - Cocos2d - 第一个 CCAction 不显示变化

> ID：14665775
> 
> 赞同：0
> 
> 时间：2013-02-02T19:46:57.207
> 
> 标签：ios, objective-c, cocos2d-iphone

我有两个在 onEnterTransitionDidFinish 方法中运行的 CCMoveTo，用于移动精灵。两者都被正确定义，并且都可以工作，但只有被称为第二个的那个才会真正显示出视觉上的变化。调用后我已经 NSLoged 精灵的位置，新位置是正确的，但屏幕上的位置不是。

是否需要对更新程序进行一些调用才能识别第一个调用？

为了澄清：

```
CCMoveBy *moveDown = [CCMoveBy actionWithDuration:0.6f position:ccp(0, -200)];

[backMenu runAction:moveDown]; // Does not show correct position or move animation visually
[menuArm runAction:moveDown]; // Shows correct move animation 
```

任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:51:07.697

您不能重复使用相同的操作 2 次

```
 [backMenu runAction:[moveDown copy]];
 [menuArm runAction:moveDown]; 
```

一个 CCAction 可以被复制，所以每次你使用相同的动作时，你都可以复制它。

# php - 是否可以在 PHP / Mysql / APC / Memcache 中存储 PDO 准备语句以供重用？

> ID：14665781
> 
> 赞同：3
> 
> 时间：2013-02-02T19:47:36.180
> 
> 标签：php, mysql, rest, caching, pdo

...如果是这样，它会更快吗？我的用例是托管 REST API 的典型 LAMP 堆栈。这个 API 的结构方式使我有 10 个（将增长到大约 50 个）不同的查询，这些查询将使用不同的输入运行，并且我希望频率非常快。我并没有特别询问查询的结果缓存，因为我对此了解得足够多，可以单独进行。我特别担心 95% 的应用程序逻辑将是客户端 JS，而大量微小的 REST 请求将主要执行小查询并将它们返回给浏览器进行处理，最终会做很多事情每个请求的冗余工作。如果我可以使用持久连接，并检查 APC 或 memcache 中的 PDO 准备语句，然后重新使用它，
我看到[http://dev.mysql.com/doc/refman/5.1/en/query-cache-operation.html](http://dev.mysql.com/doc/refman/5.1/en/query-cache-operation.html)也可能出现在我的用例中，但它仍然会为每个请求发送准备语句.

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T19:55:40.250

没有。
这是一个有趣的问题，我花了一些时间调查它。
没有办法在调用之间传递准备好的语句。

而且，老实说，速度增益并不是那么好谈论的。

如果您关心性能 - 转向**查询**，而不仅仅是驱动程序。
影响性能的是查询，而不是它们的调用方式。

errr ..
在更彻底地阅读了你的问题之后，我没有改变主意，但有一些事情需要注意

> 大量微小的 REST 请求，主要是执行小查询并将它们返回给浏览器进行处理，最终会为每个请求做大量的冗余工作。

这是正确的。
因此，请考虑通过批量发送请求并一次性请求更多信息来减少该数量。不是因为准备好的语句的差异可以忽略不计，而是因为**相当大的网络延迟**。

> 我希望大大减少 apache 服务器到 mysql 服务器的开销。

而这个不是。
看起来您将准备好的语句弄错了，并将它们与查询缓存混淆了。
即使您设法使准备好的语句在请求之间持续存在，它也不会影响任何 apache 到 mysql 的交换 - 您需要*执行*对准备好的语句的每个后续调用，这意味着将请求发送到 mysql 服务器。因此，您唯一节省的就是查询解析，这在当今非常快。我的意思是不明显的快。

# apache - Url Rewrite：如何为“静态”动态 url 和动态 url 设置 .hatccess

> ID：14665783
> 
> 赞同：0
> 
> 时间：2013-02-02T19:47:59.400
> 
> 标签：apache, mod-rewrite, url-rewriting

我做了几次尝试都没有成功。这就是我想要为“静态动态网址”所做的事情：

```
index.php?content=authors   => /compositori/
index.php?content=albums    => /dischi/ 
```

查询字符串变量值“authors”需要变为“compositori”，我已经尝试过，但没有：

```
<IfModule mod_rewrite.c>
RewriteEngine On
RewriteRule ^compositori/$ index.php?content=authors - [R=301,L]
</IfModule> 
```

这适用于动态网址：

```
index.php?content=author&c=nome-compositore => /nome-compositore/
index.php?content=author&c=nome-compositore&action=view-bio => /nome-compositore/biografia/
index.php?content=author&c=nome-compositore&action=view-albums  => /nome-compositore/dischi/
index.php?content=author&c=nome-compositore&action=view-album&a=nome-disco  => /nome-compositore/nome-disco/ 
```

然后我想将此网址“index.php?content=index”重定向到主页，没有任何查询字符串参数，.com, index.php?content=index => www.mydomain.com

对于所有这些规则，我还需要使它们在 htaccess 位于此子文件夹中的子文件夹上工作，例如 mydomain.com/test/。尝试使用 RewriteBase 但没有：/

提前致谢

编辑：感谢大卫，现在我有了这些规则：

```
RewriteRule ^/?$ /subfolder/index.php?content=index [L]
RewriteRule ^contatti/$ /subfolder/index.php?content=contacts [L]
RewriteRule ^compositori/$ /subfolder/index.php?content=authors [L]
RewriteRule ^dischi/$ /subfolder/index.php?content=albums [L]
RewriteRule ^(.+)/biografia/$ /subfolder/index.php?content=author&c=$1&action=view-bio [L]
RewriteRule ^(.+)/dischi/$ /subfolder/index.php?content=author&c=$1&action=view-albums [L]
RewriteRule ^(.+)/(.+)/$ /subfolder/index.php?content=author&c=$1&action=view-album&a=$2 [L] 
```

但我注意到，如果我在 url 中放入未重写的查询字符串 (index.php?content=authors)，它会加载内容但保留非格式化的字符串，而不是重定向到重写的 url。我试图输入 [R=301,L] 但无事可做。这是我的最后一期。

再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:18:09.300

`RewriteRule ^compositori/$ index.php?content=authors - [R=301,L]`

这是无效的，原因有两个：您有规则的三个区域而不是必需的两个区域（`-`最后是额外的），并且您缺少前导斜杠。您也将其设置为重定向 ( `R=301`)，但可能只是想重写。这应该改为：

`RewriteRule ^compositori/$ /index.php?content=authors [L]`

一旦你开始工作，你发布的剩余转化应该同样工作。

> 然后我想将此网址“index.php?content=index”重定向到主页，没有任何查询字符串参数，.com, index.php?content=index => www.mydomain.com

您使用的是“重定向”一词，但根据您之前示例中箭头的方向，您可能指的是相反方向的“重写”，所以这是两种方式的答案：

让用户输入`www.mydomain.com`并让服务器实际加载`index.php?content=index`（我认为你的真正意思）：

`RewriteRule ^/?$ /index.php?content=index [L]`

真正有`index.php?content=index`重定向到`www.mydomain.com`

```
RewriteCond %{QUERY_STRING} ^content=index$
RewriteRule ^index.php$ http://www.mydomain.com/ [R=301,L] 
```

编辑：关于将带有查询字符串的完整路径重定向到“漂亮”URL的最后一个问题，您将为每个特定的重写实现我在上面写的内容（RewriteCond + RewriteRule），并将规则放在现有的（新规则。换句话说：

```
RewriteCond %{QUERY_STRING} ^content=index$
RewriteRule ^subfolder/index.php$ http://www.mydomain.com/ [R=301,L]

RewriteCond %{QUERY_STRING} ^content=contacts$
RewriteRule ^subfolder/index.php$ http://www.mydomain.com/contatti/ [R=301,L]

... repeat for remaining rules

RewriteRule ^/?$ /subfolder/index.php?content=index [L]
RewriteRule ^contatti/?$ /subfolder/index.php?content=contacts [L]

... repeat for remaining rules 
```

这会导致每个带有查询字符串的完整 URL 被重定向到漂亮 URL，然后漂亮 URL 被静默地重写为完整 URL。关于您上面列出的新规则的几点说明：

首先，您向原始问题中不存在的每个规则添加了一个 /subfolder。万一您希望规则在有或没有子文件夹的情况下应用，您可以将该部分添加到括号中，并在末尾添加一个问号，例如：

```
RewriteRule ^(subfolder/)?index.php$ http://www.mydomain.com/ [R=301,L] 
```

此外，您编写的新规则要求匹配路径以斜杠结尾。由于以斜杠结尾或不以斜杠结尾的目录路径是等效的，因此您应该通过在斜杠之后添加问号来使其成为可选，就像我在上面的示例中所做的一样 ( `contatti/?`)：

# d3.js - 关于可重用图表的一些说明

> ID：14665786
> 
> 赞同：14
> 
> 时间：2013-02-02T19:48:15.250
> 
> 标签：d3.js

在“[走向可重用图表](http://bost.ocks.org/mike/chart/)”中，迈克在最后展示了一个示例[时间序列图表](http://bost.ocks.org/mike/chart/time-series-chart.js)。在其中，他有这样一行：

```
// Select the svg element, if it exists.
var svg = d3.select(this).selectAll("svg").data([data]); 
```

这发生在可重用图表对象的定义中。我很难理解这个说法。

1.  首先，为什么要使用`select(this)`？上下文是`this`图表对象的当前实例吗？如果是这样，何苦呢，为什么不直接选择页面上的 svg 元素呢？

2.  为什么`selectAll`？每个图表对象不都对应一个图表吗？

3.  为什么`[data]`， 而不是`data`， 就像我见过的大多数其他例子一样？此外，为什么我们将数据绑定到 svg 元素，而不是（比如说）路径元素？

我会很感激任何帮助。

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-03T11:26:53.237

文章中定义的可重用图表可用于*将*图表插入任何 DOM 元素，可能在同一页面上多次插入，尽管使用不同的`data`. 此外，由于您指出的声明，它可用于*更新*已存在于 DOM 元素中的图形。它的使用方式是（来自[文章](http://bost.ocks.org/mike/chart/)）：

```
var formatDate = d3.time.format("%b %Y");

var chart = timeSeriesChart()
             .x(function(d) { return formatDate.parse(d.date); })
             .y(function(d) { return +d.price; });

// Put the chart _inside_ #example1
d3.select("#example1")
  .datum(data1)
  .call(chart);

// Put the same chart _inside_ #example2
d3.select("#example2")
  .datum(data1)
  .call(chart);

// Update the data for #example1, without appending another <svg> element
setInterval(function () {
    d3.select("#example1")
      .datum(data2)
      .call(chart);
}, 5000); 
```

现在解决您对它*如何*做到这一点的担忧：

1.  首先注意这段代码是在里面运行的`selection.each(...)`。根据 API 参考，[.each](https://github.com/mbostock/d3/wiki/Selections#wiki-each)`this`中的上下文是 DOM 元素。API参考进一步说：

    > 通过在回调函数中使用 d3.select(this)，可以使用 each 运算符递归处理选择。

    所以`d3.select(this)`只返回一个`d3.selection`只包含当前 DOM 元素的元素，它可能包含也可能不包含其中的`<svg>`元素。选择页面上的一个/每个`<svg>`元素不会产生一个非常可重用的图表，因为它会弄乱整个页面，而不仅仅是您希望图表出现的 DOM 元素。

2.  使用`selectAll`创建一个新的元素分组供 D3 处理，与`select`保留原始分组相反。有关嵌套选择如何工作的更多详细信息，请参阅[本文](http://bost.ocks.org/mike/nest/#conclusion)。而且，是的，您是对的，`selectAll`这里的组将仅用于创建或更新一个`<svg>`元素，这将我们带到了下一点。

3.  D3 背后的一个基本概念是[data-joins](http://bost.ocks.org/mike/join/)，其中数据*数组**以一对一的方式**连接*到一组 DOM 元素。在这种情况下，我们有兴趣将一些附加/更新到恰好一个元素。Using为我们提供了一个可以绑定到一个元素的单元素数组。或者，这可以写成：*`data``<svg>``[data]``<svg>`*

 *```
 var svg = d3.select(this).selectAll("svg").data([1]); // No `data`

   // Update the area path.
   g.select(".area")
      .data(data)    // Specifying data explicitly
      .attr("d", area.y0(yScale.range()[0]));

   // Update the line path.
   g.select(".line")
      .data(data)   // Specifying data explicitly
      .attr("d", line); 
```

但是，通过将数据绑定到元素，让子选择已经可以使用数据会更*令人愉悦。*`<svg>`

* * *

## 回答 #2

> 赞同：-5
> 
> 时间：2014-10-21T06:29:13.023

可重复使用的图表只是图表应该已经创建，我们可以简单地从图表中受益。我们不需要花时间从头开始创建图表。

致谢：[d3 的重用图表](http://www.queryhome.com/62167/reusable-charts-in-d3)*

# android - WSDL 以什么格式返回？

> ID：14665789
> 
> 赞同：0
> 
> 时间：2013-02-02T19:48:38.387
> 
> 标签：android, wsdl

我正在制作一个 android 应用程序，并且需要访问一个基于 WSDL 的在线数据库。我的代码从该数据库访问国家/地区列表，但我不知道我会以什么格式获取数据。例如。一个字符串，一个数组？等等。那么 WSDL 是否有任何标准的返回类型？谢谢。

编辑：代码片段

```
 //this is the actual part that will call the webservice
        androidHttpTransport.call(SOAP_ACTION, envelope);

        // Get the SoapResult from the envelope body.
        SoapObject result = (SoapObject)envelope.bodyIn;

    if(result!=null)
    {
        //put the value in an array
        // prepare the list of all records
         List<HashMap<String, String>> fillMaps = new ArrayList<HashMap<String, String>>();
        for(int i = 0; i < 10; i++){
            HashMap<String, String> map = new HashMap<String, String>();
            map.put(result.getProperty(i).toString());
            fillMaps.add(map);
            lv.setOnItemClickListener(onListClick);
        }
     // fill in the grid_item layout
        SimpleAdapter adapter = new SimpleAdapter(this, fillMaps, R.layout.grid_item, from, to);
        lv.setAdapter(adapter);
    }
        else
        {
              Toast.makeText(getApplicationContext(), "No Response",Toast.LENGTH_LONG).show();
        }
  } catch (Exception e) {
        e.printStackTrace();
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:55:02.810

WSDL 本身不是一种数据格式。它是基于 XML 的 Web 服务合同描述。输入参数和结果输出是使用 WSDL 定义的。[看](http://www.w3schools.com/wsdl/default.asp)这里

数据是使用 XML 模式定义 (XSD) 定义的。见这里[XSD](http://www.w3schools.com/schema/default.asp)

我不熟悉 Android，但应该有一些库支持或 3rd 方工具来读取 WSDL 定义并创建代表客户端代理的 java 类。

（更新）响应返回“国家”类型

```
<message name="getCountryListResponse">
 <part name="return" type="tns:Countries"/>
</message> 
```

如果您查看“Countries”类型，它是“Country”类型的数组：

```
<xsd:complexType name="Countries">
<xsd:complexContent> 
<xsd:restriction base="SOAP-ENC:Array">
<xsd:attribute wsdl:arrayType="tns:Country[]" ref="SOAP-ENC:arrayType"/>
 </xsd:restriction> 
</xsd:complexContent> 
```

“国家”类型具有以下三个元素。

```
</xsd:complexType> -
<xsd:complexType name="Country">
<xsd:all> 
<xsd:element name="coid" type="xsd:int"/>
<xsd:element name="countryName" type="xsd:string"/> 
<xsd:element name="countryCode" type="xsd:string"/>
</xsd:all>
</xsd:complexType> 
```

因此，如果您的 android 代码没有创建客户端代理，您将需要解析 XML 以获取如上所示的数据。

它可能看起来像一些东西（简化）：

```
<Countries>
  <Country>
    <coid>123</coid>
    <countryName>France</countryName>
    <countryCode>111</countryCode>
</Countries> 
```

# image - 在 xcode 中插入图像（可可应用程序）

> ID：14665793
> 
> 赞同：1
> 
> 时间：2013-02-02T19:49:03.607
> 
> 标签：image, cocoa

这看起来很奇怪，但我没有找到任何与 Mac 应用程序的 UIImageView 等效的东西。如何添加图像？我看过 IKImageView 但我什么都不懂

谢谢你的帮助

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:52:01.210

退房`NSImageView`。

[参考](http://developer.apple.com/library/mac/documentation/Cocoa/Reference/ApplicationKit/Classes/NSImageView_Class/)

# css - 我如何拥有一个内 对齐到右侧

> ID：14665803
> 
> 赞同：3
> 
> 时间：2013-02-02T19:50:21.213
> 
> 标签：css, twitter-bootstrap, alignment

[我有一个来自引导框架](http://twitter.github.com/bootstrap/components.html#labels-badges)的类“标签” 。我有这个标签嵌套在 a 中`<li>`，我希望它与`<li>`.

在我尝试修改 css 之前，我的 li 看起来像这样（橙色的“新项目”是标签）：![没有CSS](../Images/790182d05bc04bf69098c6772f6475a8.png)

如果我尝试`float: right`标签向右移动，但位于右上角，`<li>`如下所示：![向右浮动](../Images/d3e2402349bfd9140b2fb7086aa1db3a.png)

您还可以看到新项目标签在一种情况下被推到下一行 - 我认为这是一个不相关的问题。

关于如何让我的“新项目”跨度移动到我的右侧的任何提示`<li>`？这是我为演示目的托管的页面的链接 [：](http://frozen-stream-7233.herokuapp.com/)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T19:58:22.483

给予班级`label`保证金似乎有帮助：

```
span.label {
  float: right;
  margin: 10px;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T19:54:43.493

```
<li class="row-fluid">
  <div class="span9">Description of item 1</div>
  <span class="offset1 span2 label pull-right">new item</span>
</li>
<li class="row-fluid">
  <div class="span9">Description of item 2</div>
  <span class="offset1 span2 label pull-right">new item</span>
</li> 
```

* * *

```
<li class="row-fluid">
  <div class="span9">Description of item 1</div>
  <div class="offset1 span2 btn btn-large">new item</div>
</li>
<li class="row-fluid">
  <div class="span9">Description of item 2</div>
  <div class="offset1 span2 btn btn-large">new item</div>
</li> 
```

* * *

```
<li class="row-fluid">
  <div class="span9">Description of item 1</div>
  <span class="offset1 span2 label">new item</span>
</li>
<li class="row-fluid">
  <div class="span9">Description of item 2</div>
  <span class="offset1 span2 label">new item</span>
</li> 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T20:15:10.567

尝试相对位置

```
span.label{
float: right;
position:relative;
top:5px;
} 
```

前任。[http://prntscr.com/rbzpp](http://prntscr.com/rbzpp)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:27:45.500

这仅使用 css 解决了您的所有问题。

```
.label-warning, .badge-warning {
    background-color: #f89406;
    float: right;
    margin-top: 9px;
}
.product_summary {
    clear: both;
}
.product_summary img {
    float: left;
}
.name, .price {
    float: left;
    line-height: 37px;
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T20:32:57.710

您可以使用边距将按钮从顶部放在中间。另一个您可以使用相同的位置`position:absolute; right:0; top:45%`。当图像的大小（高度）增加时，此代码甚至可以更好地工作。

# c - 上下文切换对 64 位段库的性能影响

> ID：14665805
> 
> 赞同：22
> 
> 时间：2013-02-02T19:50:51.353
> 
> 标签：c, linux, performance, x86-64, cpu-registers

我对手册页中的措辞感到困惑[`arch_prctl(2)`](http://www.kernel.org/doc/man-pages/online/pages/man2/arch_prctl.2.html)。具体来说，它指出：

> **64 位段基础的上下文切换相当昂贵。** 通过使用 modify_ldt(2) 设置 LDT 或在内核 2.5 或更高版本中使用 set_thread_area(2) 系统调用，使用段选择器设置 32 位基数可能是更快的替代方法。仅当您要设置大于 4GB 的基础时才需要 arch_prctl()。可以通过使用带有 MAP_32BIT 标志的 mmap(2) 来分配前 2GB 地址空间中的内存。

这是否意味着使用此系统调用的进程的上下文切换将受到性能损失或确切的含义是什么？

在查看了 Linux 内核的源代码后，似乎对于小于 4 GiB 的地址使用 LDT，而大于 4 GiB 的地址使用特定于模型的寄存器。

来自[`do_arch_prctl`](http://lxr.free-electrons.com/source/arch/x86/kernel/process_64.c?a=microblaze#L446)：

```
case ARCH_SET_FS:
        /* handle small bases via the GDT because that's faster to
           switch. */
        if (addr <= 0xffffffff) {
                set_32bit_tls(task, FS_TLS, addr);
                if (doit) {
                        load_TLS(&task->thread, cpu);
                        loadsegment(fs, FS_TLS_SEL);
                }
                task->thread.fsindex = FS_TLS_SEL;
                task->thread.fs = 0;
        } else {
                task->thread.fsindex = 0;
                task->thread.fs = addr;
                if (doit) {
                        /* set the selector to 0 to not confuse
                           __switch_to */
                        loadsegment(fs, 0);
                        ret = wrmsrl_safe(MSR_FS_BASE, addr);
                }
        }
        put_cpu();
        break; 
```

使用 GDT 如何比写入寄存器更快？另外，我假设更新 FS 和 GS 的价格仅在进程之间切换时支付，这意味着当没有其他进程计划运行时，通过系统调用进入内核没有额外成本？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2014-06-14T18:57:54.337

哇，这个问题是在 12 月问的，没人回答吗？其中一些您可能已经知道，如果知道，我深表歉意。

只是因为执行 wrmsr 的步骤很慢。在任务切换时只加载段寄存器更容易和更快。

在非常现代的 Intel 处理器上，“rdfsbase”、“wrfsbase”、“rdgsbase”和“wrgsbase”指令的添加允许直接访问 FS 和 GS 的基址寄存器，难度远低于以前。事实上，如果内核愿意，它可以允许在用户模式下使用它们。您可能想检查现代 Linux 内核是否利用 wrfsbase 来使分配低于 4 GB 的 TLS 区域变得不必要。

我不知道它在 Linux 上的情况如何，但从 Windows 7 开始的 Windows NT 具有用户模式线程调度作为应用程序开发人员的可选功能。与 Linux 和 Mac OS X 中一样，Windows 使用段寄存器的基地址（x86-64 Windows 中的 GS）在 x86 上实现线程本地存储。这个特性类似于纤程，除了一个程序可以用内核识别的方式将它自己的线程上下文切换到另一个。

Windows 中的用户模式调度是通过为每个可调度线程创建一个带有指向 TLS 块（在 Windows 中称为“线程环境块”或 TEB）的段的 LDT 来实现的。除了上下文切换之外，用户模式还可以通过重新加载 GS 基础来切换线程。这要求 TEB 低于 Linux 的 arch_prctl 的性能说明中的 2^32 - 否则，用户模式调度将需要在每次切换到不同的线程时调用 NT 内核以执行 wrmsr，从而破坏了整点用户模式调度。

在 Windows 8.1 中，添加了对 wrgsbase 的支持，并且还启用了用户模式。8.1 中的用户模式调度使用 wrgsbase 而不是 GS 段重新加载和 LDT（如果 CPU 有）。

# ios - NSMutableDictionary & JSONRepresentation

> ID：14665807
> 
> 赞同：0
> 
> 时间：2013-02-02T19:50:58.967
> 
> 标签：ios, json, frameworks

我下载框架 JSON，添加到我的项目中，我认为它是正确添加的，因为当我放

```
#import <JSON/JSON.h> 
```

我没有任何警告。但是当我想使用它时，事情就开始了：

```
NSMutableDictionary * attachement = [NSMutableDictionary dictionary];
NSString *requestJson = [attachement JSONRepresentation]; 
```

但我对 JSONRepresentation 有一个警告：

```
Instance method '-JSONRepresentation' not found (return type defaults to 'id') 
```

我该如何解决？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T20:44:03.193

如果您使用的是 iOS 5.0 及更高版本，请使用内置`NSJSONSerialization`

```
NSError *error; 
NSData *jsonData = [NSJSONSerialization dataWithJSONObject:attachement 
                                                   options:NSJSONWritingPrettyPrinted
                                                     error:&error];
if (!jsonData) {
    //Deal with error
} else {
    NSString *requestJson = [[NSString alloc] initWithData:jsonData encoding:NSUTF8StringEncoding];
} 
```

# python - 使用模型名称的变量名称调用过滤器（Django）

> ID：14665814
> 
> 赞同：0
> 
> 时间：2013-02-02T19:51:36.427
> 
> 标签：python, django, filter

> **可能重复：**
> [django：使用字符串选择特定模型](https://stackoverflow.com/questions/14651438/django-use-a-string-to-select-a-specifc-model)

示例：（Django，views.py）

```
def create(request, mod):  
    #mod is a modelname    
    if request.method == 'POST':  
        form = globals()[mod+"Form"](request.POST)  
        if form.is_valid():  
            new_file_num = form.save(commit=False)  
            >>>> if entry.objects.filter(fileTypeNumber=1).exists(): 
```

**我的问题就在这里。**

```
if entry.objects.filter( .... 
```

* * *

相反，我想：

```
mod = entry;  
if mod.objects.filter( .... 
```

* * *

这里的总体目标是为具有不同字段的多个模型使用相同的“视图”。有一个更好的方法吗？该视图本质上是分配一个文件编号，然后保存它。

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:05:49.237

从实例中拉出类。

```
mod = my_instance.__class__
if mod.objects.filter(fileTypeNumber=1).exists(): 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:09:32.937

You could maybe do something like:

```
from models import Foo, Bar

def create_view(model):
    # model is the actual model class (not instance)
    def view(request):
        form = globals()[model.__name__ + "Form"]
        if model.objects.filter(fileTypeNumber=1).exists():
            pass
            # whatever you do with it
    return view

foo_view = create_view(Foo)
bar_view = create_view(Bar) 
```

This would make two views for the `Foo` and `Bar` models. But if you've got different fields for each model (or if you're validating or doing anything else that needs handling differently), you may be better off just making different views by hand for each one instead of doing this kind of abstract creation function.

# vb.net - 如何将控件添加到具有垂直空间的面板

> ID：14665815
> 
> 赞同：0
> 
> 时间：2013-02-02T19:51:36.487
> 
> 标签：vb.net, vb.net-2010

我正在尝试将控件添加到具有垂直间距的面板中？

这是我现在的代码：

```
 Private Sub btnLoad_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles btnLoad.Click

    Dim pic As PictureBox = New PictureBox()
    Dim lb As Label = New Label()
    Dim cells As Integer = MoviesDataSet.movies.Count
    ReDim mypb(cells)
    ReDim mylb(cells)
    Dim k As Integer = 0
    For Each movie As DataRow In MoviesDataSet.movies

        pic.ImageLocation = Application.StartupPath & "\" & movie("moviePhoto")
        pic.Size = New System.Drawing.Size(x, y)
        pic.SizeMode = PictureBoxSizeMode.StretchImage
        pic.Margin = New System.Windows.Forms.Padding(0, 0, 0, 5)
        mypb(k) = pic

        lb.Text = movie("movieName")
        lb.AutoSize = True
        lb.Margin = New System.Windows.Forms.Padding(0, 0, 0, 10)
        mylb(k) = lb

        k += 1

    Next

    For i As Integer = 0 To MyPB.Count - 1 Step 1
        Panel1.Controls.Add(MyPB(i))
        Panel1.Controls.Add(MyLb(i))
    Next
End Sub 
```

我的面板宽度约为 180，高度约为 170。我这样做了，如果内容高于面板高度，则有滚动条。代码在同一个位置添加所有控件，所以我只能看到最后一张照片。

我该怎么做才会有一张照片，然后是一个标签，然后是另一张照片等等

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:47:08.833

如果您希望放置在控件中的图像垂直对齐而不是全部在同一位置，则需要在将控件放入控件之前计算控件的新位置。

```
Dim index As Integer = 0
For i As Integer = 0 To 10

    Dim picture As New PictureBox() With
    {
        .Size = New Size(100, 30),
        .Location = New Point(10, .Height + (i * 40)),
        .BackColor = Color.Red
    }

    Panel1.Controls.Add(picture)
Next 
```

我显然无法测试您的代码，但这种逻辑就足够了：

```
pic.Location = new Point(10, pic.Height + (k * 40) 
```

# google-analytics - 谷歌分析 - _setAccount 之前的 _trackEvent？顺序重要吗？

> ID：14665816
> 
> 赞同：4
> 
> 时间：2013-02-02T19:51:37.577
> 
> 标签：google-analytics

所以这将起作用：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-65432-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();

_gaq.push(['_trackEvent', 'Videos', 'Play', 'Gone With the Wind']); 
```

* * *

**但是，如果访问者可以通过类似的链接来`http://example.com?autoPlay=Wind`怎么办？**那么视频已经被请求，并开始播放，生成：

```
var _gaq = _gaq || [];
_gaq.push(['_trackEvent', 'Videos', 'Play', 'Gone With the Wind']); 
```

事件。但是常规的跟踪代码仍然在页面底部运行，这就是我们使用 async 的原因：

```
var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'UA-65432-1']);
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

那么我是否必须至少将其移动`_setAccount`到顶部，或者它会在我打电话时它已经在队列中工作`ga.js`吗？或者我可以自己制作队列......但在这里我看到一个线索，如果他们之前已经有东西，[他们确保](https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApi_gaq#_gaq.push)不会删除。并且还有针对不同上下文的多个跟踪器......**那么这是否意味着完全忽略订单是完全合法的？**很抱歉这个简单的问题，但我完全找不到异步允许的内容和不允许的内容。`_gaq``_setAccount`

 **感谢帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-03T04:21:51.453

您必须`_setAccount`在任何记录数据的命令之前使用，例如`_trackPageview`or `_trackEvent`。

如果您查看`_trackEvent`when`_setAccount`尚未运行时发送的跟踪像素，您会看到它记录到默认帐户，例如`UA-XXXXX-X`.

我已经在我希望分析代码运行但不希望它污染生产跟踪数据的开发或登台系统上使用它。注释掉该`_setAccount`行，所有数据最终都会记录到一个不存在的帐户。

* * *

假设您从未初始化名为“mumble”的跟踪器（使用`_gaq.push(['mumble._setAccount', 'UA-65432-1'])`，以下代码显示未启动跟踪器的 ID 为“UA-XXXXX-X”：

```
echo(_gat.getTrackerByName('mumble')_getAccount()) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-02-10T02:57:00.223

现在它做到了：

```
var _gaq = _gaq || [];
if(_gaq.unshift){
    _gaq.unshift(['_setAccount', 'UA-65432-1']);
} else {
    _gaq.push(['_setAccount', 'UA-65432-1']);
}
_gaq.push(['_trackPageview']);

(function() {
var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})(); 
```

所以解决方案是 while`push`追加到数组的末尾，而追加到`unshift`开头。

问题可能是，如果 iframe *ga*已经加载，则它不是数组，而是具有自定义`push`方法的对象。在这种情况下，让我们回到原始代码。在您自己的主页中，帐户 ID 是相同的，并且无论如何都可以使用。**

# jquery - 单击哈希链接后jQuery隐藏div

> ID：14665818
> 
> 赞同：0
> 
> 时间：2013-02-02T19:51:49.510
> 
> 标签：jquery, html, hash, hide

HTML：

```
<div id="text" class="text">
   Hello World! <a href="#hide">CLOSE</a>
</div> 
```

脚本：

```
$(function() {
    if ( document.location.href.indexOf('#hide') > -1 ) {
      $('#text').fadeOut('slow');
    }
}); 
```

单击后不会隐藏“文本”div。如果我直接去“www.mysite.com/#hide”，它会起作用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:34:08.593

You want to select the link with the href="#hide"? Use the [attribute-equals](http://api.jquery.com/attribute-equals-selector/) selector:

```
$(function() {
    $("a[href='#hide']").click(function() {  $('#text').fadeOut('slow');});
}); 
```

The link itself would be treated as an local anchor (means on the same page). This won't cause the browser to reload the page and therefore your script won't be executed. In modern browsers you could capture these changes via the hasChange event.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:54:55.270

您是在单击功能上调用它吗？例如

```
var hashHide = function() {
    if ( document.location.href.indexOf('#hide') > -1 ) {
      $('#text').fadeOut('slow');
    }
};

$('itemClicked').live('click', function(){hashHide()})); 
```

我意识到 .live() 功能已被贬值......但是坏习惯:)

# jquery - jQuery：如何根据内容选择段落

> ID：14665820
> 
> 赞同：1
> 
> 时间：2013-02-02T19:51:55.717
> 
> 标签：jquery

> **可能重复：**
> [基于文本的 jQuery 选择](https://stackoverflow.com/questions/1430290/jquery-select-based-on-text)

我正在学习drupal。我想向网站添加一些 jquery。我知道我可以并且以后可能会返回并添加 id 和类，以便我可以更轻松地访问内容，但我想知道如何正确使用“has”或“contents”和/或“filter”。

在我的页面上，我有很多段落，我想`<p>`根据它们的内容选择 's 然后对它们做一些事情，例如我想要：

```
jQuery('p').has('What is Supplemental').css('background-color', 'red') 
```

我该怎么做？

此处的站点示例：http: [//surety.lfwebz.com](http://surety.lfwebz.com)

感谢您的见解。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:00:52.200

```
$('p').filter(function(){
    return $(this).text().indexOf("What is Supplemental") > -1;
}).css('background-color', 'red'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:01:03.220

你可以尝试这样的事情：

```
$('p').filter(function () {
    return $(this).text() == 'What is Suppemental';
}).css('background-color', 'red'); 
```

可能会导致问题，因为`:contains`它不检查完全匹配，例如，`p:contains("What is Supplemental")...`也会匹配“什么是补充[填写空白]”或“[填写空白]什么是补充”。

编辑：

using 也可能是这样`indexOf`，尽管它仅适用于附加到匹配项的文本。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T19:58:14.917

: 包含怎么样？

```
$('p:contains("What is Supplemental")').css('background-color','red'); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-02-02T20:09:26.407

Or `each`:

```
jQuery('p').each(function(i){
 str = jQuery(this).html();
 if(str.indexOf('What is Supplemental') !== -1){
   jQuery(this).css('background-color', 'red');
 }
}); 
```

# python - 如何根据熊猫数据框中的 2 个（或更多）其他值选择某个值

> ID：14665828
> 
> 赞同：2
> 
> 时间：2013-02-02T19:52:18.870
> 
> 标签：python, pandas

我一直在尝试找出如何根据数据帧的同一个元组中的多个其他值来选择某个值。数据看起来像这样（从当前数据帧复制）

```
 DealID      PropId LoanId   ServicerId    ServicerPropId
0   BAC98765      15   000015    30220144       010-002-001
1   BAC98765      16   000016    30220092       010-003-001
2   BAC98765      45   000045    30220155       010-045-001
3   BAC98765      48   000048    30220157       010-048-001 
```

在 SQL 术语中，我想要完成的是：

```
Select ServicerPropId from dataframe
 where DealID = 'BAC98765' and ServicerId = '30220144' 
```

我尝试了几种不同的方法来对数据进行切片，但似乎无法弄清楚如何让多个选择标准起作用并只将 1 个值返回到变量中。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T19:57:16.330

```
columns = ['DealID', 'PropId', 'LoanId', 'ServicerId', 'ServicerPropId']

d = [('A', [ 'BAC98765', '15', '000015', '30220144', '010-002-001']),
     ('B', [ 'BAC98765', '16', '000016', '30220092', '010-003-001']),
     ('C', [ 'BAC98765', '45', '000045', '30220155', '010-045-001']),
     ('D', [ 'BAC98765', '48', '000048', '30220157', '010-048-001']),]

D =  pandas.DataFrame.from_items(d, orient='index', columns=columns)

criterion1 = D['DealID'].map(lambda x: x == 'BAC98765' )
criterion2 = D['ServicerId'].map(lambda x: x == '30220144')

res = D[criterion1 & criterion2]['ServicerPropId'] 
```

使用`map`让您可以设置任何您想要的条件，在这种情况下，您可以更简单地执行此操作（如 DSM 评论中所指出的）

```
res = D[(D['DealID'] == "BAC98765") & (D["ServicerId"] == "30220144")]['ServicerPropId'] 
```

这使

```
In [35]: print res
A    010-002-001
Name: ServicerPropId

In [36]: type(res)
Out[36]: pandas.core.series.Series 
```

[（文档）](http://pandas.pydata.org/pandas-docs/dev/indexing.html#boolean-indexing)

# python - 我什么时候应该使用 for 循环提交 SQLAlchemy？

> ID：14665834
> 
> 赞同：24
> 
> 时间：2013-02-02T19:53:02.710
> 
> 标签：python, mysql, sqlalchemy

哪个是对的？我知道第一个会起作用，但我怀疑数据库的工作量比可能需要的要多。第二个工作是否同样有效，但对数据库的工作更少？我正在使用 MySQL FWIW。

```
for item in items:
    db.session.add(item)
    db.session.commit() 
```

或者

```
for item in items:
    db.session.add(item)
db.session.commit() 
```

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2013-02-02T23:08:37.170

我认为您的第二个解决方案更好，但这取决于您如何配置会话。特别是自动刷新和自动提交设置。此外，您应该使用对事务有良好支持的引擎，例如 innodb。

假设您同时关闭了自动提交和自动刷新，那么您将把插入刷新到服务器，提交先前的事务，然后在每次迭代时创建另一个事务，这在 SQLAlchemy 和 MySQL 中都创建了大量不必要的工作。

如果您有一个简单的项目列表（如示例中所示），我建议您使用 add_all ，否则如果您确实需要循环，那么一定要在循环外应用提交。

[http://docs.sqlalchemy.org/en/latest/orm/session.html#sqlalchemy.orm.session.Session.add_all](http://docs.sqlalchemy.org/en/latest/orm/session.html#sqlalchemy.orm.session.Session.add_all)

```
db.session.add_all(items)
db.session.commit() 
```

附加说明，如果在循环的一部分出现问题，您的事务将仅回滚到您在循环中的先前提交，如果您正在使用事务，这可能不是您想要的。例如，如果在循环中途发生错误，则列表中只有一半的项目可能会写入数据库。而在循环外调用 commit 可以保证您的循环已经完成并且将全部提交或全部回滚。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2019-02-12T23:02:07.850

添加解决方案：这是使用 add_all() 的方法

```
user1 = User(name='user1')
user2 = User(name='user2')
session.add(user1)
session.add(user2)

session.commit()     # write changes to the database 
```

而不是两个添加行使用

```
session.add_all([user1, user2]) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2019-11-05T09:39:50.783

你可以使用这个：

`session.bulk_save_objects([User, User, Permission])`

# linq - 如何从表达式转换 >表达式的谓词 谓词

> ID：14665837
> 
> 赞同：3
> 
> 时间：2013-02-02T19:53:29.397
> 
> 标签：linq, entity-framework, domain-driven-design, automapper, expression-trees

一些背景：我的应用程序中有多个层，其中两个是域层和用作我的 DAL 的基础设施层。在领域层，我已经实现了一个通用的存储库模式，如下所示：

```
 public interface IRepository<T, in TId> where T : IEntity<TId>
    {
        void Insert(T entity);
        void Delete(T entity);
        IQueryable<T> SearchFor(Expression<Func<T, bool>> predicate);
        IQueryable<T> GetAll();
        T GetById(TId id);
    } 
```

在我的 DAL 中，我实现了一个通用的 DAO 模式：

```
 public interface IDao<TEntity> where TEntity : class
    {
        IQueryable<TEntity> Select();
        IQueryable<TEntity> GetAll();
        IQueryable<TEntity> Where(Expression<Func<TEntity, bool>> predicate);
        TEntity GetSingle(Expression<Func<TEntity, bool>> predicate);
        TEntity GetFirst(Expression<Func<TEntity, bool>> predicate);
        void Add(TEntity entity);
        void Delete(TEntity entity);
        void Attach(TEntity entity);
    } 
```

我有一个领域类，在商业术语中代表一个人。我的 DAL 层中有一个类似的单个对象，用于表示我的数据库中的对象。我有一个名为 EntityFrameworkDao 的类，它实现了我的 IDAO 接口，并负责在该 DAO 接口中找到的所有操作（CRUD 和上述一些其他操作）。

我正在尝试（尝试了几天）找到一种将存储库中使用的表达式映射到 DAL 中使用的表达式的方法。具体的例子是这样的：我有一个通用的 DomainRepository 实现了我的 IRepository 接口（见上文）。SearchFor 方法如下所示：

```
 public IQueryable<TDomainEntity> SearchFor(Expression<Func<TDomainEntity, bool>> predicate)
    {
        var convertedExpression = **SomeMagicFunctionToConvertExpressions**();
        var dataEntities = _dao.Where(convertedExpression);
        return AutoMapper.Mapper.Map<IEnumerable<TEfEntity>, IEnumerable<TDomainEntity>>(dataEntities).AsQueryable();
    } 
```

我需要弄清楚 SomeMagicFunctionToConvertExpressions 是什么，以便我可以将域层中的谓词转换为 Where 方法可以在实现 IDao 的 DAL 类中理解的东西：

```
 public IQueryable<TEfEntity> Where(Expression<Func<TEfEntity, bool>> predicate)
        {
            return _context.Set<TEfEntity>().Where(predicate).AsQueryable();
        } 
```

我尝试使用本文中找到的 Automapper 的 CreateMapExpression：[AutoMapper for Func's between selector types](https://stackoverflow.com/questions/7424501/automapper-for-funcs-between-selector-types)

但这仅告诉我如何在`Func<DomainType,bool>`谓词与`Func<DTOType,bool>`（谓词）之间进行转换，而不是在表达式与表达式之间进行转换。我正在寻找一种方法来转换这样的东西：

```
Expression<Func<TDomainEntity, bool>> predicate 
```

对此：

```
Expression<Func<TDAOEntity, bool>> predicate 
```

[在我找到这篇](https://stackoverflow.com/questions/2797261/mutating-the-expression-tree-of-a-predicate-to-target-another-type/10467736#10467736)关于变异表达式树的文章后，我以为我正在做一些事情，但它不允许我传入包含 && 或 || 的 compex linq 表达式 或者比简单的 i => i.id.Equals(12345) 类型查询更复杂的任何内容。

我正在使用 Automapper，所以任何使用它的解决方案都会很棒，但我现在对任何想法持开放态度。我真的被困住了，现在已经研究了好几天了。这似乎是一项相当常见的任务：将基于类型的查询从架构中的一层转换为 DAL 中使用的类型。

在此先感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-05-11T07:19:10.323

你可能不应该这样做，看起来你把事情复杂化了。

第一：如果您使用通用存储库模式，您基本上违反了[TDA](http://pragprog.com/articles/tell-dont-ask)原则；您正在创建对存储实现的直接依赖关系。在您的通用存储库上有一个“全部”、“按 ID”和“全文搜索”是很好的，但任何其他的都应该被您的界面隐藏。一个简单的例子：

```
repo.search(x=>x.IsActive==true) 
```

假设这是一个简单的标志，后来不知何故您的域在某个地方发生了变化，并且您决定也可以软删除一个项目。这意味着您需要将域中任何地方的代码从前者更改为：

```
repo.search(x=>x.IsActive==true && x.IsDeleted == false) 
```

正确的方法是在您的存储库上使用像这样的正确方法

```
repo.ActiveItems() 
```

这可以确保您不会到处传播您的行为。

接下来，如果您要公开通用搜索，为什么不在您的领域模型中直接使用 Linq；毕竟，你仍然在你的 sql 对象的另一层上实现一层。你能解释一下添加这些额外层的附加价值吗？毕竟，它们仍然与相同的实现相关联（尽管它们可能在那里进行了一些额外的名称/值转换）。

# c - 试图实现 Dijkstra，但有没有意义的分段错误

> ID：14665842
> 
> 赞同：0
> 
> 时间：2013-02-02T19:53:50.050
> 
> 标签：c, linked-list, segmentation-fault, dijkstra

在函数 Dijkstra 中，我初始化了一个优先级队列 nperm，它有一个 info 字段；它告诉一个节点是否是 notpermanent 集合的成员。然后我有一个“i”字段，它实际存储指针（数组索引）到那个图节点和下一个指针。最初每个节点都是非永久集的成员。这是初始化的完成方式：

```
for (i = graph; hnode[i].next >= 0;) 
{
    insertnperm(&nperm, 1, i);
    distance[i] = 500000;
    i = hnode[i].next;
} 
```

距离[i] 基本上是节点 i 到到目前为止已知的根节点的距离，因此随着算法的进行，距离会更新，优先级队列 nperm 的顺序也应该是基于距离的。现在按函数顺序，我传递一个指向优先级队列指针的指针，并将该指针的值存储在另一个相同类型的变量中`notperm p; p = *pq;`，因为优先级队列中的每个节点都有一个字段“i”，其中包含图形节点的索引，我遍历列表直到最近更新距离的节点，然后删除该节点并将其放置在升序优先级队列中的适当位置。

我使用该语句`while ((p->i) != s)`遍历节点，但出现分段错误，我不知道。当我使用`p->i`.

谁能向我解释为什么会发生这种情况？

这是完整的代码：

```
#include<stdio.h>
#include<conio.h>
#define MAXNODES 50

struct header 
{   
    int info;     
    int epoint;     
    int tpoint;     
    int next;     
};

struct header hnode[MAXNODES];     
int i = 0;

struct arcs 
{     
    int info;     
    int epoint;     
    int tpoint;     
    int enext;     
    int tnext;     
};     
int j = 0;     
struct arcs anode[MAXNODES]; 

struct node 
{     
    int info;     
    int i;     
    struct node *next;     
};     
typedef struct node *notperm;     

notperm npgetnode(void)
{     
    notperm p;     
    p = (notperm) (malloc(sizeof(struct node)));     
    return p;     
}          

int hgetnode()
{     
    int k;     
    k = i++;     
    return k;     
}   

int agetnode()
{     
    int k;     
    k = j++;     
    return k;     
}  

void hfreenode(int r)
{     
    --i;     
}     
void afreenode(int r)
{     
    --j;     
}

int addnode(int *pgraph, int x)
{     
    int p;     
    p = hgetnode();     
    hnode[p].info = x;     
    hnode[p].epoint = -1;     
    hnode[p].tpoint = -1;     
    hnode[p].next = *pgraph;     
    *pgraph = p;     
    return p;     
} 

void joinwt(int p, int q, int wt)
{    
    int r, r2;     
    int t, t2;     
    r2 = -1;     
    r = hnode[p].epoint; 

    while (r >= 0 && anode[r].epoint != q) 
    {     
        r2 = r;     
        r = anode[r].enext;     
    }        
    if (r >= 0) 
    {     
        anode[r].info = wt;     
    }         
    if (r < 0) 
    {    
        r = agetnode();     
        anode[r].epoint = q;     
        anode[r].tpoint = -1;     
        anode[r].enext = -1;     
        anode[r].tnext = -1;     
        anode[r].info = wt;     
        (r2 < 0) ? (hnode[p].epoint = r) : (anode[r2].enext = r);   
    }

    /*updation to q */

    t = hnode[q].tpoint;     
    t2 = -1;     
    while (t >= 0 && anode[r].tpoint != p) 
    {     
        t2 = t;     
        t = anode[t].tnext;     
    }     
    if (t >= 0) 
    {     
        anode[t].info = wt;     
    }   
    if (t < 0) 
    {     
        t = agetnode();     
        anode[t].tpoint = p;     
        anode[t].epoint = -1;   
        anode[t].tnext = -1;     
        anode[t].enext = -1;     
        anode[t].info = wt;     
        (t2 < 0) ? (hnode[q].tpoint = t) : (anode[t2].tnext = t);     
    }   
}

void insertnperm(notperm * pq, int x, int currep)
{     
    notperm p;     
    if (*pq == NULL)     
    {     
        *pq = (notperm) (malloc(sizeof(struct node)));     
        (*pq)->info = x;     
        (*pq)->i = currep;     
        (*pq)->next = NULL;     
        return;     
    }     
    p = npgetnode();     
    p->info = x;     
    p->i = currep;     
    p->next = (*pq);     
    *pq = p;     
}       

void order(notperm * pq, int s, int distance[])
{     
    notperm p, q, j;     
    q = NULL;     
    p = NULL;     
    p = *pq;     
    while ((p->i/*this statement always ends up with a segmentation fault*/) != s) 
    {     
        q = p;     
        p = p->next;     
    }     
    if (q == NULL)     
        *pq = p->next;     
    else     
        q->next = p->next;     
    q = NULL;     
    for (j = *pq; distance[(j->i)] < distance[(p->i)]; j = j->next)     
    q = j;     
    if (q == NULL) {     
        p->next = *pq;     
        *pq = p;     
    }     
    else     
    {     
        p->next = q->next;     
        q->next = p;     
    }     
}  

void chngstozero(notperm * pq, int s)
{     
    notperm p;     
    for (p = *pq; (p->i) != s; p = p->next);    
         p->info = 0;     
    }     
    int checkstat(notperm * pq, int s)
    {     
        notperm p;   
        for (p = *pq; (p->i) != s; p = p->next);     
        return (p->info);     
    }          
    int newminel(notperm * pq)
    {     
        notperm p;     
        for (p = *pq; (p->info) != 1; p = p->next);     
        p->info = 0;     
        return (p->i);     
    }        

    void Dijkstra(int graph, int s, int t, int *pd)
    {     
        unsigned int distance[MAXNODES], precede[MAXNODES];     
        int current, i, k, dc, currep;     
        unsigned int smalldist, newdist;     
        notperm p;     
        notperm nperm;    
        nperm = NULL;
        for (i = graph; hnode[i].next >= 0;) 
        {    
            insertnperm(&nperm, 1, i);    
            distance[i] = 500000;    
            i = hnode[i].next;
        }     
        distance[s] =0; 
        order(&nperm, s, distance);    
        chngstozero(&nperm, s);
        current = s;
        while (current != t) 
        {
            smalldist = 500000;
            dc = distance[current];
            for (currep = hnode[current].epoint; anode[currep].enext >= 0; currep = anode[currep].enext) 
            {
                if (checkstat(&nperm, currep)) 
                {
                    newdist = dc + anode[currep].info;
                    if (newdist < distance[currep]) 
                    {
                        distance[currep] = newdist;
                        order(&nperm, currep, distance);
                        precede[currep] = current;
                    }
                }
            }

main()
{
    int graph,a,b,c,d,e,wt,r,t,pd;
    graph=-1;
    int wt1=5;
    int wt2=3;
    int wt3=6;
    int wt4=2;
    int wt5=7;
    a=addnode(&graph,4);
    b=addnode(&graph,6);
    c=addnode(&graph,8);
    d=addnode(&graph,9);
    e=addnode(&graph,5);
    joinwt(a,b,wt);
    joinwt(a,c,wt1);
    joinwt(a,d,wt2);
    joinwt(a,e,wt3);
    joinwt(d,b,wt4);
    joinwt(c,e,wt5); 
    Dijkstra(graph,a,e,&pd);
    printf("%d",pd);

    getch();
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T19:59:05.403

```
while ((p->i/*this statement always ends up with a segmentation fault*/) != s) {
    q = p;
    p = p->next;
} 
```

看起来您已经超出了 指向的列表的末尾`p`。最后一个元素将有一个`NULL`for `p->next`; 然后您设置`p = p->next`并尝试取消引用`NULL` `p`指针，从而导致分段错误。

解决方案是在检查 a`NULL` `p`之前检查`p->i`.

# jquery - 取消之前的按键事件

> ID：14665847
> 
> 赞同：0
> 
> 时间：2013-02-02T19:54:20.357
> 
> 标签：jquery, ajax

问题是当我在输入框中写下评论后按回车键时，消息被发送到数据库中，然后通过 Ajax 调用检索。

一切都很顺利，当我不聚焦输入字段然后再次聚焦并开始输入新消息并按 Enter 时，消息会发送两次，如果我再次这样做，则消息会发送 3 次，依此类推。代码有什么问题？我该如何解决这个问题？

```
$(".type_comment").click(function(){
        container = $(this);

        if ($(this).val() == "Type a comment.")
        {
                    $(this).val("");
                    $(this).css({ 'font-size':'13px','opacity':'1' });          
        }
        nr_crt = container.attr("nr_crt");
        container.keyup(function(e)
            {
                code = (e.keyCode ? e.keyCode : e.which);
                if (code == 13)
                    {
                            var chatmsg = container.val();
                            var comment_id = $("#main-photo"+nr_crt).attr("commentid");
                            var name = <?php echo json_encode($_SESSION['username']); ?>;
                            $.post('../utility/postcomment.php', { comment: chatmsg, name: name, comment_id: comment_id } , 
                                function(output) {
                                });
                            code = null;
                            chatmsg = "";
                            container.val("");
                            var time = setTimeout(function(){
                            $.post('../utility/fetchcomments.php', { comment_id : comment_id , name : name} , 
                                function(results) {
                                    $(".comment_append"+nr_crt).append(results);
                                });
                            clearTimeout(time);
                            },500);
                    }
            });

    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:16:22.340

```
$(".type_comment").click(function(){
    ...
    container.keyup(function(e){ 
```

每次单击它时，都会将一个新的 keyUp 处理程序附加到同一个容器。也许您希望每个新的处理程序都触发一次，然后在重新连接之前不再触发？虽然它可能不是最干净的解决方案，但[jQuery 完全支持](http://api.jquery.com/one/)：

```
$(".type_comment").click(function(){
    ...
    container.one('keyup', function(e){ 
```

但是，根据您的描述，这很可能是您想要的：

```
$(".type_comment").each(function(){
    var container = $(this);
    var nr_crt = container.attr("nr_crt");
    ...
    container.click(...);
    container.keyup(...);
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T19:57:11.650

尝试将超时设置为 0 而不是 500。这会将其移动到列表的底部，但不会给时间缓存更多输入键。

# uml - 理赔管理

> ID：14665854
> 
> 赞同：-1
> 
> 时间：2013-02-02T19:55:28.207
> 
> 标签：uml, tool-uml, argouml, staruml

我正在做一个“索赔管理”项目，我做了很多研究，但我找不到任何想法：/我开始指定工作工具（eclipse，android插件..）现在下一步是建模索赔的用例管理层（索赔管理：一位客户声称某事有误，他拿起电话并致电中心，一名员工在该中心写下卡利姆和所有关注点，当他保存索赔时，Android 通知将发送给最近的员工去到客户家修理 pb）谢谢你 :)）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-03-19T15:32:34.883

这听起来像家庭作业。像以前一样，我推荐 Alistair Cockburn 的用例标准书，ISBN 978-0201702255。

甚至[Wikipedia](http://en.wikipedia.org/wiki/Use_case_diagram)也可以让您快速开始。一旦您第一次尝试图表返回，我想如果您需要改进它，您会在这里找到很多帮助。

所以你确定了

> 一个客户

他做到了

> 声称某事错误

那挺好的。以此作为您的主要参与者和用例开始。

# testing - 集成测试期间的代码覆盖率

> ID：14665855
> 
> 赞同：2
> 
> 时间：2013-02-02T19:55:31.663
> 
> 标签：testing, integration-testing, code-coverage

我正在寻找一些可以告诉在集成环境中执行的测试的代码覆盖率的工具。我将我的 Web 服务应用程序部署为 tomcat 中的战争，并再次与数据库对话。测试调用 Web 服务端点来测试功能。现在，我想要一些可以告诉我测试的代码覆盖率的工具。

我想提一下，我们已经有了用于单元测试的 cobertura 工具。

我正在寻找这样的集成测试覆盖工具，如果这个论坛中的某个人能提供一些启发，我将不胜感激。

非常感谢，光辉。

# json - 如何使用来自具有角度服务的另一个控制器的数据更新一个控制器？

> ID：14665856
> 
> 赞同：3
> 
> 时间：2013-02-02T19:55:33.620
> 
> 标签：json, angularjs

我有 2 个控制器。第一个获取所选项目，第二个获取可用项目。

如何显示新选择的项目？

每个可用项目下方的按钮都有一个 ng-click，它调用一个名为 updateItem 的服务，我希望在其中进行更新。

我已经为此工作了一段时间，非常感谢任何帮助。-谢谢

[jsfiddle](http://jsfiddle.net/whnSs/135/)

```
<div ng-controller="seletedItemCtrl">
      <p><i>I want to update this item</i></p>
      <div ng-repeat="item in selectedItems">

      <ul>
          <li>{{item.color}}</li>
          <li>{{item.Distance}}</li>
          <li>{{item.height}}</li>
          <li>{{item.name}}</li>
          <li>{{item.year}}</li>
      </ul>
   </div>
</div >   
  ///////////////////////////////////////////////////
  <div ng-controller="availableItemsCtrl">
       <div ng-repeat="item in availableItems">
          <ul>
              <li>{{item.color}}</li> 
              <li>{{item.Distance}}</li>
              <li>{{item.height}}</li>
              <li>{{item.name}}</li>
              <li>{{item.year}}</li>
         </ul>
         <button ng-click = 'updateItem()' >select item</button>
      </div> 
   </div> 
```

JS

```
var app = angular.module('myApp', []);

function availableItemsCtrl($rootScope, $scope){
        $scope.availableItems =  {
    "Items": {
        "Item": {
            "Group1": [
                {
                    "color": "White",
                    "Distance": "NA",
                    "height": "3ft",
                    "name": "Underlift",
                    "year": "1955"

                  },
                  {
                    "color": "blue",
                    "Distance": "4M",
                    "height": "2ft",
                    "name": "Underlift",
                    "year": "1956"

                  },
                  {
                     "color": "red",
                     "Distance": "NA",
                     "height": "3ft",
                     "name": "Golen Leaf",
                     "year": "1968"

                   },
                   {
                      "color": "yellow",
                      "Distance": "22M",
                      "height": "10in",
                      "name": "Together",
                      "year": "1988"

                   }

              ]
          },

       }
   }
       $scope.availableItems = $scope.availableItems.Items.Item.Group1;
 }

 function seletedItemCtrl($rootScope, $scope){
         $scope.seletedItem =  {
              "Items":{
                  "Item":{
                     "Group1":[{

                         "color": "black",
                         "Distance": "2M",
                         "height": "1in",
                         "name": "never",
                         "year": "1922"

                          }
                       ]
                     }
                   }
                 }
    $scope.selectedItems = $scope.seletedItem.Items.Item.Group1;

  }
    app.service("updateItem", function(){

      console.log('update item');

   }); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T22:12:36.397

请记住，您`$scope`不是您的模型；你`$scope`的就是你*将模型附加到*的东西。Angular 鼓励您构建自己的模型对象来描述应用程序的行为。在此示例中，您似乎具有“可用项目”和“选定项目”的域概念。这是一个简单的服务，可为您提供这些概念的模型：

```
app.factory('Items', function () {
    var Items = {
        availableItems: [],
        selectedItems: []
    };
    Items.addAvailableItem = function (item) {
        Items.availableItems.push(item);
    };
    Items.selectItem = function (item) {
        Items.selectedItems.push(item);
    };
    return Items;
}); 
```

所以现在你有了这个`Items`服务，它有一个`addAvailableItem`方法，它接受一个项目并将其添加到`availableItems`数组中，还有一个`selectItem`方法，它接受一个项目并将其添加到`selectedItems`数组中。您现在可以使用控制器的范围将这两个数组绑定到您的视图：

```
app.controller('someController', function ($scope, Items) {
    $scope.availableItems = Items.availableItems;
}; 
```

这是一个 jsFiddle，它使用您提供的代码作为起点来演示概念（它还演示了在模块中定义控制器的更好方法）：http: [//jsfiddle.net/BinaryMuse/kV4mK/](http://jsfiddle.net/BinaryMuse/kV4mK/)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T22:08:16.440

这是我的尝试： [fiddle](http://jsfiddle.net/mrajcok/XeEjb/)。

我不太了解您的数据结构，因此我对其进行了一些更改。但是，我认为重要的部分就在那里——如何在控制器之间共享数据。

```
function availableItemsCtrl($rootScope, $scope, itemService) {
    $scope.availableItems = [{
        "color": "White",
         ...
    }];
    $scope.updateItem = itemService.storeSelectedItem;
    itemService.storeSelectedItem($scope.availableItems[0]);
}

function selectedItemCtrl($scope, itemService) {
    $scope.selectedItem = itemService.selectedItem;
}

app.service("itemService", function () {
    var that = this;
    this.selectedItem = {};
    this.storeSelectedItem = function (item) {
        angular.copy(item, that.selectedItem);
        console.log('update item', item);
    }
}); 
```

我花了很长时间才弄清楚我必须使用 angular.copy() 而不是

```
that.selectedItem = item; 
```

因为上面会导致 selectedItem 被分配一个新的数组引用，而 selectedItemCtrl 不会注意到 - 即 $scope.selectedItem 仍将引用以前的数组。

我很想看看其他人想出什么。

**更新：**看起来我完全错过了您想要支持多个选定项目的事实。

# php - 提交表单后判断文本字段中是否有值

> ID：14665861
> 
> 赞同：0
> 
> 时间：2013-02-02T19:55:59.690
> 
> 标签：php

所有，我的页面上有一个联系表。我有一些 jQuery 的东西来控制表单提交，在我发送表单之前我也有一些 PHP 验证。我仍然收到一些空白电子邮件。我将电子邮件地址和名称设为必填字段。然后我有以下PHP：

```
<?php
$email = $_POST['email'];
if($email != ""){
     //send email
} 
```

我仍然收到电子邮件。使用空函数会起作用吗？我只是想确保字段中确实有文本可以发送，而不是能够发送空白表单。人们用什么方法来控制它？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T19:58:27.340

试试`if (!empty($_POST[$'email'])) {`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:02:34.870

```
<?php
$email = $_POST['email']; 
if(!empty($email)){
    //send email
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:04:43.153

也许你应该修剪你的字符串以避免使用空格：

```
<?php
$email = trim($_POST['email']);
if(!empty($email)){
     //send email
} 
```

更多信息：[http ://www.php.net/manual/en/function.trim.php](http://www.php.net/manual/en/function.trim.php)

# c# - 订购我的 LINQ

> ID：14665863
> 
> 赞同：2
> 
> 时间：2013-02-02T19:56:06.740
> 
> 标签：c#, linq

我有这个公司列表（加入类别），我在其中通过自由文本输入进行搜索，通常按名称/字母顺序对结果进行排序。

但是，当返回的公司链接到某个类别时（这些更重要类别的 id 在列表中），我想主要对这些类别中的公司的结果进行排序，二级排序应按字母顺序排列。

我怎样才能添加这个订单？

```
 List<int> importantCategories = new List<int>() { 14, 99, 4428 };

    var companies = (from c in context.Companies
                     join ct in context.Categories on c.CategoryId equals ct.CategoryId
                     where ct.Active == true 
                     && c.Name.Contains(freeTextFilter)
                     orderby c.Name
                       --- if company is from category 14, 99, 4428 
                           then the ordering should place those above the rest
                     select c); 
```

我从查询中取出了几行，但在我没有使用加入的类别表的问题之后添加了其中的一行。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T20:02:14.573

也许像这样？

```
List<int> importantCategories = new List<int>() { 14, 99, 4428 };

var companies = (from c in context.Companies
                 join ct in context.Categories on c.CategoryId equals ct.CategoryId
                 where c.Name.Contains(freeTextFilter)
                 orderby importCategories.Contains(ct.CategoryID) ? 0 : 1, c.Name
                 select c); 
```

或者如果您希望类别也引起订单，那么您可以尝试以下操作：

```
orderby importCategories.Contains(ct.CategoryID) ? ct.CategoryID : 4429, c.Name 
```

4429 只是列表的最大值 + 1，可以动态计算。

正如建议的那样，这也可以，但如果您想按 categoryID 订购，则不行：

```
orderby !importCategories.Contains(ct.CategoryID) , c.Name 
```

从不使用 ct 有什么原因吗？

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T19:59:50.937

我会尝试

```
orderby (importantCategories.Contains(ct.CatetoryId) 
                            ? 0
                            : 1),
         c.Name 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T20:07:45.633

首先，我认为您不需要进行联接，因为您实际上并未使用该类别中的任何数据。您仅使用类别 ID 进行过滤，并且`Company`已经包含该数据。其次，您应该使用`OrderBy`自定义键选择器和 a`ThenBy`以便您可以在类别中按字母顺序排列。这应该归功于它使用流利的语法。

它首先按类别 id 排序，但仅当它们在指定的类别中时，其他条目才被视为相同 ( `int.MaxValue`)。然后它`Name`在类别选择中排序。如果您不关心第一部分的类别顺序，您可以将`c => categories.Contains(c.CategoryId) ? 0 : 1`其用作键选择器。

```
var categories = new int[] { 14, 99, 4428 };

var companies = context.Companies
                       .Where(c => c.Name.Contains(freeTextFilter))
                       .OrderBy(c = categories.Contains(c.CategoryId) 
                                        ? c.CategoryId 
                                        : int.MaxValue)
                       .ThenBy(c => c.Name); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-02-02T20:10:10.930

您可以使用 ThenBy：这是一个示例

```
 List<string> strings = new List<string> { "f", "a", "b", "c", "d", "e" };

        var result = strings.OrderByDescending(x => x == "e")
                            .ThenByDescending(x => x == "c")
                            .ThenBy(x=>x); 
```

这给出了“e”、“c”、“a”、“b”、“d”、“f”

我认为您可以将其应用于您的问题以获得正确的排序。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-02-02T20:44:42.300

这类似于 Hogan 的答案，仅使用扩展方法和 Lambda 表达式而不是查询语法（尽管可以说这可能是查询语法更容易理解的情况）。

```
var companies = context.Companies
    .Join(context.Categories, c => c.CategoryId, ct => ct.CategoryId, (c, ct) => c)
    .Where(c => c.Name.Contains(freeTextFilter))
    .OrderBy(c => importantCategories.Contains(c.CategoryId) ? 0 : 1)
    .ThenBy(c => c.Name); 
```

假设您可能并不真的需要加入...

```
var companies = context.Companies
    .Where(c => c.Name.Contains(freeTextFilter))
    .OrderBy(c => importantCategories.Contains(c.CategoryId) ? 0 : 1)
    .ThenBy(c => c.Name); 
```

# android - 启动 apk 编译并从命令行或快捷方式开始

> ID：14665864
> 
> 赞同：0
> 
> 时间：2013-02-02T19:56:07.347
> 
> 标签：android, cordova, apk

我正在使用 PhoneGap 开始一个 Android 项目；我正在使用带有 ADT 插件的 Eclipse，关键是我为我的移动应用程序进行 Web 开发，因为我使用 PhoneGap，为此我使用 Visual Studio（是的，我不是在开玩笑：我很了解，它运行良好）。

问题是每次我想测试我的应用程序时，我都必须使用 eclipse 并使用运行按钮。无论如何我可以构建一个快捷方式来编译我的应用程序并运行它（在我的 android 设备上）？像一些命令行 eclipse，或者带有 Android SDK 的东西？我使用 Windows 7。

非常感谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:28:21.617

您可以使用每个需要的命令创建 *.bat 文件 [http://developer.android.com/tools/building/building-cmdline.html](http://developer.android.com/tools/building/building-cmdline.html)
PS：本指南也可能会有所帮助[http://www.vogella.com/articles/ AndroidBuildAnt/article.html#start](http://www.vogella.com/articles/AndroidBuildAnt/article.html#start)

# sql-server-2008 - SqlDataReader 强制它一次读取一行

> ID：14665865
> 
> 赞同：0
> 
> 时间：2013-02-02T19:56:15.003
> 
> 标签：sql-server-2008, sqldatareader

似乎 SqlDataReader 提前读取

```
while (rdrMainLoop.Read())
{
    sID = rdrMainLoop.GetInt32(0);
    nearDupID = rdrMainLoop.IsDBNull(2) ? 0 : rdrMainLoop.GetInt32(2);
    sqlCmdProducer.CommandText = "update [docSVsys] set [FTSnearDupID] = '" + sID.ToString() + "' where [sID] = '" + (sID + 1).ToString() + "';";
    sqlCmdProducer.ExecuteNonQuery();
} 
```

在此示例中，我正在更新下一行。
但是当我 .Read() 下一行 SqlDataReader 不会读取当前值。
我认为它会提前批量处理。
有没有办法强制 SqlDataReader 一次读取一行。
我很擅长脏读（必须是因为我可能会更新该行）。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-07T14:16:33.687

使用了游标。如果它是一个简单的选择，则光标会读取当前值。
带有 group by 的 select 和循环中的更新会更改 group by 然后这将不会反映在接下来的 fetch 中。

# python - 如何在pygame中为精灵制作和分配一个矩形？

> ID：14665868
> 
> 赞同：1
> 
> 时间：2013-02-02T19:56:48.200
> 
> 标签：python, pygame, sprite, collision

我已经构建了一个简单的游戏引擎，其中玩家和敌人类只是对象。
我想让它们成为精灵，以便我可以检查碰撞并更好地管理它们，但我似乎找不到任何关于如何做到这一点的好例子......
我已经将玩家和敌人类扩展到扩展`pygame.sprite.Sprite`类。
但是当我检查两者之间的碰撞时，
它说这两个类需要`rects`（矩形）。

我不知道如何做到这一点......

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T22:56:33.487

Sprite 是对象，您需要的所有内容都已作为字段包含在 sprite 类中。您需要明确设置精灵的边界矩形。

来自 pygame 文档：

> pygame.sprite.spritecollide 在组中查找与另一个 Sprite 相交的 Sprite pygame.sprite.spritecollide(sprite, group, dokill, collided = None): return Sprite_list
> 
> 返回一个列表，其中包含一个组中与另一个 Sprite 相交的所有 Sprite。交点是通过比较每个 Sprite 的 Sprite.rect 属性来确定的。

因此，您需要将 sprite.rect 设置为您希望精灵碰撞所基于的矩形。通常，您可以使用精灵图像的大小作为碰撞矩形。

```
s.image = pygame.image.load("sprite.png").convert() #load a sprite image
s.rect = b.image.get_rect() # set collision rectangle 
```

# android - 将 ActionBarSherlock 添加到我的项目后，我的 R.java 文件消失了

> ID：14665878
> 
> 赞同：4
> 
> 时间：2013-02-02T19:57:25.560
> 
> 标签：android, actionbarsherlock

我需要在我的应用程序中使用一个为 API 级别 8 设计的操作栏。所以我开始着手让 ActionBarSherlock 进入我的应用程序。

我按照说明为操作栏创建了一个新项目，然后将其添加到我项目的 Android 选项卡中的库中。

但是，然后我丢失了我的 R.Java 文件，当我尝试清理项目时会弹出一堆错误：

```
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:6: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.ActionBar.Solid'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:10: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.Solid'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:12: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.Solid.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:15: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.ActionBar.TabView'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:17: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.TabView'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:19: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.TabView.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:22: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.ActionBar.TabBar'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:24: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.TabBar'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:26: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.TabBar.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values\abs__styles.xml:101: error: Error: No resource found that matches the given name: attr 'android:textAllCaps'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:29: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.ActionBar.TabText'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:31: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.TabText'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:33: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionBar.TabText.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:55: error: Error retrieving parent for item: No resource found that matches the given name 'android:Widget.Holo.Light.ActionMode.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values\abs__styles.xml:328: error: Error: No resource found that matches the given name: attr 'android:textAllCaps'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:93: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionBar.Menu'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:96: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionBar.Title'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:98: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionBar.Title.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:100: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionBar.Subtitle'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:102: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionBar.Subtitle.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:104: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionMode.Title'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:106: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionMode.Title.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:108: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionMode.Subtitle'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:110: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.ActionMode.Subtitle.Inverse'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:113: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.PopupMenu'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:115: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.PopupMenu.Large'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:117: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.PopupMenu.Large'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:119: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.PopupMenu.Small'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__styles.xml:121: error: Error retrieving parent for item: No resource found that matches the given name 'android:TextAppearance.Holo.Widget.PopupMenu.Small'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__themes.xml:8: error: Error retrieving parent for item: No resource found that matches the given name 'android:Theme.Holo.Light.DarkActionBar'.
[2013-02-02 19:50:36 - FrenchVerbApp] C:\Users\Jamie\Downloads\JakeWharton-ActionBarSherlock-4.2.0-0-g90939dc\JakeWharton-ActionBarSherlock-e5c2d1c\library\res\values-v14\abs__themes.xml:14: error: Error: No resource found that matches the given name: attr 'android:actionBarWidgetTheme'. 
```

我在这里做错了什么？我项目的目标 API 是 13 级，我的 minSdkVersion 是 7

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-02-02T20:52:08.437

部分错误引用了一个名为“values-v14”的文件夹。由于您的目标是 api 13，因此您没有这些主题。将目标 api 更改为 14 或更高，错误应该会消失。

您通常将目标 API 设置为可用的最新 API 编号。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:55:21.623

确保将目标 API 级别（ActionBarSherlock 项目和您的项目的）设置为相同级别（对于 ABS，我总是使用 API 级别 >=15）。

您可以使用项目属性并单击 Android 部分来执行此操作。

请记住在更改 API 级别后进行项目清理。

# c - 共享库中符号的“未定义引用”

> ID：14665879
> 
> 赞同：1
> 
> 时间：2013-02-02T19:57:28.267
> 
> 标签：c, linux, gcc, shared-libraries, ld

> **可能重复：**
> [Linux 上的链接器错误：“未定义的引用”</a>](https://stackoverflow.com/questions/12272864/linker-error-on-linux-undefined-reference-to)
> 
> [](https://stackoverflow.com/questions/12272864/linker-error-on-linux-undefined-reference-to)

 [我将这样的共享库链接在一起：

```
core : $(CORE_OBJS) | bin
    $(CC) $(LFLAGS) -o bin/libcbitcoin$(LIBRARY_EXTENSION) $(CORE_OBJS) 
```

这会产生库文件 libcbitcoin.2.0.so。

但是，当生成链接到库的可执行文件时，链接器会抱怨对出现的每个符号都有未定义的引用。makefile 像这样链接可执行文件：

```
$(TEST_BINARIES): bin/%: build/%.o
    $(CC) -lcbitcoin.$(LIBRARY_VERSION) -lpthread -lcbitcoin-crypto.$(LIBRARY_VERSION) -lcbitcoin-network.$(LIBRARY_VERSION) -lcbitcoin-file-ec.$(LIBRARY_VERSION) -lcbitcoin-storage.$(LIBRARY_VERSION) -lcbitcoin-rand.$(LIBRARY_VERSION) -L/opt/local/lib -levent_core -levent_pthreads -lcrypto -L$(BINDIR) $< -o $@ 
```

这给出了链接器选项`-lcbitcoin.2.0`。](https://stackoverflow.com/questions/12272864/linker-error-on-linux-undefined-reference-to) 

[当我尝试为 Linux Mint 而不是 OSX 构建时，我只会遇到这个问题。完整的makefile在这里：](https://stackoverflow.com/questions/12272864/linker-error-on-linux-undefined-reference-to)[https ://github.com/MatthewLM/cbitcoin/blob/newNetworkCode/Makefile.in](https://github.com/MatthewLM/cbitcoin/blob/newNetworkCode/Makefile.in)

autoconf 文件在这里（如果在任何情况下它很重要）：[https ://github.com/MatthewLM/cbitcoin/blob/newNetworkCode/configure.ac](https://github.com/MatthewLM/cbitcoin/blob/newNetworkCode/configure.ac)

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-02T20:00:37.100

**编辑**：链接器排序。

您不必为链接器行指定库扩展。只要一个`-lcbitcoin`就足够了。

此外，传递给链接器的库的顺序也很重要。排序与您可能期望的相反——您应该在指定需要它的对象*之后指定一个库。*见： http: [//gcc.gnu.org/onlinedocs/gcc/Link-Options.html](http://gcc.gnu.org/onlinedocs/gcc/Link-Options.html)

# ruby - 错误：安装 goliath 时出错：goliath 需要 Ruby 版本 >= 1.9.2

> ID：14665880
> 
> 赞同：-1
> 
> 时间：2013-02-02T19:57:42.217
> 
> 标签：ruby, rubygems, rvm

```
sudo gem install goliath 
```

给出错误

```
ERROR:  Error installing goliath:   goliath requires Ruby version >= 1 
```

但是当尝试`ruby -v`它显示

```
ruby 1.9.3p374 (2013-01-15 revision 38858) [i686-linux] 
```

为什么会这样？？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-02T20:20:37.363

`sudo`当 Ruby 与 rvm 一起安装时，这是通过安装 gems 时的常见错误。如果是这种情况，那么 sudo 会触发原始系统 Ruby，它往往是 1.8.7，因此会阻塞。

所以，如果你使用 rvm 停止使用`sudo gem install xxx`just use `gem install goliath`，你应该没问题。

# objective-c - 目标 C，在 NSLog 中获取 nan

> ID：14665881
> 
> 赞同：0
> 
> 时间：2013-02-02T19:57:43.187
> 
> 标签：objective-c, nsdate, nan

我试图在两个时间点之间获得时间。我不知道我做错了什么，但我的 NSLog 给了我“nan”的结果。总时间为：纳秒。如果我从 if 语句中删除 [timer start] 和 [timer stop]，那么它会给我双倍的正常结果。

```
- (void) filterFrequency {

Timer *timer = [[Timer alloc] init];
if (self.currentFrequency > 2000 && pointInTime % 2 == 0)

{
    [timer startTimer];
    pointInTime = pointInTime + 1;
}
 else if (self.currentFrequency > 2000 && pointInTime % 2 == 1)

{
    [timer stopTimer];
    pointInTime = pointInTime + 1;
    NSLog(@"Total time was: %f seconds", [timer timeElapsedInSeconds]);

} 
```

这是 Timer.h #import

```
@interface Timer : NSObject {
NSDate *start;
NSDate *end;
}

- (void) startTimer;
- (void) stopTimer;
- (double) timeElapsedInSeconds;
- (double) timeElapsedInMilliseconds;
- (double) timeElapsedInMinutes;

@end 
```

定时器.m

```
#import "Timer.h"
#import "ListenerViewController.h"

@implementation Timer

- (id) init {
self = [super init];
if (self != nil) {
    start = nil;
    end = nil;
}
return self;
}

- (void) startTimer {
start = [NSDate date];
}

- (void) stopTimer {
end = [NSDate date];
}

- (double) timeElapsedInSeconds {
return [end timeIntervalSinceDate:start];
}

- (double) timeElapsedInMilliseconds {
return [self timeElapsedInSeconds] * 1000.0f;
}

- (double) timeElapsedInMinutes {
return [self timeElapsedInSeconds] / 60.0f;
}

@end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T00:56:57.397

我使用以下代码来测量声音需要加载的时间。我不知道您想在代码中做什么（以及为什么），但这对于精确的时间测量肯定有用。

```
 // Setup:

    uint64_t tm_start,tm_end,tm_elapsed,tm_nanoSeconds,tm_milliSeconds,tm_seconds;
    mach_timebase_info_data_t info;

    // Start:
    tm_start = mach_absolute_time();    

    // do your stuff 

    // Example
    NSSound *cocoaAudioPlayerSound = [[NSSound alloc] initWithContentsOfFile:mediaLocation byReference:YES];
    // … time flies

    // End:
    tm_end = mach_absolute_time();
    tm_elapsed = tm_end - tm_start;
    mach_timebase_info(&info); 
    tm_nanoSeconds = tm_elapsed * info.numer / info.denom;
    tm_milliSeconds = tm_nanoSeconds / (1000000);
    tm_seconds = (tm_milliSeconds/1000);

#ifdef DEBUG
    fflush(stdout);
    printf ( "| allocateAudio: %5lld milliseconds (%5lld seconds) (%12lld nano seconds)\n", tm_milliSeconds, tm_seconds, tm_nanoSeconds );
#endif 
```

# maven - maven glassfish插件

> ID：14665884
> 
> 赞同：0
> 
> 时间：2013-02-02T19:58:09.883
> 
> 标签：maven, plugins, glassfish

我正在尝试使用 glassfish maven 插件部署战争文件但是我最终遇到以下异常：

```
**SEVERE: WebModule[/myapp]StandardWrapper.Throwable
java.lang.NoSuchMethodError: org.objectweb.asm.ClassWriter.<init>(Z)V
    at net.sf.cglib.core.DebuggingClassWriter.<init>(DebuggingClassWriter.java:47)
    at net.sf.cglib.core.DefaultGeneratorStrategy.getClassWriter(DefaultGeneratorStrategy.java:30)
    at net.sf.cglib.core.DefaultGeneratorStrategy.generate(DefaultGeneratorStrategy.java:24)
    at net.sf.cglib.core.AbstractClassGenerator.create(AbstractClassGenerator.java:216)
    at net.sf.cglib.core.KeyFactory$Generator.create(KeyFactory.java:145)
    at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:117)
    at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:108)
    at net.sf.cglib.core.KeyFactory.create(KeyFactory.java:104)
    at net.sf.cglib.proxy.Enhancer.<clinit>(Enhancer.java:69)
    at org.hibernate.proxy.pojo.cglib.CGLIBLazyInitializer.getProxyFactory(CGLIBLazyInitializer.java:117)
    at org.hibernate.proxy.pojo.cglib.CGLIBProxyFactory.postInstantiate(CGLIBProxyFactory.java:43)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.buildProxyFactory(PojoEntityTuplizer.java:162)
    at org.hibernate.tuple.entity.AbstractEntityTuplizer.<init>(AbstractEntityTuplizer.java:135)
    at org.hibernate.tuple.entity.PojoEntityTuplizer.<init>(PojoEntityTuplizer.java:55)
    at org.hibernate.tuple.entity.EntityEntityModeToTuplizerMapping.<init>(EntityEntityModeToTuplizerMapping.java:56)
    at org.hibernate.tuple.entity.EntityMetamodel.<init>(EntityMetamodel.java:302)
    at org.hibernate.persister.entity.AbstractEntityPersister.<init>(AbstractEntityPersister.java:434)
    at org.hibernate.persister.entity.SingleTableEntityPersister.<init>(SingleTableEntityPersister.java:109)
    at org.hibernate.persister.PersisterFactory.createClassPersister(PersisterFactory.java:55)
    at org.hibernate.impl.SessionFactoryImpl.<init>(SessionFactoryImpl.java:226)
    at org.hibernate.cfg.Configuration.buildSessionFactory(Configuration.java:1300)
    at org.hibernate.cfg.AnnotationConfiguration.buildSessionFactory(AnnotationConfiguration.java:859)
    org.apache.catalina.core.StandardContext.loadOnStartup(StandardContext.java:5032)
    at org.apache.catalina.core.StandardContext.start(StandardContext.java:5319)
    at com.sun.enterprise.web.WebModule.start(WebModule.java:500)
    at org.apache.catalina.core.ContainerBase.addChildInternal(ContainerBase.java:917)
    at org.apache.catalina.core.ContainerBase.addChild(ContainerBase.java:901)
    at org.apache.catalina.core.StandardHost.addChild(StandardHost.java:755)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1980)
    at com.sun.enterprise.web.WebContainer.loadWebModule(WebContainer.java:1630)
    at com.sun.enterprise.web.WebApplication.start(WebApplication.java:100)
    at org.glassfish.internal.data.EngineRef.start(EngineRef.java:130)
    at org.glassfish.internal.data.ModuleInfo.start(ModuleInfo.java:269)
    at org.glassfish.internal.data.ApplicationInfo.start(ApplicationInfo.java:286)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:461)
    at com.sun.enterprise.v3.server.ApplicationLifecycle.deploy(ApplicationLifecycle.java:240)
    at org.glassfish.deployment.admin.DeployCommand.execute(DeployCommand.java:370)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$1.execute(CommandRunnerImpl.java:360)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:370)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.doCommand(CommandRunnerImpl.java:1067)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl.access$1200(CommandRunnerImpl.java:96)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1247)
    at com.sun.enterprise.v3.admin.CommandRunnerImpl$ExecutionContext.execute(CommandRunnerImpl.java:1235)
    at com.sun.enterprise.admin.cli.embeddable.CommandExecutorImpl.executeCommand(CommandExecutorImpl.java:118)
    at com.sun.enterprise.admin.cli.embeddable.DeployerImpl.deploy(DeployerImpl.java:97)
    at com.sun.enterprise.admin.cli.embeddable.DeployerImpl.deploy(DeployerImpl.java:88)
    at org.glassfish.maven.PluginUtil.doDeploy(PluginUtil.java:106)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.glassfish.maven.AbstractDeployMojo.doDeploy(AbstractDeployMojo.java:171)
    at org.glassfish.maven.DeployMojo.execute(DeployMojo.java:64)
    at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:107)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:209)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
    at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:84)
    at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:59)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.singleThreadedBuild(LifecycleStarter.java:183)
    at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:161)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:319)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:156)
    at org.apache.maven.cli.MavenCli.execute(MavenCli.java:534)
    at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:196)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:141)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
    at java.lang.reflect.Method.invoke(Method.java:601)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:290)
    at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:230)
    at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:409)
    at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:352)** 
```

我四处搜索，发现原因可能是因为加载了多个 asm jar 副本。asm jar 不是我的项目的直接依赖项，而是通过我的项目所依赖的另一个项目的间接依赖项。MyProject->AnotherProject 的依赖是 asm jar。

当我通过 maven war 插件创建 WAR 时，它会将 asm jar 插入 webapp 的 lib 文件夹中。我试图通过在我的 pom 中执行以下操作来强制它排除它：

```
 <plugin>
            <groupId>org.glassfish</groupId>
            <artifactId>maven-embedded-glassfish-plugin</artifactId>
            <version>3.1</version>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>2.3</version>
            <configuration>
                <webXml>${project.basedir}\src\main\webapp\WEB-INF\web.xml</webXml>
                <packagingExcludes>asm*.jar</packagingExcludes>
            </configuration>
        </plugin> 
```

还是没有运气！有什么明显的我在这里做错了吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T06:01:30.797

我认为你不应该简单地排除那些罐子。如果您的项目实际上依赖于它，这将是一个运行时问题。我建议您按照以下步骤操作：

1.  找出这个类属于哪个工件。在你的情况下，我的猜测是“objectweb.asm”。
2.  使用 maven-dependency-plugin 找出您的项目依赖于多少个不同版本的“objectweb.asm”：

    ```
     mvn dependency:tree -Dincludes=:objectweb.asm 
    ```

3.  选择最合适的一个并在您的 pom 中排除其他，例如：

    ```
     <dependency>
            <groupId>xxxGroup</groupId>
            <artifactId>xxx</artifactId>
            <version>1.0.0</version>
            <exclusions>
                   <exclusion>
                         <groupId>anotherGroup</groupId>
                         <artifactId>anotherXXX</artifactId>                                              
                   </exclusion>
            </exclusions>           
        </dependency> 
    ```

# intellij-idea - 如何在 Munit Haxe 中调试或打印到控制台？

> ID：14665885
> 
> 赞同：0
> 
> 时间：2013-02-02T19:58:14.483
> 
> 标签：intellij-idea, haxe

我正在尝试在运行 Munit 时调试 Haxe 中的某些内容。有没有办法在运行测试时调试或打印到控制台信息？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-29T01:31:09.430

Flash：有一个灰色的小箭头，您可以单击每个测试以显示所有轨迹。

CPP: haxelib run munit test -cpp cpp.Lib.print("foo");

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-11-09T07:08:15.817

要打印到 JavaScript 控制台（例如在 MUnit 测试中），您可以运行：

```
js.Browser.console.log("Hello world"); 
js.Browser.console.info("Haxe is great!"); 
js.Browser.console.warn("Something could be wrong"); 
js.Browser.console.error("Something went wrong"); 
```

资料来源：[HAXE - 用 Ja​​vascript 调试](https://haxe.org/manual/debugging-javascript.html)

# java - Spring Security getPrincipal() 方法返回anonymousUser

> ID：14665886
> 
> 赞同：8
> 
> 时间：2013-02-02T19:58:14.340
> 
> 标签：java, spring, spring-mvc, spring-security

在我的 Spring Web 应用程序中，我想在我的控制器中获得一个经过身份验证的用户：

```
Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal(); 
```

但是，虽然我已经登录，但主体的值是“anonymousUser”。我怎样才能获得经过身份验证的用户？我在 spring-security.xml 中的配置：

```
<http auto-config="true" request-matcher="regex">
    <intercept-url pattern="/welcome*" access="ROLE_USER" />
    <form-login login-page="/login" default-target-url="/welcome"
        authentication-failure-url="/loginfailed" />
    <logout logout-success-url="/logout" />
</http> 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-02T21:57:51.363

不知道我明白，但试试这个

```
<http auto-config="true" request-matcher="regex">
  <intercept-url pattern="/welcome*" access="ROLE_USER" />
  <intercept-url pattern="/*" access="IS_AUTHENTICATED,IS_AUTHENTICATED_ANONYMOUSLY"/> 
```

# sass - 你如何在 Sass（不是 SCSS）中创建自定义函数

> ID：14665888
> 
> 赞同：2
> 
> 时间：2013-02-02T19:58:16.257
> 
> 标签：sass

很多关于在 SCSS 中执行此操作的文档..

```
@function _em($wanted, $inherited) {
  @return ($wanted / $inherited) + 'em';
} 
```

你会如何在 Sass 中解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T23:50:05.347

```
@function _em()
  @return ($wanted / $inherited) + 'em' 
```

只需删除括号和分号。

# django - django url重写而不重定向

> ID：14665889
> 
> 赞同：4
> 
> 时间：2013-02-02T19:58:17.163
> 
> 标签：django, apache, url-rewriting, subdomain

我正在使用 django 并且有数百个子域 url

```
abc.domain.com 
```

想改写成

```
domain.com/site/abc/ 
```

是否有可能通过用户看不到的 url 重写

```
domain.com/site/abc/ 
```

在他的浏览器中，但看到

```
abc.domain.com 
```

这可以在 apache 端完成。但我的问题是，我们可以在 django 里面做吗？

提前致谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-03T03:32:18.643

The Django sites framework does provide some tools to deal with multiple domains, but they all assume you have a different SITE_ID for each deployment.

That said. You can probably write up a middleware that checks `request.META['HTTP_HOST']` and then passes that information off to your view in whatever way you wish.

At that point you can just follow the Django [docs](https://docs.djangoproject.com/en/dev/ref/contrib/sites/?from=olddocs#the-currentsitemanager) on using a site custom manager for your models.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-10-24T04:23:27.960

你有没有运行apache，我认为这种请求可以通过APACHE的重写引擎来处理

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T23:28:37.400

我不太明白你的问题，但也许一些摆弄 request.urlconf 和自定义中间件是解决方案？ [https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.urlconf](https://docs.djangoproject.com/en/dev/ref/request-response/#django.http.HttpRequest.urlconf)

# google-app-engine - ComputedProperty 的 GAE NDB 性能与相关模型计数的按需查找

> ID：14665895
> 
> 赞同：3
> 
> 时间：2013-02-02T19:59:24.620
> 
> 标签：google-app-engine, google-cloud-datastore, app-engine-ndb

使用 Google App Engine，我只是好奇是否有人可以阐明使用`ComputedProperty`相关模型的计数与按需计算的性能特征（读取和写入）。

ComputedProperty 具有允许对属性进行索引的明显好处，但我只是对相比之下读取和写入的速度感到好奇。

例如，给定两个模型：

```
class Car(ndb.Model):
  owner_key = ndb.KeyProperty(kind='Owner', indexed=True)

class Owner(ndb.Model)
   def cars_count(self):
       ndb.query(Car.owner_key == self.key).count()

   cars_count_prop = ndb.ComputedProperty(cars_count) 
```

这个问题真的分解成如下内容：

1.  写入速度慢了多少，`Owner`因为它有`cars_count_prop`?
2.  阅读`cars_count_prop`比阅读快多少`cars_count`？

或者，换句话说：

1.  读写的渐近计算复杂度（big-O）是多少？
2.  什么是平均案例计算复杂度 - 对于[Jay Leno](http://www.jaylenosgarage.com/)`Car`以外的人（即每个实例的少量实例`Owner`）？
3.  读写的等待有多少计算复杂度，数据库/memcache查找有多少？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-02-03T16:27:04.887

每次更新所有者实体时，都会重新计算查询。那可不好。查询的复杂性不是问题。但是，如果您真的想知道，则必须对其进行基准测试。

# android - 如何防止我的媒体播放器在我切换活动时停止，而不是在我点击 HOME 时停止？

> ID：14665899
> 
> 赞同：1
> 
> 时间：2013-02-02T19:59:35.157
> 
> 标签：android, android-layout, android-intent, android-activity, android-music-player

我有一个播放音乐的应用程序。（您也可以关闭选项菜单。）

但问题是当你按下主页按钮时，音乐一直在播放，我想在用户按下主页按钮时停止音乐。

我试图将 onPause() 和 onStop() 方法放到 music.stop() 中。但它失败了，因为当我开始一项新活动时，音乐也会停止，但我不希望它停止，只有当按下 Home 按钮时。

我的代码是：

```
@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.options);
     it=(RadioButton)findViewById(R.id.radio0);
     ti=(RadioButton)findViewById(R.id.radio1);
     but=(ToggleButton)findViewById(R.id.toggleButton1);
     music=MediaPlayer.create(Options.this, R.raw.avril);
   mainmenu=new Intent("com.KAYA.ingilizce_gelistirme.BASLANGIC");

    but.setOnClickListener(new View.OnClickListener()   {

        @Override
        public void onClick(View v) {
            if(but.isChecked()) {
                if(!music.isPlaying())
            music.start();
            }
            else
            if(music.isPlaying())
            music.pause();

        }
    });
     it.setChecked(true);
     Button menu=(Button)findViewById(R.id.button1);
     menu.setOnClickListener(new View.OnClickListener() {

        @Override
        public void onClick(View v) {
            startActivity(mainmenu);
        }
    });

}

@Override
public void onBackPressed() {
    // TODO Auto-generated method stub

    startActivity(new Intent(mainmenu));
    }

@Override
protected void onPause() {

    if(music.isPlaying()){
    music.pause();
    music.release();
    }
    but.setChecked(false);

    super.onPause();

}

@Override
protected void onResume() {
    super.onResume();

} 
```

这里是音乐开始播放的选项活动，但是当我通过菜单活动时，音乐也停止了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:06:39.777

我可以建议两种方法

1）让它进入`onPause()`，创建一个默认`flag/boolean`设置为`false``true`的，并且在任何情况下都会出现，例如新的活动启动，后按等。所以如果 onPause 被调用并且标志为假，你可以停止音乐。

2）你已经有背景`service`了，你可以继续检查哪个活动在前台，如果是的话`homeScreen`你可以停止音乐。

编辑：- 知道您的应用程序是否不在前台。正如布赖恩在另一个答案中所建议的那样。看到[这里你可以找到应用程序是前台还是后台](https://stackoverflow.com/questions/3667022/android-is-application-running-in-background)并采取相应的行动

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:07:56.023

You need to launch a separate service to play the music.

## method 1

This method scales better for large applications.

Call the following class periodically (once every 3 seconds, for example) inside your music service to see if your app is in the background. Credit: [check android application is in foreground or not?](https://stackoverflow.com/questions/8489993/check-android-application-is-in-foreground-or-not)

```
class ForegroundCheckTask extends AsyncTask<Context, Void, Boolean> {
    @Override
    protected Boolean doInBackground(Context... params) {
        final Context context = params[0];
        return isAppOnForeground(context);
    }

    private boolean isAppOnForeground(Context context) {
        ActivityManager activityManager = (ActivityManager) context.getSystemService(Context.ACTIVITY_SERVICE);
        List<ActivityManager.RunningAppProcessInfo> appProcesses = activityManager.getRunningAppProcesses();
        if (appProcesses == null) {
            return false;
        }
        final String packageName = context.getPackageName();
        for (ActivityManager.RunningAppProcessInfo appProcess : appProcesses) {
            if (appProcess.importance == ActivityManager.RunningAppProcessInfo.IMPORTANCE_FOREGROUND && appProcess.processName.equals(packageName)) {
                return true;
            }
        }
        return false;
    }
} 
```

## method 2

Next, you need to close your service when you detect that your application has been backgrounded. See here: [Checking if an Android application is running in the background](https://stackoverflow.com/questions/3667022/android-is-application-running-in-background/5862048#5862048). Notice that you don't want to manually override onPause and onResume in every class. You want to use a common ancestor where possible.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-06T03:11:44.730

我发现最好的方法是在你的应用程序类中有一个静态布尔值，称为“活动”或其他东西。当您的任何活动暂停时将其设置为 false，当您的活动恢复时将其设置为 true。然后在 onStop 方法中检查“活动”的状态。如果它是假的，你可以安全地假设用户点击了主页并且没有其他活动开始。在此处关闭媒体播放器。

# vb.net - Excel 与 VB.NET（HRESULT 异常：0x8002000B (DISP_E_BADINDEX)）

> ID：14665903
> 
> 赞同：6
> 
> 时间：2013-02-02T20:00:05.670
> 
> 标签：vb.net, excel

我第一次尝试从 VB.net 创建一个 Excel 文件。我已经添加了 Microsoft.Office.Excel 参考，导入 Microsoft.Office.Interop

```
 Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

    Dim xlApp As Excel.Application
    Dim xlWorkBook As Excel.Workbook
    Dim xlWorkSheet As Excel.Worksheet
    Dim misValue As Object = System.Reflection.Missing.Value

    xlApp = New Excel.ApplicationClass
    xlWorkBook = xlApp.Workbooks.Add(misValue)
    xlWorkSheet = CType(xlWorkBook.Sheets("sheet1"), Excel.Worksheet)
    xlWorkSheet.Cells(1, 1) = "Something here"
    xlWorkSheet.SaveAs("D:\vbexcel.xlsx")

    xlWorkBook.Close()
    xlApp.Quit()
    releaseObject(xlApp)
    releaseObject(xlWorkBook)
    releaseObject(xlWorkSheet)

    MsgBox("Excel file created , you can find the file c:\")

End Sub 
```

错误generetad 在行中：

```
 xlWorkSheet = CType(xlWorkBook.Sheets("sheet1"), Excel.Worksheet)

   Invalid index. (Exception from HRESULT: 0x8002000B (DISP_E_BADINDEX)) 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-02-02T20:11:59.877

也许您的 Excel 版本不会说英语。而“sheet”在当地语言中是一个脏词，它有点用英语;）你的名字暗示英语不是默认语言。使用索引而不是名称来避免这样的事故：

```
 xlWorkSheet = CType(xlWorkBook.Sheets(1), Excel.Worksheet) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-03T07:23:57.470

这也可能发生，因为

```
Workbook.Worksheets.Count 
```

少于您使用的工作表数量，具体取决于您的 Excel 设置。对我来说，它从 3 张纸开始，但对于同事来说，它从 2 张纸开始。

所以你可以打电话

```
Workbook.Worksheets.Add() 
```

达到所需的张数

# android - S Pen 多窗口 SDK Proguard 规则

> ID：14665904
> 
> 赞同：1
> 
> 时间：2013-02-02T20:00:22.253
> 
> 标签：android, proguard, multi-window

使用具有 S Pen SDK 多窗口 jar (2.2.5) 的 proguard 构建 Android 项目时，我收到以下两个警告：

```
[proguard] Warning: android.sec.multiwindow.Constants$WindowManagerPolicy: can't find referenced class android.view.WindowManagerPolicy
[proguard] Warning: android.sec.multiwindow.MultiWindowManager: can't find referenced method 'java.util.List getRunningTasks(int,int,android.app.IThumbnailReceiver)' in class android.app.ActivityManager 
```

通过将以下行添加到我的 proguard 配置文件中，我能够让 proguard 成功运行：

```
-dontwarn android.sec.multiwindow.** 
```

但是，我对忽略警告有点不舒服。在这种情况下，警告引用了 中的类和方法`android.jar`，因此它们将在运行时出现。

我想知道是否还包括proguard规则会很好：

```
-keep class android.sec.multiwindow.** { *; } 
```

在这种情况下，它似乎不会影响构建，但这似乎是个好主意。

有什么想法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-04T01:02:47.190

由于@hide 标记，类和方法可能存在于 Android 运行时中，但它们不存在于 android.jar 中（因此它们不被认可为公共 API）。如果它与 -dontwarn 一起使用，那是可以接受的。更简洁的解决方案是创建一个包含此类、字段和方法的 android.jar 版本。

-keep 选项并不真正影响问题。你可以把它排除在外。

# php - mysql查询中的FIND_IN_SET双重条件

> ID：14665914
> 
> 赞同：2
> 
> 时间：2013-02-02T20:01:15.230
> 
> 标签：php, mysql

我有一张这样的桌子

```
products : id , name , groups , domains 
```

这里的组和域都是逗号分隔的字段。我正在处理现有项目，我无法更改结构。这是细节。

```
groups : id , name
domains : id , name 
```

产品

```
id      |   name    |   groups  |   domains
------------------------------------------------
1       |   A       |   1,2,3   |   0
2       |   B       |   1,2,3   |   0   
3       |   C       |   1,2,3   |   1,2 
4       |   D       |   2,3     |   1,3 
5       |   E       |   2,3     |   2,3 
6       |   F       |   2,3     |   2,3,4   
7       |   G       |   1,2,3   |   0   
8       |   H       |   1,2,3   |   0   
9       |   I       |   2,3     |   1,2,4   
10      |   J       |   3       |   1,3 
11      |   K       |   3       |   2,4 
12      |   L       |   3       |   2,3 
13      |   M       |   1,2,3   |   0   
14      |   N       |   1,2,3   |   0   
15      |   0       |   3       |   1,2,4 
```

域

```
id  |   name
---------------------
1   |   yahoo   
2   |   gmail
3   |   mailinator
4   |   hotmail 
```

团体

```
id  |   name
---------------------
1   |   General 
2   |   Contractor
3   |   Partner 
```

现在我需要选择所有具有这些条件的人。
我如何在哪里选择产品

```
groups : 3
domains : 1 
```

注 0 表示全部（1,2,3,4）

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-02-02T20:04:37.937

很遗憾您无法修改它，并且希望您能够修改 +1。但是你有正确的想法使用`FIND_IN_SET()`. 唯一要考虑的另一件事是考虑（全部）值的`OR`条件。`0`给每个条件满足`FIND_IN_SET()`或等于的选项`0`。

```
SELECT *
FROM products
WHERE (FIND_IN_SET(3, groups)
    OR groups = 0)
    AND (FIND_IN_SET(1, domains)
      OR domains = 0) 
```

[SQL 小提琴演示](http://sqlfiddle.com/#!2/7dc73/4)

# ios - 旋转更改后 UINavigationBar 消失

> ID：14665915
> 
> 赞同：0
> 
> 时间：2013-02-02T20:01:15.950
> 
> 标签：ios, xcode, uiviewcontroller, uinavigationbar, uiinterfaceorientation

我有一个 UIViewController，我正在编程绘制一个 UINavigationBar。它可以在任一旋转中找到，但是当我在绘制 UINavigationBar 后更改旋转时，它就会消失！

这是更改旋转的代码：

```
- (void)didRotateFromInterfaceOrientation:(UIInterfaceOrientation)fromInterfaceOrientation {
    if (CGRectEqualToRect(navBar.frame, CGRectMake(0, 0, 768, 44))) {
        navBar.frame = CGRectMake(0, 0, 1024, 44);
    } else {
        navBar.frame = CGRectMake(0, 0, 768, 44);
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:52:21.323

我从来没有这样做过，所以我在这里建议我从未测试过的东西。

您可以尝试添加`[navBar setNeedDisplay];` 但我认为这不是最好的方法。
我宁愿在[UIViewController上检查这个方法](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIViewController_Class/Reference/Reference.html)

```
- (void)willAnimateRotationToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation duration:(NSTimeInterval)duration 
```

从我所见，您还应该从中获得动画效果：

> **讨论**
> 该方法在用于旋转视图的动画块中调用。您可以覆盖此方法并使用它来配置应在视图旋转期间发生的其他动画。例如，您可以使用它来调整内容的缩放级别、更改滚动条位置或修改视图的其他动画属性。

# javascript - 从带有参数的javascript调用jsp

> ID：14665919
> 
> 赞同：-1
> 
> 时间：2013-02-02T20:01:49.203
> 
> 标签：javascript, jsp, redirect

我在其 onclick() 事件上创建了一个按钮我调用了一个方法

```
<script type="text/javascript">
validate()
{
.....
window.location='reg.jsp';
}
</script> 
```

它不需要文本框的任何值到 reg.jsp 页面

如果我使用`<form action="reg.jsp" method="POST">`它将文本框的值带到下一页，但我不能做要在`validate()`方法中执行的事情

提供一个可能有助于重定向到具有文本框值的下一页的解决方案

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:11:36.020

使用`<form action="reg.jsp" method="POST">`和调用表单的`validate()`函数`onsubmit`。如果表单有效则返回 true，否则返回 false。返回 false from`validate()`将阻止您的表单被提交。

```
<form action="reg.jsp" method="POST" onsubmit="return validate()">
    ...
    ...        
    <input type="submit" value="Submit"> 
</form> 
```

# javascript - 使用范围对象在 Firefox 中设置光标位置将光标锁定到位

> ID：14665920
> 
> 赞同：2
> 
> 时间：2013-02-02T20:01:51.860
> 
> 标签：javascript, contenteditable

我正在尝试将光标放在 contenteditable 节点中的特定字符位置，并且代码在 Chrome 中运行良好。但是在 Firefox 中，当我放置光标时，它会将光标锁定在适当的位置，因此当我键入它时，它会通过从右到左键入来显示（因此键入“hello world”会产生“dlrow olleh”

直到我尝试使用箭头键并意识到它不是处于 RTL 模式，而是锁定光标的位置之前，发生了什么并不明显。不过，退格键似乎确实可以正常工作，当我单击其他位置时，光标会按预期移动并且功能恢复正常。我不确定这是否是 Firefox 中的预期行为，或者我做错了什么。（同样，在 Chrome 中，我可以在放置光标后开始输入，并且行为如我所料）

我最初是用 rangy 写的，但是当它失败时（上面的结果）我尝试使用在[这个评论](https://stackoverflow.com/a/6242538)中找到的代码，粘贴在下面：

```
function getTextNodesIn(node) {
    var textNodes = [];
    if (node.nodeType == 3) {
        textNodes.push(node);
    } else {
        var children = node.childNodes;
        for (var i = 0, len = children.length; i < len; ++i) {
            textNodes.push.apply(textNodes, getTextNodesIn(children[i]));
        }
    }
    return textNodes;
}

function setSelectionRange(el, start, end) {
    if (document.createRange && window.getSelection) {
        var range = document.createRange();
        range.selectNodeContents(el);
        var textNodes = getTextNodesIn(el);
        var foundStart = false;
        var charCount = 0, endCharCount;

        for (var i = 0, textNode; textNode = textNodes[i++]; ) {
            endCharCount = charCount + textNode.length;
            if (!foundStart && start >= charCount
                    && (start < endCharCount ||
                    (start == endCharCount && i < textNodes.length))) {
                range.setStart(textNode, start - charCount);
                foundStart = true;
            }
            if (foundStart && end <= endCharCount) {
                range.setEnd(textNode, end - charCount);
                break;
            }
            charCount = endCharCount;
        }

        var sel = window.getSelection();
        sel.removeAllRanges();
        sel.addRange(range);
    } else if (document.selection && document.body.createTextRange) {
        var textRange = document.body.createTextRange();
        textRange.moveToElementText(el);
        textRange.collapse(true);
        textRange.moveEnd("character", end);
        textRange.moveStart("character", start);
        textRange.select();
    }
} 
```

这会在内容插入到 contenteditable div 后立即调用，以恢复光标位置。

谢谢！

# list - 如何在保留顺序的同时删除列表中的重复元素？

> ID：14665923
> 
> 赞同：6
> 
> 时间：2013-02-02T20:02:23.387
> 
> 标签：list, collections, dart

我刚刚看到[了来自 Seth Ladd 的短视频`Collections`](http://www.youtube.com/watch?v=Mdlnx4cl014&feature=player_embedded&list=PLndbWGuLoHeaPgfKYlwJvDDxCrRdDbga3)。

一个集合只有唯一的元素（没有排序），但有时我需要一个有序列表，我想删除所有重复项（第二次出现的元素，例如字符串应该从列表中删除）

列表的原始输入：`A, B, C, B, D, A` 应该导致`A, B, C, D`. 我需要保持秩序。像这样的结果`B, A, D, C`对我没有帮助。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2018-07-20T22:54:42.273

使用`toSet`然后`toList`

```
 var ids2 = ["A", "B", "C", "B", "D", "A"];
  var result = ids2.toSet().toList();

[A, B, C, D] 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-03T01:12:40.297

Justin Fagnani 已经给出了一个很好的答案。这是另一个：

```
Iterable distinct(Iterable i) {
  var map = new LinkedHashMap();
  i.forEach((x) { map[x] = true; });
  return map.keys;  // map.keys.toList() would free the map for GC.
} 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-02-02T20:57:10.263

自己实现相当容易：

```
Iterable distinct(Iterable i) {
  var set = new Set();
  return i.where((e) {
    var isNew = !set.contains(e);
    set.add(e);
    return isNew;
  }); 
```

`Set.add()`如果返回一个表明该集合是否被修改的布尔值会更好：

```
Iterable distinct(Iterable i) {
  var set = new Set();
  return i.where((e) => set.add(e));
} 
```

您当然可以提交功能请求错误。

编辑：正如弗洛里安指出的那样，上述解决方案仅在返回`Iterable`的仅使用一次时才有效。后续使用将返回`Iterator`没有元素的 s，因为在第一次使用时已经看到了偶数元素。

为了解决这个问题，我们需要为`Iterator`从返回的每个创建的对象保留一个访问集`Iterable`，而不仅仅是为`Iterable`. 我们可以通过使用/创建`Iterable`子`Iterator`类来做到这一点：`WhereIterable``WhereIterator`

```
Iterable distinct(Iterable i) => new DistinctIterable(i);

class DistinctIterable<E> extends Iterable<E> {
  final Iterable<E> _iterable;

  DistinctIterable(this._iterable);

  Iterator<E> get iterator {
    return new DistinctIterator<E>(_iterable.iterator);
  }
}

class DistinctIterator<E> extends Iterator<E> {
  final Iterator<E> _iterator;
  final Set<E> _visited = new Set<E>();

  DistinctIterator(this._iterator);

  bool moveNext() {
    while (_iterator.moveNext()) {
      if (!_visited.contains(_iterator.current)) {
        _visited.add(_iterator.current);
        return true;
      }
    }
    return false;
  }

  E get current => _iterator.current;
} 
```

是的，这要长得多，但它可以与多次使用的有限`Iterable`s 和一次使用的无限`Iterable`s 一起正常工作。无限可迭代用例很容易出现内存问题，这是不将其包含在核心库中的一个论点，并迫使开发人员就他们到底需要什么做出一些决定。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-12-30T06:03:36.923

使用泛型和生成器，您可以创建一个适用于任何类型的 Iterables 的函数

```
Iterable<T> distinct<T>(Iterable<T> elements) sync* {
  final visited = <T>{};
  for (final el in elements) {
    if (visited.contains(el)) continue;
    yield el;
    visited.add(el);
  }
} 
```

的使用`distinct(["A", "B", "C", "B", "D", "A"])`

或者，如果您想将其包装到扩展中：

```
extension IterableDistinctExt<T> on Iterable<T> {
  Iterable<T> distinct() sync* {
    final visited = <T>{};
    for (final el in this) {
      if (visited.contains(el)) continue;
      yield el;
      visited.add(el);
    }
  }
} 
```

的使用`["A", "B", "C", "B", "D", "A"].distinct()`

# javascript - JavaScript 中的电子邮件验证错误

> ID：14665924
> 
> 赞同：-4
> 
> 时间：2013-02-02T20:02:23.307
> 
> 标签：javascript

我是 javascript 新手，无法理解使用 JS 的电子邮件验证。我尝试了一下，但最终出现了一些错误。我的代码如下，请帮助我！希望有一个积极的结果！

```
function validEmail()
{
var email= document.forms["validation"]["enteremail"].value;
var reg = (/^[0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/);
if (reg.test(email) == false )
  {
  alert("Not a valid e-mail address");
  return false;
  } 
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-10-08T13:05:51.467

试试这个，它对我来说很好用......

```
<script type="text/javascript">
 function ShowAlert() {
  var email = document.getElementById('txtEmailId');
  var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
    if (!filter.test(email.value)) {
        alert('Please provide a valid email address');
        email.focus;
        return false;
    }
    else {
        alert("Thanks for your intrest in us, Now you 
        will be able to receive monthly updates from us.");
        document.getElementById('txtEmailId').value = "";
    }
 }
 </script> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:09:53.163

Try:

```
function validEmail()
{
var mail = document.getElementById('mail').value; // where `mail` is id of your input form
var email = /^[\w\-\.\+]+\@[a-zA-Z0-9\.\-]+\.[a-zA-z0-9]{2,4}$/;

  if (mail.match(email))
  {
      alert("Your Email : " + mail);
  }
  else
  {
      alert("Invalid Email !!!");
  }
} 
```

Html:

```
<input type="text=" id="mail"><input type="button" id="k" value="check" onclick="validEmail()"> 
```

`Note`: When you support invalid email it will alert `Invalid Email !!!` otherwise `Your Email : example@gmail.com`

# java - 通过 Callable 传递参数 - Jave，Android

> ID：14665930
> 
> 赞同：2
> 
> 时间：2013-02-02T20:02:56.290
> 
> 标签：java, android, parameter-passing, procedure, callable

我设法使用 Callable 将我的过程传递给另一个类，然后该类在完成后调用它。该类创建了一个 String 的 HashMap，我希望能够将其传递给可调用过程，但我无法弄清楚：S

```
passes the procedure to the class
stockDisplaying = new SQLStatements().LoadAllDrinks(this, new Callable<Integer>() {
            public Integer call() {
                return callWhenDone(null);
           }
        });

the procedure I'm passing I want to be able to send to HashMap to
public int callWhenDone(HashMap<String, String> map){
    Log.d("StockActivity", "omfg this works");
    return 0;
}

Where the class calls the procedure and should send the HashMap
protected void onPostExecute(String file_url) {
        try {
            callWhenDone.call();
        } catch (Exception e) {
            Log.d("LoadAllDrinks", "Exception" + e);
        }
} 
```

# android - Android 开发者 - 如何解决以下谷歌地图教程中的问题

> ID：14665931
> 
> 赞同：1
> 
> 时间：2013-02-02T20:02:59.533
> 
> 标签：android, eclipse, google-maps

我是 android 应用程序开发的新手，想创建一个使用谷歌地图的应用程序。我在这里直接按照谷歌的说明进行操作：[https ://developers.google.com/maps/documentation/android/start](https://developers.google.com/maps/documentation/android/start)

但我在日志中收到以下错误：

```
W/ResourceType( 1984): Bad XML block: header       size 84 or total size 0 is larger than data size 0
W/ResourceType( 1984): Bad XML block: header size 85 or total size 5506544 is larger than data size 0
C:\adt-bundle-windows-x86_64\eclipse\wrkspc\mapappexplore\res\menu\activity_main.xml:3: error: No resource identifier found for attribute 'showAsAction' in package 'android'
C:\adt-bundle-windows-x86_64\eclipse\wrkspc\mapappexplore\res\menu\activity_map.xml:3: error: No resource identifier found for attribute 'showAsAction' in package 'android' 
```

据我所知，我完全按照说明进行操作。这是我的代码：

**MainActivity.java - 最后一行出现错误“R 无法解析为变量”**

```
package com.example.mapappexplore;

import android.app.Activity;
import android.os.Bundle;

public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}
} 
```

**Androidmanifest.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<manifest xmlns:android="http://schemas.android.com/apk/res/android"
package="com.example.mapappexplore"
android:versionCode="1"
android:versionName="1.0" >

<uses-permission android:name="android.permission.INTERNET"/>
<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"/>
<uses-permission android:name="com.google.android.providers.gsf.permission.READ_GSERVICES"/>
<uses-permission android:name="android.permission.ACCESS_COARSE_LOCATION"/>
<uses-permission android:name="android.permission.ACCESS_FINE_LOCATION"/>
<!-- opengl -->
<uses-feature
android:glEsVersion="0x00020000"
android:required="true"/>

<uses-sdk
    android:minSdkVersion="8"
    android:targetSdkVersion="17"/>

    <permission
      android:name="com.example.mapappexplore.permission.MAPS_RECEIVE"
      android:protectionLevel="signature"/>
    <uses-permission android:name="com.example.mapappexplore.permission.MAPS_RECEIVE"/>

<application

    android:allowBackup="true"
    android:icon="@drawable/ic_launcher"
    android:label="@string/app_name"
    android:theme="@style/AppTheme" >

             <activity
             android:name="com.example.mapappexplore.MainActivity"
            android:label="@string/app_name" >

                    <intent-filter> 
                         <action android:name="android.intent.action.MAIN" />
                        <category android:name="android.intent.category.LAUNCHER" />
                    </intent-filter>
             <meta-data
            android:name="com.google.android.maps.v2.API_KEY"
            android:value="AIzaSyAotiEiJVqDsCBYb3pHHhZUMlFz2eWSKTE"/>
             </activity>
</application> 
```

**activity_main.xml**

```
<?xml version="1.0" encoding="utf-8"?>
<fragment xmlns:android="http://schemas.android.com/apk/res/android"
  android:id="@+id/map"
  android:layout_width="match_parent"
  android:layout_height="match_parent"
  class="com.google.android.gms.maps.MapFragment"/> 
```

# c++ - make_shared“证据”与默认构造

> ID：14665935
> 
> 赞同：5
> 
> 时间：2013-02-02T20:03:22.680
> 
> 标签：c++, memory-management, smart-pointers

make_shared 为对象和引用计数器分配单个块。因此，使用这种技术有明显的性能优势。

我在 VS2012 中做了简单的实验，我正在寻找“证据”：

```
std::shared_ptr<Test> sp2 = std::make_shared<Test>();
std::shared_ptr<Test> sp(new Test());
// Test is a simple class with int 'm_value' member 
```

调试时我在当地人看到这样的东西（有些行被删除）

```
-   sp2 shared_ptr {m_value=0 }  [make_shared] std::shared_ptr<Test>
+   _Ptr    0x01208dec {m_value=0 } Test *
+   _Rep    0x01208de0 make_shared  std::_Ref_count_base *

-   sp  shared_ptr {m_value=0 } [default] std::shared_ptr<Test>
+   _Ptr    0x01203c50 {m_value=0 } Test *
+   _Rep    0x01208d90 default  std::_Ref_count_base * 
```

似乎**sp2**分配在**0x01208de0**（有一个 ref 计数器），然后在**0x01208dec**有一个 Test 对象。地点彼此非常接近。

在第二个版本中，我们有**0x01208d90**用于参考计数器，**0x01203c50**用于对象。这些位置相当遥远。

这是正确的输出吗？我理解正确吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-02-02T20:06:55.217

如果您阅读[cppreference 的页面`make_shared`](http://en.cppreference.com/w/cpp/memory/shared_ptr/make_shared)，他们会说：

> 此函数通过单个内存分配为`T`对象和的控制块分配内存。`shared_ptr`相反，该声明`std::shared_ptr<T> p(new T(Args...))`执行两次内存分配，这可能会产生不必要的开销。

所以这是预期的行为，你正确地解释了它。

当然，这是有道理的；如何`shared_ptr`控制您已经分配的对象的分配？使用`make_shared`，你让它负责分配对象，所以它可以在任何它想要的地方分配空间，它就在柜台旁边。

*附录*：正如 Pete Becker 在评论中指出的那样，标准的 §20.7.2.2.6/6 表示鼓励但不要求实现只执行一次分配。因此，不应依赖您观察到的这种行为，尽管可以肯定地说，如果您始终使用`make_shared`.

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-02-02T20:07:45.353

是的，显示的输出是正确的。

在`sp2`, created through的情况下`make_shared<>()`，有一块连续的内存包含引用计数器和分配的对象。这就是两个地址接近的原因，这也是存在的主要原因之一`make_shared<>()`（只执行**一次**分配而不是两次分配）。

`sp`相反，在 的情况下，您通过单独分配对象`new Test()`，然后构造`shared_ptr`对象。的构造函数`shared_ptr`必须为引用计数器发出新的分配。由于这个原因，指向对象的地址和引用计数器的地址是相距甚远的。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-02-02T20:12:42.687

> 这是正确的输出吗？

看起来像。

关键`std::make_shared`是性能 - 动态内存分配相对昂贵，并且仅仅为了保存引用计数器而进行额外分配可能相当浪费。因此，*为*`std::make_shared`对象和计数器分配足够大的内存块，然后在该块中的正确位置初始化对象（使用[放置 new ）。](https://stackoverflow.com/a/222578/533120)

# python - 在构建过程中导入 egg 功能

> ID：14665936
> 
> 赞同：1
> 
> 时间：2013-02-02T20:03:22.800
> 
> 标签：python, buildout, egg

我维护的包中的`setup.py`文件使用另一个包中的代码来构建扩展：

```
from setuptools import setup, find_packages
from mydependence import build_ext
...
setup(
    name='mypackage',
    version='1.0.0',
    ...
    setup_requires = [
      'mydependence', # is this being checked properly?
    ],
    ...
    install_requires = [
      'mydependence',
    ],
    ...
    ) 
```

我想用 构建当前包`zc.buildout`，所以我创建了一个简单的`buildout.cfg`文件，例如：

```
[buildout]
parts = python
eggs = mypackage

[python]
recipe = zc.recipe.egg
interpreter = python
eggs = ${buildout:eggs} 
```

不幸的是，这并没有像我预期的那样工作 - 当我执行`./bin/buildout`和`setup.py`阅读时，它抱怨`mydependence`没有找到。当 buildout 运行 my`setup.py`时，它`sys.path`不知道安装在目录下的包`eggs`（除了`setuptools`它自己！）。显然，“eggs”和“develop-eggs”中`./bin/buildout`的包在运行包的`setup.py`.

问题是：如何使它工作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-13T21:53:44.083

基本问题是`mydependence`您在调用该`setup()`方法之前已经从中导入。我看不出setuptools（或buildout）可以忽略`ImportError`你会得到的。

例如，如果我查看来自[http://pythonhosted.org/py2app/examples.html](http://pythonhosted.org/py2app/examples.html)的一些示例代码，我会看到如下代码：

```
from setuptools import setup
setup(
    app=["MyApplication.py"],
    setup_requires=["py2app"],
) 
```

请注意，没有导入`py2app`. 所以`setup_requires`显然是一种将“扩展”加载到基本 setuptools 功能的方法。这不是规避基本 python 导入错误的方法。

**更新：**请参阅@MartijnPieters 下面的评论，他在[https://stackoverflow.com/a/12061891/27401](https://stackoverflow.com/a/12061891/27401)中有解决方案。

在您的情况下，Martijn 的示例如下所示：

```
import setuptools

setuptools.dist.Distribution(dict(setup_requires='mydependence'))
# `setup_requires` is parsed and acted upon immediately; 
# from here on out the package `mydependence` is installed
# and importable.

from mydependence import build_ext

setup(
    ...
    install_requires = [
      'mydependence',
    ],
    ....
    ) 
```

# objective-c - 向 UITableViewCell 添加属性

> ID：14665937
> 
> 赞同：0
> 
> 时间：2013-02-02T20:03:29.597
> 
> 标签：objective-c, xcode, properties, uitableview, uiviewcontroller

我正在尝试在 UIViewController 中创建 UITableView。我也想创建一些自定义 UITableViewCell。但是，我在试图弄清楚如何将 UILabel 属性添加到 UITableViewCell 时遇到了一些困难。运行代码时出现以下错误...“在'UITableViewCell'类型的对象上找不到属性'_label1'”任何帮助将不胜感激。

.h

```
@interface gideViewController : UIViewController <UITableViewDelegate,     UITableViewDataSource> {
}
@property (nonatomic, strong) IBOutlet UILabel *label1;
@property (nonatomic, strong) NSArray *data; 
```

他们

```
@synthesize label1 = _label1;
@synthesize data = _data;
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
// Return the number of sections.
return 1;
}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
// Return the number of rows in the section.
return [self._data count];
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:     (NSIndexPath *)indexPath
{
static NSString *CellIdentifier = @"TableCell";

UITableViewCell *cell = [tableViewdequeueReusableCellWithIdentifier:CellIdentifier];

if (cell == nil) {
    cell = [[UITableViewCell     alloc]initWithStyle:UITableViewCellStyleDefaultreuseIdentifier:CellIdentifier];
}

//*********** This is where I get the compiler error ... "Property '_label1' not found on object of type 'UITableViewCell'"///
cell._label1.text = [self._data
                       objectAtIndex: [indexPath row]];

return cell;
}

- (void)viewDidLoad{
[super viewDidLoad];
self.data = [[NSArray alloc]
                 initWithObjects:@"ABC",
                 @"DEF",
                 @"XYZ",
                 @"JKY", nil];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:15:27.553

您在哪里创建自定义表格视图单元格？你把它子类化了吗？如果您确实调用了它并将您的子类命名为 MyTableViewCell 然后更改该行

```
UITableViewCell *cell = [tableViewdequeueReusableCellWithIdentifier:CellIdentifier]; 
```

到

```
MyTableViewCell *cell = [tableViewdequeueReusableCellWithIdentifier:CellIdentifier]; 
```

并使用您要在此处使用的单元格标识符注册 MyTableViewCell。无论如何，您可能希望为这些类型的单元格使用另一个标识符。

```
static NSString *CellIdentifier = @"MyTableCell"; 
```

另一种选择是`label1`在创建时将子视图（不是属性！！！）添加到每个单元格。

```
if (cell == nil) {
    // Caution! If you want this line to be executed, then you MUST not register the cell identifier with any cell's class. Because if you register it then the dequeue method will automatically create an object of that class and return it. 
    // Plus you must not create this cell in IB using storyboard because then it is atuomatically registered. (Or do it properly and completely in IB. But then this code sniplet would be redundant) 
    cell = [[UITableViewCell     alloc]initWithStyle:UITableViewCellStyleDefaultreuseIdentifier:CellIdentifier];
    UILabel *label1 = [[UILabel alloc] init];  // I think you could use initWithFrame too for layouting purposes
    [cell.contentview addSubview:label1];
    lable1.tag = 99;   // this is to fetch the label on re-use
    // here you may layout the label, set colors etc.
}
// here you can fetch the label using the tag as identifier and then set its text value 
```

当然，还有更多的实现方式。但是，子类化可能是更明智的选择。

# c++ - 在 C++ 中分隔间隔的数字

> ID：14665942
> 
> 赞同：0
> 
> 时间：2013-02-02T20:03:54.123
> 
> 标签：c++, sorting, input, output

您好，我正在开发一个小程序来整理从文件中提取的数字。目前，我目前的难题是如何将文件中的数字作为整数一次接收一个，或者如何将它们与字符串分开。

```
sample input: 

3 4 6 60 9 10 2 20  
56 11 18
34

output:
3 4 6 60 9 10 2 20 56 11 /*prints out the first 10 numbers taken in then sorts it*/
3 4 6 9 10 11 18 20 56 60 /* after first 10 it looks at the next input then sorts it again*/
4 6 9 10 11 18 20 34 56 60
void Sortingnums(char *nums,int firsttime)
{
    //holds counter and temporary number//
    int i, k, temp;
    //holds temporary c string//
    char* wordnum;
    //just take in the first ten numbers and that is it.
    if(firsttime == 0)
    {
        wordnum = strtok(nums," "); 
        numbers[0] = atoi(wordnum);
        //take in the first 10 numbers in the string//
        for(i = 1; i < 10; i++)
        {
            wordnum = strtok(NULL," "); 
            numbers[i] = atoi(wordnum); //store the number//
        }
        // output the first 10 numbers//
        for(i = 0; i < 10; i++)
        {
            cout << numbers[i] << " " << endl;
        }
        firsttime++;
    }
    while( 
```

下面的示例是我的排序算法，它接受一个 cstring 数组并将其拆分为由空格分隔的整数，但是我遇到的一个问题是前 10 个数字必须在之前打印。

我将如何整理其余的输入？（第一行输入可以有10个以上的数字）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:39:19.160

我试图做到基本和简单，但实际上使用 C++（和基本 C 函数）。

1.  将文件中的所有文本读入 std::string。
2.  通过分隔符“\n”（或“\r\n”，取决于输入）将字符串拆分为“std::vector lines”。（使用 std::string::find()、std::string::substr()）。
3.  循环行，并将每一行分隔符 ' ' 拆分为“std::vector string_numbers”。
4.  循环“string_numbers”并使用 atoi() 将每个 string_number 插入到 std::vector 数字中。
5.  排序（网上有很多算法。冒泡排序很简单，但效率不高 O(n^2)。如果您想实现自己以获得更有效的东西，请查看合并排序 O(nlogn) 或快速排序 O(nlogn ）在一般情况下，更难实现但要快得多）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-04T07:39:41.333

我建议使用标准模板库来帮助您控制数字和排序。另外，我不确定数字 2 和 3 在您的示例输出行中的位置......我假设这是一个错字，您不需要出于某种原因从排序向量中删除这些数字。

无论如何，我会做这样的事情：

```
#include <iostream>
#include <fstream>
#include <vector>
#include <string>
#include <algorithm>

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

using namespace std;

bool mySort(int i, int j) 
{ 
    return (i < j); 
}

void printVector(vector<int> &v)
{
    for (int i = 0; i < v.size(); i++)
        cout << v[i] << " ";

    cout << endl;
}

void getNumbers(string &strNums)
{
    ifstream file("input.txt");
    string line;

    if (file.is_open())
    {
        while (file.good())
        {
            getline(file, line);
            strNums += line + " ";
        }

        file.close();
    }
}

void sortAndPrintNumbers(char *input)
{
    vector<int> vNums, vNumsSorted;
    char * strNum = strtok(input, " ");

    if (strNum)
        vNums.push_back(atoi(strNum));

    while (strNum)
    {
        strNum = strtok(NULL, " ");

        if (strNum)
            vNums.push_back(atoi(strNum));
    }

    // Get first 10 numbers, print them, then sort.
    for (int i = 0; i < 10 && i < vNums.size(); i++)
        vNumsSorted.push_back(vNums[i]);

    printVector(vNumsSorted);
    sort(vNumsSorted.begin(), vNumsSorted.end(), mySort);

    for (int i = 10; i < vNums.size(); i++)
    {
        vNumsSorted.push_back(vNums[i]);
        sort(vNumsSorted.begin(), vNumsSorted.end(), mySort);
        printVector(vNumsSorted);   
    }

    cout << endl;
}

int main()
{
    string strNums;

    getNumbers(strNums);

    char * pNums = new char[strNums.size() + 1];
    strcpy(pNums, strNums.c_str());

    sortAndPrintNumbers(pNums);
    delete [] pNums;
} 
```

字符数组和字符串之间的交换有点混乱，但我不确定你是想使用 Boost 还是只是想看看 strtok 解决方案。此外，您可以指定仅要排序的矢量项的范围，因此可以使用更优雅的解决方案。

干杯

# mysql - 如何在 MYSQL 列中添加多个项目

> ID：14665943
> 
> 赞同：3
> 
> 时间：2013-02-02T20:03:54.797
> 
> 标签：mysql

我目前有一张桌子，上面有一个人的用户名、密码、电子邮件和物品（我的意思是你可以在游戏中收集的物品，也称为“库存”）。但是，如何在 items 列中添加多个项目？例如，如果我想在此处添加项目 A、B 和 C：

![在此处输入图像描述](../Images/e338142b5d49b10675152d40a75892e7.png)

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T20:13:51.780

您应该使用 2 个表来存储这些数据。

```
users: username | password | email
-------------------------
items: username | item 
```

然后，您可以在第二个表中为给定用户名插入无限数量的项目（每个项目都是一条新记录）。

然后，您可以像这样为一个用户选择所有项目：

```
SELECT item FROM items WHERE username = ? 
```

您还可以通过多种方式组合这两个表。

```
/* this one selects all users who have a specific item */
SELECT u.* FROM users u JOIN items i ON u.username = i.username WHERE i.item = ? 
```

**您希望如何使用这些数据？**

您还应该开始使用 ID 值（数字），这样您就不必浪费空间重复基于文本的内容，例如用户名。

* * *

> 我认为这可能是一个非常好的方法，但是你能告诉我你所说的每一项都是新记录是什么意思吗？我还是有点困惑。

您可以像这样插入值：

```
insert into items values ('jonathan', 'hat');
insert into items values ('jonathan', 'drink');
insert into items values ('jonathan', 'mouse');
insert into items values ('user1981730', 'hat');
insert into items values ('user1981730', 'mouse'); 
```

这将导致：

![](../Images/bfde6d62003e5a385673077e8a7f4071.png)

然后您可以查询所有将**饮料**作为商品的用户：

```
SELECT u.* FROM users u JOIN items i ON u.username = i.username WHERE i.item = 'drink' 
```

![](../Images/0c31ae64e05c94100e9bc7ddd975431e.png)

然后获取**user1981730**获得的所有项目的列表：

```
SELECT item FROM items WHERE username = 'user1981730' 
```

![](../Images/0aaa0dbff291fd7a5ae27d6cf5e1b946.png)

一旦您对此感到满意，我们就可以讨论添加 ID 列。

* * *

> ID 列是什么意思？

请注意，在上面的示例中，项目表有很多重复信息。用户名**jonathan**重复 3 次，项目**hat**重复两次。对于真正的数据库，情况会更糟。

我们可以通过使用整数 ID 来表示每个唯一值来节省空间并提高性能。每个用户都有一个 ID，每个唯一的项目也有一个 ID。

让我们从用户开始。我们必须将新列添加到 users 表中。

![](../Images/ea55d80cd047784140eb7aefe0674b43.png)

我们将其设置为**PRIMARY KEY**，这将确保所有值都是唯一的，因此没有 2 个用户可以拥有相同的 ID。我们还可以使用**AUTO_INCREMENT**让值随着每条新记录自动增加。

![](../Images/d4a803a6d47f15d561229fb38c099f50.png)

![](../Images/4000440f626653e0e5602f7833193af8.png)

然后我们将更改我们的项目表，以便它使用新列而不是用户名。

![](../Images/4e6772538ab6185c31ec6921f539f036.png)

请注意我们如何仍然拥有与以前相同的信息。ID 号 1 的用户拥有饮料、帽子和鼠标，ID 号 2 的用户拥有帽子和鼠标。

我们仍然可以像以前一样执行相同的查询（稍作改动）。

```
/* this selects all the items for a known user_id */
SELECT item FROM items WHERE user_id = ?

/* this selects all the items for a user when we only know the username */
SELECT i.item FROM items i JOIN users u ON u.user_id = i.item_id WHERE u.username = ?

/* this one selects all users who have a specific item */
SELECT u.* FROM users u JOIN items i ON u.user_id = i.user_id WHERE i.item = ? 
```

到目前为止，我们只修改了表格以避免重复用户名。如果我们还想避免重复项目名称，我们可以添加一个额外的表。这开始变得棘手，所以我不会（现在）详细介绍，但表结构如下：

```
users: username | password | email
-------------------------------
items: item_id | name
-------------------------------
users_items: user_id | item_id 
```

**users**表和以前一样。**items**表有一个新角色，它存储所有唯一项目。**users_items**表现在链接其他 2 个表。

* * *

我将在这里结束 SO 答案。如果您有任何其他问题，可以通过上面列出的地址（示例表中使用的地址）给我发送电子邮件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:09:02.763

在单独的表格中为每个项目创建一行。

```
INSERT INTO items (userid, item) VALUES
(1, 'item number 1'),
(1, 'item number 2'),
(1, 'item number 3'); 
```

**不要**将所有项目放在用户表中的一行中。JSON、逗号分隔值和其他技术可能听起来很诱人，但它们并不是真正的解决方案。如果您在专门用于跟踪它们的表中的每个项目都有一行，那么您的 SQL 和逻辑将*更加简单和清晰。*

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:09:29.267

你有几个选择。要么（如果用例足够简单），只需编码多个值，例如，用逗号分隔。

但是，干净的方法是使用另一个表，您在其中为每个项目创建一个条目，并有一个指向您的第一个表的外键。

# ios - 赋值给只读属性错误iOS 6

> ID：14665946
> 
> 赞同：0
> 
> 时间：2013-02-02T20:04:05.290
> 
> 标签：ios, objective-c, properties, ios6, attributes

我有一个名为 Constants 的 Singleton 类，我需要在其中设置一些应用程序范围的常量。我希望这些常量是只读的。所以我在 Constants.h 文件中做了以下

```
 @interface Constants : NSObject
 {

 }

 @property (nonatomic, readonly)double U_LAT;
 @property (nonatomic, readonly)double U_LNG; 
```

然后在我的 .m 文件中我得到了这个方法

```
 -(id)init
 {
     self = [super init];

     self.U_LAT = 49.2765;
     self.U_LNG = -123.2177;

     return self;
 } 
```

我从这段代码中得到这个错误：

```
 Assignment to readonly property 
```

我不能在 init 方法中初始化我的只读变量吗？如果不是，我该如何初始化它们？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-02-02T20:09:38.970

`self.propertyName = val;`与`[self setPropertyName:val];`-- 它需要一个 setter 方法存在。只读属性没有 setter 方法。

您可以设置直接支持该属性的 ivar，但是：

```
-(id)init
 {
     self = [super init];

     _U_LAT = 49.2765;
     _U_LNG = -123.2177;

     return self;
 } 
```

如果您允许自动合成属性，则 ivar 的名称将是带有下划线前缀的属性名称。如果您有一个明确`@synthesize propName;`的 ，则 ivar 将具有相同的名称。您还可以使用您喜欢的任何名称创建变量，再次使用 synthesize 语句：`@synthesize cat = dog;`

该属性也可以是公开只读的，但可以由类写入；这涉及在类扩展中声明 setter 方法或在扩展[中重新声明属性](https://stackoverflow.com/questions/5008060/objective-c-property-that-is-readonly-publicly-but-has-a-private-setter?rq=1)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2013-02-02T20:13:51.657

我认为更好的方法是在私有接口中重新声明属性，如下所示：

```
// .h

@interface Constants : NSObject
@property(nonatomic, readonly) double U_LAT;
@end

// .m

@interface Constants ()
@property(nonatomic, readwrite) double U_LAT;
@end 
```

是的，在 inits 和 dealloc 中，直接将变量称为 _U_LAT。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T06:46:02.730

最好不要将它们声明为属性，而是声明为常量。

在`.h`文件中，在 上面添加以下代码`@interface`：

```
extern double const U_LAT;
extern double const U_LNG; 
```

然后在`.m`文件中，在上面添加以下代码`@interface`：

```
double const U_LAT = 49.2765;
double const U_LNG = -123.2177; 
```

`U_LAT`和将`U_LNG`可用于任何导入的类，`Constants.h`您不必处理属性或接口。

正是为了这种东西`const`被发明出来的。

# html - 对于长内容，内联块不能按预期工作？

> ID：14665952
> 
> 赞同：2
> 
> 时间：2013-02-02T20:04:50.697
> 
> 标签：html, css

我有两个要内联的 div（一个在左侧，一个在右侧）。右边的包含一行文本。我希望它始终是单行文本，并在必要时省略。我不能正确地进行内联，因为当我的文本太长时，右侧的 div 会跳到左侧的下方。例子：

```
<!doctype>
<html>

<head>
    <style type="text/css">
    #panelLeft {
      display: inline-block;
      width: 50px;
      height: 20px;
      background-color: #f00;
    }
    #panelRight {
      display: inline-block;
      background-color: #0f0;
      /* width: 200px; */ works ok if explicitly sized
    }
    #test {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    </style>
</head>

<body>
    <div id="panelLeft">
    </div>
    <div id="panelRight">
        <div id="test">
            This is some text that's longer than usual and that I'd like to have ellipsized, and forced to a single line, always.
        </div>
    </div>
</body>      
</html> 
```

[http://jsfiddle.net/JEQPL/1/](http://jsfiddle.net/JEQPL/1/)

相反，如果我为 panelRight 指定宽度（等于或小于剩余空间），则我的 div 位于同一行，并且省略号显示正确。当我不知道 panelRight 的确切宽度时，如何让它工作？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:11:00.330

而不是 inline-block 我会考虑浮动左列并调整右列边距以弥补左列所需的空间。

这是我通常使用的技术的一个小提琴：http: [//jsfiddle.net/q3rEX/](http://jsfiddle.net/q3rEX/)

的HTML：

```
<div class="left">Left Bar</div>
<div class="right">There is a bunch of text in here and I don't want it to jump down a line cause that stinks!</div> 
```

和CSS：

```
.left { float: left; width: 25%; background: red; }
.right { margin-left: 25%; background: green; } 
```

然后你可以将你的文本换行预防、省略号等应用到`.right`拨号中。

这也有一些好处，因为一些旧浏览器不支持 inline-block。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:15:25.340

将它们都放在**带有**.`position:relative;`

```
<div id="parentDiv">
    <div id="panelLeft">
    </div>
    <div id="panelRight">
         <div id="test">
         </div>
    </div>
</div> 
```

然后给`#panelRight`a `position:absolute;`。

```
#parentDiv
{
    position:relative;
}
#panelRight
{
    position:absolute;
    right:0px;
    left:60px; // #panelLeft has a width of 50px, so change it the way you like.
} 
```

看看：http: [//jsfiddle.net/AliBassam/BpQqu/](http://jsfiddle.net/AliBassam/BpQqu/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-02T20:14:59.057

您可以使用以下问题的答案中描述的技术之一将右 div 的宽度设置为 100% 减去左列的宽度： [Is it possible to make a div 50px less than 100% in CSS3?](https://stackoverflow.com/questions/11093943/is-it-possible-to-make-a-div-50px-less-than-100-in-css3)

使用`calc()`：

```
#panelRight {
  display: inline-block;
  background-color: #0f0;
  max-width: calc(100% - 50px);
} 
```

[http://jsfiddle.net/JEQPL/9/](http://jsfiddle.net/JEQPL/9/)

或者，绝对定位：

```
#panelRight {
  display: inline-block;
  background-color: #0f0;
  position: absolute;
  left: 50px;
  right: 0;
} 
```

[http://jsfiddle.net/JEQPL/10/](http://jsfiddle.net/JEQPL/10/)

# jquery - mouseenter 上的 Facebook LikeBox

> ID：14665954
> 
> 赞同：1
> 
> 时间：2013-02-02T20:05:17.177
> 
> 标签：jquery, facebook

我的likebox facebook 以正常方式正常工作。我想以这种方式为性能做：

```
jQuery(document).ready(function(){
jQuery("#facebook-likebox").mouseenter(function(){
jQuery("#facebook-likebox").append('<div style="background: white;" class="fb-like-box" data-href="https://www.facebook.com/xxx" data-width="292" data-height="410" data-show-faces="true" data-colorscheme="light" data-border-color="#197597" data-stream="false" data-header="false"></div>');

});
}); 
```

但它不起作用。页面加载[非异步]时如何关闭likebox fb？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:09:35.087

For this you'll have to load the Facebook JavaScript SDK. Once you have that initialized, you'll be able to call `FB.XFBML.parse()`.

> [Taken from the documentation](https://developers.facebook.com/docs/reference/javascript/FB.XFBML.parse/) -
> 
> This function parses and renders XFBML markup in a document on the fly. This could be used if you send XFBML from your server via ajax and want to render it client side.

So what you would have to do, is on your `mouseenter` event call this function on the element containing the Facebook plugin -

```
FB.XFBML.parse(document.getElementById('facebook-likebox')); 
```

* * *

Once the user has hovered over the area with the plugin, you should simply hide and display it (to preserve functionality). Right now your code would add it every time the mouse enters that area. There is no need to load it more than once.

# android - Android 文件编写器为空

> ID：14665959
> 
> 赞同：-1
> 
> 时间：2013-02-02T20:06:08.353
> 
> 标签：android, nullpointerexception, filewriter

我的应用程序可以收集一些数据，我只想将这些数据输出到 SD 卡中的 txt 文件中。

出于某种原因，以下代码适用于 Galaxy，但不适用于 Nexus。我猜代码有问题。

```
//name of the file
        String name = "rawData " + year +
                "-" + month + "-" + date + "- " + hour + ":" + minute+ ".txt";

        // create a folder stores all the txt file.
        File root = new File(Environment.getExternalStorageDirectory(), "rawData");
        if (!root.exists()) {
            root.mkdirs();
        }

        // creates a file and a file writer
        File gpxfile = new File(root, name);
        FileWriter writer = null;
        try {
            writer = new FileWriter(gpxfile);
            Log.d(TAG, "The writer is created");
        } catch (IOException e1) {
            e1.printStackTrace();
        }

        Log.d(TAG, "Is the writer null? " + writer); 
```

![这是日志猫](../Images/32da8e7ea68635a4b0a1053a6d5e93b6.png)

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:10:38.133

change this

`File root = new File(Environment.getExternalStorageDirectory(), "rawData");`

to `File root = Environment.getExternalStorageDirectory();`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:12:44.083

外部存储通常是 fat32 文件系统，它不允许`:`文件名中包含字符。
顺便说一句，您不需要在使用`mkdirs()`.

# c++ - 升压信号 - 作为参数传递的类型

> ID：14665962
> 
> 赞同：1
> 
> 时间：2013-02-02T20:06:12.927
> 
> 标签：c++, boost, metaprogramming, template-meta-programming, boost-signals

我发现了这个使用升压信号的 C++ 代码，我正在尝试理解它。

```
// A boost::signal wrapper structure 
template <typename Signature>
struct SignalBase : public boost::noncopyable
{
    typedef boost::function_traits< Signature >        SignatureTraits;

    typedef boost::signal<Signature>                   SignalType;
    typedef typename SignalType::slot_function_type    SlotFunctionType;
    typedef typename SignalType::result_type           ResultType;
    typedef boost::signals::connection                 ConnectionType;

    SignalBase() : m_signal() {};
    virtual ~SignalBase() {};

protected:
    SignalType m_signal;
};

// I use a specialization of this template for an arity of 1.
// The template generates the correct function call operator for the arity of the signal.
template<int Arity, typename Signature>
struct SelArity : public SignalBase<Signature> {};

// Specialization
template<typename Signature>
struct SelArity< 1, Signature> : public SignalBase<Signature>
{
    typedef SignalBase<Signature> BaseType;
    inline typename BaseType::ResultType operator()(typename BaseType::SignatureTraits::arg1_type arg )
    {
        return BaseType::m_signal( arg );
    }
}; 
```

我不知道`SelArity`函子会返回什么。据我了解`m_signal`是一种可以声明信号的类型，该信号将能够连接到带有`Signature`签名的函数。怎么可能有类型作为参数？（见`return BaseType::m_signal( arg );`）什么是代表的类型`ResultType`？我将如何使用`SelArity`仿函数返回的对象？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T21:42:12.653

不，`m_signal`不是类型，它是 class 的实例`SignalType`，即`boost::signal<Signature>`.

`SelArity`functor 实际上`m_signal`使用 1 个参数调用并返回其返回值。

（我不知道所有这些包装器需要什么。）

# c++ - 使用 stringstream 从指定位置或标签开始标记字符串

> ID：14665964
> 
> 赞同：0
> 
> 时间：2013-02-02T20:06:21.493
> 
> 标签：c++, string, parsing, stringstream

我正在使用解析器来解析网格文件（已转换为字符串）以制作简单的 2D 图形。这是文件格式的示例（有多个这样的网格构成文件）：

```
# left ladder pole
begin_mesh
dimension   2 2
begin_vertices
-0.3  0.85
-0.2  0.85
-0.3 -0.85
-0.2 -0.85
end_vertices
end_mesh 
```

'#' 表示注释行的开头，您可以看到 begin_mesh 和 begin_vertices 关键字显示 x 和 y 值的开头。

所以基本上我想解析和标记'begin_vertices'和'end_vertices'之间的空白之间的顶点x和y值（数字）。有没有办法使用 stringstream （或可能的其他字符串函数）来做到这一点？我有更多使用字符串函数的经验，但由于空格和数字的长度不同，我遇到了这些问题。

任何帮助表示赞赏，谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:27:26.083

如果我正确理解您想要实现的目标，那么是的，您可以`istringstream`像从文件中一样使用从字符串中读取输入。以下程序显示了您将如何解析您提供的输入：

```
#include <vector>
#include <string>
#include <sstream>
#include <iostream>

using namespace std;

struct point
{
    double x = 0;
    double y = 0;
    friend istream& operator >> (istream& is, point& p)
    {
        is >> p.x;
        is >> p.y;
        return is;
    }
};

template<typename InputStream>
void parse_vertices(InputStream& is, vector<point>& v)
{
    point p;
    while (is >> p)
    {
        v.push_back(p);
    }
} 
```

上面的函数是通用的，这意味着它同样适用于字符串流或文件流。假设您想从字符串中读取输入，这就是您调用它的方式：

```
int main()
{
    string s =
        R"(-0.3  0.85
        -0.2  0.85
        -0.3 -0.85
        -0.2 -0.85
        )";

    istringstream is(s);

    vector<point> vertices;
    parse_vertices(is, vertices);

    for (point const& p : vertices)
    {
        cout << p.x << " " << p.y << endl;
    }
} 
```

希望这可以帮助。

# linux - how to read data on each line in a file and and determine which one of the data correspond to a bench mark in a shell script

> ID：14665969
> 
> 赞同：0
> 
> 时间：2013-02-02T20:07:05.370
> 
> 标签：linux

I have a file with many lines of different data. I want to read each data on each line and determine which of them correspond to the bench mark. i.e

```
-0.002345
-0.109873
 0.0
-2.04555
-0.00001
 0.34444
 0.89999 
```

and the bench mark is (+ or -) 0.00001.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-02T20:15:54.927

假设您的文件由以下行组成：

```
-0.002345 -0.109873  0.0 -2.04555 -0.00001  0.34444  0.89999 
```

并且您想找到`inputfile`完全相同的每一行，例如可以使用`awk`. 一个非常快速和肮脏的解决方案可能看起来像这样：

```
awk '{if($1=="-0.002345" && $2=="-0.109873" && $3=="0.0" && $4=="-2.04555" && $5=="-0.00001" && $6==" 0.34444" && $7=="0.89999"){ print $0 } }' inputfile > outputfile 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:19:09.547

您可以使用`grep`. 如果您只想要每个文件的第一行，则可以指定`-m`选项：

```
grep -m1 '^[- ]0.00001' files 
```

# c - Flex：使用文本文件作为输入流

> ID：14665976
> 
> 赞同：8
> 
> 时间：2013-02-02T20:08:09.850
> 
> 标签：c, lex, flex-lexer

所以我使用 flex 从我的 lex 代码生成 ac 文件，然后使用 gcc 创建相应的实际解析器 .exe。但是，我不知道如何让它从我自己输入的输入之外的任何东西中读取。我试图让它解析一个巨大的字典文件。任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-02-02T20:22:23.813

你有两种解决方法。第一种是使用命令提示符`<`操作从标准输入重定向输入：

```
> parser.exe < some_file.txt 
```

另一种解决方案是让程序打开文件，并告诉词法分析器文件是什么。有关它的更多信息，请参阅[Flex 手册](http://westes.github.io/flex/manual/Multiple-Input-Buffers.html)。重要的函数是`yy_create_buffer`和`yy_switch_to_buffer`。

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-10-29T12:34:48.903

尝试将以下代码添加到您的 *.l 文件中。

```
int main(int argc, char *argv[])
{
    yyin = fopen(argv[1], "r");
    yylex();
    fclose(yyin);
} 
```

* * *

## 回答 #3

> 赞同：9
> 
> 时间：2017-04-25T04:16:01.793

在@Eliko 的上述答案中添加，在将 flex 与 yacc/bison 一起使用时，您可以`FILE *yyin;`在 Grammar.y 文件的全局部分中进行定义。生成的 lex.yy.c 中的定义是`extern FILE *yyin`默认的。因此，在您的 中`grammar.y`，执行以下操作：

```
/* Some other global definitions */
FILE *yyin;
%%
/* Grammar rules*/
/* Grammar rules*/
%%
void main(int argc, char **argv) {
  /* Process command line args*/
  yyin = fopen("input.c", "r");
  yyparse();
  fclose(yyin);
  return 0;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-28T21:48:07.523

在**.l文件所在文件夹中的****UBUNTU** Position 终端中，然后键入以下内容：

 **```
flex nameOfFile.l 
```

然后

```
gcc lex.yy.c 
```

然后`./a.out <nameOfFileYouWantToPass.extension`（例如`./a.out <test.txt`）

**.l**文件和**test.txt**应该在同一个文件夹中**

# c++ - Atomic variables on gcc 4.4.6 are extremely slow

> ID：14665977
> 
> 赞同：2
> 
> 时间：2013-02-02T20:08:22.227
> 
> 标签：c++

i am using gcc 4.4.6 and atomics can be accessed by `#include <cstdatomic>` . After using them, i realized they are very very slow. Finally i came across a post on stackoverflow, which describes it here [Why is std::atomic<bool> much slower than volatile bool?](https://stackoverflow.com/questions/13135834/stdatomicbool-is-very-slow)

But i am not able to follow it. Can someone please help me understand that post or explain why atomics in gcc4.4.6 are so slow?

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:17:07.897

我相信 gcc-4.4 很早就支持原子。gcc 中的原子最近在 gcc-4.7 中进行了重新设计。我相信这是第一个版本，其中不同的硬件目标能够使用特定于硬件的高效内置函数。在 gcc-4.8 中提供了一个 libatomic。在 4.7 和 4.8 的过程中，各种平台都升级了它们的原子支持。[wiki](http://gcc.gnu.org/wiki/Atomic/GCCMM)解释了使用原子时各种内存模型的一些优化权衡。

基本上，gcc-4.4 有点早。IIRC 甚至原子的标准规范也通过 gcc-4.7 不断变化。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:29:04.930

我`__sync_*`在 4.6.3 中使用了这些函数，并没有注意到任何明显的缓慢，生成的汇编代码也没有显示任何异常。我刚刚更新了我曾经使用`__sync_fetch_and_add`过的项目`std::atomic<>::fetch_add()`——尽管它不经常调用原子函数，但我的代码完全没有区别——在代码的单线程或多线程运行中。所以我同意前面的回答：换一个新`gcc`的，它应该会自行修复。

# php - 为什么 PHP Trait 不能实现接口？

> ID：14665978
> 
> 赞同：88
> 
> 时间：2013-02-02T20:08:29.177
> 
> 标签：php, oop, interface, traits

我想知道为什么 PHP Trait (PHP 5.4) 不能实现接口。

**从 user1460043 的答案更新 => ...不能要求使用它来实现特定接口的类**

我知道这可能很明显，因为人们可能认为如果 a`Class A`正在使用 a `Trait T`which 正在实现 an `interface I`，那么 the`Class A`应该是非直接实现的`interface I`（这不是真的，因为`Class A`可以重命名 trait 方法）。

就我而言，我的特征是从使用该特征的类实现的接口调用方法。

trait 实际上是接口某些方法的实现。所以，我想在代码中“设计”每个想要使用我的特性的类都必须实现接口。这将允许 Trait 使用接口定义的类方法，并确保它们存在于类中。

* * *

## 回答 #1

> 赞同：108
> 
> 时间：2013-02-14T01:13:57.753

真正简短的版本更简单，因为你不能。这不是 Traits 的工作方式。

当您用`use SomeTrait;`PHP 编写代码时，您（有效地）告诉编译器将代码从 Trait 复制并粘贴到正在使用它的类中。

因为在`use SomeTrait;`类内，它不能添加`implements SomeInterface`到类中，因为它必须在类外。

> “为什么 PHP 中没有 Traits 类型？”

因为它们不能被实例化。特征实际上只是一种[语言结构](https://stackoverflow.com/q/1180184/778719)（告诉编译器将特征代码复制并粘贴到此类中），而不是代码可以引用的对象或类型。

> 所以，我想在代码中“设计”每个想要使用我的特性的类都必须实现接口。

这可以使用一个抽象类来强制执行`use`，然后从它扩展类。

```
interface SomeInterface{
    public function someInterfaceFunction();
}

trait SomeTrait {
    function sayHello(){
        echo "Hello my secret is ".static::$secret;
    }
}

abstract class AbstractClass implements SomeInterface{
    use SomeTrait;
}

class TestClass extends AbstractClass {
    static public  $secret = 12345;

    //function someInterfaceFunction(){
        //Trying to instantiate this class without this function uncommented will throw an error
        //Fatal error: Class TestClass contains 1 abstract method and must therefore be 
        //declared abstract or implement the remaining methods (SomeInterface::doSomething)
    //}
}

$test = new TestClass();

$test->sayHello(); 
```

但是 - 如果您确实需要强制使用 Trait 的任何类都具有特定的方法，我认为您可能正在使用应该首先是抽象类的特征。

或者你的逻辑错误。您的意思是要求实现接口的类具有某些功能，而不是如果它们具有某些功能，则必须将自己声明为实现接口。

**编辑**

实际上，您可以在 Traits 中定义抽象函数来强制类实现该方法。例如

```
trait LoggerTrait {

    public function debug($message, array $context = array()) {
        $this->log('debug', $message, $context);
    }

    abstract public function log($level, $message, array $context = array());
} 
```

然而，这仍然不允许您在 trait 中实现接口，并且仍然闻起来像一个糟糕的设计，因为在定义类需要履行的契约方面，接口比 trait 好得多。

* * *

## 回答 #2

> 赞同：28
> 
> 时间：2017-07-21T23:16:18.410

有一个[RFC: Traits with interfaces](https://wiki.php.net/rfc/traits-with-interfaces)建议将以下内容添加到语言中：

```
trait SearchItem implements SearchItemInterface
{
    ...
} 
```

接口所需的方法可以由 trait 实现，也可以声明为抽象，在这种情况下，期望使用 trait 的类实现它。

该语言当前不支持此功能，但正在考虑中（RFC 的当前状态是：*正在讨论*中）。

* * *

## 回答 #3

> 赞同：10
> 
> 时间：2016-08-11T13:16:40.017

> [...] 在代码中“设计”每个想要使用我的特性的类都必须实现接口。这将允许 Trait 使用接口定义的类方法，并确保它们存在于类中。

这听起来很合理，我不会说你的设计一定有什么问题。考虑到这个想法，已经提出了特征，请参见此处的第二点：

> *   特征*提供*了一组实现行为的方法。
> *   特征*需要*一组方法作为所提供行为的参数。
> *   [...]

[Schärli 等人，特征：行为的可组合单位，ECOOP'2003，LNCS 2743，第 248-274 页，Springer Verlag，2003，第 2 页](http://scg.unibe.ch/archive/papers/Scha03aTraits.pdf)

*所以说你想要一个特性需要*一个接口，而不是“实现”它可能更合适。

我看不出为什么在 PHP 中不可能有这个“特征需要（它的消费者类来实现）接口”特性，但目前它似乎缺失了。

正如@Danack 在他的[回答](https://stackoverflow.com/a/14866251/1460043)中指出的那样，您可以在特征中使用抽象函数来从使用该特征的类中“要求”它们。不幸的是，您不能使用[私有函数](https://stackoverflow.com/q/7939199/1460043)来做到这一点。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2019-05-16T01:16:19.093

我同意@Danack 的回应，但我会补充一点。

> 真正简短的版本更简单，因为你不能。这不是 Traits 的工作方式。

我只能想到少数情况，在这些情况下您的要求是必要的，并且作为设计问题比作为语言失败更明显。试想一下，有这样一个界面：

```
interface Weaponize
{
    public function hasAmmunition();
    public function pullTrigger();
    public function fire();
    public function recharge();
} 
```

已经创建了一个实现接口中定义的功能之一的**特征**，**但**在此过程中使用了**接口**定义的其他功能，容易出现错误，即如果使用该功能的类未实现**接口**，则一切都无法提取扳机

 ******```
trait Triggerable
{
    public function pullTrigger()
    {
        if ($this->hasAmmunition()) {
            $this->fire();
        }
    }
}

class Warrior
{
    use Triggerable;
} 
```

一个简单的解决方案是简单地强制使用**trait**的类也实现这些功能：

```
trait Triggerable
{
    public abstract function hasAmmunition();
    public abstract function fire();

    public function pullTrigger()
    {
        if ($this->hasAmmunition()) {
            $this->fire();
        }
    }
} 
```

所以**trait**并不完全依赖于**interface**，而是实现其功能之一的提议，因为当使用**trait**时，类将要求实现抽象方法。

## 最终设计

```
interface Weaponize
{
    public function hasAmmunition();
    public function pullTrigger();
    public function fire();
    public function recharge();
}

trait Triggerable
{
    public abstract function hasAmmunition();
    public abstract function fire();

    public function pullTrigger()
    {
        if ($this->hasAmmunition()) {
            $this->fire();
        }
    }
}

class Warrior implements Weaponize
{
    use Triggerable;

    public function hasAmmunition()
    {
        // TODO: Implement hasAmmunition() method.
    }

    public function fire()
    {
        // TODO: Implement fire() method.
    }

    public function recharge()
    {
        // TODO: Implement recharge() method.
    }
} 
```

* * *

*请原谅我的英语*******

# python - Extract data from file, process and then next line

> ID：14665979
> 
> 赞同：1
> 
> 时间：2013-02-02T20:08:31.847
> 
> 标签：python, file, nested

I need to read a lines from two files. Extract data from the first line of file A and compare it with each line in file B. When I'm done with file B, I have to read next line in file A and compare it with all lines in file B, and so on ans so forth. I tried to use file.readline(), but when I use a while, it only prints the last line

```
import sys
def ReadFile():
  name1='RoutingTable.txt'
  try:
    arch_table= open(name1,'r')
  except IOError:
      print 'Cannot Open', name1   
      sys.exit()

  while True:
   route=arch_table.readline()
   print route
      if not route:
            break
      pass 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:18:53.007

让你开始的东西：

```
$ cat f1
kalle
trazan
apanzon

$ cat f2
dipsy
poo
laalaa
trazan

$ cat two.py
#!/usr/bin/env python

with open('f1') as fd1:
    for line in fd1:
        with open('f2') as fd2:
            for other_line in fd2:
                if line == other_line:
                    print line 
```

输出：

```
$ ./two.py 
trazan 
```

# mercurial - Mercurial 帖子更新挂钩

> ID：14665980
> 
> 赞同：1
> 
> 时间：2013-02-02T20:08:39.520
> 
> 标签：mercurial, hook, mercurial-hook

有没有办法在更新命令（例如`hg up -r tagName`）之后运行挂钩。

我在钩子方面并没有太多经验，而且似乎大多数指南都是基于后提交、拉取或推送。在一个团队中，我们定期提交和推送，但只有在准备好新版本时才更新这些实例。所以我们只想在需要该工作目录状态时运行一些代码。不是每次提交或推送。

卡皮斯？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:31:36.507

[这本书的章节](http://hgbook.red-bean.com/read/handling-repository-events-with-hooks.html)提到有一个`update`钩子，它应该做你想做的事。

# javascript - 使用 javascript 从 JSON 中动态检索信息

> ID：14665984
> 
> 赞同：0
> 
> 时间：2013-02-02T20:09:22.013
> 
> 标签：javascript, html, ajax, json

我正在尝试从 JSON 对象中获取一系列字符串并将它们连接成一个大字符串。对我来说似乎很明显只使用一个循环，在所述循环的每次迭代中添加每个新字符串。然而，当我实际插入它时，我得到了一些奇怪的错误。

```
TypeError: data.posts[i] is undefined 
```

我通常只是假设不能这样调用它（我是 javascript 新手，所以我的大部分内容都是基于有根据的猜测），但奇怪的是：我打印到 firebug 的日志完全包含预期信息。我可以忍受无法解释的错误，但它不会在网页上显示组合字符串。

```
var data = JSON.parse(d);
var i = 0;
while(i <= data["posts"].length) {
    messages += "<b>" + data["posts"][i]['nickname']
             + ":</b> - " + data["posts"][i]['content'] + "<br>";
    i++;
    console.log(messages);
}
console.log(messages);
$('.post1').html(messages); 
```

我到底在这里想念什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:17:33.937

很难用你的问题来判断这是否是唯一的问题，但看起来你有一个问题。如果数组索引为 0 - n 则长度返回 n+1 并且您的循环应该是

```
while(i < data["posts"].length) { 
```

注意`<`而不是`<=`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T20:28:42.980

我建议使用 for 循环并将整个返回数据块定义为单个集合，例如 data.data。

并使用以下方法：

```
$.ajax(
{
    // Post variable1 to url.
    type : 'post',
    url : 'urlToBackend,
    dataType : 'json',
    data : 
    {
        'variable1' : 'theValue'
    },
    success : function(data)
    {
        var message;
        var reply1;
        var reply2;

        for(var i = 0; i < data.length; i++)
        {
            reply1 = data[i].reply1FromBackend; // Assuming that reply1FromBackend was returned.
            reply2 = data[i].reply2FromBackend; // Assuming that reply2FromBackend was returned.

            message += reply1;
            message += reply2;
        }
        // do something
    },
    complete : function(data)
    {
        // do something
    }
}); 
```

因此，您只需确保 url 有效，后端可以对变量 1 执行某些操作，并且后端会回显 reply1FromBackend 和 replyFromBackend，如下所示：

```
// Receive the posted variable's value if it is set.
$variable1= isset($_POST['variable1']) ? $_POST['variable1'] : false;

// ... do something

$json[] = array
(
    'reply1FromBackend' => 'yo',
    'reply2FromBackend' => 'sup'
);
echo json_encode($json);
flush(); 
```

那有帮助吗？

# ruby-on-rails - Rails 模型测试

> ID：14665991
> 
> 赞同：0
> 
> 时间：2013-02-02T20:09:49.260
> 
> 标签：ruby-on-rails, testing, model

您好我正在使用 rspec 来测试我的用户模型。我只是想知道我所做的是否是测试中的常见做法。为了测试错误消息，我正在做这样的事情

```
 User.create!(users(:first))
    user.update_attributes  email: 'IDon\'tThinkThisIsAValidEmail' 
    user.should_not be_valid
    assert user.errors.messages.include? :email 
```

另外我将如何进行重复测试？调用 full_messages 并测试“电子邮件已被占用”消息？这是一个好习惯吗。我这样做是因为在我的 should_not be_valid 测试通过之前，因为用户名无效，所以这不好。我在做什么是个好主意吗？有更好的测试方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-02T20:16:27.677

你应该看看[shoulda gem](https://github.com/thoughtbot/shoulda)，它有一套有用​​的测试断言，包括唯一性验证：

```
describe User do
  should validate_uniqueness_of(:email)
end 
```

编辑：[这是文档的链接，是一个很好的起点](http://rubydoc.info/github/thoughtbot/shoulda-matchers/master/frames)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-02T20:22:18.643

要验证电子邮件的格式，您可以执行以下操作。请注意，您不必创建用户记录或使用固定装置来编写大多数验证规范。

```
 it "will not allow invalid email addresses" do
      user = User.new(email: 'notAValidEmail')
      user.should have(1).error_on(:email)
    end

    it "will allow valid email addresses" do
      user = User.new(email: 'valid@email.com')
      user.should have(:no).errors_on(:email)
    end 
```

为了验证存在，您可以这样做：

```
 it { should validate_presence_of(:email) } 
```

您可以查看 rspec 文档以获取更多示例：

[https://www.relishapp.com/rspec/rspec-rails/v/2-3/docs/model-specs/errors-on](https://www.relishapp.com/rspec/rspec-rails/v/2-3/docs/model-specs/errors-on)

# php - Concat列，任何想法如何内联数据？

> ID：14665998
> 
> 赞同：0
> 
> 时间：2013-02-02T20:10:40.793
> 
> 标签：php, html-table, concatenation, concat

在 PHP 选择中，有一个表，其中包含每行中的项目列表。

测试我目前拥有的图像。![当前表](../Images/adc597d8466b6163e1098a32e8985c44.png)

正如工作描述所见，每个价格和数量列都有不同的项目，每个项目之间都有一个换行符。我现在发现的问题是，如果工作描述太长，它会进入下一行，与价格和数量列一致。

我尝试了许多嵌套表，但最终都变得混乱并破坏了我目前拥有的奇偶 CSS。所以我一直回到下面的代码。

我的选择：

```
"SELECT DATE_FORMAT(`$quotedate`, '%d-%m-%Y') AS `$quotedate`, `$quoteno`, 
   `$customer`, `$contactname`, CONCAT_WS('\r\r', `$jobdescription1`, 
   `$jobdescription2`, `$jobdescription3`, `$jobdescription4`, `$jobdescription5`,
   `$jobdescription6`, `$jobdescription7`, `$jobdescription8`, `$jobdescription9`,
   `$jobdescription10`) AS `Job Description`, 
    CONCAT_WS('\r\r £', concat('£', `$priceeach1`), `$priceeach2`, `$priceeach3`, 
   `$priceeach4`, `$priceeach5`, `$priceeach6`, `$priceeach7`, `$priceeach8`, 
   `$priceeach9`, `$priceeach10`) AS `Price Each`, 
   CONCAT_WS('\r\r', `$quantity1`, `$quantity2`, `$quantity3`, `$quantity4`,
   `$quantity5`, `$quantity6`, `$quantity7`, `$quantity8`, `$quantity9`, `$quantity10`) 
   AS`Quantity`  
FROM {$table} 
WHERE `$status`=0 $search ORDER BY {$table}.`$quotedate` asc"; 
```

和表：

```
echo "<table id=\"quote_table\"><tr>";
for($i=0; $i<$fields_num; $i++){
$field = mysql_fetch_field($result);
echo "<th>{$field->name}</th>";
}
echo "</tr>";

while($row = mysql_fetch_row($result)){
echo "<tr id=\"data\">";

foreach($row as $cell)
echo nl2br ("<td>$cell</td>");

echo "</tr>";
} 
```

有谁知道我该如何解决这个问题。谢谢

**解决方案** 我使用了 bmewsing 答案的略微修改版本。
所以我使用了没有格式的选择。然后把它放在一个表中，如下所示：

```
while($row = mysql_fetch_array($result))
{
BuildRow($row[$quotedate], $row[$quoteno], $row[$customer], $row[$contactname], 
       $row[$jobdescription1], "£" . $row[$priceeach1], $row[$quantity1]);

if($row[$jobdescription2]){ BuildRow2("", "", "", "", $row[$jobdescription2], "£" . $row[$priceeach2], $row[$quantity2]);}
if($row[$jobdescription3]){ BuildRow2("", "", "", "", $row[$jobdescription3], "£" . $row[$priceeach3], $row[$quantity3]);}
if($row[$jobdescription4]){ BuildRow2("", "", "", "", $row[$jobdescription4], "£" . $row[$priceeach4], $row[$quantity4]);}
if($row[$jobdescription5]){ BuildRow2("", "", "", "", $row[$jobdescription5], "£" . $row[$priceeach5], $row[$quantity5]);}
if($row[$jobdescription6]){ BuildRow2("", "", "", "", $row[$jobdescription6], "£" . $row[$priceeach6], $row[$quantity6]);}
if($row[$jobdescription7]){ BuildRow2("", "", "", "", $row[$jobdescription7], "£" . $row[$priceeach7], $row[$quantity7]);}
if($row[$jobdescription8]){ BuildRow2("", "", "", "", $row[$jobdescription8], "£" . $row[$priceeach8], $row[$quantity8]);}
if($row[$jobdescription9]){ BuildRow2("", "", "", "", $row[$jobdescription9], "£" . $row[$priceeach9], $row[$quantity9]);}
if($row[$jobdescription10]){ BuildRow2("", "", "", "", $row[$jobdescription10], "£" . $row[$priceeach10], $row[$quantity10]);}

}

function BuildRow($qdate, $qno, $cust, $cname, $jobdesc, $priceea, $qty){

if($qdate || $qno || $cust || $cname || $jobdesc || $priceea || $qty) {
echo "<tr class=\"top\">";
echo "<td>$qdate</td>";
echo "<td>$qno</td>";
echo "<td>$cust</td>";
echo "<td>$cname</td>";
echo "<td>$jobdesc</td>";
echo "<td>$priceea</td>";
echo "<td>$qty</td>";
echo "<tr/>";
}
}
function BuildRow2($qdate2, $qno2, $cust2, $cname2, $jobdesc2, $priceea2, $qty2){
if($qdate2 || $qno2 || $cust2 || $cname2 || $jobdesc2 || $priceea2 || $qty2) {
echo "<tr class=\"middle\">";
echo "<td>$qdate2</td>";
echo "<td>$qno2</td>";
echo "<td>$cust2</td>";
echo "<td>$cname2</td>";
echo "<td>$jobdesc2</td>";
echo "<td>$priceea2</td>";
echo "<td>$qty2</td>";
echo "<tr/>";
}
} 
```

然后使用 jQuery 将“奇数”或“偶数”类添加到中间类，具体取决于前一个“顶级”类具有的类。

```
$(document).ready(function(){
$("#quote_table > tbody > tr.top:even").addClass("even");
$("#quote_table > tbody > tr.top:odd").addClass("odd");

$('.middle').each(function(){
var quote_class = $(this).prevUntil(".top").prev(".top").attr("class");
$(this).addClass(quote_class);
$(this).removeClass("top");
}); 
```

![在此处输入图像描述](../Images/8aeba3853fe619d43f04b0fe915422cf.png)

然后我放了：

```
$('tr.middle').hover(function(){
$(this).prevUntil(".top").nextUntil(".top").andSelf().prev().addClass("hover");},
function(){
$(this).prevUntil(".top").nextUntil(".top").andSelf().prev().removeClass("hover");
});

$('tr.top').hover(function(){
$(this).nextUntil(".top").andSelf().not('#add').addClass("hover");},
function(){
$(this).nextUntil(".top").andSelf().removeClass("hover");
}); 
```

这样当鼠标移过它的一部分时，每个“块”都会突出显示。
我只是通过反复试验得到了最终的解决方案，所以可能有更好的方法。
但它有效！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-02T20:59:39.313

不要在您的 SQL 查询中进行格式化（没有换行符或连接）。选择各个属性，然后构建您的表格。每个描述、价格、数量设置的一行。

```
for($i=0; $i<$fields_num; $i++){
$field = mysql_fetch_field($result);
echo "<th>{$field->name}</th>";
}
echo "</tr>";

while($row = mysql_fetch_row($result)){

 //build date, number, customer, name and the first
 //job description, price and qty
 BuildRow($row[$quotedate], $row[$quoteno], $row[$customer], $row[$contactname], 
           $row[$jobdescription1], "£" . $row[$priceeach1], $row[$quantity1]);
 //now build a row/cells for each of the
 //additional description, price, qty in the result row.
 BuildRow("", "", "", "", $row[$jobdescription2], $row[$priceeach2], $row[$quantity2]);
 //etc...
}

function BuildRow($date, $num, $cust, $name, $descrip, $price, $qty){
 //don't build if empty
 if($date || $num || $cust || $name || $descrip || $price || $qty) {
   echo "<tr >";
   echo "<td>$date</td>";
   //etc...
   echo "</tr>";
 }
} 
```

通过一些样式，您应该能够让它看起来像每个引用的“块”。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-02T21:06:07.437

获得相同高度的描述和数量行的最简单方法是使用这样的嵌套表：

```
<style>
    table {border-collapse: collapse; border-spacing: 0;}
    td {vertical-align: top; margin: 0; }
    .outertable td {border: 1px solid black; }
    .inner {border-right: 1px solid black; }
    .innertable td {width: 100px; border-top-style: none; border-bottom-style: none;}
    .innertable td.desc {border-left-style: none;}
    .quantity {border-right-style: none;}
</style>
<table class="outertable">
    <tr>
        <td>02-02-2013</td>
        <td>102</td>
        <td>test</td>
        <td>test</td>
        <td colspan="3" class="holder">
            <table class="innertable">
                <tr>
                    <td class="desc">testtesttest testtesttesttestt esttesttest</td>
                    <td class="price">$1</td>
                    <td class="quantity">1</td>
                </tr>
                <tr>
                    <td class="desc">testtesttest </td>
                    <td class="price">$1</td>
                    <td class="quantity">1</td>
                </tr>
                <tr>
                    <td class="desc">testtesttest esttesttest</td>
                    <td class="price">$1</td>
                    <td class="quantity">1</td>
                </tr>
            </table>
        </td>
    </tr>
    <tr>
        <td>02-02-2013</td>
        <td>102</td>
        <td>test</td>
        <td>test</td>
        <td colspan="3" class="holder">
            <table class="innertable">
                <tr>
                    <td class="desc">testtesttest testtesttesttestt esttesttest</td>
                    <td class="price">$1</td>
                    <td class="quantity">1</td>
                </tr>
                <tr>
                    <td class="desc">testtesttest </td>
                    <td class="price">$1</td>
                    <td class="quantity">1</td>
                </tr>
                <tr>
                    <td class="desc">testtesttest esttesttest</td>
                    <td class="price">$1</td>
                    <td class="quantity">1</td>
                </tr>
            </table>
        </td>
    </tr>
</table> 
```

有关工作示例，请参阅[http://jsfiddle.net/4tJyq/ 。](http://jsfiddle.net/4tJyq/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-02-03T03:39:24.477

在职位描述中使用可折叠样式怎么样？例如，您可以显示前 50 个字符，并允许最终用户单击以查看全文。

看看这个参考：http: [//twitter.github.com/bootstrap/javascript.html#collapse](http://twitter.github.com/bootstrap/javascript.html#collapse)

干杯。