# StackOverflow 问答 13059000-13059999

# jquery - jQuery中的异步foreach

> ID：13059000
> 
> 赞同：2
> 
> 时间：2012-10-24T22:46:20.320
> 
> 标签：jquery, asynchronous, foreach

我想要的是在异步模式下运行代码以获得更快的响应（多线程）。

我有一个带有提要的“源”数组，我想要的是从每个源中获取数据。

我想过这样的事情：

```
$.each(sources, function(key, val) {
    JSON CALL OF EACH SOURCE
} 
```

然后将所有结果分组到一个数组中并显示它们。问题是我希望 json 调用处于异步模式，因为其中一些调用需要一些时间。

如何使用 jQuery 在异步模式下执行“每个”？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T22:50:48.990

使用延迟对象：

```
// get an array of jqXHR objects - the AJAX calls will
// run in parallel, subject to browser limits on the number
// of concurrent connections to each host
var defs = $.map(sources, function() {
    return $.ajax({ url: this });
});

// when they're all done, invoke this callback
$.when.apply($, defs).done(function() {
    // "arguments" array will contain the result of each AJAX call        
    ...
}); 
```

要更改 AJAX 函数以便只`data`返回参数，您可以使用`.pipe()`：

```
var defs = $.map(sources, function() {
    return $.ajax({ url: this }).pipe(function(data, text, jqxhr) {
        return data;  // filtered result 
    });
}); 
```

# javascript - 骨干木偶视图结构

> ID：13059001
> 
> 赞同：4
> 
> 时间：2012-10-24T22:46:21.800
> 
> 标签：javascript, oop, backbone.js, marionette

我有一个基于 Backbone 的应用程序。由于它变得越来越复杂，我正在评估向 Marionette 的迁移，但我不确定如何构建我的观点。

现有应用程序视图的结构如下：

```
BaseView = Backbone.View.extend({ ... }) 
```

BaseView 是所有视图的根。它基本上有一个带有基本内容的*渲染*功能，例如：模板渲染、页面本地化、活动菜单选择等

```
ListView = BaseView.extend({ ... }) 
```

这里的*render*方法包​​含所有列表的通用代码，例如加载和使用 DataTables 插件、edititem、additem、deleteitem 的通用事件等

```
FormView = BaseView.extend({ ... }) 
```

它使用 Backbone.ModelBinder 插件管理通用表单并处理表单验证。

我所有的应用程序视图都从上述之一扩展，以提高代码的可重用性。例如，我有一个从 FormView 扩展的 AccountFormView，其中我只有特定的逻辑（几行代码）来处理帐户信息。所有的共同逻辑都继承自父母的观点。

如何使用 Marionette Views 获得类似的东西？

谢谢，法布里齐奥

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T03:09:22.567

Marionette 的视图旨在处理最常见的情况，并从解决这些常见问题中删除所有样板代码：

*   视图：可用于构建其他视图的基础视图
*   ItemView：使用模板渲染单个模型
*   CollectionView：使用指定的渲染集合中的每个模型`itemView`
*   CompositeView：将模板渲染为集合视图的包装器。支持的嵌套/层次结构

在您的情况下，听起来您将使用这些视图类型的组合，具体取决于您所处的特定场景。但是，您不会总是从单一视图类型扩展，而是选择一个对当前场景最有意义并从中扩展。

如果您正在寻找一种将您自己的自定义功能添加到所有视图的方法，这也很容易 - 只需将该功能添加到基本 Marionette.View 或 Backbone.View ，它就可以用于所有 Marionette 视图。

一定要检查文档和代码（它被分成许多小文件，所以很容易阅读和理解），看看 Marionite 为您提供了哪些方法，以及它还提供了哪些扩展点。

希望有帮助。

# php - 如何从管理表单中检索多个复选框的值

> ID：13059002
> 
> 赞同：3
> 
> 时间：2012-10-24T22:46:25.193
> 
> 标签：php, magento

我在后端模块中有一个表单，它使用了一些动态创建的复选框，因此完成了：

```
$allStores = Mage::app()->getStores();
foreach ($allStores as $stores) {
    $store = Mage::app()->getStore($stores);
    $values[] = array('value' => $store->getId(), 'label' => $store->getFrontendName());
}
$fieldset->addField('checkboxes', 'checkboxes', array(
    'label' => 'stuff',
    'name'  => 'boxes',
    'values'=> $values,
)); 
```

现在对于这个特定的示例，我有两个商店，ID 分别为 1 和 2。我假设这将返回一个数组或包含 1、2 或 1 和 2 的字符串值。如果我选​​择两个框，它返回 2，如果我选择商店 ID 2，它返回 2，如果我选择商店 ID 1，它返回 1。如果我不想在这里使用复选框，我需要使用什么来从一个字段中获取多个值？我认为这应该能够做到，或者它也可能是单选按钮。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:08:13.460

检查您的 html 源代码

这可能是你的：

```
<input type="checkbox" name="boxes" value="1">1<br>
<input type="checkbox" name="boxes" value="2">2 
```

这应该是：

```
<input type="checkbox" name="boxes[]" value="1">1<br>
<input type="checkbox" name="boxes[]" value="2">2 
```

我不知道magento，但在黑暗中开枪，我相信您可能需要将代码更改为：

```
$fieldset->addField('checkboxes', 'checkboxes', array(
    'label' => 'stuff',
    'name'  => 'boxes[]',
    'values'=> $values,
)); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T23:10:14.383

需要更改以下行：

```
'name'  => 'boxes[]', 
```

# python - 是否有任何用于计算二项式置信区间的python函数/库？

> ID：13059011
> 
> 赞同：25
> 
> 时间：2012-10-24T22:48:20.520
> 
> 标签：python, statistics

我需要计算 python 脚本中大量数据的二项式置信区间。你知道任何可以做到这一点的python函数或库吗？

理想情况下，我希望在 python 上实现类似[http://statpages.org/confint.html的功能。](http://statpages.org/confint.html)

谢谢你的时间。

* * *

## 回答 #1

> 赞同：48
> 
> 时间：2014-08-08T05:06:22.730

请注意，因为它没有在此处的其他地方发布，[`statsmodels.stats.proportion.proportion_confint`](http://statsmodels.sourceforge.net/devel/generated/statsmodels.stats.proportion.proportion_confint.html)可让您使用多种方法获得二项式置信区间。不过，它只做对称间隔。

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2012-10-25T04:15:26.027

我会说，如果您有选择，R（或其他统计数据包）可能会更好地为您服务。也就是说，如果您只需要二项式置信区间，您可能不需要整个库。这是我最天真的javascript翻译中的功能。

```
def binP(N, p, x1, x2):
    p = float(p)
    q = p/(1-p)
    k = 0.0
    v = 1.0
    s = 0.0
    tot = 0.0

    while(k<=N):
            tot += v
            if(k >= x1 and k <= x2):
                    s += v
            if(tot > 10**30):
                    s = s/10**30
                    tot = tot/10**30
                    v = v/10**30
            k += 1
            v = v*q*(N+1-k)/k
    return s/tot

def calcBin(vx, vN, vCL = 95):
    '''
    Calculate the exact confidence interval for a binomial proportion

    Usage:
    >>> calcBin(13,100)    
    (0.07107391357421874, 0.21204372406005856)
    >>> calcBin(4,7)   
    (0.18405151367187494, 0.9010086059570312)
    ''' 
    vx = float(vx)
    vN = float(vN)
    #Set the confidence bounds
    vTU = (100 - float(vCL))/2
    vTL = vTU

    vP = vx/vN
    if(vx==0):
            dl = 0.0
    else:
            v = vP/2
            vsL = 0
            vsH = vP
            p = vTL/100

            while((vsH-vsL) > 10**-5):
                    if(binP(vN, v, vx, vN) > p):
                            vsH = v
                            v = (vsL+v)/2
                    else:
                            vsL = v
                            v = (v+vsH)/2
            dl = v

    if(vx==vN):
            ul = 1.0
    else:
            v = (1+vP)/2
            vsL =vP
            vsH = 1
            p = vTU/100
            while((vsH-vsL) > 10**-5):
                    if(binP(vN, v, 0, vx) < p):
                            vsH = v
                            v = (vsL+v)/2
                    else:
                            vsL = v
                            v = (v+vsH)/2
            ul = v
    return (dl, ul) 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2013-10-10T00:45:27.677

虽然 scipy.stats 模块有一种`.interval()`计算等尾置信度的方法，但它缺乏计算最高密度区间的类似方法。这是使用 scipy 和 numpy 中找到的方法的粗略方法。

此解决方案还假设您想先使用 Beta 发行版。超参数`a`和`b`设置为 1，因此默认先验是 0 和 1 之间的均匀分布。

```
import numpy
from scipy.stats import beta
from scipy.stats import norm

def binomial_hpdr(n, N, pct, a=1, b=1, n_pbins=1e3):
    """
    Function computes the posterior mode along with the upper and lower bounds of the
    **Highest Posterior Density Region**.

    Parameters
    ----------
    n: number of successes 
    N: sample size 
    pct: the size of the confidence interval (between 0 and 1)
    a: the alpha hyper-parameter for the Beta distribution used as a prior (Default=1)
    b: the beta hyper-parameter for the Beta distribution used as a prior (Default=1)
    n_pbins: the number of bins to segment the p_range into (Default=1e3)

    Returns
    -------
    A tuple that contains the mode as well as the lower and upper bounds of the interval
    (mode, lower, upper)

    """
    # fixed random variable object for posterior Beta distribution
    rv = beta(n+a, N-n+b)
    # determine the mode and standard deviation of the posterior
    stdev = rv.stats('v')**0.5
    mode = (n+a-1.)/(N+a+b-2.)
    # compute the number of sigma that corresponds to this confidence
    # this is used to set the rough range of possible success probabilities
    n_sigma = numpy.ceil(norm.ppf( (1+pct)/2\. ))+1
    # set the min and max values for success probability 
    max_p = mode + n_sigma * stdev
    if max_p > 1:
        max_p = 1.
    min_p = mode - n_sigma * stdev
    if min_p > 1:
        min_p = 1.
    # make the range of success probabilities
    p_range = numpy.linspace(min_p, max_p, n_pbins+1)
    # construct the probability mass function over the given range
    if mode > 0.5:
        sf = rv.sf(p_range)
        pmf = sf[:-1] - sf[1:]
    else:
        cdf = rv.cdf(p_range)
        pmf = cdf[1:] - cdf[:-1]
    # find the upper and lower bounds of the interval 
    sorted_idxs = numpy.argsort( pmf )[::-1]
    cumsum = numpy.cumsum( numpy.sort(pmf)[::-1] )
    j = numpy.argmin( numpy.abs(cumsum - pct) )
    upper = p_range[ (sorted_idxs[:j+1]).max()+1 ]
    lower = p_range[ (sorted_idxs[:j+1]).min() ]    

    return (mode, lower, upper) 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2014-06-13T14:44:46.183

我自己一直在尝试这个。如果它有帮助，这是我的解决方案，它需要两行代码，并且似乎为该 JS 页面提供了等效的结果。这是常客单边区间，我将输入参数称为二项式参数 theta 的 MLE（最大似然估计）。即 mle = 成功次数/试验次数。我找到了单边区间的上限。因此这里使用的 alpha 值是 JS 页面中上限的两倍。

```
from scipy.stats import binom
from scipy.optimize import bisect

def binomial_ci( mle, N, alpha=0.05 ):
    """
    One sided confidence interval for a binomial test.

    If after N trials we obtain mle as the proportion of those
    trials that resulted in success, find c such that

    P(k/N < mle; theta = c) = alpha

    where k/N is the proportion of successes in the set of trials,
    and theta is the success probability for each trial. 
    """

    to_minimise = lambda c: binom.cdf(mle*N,N,c)-alpha
    return bisect(to_minimise,0,1) 
```

要找到两侧区间，请使用 (1-alpha/2) 和 alpha/2 作为参数调用。

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2013-04-21T00:00:21.770

我也需要这样做。我正在使用 R 并想学习一种方法来为自己解决这个问题。我不会说它是严格的pythonic。

文档字符串解释了大部分内容。它假设你已经安装了 scipy。

```
def exact_CI(x, N, alpha=0.95):
    """
    Calculate the exact confidence interval of a proportion 
    where there is a wide range in the sample size or the proportion.

    This method avoids the assumption that data are normally distributed. The sample size
    and proportion are desctibed by a beta distribution.

    Parameters
    ----------

    x: the number of cases from which the proportion is calulated as a positive integer.

    N: the sample size as a positive integer.

    alpha : set at 0.95 for 95% confidence intervals.

    Returns
    -------
    The proportion with the lower and upper confidence intervals as a dict.

    """
    from scipy.stats import beta
    x = float(x)
    N = float(N)
    p = round((x/N)*100,2)

    intervals = [round(i,4)*100 for i in beta.interval(alpha,x,N-x+1)]
    intervals.insert(0,p)

    result = {'Proportion': intervals[0], 'Lower CI': intervals[1], 'Upper CI': intervals[2]}

    return result 
```

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2014-06-03T19:54:19.673

一种使用威尔逊分数和对正常累积密度函数的近似值来计算相同事​​物的无 numpy/scipy 方法，

```
import math

def binconf(p, n, c=0.95):
  '''
  Calculate binomial confidence interval based on the number of positive and
  negative events observed.

  Parameters
  ----------
  p: int
      number of positive events observed
  n: int
      number of negative events observed
  c : optional, [0,1]
      confidence percentage. e.g. 0.95 means 95% confident the probability of
      success lies between the 2 returned values

  Returns
  -------
  theta_low  : float
      lower bound on confidence interval
  theta_high : float
      upper bound on confidence interval
  '''
  p, n = float(p), float(n)
  N    = p + n

  if N == 0.0: return (0.0, 1.0)

  p = p / N
  z = normcdfi(1 - 0.5 * (1-c))

  a1 = 1.0 / (1.0 + z * z / N)
  a2 = p + z * z / (2 * N)
  a3 = z * math.sqrt(p * (1-p) / N + z * z / (4 * N * N))

  return (a1 * (a2 - a3), a1 * (a2 + a3))

def erfi(x):
  """Approximation to inverse error function"""
  a  = 0.147  # MAGIC!!!
  a1 = math.log(1 - x * x)
  a2 = (
    2.0 / (math.pi * a)
    + a1 / 2.0
  )

  return (
    sign(x) *
    math.sqrt( math.sqrt(a2 * a2 - a1 / a) - a2 )
  )

def sign(x):
  if x  < 0: return -1
  if x == 0: return  0
  if x  > 0: return  1

def normcdfi(p, mu=0.0, sigma2=1.0):
  """Inverse CDF of normal distribution"""
  if mu == 0.0 and sigma2 == 1.0:
    return math.sqrt(2) * erfi(2 * p - 1)
  else:
    return mu + math.sqrt(sigma2) * normcdfi(p) 
```

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2021-01-24T17:01:55.920

下面以简单的方式给出了二项分布的精确 (Clopper-Pearson) 区间。

```
def binomial_ci(x, n, alpha=0.05):
    #x is number of successes, n is number of trials
    from scipy import stats
    if x==0:
        c1 = 0
    else:
        c1 = stats.beta.interval(1-alpha, x,n-x+1)[0]
    if x==n:
        c2=1
    else:
        c2 = stats.beta.interval(1-alpha, x+1,n-x)[1]
    return c1, c2 
```

您可以通过以下方式检查代码：

```
p1,p2 = binomial_ci(2,7)
from scipy import stats
assert abs(stats.binom.cdf(1,7,p1)-.975)<1E-5
assert abs(stats.binom.cdf(2,7,p2)-.025)<1E-5
assert abs(binomial_ci(0,7, alpha=.1)[0])<1E-5
assert abs((1-binomial_ci(0,7, alpha=.1)[1])**7-0.05)<1E-5
assert abs(binomial_ci(7,7, alpha=.1)[1]-1)<1E-5
assert abs((binomial_ci(7,7, alpha=.1)[0])**7-0.05)<1E-5 
```

我使用了二项式比例置信区间和正则化不完全 beta 函数之间的关系，如下所述： [https ://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Clopper%E2%80%93Pearson_interval](https://en.wikipedia.org/wiki/Binomial_proportion_confidence_interval#Clopper%E2%80%93Pearson_interval)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2019-07-05T08:49:10.283

Astropy 提供了这样一个功能（虽然安装和导入 astropy 可能有点过分）： [`astropy.stats.binom_conf_interval`](http://docs.astropy.org/en/stable/api/astropy.stats.binom_conf_interval.html#astropy.stats.binom_conf_interval)

# bind - 绑定命名服务高cpu负载

> ID：13059014
> 
> 赞同：7
> 
> 时间：2012-10-24T22:48:39.220
> 
> 标签：bind, cpu-usage, named, nameservers, abuse

CentOs 6 下的命名服务正在使用所有 4 个处理器的 100% 以上。我试图玩弄配置文件。我目前有大约 10 个网站。下面是一个示例

```
$TTL 14400
@       IN      SOA     ns1.mynameserver.com.      hostmaster.mydomain.com. (
                                                2012071300
                                                14400
                                                3600
                                                1209600
                                                86400 )

mydomain.com.   14400   IN  NS  ns1.mynameserver.com.
mydomain.com.   14400   IN  NS  ns2.mynameserver.com.

ftp 14400   IN  A   123.218.168.8
localhost   14400   IN  A   127.0.0.1
mail    14400   IN  A   123.218.168.8
pop 14400   IN  A   123.218.168.8
mydomain.com.   14400   IN  A   123.218.168.8
smtp    14400   IN  A   123.218.168.8
www 14400   IN  A   123.218.168.8

mydomain.com.   14400   IN  MX  10 mail
mydomain.com.   14400   IN  TXT "v=spf1 a mx ip4:123.218.168.8 ~all"

localhost   14400   IN  AAAA    ::1 
```

对于 mynameserver.com

```
$TTL 14400
@       IN      SOA     ns1.mynameserver.com.      hostmaster.mynameserver.com. (
                                                2012081200
                                                14400
                                                3600
                                                1209600
                                                86400 )

mynameserver.com.   14400   IN  NS  ns1.mynameserver.com.
mynameserver.com.   14400   IN  NS  ns2.mynameserver.com.

ftp 14400   IN  A   123.218.168.11
localhost   14400   IN  A   127.0.0.1
mail    14400   IN  A   123.218.168.11
ns1.mynameserver.com.   14400   IN  A   123.218.168.10
ns1.mynameserver.com.   14400   IN  A   123.218.168.11
ns2.mynameserver.com.   14400   IN  A   123.218.168.11
ns2.mynameserver.com.   14400   IN  A   123.218.168.11
pop 14400   IN  A   123.218.168.11
s1  14400   IN  A   123.218.168.11
smtp    14400   IN  A   123.218.168.11
mynameserver.com.   14400   IN  A   123.218.168.11
www 14400   IN  A   123.218.168.11
mynameserver.com.   14400   IN  MX  10 mail
mynameserver.com.   14400   IN  TXT "v=spf1 a mx ip4:123.218.168.8 ~all"
localhost   14400   IN  AAAA    ::1 
```

我更改了 ip 和域，使其成为每个人的普遍问题。事情是我根本不使用邮件或 smtp，我将来可能会添加 MX 记录并依赖 gmail 例如电子邮件。删除 mail/pop/smtp/MX 记录是否安全？

根据您的经验，是什么导致了几个月的巨大 CPU 负载！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-08-19T08:20:49.087

我遇到了同样的问题，上面 Starcalc 发布的链接中的信息对我有用（尽管他链接的帖子是针对 Ubuntu 的）。这是我为我的 CentOS 6.4 机器所做的：

在 /etc/named.conf 中，确保您在 options{} 部分中有该行

```
managed-keys-directory "/var/named/dynamic"; 
```

另外，请确保您有目录 /var/named/dynamic 和 /var/named/chroot/var/named/dynamic 存在，确保所有目录都归 named:named 所有（简单方法：chown -R named:named /var/ named )，如果你使用 SELinux 运行，执行： restorecon -R /var/named/

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-24T14:33:37.073

检查您的 /etc/named.conf 文件是否有**managed-keys-directory "/var/named/dynamic";** 在选项范围内。

然后检查 /var/named 和 /var/named/chroot/var/named 目录下是否存在绑定文件。

停止命名服务

```
#service stop named 
```

检查或创建文件

```
#mkdir /var/named/data
#touch /var/named/data/named.run
#mkdir /var/named/dynamic
#touch/var/named/dynamic/managed-keys.bind 
```

chroot 文件

```
#mkdir /var/named/chroot/data
#touch /var/named/chroot/data/named.run
#mkdir/var/named/chroot/var/named/dynamic
#touch /var/named/chroot/var/named/dynamic/managed-keys.bind 
```

不要忘记更改文件的所有者。

```
#chown root:named -R /var/named/chroot/var/named/d* 
```

启动命名守护进程

```
#service named start 
```

# ipad - 多个 MODAL VIEW 控制器在 ROTATION 后将基本模态更改为 FULL SCREEN

> ID：13059017
> 
> 赞同：7
> 
> 时间：2012-10-24T22:49:08.697
> 
> 标签：ipad, rotation, ios6, modalviewcontroller, screen-size

这一直困扰着我很长一段时间，我对此做了很多研究，但找不到答案。我第一次在这里发布问题，如果我犯了错误，请纠正/原谅我。

环境：iPad、iOS 6.0

问题：旋转后基本模式视图变为全屏。

描述：我有一个正在运行的全屏应用程序，当前显示一个模态视图控制器。从显示模式视图中，我通过执行以下操作显示另一个模式视图：

```
vc.modalPresentationStyle = UIModalPresentationFormSheet;
[self presentModalViewController:vc animated:YES];
//[self presentViewController:vc animated:YES completion:NULL]; 
```

当第二个视图出现时，我旋转了 iPad 设备。基本（第一个）模态视图变为全屏，最上面（第二个）模态视图保持 formSheet 样式。（正确旋转）

我可以通过向 navigationController 添加模态视图来解决此问题，但我想将其保留在模态视图中。

任何人都知道修复？我相信这里的这个人也有同样的问题： [ios 6 Incorrect modal view size after rotation](https://stackoverflow.com/questions/12599621/ios-6-incorrect-modal-view-size-after-rotation)

顺便说一句，iOS 5 中一切正常。Apple 改变了 iOS 6 中的旋转方式。谢谢，-peter

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-02-20T21:12:02.860

我找到了解决这个问题的方法。在呈现之前将最后一个模态视图的呈现样式设置为 UIModalPresentationCurrentContext。

像这样：

vc.modalPresentationStyle = UIModalPresentationCurrentContext; [自我presentModalViewController：vc动画：YES]；

这解决了旋转 iPad 屏幕后基本模式视图更改大小的问题。

最初由[Apple Dev 论坛](http://devforums.apple.com/message/748486)上的人回答。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-24T06:40:57.200

我遇到了完全相同的问题并使用了[iOS 6 中的代码：Parent modal's modalPresentationStyle 在旋转后被忽略，](https://stackoverflow.com/questions/13347906/ios-6-parent-modals-modalpresentationstyle-ignored-after-rotation)就像一个魅力

# soap - AXIS SOAP wsdlPortType

> ID：13059018
> 
> 赞同：0
> 
> 时间：2012-10-24T22:49:09.507
> 
> 标签：soap, wsdl, axis

这些参数有什么作用以及它们的用途是什么？

```
<service name="...">
    <parameter name="wsdlPortType" value="..."/>
</service> 
```

此外，如果有人能解释参数 wsdlServicePort、wsdlTargetNamespace 和 wsdlServiceElement，将不胜感激。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-02-07T22:00:44.937

Axis 1.4 用户指南：

> 当您在 Axis 中部署服务时，用户可以使用标准 Web 浏览器访问您的服务的 URL，并通过在 URL 的末尾附加“?WSDL”，他们将获得一个自动生成的描述您的服务的 WSDL 文档。

实验结果表明，Axis 能够结合使用 .wsdd 部署描述符文件和已编译的 Java .class 文件来为给定服务生成相应的 .wsdl。有趣的是，例如，如果您有一个具有泛型返回类型（如 Map）的公共方法，则生成的 .wsdl 文件将不包含返回类型 - 它将包含“xsd:anyType”。我相信这是由于已编译的 .class 文件上的类型擦除所致。

无论如何，Axis .wsdd 文件中的服务选项（我在问题中引用的参数，例如 wsdlPortType、wsdlServicePort 和 wsdlTargetNamespace）与 .wsdl 规范有关。这可以从名称本身推断出来，因为它们都包含“wsdl”，但我想解释这些参数的含义，但我无法找到相关的 Axis 文档。以下是我的发现：

**wsdlPortType (portType)**：基本上就像一个Java接口。每个方法名称包含一个“操作”元素。每个“操作”都包含“输入”和“输出”元素，它们基本上是 Java 方法的输入参数和返回参数。

**wsdlServicePort (wsdl:binding)**与 portType 相关联。我认为它是对如何传输 portType 参数的描述。规范有这样的说法：

> 绑定描述组件提供了一个框架，用于指示端口类型描述组件的绑定细节。绑定详细信息应该用于指示消息在发送到服务或从服务发送时必须如何格式化。它们还应该用于指示用于发送消息的传输协议。给定的绑定描述组件不得指示多个协议。

**wsdl:service**：其中包含对 wsdl 端口绑定（portType 的实现）的引用。

**目标命名空间：**和我想的差不多（与其他任何地方的命名空间相同）。它适用于所有 wsdl:definitions 组件，因此基本上是 wsdl 文件中的任何内容（wsdl:portType、wsdl:service 等）。不过，您可以在规范中找到其他一些规则。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-02-06T03:26:59.357

问题：使用Service?wsdl 时，生成的wsdl 可能与原始wsdl 的targetNamespace、portType、服务元素名称或服务端口名称不同。此问题已被用户报告，属于 TCK 问题。

解决方案：在deploy.wsdd中添加四个可选参数，由JavaProvider查询（wsdlTargetNamespace、wsdlServiceElement、wsdlServicePort和wsdlPortType）。

```
Here is an example deploy.wsdd with the new parameters. 
```

```
<!-- Services from AddressBookService WSDL service -->

<service name="AddressBook" provider="java:RPC">
    <parameter name="wsdlTargetNamespace" value="urn:AddressFetcher2"/>
    <parameter name="wsdlServiceElement" value="AddressBookService"/>
    <parameter name="wsdlServicePort" value="AddressBook"/>
    <parameter name="className" value="samples.addr.AddressBookSOAPBindingSkeleton"/>
    <parameter name="wsdlPortType" value="AddressBook"/>
    <parameter name="allowedMethods" value="*"/>
    <parameter name="scope" value="Session"/> 
```

来源： http: [//mail-archives.apache.org/mod_mbox/axis-java-dev/200206.mbox/%3C20020621143740.41268.qmail@icarus.apache.org%3E](http://mail-archives.apache.org/mod_mbox/axis-java-dev/200206.mbox/%3C20020621143740.41268.qmail@icarus.apache.org%3E)

# javascript - 仅当窗口缩小时如何启用滚动条？

> ID：13059032
> 
> 赞同：2
> 
> 时间：2012-10-24T22:50:47.843
> 
> 标签：javascript, jquery, html, css

一页网站。顶部带有锚链接的标题到页面上的不同 div（部分）。

假设我的屏幕分辨率为 1280*800，每个 div 部分最大为 800，当我的浏览器为最大尺寸时，每个 div 部分的内容都可见。我忘了提到滚动已禁用，因此其他 div 仅使用顶部的锚链接可见（自动滚动）。所以这就是问题所在，当我调整浏览器的大小时，例如，我的浏览器上只有 450px 的高度，我只能在屏幕上看到这么多的内容，并且无法滚动到 div 的底部，所以它到达了底部我的浏览器。

要理解的另一点是 div 本身的所有元素都不会溢出 div 的高度，因此简单的溢出不起作用，因为问题与浏览器高度的大小有关。

本质上，当浏览器窗口小于 800 像素时，div 会在底部被浏览器减少的量所覆盖。我希望将整个 div（不是其中的内容）向上推（顶部位置），以使 div 的底部（即第 800 个像素）接触浏览器的底部。

有什么解决办法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:06:51.013

您可以收听窗口大小的变化并调整 div 的大小。这样，div 将始终具有窗口的大小，因此如果它变得太小，则会显示溢出。

```
$("div").css("height", $(window).height());
$(​window​).bind("resize",function() {
    $("div").css("height", $(window).height());
});​​​​ 
```

[jsFiddle](http://jsfiddle.net/3vQ2e/)的工作示例。记得将 div 的溢出设置为`auto`，这样当屏幕变得太小时它们就会显示出来。

**更新：**根据我在您的更新中的理解，您的要求可以通过简单的 CSS 来满足。随意`html, body`溢出，但将“容器”`div`的溢出设置为`hidden`（因此一次只会滚动一页）并将其`height`设置为`800px`. 当浏览器窗口调整到小于 800 px 时，会出现 body 的滚动条，让您上下滚动容器 div。容器和内容都将保持相同的大小：800px。

```
html,body {
    overflow: auto;
}

.container, .contents {
    height: 800px;
    overflow: hidden;
} 
```

[jsFiddle](http://jsfiddle.net/3vQ2e/1/)的工作示例。那是你需要的吗？如果您真的想将容器 div 向上推直到其底部与窗口对齐，请尝试设置`padding-top`or`margin-top`代替`top`（尽管在这种情况下我不知道滚动将如何工作）。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T22:59:19.860

使用媒体查询：

```
@media screen and (max-height: 450px) {
  body { overflow: auto; } /* Or change the height or whatever */ 
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:07:55.953

我认为将主包装的最小高度设置为 800px 的最佳解决方案，否则您必须为您的主要内容添加隐藏的溢出。滚动可以通过设置主要内容顶部位置来触发，但必须是绝对的或类似的。你猫写了一个函数，女巫可以帮助你移动主要内容，改变它的顶部位置。

# javascript - 如何使用 google.maps.event.trigger(map, 'resize')

> ID：13059034
> 
> 赞同：18
> 
> 时间：2012-10-24T22:50:50.503
> 
> 标签：javascript, html, google-maps, zurb-foundation

我是 JS 新手，已经找到了上一个问题的答案，这带来了一个新问题，又把我带到了这里。

我有一个包含 Google Map API 的显示模式。单击按钮时，会弹出显示模式，并显示 Google 地图。我的问题是只有三分之一的地图正在显示。这是因为需要实现调整大小触发器。我的问题是如何实现 google.maps.event.trigger(map, 'resize')？我在哪里放置这个小代码片段？

这是我的测试站点。点击谷歌地图按钮查看手头的问题。 [http://simplicitdesignanddevelopment.com/Fannie%20E%20Zurb/foundation/contact_us.html#](http://simplicitdesignanddevelopment.com/Fannie%20E%20Zurb/foundation/contact_us.html#)

显示模型脚本：

```
<script type="text/javascript">
  $(document).ready(function() {
  $('#myModal1').click(function() {
  $('#myModal').reveal();
       });
          });
 </script> 
```

我的谷歌地图脚本：

```
<script type="text/javascript">
 function initialize() {
 var mapOptions = {
 center: new google.maps.LatLng(39.739318, -89.266507),
 zoom: 5,
 mapTypeId: google.maps.MapTypeId.ROADMAP
 };
 var map = new google.maps.Map(document.getElementById("map_canvas"),
 mapOptions);
 }

 </script> 
```

包含谷歌地图的 div：

```
 <div id="myModal" class="reveal-modal large">
  <h2>How to get here</h2>
  <div id="map_canvas" style="width:600px; height:300px;"></div>
  <a class="close-reveal-modal">&#215;</a>
 </div> 
```

**更新 2018-05-22**

随着 Maps JavaScript API 3.32 版中的新渲染器版本的发布，调整大小事件不再是`Map`类的一部分。

该文件指出

> 调整地图大小时，地图中心固定
> 
> *   全屏控制现在保留中心。
>     
>     
> *   **不再需要手动触发调整大小事件。**

来源：[https ://developers.google.com/maps/documentation/javascript/new-renderer](https://developers.google.com/maps/documentation/javascript/new-renderer)

`google.maps.event.trigger(map, "resize");`从版本 3.32 开始没有任何效果

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-25T10:05:47.507

您的源代码实际上存在一些问题。

*   该`initialize()`函数已创建，但从未调用
*   `$(document).ready`应该在我们加载 jQuery 之后调用
*   `map`应该是一个全局变量（如@Cristiano Fontes 所说）而不是`var map`
*   （重要）该`click`事件永远不会被调用。您正在尝试结合[Zurb 的 Reveal](http://foundation.zurb.com/docs/reveal.php)提供的两种方法来打开对话框（一种使用 JS，一种仅使用 HTML）。您需要使用唯一的 JS 方法。
*   您使用了错误的 ID（`#myModal1`永远不会位于 HTML 中）。

现在：[下载解决方案](https://dl.dropbox.com/s/ixphicc6bwmckhs/so_resize.rar?dl=1)（下次请给我们提供下载/JSFiddle，这样我们就不需要自己创建了）。

希望它有所帮助！

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2012-10-24T22:56:23.710

只需在此处添加

```
<script type="text/javascript">
  $(document).ready(function() {
  $('#myModal1').click(function() {
  $('#myModal').reveal();
  google.maps.event.trigger(map, 'resize');
       });
          });
 </script> 
```

但是您需要将地图作为全局变量，所以在这里丢失 var

```
<script type="text/javascript">
   function initialize() {
     var mapOptions = {
      center: new google.maps.LatLng(39.739318, -89.266507),
      zoom: 5,
      mapTypeId: google.maps.MapTypeId.ROADMAP
     };
 --> map = new google.maps.Map(document.getElementById("map_canvas"),
   mapOptions);
 }

 </script> 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2014-03-05T08:31:25.453

```
google.maps.event.addListenerOnce(map, 'tilesloaded', function() {
                google.maps.event.addListenerOnce(map, 'tilesloaded', function() {
                    google.maps.event.trigger(map, 'resize');
                });
}); 
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-07-15T19:38:15.257

没有找到如何对最后一个答案发表评论，但是 +1 以获得 Cristiano Fontes 的帮助！有效。就我而言：

```
<script type="text/javascript">    

$('div.map-box').hide();
$('li.map').mouseover(function(){
    $('div.map-box').show();
    google.maps.event.trigger(map, 'resize');
});

</script> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2020-08-21T14:26:28.597

现在， google.maps.event.trigger(map, 'resize') 什么都不做。就像我们在其中包含谷歌地图的 mat-dialog 一样，也存在同样的问题。我找到了一些你可以处理它的方法：

1.  带有超时的初始化映射。
2.  在映射初始化后更改父容器的大小，然后将其更改回来。

但对我来说，所有这些方法都非常糟糕，我正在寻找更好的方法。

# c# - 如何获取枚举描述的字符串列表？

> ID：13059036
> 
> 赞同：5
> 
> 时间：2012-10-24T22:50:55.237
> 
> 标签：c#, types, enums

如何获取枚举值的列表？

例如，我有以下内容：

```
public enum ContactSubjects
{
    [Description("General Question")]
    General,
    [Description("Availability/Reservation")]
    Reservation,
    [Description("Other Issue")]
    Other
} 
```

我需要做的是将 ContactSubject.General 作为参数传递，它返回描述列表。

此方法需要与任何 Enum 一起使用，而不仅仅是 ContactSubject（在我的示例中）。签名应该类似于 GetEnumDescriptions(Enum value)。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2012-10-24T23:05:43.337

类似的东西可能会起作用：

```
 private static IEnumerable<string> GetDescriptions(Type type)
    {
        var descs = new List<string>();
        var names = Enum.GetNames(type);
        foreach (var name in names)
        {
            var field = type.GetField(name);
            var fds = field.GetCustomAttributes(typeof(DescriptionAttribute), true);
            foreach (DescriptionAttribute fd in fds)
            {
                descs.Add(fd.Description);
            }
        }
        return descs;
    } 
```

但是您可以在那里查看一些逻辑：例如可以以名称开头吗？你将如何处理多个描述属性？如果其中一些丢失了怎么办 - 你想要一个名字还是像上面一样跳过它？等等

刚刚回顾了你的问题。对于 VALUE 你会有类似的东西：

```
private static IEnumerable<string> GetDescriptions(Enum value)
{
    var descs = new List<string>();
    var type = value.GetType();
    var name = Enum.GetName(type, value);
    var field = type.GetField(name);
    var fds = field.GetCustomAttributes(typeof(DescriptionAttribute), true);
    foreach (DescriptionAttribute fd in fds)
    {
        descs.Add(fd.Description);
    }
    return descs;
} 
```

但是不可能在单个字段上放置两个描述属性，所以我猜它可能只返回字符串。

# xml - 不匹配的子元素也出现在 XSL 模板下

> ID：13059041
> 
> 赞同：3
> 
> 时间：2012-10-24T22:51:09.783
> 
> 标签：xml, xslt, xslt-1.0

我有以下 XML 代码

```
<?xml version="1.0"?>
<?xml-stylesheet type="text/xsl" href="new_proto.xsl"?>
<Return>
 <SDSSJ type="form" />
 <JSFK type="form" />
 <KJFK type="form2" />
 <HJDHH type="form"> New Val </HJDHH>
 <NNDJB type="some"> 
    <DJSJJ type="form">
       THIS
    </DJSJJ>
    <KAKKK type="nope">
    DONT
    </KAKKK>
 Not
</NNDJB>
</Return> 
```

我只想获取具有属性 type='form' 的所有节点的名称。所以我尝试了以下 XSL。

```
 1 <xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
  2    <xsl:output method="html" omit-xml-declaration="yes" indent="no"/>
  3       <xsl:template match="//*[@type='form']">
  4       <xsl:value-of select="name()" />
  5       </xsl:template>
  6 </xsl:stylesheet> 
```

但不是`SDSSJ JSFK HJDHH DJSJJ`，我得到`SDSSJ JSFK HJDHH DJSJJ DONT Not`。为什么不符合模板的子元素仍然出现？我应该怎么做才能摆脱它们？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T23:02:48.410

添加此模板：

```
<xsl:template match="text()"/> 
```

例子：

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
    <xsl:output method="html" omit-xml-declaration="yes" indent="no"/>

    <xsl:template match="//*[@type='form']">
        <xsl:value-of select="name()"/>
    </xsl:template>

    <xsl:template match="text()"/>

</xsl:stylesheet> 
```

* * *

默认情况下，文本被传递到输出。上面的模板将去除不匹配的文本。

以下[是规范](https://www.w3.org/TR/xslt-10/#built-in-rule)对默认 XSLT 模板规则的说明：

> 有一个内置的模板规则允许递归处理在样式表中的显式模板规则没有成功模式匹配的情况下继续进行。此模板规则适用于元素节点和根节点。下面显示了内置模板规则的等效项：
> 
> ```
> <xsl:template match="*|/">
>     <xsl:apply-templates/> 
> </xsl:template> 
> ```
> 
> 每种模式还有一个内置的模板规则，它允许递归处理在样式表中的显式模板规则没有成功模式匹配的情况下以相同的模式继续。此模板规则适用于元素节点和根节点。下面显示了模式 m 的内置模板规则的等效项。
> 
> ```
> <xsl:template match="*|/" mode="m">
>     <xsl:apply-templates mode="m"/> 
> </xsl:template> 
> ```
> 
> 还有一个用于复制文本的文本和属性节点的内置模板规则：
> 
> ```
> <xsl:template match="text()|@*">
>     <xsl:value-of select="."/> 
> </xsl:template> 
> ```
> 
> 处理指令和注释的内置模板规则是什么都不做。
> 
> ```
> <xsl:template match="processing-instruction()|comment()"/> 
> ```
> 
> 命名空间节点的内置模板规则也是什么都不做。没有可以匹配命名空间节点的模式；因此，内置模板规则是唯一适用于命名空间节点的模板规则。
> 
> 内置模板规则被视为在样式表之前隐式导入，因此其导入优先级低于所有其他模板规则。因此，作者可以通过包含显式模板规则来覆盖内置模板规则。

# android - 如何使用来自设计师的图像以图层形式制作 Android UI

> ID：13059043
> 
> 赞同：0
> 
> 时间：2012-10-24T22:51:25.893
> 
> 标签：android, android-layout, android-widget, scale, android-xml

我聘请了一位设计师来帮助我重新设计我的 Android 应用程序的 UI。对于每一个`Activity`，他都给了我一张背景图片，其中包括任何静态内容，例如用于文本内容的精美框架；加上按钮的图像，它们必须在确切的位置适合背景图像，以适合背景图像中的框架。

但是，由于 Android 设备具有不同的屏幕尺寸和纵横比，因此很容易将背景图像本身与`android:scaleType="centerInside"`. 如果它们不必与背景相匹配，我只需为每个设置精确的宽度和高度`ImageButton`，但取决于背景的缩放方式（基于屏幕大小和比例），它们最终可能无法正确对齐。

非常感谢您提前。

**更新：** 有什么方法可以在屏幕内缩放整个视图（例如，RelativeLayout），就像图像在 ImageView 内缩放的方式一样`scaleType="centerInside"`？如果是这样，我可以将`RelativeLayout`'s 的大小设置为与背景图像相同，并将所有其他按钮/图像放在相对于背景图像的位置，然后就拥有整个东西（`RelativeLayout`包含所有其他视图）在手机屏幕内居中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T22:56:45.673

您的方法是错误的（或至少是错误的），因为 android 设备不仅提供不同尺寸的屏幕，而且还提供不同密度的屏幕。您现在应该阅读的是[为多屏幕设计](http://developer.android.com/training/multiscreen/index.html)首先。然后了解不可缩放的位图 UI 不会像您想象的那样工作。您需要支持屏幕尺寸，这意味着您的 UI 元素（如按钮、列表、标题等）应**缩放**。有很多方法可以解决这个问题，一种是使用[9-patch](http://developer.android.com/tools/help/draw9patch.html)位图（在 9-patch 上随机选择[教程](http://radleymarx.com/blog/simple-guide-to-9-patch/)）。

另外，请阅读这篇文章：[支持多个屏幕](http://developer.android.com/guide/practices/screens_support.html)

在设计 UI 时，假设您为`mdpi` **密度**设计就足够了。完成布局后，您可以为 ie和（并分别以相同的名称放入和）创建**可绘制**对象。布局文件保持不变，但框架会自动选择正确的资产，因此只要您提供该**密度**的可绘制对象，您的 UI 就会看起来很清晰。另请参阅[提供资源](http://developer.android.com/guide/topics/resources/providing-resources.html)文章。`mdpi``hdpi``res/drawable-mdpi``res/drawable-hdpi`

# c - 如何防止 strcpy() 被优化

> ID：13059044
> 
> 赞同：4
> 
> 时间：2012-10-24T22:51:27.873
> 
> 标签：c, gcc, assembly

我在《黑客：剥削的艺术》一书中遵循了一个例子，我得到了不同的结果。

示例中的 strcpy() 函数似乎编译为如下指令：

```
0x802384c5 <main+27>: call 0x80482C4 <strcpy@plt> 
```

而当我编译同一个程序时，它会删除对库的调用并用一系列 mov 指令替换它：

```
0x8048475 <main+25>: mov    DWORD PTR [eax],0x6c6c6548
0x804847b <main+31>: mov    DWORD PTR [eax+0x4],0x6f57206f
0x8048482 <main+38>: mov    DWORD PTR [eax+0x8],0x21646c72
0x8048489 <main+45>: mov    WORD PTR [eax+0xc],0xa 
```

我知道编译器可以进行各种优化，但即使它是默认值，我什至尝试使用 -O0 编译它，这应该可以防止优化。

如何编译代码以使其引用外部库？

自大学以来我没有做过任何 C 或汇编，所以对我温柔:)

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-24T23:51:16.033

使用 GCC，您可以使用`-fno-builtin`(disable all builtin) 或`-fno-builtin-strcpy`(just disable builtin `strcpy`)。

# combobox - Python 2.7：Tkinter/ttk 链接的组合框

> ID：13059046
> 
> 赞同：2
> 
> 时间：2012-10-24T22:51:46.477
> 
> 标签：combobox, python-2.7, tkinter, ttk

我使用名为 PAGE 的 GUI 编辑器制作了一个简单的 GUI。它包含两个 Tkinter.ttk 组合框。我的第一个组合框从连接的 sqlite 数据库表中获取其值作为列名。当我从第一个组合框中选择列名时，第二个组合框应自动更新与第一个值相关的值。

顺便说一句，我下面的代码在当前条件下可以正常工作。如果我从第一个组合框中选择一个值，它会将这些值打印到交互式 shell。但是这些值应该插入到第二个组合框中。有谁知道我怎么能弄清楚？

任何帮助是极大的赞赏。提前致谢...

这是我的 GUI 代码：

```
from pysqlite2 import dbapi2 as db
from Tkinter import *
import ttk

def getdata():
    global colnames
    conn = db.connect("blabla.sqlite")
    cur = conn.execute("select * from states")
    col = cur.description
    colnames = [abu[0] for abu in col]
initcombo = getdata()

def vp_start_gui():

    global val, w, root
    root = Tk()
    root.title('Linked Comboboxes')
    root.geometry('301x230+556+208')
    set_Tk_var()
    w = New_Toplevel_1 (root)
    init()
    root.mainloop()

w = None
def create_New_Toplevel_1 (root):

    global w, w_win
    if w: 
        return
    w = Toplevel (root)
    w.title('New_Toplevel_1')
    w.geometry('301x230+556+208')
    set_Tk_var()
    w_win = New_Toplevel_1 (w)
    init()
    return w_win

def destroy_New_Toplevel_1 ():
    global w
    w.destroy()
    w = None

def set_Tk_var():

    global combobox
    combobox = StringVar()

def init():
    pass

class New_Toplevel_1:
    def __init__(self, master=None):

        style = ttk.Style()
        theme = style.theme_use()
        default = style.lookup(theme, 'background')
        master.configure(background=default)

        def choose1(event=None):
            conn2 = db.connect("blabla.sqlite")
            cur2 = conn2.execute("select %s from states" % self.TCombobox1.get())
            results = cur2.fetchall()
            for row in results:
                print row

        self.TCombobox1 = ttk.Combobox (master, state='readonly')
        self.TCombobox1.place(relx=0.03,rely=0.13,relheight=0.09,relwidth=0.48)
        self.TCombobox1["values"] = colnames
        self.TCombobox1.set("Choose one...")
        self.TCombobox1.bind("<<ComboboxSelected>>", choose1)

        self.TCombobox2 = ttk.Combobox (master, state='readonly')
        self.TCombobox2.place(relx=0.03,rely=0.33,relheight=0.09,relwidth=0.48)

        self.TLabel1 = ttk.Label (master)
        self.TLabel1.place(relx=0.03,rely=0.83,height=19,width=28)
        self.TLabel1.configure(relief="flat")
        self.TLabel1.configure(text='''Info:''')

        self.TButton1 = ttk.Button (master)
        self.TButton1.place(relx=0.63,rely=0.22,height=25,width=76)
        self.TButton1.configure(takefocus="")
        self.TButton1.configure(text='''Run''')

if __name__ == '__main__':
    vp_start_gui() 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-30T23:07:47.013

将“结果”设置为第二个组合框的“值”配置的值。

```
def choose1(event=None):
        conn2 = db.connect("blabla.sqlite")
        cur2 = conn2.execute("select %s from states" % self.TCombobox1.get())
        results = cur2.fetchall()
        self.TCombobox2['values'] = results
        for row in results:
            print row 
```

# .net - 在 .NET 中是否在运行时按需加载引用的 DLL？

> ID：13059047
> 
> 赞同：3
> 
> 时间：2012-10-24T22:52:21.623
> 
> 标签：.net, visual-studio

> **可能重复：**
> [CLR 如何加载 DLL？](https://stackoverflow.com/questions/2967164/how-are-dlls-loaded-by-the-clr)

在 .NET 中是否在运行时按需加载引用的 DLL？或者它们都是一开始就加载的。我之所以问，是因为在附加 Visual Studio 的情况下运行我的项目时，我注意到它正在为开始时引用的每个 DLL 加载符号。

这仅仅是因为我在附加了 VS 的情况下在调试中运行吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:03:18.117

您可以在没有附加 VS 的情况下运行时使用 Procmon（进程监视器）检查自己。在我脑海中，我记得当 JIT 编译器第一次遇到一个类型时，它们是按需加载的。事实上，我使用混合解决方案（托管和非托管程序集），当缺少非托管 dll 时，当第一次需要来自该程序集的类型时会出现错误；在 VS 上运行时，我什至得到了调用堆栈。但是我从来没有在VS之外检查过。至于背后的理论，[这个问题](https://stackoverflow.com/questions/2967164/how-are-dlls-loaded-by-the-clr)有很长的解释。

# php - 如何运行 crontab -e？

> ID：13059055
> 
> 赞同：4
> 
> 时间：2012-10-24T22:52:30.520
> 
> 标签：php, cron

我目前正在[这里](http://corenominal.org/howto-setup-a-crontab-file/)阅读我想使用 CRON 的文档。现在它在第一部分中说我需要输入命令：`crontab -e`.

我只需要在一个简单的文本编辑器文件中输入它，然后将文件上传到服务器吗？

我正在使用 helios.hud.ac.uk 所以这是正确的命令：

```
* * 25 10 * helios.hud.ac.uk/u00000000/Mobile/inactivatesession.php 
```

这将在下面执行这个 php 脚本（inactivatesession.php）：

```
<?php

include('connect.php');

$createDate = mktime(0,0,0,10,25,date("Y"));
$selectedDate =  date('d-m-Y', ($createDate));

$sql = "UPDATE Session SET Active = ? WHERE DATE_FORMAT(SessionDate,'%Y-%m-%d' ) <= ?";                                         
$update = $mysqli->prepare($sql);
$update->bind_param("is", 0, $selectedDate);
$update->execute();

?> 
```

这个 php 脚本的 url 是：helios.hud.ac.uk/u00000000/Mobile/inactivatesession.php

我以前没有使用过 CRON，所以只需要一点帮助。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T22:57:10.407

如果您正在制作一个将访问远程网页的 crontab（这是因为它不在本地服务器上），您需要在 URL 前面加上`wget`

```
* * 25 10 * wget -O - http://helios.hud.ac.uk/u00000000/Mobile/inactivatesession.php 
```

它将在服务器上运行脚本并将其输出到标准输出（在大多数服务器中将通过电子邮件发送给您）

这假设您有一台 linux 机器。 `crontab -e`为您的用户帐户设置一个 cron 选项卡。所以你不能真正上传 crontab，但如果你有 cpanel 或类似的，大多数时候你可以从那里访问 cron。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T22:58:23.863

1.  您打开一个外壳（可能通过 SSH）到您的服务器
2.  你运行命令`crontab -e`
3.  您可以根据需要编辑 crontab（如果您想通过 http 运行 php 脚本，则需要使用`wget`）
4.  你保存并退出如果你没有犯任何错误，你会得到一个消息，crontab 已更新

# python - Python 3 不适用于 Sublime Text 2

> ID：13059062
> 
> 赞同：3
> 
> 时间：2012-10-24T22:53:08.163
> 
> 标签：python, ubuntu, python-3.x, text-editor, sublimetext2

我已经使用 Sublime Text 2 一年多了，最近开始将它用于 Python。Sublime 有一个为 Python 构建的构建它，我尝试使用它（内置一个用于 2.7.3 或 2.XI 相信的东西）。我正在使用 Python 3.3.0。我已经编辑了 sublime-build 文件并将其更改为：

```
{
"cmd": ["python3", "-u", "$file"],
"file_regex": "^[ ]*File \"(...*?)\", line ([0-9]*)",
"selector": "source.python"
} 
```

正如另一个线程上的stackoverflow所建议的那样。我尝试重新启动 sublime 并尝试运行我的代码：

```
x = input("Name: ")
print("Welcome " + x)
input() 
```

但是在底部的控制台上，当我使用 build (Ctrl+B) 运行时出现以下错误：

```
Name: Traceback (most recent call last):
File "/home/andrew/grive/Documents/RandomProjects/PythonStuff/HelloWorld.py", line 32,      
in <module>
x = input("Name: ")
EOFError: EOF when reading a line
[Finished in 0.1s with exit code 1] 
```

此外，我试图通过仅使用 SublimeREPL 和其中的 Python 函数来绕过内置的构建函数，但他们也检测到我的 Python 构建为 2.7.3，因此没有编译我的 3.3.0 代码。请注意，我确实安装了 Python 3，我使用的是 Ubuntu，当我在终端中键入“python3”时，Python 会在终端中以正确的版本启动。

所以我有两个问题：

为什么我的 python3.sublime-build 不起作用，我该如何解决？

而且由于我是 linux 菜鸟，我无法访问构建文件。我去过他们一次，但我现在忘记了。它们在 /home/~.config/sublime-text-2/ 等等等等。

我看不到 .config 文件，您能解释一下它是如何工作的吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T22:55:05.753

您的问题是 sublimetext 构建*无法*接受用户输入 - 没有连接输入流。您的 Python 版本无关紧要。

但是，可以[编写一个插件](https://github.com/eric-wieser/build-with-input)来接受输入！

* * *

至于配置文件，只需使用“首选项-> 浏览包”菜单项。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-06-17T00:13:14.360

我发现将'Python.sublime-build'文件从'python'编辑为'python3'功能的OP解决方案。

我知道这一点，因为当我遇到同样的问题时，OP 的解决方案帮助了我，并且证明在以下行中：

```
import sys
print(sys.platform) 
```

整个练习代码：

```
import sys
print(sys.platform)
print(2 ** 100)
x = 'Spam!'
print(x * 8)
input('Press ENTER to exit...') 
```

使用 Python 2.7，返回是 'linux2'（对我来说）。在 Python 3.3 中，返回的是 'linux'。这是我首先使用 PVM 检测到的。当我在 Sublime 2 中进行“构建”时，“linux2”是输出；使用 OP 的方法将输出更改为“linux”，所以我认为这是正确的做法（无论如何最简单）。

使用 Python 构建输出：

```
linux2
1267650600228229401496703205376
Spam!Spam!Spam!Spam!Spam!Spam!Spam!Spam!
Press ENTER to exit...Traceback (most recent call last):
  File "/home/sick/Python/script1.py", line 6, in <module>
    input('Press ENTER to exit...')
EOFError: EOF when reading a line
[Finished in 0.0s with exit code 1] 
```

使用 Python3 构建输出：

```
linux
1267650600228229401496703205376
Spam!Spam!Spam!Spam!Spam!Spam!Spam!Spam!
Press ENTER to exit...Traceback (most recent call last):
  File "/home/sick/Python/script1.py", line 6, in <module>
    input('Press ENTER to exit...')
EOFError: EOF when reading a line
[Finished in 0.1s with exit code 1] 
```

没有程序错误；它给出了一个错误，因为程序正在期待用户输入（据我所知，但我只在第 4 章）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-21T16:16:53.920

我也遇到了同样的问题，只有当我使用终端启动这个程序时我才能做到这一点：

```
 cd WayToFile
 python FileName 
```

一切都完成了。也许这就是它必须在所有 Python 版本中工作的方式

# c# - 使用一组属性绑定到 DataGridView

> ID：13059065
> 
> 赞同：5
> 
> 时间：2012-10-24T22:53:21.587
> 
> 标签：c#, data-binding, datagridview

想象一个`Item`具有三个属性的类：

*   项目名称（字符串）
*   数量（整数）
*   `ItemPrice`价格（具有两个属性的类的数组/列表：供应商名称和价格）。

基本上，我想将此类绑定到 DataGridView，其中每一行都是类 Item。问题是，有不同数量的供应商（或者可以稍后编辑），并且数据绑定必须支持这种动态数量的供应商。

另外，作为奖励，我想添加一个额外的列，显示供应商的价格乘以数量。

我**不想**使用虚拟模式（这就是我目前完成这项任务的方式）。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-24T13:41:22.510

您可以将表映射到动态创建的 datagridview。这是一个示例代码片段：

```
 public class ItemBinding
       {
        List<Item> itemList = new List<Item>();
        Item it = null;
        DataRow dr = null;
        public void mapping()
          {
                  for (int i = 0; i <= 4; i++)
                     {
                      it = new Item();
                      it.qty = i;
                      it.name = "name" + i;
                      it.itemprice.Vendorname="vendor" + i;
                      it.itemprice.price = 20 * i;
                      itemList.Add(it);
                     }
          }
         public void binding()
         {
              DataTable dt = new DataTable();

                   dt.Columns.Add(new DataColumn("item", typeof(string)));
                   dt.Columns.Add(new DataColumn("quantity", typeof(int)));
                   dt.Columns.Add(new DataColumn("vendor", typeof(string)));

              //item list contains the detail of the class

                    foreach (Item c in itemList)
                         {
                            dr = dt.NewRow();

                            dr[0] = c.qty;
                            dr[1] = c.name;
                            dr[2] = c.itemprice.Vendorname;;
                            dt.Rows.Add(dr);
                          }
                  dataGridView1.AutoGenerateColumns = true;
                  dataGridView1.DataSource = dt;
                   }
          }
    public class Item
         {
            public int qty{ get; set; }
            public string name { get; set; }
            public ItemPrice itemprice { get; set; }
            public Item()
                 {
                   this.itemprice = new ItemPrice();
                  }
         }

          public class ItemPrice
            {
             public string Vendorname { get; set; }      
             public int price { get; set; }
            } 
```

在这种情况下 itemprice 是一个有两个嵌套的属性或者你可以继承它。这可能会对您有所帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T04:18:07.617

实现此目的的一种方法是在 Item 类（或新类或匿名类）上创建一个字符串属性，并实现此属性以将所有供应商和商品价格连接在一起。

这样做的缺点是，将字符串中的所有项目放在同一列中可能看起来很难看，并且无法以直观的方式编辑项目。

但是，它将实现显示任意数量的供应商和价格的目标，您可以轻松地将供应商价格乘以数量添加到此。

# matlab - 如何使用混合欧几里得和极坐标参数绘制圆形图

> ID：13059066
> 
> 赞同：0
> 
> 时间：2012-10-24T22:53:23.803
> 
> 标签：matlab, plot

我在 math.stackexchange.com 上发布了这个问题，但我不完全确定这是否是发布这个问题的正确社区。我选择了数学网站，因为我能够以易于阅读的方式表示我想绘制的数学方程。

问题的链接在这里：[https ://math.stackexchange.com/questions/220395/matlab-how-to-plot-circular-plot-with-mixed-euclidean-and-polar-coordinate-para](https://math.stackexchange.com/questions/220395/matlab-how-to-plot-circular-plot-with-mixed-euclidean-and-polar-coordinate-para)

我希望我不会因为重复发布或在错误的位置发布而违反任何规则。请随时在这里纠正我。

谢谢大家

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:29:32.957

为简单起见，我将仅针对第一个等式给出答案，我相信您会理解如何进一步应用它。这是我在保持 L1 和 L2 不变的同时生成表示 x、y、theta 方程的 3d 矩阵的方法：

```
N=100; % grid points
rangex=linspace(-2,2,N);
rangey=linspace(-2,2,N);
ranget=linspace(-pi,pi,N);

[x,y,theta] = meshgrid(rangex,rangey,ranget);

L1 = 1; 
L2 =-1; 

A = x.^2+y.^2-2*L1*L2*cos(theta); 
```

您可以使用多种工具来可视化 A=L1^2+L2^2，这是一种方法：

```
p=patch(isosurface(x,y,theta,A,L1^2+L2^2))
set(p,'FaceColor','red','EdgeColor','none');
daspect([1,1,1])
view(3); axis tight
camlight 
lighting gouraud 
```

![在此处输入图像描述](../Images/b5dd48bed1e380b910b42395d72a2589.png)

# c++ - TCP 和 PF_RING

> ID：13059070
> 
> 赞同：12
> 
> 时间：2012-10-24T22:53:50.807
> 
> 标签：c++, c, linux-kernel, pf-ring

我正在研究`PF_RING`在我的应用程序中使用用于发送和接收。

如果我打算`PF_RING`用于维护 TCP 连接，看起来我需要自己手动“伪造”IP 和 TCP 消息，因为`pfring_send`发送原始数据包。这是否意味着我必须在上面手动重新实现 TCP `PF_RING`？

我知道使用 接收有明显的优势`PF_RING`，有没有人尝试使用 发送数据`PF_RING`？与普通发送呼叫相比有明显优势吗？

注意：我没有使用 DNA（直接 NIC 访问），我只是使用带有 NIC 感知驱动程序的内核部分绕过。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-31T06:11:31.133

要回答您的第一个问题，是的，您必须从头开始手动构建 TCP/IP 消息、MAC 地址等。例如，请查看[ntop.org](https://svn.ntop.org/svn/ntop/trunk/PF_RING/userland/examples/pfsend.c)中的[pfsend.c](http://ntop.org/)。

ntop.org 还提供了包含说明的[`PF_RING`用户指南。](https://svn.ntop.org/svn/ntop/trunk/PF_RING/doc/UsersGuide.pdf)

至于使用 发送数据`PF_RING`，这是绝对可能的，其想法是绕过任何和所有关于网络上实际数据的概念并尽可能快地发送，请参阅来自 ntop.org 的[线速流量生成。](http://www.ntop.org/solutions/wire-speed-traffic-generation/)与使用 TCP/IP 内核的正常发送调用相比，它的唯一优势是您可以发送数据 1\. 更快， 2\. 完全未格式化到网络上。例如，当您想在网络上播放以前捕获的数据包/多个数据包时，2 可能会很方便。

* * *

除非您有特定的用例要求您在没有内核干预的情况下访问原始底层数据，否则绝对没有充分的理由以`PF_RING`任何方式使用。您最好的选择是使用`socket()`可用的标准，在大多数情况下，您可以实现的性能绰绰有余。

您想到了什么具体的用例？

# javascript - Javascript - 如何正确缩小此代码

> ID：13059071
> 
> 赞同：1
> 
> 时间：2012-10-24T22:53:56.753
> 
> 标签：javascript, jquery

关于浏览器版本，播放器高度应该改变

```
if older then ie9 
  //height is fixed
else 
  //height is auto 
```

上面的代码是有效的，但是，这是我见过的最糟糕的事情，因为我会一次又一次地重复自己，当这个条件只有一行发生变化时。

```
<script type="text/javascript"> 
    $(document).ready(function() {

        if ($.browser.msie && $.browser.version.substr(0,1)<9) {
            $("#jquery_jplayer_1").jPlayer({
            ready: function () 
            {
                $(this).jPlayer("setMedia", 
                {
                    m4v: "/video/videoK.mp4",
                    ogv: "/video/videoK.ogg"
                }).jPlayer("play");

                $('article.about-k').hide();
                olark('api.box.hide');
            },
            swfPath: "/scripts/",
            supplied: "m4v, ogv",
            size: {
                width: "100%",
                height: "400px" // THE ONLY CHANGE IS HERE
            },
            backgroundColor: "#fff",
            click: function() {
                $(this).jPlayer("play");
            },
            ended: function() {
                $('.jplayer-k').hide();
                $('article.about-k').show();
            }
        })
      } else {
        $("#jquery_jplayer_1").jPlayer({
            ready: function () 
            {
                $(this).jPlayer("setMedia", 
                {
                    m4v: "/video/videoK.mp4",
                    ogv: "/video/videoK.ogg"
                }).jPlayer("play");

                $('article.about-k').hide();
                olark('api.box.hide');
            },
            swfPath: "/scripts/",
            supplied: "m4v, ogv",
            size: {
                width: "100%",
                height: "auto" // THE ONLY CHANGE IS HERE
            },
            backgroundColor: "#fff",
            click: function() {
                $(this).jPlayer("play");
            },
            ended: function() {
                $('.jplayer-k').hide();
                $('article.about-k').show();
            }
        })
      }

    });
</script> 
```

正如评论所指出的，唯一的变化是在单行上。我怎样才能重新制作这个，而不愚蠢地重复自己？

```
 height: "auto" //THIS IS THE ONLY DIFFERENCE! 
```

请指教

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:00:11.297

[使用三元运算符](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Operators/Conditional_Operator)非常简单：

```
$("#jquery_jplayer_1").jPlayer({
    ready: function () {
        $(this).jPlayer("setMedia", {
            m4v: "/video/videoK.mp4",
            ogv: "/video/videoK.ogg"
        }).jPlayer("play");

        $('article.about-k').hide();
        olark('api.box.hide');
    },
    swfPath: "/scripts/",
    supplied: "m4v, ogv",
    size: {
        width: "100%",
        height: ($.browser.msie && $.browser.version.substr(0, 1) < 9)
          ? "400px"
          : "auto"
    },
    backgroundColor: "#fff",
    click: function () {
        $(this).jPlayer("play");
    },
    ended: function () {
        $('.jplayer-k').hide();
        $('article.about-k').show();
    }
}) 
```

如果你不喜欢这样（例如因为更复杂的条件），你仍然可以使用一个简单的变量：

```
var height = "auto";
if (/* IE too old */)
    height = "400px";
$…({
      … // huge config object
      height: height,
      …
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:03:50.840

尝试：

```
var playerObj = { ready : function () { /* ... */ }, size : /* AUTO */ };
if (/*stupid IE TEST*/) {
    playerObj.size.height = "...";
}

$("#jquery_jplayer_1").jPlayer(playerObj); 
```

将您的配置与流程分开，这样就不会那么麻烦了。

另外，就像@Bergi 所说，三元运算：

```
value = (test_with_optional_parentheses) ? passed_value : failed_value; 
```

...或者在这种情况下，作为对象参数：

```
{ value : (test_with_optional_parentheses) ? passed_value : failed_value }; 
```

非常适合在配置对象中间更改一件事，内联。

当你开始混淆你需要做的事情和你目前正在做的事情时，请记住我对组织大块代码的建议。当您需要（一次）设置一个值时，请记住 Bergi 的建议，基于一个简单的测试。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:04:43.753

为什么不：

```
 <script type="text/javascript"> 
        $(document).ready(function() {

            if('<?= $cookie; ?>' > '1' || $(window).width() <= 768) {
              $('.jplayer-k').remove();
              $('article.about-k').show();
           }

            $("#jquery_jplayer_1").jPlayer({
            ready: function () 
            {
                $(this).jPlayer("setMedia", 
                {
                    m4v: "/video/videoK.mp4",
                    ogv: "/video/videoK.ogg"
                }).jPlayer("play");

                $('article.about-k').hide();
                olark('api.box.hide');
            },
            swfPath: "/scripts/",
            supplied: "m4v, ogv",
            size: {
                width: "100%",
                height: ($.browser.msie && $.browser.version.substr(0,1)<9) ? "400px" : "auto"
            },
            backgroundColor: "#fff",
            click: function() {
                $(this).jPlayer("play");
            },
            ended: function() {
                $('.jplayer-k').hide();
                $('article.about-k').show();
            }
        }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T23:01:24.207

它可能是这样的：

```
<script type="text/javascript"> 
    $(document).ready(function() {

        if('<?= $cookie; ?>' > '1' || $(window).width() <= 768) {
          $('.jplayer-k').remove();
          $('article.about-k').show();
       }
       height = $.browser.msie && parseInt($.browser.version, 10) < 9 ? '400px' : 'auto';
         $("#jquery_jplayer_1").jPlayer({
            ready: function () 
            {
                $(this).jPlayer("setMedia", 
                {
                    m4v: "/video/videoK.mp4",
                    ogv: "/video/videoK.ogg"
                }).jPlayer("play");

                $('article.about-k').hide();
                olark('api.box.hide');
            },
            swfPath: "/scripts/",
            supplied: "m4v, ogv",
            size: {
                width: "100%",
                height: height
            },
            backgroundColor: "#fff",
            click: function() {
                $(this).jPlayer("play");
            },
            ended: function() {
                $('.jplayer-k').hide();
                $('article.about-k').show();
            }
        })
    });
</script> 
```

**更新：**
我在 Fabriccio Matte 建议上方添加了代码，因此您的代码不会因 IE10 而失败

# objective-c - UIWebView 在旋转时重绘

> ID：13059072
> 
> 赞同：0
> 
> 时间：2012-10-24T22:53:58.353
> 
> 标签：objective-c, uiwebview

我已将 UIWebView 对象实现为自定义 UIView ( [TSAlertView](https://www.google.co.uk/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCAQFjAA&url=https://github.com/TomSwift/TSAlertView&ei=lHGIUNPTK6OZ0QXu4YHQBA&usg=AFQjCNGGfcdwYzBRoxrc5fc3fjzdVqb7Qw) )。我的 UIWebView 位于 UIView 的中间，作为子视图。

当我旋转 iOS 设备屏幕时，UIWebView 对象会在旧屏幕上重绘，而不会删除旧屏幕。当屏幕旋转时，这个自定义 UIView 的所有其他元素都会被销毁并重绘。

我想我一定错过了某种释放资源或从视图中删除 UIWebView 的过程。我尝试在 UIWebView 的声明中添加“自动释放”，但无济于事。我想知道这是否是我在创建 UIWebView 的方式上所做的简单疏忽的常见症状？

这似乎是一个简单的情况，即在每次旋转时重绘它之前不告诉 UIWebView 对象它应该销毁自己 - 但我不知道我该怎么做......

任何智慧都感激地接受。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:07:32.353

理想情况下，旋转时您不应再次创建视图。相反，您可以适当地重新排列代表中的框架。在您的情况下，您可能会`UIWebView`再次创建一个，这应该避免。取而代之的是，您可以将其保留为类级别参数（在 .h 文件中声明）并在委托方法中调整框架以进行旋转。另请注意，`release/autorelease`不会从超级视图中删除您的视图。您需要调用`removeFromSuperview`方法来实现这一点。

[检查此视图调整大小和布局处理](http://www.techotopia.com/index.php/IOS_4_iPhone_Rotation,_View_Resizing_and_Layout_Handling)

# r - 为什么以及在哪里将 \n 换行符引入 c()？

> ID：13059083
> 
> 赞同：9
> 
> 时间：2012-10-24T22:54:51.357
> 
> 标签：r, text

希望有人可以帮助我理解为什么错误的 \n 字符会出现在我在 R 中创建的字符串向量中。

尝试导入和清理固定宽度格式的非常宽的数据文件（[http://www.state.nj.us/education/schools/achievement/2012/njask6/](http://www.state.nj.us/education/schools/achievement/2012/njask6/)，“数据运行的文本文件”）。按照加州大学洛杉矶分校关于使用 read.fwf的[教程和](http://www.ats.ucla.edu/STAT/r/modules/raw_data.htm)[这个](https://stackoverflow.com/questions/8815075/fixing-dimnamesx-of-xts-objects-in-r-via-loop)优秀的 SO 问题在导入后给出列名。

因为文件很宽，所以列标题很长 - 加起来不到 29,800 个字符。我将它们作为简单的字符串向量传递：

```
column_names <- c(...) 
```

我会放过你这里丑陋的垃圾场，但我把整个东西都丢在了[pastebin](http://pastebin.com/FbkNvqGt)上。

当我注意到我的一些子集返回 0 行时，正在清理和转换一些变量以进行分析。在对它感到困惑之后（我拼错了什么吗？）它意识到不知何故在我的列标题中引入了一堆 '\n' 换行符。

如果我遍历我创建的 column_names 向量

```
for (i in 1:length(column_names)) {
  print(column_names[i])
} 
```

我看到第 81 行中间的第一个换行符 -

> SPECIAL\nEDUCATION SCIENCE 注册科学编号

我试图解决这个问题的途径：

1）这与我的环境有关吗？我在 R 中使用常规脚本编辑器，并且我的行*确实*换行了 - 但我屏幕上的中断与 \n 字符的位置不匹配，这对我来说表明它不是 R 脚本编辑器。

2）有GUI设置吗？做了一些[搜索](https://www.google.com/search?q=r%20GUI%20settings%20word%20wrap)，但找不到任何东西。

3）有模式吗？似乎每 4000 个字符就会插入换行符。对 R/S 原语进行了一些阅读，以试图弄清楚这是否与基本的 R 数据结构有关，但很快就在我脑海中浮现。

我尝试将长字符串分解成[更短的块](http://pastebin.com/k51JHjNw)，然后将它们组合起来，这似乎解决了问题。

```
column_names.1 <- c(...)
column_names.2 <- c(...)
column_names_combined <- c(column_names.1, column_names.2) 
```

所以我有一个直接的解决方法，但很想知道这里到底发生了什么。

一些与字符向量问题有关的[帖子](https://stat.ethz.ch/pipermail/r-help/2008-January/151380.html)建议我运行内存配置文件：

```
 memory.profile()
        NULL      symbol    pairlist     closure environment     promise 
           1        9572      220717        4734        1379        5764 
    language     special     builtin        char     logical     integer 
       63932         165        1550       18935       10302       30428 
      double     complex   character         ...         any        list 
        2039           1       60058           0           0       20059 
  expression    bytecode externalptr     weakref         raw          S4 
           1       16553         725         150         151        1162 
```

我在 Windows 7（Enterprise、SP 1、8 gigs RAM）上运行 R 2.15.1（64 位）R。谢谢！

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2012-10-25T03:10:51.267

我怀疑这是一个错误。相反，您似乎遇到了控制台的已知限制。[正如它在 R简介的](http://cran.r-project.org/doc/manuals/R-intro.html)[第 1.8 节 - R 命令、区分大小写等](http://cran.r-project.org/doc/manuals/R-intro.html#R-commands_003b-case-sensitivity-etc)中所说：

> 在控制台输入的命令行被限制 [3] 为大约 4095 个字节（不是字符）。
> 
> [3] 一些控制台不允许您输入更多内容，其中一些会默默丢弃多余的部分，而另一些则会将其用作下一行的开始。

要么将命令放在一个文件中`source`，要么将代码分成多行，方法是在适当的点（逗号之间）插入您自己的换行符。例如：

```
column_names <-
  c("County Code/DFG/Aggregation Code", "District Code", "School Code",
    "County Name", "District Name", "School Name", "DFG", "Special Needs",
    "TOTAL POPULATION TOTAL POPULATION Number Enrolled LAL", ...) 
```

# twitter-bootstrap - 引导轮播分页活动状态

> ID：13059085
> 
> 赞同：0
> 
> 时间：2012-10-24T22:55:00.840
> 
> 标签：twitter-bootstrap, pagination, carousel

我在这里搜索了类似的问题/答案，但似乎没有什么对我有用。我的“活动”状态没有完全发挥作用。成功了一半；当您选择其他项目符号时，它会停用第一个项目符号。

**请查看完整代码：http:** [//jsfiddle.net/cindyg/e9Qum/](http://jsfiddle.net/cindyg/e9Qum/)

下面的代码对我来说是正确的；不确定缺少什么？

```
.bind('slid',
        function(e) {
            var nav = $('.carousel-nav[data-target="' + $(this).attr('id') + '"] button');
            var index = $(this).find('.item.active').index();
            var item = nav.find('a').get(index);

            nav.find('a.active').removeClass('active');
            $(item).find('a').addClass('active'); 
```

我尝试在这里使用建议的解决方案：

*   [引导轮播编号活动图标](https://stackoverflow.com/questions/10499154/bootstrap-carousel-number-active-icon)
*   [Bootstrap轮播分页/幻灯片编号问题](https://stackoverflow.com/questions/10974724/bootstrap-carousel-pagination-slide-numbering-issue)

......但他们没有工作。请记住，我是一个新手，当我尝试它们时，我的语法可能已经偏离了。

谢谢大家！

**编辑！！！！！！**我以某种方式修复了它......我真的不确定我做了什么，但我将它发布在这里以防它帮助任何人。但是，现在我在幻灯片中自动旋转时遇到了问题，即使我删除了 myCarousel div 上的“幻灯片”类。有任何想法吗？[在 jsfiddle 上](http://jsfiddle.net/cindyg/UNKeL/)

```
.bind('slid',
                    function(e) {
                            var nav = $('.carousel-nav[data-target="' + $(this).attr('id') + '"] ul');
                            var index = $(this).find('.item.active').index();
                            var item = nav.find('li').get(index);

                            nav.find('li a.active').removeClass('active');
                            $(item).find('a').addClass('active'); 
```

# algorithm - 多变量函数和的优化

> ID：13059090
> 
> 赞同：2
> 
> 时间：2012-10-24T22:55:12.487
> 
> 标签：algorithm, math

想象一下，我是一家面包店，试图用有限的原料生产出最大数量的馅饼。

以下每个馅饼配方都`A, B, C, and D`恰好生产 1 个馅饼：

```
A = i + j + k
B = t + z
C = 2z
D = 2j + 2k 
```

*食谱总是呈线性形式，如上。

我有以下成分：

```
4 of i
5 of z
4 of j
2 of k
1 of t 
```

考虑到我有限的成分，我想要一个算法来最大化我的馅饼产量。

这些示例输入的最佳解决方案将为我产生以下数量的馅饼：

```
2 x A
1 x B
2 x C
0 x D
= a total of 5 pies 
```

我可以通过采用所有组合的最大生产者来轻松解决这个问题，但是随着成分数量的增加，组合的数量变得令人望而却步。我觉得这种类型的优化问题必须有概括，我只是不知道从哪里开始。

虽然我只能烤整个馅饼，但我仍然有兴趣看到一种可能产生非整数结果的方法。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:05:44.413

您可以定义[线性规划](http://en.wikipedia.org/wiki/Linear_programming)问题。我将在示例中展示用法，但它当然可以推广到任何数据。

将您的饼图表示为您的变量 (x1 = A, x2 = B, ...)，LP 问题将如下所示：

```
maximize x1 + x2 + x3 + x4
s.t. x1 <= 4  (needed i's)
     x1 + 2x4 <= 4 (needed j's)
     x1 + 2x4 <= 2 (needed k's)
     x2 <= 1 (needed t's)
     x2 + 2x3 <= 5 (needed z's)
and x1,x2,x3,x4 >= 0 
```

这个问题的分数解决方案是多项式可解决的，但整数线性规划是 NP-Complete。

问题确实是[NP-Complete](http://en.wikipedia.org/wiki/NP-complete)，因为给定一个[整数线性规划](http://en.wikipedia.org/wiki/Integer_programming)问题，您可以使用相同的方法将问题简化为“最大化饼图的数量”，其中每个约束都是饼图中的一个成分，变量是馅饼。

对于整数问题 - 如果您可以使用“接近某个界限”（例如，经常使用[局部比率技术](http://www.cs.technion.ac.il/~reuven/PDF/survay04.pdf)或[primal-dual](http://en.wikipedia.org/wiki/Duality_%28optimization%29) ）或者如果您需要，那么文献中有很多近似技术可以解决该问题一个精确的解决方案——指数解决方案可能是你最好的选择。（当然，除非[P=NP](http://en.wikipedia.org/wiki/P_versus_NP_problem)）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:09:52.070

由于您的所有函数都是线性的，因此听起来您正在寻找[线性规划](http://en.wikipedia.org/wiki/Linear_programming)（如果可以接受连续值）或[整数规划](http://en.wikipedia.org/wiki/Integer_programming)（如果您要求变量是整数）。

线性规划是一种标准技术，并且可以有效地求解。执行此操作的传统算法是[单纯形法](http://en.wikipedia.org/wiki/Simplex_algorithm)。

整数规划通常是难以处理的，因为添加积分约束允许它描述难以处理的组合问题。似乎有大量的近似技术（例如，您可以尝试仅使用常规线性规划来查看结果），但当然它们取决于您的问题的具体性质。

# c++ - 从常量内存创建输入流

> ID：13059091
> 
> 赞同：31
> 
> 时间：2012-10-24T22:55:25.550
> 
> 标签：c++, input, stream

我在指针指向的缓冲区中有一些数据`const char*`。数据只是一个 ASCII 字符串。我知道它的大小。我希望能够以与从流中读取数据相同的方式读取它。我正在寻找一种允许我编写如下代码的解决方案：

```
// for example, data points to a string "42 3.14 blah"
MemoryStreamWrapper in(data, data_size);
int x;
float y;
std::string w;
in >> x >> y >> w; 
```

重要条件：*不得以任何方式复制或更改数据*（否则我只会使用字符串流。据我所知，如果不复制数据，就不可能从 const char 指针创建字符串流。 )

* * *

## 回答 #1

> 赞同：63
> 
> 时间：2012-10-24T23:05:34.303

这样做的方法是创建一个合适的流缓冲区。例如，可以这样做：

```
#include <streambuf>
#include <istream>

struct membuf: std::streambuf {
    membuf(char const* base, size_t size) {
        char* p(const_cast<char*>(base));
        this->setg(p, p, p + size);
    }
};
struct imemstream: virtual membuf, std::istream {
    imemstream(char const* base, size_t size)
        : membuf(base, size)
        , std::istream(static_cast<std::streambuf*>(this)) {
    }
}; 
```

唯一有点尴尬的是`const_cast<char*>()`在流缓冲区中：流缓冲区不会更改数据但仍然需要`char*`使用接口，主要是为了更容易在“正常”流缓冲区中更改缓冲区。有了这个，您可以`imemstream`用作普通输入流：

```
imemstream in(data, size);
in >> value; 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:02:00.947

唯一的方法是对 std::istream 进行子类化（这也需要对 std::streambuf 进行子类化）以创建您自己的从常量内存读取的流类。

这并不像听起来那么容易，因为 C++ 标准库流类非常混乱且设计糟糕。除非您需要大量扩展，否则我认为这不值得。

# python - Pygame 中的透明精灵

> ID：13059092
> 
> 赞同：2
> 
> 时间：2012-10-24T22:55:28.360
> 
> 标签：python, pygame

我正在编写一些使用 Pygame 的 Python 代码，试图在背景上显示一个小精灵（一个球）。我有那部分工作，但我试图让球精灵的背景是透明的，所以它不会显示为“黑色正方形内的球”精灵，而是显示黑色像素不是blitted 到显示表面。

这是我的代码：

```
# For sys.exit()
import sys

# Pygame imports
import pygame
from pygame.locals import *

# Initialize all the Pygame Modules
pygame.init()

# Build a screen (640 x 480, 32-bit color)
screen = pygame.display.set_mode((640,480)) 

# Create and Convert image files
# Use JPG files for lots of color, and use conver()
# Use PNG files for transparency, and use convert_alpha()
background = pygame.image.load("bg.jpg").convert()
ball = pygame.image.load("ball.png").convert_alpha()
ball.set_colorkey(-1, RLEACCEL) # Use the upper-left pixel color as transparent

# The main loop
while True:

    # 1 - Process all input events
    for event in pygame.event.get():

        # Make sure to exit if the user clicks the X box
        if event.type == QUIT:
            pygame.quit()
            sys.exit()

    # 2 - Blit images to screen (main display window)
    screen.blit(background, (0,0))
    x,y = pygame.mouse.get_pos()
    x = x - ball.get_width()/2
    y = y - ball.get_height()/2
    screen.blit(ball, (x,y))

    # 3 - Update the main screen (redraw)
    pygame.display.update() 
```

我一定犯了一个明显的错误，但我无法弄清楚。调用 ball.set_colorkey(-1, RLEACCEL) 应该获取球精灵左上角的颜色（恰好是黑色）并将其用作“不 blit”的像素颜色。我错过了一步吗？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T22:08:44.637

有每像素 alpha、colorkey alpha 和每表面 alpha。你要颜色键。

当您调用[`convert_alpha()`](http://www.pygame.org/docs/ref/surface.html#Surface.convert_alpha)它时，它会为每像素 alpha 创建一个新表面。

从 [set_colorkey](http://www.pygame.org/docs/ref/surface.html#Surface.set_colorkey)

> 如果 Surface 被格式化为使用每个像素的 alpha 值，则颜色键将被忽略。

所以：加载图像，`.convert()`因为你想使用颜色键。然后调用`set_colorkey`。

> 此外，我在文档中没有看到关于将“-1”作为第一个参数传递给 set_colorkey。

这可能来自一个教程，它有一个 load_image 函数来获取左上角像素的颜色值。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T01:30:14.603

您的形象是如何创建的？如果您的“ball.png”文件是透明背景上的球，而不是黑色方块上的球，则用于 blitting 的 Pygame 透明度应该可以工作。也就是说，来自 Pygame 的“set_colorkey”表面文档：

“如果 Surface 被格式化为使用每像素 alpha 值，则 colorkey 将被忽略。colorkey 可以与完整的 Surface alpha 值混合。”

因此，colorkey 的想法是在您的图像没有每像素 alpha 时使用它——而您只是在调用“转换 alpha”时确保它*确实具有。*此外，我在文档中没有看到关于将“-1”作为第一个参数传递给 set_colorkey。

简而言之：我的建议是使用适当的透明图像开始 - 忘记“convert”、“convert_alpha”、“set_colorkey”等等。如果您出于某种原因不使用 PNG 文件中的每像素 alpha，请检查此答案是否正确（甚至出于一个原因，在向屏幕显示时不希望每像素 alpha）： [PyGame：应用透明度到带有 alpha 的图像？](https://stackoverflow.com/questions/12879225/pygame-applying-transparency-to-an-image-with-alpha/12880257#comment17439487_12880257)

# c# - 拦截打开窗口 - C#

> ID：13059095
> 
> 赞同：1
> 
> 时间：2012-10-24T22:56:01.887
> 
> 标签：c#, windows, event-handling, window

是否有某种方法可以监视/拦截 Windows 中的窗口打开，然后阻止所述窗口打开？这适用于已经在运行的应用程序，我不想停止该进程，只需关闭它产生的弹出窗口即可。

**更新**：

1.  一个进程已经在运行（例如它在任务管理器中）但没有可见的窗口。
2.  在某个随机时间，该进程将弹出一个窗口
3.  我手动关闭窗口（单击“确定”）。
4.  该过程在此时继续运行，稍后将再次弹出一个窗口（重复这些步骤）。

我想自动化步骤＃3，我必须手动关闭弹出窗口，方法是拦截打开和关闭它或隐藏它或从不让它首先打开的窗口。我不想通过轮询打开的窗口来做到这一点。我想收到一个窗口即将打开的事件。

我不控制这个其他应用程序，所以我不能改变它。而且我不想杀死这个过程本身。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:27:36.547

如果您尝试按照我的要求进行操作（一次只允许运行一个程序实例），这是一个使用[Mutex](http://sanity-free.org/143/csharp_dotnet_single_instance_application.html)的优雅解决方案。您可能可以复制和粘贴大部分代码来实现您想要的。

# z3 - Z3 和 DIMACS 输出

> ID：13059096
> 
> 赞同：7
> 
> 时间：2012-10-24T22:56:07.360
> 
> 标签：z3

Z3 目前支持 DIMACS 格式的输入。有没有办法在解决之前为问题输出 DIMACS 格式？我的意思是将问题转换为系统 CNF 并以 DIMACS 格式输出。如果没有，任何朝着这个方向发展的想法都会很有帮助。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T00:29:07.973

DIMACS 格式非常原始，它只支持布尔变量。Z3 不会将所有问题都归结为 SAT。有些问题可以使用命题 SAT 求解器来解决，但这不是规则。这通常仅在输入仅包含布尔和/或位向量变量时才会发生。此外，即使输入问题仅包含布尔变量和位向量变量，也不能保证 Z3 会使用纯 SAT 求解器来求解它。

话虽如此，您可以使用[战术框架](http://rise4fun.com/Z3Py/tutorial/strategies)来控制 Z3。例如，对于位向量问题，以下策略会将其转换为 CNF 格式的命题公式。将其转换为 DIMACS 应该很简单。这是示例。您可以在线尝试：[http ://rise4fun.com/Z3Py/E1s](http://rise4fun.com/Z3Py/E1s)

```
x, y, z = BitVecs('x y z', 16)
g = Goal()
g.add(x == y, z > If(x < 0, x, -x))
print g
# t is a tactic that reduces a Bit-vector problem into propositional CNF
t = Then('simplify', 'bit-blast', 'tseitin-cnf')
subgoal = t(g)
assert len(subgoal) == 1
# Traverse each clause of the first subgoal
for c in subgoal[0]:
  print c 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-10-11T14:20:33.007

感谢莱昂纳多的回答，我想出了这段代码，可以满足你的要求：

```
private static void Output(Context ctx,Solver slv)
{
    var goal = ctx.MkGoal();
    goal.Add(slv.Assertions);
    var applyResult = ctx.Then(ctx.MkTactic("simplify"),
        ctx.MkTactic("bit-blast"),
        ctx.MkTactic("tseitin-cnf")).Apply(goal);

    Debug.Assert(applyResult.Subgoals.Length==1);

    var map = new Dictionary<BoolExpr,int>();
    foreach (var f in applyResult.Subgoals[0].Formulas)
    {
        Debug.Assert(f.IsOr);
        foreach (var e in f.Args)
            if (e.IsNot)
            {
                Debug.Assert(e.Args.Length==1);
                Debug.Assert(e.Args[0].IsConst);
                map[(BoolExpr)e.Args[0]] = 0;
            }
            else
            {
                Debug.Assert(e.IsConst);
                map[(BoolExpr)e] = 0;
            }
    }

    var id = 1;
    foreach (var key in map.Keys.ToArray())
        map[key] = id++;

    using (var fos = File.CreateText("problem.cnf"))
    {
        fos.WriteLine("c DIMACS file format");
        fos.WriteLine($"p cnf {map.Count} {applyResult.Subgoals[0].Formulas.Length}");
        foreach(var f in applyResult.Subgoals[0].Formulas)
        {
            foreach (var e in f.Args)
                if (e.IsNot)
                    fos.Write($"{map[(BoolExpr)e.Args[0]]} ");
                else
                    fos.Write($"-{map[(BoolExpr)e]} ");

            fos.WriteLine("0");
        }
    }
} 
```

要使其正常工作，您应该通过调用将所有约束直接添加到求解器`slv.Assert(...)`。

# c# - 如何返回目录列表而不是 url？

> ID：13059098
> 
> 赞同：0
> 
> 时间：2012-10-24T22:56:18.373
> 
> 标签：c#

> **可能重复：**
> [我如何获取一个字符串并每次从数组中返回一个字符串？](https://stackoverflow.com/questions/13058827/how-can-i-get-a-string-and-return-each-time-a-string-from-array)

我有这个功能：

```
private List<string> getLinks(HtmlAgilityPack.HtmlDocument document)
        {

            List<string> mainLinks = new List<string>();
            var linkNodes = document.DocumentNode.SelectNodes("//a[@href]");
            if (linkNodes != null)
            {
                foreach (HtmlNode link in linkNodes)
                {
                    var href = link.Attributes["href"].Value;
                    if (href.StartsWith("http://") == true || href.StartsWith("https://") == true || href.StartsWith("www") == true) // filter for http 
                    {
                        mainLinks.Add(href);
                    }
                }
            }

            return mainLinks;

        } 
```

它得到一个 url 并返回 url 的列表。相反，我希望该函数将获得一个目录，例如 c:\ 它会返回一个包含 c:\ 中所有目录的列表，而不是子目录，只是 c:\ 中的目录，在我的情况下，它应该是一个包含 14 个目录的列表.

List 一个目录中的每个索引的含义。

我该怎么做 ？尝试使用 Directory 和 DirectoryInfo 但我搞砸了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:04:06.967

静态方法`Directory.EnumerateDirectories(string path)`返回

```
An enumerable collection of the full names (including paths) for the directories in the directory specified by path. 
```

资料来源：[MSDN](http://msdn.microsoft.com/en-us/library/dd383304.aspx)

您可以使用类中的方法`Path`来获取目录的名称，例如`Path.GetDirectoryName(string path)`. 仔细阅读[MSDN](http://msdn.microsoft.com/en-us/library/system.io.path.getdirectoryname.aspx)上的文档。

# spring-security - Spring Security 和 LDAP MD5 认证

> ID：13059100
> 
> 赞同：2
> 
> 时间：2012-10-24T22:56:25.910
> 
> 标签：spring-security, ldap, spring-ldap

我需要使用密码比较进行密码以 LDAP MD5 十六进制编码格式存储的用户的弹簧安全身份验证。对于 LDAP SHA 编码，我可以使用`LDAPShaPasswordEncoder`. 我应该为 LDAP MD5 编码使用哪个编码器？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-12-06T16:27:22.770

```
<bean id="ldapAuthenticationProvider"
    class="org.springframework.security.ldap.authentication.LdapAuthenticationProvider">
    <constructor-arg>
        <bean class="org.springframework.security.ldap.authentication.PasswordComparisonAuthenticator">
            <constructor-arg ref="contextSource" />
            <property name="passwordEncoder">
                <bean class="org.springframework.security.authentication.encoding.Md5PasswordEncoder" />
            </property>
            <property name="userDnPatterns">
                <list>
                    <value>uid={0},ou=people</value>
                </list>
            </property>
        </bean>
    </constructor-arg>
    <constructor-arg>
        <bean
            class="org.springframework.security.ldap.userdetails.DefaultLdapAuthoritiesPopulator">
            <constructor-arg ref="contextSource" />
            <constructor-arg value="ou=groups" />
            <property name="groupSearchFilter" value="(member={0})" />
            <property name="rolePrefix" value="ROLE_" />
            <property name="searchSubtree" value="true" />
            <property name="convertToUpperCase" value="true" />
        </bean>
    </constructor-arg>
</bean> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-21T15:19:06.473

没有一个支持MD5的。你必须`PasswordEncoder`自己实现。您可以`LdapShaPasswordEncoder`用作指南。它应该非常简单，尤其是在不涉及盐的情况下。

您可能应该开始考虑迁移到在哈希中包含盐的更安全的系统。例如，也许您的目录可以支持多种格式，并且您可以将 SSHA 用于新用户或密码更改。

# python - django模板中的变量不起作用

> ID：13059104
> 
> 赞同：-1
> 
> 时间：2012-10-24T22:56:50.260
> 
> 标签：python, django, django-templates

我的上下文字典没有发送到我的模板。我有功能

```
from django.shortcuts import render_to_response
from django.template import RequestContext
def home(request):
  return render_to_response('home.html',{'test':'test'},context_instance=RequestContext(request)) 
```

我有简单的模板，例如：

```
<html>
<body>
my test == {{test}}
</body>
</html> 
```

当我在浏览器中打开我的网站时，我有“我的测试 ==”。settings.py 是默认的。我不使用定制的东西。什么问题？服务器是带有 wsgi 模块的 apache。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2015-11-29T17:47:19.210

我知道，但我现在才看到你的帖子。你做得很好，但你需要做更多的事情。这是视图

```
def home(request):
    # You need to retrieve something from the database or create a variable here
    test = Test.Objects.all()
    # Use Context Dic
    context = {
    'test': test,
    }
    # Then Use the return
    return render(request, 'home.html', context) 
```

（已编辑）现在这将起作用。

# android - 如果可用，支持更新的 api 函数

> ID：13059111
> 
> 赞同：3
> 
> 时间：2012-10-24T22:57:12.653
> 
> 标签：android, android-4.0-ice-cream-sandwich, android-3.0-honeycomb

**我的问题：**如果可用，我可以支持较旧的 api 并使用较新 api 的功能吗？

**我的情况：**我正在构建一个简单的应用程序，如果可用，我想通过 UI 支持一些高级功能。但是我支持的 API 级别是 13，所以我可以支持 Android 3.2。具体来说，我想使用`View.SYSTEM_UI_FLAG_*`变量，但这些变量在 api 级别 13 中不可用。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T23:00:05.217

是的，您可以在运行时检查：

```
if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.HONEYCOMB) {
   // my code using HC API
} else {
   // code that works on older API
} 
```

并且您必须将`android:targetSdkVersion`应用程序的清单设置为您想要支持的**最高**API 版本，否则您将无法构建它。

请参阅[此`<uses-sdk>`相关文章](http://developer.android.com/guide/topics/manifest/uses-sdk-element.html)。

# http - RESTfully 请求表示的子部分是某种内容类型

> ID：13059112
> 
> 赞同：1
> 
> 时间：2012-10-24T22:57:18.597
> 
> 标签：http, rest, content-type

我请求（通过`Accept: application/json`）我正在设计的 API 以 JSON 响应。但是，我希望将该 JSON 中的值指定为符合`text/plain`或`text/html`取决于客户端的功能。

“子类型”的 RESTful 最佳实践是什么？如果我正式切换到 HAL 作为顶级容器，这将如何工作？

### 接受：application/json+text/plain

```
{
  "value": "Hello World"
} 
```

### 接受：应用程序/json+text/html

```
{
  "value": "<h2>Hello World</h2>"
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T12:40:09.820

您是否考虑过在 Accept: 标头中使用参数？例如，请参阅如何为 JSON-LD [http://json-ld.org/spec/latest/json-ld-syntax/#application-ld-json](http://json-ld.org/spec/latest/json-ld-syntax/#application-ld-json)定义配置文件参数。因此，例如，您的接受标头将是 `application/json; profile="http://mysite.org/json-type/html"`

另请记住，不推荐使用 RFC 1341 中定义的 X 字段：[https ://www.rfc-editor.org/rfc/rfc6648](https://www.rfc-editor.org/rfc/rfc6648)

# python - 正则表达式未按预期运行

> ID：13059114
> 
> 赞同：1
> 
> 时间：2012-10-24T22:57:40.407
> 
> 标签：python, html, regex

我有以下函数，它应该读取`.html`文件并搜索`<input>`标签，并将`<input type='hidden'>`标签注入到要显示在页面中的字符串中。但是，该条件永远不会满足：（例如，该`if`语句永远不会执行。）我的正则表达式有什么问题？

```
 def print_choose( params, name ):

   filename = path + name
   f = open( filename, 'r' )
   records = f.readlines()
   print "Content-Type: text/html"
   print
   page = ""
   flag = True
   for record in records:
        if re.match( '<input*', str(record) ) != None:
            print record
            page += record
            page += "<input type='hidden' name='pagename' value='psychology' />"
        else:
            page += record

   print page 
```

谢谢

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T23:03:10.810

`re.match`从字符串中的第一个字符开始。你确定你不想要`re.search`，它可以匹配字符串中间的模式吗？

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T22:59:48.540

> ```
>  if re.match( '<input*', str(record) ) != None: 
> ```

你可能想要`<input.*`. 现在你会匹配 on`<inputttttttttt`但不是`<input>blahblah`. `.`表示任何字符，* 表示 0 或匹配正则表达式中的最后一项，因此要求`.*`在 0 个或更多字符上重复通配符匹配。

（PS检查正则[表达式](http://regexpal.com/)的正则表达式调试）

# sql-server - 坚持使用 TEXT、NTEXT 和 IMAGE 而不是 (N)VARCHAR(max) 和 VARBINARY(max) 的原因

> ID：13059118
> 
> 赞同：0
> 
> 时间：2012-10-24T22:58:23.630
> 
> 标签：sql-server, sql-server-2012, deprecated

TEXT、NTEXT 和 IMAGE 很久以前就已被弃用，最终将从 SQL Server 中删除。

但是，它们不会立即停产，即使在下一版本的 SQL Server 中也不会，因此我的企业不方便立即转换数千列，即使它使用的是 SQL Server 2012。

我可以使用哪些论据来推迟此迁移？

我知道使用新类型有一些优势。但我正在严格寻找不迁移在旧类型中已经运行良好的数据的原因。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:21:31.433

**坚持**使用 TEXT、NTEXT 和 IMAGE 而不是 (N)VARCHAR(max) 和 VARBINARY(max) 的原因

1.  他们目前工作
2.  您的代码在 SQL CE 上的工作与在 SQL Server 上的工作相同
    *   论点只适用于小型数据库
3.  目前没有预算可以这样做
4.  贵公司将因折叠/产品在“已弃用的功能”变为“停止”之前设置到期日期
5.  你不关心你的工作

**不坚持**的原因

 **1.  他们将来不会工作
2.  紧要关头，每个人都会有压力，而且你的修复时间很短
3.  您需要使用 TEXTPRT、WRITETEXT 等遗留方法进行编码，并将所有 TEXT/IMAGE 转换为 VARCHAR/VARBINARY 以执行任何有用的工作

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:07:23.307

我能想到的不迁移到新类型的唯一原因是，对于今天的 John Assymptoth 来说它更容易。

如果您不关心新类型的优势或您正在使用的类型有一天会被删除这一事实，我想不出一个令人信服的迁移理由（不是有人问过，但恕我直言，这些都是很好的理由）。不过，未来的 John Assymptoth 可能不喜欢它……

如果你搬到更绿色的牧场，而下一个人由于某种原因没有意识到这个问题，你的雇主可能会有点不高兴。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T01:12:33.027

您真的不想在以后的某个时间点被迫迁移。您现在的论点应该是，尝试整体更改它们会给企业带来重大风险；这应该足以暂时阻止更改。您需要进行概念验证，确定总共需要多少停机时间（您可能必须将其分解为批量更改），制定迁移到新数据类型的计划并进行测试。然后真正努力前进。即使是山最终也让位给河流......

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T01:07:42.243

我建议你现在开始切换。这样，您可以一次更改一个，而不必在此功能实际停用时一次全部更改。**

# jquery - 为什么加载动态对话框后找不到div标签？

> ID：13059120
> 
> 赞同：2
> 
> 时间：2012-10-24T22:58:42.153
> 
> 标签：jquery, dialog

我正在使用 jQuery UI 将 htm 文件动态加载到对话框中。在这个对话框中，我通过加载另一个 htm 文件来创建另一个对话框。在加载完成后，我将一些 html 代码动态插入到#test div 标记中。这在我第一次打开两个对话框时工作正常，但是如果我关闭它们然后重新打开，则不会插入代码。如果我关闭第二个对话框然后重新打开它，它现在又可以正常工作了。所以我的问题是：为什么 jquery 第二次找不到 div id？

这是我的测试代码：

主.js：

```
function opendialog1()
{
  $("#popup1").empty().load("dialog1.htm").dialog({title:"Dialog 1",width:300, height:200});
}

function opendialog2()
{
  $("#popup2").empty().load("dialog2.htm",Dialog2Loaded).dialog({title:"Dialog 2",width:300, height:200});
}

function Dialog2Loaded()
{
  var html="This is a test";
  $("#test").append(html); 
} 
```

索引.html：

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0   Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
    <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

    <link type="text/css" href="css/custom-theme/jquery-ui-1.9.0.custom.css" rel="stylesheet" />

    <script type="text/javascript" src="js/jquery-1.8.2.min.js"></script>
    <script type="text/javascript" src="js/jquery-ui-1.9.0.custom.min.js"></script>
    <script type="text/javascript" src="Main.js"></script>
    </head>

    <body>

    <a href="#" onclick="opendialog1();">Open Dialog 1</a>

    <div id="popup1"></div>

    </body>
    </html> 
```

Dialog1.htm

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd">
    <html><head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1"> 
    </head>

    <body>

    <a href="#" onclick="opendialog2();">Open Dialog 2</a>

    <div id="popup2"></div>

    </body></html> 
```

Dialog2.htm:

```
 <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" 
"http://www.w3.org/TR/html4/loose.dtd">
    <html><head>
    <meta http-equiv="Content-Type" content="text/html;charset=ISO-8859-1"> 
    </head>

    <body>

    <div id="test"></div>

    </body></html> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:02:41.980

当您关闭对话框时， div 会被删除。使用 Chrome 的 dev tolls（或 FireBug）来检查 DOM，看看它在 close() 调用之后是如何变化的。

# file - PowerShell 在某些情况下替换 CRLF

> ID：13059124
> 
> 赞同：0
> 
> 时间：2012-10-24T22:58:56.100
> 
> 标签：file, powershell, replace, newline

我是 PowerShell 的新手，希望在文本文件中的某些情况下替换 CRLF。

一个示例文本文件将是：

```
Begin 1 2 3
End 1 2 3
List asd asd
Begin 1 2 3
End 1 2 3
Begin 1 2 3
End 1 2 3
Sometest asd asd
Begin 1 2 3 
```

如果一行不是以 Begin 或 End 开头，我希望将该行附加到前一行。

所以期望的结果是：

```
Begin 1 2 3
End 1 2 3 List asd asd
Begin 1 2 3
End 1 2 3
Begin 1 2 3
End 1 2 3 Sometest asd asd
Begin 1 2 3 
```

该文件是制表符分隔的。所以在 Begin 和 End 之后，是一个 TAB。

我尝试了以下方法，只是为了摆脱所有不起作用的 CRLF：

```
$content = Get-Content c:\test.txt
$content -replace "'r'n","" | Set-Content c:\test2.txt 
```

我已经阅读了 PowerShell 上的 MSDN 并且可以替换不同行上的文本，而不是像这样的多行:(

我在家里测试 Windows 7，但这是为了工作，将在 Vista 上。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T07:32:05.237

```
# read the file
$content = Get-Content file.txt

# Create a new variable (array) to hold the new content
$newContent = @()

# loop over the file content    
for($i=0; $i -lt $content.count; $i++)
{  
  # if the current line doesn't begin with 'begin' or 'end'   
  # append it to the last line םכ the new content variable
  if($content[$i] -notmatch '^(begin|end)')
  {
    $newContent[-1] = $content[$i-1]+' '+$content[$i]
  } 
  else
  {
    $newContent += $content[$i]
  }
}

$newContent 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T04:09:04.760

你觉得这一行怎么样？

```
gc "beginend.txt" | % {}{if(($_ -match "^End")-or($_ -match "^Begin")){write-host "`n$_ " -nonewline}else{write-host $_ -nonewline}}{"`n"}

Begin 1 2 3
End 1 2 3 List asd asd
Begin 1 2 3
End 1 2 3
Begin 1 2 3
End 1 2 3 Sometest asd asd
Begin 1 2 3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T01:15:21.933

```
$data = gc "beginend.txt"

$start = ""
foreach($line in $data) {
    if($line -match "^(Begin|End)") {
        if($start -ne "") {
            write-output $start
        }
        $start = $line
    } else {
        $start = $start + " " + $line
    }
}

# This last part is a bit of a hack.  It picks up the last line
# if the last line begins with Begin or End.  Otherwise, the loop
# above would skip the last line.  Probably a more elegant way to 
# do it :-)
if($data[-1] -match "^(Begin|End)") {
    write-output $data[-1]
} 
```

# silverlight - EF5 Code First 和 RIA 服务 Silverlight“对象引用未设置为对象的实例”错误构建客户端

> ID：13059127
> 
> 赞同：6
> 
> 时间：2012-10-24T22:59:23.167
> 
> 标签：silverlight, entity-framework, ef-code-first, wcf-ria-services, silverlight-5.0

我正在使用 RIA 服务在 Silverlight 中使用 Code First 为实体框架 5 设置一个新项目。由于遇到的一些问题，我创建了一个测试项目，并将在下面发布代码。

即，每当我尝试构建应生成客户端代理类的 silverlight 客户端项目时，都会收到“对象引用未设置为对象的实例”错误。

需要明确的是，此错误不是在运行或调试应用程序时出现，而是在构建时出现。

我已经隔离，只有在我的 Code First 类上定义了任何导航属性/外键时才会发生这种情况。

今晚的任何帮助将不胜感激。

```
 public class Person
{
    public int PersonId { get; set; }
    public string FirstName { get; set; }
    public string LastName { get; set; }
    public DateTime? BirthDate { get; set; }

    public virtual List<Character> Characters { get; set; }
}

public class Character
{
    public int CharacterId { get; set; }
    public int PersonId { get; set; }
    public virtual Person Person { get; set; }
    public string CharacterName { get; set; }
}

public class CharacterDbContext : DbContext
{
    public DbSet<Person> Persons { get; set; }
    public DbSet<Character> Characters { get; set; }

    public CharacterDbContext()
    {
        if (HttpContext.Current == null)
        {
            Database.SetInitializer<CharacterDbContext>(null);
        }
    }
}

[EnableClientAccess]
public class CharacterDbService : DbDomainService<CharacterDbContext>
{
    #region Basic Methods for Person with the context property of Persons

    [Query]
    public IQueryable<Person> GetPersons()
    {
        return DbContext.Persons;
    }

    [Insert]
    public void InsertPerson(Person entity)
    {
        DbEntityEntry<Person> entityEntry = DbContext.Entry(entity);
        if (entityEntry.State != EntityState.Detached)
        {
            entityEntry.State = EntityState.Added;
        }
        else
        {
            DbContext.Persons.Add(entity);
        }
    }

    [Update]
    public void UpdatePerson(Person entity)
    {
        DbContext.Persons.AttachAsModified(entity, ChangeSet.GetOriginal(entity), DbContext);
    }

    [Delete]
    public void DeletePerson(Person entity)
    {
        DbEntityEntry<Person> entityEntry = DbContext.Entry(entity);
        if (entityEntry.State != EntityState.Deleted)
        {
            entityEntry.State = EntityState.Deleted;
        }
        else
        {
            DbContext.Persons.Attach(entity);
            DbContext.Persons.Remove(entity);
        }
    }

    #endregion

    #region Basic Methods for Character with the context property of Characters

    [Query]
    public IQueryable<Character> GetCharacters()
    {
        return DbContext.Characters;
    }

    [Insert]
    public void InsertCharacter(Character entity)
    {
        DbEntityEntry<Character> entityEntry = DbContext.Entry(entity);
        if (entityEntry.State != EntityState.Detached)
        {
            entityEntry.State = EntityState.Added;
        }
        else
        {
            DbContext.Characters.Add(entity);
        }
    }

    [Update]
    public void UpdateCharacter(Character entity)
    {
        DbContext.Characters.AttachAsModified(entity, ChangeSet.GetOriginal(entity), DbContext);
    }

    [Delete]
    public void DeleteCharacter(Character entity)
    {
        DbEntityEntry<Character> entityEntry = DbContext.Entry(entity);
        if (entityEntry.State != EntityState.Deleted)
        {
            entityEntry.State = EntityState.Deleted;
        }
        else
        {
            DbContext.Characters.Attach(entity);
            DbContext.Characters.Remove(entity);
        }
    }

    #endregion
} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T06:58:09.013

您的外键字段未映射，因此代理代码生成器（在编译期间调用以构建代理的代码段）无法解释它们。
你应该在你的 DbContext 中放入类似的*东西*

```
 protected override void OnModelCreating(DbModelBuilder modelBuilder)
 {
      modelBuilder.Entity<Character>()
          .HasRequired(x=> x.Person)
          .WithMany(x=> x.Characters)
          .HasForeignKey(x=> x.PersonId);
 } 
```

另外，我建议您将您的更改
`public virtual List<Character> Characters { get; set; }`
为
`public virtual ICollection<Character> Characters { get; set; }`，因为我不确定代理生成器（以及 EF 也是）是否会正确映射该列表。
**编辑：**
我认为 EF Metadataprovider 没有在描述中提供正确的属性。
在 Character.CharacterId 和Person.PersonID 上加上一个`KeyAttribute`，另外，在 Character.Person 上添加这一行

```
[Association("Character_Person", "PersonId", "PersonId", IsForeignKey = true)] 
```

而这个超过 Person.Characters

```
Association("Character_Person", "PersonId", "PersonId")]<br> 
```

**编辑：**
在与 KitKat 聊天后，我们终于找到了问题所在。在代理生成期间，对 Assembly.GetExportedTypes 的调用崩溃了，抱怨它需要 EF 4.1。简单的推杆

```
<runtime>
<assemblyBinding xmlns="urn:schemas-microsoft-com:asm.v1">
  <dependentAssembly>
    <assemblyIdentity name="EntityFramework" publicKeyToken="b77a5c561934e089" culture="neutral" />
    <bindingRedirect oldVersion="0.0.0.0-5.0.0.0" newVersion="5.0.0.0" />
  </dependentAssembly>
</assemblyBinding> 
```

在相关配置中做了技巧

注意：在此[链接](http://mcasamento.blogspot.it/2012/10/entity-framework-5-code-first-and-wcf.html)上，我的博客文章更好地解释了如何首先处理 EF5 代码和 WCF Ria 服务

# java - JAVA 嵌套循环用法

> ID：13059129
> 
> 赞同：0
> 
> 时间：2012-10-24T22:59:29.750
> 
> 标签：java, for-loop, nested-loops

我有一个任务，我正在尝试使用嵌套的 for 循环来完成，但我似乎无法弄清楚我该如何做到这一点。

我需要：

**编写一个程序来模拟掷一对 11 面骰子，并确定掷骰子的每种可能组合的次数百分比。要求用户输入掷骰子的次数。计算每个骰子组合的概率。**

我不太了解如何处理卷的结果（我已经弄清楚了），这是我在代码中的位置：

```
for(int x = 0; x < total_rolls; x++){
      int result = roll(sides); //roll(sides) gets two random ints under 12, then adds them together

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:45:01.943

听起来您想计算骰子值组合的频率（出现次数）。

您可以创建一个尺寸为 11x11 的矩阵。每当您`6`掷骰子 1 和`10`骰子 2 之类的组合时，都会增加矩阵中的该单元格。您可以将此矩阵视为直方图。

然后通过从矩阵中读取一个条目并将其除以`total_rolls`

这可能看起来像这样

```
int[][]histogram = new int[11][11];
for(int x = 0; x < total_rolls; x++){
  int dice1 = roll(sides); //result of dice 1 (1-11)
  int dice2 = roll(sides); //result of dice 2 (1-11)
  histogram[dice1-1][dice2-1]++; //increment the frequency of this event
}

double prob = 1.0*histogram[5][9]/total_rolls; //probability of combination (6,10) 
```

需要注意两个细节，java 中的数组是 0 索引的。两个整数的除法也得到一个整数，所以我们通过乘以双精度字面量 1.0 来将它作为一个双精度数和一个整数的除法；

# silverlight - WP7 上的 DataTemplate 问题

> ID：13059134
> 
> 赞同：-1
> 
> 时间：2012-10-24T22:59:57.483
> 
> 标签：silverlight, windows-phone-7

我有一个`DataTemplate`在 App.xaml 中定义的，用于 2 个地方（`ItemControls`）。

除了文本的颜色外，它对两者都适用。

我假设如果我`StaticResource`在这两个具有不同值的地方将画笔定义为 a ，它将起作用，因为它将向上移动通过视觉树试图找到画笔资源。但正如`DataTemplate`定义的那样`App.xaml`，它只在 App 资源中查找画笔，而不是在使用的地方`DataTemplate`。

我可以`DataTemplate`用自定义画笔以某种方式重用 2 个地方吗（在 App.xaml 中没有任何全局画笔）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T09:13:53.800

我可以建议您一种方法，但我不知道它是否是您问题的最佳解决方案。

您可以做的是将您的数据模板移动到用户控件并在用户控件资源中定义您的画笔，这样您就可以使用相同的画笔重用您的控件。我希望它有所帮助。

# xml - 如何使用 Arduino 将这个 Twitter 搜索页面作为 XML 阅读？

> ID：13059139
> 
> 赞同：0
> 
> 时间：2012-10-24T23:00:27.753
> 
> 标签：xml, twitter, arduino

如何`https://api.twitter.com/search/realtime?q=%40hooperstuart&src=typd`用 Arduino 阅读页面？

我希望能够仅读取 XML，就像使用 Twitter 客户端示例草图一样。我只是不确定如何将它用于不同的页面。

基本上，当人们向我发推文时，我希望能够在 Arduino 以太网屏蔽上“敲响铃铛”或“点亮 LED”。

我只是不太确定如何将我的提及视为 XML。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-01T09:03:26.530

您的提及需要 OAuth 授权，因此与 RSS 提要阅读器不兼容。如果您使用 API 来获取它们，它们将以 XML 格式提供。看到[这个](https://dev.twitter.com/docs/api/1/get/statuses/mentions)了解更多信息

# python - ruby 或 python 与 sqlite 数据库一起使用？

> ID：13059142
> 
> 赞同：0
> 
> 时间：2012-10-24T23:00:46.423
> 
> 标签：python, ruby, sqlite

这两种语言中哪一种接口更好，并为使用 sqlite 数据库提供更好的性能/工具集？我熟悉这两种语言，但需要为我正在开发的项目选择一种语言，所以我想我会在这里问。我不认为这是自以为是的，因为语言的性能是相当客观的。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T23:06:27.467

就 sqlite 性能或可用性而言，没有充分的理由选择其中一个。

两种语言都具有完全可用的（和 pythonic/rubyriffic）sqlite3 绑定。

在这两种语言中，除非您做一些愚蠢的事情，否则性能受 sqlite3 性能的限制，而不是绑定。

两种语言的绑定都没有缺少任何不常见但有时对性能至关重要的功能（例如“exec many”、手动事务管理等）。

可能有特定语言的框架在与 sqlite3 的集成方面更好或更差，但此时您是在框架而不是语言之间进行选择。

# .net - 用户代码未处理 InvalidOperationException 对象当前在其他地方使用 .net

> ID：13059143
> 
> 赞同：0
> 
> 时间：2012-10-24T23:00:59.433
> 
> 标签：.net, invalidoperationexception

我相信我发现了与[InvalidOperationException 类似的案例 - 对象当前正在其他地方使用](https://stackoverflow.com/questions/1851292/invalidoperationexception-object-is-currently-in-use-elsewhere)；但是，那是在我使用 .net 的地方使用 c#，我不明白如何将它应用到我的程序中。

我的程序是尝试制作街机游戏太空入侵者的基本复制品，并使用后台工作人员来控制他们的移动。这是代码通常会出错的地方：

```
If Invader4.Left < Me.Width - 75 Then
    Invader4.Left += 3
    If Invader4.Tag = "OrangeSpaceInvader1" Then
        Invader4.Image = My.Resources.OrangeSpaceInvaderBlk2
        Invader4.Tag = "OrangeSpaceInvader2"
    ElseIf Invader4.Tag = "OrangeSpaceInvader2" Then
        Invader4.Image = My.Resources.OrangeSpaceInvaderBlk
        Invader4.Tag = "OrangeSpaceInvader1"
    End If
    Threading.Thread.Sleep(TimeSpan.FromSeconds(X))
End If 
```

这不仅发生在 Invader4 上，正如我所看到的关于 Invader13、Invader2 以及几乎所有这些的弹出。我总共有 16 个，Invaders1-16。我的这段特定代码是关于将它们在屏幕上向右移动。包含错误的框的代码行作为第二行，

```
Invader4.Left += 3 
```

我通过阅读其他问题的答案了解到多个线程正在尝试同时访问入侵者，尽管我不确定我的程序中发生了什么。在我启动控制每个入侵者移动的后台工作人员后，或者当他们处于一半时，或者介于两者之间或之后的任何位置时，程序可能会立即出现此错误。

# javascript - .scale() 取消了扩展：函数（选项）。如何让这两个一起玩得很好？

> ID：13059145
> 
> 赞同：2
> 
> 时间：2012-10-24T23:01:15.457
> 
> 标签：javascript, jquery, galleria

使用 Galleria 1-2-8，经典主题。

我有..

```
$('#galleria').galleria({
    imageCrop: "false",
    thumbnails: 'lazy',
    carouselSteps: 1,
    transition: 'flash',
    transitionSpeed: 800,

    extend: function(options) {
        var gallery = this;

        this.bind(Galleria.IMAGE, function(e) {
            TONS OF CODE
        });
    }
}); 
```

然后在我下面

```
Galleria.ready(function(options) {
    this.bind('image', function(e) {
        this.lazyLoadChunks( 3, 200 );
        this.scale();
    });
}); 
```

行“this.scale();” 是一个新的补充。该代码之前运行良好，但我不得不对主图像强制重新缩放。原因是，我对 Galleria 进行了大量调整，并且遇到了缩略图滚动行为非常不稳定的问题。为了修复奇怪的缩略图行为，我模拟了单击 nav-right 箭头 div 和单击 Galleria.ready 底部的 nav-left 箭头 div —— 我没有在上面的代码中向您展示。

```
$('.galleria-image-nav-right').click();
$('.galleria-image-nav-left').click(); 
```

我之所以选择这样做是因为我注意到，当我作为用户单击主图像的下一个箭头时，它修复了缩略图滚动问题。因此，我在 Galleria 加载后强制单击下一个图像，然后单击返回（同时在所有图像上显示加载图像，因此用户不会注意到）。

无论如何..当我在图像上调用 .scale() 时，它会覆盖我在上面的第一个代码块中编写的所有选项。它完全消除了它们，就好像它们从未存在过一样。我已经在代码中使用警报进行了测试，以查看我设置的变量是否仍然存在，而它们不存在。

我尝试了不同的方法..scale()、.refreshImage()、._scaleImage() 等，但是它们都相互引用并且都存在取消扩展的相同问题：函数（选项）的东西。

请帮忙！

如果这些信息还不够，或者您需要完整查看我的代码，这里是..

```
<script type="text/javascript">
        Galleria.loadTheme('/js/galleria.classic.js');
            $('#galleria').galleria({
                imageCrop: "false",
                thumbnails: 'lazy',
                carouselSteps: 1,
                transition: 'flash',
                transitionSpeed: 800,

            extend: function(options) {
                var gallery = this;
                this.bind(Galleria.IMAGE, function(e) {

                    // $(window).resize(function() {
                        // this.scale();
                    // });//yep, tried it here.. no luck

                    var current = gallery.getData(gallery.getIndex());
                    var currImg = current.original;
                    var altText = $(currImg).attr('alt');
                    var src = $(currImg).attr('src');
                    var thehref = $(currImg).parent().attr('href');
                    var actualCurrent = $(currImg).parent();
                    getFFData(altText);

                    function getSource(val) {
                        var source = val;
                        while(source) {
                            if( n=source.indexOf("Vertical/") ) {
                                if(n!==-1) {
                                    $(".galleria-images img").removeClass();
                                    $(".galleria-images img").addClass("vertIMG");
                                    $("#galleria-bigImage-popup").addClass("vertDIV");
                                    $(".galleria-info-title").css("right", "34.2%");
                                    $(".galleria-info-title").css("top", "45%");
                                    $(".galleria-info").css("top", "94%");
                                    $(".galleria-info").css("display", "block");
                                    $(".galleria-info-title").css("display", "block");
                                    $(".galleria-info-text").css("visibility", "visible");
                                    $(".galleria-info-text").fadeIn(800);
                                }
                            }
                            if( n=source.indexOf("Horizontal/") ) {
                                if(n!==-1) {
                                    $(".galleria-images img").removeClass();
                                    $(".galleria-images img").addClass("horizIMG");
                                    $("#galleria-bigImage-popup").addClass("horizDIV");
                                    $(".galleria-info-title").css("right", "25.8%");
                                    $(".galleria-info-title").css("top", "45%");
                                    $(".galleria-info").css("top", "94%");
                                    $(".galleria-info").css("display", "block");
                                    $(".galleria-info-title").css("display", "block");
                                    $(".galleria-info-text").css("visibility", "visible");
                                    $(".galleria-info-text").fadeIn(800);
                                }
                            }
                            if( n=source.indexOf("Pano/") ) {
                                if(n!==-1) {
                                    $(".galleria-images img").removeClass();
                                    $(".galleria-images img").addClass("panoIMG");
                                    $("#galleria-bigImage-popup").addClass("panoDIV");
                                    $(".galleria-info-title").css("right", "25.8%");
                                    $(".galleria-info-title").css("top", "inherit");
                                    $(".galleria-info").css("top", "73%");
                                    $(".galleria-info").css("display", "block");
                                    $(".galleria-info-title").css("display", "block");
                                    $(".galleria-info-text").css("visibility", "visible");
                                    $(".galleria-info-text").fadeIn(800);
                                }
                            }
                            if( n=source.indexOf("Pano-Tall/") ) {
                                if(n!==-1) {
                                    $(".galleria-images img").removeClass();
                                    $(".galleria-images img").addClass("panoTallIMG");
                                    $("#galleria-bigImage-popup").addClass("panoTallDIV");
                                    $(".galleria-info-title").css("right", "25.8%");
                                    $(".galleria-info-title").css("top", "inherit");
                                    $(".galleria-info").css("top", "84%");
                                    $(".galleria-info").css("display", "block");
                                    $(".galleria-info-title").css("display", "block");
                                    $(".galleria-info-text").css("visibility", "visible");
                                    $(".galleria-info-text").fadeIn(800);

                                }
                            }
                            if( n=source.indexOf("Pano-Vert/") ) {
                                if(n!==-1) {
                                    $(".galleria-images img").removeClass();
                                    $(".galleria-images img").addClass("panoVertIMG");
                                    $("#galleria-bigImage-popup").addClass("panoVertDIV");
                                    $(".galleria-info-title").css("right", "42.1%");
                                    $(".galleria-info-title").css("top", "45%");
                                    $(".galleria-info").css("top", "94%");
                                    $(".galleria-info").css("display", "block");
                                    $(".galleria-info-title").css("display", "block");
                                    $(".galleria-info-text").css("visibility", "visible");
                                    $(".galleria-info-text").fadeIn(800);
                                }
                            }
                            return;
                        }//end while
                    }// end function getSource

                    getSource(thehref);
                    var newSrc = thehref.replace("sized","large"); //change contents of src variable to point to the large images dir.
                    getBigImage(newSrc);  //this function is located in the utils.js file

                    function bigImageResizer(val) {
                        var theA = val;//this works
                        var theImage = $(theA).find('img');//this works
                        var theSource = $(theImage).attr('src');//this works. same as var thehref
                        //how do I get the height of the IMAGE?

                        var winWidth = $(window).width();
                        var imgWidth = $(theImage).width();
                        // var widthToUse = winWidth - imgWidth;
                        // var widthToUse = winWidth * 0.09;

                        //static css
                        $('#bigPopWrap').css('max-width', winWidth);
                        $('#bigPopWrap img').css('max-width', winWidth);

                        while(theSource) {
                            if( n=theSource.indexOf("Vertical/") ) {
                                if(n!==-1) {
                                    //dynamic css
                                    $('#bigPopWrap img').css('margin-left', winWidth*0.25);
                                    $('#bigPopWrap').css('margin', 'auto');

                                    //set some vars..
                                    var OMG = $('#bigPopWrap img').width();
                                    var tipPoint = winWidth*0.68;

                                    //when window is too small to contain full size image
                                    while ( OMG > tipPoint ) {
                                        $('#bigPopWrap img').animate({
                                                marginLeft: '0'
                                        }, 500 );
                                        $('#bigPopWrap img').css('margin-left', '0');
                                        $('#bigPopWrap').animate({
                                                margin: '0'
                                        }, 500 );
                                        $('#bigPopWrap').css('margin', '0');
                                        return;
                                    }
                                    while ( OMG < tipPoint ) {
                                        $('#bigPopWrap img').stop(true);
                                        $('#bigPopWrap img').css('margin-left', winWidth*0.25);
                                        $('#bigPopWrap').stop(true);
                                        $('#bigPopWrap').css('margin', 'auto');
                                        return;
                                    }
                                }
                            }// end vertical

                            if( n=theSource.indexOf("Horizontal/") ) {
                                if(n!==-1) {
                                    //dynamic css
                                    $('#bigPopWrap img').css('margin-left', winWidth*0.1);
                                    $('#bigPopWrap').css('margin', 'auto');

                                    //set some vars..
                                    var OMG = $('#bigPopWrap img').width();
                                    var tipPoint = winWidth*0.83;

                                    //when window is too small to contain full size image
                                    while ( OMG > tipPoint ) {
                                        $('#bigPopWrap img').animate({
                                                marginLeft: '0'
                                        }, 500 );
                                        $('#bigPopWrap img').css('margin-left', '0');
                                        $('#bigPopWrap').animate({
                                                margin: '0'
                                        }, 500 );
                                        $('#bigPopWrap').css('margin', '0');
                                        // $('#bigPopWrap img').stop(true,true);
                                        // $('#bigPopWrap').stop(true,true);
                                        // $('#bigPopWrap img').css('margin-left', '0');
                                        // $('#bigPopWrap').css('margin', '0');
                                        return;
                                    }
                                    while ( OMG < tipPoint ) {
                                        $('#bigPopWrap img').stop(true);
                                        $('#bigPopWrap img').css('margin-left', winWidth*0.1);
                                        $('#bigPopWrap').stop(true);
                                        $('#bigPopWrap').css('margin', 'auto');
                                        return;
                                    }
                                }
                            }// end horizontal

                            if( n=theSource.indexOf("Pano/") ) {
                                if(n!==-1) {
                                    //dynamic css
                                    $('#bigPopWrap img').css('margin-left', winWidth*0.065);
                                    $('#bigPopWrap').css('margin', 'auto');

                                    //set some vars..
                                    var OMG = $('#bigPopWrap img').width();
                                    var tipPoint = winWidth*0.868;

                                    //when window is too small to contain full size image
                                    while ( OMG > tipPoint ) {
                                        $('#bigPopWrap img').animate({
                                                marginLeft: '0'
                                        }, 500 );
                                        $('#bigPopWrap img').css('margin-left', '0');
                                        $('#bigPopWrap').animate({
                                                margin: '0'
                                        }, 500 );
                                        $('#bigPopWrap').css('margin', '0');
                                        return;
                                    }
                                    while ( OMG < tipPoint ) {
                                        $('#bigPopWrap img').stop(true);
                                        $('#bigPopWrap img').css('margin-left', winWidth*0.065);
                                        $('#bigPopWrap').stop(true);
                                        $('#bigPopWrap').css('margin', 'auto');
                                        return;
                                    }
                                }
                            }// end pano

                            if( n=theSource.indexOf("Pano-Tall/") ) {
                                if(n!==-1) {
                                    //dynamic css
                                    $('#bigPopWrap img').css('margin-left', winWidth*0.07);
                                    $('#bigPopWrap').css('margin', 'auto');

                                    //set some vars..
                                    var OMG = $('#bigPopWrap img').width();
                                    var tipPoint = winWidth*0.864;

                                    //when window is too small to contain full size image
                                    while ( OMG > tipPoint ) {
                                        $('#bigPopWrap img').animate({
                                                marginLeft: '0'
                                        }, 500 );
                                        $('#bigPopWrap img').css('margin-left', '0');
                                        $('#bigPopWrap').animate({
                                                margin: '0'
                                        }, 500 );
                                        $('#bigPopWrap').css('margin', '0');
                                        return;
                                    }
                                    while ( OMG < tipPoint ) {
                                        $('#bigPopWrap img').stop(true);
                                        $('#bigPopWrap img').css('margin-left', winWidth*0.07);
                                        $('#bigPopWrap').stop(true);
                                        $('#bigPopWrap').css('margin', 'auto');
                                        return;
                                    }
                                }
                            }// end panotall

                            if( n=theSource.indexOf("Pano-Vert/") ) {
                                if(n!==-1) {
                                    //dynamic css
                                    $('#bigPopWrap img').css('margin-left', winWidth*0.38);
                                    $('#bigPopWrap').css('margin', 'auto');

                                    //set some vars..
                                    var OMG = $('#bigPopWrap img').width();
                                    var tipPoint = winWidth*0.5;

                                    //when window is too small to contain full size image
                                    while ( OMG > tipPoint ) {
                                        $('#bigPopWrap img').animate({
                                                marginLeft: '0'
                                        }, 500 );
                                        $('#bigPopWrap img').css('margin-left', '0');
                                        $('#bigPopWrap').animate({
                                                margin: '0'
                                        }, 500 );
                                        $('#bigPopWrap').css('margin', '0');
                                        return;
                                    }
                                    while ( OMG < tipPoint ) {
                                        $('#bigPopWrap img').stop(true);
                                        $('#bigPopWrap img').css('margin-left', winWidth*0.38);
                                        $('#bigPopWrap').stop(true);
                                        $('#bigPopWrap').css('margin', 'auto');
                                        return;
                                    }
                                }
                            }//end panovert

                            return;
                        }//end while
                    }// end function bigImageResizer

                    bigImageResizer(actualCurrent);
                    $(window).resize(function() {
                        bigImageResizer(actualCurrent);
                    });
                    $('.galleria-images').click(function () {
                        bigImageResizer(actualCurrent);
                    });

                });// end bind Galleria.IMAGE

            }// end extend function(options)

        });

    Galleria.ready(function(options) {
        // this.bind('loadfinish', function(e) {
            // $('.galleria-image').scale();
        // });

        this.bind('image', function(e) {
            this.lazyLoadChunks( 3, 200 );
            // this.scale();
            // $('#galleria').scale();
            // this.joshScale();
            // refreshImage(this);
        }); 

        this.bind('thumbnail', function(e) {
            function thumbResizer() {

                //container height
                var containerHeight = $('.galleria-thumbnails').height();
                $(window).resize(function() {
                    containerHeight = $('.galleria-thumbnails').height();
                });

                //the array
                var thumbIMGS = $('.galleria-thumbnails').find('img');

                //iterate through it
                $.each(
                    thumbIMGS,
                        function( intIndex, objValue ){

                            //thumbnail source
                            var theThumbSource = $(objValue).attr('src').replace('thumbs','sized');
                            // alert(theThumbSource);
                            // var theThumbSource = $(objValue).attr('src');

                            //modify width based on thumbnail source
                            if( n=theThumbSource.indexOf("Pano-Vert/") ) {
                                if(n!==-1) {
                                    // alert('pano-vert');
                                    $(objValue).parent().css('width', '0.175%');
                                }
                            }
                            if( n=theThumbSource.indexOf("Vertical/") ) {
                                if(n!==-1) {
                                    // alert('vert');
                                    $(objValue).parent().css('width', '0.39%');
                                }
                            }
                            if( n=theThumbSource.indexOf("Horizontal/") ) {
                                if(n!==-1) {
                                    // alert('horiz');
                                    $(objValue).parent().css('width', '0.6%');
                                }
                            }
                            if( n=theThumbSource.indexOf("Pano-Tall/") ) {
                                if(n!==-1) {
                                    // alert('pano-tall');
                                    $(objValue).parent().css('width', '0.8%');
                                }
                            }
                            if( n=theThumbSource.indexOf("Pano/") ) {
                                if(n!==-1) {
                                    // alert('pano');
                                    $(objValue).parent().css('width', '1.27%');
                                }
                            }
                    }//end function
                );//end each
            }// end function thumbResizer

            thumbResizer();

        });// end bind 'thumbnail'

        //one solution. breaks scalability
            // this.next();
            // this.prev();

        //another solution. breaks scalability
            // this.show(1);
            // this.show(0);

        //another solution. breaks scalability. what if I force rescale?
            $('.galleria-image-nav-right').click();
            $('.galleria-image-nav-left').click();

            //force rescale
            // this.bind('image', function(d) {
                // // this.lazyLoadChunks( 3, 200 );
                // $(window).resize(function() {
                    // this.scale();
                // });
            // });

        // $('.galleria-image-nav-right').attr('id', 'galleria-image-nav-right');
        // $('.galleria-image-nav-left').attr('id', 'galleria-image-nav-left');

    });// end galleria.ready
    Galleria.run('#galleria',{

    }); 
```

哦，如果您想知道，缩略图滚动问题是如何出现的？上面的函数 thumbResizer 是罪魁祸首——我们在缩略图浏览器中有五个不同方向的图像，它们都可以同时查看。该函数缩放它们以适应缩略图容器 div 的高度。

另外，我没有使用单独的缩略图，但实际上我是在伪造它，以使 Galleria 在一个名为“poop”的文件夹中查找缩略图，该文件夹不存在，它说“哎呀，找不到它”，只是使用每个缩略图的主图像，按比例缩小。我们这样做是为了减少 Galleria 的加载时间，因此它会立即变得活跃和可点击，而不是在一次加载 200 张相当大的图像时灰显和无法使用 8 分钟。请不要说“好吧，你不应该那样做！” 相信我，我知道。但是，我的雇主不这样做，并且绝对希望这样做。

在这一点上还不如写一本书.. :)

谢谢！

编辑：忘了提——虽然 this.scale() 代码在完成加载时确实修复了可伸缩性，但如果你点击下一张图像，它根本不会伸缩。并且，如果我们根本不调用 this.scale() （回到上一个主图像不重新缩放的问题），然后我们单击下一张图像，它会正确重新缩放。因此，用户点击和模拟点击之间似乎存在某种差异。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T17:54:00.317

如果您希望缩略图始终是其容器高度的 100%，那么...

```
#container img { height: 100%; } 
```

... 将管理该方面，并且在样式表或 javascript 中不设置宽度，然后将自动决定每个图像的宽度以保持其纵横比。

很好很简单，而且可以删除几行麻烦的javascript。

# sql - 在 SQL 中使用聚合函数 max

> ID：13059146
> 
> 赞同：0
> 
> 时间：2012-10-24T23:01:17.253
> 
> 标签：sql

我有以下查询

```
select 
    sub.W
from 
    (select 
        W, count(W) as N
     from L
     group by W) sub
where 
     sub.N >= max(sub.N) 
```

我得到这个错误：

> *错误代码 1111，SQL 状态 HY000：无效使用组函数*
> *第 1 行，第 1 列*

怎么了？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:08:03.170

你有没有试过这个：

```
select sub.W
from 
(
       select W, count(W) as N
       from L
       group by W
) sub
where n >= (select max(N)
            from
            (
              select count(W) as N
              from L
              group by W
            ) x) 
```

请参阅[带有演示的 SQL Fiddle](http://sqlfiddle.com/#!2/ab540/3)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:02:05.443

尝试：

```
select sub.W    
from 
(
       select W, count(W) as N
       from L
       group by W
) sub    
where sub.N >= (select max(N)
                from (
                       select W, count(W) as N
                       from L
                       group by W
                      ) sub2) 
```

# php - 为什么类似的mysql查询不会执行？

> ID：13059150
> 
> 赞同：0
> 
> 时间：2012-10-24T23:01:34.483
> 
> 标签：php, mysql

在 MYSQL 中使用 PHP PDO

以下作品

```
$customer = "2";
$ammount = "123.50";
$sql = $db->query("INSERT INTO transactions(transaction_customer,transaction_ammount) VALUES ($customer,$ammount)"); 
```

以下不起作用

```
$biggy = "Jim";
$chum = "Tester";
$sql = $db->query("insert into customers(customer_firstname,customer_lastname,customer_telephone) values ($biggy,$chum,'7576632423');"); 
```

任何想法为什么？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:03:56.923

您的第一个示例有效，因为您正在处理数字。

您需要在第二条 SQL 语句中的字符串周围加上引号

```
$sql = $db->query("insert into customers(customer_firstname,customer_lastname,customer_telephone) values ('$biggy','$chum','7576632423');"); 
```

[您可以使用 PHP 的PDO](http://php.net/manual/en/book.pdo.php)和使用准备好的语句来避免这样的陷阱，而不是手动编写 SQL。我强烈建议你调查一下：）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T23:03:50.353

字符串需要被引用。

```
... values ('$biggy','$chum','7576632423');"); 
```

不过，您也应该使用[`mysql_real_escape_string`](http://php.net/mysql_real_escape_string)。

# java - 使用映射类时的休眠条件

> ID：13059153
> 
> 赞同：0
> 
> 时间：2012-10-24T23:01:46.533
> 
> 标签：java, hibernate

我创建了一个对象，它映射了我的数据库中的两个表，即 Dictionary 表和 Token 表。表示这两个表之间连接的对象（类）称为 DictionaryToken。

这是课程：

```
import java.util.List;

import javax.persistence.CascadeType;
import javax.persistence.Column;
import javax.persistence.Entity;
 import javax.persistence.FetchType;
 import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
 import javax.persistence.Id;
import javax.persistence.OneToMany;
 import javax.persistence.Table;

import org.apache.log4j.Logger;

@Entity
@Table(name="dictionary", catalog="emscribedxcode") 
```

公共类 DictionaryToken { 私有静态 Logger LOG = Logger.getLogger(DictionaryToken.class);

```
private Long _seq;
private String _code;
private String _acute;
private String _gender;
private String _codeType;
private String _papplydate;
private String _capplydate;
private Long _tokenLength;
private List <TokenDictionary> _token;
private int _type;
private String _system;
private String _physicalsystem;
/*
 * type of 0 is a straight line insert type of 1 is a language dictionary
 * entyr type of 2 is a multiple token entry
 */
@Id
@GeneratedValue(strategy = GenerationType.AUTO)
@Column(name = "seq")
public Long getSeq() {
    return _seq;
}
public void setSeq(Long seq_) {
    _seq = seq_;
}

@Column(name = "code")
public String getCode() {
    return _code;
}
public void setCode(String code_) {
    _code = code_;
}

@Column(name = "acute")
public String getAcute() {
    return _acute;
}
public void setAcute(String acute_) {
    _acute = acute_;
}

@Column(name = "gender")
public String getGender() {
    return _gender;
}
public void setGender(String gender_) {
    _gender = gender_;
}

@Column(name = "codetype")
public String getCodeType() {
    return _codeType;
}
public void setCodeType(String codeType_) {
    _codeType = codeType_;
}

@Column(name = "papplydate")
public String getPapplydate() {
    return _papplydate;
}
public void setPapplydate(String papplydate_) {
    _papplydate = papplydate_;
}

@Column(name = "capplydate")
public String getCapplydate() {
    return _capplydate;
}
public void setCapplydate(String capplydate_) {
    _capplydate = capplydate_;
}

@Column(name = "token_length")
public Long getTokenLength() {
    return _tokenLength;
}
public void setTokenLength(Long tokenLength_) {
    _tokenLength = tokenLength_;
}
@OneToMany (mappedBy = "dictionarytoken", targetEntity = TokenDictionary.class, cascade = CascadeType.ALL, fetch = FetchType.EAGER)
public List<TokenDictionary> get_token() {
    return _token;
}
public void set_token(List<TokenDictionary> _token) {
    this._token = _token;
}
public void addToToken(TokenDictionary token){
    this._token.add(token);
}
@Column(name = "type")
public int getType() {
    return _type;
}
public void setType(int _type) {
    this._type = _type;
}
@Column(name = "physicalsystem")
public String get_physicalsystem() {
    return _physicalsystem;
}
public void set_physicalsystem(String _physicalsystem) {
    this._physicalsystem = _physicalsystem;
}
@Column(name = "codingsystem")
public String get_system() {
    return _system;
}
public void set_system(String _system) {
    this._system = _system;
}

   } 
```

这是我的问题。除非我添加条件，否则我可以毫无问题地使用具有此对象的服务执行查询。这是检索条目的方法

```
public List<DictionaryToken> getDictionaryTokenEntries(String system) {
    Session session = null;
    List<DictionaryToken> dictonaries = new ArrayList<DictionaryToken>();
    try {
        session = HibernateUtils.beginTransaction("emscribedxcode");
           session.createCriteria(Dictionary.class).addOrder(Order.desc("codeType"))

        Criteria criteria = session.createCriteria(DictionaryToken.class);
                  /*******THIS IS THE PROBLEM STATEMENT*************************/
        if (system != null) {
            criteria.add(Restrictions.eq("codingsystem", system));
        }
                  /****************************************************************/
        // dictonaries = criteria.list();
        Order order = Order.asc("seq");
        criteria.addOrder(order);
        dictonaries = criteria.list();
        System.out.println("Dictionaryentries = " + dictonaries.size());

        // System.out.println("Dictionaries entries EVICT start...");
        // for(Dictionary dic : dictonaries){
        // session.evict(dic);
        // }
        // System.out.println("Dictionaries entries EVICT end");
    } catch (HibernateException e_) {
        e_.printStackTrace();
        NTEVENT_LOG.error("Error while getting List of Dictionary entries");
    } finally {
        if (session != null && session.isOpen()) {
            try {
                HibernateUtils.closeSessions();
            } catch (HibernateException e) {
                // TODO Auto-generated catch block
                e.printStackTrace();
            }
        }
    }
    return dictonaries;
} 
```

添加条件时，出现以下错误：

org.hibernate.QueryException：无法解析属性：编码系统：com.artificialmed.domain.dictionary.model.DictionaryToken

我知道这与对象的性质有关，该对象实际上是我的字典类和基础表以及我的令牌类和表之间的连接。

字段编码系统是我的字典类中的一个字段。我想我应该使用别名，但我不知道在当前情况下如何做到这一点。任何帮助将不胜感激。

艾略特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T01:26:38.067

这是一个新手问题。Hibernate 要求反映表的模型的 getter 和 setter 具有特定格式。getter 必须是 get+，其中 name 是基础表中的字段名。setter 必须是 set+ 其中 name 是基础表的字段名。是的，名称的第一个字母必须大写。

# html - Rails 从 HTML 中获取标题标签

> ID：13059156
> 
> 赞同：2
> 
> 时间：2012-10-24T23:02:02.337
> 
> 标签：html, ruby-on-rails, ruby-on-rails-3, url, title

在我的 Rails 控制器中，我有一个用户提供的 URL。我想从该`<title>...</title>`URL 的 HTML 中的标签中提取标题，并将其分配给一个变量`title`. 我怎样才能做到这一点？

编辑：在不使用外部包/库的情况下这样做会更好

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:07:50.077

我刚刚尝试使用[HTTParty](https://github.com/jnunemaker/httparty)来获取文档，并[使用 Nokogiri](http://nokogiri.org/)来解析它：

```
Nokogiri::HTML::Document.parse(HTTParty.get("http://www.google.com").body).title
#=> "Google" 
```

更新：

这适用于[Net:HTTP](http://ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html)，它是 ruby​​ 标准库的一部分，以及一个正则表达式：

```
Net::HTTP.get(URI("http://twitter.com")) =~ /<title>(.*?)<\/title>/
$1 # get the first result from the matching
#=> "Twitter" 
```

更新：

`=~`称为“match”是一种方法，`String`用于将正则表达式与字符串进行匹配。它基本上相同，`Regexp#match`但接收者和参数是倒置的。

```
string = "<title>my title</title>
regexp = /<title>(.*?)<\/title>/

string =~ regexp
$1 # => "my title"

regexp.match(string)
$1 # => "my title" 
```

当您获取的 HTML 文档不包含标题或标题标签时会发生什么？

```
"<title></title>" =~ regexp
$1 # => ""

"" =~ regexp
$1 # => nil 
```

# c++ - windbg中“！heap -h”输出中的“内部”是什么意思？

> ID：13059157
> 
> 赞同：7
> 
> 时间：2012-10-24T23:02:04.493
> 
> 标签：c++, windows, memory-leaks, heap-memory, windbg

我正在关注这个stackoverflow帖子 [“！heap -flt -s xxxx”windbg命令中的不同列代表什么](https://stackoverflow.com/questions/6687414/what-do-the-different-columns-in-the-heap-flt-s-xxxx-windbg-command-represe)

我试图了解为占用大量内存的堆之一打印的信息。

我可以理解大部分专栏，但在我的 windbg 上，我看到了一个额外的专栏。我的大部分条目都标记为**Internal**。我想知道那是什么意思。我已经做到了`!gflags +ust`。因此，我可以看到用于进行内存分配的调用堆栈。**除了标记为Internal**的条目之外，我可以在大多数条目上执行此操作。

**内部**是什么意思？它与LFH的实施有关吗？如果这是 LFH 的内部实现，这些**内部**堆条目将如何以及何时返回空闲列表？它现在无缘无故地阻碍了我的记忆。

这是`!heap -h 0000000002330000`供您参考的输出。

```
Index   Address  Name      Debugging options enabled
  8:   02330000 
    Segment at 0000000002330000 to 0000000002340000 (00010000 bytes committed)
    Segment at 00000000032b0000 to 00000000033b0000 (00100000 bytes committed)
    Segment at 00000000065a0000 to 00000000067a0000 (00200000 bytes committed)
    Segment at 00000000067a0000 to 0000000006ba0000 (00400000 bytes committed)
    Segment at 0000000006d80000 to 0000000007580000 (006f2000 bytes committed)
    Flags:                08001002
    ForceFlags:           00000000
    Granularity:          16 bytes
    Segment Reserve:      01000000
    Segment Commit:       00002000
    DeCommit Block Thres: 00000400
    DeCommit Total Thres: 00001000
    Total Free Size:      0000274d
    Max. Allocation Size: 000007fffffdefff
    Lock Variable at:     00000000023301f8
    Next TagIndex:        0000
    Maximum TagIndex:     0000
    Tag Entries:          00000000
    PsuedoTag Entries:    00000000
    Virtual Alloc List:   02330118
    Uncommitted ranges:   023300f8
    FreeList[ 00 ] at 0000000002330158: 0000000007454600 . 00000000032e3de0   (24 blocks)

Heap entries for Segment00 in Heap 0000000002330000
    0000000002330000: 00000 . 00a70 [101] - busy (a6f)
    0000000002330a70: 00a70 . 00860 [101] - busy (85f)
    00000000023312d0: 00860 . 038b0 [101] - busy (38af)
    0000000002334b80: 038b0 . 00330 [100]
    0000000002334eb0: 00330 . 00b60 [101] - busy (b34)
    0000000002335a10: 00b60 . 00160 [101] - busy (134)
    0000000002335b70: 00160 . 00090 [101] - busy (5c)
    0000000002335c00: 00090 . 00090 [101] - busy (5c)
    0000000002335c90: 00090 . 00040 [100]
    0000000002335cd0: 00040 . 00090 [101] - busy (5c)
    0000000002335d60: 00090 . 00020 [100]
    0000000002335d80: 00020 . 00130 [101] - busy (104)
    0000000002335eb0: 00130 . 00080 [101] - busy (53)
    0000000002335f30: 00080 . 00090 [101] - busy (65)
    0000000002335fc0: 00090 . 01060 [101] - busy (1034)
    0000000002337020: 01060 . 01020 [101] - busy (ff0) Internal 
    0000000002338040: 01020 . 00420 [101] - busy (3f0) Internal 
    0000000002338460: 00420 . 00090 [101] - busy (64)
    00000000023384f0: 00090 . 00260 [101] - busy (234)
    0000000002338750: 00260 . 00090 [101] - busy (5c)
    00000000023387e0: 00090 . 00080 [101] - busy (54)
    0000000002338860: 00080 . 00080 [101] - busy (4c)
    00000000023388e0: 00080 . 00030 [100]
    0000000002338910: 00030 . 00090 [101] - busy (5c)
    00000000023389a0: 00090 . 00090 [101] - busy (64)
    0000000002338a30: 00090 . 00260 [101] - busy (234)
    0000000002338c90: 00260 . 00060 [101] - busy (35)
    0000000002338cf0: 00060 . 00160 [101] - busy (134)
    0000000002338e50: 00160 . 00260 [101] - busy (234)
    00000000023390b0: 00260 . 00160 [101] - busy (134)
    0000000002339210: 00160 . 000c0 [101] - busy (94)
    00000000023392d0: 000c0 . 00080 [101] - busy (4c)
    0000000002339350: 00080 . 000c0 [101] - busy (84)
    0000000002339410: 000c0 . 000c0 [101] - busy (84)
    00000000023394d0: 000c0 . 000c0 [101] - busy (94)
    0000000002339590: 000c0 . 000c0 [101] - busy (94)
    0000000002339650: 000c0 . 000a0 [101] - busy (6c)
    00000000023396f0: 000a0 . 000c0 [101] - busy (94)
    00000000023397b0: 000c0 . 000a0 [101] - busy (6c)
    0000000002339850: 000a0 . 000a0 [101] - busy (6c)
    00000000023398f0: 000a0 . 02020 [101] - busy (1ff0) Internal 
    000000000233b910: 02020 . 000a0 [101] - busy (74)
    000000000233b9b0: 000a0 . 00060 [101] - busy (35)
    000000000233ba10: 00060 . 02020 [101] - busy (1ff0) Internal 
    000000000233da30: 02020 . 000a0 [101] - busy (6c)
    000000000233dad0: 000a0 . 000c0 [101] - busy (94)
    000000000233db90: 000c0 . 000a0 [101] - busy (6c)
    000000000233dc30: 000a0 . 00060 [100]
    000000000233dc90: 00060 . 001c0 [101] - busy (194)
    000000000233de50: 001c0 . 00260 [101] - busy (234)
    000000000233e0b0: 00260 . 000b0 [101] - busy (80)
    000000000233e160: 000b0 . 00020 [100]
    000000000233e180: 00020 . 000c0 [101] - busy (94)
    000000000233e240: 000c0 . 000a0 [101] - busy (6c)
    000000000233e2e0: 000a0 . 000a0 [101] - busy (74)
    000000000233e380: 000a0 . 001c0 [101] - busy (194)
    000000000233e540: 001c0 . 00020 [100]
    000000000233e560: 00020 . 000c0 [101] - busy (84)
    000000000233e620: 000c0 . 000c0 [101] - busy (84)
    000000000233e6e0: 000c0 . 000c0 [101] - busy (94)
    000000000233e7a0: 000c0 . 000c0 [101] - busy (94)
    000000000233e860: 000c0 . 00260 [101] - busy (234)
    000000000233eac0: 00260 . 000b0 [101] - busy (82)
    000000000233eb70: 000b0 . 00350 [100]
    000000000233eec0: 00350 . 00330 [101] - busy (2fc)
    000000000233f1f0: 00330 . 00440 [101] - busy (40c)
    000000000233f630: 00440 . 00420 [101] - busy (3f0) Internal 
    000000000233fa50: 00420 . 00460 [100]
    000000000233feb0: 00460 . 000b0 [101] - busy (80)
    000000000233ff60: 000b0 . 00060 [100]
    000000000233ffc0: 00060 . 00040 [111] - busy (3d)
    0000000002340000:      00000000      - uncommitted bytes.
Heap entries for Segment01 in Heap 0000000002330000
    00000000032b0000: 00000 . 00070 [101] - busy (6f)
    00000000032b0070: 00070 . 0c470 [101] - busy (c440) Internal 
    00000000032bc4e0: 0c470 . 00280 [101] - busy (254)
    00000000032bc760: 00280 . 000a0 [101] - busy (70)
    00000000032bc800: 000a0 . 00080 [101] - busy (4c)
    00000000032bc880: 00080 . 00080 [101] - busy (58)
    00000000032bc900: 00080 . 00070 [101] - busy (48)
    00000000032bc970: 00070 . 00080 [101] - busy (4b)
    00000000032bc9f0: 00080 . 00070 [101] - busy (42)
    00000000032bca60: 00070 . 00080 [101] - busy (4d)
    00000000032bcae0: 00080 . 000a0 [101] - busy (72)
    00000000032bcb80: 000a0 . 00080 [101] - busy (51)
    00000000032bcc00: 00080 . 000b0 [101] - busy (7c)
    00000000032bccb0: 000b0 . 00070 [101] - busy (46)
    00000000032bcd20: 00070 . 00080 [101] - busy (4c)
    00000000032bcda0: 00080 . 00080 [101] - busy (4f)
    00000000032bce20: 00080 . 00080 [101] - busy (52)
    00000000032bcea0: 00080 . 00090 [101] - busy (5d)
    00000000032bcf30: 00090 . 00080 [101] - busy (4b)
    00000000032bcfb0: 00080 . 00070 [101] - busy (43)
    00000000032bd020: 00070 . 00080 [101] - busy (4a)
    00000000032bd0a0: 00080 . 00080 [101] - busy (49)
    00000000032bd120: 00080 . 00070 [101] - busy (48)
    00000000032bd190: 00070 . 00070 [101] - busy (44)
    00000000032bd200: 00070 . 000a0 [101] - busy (69)
    00000000032bd2a0: 000a0 . 00070 [101] - busy (46)
    00000000032bd310: 00070 . 00070 [101] - busy (3c)
    00000000032bd380: 00070 . 000c0 [101] - busy (8c)
    00000000032bd440: 000c0 . 00070 [101] - busy (3c)
    00000000032bd4b0: 00070 . 00090 [101] - busy (5c)
    00000000032bd540: 00090 . 00090 [101] - busy (5c)
    00000000032bd5d0: 00090 . 00090 [101] - busy (5c)
    00000000032bd660: 00090 . 000a0 [101] - busy (5c)
    00000000032bd700: 000a0 . 00070 [101] - busy (44)
    00000000032bd770: 00070 . 00090 [101] - busy (5c)
    00000000032bd800: 00090 . 00070 [101] - busy (3c)
    00000000032bd870: 00070 . 00050 [100]
    00000000032bd8c0: 00050 . 00260 [101] - busy (234)
    00000000032bdb20: 00260 . 00070 [101] - busy (3c)
    00000000032bdb90: 00070 . 00090 [101] - busy (5c)
    00000000032bdc20: 00090 . 00070 [101] - busy (3c)
    00000000032bdc90: 00070 . 00070 [101] - busy (3c)
    00000000032bdd00: 00070 . 00090 [101] - busy (5c)
    00000000032bdd90: 00090 . 00070 [101] - busy (3c)
    00000000032bde00: 00070 . 00070 [101] - busy (3c)
    00000000032bde70: 00070 . 00090 [101] - busy (5c)
    00000000032bdf00: 00090 . 00070 [101] - busy (3c)
    00000000032bdf70: 00070 . 00cc0 [100]
    00000000032bec30: 00cc0 . 00330 [101] - busy (2fc)
    00000000032bef60: 00330 . 00440 [101] - busy (40a)
    00000000032bf3a0: 00440 . 00220 [100]
    00000000032bf5c0: 00220 . 00330 [101] - busy (2fc)
    00000000032bf8f0: 00330 . 04020 [101] - busy (3ff0) Internal 
    00000000032c3910: 04020 . 02020 [101] - busy (1ff0) Internal 
    00000000032c5930: 02020 . 00210 [100]
    00000000032c5b40: 00210 . 01020 [101] - busy (ff0) Internal 
    00000000032c6b60: 01020 . 01020 [101] - busy (ff0) Internal 
    00000000032c7b80: 01020 . 00440 [101] - busy (40c)
    00000000032c7fc0: 00440 . 00440 [101] - busy (40a)
    00000000032c8400: 00440 . 00430 [101] - busy (3f0) Internal 
    00000000032c8830: 00430 . 02020 [101] - busy (1ff0) Internal 
    00000000032ca850: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000032cc870: 02020 . 01020 [101] - busy (ff0) Internal 
    00000000032cd890: 01020 . 00420 [101] - busy (3f0) Internal 
    00000000032cdcb0: 00420 . 00420 [101] - busy (3f0) Internal 
    00000000032ce0d0: 00420 . 00420 [101] - busy (3f0) Internal 
    00000000032ce4f0: 00420 . 003a0 [100]
    00000000032ce890: 003a0 . 02020 [101] - busy (1ff0) Internal 
    00000000032d08b0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000032d28d0: 02020 . 01020 [101] - busy (ff0) Internal 
    00000000032d38f0: 01020 . 00420 [101] - busy (3f0) Internal 
    00000000032d3d10: 00420 . 00420 [101] - busy (3f0) Internal 
    00000000032d4130: 00420 . 003a0 [100]
    00000000032d44d0: 003a0 . 00420 [101] - busy (3f0) Internal 
    00000000032d48f0: 00420 . 01020 [101] - busy (ff0) Internal 
    00000000032d5910: 01020 . 04020 [101] - busy (3ff0) Internal 
    00000000032d9930: 04020 . 01020 [101] - busy (ff0) Internal 
    00000000032da950: 01020 . 04020 [101] - busy (3ff0) Internal 
    00000000032de970: 04020 . 01020 [101] - busy (ff0) Internal 
    00000000032df990: 01020 . 04020 [101] - busy (3ff0) Internal 
    00000000032e39b0: 04020 . 00420 [101] - busy (3f0) Internal 
    00000000032e3dd0: 00420 . 00020 [100]
    00000000032e3df0: 00020 . 04020 [101] - busy (3ff0) Internal 
    00000000032e7e10: 04020 . 02020 [101] - busy (1ff0) Internal 
    00000000032e9e30: 02020 . 01020 [101] - busy (ff0) Internal 
    00000000032eae50: 01020 . 02020 [101] - busy (1ff0) Internal 
    00000000032ece70: 02020 . 01020 [101] - busy (ff0) Internal 
    00000000032ede90: 01020 . 000f0 [100]
    00000000032edf80: 000f0 . 01020 [101] - busy (ff0) Internal 
    00000000032eefa0: 01020 . 01020 [101] - busy (ff0) Internal 
    00000000032effc0: 01020 . 02020 [101] - busy (1ff0) Internal 
    00000000032f1fe0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000032f4000: 02020 . 00420 [101] - busy (3f0) Internal 
    00000000032f4420: 00420 . 00160 [100]
    00000000032f4580: 00160 . 02020 [101] - busy (1ff0) Internal 
    00000000032f65a0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000032f85c0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000032fa5e0: 02020 . 08020 [101] - busy (7ff0) Internal 
    0000000003302600: 08020 . 02020 [101] - busy (1ff0) Internal 
    0000000003304620: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003305640: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003307660: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003309680: 02020 . 08020 [101] - busy (7ff0) Internal 
    00000000033116a0: 08020 . 02020 [101] - busy (1ff0) Internal 
    00000000033136c0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033156e0: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003316700: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003318720: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000331a740: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000331c760: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000331e780: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033207a0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033227c0: 02020 . 01020 [101] - busy (ff0) Internal 
    00000000033237e0: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003325800: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003327820: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003329840: 02020 . 01020 [101] - busy (ff0) Internal 
    000000000332a860: 01020 . 02020 [101] - busy (1ff0) Internal 
    000000000332c880: 02020 . 01020 [101] - busy (ff0) Internal 
    000000000332d8a0: 01020 . 02020 [101] - busy (1ff0) Internal 
    000000000332f8c0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033318e0: 02020 . 08020 [101] - busy (7ff0) Internal 
    0000000003339900: 08020 . 01020 [101] - busy (ff0) Internal 
    000000000333a920: 01020 . 02020 [101] - busy (1ff0) Internal 
    000000000333c940: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000333e960: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003340980: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033429a0: 02020 . 01020 [101] - busy (ff0) Internal 
    00000000033439c0: 01020 . 02020 [101] - busy (1ff0) Internal 
    00000000033459e0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003347a00: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003348a20: 01020 . 02020 [101] - busy (1ff0) Internal 
    000000000334aa40: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000334ca60: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000334ea80: 02020 . 01020 [101] - busy (ff0) Internal 
    000000000334faa0: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003351ac0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003353ae0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003355b00: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003356b20: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003358b40: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000335ab60: 02020 . 02000 [100]
    000000000335cb60: 02000 . 02020 [101] - busy (1ff0) Internal 
    000000000335eb80: 02020 . 04020 [101] - busy (3ff0) Internal 
    0000000003362ba0: 04020 . 02020 [101] - busy (1ff0) Internal 
    0000000003364bc0: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003365be0: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003367c00: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003368c20: 01020 . 04020 [101] - busy (3ff0) Internal 
    000000000336cc40: 04020 . 02020 [101] - busy (1ff0) Internal 
    000000000336ec60: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003370c80: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003371ca0: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003373cc0: 02020 . 01020 [101] - busy (ff0) Internal 
    0000000003374ce0: 01020 . 02020 [101] - busy (1ff0) Internal 
    0000000003376d00: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003378d20: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000337ad40: 02020 . 04020 [101] - busy (3ff0) Internal 
    000000000337ed60: 04020 . 02020 [101] - busy (1ff0) Internal 
    0000000003380d80: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003382da0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003384dc0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003386de0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003388e00: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000338ae20: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000338ce40: 02020 . 02020 [101] - busy (1ff0) Internal 
    000000000338ee60: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003390e80: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003392ea0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003394ec0: 02020 . 02020 [101] - busy (1ff0) Internal 
    0000000003396ee0: 02020 . 08020 [101] - busy (7ff0) Internal 
    000000000339ef00: 08020 . 02020 [101] - busy (1ff0) Internal 
    00000000033a0f20: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033a2f40: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000033a4f60: 02020 . 08020 [101] - busy (7ff0) Internal 
    00000000033acf80: 08020 . 02020 [101] - busy (1ff0) Internal 
    00000000033aefa0: 02020 . 00420 [101] - busy (3f0) Internal 
    00000000033af3c0: 00420 . 00420 [101] - busy (3f0) Internal 
    00000000033af7e0: 00420 . 00420 [101] - busy (3f0) Internal 
    00000000033afc00: 00420 . 003c0 [100]
    00000000033affc0: 003c0 . 00040 [111] - busy (3d)
    00000000033b0000:      00000000      - uncommitted bytes.
Heap entries for Segment02 in Heap 0000000002330000
    00000000065a0000: 00000 . 00070 [101] - busy (6f)
    00000000065a0070: 00070 . 04020 [101] - busy (3ff0) Internal 
    00000000065a4090: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065a80b0: 04020 . 02020 [101] - busy (1ff0) Internal 
    00000000065aa0d0: 02020 . 02020 [101] - busy (1ff0) Internal 
    00000000065ac0f0: 02020 . 08020 [101] - busy (7ff0) Internal 
    00000000065b4110: 08020 . 02020 [101] - busy (1ff0) Internal 
    00000000065b6130: 02020 . 04020 [101] - busy (3ff0) Internal 
    00000000065ba150: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065be170: 04020 . 08020 [101] - busy (7ff0) Internal 
    00000000065c6190: 08020 . 04020 [101] - busy (3ff0) Internal 
    00000000065ca1b0: 04020 . 02020 [101] - busy (1ff0) Internal 
    00000000065cc1d0: 02020 . 04020 [101] - busy (3ff0) Internal 
    00000000065d01f0: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065d4210: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065d8230: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065dc250: 04020 . 02020 [101] - busy (1ff0) Internal 
    00000000065de270: 02020 . 08020 [101] - busy (7ff0) Internal 
    00000000065e6290: 08020 . 04020 [101] - busy (3ff0) Internal 
    00000000065ea2b0: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065ee2d0: 04020 . 08020 [101] - busy (7ff0) Internal 
    00000000065f62f0: 08020 . 04020 [101] - busy (3ff0) Internal 
    00000000065fa310: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000065fe330: 04020 . 08020 [101] - busy (7ff0) Internal 
    0000000006606350: 08020 . 04020 [101] - busy (3ff0) Internal 
    000000000660a370: 04020 . 04020 [101] - busy (3ff0) Internal 
    000000000660e390: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000066123b0: 04020 . 10020 [101] - busy (fff0) Internal 
    00000000066223d0: 10020 . 04020 [101] - busy (3ff0) Internal 
    00000000066263f0: 04020 . 04020 [101] - busy (3ff0) Internal 
    000000000662a410: 04020 . 04020 [101] - busy (3ff0) Internal 
    000000000662e430: 04020 . 04020 [101] - busy (3ff0) Internal 
    0000000006632450: 04020 . 10020 [101] - busy (fff0) Internal 
    0000000006642470: 10020 . 04020 [101] - busy (3ff0) Internal 
    0000000006646490: 04020 . 04020 [101] - busy (3ff0) Internal 
    000000000664a4b0: 04020 . 04020 [101] - busy (3ff0) Internal 
    000000000664e4d0: 04020 . 04020 [101] - busy (3ff0) Internal 
    00000000066524f0: 04020 . 08020 [101] - busy (7ff0) Internal 
    000000000665a510: 08020 . 08020 [101] - busy (7ff0) Internal 
    0000000006662530: 08020 . 04020 [101] - busy (3ff0) Internal 
    0000000006666550: 04020 . 04020 [101] - busy (3ff0) Internal 
    000000000666a570: 04020 . 10020 [101] - busy (fff0) Internal 
    000000000667a590: 10020 . 04020 [101] - busy (3ff0) Internal 
    000000000667e5b0: 04020 . 08020 [101] - busy (7ff0) Internal 
    00000000066865d0: 08020 . 08020 [101] - busy (7ff0) Internal 
    000000000668e5f0: 08020 . 10020 [101] - busy (fff0) Internal 
    000000000669e610: 10020 . 04020 [101] - busy (3ff0) Internal 
    00000000066a2630: 04020 . 10020 [101] - busy (fff0) Internal 
    00000000066b2650: 10020 . 08020 [101] - busy (7ff0) Internal 
    00000000066ba670: 08020 . 02020 [101] - busy (1ff0) Internal 
    00000000066bc690: 02020 . 08020 [101] - busy (7ff0) Internal 
    00000000066c46b0: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000066cc6d0: 08020 . 10020 [101] - busy (fff0) Internal 
    00000000066dc6f0: 10020 . 08020 [101] - busy (7ff0) Internal 
    00000000066e4710: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000066ec730: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000066f4750: 08020 . 10020 [101] - busy (fff0) Internal 
    0000000006704770: 10020 . 08020 [101] - busy (7ff0) Internal 
    000000000670c790: 08020 . 10020 [101] - busy (fff0) Internal 
    000000000671c7b0: 10020 . 08020 [101] - busy (7ff0) Internal 
    00000000067247d0: 08020 . 08020 [101] - busy (7ff0) Internal 
    000000000672c7f0: 08020 . 20020 [101] - busy (1fff0) Internal 
    000000000674c810: 20020 . 08020 [101] - busy (7ff0) Internal 
    0000000006754830: 08020 . 08020 [101] - busy (7ff0) Internal 
    000000000675c850: 08020 . 08020 [101] - busy (7ff0) Internal 
    0000000006764870: 08020 . 08020 [101] - busy (7ff0) Internal 
    000000000676c890: 08020 . 20020 [101] - busy (1fff0) Internal 
    000000000678c8b0: 20020 . 08020 [101] - busy (7ff0) Internal 
    00000000067948d0: 08020 . 08020 [101] - busy (7ff0) Internal 
    000000000679c8f0: 08020 . 02020 [101] - busy (1ff0) Internal 
    000000000679e910: 02020 . 016b0 [100]
    000000000679ffc0: 016b0 . 00040 [111] - busy (3d)
    00000000067a0000:      00000000      - uncommitted bytes.
Heap entries for Segment03 in Heap 0000000002330000
    00000000067a0000: 00000 . 00070 [101] - busy (6f)
    00000000067a0070: 00070 . 08020 [101] - busy (7ff0) Internal 
    00000000067a8090: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000067b00b0: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000067b80d0: 08020 . 20020 [101] - busy (1fff0) Internal 
    00000000067d80f0: 20020 . 08020 [101] - busy (7ff0) Internal 
    00000000067e0110: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000067e8130: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000067f0150: 08020 . 08020 [101] - busy (7ff0) Internal 
    00000000067f8170: 08020 . 10020 [101] - busy (fff0) Internal 
    0000000006808190: 10020 . 10020 [101] - busy (fff0) Internal 
    00000000068181b0: 10020 . 20020 [101] - busy (1fff0) Internal 
    00000000068381d0: 20020 . 10020 [101] - busy (fff0) Internal 
    00000000068481f0: 10020 . 08020 [101] - busy (7ff0) Internal 
    0000000006850210: 08020 . 20020 [101] - busy (1fff0) Internal 
    0000000006870230: 20020 . 10020 [101] - busy (fff0) Internal 
    0000000006880250: 10020 . 08020 [101] - busy (7ff0) Internal 
    0000000006888270: 08020 . 10020 [101] - busy (fff0) Internal 
    0000000006898290: 10020 . 20020 [101] - busy (1fff0) Internal 
    00000000068b82b0: 20020 . 10020 [101] - busy (fff0) Internal 
    00000000068c82d0: 10020 . 10020 [101] - busy (fff0) Internal 
    00000000068d82f0: 10020 . 20020 [101] - busy (1fff0) Internal 
    00000000068f8310: 20020 . 10020 [101] - busy (fff0) Internal 
    0000000006908330: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006918350: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006928370: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006938390: 10020 . 20020 [101] - busy (1fff0) Internal 
    00000000069583b0: 20020 . 10020 [101] - busy (fff0) Internal 
    00000000069683d0: 10020 . 10020 [101] - busy (fff0) Internal 
    00000000069783f0: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006988410: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006998430: 10020 . 10020 [101] - busy (fff0) Internal 
    00000000069a8450: 10020 . 40020 [101] - busy (3fff0) Internal 
    00000000069e8470: 40020 . 10020 [101] - busy (fff0) Internal 
    00000000069f8490: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006a084b0: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006a184d0: 10020 . 04020 [101] - busy (3ff0) Internal 
    0000000006a1c4f0: 04020 . 10020 [101] - busy (fff0) Internal 
    0000000006a2c510: 10020 . 40020 [101] - busy (3fff0) Internal 
    0000000006a6c530: 40020 . 10020 [101] - busy (fff0) Internal 
    0000000006a7c550: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006a8c570: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006a9c590: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006aac5b0: 10020 . 40020 [101] - busy (3fff0) Internal 
    0000000006aec5d0: 40020 . 10020 [101] - busy (fff0) Internal 
    0000000006afc5f0: 10020 . 10020 [101] - busy (fff0) Internal 
    0000000006b0c610: 10020 . 20020 [101] - busy (1fff0) Internal 
    0000000006b2c630: 20020 . 40020 [101] - busy (3fff0) Internal 
    0000000006b6c650: 40020 . 10020 [101] - busy (fff0) Internal 
    0000000006b7c670: 10020 . 20020 [101] - busy (1fff0) Internal 
    0000000006b9c690: 20020 . 03930 [100]
    0000000006b9ffc0: 03930 . 00040 [111] - busy (3d)
    0000000006ba0000:      00000000      - uncommitted bytes.
Heap entries for Segment04 in Heap 0000000002330000
    0000000006d80000: 00000 . 00070 [101] - busy (6f)
    0000000006d80070: 00070 . 10020 [101] - busy (fff0) Internal 
    0000000006d90090: 10020 . 40020 [101] - busy (3fff0) Internal 
    0000000006dd00b0: 40020 . 20020 [101] - busy (1fff0) Internal 
    0000000006df00d0: 20020 . 20020 [101] - busy (1fff0) Internal 
    0000000006e100f0: 20020 . 20020 [101] - busy (1fff0) Internal 
    0000000006e30110: 20020 . 40020 [101] - busy (3fff0) Internal 
    0000000006e70130: 40020 . 20020 [101] - busy (1fff0) Internal 
    0000000006e90150: 20020 . 40020 [101] - busy (3fff0) Internal 
    0000000006ed0170: 40020 . 20020 [101] - busy (1fff0) Internal 
    0000000006ef0190: 20020 . 20020 [101] - busy (1fff0) Internal 
    0000000006f101b0: 20020 . 20020 [101] - busy (1fff0) Internal 
    0000000006f301d0: 20020 . 40020 [101] - busy (3fff0) Internal 
    0000000006f701f0: 40020 . 04020 [101] - busy (3ff0) Internal 
    0000000006f74210: 04020 . 20020 [101] - busy (1fff0) Internal 
    0000000006f94230: 20020 . 20020 [101] - busy (1fff0) Internal 
    0000000006fb4250: 20020 . 40020 [101] - busy (3fff0) Internal 
    0000000006ff4270: 40020 . 04020 [101] - busy (3ff0) Internal 
    0000000006ff8290: 04020 . 20020 [101] - busy (1fff0) Internal 
    00000000070182b0: 20020 . 20020 [101] - busy (1fff0) Internal 
    00000000070382d0: 20020 . 04020 [101] - busy (3ff0) Internal 
    000000000703c2f0: 04020 . 08020 [101] - busy (7ff0) Internal 
    0000000007044310: 08020 . 40020 [101] - busy (3fff0) Internal 
    0000000007084330: 40020 . 20020 [101] - busy (1fff0) Internal 
```

**编辑 2012 年 10 月 26 日**

**通过检查内部**堆条目中的内存内容，我终于找到了导致泄漏的位置。它包含多个相同的内存分配造成的`operator new`。我不知道为什么它们都被合并到一个堆条目中，但是通过查看内容，我设法找出导致泄漏的代码。也许，将所有相似的数据组合到一个堆条目中是一项 CRT 功能？还是我完全误解了堆入口的含义？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2012-10-26T13:43:51.997

TL;DR：标记为“内部”的堆块在 _HEAP_ENTRY.Flags 中有一个特殊标志

[编辑] 用正确的答案修改了我之前的答案。

* * *

这是我对您的问题的猜测尝试。

根据windbg的帮助，“!heap”命令代码位于exts.dll（即\winxp\exts.dll）中。

将此 DLL 放在 IDA 上并为其下载符号。在 DumpHeapEntry() 函数中，DLL 中只有一次“内部”：

```
.text:0192463D                 movzx   eax, byte_1963152
.text:01924644                 test    eax, eax
.text:01924646                 jz      short loc_1924656
.text:01924648                 push    offset aInternal ; " Internal "
.text:0192464D                 call    _ExtensionApis.lpOutputRoutine ; some sort of printf routine 
```

因此，“内部”的输出取决于 byte_1963152 的值：如果 byte_1963152 不为 0，则打印“内部”。仅发生一次写入值不为 0 的情况（在 DumpHeapEntry() 开始时调用的 ReadHeapEntry() 中）：

```
.text:0191F025                 movzx   eax, [ebp+var_B]
.text:0191F029                 and     eax, 8
.text:0191F02C                 jz      short loc_191F035
.text:0191F02E                 mov     byte_1963152, 1 
```

这转化为：

```
if((UINT)var_B & 8)
    byte_1963152 = 1; 
```

var_B 在这里设置：

```
text:0191EFF7                 mov     eax, [ebp+var_18]
.text:0191EFFA                 mov     edx, [ebp+var_14]
.text:0191EFFD                 mov     cl, 10h          ; shift right by 0x10 bits
.text:0191EFFF                 call    __aullshr
.text:0191F004                 mov     [ebp+var_B], al 
```

__aullshr 代表“算术无符号长长右移”。在上面的代码中，eax 是 64 位 unsigned long long 的低 32 位部分，而 edx 是高 32 位部分。请注意，var_B 是一个 8 位数量（使用了“al”寄存器）。

因此：

```
// where var_14_18 is a combination (64-bit) of var_14 and var_18
var_B = (char)(var_14_18 >> 0x10 ); 
```

var_14 和 var_18 在这里设置：

```
.text:0191EF01                 push    0
.text:0191EF03                 push    offset aAgregatecode ; "AgregateCode"
.text:0191EF08                 push    0
.text:0191EF0A                 push    0
.text:0191EF0C                 call    _GetShortField@16 ; GetShortField(x,x,x,x)
.text:0191EF11                 mov     [ebp+var_18], eax  ; high part
.text:0191EF14                 mov     [ebp+var_14], edx  ; low part
; cut
.text:0191EF28                 mov     ecx, [ebp+var_18]
.text:0191EF2B                 and     ecx, _EncodeFlagMask ; from HEAP.EncodeFlagMask
.text:0191EF31                 jz      short loc_191EF75
.text:0191EF33                 mov     edx, [ebp+var_18]
.text:0191EF36                 xor     edx, _CrtHeapCode ; from HEAP.Encoding.Code1
.text:0191EF3C                 mov     eax, [ebp+var_14]
.text:0191EF3F                 xor     eax, dword_1963194 ; from HEAP.Encoding.Code2
.text:0191EF45                 mov     [ebp+var_18], edx
.text:0191EF48                 mov     [ebp+var_14], eax 
```

因此，windbg 在“AgregateCode”上使用 GetShortField() 函数并设置上述两个变量（这也是一个无符号长整型值）。请注意，它还使用 HEAP.Encoding.Code1 和 HEAP.Encoding.Code2 对这两个值进行异或（HEAP 是当前堆，堆条目是其中的一部分）。

“AgregateCode”是 HEAP_ENTRY 和 HEAP_FREE_ENTRY 结构的字段（来自 Win 8.1 x86）：

```
0:000> dt _heap_entry -r2
ntdll!_HEAP_ENTRY
   +0x000 Size             : Uint2B
   +0x002 Flags            : UChar
   +0x003 SmallTagIndex    : UChar
   +0x000 SubSegmentCode   : Uint4B
   +0x004 PreviousSize     : Uint2B
   +0x006 SegmentOffset    : UChar
   +0x006 LFHFlags         : UChar
   +0x007 UnusedBytes      : UChar
   +0x000 FunctionIndex    : Uint2B
   +0x002 ContextValue     : Uint2B
   +0x000 InterceptorValue : Uint4B
   +0x004 UnusedBytesLength : Uint2B
   +0x006 EntryOffset      : UChar
   +0x007 ExtendedBlockSignature : UChar
   +0x000 Code1            : Uint4B
   +0x004 Code2            : Uint2B
   +0x006 Code3            : UChar
   +0x007 Code4            : UChar
   +0x004 Code234          : Uint4B
   +0x000 AgregateCode     : Uint8B 
```

这翻译成C，给出：

```
 typedef struct _HEAP_ENTRY                       // 20 elements, 0x8 bytes (sizeof) 
          {                                                                                   
              union                                        // 6 elements, 0x8 bytes (sizeof)  
              {                                                                               
                  struct                                   // 3 elements, 0x8 bytes (sizeof)  
                  {                                                                           
/*0x000*/             UINT16       Size;                                                      
/*0x002*/             UINT8        Flags;                                                     
/*0x003*/             UINT8        SmallTagIndex;                                             
/*0x004*/             UINT8        _PADDING0_[0x4];                                           
                  };                                                                          
                  struct                                   // 4 elements, 0x8 bytes (sizeof)  
                  {                                                                           
/*0x000*/             ULONG32      SubSegmentCode;                                            
/*0x004*/             UINT16       PreviousSize;                                              
                      union                                // 2 elements, 0x1 bytes (sizeof)  
                      {                                                                       
/*0x006*/                 UINT8        SegmentOffset;                                         
/*0x006*/                 UINT8        LFHFlags;                                              
                      };                                                                      
/*0x007*/             UINT8        UnusedBytes;                                               
                  };                                                                          
                  struct                                   // 2 elements, 0x8 bytes (sizeof)  
                  {                                                                           
/*0x000*/             UINT16       FunctionIndex;                                             
/*0x002*/             UINT16       ContextValue;                                              
/*0x004*/             UINT8        _PADDING1_[0x4];                                           
                  };                                                                          
                  struct                                   // 4 elements, 0x8 bytes (sizeof)  
                  {                                                                           
/*0x000*/             ULONG32      InterceptorValue;                                          
/*0x004*/             UINT16       UnusedBytesLength;                                         
/*0x006*/             UINT8        EntryOffset;                                               
/*0x007*/             UINT8        ExtendedBlockSignature;                                    
                  };                                                                          
                  struct                                   // 2 elements, 0x8 bytes (sizeof)  
                  {                                                                           
/*0x000*/             ULONG32      Code1;                                                     
                      union                                // 2 elements, 0x4 bytes (sizeof)  
                      {                                                                       
                          struct                           // 3 elements, 0x4 bytes (sizeof)  
                          {                                                                   
/*0x004*/                     UINT16       Code2;                                             
/*0x006*/                     UINT8        Code3;                                             
/*0x007*/                     UINT8        Code4;                                             
                          };                                                                  
/*0x004*/                 ULONG32      Code234;                                               
                      };                                                                      
                  };                                                                          
/*0x000*/         UINT64       AgregateCode;                                                  
              };                                                                              
          }HEAP_ENTRY, *PHEAP_ENTRY; 
```

因此，我们有以下伪代码（减去一些其他检查）：

```
high_part, low_part = GetShortField(0,0,"AgregateCode", 0);
high_part ^= HEAP.Encoding.Code1;
low_part ^= HEAP.Encoding.Code2;
AgregateCode = Make64BitFromTwo32Bit(high_part, low_part);    
char var_B = (char)(AgregateCode >> 0x10);
if(var_B & 8)
    printf("Internal"); 
```

鉴于“AgregateCode”是......好吧， Code1 到 Code 4 的聚合：

```
 struct                                   // 2 elements, 0x8 bytes (sizeof)  
                  {                                                                           
/*0x000*/             ULONG32      Code1;                                                     
                      union                                // 2 elements, 0x4 bytes (sizeof)  
                      {                                                                       
                          struct                           // 3 elements, 0x4 bytes (sizeof)  
                          {                                                                   
/*0x004*/                     UINT16       Code2;                                             
/*0x006*/                     UINT8        Code3;                                             
/*0x007*/                     UINT8        Code4;                                             
                          };                                                                  
/*0x004*/                 ULONG32      Code234;                                               
                      };                                                                      
                  };                                                                          
/*0x000*/         UINT64       AgregateCode; 
```

如果您移动 0x10 和 AND 8 的 AgregateCode 字段，您最终会测试 Code1 的第 11 位（从 0 开始计数）。

由于结构是一个大联合，您最终会测试：_HEAP_ENTRY.Flags

碰巧一个堆标志的值已经是8，它的名字是：HEAP_ENTRY_VIRTUAL_ALLOC

[http://doxygen.reactos.org/da/ddb/heap_8h_source.html#l00044](http://doxygen.reactos.org/da/ddb/heap_8h_source.html#l00044)

[https://os-design.googlecode.com/svn/trunk/ntos/inc/heap.h](https://os-design.googlecode.com/svn/trunk/ntos/inc/heap.h)

似乎该标志用于管理大分配，尽管这些块由系统内部使用，最终用户无法直接使用。

通常，此类内部块的标志成员设置为 9： HEAP_ENTRY_VIRTUAL_ALLOC | HEAP_ENTRY_BUSY

[编辑] 示例：

假设我在 0x005b0000 有一个堆：

```
0:004> !heap -h
Index   Address  Name      Debugging options enabled
  1:   005b0000 
```

此堆 (_HEAP) 在 0x005b8d00 处有一个标记为“内部”的 HEAP_ENTRY：

```
0:004> !heap -h 005b0000
Index   Address  Name      Debugging options enabled
  1:   005b0000 
    Segment at 005b0000 to 006b0000 (0009d000 bytes committed)
    Flags:                00000002
    ForceFlags:           00000000
    Granularity:          8 bytes
    Segment Reserve:      00100000
    Segment Commit:       00002000
    DeCommit Block Thres: 00000800
    DeCommit Total Thres: 00002000
    Total Free Size:      00001ae8
    Max. Allocation Size: 7ffdefff
    Lock Variable at:     005b0138
    Next TagIndex:        0000
    Maximum TagIndex:     0000
    Tag Entries:          00000000
    PsuedoTag Entries:    00000000
    Virtual Alloc List:   005b00a0
    Uncommitted ranges:   005b0090
    FreeList[ 00 ] at 005b00c4: 0063fbc0 . 00633060   (7 blocks)

    Heap entries for Segment00 in Heap 005b0000
        005b0000: 00000 . 00588 [101] - busy (587)
        //[cut]
        005b8d00: 03d20 . 378b0 [101] - busy (378a8) Internal 
```

HEAP 结构的详细视图（注意偏移量 0x50 处的“编码”结构 (_HEAP_ENTRY)，它有助于使用 XOR 解码编码的堆条目）：

```
0:004> dt _heap 005b0000 -r1
ntdll!_HEAP
   +0x000 Entry            : _HEAP_ENTRY
      +0x000 Size             : 0xbe38
      +0x002 Flags            : 0xf5 ''
      +0x003 SmallTagIndex    : 0xff ''
      +0x000 SubSegmentCode   : 0xfff5be38 
      +0x004 PreviousSize     : 0xcf53
      +0x006 SegmentOffset    : 0 ''
      +0x006 LFHFlags         : 0 ''
      +0x007 UnusedBytes      : 0x1 ''
      +0x000 FunctionIndex    : 0xbe38
      +0x002 ContextValue     : 0xfff5
      +0x000 InterceptorValue : 0xfff5be38
      +0x004 UnusedBytesLength : 0xcf53
      +0x006 EntryOffset      : 0 ''
      +0x007 ExtendedBlockSignature : 0x1 ''
      +0x000 Code1            : 0xfff5be38
      +0x004 Code2            : 0xcf53
      +0x006 Code3            : 0 ''
      +0x007 Code4            : 0x1 ''
      +0x000 AgregateCode     : 0x100cf53`fff5be38
   +0x008 SegmentSignature : 0xffeeffee
   +0x00c SegmentFlags     : 0
   +0x010 SegmentListEntry : _LIST_ENTRY [ 0x5b00a8 - 0x5b00a8 ]
      +0x000 Flink            : 0x005b00a8 _LIST_ENTRY [ 0x5b0010 - 0x5b0010 ]
      +0x004 Blink            : 0x005b00a8 _LIST_ENTRY [ 0x5b0010 - 0x5b0010 ]
   +0x018 Heap             : 0x005b0000 _HEAP
      +0x000 Entry            : _HEAP_ENTRY
      +0x008 SegmentSignature : 0xffeeffee
      +0x00c SegmentFlags     : 0
      +0x010 SegmentListEntry : _LIST_ENTRY [ 0x5b00a8 - 0x5b00a8 ]
      +0x018 Heap             : 0x005b0000 _HEAP
      +0x01c BaseAddress      : 0x005b0000 
      +0x020 NumberOfPages    : 0x100
      +0x024 FirstEntry       : 0x005b0588 _HEAP_ENTRY
      +0x028 LastValidEntry   : 0x006b0000 _HEAP_ENTRY
      +0x02c NumberOfUnCommittedPages : 0x63
      +0x030 NumberOfUnCommittedRanges : 1
      +0x034 SegmentAllocatorBackTraceIndex : 0
      +0x036 Reserved         : 0
      +0x038 UCRSegmentList   : _LIST_ENTRY [ 0x64cff0 - 0x64cff0 ]
      +0x040 Flags            : 2
      +0x044 ForceFlags       : 0
      +0x048 CompatibilityFlags : 0
      +0x04c EncodeFlagMask   : 0x100000
      +0x050 Encoding         : _HEAP_ENTRY
      +0x058 PointerKey       : 0x75c3a7b
      +0x05c Interceptor      : 0
      +0x060 VirtualMemoryThreshold : 0xfe00
      +0x064 Signature        : 0xeeffeeff
      +0x068 SegmentReserve   : 0x100000
      +0x06c SegmentCommit    : 0x2000
      +0x070 DeCommitFreeBlockThreshold : 0x800
      +0x074 DeCommitTotalFreeThreshold : 0x2000
      +0x078 TotalFreeSize    : 0x1ae8
      +0x07c MaximumAllocationSize : 0x7ffdefff
      +0x080 ProcessHeapsListIndex : 1
      +0x082 HeaderValidateLength : 0x138
      +0x084 HeaderValidateCopy : (null) 
      +0x088 NextAvailableTagIndex : 0
      +0x08a MaximumTagIndex  : 0
      +0x08c TagEntries       : (null) 
      +0x090 UCRList          : _LIST_ENTRY [ 0x64cfe8 - 0x64cfe8 ]
      +0x098 AlignRound       : 0xf
      +0x09c AlignMask        : 0xfffffff8
      +0x0a0 VirtualAllocdBlocks : _LIST_ENTRY [ 0x5b00a0 - 0x5b00a0 ]
      +0x0a8 SegmentList      : _LIST_ENTRY [ 0x5b0010 - 0x5b0010 ]
      +0x0b0 AllocatorBackTraceIndex : 0
      +0x0b4 NonDedicatedListLength : 0
      +0x0b8 BlocksIndex      : 0x005b0150 
      +0x0bc UCRIndex         : 0x005b0590 
      +0x0c0 PseudoTagEntries : (null) 
      +0x0c4 FreeLists        : _LIST_ENTRY [ 0x633060 - 0x63fbc0 ]
      +0x0cc LockVariable     : 0x005b0138 _HEAP_LOCK
      +0x0d0 CommitRoutine    : 0x075c3a7b        long  +75c3a7b
      +0x0d4 FrontEndHeap     : 0x005b8d08 
      +0x0d8 FrontHeapLockCount : 0
      +0x0da FrontEndHeapType : 0x2 ''
      +0x0dc Counters         : _HEAP_COUNTERS
      +0x130 TuningParameters : _HEAP_TUNING_PARAMETERS
   +0x01c BaseAddress      : 0x005b0000 
   +0x020 NumberOfPages    : 0x100
   +0x024 FirstEntry       : 0x005b0588 _HEAP_ENTRY
      +0x000 Size             : 0xbec1
      +0x002 Flags            : 0xf5 ''
      +0x003 SmallTagIndex    : 0x6 ''
      +0x000 SubSegmentCode   : 0x06f5bec1 
      +0x004 PreviousSize     : 0xcfe2
      +0x006 SegmentOffset    : 0 ''
      +0x006 LFHFlags         : 0 ''
      +0x007 UnusedBytes      : 0x1 ''
      +0x000 FunctionIndex    : 0xbec1
      +0x002 ContextValue     : 0x6f5
      +0x000 InterceptorValue : 0x6f5bec1
      +0x004 UnusedBytesLength : 0xcfe2
      +0x006 EntryOffset      : 0 ''
      +0x007 ExtendedBlockSignature : 0x1 ''
      +0x000 Code1            : 0x6f5bec1
      +0x004 Code2            : 0xcfe2
      +0x006 Code3            : 0 ''
      +0x007 Code4            : 0x1 ''
      +0x000 AgregateCode     : 0x100cfe2`06f5bec1
   +0x028 LastValidEntry   : 0x006b0000 _HEAP_ENTRY
      +0x000 Size             : 0xeff8
      +0x002 Flags            : 0xe7 ''
      +0x003 SmallTagIndex    : 0xff ''
      +0x000 SubSegmentCode   : 0xffe7eff8 
      +0x004 PreviousSize     : 0xd3df
      +0x006 SegmentOffset    : 0xc7 ''
      +0x006 LFHFlags         : 0xc7 ''
      +0x007 UnusedBytes      : 0xff ''
      +0x000 FunctionIndex    : 0xeff8
      +0x002 ContextValue     : 0xffe7
      +0x000 InterceptorValue : 0xffe7eff8
      +0x004 UnusedBytesLength : 0xd3df
      +0x006 EntryOffset      : 0xc7 ''
      +0x007 ExtendedBlockSignature : 0xff ''
      +0x000 Code1            : 0xffe7eff8
      +0x004 Code2            : 0xd3df
      +0x006 Code3            : 0xc7 ''
      +0x007 Code4            : 0xff ''
      +0x000 AgregateCode     : 0xffc7d3df`ffe7eff8
   +0x02c NumberOfUnCommittedPages : 0x63
   +0x030 NumberOfUnCommittedRanges : 1
   +0x034 SegmentAllocatorBackTraceIndex : 0
   +0x036 Reserved         : 0
   +0x038 UCRSegmentList   : _LIST_ENTRY [ 0x64cff0 - 0x64cff0 ]
      +0x000 Flink            : 0x0064cff0 _LIST_ENTRY [ 0x5b0038 - 0x5b0038 ]
      +0x004 Blink            : 0x0064cff0 _LIST_ENTRY [ 0x5b0038 - 0x5b0038 ]
   +0x040 Flags            : 2
   +0x044 ForceFlags       : 0
   +0x048 CompatibilityFlags : 0
   +0x04c EncodeFlagMask   : 0x100000
   +0x050 Encoding         : _HEAP_ENTRY
      +0x000 Size             : 0xbe89
      +0x002 Flags            : 0xf4 ''
      +0x003 SmallTagIndex    : 0x4f 'O'
      +0x000 SubSegmentCode   : 0x4ff4be89 
      +0x004 PreviousSize     : 0xcf53
      +0x006 SegmentOffset    : 0 ''
      +0x006 LFHFlags         : 0 ''
      +0x007 UnusedBytes      : 0 ''
      +0x000 FunctionIndex    : 0xbe89
      +0x002 ContextValue     : 0x4ff4
      +0x000 InterceptorValue : 0x4ff4be89
      +0x004 UnusedBytesLength : 0xcf53
      +0x006 EntryOffset      : 0 ''
      +0x007 ExtendedBlockSignature : 0 ''
      +0x000 Code1            : 0x4ff4be89
      +0x004 Code2            : 0xcf53
      +0x006 Code3            : 0 ''
      +0x007 Code4            : 0 ''
      +0x000 AgregateCode     : 0xcf53`4ff4be89
   +0x058 PointerKey       : 0x75c3a7b
   +0x05c Interceptor      : 0
   +0x060 VirtualMemoryThreshold : 0xfe00
   +0x064 Signature        : 0xeeffeeff
   +0x068 SegmentReserve   : 0x100000
   +0x06c SegmentCommit    : 0x2000
   +0x070 DeCommitFreeBlockThreshold : 0x800
   +0x074 DeCommitTotalFreeThreshold : 0x2000
   +0x078 TotalFreeSize    : 0x1ae8
   +0x07c MaximumAllocationSize : 0x7ffdefff
   +0x080 ProcessHeapsListIndex : 1
   +0x082 HeaderValidateLength : 0x138
   +0x084 HeaderValidateCopy : (null) 
   +0x088 NextAvailableTagIndex : 0
   +0x08a MaximumTagIndex  : 0
   +0x08c TagEntries       : (null) 
   +0x090 UCRList          : _LIST_ENTRY [ 0x64cfe8 - 0x64cfe8 ]
      +0x000 Flink            : 0x0064cfe8 _LIST_ENTRY [ 0x5b0090 - 0x5b0090 ]
      +0x004 Blink            : 0x0064cfe8 _LIST_ENTRY [ 0x5b0090 - 0x5b0090 ]
   +0x098 AlignRound       : 0xf
   +0x09c AlignMask        : 0xfffffff8
   +0x0a0 VirtualAllocdBlocks : _LIST_ENTRY [ 0x5b00a0 - 0x5b00a0 ]
      +0x000 Flink            : 0x005b00a0 _LIST_ENTRY [ 0x5b00a0 - 0x5b00a0 ]
      +0x004 Blink            : 0x005b00a0 _LIST_ENTRY [ 0x5b00a0 - 0x5b00a0 ]
   +0x0a8 SegmentList      : _LIST_ENTRY [ 0x5b0010 - 0x5b0010 ]
      +0x000 Flink            : 0x005b0010 _LIST_ENTRY [ 0x5b00a8 - 0x5b00a8 ]
      +0x004 Blink            : 0x005b0010 _LIST_ENTRY [ 0x5b00a8 - 0x5b00a8 ]
   +0x0b0 AllocatorBackTraceIndex : 0
   +0x0b4 NonDedicatedListLength : 0
   +0x0b8 BlocksIndex      : 0x005b0150 
   +0x0bc UCRIndex         : 0x005b0590 
   +0x0c0 PseudoTagEntries : (null) 
   +0x0c4 FreeLists        : _LIST_ENTRY [ 0x633060 - 0x63fbc0 ]
      +0x000 Flink            : 0x00633060 _LIST_ENTRY [ 0x632fc8 - 0x5b00c4 ]
      +0x004 Blink            : 0x0063fbc0 _LIST_ENTRY [ 0x5b00c4 - 0x633390 ]
   +0x0cc LockVariable     : 0x005b0138 _HEAP_LOCK
      +0x000 Lock             : <unnamed-tag>
   +0x0d0 CommitRoutine    : 0x075c3a7b     long  +75c3a7b
   +0x0d4 FrontEndHeap     : 0x005b8d08 
   +0x0d8 FrontHeapLockCount : 0
   +0x0da FrontEndHeapType : 0x2 ''
   +0x0dc Counters         : _HEAP_COUNTERS
      +0x000 TotalMemoryReserved : 0x100000
      +0x004 TotalMemoryCommitted : 0x9d000
      +0x008 TotalMemoryLargeUCR : 0
      +0x00c TotalSizeInVirtualBlocks : 0
      +0x010 TotalSegments    : 1
      +0x014 TotalUCRs        : 1
      +0x018 CommittOps       : 0x19
      +0x01c DeCommitOps      : 0
      +0x020 LockAcquires     : 0xd37
      +0x024 LockCollisions   : 0
      +0x028 CommitRate       : 0x24
      +0x02c DecommittRate    : 0xb
      +0x030 CommitFailures   : 0
      +0x034 InBlockCommitFailures : 0
      +0x038 CompactHeapCalls : 0
      +0x03c CompactedUCRs    : 0
      +0x040 AllocAndFreeOps  : 0
      +0x044 InBlockDeccommits : 0
      +0x048 InBlockDeccomitSize : 0
      +0x04c HighWatermarkSize : 0x9cde0
      +0x050 LastPolledSize   : 0x8f9c8
   +0x130 TuningParameters : _HEAP_TUNING_PARAMETERS
      +0x000 CommittThresholdShift : 4
      +0x004 MaxPreCommittThreshold : 0xfe000 
```

现在是 _HEAP_ENTRY（标记为内部）的详细视图。这是一个编码结构，可以通过与 _HEAP.Encoding 成员进行异或来解码：

```
0:004> dt _heap_entry 005b8d00
ntdll!_HEAP_ENTRY
   +0x000 Size             : 0xd19f
   +0x002 Flags            : 0xfd ''
   +0x003 SmallTagIndex    : 0x3f '?'
   +0x000 SubSegmentCode   : 0x3ffdd19f 
   +0x004 PreviousSize     : 0xc8f7
   +0x006 SegmentOffset    : 0 ''
   +0x006 LFHFlags         : 0 ''
   +0x007 UnusedBytes      : 0x8 ''
   +0x000 FunctionIndex    : 0xd19f
   +0x002 ContextValue     : 0x3ffd
   +0x000 InterceptorValue : 0x3ffdd19f
   +0x004 UnusedBytesLength : 0xc8f7
   +0x006 EntryOffset      : 0 ''
   +0x007 ExtendedBlockSignature : 0x8 ''
   +0x000 Code1            : 0x3ffdd19f
   +0x004 Code2            : 0xc8f7
   +0x006 Code3            : 0 ''
   +0x007 Code4            : 0x8 ''
   +0x000 AgregateCode     : 0x800c8f7`3ffdd19f 
```

现在注释代码：

1) 从 HEAP_ENTRY 中获取聚合
2) 使用 HEAP.Encoding 成员对 HEAP_ENTRY 进行解码 (XOR)
3) 移位结果以获取 _HEAP_ENTRY.Flags
4) 使用 HEAP_ENTRY_VIRTUAL_ALLOC (8) 获取结果以查看它是否是内部块

```
CPU Disasm
Address     Command                                  Comments
730AEF01    PUSH 0                                   ; /Arg4 = 0
730AEF03    PUSH ??_C@_0N@BCMFEPJJ@AgregateCode?$AA@ ; |Arg3 = ASCII "AgregateCode"
730AEF08    PUSH 0                                   ; |Arg2 = 0
730AEF0A    PUSH 0                                   ; |Arg1 = 0
730AEF0C    CALL GetShortField                       ; \exts.GetShortField
730AEF11    MOV DWORD PTR SS:[LOCAL.6],EAX           ; low part = 0x3FFDD19F (_HEAP_ENTRY.Code1)
730AEF14    MOV DWORD PTR SS:[LOCAL.5],EDX           ; high part = 0x0800C8F7
730AEF17    MOV EDX,DWORD PTR SS:[LOCAL.6]
730AEF1A    MOV DWORD PTR DS:[730F3158],EDX
730AEF20    MOV EAX,DWORD PTR SS:[LOCAL.5]
730AEF23    MOV DWORD PTR DS:[730F315C],EAX
730AEF28    MOV ECX,DWORD PTR SS:[LOCAL.6]           ; 0x3FFDD19F
730AEF2B    AND ECX,DWORD PTR DS:[EncodeFlagMask]    ; ecx = 0x3FFDD19F ^ 0x00100000 = 0x00100000
730AEF31    JE SHORT 730AEF75
730AEF33    MOV EDX,DWORD PTR SS:[LOCAL.6]           ; edx = 0x3FFDD19F
730AEF36    XOR EDX,DWORD PTR DS:[CrtHeapCode]       ; edx = 0x3FFDD19F ^ 0x4FF4BE89 = 0x70096F16
730AEF3C    MOV EAX,DWORD PTR SS:[LOCAL.5]           ; eax = 0x0800C8F7
730AEF3F    XOR EAX,DWORD PTR DS:[730F3194]          ; eax = 0x0800C8F7 ^ 0xCF53 = 0x080007A4
730AEF45    MOV DWORD PTR SS:[LOCAL.6],EDX           ; edx = 0x70096F16
730AEF48    MOV DWORD PTR SS:[LOCAL.5],EAX           ; eax = 0x080007A4
;[...]    
730AEFEE    MOVZX EAX,WORD PTR SS:[LOCAL.6]
730AEFF2    MOV DWORD PTR DS:[CrtHeapEntry],EAX      ; entry = 0x6f16
730AEFF7    MOV EAX,DWORD PTR SS:[LOCAL.6]           ; low part = 0x70096F16
730AEFFA    MOV EDX,DWORD PTR SS:[LOCAL.5]           ; high part = 0x080007A4
730AEFFD    MOV CL,10
730AEFFF    CALL _aullshr
730AF004    MOV BYTE PTR SS:[LOCAL.3+1],AL           ; 0x00000800:07A47009 -> al = 9
730AF007    MOVZX ECX,BYTE PTR SS:[LOCAL.3+1]
730AF00B    AND ECX,FFFFFFE6
730AF00E    OR ECX,DWORD PTR DS:[730F3148]
730AF014    MOV DWORD PTR DS:[730F3148],ECX
730AF01A    MOV EDX,DWORD PTR DS:[730F3148]
730AF020    AND EDX,00000001
730AF023    JE SHORT 730AF035
730AF025    MOVZX EAX,BYTE PTR SS:[LOCAL.3+1]        ; eax = 9 
730AF029    AND EAX,00000008                         ; 9 & 8 = 1
730AF02C    JE SHORT 730AF035
730AF02E    MOV BYTE PTR DS:[730F3152],1             ; set "Internal" flag 
```

希望能帮助到你！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2021-09-17T00:39:57.720

至少有时`Internal`意味着内存块对应于LFH堆入口。我有一个 windbg 转储，它报告了许多带有`!heap -h`. 然而，应用`!heap -hl`windbg 后显示更详细的信息，如

```
 ...
        0000000026ae0c70: 40000 . 40000 [101] - busy (3fff0) Internal 

        LFH data region at 0000000026ae0c80 (subsegment 00000000269c09c0):
            0000000026ae0ca0: 00910 - busy (908)
            0000000026ae15b0: 00910 - busy (908)
            0000000026ae1ec0: 00910 - busy (908)
            0000000026ae27d0: 00910 - busy (908)
            0000000026ae30e0: 00910 - busy (908)
            0000000026ae39f0: 00910 - busy (908)
            0000000026ae4300: 00910 - busy (908)
            0000000026ae4c10: 00910 - busy (908)
            0000000026ae5520: 00910 - busy (908)
            0000000026ae5e30: 00910 - busy (908)
            ...skipped
            0000000026b1df60: 00910 - busy (908)
            0000000026b1e870: 00910 - busy (908)
            0000000026b1f180: 00910 - busy (908)
            0000000026b1fa90: 00910 - busy (908)

        0000000026b20c70: 40000 . 10000 [101] - busy (fff0) Internal 

        LFH data region at 0000000026b20c80 (subsegment 00000000269c09f0):
            0000000026b20ca0: 00020 - busy (18)
            0000000026b20cc0: 00020 - busy (10)
            0000000026b20ce0: 00020 - busy (18)

        .... 
```

# iphone - 缩放 UIImageView 时内容失真

> ID：13059163
> 
> 赞同：0
> 
> 时间：2012-10-24T23:02:30.500
> 
> 标签：iphone, uiimageview, scaling

我有一个 UIImageView，其框架为 (0, 0, 568, 300)，其中包含一个原生大小为 512x384 像素的 UIImage。contentmode 设置为 Aspect fit。如果用户双击视图，我会使用以下代码更改 UIImageView 的大小：

```
self.imageViewerViewController.imageView.frame = CGRectMake(0, -63, 568, 426); 
```

结果是图像的右边缘变形，无法正确缩放到新尺寸。

附上一张黑白矩阵的图像，失真在右边。似乎右列像素重复到视图的右边缘。

![变形截图](../Images/b5ebdcdb8e95d7eb988066615a7dc28f.png)

任何人都可以帮忙吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T16:03:16.713

我已将受影响的 UIImageView 从 xib 文件的创建更改为在代码中创建它，并使用`- (id)initWithFrame:(CGRect)aRect:`具有 aRect 缩放图像的最大尺寸的方法。现在图像已正确缩放。显然，xib 文件中的 UIImageView 已经用 512x384 像素帧初始化。

# amazon-web-services - 使用亚马逊弹性mapreduce服务时如何在hadoop中包含第三方库

> ID：13059165
> 
> 赞同：3
> 
> 时间：2012-10-24T23:02:40.480
> 
> 标签：amazon-web-services, hadoop, mapreduce, amazon-emr

我必须使用名为 weka 的第三方库来完成一些数据挖掘任务。但我不确定如何在亚马逊弹性 mapreduce 服务中包含所需的 jar 文件。

有没有人有处理这个案子的经验？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T07:47:50.857

一种简单的解决方案是将您的依赖项与映射器和化简器一起放入您的 jar 文件中。

如果您使用 Maven 构建，我建议使用[Maven Assembly Plugin](https://maven.apache.org/plugins/maven-assembly-plugin/)插件来打包一个包含所有依赖项的 jar。

# c++ - 为什么 G++ 不会为模板方法不返回任何内容生成警告？

> ID：13059170
> 
> 赞同：2
> 
> 时间：2012-10-24T23:02:56.830
> 
> 标签：c++, templates, g++, warnings

考虑以下代码：

```
template <typename T>
class C2 {
     public: 
             T method() { }
             int method2() { }
}; 
```

编译它`g++ -Wall -c -pedantic`会给我以下警告：

`test.cpp: In member function ‘int C2<T>::method2()’:` `test.cpp:4:29: warning: no return statement in function returning non-void [-Wreturn-type]`

这是预期的。奇怪的是，它`method()`也没有返回任何东西。为什么不产生警告，因为实例化`C2`会使`T = int`对这两种方法的调用同样危险？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-24T23:11:22.853

如果您说`T = void`，则无需`return`声明。

仅仅因为您*可以*以一种被破坏的方式使用您的模板并不意味着您*必须这样*做，并且编译器可能会给您带来怀疑的好处。

还要记住，类模板的成员函数*只有在使用时才会被实例化*。因此，实际*导致*错误的方法是 have `C2<char> x; x.method();`，这确实会产生警告。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:20:13.970

您实际上必须调用“方法”才能让编译器编译它。毕竟是模板函数。请参阅下面代码中的注释。

```
template <typename T>
class C2 {
     public: 
             T method() { }
             int method2() { }
};

int main()
{
   C2<int> c;
   c.method2();
   // If you comment out the below line, there is no warning printed.
   c.method();
} 
```

# ios - 文件下载 UIWebView 到 UITableView

> ID：13059173
> 
> 赞同：0
> 
> 时间：2012-10-24T23:03:10.463
> 
> 标签：ios, xcode, uitableview, uiwebview, download

我设法用 UIWebView 制作了一个下载器。我想要做的是，当下载开始时，它应该在不同的视图控制器中开始，比如 tableView。

我有一个标签栏控制器，其中最后一个标签是下载，我希望我的下载显示在那里，包括 tableViewCell 中的进度条。

如果我将抓取的 url 传递给 tableView，然后从那里开始下载，它就不起作用。对不起，如果我没有说清楚..因为我自己很困惑。

问候，

马尔哈尔

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:05:11.623

试试[这个](http://www.cocoacontrols.com/controls/hcdownload)，很不错。工作背景也是如此。

# email - 使用 Amazon SES 发送电子邮件，SMS 网关将 ReturnPath 标头更改为 From 字段

> ID：13059180
> 
> 赞同：0
> 
> 时间：2012-10-24T23:03:50.003
> 
> 标签：email, amazon-web-services, sms, hex, amazon-ses

我正在使用亚马逊的 SES 电子邮件库来发送短信`5556665555@vtext.com`，例如通过发送它们，或者只是一封电子邮件本身。然而，最近一些短信的标题显示发件人地址如下所示： `0000013a94c84b04-4f0a3d49-483f-4dfb-8b8c-87a33698a35f-000000@amazonses.com`即使同一封电子邮件最终以常规发件人地址出现在我的电子邮件中。罪魁祸首/解决方案可能是什么？这以前工作得很好，没有改变标题的处理方式（我使用的是亚马逊 SES 库并且没有搞砸内部）。当我将代码发送到常规电子邮件地址或 SMS 网关地址时，代码完全相同。

更新

我已经意识到 vtext 从地址更改为 ReturnPath 标头，给了我冗长的地址。我尝试将 opt 变量设置为包含`'ReturnPath', 'me@me.com'`，因此当我调用`$ses->send_email($this->source,$this->destination,$this->message,$this->opt);`它时确实将其传递进来，但是，无论如何这都会被忽略。如何强制 SES 尊重 ReturnPath 标头，或者显示正确的 From 地址。

令人不安的是，ReturnPath 用于退回报告，所以如果这个针对 verizons 损坏系统的 hack 到位，我将不再收到退回邮件..但这是我目前所拥有的最好的。

# google-cloud-storage - 谷歌云存储公开共享

> ID：13059189
> 
> 赞同：3
> 
> 时间：2012-10-24T23:04:52.647
> 
> 标签：google-cloud-storage

我对存储桶的 Acl 权限如下：

```
<?xml version="1.0" ?>
<AccessControlList>
    <Owner>
        <ID>00b4903a97dfaa16aff41eeb91e90b5fb524f1daf0d88fceca29b6f647412e8d</ID>
    </Owner>
    <Entries>
        <Entry>
            <Scope type="GroupById">
                <ID>00b4903a97dfaa16aff41eeb91e90b5fb524f1daf0d88fceca29b6f647412e8d</ID>
            </Scope>
            <Permission>FULL_CONTROL</Permission>
        </Entry>
        <Entry>
            <Scope type="AllUsers"/>
            <Permission>READ</Permission>
        </Entry>

<Entry>
   <Scope type="UserByEmail">
      <EmailAddress>
         my_app@appspot.gserviceaccount.com
      </EmailAddress>
   </Scope>
   <Permission>
      WRITE
   </Permission>
</Entry>

    </Entries>
</AccessControlList> 
```

但是，当我在此存储桶中上传新文件时，默认情况下不共享。

我想我应该是因为 AllUsers 权限设置为读取

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-28T06:49:00.790

我认为您混淆了存储桶权限和对象权限。存储桶是公开可读的，因此每个人都可以列出存储桶的内容，但您上传的对象有自己的一组权限。如果您希望上传的对象可公开阅读，则需要明确启用它。您可以使用以下命令来执行此操作：

```
gsutil setacl public-read gs://bucket/object 
```

或者，您可以使用以下命令将包含存储桶的默认对象 ACL 设置为公开可读：

```
gsutil setdefacl public-read gs://bucket 
```

后者的优点是上传到该存储桶的每个对象都将自动继承包含存储桶的公共可读性。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2014-11-14T00:39:24.463

如果您得到：您正在为“defacl”使用已弃用的别名“setdefacl”...

采用`gsutil defacl set public-read gs://bucketname`

# html - HTML5 / CSS3 带部分边框的圆圈

> ID：13059190
> 
> 赞同：28
> 
> 时间：2012-10-24T23:04:53.830
> 
> 标签：html, css, border, css-shapes

是否可以仅使用 HTML5 / CSS3 创建一个圆圈，其边框仅围绕圆圈的一部分？如果不是，我可以使用什么技术来实现这种效果？我更喜欢使用纯 DOM 元素，但如果必须，我可以在画布上绘制或启动 SVG。

* * *

## 回答 #1

> 赞同：44
> 
> 时间：2012-10-24T23:28:00.170

是的，这是可能的 - 看到这个：

# [*演示*](http://dabblet.com/gist/3949571)

```
.circle {
  position: relative;
  margin: 7em auto;
  width: 16em;
  height: 16em;
  border-radius: 50%;
  background: lightblue;
}

.arc {
  overflow: hidden;
  position: absolute;
  /* make sure top & left values are - the width of the border */
  /* the bottom right corner is the centre of the parent circle */
  top: -1em;
  right: 50%;
  bottom: 50%;
  left: -1em;
  /* the transform origin is the bottom right corner */
  transform-origin: 100% 100%;
  /* rotate by any angle */
  /* the skew angle is 90deg - the angle you want for the arc */
  transform: rotate(45deg) skewX(30deg);
}

.arc:before {
  box-sizing: border-box;
  display: block;
  border: solid 1em navy;
  width: 200%;
  height: 200%;
  border-radius: 50%;
  transform: skewX(-30deg);
  content: '';
}
```

```
<div class='circle'>
  <div class='arc'></div>
</div>
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2012-10-24T23:35:42.423

这是可能的。

*   `border-radius`使用一个在另一个之上绘制两个圆圈。
*   `transparent`通过改变来制作两个圆的一个或多个圆弧`border-color`。
*   用于`transform`旋转第二个圆圈，您将获得所需大小的弧线。

这是**演示**：http: [//jsfiddle.net/kJXwZ/2/](http://jsfiddle.net/kJXwZ/2/)

```
.wrapper {
  position: relative;
  margin: 20px;
}

.arc {
  position: absolute;
  top: 0;
  left: 0;
  width: 100px;
  height: 100px;
  border-radius: 100%;
  border: 1px solid;
}

.arc_start {
  border-color: transparent red red red;
  -webkit-transform: rotate(45deg);
  -moz-transform: rotate(45deg);
  -ms-transform: rotate(45deg);
  -o-transform: rotate(45deg);
  transform: rotate(45deg);
}

.arc_end {
  border-color: red red red transparent;
  -webkit-transform: rotate(75deg);
  -moz-transform: rotate(75deg);
  -ms-transform: rotate(75deg);
  -o-transform: rotate(75deg);
  transform: rotate(75deg);
}
```

```
<div class="wrapper">
  <div class="arc arc_start"></div>
  <div class="arc arc_end"></div>
</div>
```

* * *

## 回答 #3

> 赞同：13
> 
> 时间：2014-02-23T22:02:32.180

这也使用了 JavaScript，因此它打破了原始要求 :(
.. 但是它确实提供了

有一个>>[演示](http://jsfiddle.net/Ht5X7/2/)<<这里

@gkond 谢谢，我从你的回答中得出这个

```
// create a circle using HTML5 / CSS3 / JS which has a border that only goes part-way around
// the circle .. and which can be smoothly animated from 0% to 100% around the circle

// this solution allows for animation and still results in relatively clean code
// we use four quarter-circles, all hidden away behind a white square to start with..
// all four are rotated out clockwise, and each quarter will stop at it's own maximum:
// q1 at 25%, q2 at 50% .. etc. once we reach a value at or over 25%, all four quarters
// should be out from behind the white square, and we can hide it.. it needs to be
// hidden if we display a value over 75%, or else q4 will end up going in behind it again
// .. also, since the top border will usually sit between the angles of  -45 to 45, we
// rotate everything by an extra -45 to make it all line up with the top nicely

var fromHidden = -90;

// utility function to align 0 degrees with top
// takes degrees and returns degrees - 45
function topAlign(degrees) {
  return degrees - 45
};

// utility function to rotate a jQuery element
// takes element and the degree of rotation (from the top) 
function rotate(el, degrees) {
  var degrees = topAlign(degrees || 0);
  el.css(
    'transform', 'rotate(' + degrees + 'deg)',
    '-webkit-transform', 'rotate(' + degrees + 'deg)',
    '-moz-transform', 'rotate(' + degrees + 'deg)',
    '-ms-transform', 'rotate(' + degrees + 'deg)',
    '-o-transform', 'rotate(' + degrees + 'deg)'
  )
}

// function to draw semi-circle
// takes a jQuery element and a value (between 0 and 1)
// element must contain four .arc_q elements
function circle(el, normalisedValue) {
  var degrees = normalisedValue * 360; // turn normalised value into degrees
  var counter = 1; // keeps track of which quarter we're working with
  el.find('.arc_q').each(function() { // loop over quarters..
    var angle = Math.min(counter * 90, degrees); // limit angle to maximum allowed for this quarter
    rotate($(this), fromHidden + angle); // rotate from the hiding place
    counter++; // track which quarter we'll be working with in next pass over loop
  });
  if (degrees > 90) { // hide the cover-up square soon as we can
    el.find('.arc_cover').css('display', 'none');
  }
}

// uses the the circle function to 'animate' drawing of the semi-circle
// incrementally increses the value passed by 0.01 up to the value required
function animate(el, normalisedValue, current) {
  var current = current || 0;
  circle(el, current);
  if (current < normalisedValue) {
    current += 0.01;
    setTimeout(function() {
      animate(el, normalisedValue, current);
    }, 1);
  }
}

// kick things off ..
animate($('.circle'), 0.69);
```

```
.circle {
  position: relative;
  margin: 20px;
  width: 120px;
  height: 120px;
}

.arc_q {
  position: absolute;
  top: 0;
  left: 0;
  width: 100px;
  height: 100px;
  border-radius: 50%;
  border: 10px solid;
  border-color: transparent green transparent transparent;
  transform: rotate(-45deg);
  -webkit-transform: rotate(-45deg);
  -moz-transform: rotate(-45deg);
  -ms-transform: rotate(-45deg);
  -o-transform: rotate(-45deg);
}

.arc_cover {
  position: absolute;
  top: 0;
  left: 0;
  width: 60px;
  height: 60px;
  background-color: white;
}
```

```
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<div class="circle">
  <div class="arc_q"></div>
  <div class="arc_q"></div>
  <div class="arc_q"></div>
  <div class="arc_q"></div>
  <div class="arc_cover"></div>
</div>
```

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2015-01-26T01:33:37.243

为此，您可以使用简单的框边框属性，一个元素和一个类。这将是内联、内联块或块处理，具体取决于您放置 easy-circle 类的位置，以及您如何/是否设置位置样式。

```
<!DOCTYPE html>
<html>
<head>
<style>
.easy-circle {
    background: transparent;
    border: 1em solid black; /* color not required, may show device fail */
    border-color: red green blue transparent;
    height: 10em;
    width: 10em;
    -moz-border-radius: 6em; /* height/2 + border thickness */
    -webkit-border-radius: 6em;
    border-radius: 50%; /* more than 50, shape-size adjustment irrelevant */
    -ms-transform: rotate(45deg); /* IE 9 */
    -webkit-transform: rotate(45deg); /* Chrome, Safari, Opera */
     transform: rotate(45deg); /* transform optional */
}
</style>
</head>
<body>
<div class="easy-circle">
</div>​
</body>
</html> 
```

* * *

## 回答 #5

> 赞同：2
> 
> 时间：2018-10-16T15:37:33.223

这可以通过在透明圆圈周围设置透明边框并使用`border-top-color: ;`为圆形边框的一部分赋予颜色来实现。

```
background-color:transparent;
border:3px solid transparent;
border-top-color: green; 
```

这将创建一个仅在上四分之一周围有边框的圆圈；

你也可以使用

```
border-bottom-color:green; 
```

以及左右边界的圆圆周的不同季度。

这是一个带有 3 个部分圆的装载机的小提琴，这些圆在彼此内部以交替方向旋转，显示了这一点。

[这是一个带有 3 个部分圆的装载机的小提琴，这些圆在彼此内部以交替方向旋转，显示了这一点。](https://jsfiddle.net/seanculleng/9bj6fgqk/33/)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2021-03-12T14:02:56.883

圆锥梯度解（适用于任何度数）：

```
:root{
--degree:80deg;
--color:red;
}

.a{
  height:200px;
  width:200px;
border-radius:50%;
background: conic-gradient(
     var(--color) var(--degree), transparent calc(var(--degree) + 0.5deg) 100%);

}

.b{
  height:84%;
  width:84%;
  top:8%;
  left:8%;
  position:relative;
  border-radius:50%;
  background:#D3D3D3;
}
```

```
<div class ="a">
    <div class="b">
</div>
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2015-04-07T21:43:23.013

对此进行动画处理的最简单方法是使用 css 关键帧。

[http://jsfiddle.net/8SUPX/644/](http://jsfiddle.net/8SUPX/644/)

```
/**
 * HTML5 / CSS3 Circle with Partial Border
 * http://stackoverflow.com/q/13059190/1397351
 */
* { margin: 0; padding: 0; }
.circle {
	position: relative;
	margin: 6em auto;
	width: 12em; height: 12em;
	border-radius: 50%;
	background: transparent;
	border:20px solid #efefef;
	border-top-color: #efefef;
    border-right-color: #efefef;
    border-bottom-color: #efefef;
    border-left-color: #efefef;

    -webkit-transition:.5s;-moz-transition:.5s;transition:.5s;
}
.circle:hover{
      -webkit-animation:  animix 0.5s 1;
      -webkit-animation-fill-mode: forwards;
      -moz-animation:  animix 0.5s 1;
      -moz-animation-fill-mode: forwards;
      animation:  animix 0.5s 1;
      animation-fill-mode: forwards;
}

  //Animate
   @-webkit-keyframes animix {
    0% { 
      border-top-color: transparent;
      border-right-color: transparent;
      border-bottom-color: transparent;
      border-left-color: transparent;
    }
     25% { 
       border-top-color: red;
       border-right-color: transparent;
       border-bottom-color: transparent;
       border-left-color: transparent;
     }
     50% { 
       border-top-color: red;
       border-right-color: red;
       border-bottom-color: transparent;
       border-left-color: transparent;
     }
     75% { 
       border-top-color: red;
       border-right-color: red;
       border-bottom-color: red;
       border-left-color: transparent;
     }
     100% { 
       border-top-color: red;
       border-right-color: red;
       border-bottom-color: red;
       border-left-color: red;
     }
   }

      @keyframes animix {
    0% { 
      border-top-color: transparent;
      border-right-color: transparent;
      border-bottom-color: transparent;
      border-left-color: transparent;
    }
     25% { 
       border-top-color: red;
       border-right-color: transparent;
       border-bottom-color: transparent;
       border-left-color: transparent;
     }
     50% { 
       border-top-color: red;
       border-right-color: red;
       border-bottom-color: transparent;
       border-left-color: transparent;
     }
     75% { 
       border-top-color: red;
       border-right-color: red;
       border-bottom-color: red;
       border-left-color: transparent;
     }
     100% { 
       border-top-color: red;
       border-right-color: red;
       border-bottom-color: red;
       border-left-color: red;
     }
   }
```

```
<div class="circle"> </div>
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2021-04-27T08:40:18.370

如果你想要双边框，你也可以使用它

```
div
{
  background-color: #ddd;
  text-align: center;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: bold;
  font-size: 30px;
  margin:  40px auto;
  color: black; 
  width: 200px;
  height: 200px; 
  border-radius: 50%; 
  position: relative;
}

div::before
{ 
  content: "";
  width: 200px;
  height: 200px;
  border-radius: 50%;
  position: absolute;
  left: 0;
  top: 0;
  transform: translate(-10px, -10px);
  z-index: -1;
  border: 10px solid;
  border-color: red red red transparent;
}
body ::after
{
  content: "";
  width: 220px;
  height: 220px;
  border-radius: 50%;
  position: absolute;
  left: 0;
  top: 0;
  transform: translate(-21px, -22px);
  z-index: -8;
  border: 12px solid;
  background: transparent;
  border-color: blue transparent blue blue;
}
```

```
<div> </div>
```

# ruby - 使用代码块作为父哈希中的值

> ID：13059199
> 
> 赞同：0
> 
> 时间：2012-10-24T23:05:59.953
> 
> 标签：ruby

我正在尝试使用一些 Ruby 魔法重构我的代码（在它是一堆 if/else-if 语句之前）。但是，当我尝试在哈希中使用代码块作为我的值时，我收到以下错误：

```
syntax error, unexpected '}', expecting tASSOC :restaurant => { Cuisine.all }, 
```

`:hotel`下一行和 (和`:attraction`)之后的行重复同样的错误。

我在这里做错了什么？

```
def moderation_categories(klass) 
  klass_map = {
    :restaurant => { Cuisine.all },
    :hotel      => { Category.where(place_type: "Hotel") },
    :attraction => { Category.where(place_type: "Attraction") }
  }
  list = []
  klass_map[klass.to_sym].call.each { |c| list << c.name }

  list.sort
end 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:12:35.693

块不仅仅代表 lambda（代码块）。您必须将其指定为 lambda 或 Proc。

```
 klass_map = {
    :restaurant => lambda{ Cuisine.all },
    :hotel      => lambda{ Category.where(place_type: "Hotel") },
    :attraction => lambda{ Category.where(place_type: "Attraction") }
  } 
```

# jquery - Jquery切换自定义动画

> ID：13059201
> 
> 赞同：2
> 
> 时间：2012-10-24T23:06:10.407
> 
> 标签：jquery, jquery-ui, animation, toggle

我有这个动画，我想在点击链接时触发它。当我单独运行动画时，它工作正常。但是使用 jquery `toggle()`，它不再起作用了。任何人都可以很容易地看出为什么吗？

没有`toggle()`它可以工作（分别运行）：

```
$('#sign-in-fx').click(function() {
    $('.login_form').animate({ width: '273' }, 'slow', 'easeInOutQuart');
    //$('.login_form').animate({ width: '1' }, 'slow', 'easeInOutQuart');
}); 
```

没有`toggle()`任何反应：

```
$('#sign-in-fx').click(function() {
    $('.login_form').toggle(
        function() {
            $(this).animate({ width: '273' }, 'slow', 'easeInOutQuart')
        },
        function() {
            $(this).animate({ width: '1' }, 'slow', 'easeInOutQuart')
        }
    );
}); 
```

这类似于[jQuery 切换动画](https://stackoverflow.com/questions/931113/jquery-toggle-animation)

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:22:37.903

现在我认为这是您最初想做的事情：

```
$('#sign-in-fx').toggle(
        function() {
            $('.login_form').animate({ width: '273' }, 'slow', 'easeInOutQuart')
        },
        function() {
            $('.login_form').animate({ width: '1' }, 'slow', 'easeInOutQuart')
        }
); 
```

您正在调用`toggle()`元素以进行动画处理，但必须在将接收`click`事件的元素上调用它。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:13:33.270

`toggle()`以您使用它的方式使用，已[**弃用**](http://api.jquery.com/category/deprecated/)！

使用标志，并直接切换动画宽度，如下所示：

```
var flag = true;

$('#sign-in-fx').on('click', function() {
    $('.login_form').stop(true, true)
                    .animate({ width: flag?'273':'1' }, 'slow', 'easeInOutQuart');
    flag=!flag;
});​ 
```

[**小提琴**](http://jsfiddle.net/HUHfk/1/)

或者，如果您不喜欢全局变量，您可以随时使用 data() ：

```
$('#sign-in-fx').on('click', function() {
    var flag = $('.login_form').data('flag')!=undefined?$('.login_form').data('flag'):true;
    $('.login_form').stop(true, true)
                    .animate({ width: flag?'273':'1' }, 'slow', 'easeInOutQuart')
                    .data('flag', !flag);
});​ 
```

[**小提琴**](http://jsfiddle.net/HUHfk/2/)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:13:17.997

我认为您还可以执行以下操作：

```
$('#sign-in-fx').click(function() {
    if (! $('.login_form').is(':animated')) { //if no animation running
       if ($('.login_form').width() > 1) {
          $('.login_form').animate({ width: '1' }, 'slow', 'easeInOutQuart');
       } else {
         $('.login_form').animate({ width: '273' }, 'slow', 'easeInOutQuart');
       }

    }
}); 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T23:16:10.867

你确定它已经完成了`document.ready`吗？你的代码看起来不错。

```
 $(function () {
      $('.login_form').toggle(
          function() {
              $(this).animate({ width: '273' }, 'slow', 'easeInOutQuart')
          },
          function() {
              $(this).animate({ width: '1' }, 'slow', 'easeInOutQuart')
          }
      );
    }); 
```

# background - Outlook 不尊重 html 电子邮件中的表格单元格宽度

> ID：13059202
> 
> 赞同：1
> 
> 时间：2012-10-24T23:06:14.103
> 
> 标签：background, outlook, html-table, html-email, cellspacing

我正在尝试创建一个 HTML 电子邮件，该电子邮件使用将在所有电子邮件客户端中正确呈现的渐变。我最初尝试使用 TD 属性和 CSS 垂直重复 1 x 13 像素的图像背景，但 Outlook 说“不”。现在我已经制作了 13 个宽度为 1px 的 TD 和构成渐变的背景颜色，但 Outlook 将它们渲染为大约 3px 宽和 1px 边框。

这是代码。我怎样才能取悦 Outlook，或者有没有办法取悦 Outlook？

```
<table width="730px" cellpadding="0px" cellspacing="0" border="0" style="border-collapse:collapse; font-size: 12px; line-height: 1.2; font-family: Arial; margin-left:auto; margin-right:auto; margin-bottom:0;" bgcolor="#fbebd8">
    <tr valign="top">
        <td bgcolor="#fff" width="1px"> </td>
        <td bgcolor="#fff" width="1px"> </td>
        <td bgcolor="#fdfcfa" width="1px"> </td>
        <td bgcolor="#fcf8f5" width="1px"> </td>
        <td bgcolor="#f7f2ee" width="1px"> </td>
        <td bgcolor="#f2e7e1" width="1px"> </td>
        <td bgcolor="#efded4" width="1px"> </td>
        <td bgcolor="#e9d3c5" width="1px"> </td>
        <td bgcolor="#dfc8b6" width="1px"> </td>
        <td bgcolor="#d9bba3" width="1px"> </td>
        <td bgcolor="#e4cab3" width="1px"> </td>
        <td bgcolor="#ddc7b0" width="1px"> </td>
        <td bgcolor="#ebd9c3" width="1px"> </td>
        <td bgcolor="#f9e7d1" width="1px"> </td>
        <td> 

            <!-- embedded half-left table -->

            <table width="348px"  cellpadding="5px" cellspacing="0" border="0" style="border-collapse:collapse; font-size: 12px; line-height: 1.2; font-family: Arial;">
                <tr>
                    <td colspan="3" valign="top">
                        <p><strong>Lorem Ipsum</strong></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                    </td>
                    <td > <img width="4px" src="CaseNotes/greenbox.jpg" /> </td>
                    <td valign="top"> <img src="CaseNotes/archive/20120815-honors-college.jpg" alt="" height="81" width="100" /> </td>
                </tr>
            </table>
            <!-- end half-left table --> 
        </td>
        <td bgcolor="#999999" > <img width="2px" src="CaseNotes/greybox.jpg" /> </td>
        <td>
            <table width="348px" cellpadding="5px" cellspacing="0" border="0" style="border-collapse:collapse; font-size: 12px; line-height: 1.2; font-family: Arial;" >
                <!-- half-right table -->
                <tr valign="top">
                    <td valign="top" colspan="3">
                        <p><strong>Lorem Ipsum</strong></p>
                    </td>
                </tr>
                <tr>
                    <td valign="top">
                        <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.</p>
                    </td>
                    <td > <img width="4px" src="CaseNotes/greenbox.jpg" /> </td>
                    <td> <img src="CaseNotes/superman.jpg" alt="" height="150px" width="150px" /> </td>
                </tr>
            </table>
            <!-- end half-right table --> 
        </td>
        <td bgcolor="#f9e8d4" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#e7cfb8" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#ead2bb" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#e5c8b0" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#b17853" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#b88460" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#c29371" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#cca385" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#d5b39a" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#ddc2ad" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#e5cfbe" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#ebdbce" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#f1e5dc" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#f6efe9" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#faf5f2" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#fdfaf9" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#fefefd" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
        <td bgcolor="#fffefe" width="1px"> <img src="http://greenandgold.uaa.alaska.edu/chancellor/casenotes/images/clear1x1.png" /> </td>
    </tr>
</table>
<!-- end super table --> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-14T14:17:27.603

尝试两次声明宽度。一次作为 html 属性，一次作为内联 css 样式。

例如试试这个：

一些电子邮件客户端使用 html 属性，我认为 Outlook 2010 使用内联样式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-22T19:36:28.913

电子邮件的万无一失的背景：http: [//emailbg.net/](http://emailbg.net/)

将您的托管图片网址放在左上角，确保您的图片尺寸在代码中正确（您可能必须在左上角的文本框中再次按 Enter），并确保您单击单个表格单元格:)

我经常使用这个。经 Litmus 测试，全面合规。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-04-22T15:25:35.420

我不知道这是否是问题，但是，当从 CSS 中定义宽度时，但作为一个属性，你不要用`px`.

例如：`<td width="1">`

相比之下，css 会：`<td style="width:1px;">;`

# c - 编写获取下一个令牌函数

> ID：13059219
> 
> 赞同：1
> 
> 时间：2012-10-24T23:07:28.017
> 
> 标签：c, parsing, static

给定一个 C 字符串：我如何编写一个函数来获取字符串中的下一个标记，以及一个可以在不使用全局变量的情况下查看下一个标记并返回它的函数？

我想要做的是有一个静态变量来保存字符串，当被调用时，它只会增加一个指针，它会重置那个静态变量，抛出已检索到的令牌。问题是：当我只是检索它时，我如何能够区分第一个调用（当它实际存储字符串时）和其他调用？

对此有什么想法吗？

**编辑：** 这就是我现在“有效”的东西，但我想确保它应该真正有效，而不仅仅是指针为空的巧合：

```
char next_token(char *line) {
    static char *p;
    if (p == NULL)
        p = line;
    else {
        char next_token = p[0];
        p++;
        return next_token;
    }
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:11:17.193

```
typedef struct {
   char* raw;
   // whatever you need to keep track
} parser_t

void parser_init(parser_t* p, char* s)
{
   // init your parser
}

bool parser_get_token(parser_t* p, char* token)
{
   // return the token in "token"  or return a bool error ( or an enum of various errors)
}

bool parser_peek_token(parser_t* p, char* token)
{
  // same deal, but don't update where you are...
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:11:29.353

你有几个选择。一种方法是使用大致类似的接口`strtok`，其中传递非空指针初始化静态变量，传递空指针检索令牌。然而，在存在多线程的情况下，这相当丑陋、笨拙、容易出错并且有问题。

另一种可能性是使用具有单独函数（都在该文件中）的文件级静态变量来初始化静态变量，并从字符串中检索下一个标记。这稍微干净一些，但仍然存在大多数相同的问题。

第三种方法是让它（例如）像文件一样运行——用户调用 parse_open（例如），传入要解析的字符串。你返回一个不透明的句柄给他们。然后，他们每次想要另一个令牌时将其传递回（比如说）get_token。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:22:39.707

您编辑的代码是错误的。您正在错误地处理 NULL 情况。

我最初的回答是模仿`strtok`这似乎是你想要的，但你已经澄清你想要单个字符。

if 条件应该是：

```
if (line != NULL) p = line; 
```

而且您可能会删除，`else`以便代码每次都执行...除非您不希望在第一次调用时得到结果（尽管您至少应该返回一个值）。

你这样打电话：

```
char token = next_token(line);

while( 0 != (token = next_token(NULL)) ) {
    // etc
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T00:01:28.523

基本上，函数可以通过三种方式将信息传递回其调用者：

*   通过全局变量
*   通过返回值
*   通过指针参数

而且，类似地，函数有一些方法可以在调用之间保持状态：

*   通过全局或（函数）静态变量
*   通过将其作为函数参数提供并在每次调用后返回
*   通过指针参数。

词法分析器/标记器的一个很好的编码约定是使用返回值来传达消耗的字符数。（并且*可能*使用额外的指针变量来来回调用解析器状态）

这是 wakkerbot 的解析器：

```
STATIC size_t tokenize(char *string, int *sp); 
```

用法：

```
STATIC void make_words(char * src, struct sentence * target)
{
    size_t len, pos, chunk;
    STRING word ;
    int state = 0; /* FIXME: this could be made static to allow for multi-line strings */

    target->size = 0;

    len = strlen(src);
    if (!len) return;

    for(pos=0; pos < len ; ) {

    chunk = tokenize(src+pos, &state);
        if (!chunk) { /* maybe we should reset state here ... */ pos++; }
        if (chunk > STRLEN_MAX) {
            warn( "Make_words", "Truncated too long string(%u) at %s\n", (unsigned) chunk, src+pos);
            chunk = STRLEN_MAX;
            }
        word.length = chunk;
        word.word = src+pos;

        if (word_is_usable(word)) add_word_to_sentence(target, word);

        if (pos+chunk >= len) break;
        pos += chunk;
    }
...
} 
```

# ruby-on-rails - 深入了解关联？

> ID：13059225
> 
> 赞同：0
> 
> 时间：2012-10-24T23:08:00.323
> 
> 标签：ruby-on-rails, ruby-on-rails-3

我正在尝试进入 Rails3 的思维模式，但遇到了一个有趣的问题。

我有以下结构：

*   用户 has_many 任务
*   任务 has_many 资产
*   资产的 score 属性介于 0 到 99 之间

我想得到每个用户所有分数的总和，我怀疑范围可能有用......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:16:43.490

这应该是您所需要的：

```
class User < ActiveRecord::Base
  has_many :tasks
  has_many :assets, through: :tasks

  def score_sum
    assets.pluck(:score).inject(:+)
  end

  # pre rails 3.2, try this:
  def score_sum
    assets.select(:score).map(&:score).inject(:+)
  end
end 
```

# objective-c - Theos SDK 3.2 和 iPad

> ID：13059226
> 
> 赞同：0
> 
> 时间：2012-10-24T23:08:01.040
> 
> 标签：objective-c, ipad, sdk, theos

好的，两个问题，1.你如何强制 theos 使用 3.2 sdk（用 3.2 替换 2.0 sdk 是否简单？2.你将如何使用 sdk 为 iPad 开发一个简单的 gui 应用程序

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T09:47:50.313

从**Cydia**安装**BigBoss 推荐工具**。[从http://apt.saurik.com/cydia/debs/libgcc_4.2-20080410-1-6_iphoneos-arm.deb](http://apt.saurik.com/cydia/debs/libgcc_4.2-20080410-1-6_iphoneos-arm.deb)下载软件包，然后安装。之后也从**Cydia安装****GNU C 编译器**。添加 repo并从**Cydia**安装**class-dump-z**、**Perl iPhone Source**和**Mobile Terminal**。启动终端并运行，输入root密码（默认），然后最后。之后让它发挥它的魔力，然后运行 ​​$THEOS/bin/nic.pl 开始！**`libgcc`****`ininjas.com/repo/`********`su``alpine``installtheos3`**************

 ******* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-23T21:49:41.873

如果您还没有弄清楚这一点，并且对于寻找此信息的其他人来说，解决方案非常简单。在您的 Info.plist 中，为您希望支持的设备添加“UIDeviceFamily”键和带有整数的数组，1 用于 iPhone/iTouch，2 用于 iPad。例子。

```
 <key>UIDeviceFamily</key>
    <array>
        <integer>1</integer>
        <integer>2</integer>
    </array> 
```

这使应用程序具有通用性。

更多信息：http: [//developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html](http://developer.apple.com/library/ios/#documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html)******

# xml - 谷歌地图 MarkerClusterer

> ID：13059232
> 
> 赞同：1
> 
> 时间：2012-10-24T23:08:43.897
> 
> 标签：xml, google-maps, markerclusterer

我正在尝试使用 V3 MarkerClusterer 功能。

从我的数据库加载和解析 XML 没问题，但集群器不在我的阵列上工作？

我只是让我所有的标记一直显示！

任何帮助表示赞赏。

```
<script type="text/javascript">
    var map;
    var marker;
   var markerArray  = [];

  function initialize() {
 var myLatlng = new google.maps.LatLng(0.00,-8.6130819);
var myOptions = {
zoom: 2,
center: myLatlng,
mapTypeId: google.maps.MapTypeId.SATELLITE
}
map = new google.maps.Map(document.getElementById("map_canvas"), myOptions);
    var infoWindow1 = new google.maps.InfoWindow;       
    var infoWindow = new google.maps.InfoWindow     

//  PHP file to parse and retrieve database points
  downloadUrl("/php/Ventus_application2.php", function(data) {
    var xml = data.responseXML;
    var markers = xml.documentElement.getElementsByTagName("CARMA");
    for (var i = 0; i < markers.length; i++) {
      var MTCPERYEAR = markers[i].getAttribute("MTCPERYEAR");
      var PLANT = markers[i].getAttribute("PLANT");
      var point = new google.maps.LatLng(
          parseFloat(markers[i].getAttribute("LAT")),
          parseFloat(markers[i].getAttribute("LON")));
      var html = "<b> Total CO2 emissions: </b> " + MTCPERYEAR + "<b> Mega Tons </b><br/><br/>"+"<b> Plant Name: </b>"+ PLANT;
      var html1 = PLANT;

      marker = new google.maps.Marker({
        map: map,
        position: point,
        draggable: true,
        icon: 'http://labs.google.com/ridefinder/images/mm_20_blue.png',
      });
  //marker array to allow clearin markers
   markerArray.push(marker);

      bindInfoWindow(marker, map, infoWindow1, html1);
      bindInfoWindow(marker, map, infoWindow, html);

     <!-- Add a listener for drag event and return lat and long --> 
      google.maps.event.addListener(marker, 'dragend', function (event) {
      document.getElementById("LAT").value = this.getPosition().lat();
      document.getElementById("LON").value = this.getPosition().lng();
        });       
      google.maps.event.addListener(marker, 'click', function() {
      document.getElementById("PLANT").value = infoWindow1.getContent();
        });
    }
        var markerCluster = new MarkerClusterer(map, markerArray);      
  });

function bindInfoWindow(marker, map, infoWindow, html) {
  google.maps.event.addListener(marker, 'click', function() {
    infoWindow.setContent(html);
    infoWindow.open(map, marker);
  });
}

function downloadUrl(url, callback) {
  var request = window.ActiveXObject ?
      new ActiveXObject('Microsoft.XMLHTTP') :
      new XMLHttpRequest;

  request.onreadystatechange = function() {
    if (request.readyState == 4) {
      request.onreadystatechange = doNothing;
      callback(request, request.status);
    }
  };

  request.open('GET', url, true);
  request.send(null);
}

function doNothing() {};
}
    </script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T18:48:53.747

Nevermind.

I simply forgot to add the reference to the markerCluster library

```
<script type = "text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/markerclusterer/src/markerclusterer.js"></script> 
```

# java - org.hibernate.ObjectDeletedException：已删除的实例传递给合并

> ID：13059241
> 
> 赞同：0
> 
> 时间：2012-10-24T23:10:07.660
> 
> 标签：java, hibernate, jpa

这是我的删除方法：

```
public void removeIletisimAdresi(Integer index){
              getUser().getIletisimBilgileri().remove(getUser().getIletisimBilgileri().get(index))
        } 
```

这是我的父母关系

...

```
@OneToMany(cascade = CascadeType.ALL, fetch = FetchType.LAZY, targetEntity= IletisimBilgileri.class,  mappedBy = "user")
@Cascade(org.hibernate.annotations.CascadeType.DELETE_ORPHAN)
private List<IletisimBilgileri> iletisimBilgileri = new ArrayList<IletisimBilgileri(0); 
```

...

这是我的孩子：

```
@ManyToOne(fetch = FetchType.LAZY)
@JoinColumn(name = "Kullanici")
private Users user ; 
```

因此，如果我调用 remove 方法并像 entityManager.merge(user) 那样更新父级，它会引发如下异常：

引起：org.hibernate.ObjectDeletedException：已删除实例传递给合并：[com.medikalborsasi.model.IletisimBilgileri#]

..

你能解释一下并帮助我如何解决这个问题吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T10:58:21.007

我认为问题仅在您的代码中，

```
getUser().getIletisimBilgileri().remove(getUser().getIletisimBilgileri().get(index)) 
```

您的映射必须采用这样一种方式，即如果您从休眠状态中删除一个实体，则会导致从其他依赖实体中删除相同的实体。例如：

```
Class A
{
     /* List of B entity(child) */
     List<B> listOfB;

}

Class B
{
     /* reference of A(parent) */
     A a;
} 
```

所以如果你打电话

```
hibernateSession.delete(b); 
```

应该从 A 中的列表中删除 b 的引用。您不必从 A 中的列表中显式删除 B 的引用。因此，按照您正在执行的方法

```
getA().getListOfB.remove(getA().getListOfB().get(someIndex)); 
```

我希望这个小例子能解决你的问题。

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T10:16:05.300

在删除实体之前，该实体必须处于管理状态。我们可以使用一些函数`merge`，`find`等等。**注意：**关闭后`EntityManager`，它的所有实体都会被分离。

```
public void remove(Person p) {
    Perosn p2 = em.merge(p);
    em.remove(p2);
} 
```

# actionscript-3 - As3在mouseX和mouseY周围绘制位图+copyPixel

> ID：13059245
> 
> 赞同：0
> 
> 时间：2012-10-24T23:10:22.210
> 
> 标签：actionscript-3, bitmap, bitmapdata

我在做放大镜效果？

我有一个工作版本。然而，平板电脑的性能还不够好。

**到目前为止我做了什么：**

我在 mouseDown 上有一个 ENTERFRAME 事件

所以当鼠标单击时它开始捕获屏幕，并跟随mouseX和mouseY

它可以工作，但唯一的问题是它一直在绘制整个舞台，而不是在 mouseX 和 mosueY 周围（300px * 300px）。有没有办法根据你的mouseX和mouseY制作绘图区域。我想这也会对性能有所帮助。:)

```
e.target.removeEventListener(Event.ENTER_FRAME, startCapture);

function startCapture(e:Event):void{
    var glassWidth:uint=80;
    var glassHeight:int=80;
    var curBd:BitmapData;
    var curBmp:Bitmap;
    var posX:int = _parentStage.mouseX - 40;
    var posY:int = _parentStage.mouseY - 40;

    //-------------------------------------------------------------
    //var subArea:Rectangle = new Rectangle(0,0,500,500);
    //var newBmp:Bitmap = new BitmapData(500,500);
    //var cutoutBmp:Bitmap = new Bitmap( newBmp, PixelSnapping.ALWAYS, true );
    //cutoutBmp.bitmapData.draw( jpgSource, new Matrix(1, 0, 0, 1, -357, -341) , null, null, subArea, true );
    //-------------------------------------------------------------

    bd = new BitmapData(1024, 768, true, 0);
    var subArea:Rectangle = new Rectangle(_parentStage.mouseX, _parentStage.mouseY, 500, 500);
   // bd = new BitmapData(500, 500);
   bd.draw(_parentStage.mc_mainContainer);
    // bd.draw(_parentStage.mc_mainContainer);

    curBmp=new Bitmap(new BitmapData(glassWidth,glassHeight), PixelSnapping.ALWAYS);
    curBmp.bitmapData.copyPixels(bd,new Rectangle(posX,posY,_parentStage.mouseX,_parentStage.mouseY),new Point(0,0));
    curBd=curBmp.bitmapData;

    var ma:Matrix = new Matrix(1, 0, 0, 1, -40, -40);
    glass.name = 'glass';
    glass.alpha = 1;
    glass.graphics.clear();
    glass.graphics.beginBitmapFill(curBd, ma);
    glass.graphics.drawCircle(0, 0, 35);
    //glass.graphics.drawCircle(0, 0, 35);
    glass.graphics.endFill();

    //var imageCircle:Bitmap = new _magGlass();
    //trace(_magGlass);
    //glass.addChild(_magGlass);

    if(!_parentStage.contains(glass))_parentStage.addChildAt(glass, _parentStage.numChildren - 2);
    glass.x = _parentStage.mouseX;
    glass.y = _parentStage.mouseY - 75;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T01:29:06.757

您的性能问题来自于您在每一帧上创建新位图、位图数据和矩形的地方。相反，只需在构造函数中或单击时创建一两个，然后重用它们。由于您已经有一个 BitmapData，您可以将它放在舞台上并对其进行遮罩，而不是使用玻璃中的图形对象。至少选择一种方法。两者都做会杀死你，性能明智。

# java - java 错误操作数和标识符的使用

> ID：13059249
> 
> 赞同：0
> 
> 时间：2012-10-24T23:10:48.667
> 
> 标签：java, syntax, identifier

使用 MyProgrammingLab 练习编程并得到以下编译错误：ApartmentBuilding.java:4: error: expected

它还给了我以下提示： • 您应该使用：isLuxuryBuilding • 您确定要使用：“ • 您确定要使用：>=

这是要求：假设存在一个建筑类。定义一个子类 ApartmentBuilding，它包含以下实例变量：整数、numFloors、整数、unitsPerFloor、布尔值、hasElevator、布尔值、hasCentralAir 和字符串，managementCompany 包含管理建筑物的房地产公司的名称。有一个包含用于初始化上述变量的参数的构造函数（与上面出现的顺序相同）。还有两种方法：第一种，getTotalUnits，不接受参数，返回建筑单元总数；第二，isLuxuryBuilding 不接受任何参数，如果建筑物有中央空调、电梯和每层 2 个或更少的单元，则返回 true。

我的 SC：

```
public class ApartmentBuilding extends Building {
private int numFloors, unitsPerFloor;
private boolean hasElevator, hasCentralAir;
private String "managingCompany";

public ApartmentBuilding(int numFloors, int unitsPerFloor, boolean hasElevator, boolean hasCentralAir, String "managingCompany") {
this.numFloors       = numFloors;
this.unitsPerFloor   = unitsPerFloor;
this.hasElevator     = hasElevator;
this.hasCentralAir   = hasCentralAir;
this.managingCompany = managingCompany;
}

public int getTotalUnits() {return unitsPerFloor * numFloors;}
public boolean isLuxuyBuilding() {if(unitsPerFloor <= 2 && hasElevator >= 2 && hasCentralAir >= 2) {return true;}
else {System.err.println(managingCompany + " is not luxury");}}} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:13:14.350

您不能在变量名中使用引号

改变

```
private String "managingCompany"; 
```

到

```
private String managingCompany; 
```

也不能与此语句中的数字整数进行比较`hasElevator`：`boolean`

```
if (unitsPerFloor <= 2 && hasElevator >= 2 && hasCentralAir >= 2) { 
```

该方法`isLuxuyBuilding`必须返回一个`boolean`. 该`else`语句没有任何返回值。

你可以做：

```
public boolean isLuxuyBuilding() {
   if (unitsPerFloor <= 2 && hasElevator && hasCentralAir) {
      return true;
    } else {
      return false;
    }
} 
```

请参阅：[变量](http://docs.oracle.com/javase/tutorial/java/nutsandbolts/variables.html)

# java - 有没有更简单的方法可以将java中的字符值转换为int？

> ID：13059250
> 
> 赞同：0
> 
> 时间：2012-10-24T23:11:07.020
> 
> 标签：java

如果输入是字符串“783”并且我不断通过 input.charAt(i) 从字符串中获取字符，那么获得等效整数的唯一方法是什么`Character.digit(input.charAt(i),10)`？

有没有更简单的表达方式？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:18:55.047

这是最安全的方法，但您也可以简单地从字符值中减去 48，因为 0-9 在 unicode 十进制值中是 48-57。

```
int c = input.charAt(i) - 48; 
```

但是，如果字符不是数字（例如`'A' - 48`is `17`），这当然会返回不切实际的结果。

# iphone - 如何最好地将 JSON 解析为 CoreData？

> ID：13059251
> 
> 赞同：0
> 
> 时间：2012-10-24T23:11:10.137
> 
> 标签：iphone, json, core-data, iphonecoredatarecipes

我无法解决以下问题：如何最好地将 JSON 解析为 CoreData？

我已经知道如何解析 JSON 并对其进行反序列化，但是如何将结果输入 CoreData？

目前我有一个`LoginViewController`将`NSURLRequest`用户名和密码发送到网络服务器并接收回声，这是一个 JSON 文件。

我已经用 CoreDataStack设置了`AppDelegate.h`&`AppDelegate.m`

我的问题：如何将 NSDictionary (JSON-result) 从`LoginViewController`数据库中获取？我必须在应用程序委托中调用方法吗？还是我应该将 CoreDataStack 放入`LoginViewController`？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-25T09:20:41.827

Alex，尝试使用[Restkit](http://restkit.org/)，它在将 JSON 响应直接持久化到 Core Data 方面非常有效
使用 URL 请求获取 JSON，它将整个响应映射到 Core Data。您甚至可以在持久化之前修改有效负载。
借助广泛使用的[AFNetworking](https://github.com/AFNetworking/AFNetworking)
在内部处理通信 需要进行一些初始配置，但结果值得付出努力！

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T00:03:51.463

听起来您真正想要的是如何从解析 JSON 的代码中获取对核心数据堆栈的引用。如果是这种情况，快速而肮脏的方法就是向应用程序委托索取它。这很简单

```
NSManagedObjectContext *context = [[[UIApplication sharedApplication] delegate] managedObjectContext]; 
```

您可能需要对调用`#import "AppDelegate.h"`结果进行类型转换`delegate`以使编译器方便使用。

在您的登录视图控制器中设置 Core Data 堆栈几乎肯定是个坏主意——除非那是您唯一使用它的地方（我打赌不是这种情况）。不过，将其设置在应用程序委托以外的其他地方通常是一个好主意。例如，一个新类负责管理堆栈并实现您发现需要的任何通用核心数据相关方法。

如果将数据从您`NSDictionary`的托管对象中获取确实是问题所在，那么我去年在[Cocoa is my Girlfriend](http://www.cimgf.com/2011/06/02/saving-json-to-core-data/)上写过这个问题，这个建议仍然有效。

# javascript - 在函数外的函数内访问函数中的变量？

> ID：13059254
> 
> 赞同：1
> 
> 时间：2012-10-24T23:11:18.330
> 
> 标签：javascript

我有以下代码将我的 iOS 设备注册到我的 APNS 服务器：

```
pushNotification.registerDevice({
    alert: true,
    badge: true,
    sound: true,
    pw_appid: "***",
    appname: "***"
},

function (status) {
    var deviceToken = status['deviceToken'];
},

function (status) {
    console.warn('failed to register : ' + JSON.stringify(status));
    navigator.notification.alert(JSON.stringify(['failed to register ', status]));
}); 
```

这运行`onLoad`，但我需要访问`deviceToken`的范围之外`pushNotification.registerDevice() function (status)`。

在这种情况下，是否有可能访问`deviceToken`函数内部的函数内部，函数外部的函数？

我想我可以通过使用将其设为全局变量，`window.deviceToken`然后稍后调用它，但它返回未定义。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:13:57.720

您可以提供`deviceToken`更广泛的范围：

```
var deviceToken;

pushNotification.registerDevice({
    alert: true,
    badge: true,
    sound: true,
    pw_appid: "***",
    appname: "***"
},

function(status) {
    deviceToken = status['deviceToken'];
},

function(status) {
    console.warn('failed to register : ' + JSON.stringify(status));
    navigator.notification.alert(JSON.stringify(['failed to register ', status]));
});​ 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:13:07.097

更改它以创建`deviceToken`一个全局变量，以便通过直接引用全局范围在外部范围内可用。

```
function (status) {
    window.deviceToken = status['deviceToken'];
}, 
```

如果您只希望它在父范围内，不一定在全局范围内，您可以在所需的父范围内定义它，然后不在您的函数中重新声明它：

```
var deviceToken;

pushNotification.registerDevice({
    alert: true,
    badge: true,
    sound: true,
    pw_appid: "***",
    appname: "***"
},

function (status) {
    deviceToken = status['deviceToken'];
},

function (status) {
    console.warn('failed to register : ' + JSON.stringify(status));
    navigator.notification.alert(JSON.stringify(['failed to register ', status]));
}); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-24T23:22:23.333

如果您将令牌分配给全局并在尝试使用它时发现它未定义，您可能会发现它，因为 registerDevice ajax 尚未收到响应。

尝试将你的回调分离成一个单独的函数，并从那里启动任何依赖函数。

```
function registerSuccess(status) {
  // Store token globally
  token = status["deviceToken"];
  // or pass as an argument
  // call functions that depend on the token
  Foo(token);
  Bar(); // uses global
} 
```

就个人而言，我会尝试将其作为参数传递，以免污染全局命名空间。

# ios - 重构 iOS ViewController 无需 nib 即可工作

> ID：13059260
> 
> 赞同：0
> 
> 时间：2012-10-24T23:11:33.893
> 
> 标签：ios, uiviewcontroller

我写了一个很好的画廊视图控制器 .h .m 和 .xib 可以很好地满足我的目的。在现有的 uinavigationcontroller 中点击以编程方式创建的按钮并加载图像、播放电影或查看 pdf 或网站。我想更改它，以便可以在代码中添加 xib 的内容 - 而不使用 nib 文件。这样它会更有用（我认为）。

问题是 .m 中引用的函数，例如 - [self presentMoviePlayerViewControllerAnimated:YES] 等不起作用。我尝试在这个新的 .h 和 .m 中创建 rootviewcontroller 的属性，并将 self 替换为 myController （属性名称）。但是我的视图控制器代码依赖于现有的 uinavigation 来推送新内容或类似的东西。如何删除/调整这些对 self 的引用或对 uinavigationcontrollers 的依赖，以便它像具有 nib 视图控制器时一样工作？

编辑：下面添加的代码。在 nib 中只有一个名为 uis_thumbScrollView 的 uiscrollview。我想通过简单地调用类似的东西来添加它：

```
[self.view addSubview:[[ebThumbScroller alloc] initWithFrame:CGRectMake(0, 0, 1024, 733)]]; 
```

每个人的评论都提醒我，这将被放入的 uiview 存在于 rootviewcontroller 中，在顶部。也许这就是为什么我可以听到电影播放 - 但看不到它。

注意：代码在 uiscrollview 中创建了一系列带有按钮的 uiview。.h #import #import "ebAppDelegate.h" #import "MediaPlayer/MediaPlayer.h"

```
@interface HomeGalleryViewController : UIViewController <UIScrollViewDelegate, UIGestureRecognizerDelegate, UIDocumentInteractionControllerDelegate> {

    BOOL pageControlBeingUsed;
    int buttonCount;

    CGFloat         _minimumColumnGap;
    UIEdgeInsets    _contentInsets;
    NSInteger       _colCount;
    NSInteger       _rowCount;
    CGFloat         _rowGap;
    CGFloat         _colGap;
    UIEdgeInsets    _effectiveInsets;
    //int iGalleryThumbs;
    //int iPlanThumbs;
    int iTotalButtons;
    ebAppDelegate *ebappdelegate;
    ebGalleryItem *ebgalleryItem;
    NSDictionary *gallDict;
    NSArray *gallerySections;
    NSArray *galleryArray;
    NSMutableArray *nsm_gallArray;
    UIDocumentInteractionController *controller;
}

//@property (nonatomic, retain) IBOutlet UIButton *bItem;
@property (nonatomic, retain) NSString *galleryNameString;
@property (nonatomic, retain) IBOutlet UIScrollView* scrollView;
@property (retain, nonatomic) NSMutableArray *arr_Views;
@property (strong, nonatomic) IBOutlet UIScrollView* uis_thumbScrollView;
@property (strong, nonatomic) IBOutlet UIPageControl* uis_pageControl;
@property (strong, nonatomic) IBOutlet UIView *uiv_thumbView;
@property (strong, nonatomic) MPMoviePlayerController *player;
@property (strong, nonatomic) MPMoviePlayerViewController *playerViewController;

- (IBAction)changePage;
- (IBAction) clickOpen:(id)sender;
- (void)playMovie:(NSString*)movieName;
- (void)movieFinishedCallback:(NSNotification*)_notification;

@end 
```

.m

```
#import "HomeGalleryViewController.h"
#import "ebAppDelegate.h"
#import "GalleryImagesViewController.h"
#import "Gallery.h"
#import "GalleryThumbnailsViewController.h"
#import "GalleriesListViewController.h"
#import <QuartzCore/CoreAnimation.h>
#import "ebGalleryItem.h"
#import "WebViewController.h"

@implementation HomeGalleryViewController
// buttons
#define hGutter 17
#define vGutter 13
#define btnSize 130
#define topSpace 50
#define leftMargin 100

@synthesize uiv_thumbView;

@synthesize uiv_gallCat0, uiv_gallCat1, uiv_gallCat2,uiv_gallCat3, uiv_gallCat4, uiv_gallCat5,uiv_gallCat6;
@synthesize uis_thumbScrollView, uis_pageControl;

@synthesize galleryNameString,scrollView,arr_Views;
@synthesize player, playerViewController;

// Implement viewDidLoad to do additional setup after loading the view, typically from a nib.
- (void)viewDidLoad {

    [super viewDidLoad];    

    ebappdelegate = (ebAppDelegate *)[[UIApplication sharedApplication] delegate];
    arr_Views = [[NSMutableArray alloc] init];

    self.scrollView.contentSize = CGSizeMake(1024, 1005);

    // nsarray of dictionaries (galleries)
    gallerySections = ebappdelegate.arr_galleryData;
    NSLog(@"gallerySections count:%i",[gallerySections count]);
    nsm_gallArray = [NSMutableArray arrayWithCapacity:1];

    [self layoutGalleryThumbs];
}

#pragma mark 
#pragma mark Layout Gallery Thumbs

-(void)layoutGalleryThumbs {

    NSUInteger numGallSections = [gallerySections count];
    NSLog(@"gallerySections data:%@",gallerySections);
    NSLog(@"numGallSections count:%i",numGallSections);

    // Window bounds.
    CGRect bounds = CGRectMake(0, 0, 1024, 215);

    for (int i=0; i<numGallSections; i++) {

        // Create a view and add it to the window.
        UIView* vview = [[UIView alloc] initWithFrame: CGRectMake(0, bounds.size.height*i-1, bounds.size.width, bounds.size.height)];
        [vview setBackgroundColor: [UIColor whiteColor]];
        [vview setTag:i];
        //vview.backgroundColor = (UIColor (i % 2 == 0 ? cyanColor : whiteColor];
        vview.backgroundColor =  (i % 2 == 0)? [UIColor lightGrayColor] : [UIColor whiteColor];

        [arr_Views addObject:vview];

        // add line below at bottom
        UIView* lineView = [[UIView alloc] initWithFrame: CGRectMake(280, bounds.size.height, 700, 2)];
        [lineView setBackgroundColor: [UIColor grayColor]];
        lineView.alpha = 0.5;
        [vview addSubview:lineView];

        [uis_thumbScrollView addSubview: vview];

        NSLog(@"start===============i:%i",i);

        // grab a gallery
        gallDict = [gallerySections objectAtIndex:i];       // grab dict
        galleryArray = [gallDict objectForKey:@"gallSectionData"]; // grab array from dict
        NSLog(@"galleryArray:%@",[galleryArray description]);
        NSString *secTitle = [gallDict objectForKey:@"gallSectionName"];

        iTotalButtons = [galleryArray count];
        NSLog(@"iTotalButtons count:%i",iTotalButtons);

        _minimumColumnGap = 5;

        _colCount = floorf((uis_thumbScrollView.bounds.size.width - _contentInsets.left - _contentInsets.right) / btnSize);

        while (1) {
            _colGap = (uis_thumbScrollView.bounds.size.width - _contentInsets.left - _contentInsets.right - btnSize * _colCount) / (_colCount + 1);
            if (_colGap >= _minimumColumnGap)
                break;
            --_colCount;
        };

        _rowCount = (iTotalButtons + _colCount - 1) / _colCount;
        _rowGap = _colGap;

        _effectiveInsets = UIEdgeInsetsMake(_contentInsets.top + _rowGap,
                                            _contentInsets.left + _colGap,
                                            _contentInsets.bottom + _rowGap,
                                            _contentInsets.right + _colGap);

        NSLog(@"row count:%i",_rowCount);
        NSLog(@"col count:%i",_colCount);

        buttonCount=0;

        for (int e=0; e<iTotalButtons; e++) {
            NSLog(@"e:%i",e);

            ebgalleryItem = [galleryArray objectAtIndex:e];
            UIImage *thumbImg = [UIImage imageNamed:ebgalleryItem.gallThumb];

            UIButton *button = [UIButton buttonWithType: UIButtonTypeCustom];

            CGRect frame = CGRectMake (btnSize*e+leftMargin, topSpace,
                                       btnSize-hGutter, btnSize-vGutter );
            [button setFrame: frame];
            NSLog(@"added button");

            //[button setBackgroundImage:thumbImg forState:UIControlStateNormal];
            [button setImage:thumbImg forState:UIControlStateNormal];
            [button setTitle:ebgalleryItem.gallName forState:UIControlStateNormal];
            NSLog(@"%@",button.titleLabel.text);

            [button addTarget: NULL action:@selector(clickOpen:) forControlEvents:UIControlEventTouchUpInside];
            UILongPressGestureRecognizer *tapAndHold = [[UILongPressGestureRecognizer alloc] initWithTarget:self action:@selector(longclickOpen:)];
            [tapAndHold setMinimumPressDuration:0.33];
            [button addGestureRecognizer:tapAndHold];
            [button setTag:e];
            //[button setTag:i*_colCount+e];

            NSLog(@" button tag=%i", button.tag);

            button.alpha=1.0;
            [[arr_Views objectAtIndex:i] addSubview:button];
            NSLog(@"middle====i:%i",i);

            // caption label
            CGRect labelFrame = CGRectMake( btnSize*e+leftMargin, 125,
                                           btnSize-hGutter, btnSize-vGutter );
            UILabel* label = [[UILabel alloc] initWithFrame: labelFrame];
            [label setFont:[UIFont fontWithName:@"Arial" size:14]];
            label.numberOfLines = 0;
            [label setText:ebgalleryItem.gallCaption];
            [label setTextColor: [UIColor blackColor]];
            [label setTextAlignment:UITextAlignmentCenter];
            [label setBackgroundColor:[UIColor clearColor]];
            [[arr_Views objectAtIndex:i] addSubview: label];
            NSLog(@"middle2====i:%i",i);

            buttonCount++;
        }

        // Section Title label
        CGRect titleLabelFrame = CGRectMake(btnSize,0,250,50);
        UILabel* titlelabel = [[UILabel alloc] initWithFrame: titleLabelFrame];
        [titlelabel setFont:[UIFont fontWithName:@"Arial" size:16]];
        [titlelabel setText:secTitle];
        [titlelabel setTextColor: [UIColor blackColor]];
        [titlelabel setTextAlignment:UITextAlignmentLeft];
        [titlelabel setBackgroundColor:[UIColor clearColor]];
        [[arr_Views objectAtIndex:i] addSubview: titlelabel];
        NSLog(@"end====i:%i",i);

        CGFloat scrollViewHeight = 0.0f;
        for (UIView* view in self.uis_thumbScrollView.subviews)
        {
            if (!view.hidden)
            {
                CGFloat y = view.frame.origin.y;
                CGFloat h = view.frame.size.height;
                if (y + h > scrollViewHeight)
                {
                    scrollViewHeight = h + y;
                }
            }
        }

        [self.uis_thumbScrollView setContentSize:(CGSizeMake(self.uis_thumbScrollView.frame.size.width, scrollViewHeight+74))]; //74 is space from top in IB of scroll
        }
    uiv_thumbView.alpha = 1.0;
}

#pragma mark Scrollview

- (void)scrollViewDidScroll:(UIScrollView *)sender {
    // Update the page when more than 50% of the previous/next page is visible
    CGFloat pageWidth = self.uis_thumbScrollView.frame.size.width;
    int page = floor((self.uis_thumbScrollView.contentOffset.x - pageWidth / 2) / pageWidth) + 1;
    self.uis_pageControl.currentPage = page;

    // nslogs zoomsacle/bounds
    CGRect visibleRect;
    visibleRect.origin = uis_thumbScrollView.contentOffset;
    visibleRect.size = uis_thumbScrollView.bounds.size;

    float theScale = 1.0 / [uis_thumbScrollView zoomScale];
    visibleRect.origin.x *= theScale;
    visibleRect.origin.y *= theScale;
    visibleRect.size.width *= theScale;
    visibleRect.size.height *= theScale;

    NSLog( @"Visible rect: %@", NSStringFromCGRect(visibleRect) );
}

- (IBAction)changePage {
    // update the scroll view to the appropriate page
    CGRect frame;
    frame.origin.x = self.uis_thumbScrollView.frame.size.width * self.uis_pageControl.currentPage;
    frame.origin.y = 0;
    frame.size = self.uis_thumbScrollView.frame.size;
    [self.uis_thumbScrollView scrollRectToVisible:frame animated:YES];
}

- (void)scrollViewWillBeginDragging:(UIScrollView *)scrollView {
    pageControlBeingUsed = NO;
}

- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView {
    pageControlBeingUsed = NO;
}

//===================================================================
// Override to allow orientations other than the default portrait orientation.
- (BOOL)shouldAutorotateToInterfaceOrientation:(UIInterfaceOrientation)interfaceOrientation {
    return (interfaceOrientation == UIInterfaceOrientationLandscapeLeft | interfaceOrientation == UIInterfaceOrientationLandscapeRight); 
}

- (void)didReceiveMemoryWarning {
    // Releases the view if it doesn't have a superview.
    [super didReceiveMemoryWarning];

    // Release any cached data, images, etc that aren't in use.
}

- (void)viewDidUnload {
    [self setUiv_thumbView:nil];
}

- (void)viewDidDisappear:(BOOL)animated {
}

- (void)viewWillAppear:(BOOL)animated {
    [UIApplication sharedApplication].statusBarHidden = YES;
    self.view.frame = [UIScreen mainScreen].applicationFrame;
    CGRect frame = self.navigationController.navigationBar.frame;
    frame.origin.y = 0;
    self.navigationController.navigationBar.frame = frame;
    [self.navigationController setNavigationBarHidden:YES animated:animated];
    self.navigationController.navigationBar.translucent = YES;
}

- (void)viewWillDisappear:(BOOL)animated {
    [UIApplication sharedApplication].statusBarHidden = NO;
    CGRect frame = self.navigationController.navigationBar.frame;
    frame.origin.y = 20.0;
    self.navigationController.navigationBar.frame = frame;
}

- (void)viewDidAppear:(BOOL)animated {
    [[UIApplication sharedApplication] setStatusBarHidden:YES];
    [self.navigationController setNavigationBarHidden:YES animated:animated];
    [self.navigationController setToolbarHidden:YES animated:YES];
    [super viewDidAppear:animated];
}

//======================================================================    
-(IBAction)clickOpen:(id)sender {

    UIButton *tmpBtn = (UIButton*)sender;
    NSLog(@"sender tag: %i", [sender tag]);

    int superviewTag = [sender superview].tag;  
    NSLog(@"sender superview tag: %i", superviewTag);

    gallDict = [gallerySections objectAtIndex:superviewTag];        // grab dict
    galleryArray = [gallDict objectForKey:@"gallSectionData"];      // grab array from dict

    tmpBtn.alpha = 0.6;

    ebgalleryItem = [galleryArray objectAtIndex:[sender tag]];

    NSLog(@"%@",ebgalleryItem.gallType);
    NSLog(@"%@",ebgalleryItem.gallName);

    NSLog(@"gallDict %@",gallDict);

    if ([ebgalleryItem.gallType isEqualToString:@"movie"]) {

        [self playMovie:ebgalleryItem.gallFilm];

    } else if ([ebgalleryItem.gallType isEqualToString:@"image"]) {

        [self imageViewer:sender];

    } else if ([ebgalleryItem.gallType isEqualToString:@"pdf"]) {

        [self viewPDF:ebgalleryItem.gallName];

    }  else if ([ebgalleryItem.gallType isEqualToString:@"web"]) {

        [self openWeb:ebgalleryItem.gallName];
    }
}

#pragma mark 
#pragma mark Open Websites 

- (IBAction)openWeb:(NSString*)thisWEB {

    WebViewController *webViewController = [[WebViewController alloc] 
                                            initWithNibName:@"WebViewController" 
                                            bundle:nil];
    [webViewController socialButton:thisWEB];
    webViewController.title = thisWEB;
    [self presentModalViewController:webViewController animated:YES];
}

#pragma mark 
#pragma mark Image Viewer

-(void)imageViewer:(id)sender {

    UIButton *tmpBtn = (UIButton*)sender;

    galleryNameString = tmpBtn.titleLabel.text;
    tmpBtn.alpha = 0.6;

    GalleryImagesViewController *vc = [[GalleryImagesViewController alloc] initWithGallery:[Gallery galleryNamed:galleryNameString]];
    [vc goToPageAtIndex:0 animated:NO];

    CATransition* transition = [CATransition animation];
    transition.duration = 0.33;
    transition.type = kCATransitionFade;
    transition.subtype = kCATransitionFromTop;

    [self.navigationController.view.layer
     addAnimation:transition forKey:kCATransition];
    [self.navigationController pushViewController:vc animated:NO];
}

#pragma mark 
#pragma mark PDF Viewer

-(void)viewPDF:(NSString*)thisPDF {
    NSString *fileToOpen = [[NSBundle mainBundle] pathForResource:thisPDF ofType:@"pdf"];
    NSURL *url = [NSURL fileURLWithPath:fileToOpen];

    NSLog(@"%@",fileToOpen);
    controller = [UIDocumentInteractionController interactionControllerWithURL:url];
    [self previewDocumentWithURL:url];
}

- (IBAction) clickClose:(id)sender {
    [self dismissModalViewControllerAnimated:YES];
}

- (void)previewDocumentWithURL:(NSURL*)url
{
    UIDocumentInteractionController* preview = [UIDocumentInteractionController interactionControllerWithURL:url];
    preview.delegate = self;
    [preview presentPreviewAnimated:YES];
}

//======================================================================    
- (void)documentInteractionControllerDidDismissOptionsMenu:(UIDocumentInteractionController *)controller{
}

//===================================================================
- (UIViewController *)documentInteractionControllerViewControllerForPreview:(UIDocumentInteractionController *)controller
{
    return self;
}

- (UIView *)documentInteractionControllerViewForPreview:(UIDocumentInteractionController *)controller
{
    return self.view;
}

- (CGRect)documentInteractionControllerRectForPreview:(UIDocumentInteractionController *)controller
{
    return self.view.frame;
}

-(IBAction)longclickOpen:(UILongPressGestureRecognizer*)gesture {

    if (gesture.state == UIGestureRecognizerStateBegan ) {

        [self.navigationController setNavigationBarHidden:NO];

        ebAppDelegate *appDelegate = (ebAppDelegate *)[[UIApplication sharedApplication] delegate];
        appDelegate.isFromLongPress=YES;

        //NSUInteger i = [gesture.view tag];

        //galleryNameString = [appDelegate.arr_galleryData objectAtIndex:i];

        NSLog(@"load %@",galleryNameString);

        UIButton *btn = (UIButton*)gesture.view;

        galleryNameString = btn.titleLabel.text;        btn.alpha = 0.6;

        //NSLog(@"Long Press");
        //NSLog(@"llongclickOpen");
        UIViewController *vc = [[GalleryThumbnailsViewController alloc] initWithGallery:[Gallery galleryNamed:galleryNameString]];
        CATransition* transition = [CATransition animation];
        transition.duration = 0.33;
        transition.type = kCATransitionFade;
        transition.subtype = kCATransitionFromTop;

        [self.navigationController.view.layer
         addAnimation:transition forKey:kCATransition];
        [self.navigationController pushViewController:vc animated:NO];
    }
}

-(void)playMovie:(NSString*)movieName {

    NSString *url = [[NSBundle mainBundle] 
                     pathForResource:movieName
                     ofType:@"m4v"];

    NSLog(@"%@",movieName);

    playerViewController = [[MPMoviePlayerViewController alloc] 
                                                         initWithContentURL:[NSURL fileURLWithPath:url]];

    [[NSNotificationCenter defaultCenter] removeObserver:playerViewController
                                                    name:MPMoviePlayerPlaybackDidFinishNotification
                                                  object:playerViewController.moviePlayer];

    // Register this class as an observer instead
    [[NSNotificationCenter defaultCenter] addObserver:self
                                             selector:@selector(movieFinishedCallback:)
                                                 name:MPMoviePlayerPlaybackDidFinishNotification
                                               object:playerViewController.moviePlayer];

    [self.view insertSubview:playerViewController.view atIndex:50];

    //---play movie---
    player = [playerViewController moviePlayer];
    player.controlStyle = MPMovieControlStyleFullscreen;
    player.repeatMode=MPMovieRepeatModeOne;

    [self presentMoviePlayerViewControllerAnimated:playerViewController];
    [[UIApplication sharedApplication] setStatusBarHidden:YES];

    [super viewDidLoad];
}

- (void)movieFinishedCallback:(NSNotification*)aNotification {
    // Obtain the reason why the movie playback finished
    NSNumber *finishReason = [[aNotification userInfo] objectForKey:MPMoviePlayerPlaybackDidFinishReasonUserInfoKey];

    // Dismiss the view controller ONLY when the reason is not "playback ended"
    if ([finishReason intValue] != MPMovieFinishReasonPlaybackEnded)
    {
        MPMoviePlayerController *moviePlayer = [aNotification object];

        // Remove this class from the observers
        [[NSNotificationCenter defaultCenter] removeObserver:self
                                                        name:MPMoviePlayerPlaybackDidFinishNotification
                                                      object:moviePlayer];
        // Dismiss the view controller
        [self dismissModalViewControllerAnimated:YES];
    }
}

@end 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:31:15.483

如果您唯一的问题是 [self presentMoviePlayerViewControllerAnimated:YES] 方法不起作用，那么问题是`presentMoviePlayerViewControllerAnimated:`需要实际的 moviePlayerViewController 作为参数而不是布尔值。（假设你指的是 UIViewController 类别的这个方法）[UIViewController MediaPlayer Additions Reference](http://developer.apple.com/library/ios/#documentation/mediaplayer/reference/UIViewController_MediaPlayer_Additions/Reference/Reference.html)

因此，如果您将其替换为 say `presentMoviePlayerViewControllerAnimated:self.moviePlayerVC`，它应该可以按预期工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:26:17.843

我不确定我是否理解您的问题，但是如果您需要将控制器包装到某个 UINavigationController 中，您可以这样做：

```
UINavigationController *navController = [[UINavigationController alloc] initWithRootViewController:myController];
    navController.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    navController.navigationBar.barStyle = UIBarStyleBlack;
    [self presentViewController:navController animated:YES completion:^{
        //
    }]; 
```

稍后任何子控制器都将具有导航层次结构。

# java - Java Map，其中值是与键相同类型的值的列表

> ID：13059264
> 
> 赞同：3
> 
> 时间：2012-10-24T23:11:53.350
> 
> 标签：java, generics, collections

我想要的是这样的：

```
public abstract Class Content {
    private Map<Class<? extends Content>, List<? extends Content>> relations;
} 
```

内容有一堆子类 - A、B、C、D 等......

最常见的用例是获得所有 A：

```
public List<A> getA() {
    return (List<A>)relations.get(A.class);
} 
```

还可以——除了丑陋的演员阵容。

但真正的问题是没有什么能阻止我做一些愚蠢的事情，比如：

```
relations.put(A.class, List<B> myListOfBs); 
```

所以调用上面的 getA() 会导致一个可怕的强制转换异常。有什么方法可以编写它，以便编译器在上面的示例中警告我 - 并消除对丑陋演员的需要。

谢谢

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:22:03.193

您可以围绕 a 创建一个包装器`Map`并使用通用方法来约束您的 put 方法：

```
 public class HeterogeneousContainer {
     private final Map<Class<? extends Content>, List<? extends Content>> map;

     public <T extends Content> void put(Class<T> type, List<T> values) {
         map.put(type, values);
     }

     public <T extends Content> List<T> get(Class<T> type) {
         //this warning can be safely suppressed after inspection
         return (List<T>) map.get(type); 
     }
 } 
```

现在您知道，只要容器的用户没有不当使用它（即原始形式），那么键和值必须对应……您不能调用`put(B.class, listOfAs);`.

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:55:42.503

创建一个将类型固定为*相同*`Map`类型的自定义接口：

 *```
interface RelatedMap<T> extends Map<Class<T>, List<T>> {} 
```

然后

```
private RelatedMap<? extends Content> relations; 
```*

# web-services - 我可以使用地理编码网络服务创建另一个网络服务来提供一些免费信息吗？

> ID：13059266
> 
> 赞同：0
> 
> 时间：2012-10-24T23:12:10.697
> 
> 标签：web-services, google-maps, zipcode, postal-code

我开发了一个网络服务，它使用 Google Maps API 网络服务来获取巴西邮政编码的完整地址。

我创建此服务是为了让开发人员免费获得仅基于邮政编码的完整地址。那是因为政府不提供这种服务，邮政公司也不提供。邮政公司实际上会向需要此信息的人收费，并且您实际上必须在 MS Access 中下载一个数据库，如果您想获得最新信息，您将来必须再次下载该数据库，甚至没有收费的在线解决方案。

因此，我只想根据谷歌地图信息在线创建这个免费服务，所以我没有从邮政公司窃取数据。

我的问题是：Google Maps API 条款和条件是否允许这样做？我读了它，但我找不到这种情况。

# macos - 未找到 libiconv.2.dylib

> ID：13059273
> 
> 赞同：0
> 
> 时间：2012-10-24T23:13:16.157
> 
> 标签：macos, macports

当我使用 gcc make 时，我的 Mac OS Lion 上出现此错误：

```
dyld: Symbol not found: _iconv
  Referenced from: /usr/lib/libcups.2.dylib
  Expected in: /opt/local/lib/libiconv.2.dylib
 in /usr/lib/libcups.2.dylib
dyld: Symbol not found: _iconv
  Referenced from: /usr/lib/libcups.2.dylib
  Expected in: /opt/local/lib/libiconv.2.dylib
 in /usr/lib/libcups.2.dylib
./configure.sh: line 364: 18386 Trace/BPT trap: 5       $QTDIR/bin/qmake "$SRCDIR/$product.pro"
qmake failed 
```

注意：我在我的机器上安装了 Macports。这以前可以工作，这是 MacPorts 的已知问题吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T02:55:05.473

您可以通过选择您的目标、转到“构建阶段”选项卡并将其添加到链接库和框架构建阶段来使用内置的 libiconv。

作为一般规则，如果您缺少链接器符号，您可以在项目中查找符号并查看它们来自哪个标头，然后您通常可以找出适当的库或框架。

在这种情况下，它会告诉您它所期望的库...

您将希望将内置版本用于动态库，因为使用默认链接器标志，如果将此构建产品移动到另一台计算机，它将尝试在运行时在该位置解析符号并崩溃。

# window - window.onload 在 AngularJS 中不起作用

> ID：13059284
> 
> 赞同：15
> 
> 时间：2012-10-24T23:14:07.390
> 
> 标签：window, angularjs, onload

简单 HTML 文件中的此代码有效：

```
<script>
  function load() {
    alert("load event detected!");
  }
  window.onload = load;
</script> 
```

但是，如果我将它放入 AngularJS 网络应用程序的 index.html 文件中，它不会。有谁知道为什么不？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2014-12-14T23:50:59.233

调用你的函数`ng-init`

```
var app = angular.module('app',[]);
app.controller('myController', function($scope){
    $scope.load = function () {
        alert("load event detected!");
    }
});
```

```
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.2.23/angular.min.js"></script>
<div ng-app='app'>
  <div ng-controller='myController' ng-init='load()'></div>
</div>
```

* * *

## 回答 #2

> 赞同：9
> 
> 时间：2015-08-07T08:28:46.517

我更喜欢将这种代码放在 angular 的 app.run() 函数中。

例如

```
angular
.module('testApp', ['someModule'])
.constant('aConstant', 'hi')
.config(function($rootProvider) {/*some routing here*/})
.run(['$window', function($window) {
  $window.onload = function() {/*do your thing*/};
}]); 
```

[还可以查看这篇描述AngularJS app.run() 文档](https://stackoverflow.com/questions/20663076/angularjs-app-run-documentation)中某些事情发生的顺序的好帖子 吗？

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-28T19:03:33.917

以下应该有效：

> jQuery(function(){ /** 我的窗口加载函数 **/ })

因为 Angular 无论如何都使用 jquery 的一个子集，所以你也可以包含真实的东西。

**更好的是：**
您可以考虑使用初始化事物的角度方式，而不是使用它：

那将是：[http ://docs.angularjs.org/api/ng.directive:ngInit](http://docs.angularjs.org/api/ng.directive%3angInit)

> <任何 ng-init="functionInController(something)"...

使其在初始化之前不可见：http://docs.angularjs.org/api/ng.directive: [ngCloak](http://docs.angularjs.org/api/ng.directive%3angCloak)

> < 任何 ng-cloak .....

初始化/自定义整个部分：[http ://docs.angularjs.org/guide/directive](http://docs.angularjs.org/guide/directive)

> <任何指令名称....

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2013-09-12T08:55:52.193

尝试

```
angular.element($window).bind('load', function() {
}); 
```

# c# - 使用 ASP.NET MVC3 绑定 jQuery UI 的附加数据值

> ID：13059288
> 
> 赞同：2
> 
> 时间：2012-10-24T23:14:54.227
> 
> 标签：c#, asp.net-mvc-3, jquery-ui, model-binding

在搜寻了互联网络以寻求答案后，我已经干了。

我使用以下功能的目的是能够使用包含文本视觉辅助但支持值的值填充自动完成文本框。当我在表单中发布到我的 MVC 控制器时，我需要将它们绑定到一个复杂的对象。

除了使用大量隐藏字段之外，还有其他方法可以实现我的需要吗？

```
 $("#addressString")
                .autocomplete({
                    source: function (request, response) {
                        $.ajax({
                            url: '/Send/Send/GetAddressBook',
                            type: "POST",
                            dataType: "json",
                            data: { query: extractLast(request.term), groupName: $('#SelectGroupName').val() },
                            term: extractLast(request.term),
                            success: function (data) {
                                response($.map(data, function (item) {
                                    return {
                                        label: item.label,
                                        value: item.label,
                                        id: item.id,
                                        type: item.type
                                    };
                                }));
                            }
                        });
                    },
                    search: function () {
                        var term = extractLast(this.value);
                        if (term.length < 1) {
                            return false;
                        }
                        return true;
                    },
                    focus: function () {
                        return false;
                    },
                    select: function (event, ui) {
                        var terms = split(this.value);
                        terms.pop();
                        terms.push(ui.item.value);
                        terms.push("");
                        this.value = terms.join("; ");
                        return false;
                    }
                });
        }); 
```

# visual-studio-2010 - 无法实例化抽象类我认为我搞砸了我的构造函数 C++

> ID：13059290
> 
> 赞同：2
> 
> 时间：2012-10-24T23:15:17.513
> 
> 标签：visual-studio-2010, visual-c++

所以我是 C++ 的初学者，我正在使用一个名为 VBot 的抽象类，我在其中继承到其他机器人类。现在我知道我需要覆盖 VBot 类中的纯虚拟代码，所以我认为这不是问题所在。我认为因为我对 C++ 缺乏经验，所以我在构造函数上做错了一些事情，因为我不断得到无法实例化抽象类。这是 VBot.h 文件

```
class VBot
{
public:

    VBot( int startX, int startY, Panel ^ drawingPanel ) : 
      x(startX), y(startY), panel(drawingPanel), energy(100), image(NULL) { };

virtual ~VBot() { };

virtual void Move() = 0;

virtual int EnergyToFightWith() = 0;

bool IsDead() const { return energy <= 0; }

virtual void Show();

bool CollidedWith ( VBot * b ) const;

void DoBattleWith ( VBot * b );

protected:
     int x, y;                           // Current position of the VBot
     gcroot<Drawing::Bitmap ^> image;    // Image displayed for the VBot
     gcroot<Panel ^> panel;              // Panel on which to show the VBot.
     int energy                          // Current energy of the VBot

};
class CNNBot : public VBot
{
public:
CNNBot( int startX, int startY, Panel ^ drawingPanel ){
    VBot::VBot(startX,startY,drawingPanel);
    image = gcnew Drawing::Bitmap("HappyBot.bmp");}
~CNNBot(){};

void Move();

int EnergyToFightWith();
bool IsDead() { return (VBot::IsDead()); }
virtual void Show() { VBot::Show();}
bool CollidedWith ( VBot * b ) { return VBot::CollidedWith(b);}
void DoBattleWith ( VBot * b ){ VBot::DoBattleWith(b);}

private:
static const int MOVE_VAL = 55;
static const int RIGHT_BOUND = 490;
static const int DOWN = 40;
static const int MAXY = 379;
bool switcher;

}; 
```

这将是 VBot.cpp

```
#include "stdafx.h"     

#include "Vbot.h"

void VBot::Show()
{ 
  Graphics ^ g = panel->CreateGraphics();
  g->DrawImageUnscaled( image, x, y );
  g->~Graphics();
}

bool VBot::CollidedWith ( VBot * b ) const
{
if (  b == NULL )
  return false;

return   ( x + image->Width ) >= b->x
     && ( b->x + b->image->Width ) >= x
     && ( y + image->Height ) >= b->y
     && ( b->y + b->image->Height ) >= y;

}

void VBot::DoBattleWith ( VBot * b )
{
   int mine = EnergyToFightWith();
   int yours = b->EnergyToFightWith();
   if( mine == yours )
{
   energy = energy - mine / 2;
   b->energy = b->energy - yours / 2;
}
else if ( mine > yours )
{
   if ( b->energy > 1 )
   {
      b->energy = b->energy - yours;
      energy = energy + yours / 2;
   }
   else
   {
      b->energy = b->energy - 1;
      energy = energy + 1;
   }
}
else
{
    if ( energy > 1 )
    {
       energy = energy - mine;
       b->energy = b->energy + mine / 2;
    }
    else
    {
       b->energy = b->energy + 1;
       energy = energy - 1;
    }
  }
}
int CNNBot::EnergyToFightWith()
{
return this->energy;
} 
```

所以错误是无法实例化抽象类，所以我认为它正在尝试构建 VBot 而不是 CNNBot，因为在输出中它给了我 void VBot::Move(void)' : is abstract 和 'int VBot::EnergyToFightWith( void)' : 是抽象的

抱歉，我忘记在此处添加该部分是 Move()

```
 void CNNBot::Move()
{
if (this->switcher)
{
    this->x += MOVE_VAL;
    if( this->x >= RIGHT_BOUND)
    {
        this->x = 0;
        this->y += DOWN;
        if(this->y > MAXY)
        {
            this->switcher = false;
            this->y = MAXY;
        }
    }
}
else
{
    this->x += MOVE_VAL;
    if( this->x >= RIGHT_BOUND)
    {
        this->x = 0;
        this->y -= DOWN;
        if(this->y < 0)
        {
            this->switcher = true;
            this->y = 0;
        }
    }
}
panel->Invalidate();
} 
```

无论你们能提供什么帮助，都会非常感谢这位新手程序员。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:18:55.467

要调用父类的构造函数，您需要将其放入初始化列表中：

```
CNNBot( int startX, int startY, Panel ^ drawingPanel ):
    VBot(startX, startY, drawingPanel)
{
    image = gcnew Drawing::Bitmap("HappyBot.bmp");
} 
```

你有这个，它试图创建然后丢弃一个无名`VBot`对象：

```
CNNBot( int startX, int startY, Panel ^ drawingPanel ){
    VBot::VBot(startX,startY,drawingPanel);
    image = gcnew Drawing::Bitmap("HappyBot.bmp");} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:19:57.450

您没有覆盖 Move() 并且根据定义，具有任何纯虚函数的类是抽象的，不能被实例化。给Move一个身体，你应该很好。

# django - Django 和 Linux，端口转发

> ID：13059291
> 
> 赞同：1
> 
> 时间：2012-10-24T23:15:28.870
> 
> 标签：django, linux, facebook, port

我正在开发我的第一个 Django 应用程序，我已经安装了 allauth 以允许 openid 登录。我正在尝试使用 no-ip dns 来避免动态 ip 的问题，以便在 facebook 上注册我的应用程序并在我的机器上进行测试。但我不知道如何让我的 django 测试服务器在端口 80 上从外部可见。如果我使用 sudo 强制它，它会给我登录到 postgrel 数据库的问题，但如果我不使用 sudo，它说我不能使用该端口（如果 apache 已关闭）。

感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:21:26.790

一种方法是在 apache 中创建虚拟主机，用于`mod_wsgi`与 Django 应用程序对话。

例子：

```
<VirtualHost *:80>
    ServerName xxx.xxx.com
    ServerAdmin webmaster@localhost

    WSGIScriptAlias / /var/www/xxx/apache/xxx.wsgi
    Alias /static/ /var/www/xxx/static/

    DocumentRoot /var/www/xxx
    LogLevel info

    ErrorLog ${APACHE_LOG_DIR}/xxx-error.log
    CustomLog ${APACHE_LOG_DIR}/xxx-access.log combined
</VirtualHost> 
```

xxx.wsgi的内容：

```
import os, sys

apache_configuration = os.path.dirname(__file__)
project = os.path.dirname(apache_configuration)
workspace = os.path.dirname(project)
sys.path.append(workspace)
sys.path.append('/var/www/xxx')

os.environ['DJANGO_SETTINGS_MODULE'] = 'xxx.settings'

import django.core.handlers.wsgi
application = django.core.handlers.wsgi.WSGIHandler() 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:21:28.913

## “重定向”端口 80 到端口 8000

如果不使用 sudo，您将无法绑定到端口 80，它是一个受保护的端口，只有 root 可以绑定到。（就像任何低于 1024 的端口一样）

这是一个简单的 iptables 规则，它将对端口 8000 的请求转发到端口 80，因此您可以“假装”在端口 80 访问您的服务器，同时在端口 8000 服务它。

它仅适用于环回接口（例如，您在自己的计算机上与自己交谈），但这应该是您开发所需要的。

`iptables -t nat -I OUTPUT --source 127.0.0.1 --destination 127.0.0.1 -p tcp --dport 80 -j REDIRECT --to-ports 8000`

如果您需要它，对于外部客户，规则是：

`iptables -t nat -A PREROUTING -i eth0 -p tcp --dport 80 -j REDIRECT --to-port 8000`（根据需要编辑界面）

## 替代解决方案

但是，您可以看看这个问题：[非 root 进程是否可以绑定到 Linux 上的“特权”端口？](https://stackoverflow.com/questions/413807/is-there-a-way-for-non-root-processes-to-bind-to-privileged-ports-1024-on-l)，这表明您的问题的另一种解决方案。

请注意有关解释语言（例如python）的要点。

## 一句警告

这显然仅用于开发目的。要运行您的应用程序，您应该使用 nginx + gunicorn 或 apache + mod_wsgi。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T23:30:53.217

我会使用 nginx 代理通行证。在 Ubuntu 上，您所要做的就是`sudo apt-get install nginx`, 然后`sudo nano /etc/nginx/sites-available/default`. `location /`将块更改为：

```
location / {
    proxy_pass http://localhost:8080; #or whatever port you are using
    proxy_set_header Host $host;
} 
```

并取消注释该`listen 80;`行并将其更改为`listen 127.0.0.1:80`（这将防止您的开发站点意外地在端口 80 上被提供给整个互联网）。`server_name`如果您想对 /etc/hosts 做任何事情，您可能还必须更改以使您的站点认为它在其他地方。

`sudo service nginx start`你会做生意的。注意nginx可能需要开机后手动启动；我不认为默认设置是每次都在启动时启动。

# java - 在大型数据集上使用正则表达式时的空间和时间问题

> ID：13059300
> 
> 赞同：2
> 
> 时间：2012-10-24T23:17:22.053
> 
> 标签：java, regex, large-data-volumes

我有一个大（大于 200K）的字符串数组，用于搜索文档中的模式。在将数组中的每个条目应用于文档之前，我将其转换为正则表达式。当我这样做时，遍历数组并顺序执行搜索所需的时间会急剧增加。我相信这适用于我在执行搜索之前依次应用于每个正则表达式的 Pattern.compile 语句。预编译正则表达式可能是解决这个问题的一种方法，但我注意到当我这样做时内存使用量急剧增加。在预编译之前，Java 应用程序在大小约为 1.5 GB 的 VM 中运行。预编译后，java 程序在大小约为 14 gig 的 VM 中运行。

有没有一些优雅的方法来解决这个问题或让程序更有效地运行？

谢谢，

艾略特

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-12-30T21:59:11.663

我会避免将所有正则表达式都编译在内存中，只需在使用前一一编译，并确保垃圾收集器可以清理使用过的正则表达式。这可以降低峰值内存使用量。

此外，理论上您可以使用捕获组和或运算符 (|) 将许多正则表达式合并到一个正则表达式中，然后单遍扫描文档，最后检查哪个匹配调用[group()](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#group%28int%29)。

这也有利于在编译阶段统一不同正则表达式的相似部分。

这是一个简单的示例，假设您匹配整个文档而不是查找或替换，只是为了说明这个想法：

```
String patternA = "patternA";
String patternB = "patternB";
Pattern compiled = Pattern.compile(String.format("(%s)|(%s)",patternA, patternB))
Matcher matcher = compiled.matcher(input);
if (matcher.matches()) {
  if (matcher.group(1)) {
    // patternA matched
  }
  if (matcher.group(2)) {
    // patternB matched
  }
} 
```

# c - C中分数简化程序的浮点异常

> ID：13059306
> 
> 赞同：1
> 
> 时间：2012-10-24T23:17:38.697
> 
> 标签：c, floating-point

当我运行以下代码时，我总是得到一个浮点异常。我该如何解决？

```
 #include <stdio.h>

    //Global Variables

    int num, denom, num1, denom1;

    void simplify(int *numerator, int *denominator);

    int main () {

    //Prompt User as to what program is
    printf("Fraction Simplifier\n");
    printf("===================\n");

    //Ask User for Numerator and Denominator
    printf("Numerator: ");
    scanf("%d", &num);
    printf("Denominator: ");
    scanf("%d", &denom);

    //Call Function
    simplify(&num1, &denom1);

    //Display final output
    printf("%d / %d = %d / %d", num, denom, num1, denom1);

    return 0;
    }

    //Simplify function
    void simplify(int *numerator, int *denominator)
    {

    num = num1;
    denom = denom1;

    num1 = num1 / num1;
    denom1 = denom1 / num1;
    num1 = *numerator;
    denom1 = *denominator;

    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:21:12.010

看起来好像`num1`从未初始化过。它将为零，这将导致除以零。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:34:55.477

你的`simplify`功能有缺陷。这是您打电话时的含义`simplify`：

> 调用simplify，传递num1和denom1的地址

这就是您在简化中的代码的含义：

```
num = num1;          /* Assign the value of num1 to num, meaning set num to 0\. */
denom = denom1;      /* Assign the value of denom1 to denom, meaning set denom to 0\. */
num1 = num1 / num1;  /* Divide num1 (which is 0) by num1 (which is 0). Error! */ 
```

您可以通过消除全局变量来简化程序并使其更易于理解。这也将帮助您纠正错误。这是一个重写：

```
#include <stdio.h>

void simplify(int numerator, int denominator, int* newNumerator, int* newDenominator);

int main () {

    int num, denom, num1, denom1;

    /* Do your input code */

    //Call Function
    simplify(num, denom, &num1, &denom1);

    //Display final output
    printf("%d / %d = %d / %d", num, denom, num1, denom1);

    return 0;
}

//Simplify function
void simplify(int numerator, int denominator, int* newNumerator, int* newDenominator)
{
    int simplifiedNumerator;
    int simplifiedDenominator;

    /* Calculate your results.. left out your original code, which calculates incorrectly */
    /* You will refer to the ints numerator and denominator */

    /* Assign your results */
    *newNumerator = simplifiedNumerator;
    *newDenominator = simplifiedDenominator;
} 
```

请注意，`simplify`现在有四个参数。前两个是你要在计算中使用的值（我们不需要指针），指针只用于将结果分配给传入的地址。

# postgresql - 在postgresql中计算总和计数的函数

> ID：13059309
> 
> 赞同：1
> 
> 时间：2012-10-24T23:18:03.300
> 
> 标签：postgresql

是否有一个函数可以计算整个月份的总数，如下所示？我不确定postgres是否。我正在寻找总价值。

```
2012-08=# select date_trunc('day', time), count(distinct column) from table_name group by 1 order by 1;

     date_trunc      | count 
---------------------+-------
 2012-08-01 00:00:00 |    22
 2012-08-02 00:00:00 |    34
 2012-08-03 00:00:00 |    25
 2012-08-04 00:00:00 |    30
 2012-08-05 00:00:00 |    27
 2012-08-06 00:00:00 |    31
 2012-08-07 00:00:00 |    23
 2012-08-08 00:00:00 |    28
 2012-08-09 00:00:00 |    28
 2012-08-10 00:00:00 |    28
 2012-08-11 00:00:00 |    24
 2012-08-12 00:00:00 |    36
 2012-08-13 00:00:00 |    28
 2012-08-14 00:00:00 |    23
 2012-08-15 00:00:00 |    23
 2012-08-16 00:00:00 |    30
 2012-08-17 00:00:00 |    20
 2012-08-18 00:00:00 |    30
 2012-08-19 00:00:00 |    20
 2012-08-20 00:00:00 |    24
 2012-08-21 00:00:00 |    20
 2012-08-22 00:00:00 |    17
 2012-08-23 00:00:00 |    23
 2012-08-24 00:00:00 |    25
 2012-08-25 00:00:00 |    35
 2012-08-26 00:00:00 |    18
 2012-08-27 00:00:00 |    16
 2012-08-28 00:00:00 |    11
 2012-08-29 00:00:00 |    22
 2012-08-30 00:00:00 |    26
 2012-08-31 00:00:00 |    17
(31 rows)
--------------------------------
      Total          |    12345 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:24:24.447

尽我所能从您的问题和评论中猜出您想要按月计算不同计数的小计。你不能这样做，`group by date_trunc('month',time)`因为那会在*所有*日子里做一个`count(distinct column)`不同的事情。

 *为此，您需要一个子查询或 CTE：

```
WITH day_counts(day,day_col_count) AS (
  select date_trunc('day', time), count(distinct column)
  from table_name group by 1
)
SELECT 'Day', day, day_col_count
FROM day_counts
UNION ALL
SELECT 'Month', date_trunc('month', day), sum(day_col_count)
FROM day_counts
GROUP BY 2
ORDER BY 2; 
```

* * *

我之前的评论之前的猜测是：按月分组？

```
select date_trunc('month', time), count(distinct column)
from table_name
group by date_trunc('month', time)
order by time 
```

或者您是否尝试包括运行总计或小计行？对于运行总计，您需要`sum`用作窗口函数。小计只是一种痛苦，因为 SQL 并不真正适合它们。您需要`UNION`两个查询，然后将它们包装在一个外部`ORDER BY`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:40:31.803

```
select
    date_trunc('day', time)::text as "date",
    count(distinct column) as count
from table_name
group by 1
union
select
    'Total',
    count(distinct column)
from table_name
group by 1, date_trunc('month', time)
order by "date" = 'Total', 1 
```*

# php - php中的排序/排序问题

> ID：13059312
> 
> 赞同：1
> 
> 时间：2012-10-24T23:18:18.843
> 
> 标签：php

我在使用排序功能时遇到了麻烦。

当我尝试在数组中排序时，订单结果不好。例如：

```
$arr = array("Cero","Uno","dos","Tres","Cuatro","Cinco","Seis","Siete");
sort($arr);
foreach($arr as $key => $value){
    echo $key . "=>" . $value . "<br/>";
} 
```

写 ：

```
0=>Cero
1=>Cinco
2=>Cuatro
3=>Seis
4=>Siete
5=>Tres
6=>Uno
7=>dos //wtf, last item are "d" ?! 
```

如果我尝试使用 rsort 我得到了这个：

```
0=>dos //again, last item are "d" ?!
1=>Uno
2=>Tres
3=>Siete
4=>Seis
5=>Cuatro
6=>Cinco
7=>Cero 
```

我尝试了 asort、arsort、sort 和 rsort，但总是返回错误的顺序。你知道为什么？或修复它的方法？谢谢！

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-24T23:21:15.470

你想传递标志来忽略大小写。

```
sort($arr, SORT_FLAG_CASE); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:29:00.180

根据您的 php 版本，您可以使用 sort() 或 natcasesort()

自 php5.4 发布以来，有一个名为 SORT_FLAG_CASE 的标志，您可以将其与排序功能一起使用

```
sort($array, SORT_FLAG_CASE); 
```

因为不是每个服务器都运行 php 5.4，你至少应该知道在此之前，你使用了 natcasesort 函数

```
natcasesort($array); 
```

有关更多信息，请查看[php.net 手册](http://php.net/manual/en/function.natcasesort.php)

# php - 在mysql插入查询中使用数组

> ID：13059313
> 
> 赞同：0
> 
> 时间：2012-10-24T23:18:51.920
> 
> 标签：php, mysql, multidimensional-array

我有一个 Bash/PHP 脚本，它从名为“assess_2012”的表中检索记录，并将需要写入名为“assess_2012_err”的表中的记录存储在多维数组中：

```
#!/usr/bin/php -q

<?php
$host = "localhost";
$user = "username";
$pass = "password";
$name = "reassess";

$conn = mysqli_connect($host, $user, $pass, $name) OR die ("Could not connect to database: " . mysqli_error($conn) . "\n");

$q = "SELECT su_id, ass_date, ind_d FROM assess_2012";
$r = mysqli_query ($conn, $q);

if ($r) {
    while ($row = mysqli_fetch_array($r, MYSQLI_ASSOC)) {

        // Check for errors:
        if ($row['ind_d'] == 'Y') {
            // Add to the array:
            $sql[] = array('su_id' => $row['su_id'], 'err_code' => 1);
        }
    }
    var_dump($sql);
}
else {
    // SELECT query failed:
    echo "Error: " . mysqli_error($conn) . "\n";
}
?> 
```

'var_dump' 看起来像这样（缩短版本 - 实际查询返回数百条记录）：

```
array(1) {
  [0]=>
  array(2) 
    ["su_id"]=>
    string(1) "5"
    ["err_code"]=>
    int(1)
  }
  [1]=>
  array(2) {
    ["su_id"]=>
    string(4) "1492"
    ["err_code"]=>
    int(1)
  }
} 
```

我不知道如何使用数组来生成这样的查询：

```
INSERT INTO assess_2012_err (su_id, err_code) VALUES (5, 1), (1492, 1) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:22:58.970

在将值输入数据库时​​，使用[**foreach**](http://php.net/manual/en/control-structures.foreach.php)循环遍历数据。

像：

```
foreach($sql as $key=>$value){

        foreach($value as $key_p=>$value_p){

            //Implement Query here
           //R.g
          //$key will have 'su_id'
         //$value_p will have 1

            }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:27:05.967

你最好一个一个地做，像这样

```
foreach($sql as $variables)
{
  // Insert here: 
  INSERT INTO asses_2012_err (su_id, err_code) VALUES ($variables['su_id'], $variables['err_code']);

} 
```

一些重要的事情要记住：

*   将这些输入视为用户输入，对其进行清理！
*   尝试使用 PDO，因为 mysql_* 函数将被弃用
*   考虑一个数据抽象层（所以你所有的查询都隐藏在好的函数中）

# python - wxPython 与 PyInstaller 一起执行？

> ID：13059316
> 
> 赞同：2
> 
> 时间：2012-10-24T23:18:55.377
> 
> 标签：python, wxpython, exe, pyinstaller

我正在尝试让 wxPython 应用程序作为 exe 运行。我听说 PyInstaller 现在优于 py2exe。我想包含脚本运行所需的 .ico 和两个 .png 文件。这个规范文件会是什么样子？我似乎在任何地方都找不到像样的例子。我安装了 PyInstaller，但在任何地方都找不到这个“makespec”。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:37:32.817

在我的 PyInstaller 项目中，我通常只进行运行时检查以[查看应用程序是否已冻结](http://www.pyinstaller.org/export/v2.0/project/doc/Manual.html?format=raw#adapting-to-being-frozen)并相应地调整位图的路径。所以像这样处理 PyInstaller 和常规 Python 应用程序：

```
def app_path():
    """Returns the base application path."""
    if hasattr(sys, 'frozen'):
        # Handles PyInstaller
        return os.path.dirname(sys.executable)
    return os.path.dirname(__file__) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:40:21.213

检查`sys.frozen`是一个非常好的方法。您还可以查看`img2py`哪个可以将图像的二进制数据加载到 .py 文件中。稍后，不必打开文件，它们可以被导入。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T00:10:01.113

```
a = Analysis(['script.py'],
             pathex=['D:\\source-control\\GITHUB\\projectname'],
             hiddenimports=[],
             hookspath=None,)

a.datas += [( 'images', r'C:\Users\igorl\Pictures\hzgJUXi5l4o.jpg', 'DATA')]

pyz = PYZ(a.pure)
exe = EXE(pyz,
          a.scripts,
          a.binaries,
          a.zipfiles,
          a.datas,
          name=os.path.join('dist', 'script.exe'),
          debug=False,
          strip=None,
          upx=True,
          console=False ) 
```

# r - RStudio 用于制作类似于 Emacs Cc Co 的 R 包文档

> ID：13059319
> 
> 赞同：0
> 
> 时间：2012-10-24T23:19:22.270
> 
> 标签：r, emacs, rstudio, roxygen2

> **可能重复：**
> [RStudio 可以自动为函数生成 roxygen 模板吗？](https://stackoverflow.com/questions/10825058/can-rstudio-automatically-generate-an-roxygen-template-for-a-function)

我使用 Emacs 开发 R 包（使用 roxygen2）并发现 Cc Co over 一个函数来生成注释非常有用。RStudio 中是否有任何类似的键绑定可以达到相同的结果，即生成

```
##' .. content for \description{} (no empty lines) ..
##'
##' .. content for \details{} ..
##' @title 
##' @param x 
##' @param y 
##' @return 
##' @author authors 
```

这个问题已经在[这里](https://stackoverflow.com/questions/10825058/can-rstudio-automatically-generate-an-roxygen-template-for-a-function)问过了，我只是想知道这个问题是否有任何更新。谢谢！

# python - Python 计数出现返回 0

> ID：13059320
> 
> 赞同：1
> 
> 时间：2012-10-24T23:19:22.380
> 
> 标签：python

我有一个列表，其中分别包含一个人的姓名、年龄和 id。我想计算列表中给定 id 的出现次数。

当我尝试：

```
alist=[(('john', 37), 8),(('john', 37), 8)]

count_ID=alist.count(8)
print count_ID 
```

我收到：

```
count_ID returns 0 
```

我希望它在此示例中返回 2，因为列表中有 2 个 id=8 的项目。我怎样才能解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:23:43.457

试试这个：

```
alist = [ (('john', 37), 8), (('john', 37), 8) ]
sum(1 for x in alist if x[1] == 8) 
```

您必须以某种方式指定该`id`字段作为元组中的第二个元素存在，然后仅过滤掉那些元组，`id == 8`最后为找到的每个元组求和 1 - 或者我们可以找出结果列表的长度，但是为什么当生成器足够时创建一个临时列表？

正如评论中所指出的，这也有效：

```
sum(x[1] == 8 for x in alist) 
```

上面的代码片段之所以有效，是因为在比较中，`x[1] == 8`一个`True`值的计算结果为`1`，a 的`False`计算结果为`0`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:26:25.833

`alist.count(8)`仅当`8`是以下元素时才有效`alist`：

```
>>> alist = [(('john', 37), 8),(('john', 37), 8)]
>>> 8 in alist
False 
```

`8`但是，它是列表第一个元素的一个元素：

```
>>> 8 in alist[0]
True 
```

因此，要计算出现次数，您必须检查是否`8`在 的每个元素中`alist`：

```
>>> sum(i[1] == 8 for i in alist)
2 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-24T23:27:03.533

列表必须是扁平的。Python 不计算嵌套列表。所以它会是：

```
alist=[(('john', 37), 8),(('john', 37), 8),8,8] 
```

让python返回2

这是扁平化列表的[方法](https://stackoverflow.com/questions/5828123/nested-list-and-count)

# c++ - 为什么我生成的 .sln 文件无法在 Visual Studio 2010 中打开？

> ID：13059321
> 
> 赞同：1
> 
> 时间：2012-10-24T23:19:23.423
> 
> 标签：c++, visual-studio-2010, qt

我正在处理一个相当大的 C++ 代码库。代码库通常旨在使用自定义构建脚本和 makefile 在 Linux 下编译。我将代码移植到 Visual Studio 中，任何使用过 Visual Studio 的人都会同意，手动操作很痛苦。

我自己的查找一直没有结果，所以我开始在 Qt 中编写自己的实用程序来分析代码库并生成解决方案文件和随附`.vcxproj`文件。我一直在使用`QUuid`该类为每个项目生成 GUID，并且我正在使用`QTextStream`它来编写`.sln`文件。

现在，问题来了：当我打开生成的`.sln`文件时，我看到以下错误。 ![所选文件不是有效的解决方案文件](../Images/49a6ea1485940a030ec29e1f4ce7fc54.png) ![该系统找不到指定的文件](../Images/0bf520f8ce690e63a41c0e46d81373b0.png)

我目前正在尝试生成已在 Visual Studio IDE 中手动创建的解决方案。我已经将我生成`.sln`的文件与 Visual Studio 创建的文件进行了比较，除了项目以不同的顺序出现并且 GUID 不匹配（显然）之外，我看不出有什么区别。我在这里包含了我的问题的简化示例。

**Visual Studio 生成了这个：**

```
Microsoft Visual Studio Solution File, Format Version 11.00
# Visual Studio 2010
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "mylib", "mylib\mylib.vcxproj", "{35BAFEEE-35FA-4313-AF67-AF8AB7458451}"
EndProject
Global
    GlobalSection(SolutionConfigurationPlatforms) = preSolution
        Debug|Win32 = Debug|Win32
        Release|Win32 = Release|Win32
    EndGlobalSection
    GlobalSection(ProjectConfigurationPlatforms) = postSolution
        {35BAFEEE-35FA-4313-AF67-AF8AB7458451}.Debug|Win32.ActiveCfg = Debug|Win32
        {35BAFEEE-35FA-4313-AF67-AF8AB7458451}.Debug|Win32.Build.0 = Debug|Win32
        {35BAFEEE-35FA-4313-AF67-AF8AB7458451}.Release|Win32.ActiveCfg = Release|Win32
        {35BAFEEE-35FA-4313-AF67-AF8AB7458451}.Release|Win32.Build.0 = Release|Win32
    EndGlobalSection
    GlobalSection(SolutionProperties) = preSolution
        HideSolutionNode = FALSE
    EndGlobalSection
EndGlobal 
```

**我生成了这个：**

```
Microsoft Visual Studio Solution File, Format Version 11.00
# Visual Studio 2010
Project("{8BC9CEB8-8B4A-11D0-8D11-00A0C91BC942}") = "mylib", "mylib\mylib.vcxproj", "{A09FDB84-49CD-4C14-9D7D-D813D2D905EF}"
EndProject
Global
    GlobalSection(SolutionConfigurationPlatforms) = preSolution
        Debug|Win32 = Debug|Win32
        Release|Win32 = Release|Win32
    EndGlobalSection
    GlobalSection(ProjectConfigurationPlatforms) = postSolution
        {A09FDB84-49CD-4C14-9D7D-D813D2D905EF}.Debug|Win32.ActiveCfg = Debug|Win32
        {A09FDB84-49CD-4C14-9D7D-D813D2D905EF}.Debug|Win32.Build.0 = Debug|Win32
        {A09FDB84-49CD-4C14-9D7D-D813D2D905EF}.Release|Win32.ActiveCfg = Release|Win32
        {A09FDB84-49CD-4C14-9D7D-D813D2D905EF}.Release|Win32.Build.0 = Release|Win32
    EndGlobalSection
    GlobalSection(SolutionProperties) = preSolution
        HideSolutionNode = FALSE
    EndGlobalSection
EndGlobal 
```

以下是我的问题：

1.  这些特定的错误消息是什么意思？
2.  有什么方法可以让我获得有关`.sln`文件问题的更具体信息吗？
3.  我生成的 GUID 有问题吗？我是否应该使用 Visual Studio 工具来创建 GUID？
4.  我丢失的文件中是否有一些元数据或其他不可见的特殊调味料？

我很确定问题不在于文本编码——我使用记事本创建了 UTF-8 版本`.sln`并尝试打开它。

鉴于一切，似乎是我的 GUID 导致了问题——尽管我不确定如何或为什么。

## 更新

我注意到这些文件之间的唯一主要区别是文件大小。这两个文件相差 3 个字节，但我使用文本编辑器在文件中看不到任何内容。然而，[Joel Spolsky](http://www.joelonsoftware.com/articles/Unicode.html)的一篇文章让我开始思考。没有纯文本这样的东西——毕竟，一切都只是 1 和 0 的表示。

我在十六进制编辑器中打开了这两个文件，然后，我在 Microsoft 生成的文件的开头找到了 3 个字节！( `0xEF, 0xBB, 0xBF`)。这三个字节也出现在我在另一台机器上的 Visual Studio 2008 解决方案中。在开始编写解决方案之前，我可能会编写代码将这些字节放入文件中，但这仍然引出了一个问题：

**这些字节到底是干什么用的，微软为什么要使用它们？**

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T20:29:04.553

您正在考虑的是[UTF-8 字节顺序标记](http://en.wikipedia.org/wiki/Byte_order_mark)。

它用于指示文件是 UTF-8 编码的，并且应该呈现为空白的零宽度空间。如果您有选择，请不要使用它——它会使文件更难用标准文本编辑器阅读。

使用记事本打开文件并将其保存为 UTF-8 编码文本将为您添加这三个字节。但同样，不要在旨在便携读取的文件上使用 BOM。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:23:16.437

使用 Visual Studio 调试 Visual Studio：

在使用 Visual Studio 打开生成的解决方案之前，打开另一个 Visual Studio 实例，转到`Debug->Exceptions`并选中所有复选框，然后转到`Debug->Attach to Process...`并附加到`devenv.exe`. 现在在另一个 VS 中打开解决方案，您将获得一个中断和一个调用堆栈，这可能会为您提供更多信息。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-26T00:20:45.000

为了补充我接受的答案，在 Qt 的情况下，我在用于编写解决方案文件的对象中使用了[以下方法：](http://qt-project.org/doc/qt-4.8/qtextstream.html#setGenerateByteOrderMark)`QTextStream`

```
void QTextStream::setGenerateByteOrderMark ( bool generate ) 
```

语法是这样的：

```
QFile fileHandle("mylib.sln");
QTextStream fileStream(&fileHandle);
// ...file open and error handling goes here...
fileStream.setGenerateByteOrderMark(true);
fileStream << "\nMicrosoft Visual Studio Solution File, Format Version 11.00\n";
//etc, etc 
```

这将确保您的文件具有字节顺序标记，在这种特定情况下，Visual Studio 需要它来打开文件。

# networking - TCP PSH 是如何工作的？

> ID：13059323
> 
> 赞同：4
> 
> 时间：2012-10-24T23:19:31.350
> 
> 标签：networking, tcp, tcp-ip

PSH 是一种通过 TCP 发送数据的方式。除此之外，我几乎找不到有关如何正确实施它的信息。

以下是我感兴趣的：

1.  假设服务器窗口为 8000 字节，我发送了 2 个分别为 150 和 600 字节的请求。我是否得到某种确认数据已收到？我可以以某种方式触发确认吗？

2.  我见过一些 ACK 数据包，它们不包含 PSH，但确实包含某种有效负载数据（Wireshark 将其标记为“TCP 段数据”）。这些数据是否传递给用户，如果是，为什么我们需要 PSH 标志？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T23:40:21.087

TCP PSH 通常根本不起作用。伯克利派生的 TCP 实现完全忽略了它。

资料来源：WR Stevens，*TCP/IP 图解，*第一卷：20.5 PUSH Flag。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-08-30T11:56:07.937

@Arsen：回答您问题的第二部分“为什么我们需要 PSH 标志？” TCP 标头中的 PSH 标志通知接收主机应立即将数据推送到接收应用程序。我们使用 PSH 标志在两台服务器之间交换时间戳值。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-09T11:21:10.290

我假设，如果我们设置推送标志，数据包不会在接收缓冲区中等待，它将直接发送到接收器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-05-13T13:10:54.010

无论如何，数据不会在接收缓冲区中等待。
TCP 应用程序必须不遗余力地让 TCP 层批量处理一些数据包并提供完整的数据缓冲区。
事实上，看到应用程序分配 64KB 缓冲区来接收数据并看到它们收到大量 1480/1472 字节的消息，这有点令人沮丧。

# javascript - ios6 中的 html5 选择问题 - 适用于 ios5

> ID：13059333
> 
> 赞同：1
> 
> 时间：2012-10-24T23:20:35.777
> 
> 标签：javascript, ios, html

我们有一个网页，允许用户单击一个按钮来保存突出显示的文本。这发生在一个框架中。我们的代码在 ios v5 上运行时有效，但在 ios 6 上它不起作用。在 touchstart 功能执行之前，选择似乎已被删除。

请访问[http://athena.atomus.com/bluec/selectionTestFrame.html](http://athena.atomus.com/bluec/selectionTestFrame.html)。

1.  长按一些文字并突出显示它
2.  点击按钮
3.  在 ios5 下，您将看到带有突出显示文本的警报。在 ios6 下你会看到一个未定义的警报

谢谢

克里斯

# c++ - c++中字节的十六进制值到字符串（相当于linux中的od -x）？

> ID：13059335
> 
> 赞同：0
> 
> 时间：2012-10-24T23:20:39.133
> 
> 标签：c++, string, hex, byte, endianness

我的目标是编写更简洁/有效的函数来将值转换为十六进制字符串，因为它存储在内存中（因此打印的值将取决于系统字节顺序）：

```
#include <iostream>
#include <cstdio>
#include <cstdlib>
#include <iomanip>
#include <string>

template<typename T> 
std::string hexOf(const T& x)
{
    return std::string(reinterpret_cast<const char*>(&x), sizeof(x));
}

int main()
{
   std::cout<<hexOf(9283)<<std::endl;
   return 0;
} 
```

当前的实现不起作用，因为字符串包含字符，而不是字符的实际十六进制表示。

我期望的最终结果是在小端系统上`hexOf(0xA0B70708)`返回字符串。`0807b7a0`

如何以简洁/有效的方式做到这一点？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:31:35.967

这是标准答案：

```
template <typename T>
std::string hexify(T const & x)
{
    char const alphabet[] = "0123456789ABCDEF";

    std::string result(2 * sizeof x, 0);
    unsigned char const * const p = reinterpret_cast<unsigned char const *>(&x);

    for (std::size_t i = 0; i != sizeof x; ++i)
    {
        result[2 * i    ] = alphabet[p[i] / 16];
        result[2 * i + 1] = alphabet[p[i] % 16];
    }

    return result;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:28:42.483

你可以这样做：

```
template<typename T> 
std::string hexOf(const T& x)
{
    std::string rc;
    rc.reserve(2 * sizeof(x));
    for (unsigned char* it(reinterpret_cast<char const*>(&x)), end(it + sizeof(x));
         it != end; ++it) {
        rc.push_back((*it / 16)["0123456789abcdef"]);
        rc.push_back((*it % 16)["0123456789abcdef"]);
    }
    return rc;
} 
```

# c++ - C++ 字符数组连接

> ID：13059337
> 
> 赞同：0
> 
> 时间：2012-10-24T23:20:49.913
> 
> 标签：c++, string, char, assertion, strcat

我正在尝试重载加号以连接两个字符串，但我不断收到错误消息。

VS 2010 给出了一个**断言失败**消息：“Expression: (L "Buffer is too small" && 0)" ; **文件：** f:\dd\vctools\crt_bld\self_x86\crt\src\tcscat_s.inl；**行：** 42 。

您认为我的代码有什么问题？

```
#include "stdafx.h"

class MyString{
    int l;  // the length of the array pointed by buf
    char *buf; //pointer to a char array
public:
        ...
    MyString(char *);
    friend MyString operator+(MyString &,MyString &);
        ...
};

MyString::MyString(char *p)
{
    buf=new char[strlen(p)+1];
    strcpy_s(buf,strlen(p)+1,p);
    l=strlen(p)+1;
}

MyString operator+(const MyString &a,const MyString &b)
{
    MyString result("");
    result.l=a.l+b.l;
    delete[] result.buf;
    result.buf=new char[result.l+1];
    result.buf[0]='\0';
    strcat_s(result.buf,result.l+1,a.buf);
    strcat_s(result.buf,result.l+1,b.buf);
    return result;
}

int _tmain(int argc, _TCHAR* argv[])
{
    MyString a("hello"),b("world"),c("");
    c=a+b;
    system("pause");
    return 0;
} 
```

现在可以了！谢谢大家！

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:32:21.530

> ```
> strcat_s(result->buf,strlen(a.buf),a.buf);
> strcat_s(result->buf,strlen(b.buf),b.buf); 
> ```

的第二个参数`strcat_s`是目标缓冲区的大小，而不是应附加的字符串的大小。所以你需要把它改成

```
strcat_s(result->buf,result->l+1,a.buf);
strcat_s(result->buf,result->l+1,b.buf); 
```

正如其他人已经指出的那样，其余的 operator + 实现也被破坏了。新建一个实例然后按值返回它是无稽之谈。只需在堆栈上实例化结果并按值返回。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:24:19.810

应该是`result.buf=new char[result.l+1];`允许空字符。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T23:27:07.710

在 operator+ 中，变量“MyString result”在堆栈上声明，随后通过引用返回，这很糟糕。

然后编辑了OP。变量“result”不再在堆栈上声明，而是在堆上分配。但是，随后发生了内存泄漏。

这里正确的做法是按值返回并在堆栈上声明“MyString 结果”。还要确保你有一个复制构造函数。还有一个析构函数。

您还应该让您的构造函数采用“const char*”。

# java - 如何生成范围内的随机整数

> ID：13059341
> 
> 赞同：2
> 
> 时间：2012-10-24T23:21:20.340
> 
> 标签：java

> **可能重复：**
> [使用 Java 在一个范围内生成随机数](https://stackoverflow.com/questions/363681/generating-random-number-in-a-range-with-java)

这感觉很傻，但我不确定如何创建一个随机整数，给它一个允许的特定范围。我试图让它生成介于 -1 和 1 之间的随机数。我尝试这样做，但该`nextInt`部分不允许将两个参数放在括号内。我应该使用不同的东西吗？

```
import java.util.Random;

public class Testttterrrr {

    /**
     * @param args
     */
    public static void main(String[] args) {
        Random rng = new Random();
        for (int i=0;i < 10; i++)
        {
        int pepe = 0;
        pepe = rng.nextInt(1, 1-2);
        System.out.println(pepe);
        }
    }

} 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-24T23:24:00.473

你可以做

```
pepe = rng.nextInt(3) - 1; 
```

* * *

`rng.nextInt(3)`返回集合中的随机元素*`{0, 1, 2}`*- 因此，根据需要减去`1`返回集合中的随机元素*`{-1, 0, 1}`*。

* * *

相关文件：

*   [`nextInt`](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Random.html#nextInt%28int%29)

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-24T23:23:52.073

试试这个说法： `int pepe = rng.nextInt(3) - 1;`

* * *

## 回答 #3

> 赞同：4
> 
> 时间：2012-10-24T23:24:08.867

采用

```
pepe = rng.nextInt(3) - 1; 
```

返回 -1、0、1 的随机序列。

```
rng.nextInt(3) 
```

返回区间中的一个随机数`[0..2]`。减 1 得到区间`[-1..1]`。

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2012-10-24T23:33:43.523

```
pepe = rng.nextInt(3) - 1; 
```

随机数将是 0、1 或 2。然后减去 1 将得到 -1、0 或 1，就像你想要的那样

# excel - Excel公式如何连接字符串以供外部参考

> ID：13059343
> 
> 赞同：1
> 
> 时间：2012-10-24T23:21:25.963
> 
> 标签：excel, excel-formula

假设我在一个单元格中有以下公式，它从另一个工作簿中读取单元格的值

```
='c:\temp\[external book.xlsx]SheetX'!$E$4 
```

我希望 的值`c:\temp\[external book.xlsx]SheetX`来自此工作表中的另一个单元格。我将如何重写这个公式来连接这个值和`"!$E$4"`

假设单元格`A1`包含`c:\temp\[external book.xlsx]SheetX`

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T01:04:02.543

**编辑：**由于以下内容不适用于封闭的工作簿，因此这是一个笨拙的概念证明，说明如何使用 VBA 进行操作（我想有更好的方法来做到这一点）：

```
Sub ClosedWorkbook()

Dim currSht As Worksheet
Dim targetWbk As Workbook
Dim Path As String

' Turn off updating
Application.ScreenUpdating = False

' Set a reference to the current sheet
Set currSht = ActiveWorkbook.ActiveSheet

' Get the value in the formula cell (A1 here, could be ActiveCell if in a loop, etc.)
PathSheet = currSht.Range("A1").Value

' Split out the path - this is very clunky, more of a proof (?) of concept
' This is depends on the path being as you mentioned, and the IF block is to 
' check if the apostrophe is present in the cell (since it is the escape character,
' it is usually skipped)
If Left(PathSheet, 1) = "'" Then
  Path = Replace(Mid(PathSheet, 2, InStr(PathSheet, "]") - 2), "[", "")
  Sheet = Mid(PathSheet, InStr(PathSheet, "]"))
  Sheet = Left(Sheet, Len(Sheet) - 2)
Else
  Path = Replace(Mid(PathSheet, 1, InStr(PathSheet, "]") - 1), "[", "")
  Sheet = Mid(PathSheet, InStr(PathSheet, "]") + 1)
  Sheet = Left(Sheet, Len(Sheet) - 2)
End If

' Open the target workbook
Set targetWbk = Workbooks.Open(Path)

' Grab the value from E4 and drop it in a cell (D1 here, could be ActiveCell, etc.)
MyValue = targetWbk.Sheets(Sheet).Range("E4").Value
currSht.Range("D5").Value = MyValue

' Close the target
targetWbk.Close

Application.ScreenUpdating = True
End Sub 
```

* * *

**OLD WAY**（不适用于已关闭的工作簿）

我相信这可以捕捉到您正在寻找的东西。在此示例中，单元格`A1`具有我的工作表路径：

```
'C:\temp\[externalworkbook.xlsx]Sheet1'! 
```

在单元格 B1 中，我有公式：

```
=INDIRECT(A1 & "$E$4") 
```

它将工作表值连接起来`$E$4`以生成完整路径，然后将其转换为`INDIRECT`. 需要注意的一件事：撇号是一个转义字符，因此根据您的数据，您可能必须在公式中特别考虑它：

```
=INDIRECT("'" & A1 & "$E$4") 
```

如果您使用的是 Excel 2007 或更高版本，则可以将其包装在`IFERROR`公式中以消除猜测：

```
=IFERROR(INDIRECT(A1 & "$E$4"),INDIRECT("'" & A1 & "$E$4")) 
```

# c# - 反转渐变/照明

> ID：13059347
> 
> 赞同：0
> 
> 时间：2012-10-24T23:21:41.693
> 
> 标签：c#, xna, distance, tiles, lighting

我基本上做了某种渐变，通过给一个网格颜色的瓷砖，它看起来像这样：

![在此处输入图像描述](../Images/f24407f4410f632b1687e340148c7935.png)

现在，我想把它反转，所以光是白色的，周围是黑色的，我该怎么做呢？我尝试了很多，但我没有做任何工作。

这是代码：

```
 foreach (Tile tiles in Tiles)
        {
            tiles.distance = (mousePos - tiles.pos).Length();

            tiles.color = new Color(tiles.distance / size, tiles.distance / size, tiles.distance / size);
        } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T06:45:28.933

如果这看起来很明显（意味着您已经尝试过），我很抱歉，但我自己没有考虑太多次就这样做了......

您正在使用哪些数据类型？例如，tiles.distance 看起来像一个浮点数，这意味着除法将解析为一个浮点数，这反过来意味着您最终将使用 Color(Single, Single, Single) 构造函数而不是 Color(Byte, Byte, Byte ) 构造函数。这意味着您必须从 1 而不是 255/0xFF 中减去，否则您最终会得到一个远高于 1 的值（上限 -> 白色）。

如果这是问题，以下将：

```
tiles.color = new Color(1 - tiles.distance / size, 1 - tiles.distance / size, 1 - tiles.distance / size); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:29:15.277

只需从 0xFF 中减去每个颜色分量：

```
float value = 0xFF - tiles.distance / size;
tiles.color = new Color(value, value, value); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:16:25.533

```
tiles.color = new Color(255 - (tiles.distance / size), 255 - (tiles.distance / size),255 - (tiles.distance / size)); 
```

从 255 中减去（全白）

# java - 为什么删除功能不适用于哈希图？

> ID：13059348
> 
> 赞同：1
> 
> 时间：2012-10-24T23:20:47.640
> 
> 标签：java

我正在开发一个简单的项目，该项目从输入文件中获取数据，获取所需的内容并将其打印到文件中。我基本上得到了词频，所以每个键都是一个字符串，值是它在文档中的频率。然而，问题是我需要按频率降序将这些值打印到文件中。在制作我的哈希图之后，这是我的程序的一部分，用于对其进行排序并将其写入文件。

```
//Hashmap I create
Map<String, Integer> map = new ConcurrentHashMap<String, Integer>();
int valueMax = -1;
//function to sort hashmap
while (map.isEmpty() == false){
            for (Entry<String, Integer> entry: map.entrySet()){
                if (entry.getValue() > valueMax){
                    max = entry.getKey();
                    System.out.println("max: " + max);
                    valueMax = entry.getValue();
                    System.out.println("value: " + valueMax);
                }
            }
            map.remove(max);
            out.write(max + "\t" + valueMax + "\n");
            System.out.println(max + "\t" + valueMax);  
        } 
```

当我运行它时，我得到：

```
t 9
t 9
t 9
t 9
t 9
.... 
```

所以看起来删除功能不起作用，因为它不断获得相同的值。我在想我的范围规则有问题，或者我只是不太了解哈希图。

如果有人知道对哈希图进行排序和打印的更好方法，我会欢迎提出建议。

谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:25:07.313

您的代码不起作用，因为在每次后续迭代中，`entry.getValue() > valueMax`永远不会正确，因为您不会`valueMax`在重新进入 while 循环时重置。

不过，您不需要在可同时访问的地图上进行双循环。

[`ConcurrentSkipListMap`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html)有一个[`lastKey`](http://docs.oracle.com/javase/7/docs/api/java/util/concurrent/ConcurrentSkipListMap.html#lastKey%28%29)方法可以返回最大的键并且不需要在整个地图上进行迭代。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:27:31.617

从您的代码看来，您没有`valueMax`在循环结束时重置。这意味着第一次循环你会找到最大值，但你永远不会找到任何后续值，因为你仍然会与整体最大值进行比较。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T23:37:55.610

Hashmap：没有顺序。您可以使用 ArrayList，它实现了 List 以进行排序。

看看：[http ://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html](http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T23:27:41.193

我猜这是因为地图中没有键> valueMax初始值的条目，所以条件`if (entry.getValue() > valueMax)`永远不会为真。

此外，还有`TreeMap`它的内容已排序，因此您可以在没有`entrySet()`任何其他逻辑的情况下对其进行迭代。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T07:14:45.597

怎么样的东西（未测试）

```
 final Map<String, Integer> map = new ConcurrentHashMap<String, Integer>();
  final Comparator <String, String> comparator = new Comparator ()
         {
             compare(String o1, String o2) 
             {
                  return map.get(o1) - map.get(o2);
             }
         };

  final TreeMap <String, Integer> sortedMap = new TreeMap (comparator);
  sortedMap.addAll(map);
  System.out.println(sortedMap); 
```

# ajax - AJAX 与 Rails 3.0

> ID：13059351
> 
> 赞同：0
> 
> 时间：2012-10-24T23:22:08.840
> 
> 标签：ajax, ruby-on-rails-3

[我在这篇关于 AJAX with Rails 的指南](http://guides.rubyonrails.org/ajax_on_rails.html)中读到“Rails 3.1 附带 jQuery 作为默认的 JavaScript 库”。如果我使用的是 Rails 3.0，那么 AJAX 的使用与本指南中指定的有何不同？（我现在很难升级 Rails 版本。）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:29:17.860

好吧，就像在 Rails 3.1 中一样，您添加：

```
gem 'jquery-rails' 
```

在你的`Gemfile`, 如果它不存在（在这种情况下你实际上已经拥有它）并运行：

```
bundle install 
```

而且，您将需要运行：

```
rails g jquery:install 
```

在那之后。

# api - 即时更改演示参数

> ID：13059352
> 
> 赞同：1
> 
> 时间：2012-10-24T23:22:09.323
> 
> 标签：api, directx

DirectX API 中是否有一个函数可以即时更改 Direct3D 设备的参数（例如“是否全屏”、“屏幕分辨率是多少”等），还是我必须用全新的设备替换当前设备一个——这是我目前的设置？

# c# - 用于谷歌推荐人验证的正则表达式

> ID：13059353
> 
> 赞同：2
> 
> 时间：2012-10-24T23:22:11.370
> 
> 标签：c#, regex

我对 Regex 完全陌生，并且一直试图做到这一点，但收效甚微。

基本上我想要做的是创建一个匹配任何谷歌域的正则表达式，如 Google.com、Google.co.uk 等。

到目前为止，我有`^http://www.google\.com/.*$`，但这仅与 Google.com 匹配。我如何修改它以允许任何扩展`com`？

谢谢！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-24T23:25:39.507

您可以使用替代，但是您必须提供所有您想要允许的 TLD：

```
^http://www\.google\.(?:com|co\.uk|de|es)/.*$ 
```

添加更多由管道分隔的选项。或者，您可以允许**任何**TLD（无论是否有效）：

```
^http://www\.google\.[a-z.]+/.*$ 
```

但是，这也将匹配类似`http://www.google.myowndomain.com/`. 我认为不会有任何方法只允许有效域而不列出所有域。

顺便说一句，如果您想让斜杠和最后的路径/查询成为可选，请将其更改为以下之一：

```
^http://www\.google\.(?:com|co\.uk|de|es)(?:/.*)?$
^http://www\.google\.[a-z.]+(?:/.*)?$ 
```

然后你可以更进一步，使`www.`可选：

```
^http://(?:www\.)?google\.(?:com|co\.uk|de|es)(?:/.*)?$
^http://(?:www\.)?google\.[a-z.]+(?:/.*)?$ 
```

您会看到，为给定问题匹配所有可能但有效的 URL 并非易事，但需要仔细考虑；）。

根据您使用的语言，内置 URL 解析功能可能会有更好的选择。例如，在 PHP 中，这将是一种更简单的方法：

```
$domain = parse_url($urlStr, PHP_URL_HOST);
$isGoogle = preg_match('/^(?:www\.)?google\.[a-z.]+/', $domain); 
```

或者（因为无论如何这并不完美，如上所述）你可以完全放弃正则表达式并像这样进行检查：

```
$isGoogle = strpos($domain, 'google.') !== false; 
```

# iphone - pc浏览器和iphone浏览器之间的CSS响应式设计问题

> ID：13059355
> 
> 赞同：0
> 
> 时间：2012-10-24T23:22:20.620
> 
> 标签：iphone, html, css, responsive-design

我在理解如何在 iPhone 上以体面的方式呈现网页时遇到了一些问题，我认为问题必须`margin-left`与移动的。

这是它在 PC 浏览器上的外观： ![在此处输入图像描述](../Images/973a6440ac915d0ac011eb19e7808166.png)

抱歉这么多空格，只是为了澄清 div 居中。这就是它在我的 iPhone 上的外观：

![在此处输入图像描述](../Images/66f080178f5d9c5a9fbe4abeba6cfdd7.png)

即使用我的手指移动页面我也看不到蓝丝带的左侧，它只是“超出屏幕”。

* * *

这是我的代码（部分）：

## CSS

```
#center-coupon {
  width: 474px;
  height: 255px;
  position: absolute;
  left: 50%;
  top: 40%;
  margin-left: -237px;
  margin-top: -150px;
  text-align: center;
}

#rib { 
  background-image:url(img/ribbon.png); 
  height:75px; width:474px; 
}
#main4 { 
  position:relative;
  background-color:#eeeeee;
  height:300px; 
  width:340px;
  left:66px 
} 
```

## html

```
<div id="center-coupon">
  <div id="rib"></div>
  <div id="main4">
    <p style="font-size:35px;font-weight:bold;padding-top:15px;">El bar de mou</p>
    <p>coupon awarded to</p>
    <img src="http://graph.facebook.com/XXXXXXXXXX/picture" alt="profile picture" class="img-polaroid">
    <span style="font-size: 25px; font-weight:bold;"> Domingo</span>
    <p style="margin:10px 0 0 0; font-size: 17px;">Valid for: <b>Beer moretti 0.2l</b></p>
    <p>created on 2012-10-21</p>
    <a data-toggle="modal" href="#destroy_c" class="btn btn-danger btn-large">Destroy Coupon</a>  
  </div>
</div> 
```

* * *

我知道`center-coupon`div 比 iphone 屏幕更宽，但这并不能解释为什么我无法看到功能区左侧的一部分......一个好的解决方案是让 iphone 以更少的缩放比例渲染网站，但是我不知道这是否可能，也不知道该属性是否与其他移动平台兼容。所以你怎么看？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:39:18.583

您的负边距超过 iPhone 视口宽度的一半，因此它会将其拖出视图。

如果要使元素居中，可以使用`margin: auto`（只要设置了显式宽度）而不是使用绝对定位来定位元素。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:38:32.940

我不是 iPhone 专家，但据我了解，设备的像素密度与 CSS 像素无关。所以，就 CSS 而言，手机的宽度是 320px。您将优惠券的左边缘定位在页面中间，然后将其向左移动 237 像素，这实际上将其置于屏幕之外。您是否尝试过将负边距更改为较小的金额？

# java - 换行属性 JEditorPane

> ID：13059357
> 
> 赞同：1
> 
> 时间：2012-10-24T23:22:25.810
> 
> 标签：java, swing, jeditorpane, word-wrap

有人知道如何更改 a 的换行符属性`JEditorPane`吗？

`JTextPane`我无法在我的 s 文本中找到换行符（既不是*\n*也不是*\r*），因此我无法正确计算此文本的行数。我想更改*\n*的换行符属性。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T05:55:02.553

用于`javax.swing.text.Utilities.getRowStart()/getRowEnd()`计算行数。

事实上，当文本被包装时，没有插入任何字符。请参阅[http://java-sl.com/wrap.html](http://java-sl.com/wrap.html)以了解 wrap 的工作原理。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T02:01:01.697

这个例子对我有用......

```
public class TestEditorPane {

    public static void main(String[] args) {
        new TestEditorPane();
    }

    public TestEditorPane() {
        EventQueue.invokeLater(new Runnable() {
            @Override
            public void run() {
                try {
                    UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
                } catch (ClassNotFoundException ex) {
                } catch (InstantiationException ex) {
                } catch (IllegalAccessException ex) {
                } catch (UnsupportedLookAndFeelException ex) {
                }

                JFrame frame = new JFrame();
                frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
                frame.setLayout(new BorderLayout());
                frame.add(new EditorPane());
                frame.pack();
                frame.setLocationRelativeTo(null);
                frame.setVisible(true);
            }
        });
    }

    public class EditorPane extends JPanel {

        private JEditorPane editor;

        public EditorPane() {

            setLayout(new GridBagLayout());
            editor = new JEditorPane();
            editor.setContentType("text/plain");

            JButton button = new JButton("Dump");
            button.addActionListener(new ActionListener() {
                @Override
                public void actionPerformed(ActionEvent e) {
                    String text = editor.getText();
                    String[] parts = text.split(System.getProperty("line.separator"));
//                    String[] parts = text.split("\n\r");
                    for (String part : parts) {
                        if (part.trim().length() > 0) {
                            System.out.println(part);
                        }
                    }
                }
            });

            GridBagConstraints gbc = new GridBagConstraints();
            gbc.gridx = 0;
            gbc.gridy = 0;
            gbc.weightx = 1;
            gbc.weighty = 1;
            gbc.fill = GridBagConstraints.BOTH;
            add(editor, gbc);

            gbc.gridx = 0;
            gbc.gridy++;
            gbc.weightx = 0;
            gbc.weighty = 0;
            gbc.fill = GridBagConstraints.NONE;
            add(button, gbc);
        }
    }
} 
```

在 windows 下，换行符似乎是`/n/r`. 我也使用了系统属性`line.separator`，它似乎对我有用。

# php - 是否可以将 EOD 与 swiftmailer 一起使用

> ID：13059366
> 
> 赞同：-1
> 
> 时间：2012-10-24T23:23:17.017
> 
> 标签：php, swiftmailer

我正在尝试使用[swiftmailer](http://swiftmailer.org/docs/messages.html)发送电子邮件。有没有办法使用 EOD 呢？

这种语法（来自他们的网站）似乎是一种在 html 中构建东西的非常困难的方法：

```
'<html>' .
' <head></head>' .
' <body>' .
'  Here is an image <img src="' . $cid . '" alt="Image" />' .
'  Rest of message' .
' </body>' .
'</html>', 
```

但是当我尝试这个

```
$msg = <<<EOD
<html>
<table>
    <tr>
        <td>
        NAME
        </td>

        <td>
        thomas 
        </td>
    </tr>

    <tr>
        <td>
        COMPANY
        </td>

        <td>
        whatever
        </td>
    </tr>
</table>
<html>
EOD;

   // Set the To addresses with an associative array
->setTo(array('whatever@whatever.whatever'=>'thomas'))

// Give it a body
->setBody($msg)

;

// Send the message
$result = $mailer->send($message); 
```

我只是收到一封打印出 html 的电子邮件。有没有办法让这更容易？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:33:25.063

也许你可以去掉换行符。

```
$msg = str_replace("\r\n","",$msg); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-01-24T07:56:18.470

*当您在使用swiftmailer*时在电子邮件中收到*HTML*结构时，这意味着您已将内容设置为：

 *```
->setContentType('text/html; charset=utf-8') 
```

删除`charset=utf-8`并让内容成为`text/HTML`。
如果问题仍然存在，请检查您的*EOD*格式。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-24T23:34:20.360

必须设置内容类型。><

`->setContentType('text/html')`*

# iphone - 应用程序随机收到 EXC_CRASH (SIGABRT)

> ID：13059369
> 
> 赞同：0
> 
> 时间：2012-10-24T23:23:30.353
> 
> 标签：iphone, ios, crash, crash-reports

我很难理解以下崩溃，因为它是随机发生的，我怀疑可能是多线程问题，但它是：

```
Incident Identifier: 0BE956AB-228A-4B1B-8A3D-A99A481F7F3F
CrashReporter Key:   da7dc0be9da2f7fa677999d7093fdf2495031393
Hardware Model:      iPhone3,1
Process:         MyApp test [2899]
Path:            /var/mobile/Applications/D6419515-BA52-4747-94C5-5626F0E69571/MyApp test.app/MyApp test
Identifier:      MyApp test
Version:         ??? (???)
Code Type:       ARM (Native)
Parent Process:  launchd [1]

Date/Time:       2012-10-24 19:42:40.289 +0200
OS Version:      iPhone OS 5.0.1 (9A405)
Report Version:  104

Exception Type:  EXC_CRASH (SIGABRT)
Exception Codes: 0x00000000, 0x00000000
Crashed Thread:  0

Last Exception Backtrace:
0   CoreFoundation                  0x33e118bf __exceptionPreprocess + 163
1   libobjc.A.dylib                 0x340611e5 objc_exception_throw + 33
2   CoreFoundation                  0x33e14acb -[NSObject doesNotRecognizeSelector:] + 175
3   CoreFoundation                  0x33e13945 ___forwarding___ + 301
4   CoreFoundation                  0x33d6e680 _CF_forwarding_prep_0 + 48
5   MyApp test                  0x000889f9 -[UploadPhotoViewController requestCompletedWithCode:] (UploadPhotoViewController.m:154)
6   CoreFoundation                  0x33d7022b -[NSObject performSelector:withObject:] + 43
7   MyApp test                  0x0005f6c9 -[ASIHTTPRequest reportFinished] (ASIHTTPRequest.m:2020)
8   CoreFoundation                  0x33d7022b -[NSObject performSelector:withObject:] + 43
9   Foundation                      0x357fb757 __NSThreadPerformPerform + 351
10  CoreFoundation                  0x33de5b03 __CFRUNLOOP_IS_CALLING_OUT_TO_A_SOURCE0_PERFORM_FUNCTION__ + 15
11  CoreFoundation                  0x33de52cf __CFRunLoopDoSources0 + 215
12  CoreFoundation                  0x33de4075 __CFRunLoopRun + 653
13  CoreFoundation                  0x33d674dd CFRunLoopRunSpecific + 301
14  CoreFoundation                  0x33d673a5 CFRunLoopRunInMode + 105
15  GraphicsServices                0x305ebfcd GSEventRunModal + 157
16  UIKit                           0x371e8743 UIApplicationMain + 1091
17  MyApp test                  0x00032025 main (main.m:16)
18  MyApp test                  0x00031fd0 0x30000 + 8144 
```

这是 UploadPhotoViewController requestCompletedWithCode: 方法：

```
-(void)requestCompletedWithCode:(int)statusCode{

    [hud hide];

    if (statusCode == 201){
        UINavigationController *navVC = [self.tabBarController.viewControllers objectAtIndex:3];
//        UpdatesViewController *updatesVC= (UpdatesViewController *)[navVC visibleViewController];
        UpdatesViewController *updatesVC= (UpdatesViewController *)[navVC topViewController];
        updatesVC.newPhoto = YES;
        [self.tabBarController setSelectedIndex:3];
        [self.navigationController popViewControllerAnimated:NO];

    }
} 
```

第 154 行指向：

```
 [self.tabBarController setSelectedIndex:3]; 
```

任何人都知道可能是什么问题？

**编辑**

我通过这些行从以前的 VC 到 UploadPhotoViewController（手头的 VC）：

```
 [self performSegueWithIdentifier:@"UploadPhoto" sender:self];
  [self dismissModalViewControllerAnimated: NO]; 
```

DismissModalViewControllerAnimated 正在关闭 UIImagePickerController。

非常感谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:30:50.593

问题可能出在*[NSObject doesNotRecognizeSelector:]*中，您可能会覆盖或删除您的 tabBarController（或从模态窗口实例化相同的视图控制器）并且它会变得疯狂。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:41:41.240

这可能有点矫枉过正，但出于测试（和学习）的目的，我会替换

```
[self.tabBarController setSelectedIndex:3]; 
```

和

```
if ([self.tabBarController respondsToSelector:@selector(setSelectedIndex:)])
    [self.tabBarController setSelectedIndex:3];
else
    NSLog(@"self.tabBarController is not an instance of UITabBarController"); 
```

# android - Google Android LVL CheckLicense 服务超时

> ID：13059370
> 
> 赞同：2
> 
> 时间：2012-10-24T23:23:33.360
> 
> 标签：android, android-lvl

我有一个使用 Google 许可保护服务的应用程序。我已经成功地测试了这个应用程序（几周后就在 Google Play 上）和许可证检查。

几天前，我发布了另一个具有相同保护和另一个私有的应用程序

`static final byte[] SALT = new byte[] {....}`

并且许可证检查也适用于这个应用程序。

今天我更新了发布的第一个应用程序的单一布局。我已经测试了该应用程序，但令我惊讶的是许可证检查失败并出现超时问题（我的互联网连接工作正常）

```
10-25 01:04:16.689: I/LicenseChecker(2739): Binding to licensing service.
10-25 01:04:16.709: I/LicenseChecker(2739): Calling checkLicense on service for myapp.package.comu
10-25 01:04:16.709: I/LicenseChecker(2739): Start monitoring timeout.
10-25 01:04:26.719: I/LicenseChecker(2739): Check timed out.
10-25 01:04:28.579: I/LicenseChecker(2739): Binding to licensing service.
myapp.package.comu
10-25 01:04:28.609: I/LicenseChecker(2739): Start monitoring timeout.
10-25 01:04:38.619: I/LicenseChecker(2739): Check timed out. 
```

我已经尝试从控制台更改我的许可证响应但没有成功，许可证检查服务对我的应用程序没有任何响应。

**在我发布的具有不同包和相同保护逻辑的第二个应用程序中，LVL 可以正常工作。**

我无法弄清楚这个问题可能是什么原因。

我也尝试过使用相同的*SALT*数组但没有成功。

现在我只能希望该应用程序的购买者没有同样的问题。

任何的想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-26T17:38:59.167

该错误位于 Google 许可服务器或 Google Play 应用程序中，由于某种奇怪的原因随机导致设置中的数据损坏并拒绝与应用程序的连接。如果您更改包名称，服务器会正​​确响应。

显然更改包名称很烦人，如果应用程序已经在市场上真的有问题。

**一种解决方法是：**

1）卸载应用程序

2) 清除手机设置中的所有*Google Play 商店*应用数据，**不仅是缓存**，还有*Google Play 服务数据。*

3) 重新打开 Google Play 并接受最终用户许可协议。

4) 重新安装应用程序。

我已尝试联系 Google 解决问题。

# android - 如何确定我的 Android 应用程序为何需要某些权限？

> ID：13059377
> 
> 赞同：8
> 
> 时间：2012-10-24T23:24:14.117
> 
> 标签：android

假设我已经接管了一个 Android 应用程序的开发，我的老板问我为什么我们的应用程序需要某些权限才能显示给在 Android 市场上购买该应用程序的用户。

我可以使用任何工具或技巧来确定哪些代码触发了每个权限，这样我就可以弄清楚为什么我们的应用程序在功能上需要这些权限？特别是，我对这些权限感兴趣：

*   电话 - 读取电话状态和身份

*   系统工具 - 检索正在运行的应用程序 - 允许应用程序检索有关当前和最近运行的任务的信息，可能允许恶意应用程序发现有关其他应用程序的私人信息。

该应用程序是一个 GPS 跟踪应用程序，不清楚为什么可能需要此权限。

即使您不能告诉我如何直接分析代码以找出答案，获取有关为什么需要此权限的任何提示也会很有帮助。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T03:47:49.700

这是我将如何追踪这些。

**第 1 步**- 找到您的 AndroidManifest.xml 中声明的清单权限

基本上`<uses-permission />`标签内的所有内容，例如：

```
<uses-permission android:name="android.permission.READ_PHONE_STATE"/> 
```

**第 2 步**- 在 developer.android.com 搜索使用这些权限的类

让我们以 READ_PHONE_STATE 为例，目标是找出哪些包需要此权限。在开发门户上简单搜索“READ_PHONE_STATE”开始我们的搜索，我们在这里寻找类，在前 5 个搜索结果中，我看到以下类：

*   电话经理
*   电话状态监听器

单击类并获取它们的包名称：

*   android.telephony.TelephonyManager
*   android.telephony.PhoneStateListener

**步骤 3**在您的项目中查找导入这些包的类

一个简单的 grep 就可以了，或者 Eclipse 中的 Ctrl-H，文件搜索 -> 包含文本

**第 4 步**注释掉导入，看看有什么问题

这些*可能*是需要许可的原因。通过查看开发门户来确认有问题的方法，以验证该方法确实需要权限。

最后你应该可以告诉你的老板，READ_PHONE_STATE 是必需的，因为我们调用函数 XYZ，它给了我们 UVW。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:48:55.133

删除权限并查看应用程序失败的地方。答案将在 logcat 输出中。

不过，这不是一个理想的解决方案，因为您可能不知道在应用程序中需要做什么才能触发该权限。

我怀疑“读取手机状态和身份”意味着该应用程序正在使用设备 IMEI 或类似的识别信息来唯一地识别设备，以确保该应用程序仅在注册的设备上运行。或者它可能只是用作一种 cookie 来跟踪所有者。寻找那个代码。并删除它，因为那是错误的做法。如果您需要识别特定的 android 设备，请使用 Settings.Secure 类中的 ANDROID_ID。 [http://developer.android.com/reference/android/provider/Settings.Secure.html](http://developer.android.com/reference/android/provider/Settings.Secure.html)

至于“检索正在运行的应用程序”，我觉得有点可疑。实现 GPS 跟踪的一种非常常见的方法是在其自己的进程中启动单独的服务。这样，如果应用程序崩溃，服务将继续运行并可以重新连接。在这种情况下，应用程序可能正在使用“检索正在运行的应用程序”来识别和终止服务进程。但如果是这样，这是一种笨拙的方法。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2015-07-31T07:18:14.023

使用最新的构建工具，您可以运行`lint`检查，它将为您突出显示所有需要权限的 android SDK 方法调用。

请参阅此处的公告[http://android-developers.blogspot.com/2015/07/get-your-hands-on-android-studio-13.html](http://android-developers.blogspot.com/2015/07/get-your-hands-on-android-studio-13.html)和此处的文档[https://developer.android.com/tools/debugging /annotations.html#permissions](https://developer.android.com/tools/debugging/annotations.html#permissions)。

这是基于 android 注释，经过一段时间的采用，第 3 方库也可以集成权限注释

[![在此处输入图像描述](../Images/e79a469148c3cfa1b94b0f914b2c91a9.png)](https://i.stack.imgur.com/VBKHQ.png)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T23:28:50.127

您的老板的答案是“因为我们在应用程序中使用的某些 API 功能/调用/方法**需要**calee 持有某些权限。出于安全原因，这就是 Android 的工作方式”。至于提到的权限 - 您必须检查代码以查看是否真的需要这些权限。`Read phone status and identity`可能表明您的应用尝试获取 IMEI 或类似的东西来唯一识别设备。`Retrieve running applications`- 没有理由让 GPS 跟踪应用程序持有这个。但**也许**你使用使用它的 3rd 方库/代码。

# haskell - 使 memoization 成为 Haskell 的默认行为的选项

> ID：13059381
> 
> 赞同：8
> 
> 时间：2012-10-24T23:24:34.563
> 
> 标签：haskell, ghc, memoization

我已经在 Haskell 中看到了所有其他的记忆技巧和技术，但我正在寻找的是一个在编译器/解释器级别的简单实现，它为我处理记忆。

例如，考虑斐波那契函数的以下代码：

```
fib 0 = 1
fib 1 = 1
fib n = fib (n-1) + fib (n-2) 
```

我想要 ghc（或任何其他 Haskell 编译器）的某种编译器选项，默认情况下使用 memoization 执行上面的代码。例如，要计算“fib 10”，首先需要计算“fib 8”和“fib 9”。此外，计算“fib 9”取决于首先计算“fib 8”。因此，在计算“fib 10”时，我希望编译器/解释器能够理解并仅计算一次“fib 8”。

请注意，我不想编写一个新的斐波那契函数来处理记忆（就像 Haskell 中的所有其他记忆问题一样）。我想要的是保持上面的功能并且仍然有记忆。我不知道是否有任何 Haskell 编译器具有这种能力，这是我的问题的一部分。你知道可以给我这个的 Haskell 编译器吗？

谢谢

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T01:00:00.320

编译器通常不会提供“memoize”选项，因为很难知道程序员希望在哪里以及如何执行 memoization。记忆本质上是交易时间和空间要求。

现在，如果您愿意以稍微不同的方式编写函数，那么有*一种*方法可以将函数的定义和使用的记忆技术解耦。

```
import Data.RunMemo (Memoizable, runMemo, noMemo)
import Data.MemoCombinators as Memo (integral)

fibMemoizable :: Memoizable (Integer -> Integer)
fibMemoizable recurse = go where
  go 0 = 1
  go 1 = 1
  go n = recurse (n - 1) + recurse (n - 2)

fastFib :: Integer -> Integer
fastFib = runMemo Memo.integral fibMemoizable

slowFib :: Integer -> Integer
slowFib = runMemo noMemo fibMemoizable 
```

这使用了 Luke Palmer 的[data-memocombinators](http://hackage.haskell.org/package/data-memocombinators)包，以及我自己的玩具包[runmemo](http://hackage.haskell.org/package/runmemo)。请注意，它的*内容*与您编写的内容相同，只是它`recurse`为递归调用调用。虽然这*可以*被集成到编译器中，但我认为没有任何理由，因为 Haskell 的表达能力足以处理这个问题，而无需编译器知道我们在做什么。

# php - CKEditor 没有完全上传文本

> ID：13059383
> 
> 赞同：0
> 
> 时间：2012-10-24T23:24:54.360
> 
> 标签：php, mysql, textarea, ckeditor

我在使用 CKEditor（通过 PHP）时遇到问题，它不会将完整的文档保存到 SQL 表中。然后它会在重定向时抛出一个垃圾。在大多数情况下，它工作得非常好。它似乎只发生在长文本上 - 好像它被限制在一定的字符数内（我没有设置任何限制 - 但不确定 CKEditor 中是否设置了限制。我在任何地方都找不到关于此的任何信息） . SQL 表是一个 Longblob，所以我相信它能够存储大约 4GB 的数据。起初我以为是图像之类的，但事实证明纯文本也有同样的问题。

所以，我的问题是： 1\. CKEditor 输入的文本是否有限制？2、标签默认的字符数有形式限制吗？3\. 我做了一个布布吗？

```
//form blah
<textarea class='ckeditor' name='doc'></textarea>
//etc

//SQL query upload
$query = mysql_query("INSERT INTO `docs` (`title`,`doc`,`date`,`author`,`category`) VALUES ('$title','$doc','$date','$author','$category')"); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:27:52.600

您在 mysql 中的数据类型可能太小而无法容纳大量数据。尝试将其设置为 TEXT。

# javascript - 循环一段 Javascript 一定次数

> ID：13059386
> 
> 赞同：0
> 
> 时间：2012-10-24T23:25:08.623
> 
> 标签：javascript, loops

在一段代码的开头和结尾添加什么以在继续之前重复 36 次？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-24T23:26:38.313

您使用[`for`](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)循环：

```
for ( var i = 0; i < 36; i++ ) {
    // This will loop 36 times
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-24T23:26:29.760

您添加一个 for 循环：

```
 for (var i = 0; i < 36; i++) {
 } 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2012-10-24T23:26:09.500

您正在寻找一个`for`循环：[https ://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for](https://developer.mozilla.org/en-US/docs/JavaScript/Reference/Statements/for)

# uiscrollview - 我如何制作一个简单的滚动视图高度= 80，宽度= 280，里面的图像水平滚动？

> ID：13059387
> 
> 赞同：-1
> 
> 时间：2012-10-24T23:25:08.663
> 
> 标签：uiscrollview

我需要在 xcode 中制作一个简单的滚动视图，宽度为 280，高度为 80，并且里面的图像水平滚动。我想以编程方式进行此操作。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T20:51:56.093

我假设你的意思是 UIScrollview，它有一个由苹果编写的指南在这里找到：http: [//developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html](http://developer.apple.com/library/ios/#documentation/uikit/reference/UIScrollView_Class/Reference/UIScrollView.html)

我个人使用的指南是这样的：http: [//idevzilla.com/2010/09/16/uiscrollview-a-really-simple-tutorial/](http://idevzilla.com/2010/09/16/uiscrollview-a-really-simple-tutorial/)

我将带您快速了解将滚动视图添加到视图并向其添加图像的基本知识。

我猜你是 Objective C 的新手，所以我会给你一个快速指南。首先，您需要创建一个 UIScrollView 对象。这是通过声明以下内容来完成的：

```
UIScrollView *aScrollView = [[UIScrollView alloc] initWithFrame:CGRectMake (0,0,320,250)]; 
```

你会注意到我设置了框架。CGRectMake 的前两个数字为您提供点的 x 和 y 原点，而后两个数字是您希望对象的宽度和高度。

之后，您需要向其中添加图像。你需要一个 UIImageview。

```
UIImageView *imageView = [[UIImageView alloc] initWithFrame:CGRectMake(0, 0, 320, 250)]; 
```

请注意，我将图像定位在 0,0，高度为 250，宽度为 320。这样可以确保它填充整个滚动视图的初始视图。

```
imageView.image = [UIImage imageNamed:@"foo.png"]; 
```

您将图像附加到 imageView。但是等等，还有更多。到目前为止，您已经创建了这些对象，但还没有将它们与视图相关联。因此，如果我们在 ViewController 类中（您必须查看它是什么），ViewController 包含一个视图。我们可以将对象附加到视图。

```
[aScrollView addSubview:imageView];   // Adds the image to the scrollview
[self.view addSubview:aScrollView];   // Adds the scrollview to the view. 
```

如果要添加更多图像，则必须将它们添加到不同的 x 原点。所以我们第一个添加的图像是在 0,0。我们下一个添加的图像应该是 320,0（因为第一个图像占用了 320 像素宽度）。

```
UIImageView *secondImageView = [[UIImageView alloc] initWithFrame:CGRectMake(320, 0, 320, 250)];
secondImageView.image = [UIImage imageNamed:@"bar.png"];
[aScrollView addSubview:secondImageView]; 
```

您需要探索许多滚动视图选项。我发现有用的是：

```
aScrollView.delegate = self; // For gesture callbacks
self.pagingEnabled = TRUE;   // For one-at-a-time flick scrolling
self.showsHorizontalScrollIndicator = NO; // Cleaner look for some apps.
self.alwaysBounceHorizontal = TRUE; // Look it up. 
```

# c++ - 通过网络发送指向静态函数的指针是否安全？

> ID：13059392
> 
> 赞同：6
> 
> 时间：2012-10-24T23:26:12.510
> 
> 标签：c++, c, function-pointers

我正在考虑一些我必须在 C++ 中实现的 RPC 代码，我想知道通过网络将它发送到相同的二进制代码是否安全（以及在哪些假设下）（假设它完全相同并且它们运行相同）建筑学）。我想虚拟内存应该在这里有所作为。

我只是出于好奇才问它，因为无论如何它都是一个糟糕的设计，但我想知道它在理论上是否可行（以及它是否可以扩展到其他类型的指向静态数据的指针，而不是程序可能包含的函数）。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-24T23:48:54.710

一般来说，由于许多原因，它并不安全，但在有限的情况下它会起作用。首先，我将假设您在协议中使用某种签名或加密来确保数据流的完整性；如果没有，那么您已经遇到了严重的安全问题*，*这些问题只能通过传递函数指针来复杂化。

如果完全相同的程序二进制文件在连接的两端运行，如果函数在主程序中（或在从静态库链接的代码中）而不是在共享库中，并且如果程序不是作为位置构建的-独立可执行文件（PIE），那么函数指针在两端将是相同的，并且通过网络传递它应该可以工作。请注意，这些是非常严格的条件，必须作为使用程序的一部分记录在案，而且它们非常脆弱；例如，如果有人升级了一侧的软件，同时忘记升级连接另一侧的版本，事情就会严重而危险地中断。

我会完全避免这种类型的低级 RPC 以支持更高级别的命令结构或抽象 RPC 框架，但如果你真的想这样做，一个稍微安全一点的方法是传递函数名并使用`dlsym`或等效于查看他们起来。如果符号驻留在主程序二进制文件中而不是库中，则根据您的平台，您可能需要`-rdynamic`(GCC) 或类似选项以使它们可用于`dlsym`. `libffi`也可能是抽象这一点的有用工具。

此外，如果您想避免依赖`dlsym`or `libffi`，您可以将自己的“符号表”硬编码在二进制文件中，作为`static const`线性表或哈希表将符号名称映射到函数指针。ELF 中用于此目的的哈希表格式非常易于理解和实现，因此我可能会考虑基于此实现您的实现。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:30:46.297

它指向什么？

它是指向一块静态程序内存的指针吗？如果是这样，请不要忘记它是地址，而不是偏移量，因此您首先需要相应地在两者之间进行转换。

其次，如果它不是一块静态内存（即：在构建时而不是运行时创建的静态分配数组），那根本不可能。

最后，您如何确保两段代码相同？两个二进制文件是否相同（例如：）`diff -a binary1 binary2`。即使它们是位相同的，取决于每台机器上的虚拟内存管理，整个程序的程序内存段可能不存在于单个页面中，或者跨多个页面的对齐方式对于每个系统可能不同。

这真是个坏主意，不管你怎么切。这就是消息传递和 API 的用途。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T23:31:16.590

这是高度依赖于系统的。在具有虚拟寻址的系统上，每个进程每次执行时都认为它在同一个地址上运行，这可能适用于可执行代码。Darren Kopp 关于 ASLR 的评论和链接很有趣——快速阅读 Wikipedia 文章表明 Linux 和 Windows 版本专注于数据而不是可执行代码，除了 Linux 上的“面向网络的守护进程”，而在 Windows 上，它仅适用于“特别链接为启用 ASLR”。

尽管如此，静态链接最好确保“相同的二进制代码”——如果加载了不同的共享对象/库，或者它们以不同的顺序加载（可能是由于动态加载——`dlopen`由配置文件或命令行参数中的不同顺序驱动等等）你可能已经吃饱了。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2012-10-24T23:32:35.707

我不知道有任何形式的 RPC 可以让你通过网络发送一个指针（至少不做类似强制转换之类的事情`int`）。如果您确实`int`在发送端转换为，并将其转换回远端的指针，则与将任何其他任意指针转换`int`为指针几乎相同：如果您尝试取消引用它，则为未定义的行为。

通常，如果您传递一个指向 RPC 函数的指针，它将被编组——即，它指向的数据将被打包、发送、放入内存，以及指向传递给的数据的本地副本的指针另一端的功能。这就是 IDL 变得有点丑陋的原因/方式的一部分——您需要告诉它如何确定当/如果您传递指针时要通过线路发送多少数据。大多数人都知道以零结尾的字符串。对于其他类型的数组，您通常需要指定数据的大小（不知何故）。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2012-10-24T23:58:04.497

通过网络发送指针通常是不安全的。两个主要原因是：

*   **可靠性**：由于程序或其库或内存中动态分配的对象的不同位置，数据/函数指针可能不会指向另一台机器上的同一实体（数据结构或函数）。可重定位代码 + ASLR 可能会破坏您的设计。至少，如果你想指向一个静态分配的对象或一个函数，如果你的平台是 Windows 或在你的任何操作系统上做类似的事情，你应该将它的偏移量发送到图像库。
*   **安全**性：如果您的网络是开放的并且有黑客（或者他们已经闯入了您的网络），他们可以冒充您的第一台机器并使第二台机器挂起或崩溃，从而导致拒绝服务，或者执行任意代码并获得访问权限敏感信息或篡改或劫持机器并将其变成发送垃圾邮件或攻击其他计算机的邪恶机器人。当然，这里有对策也有对策，但是……

如果我是你，我会设计一些不同的东西。而且我会确保传输的数据是不重要的或加密的，并且接收部分在使用它之前对其进行必要的验证，因此没有缓冲区溢出或执行任意事情。

* * *

## 回答 #6

> 赞同：1
> 
> 时间：2012-10-25T00:11:36.540

如果您正在寻找一些正式的保证，我无法帮助您。您必须查看您正在使用的编译器和操作系统的文档 - 但是我怀疑您会找到必要的保证 - 可能除了一些专门的嵌入式系统操作系统。

但是，我可以为您提供一种情况，我 99.99% 确信它可以正常工作：

*   视窗
*   32位进程
*   函数位于没有重定位信息的模块中
*   有问题的模块已经在客户端加载和初始化
*   有问题的模块在两边都是 100% 相同的
*   一个不会做非常疯狂的事情的编译器（例如 MSVC 和 GCC 都应该没问题）

如果要调用 DLL 中的函数，可能会遇到问题。根据上面的列表，模块（=DLL）可能没有重定位信息，这当然使得它不可能重定位（这是我们需要的）。不幸的是，这也意味着加载 DLL 将失败，如果“首选加载地址”被其他东西使用。所以这有点冒险。

但是，如果该函数驻留在 EXE 中，则应该没问题。32 位 EXE 不需要重定位信息，并且大多数不包括它（MSVC 默认设置）。顺便说一句：ASLR 在这里不是问题，因为 a) ASLR 仅移动标记为要移动的模块，并且 b) ASLR 无法在没有重定位信息的情况下移动 32 位 Windows 模块，即使它想要移动。

以上大部分内容只是确保该函数在双方都具有相同的地址。剩下的唯一问题——至少我能想到的——是：*假设*字节模式是如果我们获取了所需函数的地址，我们会得到相同的结果吗？这肯定是 C++ 标准不能保证的，但我不希望当前的实际编译器会出现任何实际问题。

话虽如此，我**不**建议这样做，除非安全性和稳健性真的不重要。

# python - 在 Python 中动态创建多个类

> ID：13059401
> 
> 赞同：3
> 
> 时间：2012-10-24T23:27:01.983
> 
> 标签：python, oop

我将感谢任何澄清以下内容的努力：Python中有没有一种方法可以为每个类动态创建一个对象，其中声明了几个类？我的愚蠢猜测可以描述如下：

...

# 假设我们有一些来自 db 的数据

```
props = dict_cur.fetchall() 
classes_names = []
data = []

for i in props:
    classes_names.append(i['client_name'].title()) 

classes = []
data = []

for i in props:
    data.append(dict(i)) 

for i, d in zip(classes_names, data):
    classes.append(type(i, (object,), dict(**d)))

print classes
#printing list of classes

objects = []
for obj in classes:
objects.append(obj())

for obj in objects:
    print obj.client_name, obj.client_id 
```

这是一种非常幼稚的方法，它永远不会以常规方式从创建的类中继承，就像这样：

```
class ClientProcess(Someclient): #Someclient is the name of the created class before

    def __init__(self):
        print "Someclient stuff" 
```

目标非常简单：创建多个类的对象，最好使用存储在表中的属性，但同时为每个客户端声明类，这些客户端将实现特定的方法，从类到类。运行良好并使用 Python 版本的 Factory 方法的初始脚本是不够的，因为它一次只能处理一个类（客户端）（基于客户端 ID 的命令行参数）。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T05:27:09.740

如果我理解正确，您可以使用以下方法对动态创建的类进行子类化：

```
In : classes = []

In : cls_name = 'BaseCls1'

In : classes.append(type(cls_name, (object, ), {'x': 1}))

In : classes[0].x
Out: 1

In : classes[0].__bases__
Out: (object,)

# two ways to create subclass out of BaseCls1

In : class SubCls1(classes[0]):
   :     x = 2
   :
In : SubCls1.x
Out: 2

In : SubCls1.__bases__
Out: (__main__.BaseCls1,)

In : SubCls2 = type('SubCls2', (classes[0],), {'x': 2})

In : SubCls2.x
Out: 2

In : SubCls2.__bases__
Out: (__main__.BaseCls1,) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T20:30:21.913

```
class GetConfig(object):

    def __init__(self, client_id):
        self.client_id = client_id
        #construct the query here to get the clients data ...where client_id = self.client_id
        d = {'logfile': 'some_long_path', 'contact_name': 'some_name'}

    class FirstClient(object):

    def __init__(self):
        client_id = '111111111'
        props = GetConfig(client_id)
        #print props.d

    def check_source(self):
        print "Checking FirstClient source"
        return "Something"
        #print props.d

    def check_downl(self):
        print "Checking FirstClient downloaded"

class SecondClient(object):

    def __init__(self):
        client_id = "222222"
        props = GetConfig(client_id)

    def check_source(self):
        print "Checking SecondClient source"

    def check_downl(self):         
        print "Checking SecondClient downloaded"

myfactory = {
"firstclient" : FirstClient,
"secondclient" : SecondClient,
}

for i in myfactory.values():

    i().check_source()
    i().check_downl() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-10-13T00:17:29.793

集合.namedtuple。完毕。编辑：详细说明，

```
from collections import namedtuple
rows = dict_cur.fetchall() 
# creates the class Row which is a tuple, but each position argument
# corresponds to the column name in that position
# Row can be instantiated as a tuple and then its elements can be accessed
# by name class attributes 
Row = namedtuple("Row", zip(*dict_cur.description)[0])
objects = [Row(row) for row in rows]

for o in objects:
     print o.client_name, ' is ' , o 
```

# objective-c - 使用一组坐标的外边界构建 MKPolygon - 如何拆分位于一条线两侧的坐标？

> ID：13059403
> 
> 赞同：3
> 
> 时间：2012-10-24T23:27:04.067
> 
> 标签：objective-c, xcode, hittest, mapkit, convex-hull

我正在尝试使用一组坐标的外边界构建一个 MKPolygon。

据我所知，没有提供的功能可以实现这一点`Xcode`（MKPolygon 方法将使用所有点来构建多边形，包括内部点）。

经过一些研究，我发现凸包解决了这个问题。在研究了各种算法之后，我最能想到实现的一种算法是 QuickHull。

这需要外部纬度坐标并在两者之间画一条线。从那里，您根据该线将您的点拆分为两个子集，并处理外部纬度之间的距离以开始构建三角形并消除其中的点，直到您留下外部边界。

我可以通过查看最小/最大纬度来找到外部点，并且可以在两者之间画一条线 ( `MKPolyline`) - 但是我如何确定一个点是落在这条 MKPolyline 的一侧还是另一侧？

一个后续问题是是否有命中测试来确定点是否属于 MKPolygon。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T01:00:19.643

我最终使用了礼品包装算法的一种变体。当然不是一项微不足道的任务。

在格式化完整代码时遇到问题，所以我只需要把我的步骤（可能更好，因为我有一些清理工作要做！）

我从一组 MKPointAnnotations 开始

1）我得到了最左边的最低点。为此，我遍历所有点并比较 lat/lng 以获得最低点。这个点肯定会在凸包中，所以将它添加到一个 NSMutableArray 中，它将存储我们的凸包点（cvp）

2）获取最低点左侧的所有点并循环遍历它们，计算cvp与左侧剩余点的角度。无论哪个角度最大，都将是您需要添加到数组中的点。
atan(cos(lat1)sin(lat2)-sin(lat1)*cos(lat2)*cos(lon2-lon1), sin(lon2-lon1)*cos(lat2))

*   对于找到的每个点，创建一个三角形（通过使用新点的纬度和前一点的长）并创建一个多边形。我使用此代码对我的多边形进行了命中测试： BOOL mapCoordinateIsInPolygon = CGPathContainsPoint(polygonView.path, NULL, polygonViewPoint, NO); 如果在命中测试中发现任何内容，请将其从比较数组中删除（原始数组左侧的所有内容减去船体点）

*   一旦您的 cvp 数组中至少有 3 个点，使用数组中的所有 cvp 构建另一个多边形，并使用命中测试删除其中的任何内容。

3) 一旦你处理完所有的左侧点，创建一个新的比较数组，其中包含尚未消除或添加到船体的剩余点

4）使用相同的计算和多边形测试来删除点并添加 cvp's found 最后，您会得到一个构成凸包的点列表。

# objective-c - 可以指定 Objective-C 枚举的基础类型吗？

> ID：13059415
> 
> 赞同：1
> 
> 时间：2012-10-24T23:28:16.883
> 
> 标签：objective-c, enums

我惊讶地发现 Xcode 没有为以下代码发出错误，这在 C 中是无效的：

```
typedef enum : NSUInteger {
    FLAG_A = 1,
    FLAG_B = 2,
    FLAG_C = 4
} MyFlags; 
```

这似乎使枚举`NSUInteger`的基础类型`MyFlags`与 C# 用于设置枚举的基础类型的语法非常相似。

这个语法是按照它出现的那样做，还是有别的意思？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-24T23:56:37.650

它是从 C++11 借用的一个特性，用于确保枚举的特定大小。它允许在框架的公共 API 中使用枚举，而不必担心 ABI 最终会崩溃。

[Clang 实现了这个特性](http://clang.llvm.org/docs/LanguageExtensions.html#objc_fixed_enum)，并允许它在 Objective-C 中作为语言扩展使用。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-24T23:36:22.037

这将在目标 c 中正常工作。您可以在枚举中为这些参数设置任何值。

# .net - 向子控件添加属性

> ID：13059416
> 
> 赞同：0
> 
> 时间：2012-10-24T23:28:26.763
> 
> 标签：.net, properties, tablelayoutpanel, childcontrol

如果您在 .Net 中有一个容器，是否可以向添加到该控件的任何子项添加属性？

TableLayoutPanel 似乎可以做到这一点，如果你添加一个控件，比如一个面板，该控件有新的属性，单元格、列、行、colSpan、RowSpan。如果将控件移动到另一个面板，或者只是在 TableLayoutPanel 之外，属性就会消失。

这是如何实现的？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:42:04.797

[TableLayoutPanel](http://msdn.microsoft.com/en-US/library/system.windows.forms.tablelayoutpanel.aspx)控件实现了[IExtenderProvider](http://msdn.microsoft.com/en-us/library/system.componentmodel.iextenderprovider.aspx)接口，并添加了您上面提到的名称的[ProvideProperty](http://msdn.microsoft.com/en-us/library/system.componentmodel.providepropertyattribute.aspx)属性 - 导致您查询的“附加属性功能”。

我建议您挖掘其原始源代码以获取有关此实现的更多信息。

（如果您没有 .NET 反汇编程序，您可能会[在此处](http://ilspy.net)获得一个不错的免费反汇编程序。）

一些开始使用 IExtenderProvider 的资源：

*   [http://www.codeproject.com/aspnet/FixingIExtenderProvider.asp](http://www.codeproject.com/aspnet/FixingIExtenderProvider.asp)
*   [http://www.codeproject.com/aspnet/ExtenderProviderComponent.asp](http://www.codeproject.com/aspnet/ExtenderProviderComponent.asp)
*   [http://www.devx.com/dotnet/Article/21462](http://www.devx.com/dotnet/Article/21462)

# javascript - 检测在我的 Chrome 扩展程序之外生成的 DOM 更改

> ID：13059419
> 
> 赞同：3
> 
> 时间：2012-10-24T23:28:46.390
> 
> 标签：javascript, jquery, google-chrome-extension

我有一个 chrome 扩展，它在页面加载后将 iFrame 注入到 dom 中。

我也想听听 dom 的变化，但我想忽略`DOMSubtreeModified`由于我注入 iFrame 而被触发的 。所以任何事件，无论是在我注入 iFrame 之前还是之后，我都想捕捉。

这是我正在查看 dom 更改的内容脚本的基础知识：

```
var processRequest = function() {
  $('body').bind('DOMSubtreeModified', DOMModificationHandler);
  return 'complete';
}

function DOMModificationHandler() {
  $(this).unbind('DOMSubtreeModified');
  setTimeout(function() {
    //skip this if it was my iFrame injection that caused this event
    //someLocalFunction();
    $('#ContentContainer').bind('DOMSubtreeModified', DOMModificationHandler);
  },1000);
} 
```

`DOMModificationHandler`当火灾发生时，我能做些什么来区分我的注入和其他 dom 事件吗？

**更新：我考虑向 iFrame 添加某种类型的 id 或数据元素，但这只是告诉我它就在那里，而不是 iFrame 导致了事件。尤其是当有一个 AJAX 请求更新了 dom 的一部分时。任何 id 或 data 属性可能已经存在，所以我仍然不知道圆顶变化的来源。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:13:47.053

查看[http://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMSubtreeModified](http://www.w3.org/TR/DOM-Level-3-Events/#event-type-DOMSubtreeModified)和随后的[http://www.w3.org/TR/DOM-Level-3-Events/ #events-事件-类型-目标](http://www.w3.org/TR/DOM-Level-3-Events/#events-event-type-target)。您应该能够根据事件的目标过滤事件。在这种情况下，目标是被修改的父子树。

# ajax - 如果函数已经存在，请防止重新加载 javascript。否则保证同步加载

> ID：13059422
> 
> 赞同：2
> 
> 时间：2012-10-24T23:29:11.983
> 
> 标签：ajax, jquery

使用 JQuery.load()，我更改了网站主窗口的内容，以允许用户在选项卡之间切换。对于每个选项卡，有一个或多个 scipt 包含加载选项卡内容后执行的函数。

显然，当第一次切换到选项卡时，必须从服务器获取脚本并进行解释，但是如果用户稍后切换回选项卡，则不应发生这种情况。所以，简而言之：

1.  加载（） html

2.  确保存在 javascript 函数，否则加载脚本并解释它。

3.  重建 DOM 后在 javascript 上调用 aa 函数。

在执行第 3 步之前，必须先完成第 1 步和第 2 步。

目前，我正在使用嵌套回调来实现这一点：

```
function openFirstTab(){
    $("#mainWindow").load("firstTab.php", function(){
        if(typeof(onloadfFirstTab) != "function"){
            jQuery.getScript("assets/js/FirstTab.js", function(){
                onloadFirstTab();
            });
        }
        else{
            onloadFirstTab();
        }

    } );

} 
```

但我觉得应该有更好的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T04:08:03.567

您不能完全同步地编写代码，因为您无法在页面加载后同步加载脚本（除非您执行同步 XHR 请求并评估结果 - 不推荐）。

你有几个选择。有预先存在的依赖管理库，比如 RequireJS，它可能适合这里的账单，或者如果你只需要加载一个文件，你可以做这样的事情来清理你的代码，而不是使用 if/else：

```
function loadDependencies() {
    // For the sake of example, the script adds "superplugin" to the jQuery prototype
    return $.getScript( "http://mysite.com/jquery.superplugin.js" );
}

function action() {
    // If superplugin hasn't been loaded yet, then load it
    $.when( jQuery.fn.superplugin || loadDependencies() ).done(function() {
        // Your dependencies are loaded now
    });
} 
```

这利用了 jQuery [Deferreds/Promises](http://api.jquery.com/category/deferred-object/)使代码更好。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:03:22.993

如果您不想多次加载 JS 并且要动态加载它，那么知道它是否已经加载的唯一方法是测试一些表明它已经加载的条件。我知道的选择是：

1.  我所知道的最简单的是您已经在做的事情（检查是否存在在 javascript 中定义的函数）。

2.  您还可以在每个选项卡上使用一个属性（使用加载脚本后`.data()`设置的 jQuery 。`true`

3.  您可以编写动态加载的代码，以便它知道如何在已经加载的情况下避免重新初始化自身。在这种情况下，您只需每次加载它，但连续的时间不会做任何事情。提示，你不能有任何静态定义的全局变量，你必须在它运行自己的初始化代码之前测试它是否已经被加载。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T01:18:38.250

（还没有测试过，所以我不确定它是否有效，特别是因为我还没有真正理解 javascript 中的范围：）

```
function require(scripts, callback){
var loadCount = 0;

function done(){
loadCount -=1;
if (loadCount==0){ 
    callback();
    }
}

for ( var script in scripts){
    if (!script.exitsts()){
        loadCount +=1;
        jQuery.getScript(script.url, done);
        }
}

} 
```

此函数采用一组所需的脚本，并确保在调用`callback()`.

“脚本”类：

```
function script(url, testFunc){
this.url =url;
this.testFunction = testFunc;
this.exists = function(){
if(typeof(testFunction)=="function"){
    return true;
    } 
else{
    return false;
    }
}
} 
```

其中 test-function 是（仅）在相关脚本中定义的函数。

PS：要在 JQuery 中启用缓存，从而防止浏览器在每次调用 getScript() 时执行 GET 请求，您可以使用[此处介绍](http://jquerybyexample.blogspot.com/2012/04/use-jquerygetscript-to-load-external-js.html)的方法之一。

即使避免了不必要的 GET - 请求，每次调用 getScript() 时脚本仍然会被解释。这有时可能是期望的行为。但在很多情况下，不需要重新解释库函数。在这些情况下，如果所需的库函数已经可用，则避免调用 getScript() 是有意义的。（正如本例中使用 script.exists() 所做的那样。

# clojure - clojure 中的单元测试

> ID：13059424
> 
> 赞同：3
> 
> 时间：2012-10-24T23:29:15.913
> 
> 标签：clojure

我是 Clojure 的新手，我正在尝试编写单元测试。在 Clojure 中编写单元测试的最佳方法是什么，以及如何将定义函数的文件导入到单元测试中。

谢谢您的帮助。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T23:32:28.940

首先，有[clojure.test](http://clojure.github.com/clojure/clojure.test-api.html)。使用[Leiningen](https://github.com/technomancy/leiningen#readme)，您可以调用`lein test`以运行测试。

另请参阅对 BDD 有用的[Speclj](https://github.com/slagyr/speclj)。

* * *

## 回答 #2

> 赞同：5
> 
> 时间：2012-10-24T23:55:16.900

在 clojure 中进行单元测试的另一种公认方法是使用[Midje](https://github.com/marick/Midje)。

我读过关于它的好评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-21T11:58:47.203

[Speclj](http://speclj.com/)也是一个广泛接受的 clojure 语言的测试框架，您也可以考虑使用它。[在这里](https://stackoverflow.com/questions/12928250/how-do-midje-and-speclj-compare)你可以找到关于它的强弱点的更长的讨论

# android - 创建的新片段大小错误

> ID：13059426
> 
> 赞同：1
> 
> 时间：2012-10-24T23:29:20.140
> 
> 标签：android, webview, keyboard, size, fragment

我有一个应用程序，当用户点击选项卡时，它会从一个片段转换到另一个片段。其中一个片段中有一个 webview。我遇到的问题是，如果用户看到软键盘然后导航到 webview 片段，则会以错误的大小创建 webview。webView 的大小就像键盘还在启动一样。

我试图扩展片段使用的 webView 类，并尝试在 OnMeasure 中设置正确的大小。这无济于事。

似乎 webView 的某些内容无法正确调整大小。

另一个 hacky 选项可能是编写一个 javascript 接口类并让 javascript 触发调整大小？

我正在寻找的是一种以正确大小创建片段和 webView 的方法，但是没有简单的方法可以知道“正确”大小应该是什么。关于如何解决这个问题的任何想法？

# android - 在 Android 中使用 progressDialog 时出错

> ID：13059427
> 
> 赞同：0
> 
> 时间：2012-10-24T23:29:27.293
> 
> 标签：android, progressdialog

我正在开发一个从 XML 中收集数据并显示它的活动。

我做了一些测试，我猜问题是处理 ProgressDialog，当我加载数据时按下按钮刷新时，下面的代码可以工作，但是如果我尝试在不按下按钮的情况下收集数据（如果我省略了 loadData 上的注释（ ) ) 我得到一个错误。

所以我猜问题出在 ProgressDialog 但我无法检测到它。

```
public class TabFeed extends ListActivity implements Callback {

    private TabFeedController controller;
    private ProgressDialog progressDialog;
    public String _feedURL;

    private final Handler progressHandler = new Handler() {
        public void handleMessage(Message msg) {
            setData();
            progressDialog.dismiss();
        }
    };

    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.tabfeed);

        controller = new TabFeedController(MainTabs.model);
        controller.addOutboxHandler(new Handler(this));
        /**  It gets the _feedURL through a Handler (TabFeedController)  */
        controller.handleMessage(TabFeedController.MESSAGE_SHOW_FEED, null, null);

        Button btn = (Button) findViewById(R.id.btnLoad);

        **//loadData();**
        btn.setOnClickListener(new OnClickListener() {          
            public void onClick(View v) {
                LinkedList<Element> data = controller.getDataFeed();
                if (data != null) {
                    AlertDialog.Builder builder = new AlertDialog.Builder(TabFeed.this);
                    builder.setMessage("New loading?").setCancelable(false).setPositiveButton("Yes", new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                            loadData();
                        }
                    })
        .setNegativeButton("No", new DialogInterface.OnClickListener() {
                        public void onClick(DialogInterface dialog, int id) {
                            dialog.cancel();                                
                        }
                    }).create().show();                         
                } else {
                    loadData();
                }
            }
        });
    }

    private void setData(){
        this.setListAdapter(new AdapterFeedList(this, R.layout.row, 0, controller.getDataFeed()));
    } 

    private void loadData() {
        progressDialog = ProgressDialog.show(TabFeed.this,"", "Loading...", true);

        new Thread(new Runnable(){
            public void run() {
                XMLParser parser = new XMLParser(_feedURL);
                controller.setDataFeed(parser.parse());
                progressHandler.sendEmptyMessage(0);
            }
        }).start();
    }

    public boolean handleMessage(Message msg) {

        switch(msg.what) {
            case TabFeedController.MESSAGE_MODEL_GETFEED:
                runOnUiThread(new Runnable() {
                    public void run() {
                        _feedURL = TabFeedController.FEEDURL;
                    }
                });
                return true;
            }
            return false;
        }
    }
} 
```

当我在 onClickListener 按钮之前使用 loadData 行编译它时出现以下错误：

```
10-25 01:46:17.992: ERROR/AndroidRuntime(21460): FATAL EXCEPTION: Thread-13
10-25 01:46:17.992: ERROR/AndroidRuntime(21460): java.lang.RuntimeException: java.lang.NullPointerException
10-25 01:46:17.992: ERROR/AndroidRuntime(21460):     at ilias.XMLParser.XMLParser.parse(XMLParser.java:83)
10-25 01:46:17.992: ERROR/AndroidRuntime(21460):     at ilias.activities.TabFeed$3.run(TabFeed.java:115)
10-25 01:46:17.992: ERROR/AndroidRuntime(21460):     at java.lang.Thread.run(Thread.java:1019)
10-25 01:46:17.992: ERROR/AndroidRuntime(21460): Caused by: java.lang.NullPointerException
10-25 01:46:17.992: ERROR/AndroidRuntime(21460):     at ilias.XMLParser.XMLParser.parse(XMLParser.java:36)
10-25 01:46:17.992: ERROR/AndroidRuntime(21460):     ... 2 more 
```

我不知道它是否有帮助。当我在没有 loadData 行的情况下编译它时，它工作得很好，但我只想先加载数据而不按任何按钮，这就是为什么我加载数据并在 onClick 事件范围之外启动 progressDialog。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:07:58.410

您是否真的尝试过点击“是”按钮`AlertDialog`？因为看起来你实际上从未到达那里。我这样说是因为乍一看错误是说`_feedURL`（`null`如果您没有省略任何变量，则该变量永远不会被初始化），而当您说它正在工作时，实际上却不是（`setData()`手动刷新后您也不会调用） .

更新：

现在我们有了更多信息，我可以再次确定我的答案`_feedURL`is `null`，并且发生这种情况是因为您给它一个值，就好像它是从不同的线程调用的一样，因为您正在使用`runOnUiThread`. 当您进行该调用时，它会被推迟到当前线程完成为止，并且`loadData()`在那一刻调用了所有的坏运气，因此它的值没有及时出现。当您使用按钮执行此操作时，它有足够的时间执行这两个操作，这就是原因。一个快速的解决方案是删除`runOnUiThread`部分（处理程序是活动本身，所以你在 UI 线程上），但我想最好问这个问题：

> 为什么你甚至使用处理程序来为变量赋值？

如果你想给它一个值，只需给它，删除所有处理程序部分并`onCreate()`放入：

```
_feedURL = TabFeedController.FEEDURL; 
```

# c++ - 如何在不将所有相关代码带到标头的情况下解决模板成员函数的未定义引用？

> ID：13059437
> 
> 赞同：1
> 
> 时间：2012-10-24T23:30:09.127
> 
> 标签：c++, templates

在`foo.h`：

```
#ifndef FOO_H
#define FOO_H

enum Rat
{
    A,
    B
};

class Foo
{
public:
    template<Rat r>
    int aMemberFunc(int, int, int);
};

#endif 
```

在`foo.cpp`：

```
#include "foo.h"

namespace {
template<Rat r>
int helper(int a, int b)
{
    return a+b*((int) r);
}
}

template<Rat r>
int Foo::aMemberFunc(int a, int b, int c)
{
    return a + helper<r>(b,c);
} 
```

在`main.cpp`：

```
#include "foo.h"
#include <iostream>

using namespace std;

int main(void)
{
    Foo test;
    cout << test.aMemberFunc<B>(1,2,3) << endl;
} 
```

我编译`g++ main.cpp foo.cpp`并得到：

```
main.cpp:(.text+0x88): undefined reference to `int Foo::aMemberFunc<(Rat)1>(int, int, int)'
collect2: ld returned 1 exit status 
```

我不希望将内容移动到标题，因为这会带来帮助和很多包袱，我尝试添加一个文件`fooimpl.cpp`：

```
#include "foo.h"
#include "foo.cpp"

template int Foo::aMemberFunc<A>(int,int,int);
template int Foo::aMemberFunc<B>(int,int,int); 
```

然后编译`g++ fooimpl.cpp main.cpp foo.cpp`

这是根据 Dietmar 的建议（谢谢！），但是一旦我在上述技巧`void rand();`的标题中`foo.h`添加一个函数，就会产生这个错误：`void rand() {}``foo.cpp`

foo.cpp:(.text+0x0): `Foo::rand()' 的多重定义 /tmp/ccoCtGMk.o:fooimpl.cpp:(.text+0x0): 首先定义在这里

我该如何解决这个问题？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:32:39.907

您需要实例化您的函数，而不是专门化它：

```
#include "foo.h"
#include "foo.cpp"

template int Foo::aMemberFunc<A>(int,int,int);
template int Foo::aMemberFunc<B>(int,int,int); 
```

# vba - VBA 中的 XML 文本文件 - 删除记录

> ID：13059439
> 
> 赞同：1
> 
> 时间：2012-10-24T23:30:40.883
> 
> 标签：vba

> **可能重复：**
> [从 MS Project VBA 中的 XML 文件中删除节点](https://stackoverflow.com/questions/5506548/remove-a-node-from-xml-file-in-ms-project-vba)

这是我正在尝试编写的代码的伪代码：

```
Open WWID Exclusion List (csv file)
Open XML File

For Each WWID (WorldwideID) search and see if it is in the XML record
    IF EMPLOYEE found delete the EMPLOYEE XML

Save text File

Close text file 
```

我有一个结构类似于下图的 XML 文件：

```
<EMPLOYEE>
<WWID><![CDATA[10000001]]></WWID>
<EFFDT><![CDATA[06/02/2009]]></EFFDT>
<ACTION><![CDATA[]]></ACTION>
<ACTION_REASON><![CDATA[]]></ACTION_REASON>
<EMPL_CLASS><![CDATA[E]]></EMPL_CLASS>
<LOCATION><![CDATA[SC2]]></LOCATION>
<FIRST_NAME><![CDATA[FirstName]]></FIRST_NAME>
<LAST_NAME><![CDATA[LastName]]></LAST_NAME>
<MI><![CDATA[S]]></MI>
<NICKNAME><![CDATA[]]></NICKNAME>
<MGR_WWID><![CDATA[10000002]]></MGR_WWID>
<COST_CENTER><![CDATA[55555]]></COST_CENTER>
<EMPL_STATUS><![CDATA[R]]></EMPL_STATUS>
<HIRE_DT><![CDATA[02/09/1987]]></HIRE_DT>
<REHIRE_DT><![CDATA[]]></REHIRE_DT>
<TERMINATION_DT><![CDATA[06/01/2000]]></TERMINATION_DT>
<TITLE><![CDATA[Software Developer]]></TITLE>
<SHIFT><![CDATA[1]]></SHIFT>
<ORGUNIT><![CDATA[11111]]></ORGUNIT>
<FLSA><![CDATA[E]]></FLSA>
</EMPLOYEE> 
```

到目前为止的编码进展：

```
Sub Purge_Old_Records()

Dim sBuf As String
Dim sXMLBuf As String
Dim sTemp As String
Dim sXMLTemp As String
Dim iFileNum As Integer
Dim iXMLFileNum As Integer
Dim sFileName As String 'Name of exclusion file to Open
Dim sXMLFileName As String ' Name of XML file

' Select the XML & Exclusion files  

sXMLFileName = Application.GetOpenFilename(FileFilter:="Data Files (*.xml), *.xml, All Files(*.*), *.*", Title:="Select XML File")

sFileName = Application.GetOpenFilename(FileFilter:="Data Files (*.csv), *.csv, All Files(*.*), *.*", Title:="Select Exclusion File")

'Open & read XML file first
iXMLFileNum = FreeFile
Open sXMLFileName For Input As iXMLFileNum

Do Until EOF(iXMLFileNum)
Line Input #iXMLFileNum, sXMLBuf
sXMLTemp = sXMLTemp & sXMLBuf & vbCrLf
Loop
Close iXMLFileNum

'Open Exclusion List Second
iFileNum = FreeFile
Open sFileName For Input As iFileNum

Do Until EOF(iFileNum)
Line Input #iFileNum, sBuf
sTemp = sTemp & sBuf & vbCrLf
Loop
Close iFileNum 
```

需要有关如何编写代码以查找 WWID 并删除整个 EMPLOYEE 记录的帮助，而不仅仅是将其空白

```
sTemp = Replace(sTemp, "DIM A", vbCrLf)

'Save Revise file TXT file
iFileNum = FreeFile
sFileName = Application.GetSaveAsFilename(Title:="Select Output XML Filename")
Open sFileName For Output As iFileNum

Print #iFileNum, sTemp

Close iFileNum

End Sub 
```

非常感谢您的帮助！

# python - 如何在没有 tmp 存储的情况下将二进制数据通过管道传输到 numpy 数组中？

> ID：13059444
> 
> 赞同：7
> 
> 时间：2012-10-24T23:30:56.060
> 
> 标签：python, numpy, stdin, stringio

有几个类似的问题，但没有一个直接回答这个简单的问题：

如何在**不**创建要读取的临时字符串对象的情况下捕获命令输出并将该内容流式传输到 numpy 数组中？

所以，我想做的是：

```
import subprocess
import numpy
import StringIO

def parse_header(fileobject):
    # this function moves the filepointer and returns a dictionary
    d = do_some_parsing(fileobject)
    return d

sio = StringIO.StringIO(subprocess.check_output(cmd))
d = parse_header(sio)
# now the file pointer is at the start of data, parse_header takes care of that.
# ALL of the data is now available in the next line of sio
dt = numpy.dtype([(key, 'f8') for key in d.keys()])

# i don't know how do make this work:
data = numpy.fromxxxx(sio , dt)

# if i would do this, I create another copy besides the StringIO object, don't I?
# so this works, but isn't this 'bad' ?
datastring = sio.read()
data = numpy.fromstring(datastring, dtype=dt) 
```

我用 StringIO 和 cStringIO 尝试过，但 numpy.frombuffer 和 numpy.fromfile 都不接受它们。

使用 StringIO 对象，我首先必须将流读入字符串，然后使用 numpy.fromstring，但我想避免创建中间对象（几千兆字节）。

如果我可以将 sys.stdin 流式传输到 numpy 数组中，对我来说另一种选择是，但这也不适用于 numpy.fromfile （需要实现搜索）。

有什么解决方法吗？我不能成为第一个尝试这个的人（除非这是一个 PEBKAC 案例？）

解决方案：这是目前的解决方案，它混合了unutbu的说明如何使用Popen with PIPE和eryksun的提示使用bytearray，所以我不知道该接受谁！？:S

```
proc = sp.Popen(cmd, stdout = sp.PIPE, shell=True)
d = parse_des_header(proc.stdout)
rec_dtype = np.dtype([(key,'f8') for key in d.keys()])
data = bytearray(proc.stdout.read())
ndata = np.frombuffer(data, dtype = rec_dtype) 
```

我没有检查数据是否真的没有创建另一个副本，不知道如何。但是我注意到这比我以前尝试过的所有方法都快得多，非常感谢两位答案的作者！

2022 年更新：我刚刚尝试了上面没有 bytearray() 步骤的解决方案步骤，它工作正常。感谢Python 3，我猜？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T05:20:10.787

您可以`Popen`使用`stdout=subprocess.PIPE`. 读入标题，然后将其余部分加载到 a`bytearray`以与`np.frombuffer`.

基于您的编辑的其他评论：

如果您要调用`proc.stdout.read()`，则相当于使用`check_output()`。两者都创建一个临时字符串。如果你预先分配`data`，你可以使用`proc.stdout.readinto(data)`. 然后，如果读入的字节数`data`小于`len(data)`，则释放多余的内存，否则扩展`data`剩下的要读取的内容。

```
data = bytearray(2**32) # 4 GiB
n = proc.stdout.readinto(data)
if n < len(data):
    data[n:] = ''        
else:
    data += proc.stdout.read() 
```

您也可以从预先分配`ndarray` `ndata`和使用开始`buf = np.getbuffer(ndata)`。然后`readinto(buf)`如上。

这是一个示例，显示内存在`bytearray`和 之间共享`np.ndarray`：

```
>>> data = bytearray('\x01')
>>> ndata = np.frombuffer(data, np.int8)
>>> ndata
array([1], dtype=int8)
>>> ndata[0] = 2
>>> data
bytearray(b'\x02') 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T01:10:52.807

由于您的数据可以轻松放入 RAM，因此我认为将数据加载到 numpy 数组中的最简单方法是使用[ramfs](http://www.linux-mag.com/cache/7388/1.html)。

在 Linux 上，

```
sudo mkdir /mnt/ramfs
sudo mount -t ramfs -o size=5G ramfs /mnt/ramfs
sudo chmod 777 /mnt/ramfs 
```

然后，例如，如果这是二进制数据的生产者：

**作家.py：**

```
from __future__ import print_function
import random
import struct
N = random.randrange(100)
print('a b')
for i in range(2*N):
    print(struct.pack('<d',random.random()), end = '') 
```

然后你可以像这样将它加载到一个 numpy 数组中：

**阅读器.py：**

```
import subprocess
import numpy

def parse_header(f):
    # this function moves the filepointer and returns a dictionary
    header = f.readline()
    d = dict.fromkeys(header.split())
    return d

filename = '/mnt/ramfs/data.out'
with open(filename, 'w') as f:  
    cmd = 'writer.py'
    proc = subprocess.Popen([cmd], stdout = f)
    proc.communicate()
with open(filename, 'r') as f:      
    header = parse_header(f)
    dt = numpy.dtype([(key, 'f8') for key in header.keys()])
    data = numpy.fromfile(f, dt) 
```

# python - 一个环境变量可用于 python 子进程，另一个不可用

> ID：13059448
> 
> 赞同：1
> 
> 时间：2012-10-24T23:31:15.320
> 
> 标签：python, bash, environment-variables

分配多行字符串`FOO`按预期工作：

```
$ read -d '' FOO <<"EOF"
> the content
> EOF
$ echo $FOO
the content
$ python -c "import os; print os.environ.get('FOO')"
the content 
```

看似相同的事情却有`FOO_BAR_BAZ`不同的工作方式：

```
$ read -d '' FOO_BAR_BAZ <<"EOF"
> the content
> EOF
$ echo $FOO_BAR_BAZ
the content
$ python -c "import os; print os.environ.get('FOO_BAR_BAZ')"
None 
```

我要么有一个微妙的错误，要么有误解。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:33:02.670

你有`export FOO`没有`export FOO_BAR_BAZ`？环境变量只有在被导出后才对子进程（如 Python）可见。

# java - 在谷歌应用引擎（java）中动态创建数据存储索引

> ID：13059452
> 
> 赞同：0
> 
> 时间：2012-10-24T23:31:37.257
> 
> 标签：java, google-app-engine, google-cloud-datastore

是否可以在生产数据存储中动态创建索引？我想对可以动态添加属性的数据进行一些查询。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T06:12:54.080

您不能从代码中“即时”创建索引。您可以做的是您可以将新索引添加到您的索引配置（Java 中的 datastore-indexes.xml），并重新部署您的应用程序。

如果您不能或不想为新索引重新部署应用程序，则只能使用应用引擎 SDK 更新索引配置：

```
./appengine-java-sdk/bin/appcfg.sh update_indexes myapp/war 
```

或者

```
appengine-java-sdk/bin/appcfg.cmd update_indexes myapp/war 
```

注意：您还可以使用新索引部署不同版本的应用程序，因为索引在不同版本之间共享。

# java - Java Applet 在 IE8 中不起作用

> ID：13059465
> 
> 赞同：0
> 
> 时间：2012-10-24T23:33:11.533
> 
> 标签：java, internet-explorer-8, applet

Java Applet 在 Internet Explorer 8 中不工作。它只是显示空白屏幕。可能是因为 IE8 的安全限制。

这个问题有什么解决办法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-02T13:29:00.827

我们在 Kronos 上使用 1.6_33，我们现在有一台电脑，登录后会出现空白页。我们安装了 7_25 并运行该应用程序，直到我们收到它要求使用旧版本 6_33 的提示。单击运行，应用程序运行后，我们卸载了 7_25，我们能够使用 6_33 打开应用程序。我们也认为这是一个安全设置，但不确定它是与 java 相关还是与 IE8 相关或两者兼而有之。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:41:41.837

您是否尝试重新安装 Java？重新安装 Java 后，如果 Internet Explorer 询问您是否要启用 Java 插件，请务必单击启用按钮。

如果你去 Internet Explorer->Tools->Options->Programs->Manage Addons（然后在组合框中选择 Show All Addons）是“Java Plug-In SSV Helper”和“Java Plug-In 2 SSV Helper”设置到“启用”？

托管小程序的站点是 Internet 站点还是 Intranet 站点？检查 Internet/Intranet Tools->Security->(Internet/Intranet)->Custom Level-> 的 IE 安全选项，确保“ActiveX 控件和插件”设置为“启用”。

请张贴定义小程序的 HTML 代码（标签）。

# css - 无法使用 @-moz-document url-prefix() 缩放正文标记中的字体

> ID：13059467
> 
> 赞同：0
> 
> 时间：2012-10-24T23:33:15.240
> 
> 标签：css, firefox, browser

我想将我的 mozilla 浏览器字体缩小 10%。
所以我的样式表中有以下代码：

```
body{   font-size: 62.5%; }
@-moz-document url-prefix() {
    body{   font-size: 56.25%; }
} 
```

但由于某种原因，它似乎没有做任何事情。

不过，对单个 div 的更改可以正常工作。例子：

```
#footer-links{  font-size: 1em; }
@-moz-document url-prefix(){
    #footer-links{  font-size: .9em; }
} 
```

我可能最终会为所有 div 这样做......
但我只是很困惑为什么上面的 body 设置不起作用。

**编辑：**

我也刚刚尝试过使用 html 标签：

```
@-moz-document url-prefix(){
   html{    font-size: 56.25%; }
} 
```

虽然这确实重新调整了字体，但它不是指定的大小，而是比原来的小得多。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T06:00:09.033

谢谢你的小提琴。

`rem`单位是根 em。也就是说，它们是根元素的字体大小。HTML 中的哪个是`html`，不是`body`. 所以改变字体大小`body`不会改变 a 的大小`rem`。

# ruby-on-rails - Rails - 使用关系模型跟踪用户的“行为”

> ID：13059478
> 
> 赞同：0
> 
> 时间：2012-10-24T23:34:20.797
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3

我正在构建一个数学练习应用程序。我想存储分成练习的问题，每个练习属于不同的部分。每个年级也有多个部分（总共 12 个年级）。

我如何跟踪用户的回答（操作）？例如，当用户浏览应用程序时，决定回答“Pre-K”年级“G”部分的练习“G1”中的问题 7，并提供我想要跟踪的正确答案，并在将来为他提供统计数据关于他的表现。

目前我的用户模型与问题之间没有联系，我想听听其他人关于解决这个问题的最有效方法（也许现在的模型完全错误）

这是现在具有 has_many、belongs_to 关系的模型图（稍后我将添加 'the_question':string 和 'answer':string 到问题模型中）： ![在此处输入图像描述](../Images/24eeb92ffeb328c339b218e2133e51c3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:23:12.930

我认为所缺少的只是一个`Answer`模型，它与用户相关联。

或者，您也可以在“父母”上定义关系`Question`。

```
class Grade < ActiveRecord::Base
  has_many :users, :through => :sections # optional. i.e. 'users that have answers in this grade'
end

class Section < ActiveRecord::Base
  has_many :users, :through => :exercises # optional
end

class Exercise < ActiveRecord::Base
  has_many :users, :through => :questions # optional
end

class Question < ActiveRecord::Base
  has_many :answers
  has_many :users, :through => :answers # optional
end

class Answer < ActiveRecord::Base
  belongs_to :question
  belongs_to :user
end

class User < ActiveRecord::Base
  has_many :answers
end 
```

更新：重新阅读您的描述，我认为`CorrectAnswer`会比`Answer`.

# javascript - 在javascript中生成透明圆圈（客户端）

> ID：13059482
> 
> 赞同：0
> 
> 时间：2012-10-24T23:35:23.127
> 
> 标签：javascript, image, png, transparent

我正在实施例程以在 Google 地图 api 中为标记显示不同大小的图标，如本页所示： [https](https://developers.google.com/academy/apis/maps/visualizing/earthquakes) ://developers.google.com/academy/apis/maps/visualizing/earthquakes （查看圆圈示例):

```
window.eqfeed_callback = function(results) {
  for (var i = 0; i < results.features.length; i++) {
    var earthquake = results.features[i];
    var coords = earthquake.geometry.coordinates;
    var latLng = new google.maps.LatLng(coords[1],coords[0]);
    var marker = new google.maps.Marker({
      position: latLng,
      map: map,
      icon: getCircle(earthquake.properties.mag)
    });
  }
}

function getCircle(magnitude) {
  return {
    path: google.maps.SymbolPath.CIRCLE,
    fillColor: 'red',
    fillOpacity: .2,
    scale: Math.pow(2, magnitude) / Math.PI,
    strokeColor: 'white',
    strokeWeight: .5
  };
} 
```

在 chrome 中一切正常，但是当我在 IE9 中执行此操作时，它对于许多标记来说非常缓慢。它必须在 IE9 中，因为我在我的应用程序中自动化 IE9）。那是因为 IE9 在 SVG 上运行速度很慢。所以我正在尝试一种不同的方法，使用图标而不是 SVG 生成的圆圈。为此，我需要使用 JS（我的项目中没有服务器代码）即时生成它们，然后将圆圈保存到磁盘并将它们分配给标记。

如何仅使用 JS 生成圆圈并将其保存为透明 PNG？

# vb.net - VB.net返回带有文件夹路径的字符串

> ID：13059483
> 
> 赞同：2
> 
> 时间：2012-10-24T23:35:25.797
> 
> 标签：vb.net, file, filepath

我的程序需要读取软件供应商发送给我的 XML 文件才能完成流程。问题是我无法告诉程序文件所在的位置！

当我发布程序并安装程序时，它每次安装时都会生成一个随机文件夹位置相同的文件夹名称总是不同的

> C:\Users\Ray\AppData\Local\Apps\2.0\6ZNVVG8V.C6O\0MELQPL9.LCB\lol-..tion_531c8308fa0ff83d_0001.0000_5a2aee0cd0a667c1

我已经想出了如何通过这样做来显示该文件夹

```
Dim resourcePath As String = _
    System.IO.Path.GetFullPath(My.Resources.ResourceManager.BaseName)
Dim rIndex As Integer = resourcePath.LastIndexOf("\")
resourcePath = resourcePath.Substring(0, rIndex)
Dim filePath As String = System.IO.Path.Combine(resourcePath, "Client.xml") 
```

但是该程序创建了第二个文件夹，它将 XML 和 ICOn 文件放在随机生成的但在同一目录中。

如何让程序在该文件夹中查找 xml？

请帮我 ！

射线

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T11:21:40.570

get list of all files by filter

```
 lblPaymentMode.Location = New Point(lblDate.Right - lblPaymentMode.Width, lblPaymentMode.Location.Y)
    Dim mFiles() As String = Directory.GetFiles("Path of folder", "*.xml", SearchOption.AllDirectories)
    For i As Integer = 0 To mFiles.Count - 1
        Debug.Print(mFiles(i)) 'print name and path of of each file
    Next 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T02:34:11.967

你可以这样做：

```
Dim query = _
    From d In System.IO.Directory.GetDirectories(resourcePath)
    Let f = New FileInfo(System.IO.Path.Combine(d, "Client.xml"))
    Where f.Exists
    select f.FullName

Dim filePath = query.FirstOrDefault() 
```

# java - 使用预先存在的值初始化哈希图？

> ID：13059484
> 
> 赞同：1
> 
> 时间：2012-10-24T23:35:39.690
> 
> 标签：java

如果我有一个`int[] array = {1, 2, 3}`并且我想用下面的值初始化哈希图，有没有更好的方法呢？

```
Map<Integer,Boolean> map = new HashMap<Integer,Boolean>();
            map.put(1,false);
            map.put(2,false);
            map.put(3,false); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-24T23:36:39.187

```
for (int i: array) {
    map.put(i, false);
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:50:24.907

如果你使用[番石榴](https://code.google.com/p/guava-libraries/)，

```
ImmutableMap.of(1, false, 2, false, 3, false); 
```

或者，

```
ImmutableMap.builder().put(1, false).put(2, false).put(3, false).build() 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-24T23:42:31.463

另一种初始化方法是：

```
Map<Integer,Boolean> map =  new HashMap<Integer, Boolean>() {
                            {
                                put(1,false);
                                put(2,false);
                                put(3,false);
                            } 
```

# objective-c - 在 ViewController 被解除后，transitionWithView 被重复调用

> ID：13059487
> 
> 赞同：0
> 
> 时间：2012-10-24T23:35:56.473
> 
> 标签：objective-c, uiview, objective-c-blocks, quartz-graphics

这是在`ModalViewController`使用`StoryBoard`和`ARC`

当我关闭视图时，我看到这条线...... `NSLog(@"%d %@",[imgArray count],fileName);`被一遍又一遍地打印。

`transitionWithView/animateWithDuration`视图被关闭时如何杀死功能？

遗漏了一些非常关键的东西！

**。H**

```
#import <UIKit/UIKit.h>

@interface InfoVC : UIViewController

@property (weak, nonatomic) IBOutlet UIImageView *imageview;
@property (weak, nonatomic) IBOutlet UIScrollView *scrollview;

@end 
```

**.m**

```
#import "InfoVC.h"
#import <QuartzCore/QuartzCore.h>

@interface InfoVC ()

@end

@implementation InfoVC {
    int randomInt;
    NSArray *imgs;
    NSMutableArray *imgArray;
    NSTimer *myTimer;
    NSTimer *myTimer2;
    NSString *currentImg;
}

- (void)viewDidLoad
{
    [super viewDidLoad];
    imgs = [NSArray arrayWithObjects:
                      @"01.jpg",
                      @"02.jpg",
                      @"03.jpg",
                      nil];
    imgArray = [imgs mutableCopy];
    [self initialImage];
}

- (void)initialImage
{
    _imageview.contentMode = UIViewContentModeLeft;

    int rnd = [imgArray count];
    randomInt = (arc4random()%rnd);
    currentImg = [imgArray objectAtIndex:randomInt];    
    UIImage *image = [UIImage imageNamed:currentImg];

    [_imageview setImage:image];
    _imageview.bounds = CGRectMake(0, 0, image.size.width, image.size.height);

    _scrollview.contentSize = image.size;
    _scrollview.contentOffset = CGPointMake(-150.0, 0.0);

    [imgArray removeObjectAtIndex: randomInt];

    [self animate];
}

- (void)randomImage
{        
    if ([imgArray count]==0) {
        imgArray = [imgs mutableCopy];
    }

    int rnd = [imgArray count];
    randomInt = (arc4random()%rnd);
    NSString *fileName = [imgArray objectAtIndex:randomInt];

    NSLog(@"%d %@",[imgArray count],fileName);

    [imgArray removeObjectAtIndex: randomInt];

    UIImage * toImage = [UIImage imageNamed:fileName];

    void (^completion)(void) = ^{
        [self animate];
    };

    [UIView transitionWithView:self.view
                      duration:1.75f
                       options:UIViewAnimationOptionTransitionCrossDissolve | UIViewAnimationOptionAllowUserInteraction
                    animations:^
                    {
                        _imageview.image = toImage;
                    }
                    completion:^(BOOL finished)
                    {
                        completion();
                    }
    ];

}

- (void)animate{

    CGPoint offset = _scrollview.contentOffset;

    float flt = 150.0;

    if (_scrollview.contentOffset.x == flt)
    {
        offset.x = 0.0 ;
    }
    else
    {
        offset.x = flt ;
    }

    void (^completion2)(void) = ^{
        [self randomImage];
    };

    [UIView animateWithDuration:5.0 delay:0 options:UIViewAnimationOptionAllowUserInteraction | UIViewAnimationCurveEaseIn
                     animations:^{
                         _scrollview.contentOffset = offset; 
                     }completion:^(BOOL completed){
                         completion2();
                     }
     ];

}

- (void)viewDidUnload
{
    [super viewDidUnload];

    [_scrollview.layer removeAllAnimations];
    [_imageview.layer removeAllAnimations];
}

- (IBAction)dismissInfo:(id)sender
{
    [_scrollview.layer removeAllAnimations];
    [_imageview.layer removeAllAnimations];

    [self dismissModalViewControllerAnimated:YES];
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-09T10:19:55.073

我尝试使用大量的复古配件`transitionWithView`，`CABasicAnimation`使用`NSTimer`等。

最后我只是做了：

```
[_imageview removeFromSuperview]; 
```

当驳回观点时，一切都很好。

但是从这里的其他帖子看来，在将 alpha 转换应用于 a 时出现了一个错误`UIScrollview`- 当它是透明的时，对视图的引用会丢失。

# function - 查找表中元素的每个组合（Lua/PseudoCode）

> ID：13059491
> 
> 赞同：7
> 
> 时间：2012-10-24T23:36:17.190
> 
> 标签：function, data-structures, recursion, matrix, lua

我正在尝试使用表中元素的每一个组合来执行一个函数。（在 Lua 中）。表格和元素可以更改，但结构将保持不变。该表的组织方式使得其中的 [1] 将是函数的第一个参数，依此类推。

如果这是我有的桌子，

```
Table = {
    [1] = {Player1, Player2}
    [2] = {PlayerA, PlayerB, PlayerC}
    [3] = {PlayerOne, PlayerTwo}
} 
```

如果我手动写出来，它可能看起来像这样：（假设该函数名为 Exe）。

```
Exe(Player1, PlayerA, PlayerOne)
Exe(Player2, PlayerA, PlayerOne)
Exe(Player3, PlayerA, PlayerOne)

Exe(Player1, PlayerB, PlayerOne)
Exe(Player2, PlayerB, PlayerOne)
Exe(Player3, PlayerB, PlayerOne)

Exe(Player1, PlayerC, PlayerOne)
Exe(Player2, PlayerC, PlayerOne)
Exe(Player3, PlayerC, PlayerOne)

Exe(Player1, PlayerA, PlayerTwo)
Exe(Player2, PlayerA, PlayerTwo)
Exe(Player3, PlayerA, PlayerTwo)

Exe(Player1, PlayerB, PlayerTwo)
Exe(Player2, PlayerB, PlayerTwo)
Exe(Player3, PlayerB, PlayerTwo)

Exe(Player1, PlayerC, PlayerTwo)
Exe(Player2, PlayerC, PlayerTwo)
Exe(Player3, PlayerC, PlayerTwo) 
```

但是，我不想把它写出来，这违反了我的一般经验法则，即如果您在程序中复制和粘贴，那么您做错了。

所以相反，我想浏览表格并执行每一个可能的组合。问题是表格可以（可能）在其中包含任意数量的表格，并且表格内部的表格可能具有无限数量的值。

例如，表格最终可能如下所示：

```
Table = {
    [1] = {Player1, Player2}
    [2] = {PlayerA}
    [3] = {PlayerOne}
} 
```

在其中手动执行最终会像这样：

```
Exe(Player1, PlayerA, PlayerOne)
Exe(Player2, PlayerA, PlayerOne) 
```

此外，该表可能会像这样结束：

```
Table = {
    [1] = {Player1, Player2}
    [2] = {PlayerA}
    [3] = {PlayerOne}
    [4] = {PlayerUno, PlayerDos}
    [5] = {PlayerApple, PlayerBoy, PlayerCat, PlayerDog}
} 
```

执行最终会像..

```
Exe(Player1, PlayerA, PlayerOne, PlayerUno, PlayerApple)
Exe(Player2, PlayerA, PlayerOne, PlayerUno, PlayerApple)

Exe(Player1, PlayerA, PlayerOne, PlayerDos, PlayerApple)
Exe(Player2, PlayerA, PlayerOne, PlayerDos, PlayerApple)

Exe(Player1, PlayerA, PlayerOne, PlayerUno, PlayerBoy)
Exe(Player2, PlayerA, PlayerOne, PlayerUno, PlayerBoy)

Exe(Player1, PlayerA, PlayerOne, PlayerDos, PlayerBoy)
Exe(Player2, PlayerA, PlayerOne, PlayerDos, PlayerBoy)

Exe(Player1, PlayerA, PlayerOne, PlayerUno, PlayerCat)
Exe(Player2, PlayerA, PlayerOne, PlayerUno, PlayerCat)

Exe(Player1, PlayerA, PlayerOne, PlayerDos, PlayerCat)
Exe(Player2, PlayerA, PlayerOne, PlayerDos, PlayerCat)

Exe(Player1, PlayerA, PlayerOne, PlayerUno, PlayerDog)
Exe(Player2, PlayerA, PlayerOne, PlayerUno, PlayerDog)

Exe(Player1, PlayerA, PlayerOne, PlayerDos, PlayerDog)
Exe(Player2, PlayerA, PlayerOne, PlayerDos, PlayerDog) 
```

如您所见，我找到了一种模式......我能够将上面的“执行”内容划分为段/组，例如第 1 行和第 2 行有一个变化。然后，它们被复制到第 4 行和第 5 行，但下一个变量 get 已更改。

如您所见，我无法将该模式放入代码中。我认为将需要一些函数递归，但我不知道如何将它拉下来或通过它递归。我在想我必须使用带有 ... 作为参数的函数和 unpack 函数，但我不确定这将如何工作。

此外，之所以需要这样做，而不仅仅是手动复制和粘贴它（这实际上会更容易），是因为将生成表格的内容。

你们能帮帮我吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T00:01:26.993

使用递归。

想象一个函数`map_all (fcn, tab, idx, ...)`，它映射到所有表元素的`fcn`乘积`tab[1]``tab[idx]``...`

基本情况是何时`idx`小于 1。在这种情况下，只需应用`fcn(...)`

否则，对于`map_all(fcn, tab, idx-1, <el>, ...)`所有`<el>``tab[idx]`

```
function map_all (fcn, tab, idx, ...)
    if idx < 1 then
        fcn(...)
    else
        local t = tab[idx]
        for i = 1, #t do map_all(fcn, tab, idx-1, t[i], ...) end
    end
end 
```

所以，

```
> Table = {
>>     [1] = {'Player1', 'Player2'},
>>     [2] = {'PlayerA', 'PlayerB', 'PlayerC'},
>>     [3] = {'PlayerOne', 'PlayerTwo'}
>> }
> map_all(print, Table, #Table)
Player1 PlayerA PlayerOne
Player2 PlayerA PlayerOne
Player1 PlayerB PlayerOne
Player2 PlayerB PlayerOne
Player1 PlayerC PlayerOne
Player2 PlayerC PlayerOne
Player1 PlayerA PlayerTwo
Player2 PlayerA PlayerTwo
Player1 PlayerB PlayerTwo
Player2 PlayerB PlayerTwo
Player1 PlayerC PlayerTwo
Player2 PlayerC PlayerTwo 
```

和

```
> Table = {
>>     [1] = {'Player1', 'Player2'},
>>     [2] = {'PlayerA'},
>>     [3] = {'PlayerOne'}
>> }
> map_all(print, Table, #Table)
Player1 PlayerA PlayerOne
Player2 PlayerA PlayerOne 
```

和

```
> Table = {
>>     [1] = {'Player1', 'Player2'},
>>     [2] = {'PlayerA'},
>>     [3] = {'PlayerOne'},
>>     [4] = {'PlayerUno', 'PlayerDos'},
>>     [5] = {'PlayerApple', 'PlayerBoy', 'PlayerCat', 'PlayerDog'},
>> }
> map_all(print, Table, #Table)
Player1 PlayerA PlayerOne   PlayerUno   PlayerApple
Player2 PlayerA PlayerOne   PlayerUno   PlayerApple
Player1 PlayerA PlayerOne   PlayerDos   PlayerApple
Player2 PlayerA PlayerOne   PlayerDos   PlayerApple
Player1 PlayerA PlayerOne   PlayerUno   PlayerBoy
Player2 PlayerA PlayerOne   PlayerUno   PlayerBoy
Player1 PlayerA PlayerOne   PlayerDos   PlayerBoy
Player2 PlayerA PlayerOne   PlayerDos   PlayerBoy
Player1 PlayerA PlayerOne   PlayerUno   PlayerCat
Player2 PlayerA PlayerOne   PlayerUno   PlayerCat
Player1 PlayerA PlayerOne   PlayerDos   PlayerCat
Player2 PlayerA PlayerOne   PlayerDos   PlayerCat
Player1 PlayerA PlayerOne   PlayerUno   PlayerDog
Player2 PlayerA PlayerOne   PlayerUno   PlayerDog
Player1 PlayerA PlayerOne   PlayerDos   PlayerDog
Player2 PlayerA PlayerOne   PlayerDos   PlayerDog
> 
```

# arrays - ARM 汇编中的最大整数

> ID：13059494
> 
> 赞同：2
> 
> 时间：2012-10-24T23:36:26.583
> 
> 标签：arrays, integer, arm

这是一个家庭作业问题，但我被卡住了。

任务是找到数组中的最大整数。这是我们得到的 C 代码：

```
#include <stdio.h>
#include <stdlib.h>

extern int mybig( int array[] ) ;

void main( char * argv[], int argc )
{
int array[] = { 5, 15, 100, 25, 50, -1 } ;

int biggest ;

biggest = mybig( array ) ;

printf( "Biggest integer in array: %d\n", biggest ) ;

} 
```

到目前为止，我已经制作了大约十几个版本的程序集，但这是我得到的最接近的版本

```
.global mybig
 mybig:  stmfd sp!, {v1-v6, lr}
    mvn v1, #0
 loop:  ldrb a4, [a1], #4
    MOVLT a4, a1
    cmp a1, v1
    bne loop
    ldmfd sp!, {v1-v6, pc}
    .end 
```

每次我将它链接在一起时，我都会遇到一个无限循环，我不知道为什么。任何帮助将不胜感激，教授在入门课程中没有教我们任何东西，只是告诉我们去做，并给了我们一个工具链的链接来编译和组装。

编辑：这就是我到达的地方。程序没有运行，只是进入了一个无限循环。

```
 .global mybig
mybig:  stmfd sp!, {v1-v6, lr}
    mvn v1, #0
    mov a3, a1
loop:   ldr a4, [a1], #4
    cmp a4, a1
    MOVMI a3, a1
    cmp a1, v1
    bne loop
    mov a1, a4
    ldmfd sp!, {v1-v6, pc}
    .end 
```

C代码没有改变

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:23:55.220

那将是我的解决方案：

```
.global mybig
 mybig:
   // a1 = Highest word, defaults to 0x80000000 = −2,147,483,648
   // a2 = Pointer to array
   // a3 = current word
    mov a2, a1
    mov a1, #0x80000000
 .Lloop:
    ldr   a3, [a2], #4 // Load word and advance pointer by 4 bytes
    cmn   a3, #1       // Compare with -1
    bxeq  lr           // Return if endmarker was found
    cmp   a1, a3       // Compare current highest word and new word
    movlt a1, a3       // Replace highest word if it was smaller
    b     .Lloop       // Loop again
    .end 
```

虽然就性能而言这不是最好的代码，但它应该是自我解释的。

# javascript - Javascript-OpenERP：修改/替换 POS 模板视图

> ID：13059495
> 
> 赞同：1
> 
> 时间：2012-10-24T23:36:29.873
> 
> 标签：javascript, openerp

所以基本上，我试图从 6.1 版开始对 OpenERP 的 POS 接口进行修改。我看到这个视图的布局可以在 /static/src/xml/pos.xml 找到。我想要的是从我自己的插件修改这个视图（因此，不改变原来的 pos 插件），据我所知，没有办法继承这个视图来添加更改（或者是否存在？）。因此，在研究了该模块之后，我试图覆盖它的 js 函数，以便在我自己的 pos.xml 中进行所有修改（原始 pos.xml 的副本，但名称为“PointOfSale_Mine”和其他修改）。到目前为止，我已经添加了自己的 .js，如下所示：

```
openerp.my_pos = function(db) {

db.point_of_sale.PointOfSale = db.point_of_sale.PointOfSale.extend({

    render: function() {
        this._super.apply(this,arguments);
        return qweb_template("PointOfSale_Mine")();

        //return this._super.qweb_template("PointOfSale_Mine")();
        //return db.point_of_sale.qweb_template("PointOfSale_Mine")();
        }
    })

}; 
```

当然，由于我的 JS 技能，我收到错误“qweb_template is not defined”，而且我对 OpenERP6.1 的新 Web 框架的了解非常有限。我真的很想知道如何调用原始“渲染”函数调用的相同方法（您可以在上面的代码中看到我的无用尝试）。或者我的整个方法是错误的，并且有更好的方法将我的更改引入模板？

提前致谢。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-29T16:13:00.567

好的。经过一些试验和错误后，我想出了这个代码来解决这个问题：

```
openerp.my_pos = function(db) {

db.point_of_sale.PointOfSale = db.point_of_sale.PointOfSale.extend({

    render: function() {
        var rend = this._super();

        var jdoc = $(rend);
        jdoc.find('.pos-payment-container').prepend('<input type="text" value=""/>')

        return jdoc[0].outerHTML;
        }
    })

}; 
```

它不会像我最初尝试的那样替换整个 pos.xml 模板，但它可能会更好，因为您继承当前模板并仅引入您的修改（即使您必须*.prepend()*一大块 html 代码）

# html - 无论窗口大小如何，如何在所有浏览器中平等地定位表单元素。

> ID：13059496
> 
> 赞同：0
> 
> 时间：2012-10-24T23:36:31.053
> 
> 标签：html, css

这是我的表单代码：

```
<td align="center" style=" width=50%; height=50%; background: url(images/side.gif) repeat-x ;">
<img src="images/iphone.gif" width="670" height="549" alt="">
<img style="position:fixed; left:280px; bottom:50px;"src="spr2.png" width="2%" height="15%" alt="">
<form style="display:inline-block;" method="POST" action="index.php">
<label style="position:fixed; left: 200px; bottom: 130px;">: اسم المستخدم</label>
<input style="position:fixed; left:50px; bottom:130px;" type="text" name="username" size="20"><br>
<label style="position:fixed; left:200px; bottom:100px;">: كلمة المرور</label>
<input style="position:fixed; left:50px; bottom:100px;" type="password" name="password" size="20"><br>
<input style="position:fixed; left:50px; bottom:60px;" type="submit" value=" تسجيل دخول ">
</form>
</td> 
```

以下是来自不同浏览器的屏幕截图：

![在此处输入图像描述](../Images/61b07419279f629c3e78ac603bc4ee60.png)

当我调整窗口大小时，元素会改变位置：

![在此处输入图像描述](../Images/04a761be06dbae010ca8f8e032e784e8.png)

如何防止元素改变位置和宽度？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:49:22.323

您在页面上定位元素的方式忽略了相对定位的正常流程。通过指定`left: 200px;`并且`position:fixed;`您说无论您的页面如何调整大小或滚动到哪里，元素将始终距离窗口左侧 200px。请注意，即使`<br>`您的文本框后面有标签，您仍然可以将标签直接放在它们的右侧。

使用相对定位 -`position:relative;`或者只是删除位置属性。然后使用填充和边距来分隔元素或浮动它们。如果它们没有在一行中水平显示，则将`display`属性更改为`inline-block`，并在标签上使用`clear:right;`或`<br>`在它们之后放置一个。

将您的样式放入外部文件中。

像这样的东西：http: [//jsfiddle.net/R7RRH/2/](http://jsfiddle.net/R7RRH/2/)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:21:49.987

对于宽度问题，请尝试使用`width`, 就像在[这个 JSFiddle](http://jsfiddle.net/nq7tK/4/)中一样。

```
<input type="text" style="width:200px;" size="20">
<input type="text" style="width:200px;" size="40">​ 
```

您的问题`position`可能源于您使用`fixed`. [相对定位中的绝对定位](http://css-tricks.com/absolute-positioning-inside-relative-positioning/)可能更像你想要的。

# javascript - 为不受支持的浏览器将 SVG 图像转换为 png - 后备 - modernizer.js(?)

> ID：13059502
> 
> 赞同：3
> 
> 时间：2012-10-24T23:37:05.117
> 
> 标签：javascript, html, svg, png, fallback

我正在考虑将`SVG`我网站上的一些图像`PNG`用于不`SVG`正确支持的浏览器。我主要遇到基于文本的问题`IE`（显示的字体完全错误），所以我想我会创建一个回退到`PNG`.

我已经尝试为此寻找一个不错的演练（我是一个自认的菜鸟），但我还没有设法让它全部工作。我相信我想使用[modernizer.js](http://modernizr.com/)来检查兼容性，然后提供不兼容的不同图像（？）

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-24T23:43:16.387

[Chris Coyier 在最新的Smashing Magazine CSS Q&A](http://coding.smashingmagazine.com/2012/10/15/css-qa-4/)中回答了这个确切的问题。

1.  下载简化为仅测试 SVG 的**Modernizr**版本（假设这是您需要的唯一测试）。
2.  运行测试。如果通过，则放入 SVG。如果失败，请放入位图。本质上：

示例（JS解决方案）：

```
if (!Modernizr.svg) {
    $("#logo").css("background-image", "url(fallback.png)");
} 
```

示例（CSS 解决方案）：

```
.no-svg #logo { background-image: url(fallback.png); } 
```

这应该只对 IE8 及以下版本是必需的。**我可以使用**完整[的浏览器支持表](http://caniuse.com/svg)。

谢谢克里斯！

# php - 结束会话，重置变量不起作用？

> ID：13059503
> 
> 赞同：2
> 
> 时间：2012-10-24T23:37:23.923
> 
> 标签：php, session, redirect, session-variables, logout

我正在编写一个脚本，该脚本应该结束用户的会话，并将它们从系统中注销，从而将它们返回到登录页面。

我的注销脚本如下所示：

```
<?php

$_SESSION['signin'] = null;

session_destroy();

header("Location: /test/index.php");

?> 
```

最初我以`signin`这种方式重置变量，即使会话没有被破坏，变量也应该至少发生变化，以便系统认为用户已注销。

在我的登录页面顶部，如果他们已经登录，我有一个条件将它们转发到主页，这样一旦已经登录就无法访问登录页面。这部分看起来像这样：

```
<?php
session_start();
if($_SESSION['signin'] == 5)
{
        header("Location: /test/home.php");
}
?> 
```

所以简而言之，当有人登录并单击链接注销时，它会利用第一个代码块注销，然后转发到包含第二个代码块的页面。

然而，这个页面仍然让我回到主页，相信用户仍然登录，因此我猜测登录变量没有重置。

关于如何解决我的问题的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:50:15.060

session_destroy() 不会取消设置会话中的任何全局变量。只需使用：

```
session_unset(); 
```

要取消设置所有全局变量，或仅取消设置指定变量，请使用：

```
unset($_SESSION['signin']); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:38:57.293

你可以尝试这样的事情。

```
session_unset() 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:40:52.367

你不必使用

```
$_SESSION['signin'] = null; 
```

使用`session_destroy();`应该足够了

而且我不完全了解 PHP 的深层内容，但是如果您将 $_SESSION 变量设置为 NULL，PHP 可以读取它，因为它设置为 NULL，这意味着“它已设置”？（虽然不确定）

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-24T23:41:57.200

在这种情况下，如果你想销毁一个变量，你可以这样做：有一个名为 logout.php 的页面，当用户需要注销时，将他/她重定向到该页面。现在，在该页面中，您将输入以下内容，在这里我将向您解释它的作用：

```
<?php
session_start(); //Initializes the session
unset($_SESSION['thenameofyoursession']); //This unsets a specific session, so the user is logged out, in this case it would unset "thenameofyoursession".
$URL="/test/home.php"; //This is the redirect URL
header ("Location: $URL"); //This basically will send the user back to the redirect URL using header.
die(); //terminates the PHP script from running
?> 
```

有了这个，你应该没问题。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-24T23:57:42.750

您的程序相当明显并且与我们使用的程序相似，但是，`unset()`如果其中没有任何内容是有效的，那么最好是整个会话。-- 如果他们没有登录，则不应该存在会话变量。

**我的`logout.php`脚本包括：**

```
session_start();

session_register("loginMessage");
session_unregister("authenticatedUser");
session_destroy();

// relocate back to login page
header("Location: /"); 
```

哪个有效。`session_unset()`历史上是多余的。

希望这可以帮助。

# php - 在php中按时间戳对推文进行排序

> ID：13059505
> 
> 赞同：1
> 
> 时间：2012-10-24T23:37:42.533
> 
> 标签：php, api, sorting, twitter

我正在为班级组织一个项目，该项目与连续聚合推文有关，以创建一个线性的众包故事。我目前有一个半工作程序，问题是程序首先显示最新的推文 - 我需要对这些推文进行排序，以使它们按时间戳显示，从最早到最新。这是代码：

```
<?php
$url = 'http://search.twitter.com/search.json?q=%23tweetstoryproj&lang=en&rpp=100';
$jsontwitter = file_get_contents($url);
$twitter = json_decode($jsontwitter, true);

$twittertext = $twitter["results"];
foreach($twittertext as $text){
    $text = str_replace("#tweetstoryproj", "", $text);
    echo $text['text'].'';
}

?> 
```

非常感谢您的帮助，如果您想为故事做出贡献，请在推特上添加标签：#tweetstoryproj

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:42:25.453

简单的！（他说）只需使用[array_reverse](http://php.net/manual/en/function.array-reverse.php)

在 foreach 之前添加这一行

```
$twittertext = array_reverse($twittertext); 
```

享受！

替代方案：如果数组变得很大，翻转它然后遍历它可能需要更长的时间，所以你可以使用“ [for](http://uk3.php.net/manual/en/control-structures.for.php) ”循环并因此向后移动。

```
for($i=$count($twittertext);$i>-1;$i--) //It's late that may miss the last or the first entry, have a fiddle!
{
  // echo here
} 
```

# extjs - ExtJS 4：防止组合框在页面（或表单）加载时打开自动完成列表

> ID：13059510
> 
> 赞同：1
> 
> 时间：2012-10-24T23:38:13.847
> 
> 标签：extjs, autocomplete, combobox, extjs4, onload

当我的应用程序启动时，组合框正在拉出结果（扩展）并专注于表单中的组合框。当应用程序启动时，如何防止自动聚焦和扩展此组合框？请注意，我尝试将配置“selectOnFocus”设置为 true 和 false，但这并没有做任何事情。

```
 width: 540,
                    labelAlign: 'right',
                    xtype: 'combo',
                    fieldLabel: 'Table',
                    emptyText: 'keyword search by table name...',
                    store: tableStore,
                    valueField: 'id',
                    displayField: 'value',
                    mode: 'remote',
                    name: 'table',
                    autoSelect: false,
                    selectOnFocus: true,
                    //shadow:true,
                    //forceSelection: true,
                    //triggerAction: 'all',
                    hideTrigger: true,
                    //multiSelect:true,
                    //typeAhead: true,
                    //minChars: 1,

                    listeners: {
                        change: function (obj, newValue, oldValue, eOpts) {
                            tableStore.proxy.extraParams.keyword = newValue;
                            tableStore.load();
                            this.expand();
                        }
                    }  // listeners 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:33:04.307

问题是您的“更改”侦听器是在表单加载时触发的。

你需要 this.expand() 调用吗？

# android - monkeyrunner - 尝试使用 view.getLocation() 时出现 ChimpException

> ID：13059512
> 
> 赞同：3
> 
> 时间：2012-10-24T23:38:29.530
> 
> 标签：android, jython, monkeyrunner

我有一个 monkeyrunner 脚本，它试图获取有关其中一个视图的一些信息，如下所示：

```
v = d.getViewById('id/search_progress_bar')
print dir(v)
for i in range(10):
    print 'about to call v.getLocation'
    print v.getLocation()
    m.sleep(1) 
```

这是 dir(v) 步骤的输出：

```
['__class__', '__delattr__', '__doc__', '__getattribute__', '__hash__', '__init__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__str__', 'getAccessibilityIds', 'getChecked', 'getChildren', 'getEnabled', 'getFocused', 'getLocation', 'getParent', 'getSelected', 'getText', 'getViewClass', 'setFocused', 'setSelected'] 
```

但是，当我尝试使用 v.getLocation() 方法时，我立即得到以下异常。

```
121024 16:30:26.373:S [main] [com.android.monkeyrunner.MonkeyRunnerOptions] Script terminated due to an exception
121024 16:30:26.373:S [main] [com.android.monkeyrunner.MonkeyRunnerOptions]Traceback (most recent call last):
  File "/Users/swolfe/svn/jython/progress_bar_testing.py", line 20, in <module>
    print v.getLocation()
    at com.android.chimpchat.ChimpManager.queryView(ChimpManager.java:414)
    at com.android.chimpchat.core.ChimpView.queryView(ChimpView.java:52)
    at com.android.chimpchat.core.ChimpView.getLocation(ChimpView.java:64)
    at com.android.monkeyrunner.MonkeyView.getLocation(MonkeyView.java:81)
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
    at java.lang.reflect.Method.invoke(Method.java:597)

com.android.chimpchat.core.ChimpException: com.android.chimpchat.core.ChimpException: No accessibility event has occured yet 
```

有人熟悉 ChimpChat 吗？我不明白这是 MonkeyRunner 的一些核心代码。可访问性和 MonkeyRunner 之间是什么关系，为什么它抱怨尚未发生可访问性事件？我是否需要启动某种可访问性或检测服务？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T03:27:18.117

你说的对。它不起作用。但是，您可以使用实际有效的[AndroidViewClient](https://github.com/dtmilano/AndroidViewClient)，脚本将是：

```
vc = ViewClient(d, serialno)
v = vc.findViewByIdOrRaise('id/search_progress_bar')
print dir(v)
for i in range(10):
    print 'about to call v.getCoords'
    print v.getCoords()
    m.sleep(1) 
```

并打印出类似的东西

```
['_View__dumpWindowsInformation', '_View__obtainPxPy', '_View__obtainStatusBarDimensionsIfVisible', '_View__obtainVwVh', '_View__obtainVxVy', '__call__', '__doc__', '__getattr__', '__getitem__', '__init__', '__module__', '__smallStr__', '__str__', '__tinyStr__', 'add', 'allPossibleNamesWithColon', 'build', 'children', 'currentFocus', 'device', 'factory', 'getCenter', 'getClass', 'getCoords', 'getHeight', 'getId', 'getParent', 'getPositionAndSize', 'getText', 'getUniqueId', 'getVisibility', 'getWidth', 'getX', 'getXY', 'getY', 'intersection', 'map', 'parent', 'touch', 'windows']
about to call v.getCoords
((0, 157), (480, 229))
about to call v.getCords
((0, 157), (480, 229))
... 
```

我怀疑这是你的意图，除非你期待你的观点发生变化。

# ruby-on-rails-3 - 如何在解析期间从 tsv 文件中删除字符？

> ID：13059514
> 
> 赞同：0
> 
> 时间：2012-10-24T23:38:32.300
> 
> 标签：ruby-on-rails-3

我正在解析一个 tsv 文件并将其加载到 MySQL 中。我让它工作，然后发现 tsv 文件中有反斜杠被解释为换行符。我想在将数据发送到数据库之前从所有字段中删除 \。这是一个简短的示例，文件中有 300 列，其中许多列是空白的。

```
begin              
  CSV.foreach(file, :col_sep => "\t") do |row|
      row.map!{ |e| e.gsub(/\\/, '')} 
      d = Datafeed.new
      d.id = row[0]
      d.description = row[1]
      d.save!
  end
end 
```

当我运行这个例子时，我得到一个错误：undefined method `gsub' for nil:NilClass。我认为这个错误是由文件中的空白产生的。但是，当我尝试添加

```
row.map!{ |e| unless e.blank e.gsub(/\\/, '') } 
```

它不会执行，我得到一个意外的错误}。

这是消除反斜杠的正确方向吗？最好的方法是什么？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:51:11.093

该`unless`语句应遵循其他代码。这就是导致第二个错误的原因。尝试这个：

```
row.map!{ |e| e.gsub(/\\/, '') unless e.blank? } 
```

注意：该代码将变成`""`您`nil`所期望的，也可能不是您所期望的。

你的方法似乎很合理。

**编辑：**

要保留空白，您可以执行以下操作：

```
row.map!{ |e| e.blank? ? '' : e.gsub(/\\/, '') } 
```

或者如果这对你来说有点太多了，这个：

```
row.map! do |e|
  if e.blank?
    ''
  else
    e.gsub(/\\/, '')
  end
end 
```

# asp.net-mvc-3 - 实现一个RequiredIf 和RequiredIfNot 属性验证器，它依赖于两个值

> ID：13059520
> 
> 赞同：2
> 
> 时间：2012-10-24T23:40:14.270
> 
> 标签：asp.net-mvc-3

我需要实现一个RequiredIF 验证器，它依赖于两个值，一个复选框和一个从下拉列表中选择的值。如果可能的话，我需要类似的东西

```
 [RequiredIf("Property1", true,"Property2,"value", ErrorMessageResourceName = "ReqField", ErrorMessageResourceType = typeof(RegisterUser))] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2019-10-16T20:24:18.893

这是创建您自己的RequiredIf 和RequiredIfNot 自定义验证器的代码。如果要检查 2 个值，只需添加附加代码。

**必填**

```
public class RequiredIfAttribute : ValidationAttribute, IClientValidatable
{
    private readonly RequiredAttribute _innerAttribute = new RequiredAttribute();

    internal string _dependentProperty;
    internal object _targetValue;

    public RequiredIfAttribute(string dependentProperty, object targetValue)
    {
        _dependentProperty = dependentProperty;
        _targetValue = targetValue;
    }

    /// <summary>
    /// Returns if the given validation result is valid. It checks if the RequiredIfAttribute needs to be validated
    /// </summary>
    /// <param name="value">Value of the control</param>
    /// <param name="validationContext">Validation context</param>
    /// <returns></returns>
    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        var field = validationContext.ObjectType.GetProperty(_dependentProperty);
        if (field != null)
        {
            var dependentValue = field.GetValue(validationContext.ObjectInstance, null);
            if ((dependentValue == null && _targetValue == null) || (dependentValue.ToString() == _targetValue.ToString()))
            {
                if (!_innerAttribute.IsValid(value))
                {
                    return new ValidationResult(ErrorMessage);
                }
            }
            return ValidationResult.Success;
        }
        else
        {
            throw new ValidationException("RequiredIf Dependant Property " + _dependentProperty + " does not exist");
        }
    }

    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
    {
        var rule = new ModelClientValidationRule
        {
            ErrorMessage = ErrorMessageString,
            ValidationType = "requiredif",
        };
        rule.ValidationParameters["dependentproperty"] = (context as ViewContext).ViewData.TemplateInfo.GetFullHtmlFieldId(_dependentProperty);
        rule.ValidationParameters["desiredvalue"] = _targetValue is bool ? _targetValue.ToString().ToLower() : _targetValue;

        yield return rule;
    }
} 
```

**要求如果不是：**

```
public class RequiredIfNotAttribute : ValidationAttribute, IClientValidatable
{
    private readonly RequiredAttribute _innerAttribute = new RequiredAttribute();

    internal string _dependentProperty;
    internal object _targetValue;

    public RequiredIfNotAttribute(string dependentProperty, object targetValue)
    {
        _dependentProperty = dependentProperty;
        _targetValue = targetValue;
    }

    /// <summary>
    /// Returns if the given validation result is valid. It checks if the RequiredIfAttribute needs to be validated
    /// </summary>
    /// <param name="value">Value of the control</param>
    /// <param name="validationContext">Validation context</param>
    /// <returns></returns>
    protected override ValidationResult IsValid(object value, ValidationContext validationContext)
    {
        var field = validationContext.ObjectType.GetProperty(_dependentProperty);
        if (field != null)
        {
            var dependentValue = field.GetValue(validationContext.ObjectInstance, null);
            if ((dependentValue == null && _targetValue == null) || (dependentValue.ToString() != _targetValue.ToString()))
            {
                if (!_innerAttribute.IsValid(value))
                {
                    return new ValidationResult(ErrorMessage);
                }
            }
            return ValidationResult.Success;
        }
        else
        {
            throw new ValidationException("RequiredIfNot Dependant Property " + _dependentProperty + " does not exist");
        }
    }

    public IEnumerable<ModelClientValidationRule> GetClientValidationRules(ModelMetadata metadata, ControllerContext context)
    {
        var rule = new ModelClientValidationRule
        {
            ErrorMessage = ErrorMessageString,
            ValidationType = "requiredifnot",
        };
        rule.ValidationParameters["dependentproperty"] = (context as ViewContext).ViewData.TemplateInfo.GetFullHtmlFieldId(_dependentProperty);
        rule.ValidationParameters["desiredvalue"] = _targetValue is bool ? _targetValue.ToString().ToLower() : _targetValue;

        yield return rule;
    }
} 
```

**用法：** 在您的模型中使用以下 DataAnnotation。

```
[RequiredIf("IsRequired", true, ErrorMessage = "First Name is required.")] 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-01-06T07:38:38.773

您必须制作自定义验证器。这是实现这一目标的最佳方式。我希望这有助于[自定义验证器](https://stackoverflow.com/questions/16100300/asp-net-mvc-custom-validation-by-dataannotation)

# windows - 如何在 Windows XP、2000、Vista 和 7 中使用 NSIS 以编程方式安装屏幕保护程序？

> ID：13059526
> 
> 赞同：0
> 
> 时间：2012-10-24T23:41:12.240
> 
> 标签：windows, installation, nsis, screensaver

我已经尝试过但不起作用的解决方案是：

1) 将 ini 键添加到 $WINDIR\system.ini

```
[boot]
SCRNSAVE.EXE $SYSDIR\savername.scr 
```

2) 调用 user32.dll::SystemParametersInfo(17, 1, 0, 2)

以上适用于XP，但不适用于2000

```
rundll32.exe desk.cpl,InstallScreenSaver <path to screensaver> 
```

这种工作在 2000 年，但它会弹出一个配置对话框，然后当我回到对话框时，设置就消失了。

寻找适用于所有平台的解决方案或一组解决方案，不弹出配置屏幕，打开配置对话框时保留设置并且不需要第三方软件。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:15:41.067

有效的方法是将 INI 方法和此处找到的注册表方法相结合：[如何以编程方式更改屏幕保护程序？](https://stackoverflow.com/questions/8383589/how-do-i-change-the-screensaver-programatically). 这是 NSIS 代码：

```
!include WinVer.nsh

; Install the executable
${If} ${AtMostWinXP}
  SetOutPath "$SYSDIR"
  File screen.scr
${EndIf}
SetOutPath "$INSTDIR"
File screen.scr

; Set screensaver and make it active
${If} ${AtMostWinXP}
  WriteINIStr "$WINDIR\system.ini" "boot" "SCRNSAVE.EXE" "$SYSDIR\screen.scr"

${Else}
  WriteRegStr HKCU "Control Panel\desktop" "SCRNSAVE.EXE" "$INSTDIR\screen.scr"
  WriteRegStr HKCU "Control Panel\desktop" "ScreenSaveActive" "1"
${EndIf}

; Notify system of the change
System::Call 'user32.dll::SystemParametersInfo(17, 1, 0, 2)' 
```

请注意，我将屏幕保护程序安装在 \windows\system32 和包安装目录中。由于某种原因，在 system32 中安装在 Windows 2000 中不起作用。

# javascript - 无法在 AngularJS 模式窗口中获取 DIV 的宽度

> ID：13059527
> 
> 赞同：1
> 
> 时间：2012-10-24T23:41:19.307
> 
> 标签：javascript, dom

我将此代码放入我的 AngularJS Web 应用程序中的 index.html 文件或视图 (html) 文件中，它就像一个魅力：

```
<div id="chart"></div>

<script>
    var chart = document.getElementById("chart");
    alert("width is : " + chart.offsetWidth);
</script> 
```

我可以调整浏览器窗口的大小，当我刷新时，它会告诉我新的宽度。

但是，当我将此代码与视图（html）文件中的模式窗口代码一起放入时，我得到“宽度为：0”

有人知道为什么以及如何在模态窗口中获得 DIV 的宽度吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-11T17:01:42.470

这个问题很老，但如果你或其他人还没有弄清楚：

您需要确保在渲染元素后获得您正在寻找的值。否则你将永远得到'0'

这就是为什么在 jQuery 中你将代码包装在这样的块中：

```
$(function() {
    // your code here
}); 
```

有几种变体；在纯 JS 中，您将使用“document.onLoad”

* * *

## 回答 #2

> 赞同：-3
> 
> 时间：2012-10-25T01:23:05.140

如果你使用 jQuery，你可以使用

```
$('#chart').width() 
```

[http://api.jquery.com/width/](http://api.jquery.com/width/)

# java - 从 Java 实例化一个 Scala 类，并使用构造函数的默认参数

> ID：13059528
> 
> 赞同：17
> 
> 时间：2012-10-24T23:41:36.350
> 
> 标签：java, scala

我有一个**Scala**课程：

```
class Foo(val x:String = "default X", val y:String = "default Y" ) 
```

我想从**Java**调用它，但使用默认参数

通过`null`不起作用（它`null`按预期分配）

```
new Foo(null,null); //both are instantiated as null 
```

这个技巧确实对我有用，但它很难看，我想知道是否有更好的方法：

**斯卡拉**

```
class Foo(val x:String = "default X", val y:String = "default Y" ) {
  def this(x:Object) = this()
} 
```

**爪哇**

```
new Foo(null); //no matter what I pass it should work 
```

但是我想摆脱构造函数重载技巧，并使用 0 参数构造函数

那可能吗？

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T00:20:52.063

看来，没有这样的方式：[https ://issues.scala-lang.org/browse/SI-4278](https://issues.scala-lang.org/browse/SI-4278)

> **问题**：应该为具有所有可选参数的类生成默认的无参数构造函数
> ......
> 
> **Lukas Rytz**：关于语言统一性，我们决定不修复这个问题——因为这是与框架的互操作性问题，我们认为不应该在语言级别修复它。
> 
> 解决方法：重复一个默认值，或抽象一个，或将一个默认值放入零参数构造函数

然后 Lukas 提出了与您发现的相同的解决方案：

```
class C(a: A = aDefault, b: B = C.bDefault) {
  def this() { this(b = C.bDefault) }
}
object C { def bDefault = ... }

// OR

class C(a: A = aDefault, b: B) {
  def this() { this(b = bDefault) }
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-10-18T21:24:30.383

有一个解决方案，请查看文章中的“默认参数”部分：[https ://lampwww.epfl.ch/~michelou/scala/using-scala-from-java.html](https://lampwww.epfl.ch/~michelou/scala/using-scala-from-java.html)

可以通过使用 .$default$[number] 格式从 java 传递适当的位置参数来调用构造函数和方法。

这里的范围如下：

*   类构造函数：<< ClassName >>.init$default$1 为构造函数定义中设置的第一个参数的默认值 default$2 为第二个参数的默认值，依此类推。
*   方法调用：object.methodName$default$1 来解析方法第一个参数在方法签名中分配的默认值等。

例子：

```
import za.co.absa.spline.core.SparkLineageInitializer;
SparkLineageInitializer.SparkSessionWrapper lineage = SparkLineageInitializer.SparkSessionWrapper(spark);
lineage.enableLineageTracking(lineage.enableLineageTracking$default$1()); 
```

对于此示例，maven 依赖项为： groupId: za.co.absa.spline artifactId: spline-core version: 0.3.1

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-02-18T01:51:18.270

更一般地，如果您有一个带有默认参数的 Scala 类，并且您想在 Java 中实例化覆盖 0、1 或更多默认值而不必指定所有，请考虑扩展 Scala API 以在伴随对象中包含一个 Builder。

```
case class Foo(
  a: String = "a",
  b: String = "b",
  c: String = "c"
)

object Foo {
  class Builder {
    var a: String = "a"
    var b: String = "b"
    var c: String = "c"
    def withA(x: String) = { a = x; this }
    def withB(x: String) = { b = x; this }
    def withC(x: String) = { c = x; this }
    def build = Foo(a, b, c)
  }
}

public class App {
    public static void main(String[] args) {
        Foo f = new Foo.Builder()
            .withA("override a")
            .build();
    }
} 
```

# java - 如何使用 Java DeflaterOutputStream

> ID：13059533
> 
> 赞同：3
> 
> 时间：2012-10-24T23:42:13.223
> 
> 标签：java, gzip

编辑：我真的只需要知道 Deflater 派生类何时决定写入页眉和页脚数据，以及如何利用这些事实。我真的很想做以下事情：

1.  为 Deflater 派生类添加一些字节的字典（我想我明白了）。

2.  将一些要压缩的数据发送到 Deflater 派生类（我想我明白了）。

3.  将所有压缩数据（没有页眉或页脚数据）输出到我想要的任何地方（不确定如何执行此操作，也可以同时拥有页眉/页脚，或者只有一个，只要它是一致的） .

4.  从 1 重新开始重用对象。

原问：我正在使用 Java DeflaterOutputStream 来压缩一些数据。我还通过修改页眉和页脚来修改这些压缩数据。我想给 DeflaterOutputStream 一些输入，让它只输出压缩数据部分，而不是 gzip 格式的页眉或页脚。我该怎么做？

到目前为止，我一直在尝试做这样的事情：

```
internalWriter.write(storage, 0, amountRead);
internalWriter.finish();
internalWriter.getDef().reset(); 
```

这里的 internalWriter 是 DeflaterOutputStream 的扩展。这将输出带有页眉和页脚的压缩数据。但是，在使用相同对象的后续调用中，它会输出压缩数据和页脚。我基本上只想要压缩数据，或者每次都发生同样的事情。有任何想法吗？对压缩流如何使用 close、flush、finish 的快速解释也可能对我有所帮助，重点是何时创建和输出页眉和页脚。

每次我使用 DeflaterOutputStream 时，我都希望它立即输出所有内容。这就是为什么我在上面看到的右边之后完成了...

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:51:53.250

[你可以在Java Almanac](http://www.exampledepot.com/egs/java.util.zip/pkg.html)中看到很好的例子

*   [压缩字节数组](http://www.exampledepot.com/egs/java.util.zip/CompArray.html)
*   [解压字节数组](http://www.exampledepot.com/egs/java.util.zip/DecompArray.html)

**- - 编辑 - -**

让我尝试提供更多帮助。Elliote Rusty Harold所著的[Java I/O](http://shop.oreilly.com/product/9780596527501.do)一书可能是我找到的最好的参考书。您可以从 OReilly Books 获得它。我将为您提供书中的一些引用和示例。

## 缩小数据

> Deflater 类包含压缩数据块的方法。您可以选择压缩格式、压缩级别和压缩策略。使用 Deflater 类对数据进行放气需要九个步骤：
> 
> 1.  构造一个 Deflater 对象。
> 2.  选择策略（可选）。
> 3.  设置压缩级别（可选）。
> 4.  预设字典（可选）。
> 5.  设置输入。
> 6.  重复压缩数据，直到 needsInput( ) 返回 true。
> 7.  如果有更多输入可用，请返回步骤 5 以提供其他输入数据。否则，转到步骤 8。
> 8.  完成数据。
> 9.  如果有更多流需要放气，请重置放气器。
> 
> 通常，您不直接使用此类。相反，您可以通过 DeflaterInputStream 或 DeflaterOutputStream 等压缩流类之一间接使用 Deflater 对象。这些类为面向流的压缩提供了比原始 Deflater 方法更方便的程序员接口。

## 膨胀数据

> 1.  构造一个 Inflater 对象。
> 2.  使用要膨胀的压缩数据设置输入。
> 3.  调用 needsDictionary( ) 来确定是否需要预设字典。
> 4.  如果 needsDictionary() 返回 true，调用 getAdler() 获取字典的 Adler-32 校验和。然后调用 setDictionary() 来设置字典数据。
> 5.  反复膨胀数据，直到 inflate( ) 返回 0。
> 6.  如果 needsInput( ) 返回 true，则返回步骤 2 以提供额外的输入数据。
> 7.  finished() 方法返回 true。

现在，这本书用一整章的时间来压缩和解压缩数据，我认为这里不可能全部解释清楚。您必须完成任务的一部分，如果需要，请提出一个更狭窄的问题。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T02:53:57.037

请参阅[deflater](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/zip/Deflater.html#Deflater%28int,%20boolean%29) (sic) 文档。如果`nowrap`为真，则不会生成标头或尾标——只有[deflate 格式](https://www.rfc-editor.org/rfc/rfc1951)的原始压缩数据。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T01:42:53.817

听起来您想要有两个流，您的目标流，然后是装饰目标流的压缩器流。然后，您会将未压缩的数据写入基本流，将压缩数据写入装饰器流。确保在切换之前冲洗。读取将是一个类似的过程，但您需要知道压缩数据在流中的开始和结束位置。

假设目标流是一个文件，类似于以下伪代码...

```
 FileOutputStream dest = new FileOutputStream(foo);
    DeflaterOutputStream decorator = new DeflaterOutputStream(dest);

    byte[] header = getHeader();
    byte[] body = getBody();
    byte[] footer = getFooter();

    dest.write(header);
    dest.flush();
    decorator.write(body);
    decorator.flush();
    dest.write(footer); 
```

我想知道是否`DeflaterOutputStream`真的是你想要的。那不是zip文件的一部分吗？如果您正在做一些自定义的事情，似乎您只想对其进行 gzip 压缩。

# java - 字符串拆分为字符串数组

> ID：13059539
> 
> 赞同：2
> 
> 时间：2012-10-24T22:11:37.347
> 
> 标签：java, string, split

我有一个字符串变量 Result ，其中包含如下字符串：

```
"<field1>text</field1><field2>text</field2> etc.." 
```

我使用此代码尝试拆分它：

```
Result = Result.replace("><", ">|<");

String[] Fields = Result.split("|"); 
```

根据包括这个在内的许多网站，这应该给我一个这样的数组：

```
Fields[0] = "<field1>text</field2>"
Fields[1] = "<field2>test</field2>"
etc... 
```

但它给了我一个像这样的数组：

```
Fields(0) = ""
Fields(1) = "<"
Fields(2) = "f"
Fields(3) = "i"
Fields(4) = "e"
etc.. 
```

那么，我做错了什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:46:58.513

尝试做

```
String[] fields = result.split("\\|"); 
```

请注意，我使用了更传统的变量名称（它们不应以大写字母开头）。

请记住，这些`split`方法将*正则表达式*作为参数，并且`|`在正则表达式的世界中具有特定的含义，这就是为什么您没有收到您所期望的。

* * *

相关文件：

*   [`split`](http://docs.oracle.com/javase/1.5.0/docs/api/java/lang/String.html#split%28java.lang.String%29)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-24T23:48:23.127

您的调用将`split("|")`解析`|`为正则表达式或，它本身将在每个字符之间拆分。

您可以对字符进行正则表达式转义以防止这种情况发生，或者完全使用不同的临时拆分字符。

```
String[] fields = result.split("\\|"); 
```

或者

```
result = result.replace("><", ">~<");
String[] fields = result.split("~"); 
```

# python - 使用 Python，反转一个整数，并判断是否回文

> ID：13059540
> 
> 赞同：19
> 
> 时间：2012-10-24T23:42:44.973
> 
> 标签：python, string, list, main, function

使用 Python，反转一个整数并确定它是否是回文。这是我对反向和回文的定义。我有正确的逻辑吗？

```
def reverse(num):
    s=len(num)
    newnum=[None]*length
    for i in num:
        s=s-1
        newnum[s]=i
        return newnum

def palindrome(num):
    a=str(num)
    l=len(z)/2
    if a[:1]==a[-1:][::-1]:
        b=True
    else:
        b=False 
```

我写起来有些麻烦`def main`。

* * *

## 回答 #1

> 赞同：56
> 
> 时间：2012-10-24T23:51:07.630

```
def palindrome(num):
    return str(num) == str(num)[::-1] 
```

* * *

## 回答 #2

> 赞同：20
> 
> 时间：2012-10-24T23:55:07.977

整数没有 len()。

测试一个数字是否是回文就像测试数字是否等于它的倒数一样简单（尽管如果你想要最大的效率，你可以比较字符串两端的字符，直到你到达中间）。

要找到整数的倒数，您可以通过困难的方式来做（使用 mod % 和整数除法 // 找到每个数字并构造倒数）：

```
def reverse(num):
  rev = 0
  while num > 0:
    rev = (10*rev) + num%10
    num //= 10
  return rev 
```

或者简单的方法（将数字转换为字符串，使用切片表示法反转字符串并将其转换回整数）：

```
def reverse(num):
  return int(str(num)[::-1]) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2016-07-13T20:55:17.430

这是一种不可读的单行递归实现，部分基于[pedrosorio 的回答](https://stackoverflow.com/a/13059634/832230)。

```
def reverse(i):
    return int(i!=0) and ((i%10)*(10**int(math.log(i,10))) + reverse(i//10))

def is_palindrome(i):
    return i == reverse(i) 
```

它适用于整数`i ≥ 0`。

请注意`reverse(123) == reverse(1230) == 321`. 这不是问题，考虑到任何以 0 结尾的非零整数无论如何都不能是回文。

还要注意，整数的完全反转当然可能不是确定它是否是回文所必需的。如果确定该数字不是回文，则可以实施反转以便提前中止。

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2017-06-30T07:07:48.527

长但可读：

```
def palindrome(x):
    a=""
    x=str(x)
    for i in range(len(x),0,-1):
        a+=x[i-1]
        print a
    if a==x:
        return True
    else:
        return False 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2018-01-12T06:26:43.953

```
def revers(num):
    rev = 0
    while num > 0:
        rem = num % 10
        rev = (rev * 10) + rem
        num = num // 10
    return rev 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-01-18T00:27:46.110

我为这个程序使用了一个列表，也适用于字符串。

```
print('Enter Something')
a = list(input())
for i in range ((len(a)),0,-1):
   print (a[i-1],end='') 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2016-02-13T19:45:25.793

```
import math

a = raw_input("Enter number:")
n = -1

reverse = 0    
for i in a:
        n += 1
        digit = math.pow(10,n)
        reverse = int(i)*digit + reverse

print int(reverse)  

if int(reverse) == int(a):
        print "Palindrome"
else:
        print ":(" 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-04-16T20:55:23.120

此代码将 int 转换为 String，然后检查字符串是否为 pallindrome。优点是速度快，缺点是它将 int 转换为 String，从而影响了问题的完美解决方案。

它`negative int`也可以处理。

```
class Solution:
    def isPalindrome(self, x):
        """
        :type x: int
        :rtype: bool
        """
        s = str(x)
        if x >=0 :
            if s == s[::-1]:
                return True
            else:
                return False
        else:
            return False 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-03-05T20:47:14.090

```
t=int(input("enter nos of test cases= "))
while t>0:
    n=int(input("enter number="))
    rev=0
    while n>0:
        digit=n%10
        rev=rev*10+digit
        n=n//10
    print(rev)
    t-=1 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2019-11-16T20:25:46.990

这是我的解决方案。

```
z=input('input number')
if int(z) == int(str(z)[::-1]):
    print('The number is palindrome')
else:
    print('The number is not palindrome') 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2020-08-05T08:31:11.520

反转一个整数并确定它是否是回文：

1.  将整数转换为字符串。
2.  使用 reverse 函数反转字符串并加入它。
3.  使用 if else 条件检查反转号码是否 = 原始号码。

见代码：

```
number = 1221

reverse = ''.join(reversed(str(number)))

print(reverse)

if (int(reverse) == number):
    print("number is Palindrome")
else:
    print("number is not Palindrome") 
```

* * *

## 回答 #12

> 赞同：-2
> 
> 时间：2015-01-02T00:45:29.903

我试着自己解决这个问题。

```
def number():

    n = int(input("Enter a number: "))
    return n

def reverse(n):

    total = ""
    while n > 0:
        a = n % 10

        n//= 10

        total+= str(a)

    return total

def palindrome (n):

    total = 0
    while n > 0:
        a = n % 10

        n//= 10

        total+= a

    if total == n:
        x = "This number has a palindrome"

    else:
        x = ""

    return x

n = number()
print (reverse(n))
print (palindrome(n)) 
```

* * *

## 回答 #13

> 赞同：-2
> 
> 时间：2016-04-14T07:39:20.823

```
original = raw_input("Enter a no = ")   #original = number entered by user
rev = original[::-1]     #rev = reverse of original by useing scope resolution 
print 'rev of original no =',rev
if original == rev:
    print "no's are equal"
else:
    print "no's are not equal" 
```

# asp.net-mvc-4 - 为什么 MVC4 Web 应用程序不使用登录的 Windows 身份验证凭据来访问 MVC4 Web api 服务

> ID：13059542
> 
> 赞同：1
> 
> 时间：2012-10-24T23:43:06.977
> 
> 标签：asp.net-mvc-4

我的 MVC4 web-app 使用 AppPoolIdentity 来访问在不同服务器上运行的 MVC4 web-api 服务，而不是使用登录用户的 Windows 身份验证凭据。两个站点都启用了 Windows 身份验证。

Http客户端代码访问web-api服务；

```
using (HttpClientHandler _clientHandler = new HttpClientHandler())
{
_clientHandler.UseDefaultCredentials = true;
using (HttpClient _client = new HttpClient(_clientHandler, true))
{
// code to get data
}
} 
```

我正在使用 ApiController.User 在 web-api 控制器上登录用户的详细信息。

如何将登录用户的凭据传递给 web-api 服务？

# mysql - mysql avg(min()) 可以做到吗？

> ID：13059543
> 
> 赞同：1
> 
> 时间：2012-10-24T23:43:08.587
> 
> 标签：mysql

显然 avg(min()) 给了我一个错误，所以我尝试了这段代码，但它给了我错误的数字。有任何想法吗？

谢谢

```
select
    out_year as "Year",
    avg(dwell_time) as "Average",
    avg(av.dw_min) as "Minimum",
    avg(av.dw_max) as "Maximum"
from
    (select min(dwell_time) as dw_min, max(dwell_time) as dw_max
    from eq_dwell) av,
    eq_dwell ed
where
    inv_status = "Offdock"
group by out_year 
```

# entity-framework - 在实体框架中恢复表

> ID：13059544
> 
> 赞同：3
> 
> 时间：2012-10-24T23:43:12.380
> 
> 标签：entity-framework, migration

我是第一次与 EF 合作。出于某种原因，我很难运行我的应用程序，并且每次我遇到异常时，您的模型未与当前数据库同步。我尝试了一切，由于数据并不重要，我想通过运行所有迁移来重新创建所有表。因此，我删除了所有表并尝试运行以下命令。我在这里使用基于模型的方法来定义我的实体。

*更新数据库-targetMigration：**InitialCreate** -verbose*

我的印象是它将从第一次迁移开始重新创建所有表，但实际上它将所有表都恢复到了第一点。现在，每当我运行 update-database 命令时，我总是得到以下信息

*没有未决的显式迁移。*

我很困惑我应该怎么做才能恢复生成的表格并将我的应用程序设置为工作状态。有人可以帮忙吗？

谢谢-法赫德

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T06:37:51.147

如果您首先使用模型，则可以单击模型空白并执行“从模型生成数据库”。如果您先编写代码，EF 会在数据库上创建一个名为“__MigrationHistory”的表。如果您首先删除该表代码，则将从您当前基于代码的模型重新创建数据库模型。

# c - 如何通过scanf将值传递给函数

> ID：13059546
> 
> 赞同：1
> 
> 时间：2012-10-24T23:43:26.017
> 
> 标签：c, input, scanf

我在尝试创建的程序中有一个简短的问题。我似乎无法弄清楚如何传递某人为我的“denom”变量输入的值，以便可以在我创建的函数中成功使用它。帮助将不胜感激。

```
#include <stdio.h>

//Global Variables
int num, denom;
void simplify(int *numerator, int *denominator);

int main () {
    int num1, denom1;
    //Prompt User as to what program is
    printf("Fraction Simplifier\n");
    printf("===================\n");

    //Ask User for Numerator and Denominator
    printf("Numerator: ");
    scanf("%d", &num);
    printf("Denominator: ");
    scanf("%d", &denom);

    //Call Function
    simplify(&num1, &denom1);

    //Display final output
    printf("%d / %d = %d / %d\n", num, denom, num1, denom1);

    return 0;
}

//Simplify function
void simplify(int *numerator, int *denominator)
{

    int num1, denom1;
    num1 = 1;
    num = num1;
    denom = denom1;

    num1 = num1 / num1;
    denom1 = denom1 / num1;
    *numerator = num1 ;
    *denominator = denom1;

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:53:53.807

您的`simplify()`方法甚至不尝试使用传递的值。

它归结为 *numerator = 1 和 *denominator = 未定义（因为 denom1 从未初始化）。即它将“输出值”设置为“常量”。您可能打算执行以下操作：

```
int num1 = *numerator;
int denom1 = *denominator; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:02:06.497

在 Simplify() 函数中：

```
*int num1, denom1;             
denom = denom1;* (1)
denom1 = denom1 / num1; (2)
*denominator = denom1;* (3) 
```

在 (1) denom1 中有未定义的值。因此，当您使用时： (2)denom1 仍然有一个未定义的值，并且在 (3) 中分母有一个未定义的值

# python - IRC 读取套接字

> ID：13059547
> 
> 赞同：0
> 
> 时间：2012-10-24T23:43:29.123
> 
> 标签：python, bots, irc

我正在制作一个机器人，除了输入之外，几乎所有东西都准备好了。我想要这样的东西：“！test word”并让它输出类似“word2”的东西。这是我用来输出数据的代码。我还想知道我的用户名（操作名）。抱歉，如果页面上的缩进关闭；这对我来说很好。

```
while True:

    data = irc.recv ( 4096 )
    if data.find ('PING' ) != -1:
      irc.send ('PONG ' + data.split() [ 1 ] + '\r\n' )

    if data.find ('!quit') != -1:
      irc.send ('QUIT\r\n')

    if data.find ('!enc %s\r\n' % werd) != -1:
      irc.send ("PRIVMSG %s :%s\r\n" % (channel,werd)) 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T00:23:35.760

您的代码中存在一个根本缺陷，必须先修复才能进一步了解。

IRC 是基于行的协议，但您不是逐行阅读。相反，您一次最多读取 4096 个字节。这可以返回一行的前半部分，或者一行的中间三分之一，或者一行的最后三分之一，然后是两行完整的行和第四行的前两个字符。

如果你不明白为什么这是个问题：想象一下，一个`read`返回以 结尾的东西`'\r\nPI'`，而下一个返回以 开头的东西`'NG foo\r\n'`。这些都不匹配你的`find('PING')`，所以你会错过命令。

解决此问题的最简单方法是将循环更改为以下内容：

```
for line in irc.makefile(): 
```

作为一个小提示，您可能想要`'!quit' in data`而不是`data.find ('!quit') != -1`.

最后，我认为这不是您真正想要的（尽管我可能是错的）：

```
if data.find ('!enc %s\r\n' % werd) != -1:
    irc.send ("PRIVMSG %s :%s\r\n" % (channel,werd)) 
```

如果是来自其他地方的静态字符串，这将起作用`werd`，但是根据您的描述，听起来您希望能够捕获任何命令`!enc foo\r\n`并返回`PRIVMSG #chan: foo\r\n`，并且还捕获`!enc bar\r\n`并返回`PRIVMSG #chan: bar\r\n`，等等，以应对某人可能的任何其他可能性类型。为此，您可能需要一个正则表达式，或者您可能只需要稍微复杂的字符串处理代码（例如，`data`用空格分隔，如果任何元素匹配`'!enc'`，则下一个元素是要发回的单词）。

这是一种方法的示例，它可能会或可能不会像您正在尝试做的事情：

```
m = re.search(r'!enc (.*)\r\n', line)
if m:
    irc.send('PRIVMSG %s: %s\r\n' % (channel, m.group(1))) 
```

> 我想要这样的东西：“！test word”并让它输出类似“word2”的东西

好的，那么当给定“word”时，它如何确定您想要“word2”？无论规则是什么，您显然都必须在某个地方对该规则进行编码。或者，如果您需要编码帮助，您必须向我们描述。

从评论：

> 我只想要“！test x”。用户输入“！test x”，我对“x”做一些事情并输出更改

我假设您在`x`这里使用的是元变量，而不是文字——也就是说，如果用户对`"!test x"`做事`"x"`，如果用户对`"!test y"`做事`"y"`，等等。如果我错了，请告诉我.

显然，上面的代码不会捕捉到这一点，因为它正在搜索“enc”而不是“test”。但这是一个微不足道的变化：

```
m = re.search(r'!test (.*)\r\n', line) 
```

至于在输出之前对 x “做点什么”，`m.group(1)`就是`x`上面的，所以：

```
if m:
    irc.send('PRIVMSG %s: %s\r\n' % (channel, do_stuff_to(m.group(1)))) 
```

如果你不确定你在发送、接收和解析什么，你总是可以添加一个 print 语句来测试一下：

```
m = re.search(r'!test (.*)\r\n', line)
print m, m.groups() if m else ''
if m:
    print 'got %s, sending %s' % (m.group(1), do_stuff_to(m.group(1))))
    irc.send('PRIVMSG %s: %s\r\n' % (channel, do_stuff_to(m.group(1)))) 
```

如果您想查看套接字上发生的事情，有两种方法可以做到这一点：安装[wireshark](http://www.wireshark.org/)并使用它来监视网络上的消息，或者使用[netcat](http://en.wikipedia.org/wiki/Netcat)设置假服务器。前者我就不解释了，因为要解释的太多了，而且已经有很好的教程了。但对于后者，就这么简单：打开终端并运行`nc -kl 8888`. 然后让你的机器人连接到`localhost:8888`而不是远程服务器。观察机器人发送给您的内容，然后将回复键入或粘贴到终端窗口中。（在除 Windows 之外的几乎所有平台上，nc 都是内置的；在 Windows 上，您需要从某个地方获取 netcat 或 ncat，但我很确定 Wikipedia 页面有链接。）如果您需要进行大量调试，您可以将 netcat 设置为代理，仅在您的机器人和真实服务器之间来回转发消息并打印出所有通过的信息。

# c# - DBContext Find with Includes - 带有主键的 lambda

> ID：13059548
> 
> 赞同：3
> 
> 时间：2012-10-24T23:44:00.167
> 
> 标签：c#, entity-framework, find, dbcontext

我正在编写一个通用存储库以使用 DBContext 与 EF 交互。

我有一个通用的 Get() 方法，它接收主键值并返回实体：

```
public class DALRepository<DALEntity> : IDisposable, IGenericRepository<DALEntity> where DALEntity : class
{
private IDbSet<DALEntity> dbSet;
private NWEntities context;

public DALRepository()
{
  context = new NWEntities();
  context.Configuration.LazyLoadingEnabled = false;
  dbSet = context.Set<DALEntity>();
} 
```

这是一个简单的 get 方法 - 只适用于 PK - 正是我想要的。

```
public DALEntity Get(string ID)
{
   return dbSet.Find(ID);
} 
```

我现在想更改它以允许消费者传入包含列表 - 除了返回一个客户之外，他们还可以请求返回订单。这就是我遇到麻烦的地方。如果我这样做：

```
public DALEntity Get(string ID, IEnumerable<string> IncludeEntities = null)
{
      IQueryable<DALEntity> query = dbSet;
      query = IncludeEntities.Aggregate(query, (current, includePath) => current.Include(includePath));
} 
```

我不能将 find 与 IQueryable 一起使用。而且我不能直接 Find() 因为我不能将包含传递给它。如果我在 IQueryable 上使用 where lambda，我如何告诉它使用实体的 PK？我想我可能有一个泛型约束，它坚持泛型类型必须实现一些具有明确定义的主列名称（例如“ID”）的 IPkey 接口，但是我不能使用 DBContext 生成的实体，因为它们必须实现这个界面。如果需要，我可以更改 T4 来执行此操作——而且我已经将其更改为发出 XML 注释，因此不太反感——但有人有更简单的方法吗？我想我需要的是一个接受包含列表的重载 find() 。

所以我的问题是如何将 Find 与包含一起使用，或者如何在它知道 PK 的地方编写 lambda？我无法接收这样的 lambda 作为参数，因为它最终会被 WCF 服务使用。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-26T03:04:30.123

回答你自己的问题有点奇怪，但如果其他人有这个问题，这就是我所做的。我使用了动态 LINQ 的东西，并使用了 .Where() 的字符串重载版本。我使用提到的链接之一来确定如何获取主键（我的也是来自 DBContext），该方法现在看起来像这样：

```
public DALEntity Get(string ID, IEnumerable<string> IncludeEntities = null)
{
  var set = ((IObjectContextAdapter)context).ObjectContext.CreateObjectSet<DALEntity>();
  var entitySet = set.EntitySet;
  string[] keyNames = entitySet.ElementType.KeyMembers.Select(k => k.Name).ToArray();
  Debug.Assert(keyNames.Length == 1, "DAL does not work with composite primary keys or tables without primary keys");

  IQueryable<DALEntity> query = dbSet;
  query = IncludeEntities.Aggregate(query, (current, includePath) => current.Include(includePath));

  query = query.Where(keyNames[0] + "= @0", ID);
  return query.FirstOrDefault();
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:38:28.443

您可以按照此处描述的方式获得您的密钥：[https ://stackoverflow.com/a/10796471/971693](https://stackoverflow.com/a/10796471/971693)

话虽如此，如果不使用一些反射，我就看不到方法：

```
public IEnumerable<DALEntity> Get(params string IDs)
{
   var objectSet = objectContext.CreateObjectSet<YourEntityType>();
   var keyNames = objectSet.EntitySet.ElementType.KeyMembers.First(k => k.Name);

   return dbSet.Where(m => ID.Contains((string)m.GetType().GetProperty(keyNames ).GetValue(m, null));
} 
```

首先，params 字符串 ID 将允许您传递 1 个或多个 ID，并将生成一个字符串数组。该函数的第一部分是动态获取主键的名称。

第二部分创建一个查询以返回集合中的所有元素，其中主键值（通过反射获得）包含在参数中接收的 ID 数组中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T10:01:49.973

使用 Linq 的[Single](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.single.aspx)或[First](http://msdn.microsoft.com/en-us/library/system.linq.enumerable.first.aspx)方法，它们允许您搜索`IQueryable`对象。

```
public DALEntity Get(string ID, IEnumerable<string> IncludeEntities = null)
{
      IQueryable<DALEntity> query = dbSet;
      query = IncludeEntities.Aggregate(query, (current, includePath) => current.Include(includePath));
      query = query.Single(x=>x.Id == ID);
} 
```

# ruby-on-rails - 如何将 Resque 作业锁定到一台服务器

> ID：13059549
> 
> 赞同：6
> 
> 时间：2012-10-24T23:44:25.793
> 
> 标签：ruby-on-rails, ruby, redis, resque

我的基础架构中有一个 Resque 服务器“集群”。它们都具有完全相同的作业优先级等。我会根据有多少待处理的作业以及服务器上用于处理所述作业的可用资源来自动上下缩放 Resque 服务器的数量。我总是至少有两个 Resque 服务器。

我的问题是，当我完成一项快速的临时工作时，有时两个服务器都会处理该工作。这是不好的。

我尝试使用以下内容为我的工作添加锁：

```
require 'resque-lock-timeout'

class ExampleJob
  extend Resque::Plugins::LockTimeout

  def self.perform
   # some code
  end
end 
```

该插件适用于运行时间较长的作业。然而，对于这些超小的一次性工作，处理会立即发生。Resque 服务器都看不到其姊妹服务器设置的锁，都设置了锁，处理作业，解锁并完成。

除了让一台专用服务器处理此类工作之外，我不完全确定此时该做什么或有什么解决方案。配置和扩展这将是一个严重的痛苦。我真的希望两台服务器都能够处理它，但是一旦其中一台从队列中抓取它，请确保另一台不运行它。

任何人都可以提出一些可行的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-28T06:16:33.203

编写你的锁解释器等待`T`几毫秒，然后它会寻找一个 unique_id*小于它所创建的锁的值的锁*。

这将决定谁赢得比赛，而失败者将自行终止。

`T``N`是给定队列池中所有服务器之间的并行延迟。您可以通过从 1000 毫秒缩减直到您再次发现重复发生的工作来[启发式地确定这一点。](http://en.wikipedia.org/wiki/Heuristic)为延迟变化提供填充。

这称为互斥线程安全的 Busy-Wait 解决方案。考虑到必须解决互斥锁的各种场景（例如锁定等），它被认为是可接受的权衡之一

我会在关闭移动设备时发布一些链接。互斥量的维基百科条目应该解释这一切。

那么这对您不起作用： 1\. 使用调度程序来控制复制。2\. 将短期运行的作业分类到一个设计用来串行运行它们的队列中。

TL;DR 没有完美的解决方案，只有根据您的条件进行良好的权衡。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-30T17:07:42.560

两个工作人员应该不可能获得相同的“有效负载”，因为项目是使用`BLPOP`. Redis 只会将排队的项目发送给第一个调用`BLPOP`. 听起来您不止一次将作业排入队列，因此两个工作人员能够使用相同的参数获取不同的有效负载。'resque-lock-timeout' 的目的是确保具有相同方法和参数的有效负载不会同时运行；但是，如果第一个作业在第二个作业尝试获取锁之前释放锁，它不会阻止第二个有效负载的工作。

这只发生在短期运行的作业上是有道理的。以下是可能发生的情况：

```
payload 1 is enqueued
payload 2 is enqueued
payload 1 is locked 
payload 1 is worked
payload 1 is unlocked
payload 2 is locked
payload 2 is worked
payload 2 is unlocked 
```

在长时间运行的作业中，可能会发生以下情况：

```
payload 1 is enqueued
payload 2 is enqueued
payload 1 is locked
payload 1 is worked 
payload 2 is fails to get lock
payload 1 is unlocked 
```

尝试关闭 Resque 并将您的工作排入队列。查看 Resque 队列列表中的 redis（或使用 监视 Redis `redis-cli monitor`）。查看 Resque 是否已将多个有效负载排队。如果您仍然只看到一个有效负载，则监视该列表以查看您的另一位 resque 工作人员是否正在调用`recreate`失败的作业。

如果您想让“resque-lock-timeout”持有锁的时间超过处理作业所需的持续时间，您可以覆盖该`release_lock!`方法以设置锁的到期时间，而不是仅仅删除它。

```
module Resque
  module Plugins
    module LockTimeout  
      def release_lock!(*args)
        lock_redis.expire(redis_lock_key(*args), 60) # expire lock after 60 seconds
      end
    end
  end
end 
```

[https://github.com/lantins/resque-lock-timeout/blob/master/lib/resque/plugins/lock_timeout.rb#l153-155](https://github.com/lantins/resque-lock-timeout/blob/master/lib/resque/plugins/lock_timeout.rb#l153-155)

# javascript - 获取多个复选框的值并使用 ajax 使用它们的值执行操作

> ID：13059550
> 
> 赞同：1
> 
> 时间：2012-10-24T23:44:44.107
> 
> 标签：javascript, jquery, html

我有一个带有复选框的表，如果选中了一个复选框，我希望删除数据库中的原始数据 - 使用 ajax。

使用普通形式我会简单地命名所有的复选框一些名字让我们说 name="checkbox[]" 然后简单地使用 foreach($_POST['checkbox'] as $value){}

现在我正在尝试获取标记复选框的所有值，然后将它们放入一个数组中。似乎我错过了一些东西。这是我到目前为止所做的：

```
var checkboxes = jQuery('input[type="checkbox"]').val();
var temp = new Array();
jQuery.each(checkboxes, function(key, value) { 
     temp[] = value;
}); 
```

稍后我会将 temp 作为变量传递给 ajax 调用。

我有什么遗漏吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:57:40.193

您可以使用`:checked`选择器和`map`方法：

```
var arr = $('input[type="checkbox"]:checked').map(function(){
     return this.value
}).get(); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:59:16.043

只需将表格包装在表单标签中，然后执行以下操作：

```
var myData = jQuery('#myform').serialize();
jQuery.ajax('myscript.php', {data:myData}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:51:16.513

您正在尝试迭代错误的 Checkbox 值。尝试这个

```
var $checkboxes = jQuery('input[type="checkbox"]') ;
var temp = new Array();
jQuery.each($checkboxes, function(i) {
     var value = $(this).attr('value'); 
     temp[i] = value;
}); 
```

如果您只想通过检查项目，只需添加一个条件。

```
if($(this).is(':checked')){
  var value = $(this).attr('value'); 
  temp[i] = value;
} 
```

# facebook - Facebook 应用程序元素上的 Facebook UIActionLinks

> ID：13059551
> 
> 赞同：1
> 
> 时间：2012-10-24T23:44:45.233
> 
> 标签：facebook

我目前正在开发一个 Facebook 应用程序，我遇到了一个“奇怪”的客户请求。该应用程序本身非常简单。用户可以写一个故事。然后将这个故事保存到自定义数据库中，然后与所有其他故事一起显示在应用程序的首页上。来自客户的要求是我们 - 对于每个故事 - 实施通常位于 Facebook 墙贴下方的“标准”Facebook 链接（点赞、评论、时间）。这是可能的，如果是的话，究竟如何......？

我一直在阅读大量有关可应用于应用程序的新自定义操作链接的信息——但这似乎更像是自定义功能，而不是基本的 Facebook 功能。似乎也没有评论和时间....

非常感谢任何答案 - 如果答案是：使用正常的社交插件 LIKE/SEND/COMMENT 功能:-)

非常感谢

/一月

# ruby - Class#allocate 及其用途

> ID：13059552
> 
> 赞同：23
> 
> 时间：2012-10-24T23:44:45.923
> 
> 标签：ruby, memory-management

阅读[http://www.seejohncode.com/2012/03/16/ruby-class-allocate/](http://www.seejohncode.com/2012/03/16/ruby-class-allocate/)并详细了解分配方法后：[http ://www.ruby-doc.org/core-1.9.3 /Class.html#method-i-allocate](http://www.ruby-doc.org/core-1.9.3/Class.html#method-i-allocate)我变得很好奇。

Ruby 的构建方式是我们不必手动为/使用对象分配或释放空间，但我们被赋予了这样做的能力。为什么？

Ruby 中手动分配对象的用途是什么？我读的文章显示了一个自定义的初始化方法，但它的用途有这么有限吗？

* * *

## 回答 #1

> 赞同：24
> 
> 时间：2012-11-07T17:33:13.073

存在的主要原因`allocate`是允许您为对象构建自定义构造函数。正如您链接的文章所提到的，您可以将该`SomeClass.new`方法设想为默认执行以下操作：

```
class SomeClass
  def self.new(*a, &b)
    obj = allocate

    # initialize is a private instance method by default!
    obj.send(:initialize, *a, &b) 
  end
end 
```

不管文档怎么说，该`allocate`方法的存在与其说是关于内存管理，不如说是关于对对象创建生命周期提供一些更细粒度的控制。大多数情况下，您不需要此功能，但它对于某些极端情况很有用。

例如，在 Newman 邮件框架中，我使用这种技术为 TestMailer 对象[实现了一个假构造函数；](http://elm-city-craftworks.github.com/newman/lib/newman/test_mailer.html#section-3)它实现了`new`API 兼容性的方法，但实际上返回了一个实例，而不管它被调用了多少次：

```
class Newman::TestMailer
  def self.new(settings)
    return self.instance if instance

    # do some Mail gem configuration stuff here

    self.instance = allocate
  end

  attr_accessor :instance
end 
```

`new`除了如上所示的重新定义之外，我还没有看到很多其他用例（尽管我认为一些奇怪的序列化东西也使用了这个特性）。但考虑到这一点，值得指出的是，Ruby 始终如一地提供这些类型的扩展点，无论您是否需要定期使用它们。Robert Klemme 有一篇很棒的文章，叫做[The Complete Class](http://blog.rubybestpractices.com/posts/rklemme/018-Complete_Class.html)，如果你想了解这个设计概念在 Ruby 中的应用程度，我强烈推荐阅读这篇文章 :-)

# multithreading - shell中进程的同步？

> ID：13059553
> 
> 赞同：0
> 
> 时间：2012-10-24T23:44:49.740
> 
> 标签：multithreading, shell, unix, synchronization

我正在分叉一堆进程，我想为我的主要原始进程创建一个“屏障”，以等待所有其他进程完成。代码流如下所示：

```
#...the main thread is executing now, and reaches this foreach loop:

foreach arg (myArgs)

    some_command arg & #these are the processes being forked off

end

#I want the main thread to WAIT here until all the above processes finish!

#... More code below here for the main thread to continue with 
```

我不确定我想要什么同步原语，甚至不确定在 unix shell 环境中有什么可用的。也许像主线程的障碍？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:46:25.330

裸机`wait`将等待所有子进程退出。

> ### 等待：等待 [n]
> 
> 等待指定进程并报告其终止状态。**如果没有给出 N，则等待所有当前活动的子进程，返回码为零。** N 可以是进程 ID 或作业规范；如果给出了作业规范，则等待作业管道中的所有进程。

# web2py - Web2py auth.user 对象返回过时的数据

> ID：13059557
> 
> 赞同：1
> 
> 时间：2012-10-24T23:45:10.603
> 
> 标签：web2py

我正在开发一个使用 Web2py 的网络应用程序。我的 auth_user 表有一个用户名字段。我面临的问题是当我更新用户的用户名时，auth.user.username 会一直返回旧值，直到用户注销并再次登录。

此外，有时我注意到即使对给定的用户 ID 进行新的数据库查询，它也会返回过时的用户名。为什么会这样？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T02:40:53.457

`auth.user`存储在会话中（以及其他一些与身份验证相关的数据）。这避免了必须对每个请求的用户数据进行数据库查询。因此，更新数据库中的记录不会更新`auth.user`会话中的对象。`auth.profile()`如果用户使用内置功能更新自己的个人资料，`auth.user`则将自动更新。否则，您将不得不自己更新它：

```
auth.user.update(username='my new name') 
```

# java-me - 在 j2me 中制作 Web 浏览器应用程序？

> ID：13059559
> 
> 赞同：1
> 
> 时间：2012-10-24T23:45:26.887
> 
> 标签：java-me, browser, mobile-application

我是 j2me 的新手，但是我最近对移动应用程序的狂热，我从一些基本的应用程序开始，我已经阅读了 j2me 完整的参考书，我已经在我的手机上运行了我的小型 j2me 程序，现在我想为我的 web 浏览器手机，你能给我一些例子来帮助我做这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T20:49:37.383

如果你可以使用`LWUIT`有[`HTMLComponent`](http://docs.oracle.com/javame/dev-tools/lwuit-1.4/LWUIT_Developer_Guide_HTML/bbjidhgf.html).

HTMLComponent 最简单的用例是渲染富文本：

```
HTMLComponent htmlC = new HTMLComponent(null);
htmlC.setBodyText("Hello <b>bold text</b>"); 
```

# webos - Webos Mojo palm-group 更改边框颜色和宽度

> ID：13059560
> 
> 赞同：1
> 
> 时间：2012-10-24T23:45:27.820
> 
> 标签：webos, mojo

有谁知道更改 WebOS Mojo 手掌组的边框颜色、宽度和半径需要什么 css？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:52:55.690

对于标记组

```
.palm-group {
    background-color: white;
    -webkit-border-radius: 20px;                                         
    border-width: 40px 18px 18px 18px;                              
    -webkit-border-image: url(../images/palm-group.png) 40 18 18 18;
    } 
```

对于未标记的组：

```
.palm-group.unlabeled {
border-width: 18px 18px 18px 18px;
-webkit-border-image: url(../images/palm-group-unlabeled.png) 18 18 18 18;
} 
```

我希望这可以帮助别人。

# html - 如何将gps嵌入视频

> ID：13059561
> 
> 赞同：9
> 
> 时间：2012-10-24T23:45:50.467
> 
> 标签：html, video, gps, mp4

我想编写一个应用程序，它采用实时视频流和 GPS 坐标，将它们合并在一起并将其显示在 HTML5 浏览器上。

这是我到目前为止得到的。

我可以捕捉现场视频。视频为 MP4/H.264 格式。

我可以得到GPS坐标。每秒更新一次。

我需要将它们合并到一个流中。我已经考虑过将 GPS 作为元数据嵌入或将 GPS 数据放入字幕中。

在客户端，用户将拥有一个兼容 HTML5 的浏览器，可以播放 MP4/H.264 视频。

我需要一种从合并流中提取 GPS 数据的方法。

然后，我可以在一帧中显示视频，并在另一帧中显示当前位置的地图，并排显示。

我正在寻求合并和取消合并流视频和 GPS 的帮助。

谢谢。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T00:57:00.760

如果您要拆分合并的流，那么为什么不留下一个视频文件和一个 GPS 日志，然后再同步它们呢？

在 GPS 流中，只需记录一个帧号，或基于时间戳同步。在这种情况下，只需确保将系统时钟与 GPS 时间同步即可。

我过去就是这样做的，而且效果很好。

为了大致了解记录的内容并验证所有内容是否正确同步，我将数据转换为**.srt**（用于字幕）格式。然后使用任何视频播放器，您都可以将自定义文本视为字幕，并且视频播放器会为您进行同步。

.srt 看起来像这样。

```
1
00:00:00,000 --> 00:00:01,000
First Message. GPS bla bla 

2
00:00:01,000 --> 00:00:02,000
Second Message.. GPS foo bar 
```

再简单不过了。更多信息：[http ://en.wikipedia.org/wiki/SubRip](http://en.wikipedia.org/wiki/SubRip)

在这里，您可以在 HTML5 网页上找到 MP4+SRT 的示例：http: [//www.storiesinflight.com/js_videosub/](http://www.storiesinflight.com/js_videosub/)

# excel - 使用 VBA 验证复选框和单选按钮组

> ID：13059562
> 
> 赞同：0
> 
> 时间：2012-10-24T23:46:03.350
> 
> 标签：excel, vba

我有以下几组复选框和无线电组，想知道如何在 VBA 中分别验证它们。谁能指出我正确的方向？

例如，我要求在**周**组中至少选中复选框，并且每个单选按钮组（**优先级**、**演讲**风格、**房间结构**和**房间**类型）只需要进行选择。我将不胜感激任何代码向我展示如何完成此操作。

**周**- 复选框

> chk_week1, chk_week2, chk_week3, chk_week4, chk_week5,..., chk_week15

**优先级**- 单选按钮

> 优先级_y，优先级_n

**演讲风格**- 单选按钮

> Lecturestyle_trad，lecturestyle_sem

**roomstruc** - 单选按钮

> roomstruc_tiered, roomstruc_flat

**房间类型**- 单选按钮

> roomtype_lecture, roomtype_lab

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:58:41.393

你可以尝试这样的事情。命名帧优先级可能会返回奇怪的结果，所以我重命名了你的帧`frPriority`和`frLectureStyle`

```
Sub cbValidate_Click()
Dim ctl As Control, strOption As String, lLoop As Long

For lLoop = 1 To 15
    If Me.Controls("chk_week" & lLoop).Value = True Then GoTo nxtCheck0
Next

MsgBox "You didn't select a week"

nxtCheck0:

For Each ctl In Me.frPriority.Controls
    If ctl.Value = True Then GoTo nxtCheck1
Next

MsgBox "You didn't select a priority"

nxtCheck1:

For Each ctl In Me.frLectureStyle.Controls
    If ctl.Value = True Then GoTo nxtCheck1
Next

MsgBox "You didn't select a lecture Style"

nxtCheck1:

Unload Me
End Sub 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2016-08-17T17:17:02.240

您可以尝试类似下面的编码，因为当您在组中有许多控件时它会变得乏味：

1.  插入一个名为“MyForm”的用户表单，其中包含名为“chk01”、“chk02”...的复选框。”chk20 或任何你想要的复选框

2.  将以下声明放入代码模块（不是表单模块）

    ```
    Public CheckBoxGroup(1 To 20) As New MyForm 
    ```

3.  将以下声明放入表单代码中

    ```
    Public WithEvents ChkBoxGrp As CheckBox 
    ```

4.  以激活事件的形式初始化数组

    ```
    Private Sub UserForm_Activate()
    Dim i As Integer
        For i = 1 To 20 (or however many checkboxes you have
                set CheckBoxGroup (i).ChkBoxGrp = MyForm("chk" + Right("0" + CStr(i), 2))
        Next i
    End Sub

    Private Sub ChkBoxGrp_Click()
        Select Case val(Right(ChkBoxGrp.Name, 2))
                Case 1
                ‘Do whaever you want for chk01 box
            Case 2
                ‘Do whaever you want for chk01 box
            ……………
            End Select
    End Sub 
    ```

您可以对其他复选框事件使用相同的事件处理

# php - 比较两个字符串，通过 PHP 中的位掩码进行限制

> ID：13059563
> 
> 赞同：1
> 
> 时间：2012-10-24T23:46:04.887
> 
> 标签：php, string, bitmask

在某些 PHP 中，我需要比较两个字符串，但仅限于在位掩码中设置为 1 的位。我将如何实现这种行为？

我试过了：

```
$string1='aaabbb';
$string2='ababbb';
$bitmask='101101';
function compare($string1, $string2, $bitmask){
    $resultBitmask=(~($string1 ^ $string2)|~$bitmask);
} 
```

为了清楚起见，出于说明目的，我将`ff`字节写入`1`位掩码中。`ff`当生成位掩码时，它们实际上是十六进制的。`0`空字节也是如此。

每次调用函数时，字符串和位掩码的长度总是不同的。我设法获得了一组位进行比较，但由于长度不同，我无法检查它们是否都已设置。目前，我一直在使用`preg_match`匹配任意`ff`字节数的正则表达式，但有更优雅的解决方案吗？

编辑：由于字符串的长度不超过 4096 位，因此它们不能转换为数字。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-28T20:32:37.490

自行解决：

由于这将在运行期间重复许多相同长度的字符串，但运行之间的长度不同，因此我需要检查按位运算后的结果字符串是否全为 1 且长度正确。我意识到可以在需要时生成这个充满 1 的字符串，这种情况很少见，每 1000 次左右的字符串比较一次。我可以在运行之前生成字符串，如下所示：

```
$ones=str_repeat(chr(255), $byte_length); 
```

然后`compare(`稍微不同地定义函数：

```
function compare($string1, $string2, $bitmask){
    global $ones;
    $resultBitmask=(~($string1 ^ $string2)|~$bitmask);
    if ($resultBitmask=$ones){
         return 1;
    } else {return 0};
} 
```

诀窍是`str_repeat`我以前不知道的。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:52:20.303

这不是最简单的方法，但是：

```
$stillTheSame = true;
for($i=0;$i<=strlen($bitmask); $i++)
{
  if($bitmask[$i] == 1)
  {
    if($string1[$i] != $string2[$i]) 
    {
      $stillTheSame = false;
      break;
    }  
  }
} 
```

不确定您的实际检查逻辑，但这应该会有所帮助。

# machine-learning - 什么应该是随机梯度下降的足够通用的收敛标准

> ID：13059564
> 
> 赞同：1
> 
> 时间：2012-10-24T23:46:09.373
> 
> 标签：machine-learning

我正在为随机梯度下降实现一个通用模块。这需要参数：训练数据集，损失（x，y），dw（x，y） - 每个样本损失和每个样本梯度变化。

现在，对于收敛标准，我想到了：-

a) 每 10% 的 dataset.size 后检查损失函数，在某个窗口上取平均值

b) 在每 10-20% 的数据集大小之后检查权重向量之间差异的范数

c) 训练集上的误差稳定。

d）梯度符号的变化（再次，在每个固定间隔后检查） -

我注意到这些检查（检查精度等）还取决于其他东西，比如步长、学习率……而且效果可能因一个训练问题而异。

我似乎无法决定，通用停止标准应该是什么，无论在 SGD 模块中抛出的训练集 fx、df/dw 是什么。你们是做什么的？

另外，对于 (d)，n 维向量的“符号变化”是什么意思？因为，在 - 给定 dw_i，dw_i+1 中，我如何检测符号的变化，它甚至在超过 2 个维度上都有意义吗？

PS为非数学/乳胶符号道歉......仍然习惯了这些东西。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:06:48.287

首先，随机梯度下降是梯度下降方法的在线版本。更新规则一次使用一个示例。

假设，`f(x)`是单个示例的成本函数，SGD 对 N 维向量的停止标准通常是：

![在此处输入图像描述](../Images/8aa5f2a231934d2febdf30daec4921ad.png)

![在此处输入图像描述](../Images/740ae625eb4fd35523e7ecbdd6563f66.png)

有关详细信息，请参阅此^([1](https://i.stack.imgur.com/lSp7t.png))或此^([2](https://i.stack.imgur.com/GaAhH.png))。

其次，使用所谓的“小批量”对随机梯度下降有进一步的扭曲。它的工作原理与 SGD 相同，只是它使用多个训练示例来进行梯度估计。这种技术减少了梯度估计的方差，并且经常更好地利用现代计算机中的分层内存组织。见此^([3](http://deeplearning.net/tutorial/gettingstarted.html#stochastic-gradient-descent))。

# salesforce - 我可以在 force.com 上实施自己的身份验证流程还是违反服务条款？

> ID：13059568
> 
> 赞同：0
> 
> 时间：2012-10-24T23:46:31.457
> 
> 标签：salesforce, force.com

我只是想知道是否允许在 force.com 中实施我自己的身份验证过程，或者它是否违反服务条款或任何规则。链接到官方文档将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T09:15:29.557

如果您想为站点创建身份验证：[请查看此处](http://wiki.developerforce.com/page/Authenticating_Users_on_Force.com_Sites)。

如果您想在您的站点中获得经过身份验证的用户，基本上您需要为每个经过身份验证的用户提供许可证，我相信不允许创建您自己的身份验证，在我给您的链接中说：“请不要试图建立自己的认证过程”。

如果您的经过身份验证的用户已经拥有他们的许可证，您可以轻松自定义身份验证过程，这里有用于该[外观的 Site 类](http://www.salesforce.com/us/developer/docs/apexcode/Content/apex_classes_sites.htm)

希望这有帮助:)

# jquery - 让 jquery 数据表 + jeditable + makeEditable + autogrow（或弹性）插件一起玩得很好？

> ID：13059570
> 
> 赞同：2
> 
> 时间：2012-10-24T23:46:48.053
> 
> 标签：jquery, datatables, jeditable, autogrow

我在让所有这些 jquery 插件很好地一起玩时遇到了一些麻烦。具体来说，自动增长和弹性插件似乎都不适用于数据表和 markEditable 插件。这是一个代码片段：

```
 <script type="text/javascript" language="javascript" src="/scripts/jquery.jeditable.js"></script>
    <script type="text/javascript" language="javascript" src="/scripts/jquery.dataTables.editable.js"><\/script>

    <script type="text/javascript" charset="utf-8">
      $(document).ready(function() {
      var oTable = $( '#beta' ).dataTable( {
         "sPaginationType": "full_numbers",
         "aoColumnDefs": [ { "bVisible": false, "aTargets": [ 7 ] } ],
         "aaSorting": [[ 1, "desc" ]],
         "sDom": 'lfr<"giveHeight"t>ip'
       }).makeEditable( {
            sUpdateURL: "/testdb/cgi-bin/betaTags.cgi",
            "aoColumns": [ null,
                          {
                            indicator: 'Saving Status...',
                            tooltip: 'Click to select tag status',
                            loadtext: 'loading...',
                            type: 'select',
                            submit: 'Ok',
                            data: "{'':'Please select...', '1':'Open','2':'Done','3':'In test'}",
                            sUpdateURL: function(value, settings) {
                               ... some code to handle the select menu
                            }
                          },
                          null,
                          null,
                          {
                            indicator: 'Saving Post Create Problems Note...',
                            tooltip: 'Click to edit Post Create Problems Note',
                            type: 'textarea',
                            submit:'OK',
                            cancel : 'Cancel',
                            sUpdateURL: function(value, settings) {
                               ... some code to handle the textarea cell
                            }
                          },
                          null,
                          {
                            indicator: 'Saving Answer Changes Note...',
                            tooltip: 'Click to update Answer Changes Note',
                            type: 'textarea',
                            submit:'OK',
                            cancel : 'Cancel',
                            sUpdateURL: function(value, settings) {
                               ... some code to handle another textarea cell
                            }
                          }
                      ]
            } );
      } );
    </script> 
```

这很好用，但是当我尝试向 dataTable 中的 textarea 单元格添加自动增长或弹性方法时，它什么也没做。我无法找到许多示例来显示不同的 jquery 插件彼此协同工作，但如果有人可以向我指出一些文章或资源，将不胜感激！

# xml - 如何从 XPath 中的长字符串中选择符合条件的文本

> ID：13059573
> 
> 赞同：2
> 
> 时间：2012-10-24T23:47:03.910
> 
> 标签：xml, xslt, xpath

这是一段 XML 文档：

```
<book category="WEB">
    <title lang="en">XQuery Kick Start</title>
    <author>James McGovern</author>
    <author>Per Bothner</author>
    <author>Kurt Cagle</author>
    <author>James Linn</author>
    <author>Vaidyanathan Nagarajan</author>
    <year>2003</year>
    <price>49.99</price>
</book> 
```

我被要求使用 XPath 找出姓氏以大写“C”开头的作者。这个问题很简单，因为只有一个合格的，我可以在空格后使用函数 substring-after() 然后检查它是否以“C”开头。但也有可能这个人的名字很长，因此会出现中间名，比如 Kurt Van Persie Cagle。如何在最后一个空格之后准确地去除子字符串？

请解释和使用 XPath 中的功能。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T13:47:31.790

> 我被要求使用 XPath 找出姓氏以大写“C”开头的作者。

**通常，这是不可能用单个 XPath 1.0 表达式来选择的**。当然，这可以使用 XSLT 1.0 完成。

**使用 XPath 2.0**：

```
/*/author[starts-with(tokenize(., ' ')[last()], 'C')] 
```

**基于 XSLT 2.0 的验证**：

```
<xsl:stylesheet version="2.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform">
 <xsl:output omit-xml-declaration="yes" indent="yes"/>

 <xsl:template match="/">
     <xsl:sequence select="/*/author[starts-with(tokenize(., ' ')[last()], 'C')]"/>
 </xsl:template>
</xsl:stylesheet> 
```

当此转换应用于以下 XML 文档时：

```
<book category="WEB">
    <title lang="en">XQuery Kick Start</title>
    <author>James McGovern</author>
    <author>Per Bothner</author>
    <author>Kurt van Persy Cantor Bagle</author>
    <author>Kurt van Persy Cantor Cagle</author>
    <author>James Linn</author>
    <author>Vaidyanathan Nagarajan</author>
    <year>2003</year>
    <price>49.99</price>
</book> 
```

**计算 XPath 表达式并将选定的节点复制到输出：**

```
<author>Kurt van Persy Cantor Cagle</author> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T22:12:48.377

您可以使用“混乱”XPath，例如，您有 4 个字的限制`author`：

```
//author[
    (starts-with(substring-after(., ' '), 'C') and not(contains(substring-after(., ' '), ' ')))
    or
    (starts-with(substring-after(substring-after(., ' '), ' '), 'C') and not(contains(substring-after(substring-after(., ' '), ' '), ' ')))
    or
    (starts-with(substring-after(substring-after(substring-after(., ' '), ' '), ' '), 'C') and not(contains(substring-after(substring-after(substring-after(., ' '), ' '), ' '), ' ')))
] 
```

* * *

输入：

```
<book>
    <author>James McGovern</author>
    <author>Per Bothner</author>
    <author>Kurt Cagle</author>
    <author>James Linn</author>
    <author>James Linn</author>
    <author>Kurt Van Persie Cagle</author>
</book> 
```

以上 XPath 将选择 2 个作者：`Kurt Cagle`和`Kurt Van Persie Cagle`. 您可以扩展此 XPath 以匹配具有 5 个单词的作者，依此类推... :)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T13:42:56.970

跟进@DimitreNovaatchev 的出色解决方案，请注意，如果您的解析器能够使用[EXSLT 的字符串扩展函数](http://www.exslt.org/str/index.html)，您可以在 XSLT 1.0 中使用相同的标记化概念。

**例如，这个支持 EXSLT 的 XSLT 1.0 解决方案：**

```
<?xml version="1.0"?>
<xsl:stylesheet
  xmlns:xsl="http://www.w3.org/1999/XSL/Transform" 
  xmlns:str="http://exslt.org/strings"
  exclude-result-prefixes="str"
  version="1.0">
  <xsl:output method="xml" omit-xml-declaration="no" indent="yes"/>
  <xsl:strip-space elements="*"/>

  <xsl:template match="/">
    <xsl:copy-of
      select="/*/author[starts-with(str:tokenize(., ' ')[last()], 'C')]" />
  </xsl:template>

</xsl:stylesheet> 
```

**...应用于@Dimitre 修改后的输入 XML 时产生相同的期望结果：**

```
<author>Kurt van Persy Cantor Cagle</author> 
```

# scala - 为根包生成scaladoc

> ID：13059574
> 
> 赞同：4
> 
> 时间：2012-10-24T23:47:05.140
> 
> 标签：scala, documentation, packages, scaladoc

我很好奇如何记录*根包，在*[scala-doc](http://docs.scala-lang.org/)编译中显示为第一页。可以以某种方式创建一个引用根包的包对象，还是有任何配置选项？对此事的描述有些模糊。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-11-04T21:34:22.333

scaladoc 似乎有一个名为 -doc-root-content 的选项，它是在 2.9.2 中添加的。您可以在[scala 2.9.2 的 ant build.xml](https://github.com/scala/scala/blob/v2.9.2/build.xml#L1524)以及[编译器源代码](https://github.com/scala/scala/blob/v2.9.2/src/compiler/scala/tools/nsc/doc/Settings.scala#L84)中看到这一点。它在 2.9.1 中不存在，它是由[这个 commit](https://github.com/scala/scala/commit/90b0f1b98a5e747bed19b4389bf46ba16fdf734d)添加的。

# php - MYSQL 多表删除

> ID：13059576
> 
> 赞同：0
> 
> 时间：2012-10-24T23:47:38.303
> 
> 标签：php, mysql

我有两个这样的表设置：

```
Items:
   id (int)
   name (varchar)
   category (int)
   last_update (timestamp)

Categories
   id (int)
   name (varchar)
   tree_id (int) 
```

我想从 中删除所有记录`Items`，谁`last_update`不是今天，谁对应`categories.tree_id`等于 1。但是，我不想从`Categories`表中删除任何内容，只删除`Items`表。我试过这个：

```
$query = "DELETE FROM items USING categories, items
    WHERE items.category = categories.id
    AND categories.tree_id = 1
    AND items.last_update != '".date('Y-m-d')."'"; 
```

然而，这似乎只是删除了每一个`tree_id`为 1 的记录。它应该保留 a`tree_id`为 1 的项目，只要它们的`last_update`字段是`today`

我错过了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:54:15.937

如果 last_update 是一个时间戳字段，并且您只在 where 子句中传入一个日期（没有时间组件），那么您实际上是在执行此操作（例如，如果传入 2012-10-24）：

```
AND items.last_update != 2012-10-24 00:00:00 
```

这意味着时间戳中没有确切第二个值的每一行都将被删除。你最好做类似的事情

```
AND items.last_update NOT LIKE '".date('Y-m-d')."%'"; 
```

当然，您要确保在 last_update 上有一个索引。

或者，如果您不关心 last_update 字段上的索引性能（即，您只是将其作为一次性查询并且不想索引该字段），您可以这样做，这对某些人来说可能更符合逻辑

```
AND DATE(items.last_update) <> '".date('Y-m-d')."'" 
```

底线是您只需要以某种方式比较 last_updated 字段的日期部分。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:56:32.690

听起来你需要一个子查询

```
DELETE FROM items USING categories, items
    WHERE items.category = categories.id
    AND items.last_update != '".date('Y-m-d')."'"
    AND items.id in 
    (
      SELECT id from items inner join categories on item.category = categories.id
    ) 
```

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2012-10-24T23:54:24.407

您说 last_update 包含时间戳 - 我假设 UNIX 时间戳。您永远无法找到与执行时间戳时具有相同时间戳的记录，并且您无法将时间戳与格式化日期进行比较，它们永远不会对应。因此，您需要以 date(Ymd) 格式将数据存储在 last_update 列中，以便比较那些不相等的数据。

# android - 是否有用于简化 Google 云消息传递的 Java 库？

> ID：13059579
> 
> 赞同：7
> 
> 时间：2012-10-24T23:48:01.717
> 
> 标签：android, jakarta-ee, google-cloud-messaging

我想知道是否有任何库提供通过 GCM 轻松发送消息的接口？

查看架构概述，似乎您必须自己做很多事情（打开 TCP 连接、构建 HTTP 请求、构建 JSON 有效负载、实现指数退避、处理各种类型的错误等）。

当然，我错过了这些东西的某种基本实现，是吗？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-11-27T11:53:26.943

是的，它[在演示页面](http://developer.android.com/guide/google/gcm/demo.html)上有描述，来源[在这里](http://code.google.com/p/gcm/)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-12-03T20:45:18.913

另一种选择是利用[AirBop](http://www.airbop.com)等商业服务来承担服务器端职责。

# android - 在操作栏中编辑文本

> ID：13059580
> 
> 赞同：2
> 
> 时间：2012-10-24T23:48:11.663
> 
> 标签：android, android-actionbar, actionbarsherlock

我正在使用 Action Bar Sherlock 为我的应用程序创建 UI。在将依赖项添加到我的项目等之后，我创建了一个活动来测试它。

```
public class PPS extends SherlockActivity {

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    MenuInflater inflater = getSupportMenuInflater();
    inflater.inflate(R.menu.activity_main, menu);
    return true;
} 
```

}

我正在尝试更改操作栏的标题，但我不确定如何执行此操作。当我检查我所看到的所有activity_main时，没有元素可以更改活动中的文本。

```
<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
xmlns:tools="http://schemas.android.com/tools"
android:layout_width="match_parent"
android:layout_height="match_parent" > 
```

那么如何更改操作栏中的文本呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T06:44:27.873

在 onCreate() 中：

```
this.getActionBar().setTitle("your title here"); 
```

# silverlight - Windows 8 是否支持 Silverlight？

> ID：13059584
> 
> 赞同：-1
> 
> 时间：2012-10-24T23:48:28.013
> 
> 标签：silverlight, windows-8

使用 Silverlight 的现有应用程序（Web 和桌面应用程序）能否在 Windows 8 上运行？Windows RT 怎么样？

如果不可能，那么让它发挥作用的阻力最小的途径是什么？（即，如何让它在 Windows 8/RT 上运行，而不关心它是否可以在 Windows 9 上运行。）

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:56:23.473

现有 Silverlight 应用程序可以在 Windows 8 桌面上运行，但不能作为 Windows 应用商店应用程序的一部分运行。只有 Windows 应用商店应用程序可以在 Windows RT 上运行（Microsoft 提供的 Office 应用程序除外）。

阻力最小的路径是在 Windows RT 框架内利用您的资产 - 它仍然是 C#/VB 和 XAML。

您可以查看[这个 Deep Fried Bytes 插曲](http://deepfriedbytes.com/podcast/episode-78-migrating-silverlight-apps-to-windows-8-metro-with-derik-whittaker/)，还有其他博客文章可以为您提供一些指导。还有一篇关于开发中心的文章，重点介绍了从[Windows Phone 7 Silverlight 到 Windows 8](http://msdn.microsoft.com/en-us/library/windows/apps/hh465136.aspx)的内容，但很多内容也应该适用于您的场景。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-14T04:11:18.157

您的 WPF 和 Silverlight 应用程序在 Windows 8 上运行良好，但在 Windows 商店中却不行，它只需要 Metro 应用程序。但是您可以越来越轻松地将 Silverlight 应用程序移植到 Metro：您保留 XAML 文件，并使用在 Windows 8 库中定义的新对象更改后面的代码。

# visual-studio-2010 - 如何在 Visual Studio 2010 中停止打印警告消息

> ID：13059585
> 
> 赞同：0
> 
> 时间：2012-10-24T23:48:48.470
> 
> 标签：visual-studio-2010

Visual Studio 2010 输出窗口不断在输出窗口上打印出“警告：”消息。我想让它不打印出这些消息。我应该如何做到这一点？谢谢。（当然摆脱消息是最好的解决方案，但目前我只想隐藏这些消息）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:54:09.073

在项目的属性对话框中，您可以将警告级别更改为 0 以关闭所有警告。

说明可以在[这里](http://msdn.microsoft.com/en-us/library/13b90fz7%28v=vs.100%29.aspx)找到：

1.  打开项目的属性页面
2.  单击构建属性页面。
3.  修改警告级别属性。

# scala - Scala展平列表

> ID：13059590
> 
> 赞同：13
> 
> 时间：2012-10-24T23:49:16.170
> 
> 标签：scala, functional-programming

我想编写一个扁平化列表的函数。

```
object Flat {
  def flatten[T](list: List[T]): List[T] = list match {
    case Nil => Nil
    case head :: Nil => List(head)
    case head :: tail => (head match {
      case l: List[T] => flatten(l)
      case i => List(i)
    }) ::: flatten(tail)
  }
}

object Main {
  def main(args: Array[String]) = {
    println(Flat.flatten(List(List(1, 1), 2, List(3, List(5, 8)))))
  }
} 
```

我不知道为什么它不起作用，它返回`List(1, 1, 2, List(3, List(5, 8)))`但它应该是`List(1, 1, 2, 3, 5, 8)`。

你能给我一个提示吗？

* * *

## 回答 #1

> 赞同：33
> 
> 时间：2013-04-23T17:12:21.773

您不需要嵌套匹配语句。而是像这样进行匹配：

```
 def flatten(xs: List[Any]): List[Any] = xs match {
    case Nil => Nil
    case (head: List[_]) :: tail => flatten(head) ++ flatten(tail)
    case head :: tail => head :: flatten(tail)
  } 
```

* * *

## 回答 #2

> 赞同：16
> 
> 时间：2014-06-09T20:21:07.513

我的，相当于 SDJMcHattie 的解决方案。

```
 def flatten(xs: List[Any]): List[Any] = xs match {
    case List() => List()
    case (y :: ys) :: yss => flatten(y :: ys) ::: flatten(yss)
    case y :: ys => y :: flatten(ys)
  } 
```

* * *

## 回答 #3

> 赞同：11
> 
> 时间：2012-10-25T01:27:11.803

通过删除第 4 行

```
case head :: Nil => List(head) 
```

你会得到正确的答案。

考虑测试用例

```
List(List(List(1))) 
```

第 4 行列表中的最后一个元素将不会被处理

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2015-04-10T10:49:57.993

```
 def flatten(ls: List[Any]): List[Any] = ls flatMap {
    case ms: List[_] => flatten(ms)
    case e => List(e)
  } 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2020-05-19T18:49:29.923

如果有人不理解这行可接受的解决方案，或者不知道您可以使用类型注释模式：

```
case (head: List[_]) :: tail => flatten(head) ++ flatten(tail) 
```

然后看一个没有类型注释的等价物：

```
case (y :: ys) :: tail => flatten3(y :: ys) ::: flatten3(tail)
case Nil :: tail => flatten3(tail) 
```

因此，只是为了更好地理解一些替代方案：

```
def flatten2(xs: List[Any]): List[Any] = xs match {
  case x :: xs => x match {
    case y :: ys => flatten2(y :: ys) ::: flatten2(xs)
    case Nil => flatten2(xs)
    case _ => x :: flatten2(xs)
  }
  case x => x
}

def flatten3(xs: List[Any]): List[Any] = xs match {
  case Nil => Nil
  case (y :: ys) :: zs => flatten3(y :: ys) ::: flatten3(zs)
  case Nil :: ys => flatten3(ys)
  case y :: ys => y :: flatten3(ys)
} 
```

```
val yss = List(List(1,2,3), List(), List(List(1,2,3), List(List(4,5,6))))
flatten2(yss) // res2: List[Any] = List(1, 2, 3, 1, 2, 3, 4, 5, 6) 
flatten3(yss) // res2: List[Any] = List(1, 2, 3, 1, 2, 3, 4, 5, 6) 
```

顺便说一句，第二个发布的答案将执行以下操作，您可能不希望这样做。

```
val yss = List(List(1,2,3), List(), List(List(1,2,3), List(List(4,5,6))))
flatten(yss) // res1: List[Any] = List(1, 2, 3, List(), 1, 2, 3, 4, 5, 6) 
```

# c - 函数中使用的 fopen 将文件地址包含在字符串中

> ID：13059592
> 
> 赞同：1
> 
> 时间：2012-10-24T23:49:33.767
> 
> 标签：c, fopen, ansi, palindrome

我正在从事一项计算机编程作业，以从文件中读取行并确定它是否为 a(n)：

*   不纯回文：忽略标点和大小写

    例如：*Madam I'm Adam*是一个不纯的回文。

*   纯回文：检查标点和大小写

    例如*，无星上的邪恶老鼠*是一个纯粹的回文。

我已经为这两种情况创建了函数，它们工作正常。

我的问题在于打开文件

我有一个函数可以从 中读取文件名`argv[]`，它的意思是计算不纯/纯回文数和行数。而且它也有点工作但是！

当我使用我输入的`printf`函数检查输出时，我相信文件的地址包含在使用gets 时。除此之外它工作正常。当我将文件名硬编码到其中时，我的代码也可以工作。我认为这与指针和内存地址有关，但我很难过。

我已经阅读了与此类似的问题，但由于操作能够解决它，因此没有提供答案。

这是链接：[使用 fopen 在函数内打开文件](https://stackoverflow.com/questions/2755663/c-opening-a-file-inside-a-function-using-fopen)

我认为没有必要为这个问题包括我的纯回文和不纯回文函数。如果我错了，我很乐意将它们包括在内。

我的读取文件功能：

```
void read_file(const char* filename)
{
bool impure = false;
bool pure = false;

int purecount = 0;
int impurecount = 0;
int linecount = 0;

FILE *file = fopen(filename, "r");
if (file != NULL)
{
    char line[FILE_LEN];
    char line1[FILE_LEN];

    while (fgets(line, sizeof line, file) != NULL)
    {
        printf("%s\n", line);
        sscanf(line, "%[^\n]", line1);
        pure = is_a_pure_palindrome(line1);
        impure = is_an_impure_palindrome(line1);
        printf("%s\n", line);

        if (pure == true)
            purecount++;
        else if (impure  == true)
                impurecount++;

        linecount++;
    }
    fclose(file);

    printf("There are %d pure palindromes and %d impure palindromes and %d lines\n", purecount, impurecount, linecount);
}
else
{
    perror("fopen");
}

return;
} 
```

我的主要功能：

```
int main(int argc, char *argv[])
{
        int i = 0;
        for (;i< argc; i++)
        {
            read_file( argv[i]);
        }
        return EXIT_SUCCESS;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-24T23:53:47.540

`argv[0]`表示程序执行路径名。C/C++ 中的参数从 1 开始。

改成：

```
int i = 1;
for (;i< argc; i++)
{
    read_file( argv[i]);
} 
```

# regex - 在括号内添加引号 - 正则表达式

> ID：13059593
> 
> 赞同：2
> 
> 时间：2012-10-24T23:49:37.917
> 
> 标签：regex, replace

好的，所以我正在尝试使用我的文本编辑器（崇高文本）在正则表达式模式下进行查找和替换。我在多个文件中有数百个字符串，其中包含需要转换为 ['some_text'] 的 [some_text]。以下适用于匹配和替换不带引号的起始括号：

```
find:      \[(?!')
replace:   [' 
```

但是，查找之前不带引号的右括号的相同逻辑似乎匹配所有右括号，即使是之前带引号的括号。有任何想法吗？

```
find:      (?!')\]
replace:   '] 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-24T23:50:27.793

在第二种情况下，您需要使用lookbehind而不是lookahead：

```
find:      (?<!')\]
replace:   '] 
```

原因是向前看是`(?!...)`看正则表达式引擎当前位置的右侧。因此，如果您想匹配 a`]`并在其前面执行前瞻，则正则表达式引擎将根据`]`自身进行检查，这（当然）不是`'`.

另一方面，lookbehind 查看正则表达式引擎当前位置的左侧，这正是您想要的。

请注意，在这两种情况下，环视都不会消耗任何字符！检查它们不会提高正则表达式引擎的位置。这就是为什么环视的方向是相关的。

[您可以在此处](http://www.regular-expressions.info/lookaround.html)阅读有关外观和正则表达式引擎内部的更多详细信息。

（顺便说一句，您通常不需要 escape `]`。如果没有开头`[`，它永远不会被误认为是元字符。）

# java - GAE - 谷歌云存储 - 上传（acl：read-public 并获取公共共享 url）

> ID：13059594
> 
> 赞同：2
> 
> 时间：2012-10-24T23:50:12.127
> 
> 标签：java, google-app-engine, jsp, servlets, google-cloud-storage

目标是上传大文件（视频）并为它们获取公共共享 url。

看起来这很简单，但我花了一天多的时间查看文档，但我没有找到任何示例。

我得到以下代码来上传到谷歌商店，它工作正常，但我想在 url 中添加选项来制作文件的 acl：“public-read”。在 jsp 中上传之前或在 servlet 中上传之后。

```
<%@ page import="com.google.appengine.api.blobstore.BlobstoreServiceFactory" %>
<%@ page import="com.google.appengine.api.blobstore.BlobstoreService" %>
<%@ page import="com.google.appengine.api.blobstore.UploadOptions" %>
<%
BlobstoreService blobstoreService = BlobstoreServiceFactory.getBlobstoreService();

String uploadUrl = blobstoreService.createUploadUrl("/ajax?act=user&act2=video_upload", UploadOptions.Builder.withGoogleStorageBucketName("vidaao"));

%>

<%@ page language="java" contentType="text/html; charset=ISO-8859-1" pageEncoding="ISO-8859-1"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Upload Page</title>
</head>
<body>
    <h1>Upload v3</h1>

    <form name="form1" id="form1" action="<% out.print(uploadUrl); %>" method="post" enctype="multipart/form-data" target="upload_iframe">
    <input type="hidden" name="hiddenfield1" value="ok">
    Files to upload:
    <br/>
    <input type="file" name="myFile">
    <br/>
        <button type="submit">Send</button>
    </form>
    <iframe id="upload_iframe" name="upload_iframe"></iframe>

</body>

</html> 
```

然后在我的 servlet 某处重定向 url 以生成 blobkey 结束

```
public String upload(HttpServletRequest req, HttpServletResponse res) throws Exception{

    Map<String, BlobKey> blobs = blobstoreService.getUploadedBlobs(req);
    BlobKey blobKey = blobs.get("myFile");

    if (blobKey == null) {

        throw new Exception("Error file not uploaded");

    }

            //TODO: HERE get the public shared url of the file

    return " blob key = " + blobKey.getKeyString();

} 
```

在这一步，如果可能的话，我想拥有谷歌云存储的公共共享 URL。（我无法通过 servlet 提供文件，因为它可能会超时）

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:21:01.463

默认情况下，使用 createUploadUrl 上传到 bigstore 的文件是私有的。您需要自己修改 ACL 才能将其公开。

此外，您可以使用 serve() 从您的 servlet 从 Google 存储返回无限大小的 blob，如果您希望这样做而不是公开 blob，则无需担心超时。

# macos - 如何在 OS X 上的 IE 9 中进行测试？

> ID：13059599
> 
> 赞同：4
> 
> 时间：2012-10-24T23:50:37.993
> 
> 标签：macos, testing, browser, virtualization

我宁愿不花钱。我知道微软曾经维护一些可以导入 VirtualBox/等的 .VPC 图像，但我正在阅读另一个 StackOverflow，它说这不再起作用 - 强制激活。

想法？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T00:03:14.667

Github 上有一个名为`ievms`IE6、IE7、IE8 和 IE9 的虚拟机（都在不同的虚拟机上）。

说明（取自[这里](https://github.com/xdissent/ievms)的项目页面）：

```
 1\. Install VirtualBox
 2\. Download and unpack ievms
   - Install IE versions 6, 7, 8 and 9.
        curl -s https://raw.github.com/xdissent/ievms/master/ievms.sh | bash
   - Install specific IE versions (IE7 and IE9 only for example):
        curl -s https://raw.github.com/xdissent/ievms/master/ievms.sh | IEVMS_VERSIONS="7 9" bash
 3\. Launch Virtual Box
 4\. Choose ievms image from Virtual Box.
 5\. Install VirtualBox Guest Additions (pre-mounted as CD image in the VM).
 6\. IE6 only - Install network adapter drivers by opening the `drivers` CD image in the VM. 
```

更多细节可以在[项目页面](https://github.com/xdissent/ievms)上找到。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-02-16T16:52:59.487

事实上，你可以直接从[这里](https://www.modern.ie/en-us/virtualization-tools)下载一些虚拟机。希望能帮助到你！

# javascript - 用户在下拉菜单上选择项目后显示的文本？

> ID：13059607
> 
> 赞同：0
> 
> 时间：2012-10-24T23:51:20.833
> 
> 标签：javascript, html

我已经搞砸了好几天了，无法弄清楚。我对此并不陌生，其他人也曾尝试帮助我，但它不起作用。我基本上是在尝试制作一个下拉菜单表单，当用户单击下拉列表中的某个项目时，下拉列表旁边或下方会出现一个文本，上面写着“您已单击此”或我想要的任何内容，例如“选择这个，您节省了 10%！”

有人可以帮忙吗？我当前的代码是这样的：

```
<form>
<p align="center"><b>Select a Payment:</b>
<select id="setit" onchange="javascript:showRelatedValue(this.value)">
<option value="">Select one</option>
    <option value="">1 Month: $4.99</option>
    <option value="">3 Months: $14.99</option>
    <option value="">6 Months: $29.99</option></select>
<br />
<br />
     <input type="button" value="Add to Cart"
onclick="window.open(setit.options[setit.selectedIndex].value)">
</p>
</form>
<script>
     function showRelatedValue(String value)
     {
         if(value==1 Month: $4.99)
         alert("You have selected One Month");
         if(value==3 Months: $14.99)
         alert("You have selected Three Months");
         if(value==6 Months: $29.99)
         alert("You have selected Six Months");
     }
</script> 
```

或者有没有更好的方法来做到这一点？谢谢你的时间。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-24T23:54:49.710

试试这个 -[**演示**](http://jsfiddle.net/gzErA/)

```
<form>
<p align="center"><b>Select a Payment:</b>
<select id="setit" onchange="javascript:showRelatedValue(this.value)">
<option value="">Select one</option>
    <option value="1">1 Month: $4.99</option>
    <option value="3">3 Months: $14.99</option>
    <option value="6">6 Months: $29.99</option></select>
<br />
<br />
     <input type="button" value="Add to Cart"
onclick="window.open(setit.options[setit.selectedIndex].value)">
</p>
</form>
<script>
     function showRelatedValue(value)
     {
         if(value==1)
         alert("You have selected One Month");
         if(value==3)
         alert("You have selected Three Months");
         if(value==6)
         alert("You have selected Six Months");
     }
</script>​ 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:55:35.763

保存选项中的值。否则，您将不得不与完整的文本进行比较。

```
<form>
<p align="center"><b>Select a Payment:</b>
<select id="setit" onchange="javascript:showRelatedValue(this.value)">
<option value="">Select one</option>
    <option value="4.99">1 Month: $4.99</option>
    <option value="14.99">3 Months: $14.99</option>
    <option value="29.99">6 Months: $29.99</option></select>
<br />
<br />
     <input type="button" value="Add to Cart"
onclick="window.open(setit.options[setit.selectedIndex].value)">
</p>
</form>

<script>
     function showRelatedValue(value)
     {
         if(value== '4.99')
         alert("You have selected One Month");
         if(value== '14.99')
         alert("You have selected Three Months");
         if(value== '29.99')
         alert("You have selected Six Months");
     }
</script> 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-24T23:55:56.903

您不必指定参数的数据类型

```
 function showRelatedValue(value)
 {
     if(value == '1')
        alert("You have selected One Month");
     else if(value == '3')
        alert("You have selected Three Months");
     else if(value == '6')
        alert("You have selected Six Months");
 } 
```

也不需要在 onchange 事件中添加 javascript`onchange="showRelatedValue(this.value)"`

# magento - 尝试在 Magento 中计算单个商品的销售税而不显示含税价格

> ID：13059608
> 
> 赞同：1
> 
> 时间：2012-10-24T23:51:21.970
> 
> 标签：magento

Magento CE 版本。1.7.0.2

我正在尝试从我们的 Magento 商店获取一些订单数据以集成到我们的其他业务软件中。就我而言，我需要计算单个商品的价格加税。以下代码仅适用**于在目录中显示产品价格**设置为**包含**或**两者**（在系统 > 配置 > 销售 > 税中）。如何在网站显示不含税价格的同时计算商品的税金？

```
$customer_tax_class = Mage::getModel('tax/calculation')->getRateRequest()->getCustomerClassId();
$_product = Mage::getModel('catalog/product')->loadByAttribute('sku',$skunumber);
$my_price = Mage::helper('tax')->getPrice($_product, $_product->getPrice(), true, $shippingAddress, $billingAddress, $customer_tax_class); 
```

我也尝试使用它，但我仍然得到不含税的价格（除非我更改上述显示设置）：

```
$_finalPriceInclTax = Mage::helper('tax')->getPrice($_product, $_product->getFinalPrice(), true, $shippingAddress, $billingAddress, $customer_tax_class); 
```

我知道这一定是可能的，因为 Magento 在您下订单时会计算税款。任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-02T14:45:40.187

获得我需要的所有参数需要一段时间，因为我们使用的是高度定制的结帐，但这是最终对我有用的

```
 $my_quote = Mage::getSingleton('checkout/session')->getQuote();             
    $my_customer = Mage::getSingleton('customer/session')->getCustomer();
    $my_items = $quote->getAllItems();
    $taxClassId = $qty = $price = array();
    foreach ($my_items as $key => $my_item) {
      //get the price plus tax for this item
      // get the product tax id for this item first.
      $my_sku = $my_item->getSku();
      $qty[$my_sku] = $my_item->getQty(); 
      $taxClassId[$my_sku] = Mage::getModel('catalog/product')->load(
                  $my_item->getProductID())->getData("tax_class_id");
      $price[$my_sku] = Mage::getModel('catalog/product')->load(
                  $my_item->getProductID())->getData("price");
    }
    $my_store = Mage::app()->getStore($my_quote->getStoreId());
    $ctc = $my_customer->getTaxClassId();
    $tax_calc = Mage::getSingleton('tax/calculation');
    $tax_rate_req = $tax_calc->getRateRequest(
        $shippingAddress,
        $billingAddress,
        $ctc,
        $my_store);
    if(is_Array($taxClassId)){
    foreach($taxClassId as $key => $value){
      $my_rate[$key] = Mage::getSingleton('tax/calculation')->getRate(
                 $tax_rate_req->setProductClassId($value));
    }    
    foreach($my_rate as $key => $value){
      foreach($split_filter as $my_key => $my_value){
         //This is used because we split orders based on their shipping method
        if($my_value == $key){
        // This code might malfunction if tax rate is an integer (i.e. 8%)
        if(is_float($value)){
          $my_price = $price[$key];
          $my_qty = $qty[$key];
          $taxy = Mage::getModel('tax/calculation')->calcTaxAmount(
             $my_price, 
             $value
          );
          $price_withtax = $my_price + $taxy;
          // still need to multiply times qty ordered to get row totals
          $row_total = ($price_withtax * $my_qty);
        } else {// $value is not a float.
          $row_total = ($price[$key] * $qty[$key]);
        }
          // then add to other rows to get subtotal
          $subtotal_with_tax += $row_total;
      }
    } 
```

# rally - Lookback API：特定状态下的缺陷持续多长时间？

> ID：13059612
> 
> 赞同：1
> 
> 时间：2012-10-24T23:52:08.743
> 
> 标签：rally, lookbackapi

我们的缺陷中有一个称为“需要更多信息”的状态。我想创建一个随时间变化的图表，显示在任何特定时间段内处于该状态的缺陷数量。

我想我可以通过 Lookback API 使用以下查询获取信息：

```
my $find = {
    State                   => 'Need More Information',
    '_PreviousValues.State' =>  {'$ne' => 'Need More Information'},
    _TypeHierarchy          => -51006, # defect

    _ValidFrom  => {
        '$gte'  => '2012-09-01TZ',
        '$lt'   => '2012-10-23TZ',
    } 
```

我认为这会给我一个包含所有缺陷快照的列表，其中缺陷正在转换为“需要更多信息”状态，但事实并非如此（似乎列出了曾经处于“需要更多信息”状态的所有内容。

从技术上讲，我需要的是一个查询，它列出了从“需要更多信息”状态转换为或从“需要更多信息”状态转换的任何缺陷的快照，但由于这个更简单的方法似乎没有按我预期的那样工作，我想我会先问为什么上面的查询没有按我预期的方式工作。

返回的标题中的“生成的查询”是：

```
 'fields' => 1,
    'skip' => 0,
    'limit' => 100,
    'find' => {
        '_TypeHierarchy' => -51006,
        '_ValidFrom' => {
            '$gte' => '2012-09-01T00:00:00.000Z',
            '$lt' => '2012-10-23T00:00:00.000Z'
        },
        '_PreviousValues.State' => {
            '$in' => [
                undef,
                5792599066,
                5792599067,
                5792599065,
                5792599070,
                5792599071,
                5792599068,
                5792599073,
                5792599072,
                5792599075,
                5792599077,
                5792599076,
                5792599078,
                3631859989,
                3631859988,
                3631859987,
                3631859986
            ]
        },
        'State' => {
            '$in' => [
                4384150044
            ]
        }
    }
}; 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-27T18:52:34.067

我尝试利用该`$nin`条款并取得了成功。您可以尝试将查询调整为类似于以下内容：

```
find: {
        _Type: 'Defect',
        State: 'Need More Information',
        '_PreviousValues.State': {
            $in: [
                'Submitted', 'Open', 'Fixed', 'Closed'
            ]
        },
    etc...
    } 
```

# java - IntelliJ Android 插件：抑制 BuildConfig.java 的生成或更改它的写入位置？

> ID：13059614
> 
> 赞同：20
> 
> 时间：2012-10-24T23:52:19.493
> 
> 标签：java, android, intellij-idea

我试图阻止 IntelliJ 将生成的文件放在我的主要源文件夹中。这些生成的 .java 文件干扰了我与其他工具一起使用的 glob 规则。（想想`find -name '*.java'`。）

对于 Android 开发，我似乎能够自定义`R.java`AIDL 编译器生成的文件的输出目录和文件，但 IntelliJ 似乎坚持要在我的源代码树中创建`gen/`目录和写入文件。`BuildConfig.java`我能做些什么来阻止它吗？

我意识到通常，该`gen/`文件夹是在文件夹旁边创建的`src/`，但就我而言，我使用的是类似的东西：

```
<sourceFolder packagePrefix="com.example" /> 
```

所以在`gen/`下面创建的目录`com.example`看起来像一个新的包（`com.example.gen`），但它不是。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-04-02T07:50:33.910

点击 File->Project Structure->Facets，你可以在这里找到你的 android app，点击**Generated sources** here，现在你可以在这里设置**生成文件的目录**。</p>

# asp.net - 如何最好地在 ASP.NET 中递归查询 AD 组成员身份（使用 vb）

> ID：13059616
> 
> 赞同：4
> 
> 时间：2012-10-24T23:52:33.767
> 
> 标签：asp.net, vb.net, recursion, active-directory, ldap

我正在尝试通过以下两种方式之一找到查询 Active Directory 的最简单方法：

1.  给定一个 AD 用户名，找到该用户所属的所有组（包括嵌套组）。

2.  给定一个 AD 组名称，查找属于该组的所有用户（包括嵌套组中的用户）。

我的应用程序位于 v4.0 框架上的 VB.NET 中。我查看了来自许多不同 Google 搜索结果的建议，其中一些使用了 LDAP 和 System.DirectoryServices.DirectorySearcher（我认为这可能是最好的途径）。

但我正在转动我的轮子并正在寻找代码示例。

谢谢你。

更新：

我已经准备好这些部分：

`<add assembly="System.DirectoryServices, Version=3.5.0.0, etc."/>`

`<add namespace="System.DirectoryServices.AccountManagement" />`或者`Imports System.DirectoryServices.AccountManagement`

在这行代码上：

`Dim ctx As New PrincipalContext(ContextType.Domain)`

我仍然收到此错误： *未定义类型“PrincipalContext”*

当您提到“using 语句”时，我假设您的意思是我需要引用此命名空间。或者你的意思是我应该做这样的事情？

`Using ctx As New PrincipalContext(ContextType.Domain)`

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-12-17T10:14:58.283

一个完整的例子

此代码将通过枚举给定的组名称列出组和子组中的所有用户。此外，如果启用/禁用用户帐户。

要使用，只需调用 ListADGroupMembers("Some_Group_Name")。这会将用户的全名和手机号码填充到一个数组中，然后您可以循环访问该数组。

它非常简单，只需通读一遍。

```
Public ADUSers(,) As String
 Public n As Integer = 0

 Public Sub ListADGroupMembers(ByVal GN As String)

    Dim DirectoryRoot As New DirectoryEntry("LDAP://RootDSE")
    Dim DNC = DirectoryRoot.Properties("DefaultNamingContext")(0).ToString()
    Dim GroupName As String = GN '"G_All_IT_Users"
    Dim GroupMembers As System.Collections.Specialized.StringCollection = GetGroupMembers(DNC, GroupName)
    'Dim GroupMembersMobile As System.Collections.Specialized.StringCollection = GetGroupMembers(DNC, GroupName)
    '  For Each Member As String In GroupMembers
    '    ListBox1.Items.Add(Member)
    'Next Member

End Sub

Public Function GetGroupMembers(ByVal strDomain As String, ByVal strGroup As String) As System.Collections.Specialized.StringCollection

    Dim GroupMembers As New System.Collections.Specialized.StringCollection()

    Try
        Dim DirectoryRoot As New DirectoryEntry("LDAP://" & strDomain)
        Dim DirectorySearch As New DirectorySearcher(DirectoryRoot, "(CN=" & strGroup & ")")
        Dim DirectorySearchCollection As SearchResultCollection = DirectorySearch.FindAll()
        For Each DirectorySearchResult As SearchResult In DirectorySearchCollection
            Dim ResultPropertyCollection As ResultPropertyCollection = DirectorySearchResult.Properties
            Dim GroupMemberDN As String
            For Each GroupMemberDN In ResultPropertyCollection("member")
                Dim DirectoryMember As New DirectoryEntry("LDAP://" & GroupMemberDN)
                Dim DirectoryMemberProperties As System.DirectoryServices.PropertyCollection = DirectoryMember.Properties
                Dim DirectoryItem As Object = DirectoryMemberProperties("sAMAccountName").Value
                Dim DirectoryPhone As Object = DirectoryMemberProperties("mobile").Value
                Dim uac As Object = DirectoryMemberProperties("userAccountControl").Value

                If DirectoryMember.SchemaClassName = "group" Then
                    ' this is a group.                        
                    ListADGroupMembers(DirectoryItem)
                End If

                If DirectoryMember.SchemaClassName = "user" Then
                    ' this is a user.
                    If Nothing IsNot DirectoryItem Then
                        If AccEnabled(uac) = 1 Then ' check the ad account is enabled
                            GroupMembers.Add(DirectoryItem.ToString())
                            ListBox1.Items.Add(DirectoryItem.ToString() & " " & DirectoryPhone)

                            ADUSers(0, n) = DirectoryItem.ToString()
                            ADUSers(1, n) = DirectoryPhone
                            n += 1
                            ReDim Preserve ADUSers(1, n)
                        End If
                    End If
                End If

            Next GroupMemberDN

        Next DirectorySearchResult
    Catch ex As Exception
        MsgBox(ex.Message)
    End Try

    Return GroupMembers

End Function

  ' check account is active or not.
Function AccEnabled(ByVal uac As String) As String

    Dim aret As Integer = 0
    Select Case uac
        Case 512 'Enabled 
            aret = 1
        Case 514 ': ACCOUNTDISABLE()
            aret = 0
        Case 528 ': Enabled(-LOCKOUT)
            aret = 1
        Case 530 ': ACCOUNTDISABLE(-LOCKOUT)
            aret = 0
        Case 544 ': Enabled(-PASSWD_NOTREQD)
            aret = 1
        Case 546 ': ACCOUNTDISABLE(-PASSWD_NOTREQD)
            aret = 0
        Case 560 ': Enabled(-PASSWD_NOTREQD - LOCKOUT)
            aret = 1
        Case 640 ': Enabled(-ENCRYPTED_TEXT_PWD_ALLOWED)
            aret = 1
        Case 2048 ' : INTERDOMAIN_TRUST_ACCOUNT()
            aret = 1
        Case 2080 ': INTERDOMAIN_TRUST_ACCOUNT(-PASSWD_NOTREQD)
            aret = 1
        Case 4096 ': WORKSTATION_TRUST_ACCOUNT()
            aret = 1
        Case 8192 ': SERVER_TRUST_ACCOUNT()
            aret = 1
        Case 66048 ': Enabled(-DONT_EXPIRE_PASSWORD)
            aret = 1
        Case 66050 ': ACCOUNTDISABLE(-DONT_EXPIRE_PASSWORD)
            aret = 0
        Case 66064 ': Enabled(-DONT_EXPIRE_PASSWORD - LOCKOUT)
            aret = 1
        Case 66066 ': ACCOUNTDISABLE(-DONT_EXPIRE_PASSWORD - LOCKOUT)
            aret = 0
        Case 66080 ': Enabled(-DONT_EXPIRE_PASSWORD - PASSWD_NOTREQD)
            aret = 1
        Case 66082 ': ACCOUNTDISABLE(-DONT_EXPIRE_PASSWORD - PASSWD_NOTREQD)
            aret = 0
        Case 66176 ': Enabled(-DONT_EXPIRE_PASSWORD - ENCRYPTED_TEXT_PWD_ALLOWED)
            aret = 1
        Case 131584 ': Enabled(-MNS_LOGON_ACCOUNT)
            aret = 1
        Case 131586 ': ACCOUNTDISABLE(-MNS_LOGON_ACCOUNT)
            aret = 0
        Case 131600 ': Enabled(-MNS_LOGON_ACCOUNT - LOCKOUT)
            aret = 1
        Case 197120 ': Enabled(-MNS_LOGON_ACCOUNT - DONT_EXPIRE_PASSWORD)
            aret = 1
        Case 532480 'SERVER_TRUST_ACCOUNT - TRUSTED_FOR_DELEGATION (Domain Controller) 
            aret = 1
        Case 1049088 ': Enabled(-NOT_DELEGATED)
            aret = 1
        Case 1049090 ': ACCOUNTDISABLE(-NOT_DELEGATED)
            aret = 0
        Case 2097664 ': Enabled(-USE_DES_KEY_ONLY)
            aret = 1
        Case 2687488 ': Enabled(-DONT_EXPIRE_PASSWORD - TRUSTED_FOR_DELEGATION - USE_DES_KEY_ONLY)
            aret = 1
        Case 4194816 ': Enabled(-DONT_REQ_PREAUTH)
            aret = 1
        Case Else
            aret = 0
    End Select

    AccEnabled = aret

End Function 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2012-10-25T04:55:47.597

试试这个：

```
' set up domain context
Dim ctx As New PrincipalContext(ContextType.Domain)

' find a user
Dim user As UserPrincipal = UserPrincipal.FindByIdentity(ctx, "SomeUserName")

If user IsNot Nothing Then
    Dim groupMemberships = user.GetAuthorizationGroups()

            ' do something with group....
    For Each gp As GroupPrincipal In groupMemberships
    Next
End If 
```

您应该检查`System.DirectoryServices.AccountManagement`(S.DS.AM) 命名空间。在这里阅读所有相关信息：

*   [在 .NET Framework 3.5 中管理目录安全主体](http://msdn.microsoft.com/en-us/magazine/cc135979.aspx)
*   [System.DirectoryServices.AccountManagement 上的 MSDN 文档](http://msdn.microsoft.com/en-us/library/system.directoryservices.accountmanagement.aspx)

新的 S.DS.AM 使得在 AD 中与用户和组一起玩变得非常容易！

该方法`.GetAuthorizationGroups()`将进行递归搜索-因此您应该直接或间接获取用户所属的所有组。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-16T13:34:07.073

```
Imports System.Security.Principal

Private Function GetGroups(userName As String) As List(Of String)
    Dim result As New List(Of String)
    Dim wi As WindowsIdentity = New WindowsIdentity(userName)

    For Each group As IdentityReference In wi.Groups
        Try
            result.Add(group.Translate(GetType(NTAccount)).ToString())
        Catch ex As Exception
        End Try
    Next

    result.Sort()
    Return result
End Function 
```

所以只需使用 GetGroups("userID")。因为这种方法使用用户的 SID，所以没有进行显式 LDAP 调用。如果您使用自己的用户名，它将使用缓存的凭据，因此此功能非常快。

Try Catch 是必要的，因为在大型公司中，AD 是如此之大，以至于一些 SID 在太空中迷失了方向。

见[https://stackoverflow.com/a/19403297/2886367](https://stackoverflow.com/a/19403297/2886367)

# c# - 记录应用程序请求

> ID：13059617
> 
> 赞同：0
> 
> 时间：2012-10-24T23:52:55.760
> 
> 标签：c#, asp.net

我有几个登录用户与之交互的 Web 服务。目前它们在 ASMX 上运行，但正在等待升级到 WCF。我将编写一个记录器来跟踪请求的名称、用户 ID、参数、时间处理时间、是否有错误以及其他一些事情。我在想这样的事情：

```
public class MyWebService : System.Web.Services.Webservice
{
    MyAppLogger TheAppLogger = new MyAppLogger();

    [WebMethod(EnableSession = true)]
    public string SomeWebService(string SomeParameters)
    {
         TheAppLogger.StartLogging();
         TheJsonStringToReturn = "";

         try
         {
            //do something that populates TheJsonStringToReturn
         }
         catch
         {
             TheAppLogger.LogException();
         }

         TheAppLogger.LogRequest();

         return TheJsonStringToReturn;
    }
} 
```

我的问题是这样的：如果我按照我刚才描述的进行，该`LogRequest()`方法会在请求完成之前将请求存储在数据库中。这会是性能问题吗？我将如何更改此代码，以便在响应请求后进行数据库写入？

感谢您的建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:43:11.950

您有几个选择 - 排队、异步处理、产生工作线程等。请参阅这篇文章以获得一些好的答案：

[响应后进行数据库写入](https://stackoverflow.com/questions/9012604/doing-database-write-after-the-response)

# c# - Admob 广告冻结了一半的屏幕

> ID：13059618
> 
> 赞同：0
> 
> 时间：2012-10-24T23:53:13.577
> 
> 标签：c#, iphone, ios, xcode, admob

我正在使用 xcode，并且我有一个带有多个视图的 tabbarcontroller。

我刚刚添加了 admob 并使用以下代码将广告添加到每个视图（在 - (void)viewDidLoad 中）：

```
 AdViewController *myAdsVC = [[AdViewController alloc] init];
  [self.view addSubview: myAdsVC.view]; 
```

AdViewController 是 admob 视图。

问题是，当广告出现时，一半的屏幕无法使用。该应用程序运行良好，但屏幕中间无法单击、滚动或执行任何操作。我可以在空间的上方和下方滚动。

我附上了一张图片，显示了被冻结的空间。

[http://i.imgur.com/fN95g.png](http://i.imgur.com/fN95g.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:59:12.797

您应该尝试将 myAdsVC 的框架设置为：

```
myAdsVC.view.frame = CGRectMake(0, 0, 320, 50); 
```

# ruby-on-rails - 工厂女孩协会

> ID：13059623
> 
> 赞同：0
> 
> 时间：2012-10-24T23:53:58.380
> 
> 标签：ruby-on-rails, factory-bot

不太确定如何在 FactoryGirl 中建立关联，或者我所做的是否真的是一个关联。

在`users.rb`工厂：

```
FactoryGirl.define do
  factory :user do
    id 12345
    email joe@example.com

  factory :admin do
    id 67890
    email admin@example.com
  end
end 
```

集团拥有`email`.

在`groups.rb`工厂：

```
FactoryGirl.define do
  factory :group do
    association :admin.email, factory: admin
    id 123
  end 
```

所以，我想做的是使用管理员的电子邮件作为组实例的电子邮件属性。本质上我想`association :admin.email, factory: admin`评估为`admin@example.com`.

这是一个协会吗？怎么做？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T03:26:55.600

弄清楚了。这不是一个协会。

```
FactoryGirl.define do
  factory :group do
    email { admin.email }
    id 123
  end 
```

# jquery - 使用 jquery 检查输入表单的更好方法

> ID：13059626
> 
> 赞同：1
> 
> 时间：2012-10-24T23:54:11.490
> 
> 标签：jquery, forms, events, event-handling, onchange

我知道检查表单的最快捷方式可以是`.keyup()`或者`.keydown()`如果用户复制/粘贴一些文本呢？Tha 事件将被错过，但输入中的内容可能已更改。

此外，如果用户按下（或让）例如*alt*键，该事件将触发查询（在我的情况下无用）。

是否有任何类似的事件处理程序，如“文本更改”但实时检查？喜欢`onchange`但作为处理程序。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-24T23:58:10.800

您始终可以使用 bind() JQuery 方法检查用户是否正在复制/粘贴文本。在这里可以找到关于 Stack Overflow 的类似问题：[How do you handle oncut, oncopy, and onpaste in jQuery?](https://stackoverflow.com/questions/237254/how-do-you-handle-oncut-oncopy-and-onpaste-in-jquery)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:19:01.200

```
(function($){
    $.fn.oneinput = function(callback) {        
        function testInput(){ 
            var tb = jQuery(this);
            var currentValue = tb.val();
            if (tb.data("lastInput") !== currentValue ) {
                tb.data("lastInput",currentValue );
                if(callback) { 
                    callback.call(this) 
                };
            }
            return this;
        }    
        $(this).bind("keyup input paste", testInput);
    };
}(jQuery));

$('input').oneinput( function(){ console.log(this.value); }); 
```

# assembly - MIPS 程序集中的语法错误

> ID：13059630
> 
> 赞同：5
> 
> 时间：2012-10-24T23:54:39.100
> 
> 标签：assembly, syntax-error, mips

我的程序集文件有一个奇怪的问题。每次我将此文件加载到 PCSpim 中时，它都会在第 23 行给我一个语法错误。我查看了几篇参考资料并请了几位同学寻求帮助，但似乎没有人明白哪里出了问题。

```
.globl main

.data
test1:     .word 92
test2:     .word 81
finalExam: .word 90
a:         .ascii "Enter value A:\n"
b:         .ascii "Enter value B:\n"
grade:     .word 0
result:    .word 0
#More data...

.text
#Program calculates a final grade based off of two midterms and a final. Midterms are
#weighted 30% and the final is weighted 40%. Grade is out of 1000.
final: 
li    $t4, 3 #PCSpim complains here.
li    $t5, 4
la    $t0, test1
lw    $t1, ($t0)
mult  $t1, $t4
mflo  $t1
la    $t0, test2
lw    $t2, ($t0)
mult  $t2, $t4
mflo  $t2
la    $t0, finalExam
lw    $t3, ($t0)
mult  $t3, $t5
mflo  $t3
add   $t4, $t1, $t2
add   $t4, $t4, $t3
la    $t0, grade
sw    $t4, ($t0)
#Print result to console
li    $v0, 1 
move  $a0, $t4
syscall
jr    $ra

#Program continues... 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:12:00.030

好的，想通了，这种情况有两个问题。首先，Bare Machine 应该被禁用了，当我使用“b”作为标签时，又出现了另一个问题，因为 b 也被用作操作码。

感谢您检查这个！

# html - 底部 div 的 CSS 问题

> ID：13059643
> 
> 赞同：1
> 
> 时间：2012-10-24T23:55:48.743
> 
> 标签：html, css

我的页面底部有一个 div。它的CSS是：

```
#news-bottom {
color: white;
position: fixed;
white-space: nowrap;
overflow: hidden;
height: 66px;
bottom: 0;
right: 390px;
left: 180px;
padding: 5px;
border: 1px solid #CCC;
background-color: black;
} 
```

我在图像上有 div 的内容：![在此处输入图像描述](../Images/a44209e33397e9daad675cb9bca82f46.png) 内容 html：

```
<span>
    <span><b>Teste</b></span>
    <span>Teste com BBCodes</span>
    <img style="border: 1px solid #CCC; padding:2px; margin-left: -3px;" src="images/news/empty.png">
 </span> 
```

如何让我的 div 内容显示如下： ![在此处输入图像描述](../Images/599fb6daf8c1d785f6e04ab133b08394.png)

我不能使用换行符或表格，因为div的位置是固定的，现在我不知道该怎么办......

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:04:03.407

像[这样的 JSFiddle](http://jsfiddle.net/HvAFx/)应该可以工作。

我们所做的是将 应用于`background-color`容器的子项`div`。然后我们给他们一些`padding`，这在他们之间创造了空间。瞧！

HTML：

```
<div id="news-bottom">
  <span>
    <span><b>Teste</b></span>
    <span>Teste com BBCodes</span>
    <img style="border: 1px solid #CCC; padding:2px; margin-left: -3px;" src="images/news/empty.png">
 </span> 
```

CSS：

```
 #news-bottom {
   color: white;
   position: fixed;
   white-space: nowrap;
   overflow: hidden;
   height: 66px;
   bottom: 0;
   right: 390px;
   left: 180px;
   padding: 5px;
   border: 1px solid #CCC;
 }
 #news-bottom span span,
 #news-bottom span img {
   background-color: black;
   padding: 5px;
 }​​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:10:42.937

如果你想要固定位置，你可以制作几个 div 并将它们的`left`属性更改为你喜欢的。您可以使用`%`定位，使它们在不同分辨率下看起来几乎相同。

但是，我建议`float`在固定容器中使用`<div>`，并结合`margin`s 的 @jmeas 建议。像这样的东西：

HTML

```
<div class='container'>
    <div class='arrow'></div>
    <div class='item'>One</div>
    <div class='item'>Two</div>
    <div class='item'>Three</div>
    <div class='arrow'></div>
</div> 
```

CSS

```
#container {
   ...fixed...
}

.arrow {
   float:left;
   width:10%;
}

.item {
   float:left;
   margin-left:5px;
   width:20%;
} 
```

# php - 如何通过文件名的关键字匹配对文件数组进行排序

> ID：13059644
> 
> 赞同：0
> 
> 时间：2012-10-24T23:55:54.453
> 
> 标签：php, arrays, sorting, dir

我有这个排序功能，它扫描目录并列出所有`jpg`文件，我怎样才能让它只`jpg`对文件名与指定关键字匹配的文件进行排序，例如查找和排序`jpg`名称中包含关键字的所有文件`"toys"`。

```
 $a_img[] = array(); // return values
$keyword = "toys"; // your keyword
$allowed_types = array('jpg'); // list of filetypes you want to show  
 $dimg = opendir($imgdir);  
 while($imgfile = readdir($dimg)) {
     // check to see if filename contains keyword
    if(false!==strpos($keyword, $imgfile)){
       //check file extension
        $extension = strtolower(substr($imgfile, strrpos($imgfile, ".")+1));
        if (in_array($extension, $allowed_types)) {
        // add file to your array
        $a_img[] = $imgfile;
        }
    }   
}
// sort alphabetically by filename
sort($a_img);

   $totimg = count($a_img); // total image number  
   for($x=0; $x < $totimg; $x++)  
       { 

    $size = getimagesize($imgdir.'/'.$a_img[$x]);  
   // do whatever  

   echo $a_img[$x];  

  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:00:50.350

`strpos()`您可能希望使用- [http://php.net/manual/en/function.strrpos.php](http://php.net/manual/en/function.strrpos.php)检查文件名是否出现关键字- 并且只将这些文件添加到您的数组中。假设您想按文件名的字母顺序排序，您可以使用`sort()`函数对这个数组进行排序 - [http://php.net/manual/en/function.sort.php](http://php.net/manual/en/function.sort.php)

使用时请`strpos()`务必测试`!==false`文件名开头的关键字（例如“toys_picture.jpg”）是否会返回`0`，这是错误的，但不是错误的。

您还可以使用`strrpos()`- [http://www.php.net/manual/en/function.strrpos.php](http://www.php.net/manual/en/function.strrpos.php) - 查找文件名中最后出现的 a`.`并将其用于`substr()`支持 3 和 4 个字符的文件扩展名（例如“jpg”和“jpeg”）。

```
$imgdir = "idximages"; // directory
$keyword = "toys"; // your keyword
$allowed_types = array('jpg'); // list of filetypes you want to show  
$a_img = array(); // return values
$dimg = opendir($imgdir);  
while($imgfile = readdir($dimg)) {
    // check to see if filename contains keyword
    if(false!==strpos($imgfile, $keyword)){
        //check file extension
        $extension = strtolower(substr($imgfile, strrpos($imgfile, ".")+1));
        if (in_array($extension, $allowed_types)) {
            // add file to your array
            $a_img[] = $imgfile;
        }
    }   
}
// sort alphabetically by filename
sort($a_img);

// iterate through filenames
foreach ($a_img as $file){
    $imagesize = getimagesize($imgdir.'/'.$file);
    print_r($imagesize);
    list($width, $height, $type, $attr) = $imagesize;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:01:25.373

用于`strrpos`检查另一个字符串中是否存在子字符串

[http://php.net/manual/en/function.strrpos.php](http://php.net/manual/en/function.strrpos.php)

查看该页面上的示例，如果它不存在，您应该能够匹配`toys`并从您的数组中排除它

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:02:33.703

也许我错过了一些东西，但在你说“是的，它是 JPG”之后，你会做类似的事情：

```
if(strstr($imgfile, 'toys'))
{
  //carry on
} 
```

# github - 将一个 SVN 项目分叉到 GitHub，项目现在移到了 GitHub。可以合并吗？

> ID：13059647
> 
> 赞同：1
> 
> 时间：2012-10-24T23:56:23.890
> 
> 标签：github, git-svn

大约 2 个月前，我使用 git-svn (git svn rebase) 在 GitHub 上创建了一个 SVN 项目，并进行了更改，通过补丁文件发送了一些（但不是全部）。

现在项目搬到了 GitHub，有什么办法可以合并这两个 GitHub 项目，同时保留我的 fork 的历史？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T05:29:03.830

如果导入已正确完成，则从 SVN 在 GutHub 上导入的*内容*的 SHA1应该与 GitHub 上的 git-svn fork 生成的 SHA1 相同。

如果是这种情况，那么“[在 GitHub 中的分支之间合并](https://stackoverflow.com/questions/1123344/merging-between-forks-in-github)”是您的答案（或“[将更改从远程 GitHub 存储库合并到本地存储库](https://stackoverflow.com/questions/867831/merge-changes-from-remote-github-repository-to-your-local-repository)”）。

如果没有，最好从官方 GitHub 存储库重新创建您的分叉，并将您的工作作为补丁重新应用到所述新分叉之上。

# iis-7.5 - 无法在服务器上的 IIS 7.5 上访问站点

> ID：13059651
> 
> 赞同：0
> 
> 时间：2012-10-24T23:56:53.970
> 
> 标签：iis-7.5

我在服务器 x 上运行 IIS 7.5。我想从客户端 PC 访问一个名为 Test 的网站，该网站正在此服务器 x 上运行。当我登录到服务器并从 localhost 运行它时它可以工作。当我去 /Test 它说找不到文件或目录？我错过了什么？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:08:19.083

您是否在 IIS 中为您的站点创建了虚拟目录？那应该允许您导航。

创建虚拟目录：http: [//msdn.microsoft.com/en-us/library/ms751432.aspx](http://msdn.microsoft.com/en-us/library/ms751432.aspx)

# jquery - 在变量的帮助下查找/使用 jquery 数组

> ID：13059660
> 
> 赞同：0
> 
> 时间：2012-10-24T23:58:06.120
> 
> 标签：jquery, arrays, slider

我不知道如何正确定义我的问题。

我为每个 .slider 提供了一个函数，并且我还为每个滑块提供了一个带有“真实值”的变量。由于不同滑块的实际值的数量不同，我想我会在数组中计数值的帮助下查找替代的数量，然后将 max: *_*设置为该数字。使用[jQuery UI 滑块](http://jqueryui.com/slider/)。

我的代码：

```
 var costValues = [0, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000, 50000];
        var timeValues = ['Upp till 10 min', 'Upp till: 30 minuter', 'Upp till: 1h', 'Upp till tre timmar', 'Upp till en halvdag', 'Upp till en heldag', 'Upp till 2-3 dagar', 'Upp till en vecka', 'Upp till en månad', 'Upp till ett halvår', 'Upp till Ett år', 'Över ett år'];
        $( ".slider" ).each(function(i, e) {

..more Code 
```

“dennaArray”的内容与相关数组的名称相同，但我无法查找这些数组的 .length，因为它将“dennaArray”解释为本身带有“char 内容”的变量。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:03:47.223

阿利索，

从你的问题的第一个版本....

首先，制作普通 javascript 对象的数组属性：

```
var lookupArrays = {
    'cost': [0, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000, 50000],
    'time': ['Upp till 10 min', 'Upp till: 30 minuter', 'Upp till: 1h', 'Upp till tre timmar', 'Upp till en halvdag', 'Upp till en heldag', 'Upp till 2-3 dagar', 'Upp till en vecka', 'Upp till en månad', 'Upp till ett halvår', 'Upp till Ett år', 'Över ett år']
}; 
```

然后在`.each()`函数内部，您可以从以下两个数组中选择一个`lookupArrays`：

```
var dennaArray = lookupArrays[$(e).parent().attr('id')]; 
```

我不确定，但该`slide:`功能可能会简化为：

```
slide: function( event, ui ) {
    $(e).parent().find('.slider-result').html( dennaArray[ui.value] );
}, 
```

不要忘记使用`var`. 您的代码中有几个应该本地化但不是。

## 编辑

这是具有一些压缩和效率节省的代码：

```
$(function() {
    var $$ = {//cache of static jquery objects
        content: $('#content').hide(),
        rightColumn: $('#rightColumn').hide(),
        aktiviter: $('div.aktivitet'),
        tagSwitches: $('li.tag'),
        skickaFeedback: $('#skickaFeedback'),
        sliders: $('.slider'),
        describers: $('.describers'),
        header: $('#header'),
        h3: $('h3')
    };
    var lookupArrays = {
        'cost': [0, 20, 50, 100, 200, 500, 1000, 2000, 5000, 10000, 50000],
        'time': ['Upp till 10 minuter', 'Upp till: 30 minuter', 'Upp till: 1h', 'Upp till tre timmar', 'Upp till en halvdag', 'Upp till en heldag', 'Upp till 2-3 dagar', 'Upp till en vecka', 'Upp till en månad', 'Upp till ett halvår', 'Upp till Ett år', 'Över ett år'],
        'timeSimplified': ['tid-1', 'tid-2', 'tid-3', 'tid-4', 'tid-5', 'tid-6', 'tid-7', 'tid-8', 'tid-9', 'tid-10', 'tid-11', 'tid-12']
    };
    var dolj, visaContent;
    $$.sliders.each(function(i, e) {
        var $e = $(e),
            $parent = $e.parent();
        var dennaArray = lookupArrays[$parent.attr('id')];
        $e.slider({
            animate: true,
            range: "min",
            value: 0,
            min: 0,
            max: dennaArray.length-1,
            step: 1,
            start: function( event, ui ) {
                clearTimeout(dolj);
                clearTimeout(visaContent);
            },
            slide: function( event, ui ) {
                clearTimeout(dolj);
                clearTimeout(visaContent);
                switch($parent.attr('id')) {
                    case 'cost':
                        var txt = (ui.value == 0) ? 'Det måste vara gratis.' : 'Upp till: ' + dennaArray[ui.value] + ':-';
                    break;
                    case 'time':
                    default:
                        var txt = dennaArray[ui.value];
                }
                $parent.find('.slider-result').html( txt );
            },
            stop: function(event, ui) {
                dolj = setTimeout(function () {
                    $$.sliders.add($$.describers).add($$.header.find('h2')).slideUp();
                    $$.h3.css('cursor', 'pointer');
                    $parent.next().children().andSelf().slideDown();
                    $$.header.find('h1').animate({
                        'font-size': '1.4em',
                    }, 1000, function() {
                    });
                }, 3500);
                visaContent = setTimeout(function() {
                    $$.content.add($$.rightColumn).slideDown();
                }, 400);
            }
        });
    });
    //Om du klickar på ngn av frågorna så visas slidern igen så att du kan ändra dina parametrar :D
    $('.question').click(function(){
        $(this).show().parent().children().toggle();
    });
    $$.rightColumn.on('click', 'li.tag', function(){
        $$.aktiviter.hide();
        $tagSwitch = $(this).toggleClass('active');
        $$.tagSwitches.each(function() {
            if($(this).hasClass('active')) {
                var filterID = $(this).attr('id').replace("filterid-",'');
                $$.aktiviter.filter("." + filterID).show();
            }
        });
    });
    $('#skickaFeedback').click(function(){
        $.ajax({
            type: "POST",
            url: "saveFeedback.php",
            data: "someFeedback=" + $(this).prev().val(),
            cache: false,
            success: function(html){
                alert('Tack för din feedback!');
                $('#skickaFeedback').prev().val('');
            }
        });
    });
}); 
```

# qt - QGraphicsScene::setSceneRect() 分段错误

> ID：13059664
> 
> 赞同：2
> 
> 时间：2012-10-24T23:58:49.553
> 
> 标签：qt, debugging

我有一个 QGraphicsScene，我正在向其中添加一个名为 BorderRect 的子类 QGraphicsRectItem，它指示 sceneRect 的边界。BorderRect 具有允许用户更改其大小的夹点，然后更改场景的 sceneRect。所有这些都有效，除了偶尔会导致段错误，回溯如下：

```
#0  _int_malloc (av=0x7ffff587e620, bytes=32) at malloc.c:3415
#1  0x00007ffff55592a4 in *__GI___libc_malloc (bytes=32) at malloc.c:2924
#2  0x00007ffff5e4c40d in operator new(unsigned long) () from /usr/lib/gcc/x86_64-pc-linux-gnu/4.5.3/libstdc++.so.6
#3  0x00007ffff723911e in QRegion::QRegion(QRect const&, QRegion::RegionType) () from /usr/lib64/qt4/libQtGui.so.4
#4  0x00007ffff72394de in QRegion::intersect(QRect const&) const () from /usr/lib64/qt4/libQtGui.so.4
#5  0x00007ffff7239509 in QRegion::operator&(QRect const&) const () from /usr/lib64/qt4/libQtGui.so.4
#6  0x00007ffff723952f in QRegion::operator&=(QRect const&) () from /usr/lib64/qt4/libQtGui.so.4
#7  0x00007ffff70e0c6b in QWidgetPrivate::subtractOpaqueSiblings(QRegion&, bool*, bool) const ()
  from /usr/lib64/qt4/libQtGui.so.4
#8  0x00007ffff72b6141 in QWidgetPrivate::scrollRect(QRect const&, int, int) () from /usr/lib64/qt4/libQtGui.so.4
#9  0x00007ffff712fe8a in QWidgetPrivate::scroll_sys(int, int) () from /usr/lib64/qt4/libQtGui.so.4
#10 0x00007ffff70eefe5 in QWidget::scroll(int, int) () from /usr/lib64/qt4/libQtGui.so.4
#11 0x00007ffff76b7fbb in QGraphicsView::scrollContentsBy(int, int) () from /usr/lib64/qt4/libQtGui.so.4
#12 0x00007ffff6b7c0fa in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) ()
  from /usr/lib64/qt4/libQtCore.so.4
#13 0x00007ffff770ec7e in QAbstractSlider::valueChanged(int) () from /usr/lib64/qt4/libQtGui.so.4
#14 0x00007ffff76b0dca in QGraphicsViewPrivate::recalculateContentSize() () from /usr/lib64/qt4/libQtGui.so.4
#15 0x00007ffff76bab39 in ?? () from /usr/lib64/qt4/libQtGui.so.4
#16 0x00007ffff6b7c0fa in QMetaObject::activate(QObject*, QMetaObject const*, int, void**) ()
  from /usr/lib64/qt4/libQtCore.so.4
#17 0x00007ffff7687a45 in QGraphicsScene::sceneRectChanged(QRectF const&) () from /usr/lib64/qt4/libQtGui.so.4
#18 0x000000000042fef0 in BorderRectItem::sceneEventFilter (this=0xfc0070, watched=0xef6e80, event=0x7fffff800590)
    at gui/BorderRectItem.cpp:193
... 
```

还有几行，但后面跟踪的第 18 行引用的行对应于对 setSceneRect 的调用，其 QRectF 对应于 BorderRect 的新尺寸，在本例中：

```
{xp = 20, yp = -59, w = 563.94193411401511, h = 436.5631806793956} 
```

我不知道为什么这会崩溃。我检查了现场，它不是空的。我怀疑这将很难调试，而我真正感兴趣的是有关如何进行此操作的提示。特别是，当我在回溯中上下移动时检查 Qt 代码中变量的状态会非常有帮助，但我不知道该怎么做。我正在运行 Linux ......我可以用调试符号或其他东西重建 Qt 吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T12:29:16.080

只是在这里猜测，但堆栈跟踪让我怀疑，您从自己的一些方法*返回*对本地堆栈 QRect 的引用，或对其他堆栈变量的引用（甚至是指向堆栈变量的显式指针，但这更难做到）。

是的，您可以使用调试符号编译 Qt，请参阅：

*   [http://doc.qt.digia.com/latest/install-x11.html#step-3-building-the-library](http://doc.qt.digia.com/latest/install-x11.html#step-3-building-the-library)
*   [http://doc.qt.digia.com/latest/configure-options.html](http://doc.qt.digia.com/latest/configure-options.html)

# html - 密码输入中的自定义字形

> ID：13059665
> 
> 赞同：1
> 
> 时间：2012-10-24T23:59:01.987
> 
> 标签：html, css

有没有办法将系统默认字形更改为星号或输入密码字段中的其他任何内容？我知道 -webkit-text-security 存在，但我想使用自定义图像和/或字符。这是可能的还是为此目的存在任何好的jQuery插件？

# objective-c - UIScrollview 不会滚动，尽管内容大小正确；textview 子视图框架也表现得很奇怪

> ID：13059666
> 
> 赞同：0
> 
> 时间：2012-10-24T23:59:09.363
> 
> 标签：objective-c, uiscrollview, uitextview

我有一个 UITextView，它从 RSS 提要动态设置其文本。textview 是 UIScrollview 的子视图。最终，我正在创建一个移动报纸应用程序，因此用户应该能够滚动浏览文本（和其他子视图）。

在 IB 中创建视图后，我添加了

```
NSString *sourceCode = [NSString stringWithContentsOfURL:[NSURL URLWithString:self.URL] encoding:NSUTF8StringEncoding error:&error];
sourceCode = [self parseHTMLText:sourceCode];
CGSize maximumLabelSize = CGSizeMake(320,9999);
CGSize txtStringSize = [sourceCode sizeWithFont:self.body.font
                              constrainedToSize:maximumLabelSize];
CGRect newlblFrame = CGRectMake(0, 0, 320, txtStringSize.height);
self.body.frame = newlblFrame; //body is the textview
self.body.text = sourceCode;
self.scroll.contentSize=CGSizeMake(320, self.body.frame.size.height+300); //scroll is scrollview 
```

一个典型的 NSLog 将显示`body frame = {{0, 0}, {320, 2088}} scrollview frame = {{0, 0}, {320, 417}} scrollview content size = {320, 2388}`

但是，当我运行应用程序时，`body`它的界面构建器高度保持在 196 左右，并且滚动视图不会滚动（当我移动它时，它只是弹回原来的位置）

附带说明一下，当我尝试使用 手动更改 textview 的框架时`CGRectMake`，NSLog 显示正确的高度，但视图看起来并没有什么不同。我确保它在 IB 中正确连接，因为我可以调整其他属性，例如背景颜色。

编辑：

在我将`cliptoBounds`textview 的属性设置为 后`NO`，textview 现在会调整其高度并尝试显示整个文本。但是，它在屏幕末尾切断，我仍然无法滚动。

这是我目前看到的。为了方便起见，我将滚动视图的背景颜色设为灰色。我不确定为什么部分滚动视图部分为白色，部分为灰色。（标题）是一个单独的标签btw） ![在此处输入图像描述](../Images/094c047e3a405365afc60a2ed5c10d6e.png)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:56:51.387

总是如果 some`UIView`包含另一个类，它是子类，`UIView`并且您需要对此视图执行一些操作，请设置 `parentView.userInteractionEnabled = YES;`

我建议您检查视图的层次结构，也许滚动视图不包含您要显示的文本，例如

```
for (UIView *view in parentView.subviews){
    NSLog(@"%@", view);
} 
```

问候

# java - 在 play 2.0 中加载 initial-data.yml 时出现问题

> ID：13059670
> 
> 赞同：4
> 
> 时间：2012-10-24T23:59:51.613
> 
> 标签：java, playframework-2.0, snakeyaml

我正在尝试在 play1.2.4 中移植到 YABE 以播放 2.0.4 Java。为此，我创建了一个 initial-data.yml 并尝试使用 Global.java 加载它

```
#用户
用户：
    - !!models.User
        电子邮件：bob@gmail.com
        密码：秘密
        全名：鲍勃
        isAdmin: 真
#帖子

帖子：

    - !!models.Post
        编号：1
        标题：关于模型层
        发表于：2009-06-14
        作者：     
            - !!models.User
                电子邮件：bob@gmail.com
        内容：>
                    该模型在 Play! 中处于中心位置！应用。切....   

```

我的 Global.java 在下面

```
public void onStart(Application app) {
        InitialData.insert(app);
    }

    static class InitialData {
        public static void insert(Application app) {
            if(Ebean.find(User.class).findRowCount() == 0) {
                Map<String, List<Object>> all = (Map<String, List<Object>>)Yaml.load("initial-data.yml");
                Ebean.save(all.get("users"));
                Ebean.save(all.get("posts"));
                Ebean.save(all.get("comments"));
            }
        }
    } 
```

加载时出现以下错误

**构造函数异常：空；无法为 tag:yaml.org,2002:models.Post 构造 java 对象；异常=无法创建属性=JavaBean 的作者=models.Post@1；没有为类模型找到合适的具有 3 个参数的构造函数。用户**

```
org.yaml.snakeyaml.constructor.ConstructorException: null; 无法为 tag:yaml.org,2002:models.Post 构造 java 对象；异常=无法创建属性=JavaBean 的作者=models.Post@1；没有为类模型找到合适的具有 3 个参数的构造函数。用户

     org.yaml.snakeyaml.constructor.Constructor$ConstructYamlObject.construct(Constructor.java:333)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructObject(BaseConstructor.java:183)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructSequenceStep2(BaseConstructor.java:277)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructSequence(BaseConstructor.java:248)

     org.yaml.snakeyaml.constructor.SafeConstructor$ConstructYamlSeq.construct(SafeConstructor.java:440)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructObject(BaseConstructor.java:183)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructMapping2ndStep(BaseConstructor.java:326)

     org.yaml.snakeyaml.constructor.SafeConstructor.constructMapping2ndStep(SafeConstructor.java:143)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructMapping(BaseConstructor.java:307)

     org.yaml.snakeyaml.constructor.SafeConstructor$ConstructYamlMap.construct(SafeConstructor.java:459)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructObject(BaseConstructor.java:183)

     org.yaml.snakeyaml.constructor.BaseConstructor.constructDocument(BaseConstructor.java:142)

     org.yaml.snakeyaml.constructor.BaseConstructor.getSingleData(BaseConstructor.java:128)

     org.yaml.snakeyaml.Yaml.loadFromReader(Yaml.java:480)

     org.yaml.snakeyaml.Yaml.load(Yaml.java:411)

```

知道为什么会这样吗？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T08:13:17.133

曼努埃尔，感谢您的帮助。

当我稍微修改 YAML 时，我让它工作了，我只是删除了“-”，它位于“model.class”前面

```
#用户
用户：
    - !!models.User
        电子邮件：bob@gmail.com
        密码：秘密
        全名：鲍勃
        isAdmin: 真
#帖子

帖子：

    - !!models.Post
        编号：1
        标题：关于模型层
        发表于：2009-06-14
        作者：!!models.User
                电子邮件：bob@gmail.com
        内容：>
                    该模型在 Play! 中处于中心位置！应用。切....   

```

知道“-”代表什么吗？

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2012-10-25T06:15:22.907

我使用 YAML 已经有一段时间了，但看起来您好像在 Post 中重新创建了一个新用户，而不是引用 Bob。

我会尝试这样的事情：

```
models.User(bob):
  email:      bob@gmail.com
  password:   secret
  fullname:   Bob
  isAdmin:    true

models.Post(firstPost):
  id:         1
  title:      About the model layer
  postedAt:   2009-06-14
  author:     bob
  content:    The model has a central position in a Play! application. 
```

# c# - 如何获得系统的玻璃颜色？

> ID：13059676
> 
> 赞同：2
> 
> 时间：2012-10-25T00:00:40.047
> 
> 标签：c#, windows, winforms, colors, system

> **可能重复：**
> [Vista/7：如何获得玻璃颜色？](https://stackoverflow.com/questions/3560890/vista-7-how-to-get-glass-color)

由于 Windows Vista 可以自定义系统颜色：
![颜色定制](../Images/3179ac42c76879ef624eea35ab57dd2d.png)

如何以编程方式将当前设置的系统颜色设置为 ARGB 或 HEX 值？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T00:13:09.440

要获得玻璃的颜色，您可以查看以下任一帖子：

[https://stackoverflow.com/a/5262555/340045](https://stackoverflow.com/a/5262555/340045)

或者

[Vista/7：如何获得玻璃颜色？](https://stackoverflow.com/q/3560890/340045)

# gwt - GWT 国际化是否需要 Maven 中的 i18n 目标？

> ID：13059682
> 
> 赞同：0
> 
> 时间：2012-10-25T00:01:42.953
> 
> 标签：gwt, maven, internationalization

我正在使用 GWT 和 Maven 开展一个项目，其中包括国际化。在我看来，构建和运行 i18n 生成的文件比手动将新字符串添加到我的常量接口中需要更长的时间。我的问题是：我是否需要在 POM 中包含 i18n 目标？或者它只是一个旨在使从预先存在的属性文件创建常量接口变得更容易的工具？我是 Maven 新手，相信目标只是一个工具，但根据我的研究无法确认它是不需要的。谢谢你提供的所有帮助。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:15:36.320

不，不是必需的——正如你所说，它只是为了让它更容易。目标也是如此`gwt:generateAsync`，它根据`RemoteService`您已经定义的子类型为您构建 Async RPC 接口。

我不使用任何一个 - 我更喜欢自己构建，并在需要（或不需要）的地方记录。我的 poms 只包括一个`gwt:test`用于我设计的任何单元测试的，以及一个`gwt:compile`用于实际编译为 JavaScript 的。

请记住，很大一部分 GWT 开发人员不使用 Maven，如果没有这些目标，常量/消息和 RPC 仍然可以正常工作。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:29:46.307

如果你问我，你不应该**在**`i18n`你的 POM 中使用目标。它应该只偶尔使用一次，以将您的代码（接口）与属性文件同步。在日常工作中，您应该使用*规范*语言环境的界面并手动更新翻译的属性文件。

您可以对无法*从*`Constants`属性文件中推断出的or接口执行太多操作：非字符串常量、消息中的复数等。`Messages`

# java - Java List 接口 contains(Object o) 方法签名

> ID：13059685
> 
> 赞同：3
> 
> 时间：2012-10-25T00:02:14.387
> 
> 标签：java, interface

> **可能重复：**
> [为什么 Java 集合删除方法不是通用的？](https://stackoverflow.com/questions/104799/why-arent-java-collections-remove-methods-generic)

Java`Collection<E>`接口有一个`contains`具有以下签名的方法：

```
boolean contains(Object o) 
```

由于接口是具有类型的通用接口，`E`因此签名不应该是
`boolean contains(E o)`

反映这一点，并且只允许 type 的参数`E`。

`remove(Object o)`关于方法可以问同样的问题

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T00:05:54.077

和方法接受任何对象`contains`，`remove`因为它们接受（并且可以成功）可能不是`E`. [合同`contains`](http://docs.oracle.com/javase/6/docs/api/java/util/Collection.html#contains%28java.lang.Object%29)为：

> 当且仅当此集合包含至少一个元素 e 满足 (o==null ? e==null : o.equals(e)) 时才返回 true

请注意，`o`实际上不一定是集合中的对象；它必须只是通过`equals`测试。

同样的想法也适用`remove`。

另请参阅[此线程](https://stackoverflow.com/questions/104799/why-arent-java-collections-remove-methods-generic?lq=1)，其中指出 make`contains`和`remove`generic 会破坏许多现有的、完全有效的代码。

# c++ - 着色器输入布局无效

> ID：13059686
> 
> 赞同：4
> 
> 时间：2012-10-25T00:02:26.837
> 
> 标签：c++, directx, shader

我正在尝试将内容添加到我的工作代码中，但在调用**CreateInputLayout()**时它返回错误 [Invalid Arg] 。

在我添加纹理内容之前它可以工作，但是当我添加它时会失败。
编译的着色器文件没有错误。
我认为我制作布局的方式很糟糕。它是否正确？

C++ 顶点结构：

```
struct VertexData{
    XMFLOAT3 Pos;
    XMFLOAT4 Color;
    XMFLOAT2 TexCoord;
}; 
```

C++ 布局：

```
 D3D11_INPUT_ELEMENT_DESC inputLayout[]={
        { "POSITION", 0, DXGI_FORMAT_R32G32B32_FLOAT, 0, 0, D3D11_INPUT_PER_VERTEX_DATA, 0 },
        { "COLOR", 0, DXGI_FORMAT_R32G32B32A32_FLOAT, 0, 12, D3D11_INPUT_PER_VERTEX_DATA, 0 },
        { "TEXCOORD", 0, DXGI_FORMAT_R32G32_FLOAT, 0, 28, D3D11_INPUT_PER_VERTEX_DATA, 0 },
    }; uint lSize=sizeof(inputLayout)/sizeof(inputLayout[0]); 
```

着色器代码：

```
 // Stuff from DX Tutorial 7
Texture2D txDiffuse : register( t0 );
SamplerState samLinear : register( s0 );

cbuffer ViewData : register(b0){
    matrix World;
    matrix View;
    matrix Projection;
}

struct VS_INPUT{
    float4 pos : SV_POSITION;
    float4 color : COLOR0;
    float2 tex : TEXCOORD0;
};
struct PS_INPUT{
    float4 pos : SV_POSITION;
    float4 color : COLOR0;
    float2 tex : TEXCOORD0;
};

PS_INPUT VS(VS_INPUT input){
    PS_INPUT output=(PS_INPUT)0;

    output.pos=mul(input.pos, World);
    output.pos=mul(output.pos, View);
    output.pos=mul(output.pos, Projection);

    output.color = input.color;

    output.tex = input.tex;

    return output;
}

float4 PS(PS_INPUT input) : SV_Target {
    return input.color;
} 
```

**编辑：**

在对着色器代码进行了一堆玩弄之后，我发现如果我将...
**1st** position 的语义更改为： **float4 pos : POSITION;**
**第二个**位置： **float4 pos : SV_POSITION;**
...输入布局成功创建。

我在没有 SV_ [系统值] 前缀的情况下都尝试了，但这也失败了。我不知道为什么我不能让它们相同。

[语义](http://msdn.microsoft.com/en-us/library/windows/desktop/bb509647%28v=vs.85%29.aspx#Semantics_All1)似乎有点神奇。不知道我是否应该用这个回答我自己的 Q，或者等待更聪明的人更好地回答。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-26T20:31:47.300

您的结构不匹配：

```
struct VertexData
{
    XMFLOAT3 Pos;  // float3 here
    XMFLOAT4 Color;
    XMFLOAT2 TexCoord;
};

struct VS_INPUT{
    float4 pos : SV_POSITION; // float4 here
    float4 color : COLOR0;
    float2 tex : TEXCOORD0;
}; 
```

对于 3D 空间中的位置，我更喜欢使用 float3。因此，作为您的输入布局：

```
"POSITION", 0, R32G32B32_FLOAT 
```

关于语义魔术：HLSL 中的名称必须与输入布局名称匹配。例如：

布局：

```
{ "POSITION", 0, .. } 
```

顶点着色器：

```
float4 pos : POSITION0; 
```

唯一的例外是像素着色器必须始终具有像素输入位置的**语义**`float4 pos : SV_POSITION`（它是系统值**语义**之一）。

 **作为奖励，我想推荐一些常用的东西：

*   `int size = ARRYSIZE(inputayoutDesc);`
*   使用`D3D11_APPEND_ALIGNED_ELEMENT`而不是 12、28 数字作为对齐偏移量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T07:58:27.600

如果输入语义在您的输入顶点中，则输入语义不应该是 SV_POSITION，我认为它们应该是 POSITION。

您还声明了这一点-

```
struct VS_INPUT{
    float4 pos : SV_POSITION; 
```

这不应该是`float3 pos : POSITION;`

您的输入布局只有 3 个浮点数用于该项目。不确定是否是问题所在，但看起来不太正确。**

# ruby-on-rails - 是否有使用 heroku api (rails) 的示例？

> ID：13059695
> 
> 赞同：2
> 
> 时间：2012-10-25T00:03:25.637
> 
> 标签：ruby-on-rails, ruby, api, heroku

我正在尝试使用 heroku.api。因为heroku gem 已经贬值了。

我发现的是令人费解的狗早餐。
获取 api gem，在一个站点上验证密钥，在另一个站点上使用 curl 命令。然后调用方法..

我的应用程序在 heroku 上运行。我怀疑它知道这一点。为什么要让我跳到我们的圈子里，在他们的系统上为他们/为他们设计的东西。

反正..

**有谁知道如何使用这个 API 做某事的教程？** 就像获取我所在的堆栈（在代码中）或获取我正在运行的工人/测功机的数量？真的任何有效的东西......只是这样我才能看到如何让它工作

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T01:27:48.640

好的，所以第一件事：heroku gem 已被弃用，但 heroku 工具带以几乎相同的方式工作。除非您在应用程序中以编程方式执行此操作，否则无需转换为直接 API 调用。如果您这样做，请继续阅读：

使用 heroku-api 包装器。

```
gem install heroku-api 
```

[从https://dashboard.heroku.com/account](https://dashboard.heroku.com/account)获取您的 API_KEY

如果您想获取名为“your-app-here”的应用程序堆栈

```
require 'heroku-api'
heroku = Heroku::API.new(:api_key => YOUR_API_KEY)
puts heroku.get_app('your-app-here').body["stack"] 
```

或者告诉你目前有多少进程：

```
total_processes =  heroku.get_ps('your-app-here').body.count 
```

扩展到 2 个 Web 进程：

```
heroku.post_ps_scale('your-app-here', 'web', '2') 
```

您需要的所有信息：[https ://github.com/heroku/heroku.rb](https://github.com/heroku/heroku.rb)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:14:14.777

也许我误解了你想要做什么，但我根据他们的文档做了以下事情。

`curl -H "Accept: application/json" -u :SECRET -X GET https://api.heroku.com/apps`

[https://api-docs.heroku.com/apps](https://api-docs.heroku.com/apps)

这将返回一个 json 对象：

```
[
  {
    "id": 000000,
    "name": "example",
    "create_status": "complete",
    "created_at": "2011/01/01 00:00:00 -0700",
    "stack": "bamboo-ree-1.8.7",
    "requested_stack": null,
    "repo_migrate_status": "complete",
    "slug_size": 1000000,
    "repo_size": 1000000,
    "dynos": 1,
    "workers": 0
  }
] 
```

# java - AOP拦截器拦截同一JVM中的所有应用程序

> ID：13059697
> 
> 赞同：1
> 
> 时间：2012-10-25T00:03:38.413
> 
> 标签：java, aop, aspectj

我想知道是否可以跨在**同一 JVM**中运行的所有应用程序（例如 Glassfish 域）**拦截所有调用javax.persistence.EntityManager.flush()。**

 **以下还没有帮助;-(

```
@Aspect
public class TraceAspect {

    @Pointcut("within(@(@javax.persistence.PersistenceContext *) *)")
    public void entityManagers() {
    }

    @Pointcut("execution(@javax.persistence.EntityManager *.merge) && args(object)")
    public void merge(Object o) {
    }

    @Pointcut("execution(@javax.persistence.EntityManager *.createQuery) && args(string)")
    public void createQuery(String s) {
    }

    @AfterReturning("entityManagers() && merge(object)")
    public void afterMerge(JoinPoint joinPoint) {
        System.out.println(joinPoint);
    }

    @AfterReturning("entityManagers() && createQuery(string)")
    public void afterCreateQuery(JoinPoint joinPoint) {
        System.out.println(joinPoint);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-11-04T11:50:56.597

我对应用程序服务器/容器几乎一无所知，但基本上它应该是一个类加载问题。您有两个选择，始终假设要拦截的类在 JVM 中仅加载一次，而不是每个逻辑应用程序容器一次（在这种情况下，您将需要另一种方法，但它仍然是可能的）：

*   编译时二进制编织：编织包含要拦截的类的容器的 JAR 文件，创建新的 JAR 并用它们替换原始 JAR。在这种情况下，您只需要引导类路径中的 AspectJ 运行时 JAR 即可使其工作。

*   加载时编织：将 AspectJ weaver JAR 放在 JVM 的引导类路径中，并在加载时将建议应用于目标类。**

# php - 使用 Yahoo 搜索 API 时遇到问题

> ID：13059698
> 
> 赞同：1
> 
> 时间：2012-10-25T00:03:50.063
> 
> 标签：php, json, api, search, yahoo

我目前正在和我的一个好伙伴一起做一个项目，我们遇到了一些麻烦，我们想知道你们是否可以提供帮助？我们目前正在使用 yahoos 搜索引擎 API，它以 JSON 格式返回结果。是否可以使这些链接“可点击”？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T03:51:20.050

我不确定，你正在寻找这样的东西：

```
$yahooResponse = Yahoo response JSON data;
$linkUrl = $yahooResponse->url;
echo '<a href="$linkUrl">Clik here</a>'; 
```

# ruby - Sublimetext2 可以像 Textmate 一样执行 ruby 代码并在文档中显示结果吗？

> ID：13059700
> 
> 赞同：1
> 
> 时间：2012-10-25T00:04:02.447
> 
> 标签：ruby, textmate, sublimetext2, execution

Textmate 允许在文档中运行代码并以 irb 样式显示结果：

```
1+1 # => 
```

运行代码（我不记得快捷方式）

```
1+1 # => 2 
```

该行为是通过添加以下格式的注释来触发的：

```
# => 
```

在红宝石表达式之后立即使用魔术快捷方式。

我的问题是，1，什么是 Textmate 快捷方式，2，有没有办法在 SublimeText2 中实现相同的功能？

编辑：TextMate 快捷键是 Ctrl+Shift+Apple+E（执行并更新“#=>”标记）。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-30T14:19:57.617

也许这样的事情是你第二个问题的答案： [https ://github.com/wuub/SublimeREPL](https://github.com/wuub/SublimeREPL)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-21T18:54:14.963

似乎 Sublime Ruby Eval 扩展就是这样做的：

[https://github.com/jugyo/SublimeRubyEval](https://github.com/jugyo/SublimeRubyEval)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-10-21T22:03:08.003

I prefer to use [Ruby Markers](https://github.com/mmims/sublime-text-2-ruby-markers).

```
A Sublime Text 2 plugin to execute ruby code and update # => markers with the results using the xmpfilter component of rcodetools. 
```

Capturing STDOUT

```
3.times { puts "Hello World!" }
# >> Hello World!
# >> Hello World!
# >> Hello World! 
```

Code Annotation

```
def fib(n)
    n < 2 ? n : fib(n-1) + fib(n-2)
end

fib(11)     # => 89
fib(23)     # => 28657 
```

# meteor - Meteor All My Party 中的“soma.jpeg”有什么问题

> ID：13059704
> 
> 赞同：0
> 
> 时间：2012-10-25T00:04:39.870
> 
> 标签：meteor

我正在玩 Meteor 示例“我的所有派对”。我想用我社区地图的屏幕截图代替提供的社区。

首先，我将 css 更改为我自己的新 png 文件。它打开了，但图像重复出现。我在 css 中添加了 no-repeat，然后图像根本不会出现。

作品：

```
background-image: url('/eugene.jpeg'); 
```

不起作用：

```
background-image: url('/eugene.jpeg') no-repeat; 
```

我尝试在 Photoshop 中打开提供的“soma.jpeg”，但出现无效错误。我最终将后缀更改为 png 并在 Photoshop 中打开，然后我重新保存它，并再次重命名后缀。

现在我的邻居出现了。. . 但谁能告诉我出了什么问题？首先，为什么他们的文件有 jpeg 而不是 jpg？为什么那个 jpeg 不能在 Photoshop 中打开？与 jpeg 相比，为什么 png 无法正常运行？为什么添加 no-repeat 会使图像根本无法加载？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T09:03:33.113

它只是一个重命名为 .jpeg 的 .png 文件，这没有任何意义。重命名文件并将css更改为： background-image: url('/soma.png'); 背景重复：不重复；对我来说很好。

.jpeg 和 .jpg 指的是相同的文件类型。.jpg 后缀可能是建立的，因为较旧的操作系统只允许 3 个字符后缀。

# http - 如何压缩/压缩客户端发送的 Multipart HTTP 请求

> ID：13059706
> 
> 赞同：2
> 
> 时间：2012-10-25T00:04:44.530
> 
> 标签：http, compression, gzip, multipart, multipartentity

我正在使用 apache httpclient 4.2 发送 Multipart HTTP PUT 请求。客户端必须上传 500 MB 左右的大尺寸二进制数据。因此需要压缩。我希望压缩整个 Multipart HTTP 请求并通过 header Content-Encoding: gzip 通知服务器。我控制服务器以及客户端代码。

注意：我知道我可以选择性地压缩大尺寸二进制数据而不是整个请求的方法，但现在我排除了这种方法。

httpclient 的 HttpRequestInterceptor 类不提供请求输入流的句柄或压缩请求的实体。

我在网上搜索并发现了一些相关链接（如下），但它们都不起作用 1\. [http://old.nabble.com/compressing-multipart-request-from-custom-client-tt27804438.html#a27811350](http://old.nabble.com/compressing-multipart-request-from-custom-client-tt27804438.html#a27811350) 2\. [http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#protocol_interceptors](http://hc.apache.org/httpcomponents-client-ga/tutorial/html/fundamentals.html#protocol_interceptors) - 这个链接说“协议拦截器还可以操作包含在消息中的内容实体 - 透明的内容压缩/解压缩是一个很好的例子。” 但不知道如何获得所需的功能。

如果可能的话，请给我一些指导，一些示例代码。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2014-03-17T23:39:27.970

我终于能够通过

1.  创建一个 org.apache.http.entity.mime.MultipartEntity 对象 reqEntity。
2.  将压缩的二进制部分添加到 HTTP 请求

    ByteArrayBody binaryData = new ByteArrayBody(compressedData, "binary/octet-stream", "N/A"); binaryParts.add(binaryData); reqEntity.addPart("uniqueId", binaryPart);

# ruby-on-rails - Rails 从控制器打印空格

> ID：13059707
> 
> 赞同：1
> 
> 时间：2012-10-25T00:04:46.697
> 
> 标签：ruby-on-rails, ruby, ruby-on-rails-3, whitespace

我想`@num`在我的 Rails 控制器中调试一个变量，所以我正在评估

```
<%= @num %> 
```

在我的 Rails 视图中。但是，当它在 HTML 中打印时，我无法区分`@num`being`'', ' '`和（以及其他不同类型的空白）。`' '`有什么办法可以清晰打印出来吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:09:12.983

如果你想确定：

```
<%= @num.inspect %> 
```

当`@num = ' '`这应该呈现：

```
" " 
```

`#inspect`当您想将某个对象表示为字符串时，这非常有用。

如果这是一个复杂的对象或大型数组或深度散列，我通常更喜欢`#to_yaml`以某种可读的格式进行检查。

```
# controller
@foo = {:a => [:bar, :baz], :b => 123, :c => 'omg'}

# view
<pre><%= @foo.to_yaml %></pre>

# visible output
--- 
:b: 123
:c: omg
:a: 
- :bar
- :baz 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:09:53.923

```
 <%=debug @num %> 
```

将其格式化为haml。

```
<%= @num.inspect %> 
```

将其格式化为“p”。

请参阅[调试 Rails 应用程序](http://guides.rubyonrails.org/debugging_rails_applications.html)（rails 指南）

# android - 设置全局变量还是重复调用函数？

> ID：13059708
> 
> 赞同：0
> 
> 时间：2012-10-25T00:04:59.210
> 
> 标签：android, function, global-variables, sharedpreferences

我的应用程序有一些基于用户的一些设置的 UI 元素，我不确定我应该如何进行编码以获得最佳性能，而且谷歌似乎没有一个很好的方法来尝试找到这个之前已经问过了。

基本上我想检查设置中设置的应用程序版本 UI，我目前通过一个函数来做：

```
public String appVersion() {
    appSettings = currentActivity.getSharedPreferences(APP_SETTINGS, 0);
    String prefAppVersion = appSettings.getString("appVersion", "v2");

    return prefAppVersion;
} 
```

然后我将通过 if/else 语句显示某些 UI 元素：

```
 if (appVersion().equals("v2")) {
     // do something here
  }
  else {
     // do something else
  } 
```

如果我在我的应用程序中调用该函数 5-6 次（一遍又一遍地获取 SharedPreference），这是否会导致内存问题，或者我最好以某种方式声明一个获取 SharedPreference 一次然后将其用于测试的全局变量？我唯一关心的是，如果 Preference 发生变化，并且如果变量未重置，则需要重新绘制 UI。

非常感谢您的想法/意见。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T03:07:50.793

我不认为 appVersion 函数会导致任何内存问题，但也许将 appSettings 作为局部变量会是一个更好的做法。

我不明白第二个问题，你的意思是如何知道正在改变的偏好？[SharedPreferences.OnSharedPreferenceChangeListener](http://developer.android.com/reference/android/content/SharedPreferences.OnSharedPreferenceChangeListener.html)可以帮助你。

# android - onActivityResult 方法不起作用。

> ID：13059709
> 
> 赞同：1
> 
> 时间：2012-10-25T00:05:11.190
> 
> 标签：android, android-activity

我有一个小型应用程序，它从我的主应用程序活动中启动“登录”活动作为子活动。登录活动使用 EditText 字段收集用户名和密码，然后在单击提交按钮后将凭据发送到主活动进行验证。但由于某种原因，我的 onActivityResult() 不起作用。我什至尝试包含一个 TextView，我将在该方法的不同点进行操作以推断出它出错的地方，但似乎该方法本身由于某种原因没有执行。任何帮助将非常感激。

我的主要活动：

```
public class MainActivity extends Activity {

private final String userName = "9590778";
private final String userPass = "1234567";

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);
}

@Override
public boolean onCreateOptionsMenu(Menu menu){
    getMenuInflater().inflate(R.menu.activity_main, menu);
    return true;
}

public void activity_about(View view){
    Intent aboutIntent = new Intent(this, AboutActivity.class);
    startActivity(aboutIntent);
}

public void activity_login(View view){
    Intent loginIntent = new Intent(this, LoginActivity.class);
    startActivityForResult(loginIntent, LoginActivity.LOGIN_REQUEST);
}

public void OnActivityResult(int requestCode, int responseCode, Intent resultIntent){
    String passedUser;
    String passedPass;

    Intent intent = getIntent();

    TextView lblTest = (TextView)findViewById(R.id.lblTest);
    lblTest.setText("ATLEAST THIS IS WORKING!"); //THIS IS WHERE I AM TRYING TO MANIPULATE THE TEXTVIEW TO SEE IF METHOD IS EXECUTING!

    if(requestCode == LoginActivity.LOGIN_REQUEST){

        passedUser = intent.getStringExtra("PASSED_USER");
        passedPass = intent.getStringExtra("PASSED_PASS");

        if(passedUser.equals(userName)){
            if(passedPass.equals(userPass)){
                lblTest.setText("LOGIN SUCCESSFUL!");
            }
        }
        else{
            lblTest.setText("ACCESS DENIED!");
        }
    }
} 
```

}

另外，这是我的登录活动：

```
public class LoginActivity extends Activity {

public static final int LOGIN_REQUEST = 9999;
public static final int LOGIN_RESPONSE = 1234;

private String passedUser;
private String passedPass;

@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_login);
}

@Override
public boolean onCreateOptionsMenu(Menu menu) {
    getMenuInflater().inflate(R.menu.activity_login, menu);
    return true;
}

public void submitCred(View view){

    Intent intent = getIntent();

    EditText lblUser = (EditText)findViewById(R.id.txtUserName);
    EditText lblPass = (EditText)findViewById(R.id.txtPassword);

    passedUser = lblUser.getText().toString();
    passedPass = lblPass.getText().toString();

    intent.putExtra("PASSED_USER", passedUser);
    intent.putExtra("PASSED_PASS", passedPass);
    setResult(LOGIN_RESPONSE, intent);

    finish();
}
} 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T00:13:34.857

你有一个错字，你想要的功能是`onActivityResult`，（注意小写`o`）。

在要覆盖的任何方法之前使用 @Override 语句是一个好习惯。如果您将 @Override`OnActivityResult`放在您的情况之前，它会向您抱怨这`OnActivityResult`不是超类方法。

这是一个很好的检查，以确保您拥有正确的名称和正确的参数。

# php - 尽管显式转换，但奇怪的浮点结果行为

> ID：13059710
> 
> 赞同：0
> 
> 时间：2012-10-25T00:05:13.810
> 
> 标签：php, variables, floating-point, double, decimal

好吧，我一整天都在处理这个问题，我认为这需要一些帮助。

**PHP**

```
$hour1 = (float) $date1 / 10000;
$hour1 = (float) floor($hour1);

$hour2 = (float) $date2 / 10000;
$hour2 = (float) floor($hour2);

$minute1 = (float) $date1 / 10000;
$minute1 = (float) $minute1 - floor($minute1);
$minute1 = (float) $minute1 / 60;
$minute1 = (float) $minute1 * 100;

$minute2 = (float) $date2 / 10000;
$minute2 = (float) $minute2 - floor($minute2);
$minute2 = (float) $minute2 / 60;
$minute2 = (float) $minute2 * 100;

$date = (float) ($hour1 + minute1) - ($hour2 + minute2);
$date = floatval($date); 
```

正如你所看到的，我在类型转换方面有点过火了。

**变量值**

```
$minute1 = .564478
$hour1 = 19

$minute2 = .9885546
$hour2 = 8 
```

`$date = (float) ($hour1 + minute1) - ($hour2 + minute2);`

**是**

`$date = (float) (19 + .564478) - (8 + .9885546);`

**现在给出的结果实际上是**

`11`

**并不是**

`10.575932......`

奇怪的是，当我在没有变量的情况下执行此操作时`echo (19 + .564478) - (8 + .9885546);`......我得到`10.575932......`.

我知道大多数编程语言都使用浮点数，但我已经尝试了所有方法，包括显式类型转换。这里发生了什么？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:12:24.823

```
$date = (float) ($hour1 + minute1) - ($hour2 + minute2); 
```

`minute1`你之前没有忘记 $`minute2`吗？？

如果你有，PHP 会将这个 vars 视为常量，并且`$hour1 - $hour2`在你的情况下只计算女巫返回 11

它应该看起来像

```
$date = (float) ($hour1 + $minute1) - ($hour2 + $minute2); 
```

# c++ - 如果输出使用 ++x 而不是 x++，输出是什么？

> ID：13059712
> 
> 赞同：-3
> 
> 时间：2012-10-25T00:05:41.003
> 
> 标签：c++

```
Int y = 0
Int x = 5
y = x++ 
```

与做类似的事情相比

```
Int y = 0
Int x = 5
y = ++x 
```

特别是，我在问后期增量的位置通常如何影响输出

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:09:59.567

如果前缀/后缀运算符是表达式或函数求值的一部分，它会确定修改变量的顺序，在求值之前（前缀）或求值之后（后缀）。

在第一种情况下，在递增`y`之前赋值。`x`

```
int y = 0;
int x = 5;
y = x++; 
```

在第二种情况下，`x`首先递增，然后`y`分配。

```
int y = 0;
int x = 5;
y = ++x; 
```

注意：如果在等式两边的数组索引中使用，[则行为可能是 undefined](https://stackoverflow.com/questions/1606407/index-assignment-and-increment-in-one-statement-behaves-differently-in-c-and)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:10:02.463

x++ 在操作后增加 x。

```
Int y = 0 Int x = 5 y = x++ 
```

Y 将等于 5，同时将 x 设置为等于 6。

```
Int y = 0 Int x = 5 y = ++x 
```

Y 等于 6，X 也等于 6。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:11:00.413

在第一种情况下，y = x++，x 是后递增的。也就是说，x 在赋值给 y 之后，其值增加了。

y = 5 和 x = 6。

在第二种情况下，y = ++x，x 是预先递增的。x 在其值分配给 y 之前增加值。

y = 6 和 x = 6

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T00:11:00.810

当运算符在变量之前时，它会（并且应该在编写自己的运算符时）执行操作然后返回结果。

```
int x = 1 ;
int y = x++ ; // y = 1, x = 2
int z = ++x ; // x = 3, z = 3 
```

我建议使用临时程序和输出来看看事情是如何运作的。当然，一本好书是最好的；）

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T00:17:56.433

```
pre-increment (++X)：表示 X 的值将在分配之前递增。
 在您的示例中，Y 的值将是 6，因为 X 首先递增（5+1）然后分配给 Y。

post-increment (X++)：表示 X 的值在赋值后会递增。
在您的示例中，Y 的值将为 5，因为 X 在分配给 Y 后会递增。

您可以将它们比较为：
++X = 就地增量
X++ = 增量发生在临时位置 (Temp=5+1)，在 Y 设置为其当前值 (5) 后分配给 X (X=Temp)。

Y = X++ 可以表示为：
  > 温度 = X+1
  > Y = X
  > X = 温度

```

# android - 我的代码不会运行？

> ID：13059715
> 
> 赞同：1
> 
> 时间：2012-10-25T00:05:56.093
> 
> 标签：android, media-player, fragment

我正在使用 Fragments，但是此代码无法运行。有人可以帮我弄这个吗。代码中的问题似乎与这部分“（start.this”）有关。

```
public class frag extends FragmentActivity {
public MediaPlayer mp = null;
@Override
public void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_main);

    Button b = (Button) findViewById(R.id.button1);
    b.setOnClickListener(new OnClickListener() {
        public void onClick(View v) {
            if (mp == null) {
            mp = MediaPlayer.create(start.this, R.raw.praise1);
            mp.start();
            }else {
                mp.stop();
                mp = null;
            }   }

    });
    }
  } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T03:00:09.667

更改`start.this`为实际上下文。您可以使用`getParent()`，也可以在创建之前存储上下文`onClickListener`并将其传递：

```
setContentView(R.layout.activity_main);
final Context context = this;

//inside the onClickListener
mp = MediaPlayer.create(context, R.raw.praise1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T03:19:11.847

将您的代码更改为

```
public class frag extends FragmentActivity {
public MediaPlayer mp = null;
 @Override
public void onCreate(Bundle savedInstanceState) {
super.onCreate(savedInstanceState);
setContentView(R.layout.activity_main);

Button b = (Button) findViewById(R.id.button1);
b.setOnClickListener(new OnClickListener() {
    public void onClick(View v) {
        if (mp == null) {
        mp = MediaPlayer.create(getApplicationContext(), R.raw.praise1);//==> Here is the change
        mp.start();
        }else {
            mp.stop();
            mp = null;
        }   }

});
 }
 } 
```

# sicp - SICP 的先决条件

> ID：13059722
> 
> 赞同：2
> 
> 时间：2012-10-25T00:06:46.173
> 
> 标签：sicp

我已经以“边做边学”的方式编程近 2 年了，我认为自己相当不错，但是，我真的希望为计算机科学/计算机工程打下良好的基础，大多数人建议我从 SICP 开始. （计算机程序的结构和解释）

我想知道

*   这是最好的方法吗？
*   我知道如何在 OpenMP 和 MPI 中编写矩阵乘法，而且我知道大学水平的数学，这足以阅读和欣赏 SICP 吗？
*   除了这个，我可以把所有的时间都花在 Project Euler 上吗？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2012-10-25T08:05:19.977

个人经历：和你一样，我正在尝试通过自学学习编程，我从 SICP 开始。由于我是一位古代历史学家和考古学家，我没有数学、工程或真正的计算机科学背景（只是熟悉 LaTeX、HTML 和 CSS 等知识）。我上一堂数学课现在是 15 年前。虽然我正在通过 SICP 和我身边的一本数学书工作，但 SICP 中给出的解释确实足以理解这些东西。我非常感谢 SICP，它要求很高，但很有趣。我还建议将其作为书购买，我更喜欢在屏幕上阅读。

有时您必须应对一些困难，因为语言标准发生了变化（例如，[运行基于 SICP 模式匹配规则的替换代码](https://stackoverflow.com/questions/6970006/running-sicp-pattern-matching-rule-based-substitution-code)）或者作者假设了本书后面刚刚定义的现有函数（例如，[我如何获得函数的放置和进入 SICP、Scheme、练习 2.78 等](https://stackoverflow.com/questions/5499005/how-do-i-get-the-functions-put-and-get-in-sicp-scheme-exercise-2-78-and-on)）。因为您总是会在网络上找到解决方案或提示，所以这不会打扰您。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2015-01-30T03:30:31.170

如果您知道任何数量的编程，您可能会更好，但这绝不是通过 SICP 时的要求。我现在正在经历它（从封面到封面的风格），我也在第 2.3.3 节。对我来说最大的障碍是数学如何基于一些问题，因为我已经有一段时间没有在高中做数学了。对于这些问题，我求助于谷歌搜索问题和解决方案的解释。就像编程一样，数学也不是必需的，显然因为我还在通过这本书取得进步，但我觉得它有时会有所帮助。

您真正需要的唯一要求是计算机和方案实现，我推荐 MIT 方案或 DrRacket。

### TL;博士

The only requirement you'll need is a computer, and a scheme implementation, everything else can be learned as you go along.

# git - 从主机访问访客虚拟机中托管的网页

> ID：13059725
> 
> 赞同：0
> 
> 时间：2012-10-25T00:07:11.343
> 
> 标签：git, windows-7, virtual-machine, virtualbox

我在我的 Windows 7 机器上运行的 VirtualBox (v4.2.0-r80737) 中有一个 Ubuntu VM，它托管了一个 git repo、网站和一些其他开发工具。它可以从其他机器轻松访问，也可以通过代理在主机上访问，但我无法直接在主机上访问站点/存储库。

VirtualBox 中虚拟机的网络设置如下：
附加到：桥接适配器
适配器类型：Intel PRO/1000MT 桌面
混杂模式：拒绝
连接电缆

我的猜测是主机试图通过 LAN 连接到网页，而不是更广泛的 Internet，并且由于某种原因被阻止。我不知道为什么，或者如何解决它，所以那里的任何帮助都会很棒。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:30:58.507

您是否尝试过仅主机适配器。我正在使用的自定义服务器解决方案遇到了这个问题，它似乎解决了这个问题。我不知道为什么，但它值得一试。告诉我它是否适合你。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:38:12.903

您的设置应该可以工作（您可能希望在主机文件的任一侧添加一个条目以使生活更轻松，但不是必需的）。我有相同的设置，它的工作原理。通常，它需要完全关闭虚拟机并重新启动它。

# objective-c - 读取串行数据时 CPU 消耗和延迟较高

> ID：13059726
> 
> 赞同：2
> 
> 时间：2012-10-25T00:07:43.360
> 
> 标签：objective-c, multithreading, cocoa, serial-port, usb

我的软件中有两个功能会导致重要的延迟问题。该软件是用Objective-C编写的。我从 USB 设备接收串行数据，我的目标是封装它们，然后将它们发送到另一个将处理数据的对象。

该程序的这一部分会导致较大的 cpu 和延迟问题，我根本不知道如何解决这个问题。该设备仅在其状态发生变化时发送数据，因此当发生大量变化时，一切都会变得滞后。

```
- (void)getSerialData {
    dispatch_queue_t queue = dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_DEFAULT, 0);
    dispatch_async(queue, ^{
    [self getSerialDataLoop];
    });
}

- (void)getSerialDataLoop {

readThreadRunning = YES;

char byte_buffer[2]; // buffer for holding incoming data
int numBytes=0; // number of bytes read during read
NSString *text;

// this will loop untilthe serial port closes
while(TRUE) {
    // read() blocks until some data is available or the port is closed
    numBytes = (int)read(serialFileDescriptor, byte_buffer, 1); // read up to the size of the buffer

    if(numBytes>0) {
        ///text = [NSString stringWithCString:byte_buffer encoding:NSSymbolStringEncoding];
        if(![text isEqualToString:@""]){
            text = [NSString stringWithUTF8String:byte_buffer];
            [self performSelectorOnMainThread:@selector(processNSStringData:) withObject:text waitUntilDone:YES];
        }
    } else {
        break; // Stop the thread if there is an error
    }

}
// make sure the serial port is closed
if (serialFileDescriptor != -1) {
    close(serialFileDescriptor);
    serialFileDescriptor = -1;
}

// mark that the thread has quit
readThreadRunning = FALSE;
} 
```

你有什么想法或建议吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:22:48.183

你基本上已经在这里彻底改造`NSStream`了。我首先建议您调查这个与运行循环相关的现有解决方案。

你也可以很容易地通过调用来压倒自己`getSerialData`。您的系统中没有任何东西可以阻止对该例程的多次调用，如果您进行多次调用，您将获得决斗并发操作。使用`NSStream`将解决这个问题。但是，无论如何，如果一个已经在运行，您不应该继续创建新的读取块。

您还一次读取一个字节并进行处理。这可能是你最大的影响。为每个字节回调主线程可能非常昂贵。如果没有别的，你正在`NSString`为每个字节创建一个新对象。

请注意，您的代码非常危险，可能会崩溃。你从不初始化`byte_buffer`，你只读入一个字节。当您调用 时`stringWithUTF8String:`，您假设第二个字节是 \0，这取决于堆栈的当前状态。

# html - Xhtml 过渡弹出窗口

> ID：13059727
> 
> 赞同：0
> 
> 时间：2012-10-24T22:00:14.677
> 
> 标签：html, css, hyperlink, xhtml

```
<a href="https://link" location="yes" resizable="yes" scrollbars="no" width="592" height="740" target="_blank"> 
```

不验证位置、可调整大小和滚动条都不是有效的 xhtml - 现在这些术语的替代品是什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T14:01:07.097

通过 Javascript 强制新窗口会给您带来很多麻烦，其中最重要的是大多数现代 Web 浏览器使用的流行的弹出窗口阻止程序。

处理此类链接的更好方法是通过 CSS“装饰”它们，使用提示链接目的地的图标，或警告他们正在从您的网站导航到外部来源的用户。

Smashing 杂志对此有一篇不错的文章：[http ://www.smashingmagazine.com/2010/02/13/the-definitive-guide-to-styling-web-links/](http://www.smashingmagazine.com/2010/02/13/the-definitive-guide-to-styling-web-links/)

PatomaS 所指的技术可以在代码示例中看到，虽然它们使用一个类，而不是查看 rel： [http ://www.electrictoolbox.com/add-offsite-link-icon-after-external-links- css/](http://www.electrictoolbox.com/add-offsite-link-icon-after-external-links-css/)

做同样的事情，但使用 rel，你可以将他们的 css 更改为：

```
a[rel="external"] {
    background: url(/images/external.png) center right no-repeat;
    padding-right: 13px;
} 
```

但是，您应该注意，此 CSS 在某些浏览器中不起作用。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-24T23:18:45.147

你可以用 JS 来做。

但是，如果您担心可用性，那么只需将链接保留为普通链接，不要使用额外的属性，让用户决定他想要做什么。如果您在内容中明确指出该链接更适合新窗口，那么用户很可能会以这种方式打开它。

如果您关心可用性但仍想将决定强加给用户，您可以使用 JS 但带有事件检测并检查用户是否单击了链接，然后捕获 url 并在新窗口/选项卡中打开它。如果您选择这种方式，链接将是这样的：

```
<a href="destination" rel="external" >text</a> 
```

当然，您可以使用任何属性，但到目前为止，该属性已被接受为最佳实践。

# java - 错误：没有“如果”的“其他”

> ID：13059729
> 
> 赞同：4
> 
> 时间：2012-10-25T00:07:53.053
> 
> 标签：java, if-statement, scope, curly-braces

得到一个没有 if 语句的 else：

```
import java.util.Scanner;

public class LazyDaysCamp
{
    public static void main (String[] args)
    {
        int temp;
        Scanner scan = new Scanner(System.in);

        System.out.println ("What's the current temperature?");
        temp = scan.nextInt();
        if (temp > 95 || temp < 20);
            System.out.println ("Visit our shops");
            else if (temp <= 95)
                if (temp >= 80)
                System.out.println ("Swimming");
                else if (temp >=60) 
                    if (temp <= 80)
                    System.out.println ("Tennis");
                    else if (temp >= 40)
                        if (temp < 60)
                        System.out.println ("Golf");
                        else if (temp < 40)
                            if (temp >= 20)
                            System.out.println ("Skiing");                                                                                                                                                                                                                                                                   
    }
} 
```

如果这就是它看起来像这样的原因，我需要使用级联。另外，如果我正确地进行了级联，你能告诉我吗？如果我只是尽力了解级联的含义，我就无法找到级联的好例子。

```
LazyDaysCamp.java:14: error: 'else' without 'if'
            else if (temp <= 95)
            ^
1 error 
```

这就是我得到的错误

* * *

## 回答 #1

> 赞同：20
> 
> 时间：2012-10-25T00:09:27.020

删除此行末尾的分号：

```
if (temp > 95 || temp < 20); 
```

请使用大括号！Java*不像*Python，缩进代码会创建一个新的块作用域。最好安全地使用它并始终使用大括号 - 至少在您获得更多的语言经验并准确理解*何时*可以省略它们之前。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T00:13:32.627

问题是第一个 if`if (temp > 95 || temp < 20);`与使用普通缩进相同

```
if (temp > 95 || temp < 20)
{
} 
```

也就是说，如果温度不在 20 到 95 之间，则执行一个空块。没有别的了。

下一行 else 然后没有与之对应的 if ，因此会产生您的错误

处理这个问题的最好方法是始终使用大括号来显示 if 之后执行的内容。这并不意味着编译器会捕获错误，但首先您更有可能通过查看缩进看到任何问题，并且错误可能看起来更具可读性。但是，您可以使用 eclipse、checkstyle 或 FindBugs 等工具来告诉您是否未使用 {} 或使用空块。

更好的方法可能是在重新测试时整理逻辑

```
if (temp > 95 || temp  < 20)  
{
  System.out.println ("Visit our shops");
} else if (temp >= 80)
{
    System.out.println ("Swimming");
} else if (temp >=60)
{ 
   System.out.println ("Tennis");
} else if (temp >= 40)
{
     System.out.println ("Golf");
} else if (temp >= 20)
{
   System.out.println ("Skiing");                                                                                                                                                                                                                                                                   
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T01:28:35.653

我将为您重新格式化。如果你使用大括号，你永远不会遇到这个问题。

```
public class LazyDaysCamp
{
    public static void main (String[] args)
    {
        int temp;
        Scanner scan = new Scanner(System.in);

        System.out.println ("What's the current temperature?");
        temp = scan.nextInt();
        if (temp > 95 || temp < 20) //<-- I removed the semicolon that caused the error
        {
            System.out.println ("Visit our shops");
        }
        else if (temp <= 95)
        {
            if (temp >= 80)
            {
                System.out.println ("Swimming");
            }
            else if (temp >=60)
            {
                if (temp <= 80)
                {
                    System.out.println ("Tennis");
                }
                else if (temp >= 40)
                {
                    if (temp < 60)
                    {
                        System.out.println ("Golf");
                    }
                    else if (temp < 40)
                    {
                        if (temp >= 20)
                        {
                            System.out.println ("Skiing");
                        }
                    }
                }
            }
        }
    }
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2019-09-21T13:12:16.543

出现此错误是因为您在 if 语句后输入了分号。删除第 12 行第一个 if 语句末尾的分号。

> ```
>  if (temp > 95 || temp < 20); 
> ```

# matlab - MATLAB - 数组的交集

> ID：13059731
> 
> 赞同：1
> 
> 时间：2012-10-25T00:08:02.080
> 
> 标签：matlab

我试图以图形方式找到两个曲面和 xy 平面之间的交点。（表面 z1 与 xy 平面的交点以及 z2 与 xy 平面的交点）

我已经创建了代表曲面 z1 = 3+x+y 和 z2 = 4-2x-4y 的数组以及使用网格网格的 xy 平面的 z3。到处看，似乎我可以用来查找数组之间交集的唯一命令是 intersect(A,B) 命令，其中 A 和 B 是数组。但是，当我输入 intersect(z1,z3) 时，我收到错误消息“A 和 B 必须是向量，或者必须指定‘行’。” 当我尝试相交 (z1,z2,'rows') 时，我返回一个 0×21 的空矩阵。我在这里做错了什么？

我的代码：

```
x = -10:10;
y = -10:10;
[X,Y] = meshgrid(x,y);
z1 = 3+X+Y;
z2 = 4-2.*X-4.*Y;
z3 = 0.*X+0.*Y;         %x-y plane
surf(X,Y,z1)
hold on
surf(X,Y,z2)
surf(X,Y,z3)
int1 = intersect(z1,z3,'rows');
int2 = intersect(z2,z3,'rows'); 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T03:09:57.427

听起来你想要 z1 = z2 的点。要以数字方式找到这些，您有几个选择。

1) 数值求根：`fsolve`能够求解方程组。您可以将曲面表示为一个向量的函数，`[x;y]`并求解使两个曲面相等的向量。使用初始猜测 x=1, y=1 的示例如下：

```
z1 = @(x) 3 + x(1) + x(2);
z2 = @(x) 4 - 2*x(1) - 4*x(2);
f = @(x) z1(x) - z2(x);

x0 = [1;1]
intersect = fsolve(@(x) f(x), x0); 
```

2）最小化错误：如果你被离散数据（数组而不是函数）困住，你可以简单地找到 z1 - z2 最接近零的点。一个简单的起点是获取数组 Z1 和 Z2 并找到差值接近于零的所有点：

```
tol = 1e-3;
near_zero = abs(Z1 - Z2) < tol; 
```

`near_zero`将是一个逻辑数组，只要 Z1 和 Z2 之间的差异相对于`tol`. 您可以使用它来索引 X 和 Y 的相应[网格网格](http://www.mathworks.com/help/matlab/ref/meshgrid.html)数组，以找到相交的坐标。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T13:44:10.850

解决此问题的简单方法（无主要函数调用）如下：

```
x = -10:.1:10;
y = -10:.1:10;
[X,Y] = meshgrid(x,y);
z1 = 3+X+Y;
z2 = 4-2.*X-4.*Y;
z3 = z1 - z2;
[~,mn] = min(abs(z3)); 
```

交点定义为`(x, y(mn))`。

这当然是一个数值近似（因为你想要一个数值方法），受制于我没有探索过的边界条件（在执行最小函数时，你需要忽略远离零的值）

注意：如果您正在寻找方程，请考虑对结果数据执行最小二乘逼近。

# sql - MS Access SQL 查询 - 显示最受欢迎的产品订购总量

> ID：13059732
> 
> 赞同：1
> 
> 时间：2012-10-25T00:08:13.457
> 
> 标签：sql, database, ms-access

我有一个表格（Order_line_t），格式如下：

```
Order_ID    Product_ID    Quantity
--------    ----------    --------
1001        1             2
1001        2             2
1001        4             1
1002        3             5
1003        3             1
1004        6             2
1004        8             2
1005        4             4
1006        1             1
1006        5             2
1006        7             2
1007        1             3
1007        2             2
1008        3             2
1008        8             3
1009        4             2
1009        7             3
1010        8             10 
```

我的目标是按如下方式显示每个产品按受欢迎程度降序排列的总数量：（我使用当前查询并单击列 Total_Quantity 的降序过滤器来实现此结果）

```
Product_ID    Total_Quantity
----------    --------------
8             15
4             8
3             8
7             5
1             5
2             4
6             2
5             2 
```

我已经尝试了 3 个小时来解决这个问题，但我不知道我的错误在哪里。我当前的 SQL 查询是这样的：

```
SELECT  Product_ID, SUM(Quantity) AS Total_Quantity
FROM Order_line_t
GROUP BY Product_ID 
```

我的查询结果是这样的：

```
Product_ID    Total_Quantity
----------    --------------
1             5
2             4
3             8
4             8
5             2
6             2
7             5
8             15 
```

在此先感谢，我刚刚开始学习 SQL。请多多包涵。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:11:39.833

```
SELECT  Product_ID, SUM(Quantity) AS Total_Quantity
FROM Order_line_t
GROUP BY Product_ID
ORDER BY SUM(Quantity) DESC; 
```

或者

```
SELECT Product_ID, Total_Quantity
FROM
(
    SELECT  Product_ID, SUM(Quantity) AS Total_Quantity
    FROM Order_line_t
    GROUP BY Product_ID
) SQ
ORDER BY Total_Quantity DESC; 
```

# hadoop - 大量交易数据信息模式生成

> ID：13059734
> 
> 赞同：1
> 
> 时间：2012-10-25T00:08:26.383
> 
> 标签：hadoop, distributed-computing, large-data-volumes

我试图从大量事务数据中找出信息数据模式。

通常，我的数据是具有明确定义的列的记录集（如发送者、接收者、金额、货币地址等 - 我有大约 40-50 个不同的列），数据量将是数百万（可能是数百万）记录，我的目标是从此类中生成信息丰富的交易模式——谁购买特定物品最多，交易量最高的接收者，费用模式，谁从同一个发送者那里获得更多交易等。

早些时候，我计划在关系数据库（Oracle/MySQL）中加载数据并编写复杂的 SQL 来获取这些信息，但是通过在我的概念验证期间查看容量，它似乎没有太大的可扩展性。

我试图获取有关使用 Hadoop 等进行分布式数据处理的更多信息。我刚开始阅读 Hadoop，直到我初步了解 Hadoop 非常适合非结构化数据处理，并且可能对关系数据处理没有多大用处。

关于开源技术的任何指示/建议，我可以快速尝试。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T03:40:15.487

Hadoop 可用于结构化/非结构化数据处理。此外，它不是像传统 RDBMS 那样维护关系、索引的数据库。

数百万行[HBase](http://hbase.apache.org/)或[Cassandra](http://cassandra.apache.org/)与 Hive相结合或不结合[Hive](http://hive.apache.org/)可用于批量查询。Hadoop 中的批量查询已经存在了一段时间并且已经成熟。

对于交互式查询，可以使用[Drill](http://incubator.apache.org/drill/)或[Imapala 。](http://blog.cloudera.com/blog/2012/10/cloudera-impala-real-time-queries-in-apache-hadoop-for-real/)请注意，Drill 开发刚刚开始并且处于孵化器阶段。同时，Cloudera 刚刚宣布了 Imapala。这里有[一些](http://gigaom.com/data/cloudera-makes-sql-a-first-class-citizen-in-hadoop/)关于实时引擎的有趣[信息。](http://www.wired.com/wiredenterprise/2012/10/cloudera-impala-hadoop/)

请注意，还有许多其他开源框架可能符合要求，但这里只提到了其中的几个。根据详细的需求分析和不同框架的优缺点，必须选择合适的框架。

# javascript - jQuery outterHeight 和 outterWidth 查找给定元素的右边缘和下边缘

> ID：13059735
> 
> 赞同：0
> 
> 时间：2012-10-25T00:08:34.500
> 
> 标签：javascript, jquery, dom

我正在阅读 jquery 文档，并且我认为 outterHeight/outterWidth 是我正在寻找的。但不确定如何使用它来满足我的需求。

总的来说，我有一个元素，我想添加一个子菜单，点击后，我希望这个菜单直接在触发器元素下排列。但我需要菜单元素的右边缘与触发元素的右边缘对齐。它的哪个排列部分，我敢肯定，一点点试验和错误会让我到达那里，它只是找到那些外边缘以及它们在哪里，就窗口/屏幕/所关心的而言。所以我可以将它们推到适当的位置。

我走这条路线的关键原因是因为这个菜单元素附加到散布在 UI 中的少数触发元素上，并为给定的触发元素动态重新创建。

无论如何，有人知道实现我目标的好方法吗？outterHeight/width 是我理想的解决方案吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:13:29.413

我认为更好的解决方案是使用`offset`或`position`像 jQuery UI datepicker 那样做。您在`body`级别创建菜单，并根据触发菜单的元素的偏移量定位它。

# sql - SQL 合并数据组

> ID：13059740
> 
> 赞同：1
> 
> 时间：2012-10-25T00:09:18.423
> 
> 标签：sql, join, group-by

我在表格中有以下数据

```
col1      col2              col3
276328  | 999999999999  |   664116
927356  | 999999999999  |   664140
927356  | 999999999999  |   664140
927356  | 999999999999  |   664159
927379  | 999999999999  |   664172 
```

代码：

```
create table #table (col1 bigint, col2 bigint, col3 bigint)
insert into #table values(276328, 999999999999, 664116)
insert into #table values(927356, 999999999999, 664140)
insert into #table values(927356, 999999999999, 664140)
insert into #table values(927356, 999999999999, 664159)
insert into #table values(927379, 999999999999, 664172) 
```

我需要将 Col2 更新为 Col3 中的值，同时对 col1 进行分组并选择 Min (col1) 以应用于该子组。

276328 和 927379 在它们自己的组中，但 927356 是一个需要将最低 col3 编号分配给 col2 的组

因此，上表已更新应如下所示：

```
col1        | col2      | col3
276328      | 664116    | 664116
927356      | 664140    | 664140
927356      | 664140    | 664140
927356      | 664140    | 664159
927379      | 664172    | 664172 
```

我有 2m+ 行要更新，所以它必须是批量更新而不是循环。

我将如何编写 SQL 来更新表？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:19:08.020

```
declare @myTable table (col1 bigint, col2 bigint, col3 bigint)
insert @myTable
select 276328  , 999999999999  ,   664116
union select 927356  , 999999999999  ,   664140
union select 927356  , 999999999999  ,   664140
union select 927356  , 999999999999  ,   664159
union select 927379  , 999999999999  ,   664172

update a
set a.col2 = b.col3
from @myTable a
inner join 
(
    select col1, MIN(col3) col3
    from @myTable 
    group by col1
) b
on a.col1 = b.col1

select * from @myTable 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T06:33:59.513

如果您的关系型数据库 SQLServer2005+

```
UPDATE x
SET x.col2 = x.col3
FROM (SELECT col2, MIN(col3) OVER (PARTITION BY col1) AS col3
      FROm #table) x 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:14:26.400

```
update t
set col2 = g.mincol3
from tbl t
join (
        select col1, min(col3) mincol3
        from tbl
        group by col1
    ) g on t.col1 = g.col1 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T00:28:00.313

如果您正在使用`MySQL`

```
UPDATE table1 a
        INNER JOIN
        (
            SELECT col1, minCol
            FROM
            (
                SELECT col1, MIN(col3) minCol
                FROM tableName
                GROUP BY col1
            ) c
        ) b ON a.col1 = b.col1
SET a.col2 = b.minCol 
```

# php - 我在哪里可以获得 Laravel 事件的完整列表（由核心库触发）？

> ID：13059744
> 
> 赞同：25
> 
> 时间：2012-10-25T00:09:43.110
> 
> 标签：php, laravel, laravel-3

我想知道 Laravel 核心库触发了哪些事件。我想获得完整的列表，例如`laravel.query`and `laravel.done`。

[官方文档](http://laravel.com/docs/events#laravel-events)中列出了四个事件，但我认为 Laravel 的事件比这四个还多！

* * *

## 回答 #1

> 赞同：45
> 
> 时间：2012-10-25T05:47:16.570

Laravel 实际上并没有像你想象的那样触发那么多的事件。虽然它确实使用了事件系统，但它可供开发人员在应用程序中使用。无论如何，这是我编制的清单。

```
laravel.done
laravel.log
laravel.query
laravel.resolving
laravel.composing: {viewname}
laravel.started: {bundlename}
laravel.controller.factory
laravel.config.loader
laravel.language.loader
laravel.view.loader
laravel.view.engine

view.filter

eloquent.saving
eloquent.updated
eloquent.created
eloquent.saved
eloquent.deleting
eloquent.deleted
eloquent.booted: {$model}
eloquent.booting: {$model}

500
404 
```

`500`和`404`都是与错误相关的事件。这些是在`routes.php`文件中设置的，因此您可以查看默认侦听器是什么。

我想指出，`eloquent.{event}`还有另一个包含正在更新的类名的变体。

```
eloquent.{event}: {classname} 
```

我不会说这绝对是一切，但至少应该是 99%。

* * *

## 回答 #2

> 赞同：19
> 
> 时间：2015-04-20T08:27:29.870

除了杰森刘易斯的回答，我还有一些要补充的。我只是搜索了`fire()`功能并为 Laravel 5 提供了以下列表，

```
$this->events->fire('auth.attempt', $payload);
$this->events->fire('auth.login', [$user, $remember]);
$this->events->fire('auth.logout', [$user]);
$this->events->fire('cache.'.$event, $payload);
$this->laravel['events']->fire('cache:clearing', [$storeName]);
$this->laravel['events']->fire('cache:cleared', [$storeName]);
$events->fire('artisan.start', [$this]);
$this->events->fire('illuminate.query', array($query, $bindings, $time, $this->getName()));
$this->events->fire('connection.'.$this->getName().'.'.$event, $this);
$this['events']->fire('bootstrapping: '.$bootstrapper, [$this]);
$this['events']->fire('bootstrapped: '.$bootstrapper, [$this]);
$this['events']->fire('locale.changed', array($locale));
$this['events']->fire($class = get_class($provider), array($provider));  //after provider registered.
$this->app['events']->fire('kernel.handled', [$request, $response]);
$this->dispatcher->fire('illuminate.log', compact('level', 'message', 'context'));
$this->events->fire('mailer.sending', array($message));
$this->events->fire('illuminate.queue.failed', array($connection, $job, $data));
$this->events->fire('illuminate.queue.stopping');
$this->events->fire('router.matched', [$route, $request]);
$this->events->fire('composing: '.$view->getName(), array($view));
$this->events->fire('creating: '.$view->getName(), array($view)); 
```

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2012-10-25T02:27:52.770

这里还有一些，倾倒时得到的`static::$events`

```
laravel.config.loader
laravel.view.loader
laravel.language.loader
laravel.view.engine
404 
```

不确定是否覆盖这些会起作用，因为它们在内部被调用

* * *

## 回答 #4

> 赞同：3
> 
> 时间：2020-09-07T10:41:37.223

如果您正在调试 Laravel 应用程序，您可以使用以下代码段在控制台中获取正在运行的进程的触发事件的完整列表（例如，当您运行单元测试或工匠命令时）：

```
Event::listen('*', function ($event) {
    echo $event."\n";
}); 
```

如果您使用该`logger`函数，它将进入无限循环。

# html - 在滚动时重绘页面边框

> ID：13059757
> 
> 赞同：1
> 
> 时间：2012-10-25T00:10:45.257
> 
> 标签：html, css, scroll, border, redraw

我的网页内容使用自动边距居中居中，两侧（左右）都有黑色边框。

如果我向下滚动，边框不会更新。因此，如果我向下滚动一点，边框只会向下滚动一半。我该如何解决？

编辑：内容 div 的高度设置为 100%，并且在初始加载时边框确实一直向下，这个问题只发生在滚动时。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:18:17.350

> 内容 div 的高度设置为 100%

这很可能是你的问题。因为您已将 div 设置为`height: 100%`仅与视口一样高。（即使内容溢出它。）

尝试：`min-height: 100%`

# java - 如何在 Android 上的 HttpUrlConnection 中禁用对 401 上的 WWW-Authenticate 标头的检查？

> ID：13059761
> 
> 赞同：4
> 
> 时间：2012-10-25T00:10:59.690
> 
> 标签：java, android, httpurlconnection

我正在使用当我的身份验证 cookie 过期时返回 401 的 Web 服务，这会导致 HttpUrlConnection 抛出此错误：

```
java.io.IOException: No authentication challenges found
    at libcore.net.http.HttpURLConnectionImpl.getAuthorizationCredentials(HttpURLConnectionImpl.java:427)
    at libcore.net.http.HttpURLConnectionImpl.processAuthHeader(HttpURLConnectionImpl.java:407)
    at libcore.net.http.HttpURLConnectionImpl.processResponseHeaders(HttpURLConnectionImpl.java:356)
    at ... 
```

我知道这是因为服务器没有返回 WWW-Authenticate 标头，但这是我无法控制的。很高兴 HttpUrlConnection 为我做这个检查，但这是现实世界，我们并不总是能够使用完全遵循 HTTP 规范的服务器。由于其他代码依赖关系，我无法离开 HttpUrlConnection，那么如何禁用检查以便我可以实际使用响应？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:19:31.907

您可以尝试捕获错误。

```
try{
     //code that causes error
}
catch(IOException ex){
    if(ex.getMessage().equals("No authentication challenges found")){
        //handle error
    }
} 
```

# python - 使用 Django 编写的单个 Web 界面监控多个 Amazon EC2 服务器上的 python 抓取程序

> ID：13059762
> 
> 赞同：0
> 
> 时间：2012-10-25T00:11:15.417
> 
> 标签：python, amazon-ec2, distributed-computing

我有一个用 Python 编写的 web-scraper（命令行脚本），可以在 4-5 个 Amazon-EC2 实例上运行。

我所做的是将这些 python 脚本的副本放在这些 EC2 服务器中并运行它们。

所以下次当我改变程序时，我必须对所有副本都这样做。

因此，您可以看到冗余、管理和监控的问题。

> 因此，为了减少冗余和便于管理，我想将代码放在一个单独的服务器中，从该服务器可以在其他 EC2 服务器上执行它并监控这些 python 程序，并通过位于的 Django/Web 界面创建它们的日志这台服务器。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:11:12.177

您至少要处理两个问题：

*   监控抓取任务的执行
*   将代码部署到多个服务器

他们每个人都需要不同的解决方案。

一般来说，我会推荐使用任务队列来完成这种分配（我已经尝试过并且对在 Amazon EC2 上运行的[Celery感到非常满意）。](http://celeryproject.org/)

任务队列的一个优点是它从实际执行任务的工作人员中抽象出任务的定义。因此，您将任务发送到队列，然后可变数量的工作人员（具有多个工作人员的服务器）通过一次请求一个来处理这些任务。每个空闲的工作人员都会连接到队列并请求一些工作。如果它收到它（一个任务），它将开始处理它。然后它可能会发回结果并要求另一个任务，依此类推。

这意味着许多工作人员可以随时间变化，他们将自动处理队列中的任务，直到没有更多任务要处理。用例是**使用 Amazon 的 Spot 实例，这将大大降低成本**。只需将您的任务发送到队列，创建 X 个现场请求并查看处理您任务的服务器。你真的不需要关心服务器在任何时候上下波动，因为价格高于你的出价。这很好，不是吗？

现在，这隐含地负责监控——因为 celery 有监控队列和处理的工具，它甚至可以使用[django-celery](http://pypi.python.org/pypi/django-celery)与 django 集成。

在将代码部署到多个服务器时，Celery 不支持。这背后的原因具有不同的性质，请参见此[讨论](https://groups.google.com/forum/?fromgroups=#!topic/celery-users/tBJs3btilPk)。其中之一可能是它很难实施。

我认为没有它也可以生活，但如果你真的在乎，我认为有一个相对简单的 DIY 解决方案。将您的代码放在 VCS 下（我推荐[Git](http://git-scm.com/)）并定期检查更新。如果有更新，请运行一个 bash 脚本，该脚本将杀死您的工作人员，进行所有更新并再次启动工作人员，以便他们可以处理更多任务。鉴于 Celerys 处理故障的能力，这应该可以正常工作。

# nhibernate - NHibernate 跳过某些属性来更新，可能吗？

> ID：13059770
> 
> 赞同：0
> 
> 时间：2012-10-25T00:12:01.377
> 
> 标签：nhibernate

我用一堆列定义了我的实体并创建了映射。

```
public class PurchaseRecord {
    public virtual int? Id {
        get;
        set;
    }

    public virtual DateTime? PurchasedDate {
        get;
        set;
    }

    public virtual string Comment {
        get;
        set;
    }

    public virtual IList<PurchaseRecordExtendedProperty> ExtendedPropertyValues {
        get;
        set;
    }

public class PurchaseRecordMap : ClassMap<PurchaseRecord> {
    public PurchaseRecordMap() {
        Table("PurchaseRecords");

        Id(x => x.Id, "RecordID").GeneratedBy.Identity();

        Map(x => x.PurchasedDate, "PurchaseDate").Not.Nullable();
        Map(x => x.Comment, "Comment");

        HasMany(x => x.ExtendedPropertyValues).KeyColumn("ExtendedPropertyID").Cascade.All();
    } 
```

它在大多数情况下都很好用，但是在某些情况下我想跳过更新某些列（例如 child collection `ExtendedPropertyValues`）。当我创建`PurchaseRecord`对象时，我什至懒得加载`ExtendedPropertyValues`. 但是如果属性为空，NHibernate 会尝试从数据库中删除子记录。

我知道有些情况`ExtendedPropertyValues`永远不会改变。出于性能考虑，我不想加载我不需要的数据，如果我不需要更新，有没有办法强制 NH 跳过指定的属性？

感谢您的任何建议。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T10:18:29.430

如果启用延迟加载，NHibernate 将不会尝试加载任何子集合，它们将被初始化为代理，只有在您访问它们时才会加载它们。如果您将子集合设置为 null，这实际上是在告诉 NHibernate 删除该关系中的所有条目（除非您将关系标记为反向）。

NHibernate 不会尝试更新子集合，除非它们发生变化（将其设置为 null 就可以了）。

总之，启用延迟加载，并将 ExtendedPropertyValues 标记为反向，除非您更改 ExtendedPropertyValues，否则它不应更新它，除非您访问它，否则它也不会加载 ExtendedPropertyValues。

# plot - 在绘图空间之间切换

> ID：13059772
> 
> 赞同：0
> 
> 时间：2012-10-25T00:12:33.670
> 
> 标签：plot, core-plot, scatter-plot

**场景：**五个时期的五个图表 {3M, 6M, 1Y, 2Y & 3Y}，每个都有自己的 (1-2) 散点图；共享相同的 y 范围（值）。
每个时期都有不同的 x 范围和标签政策。
例如，可以有一个修复或位置策略；另一个没有。

X-Range 似乎是*不可变*的 /plot-space。
因此，我正在考虑使用其特定的 xRanges 和标签策略创建平行的绘图空间。
我研究了绘图空间与 x.axis(s) & plot(s) 的关系：

图 <=== {NSMutableArray *plotSpaces}
x.axis/plot-space。
情节/情节空间

所以我相信我可以：
1）创建一个情节空间。
2) 将绘图空间分配给特定绘图、x 轴和 xRange。
3）在图表中添加或删除图表。
4) 重新绘制图形。

所以当用户选择一个周期/绘图空间时，我需要做的就是：用周期图替换任何现有的图，这将导致图表绘制图并显示相应的 x 轴（Y 轴是常见的)?

```
[myGraph removePlot:(CPTPlot *)oldPlot];
[myGraph addPlot:(CPTPlot *)plot toPlotSpace:(CPTPlotSpace *)space]; 
```

...我有点迷路了。

?

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-26T01:17:13.153

轴也分配给绘图空间。你也需要换掉轴。通过一直添加和删除图和轴，您会受到相对较大的性能影响。

正如您所观察到的，绘图范围是不可变的。这只是意味着您不能更改现有范围，而不是不能设置新范围。要么创建一个新`CPTPlotRange`对象，要么制作一个现有对象的可变副本。

每当你想改变情节比例时，你需要做以下事情。这些都可以就地更改，而无需删除和替换图表的主要部分。

1.  如上所述更改绘图范围。
2.  更新轴的标注策略和相关属性。
3.  调用`-reloadData`绘图以加载新数据。

# c# - WinRT 的 TcpListener 类在哪里？

> ID：13059776
> 
> 赞同：3
> 
> 时间：2012-10-25T00:13:01.877
> 
> 标签：c#, microsoft-metro, windows-runtime

我正在尝试遵循此页面上给出的示例：

[http://www.codeproject.com/Articles/137979/Simple-HTTP-Server-in-C](http://www.codeproject.com/Articles/137979/Simple-HTTP-Server-in-C)

但我正在为 Metro / WinRT Store 应用程序开发。当我尝试使用它说要使用的许多类时，有很多它们丢失了。我知道这是因为他们决定在迁移时删除很多库......但是有人知道我将如何引用丢失的类吗？缺少 TcpListener 类。或者有谁知道我可以参考的免费库来替换丢失的库？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T00:39:41.813

您不能引用缺少的类。不幸的是，它们并不存在。尽管有很多内置的替代品，但是对于很多功能来说，在这一点上，实际上并没有一个围绕 WinRT 的大型生态系统和缺少功能的第 3 方替代品。

话虽这么说，对于 TCPListener，您可以通过将其替换为[StreamSocketListener](http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=1&cad=rja&ved=0CCEQFjAA&url=http://msdn.microsoft.com/library/windows/apps/BR226906&ei=r4mIUPnxJoO-yQH_2oHwDQ&usg=AFQjCNGXi4caRPrNPKlzql0TXjLcKgtktw&sig2=vgY9ANBGkGwz0E69zrlIOw)来取得很好的成功。 [这是](http://code.msdn.microsoft.com/windowsapps/StreamSocket-Sample-8c573931)使用 StreamSocket 和 StreamSocketListener 的完整示例。

# python - 查询过滤器以获取多维字典中的值？

> ID：13059783
> 
> 赞同：1
> 
> 时间：2012-10-25T00:13:32.237
> 
> 标签：python, django, dictionary, django-queryset, multidimensional-array

我是 Python/Django 的新手，我有一个问题。我需要从多维字典（JSONField）中获取一个按值过滤的 QuerySet。到目前为止，我得到了这个：

```
def make_cond(name, value):
    from django.utils import simplejson
    cond = simplejson.dumps({key:value})[1:-1] # remove '{' and '}'
    return ' ' + cond # avoid '"'

Post.objects.filter(JSONField__contains=make_cond('key', 'value')) 
```

这有效，但仅适用于字典的第一维。我怎样才能到达其他维度？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T01:20:18.953

SQL 帮不了你。

给定一个序列化可能如下所示的任意 json 对象，

```
'{"a": {"c": "C", "b": "B"}, "c": {}, "b": {"e": "E", "d": "D"}}' 
```

你必须构造一个 LIKE 子句来匹配，比如说，`{"a"`，然后是另一个`{`，然后`"b": "B"`不关心 . 的位置是什么`"c": "C"`。LIKE 子句只支持前后通配符，所以你不能得到你想要的。

有可能你可以用全文索引来弄清楚；你可以试试 Haystack 或 Sphinx。

不过，这项工作的正确工具是像 mongodb 这样的 NoSQL 数据库。

# php - 删除考试时我可以包含哪些强条件

> ID：13059785
> 
> 赞同：1
> 
> 时间：2012-10-25T00:13:35.650
> 
> 标签：php, sql

如果管理员和教师愿意，我希望他们能够删除考试。以下是删除考试的步骤：

*   管理员可以删除任何考试
*   教师只会删除他们创建的考试

但是我的主管在下面说明了这一点：

> 删除对于检查数据是一个非常敏感的操作。请非常小心地使用它。可以实现功能，但具有很强的条件约束。不活跃是非常明智的，这样人们就不会做愚蠢的事情。

我的问题是，任何有创建应用程序经验的 Web 开发人员都删除了考试，如果有的话，我应该遵循哪些其他限制条件？我允许教师和管理员通过将数据库中的“活动”列设置为“1”（活动）或“0”（不活动）来取消和激活考试。但如果他们愿意，我也希望他们删除考试。

谢谢

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T00:17:54.393

我看到人们对你的问题不太满意。但我想说我想我理解你的问题。我不会删除任何东西。只需使记录可见或不可见，这样万一有人犯了错误并删除了某些东西，它就不会是永久性的。当然，每当您列出考试时，您只需要列出那些可见的。希望能帮助到你。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:21:27.073

**永远不要**删除任何东西（尤其是在你的情况下）我什至会记录谁尝试删除 - 只需在你的代码中将它们标记为不可见。否则称为“审计跟踪”，稍后您将感谢 StackOverflow！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T00:32:48.027

我同意这里的很多人。除非考试没有内容，否则不应删除考试。但是，您可以在考试表中设置 2 个新列：

1.  `date_deleted`默认 NULL，数据类型 DATETIME
2.  `deleted_by`默认 NULL，数据类型 INT（FK 到删除它的用户 ID）

因此您可以让授权用户将第一个值设置`UTC_TIMESTAMP()`为他/她的用户 ID，将第二个值设置为他/她的用户 ID。并确保您通过 where 子句（如`WHERE ... AND date_deleted IS NULL`or ）从查询中排除所谓的已删除考试`WHERE date_deleted IS NULL`。

上面的第一列将完成主要工作。它不仅会让您知道考试已被删除，而且还会保留被删除的日期/时间。另一方面，第二列将让您知道谁采取了该行动。我相信两者在不同的情况下都会有好处。

# php - 如何为 PHP 日历值设置默认视图

> ID：13059786
> 
> 赞同：2
> 
> 时间：2012-10-25T00:13:40.677
> 
> 标签：php, mysql, date, calendar

我有一个事件日历，根据用户选择的 4 个下拉菜单选项，我从数据库中打印出某些信息，这些是`Week` `Month` `Year`和`Order`，当提供所有选项时，应用程序显示良好。现在我遇到的问题是，我希望将事件日历的默认视图设置为当前时间`week` `Month`，`Year`这样用户就不必选择下拉菜单来查看它。

当我实现下面的代码部分时，事件日历上什么也没有发生

**PHP**

```
function calendar()
{   
if(!isset($_POST['submit'])){

   $m = date('M'); 
   $day = date('j'); 
   $Y = date('Y');

    if ($day >= 29) { 
         $j = 5; 
    }elseif($day >= 22  AND $day < 28) {
         $j = 4;
    }elseif($day >= 15  AND $day < 22) {
         $j = 3;
    }elseif($day >=8   AND $day < 15) {
         $j = 2;
    }else{
         $j = 1; 
    }
}
   if(isset($_POST['submit'])){ 
    if ($_POST['submit'] == ""){
            echo "No  Event for Today" ;
    } 
    $j = mysql_real_escape_string($_POST['week']);
    $m = mysql_real_escape_string($_POST['month']);
    $Y = mysql_real_escape_string($_POST['year']);
    $o = mysql_real_escape_string($_POST['order']);
    $date =" ".$j.", ".$Y." ";

    $query1 = " SELECT *
          FROM newcaldemo 
          WHERE eventweek = '".$j."'
          AND   month = '".$m."'
          AND   year  = '".$Y."'
          ORDER by $o ASC" ; 
            $run1 = mysql_query($query1);
            $norows = mysql_affected_rows();
            if ($norows < 1){
                echo "No Event(s) for Week $j, $Y" ;
            }  else {
                echo "Event(s) for Week $j, $m $Y <br></div> ";

                    while($row1 = mysql_fetch_array($run1)) {  ?>

                           <?php echo $row1['month']." " .$row1['day'] ; ?><br>
                            Name  : <?php echo $row1['eventname'] ; ?><br>
                            Time  : <?php echo $row1['eventtime'] ; ?><br> 
                            Venue : <?php echo $row1['eventplace'] ; ?><br>

          <?php  }
        }
    }
   ?> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-05-07T17:46:38.313

我在大学时为我的论文做了类似的事情 - 获得所需 d/m/y 的部分（以及周围的部分，以防你要使用“下个月”和“上个月”标签）是以下：

```
//set months
if(!empty($_GET['m'])){
    $thisMonth = $_GET['m'];
    $lastMonth = $thisMonth - 1;
    $nextMonth = $thisMonth + 1;
}else{
    $lastMonth = date("n")-1;
    $thisMonth = date("n");
    $nextMonth = date("n")+1;
}

//set years
if(!empty($_GET['y'])){
    $thisYear = $_GET['y'];
}else{
    $thisYear = date("Y");
}

// Set days. mktime format: mktime(hr, min, sec, mth, day, yr)
$today = date("j"); 
$numDays = date ("t", mktime(0, 0, 0, $thisMonth, 1, $thisYear)); // Number of days in current month
$startDay = date ("w", mktime(0, 0, 0, $thisMonth, 1, $thisYear)); // Day the current month starts on 
```

我还可以向您展示我将日历打印为表格的方式，其显示取决于月份的开始日期和其中的天数（未使用的单元格显示为灰色等）。

不用说我没有解释事件检查，因为这对你的问题来说是多余的:)

# sql - T-SQL 子/父查询

> ID：13059789
> 
> 赞同：0
> 
> 时间：2012-10-25T00:14:11.253
> 
> 标签：sql, tsql

我有 4 个表，组、成员资格、人员和属性。

团体

```
GroupID
GroupName
ParentGroupID 
```

会员资格

```
PersonID
GroupID 
```

人

```
PersonID
Name 
```

属性

```
AttributeID
GroupID
Value 
```

属性分配给组，组通过成员资格表分配人员。

**我想显示与特定人相关的所有属性。**

对于没有父母的小组中的某人，我没有遇到任何麻烦，但有些小组的嵌套深度为 2 或 3 层。到目前为止，我使用 CTE 方法的尝试没有产生任何结果。

示例结果

```
Person.Name Membership.GroupID  Group.GroupID  Group.ParentGroupID  Attribute.Value
Fred        3                   1              NULL                 'Attribute for Top level group'
Fred        3                   2              1                    'Attribute for a sub group'
Fred        3                   3              2                    'Attribute for third sub group'
Fred        5                   4              1                    'Attribute for Top level group - this is a duplicate?'
Fred        5                   5              4                    'Attribute for second sub group' 
```

希望这足够清楚。Fred 是第 3 组的成员，该组的父组为 2，而父组为 3，然后显示与每个组匹配的每个属性（Group.ID 与 Attribute.GroupID 的内部连接将实现此目的)

**编辑 - 只是添加一个注释，每个人都可以是多个组的成员。**

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:31:33.560

## DDL + DML

```
create table groups (groupid int, groupname varchar(10), parentgroupid int)
insert groups select 1, 'A', null;
insert groups select 2, 'B', null;
insert groups select 3, 'C', 1;
insert groups select 4, 'D', null;
insert groups select 5, 'E', null;
create table membership (personid int, groupid int);
insert membership select 1, 3;
insert membership select 1, 4;
create table person (personid int, name varchar(100));
insert person select 1, 'Jim';
create table Attribute(AttributeID int, GroupID int, Value varchar(100));
insert Attribute select 1, 1, 'At1-1';
insert Attribute select 2, 1, 'At1-2';
insert Attribute select 3, 2, 'At2-1';
insert Attribute select 4, 3, 'At3-1';
insert Attribute select 5, 4, 'At4-1'; 
```

## 查询

```
;with tmp as (
    select groupid membership_groupid, groupid
    from membership
    where personid = 1
    union all
    select membership_groupid, g.parentgroupid
    from groups g
    join tmp on tmp.groupid = g.groupid
)
select p.name, membership_groupid, g.groupid, g.parentgroupid, a.value
from person p
join tmp t on 1=1
join groups g on g.groupid = t.groupid
join attribute a on a.groupid = t.groupid
where p.personid = 1 
```

如果一个人可能同时是 GROUP A 和 GROUP A 的父级的成员，则您需要打破平局以仅显示一次属性。

```
;with tmp as (
    select groupid membership_groupid, groupid
    from membership
    where personid = 1
    union all
    select membership_groupid, g.parentgroupid
    from groups g
    join tmp on tmp.groupid = g.groupid
)
select p.name, membership_groupid, g.groupid, g.parentgroupid, a.value
from person p
join (select *, rn=row_number() over (partition by groupid
                                      order by case when membership_groupid=groupid then 1
                                                    else 2 end,
                                               membership_groupid)
      from tmp) t on t.rn=1
join groups g on g.groupid = t.groupid
join attribute a on a.groupid = t.groupid
where p.personid = 1 
```

# ruby-on-rails - 如何仅显示上传文件的链接，而不显示其位置

> ID：13059796
> 
> 赞同：0
> 
> 时间：2012-10-25T00:14:53.857
> 
> 标签：ruby-on-rails, paperclip

我使用回形针将文件上传到 Rails 应用程序。一切正常，文件已上传，但我没有看到指向实际文件本身的链接，而是看到它在 rails 项目的系统文件夹中的位置。

我猜它要么是路由问题，要么我需要创建一个指向相关文件的链接。但是，我想隐藏文件本身的位置，只看到显示的链接。

如果有人能在这里指出正确的方向，我将不胜感激。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T01:26:13.653

您想隐藏服务器中文件的实际路径，对吗？

您可以在普通控制器中使用 send_file ( [http://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_file ) 来实现。](http://api.rubyonrails.org/classes/ActionController/DataStreaming.html#method-i-send_file)

您仍然需要做一些事情来保护使用真实路径的下载。

# animation - 在树形面板上停止 expandAll 动画

> ID：13059800
> 
> 赞同：1
> 
> 时间：2012-10-25T00:15:29.427
> 
> 标签：animation, extjs, tree, extjs4, extjs4.1

IE8 有一个可怕的时间折叠具有多列的中型树面板。它太慢了。

我正在寻找加速从 expandAll 到 collapseAll 状态的转换的方法。在我看来，一种这样的方法是取消 IE8 的动画。似乎在以前的版本中，可能在展开/折叠方法上指定了一些选项来启用或禁用动画。但是我不再看到这些选项了。

有人在 4.1x 上做过吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-27T00:28:54.863

TreePanel 具有可设置为禁用动画的 animate 属性：

> 动画：！Ext.isIE

试过这个，它有效。然而效果与我的预期相反:(没有动画 IE 只是坐在那里反复思考，直到它计算每个节点，然后一次重新绘制整个树。这使它看起来需要更长的时间更短，因为有了动画，你至少可以看到 IE 挣扎......

# c# - MVP Autofac 和控制器

> ID：13059801
> 
> 赞同：0
> 
> 时间：2012-10-25T00:15:29.497
> 
> 标签：c#, mvp, autofac

我有一个这样的页面 -

```
public partial class ProductDetailMixed : SessionPage, IProductDetailMixedView
{
        public IProductService ProductService { get; set; }

        protected void Page_Load(object sender, EventArgs e)
        {
            Controller = new ProductDetailMixedController(this, ProductService);

            OnLoadPage();
        }

        public event LoadPageEvent OnLoadPage;

        public IProductDetailMixedController Controller { get; set; }
} 
```

我有属性注入，所以 IProductService 的实例将被注入到页面中，但是我真正想要的是像这样创建控制器 -

```
Controller = new ProductDetailMixedController(this); 
```

然后 ProductDetailMixedController 的构造函数只会注入所有剩余的参数..但是我该怎么做呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T06:14:09.433

[我相信这就是你想要完成的](https://stackoverflow.com/a/1836456/1742028)？在引用的示例中，您的演示者/控制器工厂还需要您的服务接口的参数。一旦你有了类似的东西，你可以从你的视图中删除你的服务的属性注入（当然，除非你在你的视图中使用它）。

# haskell - 在 Haskell 中读取 YAML

> ID：13059806
> 
> 赞同：18
> 
> 时间：2012-10-25T00:15:43.687
> 
> 标签：haskell, yaml

我希望让我的 Haskell 程序从外部文件读取设置，以避免重新编译以进行微小的更改。熟悉 YAML，我认为这将是一个不错的选择。现在我必须把这两部分放在一起。到目前为止，谷歌并不是很有帮助。

非常感谢处理从文件中读取和解构 YAML 的小示例代码。

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2012-10-25T01:36:42.737

如果我对可用的软件包感兴趣，我会去 hackage，查看完整的软件包列表，然后在页面中搜索关键字。这样做会带来这些选择（以及其他一些不太引人注目的选择）：

*   yaml：[http ://hackage.haskell.org/package/yaml](http://hackage.haskell.org/package/yaml)
*   HsSyck：[http ://hackage.haskell.org/package/HsSyck](http://hackage.haskell.org/package/HsSyck)

和一个名为 yaml-light 的 HsSyck 包装器：http: [//hackage.haskell.org/package/yaml-light](http://hackage.haskell.org/package/yaml-light)

yaml 和 HsSyck 看起来都是最近更新的，并且似乎被其他广泛使用的软件包使用。您可以通过检查反向部门来看到这一点：

*   [http://packdeps.haskellers.com/reverse/HsSyck](http://packdeps.haskellers.com/reverse/HsSyck)
*   [http://packdeps.haskellers.com/reverse/yaml](http://packdeps.haskellers.com/reverse/yaml)

两者中，yaml 有更多的 deps，但那是因为它是 yesod 生态系统的一部分。一个依赖于 HsSyck 的库是 yst，我碰巧知道它是积极维护的，所以这向我表明 HsSyck 也很好。

做出选择的下一步是浏览这两个库的文档，看看哪个对我的目的更有吸引力。

在这两者中，看起来 HsSyck 暴露了更多的结构，但其他的不多，而 yaml 则通过 aeson 提供的 json 编码。这向我表明，前者可能更强大，而后者更方便。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2015-10-31T08:34:11.157

一个简单的例子：

首先你需要一个`test.yml`文件：

```
db: /db.sql
limit: 100 
```

在 Haskell 中读取 YAML

```
{-# LANGUAGE DeriveGeneric #-}

import GHC.Generics
import Data.Yaml

data Config = Config { db :: String
                     , limit :: Int
                     } deriving (Show, Generic)

instance FromJSON Config

main :: IO ()
main = do
  file <- decodeFile "test.yml" :: IO (Maybe Config)
  putStrLn (maybe "Error" show file) 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2020-07-06T04:41:59.387

您可以以[静态分析友好的方式](https://gergo.erdi.hu/talks/2019-03-sit-applicative-cooking/Applicative_Cooking.pdf)[`yamlparse-applicative`](https://hackage.haskell.org/package/yamlparse-applicative)描述您的 YAML 解析器，因此您可以免费从解析器获取 YAML 格式的描述。我将为此使用 [Matthias Braun 的示例格式](https://stackoverflow.com/a/62741423/477476)：

```
{-# LANGUAGE ApplicativeDo, RecordWildCards, OverloadedStrings #-}

import Data.Yaml
import Data.Aeson.Types (parse)
import YamlParse.Applicative
import Data.Map (Map)
import qualified Data.Text.IO as T

data MyType = MyType
    { stringsToStrings :: Map String String
    , mapOfLists :: Map String [String]
    } deriving Show

parseMyType :: YamlParser MyType
parseMyType = unnamedObjectParser $ do
    stringsToStrings <- requiredField' "strings_to_strings"
    mapOfLists <- requiredField' "map_of_lists"
    pure MyType{..}

main :: IO ()
main = do
    T.putStrLn $ prettyParserDoc parseMyType

    yaml <- decodeFileThrow "config/example.yaml"
    print $ parse (implementParser parseMyType) yaml 
```

请注意，`main`甚至可以在看到实例之前打印出架构：

```
strings_to_strings: # required
  <key>: <string>
map_of_lists: # required
  <key>: - <string>
Success 
  (MyType 
    { stringsToStrings = fromList
        [ ("key_one","val_one")
        , ("key_two","val_two")
        ]
    , mapOfLists = fromList 
        [ ("key_one",["val_one","val_two","val_three"])
        , ("key_two",["val_four","val_five"])
        ]
    }) 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2020-07-05T13:37:26.133

以下是使用该[`yaml`](https://hackage.haskell.org/package/yaml)库从 YAML 文件中解析特定对象的方法。

让我们解析这个文件的部分内容`config/example.yaml`：

```
# A map from strings to strings
strings_to_strings:
      key_one: val_one
      key_two: val_two

# A map from strings to list of strings
map_of_lists:
  key_one:
      - val_one
      - val_two
      - val_three
  key_two:
      - val_four
      - val_five

# We won't parse this
not_for: us 
```

该模块单独解析`strings_to_strings`并将`map_of_lists`它们放入自定义记录中`MyType`：

```
{-# Language OverloadedStrings, LambdaCase #-}
module YamlTests where
import           Data.Yaml                      ( decodeFileEither
                                                , (.:)
                                                , parseEither
                                                , prettyPrintParseException
                                                )
import           Data.Map                       ( Map )
import           Control.Applicative            ( (<$>) )
import           System.FilePath                ( FilePath
                                                , (</>)
                                                )

data MyType = MyType {stringsToStrings :: Map String String,
                      mapOfLists :: Map String [String]} deriving Show
type ErrorMsg = String

readMyType :: FilePath -> IO (Either ErrorMsg MyType)
readMyType file =
  (\case
      (Right yamlObj) -> do
        stringsToStrings <- parseEither (.: "strings_to_strings") yamlObj
        mapOfLists       <- parseEither (.: "map_of_lists") yamlObj
        return $ MyType stringsToStrings mapOfLists
      (Left exception) -> Left $ prettyPrintParseException exception
    )
    <$> decodeFileEither file

yamlTest = do
  parsedValue <- readMyType $ "config" </> "example.yaml"
  print parsedValue 
```

运行`yamlTest`查看解析结果。

# deployment - Heroku 推送挂在“从 ruby gems 获取 gem 元数据”上，没有任何错误或任何类型的痕迹

> ID：13059808
> 
> 赞同：2
> 
> 时间：2012-10-25T00:16:04.510
> 
> 标签：deployment, heroku, rubygems

每次部署时，我的部署都停留在从 ruby​​gems 获取 gem 元数据上。
早上好用，下午有问题，现在又不行了。
我们在其他地方和其他计算机上进行了尝试，结果相同。

它在本地工作正常我可以毫无问题地从 ruby​​gems 更新。

视觉的：

```
Delta compression using up to 4 threads.
Compressing objects: 100% (9/9), done.
Writing objects: 100% (9/9), 764 bytes, done.
Total 9 (delta 7), reused 0 (delta 0)
-----> Heroku receiving push
-----> Ruby/Rails app detected
-----> Using Ruby version: ruby-1.9.3
-----> Installing dependencies using Bundler version 1.2.1
Running: bundle install --without development:test --path vendor/bundle --binstubs bin/
Updating https://github.com/epetre/negative-captcha.git
Fetching gem metadata from http://rubygems.org/.......
Fetching gem metadata from http://rubygems.org/..

[IT HANGS HERE FOREVER] 
```

有人有线索吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T02:54:01.877

通过将捆绑程序添加到 gem 文件并强制版本来修复

```
gem 'bundler', '1.2.1' 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-02T16:54:54.420

好的，我认为已经修复好了。事实证明，它仅在明确指定 heroku 和 bundler 的最新版本时才有效。奇怪的是，它可以在本地没有显式版本的情况下捆绑，但在部署到 heroku 时不能。

```
gem 'heroku', '2.33.0'
gem 'bundler', '1.2.1' 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-10-03T12:01:50.290

对我来说，更改协议以获取 gem 解决了这个问题。

我更改`https://github.com/epetre/negative-captcha.git`为`git://github.com/epetre/negative-captcha.git`在 gem 文件中。捆绑它并推送到heroku，它就可以工作了。

# django - Django Collectstatic 命令改变了一些东西

> ID：13059810
> 
> 赞同：0
> 
> 时间：2012-10-25T00:16:08.360
> 
> 标签：django, django-settings, django-staticfiles, django-static

所以我从来没有部署过 Django 应用程序，我正在努力加快速度。我运行了 collectstatic 命令，现在我的静态文件都不会呈现。当我运行 findstatic 命令时，我收到一个异常，上面写着：

```
django.core.exceptions.ImproperlyConfigured: The storage backend of the staticfiles finder     <class 'django.contrib.staticfiles.finders.DefaultStorageFinder'> doesn't have a valid location. 
```

我的模板呈现只是 find 但我似乎无法弄清楚为什么找不到 css 文件。从我的设置模块中突出显示：

```
settings/
    base.py
    devel.py
    prod.py 
```

基础.py

```
cwd = os.path.dirname(os.path.abspath(__file__)) 
PROJECT_ROOT = cwd[:-9] # chop off "settings/"

STATICFILES_FINDERS = [
'django.contrib.staticfiles.finders.FileSystemFinder',
'django.contrib.staticfiles.finders.AppDirectoriesFinder',
'django.contrib.staticfiles.finders.DefaultStorageFinder',
]

TEMPLATE_LOADERS = [
'django.template.loaders.filesystem.Loader',
'django.template.loaders.app_directories.Loader',
'django.template.loaders.eggs.Loader',
]

TEMPLATE_DIRS = [
os.path.join(PROJECT_ROOT, "templates"),
] 
```

开发者.py

```
STATIC_URL = "/site_media/static/"

STATICFILES_DIRS = [
    os.path.join(PROJECT_ROOT, "site_media", "static"),
]

STATIC_ROOT = os.path.join(PROJECT_ROOT, "site_media", "static") 
```

site_base.html

```
<link rel="stylesheet" href="{{ STATIC_URL }}css/site_base.css" /> 
```

感谢您的帮助，因为我很难过。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T00:06:31.353

**更新：**

原来是缺少上下文处理器。要在模板中获取 STATIC_URL 设置，您必须注册`staticfiles`上下文处理器：

```
TEMPLATE_CONTEXT_PROCESSORS = [
    ...
    'django.core.context_processors.static',
    ...
] 
```

**第一刺：**

看起来您需要将该目录添加到静态源列表中（回复：上面的评论）：

```
# list of input paths for collectstatic
STATICFILES_DIRS = [
    os.path.join(PROJECT_ROOT, "tulsa", "static"),

    # you'll want to remove this path:
    #os.path.join(PROJECT_ROOT, "site_media", "static"),
]

# output path for collectstatic
STATIC_ROOT = os.path.join(PROJECT_ROOT, "site_media", "static") 
```

# wpf - WPF中字母的字符串格式是什么？

> ID：13059812
> 
> 赞同：0
> 
> 时间：2012-10-25T00:16:22.477
> 
> 标签：wpf, user-controls, wpf-controls, string-formatting, wpftoolkit

我想用`String.Forat`字母写一个，你能告诉我怎么写吗？我知道货币的模式，但不知道字母表。我可以写`StringFormat = "{}{A-Z,a-z}"`字母吗？

```
 StringFormat="{}{0:C}" 
```

我正在做验证。我只想在文本框中输入字母需要首字母大写其余小写字母。当我输入任何数值时，它会显示错误，但使用任何 WPF 验证，但我不知道该怎么做对字母使用 StringFormat

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-26T20:59:26.510

```
public class MyTextBox: TextBox
{
  public MyTextBox()
{
    this.PreviewTextInput += new TextCompositionEventHandler(TextBox_PreviewTextInput);
    this.AddHandler(DataObject.PastingEvent, new DataObjectPastingEventHandler(OnPaste));
}

private void OnPaste(object sender, DataObjectPastingEventArgs e)
{            
    if (e.DataObject.GetDataPresent(typeof(String)))
    {
        String text = (String)e.DataObject.GetData(typeof(String));
        if (!IsTextAllowed(text))
        {
            e.CancelCommand();
        }
    }
    else
    {
        e.CancelCommand();
    }
}

void TextBox_PreviewTextInput(object sender, TextCompositionEventArgs e)
{
    e.Handled = !IsTextAllowed(e.Text);
}

private static bool IsTextAllowed(string text)
{
    Regex regex = new Regex("^[a-zA-Z]+$"); //regex that matches disallowed text
    return regex.IsMatch(text);
}
} 
```

使用上面的 customTextBox

# php - 类似触发器的系统来更新用户统计信息

> ID：13059818
> 
> 赞同：-2
> 
> 时间：2012-10-25T00:18:04.217
> 
> 标签：php, triggers, phpmyadmin, mysql

我想在插入或删除处理时更新用户统计信息。

我有一个表名作为 userstat，该表包含 user_id、playcount、 addedgame 等信息。

当用户在网站上玩游戏时，我向 updateuserstat 函数发送了一个 post 请求，该函数计算新的游戏次数并更新 userstats。

但是，我认为这个系统并不完全完美，因为我在 userstats 上看到了错误的信息。或多或少来自原始数据。

有没有什么方法可以同步游戏功能和更新用户统计功能并具有很强的参与度？

比如触发器之类的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T02:05:36.663

MySQL 具有可以在表上定义的触发器以在插入/更新/删除时执行：http: [//dev.mysql.com/doc/refman/5.5/en/triggers.html](http://dev.mysql.com/doc/refman/5.5/en/triggers.html)

# jquery - 当用户滚动时将菜单从水平移动到垂直？

> ID：13059821
> 
> 赞同：0
> 
> 时间：2012-10-25T00:18:29.463
> 
> 标签：jquery, html, css, menubar

我目前正在使用 Twitter Bootstrap、bhtml5 样板、css3 和最新的 jQuery 运行 Wordpress。

我的主导航菜单目前固定在页面顶部的水平位置。

当用户向下滚动页面时，如何使菜单移动到垂直位置（最好具有良好的过渡效果）？

如果有人可以向我指出 jQuery/Mootools/etc 文档的方向，这将帮助我做到这一点，那将是一个很大的帮助。

```
$(window).scroll(function(e) {
if ($(window).scrollTop() > 0) {
    $("#nav").addClass("horizontal");
} else {
    $("#nav").removeClass("horizontal");
}
//console.log($(window).height());
}); 
```

基本上与此相反并添加了过渡效果：[http://jsfiddle.net/bbYZS/2/]

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-03-30T22:32:59.287

好的，在使用 jQuery 一段时间后，我自己设法做到了：我正在使用 jQuery UI switchClass() [docs](http://jqueryui.com/switchClass/)和 jquery animate [docs](http://api.jquery.com/animate/) 这是一个[小提琴](http://jsfiddle.net/qJj4z/1/) ，这里是确切的 javascript：

```
$(document).ready(function () {
// This seems smoother but "animate" is buggy when applied to scrollTop so uncomment this if you want to see the smoother button function work
//    var toggleStatetwo = true;
//        $('.clickthis').on('click', function() {
//        if(toggleStatetwo) {
//        $(".nav").animate({"width": "81px"},"slow");
//        } else {
//        $(".nav").animate({"width": "801px"},"slow");
//        }
//        toggleStatetwo = !toggleStatetwo;
//       });
var toggleStatetwo = true;
$('.clickthis').on('click', function () {
    if (toggleStatetwo) {
        $(".nav").switchClass("nav", "nav_vert", 800);
    } else {
        $(".nav_vert").switchClass("nav_vert", "nav", 800);
    }
    toggleStatetwo = !toggleStatetwo;
});
$(document).scroll(function (e) {
    if ($(window).scrollTop() > 20) {
        $(".nav").switchClass("nav", "nav_vert", 800);
    } else {
        $(".nav_vert").switchClass("nav_vert", "nav", 800);
    }
    //console.log($(window).height());
}); 
```

});

享受需要它的人并投票赞成：D

# javascript - 无法在 IE 或 Chrome 中获取选择框的值？

> ID：13059824
> 
> 赞同：2
> 
> 时间：2012-10-25T00:18:48.280
> 
> 标签：javascript, internet-explorer, google-chrome

我一直在 FF 中构建我的网站，只是意识到它在 IE 或 Chrome（即 Javascript）中不起作用。使用 IE 的 JS 调试器我发现它正在吐出以下错误：

```
SCRIPT5007: Unable to get value of the property 'value': object is null or undefined ... 
```

对于以下代码：

```
var myvar = document.getElementById("selectboxid").value; 
```

它在 FF 中运行良好，但在 IE 或 Chrome 中运行良好。

选择框的 HTML 如下所示：

```
<select name="selectboxid" id="selectboxid" size="1" autocomplete="off" tabindex="5" >
<option value="1">One</option>
<option value="2">Two</option>
... 
```

难道我做错了什么？如果是这样，为什么它在 FF 中可以正常工作？

谢谢你的帮助。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2012-10-25T00:25:51.343

你可以使用这个：

```
var myvar = document.getElementById("selectboxid");
var selectedValue = myvar.options[myvar.selectedIndex].value; //This will get the selected value of the select box 
```

实现这一点的示例：

```
<html>
<head>
    <title>sample</title>
</head>
<body>
    <select name="selectboxid" id="selectboxid" onchange="alertValue()" size="1" autocomplete="off" tabindex="5">
        <option value="1">One</option>
        <option value="2">Two</option>
        <option value="3">Three</option>
        <option value="4">Four</option>
    </select>
    <script type="text/javascript">
    function alertValue() //this function will only be called when the value of select changed.
    {
        var myvar = document.getElementById("selectboxid");
        var selectedValue = myvar.options[myvar.selectedIndex].value; //This will get the selected value of the select box
        alert(selectedValue);
    }
    </script>
</body>
</html>​ 
```

# php - 使用 PDO 更新 MySQL，准备语句并用 bindParam 替换标记；得到“变量与标记不匹配”错误

> ID：13059826
> 
> 赞同：0
> 
> 时间：2012-10-25T00:19:03.093
> 
> 标签：php, mysql, sql, arrays, pdo

我正在尝试更新我的 MySQL 数据库中的记录。

我使用数组/循环构建准备好的语句：

```
$sql =  "UPDATE table01 SET ";  
        foreach($values as $value)
        {
        $sql .="$value = :$value, ";
        }
        $sql = rtrim($sql,', ');    
        $sql .=" WHERE id = '$id'"; 
```

然后我准备这个声明：

```
try 
{
$pdo = new PDO('mysql:host=localhost; dbname=db01', $username, $password);
$pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);

$stmt = $pdo->prepare($sql); 
```

然后我将准备好的语句中的每个标记/占位符绑定到要使用另一个循环插入的值：

```
foreach(array_combine($values, $variables) as $value=>$variable)
{
$stmt->bindParam(':$value', $variable);
}

$stmt->execute(); 
```

其中 $values 是数据库中的列标题数组（因此 ':$value' 是一组与其对应的标记名称），$variables 是包含要存储的数据的变量数组。

当我运行它时，我得到了错误：

```
Error: SQLSTATE[HY093]: Invalid parameter number: number of bound variables does not match number of tokens 
```

但正如你所看到的，我是从数组中形成它们的——我已经对数组进行了计数，以确保元素匹配 1:1，并且它们确实如此：

供参考：

```
$count1 = count($values);
$count2 = count($variables);

echo $count1;
echo $count2; 
```

给出：7575

（它们都有 75 个元素）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:20:24.573

单引号不插入变量。

```
$stmt->bindParam(':$value', $variable); 
```

应该

```
$stmt->bindParam(":$value", $variable); 
```

# javascript - 使用 Confluence 作为开发环境沙箱

> ID：13059827
> 
> 赞同：0
> 
> 时间：2012-10-25T00:19:04.487
> 
> 标签：javascript, css, confluence

是否可以使用 Confluence 提供一个协作场所来使用沙箱开发前端代码 (CSS/JS)，例如实时示例？

例如，如果 Developer X 创建了一个有用的 jQuery 插件，他们理论上可以创建一个显示工作示例的页面、用于创建示例的源、任何文档等。我认为这是创建工作展示的好方法然后可以自动打包到我们公司的“框架”中。

# ios - 如何将方法与由枚举组成的可变参数绑定

> ID：13059832
> 
> 赞同：1
> 
> 时间：2012-10-25T00:19:59.723
> 
> 标签：ios, xamarin.ios

我正在为 Applifier Obj-C API 创建一个最小的 MonoTouch 绑定。它包含这个 init 方法：

```
+ (Applifier *)initWithApplifierID:(NSString *)applifierID withWindow:(UIWindow *)window 
supportedOrientations:(UIDeviceOrientation)orientationsToSupport, ...NS_REQUIRES_NIL_TERMINATION; 
```

按照可变参数方法的绑定文档中的说明，我想出了这个接口方法：

```
[Static]
[Export ("initWithApplifierId:withWindow:supportedOrientations:"), Internal]
void InitWithApplifierId (string applifierID, UIWindow withWindow,
    UIDeviceOrientation supportedOrientations, IntPtr orientationsPtr); 
```

以及我的扩展中的这个公共方法

```
public static Applifier InitWithApplifierId(string applifierId, UIWindow window,
    params UIDeviceOrientation[] supportedOrientations)
{
    if (supportedOrientations == null)
        throw new ArgumentNullException ("supportedOrientations");

    var pNativeArr = Marshal.AllocHGlobal(supportedOrientations.Length * IntPtr.Size);
    for (int i = 1; i < supportedOrientations.Length; ++i) {
        Marshal.WriteIntPtr (pNativeArr, (i - 1) * IntPtr.Size,
            supportedOrientations[i].Handle);
    }

    // Null termination
    Marshal.WriteIntPtr (pNativeArr, (supportedOrientations.Length - 1) * IntPtr.Size,
        IntPtr.Zero);

    Applifier.InitWithApplifierId(applifierId, window, supportedOrientations[0],
        pNativeArr);
    Marshal.FreeHGlobal(pNativeArr);
} 
```

但是，UIDeviceOrientation 是一个枚举而不是一个对象，所以没有 Handle 可以写。我对 Objective-c 非常陌生，对 C# 也很陌生（我的项目实际上是通过 IKVM 与 MonoTouch 交互的；我的专长是 Java）。我尝试对supportedOrientation[i] 本身进行天真的Marshal.WriteInt32，但这在编译时也失败了。

如果它更容易，我可以绑定此方法的重载：

```
+ (Applifier *)initWithApplifierID:(NSString *)applifierID withWindow:(UIWindow *)window 
supportedOrientationsArray:(NSMutableArray *)orientationsArray; 
```

但是，我也不确定如何绑定 NSMutableArray :)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T03:15:01.323

一种解决方案是绑定您突出显示的第二种方法

```
[Static]
[Export ("initWithApplifierID:withWindow:supportedOrientationsArray:")]
Applifier InitWithApplifierID (string applifierID, UIWindow withWindow, NSMutableArray orientationsArray); 
```

现在你可以像这样使用那个ctor

```
NSNumber faceDown = NSNumber.FromInt32( (int) UIDeviceOrientation.FaceDown);
NSNumber faceUp = NSNumber.FromInt32( (int) UIDeviceOrientation.FaceUp);
NSNumber landscapeLeft = NSNumber.FromInt32( (int) UIDeviceOrientation.LandscapeLeft);
NSNumber landscapeRight = NSNumber.FromInt32( (int) UIDeviceOrientation.LandscapeRight);
NSNumber portrait = NSNumber.FromInt32( (int) UIDeviceOrientation.Portrait);
NSNumber portraitUpsideDown = NSNumber.FromInt32( (int) UIDeviceOrientation.PortraitUpsideDown);
NSNumber unknown = NSNumber.FromInt32( (int) UIDeviceOrientation.Unknown);

NSMutableArray orientationsArray = new NSMutableArray(7); // Set here the number of orientations wanted

orientationsArray.AddObjects( new NSObject[7] { faceDown, faceUp, landscapeLeft, landscapeRight, portrait, portraitUpsideDown, unknown } ); // add here the orientations wanted

var applifier = Applifier.InitWithApplifierID(applifierID, withWindow, orientationsArray); 
```

有点难看，但应该可以，希望这会有所帮助

亚历克斯

# jquery - 在地图外侧的元素鼠标悬停时更改谷歌地图 v3 标记的颜色

> ID：13059833
> 
> 赞同：8
> 
> 时间：2012-10-25T00:20:01.453
> 
> 标签：jquery, google-maps-api-3

我正在尝试这样做，以便当将 html 元素鼠标悬停在 google maps api v3 中标记的颜色代码上时会发生变化。

这是谷歌地图代码：

```
$(document).ready(function(){
var markers;
var map;
var infowindow = new google.maps.InfoWindow();
var bounds = new google.maps.LatLngBounds();
markers = new Array();

var mapOptions = {
    zoom: 0, //Set to 0 because we are using auto formatting w/ bounds
    disableDefaultUI: true,
    zoomControl: true,
    mapTypeId: google.maps.MapTypeId.ROADMAP,
    };

map = new google.maps.Map(document.getElementById("map"), mapOptions);
map.fitBounds(bounds);

$("#map_list ul li").each(function(index) {
    var markerLatLng = new google.maps.LatLng($(this).children(".marker_lat").text(), $(this).children(".marker_long").text());
    var marker = new google.maps.Marker({
    position: markerLatLng,
    map: map,
    animation: google.maps.Animation.DROP,
    title : $(this).children(".marker_title").text(),
    brief: $(this).children(".marker_brief").text(),
    icon: 'http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld='+$(this).children(".marker_number").text()+'|00aeef|000000'
    });

    markers.push(marker);
    //add to bounds for auto center and zoom
    bounds.extend(markerLatLng);    
});

}); 
```

它在网页中从我的 html 动态构建标记，如下所示：

```
<div id="map_list">
<ul>             
     <li id="0">
        <div class="marker_number">1</div>
        <div class="marker_title">The Wedding Center</div>
        <div class="marker_lat">45.361885</div>
        <div class="marker_long">-122.599007</div>
      </li>
      <li id="1">
        <div class="marker_number">2</div>
        <div class="marker_title">The Reception Place</div>
        <div class="marker_lat">45.417870</div>
        <div class="marker_long">-122.658531</div>
      </li>
</ul>
 </div> 
```

我怎样才能做到这一点，当我将鼠标悬停在#map_list ul li 上时，它会将颜色代码 00aeef 更改为 ff0000？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T00:47:17.713

[翻译自 Mike Williams 的 v2 教程的示例](http://www.geocodezip.com/v3_MW_example_hoverchange.html)（只需更改侧边栏中 HTML 元素鼠标悬停时的标记图标）。

在 mouseover/mouseout 上更改标记的代码：

```
// A function to create the marker and set up the event window function 
function createMarker(latlng,name,html,color) {
  var contentString = html;
  var marker = new google.maps.Marker({
    position: latlng,
    icon: gicons[color],
    map: map,
    title: name,
    zIndex: Math.round(latlng.lat()*-100000)<<5
  });

  google.maps.event.addListener(marker, 'click', function() {
    infowindow.setContent(contentString); 
    infowindow.open(map,marker);
  });
  // Switch icon on marker mouseover and mouseout
  google.maps.event.addListener(marker, "mouseover", function() {
    marker.setIcon(gicons["yellow"]);
  });
  google.maps.event.addListener(marker, "mouseout", function() {
    marker.setIcon(gicons["blue"]);
  });
  gmarkers.push(marker);
  // add a line to the side_bar html
  var marker_num = gmarkers.length-1;
  side_bar_html += '<a href="javascript:myclick(' + marker_num + ')" onmouseover="gmarkers['+marker_num+'].setIcon(gicons.yellow)" onmouseout="gmarkers['+marker_num+'].setIcon(gicons.blue)">' + name + '<\/a><br>';
} 
```

[使用 KML/geoxml3 的示例](http://www.geocodezip.com/geoxml3_test/v3_geoxml3_kmltest_stylemap_marker.html?filename=http://www.geocodezip.com/geoxml3_test/rollover_kml.xml)

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2012-10-25T01:41:27.820

你可以试试这个：

```
$(document).ready(function(){
    var map, infowindow = new google.maps.InfoWindow(),
    bounds = new google.maps.LatLngBounds(), markers=[], 
    alternateMarkers=[], markersIcon=[];
    var mapOptions = {
        zoom: 0, //Set to 0 because we are using auto formatting w/ bounds
        disableDefaultUI: true,
        zoomControl: true,
        mapTypeId: google.maps.MapTypeId.ROADMAP,
    };

    map = new google.maps.Map(document.getElementById("map"), mapOptions);
    map.fitBounds(bounds);

    $("#map_list ul li").each(function(index) {
        var mTxt=$(this).children(".marker_number").text();
        var markerLatLng = new google.maps.LatLng($(this).children(".marker_lat").text(), $(this).children(".marker_long").text());
        var markImg=new google.maps.MarkerImage('http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld='+mTxt+'|00aeef|000000');
        var altMarkImg=new google.maps.MarkerImage('http://chart.apis.google.com/chart?chst=d_map_pin_letter&chld='+mTxt+'|ff0000');
        var marker = new google.maps.Marker({
            position: markerLatLng,
            map: map,
            animation: google.maps.Animation.DROP,
            title : $(this).children(".marker_title").text(),
            brief: $(this).children(".marker_brief").text(),
            icon: markImg
    });
        markers.push(marker);
        markersIcon.push(markImg);
        alternateMarkers.push(altMarkImg);
        //add to bounds for auto center and zoom
        bounds.extend(markerLatLng);
    });
    $("#map_list ul li").on('mouseenter', function(){
        var id=$(this).attr('id');
        markers[id].setIcon(alternateMarkers[id]);
    }).on('mouseleave', function(){
        var id=$(this).attr('id');
        markers[id].setIcon(markersIcon[id]);      
    });    
});​ 
```

[演示小提琴](http://jsfiddle.net/mD9z3/)

# c# - 如何在 C# 中删除顶级域扩展

> ID：13059834
> 
> 赞同：0
> 
> 时间：2012-10-25T00:20:15.593
> 
> 标签：c#, dns, uri

> **可能重复：**
> [c#：仅从 URL 获取域名？](https://stackoverflow.com/questions/2154167/c-get-just-the-domain-name-from-a-url)
> [C#：从任何 URL 获取准确的域名](https://stackoverflow.com/questions/5984361/c-sharp-getting-exact-domain-name-from-any-url)

我正在尝试从给定的 URL 中删除顶级域扩展。

示例 www.google.com、www.google.co.uk

我可以提取主机并使用 Uri 类，并且可以去掉“www.”。

我也可以去掉 .com、.org 或任何其他扩展名，只要它是 3 个字符。

我将如何删除诸如 .co.uk 之类的扩展名或任何包含与标准不同的内容的 URL。

我真的只需要提取顶级域前（“google”或“maps.google”）。

对此的任何帮助将不胜感激。

这是我如何提取 Uri 对象的最后一项的代码片段。

```
public static string Test(Uri uri)
    {
        if (!uri.HostNameType.Equals(UriHostNameType.Dns) || uri.IsLoopback)
            return string.Empty; // or throw an exception
        return uri.Host.Split('.').Last();
    } 
```

# php - if 语句来计算有多少没有答案？php

> ID：13059835
> 
> 赞同：0
> 
> 时间：2012-10-25T00:20:16.073
> 
> 标签：php, variables

似乎找不到任何东西，虽然我可能只是不知道我在找什么。

我想检查 6 个变量中是否有多少是肯定的。因此，如果四个返回“否”值，那么两个是肯定的。

我正在考虑建立一个 if 链

```
$var_array = 0;
if ($var1 == "yes"){
  $var_array++;
}
if ($var2 == "yes"){
  $var_array++;
} 
```

然后使用数组告诉我返回了多少个 yes 值。这自然会奏效，但将是一个漫长的过程。有没有更简单的方法[或更雄辩]来做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:23:48.443

```
$vars = array($var1, $var2, $var3, $var4, $var5, $var6);
$yes_count = 0;
foreach($vars as $var) {
  if($var == "yes")
    $yes_count++;
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T05:33:21.057

您可能正在寻找[`array_keys`](http://php.net/array_keys)使用第二个参数*search*的函数：

```
$vars      = array($var1, $var2, $var3, $var4, $var5, $var6);
$yes_count = count(array_keys($vars, 'yes')); 
```

此外，建议您首先使用数组而不是编号`$var`变量。

# javascript - 具有默认值的 Javascript 数组（相当于 Python 的 defaultdict）？

> ID：13059837
> 
> 赞同：15
> 
> 时间：2012-10-25T00:20:23.503
> 
> 标签：javascript, python

> **可能重复：**
> [在读取之前设置未定义的 javascript 属性](https://stackoverflow.com/questions/11503666/set-undefined-javascript-property-before-read)

Javascript中是否有相当于[Python的defaultdict ？](http://docs.python.org/library/collections.html#collections.defaultdict)这将是一个 Javascript 数组，其中为缺少的键返回的值是可定义的。就像是：

```
var a = defaultArray("0");
console.log(a['dog']);
// would print 0 
```

如果没有，您将如何实施？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:38:02.327

不，这在 JavaScript 中是不可能的。顺便说一句，您当然是指*对象*（属性值映射）而不是数组。两种解决方案：

*   将您的对象实现为 a [`Proxy`](http://wiki.ecmascript.org/doku.php?id=harmony:proxies)，它旨在完全按照您的意愿行事。然而，它只是一个草稿，目前仅[在 Firefox 的 Javascript 1.8.5 中支持](https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Proxy)。

*   使用带有字符串参数而不是对象属性的 getter 函数。该函数可以在内部“字典”对象中查找输入键，并以编程方式处理未命中 - 例如动态创建值或返回默认值。

    当然，您可以为此类 getter 函数构建工厂。

```
function defaultDict(map, default) {
    return function(key) {
        if (key in map)
            return map[key];
        if (typeof default == "function")
            return default(key);
        return default;
    };
}

var a = defaultDict({cat: 1}, 0);
console.log(a('cat')); // 1
console.log(a('dog')); // 0 
```

# java - Java中的幂精度

> ID：13059842
> 
> 赞同：0
> 
> 时间：2012-10-25T00:20:53.357
> 
> 标签：java, precision

我正在尝试在 Java 中为小于 1 的指数执行幂计算，例如：(2^0.333) 但是当我在 Java 中计算时，我得到的结果的精度低于我在上进行相同计算时的精度一个普通的计算器。

在爪哇

```
double f = Math.pow(2.0,0.333);
System.out.println(f);

//output
//1.2596299799473993 
```

在我得到的普通计算器中

```
//output
//1.2596299799473993502546921425703 
```

如何在不丢失精度的情况下在 java 中获得相同的结果？

任何帮助表示赞赏

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:30:26.867

Java 中的内置浮点运算精度有限。内置[`BigDecimal`](http://docs.oracle.com/javase/6/docs/api/java/math/BigDecimal.html)类不提供您需要的操作（真正的求幂，甚至日志）。您可以使用第三方应用程序，例如[Apfloat](http://www.apfloat.org/)（参见`ApfloatMath`课程）或[JScience](http://jscience.org/)，它们都可以进行任意精度的幂计算。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:31:51.530

仅使用原始双精度无法获得更精确的值。相反，使用[BigDecimal](http://docs.oracle.com/javase/7/docs/api/java/math/BigDecimal.html)，它用于表示任意*精确*的浮点值。

请注意，您将需要一个自定义`pow`函数来处理 BigDecimal。[在这个 SO answer](https://stackoverflow.com/questions/3579779/how-to-do-a-fractional-power-on-bigdecimal-in-java#3590314)中可以找到一种实现。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:27:43.330

双精度浮点值，就像您在 Java 代码中使用的那样，只能准确地表示 15 到 17 位有效数字。除非您使用的 Windows 计算器应用程序在内部使用更高精度的数据类型（这不太可能），否则这些数字可能毫无意义。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2021-06-24T03:10:08.117

您可以尝试使用 BigDecimal 并设置精度。

```
 BigDecimal base = new BigDecimal(2.0);

   BigDecimal exp = new BigDecimal(0.3333);

   BigDecimal resul = new BigDecimal((Math.pow(base.doubleValue(),exp.doubleValue()))).setScale(31,RoundingMode.HALF_UP);
    System.out.println("resul "+ resul); 
```

# php - 在 html 上回显带有标签的 xml

> ID：13059843
> 
> 赞同：0
> 
> 时间：2012-10-25T00:21:23.170
> 
> 标签：php, xml

我正在尝试回显 xml，但我无法回显 xml 标签，这是我的代码

```
 <?php
    // set feed URL
    $feedURL = 'http://gdata.youtube.com/feeds/api/videos?orderby=updated&vq=rihana';

    // read feed into SimpleXML object
    $sxml = simplexml_load_file($feedURL);
    ?>
      <h1><?php echo $sxml->title; ?></h1>
    <?php
    $xml = new SimpleXMLElement('<xml></xml>');

    // iterate over entries in feed
    foreach ($sxml->entry as $entry) {
      // get nodes in media: namespace for media information
      $media = $entry->children('http://search.yahoo.com/mrss/');

      // get video player URL
      $attrs = $media->group->player->attributes();
      $watch = $attrs['url']; 

      // get video thumbnail
      $attrs = $media->group->thumbnail[0]->attributes();
      $thumbnail = $attrs['url']; 

       $track = $xml->addChild('item');
        $track->addChild('description',  $media->group->description);
        $track->addChild('title', $media->group->title);
        $track->addChild('url', $watch);

    }  
    ?>
     <p>
        <?php       
         header('Content-type: text/xml');

echo( htmlentities( $xml->asXML() ) );

    foreach ($xml->item as $record) {
        echo '<div class="item_record">'."\n";
        echo '<h3>'.$record->title.'</h3>'."\n";
        echo '<p><span class="category">description: </span>'.$record->description.'</p>'."\n";
        echo '<p><span class="category">url: </span><a href='.$record->url.'>'.$record->url.'</a></p>'."\n";

        echo '</div>'."\n";
    }?> 

        </p> 
```

我真的很想以 xml 格式打印数据，就像下面代码的混合

```
echo( htmlentities( $xml->asXML() ) ); 
```

看起来不错

```
 foreach ($xml->item as $record) {
        echo '<div class="item_record">'."\n";
        echo '<h3>'.$record->title.'</h3>'."\n";
        echo '<p><span class="category">description: </span>'.$record->description.'</p>'."\n";
        echo '<p><span class="category">url: </span><a href='.$record->url.'>'.$record->url.'</a></p>'."\n";

        echo '</div>'."\n";
    }?> 
```

哪种操作最能解决我的问题？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T03:38:41.490

这可能会帮助您：

```
 $dom = new DOMDocument("1.0");
  $parent = $dom->appendChild($dom->createElement("PARENT1"));
  $parent->setAttribute("xmlns:xsi", "http://www.w3.org/2001/XMLSchema-instance");
  $child = $root->appendChild($dom->createElement("CHILD1"));
  $child->appendChild($dom->createTextNode('VALUE_FOR_CHILD1'));
  $dom->encoding = "UTF-8";
  $xml = $dom->saveXML();
  echo $xml; 
```

会给你这样的东西：

```
<?xml version="1.0" encoding="UTF-8"?>
<PARENT1 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> 
 <CHILD1>VALUE_FOR_CHILD1</CHILD1>
</PARENT1> 
```

# bash - 在 Bash 中具有浮点值的 C 风格算术

> ID：13059845
> 
> 赞同：7
> 
> 时间：2012-10-25T00:21:37.353
> 
> 标签：bash, floating-point, arithmetic-expressions

我怎样才能从这个 bash 脚本中得到正确的结果？

```
#!/bin/bash
echo $(( 1/2 )) 
```

结果我得到`0`了！所以我尝试使用这些但没有成功：

```
$ echo $(( 1/2.0 ))
bash: 1/2.0 : syntax error: invalid arithmetic operator (error token is ".0 ")
$ echo $(( 1.0/2 ))
bash: 1.0/2 : syntax error: invalid arithmetic operator (error token is ".0/2 ") 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2012-10-25T00:23:27.383

[bash](/questions/tagged/bash "显示标记为“bash”的问题")不是单独使用*浮点数*的正确工具，您应该使用[bc](/questions/tagged/bc "显示标记为“bc”的问题")：

```
bc <<< "scale=2; 1/2"
.50 
```

如果您需要将结果存储在变量中：

```
res=$(bc <<< "scale=2; 1/2")
echo $res 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T00:25:23.043

我曾经偶然发现一段很好的代码，它在某种程度上利用了 sputnick 提出的建议，但将它包装在一个`bash`函数中：

```
function float_eval()
{
    local stat=0
    local result=0.0
    if [[ $# -gt 0 ]]; then
        result=$(echo "scale=$float_scale; $*" | bc -q 2>/dev/null)
        stat=$?
        if [[ $stat -eq 0  &&  -z "$result" ]]; then stat=1; fi
    fi
    echo $result
    return $stat
} 
```

然后，您可以将其用作：

```
c=$(float_eval "$a / $b") 
```

# asynchronous - 如何将 kombu 与 pika 异步一起使用？

> ID：13059848
> 
> 赞同：1
> 
> 时间：2012-10-25T00:22:12.920
> 
> 标签：asynchronous, rabbitmq, pika, kombu

我正在尝试使用kombu编写一个同时处理两条消息的服务器。我的交通工具是rabbitmq。

我相信答案是使用 kombu 和 pika-async。但是，似乎没有任何关于如何执行此操作的文档。

帮助？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-05T07:05:12.143

我想到了。

您应该使用 gevent 或 eventlet 使所有调用异步。

# apache - 在 apache 2.2 (CentOS 6.3) 上通过 https 的 Webdav

> ID：13059850
> 
> 赞同：2
> 
> 时间：2012-10-25T00:22:38.463
> 
> 标签：apache, webdav

我正在尝试在 CentOS 6.3 服务器上设置 webdav。它适用于http，但不适用于https。

我安装了以下img：

```
httpd-2.2.15-15.el6.centos.1.i686
davfs2-1.4.6-1.el6.rf.i686
cadaver-0.23.3-1.el6.i386
litmus-0.12.1-3.el6.i686
on CentOS 6.3 
```

我的 apache https 配置是：

```
<VirtualHost _default_:443>
SSLProtocol all -SSLv2
SSLHonorCipherOrder On
SSLCipherSuite RC4-SHA:HIGH:!ADH
SSLCertificateFile  /etc/pki/tls/certs/ssl.pem
SSLCertificateKeyFile  /etc/pki/tls/certs/ssl.key
SSLCertificateChainFile  /etc/pki/tls/certs/Class-1-Intermediate-Server-CA.ca.pem
<Files ~ "\.(cgi|shtml|phtml|php3?)$">
    SSLOptions +StdEnvVars
</Files>
<Directory "/var/www/cgi-bin">
    SSLOptions +StdEnvVars
</Directory>

Alias /webdav1953  "/var/www/WEBDAV"
<Location /webdav1953>
   DAV on
   Options +Indexes
   AddDefaultCharset UTF-8
   SSLRequireSSL
   AuthType Basic
   AuthName "WebDAV"
   AuthUserFile /var/www/passwd/webdav_basic
   Options +Indexes
   IndexOptions FancyIndexing
   Satisfy all
   Order allow,deny
   Require valid-user
   Allow from 192.168.0.0/16 169.254.128.201 127.0.0.1
   Require user greg
</Location>
</VirtualHost> 
```

如果我使用 cadaver 通过 https 访问 /webdav1953，它会失败并显示：

```
Could not access /webdav1953/ (not WebDAV-enabled?):
Could not read chunk size: connection was closed by server
Connection to `amarone.kyriacou.eu' closed.
dav:!> 
```

我可以打开到 /webdav1953 的 https 连接，而不会出现错误或警告消息（如果我在“位置 /webdav1953”中有“Dav On”，我应该能够做到这一点）。我使用 StartCom Ltd 的 SSL 证书问题。

我在“VirtualHost*默认值*：443”之外有一个类似的 webdav 定义，我可以使用 cadaver 访问它，并且 litmus 没有错误。

当我对 /webdav1953（通过 https）运行石蕊试纸时，所有测试都成功并发出一个警告：

```
5\. copy_nodestcoll....... WARNING: COPY to non-existant collection '/webdav1953/litmus/nonesuch' gave '500 Internal Server Error' not 409 (RFC2518:S8.8.5) 
```

直到：

> ```
> 5\. propinit.............. pass
> 6\. propset............... FAIL (PROPPATCH on `/webdav1953/litmus/prop': Could not read chunk size: connection was closed by server)
> 7\. propget............... SKIPPED
> 8\. propextended.......... FAIL (PROPFIND on `/webdav1953/litmus/prop': Could not read chunk size: connection was closed by server)
> 9\. propmove.............. SKIPPED 
> ```

查看 debug.log 中的测试“6.propset”：

```
 ******* Running test 6: propset ********
 ah_create, for WWW-Authenticate
 Running pre_send hooks
 auth: Sending 'Basic' response
 Sending request headers:
 PROPPATCH /webdav1953/litmus/prop HTTP/1.1^M
 User-Agent: litmus/0.12.1 neon/0.29.3^M
 Connection: TE^M
 TE: trailers^M
 Host: amarone.kyriacou.eu^M
 Content-Length: 1033^M
 Content-Type: application/xml^M
 Authorization: Basic Z2VvcmdlOmZyZWQxN2F2cmlv^M
 X-Litmus: props: 6 (propset)^M
 ^M
 Sending request-line and headers:
 Sending request body:
 Body block (1033 bytes):
 [<?xml version="1.0" encoding="utf-8" ?>
 <D:propertyupdate xmlns:D="DAV:"><D:set><D:prop><prop0 xmlns="http://example.com/neon/litmus/">value0</prop0></D:prop></D:set>
 <D:set><D:prop><prop1 xmlns="http://example.com/neon/litmus/">value1</prop1></D:prop></D:set>
 <D:set><D:prop><prop2 xmlns="http://example.com/neon/litmus/">value2</prop2></D:prop></D:set>
 <D:set><D:prop><prop3 xmlns="http://example.com/neon/litmus/">value3</prop3></D:prop></D:set>
 <D:set><D:prop><prop4 xmlns="http://example.com/neon/litmus/">value4</prop4></D:prop></D:set>
 <D:set><D:prop><prop5 xmlns="http://example.com/neon/litmus/">value5</prop5></D:prop></D:set>
 <D:set><D:prop><prop6 xmlns="http://example.com/neon/litmus/">value6</prop6></D:prop></D:set>
 <D:set><D:prop><prop7 xmlns="http://example.com/neon/litmus/">value7</prop7></D:prop></D:set>
 <D:set><D:prop><prop8 xmlns="http://example.com/neon/litmus/">value8</prop8></D:prop></D:set>
 <D:set><D:prop><prop9 xmlns="http://example.com/neon/litmus/">value9</prop9></D:prop></D:set>
 </D:propertyupdate>
 ]
 Request sent; retry is 1.
 [status-line] < HTTP/1.1 207 Multi-Status^M
 [hdr] Date: Wed, 24 Oct 2012 22:39:05 GMT^M
 Header Name: [date], Value: [Wed, 24 Oct 2012 22:39:05 GMT]
 [hdr] Server: Apache^M
 Header Name: [server], Value: [Apache]
 [hdr] Transfer-Encoding: chunked^M
 Header Name: [transfer-encoding], Value: [chunked]
 [hdr] Content-Type: text/xml; charset="utf-8";charset=utf-8^M
 Header Name: [content-type], Value: [text/xml; charset="utf-8";charset=utf-8]
 [hdr] ^M
 End of headers.
 Running post_headers hooks
 [chunk] < 1b7^M
 Got chunk size: 439
 Reading 439 bytes of response body.
 Got 439 bytes.
 Read block (439 bytes):
 [<?xml version="1.0" encoding="utf-8"?>
 <D:multistatus xmlns:D="DAV:" xmlns:ns1="http://example.com/neon/litmus/" xmlns:ns0="DAV:">
 <D:response>
 <D:href>/webdav1953/litmus/prop</D:href>
 <D:propstat>
 <D:prop>
 <ns1:prop0/>^M
 <ns1:prop1/>^M
 <ns1:prop2/>^M
 <ns1:prop3/>^M
 <ns1:prop4/>^M
 <ns1:prop5/>^M
 <ns1:prop6/>^M
 <ns1:prop7/>^M
 <ns1:prop8/>^M
 <ns1:prop9/>^M
 </D:prop>
 <D:status>HTTP/1.1 200 OK</D:status>
 </D:propstat>
 </D:response>
 </D:multistatus>
 ]
 XML: Parsing 439 bytes.
 XML: start-element (0, {DAV:, multistatus}) => 1
 XML: char-data (1) returns 0
 XML: start-element (1, {DAV:, response}) => 2
 XML: char-data (2) returns 0
 XML: start-element (2, {DAV:, href}) => 4
 XML: char-data (4) returns 0
 XML: end-element (4, {DAV:, href})
 XML: char-data (2) returns 0
 XML: start-element (2, {DAV:, propstat}) => 7
 XML: char-data (7) returns 0
 XML: start-element (7, {DAV:, prop}) => 50
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop0}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop0})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop1}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop1})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop2}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop2})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop3}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop3})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop4}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop4})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop5}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop5})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop6}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop6})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop7}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop7})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop8}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop8})
 XML: char-data (50) returns 0
 XML: start-element (50, {http://example.com/neon/litmus/, prop9}) => 0
 XML: end-element (0, {http://example.com/neon/litmus/, prop9})
 XML: char-data (50) returns 0
 XML: end-element (50, {DAV:, prop})
 XML: char-data (7) returns 0
 XML: start-element (7, {DAV:, status}) => 6
 XML: char-data (6) returns 0
 Decoded status line: HTTP/1.1 200 OK
 XML: end-element (6, {DAV:, status})
 XML: char-data (7) returns 0
 XML: end-element (7, {DAV:, propstat})
 XML: char-data (2) returns 0
 XML: end-element (2, {DAV:, response})
 XML: char-data (1) returns 0
 XML: end-element (1, {DAV:, multistatus})
 XML: XML_Parse returned 1
 Aborted request (-3): Could not read chunk size
 sess: Closing connection.
 sess: Connection closed.
 Request ends, status 207 class 2xx, error line:
 Could not read chunk size: connection was closed by server
 Running destroy hooks.
 Request ends.: 
```

任何解决此问题的帮助都将受到欢迎。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-08T12:04:43.107

I don't see a `SSLEngine On`. It defaults to Off ... so I would expect that.

BTW: I wouldn't use Basic authentication. Perhaps you can try at least digest auth.

# .htaccess - 将 htaccess 转换为 web.config 导致 500 错误，我看不到，为什么？

> ID：13059860
> 
> 赞同：0
> 
> 时间：2012-10-25T00:23:23.310
> 
> 标签：.htaccess, web-config, windows-server-2008

我真的被困在这里，这让我发疯。我已经搜遍了，但我看不出我在这里做错了什么。

我正在使用 ISAPI_ModRewrite 移动以前在 Windows 服务器上的应用程序，因此它可以与 htaccess 一起使用，我正在尝试将其移动到我无法安装 ISAPI 作为其共享托管环境的 windows-server 2008 服务器。

下面是我想要做的，但这只是返回一个 500 内部服务器错误任何想法我做错了什么？这是我要转换的 htaccess 代码...

```
# PRODUCT PAGE
RewriteRule ^([0-9]*)/(.*)/? /prodpage.asp?productid=$1 [L]

# OTHER PAGES

RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^([^/]+)/$ /$1.asp [QSA]
RewriteRule ^([^/]+)/([0-9]+)-([0-9]+)/$ /$1.asp?pricerange=$2-$3
RewriteRule ^([^/]+)/([0-9]+)-([0-9]+)/([a-z])/$ /$1.asp?pricerange=$2-$3&sort=$4

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !(\.[a-zA-Z0-9]{1,5}|/)$
RewriteRule (.*)$ /$1/ [R=301,L] 
```

这是我的 web.config 文件...

```
<?xml version="1.0" encoding="UTF-8"?>
<configuration>
<system.webServer>
<rewrite>
<rules>
<rule name="Product Page" stopProcessing="true">
<match url="^([0-9]*)/(.*)/?$" ignoreCase="false" />
<conditions>
<add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
<add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
</conditions>
<action type="Rewrite" url="prodpage.asp?productid={R:1}" appendQueryString="true" />
</rule>
<rule name="Other Page1" stopProcessing="true">
<match url="^([^/]+)/$" ignoreCase="false" />
<conditions>
<add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
<add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
</conditions>
<action type="Rewrite" url="{R:1}.asp" appendQueryString="true" />
</rule>
<rule name="Other Page2" stopProcessing="true">
<match url="^([^/]+)/([0-9]+)-([0-9]+)/$" ignoreCase="false" />
<conditions>
<add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
<add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
</conditions>
<action type="Rewrite" url="{R:1}.asp?pricerange={R:2}-{R:3}" appendQueryString="true" />
</rule>
<rule name="Other Page3" stopProcessing="true">
<match url="^([^/]+)/([0-9]+)-([0-9]+)/([a-z])/$" ignoreCase="false" />
<conditions>
<add input="{REQUEST_FILENAME}" matchType="IsFile" ignoreCase="false" negate="true" />
<add input="{REQUEST_FILENAME}" matchType="IsDirectory" ignoreCase="false" negate="true" />
</conditions>
<action type="Rewrite" url="{R:1}.asp?pricerange={R:2}-{R:3}&sort={R:4}" appendQueryString="true" />
</rule>
</rules>
</rewrite>
</system.webServer>
</configuration> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:41:56.180

修复了这个抱歉，我想我会为将来可能需要帮助的人发布我的答案。

我需要用 & 替换 & 符号作为它的 xml。不管怎么说，还是要谢谢你 ：）

# yii - Yii Grid 日历电子表格表格

> ID：13059864
> 
> 赞同：-1
> 
> 时间：2012-10-25T00:23:36.790
> 
> 标签：yii

我是一名初级 PHP 开发人员。我有一个我写的应用程序，我想用 Yii 重写。到目前为止，大部分内容都非常简单，但我对当前应用程序的一个观点是使用该应用程序的公司喜欢它，我怀疑他们是否会希望它改变。

在这个视图中，有一个看起来很像电子表格的表格（有很多行和列来输入数量）。表格的第一列是项目的名称，其他 7 列代表一周中每一天的项目数量。每个单元格代表行项目和列日期的订单，并有一个输入框。

在数据库中，每个单独的订单是数据库中的一行，显然每个订单只有一个日期列。在纯 PHP 中装配视图很容易，但我不知道如何使用 Yii 来做到这一点。

Yii 的 CGridView 似乎将数据库列映射到数据网格表中的列。我不知道如何在网格视图中有 7 列，当数据库只有一个日期列时，一周中的每一天都有一列。根据 CGridView 中的文档，每一行对应一个数据项。在我看来，每一行都需要 7 个数据项。

问题：现在有什么方法可以用 Yii 做到这一点吗？写一个扩展会是一个好的解决方案吗？Yii 不会在这个观点上帮助我吗？或者除了CGridView还有什么？如果 Yii 可以做到，我该从哪里开始？CActiveDataProvider 中的东西，扩展 CDataColumn，调整模型？

我不太确定如何继续，如果不合适的话，我也不想将应用程序移植到 Yii 上。希望这足以清楚地传达问题所在。提前致谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T09:08:10.077

一种选择是为您的项目表创建一些关系。我假设它们已经与订单表相关。您可以在项目模型中为一周中的每一天创建一个[STAT 关系](http://www.yiiframework.com/doc/guide/1.1/en/database.arr#statistical-query)，例如：

```
public function relations()
{
    return array(
        ...
        'sundayOrderCount' => array(self::STAT, 'Orders', 'item_id', 'condition'=>'DAYNAME(`order_date`) = "Sunday"',
        ...
    );
} 
```

（`item_id`Orders 表中 Items 的 fk 在哪里，并且`order_date`是 Orders 表中下订单时的时间戳）

在上面的示例中，您应该能够从表中获取所有项目并获得周日的每个项目的总销售额，如下所示

```
$model->sundayOrderCount; 
```

然后像这样弹出一个 CGridView：

```
$this->widget('zii.widgets.grid.CGridView', array(
    'id'=>'item-grid',
    'dataProvider'=>$model->search(),
    'filter'=>$model,
    'columns'=>array(
        'name',
        array(
            'header'=>'Sunday Sales',
            'value'=>'$data->sundayOrderCount',
        ),
    ),
)); 
```

没有测试它，但我希望这能给你一些东西。

# java - 一组小型库与单个大型 java 的性能

> ID：13059873
> 
> 赞同：0
> 
> 时间：2012-10-25T00:24:39.690
> 
> 标签：java, architecture, shared-libraries, codebase

我收集了我的许多旧项目和随机代码片段，并将它们组织在一个代码库中。我试图弄清楚小型图书馆是否比大型图书馆更有效。

该代码库将用于浏览器小程序、桌面应用程序和服务器应用程序。非常感谢。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:32:17.890

据我所知，类加载器和安全管理器至少会达到一次性能，这是您第一次加载某个类时。
JVM 在启动时将所有相关类（最后是 JAR）加载到内存中，如果它们在`import`.
如果使用反射等，这就是“按需加载”的发生方式。

但我想告诉你的底线是，如果我是你，**我会把代码分解成尽可能多的部分**。
从长远来看，这将提供更好的可维护性，并且这一点在每个软件生命周期中都非常重要。

祝你好运！

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:36:31.470

就个人而言，我尝试将我的代码库组织成功能组。

如果我正在做一个简单的控制台或 Web 项目，我真的不想用它来拖动我所有的 UI 库代码。同样，我有几个 UI 库，分为实用程序、组件和动画/高级或专业库等。

对我来说，这往往会创建许多小型、非常具体的库（其中一些依赖于其他库 - 例如，我的许多库都依赖于相同的核心/实用程序库），但我可以提供很大的灵活性选择那些最能支持当前项目的库，而不需要拖很多，否则，无用的包袱。

它确实使管理变得更加复杂（因为您需要记住事物的位置，但是如果您注意如何命名和分组它们应该没问题）并且可能会使构建过程更长（取决于您使用的构建系统）采用）。

从执行的角度来看，我认为这不会产生巨大的影响（如果你正在做网络部署之类的事情，那么规模很重要；））

恕我直言

它确实有助于将项目保持在较小的规模，因为它们的自重要少得多，如果你有少量的单体库......（这是一种工作中的情况，这是一种完全的痛苦）。

# c - 在 C 中接收相同 ID 的线程

> ID：13059874
> 
> 赞同：0
> 
> 时间：2012-10-25T00:25:00.647
> 
> 标签：c, multithreading, for-loop

这是一个代码块，它创建了用户提供的多个线程，每个线程然后生成一个随机数并计算其平方根。我无法弄清楚为什么线程获得相同的 ID，第 64 行是罪魁祸首，因为它是创建线程的位置。我怀疑循环中发生了一些事情，导致线程全部同时生成。

```
////////////////////////////////////////////////
//
//
// Zach
//
// 
//
//
////////////////////////////////////////////////

#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <pthread.h>
#include <math.h>

void *squareroot(void *num1)
{
  int *id = (int *)num1;
  int incoming = rand()/100;
  float *outgoing = (float *)malloc(sizeof(float));
  printf("%d \n", *id);
  printf("%d\n", incoming);
  *outgoing = 5.000;
  //Calculate the square root of the number passed to the function
  *outgoing = sqrt(incoming);
  return outgoing;

}

int main(int argc, char* argv[])//testing funcion
{
  srand(time(NULL));
  int i, j;
  int *temp = (int *)malloc(sizeof(int));
  if (argc != 2) 
  {

    printf ("ERROR: Enter a number\n");
    return 1;

  }

  int loop = atoi(argv[1]); //grabbing the integer supplied by user
  pthread_t thread_id[loop];
  void *exit_status;
  float *thread_result;

  for(i = 0; i < loop; i++)
  {

    pthread_create(&thread_id[i], NULL, squareroot, &i);
  }

  for(j = 0; j < loop; j++)
  {
    pthread_join(thread_id[j], &exit_status);
    thread_result = (float *)exit_status;
    printf("%f\n", *thread_result);

  }

} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T01:05:15.257

我认为正在发生的事情是，您的循环在任何线程实际运行并提取其唯一 ID 之前完成创建所有线程（或至少其中一些线程）。

因为您正在传递一个指向 的指针`i`，所以当每个线程最终开始检查其参数时，`i`已经完成了......或者至少在中途。危险在于多个线程可能会看到相同的`i`. 更糟糕的是，您永远不会从该指针中复制值 - 您总是取消引用它。这意味着它可能会在您的线程执行过程中发生变化。

你应该做的是假装它是一个指针：

```
pthread_create(&thread_id[i], NULL, squareroot, (void*)i); 
```

在你的线程函数中：

```
int id = (int)num1; 
```

这是有效的，因为指针是按值传递的。您提供的任何值都是进入线程函数的值。以前它不起作用，因为您传递了一个指向可能在另一个线程中更改的值的指针。

PS：不要忘记`free`最后循环中每个线程的结果。目前你没有清理你分配的内存。

# java - 想要检查另一个片段中的 CheckBox 是否被选中

> ID：13059875
> 
> 赞同：2
> 
> 时间：2012-10-25T00:25:02.067
> 
> 标签：java, android, fragment

我有 2 个片段，我想从片段 1 检查片段 2 中的 CheckBox1 是否被选中。

**编辑**

我正在执行以下操作：在主要活动中：

```
@TargetApi(11)
public class gamesmodestab extends Activity{
    public static Context appContext;

    public boolean lf_ch=false;
public void onCreate(Bundle savedInstanceState){
        appContext=this;
        super.onCreate(savedInstanceState);
//Then I declare the fragments and add them 
```

在 Fragment 中，复选框可用：

```
@TargetApi(11)
public class tabquests extends Fragment{ 

    public CheckBox lc,
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)//onCreateView
    {

        View V=inflater.inflate(R.layout.tab_quests, container, false);
                lc=(CheckBox)V.findViewById(R.id.CheckBox01);
  lc.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener(){
              @Override
                public void onCheckedChanged(CompoundButton buttonView,
                        boolean isChecked) {
                  if(lc.isChecked())
                      lf_ch=true;//Wrong
                  else
                      lf_ch=false;//Wrong
              }
          }); 
```

在我想阅读 lf_ch 的片段中；

```
public void onClick(View v) {
                if(lf_ch==false)//Wrong
                { 
```

这是我想做的高水平的事情。所以我想要一种访问 Activity 上设置的 lf_ch 或直接访问第二个片段中的复选框的方法。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T01:34:37.227

您不应该直接从另一个片段访问一个片段中的输入状态。

最好创建一个活动级别变量来保存由 cb 指示的布尔值。

```
public boolean lf_ch = false; // default checked state. 
```

将您的 cb 的选中状态初始化为变量的值。

```
lc.setChecked(context.getActivity().lf_ch); 
```

然后在检查状态更改时更改变量的值。

```
lc.setOnCheckedChangeListener(new OnCheckedChangeListener(){

            @Override
            public void onCheckedChanged(CompoundButton buttonView,
                    boolean isChecked) {
                context.getActivity().lf_ch = isChecked;

            }}); 
```

然后在 frag1 中可以测试 If_ch 的值；

```
if(context.getActivity().If_ch){
    // Do something
} 
```

- - - 编辑 - - - -

```
@TargetApi(11)
public class gamesmodestab extends Activity{
    public static Context appContext;

    public boolean lf_ch=false;
public void onCreate(Bundle savedInstanceState){
        appContext=this;
        super.onCreate(savedInstanceState);
//Then I declare the fragments and add them
In the Frgment were the checkbox is available:

@TargetApi(11)
public class tabquests extends Fragment{ 
    gamesmodestab gmt = (gamesmodestab) getActivity();
    public CheckBox lc,
@Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState)//onCreateView
    {

        View V=inflater.inflate(R.layout.tab_quests, container, false);
                lc=(CheckBox)V.findViewById(R.id.CheckBox01);
  lc.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener(){
              @Override
                public void onCheckedChanged(CompoundButton buttonView,
                        boolean isChecked) {
                  gmt.If_ch = isChecked;
              }
          }); 
```

您还需要在此类中定义 gmt。

```
public void onClick(View v) {
                if(!gmt.lf_ch)
                { 
```

# postgresql - 生成从每个节点到树根的路径，表示为表中的边

> ID：13059877
> 
> 赞同：5
> 
> 时间：2012-10-25T00:25:13.687
> 
> 标签：postgresql, tree, hierarchy, hierarchical-data, recursive-query

我在 PostgreSQL 数据库上有下表（parent_fk 是引用同一个表的外键）：

```
id    |    parent_fk
72    |    
342   |    72
583   |    342 
```

我想查询此表并通过中间父/子关系发现每个元素到最终父级的路径。例如，我想获得以下作为 SQL 查询的答案：

```
id    |    parent_fk    |    path
72    |                 |     72
342   |    72           |    72;342
583   |    342          |   72;342;583 
```

我在 PostgreSQL 上阅读了 CTE（通用表表达式）和递归查询，但我自己还不能解决这个问题。有任何想法吗？提前致谢。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2012-10-25T01:42:05.180

如果您正在做很多此类事情，您可能需要检查[`ltree`contrib 模块。](http://www.postgresql.org/docs/current/static/ltree.html)

这是一个可以完成这项工作的 CTE，请参阅[SQLFiddle](http://sqlfiddle.com/#!12/b9850/3)：

```
WITH RECURSIVE x(id,parent_fk,parents,last_id, depth) AS (
  SELECT id, parent_fk, ARRAY[id] AS parents, id AS last_id, 0 AS depth FROM table1
  UNION ALL
  SELECT x.id, x.parent_fk, parents||t1.parent_fk, t1.parent_fk AS last_id, x.depth + 1
  FROM x 
    INNER JOIN table1 t1 
    ON (last_id= t1.id)
  WHERE t1.parent_fk IS NOT NULL
)
SELECT id, parent_fk, array_to_string(parents,';')
FROM x 
WHERE depth = (SELECT max(sq.depth) FROM x sq WHERE sq.id = x.id); 
```

您的表格是将有*向图表示*为一组*边*。您已指定该图是一棵树，这意味着它是无环的。您要做的是找到从树上的每个节点（内部或叶）到根的路径，并将其表示为分号分隔的字符串。

# c++ - c++ sort 不使用自定义函数

> ID：13059878
> 
> 赞同：0
> 
> 时间：2012-10-25T00:25:18.427
> 
> 标签：c++, sorting, vector, comparator, stl-algorithm

我正在尝试排序

```
std::vector< std::vector< std::string> > perm; 
```

我正在尝试`std::sort`从算法标题中使用

我打电话给它

```
std::sort( perm.begin(), perm.end(), sortPerms); 
```

这是我的排序功能：

```
bool sortPerms (const std::vector<std::string> &i, const std::vector<std::string> &j) {
  for(unsigned int x = 0; x < i.size(); x++) {
    if(i[x] != j[x])
      return false;
  }
  //both are equal
  return true;
} 
```

排序的目的是然后调用 std::unique 以获得具有唯一值的向量。当我在 cygwin 中使用 gcc 进行编译时，我没有收到任何错误，但我有重复，当我使用 Visual Studio 2010 进行编译时，我收到一个错误，即 operator< 未定义。我一步一步地尝试使用它自己的排序功能，而不是我定义的那个。

我不确定如何解决这个问题，有什么建议吗？

其他细节：保证所有向量的大小相同。它的目的是字符串原始向量的每个排列的向量。每个字符串都是一个命令，我正在寻找可以改变这些命令的所有不同方式。所以我需要去除重复项。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:32:12.767

您的排序函数应该返回 when `a < b`，而不是`a != b`。

此外，默认情况下，`std::vector<>`应该已经支持通过 进行字典比较`operator<`，这应该符合您的预期（依次比较每个元素，与用于比较的第一个非等效元素）。请参阅[http://en.cppreference.com/w/cpp/container/vector/operator_cmp](http://en.cppreference.com/w/cpp/container/vector/operator_cmp)

您当前的 sortPerms 函数看起来像您将传递给的函数`std::unique`，但它的行为与用于 的谓词不同`std::sort`。

# java - 为什么我会收到 java.lang.OutOfMemoryError: Java heap space 错误？

> ID：13059881
> 
> 赞同：1
> 
> 时间：2012-10-25T00:25:25.073
> 
> 标签：java, out-of-memory, stack

我现在正在学习堆栈，我的代码编译后发现。当我运行它时，代码不会打印我的调试 println 和错误

```
Exception in thread "main" java.lang.OutOfMemoryError: Java heap space
at java.util.Arrays.copyOf(Arrays.java:2760)
at java.util.Arrays.copyOf(Arrays.java:2734)
at java.util.Vector.ensureCapacityHelper(Vector.java:226)
at java.util.Vector.addElement(Vector.java:573)
at java.util.Stack.push(Stack.java:50)
at stacks.main(stacks.java:56) 
```

被陈列。

我的代码如下所示：

```
import ch03.stacks.*;

import java.util.*;

public class stacks {

public static void main (String []args){

    System.out.printf("Enter a math equation in reverse polish notation:\n");

    Stack<Double> pemdas = new Stack<Double>();

    Scanner input = new Scanner(System.in);
    String in = input.next();

    double temp1, temp2, resultant = 0;

    while(input.hasNext()){
        if(in == "+"){
        temp1 = pemdas.peek();  
        pemdas.pop();
        temp2 = pemdas.peek();
        pemdas.pop();
        resultant = temp1 + temp2;
        pemdas.push(resultant);
        System.out.println(resultant);
        }

        if(in == "-"){
        temp1 = pemdas.peek();  
        pemdas.pop();
        temp2 = pemdas.peek();
        pemdas.pop();
        resultant = temp1 - temp2;
        pemdas.push(resultant);
        System.out.println(resultant);
        }

        if(in == "*"){
        temp1 = pemdas.peek();  
        pemdas.pop();
        temp2 = pemdas.peek();
        pemdas.pop();
        resultant = temp1 * temp2;
        pemdas.push(resultant);
        System.out.println(resultant);
        }

        if(in == "/"){
        temp1 = pemdas.peek();  
        pemdas.pop();
        temp2 = pemdas.peek();
        pemdas.pop();
        resultant = temp1 / temp2;  
        pemdas.push(resultant);
        System.out.println(resultant);
        }

        else
        pemdas.push(Double.parseDouble(in));
        System.out.println(resultant);

        }

    System.out.println("Answer:"+ resultant);
    }
} 
```

因此，我首先以反向波兰表示法读取整数字符串，然后如果它不是操作数，则将其弹出到我的堆栈中。至少这就是我认为它正在做的事情。任何帮助是极大的赞赏。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:29:07.323

您正在使用`peek()`which 实际上并没有从输入中删除下一个字符，因此它会不断循环。你需要`nextInt()`；

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:57:30.140

您错误地使用了扫描仪 hasNext/next。您应该始终在每个前面`next()`加上一个`hasNext()`.

在您的代码中，您`next()`在 while 循环之前调用。然后，您将使用 的返回值`hasNext()`来终止 while 循环。但是......你永远不会在while循环中调用'next（）'。因此`hasNext()`始终返回 true 并且您处于无限循环中。这 - 结合前面描述的 peek 问题 - 可能会增加你的堆栈，直到你的内存用完。

修复很简单。`next()`在`hasNext()`while 循环内立即移动

```
Scanner input = new Scanner(System.in);
double temp1, temp2, resultant = 0;

while(input.hasNext()) {
    String in = input.next(); 
```

不幸的是，该程序仍然无法运行，因为您没有正确进行字符串比较。替换如下行：

```
if (in == "+") 
```

和

```
if (in.equals("+")) 
```

希望这只是一个错字。如果您不明白为什么使用 == 进行字符串比较是一个问题，您将需要查看 Java 相等性。

最后，你的 if 逻辑有问题。提示：要处理互斥情况，请使用如下代码：

```
if () 
{
}
else if ()
{
}
else if ()
{
}
else
{
} 
```

# javascript - 如何按顺序从动态生成的表单中获取所有选中的复选框

> ID：13059882
> 
> 赞同：0
> 
> 时间：2012-10-25T00:25:26.100
> 
> 标签：javascript, jquery, html, forms

我编写了一个代码，它检索表单中元素的所有值，它与单选按钮、文本框、下拉列表、文本区域一起使用。但现在我想添加复选框，问题是复选框我们可以为特定名称设置多个值，所以需要按顺序获取复选框值，因为它们出现在表单中

这是获取值的代码：

```
var elements="";
                var $this = jQuery(this);
                $this.parents(".detailTable").find(":input").each(function(index, elm){
                if((jQuery(this).attr("type")=="button") ||(jQuery(this).attr("type")=="hidden"))
                {
                }else if((jQuery(this).attr("type")=="radio")){
                    if(jQuery(this).attr("checked")){
                    elements=elements + (jQuery(this).val());
                    elements=elements + "|";
            //      alert(jQuery(this).val())
                    }
                }else if((jQuery(this).attr("type")=="checkbox")){
                    if(jQuery(this).attr("checked")){
                    elements=elements + (jQuery(this).val());
                    elements=elements + "|";
                }
                }
                else{
                    elements=elements + (jQuery(this).val());
                    elements=elements + "|";
                //  alert(jQuery(this).val());
                }
                }); 
```

我想要一个复选框组的所有值以逗号分隔（表单可以有多个复选框），而元素之间的值是'|' 分开。

你能帮我解决这个问题吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T00:33:23.420

尝试使用该`.map()`方法..

```
var checkedBoxes= $('input[type=checkbox]:checked').map(function() {
                     return this.value ;
                  }).get().join('|'); 
```

# php - 使用 Google App 从域发送电子邮件

> ID：13059885
> 
> 赞同：0
> 
> 时间：2012-10-25T00:25:52.433
> 
> 标签：php, html, email

所以我将谷歌应用程序链接到我的网站。当人们需要恢复密码时，我需要使用它向他们发送电子邮件。我不确定这个谷歌应用程序是如何工作的。但是，我如何从谷歌帐户向请求密码恢复的用户发送一封包含信息的电子邮件。我要问的是如何编写使用 google 邮件帐户的 php 电子邮件脚本？我知道我可以写这样的东西：

```
<?php
 $to = "recipient@example.com";
 $subject = "Hi!";
 $body = "Hi,\n\nHow are you?";
 if (mail($to, $subject, $body)) {
   echo("<p>Message successfully sent!</p>");
  } else {
   echo("<p>Message delivery failed...</p>");
  } 
```

但是如何从我的谷歌帐户自动发送。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T03:31:42.210

搜索 DKIM（域名密钥识别邮件）；

-> 设置你的谷歌应用

-> 使用 dkim 库

此链接将帮助您：

1.  [DKIM](http://php-dkim.sourceforge.net/)
2.  [DKIM Stackoverflow 问题](https://stackoverflow.com/questions/2799611/setting-up-domainkeys-dkim-in-a-php-based-smtp-client)
3.  [在此处](http://technew.in/)实施（检查注册电子邮件）

# php - Flex Actionscript PHP 和 Mysql

> ID：13059887
> 
> 赞同：0
> 
> 时间：2012-10-25T00:26:15.187
> 
> 标签：php, actionscript, flex4.5, amfphp

越读越让我困惑……

所以在动作脚本中我写下 flex 移动项目的功能，在 php 文件中我写下我用来联系数据库的函数？

是否有任何同时使用 actionscript 和 PHP 的示例应用程序。现在我也对 amfphp 感到困惑。任何帮助都会很棒

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T07:26:25.070

您还不需要任何 amfphp，它适用于一些高级案例。

要将 smth 保存到数据库，您已经有了正确的图片：您的数据库命令（使用[PDO](http://php.net/manual/en/book.pdo.php)的 SQL 命令）应该在 .php 文件中。

从您的移动 flex 应用程序中，您可以使用[URLLoader](http://help.adobe.com/en_US/FlashPlatform/reference/actionscript/3/flash/net/URLLoader.html)、URLStream（稍微高级一点）或[HTTPService](http://help.adobe.com/en_US/Flex/4.0/AccessingData/WS2db454920e96a9e51e63e3d11c0bf69084-7fdc.html)调用这些 .php 文件。

这是我的应用程序中的一个视图，它以 JSON 格式加载来自 PostgreSQL 的每周顶级玩家：

```
<?xml version="1.0" encoding="utf-8"?>
<s:View xmlns:fx="http://ns.adobe.com/mxml/2009" 
        xmlns:s="library://ns.adobe.com/flex/spark"
        viewActivate="startLoading(event)"
        viewDeactivate="cancelLoading(event)"
        title="Weekly top">

    <fx:Declarations>
        <s:MultiDPIBitmapSource id="BACK"
            source160dpi="@Embed('assets/icons/low-res/back.png')"
            source240dpi="@Embed('assets/icons/mid-res/back.png')"
            source320dpi="@Embed('assets/icons/high-res/back.png')"/>
        <s:MultiDPIBitmapSource id="LOAD"
            source160dpi="@Embed('assets/icons/low-res/load-top.png')"
            source240dpi="@Embed('assets/icons/mid-res/load-top.png')"
            source320dpi="@Embed('assets/icons/high-res/load-top.png')"/>
    </fx:Declarations>

    <s:states>
        <s:State name="portrait"/>
        <s:State name="landscape"/>
    </s:states> 

    <s:navigationContent>
        <s:Button icon="{BACK}" label.landscape="Back" click="navigator.popView()"/>
    </s:navigationContent>

    <s:actionContent>
        <s:BusyIndicator symbolColor="0xFFFFFF" />
    </s:actionContent>

    <fx:Script>
        <![CDATA[
            import com.brokenfunction.json.decodeJson;
            import spark.events.ViewNavigatorEvent;

            private const TOP:String = 'http://XXXX.com/top-json.php';

            private var _urlLoader:URLLoader = new URLLoader();

            private function startLoading(event:ViewNavigatorEvent):void {
                _urlLoader.addEventListener(Event.COMPLETE, handleComplete);
                _urlLoader.load(new URLRequest(TOP));
            }

            private function cancelLoading(event:ViewNavigatorEvent):void {
                _urlLoader.close();
            }

            private function handleComplete(event:Event):void {
                var loader:URLLoader = URLLoader(event.target);
                try {
                    var obj:Object = decodeJson(loader.data, true);
                    navigator.pushView(Top, obj.aaData);
                } catch (e:Error) {
                    trace('Invalid JSON: ' + loader.data);
                    navigator.popView();
                }
            }
        ]]>
    </fx:Script>    

    <s:BitmapImage source="{LOAD}" horizontalCenter="0" verticalCenter="0" scaleMode="letterbox" />
</s:View> 
```

# parallel-processing - 如何并行化现有的可执行文件？

> ID：13059888
> 
> 赞同：2
> 
> 时间：2012-10-25T00:26:20.140
> 
> 标签：parallel-processing, gpu, medical, boinc

在实验室中，我们有一个用于 MRI 分析的软件，其中涉及大量数据处理。有没有办法在不编辑程序本身的情况下将程序生成的负载重新分配到多台计算机/GPU 上？

# javascript - 玉：在mixin参数中转义html

> ID：13059890
> 
> 赞同：6
> 
> 时间：2012-10-25T00:26:29.147
> 
> 标签：javascript, pug

**我试过的：**

```
mixin simpleDivInject(text)
    div 
        h1 #{text}

mixin simpleDivInject("line one <br/> line two") 
```

**期望的结果**

```
<div>
    <h1>line one <br/> line two</h1>
</div> 
```

**实际结果**

```
<div>
    <h1>line one &lt;br/&gt; line two</h1>
</div> 
```

我怎样才能达到预期的结果。我已经尝试了更多的东西（例如将字符串存储在 var 等中），但到目前为止还没有运气。

* * *

## 回答 #1

> 赞同：15
> 
> 时间：2012-10-25T00:38:25.247

其实我只是想通了。在这里回答，希望对其他人有所帮助。转义不是发生在 mixin 参数系统中，而是发生在 vinilla jade 系统中，所以：

```
mixin simpleDivInject(text)
    div 
        h1!= text

mixin simpleDivInject("line one <br/> line two") 
```

解决问题

# python - 在视口周围包裹一个 pygame 表面

> ID：13059891
> 
> 赞同：2
> 
> 时间：2012-10-25T00:26:38.460
> 
> 标签：python, scroll, pygame, geometry-surface

我正在编写一个游戏，其中视口在有限的游戏世界中跟随玩家的船，并且我试图使背景“环绕”在各个方向上（你可以将它想象成一个 2D 表面包裹在一个球体 - 无论您朝哪个方向行驶，您最终都会回到起点）。

我可以毫不费力地将船和物体包裹起来，但是在视口本身通过游戏世界的边缘之前，背景不会出现。是否可以使背景表面“环绕”？

如果我不是很清楚，我很抱歉。这似乎是一个简单的问题，很多游戏都可以做到，但我没有找到答案。我有一些关于如何通过平铺背景来做到这一点的想法，但如果我能告诉表面进行换行就好了。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-27T03:24:25.080

我在胡闹一些类似于你描述的可能有用的东西。我决定尝试使用一个包含我所有 Tiles 的地图类，并且我只想一次将其中的一部分加载到内存中，因此我将其分解为 Sectors（32x32 tile）。我将其限制为一次仅加载 3x3 扇区。当我的地图滚动到边缘时，它会卸载另一侧的扇区并加载新的扇区。

我的 Map 类将具有所有已加载扇区的 Rect，而我的相机将具有其所在位置的 Rect。每个刻度我都会使用这两个矩形来查找我应该 blit 的地图的哪一部分，以及是否应该加载新的扇区。一旦你开始改变加载的扇区，你必须改变

每个扇区具有以下属性： 1\. 它的坐标，其中 (0, 0) 是世界上左上角最可能的扇区。2\. 其相对扇区坐标，(0, 0) 是左上角加载最多的扇区，如果加载了 3x3，则 (2,2) 是右下角。3\. 保存扇区区域的 Rect 4\. 指示扇区已满载的布尔值

每个游戏滴答都会检查 bool 是否已完全加载，如果没有，则在生成器上调用 next，该生成器会将 X 块拼贴到地图表面上。我

1.  整个表面
2.  每次更新都会卸载、加载或更新现有扇区
3.  当现有扇区更新时，它会发生变化

它会在更新时卸载扇区，然后创建所需的新扇区。创建后，每个扇区将启动一个生成器，每次更新会 blit X 数量的图块

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T11:59:05.353

我不这么认为，但我有一个想法。我猜你的背景水平环绕并且总是向右，然后你可以将部分开头附加到背景的结尾。

例如，如果您有一个 10,000 像素的背景并且您的视口是 1000 像素，则将前 1000 像素附加到背景的末尾，这样您将有一个 11,000 像素的背景。然后当视口到达背景的尽头时，您只需将其移动到 0px 位置并继续向右移动。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-30T00:05:33.127

谢谢大家的建议。我最终做了一些与提供的答案有点不同的事情。本质上，我制作了主表面的子表面并将它们用作缓冲区，只要视口包含世界之外的坐标，就会适当地显示它们。因为滚动是全向的，所以我需要使用 8 个缓冲区，每边一个和所有四个角。我的解决方案可能不是最优雅的，但它似乎运行良好，没有明显的性能下降。

# sql - 带计数的简单 sql 查询

> ID：13059892
> 
> 赞同：3
> 
> 时间：2012-10-25T00:26:43.263
> 
> 标签：sql, sqlite, count, nested

我正在使用 SQLite。我需要帮助来解决一个简单的问题。这是我的三个表：

```
--------------
problem
--------------
id (primary key)
question_id (foreign key)

--------------
question
--------------
id (primary key)
answer_id (foreign key)

--------------
answer
--------------
id (primary key) 
```

我想得到在每个问题中至少有 N 个答案的所有问题。我给你举个例子：

```
-------
problem
id 
1
2

-------
question 
id   problem_id
1    1
2    1
3    1
4    2

-------
answer
id   question_id
1    1
2    1
3    1
4    2
5    2
6    3
7    4
8    4 
```

如果n=2，我的结果应该是problem_id=2。

我试过这个：

```
 select distinct question.problem_id 
   from answer, question
   where answer.question_id = question.id
   group by answer.question_id
   having count(*) >= 2 
```

但它不起作用，因为它至少有一个问题至少有 2 个答案。所有的问题都必须满足这个条件。

任何问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:44:42.093

```
select problem_id
from
(
    select q.problem_id, q.id, count(a.id) answercount
    from question q
    left join answer a on a.question_id = q.id
    group by q.problem_id, q.id
) g
group by problem_id
having min(answercount) >= 2 
```

## 替代方案（例如 4 个答案）

```
select distinct q.problem_id
from question q
left join answer a on a.question_id = q.id
left join answer b on b.question_id = q.id and a.id < b.id
left join answer c on c.question_id = q.id and b.id < c.id
left join answer d on d.question_id = q.id and c.id < d.id
where d.id is not null 
```

您可以根据需要扩展此模式。如果你真的需要一个参数化的查询，你可以做一些疯狂的事情，比如加入 6 次，改变 WHERE 子句如下：

```
where case when f.id is not null then 6
           when e.id is not null then 5
           when d.id is not null then 4
           when c.id is not null then 3
           when b.id is not null then 2
           else 1 end >= {{YourParamHere}} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2012-10-25T00:46:07.207

这是我在 T-SQL 中的问题：

```
declare @problem table(id bigint not null primary key clustered)
declare @question table(id bigint not null primary key clustered, problem_id bigint)
declare @answer table(id bigint not null primary key clustered, question_id bigint)

declare @n int = 2

insert @problem
      select 1 
union select 2

insert @question
      select 1, 1 
union select 2, 1
union select 3, 1
union select 4, 2

insert @answer 
      select 1, 1 
union select 2, 1
union select 3, 1
union select 4, 2
union select 5, 2
union select 6, 3
union select 7, 4
union select 8, 4

select p.id --, p.name, p.description, p.etc
from @problem p
where @n >= ALL --http://msdn.microsoft.com/en-us/library/ms178543.aspx
(
    select COUNT(a.id) 
    from @question q
    left outer join @answer a
        on q.id = a.question_id
    where p.id = q.problem_id
    group by q.id
) 
```

注意：表架构与问题略有不同，因为问题中的架构与示例数据不匹配。

**选择**

（基于@RichardTheKiwi 的回答，内部 SQL 已移至临时表）

```
declare @tempTable table (pid bigint, qid bigint, aidCount bigint)

insert @tempTable
select q.problem_id, q.id, count(a.id) answercount
from @question q
left join @answer a on a.question_id = q.id
group by q.problem_id, q.id

select pid
from @tempTable
group by pid 
having min(aidCount) >= @n 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T22:06:29.583

重写为相关子查询。我们不是在每个问题中找到至少有 N 个答案的问题，而是找到没有少于 N 个答案的问题的问题：

```
SELECT id AS problem_id
FROM problem AS p 
WHERE NOT EXISTS
      ( SELECT 1
        FROM question AS q
          LEFT JOIN answer AS a 
            ON a.question_id = q.id
        WHERE q.problem_id = p.id
        GROUP BY q.id
        HAVING COUNT(a.question_id) < 2
      ) ; 
```

# c++ - 如何提供链接时找不到的功能？

> ID：13059893
> 
> 赞同：1
> 
> 时间：2012-10-25T00:26:48.800
> 
> 标签：c++, c, compilation, linker, static-linking

当我尝试编译我的应用程序时，出现两个错误：

> > $ g++ -static -emit-swf -o CloudClient.swf -I../boost/boost_libraries/install-dir/include -I../ffm peg-1.0/bin/include -L../boost/boost_libraries/install -dir/lib -L../ffmpeg-1.0/bin/lib timer.o audio_encoder.o audio_generator.o video_encoder.o video_generator_rainbow.o sim ple_synchronizer.o multiplexer.o transmit.o graph_runner.o cloud_client.o -lswscale - lavformat -lavcodec -lavutil -lboost_system -lboost_date_time -lboost_thread -pthread -lm

```
../ffmpeg-1.0/bin/lib/libswscale.a: error: undefined reference to 'exp'
../ffmpeg-1.0/bin/lib/libavcodec.a: error: undefined reference to 'log'
collect2: ld returned 1 exit status 
```

如果`log`并且`exp`是我的问题，如果我把`-lm`它放在任何地方都无济于事，我想知道如何从字面上创建我自己的存根`exp`并将`log`我的库与它们链接？……

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:35:47.667

您可以在 C 文件中实现它们（而不是由 C 编译器而不是 C++ 编译器编译），或者在 C++ 文件中实现它们，然后给出 extern "C" 链接。例如：

```
extern "C" double log(double x)
{
    // ...
} 
```

显然，解决链接问题对您来说会更好。您不必提供自己的标准 C 库例程版本。

# c# - MonthCalendar 没有点击事件？

> ID：13059894
> 
> 赞同：1
> 
> 时间：2012-10-25T00:26:57.880
> 
> 标签：c#, winforms, click, double-click, monthcalendar

我在 vs2008 中找不到 Click event(picture1) 。但 MSDN 有 Click 事件（图 2）。为什么？

图片1：

![在此处输入图像描述](../Images/c978c6171b4222c9474c072ac3df8662.png)

图片2： ![在此处输入图像描述](../Images/cc03090dd44f30c10d04175dfa821464.png)

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T00:33:04.013

点击事件被标记，`[BrowsableAttribute(false)]`这意味着它不会显示在属性框中。这样做的原因是因为它并非旨在直接从您的代码中调用。从`MonthCalendar.Click's` [MSDN 页面](http://msdn.microsoft.com/en-us/library/system.windows.forms.monthcalendar.click.aspx)：

> 此 API 支持 .NET Framework 基础结构，不打算直接从您的代码中使用。

有更多关于`BrowsableAttribute` [这里](http://msdn.microsoft.com/en-us/library/system.componentmodel.browsableattribute.aspx)的信息。

# c++ - int &f = d 是什么意思

> ID：13059895
> 
> 赞同：0
> 
> 时间：2012-10-25T00:27:36.120
> 
> 标签：c++

> **可能重复：**
> [C++ 中的引用](https://stackoverflow.com/questions/3502687/references-in-c)
> [int & 是什么意思](https://stackoverflow.com/questions/4629317/what-does-int-mean)

我很难理解`int &f = d`以下代码中的语句。如果有人能解决这个问题，我将不胜感激

```
int main()
{ 
   int d = 13 ;
   int &f = d ;
   std::cout << f;
} 
```

编辑：我熟悉引用的概念对不起我没有提供足够的背景。我知道如果我做这样的事情

```
int a = 12
std::cout << &a //this gives the address of a and not the content of the address which is 12 
```

现在我 `int &f = d` 的问题对我来说是 f 似乎需要一个地址，而 d 给它一个值而不是地址。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:31:01.207

我可以写，写，但更好的答案在这里：[http://en.wikipedia.org/wiki/Reference_(C++)](http://en.wikipedia.org/wiki/Reference_%28C++%29)

通常，在 C++ 中，它类似于指针。`f`用作指什么`d`是的东西。

# excel - 将多个 MS Access 2010 查询从一个“表单加载”或“表单打开”导出到 MS Excel 2010 时遇到问题

> ID：13059900
> 
> 赞同：0
> 
> 时间：2012-10-25T00:28:18.880
> 
> 标签：excel, vba, export

我尝试了几种不同的方法，但在第一种方法之后它一直停止。我尝试添加其他表单，表单 1 在打开时运行一个，然后表单 1 打开运行一个导出等的表单 2，但这不起作用。我尝试暂停`do while not isloaded(next form)`等，但没有奏效。

```
Option Compare Database
Private Sub Form_Load()
On Error GoTo Err_Form_Load

'I tried 9
DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _
"AllActiveABC", _
"Y:\Projects\Protocol Folders\AllActiveABC.xls", True
DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _
"All-ActiveABC", _
"Y:\Projects\Protocol Folders\AllFilteredABC.xls", True
DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _
"All-ActiveABC", _
"Y:\Projects\Protocol Folders\AllFilteredABC.xls", True

'I tried 12 and 12XML
DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _
"AllActiveABC", _
"Y:\Projects\Protocol Folders\AllActiveABC.xls", True
DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _
"AllFilteredABC", _
"Y:\Projects\Protocol Folders\AllFilteredABC.xls", True
DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12xlm, _
"AllActiveABC", _
"Y:\Projects\Protocol Folders\AllActiveABC.xls", True

'I tried it as a function
'see function below the three exports

Call exportData("All-FilteredABC", _
"Y:\Projects\Folders\All-FilteredABC.xlsx")
Call exportData("AllActiveABC", _
"Y:\Projects\Folders\AllActiveABC.xlsx")
Call exportData("AllABC", _
"Y:\Projects\Folders\AllABC.xlsx")

Function exportData(queryName As String, strSaveFileName As String)

DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, queryName, strSaveFileName, True 

End Function 
```

没运气。我对我尝试过的所有事情以及我喜欢的不同结果感到非常困惑，在现有工作簿中创建了一个新的空白表，但最后有一个 _1，在一次导出后停止，将它们全部导出，但全部为空白.

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-11-17T03:23:23.127

尝试在每个 DoCmd 之后输入命令 DoEvents。让一切都赶上

IE

DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel9, _ "AllActiveABC", _ "Y:\Projects\Protocol Folders\AllActiveABC.xls", True

做事件

# asp.net-mvc - 将 POCO 或 EF 对象传递给 Web 项目？

> ID：13059901
> 
> 赞同：0
> 
> 时间：2012-10-25T00:28:27.097
> 
> 标签：asp.net-mvc, asp.net-mvc-3, entity-framework, poco, data-access-layer

假设我有一个包含两个项目的 Visual Studio 解决方案：一个 Web 项目和一个数据项目。

是否将 EF 对象从数据项目传递到 Web 项目，或者我需要在数据项目中显式定义 POCO 以传递到 Web 项目，这真的很重要吗？

在我看来，需要创建 POCO 而不是简单地使用 EF 对象增加了另一件需要完成的事情......而且我没有特别看到目的。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T09:57:18.913

如果您使用的是 Entity Framework 4，则 EF 对象是 POCO 对象，因此应该在您的模型与 EF 对象匹配的任何情况下使用（CRUD 操作是典型的操作）。但是，很可能会出现标准 POCO 对象没有封装视图模型所需的所有字段的情况（我使用的典型字段是您有两个密码字段的帐户页面），因此您需要为页面创建一个模型，然后将数据传递到您的 EF POCO 对象中。

因此，如果您使用 DbContext（为您创建 POCO 对象），则没有理由不使用这些对象。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T05:22:58.480

将 EF 对象直接传递给 Web 项目不是一个好习惯。由于 EF 对象中发生的状态变化可以直接反映在数据库上。因此，您应该为 Web 项目显式定义 POC 对象。（我们可以将其称为`Data Model`或简称为`Model`。用于从 中检索数据的 POC 对象`View`可以称为`View Model`。在适当的情况下，您也可以使用相同的 POCO`Data Model`类一`View Model`）

# java - 边界匹配器正则表达式

> ID：13059902
> 
> 赞同：-1
> 
> 时间：2012-10-25T00:28:28.583
> 
> 标签：java, regex

为什么这在 Java 中是错误的？

```
Pattern.matches("\\A[/0-9]","2 z CEA|B2 z E^") 
```

编辑：我试过了：（这样我也可以赶上新台词）

```
Pattern.matches("\\A[/0-9][.\\s]*?","2 z\n CEA|B2 z E^) 
```

但它不起作用。我怎么能抓住这样的东西？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:31:55.833

因为在 Java 中，该`matches`方法会尝试匹配整个字符串。你需要`find`：

```
Pattern.compile("\\A[/0-9]").matcher("2 z CEA|B2 z E^").find() 
```

（请参阅[的 Javadoc`Pattern.matches()`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Pattern.html#matches%28java.lang.String,%20java.lang.CharSequence%29)、[的 Javadoc`Matcher.matches()`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#matches%28%29)和[的 Javadoc`Matcher.find()`](http://docs.oracle.com/javase/7/docs/api/java/util/regex/Matcher.html#find%28%29)。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:33:42.437

它只匹配第一个数字 2 而不是整个字符串，所以它是错误的

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:36:20.593

问题是`.matches()`与整个字符串进行比较，因此模式必须匹配它。尝试这个：

```
Pattern.matches("\\A[/0-9].*?","2 z CEA|B2 z E^") 
```

允许更多的`.*?`东西在行尾。使用`*?`量词使其选择最少数量的字符。

# php - 当会话时间戳为 90 分钟时发送电子邮件

> ID：13059904
> 
> 赞同：0
> 
> 时间：2012-10-25T00:28:48.350
> 
> 标签：php, mysql, email, triggers

我有一个 mysql 数据库，其中填充了下面称为 my_active_users 的会话信息

```
username    timestamp      email
MyName      1351121630     xxx@xxx.com 
```

当会话时间戳超过 90 分钟时，如何发送触发器以向用户发送电子邮件？

我已经将 mail.php 设置为发送包含正确内容的电子邮件，只是不确定如何链接或触发将邮件发送给 90 分钟未处于活动状态的用户。

任何帮助将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:35:51.360

同意@nickb，

写一个脚本（这里是伪代码）：

```
SELECT user, firstname, lastname, email
from sometable 
where timestamp > (current_time - 90mins) 
```

*`mail.php`*然后使用您的脚本进行个性化和发送。

关于 crontab，我不知道您对它了解多少，但是，您可以通过 PHP 或 wget（或 lynx 等）之类的服务执行它：

**PHP：**

```
*/10 * * * * /usr/bin/php /path/to/script/script.php 
```

**或通过 URL 请求：**

```
*/10 * * * * /usr/bin/wget -q -O http://www.domain.com/script.php > /dev/null 
```

以上两个请求每 10 分钟一次，但您可以更改以满足您的要求。

希望这可以帮助。

# perl - 将 perl 中系统调用的输出保存到文本文件

> ID：13059906
> 
> 赞同：1
> 
> 时间：2012-10-25T00:29:05.150
> 
> 标签：perl, date, foreach, text-files

我试图让这个脚本把输出文件放在结果/中，但我只把它们放在结果/假脱机中。我怎样才能让它们最终出现在正确的位置？

```
 #!/usr/bin/perl -w

use POSIX;
my $date = strftime "%Y%m%d_%H%M.txt", localtime;

my @files = <spool/*.*>;
foreach $file (@files) {
    my $date_file = $file;
    system("$^X  wfreq.pl $file >> results/${date_file}_$date");
    unlink("$file");
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:31:23.583

你测试过这个吗？

```
#!/usr/bin/perl -w

use POSIX;
my $date = strftime "%Y%m%d_%H%M.txt", localtime;

my @files = <spool/*.*>;
foreach $file (@files) {
    (my $date_file = $file) =~ s!.*/!!;
    system("$^X  wfreq.pl $file >> results/${date_file}_$date");
    unlink("$file");
} 
```

函数`system()`, `qx()`&`exec()`可以毫无问题地处理变量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:38:50.017

这是你要找的吗？

这将为您提供每个日期的单独文件

```
@files = <spool/*.*>;
foreach $file (@files) {
    system($^X, "wfreq.pl", $file);
    $DATE = strftime "%Y%m%d";
    open OUTPUT, '>results/$DATE.txt' or die;
    print OUTPUT $DATE;
} 
```

或者对于结果全部在一个文本文件中的文件

```
@files = <spool/*.*>;
open OUTPUT, '>>results/results.txt' or die;
foreach $file (@files) {
    system($^X, "wfreq.pl", $file);
    $DATE = strftime "%Y%m%d";
    print OUTPUT $DATE;
} 
```

# scala - 使用 Scallop 的 Scala 命令行解析器

> ID：13059909
> 
> 赞同：8
> 
> 时间：2012-10-25T00:29:20.527
> 
> 标签：scala

我对 Scala 还很陌生，需要构建一个非常简单的命令行解析器，它提供了类似于我在几分钟内使用 JRuby 创建的以下内容：-

```
java -jar demo.jar --help

Command Line Example Application

Example: java -jar demo.jar --dn "CN=Test" --nde-url "http://www.example.com" --password "password"

For usage see below:

    -n http://www.example.com
    -p, --password             set the password
    -c, --capi                 set add to Windows key-store
    -h, --help                 Show this message
    -v, --version              Print version 
```

[扇贝](https://github.com/Rogach/scallop)看起来可以解决问题，但我似乎找不到一个有效的简单示例！我发现的所有示例似乎都是零散的，并且由于某种原因不起作用。

**更新**

我发现这个例子有效，但我不确定如何将它绑定到 main 方法中的实际参数中。

```
import org.rogach.scallop._; 

object cmdlinetest {
  def main(args: Array[String]) 

    val opts = Scallop(List("-d","--num-limbs","1"))
      .version("test 1.2.3 (c) 2012 Mr Placeholder")
      .banner("""Usage: test [OPTION]... [pet-name]
                |test is an awesome program, which does something funny
                |Options:
                |""".stripMargin)
      .footer("\nFor all other tricks, consult the documentation!")
      .opt[Boolean]("donkey", descr = "use donkey mode")
      .opt("monkeys", default = Some(2), short = 'm')
      .opt[Int]("num-limbs", 'k',
      "number of libms", required = true)
      .opt[List[Double]]("params")
      .opt[String]("debug", hidden = true)
      .props[String]('D',"some key-value pairs")
      // you can add parameters a bit later
      .args(List("-Dalpha=1","-D","betta=2","gamma=3", "Pigeon"))
      .trailArg[String]("pet name")
      .verify

    println(opts.help)
  }
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2012-10-25T15:18:40.370

好吧，我会尝试添加更多示例:)

在这种情况下，使用 ScallopConf 会更好：

```
import org.rogach.scallop._

object Main extends App {
  val opts = new ScallopConf(args) {
    banner("""
NDE/SCEP Certificate enrollment prototype

Example: java -jar demo.jar --dn CN=Test --nde-url http://www.example.com --password password

For usage see below:
    """)

    val ndeUrl = opt[String]("nde-url")
    val password = opt[String]("password", descr = "set the password")
    val capi = toggle("capi", prefix = "no-", descrYes = "enable adding to Windows key-store", descrNo = "disable adding to Windows key-store")
    val version = opt[Boolean]("version", noshort = true, descr = "Print version")
    val help = opt[Boolean]("help", noshort = true, descr = "Show this message")

  }

  println(opts.password())
} 
```

它打印：

```
$ java -jar demo.jar --help

NDE/SCEP Certificate enrollment prototype

Example: java -jar demo.jar --dn CN=Test --nde-url http://www.example.com --password password

For usage see below:

  -c, --capi              enable adding to Windows key-store 
      --no-capi           disable adding to Windows key-store 
      --help              Show this message 
  -n, --nde-url  <arg>     
  -p, --password  <arg>   set the password 
      --version           Print version 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T02:18:06.467

你读过[文档](http://rogach.github.com/scallop/#org.rogach.scallop.Scallop)吗？看起来您所要做的就是调用`get`您想要的每个选项：

```
def get [A] (name: String)(implicit m: Manifest[A]): Option[A] 
```

看起来您可能需要在方法调用中提供预期的返回类型。尝试这样的事情：

```
val donkey = opts.get[Boolean]("donkey")
val numLimbs = opts.get[Int]("num-limbs") 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T05:01:23.680

如果您只是在寻找一种快速而肮脏的方式来解析命令行参数，您可以使用[pirate](https://github.com/mosesn/pirate)，这是一种非常简单的方式来解析参数。这是处理您上面描述的用法的样子：

```
import com.mosesn.pirate.Pirate

object Main {
  def main(commandLineArgs: Array[String]) {
    val args = Pirate("[ -n string ] [ -p string ] [ -chv ]")("-n whatever -c".split(" "))
    val c = args.flags.contains('c')
    val v = args.flags.contains('v')
    val h = args.flags.contains('h')
    val n = args.strings.get("n")
    val p = args.strings.get("p")

    println(Seq(c, v, h, n, p))
  }
} 
```

当然，对于您的程序，您将通过`commandLineArgs`而不是`"-n whatever -c"`.

不幸的是，pirate 还不支持 GNU 样式参数，也不支持版本或帮助文本选项。

# javascript - 使用 ruby 重构 javascript 代码

> ID：13059911
> 
> 赞同：0
> 
> 时间：2012-10-25T00:29:34.787
> 
> 标签：javascript, ruby, google-closure-compiler

假设我有一些这样的 javascript 代码：

```
function Person(){}
var pro=Person.prototype;
pro["setName"]=function(){}
pro["setAge"]=function(){}

.... 
```

现在，我将使用闭包编译器来缩小源代码。

但是，由于 Closure Compiler 编译永远不会更改字符串文字，所以我想自己替换。

所以在编译代码之前，我想像这样替换字符串文字：

```
var a="setName",b="setAge";
function Person(){}
var pro=Person.prototype;
pro[a]=function(){}
pro[b]=function(){} 
```

我想用 ruby​​ 来做这个工作，那么我有两个问题：

*   1）如何更换？

我尝试逐行扫描文件，但是如何找到字符串文字并进行替换？

*   2）代码冲突

由于我必须生成像'a，b'这样的变量，如何确保它们与我的源代码不冲突？例如，我生成这样的代码：

```
var something="setName"; 
```

那么我的源代码中是否定义了一个名为“某物”的变量或函数呢？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T01:02:38.913

我不认为你的整体想法是正确的，我特别认为做 1) 太复杂了，无法在一个网页中回答。对于 2)，从 Javascript 代码之外执行此操作同样困难，但您可以将原始 Javascript 代码与几行连接，引用[Here](https://stackoverflow.com/questions/2051678/getting-all-variables-in-scope)，运行 Javascript，并获取变量列表。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T15:40:04.500

如果由于某种原因您担心原始 JS 大小而不是压缩 JS（大多数人应该只担心压缩大小）。也许您应该考虑启用“别名所有字符串”编译器选项（在 Closure Compiler 的 Java API 中可用）？

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T00:41:52.887

而不是这样做，您应该考虑`gzip`在关闭缩小文件后使用来压缩文件。

`gzip`通过在输入数据中查找重复的字符串并将第二次出现的字符串替换为指向前一个字符串的指针来工作。它将对您的所有输入数据执行此操作，而不仅仅是 javascript 字符串文字。

[http://www.gzip.org/](http://www.gzip.org/)

# python - 以任意顺序匹配所有正则表达式条件

> ID：13059917
> 
> 赞同：0
> 
> 时间：2012-10-25T00:30:30.283
> 
> 标签：python, regex

我有一个想要使用正则表达式抓取的网页。该页面最多可能包含 3 个我关心的文本块。

如果所有三个文本块都存在，那么它应该返回一个匹配，否则返回不匹配。文本可以在页面上以任何顺序排列。

我试过这个，但它不满足“任何订单”的要求：

```
re_text = (Text block 1)((.|\n)*)(Text block 2)((.|\n)*)(Text block 3)
re_compiled = re.compile(re_text) 
```

我应该在这里使用反向引用吗？还是有其他解决方案？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:33:37.460

单独寻找它们怎么样？

```
re_texts = [re.compile('textblock1'), re.compile('textblock2'), re.compile('textblock3')]

if all(r.search(text) for r in re_texts):
    # all matches found 
```

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2012-10-25T00:41:18.113

```
>>> ('a' and 'b' and 'c') in 'xyz'
False
>>> ('a' and 'b' and 'c') in 'ayz'
True
>>> ('a' and 'b' and 'c') in 'abc'
True 
```

# three.js - 如何添加简单的 2D 平面文本？

> ID：13059923
> 
> 赞同：0
> 
> 时间：2012-10-25T00:31:08.200
> 
> 标签：three.js

有人可以告诉我如何在 three.js 中将简单的 2D 文本添加到场景中吗？我不需要花哨的文本几何。

文本的目的是标注一个 3D 可旋转版本：http: [//img225.imageshack.us/img225/9823/capturespm.png](http://img225.imageshack.us/img225/9823/capturespm.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T00:50:13.727

您可以使用 2D 上下文生成文本，然后将其转换为纹理，最后在 3D 空间中将其显示为粒子/广告牌。

# javascript - 如何查找不在数据属性中的所有元素

> ID：13059927
> 
> 赞同：1
> 
> 时间：2012-10-25T00:31:40.057
> 
> 标签：javascript, jquery, underscore.js

使用 jQuery / Underscore，给出以下列表。如何找到`.msg`不在 li w 内的所有元素`data-allow-html="true"`

```
<ol>
    <li><div class="msg">message</div></li>
    <li data-allow-html="true"><div class="msg">message</div></li>
    <li><div class="msg">message</div></li>
    <li data-allow-html="true"><div class="msg">message</div></li>
    <li><div class="msg">message</div></li>
    <li data-allow-html="true"><div class="msg">message</div></li>
    <li><div class="msg">message</div></li>
    <li data-allow-html="true"><div class="msg">message</div></li>
</ol> 
```

我目前有：

```
$('#mydiv').find('.msg').each(function() {} 
```

并尝试过：

```
$('#mydiv').find('li').not('data-allow-html="true"').find('.msg').each(function() {} 
```

这似乎不起作用。想法？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:35:22.593

您可以使用以下内容获取所有`<li>`withing `#mydiv`，然后检查`not()`包含属性，然后找到每个`.msg`

```
$('#mydiv li').not('[data-allow-html="true"]').find('.msg').each(function() {
    // your code
});​ 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:36:31.267

在您的**代码中，这** `not('data-allow-html="true"')`
应该是`not('[data-allow-html="true"]')` .. // Missing **[]**

你也可以这样试试

```
 $('li').not('[data-allow-html]').find('.msg').each(function() {

       $(this).css('color', 'orange')
        // Your code here
 }); 
```

//或者

```
$('li:not([data-allow-html])').find('.msg').each(function() {

}); 
```

**[检查小提琴](http://jsfiddle.net/sushanth009/wgXAB/)**

# python - 你可以从python打印文件吗？

> ID：13059930
> 
> 赞同：3
> 
> 时间：2012-10-25T00:31:55.797
> 
> 标签：python

有没有办法将输出发送到打印机而不是 Python 中的屏幕？或者是否有可以从 python 中调用的服务例程来打印文件？也许有一个我可以导入的模块允许我这样做？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2012-10-25T01:02:44.057

大多数平台（包括 Windows）都有表示打印机的特殊文件对象，您只需将文本写入文件即可打印文本。

在 Windows 上，特殊文件对象具有 、 、 等名称`LPT1:`。`LPT2:`您`COM1:`需要知道您的打印机连接到哪一台（或以某种方式询问用户）。

您的打印机可能没有连接到任何此类特殊文件，在这种情况下，您需要启动控制面板并正确配置它。（对于远程打印机，这甚至可能需要设置“虚拟端口”。）

无论如何，写入`LPT1:`或`COM1:`与写入任何其他文件完全相同。例如：

```
with open('LPT1:', 'w') as lpt:
    lpt.write(mytext) 
```

或者：

```
lpt = open('LPT1:', 'w')
print >>lpt, mytext
print >>lpt, moretext
close(lpt) 
```

等等。

如果您已经在文件中打印了要打印的文本，则可以这样打印：

```
with open(path, 'r') as f, open('LPT1:', 'w') as lpt:
    while True:
        buf = f.read()
        if not buf: break
        lpt.write(buf) 
```

或者，更简单（未经测试，因为我这里没有 Windows 框），这应该可以工作：

```
import shutil
with open(path, 'r') as f, open('LPT1:', 'w') as lpt:
    shutil.copyfileobj(f, lpt) 
```

有可能`shutil.copyfile(path, 'LPT1:')`只是`copyfileobj`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:54:57.753

Python 不会（除非您使用图形库）将内容发送到“屏幕”。它写入 stdout 和 stderr，就 Python 而言，它们只是看起来像文件的东西。

让 python 将这些流指向其他任何看起来像文件的东西很简单；例如，请参阅[将标准输出重定向到 Python 中的文件？](https://stackoverflow.com/questions/4675728/redirect-stdout-to-a-file-in-python)

在 unix 系统上，有一些类似文件的设备恰好是打印机 (/dev/lp*)；在 Windows 上，LPT1 具有类似的目的。

无论操作系统如何，您都必须确保 LPT1 或 /dev/lp* 实际上以某种方式连接到打印机。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2012-10-25T03:57:50.000

如果您使用的是 linux，如果您已设置打印机并将其设置为默认设置，则以下操作有效。

```
from subprocess import Popen
from cStringIO import StringIO

# place the output in a file like object
sio = StringIO(output_string)

# call the system's lpr command
p = Popen(["lpr"], stdin=sio, shell=True)
output = p.communicate()[0] 
```

# twitter - 如何将 Twitter Bootstrap 按钮添加到 Joomla 扩展？

> ID：13059936
> 
> 赞同：2
> 
> 时间：2012-10-25T00:32:36.650
> 
> 标签：twitter, joomla, twitter-bootstrap

我在我的网站上安装了 Twitters Bootstrap，我想将按钮样式链接到扩展样式表，以便我网站上的所有按钮都是统一的，但我不知道该怎么做。我的日常工作显然不是 Web 开发，所以我很喜欢我应该使用什么代码。

**我想使用的 Twitter Bootstrap 按钮：**

 **```
<p>
<button class="btn btn-default btn-info" type="button">Subscribe</button>
</p> 
```** 

**Acymail Joomla 扩展**

```
background: -ms-linear-gradient(top, ellipse cover, #F5F5F5 0%, #F5F5F5 100%); /* IE10+    */
background: radial-gradient(top, ellipse cover,#F5F5F5 0%, #F5F5F5 100%);
filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#F5F5F5',       endColorstr='#F5F5F5',GradientType=0 ) !important; /* IE6-9 vertical */
}
/**************links*****************/

.acymailing_module form a:hover, .acymailing_module form a:active, .acymailing_module     form a:focus{
color:#5a99ab!important;
text-decoration:underline !important;
background-color:transparent !important;} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T01:04:29.593

如果页面上正在加载**bootstrap.css**`class="btn btn-default"` ，那么您可以添加到扩展中的元素。所以基本上，你可以去：

```
components/com_extension_name/views/view_name/tmp/default.php 
```

并将类添加到任何`<a>`标签。

或者，您可以复制特定样式按钮的样式，例如**bootstrap.css**中的默认样式，并将其添加到：

```
.acymailing_module form a {
    //bootstrap button style goes in here
} 
```

# android - 如何使 onPostExecute() 或 Json 解析工作？

> ID：13059937
> 
> 赞同：0
> 
> 时间：2012-10-25T00:32:41.593
> 
> 标签：android, json, android-emulator

我是 Android 的初学者，我正在编写一个简短的程序来从 URL 下载 JSON 提要并解析它。我使用 AsyncTask 进行下载。

doInBackground() 部分似乎运行良好。然后我将断点设置为 onPostExecute()，它甚至可以停在`parseJSON(result)`，并且“结果”显示下载的正确 json 字符串。但是当我尝试进入时`parseJSON(result)`，它不会正确地进入函数（或者直接抛出 JSONException 或者进入一些随机行`parseJSON(result)`）。

从 DDMS 日志中，它也没有显示任何有价值的信息。

我怎样才能找到问题所在？是我用`onPostExecute()`错了，还是`parseJSON()`有问题？

```
public class MainActivity extends Activity {

    private listItem[] items;

    public class listItem {
        String title;
        String description;
        String imageHref;
    }

    @Override
    public void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        items = new listItem[50];

        new DownloadJsonFeed().execute("http://dl.dropbox.com/u/10168342/facts.json");
    }

    private class DownloadJsonFeed extends AsyncTask<String, Void, String> {
        @Override
        protected String doInBackground(String... params) {

            try {
                return downloadUrl(params[0]);
            } catch (IOException e) {
                return "Unable to retrieve json feed. URL may be invalid.";
            }
        }

        @Override
        protected void onPostExecute(String result) {
            try {
                parseJSON(result);          // Here !!!!!!
            } catch (JSONException e) {
            }
        }
    }

    private String downloadUrl(String myurl) throws IOException {
        InputStream is = null;

        try {
            URL url = new URL(myurl);
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();
            conn.setReadTimeout(10000 /* milliseconds */);
            conn.setConnectTimeout(15000 /* milliseconds */);
            conn.setRequestMethod("GET");
            conn.setDoInput(true);
            conn.connect();
            is = conn.getInputStream();

            // Convert the InputStream into a string
            BufferedReader reader = new BufferedReader(new InputStreamReader(is));
            StringBuilder sb = new StringBuilder();
            String line = null;

            while ((line = reader.readLine()) != null) {
                sb.append(line);
            }
            is.close();
            return sb.toString();
        } finally {
            if (is != null) {
                is.close();
            } 
        }
    }

    private void parseJSON(String feed) throws JSONException {
            JSONObject json_obj = new JSONObject(feed);
            title = json_obj.getString("title");
            String rows = json_obj.getString("rows");

            JSONArray jArray = new JSONArray(rows);
            for (int i = 0; i < jArray.length(); i++) {
                JSONObject tmp = jArray.getJSONObject(i);
                items[i].title = tmp.getString("title");
                items[i].description = tmp.getString("description");
                items[i].imageHref = tmp.getString("imageHref");
            }
    } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2012-10-25T02:36:30.517

`JSONObject.getString()`将尝试获取 String 类型的值，但您想要的是数组类型。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T01:04:36.710

我认为你没有得到正确的 JSON 数组。这`json_obj.getString`会给你一个字符串而不是一个数组。

尝试如下更改：

```
 private void parseJSON(String feed) throws JSONException {
            JSONObject json_obj = new JSONObject(feed);
            title = json_obj.getString("title");
            String rows = json_obj.getString("rows");

            JSONArray jArray = json_obj.getJSONArray("rows"); //<---- change this line
            for (int i = 0; i < jArray.length(); i++) {
                JSONObject tmp = jArray.getJSONObject(i);
                items[i].title = tmp.getString("title");
                items[i].description = tmp.getString("description");
                items[i].imageHref = tmp.getString("imageHref");
            }
    } 
```

# asp.net - 使用 javascript 为帐户注册创建目标渠道

> ID：13059950
> 
> 赞同：1
> 
> 时间：2012-10-25T00:34:32.967
> 
> 标签：asp.net

我有一个网站，其中有 4 个帐户注册步骤。我正在尝试使用 javascript 实现一个谷歌分析漏斗，以了解有多少人完成了注册过程的每个步骤。我使用 asp.net 向导控件进行帐户注册。每个步骤都引用同一个页面 (signup/default.aspx) 以及下一个和上一个按钮。

```
protected void wzsignup_ActiveStepChanged(object sender, EventArgs e)
{

 string step = wzsignup.ActiveStep.ID.ToString(CultureInfo.InvariantCulture); //example of step name is personaldetails..

     string script = "var _gaq=_gaq || [];_gaq.push(['_setAccount','UA-XXXXX-1' ]);_gaq.push(['_setDomainName', 'none']);_gaq.push(['_trackPageview'],'/{0}');(function(){{var ga=document.createElement('script');ga.type='text/javascript';ga.async=true;ga.src=('https:'==document.location.protocol?'https://ssl':'http://www')+'.google-analytics.com/ga.js';var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(ga,s);}})();";
     script = string.Format(script, step);
     HtmlGenericControl scriptTag = new HtmlGenericControl("script");
     scriptTag.Attributes.Add("type", "text/javascript");
     scriptTag.InnerHtml = script;
     this.Page.Header.Controls.Add(scriptTag);
} 
```

如何获取注册步骤报告？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T05:53:57.170

谷歌在这方面的文档非常好。您需要做两件事情。第一种是通过为转化漏斗的每个步骤指定一个虚拟网址来设置页面浏览跟踪。这是该文档的链接：

[http://support.google.com/analytics/bin/answer.py?hl=en&answer=1116091#identical](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1116091#identical)

第二部分是在谷歌分析中设置目标，您可以在其中创建目标并指定渠道的步骤：

[http://support.google.com/analytics/bin/answer.py?hl=en&answer=1116091#funnels](http://support.google.com/analytics/bin/answer.py?hl=en&answer=1116091#funnels)

我强烈建议您阅读有关此的 google 文档......他们很好地概述了这些步骤。

# c++ - 寻找满足特定性质的六位数字的优化算法

> ID：13059952
> 
> 赞同：1
> 
> 时间：2012-10-25T00:34:43.250
> 
> 标签：c++, algorithm

问题：“一种找出六位数字的数量的算法，其中前三位数字的总和等于后三位数字的总和。”

我在一次采访中遇到了这个问题，想知道最好的解决方案。这是我到现在为止的。

方法 1：蛮力解决方案当然是检查每个数字（100,000 到 999,999 之间）的前三位数字和后三位数字的总和是否相等。如果是，则增加某个计数器，该计数器保持对所有此类数字的计数。

但这会检查所有 900,000 个数字，因此效率低下。

方法2：既然我们被问到“有多少”这样的数字而不是“哪些数字”，我们可以做得更好。将数字分为两部分：前三位（从 100 到 999）和后三位（从 000 到 999）。因此，候选数字的任一部分的三位数字之和的范围可以从 1 到 27。
* 为每个部分维护一个`std::map<int, int>`，其中 key 是总和，value 是在相应部分中具有该总和的数字的数量（3 位）。
* 现在，对于第一部分中的每个数字，找出其总和并更新相应的地图。
* 同样，我们可以获得第二部分的更新地图。* 现在通过将相应的对相乘（例如，键 4 的映射 1 中的值和键 4 的映射 2 中的值）并将它们相加，我们得到了答案。

在这种方法中，我们最终会检查 1K 个数字。

我的问题是我们如何进一步优化？有更好的解决方案吗？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2012-10-25T00:54:35.033

对于`0 <= s <= 18`，有确切的`10 - |s - 9|`方法来获得`s`两位数的总和。

所以，对于第一部分

```
int first[28] = {0};
for(int s = 0; s <= 18; ++s) {
    int c = 10 - (s < 9 ? (9 - s) : (s - 9));
    for(int d = 1; d <= 9; ++d) {
        first[s+d] += c;
    }
} 
```

那是 19*9 = 171 次迭代，对于后半部分，类似地执行，内部循环从 0 而不是 1 开始，即 19*10 = 190 次迭代。然后求和`first[i]*second[i]`。`1 <= i <= 27`

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T00:38:10.517

生成所有三位数字；根据它们的数字总和将它们划分为集合。（实际上，您需要做的就是保留一个计算集合大小的向量）。对于每个集合，可以生成的六位数字的数量是集合平方的大小。将设置大小的平方相加得到你的答案。

```
int sumCounts[28]; // sums can go from 0 through 27
for (int i = 0; i < 1000; ++i) {
    sumCounts[sumOfDigits(i)]++;
}
int total = 0;
for (int i = 0; i < 28; ++i) {
    count = sumCounts[i];
    total += count * count;
} 
```

**编辑**变体以消除计数前导零：

```
int sumCounts[28];
int sumCounts2[28];
for (int i = 0; i < 100; ++i) {
    int s = sumOfDigits(i);
    sumCounts[s]++;
    sumCounts2[s]++;
}
for (int i = 100; i < 1000; ++i) {
    sumCounts[sumOfDigits(i)]++;
}
int total = 0;
for (int i = 0; i < 28; ++i) {
    count = sumCounts[i];
    total += (count - sumCounts2[i]) * count;
} 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-12-17T03:48:52.910

**Python 实现**

```
def equal_digit_sums():
dists = {}
for i in range(1000):
    digits = [int(d) for d in str(i)]
    dsum = sum(digits)
    if dsum not in dists:
        dists[dsum] = [0,0]
    dists[dsum][0 if len(digits) == 3 else 1] += 1
def prod(dsum):
    t = dists[dsum]
    return (t[0]+t[1])*t[0]
return sum(prod(dsum) for dsum in dists)

print(equal_digit_sums()) 
```

**结果：50412**

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-10-25T00:37:28.783

一个想法：对于从 0 到 27 的每个数字，计算具有该数字和的三位数字的数量。这应该可以通过 DP 风格的方法有效地实现。

现在您只需将结果的平方相加，因为对于每个答案，您可以用每边一个数字组成一个六位数。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2012-10-25T00:53:22.717

假设不允许使用前导 0，您需要计算有多少种不同的方法可以用 3 位数求和到 n。要计算，您可以在 for 循环内有一个 for 循环。所以：

```
firstHalf = 0
for i in xrange(max(1,n/3),min(9,n+1)): #first digit
  for j in xrange((n-i)/2,min(9,n-i+1)): #second digit
    firstHalf +=1  #Will only be one possible third digit
secondHalf = firstHalf + max(0,10-|n-9|) 
```

如果您试图对一个数字求和，那么最后一个数字始终是唯一确定的。因此，在第一个数字为 0 的情况下，我们只是在计算第二个数字可能有多少不同的值。如果 n 小于 10，这将是 n+1。如果 n 大于，直到 18 它将是 19-n。超过 18 岁没有办法形成总和。如果你遍历所有 n，从 1 到 27，你将得到你的总和。

# mapreduce - 如何进行更快的 Riak MapReduce 查询？

> ID：13059953
> 
> 赞同：4
> 
> 时间：2012-10-25T00:34:51.313
> 
> 标签：mapreduce, riak, riak-search

**我们怎样才能使我们的 MapReduce 查询更快？**

我们使用五节点 Riak 数据库集群构建了一个应用程序。我们的数据模型由三个桶组成：比赛、联赛和球队。

Matches 包含联赛和球队的链接：

**模型**

```
var match = {
        id: matchId,
        leagueId: meta.leagueId,
        homeTeamId: meta.homeTeamId,
        awayTeamId: meta.awayTeamId,
        startTime: m.match.startTime,
        firstHalfStartTime: m.match.firstHalfStartTime,
        secondHalfStartTime: m.match.secondHalfStartTime,
        score: {
            goals: {
                a: 1*safeGet(m.match, 'score.goals.a'),
                b: 1*safeGet(m.match, 'score.goals.b')
            },
            corners: {
                a: 1*safeGet(m.match, 'score.corners.a'),
                b: 1*safeGet(m.match, 'score.corners.b')
            }
        }
    };

var options = {
        index: {
            leagueId: match.leagueId,
            teamId: [match.homeTeamId, match.awayTeamId],
            startTime: match.startTime || match.firstHalfStartTime || match.secondHalfStartTime
        },
        links: [
            { bucket: 'leagues', key: match.leagueId, tag: 'league' },
            { bucket: 'teams', key: match.homeTeamId, tag: 'home' },
            { bucket: 'teams', key: match.awayTeamId, tag: 'away' }
        ]
    };
    match.model = 'match';
    modelCache.save('matches', match.id, match, options, callback); 
```

**查询**

我们编写一个从多个存储桶返回结果的查询，一种方法是分别查询每个存储桶。另一种方法是使用链接来组合来自单个查询的结果。

无论我们的存储桶大小有多小，我们尝试过的两个版本的查询都需要一秒钟的时间。第一个版本使用两个映射阶段，我们在这篇文章（[Practical Map-Reduce: Forwarding and Collecting](http://basho.com/blog/technical/2010/04/14/practical-map-reduce:-forwarding-and-collecting/)）之后建模。

```
#!/bin/bash
curl -X POST \
-H "content-type: application/json" \
-d @- \
http://localhost:8091/mapred \
<<EOF
{
    "inputs":{
        "bucket":"matches",
        "index":"startTime_bin",
        "start":"2012-10-22T23:00:00",
        "end":"2012-10-24T23:35:00"
    },
    "query": [
        {"map":{"language": "javascript", "source":"
                function(value, keydata, arg){
                    var match = Riak.mapValuesJson(value)[0];
                    var links = value.values[0].metadata.Links;
                    var result = links.map(function(l) {
                        return [l[0], l[1], match];
                    });
                    return result;
                }
            "}
        },
        {"map":{"language": "javascript", "source": "
                function(value, keydata, arg) {
                    var doc = Riak.mapValuesJson(value)[0];
                    return [doc, keydata];
                }
            "}
        },
        {"reduce":{
            "language": "javascript",
                "source":"
                    function(values) {
                        var merged = {};
                        values.forEach(function(v) {
                            if(!merged[v.id]) {
                                merged[v.id] = v;
                            }
                        });
                        var results = [];
                        for(key in merged) {
                            results.push(merged[key]);
                        }
                        return results;
                    }
                "
            }
        }
    ]
}
EOF 
```

在第二个版本中，我们执行四个单独的 Map-Reduce 查询来从三个存储桶中获取对象：

```
async.series([
        //First get all matches
        function(callback) {
            db.mapreduce
                .add(inputs)
                .map(function (val, key, arg) {
                    var data = Riak.mapValuesJson(val)[0];
                    if(arg.leagueId && arg.leagueId != data.leagueId) {
                        return [];
                    }
                    var d = new Date();
                    var date = data.startTime || data.firstHalfStartTime || data.secondHalfStartTime;
                    d.setFullYear(date.substring(0, 4));
                    d.setMonth(date.substring(5, 7) - 1);
                    d.setDate(date.substring(8, 10));
                    d.setHours(date.substring(11, 13));
                    d.setMinutes(date.substring(14, 16));
                    d.setSeconds(date.substring(17, 19));
                    d.setMilliseconds(0);
                    startTimestamp = d.getTime();
                    var short = {
                        id: data.id,
                        l: data.leagueId,
                        h: data.homeTeamId,
                        a: data.awayTeamId,
                        t: startTimestamp,
                        s: data.score,
                        c: startTimestamp
                    };
                    return [short];
                }, {leagueId: query.leagueId, page: query.page}).reduce(function (val, key) {
                    return val;
                }).run(function (err, matches) {
                    matches.forEach(function(match) {
                        result.match[match.id] = match; //Should maybe filter this
                        leagueIds.push(match.l);
                        teamIds.push(match.h);
                        teamIds.push(match.a);
                    });
                    callback();
                });
        },
        //Then get all leagues, teams and lines in parallel
        function(callback) {
            async.parallel([
                //Leagues
                function(callback) {
                    db.getMany('leagues', leagueIds, function(err, leagues) {
                        if (err) { callback(err); return; }
                        leagues.forEach(function(league) {
                            visibleLeagueIds[league.id] = true;
                            result.league[league.id] = {
                                r: league.regionId,
                                n: league.name,
                                s: league.name
                            };
                        });
                        callback();
                    });
                },
                //Teams
                function(callback) {
                    db.getMany('teams', teamIds, function(err, teams) {
                        if (err) { callback(err); return; }
                        teams.forEach(function(team) {
                            result.team[team.id] = {
                                n: team.name,
                                h: team.name,
                                s: team.stats
                            };
                        });
                        callback();
                    });
                }
            ], callback);
        }
    ], function(err) {
        if (err) { callback(err); return; }
        _.each(regionModel.getAll(), function(region) {
           result.region[region.id] = {
               id: region.id,
               c: 'https://d1goqbu19rcwi8.cloudfront.net/icons/silk-flags/' + region.icon + '.png',
               n: region.name
           };
        });
        var response = {
            success: true,
            result: {
                modelRecords: result,
                paging: {
                    page: query.page,
                    pageSize: 50,
                    total: result.match.length
                },
                time: moment().diff(a)/1000.00,
                visibleLeagueIds: visibleLeagueIds
            }
        };
        callback(null, JSON.stringify(response, null, '\t'));
    }); 
```

我们如何使这些查询更快？

**附加信息：**

我们使用 riak-js 和 node.js 来运行我们的查询。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2012-10-25T19:13:46.000

使其至少更快一点的一种方法是将 JavaScript mapreduce 函数部署到服务器，而不是将它们作为作业的一部分传递。（参见[此处对](http://docs.basho.com/riak/1.2.0/references/Configuration-Files/)**js_source_dir**参数的描述）。如果您有重复运行的 JavaScript 函数，通常建议这样做。

由于与在 Erlang 中实现的原生函数相比，运行 JavaScript mapreduce 函数会产生一些开销，因此在可能的情况下使用非 JavaScript 函数也可能会有所帮助。

您的第一个查询中的两个映射阶段函数似乎旨在解决正常链接阶段（我认为它更有效）不会传递正在处理的记录（*匹配*记录）的限制。第一个函数包含所有链接并将匹配数据作为附加数据以 JSON 形式传递，而第二个函数将匹配数据以及链接记录以 JSON 形式传递。

我编写了一个简单的 Erlang 函数，其中包括所有链接以及传入的记录的 ID。这可以与原生 Erlang 函数**riak_kv_mapreduce:map_object_value**一起使用，以替换第一个示例中的两个映射阶段函数，删除一些JavaScript 用法。与现有解决方案一样，我希望您会收到许多重复，因为几场比赛可能会链接到同一个联赛/球队。

```
-module(riak_mapreduce_example).

-export([map_link/3]).

%% @spec map_link(riak_object:riak_object(), term(), term()) ->
%%                   [{{Bucket :: binary(), Key :: binary()}, Props :: term()}]
%% @doc map phase function for adding linked records to result set
map_link({error, notfound}, _, _) ->
    [];
map_link(RiakObject, Props, _) ->
    Bucket = riak_object:bucket(RiakObject),
    Key = riak_object:key(RiakObject),
    Meta = riak_object:get_metadata(RiakObject),
    Current = [{{Bucket, Key}, Props}],
    Links = case dict:find(<<"Links">>, Meta) of
        {ok, List} ->
            [{{B, K}, Props} || {{B, K}, _Tag} <- List];
        error ->
            []
    end,
    lists:append([Current, Links]). 
```

这些结果既可以发送回客户端进行聚合，也可以像您提供的示例一样传递到 reduce 阶段函数。

示例函数需要在所有节点上编译和安装，并且可能需要重新启动。

另一种提高性能的方法（很可能不是您的选择）可能是更改数据模型，以避免完全使用 mapreduce 查询来进行性能关键查询。

# ruby-on-rails - Ruby on Rails - 无法使关联工作

> ID：13059954
> 
> 赞同：2
> 
> 时间：2012-10-25T00:35:00.283
> 
> 标签：ruby-on-rails

另一个nooby问题 - 我的项目中有这两个模型：

```
class Invoice < ActiveRecord::Base
   has_many :items
end 
```

和

```
class Item < ActiveRecord::Base
   belongs_to :invoice ,:foreign_key=>'invoice_number',:primary_key=>'invoice_number'
end 
```

因此，在我的控制器中，我想通过按下绑定到操作的按钮将新项目添加到发票中。该操作将生成一个表单，让客户填写有关项目的信息。我想在控制器中这样做：

```
@invoice.items << Item.new 
```

这个操作可能是错误的，但问题是，Rails 告诉我有未定义的方法“项目”。有人可以给我一个关于如何解决这个问题的提示吗？

这是错误跟踪：

```
activemodel (3.2.8) lib/active_model/attribute_methods.rb:407:in `method_missing'
activerecord (3.2.8) lib/active_record/attribute_methods.rb:149:in `method_missing'
app/controllers/return_controller.rb:4:in `index'
actionpack (3.2.8) lib/action_controller/metal/implicit_render.rb:4:in `send_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:167:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/rendering.rb:10:in `process_action'
actionpack (3.2.8) lib/abstract_controller/callbacks.rb:18:in `block in process_action'
activesupport (3.2.8) lib/active_support/callbacks.rb:414:in `_run__3004877794972512718__process_action__435319474484567757__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_process_action_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/abstract_controller/callbacks.rb:17:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/rescue.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:30:in `block in process_action'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `block in instrument'
activesupport (3.2.8) lib/active_support/notifications/instrumenter.rb:20:in `instrument'
activesupport (3.2.8) lib/active_support/notifications.rb:123:in `instrument'
actionpack (3.2.8) lib/action_controller/metal/instrumentation.rb:29:in `process_action'
actionpack (3.2.8) lib/action_controller/metal/params_wrapper.rb:207:in `process_action'
activerecord (3.2.8) lib/active_record/railties/controller_runtime.rb:18:in `process_action'
actionpack (3.2.8) lib/abstract_controller/base.rb:121:in `process'
actionpack (3.2.8) lib/abstract_controller/rendering.rb:45:in `process'
actionpack (3.2.8) lib/action_controller/metal.rb:203:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal/rack_delegation.rb:14:in `dispatch'
actionpack (3.2.8) lib/action_controller/metal.rb:246:in `block in action'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:73:in `dispatch'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:36:in `call'
journey (1.0.4) lib/journey/router.rb:68:in `block in call'
journey (1.0.4) lib/journey/router.rb:56:in `each'
journey (1.0.4) lib/journey/router.rb:56:in `call'
actionpack (3.2.8) lib/action_dispatch/routing/route_set.rb:600:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/best_standards_support.rb:17:in `call'
rack (1.4.1) lib/rack/etag.rb:23:in `call'
rack (1.4.1) lib/rack/conditionalget.rb:25:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/head.rb:14:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/params_parser.rb:21:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/flash.rb:242:in `call'
rack (1.4.1) lib/rack/session/abstract/id.rb:205:in `context'
rack (1.4.1) lib/rack/session/abstract/id.rb:200:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/cookies.rb:339:in `call'
activerecord (3.2.8) lib/active_record/query_cache.rb:64:in `call'
activerecord (3.2.8)    lib/active_record/connection_adapters/abstract/connection_pool.rb:473:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:28:in `block in call'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `_run__2876506060705866238__call__963306619056181882__callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:405:in `__run_callback'
activesupport (3.2.8) lib/active_support/callbacks.rb:385:in `_run_call_callbacks'
activesupport (3.2.8) lib/active_support/callbacks.rb:81:in `run_callbacks'
actionpack (3.2.8) lib/action_dispatch/middleware/callbacks.rb:27:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/reloader.rb:65:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/remote_ip.rb:31:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/debug_exceptions.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/show_exceptions.rb:56:in `call'
railties (3.2.8) lib/rails/rack/logger.rb:26:in `call_app'
railties (3.2.8) lib/rails/rack/logger.rb:16:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/request_id.rb:22:in `call'
rack (1.4.1) lib/rack/methodoverride.rb:21:in `call'
rack (1.4.1) lib/rack/runtime.rb:17:in `call'
activesupport (3.2.8) lib/active_support/cache/strategy/local_cache.rb:72:in `call'
rack (1.4.1) lib/rack/lock.rb:15:in `call'
actionpack (3.2.8) lib/action_dispatch/middleware/static.rb:62:in `call'
railties (3.2.8) lib/rails/engine.rb:479:in `call'
railties (3.2.8) lib/rails/application.rb:223:in `call'
rack (1.4.1) lib/rack/content_length.rb:14:in `call'
railties (3.2.8) lib/rails/rack/log_tailer.rb:17:in `call'
rack (1.4.1) lib/rack/handler/webrick.rb:59:in `service'
/usr/lib/ruby/1.9.1/webrick/httpserver.rb:138:in `service'
/usr/lib/ruby/1.9.1/webrick/httpserver.rb:94:in `run'
/usr/lib/ruby/1.9.1/webrick/server.rb:191:in `block in start_thread' 
```

在控制台中它说：

```
NoMethodError (undefined method `items' for #<Invoice:0x00000002b822c8>):
app/controllers/invoice_controller.rb:4:in `index' 
```

**问题反馈：** 感谢你们帮助我解决这个问题。我已经解决了这个问题 - 我发现了一个拼写错误（缺少 's'），很抱歉耽误了您的时间。再次感谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T01:11:53.463

您是否在数据库中创建了这些模型并给 Item 一个`invoice_number`?

```
rails g migration AddInvoiceNumberToItems invoice_number:integer
rake db:migrate 
```

# spring - ConstraintValidatorContext 在不应该存储之前的节点

> ID：13059961
> 
> 赞同：0
> 
> 时间：2012-10-25T00:36:01.797
> 
> 标签：spring, validation, bean-validation

我有这门课

```
@HasNose
@HasMouth
public class Person {

    String fieldA;
    String fieldB;
    // getters and setters

} 
```

现在自定义注释验证器看起来像这样

```
// validator of @HasNose
@Override
public boolean isValid(Object object, 
                        ConstraintValidatorContext context) {

    // some tests that determine there is an error
    context.disableDefaultConstraintViolation();
            context.buildConstraintViolationWithTemplate("Some message")
            .addNode("fieldA")
            .addConstraintViolation();

} 
```

和

```
// validator of @HasMouth
@Override
public boolean isValid(Object object, 
                        ConstraintValidatorContext context) {

    // some tests that determine there is an error
    context.disableDefaultConstraintViolation();
            context.buildConstraintViolationWithTemplate("Some message")
            .addNode("fieldB")
            .addConstraintViolation();

} 
```

运行它会产生异常：

```
java.lang.IllegalStateException: JSR-303 validated property 'fieldA.fieldB' does not have a corresponding accessor for Spring data binding - check your DataBinder's configuration (bean property versus direct field access)
at org.springframework.validation.beanvalidation.SpringValidatorAdapter.processConstraintViolations(SpringValidatorAdapter.java:148)
at org.springframework.validation.beanvalidation.SpringValidatorAdapter.validate(SpringValidatorAdapter.java:101)
at org.springframework.validation.DataBinder.validate(DataBinder.java:722)
at org.springframework.web.method.annotation.ModelAttributeMethodProcessor.validateIfApplicable(ModelAttributeMethodProcessor.java:154)
at org.springframework.web.method.annotation.ModelAttributeMethodProcessor.resolveArgument(ModelAttributeMethodProcessor.java:107)
at org.springframework.web.method.support.HandlerMethodArgumentResolverComposite.resolveArgument(HandlerMethodArgumentResolverComposite.java:74)
at org.springframework.web.method.support.InvocableHandlerMethod.getMethodArgumentValues(InvocableHandlerMethod.java:155)
at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:117)
at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:96)
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:617)
at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:578)
at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:80)
at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:900)
at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:827)
at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:882)
at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:789)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:641)
at javax.servlet.http.HttpServlet.service(HttpServlet.java:722)
at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:305)
at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:210)
at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:222)
at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:123)
at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:472)
at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:168)
at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:99)
at org.apache.catalina.valves.AccessLogValve.invoke(AccessLogValve.java:929)
at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:118)
at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:407)
at org.apache.coyote.http11.AbstractHttp11Processor.process(AbstractHttp11Processor.java:1002)
at org.apache.coyote.AbstractProtocol$AbstractConnectionHandler.process(AbstractProtocol.java:585)
at org.apache.tomcat.util.net.JIoEndpoint$SocketProcessor.run(JIoEndpoint.java:312)
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
at java.lang.Thread.run(Thread.java:680) 
```

出于某种原因，“ConstraintValidatorContext”正在连接两个字段。调试显示属性“propertyPath”已经用“fieldA”填写。我认为它应该在每个约束验证器的根级别，不是吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2012-10-25T17:20:21.270

我找到了解决我自己问题的方法，我使用的是 hibernate-validator-4.2.0.BETA2。切换到 hibernate-validator-4.2.0.FINAL 解决了这个问题。

经验教训：保持你的库更新......

# c++ - 关于如何使用 cpp-netlib 进行异步 http get 请求的示例

> ID：13059967
> 
> 赞同：4
> 
> 时间：2012-10-25T00:36:37.117
> 
> 标签：c++, asynchronous, compiler-errors, http-request, cpp-netlib

我正在尝试使用[cpp-netlib](http://cpp-netlib.github.com/latest/index.html)进行异步 http 请求。我在文档中找不到任何这样的示例，因此甚至无法编译它。我目前的尝试如下（评论中有编译错误）。任何提示如何使它工作？先感谢您！

```
#include <iostream>
#include <boost/network/protocol/http/client.hpp>

using namespace std;
using namespace boost::network;
using namespace boost::network::http;

typedef function<void(boost::iterator_range<char const *> const &, boost::system::error_code const &)> body_callback_function_type; // ERROR: Expected initializer before '<' token

body_callback_function_type callback() // ERROR: 'body_callback_function_type' does not name a type
{
    cout << "This is my callback" << endl;
}

int main() {
    http::client client;
    http::client::request request("http://www.google.com/");
    http::client::response response = client.get(request, http::_body_handler=callback()); // ERROR: 'callback' was not declared in this scope
    cout << body(response) << endl;
    return 0;
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2012-10-25T00:55:16.380

我没有使用过 cpp-netlib，但您的代码似乎存在一些明显的问题：

第一个错误是`boost::`函数 typedef 缺失。

```
typedef function<void(boost::iterator_range<char const *> const &, boost::system::error_code const &)> body_callback_function_type; // ERROR: Expected initializer before '<' token 
```

应该

```
typedef boost::function<void(boost::iterator_range<char const *> const &, boost::system::error_code const &)> body_callback_function_type; 
```

第二个错误是：

```
body_callback_function_type callback() 
{
    cout << "This is my callback" << endl;
} 
```

应该是正确的功能：

```
void callback( boost::iterator_range<char const *> const &, boost::system::error_code const &)
{
    cout << "This is my callback" << endl;
} 
```

第三个错误是您应该传递回调，而不是调用它：

```
http::client::response response = client.get(request, http::_body_handler=callback()); 
```

应该

```
http::client::response response = client.get(request, callback); 
```

希望这就是全部（或足以让你开始）。

# jquery - jQuery基本文件上传

> ID：13059971
> 
> 赞同：2
> 
> 时间：2012-10-25T00:37:42.590
> 
> 标签：jquery, ruby-on-rails, ruby-on-rails-3, ruby-on-rails-3.1

我一直在研究 Ryan 提出的名为 Jquery 文件上传的截屏视频专业版。但是，每次我输入图像时，它都不会上传。我不确定我在这里做错了什么我的代码。我正在使用谷歌并尝试上传它，但它似乎没有做任何事情

Javascript 应用程序.js

```
//= require jquery
//= require jquery_ujs
//= require jquery-fileupload/basic
//= require jquery-fileupload/vendor/tmpl
//= require_tree . 
```

绘画.js.coffee

```
jQuery ->
  $('#new_painting').fileupload 
```

查看 _form.html.erb

```
<%= form_for @painting, :html => {:multipart => true} do |f| %>
  <div class="field">
    <%= f.hidden_field :galley_id %>
  </div>
  <div class="field">
    <%= f.label :image %><br />
    <%= f.file_field :image %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %> 
```

index.html.erb

# 画廊

```
<%= form_for Painting.new do |f| %>
  <%= f.label :image, "Upload paintings:" %>
  <%= f.file_field :image, multiple: true, name: "painting[image]" %>
<% end %> 
```

显示.html.erb

```
<p><%= image_tag @painting.image_url %></p>

<p>
  <%= link_to "Edit", edit_painting_path(@painting) %> |
  <%= link_to "Destroy", @painting, :confirm => 'Are you sure?', :method => :delete %> |
  <%= link_to "Back to Paintings", paintings_path %>
</p> 
```

控制器

```
def index
    @paintings = Painting.all
  end

  def show
    @painting = Painting.find(params[:id])
  end

  def new
    @painting = Painting.new
  end

  def create
    @painting = Painting.create(params[:painting])
  end

  def edit
    @painting = Painting.find(params[:id])
  end

  def update
    @painting = Painting.find(params[:id])
    if @painting.update_attributes(params[:painting])
      redirect_to paintings_url, notice: "Painting was successfully updated."
    else
      render :edit
    end
  end

  def destroy
    @painting = Painting.find(params[:id])
    @painting.destroy
    redirect_to paintings_url, notice: "Painting was successfully destroyed."
  end 
```

模型

```
 attr_accessible :image
  mount_uploader :image, ImageUploader 
```

我的主要问题是上传任何图片时它没有提交按钮并且不知道如何使它工作，我错过了什么吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-19T21:30:40.353

因此，只需通过在 S3Uploader > 初始化方法中将时区（即 utc）添加到过期时间来解决此问题

有关更多信息，请参阅： [上传到亚马逊 S3](https://stackoverflow.com/questions/14410938/upload-to-amazon-s3/14419055#14419055)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-11-05T19:15:13.040

您可能已成功将文件上传到控制器操作，但除了

```
@painting = Painting.create(params[:painting]) 
```

您需要做更多的事情，比如可能将上传的文件保存在服务器的某个位置？

```
def  create
  filename = params[:painting][:image].original_filename
  filetype = params[:painting][:image].content_type
  filedata = params[:painting][:image].read
  File.open("#{Rails.root.to_s}/images/#{filename}","wb") { |f| f.write(filedata) } 
  @painting = Painting.create(params[:painting])
end 
```

这将提取上传的图像并将其写入服务器。如果您还想在数据库中记录 MIME 类型，则 Content_type 很方便。

# objective-c - 为什么自定义 UITableViewCells 可能在 iOS 6 中工作但在 iOS 5 中不工作的一些原因是什么？

> ID：13059985
> 
> 赞同：2
> 
> 时间：2012-10-25T00:39:13.447
> 
> 标签：objective-c, uitableview, subclass, reloaddata

我在尝试让表格视图在我的 iPhone 上工作时遇到了很多麻烦。奇怪的是，它在我的 iOS 模拟器上似乎工作得很好（即，我可以向数组添加一个条目，并且该条目显示在我的表格视图中）。但是，当我在使用 iOS 设备时尝试添加条目时，代码会中断`dequeueReusableCellWithIdentifier:`。我检查了大小写不一致，名称不一致，`prepareForReuse`在自定义 UITableViewCell 子类中重新实现，尝试使用 IBOutlets v. 标签在我的 UITableViewCell 子类中定义字段，也许还有一些事情但没有奏效。

这个问题与我之前的问题切线相关：[当 UITableView 的单元格不加载时调试策略？](https://stackoverflow.com/questions/13043741/debugging-strategies-when-uitableviews-cells-dont-load)

编程的难点在于始终知道要问哪个问题，所以如果我问错了问题，我深表歉意。

**更新 6：问题是 iOS 5 上 UITableViewCell 的自定义布局**

我使用自定义布局的 UITableViewCell 和 UITableViewCell 的子类进行了测试。使用样式为 UITableViewCellStyleDefault 的 UITableViewCell 的子类***确实***适用于 iOS 5 和 iOS 6 iPhone 模拟器。但是，在 iOS 5 上使用具有自定义样式的通用 UITableViewCell 会***崩溃，但不会在 iOS 6 上崩溃***。有趣的是，我在 UITableViewCell 的文档中没有看到自定义 UITableViewCellStyle 的声明......

**更新 5：iOS 5 v. 6 + 自定义 UITableViewCell 子类？**

您好：今天继续测试，看来这是 iOS 5 和 6 如何处理自定义 UITableViewCell 子类之间的问题。还没有解决方案:(

**更新 4：iOS 5 与 iOS 6？**

所以我能注意到的是，这似乎是 iOS 5 与 iOS 6 的问题。在 iOS 6 上使用 line 测试时，`GlassboxCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier]`下面的代码有效。但是，这条线`GlassboxCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath]`在 iOS 5 中也不起作用。有什么想法吗？通过将标识符更改为`protocell`.

**更新 3：我现在使用 GitHub！**

这是相关的回购：[https ://github.com/kenmhaggerty/Glassbox](https://github.com/kenmhaggerty/Glassbox)

**更新 2：更多观察**

所以我添加了，`@synthesize tableView = _tableView`因为我在某处读到了可能有帮助的响应，但我现在意识到它阻止了我的数据加载到我的表格视图中，即使在 iOS 模拟器上运行也是如此。注释掉那行代码会将代码返回到我上面描述的方式：它在 iOS 模拟器上工作得很好，但在`dequeueReusableCellWithIdentifier:`没有指定错误的情况下断线，只是`Thread 1: breakpoint 1.1`.

**更新 1：相关代码**

GlassboxTableViewController.h

```
//
//  GlassboxTableViewController.h
//  Glassbox
//
//  Created by Ken M. Haggerty on 10/22/12.
//  Copyright (c) 2012 Ken M. Haggerty. All rights reserved.
//

#pragma mark - // NOTES (Public) //

#pragma mark - // IMPORTS (Public) //

#import <UIKit/UIKit.h>

#pragma mark - // PROTOCOLS //

//@protocol GlassboxTableViewDatasource <NSObject>
//@property (nonatomic, weak) NSMutableArray *arrayOfPlayers;
//@end

#pragma mark - // DEFINITIONS (Public) //

@interface GlassboxTableViewController : UITableViewController
@property (nonatomic, strong) NSMutableArray *arrayOfPlayers;
- (IBAction)addPlayer:(UIBarButtonItem *)sender;
//@property (nonatomic, strong) id <GlassboxTableViewDatasource> datasource;
@end 
```

GlassboxTableViewController.m

```
//
//  GlassboxTableViewController.m
//  Glassbox
//
//  Created by Ken M. Haggerty on 10/22/12.
//  Copyright (c) 2012 Ken M. Haggerty. All rights reserved.
//

#pragma mark - // NOTES (Private) //

#pragma mark - // IMPORTS (Private) //

#import "GlassboxTableViewController.h"
#import "GlassboxCell.h"
#import "Player.h"
#import <MobileCoreServices/MobileCoreServices.h>

#pragma mark - // DEFINITIONS (Private) //

#define SIDEBAR_WIDTH_PERCENT 0.75

@interface GlassboxTableViewController () <UITableViewDataSource, UITableViewDelegate, UIImagePickerControllerDelegate, UINavigationControllerDelegate>
//@property (nonatomic, weak) IBOutlet UITableView *tableView;
- (void)setup;
@end

@implementation GlassboxTableViewController

#pragma mark - // SETTERS AND GETTERS //

@synthesize arrayOfPlayers = _arrayOfPlayers;
@synthesize tableView = _tableView;
//@synthesize datasource = _datasource;

- (void)setArrayOfPlayers:(NSMutableArray *)arrayOfPlayers
{
    _arrayOfPlayers = arrayOfPlayers;
}

- (NSMutableArray *)arrayOfPlayers
{
    if (!_arrayOfPlayers) _arrayOfPlayers = [[NSMutableArray alloc] init];
//    [_arrayOfPlayers addObject:[[Player alloc] initWithUsername:@"Ken H.:"]];
    return _arrayOfPlayers;
}

#pragma mark - // INITS AND LOADS //

- (void)setup
{
    self.tableView.dataSource = self;
    self.tableView.delegate = self;
}

- (id)initWithStyle:(UITableViewStyle)style
{
    NSLog(@"[initWithStyle]");
    self = [super initWithStyle:style];
    if (self) {
        [self setup];
    }
    return self;
}

- (void)viewDidLoad
{
    NSLog(@"[viewDidLoad]");
    [super viewDidLoad];
    [self setup];

    // Uncomment the following line to preserve selection between presentations.
    // self.clearsSelectionOnViewWillAppear = NO;

    // Uncomment the following line to display an Edit button in the navigation bar for this view controller.
    // self.navigationItem.rightBarButtonItem = self.editButtonItem;
}

//- (void)viewDidAppear:(BOOL)animated
//{
//    [super viewDidAppear:animated];
//    [self.view setFrame:CGRectMake(self.view.frame.origin.x, self.view.frame.origin.y, self.view.frame.size.width*SIDEBAR_WIDTH_PERCENT, self.view.frame.size.height)];
//}

- (void)didReceiveMemoryWarning
{
    [super didReceiveMemoryWarning];
    // Dispose of any resources that can be recreated.
}

#pragma mark - // PUBLIC FUNCTIONS //

- (IBAction)addPlayer:(UIBarButtonItem *)sender
{
    [self alertAddPlayer];
}

#pragma mark - // PRIVATE FUNCTIONS //

- (void)alertAddPlayer
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Add New Player" message:@"Please type player name:" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"OK",nil];
    alert.alertViewStyle = UIAlertViewStylePlainTextInput;
    alert.tag = 1;
    [alert show];
}

- (void)alertInvalidPlayer
{
    UIAlertView *alert = [[UIAlertView alloc] initWithTitle:@"Invalid Name" message:@"Please type another name:" delegate:self cancelButtonTitle:@"Cancel" otherButtonTitles:@"OK",nil];
    alert.alertViewStyle = UIAlertViewStylePlainTextInput;
    alert.tag = 1;
    [alert show];
}

- (void)alertAddPhoto
{
    NSLog(@"[TEST] alertAddPhoto");
    if ([UIImagePickerController isSourceTypeAvailable:UIImagePickerControllerSourceTypeCamera])
    {
        NSArray *mediaTypes = [UIImagePickerController availableMediaTypesForSourceType:UIImagePickerControllerSourceTypeCamera];
        if ([mediaTypes containsObject:(NSString *)kUTTypeImage])
        {
            UIImagePickerController *imagePickerController = [[UIImagePickerController alloc] init];
            imagePickerController.delegate = self;
            imagePickerController.sourceType = UIImagePickerControllerSourceTypeCamera;
            imagePickerController.allowsEditing = YES;
//            imagePickerController.cameraDevice = UIImagePickerControllerCameraDeviceFront;
//            imagePickerController.cameraCaptureMode = UIImagePickerControllerCameraCaptureModePhoto;
            imagePickerController.mediaTypes = [NSArray arrayWithObject:(NSString *)kUTTypeImage];
//            [self presentViewController:imagePickerController animated:YES completion:nil];
        imagePickerController.cameraDevice = UIImagePickerControllerCameraDeviceFront;
            [self presentModalViewController:imagePickerController animated:YES];
            return;
        }
    }
    NSLog(@"[TEST] No camera available");
    [self.tableView reloadData];
}

- (void)imagePickerController:(UIImagePickerController *)picker didFinishPickingMediaWithInfo:(NSDictionary *)info
{
    UIImage *image = [info objectForKey:UIImagePickerControllerEditedImage];
    if (!image) image = [info objectForKey:UIImagePickerControllerOriginalImage];
    if (image)
    {
        [[self.arrayOfPlayers lastObject] setPhoto:[[UIImageView alloc] initWithImage:image]];
    }
    [self dismissImagePicker];
}

- (void)imagePickerControllerDidCancel:(UIImagePickerController *)picker
{
    [self dismissImagePicker];
}

- (void)dismissImagePicker
{
//    [self dismissViewControllerAnimated:YES completion:^{
//        [self.tableView reloadData];
//    }];
    [self dismissModalViewControllerAnimated:YES];
    [self.tableView reloadData];
}

- (void)alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 0) NSLog(@"Cancel tapped");
    else
    {
        if (alertView.tag == 1)
        {
            if (buttonIndex == 1)
            {
                if ([[[alertView textFieldAtIndex:0] text] length] != 0)
                {
                    [self.arrayOfPlayers addObject:[[Player alloc] initWithUsername:[[alertView textFieldAtIndex:0] text]]];
                    [self alertAddPhoto];
                }
                else [self alertInvalidPlayer];
            }
        }
    }
}

#pragma mark - // PRIVATE FUNCTIONS (Miscellaneous) //

// TableView data source //

//- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
//{
//#warning Potentially incomplete method implementation.
//    // Return the number of sections.
//    return 0;
//}

- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
//    return self.datasource.arrayOfPlayers.count;
    return self.arrayOfPlayers.count;
}

- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"New Cell";
//    GlassboxCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath];
    GlassboxCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    cell.name.text = [[self.arrayOfPlayers objectAtIndex:indexPath.row] username];
    cell.action.text = @"LOADED SUCCESSFULLY";
    cell.time.text = @"Just now";
    cell.photo = [[self.arrayOfPlayers objectAtIndex:indexPath.row] photo];

//    [((UILabel *)[cell viewWithTag:1]) setText:[[self.arrayOfPlayers objectAtIndex:indexPath.row] username]];
//    [((UILabel *)[cell viewWithTag:2]) setText:@"has been added."];
//    [((UILabel *)[cell viewWithTag:3]) setText:@"Just now"];
//    [((UIImageView *)[cell viewWithTag:4]) setImage:[[[self.arrayOfPlayers objectAtIndex:indexPath.row] photo] image]];

    [cell.contentView setFrame:CGRectMake(cell.contentView.frame.origin.x, cell.contentView.frame.origin.y, cell.contentView.frame.size.width, 120)];

    return cell;
}

/*
// Override to support conditional editing of the table view.
- (BOOL)tableView:(UITableView *)tableView canEditRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the specified item to be editable.
    return YES;
}
*/

/*
// Override to support editing the table view.
- (void)tableView:(UITableView *)tableView commitEditingStyle:(UITableViewCellEditingStyle)editingStyle forRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (editingStyle == UITableViewCellEditingStyleDelete) {
        // Delete the row from the data source
        [tableView deleteRowsAtIndexPaths:@[indexPath] withRowAnimation:UITableViewRowAnimationFade];
    }   
    else if (editingStyle == UITableViewCellEditingStyleInsert) {
        // Create a new instance of the appropriate class, insert it into the array, and add a new row to the table view
    }   
}
*/

/*
// Override to support rearranging the table view.
- (void)tableView:(UITableView *)tableView moveRowAtIndexPath:(NSIndexPath *)fromIndexPath toIndexPath:(NSIndexPath *)toIndexPath
{
}
*/

/*
// Override to support conditional rearranging of the table view.
- (BOOL)tableView:(UITableView *)tableView canMoveRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Return NO if you do not want the item to be re-orderable.
    return YES;
}
*/

// TableView delegate //

- (void)tableView:(UITableView *)tableView didSelectRowAtIndexPath:(NSIndexPath *)indexPath
{
    // Navigation logic may go here. Create and push another view controller.
    /*
     <#DetailViewController#> *detailViewController = [[<#DetailViewController#> alloc] initWithNibName:@"<#Nib name#>" bundle:nil];
     // ...
     // Pass the selected object to the new view controller.
     [self.navigationController pushViewController:detailViewController animated:YES];
     */
}

@end 
```

让我知道我是否应该发布更多内容。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-11-09T19:52:10.703

（您的 github 项目无法编译（缺少 Player.h/Player.m），因此很难重现该问题。）

但我注意到 MainStoryboard 文件中启用了“使用自动布局”。自动布局仅适用于 iOS 6 及更高版本，不适用于 iOS 5！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:45:07.207

请发布您的代码。我可以建议您保留 xib 文件并重`uitableviewcell`试。你使用一种细胞吗？或者你使用几种不同的风格？

===== 答案 =====

当您创建单元格`GlassboxCell *cell`并使用 dequeueReusableCellWIthIdentifier 时，您需要检查单元格是否已分配。

```
// use dequeueReusableCellWithIdentifier for init cell
if (cell == nil){
    cell = [[[GlassboxCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:yourIdentifier]] autorelease];
}
//rest your code for init properties for cell 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2012-10-25T11:14:24.867

好的，尝试使用此功能而不是您的功能。

```
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString *CellIdentifier = @"NewCell";
    GlassboxCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier];

    if (cell == nil)
    {
        cell = [[GlassboxCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:CellIdentifier];

    }

    cell.name.text = [[self.arrayOfPlayers objectAtIndex:indexPath.row] username];
    cell.action.text = @"LOADED SUCCESSFULLY";
    cell.time.text = @"Just now";
    cell.photo = [[self.arrayOfPlayers objectAtIndex:indexPath.row] photo];

    [cell.contentView setFrame:CGRectMake(cell.contentView.frame.origin.x, cell.contentView.frame.origin.y, cell.contentView.frame.size.width, 120)];

    return cell;
} 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2012-11-14T23:13:31.563

我想我发现了问题......至少它适用于我的项目。

当您使用旧版本的 Xcode（例如 4）创建 UITableViewController 类时，生成的 cellForRowAtIndexPath 代码如下：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier]; 
```

但是，当您使用 Xcode 4.5.2（我的）制作 UITableViewController 时，生成的 cellForRowAtIndexPath 代码是这样的：

```
UITableViewCell *cell = [tableView dequeueReusableCellWithIdentifier:CellIdentifier forIndexPath:indexPath]; 
```

所以在我的情况下，我所做的就是删除“forIndexPath：indexPath”部分，它可以工作！

（这是我的第一个答案，所以如果我搞砸了，请温柔）

# c - 我可以将字符串和 int 值推入堆栈吗？

> ID：13059988
> 
> 赞同：0
> 
> 时间：2012-10-25T00:39:50.610
> 
> 标签：c, string, stack, int

我需要我的堆栈来接收 int 和 char 数组（字符串）。有什么想法吗？我知道目前我有使用整数操作的 pop 和 push 命令。不同类型的结构会更好吗？我似乎记得某些结构能够接受不同的论点。如果我定义不同的函数来处理 char 数组会有帮助吗？我知道你不能在 c 中超载。我的另一个想法是让堆栈接收字符串并根据需要在字符串和 int 之间进行转换，但这似乎有点冒险在两种变量类型之间进行常量切换。

```
typedef struct Stack
{
int capacity;       // max # of elements the stack can hold
int size;           // current size of the stack
int *elements;      // the array of elements
}Stack;

Stack * createStack(int maxElements)
{        

Stack *S;        
S = (Stack *)malloc(sizeof(Stack));     
S->elements = (int *)malloc(sizeof(int)*maxElements);        
S->size = 0;        
S->capacity = maxElements;      
return S;
}

// STACK COMMANDS

void pop(Stack *S)
{               
if(S->size==0)        
{                
    printf("Stack is Empty\n");                
return;        
}        

else        
{                
    S->size--;        
}        

return;
}

int top(Stack *S)
{        
if(S->size==0)        
{                
    printf("Stack is Empty\n");               
    exit(0);        
}               
return S->elements[S->size-1];
}

void push(Stack *S,int element)
{                
if(S->size == S->capacity)        
{                
    printf("Stack is Full\n");        
}        
else        
{                               
    S->elements[S->size++] = element;        
}        
return;
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:48:46.587

如果你愿意，你可以使用联合。实际上，您所追求的是*变体*数据类型。所以我称之为`Variant`：

```
typedef enum VariantType {
    v_int,
    v_string
} EVariantType;

typedef struct Variant
{
    EVariantType type;
    union {
        int m_int;
        char * m_string;
    };
} SVariant; 
```

从记忆中，我很确定这个匿名工会没问题。这意味着您可以存储整数：

```
SVariant v;
v.type = v_int;
v.m_int = 42; 
```

和字符串：

```
SVariant v;
v.type = v_string;
v.m_string = strdup( "Hello, World!" ); 
```

我在这里使用枚举是为了通用，因为您可以稍后轻松地扩展到其他类型（而不是使用一个标志来指示它是 int 还是不是 int）。

当你开始使用数据时，当然可以在 switch 语句中处理它：

```
switch( v.type )
{
    case v_int:  printf( "Integer value: %d\n", v.m_int ); break;
    case v_string: printf( "String value: %s\n", v.m_string ); break;
} 
```

您的堆栈现在声明为：

```
typedef struct Stack
{
    int capacity;       // max # of elements the stack can hold
    int size;           // current size of the stack
    SVariant *elements; // the array of elements
}Stack; 
```

希望有帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2012-10-25T00:42:43.010

您可以创建一个联合类型：

```
union mType
{
    int integer;
    char *string;
}; 
```

然后你可以让 mType 成为你的元素类型。

编辑：

联合在某种意义上类似于结构，因为它们具有可由 . 和 -> 运算符。但是每个成员的内存是重叠的。

# git - 自动更新 package.json 版本

> ID：13059991
> 
> 赞同：237
> 
> 时间：2012-10-25T00:40:22.353
> 
> 标签：git, node.js, npm, githooks

在我做一个小版本并标记它之前，我想更新 package.json 以反映程序的新版本。

有没有办法`package.json`自动编辑文件？

会使用`git pre-release hook`帮助吗？

* * *

## 回答 #1

> 赞同：206
> 
> 时间：2012-11-01T14:14:22.253

**正确答案**

为此，只需`npm version patch`=)

**我的旧答案**

原来没有`pre-release`钩子`git`。至少，`man githooks`没有表现出来。

例如，如果您正在使用`git-extra`（[https://github.com/visionmedia/git-extras](https://github.com/visionmedia/git-extras)），您可以使用`pre-release`由它实现的钩子，如您在[https://github.com/visionmedia/中所见git-extras/blob/master/bin/git-release](https://github.com/visionmedia/git-extras/blob/master/bin/git-release)。它只需要一个`.git/hook/pre-release.sh`可执行文件来编辑您的`package.json`文件。提交、推送和标记将由`git release`命令完成。

如果您不使用任何扩展名`git`，您可以编写一个 shell 脚本（我将命名它`git-release.sh`），然后您可以使用类似以下内容的别名`git release`：

`git config --global alias.release '!sh path/to/pre-release.sh $1'`

您可以使用`git release 0.4`which 将执行`path/to/pre-release.sh 0.4`. 您的脚本可以编辑`package.json`、创建标签并将其推送到服务器。

* * *

## 回答 #2

> 赞同：113
> 
> 时间：2013-03-07T07:24:41.523

`npm version`可能是正确的答案。只是为了提供替代方案，我推荐[grunt-bump](https://github.com/vojtajina/grunt-bump)。它由 angular.js 中的一个人维护。

用法：

```
grunt bump
>> Version bumped to 0.0.2

grunt bump:patch
>> Version bumped to 0.0.3

grunt bump:minor
>> Version bumped to 0.1.0

grunt bump
>> Version bumped to 0.1.1

grunt bump:major
>> Version bumped to 1.0.0 
```

如果您仍然使用 grunt，它可能是最简单的解决方案。

* * *

## 回答 #3

> 赞同：83
> 
> 时间：2013-03-07T04:59:28.513

这是我通常对我的项目所做的：

```
npm version patch
git add *;
git commit -m "Commit message"
git push
npm publish 
```

第一行，`npm version patch`，将在 中将补丁版本增加 1（xx1 到 xx2）`package.json`。然后添加所有文件——包括`package.json`当时已修改的文件。`git commit`然后，和往常一样`git push`，最后`npm publish`发布模块。

我希望这是有道理的...

默克。

* * *

## 回答 #4

> 赞同：39
> 
> 时间：2016-12-15T09:23:05.540

作为补充，如果您想要版本提升但没有标签或新提交，`npm version`您可以使用该标志：`--no-git-tag-version`

```
npm --no-git-tag-version version patch 
```

[https://docs.npmjs.com/cli/version](https://docs.npmjs.com/cli/version)

* * *

## 回答 #5

> 赞同：38
> 
> 时间：2016-09-08T17:29:18.973

提供更新的方法。

### `package.json`

```
 "scripts": {
    "eslint": "eslint index.js",
    "pretest": "npm install",
    "test": "npm run eslint",
    "preversion": "npm run test",
    "version": "",
    "postversion": "git push && git push --tags && npm publish"
  } 
```

然后你运行它：

```
npm version minor --force -m "Some message to commit" 
```

这将：

1.  ...运行测试...

2.  将您的更改`package.json`为下一个次要版本（例如：1.8.1 到 1.9.0）

3.  推动你的改变

4.  创建一个新的 git 标签版本和

5.  发布你的 npm 包。

`--force`就是显示谁是老大！除了笑话，请参阅[https://github.com/npm/npm/issues/8620](https://github.com/npm/npm/issues/8620)

* * *

## 回答 #6

> 赞同：29
> 
> 时间：2018-10-12T06:18:12.767

如果你使用纱线，你可以使用

```
yarn version patch 
```

这将`package.json`通过 patch `(0.0.x)`、 commit 增加版本，并用 format 标记它`v0.0.0`

`--minor`同样，您可以使用or来增加次要或主要版本`--major`

推送到 git 时，请确保您还使用`--follow-tags`

```
git push --follow-tags 
```

你也可以为它创建一个脚本

```
 "release-it": "yarn version --patch && git push --follow-tags" 
```

只需键入即可运行它`yarn release-it`

* * *

## 回答 #7

> 赞同：14
> 
> 时间：2018-07-19T08:01:52.907

我正在使用[husky](https://github.com/typicode/husky)和[​​git-branch-is](https://github.com/kevinoid/git-branch-is)：

从哈士奇 v1+ 开始：

```
// package.json
{
  "husky": {
    "hooks": {
      "post-merge": "(git-branch-is master && npm version minor || 
  (git-branch-is dev && npm --no-git-tag-version version patch)",
    }
  }
} 
```

在哈士奇 V1 之前：

```
"scripts": {
  ...
  "postmerge": "(git-branch-is master && npm version minor || 
  (git-branch-is dev && npm --no-git-tag-version version patch)",
  ...
}, 
```

阅读有关[npm 版本的更多信息](https://docs.npmjs.com/cli/version)

**Webpack 或 Vue.js**

如果您使用的是 webpack 或 Vue.js，您可以使用[自动注入版本 - Webpack 插件在 UI 中显示它](https://www.npmjs.com/package/webpack-auto-inject-version)

*NUXT*

在`nuxt.config.js`：

```
var WebpackAutoInject = require('webpack-auto-inject-version');

module.exports = {
  build: {
    plugins: [
      new WebpackAutoInject({
        // options
        // example:
        components: {
          InjectAsComment: false
        },
      }),
    ]
  },
} 
```

`template`例如在页脚中：

```
<p> All rights reserved © 2018 [v[AIV]{version}[/AIV]]</p> 
```

* * *

## 回答 #8

> 赞同：12
> 
> 时间：2019-02-20T14:04:15.840

**我想为这个问题得到的答案增加一些清晰度。**

即使认为这里有一些正确解决问题并提供解决方案的答案，它们也不是正确的。这个问题的正确答案是使用`npm version`

> 有没有办法自动编辑文件 package.json？

是的，你可以做的是`npm version`在需要时运行命令，你可以在这里阅读更多关于它[的信息 npm version](https://docs.npmjs.com/cli/version.html)，但基本用法是，它会在你的版本（1.0.X **）**上`npm version patch`添加第三位数字顺序`package.json`

 **> 使用 git 预发布挂钩会有所帮助吗？

您可以根据需要配置为`npm version`在预发布挂钩上运行命令，但这取决于您的 CD/CI 管道中是否需要该命令，但如果没有该`npm version`命令，`git pre-release`挂钩将无法“轻松”执行任何操作与`package.json`

**正确答案的原因`npm version`如下：**

1.  `package.json`如果用户正在使用他正在使用的文件夹结构，`npm`如果他正在使用`npm`，他可以访问`npm scripts`.
2.  如果他有权访问，则`npm scripts`他有权访问该`npm version`命令。
3.  使用此命令，他不需要在他的计算机或 CD/CI 管道中安装更多东西，从长远来看，这将减少项目的可维护性工作，并有助于设置

提出其他工具的其他答案是不正确的。

`gulp-bump`有效，但需要另一个额外的软件包，这可能会产生长期问题（我的回答的第 3 点）

`grunt-bump`有效，但需要另一个额外的软件包，这可能会产生长期问题（我的回答的第 3 点）

* * *

## 回答 #9

> 赞同：12
> 
> 时间：2019-05-03T06:55:01.037

首先，您需要了解升级版本号的规则。您可以在此处阅读有关[语义版本](https://flaviocopes.com/npm-semantic-versioning/)的更多信息。

每个版本都有 xyz 版本，它为不同的目的定义，如下所示。

1.  x - 主要，当你有重大变化并且发生了巨大的变化差异时。
2.  y - 次要，当你有新的功能或增强发生时。
3.  z - 补丁，当您修复了错误或恢复早期版本的更改时，将其更新。

要运行脚本，您可以在 package.json 中定义它。

```
"script": {
    "buildmajor": "npm version major && ng build --prod",
    "buildminor": "npm version minor && ng build --prod",
    "buildpatch": "npm version patch && ng build --prod"
} 
```

在您的终端中，您只需要根据您的需要运行 npm run，例如

```
npm run buildpatch 
```

如果在 git repo 中运行它，默认的 git-tag-version 为 true，如果您不希望这样做，您可以在脚本中添加以下命令：

```
--no-git-tag-version 
```

例如：`"npm --no-git-tag-version version major && ng build --prod"`

* * *

## 回答 #10

> 赞同：5
> 
> 时间：2020-12-07T19:11:51.767

您可以使用该`version-select`软件包：

```
npm i -D version-select 
```

```
{
    "name": "test",
    "version": "1.0.0",
    "scripts": {
        "version-select": "version-select"
    },
    "devDependencies": {
        "version-select": "^1.0.13"
    }
} 
```

[![在此处输入图像描述](../Images/9cece4bc731fd945ffebf037eb2a475f.png)](https://i.stack.imgur.com/CfaLR.gif)

[阅读更多](https://www.npmjs.com/package/version-select)

* * *

## 回答 #11

> 赞同：4
> 
> 时间：2020-08-19T19:18:27.950

以防万一您想使用 npm 包`semver` [链接执行此操作](https://www.npmjs.com/package/semver)

```
let fs = require('fs');
let semver = require('semver');

if (fs.existsSync('./package.json')) {
    var package = require('./package.json');
    let currentVersion = package.version;
    let type = process.argv[2];
    if (!['major', 'minor', 'patch'].includes(type)) {
        type = 'patch';
    }

    let newVersion = semver.inc(package.version, type);
    package.version = newVersion;
    fs.writeFileSync('./package.json', JSON.stringify(package, null, 2));

    console.log('Version updated', currentVersion, '=>', newVersion);
} 
```

`package.json`应该看起来像，

```
{
  "name": "versioning",
  "version": "0.0.0",
  "description": "Update version in package.json using npm script",
  "main": "version.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1",
    "version": "node version.js"
  },
  "author": "Bhadresh Arya",
  "license": "ISC",
  "dependencies": {
    "semver": "^7.3.2"
  }
} 
```

只需通过`major`, `minor`,`patch`参数`npm run version`。默认为`patch`.

例如： `npm run version`或`npm run verison patch`或`npm run verison minor`或`npm run version major`

[Git 回购](https://github.com/bhadresharya/stationary/tree/master/fs-semver)

* * *

## 回答 #12

> 赞同：4
> 
> 时间：2020-11-21T04:00:08.820

与[赫斯基](https://github.com/typicode/husky)：

```
{
  "name": "demo-project",
  "version": "0.0.3",
  "husky": {
    "hooks": {
      "pre-commit": "npm --no-git-tag-version version patch && git add ."
    }
  }
} 
```

* * *

## 回答 #13

> 赞同：1
> 
> 时间：2020-02-14T05:53:57.370

我创建了一个[工具](https://github.com/GetchaDEAGLE/eagle-versioner)，可以根据提交消息中的标签（称为更改类型）完成自动语义版本控制。这与 Angular Commit Message Convention 和 Semantic Versioning Specification 密切相关。

您可以使用此工具通过 npm CLI 自动更改 package.json 中的版本（[此处](https://github.com/GetchaDEAGLE/eagle-versioner#versioning-automation)对此进行了描述）。

此外，它可以从这些提交创建一个变更日志，并且还有一个菜单（带有用于提交消息的拼写检查器）用于根据变更类型创建提交。我强烈建议检查它并阅读文档以查看可以使用它完成的所有内容。

我编写了这个工具是因为我找不到任何适合我的 CICD 管道自动化语义版本控制需求的东西。我宁愿关注实际的变化，而不是版本应该是什么，这就是我的工具节省时间的地方。

有关该工具的基本原理的更多信息，请[参阅此](https://danieleagle.com/2020/01/introducing-eagle-versioner/)。

* * *

## 回答 #14

> 赞同：0
> 
> 时间：2022-02-04T03:05:35.420

我知道这是一个老问题，但我希望这种方法可以帮助某人，以防您想自动更新不同位置的两个 package.json 以使用相同的版本。

首先，将这些行添加到您的主要 pakcage.json 脚本部分：

```
"new-version": "npm version --git-tag-version=false",
"version": "echo 'starting postversion script'",
"postversion": "LAST_VERSION=$(npm pkg get version | sed 's/\"//g') && echo $LAST_VERSION && cd projects/ngx-timeline && sed -i.bak \"s/\\\"version\\\": \\\"[0-9]\\.[0-9]\\.[0-9]\\\"/\\\"version\\\": \\\"$LAST_VERSION\\\"/g\" package.json && rm package.json.bak && git commit -am \"Release $LAST_VERSION\" && git tag v$LAST_VERSION" 
```

然后运行例如 npm run new-version minor,

1.  第一个脚本将运行带有次要版本的 npm 版本和避免标签的选项
2.  版本脚本将在默认命令之后运行您需要的命令（在我的情况下只是一个回显）
3.  在带有 sed 的 postversion 脚本中，我可以覆盖我的子 package.json 中的版本，修改提交（默认情况下，版本脚本已经创建了一个提交），然后创建一个标签。**

# android - 如何从其他类获取 onCompletion 处理程序？

> ID：13059997
> 
> 赞同：1
> 
> 时间：2012-10-25T00:41:21.057
> 
> 标签：android, class, listeners

这个Android新手的另一个愚蠢问题，请耐心等待我...... :)

我有一个名为 Music 的类，可以加载/播放音乐：

```
public class Music implements OnCompletionListener{
MediaPlayer mediaPlayer;
...
mediaPlayer.setOnCompletionListener(this);
...
public void onCompletion(MediaPlayer mediaPlayer) { ... }
...
} 
```

然后，我有另一个名为 MainClass 的类，它的 UI 加载了一个音乐

```
Music track = Music(fileDescriptor); 
```

现在，我想要在曲目结束播放或停止时在 UI（MainClass）中做一些事情。但是MediaPlayer在Music里面，不在MainClass里面，还有setOnCompletionListener和onCompletion方法。

那么，MainClass 是如何知道音乐已经结束播放的呢？

谢谢！L.

# mysql - 是否存在为您提供 mysql 用户权限列表的标准 mysql 脚本？

> ID：13059998
> 
> 赞同：-1
> 
> 时间：2012-10-25T00:41:26.693
> 
> 标签：mysql, permissions

> **可能重复：**
> [在 MySQL 中查看授权](https://stackoverflow.com/questions/127679/view-grants-in-mysql)

是否有一个固定脚本可以列出 mysql 用户可以访问的数据库以及他拥有的权限，或者给定一个数据库，列出对其具有权限的用户列表以及这些权限是什么？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2012-10-25T00:44:23.900

```
 SHOW GRANTS FOR CURRENT_USER; 
```

将显示您对所有数据库的当前用户权限。

```
 SHOW GRANTS FOR USERNAME; 
```

将对特定用户执行相同的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2012-10-25T01:18:03.680

information_schema.schema_privileges 表提供了以下信息：

[http://dev.mysql.com/doc/refman/5.0/en/schema-privileges-table.html](http://dev.mysql.com/doc/refman/5.0/en/schema-privileges-table.html)