# StackOverflow 问答 14359000-14359999

# c# - 在 select 语句中声明显式类型而不是 var

> ID：14359007
> 
> 赞同：2
> 
> 时间：2013-01-16T12:55:32.460
> 
> 标签：c#, linq

我正在执行以下请求。它按预期工作并返回结构正确的数据。（它创建一个“head”对应于公共字段的元素，并将该字段中具有相同值的所有元素作为“tail”中的一个数组。）

```
var result
  = from A in As
    group A by A.F into B
    select new 
    {
      F1 = B.Key,
      F2 = from A in As
           where A.F == B.Key
           select A
    }; 
```

现在我想明确声明它的类型。我已经在调试器中检查了我对类型的假设是正确的，但是，当我尝试声明它时，它给了我转换错误。

1.  为什么？
2.  如何显式声明类型？

我尝试了不同的声明变体，*但*失败了。

```
IEnumerable<Tuple<String, IEnumerable<MyType>>> result 
  = from ...
    } as Tuple<String, MyType>; 
```

我知道这是可行的，但我缺乏正确的经验。我注意到以下工作。但是，我不确定如何更进一步，将*Object*交换为实际的变量类型。

```
IEnumerable<Object> result 
  = from ...
    } as Object; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T12:58:58.983

产生的可枚举序列的类型由`select`子句后面的表达式的类型决定，所以：

```
select Tuple.Create(
    B.Key,
    (from A in As where A.F == B.Key select A).ToList()
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:02:58.320

`Tuple<String, IEnumerable<MyType>> <=> Tuple<String, MyType>`起初是这个，但问题不在这里，你不能将匿名类型转换为`Tuple`. 您必须明确定义类型然后使用它。

```
public class YourClass
{
    public string F1 {get; set;}
    public IEnumerable<MyType> F2 {get; set;}
} 

IEnumerable<YourClass> result
  = from A in As
    group A by A.F into B
    select new YourClass
    {
      F1 = B.Key,
      F2 = from A in As
           where A.F == B.Key
           select A
    }; 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:03:07.820

由于您使用 select new {... } 创建匿名类型，因此您必须使用 var。没有办法明确地表达类型。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:04:11.307

您不能显式声明类型，因为通过说

```
select new {
   Member = Value
} 
```

您正在使用**匿名类型**- 此类类型具有无法说出的名称，因此这是您*必须*使用的情况之一`var`。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T13:07:02.697

尽管您知道“内部”对象是相同的，但 C# 是静态类型的，并根据其元数据（名称、命名空间...）而不是其成员来解析类型。您选择匿名类型，而不是 a `Tuple`，因此类型解析器无法“同意”将其用作`Tuple`.

如果您将鼠标悬停`var`在 Visual Studio 中的关键字上，它将告诉您它是什么类型（因为在编译时必须知道它，除非它是 a `dynamic`）。但是，由于您使用的是匿名类型，因此您将无法显式编写该类型 - 它在 C# 源代码中没有名称。

您可能会做的是在别处定义类型

```
internal class MyObj
{
    public MyObj(string head, IEnumerable<Foo> tail)
    {
        Head = head;
        Tail = tail;
    }

    public string Head { get; set; }
    public IEnumerable<Foo> Tail { get; set; }
} 
```

然后在您的查询中使用它：

```
IEnumerable<MyObj> result
  = from A in As
    group A by A.F into B
    select new MyObj(
        B.Key,
        from A in As
        where A.F == B.Key
        select A); 
```

或`Tuple`按照 Jon 的建议**[使用](https://stackoverflow.com/a/14359066/1659828)**a 。

# forms - 使用 OATS 的 Oracle 表单自动化

> ID：14359008
> 
> 赞同：-1
> 
> 时间：2013-01-16T12:55:35.083
> 
> 标签：forms, oracle, testing, automation

我们正在尝试使用 OATS 记录 Oracle 11i 表单，当表单从 Web 界面启动时浏览器崩溃。即使我们也无法捕获元素 ID。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2016-05-19T13:34:45.413

我在不同项目中与 OATS 合作超过 6 年以上时遇到过此类问题 :)

主要原因之一是要安装正确的 JInitiator，我建议使用 OATS 12.1 版本，因为我们成功地使用了它，尤其是与 Oracle 11i Forms 一起使用。

我还建议在继续之前执行以下操作：

1.  如果安装了任何其他 java，则清除 Java 缓存。
2.  清除 JInitiator 缓存
3.  确保[Openscript IDE 始终以管理员身份运行](http://www.testingtools.co/automation/internet-explorer-crashing-when-recording-with-openscript)。
4.  清除临时文件夹中的所有文件和文件夹
5.  清除 %APPDATA% 中的 java 相关文件夹
6.  清除浏览器缓存

我建议您通过[OATS 与 JAVA、操作系统和浏览器的兼容性](http://www.testingtools.co/automation/oats-versions-compatibility-matrix-for-java-and-browsers-and-operating-systems)

如果您可以进行屏幕共享，我也可以帮助您解决此问题，我已经为很多人这样做了。联系我@ testingtools.co 博客

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2017-03-09T09:39:39.420

现在可能是它的老问题了......但只是发布它可以帮助有需要的人使用 OATS 使 Oracle 11i Form 自动化

安装 Oracle OATS 12.5 版本

```
Pre-condtion: 
Install Java JRE 1.7 version 69 or 71 or 79 (No JDK required)

    Step1: Install oracle 11g Data base
    Step2: Download OATS setup from Oracle site and perform custom install
    Step3: Install rest of the Components except Data base
    Step4: While Performing custom installation enter data base credentials entered while step 2

Post Condition:
1\. Enable Enterprise mode
2\. Make sure all three services running OracteATS agent, Oracle ATS Server, Oracle ATS Server
3\. In IE disable XSS Filter for all internet zones 
```

如果有人面临 OATS 安装问题并且无法识别表单，请告诉我。

欲了解更多信息，请访问[www.testinghive.com](http://www.testinghive.com)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-01-21T06:52:44.537

通常应用程序需要一些时间来加载，并且在加载时，它可能会通过一些超时或形成加载异常。

您可以通过更改 OpenScript 播放设置（在 openscript 开发人员角度）来覆盖它 -

工具 -> Openscript 首选项

在回放 - 错误恢复 ->（向下滚动）Oracle EBS/Forms 功能测试下

更改表单连接错误 - > 忽略（默认失败）

这将确保 OpenScript 等待表单加载，忽略所有超时和其他表单加载相关异常。

或者，您可以使用错误恢复方法来实现相同的目的 - getSettings().setErrorRecovery()

注意 - 请有一些时间限制来检查表单是否以最长时间加载。否则，如果由于 IE/Java 问题而无法加载表单，则可能会导致一些无限循环。

希望这对您的问题有所帮助！

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-09-12T01:43:32.697

需要安装 Jinitiator 1.3.1.30 和最新的 OATS 版本 12.2.0.1。使用 IE 最新版本 8 或更高版本。要捕获元素 id，此过程运行良好。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2014-04-11T04:24:29.707

每次在运行脚本之前，通过 Windows 任务管理器杀死系统中运行的所有 JRE 进程，并且始终强烈建议您以管理员身份运行 Openscript。

# php - 添加指向 HTML 提交按钮的链接

> ID：14359009
> 
> 赞同：1
> 
> 时间：2013-01-16T12:55:43.407
> 
> 标签：php, html

我刚刚进入 mysql，我正在创建一个基本的注册页面。但是，当我单击提交时，我想被定向到另一个页面，比如说您登录的页面，就像许多网站一样。

我如何允许提交按钮链接到新页面。我知道这将是一些简单的事情，但我已经看过并且似乎找不到太多关于它的内容。

这是我尝试过的当前代码：

```
<html>

<head>
    <title>MySQL Test - Registration</title>
    <script LANGUAGE="JavaScript">
        function testResults() {
        window.document.location.href = "http://www.google.com";
        }
    </script>
</head>

<body>
    <form action = "rego.php" method = "POST">
        Username:<br/>
        <input type = "text" name = "username"/><br/>
        Password:<br/>
        <input type = "password" name = "password"/><br/>
        Confirm Password:<br/>
        <input type = "password" name = "passvery"/><br/>
        Email:<br/>
        <input type = "text" name = "email"/><br/><br/>

        Please select your gender:<br/>
        <input type = "radio" name = "gender" value = "male"/>Male &nbsp&nbsp&nbsp&nbsp&nbsp
        <input type = "radio" name = "gender" value = "female"/>Female<br/><br/>

        <input type = "checkbox" name = "agree" value = "agree"/>I agree to the terms and conditions.<br/>
        <br/>
        <input type = "submit" value = "Sign Up!" onclick = "javascript:testresults()" />

    </form>
</body>
</html> 
```

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T12:58:37.170

Form action="rego.php" 表示您的表单将提交到该文件。

如果你想在 rego.php 之后去其他地方，你应该在任何输出之前从该文件重定向，例如使用位置标头：

```
// do stuff (registration)

header("Location: another-php.php"); 
```

# php - 使用查询在 php 页面上重写 Mod

> ID：14359022
> 
> 赞同：-2
> 
> 时间：2013-01-16T12:56:48.840
> 
> 标签：php, .htaccess, url, mod-rewrite

我在笔记本电脑上安装了 XAMPP，并激活并运行了 Mod Rewrite。我的网站上有一个页面如下：

```
http://localhost/TripMan/staff/viewstudent.php?id=2 
```

我想让它在人们访问上面的 URL 时显示为：

```
http://localhost/TripMan/staff/studentinfo/2 
```

我将如何编写重写规则来做到这一点？我以前从未使用过此功能。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:02:41.250

您需要使用`.htaccess`这样的文件：

```
# Turn on the rewrite engine
RewriteEngine On

# Set student rewrite
RewriteRule ^TripMan/staff/studentinfo/([0-9]*)/?$ TripMan/staff/viewstudent.php?id=$2 [NC,QSA] 
```

# iphone - 如何将多个联系人插入 ABAddressbook？

> ID：14359023
> 
> 赞同：0
> 
> 时间：2013-01-16T12:56:48.933
> 
> 标签：iphone, ios, contacts, abaddressbook

我需要将 25000 个联系人插入 iPhone 联系人，就我编写的代码而言，它在模拟器上运行良好，这可以在几分钟内实现。但是当我在 iPhone 4s 上导入它时，需要 3 个多小时，而且只有部分联系人被保存，然后应用程序被关闭。

帮助我用一种简单的方法将多条记录插入地址簿...

这是我的一段代码...

```
for (int i = 0; i < [contactNameArray count]; i++) {
    //Create new person and save to this group
    ABRecordRef record = ABPersonCreate();
    BOOL isSuccess ;
    NSString *firstname = [NSString stringWithFormat:@"%@",[contactNameArray objectAtIndex:i]];
    isSuccess  = ABRecordSetValue(record, kABPersonFirstNameProperty,(__bridge CFStringRef)firstname, &error); 
    isSuccess  = ABRecordSetValue(record, kABPersonLastNameProperty,CFSTR("Custom Contacts"), &error); 

    ABMutableMultiValueRef copyOfPhones = ABMultiValueCreateMutable(kABPersonPhoneProperty);
    NSString *phonenumber = [NSString stringWithFormat:@"%@",[contactPhoneArray objectAtIndex:i]];
    CFTypeRef phone= (__bridge CFStringRef)phonenumber;
    ABMultiValueAddValueAndLabel(copyOfPhones, phone,kABPersonPhoneMobileLabel,NULL);
    isSuccess = ABRecordSetValue(record, kABPersonPhoneProperty, copyOfPhones, &error);
    CFRelease(copyOfPhones);

    ABMutableMultiValueRef multiEmail = ABMultiValueCreateMutable(kABMultiStringPropertyType);
    NSString *emailid = [NSString stringWithFormat:@"%@",[contactEmailArray objectAtIndex:i]];
    CFTypeRef email= (__bridge CFStringRef)emailid;
    ABMultiValueAddValueAndLabel(multiEmail, email, kABWorkLabel, NULL);
    ABRecordSetValue(record, kABPersonEmailProperty, multiEmail, &error);
    CFRelease(multiEmail);

    isSuccess = ABAddressBookAddRecord(ab, record, &error);
    isSuccess = ABAddressBookSave(ab, &error);

    ABGroupAddMember(group, record, &error);

    NSLog(@"is success %d", isSuccess);

    ABAddressBookSave(ab, &error);
} 
```

提前致谢....

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:00:23.710

首先使用快速枚举。

然后批量保存联系人，并在批量结束时将计数器编号保存到用户默认值或任何位置。这将阻止您再次重新开始应对过程。

# android - 加载位图时出现内存不足错误

> ID：14359024
> 
> 赞同：17
> 
> 时间：2013-01-16T12:56:51.243
> 
> 标签：android, bitmap, out-of-memory

我有一个带有 3 个活动的 android 应用程序：

A1 --*开始*--> A2 --*开始*--> A3 --*完成他的过程时：开始*--> A1

（所以我没有“finish();”一个应用程序。我在用户交互后的整个时间内用“startActivity(..);”开始下一个活动）

所以在这 3 个活动中有一个循环。在每个活动中，我显示位于 SD 卡上的 3-9 张图片，我使用以下功能加载这些图片：

```
try
{
    Uri selectedImageURI = Uri.parse(strImagePath);
    File imgFile = new  File(getRealPathFromURI(selectedImageURI, c));
    Bitmap myBitmap = BitmapFactory.decodeFile(imgFile.getAbsolutePath());
    ivTmp.setImageBitmap(myBitmap);
}catch (Exception e)
{
    return null;
} 
```

这一切都有效。但有时（在我的活动循环几次之后），我的应用程序崩溃了..

Logcat 告诉我：

```
01-16 13:42:15.863: DEBUG/dalvikvm(23161): GC_BEFORE_OOM freed 10K, 9% free 59019K/64400K, paused 29ms, total 30ms
01-16 13:42:15.863: ERROR/dalvikvm-heap(23161): Out of memory on a 8018704-byte allocation.
01-16 13:42:15.863: ERROR/AndroidRuntime(23161): FATAL EXCEPTION: main
        java.lang.OutOfMemoryError
        at android.graphics.BitmapFactory.nativeDecodeAsset(Native Method)
        at android.graphics.BitmapFactory.decodeStream(BitmapFactory.java:502)
        at android.graphics.BitmapFactory.decodeResourceStream(BitmapFactory.java:355)
        at android.graphics.drawable.Drawable.createFromResourceStream(Drawable.java:785)
        at android.content.res.Resources.loadDrawable(Resources.java:1965)
        at android.content.res.Resources.getDrawable(Resources.java:660)
        at android.widget.ImageView.resolveUri(ImageView.java:616)
        at android.widget.ImageView.setImageResource(ImageView.java:349)
        at <MyApp>.MyActivity$6.run(MyActivity.java:143)
        at android.os.Handler.handleCallback(Handler.java:725)
        at android.os.Handler.dispatchMessage(Handler.java:92)
        at android.os.Looper.loop(Looper.java:137)
        at android.app.ActivityThread.main(ActivityThread.java:5039)
        at java.lang.reflect.Method.invokeNative(Native Method)
        at java.lang.reflect.Method.invoke(Method.java:511)
        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)
        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)
        at dalvik.system.NativeStart.main(Native Method) 
```

有人可以给我一些提示如何处理崩溃？也许是因为我的活动设置为“暂停”而不是正确关闭它们？

* * *

## 回答 #1

> 赞同：32
> 
> 时间：2013-01-16T13:05:35.960

为了快速修复，您可以添加

`android:largeHeap="true"`在您的清单应用程序标签中

[链接在这里：](http://developer.android.com/guide/topics/manifest/application-element.html)

我在kindle和nook的桌子上遇到OOM问题

```
Heap size (large)
android:largeHeap="true" 
```

这里提到了使用更大的堆[链接的规范：](https://developer.amazon.com/sdk/fire/specifications.html)

**编辑：**在此处使用缓存位图技术[链接](http://developer.android.com/training/displaying-bitmaps/cache-bitmap.html)

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-03-01T17:33:25.283

我在显示高分辨率图像时遇到了类似的问题。我已经搜索并应用了[http://developer.android.com/training/displaying-bitmaps/index.html](http://developer.android.com/training/displaying-bitmaps/index.html)中给出的所有 android 位图解决方案，以下缓存机制在链接中。但它们都不起作用。任何地方都没有任何正确的解决方案。然后我发现问题是：我无法正确使用可绘制文件夹结构。我将高分辨率图像保存在 mdpi 和 hdpi 文件夹中。这会导致 android 将图像放大到超大尺寸。由于 android 监视器/内存部分，100 kb 图像导致内存增加 20 mb。所以我将这些超分辨率图像添加到 xxhdpi 文件夹中，然后它突然被修复了。然后我的图像滑块完美地工作

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:07:55.190

是的，当活动对用户不可见时，android 不会立即销毁活动，但是根据当前状态调用了许多生命周期方法。查看[http://developer.android.com/guide/components/activities.html#Lifecycle](http://developer.android.com/guide/components/activities.html#Lifecycle)

您可以尝试在 onStop() 或 onDestroy() 中完成活动，因为它们将分别在活动不可见和系统内存不足时调用。:-)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:29:54.860

这是由于图像的高分辨率，您必须使用以下代码缩放位图

```
 Bitmap myBitmap = BitmapFactory.decodeFile(imgFile.getAbsolutePath());

    int h = 100; // height in pixels
    int w = 100; // width in pixels
Bitmap photoBitMap = Bitmap.createScaledBitmap(myBitmap,h, w, true);
ivTmp.setImageBitmap(photoBitMap); 
```

# c# - 算术运算导致溢出错误 c#

> ID：14359027
> 
> 赞同：0
> 
> 时间：2013-01-16T12:56:57.037
> 
> 标签：c#, exception-handling, try-catch, overflowexception

您好，我正在使用 c# 构建一个应用程序以连接到远程 mysql 服务器。

这是代码：

```
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;
using MySql.Data.MySqlClient;

namespace login
{
    public partial class Form1 : Form
    {
        public Form1()
        {
            InitializeComponent();
        } 

        private void button1_Click(object sender, EventArgs e)
        {
            if (tryLogin(textBox1.Text, textBox2.Text) == true)
            {
                MessageBox.Show("Authed!");
            }
            else
            {
                MessageBox.Show("Auth Failure.");

            }

        }
        public bool tryLogin(string username, string password)
        {
MySqlConnection con = new MySqlConnection("host=myhostname;user=myusername;password=mypassword;database=mydatabase;");
MySqlCommand cmd = new MySqlCommand("SELECT * FROM test WHERE username = '" + username + "' AND password = '" + password + "';");
            cmd.Connection = con;
            con.Open();
            MySqlDataReader reader = cmd.ExecuteReader();
            if (reader.Read() != false)
            {
                if (reader.IsDBNull(0) == true)
                {
                    cmd.Connection.Close();
                    reader.Dispose();
                    cmd.Dispose();
                    return false;
                }
                else
                {
                    cmd.Connection.Close();
                    reader.Dispose();
                    cmd.Dispose();
                    return true;

                }
            }
            else
            {
                return false;
            }
        }
    }
} 
```

它显示以下错误：

“溢出异常未处理

算术运算导致溢出"

我在这里没有使用任何算术运算。有什么帮助吗？？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:19:01.497

检查中的`test`表`mysql server`。

`username`确保所有字段在和`password`列中都有有效值。

**更新**

尝试在`"Use Pipe=false;"`您的连接字符串中包含该选项。然后它将很好地打开连接。

我希望这对你有帮助。

# google-app-engine - AttributeError：尝试在谷歌应用引擎上完成 blobstore 文件时，“实体”对象没有属性“_to_pb”

> ID：14359028
> 
> 赞同：1
> 
> 时间：2013-01-16T12:56:57.970
> 
> 标签：google-app-engine, blobstore

**[更新]**

我应该注意到这是在事务中发生的，并且这个错误是在 dev_appserver 上生成的。~~我没有在生产环境中测试过。~~这似乎不会在生产中发生。

**[/更新]**

我不确定我在这里做错了什么；我的代码几乎与文档示例相同。

我的代码：

```
filename = files.blobstore.create(mime_type='application/octet-stream')
with files.open(filename, 'a') as f:
    f.write(json.dumps(oldblocks, separators=(',', ':')))
files.finalize(filename) 
```

堆栈跟踪：

```
WARNING  2013-01-16 12:37:49,648 tasklets.py:409] suspended generator transaction(context.py:932) raised AttributeError('Entity' object has no attribute '_to_pb')
ERROR    2013-01-16 12:37:49,648 webapp2.py:1552] 'Entity' object has no attribute '_to_pb'
Traceback (most recent call last):
  File "/home/rye/local/share/google_appengine/lib/webapp2/webapp2.py", line 1535, in __call__
    rv = self.handle_exception(request, response, e)
  File "/home/rye/local/share/google_appengine/lib/webapp2/webapp2.py", line 1529, in __call__
    rv = self.router.dispatch(request, response)
  File "/home/rye/local/share/google_appengine/lib/webapp2/webapp2.py", line 1278, in default_dispatcher
    return route.handler_adapter(request, response)
  File "/home/rye/local/share/google_appengine/lib/webapp2/webapp2.py", line 1102, in __call__
    return handler.dispatch()
  File "/home/rye/local/share/google_appengine/lib/webapp2/webapp2.py", line 572, in dispatch
    return self.handle_exception(e, self.app.debug)
  File "/home/rye/local/share/google_appengine/lib/webapp2/webapp2.py", line 570, in dispatch
    return method(*args, **kwargs)
  File "/home/rye/Dropbox/projects/web/voxwright/voxwright.py", line 202, in put
    result = saveProject(data['id'], data['blocks'])
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/model.py", line 3583, in inner_transactional_wrapper
    return transaction(f, **ctx_options)
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/utils.py", line 136, in positional_wrapper
    return wrapped(*args, **kwds)
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/model.py", line 3526, in transaction
    return fut.get_result()
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/tasklets.py", line 325, in get_result
    self.check_success()
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/tasklets.py", line 371, in _help_tasklet_along
    value = gen.send(val)
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/context.py", line 923, in transaction
    result = callback()
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/model.py", line 3582, in <lambda>
    f = lambda: func(*args, **kwds)
  File "/home/rye/Dropbox/projects/web/voxwright/voxwright.py", line 102, in saveProject
    files.finalize(filename)
  File "/home/rye/local/share/google_appengine/google/appengine/api/files/file.py", line 568, in finalize
    f.close(finalize=True)
  File "/home/rye/local/share/google_appengine/google/appengine/api/files/file.py", line 291, in close
    self._make_rpc_call_with_retry('Close', request, response)
  File "/home/rye/local/share/google_appengine/google/appengine/api/files/file.py", line 427, in _make_rpc_call_with_retry
    _make_call(method, request, response)
  File "/home/rye/local/share/google_appengine/google/appengine/api/files/file.py", line 250, in _make_call
    rpc.check_success()
  File "/home/rye/local/share/google_appengine/google/appengine/api/apiproxy_stub_map.py", line 570, in check_success
    self.__rpc.CheckSuccess()
  File "/home/rye/local/share/google_appengine/google/appengine/api/apiproxy_rpc.py", line 156, in _WaitImpl
    self.request, self.response)
  File "/home/rye/local/share/google_appengine/google/appengine/api/apiproxy_stub.py", line 125, in MakeSyncCall
    method(request, response)
  File "/home/rye/local/share/google_appengine/google/appengine/api/files/file_service_stub.py", line 652, in _Dynamic_Close
    self.open_files[filename].finalize()
  File "/home/rye/local/share/google_appengine/google/appengine/api/files/file_service_stub.py", line 596, in finalize
    datastore.Put(blob_info)
  File "/home/rye/local/share/google_appengine/google/appengine/api/datastore.py", line 579, in Put
    return PutAsync(entities, **kwargs).get_result()
  File "/home/rye/local/share/google_appengine/google/appengine/api/datastore.py", line 556, in PutAsync
    return _GetConnection().async_put(config, entities, local_extra_hook)
  File "/home/rye/local/share/google_appengine/google/appengine/datastore/datastore_rpc.py", line 1542, in async_put
    pbs = [self.__adapter.entity_to_pb(entity) for entity in entities]
  File "/home/rye/local/share/google_appengine/google/appengine/ext/ndb/model.py", line 562, in entity_to_pb
    pb = ent._to_pb()
AttributeError: 'Entity' object has no attribute '_to_pb' 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:11:38.057

这看起来与我提出的相同错误：[http](http://code.google.com/p/googleappengine/issues/detail?id=8354) ://code.google.com/p/googleappengine/issues/detail?id=8354 主演，也许评论说它不仅仅是`get_serving_url`触发它，会让谷歌知道这很重要！（目前，我的 blob 处理、事务包装代码周围散布着 is_sdk 检查，这太可怕了。）

# c# - 无法使用 Response.Write() 打印整数值

> ID：14359029
> 
> 赞同：0
> 
> 时间：2013-01-16T12:56:58.420
> 
> 标签：c#, asp.net, variables, integer, response

我有以下代码打印一些列表。该列表正在打印，但整数变量 i 的值未打印。

```
<%
int i = 1;
try
{
    foreach (LElement r in LElements)
    {
        Response.Write("<br/><div style=\"font-size:small\">");
        Response.Write("Element "+i+"="+r.name);
        Response.Write("</div>");
        i++;
    }
    Response.Write("<br/>");
}
catch (Exception)
{
    Response.Write("Error");
}
%> 
```

它只是打印

元素 = ABC

元素 = XYZ

等等...

生成的 HTML 有点像这样：

```
<br/><div style="font-size:small">Element = ABC</div>
<br/><div style="font-size:small">Element = XYZ</div>
<br/><div style="font-size:small">Element = PQR</div><br/> 
```

请告诉我这段代码有什么问题？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:19:35.853

我已经尝试重现您的问题，但不能，所以我猜测您的示例代码与您的真实代码完全不同，或者正在发生更深层次的事情？这就是我所做的并且工作正常，因此您可以以此为起点，告诉我们它是否比您的代码更有效，并且可能会突出您所犯的任何错误？

```
<%    
    string[] data = { "ABC", "DEF", "GHI", "XYZ" };
    int i = 1;

    try
    {
        foreach(string item in data)
        {
            Response.Write("<br/><div style=\"font-size:small\">");
            Response.Write(String.Format("Element {0} = {1}", i, item));
            Response.Write("</div>");
            i++;
        }
        Response.Write("<br/>");
    }
    catch (Exception) 
    { 
        Response.Write("Error");
    }
%> 
```

PS我已经将输出包装成a `String.Format`，这将确保它被正确地转换为字符串。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T13:00:28.920

```
Response.Write(String.Format("Element {0} = {1}", i, r.name)); 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T13:00:54.090

试试这个：

```
Response.Write(String.Format("Element {0} = {1}", i, r.name)); 
```

**编辑：** Zarathos 领先于我 :)

# php - 如何在magento中创建基于属性的产品？

> ID：14359031
> 
> 赞同：0
> 
> 时间：2013-01-16T12:57:07.413
> 
> 标签：php, magento

我需要根据交付系统的重量和尺寸设置产品，因此我创建了 5 个示例产品，每个产品都根据它们的 w&d 具有不同的属性。然后每次当管理员从那些客户下订单（添加到购物车）时基于 w&d 的产品。现在我面临的问题是如何为每个客户更改产品或订单的图像和描述，我放置了这个图像和描述因每个客户而异。有没有办法做到。我愿意接受任何建议来实现这一点，如果需要，也可以使用 php 和 js。谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:11:32.290

您已经通过说“每个客户的图像和描述都不同”自己解决了这个问题，因此添加包含此信息的客户属性是有意义的。您必须修改 .phtml 文件中的内容才能使其完全正常工作。

此外，如果您包含您已经尝试过的内容，那就太好了。

# jquery - 使用 ID 分隔类

> ID：14359033
> 
> 赞同：0
> 
> 时间：2013-01-16T12:57:10.080
> 
> 标签：jquery

我有两张图片，其中 DIV 在悬停时显示，显示一些用户信息。它的外观符合预期，但我不知道如何只在悬停的图像上显示信息。

我怎样才能做到这一点？

这是代码的实时工作示例：http: [//jsfiddle.net/uvHw4/](http://jsfiddle.net/uvHw4/)

原始 JavaScript 代码：

```
$(document).ready(function() {
    $('.start_profile_container_text').hide();
    $('.start_profile_container').mouseenter(function() {
        $('.start_profile_container_text').show('slide', { direction: "down"} ,'fast');
    });

    $('.start_profile_container').mouseout(function() {
        $('.start_profile_container_text').hide('slide', { direction: "down"} ,'fast');
    });

}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:02:38.320

将您的脚本更改为：

```
$(document).ready(function () {
  $('.start_profile_container_text').hide();

  $('.start_profile_container').mouseenter(function () {
    $('.start_profile_container_text', this).show('slide', {
      direction: "down"
    }, 'fast');
  });

  $('.start_profile_container').mouseout(function () {
    $('.start_profile_container_text', this).hide('slide', {
      direction: "down"
    }, 'fast');
  });

}); 
```

与您的代码的区别只是将 this 添加到显示/隐藏函数以与实际元素相关。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:01:00.510

将上下文中的当前对象传递给后代中的元素。

**[现场演示](http://jsfiddle.net/rajaadil/uvHw4/5/)**

```
 $('.start_profile_container').mouseenter(function () {
    $('.start_profile_container_text', this).show('slide', {
      direction: "down"
    }, 'fast');
  }); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:01:53.130

```
$(document).ready(function () {
  $('.start_profile_container_text').hide();

  $('.start_profile_container').mouseenter(function () {
    $('.start_profile_container_text', this).show('slide', {
      direction: "down"
    }, 'fast');
  });

  $('.start_profile_container').mouseleave(function () {
    $('.start_profile_container_text', this).hide('slide', {
      direction: "down"
    }, 'fast');
  });

}); 
```

使用上下文`.start_profile_container_text`仅在悬停的 div 内查找：`$('.start_profile_container_text', this)`这是一个指向当前 div 的元素。

另外，请参阅我已经替换`mouseout`为`mouseleave`应该比哪个更好`mouseout`（文本不会上下跳跃。不同之处在于，`mouseout`即使鼠标移动到子元素也会发生这种情况，并且`mouseleave`如果从元素移动到其子元素则不会发生）

演示：http: [//jsfiddle.net/uvHw4/1/](http://jsfiddle.net/uvHw4/1/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T13:02:35.577

尝试使用 children() 演示：http: [//jsfiddle.net/gDZey/](http://jsfiddle.net/gDZey/)

```
$(this).children('.start_profile_container_text').show('slide', {
  direction: "down"
}, 'fast'); 
```

我建议在这种情况下使用[http://api.jquery.com/hover/](http://api.jquery.com/hover/)。

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2013-01-16T13:04:10.797

```
$(document).ready(function () {
  $('.start_profile_container_text').hide();

  $('.start_profile_container').hover(function () {
    $(this).find('.start_profile_container_text').show('slide', {
      direction: "down"
    }, 'fast');
  },

  function () {
    $(this).find('.start_profile_container_text').hide('slide', {
      direction: "down"
    }, 'fast');
  });

}); 
```

此代码工作正常。我建议使用`hover`而不是`mouseenter`and `mouseout`。

这是演示[http://jsfiddle.net/uvHw4/3/](http://jsfiddle.net/uvHw4/3/)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2013-01-16T13:06:26.963

你可以使用[hover()](http://api.jquery.com/hover/)而不是两个函数..

```
$('.start_profile_container').hover(
   function () {
      $('.' + this.className +'_text', this).show('slide', { direction: "down"}, 'fast');
   },
   function () {
      $('.' + this.className +'_text', this).hide('slide', {direction: "down"}, 'fast');
   }
); 
```

# java - 多个客户端 - java中的服务器

> ID：14359036
> 
> 赞同：1
> 
> 时间：2013-01-16T12:57:33.073
> 
> 标签：java, multithreading, sockets, networking, executorservice

我正在使用套接字编写多个客户端-java 中的服务器应用程序。我编写了简单的客户端-服务器应用程序，一切正常，但是当我尝试将其更改为多客户端应用程序时，当我启动客户端时出现异常：

```
Exception in thread "pool-1-thread-1" java.lang.NullPointerException
    at MiniSerwer.run(Serwer.java:110)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1110)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679) 
```

我还有两个类（线程 - InWorker 和 OutWorker 用于输入和输出）。

Serwer.java（没有 InWorker 和 OutWorker）：

```
public class Serwer {
Serwer(int port) {
ServerSocket serversocket=null;
ExecutorService exec= Executors.newCachedThreadPool();

    try {
        serversocket=new ServerSocket(port);
    } catch (IOException e) {
        e.printStackTrace();
}
    while(true) {
    Socket socket=null;
    try {
        socket = serversocket.accept();
    } catch (IOException e) {
        e.printStackTrace();
    }
    exec.execute(new MiniSerwer(socket)); // create new thread
        }
} } 
```

MiniSerwer - 为每个客户端创建拥有线程的助手类

```
class MiniSerwer implements Runnable{

    Socket socket=null;
    ExecutorService exec=null;
    ObjectOutputStream oos=null;
    ObjectInputStream ois=null;

    MiniSerwer(Socket socket) {
        this.socket=socket;
        try {
            oos=new ObjectOutputStream(socket.getOutputStream());
            oos.flush();
            ois=new ObjectInputStream(socket.getInputStream());
        } catch (IOException e) {
            e.printStackTrace();
        }
    }

    public void run() {
        while(true) {
            exec.execute(new InWorker(socket, ois)); // input stream
            exec.execute(new OutWorker(socket, oos)); //output stream
            Thread.yield();
        }
    }
} 
```

我改变了我的程序，但它仍然不起作用。还有什么建议吗？

服务器：

```
public class Serwer implements Runnable{

ServerSocket serversocket=null;
ExecutorService exec= Executors.newCachedThreadPool();
int port;

Serwer(int port) {
    this.port=port;
}

public void run() {
    try {
        serversocket=new ServerSocket(port);
        while(true) {
            Socket socket=null;
            try {
                socket = serversocket.accept();
                exec.execute(new MiniSerwer(socket)); // create new thread
            } catch (IOException e) {
                e.printStackTrace();
                throw new RuntimeException(e);
            }
        }
    } catch (IOException e) {
        e.printStackTrace();
}
}

public static void main(String[] args) {
    int port;
    Scanner in = new Scanner(System.in);
    System.out.println("Enter the port:");
    port = in.nextInt();
    ExecutorService exec=Executors.newCachedThreadPool();
    exec.execute(new Serwer(port));
}   
 } 
```

迷你服务器：

```
class MiniSerwer implements Runnable{

    Socket socket=null;
    ExecutorService exec=Executors.newCachedThreadPool();
    ObjectOutputStream oos=null;
    ObjectInputStream ois=null;

    MiniSerwer(Socket socket) {
        this.socket=socket;
    }

    public void run() {
        try {
            oos=new ObjectOutputStream(socket.getOutputStream());
            oos.flush();
            ois=new ObjectInputStream(socket.getInputStream());
        } catch (IOException e) {
            e.printStackTrace();
        }
        while(true) {
            exec.execute(new InWorker(socket, ois)); // input stream
            exec.execute(new OutWorker(socket, oos)); //output stream
            Thread.yield();
        }
    }
} 
```

当我尝试从客户端向服务器发送消息时，我有很多例外。

2 秒。在服务器端连接后（我什么都不发送）：

```
Exception in thread "pool-2-thread-1" java.lang.OutOfMemoryError: unable to create new native thread
    at java.lang.Thread.start0(Native Method)
    at java.lang.Thread.start(Thread.java:657)
    at java.util.concurrent.ThreadPoolExecutor.addWorker(ThreadPoolExecutor.java:943)
    at java.util.concurrent.ThreadPoolExecutor.processWorkerExit(ThreadPoolExecutor.java:992)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:603)
    at java.lang.Thread.run(Thread.java:679) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:07:30.217

你的执行者服务，在你的`MiniSerwer`类中，永远不会被初始化。这就是你的 NPE 的根本原因。

但就像我在评论中提到的那样，你不应该`Serwer`在它的构造函数中做所有的逻辑。该对象永远不会完全初始化，因为您永远不会退出构造函数。使整个类 Runnable 并将该逻辑移至被覆盖的`run`方法。然后添加一个`main`用于实际实例化/运行服务器的方法。

此外，在您的 中`MiniSerwer`，您的流初始化可能会失败。在 run 方法中使用流之前，您需要验证流不为空。或者只是将它们的初始化逻辑移到 run 方法的开头。

*编辑*

您的实现中还有一个错误`MiniSerwer`，您产生了无限数量的线程来处理对象输入和输出流：

```
while(true) {
    exec.execute(new InWorker(socket, ois)); // input stream
    exec.execute(new OutWorker(socket, oos)); //output stream
    Thread.yield();
} 
```

您将耗尽线程，耗尽内存，或两者兼而有之。老实说，您的解决方案设计过度，我怀疑 In 和 Out 工作人员是否真的需要像您现在拥有的那样分开。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:03:48.333

永远不要做这么可怕的事情。在下面的代码中，您两次忽略了异常：

首先忽略：

```
try {
    serversocket=new ServerSocket(port);
} catch (IOException e) {
    e.printStackTrace();
} 
```

之后`serversocket`可能`null`和以前一样

第二个忽略：

```
while(true) {
    Socket socket=null;
    try {
       socket = serversocket.accept();
     } catch (IOException e) {
        e.printStackTrace();
     }
     exec.execute(new MiniSerwer(socket)); // create new thread
} 
```

之后`try...catch` `socket`也可以`null`像以前一样。

**这两件事都**可能导致**`NullPointerException` **！****

 **像这样修复它：

```
try {
    serversocket=new ServerSocket(port);
    while(true) {
        Socket socket=null;
        try {
            socket = serversocket.accept();
            exec.execute(new MiniSerwer(socket)); // create new thread
        } catch (IOException e) {
            e.printStackTrace();
            throw new RuntimeException(e);
        }
    }
} catch (IOException e) {
    e.printStackTrace();
} 
```

* * *

**UPD：**这一个：`while(true) {...}`也是可怕的事情。但是让我们在这个问题的括号之后留下这个。

* * ***

# java - 如何将“String HH:MM”转换为“int hour HH”和“int minute MM”

> ID：14359037
> 
> 赞同：2
> 
> 时间：2013-01-16T12:57:34.427
> 
> 标签：java, android, datetime

我有这个代码。我需要将`string` **“horaTarefa HH:MM”**转换为`int` **“hour = HH”**和`int` **“minute = MM”**

我想我可以用**"dateTarefa DD/MM/YYYY"**做同样的事情吗？

```
SQLiteDatabase db;
db = openOrCreateDatabase("AgendadorTarefas.db",SQLiteDatabase.CREATE_IF_NECESSARY,null); { }

Cursor c = db.query("Tarefa", new String[] {
              "codTarefa", "dateTarefa", "horaTarefa", "textoTarefa"}, 
            null, null, null, null, null);

c.moveToFirst();

final ArrayList<String> result = new ArrayList<String>();

while(c.moveToNext())
{ 
    String Date = c.getString(1);
    String Hora = c.getString(2);
    String Texto = c.getString(3);
    result.add(Data + " às " + Hora + " \n" + Texto);
}

hour = Calendar.HOUR;
minute = Calendar.MINUTE;

c.close(); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T13:33:24.063

最好使用 dateformatter 而不是只解析整数。这样，您可以更好地控制时间和日期的外观（一位数是写成*05*还是*5*？时间是 12 小时还是 24 小时格式？...）

解析时间的简单代码如下所示：

```
try
{
    SimpleDateFormat format = new SimpleDateFormat("H:m");
    Date date = format.parse("15:34");
    int hours = date.getHours(); 
    int min   = date.getMinutes();
}
catch (ParseException e)
{
    // parsing failed
} 
```

有关格式参数的参考，请查看[SimpleDateFormat 文档](http://docs.oracle.com/javase/1.4.2/docs/api/java/text/SimpleDateFormat.html)

如果你真的想让你的应用程序国际化，你还应该考虑使用[日历](http://docs.oracle.com/javase/1.4.2/docs/api/java/util/Calendar.html)而不是像我在示例中所做的那样只使用日期。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T13:09:04.347

如果你知道小时/分钟/等的位置并且它总是相同的，你可以用 得到它`substring`，然后用它把它转换成数字`Integer.parseInt`

```
String Hora = "12:34";
int hour = Integer.parseInt(Hora.substring(0, 2));
int minute = Integer.parseInt(Hora.substring(3));

String Date = "12/34/5678";
int day = Integer.parseInt(Date.substring(0, 2));
int month = Integer.parseInt(Date.substring(3, 5));
int year = Integer.parseInt(Date.substring(6)); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-09-01T12:02:21.190

**date.getHours() 已弃用**，因此我选择使用日历和此问题的最佳答案来更新此问题的答案。

```
public static int getHour(String hourString) {
    SimpleDateFormat format = new SimpleDateFormat("HH:mm", Locale.US);
    try {
        Date date = format.parse(hourString);
        Calendar calendar = Calendar.getInstance();
        calendar.setTime(date);
        return calendar.get(Calendar.HOUR_OF_DAY);
    } catch (ParseException e) {
        return Integer.parseInt(hourString.substring(0, 2));
    }
} 
```

# c++ - 附加到 gzipped Tar-Archive

> ID：14359039
> 
> 赞同：4
> 
> 时间：2013-01-16T12:57:37.550
> 
> 标签：c++, compression, append, tar, zlib

我编写了一个程序，生成一个`tarball`，它被压缩`zlib`。
每隔一段时间，同一个程序应该向 tarball 添加一个新文件。

根据定义，tarball 需要`empty records`（512 字节块）在其结束时正常工作，这已经表明了我的问题。

根据文档`gzopen`无法以`r+`模式打开文件，这意味着我不能简单地跳转到空记录的开头，附加我的文件信息并用空记录再次密封。

现在，我无计可施。只要不涉及空记录，附加就可以与 zlib 一起正常工作，但我需要它们来“完成”我的压缩 tarball。

有任何想法吗？

啊，是的，如果我能避免解压缩整个东西和/或解析整个 tarball，那就太好了。

我也对我可以实现的其他（最好是简单的）文件格式而不是 tar 持开放态度。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T15:38:04.433

这是两个独立的问题，两者都是可以解决的。

首先是如何附加到 tar 文件。您需要做的就是用您的文件覆盖最后两个归零的 512 字节块。您将编写 512 字节的 tar 标头，将您的文件四舍五入为 512 字节块的整数，然后用 0 填充两个 512 字节块以标记 tar 文件的新结尾。

第二个是如何频繁地追加到一个 gzip 文件。最简单的方法是编写单独的 gzip 流并将它们连接起来。将最后两个 512 字节的零块写入单独的 gzip 流中，并记住从哪里开始。然后用带有新 tar 条目的新 gzip 流覆盖它，然后用两个末端块覆盖另一个 gzip 流。这可以通过在文件中搜索`lseek()`然后使用`gzdopen()`从那里开始写入来完成。

对于添加的大文件（至少 10 的 K），这将工作得很好，压缩效果很好。但是，如果您要添加非常小的文件，则简单地连接小型 gzip 流将导致糟糕的压缩，或者更糟的是，扩展。您可以做一些更复杂的事情，将少量数据实际添加到单个 gzip 流中，以便压缩算法可以利用前面的数据进行关联和字符串匹配。为此，请查看[zlib](http://zlib.net/)发行版中[gzlog.h](https://github.com/madler/zlib/blob/master/examples/gzlog.h)和[gzlog.c](https://github.com/madler/zlib/blob/master/examples/gzlog.c)中`examples/`的方法。

以下是如何执行简单方法的示例：

```
/* tapp.c -- Example of how to append to a tar.gz file with concatenated gzip
   streams. Placed in the public domain by Mark Adler, 16 Jan 2013\. */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <assert.h>
#include <unistd.h>
#include <fcntl.h>
#include "zlib.h"

#define local static

/* Build an allocated string with the prefix string and the NULL-terminated
   sequence of words strings separated by spaces.  The caller should free the
   returned string when done with it. */
local char *build_cmd(char *prefix, char **words)
{
    size_t len;
    char **scan;
    char *str, *next;

    len = strlen(prefix) + 1;
    for (scan = words; *scan != NULL; scan++)
        len += strlen(*scan) + 1;
    str = malloc(len);                                  assert(str != NULL);
    next = stpcpy(str, prefix);
    for (scan = words; *scan != NULL; scan++) {
        *next++ = ' ';
        next = stpcpy(next, *scan);
    }
    return str;
}

/* Usage:

      tapp archive.tar.gz addthis.file andthisfile.too

   tapp will create a new archive.tar.gz file if it doesn't exist, or it will
   append the files to the existing archive.tar.gz.  tapp must have been used
   to create the archive in the first place.  If it did not, then tapp will
   exit with an error and leave the file unchanged.  Each use of tapp appends a
   new gzip stream whose compression cannot benefit from the files already in
   the archive.  As a result, tapp should not be used to append a small amount
   of data at a time, else the compression will be particularly poor.  Since
   this is just an instructive example, the error checking is done mostly with
   asserts.
 */
int main(int argc, char **argv)
{
    int tgz;
    off_t offset;
    char *cmd;
    FILE *pipe;
    gzFile gz;
    int page;
    size_t got;
    int ret;
    ssize_t raw;
    unsigned char buf[3][512];
    const unsigned char z1k[] =     /* gzip stream of 1024 zeros */
        {0x1f, 0x8b, 8, 0, 0, 0, 0, 0, 2, 3, 0x63, 0x60, 0x18, 5, 0xa3, 0x60,
         0x14, 0x8c, 0x54, 0, 0, 0x2e, 0xaf, 0xb5, 0xef, 0, 4, 0, 0};

    if (argc < 2)
        return 0;
    tgz = open(argv[1], O_RDWR | O_CREAT, 0644);        assert(tgz != -1);
    offset = lseek(tgz, 0, SEEK_END);                   assert(offset == 0 || offset >= (off_t)sizeof(z1k));
    if (offset) {
        if (argc == 2) {
            close(tgz);
            return 0;
        }
        offset = lseek(tgz, -sizeof(z1k), SEEK_END);    assert(offset != -1);
        raw = read(tgz, buf, sizeof(z1k));              assert(raw == sizeof(z1k));
        if (memcmp(buf, z1k, sizeof(z1k)) != 0) {
            close(tgz);
            fprintf(stderr, "tapp abort: %s was not created by tapp\n", argv[1]);
            return 1;
        }
        offset = lseek(tgz, -sizeof(z1k), SEEK_END);    assert(offset != -1);
    }
    if (argc > 2) {
        gz = gzdopen(tgz, "wb");                        assert(gz != NULL);
        cmd = build_cmd("tar cf - -b 1", argv + 2);
        pipe = popen(cmd, "r");                         assert(pipe != NULL);
        free(cmd);
        got = fread(buf, 1, 1024, pipe);                assert(got == 1024);
        page = 2;
        while ((got = fread(buf[page], 1, 512, pipe)) == 512) {
            if (++page == 3)
                page = 0;
            ret = gzwrite(gz, buf[page], 512);          assert(ret == 512);
        }                                               assert(got == 0);
        ret = pclose(pipe);                             assert(ret != -1);
        ret = gzclose(gz);                              assert(ret == Z_OK);
        tgz = open(argv[1], O_WRONLY | O_APPEND);       assert(tgz != -1);
    }
    raw = write(tgz, z1k, sizeof(z1k));                 assert(raw == sizeof(z1k));
    close(tgz);
    return 0;
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T14:39:23.640

在我看来，严格遵守标准的 TAR 是不可能的。我已通读`zlib`[[1]](http://www.zlib.net/manual.html#Gzip)手册和`GNU tar`[[2]](http://www.gnu.org/software/tar/manual/html_node/Standard.html#SEC182)文件规范。我没有找到任何信息如何附加到 TAR 可以实现。所以我假设它必须通过覆盖空块来完成。

因此，我再次假设您可以使用`gzseek()`. 但是，您需要知道未压缩存档 ( `size`) 的大小并设置`offset`为`size-2*512`. 请注意，这可能很麻烦，因为“whence 参数在 lseek(2) 中定义；不支持值 SEEK_END。” [1](http://www.zlib.net/manual.html#Gzip)并且您不能同时打开文件进行读取和写入，即内省结束块的位置。

**但是**，应该有可能稍微滥用 TAR 规范。`GNU tar`[[2]](http://www.gnu.org/software/tar/manual/html_node/Standard.html#SEC182)文档提到了一些*有趣*的事情：

" 每个归档的文件都由一个描述文件的头块表示，后跟零个或多个给出文件内容的块。在归档文件的末尾有两个 512 字节的块，以二进制零填充作为结尾-of-file 标记。一个合理的系统应该在档案的末尾写入这样的文件结束标记，但在读取档案时不能假设这样的块存在。特别是 GNU tar 总是发出警告，如果它确实存在不遇。”

这意味着，您可以故意不编写这些块。如果您编写了 tarball 压缩器，这很容易。然后您可以`zlib`在正常的附加模式下使用，记住 TAR 解压缩器必须知道*“损坏”*的TAR 文件。

[1] [http://www.zlib.net/manual.html#Gzip](http://www.zlib.net/manual.html#Gzip) [2] [http://www.gnu.org/software/tar/manual/html_node/Standard.html#SEC182](http://www.gnu.org/software/tar/manual/html_node/Standard.html#SEC182)

# android - NinePatch 9 带有一张图片的文本框

> ID：14359040
> 
> 赞同：0
> 
> 时间：2013-01-16T12:57:38.093
> 
> 标签：android

我想实现这个图像

![在此处输入图像描述](../Images/96fb2c8e0ba9b87f4c4a919418849e55.png)

# 区域 textview 1 到 textview 9 Ninepatch 能

我怎么能九补丁到底这个？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:36:44.523

仅使用一个 9patch 是不可行的。必须使用以下9patch

![父元素](../Images/84f071bfedf0c74149dbcdcf73226417.png)

把边界放在你的父母身上。

对于父元素内的文本视图，您必须使用另一个 9patch 作为边框和渐变。

# java - 在日志中显示线程 ID 而不是线程名称

> ID：14359044
> 
> 赞同：22
> 
> 时间：2013-01-16T12:57:51.390
> 
> 标签：java, logging, log4j

我有一个带有 log4j 的 Struts 应用程序来显示有关应用程序的信息。

格式化日志输出的模式如下：

```
log4j.appender.RALL.layout.ConversionPattern=[%p] %d{dd/MM/yyyy HH:mm:ss} [THREAD ID=%t] [CLASS=(%C{1}:%L)] %m%n 
```

我需要在日志中显示**线程 ID**而不是**线程名称。**显示线程名称的转换字符是 %t。我在 log4j 文档中没有看到获取它的方法。

谁能帮我？？

* * *

## 回答 #1

> 赞同：10
> 
> 时间：2013-01-16T14:21:14.840

这是可能的，但并不像使用一些预配置的模式那么容易。

Log4j 1.X 和 Log4j 2.x 没有任何用于打印线程 ID 的预配置模式，但您始终可以使用一些“魔术”。

`PatternLayout`正在使用`PatternParser`标记为`final`类并具有“模式”的静态映射作为键和`Converters`类作为值的类。每次当 Parses 发现使用用于记录模式格式的模式时，`%`它都会使用与 map 中的此模式键匹配的转换器。

您不能将自己的规则添加到该地图，但您仍然可以编写自己的 MyOwnPatternLayout：

```
public class MyOwnPatternLayout extends PatternLayout 
```

这将在它的`format`方法中做这样的伎俩：

```
public String format(LoggingEvent event) {
   String log = super.format(event);
   /*
   Now you just have to replace with regex all occurences of %i or 
   any mark you would like to use as mark to represent Thread ID 
   with Thread ID value.
   Only thing you have to be sure to not use any mark as your Thread ID
   that already is defined by PatterParser class
   */
   return log.replaceAll("%i", someThreadID);
} 
```

唯一的问题是您必须以某种方式获取该线程 ID。有时您所要做的就是解析可以轻松收集的线程名称：

```
String threadName = event.getThreadName(); 
```

例如 Apache-Tomcat 将线程 ID 放在线程名称**http-nio-/127.0.0.1-8084"-exec-41**的末尾。

为了确保线程 ID 正确，您还可以创建自己的 LogginEvent 和 Logger 子类（MyLoggingEvent 和 MyLogger），并在 MyLogger 中创建 MyLoggingEvent，女巫也将线程 ID 作为参数，而不仅仅是线程名称。然后你可以很容易地在上面的代码中收集它。

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2013-01-16T14:18:15.027

一种方法是使用 log4j MDC 自己添加它。我们使用它来为 Web 请求添加用户名。我们在每个请求开始时的过滤器中执行此操作。例如。

```
import org.apache.log4j.MDC;

...

  // Add username to MDC
  String username = ...;
  MDC.put("user", username); 
```

然后添加`[%X{user}]`到您的转换模式。

* * *

## 回答 #3

> 赞同：7
> 
> 时间：2016-03-01T20:43:20.853

我为即将到来的 2.6 实现了线程 ID 和线程优先级。在此处跟踪：[https ://issues.apache.org/jira/browse/LOG4J2-1299](https://issues.apache.org/jira/browse/LOG4J2-1299)

您可以从 Apache 快照存储库中获取 2.6-SNAPSHOT 构建：[https ://repository.apache.org/content/repositories/snapshots/](https://repository.apache.org/content/repositories/snapshots/)

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2014-08-18T17:16:47.147

您可以使用 ThreadContext Map 向 log4j2 提供元数据。这是您可以通过正常格式添加**的值的字符串映射。**

```
String threadId = String.valueOf(Thread.currentThread().getId());
ThreadContext.put("TId", threadId); 
```

还有一个更合理的模式：

```
 <PatternLayout pattern="%d{yyyyMMdd}T%d{HHmmss.SSS} %-5level [%t] [%5X{TId}] %15c{1} - %msg%n"/> 
```

[关于“鱼标记”的完整 Log4j2 文档](http://logging.apache.org/log4j/2.x/manual/thread-context.html)

* * *

## 回答 #5

> 赞同：5
> 
> 时间：2019-07-07T14:45:39.410

我不知道它是什么时候引入的，但在 log4j2 我们有% **tid**

> 输出生成日志事件的线程 ID。

[https://logging.apache.org/log4j/2.x/manual/layouts.html](https://logging.apache.org/log4j/2.x/manual/layouts.html)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-01-16T13:03:23.643

我认为不可能使用标准 log4j 格式显示线程 ID。我还通过`PatterParser`类代码进行了调查，没有发现任何有用的东西。我找到了一些自定义解决方案，但仅适用于具有`%i`选项的 IBM 服务器：

> %i：插入线程 ID。与线程名称（由 %t 表示）不同，这是线程的数字 ID。请注意，此参数是特定于 Initiate 的，而此处列出的其他参数是 log4j 的标准参数。

看到[这个链接](http://publib.boulder.ibm.com/infocenter/initiate/v9r5/index.jsp?topic=%2Fcom.ibm.einstall.doc%2Ftopics%2Fc_einstall_understand_conversionpattern_format.html)

* * *

## 回答 #7

> 赞同：2
> 
> 时间：2017-10-27T13:04:18.107

如下扩展`PatternLayout`，然后在格式字符串中指定`MyPatternLayout`with 。`$X{threadId}`

此实现用于`ThreadLocal`最小化计算线程 ID 的性能影响：

```
 MyPatternLayout extends PatternLayout {

        private final ThreadLocal<String> threadId = new ThreadLocal<String>() {

            @Override
            protected String initialValue() {
                String t = Long.toString(Thread.currentThread().getId());
                MDC.put("threadId", t);
                return t;
            }
        };

        @Override
        public String format(LoggingEvent event) {

            this.threadId.get();
            return super.format(event);
        }
    } 
```

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2015-01-31T08:44:01.923

一种可能的解决方案是创建您自己的类，该类位于您的代码和 Log4J 之间，并将线程 ID 附加到每个日志消息：

```
public class ThreadLogger
{
    // Constructor declared private to prevent instantiation.  Use static methods instead.
    private ThreadLogger() {}

    private static enum LogLevel
    {
        TRACE,
        DEBUG,
        INFO,
        WARN,
        ERROR
    }

    public static void trace(String message)
    {
        logMessage(message, LogLevel.ERROR);
    }

    public static void debug(String message)
    {
        logMessage(message, LogLevel.ERROR);
    }

    public static void info(String message)
    {
        logMessage(message, LogLevel.ERROR);
    }

    public static void warn(String message)
    {
        logMessage(message, LogLevel.WARN);
    }

    public static void error(String message)
    {
        logMessage(message, LogLevel.ERROR);
    }

    private static void logMessage(String message, LogLevel logLevel)
    {
        // Get the Log4J logger for the class that originally wanted to log the message
        String callingClassName = Thread.currentThread().getStackTrace()[3].getClassName();
        Class callingClass;
        try
        {
            callingClass = Class.forName(callingClassName);
        }
        catch(ClassNotFoundException e)
        {
            String errorMessage = String.format("Could not reference class [%s].  Unable to log call!", callingClassName);
            throw new RuntimeException(errorMessage);
        }
        Logger logger = Logger.getLogger(callingClass);

        // Get the thread ID and place it in front of the logged message
        long threadId = Thread.currentThread().getId();
        String formattedMessage = String.format("[%s] %s", threadId, message);

        // Log the message
        switch(logLevel)
        {
            case TRACE:
                logger.trace(formattedMessage);
                break;
            case DEBUG:
                logger.debug(formattedMessage);
                break;
            case INFO:
                logger.info(formattedMessage);
                break;
            case WARN:
                logger.warn(formattedMessage);
                break;
            case ERROR:
                logger.error(formattedMessage);
                break;
        }
    }
} 
```

缺点：

*   表现？这为每个日志语句添加了一些额外的步骤。
*   稳定？这增加了一个潜在的故障点（Class.forName 调用）。
*   您必须将所有现有的日志语句替换为对新类的调用。
*   在常规 Log4J 格式化之后，线程 ID 才会出现。IE：

```
1234 [main] INFO com.foo.bar.Baz - [1] Hello world on thread #1!
1234 [main] INFO com.foo.bar.Baz - [2] Hello world on thread #2!
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2015-09-23T05:11:15.127

我创建自己的附加程序并将 Thread.currentThread().getId() 设置为 MDC 属性。%X{threadId} 应该给我线程 ID。此解决方案从 1.2.15 开始运行。然后，您可以将 AsyncAppender 附加到此。

```
public class CurrentThreadIdAppender extends AppenderSkeleton implements AppenderAttachable {

    private final AppenderAttachableImpl appenders = new AppenderAttachableImpl();

...

    @Override
    protected void append(LoggingEvent event) {   
        synchronized (appenders) {
            event.setProperty("threadId", String.valueOf(Thread.currentThread().getId()));
            appenders.appendLoopOnAppenders(event);
        }
    }

...

} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2016-04-09T12:42:45.847

log4j2 的另一个优雅解决方案是使用`org.apache.logging.log4j.core.pattern.LogEventPatternConverter`.

你可以写一个这样的类

```
@Plugin(name = "ThreadIdConverter", category = "Converter")
@ConverterKeys({ "tid" })
public class ThreadIdConverter extends LogEventPatternConverter {

    protected ThreadIdConverter(String name, String style) {
        super(name, style);
    }

    @Override
    public void format(LogEvent event, StringBuilder toAppendTo) {
        toAppendTo.append(getThreadId());
    }

    protected String getThreadId() {
        long id = Thread.currentThread().getId();
        return Long.toHexString(id);
    }

    public static ThreadIdConverter newInstance(String[] options) {
        return new ThreadIdConverter("tid", "tid");
    }
} 
```

通过这种方式，您正在创建一个新模式`tid`，并且可以在定义 appender 的布局时使用它

```
<Appenders>
    <Console name="console" target="SYSTEM_OUT">
        <PatternLayout>
            <Pattern>%d{dd-MMM HH:mm:ss.SSS} %-7level [%5tid] %logger - %message%n</Pattern>
        </PatternLayout>
    </Console>
</Appenders> 
```

最后要记住的重要事情是如何激活您的 log4j2 插件。为此，您必须使用节点上的`package`属性在log4j2 配置文件中添加包含插件的包`Configuration`

```
<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE Configuration>
<Configuration status="warn"
    packages="my.package.logging.plugins">
    <Appenders>
        <Console name="console" target="SYSTEM_OUT">
            <PatternLayout>
                <Pattern>%d{dd-MMM HH:mm:ss.SSS} %-7level [%5tid] %logger - %message%n</Pattern>
            </PatternLayout>
        </Console>
    </Appenders>
    <Loggers>
        <Root level="warn">
            <AppenderRef ref="console" />
        </Root>
        <Logger name="my.package" level="trace" />
    </Loggers>
</Configuration> 
```

# iphone - NSLog 正确显示 NSString - 尝试在标签上显示字符串会使应用程序崩溃（无法识别的选择器）

> ID：14359052
> 
> 赞同：1
> 
> 时间：2013-01-16T12:58:29.073
> 
> 标签：iphone, nsstring, console, nsarray, uilabel

尝试`UILabel`使用`NSString`. `NSString`在`console`作品上表现相同。

```
-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    if (self.connectionData)
    {
        NSError *error;
        self.dict = [NSJSONSerialization JSONObjectWithData:self.connectionData options:kNilOptions error:&error];
        self.matchesArray = self.dict[@"matches"];

        NSString *title = [self.matchesArray valueForKey:@"title"];
        NSLog(@"NSString TITLE contains: %@", title);
        self.titleLabel.text = title;
    }
} 
```

控制台输出：

```
2013-01-16 13:54:08.550 ZEITreisen[3168:c07] NSString TITLE contains: (
    "Mark und Dollar"
)
2013-01-16 13:54:08.552 ZEITreisen[3168:c07] -[__NSArrayI isEqualToString:]: unrecognized selector sent to instance 0xde93850
(lldb) 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:01:38.793

`title`不是`NSString`，是`NSArray`

所以

```
-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    if (self.connectionData)
    {
        NSError *error;
        self.dict = [NSJSONSerialization JSONObjectWithData:self.connectionData options:kNilOptions error:&error];
        self.matchesArray = self.dict[@"matches"];

        NSArray *title = [self.matchesArray valueForKey:@"title"];
        NSLog(@"NSString TITLE contains: %@", title);
        self.titleLabel.text = [title lastObject];
    }
} 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:03:18.903

尝试 ：

```
-(void)connectionDidFinishLoading:(NSURLConnection *)connection
{
    if (self.connectionData)
    {
        NSError *error;
        self.dict = [NSJSONSerialization JSONObjectWithData:self.connectionData options:kNilOptions error:&error];
        self.matchesArray = self.dict[@"matches"];

        NSString *title = [self.matchesArray valueForKey:@"title"];
        NSLog(@"NSString TITLE contains: %@", title);
        self.titleLabel.text = [NSString stringWithFormat:@"%@",[title objectAtIndex:0]];
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:05:36.017

也许您存储在 self.matchesArray 中的值不是字符串

# date - 为什么 PowerShell 在转换为 DateTime 时总是使用美国文化？

> ID：14359053
> 
> 赞同：16
> 
> 时间：2013-01-16T12:58:34.943
> 
> 标签：date, powershell, localization, date-format, powershell-3.0

昨天尝试读取 CSV 时，我注意到 PowerShell 在使用`[datetime]"date"`.

**我的区域设置都是正确**的，并且**`[DateTime]::Parse("date")`使用英国日期格式**(dd/mm/yyyy)。

**这是一个错误，还是一个深思熟虑的决定**？如果是一个深思熟虑的决定，这是否记录在任何地方？

```
PS D:\> [DateTime]"12/10/2012"
10 December 2012 00:00:00

PS D:\> [DateTime]::Parse("12/10/2012")
12 October 2012 00:00:00 
```

（注意：在美国机器上，我希望这些对象是相同的，但在我在英国的机器上却不是这样）。

**注意：我不想更改格式（它是来自外部源的文件），我不想在输出中格式化日期，我知道我可以使用`[DateTime]::Parse()`. 问题是以`?`:-)结尾的那一点**

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-16T13:00:10.353

这是一个深思熟虑的决定。将字符串转换为 a 时，`DateTime`您可以使用 Braindead US 格式**或**ISO 8601 -`[datetime]'2012-10-12'`工作得很好并且更易于阅读。

限制和限制的原因是脚本不应该依赖于当前的文化，至少对于文字和准文字（如强制转换的字符串）。这是编写健壮的批处理文件的一个主要问题，您当然不希望在 PowerShell 中出现同样的问题。

[Lee Holmes 有一个解释](http://www.leeholmes.com/blog/2009/01/13/datetime-casts-are-language-primitives/)，这可以被认为是半官方的，因为他现在/曾经在 MS 的 PowerShell 团队中：

> 为了防止微妙的国际化问题突然出现在您的脚本中，PowerShell 将`[DateTime] '11/26/2007'`（日期常量）视为一种语言功能 - 就像它`[Double] 10.5`（数字常量）一样。并非所有文化都使用小数点作为分数分隔符，但编程语言标准化它。并非所有文化都使用 en-US`DateTime`格式，当人们不考虑在这些文化中运行他们的软件的影响时，会导致数百万国际化错误。

Lee 忘记提及的是我之前写的，更合理的 ISO 8601 格式也可以工作。

遗憾的是，PowerShell 文档或语言规范 (v2) 中都没有这方面的文档。但是，很少有证据表明这是一个错误。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2020-08-26T22:17:52.520

如果需要，您可以强制为单个命令设置区域性：

```
PS C:\> [System.Threading.Thread]::CurrentThread.CurrentUICulture = "en-US" ; [System.Threading.Thread]::CurrentThread.CurrentCulture = "en-US"; [DateTime]::Parse("12/10/2012")

Monday, December 10, 2012 12:00:00 AM

PS C:\> [System.Threading.Thread]::CurrentThread.CurrentUICulture = "en-GB" ; [System.Threading.Thread]::CurrentThread.CurrentCulture = "en-GB"; [DateTime]::Parse("12/10/2012")

12 October 2012 00:00:00 
```

# sencha-touch - 如何加快 Sencha Touch 中的调试速度？

> ID：14359056
> 
> 赞同：1
> 
> 时间：2013-01-16T12:58:39.593
> 
> 标签：sencha-touch, sencha-touch-2

我希望能够在构建 Sencha Touch 应用程序时加快调试过程。目前我必须禁用缓存，因为刷新应用程序时我对源所做的任何更改都不会更新，我还想在 Chrome 中保留断点。

我如何既缓存不太可能更改的文件，又刷新那些更改的文件？

目前，当我按 Ctrl+F5 时，加载应用程序需要 4-5 秒。它正在加载所有 Sencha Touch 所需的 .js 文件以及应用程序本身的任何文件。我想我想做的是基于路径缓存，因此 sencha touch 源文件夹中的任何文件都被缓存并且不会重新加载，但应用程序文件不会。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-28T11:56:38.593

尝试使用应用程序缓存清单，您可以[在此处](http://www.html5rocks.com/en/tutorials/appcache/beginner/)学习配置一个。应用程序缓存不是用于文件夹，而是用于文件，因此您必须包含所有要永久缓存的文件。

# javascript - 子窗口中的 Javascript 错误

> ID：14359068
> 
> 赞同：0
> 
> 时间：2013-01-16T12:59:05.910
> 
> 标签：javascript, asp.net

我试图弄清楚为什么我会收到错误：

`"window.opener.document.aspnetForm.formType is null or not an object".`

我通过 URL 字符串将父窗口中的值传递给弹出窗口（此子窗口是搜索表单）。此值是 SharePoint 表单字段的 ID（我需要这样做是有原因的，该值指示它是来自 newform 还是 editform）。我使用子窗口中的函数 (geturlvalue()) 从 url 字符串中获得的值声明变量 formType，

`var formType = geturlvalue(name);`

变量“formType”在子窗口中正常工作，在窗口打开器显示来自父窗口的正确值之前提醒它 `ctl00_m_g_004d943c_bb99_4fba_bee5_68862443b98d_ctl00_ctl04_ctl18_ctl00_ctl00_ctl04_ctl00_ctl00_TextField`

这是子窗口中的开瓶器：

```
window.opener.document.aspnetForm.formType.value = document.getElementById('Server').value; 
```

开启者需要使用 ID 为 Server 的子窗口字段中的值填充父窗口中的输入字段。

有人知道为什么我在 formType 上收到错误吗？如果我添加`ctl00_m_g_004d943c_bb99_4fba_bee5_68862443b98d_ctl00_ctl04_ctl18_ctl00_ctl00_ctl04_ctl00_ctl00_TextField`到 opener 来代替 formType 它可以正常工作并填充父输入字段：

window.opener.document.aspnetForm.ctl00_m_g_004d943c_bb99_4fba_bee5_68862443b98d_ctl00_ctl04_ctl18_ctl00_ctl00_ctl04_ctl00_ctl00_TextField.value = document.getElementById('Server').value;

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:01:00.077

看起来像是`formType`父窗口中元素的 ID，所以在这种情况下，您需要这样的代码：

```
window.opener.document.getElementById(formType).value = document.getElementById('Server').value; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:25:21.550

不是很详细的问题，无论如何都要尝试。

我真的被你的台词弄糊涂了：

```
window.opener.document.aspnetForm.formType.value = document.getElementById('Server').value; 
```

它是什么 ？

如果您想使用，请确保您的表单具有 name="aspnetForm"（不是 id）：

```
window.opener.document.aspnetForm 
```

如果您想使用，请确保您的表单元素具有 name="formType" （不是 id）：

```
window.opener.document.aspnetForm.formType.value = ... 
```

我想知道你如何期望 var formType 成为 window.opener.document 的一部分，但也许你已经在代码的其他地方定义了所有这些东西，所以也许你应该发布更多代码，让其他人了解你的程序中发生了什么.

# mysql - 在这个 mysql 语句中避免子查询

> ID：14359073
> 
> 赞同：-1
> 
> 时间：2013-01-16T12:59:22.587
> 
> 标签：mysql, subquery, entity-attribute-value

我有一个查询，如下所述：

```
select a_value as itemname, (
    select a_value from attributes where a_name = 'EAN'
) AS EAN 
from attributes 
where a_name = 'NAME'; 
```

在这里，我想要使用不同 where 子句的同一个表中的 2 个值，并且我也在同一个前端表中显示它们。我可以在这里避免子查询吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:07:46.383

```
SELECT a_name, a_value
FROM attributes
WHERE a_name IN ('EAN', 'NAME'); 
```

在您的应用程序中，获取两行，然后将其转换为单个数组：

```
$item = array();
while ($row = fetch()) { -- pseudocode
  $item[ $row["a_name"] ] = $row["a_value"];
}
print_r($item); 
```

您可能想在 SQL 中执行该操作，但它看起来像这样：

```
SELECT aname.a_value AS itemname, aean.a_value AS EAN
FROM attributes AS aname
JOIN attributes AS aean ON aname.entity = aean.entity
WHERE aname.a_name = 'NAME' AND aean.a_name = 'EAN'; 
```

将来当您需要三个属性时，它会变得更加复杂。基本上，对于您想要的每个附加属性，还有一个自联接。您可以在单个查询中执行多少个连接存在实际限制，因此此解决方案无法扩展。

GROUP BY 也有一个解决方案，但它也很难编写并且性能很差。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:03:55.027

尝试这个：

```
SELECT a1.a_value AS itemname, a2.a_value AS EAN 
FROM attributes a1 
LEFT JOIN attributes a2 ON s2.a_name = 'EAN'  
WHERE a_name = 'NAME'; 
```

**或者**

```
SELECT a_value 
FROM attributes 
WHERE a_name IN ('NAME', 'EAN'); 
```

**或者**

```
SELECT MAX(IF(a_name = 'NAME', a_value, NULL)) AS itemname, 
       MAX(IF(a_name = 'EAN', a_value, NULL)) AS EAN 
FROM attributes 
WHERE a_name IN ('NAME', 'EAN'); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:06:41.453

这会将两个值作为单独的行返回：

> 从 a_name in ('EAN', 'NAME') 的属性中选择 a_value 作为 itemname

您是否需要将所有结果作为单行返回？并且您是否需要完全独立的 where 子句（而不仅仅是不同的值）？

# asp.net - 使用 SEO 友好的 url 从访问中分页数据

> ID：14359074
> 
> 赞同：4
> 
> 时间：2013-01-16T12:59:25.267
> 
> 标签：asp.net, paging

我需要一些关于如何从访问数据库中分页数据的帮助。我使用`asp:ListView`并`asp:DataPager`喜欢我发现的一些示例，但是分页使用 javascript 并且我希望分页将是友好的。

我怎样才能把我的一些代码？

[编辑] 这是代码：

```
<asp:ListView ID="tblProjects" runat="server" OnPagePropertiesChanging="tblProjects_PagePropertiesChanging">
<LayoutTemplate>
    <ul class="ulProducts">
        <asp:PlaceHolder ID="itemPlaceholder" runat="server" />
    </ul>
</LayoutTemplate>
<ItemTemplate>
    <li>
        <div class="divProduct">
            <a rel='pics' href='GalleryEditor/pictures/<%# Eval("BigImageName") %>'>
                <img src='GalleryEditor/pictures/<%# Eval("SmallImagesName") %>'
                    alt='<%# Eval("ImageDetail") %>' title='<%# Eval("ImageDetail") %>' />
            </a>
        </div>
    </li>
</ItemTemplate>
<EmptyDataTemplate>
    no data
</EmptyDataTemplate> 
```

这是后面的代码：

```
protected void tblProjects_PagePropertiesChanging(object sender, PagePropertiesChangingEventArgs e)
    {
        //set current page startindex, max rows and rebind to false

        imagesPager.SetPageProperties(e.StartRowIndex, e.MaximumRows, false);

        string page = Request.QueryString["p"];
        if (!(FormValidator.IsNumber(page)))
            page = "8800";

        buildProducts(page);

    }

    void buildTitleAndDescription(string page)
    {
        // set page title
        OleDbConnection conn0 = new OleDbConnection(@"Provider = Microsoft.Jet.OLEDB.4.0; Data Source =" + Server.MapPath("GalleryEditor\\App_Data\\projects.mdb"));
        OleDbCommand comm0 = new OleDbCommand("select ProjectName from Project where PlaceID=" + page, conn0);
        OleDbDataReader reader0;

        conn0.Open();
        reader0 = comm0.ExecuteReader();
        reader0.Read();

        Page.Header.Title = reader0["ProjectName"].ToString();

        reader0.Close();
        conn0.Close();

        //if (IsPostBack)
        //{
        //    string Script = "<script type='text/javascript'>goToEnd();\n</script>";
        //    Page.ClientScript.RegisterStartupScript(this.GetType(), "onload", Script);
        //}

    }

    void buildProducts(string page)
    {

        // set page content
        OleDbConnection conn = new OleDbConnection(@"Provider = Microsoft.Jet.OLEDB.4.0; Data Source =" + Server.MapPath("GalleryEditor\\App_Data\\sb.mdb"));
        OleDbCommand comm = new OleDbCommand("select SmallImagesName, BigImageName, ImageDetail from Images where PlaceID=" + page, conn);

        conn.Open();

        DataSet ds = new DataSet();
        OleDbDataAdapter da = new OleDbDataAdapter(comm);
        da.Fill(ds);

        tblProjects.DataSource = ds;
        tblProjects.DataBind();

    } 
```

我不介意将代码更改为更好的代码，如果我从中学习，我将不胜感激。我发现的所有示例都是针对 SQL 的，并且我的数据需要处于可访问状态。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-02-05T12:20:15.787

这是一个 asp listview 示例，您必须按如下方式定义查询字符串。

```
 <asp:ListView ID="ListView1" runat="server" DataKeyNames="bd_book_code" 
    DataSourceID="SqlDataSource1" EnableModelValidation="True">
    <AlternatingItemTemplate>
        <tr style="">
            <td>
                <asp:Label ID="bd_book_codeLabel" runat="server" 
                    Text='<%# Eval("bd_book_code") %>' />
            </td>
            <td>
                <asp:Label ID="bd_isbnLabel" runat="server" Text='<%# Eval("bd_isbn") %>' />
            </td>
            <td>
                <asp:Label ID="bd_titleLabel" runat="server" Text='<%# Eval("bd_title") %>' />
            </td>
        </tr>
    </AlternatingItemTemplate>
    <EditItemTemplate>
        <tr style="">
            <td>
                <asp:Button ID="UpdateButton" runat="server" CommandName="Update" 
                    Text="Update" />
                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                    Text="Cancel" />
            </td>
            <td>
                <asp:Label ID="bd_book_codeLabel1" runat="server" 
                    Text='<%# Eval("bd_book_code") %>' />
            </td>
            <td>
                <asp:TextBox ID="bd_isbnTextBox" runat="server" Text='<%# Bind("bd_isbn") %>' />
            </td>
            <td>
                <asp:TextBox ID="bd_titleTextBox" runat="server" 
                    Text='<%# Bind("bd_title") %>' />
            </td>
        </tr>
    </EditItemTemplate>
    <EmptyDataTemplate>
        <table runat="server" style="">
            <tr>
                <td>
                    No data was returned.</td>
            </tr>
        </table>
    </EmptyDataTemplate>
    <InsertItemTemplate>
        <tr style="">
            <td>
                <asp:Button ID="InsertButton" runat="server" CommandName="Insert" 
                    Text="Insert" />
                <asp:Button ID="CancelButton" runat="server" CommandName="Cancel" 
                    Text="Clear" />
            </td>
            <td>
                <asp:TextBox ID="bd_book_codeTextBox" runat="server" 
                    Text='<%# Bind("bd_book_code") %>' />
            </td>
            <td>
                <asp:TextBox ID="bd_isbnTextBox" runat="server" Text='<%# Bind("bd_isbn") %>' />
            </td>
            <td>
                <asp:TextBox ID="bd_titleTextBox" runat="server" 
                    Text='<%# Bind("bd_title") %>' />
            </td>
        </tr>
    </InsertItemTemplate>
    <ItemTemplate>
        <tr style="">
            <td>
                <asp:Label ID="bd_book_codeLabel" runat="server" 
                    Text='<%# Eval("bd_book_code") %>' />
            </td>
            <td>
                <asp:Label ID="bd_isbnLabel" runat="server" Text='<%# Eval("bd_isbn") %>' />
            </td>
            <td>
                <asp:Label ID="bd_titleLabel" runat="server" Text='<%# Eval("bd_title") %>' />
            </td>
        </tr>
    </ItemTemplate>
    <LayoutTemplate>
        <table runat="server">
            <tr runat="server">
                <td runat="server">
                    <table ID="itemPlaceholderContainer" runat="server" border="0" style="">
                        <tr runat="server" style="">
                            <th runat="server">
                                bd_book_code</th>
                            <th runat="server">
                                bd_isbn</th>
                            <th runat="server">
                                bd_title</th>
                        </tr>
                        <tr ID="itemPlaceholder" runat="server">
                        </tr>
                    </table>
                </td>
            </tr>
            <tr runat="server">
                <td runat="server" style="">
                    <asp:DataPager ID="DataPager1" runat="server" QueryStringField="pid">
                        <Fields>
                            <asp:NextPreviousPagerField ButtonType="Link" ShowFirstPageButton="True" 
                                ShowNextPageButton="False" ShowPreviousPageButton="False" />
                            <asp:NumericPagerField />
                            <asp:NextPreviousPagerField ButtonType="Link" ShowLastPageButton="True" 
                                ShowNextPageButton="False" ShowPreviousPageButton="False" />
                        </Fields>
                    </asp:DataPager>
                </td>
            </tr>
        </table>
    </LayoutTemplate>
    <SelectedItemTemplate>
        <tr style="">
            <td>
                <asp:Label ID="bd_book_codeLabel" runat="server" 
                    Text='<%# Eval("bd_book_code") %>' />
            </td>
            <td>
                <asp:Label ID="bd_isbnLabel" runat="server" Text='<%# Eval("bd_isbn") %>' />
            </td>
            <td>
                <asp:Label ID="bd_titleLabel" runat="server" Text='<%# Eval("bd_title") %>' />
            </td>
        </tr>
    </SelectedItemTemplate>
</asp:ListView> 
```

QueryStringField="pid" 会变魔术。

# ajax - 在 AJAX 调用后附加到 Flexslider 后无法使用 Fancybox 打开图像

> ID：14359078
> 
> 赞同：0
> 
> 时间：2013-01-16T12:59:28.610
> 
> 标签：ajax, fancybox, coffeescript, flexslider, woothemes

下面的代码是在 CoffeeScript 中，经过几个小时的玩弄，最后阅读了 WooThemes 上的文档，我能够让 Flexslider 在单击我的按钮以从 Instagram 加载其余图像后正确附加图像.

但是，现在当我单击图像时，它并没有像在页面加载时加载的其他图像那样打开 Fancybox，并且想知道我是否可以在这里获得一些帮助。

```
Slider =
  flexi: ->
    $('.flexslider').flexslider
      animation: 'slide'
      animationLoop: true
      slideshow: false
      itemWidth: 160
      itemMargin: 5
      minItems: 1
      maxItems: 10
      start: (slider) ->
        $('#load-more').on 'click', (event) ->
          event.preventDefault()
          $.ajax
            type: 'get'
            url: $(this).find('a').attr('href')
            dataType: 'jsonp'
            success: (data) ->
              $.each data.data, (index, value) ->
                slider.addSlide '<li class="thumb" data-profile="' + value.user.profile_picture + '" data-lat="0" data-long="0" data-id="' + value.id + '" data-thumb="' + value.images.thumbnail.url + '" data-username="' + value.user.username + '" data-comments="' + value.comments.count + '" data-likes="' + value.likes.count + '" data-text="' + value.caption.text + '" data-link="' + value.link + '"><a href="' + value.images.low_resolution.url + '" class="fancybox fancybox.iframe"><img alt="' + value.images.thumbnail.url.split('/')[3].split('.jpg')[0] + '" src="' + value.images.thumbnail.url + '" /></a></li>'

Fancy =
  box: (lat, lng, pid) ->
    street = undefined
    latLng = new google.maps.LatLng lat, lng
    view = new google.maps.StreetViewService()
    $('.fancybox').fancybox
      width: 1155
      height: '95%'
      maxWidth: '95%'
      maxHeight: '95%'
      openEffect: 'none'
      autoSize: true
      autoResize:  false
      closeEffect: 'fade'
      scrolling: 'auto'
      type: 'iframe'
      helpers:
        media:{}

      beforeShow: ->
        ........ 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T18:19:25.500

您可以尝试使用 live() 或 on() 包装 fancybox 调用，或者更改 FancyBox 源代码以使用 live() 而不是常规的 bind() 方法。这是一种未经测试的代码，可以让您有所了解。

// 上

```
$(document.body).on('click', '.fancybox', function() {
    $(this).fancybox({ /* options */ }).trigger('click');
    return false;
} 
```

// 居住

```
$('.fancybox').live('click', function() {
    $(this).fancybox({ /* options */ }).trigger('click');
    return false;
} 
```

# java - 连接oracle数据库时显式选择jdbc驱动

> ID：14359084
> 
> 赞同：5
> 
> 时间：2013-01-16T12:59:48.203
> 
> 标签：java, jdbc, oracle10g, oracle8i

我正在开发一些软件，这些软件有时需要连接到 oracle 8.1.7 数据库，有时需要连接到 oracle 10g 数据库才能执行一些查询。

连接到 8.1.7 数据库时，我需要使用 ojdbc14.jar 驱动程序和 10g 数据库的 ojdbc6.jar 驱动程序。

当这两个驱动程序都在类路径中时，自动驱动程序选择似乎不够聪明，无法选择正确的驱动程序，有什么方法可以在我的代码中指定首选哪个驱动程序？

我目前没有使用任何连接池或类似的抽象，但如果需要，引入类似的东西不会有问题。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:41:34.917

如果你不使用 dbcp 那么你可以这样做

```
class Test 
        static Driver driver5;
        static Driver driver6;

        static void init() throws Exception {
            ClassLoader cl5 = new URLClassLoader(new URL[] { new URL("file:lib/ojdbc15.jar") });
            driver5 = (Driver) cl5.loadClass("oracle.jdbc.driver.OracleDriver").newInstance();
            ClassLoader cl6 = new URLClassLoader(new URL[] { new URL("file:lib/ojdbc6.jar") });
            driver6 = (Driver) cl6.loadClass("oracle.jdbc.driver.OracleDriver").newInstance();
        }

        public static void main(String[] args) throws Exception {
            Properties props = new Properties();
            props.put("user", "user");
            props.put("password", "pwd");
            String url = "jdbc:oracle:thin:@host:1529:sid";
            Connection conn5 = driver5.connect(url, props);
            Connection conn6 = driver6.connect(url, props);
        } 
```

请注意，ojdbc15.jar 和 ojdbc6.jar 不应该在 java 类路径上，它们对于应用程序类加载器应该是不可见的

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:07:59.123

您无法决定使用连接池在运行时使用哪个驱动程序，但是使用连接池（具有 xml 格式的定义）您无需在更改驱动程序后一次又一次地编译代码。

但是对于运行时驱动程序选择实现，您可以创建自己的 SQL 帮助器类，所有 SQL 配置和 SQL 相关操作都将在其中执行。在其中创建一个名为 openConnection(String driver, String username, String password) 的方法，在这里您可以决定我们在运行时使用哪个驱动程序。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:18:26.463

您可以创建一个驱动程序工厂类来抽象要使用的驱动程序版本

从您的运行时提供输入作为您想要的驱动程序类型，工厂应返回该特定类型

# c# - 如何在 System.Byte 上使用 MiscUtil.Operator？

> ID：14359087
> 
> 赞同：4
> 
> 时间：2013-01-16T13:00:09.787
> 
> 标签：c#, generics

我使用[MiscUtil](http://www.yoda.arachsys.com/csharp/miscutil/) Operators 一段时间没有任何大问题。但是现在我发现了一些真正困扰我的事情：

```
byte first = 13;
byte second = 29;

byte result = MiscUtil.Operator.Add(first, second); 
```

这个等式的简单预期结果应该是`result == 42`，但不幸的是，这会引发`InvalidOperationException`：

```
The binary operator Add is not defined for the types 'System.Byte' and 'System.Byte'. 
```

通过仔细观察这种奇怪的行为，您会发现`System.Byte`实际上并没有实现这些运算符。在 C# 中，这些类型将被隐式转换为 an`Int32`并且确实实现了这些运算符。

所以现在的问题是：有没有机会让 MiscUtil 与`byte`and一起工作`sbyte`？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:12:12.437

从技术上讲，`int`etc*也*没有实现这些运算符。它们不是由正常意义上的“操作员”提供的（这将涉及 static- `call`），而是直接由`add`操作码表示。最终，这种情况下的失败实际上来自`Expression`API：

```
var x = Expression.Parameter(typeof(byte));
var y = Expression.Parameter(typeof(byte));
var func = Expression.Lambda<Func<byte,byte,byte>>(
    Expression.Add(x,y), x, y).Compile(); // explodes here 
```

要*修复*它，MiscUtil 必须对`byte`/`sbyte`版本进行特殊处理；就像是：

```
var x = Expression.Parameter(typeof(byte));
var y = Expression.Parameter(typeof(byte));
var func = Expression.Lambda<Func<byte,byte,byte>>(
    Expression.Convert(
        Expression.Add(
            Expression.Convert(x, typeof(int)),
            Expression.Convert(y, typeof(int))
         ),typeof(byte)), x, y).Compile(); 
```

然而！我已经很久没有知道 Jon 的 repo 的密钥了；p

不过，奇怪的是，在原始 IL 中实现整个事情并不难......我实际上（在 USB 驱动器上）偶然发现了一个非常古老的 .NET 2.0（即之前`Expression`）版本的“通用运算符”我多年前写的那篇文章，也许可以胜任。或者更简单：只需在本地修补 MiscUtil 以处理`byte`/ `sbyte`。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T14:13:22.877

感谢 Marc 的回答，我修补了本地版本的 MiscUtil。使用*ExpressionUtil.cs*文件，我应用了以下补丁：

```
Index: ExpressionUtil.cs
===================================================================
--- ExpressionUtil.cs
+++ ExpressionUtil.cs
@@ -68,6 +68,18 @@
             {
                 try
                 {
+                    if (typeof(TArg1) == typeof(byte)
+                       || typeof(TArg1) == typeof(sbyte)
+                       || typeof(TArg2) == typeof(byte)
+                       || typeof(TArg2) == typeof(sbyte))
+                    {
+                        return Expression.Lambda<Func<TArg1, TArg2, TResult>>(
+                            Expression.Convert(body(
+                                    Expression.Convert(lhs, typeof(int)),
+                                    Expression.Convert(rhs, typeof(int))
+                                 ), typeof(TResult)), lhs, rhs).Compile();
+                    }
+
                     return Expression.Lambda<Func<TArg1, TArg2, TResult>>(body(lhs, rhs), lhs, rhs).Compile();
                 }
                 catch (InvalidOperationException) 
```

所以也许有一天*官方版本*会更新，或者任何需要它的人都可以从这里获取并在本地应用补丁。

# iphone - 如何将经过的时间量显示为人类可读的字符串，如“10 秒前”或“3 小时前”？

> ID：14359093
> 
> 赞同：0
> 
> 时间：2013-01-16T13:00:13.827
> 
> 标签：iphone, ios, objective-c, ipad

> **可能重复：**
> [从 unix 时间戳获取人类可读的相对时间和日期？](https://stackoverflow.com/questions/4260558/getting-human-readable-relative-times-and-dates-from-a-unix-timestamp)

我所拥有的只是`NSTimeInterval`过去。如何将其转换为“ `humanly readable`”字符串，如“ `10 seconds ago`”或“ `3 hours ago`”？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:04:27.593

NSTimeInterval 给你几秒钟。

确认秒数后，您可以使用 % 和 / 来查找天、小时、分钟和秒。

看这个演示：

```
NSInteger seconds = totalSecondsSinceStart % 60;
NSInteger minutes = (totalSecondsSinceStart / 60) % 60;
NSInteger hours = totalSecondsSinceStart / (60 * 60);
NSString *result = NSString stringWithFormat:@"%02ld hour %02ld minutues %02ld seconds ago", hours, minutes, seconds]; 
```

输出将如下所示：

```
01 hours 34 minutes 49 seconds ago 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:58:14.717

更多格式，因此您看不到 0 小时 0 分 34 秒。

```
+(NSString *)returnRelativeTime:(NSString *)dateString
{
    NSDateFormatter *formatter = [[NSDateFormatter alloc]init];
    [formatter setDateFormat:@"yyyy-MM-dd'T'HH:mm:ssZ"];
    NSDate *date = [formatter dateFromString:dateString];
    int timeSince = [date timeIntervalSinceNow] * -1;

    int days    = (timeSince / (3600 * 24));
    int hours   = (timeSince / 3600)- (days *24);
    int minutes = (timeSince % 3600) / 60;
//    int seconds = (timeSince % 3600) %  60;
//    return [NSString stringWithFormat:@"%02d:%02d:%02d",hours ,minutes, seconds];
    if (days >0) {
         return [NSString stringWithFormat:@"%01d days %01d hours ago",days, hours];
    }
    else if (hours == 0) {
        return [NSString stringWithFormat:@"%01dm ago", minutes];
    }
    else {
        return [NSString stringWithFormat:@"%01dh %01dm ago", hours ,minutes];
    }

} 
```

# ruby-on-rails - 覆盖 Rails date_select 表单助手

> ID：14359097
> 
> 赞同：0
> 
> 时间：2013-01-16T13:00:28.120
> 
> 标签：ruby-on-rails, ruby-on-rails-3.2

我想在我的应用程序（运行 Rails 3.2）中覆盖 date_select 表单助手，以`:selected`从[Rails 4 date_select](https://github.com/rails/rails/blob/1dd89250d12aba01d605af270201371e5cec89a4/actionpack/lib/action_view/helpers/tags/date_select.rb#L30)中引入参数。

[覆盖默认的 Rails date_select](https://stackoverflow.com/questions/4007675/overriding-default-rails-date-select)现在有点老了，但我正在引用它来尝试使其工作。

所以我在一个文件中有以下内容`lib/`，包括在底部`environment.rb`：

```
ActionView::Helpers::Tags::DateSelect.class_eval do
#
# Note: Using ActionView::Helpers::DateTimeSelector as suggested in 
# linked question doesn't error, but also doesn't seem to do anything.
#
  def datetime_selector(options, html_options)
    datetime = options[:selected] || value(object) || default_datetime(options)
    @auto_index ||= nil

    options = options.dup
    options[:field_name]           = @method_name
    options[:include_position]     = true
    options[:prefix]             ||= @object_name
    options[:index]                = @auto_index if @auto_index && !options.has_key?(:index)

    DateTimeSelector.new(datetime, options, html_options)
  end

end 
```

但是，当尝试启动我的应用程序时，我看到：

```
NameError: uninitialized constant ActionView::Helpers::Tags 
```

在控制台中播放时可以确认这一点：

```
1.9.3-p327 :001 > ActionView
 => ActionView 
1.9.3-p327 :002 > ActionView::Helpers
 => ActionView::Helpers 
1.9.3-p327 :003 > ActionView::Helpers::Tags
NameError: uninitialized constant ActionView::Helpers::Tags
  from (irb):3
  from /Users/colin/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.11/lib/rails/commands/console.rb:47:in `start'
  from /Users/colin/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.11/lib/rails/commands/console.rb:8:in `start'
  from /Users/colin/.rvm/gems/ruby-1.9.3-p327/gems/railties-3.2.11/lib/rails/commands.rb:41:in `<top (required)>'
  from script/rails:6:in `require'
  from script/rails:6:in `<main>' 
```

那么，为什么`ActionView::Helpers::Tags`无效，什么时候定义类，以及如何正确覆盖该类以覆盖 datetime_selector 方法？

* * *

**回答**

在 Dan 指出我试图对错误的文件进行猴子补丁之后，解决方案相当简单——这段代码完成了这项工作（放置在初始化程序中）：

```
ActionView::Helpers::InstanceTag.class_eval do
  def datetime_selector(options, html_options)
    datetime = options.fetch(:selected) { value(object) || default_datetime(options) }

    @auto_index ||= nil

    options = options.dup
    options[:field_name]           = @method_name
    options[:include_position]     = true
    options[:prefix]             ||= @object_name
    options[:index]                = @auto_index if @auto_index && !options.has_key?(:index)

    ActionView::Helpers::DateTimeSelector.new(datetime, options, html_options)
  end
end 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:27:52.123

`ActionView::Helpers::Tags`在 Rails 4 中是新的（您链接到 rails master 分支，即 4.0 分支），您正在使用 Rails 3.2.x 应用程序，您需要查看该 3.2stable 分支的源代码。这看起来像猴子补丁[date_select的地方](https://github.com/rails/rails/blob/3-2-stable/actionpack/lib/action_view/helpers/date_helper.rb#L220)

# iphone - XML标签xcode保存文件

> ID：14359100
> 
> 赞同：0
> 
> 时间：2013-01-16T13:00:30.487
> 
> 标签：iphone, ios, objective-c, xcode, ipad

我想为具有不同标签名称的每一行输出标签，并希望将每个标签保存在一个文件中。我可以写文件，但是写完了。如何将每一行写入不同的文件？

**输入：**

英国泰坦尼克号
leondradicapro 凯特

德国酒店 hüßßan
tomhanks 安吉娜

**输出：**

```
<language>english<language/>
<movie>titanic<movie/>
<Actor>leondradiacpro<Actor/>
<Actress>kate<Actress/>

<language>German<language/>
... 
```

代码：

```
 for (NSString *str in lineFile)

                {

                    if([str hasPrefix:@"english "])  
                    {

                        NSMutableArray *dd = [[NSMutableArray alloc] initWithArray:[[str stringByReplacingOccurrencesOfString:@"english" withString:@""] componentsSeparatedByString:@" "]];

                    NSArray *tag = [NSArray aarrayWithObjects:@"er",@"langauge",@"movie",@"actor",@"kate",nil];

                    NSMutableString *output =[[NSMutableString alloc] init];
                    NSUInteger tagindex =0;

                    for (NSString *words in word)

                    {
                        if(tagindex >=[tag count])
                        {

                            NSLog(@"dad");
                            break;
                    }
                        [output appendFormat:@"<%@>%@<%@>\n", [tag objectAtIndex:tagindex],words,[tag objectAtIndex:tagindex]];
                        NSLog(@"%@",output);
 [output writeToFile:@"/Users/xx/Desktop/homework.txt" atomically:YES encoding:NSASCIIStringEncoding error:NULL];    
                        tagindex++; 
```

现在我只能阅读语言和电影（第一行）我如何添加第二行和标签

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:31:01.177

你需要用c方法写文件，也许下面的方法可以帮助你

```
-(void)writeToFile:(NSString *)str:(NSString *) fileName
{
    NSData* data = [str dataUsingEncoding:NSUTF8StringEncoding];
    NSString *filePath=[NSString stringWithFormat:@"%@",fileName];
    if([[NSFileManager defaultManager] fileExistsAtPath:filePath] == NO){
        NSLog(@"file not exist,create it...");
        [[NSFileManager defaultManager] createFileAtPath:filePath contents:nil attributes:nil];
    }else {
                NSLog(@"file exist!!!");
    }

    FILE *file = fopen([filePath UTF8String], [@"ab+" UTF8String]);

    if(file != NULL){
        fseek(file, 0, SEEK_END);
    }
    int readSize = [data length];
    fwrite((const void *)[data bytes], readSize, 1, file);
    fclose(file);
} 
```

# alfresco - 如何在 webscript 中设置/更改露天文档的创建者

> ID：14359102
> 
> 赞同：2
> 
> 时间：2013-01-16T13:00:38.093
> 
> 标签：alfresco

如何在上传文档的 Alfresco 中更改 webscript 中的“创建者”属性？

我正在使用 Alfresco 4.2，顺便说一句。

最好的，D

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T15:35:06.370

“cm:creator”是一个受控的审计属性，不能直接更改。很像“cm:modifier”，当用户权限修改文档节点的内容/属性（内容实际上只是一个特殊属性）时，系统会更新它。

您可以通过存储库 API 更改文档的所有者。虽然这是一个权限更改，但仍不会更改 cm:creator 属性（它不应该）。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-11-07T11:27:19.217

如果我没记错***cm:creator***、***cm:modifier***、***cm:created***、***cm:modified***等......是 Alfresco 中的可审计属性，这意味着无法手动更新，因为它们由 Alfresco 管理。

我开发了一个 java 支持的 webscript，并添加了这个工作正常的代码（更新创建者和修饰符属性）：

```
// Disable auditable aspect to allow change properties of cm:auditable aspect
policyBehaviourFilter.disableBehaviour(nodeRef, ContentModel.ASPECT_AUDITABLE);

// Update properties of cm:auditable aspect
nodeService.setProperty(nodeRef, ContentModel.PROP_CREATOR, "xxxxxx");
nodeService.setProperty(nodeRef, ContentModel.PROP_MODIFIER, "xxxxxx");

// Enable auditable aspect
policyBehaviourFilter.enableBehaviour(nodeRef, ContentModel.ASPECT_AUDITABLE); 
```

Don't forget to add in your context.xml file where you declare your beans:

```
<bean id="xxxxxxxx" 
      class="your class package"
  parent="webscript">
  <property name="nodeService" ref="NodeService" />
  ........
      <property name="policyBehaviourFilter" ref="policyBehaviourFilter" />     
</bean> 
```

Good luck

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T18:41:40.567

你可以看看[这个论坛帖子](https://forums.alfresco.com/en/viewtopic.php?f=36&t=18739)。

如前所述，设置该字段后，将无法再更改。您可以或更改 contentModel.xml 以将 cm:creator 字段设置为默认值（即读写）。

或者，您可以立即复制文档并将 FullyAuthenticatedUser 设置一小段时间，然后再将其还原。您将需要为它编写一些Java 代码（例如在Java 动作中）。

# ruby - MiniTest：在测试中使用种子

> ID：14359108
> 
> 赞同：1
> 
> 时间：2013-01-16T13:00:58.590
> 
> 标签：ruby, minitest

有没有办法在测试用例中使用我的 minitest/autorun 的种子？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T16:26:51.623

只是猜测：[Kernel::srand](http://www.ruby-doc.org/core-1.9.3/Kernel.html#method-i-srand)。

```
seed = srand  # set a new seed and return the current one
srand(seed)   # restore it 
```

# sql - 搜索引擎的 SQL 查询

> ID：14359113
> 
> 赞同：5
> 
> 时间：2013-01-16T13:01:15.923
> 
> 标签：sql, sql-server, sql-server-2008

我的项目基于问答（stackoverflow 风格）。

我需要允许用户搜索以前提出的问题。

**问题**表将如下所示：

```
Questions
-------------------------------------------------
id                 questions
-------------------------------------------------
1                  How to cook pasta?
2                  How to Drive a car?
3                  When did Napoleon die? 
```

现在，当我要写一些要搜索的东西时，我会写这样的东西：

```
When did Brazil win the world cup? 
```

假设我要将这个**字符串****分割**成一个**字符串数组**。

 ****获取包含这些字符串的所有问题的最佳**SELECT** SQL 查询是什么，忽略每个单词的大写和小写，并按较少提及的单词对结果进行排序，为什么？

因为会有很多问题会包含**When、and、will、how**等，但不会有很多问题会涉及到**Brazil**，所以**Brazil**就像**Key Word**。

我正在使用 SQL Server 2008。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:05:07.037

您真的不想在原始 SQL 中执行此操作。

我建议您查看数据库的全文搜索选项，[这](http://msdn.microsoft.com/en-us/library/ms142571%28v=sql.100%29.aspx)可能是一个不错的起点。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:06:12.510

在 mysql 中，你有全文索引和 match() 选择函数，它只允许这样做，在 SQL Server 中，你应该使用函数 Contains() 在 [http://msdn.microsoft.com/en-us/library上查找更多信息/ms142571.aspx](http://msdn.microsoft.com/en-us/library/ms142571.aspx)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T15:57:53.193

你的选择不是最好的。看看开源的 Apache Solr 项目。[http://lucene.apache.org/solr/](http://lucene.apache.org/solr/)

Solr 是一个独立的企业搜索服务器，具有类似 REST 的 API。您可以通过 XML、JSON、CSV 或 HTTP 上的二进制文件将文档放入其中（称为“索引”）。您通过 HTTP GET 查询它并接收 XML、JSON、CSV 或二进制结果。

*   针对高容量 Web 优化的高级全文搜索功能
*   基于流量标准的开放接口 - XML、JSON 和 HTTP
*   全面的 HTML 管理界面 服务器统计
*   通过 JMX 公开以进行监控 线性可扩展、自动索引
*   复制、自动故障转移和恢复 近实时索引
*   灵活且可适应 XML 配置 可扩展插件架构

查看详细功能和特别查询部分。您的应用程序所需的一切。****

# r - 转换纬度和经度

> ID：14359115
> 
> 赞同：4
> 
> 时间：2013-01-16T13:01:19.213
> 
> 标签：r

以下数据框表示经纬度十进制坐标。我希望使用 + 和 - 来显示十进制度是北、南、东还是西（在纬度和经度列中）。

因此，如果十进制度为 N，则纬度将为正。如果十进制度为 S，则纬度将为负。如果十进制度为 E，则经度将为正，如果十进制度数是 W。

```
a <- c(1:3)
Lat <- c(54.5, 55.2, 10.1)
NS <- c("N","N","S")
Long <- c(1.2, 0.5, 1.3)
EW <- c("W","E","W")
df1 <- data.frame(a,Lat,NS,Long,EW) 
```

我将如何在 R 中做到这一点？任何建议将不胜感激。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:07:48.747

使用`ifelse`：

```
df1 <- within(df1, {
             Lat <- ifelse(NS=="N", Lat, -Lat)
             Long <- ifelse(EW=="E", Long, -Long)
})

df1
  a   Lat NS Long EW
1 1  54.5  N -1.2  W
2 2  55.2  N  0.5  E
3 3 -10.1  S -1.3  W 
```

* * *

我`within()`用来减少打字量。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:07:37.780

很简单`ifelse`：

```
df2 <- data.frame(a=df1$a, Lat=ifelse(df1$NS=="N", df1$Lat, -1*df1$Lat), 
                           Long=ifelse(df1$EW=="E", df1$Long, -1*df1$Long))

df2
  a   Lat  Long
1 1  54.5 -1.2
2 2  55.2  0.5
3 3 -10.1 -1.3 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:08:02.747

请参阅 NMEA 转换：[http](http://www.nmea.org/) ://www.nmea.org/ 但是，您可以在 for() 方法中执行此操作以获取一个位置

# c# - WCF 服务器端崩溃 CommunicationObjectFaultedException：

> ID：14359116
> 
> 赞同：0
> 
> 时间：2013-01-16T13:01:25.640
> 
> 标签：c#, wcf, exception, client-server

WCF 服务（服务器）在一段时间内运行良好，但它意外崩溃并出现异常，此异常记录在**AppDomain.CurrentDomain.UnhandledException**中：

```
System.ServiceModel.CommunicationObjectFaultedException: The communication object, System.ServiceModel.Channels.SecurityChannelListener`1+SecurityReplySessionChannel[System.ServiceModel.Channels.IReplySessionChannel], cannot be used for communication because it is in the Faulted state.
   at System.ServiceModel.Channels.CommunicationObject.ThrowIfFaulted()
   at System.ServiceModel.Channels.SecurityChannelListener`1.ReceiveItemAndVerifySecurityAsyncResult`2.StartInnerReceive()
   at System.ServiceModel.Channels.SecurityChannelListener`1.ReceiveItemAndVerifySecurityAsyncResult`2.OnFaultSent()
   at System.ServiceModel.Channels.SecurityChannelListener`1.ReceiveItemAndVerifySecurityAsyncResult`2.OnInnerReceiveDone()
   at System.ServiceModel.Channels.SecurityChannelListener`1.ReceiveItemAndVerifySecurityAsyncResult`2.StartInnerReceive()
   at System.ServiceModel.Channels.SecurityChannelListener`1.ReceiveItemAndVerifySecurityAsyncResult`2.Start()
   at System.ServiceModel.Channels.SecurityChannelListener`1.ReceiveRequestAndVerifySecurityAsyncResult.ReceiveMessage(Object state)
   at System.Runtime.IOThreadScheduler.ScheduledOverlapped.IOCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* nativeOverlapped)
   at System.Runtime.Fx.IOCompletionThunk.UnhandledExceptionFrame(UInt32 error, UInt32 bytesRead, NativeOverlapped* nativeOverlapped)
   at System.Threading._IOCompletionCallback.PerformIOCompletionCallback(UInt32 errorCode, UInt32 numBytes, NativeOverlapped* pOVERLAP) 
```

没有xml配置，一切都是在运行时配置的。服务上下文是单一的，并发是多重的。

我们已禁用重放检测。我们的用户在他们的 PC 上设置了错误的日期时间时遇到了很多问题，因此我们被迫“禁用”时间偏差。Net.Tcp 绑定用于通信，我们使用回调。

使用自定义错误处理程序，HandleError 总是返回 false。

**当前解决方案：**服务设置为崩溃后自动重启，但这并不令人满意。

* * *

**配置（用值替换常量变量）：**

```
Uri tcpBaseAddress = new Uri(String.Format("net.tcp://localhost:{0}", MyMwcNetworkingConstants.NETWORKING_PORT_MASTER_SERVER_NEW));

// create the net.tcp binding for the service endpoint
NetTcpBinding ntcBinding = new NetTcpBinding();
ntcBinding.Security.Mode = SecurityMode.None;
ntcBinding.MaxBufferPoolSize = 1024*1024;
ntcBinding.MaxBufferSize = 10*1024;
ntcBinding.MaxConnections = 500;
ntcBinding.ListenBacklog = 500;
ntcBinding.MaxReceivedMessageSize = 10*1024;
ntcBinding.ReaderQuotas.MaxArrayLength = 10*1024;
ntcBinding.ReaderQuotas.MaxBytesPerRead = 10*1024;
ntcBinding.SendTimeout = 90s;
ntcBinding.ReceiveTimeout = 90s;
ntcBinding.Security.Mode = SecurityMode.Message;
ntcBinding.Security.Message.ClientCredentialType = MessageCredentialType.UserName;
ntcBinding.Security.Transport.ClientCredentialType = TcpClientCredentialType.None;
ntcBinding.Security.Transport.ProtectionLevel = System.Net.Security.ProtectionLevel.None;

m_host = new System.ServiceModel.ServiceHost(Service, tcpBaseAddress);
m_host.Credentials.UserNameAuthentication.CustomUserNamePasswordValidator = new MyUserValidator();
m_host.Credentials.UserNameAuthentication.UserNamePasswordValidationMode = System.ServiceModel.Security.UserNamePasswordValidationMode.Custom;
m_host.Credentials.ServiceCertificate.Certificate = new System.Security.Cryptography.X509Certificates.X509Certificate2(MyMasterConstants.MASTER_CERTIFICATE, string.Empty);
m_host.Credentials.ClientCertificate.Authentication.CustomCertificateValidator = new MyCertificateValidator(String.Empty);
m_host.Credentials.ClientCertificate.Authentication.CertificateValidationMode = System.ServiceModel.Security.X509CertificateValidationMode.None;

var endpoint = m_host.AddServiceEndpoint(typeof(IMyMasterService), MyCustomBinding.DecorateBinding(ntcBinding, MyMasterConstants.WCF_MAX_CLIENT_COUNT), tcpBaseAddress);
m_host.Open(); 
```

**这是我的自定义绑定：**

```
public static class MyCustomBinding
{
    public static Binding DecorateBinding(Binding binding, int? maxNegotiationCount)
    {
        CustomBinding customBinding = new CustomBinding(binding);
        SymmetricSecurityBindingElement security = customBinding.Elements.Find<SymmetricSecurityBindingElement>();
        if (security != null)
        {
            security.IncludeTimestamp = false;
            security.LocalClientSettings.DetectReplays = false;
            security.LocalServiceSettings.DetectReplays = false;
            security.LocalClientSettings.MaxClockSkew = TimeSpan.MaxValue;
            security.LocalServiceSettings.MaxClockSkew = TimeSpan.MaxValue;
            security.LocalClientSettings.SessionKeyRenewalInterval = TimeSpan.MaxValue;
            security.LocalServiceSettings.SessionKeyRenewalInterval = TimeSpan.FromMilliseconds(Int32.MaxValue);

            if (maxNegotiationCount.HasValue)
            {
                security.LocalServiceSettings.MaxPendingSessions = maxNegotiationCount.Value;
                security.LocalServiceSettings.MaxStatefulNegotiations = maxNegotiationCount.Value;
            }

            // Get the System.ServiceModel.Security.Tokens.SecureConversationSecurityTokenParameters
            SecureConversationSecurityTokenParameters secureTokenParams = (SecureConversationSecurityTokenParameters)security.ProtectionTokenParameters;

            // From the collection, get the bootstrap element.
            SecurityBindingElement bootstrap = secureTokenParams.BootstrapSecurityBindingElement;

            // Set the MaxClockSkew on the bootstrap element.
            bootstrap.IncludeTimestamp = false;
            bootstrap.LocalClientSettings.DetectReplays = false;
            bootstrap.LocalServiceSettings.DetectReplays = false;
            bootstrap.LocalClientSettings.MaxClockSkew = TimeSpan.MaxValue;
            bootstrap.LocalServiceSettings.MaxClockSkew = TimeSpan.MaxValue;
            bootstrap.LocalClientSettings.SessionKeyRenewalInterval = TimeSpan.MaxValue;
            bootstrap.LocalServiceSettings.SessionKeyRenewalInterval = TimeSpan.FromMilliseconds(Int32.MaxValue);

            if (maxNegotiationCount.HasValue)
            {
                bootstrap.LocalServiceSettings.MaxPendingSessions = maxNegotiationCount.Value;
                bootstrap.LocalServiceSettings.MaxStatefulNegotiations = maxNegotiationCount.Value;
            }

            return customBinding;
        }
        else
        {
            return binding;
        }
    }

    public static Binding DecorateBinding(Binding binding)
    {
        return DecorateBinding(binding, null);
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-24T11:45:58.353

我的情况与您完全相同（WCF 服务在生产中随机崩溃，无法在开发中复制，堆栈跟踪与您的相同）。我找到了以下 KB，很快就会尝试一下：http: [//support.microsoft.com/kb/2600907/en-us](http://support.microsoft.com/kb/2600907/en-us)。“此修补程序尚未完全测试”阻止我立即应用它。

如果您尝试，请告诉我，它可以解决您的问题。希望这可以帮助。

# c++ - 如何在 C++ 中将打印从屏幕（或任何 FILE*）重定向到字符串/char*

> ID：14359117
> 
> 赞同：0
> 
> 时间：2013-01-16T13:01:26.483
> 
> 标签：c++, file, char

我正在编写 C++ 代码，我希望执行以下操作：

在代码中有一个新类型 T，在 T 上定义了一个方法，它将一些信息打印到类型 FILE* 变量中。

我想在程序内部对这个字符串做一些工作，所以我想要一个字符串类型的变量（甚至是 char*），它将包含打印到屏幕上的内容（如果我将打印函数 stdout 指定为文件*）。

我怎样才能做到这一点 ？也许我可以创建一些 FILE* 变量，然后（以某种方式）使用我们创建的 File* 变量中存储的信息创建一个字符串/char* 变量？

任何帮助表示赞赏！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:17:15.890

POSIX 1.2008 `fmemopen`，`open_memstream`函数创建一个`FILE*`指针，该指针写入（和/或读取）内存。

如果它不适用于您的平台（并且没有其他方法可以连接`FILE *`），那么您就不走运了。

我要尝试的下一件事是创建一个匿名管道 (POSIX `pipe`, Windows `CreatePipe`)，将其写入端包装到`FILE *`(POSIX`fdopen`和 Windows`_open_osfhandle`以从 HANDLE 获取 CRT fd)。在这里，您必须确保管道的缓冲区大小足够，*或者*生成一个线程来读取管道。`fflush`方法完成后不要忘记写入端（或用于`setbuf`禁用缓冲）。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:20:17.917

有几种独立于平台的方法可以做到这一点。在 C++ 中，您可以使用`stringstream(http://www.cplusplus.com/reference/sstream/stringstream/)`，它有许多`<<`运算符重载。因此，如果您将`ostream&`(not `oFstream`) 的引用传递给输出方法，您可以轻松地在文件、标准输出流和字符串输出之间切换，因为所有这些流都继承自 ostream。然后，如果需要，您可以从中获取`std::string`对象并从中获取 C 字符串。`stringstream`

代码示例：

输出函数（或方法，则不需要示例中的第二个参数）：

```
void PrintMyObjectToSomeStream(std::ostream& stream, const MyClass& obj)
{
    stream << obj.pubField1;
    stream << obj.pubField2;
    stream << obj.GetPrivField1();
    stream << "string literal";
    stream << obj.GetPrivField2();
} 
```

用法：

```
MyClass obj1;
std::ofsstream ofs;
std::stringstream sstr;
//...open file for ofs, check if it is opened and so on...
//...use obj1, fill it's member fields with actual information...
PrintMyObjectToSomeStream(obj1,std::cout);//print to console
PrintMyObjectToSomeStream(obj1,sstr);//print to stringstream
PrintMyObjectToSomeStream(obj1,ofs);//print to file

std::string str1=sstr.str();//get std::string from stringstream
char* sptr1=sstr.str().c_str();//get pointer to C-string from stringstream 
```

或者你可以重载`operator<<`：

```
std::ostream& operator<<(std::ostream& stream, const MyClass& obj)
{
    stream << obj1.pubField;
    //...and so on
    return stream;
} 
```

那么你可以这样使用它：

```
MyClass obj2;
int foo=100500;
std::stringstream sstr2;
std::ofstream ofs;//don't forget to open it

//print to stringstream
sstr2 << obj2 << foo << "string lineral followed by int\n";
//here you can get std::string or char* as like as in previous example

//print to file in the same way
ofs << obj2 << foo << "string lineral followed by int\n"; 
```

使用`FILE`C 比 C++ 更多，但您可以考虑如何在`fpirntf`和`sprintf`或使用 Anton 的答案之间切换。

# adapter - BizTalk2013Beta WCF-WebHttp 适配器问题

> ID：14359131
> 
> 赞同：0
> 
> 时间：2013-01-16T13:02:47.460
> 
> 标签：adapter, biztalk

我安装了新版本的 BizTalk2013Beta。当尝试添加使用 WCF-WebHttp 适配器的接收位置或发送端口时，我收到此错误：

你调用的对象是空的。(Microsoft.BizTalk.Administration.SnapIn)

如何解决？

# visual-studio - ReSharper 键绑定问题

> ID：14359137
> 
> 赞同：2
> 
> 时间：2013-01-16T13:03:16.933
> 
> 标签：visual-studio, resharper

我正在使用 Visual Studio 2012 + ReSharper 7。我有 R# Visual Studio 键绑定方案，它使用 Ctrl-D 复制一行，但这阻止了我使用任何调试窗口快捷方式 - 例如。Ctrl-D, L 转到本地窗口。有谁知道解决冲突的最简单方法是什么？当然，我不必重新分配所有调试窗口快捷方式吗？

# c# - 对 SharePoint 列表项重新排序的最佳方式是什么？

> ID：14359140
> 
> 赞同：2
> 
> 时间：2013-01-16T13:03:25.543
> 
> 标签：c#, sharepoint, sharepoint-2010

我目前正在开发一个呈现特定元素的 Web 部件，这些元素的属性取自 SharePoint 列表。

我计划在 SP 列表中添加一个字段，允许 SharePoint 用户输入一个数字来指定呈现元素的顺序。

**问题：**实现这一点的最佳方法是什么（请记住，用户可能会输入相同的值两次或在不知道的情况下按顺序省略一个数字）？

**示例：**我们有元素及其 Order 值：`A 1`, `B 2`, `C 3`, `D 4`, `E 5`。

如果用户将 Order 值更改为：`A 1`, `B 4`, `C 3`, `D 4`, `E 5`，则元素应按顺序呈现：`A`, `C`, `B`, `D`, `E`。

如果用户将 Order 值更改为：`A 1`, `B 7`, `C 3`, `D 4`, `E 5`，则元素应按顺序呈现：`A`, `C`, `D`, `E`, `B`。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:12:12.300

我建议您使用`SPQuery`，它也应该更有效。

当您使用 SPQuery 时，您可以根据需要指定`OrderBy`。

这是一个使用它的例子：http: [//msdn.microsoft.com/en-us/library/ms457534 (v=office.14).aspx](http://msdn.microsoft.com/en-us/library/ms457534(v=office.14).aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T07:13:07.950

SharePoint 2010 中的列表项重新排序有现成的解决方案。

http(s)://yousiteurl/_layouts/Reorder.aspx?List=ListGUID

重新订购商品后，您可以使用 CAML 查询使用 item["Order"] 按您的商品订购。

您可以在页面上的模式对话框中调用此页面，或使用自定义操作将其集成到功能区中。

可以在[此处](http://consultingblogs.emc.com/mattlally/archive/2012/01/16/add-change-item-order-to-a-custom-link-list.aspx)找到如何执行此操作的更多信息。

希望能帮助到你，

安德鲁

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:24:53.257

如果您创建一个新`SPField`的来存储列表项订单，您必须知道此值将无法按用户自定义。它们被分配给列表项并且对所有用户都是相同的。

我相信您应该看看[创建具有自定义属性的 Web 部件](http://msdn.microsoft.com/en-us/library/dd584174%28office.11%29.aspx)主题。您可以将项目 ID 映射到每个用户个性化的自定义序号序列。然后，您可以覆盖默认顺序，并在一些客户端脚本的帮助下，您可以重新排列项目。当然，当使用分页显示项目时，事情可能会变得复杂。

但是满足您的要求的更现实的方法是创建几个字段（`CustomOrder1`等`CustomOrder1`），然后创建一些基于这些字段排序的自定义视图。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2016-08-02T09:07:57.023

这是最简单的解决方案。激活链表重新排序按钮。 [https://pgbhoyar.com/2013/05/15/how-to-reorder-sharepoint-list-items-using-custom-codepowershell-and-sharepoint-designer-in-sharepoint-2010-and-sharepoint-2013- 2/](https://pgbhoyar.com/2013/05/15/how-to-reorder-sharepoint-list-items-using-custom-codepowershell-and-sharepoint-designer-in-sharepoint-2010-and-sharepoint-2013-2/ "关联")

# android - 将Android中的图片从sdcard加载到画布

> ID：14359148
> 
> 赞同：0
> 
> 时间：2013-01-16T13:03:47.913
> 
> 标签：android, android-canvas, sd-card

当我在画布上绘制并保存它时，它可以正常工作，
但是当我想从 sd 卡加载图片时，我得到了一些错误（但是当我加载我绘制的一张图片并保存它时，它可以正常工作）

加载图片代码

```
 case R.id.menu_load:
        Intent intent = new Intent(Intent.ACTION_GET_CONTENT);
        intent.setType("image/*");
        startActivityForResult(intent, REQ_LOAD);*/
        return true;

                    public void onActivityResult(int requestCode, int resultCode, Intent data) {
    switch (requestCode) {
    case REQ_LOAD:

        if (resultCode == RESULT_OK) {
            Uri imageUri = data.getData();
            String[] filePathColumn = { MediaStore.Images.Media.DATA };

            Cursor cursor = getContentResolver().query(imageUri, filePathColumn, null, null, null);
            cursor.moveToFirst();

            int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
            final File imageFile = new File(cursor.getString(columnIndex));
            cursor.close();

            String loadMessge = getResources().getString(R.string.dialog_load);
            final ProgressDialog load = ProgressDialog.show(TpMainActivity.this, "", loadMessge, true);
            Thread thread = new Thread() {
                @Override
                public void run() {
                    //File photos= new File(imageFile);
                    //Bitmap bitmap = decodeFile(imageFile);
                    Bitmap bitmap = Utils.decodeFile(TpMainActivity.this, imageFile);
                    bitmap.compress(Bitmap.CompressFormat.PNG, 90, null);
                    paintView.setBitmap(bitmap);
                    load.dismiss();
                }
            };
            thread.start();
        }
        break;
    }
}

public static Bitmap decodeFile(Context c, File f) {
    Bitmap tmpBitmap = null;
    try {
        // Decode image size
        BitmapFactory.Options o = new BitmapFactory.Options();
        o.inJustDecodeBounds = true;
        BitmapFactory.decodeStream(new FileInputStream(f), null, o);

        // The new size we want to scale to
        final int REQUIRED_SIZE = 1024; 

        // Find the correct scale value. It should be the power of 2.
        int tmpWidth = o.outWidth, tmpHeight = o.outHeight;
        int scale = 1;

    while (tmpWidth / 2 > REQUIRED_SIZE || tmpHeight / 2 > REQUIRED_SIZE) { 
            tmpWidth /= 2;
            tmpHeight /= 2;
            scale *= 2;
        }

        // Decode with inSampleSize
        BitmapFactory.Options o2 = new BitmapFactory.Options();
        o2.inSampleSize = scale;

        tmpBitmap = BitmapFactory.decodeStream(new FileInputStream(f), null, o2);

        // http://sudarnimalan.blogspot.com/2011/09/android-convert-immutable-bitmap-into.html
        // this is the file going to use temporally to save the bytes.
        File file = new File(c.getExternalFilesDir(Environment.DIRECTORY_PICTURES), "tmp");
        file.getParentFile().mkdirs();

        // Open an RandomAccessFile
        RandomAccessFile randomAccessFile = new RandomAccessFile(file, "rw");

        // get the width and height of the source bitmap.
        int width = tmpBitmap.getWidth();
        int height = tmpBitmap.getHeight();

        // Copy the byte to the file
        // Assume source bitmap loaded using options.inPreferredConfig = Config.ARGB_8888;
        FileChannel channel = randomAccessFile.getChannel();
        MappedByteBuffer map = channel.map(MapMode.READ_WRITE, 0, width * height * 4);
        tmpBitmap.copyPixelsToBuffer(map);
        // recycle the source bitmap, this will be no longer used.
        tmpBitmap.recycle();
        // Create a new bitmap to load the bitmap again.
        tmpBitmap = Bitmap.createBitmap(width, height, Bitmap.Config.ARGB_8888);
        map.position(0);
        // load it back from temporary
        tmpBitmap.copyPixelsFromBuffer(map);
        // close the temporary file and channel , then delete that also
        channel.close();
        randomAccessFile.close();
        file.delete();
    } catch (FileNotFoundException e) {
        Log.e(TpApplication.TAG, "ERROR ", e);
    } catch (IOException e) {
        Log.e(TpApplication.TAG, "ERROR ", e);
    }
    return tmpBitmap;
} 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:23:14.020

要打开图像格式 SD 卡：

```
mBitmap = BitmapFactory.decodeFile("/sdcard/test.png"); 
```

# ruby-on-rails - 从相关对象中获取前 x 个项目

> ID：14359154
> 
> 赞同：2
> 
> 时间：2013-01-16T13:04:05.400
> 
> 标签：ruby-on-rails, scope, rails-activerecord

我有一个`Camping`哪个有一个`Author`。安`Author`有很多`Campings`。

获得定义为“最后 5 次露营”的“前 5 名”是通过以下方式完成的：

```
@author.campings.order(:created_at).limit(5) 
```

但是如果将“前 5 名”移到 Camping 模型中，我希望这个概念，这对我来说似乎更干净；毕竟，`Camping`唯一知道是什么`top`的人。

就像是

```
@author.campings.top 
```

但是如何定义这个`Camping`？`@author.campings`不是一个`Camping`，而是一个`ActiveRecord::Relation`。因此，*models/camping.rb*中的以下内容不起作用：

```
# Scope for "top" campings
def top(amount)
  self.order("created_at").limit(amount)
end 
```

用作

```
@author.top(5) 
```

目前，`@author`在上述示例中，我只需要通过关系来实现这个“顶级”事物。目前，“顶部”的定义只是“最近 5 次露营”，但在下一次迭代中，这将根据观看次数、评分或其他参数和字段的数量而变得更加复杂`Camping`。这让我相信这`Camping`是定义“顶部”的正确位置，而不是`Author`.

我可以将其添加到 中`Author`，但以我有限的知识，感觉就像违反了隔离模式；作者突然需要了解 Camping 上的字段：

```
# Last 5 campings for this author
def top_campings(amount)
  campings.order("created_at").limit(amount)
end 
```

用作

```
@author.top_campings(5) 
```

这种关系通常如何解决？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:09:21.397

在 Rails 3 中，您可以使用[带参数的范围](http://guides.rubyonrails.org/active_record_querying.html#passing-in-arguments)：

```
class Camping < ActiveRecord::Base
  scope :top, lambda { |amount| order("created_at").limit(amount) }
end 
```

（和添加一个类方法是一样的`Camping`，我想这两种方式都可以，所以你可以选择你喜欢的一种）

您可以按如下方式使用范围：

```
@author.campings.top(5) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:09:58.290

您可能希望以`top`这种方式在您的 Camping 类中定义：

```
class Camping < ActiveRecord::Base
  def self.top(count)
    order(:created_at).limit(count)
  end
end 
```

当您将其定义为类方法时，它可以通过 获得`ActiveRecord::Relation`，因此您可以调用`@author.campings.top(5)`

# php - 打印多个 PHP 文件而不打开它们

> ID：14359155
> 
> 赞同：-5
> 
> 时间：2013-01-16T13:04:05.263
> 
> 标签：php, pdf, printing

我有一个 PHP 系统，其中包含订单以及与订单相关的项目，

所以我想打印与特定订单相关的每个项目，而不打开文件。

我正在使用 SQL 查询来显示页面：

```
SELECT * FROM items WHERE order_id = ".$oid."; 
```

从这个订单中收集物品，对于每一个，我写

```
<a href="view.php?iid=<?php echo $theResult['id'];?>" target="_blank">
  Item <?php echo $theResult;?>
</a> 
```

因此，该页面`view.php`是默认的，可以根据需要接收`item_id`并`$_GET`构建页面。

直到这里没有问题，但是：

我想`view.php`按顺序为每个项目打印任何结果，而不必打开并单击以打印每个人。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:07:22.133

如果你坚持仍然使用单一视图文件`view.php`，一个 hacky 的解决方案可能看起来像这样：

```
<?php
    foreach ($items as $iid) {
        $_GET["iid"] = $iid;
        require("view.php"); //This will print whatever the view.php page does
    }
?> 
```

这里`$items`指定了一个包含数据库中 ID 的数组。通过设置`$_GET["iid"]`我们从数据库中获取的 id ( `$iid`) 然后包括`view.php`，您可以*模拟*对文件的调用（因此我们`view.php`将为数据库中的每个项目打印页面）。

如果这不是您想要的，那么提供更多信息会很棒，这样我们就可以一路为您提供帮助。

# php - Codeigniter - 日期格式 - 表单验证

> ID：14359158
> 
> 赞同：14
> 
> 时间：2013-01-16T13:04:17.257
> 
> 标签：php, codeigniter, codeigniter-form-helper

我正在将**codeigniter**与`PHP`. 我正在使用以下表格，

```
<?php
    echo form_open('/register/create_new', $form_params);
?>

DOB: <input type="text" id="dob" name="reg[dob]">
     <input type="submit" value="Create Account" />
</form> 
```

这里，`#dob`是`dd-mm-yyyy`格式。

我的验证码是

```
array(
  'field' => 'reg[dob]',
  'label' => 'DOB',
  'rules' => 'required'
) 
```

如何设置`rules`正确的日期验证？

* * *

## 回答 #1

> 赞同：21
> 
> 时间：2013-01-16T13:26:01.677

您可以通过创建一个检查日期是否有效的 callback_date_valid() 函数来使用[CodeIgniters 回调函数。](http://ellislab.com/codeigniter/user-guide/libraries/form_validation.html#callbacks)

要检查它是否有效，您可以使用[PHP 的 checkdate 函数](http://php.net/manual/fr/function.checkdate.php)

```
array(
  'field' => 'reg[dob]',
  'label' => 'DOB',
  'rules' => 'required|date_valid'
)

function callback_date_valid($date){
    $day = (int) substr($date, 0, 2);
    $month = (int) substr($date, 3, 2);
    $year = (int) substr($date, 6, 4);
    return checkdate($month, $day, $year);
} 
```

* * *

## 回答 #2

> 赞同：21
> 
> 时间：2016-11-29T12:40:13.900

我有一个非常干净的解决方案。您可以扩展 codeigniters 表单验证库。

通过将 MY_Form_validation.php 文件放在您的应用程序/库文件夹中来执行此操作。该文件应如下所示：

```
class MY_Form_validation extends CI_Form_validation {

    public function __construct($rules = array()) {
        parent::__construct($rules);
    }

    public function valid_date($date) {
        $d = DateTime::createFromFormat('Y-m-d', $date);
        return $d && $d->format('Y-m-d') === $date;
    }
} 
```

要添加错误消息，请转到 application/language/ 文件夹并打开 form_validation_lang.php 文件。在文件末尾的 $lang 数组中添加一个条目，如下所示：

```
$lang['form_validation_valid_date'] = 'The field {field} is not a valid date'; 
```

注意这里的key必须和函数名（valid_date）一致。

然后在您的控制器中，您将其用作任何其他表单验证功能，例如“必需”

```
$this->form_validation->set_rules('date','Date','trim|required|valid_date'); 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2013-01-16T13:16:55.220

你可以用`regex`

```
$this->form_validation->set_rules('reg[dob]', 'Date of birth', 'regex_match[(0[1-9]|1[0-9]|2[0-9]|3(0|1))-(0[1-9]|1[0-2])-\d{4}]'); 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2014-01-27T18:00:50.543

我知道这很旧，但我刚刚遇到了同样的问题。我喜欢 Winks 提供的答案，但发现代码不起作用。我将其修改为：

```
 public function your_form_handler($date)
  {
    // ....
    $this->form_validation->set_rules('date', 'Date', 'required|callback_date_valid');
    // ....
  }

  /**
   * Validate dd/mm/yyyy
   */
  public function date_valid($date)
  {
    $parts = explode("/", $date);
    if (count($parts) == 3) {      
      if (checkdate($parts[1], $parts[0], $parts[2]))
      {
        return TRUE;
      }
    }
    $this->form_validation->set_message('date_valid', 'The Date field must be mm/dd/yyyy');
    return false;
  } 
```

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2017-08-17T12:29:07.817

Codeigniter`form_validation`库中没有内置日期验证，但您可以使用它的回调来调用函数并使用 PHP 自己的功能验证日期。

使用 DateTime，您可以为所有格式制作最短的日期和时间验证器。

```
function validateDate($date, $format = 'Y-m-d H:i:s')
{
    $d = DateTime::createFromFormat($format, $date);
    return $d && $d->format($format) == $date;
}

var_dump(validateDate('2012-02-28 12:12:12')); # true
var_dump(validateDate('2012-02-30 12:12:12')); # false
var_dump(validateDate('2012-02-28', 'Y-m-d')); # true
var_dump(validateDate('28/02/2012', 'd/m/Y')); # true
var_dump(validateDate('30/02/2012', 'd/m/Y')); # false
var_dump(validateDate('14:50', 'H:i')); # true
var_dump(validateDate('14:77', 'H:i')); # false
var_dump(validateDate(14, 'H')); # true
var_dump(validateDate('14', 'H')); # true

var_dump(validateDate('2012-02-28T12:12:12+02:00', 'Y-m-d\TH:i:sP')); # true
# or
var_dump(validateDate('2012-02-28T12:12:12+02:00', DateTime::ATOM)); # true

var_dump(validateDate('Tue, 28 Feb 2012 12:12:12 +0200', 'D, d M Y H:i:s O')); # true
# or
var_dump(validateDate('Tue, 28 Feb 2012 12:12:12 +0200', DateTime::RSS)); # true
var_dump(validateDate('Tue, 27 Feb 2012 12:12:12 +0200', DateTime::RSS)); # false 
```

^(*[函数是从这个答案](https://stackoverflow.com/a/12323025/67332)或[php.net](http://www.php.net/manual/en/function.checkdate.php#113205)复制的*)

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2017-04-25T06:56:39.887

我喜欢 tmsimont 提供的答案，但发现如果输入非数值，则代码不起作用。修改后的代码如下：

```
/**
    * Validate dd/mm/yyyy
    */
    public function date_valid(){
        $date=$this->input->post('dob');
        $parts = explode("/", $date);
        if (count($parts) == 3) {     
            if (is_numeric($parts[2])) {  
                if (is_numeric($parts[0])) {
                    if (is_numeric($parts[1])) {    
                        if (checkdate($parts[1], $parts[0], $parts[2])){
                            return TRUE;
                        }
                    }
                }
            }
        }

        $this->form_validation->set_message('date_valid', 'The Date field must be mm/dd/yyyy');
        return false;
    } 
```

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2017-06-23T04:15:27.047

Codeigniter 日期验证的实际正则表达式：

```
$this->form_validation->set_rules('reg[dob]','Date of birth',array('regex_match[/^((0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.](19|20)\d\d)$/]')); 
```

我对格式 dd-mm-yyyy 和 dd/mm/yyyy 使用相同的表达式

没有警告和错误:-)

* * *

## 回答 #8

> 赞同：0
> 
> 时间：2018-06-29T10:51:16.933

我已经为 ci3 编写了这个自定义验证器 - 验证 d/m/YH:i 格式 - 您可以轻松更改它。

```
$this->form_validation->set_rules("start_date", "Start Date", 'trim|callback__check_date_valid');

   public function _check_date_valid($date){

    $this->form_validation->set_message('_check_date_valid', "Please enter a valid date");
    $d = DateTime::createFromFormat('d/m/Y H:i', $date);

    if($d && $d->format('d/m/Y H:i') === $date || $date == ''){
        return true;
    }else{

        return false;
    }

} 
```

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2019-02-22T00:53:53.493

试试这个...我认为它更简单。

```
$this->form_validation->set_rules('date', 'Date', 'trim|required|callback_checkDateFormat');

function checkDateFormat($date) {
        $d = DateTime::createFromFormat('Y-m-d', $date);
        if(($d && $d->format('Y-m-d') === $date) === FALSE){
            $this->form_validation->set_message('checkDateFormat', ''.$date.' is not a valid date format.');
            return FALSE;
        }else{
            return TRUE;
        }
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2021-02-26T13:25:24.793

根据iamyojimbo的回答，

```
 $date = [
        '28.02.2012', // true
        '28/02/2012', // true
        '28-02-2012', // true
        '28 02 2012', // true
        '28 02 1812', // false
    ];

    $pattern = '/^(0[1-9]|[12][0-9]|3[01])[\.\/\-\ ](0[1-9]|1[012])[\.\/\-\ ](19|20)\d\d$/';

    foreach ($date as $subject) {
        print_r(
            preg_match(
                $pattern,
                $subject
            )
        );
    } 
```

# javascript - 无法在服务器端读取使用 javascript 填充 asp.net 控件

> ID：14359166
> 
> 赞同：0
> 
> 时间：2013-01-16T13:04:58.793
> 
> 标签：javascript, asp.net, asp.net-controls

我有一个使用 javascript 填充的 ASP.Net 下拉列表，如下所示：

下拉列表：

```
<asp:DropDownList ID="Ddl" runat="server" AutoPostBack="true"
       EnableViewState="true"></asp:DropDownList> 
```

用“文本”填充下拉列表的 javascript 代码是：

```
var select = document.getElementById('<%= Ddl.ClientID %>');
var option = document.createElement("option");
option.value = '1';
option.innerHTML = "Text";
select.appendChild(option); 
```

它在客户端填充得很好。我添加了一个应该在服务器端运行的按钮。在服务器端，当我尝试检索 ddl 选定值时；它给出了一个异常（对象引用未设置为对象的实例。）

我知道一旦表单发送到服务器，ASP.Net ddl 控件就会丢失内容？我将如何解决这个问题？我尝试将值放在隐藏字段中并尝试使用`Request.Form["HiddenField"].toString();`，但它给出了相同的错误。有什么帮助吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:28:59.447

正如您所说，您无法在客户端填充下拉列表并让服务器端知道`ListItem`对象在那里。那是因为它们不会被发送回服务器：只有选定的值会。

即使不使用`DropDownList`. 将下拉列表创建为 HTML`select`标记。请务必设置该`name`属性（否则它不会在回发时被拾取）。然后使用该`Request.Form`集合访问 HTML 的选定值`select`。

`DropDownList`考虑到您告诉我们的内容，我能想到的使用 a 的唯一原因是，如果您打算在某个时候将它绑定到服务器端，从服务器端数据，或者如果您想更改它的外观基于服务器端计算，但不想设置 Ajax 调用。如果您不想做这些事情中的任何一个，a`select`可能会更好地为您服务。

# ibm-mq - 发布/订阅 MessageBroker + MQ 基础知识

> ID：14359173
> 
> 赞同：0
> 
> 时间：2013-01-16T13:05:39.207
> 
> 标签：ibm-mq, publish-subscribe, messagebroker

对于使用消息代理 7.0 和 MQ 7.0 开发简单的发布/订阅流程，我真的很感激

我的流程应该接受没有标头的某个消息，根据字段过滤它（过程，如果值为“是”），然后将正文发布到消息节点中列出的所有队列

```
<pub>
  <header>
       <topics>
           <topic> Topic1  </topic>
           <topic> Topic2  </topic>
       </topics>

       <properties>
          <property>
                          <publish>yes</publish>
                  </property>     
           </properties>
   </header>

   <body>  
      <a>
         <b>The publication </b>
      </a>
   </body> 
</pub> 
```

这是我的流程：

![消息流](../Images/891a21e8ba8fb69fa49534261006b770.png)

我在 MQ 中注册了一个主题和一个订阅，但我几乎不知道接下来应该做什么。我使用 RFHUtil 测试点对点应用程序，但不知道如何在开发发布订阅时使用它。

问题： 1\. 只使用一个简单的队列作为发布者是否正确（在 MQ 输入中我只是设置“IN”，队列，我在 MQ 中） 2\. 我如何在这个流程中注册订阅者/多个订阅者？什么是订阅点？

这只是一个学习任务。

欢迎任何帮助！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T16:29:23.593

对于正常的发布-订阅流程，您可以使用以下内容：

![样品流](../Images/170134f818c93d24ddd4eca9e05ad1ce.png)

将 MQInput 节点的队列名称设置为您的输入队列。让我们将其命名为“inputQ”。

现在消息已由 MQInput 节点从“inputQ”读取，并已传递到计算节点。

在计算节点中，您需要将消息类型设置为发布并设置主题名称，然后再将其传递给发布节点。

您可以使用以下代码：

```
SET OutputRoot.MQRFH2.psc.Command = 'Publish';
SET OutputRoot.MQRFH2.psc.Topic = 'YourTopicString'; 
```

“如何在此流程中注册订阅者/多个订阅者？”

我假设您的问题是“如何发布来自同一流的不同主题的消息”。

现在假设您有多个主题要从同一个流中发布。你不能一次完成所有事情。一条消息可以有一个主题。

但是，您可以按如下方式实现（假设您有 3 个主题）：

```
SET OutputRoot.MQRFH2.psc.Command = 'Publish';
SET OutputRoot.MQRFH2.psc.Topic = 'Topic1';
PROPAGATE TO TERMINAL 'out' DELETE NONE;
SET OutputRoot.MQRFH2.psc.Topic = 'Topic2';
PROPAGATE TO TERMINAL 'out' DELETE NONE;
SET OutputRoot.MQRFH2.psc.Topic = 'Topic3';
PROPAGATE TO TERMINAL 'out' DELETE NONE;
RETURN FALSE; 
```

但是，如果您的要求是发布单个主题但多个队列应该选择它，那么它更简单。

您只需要为您的主题的所有这些队列创建订阅。

# php - 将带有表单的图像上传到相关表

> ID：14359174
> 
> 赞同：0
> 
> 时间：2013-01-16T13:05:42.750
> 
> 标签：php, mysql

我可以了解解决此问题的最佳方法。

我有一个在数据库中创建新记录的表单（使用 php 和 MySQL），这很好，但作为此表单的一部分，我希望用户能够上传一些文件。这些文件将存储在数据库中的另一个表中（允许多个条目）并链接回原始记录。

在创建主记录后，我可以在下一页上传图像，但我真的希望这个漂亮而简单，都在一个表单上。

另一个问题是，如果图像被加载到临时位置，在提交表单之前，如果表单被留下或取消，我不希望这些图像永远留在那里。

我正在使用[Fine Uploader](http://fineuploader.com)来处理文件管理，并使用 php 来保存和放置。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:08:31.143

为什么不使用带有周期性检查和删除旧脚本的临时表/目录？

使用（id，identifier_key，data，timestamp）创建一个临时表，并使用 cron 脚本（或从您的主 Web 脚本，使用概率，如 php 的默认会话处理程序的工作原理 - 在 1000 个请求中一次）定期删除旧记录或类似的东西。）

# java - 如何从 Java 中找出特定任务是否正在 Domino Server 中运行？

> ID：14359175
> 
> 赞同：2
> 
> 时间：2013-01-16T13:05:51.310
> 
> 标签：java, xpages, lotus-domino

我从 JavaServerAddin 触发了一个代理，该代理调用了 domino 服务器上的另一个程序。该程序需要一点时间来运行。通常，插件计划不会干扰程序。我想从我的 JavaAddin 检查程序是否仍在运行，并在检查结果返回 true 时避免调用代理。

任何人有任何想法，如何做到这一点？

我已经尝试过这个（[http://www.rgagnon.com/javadetails/java-0593.html](http://www.rgagnon.com/javadetails/java-0593.html)）和其他示例，但它只返回在服务器上运行但不在 Domino 内部运行的任务

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T17:31:18.700

您是否考虑过向控制台发出 SHOW TASKS。使用 -XML，您可以获得易于解析的内容。

```
 Session s = ...;
  String result = s.sendConsoleCommand("yourserver","SHOW TASKS -XML"); 
```

希望有帮助

# javascript - 选择的 jQuery 插件不能与代码点火器一起使用

> ID：14359176
> 
> 赞同：0
> 
> 时间：2013-01-16T13:05:56.517
> 
> 标签：javascript, jquery, codeigniter

我已经下载[了 jQuery Chosen 插件](http://harvesthq.github.com/chosen/)，因为我想实现简单的“多选”版本。所以我刚刚将它复制并粘贴到代码点火器中。我不是新手，几乎了解如何运行 jQuery 等的所有知识。

但是我不知道为什么它在我的代码点火器上不起作用，但是没有代码点火器它可以正常工作。

这是我的视图页面：

```
<script src="<?php echo base_url();?>js/chosen.jquery.js" type="text/javascript" >  </script>
<link rel="stylesheet" href="<?php echo base_url();?>css/chosen.css" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
<body>
    <em>Multiple Select</em>        
    <select data-placeholder="Choose a Country..." class="chzn-select" multiple>
        <option value=""></option> 
        <option value="United States">United States</option> 
    </select>

    <script type="text/javascript">
        $(".chzn-select").chosen(); 
        $(".chzn-select- deselect").chosen({ allow_single_deselect: true });
    </script>
</head>
</body>
</html> 
```

我也通过 Firebug 进行了检查，该页面正在加载每个脚本，因此我不可能给出错误的路径。任何地方都不会出现错误。我不知道该怎么办。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:12:54.183

您在 jquery.js 之前包含了所选插件，您应该在控制台中出现错误。尝试这个：

```
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js" type="text/javascript"></script>
<script src="<?php echo base_url();?>js/chosen.jquery.js" type="text/javascript" >  </script>
<link rel="stylesheet" href="<?php echo base_url();?>js/chosen.css" /> 
```

这些行也应该放在`<head>`标签内，在`<body>`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:09:42.157

您的 html 单独无效`<head>`，并且`<body>`..

总是在你的 js 插件文件之前调用你的 jquery.js 文件

这里

```
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
 <script src="<?php echo base_url();?>js/chosen.jquery.js" type="text/javascript" >  </script> 
```

在脚本中使用[ready()](http://api.jquery.com/ready/) ...我指定一个函数在 DOM 完全加载时执行。

试试这个（最终输出）

```
 <head>
  //always load jquery.js frist....
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js"></script>
  <script src="<?php echo base_url();?>js/chosen.jquery.js" type="text/javascript" >  </script>
<link rel="stylesheet" href="<?php echo base_url();?>js/chosen.css" />
<script type="text/javascript"></script> 
   $(document).ready(function(){  // it is better if u call your function inside document.ready function
     $(".chzn-select").chosen(); 
      $(".chzn-select- deselect").chosen({allow_single_deselect:true});
   });
</script>
 </head>
 <body>
   <em>Multiple Select</em>        
     <select data-placeholder="Choose a Country..." class="chzn-select" multiple>
       <option value=""></option> 
       <option value="United States">United States</option> 
   </select>

</body> 
```

# asp.net - 在 updatePanel 内的 modalpop 面板中更新值

> ID：14359180
> 
> 赞同：0
> 
> 时间：2013-01-16T13:06:02.433
> 
> 标签：asp.net, ajax, c#-4.0, modalpopupextender

在这里，我尝试根据中继器控件内的 Linkbutton 的单击事件来更新标签值。场景是当我单击链接按钮时，同时打开模态弹出窗口并且标签文本也发生了变化。

下面是我的代码。

```
<%@ Page Language="C#" AutoEventWireup="true" CodeFile="ModalPopupUpdatePanel.aspx.cs"
    Inherits="ModalPopupUpdatePanel" %>

<%@ Register Assembly="AjaxControlToolkit" Namespace="AjaxControlToolkit" TagPrefix="ajaxToolkit" %>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head runat="server">
    <title>ModalPopups and UpdatePanels</title>
    <link rel="stylesheet" href="StyleSheet.css" />
</head>
<body>
    <form id="form1" runat="server">
    <asp:ScriptManager runat="server" ID="scriptMgr1">
    </asp:ScriptManager>
    <div style="width: 300px; left: 100px">

        <div >
            <asp:Label ID="Label2" runat="server">Update Panel that contains a ModalPopup and its associated PopupPanel inside it</asp:Label>
            <asp:UpdatePanel runat="server" ID="updatePanel2" UpdateMode="Conditional"   ChildrenAsTriggers="false">
                <ContentTemplate>

                <br />
                <asp:Repeater runat="server" ID="btnresr" DataSourceID="SqlDataSource1">
                <ItemTemplate>
                <asp:LinkButton runat="server" ID="text" OnClick="Button5_Click" Text=' <%# DataBinder.Eval(Container.DataItem, "AgentName")%>'  BackColor="Red"></asp:LinkButton>
                </ItemTemplate>
                </asp:Repeater>
                    <asp:Button runat="server" ID="button2" Text="Launch Modal Popup2"  style="display:none"/>
                    <ajaxToolkit:ModalPopupExtender runat="server" ID="modalPopupExtender2" TargetControlID="button2"
                        PopupControlID="modalPanel2" OkControlID="okBtn2" CancelControlID="cancelBtn2"
                        BackgroundCssClass="modalBackground">
                    </ajaxToolkit:ModalPopupExtender>
                    <asp:SqlDataSource ID="SqlDataSource1" runat="server" 
                        ConnectionString="<%$ ConnectionStrings:PTBWConnectionString %>" 
                        SelectCommand="SELECT [AgentName], [AgentID] FROM [AgentMaster]">
                    </asp:SqlDataSource>

                    <asp:Panel runat="server" ID="modalPanel2" BackColor="AliceBlue" Style="display: none">
                        <asp:UpdatePanel runat="server" ID="updatePanel4" UpdateMode="Conditional" ChildrenAsTriggers="true">
                            <ContentTemplate>
                                <asp:Label runat="server" ID="label5" ></asp:Label>
                                <asp:Button runat="server" ID="postbackBtn" Text="Click to Cause postback" OnClick="postbackBtn_Click" /><br />
                                <asp:Button runat="server" ID="cancelBtn2" Text="OK" />
                                <asp:LinkButton runat="server" ID="okBtn2" Text="Cancel" />
                            </ContentTemplate>
                        </asp:UpdatePanel>
                    </asp:Panel>

                </ContentTemplate>
            </asp:UpdatePanel>
        </div>

    </div>
    </form>
</body>
</html> 
```

和背后的代码

```
using System;
using System.Web.UI.WebControls;

public partial class ModalPopupUpdatePanel : System.Web.UI.Page
{
    protected void Page_Load(object sender, EventArgs e)
    {

    }
    protected void updateLabel_Click(object sender, EventArgs e)
    {

    }

    protected void postbackBtn_Click(object sender, EventArgs e)
    {
        label5.Text = "After Postback";

    }
    protected void Button5_Click(object sender, EventArgs e)
    {
        LinkButton l = (LinkButton)sender;
        label5.Text = "This is before postback,saroop";
        modalPopupExtender2.Show();
    }
} 
```

我在这里受阻，请帮帮我..有没有任何 Jquery 方式然后也请在这里我

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:22:22.043

那是因为lable5 不是这样可用的，它嵌套在RepeaterItem 中。

你能试试这个。

```
LinkButton l = (LinkButton)sender;
RepeaterItem rpt = (RepeaterItem)l.Parent();
Label label5 = (Label)rpt.FindControl("label5");
label5.Text = "This is before postback,saroop";

modalPopupExtender2.Show(); 
```

# c# - WPF 分组数据网格行添加到集合时不可见

> ID：14359182
> 
> 赞同：1
> 
> 时间：2013-01-16T13:06:11.763
> 
> 标签：c#, wpf, datagrid

我希望这很简单，只是错过了一些明显的东西。我正在使用 MVVM 并有一个`Datagrid`绑定到 a 的`CollectionViewSource`this 又填充了一个`ObservableCollection`，`ObservableCollection`最初未填充并通过 UI 上的复选框添加到

我遇到的问题是，当`ObservableCollection`添加到时，标题出现在分组上，`DataGrid`但各个行本身却没有。

任何帮助真的很感激，

这是我的 Datagrid 的 XAML

```
<DataGrid DataContext="{Binding GroupedBookings}"
          ItemsSource="{Binding SourceCollection}"
          AutoGenerateColumns="False"
          SelectionMode="Single"
          SelectionUnit="FullRow"
          CanUserSortColumns="True"
          SelectedItem="{Binding SelectedBooking}"
          CanUserAddRows="False">
  <DataGrid.GroupStyle>
    <GroupStyle>
      <GroupStyle.HeaderTemplate>
        <DataTemplate>
          <StackPanel>
            <TextBlock Text="{Binding Path=MemberCount.SupporterType}"
                        FontWeight="Bold"
                        Padding="3" />
          </StackPanel>
        </DataTemplate>
      </GroupStyle.HeaderTemplate>
      <GroupStyle.ContainerStyle>
        <Style TargetType="{x:Type GroupItem}">
          <Setter Property="Template">
            <Setter.Value>
              <ControlTemplate TargetType="{x:Type GroupItem}">
                <Expander>
                  <Expander.Header>
                    <StackPanel Orientation="Horizontal">
                      <TextBlock Text="{Binding Path=Name}" />
                      <TextBlock Text="{Binding Path=ItemCount}"
                                  Margin="8 0 4 0" />
                    </StackPanel>
                  </Expander.Header>
                </Expander>
              </ControlTemplate>
            </Setter.Value>
          </Setter>
        </Style>
      </GroupStyle.ContainerStyle>
    </GroupStyle>
  </DataGrid.GroupStyle>
  <DataGrid.Columns>
    <DataGridTextColumn Header="Cost"
                        Binding="{Binding Cost}" />
    <DataGridTextColumn Header="Order No"
                        Binding="{Binding LinkedOrderID}" />
  </DataGrid.Columns>
</DataGrid> 
```

还有我的收藏代码

```
_bookings = new ObservableCollection<Booking>(rep.Bookings_Get().Where(x => x.JobID == CurrentJob.JobID));
GroupedBookings = CollectionViewSource.GetDefaultView(Bookings);
GroupedBookings.GroupDescriptions.Add(new PropertyGroupDescription("MemberCount.SupporterType")); 
```

为了确认可观察的集合`CollectionView`在 VM 中更新得很好，`ItemCount`标题中的 甚至在 UI 中增加了，我似乎无法让行出现。

提前致谢

编辑：

我已将我的代码更改为直接分配，`Bookings`而不是`_bookings`按照 EthicalLogics 的建议，但这没有帮助`Bookings`，定义如下：

```
public ObservableCollection<Booking> Bookings
{
    get { return _bookings; }
    set
    {
        _bookings = value;
        OnPropertyChanged("Bookings");
    }

} 
```

这是`GroupedBookings`

```
public ICollectionView GroupedBookings
{
    get { return _groupedBookings; }
    set
    {
        _groupedBookings = value;
        OnPropertyChanged("GroupedBookings");
    }
} 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-22T11:38:23.403

我将以下内容添加到我的 XAML 中，结果发现我错过了一些小东西，但是查看了多个使用 CollectionViewSource 并在数据网格中分组的示例，我只发现微软将其包含为 GroupStyle 的一部分

```
<Expander.Content>
    <ItemsPresenter />
</Expander.Content> 
```

希望这可以帮助任何有类似问题的人

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T15:05:24.417

```
public ObservableCollection<Booking> _bookings{get;set;} 
```

绑定源必须是属性而不是字段。因为绑定系统使用反射，它只查找属性而不是字段。我希望这会有所帮助。

# macos - 在 Mac 应用程序中导出 NSDocument

> ID：14359186
> 
> 赞同：6
> 
> 时间：2013-01-16T13:06:27.300
> 
> 标签：macos, cocoa, nsdocument

如何将一种格式的文件导出`NSDocument`为另`NSDocument`一种格式的另一种格式？

我想在我的基于文档的应用程序中实现典型的*导出*选项。我不确定应该将格式转换代码放在哪里，以及 Cocoa 已经提供了什么。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-20T16:48:28.363

获取字符串参数中的所有写入选项`NSDocument`以指定应写入的文件类型。因此，在您的`dataOfType:error:`or`fileWrapperOfType:error:`方法中，您应该为要支持的每种文件类型实现转换代码。

要开始导出操作，您可以使用`saveToURL:ofType:forSaveOperation:completionHandler:`具有所需类型的方法和`NSSaveToOperation`.

有关可以覆盖以支持加载和保存文档数据的方法的更多信息，请查看[此编程指南](https://developer.apple.com/library/mac/#documentation/DataManagement/Conceptual/DocBasedAppProgrammingGuideForOSX)。

您可以从类方法`writableTypes`或实例方法中获取可用类型`writableTypesForSaveOperation:`，同样使用`NSSaveToOperation`.

您想要支持的文件类型需要在 Info.plist 文件中声明。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-27T09:27:20.890

如果您的 NSDocument 子类支持就地自动保存，并且所有可写类型也是可读的（因为它们应该是可读的），我建议使用已经提供的类型转换工作流程，其中用户应该使用“复制”，然后使用“保存” .

在此工作流程中，当用户“复制”文档时，它会作为无标题文档写入/复制到临时文件（保存自动保存的文件）。当用户关闭文档窗口时，应用程序会建议她保存或删除文档。由于该文档还没有永久的 URL，一个 NSSavePanel 将出现一个附件视图，允许用户选择文档类型。

在这个解决方案中，Cocoa 已经提供了所有内容，您无需执行任何操作即可支持特殊的“导出”功能，因为用户可以使用“复制”后跟“保存”。您只需能够根据参数将文档保存为所有可写类型`dataOfType:error:`（如 Sven 所说）。`fileWrapperOfType:error:``typeName`

这里的优点是用户只有在关闭文件时才需要选择 URL（并且选择不删除它） - 并且与基于文档的应用程序中的新工作流程兼容，其中“另存为”操作已被替换为“复制”后跟“保存”。

请注意，您还必须确保可以复制不可写文档的文档（您可以通过复制原始文件而不是使用来实现`writeSafelyToURL:ofType:forSaveOperation:error:`）。

# python - 如何在python中使用“导入”？

> ID：14359191
> 
> 赞同：3
> 
> 时间：2013-01-16T13:06:50.310
> 
> 标签：python, syntax, scikit-learn, python-import

如果我使用`from sklearn import *`or `from skleanr import datasets`，那么我可以通过以下方式使用数据集：`iris = datasets.load_iris()`.

但是，`import sklearn`并`import sklearn as sk`没有按我的预期工作。例如我不能使用`sklearn.datasets.import_iris()`or `sk.datasets.import_iris()`。我是否误解了导入语法？确实如此，使用导入的正确方法是什么。

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-16T13:10:19.387

不，你没有误解它。这是这个特定项目的包结构。

当你导入时，你会在一个目录中*导入*`sklearn`一个特殊的 python 文件，其中包含另一个名为. 但是，如果它本身没有将嵌套包导入到它的文件中，则不能使用属性遍历来获取该嵌套包。`__init__.py``sklearn`*`datasets``sklearn``__init__.py`*

 *解决方案是自己显式导入嵌套包：

```
import sklearn.datasets 
```*

# java - 根据骨架排列Java程序的示例java代码

> ID：14359196
> 
> 赞同：1
> 
> 时间：2013-01-16T13:07:19.887
> 
> 标签：java, indentation

是否有任何java程序可以根据完美的缩进，语法来安排java程序......？为了明确我的问题（即）如果代码片段是这样的......

**实际代码**

```
if(true) { a=1; b=1; c=1; } 
```

**预期结果**

```
if(true) {

   a=1;

   b=1:

   c=1;

} 
```

使用eclipse IDE可以达到预期的效果。但我想使用java程序来做到这一点，因为我有几个这样的程序......

# java - 从另一个活动中打开一个片段

> ID：14359199
> 
> 赞同：1
> 
> 时间：2013-01-16T13:07:27.030
> 
> 标签：java, android, android-activity, fragment

我有以下问题。我有一个包含 4 个片段的活动。其中一个包含一个名称列表，当我单击一个名称时，另一个活动将使用意图 ecc 启动。此活动显示与姓名相关的个人信息，并包含一个按钮。该按钮使用通过 Http 的 DELETE 请求从列表中删除名称（也使用 Http、POST 检索个人信息）。

这一切都很好，但我想知道如何返回显示最后一个活动的名称列表的片段，以再次查看名称减去所选名称的列表。非常欢迎我可以获取一些信息的建议或链接:)

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:16:38.313

要回到你以前的片段使用：

```
getActivity().getFragmentsManager().popBackStack() 
```

后退堆栈允许用户反转片段事务（向后导航）。使用 popBackStack 将模拟返回按钮的返回行为。查看[http://developer.android.com/reference/android/app/FragmentManager.html](http://developer.android.com/reference/android/app/FragmentManager.html)并使用最适合您需要的一个。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:25:15.423

你可以简单地打电话

```
finish() 
```

在您的活动删除操作之后

# java - Hibernate配置是否需要使用AnnotationConfiguration？

> ID：14359203
> 
> 赞同：3
> 
> 时间：2013-01-16T13:07:38.280
> 
> 标签：java, hibernate, annotations, reverse-engineering, hibernate-mapping

我想使用 Configuration() 方法。但我得到这个错误：

```
Initial SessionFactory creation failed.org.hibernate.MappingException: An AnnotationConfiguration instance is required to use <mapping class="com.example.domain.Lesson"/> 
```

如果我使用 AnnotationConfiguratin() 方法，Hibernate 可以读取我的类。我不明白这一点：

为什么当我使用 Configuration 方法时，Hibernate 看不到`<mapping class="com.example.Lesson"/>`定义？

我的`hibernate.cfg.xml`文件：

```
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-configuration PUBLIC
        "-//Hibernate/Hibernate Configuration DTD 3.0//EN"
        "http://hibernate.sourceforge.net/hibernate-configuration-3.0.dtd">
<hibernate-configuration>
    <session-factory>

        <property name="hibernate.connection.driver_class">org.postgresql.Driver</property>
        <property name="hibernate.connection.password">****</property>
        <property name="hibernate.connection.url">jdbc:postgresql://localhost:5432/DB</property>
        <property name="hibernate.connection.username">postgres</property>
        <property name="hibernate.dialect">org.hibernate.dialect.PostgreSQLDialect</property>   

        <mapping resource="com.example/Lesson.hbm.xml" /> 

        <mapping class="com.example.Lesson"/>

    </session-factory>
</hibernate-configuration> 
```

我的课：

```
 public class Lesson implements java.io.Serializable {

        private int id;
        private String lesson;
        private Set lessons = new HashSet(0);

        public Lesson() {
        }

        public Lesson(int id, String lesson, Set lessons) {
            this.id = id;
            this.id = id;
            this.lessons = lessons;
        }

        continue..

} 
```

我有来自所以的 bhm.xml 文件`reverse engineering.`，我不想使用注释。

任何的想法？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:49:12.340

只需`<mapping class="com.example.Lesson"/>`从`hibernate.cfg.xml`. 没有必要，因为`Lesson.hbm.xml`存在。

# c# - 如何同时运行多个 Windows 应用商店应用实例？

> ID：14359204
> 
> 赞同：0
> 
> 时间：2013-01-16T13:07:38.560
> 
> 标签：c#, windows-store-apps

我正在开发一个 Windows 商店应用程序，并希望同时运行多个实例。当我尝试从 VS 运行一个并从内置的 .exe 运行另一个时，我收到错误消息：

“应用程序只能在应用程序容器的上下文中。”

有什么办法可以做我想做的吗？

# java - 如何在 Javascript 中遍历 Java 集合

> ID：14359207
> 
> 赞同：5
> 
> 时间：2013-01-16T13:07:42.227
> 
> 标签：java, javascript

我正在尝试在 Java 程序中使用 Javascript 编写脚本。我还没有找到一种方法来遍历 Javascript 中的 Java 集合。如果我为集合调用 iterator() 方法，我会得到方法名称而不是元素。

这是一个示例代码：

```
function getValue(row, components) {
    var apartment = components.get(0);
    var rooms = apartment.getRooms();
    for (var room in rooms.iterator()) {
        println(room);
    }
    return rooms.toString();
} 
```

apartment.getRooms() 返回房间的集合。当我研究这个函数返回的值时，我知道它的内容是正确的，但是打印出来的值是方法名。

我从我的 Java 程序中调用 Javascript，如下所示：

```
getInvocable().invokeFunction("getValue", row, components); 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T13:40:30.803

看来，如果我按如下方式进行迭代：

```
function getValue(row, components) {
    var apartment = components.get(0);
    var rooms = apartment.getRelated();
    for (var iterator = rooms.iterator(); iterator.hasNext();) {
        var room = iterator.next();
        println(room);
    }
    return rooms.toString();
} 
```

有用。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T13:48:21.503

要使用`for in`，您必须先将其转换[为数组](http://docs.oracle.com/javase/7/docs/api/java/util/Collection.html#toArray%28%29)：

```
Collection<String> coll = Arrays.asList("foo", "bar", "baz");

String script = "var arr = coll.toArray();\n"
    + "for(var idx in arr) println(arr[idx]);\n";

ScriptEngine engine = new ScriptEngineManager()
    .getEngineByName("ECMAScript");
engine.getContext().setAttribute("coll", coll, ScriptContext.ENGINE_SCOPE);
engine.eval(script); 
```

否则，您将遍历对象属性。

如果您使用的是 Rhino 1.7 或更高版本，您可以使用它[的非标准迭代器支持](https://developer.mozilla.org/en-US/docs/JavaScript/Guide/Iterators_and_Generators)：

```
for (i in Iterator(coll)) print(i); 
```

# android - 在应用程序中创建地图片段以及其他片段

> ID：14359216
> 
> 赞同：3
> 
> 时间：2013-01-16T13:08:05.673
> 
> 标签：android, google-maps, android-fragments

我正在尝试创建一个活动但有多个片段的应用程序。为此，我创建了 Main Activity 并在其布局文件中设置了 View-pager。

主活动通过其 Ascyn 任务连接到互联网，下载所需的信息将其存储在一个数组列表中，该列表将用于填写三个主要片段（地图片段、列表片段、增强现实片段）的数据我遇到的是由于某种原因地图不会显示它在我加载数据之前给了我一个空指针。

**编辑**我已经按照@Roman 的建议进行了一些更改。我的`OnResume`方法仍然存在一些问题。

**编辑 2**我取得了一些进展。在地图仍然没有显示的同时，我不再得到空指针，而是我只有一个空白屏幕。

**编辑 3 已修复**

```
public class MapDisplayFragment extends SupportMapFragment implements
    OnInfoWindowClickListener {

public ArrayList<HashMap<String, String>> UplacesListItems = new ArrayList<HashMap<String, String>>();
static List<Float> fmyLat = new ArrayList<Float>();
static List<Float> fmyLng = new ArrayList<Float>();
HashMap<String, String> song = new HashMap<String, String>();
public static final String ARG_SECTION_NUMBER = "section_number";
public static final String placesListItems = "ArrayList";
public static final String myLAt = "myLAt";
public static final String myLng = "myLng";
public static String User_lat = "user_lat";
public static String User_lng = "user_lng";
public static String KEY_REFRENCE = "refrence";
public static String KEY_NAME = "name";
public static String KEY_VICINITY = "vivinity";
public static String KEY_CATEGORY = "category";

private static String[] marker_Id;
private static String[] refrences;
public static String ref;
private GoogleMap mMap;
FragmentTransaction view;
// View mView;
ViewGroup layout;
MapView mView;
double Ulat = 0.0;
double Ulng = 0.0;
Marker FourSquare;
Marker User;
String Reference = "";

LatLng ULatLng;
GLSurfaceView mGLView;
Location userLoc;

@Override
public void onResume() {
    // TODO Auto-generated method stub

    super.onResume();
    mView.onResume();

    setUpMapIfNeeded();
    Log.d("OnResume View", "Sucess");
}

@Override
public void onDestroy() {
    // TODO Auto-generated method stub
    super.onDestroy();
    Log.d("Destroy MEthod", "Sucess");
}

@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
        Bundle savedInstanceState) {
    // TODO Auto-generated method stub
    System.gc();
    super.onCreateView(inflater, container, savedInstanceState);
    layout = (LinearLayout) inflater.inflate(R.layout.map_fragment,
            container, false);
    mView = (MapView) layout.findViewById(R.id.mapView);
    mView.onCreate(savedInstanceState);
    setMapTransparent(layout);

    setUpMapIfNeeded();

    Log.d("OnCreate View", "Sucess");
    return layout;
}

private void setMapTransparent(ViewGroup group) {
    int childCount = group.getChildCount();
    for (int i = 0; i < childCount; i++) {
        View child = group.getChildAt(i);
        if (child instanceof ViewGroup) {
            setMapTransparent((ViewGroup) child);
        } else if (child instanceof SurfaceView) {
            child.setBackgroundColor(0x00000000);
        }
    }
}

private void setUpMapIfNeeded() {
    // Do a null check to confirm that we have not already instantiated the
    // map.
    if (mMap == null) {
        SupportMapFragment.newInstance();
        mMap = mView.getMap();

        // Check if we were successful in obtaining the map.
        if (mMap != null) {
            setUpMap();
        }

        setUpMap();
    }

    else {
        setUpMap();
    }
}

@SuppressWarnings("unchecked")
private void setUpMap() {

    Ulat = getArguments().getDouble(User_lat);
    Ulng = getArguments().getDouble(User_lng);
    userLoc = new Location("manaul");
    userLoc.setLatitude(Ulat);
    userLoc.setLongitude(Ulng);
    Log.d("uwer LAt", String.valueOf(Ulat));

    UplacesListItems = (ArrayList<HashMap<String, String>>) getArguments()
            .get(placesListItems);
    if (UplacesListItems.size() != 0) {

        Log.d("ArrayList", String.valueOf(UplacesListItems.size()));

    } else {
        Log.d("ArrayList", "ArrayList = null");
    }

    mMap = mView.getMap();
    mMap.setMyLocationEnabled(true);

    // AddUser();

    if (UplacesListItems.size() != 0) {
        addMarkersToMap();

    }
    mMap.setMapType(MAP_TYPE_HYBRID);

    mMap.moveCamera(CameraUpdateFactory.newLatLngZoom(
            new LatLng(Ulat, Ulng), 15));
    mMap.animateCamera(CameraUpdateFactory.zoomTo(10), 2000, null);

}

@SuppressWarnings("unchecked")
private void addMarkersToMap() {
    // TODO Auto-generated method stub
    UplacesListItems = (ArrayList<HashMap<String, String>>) getArguments()
            .get(placesListItems);
    fmyLat = (List<Float>) getArguments().get(myLAt);
    fmyLng = (List<Float>) getArguments().get(myLng);

    double flat;
    double flng;

    if (UplacesListItems != null) {

        marker_Id = new String[UplacesListItems.size()];
        refrences = new String[UplacesListItems.size()];
        for (int i = 0; i < UplacesListItems.size(); i++) {
            Log.d("lat of fourSquarePlaces", String.valueOf(fmyLat.get(0)));

            song = UplacesListItems.get(i);
            flat = fmyLat.get(i);
            flng = fmyLng.get(i);
            Location destination = new Location("manual");
            destination.setLatitude(flat);
            destination.setLongitude(flng);
            // System.out.print(fPLat);

            // StoreReference(song.get(KEY_REFRENCE));

            if (mMap != null) {

                ULatLng = new LatLng(flat, flng);

                DecimalFormat df = new DecimalFormat("#.##");

                final String distance = String.valueOf(df
                        .format(destination.distanceTo(userLoc) / 1000))
                        + "Km";
                final String Reference = (song.get(KEY_REFRENCE));
                final String category = (song.get(KEY_CATEGORY));

                FourSquare = mMap
                        .addMarker(new MarkerOptions()
                                .position(ULatLng)
                                .title(song.get(KEY_NAME))
                                .snippet(
                                        distance + " " + Reference + " "
                                                + category)
                                .icon(BitmapDescriptorFactory
                                        .fromResource(R.drawable.point_map)));
                marker_Id[i] = FourSquare.getId();
                refrences[i] = song.get(KEY_REFRENCE);
                mMap.setOnMarkerClickListener(new OnMarkerClickListener() {

                    @Override
                    public boolean onMarkerClick(Marker marker) {
                        // TODO Auto-generated method stub
                        marker.showInfoWindow();
                        return false;
                    }

                });
                mMap.setInfoWindowAdapter(new InfoWindowAdapter() {

                    @Override
                    public View getInfoContents(Marker marker) {
                        // TODO Auto-generated method stub
                        return null;
                    }

                    @Override
                    public View getInfoWindow(Marker marker) {
                        // TODO Auto-generated method stub
                        View v = ((Activity) getActivity())
                                .getLayoutInflater().inflate(
                                        R.layout.custom_info_windows, null);
                        TextView name = (TextView) v
                                .findViewById(R.id.name);

                        TextView Distance = (TextView) v
                                .findViewById(R.id.distance);
                        TextView reference = (TextView) v
                                .findViewById(R.id.reference);
                        TextView category = (TextView) v
                                .findViewById(R.id.category);
                        String value = marker.getSnippet();

                        String[] result = value.split(" ", 3);

                        String distanceText = result[0];
                        String referenceText = result[1];
                        String categoryText = result[2];

                        name.setText(marker.getTitle());

                        Distance.setText(distanceText);
                        reference.setText(referenceText);
                        category.setText(categoryText);

                        return v;
                    }

                });
                mMap.setOnInfoWindowClickListener(this);

                Log.d("Add Marker Options Method", "Sucess");

            }

            else {

                // setUpMapIfNeeded();

            }

        }
    } else {

        Log.d("Add Marker Options Method", "ArraryList Empty");
    }

}

@Override
public void onInfoWindowClick(Marker marker) {
    // TODO Auto-generated method stub
    String value = marker.getSnippet();

    String[] result = value.split(" ", 3);
    String referenceText = result[1];
    String categoryText = result[2];
    Intent intent = new Intent(getActivity(), SingleFragmentActivity.class);

    intent.putExtra("KEY_REFRENCE", referenceText);
    intent.putExtra("KEY_CATEGORY", categoryText);
    startActivity(intent);

}

} 
```

布局

```
 LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:orientation="vertical" >
<com.google.android.gms.maps.MapView
android:id="@+id/mapView"
android:name="mapView"
android:layout_width="match_parent"
android:layout_height="match_parent"
android:layout_weight="0.5"
/>
</LinearLayout> 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T15:13:52.630

首先，您要声明

```
<fragment class="com.google.android.gms.maps.MapView"> 
```

在您`MapDisplayFragment`的布局中，这意味着您正在声明一个嵌套片段，这可能不是您想要做的。此外，据我所知`<fragment>`，除了活动布局（例如传递给的布局`setContentView`）中的任何标签都不受支持。

相反，您可以`MapView`使用以下命令直接将 添加到片段的布局中：

```
<com.google.android.gms.maps.MapView> 
```

[您可以在此处](https://developers.google.com/maps/documentation/android/map#mapview)找到有关使用[MapView](https://developers.google.com/maps/documentation/android/reference/com/google/android/gms/maps/MapView) 的文档。

**记住**：不要忘记通过片段生命周期事件，如`onCreate`，`onResume`，`onPause`以及`onDestroy`.`MapView`

其次，如果您在返回视图之前尝试调用类似`findFragmentById`或`findViewById`内部的任何内容`onCreateView`，它们将为空，因为您的片段还没有视图层次结构。您可以改为执行以下操作：

```
ViewGroup rootView = (ViewGroup) inflater.inflate(R.layout.my_fragment_layout, container, false);
// Note: rootView.findViewById, not this.findViewById
View foo = rootView.findViewById(foo);
...
return rootView; 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:58:16.250

```
 mMap = ((SupportMapFragment) getFragmentManager().findFragmentById(R.id.map))
                    .getMap(); 
```

我会说这行代码可能会生成空异常。签入调试器是 findFragmentById() 没有返回 null。在这种情况下，对空对象执行 getMap 方法将解决空指针异常。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-03-19T13:12:33.637

//在类级别初始化这一行

私人谷歌地图地图片段；

将此代码放入 onCreateView

SupportMapFragment mapFragments = ((SupportMapFragment) getChildFragmentManager().findFragmentById(R.id.map));

mapFragment=mapFragments.getMap();

# c# - 如何从 removeall 获得“成功”的指示

> ID：14359219
> 
> 赞同：2
> 
> 时间：2013-01-16T13:08:22.960
> 
> 标签：c#

我想知道我的函数是否从我的列表中删除了这是我的代码：

```
 public int RemovePassenger(string name)
    {

         Passengers.RemoveAll(x => x.PassengerName == name);
        return //if the passenger actually been remove or not 

    } 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T13:09:10.930

该方法返回从列表中删除的项目数，所以也许检查一下。[http://msdn.microsoft.com/en-us/library/wdka673a.aspx](http://msdn.microsoft.com/en-us/library/wdka673a.aspx)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:17:11.070

```
return !Passengers.Any(x => x.PassengerName == name);
--- OR ---
return (Passengers.Count(x => x.PassengerName == name) == 0); 
```

因为可能有不止一名同名乘客，我想。无论如何... RemoveAll 不应该也永远不会在你正在做的事情上失败。您可以简单地返回 RemoveAll 的结果（已删除条目的数量），这在将来可能会更有用。

# java - 我如何知道我的 Tomcat 是否支持 Servlet 3.0？

> ID：14359230
> 
> 赞同：21
> 
> 时间：2013-01-16T13:09:05.190
> 
> 标签：java, tomcat, servlets

我正在使用 Tomcat 6.33，我想知道如何检查它是否支持 Servlet 3.0 或 El 2.2？

* * *

## 回答 #1

> 赞同：27
> 
> 时间：2013-01-16T13:12:55.273

您可以通过阅读 Tomcat 文档进行检查 - 请参阅[Apache Tomcat 版本](http://tomcat.apache.org/whichversion.html)页面...其中列出了每个主要版本的 Tomcat 支持的 JSP 和 Servlet 规范的版本。

（列表中的答案：Tomcat 6.x 支持 Servlet 2.5 和 JSP/EL 2.1）

* * *

如果您想在运行时找出 Servlet 规范版本，[`ServletContext`](http://docs.oracle.com/javaee/6/api/javax/servlet/ServletContext.html)API 有调用的方法`getMajorVersion()`，`getMinorVersion()`这应该会告诉您。

我还[找到](http://www.coderanch.com/t/425693/java-Web-Component-SCWCD/certification/servlet-jsp-version)了使用 JSP 显示各种版本号的方法：

```
Server info: <%= application.getServerInfo() %><br>
Servlet version: <%= application.getMajorVersion() %>.<%= application.getMinorVersion() %><br>
JSP version: <%= JspFactory.getDefaultFactory().getEngineInfo().getSpecificationVersion() %><br>
Java version: <%= System.getProperty("java.version") %><br> 
```

* * *

## 回答 #2

> 赞同：6
> 
> 时间：2013-01-16T13:11:07.557

来自[http://tomcat.apache.org/whichversion.html：Tomcat](http://tomcat.apache.org/whichversion.html) 6 支持 Servlet 2.5

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2015-11-24T10:55:28.873

Apache Tomcat 7.0.x onwords 支持 Servlet 3.0 API，[Apache Tomcat 7.0.65](https://tomcat.apache.org/tomcat-7.0-doc/servletapi/)是实际的发布版本。

# matlab - uicontrol 回调的输入参数过多

> ID：14359231
> 
> 赞同：0
> 
> 时间：2013-01-16T13:09:05.360
> 
> 标签：matlab, user-interface, matlab-figure, matlab-guide

我正在尝试编写一个滚动条来同时更改许多子图的 x 范围。

```
kids = get(gcf,'Children');
 h=uicontrol('style','slider',...
'units','normalized','position',Newpos,...
'callback',{@slide_axes,kids},'min',0,'max',xmax-chunkDuration); 
```

Update_axes 在同一个文件中定义：

```
function slide_axes(h)
 set(h,'xlim',get(gcbo,'value')+[0 20000]); 
```

结尾

但是，我收到错误：

```
??? Error using plot_scroll>slide_axes
Too many input arguments.

??? Error while evaluating uicontrol Callback 
```

我在 FEX 上读到，回调可以将两个参数传递给任何回调函数。但是，当我将签名更改为`slide_axes`错误`slide_axes(h,evt)`仍然存​​在。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:15:36.347

您传递的参数 (`h`和`evt`) 是 MATLAB 默认值。如果您想向回调函数传递额外的参数，您需要在 和 之后编写`h`它们`evt`。像这样：

```
function slide_axes(h, evt, k)
    % k is kids.
end 
```

# c++ - 刷新 QGraphicsScene / QGraphicsView

> ID：14359235
> 
> 赞同：1
> 
> 时间：2013-01-16T13:09:18.603
> 
> 标签：c++, qt, model-view-controller, graphics, refresh

我对以下问题感到困扰：

我正在使用`QGraphicsScene`需要根据用户的操作呈现 SQL 查询的图形表示的交互式交互，例如：向查询中添加某些内容（表、新列、其他内容）或从查询中删除某些内容（关键字、表格、列...）。场景的变化必须在操作后显示出来，应用程序的“逻辑层”也需要跟踪用户所做的操作，因为查询的“渲染”是由“逻辑”层完成的（即： “逻辑层”创建所有`QGraphicsItemGroup`派生对象，在构建所有逻辑层组件之后，这些派生对象将被添加到查询的图形场景中并放在窗口上）。

发生的问题如下：现在我没有找到任何可用的解决方案来以最平滑的方式在更改后呈现查询。

请允许我在屏幕截图中链接以进行进一步说明：

![查询生成器的屏幕截图](../Images/df82e3fb4c81c739223ea82d186f2702.png)

假设用户想要`PERSON.NAME`从查询中删除该列。应用程序中会发生什么：

*   用户单击`PERSON.NAME`列图形项的“删除”（列名后的红色小 X）按钮
*   Graphics View 感知到这个操作，将 REMOVE 列从图形系统发送到“逻辑层”（“模型”）
*   逻辑层依次删除代表`PERSON.NAME`列的相应“逻辑层”对象，

麻烦从这里开始：

*   整个图形（是的，一切）由逻辑层重新渲染，为同一查询创建图形项，没有`PERSON.NAME`
*   然后我必须创建一个新窗口，其中包含一个新`QGraphicsScene`对象和一个`QGraphicsView`
*   将表示查询的重新渲染对象的图形项（但现在没有`PERSON.NAME`列）插入新`QGraphicsScene`的`addItem()`
*   现在用新窗口替换应用程序的中央小部件。
*   现在您可以看到，确实，在查询`PERSON.NAME`中不再存在，并且下面的所有图形元素都`PERSON.NAME`在屏幕上向上移动。

显然这不是一个好的解决方案，当我改变窗口时有一个难看的闪烁，但我直到现在都没有找到更好的解决这个问题的方法。

因此，我请求您的帮助，以确定可以对这种在删除（添加）新元素时更新屏幕的方法进行哪些改进，这些新元素知道上面的背景信息，而无需新窗口。显然，也欢迎其他与 mroe 通用图形相关的评论。

谢谢，f

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T08:58:39.963

根据问题和评论中的信息，您可以考虑以下几点：

首先，您需要**摆脱创建新窗口和`QGraphicsView`**刷新时的新窗口。我想这是闪烁的主要原因。保持你的 UI 结构不变，只修改场景。您可以使用以下方法之一：

1.  要么创建一个新的`QGraphicsScene`并将其设置为视图的场景，要么调用`clear()`现有的场景。然后`QGraphicsItems`从您的本机模型重新创建您的模型，并确保您的所有指针和引用都已更新。

2.  另一种方法是在发生变化时`QGraphicsScene` **更新**您的原生模型，以避免从头开始重新创建整个场景。例如，当用户单击删除图标时让`QGraphicsScene`处理删除`QGraphicsItem`，然后让场景更新您的原生模型以反映此更改。

3.  另一种方法是丢弃您的本机模型，并将其`QGraphicsScene`与它一起`QGraphicsItems`用作您的模型。在场景类中实现序列化等。这避免了同步两个模型的需要。缺点是您的图形独立逻辑与`QGraphicsScene`您可能不想要的耦合更紧密。根据您的代码大小，这也可能需要大量工作。

我将从 1\. 开始，因为根据您现有的方法，这似乎是最简单的方法。如果您仍然遇到指针和对象所有权的奇怪问题，请尝试隔离它们并询问 SO :)

# delphi - 使用 MyDACDatabase 的 FastReport 程序不起作用

> ID：14359237
> 
> 赞同：0
> 
> 时间：2013-01-16T13:09:19.473
> 
> 标签：delphi, delphi-7, fastreport, mydac

我正在使用 MyDACDatabase 组件将使用 FastReport 4 构建的报表连接到我的 MySQL 数据库。使用 Delphi 的 IDE 时，我可以正常编辑它并在 FastReport 设计器中进行测试，甚至编译应用程序，但是当我打开有报告的表单时，我有异常**Class not found: TFrxMyDACDatabase not found**。我该如何解决这个错误？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-05-31T18:06:07.527

只是对于其他想知道的人，我所做的只是改变了库路径以包含 FR5 的位置，并再次将 frxmyDACComponents 添加到使用列表中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:42:47.647

您应该从 MyDAC 5 安装 FastReport X MyDAC 组件才能使用 TfrxMYDACDatabase 组件。有关详细信息，请阅读 %MyDAC%\Demos\Win32\ThirdParty\FastReport\FRX\ 目录中的 ReadMe.txt 文件。%MyDAC% 是您计算机上的 MyDAC 安装路径，X 是您使用的快速报告组件的版本。

（引用[tfrxMyDacDatabase 版本 5 中的某些变化（版本 4 没问题）](http://forums.devart.com/viewtopic.php?t=9650)）

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-17T11:52:19.957

解决方案非常简单。我意识到在**FastReport 4**的选项卡中，我按照 MyDAC 的 Demos 文件夹中的说明安装了一个名为**frxMyDACComponents**的组件（在我的情况下，放置在**C:\Users\Public\Documents\Devart\MyDAC 中） Delphi 7\Demos\ThirdParty\FastReport\FR4\ReadMe.txt**）。当我将此组件放入表单时，uses 子句中声明了 2 个单位：**frxDACComponents**和**frxMYDACComponents**。正是这个问题所需要的。感谢大家的帮助。

# batch-file - 批量从字符串中获取文件名

> ID：14359240
> 
> 赞同：-1
> 
> 时间：2013-01-16T13:09:30.010
> 
> 标签：batch-file

我有一组文件名，我希望打印每个文件名：

> 例如：如果数组包含文件：C:\Windows\Directx.log 那么，我想打印 Directx.log

我知道如果我迭代一个文本文件，我可以这样做：

```
for %%F in ("C:\Documents and Settings\Usuario\Escritorio\hello\test.txt") do echo %%~nxF 
```

但同样，它是一个数组而不是文本文件。

这是我的代码：

```
set filesCount=0
for /f "eol=: delims=" %%F in ('dir /b /s %SequencesDir%\*.%StandardExtension%') do (
    set "filesArray!filesCount!=%%F"
    set /a filesCount+=1  
)

set /a secondCnt=0

:LoopArray
if not %secondCnt%==%filesCount% (
    set CurrentFile=!filesArray%secondCnt%!
    echo !CurrentFile!
    for /f "delims=" %%A in ('echo(%CurrentFile:\=^&echo(%') do set ExactFile=%%~nxA
echo %ExactFile%
set /a secondCnt+=1
goto LoopArray
) 
```

有任何想法吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:42:01.463

您拥有一组值的事实并不重要。您已经知道如何循环访问成员，因此对于特定的迭代，您希望将完整的文件路径转换为名称和扩展名。执行此操作的简单方法是使用带有变量修饰符的 FOR 循环`%%~nxA`或带有参数修饰符的子例程 CALL `%~nx1`。

注意：使用 FOR /L 循环来迭代您的成员而不是 GOTO 循环效率更高。

**FOR 循环解决方案（我的偏好）**

```
for /l %%N in (0 1 %filesCount%) do (
  set "currentFile=!filesArray%%N!"
  for %%F in ("!currentFile!") do set "ExactFileName=%%~nxF"
  echo Full file path = !currentFile!
  echo File name = !ExactFileName!
) 
```

**CALL 子程序解决方案（较慢）**

```
for /l %%N in (0 1 %filesCount%) do (
  set "currentFile=!filesArray%%N!"
  call :getName "!currentFile!"
  echo Full file path = !currentFile!
  echo File name = !ExactFileName!
)
exit /b

:getName
set "ExactFileName=%~nx1"
exit /b 
```

# emacs - Emacs ido：如何首先显示特定的文件结尾？

> ID：14359242
> 
> 赞同：5
> 
> 时间：2013-01-16T13:09:39.247
> 
> 标签：emacs, ido

我`ido-mode`在 Emacs 24 下使用以下设置：

```
(ido-mode 1)
(setq ido-enable-flex-matching t)
(setq ido-everywhere t)
(setq ido-use-filename-at-point 'guess)
(setq ido-use-url-at-point t)
(setq ffap-require-prefix t) 
```

假设您在当前目录中有多个名称相同但结尾不同的文件。如果您通过 更改缓冲区`C-x b`，您会收到一些建议。这些建议的顺序会受到某种影响吗？

例如，假设您在当前目录中有多个 Sweave (.Rnw) 文件。它们总是比从它们创建的相应 (.tex) 文件更重要。所以在大多数情况下，您希望将缓冲区更改为 .Rnw 文件，而不是 .tex 文件。因此，如果首先建议 .Rnw 文件（在所有具有相同基本名称的 .Rnw 和 .tex 文件都存在的目录中），那就太好了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T16:05:27.740

“如果你想调整默认文件排序，比如让 Sweave 文件首先出现，告诉 ido 哪些文件给予更高的排序优先级：”

```
(setq ido-file-extensions-order '(".Rnw" ".tex")) 
```

但它只适用于`ido-find-file`不适用`ido-switch-buffer`。缓冲区按`most recent`属性排序。我不了解功能，它在`most recent`. 函数`ido-file-extension-lessp`可用于以这种方式对缓冲区列表进行排序。但是两种排序可能会相互冲突。

# c# - EF Code First 5 - 如何使用 Fluent API 定义可为空的外键？

> ID：14359245
> 
> 赞同：5
> 
> 时间：2013-01-16T13:09:48.863
> 
> 标签：c#, entity-framework-5, fluent

我有两张桌子-

```
 1\. Account 

 2\. Users 
```

在`Account`表中，`DefaultExpensePartner`和是表字段的`AccountOwner`外键。我已经定义了如下类。`UserId``Users`

```
public class Account
{
    public int AccountId { get; set; }
    public string AccountName { get; set; }
    public int? AccountOwnerId { get; set; }
    public int? DefaultExpensePartnerId { get; set; }

    public virtual Users AccountOwner { get; set; }
    public virtual Users DefaultExpensePartner { get; set; }
}

public class AccountConfiguration : EntityTypeConfiguration<Account>
{
    public AccountConfiguration()
    {
        this.ToTable("Account");

        this.HasKey(c => c.AccountId);

        this.Property(c => c.AccountId)
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity)
            .IsRequired();

        this.Property(c => c.AccountName)
            .HasMaxLength(50)
            .IsRequired();

        this.Property(c => c.AccountOwnerId)
            .HasColumnName("AccountOwner")
            .IsOptional();

        this.Property(c => c.DefaultExpensePartnerId)
            .HasColumnName("DefaultExpensePartner")
            .IsOptional();

        this.HasRequired(c => c.DefaultExpensePartner)
            .WithMany()
            .HasForeignKey(c => c.DefaultExpensePartnerId)
            .WillCascadeOnDelete(false);

        this.HasRequired(c => c.AccountOwner)
           .WithMany()
           .HasForeignKey(c => c.AccountOwnerId)
           .WillCascadeOnDelete(false);
    }
}

public class Users
{
    public int UserId { get; set; }
    public string Email { get; set; }
    public string DisplayName { get; set; }
    public string PasswordSalt1 { get; set; }
    public string PasswordSalt2 { get; set; }
    public string PasswordHash { get; set; }
}

public class UsersConfiguration : EntityTypeConfiguration<Users>
{
    public UsersConfiguration()
    {
        this.ToTable("Users");

        this.HasKey(c => c.UserId);

        this.Property(c => c.UserId)
            .HasDatabaseGeneratedOption(DatabaseGeneratedOption.Identity)
            .IsRequired();

        this.Property(c => c.Email)
            .HasMaxLength(80)
            .IsRequired();

        this.Property(c => c.DisplayName)
            .HasMaxLength(50)
            .IsRequired();

        this.Property(c => c.PasswordSalt1)
            .HasMaxLength(172)
            .IsRequired();

        this.Property(c => c.PasswordSalt2)
            .HasMaxLength(172)
            .IsRequired();

        this.Property(c => c.PasswordHash)
            .HasMaxLength(40)
            .IsRequired();
    }
} 
```

虽然我能够为`AccountOwner`和`DefaultExpensePartner`字段建立外键关系，但它们在数据库中被定义为非空，这根据我的原始计划是不正确的。谁能知道如何将外键定义为可为空的？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-16T13:30:19.187

如果您想拥有可为*空*的外键，为什么要根据*需要*定义它：

```
this.HasRequired 
```

?

改用`HasOptional`：

```
 this.HasOptional(c => c.AccountOwner)
            .WithMany()
            .HasForeignKey(c => c.AccountOwnerId)
            .WillCascadeOnDelete(false); 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T13:18:25.030

除非您真的想要，否则您不必指定键属性，这有点代码优先的想法:)

根据[微软的这篇文章，](http://msdn.microsoft.com/en-us/data/hh134698.aspx)删除外键属性就足够了。看看文章中图1和图2的区别。（密钥当然会在数据库级别生成，但是您真的需要在模型中使用它们吗？）

# mysql - MySQL 多重连接

> ID：14359247
> 
> 赞同：1
> 
> 时间：2013-01-16T13:09:54.003
> 
> 标签：mysql, join

我创建了以下查询，它从 3 个不同的表中提取数据：

```
 SELECT
    product_searchables_names.class_name AS Class_Name,
    product_searchables_names.label AS Attribute_Label,
    jss_products.extrafield102 AS Attribute1,
    jss_products.extrafield103 AS Attribute2,
    jss_products.extrafield104 AS Attribute3,
    jss_products.extrafield105 AS Attribute4,
    jss_products.extrafield106 AS Attribute5,
    jss_products.extrafield107 AS Attribute6
    FROM
    product_searchables_categories 
    JOIN product_searchables_names ON product_searchables_categories.searchableID = product_searchables_names.ID
    JOIN jss_products ON product_searchables_categories.categoryID = jss_products.categories
    WHERE
    jss_products.productID = '134890'
    ORDER BY
    product_searchables_categories.searchable_order ASC 
```

它以以下格式输出数据

![在此处输入图像描述](../Images/b597134cc5dd0e98016630016a087814.png)

但我需要这种格式，其中第 1 行从 'Attribute'1 中选择值，从 'Attribute2' 中选择第 2 行等：

![http://i50.tinypic.com/308bbcg.jpg](../Images/6235e838f04163fd5462168fce8199ac.png)

我该怎么做？

提前致谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:15:35.583

您可以尝试使用案例语句[http://dev.mysql.com/doc/refman/5.1/de/case-statement.html](http://dev.mysql.com/doc/refman/5.1/de/case-statement.html)之类的

```
select
    product_searchables_names.class_name AS Class_Name,
    product_searchables_names.label AS Attribute_Label,
    CASE 
        WHEN product_searchables_names.label = 'Resolution' THEN jss_products.extrafield104
        WHEN product_searchables_names.label = 'Networked?' THEN jss_products.extrafield106
        WHEN ...
    END
from
    product_searchables_categories
... 
```

或使用 class_name 代替 label

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:47:13.110

根据您发布的图像，您似乎需要*取消透视*`jss_products`表。此过程将获取作为列的值并将其转换为行。

因此，您的查询将与此类似：

```
SELECT psn.class_name AS Class_Name,
    psn.label AS Attribute_Label,
    jp.Attribute
FROM product_searchables_categories psc
JOIN product_searchables_names psn
    ON psc.searchableID = psn.ID
JOIN
(
    select productID, categories, jp.extrafield102 as Attribute
    from jss_products jp
    union all
    select productID, categories, jp.extrafield103 as Attribute
    from jss_products jp
    union all
    select productID, categories, jp.extrafield104 as Attribute
    from jss_products jp
    union all
    select productID, categories, jp.extrafield105 as Attribute
    from jss_products jp
    union all
    select productID, categories, jp.extrafield106 as Attribute
    from jss_products jp
    union all
    select productID, categories, jp.extrafield107 as Attribute
    from jss_products jp
) jp    
    ON psc.categoryID = jp.categories
WHERE jp.productID = '134890'
ORDER BY psc.searchable_order ASC 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:13:27.677

您正在寻找的是一个支点。我知道如何在 Oracle 中做到这一点，但我不相信在 mysql 中有一种简单的方法可以做到这一点。获得结果集后，在代码中执行此操作通常比在 SQL 中容易得多。

这是一篇描述如何使用 CASE 执行此操作的帖子，这类似于 Oracle 方法。

[带有 GROUP BY 的 mysql 透视查询结果](https://stackoverflow.com/questions/6605604/mysql-pivot-query-results-with-group-by)

# windows-phone-7 - VS Developer Express for Windows Phone 新项目显示 XamlParseException

> ID：14359250
> 
> 赞同：0
> 
> 时间：2013-01-16T13:10:03.660
> 
> 标签：windows-phone-7, visual-studio-2012, windows-phone-7.1, xamlparseexception

我最近安装了 Windows 8 以及适用于 Windows Phone 的 Visual Studio Express 2012。但是，如果我启动一个新的 Windows Phone App 项目（7.1，虽然 8 也有同样的问题）并打开 MainPage.xaml 文件，设计器窗口中会出现如下错误：

```
XamlParseException: Cannot find a Resource with the Name/Key PhoneBackgroundBrush [Line: 47 Position: 111] 
```

MainPage.xaml 文件如下：

```
<phone:PhoneApplicationPage 
    x:Class="PhoneApp1.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d" d:DesignWidth="480" d:DesignHeight="768"
    FontFamily="{StaticResource PhoneFontFamilyNormal}"
    FontSize="{StaticResource PhoneFontSizeNormal}"
    Foreground="{StaticResource PhoneForegroundBrush}"
    SupportedOrientations="Portrait" Orientation="Portrait"
    shell:SystemTray.IsVisible="True">

    <!--LayoutRoot is the root grid where all page content is placed-->
    <Grid x:Name="LayoutRoot" Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!--TitlePanel contains the name of the application and page title-->
        <StackPanel x:Name="TitlePanel" Grid.Row="0" Margin="12,17,0,28">
            <TextBlock x:Name="ApplicationTitle" Text="MY APPLICATION" Style="{StaticResource PhoneTextNormalStyle}"/>
            <TextBlock x:Name="PageTitle" Text="page name" Margin="9,-7,0,0" Style="{StaticResource PhoneTextTitle1Style}"/>
        </StackPanel>

        <!--ContentPanel - place additional content here-->
        <Grid x:Name="ContentPanel" Grid.Row="1" Margin="12,0,12,0"></Grid>
    </Grid>

</phone:PhoneApplicationPage> 
```

App.xaml 文件包含以下内容：

```
<Application 
    x:Class="PhoneApp1.App"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"       
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:phone="clr-namespace:Microsoft.Phone.Controls;assembly=Microsoft.Phone"
    xmlns:shell="clr-namespace:Microsoft.Phone.Shell;assembly=Microsoft.Phone">

    <!--Application Resources-->
    <Application.Resources>
    </Application.Resources>

    <Application.ApplicationLifetimeObjects>
        <!--Required object that handles lifetime events for the application-->
        <shell:PhoneApplicationService 
            Launching="Application_Launching" Closing="Application_Closing" 
            Activated="Application_Activated" Deactivated="Application_Deactivated"/>
    </Application.ApplicationLifetimeObjects>

</Application> 
```

解决方案如下所示：

![项目解决方案](../Images/dacd386e13590703b01b23167a0d476e.png)

任何地方似乎都没有任何其他与样式相关的文件。任何人都可以对此有所了解吗？它让我发疯。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:51:42.523

呸！修复如下：

右键单击右侧解决方案资源管理器面板中的项目 选择添加 -> 现有项目 在文件浏览器中选择 C:\Program Files (x86)\Microsoft SDKs\Windows Phone\v7.1\Design\ThemeResources.xaml 单击“添加” ' 按钮 在您的 App.xaml 文件中，添加以下替换部分：

```
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="ThemeResources.Xaml" />
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

在 MainPage.xaml 打开设计器 - 现在应该可以正常工作了。希望这可以节省一些时间！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-11-17T11:04:53.230

根据您自己的答案，而不是复制原始的 ThemesResources.xaml，我会创建一个新的并将其与原始的合并。

创建一个新的资源字典（例如 FixedDictionaryResources.xaml）。在 Visual Studio 中，您需要创建一个 Windows Phone 页面或使用任何其他创建 XAML 文件的模板。在 Blend 中，您可以直接创建资源字典。在 VS 中，您需要删除所有内容并放入以下代码。在 Blend 中只需添加

```
<ResourceDictionary
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" 
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <!-- Resource dictionary entries should be defined here. -->
    <SolidColorBrush x:Key="PhoneBackgroundBrush" Color="{StaticResource PhoneBackgroundColor}"/>
</ResourceDictionary> 
```

打开 App.xaml 并添加以下代码以将新字典与默认资源字典合并。

```
<Application.Resources>
    <ResourceDictionary>
        <ResourceDictionary.MergedDictionaries>
            <ResourceDictionary Source="Resources/FixingResourceDictionary.xaml"/>
        </ResourceDictionary.MergedDictionaries>
    </ResourceDictionary>
</Application.Resources> 
```

重新打开仍然显示 PhoneBackgroundBrush 缺失问题的页面，现在一切正常。

# ember.js - HasMany 关联更新

> ID：14359252
> 
> 赞同：2
> 
> 时间：2013-01-16T13:10:14.127
> 
> 标签：ember.js, ember-data

如何更新`hasMany`记录中的关联？

我尝试了这种方法：

```
record.get('childrenRecords').clear();
newChildrenRecords.forEach(function (child) {
  record.get('childrenRecords').pushObject(App.ChildModel.find(child.get('id'));
}); 
```

但我得到了错误：

`Uncaught Error: <DS.ManyArrayStateManager:ember3557> could not respond to event recordWasAdded in state loading.`

我也找不到正确的解决方案如何更新文档`hasMany`中的关联。`Ember.data`

# mysql - MySQL Prepared statements - 控制执行的条件语句

> ID：14359255
> 
> 赞同：0
> 
> 时间：2013-01-16T13:10:23.543
> 
> 标签：mysql, sql, mysqli

我试图了解如何最好地使用准备好的语句来改善我的一两个查询的响应时间。我在这里阅读了许多帖子并一直在尝试。

我想确认/澄清我的理解是正确的并且我正朝着正确的方向前进 - 特别是我想知道我是否可以在准备中包含执行以及如何将条件语句合并到准备中。

我想知道我是否应该将条件语句作为 mysqli 代码的一部分而不是实际的准备语句，如果是这样，这样做是否会产生性能成本。

**此代码不起作用：**

```
PREPARE get_Class_Session FROM
       "SELECT @COUNT:=COUNT(*) FROM (SELECT time_Table_Key,
                     date,
                     DATE_FORMAT(date, '%W') AS day,
                     slot,
                     class_Session 
        FROM `Time_Table` 
        WHERE (((date >=? && date <= ?) && DAYOFWEEK(date)=? && (slot >=? && slot <=?)) && class_Session ='0'))
                AS time_Table_Keys;
        IF @COUNT = '0' THEN
            EXECUTE update_Time_Table USING @start_Date, @end_Date, @day, @start_Time, @end_Time;
        END IF;
       "; 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:22:51.183

为了提高查询的响应时间，必须分析`EXPLAIN query`语句的输出并采取措施来限制文件排序和临时表的使用，并减少检查的行数。
不幸的是，准备好的语句对这些事情都没有帮助。

# doctrine-orm - Doctrine2，使用 queryBuilder 检查 Arraycollection 中的实体

> ID：14359258
> 
> 赞同：2
> 
> 时间：2013-01-16T13:10:39.350
> 
> 标签：doctrine-orm, arraycollection, query-builder

我只有一个关于查询生成器的简单问题，但我没有找到任何答案......

我为产品列表制作了一个过滤器，我想检查我选择的属性是否在我的 Items（产品项目）的 arrayCollection“属性”中。

这是我在 Item 实体中的 Attributes arrayCollection ：

```
/**
*
* @var ArrayCollection
*
* @ORM\ManyToMany(targetEntity="Attribute", inversedBy="items")
* @ORM\JoinTable(name="catalog_items_x_attributes", joinColumns={@ORM\JoinColumn(name="item_id", referencedColumnName="id")}, inverseJoinColumns={@ORM\JoinColumn(name="attribute_id", referencedColumnName="id")})
*/ 
private $attributes; 
```

这是我在 ProductRepository 中的功能（产品有 1-x 个项目）：

```
public function listWithFilters($idCat, $filt)
{      
    $em = $this->getEntityManager();
    $qb = $em->createQueryBuilder();
    $cat = $em->getRepository('WebformanceCatalogBundle:Category')
     ->findById($idCat);<br />
    $right = $cat[0]->getRight();
    $left = $cat[0]->getLeft();
    $query = $qb
            ->select('p')
            ->from('Webformance\CatalogBundle\Entity\Product', 'p')
            ->leftJoin('Webformance\CatalogBundle\Entity\Item', 'i', 'WITH', 'i.product = p.id' )
            ->leftJoin('Webformance\CatalogBundle\Entity\Category', 'c', 'WITH', 'p.category = c.id')
            ->where('c.right <= :right')
            ->andWhere('c.left >= :left')
            ->andWhere($qb->expr()->between('i.salePrice', ':minPrice', ':maxPrice'))
            ->andWhere($qb->expr()->between('i.weight', ':minWeight', ':maxWeight'))
            ->setParameters(array('right' => $right,
                                    'left' => $left,
                                    'minPrice' => $filt['price-min'],
                                    'maxPrice' => $filt['price-max'], 
                                    'minWeight' => $filt['weight-min'],
                                    'maxWeight' => $filt['weight-max']
                ));
            if (!empty($filt['manufacturer'])) {
               $query
                ->andWhere($qb->expr()->in('p.manufacturer', ':manufacturers'))
                ->setParameter('manufacturers', $filt['manufacturer']);
            }

/***** problem on this part ******/
// I have already try without the "getRepository" just with the ID.
                if (!empty($filt['att'])) {
                    foreach($filt['att'] as $attId) {
                        $attribute = $em->getRepository('WebformanceCatalogBundle:Attribute')
                         ->findById($attId);
                        $query
                            ->andWhere($qb->expr()->in(':attributes', 'i.attributes'))
                            ->setParameter('attributes', $attribute[0]);
                    }
                }
/********************************/
        $result = $query->getQuery()->getResult();
        return $result;
    } 
```

所以，我有一个错误，如：

```
[Syntax Error] line 0, col 406: Error: Expected Literal, got 'i' 
```

但我不知道我是否使用好的方法来找到我想要的。

# c# - 如何在 C# 中对该方法进行单元测试？

> ID：14359260
> 
> 赞同：6
> 
> 时间：2013-01-16T13:10:47.603
> 
> 标签：c#, asp.net-mvc-3, nunit

我正在学习单元测试。如何使用 nunit 和 rhino mock 对该方法进行单元测试？

```
public ActionResult PrintCSV(Byte[] bytes, string fileName)
{
    var file = File(bytes, "application/vnd.ms-excel");
    var cd = new System.Net.Mime.ContentDisposition()
    {
        CreationDate = DateTime.Now,
        FileName = fileName,
        Inline = false
    };
    Response.AppendHeader("Content-Disposition", cd.ToString());
    return file;
} 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T14:34:32.130

您将需要模拟 HttpContext。这是一个示例（它是 MSTest，但我想移植到 NUnit 不会很痛苦 - 您只需要重命名几个属性）：

```
[TestMethod]
public void PrintCSV_Should_Stream_The_Bytes_Argument_For_Download()
{
    // arrange 
    var sut = new HomeController();
    var bytes = new byte[] { 1, 2, 3 };
    var fileName = "foobar";
    var httpContext = MockRepository.GenerateMock<HttpContextBase>();
    var response = MockRepository.GenerateMock<HttpResponseBase>();
    httpContext.Expect(x => x.Response).Return(response);
    var requestContext = new RequestContext(httpContext, new RouteData());
    sut.ControllerContext = new ControllerContext(requestContext, sut);

    // act
    var actual = sut.PrintCSV(bytes, fileName);

    // assert
    Assert.IsInstanceOfType(actual, typeof(FileContentResult));
    var file = (FileContentResult)actual;
    Assert.AreEqual(bytes, file.FileContents);
    Assert.AreEqual("application/vnd.ms-excel", file.ContentType);
    response.AssertWasCalled(
        x => x.AppendHeader(
            Arg<string>.Is.Equal("Content-Disposition"),
            Arg<string>.Matches(cd => cd.Contains("attachment;") && cd.Contains("filename=" + fileName))
        )
    );
} 
```

如您所见，这里有一些管道代码来设置测试。我个人使用[MvcContrib.TestHelper](http://mvccontrib.codeplex.com/wikipage?title=TestHelper)，因为它简化了很多这样的管道代码并使测试更具可读性。看一下这个：

```
[TestClass]
public class HomeControllerTests : TestControllerBuilder
{
    private HomeController sut;

    [TestInitialize]
    public void TestInitialize()
    {
        this.sut = new HomeController();
        this.InitializeController(this.sut);
    }

    [TestMethod]
    public void PrintCSV_Should_Stream_The_Bytes_Argument_For_Download()
    {
        // arrange 
        var bytes = new byte[] { 1, 2, 3 };
        var fileName = "foobar";

        // act
        var actual = sut.PrintCSV(bytes, fileName);

        // assert
        var file = actual.AssertResultIs<FileContentResult>();
        Assert.AreEqual(bytes, file.FileContents);
        Assert.AreEqual("application/vnd.ms-excel", file.ContentType);
        this.HttpContext.Response.AssertWasCalled(
            x => x.AppendHeader(
                Arg<string>.Is.Equal("Content-Disposition"),
                Arg<string>.Matches(cd => cd.Contains("attachment;") && cd.Contains("filename=" + fileName))
            )
        );
    }
} 
```

现在测试更加清晰，我们可以立即看到初始化阶段、被测方法的实际调用和断言。

备注：说了这么多，我不太明白控制器动作的意义，它需要一个字节数组作为参数，只是为了将它流回客户端。我的意思是为了调用它，客户端需要已经拥有该文件，那么有什么意义呢？但我想这只是为了说明目的。在您的实际方法中，字节数组不作为参数传递，而是在您的控制器操作中从某些外部依赖项中检索。在这种情况下，您也可以模拟这种依赖关系（当然，假设您已经正确地构建了您的层并且它们是足够弱耦合的）。

# r - 带二元变量的回归：应该有 4 条回归线，只有 1 条。

> ID：14359262
> 
> 赞同：-1
> 
> 时间：2013-01-09T22:17:47.543
> 
> 标签：r, regression

我的模型中有两个二元变量，所以我应该得到一个带有 4 条回归线的图，但我只得到 1 条线。我如何绘制所有 4 个？

```
model<-lm(Pos.Percent~aum+long.short+Op.Der,data=new.reg)
        Pos.Percent long.short Op.Der    aum
[1,]       76.92          1      2      76.90
[2,]      100.00          1      2       8.10
[3,]       58.62          2      1      23.00
[4,]       60.00          1      1      15.00
[5,]       89.36          2      1      35.96
[6,]       82.50          2      1     263.49 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T00:51:33.873

这不是一个很明确的问题。但我推断你想要一个单独的回归线 Pos.Percent on aum 为你的两个二进制变量的每个组合（顺便说一句，这不是你的 lm() 命令估计的 - 但这是另一个问题）。

为此获得良好绘图的一种简单方法是使用 R 中的 ggplot2 库：

```
library(ggplot2)

ggplot(new.reg, aes(x=aum, y=Pos.Percent)) + 
  geom_point() +   
  geom_smooth(method="lm") + 
  facet_grid(long.short~Op.Der) 
```

# javascript - 如何在 Javascript 的正则表达式中包含变量？

> ID：14359267
> 
> 赞同：2
> 
> 时间：2013-01-16T13:11:15.080
> 
> 标签：javascript, regex, variables

> **可能重复：**
> [Javascript Regex：如何将变量放入正则表达式中？](https://stackoverflow.com/questions/4029109/javascript-regex-how-to-put-a-variable-inside-a-regular-expression)

我在[sinon.js](http://sinonjs.org) fakeServer 响应中将以下内容用作正则表达式 pattnern：

```
/https:\/\/ca-davstorage:8080\/myFile.json(\?.*|$)/ 
```

我想`myFile`用一个变量替换，但由于我不太擅长正则表达式，所以我很难让它发挥作用。目前我有这个，但它似乎不起作用。

```
'https:\\/\\/ca-davstorage:8080\\/'+myFile+'.json(\\?.*|$)/' 
```

**问题**：
如何正确地将变量添加到正则表达式？

感谢帮助！

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:12:48.427

而不是`/regex/`使用构造函数`RegExp`。

**示例**：

```
var foo = 'bar',
    re = new RegExp('[0-9]' + foo, 'g');
re.test('1bar'); //true 
```

RegExp 构造函数的第一个参数是正则表达式，第二个参数是修饰符。

# cocoa - 当我在 nsdate 中加载 Web 服务并且当我打印 nsdata 时，我正在获取 dats 的地址

> ID：14359269
> 
> 赞同：0
> 
> 时间：2013-01-16T13:11:18.550
> 
> 标签：cocoa, nsdata

```
NSString *loginURL=[NSString stringWithFormat:@"http://localhost:8080/BookingTicketWebService/services/OfficeDetailsDAO"];

NSData *dataURL=[NSData dataWithContentsOfURL:[NSURL URLWithString:loginURL]];

NSArray *responseObj = [NSJSONSerialization JSONObjectWithData:dataURL options:0 error:nil];
 NSLog(@"%@",dataURL); 
```

//

当我打印 NSdata 时，我会像这样

```
<3c68313e 4f666669 63654465 7461696c 7344414f 3c2f6831 3e0a3c70 3e486920 74686572 652c2074 68697320 69732061 6e204158 49532073 65727669 6365213c 2f703e0a 3c693e50 65726861 70732074 68657265 2077696c 6c206265 20612066 6f726d20 666f7220 696e766f 6b696e67 20746865 20736572 76696365 20686572 652e2e2e 3c2f693e 0a> 
```

你能告诉我我是可可新手吗

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:18:42.843

NSData 不是字符串对象。

如果要打印出来，则需要将 NSData 转换为 NSString。

例如：

```
NSString * stringFromData = [[NSString alloc] initWithData: dataURL encoding: NSUTF8StringEncoding]; 
```

另外，作为仅供参考（供您参考），“ `dataURL`”对于 NSData 对象来说是一个非常糟糕的名称。其他人可能正在查看您的代码并且很容易混淆，认为它是一个 URL。最好使用更好、更直观的变量名。

# vb.net - StackTrace ByRef 到 VB.NET 中的另一个类

> ID：14359273
> 
> 赞同：0
> 
> 时间：2013-01-16T13:11:25.840
> 
> 标签：vb.net, class, events, dll, pass-by-reference

我正在编写一个类，它必须作为 dll 文件添加到任何 .NET 项目中。我陷入了困境，我需要向 System.Diagnostics.StackTrace “last_method_name_changed” 发起事件。

所以我需要找到一种方法来检测 StackTrace 中的变化，或者创建线程进入或退出方法时引发的事件。就像是：

```
Public Class DllClass
    Public Shared CallerTrace as StackTrace = Nothing
    Public Shared New(ByRef NewTrace as StackTrace) 'This is called from form.
        '''I know this will make a copy, but I have failed to find a solution.
        CallerTrace = NewTrace
    End Sub
    Public Shared Sub StackTrace_Changed() Handles CallerTrace.Changed
        MsgBox(CallerTrace.GetFrame(0).GetMethod.Name)
    End Sub
End Class 
```

在主窗体中，这应该只调用一次：

```
Dim DllCls as New DllClass(New Diagnostics.StackTrace) 
```

对于制作“参考链接”或指向 StackTrace 的指针以及在`CallerTrace.GetFrame(0).GetMethod.Name`更改时将引发的事件的任何帮助，我将不胜感激。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:48:22.193

没有复制作为`StackTrace`引用类型（分配给引用不会复制基础对象）。参数声明中的`ByRef`是无关的和多余的。

另一方面，您没有声明`CallerTrace`，`WithEvents`因此您实际上并没有收听它引发的任何事件。但这不起作用，因为`System.Diagnostics.StackTrace`声明没有可以收听的公共事件。您拦截方法调用的方法根本不起作用。

要以您设想的方式拦截方法调用，您需要进一步钻取。幸运的是，有些库已经允许这样做，例如[AOP 库 PostSharp](http://www.sharpcrafters.com/postsharp/features)。

# android - 附有 pdf 的电子邮件

> ID：14359274
> 
> 赞同：0
> 
> 时间：2013-01-16T13:11:26.337
> 
> 标签：android, android-intent

我必须打开我的申请电子邮件（G-mail），它必须附加到一些 pdf 文件中

pdf 位于应用程序创建的文件夹中。该文件夹未在 sdcard 上创建。

我的平板电脑没有 SD 卡。我的平板电脑没有 SD 卡。我的平板电脑没有 SD 卡。

如何将这些 pdf 发送到电子邮件？

```
if(android.os.Environment.getDataDirectory().equals(android.os.Environment.MEDIA_MOUNTED))
cacheDir=new File(android.os.Environment.getDataDirectory(),"MyAPP");

//String FILENAME = "testejan1.pdf";
//String string = "hello world!";

//File file = new File (Environment.getDataDirectory().getPath(), "/MyAPP/"+"testejan1.pdf");
//Uri path = Uri.fromFile(file);

Intent shareIntent = new Intent(Intent.ACTION_SEND);
shareIntent.setType("application/pdf");
//shareIntent.setAction(Intent.ACTION_SEND);
shareIntent.putExtra(Intent.EXTRA_EMAIL, new String[] { "flip_novidade@hotmail.com" });
shareIntent.putExtra(Intent.EXTRA_SUBJECT, "Material de apoio do mês de " + mesclicado);
shareIntent.putExtra(Intent.EXTRA_TEXT, "Você esta recebendo um super material de visitação médica");
//shareIntent.setDataAndType(path, "application/pdf"); 
shareIntent.putExtra(Intent.EXTRA_STREAM, Uri.parse("file:///MyAPP/"+"testejan1.pdf"));
//shareIntent.setType("file/*");
startActivity(shareIntent); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:31:01.910

```
i.setType("application/pdf");
 i.putExtra(Intent.EXTRA_STREAM, Uri.parse("pdf path")); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:47:06.593

您的大部分代码看起来都正确。两件事情：

当您在应用程序的本地文件系统中创建 PDF 文件时，您需要使用[`MODE_WORLD_READABLE`](http://developer.android.com/reference/android/content/Context.html#MODE_WORLD_READABLE)标志创建它。这是其他应用程序能够打开 PDF 所必需的。

然后用于[`Uri.fromFile`](http://developer.android.com/reference/android/net/Uri.html#fromFile%28java.io.File%29)获取文件的 Android URI（您在注释代码中有此内容）。

请注意，这`MODE_WORLD_WRITEABLE`被认为是一种糟糕的安全做法，因为设备上的任何应用程序都可以访问您的 PDF 文件。更好的解决方案是创建一个`ContentProvider`并使用`content:`URI 将 PDF 数据提供给外部应用程序。这使您可以控制是否允许或拒绝对 PDF 文件的任何单独加载的访问（但这需要更多的工作）。

# java - 在java中隐藏选项卡标题

> ID：14359276
> 
> 赞同：1
> 
> 时间：2013-01-16T13:11:34.430
> 
> 标签：java, swing, tabs

我有`Tabbed Pane`三个标签。如何隐藏这些选项卡的标题以防止用户按下它们？

我曾经`c#`通过创建一个从选项卡组件类继承的类然后重写隐藏选项卡的方法来做到这一点，但最近我切换到 java 并且我搜索了很多但没有得到任何结果。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:42:16.777

试试这个

```
import javax.swing.*;
import java.awt.*;
import java.awt.event.*;
class Testing
{
  public void buildGUI()
  {
    JTabbedPane tp = new JTabbedPane();
    tp.addTab("A",getPanel("A"));
    tp.addTab("B",getPanel("B"));
    tp.addTab("C",getPanel("C"));
    //Control Header space area..
    final boolean showTabsHeader = false;
    tp.setUI(new javax.swing.plaf.metal.MetalTabbedPaneUI(){
        @Override
        protected int calculateTabAreaHeight(int tabPlacement, int horizRunCount, int maxTabHeight) {
            if (showTabsHeader) {
                return super.calculateTabAreaHeight(tabPlacement, horizRunCount, maxTabHeight);
            } else {
                return 0;
            }
        }
      protected void paintTabArea(Graphics g,int tabPlacement,int selectedIndex){}
    });

    JFrame f = new JFrame();
    f.getContentPane().add(tp);
    f.pack();
    f.setLocationRelativeTo(null);
    f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
    f.setVisible(true);
  }
  public JPanel getPanel(String tabText)
  {
    JPanel p = new JPanel();
    p.add(new JLabel(tabText));
    return p;
  }
  public static void main(String[] args)
  {
    SwingUtilities.invokeLater(new Runnable(){
      public void run(){
        new Testing().buildGUI();
      }
    });
  }
} 
```

# mysql - Mysql除法结果类型

> ID：14359277
> 
> 赞同：1
> 
> 时间：2013-01-16T13:11:41.423
> 
> 标签：mysql

我如何才能发现 MySQL 中算术运算的结果类型是什么，因为我在手册中找不到它的引用？

如果您执行：

```
SELECT table.a/table.b; 
```

那么如何找到表达式“table.a/table.b”的结果类型（对于给定的一组已知列类型）？

我搜索了文档，并且为数字运算符指定的类型信息很少：http: [//dev.mysql.com/doc/refman/5.5/en/arithmetic-functions.html#operator_divide](http://dev.mysql.com/doc/refman/5.5/en/arithmetic-functions.html#operator_divide)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:15:30.417

您提供的链接实际上确实很好地说明了这一点。总结一下：

*   如果两个值都是整数并且一个是无符号的，那么结果将是一个无符号整数。
*   如果任一值是实数，则结果将是一个实数，其精度等于两个操作数的最大精度。
*   如果两个值都是精确值（整数或小数），则结果将是一个精确值，其精度为第一个（顶部/分子）运算符加上系统变量的一些额外小数位`div_precision_increment`，默认设置为 4。

# php - 使用php根据自定义条件重新排列行

> ID：14359282
> 
> 赞同：0
> 
> 时间：2013-01-16T13:12:08.503
> 
> 标签：php, mysql, sql, sql-order-by

我必须根据自定义偏好重新排列行。

表结构是这样的。

```
id(primary)    top    title
1              2      t1
2              1      t2   
3              5      t3  
4              3      t4 
5              4      t5 
```

结果被显示，`ORDER BY top ASC`结果为。

```
id(primary)    top    title
2              1      t2
1              2      t1   
4              3      t4  
5              4      t5 
3              5      t3 
```

现在我想把这一行放在顶部并从结果中删除一行。

```
id(primary)    top    title
6              NULL   t6 
```

并更改/下推/重新分配列（顶部）以显示这样的结果。

```
id(primary)    top    title
6              1      t6
2              2      t2
1              3      t1   
4              4      t4  
5              5      t5 
```

IE 之前所有排在前面的行现在都被向下推到一个位置，并且行`id=3 with top=5`被删除，如`id=3 with top=NULL`.

这样做的简单方法是将列（顶部）重新分配给所需的偏好，我不能这样做，因为有数百行可供使用，所以我需要一些自动化逻辑。

请查看并建议任何可能的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:55:57.787

```
select
  id,
  case when id=6 then 1 else top+1 end top,
  title
from
  your_table
where
  id=6 or
  top!=(select max(top) from your_table where id!=6)
order by top 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:28:48.993

```
SELECT *
  FROM
  (
    SELECT ID, @TOP := @TOP + 1 Top, TITLE
    FROM table1 a, (SELECT @TOP := 1) r
    ORDER BY a.TOP
  ) s
UNION 
SELECT 6, 1, 't6'
ORDER BY TOP
LIMIT 5 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/c1c47/18)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:33:08.243

```
SELECT * FROM theTable ORDER BY id = {the id you want on top} DESC, top ASC 
```

或者如果上面有多个

```
SELECT * FROM theTable ORDER BY id in (id,id,id) DESC, top ASC 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:20:14.353

```
array_pop( $results ); // Remove last row
array_unshift( $results, $new_row ); // Add new row to the beginning
foreach( $results as $index => &$value )
    $value['top'] = $index+1; //Reassign top so that it matches the index of the numerical array, which will always start counting from zero 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T13:23:06.610

沿着这些思路，也许：

```
select id, ifnull(top, 0)+1, title from theTable order by 2 
```

# c# - 如何关闭一个表单并打开另一个表单？

> ID：14359287
> 
> 赞同：1
> 
> 时间：2013-01-16T13:12:16.177
> 
> 标签：c#, winforms

嗨，我对 C# 很陌生，您可能会猜到，我收到以下错误：

`Error 1 'customer_details_form' is a 'namespace' but is used like a 'type'`

如果返回一个值，我想关闭一个表单并打开另一个表单。但是我正在为要输入的内容而苦苦挣扎，即形式叫什么？是我应该使用的命名空间还是其他东西。

```
 public void button1_Click(object sender, EventArgs e)
    {       

        string fileName = string.Format(tblastname.Text);

        if (File.Exists(fileName))
        {
            MessageBox.Show("this customer already exsists");
        }
        else
        {
            MessageBox.Show("No file found, please create new customer");
            home_form f2 = new home_form();
            this.Hide();
            f2.ShowDialog();
            //if false bring up new customer form.
            customer_details_form f4 = new customer_details_form();
            this.Hide();
            f4.ShowDialog();
        }            
    } 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:13:21.133

采用

```
var f4= new customer_details_form.YOUR_FORM_NAME() 
```

这是程序集中的*完全限定类型名称*（二进制）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2019-12-19T22:38:36.130

在我的情况下，我遇到了同样的错误，因为我有一个名为 Customer 的项目命名空间，我试图将它用作一种类型（我想这是良好的命名约定到位的地方）所以我只是将 Customer 类的名称更改为客户详细信息和问题已解决。现在我的单元测试不再失败，huzzah！

# python - 标记和标记文本

> ID：14359288
> 
> 赞同：1
> 
> 时间：2013-01-16T13:12:18.970
> 
> 标签：python, nlp

这是一个简单的扫描器，它根据某些规则对文本进行标记，并标记标记。

1.  处理未知字符并将其标记为未知的最佳方法是什么？
2.  是否有推荐的方法/库来加快速度，同时完成类似的结果并保持相对简单。

*例子：*

```
import re

def alpha(scanner,token):
    return token, 'a'

def numeric(scanner,token):
    return token,'rn'

def punctuation(scanner,token):
    return token, 'p'

def superscript(scanner,token):
    return token, 'sn'

scanner = re.Scanner([
    (u"[a-zA-Z]+", alpha),
    (u"[.,:;!?]", punctuation),
    (u"[0-9]+", numeric),
    (u"[\xb9\u2070\xb3\xb2\u2075\u2074\u2077\u2076\u2079\u2078]", superscript),
    (r"[\s\n]+", None), # whitespace, newline
    ])

tokens, _ = scanner.scan("This is a little test? With 7,9 and 6.")
print tokens 
```

*出去：*

```
[('This', 'a'), ('is', 'a'), ('a', 'a'), ('little', 'a'), ('test', 'a'),
 ('?', 'p'), ('With', 'a'), ('7', 'rn'), (',', 'p'), ('9', 'rn'), 
 ('and', 'a'), ('6', 'rn'), ('.', 'p')] 
```

*ps！*定义的函数可能会尝试进一步对标记进行分类。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:32:33.043

按照提供的`re.Scanner`顺序匹配模式。因此，您可以在最后提供一个非常通用的模式来捕获“未知”字符：

```
(r".", unknown) 
```

* * *

```
import re

def alpha(scanner,token):
    return token, 'a'

def numeric(scanner,token):
    return token,'rn'

def punctuation(scanner,token):
    return token, 'p'

def superscript(scanner,token):
    return token, 'sn'

def unknown(scanner,token):
    return token, 'uk'

scanner = re.Scanner([
    (r"[a-zA-Z]+", alpha),
    (r"[.,:;!?]", punctuation),
    (r"[0-9]+", numeric),
    (r"[\xb9\u2070\xb3\xb2\u2075\u2074\u2077\u2076\u2079\u2078]", superscript),
    (r"[\s\n]+", None), # whitespace, newline
    (r".", unknown)
    ])

tokens, _ = scanner.scan("This is a little test? With 7,9 and 6\. \xa0-\xaf")
print tokens 
```

产量

```
[('This', 'a'), ('is', 'a'), ('a', 'a'), ('little', 'a'), 
('test', 'a'), ('?', 'p'), ('With', 'a'), ('7', 'rn'), (',', 'p'), 
('9', 'rn'), ('and', 'a'), ('6', 'rn'), ('.', 'p'), ('\xa0', 'uk'), 
('-', 'uk'), ('\xaf', 'uk')] 
```

* * *

你的一些模式是`unicode`，一个是`str`。确实，在 Python2 中，要匹配的模式和字符串可以是`unicode`或`str`。

但是，[在 Python3 中](http://docs.python.org/3.2/library/re.html)：

> Unicode 字符串和 8 位字符串不能混合使用：也就是说，您不能将 Unicode 字符串与字节模式匹配，反之亦然

因此，即使在 Python2 中，也不要混合使用它们是一种很好的做法。

* * *

我认为您的代码非常简单（正则表达式除外`superscript`。Eek！）。我不知道有什么图书馆可以让它变得更简单。

# zend-framework - Zend_Locale - firefox 不显示区域，只显示语言

> ID：14359293
> 
> 赞同：1
> 
> 时间：2013-01-16T13:12:37.907
> 
> 标签：zend-framework, firefox, internationalization, zend-translate, zend-locale

我对 Firefox 有疑问。我正在尝试使用 Zend_Translate 和 gettex 适配器创建多语言页面。

这是我的引导程序的一部分：

```
 protected function _initTranslate()
    {
        $locale = new Zend_Locale(Zend_Locale::BROWSER);
        Zend_Registry::set('Zend_Locale', $locale);

        $translate = new Zend_Translate('gettext', 
                    APPLICATION_PATH . "/langs/", 
                    null, 
                    array('scan' => Zend_Translate::LOCALE_DIRECTORY));
        $registry = Zend_Registry::getInstance();
        $registry->set('Zend_Translate', $translate);

        $translate->setLocale($locale);

    } 
```

问题是：Chrome 和 Safari 为我提供了语言和地区的区域设置（即 en_US、pl_PL），这很好，但 Fierox 只给我语言而不是地区（'en'、'pl'）。当我将两种语言添加到我的“lang”文件夹（“pl_PL”、“en_US”）中时，Firefox 崩溃告诉我：

> 注意：必须先添加语言“pl”才能使用。在第 435 行的 /home/users/witkowicz/www/bwitkowicz/moyo/library/Zend/Translate/Adapter.php
> 
> 注意：没有可用的语言“pl”的翻译。在第 448 行的 /home/users/witkowicz/www/bwitkowicz/moyo/library/Zend/Translate/Adapter.php
> 
> 注意：必须先添加语言“pl”才能使用。在第 435 行的 /home/users/witkowicz/www/bwitkowicz/moyo/library/Zend/Translate/Adapter.php
> 
> 注意：没有可用的语言“pl”的翻译。在第 448 行的 /home/users/witkowicz/www/bwitkowicz/moyo/library/Zend/Translate/Adapter.php
> 
> 致命错误：未捕获的异常“Zend_Controller_Response_Exception”带有消息“无法发送标头；标题已经发送到 /home/users/witkowicz/www/bwitkowicz/moyo/library/Zend/Translate/Adapter.php，第 435 行

即使我强制语言环境为：

> $translate->setLocale('pl_PL');

...它仍然会引发错误

# php - 将空白（null）字段添加到mysql表

> ID：14359296
> 
> 赞同：0
> 
> 时间：2013-01-16T13:12:46.303
> 
> 标签：php, mysql

我正在尝试将一列添加到字段为空的表中，既不是“0”也不是“null”。

```
"ALTER TABLE `mytable` ADD COLUMN `newcolumn` INT NOT NULL" 
```

使所有字段为“0”。我也尝试`DEFAULT=''`了选项，但是该列甚至没有添加。那么如何实现真正的空白字段呢？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:13:50.580

**你不能**。

INTEGER 列的唯一有效值是数字和 NULL。您不能简单地定义`DEFAULT ''`，因为`''`它已经是一个空字符串。

```
ALTER TABLE `mytable` ADD COLUMN `newcolumn` INT DEFAULT 0 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!2/4a6e2d/1)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:16:43.620

您正在添加一个 INT 字段。它可能是 NULL 或 0，但它不能是空字符串，因为那是一个字符串，而不是一个数字。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:18:45.923

您已指定`NOT NULL`. 这意味着字段不能为空，即为空。

如果您想要“真正空白”的字段，则将列规范更改为：

```
 "ALTER TABLE `mytable` ADD COLUMN `newcolumn` INT NULL" 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:16:45.610

刚刚测试过这个并且可以工作。

```
ALTER TABLE  `__test` ADD  `test_column` INT NULL 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-16T13:29:41.153

我试试这段代码：

```
create table test( a int )

insert into test(a) values (1),(2),(3)

ALTER TABLE test ADD b INT NOT NULL DEFAULT 0 
```

# c# - 该命令的执行需要一个开放且可用的连接。连接的当前状态已断开。

> ID：14359297
> 
> 赞同：6
> 
> 时间：2013-01-16T13:12:48.093
> 
> 标签：c#, asp.net, sql, entity-framework

在 qa 中使用后，我们收到以下错误

`Execution of the command requires an open and available connection. The connection's current state is broken.`

我们正在使用 EntityFramework 的单例实例

SOF 建议：

[EF 从服务器宕机导致的无效操作异常中恢复](https://stackoverflow.com/questions/2863224/ef-recovery-from-invalidoperationexception-caused-by-server-being-down)

1) 偶尔创建一个新的 ContectObject 实例

2）配置池连接数更高

解决此问题的最佳做法是什么？

我认为为每个 Dal 操作创建一个新的 contectObject 很浪费

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T13:16:43.317

> 我认为为每个 Dal 操作创建一个新的 contectObject 很浪费

你有任何证据吗？我相信实体框架和实际上大多数数据访问框架都是为许多短期和独立的上下文而*设计的。*在这里实现自己的池/缓存通常是一种反模式，可能会导致过时的结果、并发问题和不良的故障恢复（就像这里的情况一样）。

您认为哪些*具体*资源会被浪费，您是否通过实验验证了这一点？

基本上，我建议为每个工作单元创建一个新的上下文（可能大致对应于请求） - 测量任何性能差异，并查看问题是否消失（如我所料）。作为测试的一部分，偶尔断开数据库服务器与网络的连接，以检查您是否也可以实际恢复...

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T13:37:36.490

请阅读有关[连接池](http://msdn.microsoft.com/en-us/library/bb399543.aspx)的信息。

处置 EF 上下文时，您正在处置底层存储提供程序连接。但是，当您处理存储连接时，默认情况下您**不会**关闭任何传输级连接，除非您没有明确关闭连接池。

此外，EF 缓存每个应用程序域的元数据视图。
因此，EF 上下文创建确实**很便宜**。

另外，请记住，每个上下文实例中都有更改跟踪器。当您有单一上下文时，它的更改跟踪器会跟踪所有已物化或附加到上下文的内容。“跟踪一切”意味着您通过上下文检索到的每个实体实例都不会被释放 - 跟踪器保留对它的引用。

不要创建长期存在的上下文实例。

# actionscript-3 - Flex 4.6 Mobile：如何移动活动视图并在其后面放置菜单

> ID：14359299
> 
> 赞同：1
> 
> 时间：2013-01-16T13:12:50.937
> 
> 标签：actionscript-3, apache-flex, actionscript, flex4.6

我在 Flex 4.6 中有一个 ViewNavigatorApplication，我希望实现一个与 Facebook 移动应用程序中的菜单非常相似的应用程序菜单。

具体来说：

*   按下菜单按钮时，将创建主菜单并将其放置在当前视图的后面。

*   当前视图（应用程序中有很多视图）向左移动以显示其后面的菜单。

*   当菜单关闭时，视图将移回默认位置（left=0），然后从屏幕上删除主菜单以节省处理能力。

我想出了如何使用“navigator.activeView.left”属性将当前视图移开，但我不知道如何将菜单添加到屏幕上。我尝试将它添加到全局舞台对象，但它没有显示在屏幕上。

有谁知道解决这个问题的简单方法？

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-02-17T15:26:12.170

我想这不太实用，因为 flex mobile 是基于视图的，你不能在视图之外拥有任何东西。因此，如果您使用“navigator.activeView.left”来移动整个视图，您根本无法将空白空间替换为其他任何内容。

解决方法可以是（我没有尝试过）：在 HGROUP 中添加两个 VGROUP，其中第一个 vgroup 上的菜单具有 100% 高度，其余内容位于第二个 vgroup 上。通过这种方式，您最初可以隐藏这些人，并且在菜单操作触发器上，您可以将第二个 vgroup(content) 移动到适当的空间量并使菜单可见。

可能的算法：

```
<hgroup width='100%' height='100%'>
  <vgroup width='20%' visible='false' includeInLayout='fasle'>Menu here</vgroup>
  <vgroup width='80%'>Menu here</vgroup>
</hgroup> 
```

请重写这段代码，因为我只是在脑海中打字。我上次使用 mxml 已经有一段时间了。

最好的祝愿

# php - PHP用新字符串替换第一个字母 - wordpress标题

> ID：14359300
> 
> 赞同：1
> 
> 时间：2013-01-16T13:12:54.057
> 
> 标签：php, string, str-replace

我究竟做错了什么？

```
$title = get_the_title();
$firstLetter = $title[0];
$title[0] = '<span class = "wrapBlue">' . $firstLetter . '</span>';     

echo $title; // comes out with weird switched around string? 
```

`get_the_title()`是一个wordpress功能。

`var_dump on $title`给出一个长度为 21 的字符串。

`var_dump on $firstLetter`给出一个包含长度为 1 的正确字符的字符串

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:16:15.797

如您所知`$title[0]`，指的是第一个字母-但您要分配的不是字母。尝试这样的事情：

```
$title = '<span class = "wrapBlue">' . $firstLetter . '</span>' . substr($title, 1); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:14:52.243

试试这个：

```
$title = get_the_title();
$firstLetter = substr($title, 0, 1);
$title .= '<span class = "wrapBlue">' . $firstLetter . '</span>' . substr($title, 1, strlen($title);
echo $title; 
```

单线：

```
echo '<span class = "wrapBlue">' . substr(get_the_title(), 0, 1) . '</span>' . substr(get_the_title(), 1, strlen(get_the_title()); 
```

# c# - 当 url 包含编码的 & 符号时，MVC WEB API 路由失败

> ID：14359305
> 
> 赞同：22
> 
> 时间：2013-01-16T13:13:06.270
> 
> 标签：c#, asp.net-mvc, rest, asp.net-web-api, asp.net-mvc-routing

当我打电话给我的网络服务女巫时，我得到了两个参数：

从客户端 (&) 检测到潜在危险的 Request.Path 值。

路由配置：

```
config.Routes.MapHttpRoute(
name: "PropertiesSearch",
routeTemplate: "api/property/Search/{category}/{query}",
defaults: new { controller = "Property", action = "Search", category = "common", query = string.Empty }
); 
```

控制器方法：

```
[HttpGet]
public SearchResult Search(string category, string query)
{
} 
```

当我调用 api 时：

> /api/property/search/homes/areaId%3D20339%26areaId%3D20015

从客户端 (&) 检测到潜在危险的 Request.Path 值。

这样做：

> /api/property/search/homes/?query=areaId%3D20339%26areaId%3D20015

工作正常。

如何解决路由解码问题？

* * *

## 回答 #1

> 赞同：30
> 
> 时间：2013-01-16T21:56:01.627

Scott Hanselman[在博客上对此](http://www.hanselman.com/blog/ExperimentsInWackinessAllowingPercentsAnglebracketsAndOtherNaughtyThingsInTheASPNETIISRequestURL.aspx)进行了讨论。您可能需要检查web.config`requestPathInvalidCharacters`中节点的属性。`<httpRuntime>`

就我个人而言，我会避免在 uri 部分中使用此类字符，而只是将这些值作为查询字符串参数。

# vb.net - 显示工具条的文本

> ID：14359306
> 
> 赞同：5
> 
> 时间：2013-01-16T13:13:10.453
> 
> 标签：vb.net, visual-studio-2010, button

我想知道如何`toolstrip`在 VB 表单中显示文本*（从 Visual Studio 2010 的首选项中的哪个选项）。*

我所拥有的`toolstrip`只是图像和鼠标*悬停*`toolstrip`我在首选项中设置了文本。

我试过设置`ShowItemTooltips`选项，但似乎只适用于`hover`鼠标盒。

提前致谢。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T13:16:18.810

将每个 ToolStripButton的**DisplayStyle设置为****ImageAndText**。

# c# - 视图模型中的可序列化装饰器而不是 SelectList？

> ID：14359314
> 
> 赞同：4
> 
> 时间：2013-01-16T13:13:38.127
> 
> 标签：c#, asp.net-mvc, asp.net-mvc-3, decorator

我`ViewModel`在会话中存储。生活环境有问题。由于配置的原因，我无法在会话中存储不可序列化的类并且`SelectList`未标记为`Serializable`.

排除使用`SelectList`in`ViewModel`作为`DataSource`for`DropDown`控件的更好方法是什么？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:33:50.117

您可以在视图模型中存储项目集合，而不是选择列表。然后，向您的 ViewModel 添加一个名为的方法，该方法`GetSelectList()`使用该集合创建一个 SelectList。

这样，您存储数据，一旦从会话中检索该对象，您就可以调用该`GetSelectList()`方法在下拉列表中使用它。

您甚至可以传递一个参数来设置选定的值。

# jquery - Rails 3 - 远程表单提交后指定表单操作

> ID：14359318
> 
> 赞同：3
> 
> 时间：2013-01-16T13:13:50.360
> 
> 标签：jquery, ruby-on-rails-3, ujs

我有一个非常简单的表格，在我尝试重新提交之前可以正常工作。之后，它会更新记录而不是创建新记录：

在我看来，我有这个：

```
#new_order_form
  = render 'form' 
```

我的表格部分：

```
= semantic_form_for [@location, @order], :remote => true do |f|
  -if @order.errors.any?
    #notice{:class=>'alert alert-block alert-error fade in'}
      %a{:class=>"close", :data=>{:dismiss=>"alert", :href=>"#"}}
        x
      %h3  
        = pluralize(@order.errors.count, "error")
      - @order.errors.full_messages.each do |msg|
        = msg
        %br

  %table{:class => 'table table-bordered', :style=> {width: '50%'}}  
    %tr
      %td= f.text_field :product_order_id, :placeholder => "Order ID" 
```

在我的 create.js 中：

```
$("#new_order_form").html("<%= escape_javascript(render("form")) %>"); 
```

这可以很好地创建订单并呈现错误（如果存在）。

问题是：如果我在不刷新页面的情况下输入另一个订单号，它会更新之前创建的记录，而不是创建一个新记录。

查看表单代码，我可以看到提交操作已替换为更新。

我试图用这个替换代码：

```
 = semantic_form_for [@location, @order], :remote => true do |f|
   #new_order_form
     = render 'form', :f => f 
```

这在 create.js

```
$("#new_order_form").html("<%= escape_javascript(render :partial => 'form', :locals => {:f => @order}) %>"); 
```

这也不起作用并抱怨无效的文本字段。

做这个的最好方式是什么？谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:48:33.517

我不熟悉`semantic_form_for`，但我认为它是常规的超集`form_for`。

工作方式`form_for`是它检查模型以查看它是否被持久化，然后执行默认操作以匹配它。我个人认为`form_for`从`edit`动作中调用会假设`update`，但事实并非如此。`form_for`将假定该操作`create`适用于任何非持久模型和`update`任何持久模型。如果你愿意，我相信你可以覆盖它，但我自己没有尝试过。

听起来您可能正在做的是显示模型并尝试在同一页面上创建新模型。（如果我错了，请包含您的控制器，因为很难说出您打算做什么。）您的控制器中可能需要 a`@show_order`和 a `@new_order`。

我希望这会有所帮助，如果没有，也许您可​​以提供有关控制器的更多详细信息。

**编辑：**

每当您希望能够创建新模型时，您需要确保您的控制器调用`@new_order = Order.new`并确保`form_for`使用`@new_order`. `new_`只是区分新旧的前缀。

在这种情况下，我不确定控制器是否是`order#show`或者可能是`order#create`.

因为`show`你想要这样的东西：

```
@order = Order.find(params[:id])
@new_order = Order.new 
```

如果你这样做，`create`你可能想要：

```
@order = Order.new(params[:order])

if @order.save
  @new_order = Order.new
  redirect_to ???
else
  render :new
end 
```

以上所有内容都应与库存控制器完全匹配，除了添加`@new_order`. （换句话说，如果存在`respond_to`and`format`行，请不要删除它们。）

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-20T00:53:58.573

问题是您的 create.js 正在读取来自创建操作结果的@order，这是现有的@order，因此它成为更新。

**一个解决方法：**在你的“if @order.save”创建部分创建一个新的@order：@order_new = Order.new。

现在告诉您的表单部分使用 order 而不是 @order ：

```
semantic_form_for [@location, order], :remote => true do |f| 
```

使用以下内容更新您的 create.js：

```
$("#new_order_form").html("<%= escape_javascript(render 'form', :order => @order_new) %>"); 
```

确保将任何引用表单渲染的内容更新为也使用 :order => @order。例如：

```
<%= render 'form', :order => @order %> 
```

如果您的 @location 需要是一个新实例，那么同样的规则也适用。

我使用@order_new 而不是覆盖@order，以防您想在create.js 中使用@order 做某事

**旁注（对于其他查看者）：** Rails 3.x 渲染方法不需要 partials => 和 locals => 帮助器。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-26T05:22:43.637

我不是这个主题的专家，但亚当的回答似乎是正确的。我假设您的控制器操作中有如下内容：

```
def create
  @order = Order.new(params[:order])

  if @order.save
    responds_to do |format|
      format.js
      format.html { redirect_to 'xxx' }
    end
  else
    responds_to do |format|
      format.js
      format.html { render :new }
    end
  end
end 
```

如果你有上述结构，那么 create.js.erb 只是传递了 @order.save 调用之后已经修改的 @order 对象。您可以在通过的条件中重新定义它，如下所示（检查第 4 行）：

```
def create
  @order = Order.new(params[:order])

  if @order.save
    @order = Order.new
    responds_to do |format|
      format.js
      format.html { redirect_to 'xxx' }
    end
  else
    responds_to do |format|
      format.js
      format.html { render :new }
    end
  end
end 
```

现在如果@order 已成功保存，将创建并传递新订单。否则将传递带有验证错误的旧@order。希望这会有所帮助。

# android - 将数据从应用程序传递到 android 中另一台设备中安装的同一应用程序

> ID：14359324
> 
> 赞同：1
> 
> 时间：2013-01-16T13:14:29.593
> 
> 标签：android, android-contentprovider

我需要将一些数据（如电话号码、电子邮件地址等）从我的应用程序传递到同一个应用程序，但安装在另一台设备上。是否可以使用电话号码来执行此操作？我与短信无关，而是通过应用程序发送数据。如果是，如何？我还没有看到任何关于这个问题的教程。如果不是，我还有什么其他方法可以做到这一点？我已阅读有关套接字编程的内容。但我不太了解应该使用哪些 IP 地址和端口。而且我已经读过通信设备将是客户端，而接收设备将是服务器。所以数据只会单程旅行。我希望它能够相互通信。

有人对此事有建议吗？任何建议和教程将不胜感激！谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:23:04.787

您可以使用推送通知查看[http://elsoufy.blogspot.fr/2012/12/push-notifications-with-parsecom.html](http://elsoufy.blogspot.fr/2012/12/push-notifications-with-parsecom.html)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:26:41.040

您可以使用电话号码作为 ID，但不能使用它来发送数据。您的应用必须能够访问互联网才能执行您想要的操作。基本上，您需要一台服务器来同步设备并让它们交换数据。

粗略的示例模型：

客户端 A <----> `http://yourServer.com/messageParser.php`<----> 客户端 B

您的数据是使用 http POST 方法发送的。

# javascript - 子字符串上的 indexOf 和 lastIndexOf 问题 - 从字符串中获取部分 URL

> ID：14359326
> 
> 赞同：7
> 
> 时间：2013-01-16T13:14:32.057
> 
> 标签：javascript, jquery, regex, substring, indexof

我在以我想要的方式分解字符串时遇到了一些问题。我有一个这样的网址：

```
http://SomeAddress.whatever:portWhatever/someDirectory/TARGETME/page.html 
```

我正在尝试使用 substring 和 indexOf 而不是正则表达式来获取字符串上的 TARGETME 部分。这是我现在正在使用的功能：

```
 function lastPartofURL() {
    // Finding Url of Last Page, to hide Error Login Information
    var url = window.location;
    var filename = url.substring(url.lastIndexOf('/')+1);
    alert(filename);
} 
```

但是，当我写这篇文章时，我的目标是“page.html”部分，所以它返回了，但是我无法重新配置它来做我现在想做的事情。

如果可能的话，我希望它起源于字符串的开头而不是结尾，因为在我尝试定位之前应该总是有一个 url，然后是一个目录，但我对这两种解决方案都感兴趣。

这是一个执行类似操作的正则表达式，但它不安全（根据 JSLint），因此我不介意用更实用的东西替换它。

```
 /^.*\/.*\/TARGETME\/page.html.*/ 
```

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T13:25:26.700

正如其他人已经回答的那样，`.split()`这对您的情况有好处，但是假设您的意思是返回 URL 的“最后一部分”（例如`http://SomeAddress.whatever:portWhatever/dirA/DirB/TARGETME/page.html`也返回“TARGETME”），那么您不能使用固定数字，而是取之前的项目数组的最后一个：

```
function BeforeLastPartofURL() {
    var url = window.location.href;
    var parts = url.split("/");
    var beforeLast = parts[parts.length - 2]; //keep in mind that since array starts with 0, last part is [length - 1]
    alert(beforeLast);
    return beforeLast;
} 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T13:18:27.170

您可以通过`string.split()`...更轻松地做到这一点

```
function getPath() {
    var url = window.location;
    var path = url.split("/")[4];
    alert(path);
    return path;
} 
```

我只建议这种方法，因为您说您将始终知道 URL 的格式。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:19:23.663

```
 function lastPartofURL() {
    // Finding Url of Last Page, to hide Error Login Information
    var url = window.location;
    var arr = url.split('/');

    alert(arr[4]);
 } 
```

看[这里](http://jsfiddle.net/ZetvR/)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-16T13:19:32.983

尝试这个

```
 function lastPartofURL() {
    // Finding Url of Last Page, to hide Error Login Information
    var url = window.location;
    var sIndex = url.lastIndexOf('/');
    var dIndex = url.lastIndexOf('.', sIndex);
    if (dotIndex == -1)
    {
        filename = url.substring(sIndex + 1);
    }
    else
    {
        filename = url.substring(sIndex + 1, dIndex);
    }

    alert(filename);
} 
```

# iphone - UIView 上的圆角不精确

> ID：14359328
> 
> 赞同：1
> 
> 时间：2013-01-16T13:14:41.717
> 
> 标签：iphone, ios, objective-c, uiview

我对 UIView 上的圆角有一个奇怪的问题。**正如您在屏幕截图中看到的那样，黑色角落并不完全精确，**这意味着可以看到底层视图的一些像素（即角落中的白色像素用黄色箭头突出显示）。

我已经设置了这样的角半径：

```
contentView.layer.cornerRadius = 5.0f;
contentView.layer.masksToBounds = YES; 
```

contentView 是一个 UIView 对象，它包含一个 UIImageView 作为子视图（当前显示 Google 图像）。此外，contentView 作为子视图添加到屏幕截图中显示的主视图中。

我已经尝试了几件事但没有令人满意的结果，包括：

*   将圆角半径直接添加到主视图，而不是内容视图
*   增加/减少边框大小和圆角半径的值
*   将所有提及的视图的背景颜色更改为黑色、白色和清晰（目前是清晰的）

我感谢您的帮助。谢谢！

**截图**：

*   ![1](../Images/7d29a70ff2666605f07cc65bf716e8b4.png)
*   ![2](../Images/5ab31a7844c5ca3d19c792149c3d23a3.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:58:53.777

请在代码中尝试：

```
contentView.layer.borderWidth=1;
contentView.layer.borderColor=[UIColor blackColor].CGColor;
contentView.layer.cornerRadius=5; 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:44:58.263

我试过下面的代码对我来说很好

```
UIView *vi = [[[UIView alloc] initWithFrame:frame] autorelease];
vi.backgroundColor = [UIColor clearColor];
[self addSubview:vi];

UIImageView *imgv = [[[UIImageView alloc] initWithFrame:CGRectMake(0.0, 0.0, frame.size.width, frame.size.height)] autorelease];
imgv.layer.cornerRadius = 4.0;
imgv.layer.borderColor = [UIColor whiteColor].CGColor;
imgv.clipsToBounds = YES;
imgv.image = [UIImage imageNamed:@"xxxxxx.png"];
[vi addSubview:imgv]; 
```

希望对你有一点帮助。

# c++ - 类属性的 C++ 等价于 Matlab Abstract

> ID：14359330
> 
> 赞同：4
> 
> 时间：2013-01-16T13:14:47.720
> 
> 标签：c++, matlab, porting, abstract

**简短版本：**
考虑以下伪代码：

```
class Foo {
    private:
        abstract type myVar;
} // This class is abstract 
```

您将如何在标准 C++ 中实现这种行为？

* * *

**长版：**
我必须将大量面向 Obj 的代码从 Matlab 移植到 C++。请注意，我是世界上使用 Matlab 经验最少的人，自 2007 年以来我就不再使用 C++。

我在这个主题上搜索了很多，但我找不到我的问题的正确答案。所以我在这里:)

假设你有这个 matlab 类：

```
classdef Foo < handle
    properties (Abstract, Dependent)
        A
    end

    properties
        B
    end

    methods (Abstract)
        computeA()
    end

    methods (Access = protected)
        function obj = Foo(bar)
            obj.B = Matlab.BlaBlaBla(bar)
    end
end 
```

这个类（我想）不能“直接”分配，因为它的构造函数受到保护。属性“A”也是抽象的（暂时忽略也是依赖的事实）。MathWorks 告诉我们，这意味着：

*   具体的子类必须重新定义没有 Abstract 属性的抽象属性，并且必须使用与抽象超类中使用的相同的 SetAccess 和 GetAccess 属性值。
*   抽象属性不能定义 set 或 get 访问方法（请参阅属性访问方法），也不能指定初始值。定义具体属性的子类可以创建 set 或 get 访问方法并指定初始值。

那么你将如何在 C++ 中正确地翻译这种行为呢？如果我按照以下方式进行操作是否正确？（我的意思是这不是一个糟糕的设计实践）

```
class Foo {
    private:
         type A;
         type B;
    protected:
         virtual void computeA() = 0;
         Foo(type bar) { this.B = SomeFoo(bar); }
} 
```

我认为（我可能是错的）是，如果我这样做，就必须这样做

```
class Subclass: Foo {
    protected:
        void computeA(){...} 
    public:
        type A() { computeA(); return A; } //This is A getter that grants Dependent behavior
} 
```

否则在编译时会出错。

我错了吗？有更好的方法吗？也是翻译 Dependent 关键字的正确方法吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T15:10:49.983

首先，我认为重要的是要问：一个类的公共接口是什么（它的职责是什么，它如何与其他人交互）？

从您的 Matlab 代码中，答案是：该类定义了属性 A 和 B 以及方法 computeA。根据我对 Dependent 属性的理解，我怀疑 computeA() 应该是公开的（参见[Matlab 文档](http://www.mathworks.de/de/help/matlab/matlab_oop/property-access-methods.html#bsxanmy)）。如果您的其余代码需要这个，当然您可以将其公开，但我会尽量减少可访问性。

现在 C++ 中不存在属性的概念。Matlab 的有趣之处在于基类决定是否存在 A.get、A.set 或两者以及可访问性。我不知道这背后的原因，但在我看来这似乎没有太大意义。在 C++ 中，我会将属性转换为获取/设置方法。有关在 C++ 中实现这些的讨论，请参阅[此问题。](https://stackoverflow.com/questions/737409/are-get-and-set-functions-popular-with-c-programmers)根据您的选择，您可以将非依赖属性实现为成员对象或 get/set 方法。

一旦您定义了方法的公共接口，我就会尝试开始考虑如何实现它。请注意，Matlab 和 C++ 的内存管理是不同的（Matlab 使用 Copy on Write 并关心内存管理，这在纯 C++ 中都不存在）。此外，在（慢速面向对象的）Matlab 代码中可能需要缓存值（如使用 computeA 和相关属性所做的那样），但在 C++ 中则不一定。为了避免过早的优化，为什么不这样做：

```
class Foo {
    public:
      ClassB B;
      virtual ClassA getA() = 0;
      //define a setA()=0 if you need it here
    protected:
         //I wouldn't force subclasses to have the "caching" of dependent properties, so no virtual void computeA() = 0; 
         Foo(ClassBar const& bar) { this.B = ClassB(bar); /*Note that SomeFoo cannot be assigned to B*/ }
}
class Subclass: public Foo {
    private:
        ClassA A;
    public:
        ClassA getA() { ClassA A; /*compute A*/ return A; } 
} 
```

如果你体验到 A 的计算速度太慢，你仍然可以在 Subclass 中“本地缓存 A”：

```
class Subclass: public Foo {
    private:
        ClassA A;
    public:
        ClassA getA() { /*compute A if required*/ return A; } 
} 
```

如果您真的想将 A 存储在 Foo 中，我宁愿将其实现为

```
class Foo {
    private:
      ClassA A;
    public:
      ClassB B;
      ClassA getA() { if (!A.initialized) A=computeA(); return A; };
    protected:
         virtual ClassA computeA() = 0;
         Foo(ClassBar const& bar) { this.B = ClassB(bar); /*Note that SomeFoo cannot be assigned to B*/ }
}
class Subclass: public Foo {
    protected:             
         virtual ClassA computeA() {...}
} 
```

并且不要忘记始终考虑您是否真的想通过（const）引用或值传递......

# r - 在 r 中添加一个新的行和列

> ID：14359331
> 
> 赞同：0
> 
> 时间：2013-01-16T13:14:50.107
> 
> 标签：r, row, dataframe, add

我想向数据框的第一列和第一行添加一个新值。

数据样本：

```
 ali ata
1   u   w
2   y   e
3   t   r
4   f   x
5   s   z 
```

预期成绩：

```
 ali ata
1  ttt  NA
2   u   w
3   y   e
4   t   r
5   f   x
6   s   z 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:22:28.297

读取数据。在这里，将字符串编码为字符串（而不是因子）很重要：

```
df <- read.table(text="ali ata
1   u   w
2   y   e
3   t   r
4   f   x
5   s   z", header = TRUE, stringsAsFactors = FALSE) 
```

您可以使用`rbind`添加值：

```
rbind(c("ttt", rep(NA, ncol(df) - 1)), df)

   ali  ata
1  ttt <NA>
11   u    w
2    y    e
3    t    r
4    f    x
5    s    z 
```

# regex - IIS URL 重写重定向

> ID：14359333
> 
> 赞同：0
> 
> 时间：2013-01-16T13:14:56.143
> 
> 标签：regex, iis, url-rewriting

我正在尝试找出如何编写 IIS URL 重写规则以通过以下规则进行重定向：

例如：
`s1.mysite.com/mypage.aspx?p=1`应该重定向到`www.mysite.com/mypage.aspx?p=1`.

但此重定向规则仅适用于 URL 以下列之一开头的情况：

“s1”、“s2”、“s5”并包含“.aspx”。

我开始为此编写一些正则表达式模式`"(s1\.|s2\.|s5\.)+(.)*(\.aspx)+"`，但实际上，我什至不知道我是否走在正确的道路上。

在我有了`regex`模式之后，我怎么知道`IIS`重定向到完全相同的 url，只是`s1|s2|s5`它必须是`www`.

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T14:40:56.027

这应该可以完成工作：

```
<rewrite>
    <rules>
        <rule name="Redirect s1, s2 and s5 subdomains" stopProcessing="true">
            <match url="\.aspx$" />
            <conditions logicalGrouping="MatchAll">
                <add input="{HTTP_HOST}" pattern="^(s1|s2|s5)\.mysite\.com$" />
            </conditions>
            <action type="Redirect" url="http://www.mysite.com/{R:0}" appendQueryString="true" redirectType="Permanent" />
        </rule>
    </rules>
</rewrite> 
```

# magento - magento 的 NGINX-FPM 配置设置

> ID：14359337
> 
> 赞同：1
> 
> 时间：2013-01-16T13:15:09.547
> 
> 标签：magento, nginx, magento-1.7, php

我正在运行一个用 magento 开发的电子商务网站。我在服务器上有 512mb RAM 和 2.6 core2duo。当我在我的网站上一次发送 50 个请求时，除了一些请求外，它没有响应。我也安装了清漆。我想知道我想为我的网站做的最佳设置。我已经看到 PHP-FPM 占用了太多的内存和 cpu 使用率。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T14:26:52.927

## 背景

我们在生产机器（VCenter 虚拟机，4 核，8 GB 内存）上的 ubuntu 12 上使用 nginx 和 php5-fpm。我们的 magento 安装是大量主题和扩展的。前几天为了好玩，我在默认安装了 Magento 1.12 EE 的 VMWare 机器上从头开始安装了所有东西（我需要将它们称为错误）。我只是这样说，你知道我们在生产环境中有 nginx 和 php5-fpm。

你要问的是我认为每个人都在努力使用 nginx 和 php fpm ......从中获得更多性能。我的意思是，如果我们不试图提高网站性能，我们可以只使用 apache 和 php 吗？有很多答案、意见和案例库解决方案，但我会向您指出我用来配置我的系统的指南......

[http://www.if-not-true-then-false.com/2011/nginx-and-php-fpm-configuration-and-optimizing-tips-and-tricks/](http://www.if-not-true-then-false.com/2011/nginx-and-php-fpm-configuration-and-optimizing-tips-and-tricks/)

摘自博客评论：

> ...但是，问题确实是Magento，而不是服务器的配置。Magento 对于任何环境来说都太大太重了。Magento 托管确实是一项乏味且令人不快的任务。

它可能无法回答您遇到的所有问题，但有很多好事情可以确保您这样做......比如设置 worker_processes = 你有多少核心等。

就我个人而言，我仍然遇到的一件事是，如果服务器负载变得非常高（每秒超过 5 到 10 次点击），那么处理器就会受到重创。我还没有完全解决这个问题，但是添加一个核心并撞到 ram 会产生很大的影响。我可能会增加内存，但目前我们的用户群没有看到任何网站性能问题。

（从另一个网站博客文章中找到：）

> Magento 在其许多操作中大量使用磁盘子系统。磁盘 I/O 是最佳 Magento 性能的最大瓶颈，仅次于 CPU（内核）。
> 
> 这就是为什么 Magento 在云环境中表现如此糟糕的原因，其中存储位于与无数其他用户共享的 SAN 上，并且在随机时间承受压力，导致性能不一致。
> 
> 在 RAID1+0 磁盘阵列中配置的 SSD（固态驱动器）本地性能优于相同 RAID 配置中的 15.5K SAS 驱动器。
> 
> 本地数据库也是 Magento 实现最佳性能的关键
> 
> 由于系统调用和网络饱和，远程数据库引入了延迟。如果您必须使用远程数据库，则应确保您位于专用 VLAN 上，并且不共享过度饱和的网络连接，即使是最大的托管服务提供商也很常见。在最好的网络环境中，由于各种原因，远程数据库不会像本地数据库那样快。
> 
> CPU 速度和 CPU 数量对于优化 Magento 性能也非常重要。您可以通过以下 URL 了解您正在使用的高端 CPU 的功能 - 如果 CPU 未在此处列出，则基准“PassMark Software”不会将其视为“高端”；
> 
> [http://www.cpubenchmark.net/high_end_cpus.html](http://www.cpubenchmark.net/high_end_cpus.html)
> 
> 基于性能的 Web 服务器，例如 LiteSpeed，使用多个 CPU（内核），就像 MySQL 服务器一样，具有适当的配置。使用基于性能的 Web 服务器可以显着提高您的应用程序相对于 Apache Web 服务器软件的性能。
> 
> 尝试重写或转换/编译 Magento 不是一个解决方案 - 它充其量只是一个创可贴。您将无法进行任何未来的升级（没有大量的开发时间来重写和测试您的更改），并且每次升级我们都会继续看到速度提升。永远不要执行对 Magento 的核心更改，永远不要执行对 Magento 的核心更改 - 这违背了 Magento 采用的 OOP 模型。
> 
> 最后，正如我们之前所说，如果不对运行应用程序的基础架构进行大量投资，Magento 就无法实现最佳性能。如果您正在考虑运行 Magento 并希望在预算托管提供商上这样做，请了解您根本无法也不会使用此应用程序实现峰值性能。
> 
> **Magento 由于其复杂性而需要资源 - 您无法在预算托管服务提供商处提供必要的资源，因为此类硬件系统的成本并不便宜。**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2017-06-27T15:02:43.773

你应该增加内存超过 512m，因为 nginx + php-fpm 和 varnish run 使用的内存超过了系统的内存。我进行了溢出，php 进程没有足够的内存来执行

# html - 如何在加载到 webview 的 HTML 上设置字体和行距？

> ID：14359339
> 
> 赞同：1
> 
> 时间：2013-01-16T13:15:12.217
> 
> 标签：html, ios, uiwebview, format

我有一个 iOS 应用程序可以解析来自远程 rss 提要的文章。

当我通过 webview 和“LoadHTMLString:withURL”对其进行格式化时，文本会使用一些默认字体/行间距进行格式化。我想设置自己的字体/行间距，我认为如果我在每篇文章的开头包含正确的 HTML 格式代码作为字符串，就可以做到这一点。

这样，我将根据自己的喜好操纵 XCode 来格式化字符串。

唯一的事情是，当我添加行

```
<p style="font: 20pt/30pt Times New Roman, serif;"> 
```

文本仍然未格式化。我觉得这可能是因为它创建了一个格式化的 nil 段落，但也是 nil，所以没有可检测到的变化。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:35:29.233

该代码在段落中设置了一个段落，因此它不起作用，但是如果您将其设置为

```
 NSMutableString *htmlString = [NSMutableString stringWithFormat:@"<div style=\"font: 20pt/30pt Times New Roman, serif;\">%@</div>", textFile ]; 
```

相反，它工作正常。

# ms-access - 如何让 MS-Access 停止忽略总和和计数查询中的记录

> ID：14359341
> 
> 赞同：2
> 
> 时间：2013-01-16T13:15:17.080
> 
> 标签：ms-access

要设置问题，我必须在用于跟踪会费和注册的 Access 表中跟踪 4 条记录。这个表名是“交易”

```
ID | Transaction Date | Transaction Name | Credit Account | Debit Account | Amount
1 | 9/1/2011 | 2011 Yearly Registration | Accounts Receivable | Income : Registration | 27
2 | 2/18/2012 | Registration Payment | Cash | Accounts Receivable | 27
3 | 11/1/2012 | 2012 Yearly Registration | Accounts Receivable | Income : Registration | 27
4 | 12/7/2012 | Registration Payment | Cash | Accounts Receivable | 27 
```

（事务名称字段实际上是一个 ID 字段，它与另一个存储实际名称的表具有 FK。这将在稍后显示）。

然后，我创建了一个查询，将这些记录转换为一种格式，我可以将数量相加以找出余额：

```
SELECT [Transaction Date], [Transaction Name], (select [Account Name] from Account_lookup where ID = Transactions.[Credit Account]) as Account , sum(Amount) as [Totals]
FROM Transactions
GROUP BY [Transaction Date],[Transaction Name],[Credit Account]
UNION SELECT  [Transaction Date],[Transaction Name],(select [Account Name] from Account_lookup where ID = Transactions.[Debit Account]) as Account, sum(Amount)*-1 as [Totals]
FROM Transactions
GROUP BY [Transaction Date],[Transaction Name],[Debit Account]
ORDER BY 3, 1 DESC; 
```

结果如下（收入和现金记录已被删除，因为它们对于这个问题并不重要）。该查询称为“贷方和借方账户总计”。

```
Transaction Date | Transaction Name | Account | Totals
9/1/2011 | 2011 Yearly Registration | Accounts Receivable | 27
2/18/2012 | Registration Payment | Accounts Receivable | (27)
11/1/2012 | 2012 Yearly Registration | Accounts Receivable | 27
12/7/2012 | Registration Payment | Accounts Receivable | (27) 
```

因此，对 Totals 列求和的查询应该返回 0。但事实并非如此。

当我在上面的查询之上运行以下查询时（我的查询查询另一个查询），

```
SELECT [Credit and Debit Account Totals].Account, Sum([Credit and Debit Account Totals].Totals) AS SumOfTotals
FROM [Credit and Debit Account Totals]
GROUP BY [Credit and Debit Account Totals].Account
HAVING ((([Credit and Debit Account Totals].Account)="Accounts Receivable")); 
```

我得到以下信息：

```
Account | SumOfTotal
Accounts Receivable | 27 
```

如果我将总和更改为计数，那么我得到 3。我期望总和为 0，计数为 4。

如何让 Access 使用我的所有 4 条记录？我猜测 Access 以某种方式忽略了第二次付款，因为 Transaction Name 是相同的，但是 Name 不是 sum 查询的一部分，并且 Date 字段使每一行在第一个查询中总体上是不同的。

我试过把 ALL 放在 SELECT 之后，但这没有用。我是否必须先将所有数据复制到另一个表中 - iow 是否因为在联合查询之上运行总和查询而使 Access 感到困惑？当我将日期添加到第二个查询时，从而使每一行都不同，我看到所有 4 条记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:03:54.050

退后一步。更改您的第一个查询：

```
SELECT [Transaction Date], [Transaction Name], 
       [Credit Account] As Account,Amount 
FROM Transactions
UNION 
SELECT [Transaction Date],[Transaction Name], 
       [Debit Account] As Account,Amount*-1 
FROM Transactions 
```

然后

```
SELECT [Credit and Debit Account Totals].Account, 
       Sum([Credit and Debit Account Totals].amount) AS SumOfamount
FROM [Credit and Debit Account Totals]
GROUP BY [Credit and Debit Account Totals].Account
HAVING [Credit and Debit Account Totals].Account="Accounts Receivable" 
```

我认为分组层太复杂了。

**编辑重新评论**

```
SELECT [Transaction Date], [Transaction Name], 
       Account, Sum(Amount ) AS Total
FROM (SELECT [Transaction Date], [Transaction Name],
      [Credit Account] As Account,Amount 
FROM Transactions
UNION 
SELECT [Transaction Date],[Transaction Name], 
       [Debit Account] As Account,Amount*-1 
FROM Transactions)  AS q
GROUP BY [Transaction Date], [Transaction Name], Account
ORDER BY 3, 1 DESC; 
```

# html - jQuery悬停在不工作的现场作品上

> ID：14359345
> 
> 赞同：1
> 
> 时间：2013-01-16T13:15:23.693
> 
> 标签：html, jquery, jquery-hover, jquery-on

我遇到了问题

```
$('.myElement').on('hover',function({...}); 
```

在尝试了`.on('hover'`,之后`.hover()`，两者都不起作用，我尝试了`.live('hover',)`。 `.live('hover',)`工作.. 但是，我使用的是 jQuery 1.8.3，这是为什么呢？这是我正在使用的代码：

jQuery

```
$('.myElement > a').live('hover',function(event) {
    //do stuff
} 
```

HTML

```
<div class="myElement">
    <a href="#" />
</div> 
```

有时我想知道我只是在犯愚蠢的错误还是语言只是疯了..

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:17:40.023

`on()`仅`live()`在您将第二个参数中的委托选择器传递给它时才起作用。在您的情况下，主要选择器将是您的`.myElement`元素被附加到的容器元素，委托将是`.myElement`，如下所示：

```
$('.parentOfMyElement').on('hover', '.myElement', function() {
    // do stuff...
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:18:04.813

至于所有其他方法（除了 .live() ...这是它已被弃用的原因之一） .on() 仅适用于已经存在的元素。如果您还想将事件处理程序绑定到尚不存在的元素，则需要使用来自更高级别元素的委托。

例如，'.myElement' 是 '.myContainer' 的子元素，那么你可以这样做

```
$('.myContainer').on('hover', '.myElement', function(e) {
    ...
}); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:18:16.740

尝试这个。

```
$('body').on('hover', '.myElement', function...); 
```

正文可以引用您需要监视事件的任何上下文或容器。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:22:51.510

尝试这个

```
$('.myElement > a').hover(function(event) {
//do stuff
  alert('hover');
}); 
```

一个看到这个[例子](http://jsfiddle.net/wETdB/2/)

问候。

# eclipse - 使用 Eclipse 的 Web Services Explorer 从 Eclipse 内部测试 Web 服务

> ID：14359350
> 
> 赞同：0
> 
> 时间：2013-01-16T13:15:39.763
> 
> 标签：eclipse, web-services, eclipse-plugin, eclipse-wtp

我安装了带有 WTP (http://www.eclipse.org/webtools/ws/)、Tomcat 和 Axis2 的 Eclipse。

我正在学习网络服务。我有一个简单的 Hello 类，用于创建 WS 服务器和客户端。

在 Eclipse 中，我右键单击 Hello.java，然后转到 New > Other > Web Service。我将服务器设置为“启动服务”，将客户端设置为“测试客户端”，然后单击下一步两次。在此向导中，我在“测试 Web 服务”屏幕上结束，该屏幕将 Web 服务资源管理器列为唯一可用的测试工具。

在这里，如果我单击启动按钮，将使用 Web 服务资源管理器打开一个浏览器窗口，其中的 URL`http://127.0.0.1:59981/wse/wsexplorer/wsexplorer.jsp?org.eclipse.wst.ws.explorer=4`可以选择 helloName 操作以在“操作”面板中打开一个表单来测试 Web 服务。一切正常，我可以将表单发送到 WS 客户端，后者将消息发送到服务器，获取其响应并在状态面板中显示 SOAP 请求和响应信封。

回到 Eclipse，我仍然打开了那个向导窗口（我点击了 Launch 按钮）。如果我单击 Finish（或多次单击 Next），则会从 Eclipse 项目 HelloClient 构建一个新客户端，然后它会从 Eclipse 内部的 URL 中打开`http://localhost:8080/HelloClient/sampleHelloProxy/TestClient.jsp`，标题为 Web Services Test Client。

请注意，Web 服务资源管理器（从启动按钮在浏览器中打开）使用端口 59981，而 Web 服务测试客户端（向导完成时在 Eclipse 中打开）使用端口 8080（Tomcat 主端口）。

因此，正在构建 2 个不同的客户端。Web Services Explorer 有更好的输入表单，允许从复选框设置 nil 值，有一个 CalendarBrowser 来选择日期等，它显示 SOAP 信封......但对于复杂的响应，它没有 Web Services Test Client 的结果面板在更易于查看的 HTML 页面中显示复杂的响应。

另一方面，Web 服务测试客户端无法为更复杂的输入构建适当的表单。例如，WSDL 的 xsd:simpleType 和 xsd:restriction 只是在表单中被忽略，导致服务器因为缺少参数而返回错误消息。

我的问题是：

1）有没有办法从向导中选择在Eclipse中打开哪个客户端？和我一起学习的朋友只需完成向导即可从 Eclipse 中打开 Web Services Explorer。

2) 是否有任何插件允许 Web Services Explorer 的客户端构建响应页面以便于查看？这是 Web Services Test Client 的客户端克服 Web Services Explorer 的唯一缺失。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:30:26.323

知道了！

在 Test Web Service 屏幕之后，我再单击 Next 2 次，然后到达 Web Service Client Test。

在其中我有另一个测试设施字段，我可以在其中选择“JAX-RPC JSP”或“Web 服务资源管理器”。选择第二个，它会在 Eclipse 中按我的意愿打开。

在它的状态面板中，我有一个表单视图，它显示了一个很好的响应 HTML 和源视图，它显示了 SOAP 请求和响应信封的突出显示！

# sql - 将同一列中的多个值聚合为连接字符串（10g）

> ID：14359354
> 
> 赞同：0
> 
> 时间：2013-01-16T13:15:44.473
> 
> 标签：sql, oracle10g, aggregate

我有一个很长的查询，跨越多个表，我在其中连接了四个值作为所有者（名字、中间名和姓氏 + org）。所有其他列都是相同的，但是有多个所有者，因此，我想聚合多行。

我看到的是（配对）

```
#     Owner
1     Sam Smith, AAA
2     Stan Bird, BBB
2     Nancy Bird, BBB
3     Mike Owen, CCC 
```

我想看到的是

```
#     Owner
1     Sam Smith, AAA
2     Stan Bird, Nancy Bird, BBB
3     Mike Owen, CCC 
```

注意事项：

*   我无法创建函数（缺乏权限）
*   使用 Oracle 10g
*   我已经尝试过`CASE(COLLECT...`，但这会破坏我的联系：

    > 错误-“没有更多数据可以从套接字读取”

    系统管理员，不知道为什么

*   WM_CONCAT 只是重复一个所有者（有时 20 次），并没有给出想要的结果。

我尝试了其他一些事情，但没有运气。我当前的查询正在生成所需的行数，但只是删除了第二个所有者。

我不确定在此处发布整个查询是否明智。请让我知道这是否会有所帮助。

* * *

**2012-01-29 更新**

我`wm_concat`之前使用不正确，但是当我按照您的说明使用它时，我收到了这个错误：

```
 ORA-06502: PL/SQL: numeric or value error: character string buffer too
 small ORA-06512: at "WMSYS.WM_CONCAT_IMPL", line 30
 06502\. 00000 -  "PL/SQL: numeric or value error%s"
 *Cause:    
 *Action: 
```

我相信可能有一些更高层次的问题在起作用。我的系统管理员对“不再从套接字读取数据”问题没有答案。这可能是另一个。

我的 SQL 知识有限，而且由于查询的长度和复杂性，我似乎无法实现`sys_connect_by_path`; 完全是我自己的错。

很抱歉延迟回复。我被拉走以完成另一项任务。感谢您的所有帮助。感谢 ShadowWizard 的赏金。

**编辑**
这是我`wm_concat`在当前实例中使用的方式：

```
 replace(cast(wm_concat(PERSON.MASTER_PERSON_FIRST_NAME   || ' '   ||
 PERSON.MASTER_PERSON_MIDDLE_INITIAL   || ' '   ||
 PERSON.MASTER_PERSON_LAST_NAME   || ','   || ' '   ||
 ORGANIZATION.MASTER_ORG_NAME) AS VARCHAR2(1000 BYTE)), ',', ', ') AS
 "Owner(s)", 
```

对不起，忘了包括那个。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-23T18:35:33.463

不知道为什么`wm_concat`对您不起作用，但我怀疑您的级别错误或分组奇怪。

如果我设置一些虚拟数据：

```
create table issues (id number);

create table owners (id number, first varchar2(10), middle varchar2(10),
    last varchar2(10), org varchar2(3));

create table issue_owners (issue_id number, owner_id number);

insert into issues (id) values (1);
insert into issues (id) values (2);
insert into issues (id) values (3);

insert into owners (id, first, middle, last, org)
    values (11, 'Sam', null, 'Smith', 'AAA');
insert into owners (id, first, middle, last, org)
    values (12, 'Stan', null, 'Bird', 'BBB');
insert into owners (id, first, middle, last, org)
    values (13, 'Nancy', null, 'Bird', 'BBB');
insert into owners (id, first, middle, last, org)
    values (14, 'Mike', null, 'Owen', 'CCC');

insert into issue_owners (issue_id, owner_id) values (1, 11);
insert into issue_owners (issue_id, owner_id) values (2, 12);
insert into issue_owners (issue_id, owner_id) values (2, 13);
insert into issue_owners (issue_id, owner_id) values (3, 14); 
```

...它提供与配对样本相同的初始输出：

```
column issue_id format 9 heading "#"
column owner format a50 heading "Owner"

select i.id as issue_id,
    o.first
        || case when o.middle is null then null else ' ' || o.middle end
        || ' ' || last || ', ' ||o.org as owner
from issues i
left join issue_owners io on io.issue_id = i.id
left join owners o on o.id = io.owner_id
order by issue_id, owner;

 # Owner
-- --------------------------------------------------
 1 Sam Smith, AAA
 2 Nancy Bird, BBB
 2 Stan Bird, BBB
 3 Mike Owen, CCC

4 rows selected. 
```

我可以`wm_concat`用来聚合名称：

```
select issue_id,
    replace(cast(wm_concat(owner_name) as varchar2(4000)), ',', ', ')
        || ', ' || owner_org as owner
from (
    select i.id as issue_id,
        o.first
            || case when o.middle is null then null else ' ' || o.middle end
            || ' ' || last as owner_name,
        o.org as owner_org
    from issues i
    left join issue_owners io on io.issue_id = i.id
    left join owners o on o.id = io.owner_id
)
group by issue_id, owner_org
order by issue_id, owner;

 # Owner
-- --------------------------------------------------
 1 Sam Smith, AAA
 2 Stan Bird, Nancy Bird, BBB
 3 Mike Owen, CCC

3 rows selected. 
```

只是在`replace`名称之间放置空格，这并不完全相关，我`cast`之所以这样做，是`varchar2`因为`wm_concat`返回 a`clob`会导致连接`org`. 至少，它`clob`在 11gR2 中——我没有 `wm_concat`可用的 10g 实例，但我*认为*它会`varchar2`在早期版本中返回；如果是这样，`cast`则不需要，它更像是：

```
select issue_id,
    replace(wm_concat(owner_name), ',', ', ') || ', ' || owner_org as owner
from (
... 
```

我不确定你的`org`价值来自哪里，所以这可能被简化了，我不知道如果`org`它与一个人（而不是一个问题或你的等价物）相关联并且一个问题有两个拥有不同`org`价值观的业主。

* * *

如果这没有让您更接近，那么也许您可以发布查询的精简版本，用一些固定数据替换长的多表部分，并展示您如何尝试使用`wm_concat`它；或您自己的显示相同行为的示例数据构建版本。

* * *

建议 Appleman1234 的替代`sys_connect_by_path`方法，用于相同的数据：

```
select issue_id,
    ltrim(max(sys_connect_by_path(owner_name, ', '))
        keep (dense_rank last order by curr), ', ')
        || ', ' || owner_org as owner
from (
    select issue_id,
        owner_name,
        owner_org,
        row_number() over (partition by issue_id order by owner_name) as curr,
        row_number() over (partition by issue_id order by owner_name) - 1 as prev
    from (
        select i.id as issue_id,
            o.first
                || case when o.middle is null then null else ' ' || o.middle end
                || ' ' || last as owner_name,
            o.org as owner_org
        from issues i
        left join issue_owners io on io.issue_id = i.id
        left join owners o on o.id = io.owner_id
    )
)
group by issue_id, owner_org
connect by prev = prior curr and issue_id = PRIOR issue_id
start with curr = 1;

 # Owner
-- --------------------------------------------------
 1 Sam Smith, AAA
 2 Nancy Bird, Stan Bird, BBB
 3 Mike Owen, CCC

3 rows selected. 
```

如果你最终使用它，Appleman1234 应该添加一个答案，我会删除这部分，因为他应该得到建议！反正我也想试试，以前看过，但是不记得了。。。

# ember.js - Ember.js 新路由器“历史”实现

> ID：14359358
> 
> 赞同：2
> 
> 时间：2013-01-16T13:15:49.543
> 
> 标签：ember.js, ember-router

我想我检查了所有文档，但我不能使用路由器的“历史”实现。任何人都有一个关于如何使用它的简短示例？或者，一般来说，应该如何将路由器参数传递给新路由器（例如也记录日志）。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T20:10:19.397

如果我没记错的话，最新的路由器会自动为您实例化 App.Router，而不是：

```
App.Router = Ember.Router.extend({ location: 'history' }) 
```

你要：

```
App.Router.reopen({ location: 'history' }) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T23:12:59.460

我通读了 ember.js 源代码，这似乎是最理智的方式，因为初始化是在应用程序中进行的。

```
App = Ember.Application.create({
  Router: Ember.Router.extend({
    location: 'history'
  })
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:29:19.580

在定义路线映射之前，我会尝试做类似的事情

```
App.Router = Ember.Router.extend({
  location: 'history'
}) 
```

# java - intern() 如何帮助改善不确定性和绩效？

> ID：14359361
> 
> 赞同：-4
> 
> 时间：2013-01-16T13:16:13.723
> 
> 标签：java

intern 方法返回字符串的规范形式，它可以与字符串本身不同或相同。它有助于提高性能还是仅仅消除不确定性？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:19:06.370

`intern`根本不改变字符串；它只是在特殊用途的**常量池中**为其分配内存，它不是常规堆的一部分（它在*永久代*中）。性能只是间接地得到改善：如果你知道你正在比较两个实习字符串，你可以可靠地使用`==`而不是`equals`.

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:33:06.523

intern() 通过减少重复字符串的数量来提高性能。这减少了内存消耗，但更重要的是提高了缓存的使用。（缓存比你的主内存小得多*）*

但是，如果在此池中放置太多字符串，直接使用它可能会出现性能问题（普通程序不会这样做，但您可以编写一个程序来这样做）这是因为将字符串添加到池中的成本很高 O (N) 不是您可能假设的 O(log N)，而且清理起来更加昂贵。在 java 7 中，字符串文字池被移到堆中以减少大型字符串文字池的影响，但我仍然建议您谨慎使用它（如果有的话）。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:19:20.890

当你对一个字符串调用intern方法时，它会检查字符串池是否有那个字符串。如果存在，它会返回对该字符串的引用，否则会向池中添加一个新的字符串。性能可以提高，因为你可以使用== 而不是 equals（== 检查更快，因为它只会比较对象地址而不是其内容），但我强烈建议不要使用 == 来比较字符串。

# android - 如何修复打开蓝牙的错误？

> ID：14359370
> 
> 赞同：0
> 
> 时间：2013-01-16T13:16:41.370
> 
> 标签：android, bluetooth

我用蓝牙创建了一个应用程序，但是当蓝牙关闭时，apk 用 toast 关闭，我有这个错误 **`java.lang.NullPointerException`** ......**`io.webbt.Activity2.openBT`**

```
void findBT()
{
    mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();
    if(mBluetoothAdapter == null)
    {
        myLabel.setText("No bluetooth adapter available");
    }

    if(!mBluetoothAdapter.isEnabled())
    {
        Intent enableBluetooth = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);
        startActivityForResult(enableBluetooth, REQUEST_ENABLE_BT);
    }     
} 
```

如果我想打开蓝牙，我有一条消息我选择是...但是在不继续我的活动之后...有什么帮助吗？如果蓝牙关闭，我如何回到我的活动？

```
01-16 15:36:08.483: W/dalvikvm(3677): threadid=1: thread exiting with uncaught exception (group=0x2b542210)
01-16 15:36:08.483: E/AndroidRuntime(3677): FATAL EXCEPTION: main
01-16 15:36:08.483: E/AndroidRuntime(3677): java.lang.RuntimeException: Unable to start activity ComponentInfo{io.webbt/io.webbt.Activity2}: java.lang.NullPointerException
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1967)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.app.ActivityThread.handleLaunchActivity(ActivityThread.java:1992)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.app.ActivityThread.access$600(ActivityThread.java:127)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.app.ActivityThread$H.handleMessage(ActivityThread.java:1158)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.os.Handler.dispatchMessage(Handler.java:99)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.os.Looper.loop(Looper.java:137)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.app.ActivityThread.main(ActivityThread.java:4441)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at java.lang.reflect.Method.invokeNative(Native Method)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at java.lang.reflect.Method.invoke(Method.java:511)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:784)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:551)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at dalvik.system.NativeStart.main(Native Method)
01-16 15:36:08.483: E/AndroidRuntime(3677): Caused by: java.lang.NullPointerException
01-16 15:36:08.483: E/AndroidRuntime(3677):     at io.webbt.Activity2.openBT(Activity2.java:192)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at io.webbt.Activity2.onStart(Activity2.java:130)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at android.app.Instrumentation.callActivityOnStart(Instrumentation.java:1133)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at   android.app.Activity.performStart(Activity.java:4475)
01-16 15:36:08.483: E/AndroidRuntime(3677):     at   android.app.ActivityThread.performLaunchActivity(ActivityThread.java:1940)
01-16 15:36:08.483: E/AndroidRuntime(3677):     ... 11 more

 void openBT() throws IOException
  {
  UUID uuid = UUID.fromString("00001101-0000-1000-8000-00805f9b34fb"); //Standar      
  mmSocket = mmDevice.createRfcommSocketToServiceRecord(uuid);       
  mmSocket.connect();
  mmOutputStream = mmSocket.getOutputStream();
  mmInputStream = mmSocket.getInputStream();

  myLabel.setText("Bluetooth Opened");

  protected void onStart() {
    super.onStart();

    try
    {         
        //findBT();
        openBT();                            
    }
    catch (IOException ex) { }

    runnable.run(); 
```

}

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:46:06.810

你有广播接收器吗？我认为这将帮助您聆听蓝牙状态以及在每种状态下执行所需操作的能力..

看看[这里](https://stackoverflow.com/questions/4715865/how-to-programmatically-tell-if-a-bluetooth-device-is-connected-android-2-2)

# c - 在 C 中跳过关键代码的类似 Try-catch 的行为

> ID：14359378
> 
> 赞同：1
> 
> 时间：2013-01-16T13:16:58.183
> 
> 标签：c, try-catch, critical-section

> **可能重复：**
> [ANSI C 等效于 try/catch？](https://stackoverflow.com/questions/3762605/ansi-c-equivalent-of-try-catch)

有没有办法跳过关键代码？或多或少类似于现代编程语言中的 try-catch。刚才我正在使用这种技术来发现错误：

```
bindSignals();
{
    signal(SIGFPE, sigint_handler);
    // ...
}

int main(void)
{
    bindsignals();
    int a = 1 / 0; // division by zero, I want to skip it
    return 0;
} 
```

问题是如果我不退出处理程序中的程序，我会一次又一次地得到同样的错误。如果可能的话，我想避免`goto`。我也听说过“跳远”什么的。值得（学习）使用吗？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:21:44.673

好吧，您可能可以使用 来完成类似的事情`[longjmp()](http://linux.die.net/man/3/longjmp)`，是的。

可能在某些宏的“帮助”下。但是请注意手册页上的注释：

> `longjmp()`并使`siglongjmp()`程序难以理解和维护。如果可能，应使用替代方案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:00:57.453

我会为此投入两分钱。C 没有其他语言支持的 try/catch 之类的机制。[`setjmp()`](http://linux.die.net/man/3/setjmp)您可以使用类似的东西来构建一些东西[`longjmp()`](http://linux.die.net/man/3/longjmp)，但没有完全相同的东西。

这是[一个链接](http://www.on-time.com/ddj0011.htm)，显示了一种很好的使用方式`setjmp`和`longjmp`做你想做的事情；以及来自同一来源的代码片段：

```
 jmp_buf jumper;

   int SomeFunction(int a, int b)
   {
      if (b == 0) // can't divide by 0
         longjmp(jumper, -3);
      return a / b;
   }

   void main(void)
   {
      if (setjmp(jumper) == 0)
      {
         int Result = SomeFunction(7, 0);
         // continue working with Result
      }
      else
         printf("an error occured\n");
   } 
```

我目前正在从 C 转到 Java，我很难理解为什么你首先要使用 try/catch。通过良好的错误检查，您应该没问题，始终始终使用从函数返回的值，检查错误值并验证任何用户输入。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T14:32:41.510

我受够了。这就是我的代码现在的样子。几乎像 Java 和 C#。

```
#include <setjmp.h>

jmp_buf jumper;

#define try           if (setjmp(jumper) == 0)
#define catch         else
#define skip_to_catch longjmp(jumper, 0)

static void sigint_handler(int sig)
{
    skip_to_catch;
}

int main(void)
{
    // init error handling once at the beginning
    signal(SIGFPE,  sigint_handler);

    try
    {
        int a = 1 / 0;
    }
    catch
    {
        printf("hello error\n");
    }
    return 0;
} 
```

# batch-file - 如何将文件名批量转换为小写并更新其在相应文件中的引用

> ID：14359379
> 
> 赞同：2
> 
> 时间：2013-01-16T13:16:59.327
> 
> 标签：batch-file, batch-processing, lowercase, batch-rename, dreamweaver

Adobe Dreamweaver 完美地做到了这一点，但仅使用单个文件名。在 Dreamweaver 中，当我在右侧的“本地文件”框中选择文件名时，按 F2 并重命名文件，将打开一个对话框以确认更新当前站点中任何 html、css 文件中的相关引用。

我正在寻找批处理这个过程，因为我有数千个骆驼大小写格式的文件，我需要将它们全部更改为小写。这里的问题是我还必须在任何 html、css 等文件中更新它们的相关引用，这是一项乏味的任务。

所以只是寻找一种工具或方法来批处理这个过程，我可以将所有文件名转换为小写，并更新它们相应的引用/条目。引用名称可能位于给定文件夹或任何目录中的 html 或 css 文件中。

提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-17T15:41:29.617

经过大量改进后，我创建了这个批处理脚本，它将遍历当前目录中的所有指定文件并将它们重命名为小写，并且还检查每个文件的内容并将所有大写字母更改为小写。

```
@echo off
setlocal enabledelayedexpansion
set num=0
for %%a in (A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z) do (
set upper[!num!]=%%a
set /a num+=1
)
set num=0
for %%b in (a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z) do (
set lower[!num!]=%%b
set /a num+=1
)
for %%x in (C:\Users\folder1,C:\anotherfolder) do (
cd /d %%x
(
for %%c in (*.*) do (
set file=%%c
for /f "tokens=* delims=" %%e in (%%c) do (
set line=%%e
for /l %%d in (0,1,25) do (
set u=!upper[%%d]!
set l=!lower[%%d]!
call :RETURN !u! !l!
)
echo !line! >>new.txt
)
del %%c /f /q
ren new.txt %%c
ren %%c !file!
)
)
)

:RETURN
set file=!file:%1=%2!
set line=!line:%1=%2! 
```

希望这可以帮助！

# php - 从get_the_post_thumbnail($post->ID)中获取图片源；

> ID：14359382
> 
> 赞同：6
> 
> 时间：2013-01-16T13:17:12.227
> 
> 标签：php, html, wordpress

我必须从下面的代码中获取图像源。

```
 $thumburl = get_the_post_thumbnail($post->ID); 
```

我来了

```
<img width="325" height="202" src="http://localhost/TantraProjects/Border-fall/Repo/WebApp/wp-content/uploads/2012/12/film.png" class="attachment-post-thumbnail wp-post-image" alt="film" title="film"> 
```

我想得到这部分。

```
"http://localhost/TantraProjects/Border-fall/Repo/WebApp/wp-content/uploads/2012/12/film.png" 
```

我怎样才能得到源？

* * *

## 回答 #1

> 赞同：25
> 
> 时间：2013-01-16T13:34:09.913

```
$post_thumbnail_id = get_post_thumbnail_id($post->ID);
$post_thumbnail_url = wp_get_attachment_url( $post_thumbnail_id ); 
```

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2017-05-21T23:07:18.560

这就是你想要的，更简洁：

```
get_the_post_thumbnail_url($post->ID, $size); 
```

[https://developer.wordpress.org/reference/functions/get_the_post_thumbnail_url/](https://developer.wordpress.org/reference/functions/get_the_post_thumbnail_url/)

您可以获得任何缩略图大小的 url，因此它是一个非常有用的功能。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2014-05-30T11:11:42.947

那里先生，

```
$post_thumbnail_url = wp_get_attachment_thumb_url($post->ID); 
```

# jquery - 将数组重置为空数组不起作用

> ID：14359384
> 
> 赞同：4
> 
> 时间：2013-01-16T13:17:20.750
> 
> 标签：jquery, arrays, key, keyevent

我究竟做错了什么？调用函数后似乎没有清除数组。

如果您先按`ctrl+c`然后`ctrl+alt+c`第二个功能将不会调用（仅当您按第二次时）。

```
var key = function (keys, fn) {
  var arr = [];
  $(document).on({
    keydown: function (e) {
      arr.push(e.which);
      if (arr.join(', ') === keys) {
        fn(e);
        arr = [];
      }
    },
    keyup: function (e) {
      arr = [];
    }
  });
};

// ctrl + c
key('17, 67', function (e) {
  alert('ctrl+c');
});

// ctrl + alt + c
key('17, 18, 67', function () {
  alert('ctrl+alt+c');
}); 
```

这是一个**[小提琴](http://jsfiddle.net/ARTsinn/WucCQ/0)**。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:32:55.843

**编辑：**这段代码不像出现的那样好。它不会看到和之间的`Ctrl+C`区别`Cltrl+C+V`！

试试这个代码：

```
var key = function (keys, fn) {  
  $(document).on({
    keydown: function (e) {
      var arr = [];
      if(e.ctrlKey)
        arr.push("17");
      if(e.altKey)
        arr.push("18");
      arr.push(e.which);
      if (arr.join(', ') === keys) {
        fn(e);        
      }
    }
  });
};

// ctrl + c
key('17, 67', function (e) {
  alert('ctrl+c');
});

// ctrl + alt + d
key('17, 18, 68', function () {
  alert('ctrl+alt+c');
}); 
```

您可以在 keydown 事件发生时检查它是否被按下，而不是将按下的键收集到全局数组中。这对我来说很好：http: [//fiddle.jshell.net/27WGw/2/](http://fiddle.jshell.net/27WGw/2/) （**请注意**，我将 Ctrl+Alt+c 更改为 Ctrl+Alt+d，因为第一个是我机器上的全局热键）

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T13:38:16.280

您的代码中的问题不是数组。

未调用您的 keyup，因为您在看到警报窗口时释放了该键

检查在此处工作的相同代码：http: [//jsfiddle.net/WucCQ/1/](http://jsfiddle.net/WucCQ/1/) - 观看控制台日志

```
var key = function (keys, fn) {
  var arr = [];
  $(document).on({
    keydown: function (e) {
      arr.push(e.which);
      if (arr.join(', ') === keys) {
        fn(e);
        arr = [];
      }
    },
    keyup: function (e) {
      arr = [];
    }
  });
};

// ctrl + c
key('17, 67', function (e) {
  console.log('ctrl+c');
});

// ctrl + alt + c
key('17, 18, 67', function () {
  console.log('ctrl+alt+c');
}); 
```

# javascript - Javascript弹出窗口焦点

> ID：14359387
> 
> 赞同：0
> 
> 时间：2013-01-16T13:17:33.790
> 
> 标签：javascript, popup, focus

如果生成弹出窗口的浏览器最小化，有没有办法将 javascript 弹出窗口带到所有应用程序的前面？试过：

```
newwindow=window.open('sessionExpiresSoon.html','SessionExpires','height=200,width=150');

newwindow.focus(); 
```

但这仅关注打开浏览器或在其他选项卡中浏览等情况。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:23:47.907

新标签（无论是否弹出）是浏览器的一部分。如果您的程序（命名浏览器）在您的操作系统中处于非活动状态，您可以使其闪烁为最大。

# iphone - 具有玻璃效果的 UIView

> ID：14359390
> 
> 赞同：3
> 
> 时间：2013-01-16T13:17:44.967
> 
> 标签：iphone, ios5, quartz-core

我想创建一个应该具有玻璃效果的视图。它应该看起来也很闪亮。在那我想添加一个应该看起来透明的 UITextView 。我是 iPhone 新手，不知道如何做到这一点。我不想添加图像。想以编程方式进行。视图应该看起来像一个移动屏幕。

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:36:50.850

如果您不想使用图像，则必须做一些事情。

1.  添加一个`UIView`使用此代码。并为其设置渐变背景颜色。这会给你像闪亮的玻璃一样的效果。

这是代码：

```
.h file :

UIColor                                         *pinkDarkOp;
UIColor                                         *pinkLightOp;
CAGradientLayer                                 *gradient;

.m file :

img_TopBarView = [[UIView alloc]initWithFrame:CGRectMake(0.0,0.0,1024.0,50.0)];
img_TopBarView.userInteractionEnabled = YES;
pinkDarkOp = [UIColor colorWithRed:15.0f/255.0 green:138.0f/255.0 blue:216.0f/255.0 alpha:1.0];
pinkLightOp = [UIColor colorWithRed:12.0f/255.0 green:91.0f/255.0 blue:183.0f/255.0 alpha:1.0];
gradient = [CAGradientLayer layer];
gradient.frame = [[img_TopBarView layer] bounds];
gradient.colors = [NSArray arrayWithObjects:(id)pinkDarkOp.CGColor,(id)pinkLightOp.CGColor,nil];
gradient.locations = [NSArray arrayWithObjects:[NSNumber numberWithFloat:0.0f],[NSNumber numberWithFloat:0.7],nil];
[[img_TopBarView layer] insertSublayer:gradient atIndex:0];
[self.view addSubview:img_TopBarView];
[img_TopBarView release]; 
```

您必须根据需要采用 pinkDarkOp 和 pinkLightOp 的值。您可以在谷歌的任何地方获取此颜色代码。

例如： http: [//gradients.glrzad.com](http://gradients.glrzad.com)

1.  对于创建透明`UITextView`，您可以使用`UITextView`.

我希望这有帮助。

# regex - 清理编号列表的正则表达式

> ID：14359391
> 
> 赞同：7
> 
> 时间：2013-01-16T13:17:48.623
> 
> 标签：regex

我才刚刚开始使用正则表达式，似乎有点卡住了！我在 TextSoap 中使用多行编写了批量查找和替换。这是为了清理我 OCR 的食谱，因为有**成分和方向，**我不能将“1”更改为“1.”，因为这可能会将“1 Tbsp”重写为“1\. Tbsp”。

因此，我使用此代码作为查找来检查以下两行（可能带有额外的行）是否是下一个序列号：

```
^(1) (.*)\n?((\n))(^2 (.*)\n?(\n)^3 (.*)\n?(\n))
^(2) (.*)\n?((\n))(^3 (.*)\n?(\n)^4 (.*)\n?(\n))
^(3) (.*)\n?((\n))(^4 (.*)\n?(\n)^5 (.*)\n?(\n))
^(4) (.*)\n?((\n))(^5 (.*)\n?(\n)^6 (.*)\n?(\n))
^(5) (.*)\n?((\n))(^6 (.*)\n?(\n)^7 (.*)\n?(\n)) 
```

以及以下内容作为上述各项的替换：

```
$1\. $2 $3 $4$5 
```

我的问题是，虽然它可以按我的意愿工作，但它永远不会执行最后三个数字的任务......

我要清理的文本示例：

```
1 This is the first step in the list

2 Second lot if instructions to run through
3 Doing more of the recipe instruction

4 Half way through cooking up a storm

5 almost finished the recipe

6 Serve and eat 
```

我希望它看起来像什么：

```
1\. This is the first step in the list

2\. Second lot if instructions to run through

3\. Doing more of the recipe instruction

4\. Half way through cooking up a storm

5\. almost finished the recipe

6\. Serve and eat 
```

有没有办法检查上面的前一行或两行以向后运行？我已经向前看和向后看，那时我有些困惑。有人有办法清理我的编号列表或帮助我使用我想要的正则表达式吗？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T16:09:40.423

dan1111 是对的。您可能会遇到外观相似的数据的麻烦。但是鉴于您提供的示例，这应该可以工作：

```
^(\d+)\s+([^\r\n]+)(?:[\r\n]*) // search

$1\. $2\r\n\r\n                 // replace 
```

如果您不使用 Windows，请`\r`从替换字符串中删除 s。

解释：

```
^           // beginning of the line
(\d+)       // capture group 1\. one or more digits
\s+         // any spaces after the digit. don't capture
([^\r\n]+)  // capture group 2\. all characters up to any EOL
(?:[\r\n]*) // consume additional EOL, but do not capture 
```

代替：

```
$1\.       // group 1 (the digit), then period and a space
$2        // group 2
\r\n\r\n  // two EOLs, to create a blank line
          // (remove both \r for Linux) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:28:13.193

那这个呢？

```
1 Tbsp salt
2 Tsp sugar
3 Eggs 
```

您遇到了正则表达式的一个主要限制：当您的数据无法严格定义时，它们就无法正常工作。你可能直观地知道什么是成分，什么是步骤，但要从这些到一套可靠的算法规则并不容易。

我建议您考虑一种基于文件中位置的方法。给定的食谱通常对所有食谱的格式都相同：例如，首先是配料，然后是步骤列表。这可能是一种更容易区分的方法。

# java - Android Activity：如何使用构造函数初始化变量？我需要putExtra吗？

> ID：14359406
> 
> 赞同：0
> 
> 时间：2013-01-16T13:18:46.393
> 
> 标签：java, android, android-activity

我有

```
public abstract class SuperClassA extends Activity
{
   protected String s;

   public SuperClassA(String s)
   { this.s = s }

   ...etc...
} 
```

现在我做

```
 startActivity(new Intent(this, SubClassA.class)); 
```

有没有办法在使用构造函数时调用活动？否则字段 s 不会被初始化。或者我真的必须用 putExtra 做这个吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:28:46.973

每个非抽象活动都必须有一个不带参数的公共默认构造函数。系统尝试调用这个构造函数来创建一个新的活动。在您的情况下，找不到此构造函数，您（应该）收到异常。

对于 Service、BroadcastReceiver、Fragments 等也是如此……

所以是的，您需要使用参数 Bundle 来传递 String 参数。

# c#-4.0 - 在C#中提取字符串中的小数部分

> ID：14359407
> 
> 赞同：0
> 
> 时间：2013-01-16T13:18:57.017
> 
> 标签：c#-4.0

我有一个字符串，其中数据以这种格式加载。“float;#123456.0300000” 我只需要从中提取 123456.03 并修剪所有其他开始和结束字符。可能是我缺少的非常基本的东西，请让我知道我该怎么做。谢谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:26:12.267

如果格式后面*总是* `float;#`跟着你想要的位，那么它相当简单：

```
// TODO: Validate that it actually starts with "float;#". What do you want
// to do if it doesn't?
string userText = originalText.Substring("float;#".Length);
// We wouldn't want to trim "300" to "3"
if (userText.Contains("."))
{
    userText = userText.TrimEnd('0');
    // Trim "123.000" to "123" instead of "123."
    if (userText.EndsWith("."))
    {
        userText = userText.Substring(0, userText.Length - 1);
    }
} 
```

但是你真的需要对格式有信心——不会有任何其他需要删除的东西，等等。

尤其：

*   您希望支持的最大小数位数是多少？
*   可能有数千个分隔符？
*   小数分隔符总是一个句点吗？
*   值可以为负吗？
*   显式前导`+`有效吗？
*   您需要处理科学格式（1.234e5 等）吗？
*   可能有尾随字符吗？
*   尾随字符可能包含数字吗？
*   您需要处理非 ASCII 数字吗？

如果您需要比上面的代码更复杂的东西，您可能很想使用正则表达式，但在进一步深入之前，您真的想尽可能多地了解可能的输入。（我强烈建议为你能想到的每一种输入形式编写单元测试。）

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:27:03.217

为什么不这样做：

```
String s = "float;#123456.0300000";
int i = int.Parse(s.Substring(s.IndexOf('#') + 1)); 
```

我还没有测试过这个，但它应该很接近。

假设格式没有改变，只需找到'#'之后的字符并将其转换为int，这样你就失去了'.'之后的所有内容。

如果您需要它作为字符串，则只需调用 ToString 方法。

# css - 标题中定义的背景图像命令不起作用

> ID：14359412
> 
> 赞同：0
> 
> 时间：2013-01-16T13:19:07.720
> 
> 标签：css

我一直在摸索为什么背景图像功能对我不起作用。有什么建议么？是的，我已经知道我是一个有严重注意力问题的笨蛋..

```
<head> 
<style type="text/css"> 

<!-- As you can see below, i tried to include a header image in 3 different ways -->

header {height:200px; background-url:(http://i.imgur.com/HtAvI.jpg) ; }
#header-wrapper { width:660px; margin:0 auto 10px; border:1px solid $bordercolor; background:url(http://i.imgur.com/HtAvI.jpg) no-repeat; height:400px; }
#header{background image: url(http://i.imgur.com/HtAvI.jpg);}

<!-- i tried including it in the body as well, to no avail -->
body { background image: url(http://i.imgur.com/HtAvI.jpg) ; }
p {color: red}

</style>
</head>
<body>

<p>this is text</p>

</body>" 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:22:14.490

更改`background image:`为`background-image:`。也没有像`background-url`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:22:46.200

没有`background-url`。没有`background<space>image`。有`background-image`，有`background`。

解决这些问题后，图像应正确显示。

# c# - 我们可以在 C# 中对 ApplicationInstaller 进行单元测试吗？

> ID：14359413
> 
> 赞同：1
> 
> 时间：2013-01-16T13:19:08.477
> 
> 标签：c#, asp.net-mvc-3, nunit

好吧，我正在做单元测试。现在我是单元测试的新手。我正在使用带有 mvc3 框架的 nunit 和 rhino mock。我应该对 ApplicationInstaller.cs 进行单元测试吗？请向我推荐一些用于 nunit 测试的推荐读物。

```
public void Install(Castle.Windsor.IWindsorContainer container, Castle.MicroKernel.SubSystems.Configuration.IConfigurationStore store)
{
    container.Register(
        AllTypes.FromAssemblyContaining<IEmployeeModelAssembler>()
        .Where(x => x.Name.EndsWith("Assembler"))
        .WithService.DefaultInterfaces());

    container.AddFacility<LoggingFacility>(x => x.LogUsing(LoggerImplementation.Log4net).WithConfig("log4net.config"));

    container.Register(
        // All controllers
        AllTypes.FromAssembly(Assembly.GetExecutingAssembly()).BasedOn<IController>().LifestyleTransient(),
        //
        Component.For<IControllerFactory>().ImplementedBy<IoCControllerFactory>(),
        Component.For<ICookieManager>().ImplementedBy<CookieManager>().LifeStyle.Is(LifestyleType.Transient),
        Component.For<IJsonSerializer>().ImplementedBy<JsonSerializer>(),
        Component.For<ILoanActionsUtility>().ImplementedBy<LoanActionsUtility>(),
        // Default D.I. container
        Component.For<IWindsorContainer>().Instance(container));

    // Register AES web services
    container.Install(new AESServicesBootstrapper.ApplicationInstaller());

}

#endregion

/// <summary>
/// Creates a WCF client for web services passing the token of the authenticated user from the cookie.
/// This method only creates the client / channel, it does not configure the connection settings,
/// those have to be defined by named endpoints on the web.config
/// </summary>
/// <typeparam name="T"></typeparam>
/// <param name="endPointConfiguration">name of the endpoint on the web.config</param>
/// <returns></returns> 
```

}

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T15:27:24.687

以我的经验，测试上面的代码没有多大价值。它基本上是没有任何决策的配置，因此您的测试只能确保应用程序按照您想要的方式进行配置。这基本上是上面代码的重复。

如果您的安装程序中发生了逻辑，那么您可能希望围绕它进行一些测试。如果事情开始因大量逻辑而失控，那么您正在研究将该代码删除到另一个类中并且甚至不将其包含在您的安装程序代码中的领域。

对于这些类型的问题，您可能对[程序员有一些运气。](https://softwareengineering.stackexchange.com/questions/66480/when-is-it-appropriate-to-not-unit-test)

# php - 用php获取文件时间戳出错

> ID：14359419
> 
> 赞同：-1
> 
> 时间：2013-01-16T13:19:34.443
> 
> 标签：php, timestamp, filemtime

我有以下代码：

```
public static function getLogFiles()
{
    $dir    = '../tmp/logs';
    $files = scandir($dir);

    foreach ($files as $filename){
        echo "$filename wurde zuletzt modifiziert:: " . date ("F d Y H:i:s.", filemtime($filename)) . "<br>";
    }

    die();
} 
```

对于我使用的调试

```
print_r($files); 
```

并得到一个包含所有文件的数组。但我只得到前两个修改日期：

```
 . wurde zuletzt modifiziert:: January 14 2013 09:06:05\. 

.. wurde zuletzt modifiziert:: December 14 2012 10:46:34.

Warning (2): filemtime(): stat failed for Fleetster.log [APP\Lib\Log4All.php, line 134]

system.log wurde zuletzt modifiziert:: January 01 1970 01:00:00.

Warning (2): filemtime() [function.filemtime]: stat failed for debug.log [APP\Lib\Log4All.php, line 134]

debug.log wurde zuletzt modifiziert:: January 01 1970 01:00:00.

Warning (2): filemtime() [function.filemtime]: stat failed for error.log [APP\Lib\Log4All.php, line 134]

error.log wurde zuletzt modifiziert:: January 01 1970 01:00:00. 
```

怎么了？

感谢你并致以真诚的问候

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:24:21.960

如果您的文件太大`stat()`（它使用该功能），您会得到这个。手册页上的评论说；

> 如果 PHP 的整数类型在您的系统上只有 32 位，filemtime() 将在超过 2GB 的文件上失败，并显示警告“stat failed”。所有与 stat() 相关的命令都将表现出相同的行为。

`stat()`根据您的情况，可能有不同的理由这样说。

# php - yii中如何构造常量

> ID：14359421
> 
> 赞同：1
> 
> 时间：2013-01-16T13:19:37.303
> 
> 标签：php, constants

我将 Yii 用于我的 Web 应用程序。在此我将常量类保留在模型中并扩展

从`CUserIdentity`喜欢..

```
class Constants extends CUserIdentity
{
 CONST ACCOUTN_ONE = 1;
 CONST ACCOUTN_TWO = 2;
 CONST ACCOUTN_THREE = 3;
} 
```

在这里我可以访问常量`Constants::ACCOUTN_ONE`，它会返回正确的结果`1`

但是当我开始动态构造常量时意味着..

```
$type = 'ONE';
$con = "Constants::ACCOUTN_".$type;
echo $con; 
```

它将显示为 Constants::ACCOUTN_ONE;

我在这里期待`1`

如有错误请指正。。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:24:23.203

```
$type = 'ONE';
$con = "Constants::ACCOUTN_".$type;
echo Constant($con); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:21:57.357

```
$type = 'ONE'; // You created string

$con = "Constants::ACCOUTN_".$type; // Created other string

echo $con; // Printed it 
```

您只是打印了字符串而不对其进行评估。
是的，当然它会显示为 Constants::ACCOUTN_ONE;

您需要使用`eval()`(bad) 评估您的代码，或使用此方案：

`echo Constant($con);`

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-16T13:51:57.387

不久前，我用一堂课来做这件事：

```
/**
 * Lots of pixie dust and other magic stuff.
 *
 * Set a global: Globals::key($vlaue); @return void
 * Get a global: Globals::key(); @return mixed|null
 * Isset of a global: Globals::isset($key); @return bool
 *
 * Debug to print out all the global that are set so far: Globals::debug(); @return array
 *
*/
class Globals
{

    private static $_propertyArray = array();

    /**
     * Pixie dust
     *
     * @param $method
     * @param $args
     * @return mixed|bool|null
     * @throws MaxImmoException
     */
    public static function __callStatic($method, $args)
    {
        if ($method == 'isset') {
            return isset(self::$_propertyArray[$args[0]]);
        } elseif ($method == 'debug') {
            return self::$_propertyArray;
        }

        if (empty($args)) {
            //getter
            if (isset(self::$_propertyArray[$method])) {
                return self::$_propertyArray[$method];
            } else {
                return null; //dont wonna trow errors when faking isset()
            }
        } elseif (count($args) == 1) {
            //setter
            self::$_propertyArray[$method] = $args[0];
        } else {
            throw new Exception("Too many arguments for property ({$method}).", 0);
        }

    }
} 
```

# grails - Grails 和发布插件

> ID：14359422
> 
> 赞同：2
> 
> 时间：2013-01-16T13:19:37.910
> 
> 标签：grails, release

我正在尝试使用发布 2.0.4 插件通过 grails 2.1.1 将我的战争部署到工件服务器。

我的 BuildConfig.groovy 有：

```
grails.project.repos.snap.url = "http://server:8080/artifactory/apps-snapshot-local"
grails.project.repos.snap.username = "user"
grails.project.repos.snap.password = "password"

grails.project.repos.rel.url = "http://server:8080/artifactory/apps-release-local"
grails.project.repos.rel.username = "user"
grails.project.repos.rel.password = "password"

grails.project.repos.default = "rel" 
```

当我只是执行“grails maven-deploy”时，它可以正常工作并按预期部署到我的 rel 服务器。当我尝试通过命令行覆盖默认目标时，我遇到了失败。

```
grails maven-deploy --repository=snap 
```

我明白了：

```
| Done creating WAR snap
| POM generated: C:\dev-git\DBUpdateWeb\target/pom.xml.
| Error Error deploying artifact: C:\dev-git\DBUpdateWeb\target\DBUpdateWeb.war (The system cannot find the file specified)
| Error Have you specified a configured repository to deploy to (--repository argument) or specified distributionManagement in your POM? 
```

当我指定 --repository 标签时，它不会产生战争，即使它说它确实如此。任何帮助表示赞赏。提前致谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-02-06T09:24:18.683

试试 grails maven-deploy "--repository=snap"。

此外，在 application.properties 中指定 app.version 以使 WAR 符合标准（1.0-SNAPSHOT 用于发布到快照存储库，1.0 用于发布），并注释掉 BuildConfig.groovy 中的 grails.project.war.file 行.

# java - 如何将泛型类型绑定到在层次结构中几乎完全分离的 2 种类型

> ID：14359424
> 
> 赞同：1
> 
> 时间：2013-01-16T13:19:42.173
> 
> 标签：java, class, generics, types, hierarchy

我该怎么做呢？因为你只能扩展一个类，所以它只能有一个上限。

就我而言，我需要将泛型类型限制在 String 和 int 中。如果我使用 Integer 包装器而不是 int 并依赖自动装箱，我可以做到，但问题是其他类也可以作为类型参数传递。

最好的方法是什么？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:36:48.710

您可以使用集合的非通用变体（例如 List），或者更明确`List<Object>`地显示代码的意图。
将其包装在 MyList 类中，并为您要支持的每种类型创建 add()、get() 方法：

```
add(Integer elem);
add(String elem); 
```

但是 Object get() 不能被输入，所以它是有意义的。

所以最后你也可以将 Object 与 List 一起使用，并省略包装器。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:37:19.407

我不认为你能做到。String 也是一个最终类和所有这些东西。正如@NimChimpsky 所说，使用 Object 本身可能会更好。另一个解决方案是两个类的包装器，但是您仍然会得到一个结果对象，您可能需要对其进行转换并依赖它`instanceof`：

```
class StringInt {
  private String string;
  private Integer integer;

  public StringInt(String s) { this.string = s; }
  public StringInt(Integer i) { this.integer = i; }

  public Object getValue() { return string != null ? string : integer; }
} 
```

或者使用丑陋的验证，显然，这只会在运行时应用......

```
class StringIntGen<T> {
  private T t;

  public StringIntGen(T t) { 
    if (!(t instanceof String) && !(t instanceof Integer)) 
      throw new IllegalArgumentException(
          "StringIntGen can only be Integer or String");
    this.t = t; 
  }

  public T getValue() { return t; }

} 
```

# geometry - 绘制球体 - 顶点顺序

> ID：14359425
> 
> 赞同：2
> 
> 时间：2013-01-16T13:19:49.847
> 
> 标签：geometry, opengl-es-2.0

我想在没有任何引擎的纯 OpenGL ES 2.0 中绘制球体。我写下一个代码：

```
 int GenerateSphere (int Slices, float radius, GLfloat **vertices, GLfloat **colors) {
 srand(time(NULL));
 int i=0, j = 0;
 int Parallels = Slices ;
 float tempColor = 0.0f;    
 int VerticesCount = ( Parallels + 1 ) * ( Slices + 1 );
 float angleStep = (2.0f * M_PI) / ((float) Slices);

 // Allocate memory for buffers
 if ( vertices != NULL ) {
    *vertices = malloc ( sizeof(GLfloat) * 3 * VerticesCount );
 }
 if ( colors != NULL) {
    *colors = malloc( sizeof(GLfloat) * 4 * VerticesCount);
 }

 for ( i = 0; i < Parallels+1; i++ ) {
     for ( j = 0; j < Slices+1 ; j++ ) {

         int vertex = ( i * (Slices + 1) + j ) * 3;

         (*vertices)[vertex + 0] = radius * sinf ( angleStep * (float)i ) *
                    sinf ( angleStep * (float)j );
         (*vertices)[vertex + 1] = radius * cosf ( angleStep * (float)i );
         (*vertices)[vertex + 2] = radius * sinf ( angleStep * (float)i ) *
                        cosf ( angleStep * (float)j );
         if ( colors ) {
                int colorIndex = ( i * (Slices + 1) + j ) * 4;
                tempColor = (float)(rand()%100)/100.0f;

                (*colors)[colorIndex + 0] =  0.0f;
                (*colors)[colorIndex + 1] =  0.0f;
                (*colors)[colorIndex + 2] =  0.0f;
                (*colors)[colorIndex + (rand()%4)] = tempColor;
                (*colors)[colorIndex + 3] =  1.0f;
            }
        }
    }
    return VerticesCount;
} 
```

我正在使用下一个代码绘制它：

```
glDrawArrays(GL_TRIANGLE_STRIP, 0, userData->numVertices); 
```

其中 userData->numVertices - 来自函数 GenerateSphere 的 VerticesCount。但是在屏幕上绘制系列三角形，这些不是球体近似！我认为，我需要计算顶点并使用 OpenGL ES 2.0 函数 glDrawElements() （带有数组，包含数字顶点）。但在屏幕上绘制的一系列三角形并不是近似球体。如何绘制球体近似？如何指定顺序顶点（OpenGL ES 2.0 术语中的索引）？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-20T14:59:45.947

在开始使用 OpenGL ES 之前，这里有一些建议：

> 避免臃肿的 CPU/GPU 性能

通过使用另一个程序离线渲染形状来消除密集的计算周期肯定会有所帮助。除了导出包含形状等的点 [x,y,z] 的结果集合之外，这些程序将提供有关形状/网格的其他详细信息。

我经历了所有这些痛苦，因为我一直在尝试搜索算法来渲染球体等，然后尝试优化它们。我只是想在将来节省您的时间。只需使用 Blender，然后您最喜欢的编程语言来解析从 Blender 导出的 obj 文件，我使用 Perl。以下是渲染球体的步骤：（使用 glDrawElements 因为 obj 文件包含索引数组）

```
1) Download and install Blender. 
```

![图像-1](../Images/f187a8701d8aebaf227784b496080f3e.png)

```
2) From the menu, add sphere and then reduce the number of rings and segments. 
```

![图像-2](../Images/1d1fd59481363c33c51192bc90af4da8.png)

```
3) Select the entire shape and triangulate it. 
```

![图像-3](../Images/7f2bc955c4a6cdb58799c9417b6a7cf9.png)

```
4) Export an obj file and parse it for the meshes. 
```

![图像 4](../Images/978e7404f96f78a34becd92abc48c99d.png)

您应该能够从以下文件中掌握渲染球体的逻辑：http: [//pastebin.com/4esQdVPP](http://pastebin.com/4esQdVPP)。它适用于 Android，但概念是相同的。希望这可以帮助。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2014-01-04T19:42:47.693

我在球体和其他几何形状上苦苦挣扎。我研究了一段时间，并创建了一个 Objective-C 类来使用索引和非索引机制创建坐标、法线和纹理坐标，该类在这里：

[http://www.whynotsometime.com/Why_Not_Sometime/Code_Snippets.html](http://www.whynotsometime.com/Why_Not_Sometime/Code_Snippets.html)

有趣的是看到生成的表示几何的三角形是降低分辨率（在生成坐标之前设置分辨率属性）。此外，您可以使用 GL_LINE_STRIP 而不是 GL_TRIANGLES 来查看更多信息。

我同意 wimp 的评论，即由于计算坐标通常只发生一次，因此使用的 CPU 周期并不多。此外，有时人们确实只想画一个球或世界或......

# objective-c - NSPredicate 无法解析格式字符串

> ID：14359427
> 
> 赞同：0
> 
> 时间：2013-01-16T13:19:51.117
> 
> 标签：objective-c, nspredicate

我对 NSPredicate 解析有疑问

```
NSMutableArray *array =[[NSMutableArray alloc] initWithCapacity:3];
[array addObject:[NSPredicate predicateWithFormat:@"NONE = 1"]] 
```

错误是`Unable to parse the format string "NONE = 1"`

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:29:18.970

`NONE`是谓词中的关键字，意思是“这些都不应该是真的”。你可以这样想：`NONE(=1)`where`=1`不是一个有效的表达式。这就是它无法解析的原因。

您将使用`NONE`关键字来表示某些集合属性中的任何值都不应该评估为真。例如：`NONE someArrayProperty = 1`将查看 someArrayProperty 的所有值并检查它们是否等于 1。

* * *

从[文档中](https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/Predicates/Articles/pSyntax.html)：

> **`NONE`**
> 不指定以下表达式中的任何元素。例如，`NONE children.age < 18`。这在逻辑上等价于`NOT (ANY ...)`。

# ms-access - 如何附加具有强制参照完整性的记录？

> ID：14359429
> 
> 赞同：2
> 
> 时间：2013-01-16T13:19:58.350
> 
> 标签：ms-access, foreign-keys, relationship

我有一个用于提取数据的 OCDB 表。我目前使用它将数据附加到新表中，然后对其进行操作。问题是我刚刚向该表添加了一个关系，当我使用强制引用完整性时，查询将不会运行。

如何让附加查询自动更新外键？

# php - php类中的递归函数

> ID：14359431
> 
> 赞同：2
> 
> 时间：2013-01-16T13:20:03.257
> 
> 标签：php, recursion

我想在类中创建一个函数来创建用户名，函数将检查用户名是否存在，然后它将增加用户名，如 username_1。并检查此用户名是否存在，如果存在，则再次将其增加到 username_2 直到创建新用户名。我已经创建了这个函数，但它什么也没给我。请帮我看看我的代码有什么问题。

```
class a{

function check_username($username){

  if($usernameexist){

    return true;
  }
  else
  {

   return false;

  }

}

function create_username($username) {

        $__name = __FUNCTION__;

        if ($this->check_username($username)) {                
            $n++;
            $username = $username . "_" . $n;
            //return $__name($username);  this return fatal error.
            return call_user_func('create_username', $username);

        } else {
            return $username;               
        }
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:30:14.943

不需要为此使用递归，一个简单的`while(){}`循环就可以了：

### Plain-Jane Interator 方法

```
// your original function
function create_username($username){
  // check if the username (as-is) already exists
  if ($this->check_username($username)){
    // use $n to keep a counter
    $n = 1;
    // while {username}_{n} exists, keep incrementing the counter
    while ($this->check_username($username.'_'.$n)){
      $n++;

      /* If you don't want this to check to infinity, uncomment
       * the below portion. the 100 is an arbitrary number, but use
       * whatever you want as a limitation (could even make it a
       * parameter in the method). Also, returning FALSE allows you to
       * gracefully catch when max attempts are reached.
       *
       * e.g.
       *   if (($new_user = $obj->create_username('BradChristie')) !== FALSE){
       *     // user was successfully created within the max allowed attempts
       *   }
       */
      //if ($n > 100) return FALSE
    }
    // return the result
    return $username.'_'.$n;
  }
  // username was fine, return it back
  return $username;
} 
```

### 递归方法

```
// recursive username check
public function create_username($username, $n = 0)
{
  /* Same as above function, this is a check to prevent counting
   * to infinity. uncomment to apply it
   */
  //if ($n > 100) return FALSE;

  // establish the username we're testing. if $n is 0,
  // it's the original call to the function (don't add _0)
  // if it's >0, it's part of the search so include it
  $_username = $username . ($n > 0 ? '_'.$n : '');

  // check if the username exists.
  if ($this->check_username($_username))
  {
    // it exists, so make a call to this same function passing
    // the original username and the value of n + 1 (move to next
    // possibility)
    return $this->create_username($username, $n+1);
  }

  // the name, as-is, was fine. return it
  return $_username;
} 
```

[例子](http://sandbox.onlinephpfunctions.com/code/7a357c323226b3c5b7eab3e5f23a9147f42400bc)

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:26:36.797

在这种情况下不需要递归......一个简单的循环就可以完美地完成：

```
function create_username($username) {

    $original_username = $username;
    $i=1;
    while(! $this->check_username($username) ) {
        $username = $original_username . '_' .$i++;
    }

    return $username;
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:35:20.283

您的代码在几个方面是错误的，正如在其他地方指出的那样，您想要的函数最好迭代编写。

您的代码的一些问题如下：

1.  `check_username`成功时，您正在执行递归检查。所以，如果你找不到原始`$username`文件，你永远不会修改它，所以永远不要检查修改后的值。
2.  您正在`create_username`通过附加`_n`（对于适当的`n`）来修改传递给的名称。由于您在递归调用中传递了修改后的名称，因此您实际上最终会`_n`在名称上包含多个部分。
3.  由于您没有限制递归调用，即使编写正确，您最终也会嵌套太深。

# python - wxPython 和 STC 边距 - 顶部和底部

> ID：14359432
> 
> 赞同：0
> 
> 时间：2013-01-16T13:20:07.133
> 
> 标签：python, wxpython, wxwidgets, scintilla

![在此处输入图像描述](../Images/3dbda5ef8d939a07beb501471d791b8e.png)

有没有办法在我的程序的顶部和底部为 3 和 4 实现填充？

或者有没有像添加 \n 等的解决方法......

我觉得行号和样式文本离顶部和底部太近了。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T18:48:22.377

使用嵌套在 sizer 内的相同颜色的面板作为一种肮脏的解决方法怎么样？

```
import wx
import wx.stc as stc

class MainWindow(wx.Frame):
    def __init__(self, *args, **kwargs):
        wx.Frame.__init__(self, *args, **kwargs)

        self.panel = wx.Panel(self)

        self.text = stc.StyledTextCtrl(self.panel)
        self.text.SetWindowStyle(self.text.GetWindowStyle() | wx.NO_BORDER)
        self.text.StyleSetSpec(stc.STC_STYLE_DEFAULT, "size:15,face:Courier New")
        self.text.SetWrapMode(stc.STC_WRAP_WORD)
        self.text.SetMarginLeft(50)
        self.text.StyleSetSpec(stc.STC_STYLE_LINENUMBER, "back:#FFFFFF")

        self.menu = wx.Menu()
        self.menu.Append(wx.ID_ABOUT, "&About", "Information about this program")
        self.menu_bar = wx.MenuBar()
        self.menu_bar.Append(self.menu, "&File")
        self.SetMenuBar(self.menu_bar)

        self.panel_top = wx.Panel(self.panel, size = (20, -1))
        self.panel_top.SetBackgroundColour(wx.WHITE)
        self.panel_bottom = wx.Panel(self.panel, size = (20, -1))
        self.panel_bottom.SetBackgroundColour(wx.WHITE)

        self.sizer = wx.BoxSizer(wx.VERTICAL)
        self.sizer.Add(self.panel_top, 0, wx.ALL | wx.EXPAND)
        self.sizer.Add(self.text, 1, wx.ALL | wx.EXPAND)
        self.sizer.Add(self.panel_bottom, 0, wx.ALL | wx.EXPAND)

        self.border = wx.BoxSizer()
        self.border.Add(self.sizer, 1, wx.ALL | wx.EXPAND, border=20)

        self.panel.SetSizerAndFit(self.border)

        self.text.Bind(stc.EVT_STC_CHANGE, self.OnChange)
        self.Show()

        self.text.SetText("Line!\n"*3)

    def OnChange(self, e):
        lines = self.text.GetLineCount()
        width = self.text.TextWidth(stc.STC_STYLE_LINENUMBER, str(lines)+" ")
        self.text.SetMarginWidth(0, width)

if __name__ == "__main__":
    app = wx.App(False)
    win = MainWindow(None)
    app.MainLoop() 
```

对于您的代码，将其修改如下：

```
 self.panel_top = wx.Panel(self.panel, size = (20, -1))
  self.panel_top.SetBackgroundColour(wx.BLACK)
  self.panel_bottom = wx.Panel(self.panel, size = (20, -1))
  self.panel_bottom.SetBackgroundColour(wx.BLACK)

  #### Add the STC to a Sizer. ####
  sizer = wx.BoxSizer(wx.VERTICAL)
  sizer.Add(self.panel_top, 0, wx.EXPAND,border=20)
  sizer.Add(self.text, 1, wx.EXPAND,border=20)
  sizer.Add(self.panel_bottom, 0, wx.EXPAND,border=20)
  self.panel.SetSizer(sizer) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T18:35:39.427

不，我不认为 Scintilla 具有控制顶部和底部边距大小的属性。

# facebook - Facebook FQL Location_Post 显示作者姓名

> ID：14359433
> 
> 赞同：0
> 
> 时间：2013-01-16T13:20:08.253
> 
> 标签：facebook, facebook-fql

我使用这个查询：

`SELECT id, author_uid, message, latitude, longitude, timestamp FROM location_post WHERE author_uid IN (SELECT uid2 FROM friend WHERE uid1=me()) ORDER BY timestamp DESC";`

我的问题是如何显示海报中的名称，因为没有 SELECT name FROM location_post。我希望有人能帮助我。

谢谢！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:43:35.063

获取 author_id 并发出新的 FQL 或图形 api 请求

假设 author_id 是 123。

问题解答：

```
SELECT name FROM user WHERE uid = 123 
```

图形 API

```
http://graph.facebook.com/123?fields=name 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:57:05.930

您需要将其作为[多](https://developers.facebook.com/docs/technical-guides/fql/#multi)查询执行：

```
{"locations":"SELECT id, author_uid, message, latitude,...",
 "authors":"SELECT name, id FROM profile WHERE id IN 
            (SELECT author_uid FROM #locations")} 
```

# vba - 关于 VBA 中特定单词的 @Scan Excel 列的 Worksheet_Change

> ID：14359439
> 
> 赞同：0
> 
> 时间：2013-01-16T13:20:16.570
> 
> 标签：vba, excel

我编译了以下代码：

```
Private Sub Worksheet_Change(ByVal Target As Range)
If Not Intersect(Target, Range("S3")) Is Nothing Then
    Select Case Range("S3")
        Case "Complete": Sample
        Case "In Progress": InProgress
    End Select
End If
End Sub 
```

此工作表更改的主要功能是从 cell 中读取`complete`或`in progress`从下拉列表中读取`S3`。我在一列中有一系列下拉列表，它们都需要执行 about 例程，但我很难选择特定列中的整个范围。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:32:47.513

您可以尝试这样做来选择 entier 列：

`Sheets(1).Range("S:S")`

然后是完整代码：

```
'-- you can find last used row of your column and used that as well
'-- Dim LastRow as Long 
'-- LastRow = Range("S3").Rows.Count
'-- If Not Intersect(Target, Range("S3").Resize(LastRow)) Is Nothing Then
Private Sub Worksheet_Change(ByVal Target As Range) 
  If Not Intersect(Target, Range("S:S")) Is Nothing Then
    '-- change to proper letter case as if the case don't match then case fails..
    Select Case StrConv(Target.Value, vbProperCase)
      Case "Complete": Sample
      Case "In Progress": InProgress '-- not sure if you need to remove the space
    End Select
  End If
End Sub 
```

# php - 在不加载 php 页面的情况下更新 mysql 表

> ID：14359441
> 
> 赞同：-3
> 
> 时间：2013-01-16T13:20:31.733
> 
> 标签：php, mysql, facebook, apache

我不知道这是否可能，但我需要它。我正在尝试使用基于永久链接的 facebook 评论更新评论表，但未加载 php 文件。我的意思是这项工作将在后端完成。

我不是在谈论ajax。该页面永远不会从某个文件加载或触发。它应该定期更新。

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:37:36.097

您可能需要编写一个服务页面（执行更新的页面），然后定期调用该页面（在 unix 上使用 cronjob 或在 Windows 上使用计划）。

您可以使用 PHP-cli 代替页面并使用命令行脚本调用它。

# gwt - 带有 Set 子集合的 GWT RequestFactory

> ID：14359442
> 
> 赞同：3
> 
> 时间：2013-01-16T13:20:31.963
> 
> 标签：requestfactory, gwt, open-session-in-view, , , gwt, requestfactory, open-session-in-view

我对 RequestFactory 有一点关于 Set 形状的子集合的持久性的问题。我在后端使用带有[requestfactory](/questions/tagged/requestfactory "显示标记为“requestfactory”的问题")和 Hibernate4/Spring3 的[gwt](/questions/tagged/gwt "显示标记为“gwt”的问题") 2.5 。我正在使用 Spring 的[open-session-in-view](/questions/tagged/open-session-in-view "显示标记为“open-session-in-view”的问题")过滤器，以便可以在我的 DAO 的 save 方法中的 findByID 之后保留集合。我的问题是，当子集合基于 List 时，一切似乎都可以正常工作，但是当它们基于 Set 时，并非所有来自客户端的项目都可以明显地到达服务器。

我的代码如下所示：

-根实体IndicationTemplate：

```
@Entity
@Table (name = "vdasIndicationTemplate")
@org.hibernate.annotations.Table ( appliesTo = "vdasIndicationTemplate", indexes = 
               {@Index (name = "xieIndicationTemplateCreateUser", columnNames= {"createUserID"}),
               @Index (name = "xieIndicationTemplateModifyUser", columnNames= {"modifyUserID"})})
public class IndicationTemplate extends AbstractEditable <Integer> implements IEntity <Integer>, IDateable, IDescriptable {
//...
   private Set <ProposalTemplate> proposalTemplates = null;
//...
   @OneToMany (fetch = FetchType.LAZY, mappedBy = "indicationTemplate"
         , cascade = {CascadeType.MERGE, CascadeType.PERSIST, CascadeType.REFRESH, CascadeType.DETACH})
   public Set <ProposalTemplate> getProposalTemplates () {
      return proposalTemplates;
   }
   public void setProposalTemplates (Set <ProposalTemplate> proposalTemplates) {
      this.proposalTemplates = proposalTemplates;
   }
//...
} 
```

- 子实体 ProposalTemplate 当然具有相反的 ManyToOne 映射，并且具有 3 个子集合以及具有 3 个不同实体的相同类别。

- 根实体的客户端代理：

```
@ProxyFor (value = IndicationTemplate.class, locator = PersistenceEntityLocator.class)
public interface IIndicationTemplateProxy extends IEntityProxy, IDeletableProxy, IDescriptableProxy {
//....
   Set <IProposalTemplateProxy> getProposalTemplates ();
   void setProposalTemplates (Set <IProposalTemplateProxy> proposalTemplateProxy);
} 
```

- 在客户端，我渲染根实体的属性以及子实体的列表。然后用户可以更新它们，并将更改存储回集合中，如下所示：

```
 Set <IProposalTemplateProxy> newList = getElementsFromUiSomehow (); //these elements can be new or just the old ones with some changes
   indicationTemplate.getProposalTemplates ().clear ();
   indicationTemplate.getProposalTemplates ().addAll (newList); 
```

- 然后在某个时候：

```
 requestContext.saveIndicationTemplate ((IIndicationTemplateProxy) entityProxy)
                                          .fire (new Receiver <IIndicationTemplateProxy> () 
```

-RequestContext 看起来像：

```
@Service (value = TemplateService.class, locator = SpringServiceLocator.class)
public interface ITemplateRequestContext extends RequestContext {
   /** saves (creates or updates) one given indication template */
   Request <IIndicationTemplateProxy> saveIndicationTemplate (IIndicationTemplateProxy indicationTemplate);
//....
} 
```

问题是每个请求仅向集合服务器端添加 1 个子实体。例如，indicationTemplate 有 2 个proposalTemplate，我又添加了 4 个，然后在服务器端 saveIndicationTemplate 实体只包含 3 个而不是 6 个。如果发生，无论我之前有多少实体，我添加了多少，我只会得到 1在服务器上比以前更多。我确实在触发 requestContext 方法之前检查了代理对象，并且它已完全加载，以及它的所有子对象。最后最奇怪的是，如果我替换 Set per List （以及所有后续更改），一切都很顺利！

使用Sets而不是Lists时RF无法将所有更改传输到服务器可能有什么问题吗？顺便说一句，在这种情况下，我确实更喜欢 Sets，所以这就是我要问的原因。

任何人？

感谢您的帮助！

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-05-27T15:34:21.803

我假设你遇到了这个错误。这是一个尚未修复的已知 gwt 错误。

[https://code.google.com/p/google-web-toolkit/issues/detail?id=6354&q=set&colspec=ID%20Type%20Status%20Owner%20Milestone%20Summary%20Stars](https://code.google.com/p/google-web-toolkit/issues/detail?id=6354&q=set&colspec=ID%20Type%20Status%20Owner%20Milestone%20Summary%20Stars)

尝试使用 list 而不是 set 应该没问题。

# jquery - 为什么不使用 ajax 从我的 html 文件中输入#content？

> ID：14359448
> 
> 赞同：0
> 
> 时间：2013-01-16T13:21:07.693
> 
> 标签：jquery

```
$('#thumbs li a').click(function(){
    var toLoad = $(this).attr('href')+' #content';
    $('#content').hide('fast',loadContent);
    $('#load').remove();
    $('#wrapper').append('<span id="load">LOADING...</span>');
    $('#load').fadeIn('normal');

    function loadContent() {
        $('#content').load(toLoad,'',showNewContent());
    }
    function showNewContent() {
        $('#content').show('normal',hideLoader());
    }
    function hideLoader() {
        $('#load').fadeOut('normal');
    }
    return false;
}); 
```

每个 a href 都链接到与 index.html 位于同一目录中的 html 文件。所以我不太确定为什么它没有从#content 中检索内容。我已确保所有 html 文件也具有相同的 ID。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:26:09.257

您正在调用`showNewContent()`and`hideLoader()`立即而不是将它们传递给`load()`and `show()`。

您应该删除括号以传递函数本身，而不是调用它们并传递它们返回的值：

```
function loadContent() {
    $('#content').load(toLoad, '', showNewContent);
}
function showNewContent() {
    $('#content').show('normal', hideLoader);
} 
```

# php - 获取 HTML 输出并通过 PHPExcel 将其插入 Excel 文档？

> ID：14359453
> 
> 赞同：0
> 
> 时间：2013-01-16T13:21:30.903
> 
> 标签：php, multidimensional-array, phpexcel

我已经从数据库中检索到所需的数据并通过浏览器将其输出以供 Web 使用，但现在我正尝试将其插入到 Excel 文档中并通过电子邮件发送。

我有文档的开头，并且可以将其作为附件通过电子邮件发送，这只是如何将 html 输出转换为我坚持的 excel 文档，因为我想不出最好的方法。

这就是我实现 HTML 输出的方式（对长度表示歉意）：

```
// print table
echo '<table>';
echo '<tr><th rowspan="2">Day</th>';

foreach($typesorder as $type) {
    if(in_array($type, $types)) {
        echo '<th colspan="3">' . $type . '</th>';  
    }
}

echo '<th colspan="3">Total Conversions</th>';
echo '</tr>';
echo '<tr>';

foreach($typesorder as $type) {
    if(in_array($type, $types)) {
        echo '<th>Week ' . $weekstart_A_data['week'] . ' ' . $weekstart_A_data['year'] . '</th>';  
        echo '<th>Week ' . $weekstart_B_data['week'] . ' ' . $weekstart_B_data['year'] . '</th>';  
        echo '<th>+/-</th>';  
     }
}

// Total Conversions section
echo '<th>Week ' . $weekstart_A_data['week'] . ' ' . $weekstart_A_data['year'] . '</th>';  
echo '<th>Week ' . $weekstart_B_data['week'] . ' ' . $weekstart_B_data['year'] . '</th>';  
echo '<th>+/-</th>';    

echo '</tr>';

foreach($dailytotals as $thedate => $data) {

    $daily_conversions = 0;
    $daily_conversionsB = 0;

    echo '<tr>';
    echo '<td>' . date('l', strtotime($thedate)) . '</td>';

    foreach($typesorder as $type) {

        if(in_array($type, $types)) {

                $conversions  = $data[$type];

                $total_conversions[$type]   += $conversions;
                $daily_conversions          += $conversions;

                $week_A_conversions = $conversions;
                $week_B_conversions = $dailytotalsB[$weekstartB][$type];

                $total_conversionsB[$type] += $dailytotalsB[$weekstartB][$type];

                $daily_conversionsB  += $week_B_conversions;

                $differential = $dailytotalsB[$weekstartB][$type] - $conversions;

                echo '<td>'. number_format($week_A_conversions) . '</td>';   
                echo '<td>'. number_format($week_B_conversions) . '</td>';   

                if($differential < 0 ) {
                    $class = "class='diffred'";
                } else if($differential >  0) {
                    $class = "class='diffblue'";
                } else {        
                    $class='';
                }   

                // differential between Week A and Week B
                echo '<td ' . $class . '>' . $differential . '</td>';  

        }

    }

    $weekstartB = date("Y-m-d", strtotime('+1 day', strtotime($weekstartB)));   

    $differentialtotal = $daily_conversionsB - $daily_conversions;

    echo '<td>' . number_format($daily_conversions) . '</td>';     
    echo '<td>' . number_format($daily_conversionsB) . '</td>';    

    if($differentialtotal < 0 ) {
        $class = "class='diffred'";
    } else if($differentialtotal >  0) {
        $class = "class='diffblue'";
    } else {        
        $class='';
    }

    echo '<td ' . $class . '>' . $differentialtotal . '</td>';    
    echo '</tr>';

}

echo '<tr>';
echo '<td><strong>Total</strong></td>';

// reset both week A and B
$overall_conversions = 0; 
$overall_conversionsB = 0;

foreach($typesorder as $type) {

    if(in_array($type, $types)) {

        $conversions = $total_conversions[$type];
        $overall_conversions    += $conversions;

        $conversionsB = $total_conversionsB[$type];
        $overall_conversionsB    += $conversionsB;

        echo '<th>' . number_format($conversions) . '</th>';   
        echo '<th>' . number_format($conversionsB) . '</th>';  
        echo '<th>' . number_format($conversionsB - $conversions) . '</th>';  
    }            
}

echo '<th>' . number_format($overall_conversions) . '</th>';
echo '<th>' . number_format($overall_conversionsB) . '</th>';
echo '<th>' . number_format($overall_conversionsB - $overall_conversions) . '</th>';

echo '</tr>';

echo '</table>'; 
```

这将输出具有以下结构的表：

```
----------------------------------------------------------------------------------
|       |           Type 1          |   Type 2  |    ...    |  Total Conversions |
| Day   -------------------------------------------------------------------------|
|       | Week 1 2013 | Week 1 2012 | ... | ... | ... | ... |         ...        |      
|--------------------------------------------------------------------------------|
|Sunday |      135    |      143    | ... | ... | ... | ... |         ...        |      
|--------------------------------------------------------------------------------|
|  ...  |      ...    |      ...    | ... | ... | ... | ... |         ...        |      
|--------------------------------------------------------------------------------|
|Total  |      ...    |      ...    | ... | ... | ... | ... |         ...        |    
---------------------------------------------------------------------------------- 
```

希望这是有道理的，`...`它们只是重复数据的占位符。

我不需要做任何公式，因为我已经拥有了我需要的所有数据，但我不会排除它，因为使用 PHPExcel 进行总计可能更容易。

我知道这是一个可怕的问题，但我真的很难过如何开始。我并不期待对我的具体情况给出完整、准确的答案（尽管那会很神奇），但实际上任何指针都会有所帮助。

PS 我知道如何使用 PHPExcel 将数据插入 Excel 文档，但它正在转置我的表格，这就是问题所在。我认为第一步是将所有数据添加到多维数组而不是打印它，但我会先看看响应是什么。

另外，请注意我不想输出为 CSV，因为我希望自动通过电子邮件发送预先准备好的和格式化的 Excel 表。

# java - Excel 文件在写入期间损坏

> ID：14359454
> 
> 赞同：-1
> 
> 时间：2013-01-16T13:21:30.687
> 
> 标签：java, jxl, jexcelapi

每当我尝试操作 excel 文件时，相应的 excel 文件都会损坏。请提出如何解决这个问题的建议。我已经用java编写了代码。

这是代码：

```
Workbook workbook = Workbook.getWorkbook(new File("book.xls"));
WritableWorkbook copy = Workbook.createWorkbook(newFile(""), workbook);
WritableSheet sheet = copy.getSheet(0);
WritableFont times16font = new WritableFont(WritableFont.TIMES, 20, WritableFont.BOLD); WritableCellFormat times16format = new WritableCellFormat (times16font);
Label label = new Label(3, 4, "Good", times16format);
sheet.addCell(label);
Label label1 = new Label(3, 5, "Good", times16format);
heet.addCell(label);
copy.write();
copy.close(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-23T20:57:01.390

第二次将标签添加到工作表时，它是相同的标签。我认为您的意思是添加 label1。但是，话虽如此，没有什么会产生损坏的输出。

# android - 如何调试 Phonegap 应用程序中的 GUI 部分？

> ID：14359457
> 
> 赞同：0
> 
> 时间：2013-01-16T13:21:43.160
> 
> 标签：android, unit-testing, user-interface, cordova, qunit

我正在android上编写一个非常简单的Phonegap应用程序。问题是如何自动测试它的 GUI 部分。[根据Cookbook](http://qunitjs.com/cookbook/)的说法，QUnit 看起来是仅测试 Javascript 的不错选择，但它需要 jquery 库来支持测试用户操作。是否适合在 Phonegap 应用程序中包含 JQuery 库以进行测试？

这是一个简单的场景。我在应用程序中有一个输入字段。我想测试一下它是否可以接受价值。我应该如何在 Phonegap 中使用它？或者是否有其他选择来测试 Phonegap 应用程序的 GUI 部分？

我也发现了这个关于 Selenium 的[问题](https://stackoverflow.com/questions/11934125/automated-testing-of-phonegap-cordova-apps)，但我正在尝试寻找其他可能的方法来做到这一点。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:16:17.150

Cordova（以前称为 Phonegap）本身（基本上）与 javascript 无关，它只是一个将 html/js/css 代码包装在 android WebView 元素中的工具。Cordova 具有通过cordova 提供的JS 调用访问设备内部的方法。

好吧，您甚至可以在 chrome 桌面浏览器中对您的应用程序进行单元测试。此外，如果您愿意，您可以在 App 中包含要使用的任何 JS 库。如果您有任何问题 - 只需写评论

# ajax - AJAX无法连接sql数据库

> ID：14359463
> 
> 赞同：-3
> 
> 时间：2013-01-16T13:22:05.063
> 
> 标签：ajax

我尝试创建一个表单来检查用户是否存在于数据库中，但我在将 AJAX 与 sql 连接时遇到问题，如果你能帮助我找出这个问题，我将不胜感激，对不起，我的英语不是很好。这些是我的代码：

```
<!DOCTTYPE html>
<html lang="en">
<head>
<mete charset="UTF-8">
<title>Email client</title>
<script type="text/javascript">

function load(){
 if (window.XMLHttpRequest) {
     xmlhttp = new XMLHttpRequest();
 }else{
     xmlhttp = new ActiveXObject('Microsoft.XMLHTTP');
 }
 xmlhttp.onreadystatechange = function(){
     if (xmlhttp.readyState == 4 && xmlhttp.status == 200 ){
         document.getElementById('info').innerHTML = xmlhttp.responseText;
     }
 }
 xmlhttp.open('GET', 'checkuser.php', true);
 xmlhttp.send();

}

</script>
</head>

<body>

<form name="loginform" onclick="load();">

  Username : <input name="userID" type="text" id="userID"><br />
  Password : <input name="password" type="password" id="passWD"><br />
  <input type="submit" id="button" value="Get in there"> <br />
  <p>Don't have an account? <a href="register.html"> please register </a></p>
</form>

<div id="info"></div>

</body>

</html> 
```

我的 php (checkuser.php):

```
<?php
$dbhost = 'localhost';
$dbuser = 'xxxx';
$dbpass = 'xxxx';
$dbname = 'xxxx';
$dbtable = 'xxxx';

$q=$_GET["userID"];
$p=$_GET["passWD"];

$con = mysql_connect($dbhost, $dbuser, $dbpass);
if (!$con)
 {
    die('Could not connect: ' . mysql_error());
 }
$dbselect = mysql_select_db($dbname,$con);

$sql="SELECT * FROM $dbtable WHERE userID='$q'";

$result = mysql_query($sql);

if (mysql_num_rows($result)==0) { 
    echo "not registered";
} else {
    while($row = mysql_fetch_array($result))
 {

 if (($row['passWD'])==$p) {
   echo "registered";
} else { echo "not registered";} 

}
} 
mysql_close($con);

?> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:26:36.313

您的 PHP 期望将两个查询字符串参数传递给它（不要在查询字符串中发送密码，它们可能会被记录，使用 POST 请求）但是您的 JavaScript 只是请求脚本的 URL，根本没有任何查询字符串。

大概您想扩展`load`以从表单中获取数据，并为表单而不是文档的事件`load`调用事件。`submit``load`

# javascript - 用javascript为cdn的相对路径添加前缀

> ID：14359472
> 
> 赞同：0
> 
> 时间：2013-01-16T13:22:36.467
> 
> 标签：javascript, html, cdn

我有一个简单的网站，在标题中包含对 css 文件和 javascript 文件的相对引用。有没有办法将这些扩展为绝对 url，并在它们前面加上“cdn”。在页面加载时自动？

这是我当前头脑的一部分：

```
<link rel="stylesheet" type="text/css" href="css/default.css">
<link rel="stylesheet" type="text/css" href="css/the-tooltip.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="js/utf8.js" type="text/javascript"></script>
<script src="js/sha1.js" type="text/javascript"></script>
<script src="js/validatious.js" type="text/javascript"></script> 
```

我最终需要的是

```
<link rel="stylesheet" type="text/css" href="http://cdn.mydomain.com/css/default.css">
<link rel="stylesheet" type="text/css" href="http://cdn.mydomain.com/css/the-tooltip.css" />
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
<script src="http://cdn.mydomain.com/js/utf8.js" type="text/javascript"></script>
<script src="http://cdn.mydomain.com/js/sha1.js" type="text/javascript"></script>
<script src="http://cdn.mydomain.com/js/validatious.js" type="text/javascript"></script> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:25:51.987

以下是如何为所有脚本元素添加前缀：

```
function appendPrefix(prefix) {
  var scripts = document.getElementsByTagName('script'),
      links =  document.getElementsByTagName('link'),
      foreach = Array.prototype.forEach;
  foreach.call(scripts, function (s) {
    if (s.src && (/(http|https)/).test(s.src)) {
       s.src = prefix + s.src;
    }
  });
  foreach.call(links, function (l) {
    if (s.src && (/(http|https)/).test(l.href)) {
       l.href = prefix + l.href;
    }
  });
}

appendPrefix('http://stackoverflow.com/'); 
```

该脚本是纯 JavaScript，适用于`script`和`link`标签。它只会将前缀附加到那些`link`不`script`以`http://`.

* * *

## 回答 #2

> 赞同：-1
> 
> 时间：2013-01-16T13:41:10.517

您可以执行重定向请求`/css/*`或`/js/*`到`cdn.example.com/css/*`或`cdn.example.com/js/*`在 Web 服务器的配置文件中（例如，用于 Apache 服务器的 .htaccess）和浏览器获取必要的文件。此解决方案将在您的 Web 服务器上产生负载（不像发送 css 或 js 文件那样多），因此最好手动写入 cdn 的路径。

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-17T12:13:07.850

看起来JS不是最好的解决方案。我在服务器端使用 PHP 解决了这个问题。我定义了一个全局 $prefix 变量并将其附加到动态生成的主机名和路径中，以获取绝对 URL 并仍然保持脚本的可移植性。

# gruntjs - gruntjs 加载外部配置

> ID：14359473
> 
> 赞同：4
> 
> 时间：2013-01-16T13:22:39.557
> 
> 标签：gruntjs

哎呀咕噜大师！

我想将外部配置文件加载到 grunt 中，以便可以执行以下操作：

`$ grunt dev:homepage`

它会加载`homepage-config.json`，然后运行`watch`

`$ grunt dev:contact`

它会加载`contact-config.json`，然后运行`watch`

每个配置文件都会为任务提供特定的设置：watch、jshint、concat 等...

在我的 Gruntfile 中，我有一个名为`dev`

```
grunt.registerTask('dev', 'loads in external -config.json file, then runs watch', function(name) {

  grunt.initConfig(grunt.file.readJSON(name + '-config.json'));

  console.log(grunt.config('jshint.pageConfig.src') // correctly logs whatever had been specified in my external json file

  grunt.task.run('watch'); // correctly boots up watch with configuration specified by external file

}); 
```

在该`dev`任务中，外部加载的配置工作得很好。该console.log 将返回您所期望的，并且`watch`任务以外部指定的设置开始。

我的问题是，一旦`watch`开始触发任务，这些任务似乎不再有权访问这个外部加载的配置。`dev`在任务和由 触发的任务之间的某个地方`watch`，动态加载的配置被吹走了。

谁能解释为什么会发生这种情况以及我如何实现我的目标？

非常感谢，-詹姆斯

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-06-19T06:22:58.767

您需要`nospawn : true`在监视任务配置中指定，以便被调用的任务在相同的上下文中运行。有关更多信息/示例，请参阅文档的[这一部分](https://github.com/gruntjs/grunt-contrib-watch#optionsspawn)。

# smtpclient - 当需要在代码而不是 app.config 中加载配置时，C# 中的 SmtpClient

> ID：14359480
> 
> 赞同：0
> 
> 时间：2013-01-16T13:23:03.007
> 
> 标签：smtpclient

我在课堂上有一个使用 SmtpClient 发送电子邮件的功能。

```
public void Send(System.Net.Mail.MailMessage mail)
    {      
        using (SmtpClient client = new SmtpClient())
        {                
            client.Host = ConfigReader.SmtpHost;
            client.Port = ConfigReader.SmtpPort;
            client.EnableSsl = ConfigReader.SmtpEnableSsl;
            client.UseDefaultCredentials = ConfigReader.SmtpDefaultCredentials;
            client.Credentials = new NetworkCredential(ConfigReader.SmtpUserName, ConfigReader.SmtpPassword);

            client.Send(mail);
        }            
    } 
```

我需要在这个函数中使用另一个类来设置 Smtp 配置。但是每次调用这个函数时设置配置似乎并不正确。

有什么更好的方法呢？如果我在其他一些 Init 函数中加载配置，只调用一次，那么在这种情况下 SmtpClient 将如何处理？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:31:20.967

您在`SmtpClient`本地创建对象，并且在`using`声明中更多地创建对象，因为该对象超出了您的函数范围。每次创建对象时都必须配置对象。

# android - ACRA：有时是对话报告，有时是无声报告

> ID：14359485
> 
> 赞同：0
> 
> 时间：2013-01-16T13:23:15.453
> 
> 标签：android, acra

***我想做的事：***

> 从应用程序本身获取有关我的 Android 应用程序的反馈。

***我做了什么：***

> 我刚刚将最新版本的 ACRA (4.4) 集成到我的 Android 应用程序中。
> 
> 它有关于崩溃的无声报告作为默认行为

***我需要什么帮助：***

> 当我按下我的应用程序上的反馈按钮时，我想要做的就是使用对话框报告。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T14:53:38.963

我不知道你想用你的反馈按钮实现什么，但也许是这样的？

有关对话框的配置，请查看[https://github.com/ACRA/acra/wiki/AdvancedUsage#wiki-Dialog](https://github.com/ACRA/acra/wiki/AdvancedUsage#wiki-Dialog)。`ACRAConfiguration`如果您不希望在注释中包含所有这些，也可以在对象中的代码中完成配置。

然后，您可以使用以下方法临时更改报告模式：

```
ACRAConfiguration config = ACRA.getConfig();
config.setMode(ReportingInteractionMode.DIALOG);
ACRA.setConfig(config);
doWhateverYourFeedbackButtonShouldDo();
config.setMode(ReportingInteractionMode.SILENT);
ACRA.setConfig(config); 
```

哪里`doWhateverYourFeedbackButtonShouldDo()`可以是：

```
ACRA.getErrorReporter().handleException(new UserFeedbackException(userFeedback)); 
```

# python - django-templated-email 不适用于 heroku

> ID：14359486
> 
> 赞同：1
> 
> 时间：2013-01-16T13:23:15.550
> 
> 标签：python, django, web-services, heroku, github

我已经成功安装了[https://github.com/bradwhittington/django-templated-email.git](https://github.com/bradwhittington/django-templated-email.git)，它在我的本地服务器上运行顺利，但是，当我将我的应用程序上传到我拥有的 heroku 存储库时，它得到了对于发送电子邮件，浏览器显示内部服务器错误。

我认为这是因为它试图从“pip”安装包的位置读取代码，而 Heroku 上不存在该数据路径。

**我需要知道的：** 我怎样才能让它在我的heroku服务器上工作？

非常感谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T21:49:46.933

您是否在`requirements.txt`文件中指定了以下内容`pip`以了解从何处安装它？

以下指向最新的提交。如果开发者已经将文件打包成一个鸡蛋，你也可以使用它。

```
git+git://github.com/bradwhittington/django-templated-email.git/62a291004cb21e50409b276bcbd79ae9808aace9 
```

因此，如果缺少包是您的错误的原因，将上述内容添加到 requirements.txt 应该可以解决它

# html - Html5 视频标签在 chrome 中不起作用

> ID：14359487
> 
> 赞同：0
> 
> 时间：2013-01-16T13:23:17.703
> 
> 标签：html

在 W3school 视频标签教程中，我检查了 Chrome，它运行良好，但我将代码复制到我的项目中，但它不起作用。这是代码：

```
<video width="500" height="400" controls autoplay>
    <source src="C:\Users\Sunny\Desktop\My_Passion.mp4" type="video/mp4"/>              
</video> 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:28:19.510

视频源 URL 必须指向托管此页面的 Web 服务器。它不适用于您当前在其中的本地文件路径（指向本地计算机上的视频文件）。

因此，请确保 My_Passion.mp4 文件位于您的 Web 服务器上，然后按如下方式更改源：

```
<source src="My_Passion.mp4" type="video/mp4"/> 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-08-27T09:37:53.590

Chrome 不支持 .mp4 视频编解码器。重新编码视频。

`<video width="500" height="400" controls autoplay> <source src="C:\Users\Sunny\Desktop\My_Passion.mp4" type="video/mp4"/> <source src="C:\Users\Sunny\Desktop\My_Passion.ogv" type="video/ogg"/>
</video>`

您可以使用[在线视频转换器](http://video.online-convert.com/convert-to-ogg)

# iso8583 - 如何扩展 AMessage 为子字段创建子消息 OpenIso8583.Net

> ID：14359498
> 
> 赞同：1
> 
> 时间：2013-01-16T13:24:15.373
> 
> 标签：iso8583, openiso8583.net

我正在使用 OpenIso8583.Net 生成我的 ISO 消息，一切都很完美，除了我在为子字段生成消息时遇到问题。

我知道我必须扩展 AMessage 类才能实现，但显然我做错了。

任何简单的例子都会有很大帮助。我会粘贴代码，但到目前为止它没用我希望这篇文章对在 ISO 8583 规范中处理过子字段的人有意义

[http://code.google.com/p/openiso8583net/](http://code.google.com/p/openiso8583net/) 上面是我正在使用的库的链接

谢谢

# prolog - 在 prolog 的深度列表中计算原子元素

> ID：14359502
> 
> 赞同：0
> 
> 时间：2013-01-16T13:24:27.653
> 
> 标签：prolog

```
elem([],0).

elem([H|T],R):-atomic(H),elem(T,R1),R1 is R+1.

elem([H|T],R):-elem(H,R1),elem(T,R2),R is R1+R2. 
```

这是我的代码，在我在这个网站上搜索了我的问题的答案后，我没有找到一个好的答案。错误是：`?- elem([1,[2],3,4],R)`。

```
ERROR: is/2: Arguments are not sufficiently instantiated. 
```

但它应该是**R = 3**。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:45:27.427

在第二行，你应该有

```
R is R1 + 1 
```

代替

```
R1 is R + 1. 
```

# castle-windsor - 使用 IChannelActionPolicy 构建 ChannelReconnectOnTimeoutPolicy

> ID：14359503
> 
> 赞同：0
> 
> 时间：2013-01-16T13:24:27.777
> 
> 标签：castle-windsor, wcffacility

我正在尝试重新创建温莎城堡维基上提供的有关**频道操作策略**的示例（可在此处找到：http: [//docs.castleproject.org/Windsor.WCF-Facility-Channel-Action-Policy.ashx](http://docs.castleproject.org/Windsor.WCF-Facility-Channel-Action-Policy.ashx)），但我可以'似乎在任何地方的 Castle.Facilities.WcfIntegration 命名空间中都可以找到**IChannelActionPolicy**接口。我已经通过 Nuget 安装了 wcf 工具。

我在这里做错了什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T00:58:33.140

在这方面，文档已经过时。查看`IWcfPolicy`接口及其实现者

# system.diagnostics - 如何通过 TraceSource 调用 TraceListener.Write(object)

> ID：14359517
> 
> 赞同：0
> 
> 时间：2013-01-16T13:25:29.777
> 
> 标签：system.diagnostics, tracelistener, tracesource

我们有一个自定义 TraceListener 实现，它只在收到特定对象（LogMessage）时记录。当直接使用该`Trace.Write(object)`方法时，这一切都很好。

由于性能原因，我想将监听器分开，所以所有不相关的 Trace 消息都不会传递给监听器。因此，我创建了一个特定的 TraceSource，只附加了这个监听器。

现在我很难使用 TraceSource 将我的自定义日志对象 (LogMessage) 传递给侦听器。`TraceSource.TraceData(TraceEventType, int, object)`总是调用方法，而`TraceListener.Write(string)`不是`TraceListener.Write(object)`方法。

有什么方法可以使用 TraceSource 将自定义对象传递给 Listener？

示例代码：

```
using System.Diagnostics;

namespace Sample
{
    public class LogMessage
    {
        public byte[] Data { get; set; }
        //...
    }

    public class Sample
    {
        public void Foo()
        {
            var ts = new TraceSource("Test");

            var lm = new LogMessage();
            //lm.Data = ...;

            //this works: calls the Write(object) method in listener
            Trace.Write(lm);

            //this doesn't work: calls the Write(string) method in listener
            ts.TraceData(TraceEventType.Information, 0, lm);
        }
    }

    public class MyListener : TraceListener
    {
        public override void Write(string message)
        {
            //not in use
        }

        public override void WriteLine(string message)
        {
            //not in use
        }

        public sealed override void Write(object o)
        {
            if (o is LogMessage)
            {
                //do someting with the LogMessage
            }
        }
    }
} 
```

谢谢托马斯

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-04-11T13:29:48.333

也许答案为时已晚，但无论如何：

通过使用 JustDecompile 之类的工具，您可以轻松地看到 TraceSource.TraceData 使用 TraceListener.TraceData 方法，该方法本身基本上使用 object.ToString() 调用 WriteLine 来获取消息。

因此，您必须为您的类 LogMessage 覆盖 ToString 方法才能按照您的意愿进行操作。

# linux - linux中没有crontab的cron作业

> ID：14359518
> 
> 赞同：0
> 
> 时间：2013-01-16T13:25:34.440
> 
> 标签：linux, cron, crontab, moodle

我在linux平台上安装了moodle。我想设置一个 cron 作业来向用户发送电子邮件。我已经阅读了有关使用 crontab 程序并对其进行配置的信息。

但根据我的客户要求，我想在不使用 crontab 的情况下执行它。

有人可以帮我吗？

提前致谢... ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-11T05:53:23.520

你试过`while`吗 `loop`？

例子：

```
while true;
do echo "Hello" ;
sleep 100;
done & 
```

所以你可以在之后输入你的命令/电子邮件脚本`do`，或者你可以为电子邮件过程制作一个脚本并在之后调用，

注意：请添加结束和符号，以便在后台执行。

谢谢。

# c# - 实现通用设置类的最佳方法 - 反映获取/设置属性？

> ID：14359520
> 
> 赞同：1
> 
> 时间：2013-01-16T13:25:42.757
> 
> 标签：c#, xml, reflection, properties, settings

我不知道如何制作通用设置类，希望您能帮助我。
首先，我想要一个单一的设置文件解决方案。为此，我创建了一个像这样的单例：

```
public sealed class Settings
{
  private static readonly Lazy<Settings> _instance = new Lazy<Settings>(() => new Settings());
  private Dictionary<string, object> m_lProperties = new Dictionary<string, object>();

  public void Load(string fileName)
  {
    throw new NotImplementedException();  
  }

  public void Save(string fileName)
  {
    throw new NotImplementedException();
  }

  public void Update()
  {
    throw new NotImplementedException();
  }

  /// <summary>
  /// Gets the propery.
  /// </summary>
  /// <param name="propertyName">Name of the property.</param>
  /// <returns></returns>
  public string GetPropery(string propertyName)
  {
    return m_lProperties[propertyName].ToString() ?? String.Empty;
  }

  /// <summary>
  /// Gets the propery.
  /// </summary>
  /// <param name="propertyName">Name of the property.</param>
  /// <param name="defaultValue">The default value.</param>
  /// <returns></returns>
  public string GetPropery(string propertyName, string defaultValue)
  {
    if (m_lProperties.ContainsKey(propertyName))
    {
      return m_lProperties[propertyName].ToString();
    }
    else
    {
      SetProperty(propertyName, defaultValue);
      return defaultValue;
    }
  }

  /// <summary>
  /// Sets the property.
  /// </summary>
  /// <param name="propertyName">Name of the property.</param>
  /// <param name="value">The value.</param>
  public void SetProperty(string propertyName, string value)
  {
    if (m_lProperties.ContainsKey(propertyName))
      m_lProperties[propertyName] = value;
    else
      m_lProperties.Add(propertyName, value);
  }
} 
```

但我认为更好的方法是属性在类中，我可以通过反射获取属性。
- 你能帮我实现这样的事情吗？
- 是否可以提供诸如“encrypted = true”之类的属性属性？- 在 xml 文件中保存/加载设置的最佳方式是什么？

**更新**
这里是一个如何使用实际设置的示例：

```
class Test()
{
  private string applicationPath;
  private string configurationPath;
  private string configurationFile;

  public Test()
  {
    applicationPath = Settings.Instance.GetPropery("ApplicationPath", AppDomain.CurrentDomain.BaseDirectory);
    configurationPath = Settings.Instance.GetPropery("ConfigurationPath", "configurations");  
    configurationFile = Settings.Instance.GetPropery("ConfigurationFile", "application.xml");  
    // ... Load file with all settings from all classes
  } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:30:05.177

这是我自己的代码中相当相关的一点。

```
public class MyObject
{
    public string StringProperty {get; set;}

    public int IntProperty {get; set;}

    public object this[string PropertyName]
        {
            get
            {
                return GetType().GetProperty(PropertyName).GetGetMethod().Invoke(this, null);
            }
            set
            {
                GetType().GetProperty(PropertyName).GetSetMethod().Invoke(this, new object[] {value});
            }
        }
} 
```

它允许的是：

```
MyObject X = new MyObject();
//Set
X["StringProperty"] = "The Answer Is: ";
X["IntProperty"] = 42;
//Get - Please note that object is the return type, so casting is required
int thingy1 = Convert.ToInt32(X["IntProperty"]);
string thingy2 = X["StringProperty"].ToString(); 
```

**更新：更多解释** 这种工作方式是反射访问**属性**，属性与字段不同，因为它们使用 getter 和 setter，而不是直接声明和访问。您可以使用相同的方法来获取字段，或者*也可以*获取字段，如果您对 GetProperty 的返回值进行空检查，而不是简单地假设它有效。此外，正如另一条评论中所指出的，如果您使用不存在的属性按原样调用它，这将中断，因为它缺少任何形式的错误捕获。我以最简单的形式展示了代码，而不是最健壮的形式。

至于属性属性....该索引器需要在您想要使用它的类（或父类，我有它`BaseObject`）中创建，因此在内部您可以在给定属性上实现属性，然后应用开关或在访问属性时对其进行检查。也许将所有属性设置为您实现的其他自定义类，`Object Value; Bool Encrypted;`然后根据需要从那里对其进行处理，这实际上仅取决于您想要获得多少花哨以及想要编写多少代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:54:44.753

我不建议在可能没有反射的地方使用反射，因为它非常慢。

我没有反射和加密原型的例子：

```
public sealed class Settings
{
    private static readonly HashSet<string> _propertiesForEncrypt = new HashSet<string>(new string[] { "StringProperty", "Password" });
    private static readonly Lazy<Settings> _instance = new Lazy<Settings>(() => new Settings());
    private Dictionary<string, object> m_lProperties = new Dictionary<string, object>();

    public void Load(string fileName)
    {
        // TODO: When you deserialize property which contains into "_propertiesForEncrypt" than Decrypt this property.
        throw new NotImplementedException();
    }

    public void Save(string fileName)
    {
        // TODO: When you serialize property which contains into "_propertiesForEncrypt" than Encrypt this property.
        throw new NotImplementedException();
    }

    public void Update()
    {
        throw new NotImplementedException();
    }

    /// <summary>
    /// Gets the propery.
    /// </summary>
    /// <param name="propertyName">Name of the property.</param>
    /// <returns></returns>
    public object GetPropery(string propertyName)
    {
        if (m_lProperties.ContainsKey(propertyName))
            return m_lProperties[propertyName];

        return null;
    }

    /// <summary>
    /// Gets the propery.
    /// </summary>
    /// <param name="propertyName">Name of the property.</param>
    /// <param name="defaultValue">The default value.</param>
    /// <returns></returns>
    public object GetPropery(string propertyName, object defaultValue)
    {
        if (m_lProperties.ContainsKey(propertyName))
        {
            return m_lProperties[propertyName].ToString();
        }
        else
        {
            SetProperty(propertyName, defaultValue);
            return defaultValue;
        }
    }

    /// <summary>
    /// Sets the property.
    /// </summary>
    /// <param name="propertyName">Name of the property.</param>
    /// <param name="value">The value.</param>
    public void SetProperty(string propertyName, object value)
    {
        if (m_lProperties.ContainsKey(propertyName))
            m_lProperties[propertyName] = value;
        else
            m_lProperties.Add(propertyName, value);
    }

    // Sample of string property
    public string StringProperty
    {
        get
        {
            return GetPropery("StringProperty") as string;
        }
        set
        {
            SetProperty("StringProperty", value);
        }
    }

    // Sample of int property
    public int IntProperty
    {
        get
        {
            object intValue = GetPropery("IntProperty");
            if (intValue == null)
                return 0; // Default value for this property.

            return (int)intValue;
        }
        set
        {
            SetProperty("IntProperty", value);
        }
    }
} 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:42:27.280

使用这样的动态类：[https](https://gist.github.com/3914644) ://gist.github.com/3914644，这样您就可以访问您的属性：yourObject.stringProperty 或 yourObject.intProperty

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T15:08:43.230

最大的问题之一是没有干净的方法将对象反序列化为对象。如果您不提前知道对象的类型需要是什么，那么它很难使用。所以我们有一个替代的解决方案，存储类型信息。

鉴于它没有列出，我将提供我认为的示例 XML，以及使用它的方法，以及访问属性本身的方法。您用于 Get 和 Set 属性的函数按原样运行，无需更改。

在各个类中，您需要确保该类中的相关属性在其自己的 get/set 方法中引用 Settings 类

```
public int? MyClassProperty
{
    get
    {
        return (int?)Settings.Instance.GetProperty("MyClassProperty");
    }
    set
    {
        Settings.Instance.SetProperty("MyClassProperty", value);
    }
} 
```

在您的加载和保存功能中，您将需要使用序列化，特别是`XmlSerializer`. 为此，您需要适当地声明设置列表。为此，我实际上会使用自定义类。

**更新以允许正确加载**

```
public class AppSetting
{
    [XmlAttribute("Name")]
    public string Name { get; set; }
    [XmlAttribute("pType")]
    public string pType{ get; set; }
    [XmlIgnore()]
    public object Value{ get; set; }
    [XmlText()]
    public string AttributeValue 
    {
        get { return Value.ToString(); }
        set {
        //this is where you have to have a MESSY type switch
        switch(pType) 
        { case "System.String": Value = value; break;
          //not showing the whole thing, you get the idea
        }
    }
} 
```

然后，您将拥有以下内容，而不仅仅是一本字典：

```
public sealed class Settings
{
  private static readonly Lazy<Settings> _instance = new Lazy<Settings>(() => new Settings());
  private Dictionary<string, object> m_lProperties = new Dictionary<string, object>();
  private List<AppSetting> mySettings = new List<AppSetting>(); 
```

您的加载功能将是一个简单的反序列化

```
public void Load(string fileName)
{//Note: the assumption is that the app settings XML will be defined BEFORE this is called, and be under the same name every time.
    XmlSerializer ser = new XmlSerializer(typeof(List<AppSetting>));
    FileStream fs = File.Open(fileName);
    StreamReader sr = new StreamReader(fs);
    mySettings = (List<AppSetting>)ser.DeSerialize(sr);
    sr.Close();
    fs.Close();

    //skipping the foreach loop that will add all the properties to the dictionary
} 
```

保存功能基本上需要反转它。

```
public void Save(string fileName)
    {
        //skipping the foreach loop that re-builds the List from the Dictionary
        //Note: make sure when each AppSetting is created, you also set the pType field...use Value.GetType().ToString()

        XmlSerializer ser = new XmlSerializer(typeof(List<AppSetting>));
        FileStream fs = File.Open(fileName, FileMode.Create);
        StreamWriter sw = new StreamWriter(fs);
        //get rid of those pesky default namespaces
        XmlSerializerNamespaces ns = new XmlSerializerNamespaces();
        ns.Add("", "");
        ser.Serialize(sw, mySettings, ns);
        sw.Flush();
        sw.Close();
        fs.Close();
        mySettings = null;//no need to keep it around
    } 
```

并且 xml 将类似于以下内容：

**更新**

```
<ArrayOfAppSetting>
    <AppSetting Name="ApplicationPath" pType="System.String">C:\Users\ME\Documents\Visual Studio 2010\Projects\WindowsFormsApplication1\WindowsFormsApplication1\bin\Debug\</AppSetting> 
    <AppSetting Name="ConfigurationPath" pType="System.String">configurations</AppSetting> 
    <AppSetting Name="ConfigurationFile" pType="System.String">application.xml</AppSetting> 
    <AppSetting Name="prop" pType="System.Int32">1</AppSetting> 
</ArrayOfAppSetting> 
```

我使用中间体展示了这个示例，`List<>`因为事实证明您不能使用任何通过 XmlSerializer 实现 IDictionary 的东西。它将无法初始化，它只是不起作用。

您可以在字典旁边创建和维护列表，也可以将字典替换为列表...确保检查以验证“名称”是唯一的，或者您可以简单地忽略列表，除非在保存和加载操作（这就是我写这个例子的方式）

**更新** 这确实只适用*于*原始类型（int、double、string 等），但是因为您直接存储类型，所以您可以使用任何您想要的自定义类型，因为您知道它是什么以及如何处理它, 你只需要在 AttributeValue 的 set 方法中处理

**另一个更新：**如果您只存储字符串，而不是所有类型的对象......它会变得非常简单。摆脱`XmlIgnore value`AND `pType`，然后自动实现`AttributeValue`. 砰，完成。但是，这将限制您使用字符串和其他原语，请确保其他类中的值的 Get/Set 适当地转换它们......但它是一个更简单和更容易的实现。

# javascript - 帆布挥舞旗帜 HTML5

> ID：14359522
> 
> 赞同：0
> 
> 时间：2013-01-16T13:25:50.587
> 
> 标签：javascript, html, html5-canvas

我需要一些关于画布和 HTML5 的帮助。

**我有这个代码**

```
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <title>HTML Canvas Flag Wave</title>
    <style type="text/css" media="screen">
      body { background:#eee }
      #flag { position:absolute; top:50%; left:50% }
    </style>
    <script type="text/javascript">
      var h = new Image;
      h.onload = function(){
        var flag = document.getElementById('flag');
        var amp = 20;
        flag.width  = h.width;
        flag.height = h.height + amp*2;
        flag.getContext('2d').drawImage(h,0,amp,h.width,h.height);
        flag.style.marginLeft = -(flag.width/2)+'px';
        flag.style.marginTop  = -(flag.height/2)+'px';
        var timer = waveFlag( flag, h.width/10, amp );
      };
      h.src = 'gkhead.jpg';

      function waveFlag( canvas, wavelength, amplitude, period, shading, squeeze ){
        if (!squeeze)    squeeze    = 0;
        if (!shading)    shading    = 100;
        if (!period)     period     = 200;
        if (!amplitude)  amplitude  = 10;
        if (!wavelength) wavelength = canvas.width/10;

        var fps = 30;
        var ctx = canvas.getContext('2d');
        var   w = canvas.width, h = canvas.height;
        var  od = ctx.getImageData(0,0,w,h).data;
        // var ct = 0, st=new Date;
        return setInterval(function(){
          var id = ctx.getImageData(0,0,w,h);
          var  d = id.data;
          var now = (new Date)/period;
          for (var y=0;y<h;++y){
            var lastO=0,shade=0;
            var sq = (y-h/2)*squeeze;
            for (var x=0;x<w;++x){
              var px  = (y*w + x)*4;
              var pct = x/w;
              var o   = Math.sin(x/wavelength-now)*amplitude*pct;
              var y2  = y + (o+sq*pct)<<0;
              var opx = (y2*w + x)*4;
              shade = (o-lastO)*shading;
              d[px  ] = od[opx  ]+shade;
              d[px+1] = od[opx+1]+shade;
              d[px+2] = od[opx+2]+shade;
              d[px+3] = od[opx+3];
              lastO = o;
            }
          }
          ctx.putImageData(id,0,0);		
          // if ((++ct)%100 == 0) console.log( 1000 * ct / (new Date - st));
        },1000/fps);
      }

    </script>
  </head>
  <body>
    <canvas id="flag"></canvas>
  </body>
</html>
```

**结果是这样的：** [http ://www.americkiplakari.org/zastavanovo.html](http://www.americkiplakari.org/zastavanovo.html)

漂亮的挥舞旗帜，但我有一个问题，我不太擅长画布。我想旋转画布，我想固定图像的顶部并且波浪从上到下，是否可以这样做。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:31:08.853

好的，这是一个简单的解决方案，只需使用 CSS3 旋转，将画布放在另一个 div 中，您就可以开始了......

```
<style type="text/css" media="screen">
    body { background:#eee }
#flagunustra { position:absolute; top:50%; left:50% }
#flag{
 margin-top:250px;
 width:414px;
transform:rotate(90deg);
-ms-transform:rotate(90deg); /* IE 9 */
-moz-transform:rotate(90deg); /* Firefox */
-webkit-transform:rotate(90deg); /* Safari and Chrome */
-o-transform:rotate(90deg); /* Opera */
}
</style>

<div id="flagunustra">
<canvas id="flag"></canvas></div> 
```

# java - JSF Internationalization f:loadbundle 或通过 faces-config: 性能点

> ID：14359523
> 
> 赞同：5
> 
> 时间：2013-01-16T13:25:50.603
> 
> 标签：java, jsf, jakarta-ee, internationalization, resourcebundle

有两种方法可以将属性文件加载到 JSF 2.0 中。

1.  全局资源包 全局加载属性文件，以便所有 jsf 页面都可以访问消息。您可以创建一个“faces-config.xml”文件并明确声明属性文件。

面孔-config.xml

```
<?xml version="1.0" encoding="UTF-8"?>
<faces-config
    xmlns="http://java.sun.com/xml/ns/javaee"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/javaee 
    http://java.sun.com/xml/ns/javaee/web-facesconfig_2_0.xsd"
    version="2.0">
     <application>
      <resource-bundle>
        <base-name>com.mkyong.messages</base-name>
        <var>msg</var>
       </resource-bundle>
     </application>
</faces-config> 
```

**选项 2：**本地资源包 本地加载属性文件，或仅用于指定页面。在messages.properties中声明`<f:loadBundle />`页面中需要访问消息的标签。

在这两个中，哪一个给我更好的性能？

假设我选择第一个选项，这是否意味着在应用程序启动期间加载了所有捆绑包，还是延迟加载？（一经请求）

如果选择第二个选项，是否可能导致每个 ViewRoot 多次加载捆绑包？

Java ResourceBundle 是在 servlet 容器中提供单例对象的工厂类吗？

我的意思是 getBundle 方法是始终创建单例对象的工厂方法？

```
ResourceBundle myResources =
      ResourceBundle.getBundle("MyResources", currentLocale); 
```

假设我有一个页面 abc.xhtml 并且我正在使用 f:loadBundle，并且有 1000 个用户访问此页面，这是否意味着将创建 1000 个 resouceBundle 对象？还是只有所有页面实例共享的对象？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:48:59.257

> *在这两个中，哪一个给我更好的性能？*

我不会担心性能。已经在`ResourceBundle`内部缓存它们。

* * *

> *假设我有一个页面 abc.xhtml 并且我正在使用 f:loadBundle，并且有 1000 个用户访问此页面，这是否意味着将创建 1000 个 resouceBundle 对象？还是只有所有页面实例共享的对象？*

默认情况下，只创建一个。[另请`ResourceBundle`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html)参阅[API 文档](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html)：

> ### 缓存管理
> 
> getBundle 工厂方法创建的资源包实例默认会被缓存，如果已经缓存，工厂方法会多次返回同一个资源包实例。getBundle 客户端可以清除缓存，使用生存时间值管理缓存的资源包实例的生命周期，或者指定不缓存资源包实例。有关详细信息，请参阅[`getBundle`工厂方法](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#getBundle%28java.lang.String,%20java.util.Locale,%20java.lang.ClassLoader,%20java.util.ResourceBundle.Control%29)、[`clearCache`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.html#clearCache%28java.lang.ClassLoader%29)、[`ResourceBundle.Control.getTimeToLive`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.Control.html#getTimeToLive%28java.lang.String,%20java.util.Locale%29)和[`ResourceBundle.Control.needsReload`](http://docs.oracle.com/javase/6/docs/api/java/util/ResourceBundle.Control.html#needsReload%28java.lang.String,%20java.util.Locale,%20java.lang.String,%20java.lang.ClassLoader,%20java.util.ResourceBundle,%20long%29)的说明。

您可以通过查看实例的哈希码轻松证明自己是否在调试器中。

* * *

顺便说一句，该`<application>`声明还有一个额外的好处，即捆绑包也可以通过`@ManagedProperty("#{msg}")`. 另请参阅此问答：[读取托管 bean 中的资源包属性](https://stackoverflow.com/questions/13655540/read-i18n-variables-from-properties-file-in-a-bean)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:23:42.480

您已经从答案中看到，一个全局资源包就足够了。***关于性能：***

您有两种标准 ResourceBundle 实例：

*   PropertyResourceBundle - *[_LOCALE].properties 文件，以及
*   ListResourceBundle，一个java类（使用带有'.'的包名） - *[_LOCALE].class。

对于 ListResourceBundle：

每个 locale java 类都会创建一个带有共享 (!) 键和本地化文本的字符串数组。在 JVM 中共享密钥字符串很好。此外，所有字符串都提前加载。

因此，提供一个 ListResourceBundle 可能是值得的。

然而，对于翻译，您可能必须维护一些非 Java 翻译记忆库、tmx、xliff 等。并在构建过程中生成 java.lang.

* * *

## 回答 #3

> 赞同：-1
> 
> 时间：2013-01-16T13:28:11.423

第一个选项 - 因为它是应用程序范围并在启动时加载

# c# - C#：System.Windows.Application.Current.MainWindow 在其他 PC 上不返回相同的值

> ID：14359530
> 
> 赞同：0
> 
> 时间：2013-01-16T13:26:06.080
> 
> 标签：c#, wpf, mdi, mdiparent, mainwindow

在 Visual Studio 2010 中，我有一个使用 WPF 构建的 Mdi 应用程序。调用弹出窗口时，我想用当前主窗口设置所有者。因此，我们使用该`System.Windows.Application.Current.MainWindow`属性来设置所有者。

这适用于我所有同事的电脑，但不适用于我的电脑。它总是返回弹出窗口本身。为什么？？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2014-04-22T08:51:25.140

您需要访问此窗口，因此请尝试使用 System.Windows.Window 中的 Window.GetWindow 方法。

# android - 监控 Android 设备的活动

> ID：14359531
> 
> 赞同：0
> 
> 时间：2013-01-16T13:26:10.273
> 
> 标签：android

我想开发一个 android 应用程序，它允许我跟踪以下信息并将其保存到在线数据库中：

*   来电和去电
*   传入和传出短信
*   键盘键入的击键

问题：

1.  如何在后台运行我的应用程序（必须使用服务或线程）？

2.  是否可以接听详细信息（电话号码、通话日期、通话时长等）的来电或去电？

3.  是否可以收到带有详细信息（目的地/来源号码、消息内容）的传入或传出消息？

4.  是否可以通过键盘输入所有击键？

5.  我是否需要 root 访问权限才能执行此操作？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:44:39.657

> 如何在后台运行我的应用程序（必须使用服务或线程）？

使用服务

> 是否可以接听详细信息（电话号码、通话日期、通话时长等）的来电或去电？

是的。

> 是否可以收到带有详细信息（目的地/来源号码、消息内容）的传入或传出消息？

对于传入有官方 SDK 支持。对于传出，只有非官方的方法。

> 是否可以通过键盘输入所有击键？

这是不可能的，除非您还编写了正在使用的键盘应用程序。

> 我是否需要 root 访问权限才能执行此操作？

不。

# c++ - 一个插入器线程和一个读取器线程的 std::map 并发

> ID：14359534
> 
> 赞同：1
> 
> 时间：2013-01-16T13:26:15.390
> 
> 标签：c++

我有一个线程（线程 A），它不断迭代地图，比如 MapA。

现在有另一个线程 (ThreadB) 将元素插入 MapA。

我不从 MapA 中删除元素

这个操作会不会有并发问题？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:36:24.703

插入新项目时，线程安全/并发问题和无效迭代器之间存在区别。

STL 本质上不是线程安全的，所以除了从多个线程读取 STL 对象之外，请确保在执行其他任何操作时使用互斥锁。

但是，插入 a`std::map`不会使现有迭代器无效（请参阅[插入到 STL 映射是否使其他现有迭代器无效？](https://stackoverflow.com/questions/4343220/does-insertion-to-stl-map-invalidate-other-existing-iterator)）

# c++ - 如何修复错误无效的初始化和左值

> ID：14359536
> 
> 赞同：0
> 
> 时间：2013-01-16T13:26:17.323
> 
> 标签：c++

```
#include <stdio.h>

main(){
    int ctr, ctr2, accn, tempn;
    char name[10][20], kwh[10][5], due[10][5], paid[10][5], tempne[20], tempkwh[5], tempdue[5], temppd[5];
    clrscr();
    for(ctr=0;ctr<10;ctr++){
    clrscr();
        printf("Account number:\n");
        scanf("%d",&accn[ctr]);
        printf("Name:\n");
        scanf("%s",&name[ctr][0]);
        printf("KWH used:\n");
        scanf("%s",&kwh[ctr][0]);
        printf("Amount due:\n");
        scanf("%s",&due[ctr][0]);
        printf("Amount paid:\n");
        scanf("%s",&paid[ctr][0]);
        }
    ctr=1;
    for( ;ctr==1; ){
        ctr=0;
        for(ctr2=0;ctr2<10;ctr2++){
            if(accn[ctr]>accn[ctr+1])
            {
                tempn=accn[ctr];
                accn=accn[ctr+1];
                accn[ctr+1]=tempn;
                tempne=name[ctr];
                name[ctr]=name[ctr+1];
                name[ctr+1]=tempne;
                tempkwh=kwh[ctr];
                kwh[ctr]=kwh[ctr+1];
                kwh[ctr+1]=tempkwh;
                tempdue=due[ctr];
                due[ctr]=due[ctr+1];
                due[ctr+1]=tempdue;
                temppd=paid[ctr];
                paid[ctr]=paid[ctr+1];
                paid[ctr+1]=temppd;
                ctr=1;
                }
            }
            }
            clrscr();
            ctr=0;
            for( ;ctr<10;ctr++){
            printf("%d %s \n%s\n %s\n %s\n\n",accn[ctr], name[ctr], kwh[ctr], due[ctr], paid[ctr]);
        }  

                                       } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:28:48.983

弹出的第一个是：

```
scanf("%d",&accn[ctr]); 
```

where`accn`和`ctr`都是 type `int`。它应该做什么？

还

```
tempn=accn[ctr]; 
```

`tempn`数组在哪里。

恐怕您的问题的解决方案只能在[这里](https://stackoverflow.com/questions/388242/the-definitive-c-book-guide-and-list)找到。

# ruby-on-rails-3 - ruby on rails 的多表类继承

> ID：14359543
> 
> 赞同：1
> 
> 时间：2013-01-16T13:26:43.390
> 
> 标签：ruby-on-rails-3, inheritance, class-table-inheritance

我这里需要为以下模型建立一个多类继承模型。基本上我正在构建一个可扩展的联系人目录。从基类 Contact 我打算派生其他类，即：

```
class Contact
    # the super class
    attr_accessible :name, :about
end

class Person < Contact
    attr_accessible :first_name, last_name, :description, :works_for_company_id
end

class Company < Contact
    attr_accessible :company_name, :location, :services
end 
```

每个模型对应一个不同的表 - 我假设在父类和子类之间会有一个 has_one belongs_to 关系但是我想知道是否有一个可以缓解它的宝石。或者，如果我必须自己做，我将如何实际完成它。

例如，contact.name 实际上是 person.first_name+' '+person.last_name 代表个人或 company.company_name 代表公司。如何构建我的数据库和关联以使其正确？

# r - 将两列日期和时间数据转换为一列

> ID：14359546
> 
> 赞同：8
> 
> 时间：2013-01-16T13:26:48.303
> 
> 标签：r

我有一个简单的数据框：

```
D <- c("2012/12/14", "2012/12/14")
Time <- c("18:40:37", "18:40:48")
df1 <- data.frame(D, Time) 
```

我希望将两列日期和时间信息合二为一，最好采用日、月、年、时间的格式。

我该怎么做呢？

* * *

## 回答 #1

> 赞同：16
> 
> 时间：2013-01-16T13:30:41.260

```
R> within(df1, { timestamp=format(as.POSIXct(paste(D, Time)), "%d/%m/%Y %H:%M:%S") })

           D     Time           timestamp
1 2012/12/14 18:40:37 14/12/2012 18:40:37
2 2012/12/14 18:40:48 14/12/2012 18:40:48 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2016-12-27T09:19:08.980

一个稍短的替代方案可能是：

```
df1 <- within(df1, { timestamp=strptime(paste(D, Time), "%Y/%m/%d%H:%M:%S") })
df1
       D     Time           timestamp
1 2012/12/14 18:40:37 2012-12-14 18:40:37
2 2012/12/14 18:40:48 2012-12-14 18:40:48 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2017-01-17T23:48:58.353

```
df1$TS <- as.POSIXct(paste(df1$D, df1$Time)) 
```

这将在 df1 中创建一个额外的列 TS，它结合了日期和时间，并且类型为 POSIXct。您可以通过以下方式确认

```
str(df1) 
```

# asp.net - SimpleMembershipProvider、实体框架和默认数据库

> ID：14359548
> 
> 赞同：0
> 
> 时间：2013-01-16T13:26:52.523
> 
> 标签：asp.net, asp.net-mvc-4, entity-framework-5, simplemembership

我首先在 MVC4 互联网应用程序中使用带有实体框架代码的新 SimpleMemebership 提供程序。一切都很好，只是框架创建了名为“DefaultConnection”的新数据库，即使我更改了它。

```
<add name="MyDB" connectionString="Data Source=.\SQLEXPRESS; Initial Catalog=BeerOperator; Integrated Security=SSPI; MultipleActiveResultSets=True" providerName="System.Data.SqlClient" /> 
```

并在 Filters\InitializeSimpleMembershipAttribute.cs

```
WebSecurity.InitializeDatabaseConnection("MyDB", "UserProfile", "UserId", "UserName", autoCreateTables: true); 
```

我真的不明白我需要更改什么才能将用户管理表创建到 MyDB 数据库中。

非常感谢大卫

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:39:00.277

没关系，我找到了。在 AccountModel.cs 我有：

```
public UsersContext() : base("DefaultConnection") 
```

我变成了：

```
 public UsersContext() : base("MyDB") 
```

现在好了。

# c++ - 使用成员函数指针专门化模板类

> ID：14359550
> 
> 赞同：1
> 
> 时间：2013-01-16T13:26:57.213
> 
> 标签：c++, templates, visual-c++

我正在使用 VS 2008（抱歉，无法更新）。我的列表类需要模板专业化。我要专门研究的参数是成员函数指针。

简而言之，我怎样才能使以下代码工作（我不能使用可变参数模板）：

```
// two or three args
template <typename T1, typename T2, void (T1::* FUNC)(const T2&) = 0> struct list;
// specialized code for 2 args.
template <typename T1, typename T2> struct list<T1, T2> { }; 
```

错误信息是：

> C2754：“专业化”：部分专业化不能具有依赖的非类型模板参数

也许我的问题没有解决方案。但这也是一个答案。

提前感谢您的帮助。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:57:57.020

如果我确实正确理解了您要达到的目标，**则无法完成**。让我们考虑一个更*简单的**非法**专业化*情况：

```
template <typename T1, typename T2, void (T1::* FUNC)(const T2&)> struct list;
template <typename T1, typename T2> struct list<T1, T2, 0> { }; 
```

在这里，您总是必须提供三个参数来实例化您的模板，并且您尝试将主模板专门用于最后一个参数是空指针的情况。

根据C++ 标准的**第 14.5.5/8 节：**

*“对应于专门的非类型参数的模板参数的类型不应依赖于专门化的参数。[示例：*

```
template <class T, T t> struct C {};
template <class T> struct C<T, 1>; // error

template< int X, int (*array_ptr)[X] > class A {};
int array[5];
template< int X > class A<X,&array> { }; // error 
```

*——结束示例]* “

您不能专门化其类型依赖于模板形参列表中的其他类型的非类型实参。因此，上述专业化是非法的。

您的原始设计只是此专业化的一个*特例*，其中最后一个（非类型）参数具有默认参数值，您在专业化中将其省略（省略它*本身*是合法的）。这是非法的原因与默认参数的存在**无关**，而是与您试图专门化**具有依赖类型的****非类型**参数的事实有关。

# html - 在每个页面上缓存常见的 HTML 块

> ID：14359552
> 
> 赞同：1
> 
> 时间：2013-01-16T13:27:05.940
> 
> 标签：html, caching

我们在每个页面上都有一个通用的导航栏。

您将如何缓存它以使其不会加载到每个页面上？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:28:59.497

您可以在每个页面的情况下使用 AJAX 加载它`onload`，并将其附加到页面上的相应导航容器中。

只要对菜单的请求保持静态，浏览器就应该能够缓存响应。因此，您基本上已经在客户端的浏览器上缓存了您的菜单。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:28:13.127

将内容放入 javascript 文件 navigation.js 中的变量中

```
nav_bar = "....." 
```

然后将其包含`navigation.js`在每个页面上，并通过 JavaScript 在当前页面中插入内容。

# java - 基于 SOAP 的 Web 服务 Jive 中的身份验证和授权

> ID：14359556
> 
> 赞同：2
> 
> 时间：2013-01-16T13:27:40.727
> 
> 标签：java, web-services, soap

我正在 Jive 4.5.5.0 中开发 SOAP Web 服务。我编写了一个没有身份验证的代码。

我的示例程序：

```
SuppressWarnings("serial")

@WebService(name="Helloworld",portName="HelloworldPort", serviceName = "Helloworld", targetNamespace="http://Helloworld.com/webservices")

@SOAPBinding(style = SOAPBinding.Style.RPC, use= SOAPBinding.Use.LITERAL, parameterStyle= SOAPBinding.ParameterStyle.WRAPPED)

public class Helloworld extends JiveActionSupport  {   

    public String sayHello(@WebParam(name="name")String name) {

        return "hello "+name;

    }

} 
```

我的 spring.xml 是这样的

```
<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"

       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"

       xmlns:aop="http://www.springframework.org/schema/aop"

       xmlns:util="http://www.springframework.org/schema/util"

       xmlns:tx="http://www.springframework.org/schema/tx"

       xmlns:dwr="http://www.directwebremoting.org/schema/spring-dwr"

       xmlns:cxf="http://cxf.apache.org/core"

       xmlns:jaxws="http://cxf.apache.org/jaxws"

       xsi:schemaLocation="

http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-2.0.xsd

http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.0.xsd

http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-2.0.xsd

http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-2.0.xsd

http://www.directwebremoting.org/schema/spring-dwr http://www.directwebremoting.org/schema/spring-dwr-2.0.xsd

http://cxf.apache.org/jaxws http://cxf.apache.org/schemas/jaxws.xsd

http://cxf.apache.org/core http://cxf.apache.org/schemas/core.xsd"

       default-autowire="no">

    <!--  Alter the default mapping chains, switching formAuthenticationFilter with the federatedIdentityAuthFilter defined below.

          This definition uses the federated identity filter for normal app requests and Web Service requests, but leaves

          the form mechanism in place for admin and upgrade purposes. The desired behavior will vary depending on

          the application. -->

    <bean id="filterChainProxy" class="org.acegisecurity.util.FilterChainProxy">

        <property name="filterInvocationDefinitionSource">

            <value>

                CONVERT_URL_TO_LOWERCASE_BEFORE_COMPARISON

                PATTERN_TYPE_APACHE_ANT

                 /upgrade/**=httpSessionContextIntegrationFilter, upgradeAuthenticationFilter, upgradeExceptionTranslationFilter, jiveAuthenticationTranslationFilter

                /post-upgrade/**=httpSessionContextIntegrationFilter, postUpgradeAuthenticationFilter, postUpgradeExceptionTranslationFilter,jiveAuthenticationTranslationFilter

                /admin/**=httpSessionContextIntegrationFilter, adminAuthenticationFilter, adminExceptionTranslationFilter,jiveAuthenticationTranslationFilter

                /rpc/xmlrpc=wsRequireSSLFilter, httpSessionContextIntegrationFilter, basicAuthenticationFilter, wsExceptionTranslator, jiveAuthenticationTranslationFilter, wsAccessTypeCheckFilter

                /rpc/rest/**=wsRequireSSLFilter, httpSessionContextIntegrationFilter, basicAuthenticationFilter, wsExceptionTranslator, jiveAuthenticationTranslationFilter, wsAccessTypeCheckFilter

                /rpc/soap/**=wsRequireSSLFilter, httpSessionContextIntegrationFilter, basicAuthenticationFilter, jiveAuthenticationTranslationFilter

                /**=httpSessionContextIntegrationFilter, jiveAuthenticationTranslationFilter

            </value>

        </property>

    </bean>

    <bean id="hellworldbean" class="com.test.Helloworld">

        </bean>       

    <jaxws:endpoint id="helloworld" address="/soap/sayHelloworld">

        <jaxws:implementor>

            <ref bean="hellworldbean" />

        </jaxws:implementor>       

</jaxws:endpoint>

</beans> 
```

我想为其添加身份验证。虽然 basicAuthenticationFilter 存在于 /rpc/soap/** 模式中，但它并不要求进行身份验证。在管理控制台设置中，我只检查了对 Web 服务中特定用户的访问权限。

此 Web 服务运行良好，提供正确的输出。但它缺乏授权。

任何人都可以共享一些示例代码来在客户端以及服务端进行身份验证和授权。

# python - 使用 Python 读取 YAML 文件会导致 yaml.composer.ComposerError: expected a single document in the stream

> ID：14359557
> 
> 赞同：70
> 
> 时间：2013-01-16T13:27:51.787
> 
> 标签：python, yaml, pyyaml

我有一个看起来像的 yaml 文件

```
---
level_1: "test"
level_2: 'NetApp, SOFS, ZFS Creation'
request: 341570
---
level_1: "test"
level_2: 'NetApp, SOFS, ZFS Creation'
request: 341569
---
level_1: "test"
level_2: 'NetApp, SOFS, ZFS Creation'
request: 341568 
```

我可以使用 YAML 在 Perl 中正确读取此内容，但不能在使用 YAML 的 python 中正确读取。它失败并出现错误：

> 期望流中有一个文档

程序：

```
import yaml

stram = open("test", "r")
print yaml.load(stram) 
```

错误：

```
Traceback (most recent call last):
  File "abcd", line 4, in <module>
    print yaml.load(stram)
  File "/usr/local/pkgs/python-2.6.5/lib/python2.6/site-packages/yaml/__init__.py", line 58, in load
    return loader.get_single_data()
  File "/usr/local/pkgs/python-2.6.5/lib/python2.6/site-packages/yaml/constructor.py", line 42, in get_single_data
    node = self.get_single_node()
  File "/usr/local/pkgs/python-2.6.5/lib/python2.6/site-packages/yaml/composer.py", line 43, in get_single_node
    event.start_mark)
yaml.composer.ComposerError: expected a single document in the stream
  in "test", line 2, column 1
but found another document
  in "test", line 5, column 1 
```

* * *

## 回答 #1

> 赞同：110
> 
> 时间：2013-01-18T17:14:58.273

yaml 文档由 分隔`---`，如果任何流（例如文件）包含多个文档，那么您应该使用该`yaml.load_all`函数而不是`yaml.load`. 编码：

```
import yaml

stream = open("test", "r")
docs = yaml.load_all(stream)
for doc in docs:
    for k,v in doc.items():
        print k, "->", v
    print "\n", 
```

结果为问题中提供的输入文件：

```
request -> 341570
level_1 -> test
level_2 -> NetApp, SOFS, ZFS Creation

request -> 341569
level_1 -> test
level_2 -> NetApp, SOFS, ZFS Creation

request -> 341568
level_1 -> test
level_2 -> NetApp, SOFS, ZFS Creation 
```

# jquery - NivoSlider - 悬停在 Control Nav 上时出现奇怪的像素跳跃

> ID：14359560
> 
> 赞同：0
> 
> 时间：2013-01-16T13:27:55.873
> 
> 标签：jquery, css, nivo-slider

我目前正在开发一个包含 nivo 滑块的 wp 模板，该模板运行良好，直到发生了一些奇怪的事情。每当我将鼠标悬停在滑块上时，控件导航内的按钮都会向右移动 1-2 像素。这仅在 Chrome 中发生，在 FF 中可以正常工作（但是，按钮在活动按钮下方 1 像素）。我尝试使用 Firebug，但我没有得到任何线索，发生了什么。

关于我的部分 CSS 的滑块：

```
#wrapper, #slider {
height: 504px;
width: 960px;
margin: 0 auto;
z-index: 0;
position: relative;
} 
```

Nivo 滑块 CSS： [http ://pastebin.com/p0YTYrWg](http://pastebin.com/p0YTYrWg)

滑块主题 css： http: [//pastebin.com/aKD2W1Pj](http://pastebin.com/aKD2W1Pj)

有什么帮助吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-08-05T06:50:53.133

已解决：必须添加“背面可见性：隐藏；”

# android - Android Zxing（条码库）。如何更改扫描后意图

> ID：14359561
> 
> 赞同：0
> 
> 时间：2013-01-16T13:28:04.657
> 
> 标签：android, zxing

我正在开发一个 Android 应用程序，我需要嵌入 Zxing 扫描仪。应用程序应允许用户扫描二维码，然后存储产品的二维码 ID，并从 XML 文件中解析它。到目前为止，我已经使用了简单的代码：

```
Intent intent = new Intent("com.google.zxing.client.android.SCAN");
intent.setPackage(getPackageName());        
intent.putExtra("com.google.zxing.client.android.SCAN.SCAN_MODE", "QR_CODE_MODE");
startActivityForResult(intent, 0); 
```

这段代码的作用是扫描产品并将我带回到我的应用程序的前一个屏幕。我没有包含来自 Zxing 的整个库，因为我希望条形码扫描仪能够处理它，但似乎我必须做的比我已经做的更多。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T14:20:24.803

您需要创建一个`onActivityResult`在条形码扫描器完成后将获得回调的方法。在那里，您将处理代码字符串并做任何您喜欢的事情。

```
/*Here is where we come back after the Barcode Scanner is done*/
public void onActivityResult(int requestCode, int resultCode, Intent intent) {
    if (requestCode == 0) {
        if (resultCode == RESULT_OK) {
            // contents contains whatever the code was
            String contents = intent.getStringExtra("SCAN_RESULT");

            // Format contains the type of code i.e. UPC, EAN, QRCode etc...
            String format = intent.getStringExtra("SCAN_RESULT_FORMAT");

            // Handle successful scan
            Log.i("TAG",format + "\t" + contents);
        } else if (resultCode == RESULT_CANCELED) {
            // Handle cancel. If the user presses 'back' before a code is scanned.
            Log.i("TAG","Canceled");
        }
    }
} 
```

此示例仅记录结果，您需要对其进行扩展以使用从扫描仪返回的信息执行任何您想要的操作。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T16:46:02.393

更好的是，使用`IntentIntegrator`项目提供的类。它包含了这里列出的所有细节，它的文档已经告诉你如何将它集成到你的应用程序中。它为您处理诸如安装应用程序（如果尚未安装）之类的事情。

# php - http.get 和 node.js 和 JSON

> ID：14359562
> 
> 赞同：0
> 
> 时间：2013-01-16T13:28:05.603
> 
> 标签：php, javascript, node.js, json

我试图开发一个基于 node.js 的 Web 应用程序，它与 PHP api 交互。下面我尝试请求我的 PHP api 创建的 JSON 对象。我要做的就是获取它，然后在我的 .ejs 模板之一中使用它。

这是我的节点代码，

```
/*
 * GET home page.
 */

 //var request = require('reqeust');
 var http = require('http');
 var body = "";

exports.index = function(req, res){

    var options = {
        host: 'api.dev.com',
        port: 80,
        path: '/api/v1/posts',
        method: 'GET'
    };

    http.get(options, function(res) {
      console.log("Got response: " + res.statusCode);
      console.log(res);
      res.on("data", function(chunk) {
        console.log("BODY: " + chunk);
      });
    }).on('error', function(e) {
      console.log("Got error: " + e.message);
    });

    res.render('index', { data: body });
}; 
```

EJS

```
<%= data.title %> 
```

但是 data.title 返回为未定义，我的 JSON 对象如下所示，并且有效。

```
[{"title":"This is the title of post 1","extract":"This is just a proof of concept more than anything at the moment","body":"<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. \n \t\t\t\tCras sed tellus massa, at commodo lectus. Ut metus nulla, sollicitudin id mollis ac, \n \t\t\t\tmalesuada eget libero. Duis sit amet auctor metus. Suspendisse et ornare dolor.\n \t\t\t\tMorbi non sodales sem. Nunc semper hendrerit dignissim. Proin id mollis purus.\n \t\t\t\tProin leo leo, feugiat ac sodales in, laoreet quis nisl. Etiam sed enim in libero\n \t\t\t\tpellentesque porttitor id eget diam.<\/p>","date_created":"01\/01\/2013 13:08:45","author":"Simon"}] 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T20:23:51.197

尝试使用`request`模块，因此您不必处理块。

```
/*
 * GET home page.
 */

 var request = require('reqeust');
 var http = require('http');
 var body = "";

exports.index = function(req, res){

    var options = {
        host: 'api.dev.com',
        port: 80,
        path: '/api/v1/posts',
        method: 'GET'
    };

    request(options, function(err, res, data) { //chunks are already aggregated
      console.log("Got response: " + res.statusCode);
      data = JSON.parse(data); // you need to parse the JSON-string into real object
      console.log(data); // inspect what you got
      res.render('index', { data: data });
    })  
}; 
```

确定需要`npm install request`，您已经安装了吗？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:31:09.450

`data`是一个包含对象的数组，试试

```
<%= data[0].title %> 
```

# asp.net - 如何传递日期时间参数？

> ID：14359566
> 
> 赞同：108
> 
> 时间：2013-01-16T13:28:13.817
> 
> 标签：asp.net, datetime, asp.net-web-api

如何将 UTC 日期传递给 Web API？

传递`2010-01-01`工作正常，但是当我传递一个 UTC 日期（例如`2014-12-31T22:00:00.000Z`（带有时间组件））时，我得到一个 HTTP 404 响应。所以

```
http://domain/api/controller/action/2012-12-31T22:00:00.000Z 
```

产生 404 错误响应，而

```
http://domain/api/controller/action/2012-12-31 
```

工作正常。

那么如何将 UTC 日期传递给 Web API - 或者至少指定日期*和*时间？

* * *

## 回答 #1

> 赞同：41
> 
> 时间：2015-10-26T12:04:03.630

问题是双重的：

### 1.`.`路线中

默认情况下，IIS 将所有带有点的 URI 视为静态资源，并尝试将其返回并完全跳过进一步处理（通过 Web API）。这是在您的 Web.config 部分中配置的`system.webServer.handlers`：默认处理程序句柄`path="*."`。您不会找到太多关于此`path`属性中奇怪语法的文档（正则表达式会更有意义），但这显然意味着“任何不包含点的东西”（以及下面第 2 点中的任何字符）。因此名称中的“无扩展” `ExtensionlessUrlHandler-Integrated-4.0`。

在我看来，按照“正确性”的顺序，可以有多种解决方案：

*   专门为必须允许点的路由添加一个新的处理程序。请务必在默认值*之前添加它。*为此，请确保首先*删除*默认处理程序，然后将其添加回来。
*   `path="*."`将属性更改为`path="*"`。然后它将捕获所有内容。请注意，从那时起，您的 web api 将不再将带有点的来电解释为静态资源！如果您在 Web api 上托管静态资源，因此不建议这样做！
*   将以下内容添加到您的 Web.config 以无条件处理所有请求：在`<system.webserver>`：`<modules runAllManagedModulesForAllRequests="true">`

### 2.`:`路线中

更改上述内容后，默认情况下，您会收到以下错误：

> 从客户端 (:) 检测到潜在危险的 Request.Path 值。

您可以更改 Web.config 中预定义的不允许/无效字符。在 下`<system.web>`，添加以下内容：`<httpRuntime requestPathInvalidCharacters="&lt;,&gt;,%,&amp;,*,\,?" />`。我已经`:`从无效字符的标准列表中删除了 。

### 更简单/更安全的解决方案

虽然不是您问题的答案，但更安全和更简单的解决方案是更改请求，以便不需要所有这些。这可以通过两种方式完成：

1.  将日期作为查询字符串参数传递，例如`?date=2012-12-31T22:00:00.000Z`.
2.  从`.000`每个请求中删除。您仍然需要允许`:`'s （cfr 点 2）。

* * *

## 回答 #2

> 赞同：33
> 
> 时间：2017-03-09T12:59:52.317

在您的产品 Web API 控制器中：

```
[RoutePrefix("api/product")]
public class ProductController : ApiController
{
    private readonly IProductRepository _repository;
    public ProductController(IProductRepository repository)
    {
        this._repository = repository;
    }

    [HttpGet, Route("orders")]
    public async Task<IHttpActionResult> GetProductPeriodOrders(string productCode, DateTime dateStart, DateTime dateEnd)
    {
        try
        {
            IList<Order> orders = await _repository.GetPeriodOrdersAsync(productCode, dateStart.ToUniversalTime(), dateEnd.ToUniversalTime());
            return Ok(orders);
        }
        catch(Exception ex)
        {
            return NotFound();
        }
    }
} 
```

在 Fiddler - Composer 中测试 GetProductPeriodOrders 方法：

```
http://localhost:46017/api/product/orders?productCode=100&dateStart=2016-12-01T00:00:00&dateEnd=2016-12-31T23:59:59 
```

日期时间格式：

```
yyyy-MM-ddTHH:mm:ss 
```

javascript传递参数使用moment.js

```
const dateStart = moment(startDate).format('YYYY-MM-DDTHH:mm:ss');
const dateEnd = moment(endDate).format('YYYY-MM-DDTHH:mm:ss'); 
```

* * *

## 回答 #3

> 赞同：19
> 
> 时间：2014-03-01T05:22:54.870

我感觉到你的痛苦......另一种日期时间格式......正是你所需要的！

使用 Web Api 2，您可以使用路由属性来指定参数。

因此，使用您的类和方法上的属性，您可以使用您遇到问题的这种 utc 格式编写一个 REST URL（显然是它的 ISO8601，大概是使用 startDate.toISOString() 到达的）

```
[Route(@"daterange/{startDate:regex(^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$)}/{endDate:regex(^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}.\d{3}Z$)}")]
    [HttpGet]
    public IEnumerable<MyRecordType> GetByDateRange(DateTime startDate, DateTime endDate) 
```

....但是，虽然这适用于一个日期（startDate），但由于某种原因，当 endDate 采用这种格式时它不起作用......调试了几个小时，唯一的线索是异常说它不喜欢冒号“：”（甚至虽然 web.config 设置为：

```
<system.web>
    <compilation debug="true" targetFramework="4.5.1" />
    <httpRuntime targetFramework="4.5.1" requestPathInvalidCharacters="" />
</system.web> 
```

因此，让我们制作另一种日期格式（取自 ISO 日期格式的 polyfill）并将其添加到 Javascript 日期（为简洁起见，仅转换为分钟）：

```
if (!Date.prototype.toUTCDateTimeDigits) {
    (function () {

        function pad(number) {
            if (number < 10) {
                return '0' + number;
            }
            return number;
        }

        Date.prototype.toUTCDateTimeDigits = function () {
            return this.getUTCFullYear() +
              pad(this.getUTCMonth() + 1) +
              pad(this.getUTCDate()) +
              'T' +
              pad(this.getUTCHours()) +
              pad(this.getUTCMinutes()) +
              'Z';
        };

    }());
} 
```

然后，当您将日期发送到 Web API 2 方法时，您可以将它们从字符串转换为日期：

```
[RoutePrefix("api/myrecordtype")]
public class MyRecordTypeController : ApiController
{

    [Route(@"daterange/{startDateString}/{endDateString}")]
    [HttpGet]
    public IEnumerable<MyRecordType> GetByDateRange([FromUri]string startDateString, [FromUri]string endDateString)
    {
        var startDate = BuildDateTimeFromYAFormat(startDateString);
        var endDate = BuildDateTimeFromYAFormat(endDateString);
    ...
    }

    /// <summary>
    /// Convert a UTC Date String of format yyyyMMddThhmmZ into a Local Date
    /// </summary>
    /// <param name="dateString"></param>
    /// <returns></returns>
    private DateTime BuildDateTimeFromYAFormat(string dateString)
    {
        Regex r = new Regex(@"^\d{4}\d{2}\d{2}T\d{2}\d{2}Z$");
        if (!r.IsMatch(dateString))
        {
            throw new FormatException(
                string.Format("{0} is not the correct format. Should be yyyyMMddThhmmZ", dateString)); 
        }

        DateTime dt = DateTime.ParseExact(dateString, "yyyyMMddThhmmZ", CultureInfo.InvariantCulture, DateTimeStyles.AssumeUniversal);

        return dt;
    } 
```

所以网址是

```
http://domain/api/myrecordtype/daterange/20140302T0003Z/20140302T1603Z 
```

Hanselman 在这里提供了一些相关信息：

[http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx](http://www.hanselman.com/blog/OnTheNightmareThatIsJSONDatesPlusJSONNETAndASPNETWebAPI.aspx)

* * *

## 回答 #4

> 赞同：12
> 
> 时间：2019-07-02T12:22:42.190

作为 s k 答案的类似替代方法，我可以[`Date.prototype.toISOString()`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString)在查询字符串中传递一个由 格式化的日期。这是标准的 ISO 8601 格式，它被 .Net Web API 控制器接受，无需对路由或操作进行任何额外配置。

例如

```
var dateString = dateObject.toISOString(); // "2019-07-01T04:00:00.000Z" 
```

* * *

## 回答 #5

> 赞同：7
> 
> 时间：2016-02-19T20:18:38.807

这是一个解决方案和可能解决方案的模型。在客户端中使用 Moment.js 格式化日期，转换为 unix 时间。

```
 $scope.startDate.unix() 
```

将您的路线参数设置为长。

```
[Route("{startDate:long?}")]
public async Task<object[]> Get(long? startDate)
{
    DateTime? sDate = new DateTime();

        if (startDate != null)
        {
            sDate = new DateTime().FromUnixTime(startDate.Value); 
        }
        else
        {
            sDate = null;
        }
         ... your code here!
  } 
```

为 Unix 时间创建一个扩展方法。[Unix 日期时间方法](https://stackoverflow.com/questions/249760/how-to-convert-a-unix-timestamp-to-datetime-and-vice-versa)

* * *

## 回答 #6

> 赞同：4
> 
> 时间：2016-09-17T08:01:37.707

这曾经是一项痛苦的任务，但现在我们可以使用 toUTCString()：

例子：

```
[HttpPost]
public ActionResult Query(DateTime Start, DateTime End) 
```

将以下内容放入 Ajax 发布请求中

```
data: {
    Start: new Date().toUTCString(),
    End: new Date().toUTCString()
}, 
```

* * *

## 回答 #7

> 赞同：3
> 
> 时间：2013-01-16T15:30:48.043

事实上，将参数明确指定为 ?date='fulldatetime' 就像一个魅力。所以现在这将是一个解决方案：不要使用逗号，而是使用旧的 GET 方法。

* * *

## 回答 #8

> 赞同：3
> 
> 时间：2020-07-20T08:09:43.420

一种可能的解决方案是使用 Ticks：

公共长滴答{得到; }

然后在控制器的方法中：

公共日期时间（长滴答声）；

* * *

## 回答 #9

> 赞同：0
> 
> 时间：2020-05-12T01:39:27.667

通过查看您的代码，我假设您不关心 DateTime 对象的“时间”。如果是这样，您可以将日期、月份和年份作为整数参数传递。请看下面的代码。这是我当前项目的一个工作示例。

优点是；这种方法可以帮助我避免 DateTime 格式问题和文化不兼容问题。

```
 /// <summary>
    /// Get Arrivals Report Seven Day Forecast
    /// </summary>
    /// <param name="day"></param>
    /// <param name="month"></param>
    /// <param name="year"></param>
    /// <returns></returns>
    [HttpGet("arrivalreportsevendayforecast/{day:int}/{month:int}/{year:int}")]
    public async Task<ActionResult<List<ArrivalsReportSevenDayForecastModel>>> GetArrivalsReportSevenDayForecast(int day, int month, int year)
    {
        DateTime selectedDate = new DateTime(year, month, day);
        IList<ArrivalsReportSevenDayForecastModel> arrivingStudents = await _applicationService.Value.GetArrivalsReportSevenDayForecast(selectedDate);
        return Ok(arrivingStudents);
    } 
```

如果您也热衷于查看前端，请随时阅读下面的代码。不幸的是，这是用 Angular 编写的。这就是我通常在 Angular GET 请求中将 DateTime 作为查询参数传递的方式。

```
public getArrivalsReportSevenDayForecast(selectedDate1 : Date): Observable<ArrivalsReportSevenDayForecastModel[]> {
const params = new HttpParams();
const day = selectedDate1.getDate();
const month = selectedDate1.getMonth() + 1
const year = selectedDate1.getFullYear();

const data = this.svcHttp.get<ArrivalsReportSevenDayForecastModel[]>(this.routePrefix +
  `/arrivalreportsevendayforecast/${day}/${month}/${year}`, { params: params }).pipe(
  map<ArrivalsReportSevenDayForecastModel[], ArrivalsReportSevenDayForecastModel[]>(arrivingList => {
    // do mapping here if needed       
    return arrivingList;
  }),
  catchError((err) => this.svcError.handleError(err)));

return data;
} 
```

* * *

## 回答 #10

> 赞同：0
> 
> 时间：2020-04-24T00:54:55.197

由于我对 ISO-8859-1 操作系统进行了编码，因此无法识别日期格式“dd.MM.yyyy HH:mm:sss”的工作是使用 InvariantCulture 字符串。

```
string url = "GetData?DagsPr=" + DagsProfs.ToString(CultureInfo.InvariantCulture) 
```

* * *

## 回答 #11

> 赞同：0
> 
> 时间：2022-02-18T15:12:28.557

将日期作为字符串传递，然后解析它对我有用。可能想在解析中添加try catch，但这是基本代码。

```
[HttpGet("name={name}/date={date}", Name = "GetByNameAndDate")]
public IActionResult GetByNameAndDate(string name, string date) {
    DateTimeOffset dto = DateTimeOffset.Parse(date);
} 
```

然后请求看起来像这样

```
https://localhost/api/Contoller/name=test/date=2022-02-18T13:45:37.000Z 
```

# windows-phone-8 - 如何在地图 windows phone 8 中添加工具提示？

> ID：14359572
> 
> 赞同：0
> 
> 时间：2013-01-16T13:28:32.427
> 
> 标签：windows-phone-8

我的 Windows 8 手机应用程序使用 mapoverlay 以编程方式将图像（作为图钉）添加到地图中的特定坐标。现在我想在点击它后向图像（图钉）添加一个工具提示。有谁知道如何解决这一问题？

```
pinIMG = new Image();
                pinIMG.Source = new System.Windows.Media.Imaging.BitmapImage(new Uri("/Assets/pin.png", UriKind.Relative));

MapOverlay myLocationOverlay = new MapOverlay();
                myLocationOverlay.Content = pinIMG;
                myLocationOverlay.PositionOrigin = new Point(0.5, 0.5);
                myLocationOverlay.GeoCoordinate = new GeoCoordinate(57.724611, 12.938945);

MapLayer myLocationLayer = new MapLayer();
myLocationLayer.Add(myLocationOverlay);
MyMap.Layers.Add(myLocationLayer); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T19:07:53.323

不要将 Image 添加到 MapOverlay，而是考虑添加 ExpanderView 控件，该控件可展开以添加其他数据。您需要下载[Windows Phone Toolkit](http://phone.codeplex.com)才能获得[ExpanderView](http://phone.codeplex.com/SourceControl/changeset/view/80797#1336207)控件。当您使用它时，您可能希望切换到使用[Map Extensions Pushpins](http://phone.codeplex.com/SourceControl/changeset/view/80797#1336302)来获得数据绑定支持。

```
private void MainPage_Loaded(object sender, RoutedEventArgs e)
{
    MapLayer myLayer = new MapLayer();
    MapOverlay myOverlay = new MapOverlay()
                            {
                                GeoCoordinate = new GeoCoordinate(-17, 133)
                            };
    ExpanderView expander = new ExpanderView();

    expander.Header = new Image()
    {
        Source = new BitmapImage(new Uri("Assets/ApplicationIcon.png", UriKind.Relative)),
        Width = 200
    };
    expander.ItemsSource = new[]
    {
        new TextBlock{ Text = "HELLO"}
    }; 
```

;

```
 myOverlay.Content = expander;
    myLayer.Add(myOverlay);
    myMap.Layers.Add(myLayer);
} 
```

当我们运行这个示例时，我们可以在澳大利亚看到以下图标：

![在澳大利亚的图标](../Images/c58fd84f435c8ecbc5febbf6ac2a620f.png)

一旦我们点击 ti，我们可以看到我们的“Hello”文本出现：

![澳大利亚的文字](../Images/62ce436c558dc96b9523b8fcc1622a12.png)

一些警告：上面的代码示例很糟糕。ExpanderView 旨在将 ItemSource 和 ItemTemplate 用于多个项目数据绑定。将它用于单个项目并不是很好。上面的代码示例也很糟糕，因为它在 C# 代码中创建 UI 元素，而使用 Map Extensions 可以将此代码放在 XAML 中。

# android - 相对布局的 layout_weight 不起作用

> ID：14359580
> 
> 赞同：1
> 
> 时间：2013-01-16T13:28:49.447
> 
> 标签：android

有以下代码：

```
 <LinearLayout
            android:layout_width="match_parent"
            android:layout_height="0dip"
            android:layout_weight="0.9"
            android:gravity="center"
            android:orientation="horizontal" >

            <TextView
                android:id="@+id/activityEvaluationYesterdayValueDisplay"
                android:layout_width="15dip"
                android:layout_height="wrap_content"
                android:text="0"
                android:textAppearance="?android:attr/textAppearanceMedium"
                android:textStyle="bold" />

            <com.ulnda.mypsych.views.VerticalSeekBar
                android:id="@+id/activityEvaluationYesterdayValue"
                android:layout_width="wrap_content"
                android:layout_height="match_parent"
                android:layout_gravity="center"
                android:max="10"
                android:progress="0" />
        </LinearLayout> 
```

现在我需要将 LinearLayout 更改为 RelativeLayout。如果我这样做，那么 RelativeLayout 会填满整个屏幕，这很糟糕。我了解 RelativeLayout 不使用 layout_weight 进行工作。请告诉我，我该如何解决？我试图为RelativeLayout 制作LinearLayout 包装器，但它没有帮助。

更新：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <LinearLayout
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="0.6"
        android:orientation="vertical" >

        <RelativeLayout
            android:background="#000000"
            android:layout_width="match_parent"
            android:layout_height="match_parent" >
        </RelativeLayout>

    </LinearLayout>

</LinearLayout>
UPDATE 2: FUll code
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical" >

    <TableLayout
        android:layout_width="match_parent"
        android:layout_height="match_parent" >

        <TableRow
            android:id="@+id/tableRow1"
            android:layout_width="match_parent"
            android:layout_height="0dip"
            android:layout_weight="0.5" >

            <LinearLayout
                android:weightSum="1.0"
                android:layout_width="0dip"
                android:layout_height="match_parent"
                android:layout_weight="0.33"
                android:orientation="vertical" >

                <RelativeLayout
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.9">

                    <TextView
                        android:id="@+id/activityEvaluationYesterdayValueDisplay"
                        android:layout_width="15dip"
                        android:layout_height="wrap_content"
                        android:text="0"
                        android:layout_centerVertical="true"
                        android:layout_toLeftOf="@+id/activityEvaluationYesterdayValue"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textStyle="bold" />

                    <com.ulnda.mypsych.views.VerticalSeekBar
                        android:id="@+id/activityEvaluationYesterdayValue"
                        android:layout_width="wrap_content"
                        android:layout_height="match_parent"
                        android:layout_centerInParent="true"
                        android:max="10"
                        android:progress="0" />
                </RelativeLayout>

                <TextView
                    android:id="@+id/TextView05"
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.1"
                    android:gravity="center"
                    android:text="Yesterday"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textStyle="bold" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="0dip"
                android:layout_height="match_parent"
                android:layout_weight="0.33"
                android:orientation="vertical" >

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.9"
                    android:gravity="center"
                    android:orientation="horizontal" >

                    <TextView
                        android:id="@+id/activityEvaluationTodayValueDisplay"
                        android:layout_width="20dip"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:text="0"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textStyle="bold" />

                    <com.ulnda.mypsych.views.VerticalSeekBar
                        android:id="@+id/activityEvaluationTodayValue"
                        android:layout_width="wrap_content"
                        android:layout_height="match_parent"
                        android:max="10"
                        android:progress="0" />
                </LinearLayout>

                <TextView
                    android:id="@+id/TextView03"
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.1"
                    android:gravity="center"
                    android:text="Today"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textStyle="bold" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="0dip"
                android:layout_height="match_parent"
                android:layout_weight="0.33"
                android:orientation="vertical" >

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.9"
                    android:gravity="center"
                    android:orientation="horizontal" >

                    <TextView
                        android:id="@+id/activityEvaluationTomorrowValueDisplay"
                        android:layout_width="20dip"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:text="0"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textStyle="bold" />

                    <com.ulnda.mypsych.views.VerticalSeekBar
                        android:id="@+id/activityEvaluationTomorrowValue"
                        android:layout_width="wrap_content"
                        android:layout_height="match_parent"
                        android:max="10"
                        android:progress="0" />
                </LinearLayout>

                <TextView
                    android:id="@+id/TextView02"
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.1"
                    android:gravity="center"
                    android:text="Tomorrow"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textStyle="bold" />
            </LinearLayout>
        </TableRow>

        <TableRow
            android:id="@+id/tableRow2"
            android:layout_width="wrap_content"
            android:layout_height="0dip"
            android:layout_weight="0.5" >

            <LinearLayout
                android:layout_width="0dip"
                android:layout_height="match_parent"
                android:layout_weight="0.33"
                android:orientation="vertical" >

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.9"
                    android:gravity="center"
                    android:orientation="horizontal" >

                    <TextView
                        android:id="@+id/activityEvaluationEnergyValueDisplay"
                        android:layout_width="20dip"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:text="0"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textStyle="bold" />

                    <com.ulnda.mypsych.views.VerticalSeekBar
                        android:id="@+id/activityEvaluationEnergyValue"
                        android:layout_width="wrap_content"
                        android:layout_height="match_parent"
                        android:max="10"
                        android:progress="0" />
                </LinearLayout>

                <TextView
                    android:id="@+id/TextView11"
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.1"
                    android:gravity="center"
                    android:text="Energy"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textStyle="bold" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="0dip"
                android:layout_height="match_parent"
                android:layout_weight="0.33"
                android:orientation="vertical" >

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.9"
                    android:gravity="center"
                    android:orientation="horizontal" >

                    <TextView
                        android:id="@+id/activityEvaluationWeatherValueDisplay"
                        android:layout_width="20dip"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:text="0"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textStyle="bold" />

                    <com.ulnda.mypsych.views.VerticalSeekBar
                        android:id="@+id/activityEvaluationWeatherValue"
                        android:layout_width="wrap_content"
                        android:layout_height="match_parent"
                        android:max="10"
                        android:progress="0" />
                </LinearLayout>

                <TextView
                    android:id="@+id/TextView09"
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.1"
                    android:gravity="center"
                    android:text="Weather"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textStyle="bold" />
            </LinearLayout>

            <LinearLayout
                android:layout_width="0dip"
                android:layout_height="match_parent"
                android:layout_weight="0.33"
                android:orientation="vertical" >

                <LinearLayout
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.9"
                    android:gravity="center"
                    android:orientation="horizontal" >

                    <TextView
                        android:id="@+id/activityEvaluationHoursSleptValueDisplay"
                        android:layout_width="20dip"
                        android:layout_height="wrap_content"
                        android:layout_gravity="center"
                        android:text="0"
                        android:textAppearance="?android:attr/textAppearanceMedium"
                        android:textStyle="bold" />

                    <com.ulnda.mypsych.views.VerticalSeekBar
                        android:id="@+id/activityEvaluationHoursSleptValue"
                        android:layout_width="wrap_content"
                        android:layout_height="match_parent"
                        android:max="10"
                        android:progress="0" />
                </LinearLayout>

                <TextView
                    android:id="@+id/TextView07"
                    android:layout_width="match_parent"
                    android:layout_height="0dip"
                    android:layout_weight="0.1"
                    android:gravity="center"
                    android:text="Hours Slept"
                    android:textAppearance="?android:attr/textAppearanceMedium"
                    android:textStyle="bold" />
            </LinearLayout>
        </TableRow>
    </TableLayout>

</LinearLayout> 
```

为什么 RelativeLayout 填满整个屏幕，而不是 0.6 ？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:29:32.817

`android:layout_weight`仅对 有意义`LinearLayout`。Lint 应该通过警告通知您

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:52:00.547

`RelativeLayout``layout_weight`是唯一一个具有属性的孩子，因此您还应该指定`weightSum`：

```
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:layout_width="match_parent"
    android:layout_height="match_parent"
    android:orientation="vertical"
    android:weightSum="1">

    <RelativeLayout
        android:background="#ff0000"
        android:layout_width="match_parent"
        android:layout_height="0dip"
        android:layout_weight="0.6">

    </RelativeLayout>
</LinearLayout> 
```

# java - 带有progressBar 和Slider 的JavaFX 图形错误

> ID：14359596
> 
> 赞同：5
> 
> 时间：2013-01-16T13:29:42.247
> 
> 标签：java, user-interface, javafx

我正在编写一个小型应用程序（具有功能的音频播放器）；我使用滑块和进度条来显示当前曲目的进度。但是当轨道改变时，progressBar 和 Slider 占据旧位置（随机机会）；

![您可以在歌曲进度中看到它](../Images/6cd9d893dcd07f4fe3e351cc5bffe62a.png)

这是fxml的代码：

```
<StackPane layoutY="64.0" prefHeight="20.0" prefWidth="492.0" AnchorPane.leftAnchor="26.0"     AnchorPane.rightAnchor="24.0">
  <children>
<ProgressBar id="progress" fx:id="progressBar" cache="true" cacheHint="QUALITY" disable="true" maxHeight="-1.0" maxWidth="1.7976931348623157E308" minHeight="-Infinity" minWidth="-Infinity" opacity="1.0" prefHeight="9.0" prefWidth="-1.0" progress="0.0" />
<Slider fx:id="progressSlider" disable="false" opacity="1.0" value="0.0" />
  </children>
</StackPane> 
```

当新轨道覆盖旧图形时，它就消失了。

有谁能够帮助我？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-18T17:20:30.520

我解决了这个问题。我不得不从 JavaFX 线程调用新的 JavaFX 线程；

```
Platform.runLater(new Runnable(){......}); 
```

# batch-file - 使用参数在另一个 .bat 中调用 .bat 文件

> ID：14359598
> 
> 赞同：0
> 
> 时间：2013-01-16T13:29:48.750
> 
> 标签：batch-file, ftp, cmd, 7zip

我需要将 zip 文件上传到 FTP 服务器。

我的第一个文件如下所示：

```
sqlcmd -S .\SQLEXPRESS -U <user> -P <pass> -i c:\sql_script.sql
7za a -tzip %~dp0\Archive\Backup_daily_full.zip *.bak -v100m 
```

为了上传单个文件，我创建了这个：

```
@echo off
echo user {user}> ftpcmd.dat
echo {pass}>> ftpcmd.dat
echo put %1>> ftpcmd.dat
echo quit>> ftpcmd.dat
ftp -n -s:ftpcmd.dat  {server} 
```

我不知道备份后我将拥有多少个 .zip 文件，以及如何将它们全部上传到 FTP 上（如何在主 .bat 中调用该文件），或者如何一次简单地上传它们。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:15:05.490

您可以遍历文件夹中的所有 .zip 文件，并为每个文件运行 ftp 脚本。

```
@echo off
for /r %~dp0\Archive %%a in (*.zip) do (
echo user {user}> ftpcmd.dat
echo {pass}>> ftpcmd.dat
echo put %%a>> ftpcmd.dat
echo quit>> ftpcmd.dat
ftp -n -s:ftpcmd.dat  {server}
) 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:31:58.230

在您的第一个文件中添加第三行：

```
cmd /c <your-ftp-script>.bat <zip-file-name> 
```

至于遍历 zip 文件列表，按照手册中的说明进行操作（cmd /？）：

> FOR /R [[drive:]path] %variable IN (set) DO command [command-parameters]
> 
> 遍历以 [drive:]path 为根的目录树，在树的每个目录中执行 FOR 语句。如果在 /R 之后没有指定目录规范，则假定为当前目录。如果 set 只是一个句点 (.) 字符，那么它只会枚举目录树。

因此，将您的压缩备份文件存储在一个干净的位置，然后用于`for /r`遍历列表，循环调用您的第二个 bat 文件。

# eclipse - Eclipse 插件开发：如何获取有关 Eclipse 插件安装/更新的事件

> ID：14359599
> 
> 赞同：1
> 
> 时间：2013-01-16T13:29:53.363
> 
> 标签：eclipse, eclipse-plugin

我正在开发一个自定义 eclipse 插件。我的要求是在 eclipse 插件安装或更新完成时获得一个事件。

它可以在 eclipse 重启之前或 eclipse 重启之后。

在插件安装的情况下，我需要一个事件，因为插件安装成功，我想显示成功安装的自定义消息。

在插件更新的情况下，我需要一个事件来对我的一些工作空间文件进行一些更改。

请建议我如何知道安装/更新已完成以及从哪里可以调用我的程序。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-09-30T10:21:25.787

我认为您无法获得插件安装事件，因为安装需要重新启动 Eclipse 注册表更新才能生效。

对于第二部分（插件更新后），您可以将当前版本保留在某个工作区文件中（例如首选项），然后在插件启动时检查当前插件版本是否大于工作区中的版本，然后采取一些措施。

# backbone.js - Backbone.js - 将数据从一个视图移动到另一个视图

> ID：14359601
> 
> 赞同：0
> 
> 时间：2013-01-16T13:29:55.437
> 
> 标签：backbone.js

如何将数据从一个视图发送到另一个位于不同 url 上的视图？

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T06:29:11.977

一个有点奇怪的问题，但是好的，让我们试着把你的问题想象成复杂的并给出答案。

1.  想象一下阅读书籍的应用程序（如网络中的 iBooks）。我们有一个名为 ApplicationView 的父视图，它创建了几个子视图，其中一些是 BookshelfView（在#bookshelf url 上可用）和 BookView（在#book/:id url 上可用）。

    现在，您从 BookView 将您的书标记为未读，并且您知道 BookshelfView 应该改变这本书的外观。好的，这不是“将数据从一个视图移动到另一个视图”。您只需更改模型的状态，您的视图就会捕获此“更改”事件并更新其 html。

2.  让我们描述更复杂的情况。想象一下相同的应用程序。但此时您决定将纵向切换为横向。您在一个视图中进行，并且希望此更改影响其他应用程序视图。这可以通过多种方式完成：

    *   视图应该保持[松散耦合，](http://en.wikipedia.org/wiki/Loose_coupling)您应该使用某种[中介模式](http://en.wikipedia.org/wiki/Mediator_pattern)。
    *   从 Backbone 0.9.9 开始，您可以使用全局 Backbone 对象作为中介，因为 Backbone 支持事件接口
    *   您可以在两个或多个视图之间为中介创建附加模型，但有更漂亮的解决方案：
    *   如果您有多个子视图的一个父视图，则您已经拥有该调解器。只需从一个视图向父视图发送事件，然后从另一个视图在父视图上收听该事件。

我也建议你检查[这个问题](https://stackoverflow.com/questions/14367037/how-should-2-seemingly-independent-views-under-the-same-parent-interact)

# iphone - 如何在绘图中实现擦除功能，以便用户可以清除所有绘图

> ID：14359605
> 
> 赞同：2
> 
> 时间：2013-01-16T13:30:03.067
> 
> 标签：iphone, ios5, ios6, objective-c-blocks

我正在使用 CoreGraphics 在背景图像上实现自由手绘，这对我来说工作正常，现在我想为此绘图实现擦除功能，以便用户可以清除他的绘图

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:36:04.210

如果您只想清除屏幕，请删除您创建的 CGPath，它不会绘制任何内容。

如果你想让使用切换到橡皮擦工具并且只擦除某些东西，你需要设置一个新的绘图类，让你在其他绘图上绘制背景或调整你必须不绘制交叉点的类在原始路径和橡皮擦路径之间。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:52:51.223

您可以在 UITouch 方法“touchesMoved”中使用它来清除您绘制的路径

`UITouch *touch = [[event allTouches] anyObject];

currenttouch = [触摸 locationInView:drawingImageView];

```
CGColorRef strokeColor = [UIColor blackColor].CGColor;

UIGraphicsBeginImageContext(drawingImageView.frame.size);

    CGContextRef context = UIGraphicsGetCurrentContext();

    [drawingImageView.image drawInRect:CGRectMake(0, 0, drawingImageView.frame.size.width, drawingImageView.frame.size.height)];

    CGContextSetLineCap(context, kCGLineCapRound);

    CGContextSetLineWidth(context, brushSize);

    CGContextSetStrokeColorWithColor(context, strokeColor);

    CGContextSetBlendMode(context, kCGBlendModeClear);

    CGContextBeginPath(context);

    CGContextMoveToPoint(context, currenttouch.x, currenttouch.y);

    CGContextAddLineToPoint(context, currenttouch.x, currenttouch.y);

    CGContextStrokePath(context);

    drawingImageView.image = UIGraphicsGetImageFromCurrentImageContext();

    UIGraphicsEndImageContext(); 
```

`

# c++ - 线程同步 - 关键部分或互斥锁？

> ID：14359608
> 
> 赞同：1
> 
> 时间：2013-01-16T13:30:17.103
> 
> 标签：c++, sockets, networking, synchronization, mutex

如果我需要同步两个线程，这两个线程都在特定套接字上使用 send() 调用函数，那么扭曲 send() 函数的关键部分或研究使用互斥锁会更有用吗？（因为套接字是内核对象）

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:43:53.713

假设 Windows 平台（这就是我们在临界区和互斥体之间进行选择的地方）。

Mutex (of `CreateMutex`) 要慢得多：锁定和解锁始终是系统调用，即使没有争用。不过，的成本`send`可能足以使这种差异不明显。

正如另一个答案所指出的，互斥锁可以在进程之间共享（如果命名/重新打开或继承），并且关键部分是进程本地的。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:40:06.550

我假设这是关于 Windows 的（不记得在其他地方看到过关键部分）。

如果所有锁定都在一个进程中，那么使用哪个同步对象并不重要。如果要跨进程边界锁定，则应使用互斥锁，因为临界区仅在单个进程内有效，但命名互斥锁可以在多个进程之间共享。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-16T13:36:49.547

我认为，互斥锁应该工作得更快。

# php - PHP 支持的多项目问题跟踪器

> ID：14359613
> 
> 赞同：0
> 
> 时间：2013-01-16T13:30:36.223
> 
> 标签：php, wiki, issue-tracking, multiple-projects

我一直在寻找一个支持多个项目并拥有 wiki 的问题跟踪器。

我找到了符合我需要的 Redmine 和 Trac，但我需要一个用 PHP 编写的。

我看了一下 MantisBT，但这并不是我所追求的。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:45:02.600

[Traq](http://traq.io)似乎可以满足您的需求、PHP（5.3+ 版）、多个项目和 wiki。

# javascript - 使复选框像可复制输入字段中的单选按钮一样

> ID：14359615
> 
> 赞同：1
> 
> 时间：2013-01-16T13:30:50.567
> 
> 标签：javascript, jquery

我正在创建一个包含复选框的可复制 div，目前在原始输入集上，复选框的作用类似于单选按钮，但是在复制时它仍然只适用于第一个而不是第二个。

同样在提交时，它只为控制台中的原始表单返回一个值，但没有任何重复的值。

非常感谢任何帮助。

JS 小提琴：http: [//jsfiddle.net/dawidvdh/EEd7c/](http://jsfiddle.net/dawidvdh/EEd7c/)

jQuery：

```
//Clone Tracking
var g_counter = 1;
var d_counter = 1;
var dependant = ["dependant"];
var group;
//Clone Tracking
//General Variables
var relation_input_groups = ["relation-group-1"];
//General Variables
//Generate variables
var relation_fields=[0];
var relation_input ="<label>Spouse</label>"+

    "<input type='checkbox' value='spouse' class='relationship' name='relationship' />" +
    "<label>own child</label>"+ 

    "<input type='checkbox' value='ownchild' class='relationship' name='relationship' />" +
    "<label>adopted</label>"+ 

    "<input type='checkbox' value='adopted' class='relationship' name='relationship' />" +
    "<label>stepchild</label>"+ 

    "<input type='checkbox' value='stepchild' class='relationship' name='relationship' />" +
    "<label>parent</label>"+ 

    "<input type='checkbox' value='parent' class='relationship' name='relationship' />" +
    "<label>inlaw</label>"+ 

    "<input type='checkbox' value='inlaw' class='relationship' name='relationship' />" +
    "<label>brother</label>"+ 

    "<input type='checkbox' value='brother' class='relationship' name='relationship' />" +
    "<label>other</label>"+ 

    "<input type='checkbox' value='other' class='relationship' name='relationship' />";
//Generate variables
jQuery(document).ready(function(e) 
{
    //populate jquery generated fields
    jQuery(relation_fields).each(function() 
    {
        jQuery(relation_input).appendTo('#relation-group-1');
    });
    //populate jquery generated fields
    //Cloning Function
    jQuery('#clone').click(function() 
    {
        clone_dependant();
    });
    function clone_dependant() 
    {
        // Store the value of the previous Id to insert the cloned div..
        var oldId = g_counter;
        g_counter++;
        currentdep ='dependant-'+g_counter;
        // Clone the Dependant Div and set a new id
        var $clonedDiv = jQuery('#dependant-1').clone(false).attr('id', 'dependant-'+g_counter);
        var relation_newDiv = 'relation-group-'+ g_counter;
        // Find div's inside the cloned object and set a new id's
        $clonedDiv.find('#relation-group-1').attr('id',"relation-group-" + g_counter );
        // You don't need to Loop thru the inputs to set the value
        $clonedDiv.find('input').val('');
        $clonedDiv.find('input:checkbox').removeAttr('checked');
        // Insert the cloned object 
        $clonedDiv.insertAfter("#dependant-" + oldId);

        relation_input_groups.push(relation_newDiv);
    }
    //Cloning Function
    //Validation
    //submit function
    var $unique = $('input[type="checkbox"]');
    $unique.click(function() 
    {
        $unique.removeAttr('checked');
        $(this).attr('checked', true);
    });

    var result = {};
    var dependants;
    var dep_counter = 0;
    jQuery('#submit').click(function()
    {
        jQuery('.dependant').each(function(k, v)
        {
            dep_counter++
            dependants = {};
            result['dependant'+dep_counter] = [dependants];
            dependants['relationship'] = $(v).find('.relationship:checked').val();
        });
        var jsonData = JSON.stringify(result);
        console.log(jsonData);
    });
}); 
```

和 HTML：

```
<div id="dependant-1" class="dependant">
    <div id="label">relationship:</div> <div id="relation-group-1"></div>
</div>

<button id="clone">clone</button>
<button id="submit">submit</button> 
```

提前致谢 ：）

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:43:38.480

看到这个：http: [//jsfiddle.net/EEd7c/1/](http://jsfiddle.net/EEd7c/1/)

```
var $unique = $('input[type="checkbox"]');
$unique.live("click", function() {
$(this).siblings().removeAttr('checked');
$(this).attr('checked', true);
}); 
```

然而 Live 已被弃用...

或者

```
$(document).on("click", 'input[type="checkbox"]', function() {
$(this).siblings().removeAttr('checked');
$(this).attr('checked', true);
}); 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:40:01.337

```
var $unique = $('input[type="checkbox"]');
$unique.live('click',function() {
    $(this).closest('div').find('input[type="checkbox"]').removeAttr('checked');
    $(this).attr('checked', true);
}); 
```

用于将`live`事件处理程序注册到动态创建的元素。$unique 变量将仅包含初始复选框集。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:36:54.460

它不起作用的原因是您没有将点击事件附加到新的克隆元素。

```
$(document).on("click", 'input[type="checkbox"]', function() {
    jQuery(this).siblings(":checked").removeAttr('checked');
}); 
```

# .net - 如何在 VB.net 中将日期转换为格式化字符串？

> ID：14359616
> 
> 赞同：23
> 
> 时间：2013-01-16T13:30:51.593
> 
> 标签：.net, vb.net, date, datetime, type-conversion

这里似乎有一百万个关于将字符串转换为日期的问题，但反之亦然。当我使用将 Date 对象转换为字符串`mydate.toString`时，我得到一个格式为 的字符串`16/01/2013 13:00:00`。

但我真正想要的是`2013-01-16 13:00:00`。我在 Date 对象上看不到任何为我执行此操作的函数，我是否需要使用正则表达式或其他东西？

* * *

## 回答 #1

> 赞同：43
> 
> 时间：2013-01-16T13:34:05.107

您可以使用 ToString 重载。查看[此页面](http://msdn.microsoft.com/en-us/library/zdtaw1bw.aspx)以获取更多信息

所以只需使用`myDate.ToString("yyyy-MM-dd HH:mm:ss")`

或等效的东西

* * *

## 回答 #2

> 赞同：11
> 
> 时间：2013-01-16T13:38:06.137

您可以使用 format 函数来完成，这是一个示例：

```
Format(mydate, "yyyy-MM-dd HH:mm:ss") 
```

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2013-01-16T21:07:52.643

我喜欢：

```
Dim timeFormat As String = "yyyy-MM-dd HH:mm:ss"
myDate.ToString(timeFormat) 
```

如果您需要在代码的多个部分中使用它，则易于维护，日期格式似乎迟早会发生变化。

* * *

## 回答 #4

> 赞同：5
> 
> 时间：2013-01-16T13:39:17.680

```
myDate.ToString("yyyy-MM-dd HH:mm:ss") 
```

大写 HH 是您指定的 24 小时格式

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2014-07-02T20:20:12.253

```
Dim timeFormat As String = "yyyy-MM-dd HH:mm:ss"
objBL.date = Convert.ToDateTime(txtDate.Value).ToString(timeFormat) 
```

# regex - Perl 正则表达式 | 匹配右数第二个

> ID：14359617
> 
> 赞同：1
> 
> 时间：2013-01-16T13:30:52.957
> 
> 标签：regex, perl

我正在尝试解析 OID 并提取 #18，但我不确定如何编写它以使用点作为分隔符从右到左计数：

```
1.3.6.1.2.1.31.1.1.1.18.10035 
```

此正则表达式将获取最后一个值

```
my $ifindex = ($_=~ /^.*[.]([^.]*)$/); 
```

我还没有找到一种方法来调整它以获得我需要的价值。

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:36:47.943

怎么样：

```
my $str = "1.3.6.1.2.1.31.1.1.1.18.10035";
say ((split(/\./, $str))[-2]); 
```

**输出：**

```
18 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T13:38:25.053

如果格式始终相同（即始终从右数第二个），那么您可以使用：-

```
m/(\d+)\.\d+$/; 
```

..答案最终会是：`$1`

或者另一种方法是将字符串拆分为点上的数组并检查数组中的倒数第二个值。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:35:45.833

你需要的更简单：

```
my $ifindex;

if (/(\d+)\.\d+$/)
{
   $ifindex = $1;
} 
```

一些评论：

1.  您不需要匹配整个字符串，只需匹配您关心的部分。因此，无需锚定到开头`^`并使用`.*`. 只锚定到最后。
2.  `[.]`是一个字符类，用于匹配字符组。例如，`[abc]`将匹配 a、b 或 c。匹配单个字符时应避免；只需匹配该字符即可。在这种情况下，您确实需要对其进行转义，因为它是一个特殊字符：`\.`.
3.  根据您的示例，我假设所有术语都必须是数字。因此，我使用`\d+`了这些术语。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:36:09.987

```
my $ifindex = ($_=~ /^.*[.]([^.]*)[.][^.]*$/); 
```

# ajax - Elasticsearch 请求中的多个条件

> ID：14359619
> 
> 赞同：2
> 
> 时间：2013-01-16T13:31:00.927
> 
> 标签：ajax, elasticsearch, wildcard

我在我的 Ajax 调用中使用以下 POST 请求，但是我无法添加其他搜索条件。我还希望能够专门使用通配符搜索许多其他字段。示例“j*”的名字和“p*”的姓氏。我如何向这种类型的查询添加另外两个条件。当它是 GET 请求时，我知道如何在 curl 请求中执行此操作，但不确定如何将其作为 POST 请求执行。

在 GET 请求上，我只需添加以下内容。

```
+%2bfirstName:j* 
```

POST 请求

```
{
    "query": {
        "filtered": {
            "query": {
                "range": {
                    "date": {
                        "include_lower": true,
                        "include_upper": false,
                        "from": "1999-01-01",
                        "to": "2002-01-01"
                    }
                }
            },
            "filter": {
                "term": {
                    "locationNumber": "453"
                }
            }
        }

    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T14:42:02.193

您可以使用[bool query](http://www.elasticsearch.org/guide/reference/query-dsl/bool-query.html)在查询中组合多个条件。例如：

```
{
    "query": {
        "filtered": {
            "query": {
                "bool": {
                    "must": [
                        {
                            "range": {
                                "date": {
                                    "include_lower": true,
                                    "include_upper": false,
                                    "from": "1999-01-01",
                                    "to": "2002-01-01"
                                }
                            }
                        },
                        {
                            "wildcard": {
                                "firstName": "j*"
                            }
                        }
                    ]
                }
            },
            "filter": {
                "term": {
                    "locationNumber": "453"
                }
            }
        }

    }
} 
```

# java - 允许字符串中除 9 位和 16 位之外的任何数字

> ID：14359626
> 
> 赞同：2
> 
> 时间：2013-01-16T13:31:15.860
> 
> 标签：java, regex

```
^(?![\\s\\S]*(\\d{16})|[\\s\\S]*(\\d{9}))[\\s\\S]* 
```

上面的正则表达式不允许字符串中的数字大于 10 位。例如，如果用户输入测试 1234567891。文本是有效文本。我们应该允许用户输入这个文本。用户不应只输入 9 位数字或 16 位数字。例如，测试 123456789 应该是无效的。如何修改正则表达式。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:32:44.220

正则表达式最能满足此要求吗？我认为检查字符串长度以及是否有数字会更具可读性*。*

> 有些人在遇到问题时会想“我知道，我会使用正则表达式”。现在他们有两个问题。

看看[这里](http://www.codinghorror.com/blog/2008/06/regular-expressions-now-you-have-two-problems.html)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:47:12.407

不要使用正则表达式进行这种检查。Java 有`.length()`字符串：

```
private static final Pattern DIGITS = "\\d+";

public boolean inputOK(String input)
{
    Matcher m = DIGITS.matcher(input);

    int len;

    while (m.find()) {
        len = m.group().length();
        if (len == 9 || len == 16)
            return false;
    }

    return true;
} 
```

# python - 如何将滚动条添加到文本小部件？

> ID：14359627
> 
> 赞同：0
> 
> 时间：2013-01-16T13:31:16.350
> 
> 标签：python, user-interface, tkinter

如果顶级小部件内的文本小部件并通过网格几何管理器添加到布局，如何将滚动条添加到文本小部件。

我的意思是我在“顶层”窗口/对话框中得到了这个：

```
ttk.Label(toplevel,text="Text Area").grid(row=8,sticky=E)
self.TextAreaCCOrder=Text(toplevel,height=10,width=50 ).grid(row=8,column=1) 
```

PS：我是菜鸟：）

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:00:25.230

这是一个创建带有滚动条和文本小部件的框架的示例：

```
import Tkinter as tk

class Example(tk.Frame):
    def __init__(self, parent):
        tk.Frame.__init__(self, parent)

        # create the text and scrollbar widgets
        text = tk.Text(self, wrap="word")
        vsb = tk.Scrollbar(self, orient="vertical")

        # connect them to each other
        text.configure(yscrollcommand=vsb.set)
        vsb.configure(command=text.yview)

        # use grid to arrange the widgets (though pack is simpler if
        # you only have a single scrollbar)
        vsb.grid(row=0, column=1, sticky="ns")
        text.grid(row=0, column=0, sticky="nsew")

        # configure grid such that the cell containing the text
        # widget grows and shrinks with the window
        self.grid_rowconfigure(0, weight=1)
        self.grid_columnconfigure(0, weight=1)

if __name__ == "__main__":
    root = tk.Tk()
    frame = Example(parent=root)
    frame.pack(side="top", fill="both", expand=True)

    root.mainloop() 
```

# asp.net-mvc - ASP.Net MVC Action 方法在 Razor cshtml 文件中编译时错误

> ID：14359628
> 
> 赞同：2
> 
> 时间：2013-01-16T13:31:18.347
> 
> 标签：asp.net-mvc, razor, asp.net-mvc-4

e 如果通过使用控制器中的操作方法不可用，是否有任何方法可以产生编译时错误`Html.Action`？

例如，假设我们有一个名为`LayoutMainPartialViewsController`的控制器，并且在这样的控制器中，我们有一个`Header`输出位于的 Header Partial View的方法`/Views/Shared/PartialViews/_Header.cshtml`

```
public class LayoutMainPartialViewsController : Controller
{
    //
    // GET: /LayoutMainPartialViews/

    public ActionResult Header()
    {
        return PartialView("/Views/Shared/PartialViews/_Header.cshtml");
    }

} 
```

然后为了包含这样的局部视图，我们将在 Razor 中调用

```
@Html.Action("Header", "LayoutMainPartialViews"); 
```

如果由于某种原因，将名为的方法重命名`Header`为`Header2`，则不会给出编译时错误，而只会给出运行时错误。

我希望能够有编译时错误，以尽量减少运行时错误，因为它们更难以识别。

另一方面，调用类似的东西是否有意义？

```
@(new LayoutMainPartialViewsController().Header()) 
```

上面的方法返回一个`ActionResult`需要转换为 String 的方法，方法相同`Html.Action`。

这样，如果我们更改`Header`为`Header2`并`<MvcBuildViews>true</MvcBuildViews>`在 csproj 中设置，则会在编译时提供错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:30:15.403

[T4MVC](https://github.com/T4MVC/T4MVC)是用于 ASP.NET MVC 应用程序的 T4 模板，可创建强类型帮助程序，从而消除在许多地方使用文字字符串。

这完全符合我的要求，并消除了“魔术字符串”的使用，而不是强类型标识符。`<MvcBuildViews>true</MvcBuildViews>`如果设置为 true ，即使在视图中也会提供编译时错误。

感谢@StuartLC 的提示！

# xaml - 在 VariableSizedWrapGrid 中水平包装项目

> ID：14359633
> 
> 赞同：1
> 
> 时间：2013-01-16T13:31:36.427
> 
> 标签：xaml, windows-8

我有一个包含 VariableSizedWrapGrid 的 GridView，像这样......

```
 <local:MyGridview    
        Padding="116,0,0,0"        
        x:Name="itemGridView"
        AutomationProperties.AutomationId="ItemGridView"
        AutomationProperties.Name="Grouped Items"
        Grid.Column="1"
        Grid.Row="1"
        SelectionMode="None"
        ItemTemplateSelector="{StaticResource templateSelector}"
        ItemsSource="{Binding Source={StaticResource groupedItemsViewSource}}" 
        IsItemClickEnabled="True"
        ItemClick="itemGridView_ItemClick">

        <GridView.ItemsPanel>
            <ItemsPanelTemplate>
                <VirtualizingStackPanel Orientation="Horizontal" Margin="0"/>
            </ItemsPanelTemplate>
        </GridView.ItemsPanel>

        <GridView.GroupStyle>
            <GroupStyle>
                <GroupStyle.HeaderTemplate>
                    <DataTemplate>
                        <Grid>
                            <TextBlock Text="{Binding Key}" Margin="3,-7,10,10" Style="{StaticResource GroupHeaderTextStyle}" />
                        </Grid>
                    </DataTemplate>
                </GroupStyle.HeaderTemplate>
                <GroupStyle.Panel>
                    <ItemsPanelTemplate>
                        <VariableSizedWrapGrid Orientation="Vertical" ItemWidth="1" ItemHeight="1" Margin="0,3,40,0" />
                    </ItemsPanelTemplate>
                </GroupStyle.Panel>
            </GroupStyle>
        </GridView.GroupStyle>

    </local:MyGridview> 
```

显示这样的项目...

![](../Images/6b6f16d2640fe3e6df2c9109cff98af2.png)

我想让它水平而不是垂直堆叠项目，以便橙色瓷砖位于蓝色瓷砖旁边而不是在它下方

我尝试将 VariableSizedWrapGrid 的方向更改为水平，但发生这种情况......

![](../Images/eea6368cd6b724d34a43d8827ffe9651.png)

我做的事情真的很傻吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:18:27.700

为什么将 ItemWidth 和 ItemHeight 设置为 1？您是否从代码中设置了正确的 ColumnSpan 和 RowSpan 值？我建议您将 ItemWidth 和 ItemHeight 设置为更大的值，也许设置为最小项目的大小。VariableSizedWrapGrid 布局算法并不完美，在我的示例中，有时它会根据需要水平放置小项目，有时 - 不是（我根本没有设置 VariableSizedWrapGrid Orientation）。

# objective-c - OS X 应用程序的脚本引擎

> ID：14359634
> 
> 赞同：0
> 
> 时间：2013-01-16T13:31:39.773
> 
> 标签：objective-c, macos, scripting

我要为 OS X 开发一个应用程序，我需要一些脚本引擎。脚本的目的是在其输入（大多数情况下为 HTML 文件）中接收文本，以某种方式对其进行解析并将数据返回到我的应用程序。这些脚本应该很容易被用户编辑，因此它们应该有一些常用的语法，如 C 或 pascal。

你能为此提出一些轻量级的解决方案吗？

谢谢！

PS。我是 OS X 开发的新手，正在尝试从 Windows 切换...

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:20:36.047

两个建议：

1.  Javascript，试试 V8 引擎。[http://code.google.com/p/v8/](http://code.google.com/p/v8/) 非常流行，可能很多人都熟悉的语法。

2.  卢阿。[http://www.lua.org](http://www.lua.org) 极其轻量级且易于连接。例如，如果您的脚本编辑器为魔兽世界编写脚本，他们就会知道 Lua。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:12:07.917

一般来说，AppleScript/Automator 操作对于最终用户来说很容易使用，因为该技术包括用于构建脚本的 GUI，而无需太多编程知识。对于习惯于其他语言的有经验的开发人员来说，它们可能有点*过于*友好/松散，并且语法有些不同（更像是简单的英语）。好消息是它们还可以根据需要调用其他语言，因此熟悉 Perl 或其他任何东西的开发人员可以将其合并到 AppleScript 或 Automator 操作中。

由于您正在谈论解析文本，Perl 本身将是一个很好的解决方案 - 再次在语法上存在一些差异，但脚本可以相当紧凑并且解析的基础知识并不太难学习。我没有亲自将 Perl 整合到 OS X 应用程序中，我只是在命令行上使用它，所以我不知道这种方法是否存在任何缺陷。

AppleScript 的另一个优势是您可以使应用程序本身可编写脚本，以便用户可以将应用程序的功能自动化到更大的工作流程中。

我建议下载 Bare Bones Software 或类似开发人员的文本编辑器提供的免费[TextWrangler](http://www.barebones.com/products/textwrangler/)应用程序，以了解它们如何将脚本合并到应用程序中。这可能会让您对自己的方法有更多的了解。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T14:19:35.917

LUA 似乎是一个不错的选择。

# javascript - Jasmine Spec Runner：测试失败的堆栈跟踪？

> ID：14359635
> 
> 赞同：3
> 
> 时间：2013-01-16T13:31:40.937
> 
> 标签：javascript, unit-testing, jasmine

我正在 src 文件夹中使用 moment.js 做一个小 Jasmine-standalone-demo。

```
describe("moment.js -> diff", function() {
    var start, end;
    it("leap year", function() {
        start = moment([2012, 1, 26]);
        end = moment([2012, 2, 4]);
        expect( end.diff(start, "days") ).toEqual(7);
    });
    it("winter-/summertime", function() {
        start = moment("2012-10-28T02:00:00+02:00");
        end = moment("2012-10-28T03:00:00+01:00");
        expect( end.diff(start, "hours") ).toEqual(0);
    });
}); 
```

第二个测试预计会失败，它确实会失败（diff 返回 1），但是 Jasmine 给出了一个堆栈跟踪，这对我来说几乎没用，除非 Jasmine 本身有错误：

```
Error: Expected 1 to equal 0.
    at new jasmine.ExpectationResult (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:114:32)
    at null.toEqual (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:1235:29)
    at null.<anonymous> (http://localhost/jasmine/spec/MomentSpec.js:11:38)
    at jasmine.Block.execute (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:1064:17)
    at jasmine.Queue.next_ (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:2096:31)
    at jasmine.Queue.start (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:2049:8)
    at jasmine.Spec.execute (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:2376:14)
    at jasmine.Queue.next_ (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:2096:31)
    at onComplete (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:2092:18)
    at jasmine.Spec.finish (http://localhost/jasmine/lib/jasmine-1.3.1/jasmine.js:2350:5) 
```

有人可以启发单元测试新手。也许我做错了什么。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T02:16:34.170

堆栈跟踪会告诉您哪个`expect()`函数失败，以防您在一个块中有很多`expect()`s 。`it()`

正如@zbynour 提到的，你必须去你的第 11 行，第 38 个字符，`MomentSpec.js`找出答案！

# python - Python：用于在多行输入中排除字符串/单词的正则表达式

> ID：14359637
> 
> 赞同：0
> 
> 时间：2013-01-16T13:31:47.723
> 
> 标签：python, regex

我在尝试使用 Python 2.7.3 正则表达式在带有换行符的大型输入中查找一些字符串时遇到问题。我有这样的事情：

```
type="thing" blahblahblah
something id="123456"
...
type="disabled thing" blahblahblah
somethingelse id="123457"
... 
```

我想获取 type="thing" 的所有 id。由于贪婪的正则表达式引擎，我必须编写一个像这样的正则表达式：

```
r'type="thing"(?!type).+id="[0-9]{6,7}"', re.S 
```

但是，这不起作用。如何在输入时使用这种数据制作排除字符串正则表达式？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:38:32.003

如果我正确理解了您的问题（在编辑之前），您需要与 id 关联的两行。在这种情况下，您将需要这些方面的内容（假设新行由 '\n' 标记）：

```
>>> import re
>>> t = """
type="thing" blahblahblah
something id="123456"
...
type="disabled thing" blahblahblah
somethingelse id="123457"
...
"""
>>> q = re.compile(r'type="thing".*\n.*\n')
>>> q.findall(t)
['type="thing" blahblahblah\nsomething id="123456"\n']
>>> for s in q.findall(t):
    print s  

type="thing" blahblahblah
something id="123456" 
```

如果你不使用 re.S，你可以更有效地控制你的表情的贪婪。你的`.+`结合`re.S`会使你的表达变得贪婪，否则你将不得不考虑这一点。您也可以使用类似`.+?`. 加号后面的问号会让你的表达不贪心，但我会选择更简洁的表达方式。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:44:44.020

用这个：

```
r'type="thing"[\s\S]+?id="([0-9]{6,7})"', re.S 
```

例子：

```
import re

s = b'''"type="thing" blahblahblah
something id="123456"
....
type="thing" blahblahblah
something id="123459"
....
type="disabled thing" blahblahblah
somethingelse id="123457"'''

expr = re.compile(r'type="thing"[\s\S]+?id="([0-9]{6,7})"', re.S);

c = expr.findall(s)

for c1 in c:
    print ".."
    print c1 
```

输出：

```
>>> 
..
123456
..
123459 
```

# hyper-v - Hyper-V 桥接时终止 Internet 连接

> ID：14359639
> 
> 赞同：23
> 
> 时间：2013-01-16T13:31:51.380
> 
> 标签：hyper-v

我是第一次使用 Hyper-V（运行 Windows 8）。当我在外部创建一个新的虚拟网络交换机时，它会将虚拟机网络适配器与 WiFi 桥接起来 - 出于某种原因，这会终止 WiFi 的互联网连接。为什么，我可能做错了什么？

谢谢。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-10-16T23:21:44.420

如果您已`VirtualBox`安装，请检查是否有任何 Hyper-V 虚拟适配器/网桥连接`VirtualBox Bridged Networking Driver`在连接属性中打勾。如果他们这样做了，只需在该服务所在的位置取消勾选它，这应该会为您修复它。无需卸载 VirtualBox。

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2015-06-03T21:02:00.817

我的以太网适配器中有一个静态 IP 地址。删除了静态条目。制作了我的外部虚拟交换机。有额外的 vEthernet 适配器，在这个适配器中创建了我的静态条目（ip-address、dns-server）。现在一切正常。

克里斯

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:34:42.093

我遇到了同样的问题，重新设置连接需要几秒钟。查看本教程：[https ://superuser.com/questions/469806/windows-8-hyper-v-how-to-give-vm-internet-access](https://superuser.com/questions/469806/windows-8-hyper-v-how-to-give-vm-internet-access)

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-06-07T09:51:31.630

我刚刚遇到了同样的问题，在创建虚拟交换机时失去了互联网连接。我同时安装的卸载`VirtualBox`解决了我的问题（仅禁用 VBox 适配器是不够的），因此它们似乎无法愉快地共存。

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2015-01-08T19:11:03.057

我最近在 Hyper-V 中创建外部交换机时遇到了同样的问题。长话短说，每次创建外部交换机时，都会断开主机笔记本电脑上的以太网连接。我也有 wifi 连接选项，但禁用它只是为了严格排除以太网网络适配器的故障。

我关闭了 VM，一旦关闭，就从 hyper V 虚拟交换机管理器中删除了外部网络适配器。在主机上，从网络连接（以太网）中禁用并重新启用网络适配器。连接后，我首先将 VM 重新联机，然后创建第二个连接没有问题的外部交换机。已验证我能够在主机和 VM 上访问外部世界，即互联网。

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2016-05-05T22:07:40.037

也许您不小心取消了`Allow management OS to share this network adapter`默认启用的设置。禁用此设置将使您的虚拟机管理程序操作系统没有网络连接。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2021-02-03T12:36:32.987

我可以通过禁用无线适配器上的 Internet 共享来解决此类问题，首先在 Hyper-V 中创建一个内部虚拟交换机，然后在所有相关接口上禁用 VMWare 桥接，然后通过选择我的内部在网络共享中心建立一个桥接交换机和 Wi-Fi 适配器，之后我可以在 Hyper-V 的虚拟交换机管理器中选择外部网络

* * *

## 回答 #8

> 赞同：-2
> 
> 时间：2015-01-11T18:54:46.293

我也遇到了同样的问题。我不确定，但是在尝试了上述所有解决方案以及我能找到的任何其他解决方案之后，我将我的虚拟交换机重命名为“realtek”（我安装的网卡类型），而不是使用我的默认名称认为是“新的虚拟交换机”。我所做的其他事情可能已经解决了这个问题（我修改了我能找到的所有东西两天），但我认为重命名它最终让我可以访问虚拟机。

# postgresql - PostgreSQL 错误 22P02 整数的无效输入语法

> ID：14359640
> 
> 赞同：0
> 
> 时间：2013-01-16T13:31:53.003
> 
> 标签：postgresql, stored-procedures

我不断收到 22P02 错误：（`invalid input syntax for integer: "{1,2,3}"`请参阅服务电话中的评论）。

这是我的服务电话：

```
...
using (var command = new NpgsqlCommand("mediabase.create_media", connection))
{
    command.CommandType = System.Data.CommandType.StoredProcedure;
    command.Parameters.Add("title", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.title;
    command.Parameters.Add("uniqueFilename", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.uniqueFilename;
    command.Parameters.Add("description", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.description;
    command.Parameters.Add("categoryIds", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.categoryIds; /* here the value is "1,2,3" */
    command.Parameters.Add("typeId", NpgsqlTypes.NpgsqlDbType.Integer).Value = media.typeId;
    command.Parameters.Add("ownerId", NpgsqlTypes.NpgsqlDbType.Integer).Value = media.ownerId;
    command.Parameters.Add("statusId", NpgsqlTypes.NpgsqlDbType.Integer).Value = media.statusId;
    command.Parameters.Add("gpsLocation", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.gpsLocation;
    command.Parameters.Add("locationNameId", NpgsqlTypes.NpgsqlDbType.Integer).Value = media.locationId;
    command.Parameters.Add("uploadUserId", NpgsqlTypes.NpgsqlDbType.Integer).Value = media.uploadUserId;
    command.Parameters.Add("uploadDate", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.uploadDate;
    command.Parameters.Add("uploadIp", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.uploadIp;
    command.Parameters.Add("metadataId", NpgsqlTypes.NpgsqlDbType.Integer).Value = metadataId;
    command.Parameters.Add("sysEnvironment", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.sysEnvironment;
    command.Parameters.Add("languageId", NpgsqlTypes.NpgsqlDbType.Integer).Value = media.languageId;
    command.Parameters.Add("publicationIds", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.publicationIds;
    command.Parameters.Add("limitations", NpgsqlTypes.NpgsqlDbType.Varchar).Value = media.limitations;

    mediaId = Convert.ToInt32(command.ExecuteScalar());
}

pgTransaction.Commit();
... 
```

和存储过程：

```
CREATE OR REPLACE FUNCTION mediabase.create_media(
    title character varying, 
    uniquefilename character varying, 
    description character varying, 
    categoryids character varying, 
    typeid integer, 
    ownerid integer, 
    statusid integer, 
    gpslocation character varying, 
    locationnameid integer, 
    uploaduserid integer, 
    uploaddate character varying, 
    uploadip character varying, 
    metadataid integer, 
    sysenvironment character varying, 
    languageid integer, 
    publicationids character varying, 
    limitations character varying)
  RETURNS integer AS
$BODY$
    declare _mediaId integer;
    declare _point varchar;
    declare _gps_location geometry;
    declare _id text;

    begin

    IF (gpslocation <> '') THEN
      _point = 'POINT(' || gpslocation || ')';
      _gps_location = ST_Transform(ST_GeomFromText(_point, 4326), 900913);
    ELSE
      _gps_location = NULL;
    END IF;

    insert into mediabase.media (
        title, 
        unique_filename, 
        description, 
        owner_id, 
        status_id, 
        gps_location, 
        type_id, 
        location_name_id, 
        upload_user_id, 
        upload_date, 
        upload_ip, 
        metadata_id, 
        system_environment,
        language_id,
        limitations)

    values (
        title, 
        uniqueFilename, 
        description, 
        ownerId, 
        statusId, 
        _gps_location, 
        typeId, 
        locationNameId, 
        uploadUserId, 
        uploadDate, 
        uploadIp, 
        metadataId, 
        sysEnvironment,
        languageid,
        limitations)

    returning id into _mediaId; 

    -- insert category ids
    FOR _id IN SELECT string_to_array (categoryids,',')
    LOOP 
        INSERT into mediabase.media_categories (media_id, category_id)
        values (_mediaId, (_id::int));
    END LOOP;

    -- insert publication ids
    FOR _id IN SELECT string_to_array (publicationids,',')
    LOOP 
        INSERT into mediabase.media_publications (media_id, publication_id)
        values (_mediaId, (_id::int));
    END LOOP;

    return _mediaId;

    end;

$BODY$
  LANGUAGE plpgsql VOLATILE
  COST 100; 
```

在服务方法中可以看到，参数的输入`categoryids`是字符串`"1,2,3"`，`NpgsqlDbType`而是`Varchar`。在存储过程中，输入类型是`character varying`.

这是执行日志：

```
2013-01-17 08:56:42 CET ERROR:  invalid input syntax for integer: "{1,2,3}"
2013-01-17 08:56:42 CET CONTEXT:  SQL statement "INSERT into mediabase.media_categories (media_id, category_id)
            values (_mediaId, (_id::integer))"
    PL/pgSQL function "create_media" line 54 at SQL statement
2013-01-17 08:56:42 CET STATEMENT:  select * from mediabase.create_media(('Penguins')::varchar,('079117ec-676f-4022-9950-69e55c2a2600_Penguins.jpg')::varchar,('Description...')::varchar,('1,2,3')::varchar,(1)::int4,(1)::int4,(1)::int4,('')::varchar,(1)::int4,(1)::int4,('17/01/2013 08:56:42')::varchar,('::1')::varchar,(399)::int4,('dev')::varchar,(1)::int4,('1,2')::varchar,('Limitations...')::varchar) 
```

为什么会弹出这个错误？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T10:28:21.210

我已经使用@dezso 和@CraigRinger 技巧解决了这个问题。我现在使用整数数组而不是逗号分隔的字符串。以下是更改：

在服务电话上：

```
...
/* media.categoryIds is of type int[] now */
command.Parameters.Add("categoryIds", NpgsqlTypes.NpgsqlDbType.Array | NpgsqlTypes.NpgsqlDbType.Integer).Value = media.categoryIds;
... 
```

关于存储过程：

```
...
CREATE OR REPLACE FUNCTION mediabase.create_media(
    title character varying, 
    uniquefilename character varying, 
    description character varying, 
    categoryids integer[], -- changed type
    typeid integer, 
    ownerid integer, 
    statusid integer, 
    gpslocation character varying, 
    locationnameid integer, 
    uploaduserid integer, 
    uploaddate character varying, 
    uploadip character varying, 
    metadataid integer, 
    sysenvironment character varying, 
    languageid integer, 
    publicationids integer[], -- changed type
    limitations character varying)
...
...
    declare i integer;
...
...
    -- insert category ids
    FOR i IN SELECT generate_subscripts( categoryids, 1 )
    LOOP 
        INSERT into mediabase.media_categories (media_id, category_id)
        values (_mediaId, categoryids[i]);
    END LOOP;

    -- insert publication ids
    FOR i IN SELECT generate_subscripts( publicationids, 1 )
    LOOP 
        INSERT into mediabase.media_publications (media_id, publication_id)
        values (_mediaId, publicationids[i]);
    END LOOP;
... 
```

再次感谢您对此的帮助。

# python - Python Setuptools Distribute：setup.py 中的优化选项？

> ID：14359644
> 
> 赞同：2
> 
> 时间：2013-01-16T13:32:08.520
> 
> 标签：python, optimization, software-distribution

有没有办法从 setuptools`setup.py`文件中设置优化级别？有*没有*办法在 setuptools 中设置优化级别？

我有很多`__debug__`发布时不需要的样式日志记录。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:50:04.133

您可以通过 Python 命令行上的 -O 开关控制 .pyc 与 .pyo 的使用。Python 甚至不会尝试在没有 -O 开关的情况下使用 .pyo 文件，因此在设置时将 .py 文件编译为 .pyo 文件将无济于事：您需要使用 -O 开关或 PYTHONOPTIMIZE 调用程序环境变量。

# mysql - 从数据库计算玩家统计数据

> ID：14359646
> 
> 赞同：3
> 
> 时间：2013-01-16T13:32:11.727
> 
> 标签：mysql, database

我有以下表格。

![数据库表](../Images/3ee6e2c94fdbaa313f25bf832f6381af.png)

我想从给定的表中获取所有玩家统计记录，包括单个玩家的记录。

1.  选手姓名
2.  位置
3.  总游戏数
4.  进球数
5.  进球助攻总数。
6.  总得分（总进球数 + 总助攻数 = 总得分）。

尝试后我想出了这个查询

```
SELECT SQL_CALC_FOUND_ROWS
    CONCAT(u.first_name, ' ', u.last_name) as player_name,
    p.position, 
    COUNT(g.id)
FROM 
    gce_player p 
LEFT JOIN 
    gce_user u ON(u.id = p.user_id) 
LEFT JOIN 
    gce_game_team_lineup gtl ON(gtl.player_id = p.id) 
LEFT JOIN 
    gce_game_team gt ON(gt.id = gtl.game_team_id) 
LEFT JOIN 
    gce_game_goal gg ON(gg.player_id = p.id) 
LEFT JOIN 
    gce_game g ON(g.id = gt.game_id) 
GROUP BY p.id 
ORDER BY p.id asc 
```

上面的查询返回正确的记录，直到玩过的游戏总数，在此之后我面临获取正确记录的问题，非常感谢任何形式的帮助。

如果您想查看架构，这里是[sqlfiddle的链接，我也添加了一些测试数据。](http://sqlfiddle.com/#!2/3031f/6)

谢谢你。

**更新 ：**

> 这里有一些要记住的规则。
> 
> 1.  进球数=球员总进球数。例如，如果在`gce_game_goal`表中有 10 行具有`player_id as 4`它的值意味着玩家已经进了 10 个进球，我需要为单个玩家获取此记录，同样如果有 7 行其中 player_id 的值为 3，这意味着玩家id 3 已经打进 7 球，同样如此。
>     
>     
> 2.  进球助攻总数=球员给守门员的助攻总数（助攻就像足球中的传球）。我需要计算用户完成的助攻或传球总数。
>     每个进球都会有两次助攻，每个助攻都是将球传给守门员的球员。我想计算球员传球或助攻的次数。例如，如果在`gce_game_goal` table 中有 8 行或记录在 assis1_id 或 assistant2_id 列中的值为 3，这意味着 id 为 3 的玩家总共获得了 8 次助攻

.

如果您仍有任何疑问/问题，请告诉我，我会尝试改进我的问题

谢谢

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:23:50.407

尝试这个

```
SELECT 
    CONCAT(u.first_name, ' ', u.last_name) as player_name,
    count(g.id) as Goals,
    (select 
            count(*)
        from
            gce_game_goal
        where
            assist1_id = p.player_id) 
    +(select 
            count(*)
        from
            gce_game_goal
        where
            assist2_id = p.player_id) as Assists,
     count(g.id) 
     + (select 
            count(*)
        from
            gce_game_goal
        where
            assist1_id = p.player_id) 
     + (select 
            count(*)
        from
            gce_game_goal
        where
            assist2_id = p.player_id) as Total
FROM
    gce_player as p
LEFT JOIN
    gce_game_goal as g ON p.id = g.player_id
LEFT JOIN 
    gce_user u ON(u.id =p.user_id)
GROUP BY p.player_id 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:37:15.697

您面临的问题是由数据的多个不同维度（例如按游戏和按​​目标）聚合引起的。这导致每个玩家的交叉产品。

一个相当通用的解决方案是在`from`子句中沿每个维度进行聚合。每个变量（或者可能是几个变量）来自不同的聚合：

```
select u.last_name, u.first_name, p.position, 
       pg.goals, pg.assists, (pg.goals + pg.assists) as TotalPoints
from gce_player p join
     gce_user u
     on p.user_id = u.id left outer join
     (select player_id, SUM(goal) as goals, SUM(assist) as assists
      from ((select player_id, 1 as goal, 0 as assist
             from gce_game_goal
            ) union all
            (select assist1_id, 0 as goal, 1 as assist
             from gce_game_goal
            ) union all
            (select assist2_id, 0 as goal, 1 as assist
             from gce_game_goal
            )
           ) t
      group by player_id
     ) pg
     on pg.player_id = p.id left outer join
     (select gtl.player_id, count(*) as NumTeams
      from gce_game_team_lineup gtl join
           gce_game_team gt
           on gtl.id = gt.team_id
     ) g
     on g.player_id = p.id 
```

# javascript - 如何在 Windows 网络中的 Intranet Web 应用程序中获取用户的用户名

> ID：14359648
> 
> 赞同：3
> 
> 时间：2013-01-16T13:32:20.857
> 
> 标签：javascript, html

我在内部有一个简单的 HTML 页面，它只显示一个表单并要求用户填写它。我想自动捕获 windows 域用户名和机器名，以将其与表单中收集的数据一起提交。

我可以在客户端这样做吗？HTML？JavaScript？或者我是否被迫在服务器端做（我不知道该怎么做......但是）

用户有XP和7机器和IE7，8。

顺便说一句，我找到[了这篇文章](https://stackoverflow.com/questions/342088/getting-domain-username-for-web-app-on-intranet-without-loggin-in)，但我不得不承认我不知道你会在页面的哪个位置输入那个“代码”。

这是我正在使用的代码不起作用。它调用 JavaScript 函数，并`"Username="`在下一行显示 and `"Done."`，但不显示用户名。

如果使用 Chrome，它会显示`<%HttpContext.Current.User.Identity.Name%>`.

```
<html lang="en">
<head>
    <script>
        function get_user_Name() {
            var username = '<%HttpContext.Current.User.Identity.Name%>';
            document.write("Username=");
            document.write(username);
            document.write(" <br> Done.");
        }
    </script>

        <meta charset="utf-8" />
        <title>Training and Development Site</title>
        <link href="~/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    </head>
    <body>
        <a href="add-number-to-dnc.html">Add Phone Number to Dialer Do Not Call list</a>
        <br><br>
        <button type="button" onclick="get_user_Name()">Display User Name</button>
    </body>
</html> 
```

另外 -**我正在使用 WebMatrix / IIS7 Express**

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:35:39.977

**在非 IIS 服务器上仅使用 javascript 是不可能的。**

然而：

**如果您使用的是 IIS，那么您可以使用以下 JS：**

```
<script language="javascript">
    var username = '<%HttpContext.Current.User.Identity.Name %>';

</script> 
```

假设您已在 IIS 中为您的站点打开 Windows 身份验证，然后是 C# 端：

C＃

```
public string user_Name
{
    get
    {
        string x = Page.User.Identity.Name;

        x = x.Replace("YOURDOMAIN\\", "");

        return x;
    }
} 
```

删除用户帐户的 `x = x.Replace("DOMAIN\\", "");`DOMAIN 部分，例如 NISSAN\rmcdonough

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2017-07-11T02:45:05.290

捕获windows域用户名和机器名，我想我们不能

# sql-server - 访问复制的属性，MS SQL

> ID：14359649
> 
> 赞同：0
> 
> 时间：2013-01-16T13:32:23.250
> 
> 标签：sql-server, replication

我有 ms sql server 2005。我应该如何让非 sa 或 db_owner 的用户查看复制的属性？我读过 BOL [http://msdn.microsoft.com/en-us/library/ms151221(v=sql.90).aspx](http://msdn.microsoft.com/en-us/library/ms151221(v=sql.90).aspx)，但没有帮助。具有 replmonitor 角色的用户只能查看所有发布，但无法查看其属性！

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T17:38:25.643

根据[复制的安全角色要求](http://msdn.microsoft.com/en-us/library/ms152528%28v=sql.90%29.aspx)，要查看发布属性，用户必须是 PAL 的成员、发布服务器上发布数据库的 db_owner 数据库角色或发布服务器上的 sysadmin 服务器角色。

# java - 如何显示用户将 Android 应用程序安装到列表视图？

> ID：14359652
> 
> 赞同：-3
> 
> 时间：2013-01-16T13:32:26.700
> 
> 标签：java, android, android-emulator, android-widget

我正在编写一个像任务管理器这样的应用程序。我想知道如何将用户安装的Android应用程序显示到列表视图中，请大家帮帮我

我刚刚做了一些这样的功能来管理Android中的应用程序，代码还可以，但我想添加更多功能

```
public void onClick(View v) {
    // TODO Auto-generated method stub
    switch (v.getId()) {
    case R.id.appinfo:
        final ActivityManager actvityManager = (ActivityManager) this.getSystemService( ACTIVITY_SERVICE );

           List<RunningAppProcessInfo> procInfos = actvityManager.getRunningAppProcesses();

            for(int i = 0; i < procInfos.size(); i++)

            {

                    tv.setText(tv.getText().toString()+procInfos.get(i).processName+

                                " " + String.valueOf(procInfos.get(i).processName.length())+"\n");

                    if(procInfos.get(i).processName.equals("com.android.camera")) {

                        Toast.makeText(getApplicationContext(), "Camera App is running", Toast.LENGTH_LONG).show();

                    }
                    else{
                        Toast.makeText(getApplicationContext(), "Camera App is not running", Toast.LENGTH_LONG).show();
                    }

            }

        break;

    case R.id.taskinfo:
         final   ActivityManager activityManager = (ActivityManager) getSystemService(Context.ACTIVITY_SERVICE);
         final List<RunningTaskInfo> recentTasks = activityManager.getRunningTasks(Integer.MAX_VALUE);

          for (int i = 0; i < recentTasks.size(); i++) 
            {
               tv.setText("Executed app"+ "Application executed : " +recentTasks.get(i).baseActivity.toShortString()+ "\t\t ID: "+recentTasks.get(i).id+"");         
            }

          break;

    case R.id.serviceinfo:
        final String APP_TAG = "tag";

        ActivityManager activityManager1 = (ActivityManager) getSystemService(ACTIVITY_SERVICE);
        List<ActivityManager.RunningServiceInfo>runningServices = activityManager1.getRunningServices(50);

        for (int i = 0;i < runningServices.size();i++){

            ActivityManager.RunningServiceInfo runningServiceInfo = runningServices.get(i);

            tv.setText(APP_TAG + "Process " + runningServiceInfo.process + " with component " + runningServiceInfo.service.getClassName());

        } 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:38:35.877

您可以使用 packageManager 来执行此操作，

```
 final PackageManager pm = getPackageManager();
//get a list of installed apps.
        List<ApplicationInfo> packages = pm
                .getInstalledApplications(PackageManager.GET_META_DATA);

        for (ApplicationInfo packageInfo : packages) {

            Log.d(TAG, "Installed package :" + packageInfo.packageName);
            Log.d(TAG,
                    "Launch Activity :"
                            + pm.getLaunchIntentForPackage(packageInfo.packageName)); 

             // put application name to an Array, then set listviews adapter with this array
        } 
    } 
```

# c# - 在 Visual C# 中创建头文件 (.h) 和 .lib 文件

> ID：14359654
> 
> 赞同：1
> 
> 时间：2013-01-16T13:32:42.533
> 
> 标签：c#, dll

我想在visual c#中创建一个dll，并在win32程序（visual c++）中使用它。据我了解，为了在 Visual C++ 中添加 dll 文件，我还需要 .h 文件和 .lib 文件，但是当我在 Visual c# 中创建类库时，我只得到 dll 文件。
是否可以在 Visual c# 中创建 .h 文件和 .lib 文件？

* * *

## 回答 #1

> 赞同：5
> 
> 时间：2013-01-16T13:35:52.310

不，这是不可能的。但是[，](http://1code.codeplex.com/wikipage?title=Invoke%20.NET%20Assembly%20from%20Native%20C%2b%2b#CLIWrapper)您可以通过以下方式在 C++ 中使用 C# 库：

1.  C++/CLI Wrapper（这允许您在同一个源文件中同时拥有托管和非托管代码。托管部分然后可以调用 C# 代码）。[在这里](http://code.msdn.microsoft.com/windowsdesktop/Consuming-C-Library-in-937458e5)你可以找到一个例子。
2.  宿主 CLR（CLR 充当可以由进程加载和“宿主”的库）。
3.  COM 互操作（将您的 .NET 类型公开为 COM 接口和匹配的 coclass，您可以在非托管 C++ 中轻松使用）。

[这个话题](http://social.msdn.microsoft.com/forums/en-US/vcgeneral/thread/299da822-5539-4e5b-9ba7-b614e564c9f4/)也很有趣！

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:36:34.523

您可以使用**LoadLibrary**和**GetProcAddress**动态加载 DLL，而无需创建您引用的文件。你可以[在这里阅读更多](http://msdn.microsoft.com/en-us/library/ms686944%28VS.85%29.aspx)。

# qt - QNetworkConfigurationManager::configurationChanged 信号未被调用以进行 ETHERNET 配置更改

> ID：14359657
> 
> 赞同：2
> 
> 时间：2013-01-16T13:32:49.940
> 
> 标签：qt, signals, ethernet

当我插入具有有效 IP（以太网接口）的 LAN 电缆时，系统不会调用 QNetworkConfigurationManager::configurationChanged() 信号。

它被要求用于 WLAN 和 USB 接口，但不适用于 ETHERNET 配置更改

希望在这方面得到一些指示。

# php - 使用 simplexml_load_string 获取 xml 属性

> ID：14359658
> 
> 赞同：3
> 
> 时间：2013-01-16T13:32:53.947
> 
> 标签：php, xml, simplexml

> **可能重复：**
> [从 SimpleXML 访问 @attribute](https://stackoverflow.com/questions/1652128/accessing-attribute-from-simplexml)

我正在使用一些第三方 API，它们通过 xml 以下列形式返回错误：

```
<xml>
<status>0</status>
<error code="111">Error message text goes here.</error>
</xml> 
```

在 PHP 中使用`simplexml_load_string`我可以轻松获得状态 0 和错误消息文本，但我找不到`code="111"`从`<error code="111">`. 它似乎被 SimpleXML 丢弃了。

```
<?php
    $bytesRead = file_get_contents('http://api.....');
    $xml = simplexml_load_string($bytesRead);

    echo '<pre>'; print_r($xml); echo '</pre>';
?> 
```

输出

```
SimpleXMLElement Object
(
    [status] => 0
    [error] => Error message text goes here.
) 
```

我错过了什么吗？有没有办法获得这个值，或者有人可以建议另一种方法来获得这个值？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T13:38:10.083

它在那里，但只是没有显示在`print_r`输出中。就像[*示例 #5*](http://php.net/simplexml.examples-basic#example-5286)[中的基本示例页面](http://php.net/simplexml.examples-basic#example-5286)*一样使用属性：*

 *> 到目前为止，我们只介绍了读取元素名称及其值的工作。SimpleXML 还可以访问元素属性。[像访问数组](http://php.net/array)元素一样访问元素的属性。

例子：

```
$x = '<xml>
<status>0</status>
<error code="111">Error message text goes here.</error>
</xml>';

$attributeObject = simplexml_load_string($x)->error['code'];

print_r($attributeObject);
print_r((string) $attributeObject); 
```

程序输出（[演示](http://eval.in/6848)）

```
SimpleXMLElement Object
(
    [0] => 111
)
111 
```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T13:41:24.950

像这样使用 echo $xml->error['code'];

例如： [http ://codepad.org/uOqeBNz9](http://codepad.org/uOqeBNz9)*

# robotium - 如何使用 Robotium 为应用程序自动分配内存（以查找内存泄漏）

> ID：14359665
> 
> 赞同：2
> 
> 时间：2013-01-16T13:33:09.430
> 
> 标签：robotium, monkeyrunner

我必须创建一个测试套件来测试在我的应用程序上执行一些操作后发生的任何内存泄漏。那么任何人都可以指导我如何使用robotium来实现它。我能够做到一点，但需要更多帮助

测试脚本以查找内存泄漏：

```
boolean value=Debug.dumpService ("com.apppackage.name", fd, null);
ActivityManager manager=(ActivityManager)getActivity().getSystemService(context.ACTIVITY_SERVICE);
List<RunningAppProcessInfo> service= manager.getRunningAppProcesses();
for(int i=0;i<service.size();i++){
   if (service.get(i).processName.equals("com.apppackage.name"))
              {
                pid=service.get(i).pid;  
          }
          }
android.os.Debug.MemoryInfo[] meminfo=manager.getProcessMemoryInfo (new int []{pid});
Log.d("meminfo",meminfo+"length");
String info = meminfo.toString(); 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:42:32.517

Robotium 用来协助测试的 Solo 类有一个方法`assertMemoryNotLow()`，如果 Android 操作系统认为内存不足，调用它时会导致测试失败，例如，如果你创建了很多位图而没有回收它们时你是完毕。

至于使用 Robotium 完全实现您的套件，这种开放式问题超出了 Stack Overflow 的范围。您可以访问此链接[开始使用 Robotium](http://code.google.com/p/robotium/wiki/Getting_Started)，以查看如何使用 Robotium 的示例。它有一个非常有用的链接来下载由开发人员创建的测试项目，这应该足以让你继续前进。一旦你开始了，当你遇到挑战时随时回来，并询问一些关于框架的具体问题；社区将很乐意提供帮助。祝你好运！

# c++ - g++二进制输出分析

> ID：14359667
> 
> 赞同：2
> 
> 时间：2013-01-16T13:33:18.237
> 
> 标签：c++, binary, g++, hexdump

给定以下程序：

```
unsigned char g1[] = { 0x1a, 0x2a, 0x3a, 0x4a };
static unsigned char g2[] = { 0x1b, 0x2b, 0x3b, 0x4b };

int main()
{
  unsigned char l1[] = { 0x1c, 0x2c, 0x3c, 0x4c };
  static unsigned char l2[] = { 0x1d, 0x2d, 0x3d, 0x4d };
} 
```

之后，简单地用“g++ test.cpp -o test”编译它并在二进制文件上运行hexdump -C，我意识到g1、g2和l2的序列可以在二进制文件中清楚地找到。只有 l1 (1c 2c 3c 4c) 的序列，它显然不存在于二进制文件的任何地方。

有人知道这是为什么吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:36:48.450

因为它是在该函数调用的堆栈上分配的。通常在这种情况下，会发生以下两种情况之一：

1.  编译器*将该*序列存储在数据部分中，然后基本上将其 memcpy 到堆栈缓冲区中。

2.  编译器本质上对“移动”指令进行硬编码，以从指令集的最大立即值（通常是 4-bye int）重新组装序列。

如果它没有被优化，就像提到的“放松”，那么#2 可能正在发生。查看反汇编程序（或预组装的 asm 代码）会更好地向您展示。使用 `-S`并查看 .s 文件。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T13:34:33.637

我的猜测是，因为它是非`static`自动的（非全局的），所以知道没有人能够从外部引用它是微不足道的。由于它没有被使用，它可以被丢弃。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:46:06.153

`l1[]`并且`l2[]`在编译器优化期间被删除，因为两者都是`local and unused variables`（这两个变量都不会在其他任何地方使用）。

您可以使用选项编译代码以生成汇编代码：并且在 main`-S`中没有定义， 甚至在其他任何地方都没有： `l1[]``l2[]`

[输入文件是`x.c`，用命令编译`gcc -S x.c`生成汇编文件`x.s`]

```
main:
    pushl   %ebp
    movl    %esp, %ebp
    subl    $16, %esp
    movb    $28, -4(%ebp)
    movb    $44, -3(%ebp)
    movb    $60, -2(%ebp)
    movb    $76, -1(%ebp)
    leave
    ret
    .size   main, .-main
    .data
    .type   l2.1250, @object
    .size   l2.1250, 4 
```

但是你可以找到`g1[] and g2[]`.

```
 .file   "x.c"
.globl g1
    .data
    .type   g1, @object
    .size   g1, 4
g1:
    .byte   26
    .byte   42
    .byte   58
    .byte   74
    .type   g2, @object
    .size   g2, 4
g2:
    .byte   27
    .byte   43
    .byte   59
    .byte   75
    .text
.globl main
    .type   main, @function 
```

**此外，如果您使用标志**`-O3` *优化标志级别 3*编译代码，那么如果您编译，那么知道是否 只存在定义会很有趣`g1[]`。和全局静态变量（文件私有）也被删除。

[输入文件是`x.c`，用命令编译`gcc -S -O3 x.c`生成汇编文件`x.s`]

以下：

```
 .file   "x.c"
    .text
    .p2align 4,,15
.globl main
    .type   main, @function
main:
    pushl   %ebp
    movl    %esp, %ebp
    popl    %ebp
    ret
    .size   main, .-main
.globl g1
    .data
    .type   g1, @object
    .size   g1, 4
g1:
    .byte   26
    .byte   42
    .byte   58
    .byte   74
    .ident  "GCC: (Ubuntu/Linaro 4.4.4-14ubuntu5) 4.4.5"
    .section    .note.GNU-stack,"",@progbits 
```

`g1[]`仅存在全局数据，并`g2[]`在 中删除`-O3`。

`g2[]`使用定义`static unsigned char g2[]`的所以只能在这个文件中访问，不要再使用所以未使用。但是`g1[]`是全局的，如果其他文件包含它，它可能对其他程序有用。并且编译器不允许优化掉全局对象。

参考： [如何防止我的“未使用”全局变量被编译出来？](https://stackoverflow.com/questions/1229430/how-do-i-prevent-my-unused-global-variables-being-compiled-out)

所以，这一切都归功于编译器优化！

# flash - adl 默默地失败

> ID：14359669
> 
> 赞同：0
> 
> 时间：2013-01-16T13:33:28.847
> 
> 标签：flash, air

我在 Mac 上的终端 10.8.2 中通过以下方式运行 adl：

`/path/to/sdk/bin/adl -runtime path/to/sdk/runtimes/air/mac path/to/theApp-app.xml`

而且……什么也没有发生。没有启动，命令行只是给我下一个提示，没有错误消息添加到控制台。

这仅在最近几天才开始发生 - 我在那段时间更新了 Air，但不幸的是，由于我上次运行此任务后的差距，我不能发誓问题与此同时发生。

我的 Air SDK 是 3.5。

我已经确认前 2 个路径是正确的，因为如果我更改其中任何一个，那么我会在命令行中收到相应的错误消息。目前，最后一个参数（应用程序描述符）似乎被忽略了（如果我将其更改为不存在的路径，则没有错误），这使我认为该应用程序描述符中的 xml 不是罪魁祸首。

我已经从我的库中删除了 adl.plist 和 com.adobe.adl.plist。mm.cfg 没有任何有趣的内容。

我也（只是想看看）尝试使用 -nodebug 启动，但这没有区别。

该应用程序是一个桌面应用程序。

编辑：我刚刚尝试启动具有相同（无声）结果的不同 Air 应用程序。

进一步编辑：退出代码（从 echo $? 获得）是 1。相当于`Successful invocation of an already running AIR application. ADL exits immediately.`

立即退出当然是我所看到的。因此，似乎错误地发现 Air 应用程序已经在运行。我试过重启，重启后第一次运行没有什么不同。

有什么线索吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:10:32.120

我已经下载了一个新的 SDK 副本并将其放到一个新的位置，并且工作正常。

我无法验证它，但我认为封闭文件夹的权限是罪魁祸首。

# jquery-ui - jQueryui 可拖动和可排序附加自定义 html

> ID：14359671
> 
> 赞同：4
> 
> 时间：2013-01-16T13:33:47.217
> 
> 标签：jquery-ui, jquery-ui-sortable, jquery-ui-draggable

我有两个列表，列表 A 是可排序的，列表 B 是可拖动的，连接到列表 A。我将列表 B 中的项目拖到列表 A 中。

两个列表中的项目具有不同的 html 结构。问题是，当我将一个项目从列表 B 拖放到列表 A 时，它会自动附加其原始 html 结构，所以最终的图片是这样的：

```
list A
<div class="sortableItem">bla bla</div>
<div class="sortableItem">bla ble</div>
<span class="draggableItem">bla bla</span> // This is the item coming from list B
<div class="sortableItem">blew blew</div>
.
.
. 
```

我想在将可拖动项目附加到可排序之前修改它。这怎么可能？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T07:16:36.863

在`drop`您的 droppabale 容器中，您可以访问`ui`包含有关已拖动的所有信息的变量`div`。

```
$("ul:first li", $tabs).droppable({
  accept: ".sortable .dragItem",
  hoverClass: "ui-state-hover",
  start: function (event, ui) {},
  stop: function (event, ui) {},
  receive: function (event, ui) {},
  drop: function (event, ui) {

    //Here you can manipulate the dragged item to create whatever you want
    var newDiv = '<div class="sortableItem">'+ui.draggable.html()+'toto</div>';

    //Add the new data to your container
    $(this).append(newDiv);
    //Or add to another container
    //$('#sortable1').append(newDiv);

    //Return true
    return true;
  } 
```

# java - Android [字符串数组] 无法解析或不是字段

> ID：14359676
> 
> 赞同：2
> 
> 时间：2013-01-16T13:34:08.120
> 
> 标签：java, android

我收到关于`strings.xml`无法解析的字符串数组（位于 中）的错误。

我已经完成了互联网上所说的一切：

1.  重启 Eclipse
2.  `gen`删除了文件夹内的我的 R.java 文件
3.  我`values`的文件夹仍在`res`文件夹内，没有移动
4.  我的 XML 文件都没有错误
5.  冉`Project -> Clean`
6.  我的班级没有`android.R`导入。
7.  检查了`R.java`类，它确实没有`app_categories`属性（我的数组的名称）

XML的相关部分：

```
<string-array name="app_categories">
    <item >Cat 1</item>
    <item >Cat 2</item>
    <item >Cat 3</item>
    <item >Cat 4</item>
    <item >Cat 5</item>
    <item >Cat 6</item>
    <item >Cat 7</item>
    <item >Cat 8</item>
    <item >Cat 9</item>
</string-array> 
```

Java 代码：

```
String[] categoryNames = getResources().getStringArray(R.string.app_categories); 
```

我所有的其他字符串都是可见的。我定义了另一个数组，就像这个数组一样，那个数组也不可见。

下面的确切错误：

```
app_categories cannot be resolved or is not a field [class_name].java   [path]  line 45 Java Problem 
```

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T13:45:09.293

试试这种方式：

> ```
>  getResources().getString(R.array.app_categories_list); 
> ```

而不是`R.string`使用`R.array`，您将获得您的数组列表。

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T13:42:49.100

不要将字符串数组放在strings.xml 中 您必须创建一个名为arrays.xml 的新文件并将它们放在那里。打电话时你需要 R.arrays.myarray，而不是 R.strings.MyArray

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:45:36.047

清理项目后，尝试通过从命令行运行 adb kill-server 和 adb start-server 来重新启动 adb 服务器

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-11-04T21:30:52.013

一个解决方案可能是手动创建 R：

只需将鼠标悬停在问题所在的活动文件中的错误上，然后手动创建它，这将导致 R 生成您在*strings.xml中创建的字符串数组*

# javascript - 如何忽略范围内属性的变化？

> ID：14359681
> 
> 赞同：0
> 
> 时间：2013-01-16T13:34:27.527
> 
> 标签：javascript, angularjs

在一些复杂的场景中，人们可能希望忽略属性更改，因为它可能引发堆栈溢出。

检查这个：

```
$scope.father = {
    name: "John",
    children: []
};
var child = {
    name: "Mary",
    father: $scope.father
};
$scope.father.children.push(child); 
```

这会创建无限递归，导致堆栈溢出，因为 angularjs 试图遍历所有属性以进行脏检查。

是否有前缀或其他东西可以让我强制 angularjs 忽略观看该属性？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T15:39:59.767

除非您将[$watch](http://docs.angularjs.org/api/ng.%24rootScope.Scope#%24watch)的 objectEquality 参数设置为`true`，否则 $watch 不应该进行“浅层”脏检查（即比较每个对象属性）——它应该只检查对象现在是否正在引用其他对象。

这是一个在更改 name 属性时会注意但不会注意到的小提琴（单击超链接以更改名称）[。](http://jsfiddle.net/mrajcok/7N2pp/)`father`

如果我放入`{{father}}`HTML/视图，Chrome 会注意到循环结构，而不是堆栈溢出：

```
TypeError: Converting circular structure to JSON
  at Object.stringify (native)
  at toJson (http://ajax.googleapis.com/ajax/libs/angularjs/1.0.3/angular.js:721:15) 
```

只是好奇，你在做什么来查看堆栈溢出（以及什么浏览器）？

# c# - 在 ItemUpdating 时如何获取 Listitem 的当前编辑器？

> ID：14359686
> 
> 赞同：1
> 
> 时间：2013-01-16T13:34:52.917
> 
> 标签：c#, sharepoint, sharepoint-2010, event-handling, synchronous

如何在 ItemUpdating 期间获取 SharePoint 2010 中列表项的当前编辑器？

问题是`properties.AfterProperties["Editor"].ToString()`throws 和 Ecxeption 导致它为空。这`properties.ListItem["Editor"].ToString()`是没用的，因为我得到了上次进行更改的编辑器。

猜猜我如何在更新期间实现这一点？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T15:06:36.893

好的发现没有办法以这种方式获得它。

这对我有用：`properties.UserDisplayName`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T16:25:26.200

检查字段修改者的内部名称

ListItem.ParentList.Fields [“修改者”]。内部名称

它可能是“_Editor”或其他。

# javascript - 使用 javascript 列出 Web 目录

> ID：14359688
> 
> 赞同：1
> 
> 时间：2013-01-16T13:35:05.467
> 
> 标签：javascript, jquery

我的网站上有以下语言选择器小部件：

```
jQuery(function($) {

  var setLng = $.url().param('setLng');
  var setLngCookie = $.cookie('i18next');
    var language;

  if (setLngCookie) {
        language = setLngCookie;
  }
  else {
        if (setLng) {
            language_complete = setLng.split("-");
        } else {
            language_complete = navigator.language.split("-");
        }

        language = (language_complete[0]);
  }

  //Build the language selector.
    $.getJSON("../locales/config.json", function(objData) {
      var arrHtml = [];
        var strClass;

      $.each(objData, function(strKey, objLanguage) {
            strClass = (language == objLanguage.locale) ? " class=\"selected-language\"" : ""; //Make sure the language selector has the correct language selected on initial page load.
            arrHtml.push("<a id=\"lang-" + objLanguage.locale + "\" data-i18n=\"language." + objLanguage.locale + "\"" + strClass + "></a>");
      });

      $("<div/>", {
            'class': 'language-list',
            html: arrHtml.join('')
      }).appendTo('#language-menu');

        $("li.language-menu").live("click", function(){
            $("#language-menu").toggle();
        });
    });

  function setLanguage() {
    // save to use translation function as resources are fetched
    $(".tzm-i18n").i18n();
    $(".page-i18n").i18n();
    $(".menu").i18n();
    $(".user-menu").i18n();
    $(".search-form").i18n();
    $(".footer-i18n").i18n();

        $("#language-menu").hide();
  }

  i18n.init({
    lng: language,
    debug: true
  }, setLanguage);

  // language selector
  $("#language-menu a").live("click", function() {
    var booReload = false; // TRUE = reload the page; FALSE = do not reload the page
        var $this = $(this);
    var value = $this.attr("id");
    var arrValueParts = value.split("-");
    var language = arrValueParts[1];

    if (booReload) {
      window.location.href = "/index.html?setLng=" + language;
    } else {
      i18n.init({
        lng: language,
        debug: true
      }, setLanguage);
    }

        $("#language-menu a").removeClass("selected-language");
        $this.addClass("selected-language");
  });

}); 
```

和

```
(zmgc)☺  tree -L 2 locales 
locales
├── README.md
├── config.json
├── de
│   └── translation.json
├── dev
│   └── translation.json
├── en
│   └── translation.json
├── fr
│   └── translation.json
├── jp
│   └── translation.json
├── pt
│   └── translation.json
├── rs
│   └── translation.json
├── ru
│   └── translation.json
└── us
    └── translation.json 
```

所以每次我在 locals/xx 中添加一个目录，其中 xx 是来自 IETF 语言标签的国家代码，我必须手动更新 ../locales/config.json ！

locals/config.json

```
{
    "de": {
        "locale": "de",
        "code": "de-DE"
    },
    "en": {
        "locale": "en",
        "code": "en-UK"
    },
    "fr": {
        "locale": "fr",
        "code": "fr-FR"
    },
    "jp": {
        "locale": "jp",
        "code": "jp-JP"
    },
    "pt": {
        "locale": "pt",
        "code": "pt-BR"
    },
    "rs": {
        "locale": "rs",
        "code": "rs-RS"
    },
    "ru": {
        "locale": "ru",
        "code": "ru-RU"
    },
    "us": {
        "locale": "us",
        "code": "en-US"
    }
} 
```

例如 locals/en/translation.json

```
{
  "locale": "en"
  ,"code": "en-UK"
  ,"tzm": "Chapters - Zeitgeist Movement"
  ,"menu": {
    "projects": "Projects"
    ,"map": "Map"
    ,"calendar": "Calendar"
    ,"forums": "Forums"
    ,"more": "More »"
  }
  ,"search": {
    "advanced": "Advanced"
    ,"search": "Search"
  }
  ,"user": {
    "gravatar": "Gravatar"
    ,"profile": "Profile"
    ,"login": "Login"
    ,"log-out": "Log out"
    ,"contact": "Contact"
    ,"help": "Help"
  }
  ,"footer": {
    "zeitgeist": "Zeitgeist"
  }
} 
```

有没有办法通过遍历 locals/ 目录并构建可用语言并从可用语言列表中排除 locals/dev 来构建它？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:38:50.817

不是来自 JavaScript。

我建议您在服务器上构建一个脚本，该脚本将为您生成配置文件。然后，您将能够在客户端上使用相同的代码。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:41:35.667

除非您通过 HTTP 公开目录，否则不会；JavaScript 在客户端上执行，通常不会不受限制地访问服务器端目录布局。

在服务器端构建配置文件，或通过 API 公开文件列表。

# vb.net - 在 VB 中的 PictureBox 中运行应用程序

> ID：14359690
> 
> 赞同：1
> 
> 时间：2013-01-16T13:35:14.833
> 
> 标签：vb.net

对于智能手机模拟，我的目的是在`"screen"`智能手机上运行应用程序，这是一个图片框。到目前为止，我正在使用以下代码：

```
Imports System.Diagnostics
Imports System.Runtime.InteropServices
Public Class Form1
   <DllImport("user32.dll")> Public Shared Function SetParent(ByVal hwndChild As IntPtr, ByVal hwndNewParent As IntPtr) As Integer
    End Function

    Private Sub Button1_Click(ByVal sender As System.Object, ByVal e As System.EventArgs) Handles Button1.Click

        Dim Process1 As New Process
        Process1.StartInfo.FileName = "Application_Name.exe"
        Process1.Start()

        Do Until Process1.WaitForInputIdle = True
            Application.DoEvents()
SetParent(Process1.MainWindowHandle, PictureBox1.Handle)

        Loop

    End Sub
End Class 
```

但是，这实际上并没有将应用程序放在图片框上（应用程序的表单位于其他位置）。我的意图是将应用程序的表单放在图片框上，如果它超过图片框的大小，则显示滚动条。

任何想法将不胜感激。

事实上，运行新应用程序的对象甚至不必是图片框，只要应用程序可以在其中运行即可。谢谢你。

# php - 将 JQuery 数组与 PHP 表单数据一起提交到 PHP 脚本

> ID：14359695
> 
> 赞同：1
> 
> 时间：2013-01-16T13:35:31.950
> 
> 标签：php, jquery

我正在涉足 JQuery，并且遇到了一个我还不太清楚的问题。这是上下文：

我有一个 HTML 表单，使用 MySQL 和 PHP，用于编辑 CMS 帖子。这篇文章将有一个附件列表（例如画廊的图像或可下载的文件）。使用 JQuery，用户可以单击这些列表项元素并在显示的 div 中编辑每个附件的详细信息（例如，删除图像、添加标题等）。

目前，当用户选择删除附件时，我只是淡化其不透明度并向用户提供一个新选项来“撤消”删除。提交完整的父表单（CMS 帖子）后，我想收集所有仍标记为删除的附件，并将它们的 GUID 提交给 PHP 脚本，该脚本正在为我完成所有其余的帖子更新。

选项 A：

*是否可以将 JQuery 数组与通过表单输入自然发送到操作脚本的数据一起提交到 PHP 脚本？*

选项 B：

*是否可以使用 JQuery 动态填充/清空（隐藏）表单输入数组，然后可以自然地将其与其他所有内容一起提交给动作脚本？*

我目前正处于使用必要的 GUID 填充 Javascript 数组的阶段，但现在不知道如何处理它。

```
//populate deleted attachments array
$(document).ready(function() {
  $('#post-editor').submit(function() {
    var arrDeleted = [];    
    $('.deleted-att').each(function(){
      arrDeleted.push({guid: $(this).attr("data-guid")});
    });
    //do something with array
  });
}); 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:41:06.837

`JSON.stringify`并将`arrDeleted`它们放在表单中的隐藏字段中，该字段将被提交。

```
$('#post-editor').submit(function() {
    var arrDeleted = [];    
    $('.deleted-att').each(function(){
        arrDeleted.push({guid: $(this).attr("data-guid")});
    });
    $('#post-hidden').val(JSON.stringify(arrDeleted));
}); 
```

在您的 html 中的某处：

```
<form id="post-editor">
    <input type="hidden" id="post-hidden" name="post-hidden" />
    <!-- ... other fields ... -->
 </form> 
```

然后`json_decode($_POST['post-hidden'])`在服务器上获取阵列。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:43:11.990

在您的表单中创建一个隐藏字段..`arrDeleted`通过jquery将值放入您的输入中并发布表单..`json_decode()`使用获取发布的值...

```
<input  type="hidden" id="hidden"/> 
```

**查询**

```
$(document).ready(function() {
   $('#post-editor').submit(function() {
   var arrDeleted = [];    
   $('.deleted-att').each(function(){
    arrDeleted.push({guid: $(this).attr("data-guid")});
  });
   $('#hidden').val(JSON.stringify(arrDeleted));
 });
}); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:45:07.150

最简单的做法是将隐藏的输入字段添加到 HTML 表单

然后在jQuery中做这样的事情

```
$('form').submit(function() {
    $('#hidden_id_field').val( arrDeleted.join(',') );
}); 
```

在这种情况下， arrDeleted 是您已经设置的阵列。它会发送一个逗号分隔的列表，然后在您的 PHP 中拆分这些值并按照您的意愿行事。

通常我只是做 AJAX 并将 JSON 发送到我的应用程序。但是，如果您真的想那样做，上述方法将起作用。它的优点是在您提交表单之前不会实际删除服务器上的任何内容。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:58:23.287

您可能希望通过传统的表单提交和刷新来执行此操作，但如果您愿意异步提交请求，则可以使用 jQuery 提交表单并序列化已删除项目的数组：

```
var form = $('#post-editor');
form.submit(function() {
  var arrDeleted = [];    
  $('.deleted-att').each(function(){
    arrDeleted.push({ // The format $.serializeArray produces.
      name: "deleted",
      value: $(this).attr("data-guid")
    });
  });

  var formData = form.serializeArray();
  // Add values to existing form data
  formData = formData.concat(arrDeleted);

  $.ajax({
    url: form.attr('action'),
    data: formData
    // Other ajax options
  });
}); 
```

在 PHP 端，引用`$_REQUEST['deleted']`将返回一个 GUID 数组。

# windows-phone-7 - 有没有办法在 windows phone 7.1 中使用纬度和经度来获取 Zip 和地址？

> ID：14359704
> 
> 赞同：0
> 
> 时间：2013-01-16T13:36:03.607
> 
> 标签：windows-phone-7, location, windows-phone-7.1, zipcode, windows-phone-7.1.1

我已经使用 Bing Maps key reversegeocode 来获取地址，我也得到了想要的结果，但它需要 bing 密钥在 90 天内过期。所以它不是更好的使用方法。

我也尝试过 CivicAddressResolver 来获得相同的结果，但它没有返回任何地址。我不知道为什么。

我也尝试过 google api，我得到了答案，但它有使用限制，每天可以使用 2500 次。

最后，我尝试了 ReverseGeocodeQuery 方法来获得相同的结果，但它仅适用于 windows phone 版本 8。

我需要在 windows phone 7.1 版上发生同样的事情。

请回复。

提前致谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-18T05:29:26.697

谷歌可能拥有最好的服务，前 6 个月免费，之后每月 10 美元。这是一个非常合理的价格，并且拥有 99.9% 的正常运行时间和快速的服务器，它比您从任何免费服务甚至大多数其他付费服务中获得的要好很多。

[https://developers.google.com/maps/documentation/business/geolocation/](https://developers.google.com/maps/documentation/business/geolocation/)

如果您迫切需要免费的，我听说 Geonames 还可以。不过，您不会以非常适中的价格击败 Google 所能提供的。应该注意的是，如果您每月超过 10,000 次请求，您必须支付超额费用，但如果您的应用程序如此受欢迎，您可以通过它获利来补贴......

**编辑** 刚刚注意到你已经提到了谷歌，但就像我说的，如果你预计每天有接近 2,500 个请求，如果它花费一点有什么关系？！？

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T00:46:00.710

您将不得不使用替代服务来获取邮政编码/地址。Rohith 在评论中链接到的问题有一个很好的选择：[Nominatim](http://wiki.openstreetmap.org/wiki/Nominatim#Reverse_Geocoding_.2F_Address_lookup)。另一种选择也是[Geonames](http://www.geonames.org/export/reverse-geocoding.html)，它也有一些反向地理编码。

# php - 使用 PHP 在 LDAP 中搜索更多 OU 中的用户

> ID：14359714
> 
> 赞同：1
> 
> 时间：2013-01-16T13:36:42.343
> 
> 标签：php, ldap

我的任务最终是实施单点登录解决方案，使用存储在他工作机器中的 AD 凭据将用户登录到我的系统。我正在使用[`ldap_`PHP 中的函数](http://php.net/ref.ldap)。

我遇到的问题是我必须针对多个 OU（目前大约 30 个）检查凭据，而且我还没有找到从 AD 系统获取这些 OU 的方法，所以我有一大堆 OU作为权宜之计。我通过 ADexplorer 获得了这份清单。有没有办法用 PHP 做到这一点？

我的第一语言不是英语，所以我让 Adriano 为我翻译这个，而且我在理解文档时也遇到了问题。

在这个阶段，我基本上是从[ldap_search 手册页](http://php.net/manual/es/function.ldap-search.php)的示例中复制这段代码：

```
<?php
$ds=ldap_connect($ldapserver);

// 42 OUs in our case
$dn[]='OU=ABC,DC=xyz,DC=ac,DC=uk';
$dn[]='OU=DEF,DC=xyz,DC=ac,DC=uk';
// ...

$totalDns = count($dn);
for ($i = 0; $i < $totalDns; $i++) {
    $id[] = $ds;
}

$filter = 'samaccountname='.$_POST['username'];

$result = ldap_search($id,$dn,$filter);

$search = false;

foreach ($result as $value) {
    if(ldap_count_entries($ds,$value)>0){
        $search = $value;
        break;
    }
}

if($search){
    $info = ldap_get_entries($ds, $search);
}else{
    $info = 'No results found';
} 
```

**更新**

我尝试了 Vladislav Ross 建议的解决方案，几秒钟后，服务器吐出这个：

```
mod_fcgid: stderr: PHP Warning:  ldap_search() [<a href='function.ldap-search'>function.ldap-search</a>]: Search: Can't contact LDAP server in ... on line 28 
```

如果我在同一搜索中添加特定的 OU，则不会发生这种情况。IE 如果我这样做

```
$sr = ldap_search(
     $ds,
     "OU=Usuarios,dc=test,dc=com",
     "ObjectClass=organizationalUnit",
     array("")
); 
```

代替

```
$sr = ldap_search(
      $ds,
      "dc=test,dc=com",
      "ObjectClass=organizationalUnit",
      array("")
); 
```

我确实得到了正确的结果。我尝试将 timelimit 和 sizelimit 参数设置为 0，但结果相同。我现在正在咨询服务器人员，看看他们的限制是什么。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:47:58.897

尝试使用带有过滤器 ObjectClass=organizationalUnit 的 ldap_search：

```
 $ds = ldap_connect($AD_server);
    if(!$ds) die("cannot connect to LDAP server at $AD_server.");

    $r = ldap_bind($ds, $AD_Auth_User, $AD_Auth_PWD);
    if(!$r)
    {
        ldap_get_option($ds,LDAP_OPT_ERROR_STRING,$error);
        die("cannot bind to LDAP server at $AD_server ($error).");
    };

    $sr=ldap_search($ds,"dc=test,dc=com","ObjectClass=organizationalUnit",array(""));
    $info = ldap_get_entries($ds, $sr);

    print_r($info); //<--array with OU's you need 
```

如果不需要递归搜索，请使用 ldap_list 而不是 ldap_search。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-17T14:09:51.377

听起来您想对域中的任何用户进行身份验证。不要搜索多个 DN，只需从域的根目录搜索一次。因此，不要使用`'OU=ABC,DC=xyz,DC=ac,DC=uk'`，而是使用`'DC=xyz,DC=ac,DC=uk'`。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-18T14:26:11.690

> *我还没有找到从 AD 系统获取这些 OU 的方法*

您上面的示例表明这些 OU 是DC=xyz,DC=ac,DC=uk的***直接子代？***如果是这样，找到这些的最有效的 LDAP 搜索是：

*   搜索库：DC=xyz,DC=ac,DC=uk
*   搜索范围：**onelevel** <--搜索库的***直接****子级*
*   搜索过滤器：（objectclass=organizationalUnit）

像这样使用相应的 ldapsearch 命令行进行测试...

```
ldapsearch -h <hostname> -s onelevel -b "DC=xyz,DC=ac,DC=uk" "(objectclass=organizationalUnit)" 
```

# ios - 如何使用 NSNumberFormatter 向 NSString 插入空格？

> ID：14359717
> 
> 赞同：2
> 
> 时间：2013-01-16T13:36:47.063
> 
> 标签：ios, objective-c

我想写一个`UITextField`可以自动将数字格式化为银行号码的。

例如：输入`1234567890098765`会自动显示为`1234 5678 9009 8765`.

我会使用`textFieldDelegate`它，但我不知道如何使用`NSNumberFormatter`.

我该怎么做？

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-16T15:19:32.683

使用`NSNumberFormatter`很简单。

```
NSNumber *number = [NSNumber numberWithLongLong:1234567890098765];
NSNumberFormatter *formatter = [NSNumberFormatter new];
[formatter setUsesGroupingSeparator:YES];
[formatter setGroupingSize:3];
// [formatter setGroupingSeparator:@"\u00a0"];
NSString *string = [formatter stringFromNumber:number]; 
```

I deliberately commented the line that sets the formatter's grouping separator as it may be better to use the default one, which is provided by the user's locale (e.g. `,` in the USA, `.` in Germany and `'` in Switzerland). Also please note that iOS doesn't use a space as a separator but a non-breaking space (`U+00A0`).

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:45:26.010

试试这个 ：-

```
-(BOOL)textField:(UITextField *)textField shouldChangeCharactersInRange:(NSRange)range replacementString:(NSString *)string {

   NSString *text = [textField text];

    NSCharacterSet *characterSet = [NSCharacterSet characterSetWithCharactersInString:@"0123456789\b"];
    string = [string stringByReplacingOccurrencesOfString:@" " withString:@""];
    if ([string rangeOfCharacterFromSet:[characterSet invertedSet]].location != NSNotFound) {
        return NO;
    }

    text = [text stringByReplacingCharactersInRange:range withString:string];
    text = [text stringByReplacingOccurrencesOfString:@" " withString:@""];

    NSString *newString = @"";
    while (text.length > 0) {
        NSString *subString = [text substringToIndex:MIN(text.length, 4)];
        newString = [newString stringByAppendingString:subString];
        if (subString.length == 4) {
            newString = [newString stringByAppendingString:@" "];
        }
        text = [text substringFromIndex:MIN(text.length, 4)];
    }

    newString = [newString stringByTrimmingCharactersInSet:[characterSet invertedSet]];

    if (newString.length >= 20) {
        return NO;
    }

    [textField setText:newString];

    return NO;
    } 
```

希望这可以帮助你..

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T14:53:02.443

我有一个 c++ 解决方案，也许你可以把你的字符串改成 cstring 然后改回来

```
char s[50]={'\0'},ch[99]={'\0'};
int i,j,k,len;
printf("input a string:\n");
scanf("%s",s);
len=strlen(s);
k=0;
for(i=0;i<len;i+=4)
{
    for(j=0;j<4;j++)
    {
        *(ch+k)=*(s+i+j);
        k++;

    }
        *(ch+k)=' ';
        k++;
}
printf("%s\n",ch); 
```

# lucene - 提升文档是否适用于通配符搜索？

> ID：14359723
> 
> 赞同：1
> 
> 时间：2013-01-16T13:36:53.827
> 
> 标签：lucene, ravendb

给定以下索引定义，当使用诸如查询之类的查询时是否会应用提升`Content:(Morel*)`？

我在数据库中添加了两个文档，一个是 type `Article`，一个是 type `Response`。两者都具有相同`Title`的 ,`Body`和`Tags`。当我对 Raven Studio 中的索引运行上述查询时，两个文档都返回相同的`$Temp:Score`.

```
AddMap<Article>(docs => from doc in docs
                        select new
                        {
                            Content = new object[]
                            {
                                 doc.Title,
                                 doc.Body,
                                 doc.Tags
                            }
                         }.Boost(5));  // <-- Boost Article documents.

AddMap<Response>(docs => from doc in docs
                         select new
                         {
                             Content = new object[]
                             {
                                  doc.Title,
                                  doc.Body,
                                  doc.Tags
                             }
                          });

Index("Content", FieldIndexing.Analyzed); 
```

我正在使用以下代码进行搜索

```
var searchTerms = string.Join(" OR ",  
                              q.Split(new[] { ' ' },   
                                      StringSplitOptions.RemoveEmptyEntries)  
                               .Select(x => string.Format("{0}*",x)));
var query = RavenSession.Advanced
                        .LuceneQuery<IIndexedEntity, AllDocumentByContent>()
                        .Include(x => x.Author)
                        .Search("Content", searchTerms); 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T21:16:36.537

是的，它将在您进行查询时应用。

# r - 根据R中的第一列对矩阵进行排序

> ID：14359726
> 
> 赞同：50
> 
> 时间：2013-01-16T13:37:00.717
> 
> 标签：r

我有一个包含以下形式的两列的矩阵：

```
1 349
1 393
1 392
4 459
3 49
3 32
2 94 
```

我想根据第一列按升序对该矩阵进行排序，但我想将相应的值保留在第二列中。

输出将如下所示：

```
1 349
1 393
1 392
2 94
3 49
3 32
4 459 
```

* * *

## 回答 #1

> 赞同：52
> 
> 时间：2013-01-16T13:40:40.087

读取数据：

```
foo <- read.table(text="1 349
  1 393
  1 392
  4 459
  3 49
  3 32
  2 94") 
```

并排序：

```
foo[order(foo$V1),] 
```

`order`这依赖于使关系保持原始顺序的事实。见`?order`。

* * *

## 回答 #2

> 赞同：12
> 
> 时间：2013-01-16T14:46:20.967

创建一个`data.table`with`key=V1`会自动为你做这件事。使用斯蒂芬的数据`foo`

```
> require(data.table)
> foo.dt <- data.table(foo, key="V1")
> foo.dt
   V1  V2
1:  1 349
2:  1 393
3:  1 392
4:  2  94
5:  3  49
6:  3  32
7:  4 459 
```

* * *

## 回答 #3

> 赞同：8
> 
> 时间：2017-05-02T09:30:34.920

请注意，如果您想以相反的顺序获取值，您可以轻松地这样做：

```
> example = matrix(c(1,1,1,4,3,3,2,349,393,392,459,49,32,94), ncol = 2)
> example[order(example[,1], decreasing = TRUE),]
     [,1] [,2]
[1,]    4  459
[2,]    3   49
[3,]    3   32
[4,]    2   94
[5,]    1  349
[6,]    1  393
[7,]    1  392 
```

* * *

## 回答 #4

> 赞同：2
> 
> 时间：2019-02-27T19:04:17.497

如果您的数据位于名为 的矩阵中`foo`，您将运行的行是

`foo.sorted=foo[order[foo[,1]]`

* * *

## 回答 #5

> 赞同：1
> 
> 时间：2019-09-09T07:14:00.567

除非您将其应用于向量，否则接受的答案就像一个魅力。由于向量是非递归的，你会得到这样的错误

```
$ operator is invalid for atomic vectors 
```

你可以`[`在这种情况下使用

```
foo[order(foo["V1"]),] 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2018-03-30T08:56:33.187

你不需要`data.table`。

这就是你需要的，你的数据矩阵在`A[order(A[,1]), ]`哪里。`A`

# c - 使用参数调用 Linux 服务

> ID：14359727
> 
> 赞同：-2
> 
> 时间：2013-01-16T13:37:02.403
> 
> 标签：c, linux, service, daemon

我的 Linux 操作系统中有一个守护进程，我想在守护进程运行时将参数从另一个 C 文件传递​​给该守护进程，该 C 文件是守护进程控制器。

我用谷歌搜索它，但直到现在我手里什么都没有。您能否提供一些技巧，并且可能是这样做的一个例子？

我拥有的守护进程是从这个网站复制/粘贴：[http ://www.enderunix.org/docs/eng/daemon.php](http://www.enderunix.org/docs/eng/daemon.php)

```
/*
UNIX Daemon Server Programming Sample Program
Levent Karakas <levent at mektup dot at> May 2001

To compile: cc -o exampled examped.c
To run:     ./exampled
To test daemon: ps -ef|grep exampled (or ps -aux on BSD systems)
To test log:    tail -f /tmp/exampled.log
To test signal: kill -HUP `cat /tmp/exampled.lock`
To terminate:   kill `cat /tmp/exampled.lock`
*/

#include <stdio.h>
#include <fcntl.h>
#include <signal.h>
#include <unistd.h>

#define RUNNING_DIR "/tmp"
#define LOCK_FILE   "exampled.lock"
#define LOG_FILE    "exampled.log"

void log_message(filename,message)
char *filename;
char *message;
{
FILE *logfile;
    logfile=fopen(filename,"a");
    if(!logfile) return;
    fprintf(logfile,"%s\n",message);
    fclose(logfile);
}

void signal_handler(sig)
int sig;
{
    switch(sig) {
    case SIGHUP:
        log_message(LOG_FILE,"hangup signal catched");
        break;
    case SIGTERM:
        log_message(LOG_FILE,"terminate signal catched");
        exit(0);
        break;
    }
}

void daemonize()
{
int i,lfp;
char str[10];
    if(getppid()==1) return; /* already a daemon */
    i=fork();
    if (i<0) exit(1); /* fork error */
    if (i>0) exit(0); /* parent exits */
    /* child (daemon) continues */
    setsid(); /* obtain a new process group */
    for (i=getdtablesize();i>=0;--i) close(i); /* close all descriptors */
    i=open("/dev/null",O_RDWR); dup(i); dup(i); /* handle standart I/O */
    umask(027); /* set newly created file permissions */
    chdir(RUNNING_DIR); /* change running directory */
    lfp=open(LOCK_FILE,O_RDWR|O_CREAT,0640);
    if (lfp<0) exit(1); /* can not open */
    if (lockf(lfp,F_TLOCK,0)<0) exit(0); /* can not lock */
    /* first instance continues */
    sprintf(str,"%d\n",getpid());
    write(lfp,str,strlen(str)); /* record pid to lockfile */
    signal(SIGCHLD,SIG_IGN); /* ignore child */
    signal(SIGTSTP,SIG_IGN); /* ignore tty signals */
    signal(SIGTTOU,SIG_IGN);
    signal(SIGTTIN,SIG_IGN);
    signal(SIGHUP,signal_handler); /* catch hangup signal */
    signal(SIGTERM,signal_handler); /* catch kill signal */
}

main()
{
    daemonize();
    while(1) sleep(1); /* run */
}

/* EOF */ 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:01:46.813

您没有明确说明控制器是相关进程（从共同的父进程开始）还是不相关的进程。如果它是相关的，你可以安排在控制器和守护进程之间有一个管道；如果没有，您可以使用 Unix 域套接字（参见 manpage unix(7)）或 FIFO（mknod*文件名*p）。无论哪种方式，将“睡眠”调用替换为包含“选择”或“轮询”调用的块，在控制流和任何其他感兴趣的文件或套接字上查找数据，如果数据可用，请读取它，解析它，并采取行动。

# python - 什么时候应该在 Twisted 中将协议处理代码拆分为 Deferreds？

> ID：14359730
> 
> 赞同：1
> 
> 时间：2013-01-16T13:37:16.580
> 
> 标签：python, twisted

在 Twisted 中实现客户端协议，我当前的代码在收到的每个协议单元上做了很多工作，它不使用 I/O，因此当前没有使用延迟。该处理并不意味着密集，但它对可插拔接口开放。

做这个分区有门槛吗？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:46:24.387

您可能会考虑在将要调用插件的位置“延迟”，因为您无法预测它们是否会对数据库、远程进程、Web 服务等进行任何 I/O。

研究using ，这将简化您的生活，只需使用 Python 的语句[`@inlineCallbacks`](http://twistedmatrix.com/documents/8.1.0/api/twisted.internet.defer.html#inlineCallbacks)将您的处理分解为 Deferreds 。`yield`然后你可以尝试以各种方式分解你的计算密集型工作，也许是为了让其他协议处理程序有机会运行和完成，特别是如果一些处理程序是计算密集型而其他处理程序不是。

# iphone - 将两个 CAF 文件混合在一起

> ID：14359731
> 
> 赞同：1
> 
> 时间：2013-01-16T13:37:18.123
> 
> 标签：iphone, ios, objective-c, avaudiorecorder

我在这里有一个问题，混合两个 CAF 文件。

**第一个 CAF 文件 ->**通过服务器端的给定 url 获取

**第二个 CAF 文件 ->**使用 AVAudioRecorder 录制

**获取文件大小 -** 10 秒

**录制文件大小 -** 7 秒

如何将这两个给定的音频文件混合在一个文件中，请给我一些相同的示例代码。此外，格式必须仅在 CAF 中。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T19:00:45.683

AVFoundation 框架中的一个 AVMutableComposition 可以做到这一点；你做类似的事情

```
AVMutableComposition *comp = [AVMutableComposition new];
AVMutableCompositionTrack *compTrack1 = [comp addMutableTrackWithMediaType:AVMediaTypeAudio 
    preferredTrackId:kCMPersistentTrackID_Invalid];
AVMutableCompositionTrack *compTrack2 = [comp addMutableTrackWithMediaType:AVMediaTypeAudio 
    preferredTrackId:kCMPersistentTrackID_Invalid];

AVAssetTrack *srcTrack1 = UseAVAssetToGetTrackfromFirstFile();
AVAssetTrack *srcTrack2 = UseAVAssetToGetTrackfromSecondFile();

NSError *error = nil;

    [compTrack1 insertTimeRange:CMTimeRangeMake(kCMTimeZero, kCMTimePositiveInfinity)
                            ofTrack:srcTrack1  
                             atTime:kCMTimeZero error:&error];

    CheckForError(error);

    [compTrack2 insertTimeRange:CMTimeRangeMake(kCMTimeZero, kCMTimePositiveInfinity)
                            ofTrack:srcTrack2  
                             atTime:kCMTimeZero error:&error];

    CheckForError(error);

// emit mix from the composition here with a reader or whatever. 
```

您也可以设置与组合的相对级别。但是，如果您需要做的不仅仅是关卡和平移，那么您必须创建一个 AudioUnit 图表。

# cryptography - 知道这是什么加密

> ID：14359748
> 
> 赞同：0
> 
> 时间：2013-01-16T13:38:36.753
> 
> 标签：cryptography, encryption

我有以下具有纯文本等价物的加密字符串：

```
01b6e203 = to
8d777f38 = data
b068931c = name
c34487c9 = subject
0c83f57c = email
865c0c0b = i 
```

知道什么样的算法/加密/混淆可以产生它们吗？我不知道，在谷歌上检查了一个小时，想到了 crc32，但不是……谷歌上关于加密字符串“8d777f38”的唯一发现是`Grid Account Username: **data**. Grid Account Identifier: **8d777f38**-5d3d-3ec8-815d-20f7496026dc`

谢谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:50:08.617

由于代码的长度都相同，而且长度似乎太短而无法将数据保存在较长的字符串中，因此它似乎是哈希码而不是加密。

例如，它可以是 MD5 散列的字节的第一个，也可以是 CRC32 散列。您只需使用最常见的散列算法获取文本的散列码，然后查看是否可以在结果中找到这些码。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:03:47.240

请注意，不仅存在一种 CRC-32 代码，而且存在许多可用的生成多项式，其中一个系数非常少的多项式由于性能原因而被广泛使用。

它也可以是 MAC（消息验证码，一种抑制中间结果块的密码块链接加密），其中有时在每个字节都很重要的环境中使用四字节变体，例如在智能卡中。由于 MAC 涉及密钥：

1.  只有知道密钥的授权方才能验证它
2.  蛮力仍然是一些工作

# sql - 如何在 SQL 中返回每个组的增量组号

> ID：14359749
> 
> 赞同：69
> 
> 时间：2013-01-16T13:38:37.900
> 
> 标签：sql, sql-server, tsql, group-by

我想在 SQL 中创建一个数据查询，以递增地对行组进行编号，按共同的日期时间分组，并保持“组编号”在下一个日期时间递增，依此类推。正如我在使用 partition by 语句时看到的那样，这些“组号”不能为每个组重置。这是我的示例数据：

```
ts_DateTime          |ID   |Value|RowFilter|RequiredResult
--------------------------
2013/01/09 09:23:16  |8009 |0    |1        |1
2013/01/09 09:23:16  |8010 |0    |2        |1
2013/01/09 09:23:16  |8026 |0    |3        |1

2013/01/09 09:23:22  |8026 |0    |1        |2

2013/01/09 09:23:28  |8009 |0    |1        |3
2013/01/09 09:23:28  |8010 |0    |2        |3
2013/01/09 09:23:28  |8026 |0    |3        |3

2013/01/09 09:27:03  |8009 |0    |1        |4
2013/01/09 09:27:03  |8010 |0    |2        |4
2013/01/09 09:27:03  |8026 |0    |3        |4

2013/01/09 09:27:09  |8009 |0    |1        |5
2013/01/09 09:27:09  |8010 |0    |2        |5
2013/01/09 09:27:09  |8026 |0    |3        |5

2013/01/09 09:27:15  |8009 |0    |1        |6
2013/01/09 09:27:15  |8010 |0    |2        |6
2013/01/09 09:27:15  |8026 |0    |3        |6 
```

我用来获取这些结果的查询是：

```
select hl.ts_DateTime,  hl.Tagname as [ID],  hl.TagValue as [Value],
ROW_NUMBER() OVER (PARTITION BY hl.ts_datetime ORDER BY hl.tagname) AS RowFilter
from Table1 hl 
```

所以基本上，查看 RowFilter 列，我得到每个`ts_DateTime`分区的唯一 ROW 编号。我真正需要的是，对于每个`ts_DateTime`分区，RowFilter 列应该看起来像所需的结果列。

* * *

## 回答 #1

> 赞同：120
> 
> 时间：2013-01-16T13:56:10.143

你不应该使用`ROW_NUMBER()`,

*   `DENSE_RANK()`改为使用
*   消除`PARTITION BY`

询问，

```
SELECT hl.ts_DateTime,  
       hl.Tagname as [ID],  
       hl.TagValue as [Value],
       DENSE_RANK() OVER (ORDER BY ts_datetime) AS RowFilter
FROM   Table1 hl 
ORDER  BY RowFilter 
```

*   [SQLFiddle 演示](http://sqlfiddle.com/#!3/a333f/7)

* * *

## 回答 #2

> 赞同：10
> 
> 时间：2018-03-04T22:07:01.910

我想你正在寻找这个：

```
ROW_NUMBER() OVER (PARTITION BY hl.id ORDER BY hl.ts_DateTime) AS RowFilter 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2021-04-11T14:43:41.663

-- 这是我的回答 Mr.Chris Ballance ：

```
select 
   hl.ts_DateTime,  hl.Tagname as [ID],  hl.TagValue as [Value],
   ROW_NUMBER() OVER (PARTITION BY hl.ts_datetime ORDER BY hl.tagname) AS RowFilter,
   DENSE_RANK() OVER (PARTITION BY hl.ts_datetime ORDER BY hl.Tagname) AS RequiredResult
from Table1 h1 
```

--试试这个它对我有用......

# ipad - iPad/Safari 滚动条一直跳到顶部

> ID：14359751
> 
> 赞同：2
> 
> 时间：2013-01-16T13:38:42.643
> 
> 标签：ipad, safari, scroll

我有一个简单的溢出-y：滚动。在网络上它工作正常，并且 div 的内容滚动。

但在 iPad 上，有时当从滚动中释放触摸时，它会突然跳到顶部。每次滚动到底部时。

这也影响了 iTunes 商店，在我们的元标记中，当在顶部“弹跳”时，它会显示指向应用程序的链接。

# c - 正确删除多个进程使用的 SYS V 信号量

> ID：14359753
> 
> 赞同：1
> 
> 时间：2013-01-16T13:38:49.273
> 
> 标签：c, semaphore, sysv

我有一个项目，我必须使用 SYS V 信号量。我有几个进程共享一个信号量（使用相同的键）并使用以下代码对其进行初始化：

```
bool semaphore_init(semaphore_id_t* sem, int sem_value, key_t key)
{
    /* Try to get a semaphore, to check if you will be an owner */
    *sem = semget(key, 1, IPC_CREAT | IPC_EXCL | 0666);
    if (*sem == -1)
    {
        if (errno == EEXIST)
        {
            /* We are not owners, get semaphore without exclusive flag */
            *sem = semget(key, 1, IPC_CREAT | 0666);
            if (*sem == -1) return false;
        }
        else return false;
    }
    else
    {
        /* We are owners, initialize semaphore */
        int return_value = semctl(*sem , 0, SETVAL, sem_value);
        if (return_value == -1) return false;
    }

    return true;
} 
```

我的问题是：我想在所有使用它的进程终止时删除这个信号量。使用：

```
semctl(*sem, 0, IPC_RMID) 
```

不是一种选择。它立即删除信号量，其他进程得到未定义的行为。我只是找不到使用 SYS V API 的正确方法。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:32:24.617

您可以使用引用计数。只需让每个进程在信号量初始化后递增 ref 计数器，并在进程终止时递减它。最后一个将其减为 0 的也将删除它，或者当它知道所有其他进程已终止时让主进程清理它。

您可能还需要另一种锁定机制来同步对引用计数器的访问，您可能会在生成并等待其他进程的主进程中创建/删除它。

此外，如果您的进程可能异常终止，请注意悬空引用。

# java - 如何在java中创建一个xml文件并从用户输入中附加数据

> ID：14359760
> 
> 赞同：2
> 
> 时间：2013-01-16T13:39:05.863
> 
> 标签：java, xml, append

我已经创建了 xml 文件，但问题是当我添加其他数据时它被覆盖了..我需要一个代码来创建一个新的 xml 文件，如果它不存在，或者如果它退出，则附加到一个 xml 文件......我正在创建一个记录交易记录的日志文件

这是代码：

```
import java.io.*;

import java.io.File;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.OutputKeys;
import javax.xml.transform.Transformer;
import javax.xml.transform.TransformerConfigurationException;
import javax.xml.transform.TransformerException;
import javax.xml.transform.TransformerFactory;
import javax.xml.transform.dom.DOMSource;
import javax.xml.transform.stream.StreamResult;

import org.w3c.dom.Attr;
import org.w3c.dom.DOMException;
import org.w3c.dom.Document;
import org.w3c.dom.Element;

 public class Log_XML {

  static String transaction_type, shop_no, terminal_no;

  static int id = 0;

  public static void main(String[] args) throws IOException, DOMException {
    System.out.println("Enter Id : ");
    BufferedReader br = new BufferedReader(new InputStreamReader(System.in));
    id = Integer.parseInt(br.readLine());

    System.out.println("Enter Transaction type : ");
    transaction_type = br.readLine();

    System.out.println("Shop no : ");
    shop_no = br.readLine();

    System.out.println(“Terminal no : “);
    terminal_no = br.readLine();
     write_XML_File(id);
   }

   public static void write_XML_File(int id) {
      String id_val = Integer.toString(id);
      try {
         DocumentBuilderFactory docFactory = DocumentBuilderFactory.newInstance();
         DocumentBuilder docBuilder = docFactory.newDocumentBuilder();

         Document doc = docBuilder.newDocument();

         Element log1 = doc.createElement("log");
         doc.appendChild(log1);

         Attr attr = doc.createAttribute("id");
         attr.setValue(id_val);
         log1.setAttributeNode(attr);

         Element transaction_type1 = doc.createElement("transaction_type");
         transaction_type1.appendChild(doc.createTextNode(transaction_type));
         log1.appendChild(transaction_type1);

         Element shop_no1 = doc.createElement("shop_no");
         shop_no1.appendChild(doc.createTextNode(shop_no));
         log1.appendChild(shop_no1);

         Element terminal_no1 = doc.createElement("terminal_no");
         terminal_no1.appendChild(doc.createTextNode(terminal_no));
         log1.appendChild(terminal_no1);

          TransformerFactory transformerFactory = TransformerFactory.newInstance();
          Transformer transformer = transformerFactory.newTransformer();
           transformer.setOutputProperty(OutputKeys.INDENT, "yes");
           DOMSource source = new DOMSource(doc);
           StreamResult result = new StreamResult(new File("D:/log_file.xml"));
           transformer.transform(source, result);

           System.out.println("File saved!");
           } catch (ParserConfigurationException e) {
                e.printStackTrace();
           } catch (TransformerConfigurationException e) {
                e.printStackTrace();
            } catch (TransformerException e) {
                e.printStackTrace();
         }
     }
  } 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:46:52.873

如果文件存在：解析它，在适当的位置追加新内容。

如果没有：做你现在正在做的事情。

我将通过以下方式重新使用附加代码：创建一个 DOM 并附加新内容，如前所述，或者将 DOM shell 文件作为资源保存在 jar 中并将其用作默认文档。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:09:58.763

好吧，XML 不是为附加而设计的，因为它被视为具有根元素的树。就像是：

```
<MyRoot>
<innerEll/>
</Myroot> 
```

一旦写入，您就无法附加任何内容，在这种情况下，解决方案与上一篇文章一样：重新阅读，添加新日志....但我认为它不会很好！

如果您决定使用具有 XML 语法但没有 Root 节点的文件，例如

```
<log> .... </log>
<log> .... </log> 
```

然后，您可以从 StringWriter 而不是文件创建 StreamResult。然后您可以从 StringWriter 获取字符串并使用标准 File api 附加字符串。

请注意，您可能必须“过滤掉”可能位于主节点之前的某些 Xml 声明的字符串。

或者，如果您要生成的 XML 非常简单，则通常更容易手动完成：

```
myXML = "<log><Id>" + escapeXML(myId) + "</Id>... 
```

如果您的字符串中有“<”之类的内容，则需要使用 escapeXML 函数。有很多库可以做到这一点（或者你可以实现一个适合你的字符串的简单东西）。或者，如果它变得太复杂，您可以使用 CDATA。

# java - 为锚窗格设置类控制器

> ID：14359763
> 
> 赞同：9
> 
> 时间：2013-01-16T13:39:19.240
> 
> 标签：java, javafx-2, javafx, scenebuilder

使用 JavaFX Scene Builder 时遇到以下问题...

**鉴于：**

一个文件 fxml，包含描述 Anchor Pane（由 Scene Builder 形成的 fxml）；
对于 Anchor Pane，未指定控制器类。
使用 FXMLLoader 将此 fxml 加载到 Java 应用程序中。

**需要：**

下载锚窗格后，将值设置为控制器类。
有必要使用不同的处理程序加载相同的 fxml。

**问题：**有可能吗，如果有的话 - 如何实施？

* * *

## 回答 #1

> 赞同：18
> 
> 时间：2013-01-16T14:44:01.970

加载FXML文件的控制器类也可以通过Scene Builder进行设置。但是您想在应用程序的加载时设置它。为此，您应该在调用 load() 方法之前设置 FXMLLoader 的控制器：

```
AnchorPane rootPane;
MyController controller = new MyController();
FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("my.fxml"));
fxmlLoader.setRoot(rootPane);
fxmlLoader.setController(controller);
fxmlLoader.load(); 
```

# zend-framework - 学说 targetEntity 接口

> ID：14359765
> 
> 赞同：7
> 
> 时间：2013-01-16T13:39:26.010
> 
> 标签：zend-framework, doctrine

我正在尝试将接口用作“targetEntity”。简单的代码应该解释我打算做什么

界面：

```
namespace Project\Entity;

interface AnimalInterface{

} 
```

猫：

```
namespace Project\Entity;
use Doctrine\ORM\Mapping as ORM;
use Project\Entity\AnimalInterface;

/**
 * Represents an Invoice.
 *
 * @ORM\Entity
 * @ORM\Table(name="Cat")
 */
class Cat implements AnimalInterface  {

     /**
     * @var int
     * @ORM\Id @ORM\Column(type="integer", name="id")
     * @ORM\GeneratedValue
     */
     protected $id;
} 
```

狗：

```
namespace Project\Entity;
use Doctrine\ORM\Mapping as ORM;
use Project\Entity\AnimalInterface;

/**
 * @ORM\Entity
 * @ORM\Table(name="Dog")
 */
class Dog implements AnimalInterface  {

     /**
     * @var int
     * @ORM\Id @ORM\Column(type="integer", name="id")
     * @ORM\GeneratedValue
     */
     protected $id;
} 
```

AnimalFarm（只能包含一只动物；））：

```
 namespace Project\Entity;
 use Doctrine\ORM\Mapping as ORM;

 /**
 * @ORM\Entity
 * @ORM\Table(name="AnimalFarm")
 */
class AnimalFarm  {
    /**
     *
     * @var int
     * @ORM\Id @ORM\Column(type="integer", name="id")
     * @ORM\GeneratedValue
     */
     protected $id;

     /**
     * @ORM\ManyToOne(targetEntity="Project\Entity\AnimalInterface")
     * @var AnimalInterface
     */
     protected $animal;

     public function setAnimal(AnimalInterface $animal){
         $this->animal = $animal;
     }
} 
```

我正在使用此处指定的 TargetEntityResolver -> [http://symfony.com/doc/master/cookbook/doctrine/resolve_target_entity.html](http://symfony.com/doc/master/cookbook/doctrine/resolve_target_entity.html)

bootstrap.php（Zend）：

```
 $em = $doctrine->getEntityManager();
    $evm = $em->getEventManager();

    $listener = new  \Doctrine\ORM\Tools\ResolveTargetEntityListener();
    $listener->addResolveTargetEntity(
            'Project\Entity\AnimalInterface',
            'Project\Entity\Dog',
            array()
    );
    $listener->addResolveTargetEntity(
            'Project\Entity\AnimalInterface',
            'Project\Entity\Cat',
            array()
    );
    $evm->addEventListener(Doctrine\ORM\Events::loadClassMetadata, $listener); 
```

似乎解析器只能将一个实体解析为接口，即第一个给定的接口。在这个例子中猫。Doctrine 建立表 AnimalFarm 与表狗的关系（外键）。当我试图通过 EntityManager 将狗添加到表中时，Doctrine 失败并出现以下错误消息：未捕获的异常 'Doctrine\ORM\ORMException' 并带有消息 'Found entity of type Project\Entity\Dog on association Project\Entity\AnimalFarm#动物，但期待 Project\Entity\Cat' 在 [...]

似乎无法通过接口定义多个目标实体？

我不想使用继承，因为实体可以实现多个接口。（不能多重继承）

有任何想法吗？

也许我可以寻找好的搜索关键字？

非常感谢。

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2015-02-18T17:47:02.270

这是从[教义 2 文档](https://github.com/doctrine/doctrine2/blob/master/docs/en/cookbook/resolve-target-entity-listener.rst#set-up)中获取的。您只能使用此方法解析一个对象。

```
/**
 * An interface that the invoice Subject object should implement.
 * In most circumstances, only a single object should implement
 * this interface as the ResolveTargetEntityListener can only
 * change the target to a single object.
 */
interface InvoiceSubjectInterface
{
    // List any additional methods that your InvoiceModule
    // will need to access on the subject so that you can
    // be sure that you have access to those methods.

    /**
     * @return string
     */
    public function getName();
} 
```

# business-intelligence - Cognos 中的 Query Studio 和 Report Studio 有什么区别？

> ID：14359768
> 
> 赞同：2
> 
> 时间：2013-01-16T13:39:34.013
> 
> 标签：business-intelligence, cognos, cognos-8, cognos-bi, cognos-tm1

***Cognos 中的 Query Studio 和 Report Studio 有什么区别？***

谁能详细解释我？

提前致谢。

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T22:29:44.800

Query Studio 是轻量级的 add hoc Web 报告编写器，它允许半高级用户通过 Cognos Web 门户使用发布到 Web 门户的准备好的数据内容来构建 ad-hoc 报告。用户可以排序/过滤更改字体大小，进行一些分组和聚合......并保存他们的报告。这个报告编写器是多么轻量级，因为您在演示格式和布局方面没有强大的能力....报告工作室是企业报告开发工具，可以开发具有高度交互复杂性的像素完美报告条件/条件布局处理等...报表工作室也可以编辑查询工作室报表。因此，有时用户会保存他们的 Query Studio 报告，但要求开发人员对其进行调整以获得所需的外观/功能。

# android - 脚本运行速度太快了！可能

> ID：14359771
> 
> 赞同：0
> 
> 时间：2013-01-16T13:39:53.017
> 
> 标签：android, linux, bash, shell

我一直在尝试编写一个脚本来强化 android。我没有成功！

我正在通过模拟器运行 AVD，并尝试使用我加载的 android shell 和 bash shell。该脚本很简单，您将在下面看到，每个命令都可以独立运行，但在脚本中它运行得太快或其他什么。

我知道顶部没有shebang，但那是因为我插入一个时出错。

我的脚本是：

```
echo             ANDROID
echo      HARDENING STARTED
device=/dev/block/mtdblock0
mount -o rw,remount $device /system
#removing files in the /system/xbin directory
rm  /system/xbin/tcpdump
rm  /system/xbin/su
#removing files in the /system/bin directory
rm  /system/bin/bootanimation
rm  /system/bin/dumpstate
rm  /system/bin/ping
rm  /system/bin/ping6
echo                    ANDROID
echo              HARDENING COMPLETE 
```

我已经把所有缩进都去掉了，因为我认为这可能会导致错误，并且目录和文件肯定存在。我已经用了三天了，它已经很薄了。

我一开始有一个 if 语句来选择其他手机上的设备，但我把它拿出来试图减少错误（这就是我声明设备而不是安装的原因）。

这是错误：

```
 ANDROID
      HARDENING STARTED
mount: no such file or directory exist
, no such file or directorytcpdump   
, no such file or directorysu
, no such file or directoryootanimation
, no such file or directoryumpstate
, no such file or directorying
, no such file or directorying6

     ANDROID
 HARDENING COMPLETED 
```

注意目录后的合并，这不是错别字。

谢谢瑞恩

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:46:51.003

您在 Windows 系统上编辑了此文件，它具有 DOS 样式的行尾 ( `<cr><lf>`)。将其转换为使用 Unix 样式的行尾标记 ( `<lf>`)，它应该可以正常工作。任何体面的程序员的编辑器都可以为您执行此操作，或者您可以[使用标准命令行工具](https://stackoverflow.com/questions/2613800/how-to-convert-dos-windows-newline-to-unix-newline-in-bash-script)来执行此操作。

顺便说一句，shell 根本不关心缩进。这个：

```
echo Hello
echo world. 
```

是相同的：

```
echo Hello
              echo world. 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-08-12T01:56:36.110

将行尾更改为 Unix 样式，将解决您的所有问题。

# gcc - GCC 中的“__IO”指令是什么？

> ID：14359775
> 
> 赞同：16
> 
> 时间：2013-01-16T13:40:07.027
> 
> 标签：gcc, embedded

我正在使用嵌入式设备，并且有一些代码最初是使用 IAR 编译器编译的。

我正在尝试使用 GCC 编译器重新编译所述代码。

有一个特定的语句: `typedef __IO`，它根本没有被编译（“无法识别的符号错误”）。

谁能建议我如何让这个语句正确编译？

* * *

## 回答 #1

> 赞同：14
> 
> 时间：2013-01-16T22:42:38.147

如果无法识别，那将是因为未包含包含定义的适当系统标题。

它将在工具链提供的芯片支持头文件中定义。它是*类型限定符*`#define`，或者更确切地说是一个将扩展为类型限定符的宏 ( )。例如，它的用法如下：

```
__IO uint8_t CSSR; 
```

这`uint8_t`是类型，所以 __IO 实际上不能是 a `typedef`，因为它不用于类型有效的地方。__IO 宏扩展为特定编译器所需的任何内容，以确保正确的 I/O 访问和寻址。在 I/O 是内存映射的典型情况下，它将简单地扩展为，`volatile`因为所有 I/O 都应声明为 volatile 以确保不会优化显式访问。

如果您想确定，请下载 IAR 工具的演示版本并查看头文件，了解它是如何为您的特定架构定义的。否则你可能只是使用`#define __IO volatile`

* * *

## 回答 #2

> 赞同：8
> 
> 时间：2014-05-06T09:13:29.637

_IO 表示 C 语言中的 volatile ......它不会优化代码，并且使用 _IO 为变量声明的值将是不可预测的，或者会在不了解编译器和用户的情况下发生变化

* * *

## 回答 #3

> 赞同：5
> 
> 时间：2018-01-06T15:43:39.817

这是一个老问题，但如果有人想知道 ARM 微控制器的这个问题，您可以在 CMSIS 库中看到该定义。例如，`__IO`对于 cortex-m4 的定义如下：

```
#define     __IO    volatile             /*!< Defines 'read / write' permissions */ 
```

完整块复制粘贴在下面（[Source](https://github.com/ARM-software/CMSIS/blob/master/CMSIS/Include/core_cm4.h#L265)）：

```
#ifdef __cplusplus
  #define   __I     volatile             /*!< Defines 'read only' permissions */
#else
  #define   __I     volatile const       /*!< Defines 'read only' permissions */
#endif
#define     __O     volatile             /*!< Defines 'write only' permissions */
#define     __IO    volatile             /*!< Defines 'read / write' permissions */

/* following defines should be used for structure members */
#define     __IM     volatile const      /*! Defines 'read only' structure member permissions */
#define     __OM     volatile            /*! Defines 'write only' structure member permissions */
#define     __IOM    volatile            /*! Defines 'read / write' structure member permissions */ 
```

# c# - 带有换行的 TextBlock 的动态字体大小

> ID：14359777
> 
> 赞同：4
> 
> 时间：2013-01-16T13:40:08.137
> 
> 标签：c#, xaml, windows-8

我有一个固定大小的 TextBlock，它是环绕文本的。有时短有时长。

如果文本变得很长，则不会完全像这样显示

![在此处输入图像描述](../Images/52452aef1f462bc2b32ba19b5b0dc46a.png)

如何使 Fontsize 灵活以使文本适合具有静态大小的 TextBox？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-18T13:52:13.730

我的解决方案如下：

将 fontsize 设置为一个您不希望大于该值的值。当您更改字体大小或更改内容时，TextBlock 的 ActualHeight 会发生变化。我基于此构建了解决方案。您应该为 SizeChanged 事件创建一个事件处理程序并将以下代码写入其中。

```
private void MyTextBlock_SizeChanged(object sender, SizeChangedEventArgs e)
{
    double desiredHeight = 80; // Here you'll write the height you want the text to use

    if (this.MyTextBlock.ActualHeight > desiredHeight)
    {
        // You want to know, how many times bigger the actual height is, than what you want to have.
        // The reason for Math.Sqrt() is explained below in the text.
        double fontsizeMultiplier = Math.Sqrt(desiredHeight / this.MyTextBlock.ActualHeight);

        // Math.Floor() can be omitted in the next line if you don't want a very tall and narrow TextBox.
        this.MyTextBlock.FontSize = Math.Floor(this.MyTextBlock.FontSize * fontsizeMultiplier);
    }

    this.MyTextBlock.Height = desiredHeight; // ActualHeight will be changed if the text is too big, after the text was resized, but in the end you want the box to be as big as the desiredHeight.
} 
```

我使用 Math.Sqrt() 的原因是，如果将字体大小设置为之前的一半，那么字体将使用的区域将是之前的四分之一（因为它变成了之前的一半）宽和以前的一半高）。你显然想保持 TextBox 的宽度，只改变它的高度。

如果你幸运的话，在这个方法执行一次后，字体大小将是合适的。但是，根据字体大小更改后重新换行的文本，您可能非常“不走运”，以至于文本将比您希望的长一行。幸运的是，将再次调用事件处理程序（因为您更改了字体大小）并且如果仍然太大，将再次调整大小。

我试过了，速度很快，结果看起来不错。然而，我可以想象，在一个非常不幸的文本和高度选择中，经过几次迭代后才能达到正确的字体大小。这就是我使用 Math.Floor() 的原因。总而言之，字体大小最终是 12.34 还是 12 并不重要，这样我就不会担心“不走运”的文本，这将花费太长时间来渲染。但我认为 Math.Floor() 如果你不想有一个非常高的文本框（比如 2000 像素），可以省略很多文本。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-10-15T09:08:25.440

这是一个完整的解决方案，包括设置 maxheight / maxwidth 的选项，并且在渲染时直接计算：

```
public class TextBlockAutoShrink : TextBlock
    {
        private double _defaultMargin = 6;
        private Typeface _typeface;

        static TextBlockAutoShrink()
        {
            TextBlock.TextProperty.OverrideMetadata(typeof(TextBlockAutoShrink), new FrameworkPropertyMetadata(new PropertyChangedCallback(TextPropertyChanged)));
        }

        public TextBlockAutoShrink() : base() 
        {
            _typeface = new Typeface(this.FontFamily, this.FontStyle, this.FontWeight, this.FontStretch, this.FontFamily);
            base.DataContextChanged += new DependencyPropertyChangedEventHandler(TextBlockAutoShrink_DataContextChanged);
        }

        private static void TextPropertyChanged(DependencyObject sender, DependencyPropertyChangedEventArgs args)
        {
            var t = sender as TextBlockAutoShrink;
            if (t != null)
            {
                t.FitSize();
            }
        }

        void TextBlockAutoShrink_DataContextChanged(object sender, DependencyPropertyChangedEventArgs e)
        {
            FitSize();
        }

        protected override void OnRenderSizeChanged(SizeChangedInfo sizeInfo)
        {
            FitSize();

            base.OnRenderSizeChanged(sizeInfo);
        }

        private void FitSize()
        {
            FrameworkElement parent = this.Parent as FrameworkElement;
            if (parent != null)
            {
                var targetWidthSize = this.FontSize;
                var targetHeightSize = this.FontSize;

                var maxWidth = double.IsInfinity(this.MaxWidth) ? parent.ActualWidth : this.MaxWidth;
                var maxHeight = double.IsInfinity(this.MaxHeight) ? parent.ActualHeight : this.MaxHeight;

                if (this.ActualWidth > maxWidth)
                {
                    targetWidthSize = (double)(this.FontSize * (maxWidth / (this.ActualWidth + _defaultMargin)));
                }

                if (this.ActualHeight > maxHeight)
                {
                    var ratio = maxHeight / (this.ActualHeight);

                    // Normalize due to Height miscalculation. We do it step by step repeatedly until the requested height is reached. Once the fontsize is changed, this event is re-raised
                    // And the ActualHeight is lowered a bit more until it doesnt enter the enclosing If block.
                    ratio = (1 - ratio > 0.04) ? Math.Sqrt(ratio) : ratio;

                    targetHeightSize = (double)(this.FontSize *  ratio);
                }

                this.FontSize = Math.Min(targetWidthSize, targetHeightSize);
            }
        }
    } 
```

# tfs - TFS 2010：如何签入已删除但未通过 TFS 删除的文件

> ID：14359784
> 
> 赞同：3
> 
> 时间：2013-01-16T13:40:48.397
> 
> 标签：tfs

我在本地工作区中有一些文件已签出然后删除，但没有通过 TFS 删除。TFS 在待定更改视图中仍将它们标记为“编辑”。当我尝试签入已删除的文件时，我收到一条错误消息，指出找不到文件。有没有办法告诉 TFS 这些文件已被删除，并且它们也应该在源代码管理中删除？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:51:29.737

您可以通过`team explorer`右键单击​​已删除的文件并执行`undo pending changes`. 然后通过`team explorer`删除它们并签入。

如果这不起作用 - 通过右键单击已删除的文件`team explorer`；执行`get specific version`并选中两个复选框以覆盖文件：

![在此处输入图像描述](../Images/b2ea1e18b5cc3fdfcf4f648aad025bbc.png)

这将从 TFS 获取已删除的 [from workspace] 文件。对文件执行 an `undo pending changes`。然后通过团队资源管理器删除文件并签入。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:44:14.290

如果文件不多，只需在磁盘上创建一些虚拟文件，签入，然后通过 TFS 删除它们。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:58:13.493

我认为您应该能够通过源代码管理资源管理器执行此操作：查看-> 其他窗口-> 源代码管理 Exlorer。找到要标记为已删除的代码文件，然后右键单击并选择删除。

供将来参考，[TFS Power Tools](http://visualstudiogallery.msdn.microsoft.com/b1ef7eb2-e084-4cb8-9bc7-06c3bad9148f)对这种东西非常有用。

# iphone - iOS：用 UIModalTransitionStyleFlipHorizo ntal 替换模态 ViewController

> ID：14359798
> 
> 赞同：2
> 
> 时间：2013-01-16T13:41:36.760
> 
> 标签：iphone, ios, uiview, uiviewcontroller

我使用`presentViewController`. 现在我想`UIModalTransitionStyleFlipHorizontal`在我调用的 ViewController 中使用 so 翻转这个模态视图：

```
flipsideView.modalTransitionStyle = UIModalTransitionStyleFlipHorizontal;
[self presentViewController:flipsideView animated:YES completion:^{}]; 
```

动画看起来不错。但是当我关闭第`flipsideView`一个模态视图时仍然可见。

有没有办法使用`UIModalTransitionStyleCoverVertical`. 或者是否可以使用翻转动画将第一个模态视图替换为 FlipsideView？

谢谢！

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T18:00:54.523

你可以像这样从flipsideView中的一个按钮返回到第一个控制器：

```
-(IBAction)goBackToFirst:(id)sender {
    self.modalTransitionStyle = UIModalTransitionStyleCoverVertical;
    [self.presentingViewController.presentingViewController dismissViewControllerAnimated:YES completion:nil];
} 
```

# html - CSS宽度不居中图像

> ID：14359801
> 
> 赞同：0
> 
> 时间：2013-01-16T13:41:51.133
> 
> 标签：html, css, wordpress

我使用 wordpress 作为我的 CMS，并使用了我选择的主题。主题在主页上显示了一个滑块（轮播），但占用了太多空间。我试图将宽度和高度编辑为 80%，但 UI 搞砸了。滑块未居中，或带有左右箭头的框架靠得更近。图像被粉碎。我需要为此设置正确的css。

我尝试了以下

1.  将宽度和高度修改为 80%
2.  减少了 px 值，进一步搞砸了

下面我有代码的相关 css 和 html 部分。

```
<div id="slides">
  <div class="slides_container slide" style="overflow: hidden; position: relative; display: block;">
    <div class="slides_control" style="position: relative; width: 2736px; height: 480px; left: -912px;"><div style="position: absolute; top: 0px; left: 912px; z-index: 5;">
       <a href=""><img src="http://localhost/taxeeta/wp-content/uploads/2013/01/116.png?1358343444279" alt=""></a>
    </div>
    <div style="position: absolute; top: 0px; left: 912px; z-index: 0; display: none;">
       <a href=""><img src="http://localhost/taxeeta/wp-content/uploads/2013/01/215.png" alt=""></a>
    </div>
  </div>
</div> 
```

CSS：

```
#slides {
 position: absolute;
 top: 15px;
 left: 0px;
 z-index: 100;
 width: 897px;
 margin-left: 14px;
}

.slides_container {
 width: 912px;
 margin: 0;
 padding: 0;
}

.slides_control {
 position: absolute;
 top: 15px;
 left: 0px;
 z-index: 100;
 width: 897px;
 margin-left: 14px;
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:46:50.050

你确定有修改 element-css 的 jo javascript 代码吗？您是否将 slides 和 slides_control 的宽度更改为相同？（对不起，我不能写评论......）

# vaadin - 服务器未在 vaadin 中运行时的通知

> ID：14359802
> 
> 赞同：2
> 
> 时间：2013-01-16T13:41:54.623
> 
> 标签：vaadin

我有一个带有服务器和客户端组件的简单 vaadin 7 应用程序。客户端组件正在通过连接器对服务器端组件进行 rpc 调用。现在，如果我想在调用服务器时跟踪服务器是否处于活动状态，应该如何实现？我需要客户端中的通知，捕获它后，需要在客户端（连接器）中执行一些代码。

# c# - 如何在选中行的复选框后单击按钮从gridview中删除一行

> ID：14359803
> 
> 赞同：0
> 
> 时间：2013-01-16T13:41:56.193
> 
> 标签：c#, winforms, stored-procedures, datagridview

我`DataGridView`在 C# windows 窗体中创建并`checkboxColumn`添加到它。`DataGridView`填充有其他列，如, `Sno`, `AccountNo`, `Name`(`Salary` *是`Sno`identitycolumn 和 primarykey)*。

我想通过选择and on button click which is out side来删除一行*（使用存储过程）*。“查找控件”出错。`checkbox``DataGridView`

存储过程：

```
 Create Procedure uspDeleteSelectedRow
   As
       Delete from EmpDetails where Sno=Sno
   Go 
```

* * *

```
 private void btnDelete_Click(object sender, EventArgs e)
    {
        //Create String Collection to store IDs of 
        //records to be deleted 
            StringCollection idCollection = new StringCollection();
            string strID = string.Empty;

        //Loop through GridView rows to find checked rows 
        for (int i = 0; i < dataGridView1.Rows.Count; i++)
        {
             CheckBox chkDelete = (CheckBox)dataGridView1.Rows[i].
                    Cells[0].FindControl("chkSelect");
            if (chkDelete != null)
            {
                if (chkDelete.Checked)
                {
                    strID = dataGridView1.Rows[i].Cells[1].ToString();
                    idCollection.Add(strID);
                }
            }
        }
        if (idCollection.Count > 0)
        {
        //Call the method to Delete records 
        DeleteMultipleRecords(idCollection);

        // rebind the GridView
        dataGridView1.DataBind();   
        }
        else
        {
            lblMessage.Text = "Please select any row to delete";
        }

    }

    private void DeleteMultipleRecords(StringCollection idCollection)
    {
        //Create sql Connection and Sql Command
        SqlConnection con = new SqlConnection(Helper.ConnectionString);
        SqlCommand cmd = new SqlCommand();
        string IDs = "";

        foreach (string id in idCollection)
        {
            IDs += id.ToString() + ",";
        }

        try
        {
            string test = IDs.Substring
                          (0, IDs.LastIndexOf(","));
            string sql = "Delete from EmpDetails" + " WHERE ID in (" + test + ")";
            cmd.CommandType = CommandType.Text;
            cmd.CommandText = sql;
            cmd.Connection = con;
            con.Open();
            cmd.ExecuteNonQuery();
        }
        catch (SqlException ex)
        {
            string errorMsg = "Error in Deletion";
            errorMsg += ex.Message;
            throw new Exception(errorMsg);
        }
        finally
        {
            con.Close();
        }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-18T06:02:35.680

假设这是您的存储过程：

```
ALTER PROCEDURE [dbo].[sp_ToDeleteEmpDetails] @Sno int
    /*
    (
    @parameter1 int = 5,
    @parameter2 datatype OUTPUT
    )
    */
AS
    DELETE FROM EmpDetails 
    WHERE Sno = Sno 

    RETURN 
```

您不需要`StringCollection`删除或调用存储过程。

```
private void btnDelete_Click(object sender, EventArgs e)
{
        foreach (DataGridViewRow item in dataGridView1.Rows)
        {
            bool IsBool = false;

            if (bool.TryParse(item.Cells[1].EditedFormattedValue.ToString(), out IsBool)) //<--Where: The ColumnIndex of the DataGridViewCheckBoxCell
            {
                using (SqlConnection con = new SqlConnection(Helper.ConnectionString))
                {
                    using (SqlCommand cmd = new SqlCommand("sp_ToDeleteEmpDetails", con))
                    {
                        try {
                            cmd.CommandType = CommandType.StoredProcedure;
                            cmd.Parameters.Add("@sno", SqlDbType.Int).Value = item.Cells[0].EditedFormattedValue.ToString(); //<--Where: The ColumnIndex of the Primary key from your DataGridView
                            dataGridView1.Rows.RemoveAt(item.Cells[0].RowIndex);
                            con.Open();
                            cmd.ExecuteNonQuery();
                        } catch (Exception) {

                            throw;
                        }
                        finally
                        {
                            con.Close();
                        }
                    }
                }
            }
        }
    } 
```

如果您在我给出的答案中遇到问题，请告诉我。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-18T04:18:48.090

试试这个解决方案。在我的代码中，我有一个类并将它的列表作为我的数据源传递给 gridview。

**//班级**

```
public class User
{
    public bool Selected { get; set; }
    public string UserName { get; set; }
} 
```

**//创建一个列表并绑定到数据网格视图**

```
 private void Form1_Load(object sender, EventArgs e)
    {
        var users = new List<User> { new User { UserName = "Jobert", Selected = false }, new User { UserName = "John", Selected = true }, new User { UserName = "Leah", Selected = true }, new User { UserName = "Anna", Selected = false } };
        dataGridView1.DataSource = users;
    } 
```

**//删除时**

```
 private void btnDelete_Click(object sender, EventArgs e)
        {
            //get data back from the source
            var source = dataGridView1.DataSource as List<User>;
            var selectedItems = source.Where(x => x.Selected).ToList();
            foreach (var item in selectedItems)
            {
                //perform the delete
            }

        } 
```

# java - 在 Android 上更改 DateFormat 中的时间

> ID：14359804
> 
> 赞同：2
> 
> 时间：2013-01-16T13:41:57.843
> 
> 标签：java, android, simpledateformat

我从 JSON 中提取了以下格式的日期和时间

```
2013-01-16T13:43:11 
```

我需要将其转换为巴基斯坦当地时间并在该时间上增加 5 小时，因此结果如下：

```
06:43 
```

我怎样才能做到这一点？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T14:00:54.113

假设这`"2013-01-16T13:43:11"`是在格林威治标准时间

```
String s = "2013-01-16T13:43:11";
SimpleDateFormat df = new SimpleDateFormat("yyyy-MM-dd'T'HH:mm:ss");
df.setTimeZone(TimeZone.getTimeZone("GMT"));
Date date = df.parse(s);
date = new Date(date.getTime() + 5 * 3600 * 1000);
String time = new SimpleDateFormat("HH:mm").format(date); 
```

`time`将在您当地的时区，所以如果您在巴基斯坦就可以了

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:45:33.377

您可以使用 SimpleDateFormat 如下：

```
String strDate = null;
SimpleDateFormat dateFormatter = new SimpleDateFormat(
                "hh:mm");
strDate = dateFormatter.format(yourDate); 
```

希望能帮助到你。

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T18:47:44.593

java dateFormat 不是线程安全的，请改用 joda time lib：

[Joda 时间库下载](http://joda-time.sourceforge.net/)

您可以使用 withZone 方法更改特定时区的时间

```
DateTime userTime1 = new DateTime();
            DateTime eventRecordTime = new DateTime();
            userTime1 = DateTime.parse("2012-07-05T21:45:00+02:00");
            eventRecordTime = DateTime.parse((String) jo.get("start_time"));
            DateTimeZone dtz = userTime1.getZone();
            System.out.println(eventRecordTime.withZone(dtz).toString()); 
```

# codeigniter - 为什么关闭浏览器后 Codeigniter 会话不会过期？

> ID：14359806
> 
> 赞同：4
> 
> 时间：2013-01-16T13:42:11.180
> 
> 标签：codeigniter, session

## 问题场景

如果用户*A*登录到应用程序，则用户 ID 在会话中设置。完成一些任务后，用户*A*关闭了他的浏览器并离开了计算机。不久之后，用户*B*来打开浏览器，看到应用程序处于登录状态。用户*B*也可以打开一个内部 url，直接将他重定向到应用程序，无需任何身份验证，使用之前的会话。

## 我的配置

```
$config['sess_cookie_name'] = 'cisession';
$config['sess_expiration'] = 7200;
$config['sess_expire_on_close'] = TRUE;
$config['sess_encrypt_cookie']  = FALSE;
$config['sess_use_database']    = FALSE;
$config['sess_table_name'] = 'ci_sessions';
$config['sess_match_ip'] = FALSE;
$config['sess_match_useragent'] = TRUE;
$config['sess_time_to_update']  = 300; 
```

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-18T07:26:34.833

您可以动态覆盖或设置[配置项](http://ellislab.com/codeigniter/user-guide/libraries/config.html)。如果您只是查看`$config['sess_expire_on_close'] = TRUE;` 浏览器窗口关闭时是否使会话自动过期。

如果用户没有选中记住我复选框，则将其设置为 true。用户关闭浏览器后会话将过期。

如果他选中记住我复选框，请将 $config['sess_expire_on_close'] 设置为 FALSE

```
if($this->input->post('remember')) $this->config->set_item('sess_expire_on_close', '0'); //'remember' is checkbox name. 
```

现在浏览器关闭后会话不会过期。 **注意：此解决方案也在 Opera、Mozilla、Chrome 和 ie9 上进行了测试**

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:52:13.647

你为什么不使用 CI 会话功能来做到这一点

[http://www.codeigniter.com/userguide2/libraries/sessions.html](http://www.codeigniter.com/userguide2/libraries/sessions.html)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2014-08-08T05:39:36.753

试试这个，可能对你有帮助

```
/  **
  * Escape String
  *
  * @param string
  * @param bool whether or not the string will be used in a LIKE condition
  * @return string
  */
 public function escape_str($str, $like = FALSE)
 {
  if (is_array($str))
  {
   foreach ($str as $key => $val)
      {
    $str[$key] = $this->escape_str($val, $like);
      }

      return $str;
     }

  $str = is_resource($this->conn_id) ? mysql_real_escape_string($str, $this->conn_id) : addslashes($str);

  // escape LIKE condition wildcards
  if ($like === TRUE)
  {
   return str_replace(array($this->_like_escape_chr, '%', '_'),
      array($this->_like_escape_chr.$this->_like_escape_chr, $this->_like_escape_chr.'%', $this->_like_escape_chr.'_'),
      $str);
  }

  return $str;
 }

 // -------------------------------------------------------------------- 
```

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2015-05-19T21:50:09.497

在 application/config/config.php 中设置：

```
$config['sess_expiration'] = 0;
$config['sess_expire_on_close'] = TRUE; 
```

这应该没问题。

# java - Java 将 XML 文档呈现为 PDF

> ID：14359810
> 
> 赞同：3
> 
> 时间：2013-01-16T13:42:30.397
> 
> 标签：java, xml, pdf, itext, apache-fop

我有一个当前存储为内存中字符串的 XML 文档，并希望将其呈现为 PDF。换言之，PDF 内容将是一个 XML 文档。该方法呈现的 XML 是通用的——可能会发送多种类型的 XML 文档。

我很难弄清楚如何使用各种基于 Java 的框架来完成。

*阿帕奇 FOP*

该框架似乎需要将文档中的 XML 元素特定转换为 FOP 实体。由于所讨论的方法必须接受通用 XML，我认为这个框架不符合我的要求。

*文字*

我尝试使用 iText/Flying Saucer (org.xhtmlrenderer) 的组合呈现文档，虽然它确实呈现 PDF，但内容仅包含空格分隔的数据值，没有 xml 元素或属性。使用下面的代码和测试数据：

**文件**

```
<?xml version="1.0" encoding="UTF-8"?>
<root>
  <elem1>value1</elem1>
  <elem2>value2</elem2>
</root> 
```

**代码**

```
File inputFile = new File(PdfGenerator.class.getResource("test.xml").getFile());
OutputStream os = new FileOutputStream("c:\\temp\\Sample.pdf");
ITextRenderer renderer = new ITextRenderer();
renderer.setDocument(inputFile);
renderer.layout();
renderer.createPDF(os);
os.close(); 
```

生成包含内容值`value1 value2`但没有标签的 PDF。

**我的问题是** 有人可以提供一个代码片段来使用上述框架之一渲染包含 XML 内容的 PDF，还是有另一个框架更适合我的需要？

**编辑：我意识到**[这里](https://stackoverflow.com/questions/7634950/print-xml-in-pdf-using-itext?rq=1) 提出了同样的问题，但似乎提出的解决方案需要深入了解 css 文件中传入 XML 文档的结构。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T13:05:51.453

只是为了给出一个使用 fop 的例子 - 在这里你有它。为了让每个人都能遵循这一点，我使用了 fop 命令行工具。

在 Java 代码中可以轻松执行相同的操作，然后您不需要随时将 xml 作为文件。

### 生成 PDF 的 XSLT

```
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:fo="http://www.w3.org/1999/XSL/Format">

<xsl:template match="/">
<fo:root>
  <fo:layout-master-set>
    <fo:simple-page-master master-name="content"
        page-width="210mm" page-height="297mm" margin="20mm 20mm 20mm 20mm">
      <fo:region-body/>
    </fo:simple-page-master>
  </fo:layout-master-set>
  <fo:page-sequence master-reference="content">
    <fo:flow flow-name="xsl-region-body">
      <fo:block>
        <xsl:apply-templates />
    </fo:block>
    </fo:flow>
  </fo:page-sequence>
</fo:root>
</xsl:template>

<xsl:template match="@*">
  <xsl:text> </xsl:text>
  <xsl:value-of select="name()" />
  <xsl:text>="</xsl:text>
    <xsl:value-of select="." />
  <xsl:text>"</xsl:text>
</xsl:template>

<xsl:template match="*">
  <xsl:param name="indent">0</xsl:param>
  <fo:block margin-left="{$indent}">
    <xsl:text>&lt;</xsl:text>
    <xsl:value-of select="name()" />
    <xsl:apply-templates select="@*" />
    <xsl:text>&gt;</xsl:text>
    <xsl:apply-templates>
      <xsl:with-param name="indent" select="$indent+10" />
    </xsl:apply-templates>
    <xsl:text>&lt;/</xsl:text>
    <xsl:value-of select="name()" />
    <xsl:text>&gt;</xsl:text>
  </fo:block>
</xsl:template>

</xsl:stylesheet> 
```

我们将此文件称为 xml2pdf.xsl

### 代码的简短说明

*   模板匹配=“/”主要构建pdf，除了调用其他模板匹配方法或更精确的模板匹配=“*”的行。

*   模板 match=" *" 写入元素开始和结束并调用，然后调用模板 match="@* " 为元素中的每个属性（如果有）。最后它调用

*   使用 with-param 语句中的 select="$indent+10" 属性，模板每达到一个级别，缩进参数就会增加 10。

### 使用代码

```
# fop -xsl xml2pdf.xsl -xml sample.xml -pdf result.pdf 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T15:11:20.153

尝试谷歌搜索，有许多代码片段。例如：[http ://www.vogella.com/articles/JavaPDF/article.html](http://www.vogella.com/articles/JavaPDF/article.html)

我推荐 iText 而不是 FOP，它更快，内存占用更少，并且您可以更好地控制结果。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-11-05T15:14:24.733

这是使用 itext 的解决方案。您的 html 内容在请求中。而且itext不是免费的。查看它的许可要求，因为它近年来发生了变化，尽管它不是很贵。

```
public class MyPDFGeneratorService {

    public byte[] generatePdf(final XhtmlPDFGenerationRequest request) {
        try {

            ITextRenderer renderer = new ITextRenderer();
            renderer.setDocument(this.getDocument(request.getContent()), null);
            renderer.layout();
            ByteArrayOutputStream baos = new ByteArrayOutputStream();
            renderer.createPDF(baos);
            return this.toByteArray(baos);

        }
        catch (Exception e) {
            throw new PDFGenerationException(
                    "Unable to generate  PDF.", e);
        }
    }

    private Document getDocument(final String content) {
        InputSource is = new InputSource(new BufferedReader(new StringReader(
                content)));
        return XMLResource.load(is).getDocument();
    }

    private byte[] toByteArray(final ByteArrayOutputStream baos)
        throws IOException {
    byte[] bytes = baos.toByteArray();
    baos.close();
    return bytes;

 }

} 
```

# c# - 错误的客户端 IP 地址

> ID：14359812
> 
> 赞同：0
> 
> 时间：2013-01-16T13:42:32.283
> 
> 标签：c#, asp.net, iis-7

我正在从 ASP.NET 获取客户端 IP 地址。但是某些客户端 IP 地址收到 127.0.0.1。有什么问题。如何获取有效的客户端 IP 地址？

我正在使用这段代码：

```
 public static string GetIP()
{
    string clientIp = HttpContext.Current.Request.ServerVariables["HTTP_X_FORWARDED_FOR"];
    if (!string.IsNullOrEmpty(clientIp))
    {
        string[] forwardedIps = clientIp.Split(new char[] { ',' }, StringSplitOptions.RemoveEmptyEntries);
        clientIp = forwardedIps[forwardedIps.Length - 1];
    }

    if (string.IsNullOrEmpty(clientIp))
        clientIp = HttpContext.Current.Request.ServerVariables["HTTP_CLIENT_IP"];
    if (string.IsNullOrEmpty(clientIp))
        clientIp = HttpContext.Current.Request.ServerVariables["REMOTE_ADDR"];

    return clientIp.ToString();
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:50:17.520

127.0.0.1 是本地主机，即同一台机器正在发出请求作为托管它。

我的猜测是，您所看到的实际上是您自己的测试或调试？

我认为 Request.IsLocal() 是找出问题的好方法。

# android - 如何使表格布局的第一行占据整个空间

> ID：14359814
> 
> 赞同：2
> 
> 时间：2013-01-16T13:42:39.203
> 
> 标签：android, xml, android-layout

我有一个 5 行的表格布局。我希望第一行的大小占据屏幕的其余部分，而剩余的行根据里面的内容占据他们需要的尽可能多的空间。

我的第一个直觉是将第一行的布局宽度和高度设置为，`match_parent`同时将其他行的宽度`match_parent`和高度设置为`wrap_content`. 不用说，这是行不通的。

我怎样才能做到这一点？

![在此处输入图像描述](../Images/ea4df9bec63ea10b8772b5968ddd506a.png)

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:56:37.900

> 我希望第一行的大小占据屏幕的其余部分，而剩余的行根据里面的内容占据他们需要的尽可能多的空间。

我认为`android:layout_weight="1"`首先使用`TableRow`应该可以解决您遇到的问题。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:47:22.280

将您的`TableLayout`内部 a`ScrollView`并修复您的 First 的高度，`TableRow`这将解决您的问题。希望它有效。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T14:02:33.090

坚持你的第一直觉，但添加`layout_weight="1"`到第一行。`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:57:22.907

看到`TableLayout`继承自`LinearLayout`，您是否尝试将行高设置为 0dp 并为每个设置布局权重以达到预期的效果？像这样：

```
<TableRow 
    android:layout_height="0dp"
    android:layout_weight="2"
    android:layout_width="match_parent">

<TableRow 
    android:layout_height="0dp"
    android:layout_weight="1"
    android:layout_width="match_parent">
and so on.... 
```

# android - Android Sencha Touch 1.1 密码字段（字段焦点显示两个字段）

> ID：14359821
> 
> 赞同：0
> 
> 时间：2013-01-16T13:43:03.373
> 
> 标签：android, cordova, sencha-touch

我在使用 vbox 布局的表单面板中使用密码字段组件。在 android 中，onfocus 密码字段显示了额外的字段。我参考了下面的链接，但我不清楚。 [http://www.sencha.com/forum/showthread.php?125489](http://www.sencha.com/forum/showthread.php?125489)

请指导我如何解决这个问题。在此先感谢。

```
{
     xtype:'passwordfield',
     label:'Password',
     id:'ap_pswd',
     name:'ap_pswd_name',
     labelWidth:'150px',
     width:'400px',
     required:true,
     style:'margin-left:auto;margin-right:auto;',
     }, 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:37:38.823

这是浏览器的本机行为，因此您对此无能为力。您可以做的一件事是在滚动时隐藏浏览器的输入元素。

```
if (document.activeElement && ('blur' in document.activeElement) &&
                (document.activeElement.tagName == 'INPUT' || document.activeElement.tagName == 'TEXTAREA')) {
            document.activeElement.blur();
        } 
```

# math - 如何在知道半径和中心点的圆上计算一个点

> ID：14359823
> 
> 赞同：4
> 
> 时间：2013-01-16T13:43:10.410
> 
> 标签：math, geometry

我有一个复杂的问题，它涉及对我没有信心的数学的理解。

一些轻微的上下文可能会有所帮助。我正在为儿童构建一个 3D 火车模拟器，它将使用 WebGL 在浏览器中运行。我正在尝试创建一个点网络来放置轨道资产（见图）并为火车移动提供参考。

为了帮助解释我的问题，我创建了一个可视化表示，因为我是一个可以编写脚本的设计师，而不是真正的程序员或数学家：

![问题的可视化](../Images/bffb90a25b993d9363a4683b73151fd3.png)

基本上，我有 3 个形状（图 A、B 和 C），虽然它们有宽度，但可以表示为 A 的直线和曲线（B 和 C）。曲线 B 和 C 是从 A 派生的（弯曲修改），因此长度 (l) 都相同，即 112。曲线 (B 和 C) 的半径 (r) 均为 285.5，弯曲的 (a) 角度为 22.5°。

每个形状（A、B 和 C）都有一个注册点（起点），由附在每个形状上的绿色框的中心表示。

我想要做的是创建一个从 0, 0 开始的“轨道”网络（使用标准笛卡尔坐标）。

我的问题是在曲线之后放置下一个元素的位置。如果它是直线轨道，那么没有问题，因为我可以将长度用作沿 y 轴的恒定偏移，但这会很无聊，所以我需要添加曲线。

图 D. 演示了一个可能的轨道布局示例，但请理解我不是在寻找静态答案（基于图像中所有内容的位置），我需要一个可以应用的公式，无论我如何配置追踪。

使用图 D。我试图找出在第一个弯曲元素之后放置第二个弯曲元素的位置。在给定圆心坐标和半径的情况下，我使用公式绘制圆的圆周点（图 E）。

我有第 1 点，因为这只是设置直线长度（y 位置）的情况。我可以很容易地计算出圆心，因为这只是 y 位置的偏移量、半径 (r) 的偏移量（x 位置）和始终为 22.5° 的角度 (a)（顺便说一下，它被转换为弧度根据公式要求）。

通过公式传递值后​​，我没有得到正确的结果，因为公式假设我从 3 点开始逆时针工作，所以我必须从 (a) 中减去 180 并将其转换为弧度以获得预期结果。

这确实有效，如果我想创建一个 180° 的轨道曲线，我可以使用相同的中心点，每次只需从角度减去 22.5°。伟大的。但我想要一个更动态的轨道布局，如无花果。D＆E。

那么，我将如何处理图 E 中的工作点 5，因为它代表该曲线段的中心点？我根本不知道。

另外，作为一个额外的问题，这是这样做的正确方法还是我让事情变得过于复杂？

这个问题是阻止我构建游戏的唯一问题，正如您所理解的，这有点大问题，所以我提前感谢任何人的贡献。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T17:21:05.353

在构建轨道时，要放置的下一段轨道的位置需要相对于轨道当前末端的位置和方向。

我将存储一个 ( `x`, `y`) 位置和一个角度`a`来指示当前点（其中`x`，`y`从 0 开始，`a`从 pi/2 弧度开始，这对应于“从 3 点钟方向逆时针”系统中的直线向上）。

然后构造

```
fx = cos(a);
fy = sin(a);
lx = -sin(a);
ly = cos(a); 
```

它对应于相对于我们当前面对的方向的“向前”和“左”向量的 x 和 y 分量。如果我们想将我们的位置向前移动一个单位，我们将 (x,y) 增加 (fx, fy)。

在您的情况下，放置直线段的规则是：

```
x=x+112*fx
y=y+112*fy 
```

放置曲线的规则稍微复杂一些。对于右转的曲线，我们需要向前移动 112*sin(22.5°)，然后右转 112*(1-cos(22.5°)，然后顺时针转 22.5°。在代码中，

```
x=x+285.206*sin(22.5*pi/180)*fx // Move forward
y=y+285.206*sin(22.5*pi/180)*fy

x=x+285.206*(1-cos(22.5*pi/180))*(-lx) // Side-step right
y=y+285.206*(1-cos(22.5*pi/180))*(-ly)

a=a-22.5*pi/180 // Turn to face new direction 
```

左转和右转一样，只是角度为负。

要放置后续部件，只需再次运行此过程，计算`fx`、和`fy`，`lx`然后`ly`使用现在更新的值，`a`然后根据接下来的轨道部件类型递增。`x``y`

您可能会考虑另一点；根据我的经验，如果您坚持进行 90° 转弯或相当对称的布局，则通常可以使用此类部件构建形成闭合循环的轨道。然而，制作没有完全连接的轨道是很容易的，而且不知道应该如何修改它们以允许它们连接。如果您的程序允许孩子们设计自己的布局，请记住一些事情。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:47:47.357

点 5 与 3 和 2 等距，但方向相反。

# c# - 在 Windows Phone 上制作闪烁/闪烁按钮

> ID：14359825
> 
> 赞同：0
> 
> 时间：2013-01-16T13:43:12.030
> 
> 标签：c#, visual-studio-2012, storyboard, windows-phone-8, expression-blend

我正在尝试学习一些关于故事板和动画的知识，所以我决定做一个简单的闪烁按钮。

经过一番挣扎，我已经能够录制动画，但它没有按预期工作。

动画播放一次，似乎忽略了我的`SpeedRatio`财产。我什至失去了`Pressed`动画！

这是我的代码：

XAML

```
<UserControl x:Class="BPMFlashingButton.BPMFlashingButton"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
mc:Ignorable="d"
FontFamily="{StaticResource PhoneFontFamilyNormal}"
FontSize="{StaticResource PhoneFontSizeNormal}"
Foreground="{StaticResource PhoneForegroundBrush}"
d:DesignHeight="480" d:DesignWidth="480">
<UserControl.Resources>
    <Style x:Key="BPMFlashingButton" TargetType="Button">
        <Setter Property="Template">
            <Setter.Value>
                <ControlTemplate TargetType="Button">
                    <Grid x:Name="LayoutRoot" Background="{StaticResource PhoneBackgroundBrush}">
                        <VisualStateManager.VisualStateGroups>
                            <VisualStateGroup x:Name="CommonStates">
                                <VisualState x:Name="Normal"/>
                                <VisualState x:Name="Disabled"/>
                                <VisualState x:Name="MouseOver"/>
                                <VisualState x:Name="Pressed">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Foreground" Storyboard.TargetName="ContentContainer">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneButtonBasePressedForegroundBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="Background" Storyboard.TargetName="ButtonBackground">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneAccentBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="FocusStates">
                                <VisualState x:Name="Focused"/>
                            </VisualStateGroup>
                            <VisualStateGroup x:Name="CustomStates">
                                <VisualState x:Name="Flashing">
                                    <Storyboard>
                                        <ObjectAnimationUsingKeyFrames Storyboard.TargetProperty="(Panel.Background)" Storyboard.TargetName="LayoutRoot" RepeatBehavior="Forever">
                                            <DiscreteObjectKeyFrame KeyTime="0" Value="{StaticResource PhoneAccentBrush}"/>
                                            <DiscreteObjectKeyFrame KeyTime="0:0:0.5" Value="{StaticResource PhoneBackgroundBrush}"/>
                                        </ObjectAnimationUsingKeyFrames>
                                    </Storyboard>
                                </VisualState>
                            </VisualStateGroup>
                        </VisualStateManager.VisualStateGroups>
                        <ContentPresenter HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                    </Grid>
                </ControlTemplate>
            </Setter.Value>
        </Setter>
    </Style>
</UserControl.Resources>

<Button x:Name="FlashingButton" Content="Blink" Style="{StaticResource BPMFlashingButton}" BorderBrush="{StaticResource PhoneBorderBrush}"/> 
```

然后我有这个方法

```
public void startAnimation()
    {
        VisualStateManager.GoToState(FlashingButton, "Flashing", true);
    } 
```

使动画开始。

但是当我调用它时，按钮变为红色并保持静止，不闪烁！

有什么建议吗？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-17T09:45:34.493

我认为你应该记录一个独立的故事板而不是使用 VisualStateManager。您将 Storyboard 设置为 RepeatBehavior="Forever" 并使用 Trigger 触发它。

# php - 如何在 php 中获取 Facebook 用户详细信息？

> ID：14359826
> 
> 赞同：0
> 
> 时间：2013-01-16T13:43:12.477
> 
> 标签：php, facebook, facebook-graph-api, facebook-javascript-sdk

我使用 javascript sdk 登录 facebook。一旦用户登录，然后在服务器端我使用此代码获取用户详细信息，但它不是创建会话，而是在 javascript 中创建会话。

这是我的 javascript 代码

```
$('body').delegate(".fblogin","click",function(){
    FB.init({appId: '', xfbml: true, cookie: true,oauth      : true,});
     FB.login(function(response) {
   if (response.authResponse) {
     console.log('Welcome!  Fetching your information.... ');
     FB.api('/me', function(response) {
       console.log('Good to see you, ' + response.name + '.');
     });
   } else {
     console.log('User cancelled login or did not fully authorize.');
   }
 }); 
```

一旦用户登录，我就会调用 ajax 函数来获取朋友，但它不会在 php 端创建会话。

PHP代码是

```
if(!$this->facebook->logged_in()){
 echo '<li class="fblogin"><img src="http://naveen/app/assets/img/connect-with-facebook.png" class="ac_even"></li>';
}
else{
    $this->load->library('facebook');
    $fbfriends =  $this->facebook->call('get', 'me/friends');
    $friends=$fbfriends->data;
} 
```

每次它显示fb登录图像。

任何机构都可以帮助如何解决这个问题。我的英语不是很好。如果有任何错误，请原谅。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:00:56.630

很可能是会话问题，尝试切换到 PHP 本机会话并查看它是否有效。

一个原生 PHP 会话替换库可供下载（通过 google 查找）。

希望这能解决您的问题。

# wpf - WPF 从 BackgroundWorker 线程使用和访问 ObjectContext

> ID：14359827
> 
> 赞同：1
> 
> 时间：2013-01-16T13:43:15.230
> 
> 标签：wpf, multithreading, backgroundworker, invoke, ui-thread

我有如下代码（为了便于阅读，我删除了一些代码）

```
 private void RicercaArticoloStripped(object sender, DoWorkEventArgs e)
    {
        try
        {
            using (var context = new ControlloSchedeLocalEntities())
            {
                var prodotti = context.VProdotti.Where(i => i.WACMAT == textBoxCodiceArticolo.Text);

                if (prodotti.Count() > 0)
                {
                    this.Dispatcher.Invoke(System.Windows.Threading.DispatcherPriority.Normal, new Action(delegate()
                    {
                        textBlockDescrizioneArticolo.Text = prodotti.FirstOrDefault().WADESC;
                    }));
                }
            }
        }
        catch (Exception ex)
        {
            MessageBox.Show("Error:\n\n" + ex.Message + "\r\nStack: " + ex.ToString());
        }
    }

    private void textBoxCodiceArticolo_KeyUpStripped(object sender, KeyEventArgs e)
    {
        if (e.Key == Key.Enter)
        {
            worker = new BackgroundWorker();
            worker.WorkerReportsProgress = true;
            worker.DoWork += new DoWorkEventHandler(RicercaArticoloStripped);
            worker.RunWorkerCompleted += new RunWorkerCompletedEventHandler(worker_RicercaArticoloWorkerCompleted);
            worker.ProgressChanged += new ProgressChangedEventHandler(worker_ProgressChanged);

            object[] parameters = new object[] { textBoxCodiceArticolo.Text, textBlockDescrizioneArticolo.Text };
            worker.RunWorkerAsync(parameters);
        }
    } 
```

所以，至于我对BackgroundWorker的理解，当我实例化时： var prodotti = context.VProdotti.Where(i => i.WACMAT == textBoxCodiceArticolo.Text);

我是从工作线程做的，而不是 UI 线程。

但是当我尝试访问该值时，下面的行出现异常： if (prodotti.Count() > 0)

我得到了一个著名的错误： **“调用线程无法访问这个对象，因为另一个线程拥有它”**

为什么？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:05:54.433

`Text`的属性`TextBox`获取 的值`DependencyProperty` `Text`，这只能从 UI 线程完成。您正在`textBoxCodiceArticolo.Text`从您的 Worker 线程访问。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:56:57.043

正如您已经说过的，您必须使用`Dispatcher.BeginInvoke/Invoke`从控件的所有者线程执行操作，否则您将收到**“调用线程无法访问此对象，因为不同的线程拥有它”**异常。这就是你得到这个例外的原因；

这就是为什么您在下面的行（何时`prodotti.Count()`调用）出现此异常：

当您创建`prodotti`变量时，它只是一个`IEnumerable<T>`对象。所以他实际上只在你调用`prodotti.Count()`方法时计算，这就是你在这条线上遇到异常的原因。

`IEnumerable`实际上是生成器，这意味着他每次使用都会产生一组新的对象。

要对此进行测试，您可以计算`prodotti`如下所示：

```
var prodotti = context.VProdotti.Where(i => i.WACMAT == textBoxCodiceArticolo.Text).ToList(); 
```

在这种情况下，您将立即获得异常，因为 .ToList() 强制所有计算。

检查这篇文章的生成器和枚举器：http: [//www.codeproject.com/Articles/155462/IEnumerable-Lazy-and-Dangerous](http://www.codeproject.com/Articles/155462/IEnumerable-Lazy-and-Dangerous)

更新：真的，当您使用带有引用类型的 IEnumerable 时，您可以获得与以前相同的对象。阅读此答案了解更多信息：[https ://stackoverflow.com/a/14361094/1467309](https://stackoverflow.com/a/14361094/1467309)

# cakephp - CakePHP 应用程序：一些页面使用 SSL，一些没有

> ID：14359828
> 
> 赞同：0
> 
> 时间：2013-01-16T13:43:22.150
> 
> 标签：cakephp, ssl, https

我有一个用 CakePHP 框架编写的应用程序，它目前位于 httpdocs 中。我希望将一些页面重定向到 https://

基本上，检测用户是否已经在 https://... 上应该不是问题。我的问题是另一个问题：在我看来，我需要制作整个项目的副本并将其存储在 httpsdocs 中，对吗？这听起来很愚蠢，但它应该如何在不复制代码的情况下工作呢？我想我错过了什么，但我不明白......

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T14:18:41.100

我从来不用复制 ssl 的代码。您应该在站点的虚拟主机中指定路径是什么。

在 apache 上，每个 ssl 和非 ssl 都有一个虚拟主机。两者都可以具有相同的 webroot 路径。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:58:14.883

如果您的虚拟主机要求您将网站的 https 部分放在 httpsdocs 中，那么您需要在其中放置一些内容。但不是整个项目：可能只有 /web 部分（实际上由 webhoster 提供的部分）。

就像是

```
/cake/app/  --> your app code
/httpsdoc/..  --> index.php and possibly css stuff, images etc
/httpsdocs/.. --> copy of index.php and the rest as well 
```

当然，您也可以在 .htaccess 中使用一些内部重定向

一个建议：既然 google 索引了 https url，您还可以选择通过 https 使整个站点可用。

# fluent-nhibernate - fluentnhibernate配置错误

> ID：14359832
> 
> 赞同：0
> 
> 时间：2013-01-16T13:43:45.010
> 
> 标签：fluent-nhibernate

我通过观看来自 **[http://www.d80.co.uk/post/2011/10/06/NHibernate-Video-Tutorial.aspx](http://www.d80.co.uk/post/2011/10/06/NHibernate-Video-Tutorial.aspx)** 网站的视频创建了一个控制台应用程序。当我尝试执行代码时，它给了我以下错误：

创建 SessionFactory 时使用了无效或不完整的配置。检查 PotentialReasons 集合和 InnerException 了解更多详细信息。

但是当我下载代码并执行时，它工作正常。我已经检查了两个代码并且是相同的。所以不明白我做错了什么。我在这里发布我的代码，请帮助我摆脱这种情况。

## **NhibernateHelper.cs**

```
using FluentNHibernate.Cfg;
using FluentNHibernate.Cfg.Db;
using NHibernate;
using NHibernate.Tool.hbm2ddl;
using System;

namespace FluentNHibernate
{    
    class NhibernateHelper
    {
        private static ISessionFactory _sessionFactory;

        private static ISessionFactory sessionFactory
        {
            get
            {
                if (_sessionFactory == null)
                {
                    initialisationFactory();
                }

                return _sessionFactory;
            }

        }
        private static void initialisationFactory()
        {
            try
            {
                _sessionFactory = Fluently.Configure()
                                    .Database(MsSqlConfiguration.MsSql2005.ConnectionString(@"Server=10.10.10.7;Database=TestDatabase;uid=sa;pwd=9ijnhy6;Trusted_Connection=false;").ShowSql())
                                    .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Car>())
                                    .ExposeConfiguration(cfg => new SchemaExport(cfg).Create(true, true))
                                    .BuildSessionFactory();
            }
            catch (Exception e)
            {

                throw;
            }

        }
        public static ISession OpenSession()
        {
            return sessionFactory.OpenSession();
        }

    }
} 
```

## **程序.cs**

```
using System;
using FluentNHibernate.Mapping;
namespace FluentNHibernate
{
    internal class Program
    {
        public static void Main(string[] args)
        {
            using (var session = NhibernateHelper.OpenSession())
            {
                using (var transaction = session.BeginTransaction())
                {
                    var fordMake = new Make
                    {
                        Name = "Ford"
                    };
                    var fiestaModel = new Model
                    {
                        Name = "Fiesta",
                        Make = fordMake
                    };

                    var car = new Car
                    {
                        Make = fordMake,
                        Model = fiestaModel,
                        Title = "Dans Car"
                    };

                    session.Save(car);

                    transaction.Commit();

                    Console.WriteLine("Created Car " + car.Title);
                }
            }
            Console.ReadLine();
        }
    }
    public class MakeMap : ClassMap<Make>
    {
        public MakeMap()
        {
            Id(x => x.Id);
            Map(x => x.Name);
        }
    }
    public class ModelMap : ClassMap<Model>
    {
        public ModelMap()
        {
            Id(x => x.Id);
            Map(x => x.Name);
            References(x => x.Make).Cascade.All();
        }
    }
    public class CarMap : ClassMap<Car>
    {
        public CarMap()
        {
            Id(x => x.Id).GeneratedBy.HiLo("Car");
            Map(x => x.Title);
            References(x => x.Make).Cascade.All();
            References(x => x.Model).Cascade.All();
        }
    }
    public class Make
    {
        public virtual int Id { get; set; }
        public virtual string Name { get; set; }
    }
    public class Model
    {
        public virtual int Id { get; set; }
        public virtual string Name { get; set; }
        public virtual Make Make { get; set; }
    }
    public class Car
    {
        public virtual int Id { get; set; }
        public virtual string Title { get; set; }
        public virtual Make Make { get; set; }
        public virtual Model Model { get; set; }
    }
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T20:31:12.697

您的 NHibernateHelper.cs 与我的有很大不同。

尝试改变

```
_sessionFactory = Fluently.Configure()
                                          .Database(MsSqlConfiguration.MsSql2005.ConnectionString(@"Server=10.10.10.7;Database=TestDatabase;uid=sa;pwd=9ijnhy6;Trusted_Connection=false;").ShowSql())
                                          .Mappings(m => m.FluentMappings.AddFromAssemblyOf<Car>())
                                          .ExposeConfiguration(cfg => new SchemaExport(cfg).Create(true, true))
                                          .BuildSessionFactory(); 
```

至：

```
_sessionFactory = Fluently.Configure()
            .Database(MsSqlConfiguration.MsSql2005.ConnectionString(c => c.FromConnectionStringWithKey("ConnectionString")))
            .Mappings(cfg =>
            {
                cfg.FluentMappings.AddFromAssembly(Assembly.GetExecutingAssembly());
                cfg.FluentMappings.Conventions.Add(AutoImport.Never());
            })
            .ExposeConfiguration(x =>
            {
                x.SetProperty("current_session_context_class", mode);
            })
            .BuildSessionFactory(); 
```

在您的 web.config 或 app.config 中，在标签中添加以下内容：

```
<connectionStrings>
    <add name="ConnectionString" connectionString="Data Source=10.10.10.7; Initial Catalog=TestDatabase; User Id=sa; Password=9ijnhy6;"/>
</connectionStrings 
```

希望这会有所帮助。

# heroku - 使用 heroku pg:transfer 传输特定表

> ID：14359837
> 
> 赞同：0
> 
> 时间：2013-01-16T13:44:11.023
> 
> 标签：heroku

使用 taps gem 可以做到：

```
heroku db:pull -f '^(?!requests).*' --app AppName --confirm AppName" 
```

这将传输模式，并且除了表的那些表和索引之外的所有表和索引都`requests`将留在生产数据库中。

是否有任何选项可以使用 pg:transfer 执行此操作？我一个都看不到

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T20:47:22.227

您可以`pg_dump`在本地计算机上对远程 heroku postgres 数据库使用完整的命令。`pg_dump`有几个选项，包括选择性地转储表。

有关完整信息，请参见[http://www.postgresql.org/docs/current/static/app-pgdump.html](http://www.postgresql.org/docs/current/static/app-pgdump.html)`pg_dump`

# join - 使用 ETL 中的表连接更改数据捕获

> ID：14359845
> 
> 赞同：4
> 
> 时间：2013-01-16T13:44:32.453
> 
> 标签：join, data-warehouse, etl, cdc

在我的 ETL 过程中，我使用更改数据捕获 (CDC) 来仅发现自上次提取以来源表中已更改的行。然后我只对这些行进行转换。问题是，例如，当我有 2 个要加入一维的表时，其中只有一个发生了变化。例如，我有如下表国家和城镇：

国家：

```
ID Name
1  France 
```

城市：

```
ID Name  Country_ID
1  Lyon  1 
```

现在假设在 Towns 表中添加了一个新行：

```
ID Name  Country_ID
1  Lyon  1
2  Paris 2 
```

Country 表没有更改，因此这些表的 CDC 仅向我显示 Towns 表中的行。问题是当我在国家和城镇之间进行连接时，国家更改集中没有行，因此连接将导致空集。

你知道如何解决它吗？当然，可能会有更困难的情况，涉及 3 个或更多表以及后续连接。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-20T19:17:33.773

这是在进行实时更改数据捕获甚至仅增量每日更改时发现的典型问题。

有多种方法可以解决这个问题。

一种方法是对维度或映射表中的自然键进行连接，以获取关联的国家/地区（SELECT distinct country_name, [..other attributes..] from dim_table where country_id = X）。

另一种选择是将连接作为变更捕获过程的一部分进行 - 当将行加载到城镇时，触发器会关闭，将外键值加载到关联的临时表（国家等）中。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-17T22:52:00.283

我可以喋喋不休地了解更多信息，但我会具体说明你的问题。我会建议以下获得结果...

```
1st Pass is where everything matches via the join... 
Union All 
2nd Pass Gets all towns where there isn't a country
(left outer join with a where condition that 
requires the ID in the countries table to be null/missing). 
```

您可以将该不匹配联接中的 Country ID 值默认为指定为“不匹配值”的值，通常使用 0 或 -1 或一系列标准负数，您可以稍后将描述分配给这些数字，以确定数据对您不利的原因例如 -1 可以是“Found Town without Country”。

# ajax - p:dialog 在使用 dialog.hide() 时不会触发 ajax 关闭事件

> ID：14359847
> 
> 赞同：5
> 
> 时间：2013-01-16T13:44:40.483
> 
> 标签：ajax, validation, jsf, dialog, primefaces

我正在使用`<p:dialog>`. 在其中提交表单后，我使用`dialog.hide()`并触发 ajax 关闭事件侦听器方法，该方法将更新`List<E>`. 它工作正常，但是当我放置一些必需的输入组件并在`<p:dialog>`出现某些验证错误时再次返回时，它不再触发该方法。

对话框：

```
<p:outputPanel autoUpdate="true">
    <p:dialog id="dialogComentario" header="Deixe sua avaliação" widgetVar="confirmation" 
        showEffect="fade" hideEffect="fade" height="340" width="500" modal="true" 
        visible="#{not empty facesContext.maximumSeverity}" 
        resizable="false" closable="true" draggable="false">
        <h:form prependId="false">
            ...
            <p:commandLink styleClass="btn btn-primary btenviacoment" 
                oncomplete="if (!args.validationFailed) confirmation.hide();" 
                actionListener="#{comentario.actEnviarComentario}" global="false">
                <i class=" icon-play-circle icon-white"></i>
                <h:outputText value=" Enviar Comentário" />
                <f:param name="codigoplu" value="#{produto.produto.codigoplu}" />
            </p:commandLink>
            ...
            <p:commandLink styleClass="btn" onclick="confirmation.hide();" 
                global="false" immediate="true">
                <h:outputText value=" Cancelar" />
                <i class="icon-off"></i>
            </p:commandLink>
            ...
        </h:form>
        <p:ajax event="close" update=":avaliacoesClientes, :dialogComment" 
            listener="#{produto.atualizarComentarios}" global="false" />
    </p:dialog>
</p:outputPanel> 
```

动作监听器方法：

```
public void actEnviarComentario(ActionEvent event) {
    String codigoplu = FacesContext.getCurrentInstance().getExternalContext().getRequestParameterMap().get("codigoplu");
    PegarDadosCliente();

    try {
        DateFormat f = new SimpleDateFormat("dd/MM/yyyy");
        java.util.Date utildata = new java.util.Date();
        utildata = (java.util.Date) f.parse(String.valueOf(data.getValue()));
        java.sql.Date datasql = new java.sql.Date(utildata.getTime());

        Comentario comentario = new Comentario(Integer.parseInt(usuario.getId()), Integer.parseInt(codigoplu), titulo.getValue().toString(), mensagem.getValue().toString(), datasql, Integer.parseInt(rating.getValue().toString()), new java.sql.Date(new Date().getTime()));
        listavelComentarios.inserirComentario(comentario);

        RequestContext.getCurrentInstance().execute("confirmation.hide();");
    } catch (NamingException e) {
        e.printStackTrace();
    } catch (SQLException e) {
        e.printStackTrace();
    } catch (ParseException e) {
        e.printStackTrace();
    }
} 
```

我试图关闭对话框，`RequestContext`如操作方法所示，但这也不会触发 ajax 关闭事件。

这是 ajax 关闭事件监听器方法：

```
public void atualizarComentarios(CloseEvent event) {

    try {
        comentarios = comentario.listarComentarios(codigoplu);

        if (comentarios.size() > 0) {
            msgAvaliacao = "Avaliação do produto.";
            int votos = 0;

            for (Comentario comentario : comentarios) {
                votos += comentario.getAvaliacao();
            }

            rating = votos / comentarios.size();
        }
    } catch (NamingException e) {
        e.printStackTrace();
    } catch (SQLException e) {
        e.printStackTrace();
    }
} 
```

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T15:29:14.103

此问题与验证无关。删除所有这些输入组件并按下命令按钮/链接，您会看到它仍然没有被触发。

此问题是由 和 的不必要组合引起`<p:outputPanel autoUpdate="true">`的`visible="#{not empty facesContext.maximumSeverity}"`。输出面板会不断自动更新对话框，这显然会迫使您`visible`像这样设置属性。`oncomplete`在触发事件之前，对话框会自动更新。如果 dialog`visible`属性是，则在触发`false`之前对话框已经隐藏（不可见） 。`oncomplete`

所以，只要去掉`<p:outputPanel>`and`visible`属性。你`oncomplete`已经做了正确的工作。

* * *

**与具体问题**无关**`RequestContext`，这条线是不必要的。你已经把它藏起来了，`oncomplete`这很好。另请参阅[在提交后发生验证错误时保持 p:dialog 打开](https://stackoverflow.com/questions/9195756/keep-pdialog-up-when-a-validation-error-occurs-after-submit)。**

# c# - 在 C# 中使用 Telnet 执行命令

> ID：14359850
> 
> 赞同：0
> 
> 时间：2013-01-16T13:44:50.533
> 
> 标签：c#, command, telnet

> **可能重复：**
> [C# Telnet 库](https://stackoverflow.com/questions/390188/c-sharp-telnet-library)

我希望使用 C# 以编程方式进行**远程登录**，这样一旦我建立到服务器的连接，我就可以在服务器上执行*ls、ls -l、mv、rm 等*命令。

是否可以？用于此目的的 C# 中是否有类似于 FTP (FtpWebRequest) 的类？如果是，请指导我采用正确的方法。

当我执行*ls*时，我需要将服务器上生成的列表发送到客户端，即在我的情况下的 windows 机器。

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T14:31:53.100

是的，这里有一个 telnet 库 [http://www.codeproject.com/KB/IP/MinimalisticTelnet.aspx](http://www.codeproject.com/KB/IP/MinimalisticTelnet.aspx)

# java - LibGDX - 正确使用多边形类

> ID：14359852
> 
> 赞同：4
> 
> 时间：2013-01-16T13:44:55.727
> 
> 标签：java, math, libgdx, collision-detection

我已经创建`Polygon`了包裹我的飞机的对象（飞机的尺寸`TextureRegion`是 256x74，但在游戏中这个尺寸是 70x20）。所以：

```
TextureRegion[] texRegsAirplane = TextureRegion.split(textureAirplane, 256, 74);
Rectangle bounds = new Rectangle(0, 0, 70, 20);
Polygon polygon = new Polygon(new float[]{0,0,bounds.width,0,bounds.width,bounds.height,0,bounds.height,0,0}); 
```

之后在我的`update`函数中我更新它的位置：

```
public void update(float delta){
    Vector2 v = getPosition();      
    v.add(velocity);
    polygon.setPosition(v.x, v.y);
} 
```

然后我渲染多边形以知道它在哪里：

```
public void render(SpriteBatch spriteBatch, float pixelPerUnitX, float pixelPerUnitY){
spriteBatch.draw(testTexture,polygon.getX()*pixelPerUnitX, polygon.getY()*pixelPerUnitY, 
            polygon.getBoundingRectangle().width*pixelPerUnitX,polygon.getBoundingRectangle().height*pixelPerUnitY);
} 
```

最后，我创建了 2 架飞机并让它们相互飞行，每次迭代我都尝试检测如下碰撞：

```
public void detectCollision(){
    for(Airplane airplane1 : Airplanes){
        for(Airplane airplane2 : Airplanes){
            if(Intersector.overlapConvexPolygons(airplane1.getPolygon(), airplane2.getPolygon())){
                //COLLISION DON'T HAPPEN!!!
            }
    }
} 
```

我看到 2 个矩形相互移动并相交，但`overlapConvexPolygons`功能不起作用！为什么？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T14:43:30.460

我已经解决了这个问题。我错误地指定了顶点。我需要得到矩形多边形，所以我不得不使用以下：

```
polygon = new Polygon(new float[]{0,0,bounds.width,0,bounds.width,bounds.height,0,bounds.height}); 
```

如果要旋转多边形对象，请不要忘记设置原点：

```
polygon.setOrigin(bounds.width/2, bounds.height/2); 
```

现在它完美无缺！

# mysql - 如何使用 bash 脚本链接 2 个 MySQL 数据库

> ID：14359857
> 
> 赞同：2
> 
> 时间：2013-01-16T13:45:03.747
> 
> 标签：mysql, bash

我想使用 bash 脚本将数据库中特定表中的行插入到另一个数据库中。这两个数据库位于不同的服务器上。我怎样才能做到这一点？

我想要这样的东西：

INSERT INTO db1.table1(row1, row2) SELECT row1,row2 FROM db2.table2;

但是数据库位于不同的服务器上。

谢谢你。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:59:05.957

我建议使用 Percona Toolkit 中的[pt-archiver](http://www.percona.com/doc/percona-toolkit/pt-archiver.html)工具。它可以将行从一个实例复制或移动到另一个实例。它高效且渐进地完成其工作。

例子：

```
$ pt-archiver --no-delete \
    --source h=host1,D=db1,t=table1 \
    --dest h=host2,D=db2,t=table2 \
    --columns col1,col2 \
    --where "1=1" --limit 1000 --commit-each 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:59:50.877

我认为您需要使用`ssh`执行远程命令并`mysldump`从远程数据库和 mysql 获取行以将行插入本地数据库。

`ssh <remoteuser>@<remoteServer> mysqldump -t -u <remoteDbUser> -p<remoteDbPass> <remoteDbName> <remoteDbTable> -w<whereCondition> | mysql -u <localDbUser> -p<localDbPass> <localDbName>`

请注意：

1.  -p 和密码之间没有空格。
2.  -t 选项避免了 CREATE TABLE sql 指令

有关 mysqldump 命令的更多信息，请使用手册页。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:53:33.030

如果你想在同一台服务器上做两个 MySQL 数据库之间的操作，这很容易。看到这个线程：

[http://forums.mysql.com/read.php?61,3063,4004#msg-4004](http://forums.mysql.com/read.php?61,3063,4004#msg-4004)

如果您想从不同服务器上的数据库传输数据，或者如果它是不同类型的数据库，则更加困难，您可能必须使用软件或构建一些软件。MySQL 没有 Oracle 拥有的数据库链接功能

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T14:12:47.027

看到这个： [http](http://dev.mysql.com/doc/refman/5.6/en/federated-create-connection.html) ://dev.mysql.com/doc/refman/5.6/en/federated-create-connection.html 它就像mysql的数据库链接。

# java - 向重定向页面发送 Flash 消息

> ID：14359858
> 
> 赞同：6
> 
> 时间：2013-01-16T13:45:06.660
> 
> 标签：java, redirect, jsf-2, message, flash-scope

我有一个页面，当我保存数据时添加新项目我转到另一个页面，我想看到“数据已成功保存”的消息。我读到该消息属于请求范围，这就是我使用闪存范围的原因。

```
context.addMessage("calendarGameForm:growl", new FacesMessage("Data was saved successful");
context.getExternalContext().getFlash().setKeepMessages(true);
return outcome; 
```

这是由第一页上的保存按钮调用的`addSeason.xhtml`。

```
<p:commandButton id="save" action="#{controller.add}"
                 value="#{msg.save}" ajax="true"
                 type="submit" update="@form"/> 
```

导航规则定义如下。

```
<navigation-rule>
    <from-view-id>/competitions/addSeason.xhtml</from-view-id>
    <navigation-case>
        <from-outcome>success</from-outcome>
        <to-view-id>/competitions/calendarGame.xhtml</to-view-id>
        <redirect/>
    </navigation-case>
    <navigation-case>
        <from-outcome>fail</from-outcome>
        <to-view-id>/competitions/calendarGame.xhtml</to-view-id>
        <redirect/>
    </navigation-case>
</navigation-rule> 
```

但是在目标页面中，`calendarGame.xhtml`我没有收到我的信息。

```
<p:growl id="growl" globalOnly="true" sticky="true"/> 
```

我也在服务器日志中收到此警告。

> 警告 [javax.enterprise.resource.webcontainer.jsf.flash] (ajp--127.0.0.1-8009-1) JSF1095：在我们尝试为 flash 设置传出 cookie 时，响应已经提交。存储到闪存中的任何值在下一次请求时都将不可用。

我怎样才能解决我的问题？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T14:00:13.260

这个问题是双重的。

至于第一个问题，我推测您是在操作方法中添加面孔消息，而不是在预渲染视图期间，对吗？你有一个`return outcome`，所以它在一个真正的动作方法中是有道理的。在这种情况下，JSF1095 消息是由 Mojarra 中与 Ajax 编码相关的错误引起的，并已在 2.1.11 中修复。Mojarra 有很多与 Flash 范围相关的问题，其中最后一个在 2.1.14 中修复。*我建议至少*将Mojarra 更新到该版本。目前[已经](http://javaserverfaces.java.net)是 2.1.17。

至于第二个问题，a`<p:growl globalOnly="true">`只显示带有`null`客户端 ID 的消息。改正您的`addMessage()`呼叫以通过`null`。

```
context.addMessage(null, message); 
```

如果您*实际上是*在导航之前的预渲染事件期间添加 faces 消息，那么问题将有不同的原因并且需要不同的解决方案。除其他外，请参阅此答案：[Mojarra 2.1.14 flash scope messages and redirect to different path](https://stackoverflow.com/questions/12723100/mojarra-2-1-14-flash-scope-messages-and-redirect-to-different-path/12730200#12730200)。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:54:02.507

消息必须在接收页面/视图中设置。为此，我会尝试使用`preRenderViewEvent`. 您应该在其中添加代码（您也可以使用其他形式的消息通知）

[`preRenderViewEvent`](http://www.mkyong.com/jsf2/jsf-2-prerenderviewevent-example/)用法示例。

# regex - 正则表达式 - 可选且需要

> ID：14359862
> 
> 赞同：0
> 
> 时间：2013-01-16T13:45:14.197
> 
> 标签：regex, wildcard

我正在尝试使用正则表达式做一些事情，我想知道如何执行以下操作：接受：

```
http://google.com
https://google.com
http://google.com/
https://google.com/
http://google.com/*
https://google.com/*
http://*.google.com
https://*.google.com
http://*.google.com/
https://*.google.com/
http://*.google.com/*
https://*.google.com/* 
```

子域通配符只能包含 [az][AZ][0-9] 并且是可选的，但如果它存在，则必须在其后添加一个点。

我来了：

```
https?://(www.)google.com/ 
```

但我认为这不是正确的工作方式......而且只有www。是可用的。我希望有人能给我所需的结果，并解释为什么它会这样工作。

谢谢，

丹尼斯

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2013-01-16T13:52:11.620

我想这可能是你所追求的：

```
https?://([a-zA-Z0-9]+\.)?google\.com(/.*)? 
```

[该站点](http://regexpal.com/)将帮助您验证您的正则表达式。这似乎与您想要的匹配，但您可能希望对最后一部分更具体，因为几乎可以`.*`匹配任何内容。

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T14:01:52.583

```
http(s)?://([a-zA-Z0-9]+\.)?google\.com(/.*)? 
```

[这是 rmhartog 的答案，对我来说看起来是正确的] 我只是想扩展问题中提出的原因。OP请不要接受我的回答，因为我只是在扩展前一个人的回答。

```
http - This must be an exact match
(s)? - ? is zero or one time
://  - This must be an exact match
(    - start of a group
[a-zA-Z0-9] - Defines a character class that allows any of these characters in it.
+    - one or more of these characters must be present, empty set is invalid.
\.   - escapes the dot character (usually . is a wildcard in regex)
)?   - end of the group and the group can appear 0 or one time
google - This must be an exact match
\.   - escapes the dot character (usually . is a wildcard in regex)
com  - This must be an exact match
(    - start of a group
/    - This must be an exact match
.*   - matches any character 0 or more times (this fits anything you can type)
)?   - end of the group and the group can appear 0 or one time 
```

我希望这有助于解释上面的答案，很难将这一切都作为评论。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:57:41.613

作为 POSIX ERE：

```
https?://(\*|([a-zA-Z0-9]+)\.)?google.com 
```

该`(\*|([a-zA-Z0-9]+)\.)`部分表示您有一个`*`或一个字母数字字符串，然后是一个点。这是可选的，所以后面跟一个问号。

您还可以`[a-zA-Z0-9]`用 POSIX 字符类替换范围：`[[:alnum:]]`，给出：

```
https?://(\*|([[:alnum:]]+)\.)?google.com 
```

# centos - Sendmail 无法向 Internet 发送信件（仅发送本地邮件）

> ID：14359864
> 
> 赞同：0
> 
> 时间：2013-01-16T13:45:15.437
> 
> 标签：centos, sendmail

我在 Intranet 服务器上使用 centos 5 和 sendmail。本地邮件正在完美传送，但是当我尝试将电子邮件传送到 gmail 时，例如（或 Intranet 之外的任何其他服务），我在日志中发现以下错误：

```
Jan 16 16:50:32 testlink sendmail[27713]: r0GCoVi5027711: to=<example@gmail.com>,
ctladdr=<webdev@testlink.ru.corp.domain.com> (502/502), delay=00:00:01,
xdelay=00:00:01, mailer=esmtp, pri=120332, relay=alt4.gmail-smtp-in.l.google.com.
[173.194.68.27], dsn=4.0.0, stat=Deferred: 
Connection refused by alt4.gmail-smtp-in.l.google.com. 
```

更重要的一件事 - 无法从互联网访问服务器，但我可以从我的服务器访问互联网..

请建议我应该在哪里搜索问题.. 我知道我应该以某种方式设置 sendmail（目前我使用的是 yum 设置的默认配置），但是什么设置（或至少是方向）......提前致谢！

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:47:59.493

`ifconfig`在命令行中运行。也许你的 IP 有问题

也调查`iptables -L`

`netstat -nap`应该有一个字符串

```
tcp        0      0 0.0.0.0:25                  0.0.0.0:*                   LISTEN      5275/sendmail 
```

检查提供程序是否阻止端口 25：

```
telnet smtp.ukr.net 25 
```

# javascript - 试图理解 javascript regexp 结果

> ID：14359868
> 
> 赞同：3
> 
> 时间：2013-01-16T13:45:30.263
> 
> 标签：javascript, regex

我想使用具有两种替代格式的 javascript 解析字符串：

```
id#state#{font name, font size, "text"}  
// e.g. button1#hover#{arial.ttf, 20, "Ok"} 
```

或者

```
id#state#text                            
// e.g. button1#hover#Ok 
```

在第二个变体中，假定默认字体和大小。

在您进一步阅读之前，我必须指出我控制格式，所以我很想听听任何其他更符合 RegExp Friendly™ 的格式。话虽如此，出于历史原因，需要第二种选择，`id#state#`-part也是如此。换句话说，灵活性在于`{font name, font size, "text"}`-part。

此外，我想尽可能使用 RegExp。是的，我在下面建议的 RegExp 非常多毛，但就我而言，这不仅是解决手头问题的可能解决方案，而且也是了解更多关于 RegExp 本身的问题。

我目前对两种格式的三个或五个信息元素进行分组的尝试如下。

```
var pat = /^(\w*)#(\w*)#
          (?:(?:\{([\w\.]*),\s*([0-9\.]*),\s*"([\w\s]*)"\})|([\w\s]*))$/;

var source1 = "button1#hover#{arial.ttf, 20, \"Ok\"}";
var source2 = "button1#hover#Ok";

var result1 = source1.match ( pat );
var result2 = source2.match ( pat );

alert ( "Source1: " + result1.length + " Source2: " + result2.length ); 
```

[当我在http://www.regular-expressions.info/javascriptexample.html](http://www.regular-expressions.info/javascriptexample.html)测试这个表达式时，我得到：

```
result1 = [ button1#hover#{arial.ttf, 20, "Ok"}, button1, hover, arial.ttf, 
            20, Ok, undefined ] 
```

和

```
result2 = [ button1#hover#Ok, button1, hover, undefined, 
            undefined, undefined, Ok ] 
```

这是我分解正则表达式的方法：

```
^(\w*)#(\w*)#(?:(?:\{([\w\.]*),\s*([0-9\.]*),\s*"([\w\s]*)"\})|([\w\s]*))$

^                 # anchor to beginning of string
(\w*)             # capture required id
#                 # match hash sign separator
(\w*)             # capture required state
#                 # match hash sign separator
                  # capture text structure with optional part:
(?:(?:\{([\w\.]*),\s*([0-9\.]*),\s*"([\w\s]*)"\})|([\w\s]*))  
$                 # anchor to end of string 
```

我猜，文本结构捕获是最狡猾的部分。我将其分解如下：

```
(?:                  # match all of what follows but don't capture
    (?:\{            # match left curly bracket but don't capture (non-capturing group)
          ([\w\.]*)  # capture font name (with possible punctuation in font file name)
          ,\s*       # match comma and zero or more whitespaces
          ([0-9\.]*) # capture font size (with possible decimal part)
          ,\s*"      # match comma, zero or more whitespaces, and a quotation char
          ([\w\s]*)  # capture text including whitespaces
    "\})             # match quotation char and right curly bracket (and close non-capturing group)
    |                # alternation operator
    ([\w\s]*)        # capture optional group to match the second format variant
)                    # close outer non-capturing group 
```

我的问题有两个：

1）如何避免在 result1 情况下出现尾随未定义匹配？

2）如何避免 result2 案例中间的三个未定义匹配？

奖金问题：

我理解错了吗？（我想有些不对劲，因为 RegExp 没有完全按预期工作。）

谢谢！:)

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:59:04.820

正则表达式中的组从左到右编号，不考虑运算符（特别是`|`运算符）。当你得到时`(x)|(y)`，“x”或“y”的组将是`undefined`。

因此，您无法避免结果中的空槽。事实上，我认为你*想要*它们，因为否则你真的不知道你匹配了哪种形式的输入。

# driver - 用于 MTP 设备的 UMDF 过滤器驱动程序

> ID：14359871
> 
> 赞同：2
> 
> 时间：2013-01-16T13:45:36.910
> 
> 标签：driver, wpd, mtp, umdf, filter-driver

我正在尝试为 Windows 7 上的 MTP 设备编写过滤器驱动程序，以记录文件操作并阻止某些文件操作。我发现在 Windows 中处理 MTP 的驱动程序是一个名为 WpdMtpDr.dll 的 UMDF 驱动程序，我根据这个[示例](http://code.msdn.microsoft.com/windowshardware/umdffilterumdf-a0094c5e)（UMDF 函数驱动程序之上的示例 UMDF 过滤器驱动程序）为它编写了一个 UMDF 过滤器驱动程序，因为我将`WpdMtpDr.dll`其视为功能驱动程序。我还[以此](http://blogs.msdn.com/b/888_umdf_4_you/archive/2009/04/27/9571980.aspx)作为参考来确定驱动程序是作为上过滤器还是下过滤器安装的。我使用 dpinst.exe 安装了驱动程序。下面是我的 INF 文件。

安装没有错误，但在插入 MTP 设备（三星 Galaxy S3）时，过滤器驱动程序不在其驱动程序列表中（通过设备管理器查看），并且从未调用其 DllMain。

我试图在上下过滤器之间切换，它也没有帮助。

我究竟做错了什么？

```
;
; umdffilter.inf
;

[Version]
Signature="$Windows NT$"
Class=WPD
ClassGuid={EEC5AD98-8080-425f-922A-DABF3DE3F69A}
Provider=%ManufacturerName%
CatalogFile=umdffilter.cat
DriverVer=01/02/2013,18.8.52.851`

[Manufacturer]
%ManufacturerName%=Standard,NTamd64

[Standard.NTamd64]
%DeviceName%=MyDevice_Install, usb\vid_04e8&pid_6860

[SourceDisksFiles]
umdffilter.dll=1
WudfUpdate_01011.dll=1
WdfCoInstaller01011.dll=1
WinUsbCoinstaller2.dll=1

[SourceDisksNames]
1 = %DiskName%

; =================== UMDF Filter Driver ==================================

[MyDevice_Install.NT]
CopyFiles=UMDriverCopy
Include=wpdmtp.inf, WINUSB.INF          ; Import sections from wpdmtp.inf and WINUSB.INF
Needs=WPD.MTP, WINUSB.NT                ; Run the CopyFiles & AddReg directives for wpdmtp.inf and WINUSB.INF

[MyDevice_Install.NT.hw]
Include = wpdmtp.inf
Needs   = WPD.MTP.Registration
AddReg  = MyDevice_AddReg

[MyDevice_Install.NT.Services]
AddService=WUDFRd,0x000001fa,WUDFRD_ServiceInstall  ; flag 0x2 sets this as the service for the device
AddService=WinUsb,0x000001f8,WinUsb_ServiceInstall  ; this service is installed because its a filter.

[MyDevice_Install.NT.CoInstallers]
CopyFiles=CoInstallers_CopyFiles
AddReg=CoInstallers_AddReg

[MyDevice_Install.NT.Wdf]
Include = wpdmtp.inf
Needs = WPD.MTP.Wdf
KmdfService=WINUSB, WinUsb_Install
UmdfService=umdffilter,umdffilter_Install
UmdfServiceOrder=umdffilter,WpdMtpDriver    ; upper filter

[WinUsb_Install]
KmdfLibraryVersion=1.11

[WpdMtpDriver_Install]
UmdfLibraryVersion=1.11.0 

[umdffilter_Install]
UmdfLibraryVersion=1.11.0 
ServiceBinary=%12%\UMDF\umdffilter.dll
DriverCLSID={8cec927c-219a-4777-baea-8626d6a0ce50}

[MyDevice_AddReg]
HKR,,"LowerFilters",0x00010008,"WinUsb" ; FLG_ADDREG_TYPE_MULTI_SZ | FLG_ADDREG_APPEND

[WUDFRD_ServiceInstall]
DisplayName = %WudfRdDisplayName%
ServiceType = 1
StartType = 3
ErrorControl = 1
ServiceBinary = %12%\WUDFRd.sys
LoadOrderGroup = Base

[WinUsb_ServiceInstall]
DisplayName     = %WinUsb_SvcDesc%
ServiceType     = 1
StartType       = 3
ErrorControl    = 1
ServiceBinary   = %12%\WinUSB.sys

[CoInstallers_CopyFiles]
WdfCoInstaller01011.dll
WudfUpdate_01011.dll
WinUsbCoinstaller2.dll

[CoInstallers_AddReg]
HKR,,CoInstallers32,0x00010000,"WudfUpdate_01011.dll", "WinUsbCoinstaller2.dll", "WdfCoInstaller01011.dll,WdfCoInstaller"

[DestinationDirs]
UMDriverCopy=12,UMDF        ; copy to drivers\umdf
CoInstallers_CopyFiles=11   ; copy to system32

[UMDriverCopy]
umdffilter.dll

; =================== Generic ==================================

[Strings]
ManufacturerName="Me"
ClassName="Samples" ; TODO: edit ClassName
DiskName = "umdffilter Installation Disk"
WinUsb_SvcDesc="WinUSB Driver"
WudfRdDisplayName="Windows Driver Foundation - User-mode Driver Framework Reflector"
DeviceName="umdffilter Device"` 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2014-03-19T06:41:15.067

@ore​​n671：您应该能够在 MTP 堆栈上安装 UMDF 过滤器驱动程序作为上层过滤器。我尝试使用上面共享的相同 inf，发现 inf 中定义的 WpdMtpDriver_Install 部分导致错误，因为它已包含在 wpdmtp.inf 'WPD.MTP.Wdf' 部分中（请参阅 DDInstall.Wdf 下的包含/需要）。

在 %SystemDrive%\Windows\setupact.log 中发现错误：“...错误读取部分 [WpdMtpDriver_Install] 键 UmdfLibraryVersion - 发现重复键...”请检查 SystemDrive%\Windows\Inf\setupapi.dev.log 和 %SystemDrive %\Windows\setupact.log 用于失败。

从上面的 inf 中删除“WpdMtpDriver_Install”部分，我能够在 MTP 堆栈上安装 UMDF 过滤器。

我已经修改了[示例](http://code.msdn.microsoft.com/windowshardware/umdffilterumdf-a0094c5e)inf 以使用 MTP Setup inf Directions[链接](http://msdn.microsoft.com/en-us/library/windows/hardware/ff597687%28v=vs.85%29.aspx)。带有 USB 传输的 MTP 使用 WPD（即 UMDF）和 WINUSB，因此在您的过滤器 inf 中包括来自 wpdmtp.inf 的相关部分（DDInstall、DDInstall.hw、DDInstall.Services、DDInstall.CoInstallers、DDInstall.Wdf）应该消除需要复制它们。

```
;
; WUDFOsrUsbFilterOnMTPDriver.inf - Install a UM Filter driver on an MTP device'
;

[Version]
Signature="$Windows NT$"
Class=WPD
ClassGuid={EEC5AD98-8080-425f-922A-DABF3DE3F69A}
Provider=%MSFTUMDF%
DriverVer=02/03/2014,18.8.52.851
CatalogFile=wudf.cat

[Manufacturer]
%MSFTUMDF%=Microsoft,NTamd64

[Microsoft.NTamd64]
%OsrUsbDeviceName%=OsrUsb_Install, USB\VID_04E8&PID_6860&MI_00
%OsrUsbDeviceName%=OsrUsb_Install, USB\VID_04E8&PID_6860

[SourceDisksFiles]
WudfOsrUsbFilter.dll=1

[SourceDisksNames]
1 = %MediaDescription%

; =================== UMDF OSR Filter Driver ==================================

[OsrUsb_Install.NT]
CopyFiles=UMDriverCopy
Include = wpdmtp.inf, WINUSB.INF
Needs   = WPD.MTP, WINUSB.NT

[OsrUsb_Install.NT.hw]
Include = wpdmtp.inf
Needs   = WPD.MTP.Registration

[OsrUsb_Install.NT.Services]
Include = wpdmtp.inf
Needs   = WPD.MTP.Services

[OsrUsb_Install.NT.Wdf]
Include = wpdmtp.inf
Needs = WPD.MTP.Wdf
UmdfService=WudfOsrUsbFilter, WudfOsrUsbFilter_Install
UmdfServiceOrder=WpdMtpDriver, WUDFOsrUsbFilter

[OsrUsb_Install.NT.CoInstallers]
Include = wpdmtp.inf
Needs = WPD.MTP.CoInstallers

[WudfOsrUsbFilter_Install]
UmdfLibraryVersion=1.11.0
DriverCLSID = "{422d8dbc-520d-4d7e-8f53-920e5c867e6c}"
ServiceBinary = "%12%\UMDF\WUDFOsrUsbFilter.dll"

[DestinationDirs]
UMDriverCopy=12,UMDF        ; copy to drivers\umdf

[UMDriverCopy]
WudfOsrUsbFilter.dll

; =================== Generic ==================================

[Strings]
MSFTUMDF="Microsoft Internal (WDF:UMDF)"
MediaDescription="Microsoft UMDF OSR USB Sample Device Installation Media"
OsrUsbDeviceName="Microsoft UMDF OSR Usb Sample Device With Filter on User-mode Driver" 
```

# javascript - 无法在 BlackBerry Cascades 中通过 https 加载 JSON 数据源

> ID：14359872
> 
> 赞同：1
> 
> 时间：2013-01-16T13:45:40.737
> 
> 标签：javascript, qml, blackberry-cascades

通过 https 加载我的 JSON 数据源似乎失败了。当我在 BlackBerry 10 设备上的浏览器中加载 url 时它可以工作，但当我尝试在 Qml 中使用该 url 时失败。

这是我的 DataSource 对象的样子：

```
DataSource {
    id: dsTitles
    source: ""
    type: DataSourceType.Json
    onDataLoaded: {
        if (Common.hasError(updateError, data, "Failed to load data. Please check your connection and try again.")) {
            console.log("Data contains error");
            navigationPane.pop();
            return;
        }
        loadedTitles = true;
        Code.loadDropDown(data, ddTitle, "title", "titleId")
        Code.hideLoadIndicator();
        if (updateProfile && ddTitle.selectedValue == null) {
            Code.setDropDownOptionByValue(ddTitle, profile.userTitleId);
        }
    }
    onError: {
        console.log("Failed to load titles: " + errorMessage);
    } 
```

任何 https JSON web 服务都可以用作此问题的示例。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-04-15T07:58:51.183

可以使用 XMLHttpRequest 从 JavaScript 加载数据。我创建了以下两个函数：

函数 loadJsonDataList(value, dataModel) { for (var i = 0; i < value.length; i ++) { dataModel.insert(value[i]); } 返回值；}

函数 loadData(url, onComplete) { var request = new XMLHttpRequest();

```
request.open("GET", url);
request.send();

request.onreadystatechange = function() {
    if (request.readyState === 4 && request.status === 200) {
        onComplete(JSON.parse(request.responseText));
    } else {

        onComplete(request.responseText);
    }
}; 
```

}

您可以按如下方式使用上述功能：

```
function getData2() 
{
    console.log("Get data called");
    Common.loadData("https://mywebservice/here/someFunction", getDataCallBack);
}

function getDataCallBack(dataObject) 
{
    console.log("Get data callback called");
    Common.loadJsonDataList(dataObject, lstViewItems.dataModel);
} 
```

目前，Qml DataSource 对象似乎无法加载 SSL Web 服务数据，但是可以如上所述手动加载它。如果他们最终修复它，或者如果另一个答案可以解释如何以这种方式使用 DataSource，我将尝试关注这个问题并更新答案。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2015-07-19T09:46:11.893

我终于在我的数据源中使用 https 解决了这个问题。通过显式声明`remote : true`.

这现在似乎解决了不加载安全 JSON 源的问题。

* * *

## 回答 #3

> 赞同：-2
> 
> 时间：2013-01-18T10:58:07.610

您不能对源使用 http 值，您需要实际下载 JSON 文件，然后将其传递给数据源。

blackberry 的“Weatherguesser”示例应用程序展示了如何从在线资源中获取数据并将其传递给您的 qml。

具体看一下 weathermodel.cpp 文件，该文件从 json 文件在线下载天气数据。

简而言之，您将需要一个 NetworkAccessManager，然后需要将一个 url 传递给它以进行下载。然后可以在 c++ 中管理结果，也可以将其直接传递给 qml。

# wpf - 在 Wpf 中正确绑定 DataTemplate 中的组合框

> ID：14359879
> 
> 赞同：2
> 
> 时间：2013-01-16T13:46:08.073
> 
> 标签：wpf, data-binding, combobox

我正在尝试将下面的 ComboBox 绑定到 ObservableCollection 中的字符列表，但它不会显示任何内容。任何想法为什么？

XAML：

```
 <TabControl ItemsSource ="{Binding TextEditors}"
     <TabControl.ContentTemplate>
      <DataTemplate>
       <ListBox> ItemsSource="{Binding TextLines}"
        <ListBox.ItemTemplate>
         <DataTemplate>
          <Grid>

               <ComboBox 
                   ItemsSource="{Binding DataContext.InvCharacter, RelativeSource={RelativeSource AncestorType={x:Type TabItem}}}" 
                   DisplayMemberPath="name" 
                   SelectedValuePath="cid" 
                   SelectedValue="{Binding cid}">
               </ComboBox>

          </Grid>
         </DataTemplate>
        </ListBox.ItemTemplate>
       </ListBox>
      </DataTemplate>
     </TabControl.ContentTemplate>
    </TabControl> 
```

这是我所指的课程：

```
 class TextEditorVM: IViewModel {
         public ObservableCollection<TextLineVM> TextLines { get { return textLines; } set { textLines = value;} }
         public ObservableCollection<T_Character> InvCharacters { get { return invCharacters; } set { invCharacters = value; } }

         public TextEditorVM(T_Dialogue dialogue)
         {

             DialogueManager.Instance.Register(this);
             this.TextLines = new ObservableCollection<TextLineVM>();
             this.InvCharacters = new ObservableCollection<T_Character>();
         }
    } 
```

和 MainVM：

```
 class MainVM : IViewModel
     {
           public ObservableCollection<TextEditorVM> TextEditors { get { return textEditors; } set { textEditors = value; OnPropertyChanged("TextEditors"); } 
     } 
```

我的 T_Character 类现在看起来像这样：

```
 public class T_Character
    {

       public String cid { get; set; }
       public String name { get; set; }

       public T_Character(String cid, String name)
       {
          this.cid = cid;
          this.name = name;
       }
    } 
```

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:01:27.593

的`DataContext`是`TabControl`类型`MainVM`。绑定的不应该是 ，`RelativeSource`而应该是。`ComboBox``TabControl``ListBox`

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T14:45:38.027

您的`InvCharacters`属性位于您的`TextEditorVM`对象上`ObservableCollection`，但您的绑定是引用的`TabControl.DataContext`，它是 `MainVM`，并且不包含该属性。

将您的 RelativeSource 绑定切换到引用`TabItem`（它在您绑定时自动创建`TabControl.ItemsSource`）或`ListBox`引用您的`TextEditorVM`对象

```
<ComboBox ItemsSource="{Binding DataContext.InvCharacters, 
              RelativeSource={RelativeSource AncestorType={x:Type TabItem}}}">
</ComboBox> 
```

# c# - 将频率转换为 -1..1 浮点数

> ID：14359881
> 
> 赞同：0
> 
> 时间：2013-01-16T13:46:16.700
> 
> 标签：c#, audio, xna, signal-processing

`SoundEffect`我正在尝试使用（C#）XNA 音频框架的类以给定的音高播放声音。到目前为止，我有这个（非常基本）

```
public void playSynth(SoundEffect se, int midiNote) {
    float pitch = (float)functions.getMIDIFreq(midiNote) / ((float)functions.getMIDIFreq(127)/2);
    pitch-=1F;
    Debug.WriteLine("Note: {0}. Float: {1}",midiNote,pitch);
    synth = se.CreateInstance();
    synth.IsLooped = false;
    synth.Pitch = pitch;
    synth.Play();
} 
```

目前，回放的音调非常偏离关键，因为数学是错误的。这个函数的工作方式是我向该函数发送一个 MIDI 音符（0 到 127），使用我制作的一个名为[getMIDIFreq](http://pastebin.com/KJg6vrgQ)的函数将该音符转换为频率 - 这很好。

要调用这个函数，我使用这个：

```
SoundEffect sound = SoundEffect.FromStream(TitleContainer.OpenStream(@"synth.wav"));
playSynth(sound,(int)midiNote);  //where midiNote is 0...127 number 
```

`synth.wav`我在 DAW 中创建并导出的简单 C 音符在哪里。这个程序的重点是播放合成器声音中给出的 MIDI 音符，但我很乐意接受正弦波或其他任何东西。我不能使用`Console.Beep`它，因为它非常慢，而且不适合快速连续播放带有音符的整首歌曲。

所以我的问题是，我怎样才能修复这段代码，以便它以正确的音高播放样本？我意识到我在这里只有 2 个八度音阶可以使用，所以如果有一种解决方案涉及在给定频率产生音调并且速度非常快，那就更好了。

谢谢！

编辑：我正在制作这个 WinForms 应用程序，而不是 XNA 游戏，但我已经下载并在我的项目中引用了框架。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T14:21:42.000

您不能应用任意频率。您只能将音高降低一个八度（半频）或提高一个八度（双频）。因此，要计算弯音值，首先需要知道样本的初始音高。

假设您的样本是`440 Hz` `A`，并且您想要`A`一个八度降低 ( `220 Hz`)。您需要的值为`-1`. `yourPitch / initiPitch = 0.5`到`2.0`. 你需要把它变成`-1`to的规模`+1`。我不能确切地告诉你如何，因为如果比例是对数的，文档并不清楚。您必须进行实验，但这应该可以帮助您入门。

# c# - 错误无法访问关闭文件

> ID：14359882
> 
> 赞同：0
> 
> 时间：2013-01-16T13:46:20.340
> 
> 标签：c#, xml

尝试使用 FileStream.BeginWrite() 方法写入 xml 文件，但它给了我一个**Can Not Access the Close File**错误

我的代码是

```
public void WriteXmlLog(string logType, string logFlag, string logModule, string logLocation, string logText, string logStackTrace)
{
    if (!File.Exists(_logFilePath))
    {
        File.WriteAllText(_logFilePath, "<?xml version='1.0' encoding='utf-8' standalone='yes'?>\r\n<AppXmlLogWritter></AppXmlLogWritter>");
    }

    XmlDocument xmlDoc = new XmlDocument();

    using (fileStream = new FileStream(_logFilePath, FileMode.OpenOrCreate, FileAccess.ReadWrite, FileShare.ReadWrite))
    {
        string currentDateTime = DateTime.Now.ToString("yyyyMMddHHmmss");
        xmlDoc.Load(fileStream);
        XmlElement newelement = xmlDoc.CreateElement("LogData");
        XmlElement xmlLogID = xmlDoc.CreateElement("LogID");
        XmlElement xmlLogDateTime = xmlDoc.CreateElement("LogDateTime");
        XmlElement xmlLogType = xmlDoc.CreateElement("LogType");
        XmlElement xmlLogFlag = xmlDoc.CreateElement("LogFlag");
        XmlElement xmlLogApplication = xmlDoc.CreateElement("LogApplication");
        XmlElement xmlLogModule = xmlDoc.CreateElement("LogModule");
        XmlElement xmlLogLocation = xmlDoc.CreateElement("LogLocation");
        XmlElement xmlLogText = xmlDoc.CreateElement("LogText");
        XmlElement xmlLogStackTrace = xmlDoc.CreateElement("LogStackTrace");

        xmlLogID.InnerText = _logIDPrefix + currentDateTime + randomNumber;
        xmlLogDateTime.InnerText = currentDateTime;
        xmlLogType.InnerText = ((LogTypes)Convert.ToInt32(logType)).ToString();
        xmlLogFlag.InnerText = logFlag;
        xmlLogApplication.InnerText = _logApplication;
        xmlLogModule.InnerText = logModule;
        xmlLogLocation.InnerText = logLocation;
        xmlLogText.InnerText = logText;
        xmlLogStackTrace.InnerText = logStackTrace;

        newelement.AppendChild(xmlLogID);
        newelement.AppendChild(xmlLogDateTime);
        newelement.AppendChild(xmlLogType);
        newelement.AppendChild(xmlLogFlag);
        newelement.AppendChild(xmlLogApplication);
        newelement.AppendChild(xmlLogModule);
        newelement.AppendChild(xmlLogLocation);
        newelement.AppendChild(xmlLogText);

        xmlDoc.DocumentElement.AppendChild(newelement);
        Byte[] myByteArray = Encoding.UTF8.GetBytes(newelement.ToString());
        fileStream.BeginWrite(myByteArray, 0, myByteArray.Length, WriteAsyncCallback, new LogWritter(myByteArray, fileStream));
    }

    xmlDoc.Save(_logFilePath);
}

public Stream MyStream { get; set; }

private void WriteAsyncCallback(IAsyncResult ar)
{
    LogWritter info = ar.AsyncState as LogWritter;
    info.MyStream.EndWrite(ar);
} 
```

**WriteAsyncCallback(IAsyncResult ar)**函数给了我上面的错误。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:50:10.927

您已经在语句中打开了流`using()`，但您在该语句中做的最后一件事是发出异步写入。好吧，一旦您发出异步写入，using 语句将终止并且您的文件将关闭，很可能在异步写入发生之前。不要在这里进行异步写入。除非您保持文件打开并在异步写入完成后有处理程序将其关闭，否则它不会为您带来任何好处。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:56:30.503

您通过在此行启动后台线程来让您的 using 语句超出范围：

```
fileStream.BeginWrite(myByteArray, 0, myByteArray.Length, WriteAsyncCallback, new LogWritter(myByteArray, fileStream)); 
```

如果您希望此函数是线程安全的，您可能需要考虑线程锁定 WriteXmlLog 方法。

# javascript - 如何仅使用正方形生成树状图

> ID：14359886
> 
> 赞同：7
> 
> 时间：2013-01-16T13:46:35.030
> 
> 标签：javascript, d3.js, treemap

我目前正在试验 d3.js 的图库树形图。

[http://bl.ocks.org/4063582](http://bl.ocks.org/4063582)

现在我想知道是否可以让树形图以正方形呈现所有项目。我只能让它渲染矩形。我尝试使用`.mode("squarify");`，但这不会导致所需的布局。它不会使用所有可用空间并不重要。我只是想让它渲染正方形。

* * *

## 回答 #1

> 赞同：9
> 
> 时间：2013-01-30T16:48:56.427

平方树形图：http : [//www.win.tue.nl/~vanwijk/stm.pdf](http://www.win.tue.nl/%7Evanwijk/stm.pdf)。它看起来像是对问题的彻底审视，并包含解决方案伪代码。

> **摘要**。介绍了树图方法的扩展，用于可视化分层信息，例如目录结构和组织结构。标准的树形图方法通常会给出细长的矩形。因此，矩形很难比较和选择。提出了一种新方法来生成矩形近似正方形的布局。为了加强结构的可视化，在相关节点组周围使用阴影框

* * *

## 其他资源

或者，您可以根据此处建议的数据创建自己的输出：[How to use jQuery to render a JSON tree as nested HTML using divs?](https://stackoverflow.com/questions/13347158/how-to-use-jquery-to-render-a-json-tree-as-nested-html-using-divs)

[平方算法的一些改进： http](http://incise.org/d3-binary-tree-treemap.html) ://incise.org/d3-binary-tree-treemap.html

[用于空间受限的层次结构可视化的](http://www.cs.umd.edu/hcil/treemap-history/)树形图显示了各种树形图算法的历史，其目标是将矩形比率降低到 1。您可能会发现一些论文很有帮助。

[此页面](http://eagereyes.org/techniques/treemaps)还提供了对各种树图算法的很好分解。

> 根据数据，矩形可能有非常不同的纵横比，这使得它们难以比较：面积相同的细长矩形与几乎正方形的矩形看起来非常不同。Bruls、Huizing 和 van Wijk 因此开发了*Squarified Treemaps*，它优化了关卡内节点的放置，使它们尽可能呈正方形。虽然使静态树图更具可读性是一个好主意，但当树图用于显示随时间推移的发展时，它会导致问题。 *由 Shneiderman 和 Wattenberg 开发的Ordered Treemap Layouts*解决了这个问题，它通过在保持节点尽可能正方形的同时保留元素的顺序，从而产生非常稳定的布局。

## 结论

[维基百科条目的简短阅读](http://en.wikipedia.org/wiki/Treemapping)很好地解释了为什么严格的方形树形图仍然难以实现。重点补充。

> 要创建树状图，必须定义一种平铺算法，即一种将矩形划分为指定区域的子矩形的方法。理想情况下，树形图算法将创建纵横比接近 1 的矩形，此外还保留输入数据中的某种顺序感，并进行更改以反映基础数据的变化。 **不幸的是，这些属性具有反比关系。随着纵横比的优化，放置顺序变得难以预测。随着顺序变得更加稳定，纵横比降低。**

在进一步研究了这个主题之后，我同意 Lars Kotthoff 的观点，即获得严格使用正方形的树状图并非易事。至少不是基于现有实现的树形图算法。解决这个问题的最简单方法可能是创建自己的代码（JS 和 CSS）来生成嵌套`div`的 s 或`li`s 以实现所需的最终树图外观。

## 附录

*   [http://www.koalastothemax.com/](http://www.koalastothemax.com/) - 这个演示呈现嵌套的圆圈，但很明显它们都位于正方形内。这可能需要一些工作，但您可能可以使用 Koalas to the Max 代码实现所需的结果。

    ![嵌套圈子](../Images/b02594b6c52d4675aa15a5b00baa3a52.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-31T23:01:47.213

不幸的是，由于数学原因，不可能让树形图以正方形呈现所有项目。

这里我只是给你一个反例。假设在处理结束时，您最终得到 4 个类别（A、B、C、D），其表面积如下。

```
A=2
B=2
C=2
D=1 
```

独立于你给他们的位置，不可能有一个正方形甚至矩形的最终树形图。

想一想：在以下每种模式中，您总是缺少一个角落

```
AB     AC    AD    BA    BC   BD   CA   CB   CD   DA  DB  DC 
CD     BD    BC    CD    AD   AC   BD   AD   AB   CB  AC  AB  ..there are more 
```

因为其中一个正方形的表面积 = 1。

**所以这不可能有所有的正方形**

从那篇[论文](http://www.win.tue.nl/~vanwijk/stm.pdf)中，正如[JSuar](https://stackoverflow.com/users/1085891/jsuar)所提到的，我们了解到您可以拥有一个优化的几乎平方表示，实现论文中描述的算法。

*但这是一个近似值。*

我认为，如果你真的只需要正方形，你所能做的就是：

1.  更改可视化，例如使用[http://bl.ocks.org/4063530](http://bl.ocks.org/4063530)
2.  破解修改第 12 行的 treemap.js 代码，如下所示

    比率 = 1;

但在后一种情况下，您可能会有一些空白或其他故障。

# iphone - 更改自动生成的 NavBar 的颜色？

> ID：14359896
> 
> 赞同：-1
> 
> 时间：2013-01-16T13:47:03.940
> 
> 标签：iphone, ios, objective-c, uinavigationbar, xcode4.5

因此，我创建了一个包含五个以上选项卡的选项卡栏应用程序，因此自动生成的导航栏变得栩栩如生。很公平，唯一的事情是，我想要一个黑色不透明的导航栏。以前看过有关此问题的问题，但那里的信息都没有帮助我。有人有完整的代码吗？在 .h 和 .m 文件中放什么？

我希望导航栏为黑色，“编辑”按钮为黑色，“完成”按钮为黑色，“后退”按钮为黑色，其他自动生成的导航栏也为黑色。如果我在这里要求太多，我很抱歉，但是关于特定主题的信息并不多。

提前，谢谢！

最好的问候，Øyvind Larsen Runestad。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T13:58:22.000

这就是您要寻找的房产：

```
@property(nonatomic, retain) UIColor *tintColor; 
```

至于改变物品的颜色，就是改变每个单品的颜色`UINavigationItem`。请参阅此问题以了解如何操作：

[更改 UINavigationItem 颜色](https://stackoverflow.com/questions/7314703/change-uinavigationitem-colour)

至于“在 .h 和 .m 文件中放什么？” 您应该在需要更改项目颜色时编写代码，所以说在加载视图时需要它，然后在 viewDidLoad 方法中执行，前提是您已经添加了导航栏。

# c# - 函数参数的“c like”按位或 API 切换

> ID：14359899
> 
> 赞同：0
> 
> 时间：2013-01-16T13:47:08.690
> 
> 标签：c#, api

在 c# 中为函数调用提供切换的最佳方式是什么？类似于它在 C/C++ 中的完成方式。我希望能够在不破坏 API 的情况下添加额外的切换。理想的解决方案需要最少的 LOC。

例如，在 C 中我们可以执行 FILE_OPEN | FILE_READONLY。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:50:33.793

你的意思是使用标志枚举？这是一个带有片段的小教程：http: [//www.dotnetperls.com/enum-flags](http://www.dotnetperls.com/enum-flags) 示例：

```
class Program
{

    [Flags]
    public enum MyFlags
    {
        Foo = 0x1,
        Bar = 0x2,
        Baz = 0x4
    }

    static void Main(string[] args)
    {
        MyFlags fooBar = MyFlags.Foo | MyFlags.Bar;

        if (fooBar.HasFlag(MyFlags.Foo))
            Console.WriteLine("Item has Foo flag set");
    }
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:50:47.750

虽然您可以使用标志枚举，但我个人发现使用按位运算符进行设置操作有点不干净。你可以使用`HashSet<MyEnum>`. 使用 将成员添加到集合中`Add`，并使用 测试成员资格`Contains`。

但它仍然在呼叫现场造成混乱。这是 C# 与许多其他语言相比较弱的一个领域。理想情况下，应该`set`在语言中内置一种类型，支持`in`操作员测试成员资格。

# python-2.7 - ttk Treeview 小部件不会激活水平滚动

> ID：14359906
> 
> 赞同：13
> 
> 时间：2013-01-16T13:47:42.473
> 
> 标签：python-2.7, treeview, tkinter, scrollbar, ttk

我正在使用 ttk Treeview 小部件来实现文件夹/路径选择对话框。除了我的水平滚动条不会激活之外，一切都按预期工作。无论文件夹路径水平有多宽，无论窗口多窄，水平滑块都不会出现。垂直滚动虽然工作得很好。

我认为当您仅在树视图中使用一列时，它要么是某种限制，要么只是配置和连接小部件的新手错误。我赌的是后者。

对话框加宽以显示完整文件夹深度的示例：

![全屏宽度](../Images/c70efa3a4f06a31d447de0dcd3d17e93.png)

对话框缩小到水平滚动应该激活（但没有）的点：

![窄幅](../Images/547236066d64f7be131ecb8f1cb65c88.png)

这是我的 GUI 布局代码：

```
winDirSel = tk.Toplevel()
winDirSel.title('Select Test Directory...')
tvwDirSel = ttk.Treeview(winDirSel,
                         height=10,padding=3,
                         show='tree')
lblTestDir = tk.Label(winDirSel, relief=tk.SUNKEN,
                      justify=tk.LEFT, anchor=tk.W,
                      textvariable=ctrlTestDir,width=80)
scbHDirSel = ttk.Scrollbar(winDirSel,
                           orient=tk.HORIZONTAL,
                           command=tvwDirSel.xview)
scbVDirSel = ttk.Scrollbar(winDirSel,
                           orient=tk.VERTICAL,
                           command=tvwDirSel.yview)
tvwDirSel.configure(xscrollcommand=scbHDirSel.set,
                    yscrollcommand=scbVDirSel.set)
lblTestDir.grid(row=0,column=0,sticky=tk.EW)
tvwDirSel.grid(row=1,column=0,sticky=tk.NSEW)
scbVDirSel.grid(row=1,column=1,sticky=tk.NS)
scbHDirSel.grid(row=2,column=0,sticky=tk.EW)
winDirSel.rowconfigure(1,weight=1)
winDirSel.columnconfigure(0,weight=1) 
```

* * *

## 回答 #1

> 赞同：13
> 
> 时间：2013-01-18T16:37:09.093

好的，在玩了一些`minwidth`and之后`stretch`，我想我对它有了更好的处理。水平滚动是由超出窗口边界的**列边缘触发的，而不是由列的内容触发。**因此，您可以使用这些参数来强制列更宽，从而强制滚动。

但问题是您会失去自动调整列宽以适应树本身的宽度。您要么必须强制它非常宽以适应任何（假设的）可能的文件夹深度，要么您需要在列的右边界处截断文件夹名称。

所以底线：这只是小部件本身的限制。（至少就它在我的平台 MS Windows 上的行为而言。）

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2018-03-07T21:54:22.657

这是我最终想出的显示一个`TreeView`延迟加载的文件（感谢[this answer](https://stackoverflow.com/a/16748186/253127)），它位于`PanedWindow`（WxPython术语中的SplitterWindow）以及`Notebook`. 由于[这个例子](http://svn.python.org/projects/stackless/trunk/Demo/tkinter/ttk/dirbrowser.py)，滚动条会根据需要自动显示/隐藏。

```
import os
import Tkinter as tk
import ttk as ttk
from ScrolledText import ScrolledText

class App(object):
    def __init__(self, master, path):
        splitter = tk.PanedWindow(master, orient=tk.HORIZONTAL)
        # left-side
        frame_left = tk.Frame(splitter)
        self.tree = ttk.Treeview(frame_left, show='tree')
        ysb = ttk.Scrollbar(frame_left, orient='vertical', command=self.tree.yview)
        xsb = ttk.Scrollbar(frame_left, orient='horizontal', command=self.tree.xview)
        # right-side
        frame_right = tk.Frame(splitter)
        nb = ttk.Notebook(frame_right)
        page1 = ttk.Frame(nb)
        page2 = ttk.Frame(nb)
        text = ScrolledText(page2)

        # overall layout
        splitter.add(frame_left)
        splitter.add(frame_right)
        splitter.pack(fill=tk.BOTH, expand=1)
        # left-side widget layout
        self.tree.grid(row=0, column=0, sticky='NSEW')
        ysb.grid(row=0, column=1, sticky='ns')
        xsb.grid(row=1, column=0, sticky='ew')
        # left-side frame's grid config
        frame_left.columnconfigure(0, weight=1)
        frame_left.rowconfigure(0, weight=1)
        # right-side widget layout
        text.pack(expand=1, fill="both")
        nb.add(page1, text='One')
        nb.add(page2, text='Two')
        nb.pack(expand=1, fill="both")

        # setup
        self.tree.configure(yscrollcommand=lambda f, l:self.autoscroll(ysb,f,l), xscrollcommand=lambda f, l:self.autoscroll(xsb,f,l))
        # use this line instead of the previous, if you want the scroll bars to always be present, but grey-out when uneeded instead of disappearing
        #self.tree.configure(yscrollcommand=ysb.set, xscrollcommand=xsb.set)
        self.tree.heading('#0', text='Project tree', anchor='w')
        self.tree.column("#0",minwidth=1080, stretch=True)
        # add default tree node
        abspath = os.path.abspath(path)
        self.nodes = dict()
        self.insert_node('', abspath, abspath)
        self.tree.bind('<<TreeviewOpen>>', self.open_node)

    def autoscroll(self, sbar, first, last):
        """Hide and show scrollbar as needed."""
        first, last = float(first), float(last)
        if first <= 0 and last >= 1:
            sbar.grid_remove()
        else:
            sbar.grid()
        sbar.set(first, last)

    def insert_node(self, parent, text, abspath):
        node = self.tree.insert(parent, 'end', text=text, open=False)
        if os.path.isdir(abspath):
            self.nodes[node] = abspath
            self.tree.insert(node, 'end')

    def open_node(self, event):
        node = self.tree.focus()
        abspath = self.nodes.pop(node, None)
        if abspath:
            self.tree.delete(self.tree.get_children(node))
            for p in os.listdir(abspath):
                self.insert_node(node, p, os.path.join(abspath, p))

if __name__ == '__main__':
    root = tk.Tk()
    root.geometry("800x600")
    app = App(root, path='.')
    root.mainloop() 
```

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2017-04-15T19:45:05.760

```
import tkinter as tk
import tkinter.ttk as ttk
import tkinter.font as tk_font

class TreeListBox:

    def __init__(self, master, root, dict_group):
        self.master = master
        self.root = root
        self.dict_group = dict_group
        self.level = 0
        self.setup_widget_tree()
        self.build_tree(self.root, '')

    def setup_widget_tree(self):
        container_tree = tk.Frame(self.master, width=250, height=300)
        container_tree.propagate(False)
        container_tree.pack(side="left", fill='y')
        self.tree = ttk.Treeview(container_tree, show="tree", selectmode='browse')
        fr_y = tk.Frame(container_tree)
        fr_y.pack(side='right', fill='y')
        tk.Label(fr_y, borderwidth=1, relief='raised', font="Arial 8").pack(side='bottom', fill='x')
        sb_y = tk.Scrollbar(fr_y, orient="vertical", command=self.tree.yview)
        sb_y.pack(expand='yes', fill='y')
        fr_x = tk.Frame(container_tree)
        fr_x.pack(side='bottom', fill='x')
        sb_x = tk.Scrollbar(fr_x, orient="horizontal", command=self.tree.xview)
        sb_x.pack(expand='yes', fill='x')
        self.tree.configure(yscrollcommand=sb_y.set, xscrollcommand=sb_x.set)
        self.tree.pack(fill='both', expand='yes')

    def build_tree(self, parent, id_stroki):
        self.level += 1
        id = self.tree.insert(id_stroki, 'end', text=parent)
        # -----------------
        col_w = tk_font.Font().measure(parent)
        if col_w > 1000:
            col_w -= 400
        elif col_w > 500:
            col_w -= 200
        elif col_w > 300:
            col_w -= 100
        col_w = col_w + 25 * self.level
        if col_w > self.tree.column('#0', 'width'):
            self.tree.column('#0', width=col_w)
        # -----------------
        for element in sorted(self.dict_group[parent]):
            self.build_tree(element, id)
        self.level -= 1

if __name__ == '__main__':
    dict_group = {'Nomenclature': ['ABC1', 'ABC2'],
                  'ABC1': ['ABC3', 'ABC4'],
                  'ABC2': ['ABC5'],
                  'ABC3': ['ABC______________________________________6'],
                  'ABC4': ['ABC--------------------------------------8'],
                  'ABC5': ['ABC######################################9'],
                  'ABC______________________________________6': [],
                  'ABC--------------------------------------8': [],
                  'ABC######################################9': []
                  }
    root = tk.Tk()
    myTest = TreeListBox(root, 'Nomenclature', dict_group)
    root.mainloop() 
```

# javascript - 如何获取 img 标签的值？

> ID：14359913
> 
> 赞同：0
> 
> 时间：2013-01-16T13:48:05.280
> 
> 标签：javascript

我怎样才能得到img标签的价值？？？在 img 标签中，我们有一个名为“Value”的属性，所以我想知道如何在 javascript 中访问这个 value 属性？？？我使用这段代码：

```
function addcart()
    {
        $cartvalue=confirm("Would You like to add This Product to Your Cart?"); 
        if($cartvalue)
        {
            var product=document.getElementById('prod1').value;
            alert(product);

        }
    } 
```

这里 prod1 是 img 标签的值，但它在警报中显示为 undefine

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:49:54.763

尝试类似的东西

```
var product=document.getElementById('prod1').getAttribute('value'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:51:53.437

嗯..我可能会离开这里，但你不是在寻找`src`属性吗？我认为这不是标签`value`的有效属性......`<img>`

```
var product=document.getElementById('prod1').src; 
```

正如我所看到的，图像的“价值”将是图像本身的路径。它位于`src`属性中。

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T13:51:42.217

AFAIK img-tag 通常没有属性值：[http ://www.w3schools.com/tags/tag_img.asp](http://www.w3schools.com/tags/tag_img.asp)

但是迈克尔的解决方案应该有效。

或者，您可以使用 jQuery 进行尝试：

```
var product=$('#prod1').attr('value'); 
```

# php - FPDF - 生成的 PDF 无法在浏览器中正确显示

> ID：14359914
> 
> 赞同：3
> 
> 时间：2013-01-16T13:48:08.817
> 
> 标签：php, firefox, pdf, fpdf

我正在使用**FPDF**库生成 PDF 文档。我正在尝试在浏览器（*Firefox、Chrome、Opera*）中显示生成的文档，但我得到的只是奇怪的字符，开头为：

```
%PDF-1.3 3 0 obj <>... 
```

这是我的代码。我正在尝试将两个图像添加到文档中。

```
$pdf = new FPDF();
$pdf->AliasNbPages();
$pdf->AddPage();
$pdf->Image('./image.png',10,10,0,0,'png');
$pdf->Image('./image.png',10,120,0,0,'png');
$pdf->Output('file.pdf','I'); 
```

如果我使用带有“D”选项的输出：

```
$pdf->Output('file.pdf','D'); 
```

并将文件保存在光盘上，pdf文档就可以了。

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T13:57:05.900

您可能需要添加正确的内容类型标头。当 web 服务器提供一个文件时，它会尝试提供它从文件中猜测的正确的内容类型标头，但是在这里，当您使用 PHP 生成它时，将发送默认标头，通常是 text/html。尝试将此添加到代码的开头：

```
header('Content-type: application/pdf'); 
```

它应该使用正确的内容类型标头发送。

* * *

## 回答 #2

> 赞同：7
> 
> 时间：2016-09-02T06:40:23.580

我遇到了同样的问题，我`ob_get_clean();`之前添加`$pdf->OutPut()`了，我得到了正确的结果。

这是因为标题不正确，但即使我在输出pdf之前设置了标题，它仍然不正确。

* * *

## 回答 #3

> 赞同：3
> 
> 时间：2014-05-18T23:44:35.447

将 D 更改为 I

```
$pdf->Output('file.pdf','I'); 
```

将文件内联发送到浏览器。如果可用，则使用该插件。当在生成 PDF 的链接上选择“另存为”选项时，将使用 name 给出的名称。

从那里文档 [fpdf 文档](http://www.fpdf.org/en/doc/output.htm)

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2018-10-23T06:53:51.800

添加退出如下：

```
$pdf->Output();
exit; 
```

[参考](https://expressionengine.com/forums/archive/topic/188158/pdf-and-http-headers)

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2019-07-14T12:10:26.990

尝试：

```
ob_start (); //used before output.
$pdf->Output();
?> 
```

* * *

## 回答 #6

> 赞同：0
> 
> 时间：2020-08-18T09:51:37.647

我不知道我是否应该把它作为评论或答案，我在我的本地主机上遇到了同样的问题，但是一旦我将我的代码放在实时服务器上，问题就会自动解决。尝试清除本地系统上的所有 cookie，它也可能会有所帮助。

* * *

## 回答 #7

> 赞同：0
> 
> 时间：2020-11-19T08:45:58.663

我已经使用不同的顺序应用了上述所有选项，这就是它最终的工作方式。谢谢

```
$str = iconv('UTF-8', 'windows-1252', $custom_data);
$final = html_entity_decode($str ,ENT_QUOTES, 'windows-1252');
$pdf = new FPDF();
header('Content-type: application/pdf');
$pdf->AddPage();
$pdf->SetFont('Courier','',16);
$pdf->MultiCell(190, '10', $final, '', 'L');
ob_get_clean();
$pdf->Output($afterDash.".pdf", "I");
exit; 
```

# c++ - 双循环到单循环

> ID：14359915
> 
> 赞同：-2
> 
> 时间：2013-01-16T13:48:12.640
> 
> 标签：c++, loops

**更新** 这是一个基本的编程疑问，我刚开始学习 c 和 c++ 我有两个循环，即

```
if (n==null)
{

do loop 1

}
else //(n!=null)
{

do loop2

} 
```

现在我必须更新上面的代码，用一个循环，即当`n==null`或`n!=null`单独执行循环 1

我该如何更新。？

我可以这样做吗

```
while(n==null || n!=null)
{

do loop 1

} 
```

上面的`||`操作员是否完成了我所期望的工作？

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:03:40.057

注意

```
while(n==null || n!=null)
{
    do loop1
} 
```

是一个无限循环，因为`n==null || n!=null`它**总是 true**。

大概你的意思

```
if(n==null || n!=null)
{
    do loop1
} 
```

对于上述言论，这很简单

```
do loop1 
```

无论如何，我建议您看一下[真值表](http://en.wikipedia.org/wiki/Truth_table)。

# node.js - Nodejs 提供 1 个 api 端点 e 一个 html 页面

> ID：14359922
> 
> 赞同：4
> 
> 时间：2013-01-16T13:48:26.810
> 
> 标签：node.js

这是我的问题。我从来没有在不使用 express 的情况下在 node 中写过东西，所以我发现很难用基本的 API 创建一个服务器。

基本上我在网上找到的是这样的：

```
var http = require('http');
http.createServer(function (req, res) {
  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hello World\n');
}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

但是我看不到如何实现 /index.html 和 /getData。这段代码将在树莓派上运行，这就是我不应该使用库的原因。基本上我没有太多空间。

非常感谢，h

* * *

## 回答 #1

> 赞同：12
> 
> 时间：2013-01-16T13:58:18.693

您需要手动检查请求中的 URL 并单独处理每种情况：

```
var http = require('http');
http.createServer(function (req, res) {

  if(req.url == "/index.html") {
     fs.readFile("index.html", function(err, text){
       res.setHeader("Content-Type", "text/html");
       res.end(text);
     });
     return;
  }

  if(req.url == "/getData") {
    res.writeHead(200, {'Content-Type': 'text/plain'});
    res.end('get data\n');
    return;
  }

  res.writeHead(200, {'Content-Type': 'text/plain'});
  res.end('Hello World\n');

}).listen(1337, '127.0.0.1');
console.log('Server running at http://127.0.0.1:1337/'); 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T14:20:51.653

仅仅因为代码在 Pi 上运行并不意味着您不能使用模块。模块不一定占用过多的空间。您仍然必须编写许多模块为您编写的相同代码。像 Express 这样的模块专门用于解决您面临的实现问题，因此您必须重写路由器来处理对`/getData`HTML 等静态资产的请求或文件阅读器。无论您是否使用模块，您最终都会得到大致相同数量的代码。

与其重新创建轮子，也许您只需要去掉不需要的功能的更纤薄的模块。Express 所基于的[Connect相当少。](http://www.senchalabs.org/connect/)使用 Express 或 Connect，您可以删除不需要的内容。请记住，模块只是`node_modules`项目根目录中的子目录，因此您可以删除无关的内容，例如测试、示例和（在某些情况下）不需要的功能。

或者，还有许多更精简的模块，例如[send](https://github.com/visionmedia/send)，它们纯粹用于提供静态内容，例如您的索引页面。[Journey](https://github.com/cloudhead/journey)仅提供 JSON，也是一个精简的功能集。关键是如果 Express 太大，有大量模块可以满足特定需求。[节点模块](https://github.com/joyent/node/wiki/modules)列表是查找此类模块的良好起点。在不使用模块的情况下使用 node 有点像回到 node 的早期，当时这些问题困扰着每个人。当然你可以这样做，但它已经完成了。

# json - 将嵌套的 json 解析为骨干集合

> ID：14359925
> 
> 赞同：5
> 
> 时间：2013-01-16T13:48:51.223
> 
> 标签：json, backbone.js, nested, backbone.js-collections

我刚刚开始，`Backbone`我遇到了问题。我有一个很好的宁静设置。对于我的大部分`GET`请求，我收到一个模型集合，但对于一个模型，我正在加载嵌套关系数据，这会创建嵌套`JSON`的 .

在`Backbone`我有以下内容`Models`：

```
App.Models.Sequence = Backbone.Model.extend({});
App.Models.Layer = Backbone.Model.extend({});
App.Models.Item = Backbone.Model.extend({}); 
```

和这些收藏

```
App.Collections.Sequences = Backbone.Collection.extend({
  model: App.Models.Sequence,
  url: '/api/sequences/'
});

App.Collections.Layers = Backbone.Collection.extend({
  model: App.Models.Layer,
  url: '/api/layers'
});

App.Collections.Items = Backbone.Collection.extend({
  model: App.Models.Item,
  url: '/api/items'
}); 
```

我将数据加载为`JSON`：

```
[
              {
                "id": "1",
                "project_id": "8",
                "name": "Seq1",
                "layers": [
                  {
                    "id": "1",
                    "name": "Layer11",
                    "sequence_id": "1",
                    "items": [
                      {
                        "id": "1000000",
                        "layer_id": "1",
                        "itemtype_id": "1",
                        "position": "0"
                      },
                      {
                        "id": "1000001",
                        "layer_id": "1",
                        "itemtype_id": "2",
                        "position": "0"
                      },
                      {
                        "id": "1000002",
                        "layer_id": "1",
                        "itemtype_id": "2",
                        "position": "0"
                      },
                      {
                        "id": "1000003",
                        "layer_id": "1",
                        "itemtype_id": "4",
                        "position": "0"
                      }
                    ]
                  },
                  {
                    "id": "2",
                    "name": "Layer12",
                    "sequence_id": "1",
                    "items": [
                      {
                        "id": "1000004",
                        "layer_id": "2",
                        "itemtype_id": "1",
                        "position": "0"
                      },
                      {
                        "id": "1000005",
                        "layer_id": "2",
                        "itemtype_id": "2",
                        "position": "0"
                      },
                      {
                        "id": "1000006",
                        "layer_id": "2",
                        "itemtype_id": "3",
                        "position": "0"
                      },
                      {
                        "id": "1000007",
                        "layer_id": "2",
                        "itemtype_id": "4",
                        "position": "0"
                      }
                    ]
                  },
                  {
                    "id": "3",
                    "name": "Layer13",
                    "sequence_id": "1",
                    "items": [
                      {
                        "id": "1000008",
                        "layer_id": "3",
                        "itemtype_id": "1",
                        "position": "0"
                      },
                      {
                        "id": "1000009",
                        "layer_id": "3",
                        "itemtype_id": "4",
                        "position": "0"
                      },
                      {
                        "id": "1000010",
                        "layer_id": "3",
                        "itemtype_id": "5",
                        "position": "0"
                      }
                    ]
                  }
                ]
              },
              {
                "id": "2",
                "project_id": "8",
                "name": "Seq2",
                "layers": [
                  {
                    "id": "4",
                    "name": "Layer21",
                    "sequence_id": "2",
                    "items": []
                  },
                  {
                    "id": "5",
                    "name": "Layer22",
                    "sequence_id": "2",
                    "items": []
                  }
                ]
              },
              {
                "id": "3",
                "project_id": "8",
                "name": "Seq3",
                "layers": [
                  {
                    "id": "6",
                    "name": "Layer31",
                    "sequence_id": "3",
                    "items": []
                  },
                  {
                    "id": "7",
                    "name": "Layer32",
                    "sequence_id": "3",
                    "items": []
                  }
                ]
              }
            ] 
```

我怎样才能获得`Sequences`,`Layers`并`Items`进入我的收藏？

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T14:14:27.867

您可以使用下划线的组合[`flatten`](http://underscorejs.org/#flatten)并[`pluck`](http://underscorejs.org/#pluck)巧妙地做到这一点：

```
var data = { /* your JSON data */ };
var allSequences = _.clone(data);
var allLayers = _.flatten(_.pluck(allSequences, 'layers'));
var allItems = _.flatten(_.pluck(allLayers, 'items'));

var sequences = new App.Collections.Sequences(allSequences);
var layers = new App.Collections.Layers(allLayers);
var items = new App.Collections.Items(allItems); 
```

如果您不希望序列和层包含它们的子对象，请覆盖[`Model.parse`](http://backbonejs.org/#Model-parse)以修剪它们。例如：

```
App.Models.Sequence = Backbone.Model.extend({
    parse: function(attrs) {
      delete attrs.layers;
      return attrs;
    }
}); 
```

并使用以下选项初始化/添加集合`parse:true`：

```
var sequences = new App.Collections.Sequences(allSequences, {parse:true}); 
```

等等。

# php - 从 PHP 发送 HTTP 请求而不等待响应？

> ID：14359926
> 
> 赞同：48
> 
> 时间：2013-01-16T13:48:53.390
> 
> 标签：php, http, curl, server-side, web-analytics

我想从 PHP 发送一个 HTTP GET 请求。例子：

```
http://tracker.example.com?product_number=5230&price=123.52 
```

这个想法是做服务器端的网络分析：服务器不是将跟踪信息从 JavaScript 发送到服务器，而是将跟踪信息直接发送到另一台服务器。

要求：

*   请求应该花费尽可能少的时间，以便不会明显延迟 PHP 页面的处理。

*   `tracker.example.com`不需要检查来自的响应。例如，一些可能的回应来自 `tracker.example.com`：

    *   *200：*那很好 但不需要检查

    *   *404：*运气不好，但是 - 再次 - 不需要检查。

    *   *301：*虽然重定向是合适的，但它会延迟 PHP 页面的处理，所以不要这样做。

    简而言之：可以丢弃*所有响应。*

解决方案的想法：

*   在一个现已删除的答案中，有人建议 在 shell 进程中从 PHP调用命令行[curl 。](http://en.wikipedia.org/wiki/CURL)这似乎是个好主意，只是我不知道在重负载下分叉很多 shell 进程是否是明智之举。

*   我找到了[php-ga](http://code.google.com/p/php-ga/)，一个用于从 PHP 执行服务器端 Google Analytics 的包。在项目页面上，提到：*“可以配置为 [...] 使用非阻塞请求。”* 到目前为止我还没有时间研究php-ga内部使用什么方法，但是这个方法可能就是它！

简而言之：从 PHP 进行通用服务器端跟踪/分析的最佳解决方案是什么。

* * *

## 回答 #1

> 赞同：35
> 
> 时间：2013-02-03T02:03:10.247

不幸的是，PHP 根据定义是**阻塞**的。虽然这适用于您通常要处理的大多数功能和操作，但当前情况有所不同。

我喜欢称之为[HTTP-Ping](http://www.coretechnologies.com/products/http-ping/)的过程要求您只*触摸*一个特定的 URI，强制特定的服务器引导它的内部逻辑。某些功能允许您通过不等待响应来实现与此*HTTP-ping*非常相似的功能。

请注意，*ping* url 的过程是一个两步过程：

1.  解析 DNS
2.  提出请求

虽然在解析 DNS 并建立连接后发出请求应该相当快，但没有很多方法可以使 DNS 解析得更快。

进行 http-ping 的一些方法是：

1.  [cURL](http://www.php.net/manual/en/ref.curl.php)，通过将 CONNECTION_TIMEOUT 设置为低值
2.  [fsockopen](http://php.net/manual/en/function.fsockopen.php)写入后立即关闭
3.  [stream_socket_client](http://php.net/manual/en/function.stream-socket-client.php)（与 fsockopen 相同）并添加`STREAM_CLIENT_ASYNC_CONNECT`

在解析 DNS 时，两者都阻塞`cURL`。`fsockopen`我注意到*fsockopen*明显更快，即使在最坏的情况下也是如此。

`stream_socket_client`另一方面，应该解决有关 DNS 解析的问题，并且应该是这种情况下的最佳解决方案，但我还没有设法让它工作。

一个最终的解决方案是启动另一个为您执行此操作的线程/进程。对此进行系统调用应该可以工作，但[分叉](http://php.net/manual/en/function.pcntl-fork.php)当前进程也应该这样做。不幸的是，在您无法控制 PHP 运行环境的应用程序中，两者都不是真正安全的。

系统调用经常被阻止，默认情况下不启用 pcntl。

* * *

## 回答 #2

> 赞同：18
> 
> 时间：2014-02-07T16:19:40.050

我会这样调用tracker.example.com：

```
get_headers('http://tracker.example.com?product_number=5230&price=123.52'); 
```

并在跟踪器脚本中：

```
ob_end_clean();
ignore_user_abort(true);
ob_start();
header("Connection: close");
header("Content-Length: " . ob_get_length());
ob_end_flush();
flush();

// from here the response has been sent. you can now wait as long as you want and do some tracking stuff 

sleep(5); //wait 5 seconds
do_some_stuff();
exit; 
```

* * *

## 回答 #3

> 赞同：12
> 
> 时间：2016-08-02T19:42:06.380

我实现了快速 GET 请求到 url 的功能，而无需等待响应：

```
function fast_request($url)
{
    $parts=parse_url($url);
    $fp = fsockopen($parts['host'],isset($parts['port'])?$parts['port']:80,$errno, $errstr, 30);
    $out = "GET ".$parts['path']." HTTP/1.1\r\n";
    $out.= "Host: ".$parts['host']."\r\n";
    $out.= "Content-Length: 0"."\r\n";
    $out.= "Connection: Close\r\n\r\n";

    fwrite($fp, $out);
    fclose($fp);
} 
```

* * *

## 回答 #4

> 赞同：4
> 
> 时间：2020-07-15T16:27:36.940

我们正在使用`fsockopen`和`fwrite`组合，然后有一天它停止工作。或者它是一种间歇性的。经过一些研究和测试，如果你启用了 fopen 包装器，我最终使用`file_get_contents`和`stream_context_create`函数，超时设置为 100 秒。timeout 参数可以接收浮动值（[https://www.php.net/manual/en/context.http.php](https://www.php.net/manual/en/context.http.php)）。我将它包装在一个 try...catch 块中，这样它就会默默地失败。它非常适合我们的目的。如果需要，您可以在 catch 中记录内容。如果您不希望函数阻塞运行时，超时是关键。

```
function fetchWithoutResponseURL( $url )
{

    $context = stream_context_create([
        "http" => [
            "method"=>"GET",
            "timeout" => .01
            ]
        ]
    );

    try {
        file_get_contents($url, 0, $context);
    }catch( Exception $e ){
        // Fail silently
    }
} 
```

* * *

## 回答 #5

> 赞同：3
> 
> 时间：2013-01-16T13:54:23.670

您可以使用`shell_exec`, 和命令行 curl。

例如，请参阅[此问题](https://stackoverflow.com/questions/1019867/is-there-a-way-to-use-shell-exec-without-waiting-for-the-command-to-complete)

* * *

## 回答 #6

> 赞同：2
> 
> 时间：2013-07-04T00:25:11.137

在研究类似问题时来到这里。如果您有一个方便的数据库连接，另一种可能性是将请求详细信息快速填充到一个表中，然后有一个单独的基于 cron 的进程定期扫描该表以查找要处理的新记录，并发出跟踪请求，从而释放您的 Web 应用程序不必自己发出 HTTP 请求。

* * *

## 回答 #7

> 赞同：1
> 
> 时间：2020-03-03T07:08:50.283

对于那些使用 wordrpess 作为后端的人来说——它很简单：

`wp_remote_get( $url, array(blocking=>false) );`

* * *

## 回答 #8

> 赞同：-1
> 
> 时间：2013-01-16T15:34:09.037

您实际上可以`CURL`直接使用。

我都使用非常短的超时 ( `CURLOPT_TIMEOUT_MS`) 和/或使用`curl_multi_exec`.

请注意：最终我退出了此方法，因为并非每个请求都正确发出。这可能是由我自己的服务器引起的，尽管我无法排除 curl 失败的选项。

* * *

## 回答 #9

> 赞同：-1
> 
> 时间：2015-09-19T18:36:11.820

```
<?php
// Create a stream
$opts = array(
  'http'=>array(
    'method'=>"GET",
    'header'=>"Accept-language: en" 
  )
);

 $context = stream_context_create($opts);

// Open the file using the HTTP headers set above
$file = file_get_contents('http://tracker.example.com?product_number=5230&price=123.52', false, $context);
?> 
```

* * *

## 回答 #10

> 赞同：-1
> 
> 时间：2018-04-08T05:11:36.340

我需要做类似的事情，只需 ping 一个 url 并丢弃所有响应。我使用了 proc_open 命令，它可以让您使用 proc_close 立即结束进程。我假设你的服务器上安装了 lynx：

```
<?php    
function ping($url) {
      $proc = proc_open("lynx $url",[],$pipes);
      proc_close($proc);
    }
?> 
```

# c# - 使用 Azure 的 Windows 8 和 Windows Phone 推送通知

> ID：14359927
> 
> 赞同：0
> 
> 时间：2013-01-16T13:48:58.803
> 
> 标签：c#, .net, azure, windows-8, windows-phone-8

我研究了 Azure 移动服务，发现它很棒，但没有给我想要的灵活性（Node.js 也让我对 C# 产生了不好的印象）。

我在 Windows 8 中使用定期更新通知，并且已经有一个 ASP.NET Web API 项目提供平铺图像和平铺 xml 内容。我希望将 Azure Worker Role 与 Azure 存储表一起用于 Windows 8 和 Windows Phone 的推送通知。

我找到了这个例子，但它似乎是针对 VS2012 Release Preview 的。我找不到更新版本或任何其他可使用的示例。特别是我希望我的服务同时支持 Windows 8 和 Windows Phone。

[http://watwindows8.codeplex.com/wikipage?title=Push%20Notification%20Worker%20Sample](http://watwindows8.codeplex.com/wikipage?title=Push%20Notification%20Worker%20Sample)

如果有人可以概述我需要的参考/nuget 包。这将是一个很大的帮助。

**编辑：**

Jim O'Neil 的博客是一个很好的起点。我需要使用 Azure Worker Role，因为我想定期发送通知。

我还找到了用于从服务器发送推送通知的 WnsRecipe NuGet 包。Jim O'Neil 的解决方案同样出色。

最后，为了节省一点时间，我希望避免编写用于将应用程序通道 ID 注册到服务器上的表的数据访问代码。Azure 移动服务 MobileServiceClient 类是一个很好的解决方案，因为它允许您使用几行代码完成所有这些工作。该表可通过 REST 服务获得。然而，问题仍然存在：

1.  我可以继续将移动服务表存储 MobileServiceClient 与我的应用程序和 Azure 工作者角色一起使用，还是必须使用 Azure 表存储？
2.  如果我可以使用 MobileServiceClient，我如何从我的 Azure 辅助角色访问表？
3.  如果我必须使用同样免费提供 REST 服务的 Azure 表存储，我如何从我的 Windows 8 应用程序访问该表？

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T18:09:02.257

当您使用 MobileServiceClient 在移动服务中存储数据时，您实际上是将数据存储在 SQL Azure 数据库中。从您的工作角色访问这些数据时，您有多种选择。

*   使用 SQL 客户端直接连接。这可能是实体框架、不同的 ORM，甚至是原始 ADO.NET。您可以通过在 Azure 门户中选择它来获取数据库的连接字符串。在仪表板选项卡上有一个显示连接字符串的选项。
*   使用客户端库通过移动服务访问数据。不幸的是，我们还没有可以从工作角色使用的官方 SDK，但好消息是NuGet 上有一个非官方的[包](http://nuget.org/packages/Heyns.ZumoClient)
*   通过移动服务通过发出 HTTP 请求提供的 HTTP 端点直接访问数据。API 记录[在这里](http://msdn.microsoft.com/en-us/library/windowsazure/jj710108.aspx)。

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-02-14T22:05:30.110

Windows Azure 服务总线刚刚发布了一项新功能，允许从 C# 后端（很快也从移动服务）推送 Windows 8（和 iOS）通知，根本不需要顶部句柄 ChannelURI。

看看：[http ://channel9.msdn.com/Shows/Cloud+Cover/Episode-100-Introduction-to-the-Windows-Azure-Service-Bus-Notification-Hubs](http://channel9.msdn.com/Shows/Cloud+Cover/Episode-100-Introduction-to-the-Windows-Azure-Service-Bus-Notification-Hubs)

Windows 8 代码演练：[http ://channel9.msdn.com/Blogs/Subscribe/Service-Bus-Notification-Hubs-Code-Walkthrough-Windows-8-Edition](http://channel9.msdn.com/Blogs/Subscribe/Service-Bus-Notification-Hubs-Code-Walkthrough-Windows-8-Edition)

如果你尝试一下，让我知道你的想法！

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T15:44:39.020

严格来说，不需要 NuGet 包，它们只是功能的包装器（所有内容都是 REST/OAuth），让您的生活更轻松。正如您所观察到的，[用于 Windows 8](http://watwindows8.codeplex.com/)和 Windows Phone 的 Windows Azure 工具包在某种程度上已被[Windows Azure 移动服务](http://www.windowsazure.com/en-us/develop/mobile/)所取代。

如果您想自己完成这一切，您可以查看[我撰写的关于使用 Azure 网站进行推送通知的三部分博客系列](http://blogs.msdn.com/b/jimoneil/archive/2012/11/07/windows-8-notifications-push-notifications-via-windows-azure-web-sites-part-1.aspx)。它是网站，而不是 Web 角色，但那部分是可以互换的；不过，我想说的是，除非您已经实现了正在使用的服务，否则网站将是一个更经济的选择。

我没有将 Windows Phone 整合到该系列中，而且 Windows Phone 确实使用了与 Windows 8 略有不同的通知机制，但这在我的待办事项清单上，希望有什么能让你朝着正确的方向前进。

# java - 在Java中，如何检查输入是否为数字？

> ID：14359930
> 
> 赞同：4
> 
> 时间：2013-01-16T13:49:14.313
> 
> 标签：java, swing, parseint

我正在制作一个简单的程序，可让您添加比赛结果，以及他们过去完成的秒数。所以要输入时间，我这样做了：

```
int time = Integer.parseInt(JOptionPane.showInputDialog("Enter seconds")); 
```

所以我的问题是，如果用户输入的不是正数，我该如何向用户显示错误消息？就像 MessageDialog 一样，它会给你错误，直到你输入一个数字。

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T13:53:10.653

```
int time;
try {
    time = Integer.parseInt(JOptionPane.showInputDialog("Enter seconds"));
} catch (NumberFormatException e) {
    //error
} 
```

`Integer.parseInt`如果`NumberFormatException`它无法解析`int`. 如果您只想在输入无效时重试，请将其包装在这样的`while`循环中：

```
boolean valid = false;
while (!valid) {
    int time;
    try {
        time = Integer.parseInt(JOptionPane.showInputDialog("Enter seconds"));
        if (time >= 0) valid = true;
    } catch (NumberFormatException e) {
        //error
        JOptionPane.showConfirmDialog("Error, not a number. Please try again.");
    }
} 
```

* * *

## 回答 #2

> 赞同：2
> 
> 时间：2013-01-16T13:57:47.493

Integer.parseInt 当 Integer.parseInt 的参数不是整数时抛出 NumberFormatException，使用 try Catch 并显示所需的错误消息，将其保留在 do while 循环中，如下所示

```
 int   time = -1;
   do{
       try{
            time = Integer.parseInt(JOptionPane.showInputDialog("Enter seconds"));
       }
       catch(NumberFormatException e){

       }
   }while(time<=0); 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:52:26.203

如果`JOptionPane.showInputDialog("Enter seconds")`不是有效数字，您将得到`NumberFormatException`。对于正数检查，只需检查`time >=0`

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T13:56:02.540

取决于你想如何解决它。一种简单的方法是将时间声明为整数，然后执行以下操作：

```
Integer time;    
while (time == null || time < 0) {
    Ints.tryParse(JOptionPane.showInputDialog("Enter seconds"));
} 
```

当然，这需要你使用谷歌番石榴。（其中包含许多其他有用的功能）。

另一种方法是使用上面的代码，但使用标准的 tryparse，捕获 NumberFormatException 并且在 catch 中什么都不做。

有很多方法可以解决这个问题。

或者不重新发明轮子，只使用： `NumberUtils.isNumber`或`StringUtils.isNumeric`from `Apache Commons Lang`。

# css - CSS 锚文本不在行中

> ID：14359935
> 
> 赞同：1
> 
> 时间：2013-01-16T13:49:26.713
> 
> 标签：css, html-lists, anchor, inline

这是我的网站： http: [//www.michelepierri.it/](http://www.michelepierri.it/)

我在 FF 和 IE 中正确地看到了我的主题，但是如果我在 Chrome 菜单中打开它，语音将无法正确显示：

![在此处输入图像描述](../Images/725e99dd6ee821a40a2ae3631ef0fcb1.png)

你能帮我解决这个问题吗？

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-16T13:59:22.740

在查看了您的 css 后，我发现太多未使用的样式，请删除这些样式并使用以下规则：

```
.menu li {
float: left;
}
.menu a {
white-space: nowrap;
border-left: 1px solid #585858;
color: #fff;
display: inline-block;
font-size: 13px;
font-weight: 700;
height: 45px;
line-height: 45px;
padding: 0 0.9em;
text-shadow: 0 1px 1px #242424;
} 
```

请在进行更改后查看附件。

![在此处输入图像描述](../Images/dec5e40d4b7f69e3629f0b22f52c5d5b.png)

看到我也使用相同的版本，对我来说很好

![在此处输入图像描述](../Images/d46c517ef6cc44b84e67c7291d6cbf5b.png)

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:55:15.310

## 防止菜单选项环绕文本

向您的菜单链接 CSS 添加额外的样式规则，以便所有文本保持在同一行。

```
.menu a {
    border-left: 1px solid #585858;
    color: #fff;
    display: block;
    font-size: 13px;
    font-weight: 700;
    height: 45px;
    line-height: 45px;
    margin: 0;
    padding: 0 0.9em;
    position: relative;
    text-decoration: none;
    text-shadow: 0 1px 1px #242424;

    white-space: nowrap; /* THIS ONE */
} 
```

并在样式定义中添加相同的内容，`.sub-header-menu a`因为当我检查站点时，甚至*云计算*都被包装并破坏了整个情况。

> ***建议**：您正在探索 CSS 的可能性是可以的，但是您玩得太多了会产生易读性问题。字母和单词间距只能谨慎操作。我建议删除大部分字母和单词间距设置。*

# python - 你将如何实现除数函数？

> ID：14359936
> 
> 赞同：3
> 
> 时间：2013-01-16T13:49:30.753
> 
> 标签：python, math, numbers

[除数函数](http://en.wikipedia.org/wiki/Divisor_function)是一个自然数的除数之和。

做了一点研究，我发现如果你想找到给定自然数 N 的除数函数，[这是一个非常好的方法，所以我尝试用 Python 编写它：](http://mathschallenge.net/index.php?section=faq&ref=number/sum_of_divisors)

```
def divisor_function(n):
    "Returns the sum of divisors of n"
    checked = [False]*100000
    factors = prime_factors(n)
    sum_of_divisors = 1 # It's = 1 because it will be the result of a product
    for x in factors:
        if checked[x]:
            continue
        else:
            count = factors.count(x)
            tmp = (x**(count+1)-1)//(x-1)
            sum_of_divisors*=tmp
            checked[x]=True
    return sum_of_divisors 
```

它工作得很好，但我确信它可以改进（例如：我创建了一个包含`100000`元素的列表，但我没有使用其中的大部分）。

您将如何改进/实施它？

PS这是`prime_factors`：

```
def prime_factors(n):
    "Returns all the prime factors of a positive integer"
    factors = []
    d = 2
    while (n > 1):
        while (n%d==0):
            factors.append(d)
            n /= d
        d = d + 1
        if (d*d>n):
            if (n>1): factors.append(int(n));
            break;
    return factors 
```

* * *

## 回答 #1

> 赞同：8
> 
> 时间：2013-01-16T14:50:23.877

在计算除数之和时，您需要以*p* *[1]* ^(*k*) ^(*[1]*) *p* *[2]* ^(*k*) ^(*[2]*) ...的形式对*n*进行因式分解——也就是说，您需要因式分解中每个素数的指数。目前，您正在通过计算素数的平面列表来执行此操作，然后调用计算指数。这是浪费时间，因为您可以轻松地首先生成所需格式的素数分解，如下所示： `count`

```
def factorization(n):
    """
    Generate the prime factorization of n in the form of pairs (p, k)
    where the prime p appears k times in the factorization.

    >>> list(factorization(1))
    []
    >>> list(factorization(24))
    [(2, 3), (3, 1)]
    >>> list(factorization(1001))
    [(7, 1), (11, 1), (13, 1)]
    """
    p = 1
    while p * p < n:
        p += 1
        k = 0
        while n % p == 0:
            k += 1
            n //= p
        if k:
            yield p, k
    if n != 1:
        yield n, 1 
```

上面代码的注释：

1.  我已经转换了这段代码，以便它*生成*分解，而不是构造一个列表（通过重复调用`append`）并返回它。在 Python 中，这种转换几乎总是一种改进，因为它允许您在生成元素时一个一个地使用它们，而不必将整个序列存储在内存中。

2.  这是[doctest](http://docs.python.org/2/library/doctest.html)可以很好地工作的那种功能。

现在计算除数的总和非常简单：不需要存储检查的因子集或计算每个因子出现的次数。实际上，您只需一行即可完成：

```
from operator import mul

def sum_of_divisors(n):
    """
    Return the sum of divisors of n.

    >>> sum_of_divisors(1)
    1
    >>> sum_of_divisors(33550336) // 2
    33550336
    """
    return reduce(mul, ((p**(k+1)-1) // (p-1) for p, k in factorization(n)), 1) 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2014-11-13T12:54:40.667

```
def sum_divisors(n):
    assert n > 0
    if n == 1:
        return 0
    sum = 1
    if n % 2 == 0:              # if n is even there is a need to go over even numbers
        i = 2
        while i < sqrt (n):
            if n % i == 0:
                sum = sum + i + (n//i)  # if i|n then n/i is an integer so we want to add it as well
            i = i + 1
        if type (sqrt (n)) == int:  # if sqrt(n)|n we would like to avoid adding it twice
            sum = sum + sqrt (n)
    else:
        i = 3
        while i < sqrt (n):     # this loop will only go over odd numbers since 2 is not a factor
            if n % i == 0:
                sum = sum + i + (n//i)  # if i|n then n/i is an integer so we want to add it as well
            i = i + 2
        if type (sqrt (n)) == int:  # if sqrt(n)|n we would like to avoid adding it twice
            sum = sum + sqrt (n)
    return sum 
```

* * *

## 回答 #3

> 赞同：1
> 
> 时间：2013-01-16T13:58:16.260

您只需要更改两行：

```
def divisor_function(n):
    "Returns the sum of divisors of n"
    checked = {}
    factors = prime_factors(n)
    sum_of_divisors = 1 # It's = 1 because it will be the result of a product
    for x in factors:
        if checked.get(x,False):
            continue
        else:
            count = factors.count(x)
            tmp = (x**(count+1)-1)//(x-1)
            sum_of_divisors*=tmp
            checked[x]=True
    return sum_of_divisors 
```

* * *

## 回答 #4

> 赞同：1
> 
> 时间：2013-01-17T08:12:47.677

为什么使用`dict`或`set`- 或`count()`-什么时候*保证*`prime_factors()`按升序返回因子？你只需要处理*以前*的因素。计数可以只是迭代的一部分：

```
def divisor_function(n):
    "Returns the sum of divisors of n"
    factors = prime_factors(n)
    sum_of_divisors = 1 
    count = 0; prev = 0;
    for x in factors:
        if x==prev:
            count += 1
        else:
            if prev: sum_of_divisors *= (prev**(count+1)-1)//(prev-1)
            count = 1; prev = x;
    if prev: sum_of_divisors *= (prev**(count+1)-1)//(prev-1)
    return sum_of_divisors 
```

* * *

## 回答 #5

> 赞同：0
> 
> 时间：2013-01-18T08:20:21.150

这是我在我的 Java 数字实用程序（广泛用于 Project Euler）中所做的：

*   使用显式指数生成素数分解（请参阅 Gareth Rees 的答案）。

*   基于它展开各种函数中的素数分解。即，使用与素数分解相同的算法，但直接计算期望值而不是存储因子和指数。

*   默认情况下，测试只除以二和奇数。我有方法`firstDivisor(n)`和`nextDivisor(n,d)`为此。

*   可以选择为所有低于界限的数字预先计算一个最小除数表。如果您需要分解所有或大多数低于界限的数字（将速度提高约`sqrt(limit)`），这将非常有用。我将表连接到`firstDivisor(n)`and`nextDivisor(n,d)`方法中，所以这不会改变分解算法。

# android - AlarmManager 未在指定时间发出警报

> ID：14359939
> 
> 赞同：1
> 
> 时间：2013-01-16T13:49:38.300
> 
> 标签：android

我正在使用以下代码在特定日期和时间设置警报。

```
mCalendar.setTimeInMillis(System.currentTimeMillis());
mCalendar.set(Calendar.YEAR, 2013);
mCalendar.set(Calendar.MONTH, 0);
mCalendar.set(Calendar.DAY_OF_MONTH, 16);
mCalendar.set(Calendar.HOUR_OF_DAY, 1);
mCalendar.set(Calendar.MINUTE, 30);
mCalendar.set(Calendar.SECOND, 0);
mCalendar.set(Calendar.MILLISECOND, 0);
new ReminderManager(this).setReminder(info.id, mCalendar); 
```

功能`ReminderManager.setReminder`是：

```
public void setReminder(Long taskId, Calendar when) 
{       
    Intent i = new Intent(mContext, OnAlarmReceiver.class);
    i.putExtra(DataBaseHelper.KEY_ROWID, (long)taskId);
    PendingIntent pi = PendingIntent.getBroadcast (mContext,0,i,PendingIntent.FLAG_ONE_SHOT);
    mAlarmManager.set(AlarmManager.RTC_WAKEUP, when.getTimeInMillis(), pi); 
} 
```

它无法正常工作，当我在我的应用程序中按下“放置提醒”菜单项而不是我指定的时间时，警报会响起。

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:53:40.397

你确定日期是未来吗？

我还没有检查过，但如果您过去尝试设置警报，这可能是设计的行为......

`2013-JAN-16 1:30`对我来说看起来像是过去（至少在我的时区）。

# ruby-on-rails-3 - 使用 FB.api 在其他用户的墙上发布提要

> ID：14359940
> 
> 赞同：0
> 
> 时间：2013-01-16T13:49:41.377
> 
> 标签：ruby-on-rails-3, facebook-graph-api, feed

我的要求：自动将消息发布到用户的活动日志而不显示任何对话。

我为此使用 FB.api。您可以查看我在[https://developers.facebook.com/docs/reference/javascript/FB.api/中使用的代码](https://developers.facebook.com/docs/reference/javascript/FB.api/)

现在，当前 UserA 通过我的应用程序登录到 Facebook。当我现在调用 FB.api 时，“我”被替换为 UserA 的 Facebook user_id（当前登录用户）。

我的问题：当 UserA 通过我的应用程序登录到 Facebook 时，我可以向 UserB 的个人资料发布消息吗？如果是，请告诉我怎么做？

对于这个问题，在上面的代码中，我尝试通过替换 UserB 的 Facebook user_id 来代替“我”，但它不起作用。但是，当我对这个问题使用 FB.ui 方法时，它可以工作。建议我的理由。

谢谢。

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:49:56.577

> 当 UserA 通过我的应用程序登录 Facebook 时，我可以向 UserB 的个人资料发布消息吗？如果是，请告诉我怎么做？

您可以只使用 UserB 的用户 id 或用户名而不是`me`.

**但是：**此功能将很快被删除（从 2013 年 2 月开始，请参阅[https://developers.facebook.com/roadmap/](https://developers.facebook.com/roadmap/)），因此不再值得开发类似的东西。

从那时起，发布到另一个用户的墙上的唯一方法是使用 Feed 对话框，并让用户 (UserA) 自己主动触发发布。

# c# - 生成回发到特定方法/事件处理程序

> ID：14359941
> 
> 赞同：1
> 
> 时间：2013-01-16T13:49:52.513
> 
> 标签：c#, asp.net, postback

我有一个自定义的gridview，并且我在RowDataBound 上手动为onclick 生成一个回发事件。但是，这个回发总是去/期望行点击的特定方法。

这是我当前使回发发生的代码：

```
if (!String.IsNullOrEmpty(this.OnRowClick))
                e.Row.Attributes.Add("onclick", this.Page.ClientScript.GetPostBackEventReference(this.grid1, "Select$" + e.Row.RowIndex.ToString())); 
```

正如您在此处看到的，我已经为我的网格设置了一个属性，以询问在执行回发时要调用哪个方法...但是，我似乎无法在网络上的任何地方找到如何在 _dopostback 调用中指定要调用的方法...它总是无一例外地期望这种方法：

```
grid1_SelectedIndexChanged(object sender, eventargs e) 
```

但我不想那样。我希望它转到属性 OnRowClick 中包含的任何方法名称。

以下是视觉人员当前的设置方式：

就是这样……我不确定。我是一个视觉型的人，所以也许这对每个人都有一点帮助：

> 自定义控件设置（缩小版）：
> 
> [其他一些控件
> 
> -= 网格视图 =-
> 
> 其他一些控制]
> 
> [（控制事件属性）
> 
> OnRowClick 事件 (GridViewRow eventarg)]
> 
> [（控制事件连线）
> 
> 如果（OnRowClick！= null）
> 
> this.GridView1.SelectedIndexChanged += InternalMethod(...)
> 
> [（内部方法（...））
> 
> GridViewRow 行 = this.GridView1.SelectedRow;
> 
> 如果（OnRowClick！= null）
> 
> OnRowClick(行);]]

到目前为止一切顺利......没有任何问题......但是......当我这样设置时：

> 网页
> 
> -> 自定义控件（mygrid）
> 
> ---> mygrid.OnRowClick += SomePageMethod(GridViewRow 行)
> 
> ------> SomePageMethod 永远不会被调用...就像...永远...

由于我已将控件构建为复合控件，因此我无法通过其内部代码进行调试，所以我不知道为什么它没有发生......：S请帮我正确地冒泡这个事件！

自定义控制代码：

```
 this.grid1.SelectedIndexChanged += new EventHandler(grid1_SelectedIndexChanged);

    void grid1_SelectedIndexChanged(object sender, EventArgs e)
    {
        GridViewRow row = this.grid1.SelectedRow;
        if(this.OnRowClick!=null)
            OnRowClick(this.grid1, row);

    }

    #region Events
    public delegate void RowClickEventHandler(object sender, GridViewRow SelectedRow);
    [Category("Events")]
    [Description("This event fires when a row is clicked, if it is defined")]
    public event RowClickEventHandler OnRowClick;
    #endregion 
```

网页代码：

```
this.pgrSummary.OnRowClick += new SimplePager.SimplePager.RowClickEventHandler(pgrSummary_OnRowClick); 
```

而且那个方法永远不会被调用......

# c# - 将变量从 Site.Master.Cs 放入 C# 中的 Site.Master

> ID：14359953
> 
> 赞同：0
> 
> 时间：2013-01-16T13:50:49.130
> 
> 标签：c#, .net, master-pages

我想在 Site.Master.Cs 上的“ `Page_Load`”事件中提供一个变量，并将这个值放在我的 Site.Master 中。

我已经这样做了，但它不起作用：

```
<asp:Literal ID="myControl" runat="server">
    Hello
</asp:Literal> 
```

而且，在我的 Site.Master.Cs 中：

```
protected void Page_Load(object sender, EventArgs e)
{

    Literal litStreamHtml = (Literal)this.Master.FindControl("myControl");
    litStreamHtml.Text = "some text";

} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T13:53:01.540

您已经在母版页上，因此您不必引用母版（仅在您使用嵌套母版页的情况下。

```
protected void Page_Load(object sender, EventArgs e)
{
    Literal litStreamHtml = (Literal)this.FindControl("myControl");
    litStreamHtml.Text = "some text";
} 
```

* * *

## 回答 #2

> 赞同：1
> 
> 时间：2013-01-16T13:58:16.067

同意 Luuk，你也可以使用

```
myControl.Text = "some text"; 
```

# c# - 如何使用 WebInvokeAttribute 异步调用 WCF 服务方法？

> ID：14359954
> 
> 赞同：4
> 
> 时间：2013-01-16T13:51:04.787
> 
> 标签：c#, wcf, asynchronous, webinvoke

我有这种方法的 WCF 服务。该方法具有 WebInvoke 属性。我怎样才能异步调用它？

```
[WebInvoke(UriTemplate = "*", Method = "*")]
public Message HandleRequest()
{
    var webContext = WebOperationContext.Current;
    var webClient = new WebClient();

    return webContext.CreateStreamResponse(webClient.OpenRead("http://site.com"), "text/html");
} 
```

* * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-17T13:58:22.047

调用该方法时，您可以在客户端中使用线程。但是为了更精确的响应，请定义客户端：使用哪种技术等。

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-18T00:04:26.743

您可以使用任务并行库或 TPL 异步调用它。这是一个例子。示例代码正在调用 WebGet。WebInvoke 或 HTTP Post 代码有一些不同。请注意，TPL 仅适用于 .NET Framework 3.5 及更高版本

使用 System.Threading.Tasks 添加；到你的用途

```
 //URL that points to your REST service method
                var request = WebRequest.Create(url);                   
                var task = Task.Factory.FromAsync<WebResponse>(
                            request.BeginGetResponse,
                            request.EndGetResponse,
                            null);
                var dataStream = task.Result.GetResponseStream();
                var reader = new StreamReader(dataStream);
                var responseFromServer = reader.ReadToEnd();
                reader.Close();
                dataStream.Close(); 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-30T15:01:33.960

您可以通过将以下值一起传递给`ServiceBehavior`属性来为您的服务类定义异步行为：

1.  `InstanceContextMode = InstanceContextMode.Single`,
2.  `ConcurrencyMode = ConcurrencyMode.Multiple`.

生成的代码可能如下所示：

```
[ServiceContract]
[ServiceBehavior(InstanceContextMode = InstanceContextMode.Single, ConcurrencyMode = ConcurrencyMode.Multiple)]
public class MyService
{
    [WebInvoke(UriTemplate = "*", Method = "*")]
    public Message HandleRequest()
    {
        var webContext = WebOperationContext.Current;
        var webClient = new WebClient();

        return webContext.CreateStreamResponse(webClient.OpenRead("http://site.com"), "text/html");
    }
} 
```

# android - 获取EditText位置Android的纬度和经度

> ID：14359958
> 
> 赞同：0
> 
> 时间：2013-01-16T13:51:29.203
> 
> 标签：android, map, location, android-edittext, geopoints

好的，所以我要做的是有一个 EditText 框，用户可以在其中输入街道名称。然后，我的应用程序将获取该街道的纬度/经度，并在地图上的该地理位置放置一个标记（使用 Google Maps API v2）。到目前为止，我已经设置了 EditText 框以及具有在指定地理点手动添加标记的功能的地图。

示例：如果用户在 EditText 框中输入“Grafton Street”，应用程序将获取纬度/经度 (53.342094,-6.259868) 并随后使用 GeoPoint 函数在地图上的该点放置一个标记，或者甚至突出显示整条路（如谷歌方向等所示）。

我的问题是我不确定如何实际获取输入位置的纬度和经度以传递给我的 addMarker 函数。任何想法或建议将不胜感激！

编辑：已解决，请参阅下面的答案。

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-17T12:21:45.437

我使用了下面提供的答案并设法让它工作。我创建了一个新的 LatLong 而不是 GeoPoint 仅仅是因为 addMarkerHere 函数使用了该类型。这是我为将来可能需要它的任何人使用的代码：

```
Geocoder g = new Geocoder(this);
    List<Address> addressList = null;
    String searchRoad = "Insert Road Name Here!";
    try {
        addressList = g.getFromLocationName(searchRoad, 1);

    } catch (IOException e) {
        Toast.makeText(this, "Location not found",     Toast.LENGTH_SHORT)
                    .show();
            e.printStackTrace();

    } finally {
        Address address = addressList.get(0);

        if (address.hasLatitude() && address.hasLongitude()) {
            double selectedLat = address.getLatitude();
            double selectedLng = address.getLongitude();
            LatLng Road = new LatLng(selectedLat, selectedLng);
            Marker Custom = map.addMarker(new MarkerOptions()
                    .position(searchedRoad).title("Here is the road location")
                    .snippet("Hon the lads"));
    } 
```

* * *

## 回答 #2

> 赞同：0
> 
> 时间：2013-01-16T13:58:20.873

首先，您需要使用 GoeCoder 获取名称并将其转换为 Lat\Long：

[http://developer.android.com/reference/android/location/Geocoder.html](http://developer.android.com/reference/android/location/Geocoder.html)

然后，您将使用 GeoPoint 获取 lat\long 作为参数，并将其转换为 aa GeoPoint（用于在地图上显示）。

[https://developers.google.com/maps/documentation/android/v1/reference/com/google/android/maps/GeoPoint](https://developers.google.com/maps/documentation/android/v1/reference/com/google/android/maps/GeoPoint)

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2013-01-16T14:51:36.307

您的简化解释是一个好主意，也是一个很好的应用项目。

但是即使你的简单解释很简单，因为它是一个应用项目，所以要给你想要得到的答案也并不容易。您必须通过 Google 搜索收集许多示例代码和文档。

首先，请参阅[本 Android 官方手册](https://developers.google.com/maps/documentation/android/start)。

其次，请在上面的文档中下载示例代码。

* * *

## 回答 #4

> 赞同：0
> 
> 时间：2013-01-16T14:09:26.900

它称为[地理编码](https://developers.google.com/maps/documentation/geocoding/)。您提交请求，他们会返回匹配的地点列表。解析该结果，获得该列表中第一名的几何图形。

# dom - DOM 事件监听器垃圾回收

> ID：14359962
> 
> 赞同：5
> 
> 时间：2013-01-16T13:51:32.497
> 
> 标签：dom, garbage-collection, event-listener

如果一个事件侦听器附加到表的特定列中的每个单元格，然后从表中删除每一行，为了避免内存泄漏，开发人员有必要在删除行之前删除事件侦听器，或者浏览器会清理东西吗？

编辑：Michael 建议的文章`event delegation`比将侦听器直接绑定到表中的每个单元格表现更好，但我不确定从垃圾收集的角度来看它是否更好，或者只是表现更好。请评论。来自文章：

```
 $('table').on('click', 'td', function () {

            $(this).toggleClass('active');

        }); 
```

据说优于：

```
 $('table td').on('click', function () {

            $(this).toggleClass('active');

        }); 
```

Edit2：.on() 和事件委托的*jQuery*[文档](http://api.jquery.com/on/)也关注性能，但是从垃圾收集的角度来看，当从大表中重复删除行并且单元格单击正在被删除时会发生什么问题由委托机制听取，仍然存在。

 ** * *

## 回答 #1

> 赞同：1
> 
> 时间：2013-01-16T14:11:34.147

我不确切知道，但我认为浏览器（JavaScript 引擎）负责垃圾收集。

据我所知，这种机制在新一代浏览器中是自动的

所以，流程会是这样的，

```
1\. you create cells
2\. you attach listeners
3\. memory allocated
4\. you remove cells
5\. listeners becomes dangling
6\. Garbage collector clears it
7\. you are happy 
```

还有一些机制提供明确清除它，搜索SO，会有很多与此相关的问题

但我又不确定！所以等待专家提出可靠的答案

* * *

## 回答 #2

> 赞同：-2
> 
> 时间：2013-01-16T14:03:38.787

我不确定，但我想这篇精彩的文章会清理干净（搜索“垃圾收集”）：[http ://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/](http://coding.smashingmagazine.com/2012/11/05/writing-fast-memory-efficient-javascript/)*

# regex - ReplaceRegex 函数没有做这项工作

> ID：14359963
> 
> 赞同：0
> 
> 时间：2013-01-16T13:51:41.847
> 
> 标签：regex, ant, properties, boost-regex, regex-greedy

我想编辑这行输入并向 Product_A 键添加更多值。

```
 input="CSDT_FLAG_PRODUCT_FF_FWUIDS=Product_A:45223423;Product_PD:4;Product_CD:345345,22454;Product_F:3423" 
```

我有下面的 ant replaceregex 行。

```
replaceregexp file="../cms-distribution/src/main/properties/editorial/common/csdtflags.properties" flags="s" match="Product_A:([^\.]*)([;])?" replace="Product_A:,${uid}\1" byline="true"/> 
```

除了产生的结果之外，这可以完成工作：

```
CSDT_FLAG_PRODUCT_FF_FWUIDS=Product_A:+,42e8140a-79ce-4bda-b64a-539bc4a17dbb+,80ab7183-715d-471b-8ae0-b527d2597b06+,...... 
```

它从无处插入一个 + 符号，其次它替换了 Product_A 中存在的原始值。我想用逗号附加到原始值。我该怎么做呢？任何帮助表示赞赏。

谢谢

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:31:24.403

我对 ant 以及它如何处理正则表达式一无所知，但我认为问题取决于正则表达式。你有一个字符串

```
"CSDT_FLAG_PRODUCT_FF_FWUIDS=Product_A:45223423;Product_PD:4;Product_CD:345345,22454;Product_F:3423" 
```

和一个正则表达式

```
/Product_A:([^\.]*)([;])?/ 
```

`;`匹配直到字符的最后一次出现，`;`因此不只匹配**Product_A**下的值，请[在此处](http://rubular.com/r/0Kw9hvJHla)自行查看。

但是，如果您现在**Product_A**键的值始终是 8 位字符串，则可以使用此正则表达式：

```
/Product_A:(.{8});/ 
```

里面的匹配组`()`将捕获代码，这就是我可以帮助你的，也许这个答案[Replacing characters in Ant property 有](https://stackoverflow.com/questions/1176071/replacing-characters-in-ant-property)帮助。

# xslt - 触发回发以从 DVWP 下拉框中发送查询参数

> ID：14359966
> 
> 赞同：0
> 
> 时间：2013-01-16T13:51:50.370
> 
> 标签：xslt, sharepoint, dom-events, sharepoint-designer, dataviewwebpart

我需要根据选定的下拉值过滤我的列表。我为此创建了一个 DVWP 并将其转换为下拉列表。现在我正在关注这篇[文章](http://sympmarc.com/2008/01/03/firing-an-event-when-a-user-selects-a-value-from-a-data-view-web-part-dropdown/)以在选择下拉值时触发事件，但我只是不知道在哪里更改代码。我正在根据年份过滤列表。我有一个年份列表，其中存储年份值并在选择下拉列表时相应地对其进行过滤。我已经这样修改了它：

```
<xsl:otherwise>
  <select name="ID" size="1" onchange="document.location.href='pageName.aspx?year=' + this.options[selectedIndex.value])">
    <option selected="true" value="0">Choose One...</option>
    <xsl:call-template name="dvt_1.body">
      <xsl:with-param name="Rows" select="$Rows" />
    </xsl:call-template>
  </select> 
```

我不知道 xslt 并且当我更改下拉值时这不会触发任何事件。请帮我解决一下这个。

更新：我得到的 HTML：

```
<td valign="top">
  <div WebPartID="9e0da2fd-21ea-417f-863d-6551d16e72a1" HasPers="false" id="WebPartWPQ3" width="100%" class="noindex" allowDelete="false" style="" >
    <select name="ID" size="1" onchange="document.location.href='http://pageName.aspx?year=' + this.options[selectedIndex].value" xmlns:x="http://www.w3.org/2001/XMLSchema" xmlns:d="http://schemas.microsoft.com/sharepoint/dsp" xmlns:asp="http://schemas.microsoft.com/ASPNET/20" xmlns:__designer="http://schemas.microsoft.com/WebParts/v2/DataView/designer" xmlns:SharePoint="Microsoft.SharePoint.WebControls" xmlns:ddwrt2="urn:frontpage:internal">
      <option selected="" value="0">Choose One...</option>
      <option>2009</option>
      <option>2010</option>
      <option>2011</option>
      <option>2012</option>
      <option>2013</option>
    </select>
  </div>
</td> 
```

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2013-01-16T14:02:00.573

我有点怀疑这是一个 XSLT 问题。该教程中处理程序的脚本`onchange`似乎可以归结为：

```
document.location.href='pageName.aspx?year=' + this.options[selectedIndex].value 
```

请注意，`.value`在`[]`. 你能试试吗？当您更改下拉选择时，您的浏览器是否报告任何 JavaScript 错误？

现在，根据[本教程](http://techtrainingnotes.blogspot.jp/2012/03/sharepoint-search-filter-or-sort-lists.html)，您可以通过指定名为`FilterField1`、`FilterValue1`等的查询参数来过滤列表，所以您可以尝试以下操作：

```
document.location.href='pageName.aspx?FilterField1=ColumnName&amp;FilterValue1=' 
 + this.options[selectedIndex].value + '&amp;year=' + this.options[selectedIndex].value 
```

在这里，您将使用列的实际名称替换“ColumnName”，如该教程中所述。你能试试这样的东西吗？

# c# - 在 C# 中将文本数据转换为百分比

> ID：14359971
> 
> 赞同：3
> 
> 时间：2013-01-16T13:51:55.133
> 
> 标签：c#

我正在将数据输入文本字段，我需要将其显示为百分比。有执行此操作的功能吗？

例如：在我的专栏中，我有`"0.5", "0.1","0.2","0.25"`等，需要显示为 `50%,10%,20%,25%`等，最好的方法是什么？

* * *

## 回答 #1

> 赞同：11
> 
> 时间：2013-01-16T13:53:55.750

您应该分两个阶段执行此操作：

*   将文本解析为*数字*，以便将值作为“真实”类型。（作为一般规则，尽可能早地从文本解析，并尽可能晚地格式化为字符串......使用自然类型两者之间的操作会简单得多。）
*   使用百分比的[标准数字格式字符串](http://msdn.microsoft.com/en-gb/library/dwhawy9k.aspx)将数字格式化为[百分比](http://msdn.microsoft.com/en-gb/library/dwhawy9k.aspx#PFormatString)

所以：

```
decimal percentage = decimal.Parse(input);
string output = percentage.ToString("p0"); 
```

笔记：

*   您应该同时考虑输入和输出文化；你总是期望使用“。” 例如，作为小数分隔符？
*   使用`decimal`而不是`double`准确表示文本中的值（例如，文本可能有“0.1”，但`double`不能保持正好为 0.1 的值）
*   您可以在格式中添加所需的精度等内容；有关详细信息，请参阅链接的文档；该示例仅给出整数百分比，例如

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T13:54:13.650

最简单的方法是解析它（必须是双精度），然后将其转换回字符串，将其格式化为百分比。

```
var percentageString = double.Parse(doubleString).ToString("p1"); 
```

现在，*你们中的一些*hoity-toity 类型可能会说[decimal](http://msdn.microsoft.com/en-us/library/364x0z75%28v=vs.110%29.aspx)是在这种情况下使用的正确类型。

好吧，是的，如果您需要额外的*12-13 位精度*。

然而，我们大多数*真正*的人（我只想保持真实）对于[double 的](http://msdn.microsoft.com/en-us/library/678hzkk9.aspx)15-16 位精度都很好。

真正的选择是您的代码是否首先使用双精度数或小数。如果您在代码中使用双打，请坚持使用双打。如果是小数，请坚持使用小数。您绝对*要*避免的是，在绝对必要的情况下必须在两者之间进行转换，因为有龙。以及可能损坏您的数据的意外运行时错误。但主要是龙。

# linux - 在 linux 终端中运行 Ada 程序

> ID：14359972
> 
> 赞同：5
> 
> 时间：2013-01-16T13:51:55.530
> 
> 标签：linux, ada, gnat

我使用 Linux 薄荷。使用“sudo apt-get install gnat”安装 gnat 以使用 Ada 程序。
创建了一个简单的 hello world 程序：

```
with Ada.Text_IO;
procedure Hello is
begin
    Ada.Text_IO.Put_Line("Hello, world!");
end Hello; 
```

并将其保存为“hello.adb”

尝试从保存位置运行它，打开终端并输入并得到以下信息：

> $ cd /media/disk1/ada\ 程序
> $ gnatmake hello.adb
> gcc-4.4 -c hello.adb
> gnatbind -x hello.ali
> gnatlink hello.ali
> $ hello
> 程序 'hello' 可以在以下包中找到：
> * hello
> * hello-debhelper
> 尝试：sudo apt-get install
> $ ./hello
> bash: ./hello: Permission denied

我该怎么做才能看到程序的输出？
它哪里出错了？

很少有网站说，在“gnatmake hello.adb”之后只输入“hello”，但它不起作用，
很少有人说，在“gnatmake hello.adb”之后尝试“./hello”，但这也不起作用？

接下来是什么？请帮忙。。

* * *

## 回答 #1

> 赞同：7
> 
> 时间：2013-01-16T15:02:21.233

不要`/media/disk1/ada\ programs`在您（显然）没有足够[权限](http://www.linux.com/learn/tutorials/309527-understanding-linux-file-permissions)的目录中构建。相反，在你的主目录中的某个地方构建`~`，你*确实*有权限。GNAT 可执行文件通常安装`/usr/bin`在`PATH`.

```
$ 哪个 gnatmake
/usr/bin/gnatmake
$ 回声 $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
$光盘~
$ gnatmake 你好
gcc-4.6 -c hello.adb
gnatbind -x hello.ali
gnatlink hello.ali
$ ./你好
你好世界！

```

* * *

## 回答 #2

> 赞同：3
> 
> 时间：2013-01-16T14:41:12.273

你的编译过程很好。正如 Marc C 所说，您通常不需要关心执行权限（`chmod`命令）。GNAT 应该解决这个问题。

要执行您的程序，您不能只键入`hello`. 这是一个新程序：你刚刚完成，实际上你的终端太笨了，无法理解你的意思。您必须告诉他*您*的程序在文件系统中的位置。这就是打字的重点`./hello`。基本上，它的意思是“在当前目录中查找一个名为 hello 的程序”。因此，如果您移动到另一个目录，它将无法工作。

* * *

## 回答 #3

> 赞同：2
> 
> 时间：2013-01-16T14:13:41.417

您必须为您的可执行文件分配执行权限：

```
$ chmod a+x hello 
```

并运行它：

```
$ ./hello 
```

# linux - Qt5：Xcb Xau 符号未解析

> ID：14359978
> 
> 赞同：5
> 
> 时间：2013-01-16T13:52:13.260
> 
> 标签：linux, qt, centos, qt5

在安装支持 XCB 的 Qt5 期间， ***./configure -prefix $PWD/qtbase -opensource -nomake tests -qpa xcb -qt-xcb***失败，因为它无法链接到 libXau 和 libXdmcp

```
/usr/local/lib/libxcb.a(xcb_auth.o): In function `get_authptr':
/users/salunkrj/libxcb-1.9/src/xcb_auth.c:163: undefined reference to `XauGetBestAuthByAddr'
/usr/local/lib/libxcb.a(xcb_auth.o): In function `_xcb_get_auth_info':
/users/salunkrj/libxcb-1.9/src/xcb_auth.c:377: undefined reference to `XauDisposeAuth'
/usr/local/lib/libxcb.a(xcb_auth.o): In function `compute_auth':
/users/salunkrj/libxcb-1.9/src/xcb_auth.c:256: undefined reference to `XdmcpWrap'
/usr/local/lib/libxcb.a(xcb_auth.o): In function `_xcb_get_auth_info':
/users/salunkrj/libxcb-1.9/src/xcb_auth.c:369: undefined reference to `XauDisposeAuth'
collect2: ld returned 1 exit status
gmake: *** [xcb] Error 1
xcb disabled.
The test for linking against libxcb failed!
You might need to install dependency packages for libxcb. 
```

libXau：XauDisposeAuth 和 XauGetBestAuthByAddr 的符号名称确实存在并在我进行查找时显示，并且**LD_LIBRARY_PATH**包括*/usr/local/lib*

```
nm /usr/local/lib/libXau.a | grep "XauGetBestAuthByAddr\|XauDisposeAuth"
0000000000000000 T XauDisposeAuth
                 U XauDisposeAuth
                 U XauDisposeAuth
0000000000000030 T XauGetBestAuthByAddr 
```

libXdmcp：Xdmcp 似乎没有符号。nm libXdmcp.so | grep XdmcpWrap nm：libXdmcp.so：无符号

在运行 configure 以帮助解析 libXau/libXdmcp 符号时，我需要提及什么具体内容吗？

操作系统 - CentOS5.6 内核 - 2.6.18-238.9.1.el5-x86_64 Qt5.0.0 - 开源

* * *

## 回答 #1

> 赞同：0
> 
> 时间：2017-08-26T14:27:37.313

就我而言，我必须将 -lXau 添加到我的 makefile 中。在 OpenBSD 下，而不是 Linux。我正在并行处理相同的程序，当我将我的最新版本复制到 OpenBSD 时，我遇到了这个问题。

Xau 就是 Xauth，我没有故意使用它。Xau 和 xauth 都有手册页，但它们与连接到 X 服务器的授权有关，而不是大多数人可能认为的安全性。

在配置阶段，您可能会在 LDFLAGS 中添加 -lXau。

# linux - ubuntu 中的单声道和非托管代码

> ID：14359981
> 
> 赞同：3
> 
> 时间：2013-01-16T13:52:25.373
> 
> 标签：linux, mono, 64-bit, unmanaged

我正在使用在 Ubuntu 12 x64 上运行的 Mono 2.10。现在我需要知道如何使用非托管代码。

```
[DllImport("libc.so")]
public static extern int getpid (); 
```

而且，在下一步中，我有：

```
getpid(); 
```

我收到这个错误L

```
$ MONO_LOG_LEVEL="debug" MONO_LOG_MASK="dll" mono libc_test.exe
Mono: DllImport attempting to load: 'libc.so'.
Mono: DllImport loading library:     '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so'.
Mono: DllImport error loading library '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so: cannot open shared     object file: No such file or directory'.
Mono: DllImport loading library:     '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so'.
Mono: DllImport error loading library     '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so: cannot open shared     object file: No such file or directory'.
Mono: DllImport loading location: 'libc.so'.
Mono: DllImport error loading library: '/usr/lib/x86_64-linux-gnu/libc.so: invalid     ELF header'.
Mono: DllImport loading location: 'libc.so'.
Mono: DllImport error loading library: '/usr/lib/x86_64-linux-gnu/libc.so: invalid     ELF header'.
Mono: DllImport loading: 'libc.so'.
Mono: DllImport error loading library '/usr/lib/x86_64-linux-gnu/libc.so: invalid     ELF header'.
Mono: DllImport unable to load library '/usr/lib/x86_64-linux-gnu/libc.so: invalid     ELF header'.
Mono: DllImport attempting to load: 'libc.so'.
Mono: DllImport loading library:     '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so'.
Mono: DllImport error loading library     '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so: cannot open shared     object file: No such file or directory'.
Mono: DllImport loading library:     '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so'.
Mono: DllImport error loading library         '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so: cannot open shared     object file: No such file or directory'.
Mono: DllImport loading location: 'libc.so'.
Mono: DllImport error loading library: '/usr/lib/x86_64-linux-gnu/libc.so: invalid     ELF header'.
Mono: DllImport loading location: 'libc.so'.
Mono: DllImport error loading library: '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.
Mono: DllImport loading: 'libc.so'.
Mono: DllImport error loading library '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.
Mono: DllImport unable to load library '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.
Hello Linux!
Mono: DllImport attempting to load: 'libc.so'.
Mono: DllImport loading library: '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so'.
Mono: DllImport error loading library '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so: cannot open shared     object file: No such file or directory'.
Mono: DllImport loading library: '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so'.
Mono: DllImport error loading library '/home/ibaranov/Documents/MONO/libc_test/libc_test/bin/Debug/libc.so: cannot open shared object file: No such file or directory'.
Mono: DllImport loading location: 'libc.so'.
Mono: DllImport error loading library: '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.
Mono: DllImport loading location: 'libc.so'.
Mono: DllImport error loading library: '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.
Mono: DllImport loading: 'libc.so'.
Mono: DllImport error loading library '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.
Mono: DllImport unable to load library '/usr/lib/x86_64-linux-gnu/libc.so: invalid ELF header'.

Unhandled Exception: System.DllNotFoundException: libc.so
  at (wrapper managed-to-native) libc_test.LibC:getpid ()
  at libc_test.MainClass.Main (System.String[] args) [0x00000] in <filename unknown>:0 
[ERROR] FATAL UNHANDLED EXCEPTION: System.DllNotFoundException: libc.so
  at (wrapper managed-to-native) libc_test.LibC:getpid ()
  at libc_test.MainClass.Main (System.String[] args) [0x00000] in <filename unknown>:0 
```

我一直在尝试解决这个问题很长一段时间，但我尝试过的任何东西都没有帮助我。我用：

```
 dlopen("libc.so", RTLD_NOW); 
```

也许我需要为 x64 编译的 libc.so？

* * *

## 回答 #1

> 赞同：6
> 
> 时间：2014-06-13T23:17:05.093

它应该是

`[DllImport("libc.so.6")]`

要不就

`[DllImport("libc")]`

"libc" 是 /etc/mono/config 的别名，在 GNU/Linux 系统上： `... <dllmap dll="libc" target="libc.so.6" os="!windows"\> ...`

* * *

## 回答 #2

> 赞同：4
> 
> 时间：2013-01-16T14:21:46.590

在 x64 位 ubuntu 12 中解决此问题

```
cd /lib/x86_64-linux-gnu
ln -s libc.so.6 libc.so 
```

* * *

## 回答 #3

> 赞同：0
> 
> 时间：2015-06-18T12:02:39.070

为了在 Raspberry Pi 上使用从 tarball 编译的 mono 4.0.2 解决 Raspbian，我这样做了

```
sudo cp /lib/arm-linux-gnueabihf/libc.so.6 /lib/libc 
```

`/lib`是默认搜索文件夹之一

# asp.net-mvc - ASP.NET MVC 站点已停止在 IIS7 中工作

> ID：14359983
> 
> 赞同：0
> 
> 时间：2013-01-16T13:52:37.327
> 
> 标签：asp.net-mvc, iis-7

完全奇怪的情况。这个网站几个月来一直运行良好。不知道何时或发生了什么，但现在当我访问 www.mysite.com 时，我只是得到一个空白页面。

我在 中放置了一个调试语句`Global.asax`，该语句被命中并在文本日志文件中留下一行。但是应用程序永远不会在`HomeController`构造函数或`HomeController.Index()`. 事实上，我什至可以导航到 www.mysite.com/oogabooga，它不会抛出任何关于找不到 Oogabooga 控制器的异常。

在调试模式下，一切正常，但该站点现在只是拒绝在 IIS 下运行。

可能发生了什么？如何诊断？怎么修？

# android - 裁剪图像并保存到 sdcard (Android) 中的特定文件夹？

> ID：14359985
> 
> 赞同：0
> 
> 时间：2013-01-16T13:52:52.180
> 
> 标签：android, imageview, sd-card, crop

我的图像已被裁剪。我希望将该图像保存到文件夹（sdcard）...我已经完成了裁剪图像并显示到 imageview，但我的问题是，我不知道如何将图像裁剪保存到 sdcard？

这是我的代码成功裁剪图像..

```
Bundle extras = data.getExtras();

if (extras != null) {               
    Bitmap photo = extras.getParcelable("data");
    mImageView.setImageBitmap(photo);
} 
```

我可以在哪里添加代码来保存已裁剪的图像？

* * *

## 回答 #1

> 赞同：3
> 
> 时间：2013-01-16T13:58:38.037

试试这种方式：

> ```
>  Bundle m_extras = data.getExtras();
>  // get the cropped bitmap
>  Bitmap m_thePic = m_extras.getParcelable("data");
>  String m_path = Environment.getExternalStorageDirectory().toString();
> File m_imgDirectory = new File(m_path + "/Images/");
> if (!m_imgDirectory.exists()) m_imgDirectory.mkdir();
> OutputStream m_fOut = null;
> File m_file = new File(m_path);
> m_file.delete();
> String m_fileid = System.currentTimeMillis() + "";
> m_file = new File(m_path, "/Images/" + m_fileid + ".png");  
> try
> {
>     if (!m_file.exists()) m_file.createNewFile();
>     m_fOut = new FileOutputStream(m_file);      
>     Bitmap m_bitmap = m_thePic.copy(Bitmap.Config.ARGB_8888, true);
>     m_bitmap.compress(Bitmap.CompressFormat.PNG, 100, m_fOut);
>     m_fOut.flush();
>     m_fOut.close();
>     MediaStore.Images.Media.insertImage(getContentResolver(),
>             m_file.getAbsolutePath(), m_file.getName(), m_file.getName());
> }
> catch (Exception p_e)
> {
> } 
> ```

在清单文件中添加以下权限。

```
 <uses-permission android:name="android.permission.CAMERA" />
    <uses-feature android:name="android.hardware.camera" />
    <uses-feature android:name="android.hardware.camera.autofocus" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"/> 
```

# javascript - 嵌套时间线中的问题：GreenSock for javascript

> ID：14359987
> 
> 赞同：0
> 
> 时间：2013-01-16T13:53:00.400
> 
> 标签：javascript, gsap

我正在嵌套时间线。

代码就像：

```
timeLine.to(obj1,1.2,{css:{display:"block"}})  

nestedTimeline1 = new TimelineMax({repeat:1});

// initially obj2 is with opacity :0

nestedTimeline1.append(TweenLite.to(obj2,1.4,{css:{opacity:1,left:187,bottom:108}}))
nestedTimeline1.append(TweenLite.to(obj2,.5,{css:{opacity:0}}),-.8)

timeLine.append(nestedTimeline1); 
```

当我做：

```
timeLine.totalProgress(0); 
```

我的动画将从第一个开始。但问题是 obj2 不透明度不会重置为 0。

我无法理解为什么会出现这个问题？

任何解决方案将不胜感激..

* * *

## 回答 #1

> 赞同：4
> 
> 时间：2013-01-17T06:00:04.467

让我们从第一行开始。

您无法设置动画`display:block`- 没有可设置动画的数值。你可以从动画`opacity:0`到`opacity:1`就好了。

现在，让我们考虑下一个问题。
你正试图动画`opacity`超过`1`几`1.4`秒钟。
您的下一个补间动画将同一对象从任何时间设置为`0`超过`0.5`几秒，偏移量为`-0.8`几秒。

我不确定您是否在此处看到错误，但让我们将其分解为视觉表示。

```
-------------------------------------------------- <-- Tween 1
                           ---------------         <-- Tween 2 
```

你看，Tween 2在 Tween 1*之前*完成，因为你在时间线中将它推回`0.8`几秒钟，它只运行`0.5`几秒钟。所以 Tween 1 现在有最后`0.3`几秒可以动画回`opacity:1`

另外作为旁注，您可以使用方便的方法而不是`.append(TweenLite...`
`nestedTimeline1.to(...)`做同样的事情。

# objective-c - 很奇怪的日期转换

> ID：14359999
> 
> 赞同：1
> 
> 时间：2013-01-16T13:53:44.427
> 
> 标签：objective-c, cocoa

我可以在我的应用程序中看到一个非常奇怪的日期转换。这是代码：

```
theDateString = [theDateFormatter stringFromDate:date]; 
```

如果`date`是`2007-12-31 00:00:00 +0100` `theDateString`_`2008`

但如果日期`2004-12-31 00:00:00 +0100` `theDateString`是`2004.`

该方法`- (NSString *)stringFromDate:(NSDate *)date`在`NSDateFormatter`，它是一个mac应用程序。

NSDateFormatter 格式为：`[theDateFormatter setDateFormat:@"Y"];`

为什么 ？谢谢

* * *

## 回答 #1

> 赞同：2
> 
> 时间：2013-01-16T13:58:26.923

您应该使用`@"y"`而不是`@"Y"`，因为大写字母“Y”根据“一年中的周”指定年份。2007 年的第 52 周在 2008 年结束，这就是它返回 2008 年而不是 2007 年的原因。

**更新：**
见：[http ://waracle.net/mobile/iphone-nsdateformatter-date-formatting-table/](http://waracle.net/mobile/iphone-nsdateformatter-date-formatting-table/)